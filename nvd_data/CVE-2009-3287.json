{
  "cve_id": "CVE-2009-3287",
  "github_data": {
    "repository": "macournoyer/thin",
    "fix_commit": "7bd027914c5ffd36bb408ef47dc749de3b6e063a",
    "related_commits": [
      "7bd027914c5ffd36bb408ef47dc749de3b6e063a",
      "7bd027914c5ffd36bb408ef47dc749de3b6e063a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7bd027914c5ffd36bb408ef47dc749de3b6e063a",
      "commit_date": "2009-08-12T21:28:38Z",
      "author": {
        "login": "macournoyer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix Remote address spoofing vulnerability in Connection#remote_address [Alexey Borzenkov]",
        "length": 89,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 7,
        "deletions": 10
      },
      "files": [
        {
          "filename": "CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,4 +1,5 @@\n == 1.2.3\n+ * Fix Remote address spoofing vulnerability in Connection#remote_address [Alexey Borzenkov]\n  * Fix uninitialized constant ActionController::Dispatcher error with Rails 1.2.3 [Chris Anderton] [#103 state:resolved]\n \n == 1.2.2 I Find Your Lack of Sauce Disturbing release"
        },
        {
          "filename": "lib/thin/connection.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -180,7 +180,7 @@ def threaded?\n \n     # IP Address of the remote client.\n     def remote_address\n-      @request.forwarded_for || socket_address\n+      socket_address\n     rescue Exception\n       log_error\n       nil"
        },
        {
          "filename": "lib/thin/request.rb",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -21,7 +21,6 @@ class Request\n     HTTP_VERSION      = 'HTTP_VERSION'.freeze\n     HTTP_1_0          = 'HTTP/1.0'.freeze\n     REMOTE_ADDR       = 'REMOTE_ADDR'.freeze\n-    FORWARDED_FOR     = 'HTTP_X_FORWARDED_FOR'.freeze\n     CONTENT_LENGTH    = 'CONTENT_LENGTH'.freeze\n     CONNECTION        = 'HTTP_CONNECTION'.freeze\n     KEEP_ALIVE_REGEXP = /\\bkeep-alive\\b/i.freeze\n@@ -123,10 +122,6 @@ def remote_address=(address)\n       @env[REMOTE_ADDR] = address\n     end\n \n-    def forwarded_for\n-      @env[FORWARDED_FOR]\n-    end\n-\n     def threaded=(value)\n       @env[RACK_MULTITHREAD] = value\n     end"
        },
        {
          "filename": "lib/thin/version.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -6,11 +6,11 @@ class PlatformNotSupported < RuntimeError; end\n   module VERSION #:nodoc:\n     MAJOR    = 1\n     MINOR    = 2\n-    TINY     = 2\n+    TINY     = 3\n     \n     STRING   = [MAJOR, MINOR, TINY].join('.')\n     \n-    CODENAME = \"I Find Your Lack of Sauce Disturbing\".freeze\n+    CODENAME = \"Astroboy\".freeze\n     \n     RACK     = [1, 0].freeze # Rack protocol version\n   end"
        },
        {
          "filename": "spec/connection_spec.rb",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -40,9 +40,10 @@\n     @connection.process\n   end\n   \n-  it \"should return HTTP_X_FORWARDED_FOR as remote_address\" do\n+  it \"should not return HTTP_X_FORWARDED_FOR as remote_address\" do\n     @connection.request.env['HTTP_X_FORWARDED_FOR'] = '1.2.3.4'\n-    @connection.remote_address.should == '1.2.3.4'\n+    @connection.stub!(:socket_address).and_return(\"127.0.0.1\")\n+    @connection.remote_address.should == \"127.0.0.1\"\n   end\n   \n   it \"should return nil on error retreiving remote_address\" do"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "404ad691d5188c6315a6a1a6db5d1494afe006c0",
            "date": "2024-12-15T12:45:45Z",
            "author_login": "ioquatix"
          },
          {
            "sha": "3f375389d29deae252e03080b07a1f10aa60d957",
            "date": "2024-03-05T13:28:45Z",
            "author_login": "macournoyer"
          },
          {
            "sha": "b428f6cfeaac1978c0de487d45c3357a8d0ad773",
            "date": "2023-11-08T00:37:47Z",
            "author_login": "erikt9"
          },
          {
            "sha": "85b956cf1cf377e3e53911cd4e717f7392f7f818",
            "date": "2023-03-31T10:58:22Z",
            "author_login": "ioquatix"
          },
          {
            "sha": "829c3aaa48efcd0c289d856f068f5d0fb16edaac",
            "date": "2023-01-31T21:03:48Z",
            "author_login": "Vasfed"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "lib/thin/connection.rb in Thin web server before 1.2.4 relies on the X-Forwarded-For header to determine the IP address of the client, which allows remote attackers to spoof the IP address and hide activities via a modified X-Forwarded-For header.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2009-09-22T10:30:00.640",
    "last_modified": "2024-11-21T01:06:59.520",
    "fix_date": "2009-08-12T21:28:38Z"
  },
  "references": [
    {
      "url": "http://github.com/macournoyer/thin/blob/master/CHANGELOG",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://github.com/macournoyer/thin/commit/7bd027914c5ffd36bb408ef47dc749de3b6e063a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/09/12/1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://github.com/macournoyer/thin/blob/master/CHANGELOG",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://github.com/macournoyer/thin/commit/7bd027914c5ffd36bb408ef47dc749de3b6e063a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/09/12/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:57:48.278746",
    "processing_status": "enhanced"
  }
}