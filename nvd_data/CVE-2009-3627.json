{
  "cve_id": "CVE-2009-3627",
  "github_data": {
    "repository": "gisle/html-parser",
    "fix_commit": "b9aae1e43eb2c8e989510187cff0ba3e996f9a4c",
    "related_commits": [
      "b9aae1e43eb2c8e989510187cff0ba3e996f9a4c",
      "b9aae1e43eb2c8e989510187cff0ba3e996f9a4c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b9aae1e43eb2c8e989510187cff0ba3e996f9a4c",
      "commit_date": "2009-10-22T19:45:54Z",
      "author": {
        "login": "gisle",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "decode_entities confused by trailing incomplete entity",
        "length": 319,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 16,
        "additions": 9,
        "deletions": 7
      },
      "files": [
        {
          "filename": "t/entities.t",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n use HTML::Entities qw(decode_entities encode_entities encode_entities_numeric);\n \n-use Test::More tests => 16;\n+use Test::More tests => 17;\n \n $a = \"V&aring;re norske tegn b&oslash;r &#230res\";\n \n@@ -71,6 +71,8 @@ is(decode_entities(\"abc&def&ghi&abc;&def;\"), \"abc&def&ghi&abc;&def;\");\n is(decode_entities(\"&apos;\"), \"'\");\n is(encode_entities(\"'\", \"'\"), \"&#39;\");\n \n+is(decode_entities(\"Attention Home&#959&#969n&#1257rs...1&#1109t T&#1110&#1084e E&#957&#1257&#1075\"),\n+  \"Attention Home\\x{3BF}\\x{3C9}n\\x{4E9}rs...1\\x{455}t T\\x{456}\\x{43C}e E\\x{3BD}\\x{4E9}\\x{433}\");\n \n __END__\n # Quoted from rfc1866.txt"
        },
        {
          "filename": "util.c",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -94,14 +94,14 @@ decode_entities(pTHX_ SV* sv, HV* entity2char, bool expand_prefix)\n \tent_start = s;\n \trepl = 0;\n \n-\tif (*s == '#') {\n+\tif (s < end && *s == '#') {\n \t    UV num = 0;\n \t    UV prev = 0;\n \t    int ok = 0;\n \t    s++;\n-\t    if (*s == 'x' || *s == 'X') {\n+\t    if (s < end && (*s == 'x' || *s == 'X')) {\n \t\ts++;\n-\t\twhile (*s) {\n+\t\twhile (s < end) {\n \t\t    char *tmp = strchr(PL_hexdigit, *s);\n \t\t    if (!tmp)\n \t\t\tbreak;\n@@ -117,7 +117,7 @@ decode_entities(pTHX_ SV* sv, HV* entity2char, bool expand_prefix)\n \t\t}\n \t    }\n \t    else {\n-\t\twhile (isDIGIT(*s)) {\n+\t\twhile (s < end && isDIGIT(*s)) {\n \t\t    num = num * 10 + (*s - '0');\n \t\t    if (prev && num < prev) {\n \t\t\t/* overflow */\n@@ -180,7 +180,7 @@ decode_entities(pTHX_ SV* sv, HV* entity2char, bool expand_prefix)\n \t}\n \telse {\n \t    char *ent_name = s;\n-\t    while (isALNUM(*s))\n+\t    while (s < end && isALNUM(*s))\n \t\ts++;\n \t    if (ent_name != s && entity2char) {\n \t\tSV** svp;\n@@ -216,7 +216,7 @@ decode_entities(pTHX_ SV* sv, HV* entity2char, bool expand_prefix)\n \n \tif (repl) {\n \t    char *repl_allocated = 0;\n-\t    if (*s == ';')\n+\t    if (s < end && *s == ';')\n \t\ts++;\n \t    t--;  /* '&' already copied, undo it */\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ce42c7bac084bae957e5176af46d340be30ee8dd",
            "date": "2016-01-19T17:39:27Z",
            "author_login": "gisle"
          },
          {
            "sha": "c50db95fb36dfb13ef1646397ec53f6334c4ce0f",
            "date": "2016-01-19T15:20:42Z",
            "author_login": "gisle"
          },
          {
            "sha": "ac31d36a164c0a8a7b280e58791e1acee6f0e01a",
            "date": "2016-01-19T01:34:48Z",
            "author_login": "gisle"
          },
          {
            "sha": "4fe7b9856b11780dc27e90d3c07faccdb0078420",
            "date": "2016-01-19T02:10:13Z",
            "author_login": "gisle"
          },
          {
            "sha": "00139ae5e9ef4e97d48bc69fd959db489ea20f36",
            "date": "2015-10-23T05:32:35Z",
            "author_login": "bulk88"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "The decode_entities function in util.c in HTML-Parser before 3.63 allows context-dependent attackers to cause a denial of service (infinite loop) via an incomplete SGML numeric character reference, which triggers generation of an invalid UTF-8 character.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2009-10-29T14:30:01.203",
    "last_modified": "2024-11-21T01:07:50.430",
    "fix_date": "2009-10-22T19:45:54Z"
  },
  "references": [
    {
      "url": "http://github.com/gisle/html-parser/commit/b9aae1e43eb2c8e989510187cff0ba3e996f9a4c",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/37155",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/10/23/9",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/36807",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.vupen.com/english/advisories/2009/3022",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=530604",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53941",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://issues.apache.org/SpamAssassin/show_bug.cgi?id=6225",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://github.com/gisle/html-parser/commit/b9aae1e43eb2c8e989510187cff0ba3e996f9a4c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/37155",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/10/23/9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/36807",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.vupen.com/english/advisories/2009/3022",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=530604",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53941",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://issues.apache.org/SpamAssassin/show_bug.cgi?id=6225",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:57:48.281532",
    "processing_status": "enhanced"
  }
}