{
  "cve_id": "CVE-2009-4214",
  "github_data": {
    "repository": "rails/rails",
    "fix_commit": "bfe032858077bb2946abe25e95e485ba6da86bd5",
    "related_commits": [
      "bfe032858077bb2946abe25e95e485ba6da86bd5",
      "bfe032858077bb2946abe25e95e485ba6da86bd5"
    ],
    "patch_url": "https://github.com/rails/rails/commit/bfe032858077bb2946abe25e95e485ba6da86bd5.patch",
    "fix_commit_details": {
      "sha": "bfe032858077bb2946abe25e95e485ba6da86bd5",
      "commit_date": "2009-11-17T05:17:35Z",
      "author": {
        "login": "gtd",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Make sure strip_tags removes tags which start with a non-printable character",
        "length": 134,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "actionpack/lib/action_controller/vendor/html-scanner/html/node.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -162,7 +162,7 @@ def parse(parent, line, pos, content, strict=true)\n           end\n           \n           closing = ( scanner.scan(/\\//) ? :close : nil )\n-          return Text.new(parent, line, pos, content) unless name = scanner.scan(/[\\w:-]+/)\n+          return Text.new(parent, line, pos, content) unless name = scanner.scan(/[-:\\w\\x00-\\x09\\x0b-\\x0c\\x0e-\\x1f]+/)\n           name.downcase!\n   \n           unless closing"
        },
        {
          "filename": "actionpack/test/controller/html-scanner/sanitizer_test.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -19,6 +19,7 @@ def test_strip_tags\n     assert_equal \"This has a  here.\", sanitizer.sanitize(\"This has a <!-- comment --> here.\")\n     assert_equal \"This has a  here.\", sanitizer.sanitize(\"This has a <![CDATA[<section>]]> here.\")\n     assert_equal \"This has an unclosed \", sanitizer.sanitize(\"This has an unclosed <![CDATA[<section>]] here...\")\n+    assert_equal \"non printable char is a tag\", sanitizer.sanitize(\"<\\x07a href='/hello'>non printable char is a tag</a>\")\n     [nil, '', '   '].each { |blank| assert_equal blank, sanitizer.sanitize(blank) }\n   end\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "72d1704546e7d135950f24edb6c29bb2253aa6f8",
            "date": "2025-01-14T17:34:01Z",
            "author_login": "skipkayhil"
          },
          {
            "sha": "52ed99642e3c59160cc30919a370535e0d5a8082",
            "date": "2025-01-14T16:17:53Z",
            "author_login": "borama"
          },
          {
            "sha": "6c7a848a6e09fba5185a09e90c39a41a17c19ed0",
            "date": "2025-01-14T12:51:51Z",
            "author_login": "byroot"
          },
          {
            "sha": "93ea738eeb31f8a2e130898833b2f42ba40cd51a",
            "date": "2025-01-14T12:49:59Z",
            "author_login": "byroot"
          },
          {
            "sha": "cb97c3adc515a85f67e28a589664b9d9a5e6000c",
            "date": "2025-01-14T12:02:58Z",
            "author_login": "AlanGabbianelli"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in the strip_tags function in Ruby on Rails before 2.2.s, and 2.3.x before 2.3.5, allows remote attackers to inject arbitrary web script or HTML via vectors involving non-printing ASCII characters, related to HTML::Tokenizer and actionpack/lib/action_controller/vendor/html-scanner/html/node.rb.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2009-12-07T17:30:00.217",
    "last_modified": "2024-11-21T01:09:10.180",
    "fix_date": "2009-11-17T05:17:35Z"
  },
  "references": [
    {
      "url": "http://github.com/rails/rails/commit/bfe032858077bb2946abe25e95e485ba6da86bd5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://groups.google.com/group/rubyonrails-security/browse_thread/thread/4d4f71f2aef4c0ab?pli=1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2010-03/msg00004.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/37446",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/38915",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://support.apple.com/kb/HT4077",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://weblog.rubyonrails.org/2009/11/30/ruby-on-rails-2-3-5-released",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2011/dsa-2260",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2011/dsa-2301",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/11/27/2",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/12/08/3",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/37142",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id?1023245",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.vupen.com/english/advisories/2009/3352",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://github.com/rails/rails/commit/bfe032858077bb2946abe25e95e485ba6da86bd5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://groups.google.com/group/rubyonrails-security/browse_thread/thread/4d4f71f2aef4c0ab?pli=1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2010-03/msg00004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/37446",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/38915",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://support.apple.com/kb/HT4077",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://weblog.rubyonrails.org/2009/11/30/ruby-on-rails-2-3-5-released",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2011/dsa-2260",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2011/dsa-2301",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/11/27/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2009/12/08/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/37142",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id?1023245",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.vupen.com/english/advisories/2009/3352",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:57:48.284387",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rails",
    "owner": "rails",
    "created_at": "2008-04-11T02:19:47Z",
    "updated_at": "2025-01-14T12:51:57Z",
    "pushed_at": "2025-01-14T12:53:28Z",
    "size": 261740,
    "stars": 56313,
    "forks": 21746,
    "open_issues": 1251,
    "watchers": 56313,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0-5-stable",
      "0-6-stable",
      "0-7-stable",
      "0-8-stable",
      "1-2-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "2-3-stable",
      "3-0-stable",
      "3-1-stable",
      "3-2-stable",
      "4-0-stable",
      "4-1-stable",
      "4-2-stable",
      "5-0-stable",
      "5-1-stable",
      "5-2-stable",
      "6-0-stable",
      "6-1-stable",
      "7-0-stable",
      "7-1-stable",
      "7-2-stable"
    ],
    "languages": {
      "Ruby": 17127894,
      "JavaScript": 228210,
      "HTML": 196993,
      "SCSS": 50596,
      "CSS": 47127,
      "Dockerfile": 2019,
      "Shell": 668
    },
    "commit_activity": {
      "total_commits_last_year": 3989,
      "avg_commits_per_week": 76.71153846153847,
      "days_active_last_year": 351
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T12:56:52.447177"
  }
}