{
  "cve_id": "CVE-2010-0011",
  "github_data": {
    "repository": "Dieterbe/uzbl",
    "fix_commit": "1958b52d41cba96956dc1995660de49525ed1047",
    "related_commits": [
      "1958b52d41cba96956dc1995660de49525ed1047",
      "1958b52d41cba96956dc1995660de49525ed1047"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1958b52d41cba96956dc1995660de49525ed1047",
      "commit_date": "2010-01-05T19:17:29Z",
      "author": {
        "login": "Dieterbe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "disable Uzbl javascript object because of security problem.",
        "length": 59,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 36,
        "additions": 1,
        "deletions": 35
      },
      "files": [
        {
          "filename": "README",
          "status": "modified",
          "additions": 1,
          "deletions": 20,
          "patch": "@@ -397,7 +397,7 @@ The script specific arguments are this:\n \n Custom, userdefined scripts (`spawn foo bar`) get first the arguments as specified in the config and then the above 7 are added at the end.\n \n-### JAVASCRIPT HELPER OBJECT\n+### JAVASCRIPT HELPER OBJECT DISABLED BECAUSE OF SECURITY LEAK\n \n Javascript code run from uzbl is given a special object in the global namespace which gives special privileges to these scripts. This object is called `Uzbl`, and it is added and removed before and after the script execution so that it is hidden to web javascripts (There is no race condition, since all the javascript code runs in a single thread)\n \n@@ -410,25 +410,6 @@ Currently, the `Uzbl` object provides only one function:\n        * `Uzbl.run(\"spawn insert_bookmark.sh\")`\n        * `uri = Uzbl.run(\"print @uri\")` (see variable expansion below)\n \n-### JAVASCRIPT SECURITY\n-\n-Since defined variables and functions are set in the global namespace (`window` object) as default, it is recommended to wrap your scripts like this:\n-\n-    (function(Uzbl) {\n-        ...\n-    })(Uzbl);\n-\n-This way, everything is kept private. It also turns Uzbl into a local variable, which can be accessed from callback functions defined inside. However for some situations, isolating everything isn't an option, for example, with binds. You can define them directly in the script body, and use `var Uzbl = window.Uzbl;` to make the Uzbl variable local, as in the following example:\n-\n-    function f() {\n-        var Uzbl = window.Uzbl;\n-        Uzbl.run(...);\n-        setTimeout(function() {\n-            Uzbl.run(...);\n-        }, 500);\n-    }\n-\n-Copying the Uzbl object and creating public functions should be taken with care to avoid creating security holes. Keep in mind that the \"f\" function above would be defined in the `window` object, and as such any javascript in the current page can call it.\n \n ### EVENTS ###\n "
        },
        {
          "filename": "tests/test-command.c",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -305,11 +305,6 @@ test_js (void) {\n     parse_cmd_line(\"js ('x' + 345).toUpperCase()\", result);\n     g_assert_cmpstr(\"X345\", ==, result->str);\n \n-    /* uzbl commands can be run from javascript */\n-    uzbl.net.useragent = \"Test useragent\";\n-    parse_cmd_line(\"js Uzbl.run('print @useragent').toUpperCase();\", result);\n-    g_assert_cmpstr(\"TEST USERAGENT\", ==, result->str);\n-\n     g_string_free(result, TRUE);\n }\n "
        },
        {
          "filename": "uzbl-core.c",
          "status": "modified",
          "additions": 0,
          "deletions": 10,
          "patch": "@@ -1046,7 +1046,6 @@ eval_js(WebKitWebView * web_view, gchar *script, GString *result) {\n     WebKitWebFrame *frame;\n     JSGlobalContextRef context;\n     JSObjectRef globalobject;\n-    JSStringRef var_name;\n \n     JSStringRef js_script;\n     JSValueRef js_result;\n@@ -1059,12 +1058,6 @@ eval_js(WebKitWebView * web_view, gchar *script, GString *result) {\n     context = webkit_web_frame_get_global_context(frame);\n     globalobject = JSContextGetGlobalObject(context);\n \n-    /* uzbl javascript namespace */\n-    var_name = JSStringCreateWithUTF8CString(\"Uzbl\");\n-    JSObjectSetProperty(context, globalobject, var_name,\n-                        JSObjectMake(context, uzbl.js.classref, NULL),\n-                        kJSClassAttributeNone, NULL);\n-\n     /* evaluate the script and get return value*/\n     js_script = JSStringCreateWithUTF8CString(script);\n     js_result = JSEvaluateScript(context, js_script, globalobject, NULL, 0, NULL);\n@@ -1082,9 +1075,6 @@ eval_js(WebKitWebView * web_view, gchar *script, GString *result) {\n     }\n \n     /* cleanup */\n-    JSObjectDeleteProperty(context, globalobject, var_name, NULL);\n-\n-    JSStringRelease(var_name);\n     JSStringRelease(js_script);\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bdbb81abed26285708c00c045a3711ba3f609d4a",
            "date": "2018-01-05T00:33:14Z",
            "author_login": "keis"
          },
          {
            "sha": "7369c2ffa51e7f7bbdf06036c59e2ead1f492cde",
            "date": "2017-12-28T16:16:10Z",
            "author_login": "keis"
          },
          {
            "sha": "3142d413579a42c7138357b27ca70227ffe1820b",
            "date": "2017-12-25T00:21:17Z",
            "author_login": "musteresel"
          },
          {
            "sha": "d1e8d6fe08659f600d7f1defc174bb11d6437270",
            "date": "2017-12-25T00:17:18Z",
            "author_login": "musteresel"
          },
          {
            "sha": "758989842215ce10eebaf8f5142720200cf1a169",
            "date": "2017-12-17T20:15:47Z",
            "author_login": "musteresel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "The eval_js function in uzbl-core.c in Uzbl before 2010.01.05 exposes the run method of the Uzbl object, which allows remote attackers to execute arbitrary commands via JavaScript code.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2010-02-25T19:30:00.437",
    "last_modified": "2024-11-21T01:11:19.443",
    "fix_date": "2010-01-05T19:17:29Z"
  },
  "references": [
    {
      "url": "http://github.com/Dieterbe/uzbl/commit/1958b52d41cba96956dc1995660de49525ed1047",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://github.com/Dieterbe/uzbl/downloads",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://lists.uzbl.org/pipermail/uzbl-dev-uzbl.org/2010-January/000586.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2010/01/06/1",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2010/01/06/3",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.uzbl.org/news.php?id=22",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/56612",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://github.com/Dieterbe/uzbl/commit/1958b52d41cba96956dc1995660de49525ed1047",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://github.com/Dieterbe/uzbl/downloads",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://lists.uzbl.org/pipermail/uzbl-dev-uzbl.org/2010-January/000586.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2010/01/06/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2010/01/06/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.uzbl.org/news.php?id=22",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/56612",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:57:51.737617",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "uzbl",
    "owner": "Dieterbe",
    "created_at": "2009-04-21T19:07:47Z",
    "updated_at": "2025-01-19T16:34:02Z",
    "pushed_at": "2018-12-28T17:45:28Z",
    "size": 7358,
    "stars": 1028,
    "forks": 157,
    "open_issues": 72,
    "watchers": 1028,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "next"
    ],
    "languages": {
      "C": 307610,
      "Python": 178782,
      "Makefile": 9738,
      "Vim Script": 5980,
      "Shell": 5678,
      "Roff": 3904,
      "C++": 2268
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:30:28.060406"
  }
}