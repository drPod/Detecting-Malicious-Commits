{
  "cve_id": "CVE-2010-10003",
  "github_data": {
    "repository": "gesellix/titlelink",
    "fix_commit": "b4604e523853965fa981a4e79aef4b554a535db0",
    "related_commits": [
      "b4604e523853965fa981a4e79aef4b554a535db0",
      "b4604e523853965fa981a4e79aef4b554a535db0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b4604e523853965fa981a4e79aef4b554a535db0",
      "commit_date": "2010-08-08T18:17:54Z",
      "author": {
        "login": "gesellix",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[#20653] SQL Injection: $phrase is escaped now, yet most of the plugins have to be updated according to plugin_content_title.php",
        "length": 218,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 18,
        "deletions": 5
      },
      "files": [
        {
          "filename": "j_1_5_x/plugin/changelog.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -4,6 +4,11 @@\n \r\n ?>\r\n \r\n+2010-08-08:\r\n+\r\n+- [#20653] SQL Injection: $phrase is escaped now, yet most of the plugins have to be updated according to plugin_content_title.php\r\n+\r\n+\r\n 2009-06-06:\r\n \r\n - [#16580] Exact Match as default or plugin option\r"
        },
        {
          "filename": "j_1_5_x/plugin/titlelink.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -592,10 +592,12 @@ function isExternal($link)\n \r\n   function getByPlugins($database, $plugins, $phrase, $partial_match)\r\n   {\r\n+    $phrase_escaped = $database->getEscaped($phrase, true);\r\n+\r\n     $count = count($plugins);\r\n     for ($i = 0; $i < $count; $i++)\r\n     {\r\n-      $result = call_user_func($plugins[$i], $database, $phrase, $partial_match);\r\n+      $result = call_user_func($plugins[$i], $database, $phrase_escaped, $partial_match);\r\n \r\n       // magix number '2' is the amount of strings we need as result\r\n       if (count($result) == 2)\r"
        },
        {
          "filename": "j_1_5_x/plugin/titlelink.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -3,11 +3,11 @@\n \t<name>Content - TitleLink</name>\n \t<author>Tobias Gesellchen</author>\n \t<creationDate>2008-06-03</creationDate>\n-\t<copyright>(C) 2005-2009 Tobias Gesellchen. All rights reserved.</copyright>\n+\t<copyright>(C) 2005-2010 Tobias Gesellchen. All rights reserved.</copyright>\n \t<license>http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL</license>\n \t<authorEmail>tobias@gesellix.de</authorEmail>\n \t<authorUrl>www.gesellix.de</authorUrl>\n-\t<version>3.2.0 2009-06-06 stable</version>\n+\t<version>3.2.1 2010-08-08 stable</version>\n   <description>DESCTITLELINK</description>\n   <files>\n     <filename plugin=\"titlelink\">titlelink.php</filename>"
        },
        {
          "filename": "j_1_5_x/plugin/titlelink_plugins/plugin_content_title.php",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -27,12 +27,18 @@ function plugin_contentTitle($database, $phrase, $partial_match = true)\n \r\n   $where_clause = \" WHERE a.state=1 \";\r\n \r\n-  $where_variant = \" AND a.alias \" . (($partial_match) ? \" LIKE '%$phrase%'\" : \"= '$phrase'\");\r\n+  $where_variant = \" AND a.alias \" .\r\n+  \t\t\t\t(($partial_match)\r\n+  \t\t\t\t\t? \" LIKE \".$database->quote('%'.$phrase.'%', false)\r\n+    \t\t\t\t: \"= \".$database->quote($phrase, false));\r\n   $result = findContentInternal($database, $query.$where_clause.$where_variant, false);\r\n \r\n   if ($result == null)\r\n   {\r\n-    $where_variant = \" AND a.title \" . (($partial_match) ? \" LIKE '%$phrase%'\" : \"= '$phrase'\");\r\n+    $where_variant = \" AND a.title \" .\r\n+  \t\t\t\t(($partial_match)\r\n+  \t\t\t\t\t? \" LIKE \".$database->quote('%'.$phrase.'%', false)\r\n+  \t\t\t\t\t: \"= \".$database->quote($phrase, false));\r\n   \t$result = findContentInternal($database, $query.$where_clause.$where_variant, true);\r\n   }\r\n   \r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e070f87515143ac996cef6cd5ad77a8180ade727",
            "date": "2023-10-29T15:08:21Z",
            "author_login": "gesellix"
          },
          {
            "sha": "e549a4e114326438e465e4e3dbb2e161d65fdcbf",
            "date": "2023-10-28T09:49:05Z",
            "author_login": "gesellix"
          },
          {
            "sha": "f580241e1e16dd2e48da9995e4bbb6fbc6b0bfa5",
            "date": "2023-08-01T21:07:39Z",
            "author_login": "gesellix"
          },
          {
            "sha": "50251f33cab6ad28c9e3df66762ab53a44f64952",
            "date": "2023-08-01T20:48:52Z",
            "author_login": "gesellix"
          },
          {
            "sha": "94a4bc0dabf2adcaec44156e21cc250a56562836",
            "date": "2023-08-01T20:42:25Z",
            "author_login": "gesellix"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability classified as critical was found in gesellix titlelink on Joomla. Affected by this vulnerability is an unknown functionality of the file plugin_content_title.php. The manipulation of the argument phrase leads to sql injection. The patch is named b4604e523853965fa981a4e79aef4b554a535db0. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217351.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-04T10:15:09.577",
    "last_modified": "2024-11-21T01:13:23.323",
    "fix_date": "2010-08-08T18:17:54Z"
  },
  "references": [
    {
      "url": "https://github.com/gesellix/titlelink/commit/b4604e523853965fa981a4e79aef4b554a535db0",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217351",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217351",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gesellix/titlelink/commit/b4604e523853965fa981a4e79aef4b554a535db0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217351",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217351",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.249835",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "titlelink",
    "owner": "gesellix",
    "created_at": "2012-04-03T21:12:35Z",
    "updated_at": "2024-05-10T03:33:07Z",
    "pushed_at": "2023-10-29T15:08:54Z",
    "size": 1466,
    "stars": 3,
    "forks": 7,
    "open_issues": 10,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "PHP": 69533
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-3.0"
    },
    "collected_at": "2025-01-26T07:36:46.400241"
  }
}