{
  "cve_id": "CVE-2011-3186",
  "github_data": {
    "repository": "rails/rails",
    "fix_commit": "11dafeaa7533be26441a63618be93a03869c83a9",
    "related_commits": [
      "11dafeaa7533be26441a63618be93a03869c83a9",
      "11dafeaa7533be26441a63618be93a03869c83a9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "11dafeaa7533be26441a63618be93a03869c83a9",
      "commit_date": "2011-08-16T21:25:45Z",
      "author": {
        "login": "tenderlove",
        "type": "User",
        "stats": {
          "total_commits": 3469,
          "average_weekly_commits": 3.291271347248577,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 336
        }
      },
      "commit_message": {
        "title": "fixing response splitting problem",
        "length": 33,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 12,
        "deletions": 1
      },
      "files": [
        {
          "filename": "actionpack/lib/action_controller/response.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -64,12 +64,13 @@ def location=(url) headers['Location'] = url end\n     # the character set information will also be included in the content type\n     # information.\n     def content_type=(mime_type)\n-      self.headers[\"Content-Type\"] =\n+      new_content_type =\n         if mime_type =~ /charset/ || (c = charset).nil?\n           mime_type.to_s\n         else\n           \"#{mime_type}; charset=#{c}\"\n         end\n+      self.headers[\"Content-Type\"] = URI.escape(new_content_type, \"\\r\\n\")\n     end\n \n     # Returns the response's content MIME type, or nil if content type has been set."
        },
        {
          "filename": "actionpack/test/controller/content_type_test.rb",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -46,6 +46,11 @@ def render_default_content_types_for_respond_to\n       format.rss  { render :text   => \"hello world!\", :content_type => Mime::XML }\n     end\n   end\n+  \n+  def render_content_type_from_user_input\n+    response.content_type= params[:hello]\n+    render :text=>\"hello\"\n+  end\n \n   def rescue_action(e) raise end\n end\n@@ -129,6 +134,11 @@ def test_change_for_rxml\n     assert_equal Mime::HTML, @response.content_type\n     assert_equal \"utf-8\", @response.charset\n   end\n+  \n+  def test_user_supplied_value\n+    get :render_content_type_from_user_input, :hello=>\"hello/world\\r\\nAttack: true\"\n+    assert_equal \"hello/world%0D%0AAttack: true\", @response.content_type\n+  end\n end\n \n class AcceptBasedContentTypeTest < ActionController::TestCase"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f1e610ec20532a1fdce6d3ce94d8d610bca48d89",
            "date": "2025-01-25T13:40:22Z",
            "author_login": "byroot"
          },
          {
            "sha": "7629dd1a5353ca1ad01dd1e4f2e0a301ba7ba4a6",
            "date": "2025-01-25T09:05:19Z",
            "author_login": "joshuay03"
          },
          {
            "sha": "2ca006fb7fe881c225c000d9ab11e2a3554b70fa",
            "date": "2025-01-24T21:19:22Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "cd171d69fa03e0a09133089eca672831d447d02a",
            "date": "2025-01-24T20:48:43Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "dc522a3e6933e014c691e06c5d866d6351d6640d",
            "date": "2025-01-24T15:03:22Z",
            "author_login": "Edouard-chin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-94",
    "description": "CRLF injection vulnerability in actionpack/lib/action_controller/response.rb in Ruby on Rails 2.3.x before 2.3.13 allows remote attackers to inject arbitrary HTTP headers and conduct HTTP response splitting attacks via the Content-Type header.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2011-08-29T18:55:01.643",
    "last_modified": "2024-11-21T01:29:55.930",
    "fix_date": "2011-08-16T21:25:45Z"
  },
  "references": [
    {
      "url": "http://groups.google.com/group/rubyonrails-security/msg/bbe342e43abaa78c?dmode=source&output=gplain",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2011-September/065137.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/45921",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2011/dsa-2301",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/17/1",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/19/11",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/20/1",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/22/13",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/22/14",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/22/5",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=732156",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rails/rails/commit/11dafeaa7533be26441a63618be93a03869c83a9",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://groups.google.com/group/rubyonrails-security/msg/bbe342e43abaa78c?dmode=source&output=gplain",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2011-September/065137.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/45921",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2011/dsa-2301",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/17/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/19/11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/20/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/22/13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/22/14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2011/08/22/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=732156",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rails/rails/commit/11dafeaa7533be26441a63618be93a03869c83a9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:02.134411",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "rails",
    "owner": "rails",
    "created_at": "2008-04-11T02:19:47Z",
    "updated_at": "2025-01-26T05:34:47Z",
    "pushed_at": "2025-01-25T13:40:23Z",
    "size": 261808,
    "stars": 56353,
    "forks": 21756,
    "open_issues": 1262,
    "watchers": 56353,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0-5-stable",
      "0-6-stable",
      "0-7-stable",
      "0-8-stable",
      "1-2-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "2-3-stable",
      "3-0-stable",
      "3-1-stable",
      "3-2-stable",
      "4-0-stable",
      "4-1-stable",
      "4-2-stable",
      "5-0-stable",
      "5-1-stable",
      "5-2-stable",
      "6-0-stable",
      "6-1-stable",
      "7-0-stable",
      "7-1-stable",
      "7-2-stable"
    ],
    "languages": {
      "Ruby": 17142031,
      "JavaScript": 228210,
      "HTML": 196993,
      "SCSS": 50596,
      "CSS": 47127,
      "Dockerfile": 2019,
      "Shell": 708
    },
    "commit_activity": {
      "total_commits_last_year": 3977,
      "avg_commits_per_week": 76.48076923076923,
      "days_active_last_year": 350
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:40:39.021267"
  }
}