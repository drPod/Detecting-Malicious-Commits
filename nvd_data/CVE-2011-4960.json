{
  "cve_id": "CVE-2011-4960",
  "github_data": {
    "repository": "silverstripe/sapphire",
    "fix_commit": "fef7c32",
    "related_commits": [
      "fef7c32",
      "fef7c32"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "fef7c32",
      "commit_date": "2011-03-21T03:12:37Z",
      "author": {
        "login": "chillu",
        "type": "User",
        "stats": {
          "total_commits": 6173,
          "average_weekly_commits": 6.739082969432315,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 485
        }
      },
      "commit_message": {
        "title": "BUGFIX Fixed SQL injection in Folder::findOrMake()  parameter. Exploitable through Upload::, although unlikely to be set via user input.",
        "length": 136,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "filesystem/Folder.php",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -42,7 +42,14 @@ static function findOrMake($folderPath) {\n \t\t$item = null;\n \t\tforeach($parts as $part) {\n \t\t\tif(!$part) continue; // happens for paths with a trailing slash\n-\t\t\t$item = DataObject::get_one(\"Folder\", \"\\\"Name\\\" = '$part' AND \\\"ParentID\\\" = $parentID\");\n+\t\t\t$item = DataObject::get_one(\n+\t\t\t\t\"Folder\", \n+\t\t\t\tsprintf(\n+\t\t\t\t\t\"\\\"Name\\\" = '%s' AND \\\"ParentID\\\" = %d\",\n+\t\t\t\t\tConvert::raw2sql($part), \n+\t\t\t\t\t(int)$parentID\n+\t\t\t\t)\n+\t\t\t);\n \t\t\tif(!$item) {\n \t\t\t\t$item = new Folder();\n \t\t\t\t$item->ParentID = $parentID;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1ea87f88ff632f2c2b335a233efcfdbe8665ffde",
            "date": "2025-01-23T20:16:49Z",
            "author_login": "emteknetnz"
          },
          {
            "sha": "338f0d96c3552405b33b157e024002f4cfe1a2d6",
            "date": "2025-01-22T23:26:52Z",
            "author_login": "davejtoews"
          },
          {
            "sha": "0bd04102ddf780f63f19d6bcf91d604effe62edb",
            "date": "2025-01-22T03:33:44Z",
            "author_login": "emteknetnz"
          },
          {
            "sha": "227e1788ba52de719b8cd6ab052fa04b1ada0da1",
            "date": "2025-01-16T19:43:37Z",
            "author_login": "lekoala"
          },
          {
            "sha": "16ef0944df426e6df68f31ac6f147216a802a279",
            "date": "2025-01-15T21:41:33Z",
            "author_login": "lekoala"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-89",
    "description": "SQL injection vulnerability in the Folder::findOrMake method in SilverStripe 2.3.x before 2.3.12 and 2.4.x before 2.4.6 allows remote attackers to execute arbitrary SQL commands via unspecified vectors.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2012-09-17T17:55:02.860",
    "last_modified": "2024-11-21T01:33:22.323",
    "fix_date": "2011-03-21T03:12:37Z"
  },
  "references": [
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.3.12",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.4.6",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/1",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/3",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/silverstripe/sapphire/commit/fef7c32",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.3.12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.4.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/silverstripe/sapphire/commit/fef7c32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:10.699301",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "silverstripe-framework",
    "owner": "silverstripe",
    "created_at": "2011-02-02T02:04:13Z",
    "updated_at": "2025-01-23T20:16:54Z",
    "pushed_at": "2025-01-23T20:16:49Z",
    "size": 114523,
    "stars": 721,
    "forks": 823,
    "open_issues": 677,
    "watchers": 721,
    "has_security_policy": false,
    "default_branch": "5",
    "protected_branches": [
      "2.1",
      "2.2",
      "2.3",
      "2.4",
      "3",
      "3.0",
      "3.5",
      "3.6",
      "3.7",
      "4",
      "4.2",
      "4.3",
      "4.4",
      "4.5",
      "4.6",
      "4.7",
      "4.8",
      "4.9",
      "4.10",
      "4.11",
      "4.12",
      "4.13",
      "5",
      "5.0",
      "5.1",
      "5.2",
      "5.3",
      "6",
      "6.0"
    ],
    "languages": {
      "PHP": 7238056,
      "Scheme": 33358,
      "CSS": 4378,
      "Shell": 3006,
      "JavaScript": 452,
      "HTML": 195
    },
    "commit_activity": {
      "total_commits_last_year": 286,
      "avg_commits_per_week": 5.5,
      "days_active_last_year": 140
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T07:55:02.987196"
  }
}