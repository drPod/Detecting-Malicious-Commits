{
  "cve_id": "CVE-2011-4969",
  "github_data": {
    "repository": "jquery/jquery",
    "fix_commit": "db9e023e62c1ff5d8f21ed9868ab6878da2005e9",
    "related_commits": [
      "db9e023e62c1ff5d8f21ed9868ab6878da2005e9",
      "db9e023e62c1ff5d8f21ed9868ab6878da2005e9"
    ],
    "patch_url": "https://github.com/jquery/jquery/commit/db9e023e62c1ff5d8f21ed9868ab6878da2005e9.patch",
    "fix_commit_details": {
      "sha": "db9e023e62c1ff5d8f21ed9868ab6878da2005e9",
      "commit_date": "2011-08-25T19:16:46Z",
      "author": {
        "login": "dmethvin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #474 from dmethvin/fix-9521-xss-hash",
        "length": 127,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 20,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/core.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,8 +16,8 @@ var jQuery = function( selector, context ) {\n \trootjQuery,\n \n \t// A simple way to check for HTML strings or ID strings\n-\t// (both of which we optimize for)\n-\tquickExpr = /^(?:[^<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/,\n+\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n+\tquickExpr = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/,\n \n \t// Check if a string has a non-whitespace character in it\n \trnotwhite = /\\S/,"
        },
        {
          "filename": "test/unit/core.js",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -467,6 +467,24 @@ test(\"isXMLDoc - HTML\", function() {\n \tdocument.body.removeChild( iframe );\n });\n \n+test(\"XSS via location.hash\", function() {\n+\texpect(1);\n+\t\n+\tstop();\n+\tjQuery._check9521 = function(x){\n+\t\tok( x, \"script called from #id-like selector with inline handler\" );\n+\t\tjQuery(\"#check9521\").remove();\n+\t\tdelete jQuery._check9521;\n+\t\tstart();\n+\t};\n+\ttry {\n+\t\t// This throws an error because it's processed like an id\n+\t\tjQuery( '#<img id=\"check9521\" src=\"no-such-.gif\" onerror=\"jQuery._check9521(false)\">' ).appendTo(\"#qunit-fixture\");\n+\t} catch (err) {\n+\t\tjQuery._check9521(true);\n+\t};\n+});\n+\n if ( !isLocal ) {\n test(\"isXMLDoc - XML\", function() {\n \texpect(3);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "098591e6fd3222e64b59af92c8849f5d8963d43c",
            "date": "2025-01-14T10:29:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "733e62d20328dd3e5b226fd9793b159637d922b8",
            "date": "2025-01-14T03:36:10Z",
            "author_login": "timmywil"
          },
          {
            "sha": "4466770992d5833358169d0248c4deedadea1a96",
            "date": "2024-12-16T18:00:50Z",
            "author_login": "mgol"
          },
          {
            "sha": "0e123509d529456ddf130abb97e6266b53f62c50",
            "date": "2024-12-10T23:38:27Z",
            "author_login": "mgol"
          },
          {
            "sha": "75b48e6a2bff1258ca4d85ab7887e78772a67a69",
            "date": "2024-12-08T23:33:15Z",
            "author_login": "mgol"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in jQuery before 1.6.3, when using location.hash to select elements, allows remote attackers to inject arbitrary web script or HTML via a crafted tag.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-03-08T22:55:01.050",
    "last_modified": "2024-11-21T01:33:23.133",
    "fix_date": "2011-08-25T19:16:46Z"
  },
  "references": [
    {
      "url": "http://blog.jquery.com/2011/09/01/jquery-1-6-3-released/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://blog.mindedsecurity.com/2011/07/jquery-is-sink.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://bugs.jquery.com/ticket/9521",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/01/31/3",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/80056",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/58458",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1036620",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-1722-1",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/jquery/jquery/commit/db9e023e62c1ff5d8f21ed9868ab6878da2005e9",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05111017",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05158380",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05232730",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/ff8dcfe29377088ab655fda9d585dccd5b1f07fabd94ae84fd60a7f8%40%3Ccommits.pulsar.apache.org%3E",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20190416-0007/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://blog.jquery.com/2011/09/01/jquery-1-6-3-released/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://blog.mindedsecurity.com/2011/07/jquery-is-sink.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://bugs.jquery.com/ticket/9521",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/01/31/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/80056",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/58458",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1036620",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-1722-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/jquery/jquery/commit/db9e023e62c1ff5d8f21ed9868ab6878da2005e9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05111017",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05158380",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05232730",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/ff8dcfe29377088ab655fda9d585dccd5b1f07fabd94ae84fd60a7f8%40%3Ccommits.pulsar.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20190416-0007/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:13.494579",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jquery",
    "owner": "jquery",
    "created_at": "2009-04-03T15:20:14Z",
    "updated_at": "2025-01-14T12:02:49Z",
    "pushed_at": "2025-01-14T10:32:33Z",
    "size": 34583,
    "stars": 59292,
    "forks": 20572,
    "open_issues": 89,
    "watchers": 59292,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.12-stable",
      "2.2-stable",
      "3.x-stable",
      "3.6-stable",
      "main"
    ],
    "languages": {
      "JavaScript": 1287796,
      "HTML": 67606,
      "PHP": 9378,
      "CSS": 2254,
      "Shell": 1837
    },
    "commit_activity": {
      "total_commits_last_year": 88,
      "avg_commits_per_week": 1.6923076923076923,
      "days_active_last_year": 60
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:15:12.449437"
  }
}