{
  "cve_id": "CVE-2011-5097",
  "github_data": {
    "repository": "opscode/chef",
    "fix_commit": "a4ea6edab2fecb922f999cffb0daa04eeeec7a26",
    "related_commits": [
      "a4ea6edab2fecb922f999cffb0daa04eeeec7a26",
      "a4ea6edab2fecb922f999cffb0daa04eeeec7a26"
    ],
    "patch_url": "https://github.com/opscode/chef/commit/a4ea6edab2fecb922f999cffb0daa04eeeec7a26.patch",
    "fix_commit_details": {
      "sha": "a4ea6edab2fecb922f999cffb0daa04eeeec7a26",
      "commit_date": "2011-06-29T03:13:10Z",
      "author": {
        "login": "coderanger",
        "type": "User",
        "stats": {
          "total_commits": 308,
          "average_weekly_commits": 0.3496027241770715,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 70
        }
      },
      "commit_message": {
        "title": "Do not allow non-admins to upload or delete cookbooks.",
        "length": 54,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 32,
        "additions": 31,
        "deletions": 1
      },
      "files": [
        {
          "filename": "chef-server-api/app/controllers/cookbooks.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -30,6 +30,7 @@ class Cookbooks < Application\n \n   before :authenticate_every\n   before :params_helper\n+  before :is_admin, :only => [ :update, :destroy ]\n \n   attr_accessor :cookbook_name, :cookbook_version\n "
        },
        {
          "filename": "features/api/cookbooks/delete_cookbooks.feature",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -52,3 +52,10 @@ Feature: CRUD cookbooks\n      When I 'DELETE' to the path '/cookbooks/testcookbook_nonexistent/1.2.3'\n      Then I should get a '404 \"Not Found\"' exception\n \n+  @delete_cookbook_negative @cookbook_non_admin\n+  Scenario: I should not be able to delete cookbook if I am not an admin\n+    Given I am an administrator\n+     When I fully upload a sandboxed cookbook named 'testcookbook_valid' versioned '0.1.0' with 'testcookbook_valid'\n+    Given I am a non-admin\n+     When I 'DELETE' to the path '/cookbooks/testcookbook_valid/0.1.0'\n+     Then I should get a '403 \"Forbidden\"' exception"
        },
        {
          "filename": "features/api/cookbooks/upload_cookbooks.feature",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -155,3 +155,22 @@ Feature: CRUD cookbooks\n       And I have uploaded a frozen cookbook named 'testcookbook_valid' at version '0.1.0'\n      When I upload a cookbook named 'testcookbook_valid' at version '0.1.0'\n      Then I should get a '409 \"Conflict\"' exception\n+\n+  @create_cookbook_negative @cookbook_non_admin\n+  Scenario: Should not be able to create a cookbook if I am not an admin\n+    Given I am an administrator\n+     When I create a sandbox named 'sandbox1' for cookbook 'testcookbook_valid'\n+     Then the inflated responses key 'uri' should match '^http://.+/sandboxes/[^\\/]+$'\n+     Then I upload a file named 'metadata.json' from cookbook 'testcookbook_valid' to the sandbox\n+     Then the response code should be '200'\n+     Then I upload a file named 'metadata.rb' from cookbook 'testcookbook_valid' to the sandbox\n+     Then the response code should be '200'\n+     Then I upload a file named 'attributes/attributes.rb' from cookbook 'testcookbook_valid' to the sandbox\n+     Then the response code should be '200'\n+     Then I upload a file named 'recipes/default.rb' from cookbook 'testcookbook_valid' to the sandbox\n+     Then the response code should be '200'\n+     When I commit the sandbox\n+     Then I should not get an exception\n+    Given I am a non-admin\n+     When I create a versioned cookbook named 'testcookbook_valid' versioned '0.1.0' with 'testcookbook_valid'\n+     Then I should get a '403 \"Forbidden\"' exception"
        },
        {
          "filename": "features/support/env.rb",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -135,8 +135,11 @@ def create_databases\n   Chef::Environment.create_default_environment\n   system(\"cp #{File.join(Dir.tmpdir, \"chef_integration\", \"validation.pem\")} #{Dir.tmpdir}\")\n   system(\"cp #{File.join(Dir.tmpdir, \"chef_integration\", \"webui.pem\")} #{Dir.tmpdir}\")\n+  c = Chef::ApiClient.cdb_load(Chef::Config[:web_ui_client_name])\n+  c.admin(true)\n+  c.cdb_save\n \n-  cmd = [KNIFE_CMD, \"cookbook\", \"upload\", \"-a\", \"-o\", INTEGRATION_COOKBOOKS, \"-u\", \"validator\", \"-k\", File.join(Dir.tmpdir, \"validation.pem\"), \"-c\", KNIFE_CONFIG]\n+  cmd = [KNIFE_CMD, \"cookbook\", \"upload\", \"-a\", \"-o\", INTEGRATION_COOKBOOKS, \"-u\", Chef::Config[:web_ui_client_name], \"-k\", File.join(Dir.tmpdir, \"webui.pem\"), \"-c\", KNIFE_CONFIG]\n   Chef::Log.info(\"Uploading fixture cookbooks with #{cmd.join(' ')}\")\n   cmd << {:timeout => 120}\n   shell_out!(*cmd)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "770d69b2a9247f02de69d81d31d72f37d3e649ab",
            "date": "2025-01-13T19:30:38Z",
            "author_login": "chef-ci"
          },
          {
            "sha": "06e996f492acbc9b42d914cd2dfd536376789792",
            "date": "2025-01-13T19:28:13Z",
            "author_login": "tpowell-progress"
          },
          {
            "sha": "863f429f4daf827b019af8d97100791bbd9affd9",
            "date": "2025-01-10T08:46:21Z",
            "author_login": "chef-ci"
          },
          {
            "sha": "5bd5baef243ac537fdfe325108318b74f3f408ed",
            "date": "2025-01-10T08:44:09Z",
            "author_login": "neha-p6"
          },
          {
            "sha": "4af305e0e6ee8846626f797c1ccc2a675d756762",
            "date": "2025-01-09T22:04:11Z",
            "author_login": "chef-ci"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "chef-server-api/app/controllers/cookbooks.rb in Chef Server in Chef before 0.9.18, and 0.10.x before 0.10.2, does not require administrative privileges for the update and destroy methods, which allows remote authenticated users to (1) upload cookbooks via a knife cookbook upload command or (2) delete cookbooks via a knife cookbook delete command.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2012-08-08T10:26:18.173",
    "last_modified": "2024-11-21T01:33:37.680",
    "fix_date": "2011-06-29T03:13:10Z"
  },
  "references": [
    {
      "url": "http://tickets.opscode.com/browse/CHEF-2436",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/opscode/chef/commit/a4ea6edab2fecb922f999cffb0daa04eeeec7a26",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://tickets.opscode.com/browse/CHEF-2436",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/opscode/chef/commit/a4ea6edab2fecb922f999cffb0daa04eeeec7a26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:07.294454",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "chef",
    "owner": "opscode",
    "created_at": "2009-01-15T20:40:48Z",
    "updated_at": "2025-01-13T19:30:45Z",
    "pushed_at": "2025-01-14T01:09:29Z",
    "size": 298995,
    "stars": 7646,
    "forks": 2509,
    "open_issues": 443,
    "watchers": 7646,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 11296777,
      "HTML": 78412,
      "Shell": 71329,
      "PowerShell": 37578,
      "Python": 12834,
      "Makefile": 2652,
      "Dockerfile": 1452,
      "JavaScript": 1229,
      "Raku": 128
    },
    "commit_activity": {
      "total_commits_last_year": 325,
      "avg_commits_per_week": 6.25,
      "days_active_last_year": 103
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:45:49.247918"
  }
}