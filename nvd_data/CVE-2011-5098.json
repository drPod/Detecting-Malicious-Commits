{
  "cve_id": "CVE-2011-5098",
  "github_data": {
    "repository": "opscode/chef",
    "fix_commit": "33f0e9c58bbf047e1b401a834f3abfe72d9a8947",
    "related_commits": [
      "33f0e9c58bbf047e1b401a834f3abfe72d9a8947",
      "33f0e9c58bbf047e1b401a834f3abfe72d9a8947"
    ],
    "patch_url": "https://github.com/opscode/chef/commit/33f0e9c58bbf047e1b401a834f3abfe72d9a8947.patch",
    "fix_commit_details": {
      "sha": "33f0e9c58bbf047e1b401a834f3abfe72d9a8947",
      "commit_date": "2011-10-30T02:08:47Z",
      "author": {
        "login": "btm",
        "type": "User",
        "stats": {
          "total_commits": 1099,
          "average_weekly_commits": 1.2474460839954598,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 242
        }
      },
      "commit_message": {
        "title": "CHEF-2649: Only allow admin clients to create admins (not validators)",
        "length": 69,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 7,
        "deletions": 7
      },
      "files": [
        {
          "filename": "chef-server-api/app/controllers/clients.rb",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -49,13 +49,13 @@ def create\n     exists = true \n     if params.has_key?(:inflated_object)\n       params[:name] ||= params[:inflated_object].name\n-      # We can only get here if we're admin or the validator. Only\n-      # allow creating admin clients if we're already an admin.\n-      if @auth_user.admin\n-        params[:admin] ||= params[:inflated_object].admin\n-      else\n-        params[:admin] = false\n-      end\n+      params[:admin] ||= params[:inflated_object].admin\n+    end\n+\n+    # We can only create clients if we're the admin or the validator.\n+    # But only allow creating admin clients if we're already an admin.\n+    if params[:admin] == true && @auth_user.admin != true\n+      raise Forbidden, \"You are not allowed to take this action.\"\n     end\n \n     begin"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "770d69b2a9247f02de69d81d31d72f37d3e649ab",
            "date": "2025-01-13T19:30:38Z",
            "author_login": "chef-ci"
          },
          {
            "sha": "06e996f492acbc9b42d914cd2dfd536376789792",
            "date": "2025-01-13T19:28:13Z",
            "author_login": "tpowell-progress"
          },
          {
            "sha": "863f429f4daf827b019af8d97100791bbd9affd9",
            "date": "2025-01-10T08:46:21Z",
            "author_login": "chef-ci"
          },
          {
            "sha": "5bd5baef243ac537fdfe325108318b74f3f408ed",
            "date": "2025-01-10T08:44:09Z",
            "author_login": "neha-p6"
          },
          {
            "sha": "4af305e0e6ee8846626f797c1ccc2a675d756762",
            "date": "2025-01-09T22:04:11Z",
            "author_login": "chef-ci"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "chef-server-api/app/controllers/clients.rb in Chef Server in Chef before 0.9.20, and 0.10.x before 0.10.6, does not require administrative privileges for creating admin clients, which allows remote authenticated users to bypass intended access restrictions by leveraging read permission for the validation key and executing a knife client create command with the --admin option.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2012-08-08T10:26:18.207",
    "last_modified": "2024-11-21T01:33:37.830",
    "fix_date": "2011-10-30T02:08:47Z"
  },
  "references": [
    {
      "url": "http://tickets.opscode.com/browse/CHEF-2649",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/opscode/chef/commit/33f0e9c58bbf047e1b401a834f3abfe72d9a8947",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://tickets.opscode.com/browse/CHEF-2649",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/opscode/chef/commit/33f0e9c58bbf047e1b401a834f3abfe72d9a8947",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:07.294683",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "chef",
    "owner": "opscode",
    "created_at": "2009-01-15T20:40:48Z",
    "updated_at": "2025-01-13T19:30:45Z",
    "pushed_at": "2025-01-14T01:09:29Z",
    "size": 298995,
    "stars": 7646,
    "forks": 2509,
    "open_issues": 443,
    "watchers": 7646,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 11296777,
      "HTML": 78412,
      "Shell": 71329,
      "PowerShell": 37578,
      "Python": 12834,
      "Makefile": 2652,
      "Dockerfile": 1452,
      "JavaScript": 1229,
      "Raku": 128
    },
    "commit_activity": {
      "total_commits_last_year": 325,
      "avg_commits_per_week": 6.25,
      "days_active_last_year": 103
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:45:49.247918"
  }
}