{
  "cve_id": "CVE-2012-2666",
  "github_data": {
    "repository": "golang/go",
    "fix_commit": "8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd",
    "related_commits": [
      "8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd",
      "8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd"
    ],
    "patch_url": "https://github.com/golang/go/commit/8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd.patch",
    "fix_commit_details": {
      "sha": "8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd",
      "commit_date": "2012-06-13T20:23:29Z",
      "author": {
        "login": "bradfitz",
        "type": "User",
        "stats": {
          "total_commits": 2382,
          "average_weekly_commits": 2.7037457434733256,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 440
        }
      },
      "commit_message": {
        "title": "[release-branch.go1] debug/gosym: in test, use temp binary name in /tmp, and clean up.",
        "length": 288,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 16,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/pkg/debug/gosym/pclntab_test.go",
          "status": "modified",
          "additions": 16,
          "deletions": 2,
          "patch": "@@ -7,14 +7,19 @@ package gosym\n import (\n \t\"debug/elf\"\n \t\"fmt\"\n+\t\"io/ioutil\"\n \t\"os\"\n \t\"os/exec\"\n+\t\"path/filepath\"\n \t\"runtime\"\n \t\"strings\"\n \t\"testing\"\n )\n \n-var pclinetestBinary string\n+var (\n+\tpclineTempDir    string\n+\tpclinetestBinary string\n+)\n \n func dotest() bool {\n \t// For now, only works on ELF platforms.\n@@ -24,10 +29,18 @@ func dotest() bool {\n \tif pclinetestBinary != \"\" {\n \t\treturn true\n \t}\n+\tvar err error\n+\tpclineTempDir, err = ioutil.TempDir(\"\", \"pclinetest\")\n+\tif err != nil {\n+\t\tpanic(err)\n+\t}\n+\tif strings.Contains(pclineTempDir, \" \") {\n+\t\tpanic(\"unexpected space in tempdir\")\n+\t}\n \t// This command builds pclinetest from pclinetest.asm;\n \t// the resulting binary looks like it was built from pclinetest.s,\n \t// but we have renamed it to keep it away from the go tool.\n-\tpclinetestBinary = os.TempDir() + \"/pclinetest\"\n+\tpclinetestBinary = filepath.Join(pclineTempDir, \"pclinetest\")\n \tcommand := fmt.Sprintf(\"go tool 6a -o %s.6 pclinetest.asm && go tool 6l -E main -o %s %s.6\",\n \t\tpclinetestBinary, pclinetestBinary, pclinetestBinary)\n \tcmd := exec.Command(\"sh\", \"-c\", command)\n@@ -170,6 +183,7 @@ func TestPCLine(t *testing.T) {\n \tif !dotest() {\n \t\treturn\n \t}\n+\tdefer os.RemoveAll(pclineTempDir)\n \n \tf, tab := crack(pclinetestBinary, t)\n \ttext := f.Section(\".text\")"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bd80d8956f3062d2b2bff2d7da6b879dfa909f12",
            "date": "2025-01-14T04:00:14Z",
            "author_login": "rsc"
          },
          {
            "sha": "4fa61d6f9c9c7c3a5e74472f1cfb9c12eed1a368",
            "date": "2025-01-14T13:22:08Z",
            "author_login": "rsc"
          },
          {
            "sha": "c5e205e928bd4b70c90698b5ca1dd583a8036864",
            "date": "2025-01-14T00:21:29Z",
            "author_login": "randall77"
          },
          {
            "sha": "befc43655b6d93f0be883222fbb3fde5768892c1",
            "date": "2025-01-13T17:11:22Z",
            "author_login": "cuishuang"
          },
          {
            "sha": "c83f2ca4b3964917adc3b06f661785cc6b53792d",
            "date": "2025-01-14T14:58:32Z",
            "author_login": "ianlancetaylor"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-377",
    "description": "golang/go in 1.0.2 fixes all.bash on shared machines. dotest() in src/pkg/debug/gosym/pclntab_test.go creates a temporary file with predicable name and executes it as shell script.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-09T11:15:07.750",
    "last_modified": "2024-11-21T01:39:24.307",
    "fix_date": "2012-06-13T20:23:29Z"
  },
  "references": [
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=765455",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://codereview.appspot.com/5992078",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/golang/go/commit/8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210902-0009/",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2012-2666",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=765455",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://codereview.appspot.com/5992078",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/golang/go/commit/8ac275bb01588a8c0e6c0fe2de7fd11f08feccdd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210902-0009/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2012-2666",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.291481",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "go",
    "owner": "golang",
    "created_at": "2014-08-19T04:33:40Z",
    "updated_at": "2025-01-14T13:58:25Z",
    "pushed_at": "2025-01-13T19:19:33Z",
    "size": 385472,
    "stars": 125082,
    "forks": 17781,
    "open_issues": 9602,
    "watchers": 125082,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "dev.boringcrypto.go1.8",
      "dev.boringcrypto.go1.9",
      "dev.boringcrypto.go1.10",
      "dev.boringcrypto.go1.11",
      "dev.boringcrypto.go1.12",
      "dev.boringcrypto.go1.13",
      "dev.boringcrypto.go1.14",
      "dev.boringcrypto.go1.15",
      "dev.boringcrypto.go1.16",
      "dev.boringcrypto.go1.17",
      "dev.boringcrypto.go1.18",
      "dev.boringcrypto",
      "dev.cc",
      "dev.cmdgo",
      "dev.coretypes",
      "dev.debug",
      "dev.fuzz",
      "dev.garbage",
      "dev.gcfe",
      "dev.go2go",
      "dev.inline",
      "dev.link",
      "dev.power64",
      "dev.regabi",
      "dev.ssa",
      "dev.tls",
      "dev.typealias",
      "dev.typeparams",
      "dev.types",
      "dev.unified"
    ],
    "languages": {
      "Go": 47823232,
      "Assembly": 3216144,
      "HTML": 2621355,
      "C": 122435,
      "Shell": 64551,
      "Perl": 32036,
      "JavaScript": 20759,
      "Python": 19317,
      "Batchfile": 9485,
      "Dockerfile": 3563,
      "Makefile": 1868,
      "Awk": 450
    },
    "commit_activity": {
      "total_commits_last_year": 2897,
      "avg_commits_per_week": 55.71153846153846,
      "days_active_last_year": 341
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T14:07:55.970395"
  }
}