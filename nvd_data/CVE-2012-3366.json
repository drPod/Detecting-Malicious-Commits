{
  "cve_id": "CVE-2012-3366",
  "github_data": {
    "repository": "Bcfg2/bcfg2",
    "fix_commit": "a524967e8d5c4c22e49cd619aed20c87a316c0be",
    "related_commits": [
      "a524967e8d5c4c22e49cd619aed20c87a316c0be",
      "a524967e8d5c4c22e49cd619aed20c87a316c0be"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a524967e8d5c4c22e49cd619aed20c87a316c0be",
      "commit_date": "2012-06-12T13:20:10Z",
      "author": {
        "login": "stpierre",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed major security flaw in Trigger plugin",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 40,
        "additions": 25,
        "deletions": 15
      },
      "files": [
        {
          "filename": "src/lib/Server/Plugins/Trigger.py",
          "status": "modified",
          "additions": 25,
          "deletions": 15,
          "patch": "@@ -1,17 +1,7 @@\n import os\n+import pipes\n import Bcfg2.Server.Plugin\n-\n-\n-def async_run(prog, args):\n-    pid = os.fork()\n-    if pid:\n-        os.waitpid(pid, 0)\n-    else:\n-        dpid = os.fork()\n-        if not dpid:\n-            os.system(\" \".join([prog] + args))\n-        os._exit(0)\n-\n+from subprocess import Popen, PIPE\n \n class Trigger(Bcfg2.Server.Plugin.Plugin,\n               Bcfg2.Server.Plugin.Statistics):\n@@ -30,15 +20,35 @@ def __init__(self, core, datastore):\n                               \"unloading\" % self.data)\n             raise Bcfg2.Server.Plugin.PluginInitError\n \n+    def async_run(self, args):\n+        pid = os.fork()\n+        if pid:\n+            os.waitpid(pid, 0)\n+        else:\n+            dpid = os.fork()\n+            if not dpid:\n+                self.debug_log(\"Running %s\" % \" \".join(pipes.quote(a)\n+                                                       for a in args))\n+                proc = Popen(args, stdin=PIPE, stdout=PIPE, stderr=PIPE)\n+                (out, err) = proc.communicate()\n+                rv = proc.wait()\n+                if rv != 0:\n+                    self.logger.error(\"Trigger: Error running %s (%s): %s\" %\n+                                      (args[0], rv, err))\n+                elif err:\n+                    self.debug_log(\"Trigger: Error: %s\" % err)\n+            os._exit(0)\n+\n     def process_statistics(self, metadata, _):\n         args = [metadata.hostname, '-p', metadata.profile, '-g',\n                 ':'.join([g for g in metadata.groups])]\n+        self.debug_log(\"running triggers\")\n         for notifier in os.listdir(self.data):\n+            self.debug_log(\"running %s\" % notifier)\n             if ((notifier[-1] == '~') or\n                 (notifier[:2] == '.#') or\n                 (notifier[-4:] == '.swp') or\n                 (notifier in ['SCCS', '.svn', '4913'])):\n                 continue\n-            npath = self.data + '/' + notifier\n-            self.logger.debug(\"Running %s %s\" % (npath, \" \".join(args)))\n-            async_run(npath, args)\n+            npath = os.path.join(self.data, notifier)\n+            self.async_run([npath] + args)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8f1f9b9a490c59638192bae41007a788c977b3f9",
            "date": "2023-11-23T16:58:24Z",
            "author_login": "solj"
          },
          {
            "sha": "efd80093e732403bf4cc3a131eb5796cae7d9e17",
            "date": "2021-06-18T15:12:39Z",
            "author_login": "AlexanderS"
          },
          {
            "sha": "8605cd3d0cb4d549cb8b43de945d447f6d82892a",
            "date": "2019-11-26T07:55:09Z",
            "author_login": "xschlef"
          },
          {
            "sha": "493f984d59c2aebb64cf4d44553cf31badc734d1",
            "date": "2019-10-14T14:07:38Z",
            "author_login": "solj"
          },
          {
            "sha": "930a4a209cbba053aea78c7c49535edd96155609",
            "date": "2019-10-14T14:01:16Z",
            "author_login": "solj"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-78",
    "description": "The Trigger plugin in bcfg2 1.2.x before 1.2.3 allows remote attackers with root access to the client to execute arbitrary commands via shell metacharacters in the UUID field to the server process (bcfg2-server).",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2012-07-03T16:40:35.007",
    "last_modified": "2024-11-21T01:40:43.083",
    "fix_date": "2012-06-12T13:20:10Z"
  },
  "references": [
    {
      "url": "http://permalink.gmane.org/gmane.comp.sysutils.bcfg2.devel/4539",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/49629",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/49690",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2012/dsa-2503",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/54217",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/76616",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/Bcfg2/bcfg2/commit/a524967e8d5c4c22e49cd619aed20c87a316c0be",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://permalink.gmane.org/gmane.comp.sysutils.bcfg2.devel/4539",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/49629",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/49690",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2012/dsa-2503",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/54217",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/76616",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Bcfg2/bcfg2/commit/a524967e8d5c4c22e49cd619aed20c87a316c0be",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:07.284933",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "bcfg2",
    "owner": "Bcfg2",
    "created_at": "2011-12-03T14:26:50Z",
    "updated_at": "2024-11-28T16:29:24Z",
    "pushed_at": "2023-11-23T16:58:24Z",
    "size": 15466,
    "stars": 92,
    "forks": 58,
    "open_issues": 38,
    "watchers": 92,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 2652145,
      "XSLT": 62514,
      "JavaScript": 62227,
      "HTML": 31552,
      "Shell": 24004,
      "Makefile": 6904,
      "CSS": 4712,
      "Tcl": 1305
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:18:41.142727"
  }
}