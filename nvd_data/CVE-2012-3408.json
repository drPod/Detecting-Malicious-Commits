{
  "cve_id": "CVE-2012-3408",
  "github_data": {
    "repository": "puppetlabs/puppet",
    "fix_commit": "ab9150baa1b738467a33b01df1d90e076253fbbd",
    "related_commits": [
      "ab9150baa1b738467a33b01df1d90e076253fbbd",
      "ab9150baa1b738467a33b01df1d90e076253fbbd"
    ],
    "patch_url": "https://github.com/puppetlabs/puppet/commit/ab9150baa1b738467a33b01df1d90e076253fbbd.patch",
    "fix_commit_details": {
      "sha": "ab9150baa1b738467a33b01df1d90e076253fbbd",
      "commit_date": "2012-06-26T23:46:45Z",
      "author": {
        "login": "nicklewis",
        "type": "User",
        "stats": {
          "total_commits": 465,
          "average_weekly_commits": 0.45058139534883723,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 110
        }
      },
      "commit_message": {
        "title": "Deprecate IP-based authentication",
        "length": 147,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 37,
        "additions": 32,
        "deletions": 5
      },
      "files": [
        {
          "filename": "lib/puppet/network/authstore.rb",
          "status": "modified",
          "additions": 10,
          "deletions": 2,
          "patch": "@@ -150,7 +150,16 @@ def ip?\n \n       # Does this declaration match the name/ip combo?\n       def match?(name, ip)\n-        ip? ? pattern.include?(IPAddr.new(ip)) : matchname?(name)\n+        if ip?\n+          if pattern.include?(IPAddr.new(ip))\n+            Puppet.deprecation_warning \"Authentication based on IP address is deprecated; please use certname-based rules instead\"\n+            true\n+          else\n+            false\n+          end\n+        else\n+          matchname?(name)\n+        end\n       end\n \n       # Set the pattern appropriately.  Also sets the name and length.\n@@ -212,7 +221,6 @@ def matchname?(name)\n \n       # Convert the name to a common pattern.\n       def munge_name(name)\n-        # LAK:NOTE http://snurl.com/21zf8  [groups_google_com]\n         # Change to name.downcase.split(\".\",-1).reverse for FQDN support\n         name.downcase.split(\".\").reverse\n       end"
        },
        {
          "filename": "spec/integration/network/rest_authconfig_spec.rb",
          "status": "modified",
          "additions": 22,
          "deletions": 3,
          "patch": "@@ -44,12 +44,31 @@ def add_regex_rule(regex, rule)\n   end\n \n   def request(args = {})\n-    { :ip => '10.1.1.1', :node => 'host.domain.com', :key => 'key', :authenticated => true }.each do |k,v|\n-      args[k] ||= v\n-    end\n+    args = {\n+      :key => 'key',\n+      :node => 'host.domain.com',\n+      :ip => '10.1.1.1',\n+      :authenticated => true\n+    }.merge(args)\n     ['test', :find, args[:key], args]\n   end\n \n+  it \"should warn when matching against IP addresses\" do\n+    add_rule(\"allow 10.1.1.1\")\n+\n+    @auth.should allow(request)\n+\n+    @logs.should be_any {|log| log.level == :warning and log.message =~ /Authentication based on IP address is deprecated/}\n+  end\n+\n+  it \"should not warn when matches against IP addresses fail\" do\n+    add_rule(\"allow 10.1.1.2\")\n+\n+    @auth.should_not allow(request)\n+\n+    @logs.should_not be_any {|log| log.level == :warning and log.message =~ /Authentication based on IP address is deprecated/}\n+  end\n+\n   it \"should support IPv4 address\" do\n     add_rule(\"allow 10.1.1.1\")\n "
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e227c27540975c25aa22d533a52424a9d2fc886a",
            "date": "2024-12-11T04:01:36Z",
            "author_login": "joshcooper"
          },
          {
            "sha": "68f8b7da048c9f0275c36e3551a749b97023be33",
            "date": "2024-12-10T23:25:31Z",
            "author_login": "mhashizume"
          },
          {
            "sha": "603c0d4cea997f3680fb5d51fa3a7e41e4426038",
            "date": "2024-12-10T23:21:26Z",
            "author_login": "puppetlabs-jenkins"
          },
          {
            "sha": "e9671155fea02a3ec18d336cf57b3c057711ca32",
            "date": "2024-11-26T00:39:13Z",
            "author_login": "cthorn42"
          },
          {
            "sha": "295d2f9071a46d82f73947963f761471bd011d88",
            "date": "2024-11-25T23:41:34Z",
            "author_login": "mhashizume"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-287",
    "description": "lib/puppet/network/authstore.rb in Puppet before 2.7.18, and Puppet Enterprise before 2.5.2, supports use of IP addresses in certnames without warning of potential risks, which might allow remote attackers to spoof an agent by acquiring a previously used IP address.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2012-08-06T16:55:05.133",
    "last_modified": "2024-11-21T01:40:48.643",
    "fix_date": "2012-06-26T23:46:45Z"
  },
  "references": [
    {
      "url": "http://puppetlabs.com/security/cve/cve-2012-3408/",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=839166",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/puppetlabs/puppet/commit/ab9150baa1b738467a33b01df1d90e076253fbbd",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://puppetlabs.com/security/cve/cve-2012-3408/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=839166",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/puppetlabs/puppet/commit/ab9150baa1b738467a33b01df1d90e076253fbbd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:07.292798",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "puppet",
    "owner": "puppetlabs",
    "created_at": "2010-09-14T19:26:44Z",
    "updated_at": "2025-01-13T14:35:03Z",
    "pushed_at": "2024-12-11T04:01:36Z",
    "size": 90565,
    "stars": 7496,
    "forks": 2192,
    "open_issues": 73,
    "watchers": 7496,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "6.x",
      "7.x",
      "main"
    ],
    "languages": {
      "Ruby": 12928684,
      "HTML": 48622,
      "Puppet": 20259,
      "Shell": 12321,
      "C#": 5195,
      "Pascal": 858,
      "Batchfile": 594
    },
    "commit_activity": {
      "total_commits_last_year": 506,
      "avg_commits_per_week": 9.73076923076923,
      "days_active_last_year": 146
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:10:48.445221"
  }
}