{
  "cve_id": "CVE-2012-3503",
  "github_data": {
    "repository": "Katello/katello",
    "fix_commit": "7c256fef9d75029d0ffff58ff1dcda915056d3a3",
    "related_commits": [
      "7c256fef9d75029d0ffff58ff1dcda915056d3a3",
      "7c256fef9d75029d0ffff58ff1dcda915056d3a3"
    ],
    "patch_url": "https://github.com/Katello/katello/commit/7c256fef9d75029d0ffff58ff1dcda915056d3a3.patch",
    "fix_commit_details": {
      "sha": "7c256fef9d75029d0ffff58ff1dcda915056d3a3",
      "commit_date": "2012-08-22T11:20:32Z",
      "author": {
        "login": "lzap",
        "type": "User",
        "stats": {
          "total_commits": 930,
          "average_weekly_commits": 1.3098591549295775,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 99
        }
      },
      "commit_message": {
        "title": "Merge pull request #499 from lzap/secret_token",
        "length": 111,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 32,
        "additions": 20,
        "deletions": 12
      },
      "files": [
        {
          "filename": "src/config/initializers/secret_token.rb",
          "status": "modified",
          "additions": 13,
          "deletions": 6,
          "patch": "@@ -1,7 +1,14 @@\n-# Be sure to restart your server when you modify this file.\n+require 'active_support/secure_random'\n \n-# Your secret key for verifying the integrity of signed cookies.\n-# If you change this key, all old signed cookies will become invalid!\n-# Make sure the secret is at least 30 characters and all random,\n-# no regular words or you'll be exposed to dictionary attacks.\n-Src::Application.config.secret_token = 'f466b184ef680822293d7130f57593a7087a34b5de0607c64d1ceb66fcac4dce6810a6f176feba3fbbf2489de93c0918397c0c275996eb476b2fa6079ab849c1'\n+begin\n+  # Read token string from the file.\n+  token = IO.read('/etc/katello/secret_token')\n+  raise RuntimeError, 'Size is too small' if token.length < 9\n+  Src::Application.config.secret_token = token.chomp\n+rescue Exception => e\n+  # If anything is wrong make sure the token is random. This is safe even when\n+  # Katello is not configured correctly for any reason (but session is lost\n+  # after each restart).\n+  Rails.logger.warn \"Using randomly generated secure token: #{e.message}\"\n+  Src::Application.config.secret_token = ActiveSupport::SecureRandom.hex(80)\n+end"
        },
        {
          "filename": "src/katello.spec",
          "status": "modified",
          "additions": 7,
          "deletions": 6,
          "patch": "@@ -364,19 +364,20 @@ install -m 644 man/katello-service.8 %{buildroot}/%{_mandir}/man8\n /sbin/chkconfig --add %{name}\n /sbin/chkconfig --add %{name}-jobs\n \n-%postun common\n-#update config/initializers/secret_token.rb with new key\n-NEWKEY=$(</dev/urandom tr -dc A-Za-z0-9 | head -c128)\n-sed -i \"s/^Src::Application.config.secret_token = '.*'/Src::Application.config.secret_token = '$NEWKEY'/\" \\\n-    %{homedir}/config/initializers/secret_token.rb\n+#Generate secret token if the file does not exist\n+#(this must be called both for installation and upgrade)\n+TOKEN=/etc/katello/secret_token\n+test -f $TOKEN || (echo $(</dev/urandom tr -dc A-Za-z0-9 | head -c128) > $TOKEN \\\n+    && chmod 600 $TOKEN && chown katello:katello $TOKEN)\n \n %posttrans common\n-rm %{datadir}/Gemfile.lock\n+rm -f %{datadir}/Gemfile.lock 2>/dev/null\n /sbin/service %{name} condrestart >/dev/null 2>&1 || :\n \n %files\n %attr(600, katello, katello)\n %{_bindir}/katello-*\n+%ghost %attr(600, katello, katello) %{_sysconfdir}/%{name}/secret_token\n %{homedir}/app/controllers\n %{homedir}/app/helpers\n %{homedir}/app/mailers"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b316f4cc1faacb70307c692c693b31a122a48198",
            "date": "2025-01-13T18:55:43Z",
            "author_login": "stejskalleos"
          },
          {
            "sha": "68b1db34593597d77dbba126a53dbec2d3aa4fa3",
            "date": "2025-01-13T15:00:20Z",
            "author_login": "qcjames53"
          },
          {
            "sha": "25e95465376dfead5d0772dd24fb873dd5bb0f2a",
            "date": "2025-01-09T20:20:56Z",
            "author_login": "lfu"
          },
          {
            "sha": "f5f8f4f56120ee21ddbd497004c4575bf9f2f5eb",
            "date": "2024-12-03T17:43:17Z",
            "author_login": "quba42"
          },
          {
            "sha": "469efd5b76f78869fdc92d442853315678ea77e9",
            "date": "2024-12-16T14:09:39Z",
            "author_login": "MariaAga"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-798",
    "description": "The installation script in Katello 1.0 and earlier does not properly generate the Application.config.secret_token value, which causes each default installation to have the same secret token, and allows remote attackers to authenticate to the CloudForms System Engine web interface as an arbitrary user by creating a cookie using the default secret_token.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2012-08-25T10:29:52.693",
    "last_modified": "2024-11-21T01:41:00.773",
    "fix_date": "2012-08-22T11:20:32Z"
  },
  "references": [
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2012-1186.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2012-1187.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/50344",
      "source": "secalert@redhat.com",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/55140",
      "source": "secalert@redhat.com",
      "tags": [
        "Broken Link",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Katello/katello/commit/7c256fef9d75029d0ffff58ff1dcda915056d3a3",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Katello/katello/pull/499",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2012-1186.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2012-1187.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/50344",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/55140",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Katello/katello/commit/7c256fef9d75029d0ffff58ff1dcda915056d3a3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Katello/katello/pull/499",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:10.688848",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "katello",
    "owner": "Katello",
    "created_at": "2012-04-12T16:59:08Z",
    "updated_at": "2025-01-13T18:55:47Z",
    "pushed_at": "2025-01-13T18:55:43Z",
    "size": 229961,
    "stars": 382,
    "forks": 297,
    "open_issues": 104,
    "watchers": 382,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 16031331,
      "Ruby": 4774352,
      "HTML": 527840,
      "SCSS": 96907,
      "PLpgSQL": 5377,
      "Makefile": 2340,
      "Shell": 465
    },
    "commit_activity": {
      "total_commits_last_year": 351,
      "avg_commits_per_week": 6.75,
      "days_active_last_year": 182
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:59:51.166034"
  }
}