{
  "cve_id": "CVE-2012-4968",
  "github_data": {
    "repository": "silverstripe/sapphire",
    "fix_commit": "0085876",
    "related_commits": [
      "0085876",
      "0085876"
    ],
    "patch_url": "https://github.com/silverstripe/sapphire/commit/0085876.patch",
    "fix_commit_details": {
      "sha": "0085876",
      "commit_date": "2012-01-31T00:07:24Z",
      "author": {
        "login": "chillu",
        "type": "User",
        "stats": {
          "total_commits": 6173,
          "average_weekly_commits": 6.753829321663019,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 485
        }
      },
      "commit_message": {
        "title": "BUGFIX Casting return values on text helper methods in StringField, Text, Varchar",
        "length": 81,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 100,
        "additions": 97,
        "deletions": 3
      },
      "files": [
        {
          "filename": "core/model/fieldtypes/HTMLText.php",
          "status": "modified",
          "additions": 20,
          "deletions": 1,
          "patch": "@@ -28,6 +28,25 @@ function LimitCharacters($limit = 20, $add = \"...\") {\n \t\treturn (strlen($value) > $limit) ? substr($value, 0, $limit) . $add : $value;\n \t}\n \n+\tstatic $casting = array(\n+\t\t\"AbsoluteLinks\" => \"HTMLText\",\n+\t\t\"BigSummary\" => \"HTMLText\",\n+\t\t\"ContextSummary\" => \"HTMLText\",\n+\t\t\"FirstParagraph\" => \"HTMLText\",\n+\t\t\"FirstSentence\" => \"HTMLText\",\n+\t\t\"LimitCharacters\" => \"HTMLText\",\n+\t\t\"LimitSentences\" => \"HTMLText\",\n+\t\t\"Lower\" => \"HTMLText\",\n+\t\t\"LowerCase\" => \"HTMLText\",\n+\t\t\"Summary\" => \"HTMLText\",\n+\t\t\"Upper\" => \"HTMLText\",\n+\t\t\"UpperCase\" => \"HTMLText\",\n+\t\t'EscapeXML' => 'HTMLText',\n+\t\t'LimitWordCount' => 'HTMLText',\n+\t\t'LimitWordCountXML' => 'HTMLText',\n+\t\t'NoHTML' => 'Text',\n+\t);\n+\n \t/**\n \t * Create a summary of the content. This will be some section of the first paragraph, limited by\n \t * $maxWords. All internal tags are stripped out - the return value is a string\n@@ -133,4 +152,4 @@ public function scaffoldSearchField($title = null) {\n \n }\n \n-?>\n\\ No newline at end of file\n+?>"
        },
        {
          "filename": "core/model/fieldtypes/StringField.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -9,6 +9,12 @@\n abstract class StringField extends DBField {\n \tprotected $nullifyEmpty = true;\n \n+\tstatic $casting = array(\n+\t\t\"LimitCharacters\" => \"Text\",\n+\t\t\"Lower\" => \"Text\",\n+\t\t\"Upper\" => \"Text\",\n+\t);\n+\n \t/**\n \t * Construct a string type field with a set of optional parameters\n \t * @param $name string The name of the field"
        },
        {
          "filename": "core/model/fieldtypes/Text.php",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -17,8 +17,20 @@\n  * @subpackage model\n  */\n class Text extends StringField {\n+\n \tstatic $casting = array(\n-\t\t\"AbsoluteLinks\" => \"HTMLText\",\n+\t\t\"AbsoluteLinks\" => \"Text\",\n+\t\t\"BigSummary\" => \"Text\",\n+\t\t\"ContextSummary\" => \"Text\",\n+\t\t\"FirstParagraph\" => \"Text\",\n+\t\t\"FirstSentence\" => \"Text\",\n+\t\t\"LimitCharacters\" => \"Text\",\n+\t\t\"LimitSentences\" => \"Text\",\n+\t\t\"Summary\" => \"Text\",\n+\t\t'EscapeXML' => 'Text',\n+\t\t'LimitWordCount' => 'Text',\n+\t\t'LimitWordCountXML' => 'HTMLText',\n+\t\t'NoHTML' => 'Text',\n \t);\n \t\n  \t/**"
        },
        {
          "filename": "core/model/fieldtypes/Varchar.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -10,6 +10,11 @@\n  * @subpackage model\n  */\n class Varchar extends StringField {\n+\n+\tstatic $casting = array(\n+\t\t\"Initial\" => \"Text\",\n+\t\t\"URL\" => \"Text\",\n+\t);\n \t\n \tprotected $size;\n \t "
        },
        {
          "filename": "tests/fieldtypes/HTMLTextTest.php",
          "status": "modified",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -102,5 +102,33 @@ function testFirstSentence() {\n \t\t\t$this->assertEquals($match, $textObj->FirstSentence());\n \t\t}\n \t}\t\n+\n+\tpublic function testRAW() {\n+\t\t$data = DBField::create('HTMLText', 'This &amp; This');\n+\t\t$this->assertEquals($data->RAW(), 'This &amp; This');\n+\n+\t\t$data = DBField::create('HTMLText', 'This & This');\n+\t\t$this->assertEquals($data->RAW(), 'This & This');\n+\t}\n+\t\n+\tpublic function testXML() {\n+\t\t$data = DBField::create('HTMLText', 'This & This');\n+\t\t$this->assertEquals($data->XML(), 'This &amp; This');\n+\t}\n+\n+\tpublic function testHTML() {\n+\t\t$data = DBField::create('HTMLText', 'This & This');\n+\t\t$this->assertEquals($data->HTML(), 'This &amp; This');\n+\t}\n+\n+\tpublic function testJS() {\n+\t\t$data = DBField::create('HTMLText', '\"this is a test\"');\n+\t\t$this->assertEquals($data->JS(), '\\\"this is a test\\\"');\n+\t}\n+\n+\tpublic function testATT() {\n+\t\t$data = DBField::create('HTMLText', '\"this is a test\"');\n+\t\t$this->assertEquals($data->ATT(), '&quot;this is a test&quot;');\n+\t}\n }\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "tests/fieldtypes/TextTest.php",
          "status": "modified",
          "additions": 25,
          "deletions": 1,
          "patch": "@@ -142,6 +142,30 @@ function testContextSummary() {\n \t\t\t'A dog <span class=\"highlight\">ate</span> a cat while looking at a Foobar',\n \t\t\t$textObj->ContextSummary(100, $testKeyword3a)\n \t\t);\n-\t\t\n \t}\t\n+\n+\tpublic function testRAW() {\n+\t\t$data = DBField::create('Text', 'This &amp; This');\n+\t\t$this->assertEquals($data->RAW(), 'This &amp; This');\n+\t}\n+\t\n+\tpublic function testXML() {\n+\t\t$data = DBField::create('Text', 'This & This');\n+\t\t$this->assertEquals($data->XML(), 'This &amp; This');\n+\t}\n+\n+\tpublic function testHTML() {\n+\t\t$data = DBField::create('Text', 'This & This');\n+\t\t$this->assertEquals($data->HTML(), 'This &amp; This');\n+\t}\n+\n+\tpublic function testJS() {\n+\t\t$data = DBField::create('Text', '\"this is a test\"');\n+\t\t$this->assertEquals($data->JS(), '\\\"this is a test\\\"');\n+\t}\n+\n+\tpublic function testATT() {\n+\t\t$data = DBField::create('Text', '\"this is a test\"');\n+\t\t$this->assertEquals($data->ATT(), '&quot;this is a test&quot;');\n+\t}\n }\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1fa66f3a67b9230cdbc35193d01c240f2cbfaa53",
            "date": "2025-01-14T04:27:57Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "cd1d5de426061264b602944040613f2121eb1dce",
            "date": "2025-01-13T03:19:46Z",
            "author_login": "GuySartorelli"
          },
          {
            "sha": "0aa00a63f093f9d33a00835dd43740f959f1d078",
            "date": "2025-01-13T02:58:41Z",
            "author_login": "emteknetnz"
          },
          {
            "sha": "94af2e58d29efa8a7fed94175c40a8efa09e584d",
            "date": "2025-01-10T01:03:05Z",
            "author_login": "GuySartorelli"
          },
          {
            "sha": "3f5b363688b027986a186227f983a0205a07fef3",
            "date": "2025-01-10T01:02:53Z",
            "author_login": "GuySartorelli"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in SilverStripe 2.3.x before 2.3.13 and 2.4.x before 2.4.7 allow remote attackers to inject arbitrary web script or HTML via (1) a crafted string to the AbsoluteLinks, (2) BigSummary, (3) ContextSummary, (4) EscapeXML, (5) FirstParagraph, (6) FirstSentence, (7) Initial, (8) LimitCharacters, (9) LimitSentences, (10) LimitWordCount, (11) LimitWordCountXML, (12) Lower, (13) LowerCase, (14) NoHTML, (15) Summary, (16) Upper, (17) UpperCase, or (18) URL method in a template, different vectors than CVE-2012-0976.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2012-09-17T17:55:03.173",
    "last_modified": "2024-11-21T01:43:49.847",
    "fix_date": "2012-01-31T00:07:24Z"
  },
  "references": [
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.3.13",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.4.7",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/3",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/silverstripe/sapphire/commit/0085876",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.3.13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://doc.silverstripe.org/framework/en/trunk/changelogs/2.4.7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2012/04/30/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/silverstripe/sapphire/commit/0085876",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:10.699874",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "silverstripe-framework",
    "owner": "silverstripe",
    "created_at": "2011-02-02T02:04:13Z",
    "updated_at": "2025-01-14T04:28:01Z",
    "pushed_at": "2025-01-14T04:27:59Z",
    "size": 114606,
    "stars": 722,
    "forks": 823,
    "open_issues": 673,
    "watchers": 722,
    "has_security_policy": false,
    "default_branch": "5",
    "protected_branches": [
      "2.1",
      "2.2",
      "2.3",
      "2.4",
      "3",
      "3.0",
      "3.5",
      "3.6",
      "3.7",
      "4",
      "4.2",
      "4.3",
      "4.4",
      "4.5",
      "4.6",
      "4.7",
      "4.8",
      "4.9",
      "4.10",
      "4.11",
      "4.12",
      "4.13",
      "5",
      "5.0",
      "5.1",
      "5.2",
      "5.3",
      "6",
      "6.0"
    ],
    "languages": {
      "PHP": 7175112,
      "Scheme": 33358,
      "CSS": 4378,
      "Shell": 3006,
      "JavaScript": 452,
      "HTML": 195
    },
    "commit_activity": {
      "total_commits_last_year": 293,
      "avg_commits_per_week": 5.634615384615385,
      "days_active_last_year": 145
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:46:23.169806"
  }
}