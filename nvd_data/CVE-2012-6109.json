{
  "cve_id": "CVE-2012-6109",
  "github_data": {
    "repository": "rack/rack",
    "fix_commit": "c9f65df37a151821eb88ddd1dc404b83e52c52d5",
    "related_commits": [
      "c9f65df37a151821eb88ddd1dc404b83e52c52d5",
      "c9f65df37a151821eb88ddd1dc404b83e52c52d5"
    ],
    "patch_url": "https://github.com/rack/rack/commit/c9f65df37a151821eb88ddd1dc404b83e52c52d5.patch",
    "fix_commit_details": {
      "sha": "c9f65df37a151821eb88ddd1dc404b83e52c52d5",
      "commit_date": "2012-05-13T22:02:17Z",
      "author": {
        "login": "raggi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix parsing performance for unquoted filenames",
        "length": 125,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 22,
        "deletions": 2
      },
      "files": [
        {
          "filename": "lib/rack/multipart.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -12,7 +12,7 @@ module Multipart\n     MULTIPART = %r|\\Amultipart/.*boundary=\\\"?([^\\\";,]+)\\\"?|n\n     TOKEN = /[^\\s()<>,;:\\\\\"\\/\\[\\]?=]+/\n     CONDISP = /Content-Disposition:\\s*#{TOKEN}\\s*/i\n-    DISPPARM = /;\\s*(#{TOKEN})=(\"(?:\\\\\"|[^\"])*\"|#{TOKEN})*/\n+    DISPPARM = /;\\s*(#{TOKEN})=(\"(?:\\\\\"|[^\"])*\"|#{TOKEN})/\n     RFC2183 = /^#{CONDISP}(#{DISPPARM})+$/i\n     BROKEN_QUOTED = /^#{CONDISP}.*;\\sfilename=\"(.*?)\"(?:\\s*$|\\s*;\\s*#{TOKEN}=)/i\n     BROKEN_UNQUOTED = /^#{CONDISP}.*;\\sfilename=(#{TOKEN})/i\n@@ -31,4 +31,4 @@ def build_multipart(params, first = true)\n     end\n \n   end\n-end\n\\ No newline at end of file\n+end"
        },
        {
          "filename": "test/spec_multipart.rb",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -295,4 +295,24 @@ def multipart_file(name)\n       message.should.equal \"value must be a Hash\"\n   end\n \n+  should \"parse very long unquoted multipart file names\" do\n+    data = <<-EOF\n+--AaB03x\\r\n+Content-Type: text/plain\\r\n+Content-Disposition: attachment; name=file; filename=#{'long' * 100}\\r\n+\\r\n+contents\\r\n+--AaB03x--\\r\n+    EOF\n+\n+    options = {\n+      \"CONTENT_TYPE\" => \"multipart/form-data; boundary=AaB03x\",\n+      \"CONTENT_LENGTH\" => data.length.to_s,\n+      :input => StringIO.new(data)\n+    }\n+    env = Rack::MockRequest.env_for(\"/\", options)\n+    params = Rack::Utils::Multipart.parse_multipart(env)\n+\n+    params[\"file\"][:filename].should.equal('long' * 100)\n+  end\n end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "49d4ed033f9c6d0bdba7b2a181437589049dbf7f",
            "date": "2025-01-03T23:29:09Z",
            "author_login": "ioquatix"
          },
          {
            "sha": "e9f2f246377da9d1c1cb55dae4328273ef235488",
            "date": "2024-12-11T06:18:49Z",
            "author_login": "ioquatix"
          },
          {
            "sha": "f682e0e413ff3070b6fad10d672a5dc92f69ee3e",
            "date": "2024-12-11T05:59:24Z",
            "author_login": "ioquatix"
          },
          {
            "sha": "c52c1b6428b4841e7a634b80d73f28e1cffd8c12",
            "date": "2024-12-10T02:37:02Z",
            "author_login": "ioquatix"
          },
          {
            "sha": "05e3997a4ad78e38a0532c14b1014c661ad8bc12",
            "date": "2024-11-24T21:01:44Z",
            "author_login": "AllyMarthaJ"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "lib/rack/multipart.rb in Rack before 1.1.4, 1.2.x before 1.2.6, 1.3.x before 1.3.7, and 1.4.x before 1.4.2 uses an incorrect regular expression, which allows remote attackers to cause a denial of service (infinite loop) via a crafted Content-Disposion header.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-03-01T05:40:16.863",
    "last_modified": "2024-11-21T01:45:50.510",
    "fix_date": "2012-05-13T22:02:17Z"
  },
  "references": [
    {
      "url": "http://rack.github.com/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0544.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0548.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=895277",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/rack/rack/blob/master/README.rdoc",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/rack/rack/commit/c9f65df37a151821eb88ddd1dc404b83e52c52d5",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://groups.google.com/forum/#%21msg/rack-devel/1w4_fWEgTdI/XAkSNHjtdTsJ",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://rack.github.com/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0544.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0548.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=895277",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/rack/rack/blob/master/README.rdoc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/rack/rack/commit/c9f65df37a151821eb88ddd1dc404b83e52c52d5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://groups.google.com/forum/#%21msg/rack-devel/1w4_fWEgTdI/XAkSNHjtdTsJ",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:13.489998",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rack",
    "owner": "rack",
    "created_at": "2008-12-24T03:03:12Z",
    "updated_at": "2025-01-14T02:05:28Z",
    "pushed_at": "2025-01-03T23:42:02Z",
    "size": 10097,
    "stars": 4949,
    "forks": 1635,
    "open_issues": 10,
    "watchers": 4949,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1-5-stable",
      "1-6-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "3-0-stable",
      "3-1-stable",
      "main",
      "rack-0.4",
      "rack-0.9",
      "rack-1.0",
      "rack-1.1",
      "rack-1.2",
      "rack-1.3",
      "rack-1.4",
      "rack-1.5"
    ],
    "languages": {
      "Ruby": 661792,
      "CSS": 7342,
      "HTML": 49,
      "JavaScript": 34
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:07:02.368474"
  }
}