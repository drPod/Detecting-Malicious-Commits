{
  "cve_id": "CVE-2013-0234",
  "github_data": {
    "repository": "Elgg/Elgg",
    "fix_commit": "19dc507c2fccb378be2a44a762edf6c1e7afa334",
    "related_commits": [
      "19dc507c2fccb378be2a44a762edf6c1e7afa334",
      "a74a88501c41e89c8bcd7fc650ae2f8cc0a5003d",
      "19dc507c2fccb378be2a44a762edf6c1e7afa334",
      "a74a88501c41e89c8bcd7fc650ae2f8cc0a5003d"
    ],
    "patch_url": "https://github.com/Elgg/Elgg/commit/19dc507c2fccb378be2a44a762edf6c1e7afa334.patch",
    "fix_commit_details": {
      "sha": "19dc507c2fccb378be2a44a762edf6c1e7afa334",
      "commit_date": "2013-01-26T20:39:06Z",
      "author": {
        "login": "cash",
        "type": "User",
        "stats": {
          "total_commits": 3232,
          "average_weekly_commits": 3.980295566502463,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 131
        }
      },
      "commit_message": {
        "title": "Merged 1.8.13 release into master",
        "length": 99,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 220,
        "additions": 139,
        "deletions": 81
      },
      "files": [
        {
          "filename": "CHANGES.txt",
          "status": "modified",
          "additions": 26,
          "deletions": 1,
          "patch": "@@ -1,3 +1,28 @@\n+Version 1.8.13\n+(January 29, 2013 from https://github.com/Elgg/Elgg/tree/1.8)\n+  Contributing Developers:\n+   * Cash Costello\n+   * Juho Jaakkola\n+   * Kevin Jardine\n+   * Krzysztof R\u00f3\u017calski\n+   * Steve Clay\n+\n+  Security Fixes:\n+   * Added validation of Twitter usernames in Twitter widget\n+\n+  Bugfixes:\n+   * CLI usages with walled garden fixed\n+   * Upgrading from < 1.8 to 1.8 fixed\n+   * Default widgets fixed\n+   * Quotes in object titles no longer result in \"qout\" in URLs\n+   * List of my groups is ordered now\n+   * Language string river:comment:object:default is defined now\n+   * Added language string for comments: generic_comment:on\n+\n+  Enhancements:\n+   * Added confirm dialog for resetting profile fields (adds language string profile:resetdefault:confirm)\n+\n+\n Version 1.8.12\n (January 4th, 2013 from https://github.com/Elgg/Elgg/tree/1.8)\n   Contributing Developers:\n@@ -7,7 +32,6 @@ Version 1.8.12\n    * Matt Beckett\n    * Pawe\u0142 Sroka\n    * Sem\n-   * Srokap\n    * Steve Clay\n \n   Bugfixes:\n@@ -34,6 +58,7 @@ Version 1.8.12\n    * Twitter: Login with twitter supports persistent login and correctly forwards\n      after login.\n \n+\n Version 1.8.11\n (December 5th, 2012 from https://github.com/Elgg/Elgg/tree/1.8)\n "
        },
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n Elgg [![Build Status](https://secure.travis-ci.org/Elgg/Elgg.png?branch=master)](https://travis-ci.org/Elgg/Elgg)\n ====\n \n-Copyright (c) 2008-2012, see COPYRIGHT.txt\n+Copyright (c) 2008-2013, see COPYRIGHT.txt\n \n For development credits, see CONTRIBUTORS.txt.\n "
        },
        {
          "filename": "_graphics/walled_garden/one_column_bottom.png",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "_graphics/walled_garden/one_column_top.png",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "_graphics/walled_garden/two_column_bottom.png",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "_graphics/walled_garden/two_column_top.png",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "engine/classes/ElggPlugin.php",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -303,10 +303,7 @@ public function getAllSettings() {\n \t\t\t$return = array();\n \n \t\t\tforeach ($private_settings as $setting) {\n-\t\t\t\t$name = substr($setting->name, $ps_prefix_len);\n-\t\t\t\t$value = $setting->value;\n-\n-\t\t\t\t$return[$name] = $value;\n+\t\t\t\t$return[$setting->name] = $setting->value;\n \t\t\t}\n \n \t\t\treturn $return;"
        },
        {
          "filename": "engine/classes/ElggSite.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -405,6 +405,11 @@ public function getExportableValues() {\n \tpublic function checkWalledGarden() {\n \t\tglobal $CONFIG;\n \n+\t\t// command line calls should not invoke the walled garden check\n+\t\tif (PHP_SAPI === 'cli') {\n+\t\t\treturn;\n+\t\t}\n+\n \t\tif ($CONFIG->walled_garden) {\n \t\t\tif ($CONFIG->default_access == ACCESS_PUBLIC) {\n \t\t\t\t$CONFIG->default_access = ACCESS_LOGGED_IN;"
        },
        {
          "filename": "engine/lib/output.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -287,6 +287,8 @@ function elgg_get_friendly_title($title) {\n \n \t// handle some special cases\n \t$title = str_replace('&amp;', 'and', $title);\n+\t// quotes and angle brackets stored in the database as html encoded\n+\t$title = htmlspecialchars_decode($title);\n \n \t$title = ElggTranslit::urlize($title);\n "
        },
        {
          "filename": "engine/lib/private_settings.php",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -349,11 +349,6 @@ function set_private_setting($entity_guid, $name, $value) {\n \t$name = sanitise_string($name);\n \t$value = sanitise_string($value);\n \n-\t$entity = get_entity($entity_guid);\n-\tif (!$entity instanceof ElggEntity) {\n-\t\treturn false;\n-\t}\n-\n \t$result = insert_data(\"INSERT into {$CONFIG->dbprefix}private_settings\n \t\t(entity_guid, name, value) VALUES\n \t\t($entity_guid, '$name', '$value')"
        },
        {
          "filename": "engine/lib/upgrades/2011010101.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -93,4 +93,6 @@\n $processed_upgrades = array_unique($processed_upgrades);\n elgg_set_processed_upgrades($processed_upgrades);\n \n+_elgg_upgrade_unlock();\n+\n forward('upgrade.php');"
        },
        {
          "filename": "js/lib/languages.js",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -4,6 +4,9 @@\n  */\n elgg.provide('elgg.config.translations');\n \n+// default language - required by unit tests\n+elgg.config.language = 'en';\n+\n /**\n  * Analagous to the php version.  Merges translations for a\n  * given language into the current translations map."
        },
        {
          "filename": "languages/en.php",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -407,7 +407,8 @@\n \t'profile:editdefault:delete:fail' => 'Removed default profile item field failed',\n \t'profile:editdefault:delete:success' => 'Profile field deleted',\n \t'profile:defaultprofile:reset' => 'Profile fields reset to the system default',\n-\t'profile:resetdefault' => 'Reset default profile',\n+\t'profile:resetdefault' => 'Reset profile fields to system defaults',\n+\t'profile:resetdefault:confirm' => 'Are you sure you want to delete your custom profile fields?',\n \t'profile:explainchangefields' => \"You can replace the existing profile fields with your own using the form below. \\n\\n Give the new profile field a label, for example, 'Favorite team', then select the field type (eg. text, url, tags), and click the 'Add' button. To re-order the fields drag on the handle next to the field label. To edit a field label - click on the label's text to make it editable. \\n\\n At any time you can revert back to the default profile set up, but you will lose any information already entered into custom fields on profile pages.\",\n \t'profile:editdefault:success' => 'New profile field added',\n \t'profile:editdefault:fail' => 'Default profile could not be saved',\n@@ -665,6 +666,7 @@\n \n \n \t'admin:notices:could_not_delete' => 'Could not delete notice.',\n+\t'item:object:admin_notice' => 'Admin notice',\n \n \t'admin:options' => 'Admin options',\n \n@@ -690,7 +692,7 @@\n \t'admin:plugins:label:author' => \"Author\",\n \t'admin:plugins:label:copyright' => \"Copyright\",\n \t'admin:plugins:label:categories' => 'Categories',\n-\t'admin:plugins:label:licence' => \"Licence\",\n+\t'admin:plugins:label:licence' => \"License\",\n \t'admin:plugins:label:website' => \"URL\",\n \t'admin:plugins:label:repository' => \"Code\",\n \t'admin:plugins:label:bugtracker' => \"Report issue\",\n@@ -1156,7 +1158,7 @@\n \n \t'comments:count' => \"%s comments\",\n \n-\t'riveraction:annotation:generic_comment' => '%s commented on %s',\n+\t'river:comment:object:default' => '%s commented on %s',\n \n \t'generic_comments:add' => \"Leave a comment\",\n \t'generic_comments:post' => \"Post comment\",\n@@ -1170,6 +1172,7 @@\n \t'generic_comment:failure' => \"An unexpected error occurred when adding your comment.\",\n \t'generic_comment:none' => 'No comments',\n \t'generic_comment:title' => 'Comment by %s',\n+\t'generic_comment:on' => '%s on %s',\n \n \t'generic_comment:email:subject' => 'You have a new comment!',\n \t'generic_comment:email:body' => \"You have a new comment on your item \\\"%s\\\" from %s. It reads:"
        },
        {
          "filename": "mod/blog/start.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -124,9 +124,12 @@ function blog_page_handler($page) {\n \t\t\t$params = blog_get_page_content_archive($user->guid, $page[2], $page[3]);\n \t\t\tbreak;\n \t\tcase 'view':\n-\t\tcase 'read': // Elgg 1.7 compatibility\n \t\t\t$params = blog_get_page_content_read($page[1]);\n \t\t\tbreak;\n+\t\tcase 'read': // Elgg 1.7 compatibility\n+\t\t\tregister_error(elgg_echo(\"changebookmark\"));\n+\t\t\tforward(\"blog/view/{$page[1]}\");\n+\t\t\tbreak;\n \t\tcase 'add':\n \t\t\tgatekeeper();\n \t\t\t$params = blog_get_page_content_edit($page_type, $page[1]);"
        },
        {
          "filename": "mod/bookmarks/start.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -125,11 +125,14 @@ function bookmarks_page_handler($page) {\n \t\t\tinclude \"$pages/friends.php\";\n \t\t\tbreak;\n \n-\t\tcase \"read\":\n \t\tcase \"view\":\n \t\t\tset_input('guid', $page[1]);\n \t\t\tinclude \"$pages/view.php\";\n \t\t\tbreak;\n+\t\tcase 'read': // Elgg 1.7 compatibility\n+\t\t\tregister_error(elgg_echo(\"changebookmark\"));\n+\t\t\tforward(\"bookmarks/view/{$page[1]}\");\n+\t\t\tbreak;\n \n \t\tcase \"add\":\n \t\t\tgatekeeper();"
        },
        {
          "filename": "mod/file/start.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -121,8 +121,11 @@ function file_page_handler($page) {\n \t\t\tfile_register_toggle();\n \t\t\tinclude \"$file_dir/friends.php\";\n \t\t\tbreak;\n-\t\tcase 'view':\n \t\tcase 'read': // Elgg 1.7 compatibility\n+\t\t\tregister_error(elgg_echo(\"changebookmark\"));\n+\t\t\tforward(\"file/view/{$page[1]}\");\n+\t\t\tbreak;\n+\t\tcase 'view':\n \t\t\tset_input('guid', $page[1]);\n \t\t\tinclude \"$file_dir/view.php\";\n \t\t\tbreak;"
        },
        {
          "filename": "mod/file/views/default/object/file.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -68,6 +68,7 @@\n \n \t$params = array(\n \t\t'entity' => $file,\n+\t\t'title' => false,\n \t\t'metadata' => $metadata,\n \t\t'subtitle' => $subtitle,\n \t);\n@@ -79,7 +80,6 @@\n \n \techo elgg_view('object/elements/full', array(\n \t\t'entity' => $file,\n-\t\t'title' => false,\n \t\t'icon' => $file_icon,\n \t\t'summary' => $summary,\n \t\t'body' => $body,"
        },
        {
          "filename": "mod/groups/views/default/groups/css.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,8 +10,8 @@\n \tmargin-right: 10px;\n }\n .groups-profile img {\n-    width: 100%;\n-    height: auto;\n+\twidth: 100%;\n+\theight: auto;\n }\n .groups-stats {\n \tbackground: #eeeeee;"
        },
        {
          "filename": "mod/groups/views/default/groups/profile/summary.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -16,7 +16,9 @@\n $owner = $group->getOwnerEntity();\n \n if (!$owner) {\n-\treturn true;\n+\t// not having an owner is very bad so we throw an exception\n+\t$msg = elgg_echo('InvalidParameterException:IdNotExistForGUID', array('group owner', $group->guid));\n+\tthrow new InvalidParameterException($msg);\n }\n \n ?>"
        },
        {
          "filename": "mod/notifications/actions/groupsave.php",
          "status": "modified",
          "additions": 5,
          "deletions": 8,
          "patch": "@@ -30,14 +30,11 @@\n \t}\n }\n \n-// Load important global vars\n-global $NOTIFICATION_HANDLERS;\n-foreach($NOTIFICATION_HANDLERS as $method => $foo) {\n-\t$subscriptions[$method] = get_input($method.'subscriptions');\n-\t$personal[$method] = get_input($method.'personal');\n-\t$collections[$method] = get_input($method.'collections');\n-\tif (!empty($groups)) {\n-\t\tforeach($groups as $group) {\n+if (!empty($groups)) {\n+\tglobal $NOTIFICATION_HANDLERS;\n+\tforeach ($NOTIFICATION_HANDLERS as $method => $foo) {\n+\t\t$subscriptions[$method] = get_input($method.'subscriptions', array());\n+\t\tforeach ($groups as $group) {\n \t\t\tif (in_array($group, $subscriptions[$method])) {\n \t\t\t\tadd_entity_relationship($user->guid, 'notify'.$method, $group);\n \t\t\t} else {"
        },
        {
          "filename": "mod/twitter/languages/en.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -7,8 +7,10 @@\n \n \t'twitter:title' => 'Twitter',\n \t'twitter:info' => 'Display your latest tweets',\n-\t'twitter:username' => 'Enter your twitter username.',\n-\t'twitter:num' => 'The number of tweets to show.',\n+\t'twitter:username' => 'Your twitter username',\n+\t'twitter:num' => 'Number of tweets to show*',\n \t'twitter:visit' => 'visit my twitter',\n-\t'twitter:notset' => 'This Twitter widget is not yet set to go. To display your latest tweets, click on - edit - and fill in your details',\n+\t'twitter:notset' => 'This widget needs to be configured. To display your latest tweets, click the customize icon and fill in your Twitter username.',\n+\t'twitter:invalid' => 'This widget is configured with an invalid Twitter username. Click the customize icon to correct it.',\n+\t'twitter:apibug' => \"*Due to a bug in the Twitter 1.0 API, you may see fewer tweets than you ask for.\",\n );"
        },
        {
          "filename": "mod/twitter/views/default/widgets/twitter/content.php",
          "status": "modified",
          "additions": 25,
          "deletions": 14,
          "patch": "@@ -6,26 +6,37 @@\n  * @package ElggTwitter\n  */\n \n-//some required params\n-\n $username = $vars['entity']->twitter_username;\n+\n+if (empty($username)) {\n+\techo \"<p>\" . elgg_echo(\"twitter:notset\") . \"</p>\";\n+\treturn;\n+}\n+\n+$username_is_valid = preg_match('~^[a-zA-Z0-9_]{1,20}$~', $username);\n+if (!$username_is_valid) {\n+\techo \"<p>\" . elgg_echo(\"twitter:invalid\") . \"</p>\";\n+\treturn;\n+}\n+\n+\n $num = $vars['entity']->twitter_num;\n+if (empty($num)) {\n+\t$num = 5;\n+}\n \n-// if the twitter username is empty, then do not show\n-if ($username) {\n+// @todo upgrade to 1.1 API https://dev.twitter.com/docs/api/1.1/get/statuses/home_timeline\n+$script_url = \"https://api.twitter.com/1/statuses/user_timeline/\" . urlencode($username) . \".json\"\n+            . \"?callback=twitterCallback2&count=\" . (int) $num;\n \n ?>\n-\n <div id=\"twitter_widget\">\n \t<ul id=\"twitter_update_list\"></ul>\n-\t<p class=\"visit_twitter\"><a href=\"http://twitter.com/<?php echo $username; ?>\"><?php echo elgg_echo(\"twitter:visit\"); ?></a></p>\n+\t<p class=\"visit_twitter\"><?php echo elgg_view('output/url', array(\n+\t\t'text' => elgg_echo(\"twitter:visit\"),\n+\t\t'href' => 'http://twitter.com/' . urlencode($username),\n+\t\t'is_trusted' => true,\n+\t)) ?></p>\n \t<script type=\"text/javascript\" src=\"http://twitter.com/javascripts/blogger.js\"></script>\n-\t<script type=\"text/javascript\" src=\"https://api.twitter.com/1/statuses/user_timeline/<?php echo $username; ?>.json?callback=twitterCallback2&count=<?php echo $num; ?>\"></script>\n+\t<script type=\"text/javascript\" src=\"<?php echo htmlspecialchars($script_url, ENT_QUOTES, 'UTF-8') ?>\"></script>\n </div>\n-\n-<?php\n-} else {\n-\n-\techo \"<p>\" . elgg_echo(\"twitter:notset\") . \".</p>\";\n-\n-}"
        },
        {
          "filename": "mod/twitter/views/default/widgets/twitter/edit.php",
          "status": "modified",
          "additions": 20,
          "deletions": 12,
          "patch": "@@ -1,16 +1,24 @@\n <?php\n \n-    /**\n-\t * Elgg twitter edit page\n-\t *\n-\t * @package ElggTwitter\n-\t */\n+/**\n+ * Elgg twitter edit page\n+ *\n+ * @package ElggTwitter\n+ */\n \n ?>\n-\t<p>\n-\t\t<?php echo elgg_echo(\"twitter:username\"); ?>\n-\t\t<input type=\"text\" name=\"params[twitter_username]\" value=\"<?php echo htmlentities($vars['entity']->twitter_username); ?>\" />\t\n-\t\t<br /><?php echo elgg_echo(\"twitter:num\"); ?>\n-\t\t<input type=\"text\" name=\"params[twitter_num]\" value=\"<?php echo htmlentities($vars['entity']->twitter_num); ?>\" />\t\n-\t\n-\t</p>\n\\ No newline at end of file\n+<div>\n+\t<?php echo elgg_echo(\"twitter:username\"); ?>\n+\t<?php echo elgg_view('input/text', array(\n+\t\t'name' => 'params[twitter_username]',\n+\t\t'value' => $vars['entity']->twitter_username,\n+\t)) ?>\n+</div>\n+<div>\n+\t<?php echo elgg_echo(\"twitter:num\"); ?>\n+\t<?php echo elgg_view('input/text', array(\n+\t\t'name' => 'params[twitter_num]',\n+\t\t'value' => $vars['entity']->twitter_num,\n+\t)) ?>\n+\t<span class=\"elgg-text-help\"><?php echo elgg_echo(\"twitter:apibug\"); ?></span>\n+</div>\n\\ No newline at end of file"
        },
        {
          "filename": "version.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n \n // YYYYMMDD = Elgg Date\n // XX = Interim incrementer\n-$version = 2011110700;\n+$version = 2013012600;\n \n // Human-friendly version name\n $release = '1.9.0-dev';"
        },
        {
          "filename": "views/default/admin/appearance/profile_fields.php",
          "status": "modified",
          "additions": 10,
          "deletions": 2,
          "patch": "@@ -5,12 +5,20 @@\n \n $add = elgg_view_form('profile/fields/add', array('class' => 'elgg-form-settings'), array());\n $list = elgg_view('admin/appearance/profile_fields/list');\n-$reset = elgg_view_form('profile/fields/reset', array(), array());\n+\n+$reset = elgg_view('output/confirmlink', array(\n+\t'text' => elgg_echo('reset'),\n+\t'href' => 'action/profile/fields/reset',\n+\t'title' => elgg_echo('profile:resetdefault'),\n+\t'confirm' => elgg_echo('profile:resetdefault:confirm'),\n+\t'class' => 'elgg-button elgg-button-cancel',\n+\t'is_trusted' => 'true',\n+));\n \n $body = <<<__HTML\n $add\n $list\n-$reset\n+<div class=\"mtl\">$reset</div>\n __HTML;\n \n echo $body;"
        },
        {
          "filename": "views/default/annotation/generic_comment.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -55,13 +55,13 @@\n \n \t//@todo need link to actual comment!\n \n-\t$on = elgg_echo('on');\n+\t$commented_on = elgg_echo('generic_comment:on', array($commenter_link, $entity_link));\n \n \t$excerpt = elgg_get_excerpt($comment->value, 80);\n \n \t$body = <<<HTML\n <span class=\"elgg-subtext\">\n-\t$commenter_link $on $entity_link ($friendlytime): $excerpt\n+\t$commented_on ($friendlytime): $excerpt\n </span>\n HTML;\n "
        },
        {
          "filename": "views/default/css/elements/layout.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -119,4 +119,4 @@\n }\n .elgg-page-footer a:hover {\n \tcolor: #666;\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "views/default/css/elements/modules.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -190,4 +190,4 @@\n .elgg-widget-placeholder {\n \tborder: 2px dashed #dedede;\n \tmargin-bottom: 15px;\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "views/default/css/elements/typography.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -157,6 +157,6 @@\n \tpadding: 3px 5px;\n }\n .elgg-output img {\n-    max-width: 100%;\n-    height: auto;\n-}\n\\ No newline at end of file\n+\tmax-width: 100%;\n+\theight: auto;\n+}"
        },
        {
          "filename": "views/default/forms/profile/fields/reset.php",
          "status": "removed",
          "additions": 0,
          "deletions": 12,
          "patch": "@@ -1,12 +0,0 @@\n-<?php\n-/**\n- * Reset profile fields form\n- */\n-\n-echo '<div class=\"elgg-foot\">';\n-$params = array(\n-\t'value' => elgg_echo('profile:resetdefault'),\n-\t'class' => 'elgg-button-cancel',\n-);\n-echo elgg_view('input/submit', $params);\n-echo '</div>';"
        },
        {
          "filename": "views/default/js/elgg.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -56,7 +56,8 @@\n elgg.version = '<?php echo get_version(); ?>';\n elgg.release = '<?php echo get_version(true); ?>';\n elgg.config.wwwroot = '<?php echo elgg_get_site_url(); ?>';\n-elgg.security.interval = 5 * 60 * 1000; <?php //@todo make this configurable ?>\n+<?php //@todo make this configurable ?>\n+elgg.security.interval = 5 * 60 * 1000;\n elgg.config.domReady = false;\n elgg.config.language = '<?php echo isset($CONFIG->language) ? $CONFIG->language : 'en'; ?>';\n elgg.config.languageReady = false;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 21,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7d499e7e9f9b6b63d76af05386f8b22c0218db19",
            "date": "2025-01-10T13:04:01Z",
            "author_login": "callpri"
          },
          {
            "sha": "b8a599b7f557a144cffdc71a67284a6a1f4931c5",
            "date": "2025-01-07T07:33:29Z",
            "author_login": "jdalsem"
          },
          {
            "sha": "d4e4907c28d8a1313dfcdd61fa0a8299bc90d4bc",
            "date": "2025-01-06T08:39:01Z",
            "author_login": "jdalsem"
          },
          {
            "sha": "2c18b88858304c48a9034cbd908b3c44b7d31f1d",
            "date": "2024-12-20T12:35:42Z",
            "author_login": "jdalsem"
          },
          {
            "sha": "0b2a89d12b6bab12b1e6d388c45768b49a0dee73",
            "date": "2024-12-17T10:18:32Z",
            "author_login": "jdalsem"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in the Twitter widget in Elgg before 1.7.17 and 1.8.x before 1.8.13 allows remote attackers to inject arbitrary web script or HTML via the params[twitter_username] parameter to action/widgets/save.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-02-02T20:55:14.133",
    "last_modified": "2024-11-21T01:47:07.400",
    "fix_date": "2013-01-26T20:39:06Z"
  },
  "references": [
    {
      "url": "http://blog.elgg.org/pg/blog/cash/read/223/elgg-1813-and-1717",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/119903/Elgg-Twitter-Widget-Cross-Site-Scripting.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2013/Jan/251",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/52007",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/01/29/4",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/57569",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/Elgg/Elgg/commit/19dc507c2fccb378be2a44a762edf6c1e7afa334#L0R11",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Elgg/Elgg/commit/a74a88501c41e89c8bcd7fc650ae2f8cc0a5003d#L2L21",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://blog.elgg.org/pg/blog/cash/read/223/elgg-1813-and-1717",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/119903/Elgg-Twitter-Widget-Cross-Site-Scripting.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2013/Jan/251",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/52007",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/01/29/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/57569",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Elgg/Elgg/commit/19dc507c2fccb378be2a44a762edf6c1e7afa334#L0R11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Elgg/Elgg/commit/a74a88501c41e89c8bcd7fc650ae2f8cc0a5003d#L2L21",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.545998",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Elgg",
    "owner": "Elgg",
    "created_at": "2009-09-06T17:10:11Z",
    "updated_at": "2025-01-14T04:30:00Z",
    "pushed_at": "2025-01-10T13:04:01Z",
    "size": 112037,
    "stars": 1645,
    "forks": 665,
    "open_issues": 61,
    "watchers": 1645,
    "has_security_policy": false,
    "default_branch": "6.x",
    "protected_branches": [
      "1.9",
      "1.10",
      "1.11",
      "1.12",
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "4.0",
      "4.1",
      "4.2",
      "4.3",
      "5.0",
      "5.1",
      "6.x",
      "6.0",
      "6.1",
      "historical",
      "master"
    ],
    "languages": {
      "PHP": 7490540,
      "JavaScript": 126858,
      "CSS": 90887,
      "HTML": 29948,
      "Hack": 2033
    },
    "commit_activity": {
      "total_commits_last_year": 444,
      "avg_commits_per_week": 8.538461538461538,
      "days_active_last_year": 99
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:06:55.251250"
  }
}