{
  "cve_id": "CVE-2013-0256",
  "github_data": {
    "repository": "rdoc/rdoc",
    "fix_commit": "ffa87887ee0517793df7541629a470e331f9fe60",
    "related_commits": [
      "ffa87887ee0517793df7541629a470e331f9fe60",
      "ffa87887ee0517793df7541629a470e331f9fe60"
    ],
    "patch_url": "https://github.com/rdoc/rdoc/commit/ffa87887ee0517793df7541629a470e331f9fe60.patch",
    "fix_commit_details": {
      "sha": "ffa87887ee0517793df7541629a470e331f9fe60",
      "commit_date": "2013-02-06T03:57:58Z",
      "author": {
        "login": "drbrain",
        "type": "User",
        "stats": {
          "total_commits": 1661,
          "average_weekly_commits": 1.453193350831146,
          "total_additions": 158887,
          "total_deletions": 93099,
          "weeks_active": 156
        }
      },
      "commit_message": {
        "title": "Fix CVE-2013-0256, an XSS exploit in RDoc",
        "length": 145,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 74,
        "additions": 65,
        "deletions": 9
      },
      "files": [
        {
          "filename": "CVE-2013-0256.rdoc",
          "status": "added",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -0,0 +1,49 @@\n+= RDoc 2.3.0 through 3.12 XSS Exploit\n+\n+RDoc documentation generated by rdoc 2.3.0 through rdoc 3.12 and prereleases up\n+to rdoc 4.0.0.preview2.1 are vulnerable to an XSS exploit.  This exploit may\n+lead to cookie disclosure to third parties.\n+\n+The exploit exists in darkfish.js which is copied from the RDoc install\n+location to the generated documentation.\n+\n+RDoc is a static documentation generation tool.  Patching the library itself\n+is insufficient to correct this exploit.  Those hosting rdoc documentation will\n+need to apply the following patch.  If applied while ignoring whitespace, this\n+patch will correct all affected versions:\n+\n+  diff --git darkfish.js darkfish.js\n+  index 4be722f..f26fd45 100644\n+  --- darkfish.js\n+  +++ darkfish.js\n+  @@ -109,13 +109,15 @@ function hookSearch() {\n+   function highlightTarget( anchor ) {\n+     console.debug( \"Highlighting target '%s'.\", anchor );\n+   \n+  -  $(\"a[name=\" + anchor + \"]\").each( function() {\n+  -    if ( !$(this).parent().parent().hasClass('target-section') ) {\n+  -      console.debug( \"Wrapping the target-section\" );\n+  -      $('div.method-detail').unwrap( 'div.target-section' );\n+  -      $(this).parent().wrap( '<div class=\"target-section\"></div>' );\n+  -    } else {\n+  -      console.debug( \"Already wrapped.\" );\n+  +  $(\"a[name]\").each( function() {\n+  +    if ( $(this).attr(\"name\") == anchor ) {\n+  +      if ( !$(this).parent().parent().hasClass('target-section') ) {\n+  +        console.debug( \"Wrapping the target-section\" );\n+  +        $('div.method-detail').unwrap( 'div.target-section' );\n+  +        $(this).parent().wrap( '<div class=\"target-section\"></div>' );\n+  +      } else {\n+  +        console.debug( \"Already wrapped.\" );\n+  +      }\n+       }\n+     });\n+   };\n+\n+RDoc 3.9.5, 3.12.1 and RDoc 4.0.0.rc.2 and newer are not vulnerable to this\n+exploit.\n+\n+This exploit was discovered by Evgeny Ermakov <corwmh@gmail.com>.\n+\n+This vulnerability has been assigned the CVE identifier CVE-2013-0256.\n+"
        },
        {
          "filename": "History.rdoc",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-=== 4.0.0.preview3.1 / ??\n+=== 4.0.0.rc.2 / ??\n \n As a preview release, please file bugs for any problems you have with rdoc at\n https://github.com/rdoc/rdoc/issues\n@@ -14,6 +14,9 @@ to build HTML documentation when installing gems.)\n   * Added current heading and page-top links to HTML headings.\n \n * Bug fixes\n+  * Fixed an XSS exploit in darkfish.js.  This could lead to cookie disclosure\n+    to third parties.  See CVE-2012-0256.rdoc for full details including a\n+    patch you can apply to generated RDoc documentation.\n   * Fixed parsing of multibyte files with incomplete characters at byte 1024.\n     Ruby bug #6393 by nobu, patch by Nobuyoshi Nakada and Yui NARUSE.\n   * Fixed rdoc -E.  Ruby Bug #6392 and (modified) patch by Nobuyoshi Nakada"
        },
        {
          "filename": "Manifest.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,5 +1,6 @@\n .autotest\n .document\n+CVE-2013-0256.rdoc\n DEVELOPERS.rdoc\n History.rdoc\n LEGAL.rdoc"
        },
        {
          "filename": "Rakefile",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -48,6 +48,7 @@ Depending on your version of ruby, you may need to install ruby rdoc/ri data:\n   self.testlib = :minitest\n   self.extra_rdoc_files += %w[\n     DEVELOPERS.rdoc\n+    CVE-2013-0256.rdoc\n     History.rdoc\n     LICENSE.rdoc\n     LEGAL.rdoc"
        },
        {
          "filename": "lib/rdoc.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -64,7 +64,7 @@ class Error < RuntimeError; end\n   ##\n   # RDoc version you are using\n \n-  VERSION = '4.0.0.preview3.1'\n+  VERSION = '4.0.0.rc.2'\n \n   ##\n   # Method visibilities"
        },
        {
          "filename": "lib/rdoc/generator/template/darkfish/js/darkfish.js",
          "status": "modified",
          "additions": 9,
          "deletions": 7,
          "patch": "@@ -109,13 +109,15 @@ function hookSearch() {\n function highlightTarget( anchor ) {\n   console.debug( \"Highlighting target '%s'.\", anchor );\n \n-  $(\"a[name=\" + anchor + \"]\").each( function() {\n-    if ( !$(this).parent().parent().hasClass('target-section') ) {\n-      console.debug( \"Wrapping the target-section\" );\n-      $('div.method-detail').unwrap( 'div.target-section' );\n-      $(this).parent().wrap( '<div class=\"target-section\"></div>' );\n-    } else {\n-      console.debug( \"Already wrapped.\" );\n+  $(\"a[name]\").each( function() {\n+    if ( $(this).attr(\"name\") == anchor ) {\n+      if ( !$(this).parent().parent().hasClass('target-section') ) {\n+        console.debug( \"Wrapping the target-section\" );\n+        $('div.method-detail').unwrap( 'div.target-section' );\n+        $(this).parent().wrap( '<div class=\"target-section\"></div>' );\n+      } else {\n+        console.debug( \"Already wrapped.\" );\n+      }\n     }\n   });\n };"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b795077e6187847c83c2c3da41ccc7e05a9a7f6a",
            "date": "2025-01-13T15:58:35Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "d62da8ca09c5c2d5829ecfb5d33b71e0c7a71613",
            "date": "2025-01-08T16:17:51Z",
            "author_login": "rhenium"
          },
          {
            "sha": "b6a82244a2592e5a9ca980896829f5cafad54ed8",
            "date": "2025-01-07T00:53:45Z",
            "author_login": "mterada1228"
          },
          {
            "sha": "a047068ad6ad00d49be99af53ba481b206492e96",
            "date": "2025-01-06T16:36:02Z",
            "author_login": "st0012"
          },
          {
            "sha": "fdbb192e2b621c795b0313dde58945202c58e303",
            "date": "2025-01-06T15:55:36Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "darkfish.js in RDoc 2.3.0 through 3.12 and 4.x before 4.0.0.preview2.1, as used in Ruby, does not properly generate documents, which allows remote attackers to conduct cross-site scripting (XSS) attacks via a crafted URL.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-03-01T05:40:17.583",
    "last_modified": "2024-11-21T01:47:10.307",
    "fix_date": "2013-02-06T03:57:58Z"
  },
  "references": [
    {
      "url": "http://blog.segment7.net/2013/02/06/rdoc-xss-vulnerability-cve-2013-0256-releases-3-9-5-3-12-1-4-0-0-rc-2",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2013-04/msg00015.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-02/msg00048.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0548.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0686.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0701.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0728.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/52774",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ruby-lang.org/en/news/2013/02/06/rdoc-xss-cve-2013-0256/",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-1733-1",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=907820",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/rdoc/rdoc/commit/ffa87887ee0517793df7541629a470e331f9fe60",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://blog.segment7.net/2013/02/06/rdoc-xss-vulnerability-cve-2013-0256-releases-3-9-5-3-12-1-4-0-0-rc-2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2013-04/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-02/msg00048.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0548.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0686.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0701.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-0728.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/52774",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ruby-lang.org/en/news/2013/02/06/rdoc-xss-cve-2013-0256/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-1733-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=907820",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/rdoc/rdoc/commit/ffa87887ee0517793df7541629a470e331f9fe60",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:13.490747",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rdoc",
    "owner": "rdoc",
    "created_at": "2010-12-23T19:32:54Z",
    "updated_at": "2025-01-13T15:58:41Z",
    "pushed_at": "2025-01-13T15:58:39Z",
    "size": 7820,
    "stars": 849,
    "forks": 441,
    "open_issues": 132,
    "watchers": 849,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Ruby": 1623820,
      "HTML": 22530,
      "CSS": 18496,
      "JavaScript": 15749
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:37:58.286818"
  }
}