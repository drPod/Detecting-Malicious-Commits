{
  "cve_id": "CVE-2013-0275",
  "github_data": {
    "repository": "ganglia/ganglia-web",
    "fix_commit": "31d348947419058c43b8dfcd062e2988abd5058e",
    "related_commits": [
      "31d348947419058c43b8dfcd062e2988abd5058e",
      "31d348947419058c43b8dfcd062e2988abd5058e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "31d348947419058c43b8dfcd062e2988abd5058e",
      "commit_date": "2013-01-18T20:03:18Z",
      "author": {
        "login": "vvuksan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Escape special characters. Clean up input",
        "length": 41,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 116,
        "additions": 64,
        "deletions": 52
      },
      "files": [
        {
          "filename": "actions.php",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -14,13 +14,13 @@\n   <?php\n   if ( isset($_GET['aggregate']) ) {\n   ?>\n-     <tr><th>Host regular expression</th><td><?php print join (\",\", $_GET['hreg']); ?></td></tr>\n-     <tr><th>Metric regular expression</th><td><?php print join (\",\", $_GET['mreg']); ?></td></tr>\n+     <tr><th>Host regular expression</th><td><?php print htmlspecialchars( join (\",\", $_GET['hreg']) ); ?></td></tr>\n+     <tr><th>Metric regular expression</th><td><?php print htmlspecialchars( join (\",\", $_GET['mreg']) ); ?></td></tr>\n   <?php\n     } else {\n   ?>\n-     <tr><th>Hostname</th><td><?php print $_GET['host_name']; ?></td></tr>\n-     <tr><th>Metric/Report</th><td><?php print $_GET['metric_name']; ?></td></tr>\n+     <tr><th>Hostname</th><td><?php print htmlspecialchars($_GET['host_name']); ?></td></tr>\n+     <tr><th>Metric/Report</th><td><?php print htmlspecialchars($_GET['metric_name']); ?></td></tr>\n   <?php\n   }\n   ?>\n@@ -35,17 +35,17 @@\n \tforeach ( $_GET as $key => $value ) {\n \t  if ( is_array($value) ) {\n \t    foreach ( $value as $index => $value2 ) {\n-\t      print '<input type=\"hidden\" name=\"' . $key .'[]\" value=\"' . $value2 . '\" />';\n+\t      print '<input type=\"hidden\" name=\"' . htmlspecialchars($key) .'[]\" value=\"' . htmlspecialchars($value2) . '\" />';\n \t    }\n \t  } else {\n-\t    print '<input type=\"hidden\" name=\"' . $key .'\" value=\"' . $value . '\" />';\n+\t    print '<input type=\"hidden\" name=\"' . htmlspecialchars($key) .'\" value=\"' . htmlspecialchars($value) . '\" />';\n \t  }\n \t}\n     } else {\n       // If hostname is not set we assume we are dealing with aggregate graphs\n-      print \"<input type=\\\"hidden\\\" name=\\\"host_name\\\" value=\\\"{$_GET['host_name']}\\\" />\";\n+      print \"<input type=\\\"hidden\\\" name=\\\"host_name\\\" value=\\\"\".htmlspecialchars($_GET['host_name']).\"\\\" />\";\n       $metric_name=$_GET['metric_name'];\n-      print \"<input type=\\\"hidden\\\" name=\\\"metric_name\\\" value=\\\"{$_GET['metric_name']}\\\" />\";\n+      print \"<input type=\\\"hidden\\\" name=\\\"metric_name\\\" value=\\\"\".htmlspecialchars($_GET['metric_name']).\"\\\" />\";\n       print \"<input type=\\\"hidden\\\" name=\\\"type\\\" value=\\\"{$_GET['type']}\\\">\";\n       if (isset($_GET['vl']) && ($_GET['vl'] !== ''))\n \t  print \"<input type=\\\"hidden\\\" name=\\\"vertical_label\\\" value=\\\"\" . htmlentities(stripslashes($_GET['vl'])) . \"\\\" />\";"
        },
        {
          "filename": "autorotation.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -127,7 +127,7 @@\n     <div style=\"margin-top: 10px; font-size: 48px; text-align: center;\"><?php echo date(DATE_RFC850); ?></div>\n     <p>\n     <center><form>\n-    <input type=\"hidden\" name=\"view_name\" value=\"<?php print $_GET['view_name'] ?>\">\n+    <input type=\"hidden\" name=\"view_name\" value=\"<?php print htmlspecialchars($_GET['view_name']) ?>\">\n     <input type=\"hidden\" name=\"id\" value=\"<?php print $nextid ?>\">\n     Rotate graphs every <select onChange=\"form.submit();\" name=\"timeout\">\n     <?php"
        },
        {
          "filename": "compare_hosts.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -56,12 +56,12 @@\n $hreg = \"\";\n if (array_key_exists('hreg', $_GET)) {\n   foreach ( $_GET['hreg'] as $index => $arg ) {\n-    $hreg .= \"&hreg[]=\" . $arg;\n+    $hreg .= \"&hreg[]=\" . rawurlencode($arg);\n   }\n }\n \n if ( isset($_GET['hreg']) ) {\n-  $data->assign(\"hreg_arg\", $_GET['hreg'][0]);\n+  $data->assign(\"hreg_arg\", htmlspecialchars($_GET['hreg'][0]) );\n } else {\n   $data->assign(\"hreg_arg\", \"\");\n }"
        },
        {
          "filename": "decompose_graph.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -23,10 +23,10 @@\n $graph_config = build_aggregate_graph_config ($graph_type, $line_width, $_GET['hreg'], $_GET['mreg']);\n \n foreach ( $_GET['hreg'] as $index => $arg ) {\n-  print \"<input type=hidden name=hreg[] value='\" . $arg . \"'>\";\n+  print \"<input type=hidden name=hreg[] value='\" . htmlspecialchars($arg) . \"'>\";\n }\n foreach ( $_GET['mreg'] as $index => $arg ) {\n-  print \"<input type=hidden name=mreg[] value='\" . $arg . \"'>\";\n+  print \"<input type=hidden name=mreg[] value='\" . htmlspecialchars($arg) . \"'>\";\n }\n \n $size = isset($clustergraphsize) ? $clustergraphsize : 'default';"
        },
        {
          "filename": "graph_all_periods.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -53,12 +53,12 @@ function openDecompose($url) {\n \n foreach ($_GET as $key => $value) {\n   if ( ! in_array($key, $ignore_keys_list) && ! is_array($value))\n-    $query_string_array[] = \"$key=\" . urlencode($value);\n+    $query_string_array[] = rawurlencode($key) . \"=\" . urlencode($value);\n \n   // $_GET argument is an array. Rebuild it to pass it on\n   if ( is_array($value) ) {\n     foreach ( $value as $index => $value2 )\n-      $query_string_array[] = $key . \"[]=\" . urlencode($value2);\n+      $query_string_array[] = rawurlencode($key) . \"[]=\" . urlencode($value2);\n \n   }\n }\n@@ -77,20 +77,20 @@ function openDecompose($url) {\n \n // Descriptive host/aggregate graph\n if (isset($_GET['h']) && ($_GET['h'] != ''))\n-  $description = $_GET['h'];\n+  $description = htmlspecialchars($_GET['h']);\n else if (isset($_GET['c']) && ($_GET['c'] != ''))\n-  $description = $_GET['c'];\n+  $description = htmlspecialchars($_GET['c']);\n else if (is_array($_GET['hreg']))\n-  $description = join(\",\", $_GET['hreg']);\n+  $description = htmlspecialchars( join(\",\", $_GET['hreg']) );\n else\n   $description = \"Unknown\";\n \n if (isset($_GET['g'])) \n-  $metric_description = $_GET['g'];\n+  $metric_description = htmlspecialchars($_GET['g']);\n else if ( isset($_GET['m'] ))\n-  $metric_description = $_GET['m'];\n+  $metric_description = htmlspecialchars($_GET['m']);\n else if (is_array($_GET['mreg']) )\n-  $metric_description = join(\",\", $_GET['mreg']);\n+  $metric_description = htmlspecialchars( join(\",\", $_GET['mreg']) );\n else\n   $metric_description = \"Unknown\";\n \n@@ -152,7 +152,7 @@ function openDecompose($url) {\n     <div data-role=\"page\" class=\"ganglia-mobile\" id=\"view-home\">\n     <div data-role=\"header\">\n       <a href=\"#\" class=\"ui-btn-left\" data-icon=\"arrow-l\" onclick=\"history.back(); return false\">Back</a>\n-      <h3><?php if (isset($_GET['g'])) echo $_GET['g']; else echo $_GET['m']; ?></h3>\n+      <h3><?php if (isset($_GET['g'])) echo htmlspecialchars($_GET['g']); else echo htmlspecialchars($_GET['m']); ?></h3>\n       <a href=\"#mobile-home\">Home</a>\n     </div>\n     <div data-role=\"content\">"
        },
        {
          "filename": "header.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -529,7 +529,7 @@ function make_node_menu($self,\n if ( $conf['overlay_events'] == true )\n   $data->assign('overlay_events', true);\n \n-$data->assign('selected_tab', $user['selected_tab']);\n+$data->assign('selected_tab', htmlspecialchars($user['selected_tab']) );\n $data->assign('view_name', $user['viewname']);\n \n $additional_buttons = \"\";"
        },
        {
          "filename": "mobile_helper.php",
          "status": "modified",
          "additions": 25,
          "deletions": 19,
          "patch": "@@ -14,7 +14,7 @@\n   <div data-role=\"page\" class=\"ganglia-mobile\" id=\"view-home\">\n     <div data-role=\"header\">\n       <a href=\"#\" class=\"ui-btn-left\" data-icon=\"arrow-l\" onclick=\"history.back(); return false\">Back</a>\n-      <h1>View <?php print $_GET['view_name']; ?></h1>\n+      <h1>View <?php print htmlspecialchars($_GET['view_name']); ?></h1>\n       <a href=\"#mobile-home\">Home</a>\n       <div data-role=\"navbar\">\n \t<ul>\n@@ -39,7 +39,7 @@\n       $checked = \"class=\\\"ui-btn-active\\\"\";\n       $range_menu .= \"<li><a $checked href='#' onclick='return false;'>$v</a></li>\";\n     } else {\n-      $range_menu .= \"<li><a href='mobile_helper.php?view_name=\" . $_GET['view_name'] . \"&r=\" . $v . \"&cs=&ce='>$v</a></li>\";\n+      $range_menu .= \"<li><a href='mobile_helper.php?view_name=\" . rawurlencode($_GET['view_name']) . \"&r=\" . $v . \"&cs=&ce='>$v</a></li>\";\n     }\n \n   }\n@@ -61,9 +61,9 @@\n \n       $range_args = \"\";\n       if ( isset($_GET['r']) && $_GET['r'] != \"\" ) \n-\t    $range_args .= \"&r=\" . $_GET['r'];\n+\t    $range_args .= \"&r=\" . rawurlencode($_GET['r']);\n       if ( isset($_GET['cs']) && isset($_GET['ce']) ) \n-\t    $range_args .= \"&cs=\" . $_GET['cs'] . \"&ce=\" . $_GET['ce'];\n+\t    $range_args .= \"&cs=\" . rawurlencode($_GET['cs']) . \"&ce=\" . rawurlencode($_GET['ce']);\n \n       if ( count($view_elements) != 0 ) {\n \tforeach ( $view_elements as $id => $element ) {\n@@ -93,7 +93,7 @@\n   <div data-role=\"page\" class=\"ganglia-mobile\" id=\"viewhost-<?php print $hostname; ?>\">\n     <div data-role=\"header\" data-position=\"fixed\">\n       <a href=\"#\" class=\"ui-btn-left\" data-icon=\"arrow-l\" onclick=\"history.back(); return false\">Back</a>\n-      <h3>Cluster <?php print $clustername; ?></h3>\n+      <h3>Cluster <?php print htmlspecialchars($clustername); ?></h3>\n       <a href=\"#mobile-home\">Home</a>\n         <div data-role=\"navbar\">\n \t<ul>\n@@ -114,7 +114,7 @@\n \t     $checked = \"class=\\\"ui-btn-active\\\"\";\n       \t     $range_menu .= \"<li><a $checked href='#'>$v</a></li>\";\n \t  } else {\n-      \t     $range_menu .= \"<li><a href='mobile_helper.php?show_cluster_metrics=1&c=\" . $clustername . \"&r=\" . $v . \"&cs=&ce='>$v</a></li>\";\n+      \t     $range_menu .= \"<li><a href='mobile_helper.php?show_cluster_metrics=1&c=\" . rawurlencode($clustername) . \"&r=\" . $v . \"&cs=&ce='>$v</a></li>\";\n \t  }\n \t}\n \t  print $range_menu;\n@@ -125,7 +125,7 @@\n   \n     <div data-role=\"content\">\n <?php\n-    $graph_args = \"c=$clustername&r=$range\";\n+    $graph_args = \"c=\".rawurlencode($clustername).\"&r=\".rawurlencode($range);\n     \n     ///////////////////////////////////////////////////////////////////////////\n     // Let's find out what optional reports are included\n@@ -137,7 +137,10 @@\n       $default_reports = array_merge($default_reports,json_decode(file_get_contents($conf['conf_dir'] . \"/default.json\"), TRUE));\n     }\n     \n-    $cluster_file = $conf['conf_dir'] . \"/cluster_\" . $clustername . \".json\";\n+    $cluster_file = $conf['conf_dir'] . \"/cluster_\" . preg_replace('/[^a-zA-Z0-9_-]/', '', $clustername) . \".json\";\n+    if ( pathinfo( $cluster_file, PATHINFO_DIRNAME ) != $conf['conf_dir'] ) {\n+      die('Invalid path detected');\n+    }\n     $override_reports = array(\"included_reports\" => array(), \"excluded_reports\" => array());\n     if ( is_file($cluster_file) ) {\n       $override_reports = array_merge($override_reports, json_decode(file_get_contents($cluster_file), TRUE));\n@@ -154,8 +157,8 @@\n     foreach ( $reports[\"included_reports\"] as $index => $report_name ) {\n       if ( ! in_array( $report_name, $reports[\"excluded_reports\"] ) ) {\n \tprint \"<a name=metric_\" . $report_name . \">\n-\t<A HREF=\\\"./graph_all_periods.php?mobile=1&$graph_args&amp;g=\" . $report_name . \"&amp;z=mobile&amp;c=$clustername\\\">\n-\t<IMG BORDER=0 ALT=\\\"$clustername\\\" SRC=\\\"./graph.php?$graph_args&amp;g=\" . $report_name .\"&amp;z=mobile&amp;c=$clustername\\\"></A>\n+\t<A HREF=\\\"./graph_all_periods.php?mobile=1&$graph_args&amp;g=\" . $report_name . \"&amp;z=mobile&amp;c=\".rawurlencode($clustername).\"\\\">\n+\t<IMG BORDER=0 ALT=\\\"\".rawurlencode($clustername).\"\\\" SRC=\\\"./graph.php?$graph_args&amp;g=\" . $report_name .\"&amp;z=mobile&amp;c=\".rawurlencode($clustername).\"\\\"></A>\n \t\";\n       }\n \n@@ -173,10 +176,10 @@\n   $hostname = $_GET['h'];\n   $clustername = $_GET['c'];\n ?>\n-  <div data-role=\"page\" class=\"ganglia-mobile\" id=\"viewhost-<?php print $hostname; ?>\">\n+  <div data-role=\"page\" class=\"ganglia-mobile\" id=\"viewhost-<?php print htmlspecialchars($hostname); ?>\">\n     <div data-role=\"header\" data-position=\"fixed\">\n       <a href=\"#\" class=\"ui-btn-left\" data-icon=\"arrow-l\" onclick=\"history.back(); return false\">Back</a>\n-      <h3>Host <?php print $hostname; ?></h3>\n+      <h3>Host <?php print htmlspecialchars($hostname); ?></h3>\n       <a href=\"#mobile-home\">Home</a>\n         <div data-role=\"navbar\">\n \t<ul>\n@@ -197,7 +200,7 @@\n \t     $checked = \"class=\\\"ui-btn-active\\\"\";\n       \t     $range_menu .= \"<li><a $checked href='#'>$v</a></li>\";\n \t  } else {\n-      \t     $range_menu .= \"<li><a href='mobile_helper.php?show_host_metrics=1&h=\" . $hostname . \"&c=\" . $clustername . \"&r=\" . $v . \"&cs=&ce='>$v</a></li>\";\n+      \t     $range_menu .= \"<li><a href='mobile_helper.php?show_host_metrics=1&h=\" . rawurlencode($hostname) . \"&c=\" . rawurlencode($clustername) . \"&r=\" . $v . \"&cs=&ce='>$v</a></li>\";\n \t  }\n \t}\n \t  print $range_menu;\n@@ -208,7 +211,7 @@\n   \n     <div data-role=\"content\">\n <?php\n-    $graph_args = \"h=$hostname&c=$clustername&r=$range\";\n+    $graph_args = \"h=\".rawurlencode($hostname).\"&c=\".rawurlencode($clustername).\"&r=\".rawurlencode($range);\n     \n     ///////////////////////////////////////////////////////////////////////////\n     // Let's find out what optional reports are included\n@@ -220,7 +223,10 @@\n       $default_reports = array_merge($default_reports,json_decode(file_get_contents($conf['conf_dir'] . \"/default.json\"), TRUE));\n     }\n     \n-    $host_file = $conf['conf_dir'] . \"/host_\" . $hostname . \".json\";\n+    $host_file = $conf['conf_dir'] . \"/host_\" . preg_replace('/[^a-zA-Z0-9_-]/', '', $hostname) . \".json\";\n+    if ( pathinfo( $host_file, PATHINFO_DIRNAME ) != $conf['conf_dir'] ) {\n+      die('Invalid path detected');\n+    }\n     $override_reports = array(\"included_reports\" => array(), \"excluded_reports\" => array());\n     if ( is_file($host_file) ) {\n       $override_reports = array_merge($override_reports, json_decode(file_get_contents($host_file), TRUE));\n@@ -239,7 +245,7 @@\n       if ( ! in_array( $report_name, $reports[\"excluded_reports\"] ) ) {\n \tprint \"\n \t<A HREF=\\\"./graph_all_periods.php?mobile=1&$graph_args&amp;g=\" . $report_name . \"&amp;z=large\\\">\n-\t<IMG BORDER=0 ALT=\\\"$clustername\\\" SRC=\\\"./graph.php?$graph_args&amp;g=\" . $report_name .\"&amp;z=mobile\\\"></A>\";\n+\t<IMG BORDER=0 ALT=\\\"\".rawurlencode($clustername).\"\\\" SRC=\\\"./graph.php?$graph_args&amp;g=\" . $report_name .\"&amp;z=mobile\\\"></A>\";\n       }\n     }\n     ?>  \n@@ -260,8 +266,8 @@\n   } else if (isset($reports[$metric_name]) and $reports[$metric])\n     continue;\n   else {\n-    $metric_graphargs = \"c=$clustername&amp;h=$hostname&amp;v=$metric_attributes[VAL]\"\n-      .\"&amp;m=$metric_name&amp;r=$range&amp;z=$size&amp;jr=$jobrange\"\n+    $metric_graphargs = \"c=\".rawurlencode($clustername).\"&amp;h=\".rawurlencode($hostname).\"&amp;v=\".rawurlencode($metric_attributes[VAL])\n+      .\"&amp;m=$metric_name&amp;r=\".rawurlencode($range).\"&amp;z=$size&amp;jr=$jobrange\"\n       .\"&amp;js=$jobstart&amp;st=$cluster[LOCALTIME]\";\n     if ($cs)\n        $metric_graphargs .= \"&amp;cs=\" . rawurlencode($cs);\n@@ -302,7 +308,7 @@\n       foreach ( $metric_group_members as $index => $metric_name ) {\n \tprint \"\n \t<A HREF=\\\"./graph_all_periods.php?mobile=1&\" . $g_metrics[$metric_name]['graph'] .  \"\\\">\n-\t<IMG BORDER=0 ALT=\\\"$clustername\\\" SRC=\\\"./graph.php?\" . $g_metrics[$metric_name]['graph'] . \"\\\"></A>\";\n+\t<IMG BORDER=0 ALT=\\\"\".htmlspecialchars($clustername).\"\\\" SRC=\\\"./graph.php?\" . $g_metrics[$metric_name]['graph'] . \"\\\"></A>\";\n       }\n ?>\n       </div> <!-- /collapsible -->"
        },
        {
          "filename": "trend_navigation.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -10,11 +10,11 @@\n \n foreach ( $_REQUEST as $key => $value ) {\n   if ( ! in_array($key, $drop_args) )\n-    $graph_args[] = $key . \"=\" . str_replace(\"_/graph_php?\", \"\", $value);\n+    $graph_args[] = rawurlencode($key) . \"=\" . rawurlencode( str_replace(\"_/graph_php?\", \"\", $value) );\n }\n \n $query_string = preg_replace(\"/(&trendrange=)(\\d+)/\", \"\", $_SERVER['QUERY_STRING'] );\n-$query_string = preg_replace(\"/(&trendhistory=)(\\d+)/\", \"\", $query_string);\n+$query_string = preg_replace(\"/(&trendhistory=)(\\d+)/\", \"\", htmlspecialchars($query_string, ENT_QUOTES) );\n \n \n ?>\n@@ -59,4 +59,4 @@\n   $(function () {\n     $(\"#trend_range_menu\").buttonset();\n   });\n-</script>\n\\ No newline at end of file\n+</script>"
        },
        {
          "filename": "views.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -10,7 +10,7 @@\n // Load the metric caching code we use if we need to display graphs\n retrieve_metrics_cache();\n \n-$base = isset($_GET['base']) ? $_GET['base'] . \"/\" : \"\";\n+$base = isset($_GET['base']) ? rawurlencode($_GET['base']) . \"/\" : \"\";\n ?>\n \n <html>\n@@ -33,14 +33,14 @@\n       $view_elements = get_view_graph_elements($view);\n       $range_args = \"\";\n       if (isset($_GET['r']) && $_GET['r'] != \"\") \n-\t$range_args .= \"&amp;r=\" . $_GET['r'];\n+\t$range_args .= \"&amp;r=\" . rawurlencode($_GET['r']);\n       if (isset($_GET['cs']) && isset($_GET['ce'])) \n-\t$range_args .= \"&amp;cs=\" . $_GET['cs'] . \"&amp;ce=\" . $_GET['ce'];\n+\t$range_args .= \"&amp;cs=\" . rawurlencode($_GET['cs']) . \"&amp;ce=\" . rawurlencode($_GET['ce']);\n \n       if (count($view_elements) != 0) {\n \tforeach ($view_elements as $id => $element) {\n \t  $legend = isset($element['hostname']) ? $element['hostname'] : \"Aggregate graph\";\n-          $base = isset($_GET['base']) ? $_GET['base'] : '.';\n+          $base = isset($_GET['base']) ? rawurlencode($_GET['base']) : '.';\n \t  print \"<a href=\\\"\" . $base . \"/graph_all_periods.php?\" . htmlentities($element['graph_args']) .\"&amp;z=large\\\"><img title=\\\"\" . $legend . \" - \" . $element['name'] . \"\\\" border=0 src=\\\"\" . $base . \"/graph.php?\" . htmlentities($element['graph_args']) . \"&amp;z=small\" . $range_args .  \"\\\" style=\\\"padding:2px;\\\"></a>\";\n \t}\n       } else {"
        },
        {
          "filename": "views_view.php",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -32,12 +32,15 @@\n       $empty_view = array (\"view_name\" => $_GET['view_name'],\n                            \"items\" => array());\n       $view_suffix = str_replace(\" \", \"_\", $_GET['view_name']);\n-      $view_filename = $conf['views_dir'] . \"/view_\" . $view_suffix . \".json\";\n+      $view_filename = $conf['views_dir'] . \"/view_\" . preg_replace('/[^a-zA-Z0-9_-]/', '', $view_suffix) . \".json\";\n+      if ( pathinfo( $view_filename, PATHINFO_DIRNAME ) != $conf['views_dir'] ) {\n+        die('Invalid path detected');\n+      }\n       $json = json_encode($empty_view);\n       if (file_put_contents($view_filename, \n                             json_prettyprint($json)) === FALSE) {\n         $output = \"<strong>Alert:</strong>\" .\n-                  \" Can't write to file $view_filename.\" .\n+                  \" Can't write to file \" . htmlspecialchars($view_filename) .\n                   \" Perhaps permissions are wrong.\";\n       } else {\n         $output = \"View has been created successfully.\";\n@@ -79,7 +82,10 @@\n       \" does not exist.\";\n     } else {\n       $view_suffix = str_replace(\" \", \"_\", $_GET['view_name']);\n-      $view_filename = $conf['views_dir'] . \"/view_\" . $view_suffix . \".json\";\n+      $view_filename = $conf['views_dir'] . \"/view_\" . preg_replace('/[^a-zA-Z0-9_-]/', '', $view_suffix) . \".json\";\n+      if ( pathinfo( $view_filename, PATHINFO_DIRNAME ) != $conf['views_dir'] ) {\n+        die('Invalid path detected');\n+      }\n       if (unlink($view_filename) === FALSE) {\n         $output = \"<strong>Alert:</strong>\" .\n                   \" Can't remove file $view_filename.\" ."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0f92146af18994d49e68f454c1fb485837d13497",
            "date": "2024-02-21T16:34:17Z",
            "author_login": "vvuksan"
          },
          {
            "sha": "6c7513f75f0496ddedd7b9a5a99b5cc056a2c9e3",
            "date": "2024-02-21T14:23:05Z",
            "author_login": "berlin2123"
          },
          {
            "sha": "3790ca715b5156dbe8d8f69a9632699461b08e9a",
            "date": "2024-02-21T14:13:36Z",
            "author_login": "berlin2123"
          },
          {
            "sha": "9267574fac1c8620e81e461fd6d66f10ba73f8e8",
            "date": "2024-02-21T14:07:26Z",
            "author_login": "berlin2123"
          },
          {
            "sha": "30c412a9241c6115b247e5ceb5a27c21af5641fa",
            "date": "2024-02-21T14:02:02Z",
            "author_login": "berlin2123"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in Ganglia Web before 3.5.6 allow remote attackers to inject arbitrary web script or HTML via unspecified vectors.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-03-14T03:12:47.400",
    "last_modified": "2024-11-21T01:47:12.730",
    "fix_date": "2013-01-18T20:03:18Z"
  },
  "references": [
    {
      "url": "http://ganglia.info/?p=566",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/02/08/6",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/58204",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=892823",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/ganglia/ganglia-web/commit/31d348947419058c43b8dfcd062e2988abd5058e",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://ganglia.info/?p=566",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/02/08/6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/58204",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=892823",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ganglia/ganglia-web/commit/31d348947419058c43b8dfcd062e2988abd5058e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:13.495342",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ganglia-web",
    "owner": "ganglia",
    "created_at": "2011-12-29T21:46:49Z",
    "updated_at": "2025-01-03T22:26:30Z",
    "pushed_at": "2024-05-04T03:00:23Z",
    "size": 5897,
    "stars": 315,
    "forks": 170,
    "open_issues": 91,
    "watchers": 315,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 1025798,
      "JavaScript": 500399,
      "Smarty": 82141,
      "CSS": 44191,
      "C": 12392,
      "Shell": 11705,
      "Makefile": 3410,
      "HTML": 2460
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T07:48:57.894191"
  }
}