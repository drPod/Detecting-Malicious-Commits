{
  "cve_id": "CVE-2013-10007",
  "github_data": {
    "repository": "ethitter/WP-Print-Friendly",
    "fix_commit": "437787292670c20b4abe20160ebbe8428187f2b4",
    "related_commits": [
      "437787292670c20b4abe20160ebbe8428187f2b4",
      "437787292670c20b4abe20160ebbe8428187f2b4"
    ],
    "patch_url": "https://github.com/ethitter/WP-Print-Friendly/commit/437787292670c20b4abe20160ebbe8428187f2b4.patch",
    "fix_commit_details": {
      "sha": "437787292670c20b4abe20160ebbe8428187f2b4",
      "commit_date": "2013-04-30T23:29:52Z",
      "author": {
        "login": "stevenkword",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Version 0.5.3 - Security Update",
        "length": 471,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 62,
        "additions": 54,
        "deletions": 8
      },
      "files": [
        {
          "filename": "readme.txt",
          "status": "modified",
          "additions": 8,
          "deletions": 3,
          "patch": "@@ -1,10 +1,10 @@\n === WP Print Friendly ===\n-Contributors: ethitter, thinkoomph\n+Contributors: ethitter, stevenkword, thinkoomph\n Donate link: http://www.thinkoomph.com/plugins-modules/wp-print-friendly/\n Tags: print, template, printer, printable\n Requires at least: 3.1\n Tested up to: 3.5\n-Stable tag: 0.5.2\n+Stable tag: 0.5.3\n License: GPLv2 or later\n License URI: http://www.gnu.org/licenses/gpl-2.0.html\n \n@@ -59,6 +59,11 @@ This plugin is known to conflict with certain plugins, many pertaining to SEO an\n \n == Changelog ==\n \n+= 0.5.3 =\n+* Creates is_protected() method to determine if the print page should be visible to the current user\n+* Correct security vulnerability allowing both private and password protected posts from being accessed through the print page\n+* Remove print_url links from the content when the current user does not have the necessary capabilities to view the print page\n+\n = 0.5.2 =\n * Revert change in is_print() method made in version 0.5 as it breaks the method when no page number is specified. See [https://github.com/ethitter/WP-Print-Friendly/issues/2](https://github.com/ethitter/WP-Print-Friendly/issues/2).\n \n@@ -174,4 +179,4 @@ This release expands the plugin's page rewrite rules to accomodate permalink str\n This release fixes bug that displayed post links automatically on the wrong post types.\n \n = 0.4 =\n-This release addresses numerous bugs reported by the community, including print templates for child pages. All admin text, save the plugin's name, are now ready for translation. Templates are now completely customizable, and new template functions are included.\n\\ No newline at end of file\n+This release addresses numerous bugs reported by the community, including print templates for child pages. All admin text, save the plugin's name, are now ready for translation. Templates are now completely customizable, and new template functions are included."
        },
        {
          "filename": "wp-print-friendly.php",
          "status": "modified",
          "additions": 46,
          "deletions": 5,
          "patch": "@@ -3,8 +3,8 @@\n Plugin Name: WP Print Friendly\n Plugin URI: http://www.thinkoomph.com/plugins-modules/wp-print-friendly/\n Description: Extends WordPress' template system to support printer-friendly templates. Works with permalink structures to support nice URLs.\n-Author: Erick Hitter & Oomph, Inc.\n-Version: 0.5.2\n+Author: Erick Hitter, Steven K Word & Oomph, Inc.\n+Version: 0.5.3\n Author URI: http://www.thinkoomph.com/\n \n This program is free software; you can redistribute it and/or modify\n@@ -80,6 +80,7 @@ public function action_plugins_loaded() {\n \t\tadd_action( 'admin_menu', array( $this, 'action_admin_menu' ) );\n \t\tadd_filter( 'request', array( $this, 'filter_request' ) );\n \t\tadd_action( 'pre_get_posts', array( $this, 'action_pre_get_posts' ) );\n+\t\tadd_action( 'wp', array( $this, 'action_wp' ) );\n \t\tadd_filter( 'template_include', array( $this, 'filter_template_include' ) );\n \t\tadd_filter( 'redirect_canonical', array( $this, 'filter_redirect_canonical' ) );\n \t\tadd_filter( 'body_class', array( $this, 'filter_body_class' ) );\n@@ -161,6 +162,23 @@ public function action_admin_init() {\n \t\t\tupdate_option( $this->notice_key, 1 );\n \t}\n \n+\t/**\n+\t * Determine if the print page should be visible to the current user\n+\t *\n+\t * @uses current_user_can, post_password_required\n+\t * @global $wp_query, $post\n+\t * @return bool\n+\t */\n+\tpublic function is_protected() {\n+\t\tglobal $post;\n+\n+\t\t// If the global $post object is not set OR BOTH the current user is NOT an admin AND the post is private\n+\t\t$private = ( ! isset( $post ) || ( ! current_user_can( 'read_private_posts' ) && 'private' == $post->post_status ) ) ? true : false;\n+\n+\t\t// If the password is required OR if the current user does not have the capability to view private posts\n+\t\treturn post_password_required() || true === $private;\n+\t}\n+\n \t/**\n \t * Determine if print template is being requested.\n \t *\n@@ -273,15 +291,34 @@ public function action_pre_get_posts( $query ) {\n \t\treturn $query;\n \t}\n \n+\t/**\n+\t * Throw a 404 if the print page should not be visible to the user\n+\t *\n+\t * @action wp\n+\t * @global $wp_query\n+\t * @uses $this::is_print, $this::is_protected\n+\t * @return null\n+\t */\n+\tfunction action_wp() {\n+\t\tglobal $wp_query;\n+\n+\t\tif( $this->is_print() && $this->is_protected() ) {\n+\t\t\t$wp_query->set_404();\n+\t\t\tstatus_header( 404 );\n+\t\t\tnocache_headers();\n+\t\t}\n+\t}\n+\n \t/**\n \t * Filter template include to return print template if requested.\n \t *\n \t * @param string $template\n \t * @filter template_include\n+\t * @uses this::is_protected\n \t * @return string\n \t */\n \tpublic function filter_template_include( $template ) {\n-\t\tif ( $this->is_print() && ( $print_template = $this->template_chooser() ) )\n+\t\tif ( $this->is_print() && ! $this->is_protected() && ( $print_template = $this->template_chooser() ) )\n \t\t\t$template = $print_template[ 'path' ];\n \n \t\treturn $template;\n@@ -350,7 +387,7 @@ public function filter_the_content( $content ) {\n \t * Filter the content if automatic inclusion is selected.\n \t *\n \t * @param string $content\n-\t * @uses $this::get_options, $post, $this::print_url, get_query_var, apply_filters\n+\t * @uses $this::get_options, $post, $this::print_url, $this::is_protected, get_query_var, apply_filters\n \t * @filter the_content\n \t * @return string\n \t */\n@@ -359,6 +396,10 @@ public function filter_the_content_auto( $content ) {\n \n \t\tglobal $post;\n \n+\t\t// Do not display the print_url link if the print page is not be accessible to the user\n+\t\tif( $this->is_protected() )\n+\t\t\treturn $content;\n+\n \t\tif ( is_array( $options ) && array_key_exists( 'auto', $options ) && $options[ 'auto' ] == true && in_array( $post->post_type, $options[ 'post_types' ] ) && ! $this->is_print() ) {\n \t\t\textract( $options );\n \n@@ -928,4 +969,4 @@ function is_print() {\n \t\treturn $wpf->is_print();\n \t}\n }\n-?>\n\\ No newline at end of file\n+?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fec78d4ff9fef3819c9b8100b624a566a8589275",
            "date": "2023-07-11T01:27:59Z",
            "author_login": "ethitter"
          },
          {
            "sha": "f8ccfc9a94a50554088f5b03e943525a8cecbe44",
            "date": "2023-07-11T01:27:31Z",
            "author_login": "ethitter"
          },
          {
            "sha": "b9a03edd786b3dc38f0844cf95e41ee84df31202",
            "date": "2022-06-25T22:16:40Z",
            "author_login": "ethitter"
          },
          {
            "sha": "14b995a1923e33698378754e9afb71f7bdf8445e",
            "date": "2022-06-25T22:14:27Z",
            "author_login": "ethitter"
          },
          {
            "sha": "ad85608378eebadf38ed8024a3cf77c18f2e48f4",
            "date": "2022-06-25T21:05:27Z",
            "author_login": "ethitter"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "A vulnerability classified as problematic has been found in ethitter WP-Print-Friendly up to 0.5.2. This affects an unknown part of the file wp-print-friendly.php. The manipulation leads to information disclosure. It is possible to initiate the attack remotely. Upgrading to version 0.5.3 is able to address this issue. The identifier of the patch is 437787292670c20b4abe20160ebbe8428187f2b4. It is recommended to upgrade the affected component. The identifier VDB-217269 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-03T11:15:09.987",
    "last_modified": "2024-11-21T01:48:39.037",
    "fix_date": "2013-04-30T23:29:52Z"
  },
  "references": [
    {
      "url": "https://github.com/ethitter/WP-Print-Friendly/commit/437787292670c20b4abe20160ebbe8428187f2b4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ethitter/WP-Print-Friendly/pull/4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217269",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217269",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ethitter/WP-Print-Friendly/commit/437787292670c20b4abe20160ebbe8428187f2b4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ethitter/WP-Print-Friendly/pull/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217269",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217269",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.247562",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "WP-Print-Friendly",
    "owner": "ethitter",
    "created_at": "2012-06-01T19:08:47Z",
    "updated_at": "2023-05-31T12:43:30Z",
    "pushed_at": "2024-06-19T20:57:24Z",
    "size": 152,
    "stars": 1,
    "forks": 2,
    "open_issues": 1,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 36344,
      "Shell": 5284,
      "JavaScript": 1342
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T17:40:22.046333"
  }
}