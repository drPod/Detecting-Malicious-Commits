{
  "cve_id": "CVE-2013-1801",
  "github_data": {
    "repository": "jnunemaker/httparty",
    "fix_commit": "53a812426dd32108d6cba4272b493aa03bc8c031",
    "related_commits": [
      "53a812426dd32108d6cba4272b493aa03bc8c031",
      "53a812426dd32108d6cba4272b493aa03bc8c031"
    ],
    "patch_url": "https://github.com/jnunemaker/httparty/commit/53a812426dd32108d6cba4272b493aa03bc8c031.patch",
    "fix_commit_details": {
      "sha": "53a812426dd32108d6cba4272b493aa03bc8c031",
      "commit_date": "2013-01-10T20:45:09Z",
      "author": {
        "login": "jnunemaker",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Remove yaml due to possible security risk.",
        "length": 42,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 32,
        "additions": 7,
        "deletions": 25
      },
      "files": [
        {
          "filename": "History",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -1,3 +1,7 @@\n+== 0.10.0 2013-01-10\n+* changes\n+  * removed yaml support because of security risk (see rails yaml issues)\n+\n == 0.9.0 2012-09-07\n * new\n   * [support for connection adapters](https://github.com/jnunemaker/httparty/pull/157)"
        },
        {
          "filename": "examples/custom_parsers.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n class ParseAtom\n   include HTTParty\n \n-  # Support Atom along with the default parsers: xml, json, yaml, etc.\n+  # Support Atom along with the default parsers: xml, json, etc.\n   class Parser::Atom < HTTParty::Parser\n     SupportedFormats.merge!({\"application/atom+xml\" => :atom})\n "
        },
        {
          "filename": "lib/httparty/parser.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 7,
          "patch": "@@ -1,5 +1,5 @@\n module HTTParty\n-  # The default parser used by HTTParty, supports xml, json, html, yaml, and\n+  # The default parser used by HTTParty, supports xml, json, html, and\n   # plain text.\n   #\n   # == Custom Parsers\n@@ -45,8 +45,6 @@ class Parser\n       'application/javascript' => :json,\n       'text/javascript'        => :json,\n       'text/html'              => :html,\n-      'application/x-yaml'     => :yaml,\n-      'text/yaml'              => :yaml,\n       'text/plain'             => :plain\n     }\n \n@@ -120,10 +118,6 @@ def json\n       end\n     end\n \n-    def yaml\n-      YAML.load(body)\n-    end\n-\n     def html\n       body\n     end"
        },
        {
          "filename": "spec/httparty/parser_spec.rb",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -155,11 +155,6 @@ def self.name; 'AtomParser'; end\n       subject.send(:json)\n     end\n \n-    it \"parses yaml\" do\n-      YAML.should_receive(:load).with('body')\n-      subject.send(:yaml)\n-    end\n-\n     it \"parses html by simply returning the body\" do\n       subject.send(:html).should == 'body'\n     end"
        },
        {
          "filename": "spec/httparty/request_spec.rb",
          "status": "modified",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -225,12 +225,6 @@\n       @request.send(:parse_response, json).should == {'books' => {'book' => {'id' => '1234', 'name' => 'Foo Bar!'}}}\n     end\n \n-    it 'should handle yaml automatically' do\n-      yaml = \"books: \\n  book: \\n    name: Foo Bar!\\n    id: \\\"1234\\\"\\n\"\n-      @request.options[:format] = :yaml\n-      @request.send(:parse_response, yaml).should == {'books' => {'book' => {'id' => '1234', 'name' => 'Foo Bar!'}}}\n-    end\n-\n     it \"should include any HTTP headers in the returned response\" do\n       @request.options[:format] = :html\n       response = stub_response \"Content\""
        },
        {
          "filename": "spec/httparty_spec.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 6,
          "patch": "@@ -384,11 +384,6 @@ class MyParser < HTTParty::Parser\n       @klass.default_options[:format].should == :json\n     end\n \n-    it \"should allow yaml\" do\n-      @klass.format :yaml\n-      @klass.default_options[:format].should == :yaml\n-    end\n-\n     it \"should allow plain\" do\n       @klass.format :plain\n       @klass.default_options[:format].should == :plain\n@@ -403,7 +398,7 @@ class MyParser < HTTParty::Parser\n     it 'should only print each format once with an exception' do\n       lambda do\n         @klass.format :foobar\n-      end.should raise_error(HTTParty::UnsupportedFormat, \"':foobar' Must be one of: html, json, plain, xml, yaml\")\n+      end.should raise_error(HTTParty::UnsupportedFormat, \"':foobar' Must be one of: html, json, plain, xml\")\n     end\n \n     it 'sets the default parser' do"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "348a22ba3fc3d873bb2b9ee6b9886f5a648024c2",
            "date": "2024-12-17T18:13:38Z",
            "author_login": "jnunemaker"
          },
          {
            "sha": "ee89905238ac877a9ba15cd965d030291d170ad6",
            "date": "2024-07-21T07:43:43Z",
            "author_login": "bestony"
          },
          {
            "sha": "f0c42a7198c9357f0d95633e46512c92769f6476",
            "date": "2024-04-29T12:37:23Z",
            "author_login": "jnunemaker"
          },
          {
            "sha": "6e1f154309a6076208ba9bec8e4183ec619541e0",
            "date": "2024-04-29T12:26:07Z",
            "author_login": "jnunemaker"
          },
          {
            "sha": "15c1b4b81ddc764e8101149c8c5f0605cf0b59b9",
            "date": "2024-04-29T12:25:21Z",
            "author_login": "jnunemaker"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "The httparty gem 0.9.0 and earlier for Ruby does not properly restrict casts of string values, which might allow remote attackers to conduct object-injection attacks and execute arbitrary code, or cause a denial of service (memory and CPU consumption) by leveraging Action Pack support for YAML type conversion, a similar vulnerability to CVE-2013-0156.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-04-09T20:55:01.960",
    "last_modified": "2024-11-21T01:50:25.030",
    "fix_date": "2013-01-10T20:45:09Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/58260",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=917229",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/jnunemaker/httparty/commit/53a812426dd32108d6cba4272b493aa03bc8c031",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://support.cloud.engineyard.com/entries/22915701-january-14-2013-security-vulnerabilities-httparty-extlib-crack-nori-update-these-gems-immediately",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/58260",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=917229",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/jnunemaker/httparty/commit/53a812426dd32108d6cba4272b493aa03bc8c031",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://support.cloud.engineyard.com/entries/22915701-january-14-2013-security-vulnerabilities-httparty-extlib-crack-nori-update-these-gems-immediately",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:13.504992",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "httparty",
    "owner": "jnunemaker",
    "created_at": "2008-07-28T20:55:11Z",
    "updated_at": "2025-01-14T09:24:23Z",
    "pushed_at": "2024-12-17T18:13:38Z",
    "size": 1554,
    "stars": 5830,
    "forks": 960,
    "open_issues": 43,
    "watchers": 5830,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 274190,
      "Gherkin": 15510,
      "HTML": 2612,
      "CSS": 2284,
      "Shell": 865
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:24:42.607109"
  }
}