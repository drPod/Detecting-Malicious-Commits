{
  "cve_id": "CVE-2013-1915",
  "github_data": {
    "repository": "SpiderLabs/ModSecurity",
    "fix_commit": "d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe",
    "related_commits": [
      "d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe",
      "d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe"
    ],
    "patch_url": "https://github.com/SpiderLabs/ModSecurity/commit/d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe.patch",
    "fix_commit_details": {
      "sha": "d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe",
      "commit_date": "2013-03-04T20:54:20Z",
      "author": {
        "login": "brenosilva",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added SecXmlExternalEntity",
        "length": 26,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 62,
        "additions": 60,
        "deletions": 2
      },
      "files": [
        {
          "filename": "apache2/apache2_config.c",
          "status": "modified",
          "additions": 46,
          "deletions": 2,
          "patch": "@@ -156,6 +156,9 @@ void *create_directory_config(apr_pool_t *mp, char *path)\n     dcfg->crypto_hash_framesrc_pm = NOT_SET;\n \n \n+    /* xml external entity */\n+    dcfg->xml_external_entity = NOT_SET;\n+\n     return dcfg;\n }\n \n@@ -591,6 +594,10 @@ void *merge_directory_configs(apr_pool_t *mp, void *_parent, void *_child)\n     merged->crypto_hash_framesrc_pm = (child->crypto_hash_framesrc_pm == NOT_SET\n         ? parent->crypto_hash_framesrc_pm : child->crypto_hash_framesrc_pm);\n \n+    /* xml external entity */\n+    merged->xml_external_entity = (child->xml_external_entity == NOT_SET\n+        ? parent->xml_external_entity : child->xml_external_entity);\n+\n     return merged;\n }\n \n@@ -711,6 +718,9 @@ void init_directory_config(directory_config *dcfg)\n     if (dcfg->crypto_hash_iframesrc_pm == NOT_SET) dcfg->crypto_hash_iframesrc_pm = 0;\n     if (dcfg->crypto_hash_framesrc_pm == NOT_SET) dcfg->crypto_hash_framesrc_pm = 0;\n \n+    /* xml external entity */\n+    if (dcfg->xml_external_entity == NOT_SET) dcfg->xml_external_entity = 0;\n+\n }\n \n /**\n@@ -2282,9 +2292,35 @@ static const char *cmd_sensor_id(cmd_parms *cmd, void *_dcfg, const char *p1)\n     return NULL;\n }\n \n+/**\n+* \\brief Add SecXmlExternalEntity configuration option\n+*\n+* \\param cmd Pointer to configuration data\n+* \\param _dcfg Pointer to directory configuration\n+* \\param p1 Pointer to configuration option\n+*\n+* \\retval NULL On failure\n+* \\retval apr_psprintf On Success\n+*/\n+static const char *cmd_xml_external_entity(cmd_parms *cmd, void *_dcfg, const char *p1)\n+{\n+    directory_config *dcfg = (directory_config *)_dcfg;\n+    if (dcfg == NULL) return NULL;\n+\n+    if (strcasecmp(p1, \"on\") == 0)  {\n+        dcfg->xml_external_entity = 1;\n+    }\n+    else if (strcasecmp(p1, \"off\") == 0)    {\n+        dcfg->xml_external_entity = 0;\n+    }\n+    else return apr_psprintf(cmd->pool, \"ModSecurity: Invalid value for SecXmlExternalEntity: %s\", p1);\n+\n+    return NULL;\n+}\n+\n \n /**\n-* \\brief Add SecHash configuration option\n+* \\brief Add SecHashEngine configuration option\n *\n * \\param cmd Pointer to configuration data\n * \\param _dcfg Pointer to directory configuration\n@@ -2306,7 +2342,7 @@ static const char *cmd_hash_engine(cmd_parms *cmd, void *_dcfg, const char *p1)\n         dcfg->hash_is_enabled = HASH_DISABLED;\n         dcfg->hash_enforcement = HASH_DISABLED;\n     }\n-    else return apr_psprintf(cmd->pool, \"ModSecurity: Invalid value for SecRuleEngine: %s\", p1);\n+    else return apr_psprintf(cmd->pool, \"ModSecurity: Invalid value for SexHashEngine: %s\", p1);\n \n     return NULL;\n }\n@@ -3223,6 +3259,14 @@ const command_rec module_directives[] = {\n         \"On or Off\"\n     ),\n \n+    AP_INIT_TAKE1 (\n+        \"SecXmlExternalEntity\",\n+        cmd_xml_external_entity,\n+        NULL,\n+        CMD_SCOPE_ANY,\n+        \"On or Off\"\n+    ),\n+\n     AP_INIT_FLAG (\n         \"SecRuleInheritance\",\n         cmd_rule_inheritance,"
        },
        {
          "filename": "apache2/modsecurity.h",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -595,6 +595,9 @@ struct directory_config {\n     int                 crypto_hash_location_pm;\n     int                 crypto_hash_iframesrc_pm;\n     int                 crypto_hash_framesrc_pm;\n+\n+    /* xml */\n+    int                 xml_external_entity;\n };\n \n struct error_message_t {"
        },
        {
          "filename": "apache2/msc_xml.c",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -14,17 +14,28 @@\n \n #include \"msc_xml.h\"\n \n+static xmlParserInputBufferPtr\n+xml_unload_external_entity(const char *URI, xmlCharEncoding enc)    {\n+    return NULL;\n+}\n+\n \n /**\n  * Initialise XML parser.\n  */\n int xml_init(modsec_rec *msr, char **error_msg) {\n+    xmlParserInputBufferCreateFilenameFunc entity;\n+\n     if (error_msg == NULL) return -1;\n     *error_msg = NULL;\n \n     msr->xml = apr_pcalloc(msr->mp, sizeof(xml_data));\n     if (msr->xml == NULL) return -1;\n \n+    if(msr->txcfg->xml_external_entity == 0)    {\n+        entity = xmlParserInputBufferCreateFilenameDefault(xml_unload_external_entity);\n+    }\n+\n     return 1;\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9e685bf86d45b21d1f9f6c4145c3979cc4da0196",
            "date": "2025-01-06T18:16:49Z",
            "author_login": "airween"
          },
          {
            "sha": "9158477561f70d002f816cd4ba3719db4f5b1420",
            "date": "2025-01-06T16:36:49Z",
            "author_login": "airween"
          },
          {
            "sha": "4c5bc45dfdf6c3a0ac44ee3cb9c4c6938d3a8c9b",
            "date": "2025-01-06T15:36:36Z",
            "author_login": "airween"
          },
          {
            "sha": "f260a75c14cb4f6fb1cbf13e9ce39ee6b865e9c7",
            "date": "2025-01-06T10:49:41Z",
            "author_login": "airween"
          },
          {
            "sha": "d9acf3d0cd83669a349b1e20f82b65eccf530b00",
            "date": "2025-01-06T00:28:23Z",
            "author_login": "ElevationsRPG"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-611",
    "description": "ModSecurity before 2.7.3 allows remote attackers to read arbitrary files, send HTTP requests to intranet servers, or cause a denial of service (CPU and memory consumption) via an XML external entity declaration in conjunction with an entity reference, aka an XML External Entity (XXE) vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-04-25T23:55:01.530",
    "last_modified": "2024-11-21T01:50:40.090",
    "fix_date": "2013-03-04T20:54:20Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2013-April/101898.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2013-April/101911.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2013-April/102616.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-08/msg00020.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-08/msg00025.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-08/msg00031.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/52847",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/52977",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2013/dsa-2659",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.mandriva.com/security/advisories?name=MDVSA-2013:156",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/04/03/7",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/58810",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=947842",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SpiderLabs/ModSecurity/blob/master/CHANGES",
      "source": "secalert@redhat.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SpiderLabs/ModSecurity/commit/d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2013-April/101898.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2013-April/101911.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2013-April/102616.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-08/msg00020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-08/msg00025.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-08/msg00031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/52847",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/52977",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2013/dsa-2659",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.mandriva.com/security/advisories?name=MDVSA-2013:156",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/04/03/7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/58810",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=947842",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SpiderLabs/ModSecurity/blob/master/CHANGES",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SpiderLabs/ModSecurity/commit/d4d80b38aa85eccb26e3c61b04d16e8ca5de76fe",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:16.762562",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ModSecurity",
    "owner": "SpiderLabs",
    "created_at": "2011-02-02T14:57:01Z",
    "updated_at": "2025-01-14T06:18:53Z",
    "pushed_at": "2025-01-06T18:16:50Z",
    "size": 76478,
    "stars": 8439,
    "forks": 1626,
    "open_issues": 238,
    "watchers": 8439,
    "has_security_policy": false,
    "default_branch": "v3/master",
    "protected_branches": [
      "v2/master"
    ],
    "languages": {
      "C++": 2537434,
      "M4": 125282,
      "Makefile": 18678,
      "CMake": 12479,
      "Shell": 6643,
      "C": 4409,
      "Dockerfile": 4112,
      "Lua": 3884,
      "Batchfile": 1260
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:44:18.288536"
  }
}