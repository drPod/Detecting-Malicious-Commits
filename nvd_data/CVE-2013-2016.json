{
  "cve_id": "CVE-2013-2016",
  "github_data": {
    "repository": "qemu/qemu",
    "fix_commit": "5f5a1318653c08e435cfa52f60b6a712815b659d",
    "related_commits": [
      "5f5a1318653c08e435cfa52f60b6a712815b659d",
      "5f5a1318653c08e435cfa52f60b6a712815b659d"
    ],
    "patch_url": "https://github.com/qemu/qemu/commit/5f5a1318653c08e435cfa52f60b6a712815b659d.patch",
    "fix_commit_details": {
      "sha": "5f5a1318653c08e435cfa52f60b6a712815b659d",
      "commit_date": "2013-05-07T05:42:49Z",
      "author": {
        "login": "jasowang",
        "type": "User",
        "stats": {
          "total_commits": 251,
          "average_weekly_commits": 0.3013205282112845,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "virtio: properly validate address before accessing config",
        "length": 795,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 18,
        "deletions": 12
      },
      "files": [
        {
          "filename": "hw/virtio/virtio.c",
          "status": "modified",
          "additions": 18,
          "deletions": 12,
          "patch": "@@ -568,10 +568,11 @@ uint32_t virtio_config_readb(VirtIODevice *vdev, uint32_t addr)\n     VirtioDeviceClass *k = VIRTIO_DEVICE_GET_CLASS(vdev);\n     uint8_t val;\n \n-    k->get_config(vdev, vdev->config);\n-\n-    if (addr > (vdev->config_len - sizeof(val)))\n+    if (addr + sizeof(val) > vdev->config_len) {\n         return (uint32_t)-1;\n+    }\n+\n+    k->get_config(vdev, vdev->config);\n \n     val = ldub_p(vdev->config + addr);\n     return val;\n@@ -582,10 +583,11 @@ uint32_t virtio_config_readw(VirtIODevice *vdev, uint32_t addr)\n     VirtioDeviceClass *k = VIRTIO_DEVICE_GET_CLASS(vdev);\n     uint16_t val;\n \n-    k->get_config(vdev, vdev->config);\n-\n-    if (addr > (vdev->config_len - sizeof(val)))\n+    if (addr + sizeof(val) > vdev->config_len) {\n         return (uint32_t)-1;\n+    }\n+\n+    k->get_config(vdev, vdev->config);\n \n     val = lduw_p(vdev->config + addr);\n     return val;\n@@ -596,10 +598,11 @@ uint32_t virtio_config_readl(VirtIODevice *vdev, uint32_t addr)\n     VirtioDeviceClass *k = VIRTIO_DEVICE_GET_CLASS(vdev);\n     uint32_t val;\n \n-    k->get_config(vdev, vdev->config);\n-\n-    if (addr > (vdev->config_len - sizeof(val)))\n+    if (addr + sizeof(val) > vdev->config_len) {\n         return (uint32_t)-1;\n+    }\n+\n+    k->get_config(vdev, vdev->config);\n \n     val = ldl_p(vdev->config + addr);\n     return val;\n@@ -610,8 +613,9 @@ void virtio_config_writeb(VirtIODevice *vdev, uint32_t addr, uint32_t data)\n     VirtioDeviceClass *k = VIRTIO_DEVICE_GET_CLASS(vdev);\n     uint8_t val = data;\n \n-    if (addr > (vdev->config_len - sizeof(val)))\n+    if (addr + sizeof(val) > vdev->config_len) {\n         return;\n+    }\n \n     stb_p(vdev->config + addr, val);\n \n@@ -625,8 +629,9 @@ void virtio_config_writew(VirtIODevice *vdev, uint32_t addr, uint32_t data)\n     VirtioDeviceClass *k = VIRTIO_DEVICE_GET_CLASS(vdev);\n     uint16_t val = data;\n \n-    if (addr > (vdev->config_len - sizeof(val)))\n+    if (addr + sizeof(val) > vdev->config_len) {\n         return;\n+    }\n \n     stw_p(vdev->config + addr, val);\n \n@@ -640,8 +645,9 @@ void virtio_config_writel(VirtIODevice *vdev, uint32_t addr, uint32_t data)\n     VirtioDeviceClass *k = VIRTIO_DEVICE_GET_CLASS(vdev);\n     uint32_t val = data;\n \n-    if (addr > (vdev->config_len - sizeof(val)))\n+    if (addr + sizeof(val) > vdev->config_len) {\n         return;\n+    }\n \n     stl_p(vdev->config + addr, val);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e8aa7fdcddfc8589bdc7c973a052e76e8f999455",
            "date": "2025-01-13T14:43:48Z",
            "author_login": "stefanhaRH"
          },
          {
            "sha": "435d260e7ec5ff9c79e3e62f1d66ec82d2d691ae",
            "date": "2025-01-13T12:35:35Z",
            "author_login": "pbo-linaro"
          },
          {
            "sha": "132f8ec799cea261ad6b60ac8ae86f17cc98b9a1",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pbo-linaro"
          },
          {
            "sha": "39d70016d9abe15967f7051741dd5621c659b1f4",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pm215"
          },
          {
            "sha": "86a00f2046f5f5b613bdf18d6c972b495a907c37",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pbo-linaro"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-269",
    "description": "A flaw was found in the way qemu v1.3.0 and later (virtio-rng) validates addresses when guest accesses the config space of a virtio device. If the virtio device has zero/small sized config space, such as virtio-rng, a privileged guest user could use this flaw to access the matching host's qemu address space and thus increase their privileges on the host.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-12-30T22:15:11.387",
    "last_modified": "2024-11-21T01:50:52.110",
    "fix_date": "2013-05-07T05:42:49Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2014-05/msg00002.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/04/29/5",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/04/29/6",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/59541",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/cve-2013-2016",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-2016",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/83850",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/qemu/qemu/commit/5f5a1318653c08e435cfa52f60b6a712815b659d",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security-tracker.debian.org/tracker/CVE-2013-2016",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2014-05/msg00002.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/04/29/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/04/29/6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/59541",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/cve-2013-2016",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-2016",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/83850",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/qemu/qemu/commit/5f5a1318653c08e435cfa52f60b6a712815b659d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security-tracker.debian.org/tracker/CVE-2013-2016",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:24.282260",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qemu",
    "owner": "qemu",
    "created_at": "2012-08-11T21:48:37Z",
    "updated_at": "2025-01-14T15:30:43Z",
    "pushed_at": "2025-01-13T16:01:34Z",
    "size": 597325,
    "stars": 10728,
    "forks": 5703,
    "open_issues": 0,
    "watchers": 10728,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 72752071,
      "C++": 10865548,
      "Python": 3771166,
      "Shell": 1394621,
      "Assembly": 661208,
      "Meson": 485678,
      "Haxe": 351509,
      "Perl": 223220,
      "Rust": 153760,
      "Objective-C": 153251,
      "Makefile": 107378,
      "Pawn": 50592,
      "SmPL": 33510,
      "Yacc": 29612,
      "Lex": 23760,
      "NSIS": 6939,
      "DenizenScript": 2931,
      "Dockerfile": 1012,
      "GLSL": 585,
      "GDB": 326,
      "Vim Script": 220,
      "Emacs Lisp": 75
    },
    "commit_activity": {
      "total_commits_last_year": 6588,
      "avg_commits_per_week": 126.6923076923077,
      "days_active_last_year": 335
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:49:13.645950"
  }
}