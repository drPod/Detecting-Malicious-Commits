{
  "cve_id": "CVE-2013-4116",
  "github_data": {
    "repository": "npm/npm",
    "fix_commit": "f4d31693",
    "related_commits": [
      "f4d31693",
      "f4d31693"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f4d31693",
      "commit_date": "2013-07-10T15:59:28Z",
      "author": {
        "login": "isaacs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Put 6 bytes of random in tmp folder name",
        "length": 54,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/npm.js",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -477,9 +477,14 @@ Object.defineProperty(npm, \"cache\",\n   })\n \n var tmpFolder\n+var crypto = require(\"crypto\")\n+var rand = crypto.randomBytes(6)\n+                 .toString(\"base64\")\n+                 .replace(/\\//g, '_')\n+                 .replace(/\\+/, '-')\n Object.defineProperty(npm, \"tmp\",\n   { get : function () {\n-      if (!tmpFolder) tmpFolder = \"npm-\" + process.pid\n+      if (!tmpFolder) tmpFolder = \"npm-\" + process.pid + \"-\" + rand\n       return path.resolve(npm.config.get(\"tmp\"), tmpFolder)\n     }\n   , enumerable : true"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "447afc8316536405dc3fc3a682edad52943c6c0e",
            "date": "2020-08-07T14:31:17Z",
            "author_login": "darcyclarke"
          },
          {
            "sha": "1f7b65860f1d56ce85ccea2b18de1ef58227be66",
            "date": "2020-08-07T14:27:11Z",
            "author_login": "darcyclarke"
          },
          {
            "sha": "eda72afeaa40bdb09af330c0059c5fca1521c73d",
            "date": "2018-07-12T22:40:00Z",
            "author_login": "zkat"
          },
          {
            "sha": "131501bbd44e4d4878b51fcea366b19e8e6309aa",
            "date": "2018-07-12T22:03:37Z",
            "author_login": "zkat"
          },
          {
            "sha": "4c32413a5b42e18a34afb078cf00eed60f08e4ff",
            "date": "2018-05-02T05:50:30Z",
            "author_login": "gucong3000"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-59",
    "description": "lib/npm.js in Node Packaged Modules (npm) before 1.3.3 allows local users to overwrite arbitrary files via a symlink attack on temporary files with predictable names that are created when unpacking archives.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-04-22T14:23:34.330",
    "last_modified": "2024-11-21T01:54:54.903",
    "fix_date": "2013-07-10T15:59:28Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/07/10/17",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/07/11/9",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/61083",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=715325",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=983917",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/87141",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/npm/npm/commit/f4d31693",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/npm/npm/issues/3635",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/07/10/17",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/07/11/9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/61083",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=715325",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=983917",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/87141",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/npm/npm/commit/f4d31693",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/npm/npm/issues/3635",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.588471",
    "processing_status": "enhanced"
  }
}