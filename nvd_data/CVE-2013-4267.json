{
  "cve_id": "CVE-2013-4267",
  "github_data": {
    "repository": "pydio/pydio-core",
    "fix_commit": "22a62840e5ac14bb389",
    "related_commits": [
      "22a62840e5ac14bb389",
      "22a62840e5ac14bb389"
    ],
    "patch_url": "https://github.com/pydio/pydio-core/commit/22a62840e5ac14bb389.patch",
    "fix_commit_details": {
      "sha": "22a62840e5ac14bb389",
      "commit_date": "2013-06-24T08:57:16Z",
      "author": {
        "login": "cdujeu",
        "type": "User",
        "stats": {
          "total_commits": 8512,
          "average_weekly_commits": 9.262241566920565,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 433
        }
      },
      "commit_message": {
        "title": "Call escapeshellarg where missing",
        "length": 33,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 12,
        "additions": 6,
        "deletions": 6
      },
      "files": [
        {
          "filename": "core/src/plugins/access.fs/class.fsAccessWrapper.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -439,18 +439,18 @@ public static function getLastRealSize(){\n \n \tprotected function getTrueSizeOnFileSystem($file) {\n \t\tif (!(strtoupper(substr(PHP_OS, 0, 3)) == 'WIN')){\n-\t\t\t$cmd = \"stat -L -c%s \\\"\".$file.\"\\\"\";\n+\t\t\t$cmd = \"stat -L -c%s \\\"\".escapeshellarg($file).\"\\\"\";\n \t\t\t$val = trim(`$cmd`);\n \t\t\tif (strlen($val) == 0 || floatval($val) == 0)\n \t\t\t{\n \t\t\t\t// No stat on system\n-\t\t\t\t$cmd = \"ls -1s --block-size=1 \\\"\".$file.\"\\\"\";\n+\t\t\t\t$cmd = \"ls -1s --block-size=1 \".escapeshellarg($file);\n \t\t\t\t$val = trim(`$cmd`);\n \t\t\t}\n \t\t\tif (strlen($val) == 0 || floatval($val) == 0)\n \t\t\t{\n \t\t\t\t// No block-size on system (probably busybox), try long output\n-\t\t\t\t$cmd = \"ls -l \\\"\".$file.\"\\\"\";\n+\t\t\t\t$cmd = \"ls -l \".escapeshellarg($file).\"\";\n \n \t\t\t\t$arr = explode(\"/[\\s]+/\", `$cmd`);\n \t\t\t\t$val = trim($arr[4]);"
        },
        {
          "filename": "core/src/plugins/action.powerfs/class.PowerFSController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -146,7 +146,7 @@ function switchAction($action, $httpVars, $fileVars){\n                     $archiveName = AJXP_Utils::getAjxpTmpDir().\"/\".$httpVars[\"ope_id\"].\"_\".$archiveName;\r\n                 }\r\n                 chdir($rootDir);\r\n-                $cmd = \"zip -r \\\"\".$archiveName.\"\\\" \".implode(\" \", $args);\r\n+                $cmd = \"zip -r \".escapeshellarg($archiveName).\" \".implode(\" \", $args);\r\n                 $fsDriver = AJXP_PluginsService::getInstance()->getUniqueActivePluginForType(\"access\");\r\n                 $c = $fsDriver->getConfigs();\r\n                 if(!isSet($c[\"SHOW_HIDDEN_FILES\"]) || $c[\"SHOW_HIDDEN_FILES\"] == false){\r"
        },
        {
          "filename": "core/src/plugins/meta.svn/class.SvnManager.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -193,7 +193,7 @@ public function switchAction($actionName, $httpVars, $filesVars){\n \t\t\texit(0);\n         }else if($actionName == \"revert_file\"){\n \n-            $revision = $httpVars[\"revision\"];\n+            $revision = escapeshellarg($httpVars[\"revision\"]);\n    \t\t\t$realFile = $init[\"SELECTION\"][0];\n             $compare = (isSet($httpVars[\"compare\"]) && $httpVars[\"compare\"] == \"true\");\n             $escapedFile = escapeshellarg($realFile);\n@@ -207,7 +207,7 @@ public function switchAction($actionName, $httpVars, $filesVars){\n             }\n \n \t\t}else if($actionName == \"svnswitch\"){\n-\t\t\t$revision = $httpVars[\"revision\"];\n+\t\t\t$revision = escapeshellarg($httpVars[\"revision\"]);\n \t\t\tExecSvnCmd(\"svn update -r$revision \".$init[\"DIR\"]);\n \t\t}\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b56ccdd4b300565772748cb44a92acbf98a61e8a",
            "date": "2020-11-24T17:42:06Z",
            "author_login": "cdujeu"
          },
          {
            "sha": "31cb4fe1d3533f6b26f9a2719c38dbbdd684ff7f",
            "date": "2020-02-11T07:49:02Z",
            "author_login": "c12simple"
          },
          {
            "sha": "ff5d935615029bd2581525829308194a036db3c7",
            "date": "2020-01-07T21:25:00Z",
            "author_login": "c12simple"
          },
          {
            "sha": "d930e19b1a98990392be7165a60a273a461666e3",
            "date": "2020-01-07T21:24:18Z",
            "author_login": "c12simple"
          },
          {
            "sha": "bd9ede7bf527cf23c61f1ce6448de1735be335ac",
            "date": "2020-01-06T18:07:42Z",
            "author_login": "cdujeu"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "Ajaxeplorer before 5.0.1 allows remote attackers to execute arbitrary commands via shell metacharacters in the (1) archive_name parameter to the Power FS module (plugins/action.powerfs/class.PowerFSController.php), a (2) file name to the getTrustSizeOnFileSystem function in the File System (Standard) module (plugins/access.fs/class.fsAccessWrapper.php), or the (3) revision parameter to the Subversion Repository module (plugins/meta.svn/class.SvnManager.php).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-02-11T12:15:11.507",
    "last_modified": "2024-11-21T01:55:14.757",
    "fix_date": "2013-06-24T08:57:16Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/08/21/16",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pydio/pydio-core/commit/22a62840e5ac14bb389",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/plugins/nessus/70495",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2013/08/21/16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pydio/pydio-core/commit/22a62840e5ac14bb389",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/plugins/nessus/70495",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:39.842827",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pydio-core",
    "owner": "pydio",
    "created_at": "2012-10-01T16:21:06Z",
    "updated_at": "2025-01-06T05:05:21Z",
    "pushed_at": "2020-11-24T17:42:07Z",
    "size": 229642,
    "stars": 868,
    "forks": 290,
    "open_issues": 80,
    "watchers": 868,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "PHP": 9280009,
      "JavaScript": 2806092,
      "CSS": 616623,
      "Java": 553085,
      "HTML": 422901,
      "Less": 168264,
      "ActionScript": 25782,
      "PLpgSQL": 9983,
      "Smarty": 5684,
      "Python": 5670,
      "Hack": 2999,
      "Rich Text Format": 1735
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T21:41:33.165636"
  }
}