{
  "cve_id": "CVE-2013-5576",
  "github_data": {
    "repository": "joomla/joomla-cms",
    "fix_commit": "1ed07e257a2c0794ba19e864f7c5101e7e8c41d2",
    "related_commits": [
      "1ed07e257a2c0794ba19e864f7c5101e7e8c41d2",
      "fa5645208eefd70f521cd2e4d53d5378622133d8",
      "1ed07e257a2c0794ba19e864f7c5101e7e8c41d2",
      "fa5645208eefd70f521cd2e4d53d5378622133d8"
    ],
    "patch_url": "https://github.com/joomla/joomla-cms/commit/1ed07e257a2c0794ba19e864f7c5101e7e8c41d2.patch",
    "fix_commit_details": {
      "sha": "1ed07e257a2c0794ba19e864f7c5101e7e8c41d2",
      "commit_date": "2013-08-01T01:23:46Z",
      "author": {
        "login": "mbabker",
        "type": "User",
        "stats": {
          "total_commits": 2307,
          "average_weekly_commits": 2.284158415841584,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 332
        }
      },
      "commit_message": {
        "title": "Prepare 3.1.5 release",
        "length": 21,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 31,
        "additions": 19,
        "deletions": 12
      },
      "files": [
        {
          "filename": "administrator/components/com_media/helpers/media.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -66,7 +66,7 @@ public static function canUpload($file, &$err)\n \n \t\t$allowable = explode(',', $params->get('upload_extensions'));\n \t\t$ignored = explode(',', $params->get('ignore_extensions'));\n-\t\tif (!in_array($format, $allowable) && !in_array($format, $ignored))\n+\t\tif ($format == '' || $format == false || (!in_array($format, $allowable) && !in_array($format, $ignored)))\n \t\t{\n \t\t\t$err = 'COM_MEDIA_ERROR_WARNFILETYPE';\n \t\t\treturn false;"
        },
        {
          "filename": "administrator/includes/framework.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -17,7 +17,7 @@\n /*\n  * Installation check, and check on removal of the install directory.\n  */\n-if (!file_exists(JPATH_CONFIGURATION.'/configuration.php') || (filesize(JPATH_CONFIGURATION.'/configuration.php') < 10) /*|| file_exists(JPATH_INSTALLATION.'/index.php')*/)\n+if (!file_exists(JPATH_CONFIGURATION.'/configuration.php') || (filesize(JPATH_CONFIGURATION.'/configuration.php') < 10) || file_exists(JPATH_INSTALLATION.'/index.php'))\n {\n \theader('Location: ../installation/index.php');\n \texit();"
        },
        {
          "filename": "administrator/manifests/files/joomla.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -5,9 +5,9 @@\n \t<authorEmail>admin@joomla.org</authorEmail>\n \t<authorUrl>www.joomla.org</authorUrl>\n \t<copyright>(C) 2005 - 2013 Open Source Matters. All rights reserved</copyright>\n-\t<license>GNU General Public License version 2 or later; see     LICENSE.txt</license>\n+\t<license>GNU General Public License version 2 or later; see LICENSE.txt</license>\n \t<version>3.1.5</version>\n-\t<creationDate>July 2013</creationDate>\n+\t<creationDate>August 2013</creationDate>\n \t<description>FILES_JOOMLA_XML_DESCRIPTION</description>\n \n \t<scriptfile>administrator/components/com_admin/script.php</scriptfile>"
        },
        {
          "filename": "build/build.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -32,7 +32,7 @@\n \n // Set release for each build\n // Release is third digit (like '0', '1', or '2')\n-$release = '2';\n+$release = '5';\n \n // Set path to git binary (e.g., /usr/local/git/bin/git or /urs/bin/git)\n $gitPath = '/usr/bin/git';\n@@ -75,6 +75,7 @@\n // Note: If we add new top-level directories or files, be sure to include them here.\n $filesArray = array(\n \t\t\"administrator/index.php\\n\" => true,\n+\t\t\"bin/index.html\\n\" => true,\n \t\t\"cache/index.html\\n\" => true,\n \t\t\"cli/index.html\\n\" => true,\n \t\t\"components/index.html\\n\" => true,\n@@ -114,8 +115,9 @@\n \t// Loop through and add all files except: tests, installation, build, .git, or docs\n \tforeach ($files AS $file)\n \t{\n-\t\tif (substr($file, 2, 5) != 'tests' && substr($file, 2, 12) != 'installation' && substr($file,2,5) != 'build'\n-\t\t&& substr($file, 2, 4) != '.git' && substr($file, 2, 4) != 'docs' )\n+\t\tif (substr($file, 2, 5) != 'tests' && substr($file, 2, 12) != 'installation' && substr($file, 2, 5) != 'build'\n+\t\t&& substr($file, 2, 4) != '.git' && substr($file, 2, 4) != 'docs' && substr($file, 2, 7) != '.travis'\n+\t\t&& substr($file, 2, 6) != 'travis' && substr($file, 2, 7) != 'phpunit' && substr($file, -3) != '.md')\n \t\t{\n \t\t\t// Don't add deleted files to the list\n \t\t\tif (substr($file, 0, 1) != 'D')"
        },
        {
          "filename": "includes/framework.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n // Installation check, and check on removal of the install directory.\n //\n \n-if (!file_exists(JPATH_CONFIGURATION.'/configuration.php') || (filesize(JPATH_CONFIGURATION.'/configuration.php') < 10) /*|| file_exists(JPATH_INSTALLATION.'/index.php')*/) {\n+if (!file_exists(JPATH_CONFIGURATION.'/configuration.php') || (filesize(JPATH_CONFIGURATION.'/configuration.php') < 10) || file_exists(JPATH_INSTALLATION.'/index.php')) {\n \n \tif (file_exists(JPATH_INSTALLATION.'/index.php'))\n \t{"
        },
        {
          "filename": "installation/CHANGELOG",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -25,6 +25,8 @@ $ -> Language fix or change\n - -> Removed\n ! -> Note\n \n+-------------------- 3.1.5 Stable Release [01-Aug-2013] ------------------\n+\n 31-Jul-2013 Michael Babker\n  # [#31620] Some plugins cause blank pages in 3.1.4.  Thanks Don Gilbert\n  # [#31607] REGRESSION: Changing the autoload order in a point release.  Thanks Don Gilbert"
        },
        {
          "filename": "installation/sql/mysql/joomla.sql",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -594,7 +594,7 @@ INSERT INTO `#__extensions` (`extension_id`, `name`, `type`, `element`, `folder`\n (507, 'isis', 'template', 'isis', '', 1, 1, 1, 0, '{\"name\":\"isis\",\"type\":\"template\",\"creationDate\":\"3\\\\/30\\\\/2012\",\"author\":\"Kyle Ledbetter\",\"copyright\":\"Copyright (C) 2005 - 2013 Open Source Matters, Inc. All rights reserved.\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"\",\"version\":\"1.0\",\"description\":\"TPL_ISIS_XML_DESCRIPTION\",\"group\":\"\"}', '{\"templateColor\":\"\",\"logoFile\":\"\"}', '', '', 0, '0000-00-00 00:00:00', 0, 0),\n (600, 'English (United Kingdom)', 'language', 'en-GB', '', 0, 1, 1, 1, '', '', '', '', 0, '0000-00-00 00:00:00', 0, 0),\n (601, 'English (United Kingdom)', 'language', 'en-GB', '', 1, 1, 1, 1, '', '', '', '', 0, '0000-00-00 00:00:00', 0, 0),\n-(700, 'Joomla! CMS', 'file', 'joomla', '', 0, 1, 1, 1, '{\"legacy\":false,\"name\":\"files_joomla\",\"type\":\"file\",\"creationDate\":\"July 2013\",\"author\":\"Joomla!\",\"copyright\":\"(C) 2005 - 2013 Open Source Matters. All rights reserved\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"www.joomla.org\",\"version\":\"3.1.3\",\"description\":\"FILES_JOOMLA_XML_DESCRIPTION\",\"group\":\"\"}', '', '', '', 0, '0000-00-00 00:00:00', 0, 0);\n+(700, 'Joomla! CMS', 'file', 'joomla', '', 0, 1, 1, 1, '{\"legacy\":false,\"name\":\"files_joomla\",\"type\":\"file\",\"creationDate\":\"August 2013\",\"author\":\"Joomla!\",\"copyright\":\"(C) 2005 - 2013 Open Source Matters. All rights reserved\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"www.joomla.org\",\"version\":\"3.1.5\",\"description\":\"FILES_JOOMLA_XML_DESCRIPTION\",\"group\":\"\"}', '', '', '', 0, '0000-00-00 00:00:00', 0, 0);\n \n -- --------------------------------------------------------\n "
        },
        {
          "filename": "installation/sql/postgresql/joomla.sql",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -639,7 +639,7 @@ INSERT INTO \"#__extensions\" (\"extension_id\", \"name\", \"type\", \"element\", \"folder\"\n \n -- Files Extensions\n INSERT INTO \"#__extensions\" (\"extension_id\", \"name\", \"type\", \"element\", \"folder\", \"client_id\", \"enabled\", \"access\", \"protected\", \"manifest_cache\", \"params\", \"custom_data\", \"system_data\", \"checked_out\", \"checked_out_time\", \"ordering\", \"state\") VALUES\n-(700, 'Joomla! CMS', 'file', 'joomla', '', 0, 1, 1, 1, '{\"legacy\":false,\"name\":\"files_joomla\",\"type\":\"file\",\"creationDate\":\"July 2013\",\"author\":\"Joomla!\",\"copyright\":\"(C) 2005 - 2013 Open Source Matters. All rights reserved\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"www.joomla.org\",\"version\":\"3.1.3\",\"description\":\"FILES_JOOMLA_XML_DESCRIPTION\",\"group\":\"\"}', '', '', '', 0, '1970-01-01 00:00:00', 0, 0);\n+(700, 'Joomla! CMS', 'file', 'joomla', '', 0, 1, 1, 1, '{\"legacy\":false,\"name\":\"files_joomla\",\"type\":\"file\",\"creationDate\":\"August 2013\",\"author\":\"Joomla!\",\"copyright\":\"(C) 2005 - 2013 Open Source Matters. All rights reserved\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"www.joomla.org\",\"version\":\"3.1.5\",\"description\":\"FILES_JOOMLA_XML_DESCRIPTION\",\"group\":\"\"}', '', '', '', 0, '1970-01-01 00:00:00', 0, 0);\n \n SELECT nextval('#__extensions_extension_id_seq');\n SELECT setval('#__extensions_extension_id_seq', 10000, false);"
        },
        {
          "filename": "installation/sql/sqlazure/joomla.sql",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -990,7 +990,7 @@ UNION ALL\n SELECT 601, 'English (United Kingdom)', 'language', 'en-GB', '', 1, 1, 1, 1, '', '', '', '', 0, '1900-01-01 00:00:00', 0, 0;\n \n INSERT INTO #__extensions (extension_id, name, type, element, folder, client_id, enabled, access, protected, manifest_cache, params, custom_data, system_data, checked_out, checked_out_time, ordering, state)\n-VALUES (700, 'Joomla! CMS', 'file', 'joomla', '', 0, 1, 1, 1, '{\"name\":\"files_joomla\",\"type\":\"file\",\"creationDate\":\"July 2013\",\"author\":\"Joomla!\",\"copyright\":\"(C) 2005 - 2013 Open Source Matters. All rights reserved\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"www.joomla.org\",\"version\":\"3.1.3\",\"description\":\"FILES_JOOMLA_XML_DESCRIPTION\",\"group\":\"\"}', '', '', '', 0, '1900-01-01 00:00:00', 0, 0);\n+VALUES (700, 'Joomla! CMS', 'file', 'joomla', '', 0, 1, 1, 1, '{\"name\":\"files_joomla\",\"type\":\"file\",\"creationDate\":\"August 2013\",\"author\":\"Joomla!\",\"copyright\":\"(C) 2005 - 2013 Open Source Matters. All rights reserved\",\"authorEmail\":\"admin@joomla.org\",\"authorUrl\":\"www.joomla.org\",\"version\":\"3.1.5\",\"description\":\"FILES_JOOMLA_XML_DESCRIPTION\",\"group\":\"\"}', '', '', '', 0, '1900-01-01 00:00:00', 0, 0);\n \n SET IDENTITY_INSERT #__extensions  OFF;\n "
        },
        {
          "filename": "libraries/cms/version/version.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -37,7 +37,7 @@ final class JVersion\n \tpublic $CODENAME = 'Ember';\n \n \t/** @var  string  Release date. */\n-\tpublic $RELDATE = '26-July-2013';\n+\tpublic $RELDATE = '01-August-2013';\n \n \t/** @var  string  Release time. */\n \tpublic $RELTIME = '14:00';"
        },
        {
          "filename": "libraries/joomla/filesystem/file.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -61,6 +61,9 @@ public static function stripExt($file)\n \t */\n \tpublic static function makeSafe($file)\n \t{\n+\t\t// Remove any trailing dots, as those aren't ever valid file names.\n+\t\t$file = rtrim($file, '.');\n+\n \t\t$regex = array('#(\\.){2,}#', '#[^A-Za-z0-9\\.\\_\\- ]#', '#^\\.#');\n \n \t\treturn preg_replace($regex, '', $file);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 11,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ffbad2ed52ce0de6f49fa13f73bd9d8d4e1d8c69",
            "date": "2025-01-13T15:42:33Z",
            "author_login": "alikon"
          },
          {
            "sha": "ad4b0c15b42ade17b06a1b4722e33db98d074d89",
            "date": "2025-01-13T12:24:19Z",
            "author_login": "brianteeman"
          },
          {
            "sha": "686079230242cd3f3f3e57100065b9d0344d046d",
            "date": "2025-01-12T21:56:54Z",
            "author_login": "joomla-translation-bot"
          },
          {
            "sha": "e9bbd2a5229bf91e4eb16db3e3dff0401724c615",
            "date": "2025-01-12T20:47:09Z",
            "author_login": "heelc29"
          },
          {
            "sha": "53dc17d17647303452e1824a531f3f204cf04506",
            "date": "2025-01-12T20:18:14Z",
            "author_login": "chmst"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "administrator/components/com_media/helpers/media.php in the media manager in Joomla! 2.5.x before 2.5.14 and 3.x before 3.1.5 allows remote authenticated users or remote attackers to bypass intended access restrictions and upload files with dangerous extensions via a filename with a trailing . (dot), as exploited in the wild in August 2013.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-10-09T14:54:26.780",
    "last_modified": "2024-11-21T01:57:44.150",
    "fix_date": "2013-08-01T01:23:46Z"
  },
  "references": [
    {
      "url": "http://developer.joomla.org/security/563-20130801-core-unauthorised-uploads.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_item_id=31626",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/484",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/486",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.cso.com.au/article/523528/joomla_patches_file_manager_vulnerability_responsible_hijacked_websites/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.exploit-db.com/exploits/27610",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.kb.cert.org/vuls/id/639620",
      "source": "cve@mitre.org",
      "tags": [
        "US Government Resource"
      ]
    },
    {
      "url": "https://github.com/joomla/joomla-cms/commit/1ed07e257a2c0794ba19e864f7c5101e7e8c41d2",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/joomla/joomla-cms/commit/fa5645208eefd70f521cd2e4d53d5378622133d8",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://developer.joomla.org/security/563-20130801-core-unauthorised-uploads.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://joomlacode.org/gf/project/joomla/tracker/?action=TrackerItemEdit&tracker_item_id=31626",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/484",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/486",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.cso.com.au/article/523528/joomla_patches_file_manager_vulnerability_responsible_hijacked_websites/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.exploit-db.com/exploits/27610",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.kb.cert.org/vuls/id/639620",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "US Government Resource"
      ]
    },
    {
      "url": "https://github.com/joomla/joomla-cms/commit/1ed07e257a2c0794ba19e864f7c5101e7e8c41d2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/joomla/joomla-cms/commit/fa5645208eefd70f521cd2e4d53d5378622133d8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:20.031473",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "joomla-cms",
    "owner": "joomla",
    "created_at": "2011-09-27T02:07:38Z",
    "updated_at": "2025-01-14T11:35:05Z",
    "pushed_at": "2025-01-13T15:42:33Z",
    "size": 339548,
    "stars": 4807,
    "forks": 3661,
    "open_issues": 1006,
    "watchers": 4807,
    "has_security_policy": false,
    "default_branch": "5.2-dev",
    "protected_branches": [
      "4.4-dev",
      "5.2-dev",
      "5.3-dev",
      "6.0-dev"
    ],
    "languages": {
      "PHP": 15787750,
      "JavaScript": 1211175,
      "SCSS": 283770,
      "HTML": 93601,
      "Vue": 84515,
      "CSS": 42016,
      "PLpgSQL": 13230,
      "Shell": 1160
    },
    "commit_activity": {
      "total_commits_last_year": 1106,
      "avg_commits_per_week": 21.26923076923077,
      "days_active_last_year": 234
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T15:54:05.324173"
  }
}