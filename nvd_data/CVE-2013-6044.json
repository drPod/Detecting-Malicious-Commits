{
  "cve_id": "CVE-2013-6044",
  "github_data": {
    "repository": "django/django",
    "fix_commit": "1a274ccd6bc1afbdac80344c9b6e5810c1162b5f",
    "related_commits": [
      "1a274ccd6bc1afbdac80344c9b6e5810c1162b5f",
      "ae3535169af804352517b7fea94a42a1c9c4b762",
      "ec67af0bd609c412b76eaa4cc89968a2a8e5ad6a",
      "1a274ccd6bc1afbdac80344c9b6e5810c1162b5f",
      "ae3535169af804352517b7fea94a42a1c9c4b762",
      "ec67af0bd609c412b76eaa4cc89968a2a8e5ad6a"
    ],
    "patch_url": "https://github.com/django/django/commit/1a274ccd6bc1afbdac80344c9b6e5810c1162b5f.patch",
    "fix_commit_details": {
      "sha": "1a274ccd6bc1afbdac80344c9b6e5810c1162b5f",
      "commit_date": "2013-08-13T16:03:49Z",
      "author": {
        "login": "jacobian",
        "type": "User",
        "stats": {
          "total_commits": 893,
          "average_weekly_commits": 0.8763493621197253,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 154
        }
      },
      "commit_message": {
        "title": "Fixed is_safe_url() to reject URLs that use a scheme other than HTTP/S.",
        "length": 126,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 10,
        "deletions": 5
      },
      "files": [
        {
          "filename": "django/contrib/auth/tests/views.py",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -328,7 +328,8 @@ def test_security_check(self, password='password'):\n         for bad_url in ('http://example.com',\n                         'https://example.com',\n                         'ftp://exampel.com',\n-                        '//example.com'):\n+                        '//example.com',\n+                        'javascript:alert(\"XSS\")'):\n \n             nasty_url = '%(url)s?%(next)s=%(bad_url)s' % {\n                 'url': login_url,\n@@ -349,6 +350,7 @@ def test_security_check(self, password='password'):\n                          '/view?param=ftp://exampel.com',\n                          'view/?param=//example.com',\n                          'https:///',\n+                         'HTTPS:///',\n                          '//testserver/',\n                          '/url%20with%20spaces/'):  # see ticket #12534\n             safe_url = '%(url)s?%(next)s=%(good_url)s' % {\n@@ -522,7 +524,8 @@ def test_security_check(self, password='password'):\n         for bad_url in ('http://example.com',\n                         'https://example.com',\n                         'ftp://exampel.com',\n-                        '//example.com'):\n+                        '//example.com',\n+                        'javascript:alert(\"XSS\")'):\n             nasty_url = '%(url)s?%(next)s=%(bad_url)s' % {\n                 'url': logout_url,\n                 'next': REDIRECT_FIELD_NAME,\n@@ -541,6 +544,7 @@ def test_security_check(self, password='password'):\n                          '/view?param=ftp://exampel.com',\n                          'view/?param=//example.com',\n                          'https:///',\n+                         'HTTPS:///',\n                          '//testserver/',\n                          '/url%20with%20spaces/'):  # see ticket #12534\n             safe_url = '%(url)s?%(next)s=%(good_url)s' % {"
        },
        {
          "filename": "django/utils/http.py",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -231,11 +231,12 @@ def same_origin(url1, url2):\n def is_safe_url(url, host=None):\n     \"\"\"\n     Return ``True`` if the url is a safe redirection (i.e. it doesn't point to\n-    a different host).\n+    a different host and uses a safe scheme).\n \n     Always returns ``False`` on an empty url.\n     \"\"\"\n     if not url:\n         return False\n-    netloc = urllib_parse.urlparse(url)[1]\n-    return not netloc or netloc == host\n+    url_info = urllib_parse.urlparse(url)\n+    return (not url_info.netloc or url_info.netloc == host) and \\\n+        (not url_info.scheme or url_info.scheme in ['http', 'https'])"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b721f127603516c75ebda6912046ff5f0694e150",
            "date": "2024-10-11T11:44:12Z",
            "author_login": "sarahboyce"
          },
          {
            "sha": "d206d4c200d71c0847e7f6720d88c587e7b46843",
            "date": "2025-01-01T20:27:52Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "f07360e8087d3b403d1d12ff696da3138116055a",
            "date": "2025-01-14T03:04:33Z",
            "author_login": "charettes"
          },
          {
            "sha": "161e79d277ffe8b79b15ad51cb0d23de54270202",
            "date": "2025-01-13T18:55:41Z",
            "author_login": "charettes"
          },
          {
            "sha": "4bfec242b488b174f7d386ab5bbd3363751cdb93",
            "date": "2025-01-13T18:53:57Z",
            "author_login": "charettes"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "The is_safe_url function in utils/http.py in Django 1.4.x before 1.4.6, 1.5.x before 1.5.2, and 1.6 before beta 2 treats a URL's scheme as safe even if it is not HTTP or HTTPS, which might introduce cross-site scripting (XSS) or other vulnerabilities into Django applications that use this function, as demonstrated by \"the login view in django.contrib.auth.views\" and the javascript: scheme.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2013-10-04T17:55:10.040",
    "last_modified": "2024-11-21T01:58:40.717",
    "fix_date": "2013-08-13T16:03:49Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-10/msg00015.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-1521.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/369",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/411",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/54476",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2013/dsa-2740",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/61777",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1028915",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/86437",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/1a274ccd6bc1afbdac80344c9b6e5810c1162b5f",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/ae3535169af804352517b7fea94a42a1c9c4b762",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/ec67af0bd609c412b76eaa4cc89968a2a8e5ad6a",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.djangoproject.com/weblog/2013/aug/13/security-releases-issued",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2013-10/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2013-1521.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/369",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2013/q3/411",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/54476",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2013/dsa-2740",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/61777",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1028915",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/86437",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/1a274ccd6bc1afbdac80344c9b6e5810c1162b5f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/ae3535169af804352517b7fea94a42a1c9c4b762",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/ec67af0bd609c412b76eaa4cc89968a2a8e5ad6a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.djangoproject.com/weblog/2013/aug/13/security-releases-issued",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:20.031028",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "django",
    "owner": "django",
    "created_at": "2012-04-28T02:47:18Z",
    "updated_at": "2025-01-14T13:27:58Z",
    "pushed_at": "2025-01-14T11:34:55Z",
    "size": 264981,
    "stars": 81851,
    "forks": 32045,
    "open_issues": 301,
    "watchers": 81851,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "stable/0.90.x",
      "stable/0.91.x",
      "stable/0.95.x",
      "stable/0.96.x",
      "stable/1.0.x",
      "stable/1.1.x",
      "stable/1.2.x",
      "stable/1.3.x",
      "stable/1.4.x",
      "stable/1.5.x",
      "stable/1.6.x",
      "stable/1.7.x",
      "stable/1.8.x",
      "stable/1.9.x",
      "stable/1.10.x",
      "stable/1.11.x",
      "stable/2.0.x",
      "stable/2.1.x",
      "stable/2.2.x",
      "stable/3.0.x",
      "stable/3.1.x",
      "stable/3.2.x",
      "stable/4.0.x",
      "stable/4.1.x",
      "stable/4.2.x",
      "stable/5.0.x",
      "stable/5.1.x"
    ],
    "languages": {
      "Python": 17607947,
      "HTML": 250858,
      "JavaScript": 158876,
      "CSS": 92030,
      "Smarty": 392,
      "Procfile": 47
    },
    "commit_activity": {
      "total_commits_last_year": 938,
      "avg_commits_per_week": 18.03846153846154,
      "days_active_last_year": 299
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:28:27.491590"
  }
}