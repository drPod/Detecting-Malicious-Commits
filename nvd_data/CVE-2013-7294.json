{
  "cve_id": "CVE-2013-7294",
  "github_data": {
    "repository": "libreswan/libreswan",
    "fix_commit": "2899351224fe2940aec37d7656e1e392c0fe07f0",
    "related_commits": [
      "2899351224fe2940aec37d7656e1e392c0fe07f0",
      "2899351224fe2940aec37d7656e1e392c0fe07f0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2899351224fe2940aec37d7656e1e392c0fe07f0",
      "commit_date": "2013-11-27T00:46:49Z",
      "author": {
        "login": "letoams",
        "type": "User",
        "stats": {
          "total_commits": 10243,
          "average_weekly_commits": 10.55979381443299,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 644
        }
      },
      "commit_message": {
        "title": "SECURITY: Properly handle IKEv2 I1 notification packet without KE payload",
        "length": 73,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 31,
        "additions": 18,
        "deletions": 13
      },
      "files": [
        {
          "filename": "programs/pluto/ikev2_parent.c",
          "status": "modified",
          "additions": 18,
          "deletions": 13,
          "patch": "@@ -306,8 +306,6 @@ static void ikev2_parent_outI1_continue(struct pluto_crypto_req_cont *pcrc,\n \t}\n \treset_cur_state();\n \treset_globals();\n-\n-\tpassert(GLOBALS_ARE_RESET());\n }\n \n /*\n@@ -729,18 +727,31 @@ stf_status ikev2parent_inI1outR1(struct msg_digest *md)\n \t */\n \t{\n \t\tstruct ikev2_ke *ke;\n+\t\tchar fromname[ADDRTOT_BUF];\n+\t\taddrtot(&md->sender, 0, fromname, ADDRTOT_BUF);\n+\n+\t\tif (!md->chain[ISAKMP_NEXT_v2KE]) {\n+\t\t\t/* is this a notify? If so, log it */\n+\t\t\tif(md->chain[ISAKMP_NEXT_v2N]) {\n+\t\t\t\tlibreswan_log(\"Received Notify(%d): %s\",\n+\t\t\t\t\tmd->chain[ISAKMP_NEXT_v2N]->payload.v2n.isan_type,\n+\t\t\t\t\tenum_name(&ikev2_notify_names,\n+\t\t\t\t\t\tmd->chain[ISAKMP_NEXT_v2N]->payload.v2n.isan_type));\n+\t\t\t}\n+\t\t\tlibreswan_log(\n+\t\t\t\t\"rejecting I1 from %s:%u, no KE payload present\",\n+\t\t\t\tfromname, md->sender_port);\n+\t\t\treturn STF_FAIL + v2N_INVALID_KE_PAYLOAD;\n+\t\t}\n \t\tke = &md->chain[ISAKMP_NEXT_v2KE]->payload.v2ke;\n \n \t\tst->st_oakley.group = lookup_group(ke->isak_group);\n \t\tif (st->st_oakley.group == NULL) {\n-\t\t\tchar fromname[ADDRTOT_BUF];\n-\n-\t\t\taddrtot(&md->sender, 0, fromname, ADDRTOT_BUF);\n \t\t\tlibreswan_log(\n \t\t\t\t\"rejecting I1 from %s:%u, invalid DH group=%u\",\n \t\t\t\tfromname, md->sender_port,\n \t\t\t\tke->isak_group);\n-\t\t\treturn v2N_INVALID_KE_PAYLOAD;\n+\t\t\treturn STF_FAIL + v2N_INVALID_KE_PAYLOAD;\n \t\t}\n \t}\n \n@@ -819,8 +830,6 @@ static void ikev2_parent_inI1outR1_continue(struct pluto_crypto_req_cont *pcrc,\n \t\t\trelease_md(ke->md);\n \t}\n \treset_globals();\n-\n-\tpassert(GLOBALS_ARE_RESET());\n }\n \n static stf_status ikev2_parent_inI1outR1_tail(\n@@ -1145,8 +1154,6 @@ static void ikev2_parent_inR1outI2_continue(struct pluto_crypto_req_cont *pcrc,\n \t\t\trelease_md(dh->md);\n \t}\n \treset_globals();\n-\n-\tpassert(GLOBALS_ARE_RESET());\n }\n \n static void ikev2_padup_pre_encrypt(struct msg_digest *md,\n@@ -1714,7 +1721,7 @@ stf_status ikev2parent_inI2outR2(struct msg_digest *md)\n \t/* verify that there is in fact an encrypted payload */\n \tif (!md->chain[ISAKMP_NEXT_v2E]) {\n \t\tlibreswan_log(\"R2 state should receive an encrypted payload\");\n-\t\treset_globals();\n+\t\treset_globals(); /* XXX suspicious - why was this deemed neccessary? */\n \t\treturn STF_FATAL;\n \t}\n \n@@ -1794,8 +1801,6 @@ static void ikev2_parent_inI2outR2_continue(struct pluto_crypto_req_cont *pcrc,\n \t\t\trelease_md(dh->md);\n \t}\n \treset_globals();\n-\n-\tpassert(GLOBALS_ARE_RESET());\n }\n \n static stf_status ikev2_parent_inI2outR2_tail("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "48cf769240bf6f9efe036b4b3b6cd2dc3a231072",
            "date": "2025-01-25T15:33:53Z",
            "author_login": "cagney"
          },
          {
            "sha": "963a3dc2c615db9d6e4e76924260ed5acae57aba",
            "date": "2025-01-25T14:47:11Z",
            "author_login": "cagney"
          },
          {
            "sha": "91d02bc2ee620bddd3c0527c58e695562dae60cd",
            "date": "2025-01-25T14:46:23Z",
            "author_login": "cagney"
          },
          {
            "sha": "90e958ff121320aad6753f9e64717205d34afcb3",
            "date": "2025-01-25T01:56:51Z",
            "author_login": "cagney"
          },
          {
            "sha": "cd7316d440fd8ba31f35ed155e6ee40c5e1e1188",
            "date": "2025-01-25T01:54:22Z",
            "author_login": "cagney"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "The ikev2parent_inI1outR1 function in pluto/ikev2_parent.c in libreswan before 3.7 allows remote attackers to cause a denial of service (restart) via an IKEv2 I1 notification without a KE payload.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-01-16T05:05:26.523",
    "last_modified": "2024-11-21T02:00:40.737",
    "fix_date": "2013-11-27T00:46:49Z"
  },
  "references": [
    {
      "url": "http://secunia.com/advisories/56276",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/56915",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/101573",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/libreswan/libreswan/commit/2899351224fe2940aec37d7656e1e392c0fe07f0",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://lists.libreswan.org/pipermail/swan-announce/2013/000007.html",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/56276",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/56915",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/101573",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/libreswan/libreswan/commit/2899351224fe2940aec37d7656e1e392c0fe07f0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://lists.libreswan.org/pipermail/swan-announce/2013/000007.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.537894",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libreswan",
    "owner": "libreswan",
    "created_at": "2013-02-20T15:09:06Z",
    "updated_at": "2025-01-25T16:13:09Z",
    "pushed_at": "2025-01-25T16:13:04Z",
    "size": 188049,
    "stars": 866,
    "forks": 228,
    "open_issues": 543,
    "watchers": 866,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 5980241,
      "Shell": 2187336,
      "Python": 538653,
      "Makefile": 231272,
      "JavaScript": 45371,
      "sed": 29945,
      "Roff": 19993,
      "Yacc": 16822,
      "Lex": 12486,
      "Perl": 11267,
      "HTML": 8240,
      "Awk": 6188,
      "Dockerfile": 5710,
      "CSS": 2139,
      "XSLT": 522
    },
    "commit_activity": {
      "total_commits_last_year": 2379,
      "avg_commits_per_week": 45.75,
      "days_active_last_year": 298
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:10:48.858497"
  }
}