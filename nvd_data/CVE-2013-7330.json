{
  "cve_id": "CVE-2013-7330",
  "github_data": {
    "repository": "jenkinsci/jenkins",
    "fix_commit": "36342d71e29e0620f803a7470ce96c61761648d8",
    "related_commits": [
      "36342d71e29e0620f803a7470ce96c61761648d8",
      "36342d71e29e0620f803a7470ce96c61761648d8"
    ],
    "patch_url": "https://github.com/jenkinsci/jenkins/commit/36342d71e29e0620f803a7470ce96c61761648d8.patch",
    "fix_commit_details": {
      "sha": "36342d71e29e0620f803a7470ce96c61761648d8",
      "commit_date": "2013-02-11T21:47:10Z",
      "author": {
        "login": "jglick",
        "type": "User",
        "stats": {
          "total_commits": 3950,
          "average_weekly_commits": 5.077120822622108,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 479
        }
      },
      "commit_message": {
        "title": "[SECURITY-55]",
        "length": 494,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 24,
        "additions": 19,
        "deletions": 5
      },
      "files": [
        {
          "filename": "core/src/main/java/hudson/model/AbstractProject.java",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -1914,6 +1914,13 @@ protected void submit(StaplerRequest req, StaplerResponse rsp) throws IOExceptio\n         triggers = buildDescribable(req, Trigger.for_(this));\n         for (Trigger t : triggers)\n             t.start(this,true);\n+\n+        for (Publisher _t : Descriptor.newInstancesFromHeteroList(req, json, \"publisher\", Jenkins.getInstance().getExtensionList(BuildTrigger.DescriptorImpl.class))) {\n+            BuildTrigger t = (BuildTrigger) _t;\n+            for (AbstractProject downstream : t.getChildProjects(this)) {\n+                downstream.checkPermission(BUILD);\n+            }\n+        }\n     }\n \n     /**"
        },
        {
          "filename": "core/src/main/java/hudson/model/Descriptor.java",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -936,7 +936,10 @@ List<T> newInstancesFromHeteroList(StaplerRequest req, Object formData,\n             for (Object o : JSONArray.fromObject(formData)) {\n                 JSONObject jo = (JSONObject)o;\n                 String kind = jo.getString(\"kind\");\n-                items.add(find(descriptors,kind).newInstance(req,jo));\n+                Descriptor<T> d = find(descriptors, kind);\n+                if (d != null) {\n+                    items.add(d.newInstance(req, jo));\n+                }\n             }\n         }\n \n@@ -946,7 +949,7 @@ List<T> newInstancesFromHeteroList(StaplerRequest req, Object formData,\n     /**\n      * Finds a descriptor from a collection by its class name.\n      */\n-    public static <T extends Descriptor> T find(Collection<? extends T> list, String className) {\n+    public static @CheckForNull <T extends Descriptor> T find(Collection<? extends T> list, String className) {\n         for (T d : list) {\n             if(d.getClass().getName().equals(className))\n                 return d;\n@@ -960,7 +963,7 @@ public static <T extends Descriptor> T find(Collection<? extends T> list, String\n         return null;\n     }\n \n-    public static Descriptor find(String className) {\n+    public static @CheckForNull Descriptor find(String className) {\n         return find(Jenkins.getInstance().getExtensionList(Descriptor.class),className);\n     }\n "
        },
        {
          "filename": "core/src/main/java/hudson/tasks/BuildTrigger.java",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -319,7 +319,7 @@ public boolean showEvenIfUnstableOption(@CheckForNull Class<? extends AbstractPr\n         /**\n          * Form validation method.\n          */\n-        public FormValidation doCheck(@AncestorInPath Item project, @QueryParameter String value ) {\n+        public FormValidation doCheck(@AncestorInPath Item project, @QueryParameter String value, @QueryParameter boolean upstream) {\n             // Require CONFIGURE permission on this project\n             if(!project.hasPermission(Item.CONFIGURE))      return FormValidation.ok();\n \n@@ -334,6 +334,9 @@ public FormValidation doCheck(@AncestorInPath Item project, @QueryParameter Stri\n                                 AbstractProject.findNearest(projectName,project.getParent()).getRelativeNameFrom(project)));\n                     if(!(item instanceof AbstractProject))\n                         return FormValidation.error(Messages.BuildTrigger_NotBuildable(projectName));\n+                    if (!upstream && !item.hasPermission(Item.BUILD)) {\n+                        return FormValidation.error(Messages.BuildTrigger_you_have_no_permission_to_build_(projectName));\n+                    }\n                     hasProjects = true;\n                 }\n             }"
        },
        {
          "filename": "core/src/main/resources/hudson/tasks/Messages.properties",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -47,6 +47,7 @@ BuildTrigger.NoSuchProject=No such project ''{0}''. Did you mean ''{1}''?\n BuildTrigger.NoProjectSpecified=No project specified\n BuildTrigger.NotBuildable={0} is not buildable\n BuildTrigger.Triggering=Triggering a new build of {0}\n+BuildTrigger.you_have_no_permission_to_build_=You have no permission to build {0}\n \n CommandInterpreter.CommandFailed=command execution failed\n CommandInterpreter.UnableToDelete=Unable to delete script file {0}"
        },
        {
          "filename": "core/src/main/resources/lib/hudson/project/config-upstream-pseudo-trigger.jelly",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -38,7 +38,7 @@ THE SOFTWARE.\n     <f:entry title=\"${%Project names}\"\n              description=\"${%Multiple projects can be specified like 'abc, def'}\">\n       <f:textbox name=\"upstreamProjects\" value=\"${h.getProjectListString(up)}\"\n-        checkUrl=\"'descriptorByName/hudson.tasks.BuildTrigger/check?value='+encodeURIComponent(this.value)\"\n+        checkUrl=\"'descriptorByName/hudson.tasks.BuildTrigger/check?upstream=true&amp;value='+encodeURIComponent(this.value)\"\n         autoCompleteField=\"upstreamProjects\"/>\n     </f:entry>\n   </f:optionalBlock>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "81af439caeefa41e70fdaa43e738e4e507413615",
            "date": "2025-01-14T16:07:47Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "6f37252727aeab611b5cae5f0605b2e2a4c1a7ad",
            "date": "2025-01-14T16:07:22Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "ab605fad8b35d3a38cdb7499175f0dd131ff8ee4",
            "date": "2025-01-14T13:40:54Z",
            "author_login": "jenkins-release-bot"
          },
          {
            "sha": "475d33c97dfd8a2e6e503672ef246694c91eda4d",
            "date": "2025-01-14T13:40:38Z",
            "author_login": "jenkins-release-bot"
          },
          {
            "sha": "e7f5953809d4d60257a6bfaaf1bc932d077a8597",
            "date": "2025-01-14T07:48:04Z",
            "author_login": "mawinter69"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "Jenkins before 1.502 allows remote authenticated users to configure an otherwise restricted project via vectors related to post-build actions.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-10-17T15:55:05.463",
    "last_modified": "2024-11-21T02:00:45.820",
    "fix_date": "2013-02-11T21:47:10Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/02/21/2",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/36342d71e29e0620f803a7470ce96c61761648d8",
      "source": "security@debian.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2014-02-14",
      "source": "security@debian.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/02/21/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/36342d71e29e0620f803a7470ce96c61761648d8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2014-02-14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:27.940135",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jenkins",
    "owner": "jenkinsci",
    "created_at": "2010-11-22T21:21:23Z",
    "updated_at": "2025-01-14T11:56:32Z",
    "pushed_at": "2025-01-14T07:48:05Z",
    "size": 162004,
    "stars": 23472,
    "forks": 8877,
    "open_issues": 74,
    "watchers": 23472,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable-1.625",
      "stable-1.642",
      "stable-1.651",
      "stable-2.7",
      "stable-2.19",
      "stable-2.32",
      "stable-2.46",
      "stable-2.60",
      "stable-2.73",
      "stable-2.89",
      "stable-2.107",
      "stable-2.121",
      "stable-2.138",
      "stable-2.150",
      "stable-2.164",
      "stable-2.176",
      "stable-2.190",
      "stable-2.204",
      "stable-2.222",
      "stable-2.235",
      "stable-2.249",
      "stable-2.263",
      "stable-2.277",
      "stable-2.289",
      "stable-2.302"
    ],
    "languages": {
      "Java": 12325164,
      "HTML": 970700,
      "JavaScript": 398710,
      "SCSS": 330642,
      "Groovy": 68802,
      "CSS": 41768,
      "Ruby": 17290,
      "Perl": 16145,
      "Handlebars": 14958,
      "Python": 4925,
      "ANTLR": 4633,
      "Shell": 2872,
      "C": 2091,
      "Batchfile": 1023,
      "Dockerfile": 210
    },
    "commit_activity": {
      "total_commits_last_year": 1355,
      "avg_commits_per_week": 26.057692307692307,
      "days_active_last_year": 302
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:17:56.125951"
  }
}