{
  "cve_id": "CVE-2013-7351",
  "github_data": {
    "repository": "sebsauvage/Shaarli",
    "fix_commit": "53da201749f8f362323ef278bf338f1d9f7a925a",
    "related_commits": [
      "53da201749f8f362323ef278bf338f1d9f7a925a",
      "53da201749f8f362323ef278bf338f1d9f7a925a"
    ],
    "patch_url": "https://github.com/sebsauvage/Shaarli/commit/53da201749f8f362323ef278bf338f1d9f7a925a.patch",
    "fix_commit_details": {
      "sha": "53da201749f8f362323ef278bf338f1d9f7a925a",
      "commit_date": "2013-11-29T20:53:20Z",
      "author": {
        "login": "sebsauvage",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "XSS flaw correction",
        "length": 82,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
      },
      "files": [
        {
          "filename": "index.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -942,7 +942,7 @@ function showRSS()\n         echo '<description><![CDATA['.nl2br(keepMultipleSpaces(text2clickable(htmlspecialchars($link['description'])))).$descriptionlink.']]></description>'.\"\\n</item>\\n\";\n         $i++;\n     }\n-    echo '</channel></rss><!-- Cached version of '.pageUrl().' -->';\n+    echo '</channel></rss><!-- Cached version of '.htmlspecialchars(pageUrl()).' -->';\n \n     $cache->cache(ob_get_contents());\n     ob_end_flush();\n@@ -1027,7 +1027,7 @@ function showATOM()\n     $feed.='<author><name>'.htmlspecialchars($pageaddr).'</name><uri>'.htmlspecialchars($pageaddr).'</uri></author>';\n     $feed.='<id>'.htmlspecialchars($pageaddr).'</id>'.\"\\n\\n\"; // Yes, I know I should use a real IRI (RFC3987), but the site URL will do.\n     $feed.=$entries;\n-    $feed.='</feed><!-- Cached version of '.pageUrl().' -->';\n+    $feed.='</feed><!-- Cached version of '.htmlspecialchars(pageUrl()).' -->';\n     echo $feed;\n \n     $cache->cache(ob_get_contents());\n@@ -1104,7 +1104,7 @@ function showDailyRSS()\n         echo '<description><![CDATA['.$html.']]></description>'.\"\\n</item>\\n\\n\";\n \n     }\n-    echo '</channel></rss><!-- Cached version of '.pageUrl().' -->';\n+    echo '</channel></rss><!-- Cached version of '.htmlspecialchars(pageUrl()).' -->';\n \n     $cache->cache(ob_get_contents());\n     ob_end_flush();\n@@ -1747,11 +1747,11 @@ function importFile()\n         }\n         $LINKSDB->savedb();\n \n-        echo '<script language=\"JavaScript\">alert(\"File '.$filename.' ('.$filesize.' bytes) was successfully processed: '.$import_count.' links imported.\");document.location=\\'?\\';</script>';\n+        echo '<script language=\"JavaScript\">alert(\"File '.json_encode($filename).' ('.$filesize.' bytes) was successfully processed: '.$import_count.' links imported.\");document.location=\\'?\\';</script>';\n     }\n     else\n     {\n-        echo '<script language=\"JavaScript\">alert(\"File '.$filename.' ('.$filesize.' bytes) has an unknown file format. Nothing was imported.\");document.location=\\'?\\';</script>';\n+        echo '<script language=\"JavaScript\">alert(\"File '.json_encode($filename).' ('.$filesize.' bytes) has an unknown file format. Nothing was imported.\");document.location=\\'?\\';</script>';\n     }\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "029f75f180f79cd581786baf1b37e810da1adfc3",
            "date": "2016-01-12T08:38:29Z",
            "author_login": "sebsauvage"
          },
          {
            "sha": "c2be107852ade1150402747e166b62fc041f8df9",
            "date": "2015-09-16T06:28:14Z",
            "author_login": "sebsauvage"
          },
          {
            "sha": "134cbf7a9e52ca31b1abaf88bdc2d4cd632b1c54",
            "date": "2015-09-16T06:26:44Z",
            "author_login": "sebsauvage"
          },
          {
            "sha": "48b68c8fa5aa9ca98f3a9aaf9277656fe0cafb01",
            "date": "2014-02-14T15:52:22Z",
            "author_login": "sebsauvage"
          },
          {
            "sha": "012e76e78cda9c68fa29252d3211d09f82149520",
            "date": "2014-02-14T15:38:05Z",
            "author_login": "timovn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in index.php in Shaarli allow remote attackers to inject arbitrary web script or HTML via the URL to the (1) showRSS, (2) showATOM, or (3) showDailyRSS function; a (4) file name to the importFile function; or (5) vectors related to bookmarks.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-01-02T20:15:15.130",
    "last_modified": "2024-11-21T02:00:48.770",
    "fix_date": "2013-11-29T20:53:20Z"
  },
  "references": [
    {
      "url": "http://seclists.org/oss-sec/2014/q2/1",
      "source": "security@debian.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q2/4",
      "source": "security@debian.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/92215",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/sebsauvage/Shaarli/commit/53da201749f8f362323ef278bf338f1d9f7a925a",
      "source": "security@debian.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sebsauvage/Shaarli/issues/134",
      "source": "security@debian.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q2/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q2/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/92215",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/sebsauvage/Shaarli/commit/53da201749f8f362323ef278bf338f1d9f7a925a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sebsauvage/Shaarli/issues/134",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:37.454107",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Shaarli",
    "owner": "sebsauvage",
    "created_at": "2012-04-16T11:09:41Z",
    "updated_at": "2024-12-29T22:57:56Z",
    "pushed_at": "2024-06-05T10:31:17Z",
    "size": 3313,
    "stars": 682,
    "forks": 398,
    "open_issues": 119,
    "watchers": 682,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 155859,
      "HTML": 27897,
      "CSS": 17178
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:27:00.847832"
  }
}