{
  "cve_id": "CVE-2013-7459",
  "github_data": {
    "repository": "dlitz/pycrypto",
    "fix_commit": "8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4",
    "related_commits": [
      "8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4",
      "8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4"
    ],
    "patch_url": "https://github.com/dlitz/pycrypto/commit/8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4.patch",
    "fix_commit_details": {
      "sha": "8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4",
      "commit_date": "2013-12-22T21:24:46Z",
      "author": {
        "login": "Legrandin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Throw exception when IV is used with ECB or CTR",
        "length": 330,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 42,
        "additions": 34,
        "deletions": 8
      },
      "files": [
        {
          "filename": "lib/Crypto/SelfTest/Cipher/common.py",
          "status": "modified",
          "additions": 23,
          "deletions": 8,
          "patch": "@@ -605,19 +605,34 @@ def shortDescription(self):\n         return \"\"\"%s .decrypt() output of .encrypt() should not be garbled\"\"\" % (self.module_name,)\n \n     def runTest(self):\n-        for mode in (self.module.MODE_ECB, self.module.MODE_CBC, self.module.MODE_CFB, self.module.MODE_OFB, self.module.MODE_OPENPGP):\n+\n+        ## ECB mode\n+        mode = self.module.MODE_ECB\n+        encryption_cipher = self.module.new(a2b_hex(self.key), mode)\n+        ciphertext = encryption_cipher.encrypt(self.plaintext)\n+        decryption_cipher = self.module.new(a2b_hex(self.key), mode)\n+        decrypted_plaintext = decryption_cipher.decrypt(ciphertext)\n+        self.assertEqual(self.plaintext, decrypted_plaintext)\n+\n+        ## OPENPGP mode\n+        mode = self.module.MODE_OPENPGP\n+        encryption_cipher = self.module.new(a2b_hex(self.key), mode, self.iv)\n+        eiv_ciphertext = encryption_cipher.encrypt(self.plaintext)\n+        eiv = eiv_ciphertext[:self.module.block_size+2]\n+        ciphertext = eiv_ciphertext[self.module.block_size+2:]\n+        decryption_cipher = self.module.new(a2b_hex(self.key), mode, eiv)\n+        decrypted_plaintext = decryption_cipher.decrypt(ciphertext)\n+        self.assertEqual(self.plaintext, decrypted_plaintext)\n+\n+        ## All other non-AEAD modes (but CTR)\n+        for mode in (self.module.MODE_CBC, self.module.MODE_CFB, self.module.MODE_OFB):\n             encryption_cipher = self.module.new(a2b_hex(self.key), mode, self.iv)\n             ciphertext = encryption_cipher.encrypt(self.plaintext)\n-\n-            if mode != self.module.MODE_OPENPGP:\n-                decryption_cipher = self.module.new(a2b_hex(self.key), mode, self.iv)\n-            else:\n-                eiv = ciphertext[:self.module.block_size+2]\n-                ciphertext = ciphertext[self.module.block_size+2:]\n-                decryption_cipher = self.module.new(a2b_hex(self.key), mode, eiv)\n+            decryption_cipher = self.module.new(a2b_hex(self.key), mode, self.iv)\n             decrypted_plaintext = decryption_cipher.decrypt(ciphertext)\n             self.assertEqual(self.plaintext, decrypted_plaintext)\n \n+\n class PGPTest(unittest.TestCase):\n     def __init__(self, module, params):\n         unittest.TestCase.__init__(self)"
        },
        {
          "filename": "src/block_template.c",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -158,6 +158,17 @@ ALGnew(PyObject *self, PyObject *args, PyObject *kwdict)\n \t\t\t\t\"Key cannot be the null string\");\n \t\treturn NULL;\n \t}\n+\tif (IVlen != 0 && mode == MODE_ECB)\n+\t{\n+\t\tPyErr_Format(PyExc_ValueError, \"ECB mode does not use IV\");\n+\t\treturn NULL;\n+\t}\n+\tif (IVlen != 0 && mode == MODE_CTR)\n+\t{\n+\t\tPyErr_Format(PyExc_ValueError,\n+\t\t\t\"CTR mode needs counter parameter, not IV\");\n+\t\treturn NULL;\n+\t}\n \tif (IVlen != BLOCK_SIZE && mode != MODE_ECB && mode != MODE_CTR)\n \t{\n \t\tPyErr_Format(PyExc_ValueError,"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "65b43bd4ffe2a48bdedae986b1a291f5a2cc7df7",
            "date": "2022-01-25T06:57:52Z",
            "author_login": "dlitz"
          },
          {
            "sha": "c2ebfaca998691bc4386f237cde351e926ca3cdb",
            "date": "2022-01-25T06:29:04Z",
            "author_login": "dlitz"
          },
          {
            "sha": "d5782d87af27db8cc5776a3f476c11f8bb6e41a3",
            "date": "2022-01-25T05:40:09Z",
            "author_login": "dlitz"
          },
          {
            "sha": "9b0a52449b4b4e0afb691f6206e4b59b534965d5",
            "date": "2022-01-25T05:14:47Z",
            "author_login": "dlitz"
          },
          {
            "sha": "4d75f91e18799a99bbd476b345c558d3ec457762",
            "date": "2022-01-23T03:53:27Z",
            "author_login": "dlitz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-119",
    "description": "Heap-based buffer overflow in the ALGnew function in block_templace.c in Python Cryptography Toolkit (aka pycrypto) allows remote attackers to execute arbitrary code as demonstrated by a crafted iv parameter to cryptmsg.py.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-02-15T15:59:00.153",
    "last_modified": "2024-11-21T02:01:03.513",
    "fix_date": "2013-12-22T21:24:46Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/12/27/8",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95122",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1409754",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/dlitz/pycrypto/commit/8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/dlitz/pycrypto/issues/176",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/C6BWNADPLKDBBQBUT3P75W7HAJCE7M3B/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RJ37R2YLX56YZABFNAOWV4VTHTGYREAE/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://pony7.fr/ctf:public:32c3:cryptmsg",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201702-14",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/12/27/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95122",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1409754",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/dlitz/pycrypto/commit/8dbe0dc3eea5c689d4f76b37b93fe216cf1f00d4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/dlitz/pycrypto/issues/176",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/C6BWNADPLKDBBQBUT3P75W7HAJCE7M3B/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RJ37R2YLX56YZABFNAOWV4VTHTGYREAE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://pony7.fr/ctf:public:32c3:cryptmsg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201702-14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.223468",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pycrypto",
    "owner": "dlitz",
    "created_at": "2010-11-30T02:10:21Z",
    "updated_at": "2025-01-02T13:33:31Z",
    "pushed_at": "2022-01-26T16:04:12Z",
    "size": 12155,
    "stars": 2453,
    "forks": 636,
    "open_issues": 212,
    "watchers": 2453,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 1109420,
      "C": 711411,
      "Shell": 43068,
      "M4": 15692
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T22:12:11.572916"
  }
}