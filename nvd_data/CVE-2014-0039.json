{
  "cve_id": "CVE-2014-0039",
  "github_data": {
    "repository": "mrash/fwsnort",
    "fix_commit": "fa977453120cc48e1654f373311f9cac468d3348",
    "related_commits": [
      "fa977453120cc48e1654f373311f9cac468d3348",
      "fa977453120cc48e1654f373311f9cac468d3348"
    ],
    "patch_url": "https://github.com/mrash/fwsnort/commit/fa977453120cc48e1654f373311f9cac468d3348.patch",
    "fix_commit_details": {
      "sha": "fa977453120cc48e1654f373311f9cac468d3348",
      "commit_date": "2014-02-01T19:58:22Z",
      "author": {
        "login": "mrash",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bug fix for CVE-2014-0039",
        "length": 511,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 23,
        "deletions": 2
      },
      "files": [
        {
          "filename": "CREDITS",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -90,3 +90,12 @@ Dwight Davis\n       handling --strict mode opertions correctly, and more.  These issues and\n       the corresponding patch were originally reported here:\n         http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=693000\n+\n+Murray McAllister (Red Hat Security Team)\n+    - Reported a bug fix for vulnerability CVE-2014-0039 in which an attacker-\n+      controlled fwsnort.conf file could be read by fwsnort when not running as\n+      root.  This was caused by fwsnort reading './fwsnort.conf' when not\n+      running as root and when a path to the config file was not explicitly set\n+      with -c on the command line.  This behavior has been changed to require\n+      the user to specify a path to fwsnort.conf with -c when not running as\n+      root."
        },
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,3 +1,12 @@\n+fwsnort-1.6.4 (02//2014):\n+    - Bug fix for vulnerability CVE-2014-0039 reported by Murray McAllister of\n+      the Red Hat Security Team in which an attacker-controlled fwsnort.conf\n+      file could be read by fwsnort when not running as root.  This was caused\n+      by fwsnort reading './fwsnort.conf' when not running as root and when a\n+      path to the config file was not explicitly set with -c on the command\n+      line.  This behavior has been changed to require the user to specify a\n+      path to fwsnort.conf with -c when not running as root.\n+\n fwsnort-1.6.3 (12/21/2012):\n     - Bug fix to ensure that !, <, >, and = chars in content strings are\n       converted to the appropriate hex equivalents.  All content strings with"
        },
        {
          "filename": "fwsnort",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -4660,8 +4660,10 @@ sub is_root() {\n }\n \n sub set_non_root_values() {\n+\n     if ($fwsnort_conf eq $CONFIG_DEFAULT) {\n-        $fwsnort_conf = './fwsnort.conf';\n+        die \"[*] Must specify a path to readable \",\n+            \"fwsnort.conf file when not running as root.\";\n     }\n \n     &set_defaults_without_ipt_test();"
        },
        {
          "filename": "fwsnort.8",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -82,7 +82,8 @@ By default fwsnort makes use of the configuration file\n .B /etc/fwsnort/fwsnort.conf\n for almost all configuration parameters.  fwsnort can be made to\n override this path by specifying a different file on the command\n-line with the \\-\\-config option.\n+line with the \\-\\-config option.  When fwsnort is not executed as root, then\n+a path to a readable fwsnort.conf file is required.\n .TP\n .BR \\-\\^\\-update-rules\n Download the latest Emerging Threats rules from http://www.emergingthreats.net"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6c5f76e0098edd4c951202272346fe60f27689b",
            "date": "2018-11-26T00:15:23Z",
            "author_login": "mrash"
          },
          {
            "sha": "e366899fba8b959c28755486239b6bbd0807c922",
            "date": "2018-08-01T00:45:56Z",
            "author_login": "mrash"
          },
          {
            "sha": "b0adb84ccf1664fbb7e7c1066c58d799de1899a1",
            "date": "2018-07-31T00:00:57Z",
            "author_login": "mrash"
          },
          {
            "sha": "c01bd3eaaa3294881c193d105ae82787fdea1beb",
            "date": "2018-07-30T23:58:05Z",
            "author_login": "mrash"
          },
          {
            "sha": "7aaa23352645e4719d4a83340a163d4df6d232c1",
            "date": "2017-05-06T20:53:58Z",
            "author_login": "mrash"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "Untrusted search path vulnerability in fwsnort before 1.6.4, when not running as root, allows local users to execute arbitrary code via a Trojan horse fwsnort.conf in the current working directory.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-02-08T00:55:06.113",
    "last_modified": "2024-11-21T02:01:13.810",
    "fix_date": "2014-02-01T19:58:22Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-February/128188.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-February/128205.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://osvdb.org/102822",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/221",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/65341",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/mrash/fwsnort/blob/master/ChangeLog",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/mrash/fwsnort/commit/fa977453120cc48e1654f373311f9cac468d3348",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-February/128188.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-February/128205.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://osvdb.org/102822",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/65341",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mrash/fwsnort/blob/master/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mrash/fwsnort/commit/fa977453120cc48e1654f373311f9cac468d3348",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.560288",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fwsnort",
    "owner": "mrash",
    "created_at": "2011-06-13T05:10:34Z",
    "updated_at": "2024-11-19T10:09:12Z",
    "pushed_at": "2018-11-26T00:17:10Z",
    "size": 4777,
    "stars": 74,
    "forks": 15,
    "open_issues": 10,
    "watchers": 74,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Perl": 284631,
      "Roff": 19426
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T17:31:00.689863"
  }
}