{
  "cve_id": "CVE-2014-0073",
  "github_data": {
    "repository": "apache/cordova-plugin-inappbrowser",
    "fix_commit": "26702cb0720c5c394b407c23570136c53171fa55",
    "related_commits": [
      "26702cb0720c5c394b407c23570136c53171fa55",
      "26702cb0720c5c394b407c23570136c53171fa55"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "26702cb0720c5c394b407c23570136c53171fa55",
      "commit_date": "2014-02-19T05:26:19Z",
      "author": {
        "login": "clelland",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Validate that callbackId is correctly formed",
        "length": 44,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 20,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/ios/CDVInAppBrowser.h",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -30,6 +30,7 @@\n \n @property (nonatomic, retain) CDVInAppBrowserViewController* inAppBrowserViewController;\n @property (nonatomic, copy) NSString* callbackId;\n+@property (nonatomic, copy) NSRegularExpression *callbackIdPattern;\n \n - (void)open:(CDVInvokedUrlCommand*)command;\n - (void)close:(CDVInvokedUrlCommand*)command;"
        },
        {
          "filename": "src/ios/CDVInAppBrowser.m",
          "status": "modified",
          "additions": 19,
          "deletions": 1,
          "patch": "@@ -47,6 +47,7 @@ - (CDVInAppBrowser*)initWithWebView:(UIWebView*)theWebView\n     self = [super initWithWebView:theWebView];\n     if (self != nil) {\n         _previousStatusBarStyle = -1;\n+        _callbackIdPattern = nil;\n     }\n \n     return self;\n@@ -297,6 +298,23 @@ - (void)injectStyleFile:(CDVInvokedUrlCommand*)command\n     [self injectDeferredObject:[command argumentAtIndex:0] withWrapper:jsWrapper];\n }\n \n+- (BOOL)isValidCallbackId:(NSString *)callbackId\n+{\n+    NSError *err = nil;\n+    // Initialize on first use\n+    if (self.callbackIdPattern == nil) {\n+        self.callbackIdPattern = [NSRegularExpression regularExpressionWithPattern:@\"^InAppBrowser[0-9]{1,10}$\" options:0 error:&err];\n+        if (err != nil) {\n+            // Couldn't initialize Regex; No is safer than Yes.\n+            return NO;\n+        }\n+    }\n+    if ([self.callbackIdPattern firstMatchInString:callbackId options:0 range:NSMakeRange(0, [callbackId length])]) {\n+        return YES;\n+    }\n+    return NO;\n+}\n+\n /**\n  * The iframe bridge provided for the InAppBrowser is capable of executing any oustanding callback belonging\n  * to the InAppBrowser plugin. Care has been taken that other callbacks cannot be triggered, and that no\n@@ -323,7 +341,7 @@ - (BOOL)webView:(UIWebView*)theWebView shouldStartLoadWithRequest:(NSURLRequest*\n         NSString* scriptCallbackId = [url host];\n         CDVPluginResult* pluginResult = nil;\n \n-        if ([scriptCallbackId hasPrefix:@\"InAppBrowser\"]) {\n+        if ([self isValidCallbackId:scriptCallbackId]) {\n             NSString* scriptResult = [url path];\n             NSError* __autoreleasing error = nil;\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e2d8429092b5d121745911530091fe9eb1f27c43",
            "date": "2024-08-30T06:58:15Z",
            "author_login": "dpogue"
          },
          {
            "sha": "dfde59d7ac4b4cce33dc9c08b4c63d0b7b48a383",
            "date": "2024-08-29T09:54:08Z",
            "author_login": "erisu"
          },
          {
            "sha": "eac7303ff52c857470273db2aff321830f1d76d5",
            "date": "2023-11-28T21:04:30Z",
            "author_login": "jcesarmobile"
          },
          {
            "sha": "f27c663daae07fd53fabee5a5842fc9937d6d8ab",
            "date": "2023-11-10T10:26:46Z",
            "author_login": "NiklasMerz"
          },
          {
            "sha": "2b7288960f15cef70e2d7ad3a751e0ffba1f52a5",
            "date": "2023-11-10T10:16:38Z",
            "author_login": "NiklasMerz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "The CDVInAppBrowser class in the Apache Cordova In-App-Browser standalone plugin (org.apache.cordova.inappbrowser) before 0.3.2 for iOS and the In-App-Browser plugin for iOS from Cordova 2.6.0 through 2.9.0 does not properly validate callback identifiers, which allows remote attackers to execute arbitrary JavaScript in the host page and consequently gain privileges via a crafted gap-iab: URI.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-10-30T19:29:00.373",
    "last_modified": "2024-11-21T02:01:18.110",
    "fix_date": "2014-02-19T05:26:19Z"
  },
  "references": [
    {
      "url": "http://d3adend.org/blog/?p=403",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Mar/30",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/531334/100/0/threaded",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/65959",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/91560",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/apache/cordova-plugin-inappbrowser/commit/26702cb0720c5c394b407c23570136c53171fa55",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://mail-archives.apache.org/mod_mbox/cordova-dev/201403.mbox/%3CCAK_TSXLGJag5Q9ATUCbFtkWvMWX9XnC80kKp-HKi25gPcvV4gw%40mail.gmail.com%3E",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://d3adend.org/blog/?p=403",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Mar/30",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/531334/100/0/threaded",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/65959",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/91560",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/apache/cordova-plugin-inappbrowser/commit/26702cb0720c5c394b407c23570136c53171fa55",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://mail-archives.apache.org/mod_mbox/cordova-dev/201403.mbox/%3CCAK_TSXLGJag5Q9ATUCbFtkWvMWX9XnC80kKp-HKi25gPcvV4gw%40mail.gmail.com%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.721651",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "cordova-plugin-inappbrowser",
    "owner": "apache",
    "created_at": "2013-06-22T07:00:17Z",
    "updated_at": "2025-01-25T00:01:05Z",
    "pushed_at": "2024-08-30T06:58:15Z",
    "size": 1979,
    "stars": 1120,
    "forks": 2157,
    "open_issues": 316,
    "watchers": 1120,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 75385,
      "Objective-C": 70230,
      "JavaScript": 53116,
      "HTML": 6261,
      "CSS": 861
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:01:50.573247"
  }
}