{
  "cve_id": "CVE-2014-125027",
  "github_data": {
    "repository": "yunasc/tbdev",
    "fix_commit": "0ba3fd4be29dd48fa4455c236a9403b3149a4fd4",
    "related_commits": [
      "0ba3fd4be29dd48fa4455c236a9403b3149a4fd4",
      "0ba3fd4be29dd48fa4455c236a9403b3149a4fd4"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "0ba3fd4be29dd48fa4455c236a9403b3149a4fd4",
      "commit_date": "2014-06-08T18:20:36Z",
      "author": {
        "login": "yunasc",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[SECURITY] usersearch.php multiple XSS vulnerability fixes",
        "length": 58,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 17,
        "deletions": 17
      },
      "files": [
        {
          "filename": "usersearch.php",
          "status": "modified",
          "additions": 17,
          "deletions": 17,
          "patch": "@@ -102,7 +102,7 @@ function get_user_icons($arr, $big = false)\n <tr>\r\n \r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd:</td>\r\n-  <td<?=$_GET['n']?$highlight:\"\"?>><input name=\"n\" type=\"text\" value=\"<?=$_GET['n']?>\" size=35></td>\r\n+  <td<?=$_GET['n']?$highlight:\"\"?>><input name=\"n\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['n'])?>\" size=35></td>\r\n \r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n   <td<?=$_GET['r']?$highlight:\"\"?>><select name=\"rt\">\r\n@@ -113,8 +113,8 @@ function get_user_icons($arr, $big = false)\n \t}\r\n \t?>\r\n     </select>\r\n-    <input name=\"r\" type=\"text\" value=\"<?=$_GET['r']?>\" size=\"5\" maxlength=\"4\">\r\n-    <input name=\"r2\" type=\"text\" value=\"<?=$_GET['r2']?>\" size=\"5\" maxlength=\"4\"></td>\r\n+    <input name=\"r\" type=\"text\" value=\"<?=floatval($_GET['r'])?>\" size=\"5\" maxlength=\"4\">\r\n+    <input name=\"r2\" type=\"text\" value=\"<?=floatval($_GET['r2'])?>\" size=\"5\" maxlength=\"4\"></td>\r\n \r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n   <td<?=$_GET['st']?$highlight:\"\"?>><select name=\"st\">\r\n@@ -126,9 +126,9 @@ function get_user_icons($arr, $big = false)\n     ?>\r\n     </select></td></tr>\r\n <tr><td valign=\"middle\" class=rowhead>Email:</td>\r\n-  <td<?=$_GET['em']?$highlight:\"\"?>><input name=\"em\" type=\"text\" value=\"<?=$_GET['em']?>\" size=\"35\"></td>\r\n+  <td<?=$_GET['em']?$highlight:\"\"?>><input name=\"em\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['em'])?>\" size=\"35\"></td>\r\n   <td valign=\"middle\" class=rowhead>IP:</td>\r\n-  <td<?=$_GET['ip']?$highlight:\"\"?>><input name=\"ip\" type=\"text\" value=\"<?=$_GET['ip']?>\" maxlength=\"17\"></td>\r\n+  <td<?=$_GET['ip']?$highlight:\"\"?>><input name=\"ip\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['ip'])?>\" maxlength=\"17\"></td>\r\n \r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n   <td<?=$_GET['as']?$highlight:\"\"?>><select name=\"as\">\r\n@@ -141,9 +141,9 @@ function get_user_icons($arr, $big = false)\n     </select></td></tr>\r\n <tr>\r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n-  <td<?=$_GET['co']?$highlight:\"\"?>><input name=\"co\" type=\"text\" value=\"<?=$_GET['co']?>\" size=\"35\"></td>\r\n+  <td<?=$_GET['co']?$highlight:\"\"?>><input name=\"co\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['co'])?>\" size=\"35\"></td>\r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n-  <td<?=$_GET['ma']?$highlight:\"\"?>><input name=\"ma\" type=\"text\" value=\"<?=$_GET['ma']?>\" maxlength=\"17\"></td>\r\n+  <td<?=$_GET['ma']?$highlight:\"\"?>><input name=\"ma\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['ma'])?>\" maxlength=\"17\"></td>\r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n   <td<?=($_GET['c'] && $_GET['c'] != 1)?$highlight:\"\"?>><select name=\"c\"><option value='1'>(\ufffd\ufffd\ufffd\ufffd\ufffd)</option>\r\n   <?\r\n@@ -171,9 +171,9 @@ function get_user_icons($arr, $big = false)\n     ?>\r\n     </select>\r\n \r\n-    <input name=\"d\" type=\"text\" value=\"<?=$_GET['d']?>\" size=\"12\" maxlength=\"10\">\r\n+    <input name=\"d\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['d'])?>\" size=\"12\" maxlength=\"10\">\r\n \r\n-    <input name=\"d2\" type=\"text\" value=\"<?=$_GET['d2']?>\" size=\"12\" maxlength=\"10\"></td>\r\n+    <input name=\"d2\" type=\"text\" value=\"<?=htmlspecialchars_uni($_GET['d2'])?>\" size=\"12\" maxlength=\"10\"></td>\r\n \r\n \r\n   <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n@@ -187,9 +187,9 @@ function get_user_icons($arr, $big = false)\n     ?>\r\n     </select>\r\n \r\n-    <input name=\"ul\" type=\"text\" id=\"ul\" size=\"8\" maxlength=\"7\" value=\"<?=$_GET['ul']?>\">\r\n+    <input name=\"ul\" type=\"text\" id=\"ul\" size=\"8\" maxlength=\"7\" value=\"<?=intval($_GET['ul'])?>\">\r\n \r\n-    <input name=\"ul2\" type=\"text\" id=\"ul2\" size=\"8\" maxlength=\"7\" value=\"<?=$_GET['ul2']?>\"></td>\r\n+    <input name=\"ul2\" type=\"text\" id=\"ul2\" size=\"8\" maxlength=\"7\" value=\"<?=intval($_GET['ul2'])?>\"></td>\r\n   <td valign=\"middle\" class=\"rowhead\">\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n \r\n   <td<?=$_GET['do']?$highlight:\"\"?>><select name=\"do\">\r\n@@ -213,9 +213,9 @@ function get_user_icons($arr, $big = false)\n   ?>\r\n   </select>\r\n \r\n-  <input name=\"ls\" type=\"text\" value=\"<?=$_GET['ls']?>\" size=\"12\" maxlength=\"10\">\r\n+  <input name=\"ls\" type=\"text\" value=\"<?=intval($_GET['ls'])?>\" size=\"12\" maxlength=\"10\">\r\n \r\n-  <input name=\"ls2\" type=\"text\" value=\"<?=$_GET['ls2']?>\" size=\"12\" maxlength=\"10\"></td>\r\n+  <input name=\"ls2\" type=\"text\" value=\"<?=intval($_GET['ls2'])?>\" size=\"12\" maxlength=\"10\"></td>\r\n \t  <td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n \r\n   <td<?=$_GET['dl']?$highlight:\"\"?>><select name=\"dlt\" id=\"dlt\">\r\n@@ -227,9 +227,9 @@ function get_user_icons($arr, $big = false)\n \t?>\r\n     </select>\r\n \r\n-    <input name=\"dl\" type=\"text\" id=\"dl\" size=\"8\" maxlength=\"7\" value=\"<?=$_GET['dl']?>\">\r\n+    <input name=\"dl\" type=\"text\" id=\"dl\" size=\"8\" maxlength=\"7\" value=\"<?=intval($_GET['dl'])?>\">\r\n \r\n-    <input name=\"dl2\" type=\"text\" id=\"dl2\" size=\"8\" maxlength=\"7\" value=\"<?=$_GET['dl2']?>\"></td>\r\n+    <input name=\"dl2\" type=\"text\" id=\"dl2\" size=\"8\" maxlength=\"7\" value=\"<?=intval($_GET['dl2'])?>\"></td>\r\n \r\n \t<td valign=\"middle\" class=rowhead>\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd:</td>\r\n \r\n@@ -412,7 +412,7 @@ function haswildcard($text){\n       \t$n = substr($mask, 1, strlen($mask) - 1);\r\n         if (!is_numeric($n) or $n < 0 or $n > 32)\r\n         {\r\n-        \tstdmsg($tracker_lang['error'], \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.\");\r\n+        \tstdmsg($tracker_lang['error'], \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.\");\r\n         \tstdfoot();\r\n           die();\r\n         }\r\n@@ -421,7 +421,7 @@ function haswildcard($text){\n       }\r\n       elseif (!preg_match($regex, $mask))\r\n       {\r\n-\t\t\t\tstdmsg($tracker_lang['error'], \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.\");\r\n+\t\t\t\tstdmsg($tracker_lang['error'], \"\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd.\");\r\n \t\t\t\tstdfoot();\r\n \t      die();\r\n       }\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7f757ec5c65b258db54ccaecb92c98d073cc4931",
            "date": "2022-04-28T20:49:05Z",
            "author_login": "yunasc"
          },
          {
            "sha": "19c14c70be1708f9d62eb2214a5e9467c563f107",
            "date": "2022-04-28T14:18:12Z",
            "author_login": "slrslr"
          },
          {
            "sha": "239d5320ad48f1c3cad439bcbede7b6f0ce70667",
            "date": "2014-07-22T12:59:17Z",
            "author_login": "yunasc"
          },
          {
            "sha": "3bc09d0c1f2cd8458c982bb1f2f978a88256e54e",
            "date": "2014-07-22T09:14:20Z",
            "author_login": "yunasc"
          },
          {
            "sha": "52ef95c789590dea8f3aa34b296a55dc9d107447",
            "date": "2014-07-22T08:58:52Z",
            "author_login": "yunasc"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability has been found in Yuna Scatari TBDev up to 2.1.17 and classified as problematic. Affected by this vulnerability is the function get_user_icons of the file usersearch.php. The manipulation of the argument n/r/r2/em/ip/co/ma/d/d2/ul/ul2/ls/ls2/dl/dl2 leads to cross site scripting. The attack can be launched remotely. Upgrading to version 2.1.18 is able to address this issue. The patch is named 0ba3fd4be29dd48fa4455c236a9403b3149a4fd4. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-217147.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-31T16:15:08.650",
    "last_modified": "2024-11-21T02:03:37.743",
    "fix_date": "2014-06-08T18:20:36Z"
  },
  "references": [
    {
      "url": "https://github.com/yunasc/tbdev/commit/0ba3fd4be29dd48fa4455c236a9403b3149a4fd4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yunasc/tbdev/releases/tag/v2.1.18",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217147",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217147",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yunasc/tbdev/commit/0ba3fd4be29dd48fa4455c236a9403b3149a4fd4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yunasc/tbdev/releases/tag/v2.1.18",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217147",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217147",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.240658",
    "processing_status": "enhanced"
  }
}