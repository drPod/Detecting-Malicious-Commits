{
  "cve_id": "CVE-2014-125033",
  "github_data": {
    "repository": "bertrand-caron/rails-cv-app",
    "fix_commit": "0d20362af0a5f8a126f67c77833868908484a863",
    "related_commits": [
      "0d20362af0a5f8a126f67c77833868908484a863",
      "0d20362af0a5f8a126f67c77833868908484a863"
    ],
    "patch_url": "https://github.com/bertrand-caron/rails-cv-app/commit/0d20362af0a5f8a126f67c77833868908484a863.patch",
    "fix_commit_details": {
      "sha": "0d20362af0a5f8a126f67c77833868908484a863",
      "commit_date": "2014-11-16T21:59:19Z",
      "author": {
        "login": "bertrand-caron",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "HOTFIX : Another vulnerability picked up by Brakeman",
        "length": 245,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 37,
        "additions": 31,
        "deletions": 6
      },
      "files": [
        {
          "filename": "app/controllers/uploaded_files_controller.rb",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -39,6 +39,11 @@ def create\n     @uploaded_file.name.gsub!(/ /, '-')\n \n     # Then write to file\n+    # WARNING : File.open is definitely vulnerable to Path Traversal Attacks\n+    # (https://www.owasp.org/index.php/Path_Traversal) \n+    # The following line should take care of it, by only taking the past part of the path (aka filename)\n+    @uploaded_file.name = @uploaded_file.name.split(/\\//)[-1]\n+\n     File.open(@uploaded_file.absolute_path, 'wb') do |file|\n       file.write(uploaded_io.read)\n     end"
        },
        {
          "filename": "spec/controllers/helpers_controller_spec.rb",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -9,11 +9,11 @@\n         expect(response).to redirect_to(root_url)\n       end\n     end\n-    context 'with session cookie' do\n-      it 'corrects incorrect HTML' do\n-        post 'html_renderer', content: '<div>Hello', format: :html\n-        expect(response.body).to eq('<div>Hello</div>')\n-      end\n-    end\n+#    context 'with session cookie' do\n+#      it 'corrects incorrect HTML' do\n+#        post 'html_renderer', content: '<div>Hello', format: :html\n+#        expect(response.body).to eq('<div>Hello</div>')\n+#      end\n+#    end\n   end\n end"
        },
        {
          "filename": "spec/controllers/uploaded_file_spec.rb",
          "status": "added",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -0,0 +1,9 @@\n+require 'spec_helper'\n+\n+describe UploadedFilesController, type: :controller do\n+  it 'has a valid factory' do\n+    expect( FactoryGirl.create(:uploaded_file)).to be_valid\n+  end\n+\n+  it 'does not accept relative paths in file name'\n+end"
        },
        {
          "filename": "spec/factories/uploaded_file.rb",
          "status": "added",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -0,0 +1,11 @@\n+require 'faker'\n+\n+FactoryGirl.define do\n+  factory :uploaded_file do |f|\n+    f.name 'hello.png'\n+  end\n+\n+  factory :dangerous_file, class: UploadedFile do |f|\n+    f.name '../Hello.png'\n+  end\n+end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dfe29f6762442e3158a7a75356f11480208a8d54",
            "date": "2015-12-22T05:17:55Z",
            "author_login": "bertrand-caron"
          },
          {
            "sha": "34219393d2b432c15cb2d776ad2493e1b3720cfd",
            "date": "2015-12-22T05:02:43Z",
            "author_login": "bertrand-caron"
          },
          {
            "sha": "c6f0e4c248b8404813c4756d4181131c99f371a2",
            "date": "2015-12-22T04:18:31Z",
            "author_login": "bertrand-caron"
          },
          {
            "sha": "235e36ae3c3ce967eacc380508c57b1a8ddb390c",
            "date": "2015-12-22T03:57:22Z",
            "author_login": "bertrand-caron"
          },
          {
            "sha": "1cfcfd538218797618eda50c27ff71a2dc9e626f",
            "date": "2015-12-22T03:44:37Z",
            "author_login": "bertrand-caron"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-24",
    "description": "A vulnerability was found in rails-cv-app. It has been rated as problematic. Affected by this issue is some unknown functionality of the file app/controllers/uploaded_files_controller.rb. The manipulation with the input ../../../etc/passwd leads to path traversal: '../filedir'. The exploit has been disclosed to the public and may be used. The patch is identified as 0d20362af0a5f8a126f67c77833868908484a863. It is recommended to apply a patch to fix this issue. VDB-217178 is the identifier assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-02T08:15:09.930",
    "last_modified": "2024-11-21T02:03:38.633",
    "fix_date": "2014-11-16T21:59:19Z"
  },
  "references": [
    {
      "url": "https://github.com/bertrand-caron/rails-cv-app/commit/0d20362af0a5f8a126f67c77833868908484a863",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217178",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217178",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bertrand-caron/rails-cv-app/commit/0d20362af0a5f8a126f67c77833868908484a863",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217178",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217178",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.243913",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rails-cv-app",
    "owner": "bertrand-caron",
    "created_at": "2014-11-17T09:53:30Z",
    "updated_at": "2015-05-11T21:37:41Z",
    "pushed_at": "2015-12-22T05:18:05Z",
    "size": 574,
    "stars": 2,
    "forks": 0,
    "open_issues": 0,
    "watchers": 2,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Ruby": 117248,
      "HTML": 63040,
      "CSS": 19999,
      "CoffeeScript": 2636,
      "JavaScript": 2006,
      "Shell": 1289
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T15:47:12.285530"
  }
}