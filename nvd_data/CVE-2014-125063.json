{
  "cve_id": "CVE-2014-125063",
  "github_data": {
    "repository": "ada-l0velace/Bid",
    "fix_commit": "abd71140b8219fa8741d0d8a57ab27d5bfd34222",
    "related_commits": [
      "abd71140b8219fa8741d0d8a57ab27d5bfd34222",
      "abd71140b8219fa8741d0d8a57ab27d5bfd34222"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "abd71140b8219fa8741d0d8a57ab27d5bfd34222",
      "commit_date": "2014-12-03T20:38:27Z",
      "author": {
        "login": "ada-l0velace",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "sql injection problems solved",
        "length": 29,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 64,
        "additions": 41,
        "deletions": 23
      },
      "files": [
        {
          "filename": "js/ajax_forms.js",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -42,12 +42,14 @@ $(document).ready(function(){\n \t\t\tdata: values,\n \t\t\tsuccess: function(data){\n \t\t\t\ttry {\n+\t\t\t\t\t//alert(data);\n \t\t\t\t\tvar error = $(data).filter(\"#erro\");\n \t\t\t\t\t//var error = $(data).find('#erro'); use this if div is nested\n-\t\t\t\t\talert(error.html());\n+\t\t\t\t\tif(error.html() != undefined)\n+\t\t\t\t\t\talert(error.html());\n \t\t\t\t}\n \t\t\t\tcatch(err) {\n-\t\t\t\t\t//console.log(\"Error not found\");\n+\t\t\t\t\tconsole.log(\"Error not found\");\n \t\t\t\t}\n \t\t\t\tpopulateDivTable(\"leilaoinscritos.php\",\"leiloesincritos\");\n \t\t\t\tpopulateDivTable(\"leilaotop.php\",\"leiloestop\");"
        },
        {
          "filename": "lance.php",
          "status": "modified",
          "additions": 21,
          "deletions": 11,
          "patch": "@@ -21,11 +21,18 @@ function test_input($data) {\n \t $lance = test_input($_POST[\"lance\"]);\n \t } \n \n-\t$ultimolance_query=\"SELECT MAX(lance.valor) AS max_valor \n+\t/*$ultimolance_query=\"SELECT MAX(lance.valor) AS max_valor \n \t                    FROM lance \n \t                    WHERE lance.leilao = $lid\";\n-\t$ultimolance = $connection->query($ultimolance_query);\n+\t$ultimolance = $connection->query($ultimolance_query);*/\n+\t$ultimolance = $connection->prepare(\"SELECT MAX(lance.valor) AS max_valor \n+\t                    FROM lance \n+\t                    WHERE lance.leilao = :lid\");\n+\t$ultimolance->bindParam(':lid', $lid);\n+\t$ultimolance->setFetchMode(PDO::FETCH_ASSOC);\n+\t$ultimolance->execute();\n \t$teste = false;\n+\t$ultimolance = $ultimolance->fetchAll();\n \tforeach($ultimolance as $row){\n \t\tif($row['max_valor'] == \"\"){\n \t\t\t$teste = true;\n@@ -35,16 +42,19 @@ function test_input($data) {\n \t\t}\n \n \t}\n-\t$ultimolance = $connection->query($ultimolance_query);\n-\n+\t\n+\t//$ultimolance = $connection->query($ultimolance_query);\n+\t\n \tif($teste == true){\n \t\t$valorbase_query=\"SELECT valorbase AS min_valor \n \t\t\t\t\t\t  FROM leilaor, leilao \n-\t\t\t\t\t\t  WHERE leilaor.lid = $lid \n+\t\t\t\t\t\t  WHERE leilaor.lid = :lid \n \t\t\t\t\t\t  AND leilaor.dia = leilao.dia \n \t\t\t\t\t\t  AND leilaor.nrleilaonodia = leilao.nrleilaonodia \n \t\t\t\t\t\t  AND leilaor.nif = leilao.nif\";\n-\t\t$valorbase = $connection->query($valorbase_query);\n+\t\t$valorbase = $connection->prepare($valorbase_query);\n+\t\t$valorbase->bindParam(':lid', $lid);\n+\t\t$valorbase->execute();\n \t\tforeach($valorbase as $row){\n \t\t\t$valor_min = $row[\"min_valor\"];\n \t\t}\n@@ -59,12 +69,12 @@ function test_input($data) {\n \tif($valor_max < $lance and $valor_min <= $lance){\n \t\t$lance_query=\"INSERT INTO lance(pessoa,leilao,valor) \n \t\t\t\t\t  VALUES ($nif,$lid,$lance)\";\n-\t\t$result = $connection->query($lance_query);\n-\t\t\n-\t\techo($lance_query);\n+\t\t$result = $connection->prepare($lance_query);\n+\t\t$error = $result->execute();\n+\t\t//echo($lance_query);\n \t\t\n-\t\tif (!$result) {\n-\t \t\techo(\"<div id='erro'> N\u00e3o houve lance:($sql) </div>\");\n+\t\tif (!$error) {\n+\t \t\techo(\"<div id='erro'> N\u00e3o houve lance:($error) </div>\");\n \t\t}\n \t}else{\n \t\techo(\"<div id='erro'> O valor do lance \u00e9 inv\u00e1lido </div>\");"
        },
        {
          "filename": "leilao.php",
          "status": "modified",
          "additions": 16,
          "deletions": 10,
          "patch": "@@ -24,9 +24,7 @@ function test_input($data) {\n \t\texit();\n \t}\n \n-\t//regista a pessoa no leil\u00e3o. Exemplificativo apenas.....\n-\t$inscreve_query = \"INSERT INTO concorrente (pessoa,leilao) \n-\t\t\t\t       VALUES ($nif,$lid)\";\n+\t\n \t$data_now = date(\"y-m-d\");\n \n \t/*\n@@ -37,18 +35,19 @@ function test_input($data) {\n \n \t/* PREPARED STATEMENTS */\n \t$sqlDataLeilao = \"SELECT * FROM leilaor \n-\t\t\t\t\t  WHERE lid =\" . $lid;\n-\t$resultado = $connection->query($sqlDataLeilao);\n-\n+\t\t\t\t\t  WHERE lid =:lid\";\n+\t$resultado = $connection->prepare($sqlDataLeilao);\n+\t$resultado->bindParam(':lid', $lid);\n+\t$error = $resultado->execute();\n \t/*\n \techo(\"<p>\");\n \techo($sqlDataLeilao);\n \techo(\"</p>\");\n \t*/\n \n \n-\tif (!$resultado) {\n-\t\techo(\"<p> Erro na Query:($sql) </p>\");\n+\tif (!$error) {\n+\t\techo(\"<div id='erro'> Erro na Query:($sql) </div>\");\n \t\texit();\n \t}\n \n@@ -71,10 +70,17 @@ function test_input($data) {\n \techo(\"</p>\");\n */\n \t$datediff = strtotime($new_dia) - strtotime($data_now);\n+\n+\t//regista a pessoa no leil\u00e3o. Exemplificativo apenas.....\n+\t$inscreve_query = \"INSERT INTO concorrente (pessoa,leilao) \n+\t\t\t\t       VALUES (:nif,:lid)\";\n \tif($data_now <= $new_dia){\n \t\tif($dia_abertura <= $data_now){\n-\t\t\t$inscreve = $connection->query($inscreve_query);\n-\t\t\tif (!$inscreve) {\n+\t\t\t$inscreve = $connection->prepare($inscreve_query);\n+\t\t\t$inscreve->bindParam(':nif', $nif);\n+\t\t\t$inscreve->bindParam(':lid', $lid);\n+\t\t\t$error = $inscreve->execute();\n+\t\t\tif (!$error) {\n \t\t\t \techo(\"<div id='erro'> Pessoa j\u00e1 se encontra registada neste leil\u00e3o! </div>\");\n \t\t\t\texit();\n \t\t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2c5ca39747609a45d65971286091431980cc6385",
            "date": "2015-10-27T05:34:58Z",
            "author_login": "ada-l0velace"
          },
          {
            "sha": "0ff3c5ae5c2b98ccd8c9520313d082aa8eac2083",
            "date": "2015-10-27T05:29:01Z",
            "author_login": "ada-l0velace"
          },
          {
            "sha": "341546380a30253cf701e1822a5f164e688ddb70",
            "date": "2014-12-12T04:03:06Z",
            "author_login": "ada-l0velace"
          },
          {
            "sha": "63cec12c3804b7b0bfb38766ed5471defa4ca583",
            "date": "2014-12-12T03:29:18Z",
            "author_login": "ada-l0velace"
          },
          {
            "sha": "56f75ecbcfbb564a55e2967af608878700ce4b3c",
            "date": "2014-12-09T17:48:09Z",
            "author_login": "ada-l0velace"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in ada-l0velace Bid and classified as critical. This issue affects some unknown processing. The manipulation leads to sql injection. The identifier of the patch is abd71140b8219fa8741d0d8a57ab27d5bfd34222. It is recommended to apply a patch to fix this issue. The identifier VDB-217625 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-07T19:15:09.167",
    "last_modified": "2024-11-21T02:03:42.867",
    "fix_date": "2014-12-03T20:38:27Z"
  },
  "references": [
    {
      "url": "https://github.com/ada-l0velace/Bid/commit/abd71140b8219fa8741d0d8a57ab27d5bfd34222",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217625",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217625",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ada-l0velace/Bid/commit/abd71140b8219fa8741d0d8a57ab27d5bfd34222",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217625",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217625",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.527035",
    "processing_status": "enhanced"
  }
}