{
  "cve_id": "CVE-2014-125068",
  "github_data": {
    "repository": "saxman/maps-js-icoads",
    "fix_commit": "34b8b0cce2807b119f4cffda2ac48fc8f427d69a",
    "related_commits": [
      "34b8b0cce2807b119f4cffda2ac48fc8f427d69a",
      "34b8b0cce2807b119f4cffda2ac48fc8f427d69a"
    ],
    "patch_url": "https://github.com/saxman/maps-js-icoads/commit/34b8b0cce2807b119f4cffda2ac48fc8f427d69a.patch",
    "fix_commit_details": {
      "sha": "34b8b0cce2807b119f4cffda2ac48fc8f427d69a",
      "commit_date": "2014-09-02T20:07:09Z",
      "author": {
        "login": "saxman",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Return index.html for directory req's and prevent directory traversal req's",
        "length": 75,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 23,
        "additions": 20,
        "deletions": 3
      },
      "files": [
        {
          "filename": "http-server.js",
          "status": "modified",
          "additions": 20,
          "deletions": 3,
          "patch": "@@ -1,5 +1,6 @@\n var http = require('http');\n var fs = require('fs');\n+var path = require('path');\n \n fs.exists = fs.exists || require('path').exists;\n \n@@ -17,7 +18,7 @@ var MIME_TYPE_JS = 'text/javascript';\n var MIME_TYPE_CSS = 'text/css';\n \n function log(code, string) {\n-  //console.log('[' + code + '] ' + string);\n+//  console.log('[' + code + '] ' + string);\n }\n \n var server = http.createServer(function(request, response) {\n@@ -28,17 +29,33 @@ var server = http.createServer(function(request, response) {\n     filePath = filePath.substr(0, filePath.indexOf('?'));\n   }\n \n-  filePath = '.' + filePath;\n+  // Get the absolute path for the request\n+  filePath = path.resolve('.' + filePath);\n+\n+  // Rejesct queries ouside of the server root\n+  var serverPath = path.resolve('.');\n+  if (filePath.indexOf(serverPath) != 0 ) {\n+    log(403, filePath);\n+    response.writeHeader(403);\n+    response.end();\n+\n+    return;\n+  }\n \n   fs.exists(filePath, function(exists) {\n     if (!exists) {\n-      log(404, filePath)\n+      log(404, filePath);\n       response.writeHead(404);\n       response.end();\n \n       return;\n     }\n \n+    // Return index.html if directroy requested.\n+    if (fs.statSync(filePath).isDirectory()) {\n+      filePath += '/index.html';\n+    }\n+\n     var mimeType = '';\n     var fileType = -1;\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "012187e8430c299147c25dcc9c38b92802f0cad0",
            "date": "2018-01-09T00:20:55Z",
            "author_login": "saxman"
          },
          {
            "sha": "8b06e7d5db03b362e5231012948f662d11617511",
            "date": "2014-09-25T18:12:14Z",
            "author_login": "saxman"
          },
          {
            "sha": "57a3c7ffb1e27bc530ac19e0266f717258480032",
            "date": "2014-09-25T18:09:55Z",
            "author_login": "saxman"
          },
          {
            "sha": "7f869d6bd302b0e2e0be4d092ecf01469b4b2f44",
            "date": "2014-09-25T18:05:06Z",
            "author_login": "saxman"
          },
          {
            "sha": "71ab86762767b9caf8f57920e076a01c2ebf68ea",
            "date": "2014-09-25T00:36:28Z",
            "author_login": "saxman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-22",
    "description": "A vulnerability was found in saxman maps-js-icoads and classified as critical. This issue affects some unknown processing of the file http-server.js. The manipulation leads to path traversal. The patch is named 34b8b0cce2807b119f4cffda2ac48fc8f427d69a. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217643.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-08T11:15:09.917",
    "last_modified": "2024-11-21T02:03:43.440",
    "fix_date": "2014-09-02T20:07:09Z"
  },
  "references": [
    {
      "url": "https://github.com/saxman/maps-js-icoads/commit/34b8b0cce2807b119f4cffda2ac48fc8f427d69a",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217643",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217643",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saxman/maps-js-icoads/commit/34b8b0cce2807b119f4cffda2ac48fc8f427d69a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217643",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217643",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.530659",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "maps-js-icoads",
    "owner": "saxman",
    "created_at": "2014-08-24T04:06:49Z",
    "updated_at": "2018-01-09T00:20:56Z",
    "pushed_at": "2018-01-09T00:20:56Z",
    "size": 2250,
    "stars": 3,
    "forks": 3,
    "open_issues": 0,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 29392,
      "HTML": 13363,
      "Python": 3214,
      "CSS": 1265,
      "GLSL": 914,
      "Shell": 56
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:19:06.528900"
  }
}