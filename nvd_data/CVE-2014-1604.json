{
  "cve_id": "CVE-2014-1604",
  "github_data": {
    "repository": "alex/rply",
    "fix_commit": "fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c",
    "related_commits": [
      "fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c",
      "fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c"
    ],
    "patch_url": "https://github.com/alex/rply/commit/fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c.patch",
    "fix_commit_details": {
      "sha": "fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c",
      "commit_date": "2014-01-17T23:16:39Z",
      "author": {
        "login": "alex",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "The parser cache is now always handled in a per-user fashion.",
        "length": 258,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 11,
        "deletions": 4
      },
      "files": [
        {
          "filename": "rply/parsergenerator.py",
          "status": "modified",
          "additions": 11,
          "deletions": 4,
          "patch": "@@ -2,6 +2,7 @@\n import hashlib\n import json\n import random\n+import stat\n import string\n import sys\n import tempfile\n@@ -124,17 +125,23 @@ def build(self):\n \n         cache_file = os.path.join(\n             tempfile.gettempdir(),\n-            \"rply-%s-%s-%s.json\" % (self.VERSION, self.cache_id, self.compute_grammar_hash(g))\n+            \"rply-%s-%s-%s-%s.json\" % (self.VERSION, os.getuid(), self.cache_id, self.compute_grammar_hash(g))\n         )\n         table = None\n         if os.path.exists(cache_file):\n             with open(cache_file) as f:\n                 data = json.load(f)\n-            if self.data_is_valid(g, data):\n-                table = LRTable.from_cache(g, data)\n+                stat_result = os.fstat(f.fileno())\n+            if (\n+                stat_result.st_uid == os.getuid() and\n+                stat.S_IMODE(stat_result.st_mode) == 0o0600\n+            ):\n+                if self.data_is_valid(g, data):\n+                    table = LRTable.from_cache(g, data)\n         if table is None:\n             table = LRTable.from_grammar(g)\n-            with open(cache_file, \"w\") as f:\n+            fd = os.open(cache_file, os.O_RDWR | os.O_CREAT | os.O_EXCL, 0o0600)\n+            with os.fdopen(fd, \"w\") as f:\n                 json.dump(self.serialize_table(table), f)\n         if table.sr_conflicts:\n             warnings.warn("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "19a9e08c486b2723a2e2378df6edb6a26e2df4a5",
            "date": "2020-09-23T03:29:47Z",
            "author_login": "nobodxbodon"
          },
          {
            "sha": "4950fe79dd417af703c18545e37a49364c35de7a",
            "date": "2020-09-16T04:02:02Z",
            "author_login": "nobodxbodon"
          },
          {
            "sha": "41d748393b96dffe3c4ef628ec11ea28275aa279",
            "date": "2020-08-05T00:30:21Z",
            "author_login": "plafer"
          },
          {
            "sha": "6e16262dc6d434fc467eed83ed31ca764ba01a34",
            "date": "2019-10-16T23:54:28Z",
            "author_login": "michal-pawlik"
          },
          {
            "sha": "f86955557b37c41567b20e2879cbbb33a87c21d0",
            "date": "2019-09-28T16:32:37Z",
            "author_login": "alex"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "The parser cache functionality in parsergenerator.py in RPLY (aka python-rply) before 0.7.1 allows local users to spoof cache data by pre-creating a temporary rply-*.json file with a predictable name.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-01-28T00:55:04.037",
    "last_modified": "2024-11-21T02:04:42.077",
    "fix_date": "2014-01-17T23:16:39Z"
  },
  "references": [
    {
      "url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=735263",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/56429",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/01/17/8",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/01/18/4",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/102202",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/90593",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/alex/rply/commit/fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=735263",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/56429",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/01/17/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/01/18/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/102202",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/90593",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/alex/rply/commit/fc9bbcd25b0b4f09bbd6339f710ad24c129d5d7c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.543652",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rply",
    "owner": "alex",
    "created_at": "2012-08-06T00:56:54Z",
    "updated_at": "2024-12-30T05:22:17Z",
    "pushed_at": "2023-01-21T19:10:13Z",
    "size": 196,
    "stars": 381,
    "forks": 60,
    "open_issues": 34,
    "watchers": 381,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 67976,
      "Shell": 253
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:55:37.407280"
  }
}