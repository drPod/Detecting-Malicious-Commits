{
  "cve_id": "CVE-2014-1609",
  "github_data": {
    "repository": "mantisbt/mantisbt",
    "fix_commit": "7efe0175f0853e18ebfacedfd2374c4179028b3f",
    "related_commits": [
      "7efe0175f0853e18ebfacedfd2374c4179028b3f",
      "7efe0175f0853e18ebfacedfd2374c4179028b3f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7efe0175f0853e18ebfacedfd2374c4179028b3f",
      "commit_date": "2014-01-17T21:24:29Z",
      "author": {
        "login": "mantis",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix CVE-2014-1609: SQL injection vulnerabilities",
        "length": 468,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 102,
        "additions": 56,
        "deletions": 46
      },
      "files": [
        {
          "filename": "admin/db_stats.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -30,11 +30,11 @@\n # --------------------\n function helper_table_row_count( $p_table ) {\n \t$t_table = $p_table;\n-\t$query = \"SELECT COUNT(*) FROM $t_table\";\n-\t$result = db_query_bound( $query );\n-\t$t_users = db_result( $result );\n+\t$t_query = \"SELECT COUNT(*) FROM $t_table\";\n+\t$t_result = db_query_bound( $t_query );\n+\t$t_count = db_result( $t_result );\n \n-\treturn $t_users;\n+\treturn $t_count;\n }\n \n # --------------------"
        },
        {
          "filename": "api/soap/mc_project_api.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -706,14 +706,14 @@ function mc_project_get_attachments( $p_username, $p_password, $p_project_id ) {\n \t\tFROM $t_project_file_table pft\n \t\tLEFT JOIN $t_project_table pt ON pft.project_id = pt.id\n \t\tLEFT JOIN $t_project_user_list_table pult\n-\t\tON pft.project_id = pult.project_id AND pult.user_id = $t_user_id\n-\t\tLEFT JOIN $t_user_table ut ON ut.id = $t_user_id\n+\t\tON pft.project_id = pult.project_id AND pult.user_id = \" . db_param() . \"\n+\t\tLEFT JOIN $t_user_table ut ON ut.id = \" . db_param() . \"\n \t\tWHERE pft.project_id in (\" . implode( ',', $t_projects ) . \") AND\n-\t\t( ( ( pt.view_state = $t_pub OR pt.view_state is null ) AND pult.user_id is null AND ut.access_level $t_access_clause ) OR\n-\t\t( ( pult.user_id = $t_user_id ) AND ( pult.access_level $t_access_clause ) ) OR\n-\t\t( ut.access_level = $t_admin ) )\n+\t\t( ( ( pt.view_state = \" . db_param() . \" OR pt.view_state is null ) AND pult.user_id is null AND ut.access_level $t_access_clause ) OR\n+\t\t( ( pult.user_id = \" . db_param() . \" ) AND ( pult.access_level $t_access_clause ) ) OR\n+\t\t( ut.access_level = \" . db_param() . \" ) )\n \t\tORDER BY pt.name ASC, pft.title ASC\";\n-\t$result = db_query( $query );\n+\t$result = db_query_bound( $query, array( $t_user_id, $t_user_id, $t_pub, $t_user_id, $t_admin ) );\n \t$num_files = db_num_rows( $result );\n \n \t$t_result = array();"
        },
        {
          "filename": "core/news_api.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -266,13 +266,15 @@ function news_get_limited_rows( $p_offset, $p_project_id = null ) {\n \n \t\t\tif( 1 == count( $t_projects ) ) {\n \t\t\t\t$c_project_id = $t_projects[0];\n-\t\t\t\t$query .= \" WHERE project_id='$c_project_id'\";\n+\t\t\t\t$query .= \" WHERE project_id=\" . db_params();\n+\t\t\t\t$t_params = array( $c_project_id );\n \t\t\t} else {\n \t\t\t\t$query .= ' WHERE project_id IN (' . join( $t_projects, ',' ) . ')';\n+\t\t\t\t$t_params = null;\n \t\t\t}\n \n \t\t\t$query .= ' ORDER BY announcement DESC, id DESC';\n-\t\t\t$result = db_query( $query, $t_news_view_limit, $c_offset );\n+\t\t\t$result = db_query_bound( $query, $t_params, $t_news_view_limit, $c_offset );\n \t\t\tbreak;\n \t\tcase 1:\n \n@@ -323,4 +325,4 @@ function news_ensure_enabled() {\n \tif ( !news_is_enabled() ) {\n \t\taccess_denied();\n \t}\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "core/summary_api.php",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -77,7 +77,7 @@ function summary_print_by_enum( $p_enum ) {\n \t\t\t\tWHERE $t_project_filter\n \t\t\t\tGROUP BY $p_enum $t_status_query\n \t\t\t\tORDER BY $p_enum $t_status_query\";\n-\t$result = db_query( $query );\n+\t$result = db_query_bound( $query );\n \n \t$t_last_value = -1;\n \t$t_bugs_open = 0;\n@@ -374,10 +374,10 @@ function summary_print_by_age() {\n \t\treturn;\n \t}\n \t$query = \"SELECT * FROM $t_mantis_bug_table\n-\t\t\t\tWHERE status < $t_resolved\n+\t\t\t\tWHERE status < \" . db_param() . \"\n \t\t\t\tAND $specific_where\n \t\t\t\tORDER BY date_submitted ASC, priority DESC\";\n-\t$result = db_query( $query );\n+\t$result = db_query_bound( $query, array( $t_resolved ) );\n \n \t$t_count = 0;\n \t$t_private_bug_threshold = config_get( 'private_bug_threshold' );\n@@ -423,7 +423,7 @@ function summary_print_by_developer() {\n \t\t\t\tWHERE handler_id>0 AND $specific_where\n \t\t\t\tGROUP BY handler_id, status\n \t\t\t\tORDER BY handler_id, status\";\n-\t$result = db_query( $query );\n+\t$result = db_query_bound( $query );\n \n \t$t_last_handler = -1;\n \t$t_bugs_open = 0;\n@@ -524,7 +524,7 @@ function summary_print_by_reporter() {\n \t\t\t\tWHERE $specific_where\n \t\t\t\tGROUP BY reporter_id\n \t\t\t\tORDER BY num DESC\";\n-\t$result = db_query( $query, $t_reporter_summary_limit );\n+\t$result = db_query_bound( $query, null, $t_reporter_summary_limit );\n \n \t$t_reporters = array();\n \twhile( $row = db_fetch_array( $result ) ) {\n@@ -536,11 +536,11 @@ function summary_print_by_reporter() {\n \tforeach( $t_reporters as $t_reporter ) {\n \t\t$v_reporter_id = $t_reporter;\n \t\t$query = \"SELECT COUNT(id) as bugcount, status FROM $t_mantis_bug_table\n-\t\t\t\t\tWHERE reporter_id=$v_reporter_id\n+\t\t\t\t\tWHERE reporter_id=\" . db_param() . \"\n \t\t\t\t\tAND $specific_where\n \t\t\t\t\tGROUP BY status\n \t\t\t\t\tORDER BY status\";\n-\t\t$result2 = db_query( $query );\n+\t\t$result2 = db_query_bound( $query, array( $v_reporter_id ) );\n \n \t\t$last_reporter = -1;\n \t\t$t_bugs_open = 0;\n@@ -608,7 +608,7 @@ function summary_print_by_category() {\n \t\t\t\tGROUP BY $t_project_query c.name, b.category_id, b.status\n \t\t\t\tORDER BY $t_project_query c.name\";\n \n-\t$result = db_query( $query );\n+\t$result = db_query_bound( $query );\n \n \t$last_category_name = -1;\n \t$last_category_id = -1;"
        },
        {
          "filename": "plugins/MantisGraph/core/graph_api.php",
          "status": "modified",
          "additions": 23,
          "deletions": 15,
          "patch": "@@ -583,11 +583,15 @@ function create_bug_enum_summary( $p_enum_string, $p_enum ) {\n \t$t_metrics = array();\n \t$t_assoc_array = MantisEnum::getAssocArrayIndexedByValues( $p_enum_string );\n \n+\tif( !db_field_exists( $p_enum, $t_bug_table ) ) {\n+\t\ttrigger_error( ERROR_DB_FIELD_NOT_FOUND, ERROR );\n+\t}\n+\n \tforeach ( $t_assoc_array as $t_value => $t_label  ) {\n \t\t$query = \"SELECT COUNT(*)\n \t\t\t\t\tFROM $t_bug_table\n-\t\t\t\t\tWHERE $p_enum='$t_value' $specific_where\";\n-\t\t$result = db_query( $query );\n+\t\t\t\t\tWHERE $p_enum=\" . db_param() . \" $specific_where\";\n+\t\t$result = db_query_bound( $query, array( $t_value ) );\n \t\t$t_metrics[$t_label] = db_result( $result, 0 );\n \t}\n \n@@ -605,32 +609,36 @@ function enum_bug_group( $p_enum_string, $p_enum ) {\n \t$t_clo_val = config_get( 'bug_closed_status_threshold' );\n \t$specific_where = \" AND \" . helper_project_specific_where( $t_project_id, $t_user_id );\n \n+\tif( !db_field_exists( $p_enum, $t_bug_table ) ) {\n+\t\ttrigger_error( ERROR_DB_FIELD_NOT_FOUND, ERROR );\n+\t}\n+\n \t$t_array_indexed_by_enum_values = MantisEnum::getAssocArrayIndexedByValues( $p_enum_string );\n \t$enum_count = count( $t_array_indexed_by_enum_values );\n \tforeach ( $t_array_indexed_by_enum_values as $t_value => $t_label ) {\n \t\t# Calculates the number of bugs opened and puts the results in a table\n \t\t$query = \"SELECT COUNT(*)\n \t\t\t\t\tFROM $t_bug_table\n-\t\t\t\t\tWHERE $p_enum='$t_value' AND\n-\t\t\t\t\t\tstatus<'$t_res_val' $specific_where\";\n-\t\t$result2 = db_query( $query );\n+\t\t\t\t\tWHERE $p_enum=\" . db_param() . \" AND\n+\t\t\t\t\t\tstatus<\" . db_param() . \" $specific_where\";\n+\t\t$result2 = db_query( $query, array( $t_value, $t_res_val ) );\n \t\t$t_metrics['open'][$t_label] = db_result( $result2, 0, 0 );\n \n \t\t# Calculates the number of bugs closed and puts the results in a table\n \t\t$query = \"SELECT COUNT(*)\n \t\t\t\t\tFROM $t_bug_table\n-\t\t\t\t\tWHERE $p_enum='$t_value' AND\n-\t\t\t\t\t\tstatus>='$t_clo_val' $specific_where\";\n-\t\t$result2 = db_query( $query );\n+\t\t\t\t\tWHERE $p_enum=\" . db_param() . \" AND\n+\t\t\t\t\t\tstatus>=\" . db_param() . \" $specific_where\";\n+\t\t$result2 = db_query_bound( $query, array( $t_value, $t_clo_val ) );\n \t\t$t_metrics['closed'][$t_label] = db_result( $result2, 0, 0 );\n \n \t\t# Calculates the number of bugs resolved and puts the results in a table\n \t\t$query = \"SELECT COUNT(*)\n \t\t\t\t\tFROM $t_bug_table\n-\t\t\t\t\tWHERE $p_enum='$t_value' AND\n-\t\t\t\t\t\tstatus>='$t_res_val'  AND\n-\t\t\t\t\t\tstatus<'$t_clo_val' $specific_where\";\n-\t\t$result2 = db_query( $query );\n+\t\t\t\t\tWHERE $p_enum=\" . db_param() . \" AND\n+\t\t\t\t\t\tstatus>=\" . db_param() . \" AND\n+\t\t\t\t\t\tstatus<\" . db_param() . \" $specific_where\";\n+\t\t$result2 = db_query_bound( $query, array(  $t_value, $t_res_val, $t_clo_val ) );\n \t\t$t_metrics['resolved'][$t_label] = db_result( $result2, 0, 0 );\n \t}\n \n@@ -818,12 +826,12 @@ function create_cumulative_bydate() {\n \t\t\tFROM $t_bug_table LEFT JOIN $t_history_table\n \t\t\tON $t_bug_table.id = $t_history_table.bug_id\n \t\t\tWHERE $specific_where\n-\t\t\t\t\t\tAND $t_bug_table.status >= '$t_res_val'\n-\t\t\t\t\t\tAND ( ( $t_history_table.new_value >= '$t_res_val'\n+\t\t\t\t\t\tAND $t_bug_table.status >= \" . db_param() . \"\n+\t\t\t\t\t\tAND ( ( $t_history_table.new_value >= \" . db_param() . \"\n \t\t\t\t\t\t\t\tAND $t_history_table.field_name = 'status' )\n \t\t\t\t\t\tOR $t_history_table.id is NULL )\n \t\t\tORDER BY $t_bug_table.id, date_modified ASC\";\n-\t$result = db_query( $query );\n+\t$result = db_query( $query, array( $t_res_val, $t_res_val ) );\n \t$bug_count = db_num_rows( $result );\n \n \t$t_last_id = 0;"
        },
        {
          "filename": "plugins/MantisGraph/pages/bug_graph_bycategory.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -105,9 +105,9 @@\n         ' WHERE bug_id in ('.implode(',', $t_bug).') and '.\n             '( (type='.NORMAL_TYPE.' and field_name=\\'category\\') or '.\n                 '(type='.NORMAL_TYPE.' and field_name=\\'status\\') or type='.NEW_BUG.' ) and '.\n-                'date_modified >= \\''. $t_start .'\\''.\n+\t\t'date_modified >= ' . db_param() .\n             ' order by date_modified DESC';\n-    $t_result = db_query( $t_select );\n+\t$t_result = db_query_bound( $t_select, array( $t_start ) );\n \t$row = db_fetch_array( $t_result );\n \n \tfor ($t_now = time() - $t_incr; $t_now >= $t_start; $t_now -= $t_incr) {"
        },
        {
          "filename": "plugins/MantisGraph/pages/bug_graph_bystatus.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -101,9 +101,9 @@\n     $t_select = 'SELECT bug_id, type, old_value, new_value, date_modified FROM '.$t_bug_hist_table.\n         ' WHERE bug_id in ('.implode(',', $t_bug).\n         ') and ( (type='.NORMAL_TYPE.' and field_name=\\'status\\')\n-            or type='.NEW_BUG.' ) and date_modified >= \\''. $t_start .'\\''.\n+\tor type='.NEW_BUG.' ) and date_modified >= ' . db_param() .\n         ' order by date_modified DESC';\n-    $t_result = db_query( $t_select );\n+\t$t_result = db_query_bound( $t_select, array( $t_start ) );\n \t$t_row = db_fetch_array( $t_result );\n \n \tfor ($t_now = time() - $t_incr; $t_now >= $t_start; $t_now -= $t_incr) {"
        },
        {
          "filename": "proj_doc_page.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -71,14 +71,14 @@\n \t\t\t\tFROM $t_project_file_table pft\n \t\t\t\t\tLEFT JOIN $t_project_table pt ON pft.project_id = pt.id\n \t\t\t\t\tLEFT JOIN $t_project_user_list_table pult\n-\t\t\t\t\t\tON pft.project_id = pult.project_id AND pult.user_id = $t_user_id\n-\t\t\t\t\tLEFT JOIN $t_user_table ut ON ut.id = $t_user_id\n+\t\t\t\t\t\tON pft.project_id = pult.project_id AND pult.user_id = \" . db_param() . \"\n+\t\t\t\t\tLEFT JOIN $t_user_table ut ON ut.id = \" . db_param() . \"\n \t\t\t\tWHERE pft.project_id in (\" . implode( ',', $t_projects ) . \") AND\n-\t\t\t\t\t( ( ( pt.view_state = $t_pub OR pt.view_state is null ) AND pult.user_id is null AND ut.access_level $t_access_clause ) OR\n-\t\t\t\t\t\t( ( pult.user_id = $t_user_id ) AND ( pult.access_level $t_access_clause ) ) OR\n-\t\t\t\t\t\t( ut.access_level >= $t_admin ) )\n+\t\t\t\t\t( ( ( pt.view_state = \" . db_param() . \" OR pt.view_state is null ) AND pult.user_id is null AND ut.access_level $t_access_clause ) OR\n+\t\t\t\t\t\t( ( pult.user_id = \" . db_param() . \" ) AND ( pult.access_level $t_access_clause ) ) OR\n+\t\t\t\t\t\t( ut.access_level >= \" . db_param() . \" ) )\n \t\t\t\tORDER BY pt.name ASC, pft.title ASC\";\n-\t$result = db_query( $query );\n+\t$result = db_query_bound( $query, array( $t_user_id, $t_user_id, $t_pub, $t_user_id, $t_admin ) );\n \t$num_files = db_num_rows( $result );\n \n \thtml_page_top( lang_get( 'docs_link' ) );"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "924fb05df417dc639fd50a518dba20531a322851",
            "date": "2025-01-23T12:46:58Z",
            "author_login": "dregad"
          },
          {
            "sha": "60cb1d4e48e3e4578a1b8f662e22ba59dea9cb21",
            "date": "2025-01-23T12:41:32Z",
            "author_login": "raspopov"
          },
          {
            "sha": "7626b72778eaa1d3767b21f613219b0d1c46d9ca",
            "date": "2025-01-23T12:29:11Z",
            "author_login": "dregad"
          },
          {
            "sha": "4994c09658dd16045cc2ff62f184842029fb43fc",
            "date": "2025-01-23T12:07:11Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "64a6c746c971d6f7ecc3063f5bafe9cb357cca93",
            "date": "2025-01-20T12:07:27Z",
            "author_login": "translatewiki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-89",
    "description": "Multiple SQL injection vulnerabilities in MantisBT before 1.2.16 allow remote attackers to execute arbitrary SQL commands via unspecified parameters to the (1) mc_project_get_attachments function in api/soap/mc_project_api.php; the (2) news_get_limited_rows function in core/news_api.php; the (3) summary_print_by_enum, (4) summary_print_by_age, (5) summary_print_by_developer, (6) summary_print_by_reporter, or (7) summary_print_by_category function in core/summary_api.php; the (8) create_bug_enum_summary or (9) enum_bug_group function in plugins/MantisGraph/core/graph_api.php; (10) bug_graph_bycategory.php or (11) bug_graph_bystatus.php in plugins/MantisGraph/pages/; or (12) proj_doc_page.php, related to use of the db_query function, a different vulnerability than CVE-2014-1608.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-03-20T16:55:12.323",
    "last_modified": "2024-11-21T02:04:42.567",
    "fix_date": "2014-01-17T21:24:29Z"
  },
  "references": [
    {
      "url": "http://secunia.com/advisories/61432",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2014/dsa-3030",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.mantisbt.org/bugs/view.php?id=16880",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.ocert.org/advisories/ocert-2014-001.html",
      "source": "cve@mitre.org",
      "tags": [
        "US Government Resource"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/65461",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1063111",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/7efe0175f0853e18ebfacedfd2374c4179028b3f",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://secunia.com/advisories/61432",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2014/dsa-3030",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.mantisbt.org/bugs/view.php?id=16880",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.ocert.org/advisories/ocert-2014-001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "US Government Resource"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/65461",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1063111",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/7efe0175f0853e18ebfacedfd2374c4179028b3f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.574039",
    "processing_status": "enhanced"
  }
}