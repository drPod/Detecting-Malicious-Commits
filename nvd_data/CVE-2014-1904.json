{
  "cve_id": "CVE-2014-1904",
  "github_data": {
    "repository": "spring-projects/spring-framework",
    "fix_commit": "741b4b229ae032bd17175b46f98673ce0bd2d485",
    "related_commits": [
      "741b4b229ae032bd17175b46f98673ce0bd2d485",
      "741b4b229ae032bd17175b46f98673ce0bd2d485"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "741b4b229ae032bd17175b46f98673ce0bd2d485",
      "commit_date": "2014-02-13T19:36:12Z",
      "author": {
        "login": "rstoyanchev",
        "type": "User",
        "stats": {
          "total_commits": 4795,
          "average_weekly_commits": 5.543352601156069,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 621
        }
      },
      "commit_message": {
        "title": "Add encoding for the default action in FormTag",
        "length": 64,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 26,
        "deletions": 2
      },
      "files": [
        {
          "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/tags/form/FormTag.java",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2002-2013 the original author or authors.\n+ * Copyright 2002-2014 the original author or authors.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -16,6 +16,7 @@\n \n package org.springframework.web.servlet.tags.form;\n \n+import java.io.UnsupportedEncodingException;\n import java.util.Map;\n \n import javax.servlet.ServletRequest;\n@@ -32,6 +33,7 @@\n import org.springframework.util.StringUtils;\n import org.springframework.web.servlet.support.RequestDataValueProcessor;\n import org.springframework.web.util.HtmlUtils;\n+import org.springframework.web.util.UriUtils;\n \n /**\n  * Databinding-aware JSP tag for rendering an HTML '{@code form}' whose\n@@ -442,6 +444,13 @@ else if (StringUtils.hasText(servletRelativeAction)) {\n \t\t}\n \t\telse {\n \t\t\tString requestUri = getRequestContext().getRequestUri();\n+\t\t\tString encoding = pageContext.getResponse().getCharacterEncoding();\n+\t\t\ttry {\n+\t\t\t\trequestUri = UriUtils.encodePath(requestUri, encoding);\n+\t\t\t}\n+\t\t\tcatch (UnsupportedEncodingException e) {\n+\t\t\t\tthrow new JspException(e);\n+\t\t\t}\n \t\t\tServletResponse response = this.pageContext.getResponse();\n \t\t\tif (response instanceof HttpServletResponse) {\n \t\t\t\trequestUri = ((HttpServletResponse) response).encodeURL(requestUri);"
        },
        {
          "filename": "spring-webmvc/src/test/java/org/springframework/web/servlet/tags/form/FormTagTests.java",
          "status": "modified",
          "additions": 16,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2002-2013 the original author or authors.\n+ * Copyright 2002-2014 the original author or authors.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -340,6 +340,21 @@ public void testRequestDataValueProcessorHooks() throws Exception {\n \t\tassertFormTagClosed(output);\n \t}\n \n+\tpublic void testDefaultActionEncoded() throws Exception {\n+\n+\t\tthis.request.setRequestURI(\"/a b c\");\n+\t\trequest.setQueryString(\"\");\n+\n+\t\tthis.tag.doStartTag();\n+\t\tthis.tag.doEndTag();\n+\t\tthis.tag.doFinally();\n+\n+\t\tString output = getOutput();\n+\t\tString formOutput = getFormTag(output);\n+\n+\t\tassertContainsAttribute(formOutput, \"action\", \"/a%20b%20c\");\n+\t}\n+\n \tprivate String getFormTag(String output) {\n \t\tint inputStart = output.indexOf(\"<\", 1);\n \t\tint inputEnd = output.lastIndexOf(\">\", output.length() - 2);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "86b04b7b699d2f189fc545cbf2495309b6da9408",
            "date": "2025-01-24T14:34:10Z",
            "author_login": "sbrannen"
          },
          {
            "sha": "683733a6827276437bc4c9bbc593592f732b2e95",
            "date": "2025-01-24T14:31:03Z",
            "author_login": "sbrannen"
          },
          {
            "sha": "673e2b0dd201eb66a92d8e1d4724f3497922b23b",
            "date": "2025-01-23T13:16:36Z",
            "author_login": "sdeleuze"
          },
          {
            "sha": "35fede1382f19e997e761ea18bdc99394bdae745",
            "date": "2025-01-23T10:16:00Z",
            "author_login": "sbrannen"
          },
          {
            "sha": "564eb77a524cf72b0ff21bdae24c4bcc0cf98810",
            "date": "2025-01-23T10:00:51Z",
            "author_login": "sbrannen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in web/servlet/tags/form/FormTag.java in Spring MVC in Spring Framework 3.0.0 before 3.2.8 and 4.0.0 before 4.0.2 allows remote attackers to inject arbitrary web script or HTML via the requested URI in a default action.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-03-20T16:55:12.683",
    "last_modified": "2024-11-21T02:05:14.907",
    "fix_date": "2014-02-13T19:36:12Z"
  },
  "references": [
    {
      "url": "http://docs.spring.io/spring/docs/3.2.8.RELEASE/changelog.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-0400.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Mar/101",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/57915",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "http://www.gopivotal.com/security/cve-2014-1904",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/531422/100/0/threaded",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/66137",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/spring-projects/spring-framework/commit/741b4b229ae032bd17175b46f98673ce0bd2d485",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.springsource.org/browse/SPR-11426",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "http://docs.spring.io/spring/docs/3.2.8.RELEASE/changelog.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-0400.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Mar/101",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/57915",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "http://www.gopivotal.com/security/cve-2014-1904",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/531422/100/0/threaded",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/66137",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/spring-projects/spring-framework/commit/741b4b229ae032bd17175b46f98673ce0bd2d485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.springsource.org/browse/SPR-11426",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.574337",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "spring-framework",
    "owner": "spring-projects",
    "created_at": "2010-12-08T04:04:45Z",
    "updated_at": "2025-01-26T07:58:23Z",
    "pushed_at": "2025-01-24T14:34:30Z",
    "size": 220857,
    "stars": 57202,
    "forks": 38313,
    "open_issues": 308,
    "watchers": 57202,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "3.0.x",
      "3.1.x",
      "3.2.x",
      "4.0.x",
      "4.1.x",
      "4.2.x",
      "4.3.x",
      "5.0.x",
      "5.1.x",
      "5.2.x",
      "5.3.x",
      "6.0.x",
      "main"
    ],
    "languages": {
      "Java": 48150931,
      "Kotlin": 986814,
      "AspectJ": 31750,
      "FreeMarker": 29946,
      "Groovy": 6902,
      "XSLT": 2945,
      "HTML": 1168,
      "Ruby": 1060,
      "CSS": 1019,
      "Shell": 961,
      "Smarty": 717,
      "PLpgSQL": 305,
      "JavaScript": 280,
      "Python": 254
    },
    "commit_activity": {
      "total_commits_last_year": 2861,
      "avg_commits_per_week": 55.01923076923077,
      "days_active_last_year": 322
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:16:41.874813"
  }
}