{
  "cve_id": "CVE-2014-2080",
  "github_data": {
    "repository": "modxcms/revolution",
    "fix_commit": "77463eb6a8090f474b04fdc1b72225cb93c558ea",
    "related_commits": [
      "77463eb6a8090f474b04fdc1b72225cb93c558ea",
      "77463eb6a8090f474b04fdc1b72225cb93c558ea"
    ],
    "patch_url": "https://github.com/modxcms/revolution/commit/77463eb6a8090f474b04fdc1b72225cb93c558ea.patch",
    "fix_commit_details": {
      "sha": "77463eb6a8090f474b04fdc1b72225cb93c558ea",
      "commit_date": "2013-11-23T16:02:19Z",
      "author": {
        "login": "opengeek",
        "type": "User",
        "stats": {
          "total_commits": 2939,
          "average_weekly_commits": 3.116648992576882,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 414
        }
      },
      "commit_message": {
        "title": "Prevent XSS on actionVar in header.tpl",
        "length": 163,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
      },
      "files": [
        {
          "filename": "core/docs/changelog.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -2,6 +2,7 @@\n This file shows the changes in recent releases of MODX. The most current release is usually the\n development release, and is only shown to give an idea of what's currently in the pipeline.\n \n+- Prevent XSS on actionVar in header.tpl\n - Fix caching of manager menus\n \n MODX Revolution 2.2.10-pl (October 7, 2013)"
        },
        {
          "filename": "core/model/modx/modmanagerrequest.class.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -53,6 +53,8 @@ function __construct(modX & $modx) {\n      * @return boolean True if successful.\n      */\n     public function initialize() {\n+        $this->sanitizeRequest();\n+        \n         if (!defined('MODX_INCLUDES_PATH')) {\n             define('MODX_INCLUDES_PATH',$this->modx->getOption('manager_path').'includes/');\n         }\n@@ -117,7 +119,7 @@ public function handleRequest() {\n         $this->modx->invokeEvent('OnHandleRequest');\n \n         /* save page to manager object. allow custom actionVar choice for extending classes. */\n-        $this->action = isset($_REQUEST[$this->actionVar]) ? $_REQUEST[$this->actionVar] : $this->defaultAction;\n+        $this->action = isset($_REQUEST[$this->actionVar]) ? (integer)$_REQUEST[$this->actionVar] : $this->defaultAction;\n \n         /* invoke OnManagerPageInit event */\n         $this->modx->invokeEvent('OnManagerPageInit',array('action' => $this->action));"
        },
        {
          "filename": "manager/templates/default/header.tpl",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -24,8 +24,8 @@\n <script src=\"{$_config.manager_url}assets/ext3/ext-all.js\" type=\"text/javascript\"></script>\n {/if}\n <script src=\"{$_config.manager_url}assets/modext/core/modx.js\" type=\"text/javascript\"></script>\n-<script src=\"{$_config.connectors_url}lang.js.php?ctx=mgr&topic=topmenu,file,resource,{$_lang_topics}&action={$smarty.get.a|strip_tags}\" type=\"text/javascript\"></script>\n-<script src=\"{$_config.connectors_url}layout/modx.config.js.php?action={$smarty.get.a|strip_tags}{if $_ctx}&wctx={$_ctx}{/if}\" type=\"text/javascript\"></script>\n+<script src=\"{$_config.connectors_url}lang.js.php?ctx=mgr&topic=topmenu,file,resource,{$_lang_topics}&action={$smarty.get.a|htmlspecialchars}\" type=\"text/javascript\"></script>\n+<script src=\"{$_config.connectors_url}layout/modx.config.js.php?action={$smarty.get.a|htmlspecialchars}{if $_ctx}&wctx={$_ctx}{/if}\" type=\"text/javascript\"></script>\n \n {if $_config.compress_js && $_config.compress_js_groups}\n <script src=\"{$_config.manager_url}min/index.php?g=coreJs1\" type=\"text/javascript\"></script>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ae3560e1278a3fca54a8c968d8580ad6589a05ee",
            "date": "2025-01-06T15:33:14Z",
            "author_login": "opengeek"
          },
          {
            "sha": "62b154af9c6df94e98d80b4e178e64e508e6b966",
            "date": "2024-12-18T15:16:11Z",
            "author_login": "opengeek"
          },
          {
            "sha": "543b04a64d058db1e3f35230737ed8fe0a812ab8",
            "date": "2024-12-18T14:59:09Z",
            "author_login": "modxbot"
          },
          {
            "sha": "3ef3cd1a4be31f5127849635437a9cfe02f64be3",
            "date": "2024-12-09T19:50:06Z",
            "author_login": "modxbot"
          },
          {
            "sha": "14d3b9619e710d35f6033c298a6a1c7ffa3e73b0",
            "date": "2024-12-04T20:38:10Z",
            "author_login": "modxbot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in manager/templates/default/header.tpl in ModX Revolution before 2.2.11 allows remote attackers to inject arbitrary web script or HTML via the \"a\" parameter.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-03-01T00:01:09.590",
    "last_modified": "2024-11-21T02:05:36.240",
    "fix_date": "2013-11-23T16:02:19Z"
  },
  "references": [
    {
      "url": "http://modx.com/blog/2014/01/21/revolution-2.2.11%E2%80%94security-fixes-and-prevent-change-loss",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/431",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/57038",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/65755",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/modxcms/revolution/commit/77463eb6a8090f474b04fdc1b72225cb93c558ea",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://modx.com/blog/2014/01/21/revolution-2.2.11%E2%80%94security-fixes-and-prevent-change-loss",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/431",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/57038",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/65755",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/modxcms/revolution/commit/77463eb6a8090f474b04fdc1b72225cb93c558ea",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.567104",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "revolution",
    "owner": "modxcms",
    "created_at": "2010-07-29T21:03:57Z",
    "updated_at": "2025-01-06T15:33:38Z",
    "pushed_at": "2025-01-06T15:33:33Z",
    "size": 104111,
    "stars": 1364,
    "forks": 528,
    "open_issues": 619,
    "watchers": 1364,
    "has_security_policy": false,
    "default_branch": "3.x",
    "protected_branches": [
      "2.x",
      "3.x",
      "3.0.x"
    ],
    "languages": {
      "PHP": 17768097,
      "JavaScript": 3678476,
      "CSS": 1145293,
      "SCSS": 257246,
      "Smarty": 169521,
      "Shell": 2233,
      "HTML": 139
    },
    "commit_activity": {
      "total_commits_last_year": 120,
      "avg_commits_per_week": 2.3076923076923075,
      "days_active_last_year": 46
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:34:34.205293"
  }
}