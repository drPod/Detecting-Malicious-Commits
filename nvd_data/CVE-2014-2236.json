{
  "cve_id": "CVE-2014-2236",
  "github_data": {
    "repository": "ASKBOT/askbot-devel",
    "fix_commit": "876e3662ff6b78cc6241338c15e3a0cb49edf4e2",
    "related_commits": [
      "876e3662ff6b78cc6241338c15e3a0cb49edf4e2",
      "a676a86b6b7a5737d4da4f59f71e037406f88d29",
      "876e3662ff6b78cc6241338c15e3a0cb49edf4e2",
      "a676a86b6b7a5737d4da4f59f71e037406f88d29"
    ],
    "patch_url": "https://github.com/ASKBOT/askbot-devel/commit/876e3662ff6b78cc6241338c15e3a0cb49edf4e2.patch",
    "fix_commit_details": {
      "sha": "876e3662ff6b78cc6241338c15e3a0cb49edf4e2",
      "commit_date": "2013-03-31T07:27:43Z",
      "author": {
        "login": "evgenyfadeev",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "added instant search to the tags page",
        "length": 37,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 250,
        "additions": 202,
        "deletions": 48
      },
      "files": [
        {
          "filename": "askbot/doc/source/changelog.rst",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -3,6 +3,7 @@ Changes in Askbot\n \n Development version\n -------------------\n+* Added instant search to the tags page\n * Added a placeholder template for the custom javascript on the question page\n * Allowed to disable the big \"ask\" button.\n * Some support for the media compression (Tyler Mandry)"
        },
        {
          "filename": "askbot/media/js/live_search.js",
          "status": "modified",
          "additions": 142,
          "deletions": 1,
          "patch": "@@ -267,6 +267,7 @@ TagWarningBox.prototype.showWarning = function(){\n  */\n var InputToolTip = function() {\n     WrappedElement.call(this);\n+    this._promptText = gettext('search or ask your question');\n };\n inherits(InputToolTip, WrappedElement);\n \n@@ -284,6 +285,10 @@ InputToolTip.prototype.dim = function() {\n     this._element.addClass('dimmed');\n };\n \n+InputToolTip.prototype.setPromptText = function(text) {\n+    this._promptText = text;\n+};\n+\n InputToolTip.prototype.setClickHandler = function(handler) {\n     this._clickHandler = handler;\n };\n@@ -292,7 +297,7 @@ InputToolTip.prototype.createDom = function() {\n     var element = this.makeElement('div');\n     this._element = element;\n     element.addClass('input-tool-tip');\n-    element.html(gettext('search or ask your question'));\n+    element.html(this._promptText);\n     this.decorate(element);\n };\n \n@@ -882,3 +887,139 @@ FullTextSearch.prototype.decorate = function(element) {\n \n     $(\"form#searchForm\").submit(me.makeFormSubmitHandler());\n };\n+\n+/**\n+ * @constructor\n+ */\n+var TagSearch = function() {\n+    WrappedElement.call(this);\n+    this._isRunning = false;\n+};\n+inherits(TagSearch, WrappedElement);\n+\n+TagSearch.prototype.getQuery = function() {\n+    return $.trim(this._element.val());\n+};\n+\n+TagSearch.prototype.setQuery = function(val) {\n+    this._element.val(val);\n+};\n+\n+TagSearch.prototype.getSort = function() {\n+    //todo: read it off the page\n+    var link = $('.tabBar a.on');\n+    if (link.length === 1) {\n+        var sort = link.attr('id').replace('sort_', '');\n+        if (sort === 'name' || sort === 'used') {\n+            return sort;\n+        }\n+    }\n+    return 'name';\n+};\n+\n+TagSearch.prototype.getIsRunning = function() {\n+    return this._isRunning;\n+};\n+\n+TagSearch.prototype.setIsRunning = function(val) {\n+    this._isRunning = val;\n+};\n+\n+TagSearch.prototype.renderResult = function(html) {\n+    this._contentBox.html(html);\n+};\n+\n+TagSearch.prototype.runSearch = function() {\n+    var data = {\n+        'query': this.getQuery(),\n+        'sort': this.getSort(),\n+        'page': '1'\n+    };\n+    var me = this;\n+    $.ajax({\n+        dataType: 'json',\n+        data: data,\n+        cache: false,\n+        url: askbot['urls']['tags'],\n+        success: function(data) {\n+            if (data['success']) {\n+                me.renderResult(data['html']);\n+                me.setIsRunning(false);\n+            }\n+        },\n+        error: function() { me.setIsRunning(false); }\n+    });\n+    me.setIsRunning(true);\n+};\n+\n+TagSearch.prototype.getToolTip = function() {\n+    return this._toolTip;\n+};\n+\n+TagSearch.prototype.makeKeyUpHandler = function() {\n+    var me = this;\n+    return function(evt) {\n+        var keyCode = getKeyCode(evt);\n+        if (me.getIsRunning() === false) {\n+            me.runSearch();\n+        }\n+    };\n+};\n+\n+TagSearch.prototype.makeKeyDownHandler = function() {\n+    var me = this;\n+    var xButton = this._xButton;\n+    return function(evt) {\n+        var query = me.getQuery();\n+        var keyCode = getKeyCode(evt);\n+        var toolTip = me.getToolTip();\n+        if (keyCode === 27) {//escape\n+            me.setQuery('');\n+            toolTip.show();\n+            xButton.hide();\n+            return;\n+        }\n+        if (keyCode === 8 || keyCode === 48) {//del or backspace\n+            if (query.length === 1) {\n+                toolTip.show();\n+                xButton.hide();\n+            }\n+        } else {\n+            toolTip.hide();\n+            xButton.show();\n+        }\n+    };\n+};\n+\n+TagSearch.prototype.reset = function() {\n+    if (this.getIsRunning() === false) {\n+        this.setQuery('');\n+        this._toolTip.show();\n+        this._xButton.hide();\n+        this.runSearch();\n+        this._element.focus();\n+    }\n+};\n+\n+TagSearch.prototype.decorate = function(element) {\n+    this._element = element;\n+    this._contentBox = $('#ContentLeft');\n+    this._xButton = $('input[name=reset_query]');\n+    element.keyup(this.makeKeyUpHandler());\n+    element.keydown(this.makeKeyDownHandler());\n+\n+    var me = this;\n+    this._xButton.click(function(){ me.reset() });\n+\n+    var toolTip = new InputToolTip();\n+    toolTip.setPromptText(askbot['data']['tagSearchPromptText']);\n+    toolTip.setClickHandler(function() {\n+        element.focus();\n+    });\n+    element.after(toolTip.getElement());\n+    //below is called after getElement, b/c element must be defined\n+    if (this.getQuery() !== '') {\n+        toolTip.hide();//hide if search query is not empty\n+    }\n+    this._toolTip = toolTip;\n+};"
        },
        {
          "filename": "askbot/media/style/style.css",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -547,7 +547,6 @@ input[type=\"submit\"].searchBtn {\n   z-index: 10001;\n }\n .groups-page input[type=\"submit\"].searchBtn,\n-.tags-page input[type=\"submit\"].searchBtn,\n .badges-pages input[type=\"submit\"].searchBtn,\n .user-profile-page input[type=\"submit\"].searchBtn,\n .meta input[type=\"submit\"].searchBtn,"
        },
        {
          "filename": "askbot/media/style/style.less",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -592,7 +592,6 @@ input[type=\"submit\"].searchBtn {\n }\n \n .groups-page, /* todo: clean up - should not need this */\n-.tags-page,\n .badges-pages,\n .user-profile-page,\n .meta,"
        },
        {
          "filename": "askbot/templates/meta/bottom_scripts.html",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -84,6 +84,9 @@\n                 search.setAskButtonEnabled(false);\n             }\n             search.decorate(searchInput);\n+        } else if (activeTab === 'tags') {\n+            var search = new TagSearch();\n+            search.decorate(searchInput);\n         }\n \n         if (askbot['data']['userIsAdminOrMod']) {"
        },
        {
          "filename": "askbot/templates/tags.html",
          "status": "modified",
          "additions": 3,
          "deletions": 36,
          "patch": "@@ -1,43 +1,8 @@\n {% extends \"two_column_body.html\" %}\n-{% import \"macros.html\" as macros %}\n <!-- tags.html -->\n {% block title %}{% spaceless %}{% trans %}Tags{% endtrans %}{% endspaceless %}{% endblock %}\n {% block content %}\n-<!-- Tabs -->\n-{% include \"tags/header.html\" %}\n-{% if tag_list_type == 'list' %}\n-    {% if not tags.object_list %}\n-        <span>{% trans %}Nothing found{% endtrans %}</span>\n-    {% endif %}\n-    {% if tags.object_list %}\n-        <div class='clearfix'></div>\n-        <ul class='tags'>\n-            {% for tag in tags.object_list %}\n-            <li>\n-                {{ macros.tag_widget(\n-                            tag=tag.name,\n-                            html_tag='div',\n-                            truncate_long_tag=True,\n-                            extra_content='<span class=\"tag-number\">&#215; ' ~\n-                                            tag.used_count|intcomma ~ '</span>'\n-                    )\n-                }}\n-            </li>\n-            {% endfor %}\n-        </ul>\n-        <div class=\"clean\"></div>\n-        <div class=\"pager\">\n-            {{macros.paginator(paginator_context)}}\n-        </div>\n-    {% endif %}\n-{% else %}\n-    <div class=\"clearfix\"></div>\n-    {% if not tags %}\n-        <span>{% trans %}Nothing found{% endtrans %}</span>\n-    {% endif %}\n-    {{ macros.tag_cloud(tags=tags, font_sizes=font_size, search_state=search_state) }}\n-{% endif %}\n-\n+{% include \"tags/content.html\" %}\n {% endblock %}\n {% block endjs %}\n     <script type=\"text/javascript\">\n@@ -49,7 +14,9 @@\n             Hilite.elementid = \"searchtags\";\n             Hilite.debug_referrer = location.href;\n         });\n+        askbot['data']['tagSearchPromptText'] = \"{% trans %}search for tags{% endtrans %}\";\n     /*]]>*/\n     </script>\n+    {% include \"tags/custom_javascript.httml\" ignore missing %}\n {% endblock %}\n <!-- end tags.html -->"
        },
        {
          "filename": "askbot/templates/tags/content.html",
          "status": "added",
          "additions": 34,
          "deletions": 0,
          "patch": "@@ -0,0 +1,34 @@\n+{% import \"macros.html\" as macros %}\n+{% include \"tags/header.html\" %}\n+{% if tag_list_type == 'list' %}\n+    {% if not tags.object_list %}\n+        <span>{% trans %}Nothing found{% endtrans %}</span>\n+    {% endif %}\n+    {% if tags.object_list %}\n+        <div class='clearfix'></div>\n+        <ul class='tags'>\n+            {% for tag in tags.object_list %}\n+            <li>\n+                {{ macros.tag_widget(\n+                            tag=tag.name,\n+                            html_tag='div',\n+                            truncate_long_tag=True,\n+                            extra_content='<span class=\"tag-number\">&#215; ' ~\n+                                            tag.used_count|intcomma ~ '</span>'\n+                    )\n+                }}\n+            </li>\n+            {% endfor %}\n+        </ul>\n+        <div class=\"clean\"></div>\n+        <div class=\"pager\">\n+            {{macros.paginator(paginator_context)}}\n+        </div>\n+    {% endif %}\n+{% else %}\n+    <div class=\"clearfix\"></div>\n+    {% if not tags %}\n+        <span>{% trans %}Nothing found{% endtrans %}</span>\n+    {% endif %}\n+    {{ macros.tag_cloud(tags=tags, font_sizes=font_size, search_state=search_state) }}\n+{% endif %}"
        },
        {
          "filename": "askbot/templates/tags/header.html",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -1,9 +1,10 @@\n <div id=\"content-header\">\n+    {% set tag_query = stag|escape %}\n     {% if page_title %}\n             <h1 class=\"section-title\">{{ page_title }}</h1>\n     {% else %}\n         {% if stag %}\n-            <h1 class=\"section-title\">{% trans %}Tags, matching \"{{ stag }}\"{% endtrans %}</h1>\n+            <h1 class=\"section-title\">{% trans %}Tags, matching \"{{ tag_query }}\"{% endtrans %}</h1>\n         {% else %}\n             <h1 class=\"section-title\">{% trans %}Tags{% endtrans %}</h1>\n         {% endif %}\n@@ -13,13 +14,13 @@ <h1 class=\"section-title\">{% trans %}Tags{% endtrans %}</h1>\n             <span class=\"label\">{% trans %}Sort by &raquo;{% endtrans %}</span>\n             <a\n                 id=\"sort_name\"\n-                href=\"{% url tags %}?sort=name\"\n+                href=\"{% url tags %}?sort=name{% if tag_query %}&query={{ tag_query }}{% endif %}\"\n                 {% if tab_id == 'name' %}class=\"on\"{% endif %}\n                 title=\"{% trans %}sorted alphabetically{% endtrans %}\"\n             ><span>{% trans %}by name{% endtrans %}</span></a>\n             <a\n                 id=\"sort_used\"\n-                href=\"{% url tags %}?sort=used\"\n+                href=\"{% url tags %}?sort=used{% if tag_query %}&query={{ tag_query }}{% endif %}\"\n                 {% if tab_id == 'used' %}class=\"on\"{% endif %}\n                 title=\"{% trans %}sorted by frequency of tag use{% endtrans %}\"\n             ><span>{% trans %}by popularity{% endtrans %}</span></a>"
        },
        {
          "filename": "askbot/templates/widgets/search_bar.html",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -7,14 +7,15 @@\n     {# url action depends on which tab is active #}\n     {% if active_tab == \"tags\" %}\n         <input type=\"hidden\" name=\"t\" value=\"tag\"/>\n+        {% set query=stag %}\n     {% elif active_tab == \"users\" %}\n         <input type=\"hidden\" name=\"t\" value=\"user\"/>\n     {% endif %}\n     <input \n         class=\"searchInput\" \n         type=\"text\" \n         autocomplete=\"off\"\n-        value=\"{{ query|default_if_none('') }}\" \n+        value=\"{{ query|default_if_none('')|escape }}\" \n         name=\"query\" \n         id=\"keywords\"\n     />"
        },
        {
          "filename": "askbot/views/readers.py",
          "status": "modified",
          "additions": 13,
          "deletions": 5,
          "patch": "@@ -245,9 +245,10 @@ def questions(request, **kwargs):\n def tags(request):#view showing a listing of available tags - plain list\n \n     #1) Get parameters. This normally belongs to form cleaning.\n-    sortby = request.GET.get('sort', 'used')\n+    post_data = request.GET\n+    sortby = post_data.get('sort', 'used')\n     try:\n-        page = int(request.GET.get('page', '1'))\n+        page = int(post_data.get('page', '1'))\n     except ValueError:\n         page = 1\n \n@@ -256,13 +257,13 @@ def tags(request):#view showing a listing of available tags - plain list\n     else:\n         order_by = '-used_count'\n \n-    query = request.GET.get('query', '').strip()\n+    query = post_data.get('query', '').strip()\n     tag_list_type = askbot_settings.TAG_LIST_FORMAT\n \n     #2) Get query set for the tags.\n     query_params = {'deleted': False}\n     if query != '':\n-        query_params['name__icontains': query]\n+        query_params['name__icontains'] = query\n \n     tags_qs = Tag.objects.filter(**query_params).exclude(used_count=0)\n \n@@ -307,7 +308,14 @@ def tags(request):#view showing a listing of available tags - plain list\n \n     data['tags'] = tags\n \n-    return render(request, 'tags.html', data)\n+    if request.is_ajax():\n+        template = get_template('tags/content.html')\n+        template_context = RequestContext(request, data)\n+        json_data = {'success': True, 'html': template.render(template_context)}\n+        json_string = simplejson.dumps(json_data)\n+        return HttpResponse(json_string, mimetype='application/json')\n+    else:\n+        return render(request, 'tags.html', data)\n \n @csrf.csrf_protect\n def question(request, id):#refactor - long subroutine. display question body, answers and comments"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 8,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d2cba1723231b786a4cce7cb4e1acf361816abb1",
            "date": "2024-11-25T15:41:05Z",
            "author_login": "evgenyfadeev"
          },
          {
            "sha": "0af532352c368745aa57594b8d8ed44f6d18e860",
            "date": "2024-10-10T21:54:55Z",
            "author_login": "evgenyfadeev"
          },
          {
            "sha": "37ddfbbdb80e0b2c405cad2f6e577c1011f0ac86",
            "date": "2024-08-26T19:54:42Z",
            "author_login": "evgenyfadeev"
          },
          {
            "sha": "7ff779b3a9cfb67bd5a42630eeea0887248b0aad",
            "date": "2024-08-21T08:22:57Z",
            "author_login": "bonnedav"
          },
          {
            "sha": "ee5e4bd29c3a1a80ab2d804f9a42d7f709f92141",
            "date": "2024-08-20T00:08:48Z",
            "author_login": "evgenyfadeev"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in Askbot before 0.7.49 allow remote attackers to inject arbitrary web script or HTML via vectors related to the (1) tag or (2) user search forms.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-03-05T16:37:40.703",
    "last_modified": "2024-11-21T02:05:54.070",
    "fix_date": "2013-03-31T07:27:43Z"
  },
  "references": [
    {
      "url": "http://secunia.com/advisories/57163",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/02/28/8",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/65885",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1070852",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/ASKBOT/askbot-devel/commit/876e3662ff6b78cc6241338c15e3a0cb49edf4e2#diff-b693b4c02739be4b3231bece15b0eb87",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ASKBOT/askbot-devel/commit/a676a86b6b7a5737d4da4f59f71e037406f88d29",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://secunia.com/advisories/57163",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/02/28/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/65885",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1070852",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ASKBOT/askbot-devel/commit/876e3662ff6b78cc6241338c15e3a0cb49edf4e2#diff-b693b4c02739be4b3231bece15b0eb87",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ASKBOT/askbot-devel/commit/a676a86b6b7a5737d4da4f59f71e037406f88d29",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.568183",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "askbot-devel",
    "owner": "ASKBOT",
    "created_at": "2010-03-25T21:37:27Z",
    "updated_at": "2025-01-04T23:52:35Z",
    "pushed_at": "2025-01-13T15:57:59Z",
    "size": 91468,
    "stars": 1566,
    "forks": 625,
    "open_issues": 148,
    "watchers": 1566,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 2612546,
      "JavaScript": 1059054,
      "HTML": 352273,
      "SCSS": 326564,
      "CSS": 216179,
      "Jinja": 24619,
      "PLSQL": 15497,
      "Makefile": 4594,
      "Batchfile": 4110,
      "Dockerfile": 2631,
      "Shell": 1060
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:46:37.331784"
  }
}