{
  "cve_id": "CVE-2014-2270",
  "github_data": {
    "repository": "file/file",
    "fix_commit": "447558595a3650db2886cd2f416ad0beba965801",
    "related_commits": [
      "447558595a3650db2886cd2f416ad0beba965801",
      "447558595a3650db2886cd2f416ad0beba965801"
    ],
    "patch_url": "https://github.com/file/file/commit/447558595a3650db2886cd2f416ad0beba965801.patch",
    "fix_commit_details": {
      "sha": "447558595a3650db2886cd2f416ad0beba965801",
      "commit_date": "2014-01-08T22:22:54Z",
      "author": {
        "login": "zoulasc",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "PR/313: Aaron Reffett: Check properly for exceeding the offset.",
        "length": 63,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 35,
        "additions": 18,
        "deletions": 17
      },
      "files": [
        {
          "filename": "src/softmagic.c",
          "status": "modified",
          "additions": 18,
          "deletions": 17,
          "patch": "@@ -32,7 +32,7 @@\n #include \"file.h\"\n \n #ifndef\tlint\n-FILE_RCSID(\"@(#)$File: softmagic.c,v 1.170 2014/01/06 02:25:32 christos Exp $\")\n+FILE_RCSID(\"@(#)$File: softmagic.c,v 1.171 2014/01/08 22:02:06 christos Exp $\")\n #endif\t/* lint */\n \n #include \"magic.h\"\n@@ -71,6 +71,7 @@ private void cvt_16(union VALUETYPE *, const struct magic *);\n private void cvt_32(union VALUETYPE *, const struct magic *);\n private void cvt_64(union VALUETYPE *, const struct magic *);\n \n+#define OFFSET_OOB(n, o, i)\t((n) < (o) || (i) >= ((n) - (o)))\n /*\n  * softmagic - lookup one file in parsed, in-memory copy of database\n  * Passed the name and FILE * of one file to be typed.\n@@ -1223,7 +1224,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t}\n \t\tswitch (in_type = cvt_flip(m->in_type, flip)) {\n \t\tcase FILE_BYTE:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 1))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 1))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1258,7 +1259,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\t\toffset = ~offset;\n \t\t\tbreak;\n \t\tcase FILE_BESHORT:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 2))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 2))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1310,7 +1311,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\t\toffset = ~offset;\n \t\t\tbreak;\n \t\tcase FILE_LESHORT:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 2))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 2))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1362,7 +1363,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\t\toffset = ~offset;\n \t\t\tbreak;\n \t\tcase FILE_SHORT:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 2))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 2))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1399,7 +1400,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\tbreak;\n \t\tcase FILE_BELONG:\n \t\tcase FILE_BEID3:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 4))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 4))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1470,7 +1471,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\tbreak;\n \t\tcase FILE_LELONG:\n \t\tcase FILE_LEID3:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 4))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 4))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1540,7 +1541,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\t\toffset = ~offset;\n \t\t\tbreak;\n \t\tcase FILE_MELONG:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 4))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 4))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1610,7 +1611,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\t\t\toffset = ~offset;\n \t\t\tbreak;\n \t\tcase FILE_LONG:\n-\t\t\tif (nbytes < offset || nbytes < (offset + 4))\n+\t\t\tif (OFFSET_OOB(nbytes, offset, 4))\n \t\t\t\treturn 0;\n \t\t\tif (off) {\n \t\t\t\tswitch (m->in_op & FILE_OPS_MASK) {\n@@ -1687,14 +1688,14 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t/* Verify we have enough data to match magic type */\n \tswitch (m->type) {\n \tcase FILE_BYTE:\n-\t\tif (nbytes < (offset + 1)) /* should alway be true */\n+\t\tif (OFFSET_OOB(nbytes, offset, 1))\n \t\t\treturn 0;\n \t\tbreak;\n \n \tcase FILE_SHORT:\n \tcase FILE_BESHORT:\n \tcase FILE_LESHORT:\n-\t\tif (nbytes < (offset + 2))\n+\t\tif (OFFSET_OOB(nbytes, offset, 2))\n \t\t\treturn 0;\n \t\tbreak;\n \n@@ -1713,31 +1714,31 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \tcase FILE_FLOAT:\n \tcase FILE_BEFLOAT:\n \tcase FILE_LEFLOAT:\n-\t\tif (nbytes < (offset + 4))\n+\t\tif (OFFSET_OOB(nbytes, offset, 4))\n \t\t\treturn 0;\n \t\tbreak;\n \n \tcase FILE_DOUBLE:\n \tcase FILE_BEDOUBLE:\n \tcase FILE_LEDOUBLE:\n-\t\tif (nbytes < (offset + 8))\n+\t\tif (OFFSET_OOB(nbytes, offset, 8))\n \t\t\treturn 0;\n \t\tbreak;\n \n \tcase FILE_STRING:\n \tcase FILE_PSTRING:\n \tcase FILE_SEARCH:\n-\t\tif (nbytes < (offset + m->vallen))\n+\t\tif (OFFSET_OOB(nbytes, offset, m->vallen))\n \t\t\treturn 0;\n \t\tbreak;\n \n \tcase FILE_REGEX:\n-\t\tif (nbytes < offset)\n+\t\tif (OFFSET_OOB(nbytes, offset, 0))\n \t\t\treturn 0;\n \t\tbreak;\n \n \tcase FILE_INDIRECT:\n-\t\tif (nbytes < offset)\n+\t\tif (OFFSET_OOB(nbytes, offset, 0))\n \t\t\treturn 0;\n \t\tsbuf = ms->o.buf;\n \t\tsoffset = ms->offset;\n@@ -1761,7 +1762,7 @@ mget(struct magic_set *ms, const unsigned char *s, struct magic *m,\n \t\treturn rv;\n \n \tcase FILE_USE:\n-\t\tif (nbytes < offset)\n+\t\tif (OFFSET_OOB(nbytes, offset, 0))\n \t\t\treturn 0;\n \t\tsbuf = m->value.s;\n \t\tif (*sbuf == '^') {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1778642b8ba3d947a779a36fcd81f8e807220a19",
            "date": "2024-12-31T19:57:14Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "3dc6947b16641458a600bdfb7a23db5064887019",
            "date": "2024-12-31T19:50:33Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "54b98feb13b49ec3a66cb151c4321629424a5e74",
            "date": "2024-12-31T19:41:08Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "81e3eb0ca228239f5f2edccb2196da8e430f44bf",
            "date": "2024-12-31T19:38:03Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "48b38ab6e30d113b68a200d29c237b97fdd531e8",
            "date": "2024-12-31T19:02:48Z",
            "author_login": "zoulasc"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-119",
    "description": "softmagic.c in file before 5.17 and libmagic allows context-dependent attackers to cause a denial of service (out-of-bounds memory access and crash) via crafted offsets in the softmagic of a PE executable.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-03-14T15:55:05.667",
    "last_modified": "2024-11-21T02:05:58.350",
    "fix_date": "2014-01-08T22:22:54Z"
  },
  "references": [
    {
      "url": "http://bugs.gw.com/view.php?id=313",
      "source": "security@debian.org",
      "tags": [
        "Broken Link",
        "Patch"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00034.html",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00037.html",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00084.html",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-1765.html",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/473",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/504",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/505",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://support.apple.com/kb/HT6443",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2014/dsa-2873",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.php.net/ChangeLog-5.php",
      "source": "security@debian.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2162-1",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2163-1",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/file/file/commit/447558595a3650db2886cd2f416ad0beba965801",
      "source": "security@debian.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201503-08",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://bugs.gw.com/view.php?id=313",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Patch"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00034.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00037.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00084.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-1765.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/473",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/504",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q1/505",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://support.apple.com/kb/HT6443",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2014/dsa-2873",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.php.net/ChangeLog-5.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2162-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2163-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/file/file/commit/447558595a3650db2886cd2f416ad0beba965801",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201503-08",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:22.571740",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "file",
    "owner": "file",
    "created_at": "2011-01-28T15:20:14Z",
    "updated_at": "2025-01-14T07:46:32Z",
    "pushed_at": "2024-12-31T20:00:10Z",
    "size": 10253,
    "stars": 1318,
    "forks": 380,
    "open_issues": 0,
    "watchers": 1318,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 578279,
      "Makefile": 18126,
      "Python": 15517,
      "M4": 14679,
      "Shell": 3261,
      "Dockerfile": 870
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:14:52.128425"
  }
}