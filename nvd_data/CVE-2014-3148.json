{
  "cve_id": "CVE-2014-3148",
  "github_data": {
    "repository": "okws/okws",
    "fix_commit": "e9bedb644d106a043e33e1058bedd1c2c0b2e2e0",
    "related_commits": [
      "e9bedb644d106a043e33e1058bedd1c2c0b2e2e0",
      "e9bedb644d106a043e33e1058bedd1c2c0b2e2e0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e9bedb644d106a043e33e1058bedd1c2c0b2e2e0",
      "commit_date": "2014-05-02T14:52:38Z",
      "author": {
        "login": "s4y",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Escape error page content",
        "length": 126,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "libahttp/err.C",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -25,13 +25,14 @@\n \n #include \"resp.h\"\n #include \"ahttp.h\"\n+#include \"pescape.h\"\n \n strbuf\n http_error_t::make_body (int n, const str &si, const str &aux)\n {\n   strbuf b;\n   str ldesc;\n-  const str sdesc = http_status.get_desc (n, &ldesc);\n+  const str sdesc = xss_escape (http_status.get_desc (n, &ldesc));\n   b << \"<html>\\n\"\n     << \" <head>\\n\"\n     << \"  <title>\" << n << \" \" << sdesc << \"</title>\\n\"\n@@ -40,11 +41,11 @@ http_error_t::make_body (int n, const str &si, const str &aux)\n     << \" <h1>Error \" << n << \" \" << sdesc << \"</h1><br><br>\\n\"\n     ;\n   if (n == HTTP_NOT_FOUND && aux) {\n-    b << \"The file <tt>\" << aux \n+    b << \"The file <tt>\" << xss_escape (aux)\n       << \"</tt> was not found on this server.<br><br>\\n\\n\";\n   }\n   b << \"  <hr>\\n\"\n-    << \"  <i>\" << si << \"</i>\\n\"\n+    << \"  <i>\" << xss_escape (si) << \"</i>\\n\"\n     << \" <br>\\n\"\n     << \" </body>\\n\"\n     << \"</html>\\n\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1c337392c676ccb4e9a4c92d11d5d2fada6427d2",
            "date": "2021-01-08T15:45:07Z",
            "author_login": "brian-plummer-okcupid"
          },
          {
            "sha": "0bbcf2c12255e51b4cf7dfe592f96a365c2c62ed",
            "date": "2017-08-24T20:27:03Z",
            "author_login": "tejacques"
          },
          {
            "sha": "50a69065e5e8e25ae031e94cf40c344ac94aa976",
            "date": "2017-08-24T20:23:20Z",
            "author_login": "tejacques"
          },
          {
            "sha": "4072d2a36864a2bafbc4da11d28f0cdf104b4709",
            "date": "2017-08-24T20:22:57Z",
            "author_login": "tejacques"
          },
          {
            "sha": "6c04c24010a90875485600b807dcd1cda668d17d",
            "date": "2017-07-05T18:55:11Z",
            "author_login": "tejacques"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in libahttp/err.c in OkCupid OKWS (OK Web Server) allows remote attackers to inject arbitrary web script or HTML via the PATH_INFO to a non-existent page, which is not properly handled in a 404 error page.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-08-31T18:59:07.527",
    "last_modified": "2024-11-21T02:07:32.490",
    "fix_date": "2014-05-02T14:52:38Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/128338/OKCupid-Cross-Site-Scripting.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/okws/okws/commit/e9bedb644d106a043e33e1058bedd1c2c0b2e2e0",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://hackerone.com/reports/3317",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://twitter.com/infosecmaverick/status/462573038299803648",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/128338/OKCupid-Cross-Site-Scripting.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/okws/okws/commit/e9bedb644d106a043e33e1058bedd1c2c0b2e2e0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://hackerone.com/reports/3317",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://twitter.com/infosecmaverick/status/462573038299803648",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:37.894377",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "okws",
    "owner": "okws",
    "created_at": "2011-12-09T22:46:19Z",
    "updated_at": "2025-01-08T04:28:27Z",
    "pushed_at": "2021-01-08T15:45:07Z",
    "size": 13470,
    "stars": 266,
    "forks": 38,
    "open_issues": 9,
    "watchers": 266,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 1521355,
      "C": 646945,
      "Python": 208000,
      "Makefile": 34013,
      "CMake": 30962,
      "RPC": 28593,
      "M4": 26610,
      "Raku": 23275,
      "HTML": 23033,
      "Shell": 15213,
      "Perl": 9551,
      "Yacc": 8354,
      "sed": 1893,
      "PHP": 946
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:27:17.951868"
  }
}