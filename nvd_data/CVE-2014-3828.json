{
  "cve_id": "CVE-2014-3828",
  "github_data": {
    "repository": "centreon/centreon",
    "fix_commit": "cc2109804dd69057cb209037113796ec5ffdce90",
    "related_commits": [
      "cc2109804dd69057cb209037113796ec5ffdce90",
      "cc2109804dd69057cb209037113796ec5ffdce90"
    ],
    "patch_url": "https://github.com/centreon/centreon/commit/cc2109804dd69057cb209037113796ec5ffdce90.patch",
    "fix_commit_details": {
      "sha": "cc2109804dd69057cb209037113796ec5ffdce90",
      "commit_date": "2014-10-20T09:43:26Z",
      "author": {
        "login": "julienmathis",
        "type": "User",
        "stats": {
          "total_commits": 7348,
          "average_weekly_commits": 7.59875904860393,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 444
        }
      },
      "commit_message": {
        "title": "fix #5895 : security issues",
        "length": 27,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 125,
        "additions": 65,
        "deletions": 60
      },
      "files": [
        {
          "filename": "www/include/Administration/corePerformance/getStats.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -97,7 +97,7 @@ function escape_command($command) {\n \t/*\n \t * Check Session activity\n \t */\n-\t$session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n+    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n \tif (!$session->numRows()){\n \t\t;\n \t} else {"
        },
        {
          "filename": "www/include/common/XmlTree/GetXmlTree.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -88,7 +88,7 @@ function getServiceGroupCount()\t{\n \n \t$is_admin = isUserAdmin($_GET[\"sid\"]);\n \tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n-\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n \t\t$session = $DBRESULT->fetchRow();\n \t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n \t\t$lca = array(\"LcaHost\" => $access->getHostServices($pearDBndo), \"LcaHostGroup\" => $access->getHostGroups(), \"LcaSG\" => $access->getServiceGroups());"
        },
        {
          "filename": "www/include/common/getHiddenImage.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -51,7 +51,7 @@\n \t$logos_path = \"../../img/media/\";\n \n \tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n-\t    $result = $pearDB->query(\"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\".$_GET[\"id\"].\"'\");\n+\t    $result = $pearDB->query(\"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\".$pearDB->escape($_GET[\"id\"]).\"'\");\n \t    while ($img = $result->fetchRow() ) {\n \t\t\t$imgpath = $logos_path . $img[\"dir_name\"] .\"/\". $img[\"img_path\"];\n \t        if (!is_file($imgpath)) {"
        },
        {
          "filename": "www/include/configuration/configObject/command_categories/DB-Func.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -46,7 +46,7 @@ function testCommandCategorieExistence ($name = NULL)\t{\n \t\tif (isset($form))\n \t\t\t$id = $form->getSubmitValue('cmd_category_id');\n \t\t\n-\t\t$DBRESULT = $pearDB->query(\"SELECT `category_name`, `cmd_category_id` FROM `command_categories` WHERE `category_name` = '\".htmlentities($name, ENT_QUOTES, \"UTF-8\").\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT `category_name`, `cmd_category_id` FROM `command_categories` WHERE `category_name` = '\".$pearDB->escape($name).\"'\");\n \t\t$cat = $DBRESULT->fetchRow();\n \t\t\n \t\tif ($DBRESULT->numRows() >= 1 && $cat[\"cmd_category_id\"] == $id)\n@@ -88,14 +88,14 @@ function insertCommandCategorieInDB(){\n \t\tglobal $pearDB;\n \t\t\n \t\tif (testCommandCategorieExistence($_POST[\"category_name\"])){\n-\t\t\t$DBRESULT = $pearDB->query(\"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\".$_POST[\"category_name\"].\"', '\".$_POST[\"category_alias\"].\"', '1')\");\n+\t\t\t$DBRESULT = $pearDB->query(\"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\".$pearDB->escape($_POST[\"category_name\"]).\"', '\".$pearDB->escape($_POST[\"category_alias\"]).\"', '1')\");\n \t\t}\n \t}\n \t\n \tfunction updateCommandCategorieInDB(){\n \t\tglobal $pearDB;\n \t\t\n-\t\t$DBRESULT = $pearDB->query(\"UPDATE `command_categories` SET `category_name` = '\".$_POST[\"category_name\"].\"' , `category_alias` = '\".$_POST[\"category_alias\"].\"' , `category_order` = '\".$_POST[\"category_order\"].\"' WHERE `cmd_category_id` = '\".$_POST[\"cmd_category_id\"].\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"UPDATE `command_categories` SET `category_name` = '\".$pearDB->escape($_POST[\"category_name\"]).\"' , `category_alias` = '\".$pearDB->escape($_POST[\"category_alias\"]).\"' , `category_order` = '\".$pearDB->escape($_POST[\"category_order\"]).\"' WHERE `cmd_category_id` = '\".$pearDB->escape($_POST[\"cmd_category_id\"]).\"'\");\n \t}\n \t\n \tfunction deleteCommandCategorieInDB($sc_id = NULL){"
        },
        {
          "filename": "www/include/configuration/configObject/host_template_model/formHostTemplateModel.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -152,7 +152,7 @@\n \t */\n \t$host_tmplt_who_use_me = array();\n \tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n-\t\t$DBRESULT = $pearDB->query(\"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\".$_GET[\"host_id\"].\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\".$pearDB->escape($_GET[\"host_id\"]).\"'\");\n \t\twhile($host_tmpl_father = $DBRESULT->fetchRow())\n \t\t\t$host_tmplt_who_use_me[$host_tmpl_father[\"host_id\"]] = $host_tmpl_father[\"host_name\"];\n \t\t$DBRESULT->free();"
        },
        {
          "filename": "www/include/configuration/configObject/service_categories/DB-Func.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -134,11 +134,11 @@ function insertServiceCategorieInDB(){\n \n \t\tif (testServiceCategorieExistence($_POST[\"sc_name\"])){\n                 $DBRESULT = $pearDB->query(\"INSERT INTO `service_categories` (`sc_name`, `sc_description`, `level`, `icon_id`, `sc_activate` ) \n-                    VALUES ('\".$_POST[\"sc_name\"].\"', '\".$_POST[\"sc_description\"].\"', \".\n+                    VALUES ('\".$pearDB->escape($_POST[\"sc_name\"]).\"', '\".$pearDB->escape($_POST[\"sc_description\"]).\"', \".\n                         (isset($_POST['sc_severity_level']) && $_POST['sc_type'] ? $pearDB->escape($_POST['sc_severity_level']):\"NULL\").\", \".\n                         (isset($_POST['sc_severity_icon']) && $_POST['sc_type'] ? $pearDB->escape($_POST['sc_severity_icon']) : \"NULL\").\", \".\n                         \"'\".$_POST[\"sc_activate\"][\"sc_activate\"].\"')\");\n-                $DBRESULT = $pearDB->query(\"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\".$_POST[\"sc_name\"].\"'\");\n+                $DBRESULT = $pearDB->query(\"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\".$pearDB->escape($_POST[\"sc_name\"]).\"'\");\n                 $data = $DBRESULT->fetchRow();\n         }\n         updateServiceCategoriesServices($data[\"MAX(sc_id)\"]);"
        },
        {
          "filename": "www/include/configuration/configObject/service_template_model/formServiceTemplateModel.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -186,7 +186,7 @@ function myDecodeSvTP($arg) {\n  */\n $svc_tmplt_who_use_me = array();\n if (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n-    $DBRESULT = $pearDB->query(\"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\".$_GET[\"service_id\"].\"'\");\n+    $DBRESULT = $pearDB->query(\"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\".$pearDB->escape($_GET[\"service_id\"]).\"'\");\n     while ($service_tmpl_father = $DBRESULT->fetchRow()) {\n         $svc_tmplt_who_use_me[$service_tmpl_father[\"service_id\"]] = $service_tmpl_father[\"service_description\"];\n     }\n@@ -196,7 +196,7 @@ function myDecodeSvTP($arg) {\n /*\n  * Service Templates comes from DB -> Store in $svTpls Array\n  */\n-$svTpls = array(NULL=>NULL);\n+$svTpls = array(NULL => NULL);\n $DBRESULT = $pearDB->query(\"SELECT service_id, service_description, service_template_model_stm_id FROM service WHERE service_register = '0' AND service_id != '\".$service_id.\"' ORDER BY service_description\");\n while ($svTpl = $DBRESULT->fetchRow())\t{\n     if (!$svTpl[\"service_description\"]) {"
        },
        {
          "filename": "www/include/configuration/configObject/traps/GetXMLTrapsForVendor.php",
          "status": "modified",
          "additions": 40,
          "deletions": 38,
          "patch": "@@ -36,46 +36,48 @@\n  *\n  */\n \n-\tinclude_once(\"@CENTREON_ETC@/centreon.conf.php\");\n+include_once(\"@CENTREON_ETC@/centreon.conf.php\");\n \n-\trequire_once $centreon_path . \"/www/class/centreonDB.class.php\";\n-\trequire_once $centreon_path . \"/www/class/centreonXML.class.php\";\n+require_once $centreon_path . \"/www/class/centreonDB.class.php\";\n+require_once $centreon_path . \"/www/class/centreonXML.class.php\";\n \n-\t/** ************************************\n-\t * start init db\n-\t */\n-\t$pearDB = new CentreonDB();\n+/** ************************************\n+ * start init db\n+ */\n+$pearDB = new CentreonDB();\n+\n+/** ************************************\n+ * start XML Flow\n+ */\n+$buffer = new CentreonXML();\n+$buffer->startElement(\"traps\");\n+\n+$mnftr_id = $pearDB->escape($_POST[\"mnftr_id\"]);\n \n-\t/** ************************************\n-\t * start XML Flow\n-\t */\n-\t$buffer = new CentreonXML();\n-\t$buffer->startElement(\"traps\");\n+$empty = 0;\n+if (isset($_POST[\"mnftr_id\"])){\n+    $traps = array();\n+    if ($_POST[\"mnftr_id\"] == -1) {\n+        $DBRESULT = $pearDB->query(\"SELECT traps_id, traps_name FROM traps ORDER BY traps_name\");\n+    } else if ($_POST[\"mnftr_id\"] == -2) {\n+        $empty = 1;\n+    } else if ($_POST[\"mnftr_id\"] != 0) {\n+        $DBRESULT = $pearDB->query(\"SELECT traps_id, traps_name FROM traps WHERE manufacturer_id = \" . $mnftr_id . \" ORDER BY traps_name\");\n+    }\n \n-\t$empty = 0;\n-\tif (isset($_POST[\"mnftr_id\"])){\n-\t\t$traps = array();\n-\t\tif ($_POST[\"mnftr_id\"] == -1) {\n-\t\t\t$DBRESULT = $pearDB->query(\"SELECT traps_id, traps_name FROM traps ORDER BY traps_name\");\n-\t\t} else if ($_POST[\"mnftr_id\"] == -2) {\n-\t\t\t$empty = 1;\n-\t\t} else if ($_POST[\"mnftr_id\"] != 0) {\n-\t\t\t$DBRESULT = $pearDB->query(\"SELECT traps_id, traps_name FROM traps WHERE manufacturer_id = \" . $_POST[\"mnftr_id\"]. \" ORDER BY traps_name\");\n-\t\t}\n+    if ($empty != 1) {\n+        while ($trap = $DBRESULT->fetchRow()){\n+            $buffer->startElement(\"trap\");\n+            $buffer->writeElement(\"id\", $trap[\"traps_id\"]);\n+            $buffer->writeElement(\"name\", $trap[\"traps_name\"]);\n+            $buffer->endElement();\n+        }\n+        $DBRESULT->free();\n+    }\n+} else {\n+    $buffer->writeElement(\"error\", \"mnftr_id not found\");\n+}\n+$buffer->endElement();\n \n-\t\tif ($empty != 1) {\n-\t\t\twhile ($trap = $DBRESULT->fetchRow()){\n-\t\t\t\t$buffer->startElement(\"trap\");\n-\t\t\t\t$buffer->writeElement(\"id\", $trap[\"traps_id\"]);\n-\t\t\t\t$buffer->writeElement(\"name\", $trap[\"traps_name\"]);\n-\t\t\t\t$buffer->endElement();\n-\t\t\t}\n-\t\t\t$DBRESULT->free();\n-\t\t}\n-\t} else {\n-\t\t$buffer->writeElement(\"error\", \"mnftr_id not found\");\n-\t}\n-\t$buffer->endElement();\n-\theader('Content-Type: text/xml');\n-\t$buffer->output();\n-?>\n\\ No newline at end of file\n+header('Content-Type: text/xml');\n+$buffer->output();"
        },
        {
          "filename": "www/include/configuration/configObject/traps/xml/additionalRowXml.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -52,7 +52,7 @@\n \t */\n \trequire_once ($centreon_path . \"www/class/centreonSession.class.php\");\n \trequire_once ($centreon_path . \"www/class/centreon.class.php\");\n-\tif(!isset($_SESSION['centreon'])) {\n+\tif (!isset($_SESSION['centreon'])) {\n \t\tCentreonSession::start();\n \t}\n "
        },
        {
          "filename": "www/include/eventLogs/XmlTree/GetXmlTree.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -171,7 +171,7 @@ function getServiceGroupSearch($search = NULL)\t{\n \n \t$is_admin = isUserAdmin($_GET[\"sid\"]);\n \tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n-\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n \t\t$session = $DBRESULT->fetchRow();\n \t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n \t\t$lca = array(\"LcaHost\" => $access->getHostServices(($oreon->broker->getBroker() == \"ndo\" ? $pearDBndo : $pearDBO)), \"LcaHostGroup\" => $access->getHostGroups(), \"LcaSG\" => $access->getServiceGroups());"
        },
        {
          "filename": "www/include/options/accessLists/reloadACL/reloadACL.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -48,7 +48,7 @@\n \trequire_once 'HTML/QuickForm/Renderer/ArraySmarty.php';\n \n \tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n-\t\t$pearDB->query(\"UPDATE session SET update_acl = '1' WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n+\t\t$pearDB->query(\"UPDATE session SET update_acl = '1' WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n \t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n \t\t$msg = new CentreonMsg();\n \t\t$msg->setTextStyle(\"bold\");"
        },
        {
          "filename": "www/include/options/media/images/syncDir.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -55,7 +55,7 @@\n \t\texit ;\n \n \tif (isset($_GET[\"session_id\"])) {\n-\t\t$DBRESULT = $pearDB->query(\"SELECT * FROM session WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT * FROM session WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n \t\tif ($DBRESULT->numRows() == 0)\n \t\t\texit();\n \t}"
        },
        {
          "filename": "www/include/options/session/connected_user.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -46,7 +46,7 @@\n \trequire_once \"./class/centreonMsg.class.php\";\n \t\t\n \tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"k\"){\n-\t\t$pearDB->query(\"DELETE FROM session WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n+\t\t$pearDB->query(\"DELETE FROM session WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n \t\t$msg = new CentreonMsg();\n \t\t$msg->setTextStyle(\"bold\");\n \t\t$msg->setText(_(\"User kicked\"));"
        },
        {
          "filename": "www/include/views/graphs/GetXmlTree.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -97,7 +97,7 @@\n \n \t$is_admin = isUserAdmin($_GET[\"sid\"]);\n \tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n-\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n \t\t$session = $DBRESULT->fetchRow();\n \t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n \t\t$lca = array(\"LcaHost\" => $access->getHostServices($pearDBndo), \"LcaHostGroup\" => $access->getHostGroups(), \"LcaSG\" => $access->getServiceGroups());"
        },
        {
          "filename": "www/include/views/graphs/common/makeXML_ListMetrics.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -90,7 +90,7 @@ function compare($a, $b) {\n \t\t$where = \" AND def_type='\".$_GET[\"vdef\"].\"'\";\n \n \tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n-\t\t$pq_sql = $pearDBO->query(\"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\".$_GET[\"index_id\"].\"';\");\n+\t\t$pq_sql = $pearDBO->query(\"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\".$pearDB->escape($_GET[\"index_id\"]).\"';\");\n \t\twhile($fw_sql = $pq_sql->fetchRow()) {\n \t\t\t$sd_l = strlen($fw_sql[\"metric_name\"]);\n \t\t\t$fw_sql[\"metric_name\"] = $fw_sql[\"metric_name\"].\"&nbsp;&nbsp;&nbsp;\";\n@@ -99,7 +99,7 @@ function compare($a, $b) {\n \t\t\t\t$mx_l = $sd_l;\n     \t}\n \t\t$pq_sql->free();\n-\t\t$pq_sql = $pearDB->query(\"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\".$_GET[\"index_id\"].\"'\".$where.\";\");\n+\t\t$pq_sql = $pearDB->query(\"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\".$pearDB->escape($_GET[\"index_id\"]).\"'\".$where.\";\");\n \n \t\twhile($fw_sql = $pq_sql->fetchRow()) {\n \t\t\t$sd_l = strlen($fw_sql[\"vmetric_name\"].\" [CDEF]\");"
        },
        {
          "filename": "www/include/views/graphs/graphStatus/displayServiceStatus.php",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -36,7 +36,7 @@\n  *\n  */\n \tfunction escape_command($command) {\n-\t\treturn preg_replace(\"/(\\\\\\$|`)/\", \"\", $command);\n+\t\treturn preg_replace(\"/(\\\\\\$|;`)/\", \"\", $command);\n \t}\n \n \trequire_once \"@CENTREON_ETC@/centreon.conf.php\";\n@@ -71,7 +71,7 @@ function getStatusDBDir($pearDBO){\n \t * Verify if session is active\n \t */\n \n-\t$session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n+    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n \tif (!$session->numRows()){\n \n \t\t$image = imagecreate(250,100);\n@@ -142,8 +142,11 @@ function getStatusDBDir($pearDBO){\n \t\t/*\n \t\t * get all template infos\n \t\t */\n+        if (!is_numeric($template_id)) {\n+            exit();\n+        }\n \n-\t\t$DBRESULT = $pearDB->query(\"SELECT * FROM giv_graphs_template WHERE graph_id = '\".$template_id.\"' LIMIT 1\");\n+\t\t$DBRESULT = $pearDB->query(\"SELECT * FROM giv_graphs_template WHERE graph_id = '\".$pearDB->escape($template_id).\"' LIMIT 1\");\n \t\t$GraphTemplate = $DBRESULT->fetchRow();\n         if (is_null($GraphTemplate))\n         {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 6,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 16,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6041851eb8b8f9bf586618f9de9e3f23cfee7e4c",
            "date": "2025-01-14T14:16:27Z",
            "author_login": "kduret"
          },
          {
            "sha": "518e31f1f2749e61b72d1f26aed82f37d675a57a",
            "date": "2025-01-14T14:02:24Z",
            "author_login": "adr-mo"
          },
          {
            "sha": "02a93a796db7263ef554f1dee1f55f1e6e1d5a9a",
            "date": "2025-01-13T17:18:37Z",
            "author_login": "selfakiri"
          },
          {
            "sha": "2224f6423ee522a4e81719e12c70f7cb8563f480",
            "date": "2025-01-13T13:44:35Z",
            "author_login": "Noha-ElAbrouki"
          },
          {
            "sha": "70ab68fc8be574a61ba02778a807a7942b47cbf9",
            "date": "2025-01-13T10:22:16Z",
            "author_login": "kduret"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-89",
    "description": "Multiple SQL injection vulnerabilities in Centreon 2.5.1 and Centreon Enterprise Server 2.2 (fixed in Centreon web 2.5.3) allow remote attackers to execute arbitrary SQL commands via (1) the index_id parameter to views/graphs/common/makeXML_ListMetrics.php, (2) the sid parameter to views/graphs/GetXmlTree.php, (3) the session_id parameter to views/graphs/graphStatus/displayServiceStatus.php, (4) the mnftr_id parameter to configuration/configObject/traps/GetXMLTrapsForVendor.php, or (5) the index parameter to common/javascript/commandGetArgs/cmdGetExample.php in include/.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-10-23T01:55:16.033",
    "last_modified": "2024-11-21T02:08:56.403",
    "fix_date": "2014-10-20T09:43:26Z"
  },
  "references": [
    {
      "url": "http://seclists.org/fulldisclosure/2014/Oct/78",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.kb.cert.org/vuls/id/298796",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "US Government Resource"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/70648",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://documentation.centreon.com/docs/centreon/en/latest/release_notes/centreon-2.5/centreon-2.5.3.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/centreon/centreon/commit/cc2109804dd69057cb209037113796ec5ffdce90#diff-e328097503b14fbb117e0db798aefcde",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Oct/78",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.kb.cert.org/vuls/id/298796",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "US Government Resource"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/70648",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://documentation.centreon.com/docs/centreon/en/latest/release_notes/centreon-2.5/centreon-2.5.3.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/centreon/centreon/commit/cc2109804dd69057cb209037113796ec5ffdce90#diff-e328097503b14fbb117e0db798aefcde",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:30.027762",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "centreon",
    "owner": "centreon",
    "created_at": "2022-05-25T08:21:12Z",
    "updated_at": "2025-01-13T17:18:42Z",
    "pushed_at": "2025-01-14T13:20:00Z",
    "size": 635046,
    "stars": 108,
    "forks": 41,
    "open_issues": 209,
    "watchers": 108,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "22.04.x",
      "22.10.x",
      "23.04.x",
      "23.10.x",
      "24.04.x",
      "24.10.x"
    ],
    "languages": {
      "PHP": 22266098,
      "TypeScript": 5869839,
      "JavaScript": 889717,
      "Shell": 423983,
      "CSS": 212783,
      "Gherkin": 211415,
      "Perl": 174900,
      "XSLT": 124723,
      "HTML": 122838,
      "Smarty": 46951,
      "Python": 32748,
      "Makefile": 22579,
      "Lua": 21249,
      "MDX": 3220,
      "NewLisp": 621
    },
    "commit_activity": {
      "total_commits_last_year": 1688,
      "avg_commits_per_week": 32.46153846153846,
      "days_active_last_year": 231
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:22:24.210755"
  }
}