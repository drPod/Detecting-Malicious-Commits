{
  "cve_id": "CVE-2014-4348",
  "github_data": {
    "repository": "phpmyadmin/phpmyadmin",
    "fix_commit": "cb7c703c03f656debcea2a16468bd53660fc888e",
    "related_commits": [
      "cb7c703c03f656debcea2a16468bd53660fc888e",
      "d18a2dd9faad7e0e96df799b59e16ef587afb838",
      "cb7c703c03f656debcea2a16468bd53660fc888e",
      "d18a2dd9faad7e0e96df799b59e16ef587afb838"
    ],
    "patch_url": "https://github.com/phpmyadmin/phpmyadmin/commit/cb7c703c03f656debcea2a16468bd53660fc888e.patch",
    "fix_commit_details": {
      "sha": "cb7c703c03f656debcea2a16468bd53660fc888e",
      "commit_date": "2014-06-06T16:40:19Z",
      "author": {
        "login": "ZweiSteinSoft",
        "type": "User",
        "stats": {
          "total_commits": 127,
          "average_weekly_commits": 0.1069023569023569,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 25
        }
      },
      "commit_message": {
        "title": "Fix XSS in recent/favorite tables list feature",
        "length": 102,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 14,
        "deletions": 10
      },
      "files": [
        {
          "filename": "libraries/RecentFavoriteTable.class.php",
          "status": "modified",
          "additions": 8,
          "deletions": 5,
          "patch": "@@ -206,8 +206,9 @@ public function getHtmlList()\n                     $html .= '<a href=\"sql.php?server=' . $GLOBALS['server']\n                           . '&db=' . $table['db']\n                           . '&table=' . $table['table']\n-                          . '&token=' . $_SESSION[' PMA_token ']\n-                          . '\">`' . $table['db'] . '`.`' . $table['table'] . '`</a>';\n+                          . '&token=' . $_SESSION[' PMA_token '] . '\">`'\n+                          . htmlspecialchars($table['db']) . '`.`'\n+                          . htmlspecialchars($table['table']) . '`</a>';\n                     $html .= '</li>';\n                 }\n             } else {\n@@ -223,16 +224,18 @@ public function getHtmlList()\n                         . PMA_URL_getCommon($fav_params);\n                     $html .= 'href=\"' . $fav_rm_url\n                         . '\" title=\"' . __(\"Remove from Favorites\")\n-                        . '\" data-favtargetn=\"' . $table['db'] . \".\" . $table['table']\n+                        . '\" data-favtargetn=\"'\n+                        . md5($table['db'] . \".\" . $table['table'])\n                         . '\" >'\n                         . PMA_Util::getIcon('b_favorite.png')\n                         . '</a>';\n \n                     $html .= '<a href=\"sql.php?server=' . $GLOBALS['server']\n                           . '&db=' . $table['db']\n                           . '&table=' . $table['table']\n-                          . '&token=' . $_SESSION[' PMA_token ']\n-                          . '\">`' . $table['db'] . '`.`' . $table['table'] . '`</a>';\n+                          . '&token=' . $_SESSION[' PMA_token '] . '\">`'\n+                          . htmlspecialchars($table['db']) . '`.`'\n+                          . htmlspecialchars($table['table']) . '`</a>';\n                     $html .= '</li>';\n                 }\n             }"
        },
        {
          "filename": "libraries/structure.lib.php",
          "status": "modified",
          "additions": 6,
          "deletions": 5,
          "patch": "@@ -2736,23 +2736,24 @@ function PMA_checkFavoriteTable($db, $current_table)\n function PMA_getHtmlForFavoriteAnchor($db, $current_table, $titles)\n {\n     $html_output  = '<a ';\n-    $html_output .= 'id=\"' . preg_replace(\n-        '/\\s+/', '', $current_table['TABLE_NAME']\n-    ) . '_favorite_anchor\" ';\n+    $html_output .= 'id=\"' . md5($current_table['TABLE_NAME'])\n+        . '_favorite_anchor\" ';\n     $html_output .= 'class=\"ajax favorite_table_anchor';\n \n     // Check if current table is already in favorite list.\n     $already_favorite = PMA_checkFavoriteTable($db, $current_table['TABLE_NAME']);\n     $fav_params = array('db' => $db,\n         'ajax_request' => true,\n         'favorite_table' => $current_table['TABLE_NAME'],\n-        (($already_favorite?'remove':'add') . '_favorite') => true);\n+        (($already_favorite?'remove':'add') . '_favorite') => true\n+    );\n     $fav_url = 'db_structure.php' . PMA_URL_getCommon($fav_params);\n     $html_output .= '\" ';\n     $html_output .= 'href=\"' . $fav_url\n         . '\" title=\"' . ($already_favorite ? __(\"Remove from Favorites\")\n         : __(\"Add to Favorites\"))\n-        . '\" data-favtargets=\"' . $db . \".\" . $current_table['TABLE_NAME']\n+        . '\" data-favtargets=\"'\n+        . md5($db . \".\" . $current_table['TABLE_NAME'])\n         . '\" >'\n         . (!$already_favorite ? $titles['NoFavorite']\n         : $titles['Favorite']) . '</a>';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "98b0d33571357c58c1bafde633ebfeb6acff1d71",
            "date": "2025-01-14T19:47:39Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "3a619b6824b6b2ba1905086511226c669d50caae",
            "date": "2025-01-14T05:24:18Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "e7c11147a3d7d4f39a21216347ffb97e9a5cda9c",
            "date": "2025-01-14T17:40:54Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "00d882935f808ad0d6a30da1d6102503bcf6637e",
            "date": "2025-01-14T17:39:14Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "f1cf1634e792a0c8a6df3133e32e47f33ea0e18f",
            "date": "2025-01-14T00:07:27Z",
            "author_login": "MauricioFauth"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.2.x before 4.2.4 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) database name or (2) table name that is improperly handled after presence in (a) the favorite list or (b) recent tables.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-06-25T11:19:22.497",
    "last_modified": "2024-11-21T02:10:01.053",
    "fix_date": "2014-06-06T16:40:19Z"
  },
  "references": [
    {
      "url": "http://phpmyadmin.net/home_page/security/PMASA-2014-2.php",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/68201",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/cb7c703c03f656debcea2a16468bd53660fc888e",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/d18a2dd9faad7e0e96df799b59e16ef587afb838",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "http://phpmyadmin.net/home_page/security/PMASA-2014-2.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/68201",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/cb7c703c03f656debcea2a16468bd53660fc888e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/d18a2dd9faad7e0e96df799b59e16ef587afb838",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:25.505334",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "phpmyadmin",
    "owner": "phpmyadmin",
    "created_at": "2012-01-19T13:21:52Z",
    "updated_at": "2025-01-13T23:05:28Z",
    "pushed_at": "2025-01-13T22:05:32Z",
    "size": 2082161,
    "stars": 7343,
    "forks": 3442,
    "open_issues": 855,
    "watchers": 7343,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "QA_4_7",
      "QA_4_8",
      "QA_5_0",
      "master"
    ],
    "languages": {
      "PHP": 8222311,
      "TypeScript": 1345556,
      "Twig": 804427,
      "SCSS": 312156,
      "Shell": 52309,
      "JavaScript": 16982,
      "Hack": 588
    },
    "commit_activity": {
      "total_commits_last_year": 1510,
      "avg_commits_per_week": 29.03846153846154,
      "days_active_last_year": 306
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:04:35.166546"
  }
}