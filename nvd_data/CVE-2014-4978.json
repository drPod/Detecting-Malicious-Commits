{
  "cve_id": "CVE-2014-4978",
  "github_data": {
    "repository": "rawstudio/rawstudio",
    "fix_commit": "9c2cd3c93c05d009a91d84eedbb85873b0cb505d",
    "related_commits": [
      "9c2cd3c93c05d009a91d84eedbb85873b0cb505d",
      "9c2cd3c93c05d009a91d84eedbb85873b0cb505d"
    ],
    "patch_url": "https://github.com/rawstudio/rawstudio/commit/9c2cd3c93c05d009a91d84eedbb85873b0cb505d.patch",
    "fix_commit_details": {
      "sha": "9c2cd3c93c05d009a91d84eedbb85873b0cb505d",
      "commit_date": "2014-12-03T07:01:28Z",
      "author": {
        "login": "abrander",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixes insecure use of temporary file (CVE-2014-4978).",
        "length": 53,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 18,
        "deletions": 3
      },
      "files": [
        {
          "filename": "librawstudio/rs-filter.c",
          "status": "modified",
          "additions": 18,
          "deletions": 3,
          "patch": "@@ -772,17 +772,32 @@ void\n rs_filter_graph(RSFilter *filter)\n {\n \tg_return_if_fail(RS_IS_FILTER(filter));\n+\tgchar *dot_filename;\n+\tgchar *png_filename;\n+\tgchar *command_line;\n \tGString *str = g_string_new(\"digraph G {\\n\");\n \n \trs_filter_graph_helper(str, filter);\n \n \tg_string_append_printf(str, \"}\\n\");\n-\tg_file_set_contents(\"/tmp/rs-filter-graph\", str->str, str->len, NULL);\n \n-\tif (0 != system(\"dot -Tpng >/tmp/rs-filter-graph.png </tmp/rs-filter-graph\"))\n+\t/* Here we would like to use g_mkdtemp(), but due to a bug in upstream, that's impossible */\n+\tdot_filename = g_strdup_printf(\"/tmp/rs-filter-graph.%u\", g_random_int());\n+\tpng_filename = g_strdup_printf(\"%s.%u.png\", dot_filename, g_random_int());\n+\n+\tg_file_set_contents(dot_filename, str->str, str->len, NULL);\n+\n+\tcommand_line = g_strdup_printf(\"dot -Tpng >%s <%s\", png_filename, dot_filename);\n+\tif (0 != system(command_line))\n \t\tg_warning(\"Calling dot failed\");\n-\tif (0 != system(\"gnome-open /tmp/rs-filter-graph.png\"))\n+\tg_free(command_line);\n+\n+\tcommand_line = g_strdup_printf(\"gnome-open %s\", png_filename);\n+\tif (0 != system(command_line))\n \t\tg_warning(\"Calling gnome-open failed.\");\n+\tg_free(command_line);\n \n+\tg_free(dot_filename);\n+\tg_free(png_filename);\n \tg_string_free(str, TRUE);\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c140a5eb64901e07db5190db20f9884e86e5dcae",
            "date": "2021-06-02T21:43:01Z",
            "author_login": "abrander"
          },
          {
            "sha": "58a89591ffb46c30c3baa7fa4858a00479159f75",
            "date": "2021-05-27T14:23:03Z",
            "author_login": "abrander"
          },
          {
            "sha": "95ab8352914f3ada44d51958c63bbf31708807bc",
            "date": "2021-05-27T14:20:36Z",
            "author_login": "abrander"
          },
          {
            "sha": "12d0d6486d17c26504154ee11c0b5d078200ff3f",
            "date": "2021-05-26T23:11:21Z",
            "author_login": "sergiomb2"
          },
          {
            "sha": "e0522faa44e2bc7e779eba9cd80bf7aef596b39b",
            "date": "2021-05-25T14:35:07Z",
            "author_login": "abrander"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-59",
    "description": "The rs_filter_graph function in librawstudio/rs-filter.c in rawstudio might allow local users to truncate arbitrary files via a symlink attack on (1) /tmp/rs-filter-graph.png or (2) /tmp/rs-filter-graph.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-12-29T22:29:00.410",
    "last_modified": "2024-11-21T02:11:12.677",
    "fix_date": "2014-12-03T07:01:28Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162109.html",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/07/16/15",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/68671",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=754899",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1120093",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/94633",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/rawstudio/rawstudio/commit/9c2cd3c93c05d009a91d84eedbb85873b0cb505d",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162109.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/07/16/15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/68671",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=754899",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1120093",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/94633",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/rawstudio/rawstudio/commit/9c2cd3c93c05d009a91d84eedbb85873b0cb505d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:12.801190",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rawstudio",
    "owner": "rawstudio",
    "created_at": "2014-11-24T18:36:08Z",
    "updated_at": "2024-10-21T16:41:51Z",
    "pushed_at": "2024-03-17T08:39:04Z",
    "size": 11885,
    "stars": 86,
    "forks": 21,
    "open_issues": 24,
    "watchers": 86,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1917249,
      "C++": 207030,
      "Makefile": 27197,
      "Shell": 7715,
      "M4": 5478
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T21:56:14.209374"
  }
}