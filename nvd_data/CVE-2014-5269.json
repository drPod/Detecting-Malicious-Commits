{
  "cve_id": "CVE-2014-5269",
  "github_data": {
    "repository": "plack/Plack",
    "fix_commit": "bc1731dbb53850c380875ad683cd87c8ec99eee3",
    "related_commits": [
      "bc1731dbb53850c380875ad683cd87c8ec99eee3",
      "bc1731dbb53850c380875ad683cd87c8ec99eee3"
    ],
    "patch_url": "https://github.com/plack/Plack/commit/bc1731dbb53850c380875ad683cd87c8ec99eee3.patch",
    "fix_commit_details": {
      "sha": "bc1731dbb53850c380875ad683cd87c8ec99eee3",
      "commit_date": "2014-02-07T10:13:45Z",
      "author": {
        "login": "avar",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Plack::App::File: Fix a security issue by not pruning trailing slashes",
        "length": 2498,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 32,
        "additions": 31,
        "deletions": 1
      },
      "files": [
        {
          "filename": "Changes",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -1,6 +1,17 @@\n Go to http://github.com/plack/Plack/issues for the roadmap and known issues.\n \n {{$NEXT}}\n+    [SECURITY]\n+        - Plack::App::File would previously strip trailing slashes off\n+          provided paths.\n+\n+          This in combination with the common pattern of dynamically\n+          generating some files in a tree and serving the rest up with\n+          Plack::Middleware::Static could allow an attacker to bypass\n+          a whitelist of generated files by just requesting\n+          /file.disallowed/ instead of /file.disallowed, provided that\n+          Plack::Middleware::Static was used for all paths except\n+          those matching /\\.disallowed$/\n \n 1.0030  2013-11-23 08:54:01 CET\n     [IMPROVEMENTS]"
        },
        {
          "filename": "lib/Plack/App/File.pm",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -44,7 +44,7 @@ sub locate_file {\n     }\n \n     my $docroot = $self->root || \".\";\n-    my @path = split /[\\\\\\/]/, $path;\n+    my @path = split /[\\\\\\/]/, $path, -1; # -1 *MUST* be here to avoid security issues!\n     if (@path) {\n         shift @path if $path[0] eq '';\n     } else {"
        },
        {
          "filename": "t/Plack-Middleware/file.t",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -3,6 +3,7 @@ use Plack::Test;\n use Test::More;\n use HTTP::Request::Common;\n use Plack::App::File;\n+use FindBin qw($Bin);\n \n my $app = Plack::App::File->new(file => 'Changes');\n \n@@ -35,6 +36,24 @@ test_psgi $app_content_type, sub {\n     is $res->code, 200;\n };\n \n+my $app_secure = Plack::App::File->new(root => $Bin);\n \n+test_psgi $app_secure, sub {\n+    my $cb = shift;\n+\n+    my $res = $cb->(GET \"/file.t\");\n+    is $res->code, 200;\n+    like $res->content, qr/We will find for this literal string/;\n+\n+    my $res = $cb->(GET \"/../Plack-Middleware/file.t\");\n+    is $res->code, 403;\n+    is $res->content, 'forbidden';\n+\n+    for my $i (1..100) {\n+        $res = $cb->(GET \"/file.t\" . (\"/\" x $i));\n+        is $res->code, 404;\n+        is $res->content, 'not found';\n+    }\n+};\n \n done_testing;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "37fe259bdf502c45b2d2593f82f5fc97524dbad5",
            "date": "2024-06-22T16:34:23Z",
            "author_login": "miyagawa"
          },
          {
            "sha": "fa47e35c5bb74fe00b0a410006cef6bc559378eb",
            "date": "2024-06-22T16:33:45Z",
            "author_login": "miyagawa"
          },
          {
            "sha": "17b681bb6fc746aa646c0da346e6d369e3c50700",
            "date": "2024-06-22T16:07:19Z",
            "author_login": "bbrtj"
          },
          {
            "sha": "9bca3c3f82f64815cc50401f3403f29445420813",
            "date": "2024-06-12T15:00:20Z",
            "author_login": "miyagawa"
          },
          {
            "sha": "80f2151427bf9b8f7cb0031e9878e3dd4a4f4aa1",
            "date": "2024-06-12T14:32:57Z",
            "author_login": "yoshikazusawa"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "Plack::App::File in Plack before 1.0031 removes trailing slash characters from paths, which allows remote attackers to bypass the whitelist of generated files and obtain sensitive information via a crafted path, related to Plack::Middleware::Static.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-09-04T17:55:06.060",
    "last_modified": "2024-11-21T02:11:44.367",
    "fix_date": "2014-02-07T10:13:45Z"
  },
  "references": [
    {
      "url": "http://api.metacpan.org/source/MIYAGAWA/Plack-1.0031/Changes",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-August/137099.html",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-August/137115.html",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q3/384",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/109928",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://github.com/avar/Plack/commit/bc1731dbb53850c380875ad683cd87c8ec99eee3",
      "source": "security@debian.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/plack/Plack/issues/405",
      "source": "security@debian.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://api.metacpan.org/source/MIYAGAWA/Plack-1.0031/Changes",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-August/137099.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-August/137115.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/oss-sec/2014/q3/384",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.osvdb.org/109928",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/avar/Plack/commit/bc1731dbb53850c380875ad683cd87c8ec99eee3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/plack/Plack/issues/405",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:27.918619",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Plack",
    "owner": "plack",
    "created_at": "2009-09-07T06:43:52Z",
    "updated_at": "2025-01-09T23:08:04Z",
    "pushed_at": "2024-06-22T16:34:44Z",
    "size": 5456,
    "stars": 488,
    "forks": 212,
    "open_issues": 106,
    "watchers": 488,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Perl": 496412,
      "HTML": 212,
      "Shell": 102,
      "CSS": 25,
      "JavaScript": 17
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T18:23:26.929926"
  }
}