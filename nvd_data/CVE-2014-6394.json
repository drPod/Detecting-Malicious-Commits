{
  "cve_id": "CVE-2014-6394",
  "github_data": {
    "repository": "visionmedia/send",
    "fix_commit": "9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a",
    "related_commits": [
      "9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a",
      "9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a"
    ],
    "patch_url": "https://github.com/visionmedia/send/commit/9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a.patch",
    "fix_commit_details": {
      "sha": "9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a",
      "commit_date": "2014-09-04T18:27:58Z",
      "author": {
        "login": "dougwilson",
        "type": "User",
        "stats": {
          "total_commits": 469,
          "average_weekly_commits": 0.716030534351145,
          "total_additions": 6741,
          "total_deletions": 4547,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "Fix a path traversal issue when using root",
        "length": 63,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 32,
        "additions": 30,
        "deletions": 2
      },
      "files": [
        {
          "filename": "History.md",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1,3 +1,8 @@\n+unreleased\n+==========\n+\n+  * Fix a path traversal issue when using `root`\n+\n 0.8.3 / 2014-08-16\n ==================\n "
        },
        {
          "filename": "lib/send.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -412,7 +412,7 @@ SendStream.prototype.pipe = function(res){\n   if (root !== null) {\n     // join / normalize from optional root dir\n     path = normalize(join(root, path))\n-    root = normalize(root)\n+    root = normalize(root + sep)\n \n     // malicious path\n     if (path.substr(0, root.length) !== root) {\n@@ -421,7 +421,7 @@ SendStream.prototype.pipe = function(res){\n     }\n \n     // explode path parts\n-    parts = path.substr(root.length + 1).split(sep)\n+    parts = path.substr(root.length).split(sep)\n   } else {\n     // \"..\" is malicious without \"root\"\n     if (upPathRegexp.test(path)) {"
        },
        {
          "filename": "test/fixtures/name.d/name.txt",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+loki\n\\ No newline at end of file"
        },
        {
          "filename": "test/send.js",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -1097,6 +1097,17 @@ describe('send(file, options)', function(){\n         .expect(200, 'tobi', done)\n       })\n \n+      it('should with with trailing slash', function(done){\n+        var app = http.createServer(function(req, res){\n+          send(req, req.url, {root: __dirname + '/fixtures/'})\n+          .pipe(res);\n+        });\n+\n+        request(app)\n+        .get('/name.txt')\n+        .expect(200, 'tobi', done)\n+      })\n+\n       it('should restrict paths to within root', function(done){\n         var app = http.createServer(function(req, res){\n           send(req, req.url, {root: __dirname + '/fixtures'})\n@@ -1118,6 +1129,17 @@ describe('send(file, options)', function(){\n         .get('/pets/../../send.js')\n         .expect(403, done)\n       })\n+\n+      it('should not allow root transversal', function(done){\n+        var app = http.createServer(function(req, res){\n+          send(req, req.url, {root: __dirname + '/fixtures/name.d'})\n+          .pipe(res);\n+        });\n+\n+        request(app)\n+        .get('/../name.dir/name.txt')\n+        .expect(403, done)\n+      })\n     })\n \n     describe('when missing', function(){"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dc6b5d4ec29355ffcf1ab122e52c27a98c392c15",
            "date": "2024-09-10T00:24:53Z",
            "author_login": "UlisesGascon"
          },
          {
            "sha": "8eaab61ebece87e1103fb4d2884b0f4f6977c173",
            "date": "2024-09-10T00:13:51Z",
            "author_login": "UlisesGascon"
          },
          {
            "sha": "97741005edfb237c7f594aeb0a84e2a458b8e686",
            "date": "2024-07-26T20:46:04Z",
            "author_login": "rmhaiderali"
          },
          {
            "sha": "672e5c37159df10cdcad93b23ebbe4547a028cc7",
            "date": "2024-07-26T20:36:45Z",
            "author_login": "wesleytodd"
          },
          {
            "sha": "91c184e649942d67d7beaf34f46b22ac603198bc",
            "date": "2024-07-25T23:52:46Z",
            "author_login": "wesleytodd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "visionmedia send before 0.8.4 for Node.js uses a partial comparison for verifying whether a directory is within the document root, which allows remote attackers to access restricted directories, as demonstrated using \"public-restricted\" under a \"public\" directory.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-10-08T17:55:05.123",
    "last_modified": "2024-11-21T02:14:18.437",
    "fix_date": "2014-09-04T18:27:58Z"
  },
  "references": [
    {
      "url": "http://lists.apple.com/archives/security-announce/2015/Sep/msg00002.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-October/139938.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-October/140020.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-September/139415.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/62170",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www-01.ibm.com/support/docview.wss?uid=swg21687263",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/09/24/1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/09/30/10",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/70100",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1146063",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/96727",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/visionmedia/send/commit/9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/visionmedia/send/pull/59",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://nodesecurity.io/advisories/send-directory-traversal",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT205217",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.apple.com/archives/security-announce/2015/Sep/msg00002.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-October/139938.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-October/140020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-September/139415.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/62170",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www-01.ibm.com/support/docview.wss?uid=swg21687263",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/09/24/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/09/30/10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/70100",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1146063",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/96727",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/visionmedia/send/commit/9c6ca9b2c0b880afd3ff91ce0d211213c5fa5f9a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/visionmedia/send/pull/59",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://nodesecurity.io/advisories/send-directory-traversal",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT205217",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:27.933367",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "send",
    "owner": "visionmedia",
    "created_at": "2012-07-04T02:56:06Z",
    "updated_at": "2024-12-14T19:51:07Z",
    "pushed_at": "2024-10-09T23:55:54Z",
    "size": 495,
    "stars": 802,
    "forks": 190,
    "open_issues": 20,
    "watchers": 802,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 63187
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:43:49.243738"
  }
}