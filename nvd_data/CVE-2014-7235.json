{
  "cve_id": "CVE-2014-7235",
  "github_data": {
    "repository": "FreePBX/fw_ari",
    "fix_commit": "f294b4580ce725ca3c5e692d86e63d40cef4d836",
    "related_commits": [
      "f294b4580ce725ca3c5e692d86e63d40cef4d836",
      "f294b4580ce725ca3c5e692d86e63d40cef4d836"
    ],
    "patch_url": "https://github.com/FreePBX/fw_ari/commit/f294b4580ce725ca3c5e692d86e63d40cef4d836.patch",
    "fix_commit_details": {
      "sha": "f294b4580ce725ca3c5e692d86e63d40cef4d836",
      "commit_date": "2014-09-30T23:42:59Z",
      "author": {
        "login": "tm1000",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "FREEPBX-8070 Turn all serialized into json",
        "length": 42,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
      },
      "files": [
        {
          "filename": "htdocs_ari/includes/login.php",
          "status": "modified",
          "additions": 11,
          "deletions": 6,
          "patch": "@@ -53,11 +53,16 @@ function Auth() {\n     $data = '';\n     $chksum = '';\n     if (isset($_COOKIE['ari_auth'])) {\n-      $buf = unserialize(stripslashes($_COOKIE['ari_auth']));\n-      list($data,$chksum) = $buf;\n+      $buf = json_decode($_COOKIE['ari_auth'],true);\n+      if(!is_array($buf)) {\n+        $data = false;\n+        $chksum = false;\n+      } else {\n+        list($data,$chksum) = $buf;\n+      }\n     }\n     if (md5($data) == $chksum) {\n-      $data = unserialize($crypt->decrypt($data,$ARI_CRYPT_PASSWORD));\n+      $data = json_decode($crypt->decrypt($data,$ARI_CRYPT_PASSWORD),true);\n       $username = $data['username'];\n       $password = $data['password'];\n     }\n@@ -290,11 +295,11 @@ function Auth() {\n       if ($auth && $remember) {\n \n         $data = array('username' => $username, 'password' => $password);\n-        $data = $crypt->encrypt(serialize($data),$ARI_CRYPT_PASSWORD);\n+        $data = $crypt->encrypt(json_encode($data),$ARI_CRYPT_PASSWORD);\n \n         $chksum = md5($data);\n \n-        $buf = serialize(array($data,$chksum));\n+        $buf = json_encode(array($data,$chksum));\n         setcookie('ari_auth',$buf,time()+365*24*60*60,'/');\n       }\n \n@@ -484,4 +489,4 @@ function GetForm() {\n }\n \n \n-?>\n\\ No newline at end of file\n+?>"
        },
        {
          "filename": "module.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -3,11 +3,12 @@\n \t<modtype>framework</modtype>\n \t<repo>standard</repo>\n \t<name>FreePBX ARI Framework</name>\n-\t<version>2.11.1.4</version>\n+\t<version>2.11.1.5</version>\n \t<publisher>Schmooze Com Inc</publisher>\n \t<license>GPLv3+</license>\n \t<licenselink>http://www.gnu.org/licenses/gpl-3.0.txt</licenselink>\n \t<changelog>\n+\t\t*2.11.1.5* FREEPBX-8070 SECURITY ISSUE Exec shell on a host using bug in Asterisk Recording Interface index.php\n \t\t*2.11.1.4* Force removal of User Panel Tab\n \t\t*2.11.1.3* Delete user panel tab because it comes from this module now\n \t\t*2.11.1.2* Resolve issue of user panel tab removement"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1bbe054ae927901b287e32238e5ecbdf8773c53c",
            "date": "2016-04-14T18:49:58Z",
            "author_login": "ediamousavi"
          },
          {
            "sha": "4db9b76d17b846161094c7a54da3a713070ee9a7",
            "date": "2016-04-14T18:48:22Z",
            "author_login": "ediamousavi"
          },
          {
            "sha": "ea4b62803a573d87ca2999aead82fafd67058f68",
            "date": "2016-04-14T16:41:21Z",
            "author_login": "ediamousavi"
          },
          {
            "sha": "78f8dcd502e0b565fdb811f9f67edd3068bd3155",
            "date": "2016-04-14T16:36:48Z",
            "author_login": "ediamousavi"
          },
          {
            "sha": "60b596f90469db7788baa0f3f24e27d4d7912bab",
            "date": "2016-02-07T04:22:24Z",
            "author_login": "nriendeau"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-94",
    "description": "htdocs_ari/includes/login.php in the ARI Framework module/Asterisk Recording Interface (ARI) in FreePBX before 2.9.0.9, 2.10.x, and 2.11 before 2.11.1.5 allows remote attackers to execute arbitrary code via the ari_auth cookie, related to the PHP unserialize function, as exploited in the wild in September 2014.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-10-07T14:55:09.093",
    "last_modified": "2024-11-21T02:16:34.997",
    "fix_date": "2014-09-30T23:42:59Z"
  },
  "references": [
    {
      "url": "http://community.freepbx.org/t/critical-freepbx-rce-vulnerability-all-versions-cve-2014-7235/24536",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/128516/FreePBX-Authentication-Bypass-Account-Creation.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/61601",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/70188",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/96790",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/FreePBX/fw_ari/commit/f294b4580ce725ca3c5e692d86e63d40cef4d836",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.exploit-db.com/exploits/41005/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://community.freepbx.org/t/critical-freepbx-rce-vulnerability-all-versions-cve-2014-7235/24536",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/128516/FreePBX-Authentication-Bypass-Account-Creation.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://secunia.com/advisories/61601",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/70188",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/96790",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/FreePBX/fw_ari/commit/f294b4580ce725ca3c5e692d86e63d40cef4d836",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.exploit-db.com/exploits/41005/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:27.933005",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fw_ari",
    "owner": "FreePBX",
    "created_at": "2014-01-07T21:03:36Z",
    "updated_at": "2017-06-11T20:28:07Z",
    "pushed_at": "2016-04-14T09:23:15Z",
    "size": 997,
    "stars": 1,
    "forks": 3,
    "open_issues": 0,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 90376,
      "CSS": 20952,
      "ApacheConf": 679
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:42:02.530691"
  }
}