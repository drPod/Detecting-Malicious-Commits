{
  "cve_id": "CVE-2014-7284",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "3d4405226d27b3a215e4d03cfa51f536244e5de7",
    "related_commits": [
      "3d4405226d27b3a215e4d03cfa51f536244e5de7",
      "3d4405226d27b3a215e4d03cfa51f536244e5de7"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3d4405226d27b3a215e4d03cfa51f536244e5de7",
      "commit_date": "2014-05-11T20:59:30Z",
      "author": {
        "login": "strssndktn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "net: avoid dependency of net_get_random_once on nop patching",
        "length": 1398,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 8,
        "deletions": 15
      },
      "files": [
        {
          "filename": "include/linux/net.h",
          "status": "modified",
          "additions": 4,
          "deletions": 11,
          "patch": "@@ -248,24 +248,17 @@ do {\t\t\t\t\t\t\t\t\\\n bool __net_get_random_once(void *buf, int nbytes, bool *done,\n \t\t\t   struct static_key *done_key);\n \n-#ifdef HAVE_JUMP_LABEL\n-#define ___NET_RANDOM_STATIC_KEY_INIT ((struct static_key) \\\n-\t\t{ .enabled = ATOMIC_INIT(0), .entries = (void *)1 })\n-#else /* !HAVE_JUMP_LABEL */\n-#define ___NET_RANDOM_STATIC_KEY_INIT STATIC_KEY_INIT_FALSE\n-#endif /* HAVE_JUMP_LABEL */\n-\n #define net_get_random_once(buf, nbytes)\t\t\t\t\\\n \t({\t\t\t\t\t\t\t\t\\\n \t\tbool ___ret = false;\t\t\t\t\t\\\n \t\tstatic bool ___done = false;\t\t\t\t\\\n-\t\tstatic struct static_key ___done_key =\t\t\t\\\n-\t\t\t___NET_RANDOM_STATIC_KEY_INIT;\t\t\t\\\n-\t\tif (!static_key_true(&___done_key))\t\t\t\\\n+\t\tstatic struct static_key ___once_key =\t\t\t\\\n+\t\t\tSTATIC_KEY_INIT_TRUE;\t\t\t\t\\\n+\t\tif (static_key_true(&___once_key))\t\t\t\\\n \t\t\t___ret = __net_get_random_once(buf,\t\t\\\n \t\t\t\t\t\t       nbytes,\t\t\\\n \t\t\t\t\t\t       &___done,\t\\\n-\t\t\t\t\t\t       &___done_key);\t\\\n+\t\t\t\t\t\t       &___once_key);\t\\\n \t\t___ret;\t\t\t\t\t\t\t\\\n \t})\n "
        },
        {
          "filename": "net/core/utils.c",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -348,8 +348,8 @@ static void __net_random_once_deferred(struct work_struct *w)\n {\n \tstruct __net_random_once_work *work =\n \t\tcontainer_of(w, struct __net_random_once_work, work);\n-\tif (!static_key_enabled(work->key))\n-\t\tstatic_key_slow_inc(work->key);\n+\tBUG_ON(!static_key_enabled(work->key));\n+\tstatic_key_slow_dec(work->key);\n \tkfree(work);\n }\n \n@@ -367,7 +367,7 @@ static void __net_random_once_disable_jump(struct static_key *key)\n }\n \n bool __net_get_random_once(void *buf, int nbytes, bool *done,\n-\t\t\t   struct static_key *done_key)\n+\t\t\t   struct static_key *once_key)\n {\n \tstatic DEFINE_SPINLOCK(lock);\n \tunsigned long flags;\n@@ -382,7 +382,7 @@ bool __net_get_random_once(void *buf, int nbytes, bool *done,\n \t*done = true;\n \tspin_unlock_irqrestore(&lock, flags);\n \n-\t__net_random_once_disable_jump(done_key);\n+\t__net_random_once_disable_jump(once_key);\n \n \treturn true;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa22f4da2a46b484a257d167c67a2adc1b7aaf68",
            "date": "2025-01-26T00:23:38Z",
            "author_login": "torvalds"
          },
          {
            "sha": "eda061cccd146fcbe71051bb4aa5a8672b71216e",
            "date": "2025-01-26T00:19:10Z",
            "author_login": "torvalds"
          },
          {
            "sha": "08de7f9d4d39fd9aa5e747a13acc891214fa2d5f",
            "date": "2025-01-26T00:12:07Z",
            "author_login": "torvalds"
          },
          {
            "sha": "647d69605c70368d54fc012fce8a43e8e5955b04",
            "date": "2025-01-26T00:03:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "184a0997fb77f4a9527fc867fcd16806776c27ce",
            "date": "2025-01-25T23:59:46Z",
            "author_login": "torvalds"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "The net_get_random_once implementation in net/core/utils.c in the Linux kernel 3.13.x and 3.14.x before 3.14.5 on certain Intel processors does not perform the intended slow-path operation to initialize random seeds, which makes it easier for remote attackers to spoof or disrupt IP communication by leveraging the predictability of TCP sequence numbers, TCP and UDP port numbers, and IP ID values.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-10-13T10:55:08.263",
    "last_modified": "2024-11-21T02:16:40.910",
    "fix_date": "2014-05-11T20:59:30Z"
  },
  "references": [
    {
      "url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=3d4405226d27b3a215e4d03cfa51f536244e5de7",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.14.5",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/10/01/19",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1148788",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/torvalds/linux/commit/3d4405226d27b3a215e4d03cfa51f536244e5de7",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://web.archive.org/web/20141002163852/http://secondlookforensics.com/ngro-linux-kernel-bug/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=3d4405226d27b3a215e4d03cfa51f536244e5de7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.14.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/10/01/19",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1148788",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/torvalds/linux/commit/3d4405226d27b3a215e4d03cfa51f536244e5de7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://web.archive.org/web/20141002163852/http://secondlookforensics.com/ngro-linux-kernel-bug/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:27.935017",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-26T06:54:23Z",
    "pushed_at": "2025-01-26T01:00:03Z",
    "size": 5386838,
    "stars": 186472,
    "forks": 54875,
    "open_issues": 441,
    "watchers": 186472,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1331921668,
      "Assembly": 9611819,
      "Shell": 5108035,
      "Python": 2992085,
      "Makefile": 2706967,
      "Perl": 1253833,
      "Rust": 816450,
      "Roff": 202277,
      "C++": 173994,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71397,
      "Awk": 69555,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10902,
      "M4": 3329,
      "MATLAB": 2482,
      "Clojure": 2442,
      "sed": 2433,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 48379,
      "avg_commits_per_week": 930.3653846153846,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:34:00.817711"
  }
}