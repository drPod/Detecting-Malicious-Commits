{
  "cve_id": "CVE-2014-8598",
  "github_data": {
    "repository": "mantisbt/mantisbt",
    "fix_commit": "80a15487",
    "related_commits": [
      "80a15487",
      "80a15487"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "80a15487",
      "commit_date": "2014-10-17T15:21:25Z",
      "author": {
        "login": "dregad",
        "type": "User",
        "stats": {
          "total_commits": 3418,
          "average_weekly_commits": 2.886824324324324,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 500
        }
      },
      "commit_message": {
        "title": "XML plugin: Add config page with access thresholds",
        "length": 716,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 102,
        "additions": 101,
        "deletions": 1
      },
      "files": [
        {
          "filename": "plugins/XmlImportExport/XmlImportExport.php",
          "status": "modified",
          "additions": 15,
          "deletions": 1,
          "patch": "@@ -39,7 +39,7 @@ class XmlImportExportPlugin extends MantisPlugin {\n \tfunction register( ) {\n \t\t$this->name = plugin_lang_get( 'title' );\n \t\t$this->description = plugin_lang_get( 'description' );\n-\t\t$this->page = '';\n+\t\t$this->page = \"config_page\";\n \n \t\t$this->version = '1.0';\n \t\t$this->requires = array(\n@@ -54,6 +54,17 @@ function register( ) {\n \t/**\n \t * Default plugin configuration.\n \t */\n+\tpublic function config() {\n+\t\treturn array(\n+\t\t\t\"import_threshold\" => ADMINISTRATOR,\n+\t\t\t\"export_threshold\" => DEVELOPER,\n+\t\t);\n+\t}\n+\n+\t/**\n+\t * Plugin hooks\n+\t * @return array\n+\t */\n \tfunction hooks( ) {\n \t\t$hooks = array(\n \t\t\t'EVENT_MENU_MANAGE' => 'import_issues_menu',\n@@ -67,6 +78,9 @@ function import_issues_menu( ) {\n \t}\n \n \tfunction export_issues_menu( ) {\n+\t\tif( !access_has_project_level( plugin_config_get( 'export_threshold' ) ) ) {\n+\t\t\treturn array();\n+\t\t}\n \t\treturn array( '<a href=\"' . plugin_page( 'export' ) . '\">' . plugin_lang_get( 'export' ) . '</a>', );\n \t}\n "
        },
        {
          "filename": "plugins/XmlImportExport/lang/strings_english.txt",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -35,7 +35,14 @@ $s_plugin_XmlImportExport_description = 'Adds XML based import and export capabi\n $s_plugin_XmlImportExport_import = 'Import issues';\n $s_plugin_XmlImportExport_export = 'XML Export';\n \n+$s_plugin_XmlImportExport_config_title = 'XML Import/Export Access Levels Configuration';\n+$s_plugin_XmlImportExport_import_threshold = 'Import issues';\n+$s_plugin_XmlImportExport_export_threshold = 'Export issues';\n+\n+$s_plugin_XmlImportExport_action_update = 'Update';\n+\n $s_plugin_XmlImportExport_importing_in_project = 'Importing issues in project:';\n+\n $s_plugin_XmlImportExport_import_options = 'Import options';\n \n $s_plugin_XmlImportExport_cross_references = 'Cross references';"
        },
        {
          "filename": "plugins/XmlImportExport/pages/config.php",
          "status": "added",
          "additions": 27,
          "deletions": 0,
          "patch": "@@ -0,0 +1,27 @@\n+<?php\n+# Copyright (c) 2014  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n+# Licensed under the MIT license\n+\n+form_security_validate( 'plugin_XmlImportExport_config' );\n+access_ensure_global_level( config_get( 'manage_plugin_threshold' ) );\n+\n+/**\n+ * Sets plugin config option if value is different from current/default\n+ * @param string $p_name  option name\n+ * @param string $p_value value to set\n+ * @return void\n+ */\n+function config_set_if_needed( $p_name, $p_value ) {\n+\tif ( $p_value != plugin_config_get( $p_name ) ) {\n+\t\tplugin_config_set( $p_name, $p_value );\n+\t}\n+}\n+\n+$t_redirect_url = plugin_page( 'config_page', true );\n+\n+config_set_if_needed( 'import_threshold' , gpc_get_int( 'import_threshold' ) );\n+config_set_if_needed( 'export_threshold' , gpc_get_int( 'export_threshold' ) );\n+\n+form_security_purge( 'plugin_XmlImportExport_config' );\n+\n+print_successful_redirect( $t_redirect_url );"
        },
        {
          "filename": "plugins/XmlImportExport/pages/config_page.php",
          "status": "added",
          "additions": 48,
          "deletions": 0,
          "patch": "@@ -0,0 +1,48 @@\n+<?php\n+# Copyright (c) 2014  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n+# Licensed under the MIT license\n+\n+access_ensure_global_level( config_get( 'manage_plugin_threshold' ) );\n+\n+html_page_top();\n+//print_manage_menu();\n+?>\n+\n+<br />\n+<form action=\"<?php echo plugin_page( 'config' ) ?>\" method=\"post\">\n+<?php echo form_security_field( 'plugin_XmlImportExport_config' ) ?>\n+<table class=\"width60\" align=\"center\">\n+\n+<tr>\n+<td class=\"form-title\" colspan=\"2\"><?php echo plugin_lang_get(\"config_title\") ?></td>\n+</tr>\n+\n+<tr <?php echo helper_alternate_class() ?>>\n+<td class=\"category\"><?php echo plugin_lang_get( 'import_threshold' ) ?></td>\n+<td><select name=\"import_threshold\"><?php\n+\tprint_enum_string_option_list(\n+\t\t'access_levels',\n+\t\tplugin_config_get( 'import_threshold' )\n+\t);\n+\t?></select></td>\n+</tr>\n+\n+<tr <?php echo helper_alternate_class() ?>>\n+<td class=\"category\"><?php echo plugin_lang_get( 'export_threshold' ) ?></td>\n+<td><select name=\"export_threshold\"><?php\n+\tprint_enum_string_option_list(\n+\t\t'access_levels',\n+\t\tplugin_config_get( 'export_threshold' )\n+\t);\n+\t?></select></td>\n+</tr>\n+\n+<tr>\n+<td class=\"center\" colspan=\"2\"><input type=\"submit\" value=\"<?php echo plugin_lang_get(\"action_update\") ?>\"/></td>\n+</tr>\n+\n+</table>\n+</form>\n+\n+<?php\n+html_page_bottom();"
        },
        {
          "filename": "plugins/XmlImportExport/pages/export.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -20,6 +20,8 @@\n \n require_once( 'core.php' );\n \n+access_ensure_project_level( plugin_config_get( 'export_threshold' ) );\n+\n auth_ensure_user_authenticated( );\n helper_begin_long_process( );\n "
        },
        {
          "filename": "plugins/XmlImportExport/pages/import.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -14,6 +14,8 @@\n # You should have received a copy of the GNU General Public License\n # along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n \n+access_ensure_project_level( plugin_config_get( 'import_threshold' ) );\n+\n auth_reauthenticate( );\n \n html_page_top( plugin_lang_get( 'import' ) );"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "924fb05df417dc639fd50a518dba20531a322851",
            "date": "2025-01-23T12:46:58Z",
            "author_login": "dregad"
          },
          {
            "sha": "60cb1d4e48e3e4578a1b8f662e22ba59dea9cb21",
            "date": "2025-01-23T12:41:32Z",
            "author_login": "raspopov"
          },
          {
            "sha": "7626b72778eaa1d3767b21f613219b0d1c46d9ca",
            "date": "2025-01-23T12:29:11Z",
            "author_login": "dregad"
          },
          {
            "sha": "4994c09658dd16045cc2ff62f184842029fb43fc",
            "date": "2025-01-23T12:07:11Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "64a6c746c971d6f7ecc3063f5bafe9cb357cca93",
            "date": "2025-01-20T12:07:27Z",
            "author_login": "translatewiki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-19",
    "description": "The XML Import/Export plugin in MantisBT 1.2.x does not restrict access, which allows remote attackers to (1) upload arbitrary XML files via the import page or (2) obtain sensitive information via the export page.  NOTE: this issue can be combined with CVE-2014-7146 to execute arbitrary PHP code.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2014-11-18T15:59:06.750",
    "last_modified": "2024-11-21T02:19:24.947",
    "fix_date": "2014-10-17T15:21:25Z"
  },
  "references": [
    {
      "url": "http://secunia.com/advisories/62101",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3120",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.mantisbt.org/bugs/view.php?id=17780",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/11/07/28",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/70996",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/98573",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/80a15487",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/62101",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3120",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.mantisbt.org/bugs/view.php?id=17780",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/11/07/28",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/70996",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/98573",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/80a15487",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:30.039836",
    "processing_status": "enhanced"
  }
}