{
  "cve_id": "CVE-2014-9114",
  "github_data": {
    "repository": "karelzak/util-linux",
    "fix_commit": "89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc",
    "related_commits": [
      "89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc",
      "89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc"
    ],
    "patch_url": "https://github.com/karelzak/util-linux/commit/89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc.patch",
    "fix_commit_details": {
      "sha": "89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc",
      "commit_date": "2014-11-27T12:39:35Z",
      "author": {
        "login": "karelzak",
        "type": "User",
        "stats": {
          "total_commits": 11243,
          "average_weekly_commits": 6.684304399524375,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 884
        }
      },
      "commit_message": {
        "title": "libblkid: care about unsafe chars in cache",
        "length": 1069,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 52,
        "additions": 45,
        "deletions": 7
      },
      "files": [
        {
          "filename": "libblkid/src/read.c",
          "status": "modified",
          "additions": 18,
          "deletions": 3,
          "patch": "@@ -252,15 +252,30 @@ static int parse_token(char **name, char **value, char **cp)\n \t*value = skip_over_blank(*value + 1);\n \n \tif (**value == '\"') {\n-\t\tend = strchr(*value + 1, '\"');\n-\t\tif (!end) {\n+\t\tchar *p = end = *value + 1;\n+\n+\t\t/* convert 'foo\\\"bar'  to 'foo\"bar' */\n+\t\twhile (*p) {\n+\t\t\tif (*p == '\\\\') {\n+\t\t\t\tp++;\n+\t\t\t\t*end = *p;\n+\t\t\t} else {\n+\t\t\t\t*end = *p;\n+\t\t\t\tif (*p == '\"')\n+\t\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tp++;\n+\t\t\tend++;\n+\t\t}\n+\n+\t\tif (*end != '\"') {\n \t\t\tDBG(READ, ul_debug(\"unbalanced quotes at: %s\", *value));\n \t\t\t*cp = *value;\n \t\t\treturn -BLKID_ERR_CACHE;\n \t\t}\n \t\t(*value)++;\n \t\t*end = '\\0';\n-\t\tend++;\n+\t\tend = ++p;\n \t} else {\n \t\tend = skip_over_word(*value);\n \t\tif (*end) {"
        },
        {
          "filename": "libblkid/src/save.c",
          "status": "modified",
          "additions": 21,
          "deletions": 1,
          "patch": "@@ -26,6 +26,21 @@\n \n #include \"blkidP.h\"\n \n+\n+static void save_quoted(const char *data, FILE *file)\n+{\n+\tconst char *p;\n+\n+\tfputc('\"', file);\n+\tfor (p = data; p && *p; p++) {\n+\t\tif ((unsigned char) *p == 0x22 ||\t\t/* \" */\n+\t\t    (unsigned char) *p == 0x5c)\t\t\t/* \\ */\n+\t\t\tfputc('\\\\', file);\n+\n+\t\tfputc(*p, file);\n+\t}\n+\tfputc('\"', file);\n+}\n static int save_dev(blkid_dev dev, FILE *file)\n {\n \tstruct list_head *p;\n@@ -43,9 +58,14 @@ static int save_dev(blkid_dev dev, FILE *file)\n \n \tif (dev->bid_pri)\n \t\tfprintf(file, \" PRI=\\\"%d\\\"\", dev->bid_pri);\n+\n \tlist_for_each(p, &dev->bid_tags) {\n \t\tblkid_tag tag = list_entry(p, struct blkid_struct_tag, bit_tags);\n-\t\tfprintf(file, \" %s=\\\"%s\\\"\", tag->bit_name,tag->bit_val);\n+\n+\t\tfputc(' ', file);\t\t\t/* space between tags */\n+\t\tfputs(tag->bit_name, file);\t\t/* tag NAME */\n+\t\tfputc('=', file);\t\t\t/* separator between NAME and VALUE */\n+\t\tsave_quoted(tag->bit_val, file);\t/* tag \"VALUE\" */\n \t}\n \tfprintf(file, \">%s</device>\\n\", dev->bid_name);\n "
        },
        {
          "filename": "misc-utils/blkid.8",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -200,7 +200,10 @@ partitions.  This output format is \\fBDEPRECATED\\fR.\n .TP\n .B export\n print key=value pairs for easy import into the environment; this output format\n-is automatically enabled when I/O Limits (\\fB-i\\fR option) are requested\n+is automatically enabled when I/O Limits (\\fB-i\\fR option) are requested.\n+\n+The non-printing characters are encoded by ^ and M- notation and all\n+potentially unsafe characters are escaped.\n .RE\n .TP\n .BI \\-O \" offset\""
        },
        {
          "filename": "misc-utils/blkid.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -306,7 +306,7 @@ static void print_value(int output, int num, const char *devname,\n \t\t\tprintf(\"DEVNAME=%s\\n\", devname);\n \t\tfputs(name, stdout);\n \t\tfputs(\"=\", stdout);\n-\t\tsafe_print(value, valsz, NULL);\n+\t\tsafe_print(value, valsz, \" \\\\\\\"'$`<>\");\n \t\tfputs(\"\\n\", stdout);\n \n \t} else {\n@@ -315,7 +315,7 @@ static void print_value(int output, int num, const char *devname,\n \t\tfputs(\" \", stdout);\n \t\tfputs(name, stdout);\n \t\tfputs(\"=\\\"\", stdout);\n-\t\tsafe_print(value, valsz, \"\\\"\");\n+\t\tsafe_print(value, valsz, \"\\\"\\\\\");\n \t\tfputs(\"\\\"\", stdout);\n \t}\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "23901d227c6e948a9f3a413a5f3e0ca41bc8f8fa",
            "date": "2025-01-14T09:31:58Z",
            "author_login": "karelzak"
          },
          {
            "sha": "e05e62266644ff7d0ef54e3785e33d201b08831d",
            "date": "2025-01-14T09:31:32Z",
            "author_login": "karelzak"
          },
          {
            "sha": "c94c7e0034537de5cb93c42419b6505180164045",
            "date": "2025-01-14T09:31:17Z",
            "author_login": "karelzak"
          },
          {
            "sha": "8750af9cdac8372cdc964d8d8dd71113881ce307",
            "date": "2025-01-14T09:24:35Z",
            "author_login": "karelzak"
          },
          {
            "sha": "2e269ff4bc32cb61e1d576d4f932b4027f5bc2c8",
            "date": "2025-01-09T22:57:32Z",
            "author_login": "poettering"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-77",
    "description": "Blkid in util-linux before 2.26rc-1 allows local users to execute arbitrary code.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-03-31T16:59:00.397",
    "last_modified": "2024-11-21T02:20:14.270",
    "fix_date": "2014-11-27T12:39:35Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-December/145188.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-December/146229.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2015-01/msg00035.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/11/26/21",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/71327",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1168485",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/98993",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/karelzak/util-linux/commit/89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201612-14",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-December/145188.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2014-December/146229.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2015-01/msg00035.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/11/26/21",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/71327",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1168485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/98993",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/karelzak/util-linux/commit/89e90ae7b2826110ea28c1c0eb8e7c56c3907bdc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201612-14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.835476",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "util-linux",
    "owner": "karelzak",
    "created_at": "2011-09-07T05:08:38Z",
    "updated_at": "2025-01-14T09:32:32Z",
    "pushed_at": "2025-01-14T09:32:26Z",
    "size": 226776,
    "stars": 2741,
    "forks": 1226,
    "open_issues": 351,
    "watchers": 2741,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 6113328,
      "Shell": 763897,
      "C++": 209773,
      "M4": 152334,
      "Meson": 147913,
      "Berry": 84380,
      "Yacc": 45800,
      "Makefile": 35275,
      "Python": 8511,
      "Roff": 4519,
      "Ruby": 2700,
      "Lex": 1606,
      "Perl": 528
    },
    "commit_activity": {
      "total_commits_last_year": 1054,
      "avg_commits_per_week": 20.26923076923077,
      "days_active_last_year": 252
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:40:29.403786"
  }
}