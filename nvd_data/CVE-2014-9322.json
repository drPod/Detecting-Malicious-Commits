{
  "cve_id": "CVE-2014-9322",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "6f442be2fb22be02cafa606f1769fa1e6f894441",
    "related_commits": [
      "6f442be2fb22be02cafa606f1769fa1e6f894441",
      "6f442be2fb22be02cafa606f1769fa1e6f894441"
    ],
    "patch_url": "https://github.com/torvalds/linux/commit/6f442be2fb22be02cafa606f1769fa1e6f894441.patch",
    "fix_commit_details": {
      "sha": "6f442be2fb22be02cafa606f1769fa1e6f894441",
      "commit_date": "2014-11-23T02:00:32Z",
      "author": {
        "login": "amluto",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "x86_64, traps: Stop using IST for #SS",
        "length": 775,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 8,
        "deletions": 26
      },
      "files": [
        {
          "filename": "arch/x86/include/asm/page_32_types.h",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -20,7 +20,6 @@\n #define THREAD_SIZE_ORDER\t1\n #define THREAD_SIZE\t\t(PAGE_SIZE << THREAD_SIZE_ORDER)\n \n-#define STACKFAULT_STACK 0\n #define DOUBLEFAULT_STACK 1\n #define NMI_STACK 0\n #define DEBUG_STACK 0"
        },
        {
          "filename": "arch/x86/include/asm/page_64_types.h",
          "status": "modified",
          "additions": 5,
          "deletions": 6,
          "patch": "@@ -14,12 +14,11 @@\n #define IRQ_STACK_ORDER 2\n #define IRQ_STACK_SIZE (PAGE_SIZE << IRQ_STACK_ORDER)\n \n-#define STACKFAULT_STACK 1\n-#define DOUBLEFAULT_STACK 2\n-#define NMI_STACK 3\n-#define DEBUG_STACK 4\n-#define MCE_STACK 5\n-#define N_EXCEPTION_STACKS 5  /* hw limit: 7 */\n+#define DOUBLEFAULT_STACK 1\n+#define NMI_STACK 2\n+#define DEBUG_STACK 3\n+#define MCE_STACK 4\n+#define N_EXCEPTION_STACKS 4  /* hw limit: 7 */\n \n #define PUD_PAGE_SIZE\t\t(_AC(1, UL) << PUD_SHIFT)\n #define PUD_PAGE_MASK\t\t(~(PUD_PAGE_SIZE-1))"
        },
        {
          "filename": "arch/x86/include/asm/traps.h",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -39,6 +39,7 @@ asmlinkage void simd_coprocessor_error(void);\n \n #ifdef CONFIG_TRACING\n asmlinkage void trace_page_fault(void);\n+#define trace_stack_segment stack_segment\n #define trace_divide_error divide_error\n #define trace_bounds bounds\n #define trace_invalid_op invalid_op"
        },
        {
          "filename": "arch/x86/kernel/dumpstack_64.c",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -24,7 +24,6 @@ static char x86_stack_ids[][8] = {\n \t\t[ DEBUG_STACK-1\t\t\t]\t= \"#DB\",\n \t\t[ NMI_STACK-1\t\t\t]\t= \"NMI\",\n \t\t[ DOUBLEFAULT_STACK-1\t\t]\t= \"#DF\",\n-\t\t[ STACKFAULT_STACK-1\t\t]\t= \"#SS\",\n \t\t[ MCE_STACK-1\t\t\t]\t= \"#MC\",\n #if DEBUG_STKSZ > EXCEPTION_STKSZ\n \t\t[ N_EXCEPTION_STACKS ..."
        },
        {
          "filename": "arch/x86/kernel/entry_64.S",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1259,7 +1259,7 @@ apicinterrupt3 HYPERVISOR_CALLBACK_VECTOR \\\n \n idtentry debug do_debug has_error_code=0 paranoid=1 shift_ist=DEBUG_STACK\n idtentry int3 do_int3 has_error_code=0 paranoid=1 shift_ist=DEBUG_STACK\n-idtentry stack_segment do_stack_segment has_error_code=1 paranoid=1\n+idtentry stack_segment do_stack_segment has_error_code=1\n #ifdef CONFIG_XEN\n idtentry xen_debug do_debug has_error_code=0\n idtentry xen_int3 do_int3 has_error_code=0"
        },
        {
          "filename": "arch/x86/kernel/traps.c",
          "status": "modified",
          "additions": 1,
          "deletions": 17,
          "patch": "@@ -233,27 +233,11 @@ DO_ERROR(X86_TRAP_UD,     SIGILL,  \"invalid opcode\",\t\tinvalid_op)\n DO_ERROR(X86_TRAP_OLD_MF, SIGFPE,  \"coprocessor segment overrun\",coprocessor_segment_overrun)\n DO_ERROR(X86_TRAP_TS,     SIGSEGV, \"invalid TSS\",\t\tinvalid_TSS)\n DO_ERROR(X86_TRAP_NP,     SIGBUS,  \"segment not present\",\tsegment_not_present)\n-#ifdef CONFIG_X86_32\n DO_ERROR(X86_TRAP_SS,     SIGBUS,  \"stack segment\",\t\tstack_segment)\n-#endif\n DO_ERROR(X86_TRAP_AC,     SIGBUS,  \"alignment check\",\t\talignment_check)\n \n #ifdef CONFIG_X86_64\n /* Runs on IST stack */\n-dotraplinkage void do_stack_segment(struct pt_regs *regs, long error_code)\n-{\n-\tenum ctx_state prev_state;\n-\n-\tprev_state = exception_enter();\n-\tif (notify_die(DIE_TRAP, \"stack segment\", regs, error_code,\n-\t\t       X86_TRAP_SS, SIGBUS) != NOTIFY_STOP) {\n-\t\tpreempt_conditional_sti(regs);\n-\t\tdo_trap(X86_TRAP_SS, SIGBUS, \"stack segment\", regs, error_code, NULL);\n-\t\tpreempt_conditional_cli(regs);\n-\t}\n-\texception_exit(prev_state);\n-}\n-\n dotraplinkage void do_double_fault(struct pt_regs *regs, long error_code)\n {\n \tstatic const char str[] = \"double fault\";\n@@ -802,7 +786,7 @@ void __init trap_init(void)\n \tset_intr_gate(X86_TRAP_OLD_MF, coprocessor_segment_overrun);\n \tset_intr_gate(X86_TRAP_TS, invalid_TSS);\n \tset_intr_gate(X86_TRAP_NP, segment_not_present);\n-\tset_intr_gate_ist(X86_TRAP_SS, &stack_segment, STACKFAULT_STACK);\n+\tset_intr_gate(X86_TRAP_SS, stack_segment);\n \tset_intr_gate(X86_TRAP_GP, general_protection);\n \tset_intr_gate(X86_TRAP_SPURIOUS, spurious_interrupt_bug);\n \tset_intr_gate(X86_TRAP_MF, coprocessor_error);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c3812b15000cc5b7b17c7238f8b12f6a22df0b1d",
            "date": "2025-01-14T18:07:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "79a1d390f879563119bf2848b621bc7eed228c7d",
            "date": "2025-01-14T17:54:57Z",
            "author_login": "torvalds"
          },
          {
            "sha": "c45323b7560ec87c37c729b703c86ee65f136d75",
            "date": "2025-01-13T17:03:18Z",
            "author_login": "torvalds"
          },
          {
            "sha": "34c8e74cd6667ef5da90d448a1af702c4b873bd3",
            "date": "2025-01-13T08:52:08Z",
            "author_login": "YageGeng"
          },
          {
            "sha": "cbc5dde0a461240046e8a41c43d7c3b76d5db952",
            "date": "2025-01-10T15:28:21Z",
            "author_login": "rikvanriel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-269",
    "description": "arch/x86/kernel/entry_64.S in the Linux kernel before 3.17.5 does not properly handle faults associated with the Stack Segment (SS) segment register, which allows local users to gain privileges by triggering an IRET instruction that leads to access to a GS Base address from the wrong space.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2014-12-17T11:59:02.383",
    "last_modified": "2024-11-21T02:20:37.153",
    "fix_date": "2014-11-23T02:00:32Z"
  },
  "references": [
    {
      "url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=6f442be2fb22be02cafa606f1769fa1e6f894441",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2015-03/msg00025.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2015-04/msg00015.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2015-04/msg00020.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://marc.info/?l=bugtraq&m=142722450701342&w=2",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://marc.info/?l=bugtraq&m=142722544401658&w=2",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://osvdb.org/show/osvdb/115919",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-1998.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-2008.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-2028.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-2031.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2015-0009.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/62336",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://source.android.com/security/bulletin/2016-04-02.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.exploit-db.com/exploits/36266",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/12/15/6",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2491-1",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.zerodayinitiative.com/advisories/ZDI-16-170",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1172806",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/6f442be2fb22be02cafa606f1769fa1e6f894441",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://help.joyent.com/entries/98788667-Security-Advisory-ZDI-CAN-3263-ZDI-CAN-3284-and-ZDI-CAN-3364-Vulnerabilities",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.17.5",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=6f442be2fb22be02cafa606f1769fa1e6f894441",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2015-03/msg00025.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2015-04/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2015-04/msg00020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://marc.info/?l=bugtraq&m=142722450701342&w=2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://marc.info/?l=bugtraq&m=142722544401658&w=2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://osvdb.org/show/osvdb/115919",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-1998.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-2008.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-2028.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2014-2031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2015-0009.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://secunia.com/advisories/62336",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://source.android.com/security/bulletin/2016-04-02.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.exploit-db.com/exploits/36266",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/12/15/6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2491-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.zerodayinitiative.com/advisories/ZDI-16-170",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1172806",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/6f442be2fb22be02cafa606f1769fa1e6f894441",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://help.joyent.com/entries/98788667-Security-Advisory-ZDI-CAN-3263-ZDI-CAN-3284-and-ZDI-CAN-3364-Vulnerabilities",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.17.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:30.054222",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-14T12:39:03Z",
    "pushed_at": "2025-01-13T17:27:04Z",
    "size": 5361369,
    "stars": 185823,
    "forks": 54743,
    "open_issues": 437,
    "watchers": 185823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1326937103,
      "Assembly": 9568292,
      "Shell": 5072004,
      "Python": 2974128,
      "Makefile": 2713905,
      "Perl": 1253637,
      "Rust": 807711,
      "Roff": 202277,
      "C++": 173382,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71321,
      "Awk": 69539,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10172,
      "M4": 3329,
      "MATLAB": 2482,
      "sed": 2433,
      "Clojure": 2411,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 46007,
      "avg_commits_per_week": 884.75,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:59.486675"
  }
}