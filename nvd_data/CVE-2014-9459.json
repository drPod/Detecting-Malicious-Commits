{
  "cve_id": "CVE-2014-9459",
  "github_data": {
    "repository": "e107inc/e107",
    "fix_commit": "9249f892b1e635979db2a830393694fb73531080",
    "related_commits": [
      "9249f892b1e635979db2a830393694fb73531080",
      "9249f892b1e635979db2a830393694fb73531080"
    ],
    "patch_url": "https://github.com/e107inc/e107/commit/9249f892b1e635979db2a830393694fb73531080.patch",
    "fix_commit_details": {
      "sha": "9249f892b1e635979db2a830393694fb73531080",
      "commit_date": "2014-12-27T20:02:12Z",
      "author": {
        "login": "CaMer0n",
        "type": "User",
        "stats": {
          "total_commits": 8048,
          "average_weekly_commits": 8.50739957716702,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 634
        }
      },
      "commit_message": {
        "title": "Added additional check prior to administrator status change.",
        "length": 60,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 27,
        "additions": 21,
        "deletions": 6
      },
      "files": [
        {
          "filename": "e107_admin/users.php",
          "status": "modified",
          "additions": 14,
          "deletions": 6,
          "patch": "@@ -695,15 +695,23 @@ public function AdminObserver()\n \t\t\t$this->redirect('list', 'main', true);\r\n \t\t}\r\n \t\t\r\n-\t\tif(!$sysuser->isAdmin())\r\n+\t\r\n+\t\tif($this->getPosted('update_admin'))\r\n+\t\t{\r\n+\t\t\t e107::getUserPerms()->updatePerms($userid, $_POST['perms']);\r\n+\t\t\t $this->redirect('list', 'main', true);\r\n+\t\t}\r\n+\t\t\r\n+\t\tif(!$sysuser->isAdmin()) // Security Check Only. Admin status check is added during 'updatePerms'. \r\n \t\t{\r\n-\t\t\t$sysuser->set('user_admin', 1)->save(); //\"user\",\"user_admin='1' WHERE user_id={$userid}\"\r\n-\t\t\t$lan = str_replace(array('--UID--', '--NAME--', '--EMAIL--'), array($sysuser->getId(), $sysuser->getName(), $sysuser->getValue('email')), USRLAN_164);\r\n-\t\t\te107::getLog()->add('USET_08', $lan, E_LOG_INFORMATIVE);\r\n-\t\t\t$mes->addSuccess($lan);\r\n+\t\t//\t$sysuser->set('user_admin', 1)->save(); //\"user\",\"user_admin='1' WHERE user_id={$userid}\"\r\n+\t\t//\t$lan = str_replace(array('--UID--', '--NAME--', '--EMAIL--'), array($sysuser->getId(), $sysuser->getName(), $sysuser->getValue('email')), USRLAN_164);\r\n+\t\t//\te107::getLog()->add('USET_08', $lan, E_LOG_INFORMATIVE);\r\n+\t\t//\t$mes->addSuccess($lan);\r\n+\t\t\t$mes->addWarning(\"You are about to make User #<b>\".$sysuser->getId().\"</b> : <b>\".$sysuser->getName().\"</b> (\".$sysuser->getValue('email').\") an <b>administrator</b>.\"); ///TODO LAN\r\n+\t\t\t$mes->addWarning(\"Set the permissions and click <b>Update</b> to proceed or <b>Back</b> to abort.\");\r\n \t\t}\r\n \t\t\r\n-\t\tif($this->getPosted('update_admin')) e107::getUserPerms()->updatePerms($userid, $_POST['perms']);\r\n \t}\r\n \t\r\n \t/**\r"
        },
        {
          "filename": "e107_handlers/user_handler.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -1598,6 +1598,13 @@ function updatePerms($uid, $permArray)\n \t \t}\n \t\t\n \t\t//$sql->db_Update(\"user\", \"user_perms='{$perm}' WHERE user_id='{$modID}' \") \n+\t\tif(!$sysuser->isAdmin())\n+\t\t{\n+\t\t\t$sysuser->set('user_admin', 1)->save();\n+\t\t\t$lan = str_replace(array('--UID--', '--NAME--', '--EMAIL--'), array($sysuser->getId(), $sysuser->getName(), $sysuser->getValue('email')), USRLAN_164);\n+\t\t\te107::getLog()->add('USET_08', $lan, E_LOG_INFORMATIVE);\n+\t\t}\n+\t\t\n \t\te107::getMessage()->addAuto($sysuser->set('user_perms', $perm)->save(), 'update', sprintf(LAN_UPDATED, $tp->toDB($_POST['ad_name'])), false, false);\n \t\t$logMsg = str_replace(array('--ID--', '--NAME--'),array($modID, $a_name),ADMSLAN_72).$perm;\n \t\te107::getLog()->add('ADMIN_01',$logMsg,E_LOG_INFORMATIVE,'');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b51833b794a5fa3ff42ed748fef75b87250f9418",
            "date": "2025-01-13T23:35:28Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "6aa42ccad90cbdcc1c9e6a3933bcd7124380a1a2",
            "date": "2025-01-13T19:41:57Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "d86eeac7bc3cc714532d46eb96c3c9429d4be5fd",
            "date": "2025-01-13T19:20:05Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "73c5760cbb55bb61af60dcda02e523d2ea4c4caa",
            "date": "2025-01-10T18:48:13Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "a5f790dab1650d1bd1438ca2f46b8f958f7a2da0",
            "date": "2025-01-10T18:39:18Z",
            "author_login": "CaMer0n"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "Cross-site request forgery (CSRF) vulnerability in the AdminObserver function in e107_admin/users.php in e107 2.0 alpha2 allows remote attackers to hijack the authentication of administrators for requests that add users to the administrator group via the id parameter in an admin action.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-01-02T20:59:19.087",
    "last_modified": "2024-11-21T02:20:56.430",
    "fix_date": "2014-12-27T20:02:12Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/129751/e107-2.0-Alpha2-Cross-Site-Request-Forgery.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Dec/124",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://sroesemann.blogspot.de/2014/12/sroeadv-2014-04.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/e107inc/e107/commit/9249f892b1e635979db2a830393694fb73531080",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/129751/e107-2.0-Alpha2-Cross-Site-Request-Forgery.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Dec/124",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://sroesemann.blogspot.de/2014/12/sroeadv-2014-04.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/e107inc/e107/commit/9249f892b1e635979db2a830393694fb73531080",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:30.061293",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "e107",
    "owner": "e107inc",
    "created_at": "2012-11-16T19:49:01Z",
    "updated_at": "2025-01-13T23:35:38Z",
    "pushed_at": "2025-01-13T23:35:33Z",
    "size": 93949,
    "stars": 324,
    "forks": 213,
    "open_issues": 662,
    "watchers": 324,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 10485316,
      "JavaScript": 1136648,
      "CSS": 973571,
      "HTML": 20946,
      "Scala": 20715,
      "Clojure": 14453,
      "SaltStack": 3602,
      "SuperCollider": 3212,
      "Go": 1300,
      "BlitzBasic": 161
    },
    "commit_activity": {
      "total_commits_last_year": 110,
      "avg_commits_per_week": 2.1153846153846154,
      "days_active_last_year": 44
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:12:18.206807"
  }
}