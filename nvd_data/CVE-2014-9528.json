{
  "cve_id": "CVE-2014-9528",
  "github_data": {
    "repository": "humhub/humhub",
    "fix_commit": "febb89ab823d0bd6246c6cf460addabb6d7a01d4",
    "related_commits": [
      "febb89ab823d0bd6246c6cf460addabb6d7a01d4",
      "febb89ab823d0bd6246c6cf460addabb6d7a01d4"
    ],
    "patch_url": "https://github.com/humhub/humhub/commit/febb89ab823d0bd6246c6cf460addabb6d7a01d4.patch",
    "fix_commit_details": {
      "sha": "febb89ab823d0bd6246c6cf460addabb6d7a01d4",
      "commit_date": "2014-11-28T13:49:54Z",
      "author": {
        "login": "luke-",
        "type": "User",
        "stats": {
          "total_commits": 4669,
          "average_weekly_commits": 8.176882661996498,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 497
        }
      },
      "commit_message": {
        "title": "Added option to flush log entries",
        "length": 33,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 31,
        "additions": 23,
        "deletions": 8
      },
      "files": [
        {
          "filename": "protected/extensions/CmsInput.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -164,7 +164,7 @@ public function cleanEncode($str)\n      */\n     public function stripClean($str)\n     {\n-        return $this->xssClean($this->stripTags($str));\n+        return $this->stripTags($this->xssClean($str));\n     }\n     \n     /**"
        },
        {
          "filename": "protected/modules_core/admin/controllers/LoggingController.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -82,4 +82,11 @@ public function actionIndex()\n         ));\n     }\n \n+    public function actionFlush()\n+    {\n+        $this->forcePostRequest();\n+        Logging::model()->deleteAll();\n+        $this->redirect($this->createUrl('index'));\n+    }\n+\n }"
        },
        {
          "filename": "protected/modules_core/admin/views/logging/index.php",
          "status": "modified",
          "additions": 12,
          "deletions": 5,
          "patch": "@@ -2,13 +2,16 @@\n     <div class=\"panel-heading\"><?php echo Yii::t('AdminModule.views_logging_index', '<strong>Error</strong> logging'); ?></div>\n     <div class=\"panel-body\">\n \n+        \n         <div>\n             <?php echo Yii::t('AdminModule.views_logging_index', 'Total {count} entries found.', array(\"{count}\" => $itemCount)); ?>\n-            <span\n-                class=\"pull-right\"><?php echo Yii::t('AdminModule.views_logging_index', 'Displaying {count} entries per page.', array(\"{count}\" => $pageSize)); ?></span>\n+            \n+            <span class=\"pull-right\"><?php echo Yii::t('AdminModule.views_logging_index', 'Displaying {count} entries per page.', array(\"{count}\" => $pageSize)); ?></span>\n         </div>\n \n         <hr>\n+        \n+        \n \n         <ul class=\"media-list\">\n             <?php foreach ($entries as $entry) : ?>\n@@ -28,17 +31,21 @@ class=\"pull-right\"><?php echo Yii::t('AdminModule.views_logging_index', 'Display\n                         ?>\n \n                         <h4 class=\"media-heading\">\n-                            <span class=\"label <?php echo $labelClass; ?>\"><?php echo $entry->level; ?></span>&nbsp;\n+                            <span class=\"label <?php echo $labelClass; ?>\"><?php echo CHtml::encode($entry->level); ?></span>&nbsp;\n                             <?php echo date('r', $entry->logtime); ?>&nbsp;\n-                            <span class=\"pull-right\"><?php echo $entry->category; ?></span>\n+                            <span class=\"pull-right\"><?php echo CHtml::encode($entry->category); ?></span>\n                         </h4>\n-                        <?php echo $entry->message; ?>\n+                        <?php echo CHtml::encode($entry->message); ?>\n                     </div>\n                 </li>\n \n             <?php endforeach; ?>\n         </ul>\n \n+        <?php if ($itemCount != 0): ?>\n+            <div class=\"pull-right\"><?php echo HHtml::postLink('Flush entries', array('flush'), array('class'=>'btn btn-danger')); ?></div>\n+        <?php endif; ?>\n+    \n \n         <center>\n             <?php"
        },
        {
          "filename": "protected/modules_core/notification/controllers/ListController.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -43,13 +43,14 @@ public function actionIndex()\n     {\n \n         // the id from the last entry loaded\n-        $lastEntryId = Yii::app()->request->getParam('from');\n+        $lastEntryId = (int) Yii::app()->request->getParam('from');\n \n         // create database query\n         $criteria = new CDbCriteria();\n         if ($lastEntryId > 0) {\n             // start from last entry id loaded\n-            $criteria->condition = 'id<' . $lastEntryId;\n+            $criteria->condition = 'id<:lastEntryId';\n+            $criteria->params = array(':lastEntryId' => $lastEntryId);\n         }\n         $criteria->order = 'seen ASC, created_at DESC';\n         $criteria->limit = 6;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e31c77d60325f94a09f7ede4fb1570df4c1c59fa",
            "date": "2025-01-14T18:33:41Z",
            "author_login": "yurabakhtin"
          },
          {
            "sha": "c238611a659890572b7dd0816c653b440f23552e",
            "date": "2025-01-13T17:57:11Z",
            "author_login": "luke-"
          },
          {
            "sha": "eecf111971696c562c3ec267b8bddcf6123f460d",
            "date": "2025-01-13T15:49:31Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "eca400bbae27560b4ebd7b416a2fd0eb168804be",
            "date": "2025-01-13T15:49:08Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "6163852d8a9f973c80be71457b0c0c6db7810244",
            "date": "2025-01-13T14:56:09Z",
            "author_login": "luke-"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-89",
    "description": "SQL injection vulnerability in the actionIndex function in protected/modules_core/notification/controllers/ListController.php in HumHub 0.10.0-rc.1 and earlier allows remote authenticated users to execute arbitrary SQL commands via the from parameter to index.php. NOTE: this can be leveraged for cross-site scripting (XSS) attacks via a request that causes an error.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-01-06T15:59:06.930",
    "last_modified": "2024-11-21T02:21:06.370",
    "fix_date": "2014-11-28T13:49:54Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/129440/Humhub-0.10.0-rc.1-Cross-Site-Scripting-SQL-Injection.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Dec/31",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.exploit-db.com/exploits/35510",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/99272",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/humhub/humhub/commit/febb89ab823d0bd6246c6cf460addabb6d7a01d4",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/129440/Humhub-0.10.0-rc.1-Cross-Site-Scripting-SQL-Injection.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2014/Dec/31",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.exploit-db.com/exploits/35510",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/99272",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/humhub/humhub/commit/febb89ab823d0bd6246c6cf460addabb6d7a01d4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:30.062081",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "humhub",
    "owner": "humhub",
    "created_at": "2014-02-10T05:31:03Z",
    "updated_at": "2025-01-13T19:59:10Z",
    "pushed_at": "2025-01-14T13:43:22Z",
    "size": 130966,
    "stars": 6359,
    "forks": 1655,
    "open_issues": 737,
    "watchers": 6359,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "PHP": 13110954,
      "JavaScript": 538306,
      "CSS": 240453,
      "Less": 166067,
      "HTML": 7117,
      "Batchfile": 1030,
      "Hack": 461
    },
    "commit_activity": {
      "total_commits_last_year": 634,
      "avg_commits_per_week": 12.192307692307692,
      "days_active_last_year": 203
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:48:09.890758"
  }
}