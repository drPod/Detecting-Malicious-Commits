{
  "cve_id": "CVE-2014-9634",
  "github_data": {
    "repository": "jenkinsci/jenkins",
    "fix_commit": "582128b9ac179a788d43c1478be8a5224dc19710",
    "related_commits": [
      "582128b9ac179a788d43c1478be8a5224dc19710",
      "582128b9ac179a788d43c1478be8a5224dc19710"
    ],
    "patch_url": "https://github.com/jenkinsci/jenkins/commit/582128b9ac179a788d43c1478be8a5224dc19710.patch",
    "fix_commit_details": {
      "sha": "582128b9ac179a788d43c1478be8a5224dc19710",
      "commit_date": "2014-10-17T02:15:56Z",
      "author": {
        "login": "kohsuke",
        "type": "User",
        "stats": {
          "total_commits": 6028,
          "average_weekly_commits": 7.748071979434448,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 472
        }
      },
      "commit_message": {
        "title": "[FIXED JENKINS-25019]",
        "length": 195,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 48,
        "additions": 42,
        "deletions": 6
      },
      "files": [
        {
          "filename": "changelog.html",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -61,6 +61,10 @@\n   <li class=bug>\n     Prevent empty file creation if file parameter is left empty.\n     (<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-3539\">issue 3539</a>)\n+  <li class=bug>\n+    Servlet containers may refuse to let us set <a href=\"https://www.owasp.org/index.php/SecureFlag\">secure cookie flag</a>.\n+    Deal with it gracefully.\n+    (<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-25019\">issue 25019</a>)\n </ul>\n </div><!--=TRUNK-END=-->\n "
        },
        {
          "filename": "core/src/main/java/hudson/WebAppMain.java",
          "status": "modified",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -56,6 +56,7 @@\n import java.io.File;\n import java.io.FileOutputStream;\n import java.io.IOException;\n+import java.lang.reflect.Method;\n import java.net.URL;\n import java.net.URLClassLoader;\n import java.util.Date;\n@@ -116,6 +117,8 @@ public Locale get() {\n \n             installLogger();\n \n+            markCookieAsHttpOnly(context);\n+\n             final FileAndDescription describedHomeDir = getHomeDir(event);\n             home = describedHomeDir.file.getAbsoluteFile();\n             home.mkdirs();\n@@ -251,6 +254,31 @@ public void run() {\n         }\n     }\n \n+    /**\n+     * Set the session cookie as HTTP only.\n+     *\n+     * @see <a href=\"https://www.owasp.org/index.php/HttpOnly\">discussion of this topic in OWASP</a>\n+     */\n+    private void markCookieAsHttpOnly(ServletContext context) {\n+        try {\n+            Method m;\n+            try {\n+                m = context.getClass().getMethod(\"getSessionCookieConfig\");\n+            } catch (NoSuchMethodException x) { // 3.0+\n+                LOGGER.log(Level.FINE, \"Failed to set secure cookie flag\", x);\n+                return;\n+            }\n+            Object sessionCookieConfig = m.invoke(context);\n+\n+            // not exposing session cookie to JavaScript to mitigate damage caused by XSS\n+            Class scc = Class.forName(\"javax.servlet.SessionCookieConfig\");\n+            Method setHttpOnly = scc.getMethod(\"setHttpOnly\",boolean.class);\n+            setHttpOnly.invoke(sessionCookieConfig,true);\n+        } catch (Exception e) {\n+            LOGGER.log(Level.WARNING, \"Failed to set HTTP-only cookie flag\", e);\n+        }\n+    }\n+\n     public void joinInit() throws InterruptedException {\n         initThread.join();\n     }"
        },
        {
          "filename": "core/src/main/java/jenkins/model/JenkinsLocationConfiguration.java",
          "status": "modified",
          "additions": 10,
          "deletions": 6,
          "patch": "@@ -14,6 +14,7 @@\n import javax.servlet.ServletContext;\n import java.io.File;\n import java.io.IOException;\n+import java.lang.reflect.InvocationTargetException;\n import java.lang.reflect.Method;\n import java.util.logging.Level;\n import java.util.logging.Logger;\n@@ -117,14 +118,17 @@ private void updateSecureSessionFlag() {\n             }\n             Object sessionCookieConfig = m.invoke(context);\n \n-            // not exposing session cookie to JavaScript to mitigate damage caused by XSS\n             Class scc = Class.forName(\"javax.servlet.SessionCookieConfig\");\n-            Method setHttpOnly = scc.getMethod(\"setHttpOnly\",boolean.class);\n-            setHttpOnly.invoke(sessionCookieConfig,true);\n-\n-            Method setSecure = scc.getMethod(\"setSecure\",boolean.class);\n+            Method setSecure = scc.getMethod(\"setSecure\", boolean.class);\n             boolean v = fixNull(jenkinsUrl).startsWith(\"https\");\n-            setSecure.invoke(sessionCookieConfig,v);\n+            setSecure.invoke(sessionCookieConfig, v);\n+        } catch (InvocationTargetException e) {\n+            if (e.getTargetException() instanceof IllegalStateException) {\n+                // servlet 3.0 spec seems to prohibit this from getting set at runtime,\n+                // though Winstone is happy to accept i. see JENKINS-25019\n+                return;\n+            }\n+            LOGGER.log(Level.WARNING, \"Failed to set secure cookie flag\", e);\n         } catch (Exception e) {\n             LOGGER.log(Level.WARNING, \"Failed to set secure cookie flag\", e);\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "81af439caeefa41e70fdaa43e738e4e507413615",
            "date": "2025-01-14T16:07:47Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "6f37252727aeab611b5cae5f0605b2e2a4c1a7ad",
            "date": "2025-01-14T16:07:22Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "ab605fad8b35d3a38cdb7499175f0dd131ff8ee4",
            "date": "2025-01-14T13:40:54Z",
            "author_login": "jenkins-release-bot"
          },
          {
            "sha": "475d33c97dfd8a2e6e503672ef246694c91eda4d",
            "date": "2025-01-14T13:40:38Z",
            "author_login": "jenkins-release-bot"
          },
          {
            "sha": "e7f5953809d4d60257a6bfaaf1bc932d077a8597",
            "date": "2025-01-14T07:48:04Z",
            "author_login": "mawinter69"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-254",
    "description": "Jenkins before 1.586 does not set the secure flag on session cookies when run on Tomcat 7.0.41 or later, which makes it easier for remote attackers to capture cookies by intercepting their transmission within an HTTP session.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-12T14:29:00.253",
    "last_modified": "2024-11-21T02:21:17.830",
    "fix_date": "2014-10-17T02:15:56Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/01/22/3",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/72054",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=769682",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1185148",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/582128b9ac179a788d43c1478be8a5224dc19710",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://issues.jenkins-ci.org/browse/JENKINS-25019",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jenkins.io/changelog-old/",
      "source": "secalert@redhat.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/01/22/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/72054",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=769682",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1185148",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/582128b9ac179a788d43c1478be8a5224dc19710",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://issues.jenkins-ci.org/browse/JENKINS-25019",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jenkins.io/changelog-old/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.357452",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jenkins",
    "owner": "jenkinsci",
    "created_at": "2010-11-22T21:21:23Z",
    "updated_at": "2025-01-14T11:56:32Z",
    "pushed_at": "2025-01-14T07:48:05Z",
    "size": 162004,
    "stars": 23472,
    "forks": 8877,
    "open_issues": 74,
    "watchers": 23472,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable-1.625",
      "stable-1.642",
      "stable-1.651",
      "stable-2.7",
      "stable-2.19",
      "stable-2.32",
      "stable-2.46",
      "stable-2.60",
      "stable-2.73",
      "stable-2.89",
      "stable-2.107",
      "stable-2.121",
      "stable-2.138",
      "stable-2.150",
      "stable-2.164",
      "stable-2.176",
      "stable-2.190",
      "stable-2.204",
      "stable-2.222",
      "stable-2.235",
      "stable-2.249",
      "stable-2.263",
      "stable-2.277",
      "stable-2.289",
      "stable-2.302"
    ],
    "languages": {
      "Java": 12325164,
      "HTML": 970700,
      "JavaScript": 398710,
      "SCSS": 330642,
      "Groovy": 68802,
      "CSS": 41768,
      "Ruby": 17290,
      "Perl": 16145,
      "Handlebars": 14958,
      "Python": 4925,
      "ANTLR": 4633,
      "Shell": 2872,
      "C": 2091,
      "Batchfile": 1023,
      "Dockerfile": 210
    },
    "commit_activity": {
      "total_commits_last_year": 1355,
      "avg_commits_per_week": 26.057692307692307,
      "days_active_last_year": 302
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:17:56.125951"
  }
}