{
  "cve_id": "CVE-2014-9682",
  "github_data": {
    "repository": "skoranga/node-dns-sync",
    "fix_commit": "d9abaae384b198db1095735ad9c1c73d7b890a0d",
    "related_commits": [
      "d9abaae384b198db1095735ad9c1c73d7b890a0d",
      "d9abaae384b198db1095735ad9c1c73d7b890a0d"
    ],
    "patch_url": "https://github.com/skoranga/node-dns-sync/commit/d9abaae384b198db1095735ad9c1c73d7b890a0d.patch",
    "fix_commit_details": {
      "sha": "d9abaae384b198db1095735ad9c1c73d7b890a0d",
      "commit_date": "2014-11-10T23:44:07Z",
      "author": {
        "login": "skoranga",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "adding validation check for hostname",
        "length": 36,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 32,
        "additions": 25,
        "deletions": 7
      },
      "files": [
        {
          "filename": "lib/dns-sync.js",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -6,15 +6,27 @@ var net = require('net'),\n     shell = require('shelljs'),\n     debug = require('debug')('dns-sync');\n \n+//source - http://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address\n+var ValidHostnameRegex = new RegExp(\"^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$\");\n+\n+function isValidHostName(hostname) {\n+    return ValidHostnameRegex.test(hostname);\n+}\n /**\n  * Resolve hostname to IP address,\n  * returns null in case of error\n  */\n module.exports = {\n     resolve: function resolve(hostname) {\n         var output,\n-            nodeBinary = process.execPath,\n-            scriptPath = path.join(__dirname, \"../scripts/dns-lookup-script\"),\n+            nodeBinary = process.execPath;\n+\n+        if (!isValidHostName(hostname)) {\n+            console.error('Invalid hostname:', hostname);\n+            return null;\n+        }\n+\n+        var scriptPath = path.join(__dirname, \"../scripts/dns-lookup-script\"),\n             response,\n             cmd = util.format('\"%s\" \"%s\" %s', nodeBinary, scriptPath, hostname);\n "
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"dns-sync\",\n-  \"version\": \"0.1.0\",\n+  \"version\": \"0.1.1\",\n   \"description\": \"dns-sync\",\n   \"main\": \"index.js\",\n   \"scripts\": {\n@@ -20,11 +20,11 @@\n   \"license\": \"MIT\",\n   \"readmeFilename\": \"README.md\",\n   \"dependencies\": {\n-    \"debug\" : \"~0.7\",\n-    \"shelljs\": \"~0.2\"\n+    \"debug\" : \"^2\",\n+    \"shelljs\": \"~0.3\"\n   },\n   \"devDependencies\": {\n-    \"mocha\" : \"~1\",\n-    \"jshint\" : \"*\"\n+    \"mocha\" : \"^1\",\n+    \"jshint\" : \"^2\"\n   }\n }"
        },
        {
          "filename": "test/test.js",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -16,4 +16,10 @@ describe('dns sync', function () {\n         assert.ok(!dnsSync.resolve('www.not-google.first'));\n         assert.ok(!dnsSync.resolve('www.hello-yahoo.next'));\n     });\n+\n+    it('should fail to resolve valid dns', function () {\n+        assert.ok(!dnsSync.resolve(\"$(id > /tmp/foo)'\"));\n+        assert.ok(!dnsSync.resolve(\"cd /tmp; rm -f /tmp/echo; env 'x=() { (a)=>\\' bash -c \\\"echo date\\\"; cat /tmp/echo\"));\n+        assert.ok(!dnsSync.resolve(\"$(grep -l -z '[^)]=() {' /proc/[1-9]*/environ | cut -d/ -f3)'\"));\n+    });\n });"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2b8735816644145523e0619c58d59d557227da84",
            "date": "2020-05-20T17:10:43Z",
            "author_login": "skoranga"
          },
          {
            "sha": "cb10a5ac7913eacc031ade7d91596277f31645dc",
            "date": "2020-05-20T01:48:24Z",
            "author_login": "skoranga"
          },
          {
            "sha": "93b8034e9475ae65102dac15fffe065616fede1b",
            "date": "2019-07-26T16:45:55Z",
            "author_login": "skoranga"
          },
          {
            "sha": "983499b0b106c2b6fa9861742875a91eecc8f79d",
            "date": "2019-07-26T16:40:53Z",
            "author_login": "skoranga"
          },
          {
            "sha": "cfa0c5b89fa3a03f10b35fb9018ac8ceafc157d9",
            "date": "2016-01-21T20:19:46Z",
            "author_login": "skoranga"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-77",
    "description": "The dns-sync module before 0.1.1 for node.js allows context-dependent attackers to execute arbitrary commands via shell metacharacters in the first argument to the resolve API function.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-02-28T01:59:01.963",
    "last_modified": "2024-11-21T02:21:25.983",
    "fix_date": "2014-11-10T23:44:07Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/11/11/6",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/commit/d9abaae384b198db1095735ad9c1c73d7b890a0d",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/issues/1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2014/11/11/6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/commit/d9abaae384b198db1095735ad9c1c73d7b890a0d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/issues/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:32.420117",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "node-dns-sync",
    "owner": "skoranga",
    "created_at": "2014-03-25T02:35:19Z",
    "updated_at": "2021-02-27T06:43:11Z",
    "pushed_at": "2020-08-20T11:08:41Z",
    "size": 15,
    "stars": 7,
    "forks": 10,
    "open_issues": 3,
    "watchers": 7,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 4682
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:20:30.210901"
  }
}