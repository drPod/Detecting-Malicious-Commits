{
  "cve_id": "CVE-2014-9753",
  "github_data": {
    "repository": "atutor/ATutor",
    "fix_commit": "950a0299954e69b8742cc1f1a632f564435d4d7d",
    "related_commits": [
      "950a0299954e69b8742cc1f1a632f564435d4d7d",
      "950a0299954e69b8742cc1f1a632f564435d4d7d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "950a0299954e69b8742cc1f1a632f564435d4d7d",
      "commit_date": "2014-08-25T08:20:35Z",
      "author": {
        "login": "gbuckingham89",
        "type": "User",
        "stats": {
          "total_commits": 1,
          "average_weekly_commits": 0.0009049773755656109,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1
        }
      },
      "commit_message": {
        "title": "Added a confirmation code to auto_login URL to fix bug where anyone can login as anyone.",
        "length": 88,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
      },
      "files": [
        {
          "filename": "confirm.php",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -82,7 +82,7 @@\n \t\t\t\trequire(AT_INCLUDE_PATH.'header.inc.php');\n \t\t\t\techo \"<div class=\\\"input-form\\\">\";\n \t\t\t\trequire(AT_INCLUDE_PATH.'html/auto_enroll_list_courses.inc.php');\n-\t\t\t\techo '<p style=\"text-align:center\"><a href=\"'. $_SERVER['PHP_SELF'] . '?auto_login=1&member_id='. $id .'\">' . _AT(\"go_to_my_start_page\") . '</a></p>';\n+\t\t\t\techo '<p style=\"text-align:center\"><a href=\"'. $_SERVER['PHP_SELF'] . '?auto_login=1&member_id='. $id .'&code=' . $code .'\">' . _AT(\"go_to_my_start_page\") . '</a></p>';\n \t\t\t\techo \"</div>\";\n \t\t\t\trequire(AT_INCLUDE_PATH.'footer.inc.php');\n \t\t\t\texit;\n@@ -94,6 +94,7 @@\n \t\t\t\t// enable auto login student into \"my start page\"\n \t\t\t\t$_REQUEST[\"auto_login\"] = 1;\n \t\t\t\t$_REQUEST[\"member_id\"] = $id;\n+\t\t\t\t$_REQUEST[\"code\"] = $code;\n \t\t\t}\n \t\t} else {\n \t\t\t$msg->addError('CONFIRM_BAD');\n@@ -142,8 +143,10 @@\n \t\n \t$sql = \"SELECT M.member_id, M.login, M.preferences, M.language FROM %smembers M WHERE M.member_id=%d\";\n \t$row = queryDB($sql, array(TABLE_PREFIX, $_REQUEST[\"member_id\"]), TRUE);\n+\n+\t$code = substr(md5($e . $row['creation_date'] . $id), 0, 10);\n \t\n-\tif ($row['member_id'] != '') \n+\tif ($row['member_id'] != '' && isset($_REQUEST['code']) && $_REQUEST['code'] == $code) \n \t{\n \t\t$_SESSION['valid_user'] = true;\n \t\t$_SESSION['member_id']\t= $_REQUEST[\"member_id\"];"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "333030fcd1112208506947f266598a9c5fe9fbe6",
            "date": "2023-02-12T19:12:02Z",
            "author_login": "atutor"
          },
          {
            "sha": "0d8065412d8aa97649920cca8e359f1a9f10a11c",
            "date": "2023-02-08T20:10:02Z",
            "author_login": "alyssafoglia"
          },
          {
            "sha": "f29cd2534b9574ce223f22a6e0e8e2a9457c45a4",
            "date": "2023-02-08T18:44:59Z",
            "author_login": "alyssafoglia"
          },
          {
            "sha": "2f571d0e7fe6911442316de060697ebef6b500a9",
            "date": "2023-02-08T18:44:38Z",
            "author_login": "alyssafoglia"
          },
          {
            "sha": "44240cb64caff4907b3c4e8b5729270ad839da11",
            "date": "2023-02-08T18:42:03Z",
            "author_login": "alyssafoglia"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-287",
    "description": "confirm.php in ATutor 2.2 and earlier allows remote attackers to bypass authentication and gain access as an existing user via the auto_login parameter.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-02-11T18:15:16.277",
    "last_modified": "2024-11-21T02:21:35.647",
    "fix_date": "2014-08-25T08:20:35Z"
  },
  "references": [
    {
      "url": "http://karmainsecurity.com/KIS-2015-06",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2015/Nov/11",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://update.atutor.ca/patch/2_2/2_2-6/patch.xml",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/archive/1/536835/100/0/threaded",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/atutor/ATutor/commit/950a0299954e69b8742cc1f1a632f564435d4d7d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://karmainsecurity.com/KIS-2015-06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2015/Nov/11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://update.atutor.ca/patch/2_2/2_2-6/patch.xml",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/archive/1/536835/100/0/threaded",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/atutor/ATutor/commit/950a0299954e69b8742cc1f1a632f564435d4d7d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:39.844840",
    "processing_status": "enhanced"
  }
}