{
  "cve_id": "CVE-2014-9773",
  "github_data": {
    "repository": "atheme/atheme",
    "fix_commit": "c597156adc60a45b5f827793cd420945f47bc03b",
    "related_commits": [
      "c597156adc60a45b5f827793cd420945f47bc03b",
      "c597156adc60a45b5f827793cd420945f47bc03b"
    ],
    "patch_url": "https://github.com/atheme/atheme/commit/c597156adc60a45b5f827793cd420945f47bc03b.patch",
    "fix_commit_details": {
      "sha": "c597156adc60a45b5f827793cd420945f47bc03b",
      "commit_date": "2016-03-06T09:27:40Z",
      "author": {
        "login": "maxteufel",
        "type": "User",
        "stats": {
          "total_commits": 47,
          "average_weekly_commits": 0.051142546245919476,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 23
        }
      },
      "commit_message": {
        "title": "chanserv/flags: make Anope FLAGS compatibility an option",
        "length": 491,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 37,
        "additions": 34,
        "deletions": 3
      },
      "files": [
        {
          "filename": "modules/chanserv/flags.c",
          "status": "modified",
          "additions": 34,
          "deletions": 3,
          "patch": "@@ -17,18 +17,35 @@ DECLARE_MODULE_V1\n );\n \n static void cs_cmd_flags(sourceinfo_t *si, int parc, char *parv[]);\n+static void check_registration_keywords(hook_user_register_check_t *hdata);\n \n command_t cs_flags = { \"FLAGS\", N_(\"Manipulates specific permissions on a channel.\"),\n                         AC_NONE, 3, cs_cmd_flags, { .path = \"cservice/flags\" } };\n \n+static bool anope_flags_compat = true;\n+\n void _modinit(module_t *m)\n {\n \tservice_named_bind_command(\"chanserv\", &cs_flags);\n+\n+\tadd_bool_conf_item(\"ANOPE_FLAGS_COMPAT\", &chansvs.me->conf_table, 0, &anope_flags_compat, true);\n+\n+\thook_add_event(\"nick_can_register\");\n+\thook_add_nick_can_register(check_registration_keywords);\n+\n+\thook_add_event(\"user_can_register\");\n+\thook_add_user_can_register(check_registration_keywords);\n }\n \n void _moddeinit(module_unload_intent_t intent)\n {\n \tservice_named_unbind_command(\"chanserv\", &cs_flags);\n+\n+\thook_del_nick_can_register(check_registration_keywords);\n+\n+\thook_del_user_can_register(check_registration_keywords);\n+\n+\tdel_conf_item(\"ANOPE_FLAGS_COMPAT\", &chansvs.me->conf_table);\n }\n \n typedef struct {\n@@ -150,6 +167,20 @@ static void do_list(sourceinfo_t *si, mychan_t *mc, unsigned int flags)\n \t\tlogcommand(si, CMDLOG_GET, \"FLAGS: \\2%s\\2\", mc->name);\n }\n \n+static void check_registration_keywords(hook_user_register_check_t *hdata)\n+{\n+\tif (hdata->approved || !anope_flags_compat)\n+\t{\n+\t\treturn;\n+\t}\n+\n+\tif (!strcasecmp(hdata->account, \"LIST\") || !strcasecmp(hdata->account, \"CLEAR\") || !strcasecmp(hdata->account, \"MODIFY\"))\n+\t{\n+\t\tcommand_fail(hdata->si, fault_badparams, \"The nick \\2%s\\2 is reserved and cannot be registered.\", hdata->account);\n+\t\thdata->approved = 1;\n+\t}\n+}\n+\n /* FLAGS <channel> [user] [flags] */\n static void cs_cmd_flags(sourceinfo_t *si, int parc, char *parv[])\n {\n@@ -218,14 +249,14 @@ static void cs_cmd_flags(sourceinfo_t *si, int parc, char *parv[])\n \t *\n \t *   --nenolod\n \t */\n-\telse if (!strcasecmp(target, \"LIST\") && myentity_find_ext(target) == NULL)\n+\telse if (anope_flags_compat && !strcasecmp(target, \"LIST\") && myentity_find_ext(target) == NULL)\n \t{\n \t\tdo_list(si, mc, 0);\n \t\tfree(target);\n \n \t\treturn;\n \t}\n-\telse if (!strcasecmp(target, \"CLEAR\") && myentity_find_ext(target) == NULL)\n+\telse if (anope_flags_compat && !strcasecmp(target, \"CLEAR\") && myentity_find_ext(target) == NULL)\n \t{\n \t\tfree(target);\n \n@@ -251,7 +282,7 @@ static void cs_cmd_flags(sourceinfo_t *si, int parc, char *parv[])\n \t\tcommand_success_nodata(si, _(\"Cleared flags in \\2%s\\2.\"), mc->name);\n \t\treturn;\n \t}\n-\telse if (!strcasecmp(target, \"MODIFY\") && myentity_find_ext(target) == NULL)\n+\telse if (anope_flags_compat && !strcasecmp(target, \"MODIFY\") && myentity_find_ext(target) == NULL)\n \t{\n \t\tfree(target);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "03293e024854be0308022b2376db803a9abfb215",
            "date": "2024-12-02T02:28:04Z",
            "author_login": "alyx"
          },
          {
            "sha": "90642a613d08d4cdd93abd11af73c615c1301a0d",
            "date": "2024-12-02T02:27:28Z",
            "author_login": "alyx"
          },
          {
            "sha": "c1891b69b56176e593b3feb5beae13e9dd371d5c",
            "date": "2024-12-02T02:27:17Z",
            "author_login": "alyx"
          },
          {
            "sha": "9cb7483f4222fa26d1d9bcd714753c5e8ef518db",
            "date": "2024-11-30T15:55:36Z",
            "author_login": "SadieCat"
          },
          {
            "sha": "af366917e2a8acb69d2bcda68d50900ce037c468",
            "date": "2024-11-27T10:03:45Z",
            "author_login": "SadieCat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-284",
    "description": "modules/chanserv/flags.c in Atheme before 7.2.7 allows remote attackers to modify the Anope FLAGS behavior by registering and dropping the (1) LIST, (2) CLEAR, or (3) MODIFY keyword nicks.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-06-13T19:59:00.127",
    "last_modified": "2024-11-21T02:21:38.780",
    "fix_date": "2016-03-06T09:27:40Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-05/msg00061.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/05/02/2",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/05/03/1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/atheme/atheme/commit/c597156adc60a45b5f827793cd420945f47bc03b",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/atheme/atheme/issues/397",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-05/msg00061.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/05/02/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/05/03/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/atheme/atheme/commit/c597156adc60a45b5f827793cd420945f47bc03b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/atheme/atheme/issues/397",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:42.560180",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "atheme",
    "owner": "atheme",
    "created_at": "2011-07-27T05:05:08Z",
    "updated_at": "2024-12-26T07:25:56Z",
    "pushed_at": "2024-12-02T02:28:04Z",
    "size": 23362,
    "stars": 394,
    "forks": 173,
    "open_issues": 148,
    "watchers": 394,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/7.0",
      "release/7.1",
      "release/7.2"
    ],
    "languages": {
      "C": 3246007,
      "PHP": 221001,
      "Perl": 200946,
      "M4": 142882,
      "Makefile": 56954,
      "Shell": 50112,
      "XS": 16941,
      "Rust": 7000,
      "Ruby": 671,
      "Python": 232
    },
    "commit_activity": {
      "total_commits_last_year": 39,
      "avg_commits_per_week": 0.75,
      "days_active_last_year": 17
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T22:00:40.855893"
  }
}