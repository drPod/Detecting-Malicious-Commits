{
  "cve_id": "CVE-2014-9905",
  "github_data": {
    "repository": "inverse-inc/sogo",
    "fix_commit": "1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9",
    "related_commits": [
      "1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9",
      "3a5e44e7eb8b390b67a8f8a83030b49606956501",
      "80a09407652ec04e8c9fb6cb48e1029e69a15765",
      "c94595ea7f0f843c2d7abf25df039b2bbe707625",
      "1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9",
      "3a5e44e7eb8b390b67a8f8a83030b49606956501",
      "80a09407652ec04e8c9fb6cb48e1029e69a15765",
      "c94595ea7f0f843c2d7abf25df039b2bbe707625"
    ],
    "patch_url": "https://github.com/inverse-inc/sogo/commit/1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9.patch",
    "fix_commit_details": {
      "sha": "1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9",
      "commit_date": "2014-02-05T21:02:38Z",
      "author": {
        "login": "cgx",
        "type": "User",
        "stats": {
          "total_commits": 5550,
          "average_weekly_commits": 5.715756951596292,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 659
        }
      },
      "commit_message": {
        "title": "Escape HTML in JSON of calendar module",
        "length": 51,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 33,
        "additions": 23,
        "deletions": 10
      },
      "files": [
        {
          "filename": "NEWS",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -38,6 +38,7 @@ Bug fixes\n  - warn user when dnd failed because of a resource conflict (#1613)\n  - respect the maximum number of bookings when viewing the freebusy information of a resource (#2560)\n  - encode HTML entities when forwarding an HTML message inline in plain text composition mode (#2411)\n+ - encode HTML entities in JSON data returned by Calendar module (#2598)\n \n 2.1.1b (2013-12-04)\n -------------------"
        },
        {
          "filename": "UI/Scheduler/UIxAppointmentEditor.m",
          "status": "modified",
          "additions": 6,
          "deletions": 5,
          "patch": "@@ -31,6 +31,7 @@\n #import <NGObjWeb/WOResponse.h>\n #import <NGObjWeb/NSException+HTTP.h>\n #import <NGExtensions/NSCalendarDate+misc.h>\n+#import <NGExtensions/NSString+misc.h>\n \n #import <NGCards/iCalAlarm.h>\n #import <NGCards/iCalCalendar.h>\n@@ -518,18 +519,18 @@ - (void) _adjustRecurrentRules\n   created_by = [event createdBy];\n \n   data = [NSDictionary dictionaryWithObjectsAndKeys:\n-                       [componentCalendar displayName], @\"calendar\",\n+                       [[componentCalendar displayName] stringByEscapingHTMLString], @\"calendar\",\n                        [event tag], @\"component\",\n                        [dateFormatter formattedDate: eventStartDate], @\"startDate\",\n                        [dateFormatter formattedTime: eventStartDate], @\"startTime\",\n                        [dateFormatter formattedDate: eventEndDate], @\"endDate\",\n                        [dateFormatter formattedTime: eventEndDate], @\"endTime\",\n                      //([event hasRecurrenceRules] ? @\"1\": @\"0\"), @\"isRecurring\",\n                        ([event isAllDay] ? @\"1\": @\"0\"), @\"isAllDay\",\n-                       [event summary], @\"summary\",\n-                       [event location], @\"location\",\n-\t\t       created_by, @\"created_by\",\n-                       [event comment], @\"description\",\n+                       [[event summary] stringByEscapingHTMLString], @\"summary\",\n+                       [[event location] stringByEscapingHTMLString], @\"location\",\n+\t\t       [created_by stringByEscapingHTMLString], @\"created_by\",\n+                       [[event comment] stringByEscapingHTMLString], @\"description\",\n                        nil];\n   \n   [result appendContentString: [data jsonRepresentation]];"
        },
        {
          "filename": "UI/Scheduler/UIxCalListingActions.m",
          "status": "modified",
          "additions": 15,
          "deletions": 4,
          "patch": "@@ -41,6 +41,7 @@\n #import <NGExtensions/NGCalendarDateRange.h>\n #import <NGExtensions/NSCalendarDate+misc.h>\n #import <NGExtensions/NSObject+Logs.h>\n+#import <NGExtensions/NSString+misc.h>\n \n #import <SOGo/SOGoDateFormatter.h>\n #import <SOGo/SOGoPermissions.h>\n@@ -55,7 +56,6 @@\n #import <Appointments/SOGoAppointmentFolders.h>\n #import <Appointments/SOGoAppointmentObject.h>\n #import <Appointments/SOGoWebAppointmentFolder.h>\n-#import <Appointments/SOGoFreeBusyObject.h>\n \n #import <UI/Common/WODirectAction+SOGo.h>\n \n@@ -310,12 +310,14 @@ - (NSArray *) _fetchFields: (NSArray *) fields\n   NSEnumerator *folders, *currentInfos;\n   SOGoAppointmentFolder *currentFolder;\n   NSMutableDictionary *newInfo;\n-  NSMutableArray *infos;\n+  NSMutableArray *infos, *newInfoForComponent;\n   NSNull *marker;\n   SOGoAppointmentFolders *clientObject;\n   SOGoUser *ownerUser;\n   NSString *owner, *role, *calendarName;\n   BOOL isErasable, folderIsRemote;\n+  id currentInfo;\n+  int i, count;\n \n   infos = [NSMutableArray array];\n   marker = [NSNull null];\n@@ -395,8 +397,17 @@ - (NSArray *) _fetchFields: (NSArray *) fields\n \t      // Possible improvement: only call _fixDates if event is recurrent\n \t      // or the view range span a daylight saving time change\n               [self _fixDates: newInfo];\n-              [infos addObject: [newInfo objectsForKeys: fields\n-                                         notFoundMarker: marker]];\n+              newInfoForComponent = [NSMutableArray arrayWithArray: [newInfo objectsForKeys: fields\n+                                                                             notFoundMarker: marker]];\n+              // Escape HTML\n+              count = [newInfoForComponent count];\n+              for (i = 0; i < count; i++)\n+                {\n+                  currentInfo = [newInfoForComponent objectAtIndex: i];\n+                  if ([currentInfo respondsToSelector: @selector (stringByEscapingHTMLString)])\n+                    [newInfoForComponent replaceObjectAtIndex: i withObject: [currentInfo stringByEscapingHTMLString]];\n+                }\n+              [infos addObject: newInfoForComponent];\n             }\n         }\n     }"
        },
        {
          "filename": "UI/WebServerResources/SchedulerUI.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1783,7 +1783,7 @@ function newBaseEventDIV(eventRep, event, eventText) {\n     textDiv.addClassName(\"text\");\n     var iconSpan = createElement(\"span\", null, \"icons\");\n     textDiv.appendChild(iconSpan);\n-    textDiv.appendChild(document.createTextNode(eventText.replace(/(\\\\r)?\\\\n/g, \"<BR/>\")));\n+    textDiv.update(eventText.replace(/(\\\\r)?\\\\n/g, \"<BR/>\"));\n \n     // Add alarm and classification icons\n     if (event[9] == 1)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9941e2a04b9807dbc0a7f3dc0b4e07210a8e55f4",
            "date": "2025-01-07T17:39:02Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "b40d777a86104d08dbd8168b8e12c198a3d4321a",
            "date": "2024-12-23T14:35:14Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "70f72eb92f0f14501758a5660391aa43862e98e7",
            "date": "2024-12-23T10:18:28Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "0a828a739e10299605eaff72ffaf90a1908b54e8",
            "date": "2024-12-18T09:39:27Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "395a01ed5204c6c138e7d855370dd8acf902e6b4",
            "date": "2024-12-17T17:27:53Z",
            "author_login": "WoodySlum"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in the Web Calendar in SOGo before 2.2.0 allow remote attackers to inject arbitrary web script or HTML via the (1) title of an appointment or (2) contact fields.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-02-17T17:59:00.140",
    "last_modified": "2024-11-21T02:21:56.680",
    "fix_date": "2014-02-05T21:02:38Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/09/3",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/3a5e44e7eb8b390b67a8f8a83030b49606956501",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/80a09407652ec04e8c9fb6cb48e1029e69a15765",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/c94595ea7f0f843c2d7abf25df039b2bbe707625",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://sogo.nu/bugs/view.php?id=2598",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/09/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/1a7fc2a0e90a19dfb1fce292ae5ff53aa513ade9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/3a5e44e7eb8b390b67a8f8a83030b49606956501",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/80a09407652ec04e8c9fb6cb48e1029e69a15765",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/c94595ea7f0f843c2d7abf25df039b2bbe707625",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://sogo.nu/bugs/view.php?id=2598",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.227242",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sogo",
    "owner": "inverse-inc",
    "created_at": "2012-09-18T12:19:38Z",
    "updated_at": "2025-01-13T14:50:06Z",
    "pushed_at": "2025-01-14T10:12:13Z",
    "size": 179571,
    "stars": 1851,
    "forks": 278,
    "open_issues": 26,
    "watchers": 1851,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Objective-C": 5166699,
      "JavaScript": 1139785,
      "SCSS": 172305,
      "C": 115950,
      "Rich Text Format": 76362,
      "HTML": 75145,
      "Shell": 72483,
      "Java": 50238,
      "Makefile": 47449,
      "Perl": 32089,
      "Python": 31012,
      "CSS": 11864,
      "PHP": 3047,
      "PLSQL": 1055,
      "Mathematica": 986
    },
    "commit_activity": {
      "total_commits_last_year": 311,
      "avg_commits_per_week": 5.980769230769231,
      "days_active_last_year": 124
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:46:14.847524"
  }
}