{
  "cve_id": "CVE-2015-10014",
  "github_data": {
    "repository": "arekk/uke",
    "fix_commit": "52fd3b2d0bc16227ef57b7b98a3658bb67c1833f",
    "related_commits": [
      "52fd3b2d0bc16227ef57b7b98a3658bb67c1833f",
      "52fd3b2d0bc16227ef57b7b98a3658bb67c1833f"
    ],
    "patch_url": "https://github.com/arekk/uke/commit/52fd3b2d0bc16227ef57b7b98a3658bb67c1833f.patch",
    "fix_commit_details": {
      "sha": "52fd3b2d0bc16227ef57b7b98a3658bb67c1833f",
      "commit_date": "2015-11-17T13:30:39Z",
      "author": {
        "login": "arekk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "SQL injection possibility",
        "length": 25,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 34,
        "additions": 17,
        "deletions": 17
      },
      "files": [
        {
          "filename": "lib/uke/finder.rb",
          "status": "modified",
          "additions": 17,
          "deletions": 17,
          "patch": "@@ -49,12 +49,12 @@ def by_news\n     SQL\n     \n     sql.gsub!(':uke_import_id', @active_import.id.to_s)\n-    sql.gsub!(':lat_ne', conn.quote_string(bounds_ne['lat'].to_s))\n-    sql.gsub!(':lat_sw', conn.quote_string(bounds_sw['lat'].to_s))\n-    sql.gsub!(':lon_ne', conn.quote_string(bounds_ne['lng'].to_s))\n-    sql.gsub!(':lon_sw', conn.quote_string(bounds_sw['lng'].to_s))\n-    sql.gsub!(':lat', conn.quote_string(@location.latitude.to_s))\n-    sql.gsub!(':lon', conn.quote_string(@location.longitude.to_s))\n+    sql.gsub!(':lat_ne', conn.quote(bounds_ne['lat'].to_s))\n+    sql.gsub!(':lat_sw', conn.quote(bounds_sw['lat'].to_s))\n+    sql.gsub!(':lon_ne', conn.quote(bounds_ne['lng'].to_s))\n+    sql.gsub!(':lon_sw', conn.quote(bounds_sw['lng'].to_s))\n+    sql.gsub!(':lat', conn.quote(@location.latitude.to_s))\n+    sql.gsub!(':lon', conn.quote(@location.longitude.to_s))\n     \n     result_to_hash select_using_uke_stations_result(sql)\n   end\n@@ -77,12 +77,12 @@ def by_location\n     SQL\n \n     sql.gsub!(':uke_import_id', @active_import.id.to_s)\n-    sql.gsub!(':lat_ne', conn.quote_string(bounds_ne['lat'].to_s))\n-    sql.gsub!(':lat_sw', conn.quote_string(bounds_sw['lat'].to_s))\n-    sql.gsub!(':lon_ne', conn.quote_string(bounds_ne['lng'].to_s))\n-    sql.gsub!(':lon_sw', conn.quote_string(bounds_sw['lng'].to_s))\n-    sql.gsub!(':lat', conn.quote_string(@location.latitude.to_s))\n-    sql.gsub!(':lon', conn.quote_string(@location.longitude.to_s))\n+    sql.gsub!(':lat_ne', conn.quote(bounds_ne['lat'].to_s))\n+    sql.gsub!(':lat_sw', conn.quote(bounds_sw['lat'].to_s))\n+    sql.gsub!(':lon_ne', conn.quote(bounds_ne['lng'].to_s))\n+    sql.gsub!(':lon_sw', conn.quote(bounds_sw['lng'].to_s))\n+    sql.gsub!(':lat', conn.quote(@location.latitude.to_s))\n+    sql.gsub!(':lon', conn.quote(@location.longitude.to_s))\n \n     result_to_hash select_using_uke_stations_result(sql)\n   end\n@@ -97,7 +97,7 @@ def by_frq_range\n           WHERE (f.mhz BETWEEN :mhz_start AND :mhz_end)\n     SQL\n \n-    result_to_hash select_using_uke_stations_sql(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':mhz_start', conn.quote_string(first.to_s)).gsub(':mhz_end', conn.quote_string(last.to_s)))\n+    result_to_hash select_using_uke_stations_sql(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':mhz_start', conn.quote(first.to_s)).gsub(':mhz_end', conn.quote(last.to_s)))\n   end\n \n   def by_frq\n@@ -110,7 +110,7 @@ def by_frq\n           WHERE f.mhz = :mhz\n     SQL\n \n-    result_to_hash select_using_uke_stations_sql(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':mhz', conn.quote_string(Uke::Unifier::frq_string(@q).to_s)))\n+    result_to_hash select_using_uke_stations_sql(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':mhz', conn.quote(Uke::Unifier::frq_string(@q).to_s)))\n   end\n \n   def by_string\n@@ -121,10 +121,10 @@ def by_string\n           FROM uke_stations us\n           JOIN uke_operators uo on (uo.id = us.uke_operator_id)\n          WHERE us.uke_import_id = :uke_import_id\n-           AND (us.location LIKE '%:like%' OR us.name LIKE '%:like%' OR uo.name LIKE '%:like%')\n+           AND (us.location LIKE :like OR us.name LIKE :like OR uo.name LIKE :like)\n     SQL\n \n-    result_to_hash select_using_uke_stations_sql(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':like', conn.quote_string(@q)))\n+    result_to_hash select_using_uke_stations_sql(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':like', conn.quote('%'+@q.to_s+'%')))\n   end\n \n   def by_frq_order_by_distance\n@@ -149,7 +149,7 @@ def by_frq_order_by_distance\n         ORDER BY distance ASC\n     SQL\n \n-    result_to_hash(conn.select_all(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':lat', conn.quote_string(@location.latitude.to_s)).gsub(':lon', conn.quote_string(@location.longitude.to_s)).gsub(':mhz', conn.quote_string(Uke::Unifier::frq_string(@q).to_s))))\n+    result_to_hash(conn.select_all(sql.gsub(':uke_import_id', @active_import.id.to_s).gsub(':lat', conn.quote(@location.latitude.to_s)).gsub(':lon', conn.quote(@location.longitude.to_s)).gsub(':mhz', conn.quote(Uke::Unifier::frq_string(@q).to_s))))\n   end\n \n   private"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c160ea472e762596b1189ef8fd3973a938f8a541",
            "date": "2019-07-13T08:02:52Z",
            "author_login": "arekk"
          },
          {
            "sha": "5d820b8d78fa100d017fe44ae2123da9168d5afa",
            "date": "2019-07-13T08:01:53Z",
            "author_login": "arekk"
          },
          {
            "sha": "6429309baf41465071ab97df189ce5597edd9f40",
            "date": "2019-07-13T07:57:51Z",
            "author_login": "arekk"
          },
          {
            "sha": "774f7cda74d226dddc1aca889338a0ee479056ef",
            "date": "2019-07-13T07:44:27Z",
            "author_login": "arekk"
          },
          {
            "sha": "ff29d9b78b3c5fe69d9e2d7b7257c812bdea7c8c",
            "date": "2019-07-13T07:36:44Z",
            "author_login": "arekk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability classified as critical has been found in arekk uke. This affects an unknown part of the file lib/uke/finder.rb. The manipulation leads to sql injection. The identifier of the patch is 52fd3b2d0bc16227ef57b7b98a3658bb67c1833f. It is recommended to apply a patch to fix this issue. The identifier VDB-217485 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-05T14:15:08.610",
    "last_modified": "2024-11-21T02:24:10.663",
    "fix_date": "2015-11-17T13:30:39Z"
  },
  "references": [
    {
      "url": "https://github.com/arekk/uke/commit/52fd3b2d0bc16227ef57b7b98a3658bb67c1833f",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217485",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217485",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/arekk/uke/commit/52fd3b2d0bc16227ef57b7b98a3658bb67c1833f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.512749",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "uke",
    "owner": "arekk",
    "created_at": "2014-07-17T11:43:18Z",
    "updated_at": "2022-07-03T17:10:07Z",
    "pushed_at": "2020-02-28T22:51:20Z",
    "size": 331,
    "stars": 3,
    "forks": 0,
    "open_issues": 4,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Ruby": 57189,
      "HTML": 14902,
      "JavaScript": 8844,
      "CSS": 364
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T22:08:59.567483"
  }
}