{
  "cve_id": "CVE-2015-10026",
  "github_data": {
    "repository": "tiredtyrant/flairbot",
    "fix_commit": "5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb",
    "related_commits": [
      "5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb",
      "5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb",
      "commit_date": "2015-04-28T00:40:31Z",
      "author": {
        "login": "tiredtyrant",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Alteracoes nas queries para evitar sql injection",
        "length": 100,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 53,
        "additions": 28,
        "deletions": 25
      },
      "files": [
        {
          "filename": "flair.py",
          "status": "modified",
          "additions": 28,
          "deletions": 25,
          "patch": "@@ -9,8 +9,8 @@\n def dbLookup(msg):\n     if len(msg.split(',')) != 2:\n         #procura na lista de paises\n-        query = 'SELECT id FROM paises WHERE nome == \"%s\"' % (msg)\n-        cursor.execute(query)\n+        query = 'SELECT id FROM paises WHERE nome == ?;'\n+        cursor.execute(query,(msg,))\n         if cursor.fetchone():\n             return True\n         else:\n@@ -19,8 +19,8 @@ def dbLookup(msg):\n         cidade = msg.split(',')[0].strip()\n         estado = msg.split(',')[1].strip()\n         #check cidade pertence ao estado\n-        query = 'SELECT estados.id FROM municipios JOIN estados ON municipios.estados_id == estados.id WHERE municipios.nome == \"%s\" AND estados.uf == \"%s\";' % (cidade, estado)\n-        cursor.execute(query)\n+        query = 'SELECT estados.id FROM municipios JOIN estados ON municipios.estados_id == estados.id WHERE municipios.nome == ? AND estados.uf == ?;'\n+        cursor.execute(query,(cidade,estado))\n         if not cursor.fetchone():\n             return False\n             \n@@ -37,28 +37,31 @@ def main():\n         return\n     while True:\n         time.sleep(0.5)\n-        for msg in r.get_unread(limit=None):\n-            try:\n-                print 'AUTHOR: %s - SUBJECT: %s - BODY: %s' % (msg.author, msg.subject, msg.body)\n-            except UnicodeEncodeError:\n-                print 'AUTHOR: %s - unprintable chars' % (msg.author)\n-            sub = r.get_subreddit('brasil')\n-            if msg.subject == 'flair':\n-                if dbLookup(msg.body):\n-                    estado = 'world' if len(msg.body.split(',')) < 2 else msg.body.split(',')[1].strip()\n-                    sub.set_flair(msg.author,msg.body,estado)\n-                    r.send_message(msg.author,'flair','Flair configurado.')\n-                    print('flair ok')\n-                else:\n-                    r.send_message(msg.author,'flair','Configura\u00e7\u00e3o de flair falhou.')\n-                    print('flair fail')\n-            if msg.subject == 'remover flair':\n-                sub.set_flair(msg.author,'','')\n-                r.send_message(msg.author,'flair','Flair removido.')\n-                print('remove flair ok')\n+        try:\n+            for msg in r.get_unread(limit=None):\n+                try:\n+                    print 'AUTHOR: %s - SUBJECT: %s - BODY: %s' % (msg.author, msg.subject, msg.body)\n+                except UnicodeEncodeError:\n+                    print 'AUTHOR: %s - unprintable chars' % (msg.author)\n+                sub = r.get_subreddit('brasil')\n+                if msg.subject == 'flair':\n+                    if dbLookup(msg.body):\n+                        estado = 'world' if len(msg.body.split(',')) < 2 else msg.body.split(',')[1].strip()\n+                        sub.set_flair(msg.author,msg.body,estado)\n+                        r.send_message(msg.author,'flair','Flair configurado.')\n+                        print('flair ok')\n+                    else:\n+                        r.send_message(msg.author,'flair','Configura\u00e7\u00e3o de flair falhou.')\n+                        print('flair fail')\n+                if msg.subject == 'remover flair':\n+                    sub.set_flair(msg.author,'','')\n+                    r.send_message(msg.author,'flair','Flair removido.')\n+                    print('remove flair ok')\n                 \n-            msg.mark_as_read()\n+                msg.mark_as_read()\n+        except:\n+            pass\n \n if __name__ == '__main__':\n     main()\n-    \n\\ No newline at end of file\n+    "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "86b684f930c1cc18ae09fac418856219d8c48a79",
            "date": "2017-05-20T16:38:06Z",
            "author_login": "tiredtyrant"
          },
          {
            "sha": "ab5f322da5c01aa0527bbe80c232bb99b2fc93f6",
            "date": "2015-10-24T01:11:22Z",
            "author_login": "tiredtyrant"
          },
          {
            "sha": "5e1f0c2ce363e2ed124d01567d96e2b1241edc01",
            "date": "2015-10-23T12:36:44Z",
            "author_login": "pericololuiz"
          },
          {
            "sha": "992eec49206e4f30e60d9012854eabb4d762add2",
            "date": "2015-10-21T23:36:05Z",
            "author_login": "tiredtyrant"
          },
          {
            "sha": "6117bb99961c04c446ed596e78b408abaf5778fb",
            "date": "2015-10-21T23:35:36Z",
            "author_login": "tiredtyrant"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in tiredtyrant flairbot. It has been declared as critical. This vulnerability affects unknown code of the file flair.py. The manipulation leads to sql injection. The patch is identified as 5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb. It is recommended to apply a patch to fix this issue. VDB-217618 is the identifier assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-07T13:15:09.450",
    "last_modified": "2024-11-21T02:24:12.327",
    "fix_date": "2015-04-28T00:40:31Z"
  },
  "references": [
    {
      "url": "https://github.com/tiredtyrant/flairbot/commit/5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217618",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217618",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tiredtyrant/flairbot/commit/5e112b68c6faad1d4699d02c1ebbb7daf48ef8fb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217618",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217618",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.526058",
    "processing_status": "enhanced"
  }
}