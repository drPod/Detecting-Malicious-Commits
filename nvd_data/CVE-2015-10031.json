{
  "cve_id": "CVE-2015-10031",
  "github_data": {
    "repository": "purpleparrots/491-Project",
    "fix_commit": "a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab",
    "related_commits": [
      "a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab",
      "a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab",
      "commit_date": "2015-03-11T05:41:40Z",
      "author": {
        "login": "alpertmd",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed update.php to prevent sql injections because people are douchebags",
        "length": 72,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 43,
        "additions": 24,
        "deletions": 19
      },
      "files": [
        {
          "filename": "update.php",
          "status": "modified",
          "additions": 24,
          "deletions": 19,
          "patch": "@@ -1,28 +1,33 @@\n <?php\n-\t$name = $_GET[\"name\"];\n-\t$score = $_GET[\"score\"];\n \t\n-\t$username = \"alpertmd\";\n-\t$password = \"yofer`\";\n-\t$hostname = \"repos.insttech.washington.edu\";\n+\tif ($_SERVER['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest'){\n+\t\t$username = \"alpertmd\";\n+\t\t$password = \"yofer`\";\n+\t\t$hostname = \"repos.insttech.washington.edu\";\n \n-\t$dbhandle = mysql_connect($hostname, $username, $password) or die(\"Unable to connect to MySQL\");\n-\n-\t$selected = mysql_select_db(\"alpertmd\", $dbhandle) or die(\"Could not select high score db\");\n+\t\t$dbhandle = mysqli_connect($hostname, $username, $password) or die(\"Unable to connect to MySQL\");\n \t\n-\t$result = mysql_query(\"SELECT MAX(idHighscores) FROM Highscores\");\n-\t$id = mysql_result($result, 0) + 1;\n+\t\t$selected = mysqli_select_db($dbhandle,$username) or die(\"Could not select high score db\");\n \t\n-\t$query = \"INSERT INTO Highscores VALUES ($id, '$name', $score)\";\n-\t$result = mysql_query($query);\n-\t\t\n-\t$query = \"SELECT idHighscores FROM Highscores WHERE score = (SELECT Min(score) FROM Highscores)\";\n-\t$result = mysql_query($query);\n-\t$minID = mysql_result($result, 0);\n+\t\t$result = mysqli_query($dbhandle, \"SELECT MAX(idHighscores) FROM Highscores\");\n+\t\n+\t\t$id = mysqli_fetch_row($result)[0] + 1;\n+\t\t$name = $_POST[\"name\"];\n+\t\t$score = $_POST[\"score\"];\n \n+\t\t$query =  mysqli_prepare($dbhandle, \"INSERT INTO Highscores Values (?, ?, ?)\");\n+\t\n+\t\tmysqli_stmt_bind_param($query, 'isi', $id, $name, $score);\n+\t\tmysqli_stmt_execute($query);\n+\t\tmysqli_stmt_close($query);\n+\t\t\n+\t\t$query = \"SELECT idHighscores FROM Highscores WHERE score = (SELECT Min(score) FROM Highscores)\";\n+\t\t$result = mysqli_query($dbhandle, $query);\n+\t\t$minID = mysqli_fetch_row($result)[0];\n \n-\t$query = \"DELETE FROM Highscores WHERE idHighscores = $minID\";\n-\t$result = mysql_query($query);\n+\t\t$query = \"DELETE FROM Highscores WHERE idHighscores = $minID\";\n+\t\t$result = mysqli_query($dbhandle, $query);\n \t\n-\tmysql_close($dbhandle);\n+\t\tmysqli_close($dbhandle);\n+\t}\n ?>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0f9fc687f5c4063ad747251540f5475d17aff0aa",
            "date": "2015-03-11T20:39:35Z",
            "author_login": "purpleparrots"
          },
          {
            "sha": "b0c04c0015bc007a185a5f6b95f5b19523b3b5ce",
            "date": "2015-03-11T20:39:17Z",
            "author_login": "purpleparrots"
          },
          {
            "sha": "244bba836dae69813bbd3981e2dce6afd2e5b924",
            "date": "2015-03-11T19:26:57Z",
            "author_login": "alpertmd"
          },
          {
            "sha": "a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab",
            "date": "2015-03-11T05:41:40Z",
            "author_login": "alpertmd"
          },
          {
            "sha": "e53baf595b3f214731570a337fb84a897d1cca9c",
            "date": "2015-03-07T04:05:18Z",
            "author_login": "alpertmd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability classified as critical was found in purpleparrots 491-Project. This vulnerability affects unknown code of the file update.php of the component Highscore Handler. The manipulation leads to sql injection. The name of the patch is a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217648.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-08T17:15:17.763",
    "last_modified": "2024-11-21T02:24:13.000",
    "fix_date": "2015-03-11T05:41:40Z"
  },
  "references": [
    {
      "url": "https://github.com/purpleparrots/491-Project/commit/a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217648",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217648",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/purpleparrots/491-Project/commit/a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217648",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217648",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.531415",
    "processing_status": "enhanced"
  }
}