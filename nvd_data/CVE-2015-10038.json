{
  "cve_id": "CVE-2015-10038",
  "github_data": {
    "repository": "nym3r0s/pplv2",
    "fix_commit": "28f8b0550104044da09f04659797487c59f85b00",
    "related_commits": [
      "28f8b0550104044da09f04659797487c59f85b00",
      "28f8b0550104044da09f04659797487c59f85b00"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "28f8b0550104044da09f04659797487c59f85b00",
      "commit_date": "2015-01-22T07:16:38Z",
      "author": {
        "login": "nym3r0s",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added fix for SQL Injection",
        "length": 27,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 50,
        "additions": 28,
        "deletions": 22
      },
      "files": [
        {
          "filename": "matchday/confirm11.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,13 +1,13 @@\n <?php\n session_start();\n require './../includes/dbconfig.php';\n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user'])s;\n if(!isset($user))\n {\n     header('Location: ./../login.php');\n }\n \n-$idString = $_POST['c11'];\n+$idString = mysql_real_escape_string($_POST['c11']);\n echo($idString.\"\\n\");\n $ids = explode(',',$idString);\n sort($ids);"
        },
        {
          "filename": "matchday/index.php",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+<?php\n+    header('Location: ./matchday.php');\n+?>"
        },
        {
          "filename": "matchday/matchday.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n <?php\n session_start();\n require './../includes/dbconfig.php';\n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n if(!isset($user))\n {\n     header('Location: ./../login.php');"
        },
        {
          "filename": "matchday/playerInfo.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -4,8 +4,8 @@\n \n //echo(\"done\");\n \n-$playerId = $_POST['req'];\n-$user = $_SESSION['user'];\n+$playerId = mysql_real_escape_string($_POST['req']);\n+$user = mysql_real_escape_string($_SESSION['user']);\n \n if(!isset($user))\n {\n@@ -72,7 +72,7 @@\n \n         echo('<div class=\"row_left\"> <div><b>Country</b></div> <div><b>Player Role</b></div> <div><b>Matches</b></div> <div><b>Form</b></div> <div><b>Confidence</b></div> </div>');\n \n-\t\techo('<div class=\"row_right\"> <div>'.$playerCountry.'</div> <div>'.$playerType.'</div> <div>'.$playerMatches.'</div> <div>'.$playerForm.'</div><div>'.$playerConfidence.'</div></div>');\n+        echo('<div class=\"row_right\"> <div>'.$playerCountry.'</div> <div>'.$playerType.'</div> <div>'.$playerMatches.'</div> <div>'.$playerForm.'</div><div>'.$playerConfidence.'</div></div>');\n \n if($playerCaptain != \"\"){    echo('<div class=\"row\"><b>Captain</b></div><br>'); }\n         echo('</div>');"
        },
        {
          "filename": "matchday/squadGen.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n session_start();\n require './../includes/dbconfig.php';\n \n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n \n \n if(!isset($user))"
        },
        {
          "filename": "transfers/balance.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n session_start();\n require './../includes/dbconfig.php';\n \n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n \n \n if(!isset($user))"
        },
        {
          "filename": "transfers/confirm16.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,13 +1,13 @@\n <?php\n session_start();\n require './../includes/dbconfig.php';\n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n if(!isset($user))\n {\n     header('Location: ./../login.php');\n }\n \n-$idString = $_POST['c16'];\n+$idString = mysql_real_escape_string($_POST['c16']);\n $ids = explode(',',$idString);\n sort($ids);\n "
        },
        {
          "filename": "transfers/index.php",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+<?php\n+    header('Location: ./transfers.php');\n+?>"
        },
        {
          "filename": "transfers/playerInfo.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -4,8 +4,8 @@\n \n //echo(\"done\");\n \n-$playerId = $_POST['req'];\n-$user = $_SESSION['user'];\n+$playerId = mysql_real_escape_string($_POST['req']);\n+$user = mysql_real_escape_string($_SESSION['user']);\n \n if(!isset($user))\n {\n@@ -72,7 +72,7 @@\n \n         echo('<div class=\"row_left\"> <div><b>Country</b></div> <div><b>Player Role</b></div> <div><b>Matches</b></div> <div><b>Form</b></div> <div><b>Confidence</b></div> </div>');\n \n-\t\techo('<div class=\"row_right\"> <div>'.$playerCountry.'</div> <div>'.$playerType.'</div> <div>'.$playerMatches.'</div> <div>'.$playerForm.'</div><div>'.$playerConfidence.'</div></div>');\n+        echo('<div class=\"row_right\"> <div>'.$playerCountry.'</div> <div>'.$playerType.'</div> <div>'.$playerMatches.'</div> <div>'.$playerForm.'</div><div>'.$playerConfidence.'</div></div>');\n \n if($playerCaptain != \"\"){    echo('<div class=\"row\"><b>Captain</b></div><br>'); }\n         echo('</div>');"
        },
        {
          "filename": "transfers/playersGen.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n session_start();\n require './../includes/dbconfig.php';\n \n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n \n \n if(!isset($user))"
        },
        {
          "filename": "transfers/remainingTransfers.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n <?php\n session_start();\n require './../includes/dbconfig.php';\n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n if(!isset($user))\n {\n     header('Location: ./../login.php');"
        },
        {
          "filename": "transfers/transfers.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -1,7 +1,7 @@\n <?php\n session_start();\n require './../includes/dbconfig.php';\n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n if(!isset($user))\n {\n     header('Location: ./../login.php');\n@@ -50,11 +50,11 @@\n     </nav>\n \n <!-- Nav  Ends here-->\n-\t<div class=\"transferDetails\">\n-\t\t<div id=\"playerBalance\"></div>\n-\t\t<div id=\"transferBalance\"></div>\n-\t</div>\n-\t\t\n+    <div class=\"transferDetails\">\n+        <div id=\"playerBalance\"></div>\n+        <div id=\"transferBalance\"></div>\n+    </div>\n+\n     <div id=\"switches\">\n         <div class=\"btn-group\" role=\"group\" aria-label=\"...\">\n             <div class=\"btn-group\" role=\"group\">"
        },
        {
          "filename": "transfers/userGen.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n session_start();\n require './../includes/dbconfig.php';\n \n-$user = $_SESSION['user'];\n+$user = mysql_real_escape_string($_SESSION['user']);\n \n \n if(!isset($user))"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fac6495c86d07771fd64b578d07e0bc917a74c2e",
            "date": "2015-06-04T10:41:08Z",
            "author_login": "nym3r0s"
          },
          {
            "sha": "d7a52417c97477ba967e386cadb18da87f38bc69",
            "date": "2015-02-12T17:58:22Z",
            "author_login": "sarweshkrishnan"
          },
          {
            "sha": "a4fafd78cd28288041a6459ace63ef7c3ba01f2f",
            "date": "2015-02-12T16:25:57Z",
            "author_login": "nym3r0s"
          },
          {
            "sha": "4c15df5bdfbcc5f381dec6f8e78d3788e9ac80b8",
            "date": "2015-02-12T19:39:40Z",
            "author_login": "sarweshkrishnan"
          },
          {
            "sha": "020771b1e1d5c27c91f08c56a87e0f67a90f7cba",
            "date": "2015-02-11T21:21:38Z",
            "author_login": "sarweshkrishnan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in nym3r0s pplv2. It has been declared as critical. Affected by this vulnerability is an unknown functionality. The manipulation leads to sql injection. The patch is named 28f8b0550104044da09f04659797487c59f85b00. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218023.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-11T19:15:09.270",
    "last_modified": "2024-11-21T02:24:13.920",
    "fix_date": "2015-01-22T07:16:38Z"
  },
  "references": [
    {
      "url": "https://github.com/nym3r0s/pplv2/commit/28f8b0550104044da09f04659797487c59f85b00",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218023",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218023",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nym3r0s/pplv2/commit/28f8b0550104044da09f04659797487c59f85b00",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218023",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218023",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.542437",
    "processing_status": "enhanced"
  }
}