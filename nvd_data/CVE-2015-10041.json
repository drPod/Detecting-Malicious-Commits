{
  "cve_id": "CVE-2015-10041",
  "github_data": {
    "repository": "Dovgalyuk/AIBattle-disabled-",
    "fix_commit": "e3aa4d0900167641d41cbccf53909229f00381c9",
    "related_commits": [
      "e3aa4d0900167641d41cbccf53909229f00381c9",
      "e3aa4d0900167641d41cbccf53909229f00381c9"
    ],
    "patch_url": "https://github.com/Dovgalyuk/AIBattle-disabled-/commit/e3aa4d0900167641d41cbccf53909229f00381c9.patch",
    "fix_commit_details": {
      "sha": "e3aa4d0900167641d41cbccf53909229f00381c9",
      "commit_date": "2015-08-11T07:53:31Z",
      "author": {
        "login": "Dovgalyuk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix SQL injection in comments",
        "length": 29,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 1,
        "additions": 1,
        "deletions": 0
      },
      "files": [
        {
          "filename": "site/procedures.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1811,6 +1811,7 @@ function sendComments($newsId, $text)\n \t\t{\n \t\t\t$newsId \t\t= intval($newsId);\n \t\t\t$currentUserId \t= intval(getActiveUserID());\n+\t\t\t$text = mysqli_real_escape_string($link, $text);\n \t\t\tif ($currentUserId != -1)\n \t\t\t{\n \t\t\t\t$query = mysqli_query($link, \"INSERT INTO newsComments SET news = $newsId, user = $currentUserId, text = '$text', date = NOW()\");"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c4a391cd52b85fef02c7f3ad6141a8ce262e0135",
            "date": "2015-10-29T13:24:07Z",
            "author_login": "tsarn"
          },
          {
            "sha": "ec7f272fe819221682af7f36a460321914561d36",
            "date": "2015-10-28T17:26:39Z",
            "author_login": "tsarn"
          },
          {
            "sha": "39b65a2ab3600949990ed52400cdf4c7a88e703b",
            "date": "2015-10-28T16:24:54Z",
            "author_login": "tsarn"
          },
          {
            "sha": "ed55ae3e9597eae544a2c534b67b5c44cf0fc6b6",
            "date": "2015-10-28T16:05:11Z",
            "author_login": "tsarn"
          },
          {
            "sha": "42b028a50d02623e006269e011886b21e9be97fb",
            "date": "2015-10-28T15:59:08Z",
            "author_login": "tsarn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as critical has been found in Dovgalyuk AIBattle. Affected is the function sendComments of the file site/procedures.php. The manipulation of the argument text leads to sql injection. The name of the patch is e3aa4d0900167641d41cbccf53909229f00381c9. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-218304. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-13T20:15:09.837",
    "last_modified": "2024-11-21T02:24:14.367",
    "fix_date": "2015-08-11T07:53:31Z"
  },
  "references": [
    {
      "url": "https://github.com/Dovgalyuk/AIBattle-disabled-/commit/e3aa4d0900167641d41cbccf53909229f00381c9",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218304",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218304",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Dovgalyuk/AIBattle-disabled-/commit/e3aa4d0900167641d41cbccf53909229f00381c9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218304",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218304",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.551017",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "AIBattle-disabled-",
    "owner": "Dovgalyuk",
    "created_at": "2014-12-19T20:19:09Z",
    "updated_at": "2016-04-13T15:10:49Z",
    "pushed_at": "2015-10-29T13:24:43Z",
    "size": 2255,
    "stars": 1,
    "forks": 1,
    "open_issues": 3,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 311087,
      "C++": 198341,
      "HTML": 169228,
      "JavaScript": 53127,
      "CSS": 21911,
      "TeX": 16641,
      "CMake": 5682,
      "Pascal": 863,
      "Batchfile": 724,
      "ApacheConf": 448,
      "Shell": 399
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T20:14:29.166953"
  }
}