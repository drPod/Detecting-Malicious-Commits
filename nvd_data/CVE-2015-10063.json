{
  "cve_id": "CVE-2015-10063",
  "github_data": {
    "repository": "saemorris/TheRadSystem",
    "fix_commit": "bfba26bd34af31648a11af35a0bb66f1948752a6",
    "related_commits": [
      "bfba26bd34af31648a11af35a0bb66f1948752a6",
      "bfba26bd34af31648a11af35a0bb66f1948752a6"
    ],
    "patch_url": "https://github.com/saemorris/TheRadSystem/commit/bfba26bd34af31648a11af35a0bb66f1948752a6.patch",
    "fix_commit_details": {
      "sha": "bfba26bd34af31648a11af35a0bb66f1948752a6",
      "commit_date": "2015-04-04T00:10:40Z",
      "author": {
        "login": "ItsTristan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed some bugs and SQL injection.",
        "length": 34,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
      },
      "files": [
        {
          "filename": "_login.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -24,11 +24,12 @@ function redirect() {\n \t\trequire ('_database.php');\n \t\t$user = $_POST['user'];\n \t\t$pass = $_POST['pass'];\n-\t\t// <-- Bad.\n \n-\t\t$query = \"SELECT user_name, class, person_id FROM users WHERE user_name = '$user' AND password = '$pass'\";\n+\t\t$query = \"SELECT user_name, class, person_id FROM users WHERE user_name = :username AND password = :password\";\n \t\t\n \t\t$statement = oci_parse($connection, $query);\n+\t\toci_bind_by_name($statement, ':username', $user);\n+\t\toci_bind_by_name($statement, ':password', $pass);\n \t\t$results = oci_execute($statement);\n \n \t\t// Did we get a valid result?"
        },
        {
          "filename": "setup.sql",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -11,6 +11,7 @@ DROP TABLE users;\n DROP TABLE persons;\n DROP SEQUENCE record_id_seq;\n DROP SEQUENCE image_id_seq;\n+DROP SEQUENCE person_id_seq;\n \n /*\n  *  To store the personal information"
        },
        {
          "filename": "users.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n \t\t</p>\n \t\t<div>\n \t\t\t<form id=\"searchform\" required=\"1\" name=\"search_users\" method=\"get\" action=\"<?php $PHP_SELF ?>\" >\n-\t\t\t\t<input type=\"text\" name=\"q\" />\n+\t\t\t\t<input type=\"text\" name=\"q\" value=\"<?php echo $_GET['q']; ?>\" />\n \t\t\t\t<input type=\"submit\" value=\"Search\"  />\n \t\t\t</form>\n \t\t</div>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3400f79f45f288c3719bd88d1ac6522de6636268",
            "date": "2015-04-04T04:02:48Z",
            "author_login": "ItsTristan"
          },
          {
            "sha": "d9f28ab7bba1deba86e7c84e7203e9fc1e0b47c6",
            "date": "2015-04-04T03:56:13Z",
            "author_login": "ItsTristan"
          },
          {
            "sha": "e9a8b0d8423dfa4dbaa49a167874e4268e6c0d1e",
            "date": "2015-04-04T03:51:49Z",
            "author_login": "ItsTristan"
          },
          {
            "sha": "0229ab5d5897991b49b0b2c0aacee64b4b21251e",
            "date": "2015-04-04T03:21:00Z",
            "author_login": "ItsTristan"
          },
          {
            "sha": "de8dd4bdfb7d1bbe4949e223d129dff5550124b3",
            "date": "2015-04-04T03:18:50Z",
            "author_login": "ItsTristan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in saemorris TheRadSystem and classified as critical. This issue affects the function redirect of the file _login.php. The manipulation of the argument user/pass leads to sql injection. The attack may be initiated remotely. The identifier of the patch is bfba26bd34af31648a11af35a0bb66f1948752a6. It is recommended to apply a patch to fix this issue. The identifier VDB-218453 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-17T19:15:11.067",
    "last_modified": "2024-11-21T02:24:17.397",
    "fix_date": "2015-04-04T00:10:40Z"
  },
  "references": [
    {
      "url": "https://github.com/saemorris/TheRadSystem/commit/bfba26bd34af31648a11af35a0bb66f1948752a6",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218453",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218453",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saemorris/TheRadSystem/commit/bfba26bd34af31648a11af35a0bb66f1948752a6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218453",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218453",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.566383",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "TheRadSystem",
    "owner": "saemorris",
    "created_at": "2015-03-04T22:24:57Z",
    "updated_at": "2015-04-04T04:03:33Z",
    "pushed_at": "2015-04-04T04:03:33Z",
    "size": 748,
    "stars": 0,
    "forks": 1,
    "open_issues": 8,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 92138,
      "HTML": 11530,
      "PLSQL": 2864,
      "CSS": 1454,
      "JavaScript": 987,
      "Shell": 52
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:19:27.568831"
  }
}