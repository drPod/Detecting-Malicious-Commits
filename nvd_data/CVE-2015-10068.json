{
  "cve_id": "CVE-2015-10068",
  "github_data": {
    "repository": "danynab/movify-j",
    "fix_commit": "c3085e01936a4d7eff1eda3093f25d56cc4d2ec5",
    "related_commits": [
      "c3085e01936a4d7eff1eda3093f25d56cc4d2ec5",
      "c3085e01936a4d7eff1eda3093f25d56cc4d2ec5"
    ],
    "patch_url": "https://github.com/danynab/movify-j/commit/c3085e01936a4d7eff1eda3093f25d56cc4d2ec5.patch",
    "fix_commit_details": {
      "sha": "c3085e01936a4d7eff1eda3093f25d56cc4d2ec5",
      "commit_date": "2015-03-14T17:09:36Z",
      "author": {
        "login": "danynab",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Avoid SQL Injection",
        "length": 19,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "app/business/impl/ReviewServiceImpl.java",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1,6 +1,7 @@\n package business.impl;\n \n import business.ReviewService;\n+import com.avaje.ebean.Expr;\n import models.Review;\n import play.db.ebean.Model;\n \n@@ -22,7 +23,7 @@ public List<Review> getByMovieId(int movieId) {\n \n     @Override\n     public Review getByMovieIdAndUsername(int movieId, String username) {\n-        return find.where(\"movieId = \" + movieId + \" and username = '\" + username + \"'\").findUnique();\n+        return find.where().and(Expr.eq(\"movieId\", movieId), Expr.eq(\"username\", username)).findUnique();\n     }\n \n     @Override"
        },
        {
          "filename": "app/controllers/WebplayerController.java",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,6 +1,7 @@\n package controllers;\n \n import filters.LoginRequiredAction;\n+import filters.SubscriptionRequiredAction;\n import infrastructure.Factories;\n import models.Genre;\n import models.Movie;\n@@ -19,8 +20,7 @@\n /**\n  * Created by Dani on 14/3/15.\n  */\n-@With(LoginRequiredAction.class)\n-//@With({LoginRequiredAction.class, SubscriptionRequiredAction.class})\n+@With({LoginRequiredAction.class, SubscriptionRequiredAction.class})\n public class WebplayerController extends Controller {\n \n     public static Result showWebplayer() {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4a848f2279a13951376d64f726af86bae6919f0b",
            "date": "2015-03-15T18:26:25Z",
            "author_login": "danynab"
          },
          {
            "sha": "d50a54b75bc876ddd6c17bb76e5d232fa45d6ad5",
            "date": "2015-03-15T18:18:56Z",
            "author_login": "danynab"
          },
          {
            "sha": "b6b9dcc9da2452a7ecd64c17b21412d89ece4ecb",
            "date": "2015-03-15T13:59:16Z",
            "author_login": "danynab"
          },
          {
            "sha": "6bb786ad4af3b56e522cf5bf774993cd0d667b2c",
            "date": "2015-03-15T13:45:03Z",
            "author_login": "danynab"
          },
          {
            "sha": "dd404414913dbf68fe7fd043b50ca62d0967e27e",
            "date": "2015-03-15T03:58:05Z",
            "author_login": "danynab"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability classified as critical was found in danynab movify-j. This vulnerability affects the function getByMovieId of the file app/business/impl/ReviewServiceImpl.java. The manipulation of the argument movieId/username leads to sql injection. The name of the patch is c3085e01936a4d7eff1eda3093f25d56cc4d2ec5. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-218476.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-18T08:15:09.660",
    "last_modified": "2024-11-21T02:24:18.100",
    "fix_date": "2015-03-14T17:09:36Z"
  },
  "references": [
    {
      "url": "https://github.com/danynab/movify-j/commit/c3085e01936a4d7eff1eda3093f25d56cc4d2ec5",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218476",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218476",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/danynab/movify-j/commit/c3085e01936a4d7eff1eda3093f25d56cc4d2ec5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218476",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218476",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.571786",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "movify-j",
    "owner": "danynab",
    "created_at": "2015-03-14T01:20:33Z",
    "updated_at": "2015-03-15T18:26:31Z",
    "pushed_at": "2015-03-15T18:26:31Z",
    "size": 6352,
    "stars": 0,
    "forks": 0,
    "open_issues": 0,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 88588,
      "JavaScript": 44527,
      "HTML": 28372,
      "CSS": 17810,
      "ApacheConf": 2024,
      "Scala": 1112
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T20:01:44.453120"
  }
}