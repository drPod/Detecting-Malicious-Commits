{
  "cve_id": "CVE-2015-10070",
  "github_data": {
    "repository": "copperwall/twiddit",
    "fix_commit": "2203d4ce9810bdaccece5c48ff4888658a01acfc",
    "related_commits": [
      "2203d4ce9810bdaccece5c48ff4888658a01acfc",
      "2203d4ce9810bdaccece5c48ff4888658a01acfc"
    ],
    "patch_url": "https://github.com/copperwall/twiddit/commit/2203d4ce9810bdaccece5c48ff4888658a01acfc.patch",
    "fix_commit_details": {
      "sha": "2203d4ce9810bdaccece5c48ff4888658a01acfc",
      "commit_date": "2015-03-15T20:54:14Z",
      "author": {
        "login": "copperwall",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Parameterize queries to prevent against SQL injection",
        "length": 53,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 40,
        "additions": 27,
        "deletions": 13
      },
      "files": [
        {
          "filename": "index.php",
          "status": "modified",
          "additions": 27,
          "deletions": 13,
          "patch": "@@ -37,10 +37,17 @@\n $app->get('/feed', function() use ($app) {\n    $db = TwidditDB::db();\n    $username = $_COOKIE['user'];\n-   $query = \"select redditor \n-            from followingRedditors \n-            where '$username' = userName\";\n-   $result = $db->query($query);\n+   $query = <<<EOT\n+      SELECT `redditor`\n+      FROM `followingRedditors`\n+      WHERE `userName` = :username\n+EOT;\n+\n+   $statement = $db->prepare($query);\n+   $statement->bindParam(':username', $username);\n+   $statement->execute();\n+   $result = $statement->fetchAll(PDO::FETCH_ASSOC);\n+\n    $users = [];\n    foreach ($result as $row) {\n       $users[] = $row['redditor'];\n@@ -50,18 +57,26 @@\n \n    echo json_encode($comments);\n });\n+\n $app->get('/subreddits', function() use ($app) {\n    $db = TwidditDB::db();\n    $username = $_COOKIE['user'];\n-   $query = \"select subreddit \n-            from followingSubreddit \n-            where '$username' = userName\";\n-   $result = $db->query($query);\n-   $subreddit = [];\n-   foreach ($result as $row) {\n-      $subreddit[] = $row['subreddit'];\n+   $query = <<<EOT\n+      SELECT `subreddit`\n+      FROM `followingSubreddit`\n+      WHERE `userName` = :username\n+EOT;\n+\n+   $statement = $db->prepare($query);\n+   $statement->bindParam(':username', $username);\n+   $statement->execute();\n+   $results = $statement->fetchAll(PDO::FETCH_ASSOC);\n+\n+   $subreddits = [];\n+   foreach ($results as $row) {\n+      $subreddits[] = $row['subreddit'];\n    }\n-   $data = Reddit::getSubredditPosts($subreddit);\n+   $data = Reddit::getSubredditPosts($subreddits);\n \n    echo json_encode($data);\n });\n@@ -107,7 +122,6 @@\n    }\n });\n \n-\n $app->post('/signup', function() use ($app) {\n    $db = TwidditDB::db();\n    $username = $app->request->post('username');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "95e6ae85b9960a87d4b3c5beb270038f31f12946",
            "date": "2015-12-22T06:56:03Z",
            "author_login": "copperwall"
          },
          {
            "sha": "21fc42f759d64fdfcf0db02e6723fc879b3d7d58",
            "date": "2015-11-01T02:25:31Z",
            "author_login": "copperwall"
          },
          {
            "sha": "f5f16c7599645ade4b8bbf469bad03d988045584",
            "date": "2015-11-01T02:21:26Z",
            "author_login": "copperwall"
          },
          {
            "sha": "6a9aad110372c0a874d8e54fbe2c11f9d98dd98d",
            "date": "2015-11-01T01:11:22Z",
            "author_login": "copperwall"
          },
          {
            "sha": "92915eab4b8182ea1dbb247a42495a4089d081c1",
            "date": "2015-08-02T06:32:52Z",
            "author_login": "copperwall"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in copperwall Twiddit. It has been rated as critical. This issue affects some unknown processing of the file index.php. The manipulation leads to sql injection. The identifier of the patch is 2203d4ce9810bdaccece5c48ff4888658a01acfc. It is recommended to apply a patch to fix this issue. The identifier VDB-218897 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-19T10:15:11.597",
    "last_modified": "2024-11-21T02:24:18.413",
    "fix_date": "2015-03-15T20:54:14Z"
  },
  "references": [
    {
      "url": "https://github.com/copperwall/twiddit/commit/2203d4ce9810bdaccece5c48ff4888658a01acfc",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218897",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218897",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/copperwall/twiddit/commit/2203d4ce9810bdaccece5c48ff4888658a01acfc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218897",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218897",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.575950",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "twiddit",
    "owner": "copperwall",
    "created_at": "2015-03-19T18:34:38Z",
    "updated_at": "2015-12-22T06:59:06Z",
    "pushed_at": "2015-12-22T06:57:28Z",
    "size": 159,
    "stars": 1,
    "forks": 0,
    "open_issues": 14,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 25748,
      "JavaScript": 10107,
      "HTML": 7622,
      "CSS": 3218
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:39:45.244986"
  }
}