{
  "cve_id": "CVE-2015-10071",
  "github_data": {
    "repository": "gitter-badger/ezpublish-modern-legacy",
    "fix_commit": "5908d5ee65fec61ce0e321d586530461a210bf2a",
    "related_commits": [
      "5908d5ee65fec61ce0e321d586530461a210bf2a",
      "5908d5ee65fec61ce0e321d586530461a210bf2a"
    ],
    "patch_url": "https://github.com/gitter-badger/ezpublish-modern-legacy/commit/5908d5ee65fec61ce0e321d586530461a210bf2a.patch",
    "fix_commit_details": {
      "sha": "5908d5ee65fec61ce0e321d586530461a210bf2a",
      "commit_date": "2015-05-11T09:14:12Z",
      "author": {
        "login": "glye",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix EZP-24140: Potential vulnerability in eZ Publish password recovery",
        "length": 182,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
      },
      "files": [
        {
          "filename": "kernel/user/forgotpassword.php",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -113,7 +113,11 @@\n             $user   = $users[0];\n             $time   = time();\n             $userID = $user->id();\n-            $hashKey = md5( $userID . ':' . $time . ':' . mt_rand() );\n+            $hashKey = md5(\n+                $userID . ':' . microtime() . ':' .\n+                ( function_exists( \"openssl_random_pseudo_bytes\" ) ?\n+                    openssl_random_pseudo_bytes( 32 ) : mt_rand() )\n+            );\n \n             // Create forgot password object\n             if ( eZOperationHandler::operationIsAvailable( 'user_forgotpassword' ) )"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f4916a2f014a5f68cf2294bb00171959e58d904d",
            "date": "2015-05-15T09:39:02Z",
            "author_login": "jeromegamez"
          },
          {
            "sha": "0158fb854e829da3b395b5f380f85db966bce4ac",
            "date": "2015-05-15T01:41:01Z",
            "author_login": "jeromegamez"
          },
          {
            "sha": "4be17f55312ee895aa8be7e9cbe3d44f36c3f7c1",
            "date": "2015-05-15T01:39:33Z",
            "author_login": "jeromegamez"
          },
          {
            "sha": "13be42dc3fab61e4733783c8270c2fc7b1b32cb6",
            "date": "2013-09-27T11:47:37Z",
            "author_login": "tharkun"
          },
          {
            "sha": "ce90e96e128b51811b547c914d99f1bb536cbf1a",
            "date": "2015-05-15T01:20:24Z",
            "author_login": "jeromegamez"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.6,
    "cvss_vector": "CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-640",
    "description": "A vulnerability was found in gitter-badger ezpublish-modern-legacy. It has been rated as problematic. This issue affects some unknown processing of the file kernel/user/forgotpassword.php. The manipulation leads to weak password recovery. The complexity of an attack is rather high. The exploitation is known to be difficult. Upgrading to version 1.0 is able to address this issue. The patch is named 5908d5ee65fec61ce0e321d586530461a210bf2a. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-218951.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-01-19T10:15:11.697",
    "last_modified": "2024-11-21T02:24:18.543",
    "fix_date": "2015-05-11T09:14:12Z"
  },
  "references": [
    {
      "url": "https://github.com/gitter-badger/ezpublish-modern-legacy/commit/5908d5ee65fec61ce0e321d586530461a210bf2a",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitter-badger/ezpublish-modern-legacy/releases/tag/1.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218951",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218951",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitter-badger/ezpublish-modern-legacy/commit/5908d5ee65fec61ce0e321d586530461a210bf2a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitter-badger/ezpublish-modern-legacy/releases/tag/1.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218951",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218951",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.576094",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ezpublish-modern-legacy",
    "owner": "gitter-badger",
    "created_at": "2015-05-15T10:18:24Z",
    "updated_at": "2015-08-17T12:02:23Z",
    "pushed_at": "2015-05-15T10:18:49Z",
    "size": 192434,
    "stars": 0,
    "forks": 0,
    "open_issues": 0,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 20747848,
      "PHP": 13108464,
      "Smarty": 2803832,
      "CSS": 1101976,
      "C++": 496091,
      "HTML": 264403,
      "Shell": 255002,
      "GAP": 73237,
      "SQLPL": 5478,
      "PLSQL": 3318,
      "C": 2724,
      "QMake": 2113,
      "Awk": 2047
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:19:47.405872"
  }
}