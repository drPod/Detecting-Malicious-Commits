{
  "cve_id": "CVE-2015-10077",
  "github_data": {
    "repository": "webbuilders-group/silverstripe-kapost-bridge",
    "fix_commit": "2e14b0fd0ea35034f90890f364b130fb4645ff35",
    "related_commits": [
      "2e14b0fd0ea35034f90890f364b130fb4645ff35",
      "2e14b0fd0ea35034f90890f364b130fb4645ff35"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2e14b0fd0ea35034f90890f364b130fb4645ff35",
      "commit_date": "2015-10-13T19:23:50Z",
      "author": {
        "login": "UndefinedOffset",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed potential sql injection points",
        "length": 36,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "code/control/KapostService.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -121,11 +121,11 @@ public function index() {\n      */\n     public function preview() {\n         $auth=$this->request->getVar('auth');\n-        $token=KapostPreviewToken::get()->filter('Code', Convert::raw2xml($auth))->first();\n+        $token=KapostPreviewToken::get()->filter('Code', Convert::raw2sql($auth))->first();\n         \n         //Verify the token exists and hasn't expired yet\n         if(!empty($token) && $token!==false && $token->exists() && time()-strtotime($token->Created)<self::config()->preview_expiry*60 && $token->KapostRefID==$this->urlParams['ID']) {\n-            $kapostObj=KapostObject::get()->filter('KapostRefID', Convert::raw2xml($this->urlParams['ID']))->sort('\"Created\" DESC')->first();\n+            $kapostObj=KapostObject::get()->filter('KapostRefID', Convert::raw2sql($this->urlParams['ID']))->sort('\"Created\" DESC')->first();\n             if(!empty($kapostObj) && $kapostObj!==false && $kapostObj->exists()) {\n                 $previewController=$kapostObj->renderPreview();\n                 \n@@ -734,7 +734,7 @@ protected function getPreview($blog_id, $content, $content_id) {\n         \n         \n         //Detect if the record already exists or not so we can decide whether to create a new record or edit an existing\n-        $existing=KapostObject::get()->filter('KapostRefID', Convert::raw2xml($content_id))->first();\n+        $existing=KapostObject::get()->filter('KapostRefID', Convert::raw2sql($content_id))->first();\n         if(!empty($existing) && $existing!==false && $existing->exists()) {\n             $resultID=$content_id;\n             \n@@ -743,7 +743,7 @@ protected function getPreview($blog_id, $content, $content_id) {\n             $resultID=$this->newPost($blog_id, $content, false, true);\n             \n             //Find the object\n-            $existing=KapostObject::get()->filter('KapostRefID', Convert::raw2xml($resultID))->first();\n+            $existing=KapostObject::get()->filter('KapostRefID', Convert::raw2sql($resultID))->first();\n         }\n         \n         //Make sure we got the kapost hash back or an id if we got an object back we assume that it's a response"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "718f498cad0eec764d19c9081404b2a0c8f44d71",
            "date": "2017-10-03T15:48:51Z",
            "author_login": "UndefinedOffset"
          },
          {
            "sha": "ad0b5f2c0b03fdeeaf20a26cb0d8706da1b2d71e",
            "date": "2017-10-03T15:44:07Z",
            "author_login": "UndefinedOffset"
          },
          {
            "sha": "8e7db14a9d4ed47425c7a7984db9d51cb81e4d77",
            "date": "2017-08-18T13:18:19Z",
            "author_login": "UndefinedOffset"
          },
          {
            "sha": "d078b37aa67e19d65473e5137ce66bc1bc44a465",
            "date": "2017-06-07T18:10:22Z",
            "author_login": "UndefinedOffset"
          },
          {
            "sha": "79a357c926bd92239a8392e37b6551b16641ca91",
            "date": "2017-05-11T18:33:21Z",
            "author_login": "UndefinedOffset"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in webbuilders-group silverstripe-kapost-bridge 0.3.3. It has been declared as critical. Affected by this vulnerability is the function index/getPreview of the file code/control/KapostService.php. The manipulation leads to sql injection. The attack can be launched remotely. Upgrading to version 0.4.0 is able to address this issue. The patch is named 2e14b0fd0ea35034f90890f364b130fb4645ff35. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-220471.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-10T15:15:11.490",
    "last_modified": "2024-11-21T02:24:19.460",
    "fix_date": "2015-10-13T19:23:50Z"
  },
  "references": [
    {
      "url": "https://github.com/webbuilders-group/silverstripe-kapost-bridge/commit/2e14b0fd0ea35034f90890f364b130fb4645ff35",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webbuilders-group/silverstripe-kapost-bridge/releases/tag/0.4.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220471",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220471",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/webbuilders-group/silverstripe-kapost-bridge/commit/2e14b0fd0ea35034f90890f364b130fb4645ff35",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webbuilders-group/silverstripe-kapost-bridge/releases/tag/0.4.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220471",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220471",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.011407",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "silverstripe-kapost-bridge",
    "owner": "webbuilders-group",
    "created_at": "2015-04-07T18:37:17Z",
    "updated_at": "2018-04-24T11:55:29Z",
    "pushed_at": "2017-10-03T15:49:22Z",
    "size": 234,
    "stars": 2,
    "forks": 1,
    "open_issues": 3,
    "watchers": 2,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 167385,
      "JavaScript": 10091,
      "CSS": 6522,
      "Scheme": 2329
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:17:11.546301"
  }
}