{
  "cve_id": "CVE-2015-10091",
  "github_data": {
    "repository": "bywatersolutions/bywater-koha-xslt",
    "fix_commit": "9513b93c828dfbc4413f9e0df63647401aaf4e58",
    "related_commits": [
      "9513b93c828dfbc4413f9e0df63647401aaf4e58",
      "9513b93c828dfbc4413f9e0df63647401aaf4e58"
    ],
    "patch_url": "https://github.com/bywatersolutions/bywater-koha-xslt/commit/9513b93c828dfbc4413f9e0df63647401aaf4e58.patch",
    "fix_commit_details": {
      "sha": "9513b93c828dfbc4413f9e0df63647401aaf4e58",
      "commit_date": "2015-07-13T04:06:46Z",
      "author": {
        "login": "minusdavid",
        "type": "User",
        "stats": {
          "total_commits": 113,
          "average_weekly_commits": 0.12417582417582418,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 73
        }
      },
      "commit_message": {
        "title": "Bug 14521: SQL injection in local use system preferences",
        "length": 998,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "admin/systempreferences.pl",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -70,14 +70,16 @@ sub StringSearch {\n \n     my $strsth = \"Select variable,value,explanation,type,options from systempreferences where variable in (\";\n     my $first = 1;\n+    my @sql_bind;\n     for my $name ( get_local_prefs() ) {\n                 $strsth .= ',' unless $first;\n-                $strsth .= \"'$name'\";\n+                $strsth .= \"?\";\n+                push(@sql_bind,$name);\n                 $first = 0;\n     }\n     $strsth .= \") order by variable\";\n     $sth = $dbh->prepare($strsth);\n-    $sth->execute();\n+    $sth->execute(@sql_bind);\n \n     while ( my $data = $sth->fetchrow_hashref ) {\n             unless (defined $data->{value}) { $data->{value} = \"\";}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "289a3e735e7fdce14c17d9d33304bcbb9f6d90cd",
            "date": "2020-01-23T14:23:01Z",
            "author_login": "kylemhall"
          },
          {
            "sha": "0eba8a09a2158f914b6f61c95469d8340c2f1aa3",
            "date": "2015-10-01T13:48:15Z",
            "author_login": "wsalesky"
          },
          {
            "sha": "0d8109f35252d5cdf9672adeb5f85595df1a2836",
            "date": "2015-09-30T17:19:20Z",
            "author_login": "wsalesky"
          },
          {
            "sha": "9d7e88e32582c9561d20d5931a9864ccbc381b7f",
            "date": "2015-08-18T17:10:37Z",
            "author_login": "joubu"
          },
          {
            "sha": "2776573ba695b817cb7f30bc93437d63b5c85043",
            "date": "2015-09-01T14:11:54Z",
            "author_login": "mderooy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability has been found in ByWater Solutions bywater-koha-xslt and classified as critical. This vulnerability affects the function StringSearch of the file admin/systempreferences.pl. The manipulation of the argument name leads to sql injection. The attack can be initiated remotely. Continious delivery with rolling releases is used by this product. Therefore, no version details of affected nor updated releases are available. The patch is identified as 9513b93c828dfbc4413f9e0df63647401aaf4e58. It is recommended to apply a patch to fix this issue. VDB-222322 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-06T04:15:08.190",
    "last_modified": "2024-11-21T02:24:21.543",
    "fix_date": "2015-07-13T04:06:46Z"
  },
  "references": [
    {
      "url": "https://github.com/bywatersolutions/bywater-koha-xslt/commit/9513b93c828dfbc4413f9e0df63647401aaf4e58",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.222322",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.222322",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bywatersolutions/bywater-koha-xslt/commit/9513b93c828dfbc4413f9e0df63647401aaf4e58",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.222322",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.222322",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.807188",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bywater-koha-xslt",
    "owner": "bywatersolutions",
    "created_at": "2015-12-03T14:04:07Z",
    "updated_at": "2020-01-23T19:14:17Z",
    "pushed_at": "2021-03-24T16:59:35Z",
    "size": 1949473,
    "stars": 1,
    "forks": 3,
    "open_issues": 0,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Perl": 8870882,
      "XSLT": 1538205,
      "JavaScript": 1117162,
      "TSQL": 625258,
      "HTML": 235732,
      "CSS": 175425,
      "Pawn": 113544,
      "Perl 6": 85920,
      "Shell": 36037,
      "Python": 23068,
      "C++": 16706,
      "Assembly": 14213,
      "SourcePawn": 10480,
      "Roff": 7853,
      "mIRC Script": 6436,
      "PHP": 5792,
      "Pascal": 2212,
      "Makefile": 1149
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:40:52.768505"
  }
}