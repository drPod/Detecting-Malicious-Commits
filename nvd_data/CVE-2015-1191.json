{
  "cve_id": "CVE-2015-1191",
  "github_data": {
    "repository": "madler/pigz",
    "fix_commit": "fdad1406b3ec809f4954ff7cdf9e99eb18c2458f",
    "related_commits": [
      "fdad1406b3ec809f4954ff7cdf9e99eb18c2458f",
      "fdad1406b3ec809f4954ff7cdf9e99eb18c2458f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "fdad1406b3ec809f4954ff7cdf9e99eb18c2458f",
      "commit_date": "2015-01-12T04:21:24Z",
      "author": {
        "login": "madler",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "When decompressing with -N or -NT, strip any path from header name.",
        "length": 349,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 37,
        "additions": 23,
        "deletions": 14
      },
      "files": [
        {
          "filename": "pigz.c",
          "status": "modified",
          "additions": 23,
          "deletions": 14,
          "patch": "@@ -3520,26 +3520,35 @@ local void process(char *path)\n                  \" (use -f to force)\");\n     }\n     else {\n-        char *to, *repl;\n-\n-        /* use header name for output when decompressing with -N */\n-        to = g.inf;\n-        if (g.decode && (g.headis & 1) != 0 && g.hname != NULL) {\n-            to = g.hname;\n-            len = strlen(g.hname);\n+        char *to = g.inf, *sufx = \"\";\n+        size_t pre = 0;\n+\n+        /* select parts of the output file name */\n+        if (g.decode) {\n+            /* for -dN or -dNT, use the path from the input file and the name\n+               from the header, stripping any path in the header name */\n+            if ((g.headis & 1) != 0 && g.hname != NULL) {\n+                pre = justname(g.inf) - g.inf;\n+                to = justname(g.hname);\n+                len = strlen(to);\n+            }\n+            /* for -d or -dNn, replace abbreviated suffixes */\n+            else if (strcmp(to + len, \".tgz\") == 0)\n+                sufx = \".tar\";\n         }\n-\n-        /* replace .tgz with .tar when decoding */\n-        repl = g.decode && strcmp(to + len, \".tgz\") ? \"\" : \".tar\";\n+        else\n+            /* add appropriate suffix when compressing */\n+            sufx = g.sufx;\n \n         /* create output file and open to write */\n-        g.outf = MALLOC(len + (g.decode ? strlen(repl) : strlen(g.sufx)) + 1);\n+        g.outf = MALLOC(pre + len + strlen(sufx) + 1);\n         if (g.outf == NULL)\n             bail(\"not enough memory\", \"\");\n-        memcpy(g.outf, to, len);\n-        strcpy(g.outf + len, g.decode ? repl : g.sufx);\n+        memcpy(g.outf, g.inf, pre);\n+        memcpy(g.outf + pre, to, len);\n+        strcpy(g.outf + pre + len, sufx);\n         g.outd = open(g.outf, O_CREAT | O_TRUNC | O_WRONLY |\n-                             (g.force ? 0 : O_EXCL), 0600);\n+                              (g.force ? 0 : O_EXCL), 0600);\n \n         /* if exists and not -f, give user a chance to overwrite */\n         if (g.outd < 0 && errno == EEXIST && isatty(0) && g.verbosity) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fe4894f57739e3039a2ffc2a2a360d35e19bacbe",
            "date": "2023-08-20T05:20:56Z",
            "author_login": "madler"
          },
          {
            "sha": "d9a51cd2ec739837b41127f49b9826315ee74fad",
            "date": "2023-08-20T05:06:27Z",
            "author_login": "madler"
          },
          {
            "sha": "fb4222c4f7afc0b70c403849a519a0bce3deafec",
            "date": "2023-08-20T04:57:04Z",
            "author_login": "madler"
          },
          {
            "sha": "907ca0763be4547a9b0cce8c1057217488149744",
            "date": "2023-08-18T10:27:12Z",
            "author_login": "madler"
          },
          {
            "sha": "e1ed230a1599a3cb64c8f5c003cced60e10e3314",
            "date": "2023-01-01T05:28:26Z",
            "author_login": "madler"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "Multiple directory traversal vulnerabilities in pigz 2.3.1 allow remote attackers to write to arbitrary files via a (1) full pathname or (2) .. (dot dot) in an archive.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-01-21T18:59:52.840",
    "last_modified": "2024-11-21T02:24:50.843",
    "fix_date": "2015-01-12T04:21:24Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-03/msg00013.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-03/msg00017.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/01/18/3",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/72109",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774978",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/madler/pigz/commit/fdad1406b3ec809f4954ff7cdf9e99eb18c2458f",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-03/msg00013.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-03/msg00017.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/01/18/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/72109",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=774978",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/madler/pigz/commit/fdad1406b3ec809f4954ff7cdf9e99eb18c2458f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:32.408014",
    "processing_status": "enhanced"
  }
}