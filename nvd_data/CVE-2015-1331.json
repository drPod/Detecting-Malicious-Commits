{
  "cve_id": "CVE-2015-1331",
  "github_data": {
    "repository": "lxc/lxc",
    "fix_commit": "72cf81f6a3404e35028567db2c99a90406e9c6e6",
    "related_commits": [
      "72cf81f6a3404e35028567db2c99a90406e9c6e6",
      "72cf81f6a3404e35028567db2c99a90406e9c6e6"
    ],
    "patch_url": "https://github.com/lxc/lxc/commit/72cf81f6a3404e35028567db2c99a90406e9c6e6.patch",
    "fix_commit_details": {
      "sha": "72cf81f6a3404e35028567db2c99a90406e9c6e6",
      "commit_date": "2015-07-03T14:26:17Z",
      "author": {
        "login": "hallyn",
        "type": "User",
        "stats": {
          "total_commits": 1127,
          "average_weekly_commits": 1.3627569528415961,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 289
        }
      },
      "commit_message": {
        "title": "CVE-2015-1331: lxclock: use /run/lxc/lock rather than /run/lock/lxc",
        "length": 312,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 49,
        "additions": 11,
        "deletions": 38
      },
      "files": [
        {
          "filename": "src/lxc/lxclock.c",
          "status": "modified",
          "additions": 10,
          "deletions": 37,
          "patch": "@@ -103,13 +103,13 @@ static char *lxclock_name(const char *p, const char *n)\n \tchar *rundir;\n \n \t/* lockfile will be:\n-\t * \"/run\" + \"/lock/lxc/$lxcpath/$lxcname + '\\0' if root\n+\t * \"/run\" + \"/lxc/lock/$lxcpath/$lxcname + '\\0' if root\n \t * or\n-\t * $XDG_RUNTIME_DIR + \"/lock/lxc/$lxcpath/$lxcname + '\\0' if non-root\n+\t * $XDG_RUNTIME_DIR + \"/lxc/lock/$lxcpath/$lxcname + '\\0' if non-root\n \t */\n \n-\t/* length of \"/lock/lxc/\" + $lxcpath + \"/\" + \".\" + $lxcname + '\\0' */\n-\tlen = strlen(\"/lock/lxc/\") + strlen(n) + strlen(p) + 3;\n+\t/* length of \"/lxc/lock/\" + $lxcpath + \"/\" + \".\" + $lxcname + '\\0' */\n+\tlen = strlen(\"/lxc/lock/\") + strlen(n) + strlen(p) + 3;\n \trundir = get_rundir();\n \tif (!rundir)\n \t\treturn NULL;\n@@ -120,48 +120,21 @@ static char *lxclock_name(const char *p, const char *n)\n \t\treturn NULL;\n \t}\n \n-\tret = snprintf(dest, len, \"%s/lock/lxc/%s\", rundir, p);\n+\tret = snprintf(dest, len, \"%s/lxc/lock/%s\", rundir, p);\n \tif (ret < 0 || ret >= len) {\n \t\tfree(dest);\n \t\tfree(rundir);\n \t\treturn NULL;\n \t}\n \tret = mkdir_p(dest, 0755);\n \tif (ret < 0) {\n-\t\t/* fall back to \"/tmp/\" + $(id -u) + \"/lxc\" + $lxcpath + \"/\" + \".\" + $lxcname + '\\0'\n-\t\t * * maximum length of $(id -u) is 10 calculated by (log (2 ** (sizeof(uid_t) * 8) - 1) / log 10 + 1)\n-\t\t * * lxcpath always starts with '/'\n-\t\t */\n-\t\tint l2 = 22 + strlen(n) + strlen(p);\n-\t\tif (l2 > len) {\n-\t\t\tchar *d;\n-\t\t\td = realloc(dest, l2);\n-\t\t\tif (!d) {\n-\t\t\t\tfree(dest);\n-\t\t\t\tfree(rundir);\n-\t\t\t\treturn NULL;\n-\t\t\t}\n-\t\t\tlen = l2;\n-\t\t\tdest = d;\n-\t\t}\n-\t\tret = snprintf(dest, len, \"/tmp/%d/lxc%s\", geteuid(), p);\n-\t\tif (ret < 0 || ret >= len) {\n-\t\t\tfree(dest);\n-\t\t\tfree(rundir);\n-\t\t\treturn NULL;\n-\t\t}\n-\t\tret = mkdir_p(dest, 0755);\n-\t\tif (ret < 0) {\n-\t\t\tfree(dest);\n-\t\t\tfree(rundir);\n-\t\t\treturn NULL;\n-\t\t}\n-\t\tret = snprintf(dest, len, \"/tmp/%d/lxc%s/.%s\", geteuid(), p, n);\n-\t} else\n-\t\tret = snprintf(dest, len, \"%s/lock/lxc/%s/.%s\", rundir, p, n);\n+\t\tfree(dest);\n+\t\tfree(rundir);\n+\t\treturn NULL;\n+\t}\n \n+\tret = snprintf(dest, len, \"%s/lxc/lock/%s/.%s\", rundir, p, n);\n \tfree(rundir);\n-\n \tif (ret < 0 || ret >= len) {\n \t\tfree(dest);\n \t\treturn NULL;"
        },
        {
          "filename": "src/tests/locktests.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -122,7 +122,7 @@ int main(int argc, char *argv[])\n \t\texit(1);\n \t}\n \tstruct stat sb;\n-\tchar *pathname = RUNTIME_PATH \"/lock/lxc/var/lib/lxc/\";\n+\tchar *pathname = RUNTIME_PATH \"/lxc/lock/var/lib/lxc/\";\n \tret = stat(pathname, &sb);\n \tif (ret != 0) {\n \t\tfprintf(stderr, \"%d: filename %s not created\\n\", __LINE__,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "040e006d5d5c2cdccf2bcdda4f7c68b635509371",
            "date": "2025-01-09T23:24:26Z",
            "author_login": "stgraber"
          },
          {
            "sha": "4a4ba051aab0e45f1beac8b4222a230a3e6848de",
            "date": "2025-01-09T23:05:20Z",
            "author_login": "stgraber"
          },
          {
            "sha": "8d8fd27b57bf1ebc9cdbf129547961339dd45b8b",
            "date": "2025-01-08T23:07:17Z",
            "author_login": "sdanailo-42"
          },
          {
            "sha": "844c49fcf356a55b83a26a0bb8a5e6d25039f549",
            "date": "2025-01-08T22:51:15Z",
            "author_login": "sdanailo-42"
          },
          {
            "sha": "4c4636830528300d122d2a0b4aa540b61e2e7128",
            "date": "2025-01-08T23:05:26Z",
            "author_login": "sdanailo-42"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-59",
    "description": "lxclock.c in LXC 1.1.2 and earlier allows local users to create arbitrary files via a symlink attack on /run/lock/lxc/*.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-08-12T14:59:03.823",
    "last_modified": "2024-11-21T02:25:11.097",
    "fix_date": "2015-07-03T14:26:17Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00073.html",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2015-07/msg00066.html",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3317",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/75999",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2675-1",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "https://bugs.launchpad.net/ubuntu/+source/lxc/+bug/1470842",
      "source": "security@ubuntu.com",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/lxc/lxc/commit/72cf81f6a3404e35028567db2c99a90406e9c6e6",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "https://service.ait.ac.at/security/2015/LxcSecurityAnalysis.html",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00073.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2015-07/msg00066.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3317",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/75999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2675-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugs.launchpad.net/ubuntu/+source/lxc/+bug/1470842",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/lxc/lxc/commit/72cf81f6a3404e35028567db2c99a90406e9c6e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://service.ait.ac.at/security/2015/LxcSecurityAnalysis.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:35.798242",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lxc",
    "owner": "lxc",
    "created_at": "2012-09-07T18:50:27Z",
    "updated_at": "2025-01-14T11:54:42Z",
    "pushed_at": "2025-01-09T23:24:26Z",
    "size": 35605,
    "stars": 4741,
    "forks": 1125,
    "open_issues": 176,
    "watchers": 4741,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "stable-0.7.4",
      "stable-1.0",
      "stable-1.1"
    ],
    "languages": {
      "C": 2574680,
      "Shell": 196933,
      "Meson": 74020,
      "Python": 5129,
      "Makefile": 300,
      "SmPL": 251
    },
    "commit_activity": {
      "total_commits_last_year": 159,
      "avg_commits_per_week": 3.0576923076923075,
      "days_active_last_year": 61
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:06:03.413007"
  }
}