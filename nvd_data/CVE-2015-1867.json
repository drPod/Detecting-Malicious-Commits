{
  "cve_id": "CVE-2015-1867",
  "github_data": {
    "repository": "ClusterLabs/pacemaker",
    "fix_commit": "84ac07c",
    "related_commits": [
      "84ac07c",
      "84ac07c"
    ],
    "patch_url": "https://github.com/ClusterLabs/pacemaker/commit/84ac07c.patch",
    "fix_commit_details": {
      "sha": "84ac07c",
      "commit_date": "2015-04-07T00:03:25Z",
      "author": {
        "login": "beekhof",
        "type": "User",
        "stats": {
          "total_commits": 11563,
          "average_weekly_commits": 10.34257602862254,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 604
        }
      },
      "commit_message": {
        "title": "Fix: acl: Do not delay evaluation of added nodes in some situations",
        "length": 147,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/common/xml.c",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -1020,13 +1020,16 @@ __xml_acl_post_process(xmlNode * xml)\n \n     if(is_set(p->flags, xpf_created)) {\n         xmlAttr *xIter = NULL;\n+        char *path = xml_get_path(xml);\n \n-        /* Always allow new scaffolding, ie. node with no attributes or only an 'id' */\n+        /* Always allow new scaffolding, ie. node with no attributes or only an 'id'\n+         * Except in the ACLs section\n+         */\n \n         for (xIter = crm_first_attr(xml); xIter != NULL; xIter = xIter->next) {\n             const char *prop_name = (const char *)xIter->name;\n \n-            if (strcmp(prop_name, XML_ATTR_ID) == 0) {\n+            if (strcmp(prop_name, XML_ATTR_ID) == 0 && strstr(path, \"/\"XML_CIB_TAG_ACLS\"/\") == NULL) {\n                 /* Delay the acl check */\n                 continue;\n \n@@ -1035,7 +1038,6 @@ __xml_acl_post_process(xmlNode * xml)\n                 break;\n \n             } else {\n-                char *path = xml_get_path(xml);\n                 crm_trace(\"Cannot add new node %s at %s\", crm_element_name(xml), path);\n \n                 if(xml != xmlDocGetRootElement(xml->doc)) {\n@@ -1046,6 +1048,7 @@ __xml_acl_post_process(xmlNode * xml)\n                 return;\n             }\n         }\n+        free(path);\n     }\n \n     while (cIter != NULL) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d43ee7aa85d1867628cdc6aaf3751b671546d58c",
            "date": "2025-01-10T15:13:05Z",
            "author_login": "clumens"
          },
          {
            "sha": "4e55c5ce88f4f892802479bd9700fbf0e6ae8fa3",
            "date": "2025-01-09T19:40:45Z",
            "author_login": "clumens"
          },
          {
            "sha": "961be70139c04beb19d4b514afa73eadee54d23c",
            "date": "2025-01-09T14:37:14Z",
            "author_login": "athos-ribeiro"
          },
          {
            "sha": "9b9ba6b46bbb97d69aa58ecf14d8d8f4b8609ee4",
            "date": "2025-01-09T17:05:34Z",
            "author_login": "clumens"
          },
          {
            "sha": "b9756b1f95b7074a045b547e77ba902e6fd97f47",
            "date": "2025-01-09T17:05:06Z",
            "author_login": "clumens"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "Pacemaker before 1.1.13 does not properly evaluate added nodes, which allows remote read-only users to gain privileges via an acl command.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-08-12T14:59:06.620",
    "last_modified": "2024-11-21T02:26:18.080",
    "fix_date": "2015-04-07T00:03:25Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-November/170610.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-October/169671.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-October/169995.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2015-1424.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2015-2383.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74231",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1211370",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/ClusterLabs/pacemaker/commit/84ac07c",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201710-08",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-November/170610.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-October/169671.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-October/169995.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2015-1424.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2015-2383.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74231",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1211370",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/ClusterLabs/pacemaker/commit/84ac07c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201710-08",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:35.798598",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pacemaker",
    "owner": "ClusterLabs",
    "created_at": "2011-09-01T00:08:16Z",
    "updated_at": "2025-01-10T15:13:10Z",
    "pushed_at": "2025-01-10T16:53:00Z",
    "size": 98489,
    "stars": 1053,
    "forks": 343,
    "open_issues": 8,
    "watchers": 1053,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 7208353,
      "Python": 485905,
      "XSLT": 211895,
      "Shell": 165604,
      "Makefile": 129068,
      "M4": 100045,
      "Roff": 26521,
      "SmPL": 9708,
      "HTML": 932,
      "BitBake": 671,
      "Pascal": 108,
      "Pawn": 70
    },
    "commit_activity": {
      "total_commits_last_year": 3642,
      "avg_commits_per_week": 70.03846153846153,
      "days_active_last_year": 254
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:49:26.848211"
  }
}