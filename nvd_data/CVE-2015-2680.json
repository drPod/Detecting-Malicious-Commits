{
  "cve_id": "CVE-2015-2680",
  "github_data": {
    "repository": "semplon/GeniXCMS",
    "fix_commit": "698245488343396185b1b49e7482ee5b25541815",
    "related_commits": [
      "698245488343396185b1b49e7482ee5b25541815",
      "698245488343396185b1b49e7482ee5b25541815"
    ],
    "patch_url": "https://github.com/semplon/GeniXCMS/commit/698245488343396185b1b49e7482ee5b25541815.patch",
    "fix_commit_details": {
      "sha": "698245488343396185b1b49e7482ee5b25541815",
      "commit_date": "2015-03-10T01:54:35Z",
      "author": {
        "login": "semplon",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security FIX, Bug FIX",
        "length": 21,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 1693,
        "additions": 1165,
        "deletions": 528
      },
      "files": [
        {
          "filename": "gxadmin/inc/categories.php",
          "status": "modified",
          "additions": 36,
          "deletions": 6,
          "patch": "@@ -12,7 +12,35 @@\n * @copyright 2014-2015 Puguh Wijayanto\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n-*/?>\n+*/\n+\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertgreen'] as $alert) {\n+        # code...\n+        echo \"$alert\\n\";\n+    }\n+    echo \"</div>\";\n+}\n+if (isset($data['alertred'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertred'] as $alert) {\n+        # code...\n+        echo \"$alert\\n\";\n+    }\n+    echo \"</div>\";\n+}\n+?>\n <div class=\"row\">\n     <div class=\"col-md-12\">\n         <h1><i class=\"fa fa-cubes\"></i>  Categories \n@@ -34,12 +62,12 @@\n                         // echo \"<td>\".$c->parent.\"</td>\";\n                         // echo \"<td></td>\";\n \n-                        if($c->parent == \"\"){\n+                        if($c->parent == \"\" || $c->parent == 0){\n                             echo \"<div class=\\\"col-md-4 item\\\" >\n                             <div class=\\\"panel panel-default\\\">\n                                 <div class=\\\"panel-heading\\\">\n                                   <h3 class=\\\"panel-title\\\">{$c->name} \n-                                  <a href=\\\"?page=categories&act=del&id={$c->id}\\\" class=\\\"pull-right\\\"\n+                                  <a href=\\\"?page=categories&act=del&id={$c->id}&token=\".TOKEN.\"\\\" class=\\\"pull-right\\\"\n                                   onclick=\\\"return confirm('Are you sure you want to delete this item?');\\\">\n                                   <span class=\\\"glyphicon glyphicon-remove\\\"></span></a></h3>\n                                 </div>\n@@ -48,13 +76,14 @@\n                                 foreach ($data['cat'] as $c2) {\n                                     if($c2->parent == $c->id){\n                                         echo \"<li class=\\\"list-group-item\\\">\n-                                        <form action=\\\"\\\" method=\\\"POST\\\" name=\\\"updatecat\\\">\n+                                        <form action=\\\"index.php?page=categories\\\" method=\\\"POST\\\" name=\\\"updatecat\\\">\n                                         <div class=\\\"input-group\\\">\n-                                            <a href=\\\"?page=categories&act=del&id={$c2->id}\\\" class=\\\"input-group-addon\\\"\n+                                            <a href=\\\"?page=categories&act=del&id={$c2->id}&token=\".TOKEN.\"\\\" class=\\\"input-group-addon\\\"\n                                             onclick=\\\"return confirm('Are you sure you want to delete this item?');\\\"\n                                             ><span class=\\\"glyphicon glyphicon-remove\\\"></span></a>\n                                             <input type=\\\"text\\\" name=\\\"cat\\\" class=\\\"form-control\\\" value=\\\"{$c2->name}\\\">\n                                             <input type=\\\"hidden\\\" name=\\\"id\\\" value=\\\"{$c2->id}\\\">\n+                                            <input type=\\\"hidden\\\" name=\\\"token\\\" value=\\\"\".TOKEN.\"\\\">\n                                             <span class=\\\"input-group-btn\\\">\n                                                 <button class=\\\"btn btn-default\\\" type=\\\"submit\\\" name=\\\"updatecat\\\">Go!</button>\n                                             </span>\n@@ -92,7 +121,7 @@\n                     <label>Parent</label>\n                     <?php\n                         $vars = array(\n-                                    'parent' => '',\n+                                    'parent' => '0',\n                                     'name' => 'parent',\n                                     'sort' => 'ASC',\n                                     'order_by' => 'name'\n@@ -107,6 +136,7 @@\n             \n           </div>\n           <div class=\"modal-footer\">\n+            <input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n             <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n             <button type=\"submit\" class=\"btn btn-success\" name=\"addcat\">Save changes</button>\n           </div>"
        },
        {
          "filename": "gxadmin/inc/menus.php",
          "status": "modified",
          "additions": 33,
          "deletions": 2,
          "patch": "@@ -12,7 +12,37 @@\n * @copyright 2014-2015 Puguh Wijayanto\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n-*/?>\n+*/\n+\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertgreen'] as $alert) {\n+        # code...\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}elseif (isset($data['alertred'])) {\n+    # code...\n+    //print_r($data['alertred']);\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertred'] as $alert) {\n+        # code...\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}\n+?>\n <div class=\"row\">\n     <div class=\"col-md-12\">\n \n@@ -84,7 +114,7 @@\n                                           </div>\n                                           <div class=\\\"tab-pane\\\" id=\\\"{$k}additem\\\">\n                                           \";\n-                                              $data['parent'] = Menus::getParent('', $k);\n+                                              $data['parent'] = Menus::isHadParent('', $k);\n                                               //print_r($data['parent']);\n                                               $data['menuid'] = $k;\n                                               System::inc('menus_form', $data);\n@@ -146,6 +176,7 @@\n \n           </div>\n           <div class=\"modal-footer\">\n+            <input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n             <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n             <button type=\"submit\" class=\"btn btn-success\" name=\"submit\">Save changes</button>\n           </div>"
        },
        {
          "filename": "gxadmin/inc/menus_form.php",
          "status": "modified",
          "additions": 30,
          "deletions": 0,
          "patch": "@@ -19,6 +19,35 @@\n     }else{\n         $menuid = $data['menuid'];\n     }\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertgreen'] as $alert) {\n+        # code...\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}elseif (isset($data['alertred'])) {\n+    # code...\n+    //print_r($data['alertred']);\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertred'] as $alert) {\n+        # code...\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}\n+\n ?>\n <form action=\"\" method=\"POST\">\n <h1><i class=\"fa fa-sitemap\"></i> Add Menu\n@@ -142,4 +171,5 @@\n         </div>\n     </div>\n </div>\n+<input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n </form>\n\\ No newline at end of file"
        },
        {
          "filename": "gxadmin/inc/menus_form_edit.php",
          "status": "modified",
          "additions": 31,
          "deletions": 7,
          "patch": "@@ -21,12 +21,34 @@\n     }\n \n     //print_r($data['menus']);\n-    if(isset($data['alertgreen']) ) {\n-        echo \"<div class=\\\"alert alert-success\\\">\";\n-            foreach ($data['alertgreen'] as $alert) {\n-                echo \"$alert\"; \n-            }\n-        echo \"</div>\"; }\n+    if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertgreen'] as $alert) {\n+        # code...\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}elseif (isset($data['alertred'])) {\n+    # code...\n+    //print_r($data['alertred']);\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertred'] as $alert) {\n+        # code...\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}\n ?>\n <form action=\"\" method=\"POST\">\n <div class=\"row\">\n@@ -48,11 +70,12 @@\n     <div class=\"col-sm-4\">\n         <div class=\"form-group\">\n             <label>Parent Menu</label>\n+            \n             <select class=\"form-control\" name=\"parent\">\n                 <option></option>\n             <?php\n                //echo($data['abc']);\n-                //print_r($data['parent']);\n+                //print_r($data['menus']);\n                 foreach ($data['parent'] as $p) {\n                     # code...\n                     if($data['menus'][0]->parent == $p->id){\n@@ -183,5 +206,6 @@\n         </div>\n     </div>\n </div>\n+<input type=\"hidden\" name=\"token\" value=\"<?=$_GET['token'];?>\">\n </form>\n </div>\n\\ No newline at end of file"
        },
        {
          "filename": "gxadmin/inc/pages.php",
          "status": "modified",
          "additions": 94,
          "deletions": 82,
          "patch": "@@ -13,101 +13,113 @@\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n */\n-    if (isset($data['alertgreen'])) {\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertgreen'] as $alert) {\n         # code...\n-        echo \"<div class=\\\"alert alert-success\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\";\n-        foreach ($data['alertgreen'] as $alert) {\n-            # code...\n-            echo \"$alert\\n\";\n-        }\n-        echo \"</div>\";\n+        echo \"$alert\\n\";\n     }\n-    if (isset($data['alertred'])) {\n+    echo \"</div>\";\n+}\n+if (isset($data['alertred'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertred'] as $alert) {\n         # code...\n-        echo \"<div class=\\\"alert alert-danger\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\";\n-        foreach ($data['alertred'] as $alert) {\n-            # code...\n-            echo \"$alert\\n\";\n-        }\n-        echo \"</div>\";\n+        echo \"$alert\\n\";\n     }\n+    echo \"</div>\";\n+}\n ?>\n <div class=\"row\">\n     <div class=\"col-md-12\">\n         <h1><i class=\"fa fa-file-o\"></i> Pages <a href=\"index.php?page=pages&act=add\" class=\"btn btn-primary pull-right\">Add New</a></h1>\n         <hr />\n     </div>\n     <div class=\"col-md-12\">\n-        <div class=\"table-responsive\">\n-            <table class=\"table table-hover\">\n-                <thead>\n-                    <tr>\n-                        <th>ID</th>\n-                        <th>Title</th>\n-                        <th>Date</th>\n-                        <th>Edit/Delete</th>\n-                        <th>All <input type=\"checkbox\" id=\"selectall\"></th>\n-                    </tr>\n-                </thead>\n-                <tbody>\n-                    <?php\n-                        //print_r($data);\n-                    if($data['num'] > 0){\n-                        foreach ($data['posts'] as $p) {\n-                            # code...\n-                            //echo $p->id;\n+        <form action=\"\" method=\"post\">\n+            <div class=\"table-responsive\">\n+                <table class=\"table table-hover\">\n+                    <thead>\n+                        <tr>\n+                            <th>ID</th>\n+                            <th>Title</th>\n+                            <th>Date</th>\n+                            <th>Status</th>\n+                            <th>Edit/Delete</th>\n+                            <th>All <input type=\"checkbox\" id=\"selectall\"></th>\n+                        </tr>\n+                    </thead>\n+                    <tbody>\n+                        <?php\n+                            //print_r($data);\n+                        if($data['num'] > 0){\n+                            foreach ($data['posts'] as $p) {\n+                                # code...\n+                                //echo $p->id;\n+                                if($p->status == '0'){\n+                                    $status = \"UnPublished\";\n+                                }else{\n+                                    $status = \"Published\";\n+                                }\n+                                echo \"\n+                                <tr>\n+                                    <td>{$p->id}</td>\n+                                    <td><a href=\\\"\".Url::page($p->id).\"\\\" target=\\\"_new\\\">{$p->title}</a></td>\n+                                    <td>{$p->date}</td>\n+                                    <td>{$status}</td>\n+                                    <td>\n+                                        <a href=\\\"index.php?page=pages&act=edit&id={$p->id}&token=\".TOKEN.\"\\\" class=\\\"label label-success\\\">Edit</a> \n+                                        <a href=\\\"index.php?page=pages&act=del&id={$p->id}&token=\".TOKEN.\"\\\" class=\\\"label label-danger\\\" \n+                                        onclick=\\\"return confirm('Are you sure you want to delete this item?');\\\">Delete</a>\n+                                    </td>\n+                                        <td>\n+                                        <input type=\\\"checkbox\\\" name=\\\"post_id[]\\\" value=\\\"{$p->id}\\\" id=\\\"select\\\">\n+                                    </td>\n+                                </tr>\n+                                \";\n+                            }\n+                        }else{\n                             echo \"\n-                            <tr>\n-                                <td>{$p->id}</td>\n-                                <td><a href=\\\"\".Url::page($p->id).\"\\\" target=\\\"_new\\\">{$p->title}</a></td>\n-                                <td>{$p->date}</td>\n-                                <td>\n-                                    <a href=\\\"index.php?page=pages&act=edit&id={$p->id}\\\" class=\\\"label label-success\\\">Edit</a> \n-                                    <a href=\\\"index.php?page=pages&act=del&id={$p->id}\\\" class=\\\"label label-danger\\\" \n-                                    onclick=\\\"return confirm('Are you sure you want to delete this item?');\\\">Delete</a>\n-                                </td>\n+                                <tr>\n                                     <td>\n-                                    <input type=\\\"checkbox\\\" name=\\\"post_id[]\\\" value=\\\"{$p->id}\\\" id=\\\"select\\\">\n-                                </td>\n-                            </tr>\n-                            \";\n+                                        No Pages Found \n+                                    </td>\n+                                </tr>\";\n                         }\n-                    }else{\n-                        echo \"\n-                            <tr>\n-                                <td>\n-                                    No Pages Found \n-                                </td>\n-                            </tr>\";\n-                    }\n-                    ?>\n-                </tbody>\n-                <tfoot>\n-                    <th>ID</th>\n-                    <th>Title</th>\n-                    <th>Date</th>\n-                    <th>\n-                    <select name=\"action\" class=\"form-control\">\n-                        <option value=\"publish\">Publish</option>\n-                        <option value=\"unpublish\">UnPublish</option>\n-                        <option value=\"delete\">Delete</option>\n-                    </select>\n-                    </th>\n-                    <th>\n-                        <button type=\"submit\" name=\"doaction\" class=\"btn btn-danger\">\n-                            Submit\n-                        </button>\n-                    </th>\n-                </tfoot>\n-            </table>\n-        </div>\n+                        ?>\n+                    </tbody>\n+                    <tfoot>\n+                        <th>ID</th>\n+                        <th>Title</th>\n+                        <th>Date</th>\n+                        <th>Status</th>\n+                        <th>\n+                        <select name=\"action\" class=\"form-control\">\n+                            <option value=\"publish\">Publish</option>\n+                            <option value=\"unpublish\">UnPublish</option>\n+                            <option value=\"delete\">Delete</option>\n+                        </select>\n+                        <input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n+                        </th>\n+                        <th>\n+                            <button type=\"submit\" name=\"doaction\" class=\"btn btn-danger\">\n+                                Submit\n+                            </button>\n+                        </th>\n+                    </tfoot>\n+                </table>\n+            </div>\n+        </form>\n+        \n     </div>\n </div>\n\\ No newline at end of file"
        },
        {
          "filename": "gxadmin/inc/pages_form.php",
          "status": "modified",
          "additions": 33,
          "deletions": 13,
          "patch": "@@ -13,20 +13,39 @@\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n */\n-    if (isset($data['alertgreen'])) {\n+\n+isset($_GET['token'])? $token = $_GET['token']: $token = TOKEN;\n+($_GET['act'] == \"edit\")? $pagetitle = \"Edit\": $pagetitle = \"New\";\n+($_GET['act'] == \"edit\")? $act = \"edit&id={$_GET['id']}&token={$_GET['token']}\": $act = \"add\";\n+\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    \";\n+    foreach ($data['alertgreen'] as $alert) {\n         # code...\n-        echo \"<div class=\\\"alert alert-success\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\n-        \";\n-        foreach ($data['alertgreen'] as $alert) {\n-            # code...\n-            echo \"$alert\\n\";\n-        }\n-        echo \"</div>\";\n+        echo \"$alert\\n\";\n+    }\n+    echo \"</div>\";\n+}\n+\n+if (isset($data['alertred'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertred'] as $alert) {\n+        # code...\n+        echo \"$alert\\n\";\n     }\n+    echo \"</div>\";\n+}\n \n     if(isset($data['post'])) {\n         foreach ($data['post'] as $p) {\n@@ -54,7 +73,7 @@\n         $unpub = \"\";\n     }\n ?>\n-<form action=\"\" method=\"post\" role=\"form\" class=\"\">\n+<form action=\"index.php?page=pages&act=<?=$act?>\" method=\"post\" role=\"form\" class=\"\">\n <div class=\"row\">\n     <div class=\"col-md-12\">\n         <h1><i class=\"fa fa-file-o\"></i> New Page \n@@ -114,5 +133,6 @@\n         \n     </div>\n </div>\n+<input type=\"hidden\" name=\"token\" value=\"<?=$token;?>\">\n </form>\n "
        },
        {
          "filename": "gxadmin/inc/posts.php",
          "status": "modified",
          "additions": 11,
          "deletions": 2,
          "patch": "@@ -55,6 +55,7 @@\n                 <th>Title</th>\n                 <th>Category</th>\n                 <th>Date</th>\n+                <th>Status</th>\n                 <th>Edit/Delete</th>\n                 <th>All <input type=\"checkbox\" id=\"selectall\"></th>\n             </tr>\n@@ -66,15 +67,21 @@\n                     foreach ($data['posts'] as $p) {\n                         # code...\n                         //echo $p->id;\n+                        if($p->status == '0'){\n+                            $status = \"UnPublished\";\n+                        }else{\n+                            $status = \"Published\";\n+                        }\n                         echo \"\n                         <tr>\n                             <td>{$p->id}</td>\n                             <td><a href=\\\"\".Url::post($p->id).\"\\\" target=\\\"_new\\\">{$p->title}</a></td>\n                             <td>\".Categories::name($p->cat).\"</td>\n                             <td>{$p->date}</td>\n+                            <td>{$status}</td>\n                             <td>\n-                                <a href=\\\"index.php?page=posts&act=edit&id={$p->id}\\\" class=\\\"label label-success\\\">Edit</a> \n-                                <a href=\\\"index.php?page=posts&act=del&id={$p->id}\\\" class=\\\"label label-danger\\\" \n+                                <a href=\\\"index.php?page=posts&act=edit&id={$p->id}&token=\".TOKEN.\"\\\" class=\\\"label label-success\\\">Edit</a> \n+                                <a href=\\\"index.php?page=posts&act=del&id={$p->id}&token=\".TOKEN.\"\\\" class=\\\"label label-danger\\\" \n                                 onclick=\\\"return confirm('Are you sure you want to delete this item?');\\\">Delete</a>\n                             </td>\n                             <td>\n@@ -98,12 +105,14 @@\n             <th>Title</th>\n             <th>Category</th>\n             <th>Date</th>\n+            <th>Status</th>\n             <th>\n             <select name=\"action\" class=\"form-control\">\n                 <option value=\"publish\">Publish</option>\n                 <option value=\"unpublish\">UnPublish</option>\n                 <option value=\"delete\">Delete</option>\n             </select>\n+            <input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n             </th>\n             <th>\n                 <button type=\"submit\" name=\"doaction\" class=\"btn btn-danger\">"
        },
        {
          "filename": "gxadmin/inc/posts_form.php",
          "status": "modified",
          "additions": 52,
          "deletions": 48,
          "patch": "@@ -13,63 +13,66 @@\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n */\n-    if (isset($data['alertgreen'])) {\n+isset($_GET['token'])? $token = $_GET['token']: $token = TOKEN;\n+($_GET['act'] == \"edit\")? $pagetitle = \"Edit\": $pagetitle = \"New\";\n+($_GET['act'] == \"edit\")? $act = \"edit&id={$_GET['id']}&token={$_GET['token']}\": $act = \"add\";\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertgreen'] as $alert) {\n         # code...\n-        echo \"<div class=\\\"alert alert-success\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\";\n-        foreach ($data['alertgreen'] as $alert) {\n-            # code...\n-            echo \"$alert\\n\";\n-        }\n-        echo \"</div>\";\n+        echo \"$alert\\n\";\n     }\n-    if (isset($data['alertred'])) {\n+    echo \"</div>\";\n+}\n+if (isset($data['alertred'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertred'] as $alert) {\n         # code...\n-        echo \"<div class=\\\"alert alert-danger\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\";\n-        foreach ($data['alertred'] as $alert) {\n-            # code...\n-            echo \"$alert\\n\";\n-        }\n-        echo \"</div>\";\n+        echo \"$alert\\n\";\n     }\n+    echo \"</div>\";\n+}\n \n-    if(isset($data['post'])) {\n-        foreach ($data['post'] as $p) {\n-            # code...\n-            $title = $p->title;\n-            $content = $p->content;\n-            $date = $p->date;\n-            $status = $p->status;\n-            $cat = $p->cat;\n-        }\n-        if($status == 1) {\n-            $pub = \"SELECTED\"; \n-            $unpub = \"\"; \n-        }elseif ($status == 0) {\n-            $pub = \"\"; \n-            $unpub = \"SELECTED\";\n-        }\n-    }else{\n-        $title = \"\";\n-        $content = \"\";\n-        $date = \"\";\n-        $status = \"\";\n-        $cat = \"\";\n-        $pub = \"\";\n-        $unpub = \"\";\n+if(isset($data['post'])) {\n+    foreach ($data['post'] as $p) {\n+        # code...\n+        $title = $p->title;\n+        $content = $p->content;\n+        $date = $p->date;\n+        $status = $p->status;\n+        $cat = $p->cat;\n+    }\n+    if($status == 1) {\n+        $pub = \"SELECTED\"; \n+        $unpub = \"\"; \n+    }elseif ($status == 0) {\n+        $pub = \"\"; \n+        $unpub = \"SELECTED\";\n     }\n+}else{\n+    $title = \"\";\n+    $content = \"\";\n+    $date = \"\";\n+    $status = \"\";\n+    $cat = \"\";\n+    $pub = \"\";\n+    $unpub = \"\";\n+}\n ?>\n-<form action=\"\" method=\"post\" role=\"form\" class=\"\">\n+<form action=\"index.php?page=posts&act=<?=$act?>\" method=\"post\" role=\"form\" class=\"\">\n <div class=\"row\">\n     <div class=\"col-md-12\">\n-        <h1><i class=\"fa fa-file-text-o\"></i> New Post\n+        <h1><i class=\"fa fa-file-text-o\"></i> <?=$pagetitle;?> Post\n             <div class=\"pull-right\">\n                 <button type=\"submit\" name=\"submit\" class=\"btn btn-success\">\n                     <span class=\"glyphicon glyphicon-ok\"></span>\n@@ -141,5 +144,6 @@\n         \n     </div>\n </div>\n+<input type=\"hidden\" name=\"token\" value=\"<?=$token;?>\">\n </form>\n "
        },
        {
          "filename": "gxadmin/inc/settings.php",
          "status": "modified",
          "additions": 39,
          "deletions": 7,
          "patch": "@@ -12,7 +12,38 @@\n * @copyright 2014-2015 Puguh Wijayanto\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n-*/?>\n+*/\n+\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    \";\n+    foreach ($data['alertgreen'] as $alert) {\n+        # code...\n+        echo \"$alert\\n\";\n+    }\n+    echo \"</div>\";\n+}\n+\n+if (isset($data['alertred'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\";\n+    foreach ($data['alertred'] as $alert) {\n+        # code...\n+        echo \"$alert\\n\";\n+    }\n+    echo \"</div>\";\n+}\n+\n+?>\n <form action=\"\" method=\"POST\" enctype=\"multipart/form-data\">\n <div class=\"row\">\n     <div class=\"col-md-12\">\n@@ -50,7 +81,7 @@\n                   <div class=\"row\">\n                       <div class=\"col-sm-6 form-group\">\n                           <label>Website Name</label>\n-                          <input type=\"text\" name=\"sitename\" value=\"<?=Options::get('sitename');?>\" class=\"form-control\">\n+                          <input type=\"text\" name=\"sitename\" value=\"<?=Site::$name;?>\" class=\"form-control\">\n                           <small>Your Website Name, Title</small>\n                       </div>\n                       <div class=\"col-sm-6 form-group\">\n@@ -66,12 +97,12 @@\n                   <div class=\"row\">\n                       <div class=\"col-sm-6 form-group\">\n                           <label>Website Domain</label>\n-                          <input type=\"text\" name=\"sitedomain\" value=\"<?=Options::get('sitedomain');?>\" class=\"form-control\">\n+                          <input type=\"text\" name=\"sitedomain\" value=\"<?=Site::$domain;?>\" class=\"form-control\">\n                           <small>Your Domain, eg: example.org</small>\n                       </div>\n                       <div class=\"col-sm-6 form-group\">\n                           <label>Website URL</label>\n-                          <input type=\"text\" name=\"siteurl\" value=\"<?=Options::get('siteurl');?>\" class=\"form-control\">\n+                          <input type=\"text\" name=\"siteurl\" value=\"<?=Site::$url;?>\" class=\"form-control\">\n                           <small>Your Website URL, eg: http://www.example.org</small>\n                       </div>\n                   </div>\n@@ -82,12 +113,12 @@\n                   <div class=\"row\">\n                       <div class=\"col-sm-6 form-group\">\n                           <label>Website Keywords</label>\n-                          <input type=\"text\" name=\"sitekeywords\" value=\"<?=Options::get('sitekeywords');?>\" class=\"form-control\">\n+                          <input type=\"text\" name=\"sitekeywords\" value=\"<?=Site::$key;?>\" class=\"form-control\">\n                           <small>Your Website Keywords, type your website main keywords.</small>\n                       </div>\n                       <div class=\"col-sm-6 form-group\">\n                           <label>Website Description</label>\n-                          <textarea  name=\"sitedesc\" class=\"form-control\"><?=Options::get('sitedesc');?></textarea>\n+                          <textarea  name=\"sitedesc\" class=\"form-control\"><?=Site::$desc;?></textarea>\n                           <small>Your Website Description, describe your website.</small>\n                       </div>\n                   </div>\n@@ -224,7 +255,7 @@\n                               if($is_logourl == 'on' && $logourl != ''){\n                                 $logoimg = \"<img src=\\\"\".Options::get('logourl').\"\\\" class=\\\"clearfix\\\">\";\n                               }elseif($is_logourl == 'off' && $logo != ''){\n-                                $logoimg = \"<img src=\\\"\".Options::get('siteurl').Options::get('logo').\"\\\" class=\\\"clearfix\\\">\";\n+                                $logoimg = \"<img src=\\\"\".Site::$url.Options::get('logo').\"\\\" class=\\\"clearfix\\\">\";\n                               }else{\n                                 $logoimg = '';\n                               }\n@@ -562,6 +593,7 @@ class=\"form-control disable\" placeholder=\"Bootstrap Validator Version\"\n \n     </div>\n </div>\n+<input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n </form>\n <script>\n $('#myTab a').click(function (e) {"
        },
        {
          "filename": "gxadmin/inc/user.php",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -75,9 +75,9 @@\n                         <td>{$p->userid}</td>\n                         <td>{$p->email}</td>\n                         <td>\n-                            <a href=\\\"index.php?page=users&act=edit&id={$p->id}\\\" class=\\\"label label-success\\\">Edit</a> \n-                            <a href=\\\"index.php?page=users&act=del&id={$p->id}\\\" class=\\\"label label-danger\\\" \n-                            onclick=\\\"return confirm('Are you sure you want to delete this item?');\\\">Delete</a>\n+                            <a href=\\\"index.php?page=users&act=edit&id={$p->id}&token=\".TOKEN.\"\\\" class=\\\"label label-success\\\">Edit</a> \n+                            <a href=\\\"index.php?page=users&act=del&id={$p->id}&token=\".TOKEN.\"\\\" class=\\\"label label-danger\\\" \n+                            onclick=\\\"return confirm('Are you sure you want to delete this?');\\\">Delete</a>\n                         </td>\n                     </tr>\n                     \";\n@@ -114,7 +114,7 @@\n                 </div>\n                 <div class=\"form-group\">\n                     <label>E-Mail</label>\n-                    <input type=\"password\" name=\"email\" class=\"form-control\">\n+                    <input type=\"email\" name=\"email\" class=\"form-control\">\n                 </div>\n                 <div class=\"form-group\">\n                     <label>Group Level</label>\n@@ -129,6 +129,7 @@\n             <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n             <button type=\"submit\" class=\"btn btn-success\" name=\"adduser\">Save changes</button>\n           </div>\n+          <input type=\"hidden\" name=\"token\" value=\"<?=TOKEN;?>\">\n           </form>\n         </div><!-- /.modal-content -->\n       </div><!-- /.modal-dialog -->"
        },
        {
          "filename": "gxadmin/inc/user_form.php",
          "status": "modified",
          "additions": 26,
          "deletions": 25,
          "patch": "@@ -13,34 +13,34 @@\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n */\n-    if (isset($data['alertgreen'])) {\n+if (isset($data['alertgreen'])) {\n+    # code...\n+    echo \"<div class=\\\"alert alert-success\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertgreen'] as $alert) {\n         # code...\n-        echo \"<div class=\\\"alert alert-success\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\n-        <ul>\";\n-        foreach ($data['alertgreen'] as $alert) {\n-            # code...\n-            echo \"<li>$alert</li>\\n\";\n-        }\n-        echo \"</ul></div>\";\n-    }elseif (isset($data['alertred'])) {\n+        echo \"<li>$alert</li>\\n\";\n+    }\n+    echo \"</ul></div>\";\n+}elseif (isset($data['alertred'])) {\n+    # code...\n+    //print_r($data['alertred']);\n+    echo \"<div class=\\\"alert alert-danger\\\" >\n+    <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n+        <span aria-hidden=\\\"true\\\">&times;</span>\n+        <span class=\\\"sr-only\\\">Close</span>\n+    </button>\n+    <ul>\";\n+    foreach ($data['alertred'] as $alert) {\n         # code...\n-        //print_r($data['alertred']);\n-        echo \"<div class=\\\"alert alert-danger\\\" >\n-        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"alert\\\">\n-            <span aria-hidden=\\\"true\\\">&times;</span>\n-            <span class=\\\"sr-only\\\">Close</span>\n-        </button>\n-        <ul>\";\n-        foreach ($data['alertred'] as $alert) {\n-            # code...\n-            echo \"<li>$alert</li>\\n\";\n-        }\n-        echo \"</ul></div>\";\n+        echo \"<li>$alert</li>\\n\";\n     }\n+    echo \"</ul></div>\";\n+}\n ?>\n <form action=\"\" method=\"post\">\n <div class=\"row\">\n@@ -109,4 +109,5 @@\n     </div>\n     </div>\n </div>\n+<input type=\"hidden\" name=\"token\" value=\"<?=$_GET['token'];?>\">\n </form>"
        },
        {
          "filename": "inc/lib/Categories.class.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -68,14 +68,17 @@ public static function dropdown($vars) {\n             }\n             if (isset($vars['sort'])) {\n                 $sort = \" {$vars['sort']}\";\n+            }else{\n+                $sort = \" ASC\";\n             }\n         }\n         $cat = Db::result(\"SELECT * FROM `cat` {$where} {$order_by} {$sort}\");\n+        //print_r($cat);\n         $drop = \"<select name=\\\"{$name}\\\" class=\\\"form-control\\\"><option></option>\";\n         if(Db::$num_rows > 0 ){\n             foreach ($cat as $c) {\n                 # code...\n-                if($c->parent == ''){\n+                if($c->parent == null || $c->parent == '0' ){\n                     if(isset($vars['selected']) && $c->id == $vars['selected']) $sel = \"SELECTED\"; else $sel = \"\";\n                     $drop .= \"<option value=\\\"{$c->id}\\\" $sel style=\\\"padding-left: 10px;\\\">{$c->name}</option>\";\n                     foreach ($cat as $c2) {"
        },
        {
          "filename": "inc/lib/Control.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -145,11 +145,11 @@ public static function backend($vars=\"\") {\n     * @author Puguh Wijayanto (www.metalgenix.com)\n     * @since 0.0.1 \n     */\n-    public static function error ($vars=\"\") {\n+    public static function error ($vars=\"\", $val='') {\n         if( isset($vars) && $vars != \"\" ) {\n             include(GX_PATH.'/inc/lib/Control/Error/'.$vars.'.control.php');\n         }else{\n-            include(GX_PATH.'/inc/lib/Control/Error/404.control.php');\n+            include(GX_PATH.'/inc/lib/Control/Error/unknown.control.php');\n         }\n     }\n "
        },
        {
          "filename": "inc/lib/Control/Backend/categories.control.php",
          "status": "modified",
          "additions": 44,
          "deletions": 11,
          "patch": "@@ -16,8 +16,23 @@\n switch (isset($_POST['addcat'])) {\n     case true:\n         # code...\n-        $slug = Typo::slugify($_POST['cat']);\n-        $cat = Db::insert(\"INSERT INTO `cat` VALUES ('', '{$_POST['cat']}', '{$slug}', '{$_POST['parent']}', '' )\");\n+        if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+            // VALIDATE ALL\n+            $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+        }\n+        if(isset($alertred)){\n+            $data['alertred'] = $alertred;\n+        }else{\n+            $slug = Typo::slugify(Typo::cleanX($_POST['cat']));\n+            $cat = Typo::cleanX($_POST['cat']);\n+            $cat = Db::insert(\n+                        sprintf(\"INSERT INTO `cat` VALUES (null, '%s', '%s', '%d', '' )\", \n+                            $cat, $slug, $_POST['parent']\n+                        )\n+                    );\n+            //print_r($cat);\n+            $data['alertgreen'][] = \"Category Added: \".$_POST['cat'];\n+        }\n         break;\n     \n     default:\n@@ -28,14 +43,23 @@\n switch (isset($_POST['updatecat'])) {\n     case true:\n         # code...\n-        $vars = array(\n-                    'table' => 'cat',\n-                    'id' => $_POST['id'],\n-                    'key' => array(\n-                                'name' => $_POST['cat']\n-                            )\n-                );\n-        $cat = Db::update($vars);\n+        if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+            // VALIDATE ALL\n+            $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+        }\n+        if(isset($alertred)){\n+            $data['alertred'] = $alertred;\n+        }else{\n+            $vars = array(\n+                        'table' => 'cat',\n+                        'id' => $_POST['id'],\n+                        'key' => array(\n+                                    'name' => Typo::cleanX($_POST['cat'])\n+                                )\n+                    );\n+            $cat = Db::update($vars);\n+            $data['alertgreen'][] = \"Category Updated: \".$_POST['cat'];\n+        }\n         break;\n     \n     default:\n@@ -44,7 +68,16 @@\n }\n \n if(isset($_GET['act']) == 'del'){\n-    Categories::delete($_GET['id']);\n+    if (!isset($_GET['token']) || !Token::isExist($_GET['token'])) {\n+        // VALIDATE ALL\n+        $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+    }\n+    if(isset($alertred)){\n+        $data['alertred'] = $alertred;\n+    }else{\n+        Categories::delete($_GET['id']);\n+        $data['alertgreen'][] = \"Category Removed\";\n+    }\n }\n $data['cat'] = Db::result(\"SELECT * FROM `cat` ORDER BY `id` DESC\");\n $data['num'] = Db::$num_rows;"
        },
        {
          "filename": "inc/lib/Control/Backend/menus.control.php",
          "status": "modified",
          "additions": 145,
          "deletions": 100,
          "patch": "@@ -27,61 +27,69 @@\n         switch ($submit) {\n             case true:\n                 # code...\n-                $menus = Options::get('menus');\n-                $menus = json_decode(Options::get('menus'), true);\n-                echo \"<pre>\"; print_r($menus); echo \"</pre>\";\n-                // $menu = array(\n-                //                 $_POST['id']  =>  array(\n-                //                             'name' => $menus[$_POST['id']]['name'],\n-                //                             'class' => $menus[$_POST['id']]['class'],\n-                //                             'menu' => array(\n-                //                                     'parent' => $_POST['parent'],\n-                //                                     'menuid' => $_POST['id'],\n-                //                                     'type' => $_POST['type'],\n-                //                                     'value' => $_POST[$_POST['type']]\n-                //                                 )\n-                //                         )\n-                //                 );\n-                \n-                // if(is_array($menus)){\n-                //     $menu = array_merge($menus, $menu);\n-                // }\n-                // echo \"<pre>\"; print_r($menu); echo \"</pre>\";\n-                //$menu = $menus;\n-                $menu[$_POST['id']]['menu'] = $menus[$_POST['id']]['menu'];\n-                $menu[$_POST['id']]['menu'][] = array(\n-                                                    'parent' => $_POST['parent'],\n-                                                    'menuid' => $_POST['id'],\n-                                                    'name' => $_POST['name'],\n-                                                    'type' => $_POST['type'],\n-                                                    'value' => $_POST[$_POST['type']],\n-                                                    'sub' => ''\n-                                                );\n-                 $menu = array(\n-                                $_POST['id']  =>  array(\n-                                            'name' => $menus[$_POST['id']]['name'],\n-                                            'class' => $menus[$_POST['id']]['class'],\n-                                            'menu' => $menu[$_POST['id']]['menu']    \n-                                        )\n-                                );\n-                if(is_array($menus)){\n-                    $menu = array_merge($menus, $menu);\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    $menus = Options::get('menus');\n+                    $menus = json_decode(Options::get('menus'), true);\n+                   //echo \"<pre>\"; print_r($menus); echo \"</pre>\";\n+                    // $menu = array(\n+                    //                 $_POST['id']  =>  array(\n+                    //                             'name' => $menus[$_POST['id']]['name'],\n+                    //                             'class' => $menus[$_POST['id']]['class'],\n+                    //                             'menu' => array(\n+                    //                                     'parent' => $_POST['parent'],\n+                    //                                     'menuid' => $_POST['id'],\n+                    //                                     'type' => $_POST['type'],\n+                    //                                     'value' => $_POST[$_POST['type']]\n+                    //                                 )\n+                    //                         )\n+                    //                 );\n+                    \n+                    // if(is_array($menus)){\n+                    //     $menu = array_merge($menus, $menu);\n+                    // }\n+                    // echo \"<pre>\"; print_r($menu); echo \"</pre>\";\n+                    //$menu = $menus;\n+                    $menu[$_POST['id']]['menu'] = $menus[$_POST['id']]['menu'];\n+                    $menu[$_POST['id']]['menu'][] = array(\n+                                                        'parent' => $_POST['parent'],\n+                                                        'menuid' => $_POST['id'],\n+                                                        'name' => Typo::cleanX($_POST['name']),\n+                                                        'type' => $_POST['type'],\n+                                                        'value' => $_POST[$_POST['type']],\n+                                                        'sub' => ''\n+                                                    );\n+                     $menu = array(\n+                                    $_POST['id']  =>  array(\n+                                                'name' => $menus[$_POST['id']]['name'],\n+                                                'class' => $menus[$_POST['id']]['class'],\n+                                                'menu' => $menu[$_POST['id']]['menu']    \n+                                            )\n+                                    );\n+                    if(is_array($menus)){\n+                        $menu = array_merge($menus, $menu);\n+                    }\n+                    //echo \"<pre>\"; print_r($menu); echo \"</pre>\";\n+                    $menu = json_encode($menu);\n+                    //echo \"<pre>\"; print_r($menu); echo \"</pre>\";\n+                    //Options::update('menus', $menu);\n+\n+                    $vars = array(\n+                                'parent' => $_POST['parent'],\n+                                'menuid' => $_POST['id'],\n+                                'name' => Typo::cleanX($_POST['name']),\n+                                'class' => Typo::cleanX($_POST['class']),\n+                                'type' => $_POST['type'],\n+                                'value' => $_POST[$_POST['type']]\n+                            );\n+                    Menus::insert($vars);\n+                    $data['alertgreen'][] = 'Menu Added';\n                 }\n-                 echo \"<pre>\"; print_r($menu); echo \"</pre>\";\n-                $menu = json_encode($menu);\n-                echo \"<pre>\"; print_r($menu); echo \"</pre>\";\n-                //Options::update('menus', $menu);\n-\n-                $vars = array(\n-                            'parent' => $_POST['parent'],\n-                            'menuid' => $_POST['id'],\n-                            'name' => $_POST['name'],\n-                            'class' => $_POST['class'],\n-                            'type' => $_POST['type'],\n-                            'value' => $_POST[$_POST['type']]\n-                        );\n-                Menus::insert($vars);\n-                $data['alertgreen'][] = 'Menu Added';\n                 break;\n             \n             default:\n@@ -95,7 +103,7 @@\n         }else{\n             $menuid = '';\n         }\n-        $data['parent'] = Menus::getParent('', $menuid);\n+        $data['parent'] = Menus::isHadParent('', $menuid);\n         //echo \"<pre>\"; print_r($data); echo \"</pre>\";\n         System::inc('menus_form', $data);\n         break;\n@@ -110,22 +118,29 @@\n         }\n         switch ($submit) {\n             case true:\n-                \n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n \n-                $vars = array(\n-                            // 'parent' => $_POST['parent'],\n-                            'menuid' => $_POST['id'],\n-                            'name' => $_POST['name'],\n-                            'class' => $_POST['class'],\n-                            'type' => $_POST['type'],\n-                            'value' => $_POST[$_POST['type']]\n-                        );\n-                $vars = array(\n-                            'id' => $_GET['itemid'],\n-                            'key' => $vars\n-                        );\n-                Menus::update($vars);\n-                $data['alertgreen'][] = 'Menu Updated';\n+                    $vars = array(\n+                                'parent' => $_POST['parent'],\n+                                'menuid' => $_POST['id'],\n+                                'name' => Typo::cleanX($_POST['name']),\n+                                'class' => Typo::cleanX($_POST['class']),\n+                                'type' => $_POST['type'],\n+                                'value' => $_POST[$_POST['type']]\n+                            );\n+                    $vars = array(\n+                                'id' => $_GET['itemid'],\n+                                'key' => $vars\n+                            );\n+                    Menus::update($vars);\n+                    $data['alertgreen'][] = 'Menu Updated';\n+                }\n                 break;\n             \n             default:\n@@ -140,13 +155,21 @@\n             $menuid = '';\n         }\n         $data['menus'] = Menus::getId($_GET['itemid']);\n-        $data['parent'] = Menus::getParent('', $menuid);\n+        $data['parent'] = Menus::isHadParent('', $menuid);\n         System::inc('menus_form_edit', $data);\n         break;\n     case 'del':\n         if(isset($_GET['itemid'])){\n-            Menus::delete($_GET['itemid']);\n-            $data['alertgreen'][] = 'Menu Deleted';\n+            if (!isset($_GET['token']) || !Token::isExist($_GET['token'])) {\n+                // VALIDATE ALL\n+                $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+            }\n+            if(isset($alertred)){\n+                $data['alertred'] = $alertred;\n+            }else{\n+                Menus::delete($_GET['itemid']);\n+                $data['alertgreen'][] = 'Menu Deleted';\n+            }\n         }else{\n             $data['alertred'][] = 'No ID Selected.';\n         }\n@@ -162,20 +185,28 @@\n         switch ($submit) {\n             case true:\n                 # code...\n-                $menu = array(\n-                                $_POST['id']  =>  array(\n-                                            'name' => $_POST['name'],\n-                                            'class' => $_POST['class'],\n-                                            'menu' => array()\n-                                        )\n-                                );\n-                $menus = json_decode(Options::get('menus'), true);\n-                if(is_array($menus)){\n-                    $menu = array_merge($menus, $menu);\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    $menu = array(\n+                                    $_POST['id']  =>  array(\n+                                                'name' => Typo::cleanX($_POST['name']),\n+                                                'class' => Typo::cleanX($_POST['class']),\n+                                                'menu' => array()\n+                                            )\n+                                    );\n+                    $menus = json_decode(Options::get('menus'), true);\n+                    if(is_array($menus)){\n+                        $menu = array_merge($menus, $menu);\n+                    }\n+                    \n+                    $menu = json_encode($menu);\n+                    Options::update('menus', $menu);\n                 }\n-                \n-                $menu = json_encode($menu);\n-                Options::update('menus', $menu);\n                 break;\n             \n             default:\n@@ -196,17 +227,24 @@\n         switch ($submit) {\n             case true:\n                 \n-\n-                $vars = array(\n-                            'parent' => $_POST['parent'],\n-                            'menuid' => $_POST['id'],\n-                            'name' => $_POST['name'],\n-                            'class' => $_POST['class'],\n-                            'type' => $_POST['type'],\n-                            'value' => $_POST[$_POST['type']]\n-                        );\n-                Menus::insert($vars);\n-                $data['alertgreen'][] = 'Menu Item Added';\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    $vars = array(\n+                                'parent' => $_POST['parent'],\n+                                'menuid' => $_POST['id'],\n+                                'name' => Typo::cleanX($_POST['name']),\n+                                'class' => Typo::cleanX($_POST['class']),\n+                                'type' => $_POST['type'],\n+                                'value' => $_POST[$_POST['type']]\n+                            );\n+                    Menus::insert($vars);\n+                    $data['alertgreen'][] = 'Menu Item Added';\n+                }\n                 break;\n             \n             default:\n@@ -230,9 +268,16 @@\n                 // echo \"<pre>\";\n                 // print_r($_POST['order']);\n                 // echo \"</pre>\";\n-\n-                Menus::updateMenuOrder($_POST['order']);\n-                $data['alertgreen'][] = 'Menu Order Changed';\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    Menus::updateMenuOrder($_POST['order']);\n+                    $data['alertgreen'][] = 'Menu Order Changed';\n+                }\n                 break;\n             \n             default:"
        },
        {
          "filename": "inc/lib/Control/Backend/pages.control.php",
          "status": "modified",
          "additions": 88,
          "deletions": 40,
          "patch": "@@ -23,23 +23,31 @@\n         switch (isset($_POST['submit'])) {\n             case true:\n                 # code...\n-                if (!isset($_POST['date']) || $_POST['date'] == \"\") {\n-                    # code...\n-                    $date = date(\"Y-m-d H:i:s\");\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n                 }else{\n-                    $date = $_POST['date'];\n+                    if (!isset($_POST['date']) || $_POST['date'] == \"\") {\n+                        # code...\n+                        $date = date(\"Y-m-d H:i:s\");\n+                    }else{\n+                        $date = $_POST['date'];\n+                    }\n+                    $vars = array(\n+                                    'title' => Typo::cleanX($_POST['title']),\n+                                    'content' => Typo::cleanX($_POST['content']),\n+                                    'date' => $date,\n+                                    'type' => 'page',\n+                                    'author' => Session::val('username'),\n+                                    'status' => $_POST['status'],\n+                                );\n+                    //print_r($vars);\n+                    Posts::insert($vars);\n+                    $data['alertgreen'][] = \"Page : {$_POST['title']} Added.\";\n                 }\n-                $vars = array(\n-                                'title' => Typo::cleanX($_POST['title']),\n-                                'content' => Typo::cleanX($_POST['content']),\n-                                'date' => $date,\n-                                'type' => 'page',\n-                                'author' => Session::val('username'),\n-                                'status' => $_POST['status'],\n-                            );\n-                //print_r($vars);\n-                Posts::insert($vars);\n-                $data['alertgreen'][] = \"Page : {$_POST['title']} Added.\";\n                 break;\n             \n             default:\n@@ -55,23 +63,31 @@\n         switch (isset($_POST['submit'])) {\n             case true:\n                 # code...\n-                if (!isset($_POST['date']) || $_POST['date'] == \"\") {\n-                    # code...\n-                    $date = date(\"Y-m-d H:i:s\");\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n                 }else{\n-                    $date = $_POST['date'];\n+                    if (!isset($_POST['date']) || $_POST['date'] == \"\") {\n+                        # code...\n+                        $date = date(\"Y-m-d H:i:s\");\n+                    }else{\n+                        $date = $_POST['date'];\n+                    }\n+                    $moddate = date(\"Y-m-d H:i:s\");\n+                    $vars = array(\n+                                    'title' => Typo::cleanX($_POST['title']),\n+                                    'content' => Typo::cleanX($_POST['content']),\n+                                    'modified' => $moddate,\n+                                    'date' => $date,\n+                                    'status' => $_POST['status'],\n+                                );\n+                    //print_r($vars);\n+                    Posts::update($vars);\n+                    $data['alertgreen'][] = \"Page : {$_POST['title']} Updated.\";\n                 }\n-                $moddate = date(\"Y-m-d H:i:s\");\n-                $vars = array(\n-                                'title' => Typo::cleanX($_POST['title']),\n-                                'content' => Typo::cleanX($_POST['content']),\n-                                'modified' => $moddate,\n-                                'date' => $date,\n-                                'status' => $_POST['status'],\n-                            );\n-                //print_r($vars);\n-                Posts::update($vars);\n-                $data['alertgreen'][] = \"Page : {$_POST['title']} Updated.\";\n                 break;\n             \n             default:\n@@ -91,7 +107,15 @@\n         if(isset($_GET['act']) && $_GET['act'] == 'del'){\n             if(isset($_GET['id'])){\n                 $title = Posts::title($_GET['id']);\n-                $del = Posts::delete($_GET['id']);\n+                if (!isset($_GET['token']) || !Token::isExist($_GET['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    $del = Posts::delete($_GET['id']);\n+                }\n                 //echo $title['error'];\n                 if(isset($del['error'])){\n                     $data['alertred'][] = $del['error'];\n@@ -114,23 +138,47 @@\n             \n             case 'publish':\n                 # code...\n-                foreach ($post_id as $id) {\n-                    # code...\n-                    Posts::publish($id);\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    foreach ($post_id as $id) {\n+                        # code...\n+                        Posts::publish($id);\n+                    }\n                 }\n                 break;\n             case 'unpublish':\n                 # code...\n-                foreach ($post_id as $id) {\n-                    # code...\n-                    Posts::unpublish($id);\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    foreach ($post_id as $id) {\n+                        # code...\n+                        Posts::unpublish($id);\n+                    }\n                 }\n                 break;\n             case 'delete':\n                 # code...\n-                foreach ($post_id as $id) {\n-                    # code...\n-                    Posts::delete($id);\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    foreach ($post_id as $id) {\n+                        # code...\n+                        Posts::delete($id);\n+                    }\n                 }\n                 break;\n             "
        },
        {
          "filename": "inc/lib/Control/Backend/posts.control.php",
          "status": "modified",
          "additions": 96,
          "deletions": 41,
          "patch": "@@ -23,24 +23,33 @@\n         switch (isset($_POST['submit'])) {\n             case true:\n                 # code...\n-                if (!isset($_POST['date']) || $_POST['date'] == \"\") {\n-                    # code...\n-                    $date = date(\"Y-m-d H:i:s\");\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if(isset($alertred)){\n+                    $data['alertred'] = $alertred;\n                 }else{\n-                    $date = $_POST['date'];\n+                    if (!isset($_POST['date']) || $_POST['date'] == \"\") {\n+                        # code...\n+                        $date = date(\"Y-m-d H:i:s\");\n+                    }else{\n+                        $date = $_POST['date'];\n+                    }\n+                    $vars = array(\n+                                    'title' => Typo::cleanX($_POST['title']),\n+                                    'cat' => $_POST['cat'],\n+                                    'content' => Typo::cleanX($_POST['content']),\n+                                    'date' => $date,\n+                                    'type' => 'post',\n+                                    'author' => Session::val('username'),\n+                                    'status' => $_POST['status'],\n+                                );\n+                    //print_r($vars);\n+                    Posts::insert($vars);\n+                    $data['alertgreen'][] = \"Post : {$_POST['title']} Added.\";\n                 }\n-                $vars = array(\n-                                'title' => Typo::cleanX($_POST['title']),\n-                                'cat' => $_POST['cat'],\n-                                'content' => Typo::cleanX($_POST['content']),\n-                                'date' => $date,\n-                                'type' => 'post',\n-                                'author' => Session::val('username'),\n-                                'status' => $_POST['status'],\n-                            );\n-                //print_r($vars);\n-                Posts::insert($vars);\n-                $data['alertgreen'][] = \"Post : {$_POST['title']} Added.\";\n+                    \n                 break;\n             \n             default:\n@@ -57,20 +66,29 @@\n         switch (isset($_POST['submit'])) {\n             case true:\n                 # code...\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if (isset($alertred)) {\n+                    # code...\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    $moddate = date(\"Y-m-d H:i:s\");\n+                    $vars = array(\n+                                    'title' => Typo::cleanX($_POST['title']),\n+                                    'cat' => $_POST['cat'],\n+                                    'content' => Typo::cleanX($_POST['content']),\n+                                    'modified' => $moddate,\n+                                    'date' => $_POST['date'],\n+                                    'status' => $_POST['status'],\n+                                );\n+                    //print_r($vars);\n+                    \n+                    Posts::update($vars);\n+                    $data['alertgreen'][] = \"Post : <b>{$_POST['title']}</b> Updated.\";\n+                }\n                 \n-                $moddate = date(\"Y-m-d H:i:s\");\n-                $vars = array(\n-                                'title' => Typo::cleanX($_POST['title']),\n-                                'cat' => $_POST['cat'],\n-                                'content' => Typo::cleanX($_POST['content']),\n-                                'modified' => $moddate,\n-                                'date' => $_POST['date'],\n-                                'status' => $_POST['status'],\n-                            );\n-                //print_r($vars);\n-                \n-                Posts::update($vars);\n-                $data['alertgreen'][] = \"Post : <b>{$_POST['title']}</b> Updated.\";\n                 break;\n             \n             default:\n@@ -89,13 +107,23 @@\n         # code...\n         if(isset($_GET['act']) && $_GET['act'] == 'del'){\n             if(isset($_GET['id'])){\n-                $title = Posts::title($_GET['id']);\n-                $del = Posts::delete($_GET['id']);\n-                //echo $title['error'];\n-                if(isset($del['error'])){\n-                    $data['alertred'][] = $del['error'];\n+                if (!isset($_GET['token']) || !Token::isExist($_GET['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if (isset($alertred)) {\n+                    # code...\n+                    $data['alertred'] = $alertred;\n                 }else{\n-                    $data['alertgreen'][] = 'Post <b>'.$title.'</b> Removed';\n+\n+                    $title = Posts::title($_GET['id']);\n+                    $del = Posts::delete($_GET['id']);\n+                    //echo $title['error'];\n+                    if(isset($del['error'])){\n+                        $data['alertred'][] = $del['error'];\n+                    }else{\n+                        $data['alertgreen'][] = 'Post <b>'.$title.'</b> Removed';\n+                    }\n                 }\n                 \n             }else{\n@@ -113,23 +141,50 @@\n \n             case 'publish':\n                 # code...\n-                foreach ($post_id as $id) {\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if (isset($alertred)) {\n                     # code...\n-                    Posts::publish($id);\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    foreach ($post_id as $id) {\n+                        # code...\n+                        Posts::publish($id);\n+                    }\n                 }\n                 break;\n             case 'unpublish':\n                 # code...\n-                foreach ($post_id as $id) {\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if (isset($alertred)) {\n                     # code...\n-                    Posts::unpublish($id);\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    foreach ($post_id as $id) {\n+                        # code...\n+                        Posts::unpublish($id);\n+                    }\n                 }\n                 break;\n             case 'delete':\n                 # code...\n-                foreach ($post_id as $id) {\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n+                if (isset($alertred)) {\n                     # code...\n-                    Posts::delete($id);\n+                    $data['alertred'] = $alertred;\n+                }else{\n+                    foreach ($post_id as $id) {\n+                        # code...\n+                        Posts::delete($id);\n+                    }\n                 }\n                 break;\n             "
        },
        {
          "filename": "inc/lib/Control/Backend/settings.control.php",
          "status": "modified",
          "additions": 43,
          "deletions": 35,
          "patch": "@@ -14,56 +14,64 @@\n *\n */\n \n-\n+$data = \"\";\n switch (isset($_POST['change'])) {\n     case '1':\n         # code...\n-        $vars = array();\n-        if(isset($_FILES['logo']) && $_FILES['logo'] != ''){\n-            $path = \"/assets/images/\";\n-            $allowed = array('png', 'jpg', 'gif');\n-            $upload = Upload::go('logo', $path, $allowed );\n-            if(isset($upload['error']) != ''){\n-                echo $upload['error'];\n+        if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+            // VALIDATE ALL\n+            $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+        }\n+        if(isset($alertred)){\n+            $data['alertred'] = $alertred;\n+        }else{\n+            $vars = array();\n+            if(isset($_FILES['logo']) && $_FILES['logo'] != ''){\n+                $path = \"/assets/images/\";\n+                $allowed = array('png', 'jpg', 'gif');\n+                $upload = Upload::go('logo', $path, $allowed );\n+                if(isset($upload['error']) != ''){\n+                    echo $upload['error'];\n+                }else{\n+                    $vars['logo'] = $upload['path'];\n+                }\n             }else{\n-                $vars['logo'] = $upload['path'];\n+                unset($_POST['logo']);\n             }\n-        }else{\n-            unset($_POST['logo']);\n-        }\n \n-        \n-        \n-        //print_r($_POST);\n-        $flip = array_flip($_POST);\n-        $sql = \"SELECT * FROM `options` WHERE `value` = 'on'\";        \n-        $q = Db::result($sql);\n-        foreach($q as $ob) {\n-            if( isset( $flip[$ob->name] ) ) {\n-                $vars[$ob->name] = 'on';\n-                //echo $ob->name;\n-            }else{\n-                $vars[$ob->name] = 'off';\n-                //echo $ob->name;\n+            \n+            \n+            //print_r($_POST);\n+            $flip = array_flip($_POST);\n+            $sql = \"SELECT * FROM `options` WHERE `value` = 'on'\";        \n+            $q = Db::result($sql);\n+            foreach($q as $ob) {\n+                if( isset( $flip[$ob->name] ) ) {\n+                    $vars[$ob->name] = 'on';\n+                    //echo $ob->name;\n+                }else{\n+                    $vars[$ob->name] = 'off';\n+                    //echo $ob->name;\n+                }\n             }\n+            //print_r($ob);\n+            foreach ($_POST as $key => $val) {\n+                # code...\n+                $vars[$key] = $val;\n+            }\n+            unset($vars['change']);\n+            //print_r($vars);\n+            Options::update($vars);\n+            $data['alertgreen'][] = \"New Settings Saved.\";\n         }\n-        //print_r($ob);\n-        foreach ($_POST as $key => $val) {\n-            # code...\n-            $vars[$key] = $val;\n-        }\n-        unset($vars['change']);\n-        //print_r($vars);\n-        Options::update($vars);\n-\n         break;\n     \n     default:\n         # code...\n         //print_r($data);\n         break;\n }\n-System::inc('settings');\n+System::inc('settings',$data);\n \n /* End of file settings.control.php */\n /* Location: ./inc/lib/Control/Backend/settings.control.php */\n\\ No newline at end of file"
        },
        {
          "filename": "inc/lib/Control/Backend/users.control.php",
          "status": "modified",
          "additions": 23,
          "deletions": 3,
          "patch": "@@ -23,6 +23,11 @@\n         switch (isset($_POST['edituser'])) {\n             case true:\n                 # code...\n+                //check token first \n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n                 // VALIDATE ALL\n                 if(!User::is_exist($_POST['userid'])){\n                     $alertred[] = \"User Exist!! Choose another userid.\";\n@@ -59,6 +64,8 @@\n                 }else{\n                     $data['alertred'] = $alertred;\n                 }\n+                \n+                \n                 break;\n             \n             default:\n@@ -70,8 +77,14 @@\n     case 'del':\n             if(isset($_GET['id'])){\n                 $user = User::userid($_GET['id']);\n-                User::delete($_GET['id']);\n-                $data['alertgreen'][] = \"User : \".$user.\" Removed\";\n+                if (!isset($_GET['token']) || !Token::isExist($_GET['token'])) {\n+                    // VALIDATE ALL\n+                    $data['alertred'][] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }else{\n+                    User::delete($_GET['id']);\n+                    $data['alertgreen'][] = \"User : \".$user.\" Removed\";\n+                }\n+                \n             }else{\n                 $data['alertred'][] = \"No ID selected\";\n             }\n@@ -85,7 +98,12 @@\n         switch (isset($_POST['adduser'])) {\n             case true:\n                 # code...\n-                // VALIDATE ALL\n+                // CHECK TOKEN FIRST \n+                //echo Token::isExist($_POST['token']);\n+                if (!isset($_POST['token']) || !Token::isExist($_POST['token'])) {\n+                    // VALIDATE ALL\n+                    $alertred[] = \"Token not exist, or your time has expired. Please refresh your browser to get a new token.\";\n+                }\n                 if(!User::is_exist($_POST['userid'])){\n                     $alertred[] = \"User Exist!! Choose another userid.\";\n                 }\n@@ -108,9 +126,11 @@\n                                     \n                                 );   \n                     User::create($vars);\n+                    Token::remove(TOKEN);\n                 }else{\n                     $data['alertred'] = $alertred;\n                 }\n+\n                 break;\n             \n             default:"
        },
        {
          "filename": "inc/lib/Control/Error/db.control.php",
          "status": "added",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -0,0 +1,8 @@\n+<h2>Database Error</h2>\n+Something went wrong with the database.<br />\n+<span style=\"border-radius: 7px; border: 3px solid #cc0000; line-height: 35px; \n+height: 50px; background-color: #aa0000; color: #fff; padding: 5px;\">\n+<?php\n+echo $val;\n+?>\n+</span>\n\\ No newline at end of file"
        },
        {
          "filename": "inc/lib/Control/Error/unknown.control.php",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+<h2>Unknown Error Occured</h2>\n+<?php if(isset($val)) {?>\n+<div class=\"alert alert-danger\">\n+<?=$val;?>\n+</div>\n+\n+<?php\n+    }\n+    Site::footer();\n+?>\n\\ No newline at end of file"
        },
        {
          "filename": "inc/lib/Control/Frontend/cat.control.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -26,18 +26,21 @@\n                         sprintf(\"SELECT * FROM `posts` \n                             WHERE `type` = 'post' \n                             AND `cat` = '%d'\n+                            AND `status` = '1'\n                             ORDER BY `date` \n                             DESC LIMIT %d, %d\",\n                             $_GET['cat'], $offset, $data['max']\n                             )\n                         );\n $data['num'] = Db::$num_rows;\n if($data['num'] > 0) {\n-    Theme::theme('header');\n+    Theme::theme('header',$data);\n     Theme::theme('cat', $data);\n     Theme::footer();\n+    exit;\n }else{\n     Control::error('404');\n+    exit;\n }\n \n /* End of file cat.control.php */"
        },
        {
          "filename": "inc/lib/Control/Frontend/default.control.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -24,13 +24,14 @@\n $data['posts'] = Db::result(\n                         sprintf(\"SELECT * FROM `posts` \n                             WHERE `type` = 'post' \n+                            AND `status` = '1'\n                             ORDER BY `date` \n                             DESC LIMIT %d, %d\",\n                             $offset, $data['max']\n                             )\n                         );\n $data['num'] = Db::$num_rows;\n-Theme::theme('header');\n+Theme::theme('header',$data);\n Theme::theme('index', $data);\n Theme::footer();\n "
        },
        {
          "filename": "inc/lib/Control/Frontend/page.control.php",
          "status": "modified",
          "additions": 7,
          "deletions": 4,
          "patch": "@@ -18,27 +18,30 @@\n     case 'sitemap':\n         # code...\n         Sitemap::create();\n+        exit;\n         break;\n     \n     default:\n         # code...\n         $page = $_GET['page'];\n         $data['posts'] = Db::result(\n                             sprintf(\"SELECT * FROM `posts` \n-                                    WHERE `id` = '%d' \n+                                    WHERE (`id` = '%d' OR `slug` = '%s')\n                                     AND `type` = 'page'\n-                                    OR `slug` = '%s' \n+                                    AND `status` = '1'\n                                     LIMIT 1\", \n                                     $page, \n-                                    $page\n+                                    Typo::cleanX($page)\n                                     )\n                             );\n         if(Db::$num_rows > 0) {\n-            Theme::theme('header');\n+            Theme::theme('header',$data);\n             Theme::theme('page', $data);\n             Theme::footer();\n+            exit;\n         }else{\n             Control::error('404');\n+            exit;\n         }\n         break;\n }"
        },
        {
          "filename": "inc/lib/Control/Frontend/post.control.php",
          "status": "modified",
          "additions": 7,
          "deletions": 2,
          "patch": "@@ -17,17 +17,22 @@\n $post = $_GET[$vars];\n $data['posts'] = Db::result(\n                     sprintf(\"SELECT * FROM `posts` \n-                            WHERE `id` = '%d' AND `type` = 'post' LIMIT 1\",\n+                            WHERE `id` = '%d' \n+                            AND `type` = 'post'\n+                            AND `status` = '1' \n+                            LIMIT 1\",\n                             $post\n                             )\n                 );\n \n if(Db::$num_rows > 0) {\n-    Theme::theme('header');\n+    Theme::theme('header',$data);\n     Theme::theme('single', $data);\n     Theme::footer();\n+    exit;\n }else{\n     Control::error('404');\n+    exit;\n }\n \n "
        },
        {
          "filename": "inc/lib/Control/Install/default.control.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -95,6 +95,7 @@ class=\\\"btn btn-danger\\\">Back Button</a>.\";\n                 <br>\n                 After You had set the permission, please refresh this page. \n                 <br>\n+                <br>\n                 or <a href=\\\"?step=4\\\" class=\\\"btn btn-primary\\\">Click Here</a>\";\n             }\n         }catch (exception $e) {"
        },
        {
          "filename": "inc/lib/Db.class.php",
          "status": "modified",
          "additions": 16,
          "deletions": 5,
          "patch": "@@ -48,8 +48,19 @@ public function __construct () {\n             mysql_connect(DB_HOST, DB_USER, DB_PASS);\n             mysql_select_db(DB_NAME);\n         }elseif(DB_DRIVER == 'mysqli') {\n-            self::$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME);\n-            return self::$mysqli;\n+            try {\n+                self::$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME);\n+                if (self::$mysqli->connect_error) {\n+                    Control::error('db', self::$mysqli->connect_error);\n+                    exit;\n+                }else{\n+                    return true;\n+                }\n+            } catch (exception $e) {\n+                Control::error('db', $e->getMessage() );\n+            }\n+            \n+            //return self::$mysqli;\n         }\n     }\n \n@@ -93,8 +104,7 @@ public static function query ($vars) {\n         elseif(DB_DRIVER == 'mysqli') {\n             $q = self::$mysqli->query($vars) ;\n             if($q === false) {\n-                user_error(\"Query failed: \".self::$mysqli->error.\"<br />\\n$vars\"); \n-                return false; \n+                Control::error('db',\"Query failed: \".self::$mysqli->error.\"<br />\\n\"); \n             }\n         }\n         \n@@ -265,7 +275,8 @@ public static function insert ($vars) {\n         }elseif(DB_DRIVER == 'mysqli'){\n             try {\n                 if(!self::query($sql)){\n-                    printf(\"<div class=\\\"alert alert-danger\\\">Errormessage: %s</div>\\n\", self::$mysqli->error);\n+                    // printf(\"<div class=\\\"alert alert-danger\\\">Errormessage: %s</div>\\n\", self::$mysqli->error);\n+                    //Control::error('db',self::$mysqli->error);\n                 }else{\n                     self::$last_id = self::$mysqli->insert_id;\n                 }"
        },
        {
          "filename": "inc/lib/GxMain.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -38,6 +38,8 @@ public function __construct() {\n         if (System::existConf()) {\n             new System();\n             new Db();\n+            new Site();\n+            Token::create();\n         }else{\n             $this->install();\n         }"
        },
        {
          "filename": "inc/lib/Install.class.php",
          "status": "modified",
          "additions": 13,
          "deletions": 3,
          "patch": "@@ -52,7 +52,7 @@ public static function makeConfig ($file) {\n * @copyright 2014-2015 Puguh Wijayanto\n * @license http://www.opensource.org/licenses/mit-license.php MIT\n *\n-*/\n+*/error_reporting(0);\n \n // DB CONFIG\n define('DB_HOST', '\".Session::val('dbhost').\"');\n@@ -66,6 +66,15 @@ public static function makeConfig ($file) {\n define('GX_LANG', 'english');\n define('SMART_URL', false); //set 'true' if you want use SMART URL (SEO Friendly URL)\n define('GX_URL_PREFIX', '.html');\n+\n+\n+\n+\n+\n+\n+\n+\n+// DON't REMOVE or EDIT THIS.\n define('SECURITY', '\".Typo::getToken(200).\"'); // for security purpose, will be used for creating password\n \n         \";\n@@ -191,7 +200,7 @@ public static function createTable () {\n         $user_detail = \"CREATE TABLE IF NOT EXISTS `user_detail` (\n                 `id` bigint(20) NOT NULL,\n                   `userid` varchar(32) COLLATE latin1_general_ci NOT NULL,\n-                  `fname` varchar(32) COLLATE latin1_general_ci NOT NULL,\n+                  `fname` varchar(32) COLLATE latin1_general_ci NULL,\n                   `lname` varchar(255) COLLATE latin1_general_ci DEFAULT NULL,\n                   `sex` varchar(2) COLLATE latin1_general_ci DEFAULT NULL,\n                   `birthplace` varchar(32) COLLATE latin1_general_ci DEFAULT NULL,\n@@ -272,7 +281,8 @@ public static function insertData () {\n             (null, 'ppsandbox', 'off'),\n             (null, 'ppuser', ''),\n             (null, 'pppass', ''),\n-            (null, 'ppsign', '')\";\n+            (null, 'ppsign', ''),\n+            (null, 'tokens', '')\";\n         $db->query($options);\n     }\n }\n\\ No newline at end of file"
        },
        {
          "filename": "inc/lib/Mail.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -27,7 +27,7 @@ class Mail\n     static $siteemail   = \"\";\n     static $sitename    = \"\";\n     \n-    function __construct()\n+    public function __construct()\n     {\n         # code...\n         self::$smtphost    = Options::get('smtphost');"
        },
        {
          "filename": "inc/lib/Menus.class.php",
          "status": "modified",
          "additions": 65,
          "deletions": 33,
          "patch": "@@ -1,36 +1,68 @@\n <?php if(!defined('GX_LIB')) die(\"Direct Access Not Allowed!\");\n-/*\n-*    GeniXCMS - Content Management System\n-*    ============================================================\n-*    Build          : 20140925\n-*    Version        : 0.0.1 pre\n-*    Developed By   : Puguh Wijayanto (www.metalgenix.com)\n-*    License        : MIT License\n-*    ------------------------------------------------------------\n-* filename : Menus.class.php\n-* version : 0.0.1 pre\n-* build : 20141007\n+/**\n+* GeniXCMS - Content Management System\n+* \n+* PHP Based Content Management System and Framework\n+*\n+* @package GeniXCMS\n+* @since 0.0.1 build date 20141007\n+* @version 0.0.1\n+* @link https://github.com/semplon/GeniXCMS\n+* @author Puguh Wijayanto (www.metalgenix.com)\n+* @copyright 2014-2015 Puguh Wijayanto\n+* @license http://www.opensource.org/licenses/mit-license.php MIT\n+*\n+*/\n+\n+/**\n+* Menus Class.\n+* This class is for managing the menu at the dasboard. \n+*\n+* @author Puguh Wijayanto (www.metalgenix.com)\n+* @since 0.0.1\n */\n class Menus\n {\n-\n+    /**\n+    * Menus Constructor.\n+    * Nothing to construct\n+    * @since 0.0.1\n+    *\n+    */\n     public function __construct(){\n-\n     }\n \n-    public static function getParent($parent='', $menuid = ''){\n+\n+    /**\n+    * isHadParent Function\n+    * \n+    * This function is to get the list of parent in certain conditions. There are \n+    * two paramaters to be inserted. \n+    * @param int $parent\n+    * @param string $menuid\n+    * \n+    * @author Puguh Wijayanto (www.metalgenix.com)\n+    * @since 0.0.1\n+    */\n+    public static function isHadParent($parent='', $menuid = ''){\n         if(isset($menuid)){\n             $where = \" AND `menuid` = '{$menuid}'\";\n         }else{\n             $where = '';\n         }\n-        $sql = sprintf(\"SELECT * FROM `menus` WHERE `parent` = '%s' %s\", $parent, $where);\n+        if(isset($parent)){\n+            $parent = \" `parent` = '{$parent}'\";\n+        }else{\n+            $parent = '1';\n+        }\n+        $sql = sprintf(\"SELECT * FROM `menus` WHERE %s %s\", $parent, $where);\n         $menu = Db::result($sql);\n         return $menu;\n     }\n \n-    public static function isHadSub($parent, $menuid =''){\n-        $sql = sprintf(\"SELECT * FROM `menus` WHERE `parent` = '%s' %s\", $parent, $where);\n+    public static function getParent($id){\n+        $q = self::getId($id);\n+        return $q[0]->parent;\n     }\n \n \n@@ -50,7 +82,7 @@ public static function getMenu($menuid, $class='', $bsnav=false){\n             foreach ($menus as $m) {\n                 # code...\n                 if($m->parent == ''){\n-                    $parent = self::getParent($m->id, $menuid);\n+                    $parent = self::isHadParent($m->id, $menuid);\n                     $n = Db::$num_rows;\n                     if($n > 0 && $bsnav) { \n                         $class = \"class=\\\"dropdown\\\"\";\n@@ -70,7 +102,7 @@ public static function getMenu($menuid, $class='', $bsnav=false){\n                         $menu .= \"<ul class=\\\"submenu {$class}\\\" role=\\\"dropdown\\\">\";\n                             foreach ($menus as $m2) {\n                                 if($m2->parent == $m->id){\n-                                    $parent = self::getParent($m2->id, $menuid);\n+                                    $parent = self::isHadParent($m2->id, $menuid);\n                                     $n = Db::$num_rows;\n                                     if($n > 0 && $bsnav) { \n                                         $class = \"class=\\\"dropdown\\\"\";\n@@ -88,7 +120,7 @@ public static function getMenu($menuid, $class='', $bsnav=false){\n                                             $menu .= \"<ul class=\\\"submenu {$class}\\\">\";\n                                             foreach ($menus as $m3) {\n                                                 if($m3->parent == $m2->id){\n-                                                    $parent = self::getParent($m3->id, $menuid);\n+                                                    $parent = self::isHadParent($m3->id, $menuid);\n                                                     $n = Db::$num_rows;\n                                                     if($n > 0 && $bsnav) { \n                                                         $class = \"class=\\\"dropdown\\\"\";\n@@ -107,7 +139,7 @@ public static function getMenu($menuid, $class='', $bsnav=false){\n                                                             $menu .= \"<ul class=\\\"submenu {$class}\\\">\";\n                                                             foreach ($menus as $m4) {\n                                                                 if($m4->parent == $m3->id){\n-                                                                    $parent = self::getParent($m4->id, $menuid);\n+                                                                    $parent = self::isHadParent($m4->id, $menuid);\n                                                                     $n = Db::$num_rows;\n                                                                     if($n > 0 && $bsnav) { \n                                                                         $class = \"class=\\\"dropdown\\\"\";\n@@ -167,10 +199,10 @@ public static function getMenuAdmin($menuid, $class=''){\n                     $menu .= \"<li clas=\\\"form-inline\\\"><div class=\\\"row\\\">\";\n                     $menu .= \"\n                             <h4 class=\\\"col-md-10\\\">\".$m->name.\" \n-                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m->id}\\\" class=\\\"label label-primary pull-right\\\" >\n+                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m->id}&token=\".TOKEN.\"\\\" class=\\\"label label-primary pull-right\\\" >\n                                     <span class=\\\"glyphicon glyphicon-edit\\\"></span>\n                                 </a>\n-                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m->id}\\\" class=\\\"label label-danger pull-right\\\" >\n+                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m->id}&token=\".TOKEN.\"\\\" class=\\\"label label-danger pull-right\\\" >\n                                     <span class=\\\"glyphicon glyphicon-remove\\\"></span>\n                                 </a>\n                             </h4>\n@@ -183,18 +215,18 @@ public static function getMenuAdmin($menuid, $class=''){\n                     \n                     $parent = $m->id;\n                     //echo $parent;\n-                    $parent = self::getParent($m->id, $menuid);\n+                    $parent = self::isHadParent($m->id, $menuid);\n                     $n = Db::$num_rows;\n                     if($n > 0){\n                         $menu .= \"<ul class=\\\"submenu {$class}\\\">\";\n                             foreach ($menus as $m2) {\n                                 if($m2->parent == $m->id){\n                                     $menu .= \"<li><div class=\\\"row\\\">\";\n                                     $menu .= \"<h5 class=\\\"col-md-10\\\">\".$m2->name.\"\n-                                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m2->id}\\\" class=\\\"label label-primary pull-right\\\" >\n+                                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m2->id}&token=\".TOKEN.\"\\\" class=\\\"label label-primary pull-right\\\" >\n                                                     <span class=\\\"glyphicon glyphicon-edit\\\"></span>\n                                                 </a>\n-                                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m2->id}\\\" class=\\\"label label-danger pull-right\\\" >\n+                                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m2->id}&token=\".TOKEN.\"\\\" class=\\\"label label-danger pull-right\\\" >\n                                                     <span class=\\\"glyphicon glyphicon-remove\\\"></span>\n                                                 </a>\n \n@@ -207,18 +239,18 @@ public static function getMenuAdmin($menuid, $class=''){\n                                         </div>\n                                         \n                                                 \";\n-                                        $parent = self::getParent($m2->id, $menuid);\n+                                        $parent = self::isHadParent($m2->id, $menuid);\n                                         $n = Db::$num_rows;\n                                         if($n > 0){\n                                             $menu .= \"<ul class=\\\"submenu {$class}\\\">\";\n                                             foreach ($menus as $m3) {\n                                                 if($m3->parent == $m2->id){\n                                                     $menu .= \"<li><div class=\\\"row\\\">\";\n                                                     $menu .= \"<h6 class=\\\"col-md-10\\\">\".$m3->name.\"\n-                                                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m3->id}\\\" class=\\\"label label-primary pull-right\\\" >\n+                                                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m3->id}&token=\".TOKEN.\"\\\" class=\\\"label label-primary pull-right\\\" >\n                                                                     <span class=\\\"glyphicon glyphicon-edit\\\"></span>\n                                                                 </a>\n-                                                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m3->id}\\\" class=\\\"label label-danger pull-right\\\" >\n+                                                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m3->id}&token=\".TOKEN.\"\\\" class=\\\"label label-danger pull-right\\\" >\n                                                                     <span class=\\\"glyphicon glyphicon-remove\\\"></span>\n                                                                 </a>\n                                                             </h6>\";\n@@ -228,18 +260,18 @@ public static function getMenuAdmin($menuid, $class=''){\n                                                             </div>\n                                                         </div>\n                                                                 \";\n-                                                        $parent = self::getParent($m3->id, $menuid);\n+                                                        $parent = self::isHadParent($m3->id, $menuid);\n                                                         $n = Db::$num_rows;\n                                                         if($n > 0){\n                                                             $menu .= \"<ul class=\\\"submenu {$class}\\\">\";\n                                                             foreach ($menus as $m4) {\n                                                                 if($m4->parent == $m3->id){\n                                                                     $menu .= \"<li><div class=\\\"row\\\">\";\n                                                                     $menu .= \"<h6 class=\\\"col-md-10\\\">\".$m4->name.\"\n-                                                                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m4->id}\\\" class=\\\"label label-primary pull-right\\\" >\n+                                                                                <a href=\\\"index.php?page=menus&act=edit&id={$menuid}&itemid={$m4->id}&token=\".TOKEN.\"\\\" class=\\\"label label-primary pull-right\\\" >\n                                                                                     <span class=\\\"glyphicon glyphicon-edit\\\"></span>\n                                                                                 </a>\n-                                                                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m4->id}\\\" class=\\\"label label-primary pull-right\\\" >\n+                                                                                <a href=\\\"index.php?page=menus&act=del&id={$menuid}&itemid={$m4->id}&token=\".TOKEN.\"\\\" class=\\\"label label-primary pull-right\\\" >\n                                                                                     <span class=\\\"glyphicon glyphicon-remove\\\"></span>\n                                                                                 </a>\n                                                                             </h6>\";\n@@ -299,7 +331,7 @@ public static function getMenuRaw($menuid){\n \n     public static function getId($id=''){\n         if(isset($id)){\n-            $sql = sprintf(\"SELECT * FROM `menus` WHERE `id` = '%d' ORDER BY `order` ASC\", $id);\n+            $sql = sprintf(\"SELECT * FROM `menus` WHERE `id` = '%d'\", $id);\n             $menus = Db::result($sql);\n             $n = Db::$num_rows;\n         }else{"
        },
        {
          "filename": "inc/lib/Options.class.php",
          "status": "modified",
          "additions": 8,
          "deletions": 13,
          "patch": "@@ -22,26 +22,21 @@ public function __construct() {\n     }\n \n     // $vars = array(\n-    //             'title' => '',\n-    //             'cat' => '',\n-    //             'content' => '',\n-    //             'date' => '',\n-    //             'author' => '',\n-    //             'type' => '',\n-    //             'status' => ''\n+    //             'name' => '',\n+    //             'value' => ''\n     //         );\n     public static function insert($vars) {\n         if(is_array($vars)) {\n-            $slug = Typo::slugify($vars['title']);\n-            $vars = array_merge($vars, array('slug' => $slug));\n-            //print_r($vars);\n             $ins = array(\n                         'table' => 'options',\n-                        'key' => $vars\n+                        'name' => $vars['name'],\n+                        'value' => $vars['value']\n                     );\n-            $post = Db::insert($ins);\n+            $opt = Db::insert($ins);\n+        }else{\n+            Control::error('unknown','Format not Found, please in array');\n         }\n-        return $post;\n+        return $opt;\n     }\n \n     public static function update($key, $val = '') {"
        },
        {
          "filename": "inc/lib/Posts.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -121,7 +121,7 @@ public static function content($vars) {\n     }\n \n     public static function recent($vars, $type = 'post') {\n-        $sql = \"SELECT * FROM `posts` WHERE `type` = '{$type}' ORDER BY `date` DESC LIMIT {$vars}\";\n+        $sql = \"SELECT * FROM `posts` WHERE `type` = '{$type}' AND `status` = '1' ORDER BY `date` DESC LIMIT {$vars}\";\n         $posts = Db::result($sql);\n         if(isset($posts['error'])){\n             $posts['error'] = \"No Posts found.\";\n@@ -167,7 +167,7 @@ public static function dropdown($vars){\n         if(is_array($vars)){\n             //print_r($vars);\n             $name = $vars['name'];\n-            $where = \"WHERE \";\n+            $where = \"WHERE `status` = '1' AND \";\n             if(isset($vars['type'])) {\n                 $where .= \" `type` = '{$vars['type']}' AND \";\n             }else{"
        },
        {
          "filename": "inc/lib/Rss.class.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -27,9 +27,9 @@ public static function create ($url = 'post', $type='post', $count='20') {\n         $xml .= \"\n             <rss version=\\\"2.0\\\">\n                 <channel>\n-                    <title>\".Options::get('sitename').\"</title>\n-                    <link>\".Options::get('siteurl').\"</link>\n-                    <description>\".Options::get('sitedesc').\"</description>\n+                    <title>\".Site::$name.\"</title>\n+                    <link>\".Site::$url.\"</link>\n+                    <description>\".Site::$desc.\"</description>\n             \";\n         foreach ($posts as $p) {\n             # code..."
        },
        {
          "filename": "inc/lib/Site.class.php",
          "status": "modified",
          "additions": 27,
          "deletions": 17,
          "patch": "@@ -19,11 +19,21 @@ class Site\n {\n     static $editors;\n     static $data;\n+    static $url;\n+    static $domain;\n+    static $name;\n+    static $key;\n+    static $desc;\n \n     public function __construct() {\n         global $GLOBALS, $data;\n         self::$editors =& $GLOBALS;\n         self::$data =& $data;\n+        self::$url = Options::get('siteurl');\n+        self::$domain = Options::get('sitedomain');\n+        self::$name = Options::get('sitename');\n+        self::$key = Options::get('sitekeywords');\n+        self::$desc = Options::get('sitedesc');\n     }\n \n     /* Call all Website Meta at Header\n@@ -36,7 +46,7 @@ public static function meta($cont_title='', $cont_desc='', $pre =''){\n \n         if(is_array($data) && isset($data['posts'][0]->title)){\n             \n-            $sitenamelength = strlen(Options::get('sitename'));\n+            $sitenamelength = strlen(self::$name);\n             $limit = 70-$sitenamelength-6;\n             $cont_title = substr(Typo::Xclean(Typo::strip($data['posts'][0]->title)),0,$limit);\n             $titlelength = strlen($data['posts'][0]->title);\n@@ -54,8 +64,8 @@ public static function meta($cont_title='', $cont_desc='', $pre =''){\n         $meta = \"\n     <!--// Start Meta: Generated Automaticaly by GeniXCMS -->\n     <!-- SEO: Title stripped 70chars for SEO Purpose -->\n-    <title>{$cont_title}\".Options::get('sitename').\"</title>\n-    <meta name=\\\"Keyword\\\" content=\\\"\".Options::get('sitekeywords').\"\\\">\n+    <title>{$cont_title}\".self::$name.\"</title>\n+    <meta name=\\\"Keyword\\\" content=\\\"\".self::$key.\"\\\">\n     <!-- SEO: Description stripped 150chars for SEO Purpose -->\n     <meta name=\\\"Description\\\" content=\\\"\".self::desc($desc).\"\\\">\n     <meta name=\\\"Author\\\" content=\\\"Puguh Wijayanto | MetalGenix IT Solutions - www.metalgenix.com\\\">\n@@ -77,7 +87,7 @@ public static function footer(){\n         $bs = Options::get('use_bootstrap');\n         if($bs == 'on'){\n             $foot .= \"\n-    <link href=\\\"\".Options::get('siteurl').\"/assets/css/bootstrap.min.css\\\" rel=\\\"stylesheet\\\">\\n\";\n+    <link href=\\\"\".self::$url.\"/assets/css/bootstrap.min.css\\\" rel=\\\"stylesheet\\\">\\n\";\n         }\n \n         $jquery = Options::get('use_jquery');\n@@ -91,8 +101,8 @@ public static function footer(){\n         if($bs == 'on'){\n             $foot .= \"\n             <!-- These files are included by default by GeniXCMS. You can set it at the dashboard -->\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/bootstrap.min.js\\\"></script>\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/ie10-viewport-bug-workaround.js\\\"></script>\";\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/bootstrap.min.js\\\"></script>\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/ie10-viewport-bug-workaround.js\\\"></script>\";\n         }\n \n         $fa = Options::get('use_fontawesome');\n@@ -111,11 +121,11 @@ public static function footer(){\n             \\t<script src=\\\"http://cdnjs.cloudflare.com/ajax/libs/codemirror/3.20.0/mode/xml/xml.min.js\\\"></script>\n             \\t<script src=\\\"http://cdnjs.cloudflare.com/ajax/libs/codemirror/2.36.0/formatting.min.js\\\"></script>\n \n-            \\t<link href=\\\"\".Options::get('siteurl').\"/assets/css/summernote.css\\\" rel=\\\"stylesheet\\\">\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/summernote.min.js\\\"></script>\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/plugins/summernote-ext-fontstyle.js\\\"></script>\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/plugins/summernote-ext-hello.js\\\"></script>\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/plugins/summernote-ext-video.js\\\"></script>\n+            \\t<link href=\\\"\".self::$url.\"/assets/css/summernote.css\\\" rel=\\\"stylesheet\\\">\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/summernote.min.js\\\"></script>\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/plugins/summernote-ext-fontstyle.js\\\"></script>\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/plugins/summernote-ext-hello.js\\\"></script>\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/plugins/summernote-ext-video.js\\\"></script>\n             \\t<script>\n               \\t$(document).ready(function() {\n                 \\t$('.editor').summernote({\n@@ -168,8 +178,8 @@ public static function footer(){\n \n         if(isset($GLOBALS['validator']) && $GLOBALS['validator'] == true){\n             $foot .= \"\n-            \\t<link href=\\\"\".Options::get('siteurl').\"/assets/css/bootstrapValidator.min.css\\\" rel=\\\"stylesheet\\\">\n-            \\t<script src=\\\"\".Options::get('siteurl').\"/assets/js/bootstrapValidator.min.js\\\"></script>\n+            \\t<link href=\\\"\".self::$url.\"/assets/css/bootstrapValidator.min.css\\\" rel=\\\"stylesheet\\\">\n+            \\t<script src=\\\"\".self::$url.\"/assets/js/bootstrapValidator.min.js\\\"></script>\n             \";\n \n             $foot .= $GLOBALS['validator_js'];\n@@ -182,9 +192,9 @@ public static function footer(){\n \n     public static function desc($vars){\n         if(!empty($vars)){\n-            $desc = substr(strip_tags(htmlspecialchars_decode($vars).\". \".Options::get('sitedesc')),0,150);\n+            $desc = substr(strip_tags(htmlspecialchars_decode($vars).\". \".self::$desc),0,150);\n         }else{\n-            $desc = substr(Options::get('sitedesc'),0,150);\n+            $desc = substr(self::$desc,0,150);\n         }\n         \n         return $desc;\n@@ -193,10 +203,10 @@ public static function desc($vars){\n     public static function logo ($width='', $height='') {\n         // check which logo is used, logourl or uploaded files.\n         if( Options::get('is_logourl') == \"on\" && Options::get('logourl') != \"\" ) {\n-            $logo = \"<img src=\\\"\".Options::get('siteurl').Options::get('logourl').\"\\\"\n+            $logo = \"<img src=\\\"\".self::$url.Options::get('logourl').\"\\\"\n                     style=\\\"width: $width; height: $height; margin: 1px;\\\">\";\n         }elseif( Options::get('is_logourl') == \"off\" && Options::get('logo') != \"\" ){\n-            $logo = \"<img src=\\\"\".Options::get('siteurl').Options::get('logo').\"\\\"\n+            $logo = \"<img src=\\\"\".self::$url.Options::get('logo').\"\\\"\n                     style=\\\"width: $width; height: $height; margin: 1px;\\\">\";\n         }else{\n             $logo = \"<span class=\\\"mg genixcms-logo\\\"></span>\";"
        },
        {
          "filename": "inc/lib/System.class.php",
          "status": "modified",
          "additions": 24,
          "deletions": 3,
          "patch": "@@ -17,21 +17,42 @@\n \n class System\n {\n-\n+    /** \n+    * GeniXCMS Version Variable \n+    * @return double\n+    */\n     static $version          = \"0.0.1\";\n+\n+    /** \n+    * GeniXCMS Version Release \n+    * @return string\n+    */\n     static $v_release        = \"\";\n \n+    /**\n+    * System Constructor.\n+    * Initializing the system, check the config file, if exist run the config\n+    * loader. \n+    * @author Puguh Wijayanto (www.metalgenix.com)\n+    * @since 0.0.1\n+    */\n     public function __construct () {\n         if (self::existConf()) {\n             # code...\n             self::config('config');\n-            self::lang(GX_LANG);\n+            self::lang(GX_LANG);            \n         }else{\n             GxMain::install();\n         }\n         \n     }\n \n+    /**\n+    * System Library Loader.\n+    * This will include library which is called.\n+    * @author Puguh Wijayanto (www.metalgenix.com)\n+    * @since 0.0.1\n+    */\n     public static function lib($var) {\n         include(GX_LIB.$var.'.class.php');\n     }\n@@ -109,4 +130,4 @@ public static function v () {\n }\n \n /* End of file system.class.php */\n-/* Location: ./inc/lib/system.class.php */\n\\ No newline at end of file\n+/* Location: ./inc/lib/system.class.php */"
        },
        {
          "filename": "inc/lib/Token.class.php",
          "status": "added",
          "additions": 119,
          "deletions": 0,
          "patch": "@@ -0,0 +1,119 @@\n+<?php\n+/**\n+* GeniXCMS - Content Management System\n+* \n+* PHP Based Content Management System and Framework\n+*\n+* @package GeniXCMS\n+* @since 0.0.2 build date 20150309\n+* @version 0.0.2\n+* @link https://github.com/semplon/GeniXCMS\n+* @author Puguh Wijayanto (www.metalgenix.com)\n+* @copyright 2014-2015 Puguh Wijayanto\n+* @license http://www.opensource.org/licenses/mit-license.php MIT\n+*\n+*/\n+\n+\n+/**\n+* Token Class\n+*\n+* @author Puguh Wijayanto (www.metalgenix.com)\n+* @since 0.0.2\n+*/\n+class Token\n+{\n+    public function __construct () {\n+\n+    }\n+\n+    public static function create() {\n+        self::ridOld();\n+        $length = \"80\";\n+        $token = \"\";\n+        $codeAlphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n+        $codeAlphabet.= \"abcdefghijklmnopqrstuvwxyz\";\n+        $codeAlphabet.= \"0123456789\";\n+        $codeAlphabet.= SECURITY;\n+        for($i=0;$i<$length;$i++){\n+            $token .= $codeAlphabet[Typo::crypto_rand_secure(0,strlen($codeAlphabet))];\n+        }\n+        $url = $_SERVER['REQUEST_URI'];\n+        $url = htmlspecialchars($url, ENT_QUOTES, 'UTF-8');\n+        $ip = $_SERVER['REMOTE_ADDR'];\n+        $time = time();\n+        define('TOKEN', $token);\n+        define('TOKEN_URL', $url);\n+        define('TOKEN_IP', $ip);\n+        define('TOKEN_TIME', $time);\n+        $json = self::json();\n+        Options::update('tokens',$json);\n+        return $token;\n+    }\n+\n+    /**\n+    * Json Token Function\n+    *\n+    * $token = [{'time','ip','url',token'},]\n+    */\n+    public static function json() {\n+        $token = Options::get('tokens');\n+        $token = json_decode($token, true);\n+        $newtoken = array(\n+                        TOKEN => array(\n+                            'time' => TOKEN_TIME,\n+                            'ip' => TOKEN_IP,\n+                            'url' => TOKEN_URL\n+                            )\n+                    );\n+        if(is_array($token)){\n+            $newtoken = array_merge($token, $newtoken);\n+        }\n+\n+        $newtoken = json_encode($newtoken);\n+        return $newtoken;\n+    }\n+\n+    public static function isExist($token){\n+        $json = Options::get('tokens');\n+        $tokens = json_decode($json, true);\n+        if(array_key_exists($token, $tokens)){\n+            $call = true;\n+        }else{\n+            $call = false;\n+        }\n+        return $call;\n+    }\n+\n+    public static function remove($token){\n+        $json = Options::get('tokens');\n+        $tokens = json_decode($json, true);\n+        unset($tokens[$token]);\n+        $tokens = json_encode($tokens);\n+        if(Options::update('tokens',$tokens)){\n+            return true;\n+        }else{\n+            return false;\n+        }\n+    }\n+\n+    public static function ridOld() {\n+        $json = Options::get('tokens');\n+        $tokens = json_decode($json, true);\n+        $time = time();\n+        foreach ($tokens as $token => $value) {\n+            # code...\n+            //print_r($token);\n+            if ($time - $value['time'] > 600) {\n+                # code...\n+                unset($tokens[$token]);\n+            }\n+        }\n+        $tokens = json_encode($tokens);\n+        if(Options::update('tokens',$tokens)){\n+            return true;\n+        }else{\n+            return false;\n+        }\n+    }\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "inc/lib/Upload.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -69,7 +69,7 @@ public static function go($input, $path, $allowed='', $uniq=false, $size='', $wi\n                     $result['filename'] = $uniqfile.$filename;\n                     $result['path'] = $path.$uniqfile.$filename;\n                     $result['filepath'] = $filepath;\n-                    $result['fileurl'] = Options::get('siteurl').$path.$uniqfile.$filename;\n+                    $result['fileurl'] = Site::$url.$path.$uniqfile.$filename;\n \n                 }else{\n                     $result['error'] = 'Cannot upload to directory, please check "
        },
        {
          "filename": "inc/lib/Url.class.php",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -41,12 +41,12 @@ public static function post($vars) {\n         switch (SMART_URL) {\n             case true:\n                 # code...\n-                $url = Options::get('siteurl').\"/\".self::slug($vars).\"/{$vars}\";\n+                $url = Site::$url.\"/\".self::slug($vars).\"/{$vars}\";\n                 break;\n             \n             default:\n                 # code...\n-                $url = Options::get('siteurl').\"/index.php?post={$vars}\";\n+                $url = Site::$url.\"/index.php?post={$vars}\";\n                 break;\n \n         }\n@@ -66,12 +66,12 @@ public static function page($vars) {\n         switch (SMART_URL) {\n             case true:\n                 # code...\n-                $url = Options::get('siteurl').\"/\".self::slug($vars).GX_URL_PREFIX;\n+                $url = Site::$url.\"/\".self::slug($vars).GX_URL_PREFIX;\n                 break;\n             \n             default:\n                 # code...\n-                $url = Options::get('siteurl').\"/index.php?page={$vars}\";\n+                $url = Site::$url.\"/index.php?page={$vars}\";\n                 break;\n \n         }\n@@ -92,12 +92,12 @@ public static function cat($vars) {\n         switch (SMART_URL) {\n             case true:\n                 # code...\n-                $url = Options::get('siteurl').\"/\".$vars.\"/\".Typo::slugify(Categories::name($vars));\n+                $url = Site::$url.\"/\".$vars.\"/\".Typo::slugify(Categories::name($vars));\n                 break;\n             \n             default:\n                 # code...\n-                $url = Options::get('siteurl').\"/index.php?cat={$vars}\";\n+                $url = Site::$url.\"/index.php?cat={$vars}\";\n                 break;\n \n         }\n@@ -129,12 +129,12 @@ public static function sitemap() {\n         switch (SMART_URL) {\n             case true:\n                 # code...\n-                $url = Options::get('siteurl').\"/sitemap\".GX_URL_PREFIX;\n+                $url = Site::$url.\"/sitemap\".GX_URL_PREFIX;\n                 break;\n             \n             default:\n                 # code...\n-                $url = Options::get('siteurl').\"/index.php?page=sitemap\";\n+                $url = Site::$url.\"/index.php?page=sitemap\";\n                 break;\n \n         }\n@@ -154,12 +154,12 @@ public static function rss() {\n         switch (SMART_URL) {\n             case true:\n                 # code...\n-                $url = Options::get('siteurl').\"/rss\".GX_URL_PREFIX;\n+                $url = Site::$url.\"/rss\".GX_URL_PREFIX;\n                 break;\n             \n             default:\n                 # code...\n-                $url = Options::get('siteurl').\"/index.php?rss\";\n+                $url = Site::$url.\"/index.php?rss\";\n                 break;\n \n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5731757427fe2f96abba463e45d16605b02f6cb0",
            "date": "2024-12-22T08:11:29Z",
            "author_login": "semplon"
          },
          {
            "sha": "bba271d2344a99c4128855e66f5553c1972d1234",
            "date": "2024-12-12T15:22:54Z",
            "author_login": "semplon"
          },
          {
            "sha": "98135694c709b53e819b979e615d2bd8692e05ea",
            "date": "2024-11-24T01:32:29Z",
            "author_login": "semplon"
          },
          {
            "sha": "d313c0885a22e2474f318ec941b630a011069597",
            "date": "2024-11-24T01:15:26Z",
            "author_login": "semplon"
          },
          {
            "sha": "587b041c4208e791927b8be3a2f299f74176e593",
            "date": "2024-11-24T01:10:41Z",
            "author_login": "semplon"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "Cross-site request forgery (CSRF) vulnerability in MetalGenix GeniXCMS before 0.0.2 allows remote attackers to hijack the authentication of administrators for requests that add an administrator account via a request in the users page to gxadmin/index.php.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-03-23T16:59:08.540",
    "last_modified": "2024-11-21T02:27:50.380",
    "fix_date": "2015-03-10T01:54:35Z"
  },
  "references": [
    {
      "url": "http://blog.metalgenix.com/genixcms-v0-0-2-release-security-and-bug-fixes/17",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://blog.metalgenix.com/update-security-fix-and-add-newsletter-module/16",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://osvdb.org/show/osvdb/119391",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/130772/GeniXCMS-0.0.1-Cross-Site-Request-Forgery.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.exploit-db.com/exploits/36321",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/73299",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2015-5234.php",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/semplon/GeniXCMS/commit/698245488343396185b1b49e7482ee5b25541815",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/semplon/GeniXCMS/issues/7",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://blog.metalgenix.com/genixcms-v0-0-2-release-security-and-bug-fixes/17",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://blog.metalgenix.com/update-security-fix-and-add-newsletter-module/16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://osvdb.org/show/osvdb/119391",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/130772/GeniXCMS-0.0.1-Cross-Site-Request-Forgery.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.exploit-db.com/exploits/36321",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/73299",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2015-5234.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/semplon/GeniXCMS/commit/698245488343396185b1b49e7482ee5b25541815",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/semplon/GeniXCMS/issues/7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:32.428813",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "GeniXCMS",
    "owner": "semplon",
    "created_at": "2015-01-22T19:35:42Z",
    "updated_at": "2024-12-23T18:49:37Z",
    "pushed_at": "2024-12-22T10:26:02Z",
    "size": 39918,
    "stars": 40,
    "forks": 16,
    "open_issues": 12,
    "watchers": 40,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 2549180,
      "HTML": 1954605,
      "PHP": 968743,
      "CSS": 682318,
      "Less": 7906,
      "Hack": 4858,
      "SCSS": 2187
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:13:16.044099"
  }
}