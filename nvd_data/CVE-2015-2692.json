{
  "cve_id": "CVE-2015-2692",
  "github_data": {
    "repository": "kzar/watchadblock",
    "fix_commit": "5b77de6ea77e0eff2aa726d9722d64fb4964b985",
    "related_commits": [
      "5b77de6ea77e0eff2aa726d9722d64fb4964b985",
      "5b77de6ea77e0eff2aa726d9722d64fb4964b985"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5b77de6ea77e0eff2aa726d9722d64fb4964b985",
      "commit_date": "2015-03-20T20:00:12Z",
      "author": {
        "login": "kzar",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Release new version 2.21",
        "length": 642,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 132,
        "additions": 84,
        "deletions": 48
      },
      "files": [
        {
          "filename": ".git_cache_meta",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -72,3 +72,4 @@ touch -d \"2015-02-26 21:50:39.0000000000\" releases/AdBlock-v2.18.1.zip\n touch -d \"2015-03-11 19:38:35.0000000000\" releases/AdBlock-v2.19.zip\n touch -d \"2015-03-17 20:16:47.0000000000\" releases/AdBlock-v2.20.zip\n touch -d \"2015-03-17 20:33:55.0000000000\" releases/AdBlock-v2.20.1.zip\n+touch -d \"2015-03-20 19:47:57.0000000000\" releases/AdBlock-v2.21.zip"
        },
        {
          "filename": "md5sum.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -24,6 +24,7 @@\n 61273ec7509264b447108d66bc6b81de  releases/AdBlock-v2.6.29.zip\n 62cfe86c044c1bf08b0668bc60077f9a  releases/AdBlock-v2.6.27.zip\n 6ca3b084d79281085924a1d09b33b08a  releases/AdBlock-v2.14.zip\n+755502d4262c519647a7f0e590ced244  releases/AdBlock-v2.21.zip\n 76b4d5369176778c8a0a0430fa6ee77c  releases/AdBlock-v2.6.11.zip\n 81fd635b3dab023db09b6735d0c7257e  releases/AdBlock-v2.9.2.zip\n 82a19af02b1468a6b0461c5c88eec9cc  releases/AdBlock-v2.14.4.zip"
        },
        {
          "filename": "src/CHANGELOG.txt",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -2,6 +2,16 @@\n \n UNRELEASED:\n \n+2.21:\n+- Removed the Norwegian filter list since it is no longer active. (#489)\n+- For each subscribe filter list, added the last update timestamp to debug data. (#482)\n+- Added the malware notification setting to debug data. (#458)\n+- Added additional CSS to whitelist/blacklist dialogs to avoid display issues on some websites. (#460)\n+- Removed an unnecessary call to sendResponse. (#484)\n+- Added a user confirmation prompt when subscribing to a new filter lists using the ABP syntax. (#486)\n+- Fixed an issue when the request URL didn't contain a '.' (#500)\n+- Updated the Chrome web store description.(#501)\n+\n 2.20.1:\n - Updated Translations\n - In Chrome, added an uninstall URL (#493)"
        },
        {
          "filename": "src/Info.plist",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -13,9 +13,9 @@\n \t<key>CFBundleInfoDictionaryVersion</key>\n \t<string>6.0</string>\n \t<key>CFBundleShortVersionString</key>\n-\t<string>2.20.1</string>\n+\t<string>2.21</string>\n \t<key>CFBundleVersion</key>\n-\t<string>102.20.1</string>\n+\t<string>102.21</string>\n \t<key>Chrome</key>\n \t<dict>\n \t\t<key>Global Page</key>"
        },
        {
          "filename": "src/_locales/en/messages.json",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"description2\":{\n-    \"message\":\"The most popular Chrome extension in the world, a customizable ad blocker that blocks ALL ads for free by default.\",\n+    \"message\":\"AdBlock. The #1 ad blocker with over 200 million downloads. Blocks YouTube, Facebook and ALL ads by default (unlike Adblock Plus).\",\n     \"description\":\"Extension description in manifest. Should not exceed 132 characters.\"\n   },\n   \"adblock_click_for_details\":{\n@@ -191,6 +191,16 @@\n     \"message\":\"This AdBlock feature does not work on this site because it uses out of date technology. You can blacklist or whitelist resources manually in the 'Customize' tab of the options page.\",\n     \"description\":\"Message (alert) shown when the user tries to use a blacklist\\/whitelist wizard on an old website\"\n   },\n+  \"subscribeconfirm\":{\n+    \"message\":\"Are you sure that you want to subscribe to the $title$ filter list?\",\n+    \"description\":\"Prompt question before subscribing to the filter list\",\n+    \"placeholders\":{\n+      \"title\":{\n+        \"content\":\"$1\",\n+        \"example\":\"Prebake\"\n+      }\n+    }\n+  },\n   \"subscribingtitle\":{\n     \"message\":\"Subscribing to filter list...\",\n     \"description\":\"abp: link subscriber title\""
        },
        {
          "filename": "src/adblock_start_common.js",
          "status": "modified",
          "additions": 9,
          "deletions": 4,
          "patch": "@@ -1,3 +1,6 @@\n+//cache a reference to window.confirm\n+//so that web sites can not clobber the default implementation\n+var abConfirm = window.confirm;\n // Return the ElementType element type of the given element.\n function typeForElement(el) {\n   // TODO: handle background images that aren't just the BODY.\n@@ -142,16 +145,18 @@ function handleABPLinkClicks() {\n       var reqLoc = queryparts.requiresLocation;\n       var reqList = (reqLoc ? \"url:\" + reqLoc : undefined);\n       var title = queryparts.title;\n-      BGcall(\"subscribe\", {id: \"url:\" + loc, requires: reqList, title: title});\n-      // Open subscribe popup\n-      if (SAFARI) {\n+      if (abConfirm(translate(\"subscribeconfirm\", (title || loc)))) {\n+        BGcall(\"subscribe\", {id: \"url:\" + loc, requires: reqList, title: title});\n+        // Open subscribe popup\n+        if (SAFARI) {\n           // In Safari, window.open() cannot be used\n           // to open a new window from our global HTML file\n           window.open(chrome.extension.getURL('pages/subscribe.html?' + loc),\n                       \"_blank\",\n                       'scrollbars=0,location=0,resizable=0,width=450,height=150');\n-      } else {\n+        } else {\n           BGcall(\"launch_subscribe_popup\", loc);\n+        }\n       }\n     }\n   };"
        },
        {
          "filename": "src/background.js",
          "status": "modified",
          "additions": 19,
          "deletions": 17,
          "patch": "@@ -304,24 +304,21 @@\n         }\n         var url = parseUri(details.url);\n         if (url && url.pathname) {\n-            var pos = url.pathname.lastIndexOf('.');\n-            if (pos === -1) {\n-                return type;\n+          var pos = url.pathname.lastIndexOf('.');\n+          if (pos > -1) {\n+            var ext = url.pathname.slice(pos) + '.';\n+            if ('.eot.ttf.otf.svg.woff.woff2.'.indexOf(ext) !== -1) {\n+              return 'font';\n             }\n+            // Still need this because often behind-the-scene requests are wrongly\n+            // categorized as 'other'\n+            if ('.ico.png.gif.jpg.jpeg.webp.'.indexOf(ext) !== -1) {\n+              return 'image';\n+            }\n+          }\n         }\n-        var ext = url.pathname.slice(pos) + '.';\n-        if ('.eot.ttf.otf.svg.woff.woff2.'.indexOf(ext) !== -1) {\n-            return 'font';\n-        }\n-        // Still need this because often behind-the-scene requests are wrongly\n-        // categorized as 'other'\n-        if ('.ico.png.gif.jpg.jpeg.webp.'.indexOf(ext) !== -1) {\n-            return 'image';\n-        }\n-        // https://code.google.com/p/chromium/issues/detail?id=410382\n-        if (type === 'other') {\n-            return 'object';\n-        }\n+        // see crbug.com/410382\n+        return 'object';\n     };\n \n     // When a request starts, perhaps block it.\n@@ -1336,8 +1333,10 @@\n       var subscribed_filter_names = [];\n       var get_subscriptions = get_subscriptions_minus_text();\n       for (var id in get_subscriptions) {\n-          if (get_subscriptions[id].subscribed)\n+          if (get_subscriptions[id].subscribed) {\n               subscribed_filter_names.push(id);\n+              subscribed_filter_names.push(\"  last updated: \" + new Date(get_subscriptions[id].last_update).toUTCString());\n+          }\n       }\n \n       // Get last known error\n@@ -1354,6 +1353,9 @@\n       var settings = get_settings();\n       for (setting in settings)\n           adblock_settings.push(setting + \": \"+ get_settings()[setting] + \"\\n\");\n+      // We need to hardcode malware-notification setting,\n+      // because it isn't included in _settings object, but just in localStorage\n+      adblock_settings.push(\"malware-notification: \" + storage_get('malware-notification') + \"\\n\");\n       adblock_settings = adblock_settings.join('');\n \n       // Create debug info for a bug report or an ad report"
        },
        {
          "filename": "src/filtering/myfilters.js",
          "status": "modified",
          "additions": 1,
          "deletions": 6,
          "patch": "@@ -94,7 +94,7 @@ MyFilters.prototype._updateDefaultSubscriptions = function() {\n     // Convert subscribed ex-user-submitted lists into official lists.\n     else {\n       // TODO: Remove this logic after a few releases\n-      if (id === \"easylist_plus_spanish\") {\n+      if (id === \"easylist_plus_spanish\" || id === \"norwegian\") {\n           delete this._subscriptions[id];\n           continue;\n       }\n@@ -592,7 +592,6 @@ MyFilters.prototype._load_default_subscriptions = function() {\n       case 'ko': return 'easylist_plun_korean';\n       case 'lv': return 'latvian';\n       case 'nl': return 'dutch';\n-      case 'no': return 'norwegian';\n       case 'pl': return 'easylist_plus_polish';\n       case 'ro': return 'easylist_plus_romanian';\n       case 'ru': return 'russian';\n@@ -694,10 +693,6 @@ MyFilters.prototype._make_subscription_options = function() {\n     \"latvian\": {  // Latvian filters\n       url: \"https://gitorious.org/adblock-latvian/adblock-latvian/blobs/raw/master/lists/latvian-list.txt\",\n     },\n-    \"norwegian\": {  // Additional Norwegian filters\n-      url: \"http://home.fredfiber.no/langsholt/adblock.txt\",\n-      requiresList: \"easylist\",\n-    },\n     \"swedish\": {  // Swedish filters\n       url: \"http://fanboy.co.nz/fanboy-swedish.txt\",\n     },"
        },
        {
          "filename": "src/jquery/css/jquery-ui.custom.css",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -283,16 +283,16 @@\n  *\n  * http://docs.jquery.com/UI/Dialog#theming\n  */\n-.ui-dialog { position: absolute; width: 300px; overflow: hidden; background-color: #F1F1F1; box-shadow: 3px 1px 9px 1px rgba(0, 0, 0, 0.25);}\n+.ui-dialog { position: absolute; width: 300px; overflow: hidden; background-color: #F1F1F1; box-shadow: 3px 1px 9px 1px rgba(0, 0, 0, 0.25); padding: 1px;}\n .ui-dialog .ui-dialog-titlebar { padding: .4em 1em; position: relative; background: #F1F1F1; border: none;}\n .ui-dialog .ui-dialog-title { float: left; margin: .1em 16px .1em 0; }\n .ui-dialog .ui-dialog-titlebar-close { position: absolute; right: .3em; top: 50%; width: 19px; margin: -10px 0 0 0; height: 18px; }\n-.ui-dialog .ui-dialog-titlebar-close span { display: none; }\n+.ui-dialog .ui-dialog-titlebar-close span { display: none !important; }\n .ui-dialog .ui-dialog-titlebar-close:hover, .ui-dialog .ui-dialog-titlebar-close:focus { padding: 0; background-image: url(images/ui-icons_056b93_256x240.png);  background-position: 160px -128px; }\n .ui-dialog .ui-dialog-content { position: relative; border: 0; padding: .5em 1em; background: none; overflow: auto; zoom: 1; }\n .ui-dialog .ui-dialog-buttonpane { text-align: left; border-width: 1px 0 0 0; background-image: none;  padding: .3em 1em .5em .4em;}\n .ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset { float: right; }\n-.ui-dialog .ui-dialog-buttonpane button { margin: .5em .4em; cursor: pointer; padding: 1px 4px; background: -webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ededed), color-stop(1, #dfdfdf) ) !important;}\n+.ui-dialog .ui-dialog-buttonpane button { margin: .5em .4em; cursor: pointer; padding: 1px 4px !important; background: -webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ededed), color-stop(1, #dfdfdf) ) !important; float: none; line-height: inherit;}\n .ui-dialog .ui-resizable-se { width: 14px; height: 0px; right: 3px; bottom: 3px; }\n .ui-draggable .ui-dialog-titlebar { cursor: move; }\n /*!"
        },
        {
          "filename": "src/jquery/css/override-page.css",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -5,6 +5,9 @@\n   z-index: 10000;\n   padding: 0px;\n }\n+.ui-button-text {\n+  display: block !important;\n+}\n .ui-dialog a[href] {\n   text-decoration: underline !important;\n }\n@@ -59,7 +62,10 @@\n   outline: none;\n   box-shadow: none;\n }\n-.ui-dialog.ui-state-hover button {\n+.ui-dialog .ui-corner-all {\n+  border-radius: 5px;\n+}\n+.ui-dialog .ui-state-hover button {\n   background: #79C9EC !important;\n }\n .ui-dialog .ui-dialog-titlebar-close {\n@@ -83,7 +89,7 @@\n .ui-dialog label {\n   cursor: pointer;\n }\n-.ui-dialog .ui-dialog-buttonpane { \n+.ui-dialog .ui-dialog-buttonpane {\n   display: block !important;\n   background-color: white;\n   margin: 0px;\n@@ -195,4 +201,4 @@ input[type=\"checkbox\"]:checked:before {\n   color: rgba(0, 0, 0, 0.7);\n   content: '\\2713';\n   margin-left: 20%;\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "src/manifest.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"AdBlock\",\n-  \"version\": \"2.20.1\",\n+  \"version\": \"2.21\",\n   \"background\": {\n     \"scripts\": [\n       \"jquery/jquery.min.js\","
        },
        {
          "filename": "src/options/customize.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@ chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {\n   BGcall(\"get_exclude_filters_text\", function(text) {\n     $(\"#txtExcludeFiltersAdvanced\").val(text);\n   });\n-  sendResponse({});\n+  // a call to sendResponse is not needed because of the call in filters.js\n });\n \n $(function() {"
        },
        {
          "filename": "src/pages/adreport.html",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -219,7 +219,6 @@ <h2 i18n=\"correctfilters\" style=\"margin-bottom: 15px;\"></h2>\n           <option value=\"easylist;easylist_plus_polish;mailto:adblockpolska at gmail.com\" i18n=\"filtereasylist_plus_polish\"></option>\r\n           <option value=\"easylist;easylist_plus_romanian;mailto:mail at zoso.ro\" i18n=\"filtereasylist_plus_romanian\"></option>\r\n           <option value=\"latvian;http://forums.lanik.us/viewforum.php?f=99\" i18n=\"filterlatvian\"></option>\r\n-          <option value=\"norwegian;mailto:mlan76 at gmail.com\" i18n=\"filternorwegian\"></option>\r\n           <option value=\"easylist;russian;http://forum.mozilla-russia.org/viewtopic.php?id=3679\" i18n=\"lang_russian\"></option>\r\n           <option value=\"czech;http://adblock.sk/forum\" i18n=\"lang_slovak\"></option>\r\n           <option value=\"swedish;http://forums.fanboy.co.nz/forums/viewforum.php?f=7\" i18n=\"filterswedish\"></option>\r"
        },
        {
          "filename": "src/tools/update_l10n.pl",
          "status": "modified",
          "additions": 16,
          "deletions": 9,
          "patch": "@@ -217,16 +217,19 @@ sub strings_in_use {\n }\n \n sub html_js_files {\n-    # take path to a folder to search as input\n-    my $folder = shift(@_);\n+    # take paths to folders to search as input\n+    my @folders = @_;\n     \n-    # search for html and js files and store list\n     my @files;\n-    find(sub{\n-        return unless -f;\n-        return unless (/\\.html$/ || /\\.js$/);\n-        push(@files,$File::Find::name);\n-    },$folder);\n+    \n+    foreach my $folder (@folders){\n+        # search for html and js files and store list\n+        find(sub{\n+            return unless -f;\n+            return unless (/\\.html$/ || /\\.js$/);\n+            push(@files,$File::Find::name);\n+        },$folder);\n+    }\n     \n     # return list of files found\n     return @files;\n@@ -241,9 +244,13 @@ sub missing_unused {\n     my @files, my @strings;\n     \n     # get a list of used strings in the correct project\n-    if ($project eq \"contributors\" || $project eq \"installed\"){\n+    if ($project eq \"contributors\"){\n         @files = html_js_files(\"$locale_dirs{$project}/../../\");\n         @strings = strings_in_use(@files);\n+    } elsif ($project eq \"installed\"){\n+        # l10n for /installed also contains l10n for /pay\n+        @files = html_js_files(\"$locale_dirs{$project}/../../\", \"$locale_dirs{$project}/../../../pay/\");\n+        @strings = strings_in_use(@files);\n     } elsif ($project eq \"getadblock_com\"){\n         find(sub{\n             # don't look in directories that are separate projects"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 8,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "90d39f205e2e105497bd57d378c5092e8c8dcfe0",
            "date": "2020-05-18T13:46:00Z",
            "author_login": "kzar"
          },
          {
            "sha": "96f663fa031670028aff36ff2ca173411c555fdd",
            "date": "2020-04-15T20:31:00Z",
            "author_login": "kzar"
          },
          {
            "sha": "9fdd410cff1380fd7839fdf2222d2355801dbf2e",
            "date": "2020-04-06T20:08:00Z",
            "author_login": "kzar"
          },
          {
            "sha": "526c6f0707831da08be8e4011ec479f1dab4f7dd",
            "date": "2020-03-31T17:02:00Z",
            "author_login": "kzar"
          },
          {
            "sha": "22b49784979cc1a8fdfffc69ed741fd1644dc3c9",
            "date": "2020-03-16T15:20:00Z",
            "author_login": "kzar"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-284",
    "description": "AdBlock before 2.21 allows remote attackers to block arbitrary resources on arbitrary websites and to disable arbitrary blocking filters.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-06-08T21:29:00.313",
    "last_modified": "2024-11-21T02:27:51.730",
    "fix_date": "2015-03-20T20:00:12Z"
  },
  "references": [
    {
      "url": "https://github.com/kzar/watchadblock/commit/5b77de6ea77e0eff2aa726d9722d64fb4964b985",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.greinr.com/blog/2015/cve-2015-2692-adblock-filter-injection/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kzar/watchadblock/commit/5b77de6ea77e0eff2aa726d9722d64fb4964b985",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.greinr.com/blog/2015/cve-2015-2692-adblock-filter-injection/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:01.654383",
    "processing_status": "enhanced"
  }
}