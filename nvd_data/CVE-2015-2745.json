{
  "cve_id": "CVE-2015-2745",
  "github_data": {
    "repository": "mozilla-b2g/gaia",
    "fix_commit": "0f72a8c31df9f3d8f609a7c58ca91139051d44eb",
    "related_commits": [
      "0f72a8c31df9f3d8f609a7c58ca91139051d44eb",
      "0f72a8c31df9f3d8f609a7c58ca91139051d44eb"
    ],
    "patch_url": "https://github.com/mozilla-b2g/gaia/commit/0f72a8c31df9f3d8f609a7c58ca91139051d44eb.patch",
    "fix_commit_details": {
      "sha": "0f72a8c31df9f3d8f609a7c58ca91139051d44eb",
      "commit_date": "2014-11-26T18:27:46Z",
      "author": {
        "login": "KevinGrandon",
        "type": "User",
        "stats": {
          "total_commits": 5408,
          "average_weekly_commits": 7.75896700143472,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 165
        }
      },
      "commit_message": {
        "title": "Merge pull request #26459 from KevinGrandon/bug_1101158_use_tagged_template",
        "length": 151,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 115,
        "additions": 88,
        "deletions": 27
      },
      "files": [
        {
          "filename": "apps/sharedtest/test/unit/tagged_test.js",
          "status": "added",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -0,0 +1,18 @@\n+/* global Tagged */\n+\n+'use strict';\n+\n+require('/shared/js/tagged.js');\n+\n+suite('tagged template helper', function() {\n+\n+  test('#escapeHTML', function() {\n+    var myVal = '<b>hello</b>';\n+    // fix a jshint issue with tagged template strings\n+    // https://github.com/jshint/jshint/issues/2000\n+    /* jshint -W033 */\n+    var generated = Tagged.escapeHTML `${myVal} world`;\n+    /* jshint +W033 */\n+    assert.equal(generated, '&lt;b&gt;hello&lt;&#x2F;b&gt; world');\n+  });\n+});"
        },
        {
          "filename": "apps/system/index.html",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -33,6 +33,7 @@\n     <script defer src=\"shared/js/screen_layout.js\"></script>\n     <script defer src=\"shared/js/iac_handler.js\"></script>\n     <script defer src=\"shared/js/apn_helper.js\"></script>\n+    <script defer src=\"shared/js/tagged.js\"></script>\n     <script defer src=\"shared/js/utilities.js\"></script>\n     <script defer src=\"js/touch_forwarder.js\"></script>\n     <script defer src=\"shared/js/version_helper.js\"></script>"
        },
        {
          "filename": "apps/system/js/card.js",
          "status": "modified",
          "additions": 29,
          "deletions": 27,
          "patch": "@@ -1,4 +1,4 @@\n-/* globals BaseUI, CardsHelper, TrustedUIManager */\n+/* globals BaseUI, CardsHelper, Tagged, TrustedUIManager */\n \n /* exported Card */\n \n@@ -69,38 +69,40 @@\n    * Template string representing the innerHTML of the instance's element\n    * @memberOf Card.prototype\n    */\n-  Card.prototype._template =\n-    '<div class=\"titles\">' +\n-    ' <h1 id=\"{titleId}\" class=\"title\">{title}</h1>' +\n-    ' <p class=\"subtitle\">{subTitle}</p>' +\n-    '</div>' +\n-    '' +\n-    '<div class=\"screenshotView bb-button\" data-l10n-id=\"openCard\" ' +\n-    '  role=\"link\"></div>' +\n-    '<div class=\"appIconView\" style=\"background-image:{iconValue}\"></div>' +\n-    '' +\n-    '<footer class=\"card-tray\">'+\n-    ' <button class=\"appIcon\" data-l10n-id=\"openCard\" ' +\n-    '   data-button-action=\"select\" aria-hidden=\"true\"></button>' +\n-    ' <menu class=\"buttonbar\">' +\n-    '   <button class=\"close-button bb-button\" data-l10n-id=\"closeCard\" ' +\n-    '     data-button-action=\"close\" role=\"button\" ' +\n-    '     style=\"visibility: {closeButtonVisibility}\"></button>' +\n-    '  <button class=\"favorite-button bb-button\" ' +\n-    '    data-button-action=\"favorite\" role=\"button\" ' +\n-    '    style=\"visibility: {favoriteButtonVisibility}\"></button>' +\n-    ' </menu>' +\n-    '</footer>';\n+  Card.prototype.template = function() {\n+    // fix a jshint issue with tagged template strings\n+    // https://github.com/jshint/jshint/issues/2000\n+    /* jshint -W033 */\n+    return Tagged.escapeHTML `<div class=\"titles\">\n+     <h1 id=\"${this.titleId}\" class=\"title\">${this.title}</h1>\n+     <p class=\"subtitle\">${this.subTitle}</p>\n+    </div>\n+\n+    <div class=\"screenshotView bb-button\" data-l10n-id=\"openCard\"\n+      role=\"link\"></div>\n+    <div class=\"appIconView\" style=\"background-image:${this.iconValue}\"></div>\n+\n+    <footer class=\"card-tray\">\n+     <button class=\"appIcon\" data-l10n-id=\"openCard\"\n+       data-button-action=\"select\" aria-hidden=\"true\"></button>\n+     <menu class=\"buttonbar\">\n+       <button class=\"close-button bb-button\" data-l10n-id=\"closeCard\"\n+         data-button-action=\"close\" role=\"button\"\n+         style=\"visibility: ${this.closeButtonVisibility}\"></button>\n+      <button class=\"favorite-button bb-button\"\n+        data-button-action=\"favorite\" role=\"button\"\n+        style=\"visibility: ${this.favoriteButtonVisibility}\"></button>\n+     </menu>\n+    </footer>`;\n+    /* jshint +W033 */\n+  };\n \n   /**\n    * Card html view - builds the innerHTML for a card element\n    * @memberOf Card.prototype\n    */\n   Card.prototype.view = function c_view() {\n-    var viewData = this;\n-    return this._template.replace(/\\{([^\\}]+)\\}/g, function(m, key) {\n-        return viewData[key];\n-    });\n+    return this.template();\n   };\n \n   /**"
        },
        {
          "filename": "apps/system/test/unit/card_test.js",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,6 +1,7 @@\n /* global AppWindow, Card, MocksHelper, CardsHelper */\n 'use strict';\n \n+require('/shared/js/tagged.js');\n requireApp('system/test/unit/mock_app_window.js');\n requireApp('system/test/unit/mock_trusted_ui_manager.js');\n "
        },
        {
          "filename": "apps/system/test/unit/task_manager_test.js",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -11,6 +11,7 @@ requireApp('system/test/unit/mock_stack_manager.js');\n requireApp('system/test/unit/mock_app_window.js');\n requireApp('system/test/unit/mock_trusted_ui_manager.js');\n \n+require('/shared/js/tagged.js');\n require('/shared/test/unit/mocks/mock_service.js');\n require('/shared/test/unit/mocks/mock_navigator_moz_settings.js');\n require('/shared/test/unit/mocks/mock_l10n.js');"
        },
        {
          "filename": "shared/js/tagged.js",
          "status": "added",
          "additions": 38,
          "deletions": 0,
          "patch": "@@ -0,0 +1,38 @@\n+'use strict';\n+\n+/**\n+ * tagged.js is a simple library to help you manage tagged template strings.\n+ */\n+var Tagged = {\n+\n+  _entity: /[&<>\"'/]/g,\n+\n+  _entities: {\n+    '&': '&amp;',\n+    '<': '&lt;',\n+    '>': '&gt;',\n+    '\"': '&quot;',\n+    '\\'': '&apos;',\n+    '/': '&#x2F;'\n+  },\n+\n+  getEntity: function(s) {\n+    return Tagged._entities[s];\n+  },\n+\n+  /**\n+   * Escapes HTML for all values in a tagged template string.\n+   */\n+  escapeHTML: function(strings, ...values) {\n+    var result = '';\n+\n+    for (var i = 0; i < strings.length; i++) {\n+      result += strings[i];\n+      if (i < values.length) {\n+        result += String(values[i]).replace(Tagged._entity, Tagged.getEntity);\n+      }\n+    }\n+\n+    return result;\n+  }\n+};"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "975a35c0f5010df341e96d6c5ec60217f5347412",
            "date": "2016-09-20T18:48:56Z",
            "author_login": "kskarthik"
          },
          {
            "sha": "6765208dcb17b331b88d9b04de9c2e0e2fcd84cd",
            "date": "2016-09-20T15:17:02Z",
            "author_login": "lissyx"
          },
          {
            "sha": "3605cf867a67f4a3efbad4dbd8d73c79fc0f1765",
            "date": "2016-09-20T14:38:25Z",
            "author_login": "Vagrantin"
          },
          {
            "sha": "f5d355dfeb559e11fad48901b0bea287ec33b874",
            "date": "2016-09-15T00:07:30Z",
            "author_login": "fabricedesre"
          },
          {
            "sha": "af15f27705d150644fa7dd7710ac30ca9575d5f7",
            "date": "2016-09-13T16:50:05Z",
            "author_login": "asppsa"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in the Search app in Gaia in Mozilla Firefox OS before 2.2 allow remote attackers to inject arbitrary HTML via the (1) name or (2) title field in card content associated with a search link that is mishandled after a HOME button press or a Show Windows action, as demonstrated by embedding an arbitrary application or spoofing the account-creation page.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-08-08T00:59:02.097",
    "last_modified": "2024-11-21T02:27:57.937",
    "fix_date": "2014-11-26T18:27:46Z"
  },
  "references": [
    {
      "url": "http://www.mozilla.org/security/announce/2015/mfsa2015-73.html",
      "source": "security@mozilla.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1101158",
      "source": "security@mozilla.org",
      "tags": []
    },
    {
      "url": "https://github.com/mozilla-b2g/gaia/commit/0f72a8c31df9f3d8f609a7c58ca91139051d44eb",
      "source": "security@mozilla.org",
      "tags": []
    },
    {
      "url": "http://www.mozilla.org/security/announce/2015/mfsa2015-73.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1101158",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mozilla-b2g/gaia/commit/0f72a8c31df9f3d8f609a7c58ca91139051d44eb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:35.797139",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gaia",
    "owner": "mozilla-b2g",
    "created_at": "2011-09-03T01:38:46Z",
    "updated_at": "2025-01-13T16:11:36Z",
    "pushed_at": "2021-07-05T07:06:28Z",
    "size": 999796,
    "stars": 2094,
    "forks": 2261,
    "open_issues": 681,
    "watchers": 2094,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 39363992,
      "HTML": 2881039,
      "CSS": 1562638,
      "Python": 1480429,
      "Java": 826936,
      "Makefile": 57230,
      "Shell": 52347,
      "C++": 19243,
      "DIGITAL Command Language": 10122,
      "Batchfile": 6705
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:19:25.090593"
  }
}