{
  "cve_id": "CVE-2015-3296",
  "github_data": {
    "repository": "julianlam/nodebb-plugin-markdown",
    "fix_commit": "ab7f2684750882f7baefbfa31db8d5aac71e6ec3",
    "related_commits": [
      "ab7f2684750882f7baefbfa31db8d5aac71e6ec3",
      "ab7f2684750882f7baefbfa31db8d5aac71e6ec3"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "ab7f2684750882f7baefbfa31db8d5aac71e6ec3",
      "commit_date": "2015-03-30T20:59:42Z",
      "author": {
        "login": "julianlam",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "updated plugin to use markdown-it instead of remarkable, and updated validateLink method to discard all data-uris, until a solution is developed upstream.",
        "length": 154,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 14,
        "deletions": 3
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 13,
          "deletions": 2,
          "patch": "@@ -1,7 +1,7 @@\n (function() {\n \t\"use strict\";\n \n-\tvar\tRemarkable = require('remarkable'),\n+\tvar\tMarkdownIt = require('markdown-it'),\n \t\tfs = require('fs'),\n \t\tpath = require('path'),\n \t\turl = require('url'),\n@@ -67,7 +67,18 @@\n \t\t\t\t\t_self.highlight = _self.config.highlight || true;\n \t\t\t\t\tdelete _self.config.highlight;\n \n-\t\t\t\t\tparser = new Remarkable(_self.config);\n+\t\t\t\t\tparser = new MarkdownIt(_self.config);\n+\n+\t\t\t\t\t// Override the link validator from MarkdownIt, so you cannot link directly to a data-uri\n+\t\t\t\t\tparser.validateLink = function(url) {\n+\t\t\t\t\t\tvar BAD_PROTOCOLS    = [ 'vbscript', 'javascript', 'file', 'data' ];\n+\t\t\t\t\t\tvar str = url.trim().toLowerCase();\n+\n+\t\t\t\t\t\tif (str.indexOf(':') >= 0 && BAD_PROTOCOLS.indexOf(str.split(':')[0]) >= 0) {\n+\t\t\t\t\t\t\treturn false;\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\treturn true;\n+\t\t\t\t\t}\n \t\t\t\t});\n \t\t\t},\n "
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n     \"url\": \"https://github.com/julianlam/nodebb-plugin-markdown/issues\"\n   },\n   \"dependencies\": {\n-    \"remarkable\": \"^1.3.0\"\n+    \"markdown-it\": \"^4.0.3\"\n   },\n   \"nbbpm\": {\n     \"compatibility\": \"^0.7.0\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5164c2953dafb904c9d343d973fd2c08f0d4c146",
            "date": "2025-01-23T19:48:04Z",
            "author_login": "julianlam"
          },
          {
            "sha": "479aeec9ca426397464f4ba9e9bd9479dce73b8e",
            "date": "2025-01-23T19:48:01Z",
            "author_login": "julianlam"
          },
          {
            "sha": "f29cc97334a53b243127634dce396057451cea38",
            "date": "2025-01-16T21:20:13Z",
            "author_login": "julianlam"
          },
          {
            "sha": "21fe8f4caedde68d4cf6b3b99b3e891e42eab526",
            "date": "2025-01-16T21:20:06Z",
            "author_login": "julianlam"
          },
          {
            "sha": "39605e583b4634e60519d82f49ceedcf30a82058",
            "date": "2025-01-16T21:19:09Z",
            "author_login": "julianlam"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in NodeBB before 0.7 allow remote attackers to inject arbitrary web script or HTML via vectors related to (1) javascript: or (2) data: URLs.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-21T14:29:00.183",
    "last_modified": "2024-11-21T02:29:06.093",
    "fix_date": "2015-03-30T20:59:42Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/04/10/10",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/71824",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/julianlam/nodebb-plugin-markdown/commit/ab7f2684750882f7baefbfa31db8d5aac71e6ec3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/04/10/10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/71824",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/julianlam/nodebb-plugin-markdown/commit/ab7f2684750882f7baefbfa31db8d5aac71e6ec3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.391261",
    "processing_status": "enhanced"
  }
}