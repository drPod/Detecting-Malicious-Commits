{
  "cve_id": "CVE-2015-3400",
  "github_data": {
    "repository": "zfsonlinux/zfs",
    "fix_commit": "99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4",
    "related_commits": [
      "99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4",
      "99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4"
    ],
    "patch_url": "https://github.com/zfsonlinux/zfs/commit/99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4.patch",
    "fix_commit_details": {
      "sha": "99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4",
      "commit_date": "2014-10-26T13:29:11Z",
      "author": {
        "login": "FransUrbo",
        "type": "User",
        "stats": {
          "total_commits": 64,
          "average_weekly_commits": 0.07256235827664399,
          "total_additions": 7342,
          "total_deletions": 1636,
          "weeks_active": 37
        }
      },
      "commit_message": {
        "title": "Move nfs.c:foreach_nfs_shareopt() to libshare.c:foreach_shareopt()",
        "length": 121,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 129,
        "additions": 64,
        "deletions": 65
      },
      "files": [
        {
          "filename": "lib/libshare/libshare.c",
          "status": "modified",
          "additions": 59,
          "deletions": 0,
          "patch": "@@ -56,6 +56,65 @@ static int update_zfs_shares(sa_handle_impl_t impl_handle, const char *proto);\n static int fstypes_count;\n static sa_fstype_t *fstypes;\n \n+/*\n+ * Invokes the specified callback function for each Solaris share option\n+ * listed in the specified string.\n+ */\n+int\n+foreach_shareopt(const char *shareopts,\n+    nfs_shareopt_callback_t callback, void *cookie)\n+{\n+\tchar *shareopts_dup, *opt, *cur, *value;\n+\tint was_nul, rc;\n+\n+\tif (shareopts == NULL)\n+\t\treturn (SA_OK);\n+\n+\tshareopts_dup = strdup(shareopts);\n+\tif (shareopts_dup == NULL)\n+\t\treturn (SA_NO_MEMORY);\n+\n+\topt = shareopts_dup;\n+\twas_nul = 0;\n+\n+\twhile (1) {\n+\t\tcur = opt;\n+\n+\t\twhile (*cur != ',' && *cur != '\\0')\n+\t\t\tcur++;\n+\n+\t\tif (*cur == '\\0')\n+\t\t\twas_nul = 1;\n+\n+\t\t*cur = '\\0';\n+\n+\t\tif (cur > opt) {\n+\t\t\tvalue = strchr(opt, '=');\n+\n+\t\t\tif (value != NULL) {\n+\t\t\t\t*value = '\\0';\n+\t\t\t\tvalue++;\n+\t\t\t}\n+\n+\t\t\trc = callback(opt, value, cookie);\n+\n+\t\t\tif (rc != SA_OK) {\n+\t\t\t\tfree(shareopts_dup);\n+\t\t\t\treturn (rc);\n+\t\t\t}\n+\t\t}\n+\n+\t\topt = cur + 1;\n+\n+\t\tif (was_nul)\n+\t\t\tbreak;\n+\t}\n+\n+\tfree(shareopts_dup);\n+\n+\treturn (SA_OK);\n+}\n+\n sa_fstype_t *\n register_fstype(const char *name, const sa_share_ops_t *ops)\n {"
        },
        {
          "filename": "lib/libshare/libshare_impl.h",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -67,4 +67,7 @@ typedef struct sa_handle_impl {\n \tsa_share_impl_t shares;\n } *sa_handle_impl_t;\n \n+typedef int (*nfs_shareopt_callback_t)(const char *, const char *, void *);\n+\n sa_fstype_t *register_fstype(const char *name, const sa_share_ops_t *ops);\n+int foreach_shareopt(const char *, nfs_shareopt_callback_t, void *);"
        },
        {
          "filename": "lib/libshare/nfs.c",
          "status": "modified",
          "additions": 2,
          "deletions": 65,
          "patch": "@@ -44,72 +44,9 @@ static sa_fstype_t *nfs_fstype;\n  */\n static int nfs_exportfs_temp_fd = -1;\n \n-typedef int (*nfs_shareopt_callback_t)(const char *opt, const char *value,\n-    void *cookie);\n-\n typedef int (*nfs_host_callback_t)(const char *sharepath, const char *host,\n     const char *security, const char *access, void *cookie);\n \n-/*\n- * Invokes the specified callback function for each Solaris share option\n- * listed in the specified string.\n- */\n-static int\n-foreach_nfs_shareopt(const char *shareopts,\n-    nfs_shareopt_callback_t callback, void *cookie)\n-{\n-\tchar *shareopts_dup, *opt, *cur, *value;\n-\tint was_nul, rc;\n-\n-\tif (shareopts == NULL)\n-\t\treturn (SA_OK);\n-\n-\tshareopts_dup = strdup(shareopts);\n-\n-\tif (shareopts_dup == NULL)\n-\t\treturn (SA_NO_MEMORY);\n-\n-\topt = shareopts_dup;\n-\twas_nul = 0;\n-\n-\twhile (1) {\n-\t\tcur = opt;\n-\n-\t\twhile (*cur != ',' && *cur != '\\0')\n-\t\t\tcur++;\n-\n-\t\tif (*cur == '\\0')\n-\t\t\twas_nul = 1;\n-\n-\t\t*cur = '\\0';\n-\n-\t\tif (cur > opt) {\n-\t\t\tvalue = strchr(opt, '=');\n-\n-\t\t\tif (value != NULL) {\n-\t\t\t\t*value = '\\0';\n-\t\t\t\tvalue++;\n-\t\t\t}\n-\n-\t\t\trc = callback(opt, value, cookie);\n-\n-\t\t\tif (rc != SA_OK) {\n-\t\t\t\tfree(shareopts_dup);\n-\t\t\t\treturn (rc);\n-\t\t\t}\n-\t\t}\n-\n-\t\topt = cur + 1;\n-\n-\t\tif (was_nul)\n-\t\t\tbreak;\n-\t}\n-\n-\tfree(shareopts_dup);\n-\n-\treturn (0);\n-}\n-\n typedef struct nfs_host_cookie_s {\n \tnfs_host_callback_t callback;\n \tconst char *sharepath;\n@@ -118,7 +55,7 @@ typedef struct nfs_host_cookie_s {\n } nfs_host_cookie_t;\n \n /*\n- * Helper function for foreach_nfs_host. This function checks whether the\n+ * Helper function for foreach_host. This function checks whether the\n  * current share option is a host specification and invokes a callback\n  * function with information about the host.\n  */\n@@ -390,7 +327,7 @@ get_linux_shareopts(const char *shareopts, char **plinux_opts)\n \t(void) add_linux_shareopt(plinux_opts, \"no_root_squash\", NULL);\n \t(void) add_linux_shareopt(plinux_opts, \"mountpoint\", NULL);\n \n-\trc = foreach_nfs_shareopt(shareopts, get_linux_shareopts_cb,\n+\trc = foreach_shareopt(shareopts, get_linux_shareopts_cb,\n \t    plinux_opts);\n \n \tif (rc != SA_OK) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fe44c5ae27993a8ff53f4cefb8a1510863efc8dc",
            "date": "2025-01-14T00:51:37Z",
            "author_login": "robn"
          },
          {
            "sha": "2aa3fbe761a2f38c1fe743467635b1323bebe093",
            "date": "2025-01-13T13:33:31Z",
            "author_login": "robn"
          },
          {
            "sha": "fae4c664a4a67f51d13520ab432d96315d880af8",
            "date": "2025-01-11T09:26:42Z",
            "author_login": "amotin"
          },
          {
            "sha": "b8e09c7007a0733a497aebe734cb8ed23a0415ae",
            "date": "2025-01-07T23:43:01Z",
            "author_login": "robn"
          },
          {
            "sha": "18c67d2418c571a0a85592401db793b5e6a9343a",
            "date": "2025-01-06T01:27:19Z",
            "author_login": "n0-1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "sharenfs 0.6.4, when built with commits bcdd594 and 7d08880 from the zfs repository, provides world readable access to the shared zfs file system, which might allow remote authenticated users to obtain sensitive information by reading shared files.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-10-18T15:29:00.423",
    "last_modified": "2024-11-21T02:29:21.367",
    "fix_date": "2014-10-26T13:29:11Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/04/22/4",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74272",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/FransUrbo/zfs/commit/99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zfsonlinux/zfs/issues/3319",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zfsonlinux/zfs/pull/2790/commits",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/04/22/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74272",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/FransUrbo/zfs/commit/99aa4d2b4fd12c6bef62d02ffd1b375ddd42fcf4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zfsonlinux/zfs/issues/3319",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zfsonlinux/zfs/pull/2790/commits",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.703596",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "zfs",
    "owner": "zfsonlinux",
    "created_at": "2009-12-14T20:20:34Z",
    "updated_at": "2025-01-14T19:59:05Z",
    "pushed_at": "2025-01-14T01:05:13Z",
    "size": 134369,
    "stars": 10865,
    "forks": 1776,
    "open_issues": 1532,
    "watchers": 10865,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "zfs-0.6.4-release",
      "zfs-0.6.5-release",
      "zfs-0.7-release",
      "zfs-0.8-release",
      "zfs-0.8.7-staging",
      "zfs-2.0-release",
      "zfs-2.0.3-staging",
      "zfs-2.0.4-staging",
      "zfs-2.0.5-staging",
      "zfs-2.0.6-staging",
      "zfs-2.0.7-staging",
      "zfs-2.1-release",
      "zfs-2.1.1-staging",
      "zfs-2.1.2-staging",
      "zfs-2.1.3-staging",
      "zfs-2.1.4-staging",
      "zfs-2.1.5-staging",
      "zfs-2.1.6-staging",
      "zfs-2.1.7-staging",
      "zfs-2.1.8-staging",
      "zfs-2.1.9-staging",
      "zfs-2.1.10-staging",
      "zfs-2.1.11-staging",
      "zfs-2.1.12-staging"
    ],
    "languages": {
      "C": 17345369,
      "Shell": 4395881,
      "Assembly": 1151541,
      "M4": 442546,
      "Python": 401894,
      "Makefile": 197544,
      "Lua": 39188,
      "Perl": 37331,
      "Roff": 3827,
      "sed": 1970
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T20:12:26.448272"
  }
}