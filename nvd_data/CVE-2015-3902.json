{
  "cve_id": "CVE-2015-3902",
  "github_data": {
    "repository": "phpmyadmin/phpmyadmin",
    "fix_commit": "ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
    "related_commits": [
      "ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
      "ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
      "commit_date": "2015-05-12T05:51:47Z",
      "author": {
        "login": "madhuracj",
        "type": "User",
        "stats": {
          "total_commits": 6377,
          "average_weekly_commits": 5.358823529411764,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 259
        }
      },
      "commit_message": {
        "title": "bug #4899 [security] CSRF vulnerability in setup",
        "length": 105,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 57,
        "additions": 33,
        "deletions": 24
      },
      "files": [
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1,6 +1,9 @@\n phpMyAdmin - ChangeLog\n ======================\n \n+4.4.6.1 (Not yet released)\n+- bug #4899 [security] CSRF vulnerability in setup\n+\n 4.4.6.0 (2015-05-07)\n - bug #4890 webkitStorageInfo and webkitIndexedDB is deprecated\n - bug #4892 Undefined variable: unique_conditions"
        },
        {
          "filename": "libraries/url_generating.lib.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -179,6 +179,7 @@ function PMA_URL_getCommon($params = array(), $encode = 'html', $divider = '?')\n     if (isset($GLOBALS['server'])\n         && $GLOBALS['server'] != $GLOBALS['cfg']['ServerDefault']\n         && ! isset($params['server'])\n+        && ! defined('PMA_SETUP')\n     ) {\n         $params['server'] = $GLOBALS['server'];\n     }"
        },
        {
          "filename": "setup/frames/form.inc.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -19,8 +19,8 @@\n \n require './libraries/config/setup.forms.php';\n \n-$formset_id = filter_input(INPUT_GET, 'formset');\n-$mode = filter_input(INPUT_GET, 'mode');\n+$formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;\n+$mode = isset($_GET['mode']) ? $_GET['mode'] : null;\n if (! isset($forms[$formset_id])) {\n     PMA_fatalError(__('Incorrect formset, check $formsets array in setup/frames/form.inc.php!'));\n }"
        },
        {
          "filename": "setup/frames/index.inc.php",
          "status": "modified",
          "additions": 5,
          "deletions": 6,
          "patch": "@@ -174,12 +174,12 @@\n         echo '<td>' . htmlspecialchars($cf->getServerDSN($id)) . '</td>';\n         echo '<td style=\"white-space: nowrap\">';\n         echo '<small>';\n-        echo '<a href=\"?page=servers' . $separator\n-            . 'mode=edit' . $separator . 'id=' . $id . '\">'\n+        echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'\n+            . $separator . 'mode=edit' . $separator . 'id=' . $id . '\">'\n             . __('Edit') . '</a>';\n         echo ' | ';\n-        echo '<a href=\"?page=servers' . $separator\n-            . 'mode=remove' . $separator . 'id=' . $id . '\">'\n+        echo '<a href=\"' . PMA_URL_getCommon() . $separator . 'page=servers'\n+            . $separator . 'mode=remove' . $separator . 'id=' . $id . '\">'\n             . __('Delete') . '</a>';\n         echo '</small>';\n         echo '</td>';\n@@ -308,7 +308,6 @@\n echo '<a href=\"http://www.phpmyadmin.net/\">' . __('phpMyAdmin homepage') . '</a>';\n echo '<a href=\"http://sourceforge.net/donate/index.php?group_id=23067\">'\n     .  __('Donate') . '</a>';\n-echo '<a href=\"?version_check=1' . $separator\n-    . 'token=' . $_SESSION[' PMA_token '] . '\">'\n+echo '<a href=\"' .  PMA_URL_getCommon() . $separator . 'version_check=1\">'\n     . __('Check for latest version') . '</a>';\n echo '</div>';"
        },
        {
          "filename": "setup/frames/menu.inc.php",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -10,11 +10,11 @@\n     exit;\n }\n \n-$formset_id = filter_input(INPUT_GET, 'formset');\n+$formset_id = isset($_GET['formset']) ? $_GET['formset'] : null;\n \n $separator = PMA_URL_getArgSeparator('html');\n echo '<ul>';\n-echo '<li><a href=\"index.php\"'\n+echo '<li><a href=\"index.php' . PMA_URL_getCommon() . '\"'\n     . ($formset_id === null ? ' class=\"active' : '')\n     . '\">' . __('Overview') . '</a></li>';\n \n@@ -28,7 +28,8 @@\n );\n \n foreach ($formsets as $formset => $label) {\n-    echo '<li><a href=\"?page=form' . $separator . 'formset=' . $formset . '\" '\n+    echo '<li><a href=\"' . PMA_URL_getCommon() . $separator . 'page=form'\n+        . $separator . 'formset=' . $formset . '\" '\n         . ($formset_id === $formset ? ' class=\"active' : '')\n         . '\">' . $label . '</a></li>';\n }"
        },
        {
          "filename": "setup/frames/servers.inc.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -19,8 +19,8 @@\n \n require './libraries/config/setup.forms.php';\n \n-$mode = filter_input(INPUT_GET, 'mode');\n-$id = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);\n+$mode = isset($_GET['mode']) ? $_GET['mode'] : null;\n+$id = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;\n \n $cf = $GLOBALS['ConfigFile'];\n $server_exists = !empty($id) && $cf->get(\"Servers/$id\") !== null;"
        },
        {
          "filename": "setup/index.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -12,7 +12,7 @@\n  */\n require './lib/common.inc.php';\n \n-$page = filter_input(INPUT_GET, 'page');\n+$page = isset($_GET['page']) ? $_GET['page'] : null;\n $page = preg_replace('/[^a-z]/', '', $page);\n if ($page === '') {\n     $page = 'index';\n@@ -23,7 +23,7 @@\n }\n \n // Handle done action info\n-$action_done = filter_input(INPUT_GET, 'action_done');\n+$action_done = isset($_GET['action_done']) ? $_GET['action_done'] : null;\n $action_done = preg_replace('/[^a-z_]/', '', $action_done);\n \n PMA_noCacheHeader();"
        },
        {
          "filename": "setup/lib/form_processing.lib.php",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -15,7 +15,7 @@\n  */\n function PMA_Process_formset(FormDisplay $form_display)\n {\n-    if (filter_input(INPUT_GET, 'mode') == 'revert') {\n+    if (isset($_GET['mode']) && $_GET['mode'] == 'revert') {\n         // revert erroneous fields to their default values\n         $form_display->fixErrors();\n         PMA_generateHeader303();\n@@ -35,10 +35,10 @@ function PMA_Process_formset(FormDisplay $form_display)\n \n     // form has errors, show warning\n     $separator = PMA_URL_getArgSeparator('html');\n-    $page = filter_input(INPUT_GET, 'page');\n-    $formset = filter_input(INPUT_GET, 'formset');\n+    $page = isset($_GET['page']) ? $_GET['page'] : null;\n+    $formset = isset($_GET['formset']) ? $_GET['formset'] : null;\n     $formset = $formset ? \"{$separator}formset=$formset\" : '';\n-    $formId = filter_input(INPUT_GET, 'id', FILTER_VALIDATE_INT);\n+    $formId = PMA_isValid($_GET['id'], 'numeric') ? $_GET['id'] : null;\n     if ($formId === null && $page == 'servers') {\n         // we've just added a new server, get its id\n         $formId = $form_display->getConfigFile()->getServerCount();\n@@ -48,15 +48,18 @@ function PMA_Process_formset(FormDisplay $form_display)\n     <div class=\"error\">\n         <h4><?php echo __('Warning') ?></h4>\n         <?php echo __('Submitted form contains errors') ?><br />\n-        <a href=\"?page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">\n+        <a href=\"<?php echo PMA_URL_getCommon() . $separator ?>\n+            page=<?php echo $page . $formset . $formId . $separator ?>mode=revert\">\n             <?php echo __('Try to revert erroneous fields to their default values')\n             ?>\n         </a>\n     </div>\n     <?php $form_display->displayErrors() ?>\n-    <a class=\"btn\" href=\"index.php\"><?php echo __('Ignore errors') ?></a>\n+    <a class=\"btn\" href=\"index.php<?php echo PMA_URL_getCommon() ?>\">\n+        <?php echo __('Ignore errors') ?></a>\n     &nbsp;\n-    <a class=\"btn\" href=\"?page=<?php echo $page . $formset . $formId\n+    <a class=\"btn\" href=\"<?php echo PMA_URL_getCommon() . $separator ?>\n+        page=<?php echo $page . $formset . $formId\n         . $separator ?>mode=edit\"><?php echo __('Show form') ?></a>\n     <?php\n }"
        },
        {
          "filename": "setup/validate.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -16,8 +16,10 @@\n \n header('Content-type: application/json');\n \n-$vids = explode(',', filter_input(INPUT_POST, 'id'));\n-$values = json_decode(filter_input(INPUT_POST, 'values'));\n+$ids = isset($_POST['id']) ? $_POST['id'] : null;\n+$vids = explode(',', $ids);\n+$vals = isset($_POST['values']) ? $_POST['values'] : null;\n+$values = json_decode($vals);\n if (!($values instanceof stdClass)) {\n     PMA_fatalError(__('Wrong data'));\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7826c9d7a3b716dcd003bc7d463f000e4b524d4c",
            "date": "2025-01-26T00:24:48Z",
            "author_login": "weblate"
          },
          {
            "sha": "ed160ad0b56fd25ccf2ee3bc006d1f432fc1d09e",
            "date": "2025-01-25T20:26:47Z",
            "author_login": "Hotr1pak"
          },
          {
            "sha": "584426a6b69fcae6b660e718948db538583e55f9",
            "date": "2025-01-25T20:38:06Z",
            "author_login": "BouRock"
          },
          {
            "sha": "c299bc21ed054ebccffd5d040d7ae48b678ed5a8",
            "date": "2025-01-25T16:10:10Z",
            "author_login": "Atalanttore"
          },
          {
            "sha": "88251cde4d58109a29ab324685ad1810550aa9c3",
            "date": "2025-01-26T00:24:26Z",
            "author_login": "phpmyadmin-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "Multiple cross-site request forgery (CSRF) vulnerabilities in the setup process in phpMyAdmin 4.0.x before 4.0.10.10, 4.2.x before 4.2.13.3, 4.3.x before 4.3.13.1, and 4.4.x before 4.4.6.1 allow remote attackers to hijack the authentication of administrators for requests that modify the configuration file.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-05-26T15:59:10.370",
    "last_modified": "2024-11-21T02:30:03.283",
    "fix_date": "2015-05-12T05:51:47Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2015-07/msg00008.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3382",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.phpmyadmin.net/home_page/security/PMASA-2015-2.php",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74657",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1032404",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2015-07/msg00008.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3382",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.phpmyadmin.net/home_page/security/PMASA-2015-2.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74657",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1032404",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/ee92eb9bab8e2d546756c1d4aec81ec7c8e44b83",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:35.776334",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "phpmyadmin",
    "owner": "phpmyadmin",
    "created_at": "2012-01-19T13:21:52Z",
    "updated_at": "2025-01-26T00:25:14Z",
    "pushed_at": "2025-01-26T00:25:10Z",
    "size": 2097102,
    "stars": 7353,
    "forks": 3438,
    "open_issues": 827,
    "watchers": 7353,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "QA_4_7",
      "QA_4_8",
      "QA_5_0",
      "master"
    ],
    "languages": {
      "PHP": 8225641,
      "TypeScript": 1345883,
      "Twig": 804295,
      "SCSS": 311820,
      "Shell": 52286,
      "JavaScript": 16892,
      "Hack": 588
    },
    "commit_activity": {
      "total_commits_last_year": 1628,
      "avg_commits_per_week": 31.307692307692307,
      "days_active_last_year": 308
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:41:34.655266"
  }
}