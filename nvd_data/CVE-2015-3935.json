{
  "cve_id": "CVE-2015-3935",
  "github_data": {
    "repository": "GPCsolutions/dolibarr",
    "fix_commit": "a7f6bbd316e9b96216e9b2c7a065c9251c9a8907",
    "related_commits": [
      "a7f6bbd316e9b96216e9b2c7a065c9251c9a8907",
      "a7f6bbd316e9b96216e9b2c7a065c9251c9a8907"
    ],
    "patch_url": "https://github.com/GPCsolutions/dolibarr/commit/a7f6bbd316e9b96216e9b2c7a065c9251c9a8907.patch",
    "fix_commit_details": {
      "sha": "a7f6bbd316e9b96216e9b2c7a065c9251c9a8907",
      "commit_date": "2015-05-20T15:32:34Z",
      "author": {
        "login": "rdoursenaud",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Properly escape untrusted data to prevent HTML injection.",
        "length": 79,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 138,
        "additions": 69,
        "deletions": 69
      },
      "files": [
        {
          "filename": "htdocs/adherents/liste.php",
          "status": "modified",
          "additions": 18,
          "deletions": 18,
          "patch": "@@ -2,7 +2,7 @@\n /* Copyright (C) 2001-2003 Rodolphe Quiedeville <rodolphe@quiedeville.org>\n  * Copyright (C) 2002-2003 Jean-Louis Bergamo   <jlb@j1b.org>\n  * Copyright (C) 2004-2014 Laurent Destailleur  <eldy@users.sourceforge.net>\n- * Copyright (C) 2013      Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n+ * Copyright (C) 2013-2015 Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n  *\n  * This program is free software; you can redistribute it and/or modify\n  * it under the terms of the GNU General Public License as published by\n@@ -97,7 +97,7 @@\n $sql.= \" WHERE d.fk_adherent_type = t.rowid \";\n if ($catid > 0)    $sql.= \" AND cm.fk_categorie = \".$catid;\n if ($catid == -2)  $sql.= \" AND cm.fk_categorie IS NULL\";\n-if ($search_categ > 0)   $sql.= \" AND cm.fk_categorie = \".$search_categ;\n+if ($search_categ > 0)   $sql.= \" AND cm.fk_categorie = \".$db->escape($search_categ);\n if ($search_categ == -2) $sql.= \" AND cm.fk_categorie IS NULL\";\n $sql.= \" AND d.entity = \".$conf->entity;\n if ($sall)\n@@ -106,15 +106,15 @@\n         $scrit = explode(' ', $sall);\n         foreach ($scrit as $crit) {\n             $sql.=\" AND (\";\n-            if (is_numeric($sall)) $sql.= \"d.rowid = \".$sall.\" OR \";\n-            $sql.=\" d.firstname LIKE '%\".$sall.\"%' OR d.lastname LIKE '%\".$sall.\"%' OR d.societe LIKE '%\".$sall.\"%'\";\n-            $sql.=\" OR d.email LIKE '%\".$sall.\"%' OR d.login LIKE '%\".$sall.\"%' OR d.address LIKE '%\".$sall.\"%'\";\n-            $sql.=\" OR d.town LIKE '%\".$sall.\"%' OR d.note LIKE '%\".$sall.\"%')\";\n+            if (is_numeric($sall)) $sql.= \"d.rowid = \".$db->escape($sall).\" OR \";\n+            $sql.=\" d.firstname LIKE '%\".$db->escape($sall).\"%' OR d.lastname LIKE '%\".$db->escape($sall).\"%' OR d.societe LIKE '%\".$db->escape($sall).\"%'\";\n+            $sql.=\" OR d.email LIKE '%\".$db->escape($sall).\"%' OR d.login LIKE '%\".$db->escape($sall).\"%' OR d.address LIKE '%\".$db->escape($sall).\"%'\";\n+            $sql.=\" OR d.town LIKE '%\".$db->escape($sall).\"%' OR d.note LIKE '%\".$db->escape($sall).\"%')\";\n         }\n }\n if ($type > 0)\n {\n-\t$sql.=\" AND t.rowid=\".$type;\n+\t$sql.=\" AND t.rowid=\".$db->escape($type);\n }\n if (isset($_GET[\"statut\"]) || isset($_POST[\"statut\"]))\n {\n@@ -188,17 +188,17 @@\n \t}\n \n \t$param=\"\";\n-\tif ($statut != \"\") $param.=\"&statut=\".$statut;\n-\tif ($search_nom)   $param.=\"&search_nom=\".$search_nom;\n-\tif ($search_login) $param.=\"&search_login=\".$search_login;\n-\tif ($search_email) $param.=\"&search_email=\".$search_email;\n-\tif ($filter)       $param.=\"&filter=\".$filter;\n-\tif ($type > 0)     $param.=\"&type=\".$type;\n+\tif ($statut != \"\") $param.=\"&statut=\".htmlspecialchars($statut);\n+\tif ($search_nom)   $param.=\"&search_nom=\".htmlspecialchars($search_nom);\n+\tif ($search_login) $param.=\"&search_login=\".htmlspecialchars($search_login);\n+\tif ($search_email) $param.=\"&search_email=\".htmlspecialchars($search_email);\n+\tif ($filter)       $param.=\"&filter=\".htmlspecialchars($filter);\n+\tif ($type > 0)     $param.=\"&type=\".htmlspecialchars($type);\n \tprint_barre_liste($titre,$page,$_SERVER[\"PHP_SELF\"],$param,$sortfield,$sortorder,'',$num,$nbtotalofrecords);\n \n \tif ($sall)\n \t{\n-\t\tprint $langs->trans(\"Filter\").\" (\".$langs->trans(\"Ref\").\", \".$langs->trans(\"Lastname\").\", \".$langs->trans(\"Firstname\").\", \".$langs->trans(\"EMail\").\", \".$langs->trans(\"Address\").\" \".$langs->trans(\"or\").\" \".$langs->trans(\"Town\").\"): \".$sall;\n+\t\tprint $langs->trans(\"Filter\").\" (\".$langs->trans(\"Ref\").\", \".$langs->trans(\"Lastname\").\", \".$langs->trans(\"Firstname\").\", \".$langs->trans(\"EMail\").\", \".$langs->trans(\"Address\").\" \".$langs->trans(\"or\").\" \".$langs->trans(\"Town\").\"): \".htmlspecialchars($sall);\n \t}\n \n \tprint '<form method=\"POST\" action=\"'.$_SERVER[\"PHP_SELF\"].($param?'?'.$param:'').'\">';\n@@ -236,13 +236,13 @@\n \tprint '<tr class=\"liste_titre\">';\n \n \tprint '<td class=\"liste_titre\" align=\"left\">';\n-\tprint '<input class=\"flat\" type=\"text\" name=\"search_ref\" value=\"'.$search_ref.'\" size=\"4\"></td>';\n+\tprint '<input class=\"flat\" type=\"text\" name=\"search_ref\" value=\"'.htmlspecialchars($search_ref).'\" size=\"4\"></td>';\n \n \tprint '<td class=\"liste_titre\" align=\"left\">';\n-\tprint '<input class=\"flat\" type=\"text\" name=\"search_lastname\" value=\"'.$search_lastname.'\" size=\"12\"></td>';\n+\tprint '<input class=\"flat\" type=\"text\" name=\"search_lastname\" value=\"'.htmlspecialchars($search_lastname).'\" size=\"12\"></td>';\n \n \tprint '<td class=\"liste_titre\" align=\"left\">';\n-\tprint '<input class=\"flat\" type=\"text\" name=\"search_login\" value=\"'.$search_login.'\" size=\"7\"></td>';\n+\tprint '<input class=\"flat\" type=\"text\" name=\"search_login\" value=\"'.htmlspecialchars($search_login).'\" size=\"7\"></td>';\n \n \tprint '<td class=\"liste_titre\">';\n \t$listetype=$membertypestatic->liste_array();\n@@ -252,7 +252,7 @@\n \tprint '<td class=\"liste_titre\">&nbsp;</td>';\n \n \tprint '<td class=\"liste_titre\" align=\"left\">';\n-\tprint '<input class=\"flat\" type=\"text\" name=\"search_email\" value=\"'.$search_email.'\" size=\"12\"></td>';\n+\tprint '<input class=\"flat\" type=\"text\" name=\"search_email\" value=\"'.htmlspecialchars($search_email).'\" size=\"12\"></td>';\n \n \tprint '<td class=\"liste_titre\">&nbsp;</td>';\n "
        },
        {
          "filename": "htdocs/contact/list.php",
          "status": "modified",
          "additions": 18,
          "deletions": 18,
          "patch": "@@ -3,7 +3,7 @@\n  * Copyright (C) 2003      Eric Seigne          <erics@rycks.com>\n  * Copyright (C) 2004-2012 Laurent Destailleur  <eldy@users.sourceforge.net>\n  * Copyright (C) 2005-2012 Regis Houssin        <regis.houssin@capnetworks.com>\n- * Copyright (C) 2013      Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n+ * Copyright (C) 2013-2015 Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n  * Copyright (C) 2013      C\u00e9dric Salvador      <csalvador@gpcsolutions.fr>\n  * Copyright (C) 2013      Alexandre Spangaro   <alexandre.spangaro@gmail.com> \n  *\n@@ -151,7 +151,7 @@\n \tif ($search_priv == '1') $sql .= \" AND (p.priv='1' AND p.fk_user_creat=\".$user->id.\")\";\n }\n \n-if ($search_categ > 0)   $sql.= \" AND cs.fk_categorie = \".$search_categ;\n+if ($search_categ > 0)   $sql.= \" AND cs.fk_categorie = \".$db->escape($search_categ);\n if ($search_categ == -2) $sql.= \" AND cs.fk_categorie IS NULL\";\n \n if ($search_lastname) {      // filter on lastname\n@@ -245,11 +245,11 @@\n {\n \t$contactstatic=new Contact($db);\n \n-    $param ='&begin='.urlencode($begin).'&view='.urlencode($view).'&userid='.urlencode($userid).'&contactname='.urlencode($sall);\n-    $param.='&type='.urlencode($type).'&view='.urlencode($view).'&search_lastname='.urlencode($search_lastname).'&search_firstname='.urlencode($search_firstname).'&search_societe='.urlencode($search_societe).'&search_email='.urlencode($search_email);\n-    if (!empty($search_categ)) $param.='&search_categ='.$search_categ;\n-    if ($search_status != '') $param.='&amp;search_status='.$search_status;\n-    if ($search_priv == '0' || $search_priv == '1') $param.=\"&search_priv=\".urlencode($search_priv);\n+    $param ='&begin='.htmlspecialchars($begin).'&view='.htmlspecialchars($view).'&userid='.htmlspecialchars($userid).'&contactname='.htmlspecialchars($sall);\n+    $param.='&type='.htmlspecialchars($type).'&view='.htmlspecialchars($view).'&search_lastname='.htmlspecialchars($search_lastname).'&search_firstname='.htmlspecialchars($search_firstname).'&search_societe='.htmlspecialchars($search_societe).'&search_email='.htmlspecialchars($search_email);\n+    if (!empty($search_categ)) $param.='&search_categ='.htmlspecialchars($search_categ);\n+    if ($search_status != '') $param.='&amp;search_status='.htmlspecialchars($search_status);\n+    if ($search_priv == '0' || $search_priv == '1') $param.=\"&search_priv=\".htmlspecialchars($search_priv);\n \n \t$num = $db->num_rows($result);\n     $i = 0;\n@@ -258,7 +258,7 @@\n \n     print '<form method=\"post\" action=\"'.$_SERVER[\"PHP_SELF\"].'\">';\n     print '<input type=\"hidden\" name=\"token\" value=\"'.$_SESSION['newtoken'].'\">';\n-    print '<input type=\"hidden\" name=\"view\" value=\"'.$view.'\">';\n+    print '<input type=\"hidden\" name=\"view\" value=\"'.htmlspecialchars($view).'\">';\n     print '<input type=\"hidden\" name=\"sortfield\" value=\"'.$sortfield.'\">';\n     print '<input type=\"hidden\" name=\"sortorder\" value=\"'.$sortorder.'\">';\n \n@@ -277,7 +277,7 @@\n     \n     if ($sall)\n     {\n-        print $langs->trans(\"Filter\").\" (\".$langs->trans(\"Lastname\").\", \".$langs->trans(\"Firstname\").\" \".$langs->trans(\"or\").\" \".$langs->trans(\"EMail\").\"): \".$sall;\n+        print $langs->trans(\"Filter\").\" (\".$langs->trans(\"Lastname\").\", \".$langs->trans(\"Firstname\").\" \".$langs->trans(\"or\").\" \".$langs->trans(\"EMail\").\"): \".htmlspecialchars($sall);\n     }\n \n     print '<table class=\"liste\" width=\"100%\">';\n@@ -302,36 +302,36 @@\n     // Ligne des champs de filtres\n     print '<tr class=\"liste_titre\">';\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_lastname\" size=\"9\" value=\"'.$search_lastname.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_lastname\" size=\"9\" value=\"'.htmlspecialchars($search_lastname).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_firstname\" size=\"9\" value=\"'.$search_firstname.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_firstname\" size=\"9\" value=\"'.htmlspecialchars($search_firstname).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_poste\" size=\"9\" value=\"'.$search_poste.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_poste\" size=\"9\" value=\"'.htmlspecialchars($search_poste).'\">';\n     print '</td>';\n     if (empty($conf->global->SOCIETE_DISABLE_CONTACTS))\n     {\n         print '<td class=\"liste_titre\">';\n-        print '<input class=\"flat\" type=\"text\" name=\"search_societe\" size=\"9\" value=\"'.$search_societe.'\">';\n+        print '<input class=\"flat\" type=\"text\" name=\"search_societe\" size=\"9\" value=\"'.htmlspecialchars($search_societe).'\">';\n         print '</td>';\n     }\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_phonepro\" size=\"8\" value=\"'.$search_phonepro.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_phonepro\" size=\"8\" value=\"'.htmlspecialchars($search_phonepro).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_phonemob\" size=\"8\" value=\"'.$search_phonemob.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_phonemob\" size=\"8\" value=\"'.htmlspecialchars($search_phonemob).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_fax\" size=\"8\" value=\"'.$search_fax.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_fax\" size=\"8\" value=\"'.htmlspecialchars($search_fax).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">';\n-    print '<input class=\"flat\" type=\"text\" name=\"search_email\" size=\"8\" value=\"'.$search_email.'\">';\n+    print '<input class=\"flat\" type=\"text\" name=\"search_email\" size=\"8\" value=\"'.htmlspecialchars($search_email).'\">';\n     print '</td>';\n     if (! empty($conf->skype->enabled))\n     {\n         print '<td class=\"liste_titre\">';\n-        print '<input class=\"flat\" type=\"text\" name=\"search_skype\" size=\"8\" value=\"'.$search_skype.'\">';\n+        print '<input class=\"flat\" type=\"text\" name=\"search_skype\" size=\"8\" value=\"'.htmlspecialchars($search_skype).'\">';\n         print '</td>';\n     }    \n \tprint '<td class=\"liste_titre\">&nbsp;</td>';"
        },
        {
          "filename": "htdocs/contrat/liste.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -78,7 +78,7 @@\n $sql.= \" LEFT JOIN \".MAIN_DB_PREFIX.\"contratdet as cd ON c.rowid = cd.fk_contrat\";\n $sql.= \" WHERE c.fk_soc = s.rowid \";\n $sql.= \" AND c.entity = \".$conf->entity;\n-if ($socid) $sql.= \" AND s.rowid = \".$socid;\n+if ($socid) $sql.= \" AND s.rowid = \".$db->escape($socid);\n if (!$user->rights->societe->client->voir && !$socid) $sql.= \" AND s.rowid = sc.fk_soc AND sc.fk_user = \" .$user->id;\n if ($search_nom) {\n     $sql .= natural_search('s.nom', $search_nom);\n@@ -100,13 +100,13 @@\n     $num = $db->num_rows($resql);\n     $i = 0;\n \n-    print_barre_liste($langs->trans(\"ListOfContracts\"), $page, $_SERVER[\"PHP_SELF\"], '&search_contract='.$search_contract.'&search_nom='.$search_nom, $sortfield, $sortorder,'',$num);\n+    print_barre_liste($langs->trans(\"ListOfContracts\"), $page, $_SERVER[\"PHP_SELF\"], '&search_contract='.htmlspecialchars($search_contract).'&search_nom='.htmlspecialchars($search_nom), $sortfield, $sortorder,'',$num);\n \n     print '<table class=\"liste\" width=\"100%\">';\n \n     print '<tr class=\"liste_titre\">';\n-    $param='&amp;search_contract='.$search_contract;\n-    $param.='&amp;search_nom='.$search_nom;\n+    $param='&amp;search_contract='.htmlspecialchars($search_contract);\n+    $param.='&amp;search_nom='.htmlspecialchars($search_nom);\n     print_liste_field_titre($langs->trans(\"Ref\"), $_SERVER[\"PHP_SELF\"], \"c.rowid\",\"\",\"$param\",'',$sortfield,$sortorder);\n     print_liste_field_titre($langs->trans(\"Company\"), $_SERVER[\"PHP_SELF\"], \"s.nom\",\"\",\"$param\",'',$sortfield,$sortorder);\n     //print_liste_field_titre($langs->trans(\"DateCreation\"), $_SERVER[\"PHP_SELF\"], \"c.datec\",\"\",\"$param\",'align=\"center\"',$sortfield,$sortorder);\n@@ -122,10 +122,10 @@\n     print '<input type=\"hidden\" name=\"token\" value=\"'.$_SESSION['newtoken'].'\">';\n     print '<tr class=\"liste_titre\">';\n     print '<td class=\"liste_titre\">';\n-    print '<input type=\"text\" class=\"flat\" size=\"3\" name=\"search_contract\" value=\"'.$search_contract.'\">';\n+    print '<input type=\"text\" class=\"flat\" size=\"3\" name=\"search_contract\" value=\"'.htmlspecialchars($search_contract).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">';\n-    print '<input type=\"text\" class=\"flat\" size=\"24\" name=\"search_nom\" value=\"'.$search_nom.'\">';\n+    print '<input type=\"text\" class=\"flat\" size=\"24\" name=\"search_nom\" value=\"'.htmlspecialchars($search_nom).'\">';\n     print '</td>';\n     print '<td class=\"liste_titre\">&nbsp;</td>';\n     //print '<td class=\"liste_titre\">&nbsp;</td>';"
        },
        {
          "filename": "htdocs/product/liste.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -4,7 +4,7 @@\n  * Copyright (C) 2005-2012 Regis Houssin        <regis.houssin@capnetworks.com>\n  * Copyright (C) 2012-2013 Marcos Garc\u00eda        <marcosgdf@gmail.com>\n  * Copyright (C) 2013      Juanjo Menent        <jmenent@2byte.es>\n- * Copyright (C) 2013      Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n+ * Copyright (C) 2013-2015 Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n  * Copyright (C) 2013      Jean Heimburger   \t<jean@tiaris.info>\n  * Copyright (C) 2013      C\u00e9dric Salvador      <csalvador@gpcsolutions.fr>\n  * Copyright (C) 2013      Florian Henry        <florian.henry@open-concept.pro>\n@@ -181,7 +181,7 @@\n     if (dol_strlen($canvas) > 0)                    $sql.= \" AND p.canvas = '\".$db->escape($canvas).\"'\";\n     if ($catid > 0)    $sql.= \" AND cp.fk_categorie = \".$catid;\n     if ($catid == -2)  $sql.= \" AND cp.fk_categorie IS NULL\";\n-    if ($search_categ > 0)   $sql.= \" AND cp.fk_categorie = \".$search_categ;\n+    if ($search_categ > 0)   $sql.= \" AND cp.fk_categorie = \".$db->escape($search_categ);\n     if ($search_categ == -2) $sql.= \" AND cp.fk_categorie IS NULL\";\n     if ($fourn_id > 0) $sql.= \" AND pfp.fk_soc = \".$fourn_id;\n     $sql.= \" GROUP BY p.rowid, p.ref, p.label, p.barcode, p.price, p.price_ttc, p.price_base_type,\";\n@@ -233,9 +233,9 @@\n     \t// Displays product removal confirmation\n     \tif (GETPOST('delprod'))\tdol_htmloutput_mesg($langs->trans(\"ProductDeleted\",GETPOST('delprod')));\n \n-    \t$param=\"&amp;sref=\".$sref.($sbarcode?\"&amp;sbarcode=\".$sbarcode:\"\").\"&amp;snom=\".$snom.\"&amp;sall=\".$sall.\"&amp;tosell=\".$tosell.\"&amp;tobuy=\".$tobuy;\n+    \t$param=\"&amp;sref=\".htmlspecialchars($sref).($sbarcode?\"&amp;sbarcode=\".htmlspecialchars($sbarcode):\"\").\"&amp;snom=\".htmlspecialchars($snom).\"&amp;sall=\".htmlspecialchars($sall).\"&amp;tosell=\".htmlspecialchars($tosell).\"&amp;tobuy=\".htmlspecialchars($tobuy);\n     \t$param.=($fourn_id?\"&amp;fourn_id=\".$fourn_id:\"\");\n-    \t$param.=($search_categ?\"&amp;search_categ=\".$search_categ:\"\");\n+    \t$param.=($search_categ?\"&amp;search_categ=\".htmlspecialchars($search_categ):\"\");\n     \t$param.=isset($type)?\"&amp;type=\".$type:\"\";\n \n     \tprint_barre_liste($texte, $page, \"liste.php\", $param, $sortfield, $sortorder, '', $num, $nbtotalofrecords);\n@@ -320,15 +320,15 @@\n     \t\t// Lignes des champs de filtre\n     \t\tprint '<tr class=\"liste_titre\">';\n     \t\tprint '<td class=\"liste_titre\" align=\"left\">';\n-    \t\tprint '<input class=\"flat\" type=\"text\" name=\"sref\" size=\"8\" value=\"'.$sref.'\">';\n+    \t\tprint '<input class=\"flat\" type=\"text\" name=\"sref\" size=\"8\" value=\"'.htmlspecialchars($sref).'\">';\n     \t\tprint '</td>';\n     \t\tprint '<td class=\"liste_titre\" align=\"left\">';\n-    \t\tprint '<input class=\"flat\" type=\"text\" name=\"snom\" size=\"12\" value=\"'.$snom.'\">';\n+    \t\tprint '<input class=\"flat\" type=\"text\" name=\"snom\" size=\"12\" value=\"'.htmlspecialchars($snom).'\">';\n     \t\tprint '</td>';\n     \t\tif (! empty($conf->barcode->enabled))\n     \t\t{\n     \t\t\tprint '<td class=\"liste_titre\">';\n-    \t\t\tprint '<input class=\"flat\" type=\"text\" name=\"sbarcode\" size=\"6\" value=\"'.$sbarcode.'\">';\n+    \t\t\tprint '<input class=\"flat\" type=\"text\" name=\"sbarcode\" size=\"6\" value=\"'.htmlspecialchars($sbarcode).'\">';\n     \t\t\tprint '</td>';\n     \t\t}\n     \t\tprint '<td class=\"liste_titre\">';\n@@ -510,9 +510,9 @@\n     \t\t\t$i++;\n     \t\t}\n \n-    \t\t$param=\"&amp;sref=\".$sref.($sbarcode?\"&amp;sbarcode=\".$sbarcode:\"\").\"&amp;snom=\".$snom.\"&amp;sall=\".$sall.\"&amp;tosell=\".$tosell.\"&amp;tobuy=\".$tobuy;\n+    \t\t$param=\"&amp;sref=\".htmlspecialchars($sref).($sbarcode?\"&amp;sbarcode=\".htmlspecialchars($sbarcode):\"\").\"&amp;snom=\".htmlspecialchars($snom).\"&amp;sall=\".htmlspecialchars($sall).\"&amp;tosell=\".htmlspecialchars($tosell).\"&amp;tobuy=\".htmlspecialchars($tobuy);\n     \t\t$param.=($fourn_id?\"&amp;fourn_id=\".$fourn_id:\"\");\n-    \t\t$param.=($search_categ?\"&amp;search_categ=\".$search_categ:\"\");\n+    \t\t$param.=($search_categ?\"&amp;search_categ=\".htmlspecialchars($search_categ):\"\");\n     \t\t$param.=isset($type)?\"&amp;type=\".$type:\"\";\n     \t\tprint_barre_liste('', $page, \"liste.php\", $param, $sortfield, $sortorder,'',$num,$nbtotalofrecords);\n "
        },
        {
          "filename": "htdocs/societe/societe.php",
          "status": "modified",
          "additions": 18,
          "deletions": 18,
          "patch": "@@ -3,7 +3,7 @@\n  * Copyright (C) 2004-2013 Laurent Destailleur  <eldy@users.sourceforge.net>\n  * Copyright (C) 2005-2012 Regis Houssin        <regis.houssin@capnetworks.com>\n  * Copyright (C) 2012      Marcos Garc\u00eda        <marcosgdf@gmail.com>\n- * Copyright (C) 2013      Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n+ * Copyright (C) 2013-2015 Rapha\u00ebl Doursenaud   <rdoursenaud@gpcsolutions.fr>\n  *\n  * This program is free software; you can redistribute it and/or modify\n  * it under the terms of the GNU General Public License as published by\n@@ -210,12 +210,12 @@\n // Insert sale filter\n if ($search_sale)\n {\n-    $sql .= \" AND sc.fk_user = \".$search_sale;\n+    $sql .= \" AND sc.fk_user = \".$db->escape($search_sale);\n }\n // Insert categ filter\n if ($search_categ)\n {\n-    $sql .= \" AND cs.fk_categorie = \".$search_categ;\n+    $sql .= \" AND cs.fk_categorie = \".$db->escape($search_categ);\n }\n if ($search_nom_only)\n {\n@@ -272,12 +272,12 @@\n \t$num = $db->num_rows($resql);\n \t$i = 0;\n \n-\t$params = \"&amp;socname=\".$socname.\"&amp;search_nom=\".$search_nom.\"&amp;search_town=\".$search_town;\n-\t$params.= ($sbarcode?\"&amp;sbarcode=\".$sbarcode:\"\");\n-\t$params.= '&amp;search_idprof1='.$search_idprof1;\n-\t$params.= '&amp;search_idprof2='.$search_idprof2;\n-\t$params.= '&amp;search_idprof3='.$search_idprof3;\n-\t$params.= '&amp;search_idprof4='.$search_idprof4;\n+\t$params = \"&amp;socname=\".htmlspecialchars($socname).\"&amp;search_nom=\".htmlspecialchars($search_nom).\"&amp;search_town=\".htmlspecialchars($search_town);\n+\t$params.= ($sbarcode?\"&amp;sbarcode=\".htmlspecialchars($sbarcode):\"\");\n+\t$params.= '&amp;search_idprof1='.htmlspecialchars($search_idprof1);\n+\t$params.= '&amp;search_idprof2='.htmlspecialchars($search_idprof2);\n+\t$params.= '&amp;search_idprof3='.htmlspecialchars($search_idprof3);\n+\t$params.= '&amp;search_idprof4='.htmlspecialchars($search_idprof4);\n \n \tprint_barre_liste($title, $page, $_SERVER[\"PHP_SELF\"],$params,$sortfield,$sortorder,'',$num,$nbtotalofrecords);\n \n@@ -348,34 +348,34 @@\n \tprint '<input type=\"hidden\" name=\"sortfield\" value=\"'.$sortfield.'\">';\n \tprint '<input type=\"hidden\" name=\"sortorder\" value=\"'.$sortorder.'\">';\n \tif (! empty($search_nom_only) && empty($search_nom)) $search_nom=$search_nom_only;\n-\tprint '<input class=\"flat\" type=\"text\" name=\"search_nom\" value=\"'.$search_nom.'\">';\n+\tprint '<input class=\"flat\" type=\"text\" name=\"search_nom\" value=\"'.htmlspecialchars($search_nom).'\">';\n \tprint '</td>';\n \t// Barcode\n \tif (! empty($conf->barcode->enabled))\n \t{\n-    \tprint '<td class=\"liste_titre\">';\n-    \tprint '<input class=\"flat\" type=\"text\" name=\"sbarcode\" size=\"6\" value=\"'.$sbarcode.'\">';\n-    \tprint '</td>';\n+\t\tprint '<td class=\"liste_titre\">';\n+\t\tprint '<input class=\"flat\" type=\"text\" name=\"sbarcode\" size=\"6\" value=\"'.htmlspecialchars($sbarcode).'\">';\n+\t\tprint '</td>';\n     }\n \t// Town\n \tprint '<td class=\"liste_titre\">';\n-\tprint '<input class=\"flat\" size=\"10\" type=\"text\" name=\"search_town\" value=\"'.$search_town.'\">';\n+\tprint '<input class=\"flat\" size=\"10\" type=\"text\" name=\"search_town\" value=\"'.htmlspecialchars($search_town).'\">';\n \tprint '</td>';\n \t// IdProf1\n \tprint '<td class=\"liste_titre\">';\n-\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof1\" value=\"'.$search_idprof1.'\">';\n+\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof1\" value=\"'.htmlspecialchars($search_idprof1).'\">';\n \tprint '</td>';\n \t// IdProf2\n \tprint '<td class=\"liste_titre\">';\n-\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof2\" value=\"'.$search_idprof2.'\">';\n+\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof2\" value=\"'.htmlspecialchars($search_idprof2).'\">';\n \tprint '</td>';\n \t// IdProf3\n \tprint '<td class=\"liste_titre\">';\n-\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof3\" value=\"'.$search_idprof3.'\">';\n+\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof3\" value=\"'.htmlspecialchars($search_idprof3).'\">';\n \tprint '</td>';\n \t// IdProf4\n \tprint '<td class=\"liste_titre\">';\n-\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof4\" value=\"'.$search_idprof4.'\">';\n+\tprint '<input class=\"flat\" size=\"4\" type=\"text\" name=\"search_idprof4\" value=\"'.htmlspecialchars($search_idprof4).'\">';\n \tprint '</td>';\n \t// Type (customer/prospect/supplier)\n \tprint '<td class=\"liste_titre\" align=\"middle\">';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5c233a41b330e754d554297e5b2a5f06af7f55ad",
            "date": "2017-01-09T22:54:31Z",
            "author_login": "eldy"
          },
          {
            "sha": "93ab2246140261305dc8fa2f563413564750377a",
            "date": "2017-01-09T22:33:36Z",
            "author_login": "eldy"
          },
          {
            "sha": "c4ff1f983c10848e33d7182d8d198dfb9b74ffb5",
            "date": "2017-01-09T22:32:36Z",
            "author_login": "eldy"
          },
          {
            "sha": "decbda3e23e9dae793a12322ba48d3e4a9898c07",
            "date": "2017-01-09T22:26:31Z",
            "author_login": "eldy"
          },
          {
            "sha": "a9354e5f274809daff2077858a6b08788afcab59",
            "date": "2017-01-09T20:07:54Z",
            "author_login": "eldy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in Dolibarr ERP/CRM 3.5 and 3.6 allow remote attackers to inject arbitrary web script or HTML via the Business Search (search_nom) field to (1) htdocs/societe/societe.php or (2) htdocs/societe/admin/societe.php.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-06-10T14:59:00.090",
    "last_modified": "2024-11-21T02:30:06.243",
    "fix_date": "2015-05-20T15:32:34Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/132108/Dolibarr-3.5-3.6-HTML-Injection.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2015/May/126",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74926",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/issues/2857",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/GPCsolutions/dolibarr/commit/a7f6bbd316e9b96216e9b2c7a065c9251c9a8907",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/132108/Dolibarr-3.5-3.6-HTML-Injection.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2015/May/126",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/74926",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/issues/2857",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/GPCsolutions/dolibarr/commit/a7f6bbd316e9b96216e9b2c7a065c9251c9a8907",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:35.781328",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dolibarr",
    "owner": "GPCsolutions",
    "created_at": "2012-04-16T14:34:07Z",
    "updated_at": "2021-09-24T17:33:55Z",
    "pushed_at": "2018-05-23T09:38:00Z",
    "size": 460512,
    "stars": 2,
    "forks": 0,
    "open_issues": 14,
    "watchers": 2,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "PHP": 41347486,
      "JavaScript": 1649129,
      "CSS": 457914,
      "HTML": 342369,
      "SQLPL": 130859,
      "Perl": 108444,
      "Shell": 55339,
      "Inno Setup": 47985,
      "C": 22113,
      "PLpgSQL": 21093,
      "Makefile": 8320,
      "C++": 7952,
      "Batchfile": 1264,
      "ApacheConf": 751
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T20:17:43.727991"
  }
}