{
  "cve_id": "CVE-2015-5069",
  "github_data": {
    "repository": "wesnoth/wesnoth",
    "fix_commit": "f8914468182e8d0a1551b430c0879ba236fe4d6d",
    "related_commits": [
      "f8914468182e8d0a1551b430c0879ba236fe4d6d",
      "f8914468182e8d0a1551b430c0879ba236fe4d6d"
    ],
    "patch_url": "https://github.com/wesnoth/wesnoth/commit/f8914468182e8d0a1551b430c0879ba236fe4d6d.patch",
    "fix_commit_details": {
      "sha": "f8914468182e8d0a1551b430c0879ba236fe4d6d",
      "commit_date": "2015-06-09T09:12:09Z",
      "author": {
        "login": "irydacea",
        "type": "User",
        "stats": {
          "total_commits": 4055,
          "average_weekly_commits": 3.640035906642729,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 484
        }
      },
      "commit_message": {
        "title": "Disallow inclusion of .pbl files from WML (bug #23504)",
        "length": 141,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 11,
        "deletions": 0
      },
      "files": [
        {
          "filename": "changelog",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -65,6 +65,7 @@ Version 1.13.0+dev:\n    * Made silence.ogg larger to work around a crash involving the multiplayer\n      lobby with music and sound enabled (bug #23633, possibly also bug #23599,\n      bug #23203, bug #23026).\n+   * Disallowed inclusion of .pbl files from WML (bug #23504).\n \n Version 1.13.0:\n  * Security fixes:"
        },
        {
          "filename": "src/filesystem.cpp",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1008,6 +1008,11 @@ std::string get_wml_location(const std::string &filename, const std::string &cur\n \t\treturn result;\n \t}\n \n+\tif (ends_with(filename, \".pbl\")) {\n+\t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n+\t\treturn result;\n+\t}\n+\n \tbool already_found = false;\n \n \tif (filename[0] == '~')"
        },
        {
          "filename": "src/filesystem_boost.cpp",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1000,6 +1000,11 @@ static bool is_legal_file(const std::string &filename)\n \t\treturn false;\n \t}\n \n+\tif (ends_with(filename, \".pbl\")) {\n+\t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n+\t\treturn false;\n+\t}\n+\n \treturn true;\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f61b7b77ecf1a0228418564a96bf94e2f6898734",
            "date": "2025-01-14T15:35:46Z",
            "author_login": "Pentarctagon"
          },
          {
            "sha": "ad7a458250badbcdfb406a0b72bf98fa7f9ce3a3",
            "date": "2025-01-14T08:38:21Z",
            "author_login": "soliton-"
          },
          {
            "sha": "fbf43bcfc1f49b36d5518ce8e659bb50c5d2da02",
            "date": "2025-01-14T08:36:58Z",
            "author_login": "soliton-"
          },
          {
            "sha": "eac2730235e0d488df893103007965303d849685",
            "date": "2025-01-13T22:15:54Z",
            "author_login": "Wedge009"
          },
          {
            "sha": "707135afa4fdd96e2ff1cfcd469ebebf49ff41b1",
            "date": "2025-01-13T14:38:51Z",
            "author_login": "knyghtmare"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "The (1) filesystem::get_wml_location function in filesystem.cpp and (2) is_legal_file function in filesystem_boost.cpp in Battle for Wesnoth before 1.12.3 and 1.13.x before 1.13.1 allow remote attackers to obtain sensitive information via vectors related to inclusion of .pbl files from WML.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-26T14:29:00.250",
    "last_modified": "2024-11-21T02:32:15.950",
    "fix_date": "2015-06-09T09:12:09Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161722.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161752.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/06/25/12",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/75424",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1236010",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/commit/f8914468182e8d0a1551b430c0879ba236fe4d6d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.12.3",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.13.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gna.org/bugs/?23504",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161722.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161752.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/06/25/12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/75424",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1236010",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/commit/f8914468182e8d0a1551b430c0879ba236fe4d6d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.12.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.13.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gna.org/bugs/?23504",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.399856",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wesnoth",
    "owner": "wesnoth",
    "created_at": "2013-04-14T17:13:06Z",
    "updated_at": "2025-01-14T15:35:51Z",
    "pushed_at": "2025-01-14T15:35:46Z",
    "size": 4559646,
    "stars": 5684,
    "forks": 1035,
    "open_issues": 1373,
    "watchers": 5684,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.0",
      "1.2",
      "1.4",
      "1.6",
      "1.8",
      "1.10",
      "1.12",
      "1.14",
      "1.16",
      "1.18"
    ],
    "languages": {
      "C++": 10385681,
      "Lua": 1606910,
      "Python": 1243126,
      "Emacs Lisp": 296346,
      "CMake": 133214,
      "Shell": 100561,
      "Perl": 54498,
      "C": 47498,
      "Vim Script": 28840,
      "TypeScript": 25044,
      "Objective-C++": 11504,
      "NSIS": 8549,
      "PHP": 7658,
      "Makefile": 6342,
      "JavaScript": 5807,
      "sed": 4033,
      "HTML": 3619,
      "CSS": 3294,
      "Dockerfile": 1968,
      "Objective-C": 856,
      "Batchfile": 148
    },
    "commit_activity": {
      "total_commits_last_year": 1818,
      "avg_commits_per_week": 34.96153846153846,
      "days_active_last_year": 336
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:04:35.806153"
  }
}