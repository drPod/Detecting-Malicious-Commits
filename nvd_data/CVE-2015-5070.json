{
  "cve_id": "CVE-2015-5070",
  "github_data": {
    "repository": "wesnoth/wesnoth",
    "fix_commit": "b2738ffb2fdd2550ececb74f76f75583c43c8b59",
    "related_commits": [
      "b2738ffb2fdd2550ececb74f76f75583c43c8b59",
      "b2738ffb2fdd2550ececb74f76f75583c43c8b59"
    ],
    "patch_url": "https://github.com/wesnoth/wesnoth/commit/b2738ffb2fdd2550ececb74f76f75583c43c8b59.patch",
    "fix_commit_details": {
      "sha": "b2738ffb2fdd2550ececb74f76f75583c43c8b59",
      "commit_date": "2015-06-17T02:08:52Z",
      "author": {
        "login": "irydacea",
        "type": "User",
        "stats": {
          "total_commits": 4055,
          "average_weekly_commits": 3.640035906642729,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 484
        }
      },
      "commit_message": {
        "title": "Use looks_like_pbl() to disallow .pbl file inclusion (bug #23504)",
        "length": 371,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "changelog",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1,6 +1,7 @@\n Version 1.13.0+dev:\n  * Security fixes:\n-   * Disallowed inclusion of .pbl files from WML (bug #23504).\n+   * Disallowed inclusion of .pbl files from WML (bug #23504), independent of\n+     file name case.\n  * AI:\n    * Fast Micro AI: exclude hidden enemies from attack evaluation by default;\n      add optional key attack_hidden_enemies to override this"
        },
        {
          "filename": "players_changelog",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -4,7 +4,8 @@ changelog: https://github.com/wesnoth/wesnoth/blob/master/changelog\n \n Version 1.13.0+dev:\n  * Security fixes:\n-   * Disallowed inclusion of .pbl files from WML (bug #23504).\n+   * Disallowed inclusion of .pbl files from WML (bug #23504), independent of\n+     file name case.\n \n  * Campaigns:\n    * Dead Water:"
        },
        {
          "filename": "src/filesystem.cpp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1008,7 +1008,7 @@ std::string get_wml_location(const std::string &filename, const std::string &cur\n \t\treturn result;\n \t}\n \n-\tif (ends_with(filename, \".pbl\")) {\n+\tif (looks_like_pbl(filename)) {\n \t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n \t\treturn result;\n \t}"
        },
        {
          "filename": "src/filesystem_boost.cpp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1000,7 +1000,7 @@ static bool is_legal_file(const std::string &filename)\n \t\treturn false;\n \t}\n \n-\tif (ends_with(filename, \".pbl\")) {\n+\tif (looks_like_pbl(filename)) {\n \t\tERR_FS << \"Illegal path '\" << filename << \"' (.pbl files are not allowed).\" << std::endl;\n \t\treturn false;\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f61b7b77ecf1a0228418564a96bf94e2f6898734",
            "date": "2025-01-14T15:35:46Z",
            "author_login": "Pentarctagon"
          },
          {
            "sha": "ad7a458250badbcdfb406a0b72bf98fa7f9ce3a3",
            "date": "2025-01-14T08:38:21Z",
            "author_login": "soliton-"
          },
          {
            "sha": "fbf43bcfc1f49b36d5518ce8e659bb50c5d2da02",
            "date": "2025-01-14T08:36:58Z",
            "author_login": "soliton-"
          },
          {
            "sha": "eac2730235e0d488df893103007965303d849685",
            "date": "2025-01-13T22:15:54Z",
            "author_login": "Wedge009"
          },
          {
            "sha": "707135afa4fdd96e2ff1cfcd469ebebf49ff41b1",
            "date": "2025-01-13T14:38:51Z",
            "author_login": "knyghtmare"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "The (1) filesystem::get_wml_location function in filesystem.cpp and (2) is_legal_file function in filesystem_boost.cpp in Battle for Wesnoth before 1.12.4 and 1.13.x before 1.13.1, when a case-insensitive filesystem is used, allow remote attackers to obtain sensitive information via vectors related to inclusion of .pbl files from WML.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-5069.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-26T14:29:00.330",
    "last_modified": "2024-11-21T02:32:16.110",
    "fix_date": "2015-06-17T02:08:52Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161722.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161752.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/06/25/12",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/75425",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1236010",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/commit/b2738ffb2fdd2550ececb74f76f75583c43c8b59",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.12.4",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.13.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gna.org/bugs/?23504",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161722.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/161752.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/06/25/12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/75425",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1236010",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/commit/b2738ffb2fdd2550ececb74f76f75583c43c8b59",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.12.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wesnoth/wesnoth/releases/tag/1.13.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gna.org/bugs/?23504",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.400103",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wesnoth",
    "owner": "wesnoth",
    "created_at": "2013-04-14T17:13:06Z",
    "updated_at": "2025-01-14T15:35:51Z",
    "pushed_at": "2025-01-14T15:35:46Z",
    "size": 4559646,
    "stars": 5684,
    "forks": 1035,
    "open_issues": 1373,
    "watchers": 5684,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.0",
      "1.2",
      "1.4",
      "1.6",
      "1.8",
      "1.10",
      "1.12",
      "1.14",
      "1.16",
      "1.18"
    ],
    "languages": {
      "C++": 10385681,
      "Lua": 1606910,
      "Python": 1243126,
      "Emacs Lisp": 296346,
      "CMake": 133214,
      "Shell": 100561,
      "Perl": 54498,
      "C": 47498,
      "Vim Script": 28840,
      "TypeScript": 25044,
      "Objective-C++": 11504,
      "NSIS": 8549,
      "PHP": 7658,
      "Makefile": 6342,
      "JavaScript": 5807,
      "sed": 4033,
      "HTML": 3619,
      "CSS": 3294,
      "Dockerfile": 1968,
      "Objective-C": 856,
      "Batchfile": 148
    },
    "commit_activity": {
      "total_commits_last_year": 1818,
      "avg_commits_per_week": 34.96153846153846,
      "days_active_last_year": 336
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:04:35.806153"
  }
}