{
  "cve_id": "CVE-2015-5607",
  "github_data": {
    "repository": "ipython/ipython",
    "fix_commit": "1415a9710407e7c14900531813c15ba6165f0816",
    "related_commits": [
      "1415a9710407e7c14900531813c15ba6165f0816",
      "a05fe052a18810e92d9be8c1185952c13fe4e5b0",
      "1415a9710407e7c14900531813c15ba6165f0816",
      "a05fe052a18810e92d9be8c1185952c13fe4e5b0"
    ],
    "patch_url": "https://github.com/ipython/ipython/commit/1415a9710407e7c14900531813c15ba6165f0816.patch",
    "fix_commit_details": {
      "sha": "1415a9710407e7c14900531813c15ba6165f0816",
      "commit_date": "2015-07-08T07:11:16Z",
      "author": {
        "login": "minrk",
        "type": "User",
        "stats": {
          "total_commits": 5632,
          "average_weekly_commits": 6.378255945639864,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 359
        }
      },
      "commit_message": {
        "title": "check origin of API requests",
        "length": 79,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 49,
        "additions": 48,
        "deletions": 1
      },
      "files": [
        {
          "filename": "IPython/html/base/handlers.py",
          "status": "modified",
          "additions": 48,
          "deletions": 1,
          "patch": "@@ -5,7 +5,6 @@\n \n import functools\n import json\n-import logging\n import os\n import re\n import sys\n@@ -15,6 +14,10 @@\n     from http.client import responses\n except ImportError:\n     from httplib import responses\n+try:\n+    from urllib.parse import urlparse # Py 3\n+except ImportError:\n+    from urlparse import urlparse # Py 2\n \n from jinja2 import TemplateNotFound\n from tornado import web\n@@ -320,6 +323,50 @@ def write_error(self, status_code, **kwargs):\n class APIHandler(IPythonHandler):\n     \"\"\"Base class for API handlers\"\"\"\n     \n+    def check_origin(self):\n+        \"\"\"Check Origin for cross-site API requests.\n+        \n+        Copied from WebSocket with changes:\n+        \n+        - allow unspecified host/origin (e.g. scripts)\n+        \"\"\"\n+        if self.allow_origin == '*':\n+            return True\n+\n+        host = self.request.headers.get(\"Host\")\n+        origin = self.request.headers.get(\"Origin\")\n+\n+        # If no header is provided, assume it comes from a script/curl.\n+        # We are only concerned with cross-site browser stuff here.\n+        if origin is None or host is None:\n+            return True\n+        \n+        origin = origin.lower()\n+        origin_host = urlparse(origin).netloc\n+        \n+        # OK if origin matches host\n+        if origin_host == host:\n+            return True\n+        \n+        # Check CORS headers\n+        if self.allow_origin:\n+            allow = self.allow_origin == origin\n+        elif self.allow_origin_pat:\n+            allow = bool(self.allow_origin_pat.match(origin))\n+        else:\n+            # No CORS headers deny the request\n+            allow = False\n+        if not allow:\n+            self.log.warn(\"Blocking Cross Origin API request.  Origin: %s, Host: %s\",\n+                origin, host,\n+            )\n+        return allow\n+\n+    def prepare(self):\n+        if not self.check_origin():\n+            raise web.HTTPError(404)\n+        return super(APIHandler, self).prepare()\n+\n     @property\n     def content_security_policy(self):\n         csp = '; '.join(["
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5e59ea92ba81245815b9f3323b0a26c4ff9a24ac",
            "date": "2025-01-14T15:34:52Z",
            "author_login": "Carreau"
          },
          {
            "sha": "a5803b0f886057a64771f0e758a30a36deb49c91",
            "date": "2025-01-14T13:39:46Z",
            "author_login": "Carreau"
          },
          {
            "sha": "a89d00bb63ec3b5d116292c856a344fe0fb0af0d",
            "date": "2025-01-14T08:23:57Z",
            "author_login": "Carreau"
          },
          {
            "sha": "82e21335f46651939aafe5ee3bea11207eb618b8",
            "date": "2025-01-13T17:30:42Z",
            "author_login": "Carreau"
          },
          {
            "sha": "364e544a76c590ff161d9fffacf35533db478324",
            "date": "2025-01-11T20:58:33Z",
            "author_login": "Carreau"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "Cross-site request forgery in the REST API in IPython 2 and 3.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-20T16:29:00.753",
    "last_modified": "2024-11-21T02:33:23.240",
    "fix_date": "2015-07-08T07:11:16Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162671.html",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162936.html",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/07/21/3",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1243842",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/commit/1415a9710407e7c14900531813c15ba6165f0816",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/commit/a05fe052a18810e92d9be8c1185952c13fe4e5b0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162671.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162936.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/07/21/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1243842",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/commit/1415a9710407e7c14900531813c15ba6165f0816",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/commit/a05fe052a18810e92d9be8c1185952c13fe4e5b0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.387956",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ipython",
    "owner": "ipython",
    "created_at": "2010-05-10T04:46:06Z",
    "updated_at": "2025-01-14T15:35:00Z",
    "pushed_at": "2025-01-14T15:34:52Z",
    "size": 79173,
    "stars": 16342,
    "forks": 4448,
    "open_issues": 1561,
    "watchers": 16342,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "7.x",
      "main"
    ],
    "languages": {
      "Python": 2467835,
      "Shell": 11771,
      "Makefile": 4675,
      "Batchfile": 425
    },
    "commit_activity": {
      "total_commits_last_year": 447,
      "avg_commits_per_week": 8.596153846153847,
      "days_active_last_year": 136
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:58:28.288375"
  }
}