{
  "cve_id": "CVE-2015-5659",
  "github_data": {
    "repository": "NaCl-Ltd/pref-shimane-cms",
    "fix_commit": "5ec03cb174513844c410ee7fba594c544ba80ce2",
    "related_commits": [
      "5ec03cb174513844c410ee7fba594c544ba80ce2",
      "ab96ec7661f15a0129940eed9215c91f1acbf564",
      "5ec03cb174513844c410ee7fba594c544ba80ce2",
      "ab96ec7661f15a0129940eed9215c91f1acbf564"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5ec03cb174513844c410ee7fba594c544ba80ce2",
      "commit_date": "2015-10-07T04:13:11Z",
      "author": {
        "login": "nacl-anno",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306b\u3088\u308a\u3001\u60c5\u5831\u3092\u4e0d\u6b63\u53d6\u5f97\u3067\u304d\u3066\u3057\u307e\u3046\u4e0d\u5177\u5408\u3092\u4fee\u6b63",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 50,
        "additions": 48,
        "deletions": 2
      },
      "files": [
        {
          "filename": "pref-shimane-cms/CHANGELOG.md",
          "status": "added",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -0,0 +1,11 @@\n+# Changelog\n+\n+## Version 2.0.1 (2015/10/7)\n+\n+* Bugfix\n+\n+  * SQL\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u306b\u3088\u308a\u3001\u60c5\u5831\u3092\u4e0d\u6b63\u53d6\u5f97\u3067\u304d\u3066\u3057\u307e\u3046\u4e0d\u5177\u5408\u3092\u4fee\u6b63\n+\n+## Version 2.0.0 (2014/9/6)\n+\n+* \u521d\u671f\u30ea\u30ea\u30fc\u30b9\n\\ No newline at end of file"
        },
        {
          "filename": "pref-shimane-cms/app/controllers/concerns/susanoo/pages_controller.rb",
          "status": "modified",
          "additions": 36,
          "deletions": 1,
          "patch": "@@ -254,7 +254,6 @@ def initialize(attr = {})\n           super\n         end\n \n-\n         #\n         #=== \u691c\u7d22\u3092\u5b9f\u65bd\u3059\u308b\n         #\n@@ -278,7 +277,43 @@ def last_modified_sortable?\n             false\n           end\n         end\n+\n+        #\n+        #=== \u30bd\u30fc\u30c8\u9806\u3092\u8fd4\u3059\n+        #\n+        def order_by\n+          order_option = ''\n+          if valid_order_params?\n+            direction = self.order_direction || 'ASC'\n+            order_option = \"#{self.order_column} #{direction}\"\n+          end\n+          order_option.present? ? order_option : @@default_order\n+        end\n+\n+        #\n+        #=== \u30bd\u30fc\u30c8\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u691c\u8a3c\u3059\u308b\n+        #\n+        def valid_order_params?\n+          if self.order_column.blank?\n+            return false\n+          end\n+\n+          permit_column_params = ['pages.name', 'page_contents.last_modified']\n+          permit_dir_params = ['ASC', 'DESC']\n+\n+          unless permit_column_params.include?(self.order_column)\n+            return false\n+          end\n+\n+          if self.order_direction.present? &&\n+            !permit_dir_params.include?(self.order_direction.upcase)\n+            return false\n+          end\n+\n+          return true\n+        end\n       end\n+\n   end\n end\n "
        },
        {
          "filename": "pref-shimane-cms/config/initializers/version.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n module PrefShimaneCms\n   class Application\n-    VERSION = '2.0.0'\n+    VERSION = '2.0.1'\n   end\n end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "cab2d4fa309660b8c63197041f0e3c91434f73da",
            "date": "2017-02-08T09:41:36Z",
            "author_login": "nacl-anno"
          },
          {
            "sha": "4c28b3056219ebb000e6f12611404508df190623",
            "date": "2017-01-13T08:37:08Z",
            "author_login": "nacl-anno"
          },
          {
            "sha": "71452d5f290dfaf6c6dedb0633aeed4cccf25c91",
            "date": "2017-01-13T07:38:51Z",
            "author_login": "nacl-anno"
          },
          {
            "sha": "465a20a1a35955693da43ee2a0d33ca880291a92",
            "date": "2017-01-13T06:34:42Z",
            "author_login": "nacl-anno"
          },
          {
            "sha": "3f454b6b14c14bb18ed7107d46a077908d60b410",
            "date": "2016-04-27T01:57:47Z",
            "author_login": "nacl-anno"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-89",
    "description": "SQL injection vulnerability in Network Applied Communication Laboratory Pref Shimane CMS 2.x before 2.0.1 allows remote authenticated users to execute arbitrary SQL commands via unspecified vectors.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-10-11T01:59:04.863",
    "last_modified": "2024-11-21T02:33:33.940",
    "fix_date": "2015-10-07T04:13:11Z"
  },
  "references": [
    {
      "url": "http://jvn.jp/en/jp/JVN84982142/995760/index.html",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "http://jvn.jp/en/jp/JVN84982142/index.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://jvndb.jvn.jp/jvndb/JVNDB-2015-000158",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/NaCl-Ltd/pref-shimane-cms/blob/master/README.md",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "https://github.com/NaCl-Ltd/pref-shimane-cms/commit/5ec03cb174513844c410ee7fba594c544ba80ce2",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "https://github.com/NaCl-Ltd/pref-shimane-cms/commit/ab96ec7661f15a0129940eed9215c91f1acbf564",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "http://jvn.jp/en/jp/JVN84982142/995760/index.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://jvn.jp/en/jp/JVN84982142/index.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://jvndb.jvn.jp/jvndb/JVNDB-2015-000158",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/NaCl-Ltd/pref-shimane-cms/blob/master/README.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/NaCl-Ltd/pref-shimane-cms/commit/5ec03cb174513844c410ee7fba594c544ba80ce2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/NaCl-Ltd/pref-shimane-cms/commit/ab96ec7661f15a0129940eed9215c91f1acbf564",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:37.903071",
    "processing_status": "enhanced"
  }
}