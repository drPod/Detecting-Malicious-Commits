{
  "cve_id": "CVE-2015-5688",
  "github_data": {
    "repository": "geddy/geddy",
    "fix_commit": "2de63b68b3aa6c08848f261ace550a37959ef231",
    "related_commits": [
      "2de63b68b3aa6c08848f261ace550a37959ef231",
      "2de63b68b3aa6c08848f261ace550a37959ef231"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2de63b68b3aa6c08848f261ace550a37959ef231",
      "commit_date": "2015-07-27T19:17:52Z",
      "author": {
        "login": "phanect",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #699 from phanect/v13-security",
        "length": 94,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 12,
        "deletions": 3
      },
      "files": [
        {
          "filename": ".travis.yml",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -1,6 +1,8 @@\n language: node_js\n node_js:\n+  - \"0.12\"\n   - \"0.10\"\n+  - \"iojs\"\n \n before_install:\n   - npm update -g npm"
        },
        {
          "filename": "lib/app/index.js",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -176,7 +176,14 @@ var App = function () {\n \n \n     // Get the path to the file, decoding the request URI\n-    staticPath = this.config.staticFilePath + decodeURIComponent(reqUrl);\n+    staticPath = path.resolve(path.join(this.config.staticFilePath, decodeURIComponent(reqUrl)));\n+\n+    // Prevent directory traversal\n+    if (staticPath.indexOf(this.config.staticFilePath) !== 0) {\n+      this.handleNotFound(reqUrl, params, reqObj, respObj);\n+      return;\n+    }\n+\n     // Ignore querystring\n     staticPath = staticPath.split('?')[0];\n "
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -8,7 +8,7 @@\n     \"MVC\",\n     \"realtime\"\n   ],\n-  \"version\": \"13.0.7\",\n+  \"version\": \"13.0.8\",\n   \"author\": \"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)\",\n   \"dependencies\": {\n     \"barista\": \"0.2.x\",\n@@ -43,4 +43,4 @@\n   \"engines\": {\n     \"node\": \"*\"\n   }\n-}\n\\ No newline at end of file\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b967bcfd2763384404374da0e4487a81d42be830",
            "date": "2020-09-24T04:41:25Z",
            "author_login": "ckhatton"
          },
          {
            "sha": "2e48e358581d3345ceec6c97ce8ea7cb0e306376",
            "date": "2020-09-24T04:41:06Z",
            "author_login": "ckhatton"
          },
          {
            "sha": "6ec6cbbdd48297bec8dd7f3d966be5c9658bf614",
            "date": "2020-09-24T03:15:21Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "9b893c95ec28e33f7c81dc05ad135da450b5172a",
            "date": "2020-09-24T03:15:05Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "4ad17889ccbfc6b55827f2d3cc5fc57bb241a602",
            "date": "2020-09-24T03:02:06Z",
            "author_login": "ckhatton"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "Directory traversal vulnerability in lib/app/index.js in Geddy before 13.0.8 for Node.js allows remote attackers to read arbitrary files via a ..%2f (dot dot encoded slash) in the PATH_INFO to the default URI.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-09-04T15:59:02.680",
    "last_modified": "2024-11-21T02:33:38.687",
    "fix_date": "2015-07-27T19:17:52Z"
  },
  "references": [
    {
      "url": "https://github.com/geddy/geddy/commit/2de63b68b3aa6c08848f261ace550a37959ef231",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/geddy/geddy/issues/697",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/geddy/geddy/pull/699",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/geddy/geddy/releases/tag/v13.0.8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://nodesecurity.io/advisories/geddy-directory-traversal",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/geddy/geddy/commit/2de63b68b3aa6c08848f261ace550a37959ef231",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/geddy/geddy/issues/697",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/geddy/geddy/pull/699",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/geddy/geddy/releases/tag/v13.0.8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://nodesecurity.io/advisories/geddy-directory-traversal",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:37.897192",
    "processing_status": "enhanced"
  }
}