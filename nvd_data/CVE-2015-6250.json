{
  "cve_id": "CVE-2015-6250",
  "github_data": {
    "repository": "claviska/simple-php-captcha",
    "fix_commit": "9d65a945029c7be7bb6bc893759e74c5636be694",
    "related_commits": [
      "9d65a945029c7be7bb6bc893759e74c5636be694",
      "9d65a945029c7be7bb6bc893759e74c5636be694"
    ],
    "patch_url": "https://github.com/claviska/simple-php-captcha/commit/9d65a945029c7be7bb6bc893759e74c5636be694.patch",
    "fix_commit_details": {
      "sha": "9d65a945029c7be7bb6bc893759e74c5636be694",
      "commit_date": "2015-08-31T22:05:22Z",
      "author": {
        "login": "claviska",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #17 from ALSchwalm/master",
        "length": 73,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 13,
        "deletions": 8
      },
      "files": [
        {
          "filename": "simple-php-captcha.php",
          "status": "modified",
          "additions": 13,
          "deletions": 8,
          "patch": "@@ -62,9 +62,9 @@ function simple_php_captcha($config = array()) {\n     // Generate CAPTCHA code if not set by user\r\n     if( empty($captcha_config['code']) ) {\r\n         $captcha_config['code'] = '';\r\n-        $length = rand($captcha_config['min_length'], $captcha_config['max_length']);\r\n+        $length = mt_rand($captcha_config['min_length'], $captcha_config['max_length']);\r\n         while( strlen($captcha_config['code']) < $length ) {\r\n-            $captcha_config['code'] .= substr($captcha_config['characters'], rand() % (strlen($captcha_config['characters'])), 1);\r\n+            $captcha_config['code'] .= substr($captcha_config['characters'], mt_rand() % (strlen($captcha_config['characters'])), 1);\r\n         }\r\n     }\r\n \r\n@@ -119,7 +119,7 @@ function hex2rgb($hex_str, $return_string = false, $separator = ',') {\n     unset($_SESSION['_CAPTCHA']);\r\n \r\n     // Pick random background, get info, and start captcha\r\n-    $background = $captcha_config['backgrounds'][rand(0, count($captcha_config['backgrounds']) -1)];\r\n+    $background = $captcha_config['backgrounds'][mt_rand(0, count($captcha_config['backgrounds']) -1)];\r\n     list($bg_width, $bg_height, $bg_type, $bg_attr) = getimagesize($background);\r\n \r\n     $captcha = imagecreatefrompng($background);\r\n@@ -128,27 +128,32 @@ function hex2rgb($hex_str, $return_string = false, $separator = ',') {\n     $color = imagecolorallocate($captcha, $color['r'], $color['g'], $color['b']);\r\n \r\n     // Determine text angle\r\n-    $angle = rand( $captcha_config['angle_min'], $captcha_config['angle_max'] ) * (rand(0, 1) == 1 ? -1 : 1);\r\n+    $angle = mt_rand( $captcha_config['angle_min'], $captcha_config['angle_max'] ) * (mt_rand(0, 1) == 1 ? -1 : 1);\r\n \r\n     // Select font randomly\r\n-    $font = $captcha_config['fonts'][rand(0, count($captcha_config['fonts']) - 1)];\r\n+    $font = $captcha_config['fonts'][mt_rand(0, count($captcha_config['fonts']) - 1)];\r\n \r\n     // Verify font file exists\r\n     if( !file_exists($font) ) throw new Exception('Font file not found: ' . $font);\r\n \r\n     //Set the font size.\r\n-    $font_size = rand($captcha_config['min_font_size'], $captcha_config['max_font_size']);\r\n+    $font_size = mt_rand($captcha_config['min_font_size'], $captcha_config['max_font_size']);\r\n     $text_box_size = imagettfbbox($font_size, $angle, $font, $captcha_config['code']);\r\n \r\n     // Determine text position\r\n     $box_width = abs($text_box_size[6] - $text_box_size[2]);\r\n     $box_height = abs($text_box_size[5] - $text_box_size[1]);\r\n     $text_pos_x_min = 0;\r\n     $text_pos_x_max = ($bg_width) - ($box_width);\r\n-    $text_pos_x = rand($text_pos_x_min, $text_pos_x_max);\r\n+    $text_pos_x = mt_rand($text_pos_x_min, $text_pos_x_max);\r\n     $text_pos_y_min = $box_height;\r\n     $text_pos_y_max = ($bg_height) - ($box_height / 2);\r\n-    $text_pos_y = rand($text_pos_y_min, $text_pos_y_max);\r\n+    if ($text_pos_y_min > $text_pos_y_max) {\r\n+        $temp_text_pos_y = $text_pos_y_min;\r\n+        $text_pos_y_min = $text_pos_y_max;\r\n+        $text_pos_y_max = $temp_text_pos_y;\r\n+    }\r\n+    $text_pos_y = mt_rand($text_pos_y_min, $text_pos_y_max);\r\n \r\n     // Draw shadow\r\n     if( $captcha_config['shadow'] ){\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "338880b4a5e3a6aa23d42e87b1e7243ba9542b8c",
            "date": "2017-10-31T16:53:11Z",
            "author_login": "yasirmturk"
          },
          {
            "sha": "0a8289d694d8c4451f2f741c16a789f13bef9d54",
            "date": "2017-10-30T08:12:04Z",
            "author_login": "yasirmturk"
          },
          {
            "sha": "673e5e98487699a4be6a1640dde63321ebe7e490",
            "date": "2017-06-27T14:09:32Z",
            "author_login": "claviska"
          },
          {
            "sha": "74b29d2380dbb028e49ed35d0285e92355e791e0",
            "date": "2017-02-22T19:10:04Z",
            "author_login": "claviska"
          },
          {
            "sha": "a1b024c9adc40df5030c0cefcd947c24f258ee58",
            "date": "2017-02-22T19:09:59Z",
            "author_login": "claviska"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "simple-php-captcha before commit 9d65a945029c7be7bb6bc893759e74c5636be694 allows remote attackers to automatically generate the captcha response by running the same code on the client-side.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-06T21:29:00.910",
    "last_modified": "2024-11-21T02:34:38.477",
    "fix_date": "2015-08-31T22:05:22Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/08/17/7",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/claviska/simple-php-captcha/commit/9d65a945029c7be7bb6bc893759e74c5636be694",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/claviska/simple-php-captcha/issues/16",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/08/17/7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/claviska/simple-php-captcha/commit/9d65a945029c7be7bb6bc893759e74c5636be694",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/claviska/simple-php-captcha/issues/16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.344418",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "simple-php-captcha",
    "owner": "claviska",
    "created_at": "2011-11-15T23:46:23Z",
    "updated_at": "2024-11-23T23:05:17Z",
    "pushed_at": "2017-10-31T16:53:15Z",
    "size": 460,
    "stars": 373,
    "forks": 211,
    "open_issues": 4,
    "watchers": 373,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 10320
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:12:22.043098"
  }
}