{
  "cve_id": "CVE-2015-6830",
  "github_data": {
    "repository": "phpmyadmin/phpmyadmin",
    "fix_commit": "785f4e2711848eb8945894199d5870253a88584e",
    "related_commits": [
      "785f4e2711848eb8945894199d5870253a88584e",
      "785f4e2711848eb8945894199d5870253a88584e"
    ],
    "patch_url": "https://github.com/phpmyadmin/phpmyadmin/commit/785f4e2711848eb8945894199d5870253a88584e.patch",
    "fix_commit_details": {
      "sha": "785f4e2711848eb8945894199d5870253a88584e",
      "commit_date": "2015-09-07T11:23:14Z",
      "author": {
        "login": "madhuracj",
        "type": "User",
        "stats": {
          "total_commits": 6377,
          "average_weekly_commits": 5.367845117845118,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 259
        }
      },
      "commit_message": {
        "title": "Fix reCaptcha bypass",
        "length": 77,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 51,
        "additions": 15,
        "deletions": 36
      },
      "files": [
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1,6 +1,9 @@\n phpMyAdmin - ChangeLog\n ======================\n \n+4.4.14.1 (Not yet released)\n+- issue        [security] reCaptcha bypass\n+\n 4.4.14.0 (2015-08-20)\n - issue #11367 Export after search, missing WHERE clause\n - issue #11380 Incomplete message after import"
        },
        {
          "filename": "libraries/plugins/auth/AuthenticationCookie.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 29,
          "patch": "@@ -223,18 +223,9 @@ public function auth()\n                 . $GLOBALS['server'] . '\" />';\n         } // end if (server choice)\n \n-        // We already have one correct captcha.\n-        $skip = false;\n-        if (  isset($_SESSION['last_valid_captcha'])\n-            && $_SESSION['last_valid_captcha']\n-        ) {\n-            $skip = true;\n-        }\n-\n         // Add captcha input field if reCaptcha is enabled\n         if (  !empty($GLOBALS['cfg']['CaptchaLoginPrivateKey'])\n             && !empty($GLOBALS['cfg']['CaptchaLoginPublicKey'])\n-            && !$skip\n         ) {\n             // If enabled show captcha to the user on the login screen.\n             echo '<script src=\"https://www.google.com/recaptcha/api.js?hl='\n@@ -336,8 +327,6 @@ public function authCheck()\n \n             if (! defined('TESTSUITE')) {\n                 session_destroy();\n-                // $_SESSION array is not immediately emptied\n-                $_SESSION['last_valid_captcha'] = false;\n             }\n             // -> delete password cookie(s)\n             if ($GLOBALS['cfg']['LoginCookieDeleteAll']) {\n@@ -359,18 +348,9 @@ public function authCheck()\n \n         if (! empty($_REQUEST['pma_username'])) {\n \n-            // We already have one correct captcha.\n-            $skip = false;\n-            if (isset($_SESSION['last_valid_captcha'])\n-                && $_SESSION['last_valid_captcha']\n-            ) {\n-                $skip = true;\n-            }\n-\n             // Verify Captcha if it is required.\n             if (! empty($GLOBALS['cfg']['CaptchaLoginPrivateKey'])\n                 && ! empty($GLOBALS['cfg']['CaptchaLoginPublicKey'])\n-                && ! $skip\n             ) {\n                 if (! empty($_POST[\"g-recaptcha-response\"])) {\n \n@@ -388,18 +368,11 @@ public function authCheck()\n                     // Check if the captcha entered is valid, if not stop the login.\n                     if ($resp == null || ! $resp->isSuccess()) {\n                         $conn_error = __('Entered captcha is wrong, try again!');\n-                        $_SESSION['last_valid_captcha'] = false;\n                         return false;\n-                    } else {\n-                        $_SESSION['last_valid_captcha'] = true;\n                     }\n                 } else {\n-                    if (! isset($_SESSION['last_valid_captcha'])\n-                        || ! $_SESSION['last_valid_captcha']\n-                    ) {\n-                        $conn_error = __('Please enter correct captcha!');\n-                        return false;\n-                    }\n+                    $conn_error = __('Please enter correct captcha!');\n+                    return false;\n                 }\n             }\n "
        },
        {
          "filename": "test/classes/plugin/auth/PMA_AuthenticationCookie_test.php",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -186,7 +186,8 @@ public function testAuth()\n         $GLOBALS['cfg']['Lang'] = 'en';\n         $GLOBALS['cfg']['AllowArbitraryServer'] = true;\n         $GLOBALS['cfg']['Servers'] = array(1, 2);\n-        $_SESSION['last_valid_captcha'] = true;\n+        $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = '';\n+        $GLOBALS['cfg']['CaptchaLoginPublicKey'] = '';\n         $GLOBALS['target'] = 'testTarget';\n         $GLOBALS['db'] = 'testDb';\n         $GLOBALS['table'] = 'testTable';\n@@ -308,7 +309,6 @@ public function testAuth()\n         $GLOBALS['cfg']['Lang'] = '';\n         $GLOBALS['cfg']['AllowArbitraryServer'] = false;\n         $GLOBALS['cfg']['Servers'] = array(1);\n-        $_SESSION['last_valid_captcha'] = false;\n         $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = 'testprivkey';\n         $GLOBALS['cfg']['CaptchaLoginPublicKey'] = 'testpubkey';\n         $GLOBALS['server'] = 0;\n@@ -431,7 +431,6 @@ public function testAuthCheck()\n \n         // case 2\n \n-        $_SESSION['last_valid_captcha'] = false;\n         $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = 'testprivkey';\n         $GLOBALS['cfg']['CaptchaLoginPublicKey'] = 'testpubkey';\n         $_POST[\"g-recaptcha-response\"] = '';\n@@ -481,7 +480,8 @@ public function testAuthCheck()\n \n         // case 6\n \n-        $_SESSION['last_valid_captcha'] = true;\n+        $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = '';\n+        $GLOBALS['cfg']['CaptchaLoginPublicKey'] = '';\n         $_REQUEST['old_usr'] = '';\n         $_REQUEST['pma_username'] = 'testPMAUser';\n         $_REQUEST['pma_servername'] = 'testPMAServer';\n@@ -611,7 +611,8 @@ public function testAuthCheckDecryptUser()\n         $_COOKIE['pma_iv-1'] = base64_encode('testiv09testiv09');\n         $GLOBALS['cfg']['blowfish_secret'] = 'secret';\n         $_SESSION['last_access_time'] = '';\n-        $_SESSION['last_valid_captcha'] = true;\n+        $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = '';\n+        $GLOBALS['cfg']['CaptchaLoginPublicKey'] = '';\n \n         // mock for blowfish function\n         $this->object = $this->getMockBuilder('AuthenticationCookie')\n@@ -649,7 +650,8 @@ public function testAuthCheckDecryptPassword()\n         $_COOKIE['pmaPass-1'] = 'pmaPass1';\n         $_COOKIE['pma_iv-1'] = base64_encode('testiv09testiv09');\n         $GLOBALS['cfg']['blowfish_secret'] = 'secret';\n-        $_SESSION['last_valid_captcha'] = true;\n+        $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = '';\n+        $GLOBALS['cfg']['CaptchaLoginPublicKey'] = '';\n         $_SESSION['last_access_time'] = time() - 1000;\n         $GLOBALS['cfg']['LoginCookieValidity'] = 1440;\n \n@@ -694,7 +696,8 @@ public function testAuthCheckAuthFails()\n         $_COOKIE['pma_iv-1'] = base64_encode('testiv09testiv09');\n         $GLOBALS['cfg']['blowfish_secret'] = 'secret';\n         $_SESSION['last_access_time'] = 1;\n-        $_SESSION['last_valid_captcha'] = true;\n+        $GLOBALS['cfg']['CaptchaLoginPrivateKey'] = '';\n+        $GLOBALS['cfg']['CaptchaLoginPublicKey'] = '';\n         $GLOBALS['cfg']['LoginCookieValidity'] = 0;\n         $_SESSION['last_access_time'] = -1;\n         // mock for blowfish function"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "98b0d33571357c58c1bafde633ebfeb6acff1d71",
            "date": "2025-01-14T19:47:39Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "3a619b6824b6b2ba1905086511226c669d50caae",
            "date": "2025-01-14T05:24:18Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "e7c11147a3d7d4f39a21216347ffb97e9a5cda9c",
            "date": "2025-01-14T17:40:54Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "00d882935f808ad0d6a30da1d6102503bcf6637e",
            "date": "2025-01-14T17:39:14Z",
            "author_login": "MauricioFauth"
          },
          {
            "sha": "f1cf1634e792a0c8a6df3133e32e47f33ea0e18f",
            "date": "2025-01-14T00:07:27Z",
            "author_login": "MauricioFauth"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "libraries/plugins/auth/AuthenticationCookie.class.php in phpMyAdmin 4.3.x before 4.3.13.2 and 4.4.x before 4.4.14.1 allows remote attackers to bypass a multiple-reCaptcha protection mechanism against brute-force credential guessing by providing a correct response to a single reCaptcha.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2015-09-14T01:59:08.903",
    "last_modified": "2024-11-21T02:35:44.450",
    "fix_date": "2015-09-07T11:23:14Z"
  },
  "references": [
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-September/166294.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-September/166307.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-September/166531.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3382",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/76674",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1033546",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/785f4e2711848eb8945894199d5870253a88584e",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.phpmyadmin.net/security/PMASA-2015-4/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-September/166294.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-September/166307.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-September/166531.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2015/dsa-3382",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/76674",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1033546",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/phpmyadmin/phpmyadmin/commit/785f4e2711848eb8945894199d5870253a88584e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.phpmyadmin.net/security/PMASA-2015-4/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:37.898728",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "phpmyadmin",
    "owner": "phpmyadmin",
    "created_at": "2012-01-19T13:21:52Z",
    "updated_at": "2025-01-13T23:05:28Z",
    "pushed_at": "2025-01-13T22:05:32Z",
    "size": 2082161,
    "stars": 7343,
    "forks": 3442,
    "open_issues": 855,
    "watchers": 7343,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "QA_4_7",
      "QA_4_8",
      "QA_5_0",
      "master"
    ],
    "languages": {
      "PHP": 8222311,
      "TypeScript": 1345556,
      "Twig": 804427,
      "SCSS": 312156,
      "Shell": 52309,
      "JavaScript": 16982,
      "Hack": 588
    },
    "commit_activity": {
      "total_commits_last_year": 1510,
      "avg_commits_per_week": 29.03846153846154,
      "days_active_last_year": 306
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:04:35.166546"
  }
}