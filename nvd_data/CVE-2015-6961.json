{
  "cve_id": "CVE-2015-6961",
  "github_data": {
    "repository": "web2py/web2py",
    "fix_commit": "e31a099cb3456fef471886339653430ae59056b0",
    "related_commits": [
      "e31a099cb3456fef471886339653430ae59056b0",
      "e31a099cb3456fef471886339653430ae59056b0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e31a099cb3456fef471886339653430ae59056b0",
      "commit_date": "2015-07-02T11:40:12Z",
      "author": {
        "login": "mdipierro",
        "type": "User",
        "stats": {
          "total_commits": 4659,
          "average_weekly_commits": 6.761973875181423,
          "total_additions": 583084,
          "total_deletions": 323034,
          "weeks_active": 312
        }
      },
      "commit_message": {
        "title": "Merge pull request #1012 from ortgit/master",
        "length": 117,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
      },
      "files": [
        {
          "filename": ".gitignore",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -58,3 +58,4 @@ HOWTO-web2py-devel\n *.sublime-project\n *.sublime-workspace\n .idea/*\n+site-packages/"
        },
        {
          "filename": "gluon/tools.py",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -1541,6 +1541,12 @@ def get_vars_next(self):\n         next = current.request.vars._next\n         if isinstance(next, (list, tuple)):\n             next = next[0]\n+        if next and self.settings.prevent_open_redirect_attacks:\n+            # Prevent an attacker from adding an arbitrary url after the\n+            # _next variable in the request.\n+            items = next.split('/')\n+            if '//' in next and items[2] != current.request.env.http_host:\n+                next = None            \n         return next\n \n     def _get_user_id(self):\n@@ -2513,10 +2519,6 @@ def login(self,\n \n         ### use session for federated login\n         snext = self.get_vars_next()\n-        if snext and self.settings.prevent_open_redirect_attacks:\n-            items = snext.split('/')\n-            if '//' in snext and items[2] != request.env.http_host:\n-                snext = None\n \n         if snext:\n             session._auth_next = snext"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ae108f27604809f17a4d4a7214e9eb130608c872",
            "date": "2024-12-28T22:25:14Z",
            "author_login": "mdipierro"
          },
          {
            "sha": "a381175a33043b0fd52ca17f535e3f1f0fd418b8",
            "date": "2024-12-28T22:23:51Z",
            "author_login": "mdipierro"
          },
          {
            "sha": "91767d2e82e4e4f704f4ac9d361942336e14d71d",
            "date": "2024-12-28T22:16:06Z",
            "author_login": "mdipierro"
          },
          {
            "sha": "51e226166b38044973c254008b8d919cbd9754d4",
            "date": "2024-12-28T18:10:54Z",
            "author_login": "nicozanf"
          },
          {
            "sha": "51028cbee49610511db87a727516849112e5aa78",
            "date": "2024-12-26T22:27:15Z",
            "author_login": "nicozanf"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-601",
    "description": "Open redirect vulnerability in gluon/tools.py in Web2py 2.9.11 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via a URL in the _next parameter to user/logout.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-10-18T20:29:00.387",
    "last_modified": "2024-11-21T02:35:56.740",
    "fix_date": "2015-07-02T11:40:12Z"
  },
  "references": [
    {
      "url": "https://github.com/web2py/web2py/commit/e31a099cb3456fef471886339653430ae59056b0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/web2py/web2py/issues/731",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/web2py/web2py/commit/e31a099cb3456fef471886339653430ae59056b0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/web2py/web2py/issues/731",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.704277",
    "processing_status": "enhanced"
  }
}