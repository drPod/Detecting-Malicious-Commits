{
  "cve_id": "CVE-2015-7316",
  "github_data": {
    "repository": "plone/Products.CMFPlone",
    "fix_commit": "3da710a2cd68587f0bf34f2e7ea1167d6eeee087",
    "related_commits": [
      "3da710a2cd68587f0bf34f2e7ea1167d6eeee087",
      "3da710a2cd68587f0bf34f2e7ea1167d6eeee087"
    ],
    "patch_url": "https://github.com/plone/Products.CMFPlone/commit/3da710a2cd68587f0bf34f2e7ea1167d6eeee087.patch",
    "fix_commit_details": {
      "sha": "3da710a2cd68587f0bf34f2e7ea1167d6eeee087",
      "commit_date": "2015-09-10T17:57:08Z",
      "author": {
        "login": "vangheem",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #914 from plone/isURLInPortal-hotfix",
        "length": 143,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
      },
      "files": [
        {
          "filename": "CHANGES.rst",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -8,6 +8,9 @@ Changelog\n 5.0rc2 (unreleased)\n -------------------\n \n+- Apply isURLInPortal fix from https://pypi.python.org/pypi/Products.PloneHotfix20150910\n+  [vangheem]\n+\n - Do not bother additional CRSF protection for addMember since all public\n   users get same CSRF token and the method should be unpublished.\n   See https://pypi.python.org/pypi/Products.PloneHotfix20150910"
        },
        {
          "filename": "Products/CMFPlone/URLTool.py",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -30,6 +30,9 @@ def isURLInPortal(self, url, context=None):\n         \"\"\"\n         # sanitize url\n         url = re.sub('^[\\x00-\\x20]+', '', url).strip()\n+        if ('<script' in url or '%3Cscript' in url or 'javascript:' in url or\n+                'javascript%3A' in url):\n+            return False\n \n         p_url = self()\n "
        },
        {
          "filename": "Products/CMFPlone/tests/testURLTool.py",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -96,3 +96,16 @@ def test_isURLInPortalExternal(self):\n         self.assertFalse(iURLiP('http://external4/other'))\n         self.assertFalse(iURLiP('http://external5'))\n         self.assertFalse(iURLiP('http://external11'))\n+\n+    def test_script_tag_url_not_in_portal(self):\n+        url_tool = self._makeOne()\n+        iURLiP = url_tool.isURLInPortal\n+        self.assertFalse(iURLiP('<script>alert(\"hi\");</script>'))\n+        self.assertFalse(\n+            iURLiP('%3Cscript%3Ealert(%22hi%22)%3B%3C%2Fscript%3E'))\n+\n+    def test_inline_url_not_in_portal(self):\n+        url_tool = self._makeOne()\n+        iURLiP = url_tool.isURLInPortal\n+        self.assertFalse(iURLiP('javascript%3Aalert(3)'))\n+        self.assertFalse(iURLiP('javascript:alert(3)'))"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0d9943cc7465281ca19b361635bf1836c59a0455",
            "date": "2025-01-06T20:25:18Z",
            "author_login": "mauritsvanrees"
          },
          {
            "sha": "81316998219cc2828a651b8ed132c37ed60064b1",
            "date": "2025-01-06T16:20:28Z",
            "author_login": "gotcha"
          },
          {
            "sha": "f352e2f43f6fc6ef4f66242d3c0d54cc05117dd2",
            "date": "2024-12-20T00:53:41Z",
            "author_login": "mauritsvanrees"
          },
          {
            "sha": "0f7e06a134a26b70564d9ee2c1bec5a4c827aac0",
            "date": "2024-12-19T22:35:16Z",
            "author_login": "mauritsvanrees"
          },
          {
            "sha": "ed9d751ee06c981312b738e85dcbcbd3a97dec00",
            "date": "2024-12-19T22:34:38Z",
            "author_login": "mauritsvanrees"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in Plone 3.3.0 through 3.3.6, 4.0.0 through 4.0.10, 4.1.0 through 4.1.6, 4.2.0 through 4.2.7, 4.3.x before 4.3.7, and 5.0rc1.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-25T17:29:00.587",
    "last_modified": "2024-11-21T02:36:34.517",
    "fix_date": "2015-09-10T17:57:08Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/09/22/14",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1264788",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/plone/Products.CMFPlone/commit/3da710a2cd68587f0bf34f2e7ea1167d6eeee087",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://plone.org/security/hotfix/20150910/non-persistent-xss-in-plone",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2015/09/22/14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1264788",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/plone/Products.CMFPlone/commit/3da710a2cd68587f0bf34f2e7ea1167d6eeee087",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://plone.org/security/hotfix/20150910/non-persistent-xss-in-plone",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.397289",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Products.CMFPlone",
    "owner": "plone",
    "created_at": "2011-09-25T01:41:32Z",
    "updated_at": "2025-01-09T14:01:35Z",
    "pushed_at": "2025-01-14T03:59:36Z",
    "size": 130867,
    "stars": 275,
    "forks": 194,
    "open_issues": 510,
    "watchers": 275,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "2.0",
      "2.1",
      "2.5",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "4.0",
      "4.1",
      "4.2.x",
      "4.3.x",
      "5.0.x",
      "5.1.x",
      "5.2.x",
      "6.0.x"
    ],
    "languages": {
      "Python": 1494383,
      "RobotFramework": 131064,
      "JavaScript": 534,
      "CSS": 187,
      "HTML": 43
    },
    "commit_activity": {
      "total_commits_last_year": 224,
      "avg_commits_per_week": 4.3076923076923075,
      "days_active_last_year": 87
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:56:36.765583"
  }
}