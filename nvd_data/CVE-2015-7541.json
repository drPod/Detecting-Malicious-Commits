{
  "cve_id": "CVE-2015-7541",
  "github_data": {
    "repository": "quadule/colorscore",
    "fix_commit": "570b5e854cecddd44d2047c44126aed951b61718",
    "related_commits": [
      "570b5e854cecddd44d2047c44126aed951b61718",
      "570b5e854cecddd44d2047c44126aed951b61718"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "570b5e854cecddd44d2047c44126aed951b61718",
      "commit_date": "2016-01-05T10:53:22Z",
      "author": {
        "login": "flori",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix CVE-2015-7541",
        "length": 230,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/colorscore/histogram.rb",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -1,7 +1,9 @@\n+require \"shellwords\"\n+\n module Colorscore\n   class Histogram\n     def initialize(image_path, colors=16, depth=8)\n-      output = `convert #{image_path} -resize 400x400 -format %c -dither None -quantize YIQ -colors #{colors} -depth #{depth} histogram:info:-`\n+      output = `convert #{image_path.shellescape} -resize 400x400 -format %c -dither None -quantize YIQ -colors #{colors.to_i} -depth #{depth.to_i} histogram:info:-`\n       @lines = output.lines.sort.reverse.map(&:strip).reject(&:empty?)\n     end\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "32dad8ee5d7500f01208bc9262e8d4d4f3248642",
            "date": "2016-01-06T07:11:46Z",
            "author_login": "quadule"
          },
          {
            "sha": "e0073f29565ccc908ecae95952f718ab394d7500",
            "date": "2016-01-06T07:06:34Z",
            "author_login": "quadule"
          },
          {
            "sha": "570b5e854cecddd44d2047c44126aed951b61718",
            "date": "2016-01-05T10:53:22Z",
            "author_login": "flori"
          },
          {
            "sha": "d589ce05be678c87174adae013ca5ac79f567828",
            "date": "2012-11-18T06:19:42Z",
            "author_login": "quadule"
          },
          {
            "sha": "95ebe3304f0d5851e74f03bc8e4ea4c21bfefcce",
            "date": "2012-11-18T06:19:22Z",
            "author_login": "quadule"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-77",
    "description": "The initialize method in the Histogram class in lib/colorscore/histogram.rb in the colorscore gem before 0.0.5 for Ruby allows context-dependent attackers to execute arbitrary code via shell metacharacters in the (1) image_path, (2) colors, or (3) depth variable.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-01-08T21:59:04.060",
    "last_modified": "2024-11-21T02:36:56.783",
    "fix_date": "2016-01-05T10:53:22Z"
  },
  "references": [
    {
      "url": "http://rubysec.com/advisories/CVE-2015-7541/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/01/05/2",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/quadule/colorscore/commit/570b5e854cecddd44d2047c44126aed951b61718",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://rubysec.com/advisories/CVE-2015-7541/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/01/05/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/quadule/colorscore/commit/570b5e854cecddd44d2047c44126aed951b61718",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:40.194319",
    "processing_status": "enhanced"
  }
}