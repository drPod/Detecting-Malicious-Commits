{
  "cve_id": "CVE-2015-7580",
  "github_data": {
    "repository": "rails/rails-html-sanitizer",
    "fix_commit": "63903b0eaa6d2a4e1c91bc86008256c4c8335e78",
    "related_commits": [
      "63903b0eaa6d2a4e1c91bc86008256c4c8335e78",
      "63903b0eaa6d2a4e1c91bc86008256c4c8335e78"
    ],
    "patch_url": "https://github.com/rails/rails-html-sanitizer/commit/63903b0eaa6d2a4e1c91bc86008256c4c8335e78.patch",
    "fix_commit_details": {
      "sha": "63903b0eaa6d2a4e1c91bc86008256c4c8335e78",
      "commit_date": "2015-10-29T19:06:26Z",
      "author": {
        "login": "tenderlove",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "convert CDATA nodes to TEXT nodes to avoid XSS issues",
        "length": 226,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 16,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/rails/html/scrubbers.rb",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -60,6 +60,11 @@ def attributes=(attributes)\n       end\n \n       def scrub(node)\n+        if node.cdata?\n+          text = node.document.create_text_node node.text\n+          node.replace text\n+          return CONTINUE\n+        end\n         return CONTINUE if skip_node?(node)\n \n         unless keep_node?(node)\n@@ -76,7 +81,7 @@ def allowed_node?(node)\n       end\n \n       def skip_node?(node)\n-        node.text? || node.cdata?\n+        node.text?\n       end\n \n       def scrub_attribute?(name)"
        },
        {
          "filename": "test/sanitizer_test.rb",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -11,6 +11,16 @@ def test_sanitizer_sanitize_raises_not_implemented_error\n     end\n   end\n \n+  def test_sanitize_nested_script\n+    sanitizer = Rails::Html::WhiteListSanitizer.new\n+    assert_equal '&lt;script&gt;alert(\"XSS\");&lt;/script&gt;', sanitizer.sanitize('<script><script></script>alert(\"XSS\");<script><</script>/</script><script>script></script>', tags: %w(em))\n+  end\n+\n+  def test_sanitize_nested_script_in_style\n+    sanitizer = Rails::Html::WhiteListSanitizer.new\n+    assert_equal '&lt;script&gt;alert(\"XSS\");&lt;/script&gt;', sanitizer.sanitize('<style><script></style>alert(\"XSS\");<style><</style>/</style><style>script></style>', tags: %w(em))\n+  end\n+\n   class XpathRemovalTestSanitizer < Rails::Html::Sanitizer\n     def sanitize(html, options = {})\n       fragment = Loofah.fragment(html)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "08e39d99059c1179efd5e50fdb3bc60a262973f8",
            "date": "2024-12-12T21:05:18Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "694d98195b90ba29e57ed650dac43e2b026582b2",
            "date": "2024-12-12T20:54:53Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "9a1e3761b42f0f7f49021a185df480dc4aabf423",
            "date": "2024-12-12T20:45:59Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "9d5b3989a661b82c3407bb38594345b5f363da2b",
            "date": "2024-12-04T13:36:24Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "5e96b19bbb934284e675109851bd82429622bb6e",
            "date": "2024-12-02T20:50:58Z",
            "author_login": "flavorjones"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in lib/rails/html/scrubbers.rb in the rails-html-sanitizer gem before 1.0.3 for Ruby on Rails 4.2.x and 5.x allows remote attackers to inject arbitrary web script or HTML via a crafted CDATA node.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-02-16T02:59:03.970",
    "last_modified": "2024-11-21T02:37:01.367",
    "fix_date": "2015-10-29T19:06:26Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-02/msg00014.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-02/msg00024.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-04/msg00053.html",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/01/25/15",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1034816",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails-html-sanitizer/commit/63903b0eaa6d2a4e1c91bc86008256c4c8335e78",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://groups.google.com/forum/message/raw?msg=rubyonrails-security/uh--W4TDwmI/m_CVZtdbFQAJ",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-02/msg00014.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-02/msg00024.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-04/msg00053.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/01/25/15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1034816",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails-html-sanitizer/commit/63903b0eaa6d2a4e1c91bc86008256c4c8335e78",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://groups.google.com/forum/message/raw?msg=rubyonrails-security/uh--W4TDwmI/m_CVZtdbFQAJ",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:40.209253",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rails-html-sanitizer",
    "owner": "rails",
    "created_at": "2013-09-25T00:54:20Z",
    "updated_at": "2024-12-17T07:47:06Z",
    "pushed_at": "2024-12-12T21:05:43Z",
    "size": 367,
    "stars": 310,
    "forks": 83,
    "open_issues": 8,
    "watchers": 310,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Ruby": 84358
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:21:15.645659"
  }
}