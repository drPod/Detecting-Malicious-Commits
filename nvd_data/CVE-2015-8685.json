{
  "cve_id": "CVE-2015-8685",
  "github_data": {
    "repository": "GPCsolutions/dolibarr",
    "fix_commit": "0d3181324c816bdf664ca5e1548dfe8eb05c54f8",
    "related_commits": [
      "0d3181324c816bdf664ca5e1548dfe8eb05c54f8",
      "0d3181324c816bdf664ca5e1548dfe8eb05c54f8"
    ],
    "patch_url": "https://github.com/GPCsolutions/dolibarr/commit/0d3181324c816bdf664ca5e1548dfe8eb05c54f8.patch",
    "fix_commit_details": {
      "sha": "0d3181324c816bdf664ca5e1548dfe8eb05c54f8",
      "commit_date": "2016-01-08T05:09:15Z",
      "author": {
        "login": "rdoursenaud",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "FIX #2857, #4291 & #4341 Escape GETPOST alpha data by default",
        "length": 118,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 16,
        "deletions": 15
      },
      "files": [
        {
          "filename": "htdocs/core/lib/functions.lib.php",
          "status": "modified",
          "additions": 16,
          "deletions": 15,
          "patch": "@@ -1,16 +1,17 @@\n <?php\n-/* Copyright (C) 2000-2007 Rodolphe Quiedeville <rodolphe@quiedeville.org>\n- * Copyright (C) 2003      Jean-Louis Bergamo   <jlb@j1b.org>\n- * Copyright (C) 2004-2013 Laurent Destailleur  <eldy@users.sourceforge.net>\n- * Copyright (C) 2004      Sebastien Di Cintio  <sdicintio@ressource-toi.org>\n- * Copyright (C) 2004      Benoit Mortier       <benoit.mortier@opensides.be>\n- * Copyright (C) 2004      Christophe Combelles <ccomb@free.fr>\n- * Copyright (C) 2005-2012 Regis Houssin        <regis.houssin@capnetworks.com>\n- * Copyright (C) 2008      Raphael Bertrand (Resultic)       <raphael.bertrand@resultic.fr>\n- * Copyright (C) 2010-2011 Juanjo Menent        <jmenent@2byte.es>\n- * Copyright (C) 2013      C\u00e9dric Salvador      <csalvador@gpcsolutions.fr>\n- * Copyright (C) 2013      Alexandre Spangaro   <alexandre.spangaro@gmail.com>\n- * Copyright (C) 2014-2015 Marcos Garc\u00eda        <marcosgdf@gmail.com>\n+/* Copyright (C) 2000-2007  Rodolphe Quiedeville        <rodolphe@quiedeville.org>\n+ * Copyright (C) 2003       Jean-Louis Bergamo          <jlb@j1b.org>\n+ * Copyright (C) 2004-2013  Laurent Destailleur         <eldy@users.sourceforge.net>\n+ * Copyright (C) 2004       Sebastien Di Cintio         <sdicintio@ressource-toi.org>\n+ * Copyright (C) 2004       Benoit Mortier              <benoit.mortier@opensides.be>\n+ * Copyright (C) 2004       Christophe Combelles        <ccomb@free.fr>\n+ * Copyright (C) 2005-2012  Regis Houssin               <regis.houssin@capnetworks.com>\n+ * Copyright (C) 2008       Raphael Bertrand (Resultic) <raphael.bertrand@resultic.fr>\n+ * Copyright (C) 2010-2011  Juanjo Menent               <jmenent@2byte.es>\n+ * Copyright (C) 2013       C\u00e9dric Salvador             <csalvador@gpcsolutions.fr>\n+ * Copyright (C) 2013       Alexandre Spangaro          <alexandre.spangaro@gmail.com>\n+ * Copyright (C) 2014-2015  Marcos Garc\u00eda               <marcosgdf@gmail.com>\n+ * Copyright (C) 2016       Rapha\u00ebl Doursenaud          <rdoursenaud@gpcsolutions.fr>\n  *\n  * This program is free software; you can redistribute it and/or modify\n  * it under the terms of the GNU General Public License as published by\n@@ -194,10 +195,10 @@ function GETPOST($paramname,$check='',$method=0)\n \t\telseif ($check == 'alpha')\n \t\t{\n \t\t\t$out=trim($out);\n-\t\t\t// '\"' is dangerous because param in url can close the href= or src= and add javascript functions.\n \t\t\t// '../' is dangerous because it allows dir transversals\n-\t\t\tif (preg_match('/\"/',$out)) $out='';\n-\t\t\telse if (preg_match('/\\.\\.\\//',$out)) $out='';\n+\t\t\tif (preg_match('/\\.\\.\\//',$out)) $out='';\n+\t\t\t// Quotes are dangerous because param in url can close the href= or src= and add javascript functions.\n+\t\t\t$out = htmlspecialchars($out, ENT_QUOTES);\n \t\t}\n \t\telseif ($check == 'aZ')\n \t\t{"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5c233a41b330e754d554297e5b2a5f06af7f55ad",
            "date": "2017-01-09T22:54:31Z",
            "author_login": "eldy"
          },
          {
            "sha": "93ab2246140261305dc8fa2f563413564750377a",
            "date": "2017-01-09T22:33:36Z",
            "author_login": "eldy"
          },
          {
            "sha": "c4ff1f983c10848e33d7182d8d198dfb9b74ffb5",
            "date": "2017-01-09T22:32:36Z",
            "author_login": "eldy"
          },
          {
            "sha": "decbda3e23e9dae793a12322ba48d3e4a9898c07",
            "date": "2017-01-09T22:26:31Z",
            "author_login": "eldy"
          },
          {
            "sha": "a9354e5f274809daff2077858a6b08788afcab59",
            "date": "2017-01-09T20:07:54Z",
            "author_login": "eldy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in Dolibarr ERP/CRM 3.8.3 and earlier allow remote attackers to inject arbitrary web script or HTML via the (1) external calendar url or (2) the bank name field in the \"import external calendar\" page.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-01-15T19:59:01.837",
    "last_modified": "2024-11-21T02:38:58.290",
    "fix_date": "2016-01-08T05:09:15Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/135256/dolibarr-HTML-Injection.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2016/Jan/40",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/issues/4291",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/GPCsolutions/dolibarr/commit/0d3181324c816bdf664ca5e1548dfe8eb05c54f8",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/135256/dolibarr-HTML-Injection.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2016/Jan/40",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/issues/4291",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/GPCsolutions/dolibarr/commit/0d3181324c816bdf664ca5e1548dfe8eb05c54f8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:40.195915",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dolibarr",
    "owner": "GPCsolutions",
    "created_at": "2012-04-16T14:34:07Z",
    "updated_at": "2021-09-24T17:33:55Z",
    "pushed_at": "2018-05-23T09:38:00Z",
    "size": 460512,
    "stars": 2,
    "forks": 0,
    "open_issues": 14,
    "watchers": 2,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "PHP": 41347486,
      "JavaScript": 1649129,
      "CSS": 457914,
      "HTML": 342369,
      "SQLPL": 130859,
      "Perl": 108444,
      "Shell": 55339,
      "Inno Setup": 47985,
      "C": 22113,
      "PLpgSQL": 21093,
      "Makefile": 8320,
      "C++": 7952,
      "Batchfile": 1264,
      "ApacheConf": 751
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T20:17:43.727991"
  }
}