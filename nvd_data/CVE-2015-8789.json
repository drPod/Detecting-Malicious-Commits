{
  "cve_id": "CVE-2015-8789",
  "github_data": {
    "repository": "Matroska-Org/libebml",
    "fix_commit": "88409e2a94dd3b40ff81d08bf6d92f486d036b24",
    "related_commits": [
      "88409e2a94dd3b40ff81d08bf6d92f486d036b24",
      "88409e2a94dd3b40ff81d08bf6d92f486d036b24"
    ],
    "patch_url": "https://github.com/Matroska-Org/libebml/commit/88409e2a94dd3b40ff81d08bf6d92f486d036b24.patch",
    "fix_commit_details": {
      "sha": "88409e2a94dd3b40ff81d08bf6d92f486d036b24",
      "commit_date": "2015-10-20T12:53:44Z",
      "author": {
        "login": "mbunkus",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "EbmlMaster: propagate upper level element after infinite sized one correctly",
        "length": 487,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 16,
        "deletions": 0
      },
      "files": [
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -1,5 +1,13 @@\n 2015-10-20  Moritz Bunkus  <moritz@bunkus.org>\n \n+        * EbmlMaster::Read(): When the parser encountered a deeply nested\n+        element with an infinite size then a following element of an upper\n+        level was not propagated correctly. Instead the element with the\n+        infinite size was added into the EBML element tree a second time\n+        resulting in memory access after freeing it and multiple attempts\n+        to free the same memory address during destruction. Fixes the\n+        issue reported as Cisco TALOS-CAN-0037.\n+\n         * EbmlElement::ReadCodedSizeValue(): Fixed an invalid memory\n         access. When reading a EBML variable length integer value a read\n         access beyond the end of the available buffer was possible if"
        },
        {
          "filename": "src/EbmlMaster.cpp",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -454,6 +454,14 @@ void EbmlMaster::Read(EbmlStream & inDataStream, const EbmlSemanticContext & sCo\n         } else {\n           if (DeleteElement)\n             delete ElementLevelA;\n+\n+          if (UpperEltFound) {\n+            --UpperEltFound;\n+            if (UpperEltFound > 0 || MaxSizeToRead <= 0)\n+              goto processCrc;\n+            ElementLevelA = FoundElt;\n+          }\n+\n           break;\n         }\n       }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0327ea6815cf139d3e227316b82f79eb75f3ffa3",
            "date": "2025-01-05T12:28:24Z",
            "author_login": "robUx4"
          },
          {
            "sha": "797bb178fae763248eef78c60918e89edce98b46",
            "date": "2025-01-05T12:25:12Z",
            "author_login": "robUx4"
          },
          {
            "sha": "8caf7914ddb5e60cf0a1154b28164399ac5b40ac",
            "date": "2025-01-05T12:23:09Z",
            "author_login": "robUx4"
          },
          {
            "sha": "802880aa768facba75b6ebf66da70afa724d3cb4",
            "date": "2025-01-05T12:21:31Z",
            "author_login": "robUx4"
          },
          {
            "sha": "6efb11c2de4b39150ff654c39ed351e3e516b1e8",
            "date": "2025-01-01T12:48:47Z",
            "author_login": "robUx4"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "Use-after-free vulnerability in the EbmlMaster::Read function in libEBML before 1.3.3 allows context-dependent attackers to have unspecified impact via a \"deeply nested element with infinite size\" followed by another element of an upper level in an EBML document.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-01-29T19:59:01.233",
    "last_modified": "2024-11-21T02:39:12.030",
    "fix_date": "2015-10-20T12:53:44Z"
  },
  "references": [
    {
      "url": "http://lists.matroska.org/pipermail/matroska-users/2015-October/006985.html",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-01/msg00035.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3538",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/94924",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.talosintelligence.com/reports/TALOS-2016-0037/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Matroska-Org/libebml/blob/release-1.3.3/ChangeLog",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Matroska-Org/libebml/commit/88409e2a94dd3b40ff81d08bf6d92f486d036b24",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.matroska.org/pipermail/matroska-users/2015-October/006985.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-01/msg00035.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3538",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/94924",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.talosintelligence.com/reports/TALOS-2016-0037/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Matroska-Org/libebml/blob/release-1.3.3/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Matroska-Org/libebml/commit/88409e2a94dd3b40ff81d08bf6d92f486d036b24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:40.200436",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libebml",
    "owner": "Matroska-Org",
    "created_at": "2013-01-02T12:55:31Z",
    "updated_at": "2025-01-05T12:43:49Z",
    "pushed_at": "2025-01-05T12:43:45Z",
    "size": 1269,
    "stars": 143,
    "forks": 47,
    "open_issues": 36,
    "watchers": 143,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C++": 226541,
      "CMake": 6534,
      "C": 1825
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T14:22:56.445946"
  }
}