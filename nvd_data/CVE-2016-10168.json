{
  "cve_id": "CVE-2016-10168",
  "github_data": {
    "repository": "libgd/libgd",
    "fix_commit": "69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6",
    "related_commits": [
      "69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6",
      "69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6",
      "commit_date": "2016-12-17T16:06:58Z",
      "author": {
        "login": "cmb69",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix #354: Signed Integer Overflow gd_io.c",
        "length": 411,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 41,
        "additions": 41,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/gd_gd2.c",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -209,6 +209,10 @@ _gd2GetHeader (gdIOCtxPtr in, int *sx, int *sy,\n \tGD2_DBG (printf (\"%d Chunks vertically\\n\", *ncy));\n \n \tif (gd2_compressed (*fmt)) {\n+\t\tif (*ncx <= 0 || *ncy <= 0 || *ncx > INT_MAX / *ncy) {\n+\t\t\tGD2_DBG(printf (\"Illegal chunk counts: %d * %d\\n\", *ncx, *ncy));\n+\t\t\tgoto fail1;\n+\t\t}\n \t\tnc = (*ncx) * (*ncy);\n \n \t\tGD2_DBG (printf (\"Reading %d chunk index entries\\n\", nc));"
        },
        {
          "filename": "tests/gd2/.gitignore",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,5 +1,6 @@\n /bug_289\n /bug00309\n+/bug00354\n /gd2_empty_file\n /gd2_im2im\n /gd2_null"
        },
        {
          "filename": "tests/gd2/CMakeLists.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,6 +1,7 @@\n LIST(APPEND TESTS_FILES\n \tbug_289\n \tbug00309\n+\tbug00354\n \tgd2_empty_file\n \tgd2_im2im\n \tgd2_null"
        },
        {
          "filename": "tests/gd2/Makemodule.am",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1,6 +1,7 @@\n libgd_test_programs += \\\n \tgd2/bug_289 \\\n \tgd2/bug00309 \\\n+\tgd2/bug00354 \\\n \tgd2/gd2_empty_file \\\n \tgd2/php_bug_72339 \\\n \tgd2/gd2_read_corrupt \\\n@@ -19,6 +20,8 @@ endif\n \n EXTRA_DIST += \\\n \tgd2/CMakeLists.txt \\\n+\tgd2/bug00354a.gd2 \\\n+\tgd2/bug00354b.gd2 \\\n \tgd2/conv_gd2_exp.gd2 \\\n \tgd2/conv_test.gd2 \\\n \tgd2/conv_test_exp.png \\"
        },
        {
          "filename": "tests/gd2/bug00354.c",
          "status": "added",
          "additions": 32,
          "deletions": 0,
          "patch": "@@ -0,0 +1,32 @@\n+/**\r\n+ * We're testing GD2 image files which report illegal chunk counts. These should\r\n+ * not cause integer overflows or other issues, but instead simply fail to be\r\n+ * loaded.\r\n+ *\r\n+ * See also <https://github.com/libgd/libgd/issues/354>.\r\n+ */\r\n+\r\n+\r\n+#include \"gd.h\"\r\n+#include \"gdtest.h\"\r\n+\r\n+\r\n+int main()\r\n+{\r\n+    gdImagePtr im;\r\n+    FILE *fp;\r\n+\r\n+    fp = gdTestFileOpen2(\"gd2\", \"bug00354a.gd2\");\r\n+    gdTestAssert(fp != NULL);\r\n+    im = gdImageCreateFromGd2(fp);\r\n+    gdTestAssert(im == NULL);\r\n+    fclose(fp);\r\n+\r\n+    fp = gdTestFileOpen2(\"gd2\", \"bug00354b.gd2\");\r\n+    gdTestAssert(fp != NULL);\r\n+    im = gdImageCreateFromGd2(fp);\r\n+    gdTestAssert(im == NULL);\r\n+    fclose(fp);\r\n+\r\n+    return gdNumFailures();\r\n+}\r"
        },
        {
          "filename": "tests/gd2/bug00354a.gd2",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/gd2/bug00354b.gd2",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 6,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0b8d70805d6f0b53a88902826ddc02208f8e32a1",
            "date": "2025-01-23T14:25:23Z",
            "author_login": "cmb69"
          },
          {
            "sha": "66c20541101167089ff72183e695a7b3b763b697",
            "date": "2025-01-19T19:04:08Z",
            "author_login": "cmb69"
          },
          {
            "sha": "e0de4803d13f5813f936287a3160b40bb2847241",
            "date": "2025-01-18T15:31:24Z",
            "author_login": "cmb69"
          },
          {
            "sha": "f1480ab14bd5e2e4b4d83d8f3e64e786aa810637",
            "date": "2025-01-18T12:19:50Z",
            "author_login": "cmb69"
          },
          {
            "sha": "721f9228c2cce7d1361a2f3fd95ec95b8b959dbf",
            "date": "2025-01-10T11:37:52Z",
            "author_login": "cmb69"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "Integer overflow in gd_io.c in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to have unspecified impact via vectors involving the number of horizontal and vertical chunks in an image.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-03-15T15:59:00.343",
    "last_modified": "2024-11-21T02:43:27.877",
    "fix_date": "2016-12-17T16:06:58Z"
  },
  "references": [
    {
      "url": "http://libgd.github.io/release-2.2.4.html",
      "source": "security@debian.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3777",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/26/1",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/28/6",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95869",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1037659",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:3221",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1296",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://github.com/libgd/libgd/commit/69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6",
      "source": "security@debian.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgd/libgd/issues/354",
      "source": "security@debian.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://libgd.github.io/release-2.2.4.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3777",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/26/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/28/6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95869",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1037659",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:3221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1296",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/libgd/libgd/commit/69d2fd2c597ffc0c217de1238b9bf4d4bceba8e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgd/libgd/issues/354",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.268498",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libgd",
    "owner": "libgd",
    "created_at": "2015-01-22T08:50:57Z",
    "updated_at": "2025-01-23T22:01:59Z",
    "pushed_at": "2025-01-23T14:25:23Z",
    "size": 26543,
    "stars": 911,
    "forks": 275,
    "open_issues": 133,
    "watchers": 911,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "GD-2.1",
      "GD-2.2",
      "GD-2.3"
    ],
    "languages": {
      "C": 1644961,
      "CMake": 68297,
      "C++": 65997,
      "M4": 46524,
      "HTML": 42081,
      "Shell": 37342,
      "Makefile": 10014,
      "Perl": 3997,
      "Batchfile": 2234,
      "Tcl": 1381,
      "Python": 1206
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:06:25.715141"
  }
}