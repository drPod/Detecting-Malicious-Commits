{
  "cve_id": "CVE-2016-10187",
  "github_data": {
    "repository": "kovidgoyal/calibre",
    "fix_commit": "3a89718664cb8c",
    "related_commits": [
      "3a89718664cb8c",
      "3a89718664cb8c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3a89718664cb8c",
      "commit_date": "2016-12-21T12:29:00Z",
      "author": {
        "login": "kovidgoyal",
        "type": "User",
        "stats": {
          "total_commits": 38476,
          "average_weekly_commits": 40.37355718782791,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 945
        }
      },
      "commit_message": {
        "title": "E-book viewer: Prevent javascript in the book from accessing files on the computer using XMLHttpRequest. Fixes #1651728 [Private bug](https://bugs.launchpad.net/calibre/+bug/1651728)",
        "length": 182,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/calibre/gui2/tweak_book/preview.py",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -145,6 +145,7 @@ def clear(self):\n     def is_alive(self):\n         return Thread.is_alive(self) or (hasattr(self, 'worker') and self.worker.is_alive())\n \n+\n parse_worker = ParseWorker()\n # }}}\n \n@@ -280,6 +281,7 @@ def __init__(self, parent):\n         settings.setAttribute(settings.PrivateBrowsingEnabled, True)\n         settings.setAttribute(settings.JavascriptCanOpenWindows, False)\n         settings.setAttribute(settings.JavascriptCanAccessClipboard, False)\n+        settings.setAttribute(settings.LocalContentCanAccessFileUrls, False)  # ensure javascript cannot read from local files\n         settings.setAttribute(settings.LinksIncludedInFocusChain, False)\n         settings.setAttribute(settings.DeveloperExtrasEnabled, True)\n         settings.setDefaultTextEncoding('utf-8')"
        },
        {
          "filename": "src/calibre/gui2/viewer/documentview.py",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -53,6 +53,7 @@ def apply_basic_settings(settings):\n     settings.setAttribute(QWebSettings.PluginsEnabled, False)\n     settings.setAttribute(QWebSettings.JavascriptCanOpenWindows, False)\n     settings.setAttribute(QWebSettings.JavascriptCanAccessClipboard, False)\n+    settings.setAttribute(QWebSettings.LocalContentCanAccessFileUrls, False)  # ensure javascript cannot read from local files\n     # PrivateBrowsing disables console messages\n     # settings.setAttribute(QWebSettings.PrivateBrowsingEnabled, True)\n     settings.setAttribute(QWebSettings.NotificationsEnabled, False)\n@@ -1435,5 +1436,3 @@ def follow_footnote_link(self):\n             self.link_clicked(qurl)\n \n # }}}\n-\n-"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e13e07a6605aa39cf9305968c018d6cb64120db8",
            "date": "2025-01-26T05:43:26Z",
            "author_login": "kovidgoyal"
          },
          {
            "sha": "fd75807a9b67c5534b2b676958558e7ba74b6547",
            "date": "2025-01-26T05:41:27Z",
            "author_login": "kovidgoyal"
          },
          {
            "sha": "43f9daff118b65f5e735d2754a94019f398bffea",
            "date": "2025-01-26T05:30:14Z",
            "author_login": "kovidgoyal"
          },
          {
            "sha": "4de8ffb6f7790eeba2ef6d5dd55ef4d8d3540492",
            "date": "2025-01-26T05:08:00Z",
            "author_login": "kovidgoyal"
          },
          {
            "sha": "f172c6770670ebc319bf92cc95496caf7368b26e",
            "date": "2025-01-26T05:05:19Z",
            "author_login": "kovidgoyal"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-264",
    "description": "The E-book viewer in calibre before 2.75 allows remote attackers to read arbitrary files via a crafted epub file with JavaScript.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-03-16T15:59:00.837",
    "last_modified": "2024-11-21T02:43:30.700",
    "fix_date": "2016-12-21T12:29:00Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/29/8",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/31/9",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95909",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.launchpad.net/calibre/+bug/1651728",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kovidgoyal/calibre/commit/3a89718664cb8c",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/29/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/01/31/9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95909",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.launchpad.net/calibre/+bug/1651728",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kovidgoyal/calibre/commit/3a89718664cb8c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.272552",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "calibre",
    "owner": "kovidgoyal",
    "created_at": "2013-05-28T10:03:23Z",
    "updated_at": "2025-01-26T05:43:37Z",
    "pushed_at": "2025-01-26T05:43:33Z",
    "size": 310109,
    "stars": 20422,
    "forks": 2296,
    "open_issues": 5,
    "watchers": 20422,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 24216664,
      "C": 5189590,
      "C++": 806461,
      "HTML": 101638,
      "Shell": 51424,
      "XSLT": 44181,
      "CSS": 24467,
      "JavaScript": 15520,
      "Objective-C": 15127,
      "Batchfile": 7842,
      "Vim Script": 860,
      "CMake": 844
    },
    "commit_activity": {
      "total_commits_last_year": 2184,
      "avg_commits_per_week": 42.0,
      "days_active_last_year": 325
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:32:22.783886"
  }
}