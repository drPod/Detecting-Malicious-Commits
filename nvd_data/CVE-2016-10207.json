{
  "cve_id": "CVE-2016-10207",
  "github_data": {
    "repository": "TigerVNC/tigervnc",
    "fix_commit": "8aa4bc53206c2430bbf0c8f4b642f59a379ee649",
    "related_commits": [
      "8aa4bc53206c2430bbf0c8f4b642f59a379ee649",
      "8aa4bc53206c2430bbf0c8f4b642f59a379ee649"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8aa4bc53206c2430bbf0c8f4b642f59a379ee649",
      "commit_date": "2016-08-23T15:02:58Z",
      "author": {
        "login": "CendioOssman",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Proper global init/deinit of GnuTLS",
        "length": 184,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 43,
        "additions": 10,
        "deletions": 33
      },
      "files": [
        {
          "filename": "common/rfb/CSecurityTLS.cxx",
          "status": "modified",
          "additions": 5,
          "deletions": 14,
          "patch": "@@ -67,21 +67,14 @@ StringParameter CSecurityTLS::X509CRL(\"X509CRL\", \"X509 CRL file\", \"\", ConfViewer\n \n static LogWriter vlog(\"TLS\");\n \n-void CSecurityTLS::initGlobal()\n-{\n-  static bool globalInitDone = false;\n-\n-  if (!globalInitDone) {\n-    gnutls_global_init();\n-    globalInitDone = true;\n-  }\n-}\n-\n CSecurityTLS::CSecurityTLS(bool _anon) : session(0), anon_cred(0),\n \t\t\t\t\t\t anon(_anon), fis(0), fos(0)\n {\n   cafile = X509CA.getData();\n   crlfile = X509CRL.getData();\n+\n+  if (gnutls_global_init() != GNUTLS_E_SUCCESS)\n+    throw AuthFailureException(\"gnutls_global_init failed\");\n }\n \n void CSecurityTLS::setDefaults()\n@@ -125,8 +118,6 @@ void CSecurityTLS::shutdown(bool needbye)\n   if (session) {\n     gnutls_deinit(session);\n     session = 0;\n-\n-    gnutls_global_deinit();\n   }\n }\n \n@@ -142,6 +133,8 @@ CSecurityTLS::~CSecurityTLS()\n \n   delete[] cafile;\n   delete[] crlfile;\n+\n+  gnutls_global_deinit();\n }\n \n bool CSecurityTLS::processMsg(CConnection* cc)\n@@ -150,8 +143,6 @@ bool CSecurityTLS::processMsg(CConnection* cc)\n   rdr::OutStream* os = cc->getOutStream();\n   client = cc;\n \n-  initGlobal();\n-\n   if (!session) {\n     if (!is->checkNoWait(1))\n       return false;"
        },
        {
          "filename": "common/rfb/CSecurityTLS.h",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -62,8 +62,6 @@ namespace rfb {\n     CConnection *client;\n \n   private:\n-    static void initGlobal();\n-\n     gnutls_session_t session;\n     gnutls_anon_client_credentials_t anon_cred;\n     gnutls_certificate_credentials_t cert_cred;"
        },
        {
          "filename": "common/rfb/SSecurityTLS.cxx",
          "status": "modified",
          "additions": 5,
          "deletions": 15,
          "patch": "@@ -48,23 +48,15 @@ StringParameter SSecurityTLS::X509_KeyFile\n \n static LogWriter vlog(\"TLS\");\n \n-void SSecurityTLS::initGlobal()\n-{\n-  static bool globalInitDone = false;\n-\n-  if (!globalInitDone) {\n-    if (gnutls_global_init() != GNUTLS_E_SUCCESS)\n-      throw AuthFailureException(\"gnutls_global_init failed\");\n-    globalInitDone = true;\n-  }\n-}\n-\n SSecurityTLS::SSecurityTLS(bool _anon) : session(0), dh_params(0),\n \t\t\t\t\t\t anon_cred(0), cert_cred(0),\n \t\t\t\t\t\t anon(_anon), fis(0), fos(0)\n {\n   certfile = X509_CertFile.getData();\n   keyfile = X509_KeyFile.getData();\n+\n+  if (gnutls_global_init() != GNUTLS_E_SUCCESS)\n+    throw AuthFailureException(\"gnutls_global_init failed\");\n }\n \n void SSecurityTLS::shutdown()\n@@ -94,8 +86,6 @@ void SSecurityTLS::shutdown()\n   if (session) {\n     gnutls_deinit(session);\n     session = 0;\n-\n-    gnutls_global_deinit();\n   }\n }\n \n@@ -111,6 +101,8 @@ SSecurityTLS::~SSecurityTLS()\n \n   delete[] keyfile;\n   delete[] certfile;\n+\n+  gnutls_global_deinit();\n }\n \n bool SSecurityTLS::processMsg(SConnection *sc)\n@@ -121,8 +113,6 @@ bool SSecurityTLS::processMsg(SConnection *sc)\n   vlog.debug(\"Process security message (session %p)\", session);\n \n   if (!session) {\n-    initGlobal();\n-\n     if (gnutls_init(&session, GNUTLS_SERVER) != GNUTLS_E_SUCCESS)\n       throw AuthFailureException(\"gnutls_init failed\");\n "
        },
        {
          "filename": "common/rfb/SSecurityTLS.h",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -54,8 +54,6 @@ namespace rfb {\n     void setParams(gnutls_session_t session);\n \n   private:\n-    static void initGlobal();\n-\n     gnutls_session_t session;\n     gnutls_dh_params_t dh_params;\n     gnutls_anon_server_credentials_t anon_cred;"
        }
      ],
      "file_patterns": {
        "security_files": 4,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c479602e867a1670880e43fcd2aac03f7a0247ab",
            "date": "2025-01-23T08:33:00Z",
            "author_login": "CendioOssman"
          },
          {
            "sha": "7ba23193b0e0b12e73a82356b0c3645ad726cf5b",
            "date": "2025-01-22T21:21:00Z",
            "author_login": "lanurmi"
          },
          {
            "sha": "f5b42e4085cf11ea1d6395c470e3f1c10df31daa",
            "date": "2025-01-22T13:38:58Z",
            "author_login": "CendioOssman"
          },
          {
            "sha": "e3e484841cb6283266bea91221400122610131c6",
            "date": "2025-01-22T13:37:09Z",
            "author_login": "CendioOssman"
          },
          {
            "sha": "e9f662656d78ec270803d2df2d6bbea0a958dcb1",
            "date": "2025-01-22T10:46:00Z",
            "author_login": "alshopov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-119",
    "description": "The Xvnc server in TigerVNC allows remote attackers to cause a denial of service (invalid memory access and crash) by terminating a TLS handshake early.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-02-28T18:59:00.170",
    "last_modified": "2024-11-21T02:43:33.843",
    "fix_date": "2016-08-23T15:02:58Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2017-02/msg00020.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0630.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/02/02/22",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/02/05/2",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96012",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:2000",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1023012",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/TigerVNC/tigervnc/commit/8aa4bc53206c2430bbf0c8f4b642f59a379ee649",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201801-13",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2017-02/msg00020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0630.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/02/02/22",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2017/02/05/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96012",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:2000",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1023012",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/TigerVNC/tigervnc/commit/8aa4bc53206c2430bbf0c8f4b642f59a379ee649",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201801-13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.238245",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "tigervnc",
    "owner": "TigerVNC",
    "created_at": "2014-06-25T12:48:26Z",
    "updated_at": "2025-01-26T02:07:42Z",
    "pushed_at": "2025-01-23T08:34:06Z",
    "size": 25127,
    "stars": 5397,
    "forks": 973,
    "open_issues": 180,
    "watchers": 5397,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 2105291,
      "Java": 1745894,
      "C": 1008908,
      "CMake": 71038,
      "Roff": 50879,
      "Makefile": 32567,
      "Objective-C++": 17764,
      "Perl": 12443,
      "Shell": 11196,
      "Objective-C": 1780,
      "Python": 1378
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:48:28.084638"
  }
}