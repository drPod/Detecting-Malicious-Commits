{
  "cve_id": "CVE-2016-10251",
  "github_data": {
    "repository": "mdadams/jasper",
    "fix_commit": "1f0dfe5a42911b6880a1445f13f6d615ddb55387",
    "related_commits": [
      "1f0dfe5a42911b6880a1445f13f6d615ddb55387",
      "1f0dfe5a42911b6880a1445f13f6d615ddb55387"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1f0dfe5a42911b6880a1445f13f6d615ddb55387",
      "commit_date": "2016-11-04T14:20:23Z",
      "author": {
        "login": "mdadams",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed an integer overflow problem in the JPC codec that later resulted",
        "length": 104,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 40,
        "additions": 20,
        "deletions": 20
      },
      "files": [
        {
          "filename": "src/libjasper/jpc/jpc_t2cod.c",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -432,18 +432,18 @@ static int jpc_pi_nextcprl(register jpc_pi_t *pi)\n \t  &pi->picomps[pi->compno]; pi->compno < JAS_CAST(int, pchg->compnoend) && pi->compno < pi->numcomps; ++pi->compno,\n \t  ++pi->picomp) {\n \t\tpirlvl = pi->picomp->pirlvls;\n-\t\tpi->xstep = pi->picomp->hsamp * (1 << (pirlvl->prcwidthexpn +\n-\t\t  pi->picomp->numrlvls - 1));\n-\t\tpi->ystep = pi->picomp->vsamp * (1 << (pirlvl->prcheightexpn +\n-\t\t  pi->picomp->numrlvls - 1));\n+\t\tpi->xstep = pi->picomp->hsamp * (JAS_CAST(uint_fast32_t, 1) <<\n+\t\t  (pirlvl->prcwidthexpn + pi->picomp->numrlvls - 1));\n+\t\tpi->ystep = pi->picomp->vsamp * (JAS_CAST(uint_fast32_t, 1) <<\n+\t\t  (pirlvl->prcheightexpn + pi->picomp->numrlvls - 1));\n \t\tfor (rlvlno = 1, pirlvl = &pi->picomp->pirlvls[1];\n \t\t  rlvlno < pi->picomp->numrlvls; ++rlvlno, ++pirlvl) {\n-\t\t\tpi->xstep = JAS_MIN(pi->xstep, pi->picomp->hsamp * (1 <<\n-\t\t\t  (pirlvl->prcwidthexpn + pi->picomp->numrlvls -\n-\t\t\t  rlvlno - 1)));\n-\t\t\tpi->ystep = JAS_MIN(pi->ystep, pi->picomp->vsamp * (1 <<\n-\t\t\t  (pirlvl->prcheightexpn + pi->picomp->numrlvls -\n-\t\t\t  rlvlno - 1)));\n+\t\t\tpi->xstep = JAS_MIN(pi->xstep, pi->picomp->hsamp *\n+\t\t\t  (JAS_CAST(uint_fast32_t, 1) << (pirlvl->prcwidthexpn +\n+\t\t\t  pi->picomp->numrlvls - rlvlno - 1)));\n+\t\t\tpi->ystep = JAS_MIN(pi->ystep, pi->picomp->vsamp *\n+\t\t\t  (JAS_CAST(uint_fast32_t, 1) << (pirlvl->prcheightexpn +\n+\t\t\t  pi->picomp->numrlvls - rlvlno - 1)));\n \t\t}\n \t\tfor (pi->y = pi->ystart; pi->y < pi->yend;\n \t\t  pi->y += pi->ystep - (pi->y % pi->ystep)) {"
        },
        {
          "filename": "src/libjasper/jpc/jpc_t2cod.h",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -129,10 +129,10 @@ typedef struct {\n \tjpc_pirlvl_t *pirlvls;\n \n \t/* The horizontal sampling period. */\n-\tint hsamp;\n+\tuint_fast32_t hsamp;\n \n \t/* The vertical sampling period. */\n-\tint vsamp;\n+\tuint_fast32_t vsamp;\n \n } jpc_picomp_t;\n \n@@ -171,32 +171,32 @@ typedef struct {\n \tint lyrno;\n \n \t/* The x-coordinate of the current position. */\n-\tint x;\n+\tuint_fast32_t x;\n \n \t/* The y-coordinate of the current position. */\n-\tint y;\n+\tuint_fast32_t y;\n \n \t/* The horizontal step size. */\n-\tint xstep;\n+\tuint_fast32_t xstep;\n \n \t/* The vertical step size. */\n-\tint ystep;\n+\tuint_fast32_t ystep;\n \n \t/* The x-coordinate of the top-left corner of the tile on the reference\n \t  grid. */\n-\tint xstart;\n+\tuint_fast32_t xstart;\n \n \t/* The y-coordinate of the top-left corner of the tile on the reference\n \t  grid. */\n-\tint ystart;\n+\tuint_fast32_t ystart;\n \n \t/* The x-coordinate of the bottom-right corner of the tile on the\n \t  reference grid (plus one). */\n-\tint xend;\n+\tuint_fast32_t xend;\n \n \t/* The y-coordinate of the bottom-right corner of the tile on the\n \t  reference grid (plus one). */\n-\tint yend;\n+\tuint_fast32_t yend;\n \n \t/* The current progression change. */\n \tjpc_pchg_t *pchg;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8766848706a727f61c1c76a5a7cf1078433fad02",
            "date": "2024-04-27T17:53:19Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2d6b6e8a9987386afe388e1cde859d0182445e63",
            "date": "2024-04-27T17:49:23Z",
            "author_login": "mdadams"
          },
          {
            "sha": "29154a52b6c2b895ac3db60d51be9f2a995ee145",
            "date": "2024-04-10T06:11:01Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2fe7d2d73d18d9c7072507d462737b372f9d56bf",
            "date": "2024-03-30T16:57:05Z",
            "author_login": "mdadams"
          },
          {
            "sha": "6d084c53a77762f41bb5310713a5f1872fef55f5",
            "date": "2024-03-29T14:57:29Z",
            "author_login": "mdadams"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "Integer overflow in the jpc_pi_nextcprl function in jpc_t2cod.c in JasPer before 1.900.20 allows remote attackers to have unspecified impact via a crafted file, which triggers use of an uninitialized value.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-03-15T14:59:00.387",
    "last_modified": "2024-11-21T02:43:39.543",
    "fix_date": "2016-11-04T14:20:23Z"
  },
  "references": [
    {
      "url": "http://www.debian.org/security/2017/dsa-3827",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/97584",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/11/04/jasper-use-of-uninitialized-value-in-jpc_pi_nextcprl-jpc_t2cod-c/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/1f0dfe5a42911b6880a1445f13f6d615ddb55387",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2020.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3827",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/97584",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/11/04/jasper-use-of-uninitialized-value-in-jpc_pi_nextcprl-jpc_t2cod-c/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/1f0dfe5a42911b6880a1445f13f6d615ddb55387",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.265850",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "jasper",
    "owner": "mdadams",
    "created_at": "2016-09-16T18:52:32Z",
    "updated_at": "2025-01-23T07:28:59Z",
    "pushed_at": "2024-04-27T17:54:09Z",
    "size": 4405,
    "stars": 233,
    "forks": 103,
    "open_issues": 4,
    "watchers": 233,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1567274,
      "Shell": 147989,
      "CMake": 50869,
      "Roff": 3703,
      "Batchfile": 1905,
      "C++": 235
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:47:21.317160"
  }
}