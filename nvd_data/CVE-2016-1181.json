{
  "cve_id": "CVE-2016-1181",
  "github_data": {
    "repository": "kawasima/struts1-forever",
    "fix_commit": "eda3a79907ed8fcb0387a0496d0cb14332f250e8",
    "related_commits": [
      "eda3a79907ed8fcb0387a0496d0cb14332f250e8",
      "eda3a79907ed8fcb0387a0496d0cb14332f250e8"
    ],
    "patch_url": "https://github.com/kawasima/struts1-forever/commit/eda3a79907ed8fcb0387a0496d0cb14332f250e8.patch",
    "fix_commit_details": {
      "sha": "eda3a79907ed8fcb0387a0496d0cb14332f250e8",
      "commit_date": "2016-06-08T02:38:30Z",
      "author": {
        "login": "kawasima",
        "type": "User",
        "stats": {
          "total_commits": 7,
          "average_weekly_commits": 0.005443234836702955,
          "total_additions": 495,
          "total_deletions": 433,
          "weeks_active": 5
        }
      },
      "commit_message": {
        "title": "Fixed CVE-2016-1181 and CVE-2016-1182",
        "length": 37,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 53,
        "additions": 31,
        "deletions": 22
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 12,
          "deletions": 5,
          "patch": "@@ -1,14 +1,21 @@\n-STRUTS\n-======\n+# STRUTS\n \n ![build status](https://circleci.com/gh/kawasima/struts1-forever.png?style=shield&circle-token=8f99c0e6c923ca570acda8c3640446fdacad2a47)\n \n This struts1's fork is for maintenance to fix the vulnerabilities.\n \n-$Id: README,v 1.18 2003/12/10 01:04:10 husted Exp $\n+## Requirements\n \n-Introduction (Original)\n-------------------------\n+Original Struts requires Java 1.4 or higher. But struts1-forever requires Java 1.5 or higher.\n+Because Commons-Beanutils 1.9.2 is used for preventing a dangerous population.\n+\n+## Fixed vulnerabilities\n+\n+- CVE-2014-0114\n+- CVE-2016-1181\n+- CVE-2016-1182\n+\n+## Introduction (Original)\n \n This subproject contains the source code for the \"Struts\" application support\n package, consisting of the following major components:"
        },
        {
          "filename": "src/share/org/apache/struts/action/ActionServlet.java",
          "status": "modified",
          "additions": 19,
          "deletions": 17,
          "patch": "@@ -1,14 +1,14 @@\n /*\n- * $Id$ \n+ * $Id$\n  *\n  * Copyright 2000-2005 The Apache Software Foundation.\n- * \n+ *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n  * You may obtain a copy of the License at\n- * \n+ *\n  *      http://www.apache.org/licenses/LICENSE-2.0\n- * \n+ *\n  * Unless required by applicable law or agreed to in writing, software\n  * distributed under the License is distributed on an \"AS IS\" BASIS,\n  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n@@ -24,10 +24,7 @@\n import java.math.BigInteger;\n import java.net.MalformedURLException;\n import java.net.URL;\n-import java.util.ArrayList;\n-import java.util.Enumeration;\n-import java.util.Iterator;\n-import java.util.MissingResourceException;\n+import java.util.*;\n \n import javax.servlet.ServletContext;\n import javax.servlet.ServletException;\n@@ -327,7 +324,7 @@ public void init() throws ServletException {\n             initInternal();\n             initOther();\n             initServlet();\n-    \n+\n             getServletContext().setAttribute(Globals.ACTION_SERVLET_KEY, this);\n             initModuleConfigFactory();\n             // Initialize modules as needed\n@@ -336,7 +333,7 @@ public void init() throws ServletException {\n             initModuleDataSources(moduleConfig);\n             initModulePlugIns(moduleConfig);\n             moduleConfig.freeze();\n-    \n+\n             Enumeration names = getServletConfig().getInitParameterNames();\n             while (names.hasMoreElements()) {\n                 String name = (String) names.nextElement();\n@@ -351,23 +348,23 @@ public void init() throws ServletException {\n                 initModulePlugIns(moduleConfig);\n                 moduleConfig.freeze();\n             }\n-    \n+\n             this.initModulePrefixes(this.getServletContext());\n-    \n+\n             this.destroyConfigDigester();\n         } catch (UnavailableException ex) {\n             throw ex;\n         } catch (Throwable t) {\n \n             // The follow error message is not retrieved from internal message\n-            // resources as they may not have been able to have been \n+            // resources as they may not have been able to have been\n             // initialized\n             log.error(\"Unable to initialize Struts ActionServlet due to an \"\n                 + \"unexpected exception or error thrown, so marking the \"\n                 + \"servlet as unavailable.  Most likely, this is due to an \"\n                 + \"incorrect or missing library dependency.\", t);\n             throw new UnavailableException(t.getMessage());\n-        }    \n+        }\n     }\n \n     /**\n@@ -726,13 +723,13 @@ protected void parseModuleConfigFile(Digester digester, String path)\n             if (url == null) {\n                 url = getClass().getResource(path);\n             }\n-            \n+\n             if (url == null) {\n                 String msg = internal.getMessage(\"configMissing\", path);\n                 log.error(msg);\n                 throw new UnavailableException(msg);\n             }\n-\t    \n+\n             InputSource is = new InputSource(url.toExternalForm());\n             input = url.openStream();\n             is.setByteStream(input);\n@@ -1060,8 +1057,13 @@ protected void initInternal() throws ServletException {\n      * @exception ServletException if we cannot initialize these resources\n      */\n     protected void initOther() throws ServletException {\n+        HashSet suppressProperties = new HashSet();\n+        suppressProperties.add(\"class\");\n+        suppressProperties.add(\"multipartRequestHandler\");\n+        suppressProperties.add(\"resultValueMap\");\n+\n         PropertyUtils.addBeanIntrospector(\n-                SuppressPropertiesBeanIntrospector.SUPPRESS_CLASS);\n+                new SuppressPropertiesBeanIntrospector(suppressProperties));\n         PropertyUtils.clearDescriptors();\n \n         String value = null;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2040002f7c32942db4575ce6b30e075d352a94aa",
            "date": "2019-07-04T05:40:34Z",
            "author_login": "kawasima"
          },
          {
            "sha": "df1aa1a0e43b0ef71268469a504e8a9ccb8e335d",
            "date": "2018-08-24T05:49:30Z",
            "author_login": "kawasima"
          },
          {
            "sha": "eda3a79907ed8fcb0387a0496d0cb14332f250e8",
            "date": "2016-06-08T02:38:30Z",
            "author_login": "kawasima"
          },
          {
            "sha": "fdd9eb8f94ca75eb9effac9602b9d4ee0cb904b5",
            "date": "2015-09-28T01:39:33Z",
            "author_login": "kawasima"
          },
          {
            "sha": "1ba12033cd004c174185cd99bb942f970ed39037",
            "date": "2015-05-13T08:37:51Z",
            "author_login": "kawasima"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "ActionServlet.java in Apache Struts 1 1.x through 1.3.10 mishandles multithreaded access to an ActionForm instance, which allows remote attackers to execute arbitrary code or cause a denial of service (unexpected memory access) via a multipart request, a related issue to CVE-2015-0899.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-07-04T22:59:01.617",
    "last_modified": "2024-11-21T02:45:54.383",
    "fix_date": "2016-06-08T02:38:30Z"
  },
  "references": [
    {
      "url": "http://jvn.jp/en/jp/JVN03188560/index.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://jvndb.jvn.jp/jvndb/JVNDB-2016-000096",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory",
        "VDB Entry",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujul2016-2881720.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujul2017-3236622.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91068",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91787",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1036056",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1343538",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kawasima/struts1-forever/commit/eda3a79907ed8fcb0387a0496d0cb14332f250e8",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://security-tracker.debian.org/tracker/CVE-2016-1181",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20180629-0006/",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2020.html",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2020.html",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpujan2019-5072801.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html",
      "source": "vultures@jpcert.or.jp",
      "tags": []
    },
    {
      "url": "http://jvn.jp/en/jp/JVN03188560/index.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://jvndb.jvn.jp/jvndb/JVNDB-2016-000096",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujul2016-2881720.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujul2017-3236622.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91068",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91787",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1036056",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1343538",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kawasima/struts1-forever/commit/eda3a79907ed8fcb0387a0496d0cb14332f250e8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://security-tracker.debian.org/tracker/CVE-2016-1181",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20180629-0006/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpujan2019-5072801.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:42.571582",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "struts1-forever",
    "owner": "kawasima",
    "created_at": "2014-04-24T12:13:04Z",
    "updated_at": "2024-03-11T11:26:06Z",
    "pushed_at": "2019-07-04T05:39:55Z",
    "size": 29229,
    "stars": 27,
    "forks": 21,
    "open_issues": 1,
    "watchers": 27,
    "has_security_policy": false,
    "default_branch": "STRUTS_1_2_BRANCH",
    "protected_branches": [],
    "languages": {
      "HTML": 16972483,
      "Java": 4505502,
      "CSS": 36388,
      "GAP": 7163
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:33:50.445864"
  }
}