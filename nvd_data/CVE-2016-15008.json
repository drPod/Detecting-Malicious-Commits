{
  "cve_id": "CVE-2016-15008",
  "github_data": {
    "repository": "oxguy3/coebot-www",
    "fix_commit": "c1a6c44092585da4236237e0e7da94ee2996a0ca",
    "related_commits": [
      "c1a6c44092585da4236237e0e7da94ee2996a0ca",
      "c1a6c44092585da4236237e0e7da94ee2996a0ca"
    ],
    "patch_url": "https://github.com/oxguy3/coebot-www/commit/c1a6c44092585da4236237e0e7da94ee2996a0ca.patch",
    "fix_commit_details": {
      "sha": "c1a6c44092585da4236237e0e7da94ee2996a0ca",
      "commit_date": "2016-07-14T03:08:13Z",
      "author": {
        "login": "oxguy3",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed XSS injection vulns on channel.php",
        "length": 40,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 45,
        "additions": 30,
        "deletions": 15
      },
      "files": [
        {
          "filename": "js/channel.js",
          "status": "modified",
          "additions": 13,
          "deletions": 12,
          "patch": "@@ -164,7 +164,7 @@ function displayChannelCommands() {\n         row += '<td class=\"js-commands-editcolumn\"><span class=\"table-edit-btn\" data-toggle=\"modal\" data-target=\"#commandAddModal\" data-command=\"' + cmd.key + '\" data-accesslevel=\"' + cmd.restriction + '\" data-response=\"' + cleanHtmlAttr(cmd.value) + '\" data-modaltitle=\"Edit command\"><i class=\"icon-pencil\"></i><span class=\"sr-only\">Edit</span></span></td>';\n \t\trow += '<td><kbd class=\"command\">' + cmd.key + '</kbd></td>';\n         row += '<td class=\"row-command-col-access\" data-order=\"' + cmd.restriction + '\">' + prettifyAccessLevel(cmd.restriction) + '</td>';\n-        row += '<td class=\"should-be-linkified should-be-emotified\">' + prettifyStringVariables(cmd.value) + '</td>';\n+        row += '<td class=\"should-be-linkified should-be-emotified\">' + prettifyStringVariables(cleanHtmlText(cmd.value)) + '</td>';\n \t\trow += '<td>' + Humanize.intComma(cmd.count) + '</td>';\n \t\trow += '</tr>';\n \t\trows += row;\n@@ -261,7 +261,7 @@ function displayChannelQuotes() {\n         row += '<td class=\"js-quotes-editcolumn\"><span class=\"table-edit-btn\" data-toggle=\"modal\" data-target=\"#quoteAddModal\" data-quote=\"' + cleanHtmlAttr(quote.quote) + '\" data-quoteid=\"' + (i+1) + '\" data-modaltitle=\"Edit quote\"><i class=\"icon-pencil\"></i></span></td>';\n \n \t\trow += '<td>' + (i+1) + '</td>';\n-        row += '<td>' + quote.quote + '</td>';\n+        row += '<td>' + cleanHtmlText(quote.quote) + '</td>';\n \n         var tsMoment = (quote.timestamp !== null) ? moment(quote.timestamp) : null;\n         var tsStr = (quote.timestamp !== null) ? tsMoment.calendar() : \"Unknown\";\n@@ -320,7 +320,7 @@ function displayChannelAutoreplies() {\n         row += '<td class=\"js-autoreplies-editcolumn\"><span class=\"table-edit-btn\" data-toggle=\"modal\" data-target=\"#autoreplyAddModal\" data-trigger=\"' + cleanHtmlAttr(reply.trigger) + '\" data-response=\"' + cleanHtmlAttr(reply.response) + '\" data-arid=\"' + (i+1) + '\" data-modaltitle=\"Edit auto-reply\"><i class=\"icon-pencil\"></i></span></td>';\n         row += '<td>' + (i+1) + '</td>';\n         row += '<td title=\"RegEx: ' + cleanHtmlAttr(reply.trigger) + '\">' + prettifyRegex(reply.trigger) + '</td>';\n-        row += '<td>' + prettifyStringVariables(reply.response) + '</td>';\n+        row += '<td>' + prettifyStringVariables(cleanHtmlText(reply.response)) + '</td>';\n         row += '</tr>';\n         rows += row;\n     }\n@@ -549,7 +549,7 @@ function showChannelHighlights() {\n         var strm = highlightsStats.streams[i];\n         var row = '<tr>';\n \n-        row += '<td><span class=\"fake-link js-highlight-btn\" data-hlid=\"' + strm.id + '\">' + strm.title + '</span></td>';\n+        row += '<td><span class=\"fake-link js-highlight-btn\" data-hlid=\"' + strm.id + '\">' + cleanHtmlText(strm.title) + '</span></td>';\n \n         var startMoment = moment.unix(strm.start);\n         var cleanStart = cleanHtmlAttr(startMoment.format('LLLL'));\n@@ -734,9 +734,9 @@ function showChannelBoir() {\n     var boirContainer = $('.js-boir-container');\n     var html = \"\";\n \n-    html += '<div class=\"boir-character\"><strong>Character:</strong> ' + channelBoirData.character + \"</div>\";\n-    html += '<div class=\"boir-floor\"><strong>Floor:</strong> ' + channelBoirData.floor + \"</div>\";\n-    html += '<div class=\"boir-seed\"><strong>Seed:</strong> ' + channelBoirData.seed + \"</div>\";\n+    html += '<div class=\"boir-character\"><strong>Character:</strong> ' + cleanHtmlText(channelBoirData.character) + \"</div>\";\n+    html += '<div class=\"boir-floor\"><strong>Floor:</strong> ' + cleanHtmlText(channelBoirData.floor) + \"</div>\";\n+    html += '<div class=\"boir-seed\"><strong>Seed:</strong> ' + cleanHtmlText(channelBoirData.seed) + \"</div>\";\n     html += '<h3>Items</h3>';\n \n     html += '<div class=\"well boir-items items-container\">';//<div class=\"row\">';\n@@ -754,13 +754,13 @@ function showChannelBoir() {\n     if (typeof channelBoirData.flyItems !== 'undefined' && typeof channelBoirData.flyProgress !== 'undefined') {\n         html += '<div class=\"col-md-6 text-center\">';\n         html += '<h3>Lord of the Flies</h3>';\n-        html += '<input type=\"text\" class=\"dial js-boir-dial js-boir-dial-fly\" value=\"' + channelBoirData.flyProgress + '\">';\n+        html += '<input type=\"text\" class=\"dial js-boir-dial js-boir-dial-fly\" value=\"' + cleanHtmlAttr(channelBoirData.flyProgress) + '\">';\n \n         // html += '<h4>Items</h4>';\n         html += '<div class=\"row\"><div class=\"col-sm-8 col-sm-offset-2\"><ul class=\"list-group\">'\n         for (var i = 0; i < channelBoirData.flyItems.length; i++) {\n             var item = channelBoirData.flyItems[i];\n-            html += '<li class=\"list-group-item\">' + item + '</li>';\n+            html += '<li class=\"list-group-item\">' + cleanHtmlText(item) + '</li>';\n         }\n         html += '</ul></div></div>';\n         html += '</div>';\n@@ -769,13 +769,13 @@ function showChannelBoir() {\n     if (typeof channelBoirData.guppyItems !== 'undefined' && typeof channelBoirData.guppyProgress !== 'undefined') {\n         html += '<div class=\"col-md-6 text-center\">';\n         html += '<h3>Guppy</h3>';\n-        html += '<input type=\"text\" class=\"dial js-boir-dial js-boir-dial-guppy\" value=\"' + channelBoirData.guppyProgress + '\">';\n+        html += '<input type=\"text\" class=\"dial js-boir-dial js-boir-dial-guppy\" value=\"' + cleanHtmlAttr(channelBoirData.guppyProgress) + '\">';\n \n         // html += '<h4>Items</h4>';\n         html += '<div class=\"row\"><div class=\"col-sm-8 col-sm-offset-2\"><ul class=\"list-group\">'\n         for (var i = 0; i < channelBoirData.guppyItems.length; i++) {\n             var item = channelBoirData.guppyItems[i];\n-            html += '<li class=\"list-group-item\">' + item + '</li>';\n+            html += '<li class=\"list-group-item\">' + cleanHtmlText(item) + '</li>';\n         }\n         html += '</ul></div></div>';\n     }\n@@ -965,6 +965,7 @@ function displayChannelReqsongs() {\n }\n \n function updateReqsongs() {\n+\treturn true; //temporary disable\n     $.ajax({\n         data: {\n             a: \"listReqsong\",\n@@ -1213,7 +1214,7 @@ $(document).ready(function() {\n     checkIfLiveChannel();\n     setInterval(checkIfLiveChannel, 30000);\n \n-    $(\".command\").prepend('<span class=\"command-prefix\">' + channelData.commandPrefix + '</span>');\n+    $(\".command\").prepend('<span class=\"command-prefix\">' + cleanHtmlText(channelData.commandPrefix) + '</span>');\n \n \n     var commandPrefixForUrl = channelData.commandPrefix;"
        },
        {
          "filename": "js/common.js",
          "status": "modified",
          "additions": 17,
          "deletions": 3,
          "patch": "@@ -24,6 +24,20 @@ function prettifyRegex(pattern) {\n     return pattern;\n }\n \n+var cleanHtmlTextMap = {\n+   \"&\": \"&amp;\",\n+   \"<\": \"&lt;\",\n+   \">\": \"&gt;\",\n+   '\"': '&quot;',\n+   \"'\": '&#39;',\n+   \"/\": '&#x2F;'\n+ };\n+\n+ function cleanHtmlText(string) {\n+    return String(string).replace(/[&<>\"'\\/]/g, function (s) {\n+        return cleanHtmlTextMap[s];\n+    });\n+ }\n function cleanHtmlAttr(val) {\n     return val.replace(/\"/g, \"&quot;\");\n }\n@@ -164,9 +178,9 @@ function updateIsLive(streams, channels) {\n         var popover = isLiveTitles[liveStatus];\n         if (liveStatus == isLiveOn) {\n             popover = '<div class=\"islive-popover\">';\n-            \n+\n             popover += '<img src=\"'+stream.preview.medium+'\" class=\"img-responsive\" height=\"180\" width=\"320\">';\n-            \n+\n             popover += '<i class=\"icon-gamepad\"></i> ' + ((stream.channel.game) ? stream.channel.game : \"Unknown\") + '<br>';\n             popover += '<i class=\"icon-user\"></i> ' + Humanize.intComma(stream.viewers) + '';\n             popover += '</div>';\n@@ -209,4 +223,4 @@ function sortUnorderedList(selector) {\n        return (compA < compB) ? -1 : (compA > compB) ? 1 : 0;\n     })\n     $.each(listitems, function(idx, itm) { mylist.append(itm); })\n-}\n\\ No newline at end of file\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c99e71264b3d03e9c43eeea113f823b3740b8e4f",
            "date": "2017-01-11T19:12:35Z",
            "author_login": "oxguy3"
          },
          {
            "sha": "2b4e75f313a59c506f98c90b0abd53467992771e",
            "date": "2017-01-02T21:08:35Z",
            "author_login": "oxguy3"
          },
          {
            "sha": "f951e44b8683203f3a04cdf3c9d9ed82abab55b1",
            "date": "2016-09-23T03:27:37Z",
            "author_login": "oxguy3"
          },
          {
            "sha": "4b009572d95473b781a3f90fad85709d55f6368e",
            "date": "2016-09-23T03:26:41Z",
            "author_login": "oxguy3"
          },
          {
            "sha": "c2a1a5647da085b3505df047470f502531b47b9e",
            "date": "2016-09-23T03:25:46Z",
            "author_login": "oxguy3"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in oxguy3 coebot-www and classified as problematic. This issue affects the function displayChannelCommands/displayChannelQuotes/displayChannelAutoreplies/showChannelHighlights/showChannelBoir of the file js/channel.js. The manipulation leads to cross site scripting. The attack may be initiated remotely. The patch is named c1a6c44092585da4236237e0e7da94ee2996a0ca. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217355.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-04T10:15:10.197",
    "last_modified": "2024-11-21T02:45:29.030",
    "fix_date": "2016-07-14T03:08:13Z"
  },
  "references": [
    {
      "url": "https://github.com/oxguy3/coebot-www/commit/c1a6c44092585da4236237e0e7da94ee2996a0ca",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217355",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217355",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oxguy3/coebot-www/commit/c1a6c44092585da4236237e0e7da94ee2996a0ca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217355",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217355",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.250127",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "coebot-www",
    "owner": "oxguy3",
    "created_at": "2014-12-05T06:36:08Z",
    "updated_at": "2024-12-28T19:48:07Z",
    "pushed_at": "2017-01-11T19:12:35Z",
    "size": 21270,
    "stars": 12,
    "forks": 5,
    "open_issues": 2,
    "watchers": 12,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 192566,
      "JavaScript": 77807,
      "CSS": 58702,
      "ApacheConf": 1380
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T23:03:57.085746"
  }
}