{
  "cve_id": "CVE-2016-15016",
  "github_data": {
    "repository": "mrtnmtth/joomla_mod_einsatz_stats",
    "fix_commit": "27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb",
    "related_commits": [
      "27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb",
      "27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb"
    ],
    "patch_url": "https://github.com/mrtnmtth/joomla_mod_einsatz_stats/commit/27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb.patch",
    "fix_commit_details": {
      "sha": "27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb",
      "commit_date": "2016-01-30T13:59:28Z",
      "author": {
        "login": "mrtnmtth",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "prevent SQL-injection",
        "length": 21,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "helper.php",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -20,17 +20,17 @@ public static function getStatsByType($year) {\n \t\tif (($year > $latest) or !(ctype_digit($year)))\n \t\t\t$year = $latest;\n \n+\t\t$db = JFactory::getDbo();\n \t\t$query =\n \t\t\t'SELECT arten.title AS label,\n \t\t\t\tcount(data1) AS value,\n \t\t\t\tarten.marker AS color\n \t\t\tFROM #__eiko_einsatzberichte AS berichte\n \t\t\tINNER JOIN #__eiko_einsatzarten AS arten\n \t\t\tON berichte.data1=arten.id\n-\t\t\tWHERE berichte.state=1 AND berichte.date1 LIKE \\''.$year.'%\\'\n+\t\t\tWHERE berichte.state=1 AND berichte.date1 LIKE '.$db->quote($year.'%').'\n \t\t\tGROUP BY data1\n \t\t\tORDER BY arten.ordering;';\n-\t\t\t//TODO mucho importante: Prevent SQL injection\n \t\t$result = self::executeQuery($query, 1);\n \t\tforeach ($result as $i) {\n \t\t\t$i->highlight = $i->color;\n@@ -43,7 +43,8 @@ public static function getStatsByType($year) {\n \tpublic static function getAjax() {\n \t\t// get data from Ajax request\n \t\t$input = JFactory::getApplication()->input;\n-\t\t$data = $input->get('data');\n+\t\t// only allow unsigned integers\n+\t\t$data = $input->get('data', date('Y'), 'UINT');\n \n \t\treturn json_encode(self::getStatsByType($data));\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c2afbd99ba302002ccd7eefbd0c4570509beab2e",
            "date": "2024-08-30T10:48:25Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "119680811c2462d84cb36f5db77e07863f82c3eb",
            "date": "2023-03-14T17:54:48Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c3bd7a445dece34fd0c10e99b2579629f03034da",
            "date": "2022-07-20T08:47:39Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "858ec106a97d17c006830a0850424894f642ccc0",
            "date": "2021-12-06T20:24:37Z",
            "author_login": "mrtnmtth"
          },
          {
            "sha": "06eea0fe4bac9193913c928aeb5d6734c48e2fa7",
            "date": "2021-12-01T21:12:49Z",
            "author_login": "mrtnmtth"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in mrtnmtth joomla_mod_einsatz_stats up to 0.2. It has been classified as critical. This affects the function getStatsByType of the file helper.php. The manipulation of the argument year leads to sql injection. Upgrading to version 0.3 is able to address this issue. The identifier of the patch is 27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb. It is recommended to upgrade the affected component. The identifier VDB-217653 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-08T18:15:10.117",
    "last_modified": "2024-11-21T02:45:30.093",
    "fix_date": "2016-01-30T13:59:28Z"
  },
  "references": [
    {
      "url": "https://github.com/mrtnmtth/joomla_mod_einsatz_stats/commit/27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mrtnmtth/joomla_mod_einsatz_stats/releases/tag/v0.3",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217653",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217653",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mrtnmtth/joomla_mod_einsatz_stats/commit/27c1b443cff45c81d9d7d926a74c76f8b6ffc6cb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mrtnmtth/joomla_mod_einsatz_stats/releases/tag/v0.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217653",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217653",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.532022",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "joomla_mod_einsatz_stats",
    "owner": "mrtnmtth",
    "created_at": "2014-02-02T12:35:54Z",
    "updated_at": "2024-09-01T07:29:42Z",
    "pushed_at": "2024-09-01T07:29:45Z",
    "size": 214,
    "stars": 0,
    "forks": 0,
    "open_issues": 0,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 7725,
      "JavaScript": 5427,
      "Shell": 1666
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T20:23:32.126546"
  }
}