{
  "cve_id": "CVE-2016-15024",
  "github_data": {
    "repository": "doomsider/shadow",
    "fix_commit": "3332c5ba9ec3014ddc74e2147190a050eee97bc0",
    "related_commits": [
      "3332c5ba9ec3014ddc74e2147190a050eee97bc0",
      "3332c5ba9ec3014ddc74e2147190a050eee97bc0"
    ],
    "patch_url": "https://github.com/doomsider/shadow/commit/3332c5ba9ec3014ddc74e2147190a050eee97bc0.patch",
    "fix_commit_details": {
      "sha": "3332c5ba9ec3014ddc74e2147190a050eee97bc0",
      "commit_date": "2016-06-10T02:02:06Z",
      "author": {
        "login": "doomsider",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed possible exploit, improved existing code",
        "length": 227,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 66,
        "additions": 29,
        "deletions": 37
      },
      "files": [
        {
          "filename": "core/core_loops.dtsd",
          "status": "modified",
          "additions": 7,
          "deletions": 5,
          "patch": "@@ -89,16 +89,16 @@ core_logloop() {\n \t\t\tIFS=$OLD_IFS\n # Reset the database so the same command is not read repeatedly \n \t\t\tmysql --defaults-extra-file=$CONFIGDTSD_INSTALLPATH/core/shadow.cnf -e \"truncate table COMMANDDB;\"\n-\t\t\tCOMMANDARRAY=0\n+\t\t\tPOSITIONCOMMANDARRAY=0\n \t\t\tPARAMETERARRAY=0\n # Go through each command and parameter received and execute them with eval\n-\t\t\twhile [ -n \"${RECIEVEDCOMMAND[$COMMANDARRAY]+set}\" ]\n+\t\t\twhile [ -n \"${RECIEVEDCOMMAND[$POSITIONCOMMANDARRAY]+set}\" ]\n \t\t\tdo\n-\t\t\t\tRECIEVEDCOMMAND=${RECIEVEDCOMMAND[$COMMANDARRAY]}\n+\t\t\t\tRECIEVEDCOMMAND=${RECIEVEDCOMMAND[$POSITIONCOMMANDARRAY]}\n \t\t\t\tRECIEVEDPARAMETER=${RECIEVEDPARAMETER[$PARAMETERARRAY]}\n \t\t\t\t#echo \"executing $RECIEVEDCOMMAND $RECIEVEDPARAMETER\"\n-\t\t\t\teval $RECIEVEDCOMMAND '$RECIEVEDPARAMETER'\n-\t\t\t\tlet COMMANDARRAY++\n+\t\t\t\t$RECIEVEDCOMMAND ${RECIEVEDPARAMETER}\n+\t\t\t\tlet POSITIONCOMMANDARRAY++\n \t\t\t\tlet PARAMETERARRAY++\n \t\t\tdone\n \t\tfi\n@@ -108,6 +108,8 @@ core_logloop() {\n \tfi\n \tdone\n }\n+# Trap is used here to restart logloop if it exits due to a bad call\n+# trap core_logloop EXIT\n core_makesearchdb() {\n # Make the search database which contains all the search strings and their related functions\n \tlog_myerasetable SEARCHDB"
        },
        {
          "filename": "modules/chatfunctions.dtsd",
          "status": "modified",
          "additions": 22,
          "deletions": 32,
          "patch": "@@ -32,11 +32,11 @@ chat_log() {\n \tCUTSTRING=${CUTSTRING#*=}\n # Remove everything after ] to get message\n \tMESSAGESTRING=${CUTSTRING%%]*}\n-\techo \"This was sent to chat log $@\"\n-\techo \"This was the message $MESSAGESTRING\"\n-\techo \"This was sender $SENDERNAME\"\n-\techo \"This was receiver $RECEIVERNAME\"\n-\techo \"This was receivertype $RECEIVERTYPE\"\n+\t#echo \"This was sent to chat log $@\"\n+\t#echo \"This was the message $MESSAGESTRING\"\n+\t#echo \"This was sender $SENDERNAME\"\n+\t#echo \"This was receiver $RECEIVERNAME\"\n+\t#echo \"This was receivertype $RECEIVERTYPE\"\n # [CHAT is error value for SENDERNAME\n \tmysql --defaults-extra-file=$CONFIGDTSD_INSTALLPATH/core/shadow.cnf -e \"INSERT INTO CHATLOG (SENDER, CHATSTRING, RECIEVER) VALUES (\\\"$SENDERNAME\\\",\\\"$MESSAGESTRING\\\",\\\"$RECEIVERNAME\\\");\"\n }\n@@ -75,39 +75,29 @@ chat_commands() {\n \t\tCOMMANDARRAY=($MESSAGECUT)\n \t\tUSERCOMMAND=${COMMANDARRAY[0]}\n \t\tUSERCOMMAND=${USERCOMMAND^^}\n+\t\tUSERCOMMAND=\"chatcommand_$USERCOMMAND\"\n \t\tUSERPARAMETERS=${COMMANDARRAY[@]:1}\n \t\techo \"User is $SENDERNAME\"\n \t\techo \"Command is $USERCOMMAND\"\n \t\techo ${#USERCOMMAND}\n \t\techo \"Parameters are $USERPARAMETERS\"\n-\t\techo \"List of chat commands $CHATCOMMANDS[@]\"\n-\t\tCHATCOMMANDARRAY=0\n-        COMMANDFOUND=false\n-\t\twhile [ -n \"${CHATCOMMANDS[$CHATCOMMANDARRAY]+set}\" ] \n-\t\tdo\n-            CURRENTCHATCOMMAND=${CHATCOMMANDS[$CHATCOMMANDARRAY]}\n-#\t\techo \"This is the current Chat Command $CURRENTCHATCOMMAND\"\n-            CUTCHATCOMMAND=${CURRENTCHATCOMMAND#*_}\n-#\t\techo \"This remove chatcommand to get only the command name $CUTCHATCOMMAND\"\n-            if [ \"$CUTCHATCOMMAND\" = \"$USERCOMMAND\" ]\n+\t\t#echo \"List of chat commands ${CHATCOMMANDS[@]}\"\n+\t\tif lib_arraycontains CHATCOMMANDS $USERCOMMAND\n+\t\tthen \n+\t\t\techo \"Chat command found\"\n+\t\t    USERCOMMAND=${USERCOMMAND#*_}\n+\t\t\tif check_player_rank_allowed $USERCOMMAND $SENDERNAME\n             then\n-                echo \"Chat Command found\"\n-                COMMANDFOUND=true\n-                if check_player_rank_allowed $USERCOMMAND $SENDERNAME\n-                then\n-                    eval $CURRENTCHATCOMMAND \"$SENDERNAME\" $USERPARAMETERS\n-                else\n-                    echo \"Command not authorized\"\n-                    lib_screensend $CONFIGDTSD_MAINSCREEN /pm $SENDERNAME \"You do not have permission to use that command!\"\n-                fi\n-                let CHATCOMMANDARRAY++\n+\t\t\t\tUSERCOMMAND=\"chatcommand_$USERCOMMAND\"\n+\t\t\t\t$USERCOMMAND \"$SENDERNAME\" $USERPARAMETERS\n             else\n-                let CHATCOMMANDARRAY++\n-            fi\n-\t\tdone\n-\t\tif [ $COMMANDFOUND = false ]\n-        then\n-            lib_screensend $CONFIGDTSD_MAINSCREEN /pm $SENDERNAME \"Unknown command. Please use !HELP for a list of the commands you can use\"\n-        fi\n+\t\t\t\techo \"Command not authorized\"\n+\t\t\t\tlib_screensend $CONFIGDTSD_MAINSCREEN /pm $SENDERNAME \"You do not have permission to use that command!\"\n+\t\t\tfi\n+        \n+\t\telse\n+\t\t\techo \"No matching chat command\"\n+\t\t\tlib_screensend $CONFIGDTSD_MAINSCREEN /pm $SENDERNAME \"Unknown command. Please use !HELP for a list of the commands you can use\"\n+\t\tfi\n \tfi\t\n }\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2bdf1c7c178f625f2bff9b435de56eeaca24673a",
            "date": "2016-06-23T07:19:59Z",
            "author_login": "doomsider"
          },
          {
            "sha": "d622db8af414691ef1e164ce06426a9052f11306",
            "date": "2016-09-10T06:54:31Z",
            "author_login": "thakyZ"
          },
          {
            "sha": "dff7f5718ad6456a8f56d68d1eadf8156e297d3b",
            "date": "2016-09-10T06:53:07Z",
            "author_login": "thakyZ"
          },
          {
            "sha": "78ca2df7777c920f5b9e69d99d1f5f017b6bc5be",
            "date": "2016-09-10T06:41:15Z",
            "author_login": "thakyZ"
          },
          {
            "sha": "4d52d76cc0b18c638c0a1cd5bebd8d01ba6e30c5",
            "date": "2016-09-10T05:20:10Z",
            "author_login": "invalid-email-address"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-404",
    "description": "A vulnerability was found in doomsider shadow. It has been classified as problematic. Affected is an unknown function. The manipulation leads to denial of service. Attacking locally is a requirement. The complexity of an attack is rather high. The exploitability is told to be difficult. Continious delivery with rolling releases is used by this product. Therefore, no version details of affected nor updated releases are available. The patch is identified as 3332c5ba9ec3014ddc74e2147190a050eee97bc0. It is recommended to apply a patch to fix this issue. VDB-221478 is the identifier assigned to this vulnerability.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-02-19T18:15:10.067",
    "last_modified": "2024-11-21T02:45:31.213",
    "fix_date": "2016-06-10T02:02:06Z"
  },
  "references": [
    {
      "url": "https://github.com/doomsider/shadow/commit/3332c5ba9ec3014ddc74e2147190a050eee97bc0",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.221478",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.221478",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/doomsider/shadow/commit/3332c5ba9ec3014ddc74e2147190a050eee97bc0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.221478",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.221478",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.079776",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "shadow",
    "owner": "doomsider",
    "created_at": "2014-10-31T22:56:31Z",
    "updated_at": "2020-11-22T13:19:28Z",
    "pushed_at": "2016-09-11T00:14:18Z",
    "size": 427,
    "stars": 8,
    "forks": 3,
    "open_issues": 2,
    "watchers": 8,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Shell": 296386
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:50:40.450226"
  }
}