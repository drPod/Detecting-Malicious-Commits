{
  "cve_id": "CVE-2016-15030",
  "github_data": {
    "repository": "Arno0x/TwoFactorAuth",
    "fix_commit": "8549ad3cf197095f783643e41333586d6a4d0e54",
    "related_commits": [
      "8549ad3cf197095f783643e41333586d6a4d0e54",
      "8549ad3cf197095f783643e41333586d6a4d0e54"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8549ad3cf197095f783643e41333586d6a4d0e54",
      "commit_date": "2016-01-27T22:15:48Z",
      "author": {
        "login": "crackedeggs1",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "cross-site ?from can be used for phishing",
        "length": 319,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "login/login.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -84,8 +84,12 @@\n \t        \n \t        //--------------------------------------------------\n \t        // Checking which URL we should redirect the user to\n-\t        if (isset($_POST[\"from\"])) {\n-\t        \t$from = urldecode($_POST[\"from\"]);\n+\t        if (isset($_GET['from'])) {\n+\t        \t$from = $_GET['from'];\n+\t\t\tif (preg_match('#^(?:https?:)?//#', $_GET['from'], $m)) {\n+\t\t\t\t$url = parse_url($_GET['from']);\n+\t\t\t\t$from = $url['path'] . (!empty($url['query']) ? '?' . $url['query'] : '') . (!empty($url['fragment']) ? '#' . $url['fragment'] : '');\n+\t\t\t}\n \t            $redirectTo = ((isset($_SERVER[\"HTTPS\"]) && $_SERVER[\"HTTPS\"] === \"on\")? \"https://\" : \"http://\").$_SERVER[\"SERVER_NAME\"].\":\".$_SERVER[\"SERVER_PORT\"].$from;\n \t        }\n \t        else {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3539ca5b250a4acca8401b4f2cb7af2aae8baff0",
            "date": "2020-04-24T12:27:26Z",
            "author_login": "Arno0x"
          },
          {
            "sha": "7a7adb021ab44c6b204005c7c13f6d4ddc504671",
            "date": "2020-04-24T03:43:53Z",
            "author_login": "oakwhiz"
          },
          {
            "sha": "2a8bdb0fd71d3488bb4d17d9b9adc7c02009e470",
            "date": "2016-02-13T18:03:54Z",
            "author_login": "Arno0x"
          },
          {
            "sha": "2f365f709b7931059435e78b7f9b542056b08356",
            "date": "2016-02-13T18:02:34Z",
            "author_login": "Arno0x"
          },
          {
            "sha": "43535441857d8219606d101badca510691e4e8be",
            "date": "2016-01-29T15:10:54Z",
            "author_login": "Arno0x"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-601",
    "description": "A vulnerability classified as problematic has been found in Arno0x TwoFactorAuth. This affects an unknown part of the file login/login.php. The manipulation of the argument from leads to open redirect. It is possible to initiate the attack remotely. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The patch is named 8549ad3cf197095f783643e41333586d6a4d0e54. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-223803.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-25T18:15:09.467",
    "last_modified": "2024-11-21T02:45:32.050",
    "fix_date": "2016-01-27T22:15:48Z"
  },
  "references": [
    {
      "url": "https://github.com/Arno0x/TwoFactorAuth/commit/8549ad3cf197095f783643e41333586d6a4d0e54",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Arno0x/TwoFactorAuth/pull/3",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.223803",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.223803",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Arno0x/TwoFactorAuth/commit/8549ad3cf197095f783643e41333586d6a4d0e54",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Arno0x/TwoFactorAuth/pull/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.223803",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.223803",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.009094",
    "processing_status": "enhanced"
  }
}