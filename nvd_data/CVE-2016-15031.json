{
  "cve_id": "CVE-2016-15031",
  "github_data": {
    "repository": "ipoelnet/php-login",
    "fix_commit": "0083ec652786ddbb81335ea20da590df40035679",
    "related_commits": [
      "0083ec652786ddbb81335ea20da590df40035679",
      "0083ec652786ddbb81335ea20da590df40035679"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "0083ec652786ddbb81335ea20da590df40035679",
      "commit_date": "2016-01-10T01:14:32Z",
      "author": {
        "login": "itmox",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added sqlInjection prevention.",
        "length": 601,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
      },
      "files": [
        {
          "filename": "login/scripts/class.loginscript.php",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -28,6 +28,8 @@ public function emailPull($id) {\n \n \t\t//Queries database\n \t\t$estmt = $edb->conn->query(\"SELECT email, username FROM $tbl_name WHERE id = '$id'\");\n+            //http://www.w3schools.com/php/php_mysql_prepared_statements.asp\n+        \n \n \t\t$eresult = $estmt->fetch(PDO::FETCH_ASSOC);\n \n@@ -52,7 +54,11 @@ public function checkLogin($tbl_name, $myusername, $mypassword) {\n \t\t\t$err = \"Error: \" . $e->getMessage();\n \t\t}\n \n-\t\t$stmt = $stmt = $db->conn->query(\"SELECT * FROM $tbl_name WHERE username='$myusername'\");\n+\t\t$stmt = $stmt = $db->conn->prepare(\"SELECT * FROM $tbl_name WHERE username= :myusername\");\n+        $stmt->bindParm(':myusername', $myusrname);\n+        $myusrname = $myusername;\n+        stmt->execute();\n+        \n \n \t\t// Gets query result\n \t\t$result = $stmt->fetch(PDO::FETCH_ASSOC);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fa6e9a057028d8d5304f014e517641dc31d81d7a",
            "date": "2017-04-20T00:41:50Z",
            "author_login": "fethica"
          },
          {
            "sha": "5d4a59397b081627815df316dd65c7dd86043a66",
            "date": "2017-04-18T05:29:32Z",
            "author_login": "bryant1410"
          },
          {
            "sha": "0c6bb5743ccdcf381edec9b76eee5683aacd80e7",
            "date": "2016-12-27T16:04:32Z",
            "author_login": "fethica"
          },
          {
            "sha": "ad7d7909dcfa29e97af7fd9a2e8b46210dcd5e3d",
            "date": "2016-12-21T04:23:34Z",
            "author_login": "therecluse26"
          },
          {
            "sha": "fbd8149ebbda698b8541ff69f15f6c3574fcc998",
            "date": "2016-12-20T22:45:58Z",
            "author_login": "JanPetterMG"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in PHP-Login 1.0. It has been declared as critical. This vulnerability affects the function checkLogin of the file login/scripts/class.loginscript.php of the component POST Parameter Handler. The manipulation of the argument myusername leads to sql injection. The attack can be initiated remotely. Upgrading to version 2.0 is able to address this issue. The patch is identified as 0083ec652786ddbb81335ea20da590df40035679. It is recommended to upgrade the affected component. VDB-228022 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-06T01:15:08.827",
    "last_modified": "2024-11-21T02:45:32.190",
    "fix_date": "2016-01-10T01:14:32Z"
  },
  "references": [
    {
      "url": "https://github.com/ipoelnet/php-login/commit/0083ec652786ddbb81335ea20da590df40035679",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipoelnet/php-login/releases/tag/v2.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.228022",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.228022",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ipoelnet/php-login/commit/0083ec652786ddbb81335ea20da590df40035679",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipoelnet/php-login/releases/tag/v2.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.228022",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.228022",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:32.931941",
    "processing_status": "enhanced"
  }
}