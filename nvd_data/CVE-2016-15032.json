{
  "cve_id": "CVE-2016-15032",
  "github_data": {
    "repository": "mback2k/mh_httpbl",
    "fix_commit": "a754bf306a433a8c18b55e25595593e8f19b9463",
    "related_commits": [
      "a754bf306a433a8c18b55e25595593e8f19b9463",
      "a754bf306a433a8c18b55e25595593e8f19b9463"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a754bf306a433a8c18b55e25595593e8f19b9463",
      "commit_date": "2016-05-26T15:43:09Z",
      "author": {
        "login": "mback2k",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix possible Cross-Site Scripting by escaping remote addr and host",
        "length": 119,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "class.tx_mhhttpbl.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -138,12 +138,16 @@ function stopOutput() {\n \t\t\tt3lib_div::devlog('blocking user: ' . $_SERVER['REMOTE_ADDR'], $this->extKey, 1);\r\n \r\n \t\t$remote_addr = $_SERVER['REMOTE_ADDR'];\r\n+\t\t$remote_host = gethostbyaddr($remote_addr);\r\n+\t\t$remote_addr_html = htmlspecialchars($remote_addr);\r\n+\t\t$remote_host_html = htmlspecialchars($remote_host);\r\n+\r\n \t\t$GLOBALS['TYPO3_DB']->exec_INSERTquery('tx_mhhttpbl_blocklog', array('crdate'=>time(), 'tstamp'=>time(), 'block_ip'=>$remote_addr, 'block_type'=>$this->type, 'block_score'=>$this->score));\r\n \r\n \t\t$usrHash = t3lib_div::shortMD5(serialize($_SERVER));\r\n \t\t$stdMsg = \"<strong>You have been blocked.</strong><br />Your IP appears to be on the httpbl.org/projecthoneypot.org blacklist.<br /><br />###REQUEST_IP###<br /><br />###USER_TYPE###\";\r\n \t\t$message = (!empty($this->config['message']) ? $stdMsg : $this->pObj->csConvObj->utf8_encode($message, $this->pObj->renderCharset));\r\n-\t\t$message = str_replace('###REQUEST_IP###', '<strong>' . $remote_addr . '</strong> (' . gethostbyaddr($remote_addr) . ')', $message);\r\n+\t\t$message = str_replace('###REQUEST_IP###', '<strong>' . $remote_addr_html . '</strong> (' . $remote_host_html . ')', $message);\r\n \t\t$message = str_replace('###USER_TYPE###', $this->codes[$this->type], $message);\r\n \r\n \t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_hash', $usrHash);\r\n@@ -230,4 +234,4 @@ function addHoneyPot(&$params, &$pObj) {\n \tinclude_once($TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['ext/mh_httpbl/class.tx_mhhttpbl.php']);\r\n }\r\n \r\n-?>\n\\ No newline at end of file\n+?>\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e38312eaee8624d8a18ade807ae109331cf2bce2",
            "date": "2016-07-30T09:43:27Z",
            "author_login": "mback2k"
          },
          {
            "sha": "de27b80d9c769df2de754df1166a3565fed12a0e",
            "date": "2016-07-30T09:34:54Z",
            "author_login": "mback2k"
          },
          {
            "sha": "ecafb11221dcd8758dd8205de12b7c67a3af0727",
            "date": "2016-06-01T22:36:37Z",
            "author_login": "mback2k"
          },
          {
            "sha": "59d002d259c154c0134d8a8df79d6714368828c8",
            "date": "2016-05-28T03:40:10Z",
            "author_login": "mback2k"
          },
          {
            "sha": "22aed509a3ccfb58cb3709e049214f4f455295b4",
            "date": "2016-05-28T03:39:21Z",
            "author_login": "mback2k"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in mback2k mh_httpbl Extension up to 1.1.7 on TYPO3. This affects the function stopOutput of the file class.tx_mhhttpbl.php. The manipulation of the argument $_SERVER['REMOTE_ADDR'] leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.1.8 is able to address this issue. The patch is named a754bf306a433a8c18b55e25595593e8f19b9463. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-230391. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-02T00:15:09.443",
    "last_modified": "2024-11-21T02:45:32.347",
    "fix_date": "2016-05-26T15:43:09Z"
  },
  "references": [
    {
      "url": "https://github.com/mback2k/mh_httpbl/commit/a754bf306a433a8c18b55e25595593e8f19b9463",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mback2k/mh_httpbl/releases/tag/mh_httpbl_1.1.8_security",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.230391",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.230391",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mback2k/mh_httpbl/commit/a754bf306a433a8c18b55e25595593e8f19b9463",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mback2k/mh_httpbl/releases/tag/mh_httpbl_1.1.8_security",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.230391",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.230391",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.294455",
    "processing_status": "enhanced"
  }
}