{
  "cve_id": "CVE-2016-15036",
  "github_data": {
    "repository": "deis/workflow-manager",
    "fix_commit": "31fe3bccbdde134a185752e53380330d16053f7f",
    "related_commits": [
      "31fe3bccbdde134a185752e53380330d16053f7f",
      "31fe3bccbdde134a185752e53380330d16053f7f"
    ],
    "patch_url": "https://github.com/deis/workflow-manager/commit/31fe3bccbdde134a185752e53380330d16053f7f.patch",
    "fix_commit_details": {
      "sha": "31fe3bccbdde134a185752e53380330d16053f7f",
      "commit_date": "2016-08-11T21:54:43Z",
      "author": {
        "login": "jackfrancis",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "cluster_id is vulnerable to race condition when called concurrently (#94)",
        "length": 418,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "boot.go",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -47,6 +47,7 @@ func main() {\n \n \tsvPeriodic := jobs.NewSendVersionsPeriodic(\n \t\tapiClient,\n+\t\tclusterID,\n \t\tdeisK8sResources,\n \t\tavailableVersion,\n \t\tpollDur,"
        },
        {
          "filename": "data/cluster_id.go",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -51,6 +51,8 @@ func NewClusterIDFromPersistentStorage(sgc k8s.KubeSecretGetterCreator) ClusterI\n \n // Get is the ClusterID interface implementation\n func (c clusterIDFromPersistentStorage) Get() (string, error) {\n+\tc.rwm.Lock()\n+\tdefer c.rwm.Unlock()\n \tsecret, err := c.secretGetterCreator.Get(wfmSecretName)\n \t//If we don't have the secret we shouldn't be returning error and instead a create a new one\n \tif err != nil && !apierrors.IsNotFound(err) {"
        },
        {
          "filename": "jobs/jobs.go",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -22,6 +22,7 @@ type Periodic interface {\n // SendVersions fulfills the Periodic interface\n type sendVersions struct {\n \tk8sResources      *k8s.ResourceInterfaceNamespaced\n+\tclusterID         data.ClusterID\n \tapiClient         *apiclient.WorkflowManager\n \tavailableVersions data.AvailableVersions\n \tfrequency         time.Duration\n@@ -30,12 +31,14 @@ type sendVersions struct {\n // NewSendVersionsPeriodic creates a new SendVersions using sgc and rcl as the the secret getter / creator and replication controller lister implementations (respectively)\n func NewSendVersionsPeriodic(\n \tapiClient *apiclient.WorkflowManager,\n+\tclusterID data.ClusterID,\n \tri *k8s.ResourceInterfaceNamespaced,\n \tavailableVersions data.AvailableVersions,\n \tfrequency time.Duration,\n ) Periodic {\n \treturn &sendVersions{\n \t\tk8sResources:      ri,\n+\t\tclusterID:         clusterID,\n \t\tapiClient:         apiClient,\n \t\tavailableVersions: availableVersions,\n \t\tfrequency:         frequency,\n@@ -45,7 +48,7 @@ func NewSendVersionsPeriodic(\n // Do is the Periodic interface implementation\n func (s sendVersions) Do() error {\n \tif config.Spec.CheckVersions {\n-\t\terr := sendVersionsImpl(s.apiClient, s.k8sResources, s.availableVersions)\n+\t\terr := sendVersionsImpl(s.apiClient, s.clusterID, s.k8sResources, s.availableVersions)\n \t\tif err != nil {\n \t\t\treturn err\n \t\t}\n@@ -135,12 +138,13 @@ func DoPeriodic(pSlice []Periodic) chan<- struct{} {\n //  sendVersions sends cluster version data\n func sendVersionsImpl(\n \tapiClient *apiclient.WorkflowManager,\n+\tclusterID data.ClusterID,\n \tk8sResources *k8s.ResourceInterfaceNamespaced,\n \tavailableVersions data.AvailableVersions,\n ) error {\n \tcluster, err := data.GetCluster(\n \t\tdata.NewInstalledDeisData(k8sResources),\n-\t\tdata.NewClusterIDFromPersistentStorage(k8sResources.Secrets()),\n+\t\tclusterID,\n \t\tdata.NewLatestReleasedComponent(k8sResources, availableVersions),\n \t)\n \tif err != nil {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "990b2050b70e651b4dd3eac76b1bc57f6faca127",
            "date": "2018-02-27T20:24:30Z",
            "author_login": "mboersma"
          },
          {
            "sha": "84bb3389ab4043299925ac33904d9e758060b881",
            "date": "2018-02-27T20:11:36Z",
            "author_login": "mboersma"
          },
          {
            "sha": "3ed81960bef0eea133f7c151023f410d8d001727",
            "date": "2017-08-22T21:02:55Z",
            "author_login": "mboersma"
          },
          {
            "sha": "9df899cbaac2985cbfada7eb7318242d2be88d20",
            "date": "2017-05-11T20:57:16Z",
            "author_login": "sgoings"
          },
          {
            "sha": "34d4a6835c40cc4b44873b270fab96500a6d6760",
            "date": "2017-05-10T23:00:01Z",
            "author_login": "sgoings"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-362",
    "description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability was found in Deis Workflow Manager up to 2.3.2. It has been classified as problematic. This affects an unknown part. The manipulation leads to race condition. The complexity of an attack is rather high. The exploitability is told to be difficult. Upgrading to version 2.3.3 is able to address this issue. The patch is named 31fe3bccbdde134a185752e53380330d16053f7f. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-248847. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-12-23T20:15:37.930",
    "last_modified": "2024-11-21T02:45:32.943",
    "fix_date": "2016-08-11T21:54:43Z"
  },
  "references": [
    {
      "url": "https://github.com/deis/workflow-manager/commit/31fe3bccbdde134a185752e53380330d16053f7f",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/deis/workflow-manager/pull/94",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/deis/workflow-manager/releases/tag/v2.3.3",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.248847",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.248847",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/deis/workflow-manager/commit/31fe3bccbdde134a185752e53380330d16053f7f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/deis/workflow-manager/pull/94",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/deis/workflow-manager/releases/tag/v2.3.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.248847",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.248847",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.096694",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "workflow-manager",
    "owner": "deis",
    "created_at": "2016-02-09T21:56:20Z",
    "updated_at": "2022-11-22T04:30:10Z",
    "pushed_at": "2018-02-27T20:24:31Z",
    "size": 169,
    "stars": 14,
    "forks": 15,
    "open_issues": 11,
    "watchers": 14,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Go": 176322,
      "Makefile": 2338,
      "Shell": 868
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:27:19.815711"
  }
}