{
  "cve_id": "CVE-2016-2347",
  "github_data": {
    "repository": "fragglet/lhasa",
    "fix_commit": "6fcdb8f1f538b9d63e63a5fa199c5514a15d4564",
    "related_commits": [
      "6fcdb8f1f538b9d63e63a5fa199c5514a15d4564",
      "6fcdb8f1f538b9d63e63a5fa199c5514a15d4564"
    ],
    "patch_url": "https://github.com/fragglet/lhasa/commit/6fcdb8f1f538b9d63e63a5fa199c5514a15d4564.patch",
    "fix_commit_details": {
      "sha": "6fcdb8f1f538b9d63e63a5fa199c5514a15d4564",
      "commit_date": "2016-03-17T04:40:19Z",
      "author": {
        "login": "fragglet",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix integer underflow vulnerability in L3 decode.",
        "length": 409,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/lha_file_header.c",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -351,6 +351,10 @@ static uint8_t *extend_raw_data(LHAFileHeader **header,\n \tsize_t new_raw_len;\n \tuint8_t *result;\n \n+\tif (nbytes > LEVEL_3_MAX_HEADER_LEN) {\n+\t\treturn NULL;\n+\t}\n+\n \t// Reallocate the header and raw_data area to be larger.\n \n \tnew_raw_len = RAW_DATA_LEN(header) + nbytes;\n@@ -797,7 +801,8 @@ static int decode_level3_header(LHAFileHeader **header, LHAInputStream *stream)\n \n \theader_len = lha_decode_uint32(&RAW_DATA(header, 24));\n \n-\tif (header_len > LEVEL_3_MAX_HEADER_LEN) {\n+\tif (header_len > LEVEL_3_MAX_HEADER_LEN\n+\t || header_len < RAW_DATA_LEN(header)) {\n \t\treturn 0;\n \t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "efae4bbffe0e87515199ba9123ccb77b42173e17",
            "date": "2024-12-18T02:46:42Z",
            "author_login": "fragglet"
          },
          {
            "sha": "d44347a557bfb3bafa8903b5bf47428f507dd4b1",
            "date": "2024-12-18T02:46:06Z",
            "author_login": "fragglet"
          },
          {
            "sha": "e6c35329360f147a8dd5d005b3f7fac14f2d3b9d",
            "date": "2024-12-18T02:44:34Z",
            "author_login": "fragglet"
          },
          {
            "sha": "b892d780df9dd587a78af7c7a0c03a34c9d2ddf5",
            "date": "2024-12-18T02:13:10Z",
            "author_login": "fragglet"
          },
          {
            "sha": "f6d6ef35c70b8b9d1ff03c2acde9e54d4d6e50ba",
            "date": "2024-12-18T02:09:58Z",
            "author_login": "fragglet"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "Integer underflow in the decode_level3_header function in lib/lha_file_header.c in Lhasa before 0.3.1 allows remote attackers to execute arbitrary code via a crafted archive.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-04-21T20:59:00.557",
    "last_modified": "2024-11-21T02:48:16.317",
    "fix_date": "2016-03-17T04:40:19Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-04/msg00038.html",
      "source": "cret@cert.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-04/msg00039.html",
      "source": "cret@cert.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3540",
      "source": "cret@cert.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.talosintelligence.com/reports/TALOS-2016-0095/",
      "source": "cret@cert.org",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fragglet/lhasa/commit/6fcdb8f1f538b9d63e63a5fa199c5514a15d4564",
      "source": "cret@cert.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fragglet/lhasa/releases/tag/v0.3.1",
      "source": "cret@cert.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-04/msg00038.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-04/msg00039.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3540",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.talosintelligence.com/reports/TALOS-2016-0095/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fragglet/lhasa/commit/6fcdb8f1f538b9d63e63a5fa199c5514a15d4564",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fragglet/lhasa/releases/tag/v0.3.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.869898",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lhasa",
    "owner": "fragglet",
    "created_at": "2011-04-28T20:31:32Z",
    "updated_at": "2024-12-18T02:54:04Z",
    "pushed_at": "2024-12-27T05:42:35Z",
    "size": 3827,
    "stars": 88,
    "forks": 17,
    "open_issues": 14,
    "watchers": 88,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 342399,
      "Shell": 84805,
      "Python": 6399,
      "Makefile": 5279,
      "M4": 1902
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "isc"
    },
    "collected_at": "2025-01-14T16:54:20.366750"
  }
}