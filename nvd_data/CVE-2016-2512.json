{
  "cve_id": "CVE-2016-2512",
  "github_data": {
    "repository": "django/django",
    "fix_commit": "c5544d289233f501917e25970c03ed444abbd4f0",
    "related_commits": [
      "c5544d289233f501917e25970c03ed444abbd4f0",
      "c5544d289233f501917e25970c03ed444abbd4f0"
    ],
    "patch_url": "https://github.com/django/django/commit/c5544d289233f501917e25970c03ed444abbd4f0.patch",
    "fix_commit_details": {
      "sha": "c5544d289233f501917e25970c03ed444abbd4f0",
      "commit_date": "2016-02-22T21:47:01Z",
      "author": {
        "login": "mstriemer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed CVE-2016-2512 -- Prevented spoofing is_safe_url() with basic auth.",
        "length": 97,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 52,
        "additions": 50,
        "deletions": 2
      },
      "files": [
        {
          "filename": "django/utils/http.py",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -290,8 +290,12 @@ def is_safe_url(url, host=None):\n         url = url.strip()\n     if not url:\n         return False\n-    # Chrome treats \\ completely as /\n-    url = url.replace('\\\\', '/')\n+    # Chrome treats \\ completely as / in paths but it could be part of some\n+    # basic auth credentials so we need to check both URLs.\n+    return _is_safe_url(url, host) and _is_safe_url(url.replace('\\\\', '/'), host)\n+\n+\n+def _is_safe_url(url, host):\n     # Chrome considers any URL with more than two slashes to be absolute, but\n     # urlparse is not so flexible. Treat any url with three slashes as unsafe.\n     if url.startswith('///'):"
        },
        {
          "filename": "docs/releases/1.8.10.txt",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -6,6 +6,22 @@ Django 1.8.10 release notes\n \n Django 1.8.10 fixes two security issues and several bugs in 1.8.9.\n \n+CVE-2016-2512: Malicious redirect and possible XSS attack via user-supplied redirect URLs containing basic auth\n+===============================================================================================================\n+\n+Django relies on user input in some cases (e.g.\n+:func:`django.contrib.auth.views.login` and :doc:`i18n </topics/i18n/index>`)\n+to redirect the user to an \"on success\" URL. The security check for these\n+redirects (namely ``django.utils.http.is_safe_url()``) considered some URLs\n+with basic authentication credentials \"safe\" when they shouldn't be.\n+\n+For example, a URL like ``http://mysite.example.com\\@attacker.com`` would be\n+considered safe if the request's host is ``http://mysite.example.com``, but\n+redirecting to this URL sends the user to ``attacker.com``.\n+\n+Also, if a developer relies on ``is_safe_url()`` to provide safe redirect\n+targets and puts such a URL into a link, they could suffer from an XSS attack.\n+\n Bugfixes\n ========\n "
        },
        {
          "filename": "docs/releases/1.9.3.txt",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -6,6 +6,22 @@ Django 1.9.3 release notes\n \n Django 1.9.3 fixes two security issues and several bugs in 1.9.2.\n \n+CVE-2016-2512: Malicious redirect and possible XSS attack via user-supplied redirect URLs containing basic auth\n+===============================================================================================================\n+\n+Django relies on user input in some cases (e.g.\n+:func:`django.contrib.auth.views.login` and :doc:`i18n </topics/i18n/index>`)\n+to redirect the user to an \"on success\" URL. The security check for these\n+redirects (namely ``django.utils.http.is_safe_url()``) considered some URLs\n+with basic authentication credentials \"safe\" when they shouldn't be.\n+\n+For example, a URL like ``http://mysite.example.com\\@attacker.com`` would be\n+considered safe if the request's host is ``http://mysite.example.com``, but\n+redirecting to this URL sends the user to ``attacker.com``.\n+\n+Also, if a developer relies on ``is_safe_url()`` to provide safe redirect\n+targets and puts such a URL into a link, they could suffer from an XSS attack.\n+\n Bugfixes\n ========\n "
        },
        {
          "filename": "tests/utils_tests/test_http.py",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -97,6 +97,11 @@ def test_is_safe_url(self):\n                         'javascript:alert(\"XSS\")',\n                         '\\njavascript:alert(x)',\n                         '\\x08//example.com',\n+                        r'http://otherserver\\@example.com',\n+                        r'http:\\\\testserver\\@example.com',\n+                        r'http://testserver\\me:pass@example.com',\n+                        r'http://testserver\\@example.com',\n+                        r'http:\\\\testserver\\confirm\\me@example.com',\n                         '\\n'):\n             self.assertFalse(http.is_safe_url(bad_url, host='testserver'), \"%s should be blocked\" % bad_url)\n         for good_url in ('/view/?param=http://example.com',\n@@ -106,8 +111,15 @@ def test_is_safe_url(self):\n                      'https://testserver/',\n                      'HTTPS://testserver/',\n                      '//testserver/',\n+                     'http://testserver/confirm?email=me@example.com',\n                      '/url%20with%20spaces/'):\n             self.assertTrue(http.is_safe_url(good_url, host='testserver'), \"%s should be allowed\" % good_url)\n+        # Valid basic auth credentials are allowed.\n+        self.assertTrue(http.is_safe_url(r'http://user:pass@testserver/', host='user:pass@testserver'))\n+        # A path without host is allowed.\n+        self.assertTrue(http.is_safe_url('/confirm/me@example.com'))\n+        # Basic auth without host is not allowed.\n+        self.assertFalse(http.is_safe_url(r'http://testserver\\@example.com'))\n \n     def test_urlsafe_base64_roundtrip(self):\n         bytestring = b'foo'"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b721f127603516c75ebda6912046ff5f0694e150",
            "date": "2024-10-11T11:44:12Z",
            "author_login": "sarahboyce"
          },
          {
            "sha": "d206d4c200d71c0847e7f6720d88c587e7b46843",
            "date": "2025-01-01T20:27:52Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "f07360e8087d3b403d1d12ff696da3138116055a",
            "date": "2025-01-14T03:04:33Z",
            "author_login": "charettes"
          },
          {
            "sha": "161e79d277ffe8b79b15ad51cb0d23de54270202",
            "date": "2025-01-13T18:55:41Z",
            "author_login": "charettes"
          },
          {
            "sha": "4bfec242b488b174f7d386ab5bbd3363751cdb93",
            "date": "2025-01-13T18:53:57Z",
            "author_login": "charettes"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "The utils.http.is_safe_url function in Django before 1.8.10 and 1.9.x before 1.9.3 allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks or possibly conduct cross-site scripting (XSS) attacks via a URL containing basic authentication, as demonstrated by http://mysite.example.com\\@attacker.com.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-04-08T15:59:06.183",
    "last_modified": "2024-11-21T02:48:35.683",
    "fix_date": "2016-02-22T21:47:01Z"
  },
  "references": [
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0502.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0504.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0505.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0506.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3544",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.oracle.com/technetwork/topics/security/bulletinapr2016-2952098.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/83879",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1035152",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2915-1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2915-2",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2915-3",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/c5544d289233f501917e25970c03ed444abbd4f0",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.djangoproject.com/weblog/2016/mar/01/security-releases/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0502.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0504.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0505.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-0506.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3544",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.oracle.com/technetwork/topics/security/bulletinapr2016-2952098.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/83879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1035152",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2915-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2915-2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-2915-3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/c5544d289233f501917e25970c03ed444abbd4f0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.djangoproject.com/weblog/2016/mar/01/security-releases/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:40.218803",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "django",
    "owner": "django",
    "created_at": "2012-04-28T02:47:18Z",
    "updated_at": "2025-01-14T13:27:58Z",
    "pushed_at": "2025-01-14T11:34:55Z",
    "size": 264981,
    "stars": 81851,
    "forks": 32045,
    "open_issues": 301,
    "watchers": 81851,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "stable/0.90.x",
      "stable/0.91.x",
      "stable/0.95.x",
      "stable/0.96.x",
      "stable/1.0.x",
      "stable/1.1.x",
      "stable/1.2.x",
      "stable/1.3.x",
      "stable/1.4.x",
      "stable/1.5.x",
      "stable/1.6.x",
      "stable/1.7.x",
      "stable/1.8.x",
      "stable/1.9.x",
      "stable/1.10.x",
      "stable/1.11.x",
      "stable/2.0.x",
      "stable/2.1.x",
      "stable/2.2.x",
      "stable/3.0.x",
      "stable/3.1.x",
      "stable/3.2.x",
      "stable/4.0.x",
      "stable/4.1.x",
      "stable/4.2.x",
      "stable/5.0.x",
      "stable/5.1.x"
    ],
    "languages": {
      "Python": 17607947,
      "HTML": 250858,
      "JavaScript": 158876,
      "CSS": 92030,
      "Smarty": 392,
      "Procfile": 47
    },
    "commit_activity": {
      "total_commits_last_year": 938,
      "avg_commits_per_week": 18.03846153846154,
      "days_active_last_year": 299
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:28:27.491590"
  }
}