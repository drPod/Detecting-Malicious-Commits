{
  "cve_id": "CVE-2016-4445",
  "github_data": {
    "repository": "fedora-selinux/setroubleshoot",
    "fix_commit": "2d12677629ca319310f6263688bb1b7f676c01b7",
    "related_commits": [
      "2d12677629ca319310f6263688bb1b7f676c01b7",
      "2d12677629ca319310f6263688bb1b7f676c01b7"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2d12677629ca319310f6263688bb1b7f676c01b7",
      "commit_date": "2015-04-09T12:08:14Z",
      "author": {
        "login": "bachradsusi",
        "type": "User",
        "stats": {
          "total_commits": 219,
          "average_weekly_commits": 0.2923898531375167,
          "total_additions": 184951,
          "total_deletions": 302309,
          "weeks_active": 71
        }
      },
      "commit_message": {
        "title": "framework: get rid of commands.getstatusoutput()",
        "length": 48,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 10,
        "deletions": 7
      },
      "files": [
        {
          "filename": "framework/src/sealert",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -141,7 +141,7 @@ def fix_lookup_id(local_id, analysis_id):\n         async_rpc.add_errback(query_alerts_error)\n \n     def query_alerts_callback(sigs):\n-        import commands\n+        import subprocess\n         for siginfo in sigs.signature_list:\n             for plugin  in siginfo.plugin_list:\n                 if analysis_id == plugin.analysis_id:\n@@ -151,12 +151,12 @@ def fix_lookup_id(local_id, analysis_id):\n                         cl.main_loop.quit()\n                         return\n                     siginfo.update_derived_template_substitutions()\n-                    command = siginfo.substitute(p.get_fix_cmd(siginfo.audit_event, plugin.args))\n-                    rc, output = commands.getstatusoutput(command)\n-                    if rc == 0:\n-                        print _(\"Successfully ran %s\" % command)\n-                    else:\n-                        print output\n+                    command = siginfo.substitute_array(p.get_fix_cmd(siginfo.audit_event, plugin.args).split())\n+                    try:\n+                        output = subprocess.check_output(command)\n+                        print _(\"Successfully ran %s\" % ' '.join(command))\n+                    except subprocess.CalledProcessError as e:\n+                        print(e.output)\n                     cl.main_loop.quit()\n                     return\n         print _(\"Plugin %s not valid for %s id\") % (analysis_id, local_id)"
        },
        {
          "filename": "framework/src/setroubleshoot/signature.py",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -460,6 +460,9 @@ def get_plugins(self, all = False):\n     def substitute(self, txt):\n         return Template(txt).safe_substitute(self.template_substitutions)\n \n+    def substitute_array(self, args):\n+        return [self.substitute(txt) for txt in args]\n+\n     def format_details(self, replace=False):\n         env = self.environment\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7fa73c25d8e92ea0f7b9a49853e08aeb6ee8d92e",
            "date": "2022-12-09T09:01:41Z",
            "author_login": "bachradsusi"
          },
          {
            "sha": "8c3f45b5f116912848a6c093bfb853a3e5d8a724",
            "date": "2021-08-10T18:11:20Z",
            "author_login": "bachradsusi"
          },
          {
            "sha": "1707224c480ff57cb33ba8db1ea73cdcafa3cc7a",
            "date": "2021-07-26T20:18:29Z",
            "author_login": "AdamWill"
          },
          {
            "sha": "717f6946e8c90cdd4d98f10ba7e443f4f075be49",
            "date": "2021-07-26T20:16:27Z",
            "author_login": "AdamWill"
          },
          {
            "sha": "653cc3006a58f9d3dc56c1c6ea86511b05fdf4f7",
            "date": "2021-07-26T20:11:17Z",
            "author_login": "AdamWill"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-77",
    "description": "The fix_lookup_id function in sealert in setroubleshoot before 3.2.23 allows local users to execute arbitrary commands as root by triggering an SELinux denial with a crafted file name, related to executing external commands with the commands.getstatusoutput function.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-04-11T18:59:00.260",
    "last_modified": "2024-11-21T02:52:13.120",
    "fix_date": "2015-04-09T12:08:14Z"
  },
  "references": [
    {
      "url": "http://seclists.org/oss-sec/2016/q2/575",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91430",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1036144",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1339183",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/fedora-selinux/setroubleshoot/commit/2d12677629ca319310f6263688bb1b7f676c01b7",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://rhn.redhat.com/errata/RHSA-2016-1267.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2016/q2/575",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91430",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1036144",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1339183",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/fedora-selinux/setroubleshoot/commit/2d12677629ca319310f6263688bb1b7f676c01b7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://rhn.redhat.com/errata/RHSA-2016-1267.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.848746",
    "processing_status": "enhanced"
  }
}