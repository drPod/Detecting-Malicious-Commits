{
  "cve_id": "CVE-2016-4989",
  "github_data": {
    "repository": "fedora-selinux/setroubleshoot",
    "fix_commit": "dda55aa50db95a25f0d919c3a0d5871827cdc40f",
    "related_commits": [
      "dda55aa50db95a25f0d919c3a0d5871827cdc40f",
      "e69378d7e82a503534d29c5939fa219341e8f2ad",
      "dda55aa50db95a25f0d919c3a0d5871827cdc40f",
      "e69378d7e82a503534d29c5939fa219341e8f2ad"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "dda55aa50db95a25f0d919c3a0d5871827cdc40f",
      "commit_date": "2016-06-21T13:15:00Z",
      "author": {
        "login": "bachradsusi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "framework: Use subprocess.check_output() with a sequence of program arguments",
        "length": 249,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "framework/src/SetroubleshootFixit.py",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -14,9 +14,9 @@ def __init__ (self, *p, **k):\n         \n     @dbus.service.method (\"org.fedoraproject.SetroubleshootFixit\", in_signature='ss', out_signature='s')\n     def run_fix(self, local_id, analysis_id):\n-        import commands\n-        command = \"sealert -f %s -P %s\" % ( local_id, analysis_id)\n-        return commands.getoutput(command)\n+        import subprocess\n+        command = [\"sealert\", \"-f\", local_id, \"-P\", analysis_id]\n+        return subprocess.check_output(command, universal_newlines=True)\n \n if __name__ == \"__main__\":\n     mainloop = gobject.MainLoop ()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7fa73c25d8e92ea0f7b9a49853e08aeb6ee8d92e",
            "date": "2022-12-09T09:01:41Z",
            "author_login": "bachradsusi"
          },
          {
            "sha": "8c3f45b5f116912848a6c093bfb853a3e5d8a724",
            "date": "2021-08-10T18:11:20Z",
            "author_login": "bachradsusi"
          },
          {
            "sha": "1707224c480ff57cb33ba8db1ea73cdcafa3cc7a",
            "date": "2021-07-26T20:18:29Z",
            "author_login": "AdamWill"
          },
          {
            "sha": "717f6946e8c90cdd4d98f10ba7e443f4f075be49",
            "date": "2021-07-26T20:16:27Z",
            "author_login": "AdamWill"
          },
          {
            "sha": "653cc3006a58f9d3dc56c1c6ea86511b05fdf4f7",
            "date": "2021-07-26T20:11:17Z",
            "author_login": "AdamWill"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-77",
    "description": "setroubleshoot allows local users to bypass an intended container protection mechanism and execute arbitrary commands by (1) triggering an SELinux denial with a crafted file name, which is handled by the _set_tpath function in audit_data.py or via a crafted (2) local_id or (3) analysis_id field in a crafted XML document to the run_fix function in SetroubleshootFixit.py, related to the subprocess.check_output and commands.getstatusoutput functions, a different vulnerability than CVE-2016-4445.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-04-11T18:59:00.353",
    "last_modified": "2024-11-21T02:53:22.497",
    "fix_date": "2016-06-21T13:15:00Z"
  },
  "references": [
    {
      "url": "http://seclists.org/oss-sec/2016/q2/574",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://securitytracker.com/id/1036144",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2016:1293",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1346461",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/fedora-selinux/setroubleshoot/commit/dda55aa50db95a25f0d919c3a0d5871827cdc40f",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fedora-selinux/setroubleshoot/commit/e69378d7e82a503534d29c5939fa219341e8f2ad",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://rhn.redhat.com/errata/RHSA-2016-1267.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/oss-sec/2016/q2/574",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://securitytracker.com/id/1036144",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2016:1293",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1346461",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/fedora-selinux/setroubleshoot/commit/dda55aa50db95a25f0d919c3a0d5871827cdc40f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fedora-selinux/setroubleshoot/commit/e69378d7e82a503534d29c5939fa219341e8f2ad",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://rhn.redhat.com/errata/RHSA-2016-1267.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.849092",
    "processing_status": "enhanced"
  }
}