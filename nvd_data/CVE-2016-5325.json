{
  "cve_id": "CVE-2016-5325",
  "github_data": {
    "repository": "nodejs/node",
    "fix_commit": "c0f13e56a20f9bde5a67d873a7f9564487160762",
    "related_commits": [
      "c0f13e56a20f9bde5a67d873a7f9564487160762",
      "c0f13e56a20f9bde5a67d873a7f9564487160762"
    ],
    "patch_url": "https://github.com/nodejs/node/commit/c0f13e56a20f9bde5a67d873a7f9564487160762.patch",
    "fix_commit_details": {
      "sha": "c0f13e56a20f9bde5a67d873a7f9564487160762",
      "commit_date": "2016-09-27T15:42:32Z",
      "author": {
        "login": "evanlucas",
        "type": "User",
        "stats": {
          "total_commits": 151,
          "average_weekly_commits": 0.18170878459687123,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 101
        }
      },
      "commit_message": {
        "title": "http: check reason chars in writeHead",
        "length": 445,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 49,
        "additions": 49,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/_http_server.js",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -191,6 +191,9 @@ ServerResponse.prototype.writeHead = function(statusCode, reason, obj) {\n   if (statusCode < 100 || statusCode > 999)\n     throw new RangeError(`Invalid status code: ${statusCode}`);\n \n+  if (common._checkInvalidHeaderChar(this.statusMessage))\n+    throw new Error('Invalid character in statusMessage.');\n+\n   var statusLine = 'HTTP/1.1 ' + statusCode.toString() + ' ' +\n                    this.statusMessage + CRLF;\n "
        },
        {
          "filename": "test/parallel/test-http-status-reason-invalid-chars.js",
          "status": "added",
          "additions": 46,
          "deletions": 0,
          "patch": "@@ -0,0 +1,46 @@\n+'use strict';\n+\n+const common = require('../common');\n+const assert = require('assert');\n+const http = require('http');\n+\n+function explicit(req, res) {\n+  assert.throws(() => {\n+    res.writeHead(200, `OK\\r\\nContent-Type: text/html\\r\\n`);\n+  }, /Invalid character in statusMessage/);\n+\n+  assert.throws(() => {\n+    res.writeHead(200, 'OK\\u010D\\u010AContent-Type: gotcha\\r\\n');\n+  }, /Invalid character in statusMessage/);\n+\n+  res.statusMessage = 'OK';\n+  res.end();\n+}\n+\n+function implicit(req, res) {\n+  assert.throws(() => {\n+    res.statusMessage = `OK\\r\\nContent-Type: text/html\\r\\n`;\n+    res.writeHead(200);\n+  }, /Invalid character in statusMessage/);\n+  res.statusMessage = 'OK';\n+  res.end();\n+}\n+\n+const server = http.createServer((req, res) => {\n+  if (req.url === '/explicit') {\n+    explicit(req, res);\n+  } else {\n+    implicit(req, res);\n+  }\n+}).listen(common.PORT, common.mustCall(() => {\n+  const url = `http://localhost:${common.PORT}`;\n+  let left = 2;\n+  const check = common.mustCall((res) => {\n+    left--;\n+    assert.notEqual(res.headers['content-type'], 'text/html');\n+    assert.notEqual(res.headers['content-type'], 'gotcha');\n+    if (left === 0) server.close();\n+  }, 2);\n+  http.get(`${url}/explicit`, check).end();\n+  http.get(`${url}/implicit`, check).end();\n+}));"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "732744cc7667ef33289516dd3ecbd24ffbadc2e1",
            "date": "2025-01-14T18:24:30Z",
            "author_login": "Ceres6"
          },
          {
            "sha": "fc11189cbd2708811570f3db0b2be32c55f8f05e",
            "date": "2025-01-14T14:24:41Z",
            "author_login": "JakobJingleheimer"
          },
          {
            "sha": "5770972dc6c0458af5458b8056b16d70905ea9d8",
            "date": "2025-01-14T00:56:47Z",
            "author_login": "nodejs-github-bot"
          },
          {
            "sha": "f537efd1dda870baac652321445ce5944b7e09c5",
            "date": "2025-01-14T00:56:11Z",
            "author_login": "nodejs-github-bot"
          },
          {
            "sha": "4ef77497fb6e4eb4dfcc55a6c21f35ec707d38a5",
            "date": "2025-01-14T00:55:57Z",
            "author_login": "nodejs-github-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-113",
    "description": "CRLF injection vulnerability in the ServerResponse#writeHead function in Node.js 0.10.x before 0.10.47, 0.12.x before 0.12.16, 4.x before 4.6.0, and 6.x before 6.7.0 allows remote attackers to inject arbitrary HTTP headers and conduct HTTP response splitting attacks via the reason argument.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-10-10T16:59:00.200",
    "last_modified": "2024-11-21T02:54:06.370",
    "fix_date": "2016-09-27T15:42:32Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-10/msg00013.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0002.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/93483",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2016:2101",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/nodejs/node/commit/c0f13e56a20f9bde5a67d873a7f9564487160762",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://nodejs.org/en/blog/vulnerability/september-2016-security-releases/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201612-43",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-10/msg00013.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0002.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/93483",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2016:2101",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/nodejs/node/commit/c0f13e56a20f9bde5a67d873a7f9564487160762",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://nodejs.org/en/blog/vulnerability/september-2016-security-releases/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201612-43",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:46.802100",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "node",
    "owner": "nodejs",
    "created_at": "2014-11-26T19:57:11Z",
    "updated_at": "2025-01-14T13:50:49Z",
    "pushed_at": "2025-01-14T13:50:54Z",
    "size": 1221233,
    "stars": 108898,
    "forks": 30265,
    "open_issues": 2078,
    "watchers": 108898,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "archived-io.js-v0.10",
      "archived-io.js-v0.12",
      "canary-base",
      "main",
      "v0.7.4-release",
      "v0.8.16-release",
      "v0.10",
      "v0.12",
      "v1.x",
      "v3.x",
      "v4.x",
      "v5.x",
      "v6.x",
      "v7.x",
      "v8.x",
      "v9.x"
    ],
    "languages": {
      "JavaScript": 14935002,
      "C++": 5475414,
      "Python": 2594676,
      "C": 674103,
      "HTML": 163390,
      "Shell": 113904,
      "Makefile": 60765,
      "Batchfile": 45390,
      "Emacs Lisp": 14363,
      "Perl": 11715,
      "R": 8037,
      "TypeScript": 1968,
      "Assembly": 157
    },
    "commit_activity": {
      "total_commits_last_year": 2529,
      "avg_commits_per_week": 48.63461538461539,
      "days_active_last_year": 353
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:19:17.728456"
  }
}