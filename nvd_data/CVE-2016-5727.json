{
  "cve_id": "CVE-2016-5727",
  "github_data": {
    "repository": "SimpleMachines/SMF2.1",
    "fix_commit": "19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008",
    "related_commits": [
      "19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008",
      "19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008"
    ],
    "patch_url": "https://github.com/SimpleMachines/SMF2.1/commit/19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008.patch",
    "fix_commit_details": {
      "sha": "19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008",
      "commit_date": "2016-06-12T22:44:01Z",
      "author": {
        "login": "MissAllSunday",
        "type": "User",
        "stats": {
          "total_commits": 2118,
          "average_weekly_commits": 3.1238938053097347,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 243
        }
      },
      "commit_message": {
        "title": "Apply safe_unserialize()",
        "length": 82,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 28,
        "additions": 14,
        "deletions": 14
      },
      "files": [
        {
          "filename": "Sources/Calendar.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -500,19 +500,19 @@ function clock()\n \t{\n \t\t$context['sub_template'] = 'bcd';\n \t\t$context['linktree'][] = array('url' => $scripturl . '?action=clock;bcd', 'name' => 'BCD');\n-\t\t$context['clockicons'] = unserialize(base64_decode('YTo2OntzOjI6ImgxIjthOjI6e2k6MDtpOjI7aToxO2k6MTt9czoyOiJoMiI7YTo0OntpOjA7aTo4O2k6MTtpOjQ7aToyO2k6MjtpOjM7aToxO31zOjI6Im0xIjthOjM6e2k6MDtpOjQ7aToxO2k6MjtpOjI7aToxO31zOjI6Im0yIjthOjQ6e2k6MDtpOjg7aToxO2k6NDtpOjI7aToyO2k6MztpOjE7fXM6MjoiczEiO2E6Mzp7aTowO2k6NDtpOjE7aToyO2k6MjtpOjE7fXM6MjoiczIiO2E6NDp7aTowO2k6ODtpOjE7aTo0O2k6MjtpOjI7aTozO2k6MTt9fQ=='));\n+\t\t$context['clockicons'] = safe_unserialize(base64_decode('YTo2OntzOjI6ImgxIjthOjI6e2k6MDtpOjI7aToxO2k6MTt9czoyOiJoMiI7YTo0OntpOjA7aTo4O2k6MTtpOjQ7aToyO2k6MjtpOjM7aToxO31zOjI6Im0xIjthOjM6e2k6MDtpOjQ7aToxO2k6MjtpOjI7aToxO31zOjI6Im0yIjthOjQ6e2k6MDtpOjg7aToxO2k6NDtpOjI7aToyO2k6MztpOjE7fXM6MjoiczEiO2E6Mzp7aTowO2k6NDtpOjE7aToyO2k6MjtpOjE7fXM6MjoiczIiO2E6NDp7aTowO2k6ODtpOjE7aTo0O2k6MjtpOjI7aTozO2k6MTt9fQ=='));\n \t}\n \telseif (!$omfg && !isset($_REQUEST['time']))\n \t{\n \t\t$context['sub_template'] = 'hms';\n \t\t$context['linktree'][] = array('url' => $scripturl . '?action=clock', 'name' => 'Binary');\n-\t\t$context['clockicons'] = unserialize(base64_decode('YTozOntzOjE6ImgiO2E6NTp7aTowO2k6MTY7aToxO2k6ODtpOjI7aTo0O2k6MztpOjI7aTo0O2k6MTt9czoxOiJtIjthOjY6e2k6MDtpOjMyO2k6MTtpOjE2O2k6MjtpOjg7aTozO2k6NDtpOjQ7aToyO2k6NTtpOjE7fXM6MToicyI7YTo2OntpOjA7aTozMjtpOjE7aToxNjtpOjI7aTo4O2k6MztpOjQ7aTo0O2k6MjtpOjU7aToxO319'));\n+\t\t$context['clockicons'] = safe_unserialize(base64_decode('YTozOntzOjE6ImgiO2E6NTp7aTowO2k6MTY7aToxO2k6ODtpOjI7aTo0O2k6MztpOjI7aTo0O2k6MTt9czoxOiJtIjthOjY6e2k6MDtpOjMyO2k6MTtpOjE2O2k6MjtpOjg7aTozO2k6NDtpOjQ7aToyO2k6NTtpOjE7fXM6MToicyI7YTo2OntpOjA7aTozMjtpOjE7aToxNjtpOjI7aTo4O2k6MztpOjQ7aTo0O2k6MjtpOjU7aToxO319'));\n \t}\n \telseif ($omfg)\n \t{\n \t\t$context['sub_template'] = 'omfg';\n \t\t$context['linktree'][] = array('url' => $scripturl . '?action=clock;omfg', 'name' => 'OMFG');\n-\t\t$context['clockicons'] = unserialize(base64_decode('YTo2OntzOjQ6InllYXIiO2E6Nzp7aTowO2k6NjQ7aToxO2k6MzI7aToyO2k6MTY7aTozO2k6ODtpOjQ7aTo0O2k6NTtpOjI7aTo2O2k6MTt9czo1OiJtb250aCI7YTo0OntpOjA7aTo4O2k6MTtpOjQ7aToyO2k6MjtpOjM7aToxO31zOjM6ImRheSI7YTo1OntpOjA7aToxNjtpOjE7aTo4O2k6MjtpOjQ7aTozO2k6MjtpOjQ7aToxO31zOjQ6ImhvdXIiO2E6NTp7aTowO2k6MTY7aToxO2k6ODtpOjI7aTo0O2k6MztpOjI7aTo0O2k6MTt9czozOiJtaW4iO2E6Njp7aTowO2k6MzI7aToxO2k6MTY7aToyO2k6ODtpOjM7aTo0O2k6NDtpOjI7aTo1O2k6MTt9czozOiJzZWMiO2E6Njp7aTowO2k6MzI7aToxO2k6MTY7aToyO2k6ODtpOjM7aTo0O2k6NDtpOjI7aTo1O2k6MTt9fQ=='));\n+\t\t$context['clockicons'] = safe_unserialize(base64_decode('YTo2OntzOjQ6InllYXIiO2E6Nzp7aTowO2k6NjQ7aToxO2k6MzI7aToyO2k6MTY7aTozO2k6ODtpOjQ7aTo0O2k6NTtpOjI7aTo2O2k6MTt9czo1OiJtb250aCI7YTo0OntpOjA7aTo4O2k6MTtpOjQ7aToyO2k6MjtpOjM7aToxO31zOjM6ImRheSI7YTo1OntpOjA7aToxNjtpOjE7aTo4O2k6MjtpOjQ7aTozO2k6MjtpOjQ7aToxO31zOjQ6ImhvdXIiO2E6NTp7aTowO2k6MTY7aToxO2k6ODtpOjI7aTo0O2k6MztpOjI7aTo0O2k6MTt9czozOiJtaW4iO2E6Njp7aTowO2k6MzI7aToxO2k6MTY7aToyO2k6ODtpOjM7aTo0O2k6NDtpOjI7aTo1O2k6MTt9czozOiJzZWMiO2E6Njp7aTowO2k6MzI7aToxO2k6MTY7aToyO2k6ODtpOjM7aTo0O2k6NDtpOjI7aTo1O2k6MTt9fQ=='));\n \t}\n \telseif (isset($_REQUEST['time']))\n \t{"
        },
        {
          "filename": "Sources/Load.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -381,7 +381,7 @@ function loadUserSettings()\n \t\t$cookie_data = smf_json_decode($_COOKIE[$cookiename], true);\n \n \t\tif (is_null($cookie_data))\n-\t\t\t$cookie_data = @unserialize($_COOKIE[$cookiename]);\n+\t\t\t$cookie_data = safe_unserialize($_COOKIE[$cookiename]);\n \n \t\tlist ($id_member, $password) = $cookie_data;\n \t\t$id_member = !empty($id_member) && strlen($password) > 0 ? (int) $id_member : 0;\n@@ -392,7 +392,7 @@ function loadUserSettings()\n \t\t$cookie_data = smf_json_decode($_SESSION['login_' . $cookiename]);\n \n \t\tif (is_null($cookie_data))\n-\t\t\t$cookie_data = @unserialize($_SESSION['login_' . $cookiename]);\n+\t\t\t$cookie_data = safe_unserialize($_SESSION['login_' . $cookiename]);\n \n \t\tlist ($id_member, $password, $login_span) = $cookie_data;\n \t\t$id_member = !empty($id_member) && strlen($password) == 128 && $login_span > time() ? (int) $id_member : 0;\n@@ -463,7 +463,7 @@ function loadUserSettings()\n \t\t\t\t\t$tfa_data = smf_json_decode($_COOKIE[$tfacookie]);\n \n \t\t\t\t\tif (is_null($tfa_data))\n-\t\t\t\t\t\t$tfa_data = @unserialize($_COOKIE[$tfacookie]);\n+\t\t\t\t\t\t$tfa_data = safe_unserialize($_COOKIE[$tfacookie]);\n \n \t\t\t\t\tlist ($tfamember, $tfasecret) = $tfa_data;\n \n@@ -620,7 +620,7 @@ function loadUserSettings()\n \t\t\t$tfa_data = smf_json_decode($_COOKIE[$cookiename . '_tfa'], true);\n \n \t\t\tif (is_null($tfa_data))\n-\t\t\t\t$tfa_data = @unserialize($_COOKIE[$cookiename . '_tfa']);\n+\t\t\t\t$tfa_data = safe_unserialize($_COOKIE[$cookiename . '_tfa']);\n \n \t\t\tlist ($id, $user, $exp, $state, $preserve) = $tfa_data;\n "
        },
        {
          "filename": "Sources/LogInOut.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -103,15 +103,15 @@ function Login2()\n \n \t\t\t// That didn't work... Maybe it's using serialize?\n \t\t\tif (is_null($timeout))\n-\t\t\t\tlist (, , $timeout) = @unserialize($_COOKIE[$cookiename]);\n+\t\t\t\tlist (, , $timeout) = safe_unserialize($_COOKIE[$cookiename]);\n \t\t}\n \t\telseif (isset($_SESSION['login_' . $cookiename]))\n \t\t{\n \t\t\tlist (, , $timeout) = smf_json_decode($_SESSION['login_' . $cookiename]);\n \n \t\t\t// Try for old format\n \t\t\tif (is_null($timeout))\n-\t\t\t\tlist (, , $timeout) = @unserialize($_SESSION['login_' . $cookiename]);\n+\t\t\t\tlist (, , $timeout) = safe_unserialize($_SESSION['login_' . $cookiename]);\n \t\t}\n \t\telse\n \t\t\ttrigger_error('Login2(): Cannot be logged in without a session or cookie', E_USER_ERROR);\n@@ -126,7 +126,7 @@ function Login2()\n \n \t\t\t// If that didn't work, try unserialize instead...\n \t\t\tif (is_null($tfadata))\n-\t\t\t\t$tfadata = @unserialize($_COOKIE[$cookiename . '_tfa']);\n+\t\t\t\t$tfadata = safe_unserialize($_COOKIE[$cookiename . '_tfa']);\n \n \t\t\tlist ($tfamember, $tfasecret, $exp, $state, $preserve) = $tfadata;\n \n@@ -689,7 +689,7 @@ function Logout($internal = false, $redirect = true)\n \n \t\t// If that failed, try the old method\n \t\tif (is_null($tfadata))\n-\t\t\t$tfadata = @unserialize($_COOKIE[$cookiename . '_tfa']);\n+\t\t\t$tfadata = safe_unserialize($_COOKIE[$cookiename . '_tfa']);\n \n \t\tlist ($tfamember, $tfasecret, $exp, $state, $preserve) = $tfadata;\n "
        },
        {
          "filename": "Sources/Subs-Auth.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -44,7 +44,7 @@ function setLoginCookie($cookie_length, $id, $password = '')\n \n \t\t// Legacy format\n \t\tif (is_null($array))\n-\t\t\t$array = @unserialize($_COOKIE[$cookiename]);\n+\t\t\t$array = safe_unserialize($_COOKIE[$cookiename]);\n \n \t\t// Out with the old, in with the new!\n \t\tif (isset($array[3]) && $array[3] != $cookie_state)"
        },
        {
          "filename": "Sources/Subs-Charset.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -569,7 +569,7 @@ function fix_serialized_columns()\n \t);\n \twhile ($row = $smcFunc['db_fetch_assoc']($request))\n \t{\n-\t\tif (@unserialize($row['extra']) === false && preg_match('~^(a:3:{s:5:\"topic\";i:\\d+;s:7:\"subject\";s:)(\\d+):\"(.+)\"(;s:6:\"member\";s:5:\"\\d+\";})$~', $row['extra'], $matches) === 1)\n+\t\tif (safe_unserialize($row['extra']) === false && preg_match('~^(a:3:{s:5:\"topic\";i:\\d+;s:7:\"subject\";s:)(\\d+):\"(.+)\"(;s:6:\"member\";s:5:\"\\d+\";})$~', $row['extra'], $matches) === 1)\n \t\t\t$smcFunc['db_query']('', '\n \t\t\t\tUPDATE {db_prefix}log_actions\n \t\t\t\tSET extra = {string:extra}"
        },
        {
          "filename": "Sources/Subs-Menu.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -122,7 +122,7 @@ function createMenu($menuData, $menuOptions = array())\n \n \t\t\t\t\t\t// Does this area have its own icon?\n \t\t\t\t\t\tif (!isset($area['force_menu_into_arms_of_another_menu']) && $user_info['name'] == 'iamanoompaloompa')\n-\t\t\t\t\t\t\t$menu_context['sections'][$section_id]['areas'][$area_id] = unserialize(base64_decode('YTozOntzOjU6ImxhYmVsIjtzOjEyOiJPb21wYSBMb29tcGEiO3M6MzoidXJsIjtzOjQzOiJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL09vbXBhX0xvb21wYXM/IjtzOjQ6Imljb24iO3M6ODY6IjxpbWcgc3JjPSJodHRwOi8vd3d3LnNpbXBsZW1hY2hpbmVzLm9yZy9pbWFnZXMvb29tcGEuZ2lmIiBhbHQ9IkknbSBhbiBPb21wYSBMb29tcGEiIC8+Ijt9'));\n+\t\t\t\t\t\t\t$menu_context['sections'][$section_id]['areas'][$area_id] = safe_unserialize(base64_decode('YTozOntzOjU6ImxhYmVsIjtzOjEyOiJPb21wYSBMb29tcGEiO3M6MzoidXJsIjtzOjQzOiJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL09vbXBhX0xvb21wYXM/IjtzOjQ6Imljb24iO3M6ODY6IjxpbWcgc3JjPSJodHRwOi8vd3d3LnNpbXBsZW1hY2hpbmVzLm9yZy9pbWFnZXMvb29tcGEuZ2lmIiBhbHQ9IkknbSBhbiBPb21wYSBMb29tcGEiIC8+Ijt9'));\n \t\t\t\t\t\telseif (isset($area['icon']) && file_exists($settings['theme_dir'] . '/images/admin/' . $area['icon']))\n \t\t\t\t\t\t\t$menu_context['sections'][$section_id]['areas'][$area_id]['icon'] = '<img src=\"' . $settings['images_url'] . '/admin/' . $area['icon'] . '\" alt=\"\">';\n \t\t\t\t\t\telseif (isset($area['icon']) && file_exists($settings['default_theme_dir'] . '/images/admin/' . $area['icon']))"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "acc4394ccffdfa4d73bc4674945396be6693fc6c",
            "date": "2025-01-14T07:25:40Z",
            "author_login": "Sesquipedalian"
          },
          {
            "sha": "6f5084bee65c0ecf4c2ce6b8a355102c1743cb1e",
            "date": "2025-01-14T02:34:30Z",
            "author_login": "Sesquipedalian"
          },
          {
            "sha": "ad1a1557fe3d93fd1b37d3bb00304c46bc3c83dd",
            "date": "2025-01-14T02:33:21Z",
            "author_login": "Sesquipedalian"
          },
          {
            "sha": "2cc7d78ee66bb86c498c964397e1d6a08dacd9c9",
            "date": "2025-01-13T22:09:56Z",
            "author_login": "Sesquipedalian"
          },
          {
            "sha": "68e5e7152d6aeb7bfcbf95439de5d65d0aceb88d",
            "date": "2025-01-13T22:08:55Z",
            "author_login": "Sesquipedalian"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-94",
    "description": "LogInOut.php in Simple Machines Forum (SMF) 2.1 allows remote attackers to conduct PHP object injection attacks and execute arbitrary PHP code via vectors related to variables derived from user input in a foreach loop.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-02-09T15:59:01.160",
    "last_modified": "2024-11-21T02:54:54.080",
    "fix_date": "2016-06-12T22:44:01Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/10/7",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/18/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SimpleMachines/SMF2.1/commit/19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008#diff-513c4f9c501cbefcc14420c01848f23c",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SimpleMachines/SMF2.1/issues/3522",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/10/7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/18/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SimpleMachines/SMF2.1/commit/19e560b9f3e8fc6d7d9d60c1ff617b5ed5c08008#diff-513c4f9c501cbefcc14420c01848f23c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/SimpleMachines/SMF2.1/issues/3522",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.216062",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "SMF",
    "owner": "SimpleMachines",
    "created_at": "2012-01-24T16:36:19Z",
    "updated_at": "2025-01-14T07:26:33Z",
    "pushed_at": "2025-01-14T07:26:29Z",
    "size": 65075,
    "stars": 610,
    "forks": 254,
    "open_issues": 220,
    "watchers": 610,
    "has_security_policy": false,
    "default_branch": "release-3.0",
    "protected_branches": [
      "release-2.1",
      "release-3.0"
    ],
    "languages": {
      "PHP": 11763503,
      "JavaScript": 382334,
      "CSS": 162670,
      "PLpgSQL": 87128
    },
    "commit_activity": {
      "total_commits_last_year": 723,
      "avg_commits_per_week": 13.903846153846153,
      "days_active_last_year": 170
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:04:18.923200"
  }
}