{
  "cve_id": "CVE-2016-5767",
  "github_data": {
    "repository": "php/php-src",
    "fix_commit": "c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6",
    "related_commits": [
      "c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6",
      "c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6"
    ],
    "patch_url": "https://github.com/php/php-src/commit/c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6.patch",
    "fix_commit_details": {
      "sha": "c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6",
      "commit_date": "2016-06-21T06:58:26Z",
      "author": {
        "login": "smalyshev",
        "type": "User",
        "stats": {
          "total_commits": 4051,
          "average_weekly_commits": 3.0096582466567607,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 527
        }
      },
      "commit_message": {
        "title": "iFixed bug #72446 - Integer Overflow in gdImagePaletteToTrueColor() resulting in heap overflow",
        "length": 94,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 15,
        "deletions": 9
      },
      "files": [
        {
          "filename": "NEWS",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -18,6 +18,8 @@ PHP                                                                        NEWS\n   . Fixed bug #72339 (Integer Overflow in _gd2GetHeader() resulting in \n     heap overflow). (Pierre)\n   . Fixed bug #72407 (NULL Pointer Dereference at _gdScaleVert). (Stas)\n+  . Fixed bug #72446 (Integer Overflow in gdImagePaletteToTrueColor() resulting\n+    in heap overflow). (Pierre)\n \n - mbstring:\n    . Fixed bug #72402 (_php_mb_regex_ereg_replace_exec - double free). (Stas)"
        },
        {
          "filename": "ext/gd/libgd/gd.c",
          "status": "modified",
          "additions": 13,
          "deletions": 9,
          "patch": "@@ -133,6 +133,10 @@ gdImagePtr gdImageCreate (int sx, int sy)\n \t\treturn NULL;\n \t}\n \n+\tif (overflow2(sizeof(unsigned char *), sx)) {\n+\t\treturn NULL;\n+\t}\n+\n \tim = (gdImage *) gdCalloc(1, sizeof(gdImage));\n \n \t/* Row-major ever since gd 1.3 */\n@@ -1098,12 +1102,12 @@ void gdImageLine (gdImagePtr im, int x1, int y1, int x2, int y2, int color)\n \tint thick = im->thick;\n \n \tif (color == gdAntiAliased) {\n-\t\t/* \n+\t\t/*\n \t\t   gdAntiAliased passed as color: use the much faster, much cheaper\n \t\t   and equally attractive gdImageAALine implementation. That\n \t\t   clips too, so don't clip twice.\n \t\t   */\n-\t\tgdImageAALine(im, x1, y1, x2, y2, im->AA_color); \n+\t\tgdImageAALine(im, x1, y1, x2, y2, im->AA_color);\n \t\treturn;\n \t}\n \n@@ -1880,7 +1884,7 @@ void gdImageFill(gdImagePtr im, int x, int y, int nc)\n \t\treturn;\n \t}\n \n-\talphablending_bak = im->alphaBlendingFlag;\t\n+\talphablending_bak = im->alphaBlendingFlag;\n \tim->alphaBlendingFlag = 0;\n \n \tif (nc==gdTiled){\n@@ -1892,7 +1896,7 @@ void gdImageFill(gdImagePtr im, int x, int y, int nc)\n \twx2=im->sx;wy2=im->sy;\n \toc = gdImageGetPixel(im, x, y);\n \tif (oc==nc || x<0 || x>wx2 || y<0 || y>wy2) {\n-\t\tim->alphaBlendingFlag = alphablending_bak;\t\n+\t\tim->alphaBlendingFlag = alphablending_bak;\n \t\treturn;\n \t}\n \n@@ -1955,7 +1959,7 @@ skip:\t\t\tfor (x++; x<=x2 && (gdImageGetPixel(im, x, y)!=oc); x++);\n \tefree(stack);\n \n done:\n-\tim->alphaBlendingFlag = alphablending_bak;\t\n+\tim->alphaBlendingFlag = alphablending_bak;\n }\n \n static void _gdImageFillTiled(gdImagePtr im, int x, int y, int nc)\n@@ -2061,7 +2065,7 @@ void gdImageRectangle (gdImagePtr im, int x1, int y1, int x2, int y2, int color)\n \n \t\tx1ul = x1 - half;\n \t\ty1ul = y1 - half;\n-\t\t\n+\n \t\tx2lr = x2 + half;\n \t\ty2lr = y2 + half;\n \n@@ -2259,7 +2263,7 @@ void gdImageCopyMerge (gdImagePtr dst, gdImagePtr src, int dstX, int dstY, int s\n \tint tox, toy;\n \tint ncR, ncG, ncB;\n \ttoy = dstY;\n-\t\n+\n \tfor (y = srcY; y < (srcY + h); y++) {\n \t\ttox = dstX;\n \t\tfor (x = srcX; x < (srcX + w); x++) {\n@@ -2356,7 +2360,7 @@ void gdImageCopyResized (gdImagePtr dst, gdImagePtr src, int dstX, int dstY, int\n \tint colorMap[gdMaxColors];\n \t/* Stretch vectors */\n \tint *stx, *sty;\n-\t\n+\n \tif (overflow2(sizeof(int), srcW)) {\n \t\treturn;\n \t}\n@@ -2901,7 +2905,7 @@ int gdAlphaBlend (int dst, int src) {\n     src_weight = gdAlphaTransparent - src_alpha;\n     dst_weight = (gdAlphaTransparent - dst_alpha) * src_alpha / gdAlphaMax;\n     tot_weight = src_weight + dst_weight;\n-    \n+\n /* -------------------------------------------------------------------- */\n /*      What red, green and blue result values will we use?             */\n /* -------------------------------------------------------------------- */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "634edc8ab3850052942eba6432ba7a4f776ebae8",
            "date": "2025-01-14T11:36:58Z",
            "author_login": "cmb69"
          },
          {
            "sha": "58628e0cc629338fa43fb175f733778432346a86",
            "date": "2025-01-12T15:40:59Z",
            "author_login": "cmb69"
          },
          {
            "sha": "0e1fbf97f4ce4da519a2cf2654233a0d007800fd",
            "date": "2025-01-13T15:46:54Z",
            "author_login": "iluuu1994"
          },
          {
            "sha": "3c138641e12fad5e8a94174988801c0529ca1c38",
            "date": "2025-01-13T15:46:43Z",
            "author_login": "iluuu1994"
          },
          {
            "sha": "a6a290d541ae2de2e9248acd48ffa6129b6577b3",
            "date": "2025-01-06T14:18:00Z",
            "author_login": "iluuu1994"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "Integer overflow in the gdImageCreate function in gd.c in the GD Graphics Library (aka libgd) before 2.0.34RC1, as used in PHP before 5.5.37, 5.6.x before 5.6.23, and 7.x before 7.0.8, allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted image dimensions.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-08-07T10:59:14.960",
    "last_modified": "2024-11-21T02:54:58.990",
    "fix_date": "2016-06-21T06:58:26Z"
  },
  "references": [
    {
      "url": "http://github.com/php/php-src/commit/c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6?w=1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-07/msg00004.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-08/msg00025.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-08/msg00003.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://php.net/ChangeLog-5.php",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "http://php.net/ChangeLog-7.php",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2598.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2750.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/23/4",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91395",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugs.php.net/bug.php?id=72446",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05240731",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://github.com/php/php-src/commit/c395c6e5d7e8df37a21265ff76e48fe75ceb5ae6?w=1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-07/msg00004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2016-08/msg00025.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-08/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://php.net/ChangeLog-5.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "http://php.net/ChangeLog-7.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2598.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2750.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/23/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/91395",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugs.php.net/bug.php?id=72446",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05240731",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:46.770437",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "php-src",
    "owner": "php",
    "created_at": "2011-06-16T01:52:25Z",
    "updated_at": "2025-01-14T11:37:56Z",
    "pushed_at": "2025-01-14T11:37:44Z",
    "size": 579039,
    "stars": 38520,
    "forks": 7798,
    "open_issues": 1300,
    "watchers": 38520,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "PEAR_1_4DEV",
      "PECL_OPENSSL",
      "PECL",
      "PECL_4_3",
      "PHAR_1_2",
      "PHP-4.0",
      "PHP-4.0.5",
      "PHP-4.0.6",
      "PHP-4.0.7",
      "PHP-4.2.0",
      "PHP-4.2.2",
      "PHP-4.3",
      "PHP-4.3.0",
      "PHP-4.3.1",
      "PHP-4.3.2",
      "PHP-4.3.7",
      "PHP-4.4",
      "PHP-5",
      "PHP-5.0",
      "PHP-5.1",
      "PHP-5.2",
      "PHP-5.2.1RC1",
      "PHP-5.3",
      "PHP-5.3.11",
      "PHP-5.3.12",
      "PHP-5.3.13",
      "PHP-5.3.14",
      "PHP-5.3.15",
      "PHP-5.3.16",
      "PHP-5.3.17"
    ],
    "languages": {
      "C": 65322886,
      "PHP": 30041198,
      "C++": 580205,
      "M4": 408378,
      "Shell": 299560,
      "Lua": 272563,
      "Assembly": 236754,
      "JavaScript": 198632,
      "Lex": 99367,
      "Yacc": 92094,
      "Makefile": 33437,
      "Roff": 32243,
      "GAP": 23811,
      "Python": 14072,
      "GDB": 13663,
      "XSLT": 7963,
      "Awk": 2920,
      "Batchfile": 2219,
      "DTrace": 2180,
      "HTML": 1894
    },
    "commit_activity": {
      "total_commits_last_year": 5383,
      "avg_commits_per_week": 103.51923076923077,
      "days_active_last_year": 358
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:07:39.017037"
  }
}