{
  "cve_id": "CVE-2016-5873",
  "github_data": {
    "repository": "m6w6/ext-http",
    "fix_commit": "3724cd76a28be1d6049b5537232e97ac",
    "related_commits": [
      "3724cd76a28be1d6049b5537232e97ac",
      "3724cd76a28be1d6049b5537232e97ac"
    ],
    "patch_url": "https://github.com/m6w6/ext-http/commit/3724cd76a28be1d6049b5537232e97ac.patch",
    "fix_commit_details": {
      "sha": "3724cd76a28be1d6049b5537232e97ac",
      "commit_date": "2016-03-09T08:21:28Z",
      "author": {
        "login": "m6w6",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix bug #71719 (Buffer overflow in HTTP url parsing functions)",
        "length": 218,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 35,
        "additions": 31,
        "deletions": 4
      },
      "files": [
        {
          "filename": ".gitattributes",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,3 +1,4 @@\n package.xml\t\tmerge=touch\n php_http.h\t\tmerge=touch\n .travis.yml\t\tmerge=touch\n+/tests/data/bug71719.bin\t-diff -text"
        },
        {
          "filename": "src/php_http_url.c",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -1467,7 +1467,7 @@ static const char *parse_scheme(struct parse_state *state)\n \t\tcase '7': case '8': case '9':\n \t\tcase '+': case '-': case '.':\n \t\t\tif (state->ptr == tmp) {\n-\t\t\t\treturn tmp;\n+\t\t\t\tgoto softfail;\n \t\t\t}\n \t\t\t/* no break */\n \t\tcase 'A': case 'B': case 'C': case 'D': case 'E': case 'F': case 'G':\n@@ -1484,19 +1484,20 @@ static const char *parse_scheme(struct parse_state *state)\n \n \t\tdefault:\n \t\t\tif (!(mb = parse_mb(state, PARSE_SCHEME, state->ptr, state->end, tmp, 1))) {\n-\t\t\t\t/* soft fail; parse path next */\n-\t\t\t\treturn tmp;\n+\t\t\t\tgoto softfail;\n \t\t\t}\n \t\t\tstate->ptr += mb - 1;\n \t\t}\n \t} while (++state->ptr != state->end);\n \n+softfail:\n+\tstate->offset = 0;\n \treturn state->ptr = tmp;\n }\n \n php_http_url_t *php_http_url_parse(const char *str, size_t len, unsigned flags TSRMLS_DC)\n {\n-\tsize_t maxlen = 3 * len;\n+\tsize_t maxlen = 3 * len + 8 /* null bytes for all components */;\n \tstruct parse_state *state = ecalloc(1, sizeof(*state) + maxlen);\n \n \tstate->end = str + len;"
        },
        {
          "filename": "tests/bug71719.phpt",
          "status": "added",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -0,0 +1,25 @@\n+--TEST--\n+Buffer overflow in HTTP url parsing functions\n+--SKIPIF--\n+<?php\n+include \"skipif.inc\";\n+?>\n+--FILE--\n+<?php\n+\n+echo \"Test\\n\";\n+try {\n+\techo new http\\Message(file_get_contents(__DIR__.\"/data/bug71719.bin\"), false);\n+} catch (Exception $e) {\n+\techo $e;\n+}\n+?>\n+\n+===DONE===\n+--EXPECTF--\n+Test\n+%r(exception ')?%rhttp\\Exception\\BadMessageException%r(' with message '|: )%rhttp\\Message::__construct(): Could not parse HTTP protocol version 'HTTP/%s.0'%r'?%r in %sbug71719.php:5\n+Stack trace:\n+#0 %sbug71719.php(5): http\\Message->__construct('\\x80\\xACTd 5 HTTP/1.1...', false)\n+#1 {main}\n+===DONE==="
        },
        {
          "filename": "tests/data/bug71719.bin",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "99e4f247a83b30bfc0b6c93943cb4ad373efc136",
            "date": "2024-11-05T14:49:49Z",
            "author_login": "m6w6"
          },
          {
            "sha": "d2da94231fb14ed69ce042de9927dda26440ef1d",
            "date": "2024-10-24T13:01:28Z",
            "author_login": "m6w6"
          },
          {
            "sha": "bc9d6f350b32e68e294024b14295643d95611a46",
            "date": "2024-10-23T13:16:58Z",
            "author_login": "m6w6"
          },
          {
            "sha": "45eb80abc93eefe8e400b7dc77afe0c2be2f05b9",
            "date": "2024-10-23T13:08:15Z",
            "author_login": "m6w6"
          },
          {
            "sha": "9288cbec440b9ac839e5285d059c1ca4bbefb07f",
            "date": "2024-09-24T18:08:49Z",
            "author_login": "m6w6"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-119",
    "description": "Buffer overflow in the HTTP URL parsing functions in pecl_http before 3.0.1 might allow remote attackers to execute arbitrary code via non-printable characters in a URL.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-01-23T21:59:01.813",
    "last_modified": "2024-11-21T02:55:10.643",
    "fix_date": "2016-03-09T08:21:28Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/29/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/29/4",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95863",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugs.php.net/bug.php?id=71719",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/m6w6/ext-http/commit/3724cd76a28be1d6049b5537232e97ac",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://pecl.php.net/package/pecl_http/3.0.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201612-17",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20180112-0001/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/29/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/06/29/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95863",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugs.php.net/bug.php?id=71719",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/m6w6/ext-http/commit/3724cd76a28be1d6049b5537232e97ac",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://pecl.php.net/package/pecl_http/3.0.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201612-17",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20180112-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:49.840372",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ext-http",
    "owner": "m6w6",
    "created_at": "2015-05-29T09:34:48Z",
    "updated_at": "2024-11-26T09:34:25Z",
    "pushed_at": "2024-11-05T15:36:13Z",
    "size": 4320,
    "stars": 80,
    "forks": 22,
    "open_issues": 7,
    "watchers": 80,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 834495,
      "PHP": 228191,
      "M4": 30363,
      "Shell": 1031,
      "Makefile": 432,
      "HTML": 136
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-2-clause"
    },
    "collected_at": "2025-01-14T20:39:55.329197"
  }
}