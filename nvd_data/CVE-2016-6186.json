{
  "cve_id": "CVE-2016-6186",
  "github_data": {
    "repository": "django/django",
    "fix_commit": "d03bf6fe4e9bf5b07de62c1a271c4b41a7d3d158",
    "related_commits": [
      "d03bf6fe4e9bf5b07de62c1a271c4b41a7d3d158",
      "f68e5a99164867ab0e071a936470958ed867479d",
      "d03bf6fe4e9bf5b07de62c1a271c4b41a7d3d158",
      "f68e5a99164867ab0e071a936470958ed867479d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "d03bf6fe4e9bf5b07de62c1a271c4b41a7d3d158",
      "commit_date": "2016-07-06T19:41:06Z",
      "author": {
        "login": "timgraham",
        "type": "User",
        "stats": {
          "total_commits": 3482,
          "average_weekly_commits": 3.4103819784524974,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 441
        }
      },
      "commit_message": {
        "title": "[1.9.x] Fixed XSS in admin's add/change related popup.",
        "length": 79,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 49,
        "additions": 41,
        "deletions": 8
      },
      "files": [
        {
          "filename": "django/contrib/admin/static/admin/js/admin/RelatedObjectLookups.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -120,7 +120,7 @@\n         var selects = django.jQuery(selectsSelector);\n         selects.find('option').each(function() {\n             if (this.value === objId) {\n-                this.innerHTML = newRepr;\n+                this.textContent = newRepr;\n                 this.value = newId;\n             }\n         });"
        },
        {
          "filename": "django/views/debug.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -631,13 +631,13 @@ def default_urlconf(request):\n       var s = link.getElementsByTagName('span')[0];\n       var uarr = String.fromCharCode(0x25b6);\n       var darr = String.fromCharCode(0x25bc);\n-      s.innerHTML = s.innerHTML == uarr ? darr : uarr;\n+      s.textContent = s.textContent == uarr ? darr : uarr;\n       return false;\n     }\n     function switchPastebinFriendly(link) {\n       s1 = \"Switch to copy-and-paste view\";\n       s2 = \"Switch back to interactive view\";\n-      link.innerHTML = link.innerHTML.trim() == s1 ? s2: s1;\n+      link.textContent = link.textContent.trim() == s1 ? s2: s1;\n       toggle('browserTraceback', 'pastebinTraceback');\n       return false;\n     }"
        },
        {
          "filename": "docs/releases/1.8.14.txt",
          "status": "modified",
          "additions": 13,
          "deletions": 2,
          "patch": "@@ -2,9 +2,20 @@\n Django 1.8.14 release notes\n ===========================\n \n-*Under development*\n+*July 18, 2016*\n \n-Django 1.8.14 fixes several bugs in 1.8.13.\n+Django 1.8.14 fixes a security issue and a bug in 1.8.13.\n+\n+XSS in admin's add/change related popup\n+=======================================\n+\n+Unsafe usage of JavaScript's ``Element.innerHTML`` could result in XSS in the\n+admin's add/change related popup. ``Element.textContent`` is now used to\n+prevent execution of the data.\n+\n+The debug view also used ``innerHTML``. Although a security issue wasn't\n+identified there, out of an abundance of caution it's also updated to use\n+``textContent``.\n \n Bugfixes\n ========"
        },
        {
          "filename": "docs/releases/1.9.8.txt",
          "status": "modified",
          "additions": 13,
          "deletions": 2,
          "patch": "@@ -2,9 +2,20 @@\n Django 1.9.8 release notes\n ==========================\n \n-*Under development*\n+*July 18, 2016*\n \n-Django 1.9.8 fixes several bugs in 1.9.7.\n+Django 1.9.8 fixes a security issue and several bugs in 1.9.7.\n+\n+XSS in admin's add/change related popup\n+=======================================\n+\n+Unsafe usage of JavaScript's ``Element.innerHTML`` could result in XSS in the\n+admin's add/change related popup. ``Element.textContent`` is now used to\n+prevent execution of the data.\n+\n+The debug view also used ``innerHTML``. Although a security issue wasn't\n+identified there, out of an abundance of caution it's also updated to use\n+``textContent``.\n \n Bugfixes\n ========"
        },
        {
          "filename": "tests/admin_views/models.py",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -17,13 +17,17 @@\n from django.utils.encoding import python_2_unicode_compatible\n \n \n+@python_2_unicode_compatible\n class Section(models.Model):\n     \"\"\"\n     A simple section that links to articles, to test linking to related items\n     in admin views.\n     \"\"\"\n     name = models.CharField(max_length=100)\n \n+    def __str__(self):\n+        return self.name\n+\n     @property\n     def name_property(self):\n         \"\"\""
        },
        {
          "filename": "tests/admin_views/tests.py",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -4625,8 +4625,10 @@ def test_list_editable_popups(self):\n         \"\"\"\n         list_editable foreign keys have add/change popups.\n         \"\"\"\n+        from selenium.webdriver.support.ui import Select\n         s1 = Section.objects.create(name='Test section')\n         Article.objects.create(\n+            title='foo',\n             content='<p>Middle content</p>',\n             date=datetime.datetime(2008, 3, 18, 11, 54, 58),\n             section=s1,\n@@ -4638,8 +4640,13 @@ def test_list_editable_popups(self):\n         self.wait_for_popup()\n         self.selenium.switch_to.window(self.selenium.window_handles[-1])\n         self.wait_for_text('#content h1', 'Change section')\n-        self.selenium.close()\n+        name_input = self.selenium.find_element_by_id('id_name')\n+        name_input.clear()\n+        name_input.send_keys('<i>edited section</i>')\n+        self.selenium.find_element_by_xpath('//input[@value=\"Save\"]').click()\n         self.selenium.switch_to.window(self.selenium.window_handles[0])\n+        select = Select(self.selenium.find_element_by_id('id_form-0-section'))\n+        self.assertEqual(select.first_selected_option.text, '<i>edited section</i>')\n \n         # Add popup\n         self.selenium.find_element_by_id('add_id_form-0-section').click()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "330d89d4fe7832355535580383523f1749a3ee45",
            "date": "2025-01-25T17:06:11Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "9cc3970eaaf603832c075618e61aea9ea430f719",
            "date": "2025-01-13T17:35:02Z",
            "author_login": "cliff688"
          },
          {
            "sha": "352d860b9107adbcde0f1fe5d0fce8e9090a51e4",
            "date": "2025-01-23T15:43:04Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "f133285a9a7f3647fd55abc2e57b8a9a2c11ac94",
            "date": "2025-01-23T14:28:04Z",
            "author_login": "nessita"
          },
          {
            "sha": "2c47207b3c8412d16e61e388f176b47b41b40794",
            "date": "2024-12-20T22:26:22Z",
            "author_login": "claudep"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in the dismissChangeRelatedObjectPopup function in contrib/admin/static/admin/js/admin/RelatedObjectLookups.js in Django before 1.8.14, 1.9.x before 1.9.8, and 1.10.x before 1.10rc1 allows remote attackers to inject arbitrary web script or HTML via vectors involving unsafe usage of Element.innerHTML.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-08-05T15:59:09.503",
    "last_modified": "2024-11-21T02:55:37.857",
    "fix_date": "2016-07-06T19:41:06Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/137965/Django-3.3.0-Script-Insertion.html",
      "source": "cve@mitre.org",
      "tags": [
        "VDB Entry"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-1594.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-1595.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-1596.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2016/Jul/53",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3622",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/538947/100/0/threaded",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/92058",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1036338",
      "source": "cve@mitre.org",
      "tags": [
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-3039-1",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.vulnerability-lab.com/get_content.php?id=1869",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/d03bf6fe4e9bf5b07de62c1a271c4b41a7d3d158",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/f68e5a99164867ab0e071a936470958ed867479d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DMLLFAUT4J4IP4P2KI4NOVWRMHA22WUJ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KHHPN6MISX5I6UTXQHYLPTLEEUE6WDXW/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.djangoproject.com/weblog/2016/jul/18/security-releases/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/40129/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://packetstormsecurity.com/files/137965/Django-3.3.0-Script-Insertion.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "VDB Entry"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-1594.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-1595.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-1596.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2016/Jul/53",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3622",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/538947/100/0/threaded",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/92058",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1036338",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-3039-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.vulnerability-lab.com/get_content.php?id=1869",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/d03bf6fe4e9bf5b07de62c1a271c4b41a7d3d158",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/f68e5a99164867ab0e071a936470958ed867479d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DMLLFAUT4J4IP4P2KI4NOVWRMHA22WUJ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KHHPN6MISX5I6UTXQHYLPTLEEUE6WDXW/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.djangoproject.com/weblog/2016/jul/18/security-releases/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/40129/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:46.764630",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "django",
    "owner": "django",
    "created_at": "2012-04-28T02:47:18Z",
    "updated_at": "2025-01-26T05:32:18Z",
    "pushed_at": "2025-01-25T17:07:46Z",
    "size": 265094,
    "stars": 82051,
    "forks": 32132,
    "open_issues": 307,
    "watchers": 82051,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "stable/0.90.x",
      "stable/0.91.x",
      "stable/0.95.x",
      "stable/0.96.x",
      "stable/1.0.x",
      "stable/1.1.x",
      "stable/1.2.x",
      "stable/1.3.x",
      "stable/1.4.x",
      "stable/1.5.x",
      "stable/1.6.x",
      "stable/1.7.x",
      "stable/1.8.x",
      "stable/1.9.x",
      "stable/1.10.x",
      "stable/1.11.x",
      "stable/2.0.x",
      "stable/2.1.x",
      "stable/2.2.x",
      "stable/3.0.x",
      "stable/3.1.x",
      "stable/3.2.x",
      "stable/4.0.x",
      "stable/4.1.x",
      "stable/4.2.x",
      "stable/5.0.x",
      "stable/5.1.x",
      "stable/5.2.x"
    ],
    "languages": {
      "Python": 17568436,
      "HTML": 250867,
      "JavaScript": 158876,
      "CSS": 92030,
      "Smarty": 392,
      "Procfile": 47
    },
    "commit_activity": {
      "total_commits_last_year": 967,
      "avg_commits_per_week": 18.596153846153847,
      "days_active_last_year": 295
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T08:02:15.044821"
  }
}