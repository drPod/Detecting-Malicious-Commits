{
  "cve_id": "CVE-2016-6191",
  "github_data": {
    "repository": "inverse-inc/sogo",
    "fix_commit": "64ce3c9c22fd9a28caabf11e76216cd53d0245aa",
    "related_commits": [
      "64ce3c9c22fd9a28caabf11e76216cd53d0245aa",
      "64ce3c9c22fd9a28caabf11e76216cd53d0245aa"
    ],
    "patch_url": "https://github.com/inverse-inc/sogo/commit/64ce3c9c22fd9a28caabf11e76216cd53d0245aa.patch",
    "fix_commit_details": {
      "sha": "64ce3c9c22fd9a28caabf11e76216cd53d0245aa",
      "commit_date": "2016-06-08T20:06:58Z",
      "author": {
        "login": "cgx",
        "type": "User",
        "stats": {
          "total_commits": 5550,
          "average_weekly_commits": 5.715756951596292,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 659
        }
      },
      "commit_message": {
        "title": "Escape HTML in raw source of events and tasks",
        "length": 58,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 8,
        "deletions": 7
      },
      "files": [
        {
          "filename": "NEWS",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -4,6 +4,7 @@\n Bug fixes\n  - [web] fixed generic avatar in lists (#3719)\n  - [web] fixed validation in Sieve filter editor\n+ - [web] properly encode events and tasks rawsource to avoid XSS issues (#3718)\n \n 3.1.2 (2016-06-06)\n ------------------"
        },
        {
          "filename": "UI/Scheduler/UIxComponentEditor.m",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -875,7 +875,7 @@ - (WOResponse *) rawAction\n   [content appendFormat: @\"%@\", [[self clientObject] contentAsString]];\n   [response setHeader: @\"text/plain; charset=utf-8\" \n             forKey: @\"content-type\"];\n-  [response appendContentString: content];\n+  [response appendContentString: [content stringByEscapingHTMLString]];\n \n   return response;\n }"
        },
        {
          "filename": "UI/WebServerResources/js/Scheduler/ComponentController.js",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -167,23 +167,23 @@\n           template: [\n             '<md-dialog flex=\"40\" flex-sm=\"80\" flex-xs=\"100\" aria-label=\"' + l('View Raw Source') + '\">',\n             '  <md-dialog-content class=\"md-dialog-content\">',\n-            '    <pre>',\n-            data,\n-            '    </pre>',\n+            '    <pre ng-bind-html=\"data\"></pre>',\n             '  </md-dialog-content>',\n             '  <md-dialog-actions>',\n             '    <md-button ng-click=\"close()\">' + l('Close') + '</md-button>',\n             '  </md-dialog-actions>',\n             '</md-dialog>'\n           ].join(''),\n-          controller: ComponentRawSourceDialogController\n+          controller: ComponentRawSourceDialogController,\n+          locals: { data: data }\n         });\n \n         /**\n          * @ngInject\n          */\n-        ComponentRawSourceDialogController.$inject = ['scope', '$mdDialog'];\n-        function ComponentRawSourceDialogController(scope, $mdDialog) {\n+        ComponentRawSourceDialogController.$inject = ['scope', '$mdDialog', 'data'];\n+        function ComponentRawSourceDialogController(scope, $mdDialog, data) {\n+          scope.data = data;\n           scope.close = function() {\n             $mdDialog.hide();\n           };"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9941e2a04b9807dbc0a7f3dc0b4e07210a8e55f4",
            "date": "2025-01-07T17:39:02Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "b40d777a86104d08dbd8168b8e12c198a3d4321a",
            "date": "2024-12-23T14:35:14Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "70f72eb92f0f14501758a5660391aa43862e98e7",
            "date": "2024-12-23T10:18:28Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "0a828a739e10299605eaff72ffaf90a1908b54e8",
            "date": "2024-12-18T09:39:27Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "395a01ed5204c6c138e7d855370dd8acf902e6b4",
            "date": "2024-12-17T17:27:53Z",
            "author_login": "WoodySlum"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in the View Raw Source page in the Web Calendar in SOGo before 3.1.3 allow remote attackers to inject arbitrary web script or HTML via the (1) Description, (2) Location, (3) URL, or (4) Title field.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-02-17T17:59:00.890",
    "last_modified": "2024-11-21T02:55:38.637",
    "fix_date": "2016-06-08T20:06:58Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/09/3",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/64ce3c9c22fd9a28caabf11e76216cd53d0245aa",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://sogo.nu/bugs/view.php?id=3718",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/09/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/inverse-inc/sogo/commit/64ce3c9c22fd9a28caabf11e76216cd53d0245aa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://sogo.nu/bugs/view.php?id=3718",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.227929",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sogo",
    "owner": "inverse-inc",
    "created_at": "2012-09-18T12:19:38Z",
    "updated_at": "2025-01-13T14:50:06Z",
    "pushed_at": "2025-01-14T10:12:13Z",
    "size": 179571,
    "stars": 1851,
    "forks": 278,
    "open_issues": 26,
    "watchers": 1851,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Objective-C": 5166699,
      "JavaScript": 1139785,
      "SCSS": 172305,
      "C": 115950,
      "Rich Text Format": 76362,
      "HTML": 75145,
      "Shell": 72483,
      "Java": 50238,
      "Makefile": 47449,
      "Perl": 32089,
      "Python": 31012,
      "CSS": 11864,
      "PHP": 3047,
      "PLSQL": 1055,
      "Mathematica": 986
    },
    "commit_activity": {
      "total_commits_last_year": 311,
      "avg_commits_per_week": 5.980769230769231,
      "days_active_last_year": 124
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:46:14.847524"
  }
}