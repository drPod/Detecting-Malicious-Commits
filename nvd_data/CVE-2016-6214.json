{
  "cve_id": "CVE-2016-6214",
  "github_data": {
    "repository": "libgd/libgd",
    "fix_commit": "10ef1dca63d62433fda13309b4a228782db823f7",
    "related_commits": [
      "10ef1dca63d62433fda13309b4a228782db823f7",
      "10ef1dca63d62433fda13309b4a228782db823f7"
    ],
    "patch_url": "https://github.com/libgd/libgd/commit/10ef1dca63d62433fda13309b4a228782db823f7.patch",
    "fix_commit_details": {
      "sha": "10ef1dca63d62433fda13309b4a228782db823f7",
      "commit_date": "2016-07-12T17:23:13Z",
      "author": {
        "login": "cmb69",
        "type": "User",
        "stats": {
          "total_commits": 223,
          "average_weekly_commits": 0.3118881118881119,
          "total_additions": 8118,
          "total_deletions": 2986,
          "weeks_active": 54
        }
      },
      "commit_message": {
        "title": "Unsupported TGA bpp/alphabit combinations should error gracefully",
        "length": 211,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 41,
        "additions": 30,
        "deletions": 11
      },
      "files": [
        {
          "filename": "src/gd_tga.c",
          "status": "modified",
          "additions": 6,
          "deletions": 10,
          "patch": "@@ -99,7 +99,7 @@ BGD_DECLARE(gdImagePtr) gdImageCreateFromTgaCtx(gdIOCtx* ctx)\n \t\t\tif (tga->bits == TGA_BPP_24) {\n \t\t\t\t*tpix = gdTrueColor(tga->bitmap[bitmap_caret + 2], tga->bitmap[bitmap_caret + 1], tga->bitmap[bitmap_caret]);\n \t\t\t\tbitmap_caret += 3;\n-\t\t\t} else if (tga->bits == TGA_BPP_32 || tga->alphabits) {\n+\t\t\t} else if (tga->bits == TGA_BPP_32 && tga->alphabits) {\n \t\t\t\tregister int a = tga->bitmap[bitmap_caret + 3];\n \n \t\t\t\t*tpix = gdTrueColorAlpha(tga->bitmap[bitmap_caret + 2], tga->bitmap[bitmap_caret + 1], tga->bitmap[bitmap_caret], gdAlphaMax - (a >> 1));\n@@ -159,16 +159,12 @@ int read_header_tga(gdIOCtx *ctx, oTga *tga)\n \tprintf(\"wxh: %i %i\\n\", tga->width, tga->height);\n #endif\n \n-\tswitch(tga->bits) {\n-\tcase 8:\n-\tcase 16:\n-\tcase 24:\n-\tcase 32:\n-\t\tbreak;\n-\tdefault:\n-\t\tgd_error(\"bps %i not supported\", tga->bits);\n+\tif (!((tga->bits == TGA_BPP_24 && tga->alphabits == 0)\n+\t\t|| (tga->bits == TGA_BPP_32 && tga->alphabits == 8)))\n+\t{\n+\t\tgd_error_ex(GD_WARNING, \"gd-tga: %u bits per pixel with %u alpha bits not supported\\n\",\n+\t\t\ttga->bits, tga->alphabits);\n \t\treturn -1;\n-\t\tbreak;\n \t}\n \n \ttga->ident = NULL;"
        },
        {
          "filename": "tests/tga/.gitignore",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,3 +1,4 @@\n /bug00084\n /bug00247\n+/bug00247a\n /tga_null"
        },
        {
          "filename": "tests/tga/CMakeLists.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -2,6 +2,7 @@ LIST(APPEND TESTS_FILES\n \ttga_null\n \tbug00084\n \tbug00247\n+\tbug00247a\n )\n \n ADD_GD_TESTS()"
        },
        {
          "filename": "tests/tga/Makemodule.am",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -1,9 +1,11 @@\n libgd_test_programs += \\\n \ttga/bug00084 \\\n \ttga/bug00247 \\\n+\ttag/bug00247a \\\n \ttga/tga_null\n \n EXTRA_DIST += \\\n \ttga/CMakeLists.txt \\\n \ttga/bug00084.tga \\\n-\ttga/bug00247.tga\n+\ttga/bug00247.tga \\\n+\ttga/bug00247a.tga"
        },
        {
          "filename": "tests/tga/bug00247a.c",
          "status": "added",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -0,0 +1,19 @@\n+/*\n+We test that a 8bpp TGA file will be gracefully rejected by\n+gdImageCreateFromTga().\n+*/\n+\n+#include <stdio.h>\n+\n+#include \"gd.h\"\n+#include \"gdtest.h\"\n+\n+int main(int argc, char **argv)\n+{\n+    gdImagePtr im;\n+    FILE *fp = gdTestFileOpen(\"tga/bug00247a.tga\");\n+    im = gdImageCreateFromTga(fp);\n+    gdTestAssert(im == NULL);\n+    fclose(fp);\n+    return gdNumFailures();\n+}"
        },
        {
          "filename": "tests/tga/bug00247a.tga",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 5,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "721f9228c2cce7d1361a2f3fd95ec95b8b959dbf",
            "date": "2025-01-10T11:37:52Z",
            "author_login": "cmb69"
          },
          {
            "sha": "d69be67d4946d2a92da7308a4b5820afa73b5a99",
            "date": "2025-01-10T11:31:49Z",
            "author_login": "cmb69"
          },
          {
            "sha": "c2a5cbc74f407da0e38e9cbfdefb454e5a3300c2",
            "date": "2025-01-09T13:41:13Z",
            "author_login": "cmb69"
          },
          {
            "sha": "56d34bc6142f2aaa289d43ed95eee5a493a71cd7",
            "date": "2025-01-09T13:22:12Z",
            "author_login": "cmb69"
          },
          {
            "sha": "a656f5cc5592757996e9e96b0821a0966bfaa3b3",
            "date": "2025-01-09T12:11:19Z",
            "author_login": "cmb69"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "gd_tga.c in the GD Graphics Library (aka libgd) before 2.2.3 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted TGA file.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2016-08-12T15:59:04.980",
    "last_modified": "2024-11-21T02:55:41.130",
    "fix_date": "2016-07-12T17:23:13Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-08/msg00086.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-09/msg00078.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3619",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/13/12",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/13/5",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-3060-1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/libgd/libgd/commit/10ef1dca63d62433fda13309b4a228782db823f7",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgd/libgd/issues/247#issuecomment-232084241",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://libgd.github.io/release-2.2.3.html",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-08/msg00086.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-updates/2016-09/msg00078.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2016/dsa-3619",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/13/12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/07/13/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.ubuntu.com/usn/USN-3060-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/libgd/libgd/commit/10ef1dca63d62433fda13309b4a228782db823f7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgd/libgd/issues/247#issuecomment-232084241",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://libgd.github.io/release-2.2.3.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:46.775697",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libgd",
    "owner": "libgd",
    "created_at": "2015-01-22T08:50:57Z",
    "updated_at": "2025-01-12T09:49:38Z",
    "pushed_at": "2025-01-11T04:02:17Z",
    "size": 26535,
    "stars": 909,
    "forks": 273,
    "open_issues": 130,
    "watchers": 909,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "GD-2.1",
      "GD-2.2",
      "GD-2.3"
    ],
    "languages": {
      "C": 1645033,
      "CMake": 68297,
      "C++": 65997,
      "M4": 46524,
      "HTML": 42081,
      "Shell": 37342,
      "Makefile": 10014,
      "Perl": 3997,
      "Batchfile": 2234,
      "Tcl": 1381,
      "Python": 1206
    },
    "commit_activity": {
      "total_commits_last_year": 41,
      "avg_commits_per_week": 0.7884615384615384,
      "days_active_last_year": 20
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:09:06.928326"
  }
}