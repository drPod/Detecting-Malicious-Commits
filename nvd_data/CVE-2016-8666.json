{
  "cve_id": "CVE-2016-8666",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "fac8e0f579695a3ecbc4d3cac369139d7f819971",
    "related_commits": [
      "fac8e0f579695a3ecbc4d3cac369139d7f819971",
      "fac8e0f579695a3ecbc4d3cac369139d7f819971"
    ],
    "patch_url": "https://github.com/torvalds/linux/commit/fac8e0f579695a3ecbc4d3cac369139d7f819971.patch",
    "fix_commit_details": {
      "sha": "fac8e0f579695a3ecbc4d3cac369139d7f819971",
      "commit_date": "2016-03-19T16:32:01Z",
      "author": {
        "login": "jessegross",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "tunnels: Don't apply GRO to multiple layers of encapsulation.",
        "length": 950,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 47,
        "additions": 39,
        "deletions": 8
      },
      "files": [
        {
          "filename": "include/linux/netdevice.h",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2096,8 +2096,8 @@ struct napi_gro_cb {\n \t/* This is non-zero if the packet may be of the same flow. */\n \tu8\tsame_flow:1;\n \n-\t/* Used in udp_gro_receive */\n-\tu8\tudp_mark:1;\n+\t/* Used in tunnel GRO receive */\n+\tu8\tencap_mark:1;\n \n \t/* GRO checksum is valid */\n \tu8\tcsum_valid:1;"
        },
        {
          "filename": "net/core/dev.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -4438,7 +4438,7 @@ static enum gro_result dev_gro_receive(struct napi_struct *napi, struct sk_buff\n \t\tNAPI_GRO_CB(skb)->same_flow = 0;\n \t\tNAPI_GRO_CB(skb)->flush = 0;\n \t\tNAPI_GRO_CB(skb)->free = 0;\n-\t\tNAPI_GRO_CB(skb)->udp_mark = 0;\n+\t\tNAPI_GRO_CB(skb)->encap_mark = 0;\n \t\tNAPI_GRO_CB(skb)->gro_remcsum_start = 0;\n \n \t\t/* Setup for GRO checksum validation */"
        },
        {
          "filename": "net/ipv4/af_inet.c",
          "status": "modified",
          "additions": 14,
          "deletions": 1,
          "patch": "@@ -1380,6 +1380,19 @@ static struct sk_buff **inet_gro_receive(struct sk_buff **head,\n \treturn pp;\n }\n \n+static struct sk_buff **ipip_gro_receive(struct sk_buff **head,\n+\t\t\t\t\t struct sk_buff *skb)\n+{\n+\tif (NAPI_GRO_CB(skb)->encap_mark) {\n+\t\tNAPI_GRO_CB(skb)->flush = 1;\n+\t\treturn NULL;\n+\t}\n+\n+\tNAPI_GRO_CB(skb)->encap_mark = 1;\n+\n+\treturn inet_gro_receive(head, skb);\n+}\n+\n #define SECONDS_PER_DAY\t86400\n \n /* inet_current_timestamp - Return IP network timestamp\n@@ -1682,7 +1695,7 @@ static struct packet_offload ip_packet_offload __read_mostly = {\n static const struct net_offload ipip_offload = {\n \t.callbacks = {\n \t\t.gso_segment\t= inet_gso_segment,\n-\t\t.gro_receive\t= inet_gro_receive,\n+\t\t.gro_receive\t= ipip_gro_receive,\n \t\t.gro_complete\t= ipip_gro_complete,\n \t},\n };"
        },
        {
          "filename": "net/ipv4/gre_offload.c",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -126,6 +126,11 @@ static struct sk_buff **gre_gro_receive(struct sk_buff **head,\n \tstruct packet_offload *ptype;\n \t__be16 type;\n \n+\tif (NAPI_GRO_CB(skb)->encap_mark)\n+\t\tgoto out;\n+\n+\tNAPI_GRO_CB(skb)->encap_mark = 1;\n+\n \toff = skb_gro_offset(skb);\n \thlen = off + sizeof(*greh);\n \tgreh = skb_gro_header_fast(skb, off);"
        },
        {
          "filename": "net/ipv4/udp_offload.c",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -311,14 +311,14 @@ struct sk_buff **udp_gro_receive(struct sk_buff **head, struct sk_buff *skb,\n \tunsigned int off = skb_gro_offset(skb);\n \tint flush = 1;\n \n-\tif (NAPI_GRO_CB(skb)->udp_mark ||\n+\tif (NAPI_GRO_CB(skb)->encap_mark ||\n \t    (skb->ip_summed != CHECKSUM_PARTIAL &&\n \t     NAPI_GRO_CB(skb)->csum_cnt == 0 &&\n \t     !NAPI_GRO_CB(skb)->csum_valid))\n \t\tgoto out;\n \n-\t/* mark that this skb passed once through the udp gro layer */\n-\tNAPI_GRO_CB(skb)->udp_mark = 1;\n+\t/* mark that this skb passed once through the tunnel gro layer */\n+\tNAPI_GRO_CB(skb)->encap_mark = 1;\n \n \trcu_read_lock();\n \tuo_priv = rcu_dereference(udp_offload_base);"
        },
        {
          "filename": "net/ipv6/ip6_offload.c",
          "status": "modified",
          "additions": 14,
          "deletions": 1,
          "patch": "@@ -258,6 +258,19 @@ static struct sk_buff **ipv6_gro_receive(struct sk_buff **head,\n \treturn pp;\n }\n \n+static struct sk_buff **sit_gro_receive(struct sk_buff **head,\n+\t\t\t\t\tstruct sk_buff *skb)\n+{\n+\tif (NAPI_GRO_CB(skb)->encap_mark) {\n+\t\tNAPI_GRO_CB(skb)->flush = 1;\n+\t\treturn NULL;\n+\t}\n+\n+\tNAPI_GRO_CB(skb)->encap_mark = 1;\n+\n+\treturn ipv6_gro_receive(head, skb);\n+}\n+\n static int ipv6_gro_complete(struct sk_buff *skb, int nhoff)\n {\n \tconst struct net_offload *ops;\n@@ -302,7 +315,7 @@ static struct packet_offload ipv6_packet_offload __read_mostly = {\n static const struct net_offload sit_offload = {\n \t.callbacks = {\n \t\t.gso_segment\t= ipv6_gso_segment,\n-\t\t.gro_receive    = ipv6_gro_receive,\n+\t\t.gro_receive    = sit_gro_receive,\n \t\t.gro_complete   = sit_gro_complete,\n \t},\n };"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c3812b15000cc5b7b17c7238f8b12f6a22df0b1d",
            "date": "2025-01-14T18:07:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "79a1d390f879563119bf2848b621bc7eed228c7d",
            "date": "2025-01-14T17:54:57Z",
            "author_login": "torvalds"
          },
          {
            "sha": "c45323b7560ec87c37c729b703c86ee65f136d75",
            "date": "2025-01-13T17:03:18Z",
            "author_login": "torvalds"
          },
          {
            "sha": "34c8e74cd6667ef5da90d448a1af702c4b873bd3",
            "date": "2025-01-13T08:52:08Z",
            "author_login": "YageGeng"
          },
          {
            "sha": "cbc5dde0a461240046e8a41c43d7c3b76d5db952",
            "date": "2025-01-10T15:28:21Z",
            "author_login": "rikvanriel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "The IP stack in the Linux kernel before 4.6 allows remote attackers to cause a denial of service (stack consumption and panic) or possibly have unspecified other impact by triggering use of the GRO path for packets with tunnel stacking, as demonstrated by interleaved IPv4 headers and GRE headers, a related issue to CVE-2016-7039.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2016-10-16T21:59:15.523",
    "last_modified": "2024-11-21T02:59:47.700",
    "fix_date": "2016-03-19T16:32:01Z"
  },
  "references": [
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=fac8e0f579695a3ecbc4d3cac369139d7f819971",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2047.html",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2107.html",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2110.html",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0004.html",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/10/13/11",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/93562",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:0372",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "https://bto.bluecoat.com/security-advisory/sa134",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1384991",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1001486",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "https://github.com/torvalds/linux/commit/fac8e0f579695a3ecbc4d3cac369139d7f819971",
      "source": "security@opentext.com",
      "tags": []
    },
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=fac8e0f579695a3ecbc4d3cac369139d7f819971",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2047.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2107.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2016-2110.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/10/13/11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/93562",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:0372",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bto.bluecoat.com/security-advisory/sa134",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1384991",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1001486",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/torvalds/linux/commit/fac8e0f579695a3ecbc4d3cac369139d7f819971",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:46.805510",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-14T12:39:03Z",
    "pushed_at": "2025-01-13T17:27:04Z",
    "size": 5361369,
    "stars": 185823,
    "forks": 54743,
    "open_issues": 437,
    "watchers": 185823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1326937103,
      "Assembly": 9568292,
      "Shell": 5072004,
      "Python": 2974128,
      "Makefile": 2713905,
      "Perl": 1253637,
      "Rust": 807711,
      "Roff": 202277,
      "C++": 173382,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71321,
      "Awk": 69539,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10172,
      "M4": 3329,
      "MATLAB": 2482,
      "sed": 2433,
      "Clojure": 2411,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 46007,
      "avg_commits_per_week": 884.75,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:59.486675"
  }
}