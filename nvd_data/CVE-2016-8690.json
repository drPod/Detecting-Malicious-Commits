{
  "cve_id": "CVE-2016-8690",
  "github_data": {
    "repository": "mdadams/jasper",
    "fix_commit": "8f62b4761711d036fd8964df256b938c809b7fca",
    "related_commits": [
      "8f62b4761711d036fd8964df256b938c809b7fca",
      "8f62b4761711d036fd8964df256b938c809b7fca"
    ],
    "patch_url": "https://github.com/mdadams/jasper/commit/8f62b4761711d036fd8964df256b938c809b7fca.patch",
    "fix_commit_details": {
      "sha": "8f62b4761711d036fd8964df256b938c809b7fca",
      "commit_date": "2016-10-16T03:32:23Z",
      "author": {
        "login": "mdadams",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed a sanitizer failure in the BMP codec.",
        "length": 138,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 23,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/appl/imginfo.c",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -85,7 +85,8 @@ typedef enum {\n \tOPT_HELP,\n \tOPT_VERSION,\n \tOPT_VERBOSE,\n-\tOPT_INFILE\n+\tOPT_INFILE,\n+\tOPT_DEBUG\n } optid_t;\n \n /******************************************************************************\\\n@@ -104,6 +105,7 @@ static jas_opt_t opts[] = {\n \t{OPT_VERSION, \"version\", 0},\n \t{OPT_VERBOSE, \"verbose\", 0},\n \t{OPT_INFILE, \"f\", JAS_OPT_HASARG},\n+\t{OPT_DEBUG, \"debug-level\", JAS_OPT_HASARG},\n \t{-1, 0, 0}\n };\n \n@@ -126,6 +128,7 @@ int main(int argc, char **argv)\n \tint numcmpts;\n \tint verbose;\n \tchar *fmtname;\n+\tint debug;\n \n \tif (jas_init()) {\n \t\tabort();\n@@ -135,6 +138,7 @@ int main(int argc, char **argv)\n \n \tinfile = 0;\n \tverbose = 0;\n+\tdebug = 0;\n \n \t/* Parse the command line options. */\n \twhile ((id = jas_getopt(argc, argv, opts)) >= 0) {\n@@ -146,6 +150,9 @@ int main(int argc, char **argv)\n \t\t\tprintf(\"%s\\n\", JAS_VERSION);\n \t\t\texit(EXIT_SUCCESS);\n \t\t\tbreak;\n+\t\tcase OPT_DEBUG:\n+\t\t\tdebug = atoi(jas_optarg);\n+\t\t\tbreak;\n \t\tcase OPT_INFILE:\n \t\t\tinfile = jas_optarg;\n \t\t\tbreak;\n@@ -156,6 +163,8 @@ int main(int argc, char **argv)\n \t\t}\n \t}\n \n+\tjas_setdbglevel(debug);\n+\n \t/* Open the image file. */\n \tif (infile) {\n \t\t/* The image is to be read from a file. */\n@@ -177,6 +186,7 @@ int main(int argc, char **argv)\n \n \t/* Decode the image. */\n \tif (!(image = jas_image_decode(instream, fmtid, 0))) {\n+\t\tjas_stream_close(instream);\n \t\tfprintf(stderr, \"cannot load image\\n\");\n \t\treturn EXIT_FAILURE;\n \t}"
        },
        {
          "filename": "src/libjasper/bmp/bmp_dec.c",
          "status": "modified",
          "additions": 12,
          "deletions": 1,
          "patch": "@@ -77,6 +77,7 @@\n #include \"jasper/jas_stream.h\"\n #include \"jasper/jas_image.h\"\n #include \"jasper/jas_malloc.h\"\n+#include \"jasper/jas_debug.h\"\n \n #include \"bmp_cod.h\"\n \n@@ -122,12 +123,22 @@ jas_image_t *bmp_decode(jas_stream_t *in, char *optstr)\n \t\tjas_eprintf(\"cannot get header\\n\");\n \t\treturn 0;\n \t}\n+\tJAS_DBGLOG(1, (\n+\t  \"BMP header: magic 0x%x; siz %d; res1 %d; res2 %d; off %d\\n\",\n+\t  hdr.magic, hdr.siz, hdr.reserved1, hdr.reserved2, hdr.off\n+\t  ));\n \n \t/* Read the bitmap information. */\n \tif (!(info = bmp_getinfo(in))) {\n \t\tjas_eprintf(\"cannot get info\\n\");\n \t\treturn 0;\n \t}\n+\tJAS_DBGLOG(1,\n+\t  (\"BMP information: len %d; width %d; height %d; numplanes %d; \"\n+\t  \"depth %d; enctype %d; siz %d; hres %d; vres %d; numcolors %d; \"\n+\t  \"mincolors %d\\n\", info->len, info->width, info->height, info->numplanes,\n+\t  info->depth, info->enctype, info->siz, info->hres, info->vres,\n+\t  info->numcolors, info->mincolors));\n \n \t/* Ensure that we support this type of BMP file. */\n \tif (!bmp_issupported(&hdr, info)) {\n@@ -440,7 +451,7 @@ static int bmp_getint32(jas_stream_t *in, int_fast32_t *val)\n \t\tif ((c = jas_stream_getc(in)) == EOF) {\n \t\t\treturn -1;\n \t\t}\n-\t\tv |= (c << 24);\n+\t\tv |= (JAS_CAST(uint_fast32_t, c) << 24);\n \t\tif (--n <= 0) {\n \t\t\tbreak;\n \t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8766848706a727f61c1c76a5a7cf1078433fad02",
            "date": "2024-04-27T17:53:19Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2d6b6e8a9987386afe388e1cde859d0182445e63",
            "date": "2024-04-27T17:49:23Z",
            "author_login": "mdadams"
          },
          {
            "sha": "29154a52b6c2b895ac3db60d51be9f2a995ee145",
            "date": "2024-04-10T06:11:01Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2fe7d2d73d18d9c7072507d462737b372f9d56bf",
            "date": "2024-03-30T16:57:05Z",
            "author_login": "mdadams"
          },
          {
            "sha": "6d084c53a77762f41bb5310713a5f1872fef55f5",
            "date": "2024-03-29T14:57:29Z",
            "author_login": "mdadams"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-476",
    "description": "The bmp_getdata function in libjasper/bmp/bmp_dec.c in JasPer before 1.900.5 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted BMP image in an imginfo command.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-02-15T19:59:00.750",
    "last_modified": "2024-11-21T02:59:51.347",
    "fix_date": "2016-10-16T03:32:23Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/08/23/6",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/10/16/14",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/93590",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/10/16/jasper-two-null-pointer-dereference-in-bmp_getdata-bmp_dec-c/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1385499",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/8f62b4761711d036fd8964df256b938c809b7fca",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/11/msg00023.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/22FCKKHQCQ3S6TZY5G44EFDTMWOJXJRD/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/08/23/6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/10/16/14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/93590",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/10/16/jasper-two-null-pointer-dereference-in-bmp_getdata-bmp_dec-c/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1385499",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/8f62b4761711d036fd8964df256b938c809b7fca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/11/msg00023.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/22FCKKHQCQ3S6TZY5G44EFDTMWOJXJRD/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.224418",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jasper",
    "owner": "mdadams",
    "created_at": "2016-09-16T18:52:32Z",
    "updated_at": "2025-01-10T13:03:21Z",
    "pushed_at": "2024-04-27T17:54:09Z",
    "size": 4405,
    "stars": 232,
    "forks": 102,
    "open_issues": 4,
    "watchers": 232,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1567274,
      "Shell": 147989,
      "CMake": 50869,
      "Roff": 3703,
      "Batchfile": 1905,
      "C++": 235
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:01:40.770708"
  }
}