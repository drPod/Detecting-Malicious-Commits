{
  "cve_id": "CVE-2016-9132",
  "github_data": {
    "repository": "randombit/botan",
    "fix_commit": "987ad747db6d0d7e36f840398f3cf02e2fbfd90f",
    "related_commits": [
      "987ad747db6d0d7e36f840398f3cf02e2fbfd90f",
      "987ad747db6d0d7e36f840398f3cf02e2fbfd90f"
    ],
    "patch_url": "https://github.com/randombit/botan/commit/987ad747db6d0d7e36f840398f3cf02e2fbfd90f.patch",
    "fix_commit_details": {
      "sha": "987ad747db6d0d7e36f840398f3cf02e2fbfd90f",
      "commit_date": "2016-11-28T10:31:02Z",
      "author": {
        "login": "randombit",
        "type": "User",
        "stats": {
          "total_commits": 13729,
          "average_weekly_commits": 14.081025641025642,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 791
        }
      },
      "commit_message": {
        "title": "Fix BER decoder integer overflow",
        "length": 32,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 58,
        "additions": 55,
        "deletions": 3
      },
      "files": [
        {
          "filename": "doc/security.rst",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -21,7 +21,16 @@ Advisories\n 2016\n ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n \n-* 2016-10-8871 (CVE-2016-8871) OAEP side channel\n+* 2016-11-27 (CVE-2016-xxxx) Integer overflow in BER decoder\n+\n+  While decoding BER length fields, an integer overflow could occur. This could\n+  occur while parsing untrusted inputs such as X.509 certificates. The overflow\n+  does not seem to lead to any obviously exploitable condition, but exploitation\n+  cannot be positively ruled out. Only 32-bit platforms are likely affected; to\n+  cause an overflow on 64-bit the parsed data would have to be many gigabytes.\n+  Bug found by Falko Strenzke, cryptosource GmbH.\n+\n+* 2016-10-26 (CVE-2016-8871) OAEP side channel\n \n   A side channel in OAEP decoding could be used to distinguish RSA ciphertexts\n   that did or did not have a leading 0 byte. For an attacker capable of"
        },
        {
          "filename": "src/lib/asn1/ber_dec.cpp",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -9,6 +9,7 @@\n #include <botan/ber_dec.h>\n #include <botan/bigint.h>\n #include <botan/loadstor.h>\n+#include <botan/internal/safeint.h>\n \n namespace Botan {\n \n@@ -126,7 +127,9 @@ size_t find_eoc(DataSource* ber)\n       size_t item_size = decode_length(&source, length_size);\n       source.discard_next(item_size);\n \n-      length += item_size + length_size + tag_size;\n+      length = BOTAN_CHECKED_ADD(length, item_size);\n+      length = BOTAN_CHECKED_ADD(length, tag_size);\n+      length = BOTAN_CHECKED_ADD(length, length_size);\n \n       if(type_tag == EOC && class_tag == UNIVERSAL)\n          break;"
        },
        {
          "filename": "src/lib/utils/info.txt",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-define UTIL_FUNCTIONS 20150919\n+define UTIL_FUNCTIONS 20161127\n \n load_on always\n \n@@ -31,6 +31,7 @@ filesystem.h\n os_utils.h\n prefetch.h\n rounding.h\n+safeint.h\n semaphore.h\n stl_util.h\n </header:internal>"
        },
        {
          "filename": "src/lib/utils/safeint.h",
          "status": "added",
          "additions": 39,
          "deletions": 0,
          "patch": "@@ -0,0 +1,39 @@\n+/*\n+* Safe(r) Integer Handling\n+* (C) 2016 Jack Lloyd\n+*\n+* Botan is released under the Simplified BSD License (see license.txt)\n+*/\n+\n+#ifndef BOTAN_UTILS_SAFE_INT_H__\n+#define BOTAN_UTILS_SAFE_INT_H__\n+\n+#include <botan/exceptn.h>\n+#include <string>\n+\n+namespace Botan {\n+\n+class Integer_Overflow_Detected : public Exception\n+   {\n+   public:\n+      Integer_Overflow_Detected(const std::string& file, int line) :\n+         Exception(\"Integer overflow detected at \" + file + \":\" + std::to_string(line))\n+         {}\n+   };\n+\n+inline size_t checked_add(size_t x, size_t y, const char* file, int line)\n+   {\n+   // TODO: use __builtin_x_overflow on GCC and Clang\n+   size_t z = x + y;\n+   if(z < x)\n+      {\n+      throw Integer_Overflow_Detected(file, line);\n+      }\n+   return z;\n+   }\n+\n+#define BOTAN_CHECKED_ADD(x,y) checked_add(x,y,__FILE__,__LINE__)\n+\n+}\n+\n+#endif"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88c33405780a2cb28a2b2ba0b63bd9d0b088bf1b",
            "date": "2025-01-14T12:03:56Z",
            "author_login": "reneme"
          },
          {
            "sha": "8a93d909a7f42a41f7841885cabf722f3649ab7a",
            "date": "2025-01-14T07:59:06Z",
            "author_login": "randombit"
          },
          {
            "sha": "e7786aa9f8ca00e3f10f21e05215ac12ca7f1c90",
            "date": "2025-01-14T07:56:40Z",
            "author_login": "reneme"
          },
          {
            "sha": "17593ebb6d2c0955713d72d12d6c178027d46073",
            "date": "2025-01-13T22:22:41Z",
            "author_login": "randombit"
          },
          {
            "sha": "b6b38efd263d1a65ac364248ca5555d40b1d16a5",
            "date": "2025-01-13T12:05:31Z",
            "author_login": "randombit"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "In Botan 1.8.0 through 1.11.33, when decoding BER data an integer overflow could occur, which would cause an incorrect length field to be computed. Some API callers may use the returned (incorrect and attacker controlled) length field in a way which later causes memory corruption or other failure.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-01-30T22:59:00.827",
    "last_modified": "2024-11-21T03:00:40.820",
    "fix_date": "2016-11-28T10:31:02Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/95879",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/randombit/botan/commit/987ad747db6d0d7e36f840398f3cf02e2fbfd90f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4OUDGVRQYQUL7F5MRP3LAV7EHRJG4BBE/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/Z2Y3JLMTE3VIV4X5X6SXVZTJBDDLCS3D/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/95879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/randombit/botan/commit/987ad747db6d0d7e36f840398f3cf02e2fbfd90f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4OUDGVRQYQUL7F5MRP3LAV7EHRJG4BBE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/Z2Y3JLMTE3VIV4X5X6SXVZTJBDDLCS3D/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:49.848893",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "botan",
    "owner": "randombit",
    "created_at": "2013-03-06T16:51:39Z",
    "updated_at": "2025-01-14T12:22:38Z",
    "pushed_at": "2025-01-14T13:10:17Z",
    "size": 106654,
    "stars": 2776,
    "forks": 574,
    "open_issues": 215,
    "watchers": 2776,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "insito-bib",
      "master",
      "release-1_8",
      "release-1_10",
      "release-2",
      "release-3"
    ],
    "languages": {
      "C++": 9975206,
      "Python": 672161,
      "C": 204972,
      "Shell": 25498,
      "CMake": 8895,
      "PowerShell": 1888,
      "Emacs Lisp": 1313,
      "HTML": 184
    },
    "commit_activity": {
      "total_commits_last_year": 1232,
      "avg_commits_per_week": 23.692307692307693,
      "days_active_last_year": 242
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-2-clause"
    },
    "collected_at": "2025-01-14T13:10:52.207996"
  }
}