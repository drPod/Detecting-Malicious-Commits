{
  "cve_id": "CVE-2016-9388",
  "github_data": {
    "repository": "mdadams/jasper",
    "fix_commit": "411a4068f8c464e883358bf403a3e25158863823",
    "related_commits": [
      "411a4068f8c464e883358bf403a3e25158863823",
      "411a4068f8c464e883358bf403a3e25158863823"
    ],
    "patch_url": "https://github.com/mdadams/jasper/commit/411a4068f8c464e883358bf403a3e25158863823.patch",
    "fix_commit_details": {
      "sha": "411a4068f8c464e883358bf403a3e25158863823",
      "commit_date": "2016-10-24T13:56:08Z",
      "author": {
        "login": "mdadams",
        "type": "User",
        "stats": {
          "total_commits": 971,
          "average_weekly_commits": 1.2742782152230971,
          "total_additions": 188275,
          "total_deletions": 114603,
          "weeks_active": 97
        }
      },
      "commit_message": {
        "title": "Fixed a few bugs in the RAS encoder and decoder where errors were tested",
        "length": 125,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 59,
        "additions": 47,
        "deletions": 12
      },
      "files": [
        {
          "filename": "src/libjasper/ras/ras_dec.c",
          "status": "modified",
          "additions": 24,
          "deletions": 6,
          "patch": "@@ -260,9 +260,16 @@ static int ras_getdatastd(jas_stream_t *in, ras_hdr_t *hdr, ras_cmap_t *cmap,\n \t/* Avoid compiler warnings about unused parameters. */\n \tcmap = 0;\n \n+\tassert(jas_image_numcmpts(image) <= 3);\n+\n+\tfor (i = 0; i < 3; ++i) {\n+\t\tdata[i] = 0;\n+\t}\n+\n \tfor (i = 0; i < jas_image_numcmpts(image); ++i) {\n-\t\tdata[i] = jas_matrix_create(1, jas_image_width(image));\n-\t\tassert(data[i]);\n+\t\tif (!(data[i] = jas_matrix_create(1, jas_image_width(image)))) {\n+\t\t\tgoto error;\n+\t\t}\n \t}\n \n \tpad = RAS_ROWSIZE(hdr) - (hdr->width * hdr->depth + 7) / 8;\n@@ -273,7 +280,7 @@ static int ras_getdatastd(jas_stream_t *in, ras_hdr_t *hdr, ras_cmap_t *cmap,\n \t\tfor (x = 0; x < hdr->width; x++) {\n \t\t\twhile (nz < hdr->depth) {\n \t\t\t\tif ((c = jas_stream_getc(in)) == EOF) {\n-\t\t\t\t\treturn -1;\n+\t\t\t\t\tgoto error;\n \t\t\t\t}\n \t\t\t\tz = (z << 8) | c;\n \t\t\t\tnz += 8;\n@@ -293,22 +300,31 @@ static int ras_getdatastd(jas_stream_t *in, ras_hdr_t *hdr, ras_cmap_t *cmap,\n \t\t}\n \t\tif (pad) {\n \t\t\tif ((c = jas_stream_getc(in)) == EOF) {\n-\t\t\t\treturn -1;\n+\t\t\t\tgoto error;\n \t\t\t}\n \t\t}\n \t\tfor (i = 0; i < jas_image_numcmpts(image); ++i) {\n \t\t\tif (jas_image_writecmpt(image, i, 0, y, hdr->width, 1,\n \t\t\t  data[i])) {\n-\t\t\t\treturn -1;\n+\t\t\t\tgoto error;\n \t\t\t}\n \t\t}\n \t}\n \n \tfor (i = 0; i < jas_image_numcmpts(image); ++i) {\n \t\tjas_matrix_destroy(data[i]);\n+\t\tdata[i] = 0;\n \t}\n \n \treturn 0;\n+\n+error:\n+\tfor (i = 0; i < 3; ++i) {\n+\t\tif (data[i]) {\n+\t\t\tjas_matrix_destroy(data[i]);\n+\t\t}\n+\t}\n+\treturn -1;\n }\n \n static int ras_getcmap(jas_stream_t *in, ras_hdr_t *hdr, ras_cmap_t *cmap)\n@@ -327,7 +343,9 @@ static int ras_getcmap(jas_stream_t *in, ras_hdr_t *hdr, ras_cmap_t *cmap)\n \t\t{\n \t\tjas_eprintf(\"warning: palettized images not fully supported\\n\");\n \t\tnumcolors = 1 << hdr->depth;\n-\t\tassert(numcolors <= RAS_CMAP_MAXSIZ);\n+\t\tif (numcolors > RAS_CMAP_MAXSIZ) {\n+\t\t\treturn -1;\n+\t\t}\n \t\tactualnumcolors = hdr->maplength / 3;\n \t\tfor (i = 0; i < numcolors; i++) {\n \t\t\tcmap->data[i] = 0;"
        },
        {
          "filename": "src/libjasper/ras/ras_enc.c",
          "status": "modified",
          "additions": 23,
          "deletions": 6,
          "patch": "@@ -230,9 +230,17 @@ static int ras_putdatastd(jas_stream_t *out, ras_hdr_t *hdr, jas_image_t *image,\n \tjas_matrix_t *data[3];\n \tint i;\n \n+\tassert(numcmpts <= 3);\n+\n+\tfor (i = 0; i < 3; ++i) {\n+\t\tdata[i] = 0;\n+\t}\n+\n \tfor (i = 0; i < numcmpts; ++i) {\n-\t\tdata[i] = jas_matrix_create(jas_image_height(image), jas_image_width(image));\n-\t\tassert(data[i]);\n+\t\tif (!(data[i] = jas_matrix_create(jas_image_height(image),\n+\t\t  jas_image_width(image)))) {\n+\t\t\tgoto error;\n+\t\t}\n \t}\n \n \trowsize = RAS_ROWSIZE(hdr);\n@@ -244,7 +252,7 @@ static int ras_putdatastd(jas_stream_t *out, ras_hdr_t *hdr, jas_image_t *image,\n \t\tfor (i = 0; i < numcmpts; ++i) {\n \t\t\tif (jas_image_readcmpt(image, cmpts[i], 0, y,\n \t\t\t\t\tjas_image_width(image), 1, data[i])) {\n-\t\t\t\treturn -1;\n+\t\t\t\tgoto error;\n \t\t\t}\n \t\t}\n \t\tz = 0;\n@@ -263,7 +271,7 @@ static int ras_putdatastd(jas_stream_t *out, ras_hdr_t *hdr, jas_image_t *image,\n \t\t\twhile (nz >= 8) {\n \t\t\t\tc = (z >> (nz - 8)) & 0xff;\n \t\t\t\tif (jas_stream_putc(out, c) == EOF) {\n-\t\t\t\t\treturn -1;\n+\t\t\t\t\tgoto error;\n \t\t\t\t}\n \t\t\t\tnz -= 8;\n \t\t\t\tz &= RAS_ONES(nz);\n@@ -272,21 +280,30 @@ static int ras_putdatastd(jas_stream_t *out, ras_hdr_t *hdr, jas_image_t *image,\n \t\tif (nz > 0) {\n \t\t\tc = (z >> (8 - nz)) & RAS_ONES(nz);\n \t\t\tif (jas_stream_putc(out, c) == EOF) {\n-\t\t\t\treturn -1;\n+\t\t\t\tgoto error;\n \t\t\t}\n \t\t}\n \t\tif (pad % 2) {\n \t\t\tif (jas_stream_putc(out, 0) == EOF) {\n-\t\t\t\treturn -1;\n+\t\t\t\tgoto error;\n \t\t\t}\n \t\t}\n \t}\n \n \tfor (i = 0; i < numcmpts; ++i) {\n \t\tjas_matrix_destroy(data[i]);\n+\t\tdata[i] = 0;\n \t}\n \n \treturn 0;\n+\n+error:\n+\tfor (i = 0; i < numcmpts; ++i) {\n+\t\tif (data[i]) {\n+\t\t\tjas_matrix_destroy(data[i]);\n+\t\t}\n+\t}\n+\treturn -1;\n }\n \n static int ras_puthdr(jas_stream_t *out, ras_hdr_t *hdr)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8766848706a727f61c1c76a5a7cf1078433fad02",
            "date": "2024-04-27T17:53:19Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2d6b6e8a9987386afe388e1cde859d0182445e63",
            "date": "2024-04-27T17:49:23Z",
            "author_login": "mdadams"
          },
          {
            "sha": "29154a52b6c2b895ac3db60d51be9f2a995ee145",
            "date": "2024-04-10T06:11:01Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2fe7d2d73d18d9c7072507d462737b372f9d56bf",
            "date": "2024-03-30T16:57:05Z",
            "author_login": "mdadams"
          },
          {
            "sha": "6d084c53a77762f41bb5310713a5f1872fef55f5",
            "date": "2024-03-29T14:57:29Z",
            "author_login": "mdadams"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "The ras_getcmap function in ras_dec.c in JasPer before 1.900.14 allows remote attackers to cause a denial of service (assertion failure) via a crafted image file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-03-23T18:59:00.617",
    "last_modified": "2024-11-21T03:01:05.040",
    "fix_date": "2016-10-24T13:56:08Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/11/17/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/94371",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1396962",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/411a4068f8c464e883358bf403a3e25158863823",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3693-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/11/17/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/94371",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1396962",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/411a4068f8c464e883358bf403a3e25158863823",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3693-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.816986",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jasper",
    "owner": "mdadams",
    "created_at": "2016-09-16T18:52:32Z",
    "updated_at": "2025-01-10T13:03:21Z",
    "pushed_at": "2024-04-27T17:54:09Z",
    "size": 4405,
    "stars": 232,
    "forks": 102,
    "open_issues": 4,
    "watchers": 232,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1567274,
      "Shell": 147989,
      "CMake": 50869,
      "Roff": 3703,
      "Batchfile": 1905,
      "C++": 235
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:01:40.770708"
  }
}