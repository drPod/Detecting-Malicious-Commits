{
  "cve_id": "CVE-2016-9394",
  "github_data": {
    "repository": "mdadams/jasper",
    "fix_commit": "f7038068550fba0e41e1d0c355787f1dcd5bf330",
    "related_commits": [
      "f7038068550fba0e41e1d0c355787f1dcd5bf330",
      "f7038068550fba0e41e1d0c355787f1dcd5bf330"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f7038068550fba0e41e1d0c355787f1dcd5bf330",
      "commit_date": "2016-10-28T03:11:57Z",
      "author": {
        "login": "mdadams",
        "type": "User",
        "stats": {
          "total_commits": 971,
          "average_weekly_commits": 1.2709424083769634,
          "total_additions": 188275,
          "total_deletions": 114603,
          "weeks_active": 97
        }
      },
      "commit_message": {
        "title": "Added some missing sanity checks on the data in a SIZ marker segment.",
        "length": 69,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 57,
        "additions": 41,
        "deletions": 16
      },
      "files": [
        {
          "filename": "src/libjasper/jpc/jpc_cs.c",
          "status": "modified",
          "additions": 41,
          "deletions": 16,
          "patch": "@@ -489,6 +489,8 @@ static int jpc_siz_getparms(jpc_ms_t *ms, jpc_cstate_t *cstate,\n \tunsigned int i;\n \tuint_fast8_t tmp;\n \n+\tsiz->comps = 0;\n+\n \t/* Eliminate compiler warning about unused variables. */\n \tcstate = 0;\n \n@@ -502,44 +504,67 @@ static int jpc_siz_getparms(jpc_ms_t *ms, jpc_cstate_t *cstate,\n \t  jpc_getuint32(in, &siz->tilexoff) ||\n \t  jpc_getuint32(in, &siz->tileyoff) ||\n \t  jpc_getuint16(in, &siz->numcomps)) {\n-\t\treturn -1;\n+\t\tgoto error;\n \t}\n-\tif (!siz->width || !siz->height || !siz->tilewidth ||\n-\t  !siz->tileheight || !siz->numcomps || siz->numcomps > 16384) {\n-\t\treturn -1;\n+\tif (!siz->width || !siz->height) {\n+\t\tjas_eprintf(\"reference grid cannot have zero area\\n\");\n+\t\tgoto error;\n \t}\n-\tif (siz->tilexoff >= siz->width || siz->tileyoff >= siz->height) {\n-\t\tjas_eprintf(\"all tiles are outside the image area\\n\");\n-\t\treturn -1;\n+\tif (!siz->tilewidth || !siz->tileheight) {\n+\t\tjas_eprintf(\"tile cannot have zero area\\n\");\n+\t\tgoto error;\n+\t}\n+\tif (!siz->numcomps || siz->numcomps > 16384) {\n+\t\tjas_eprintf(\"number of components not in permissible range\\n\");\n+\t\tgoto error;\n \t}\n+\tif (siz->xoff >= siz->width) {\n+\t\tjas_eprintf(\"XOsiz not in permissible range\\n\");\n+\t\tgoto error;\n+\t}\n+\tif (siz->yoff >= siz->height) {\n+\t\tjas_eprintf(\"YOsiz not in permissible range\\n\");\n+\t\tgoto error;\n+\t}\n+\tif (siz->tilexoff > siz->xoff || siz->tilexoff + siz->tilewidth <= siz->xoff) {\n+\t\tjas_eprintf(\"XTOsiz not in permissible range\\n\");\n+\t\tgoto error;\n+\t}\n+\tif (siz->tileyoff > siz->yoff || siz->tileyoff + siz->tileheight <= siz->yoff) {\n+\t\tjas_eprintf(\"YTOsiz not in permissible range\\n\");\n+\t\tgoto error;\n+\t}\n+\n \tif (!(siz->comps = jas_alloc2(siz->numcomps, sizeof(jpc_sizcomp_t)))) {\n-\t\treturn -1;\n+\t\tgoto error;\n \t}\n \tfor (i = 0; i < siz->numcomps; ++i) {\n \t\tif (jpc_getuint8(in, &tmp) ||\n \t\t  jpc_getuint8(in, &siz->comps[i].hsamp) ||\n \t\t  jpc_getuint8(in, &siz->comps[i].vsamp)) {\n-\t\t\tjas_free(siz->comps);\n-\t\t\treturn -1;\n+\t\t\tgoto error;\n \t\t}\n \t\tif (siz->comps[i].hsamp == 0 || siz->comps[i].hsamp > 255) {\n \t\t\tjas_eprintf(\"invalid XRsiz value %d\\n\", siz->comps[i].hsamp);\n-\t\t\tjas_free(siz->comps);\n-\t\t\treturn -1;\n+\t\t\tgoto error;\n \t\t}\n \t\tif (siz->comps[i].vsamp == 0 || siz->comps[i].vsamp > 255) {\n \t\t\tjas_eprintf(\"invalid YRsiz value %d\\n\", siz->comps[i].vsamp);\n-\t\t\tjas_free(siz->comps);\n-\t\t\treturn -1;\n+\t\t\tgoto error;\n \t\t}\n \t\tsiz->comps[i].sgnd = (tmp >> 7) & 1;\n \t\tsiz->comps[i].prec = (tmp & 0x7f) + 1;\n \t}\n \tif (jas_stream_eof(in)) {\n-\t\tjas_free(siz->comps);\n-\t\treturn -1;\n+\t\tgoto error;\n \t}\n \treturn 0;\n+\n+error:\n+\tif (siz->comps) {\n+\t\tjas_free(siz->comps);\n+\t}\n+\treturn -1;\n }\n \n static int jpc_siz_putparms(jpc_ms_t *ms, jpc_cstate_t *cstate, jas_stream_t *out)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8766848706a727f61c1c76a5a7cf1078433fad02",
            "date": "2024-04-27T17:53:19Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2d6b6e8a9987386afe388e1cde859d0182445e63",
            "date": "2024-04-27T17:49:23Z",
            "author_login": "mdadams"
          },
          {
            "sha": "29154a52b6c2b895ac3db60d51be9f2a995ee145",
            "date": "2024-04-10T06:11:01Z",
            "author_login": "mdadams"
          },
          {
            "sha": "2fe7d2d73d18d9c7072507d462737b372f9d56bf",
            "date": "2024-03-30T16:57:05Z",
            "author_login": "mdadams"
          },
          {
            "sha": "6d084c53a77762f41bb5310713a5f1872fef55f5",
            "date": "2024-03-29T14:57:29Z",
            "author_login": "mdadams"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.17 allows remote attackers to cause a denial of service (assertion failure) via a crafted file.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-03-23T18:59:00.867",
    "last_modified": "2024-11-21T03:01:06.027",
    "fix_date": "2016-10-28T03:11:57Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/11/17/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/94372",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1396975",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/f7038068550fba0e41e1d0c355787f1dcd5bf330",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3693-1/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/11/17/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/94372",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2017:1208",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1396975",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mdadams/jasper/commit/f7038068550fba0e41e1d0c355787f1dcd5bf330",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3693-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.817985",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "jasper",
    "owner": "mdadams",
    "created_at": "2016-09-16T18:52:32Z",
    "updated_at": "2025-01-23T07:28:59Z",
    "pushed_at": "2024-04-27T17:54:09Z",
    "size": 4405,
    "stars": 233,
    "forks": 103,
    "open_issues": 4,
    "watchers": 233,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1567274,
      "Shell": 147989,
      "CMake": 50869,
      "Roff": 3703,
      "Batchfile": 1905,
      "C++": 235
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:47:21.317160"
  }
}