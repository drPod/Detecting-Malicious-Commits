{
  "cve_id": "CVE-2016-9954",
  "github_data": {
    "repository": "ashinn/irregex",
    "fix_commit": "a16ffc86eca15fca9e40607d41de3cea9cf868f1",
    "related_commits": [
      "a16ffc86eca15fca9e40607d41de3cea9cf868f1",
      "a16ffc86eca15fca9e40607d41de3cea9cf868f1"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a16ffc86eca15fca9e40607d41de3cea9cf868f1",
      "commit_date": "2016-12-05T13:46:15Z",
      "author": {
        "login": "sjamaan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix exponential explosion in backtrack compilation",
        "length": 312,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 20,
        "deletions": 14
      },
      "files": [
        {
          "filename": "benchmarks/re-benchmarks.txt",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -37,3 +37,5 @@ exponential dfa\ta[ab][ab][ab][ab][ab][ab][ab][ab][ab][ab][ab][ab][ab][ab][ab][ab\n \n # Found by Caolan McMahon\n exponential backtracking for repeating pattern\t[a-z]{0,42}\ttesting@\tb\t1\t1\n+\n+Exponential memory use while building match procedure\t($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($($(${-2,16}+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)+)\tfoo\tb\t1\t1"
        },
        {
          "filename": "irregex.scm",
          "status": "modified",
          "additions": 18,
          "deletions": 14,
          "patch": "@@ -30,6 +30,8 @@\n \n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n ;;;; History\n+;; 0.9.6: 2016/12/05 - fixed exponential memory use of + in compilation\n+;;                     of backtracking matcher.\n ;; 0.9.5: 2016/09/10 - fixed a bug in irregex-fold handling of bow\n ;; 0.9.4: 2015/12/14 - performance improvement for {n,m} matches\n ;; 0.9.3: 2014/07/01 - R7RS library\n@@ -3084,16 +3086,7 @@\n               ((sre-empty? (sre-sequence (cdr sre)))\n                (error \"invalid sre: empty *\" sre))\n               (else\n-               (letrec\n-                   ((body\n-                     (lp (sre-sequence (cdr sre))\n-                         n\n-                         flags\n-                         (lambda (cnk init src str i end matches fail)\n-                           (body cnk init src str i end matches\n-                                 (lambda ()\n-                                   (next cnk init src str i end matches fail)\n-                                   ))))))\n+               (let ((body (rec (list '+ (sre-sequence (cdr sre))))))\n                  (lambda (cnk init src str i end matches fail)\n                    (body cnk init src str i end matches\n                          (lambda ()\n@@ -3118,10 +3111,21 @@\n                          (lambda ()\n                            (body cnk init src str i end matches fail))))))))\n             ((+)\n-             (lp (sre-sequence (cdr sre))\n-                 n\n-                 flags\n-                 (rec (list '* (sre-sequence (cdr sre))))))\n+             (cond\n+              ((sre-empty? (sre-sequence (cdr sre)))\n+               (error \"invalid sre: empty +\" sre))\n+              (else\n+               (letrec\n+                   ((body\n+                     (lp (sre-sequence (cdr sre))\n+                         n\n+                         flags\n+                         (lambda (cnk init src str i end matches fail)\n+                           (body cnk init src str i end matches\n+                                 (lambda ()\n+                                   (next cnk init src str i end matches fail)\n+                                   ))))))\n+                 body))))\n             ((=)\n              (rec `(** ,(cadr sre) ,(cadr sre) ,@(cddr sre))))\n             ((>=)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e0fee5103e0cdf458696e8c48de983027215864c",
            "date": "2024-08-25T01:48:02Z",
            "author_login": "ashinn"
          },
          {
            "sha": "86dd876b4553b5d4ba42c461825d04fff1fba01e",
            "date": "2024-06-01T22:29:56Z",
            "author_login": "ashinn"
          },
          {
            "sha": "6b2512d9004856a67aad241a62a499244b3eb33f",
            "date": "2024-06-01T16:34:46Z",
            "author_login": "ak-1"
          },
          {
            "sha": "923cfc39e306c68a978f4938753a89ade023eb06",
            "date": "2024-02-27T02:17:08Z",
            "author_login": "ashinn"
          },
          {
            "sha": "91e8d163523780c57b0814064837f3b190a15e94",
            "date": "2024-02-23T01:41:25Z",
            "author_login": "ashinn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-399",
    "description": "The backtrack compilation code in the Irregex package (aka IrRegular Expressions) before 0.9.6 for Scheme allows remote attackers to cause a denial of service (memory consumption) via a crafted regular expression with a repeating pattern.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-04-21T20:59:00.883",
    "last_modified": "2024-11-21T03:02:04.323",
    "fix_date": "2016-12-05T13:46:15Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/12/15/8",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/94942",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1413990",
      "source": "security@debian.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/ashinn/irregex/commit/a16ffc86eca15fca9e40607d41de3cea9cf868f1",
      "source": "security@debian.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2016/12/15/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/94942",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1413990",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/ashinn/irregex/commit/a16ffc86eca15fca9e40607d41de3cea9cf868f1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.870231",
    "processing_status": "enhanced"
  }
}