{
  "cve_id": "CVE-2016-9962",
  "github_data": {
    "repository": "opencontainers/runc",
    "fix_commit": "50a19c6ff828c58e5dab13830bd3dacde268afe5",
    "related_commits": [
      "50a19c6ff828c58e5dab13830bd3dacde268afe5",
      "50a19c6ff828c58e5dab13830bd3dacde268afe5"
    ],
    "patch_url": "https://github.com/opencontainers/runc/commit/50a19c6ff828c58e5dab13830bd3dacde268afe5.patch",
    "fix_commit_details": {
      "sha": "50a19c6ff828c58e5dab13830bd3dacde268afe5",
      "commit_date": "2016-12-07T23:05:51Z",
      "author": {
        "login": "crosbymichael",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Set init processes as non-dumpable",
        "length": 916,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 16,
        "deletions": 2
      },
      "files": [
        {
          "filename": "libcontainer/init_linux.go",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -77,7 +77,8 @@ func newContainerInit(t initType, pipe *os.File, stateDirFD int) (initer, error)\n \tswitch t {\n \tcase initSetns:\n \t\treturn &linuxSetnsInit{\n-\t\t\tconfig: config,\n+\t\t\tconfig:     config,\n+\t\t\tstateDirFD: stateDirFD,\n \t\t}, nil\n \tcase initStandard:\n \t\treturn &linuxStandardInit{"
        },
        {
          "filename": "libcontainer/nsenter/nsexec.c",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -408,6 +408,11 @@ void nsexec(void)\n \tif (pipenum == -1)\n \t\treturn;\n \n+\t/* make the process non-dumpable */\n+\tif (prctl(PR_SET_DUMPABLE, 0, 0, 0, 0) != 0) {\n+\t\tbail(\"failed to set process as non-dumpable\");\n+\t}\n+\n \t/* Parse all of the netlink configuration. */\n \tnl_parse(pipenum, &config);\n "
        },
        {
          "filename": "libcontainer/setns_init_linux.go",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -5,6 +5,7 @@ package libcontainer\n import (\n \t\"fmt\"\n \t\"os\"\n+\t\"syscall\"\n \n \t\"github.com/opencontainers/runc/libcontainer/apparmor\"\n \t\"github.com/opencontainers/runc/libcontainer/keys\"\n@@ -16,7 +17,8 @@ import (\n // linuxSetnsInit performs the container's initialization for running a new process\n // inside an existing container.\n type linuxSetnsInit struct {\n-\tconfig *initConfig\n+\tconfig     *initConfig\n+\tstateDirFD int\n }\n \n func (l *linuxSetnsInit) getSessionRingName() string {\n@@ -49,5 +51,8 @@ func (l *linuxSetnsInit) Init() error {\n \tif err := label.SetProcessLabel(l.config.ProcessLabel); err != nil {\n \t\treturn err\n \t}\n+\t// close the statedir fd before exec because the kernel resets dumpable in the wrong order\n+\t// https://github.com/torvalds/linux/blob/v4.9/fs/exec.c#L1290-L1318\n+\tsyscall.Close(l.stateDirFD)\n \treturn system.Execv(l.config.Args[0], l.config.Args[0:], os.Environ())\n }"
        },
        {
          "filename": "libcontainer/standard_init_linux.go",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -171,6 +171,9 @@ func (l *linuxStandardInit) Init() error {\n \t\t\treturn newSystemErrorWithCause(err, \"init seccomp\")\n \t\t}\n \t}\n+\t// close the statedir fd before exec because the kernel resets dumpable in the wrong order\n+\t// https://github.com/torvalds/linux/blob/v4.9/fs/exec.c#L1290-L1318\n+\tsyscall.Close(l.stateDirFD)\n \tif err := syscall.Exec(name, l.config.Args[0:], os.Environ()); err != nil {\n \t\treturn newSystemErrorWithCause(err, \"exec user process\")\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "610aa88ab201f289c05c2e262912d0630f46eb35",
            "date": "2025-01-10T20:23:22Z",
            "author_login": "kolyshkin"
          },
          {
            "sha": "4120935737a51cbf23676977cc8bf0b6717702f1",
            "date": "2025-01-09T10:45:31Z",
            "author_login": "lifubang"
          },
          {
            "sha": "06f1e0765576dcf6d8c2ef5e56d309618310992c",
            "date": "2024-06-23T23:31:57Z",
            "author_login": "kolyshkin"
          },
          {
            "sha": "6171da60058fe58c6bd2f2a4ae8be381cfc12cce",
            "date": "2024-12-23T01:32:02Z",
            "author_login": "kolyshkin"
          },
          {
            "sha": "c49b89168140c70dc1badd17d5ed361788898fe9",
            "date": "2024-12-21T19:52:25Z",
            "author_login": "kolyshkin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-362",
    "description": "RunC allowed additional container processes via 'runc exec' to be ptraced by the pid 1 of the container.  This allows the main processes of the container, if running as root, to gain access to file-descriptors of these new processes during the initialization and can lead to container escapes or modification of runC state before the process is fully placed inside the container.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-01-31T22:59:01.783",
    "last_modified": "2024-11-21T03:02:05.310",
    "fix_date": "2016-12-07T23:05:51Z"
  },
  "references": [
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0116.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0123.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0127.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2017/Jan/21",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2017/Jan/29",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/540001/100/0/threaded",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/95361",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/security/vulnerabilities/cve-2016-9962",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1012568#c6",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/docker/docker/releases/tag/v1.12.6",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/opencontainers/runc/commit/50a19c6ff828c58e5dab13830bd3dacde268afe5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BQAXJMMLRU7DD2IMG47SR2K4BOFFG7FZ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FINGBFMIXBG6B6ZWYH3TMRP5V3PDBNXR/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UVM7FCOQMPKOFLDTUYSS4ES76DDM56VP/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WUQ3MQNEL5IBZZLMLR72Q4YDCL2SCKRK/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201701-34",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0116.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0123.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://rhn.redhat.com/errata/RHSA-2017-0127.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2017/Jan/21",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2017/Jan/29",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/540001/100/0/threaded",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/95361",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/security/vulnerabilities/cve-2016-9962",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1012568#c6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/docker/docker/releases/tag/v1.12.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/opencontainers/runc/commit/50a19c6ff828c58e5dab13830bd3dacde268afe5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BQAXJMMLRU7DD2IMG47SR2K4BOFFG7FZ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FINGBFMIXBG6B6ZWYH3TMRP5V3PDBNXR/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UVM7FCOQMPKOFLDTUYSS4ES76DDM56VP/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WUQ3MQNEL5IBZZLMLR72Q4YDCL2SCKRK/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201701-34",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:49.849253",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "runc",
    "owner": "opencontainers",
    "created_at": "2015-06-05T23:30:45Z",
    "updated_at": "2025-01-14T11:33:23Z",
    "pushed_at": "2025-01-13T07:56:10Z",
    "size": 21572,
    "stars": 12051,
    "forks": 2130,
    "open_issues": 365,
    "watchers": 12051,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release-1.0",
      "release-1.1",
      "release-1.2"
    ],
    "languages": {
      "Go": 1253070,
      "Shell": 305324,
      "C": 45119,
      "Makefile": 7226,
      "Dockerfile": 2644,
      "Ruby": 2035
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:26:33.730029"
  }
}