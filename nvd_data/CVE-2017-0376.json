{
  "cve_id": "CVE-2017-0376",
  "github_data": {
    "repository": "torproject/tor",
    "fix_commit": "56a7c5bc15e0447203a491c1ee37de9939ad1dcd",
    "related_commits": [
      "56a7c5bc15e0447203a491c1ee37de9939ad1dcd",
      "56a7c5bc15e0447203a491c1ee37de9939ad1dcd"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "56a7c5bc15e0447203a491c1ee37de9939ad1dcd",
      "commit_date": "2017-06-05T15:11:42Z",
      "author": {
        "login": "dgoulet-tor",
        "type": "User",
        "stats": {
          "total_commits": 2031,
          "average_weekly_commits": 1.721186440677966,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 255
        }
      },
      "commit_message": {
        "title": "TROVE-2017-005: Fix assertion failure in connection_edge_process_relay_cell",
        "length": 438,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
      },
      "files": [
        {
          "filename": "changes/trove-2017-005",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+  o Major bugfixes (hidden service, relay, security):\n+    - Fix an assertion failure caused by receiving a BEGIN_DIR cell on\n+      a hidden service rendezvous circuit. Fixes bug 22494, tracked as\n+      TROVE-2017-005 and CVE-2017-0376; bugfix on 0.2.2.1-alpha. Found\n+      by armadev.\n+\n+"
        },
        {
          "filename": "src/or/relay.c",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1297,7 +1297,8 @@ connection_edge_process_relay_cell(cell_t *cell, circuit_t *circ,\n                \"Begin cell for known stream. Dropping.\");\n         return 0;\n       }\n-      if (rh.command == RELAY_COMMAND_BEGIN_DIR) {\n+      if (rh.command == RELAY_COMMAND_BEGIN_DIR &&\n+          circ->purpose != CIRCUIT_PURPOSE_S_REND_JOINED) {\n         /* Assign this circuit and its app-ward OR connection a unique ID,\n          * so that we can measure download times. The local edge and dir\n          * connection will be assigned the same ID when they are created"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "27d4ba90f6dbf0c80d518a358b9600ae789509e4",
            "date": "2024-03-05T22:23:20Z",
            "author_login": "micah"
          },
          {
            "sha": "3cb6a690be60fcdab60130402ff88dcfc0657596",
            "date": "2023-06-19T12:09:45Z",
            "author_login": "dgoulet-tor"
          },
          {
            "sha": "94f4d0968b57db8b3346a5b51b9e0c2ed3e8d98f",
            "date": "2023-06-15T17:00:11Z",
            "author_login": "dgoulet-tor"
          },
          {
            "sha": "623a55764b8c72e6271f822c1fe68b9613c551b9",
            "date": "2023-06-19T12:09:24Z",
            "author_login": "dgoulet-tor"
          },
          {
            "sha": "7a83aa4f5042905844cb9ab48a4876becd8f2175",
            "date": "2023-06-15T17:23:36Z",
            "author_login": "dgoulet-tor"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-617",
    "description": "The hidden-service feature in Tor before 0.3.0.8 allows a denial of service (assertion failure and daemon exit) in the connection_edge_process_relay_cell function via a BEGIN_DIR cell on a rendezvous circuit.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-06-09T17:29:00.263",
    "last_modified": "2024-11-21T03:02:51.793",
    "fix_date": "2017-06-05T15:11:42Z"
  },
  "references": [
    {
      "url": "http://www.debian.org/security/2017/dsa-3877",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torproject/tor/commit/56a7c5bc15e0447203a491c1ee37de9939ad1dcd",
      "source": "security@debian.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.torproject.org/pipermail/tor-announce/2017-June/000131.html",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://trac.torproject.org/projects/tor/ticket/22494",
      "source": "security@debian.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3877",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torproject/tor/commit/56a7c5bc15e0447203a491c1ee37de9939ad1dcd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.torproject.org/pipermail/tor-announce/2017-June/000131.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://trac.torproject.org/projects/tor/ticket/22494",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:01.655426",
    "processing_status": "enhanced"
  }
}