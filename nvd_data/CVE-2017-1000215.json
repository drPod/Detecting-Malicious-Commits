{
  "cve_id": "CVE-2017-1000215",
  "github_data": {
    "repository": "xrootd/xrootd",
    "fix_commit": "befa2e627a5a33a38c92db3e57c07d8246a24acf",
    "related_commits": [
      "befa2e627a5a33a38c92db3e57c07d8246a24acf",
      "befa2e627a5a33a38c92db3e57c07d8246a24acf"
    ],
    "patch_url": "https://github.com/xrootd/xrootd/commit/befa2e627a5a33a38c92db3e57c07d8246a24acf.patch",
    "fix_commit_details": {
      "sha": "befa2e627a5a33a38c92db3e57c07d8246a24acf",
      "commit_date": "2017-04-20T09:04:21Z",
      "author": {
        "login": "gganis",
        "type": "User",
        "stats": {
          "total_commits": 875,
          "average_weekly_commits": 0.8101851851851852,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 242
        }
      },
      "commit_message": {
        "title": "secgsi: do not build/package libXrdSecgsiGMAPLDAP-4.so",
        "length": 303,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 28,
        "additions": 9,
        "deletions": 19
      },
      "files": [
        {
          "filename": "packaging/rhel/xrootd.spec.in",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -809,7 +809,6 @@ fi\n %{_libdir}/libXrdPosix.so.1*\n %{_libdir}/libXrdSecgsiAuthzVO.so*\n %{_libdir}/libXrdSecgsiGMAPDN.so*\n-%{_libdir}/libXrdSecgsiGMAPLDAP.so*\n %{_libdir}/libXrdSecgsi.so*\n %{_libdir}/libXrdSeckrb5.so*\n %{_libdir}/libXrdSecpwd.so*"
        },
        {
          "filename": "src/XrdCl/XrdClDefaultEnv.cc",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -670,7 +670,6 @@ namespace XrdCl\n       \"libXrdSecgsi.so\",\n       \"libXrdSecgsiAuthzVO.so\",\n       \"libXrdSecgsiGMAPDN.so\",\n-      \"libXrdSecgsiGMAPLDAP.so\",\n       \"libXrdSecpwd.so\",\n       \"libXrdSecsss.so\",\n       \"libXrdSecunix.so\","
        },
        {
          "filename": "src/XrdSecgsi.cmake",
          "status": "modified",
          "additions": 0,
          "deletions": 16,
          "patch": "@@ -5,7 +5,6 @@ include( XRootDCommon )\n # Shared library version\n #-------------------------------------------------------------------------------\n set( LIB_XRD_SEC_GSI          XrdSecgsi-${PLUGIN_VERSION} )\n-set( LIB_XRD_SEC_GSI_GMAPLDAP XrdSecgsiGMAPLDAP-${PLUGIN_VERSION} )\n set( LIB_XRD_SEC_GSI_GMAPDN   XrdSecgsiGMAPDN-${PLUGIN_VERSION} )\n set( LIB_XRD_SEC_GSI_AUTHZVO  XrdSecgsiAUTHZVO-${PLUGIN_VERSION} )\n \n@@ -30,20 +29,6 @@ set_target_properties(\n   INTERFACE_LINK_LIBRARIES \"\"\n   LINK_INTERFACE_LIBRARIES \"\" )\n \n-#-------------------------------------------------------------------------------\n-# The XrdSecgsiGMAPLDAP module\n-#-------------------------------------------------------------------------------\n-add_library(\n-  ${LIB_XRD_SEC_GSI_GMAPLDAP}\n-  MODULE\n-  XrdSecgsi/XrdSecgsiGMAPFunLDAP.cc )\n-\n-set_target_properties(\n-  ${LIB_XRD_SEC_GSI_GMAPLDAP}\n-  PROPERTIES\n-  INTERFACE_LINK_LIBRARIES \"\"\n-  LINK_INTERFACE_LIBRARIES \"\" )\n-\n #-------------------------------------------------------------------------------\n # The XrdSecgsiAuthzVO module\n #-------------------------------------------------------------------------------\n@@ -112,7 +97,6 @@ target_link_libraries(\n install(\n   TARGETS\n   ${LIB_XRD_SEC_GSI}\n-  ${LIB_XRD_SEC_GSI_GMAPLDAP}\n   ${LIB_XRD_SEC_GSI_AUTHZVO}\n   ${LIB_XRD_SEC_GSI_GMAPDN}\n   xrdgsiproxy"
        },
        {
          "filename": "src/XrdSecgsi/XrdSecgsiGMAPFunLDAP.cc",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -38,6 +38,15 @@ XrdVERSIONINFO(XrdSecgsiGMAPFun,secgsigmap);\n /*                                                                            */\n /* GMAP function implementation querying a LDAP database                      */\n /*                                                                            */\n+/* Warning: this plug-in is not build any longer because the external         */\n+/* LDAP query via the popen() represents a potential security threat          */\n+/* and it is believed that functionality provided is not actually used.       */\n+/* If this believe happens to be uncorrect please report at                   */\n+/*                                                                            */\n+/*                   https://github.com/xrootd                                */\n+/*                                                                            */\n+/* a sanitized version of the plug-in can be provided using a proper library. */\n+/*                                                                            */\n /* ************************************************************************** */\n \n #include <stdio.h>"
        },
        {
          "filename": "src/XrdVersionPlugin.hh",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -170,7 +170,6 @@\n          \"libXrdSecgsi.so\",          \\\n          \"libXrdSecgsiAUTHZVO.so\",   \\\n          \"libXrdSecgsiGMAPDLAP.so\",  \\\n-         \"libXrdSecgsiGMAPLDAP.so\",  \\\n          \"libXrdSeckrb5.so\",         \\\n          \"libXrdSecpwd.so\",          \\\n          \"libXrdSecsss.so\",          \\"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e7bfb0475cc0e3a07e7ef6874ad25e718e6419a4",
            "date": "2025-01-10T16:46:16Z",
            "author_login": "ccaffy"
          },
          {
            "sha": "9d69b45d355c0b1b1564ba14ca10a5b82ac04c0a",
            "date": "2024-12-20T17:29:30Z",
            "author_login": "osschar"
          },
          {
            "sha": "bdf9d5fd6e7dff2497c897fee3609d6ae23ab07f",
            "date": "2024-12-18T16:01:32Z",
            "author_login": "amadio"
          },
          {
            "sha": "9916b5f907ca71213f72f733c55d2b1cce5d327c",
            "date": "2024-12-18T15:47:52Z",
            "author_login": "amadio"
          },
          {
            "sha": "e27d87064ee5ed04860f3726d6fdd94c807ae617",
            "date": "2024-12-18T15:28:30Z",
            "author_login": "amadio"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-78",
    "description": "ROOT xrootd version 4.6.0 and below is vulnerable to an unauthenticated shell command injection resulting in remote code execution",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-11-17T20:29:00.277",
    "last_modified": "2024-11-21T03:04:24.570",
    "fix_date": "2017-04-20T09:04:21Z"
  },
  "references": [
    {
      "url": "https://github.com/xrootd/xrootd/blob/befa2e627a5a33a38c92db3e57c07d8246a24acf/src/XrdSecgsi/XrdSecgsiGMAPFunLDAP.cc#L85",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xrootd/xrootd/blob/v4.6.1/docs/ReleaseNotes.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xrootd/xrootd/commit/befa2e627a5a33a38c92db3e57c07d8246a24acf",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201903-11",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xrootd/xrootd/blob/befa2e627a5a33a38c92db3e57c07d8246a24acf/src/XrdSecgsi/XrdSecgsiGMAPFunLDAP.cc#L85",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xrootd/xrootd/blob/v4.6.1/docs/ReleaseNotes.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xrootd/xrootd/commit/befa2e627a5a33a38c92db3e57c07d8246a24acf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201903-11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.744002",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xrootd",
    "owner": "xrootd",
    "created_at": "2013-03-21T08:25:19Z",
    "updated_at": "2025-01-14T09:40:36Z",
    "pushed_at": "2025-01-14T09:40:31Z",
    "size": 50604,
    "stars": 166,
    "forks": 154,
    "open_issues": 116,
    "watchers": 166,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "devel",
      "master"
    ],
    "languages": {
      "C++": 15922243,
      "CMake": 175328,
      "Python": 129926,
      "Shell": 113813,
      "Perl": 48037,
      "CSS": 16987,
      "C": 16656,
      "Makefile": 5581,
      "HTML": 89
    },
    "commit_activity": {
      "total_commits_last_year": 337,
      "avg_commits_per_week": 6.480769230769231,
      "days_active_last_year": 129
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T18:03:00.126425"
  }
}