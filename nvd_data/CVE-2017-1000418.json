{
  "cve_id": "CVE-2017-1000418",
  "github_data": {
    "repository": "Mindwerks/wildmidi",
    "fix_commit": "814f31d8eceda8401eb812fc2e94ed143fdad0ab",
    "related_commits": [
      "814f31d8eceda8401eb812fc2e94ed143fdad0ab",
      "814f31d8eceda8401eb812fc2e94ed143fdad0ab"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "814f31d8eceda8401eb812fc2e94ed143fdad0ab",
      "commit_date": "2017-08-04T07:15:00Z",
      "author": {
        "login": "sezero",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "wildmidi_lib.c (WildMidi_Open, WildMidi_OpenBuffer): refuse to proceed if less then 18 bytes of input",
        "length": 118,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 10,
        "deletions": 0
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -38,6 +38,8 @@ CHANGELOG\n 0.4.2\n * Fixed CVE-2017-11661, CVE-2017-11662, CVE-2017-11663, CVE-2017-11664\n   (Bug #175).\n+* Fixed WildMidi_Open() might read beyond buffer with too short inputs\n+  (Bug #178).\n * GUS patch processing changes to meet users expectations (Bug #132).\n * Worked around a build failure with newer FreeBSD versions failing to\n   retrieve the ONLCR constant (Bug #171)."
        },
        {
          "filename": "src/wildmidi_lib.c",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -1655,6 +1655,10 @@ WM_SYMBOL midi *WildMidi_Open(const char *midifile) {\n     if ((mididata = (uint8_t *) _WM_BufferFile(midifile, &midisize)) == NULL) {\n         return (NULL);\n     }\n+    if (midisize < 18) {\n+        _WM_GLOBAL_ERROR(__FUNCTION__, __LINE__, WM_ERR_CORUPT, \"(too short)\", 0);\n+        return (NULL);\n+    }\n     if (memcmp(mididata,\"HMIMIDIP\", 8) == 0) {\n         ret = (void *) _WM_ParseNewHmp(mididata, midisize);\n     } else if (memcmp(mididata, \"HMI-MIDISONG061595\", 18) == 0) {\n@@ -1696,6 +1700,10 @@ WM_SYMBOL midi *WildMidi_OpenBuffer(uint8_t *midibuffer, uint32_t size) {\n         _WM_GLOBAL_ERROR(__FUNCTION__, __LINE__, WM_ERR_LONGFIL, NULL, 0);\n         return (NULL);\n     }\n+    if (size < 18) {\n+        _WM_GLOBAL_ERROR(__FUNCTION__, __LINE__, WM_ERR_CORUPT, \"(too short)\", 0);\n+        return (NULL);\n+    }\n     if (memcmp(midibuffer,\"HMIMIDIP\", 8) == 0) {\n         ret = (void *) _WM_ParseNewHmp(midibuffer, size);\n     } else if (memcmp(midibuffer, \"HMI-MIDISONG061595\", 18) == 0) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d6acaaadd1c68f369f4342904dd28f2271d7bb0e",
            "date": "2025-01-06T11:00:28Z",
            "author_login": "MonicaLiu0311"
          },
          {
            "sha": "67b0c9a70bd49e4b99df285a984171c158747c55",
            "date": "2024-11-28T18:46:36Z",
            "author_login": "trialuser02"
          },
          {
            "sha": "233defddc71a10d6f5d86babd747f7e3e8fdf897",
            "date": "2024-09-30T12:02:45Z",
            "author_login": "psi29a"
          },
          {
            "sha": "7df9c72c3af71357fd4b4a584b1049004618e27a",
            "date": "2024-09-30T12:02:17Z",
            "author_login": "psi29a"
          },
          {
            "sha": "1973ffc4f454ad78a5fb191edf9354aab70d2831",
            "date": "2024-09-23T06:00:13Z",
            "author_login": "raziel-"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-119",
    "description": "The WildMidi_Open function in WildMIDI since commit d8a466829c67cacbb1700beded25c448d99514e5 allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted file.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-01-02T18:29:00.200",
    "last_modified": "2024-11-21T03:04:41.767",
    "fix_date": "2017-08-04T07:15:00Z"
  },
  "references": [
    {
      "url": "https://github.com/Mindwerks/wildmidi/commit/814f31d8eceda8401eb812fc2e94ed143fdad0ab",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Mindwerks/wildmidi/issues/178",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Mindwerks/wildmidi/commit/814f31d8eceda8401eb812fc2e94ed143fdad0ab",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Mindwerks/wildmidi/issues/178",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:12.806001",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "wildmidi",
    "owner": "Mindwerks",
    "created_at": "2014-01-09T15:02:09Z",
    "updated_at": "2025-01-08T12:18:37Z",
    "pushed_at": "2025-01-06T11:00:29Z",
    "size": 3149,
    "stars": 209,
    "forks": 43,
    "open_issues": 35,
    "watchers": 209,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 705342,
      "CMake": 23705,
      "Makefile": 16155,
      "C++": 5976,
      "GLSL": 347
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:02:28.458447"
  }
}