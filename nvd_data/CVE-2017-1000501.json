{
  "cve_id": "CVE-2017-1000501",
  "github_data": {
    "repository": "eldy/awstats",
    "fix_commit": "06c0ab29c1e5059d9e0279c6b64d573d619e1651",
    "related_commits": [
      "06c0ab29c1e5059d9e0279c6b64d573d619e1651",
      "cf219843a74c951bf5986f3a7fffa3dcf99c3899",
      "06c0ab29c1e5059d9e0279c6b64d573d619e1651",
      "cf219843a74c951bf5986f3a7fffa3dcf99c3899"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "06c0ab29c1e5059d9e0279c6b64d573d619e1651",
      "commit_date": "2017-12-27T12:39:57Z",
      "author": {
        "login": "eldy",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix another vulnerability reported by cPanel Security Team (can execute",
        "length": 87,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
      },
      "files": [
        {
          "filename": "wwwroot/cgi-bin/awstats.pl",
          "status": "modified",
          "additions": 9,
          "deletions": 5,
          "patch": "@@ -17145,7 +17145,6 @@ sub HTMLMainExtra{\n \n \tif ( $QueryString =~ /config=([^&]+)/i ) { \n \t\t$SiteConfig = &Sanitize(\"$1\");\n-\t\t$SiteConfig =~ s/\\.\\.//g; \t\t# Avoid directory transversal\n \t}\n \tif ( $QueryString =~ /diricons=([^&]+)/i ) { $DirIcons = \"$1\"; }\n \tif ( $QueryString =~ /pluginmode=([^&]+)/i ) {\n@@ -17191,10 +17190,13 @@ sub HTMLMainExtra{\n \t# If migrate\n \tif ( $QueryString =~ /(^|-|&|&amp;)migrate=([^&]+)/i ) {\n \t\t$MigrateStats = &Sanitize(\"$2\");\n+\n \t\t$MigrateStats =~ /^(.*)$PROG(\\d{0,2})(\\d\\d)(\\d\\d\\d\\d)(.*)\\.txt$/;\n-\t\t$SiteConfig = $5 ? $5 : 'xxx';\n+\t\t$SiteConfig = &Sanitize($5 ? $5 : 'xxx');\n \t\t$SiteConfig =~ s/^\\.//;    # SiteConfig is used to find config file\n \t}\n+\n+\t$SiteConfig =~ s/\\.\\.//g; \t\t# Avoid directory transversal\n }\n else {                             # Run from command line\n \t$DebugMessages = 1;\n@@ -17204,9 +17206,10 @@ sub HTMLMainExtra{\n \n \t\t# If migrate\n \t\tif ( $ARGV[$_] =~ /(^|-|&|&amp;)migrate=([^&]+)/i ) {\n-\t\t\t$MigrateStats = \"$2\";\n+\t\t\t$MigrateStats = &Sanitize(\"$2\");\n+\n \t\t\t$MigrateStats =~ /^(.*)$PROG(\\d{0,2})(\\d\\d)(\\d\\d\\d\\d)(.*)\\.txt$/;\n-\t\t\t$SiteConfig = $5 ? $5 : 'xxx';\n+\t\t\t$SiteConfig = &Sanitize($5 ? $5 : 'xxx');\n \t\t\t$SiteConfig =~ s/^\\.//;    # SiteConfig is used to find config file\n \t\t\tnext;\n \t\t}\n@@ -17235,7 +17238,6 @@ sub HTMLMainExtra{\n \n \tif ( $QueryString =~ /config=([^&]+)/i ) { \n \t\t$SiteConfig = &Sanitize(\"$1\"); \n-\t\t$SiteConfig =~ s/\\.\\.//g; \n \t}\n \tif ( $QueryString =~ /diricons=([^&]+)/i ) { $DirIcons = \"$1\"; }\n \tif ( $QueryString =~ /pluginmode=([^&]+)/i ) {\n@@ -17301,6 +17303,8 @@ sub HTMLMainExtra{\n \t\t$ShowDirectOrigin = 1;\n \t\t$QueryString =~ s/showdirectorigin[^&]*//i;\n \t}\n+\t\n+\t$SiteConfig =~ s/\\.\\.//g; \n }\n if ( $QueryString =~ /(^|&|&amp;)staticlinks/i ) {\n \t$StaticLinks = \"$PROG.$SiteConfig\";"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c09867ab2b143786ff7cc738d19d6327f5cdb00b",
            "date": "2025-01-06T13:13:06Z",
            "author_login": "eldy"
          },
          {
            "sha": "22fb1312ac8b912c4067adc5b5970dbee6cdb3b7",
            "date": "2024-12-10T16:43:06Z",
            "author_login": "eldy"
          },
          {
            "sha": "fe27483436ad1aaaca6173f799085569985fdc97",
            "date": "2024-12-10T16:41:41Z",
            "author_login": "eldy"
          },
          {
            "sha": "61cb73cf8e49bbc826c7cef5f94b42bf4f0f2f23",
            "date": "2024-12-10T16:37:12Z",
            "author_login": "eldy"
          },
          {
            "sha": "17973f1763b73eabb0af0c2f96f16974f1d0421f",
            "date": "2024-10-11T11:10:53Z",
            "author_login": "eldy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "Awstats version 7.6 and earlier is vulnerable to a path traversal flaw in the handling of the \"config\" and \"migrate\" parameters resulting in unauthenticated remote code execution.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-01-03T15:29:00.283",
    "last_modified": "2024-11-21T03:04:52.780",
    "fix_date": "2017-12-27T12:39:57Z"
  },
  "references": [
    {
      "url": "http://www.awstats.org/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/eldy/awstats/commit/06c0ab29c1e5059d9e0279c6b64d573d619e1651",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eldy/awstats/commit/cf219843a74c951bf5986f3a7fffa3dcf99c3899",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/01/msg00012.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202007-37",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4092",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.awstats.org/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/eldy/awstats/commit/06c0ab29c1e5059d9e0279c6b64d573d619e1651",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eldy/awstats/commit/cf219843a74c951bf5986f3a7fffa3dcf99c3899",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/01/msg00012.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202007-37",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4092",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:12.810189",
    "processing_status": "enhanced"
  }
}