{
  "cve_id": "CVE-2017-10911",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "089bc0143f489bd3a4578bdff5f4ca68fb26f341",
    "related_commits": [
      "089bc0143f489bd3a4578bdff5f4ca68fb26f341",
      "089bc0143f489bd3a4578bdff5f4ca68fb26f341"
    ],
    "patch_url": "https://github.com/torvalds/linux/commit/089bc0143f489bd3a4578bdff5f4ca68fb26f341.patch",
    "fix_commit_details": {
      "sha": "089bc0143f489bd3a4578bdff5f4ca68fb26f341",
      "commit_date": "2017-06-13T20:28:27Z",
      "author": {
        "login": "jbeulich",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "xen-blkback: don't leak stack data via response ring",
        "length": 531,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 48,
        "additions": 17,
        "deletions": 31
      },
      "files": [
        {
          "filename": "drivers/block/xen-blkback/blkback.c",
          "status": "modified",
          "additions": 12,
          "deletions": 11,
          "patch": "@@ -1433,34 +1433,35 @@ static int dispatch_rw_block_io(struct xen_blkif_ring *ring,\n static void make_response(struct xen_blkif_ring *ring, u64 id,\n \t\t\t  unsigned short op, int st)\n {\n-\tstruct blkif_response  resp;\n+\tstruct blkif_response *resp;\n \tunsigned long     flags;\n \tunion blkif_back_rings *blk_rings;\n \tint notify;\n \n-\tresp.id        = id;\n-\tresp.operation = op;\n-\tresp.status    = st;\n-\n \tspin_lock_irqsave(&ring->blk_ring_lock, flags);\n \tblk_rings = &ring->blk_rings;\n \t/* Place on the response ring for the relevant domain. */\n \tswitch (ring->blkif->blk_protocol) {\n \tcase BLKIF_PROTOCOL_NATIVE:\n-\t\tmemcpy(RING_GET_RESPONSE(&blk_rings->native, blk_rings->native.rsp_prod_pvt),\n-\t\t       &resp, sizeof(resp));\n+\t\tresp = RING_GET_RESPONSE(&blk_rings->native,\n+\t\t\t\t\t blk_rings->native.rsp_prod_pvt);\n \t\tbreak;\n \tcase BLKIF_PROTOCOL_X86_32:\n-\t\tmemcpy(RING_GET_RESPONSE(&blk_rings->x86_32, blk_rings->x86_32.rsp_prod_pvt),\n-\t\t       &resp, sizeof(resp));\n+\t\tresp = RING_GET_RESPONSE(&blk_rings->x86_32,\n+\t\t\t\t\t blk_rings->x86_32.rsp_prod_pvt);\n \t\tbreak;\n \tcase BLKIF_PROTOCOL_X86_64:\n-\t\tmemcpy(RING_GET_RESPONSE(&blk_rings->x86_64, blk_rings->x86_64.rsp_prod_pvt),\n-\t\t       &resp, sizeof(resp));\n+\t\tresp = RING_GET_RESPONSE(&blk_rings->x86_64,\n+\t\t\t\t\t blk_rings->x86_64.rsp_prod_pvt);\n \t\tbreak;\n \tdefault:\n \t\tBUG();\n \t}\n+\n+\tresp->id        = id;\n+\tresp->operation = op;\n+\tresp->status    = st;\n+\n \tblk_rings->common.rsp_prod_pvt++;\n \tRING_PUSH_RESPONSES_AND_CHECK_NOTIFY(&blk_rings->common, notify);\n \tspin_unlock_irqrestore(&ring->blk_ring_lock, flags);"
        },
        {
          "filename": "drivers/block/xen-blkback/common.h",
          "status": "modified",
          "additions": 5,
          "deletions": 20,
          "patch": "@@ -75,9 +75,8 @@ extern unsigned int xenblk_max_queues;\n struct blkif_common_request {\n \tchar dummy;\n };\n-struct blkif_common_response {\n-\tchar dummy;\n-};\n+\n+/* i386 protocol version */\n \n struct blkif_x86_32_request_rw {\n \tuint8_t        nr_segments;  /* number of segments                   */\n@@ -129,14 +128,6 @@ struct blkif_x86_32_request {\n \t} u;\n } __attribute__((__packed__));\n \n-/* i386 protocol version */\n-#pragma pack(push, 4)\n-struct blkif_x86_32_response {\n-\tuint64_t        id;              /* copied from request */\n-\tuint8_t         operation;       /* copied from request */\n-\tint16_t         status;          /* BLKIF_RSP_???       */\n-};\n-#pragma pack(pop)\n /* x86_64 protocol version */\n \n struct blkif_x86_64_request_rw {\n@@ -193,18 +184,12 @@ struct blkif_x86_64_request {\n \t} u;\n } __attribute__((__packed__));\n \n-struct blkif_x86_64_response {\n-\tuint64_t       __attribute__((__aligned__(8))) id;\n-\tuint8_t         operation;       /* copied from request */\n-\tint16_t         status;          /* BLKIF_RSP_???       */\n-};\n-\n DEFINE_RING_TYPES(blkif_common, struct blkif_common_request,\n-\t\t  struct blkif_common_response);\n+\t\t  struct blkif_response);\n DEFINE_RING_TYPES(blkif_x86_32, struct blkif_x86_32_request,\n-\t\t  struct blkif_x86_32_response);\n+\t\t  struct blkif_response __packed);\n DEFINE_RING_TYPES(blkif_x86_64, struct blkif_x86_64_request,\n-\t\t  struct blkif_x86_64_response);\n+\t\t  struct blkif_response);\n \n union blkif_back_rings {\n \tstruct blkif_back_ring        native;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c3812b15000cc5b7b17c7238f8b12f6a22df0b1d",
            "date": "2025-01-14T18:07:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "79a1d390f879563119bf2848b621bc7eed228c7d",
            "date": "2025-01-14T17:54:57Z",
            "author_login": "torvalds"
          },
          {
            "sha": "c45323b7560ec87c37c729b703c86ee65f136d75",
            "date": "2025-01-13T17:03:18Z",
            "author_login": "torvalds"
          },
          {
            "sha": "34c8e74cd6667ef5da90d448a1af702c4b873bd3",
            "date": "2025-01-13T08:52:08Z",
            "author_login": "YageGeng"
          },
          {
            "sha": "cbc5dde0a461240046e8a41c43d7c3b76d5db952",
            "date": "2025-01-10T15:28:21Z",
            "author_login": "rikvanriel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "The make_response function in drivers/block/xen-blkback/blkback.c in the Linux kernel before 4.11.8 allows guest OS users to obtain sensitive information from host OS (or other guest OS) kernel memory by leveraging the copying of uninitialized padding fields in Xen block-interface response structures, aka XSA-216.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-07-05T01:29:00.550",
    "last_modified": "2024-11-21T03:06:43.880",
    "fix_date": "2017-06-13T20:28:27Z"
  },
  "references": [
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=089bc0143f489bd3a4578bdff5f4ca68fb26f341",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3920",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3927",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3945",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.11.8",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/99162",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1038720",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/089bc0143f489bd3a4578bdff5f4ca68fb26f341",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/09/msg00007.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201708-03",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://xenbits.xen.org/xsa/advisory-216.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=089bc0143f489bd3a4578bdff5f4ca68fb26f341",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3920",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3927",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3945",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.11.8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/99162",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1038720",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/089bc0143f489bd3a4578bdff5f4ca68fb26f341",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/09/msg00007.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/201708-03",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://xenbits.xen.org/xsa/advisory-216.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:01.673788",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-14T12:39:03Z",
    "pushed_at": "2025-01-13T17:27:04Z",
    "size": 5361369,
    "stars": 185823,
    "forks": 54743,
    "open_issues": 437,
    "watchers": 185823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1326937103,
      "Assembly": 9568292,
      "Shell": 5072004,
      "Python": 2974128,
      "Makefile": 2713905,
      "Perl": 1253637,
      "Rust": 807711,
      "Roff": 202277,
      "C++": 173382,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71321,
      "Awk": 69539,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10172,
      "M4": 3329,
      "MATLAB": 2482,
      "sed": 2433,
      "Clojure": 2411,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 46007,
      "avg_commits_per_week": 884.75,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:59.486675"
  }
}