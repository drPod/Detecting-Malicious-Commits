{
  "cve_id": "CVE-2017-12061",
  "github_data": {
    "repository": "mantisbt/mantisbt",
    "fix_commit": "17f9b94f031ba93ae2a727bca0e68458ecd08fb0",
    "related_commits": [
      "17f9b94f031ba93ae2a727bca0e68458ecd08fb0",
      "c73ae3d3d4dd4681489a9e697e8ade785e27cba5",
      "17f9b94f031ba93ae2a727bca0e68458ecd08fb0",
      "c73ae3d3d4dd4681489a9e697e8ade785e27cba5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "17f9b94f031ba93ae2a727bca0e68458ecd08fb0",
      "commit_date": "2017-08-01T11:00:04Z",
      "author": {
        "login": "dregad",
        "type": "User",
        "stats": {
          "total_commits": 3418,
          "average_weekly_commits": 2.886824324324324,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 500
        }
      },
      "commit_message": {
        "title": "Fix XSS in install.php (CVE-2017-12061)",
        "length": 346,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 69,
        "additions": 57,
        "deletions": 12
      },
      "files": [
        {
          "filename": "admin/install.php",
          "status": "modified",
          "additions": 57,
          "deletions": 12,
          "patch": "@@ -442,7 +442,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \t\t# the check only works on mysql if the database is open\n \t\t$t_version_info = @$g_db->ServerInfo();\n \t} else {\n-\t\tprint_test_result( BAD, true, 'Does administrative user have access to the database? ( ' . db_error_msg() . ' )' );\n+\t\tprint_test_result(\n+\t\t\tBAD,\n+\t\t\ttrue,\n+\t\t\t'Does administrative user have access to the database? ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t);\n \t\t$t_version_info = null;\n \t}\n \t?>\n@@ -469,7 +473,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \t\t\t\tprint_test_result( GOOD );\n \t\t\t}\n \t\t} else {\n-\t\t\tprint_test_result( BAD, false, 'Database user doesn\\'t have access to the database ( ' . db_error_msg() . ' )' );\n+\t\t\tprint_test_result(\n+\t\t\t\tBAD,\n+\t\t\t\tfalse,\n+\t\t\t\t'Database user doesn\\'t have access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t\t);\n \t\t}\n \t\t?>\n </tr>\n@@ -791,7 +799,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \n \t\t\t\tif( !$t_rs ) {\n \t\t\t\t\t$t_result = false;\n-\t\t\t\t\tprint_test_result( BAD, true, 'Does administrative user have access to create the database? ( ' . db_error_msg() . ' )' );\n+\t\t\t\t\tprint_test_result(\n+\t\t\t\t\t\tBAD,\n+\t\t\t\t\t\ttrue,\n+\t\t\t\t\t\t'Does administrative user have access to create the database? ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t\t\t\t);\n \t\t\t\t\t$t_install_state--; # db creation failed, allow user to re-enter user/password info\n \t\t\t\t} else {\n \t\t\t\t\tprint_test_result( GOOD );\n@@ -814,9 +826,18 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \t\t\t\t\t}\n \n \t\t\t\t\tif( $t_db_exists ) {\n-\t\t\t\t\t\tprint_test_result( BAD, false, 'Database already exists? ( ' . db_error_msg() . ' )' );\n-\t\t\t\t\t} else {\n-\t\t\t\t\t\tprint_test_result( BAD, true, 'Does administrative user have access to create the database? ( ' . db_error_msg() . ' )' );\n+\t\t\t\t\t\tprint_test_result(\n+\t\t\t\t\t\t\tBAD,\n+\t\t\t\t\t\t\tfalse,\n+\t\t\t\t\t\t\t'Database already exists? ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t\t\t\t\t);\n+\t\t\t\t\t}\n+\t\t\t\t\telse {\n+\t\t\t\t\t\tprint_test_result(\n+\t\t\t\t\t\t\tBAD,\n+\t\t\t\t\t\t\ttrue,\n+\t\t\t\t\t\t\t'Does administrative user have access to create the database? ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t\t\t\t\t);\n \t\t\t\t\t\t$t_install_state--; # db creation failed, allow user to re-enter user/password info\n \t\t\t\t\t}\n \t\t\t\t}\n@@ -847,7 +868,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \t\tif( $t_result == true ) {\n \t\t\tprint_test_result( GOOD );\n \t\t} else {\n-\t\t\tprint_test_result( BAD, false, 'Database user doesn\\'t have access to the database ( ' . db_error_msg() . ' )' );\n+\t\t\tprint_test_result(\n+\t\t\t\tBAD,\n+\t\t\t\tfalse,\n+\t\t\t\t'Database user doesn\\'t have access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t\t);\n \t\t}\n \t\t$g_db->Close();\n \t?>\n@@ -1242,7 +1267,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \tif( $t_result == true ) {\n \t\tprint_test_result( GOOD );\n \t} else {\n-\t\tprint_test_result( BAD, false, 'Database user does not have access to the database ( ' . db_error_msg() . ' )' );\n+\t\tprint_test_result(\n+\t\t\tBAD,\n+\t\t\tfalse,\n+\t\t\t'Database user does not have access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t);\n \t}\n \n \tif( $f_db_type == 'db2' ) {\n@@ -1264,7 +1293,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \tif( $t_result != false ) {\n \t\tprint_test_result( GOOD );\n \t} else {\n-\t\tprint_test_result( BAD, true, 'Database user does not have SELECT access to the database ( ' . db_error_msg() . ' )' );\n+\t\tprint_test_result(\n+\t\t\tBAD,\n+\t\t\ttrue,\n+\t\t\t'Database user does not have SELECT access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t);\n \t}\n \t?>\n </tr>\n@@ -1279,7 +1312,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \tif( $t_result != false ) {\n \t\tprint_test_result( GOOD );\n \t} else {\n-\t\tprint_test_result( BAD, true, 'Database user does not have INSERT access to the database ( ' . db_error_msg() . ' )' );\n+\t\tprint_test_result(\n+\t\t\tBAD,\n+\t\t\ttrue,\n+\t\t\t'Database user does not have INSERT access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t);\n \t}\n \t?>\n </tr>\n@@ -1294,7 +1331,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \tif( $t_result != false ) {\n \t\tprint_test_result( GOOD );\n \t} else {\n-\t\tprint_test_result( BAD, true, 'Database user does not have UPDATE access to the database ( ' . db_error_msg() . ' )' );\n+\t\tprint_test_result(\n+\t\t\tBAD,\n+\t\t\ttrue,\n+\t\t\t'Database user does not have UPDATE access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t);\n \t}\n \t?>\n </tr>\n@@ -1309,7 +1350,11 @@ function print_test( $p_test_description, $p_result, $p_hard_fail = true, $p_mes\n \tif( $t_result != false ) {\n \t\tprint_test_result( GOOD );\n \t} else {\n-\t\tprint_test_result( BAD, true, 'Database user does not have DELETE access to the database ( ' . db_error_msg() . ' )' );\n+\t\tprint_test_result(\n+\t\t\tBAD,\n+\t\t\ttrue,\n+\t\t\t'Database user does not have DELETE access to the database ( ' . string_attribute( db_error_msg() ) . ' )'\n+\t\t);\n \t}\n \t?>\n </tr>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "924fb05df417dc639fd50a518dba20531a322851",
            "date": "2025-01-23T12:46:58Z",
            "author_login": "dregad"
          },
          {
            "sha": "60cb1d4e48e3e4578a1b8f662e22ba59dea9cb21",
            "date": "2025-01-23T12:41:32Z",
            "author_login": "raspopov"
          },
          {
            "sha": "7626b72778eaa1d3767b21f613219b0d1c46d9ca",
            "date": "2025-01-23T12:29:11Z",
            "author_login": "dregad"
          },
          {
            "sha": "4994c09658dd16045cc2ff62f184842029fb43fc",
            "date": "2025-01-23T12:07:11Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "64a6c746c971d6f7ecc3063f5bafe9cb357cca93",
            "date": "2025-01-20T12:07:27Z",
            "author_login": "translatewiki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "An XSS issue was discovered in admin/install.php in MantisBT before 1.3.12 and 2.x before 2.5.2. Some variables under user control in the MantisBT installation script are not properly sanitized before being output, allowing remote attackers to inject arbitrary JavaScript code, as demonstrated by the $f_database, $f_db_username, and $f_admin_username variables. This is mitigated by the fact that the admin/ folder should be deleted after installation, and also prevented by CSP.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-08-01T15:29:00.547",
    "last_modified": "2024-11-21T03:08:45.230",
    "fix_date": "2017-08-01T11:00:04Z"
  },
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/08/01/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/08/01/2",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1039030",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/17f9b94f031ba93ae2a727bca0e68458ecd08fb0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/c73ae3d3d4dd4681489a9e697e8ade785e27cba5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://mantisbt.org/bugs/view.php?id=23146",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/08/01/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/08/01/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1039030",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/17f9b94f031ba93ae2a727bca0e68458ecd08fb0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/c73ae3d3d4dd4681489a9e697e8ade785e27cba5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://mantisbt.org/bugs/view.php?id=23146",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:05.080738",
    "processing_status": "enhanced"
  }
}