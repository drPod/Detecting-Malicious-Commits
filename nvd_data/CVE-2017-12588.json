{
  "cve_id": "CVE-2017-12588",
  "github_data": {
    "repository": "rsyslog/rsyslog",
    "fix_commit": "062d0c671a29f7c6f7dff4a2f1f35df375bbb30b",
    "related_commits": [
      "062d0c671a29f7c6f7dff4a2f1f35df375bbb30b",
      "062d0c671a29f7c6f7dff4a2f1f35df375bbb30b"
    ],
    "patch_url": "https://github.com/rsyslog/rsyslog/commit/062d0c671a29f7c6f7dff4a2f1f35df375bbb30b.patch",
    "fix_commit_details": {
      "sha": "062d0c671a29f7c6f7dff4a2f1f35df375bbb30b",
      "commit_date": "2017-06-01T13:39:40Z",
      "author": {
        "login": "rgerhards",
        "type": "User",
        "stats": {
          "total_commits": 13046,
          "average_weekly_commits": 12.377609108159392,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 791
        }
      },
      "commit_message": {
        "title": "Merge pull request #1565 from Whissi/fix-format-security-issue-in-zmq-modules",
        "length": 120,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "contrib/imzmq3/imzmq3.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -403,7 +403,7 @@ static rsRetVal createSocket(instanceConf_t* info, void** sock) {\n \n     /* Do the bind/connect... */\n     if (info->action==ACTION_CONNECT) {\n-        rv = zsocket_connect(*sock, info->description);\n+        rv = zsocket_connect(*sock, \"%s\", info->description);\n         if (rv == -1) {\n             errmsg.LogError(0,\n                             RS_RET_INVALID_PARAMS,\n@@ -413,7 +413,7 @@ static rsRetVal createSocket(instanceConf_t* info, void** sock) {\n         }\n         DBGPRINTF(\"imzmq3: connect for %s successful\\n\",info->description);\n     } else {\n-        rv = zsocket_bind(*sock, info->description);\n+        rv = zsocket_bind(*sock, \"%s\", info->description);\n         if (rv == -1) {\n             errmsg.LogError(0,\n                             RS_RET_INVALID_PARAMS,"
        },
        {
          "filename": "contrib/omzmq3/omzmq3.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -242,14 +242,14 @@ static rsRetVal initZMQ(instanceData* pData) {\n     if (pData->action == ACTION_BIND) {\n         /* bind asserts, so no need to test return val here\n            which isn't the greatest api -- oh well */\n-        if(-1 == zsocket_bind(pData->socket, (char*)pData->description)) {\n+        if(-1 == zsocket_bind(pData->socket, \"%s\", (char*)pData->description)) {\n             errmsg.LogError(0, RS_RET_NO_ERRCODE, \"omzmq3: bind failed for %s: %s\",\n                             pData->description, zmq_strerror(errno));\n             ABORT_FINALIZE(RS_RET_NO_ERRCODE);\n         }\n         DBGPRINTF(\"omzmq3: bind to %s successful\\n\",pData->description);\n     } else {\n-        if(-1 == zsocket_connect(pData->socket, (char*)pData->description)) {\n+        if(-1 == zsocket_connect(pData->socket, \"%s\", (char*)pData->description)) {\n             errmsg.LogError(0, RS_RET_NO_ERRCODE, \"omzmq3: connect failed for %s: %s\", \n                             pData->description, zmq_strerror(errno));\n             ABORT_FINALIZE(RS_RET_NO_ERRCODE);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "177f73a7f851bf87686950ce4590c454d207fda3",
            "date": "2025-01-07T09:10:53Z",
            "author_login": "rgerhards"
          },
          {
            "sha": "1a40a7448388f52cc717683590e8fdc259dc1252",
            "date": "2025-01-07T07:50:36Z",
            "author_login": "rgerhards"
          },
          {
            "sha": "9135db7f0ac7015e38fa46634d5936328bf413bb",
            "date": "2024-12-31T10:55:37Z",
            "author_login": "rgerhards"
          },
          {
            "sha": "f0965735766588d17424ad45ee09bf2aa2c25139",
            "date": "2024-12-31T10:53:47Z",
            "author_login": "rgerhards"
          },
          {
            "sha": "08501b930fa02244e3edd07db0f0c727c0b980e2",
            "date": "2024-11-28T11:56:14Z",
            "author_login": "rgerhards"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-134",
    "description": "The zmq3 input and output modules in rsyslog before 8.28.0 interpreted description fields as format strings, possibly allowing a format string attack with unspecified impact.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-08-06T14:29:00.227",
    "last_modified": "2024-12-27T16:15:21.503",
    "fix_date": "2017-06-01T13:39:40Z"
  },
  "references": [
    {
      "url": "https://github.com/rsyslog/rsyslog/blob/master/ChangeLog",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rsyslog/rsyslog/commit/062d0c671a29f7c6f7dff4a2f1f35df375bbb30b",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rsyslog/rsyslog/pull/1565",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rsyslog/rsyslog/blob/master/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rsyslog/rsyslog/commit/062d0c671a29f7c6f7dff4a2f1f35df375bbb30b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rsyslog/rsyslog/pull/1565",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20241227-0009/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:05.087531",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rsyslog",
    "owner": "rsyslog",
    "created_at": "2013-06-03T15:57:55Z",
    "updated_at": "2025-01-13T13:55:11Z",
    "pushed_at": "2025-01-07T09:10:54Z",
    "size": 67785,
    "stars": 2072,
    "forks": 658,
    "open_issues": 861,
    "watchers": 2072,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 5232281,
      "Shell": 1674170,
      "JavaScript": 244987,
      "Makefile": 134903,
      "M4": 120840,
      "Python": 60355,
      "Roff": 41361,
      "Lex": 20834,
      "Yacc": 8596,
      "Perl": 6098,
      "Java": 2480,
      "Tcl": 244,
      "Ruby": 45
    },
    "commit_activity": {
      "total_commits_last_year": 141,
      "avg_commits_per_week": 2.7115384615384617,
      "days_active_last_year": 60
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-3.0"
    },
    "collected_at": "2025-01-14T18:44:44.365380"
  }
}