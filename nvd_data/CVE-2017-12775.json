{
  "cve_id": "CVE-2017-12775",
  "github_data": {
    "repository": "q2a/question2answer",
    "fix_commit": "6013ca1c83bf232008f7be815c0e4821fb6b120a",
    "related_commits": [
      "6013ca1c83bf232008f7be815c0e4821fb6b120a",
      "6013ca1c83bf232008f7be815c0e4821fb6b120a"
    ],
    "patch_url": "https://github.com/q2a/question2answer/commit/6013ca1c83bf232008f7be815c0e4821fb6b120a.patch",
    "fix_commit_details": {
      "sha": "6013ca1c83bf232008f7be815c0e4821fb6b120a",
      "commit_date": "2017-08-08T15:47:32Z",
      "author": {
        "login": "svivian",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security fix in qa-install.php",
        "length": 30,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 16,
        "deletions": 13
      },
      "files": [
        {
          "filename": "qa-include/qa-install.php",
          "status": "modified",
          "additions": 16,
          "deletions": 13,
          "patch": "@@ -65,27 +65,30 @@ function qa_install_db_fail_handler($type, $errno=null, $error=null, $query=null\n // Process user handling higher up to avoid 'headers already sent' warning\n \n if (!isset($pass_failure_type) && qa_clicked('super')) {\n+\trequire_once QA_INCLUDE_DIR.'db/admin.php';\n \trequire_once QA_INCLUDE_DIR.'db/users.php';\n \trequire_once QA_INCLUDE_DIR.'app/users-edit.php';\n \n-\t$inemail = qa_post_text('email');\n-\t$inpassword = qa_post_text('password');\n-\t$inhandle = qa_post_text('handle');\n+\tif (qa_db_count_users() == 0) { // prevent creating multiple accounts\n+\t\t$inemail = qa_post_text('email');\n+\t\t$inpassword = qa_post_text('password');\n+\t\t$inhandle = qa_post_text('handle');\n \n-\t$fielderrors = array_merge(\n-\t\tqa_handle_email_filter($inhandle, $inemail),\n-\t\tqa_password_validate($inpassword)\n-\t);\n+\t\t$fielderrors = array_merge(\n+\t\t\tqa_handle_email_filter($inhandle, $inemail),\n+\t\t\tqa_password_validate($inpassword)\n+\t\t);\n \n-\tif (empty($fielderrors)) {\n-\t\trequire_once QA_INCLUDE_DIR.'app/users.php';\n+\t\tif (empty($fielderrors)) {\n+\t\t\trequire_once QA_INCLUDE_DIR.'app/users.php';\n \n-\t\t$userid = qa_create_new_user($inemail, $inpassword, $inhandle, QA_USER_LEVEL_SUPER);\n-\t\tqa_set_logged_in_user($userid, $inhandle);\n+\t\t\t$userid = qa_create_new_user($inemail, $inpassword, $inhandle, QA_USER_LEVEL_SUPER);\n+\t\t\tqa_set_logged_in_user($userid, $inhandle);\n \n-\t\tqa_set_option('feedback_email', $inemail);\n+\t\t\tqa_set_option('feedback_email', $inemail);\n \n-\t\t$success .= \"Congratulations - Your Question2Answer site is ready to go!\\n\\nYou are logged in as the super administrator and can start changing settings.\\n\\nThank you for installing Question2Answer.\";\n+\t\t\t$success .= \"Congratulations - Your Question2Answer site is ready to go!\\n\\nYou are logged in as the super administrator and can start changing settings.\\n\\nThank you for installing Question2Answer.\";\n+\t\t}\n \t}\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bc1a8bc4fa951da908f14fc15aef65b01e8027a4",
            "date": "2024-05-06T16:49:08Z",
            "author_login": "svivian"
          },
          {
            "sha": "b011eb12c9d0e0e408ff1aaa0f3d2f7f522b023a",
            "date": "2024-05-06T16:48:21Z",
            "author_login": "svivian"
          },
          {
            "sha": "b52f0dc62950243fb312ca3403e34a9356951d23",
            "date": "2024-03-18T14:04:19Z",
            "author_login": "pupi1985"
          },
          {
            "sha": "78d141ebf5b92cbc8462e461152ad332889a69a3",
            "date": "2024-03-14T12:55:12Z",
            "author_login": "pupi1985"
          },
          {
            "sha": "2c945eab1a4383f7732f6b0d17919d45b1204489",
            "date": "2024-02-26T19:27:42Z",
            "author_login": "svivian"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "qa-include/qa-install.php in Question2Answer before 1.7.5 allows remote attackers to create multiple user accounts.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-08-29T15:29:00.767",
    "last_modified": "2024-11-21T03:10:09.670",
    "fix_date": "2017-08-08T15:47:32Z"
  },
  "references": [
    {
      "url": "http://www.question2answer.org/versions.php",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/q2a/question2answer/commit/6013ca1c83bf232008f7be815c0e4821fb6b120a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.question2answer.org/versions.php",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/q2a/question2answer/commit/6013ca1c83bf232008f7be815c0e4821fb6b120a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:05.119555",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "question2answer",
    "owner": "q2a",
    "created_at": "2011-12-05T13:18:58Z",
    "updated_at": "2025-01-13T09:24:37Z",
    "pushed_at": "2024-08-20T01:45:18Z",
    "size": 10075,
    "stars": 1645,
    "forks": 630,
    "open_issues": 84,
    "watchers": 1645,
    "has_security_policy": false,
    "default_branch": "bugfix",
    "protected_branches": [],
    "languages": {
      "PHP": 2096918,
      "CSS": 179647,
      "JavaScript": 57544
    },
    "commit_activity": {
      "total_commits_last_year": 3,
      "avg_commits_per_week": 0.057692307692307696,
      "days_active_last_year": 3
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:30:59.888863"
  }
}