{
  "cve_id": "CVE-2017-12900",
  "github_data": {
    "repository": "the-tcpdump-group/tcpdump",
    "fix_commit": "0318fa8b61bd6c837641129d585f1a73c652b1e0",
    "related_commits": [
      "0318fa8b61bd6c837641129d585f1a73c652b1e0",
      "0318fa8b61bd6c837641129d585f1a73c652b1e0"
    ],
    "patch_url": "https://github.com/the-tcpdump-group/tcpdump/commit/0318fa8b61bd6c837641129d585f1a73c652b1e0.patch",
    "fix_commit_details": {
      "sha": "0318fa8b61bd6c837641129d585f1a73c652b1e0",
      "commit_date": "2017-02-04T04:43:16Z",
      "author": {
        "login": "guyharris",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "CVE-2017-12900/Properly terminate all struct tok arrays.",
        "length": 229,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 88,
        "additions": 87,
        "deletions": 1
      },
      "files": [
        {
          "filename": "print-bgp.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -900,6 +900,7 @@ static const struct tok bgp_multicast_vpn_route_type_values[] = {\n     { BGP_MULTICAST_VPN_ROUTE_TYPE_SOURCE_ACTIVE, \"Source-Active\"},\n     { BGP_MULTICAST_VPN_ROUTE_TYPE_SHARED_TREE_JOIN, \"Shared Tree Join\"},\n     { BGP_MULTICAST_VPN_ROUTE_TYPE_SOURCE_TREE_JOIN, \"Source Tree Join\"},\n+    { 0, NULL}\n };\n \n static int"
        },
        {
          "filename": "print-lldp.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -590,6 +590,7 @@ static const struct tok lldp_evb_mode_values[]={\n     { LLDP_EVB_MODE_EVB_BRIDGE, \"EVB Bridge\"},\n     { LLDP_EVB_MODE_EVB_STATION, \"EVB Staion\"},\n     { LLDP_EVB_MODE_RESERVED, \"Reserved for future Standardization\"},\n+    { 0, NULL},\n };\n \n #define NO_OF_BITS 8"
        },
        {
          "filename": "print-lspping.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -104,6 +104,7 @@ static const struct tok lspping_return_code_values[] = {\n     { 11, \"No label entry at stack-depth\"},\n     { 12, \"Protocol not associated with interface at FEC stack depth\"},\n     { 13, \"Premature termination of ping due to label stack shrinking to a single label\"},\n+    { 0,  NULL},\n };\n \n "
        },
        {
          "filename": "print-zephyr.c",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -76,7 +76,8 @@ static const struct tok z_types[] = {\n     { Z_PACKET_SERVACK,\t\t\"serv-ack\" },\n     { Z_PACKET_SERVNAK,\t\t\"serv-nak\" },\n     { Z_PACKET_CLIENTACK,\t\"client-ack\" },\n-    { Z_PACKET_STAT,\t\t\"stat\" }\n+    { Z_PACKET_STAT,\t\t\"stat\" },\n+    { 0,\t\t\tNULL }\n };\n \n static char z_buf[256];"
        },
        {
          "filename": "tests/TESTLIST",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -456,6 +456,8 @@ icmp-cksum-oobr-1\ticmp-cksum-oobr-1.pcap\t\ticmp-cksum-oobr-1.out\t-vvv -e\n icmp-cksum-oobr-2\ticmp-cksum-oobr-2.pcap\t\ticmp-cksum-oobr-2.out\t-vvv -e\n icmp-cksum-oobr-3\ticmp-cksum-oobr-3.pcap\t\ticmp-cksum-oobr-3.out\t-vvv -e\n icmp-cksum-oobr-4\ticmp-cksum-oobr-4.pcap\t\ticmp-cksum-oobr-4.out\t-vvv -e\n+tok2str-oobr-1\t\ttok2str-oobr-1.pcap\t\ttok2str-oobr-1.out\t-vvv -e\n+tok2str-oobr-2\t\ttok2str-oobr-2.pcap\t\ttok2str-oobr-2.out\t-vvv -e\n \n # RTP tests\n # fuzzed pcap"
        },
        {
          "filename": "tests/tok2str-oobr-1.out",
          "status": "added",
          "additions": 61,
          "deletions": 0,
          "patch": "@@ -0,0 +1,61 @@\n+00:0c:29:31:85:a5 > 00:0c:29:ac:b9:50, ethertype IPv4 (0x0800), length 321: (tos 0xc0, ttl 254, id 20061, offset 0, flags [none], proto TCP (6), length 307)\n+    10.0.0.4.179 > 10.0.0.2.64588: Flags [P.], cksum 0x707c (incorrect -> 0x6883), seq 786752827:786753082, ack 3829861902, win 16357, options [nop,nop,TS val 6993003 ecr 4502201], length 255: BGP\n+\tUpdate Message (2), length: 100\n+\t  Origin (1), length: 1, Flags [T]: IGP\n+\t    0x0000:  00\n+\t  AS Path (2), length: 0, Flags [T]: empty\n+\t  Local Preference (5), length: 4, Flags [T]: 100\n+\t    0x0000:  0000 0064\n+\t  Extended Community (16), length: 24, Flags [OT]: \n+\t    target (0x0002), Flags [none]: 1:1 (= 0.0.0.1)\n+\t    source-AS (0x0009), Flags [none]: AS 1\n+\t    unknown extd community typecode (0x010a), Flags [none]\n+\t      0x0000:  010a 0a00 0004 0006\n+\t    0x0000:  0002 0001 0000 0001 0009 0001 0000 0000\n+\t    0x0010:  010a 0a00 0004 0006\n+\t  Multi-Protocol Reach NLRI (14), length: 32, Flags [OE]: \n+\t    AFI: IPv4 (1), SAFI: labeled VPN Unicast (128)\n+\t    nexthop: RD: 0:0 (= 0.0.0.0), 10.0.0.4, nh-length: 12, no SNPA\n+\t      RD: 1:1 (= 0.0.0.1), 172.16.4.0/24, label:16 (bottom)\n+\t    0x0000:  0001 800c 0000 0000 0000 0000 0a00 0004\n+\t    0x0010:  0070 0001 0100 0000 0100 0000 01ac 1004\n+\tUpdate Message (2), length: 95\n+\t  Origin (1), length: 1, Flags [T]: IGP\n+\t    0x0000:  00\n+\t  AS Path (2), length: 0, Flags [T]: empty\n+\t  Local Preference (5), length: 4, Flags [T]: 100\n+\t    0x0000:  0000 0064\n+\t  Extended Community (16), length: 8, Flags [OT]: \n+\t    target (0x0002), Flags [none]: 1:1 (= 0.0.0.1)\n+\t    0x0000:  0002 0001 0000 0001\n+\t  PMSI Tunnel (22), length: 17, Flags [OT]: \n+\t    Tunnel-type RSVP-TE P2MP LSP (1), Flags [none], MPLS Label 0\n+\t      Extended-Tunnel-ID 10.0.0.4, P2MP-ID 0x00008173\n+\t    0x0000:  0001 0000 000a 0000 0400 0081 730a 0000\n+\t    0x0010:  04\n+\t  Multi-Protocol Reach NLRI (14), length: 23, Flags [OE]: \n+\t    AFI: IPv4 (1), SAFI: Multicast VPN (5)\n+\t    nexthop: 10.0.0.4, nh-length: 4\n+\t    8 SNPA\n+\t      1 bytes\n+\t      0 bytes\n+\t      0 bytes\n+\t      0 bytes\n+\t      1 bytes\n+\t      0 bytes\n+\t      0 bytes\n+\t      1 bytes\n+\t      Route-Type: Unknown (0), length: 0\n+\t      Route-Type: Intra-AS Segment-Leaf (4), length: 255\n+\t    0x0000:  0001 0504 0a00 0004 0801 0c00 0000 0100\n+\t    0x0010:  0000 010a 0000 04\n+\tUpdate Message (2), length: 30\n+\t  Multi-Protocol Unreach NLRI (15), length: 3, Flags [OE]: \n+\t    AFI: IPv4 (1), SAFI: labeled VPN Unicast (128)\n+\t      End-of-Rib Marker (empty NLRI)\n+\t    0x0000:  0001 80\n+\tUpdate Message (2), length: 30\n+\t  Withdrawn routes: 1 bytes\n+\t  Unknown Attribute (0), length: 3, Flags [+f]: \n+\t    no Attribute 0 decoder\n+\t    0x0000:  0001 05[|BGP]"
        },
        {
          "filename": "tests/tok2str-oobr-1.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/tok2str-oobr-2.out",
          "status": "added",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -0,0 +1,19 @@\n+01:01:01:01:01:01 > 02:02:02:02:02:02, ethertype MPLS unicast (0x8847), length 130: MPLS (label 16006, exp 0, [S], ttl 255)\n+\t(tos 0x0, ttl 1, id 32770, offset 0, flags [DF, rsvd], proto UDP (17), length 112, options (RA), bad cksum a4cc (->a4cb)!)\n+    192.168.0.1.3503 > 127.0.0.1.3503: [bad udp cksum 0x8397 -> 0x3f6d!] \n+\tLSP-PINGv1, msg-type: MPLS Echo Request (1), length: 80\n+\t  reply-mode: Reply via an IPv4/IPv6 UDP packet (2)\n+\t  Return Code: unknown (65)\n+\t  Return Subcode: (0)\n+\t  Sender Handle: 0x00000023, Sequence: 1\n+\t  Sender Timestamp: Receiver Timestamp: no timestamp\n+\t  Target FEC Stack TLV (1), length: 24\n+\t    Unknown subTLV (17), length: 20\n+\t      0x0000:  0000 0001 0000 0001 c0a8 0001 c0a8 0001\n+\t      0x0010:  0000 2712\n+\t    0x0000:  0011 0014 0000 0001 0000 0001 c0a8 0001\n+\t    0x0010:  c0a8 0001 0000 2712\n+\t  Unknown TLV (268), length: 4\n+\t    0x0000:  0008 00c8\n+\t  Unknown TLV (523), length: 8\n+\t    0x0000:  0003 0004 c0a8 0104"
        },
        {
          "filename": "tests/tok2str-oobr-2.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 5,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "05a263a5418a9e5b971509c486246eb0913c8aea",
            "date": "2025-01-12T21:05:02Z",
            "author_login": "fxlb"
          },
          {
            "sha": "9aee9964aaee40750acde45f838f48eb8f95fbe3",
            "date": "2025-01-09T15:35:53Z",
            "author_login": "fxlb"
          },
          {
            "sha": "6cd500c8dafe5a9bbf3e56312493709e8b118726",
            "date": "2025-01-08T20:12:09Z",
            "author_login": "fxlb"
          },
          {
            "sha": "c5b54bfbd68b03f7997feaa277db30d399975a4d",
            "date": "2022-10-11T20:10:46Z",
            "author_login": "fenner"
          },
          {
            "sha": "431bdb5c365360d61968e7fa02322825b1da4208",
            "date": "2025-01-07T19:21:12Z",
            "author_login": "fxlb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "Several protocol parsers in tcpdump before 4.9.2 could cause a buffer over-read in util-print.c:tok2strbuf().",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-14T06:29:00.467",
    "last_modified": "2024-11-21T03:10:24.043",
    "fix_date": "2017-02-04T04:43:16Z"
  },
  "references": [
    {
      "url": "http://www.debian.org/security/2017/dsa-3971",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1039307",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.tcpdump.org/tcpdump-changes.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHEA-2018:0705",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/the-tcpdump-group/tcpdump/commit/0318fa8b61bd6c837641129d585f1a73c652b1e0",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201709-23",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT208221",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3971",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1039307",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.tcpdump.org/tcpdump-changes.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHEA-2018:0705",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/the-tcpdump-group/tcpdump/commit/0318fa8b61bd6c837641129d585f1a73c652b1e0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201709-23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT208221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.362069",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tcpdump",
    "owner": "the-tcpdump-group",
    "created_at": "2013-04-14T21:46:15Z",
    "updated_at": "2025-01-14T07:48:01Z",
    "pushed_at": "2025-01-13T06:19:33Z",
    "size": 27691,
    "stars": 2789,
    "forks": 860,
    "open_issues": 115,
    "watchers": 2789,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "tcpdump-3.5",
      "tcpdump-3.6",
      "tcpdump-3.7",
      "tcpdump-3.8",
      "tcpdump-3.9",
      "tcpdump-4.0",
      "tcpdump-4.1",
      "tcpdump-4.2",
      "tcpdump-4.3",
      "tcpdump-4.4",
      "tcpdump-4.5",
      "tcpdump-4.6",
      "tcpdump-4.7",
      "tcpdump-4.8",
      "tcpdump-4.9",
      "tcpdump-4.99"
    ],
    "languages": {
      "C": 3548298,
      "CMake": 76892,
      "Roff": 66849,
      "Shell": 50525,
      "M4": 31504,
      "Perl": 29240,
      "Makefile": 14259,
      "Awk": 4120,
      "GDB": 660
    },
    "commit_activity": {
      "total_commits_last_year": 314,
      "avg_commits_per_week": 6.038461538461538,
      "days_active_last_year": 158
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:04:48.453717"
  }
}