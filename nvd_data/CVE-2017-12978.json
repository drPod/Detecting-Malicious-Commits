{
  "cve_id": "CVE-2017-12978",
  "github_data": {
    "repository": "Cacti/cacti",
    "fix_commit": "9c610a7a4e29595dcaf7d7082134e4b89619ea24",
    "related_commits": [
      "9c610a7a4e29595dcaf7d7082134e4b89619ea24",
      "9c610a7a4e29595dcaf7d7082134e4b89619ea24"
    ],
    "patch_url": "https://github.com/Cacti/cacti/commit/9c610a7a4e29595dcaf7d7082134e4b89619ea24.patch",
    "fix_commit_details": {
      "sha": "9c610a7a4e29595dcaf7d7082134e4b89619ea24",
      "commit_date": "2017-08-19T14:31:27Z",
      "author": {
        "login": "cigamit",
        "type": "User",
        "stats": {
          "total_commits": 4797,
          "average_weekly_commits": 4.05152027027027,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 279
        }
      },
      "commit_message": {
        "title": "Resolving Issue #918",
        "length": 70,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 91,
        "additions": 51,
        "deletions": 40
      },
      "files": [
        {
          "filename": "docs/CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -10,6 +10,7 @@ Cacti CHANGELOG\n -issue#914: Unable to purge Cacti logfile from System Utilities\n -issue#915: Non-numeric data in ss_host_disk.php\n -issue#916: Resolve display of errors when encountering ldap issues\n+-issue#918: Minor XSS and create generalized escape function\n -issue: Resolve JavaScript errors on Login page\n -issue: Resolve JavaScript errors on Permission Denied pages\n -feature: Updated dutch translations"
        },
        {
          "filename": "lib/html.php",
          "status": "modified",
          "additions": 50,
          "deletions": 40,
          "patch": "@@ -51,7 +51,7 @@ function html_start_box($title, $width, $div, $cell_padding, $align, $add_text,\n \t\tprint \"<div id='$table_id' class='cactiTable' style='width:$width;text-align:$align;'>\";\n \t\tprint \"<div>\";\n \t\tprint \"<div class='cactiTableTitle'><span>\" . ($title != '' ? $title:'') . '</span></div>';\n-\t\tprint \"<div class='cactiTableButton'><span>\" . ($add_text != '' ? \"<a class='linkOverDark' href='\" . htmlspecialchars($add_text) . \"'>\" . $add_label . '</a>':'') . '</span></div>';\n+\t\tprint \"<div class='cactiTableButton'><span>\" . ($add_text != '' ? \"<a class='linkOverDark' href='\" . html_escape($add_text) . \"'>\" . $add_label . '</a>':'') . '</span></div>';\n \t\tprint '</div>';\n \n \t\tif ($div === true) {\n@@ -132,7 +132,7 @@ function html_graph_area(&$graph_array, $no_graphs_message = '', $extra_url_args\n \t\t\t\t\t<tr>\n \t\t\t\t\t\t<td>\n \t\t\t\t\t\t\t<div class='graphWrapper' style='width:100%;' id='wrapper_<?php print $graph['local_graph_id']?>' graph_width='<?php print $graph['width'];?>' graph_height='<?php print $graph['height'];?>' title_font_size='<?php print ((read_user_setting('custom_fonts') == 'on') ? read_user_setting('title_size') : read_config_option('title_size'));?>'></div>\n-\t\t\t\t\t\t\t<?php print (read_user_setting('show_graph_title') == 'on' ? \"<span class='center'>\" . htmlspecialchars($graph['title_cache']) . '</span>' : '');?>\n+\t\t\t\t\t\t\t<?php print (read_user_setting('show_graph_title') == 'on' ? \"<span class='center'>\" . html_escape($graph['title_cache']) . '</span>' : '');?>\n \t\t\t\t\t\t</td>\n \t\t\t\t\t\t<td id='dd<?php print $graph['local_graph_id'];?>' class='noprint graphDrillDown'>\n \t\t\t\t\t\t\t<?php graph_drilldown_icons($graph['local_graph_id']);?>\n@@ -247,7 +247,7 @@ function html_graph_thumbnail_area(&$graph_array, $no_graphs_message = '', $extr\n \t\t\t\t\t<tr>\n \t\t\t\t\t\t<td>\n \t\t\t\t\t\t\t<div class='graphWrapper' id='wrapper_<?php print $graph['local_graph_id']?>' graph_width='<?php print read_user_setting('default_width');?>' graph_height='<?php print read_user_setting('default_height');?>'></div>\n-\t\t\t\t\t\t\t<?php print (read_user_setting('show_graph_title') == 'on' ? \"<span class='center'>\" . htmlspecialchars($graph['title_cache']) . '</span>' : '');?>\n+\t\t\t\t\t\t\t<?php print (read_user_setting('show_graph_title') == 'on' ? \"<span class='center'>\" . html_escape($graph['title_cache']) . '</span>' : '');?>\n \t\t\t\t\t\t</td>\n \t\t\t\t\t\t<td id='dd<?php print $graph['local_graph_id'];?>' class='noprint graphDrillDown'>\n \t\t\t\t\t\t\t<?php print graph_drilldown_icons($graph['local_graph_id'], 'graph_buttons_thumbnails');?>\n@@ -503,10 +503,10 @@ function html_header_sort($header_items, $sort_column, $sort_direction, $last_it\n \t\t}\n \n \t\tif (($db_column == '') || (substr_count($db_column, 'nosort'))) {\n-\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . htmlspecialchars($tip, ENT_QUOTES, 'UTF-8') . \"'\":'') . \" class='$nohide $align' \" . ((($i+1) == count($header_items)) ? \"colspan='$last_item_colspan' \" : '') . '>' . $display_text . \"</th>\\n\";\n+\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . html_escape($tip) . \"'\":'') . \" class='$nohide $align' \" . ((($i+1) == count($header_items)) ? \"colspan='$last_item_colspan' \" : '') . '>' . $display_text . \"</th>\\n\";\n \t\t} else {\n-\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . htmlspecialchars($tip, ENT_QUOTES, 'UTF-8') . \"'\":'') . \" class='sortable $align $nohide $isSort'>\";\n-\t\t\tprint \"<div class='sortinfo' sort-page='\" . ($url == '' ? htmlspecialchars(get_current_page(false)):$url) . \"' sort-column='$db_column' sort-direction='$direction'><div class='textSubHeaderDark'>\" . $display_text . \"<i class='$icon'></i></div></div></th>\\n\";\n+\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . html_escape($tip) . \"'\":'') . \" class='sortable $align $nohide $isSort'>\";\n+\t\t\tprint \"<div class='sortinfo' sort-page='\" . ($url == '' ? html_escape(get_current_page(false)):$url) . \"' sort-column='$db_column' sort-direction='$direction'><div class='textSubHeaderDark'>\" . $display_text . \"<i class='$icon'></i></div></div></th>\\n\";\n \t\t}\n \n \t\t$i++;\n@@ -664,10 +664,10 @@ function html_header_sort_checkbox($header_items, $sort_column, $sort_direction,\n \t\t}\n \n \t\tif (($db_column == '') || (substr_count($db_column, 'nosort'))) {\n-\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . htmlspecialchars($tip, ENT_QUOTES, 'UTF-8') . \"'\":'') . \" class='$align $nohide'>\" . $display_text . \"</th>\\n\";\n+\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . html_escape($tip) . \"'\":'') . \" class='$align $nohide'>\" . $display_text . \"</th>\\n\";\n \t\t} else {\n-\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . htmlspecialchars($tip, ENT_QUOTES, 'UTF-8') . \"'\":'') . \" class='sortable $align $nohide $isSort'>\";\n-\t\t\tprint \"<div class='sortinfo' sort-page='\" . htmlspecialchars($form_action, ENT_QUOTES, 'UTF-8') . \"' sort-column='$db_column' sort-direction='$direction'><div class='textSubHeaderDark'>\" . $display_text . \"<i class='$icon'></i></div></div></th>\\n\";\n+\t\t\tprint '<th ' . ($tip != '' ? \"title='\" . html_escape($tip) . \"'\":'') . \" class='sortable $align $nohide $isSort'>\";\n+\t\t\tprint \"<div class='sortinfo' sort-page='\" . html_escape($form_action) . \"' sort-column='$db_column' sort-direction='$direction'><div class='textSubHeaderDark'>\" . $display_text . \"<i class='$icon'></i></div></div></th>\\n\";\n \t\t}\n \t}\n \n@@ -778,36 +778,46 @@ function html_create_list($form_data, $column_display, $column_id, $form_previou\n \tif (empty($column_display)) {\n \t\tif (sizeof($form_data)) {\n \t\t\tforeach (array_keys($form_data) as $id) {\n-\t\t\t\tprint '<option value=\"' . htmlspecialchars($id, ENT_QUOTES, 'UTF-8') . '\"';\n+\t\t\t\tprint '<option value=\"' . html_escape($id) . '\"';\n \n \t\t\t\tif ($form_previous_value == $id) {\n \t\t\t\t\tprint ' selected';\n \t\t\t\t}\n \n-\t\t\t\tprint '>' . title_trim(null_out_substitutions(htmlspecialchars($form_data[$id])), 75) . \"</option>\\n\";\n+\t\t\t\tprint '>' . title_trim(null_out_substitutions(html_escape($form_data[$id])), 75) . \"</option>\\n\";\n \t\t\t}\n \t\t}\n \t} else {\n \t\tif (sizeof($form_data)) {\n \t\t\tforeach ($form_data as $row) {\n-\t\t\t\tprint \"<option value='\" . htmlspecialchars($row[$column_id], ENT_QUOTES, 'UTF-8') . \"'\";\n+\t\t\t\tprint \"<option value='\" . html_escape($row[$column_id]) . \"'\";\n \n \t\t\t\tif ($form_previous_value == $row[$column_id]) {\n \t\t\t\t\tprint ' selected';\n \t\t\t\t}\n \n \t\t\t\tif (isset($row['host_id'])) {\n-\t\t\t\t\tprint '>' . title_trim(htmlspecialchars($row[$column_display]), 75) . \"</option>\\n\";\n+\t\t\t\t\tprint '>' . title_trim(html_escape($row[$column_display]), 75) . \"</option>\\n\";\n \t\t\t\t} else {\n-\t\t\t\t\tprint '>' . title_trim(null_out_substitutions(htmlspecialchars($row[$column_display])), 75) . \"</option>\\n\";\n+\t\t\t\t\tprint '>' . title_trim(null_out_substitutions(html_escape($row[$column_display])), 75) . \"</option>\\n\";\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \t}\n }\n \n+/* html_escape_request_var - sanitizes a request variable for display\n+   @arg $string - string the request variable to escape\n+   @returns $new_string - the escaped request variable to be returned. */\n function html_escape_request_var($string) {\n-\treturn htmlspecialchars(get_request_var($string), ENT_QUOTES, 'UTF-8');\n+\treturn html_escape(get_request_var($string));\n+}\n+\n+/* html_escape - sanitizes a string for display\n+   @arg $string - string the string to escape\n+   @returns $new_string - the escaped string to be returned. */\n+function html_escape($string) {\n+\treturn htmlspecialchars($string, ENT_QUOTES, 'UTF-8', true);\n }\n \n /* html_split_string - takes a string and breaks it into a number of <br> separated segments\n@@ -824,8 +834,8 @@ function html_split_string($string, $length = 70, $forgiveness = 10) {\n \twhile (!$done) {\n \t\tif (strlen($string) > $length) {\n \t\t\tfor($i = 0; $i < $forgiveness; $i++) {\n-\t\t\t\tif (substr($string, $length-$i, 1) == \" \") {\n-\t\t\t\t\t$new_string .= substr($string, 0, $length-$i) . \"<br>\";\n+\t\t\t\tif (substr($string, $length-$i, 1) == ' ') {\n+\t\t\t\t\t$new_string .= substr($string, 0, $length-$i) . '<br>';\n \n \t\t\t\t\tbreak;\n \t\t\t\t}\n@@ -898,7 +908,7 @@ function draw_graph_items_list($item_list, $filename, $url_data, $disable_contro\n \t\t\t}\n \n \t\t\tprint '<td>';\n-\t\t\tif ($disable_controls == false) { print \"<a class='linkEditMain' href='\" . htmlspecialchars(\"$filename?action=item_edit&id=\" . $item['id'] . \"&$url_data\") . \"'>\"; }\n+\t\t\tif ($disable_controls == false) { print \"<a class='linkEditMain' href='\" . html_escape(\"$filename?action=item_edit&id=\" . $item['id'] . \"&$url_data\") . \"'>\"; }\n \t\t\tprint __('Item # %d', ($i+1));\n \t\t\tif ($disable_controls == false) { print '</a>'; }\n \t\t\tprint '</td>';\n@@ -933,7 +943,7 @@ function draw_graph_items_list($item_list, $filename, $url_data, $disable_contro\n \t\t\t}\n \n \t\t\t/* data source */\n-\t\t\tprint \"<td style='$this_row_style'>\" . htmlspecialchars($matrix_title) . $hard_return . '</td>';\n+\t\t\tprint \"<td style='$this_row_style'>\" . html_escape($matrix_title) . $hard_return . '</td>';\n \n \t\t\t/* graph item type */\n \t\t\tprint \"<td style='$this_row_style'>\" . $graph_item_types{$item['graph_type_id']} . '</td>';\n@@ -962,18 +972,18 @@ function draw_graph_items_list($item_list, $filename, $url_data, $disable_contro\n \t\t\tif ($disable_controls == false) {\n \t\t\t\tprint \"<td style='text-align:right;padding-right:10px;'>\\n\";\n \t\t\t\tif ($i != sizeof($item_list)-1) {\n-\t\t\t\t\tprint \"<a class='moveArrow fa fa-caret-down' title='\" . __esc('Move Down'). \"' href='\" . htmlspecialchars(\"$filename?action=item_movedown&id=\" . $item[\"id\"] . \"&$url_data\") . \"'></a>\\n\";\n+\t\t\t\t\tprint \"<a class='moveArrow fa fa-caret-down' title='\" . __esc('Move Down'). \"' href='\" . html_escape(\"$filename?action=item_movedown&id=\" . $item[\"id\"] . \"&$url_data\") . \"'></a>\\n\";\n \t\t\t\t} else {\n \t\t\t\t\tprint \"<span class='moveArrowNone'></span>\\n\";\n \t\t\t\t}\n \t\t\t\tif ($i > 0) {\n-\t\t\t\t\tprint \"<a class='moveArrow fa fa-caret-up' title='\" . __esc('Move Up') . \"' href='\" . htmlspecialchars(\"$filename?action=item_moveup&id=\" . $item[\"id\"] . \"&$url_data\") . \"'></a>\\n\";\n+\t\t\t\t\tprint \"<a class='moveArrow fa fa-caret-up' title='\" . __esc('Move Up') . \"' href='\" . html_escape(\"$filename?action=item_moveup&id=\" . $item[\"id\"] . \"&$url_data\") . \"'></a>\\n\";\n \t\t\t\t} else {\n \t\t\t\t\tprint \"<span class='moveArrowNone'></span>\\n\";\n \t\t\t\t}\n \t\t\t\tprint \"</td>\\n\";\n \n-\t\t\t\tprint \"<td style='text-align:right;'><a class='deleteMarker fa fa-remove' title='\" . __esc('Delete') . \"' href='\" . htmlspecialchars(\"$filename?action=item_remove&id=\" . $item[\"id\"] . \"&$url_data\") . \"'></a></td>\\n\";\n+\t\t\t\tprint \"<td style='text-align:right;'><a class='deleteMarker fa fa-remove' title='\" . __esc('Delete') . \"' href='\" . html_escape(\"$filename?action=item_remove&id=\" . $item[\"id\"] . \"&$url_data\") . \"'></a></td>\\n\";\n \t\t\t}\n \n \t\t\tprint \"</tr>\";\n@@ -1108,9 +1118,9 @@ function draw_menu($user_menu = \"\") {\n \t\t\t\t\t\t\tthat is contained in the sub-items array */\n \t\t\t\t\t\t\tif (($i == 0) || ($draw_sub_items)) {\n \t\t\t\t\t\t\t\tif (is_menu_pick_active($item_sub_url)) {\n-\t\t\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic selected' href='\" . htmlspecialchars($item_sub_url) . \"'>$item_sub_title</a></li>\\n\";\n+\t\t\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic selected' href='\" . html_escape($item_sub_url) . \"'>$item_sub_title</a></li>\\n\";\n \t\t\t\t\t\t\t\t} else {\n-\t\t\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic' href='\" . htmlspecialchars($item_sub_url) . \"'>$item_sub_title</a></li>\\n\";\n+\t\t\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic' href='\" . html_escape($item_sub_url) . \"'>$item_sub_title</a></li>\\n\";\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t}\n \n@@ -1122,9 +1132,9 @@ function draw_menu($user_menu = \"\") {\n \t\t\t\t\t\t/* draw normal (non sub-item) menu item */\n \t\t\t\t\t\t$item_url = $config['url_path'] . $item_url;\n \t\t\t\t\t\tif (is_menu_pick_active($item_url)) {\n-\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic selected' href='\" . htmlspecialchars($item_url) . \"'>$item_title</a></li>\\n\";\n+\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic selected' href='\" . html_escape($item_url) . \"'>$item_title</a></li>\\n\";\n \t\t\t\t\t\t} else {\n-\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic' href='\" . htmlspecialchars($item_url) . \"'>$item_title</a></li>\\n\";\n+\t\t\t\t\t\t\tprint \"<li><a role='menuitem' class='pic' href='\" . html_escape($item_url) . \"'>$item_title</a></li>\\n\";\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n \t\t\t\t}\n@@ -1311,9 +1321,9 @@ function html_show_tabs_left() {\n \t\t\t} else {\n \t\t\t\t$file = get_current_page();\n \t\t\t\tif ($file == \"graph_view.php\" || $file == \"graph.php\") {\n-\t\t\t\t\tprint \"<a id='maintab-anchor\" . rand() . \"' class='selected' href='\" . htmlspecialchars($config['url_path'] . 'graph_view.php') . \"'><img src='\" . $config['url_path'] . \"images/tab_graphs_down.gif' alt='\" . __('Graphs') . \"'></a>\";\n+\t\t\t\t\tprint \"<a id='maintab-anchor\" . rand() . \"' class='selected' href='\" . html_escape($config['url_path'] . 'graph_view.php') . \"'><img src='\" . $config['url_path'] . \"images/tab_graphs_down.gif' alt='\" . __('Graphs') . \"'></a>\";\n \t\t\t\t} else {\n-\t\t\t\t\tprint \"<a href='\" . htmlspecialchars($config['url_path'] . 'graph_view.php') . \"'><img src='\" . $config['url_path'] . \"images/tab_graphs.gif' alt='\" . __('Graphs') . \"'></a>\";\n+\t\t\t\t\tprint \"<a href='\" . html_escape($config['url_path'] . 'graph_view.php') . \"'><img src='\" . $config['url_path'] . \"images/tab_graphs.gif' alt='\" . __('Graphs') . \"'></a>\";\n \t\t\t\t}\n \t\t\t}\n \t\t}\n@@ -1516,7 +1526,7 @@ function html_show_tabs_left() {\n \n \t\tprint \"<div class='maintabs'><nav><ul role='tablist'>\\n\";\n \t\tforeach($tabs_left as $tab) {\n-\t\t\tprint \"<li><a id='\" . (isset($tab['id']) ? $tab['id'] : 'maintab-anchor-' . $i) . \"' class='lefttab\" . (isset($tab['selected']) ? ' selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n+\t\t\tprint \"<li><a id='\" . (isset($tab['id']) ? $tab['id'] : 'maintab-anchor-' . $i) . \"' class='lefttab\" . (isset($tab['selected']) ? ' selected':'') . \"' href='\" . html_escape($tab['url']) . \"'>\" . html_escape($tab['title']) . \"</a></li>\\n\";\n \n \t\t\t$i++;\n \t\t}\n@@ -1531,21 +1541,21 @@ function html_graph_tabs_right($current_user) {\n \n \tif ($theme == 'classic') {\n \t\tif (is_view_allowed('show_tree')) {\n-\t\t\t?><a class='righttab' id='treeview' href='<?php print htmlspecialchars($config['url_path'] . 'graph_view.php?action=tree');?>'><img src='<?php echo $config['url_path']; ?>images/tab_mode_tree<?php\n+\t\t\t?><a class='righttab' id='treeview' href='<?php print html_escape($config['url_path'] . 'graph_view.php?action=tree');?>'><img src='<?php echo $config['url_path']; ?>images/tab_mode_tree<?php\n \t\t\tif (isset_request_var('action') && get_nfilter_request_var('action') == 'tree') {\n \t\t\t\tprint '_down';\n \t\t\t}?>.gif' title='<?php print __esc('Tree View');?>' alt=''></a><?php\n \t\t}?><?php\n \n \t\tif (is_view_allowed('show_list')) {\n-\t\t\t?><a class='righttab' id='listview' href='<?php print htmlspecialchars($config['url_path'] . 'graph_view.php?action=list');?>'><img src='<?php echo $config['url_path']; ?>images/tab_mode_list<?php\n+\t\t\t?><a class='righttab' id='listview' href='<?php print html_escape($config['url_path'] . 'graph_view.php?action=list');?>'><img src='<?php echo $config['url_path']; ?>images/tab_mode_list<?php\n \t\t\tif (isset_request_var('action') && get_nfilter_request_var('action') == 'list') {\n \t\t\t\tprint '_down';\n \t\t\t}?>.gif' title='<?php print __esc('List View');?>' alt=''></a><?php\n \t\t}?><?php\n \n \t\tif (is_view_allowed('show_preview')) {\n-\t\t\t?><a class='righttab' id='preview' href='<?php print htmlspecialchars($config['url_path'] . 'graph_view.php?action=preview');?>'><img src='<?php echo $config['url_path']; ?>images/tab_mode_preview<?php\n+\t\t\t?><a class='righttab' id='preview' href='<?php print html_escape($config['url_path'] . 'graph_view.php?action=preview');?>'><img src='<?php echo $config['url_path']; ?>images/tab_mode_preview<?php\n \t\t\tif (isset_request_var('action') && get_nfilter_request_var('action') == 'preview') {\n \t\t\t\tprint '_down';\n \t\t\t}?>.gif' title='<?php print __esc('Preview View');?>' alt=''></a><?php\n@@ -1607,24 +1617,24 @@ function html_graph_tabs_right($current_user) {\n \t\t\tswitch($tab['id']) {\n \t\t\tcase 'tree':\n \t\t\t\tif (isset($tab['image']) && $tab['image'] != '') {\n-\t\t\t\t\tprint \"<li role='tab'><a id='treeview' title='\" . htmlspecialchars($tab['title'], ENT_QUOTES, 'UTF-8') . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'><img src='\" . $config['url_path'] . $tab['image'] . \"' alt='' style='vertical-align:bottom;'></a></li>\\n\";\n+\t\t\t\t\tprint \"<li role='tab'><a id='treeview' title='\" . html_escape($tab['title']) . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'><img src='\" . $config['url_path'] . $tab['image'] . \"' alt='' style='vertical-align:bottom;'></a></li>\\n\";\n \t\t\t\t} else {\n-\t\t\t\t\tprint \"<li role='tab'><a title='\" . htmlspecialchars($tab['title'], ENT_QUOTES, 'UTF-8') . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n+\t\t\t\t\tprint \"<li role='tab'><a title='\" . html_escape($tab['title']) . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n \t\t\t\t}\n \t\t\t\tbreak;\n \t\t\tcase 'list':\n \t\t\t\tif (isset($tab['image']) && $tab['image'] != '') {\n-\t\t\t\t\tprint \"<li role='tab'><a id='listview' title='\" . htmlspecialchars($tab['title'], ENT_QUOTES, 'UTF-8') . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'><img src='\" . $config['url_path'] . $tab['image'] . \"' alt='' style='vertical-align:bottom;'></a></li>\\n\";\n+\t\t\t\t\tprint \"<li role='tab'><a id='listview' title='\" . html_escape($tab['title']) . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'><img src='\" . $config['url_path'] . $tab['image'] . \"' alt='' style='vertical-align:bottom;'></a></li>\\n\";\n \t\t\t\t} else {\n-\t\t\t\t\tprint \"<li role='tab'><a title='\" . htmlspecialchars($tab['title'], ENT_QUOTES, 'UTF-8') . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n+\t\t\t\t\tprint \"<li role='tab'><a title='\" . html_escape($tab['title']) . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n \t\t\t\t}\n \n \t\t\t\tbreak;\n \t\t\tcase 'preview':\n \t\t\t\tif (isset($tab['image']) && $tab['image'] != '') {\n-\t\t\t\t\tprint \"<li role='tab'><a id='preview' title='\" . htmlspecialchars($tab['title'], ENT_QUOTES, 'UTF-8') . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'><img src='\" . $config['url_path'] . $tab['image'] . \"' alt='' style='vertical-align:bottom;'></a></li>\\n\";\n+\t\t\t\t\tprint \"<li role='tab'><a id='preview' title='\" . html_escape($tab['title']) . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'><img src='\" . $config['url_path'] . $tab['image'] . \"' alt='' style='vertical-align:bottom;'></a></li>\\n\";\n \t\t\t\t} else {\n-\t\t\t\t\tprint \"<li role='tab'><a title='\" . htmlspecialchars($tab['title'], ENT_QUOTES, 'UTF-8') . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n+\t\t\t\t\tprint \"<li role='tab'><a title='\" . html_escape($tab['title']) . \"' class='righttab \" . (isset($tab['selected']) ? 'selected':'') . \"' href='\" . $tab['url'] . \"'>\" . $tab['title'] . \"</a></li>\\n\";\n \t\t\t\t}\n \n \t\t\t\tbreak;\n@@ -1656,7 +1666,7 @@ function html_host_filter($host_id = '-1', $call_back = 'applyFilter', $sql_wher\n \n \t\t\t\tif (sizeof($devices)) {\n \t\t\t\t\tforeach ($devices as $device) {\n-\t\t\t\t\t\tprint \"<option value='\" . $device['id'] . \"'\"; if (get_request_var('host_id') == $device['id']) { print ' selected'; } print '>' . title_trim(htmlspecialchars($device['description'] . ' (' . $device['hostname'] . ')'), 40) . \"</option>\\n\";\n+\t\t\t\t\t\tprint \"<option value='\" . $device['id'] . \"'\"; if (get_request_var('host_id') == $device['id']) { print ' selected'; } print '>' . title_trim(html_escape($device['description'] . ' (' . $device['hostname'] . ')'), 40) . \"</option>\\n\";\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t\t?>\n@@ -1679,7 +1689,7 @@ function html_host_filter($host_id = '-1', $call_back = 'applyFilter', $sql_wher\n \t\t<td>\n \t\t\t<span id='host_wrapper' style='width:200px;' class='ui-selectmenu-button ui-widget ui-state-default ui-corner-all'>\n \t\t\t\t<span id='host_click' class='ui-icon ui-icon-triangle-1-s'></span>\n-\t\t\t\t<input size='28' id='host' value='<?php print htmlspecialchars($hostname, ENT_QUOTES, 'UTF-8');?>'>\n+\t\t\t\t<input size='28' id='host' value='<?php print html_escape($hostname);?>'>\n \t\t\t</span>\n \t\t\t<input type='hidden' id='host_id' name='host_id' value='<?php print $host_id;?>'>\n \t\t\t<input type='hidden' id='call_back' value='<?php print $call_back;?>'>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "48223acbc4013a23593904ee2affd5a9c3cc73f9",
            "date": "2025-01-14T01:29:39Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "80dedbfd4a5ec0654948af54067fa08e09774eb7",
            "date": "2025-01-14T01:07:08Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "1cc3e01ec730211e9d456513afe5ac8a9ff380eb",
            "date": "2025-01-14T00:55:44Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "4927e821722d1273c64fe01b5f92546cbb436a74",
            "date": "2025-01-14T00:15:45Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "9a8e9d85ee560f9d794c9d7e15898c23ec9e7327",
            "date": "2025-01-13T23:52:09Z",
            "author_login": "TheWitness"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "lib/html.php in Cacti before 1.1.18 has XSS via the title field of an external link added by an authenticated user.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-08-21T07:29:00.233",
    "last_modified": "2024-11-21T03:10:34.300",
    "fix_date": "2017-08-19T14:31:27Z"
  },
  "references": [
    {
      "url": "http://www.securitytracker.com/id/1039226",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Cacti/cacti/blob/develop/docs/CHANGELOG",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/9c610a7a4e29595dcaf7d7082134e4b89619ea24",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/issues/918",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1039226",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Cacti/cacti/blob/develop/docs/CHANGELOG",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/9c610a7a4e29595dcaf7d7082134e4b89619ea24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/issues/918",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:05.109309",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cacti",
    "owner": "Cacti",
    "created_at": "2015-01-19T05:36:15Z",
    "updated_at": "2025-01-14T05:23:12Z",
    "pushed_at": "2025-01-14T01:29:41Z",
    "size": 274359,
    "stars": 1675,
    "forks": 406,
    "open_issues": 144,
    "watchers": 1675,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "1.2.x",
      "develop",
      "master",
      "old-develop"
    ],
    "languages": {
      "PHP": 6996697,
      "HTML": 2708532,
      "JavaScript": 2534022,
      "CSS": 1763474,
      "SCSS": 1596996,
      "Less": 246030,
      "Shell": 48853,
      "Perl": 7357,
      "Ruby": 2138
    },
    "commit_activity": {
      "total_commits_last_year": 1068,
      "avg_commits_per_week": 20.53846153846154,
      "days_active_last_year": 177
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:59:13.884661"
  }
}