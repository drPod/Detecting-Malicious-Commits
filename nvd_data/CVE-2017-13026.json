{
  "cve_id": "CVE-2017-13026",
  "github_data": {
    "repository": "the-tcpdump-group/tcpdump",
    "fix_commit": "b20e1639dbac84b3fcb393858521c13ad47a9d70",
    "related_commits": [
      "b20e1639dbac84b3fcb393858521c13ad47a9d70",
      "b20e1639dbac84b3fcb393858521c13ad47a9d70"
    ],
    "patch_url": "https://github.com/the-tcpdump-group/tcpdump/commit/b20e1639dbac84b3fcb393858521c13ad47a9d70.patch",
    "fix_commit_details": {
      "sha": "b20e1639dbac84b3fcb393858521c13ad47a9d70",
      "commit_date": "2017-03-22T17:59:47Z",
      "author": {
        "login": "guyharris",
        "type": "User",
        "stats": {
          "total_commits": 1754,
          "average_weekly_commits": 1.3287878787878789,
          "total_additions": 334479,
          "total_deletions": 321814,
          "weeks_active": 331
        }
      },
      "commit_message": {
        "title": "CVE-2017-13026/IS-IS: Clean up processing of subTLVs.",
        "length": 460,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 391,
        "additions": 145,
        "deletions": 246
      },
      "files": [
        {
          "filename": "print-isoclns.c",
          "status": "modified",
          "additions": 37,
          "deletions": 15,
          "patch": "@@ -1403,6 +1403,7 @@ isis_print_mt_port_cap_subtlv(netdissect_options *ndo,\n \n   while (len > 2)\n   {\n+    ND_TCHECK2(*tptr, 2);\n     stlv_type = *(tptr++);\n     stlv_len  = *(tptr++);\n \n@@ -1415,11 +1416,18 @@ isis_print_mt_port_cap_subtlv(netdissect_options *ndo,\n     /*len -= TLV_TYPE_LEN_OFFSET;*/\n     len = len -2;\n \n+    /* Make sure the subTLV fits within the space left */\n+    if (len < stlv_len)\n+      goto trunc;\n+    /* Make sure the entire subTLV is in the captured data */\n+    ND_TCHECK2(*(tptr), stlv_len);\n+\n     switch (stlv_type)\n     {\n       case ISIS_SUBTLV_SPB_MCID:\n       {\n-        ND_TCHECK2(*(tptr), ISIS_SUBTLV_SPB_MCID_MIN_LEN);\n+      \tif (stlv_len < ISIS_SUBTLV_SPB_MCID_MIN_LEN)\n+      \t  goto trunc;\n \n         subtlv_spb_mcid = (const struct isis_subtlv_spb_mcid *)tptr;\n \n@@ -1434,15 +1442,17 @@ isis_print_mt_port_cap_subtlv(netdissect_options *ndo,\n \n           /*tptr += SPB_MCID_MIN_LEN;\n             len -= SPB_MCID_MIN_LEN; */\n-        tptr = tptr + sizeof(struct isis_subtlv_spb_mcid);\n-        len = len - sizeof(struct isis_subtlv_spb_mcid);\n+        tptr = tptr + ISIS_SUBTLV_SPB_MCID_MIN_LEN;\n+        len = len - ISIS_SUBTLV_SPB_MCID_MIN_LEN;\n+        stlv_len = stlv_len - ISIS_SUBTLV_SPB_MCID_MIN_LEN;\n \n         break;\n       }\n \n       case ISIS_SUBTLV_SPB_DIGEST:\n       {\n-        ND_TCHECK2(*(tptr), ISIS_SUBTLV_SPB_DIGEST_MIN_LEN);\n+        if (stlv_len < ISIS_SUBTLV_SPB_DIGEST_MIN_LEN)\n+          goto trunc;\n \n         ND_PRINT((ndo, \"\\n\\t        RES: %d V: %d A: %d D: %d\",\n                         (*(tptr) >> 5), (((*tptr)>> 4) & 0x01),\n@@ -1461,18 +1471,15 @@ isis_print_mt_port_cap_subtlv(netdissect_options *ndo,\n         }\n \n         len = len - ISIS_SUBTLV_SPB_DIGEST_MIN_LEN;\n+        stlv_len = stlv_len - ISIS_SUBTLV_SPB_DIGEST_MIN_LEN;\n \n         break;\n       }\n \n       case ISIS_SUBTLV_SPB_BVID:\n       {\n-        ND_TCHECK2(*(tptr), stlv_len);\n-\n-        while (len >= ISIS_SUBTLV_SPB_BVID_MIN_LEN)\n+        while (stlv_len >= ISIS_SUBTLV_SPB_BVID_MIN_LEN)\n         {\n-          ND_TCHECK2(*(tptr), ISIS_SUBTLV_SPB_BVID_MIN_LEN);\n-\n           ND_PRINT((ndo, \"\\n\\t           ECT: %08x\",\n                       EXTRACT_32BITS(tptr)));\n \n@@ -1485,14 +1492,17 @@ isis_print_mt_port_cap_subtlv(netdissect_options *ndo,\n \n           tptr = tptr + 2;\n           len = len - ISIS_SUBTLV_SPB_BVID_MIN_LEN;\n+          stlv_len = stlv_len - ISIS_SUBTLV_SPB_BVID_MIN_LEN;\n         }\n \n         break;\n       }\n \n       default:\n-          break;\n+        break;\n     }\n+    tptr += stlv_len;\n+    len -= stlv_len;\n   }\n \n   return 0;\n@@ -1511,6 +1521,7 @@ isis_print_mt_capability_subtlv(netdissect_options *ndo,\n \n   while (len > 2)\n   {\n+    ND_TCHECK2(*tptr, 2);\n     stlv_type = *(tptr++);\n     stlv_len  = *(tptr++);\n \n@@ -1522,11 +1533,17 @@ isis_print_mt_capability_subtlv(netdissect_options *ndo,\n \n     len = len - 2;\n \n+    /* Make sure the subTLV fits within the space left */\n+    if (len < stlv_len)\n+      goto trunc;\n+    /* Make sure the entire subTLV is in the captured data */\n+    ND_TCHECK2(*(tptr), stlv_len);\n+\n     switch (stlv_type)\n     {\n       case ISIS_SUBTLV_SPB_INSTANCE:\n-\n-          ND_TCHECK2(*tptr, ISIS_SUBTLV_SPB_INSTANCE_MIN_LEN);\n+          if (stlv_len < ISIS_SUBTLV_SPB_INSTANCE_MIN_LEN)\n+            goto trunc;\n \n           ND_PRINT((ndo, \"\\n\\t        CIST Root-ID: %08x\", EXTRACT_32BITS(tptr)));\n           tptr = tptr+4;\n@@ -1548,10 +1565,12 @@ isis_print_mt_capability_subtlv(netdissect_options *ndo,\n           tmp = *(tptr++);\n \n           len = len - ISIS_SUBTLV_SPB_INSTANCE_MIN_LEN;\n+          stlv_len = stlv_len - ISIS_SUBTLV_SPB_INSTANCE_MIN_LEN;\n \n           while (tmp)\n           {\n-            ND_TCHECK2(*tptr, ISIS_SUBTLV_SPB_INSTANCE_VLAN_TUPLE_LEN);\n+            if (stlv_len < ISIS_SUBTLV_SPB_INSTANCE_VLAN_TUPLE_LEN)\n+              goto trunc;\n \n             ND_PRINT((ndo, \"\\n\\t         U:%d, M:%d, A:%d, RES:%d\",\n                       *(tptr) >> 7, (*(tptr) >> 6) & 0x01,\n@@ -1569,14 +1588,15 @@ isis_print_mt_capability_subtlv(netdissect_options *ndo,\n \n             tptr = tptr + 3;\n             len = len - ISIS_SUBTLV_SPB_INSTANCE_VLAN_TUPLE_LEN;\n+            stlv_len = stlv_len - ISIS_SUBTLV_SPB_INSTANCE_VLAN_TUPLE_LEN;\n             tmp--;\n           }\n \n           break;\n \n       case ISIS_SUBTLV_SPBM_SI:\n-\n-          ND_TCHECK2(*tptr, 8);\n+          if (stlv_len < 8)\n+            goto trunc;\n \n           ND_PRINT((ndo, \"\\n\\t        BMAC: %08x\", EXTRACT_32BITS(tptr)));\n           tptr = tptr+4;\n@@ -1608,6 +1628,8 @@ isis_print_mt_capability_subtlv(netdissect_options *ndo,\n       default:\n         break;\n     }\n+    tptr += stlv_len;\n+    len -= stlv_len;\n   }\n   return 0;\n "
        },
        {
          "filename": "tests/TESTLIST",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -528,6 +528,10 @@ mobility_opt_asan\tmobility_opt_asan.pcap\t\tmobility_opt_asan.out\t-v\n mobility_opt_asan_2\tmobility_opt_asan_2.pcap\tmobility_opt_asan_2.out\t-v\n mobility_opt_asan_3\tmobility_opt_asan_3.pcap\tmobility_opt_asan_3.out\t-v\n mobility_opt_asan_4\tmobility_opt_asan_4.pcap\tmobility_opt_asan_4.out\t-v\n+isis_stlv_asan\t\tisis_stlv_asan.pcap\t\tisis_stlv_asan.out\t-v\n+isis_stlv_asan-2\tisis_stlv_asan-2.pcap\t\tisis_stlv_asan-2.out\t-v\n+isis_stlv_asan-3\tisis_stlv_asan-3.pcap\t\tisis_stlv_asan-3.out\t-v\n+isis_stlv_asan-4\tisis_stlv_asan-4.pcap\t\tisis_stlv_asan-4.out\t-v\n \n # RTP tests\n # fuzzed pcap"
        },
        {
          "filename": "tests/isis-extd-ipreach-oobr.out",
          "status": "modified",
          "additions": 1,
          "deletions": 16,
          "patch": "@@ -24,22 +24,7 @@\n \t         AUX-MCID: ID: 69, Name: EIEEEIEEEIEEEIEEEIEEEIEEEIEEEIEE\n \t              Lvl: 17737, Digest: 45 45 45 49 45 45 45 49 45 45 45 49 45 45 45 49  [|isis]\n \t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n-\t       unknown subTLV #69, length: 73\n-\t       unknown subTLV #69, length: 69\n+\t\t [|isis]\n \t      0x0000:  0000 0466 0049 4545 4549 4545 4549 4545\n \t      0x0010:  4549 4545 4549 4545 4549 4545 4549 4545\n \t      0x0020:  4549 4545 4549 4545 4549 4545 4549 4545"
        },
        {
          "filename": "tests/isis-seg-fault-2-v.out",
          "status": "modified",
          "additions": 4,
          "deletions": 116,
          "patch": "@@ -5,129 +5,17 @@ IS-IS, length 1497\n \t    Multi-Topology Capability TLV #144, length: 1\n \t      O: 1, RES: 4, MTID(s): 3073\n \t      unknown subTLV #4, length: 3\n-\t      unknown subTLV #73, length: 0\n-\t      unknown subTLV #10, length: 132\n-\t      unknown subTLV #4, length: 10\n-\t      unknown subTLV #0, length: 10\n-\t      unknown subTLV #0, length: 55\n-\t      SPBM Service Identifier and Unicast Address subTLV #3, length: 0\n-\t        BMAC: 00000606c201, RES: 2, VID: 2456\n-\t      unknown subTLV #204, length: 83\n+\t      unknown subTLV #132, length: 4\n+\t      unknown subTLV #55, length: 3\n+\t      unknown subTLV #6, length: 6\n \t      unknown subTLV #8, length: 191\n \t      unknown subTLV #0, length: 0\n \t      unknown subTLV #0, length: 0\n \t      unknown subTLV #0, length: 0\n \t      unknown subTLV #0, length: 0\n \t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #82, length: 0\n-\t      unknown subTLV #0, length: 86\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 37\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 108\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #48, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #172, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #76, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 90\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 90\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 107\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n \t      unknown subTLV #0, length: 37\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #2, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 92\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #113, length: 90\n-\t      unknown subTLV #0, length: 230\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #79, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #234, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #64, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #37, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #2, length: 0\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #0, length: 0\n+\t\t [|isis]\n \t    Area address(es) TLV #1, length: 4\n \t      Area address (length: 3): 49.000a\n \t    IPv4 Interface address(es) TLV #132, length: 4"
        },
        {
          "filename": "tests/isis_stlv_asan-2.out",
          "status": "added",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -0,0 +1,22 @@\n+UI 22! IS-IS, length 469869187\n+\tL2 Lan IIH, hlen: 27, v: 1, pdu-v: 1, sys-id-len: 6 (0), max-area: 224 (224)\n+\t  source-id: fed0.f90f.58af,  holding time: 34047s, Flags: [unknown circuit type 0x00]\n+\t  lan-id:    0100.0088.a201.1c, Priority: 65, PDU length: 4096\n+\t    unknown TLV #0, length: 12\n+\t\t0x0000:  0722 0583 1b01 0010 0505 0505\n+\t    Area address(es) TLV #1, length: 157\n+\t    IS Reachability TLV #2, length: 2\n+\t      bogus virtual flag 0x02\n+\t    IS Reachability TLV #2, length: 2\n+\t      bogus virtual flag 0x02\n+\t    IS Reachability TLV #2, length: 2\n+\t      bogus virtual flag 0x90\n+\t    Multi-Topology Capability TLV #144, length: 144\n+\t      O: 1, RES: 1, MTID(s): 144\n+\t      unknown subTLV #144, length: 2\n+\t      unknown subTLV #2, length: 0\n+\t      unknown subTLV #16, length: 1\n+\t      unknown subTLV #224, length: 0\n+\t      unknown subTLV #59, length: 0\n+\t      unknown subTLV #5, length: 166\n+\t\t [|isis] [|isis]"
        },
        {
          "filename": "tests/isis_stlv_asan-2.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/isis_stlv_asan-3.out",
          "status": "added",
          "additions": 23,
          "deletions": 0,
          "patch": "@@ -0,0 +1,23 @@\n+UI 22! IS-IS, length 469869187\n+\tL2 Lan IIH, hlen: 27, v: 1, pdu-v: 1, sys-id-len: 6 (0), max-area: 224 (224)\n+\t  source-id: fed0.f90f.58af,  holding time: 34047s, Flags: [unknown circuit type 0x00]\n+\t  lan-id:    0100.0088.a201.1c, Priority: 65, PDU length: 4096\n+\t    unknown TLV #0, length: 12\n+\t\t0x0000:  0722 0583 1b01 0010 019d e000\n+\t    unknown TLV #254, length: 0\n+\t    Prefix Neighbors TLV #5, length: 146\n+\t      Metric Block, Default Metric: 32, Internal\n+\t\t  Expense Metric: 0, Internal\n+\t\t  Error Metric: 0, Internal\n+\t\tAddress: 88.99ff.ffff.7fb5.0000/76\n+\t\tAddress: isonsap_string: illegal length/948\n+\t\tAddress: 95/8\n+\t\tAddress: 02/8\n+\t\tAddress: 02/8\n+\t\tAddress: 02/8\n+\t\tAddress: 90/8\n+\t    Multi-Topology Capability TLV #144, length: 144\n+\t      O: 1, RES: 1, MTID(s): 0\n+\t      unknown subTLV #107, length: 0\n+\t      unknown subTLV #0, length: 208\n+\t\t [|isis] [|isis]"
        },
        {
          "filename": "tests/isis_stlv_asan-3.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/isis_stlv_asan-4.out",
          "status": "added",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -0,0 +1,28 @@\n+UI 22! Pad! IS-IS, length 1644274306\n+\tL2 Lan IIH, hlen: 27, v: 1, pdu-v: 1, sys-id-len: 6 (0), max-area: 224 (224)\n+\t  source-id: fe02.0000.d0f9,  holding time: 3928s, Flags: [unknown circuit type 0x00]\n+\t  lan-id:    1000.4101.0000.88, Priority: 127, PDU length: 44959\n+\t    unknown TLV #162, length: 1\n+\t\t0x0000:  e2\n+\t    IS Reachability TLV #2, length: 12\n+\t      bogus virtual flag 0x07\n+\t      IS Neighbor: 0100.1001.9de0.00, Default Metric: 34, Internal\n+\t\t  Delay Metric: 5, Internal\n+\t\t  Error Metric: 27, Internal\n+\t    Authentication TLV #10, length: 1\n+\t      unknown Authentication type 0x05: \n+\t    unknown TLV #146, length: 32\n+\t\t0x0000:  2020 2020 2020 2020 2020 2020 2020 2020\n+\t\t0x0010:  2020 2020 2020 2020 2020 2220 2020 2020\n+\t    unknown TLV #32, length: 32\n+\t\t0x0000:  2000 0001 0020 2020 2020 2020 207f 0020\n+\t\t0x0010:  2020 2020 2020 2020 2020 2e20 2020 20c9\n+\t    unknown TLV #32, length: 32\n+\t\t0x0000:  2020 2010 0020 2020 2020 0b20 2020 2020\n+\t\t0x0010:  2020 2020 2020 8181 7281 8181 8181 8181\n+\t    Multi-Topology-Aware Port Capability TLV #143, length: 129\n+\t       RES: 8, MTID(s): 385\n+\t       unknown subTLV #129, length: 68\n+\t       unknown subTLV #32, length: 32\n+\t       unknown subTLV #129, length: 129\n+\t\t [|isis] [|isis]"
        },
        {
          "filename": "tests/isis_stlv_asan-4.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/isis_stlv_asan.out",
          "status": "added",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -0,0 +1,25 @@\n+UI 22! IS-IS, length 469869187\n+\tL2 Lan IIH, hlen: 27, v: 1, pdu-v: 1, sys-id-len: 6 (0), max-area: 224 (224)\n+\t  source-id: fed0.f90f.58af,  holding time: 34047s, Flags: [unknown circuit type 0x00]\n+\t  lan-id:    0105.0088.a201.00, Priority: 65, PDU length: 4096\n+\t    IS Reachability TLV #2, length: 12\n+\t      bogus virtual flag 0x07\n+\t      IS Neighbor: 0100.1001.9de0.00, Default Metric: 34, Internal\n+\t\t  Delay Metric: 5, Internal\n+\t\t  Error Metric: 27, Internal\n+\t    unknown TLV #254, length: 3\n+\t\t0x0000:  05f5 20\n+\t    unknown TLV #32, length: 32\n+\t\t0x0000:  2020 2020 2020 2020 2020 202d 2020 2020\n+\t\t0x0010:  2020 2020 2020 2020 2020 03e8 2020 2020\n+\t    unknown TLV #32, length: 32\n+\t\t0x0000:  2020 2020 2020 2020 2020 207f 0020 2020\n+\t\t0x0010:  2026 2020 2020 2020 2020 2020 2020 8f8f\n+\t    Multi-Topology-Aware Port Capability TLV #143, length: 143\n+\t       RES: 8, MTID(s): 3983\n+\t       unknown subTLV #143, length: 143\n+\t\t [|isis]\n+\t    Multi-Topology-Aware Port Capability TLV #143, length: 143\n+\t       RES: 8, MTID(s): 3983\n+\t       unknown subTLV #143, length: 143\n+\t\t [|isis] [|isis]"
        },
        {
          "filename": "tests/isis_stlv_asan.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/kday6.out",
          "status": "modified",
          "additions": 1,
          "deletions": 99,
          "patch": "@@ -5,105 +5,7 @@ FRF.16 Frag, seq 693, Flags [Begin], UI e8! IS-IS, length 301989913\n \t    Multi-Topology Capability TLV #144, length: 137\n \t      O: 0, RES: 4, MTID(s): 3945\n \t      unknown subTLV #8, length: 233\n-\t      unknown subTLV #18, length: 0\n-\t      unknown subTLV #37, length: 144\n-\t      unknown subTLV #137, length: 79\n-\t      unknown subTLV #105, length: 8\n-\t      unknown subTLV #0, length: 69\n-\t      unknown subTLV #0, length: 0\n-\t      unknown subTLV #52, length: 144\n-\t      unknown subTLV #64, length: 64\n-\t      SPB Instance subTLV #1, length: 64\n-\t        CIST Root-ID: 06a516cc 09370acc, Path Cost: ffffff7f, Prio: 48090\n-\t        RES: 1031, V: 1, SPSource-ID: 324444, No of Trees: 5\n-\t         U:0, M:0, A:0, RES:22, ECT: 144a2d80, BVID: 256, SPVID: 1040\n-\t         U:0, M:1, A:1, RES:14, ECT: 55000001, BVID: 16, SPVID: 2058\n-\t         U:1, M:0, A:0, RES:12, ECT: f3ac2b26, BVID: 2499, SPVID: 185\n-\t         U:1, M:0, A:1, RES:5, ECT: 68735440, BVID: 1216, SPVID: 3072\n-\t         U:1, M:1, A:1, RES:23, ECT: 020000f7, BVID: 32, SPVID: 0\n-\t      unknown subTLV #132, length: 181\n-\t      unknown subTLV #156, length: 190\n-\t      unknown subTLV #255, length: 255\n-\t      unknown subTLV #255, length: 255\n-\t      unknown subTLV #0, length: 64\n-\t      unknown subTLV #6, length: 62\n-\t      unknown subTLV #136, length: 204\n-\t      unknown subTLV #9, length: 16\n-\t      unknown subTLV #4, length: 16\n-\t      unknown subTLV #5, length: 148\n-\t      unknown subTLV #0, length: 0\n-\t      SPB Instance subTLV #1, length: 1\n-\t        CIST Root-ID: 080a26a6 318b8cf3, Path Cost: a5d38ec4, Prio: 31240\n-\t        RES: 1864, V: 1, SPSource-ID: 133120, No of Trees: 45\n-\t         U:0, M:0, A:0, RES:0, ECT: cc09370a, BVID: 3496, SPVID: 1\n-\t         U:1, M:0, A:1, RES:27, ECT: 16274ce2, BVID: 3423, SPVID: 860\n-\t         U:1, M:1, A:0, RES:10, ECT: 80100410, BVID: 89, SPVID: 1093\n-\t         U:0, M:0, A:0, RES:16, ECT: 04106e55, BVID: 0, SPVID: 1\n-\t         U:0, M:0, A:0, RES:1, ECT: 080a8cf3, BVID: 2754, SPVID: 2854\n-\t         U:1, M:0, A:0, RES:28, ECT: 0e2d0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:27, ECT: 01001201, BVID: 2104, SPVID: 899\n-\t         U:1, M:0, A:0, RES:3, ECT: 83838383, BVID: 2104, SPVID: 899\n-\t         U:0, M:1, A:0, RES:15, ECT: 00600641, BVID: 2300, SPVID: 3081\n-\t         U:0, M:0, A:0, RES:0, ECT: 2590894f, BVID: 1680, SPVID: 2281\n-\t         U:0, M:0, A:0, RES:18, ECT: 0025e489, BVID: 1264, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3711\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0c0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e640e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e80ff, BVID: 3760, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e000003, BVID: 3720, SPVID: 14\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 560e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3675\n-\t         U:1, M:0, A:0, RES:0, ECT: acaa4016, BVID: 380, SPVID: 494\n-\t         U:1, M:1, A:0, RES:14, ECT: 1560b70f, BVID: 2993, SPVID: 1575\n-\t         U:0, M:1, A:0, RES:12, ECT: e2d5f35c, BVID: 3240, SPVID: 16\n-\t         U:0, M:0, A:0, RES:4, ECT: 10059445, BVID: 256, SPVID: 1040\n-\t         U:0, M:1, A:1, RES:14, ECT: 55000001, BVID: 16, SPVID: 2058\n-\t         U:1, M:0, A:0, RES:12, ECT: f3ac2b26, BVID: 2499, SPVID: 2745\n-\t         U:1, M:0, A:1, RES:5, ECT: 68735440, BVID: 1216, SPVID: 3072\n-\t         U:1, M:1, A:1, RES:23, ECT: 020000f7, BVID: 32, SPVID: 0\n-\t         U:1, M:0, A:0, RES:4, ECT: b59cbe8c, BVID: 4095, SPVID: 4095\n-\t         U:0, M:0, A:0, RES:0, ECT: 40ff3e88, BVID: 3264, SPVID: 2320\n-\t         U:0, M:0, A:0, RES:4, ECT: 10059400, BVID: 0, SPVID: 257\n-\t         U:0, M:0, A:0, RES:8, ECT: 0a269c31, BVID: 2232, SPVID: 3315\n-\t         U:1, M:0, A:1, RES:12, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:0, ECT: 040e0e0e, BVID: 224, SPVID: 3598\n-\t         U:1, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0b0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 224, SPVID: 3598\n-\t         U:0, M:0, A:0, RES:14, ECT: 0e0e0e0e, BVID: 3, SPVID: 3616\n+\t\t [|isis]\n \t    unknown TLV #213, length: 243\n \t\t0x0000:  5cca 8010 0410 0594 4510 0410 6e55 0000\n \t\t0x0010:  0101 080a 8cf3 ac2b 269c 0e2d 0e0e 0e0e"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 12,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "05a263a5418a9e5b971509c486246eb0913c8aea",
            "date": "2025-01-12T21:05:02Z",
            "author_login": "fxlb"
          },
          {
            "sha": "9aee9964aaee40750acde45f838f48eb8f95fbe3",
            "date": "2025-01-09T15:35:53Z",
            "author_login": "fxlb"
          },
          {
            "sha": "6cd500c8dafe5a9bbf3e56312493709e8b118726",
            "date": "2025-01-08T20:12:09Z",
            "author_login": "fxlb"
          },
          {
            "sha": "c5b54bfbd68b03f7997feaa277db30d399975a4d",
            "date": "2022-10-11T20:10:46Z",
            "author_login": "fenner"
          },
          {
            "sha": "431bdb5c365360d61968e7fa02322825b1da4208",
            "date": "2025-01-07T19:21:12Z",
            "author_login": "fxlb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "The ISO IS-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c, several functions.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-14T06:29:02.217",
    "last_modified": "2024-11-21T03:10:44.140",
    "fix_date": "2017-03-22T17:59:47Z"
  },
  "references": [
    {
      "url": "http://www.debian.org/security/2017/dsa-3971",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1039307",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.tcpdump.org/tcpdump-changes.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHEA-2018:0705",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/the-tcpdump-group/tcpdump/commit/b20e1639dbac84b3fcb393858521c13ad47a9d70",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201709-23",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT208221",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3971",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1039307",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.tcpdump.org/tcpdump-changes.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHEA-2018:0705",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/the-tcpdump-group/tcpdump/commit/b20e1639dbac84b3fcb393858521c13ad47a9d70",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201709-23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT208221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.369829",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tcpdump",
    "owner": "the-tcpdump-group",
    "created_at": "2013-04-14T21:46:15Z",
    "updated_at": "2025-01-14T07:48:01Z",
    "pushed_at": "2025-01-13T06:19:33Z",
    "size": 27691,
    "stars": 2789,
    "forks": 860,
    "open_issues": 115,
    "watchers": 2789,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "tcpdump-3.5",
      "tcpdump-3.6",
      "tcpdump-3.7",
      "tcpdump-3.8",
      "tcpdump-3.9",
      "tcpdump-4.0",
      "tcpdump-4.1",
      "tcpdump-4.2",
      "tcpdump-4.3",
      "tcpdump-4.4",
      "tcpdump-4.5",
      "tcpdump-4.6",
      "tcpdump-4.7",
      "tcpdump-4.8",
      "tcpdump-4.9",
      "tcpdump-4.99"
    ],
    "languages": {
      "C": 3548298,
      "CMake": 76892,
      "Roff": 66849,
      "Shell": 50525,
      "M4": 31504,
      "Perl": 29240,
      "Makefile": 14259,
      "Awk": 4120,
      "GDB": 660
    },
    "commit_activity": {
      "total_commits_last_year": 314,
      "avg_commits_per_week": 6.038461538461538,
      "days_active_last_year": 158
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:04:48.453717"
  }
}