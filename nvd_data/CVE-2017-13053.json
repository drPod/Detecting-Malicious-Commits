{
  "cve_id": "CVE-2017-13053",
  "github_data": {
    "repository": "the-tcpdump-group/tcpdump",
    "fix_commit": "bd4e697ebd6c8457efa8f28f6831fc929b88a014",
    "related_commits": [
      "bd4e697ebd6c8457efa8f28f6831fc929b88a014",
      "bd4e697ebd6c8457efa8f28f6831fc929b88a014"
    ],
    "patch_url": "https://github.com/the-tcpdump-group/tcpdump/commit/bd4e697ebd6c8457efa8f28f6831fc929b88a014.patch",
    "fix_commit_details": {
      "sha": "bd4e697ebd6c8457efa8f28f6831fc929b88a014",
      "commit_date": "2017-08-11T12:39:02Z",
      "author": {
        "login": "infrastation",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "CVE-2017-13053/BGP: fix VPN route target bounds checks",
        "length": 657,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 66,
        "additions": 63,
        "deletions": 3
      },
      "files": [
        {
          "filename": "print-bgp.c",
          "status": "modified",
          "additions": 19,
          "deletions": 3,
          "patch": "@@ -761,32 +761,48 @@ decode_rt_routing_info(netdissect_options *ndo,\n {\n \tuint8_t route_target[8];\n \tu_int plen;\n+\tchar asbuf[sizeof(astostr)]; /* bgp_vpn_rd_print() overwrites astostr */\n \n+\t/* NLRI \"prefix length\" from RFC 2858 Section 4. */\n \tND_TCHECK(pptr[0]);\n \tplen = pptr[0];   /* get prefix length */\n \n+\t/* NLRI \"prefix\" (ibid), valid lengths are { 0, 32, 33, ..., 96 } bits.\n+\t * RFC 4684 Section 4 defines the layout of \"origin AS\" and \"route\n+\t * target\" fields inside the \"prefix\" depending on its length.\n+\t */\n \tif (0 == plen) {\n+\t\t/* Without \"origin AS\", without \"route target\". */\n \t\tsnprintf(buf, buflen, \"default route target\");\n \t\treturn 1;\n \t}\n \n \tif (32 > plen)\n \t\treturn -1;\n \n+\t/* With at least \"origin AS\", possibly with \"route target\". */\n+\tND_TCHECK_32BITS(pptr + 1);\n+\tas_printf(ndo, asbuf, sizeof(asbuf), EXTRACT_32BITS(pptr + 1));\n+\n         plen-=32; /* adjust prefix length */\n \n \tif (64 < plen)\n \t\treturn -1;\n \n+\t/* From now on (plen + 7) / 8 evaluates to { 0, 1, 2, ..., 8 }\n+\t * and gives the number of octets in the variable-length \"route\n+\t * target\" field inside this NLRI \"prefix\". Look for it.\n+\t */\n \tmemset(&route_target, 0, sizeof(route_target));\n-\tND_TCHECK2(pptr[1], (plen + 7) / 8);\n-\tmemcpy(&route_target, &pptr[1], (plen + 7) / 8);\n+\tND_TCHECK2(pptr[5], (plen + 7) / 8);\n+\tmemcpy(&route_target, &pptr[5], (plen + 7) / 8);\n+\t/* Which specification says to do this? */\n \tif (plen % 8) {\n \t\t((u_char *)&route_target)[(plen + 7) / 8 - 1] &=\n \t\t\t((0xff00 >> (plen % 8)) & 0xff);\n \t}\n \tsnprintf(buf, buflen, \"origin AS: %s, route target %s\",\n-\t    as_printf(ndo, astostr, sizeof(astostr), EXTRACT_32BITS(pptr+1)),\n+\t    asbuf,\n \t    bgp_vpn_rd_print(ndo, (u_char *)&route_target));\n \n \treturn 5 + (plen + 7) / 8;"
        },
        {
          "filename": "tests/TESTLIST",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -572,6 +572,7 @@ rsvp_uni-oobr-2\trsvp_uni-oobr-2.pcap\trsvp_uni-oobr-2.out\t-v -c1\n rsvp_uni-oobr-3\trsvp_uni-oobr-3.pcap\trsvp_uni-oobr-3.out\t-v -c3\n rpki-rtr-oob\t\trpki-rtr-oob.pcap\trpki-rtr-oob.out\t-v -c1\n lldp_8023_mtu-oobr\tlldp_8023_mtu-oobr.pcap\tlldp_8023_mtu-oobr.out\t-v -c1\n+bgp_vpn_rt-oobr\tbgp_vpn_rt-oobr.pcap\tbgp_vpn_rt-oobr.out\t-v -c1\n \n # bad packets from Katie Holly\n mlppp-oobr\t\tmlppp-oobr.pcap\t\t\tmlppp-oobr.out"
        },
        {
          "filename": "tests/bgp_vpn_rt-oobr.out",
          "status": "added",
          "additions": 43,
          "deletions": 0,
          "patch": "@@ -0,0 +1,43 @@\n+IP (tos 0xc, ttl 254, id 21263, offset 0, flags [rsvd], proto TCP (6), length 60165, bad cksum 8e15 (->9eb8)!)\n+    241.0.128.19.179 > 239.8.0.1.0: Flags [none], seq 2146695561:2146755682, win 56026, options [unknown-161,eol], length 60121: BGP\n+\tUpdate Message (2), length: 45\n+\t  Withdrawn routes: 3 bytes\n+\t  Attribute Set (128), length: 7, Flags [OTPE+f]: \n+\t    Origin AS: 0\n+\t      Multi-Protocol Unreach NLRI (15), length: 227, Flags [T+6]: \n+\t    AFI: IPv6 (2), SAFI: Multicast VPN (5)\n+\t      Route-Type: Source-Active (5), length: 5, RD: unknown RD format, Group bogus address length 127\n+\t      Route-Type: Unknown (142), length: 142\n+\t      Route-Type: Unknown (0), length: 0\n+\t      Route-Type: Unknown (33), length: 0\n+\t      Route-Type: Unknown (0), length: 0[|BGP] [|BGP]\n+\tUpdate Message (2), length: 45[|BGP] [|BGP]\n+\tUpdate Message (2), length: 45\n+\t  Withdrawn routes: 3 bytes\n+\t  Attribute Set (128), length: 7, Flags [OTPE+f]: \n+\t    Origin AS: 0\n+\t      Multi-Protocol Reach NLRI (14), length: 227, Flags [T+6]: \n+\t    AFI: IPv4 (1), vendor specific SAFI: Route Target Routing Information (132)\n+\t    nexthop: invalid len, nh-length: 1, no SNPA\n+\t      origin AS: 0, route target 0:0 (= 0.0.0.0)\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target\n+\t      default route target[|BGP]"
        },
        {
          "filename": "tests/bgp_vpn_rt-oobr.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "05a263a5418a9e5b971509c486246eb0913c8aea",
            "date": "2025-01-12T21:05:02Z",
            "author_login": "fxlb"
          },
          {
            "sha": "9aee9964aaee40750acde45f838f48eb8f95fbe3",
            "date": "2025-01-09T15:35:53Z",
            "author_login": "fxlb"
          },
          {
            "sha": "6cd500c8dafe5a9bbf3e56312493709e8b118726",
            "date": "2025-01-08T20:12:09Z",
            "author_login": "fxlb"
          },
          {
            "sha": "c5b54bfbd68b03f7997feaa277db30d399975a4d",
            "date": "2022-10-11T20:10:46Z",
            "author_login": "fenner"
          },
          {
            "sha": "431bdb5c365360d61968e7fa02322825b1da4208",
            "date": "2025-01-07T19:21:12Z",
            "author_login": "fxlb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "The BGP parser in tcpdump before 4.9.2 has a buffer over-read in print-bgp.c:decode_rt_routing_info().",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-14T06:29:03.187",
    "last_modified": "2024-11-21T03:10:50.630",
    "fix_date": "2017-08-11T12:39:02Z"
  },
  "references": [
    {
      "url": "http://www.debian.org/security/2017/dsa-3971",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1039307",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.tcpdump.org/tcpdump-changes.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHEA-2018:0705",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/the-tcpdump-group/tcpdump/commit/bd4e697ebd6c8457efa8f28f6831fc929b88a014",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201709-23",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT208221",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3971",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securitytracker.com/id/1039307",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.tcpdump.org/tcpdump-changes.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHEA-2018:0705",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/the-tcpdump-group/tcpdump/commit/bd4e697ebd6c8457efa8f28f6831fc929b88a014",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201709-23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://support.apple.com/HT208221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.374371",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tcpdump",
    "owner": "the-tcpdump-group",
    "created_at": "2013-04-14T21:46:15Z",
    "updated_at": "2025-01-14T07:48:01Z",
    "pushed_at": "2025-01-13T06:19:33Z",
    "size": 27691,
    "stars": 2789,
    "forks": 860,
    "open_issues": 115,
    "watchers": 2789,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "tcpdump-3.5",
      "tcpdump-3.6",
      "tcpdump-3.7",
      "tcpdump-3.8",
      "tcpdump-3.9",
      "tcpdump-4.0",
      "tcpdump-4.1",
      "tcpdump-4.2",
      "tcpdump-4.3",
      "tcpdump-4.4",
      "tcpdump-4.5",
      "tcpdump-4.6",
      "tcpdump-4.7",
      "tcpdump-4.8",
      "tcpdump-4.9",
      "tcpdump-4.99"
    ],
    "languages": {
      "C": 3548298,
      "CMake": 76892,
      "Roff": 66849,
      "Shell": 50525,
      "M4": 31504,
      "Perl": 29240,
      "Makefile": 14259,
      "Awk": 4120,
      "GDB": 660
    },
    "commit_activity": {
      "total_commits_last_year": 314,
      "avg_commits_per_week": 6.038461538461538,
      "days_active_last_year": 158
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:04:48.453717"
  }
}