{
  "cve_id": "CVE-2017-14920",
  "github_data": {
    "repository": "EGroupware/egroupware",
    "fix_commit": "0ececf8c78f1c3f9ba15465f53a682dd7d89529f",
    "related_commits": [
      "0ececf8c78f1c3f9ba15465f53a682dd7d89529f",
      "0ececf8c78f1c3f9ba15465f53a682dd7d89529f"
    ],
    "patch_url": "https://github.com/EGroupware/egroupware/commit/0ececf8c78f1c3f9ba15465f53a682dd7d89529f.patch",
    "fix_commit_details": {
      "sha": "0ececf8c78f1c3f9ba15465f53a682dd7d89529f",
      "commit_date": "2017-09-05T17:04:45Z",
      "author": {
        "login": "hnategh",
        "type": "User",
        "stats": {
          "total_commits": 2584,
          "average_weekly_commits": 2.0923076923076924,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 347
        }
      },
      "commit_message": {
        "title": "Set statustext value as text by default",
        "length": 214,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 37,
        "additions": 26,
        "deletions": 11
      },
      "files": [
        {
          "filename": "api/js/etemplate/et2_core_baseWidget.js",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -32,6 +32,12 @@ var et2_baseWidget = (function(){ \"use strict\"; return et2_DOMWidget.extend(et2_\n \t\t\t\"description\": \"Tooltip which is shown for this element\",\n \t\t\t\"translate\": true\n \t\t},\n+\t\t\"statustext_html\": {\n+\t\t\t\"name\": \"Tooltip is html\",\n+\t\t\t\"type\": \"boolean\",\n+\t\t\t\"description\": \"Flag to allow html content in tooltip\",\n+\t\t\t\"default\": false\n+\t\t},\n \t\t\"align\": {\n \t\t\t\"name\": \"Align\",\n \t\t\t\"type\": \"string\",\n@@ -277,7 +283,7 @@ var et2_baseWidget = (function(){ \"use strict\"; return et2_DOMWidget.extend(et2_\n \n \t\t\tif (_value && _value != '')\n \t\t\t{\n-\t\t\t\tthis.egw().tooltipBind(elem, _value);\n+\t\t\t\tthis.egw().tooltipBind(elem, _value, this.options.statustext_html);\n \t\t\t\tthis._tooltipElem = elem;\n \t\t\t}\n \t\t}"
        },
        {
          "filename": "api/js/jsapi/egw_tooltip.js",
          "status": "modified",
          "additions": 12,
          "deletions": 4,
          "patch": "@@ -106,16 +106,24 @@ egw.extend('tooltip', egw.MODULE_WND_LOCAL, function(_app, _wnd)\n \t * Creates the tooltip_div with the given text.\n \t *\n \t * @param {string} _html\n+\t * @param {boolean} _isHtml if set to true content gets appended as html\n \t */\n-\tfunction prepare(_html)\n+\tfunction prepare(_html, _isHtml)\n \t{\n \t\t// Free and null the old tooltip_div\n \t\thide();\n \n \t\t//Generate the tooltip div, set it's text and append it to the body tag\n \t\ttooltip_div = jQuery(_wnd.document.createElement('div'));\n \t\ttooltip_div.hide();\n-\t\ttooltip_div.append(_html);\n+\t\tif (_isHtml)\n+\t\t{\n+\t\t\ttooltip_div.append(_html);\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\ttooltip_div.text(_html)\n+\t\t}\n \t\ttooltip_div.addClass(\"egw_tooltip\");\n \t\tjQuery(_wnd.document.body).append(tooltip_div);\n \n@@ -156,14 +164,14 @@ egw.extend('tooltip', egw.MODULE_WND_LOCAL, function(_app, _wnd)\n \t\t * \thas to be a jQuery node.\n \t\t * @param _html is the html code which should be shown as tooltip.\n \t\t */\n-\t\ttooltipBind: function(_elem, _html) {\n+\t\ttooltipBind: function(_elem, _html, _isHtml) {\n \t\t\tif (_html != '')\n \t\t\t{\n \t\t\t\t_elem.bind('mouseenter.tooltip', function(e) {\n \t\t\t\t\tif (_elem != current_elem)\n \t\t\t\t\t{\n \t\t\t\t\t\t//Prepare the tooltip\n-\t\t\t\t\t\tprepare(_html);\n+\t\t\t\t\t\tprepare(_html, _isHtml);\n \n \t\t\t\t\t\t// Set the current element the mouse is over and\n \t\t\t\t\t\t// initialize the position variables"
        },
        {
          "filename": "calendar/js/et2_widget_event.js",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -79,6 +79,7 @@ var et2_calendar_event = (function(){ \"use strict\"; return et2_valueWidget.exten\n \t\t\t\t// Tooltip\n \t\t\t\tif(!event._tooltipElem)\n \t\t\t\t{\n+\t\t\t\t\tevent.options.statustext_html = true;\n \t\t\t\t\tevent.set_statustext(event._tooltip());\n \t\t\t\t\treturn event.div.trigger('mouseenter');\n \t\t\t\t}\n@@ -209,7 +210,7 @@ var et2_calendar_event = (function(){ \"use strict\"; return et2_valueWidget.exten\n \t\t\t{\n \t\t\t\tparent._out_of_view();\n \t\t\t}\n-\t\t\t\n+\n \t\t\t// This should now cease to exist, as new events have been created\n \t\t\tthis.free();\n \t\t\treturn;\n@@ -521,7 +522,7 @@ var et2_calendar_event = (function(){ \"use strict\"; return et2_valueWidget.exten\n \t\t\t\t'<span class=\"calendar_calEventTitle\">'+egw.htmlspecialchars(this.options.value.title)+'</span><br>'+\n \t\t\t\tegw.htmlspecialchars(this.options.value.description)+'</p>'+\n \t\t\t\t'<p style=\"margin: 2px 0px;\">'+times+'</p>'+\n-\t\t\t\t(this.options.value.location ? '<p><span class=\"calendar_calEventLabel\">'+this.egw().lang('Location') + '</span>:' + \n+\t\t\t\t(this.options.value.location ? '<p><span class=\"calendar_calEventLabel\">'+this.egw().lang('Location') + '</span>:' +\n \t\t\t\tegw.htmlspecialchars(this.options.value.location)+'</p>' : '')+\n \t\t\t\t(cat_label ? '<p><span class=\"calendar_calEventLabel\">'+this.egw().lang('Category') + '</span>:' + cat_label +'</p>' : '')+\n \t\t\t\t'<p><span class=\"calendar_calEventLabel\">'+this.egw().lang('Participants')+'</span>:<br />'+\n@@ -541,7 +542,7 @@ var et2_calendar_event = (function(){ \"use strict\"; return et2_valueWidget.exten\n \t\t{\n \t\t\treturn '';\n \t\t}\n-\t\t\n+\n \t\tvar participant_status = {A: 0, R: 0, T: 0, U: 0, D: 0};\n \t\tvar status_label = {A: 'accepted', R: 'rejected', T: 'tentative', U: 'unknown', D: 'delegated'};\n \t\tvar participant_summary = Object.keys(this.options.value.participants).length + ' ' + this.egw().lang('Participants')+': ';\n@@ -914,7 +915,7 @@ var et2_calendar_event = (function(){ \"use strict\"; return et2_valueWidget.exten\n \t\t\t}\n \t\t}\n \t},\n-\t\n+\n \t/**\n \t * Link the actions to the DOM nodes / widget bits.\n \t *"
        },
        {
          "filename": "calendar/templates/default/conflicts.xet",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,10 +14,10 @@\n \t\t\t\t</columns>\n \t\t\t\t<rows>\n \t\t\t\t\t<row valign=\"top\">\n-\t\t\t\t\t\t<image src=\"conflicts[$row][icon_participants]\" statustext=\"@conflicts[$row][tooltip_participants]\" no_lang=\"1\"/>\n+\t\t\t\t\t\t<image src=\"conflicts[$row][icon_participants]\" statustext_html=\"true\" statustext=\"@conflicts[$row][tooltip_participants]\" no_lang=\"1\"/>\n \t\t\t\t\t\t<image src=\"conflicts[$row][icon_recur]\" label=\"@conflicts[$row][text_recur]\" no_lang=\"1\"/>\n \t\t\t\t\t\t<description id=\"conflicts[$row][time]\" no_lang=\"1\"/>\n-\t\t\t\t\t\t<vbox statustext=\"conflict[$row][tooltip]\" orient=\",0,0\">\n+\t\t\t\t\t\t<vbox statustext=\"conflict[$row][tooltip]\" statustext_html=\"true\" orient=\",0,0\">\n \t\t\t\t\t\t\t<description id=\"conflicts[$row][title]\" no_lang=\"1\" options=\"b\"/>\n \t\t\t\t\t\t\t<description id=\"conflicts[$row][conflicting_participants]\" no_lang=\"1\"/>\n \t\t\t\t\t\t</vbox>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ce970fd6d33a8bd02431226dc39fb9c72f90cba4",
            "date": "2025-01-13T23:55:06Z",
            "author_login": "nathangray"
          },
          {
            "sha": "cd8dd7a462f8ce70cafdac5489c3fce8628d6ec8",
            "date": "2025-01-13T22:57:31Z",
            "author_login": "nathangray"
          },
          {
            "sha": "a4a1e2837a602305c7337e28f576e8305357e676",
            "date": "2025-01-13T21:34:51Z",
            "author_login": "nathangray"
          },
          {
            "sha": "cb6d657f6cb3ff05d46790fecb05b8439de4b551",
            "date": "2025-01-13T14:15:16Z",
            "author_login": "ralfbecker"
          },
          {
            "sha": "fa9bc14855c05786268743cd1b92e252cfa000a5",
            "date": "2025-01-13T09:21:12Z",
            "author_login": "ralfbecker"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Stored XSS vulnerability in eGroupware Community Edition before 16.1.20170922 allows an unauthenticated remote attacker to inject JavaScript via the User-Agent HTTP header, which is mishandled during rendering by the application administrator.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-30T01:29:01.867",
    "last_modified": "2024-11-21T03:13:45.660",
    "fix_date": "2017-09-05T17:04:45Z"
  },
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/09/28/12",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EGroupware/egroupware/commit/0ececf8c78f1c3f9ba15465f53a682dd7d89529f",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/09/28/12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EGroupware/egroupware/commit/0ececf8c78f1c3f9ba15465f53a682dd7d89529f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.402167",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "egroupware",
    "owner": "EGroupware",
    "created_at": "2016-05-12T11:53:59Z",
    "updated_at": "2025-01-14T15:51:58Z",
    "pushed_at": "2025-01-14T15:51:53Z",
    "size": 165687,
    "stars": 253,
    "forks": 99,
    "open_issues": 22,
    "watchers": 253,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "23.1",
      "master"
    ],
    "languages": {
      "PHP": 9819794,
      "TypeScript": 3157902,
      "JavaScript": 1920928,
      "CSS": 1581204,
      "Less": 348954,
      "HTML": 288421,
      "Java": 207919,
      "Smarty": 129617,
      "Rich Text Format": 41487,
      "XSLT": 36524,
      "Shell": 727
    },
    "commit_activity": {
      "total_commits_last_year": 1183,
      "avg_commits_per_week": 22.75,
      "days_active_last_year": 258
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:52:56.447280"
  }
}