{
  "cve_id": "CVE-2017-14981",
  "github_data": {
    "repository": "atutor/ATutor",
    "fix_commit": "9292360c8b3898d0990983269f110cef21729090",
    "related_commits": [
      "9292360c8b3898d0990983269f110cef21729090",
      "9292360c8b3898d0990983269f110cef21729090"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "9292360c8b3898d0990983269f110cef21729090",
      "commit_date": "2017-10-01T14:12:48Z",
      "author": {
        "login": "gregrgay",
        "type": "User",
        "stats": {
          "total_commits": 352,
          "average_weekly_commits": 0.318552036199095,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 55
        }
      },
      "commit_message": {
        "title": "5815 added htmlspecialchars to filter URL var before going to the db.",
        "length": 69,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "mods/_standard/rss_feeds/edit_feed.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -38,7 +38,7 @@\n \t}\n \n \tif (!$msg->containsErrors()) {\n-\t\t$_GET['url'] = $addslashes($_GET['url']);\n+        $_GET['url'] = htmlspecialchars(strip_tags($_GET['url']), ENT_QUOTES);\n \n \t\t$sql\t= \"REPLACE INTO %sfeeds VALUES(%d, '%s')\";\n \t\t$result = queryDB($sql, array(TABLE_PREFIX, $feed_id, $_GET['url']));"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "333030fcd1112208506947f266598a9c5fe9fbe6",
            "date": "2023-02-12T19:12:02Z",
            "author_login": "atutor"
          },
          {
            "sha": "0d8065412d8aa97649920cca8e359f1a9f10a11c",
            "date": "2023-02-08T20:10:02Z",
            "author_login": "alyssafoglia"
          },
          {
            "sha": "f29cd2534b9574ce223f22a6e0e8e2a9457c45a4",
            "date": "2023-02-08T18:44:59Z",
            "author_login": "alyssafoglia"
          },
          {
            "sha": "2f571d0e7fe6911442316de060697ebef6b500a9",
            "date": "2023-02-08T18:44:38Z",
            "author_login": "alyssafoglia"
          },
          {
            "sha": "44240cb64caff4907b3c4e8b5729270ad839da11",
            "date": "2023-02-08T18:42:03Z",
            "author_login": "alyssafoglia"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-Site Scripting (XSS) was discovered in ATutor before 2.2.3. The vulnerability exists due to insufficient filtration of data (url in /mods/_standard/rss_feeds/edit_feed.php). An attacker could inject arbitrary HTML and script code into a browser in the context of the vulnerable website.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-10-03T01:29:02.763",
    "last_modified": "2024-11-21T03:13:53.590",
    "fix_date": "2017-10-01T14:12:48Z"
  },
  "references": [
    {
      "url": "https://github.com/atutor/ATutor/commit/9292360c8b3898d0990983269f110cef21729090",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/atutor/ATutor/issues/135",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/atutor/ATutor/commit/9292360c8b3898d0990983269f110cef21729090",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/atutor/ATutor/issues/135",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.403921",
    "processing_status": "enhanced"
  }
}