{
  "cve_id": "CVE-2017-15213",
  "github_data": {
    "repository": "Flyspray/flyspray",
    "fix_commit": "754ec5d04348ef7ecb8cb02ade976dc412b031f8",
    "related_commits": [
      "754ec5d04348ef7ecb8cb02ade976dc412b031f8",
      "754ec5d04348ef7ecb8cb02ade976dc412b031f8"
    ],
    "patch_url": "https://github.com/Flyspray/flyspray/commit/754ec5d04348ef7ecb8cb02ade976dc412b031f8.patch",
    "fix_commit_details": {
      "sha": "754ec5d04348ef7ecb8cb02ade976dc412b031f8",
      "commit_date": "2017-09-11T20:46:38Z",
      "author": {
        "login": "peterdd",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update common.editallusers.tpl",
        "length": 30,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "themes/CleanFS/templates/common.editallusers.tpl",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -45,9 +45,9 @@ if ($do == 'admin'): ?>\n \t\t\techo '<tr class=\"account_disabled\" onclick=\"toggleCheckbox('.$usr['user_id'].')\">';\n \t\t} ?>\n \t\t<td><input id=\"<?php echo $usr['user_id'] ?>\" onclick=\"event.stopPropagation()\" type=\"checkbox\" name=\"checkedUsers[]\" value=\"<?php echo $usr['user_id']; ?>\"></td>\n-\t\t<td><a href=\"<?php echo CreateURL('edituser', $usr['user_id'] ); ?>\"><?php echo $usr['real_name']; ?></a></td>\n+\t\t<td><a href=\"<?php echo CreateURL('edituser', $usr['user_id'] ); ?>\"><?php echo Filters::noXSS($usr['real_name']); ?></a></td>\n \t\t<td><?php echo $usr['user_name']; ?></td>\n-\t\t<td<?= ($usr['notify_type']==0 || $usr['notify_type']==2) ? ' class=\"inactive\"':''; ?>><?php echo $usr['email_address']; ?></td>\n+\t\t<td<?= ($usr['notify_type']==0 || $usr['notify_type']==2) ? ' class=\"inactive\"':''; ?>><?php echo Filters::noXSS($usr['email_address']); ?></td>\n \t\t<td<?= ($usr['notify_type']==0 || $usr['notify_type']==1) ? ' class=\"inactive\"':''; ?>><?php echo Filters::noXSS($usr['jabber_id']); ?></td>\n                 <td><?php echo formatDate($usr['register_date']); ?></td>\n                 <td><?php echo Filters::noXSS($usr['lang_code']); ?></td>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "93211bcab920e28071146092030654ccb8f64936",
            "date": "2024-11-24T22:14:04Z",
            "author_login": "peterdd"
          },
          {
            "sha": "7607b746034a12a11ba227877c15a67e65565017",
            "date": "2024-09-29T16:38:09Z",
            "author_login": "peterdd"
          },
          {
            "sha": "19eebc5cdfd61e2b7f10f51cd53905a3a4e3a4dc",
            "date": "2024-09-28T18:23:04Z",
            "author_login": "peterdd"
          },
          {
            "sha": "fc3857b7ed9faca1c25c02986d5d94a05bb5d756",
            "date": "2024-09-28T18:22:22Z",
            "author_login": "peterdd"
          },
          {
            "sha": "28f14841fc09a3c5cf6a08c50ddffd42a29ca233",
            "date": "2024-09-09T20:45:30Z",
            "author_login": "peterdd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Stored XSS vulnerability in Flyspray before 1.0-rc6 allows an authenticated user to inject JavaScript to gain administrator privileges, via the real_name or email_address field to themes/CleanFS/templates/common.editallusers.tpl.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-10-11T01:32:55.240",
    "last_modified": "2024-11-21T03:14:14.080",
    "fix_date": "2017-09-11T20:46:38Z"
  },
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/10/07/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/commit/754ec5d04348ef7ecb8cb02ade976dc412b031f8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/releases/tag/v1.0-rc6",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/10/07/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/commit/754ec5d04348ef7ecb8cb02ade976dc412b031f8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/releases/tag/v1.0-rc6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.412989",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "flyspray",
    "owner": "Flyspray",
    "created_at": "2012-09-21T03:57:14Z",
    "updated_at": "2025-01-09T16:24:03Z",
    "pushed_at": "2024-12-26T13:29:44Z",
    "size": 14264,
    "stars": 376,
    "forks": 169,
    "open_issues": 78,
    "watchers": 376,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 3828910,
      "JavaScript": 784116,
      "Smarty": 388956,
      "CSS": 271420,
      "HTML": 206580,
      "Less": 11862
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T14:03:19.727884"
  }
}