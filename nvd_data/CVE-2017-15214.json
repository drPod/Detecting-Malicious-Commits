{
  "cve_id": "CVE-2017-15214",
  "github_data": {
    "repository": "Flyspray/flyspray",
    "fix_commit": "00cfae5661124f9d67ac6733db61b2bfee34dccc",
    "related_commits": [
      "00cfae5661124f9d67ac6733db61b2bfee34dccc",
      "00cfae5661124f9d67ac6733db61b2bfee34dccc"
    ],
    "patch_url": "https://github.com/Flyspray/flyspray/commit/00cfae5661124f9d67ac6733db61b2bfee34dccc.patch",
    "fix_commit_details": {
      "sha": "00cfae5661124f9d67ac6733db61b2bfee34dccc",
      "commit_date": "2017-09-12T22:25:27Z",
      "author": {
        "login": "peterdd",
        "type": "User",
        "stats": {
          "total_commits": 2383,
          "average_weekly_commits": 2.482291666666667,
          "total_additions": 63773,
          "total_deletions": 38312,
          "weeks_active": 208
        }
      },
      "commit_message": {
        "title": "quickfix for dokuwiki links",
        "length": 27,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 10,
        "deletions": 3
      },
      "files": [
        {
          "filename": "plugins/dokuwiki/lib/plugins/changelinks/syntax.php",
          "status": "modified",
          "additions": 10,
          "deletions": 3,
          "patch": "@@ -130,8 +130,15 @@ function render($mode, &$renderer, $data) {\n             $link['more']   = '';\n             $link['class']  = 'internallink';\n             $link['url']    = DOKU_INTERNAL_LINK . $id;\n-            $link['name']   = ($name) ? $name : $id;\n-            $link['title']  = ($name) ? $name : $id;\n+         \n+            if(is_array($name)){\n+               $link['name']   = (isset($name['title'])) ? hsc($name['title']) : hsc($id);\n+               $link['title'] = $id;\n+            } else{\n+               $link['name']   = ($name) ? hsc($name) : hsc($id);\n+               $link['title'] = ($name) ? $name : $id;\n+            }\n+\n             //add search string\n             if($search){\n                 ($conf['userewrite']) ? $link['url'].='?s=' : $link['url'].='&amp;s=';\n@@ -147,4 +154,4 @@ function render($mode, &$renderer, $data) {\n }\n  \n //Setup VIM: ex: et ts=4 enc=utf-8 :\n-?>\n\\ No newline at end of file\n+?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "93211bcab920e28071146092030654ccb8f64936",
            "date": "2024-11-24T22:14:04Z",
            "author_login": "peterdd"
          },
          {
            "sha": "7607b746034a12a11ba227877c15a67e65565017",
            "date": "2024-09-29T16:38:09Z",
            "author_login": "peterdd"
          },
          {
            "sha": "19eebc5cdfd61e2b7f10f51cd53905a3a4e3a4dc",
            "date": "2024-09-28T18:23:04Z",
            "author_login": "peterdd"
          },
          {
            "sha": "fc3857b7ed9faca1c25c02986d5d94a05bb5d756",
            "date": "2024-09-28T18:22:22Z",
            "author_login": "peterdd"
          },
          {
            "sha": "28f14841fc09a3c5cf6a08c50ddffd42a29ca233",
            "date": "2024-09-09T20:45:30Z",
            "author_login": "peterdd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Stored XSS vulnerability in Flyspray 1.0-rc4 before 1.0-rc6 allows an authenticated user to inject JavaScript to gain administrator privileges and also to execute JavaScript against other users (including unauthenticated users), via the name, title, or id parameter to plugins/dokuwiki/lib/plugins/changelinks/syntax.php.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-10-11T01:32:55.287",
    "last_modified": "2024-11-21T03:14:14.223",
    "fix_date": "2017-09-12T22:25:27Z"
  },
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/10/07/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/commit/00cfae5661124f9d67ac6733db61b2bfee34dccc",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/releases/tag/v1.0-rc6",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/10/07/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/commit/00cfae5661124f9d67ac6733db61b2bfee34dccc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Flyspray/flyspray/releases/tag/v1.0-rc6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.413130",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "flyspray",
    "owner": "Flyspray",
    "created_at": "2012-09-21T03:57:14Z",
    "updated_at": "2025-01-09T16:24:03Z",
    "pushed_at": "2024-12-26T13:29:44Z",
    "size": 14264,
    "stars": 376,
    "forks": 169,
    "open_issues": 78,
    "watchers": 376,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 3828910,
      "JavaScript": 784116,
      "Smarty": 388956,
      "CSS": 271420,
      "HTML": 206580,
      "Less": 11862
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T14:03:19.727884"
  }
}