{
  "cve_id": "CVE-2017-16615",
  "github_data": {
    "repository": "thanethomson/MLAlchemy",
    "fix_commit": "bc795757febdcce430d89f9d08f75c32d6989d3c",
    "related_commits": [
      "bc795757febdcce430d89f9d08f75c32d6989d3c",
      "bc795757febdcce430d89f9d08f75c32d6989d3c"
    ],
    "patch_url": "https://github.com/thanethomson/MLAlchemy/commit/bc795757febdcce430d89f9d08f75c32d6989d3c.patch",
    "fix_commit_details": {
      "sha": "bc795757febdcce430d89f9d08f75c32d6989d3c",
      "commit_date": "2017-11-07T11:33:54Z",
      "author": {
        "login": "thanethomson",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "attempting to fix security flaw (issue #1)",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 22,
        "deletions": 1
      },
      "files": [
        {
          "filename": "mlalchemy/parser.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -33,7 +33,7 @@ def parse_yaml_query(yaml_content):\n         On success, the processed MLQuery object.\n     \"\"\"\n     logger.debug(\"Attempting to parse YAML content:\\n%s\" % yaml_content)\n-    return parse_query(yaml.load(yaml_content))\n+    return parse_query(yaml.safe_load(yaml_content))\n \n \n def parse_json_query(json_content):"
        },
        {
          "filename": "tests/test_yaml_security.py",
          "status": "added",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -0,0 +1,21 @@\n+# -*- coding: utf-8 -*-\n+\n+from __future__ import unicode_literals\n+\n+import unittest\n+import yaml\n+\n+from mlalchemy import *\n+from mlalchemy.testing import MLAlchemyTestCase\n+\n+\n+class TestYamlSecurity(MLAlchemyTestCase):\n+\n+    def test_basic_yaml_security(self):\n+        with self.assertRaises(yaml.constructor.ConstructorError):\n+            parse_yaml_query('!!python/object/apply:os.system [\"echo Hello\"]')\n+\n+\n+if __name__ == \"__main__\":\n+    unittest.main()\n+"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c5fe46b3c23ccf952d50e913b6db1588c87d753a",
            "date": "2017-11-07T11:34:46Z",
            "author_login": "thanethomson"
          },
          {
            "sha": "bc795757febdcce430d89f9d08f75c32d6989d3c",
            "date": "2017-11-07T11:33:54Z",
            "author_login": "thanethomson"
          },
          {
            "sha": "5736ec6ce1fbc9e5bd732204f04c8c01ab34415f",
            "date": "2017-02-01T07:46:11Z",
            "author_login": "thanethomson"
          },
          {
            "sha": "c707bf62a1b0933ba388c07deb3f49478198305b",
            "date": "2017-02-01T07:43:28Z",
            "author_login": "thanethomson"
          },
          {
            "sha": "f3de8bbb8a054e522e18a7415c73a970bce597cb",
            "date": "2017-02-01T07:43:00Z",
            "author_login": "thanethomson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "An exploitable vulnerability exists in the YAML parsing functionality in the parse_yaml_query method in parser.py in MLAlchemy before 0.2.2. When processing YAML-Based queries for data, a YAML parser can execute arbitrary Python commands resulting in command execution because load is used where safe_load should have been used. An attacker can insert Python into loaded YAML to trigger this vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-11-08T03:29:00.200",
    "last_modified": "2024-11-21T03:16:42.333",
    "fix_date": "2017-11-07T11:33:54Z"
  },
  "references": [
    {
      "url": "https://github.com/thanethomson/MLAlchemy/commit/bc795757febdcce430d89f9d08f75c32d6989d3c",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/thanethomson/MLAlchemy/issues/1",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://joel-malwarebenchmark.github.io/blog/2017/11/08/cve-2017-16615-critical-restful-web-applications-vulnerability/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/thanethomson/MLAlchemy/commit/bc795757febdcce430d89f9d08f75c32d6989d3c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/thanethomson/MLAlchemy/issues/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://joel-malwarebenchmark.github.io/blog/2017/11/08/cve-2017-16615-critical-restful-web-applications-vulnerability/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.728061",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "MLAlchemy",
    "owner": "thanethomson",
    "created_at": "2017-01-26T08:31:43Z",
    "updated_at": "2024-12-17T18:43:31Z",
    "pushed_at": "2017-11-07T11:36:24Z",
    "size": 27,
    "stars": 43,
    "forks": 5,
    "open_issues": 1,
    "watchers": 43,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 36745,
      "Shell": 165
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:23:48.688528"
  }
}