{
  "cve_id": "CVE-2017-16667",
  "github_data": {
    "repository": "bit-team/backintime",
    "fix_commit": "cef81d0da93ff601252607df3db1a48f7f6f01b3",
    "related_commits": [
      "cef81d0da93ff601252607df3db1a48f7f6f01b3",
      "cef81d0da93ff601252607df3db1a48f7f6f01b3"
    ],
    "patch_url": "https://github.com/bit-team/backintime/commit/cef81d0da93ff601252607df3db1a48f7f6f01b3.patch",
    "fix_commit_details": {
      "sha": "cef81d0da93ff601252607df3db1a48f7f6f01b3",
      "commit_date": "2017-11-07T20:32:34Z",
      "author": {
        "login": "Germar",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix critical bug: shell injection in notify-send (fixes #834)",
        "length": 61,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
      },
      "files": [
        {
          "filename": "CHANGES",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1,5 +1,8 @@\n Back In Time\n \n+Version 1.1.24\n+* fix critical bug: shell injection in notify-send (https://github.com/bit-team/backintime/issues/834)\n+\n Version 1.1.22\n * fix bug: stat free space for snapshot folder instead of backintime folder (https://github.com/bit-team/backintime/issues/733)\n * backport bug fix: backintime root crontab doesn't run; missinng line-feed 0x0A on last line (https://github.com/bit-team/backintime/issues/781)"
        },
        {
          "filename": "qt4/plugins/notifyplugin.py",
          "status": "modified",
          "additions": 6,
          "deletions": 5,
          "patch": "@@ -19,6 +19,7 @@\n import os\n import pluginmanager\n import gettext\n+import subprocess\n \n _=gettext.gettext\n \n@@ -64,15 +65,15 @@ def on_new_snapshot( self, snapshot_id, snapshot_path ):\n \n     def on_message( self, profile_id, profile_name, level, message, timeout ):\n         if 1 == level:\n-            cmd = \"notify-send \"\n+            cmd = ['notify-send']\n             if timeout > 0:\n-                cmd = cmd + \" -t %s\" % (1000 * timeout)\n+                cmd.extend(['-t', str(1000 * timeout)])\n \n             title = \"Back In Time (%s) : %s\" % (self.user, profile_name)\n             message = message.replace(\"\\n\", ' ')\n             message = message.replace(\"\\r\", '')\n \n-            cmd = cmd + \" \\\"%s\\\" \\\"%s\\\"\" % (title, message)\n-            print(cmd)\n-            os.system(cmd)\n+            cmd.append(title)\n+            cmd.append(message)\n+            subprocess.Popen(cmd).communicate()\n         return"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0b3049de0b6791b157a6b258e781e898776fe757",
            "date": "2025-01-12T09:36:37Z",
            "author_login": "buhtz"
          },
          {
            "sha": "b24b9e1a5a3bb06efd5efaed7092478bb01ae361",
            "date": "2025-01-12T09:35:13Z",
            "author_login": "buhtz"
          },
          {
            "sha": "0239b009d106ce671f9664355b8a24765b460e6a",
            "date": "2025-01-09T06:33:35Z",
            "author_login": "buhtz"
          },
          {
            "sha": "f3eb75cdaf5be6a93e2c16abc6b1516794efa5bb",
            "date": "2025-01-06T12:18:43Z",
            "author_login": "buhtz"
          },
          {
            "sha": "d6dd61efb08c6f08412dd1aa629e0e52f36d4e87",
            "date": "2025-01-05T18:49:18Z",
            "author_login": "s4moore"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-78",
    "description": "backintime (aka Back in Time) before 1.1.24 did improper escaping/quoting of file paths used as arguments to the 'notify-send' command, leading to some parts of file paths being executed as shell commands within an os.system call in qt4/plugins/notifyplugin.py. This could allow an attacker to craft an unreadable file with a specific name to run arbitrary shell commands.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-11-08T18:29:00.247",
    "last_modified": "2024-11-21T03:16:47.460",
    "fix_date": "2017-11-07T20:32:34Z"
  },
  "references": [
    {
      "url": "https://github.com/bit-team/backintime/commit/cef81d0da93ff601252607df3db1a48f7f6f01b3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bit-team/backintime/issues/834",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bit-team/backintime/releases/tag/v1.1.24",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201801-06",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bit-team/backintime/commit/cef81d0da93ff601252607df3db1a48f7f6f01b3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bit-team/backintime/issues/834",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bit-team/backintime/releases/tag/v1.1.24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201801-06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.729033",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "backintime",
    "owner": "bit-team",
    "created_at": "2015-10-11T16:12:03Z",
    "updated_at": "2025-01-13T05:47:07Z",
    "pushed_at": "2025-01-12T09:36:38Z",
    "size": 22187,
    "stars": 2208,
    "forks": 218,
    "open_issues": 180,
    "watchers": 2208,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 1349806,
      "Roff": 39782,
      "Shell": 8147,
      "Makefile": 6832
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:20:00.689246"
  }
}