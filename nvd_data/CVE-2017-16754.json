{
  "cve_id": "CVE-2017-16754",
  "github_data": {
    "repository": "bolt/bolt",
    "fix_commit": "aa21787241945457a2e4abc8b079672935fe0840",
    "related_commits": [
      "aa21787241945457a2e4abc8b079672935fe0840",
      "aa21787241945457a2e4abc8b079672935fe0840"
    ],
    "patch_url": "https://github.com/bolt/bolt/commit/aa21787241945457a2e4abc8b079672935fe0840.patch",
    "fix_commit_details": {
      "sha": "aa21787241945457a2e4abc8b079672935fe0840",
      "commit_date": "2017-09-26T15:14:28Z",
      "author": {
        "login": "GwendolenLynch",
        "type": "User",
        "stats": {
          "total_commits": 7588,
          "average_weekly_commits": 11.53191489361702,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 217
        }
      },
      "commit_message": {
        "title": "Request listener to prevent access to profiler routes",
        "length": 53,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 86,
        "additions": 86,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/EventListener/ProfilerListener.php",
          "status": "added",
          "additions": 74,
          "deletions": 0,
          "patch": "@@ -0,0 +1,74 @@\n+<?php\n+\n+namespace Bolt\\EventListener;\n+\n+use Bolt\\AccessControl\\Token\\Token;\n+use Bolt\\Request\\ProfilerAwareTrait;\n+use Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\n+use Symfony\\Component\\HttpFoundation\\Session\\SessionInterface;\n+use Symfony\\Component\\HttpKernel\\Event\\GetResponseEvent;\n+use Symfony\\Component\\HttpKernel\\Exception\\NotFoundHttpException;\n+use Symfony\\Component\\HttpKernel\\KernelEvents;\n+\n+/**\n+ * Symfony Profiler listener.\n+ *\n+ * @author Gawain Lynch <gawain.lynch@gmail.com>\n+ */\n+class ProfilerListener implements EventSubscriberInterface\n+{\n+    use ProfilerAwareTrait;\n+\n+    /** @var SessionInterface */\n+    private $session;\n+    /** @var bool */\n+    private $debug;\n+    /** @var bool */\n+    private $debugLoggedOff;\n+\n+    /**\n+     * Constructor.\n+     *\n+     * @param SessionInterface $session\n+     * @param bool             $debug\n+     * @param bool             $debugLoggedOff\n+     */\n+    public function __construct(SessionInterface $session, $debug, $debugLoggedOff)\n+    {\n+        $this->session = $session;\n+        $this->debug = $debug;\n+        $this->debugLoggedOff = $debugLoggedOff;\n+    }\n+\n+    /**\n+     * Request listener to prevent access to profiler routes when debugging is\n+     * not enabled, or the user is logged off & debugging is not configured to\n+     * show when logged off.\n+     *\n+     * @param GetResponseEvent $event\n+     */\n+    public function onKernelRequest(GetResponseEvent $event)\n+    {\n+        $request = $event->getRequest();\n+        if (!$this->isProfilerRequest($request)) {\n+            return;\n+        }\n+\n+        $token = $this->session->isStarted() ? $this->session->get('authentication') : null;\n+        if ($this->debug && ($token instanceof Token || $this->debugLoggedOff)) {\n+            return;\n+        }\n+\n+        throw new NotFoundHttpException();\n+    }\n+\n+    /**\n+     * {@inheritdoc}\n+     */\n+    public static function getSubscribedEvents()\n+    {\n+        return [\n+            KernelEvents::REQUEST => ['onKernelRequest'],\n+        ];\n+    }\n+}"
        },
        {
          "filename": "src/Provider/EventListenerServiceProvider.php",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -130,6 +130,16 @@ function ($app) {\n                 return new Listener\\ZoneGuesser($app);\n             }\n         );\n+\n+        $app['listener.profile'] = $app->share(\n+            function ($app) {\n+                return new Listener\\ProfilerListener(\n+                    $app['session'],\n+                    $app['debug'],\n+                    $app['config']->get('general/debug_show_loggedoff')\n+                );\n+            }\n+        );\n     }\n \n     public function boot(Application $app)\n@@ -160,5 +170,7 @@ public function boot(Application $app)\n         if (isset($app['listener.exception']) && !$app['config']->get('general/debug_error_use_symfony')) {\n             $dispatcher->addSubscriber($app['listener.exception']);\n         }\n+\n+        $dispatcher->addSubscriber($app['listener.profile']);\n     }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "391eecbe988e0cd5c25a7180ab65c82002fe18f3",
            "date": "2023-02-22T13:43:56Z",
            "author_login": "bobdenotter"
          },
          {
            "sha": "83e114674f4a3eb1defc1e30102b173609e08f70",
            "date": "2023-02-22T13:43:17Z",
            "author_login": "bobdenotter"
          },
          {
            "sha": "54999b935df48b7de31d5c4753d5678aa2eacfd0",
            "date": "2023-02-22T13:42:51Z",
            "author_login": "bobdenotter"
          },
          {
            "sha": "99b581926221f1c591d270980143794db7a16eb4",
            "date": "2021-11-12T12:14:26Z",
            "author_login": "bobdenotter"
          },
          {
            "sha": "13ec20f71c586fee7db6b0f86ea5cc6730fd0e20",
            "date": "2021-11-12T11:27:57Z",
            "author_login": "bobdenotter"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-732",
    "description": "Bolt before 3.3.6 does not properly restrict access to _profiler routes, related to EventListener/ProfilerListener.php and Provider/EventListenerServiceProvider.php.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-11-10T02:29:19.107",
    "last_modified": "2024-11-21T03:16:54.147",
    "fix_date": "2017-09-26T15:14:28Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/101777",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/bolt/bolt/commit/aa21787241945457a2e4abc8b079672935fe0840",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bolt/bolt/releases/tag/v3.3.6",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/101777",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/bolt/bolt/commit/aa21787241945457a2e4abc8b079672935fe0840",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bolt/bolt/releases/tag/v3.3.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.731054",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bolt",
    "owner": "bolt",
    "created_at": "2012-06-14T16:07:54Z",
    "updated_at": "2025-01-14T02:39:47Z",
    "pushed_at": "2023-06-27T10:22:08Z",
    "size": 80417,
    "stars": 4161,
    "forks": 817,
    "open_issues": 56,
    "watchers": 4161,
    "has_security_policy": false,
    "default_branch": "3.7",
    "protected_branches": [
      "1.6",
      "1.7",
      "2.0",
      "2.1",
      "2.2",
      "3.x",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "3.4",
      "3.5",
      "3.6",
      "3.7",
      "master"
    ],
    "languages": {
      "PHP": 3268063,
      "JavaScript": 596141,
      "Twig": 397445,
      "CSS": 161157,
      "SCSS": 92948,
      "HTML": 18349,
      "Shell": 2618
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:17:46.290962"
  }
}