{
  "cve_id": "CVE-2017-16818",
  "github_data": {
    "repository": "ceph/ceph",
    "fix_commit": "b3118cabb8060a8cc6a01c4e8264cb18e7b1745a",
    "related_commits": [
      "b3118cabb8060a8cc6a01c4e8264cb18e7b1745a",
      "b3118cabb8060a8cc6a01c4e8264cb18e7b1745a"
    ],
    "patch_url": "https://github.com/ceph/ceph/commit/b3118cabb8060a8cc6a01c4e8264cb18e7b1745a.patch",
    "fix_commit_details": {
      "sha": "b3118cabb8060a8cc6a01c4e8264cb18e7b1745a",
      "commit_date": "2017-10-10T20:21:48Z",
      "author": {
        "login": "adamemerson",
        "type": "User",
        "stats": {
          "total_commits": 914,
          "average_weekly_commits": 1.0246636771300448,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 203
        }
      },
      "commit_message": {
        "title": "rgw: Remove assertions in IAM Policy",
        "length": 142,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 9,
        "deletions": 8
      },
      "files": [
        {
          "filename": "src/rgw/rgw_basic_types.h",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -160,12 +160,10 @@ class Principal {\n   }\n \n   const std::string& get_tenant() const {\n-    ceph_assert(t != Wildcard);\n     return u.tenant;\n   }\n \n   const std::string& get_id() const {\n-    ceph_assert(t != Wildcard && t != Tenant);\n     return u.id;\n   }\n "
        },
        {
          "filename": "src/rgw/rgw_iam_policy.cc",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -221,7 +221,9 @@ optional<ARN> ARN::parse(const string& s, bool wildcards) {\n   if ((s == \"*\") && wildcards) {\n     return ARN(Partition::wildcard, Service::wildcard, \"*\", \"*\", \"*\");\n   } else if (regex_match(s, match, wildcards ? rx_wild : rx_no_wild)) {\n-    ceph_assert(match.size() == 6);\n+    if (match.size() != 6) {\n+      return boost::none;\n+    }\n \n     ARN a;\n     {\n@@ -771,7 +773,9 @@ static optional<Principal> parse_principal(CephContext* cct, TokenID t,\n \t\t\t  ECMAScript | optimize);\n     smatch match;\n     if (regex_match(a->resource, match, rx)) {\n-      ceph_assert(match.size() == 3);\n+      if (match.size() != 3) {\n+\treturn boost::none;\n+      }\n \n       if (match[1] == \"user\") {\n \treturn Principal::user(std::move(a->account),\n@@ -843,7 +847,9 @@ bool ParseState::do_string(CephContext* cct, const char* s, size_t l) {\n     // Principals\n \n   } else if (w->kind == TokenKind::princ_type) {\n-    ceph_assert(pp->s.size() > 1);\n+    if (pp->s.size() <= 1) {\n+      return false;\n+    }\n     auto& pri = pp->s[pp->s.size() - 2].w->id == TokenID::Principal ?\n       t->princ : t->noprinc;\n "
        },
        {
          "filename": "src/rgw/rgw_iam_policy.h",
          "status": "modified",
          "additions": 0,
          "deletions": 3,
          "patch": "@@ -29,8 +29,6 @@\n #include \"rgw_iam_policy_keywords.h\"\n #include \"rgw_string.h\"\n \n-#include \"include/assert.h\" // razzin' frazzin' ...grrr.\n-\n class RGWRados;\n namespace rgw {\n namespace auth {\n@@ -254,7 +252,6 @@ string to_string(const MaskedIP& m);\n inline bool operator ==(const MaskedIP& l, const MaskedIP& r) {\n   auto shift = std::max((l.v6 ? 128 : 32) - l.prefix,\n \t\t\t(r.v6 ? 128 : 32) - r.prefix);\n-  ceph_assert(shift > 0);\n   return (l.addr >> shift) == (r.addr >> shift);\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3f1f3450aee368823dc8ae90a8cef13b89b1b950",
            "date": "2025-01-14T17:28:22Z",
            "author_login": "adk3798"
          },
          {
            "sha": "565295d9afafe862c190316282bd3e9e2ae6a86f",
            "date": "2025-01-14T16:42:02Z",
            "author_login": "cbodley"
          },
          {
            "sha": "3fa2f0e9616b24dc8b5c61aaefdb99cded10fb56",
            "date": "2025-01-14T13:14:52Z",
            "author_login": "JonBailey1993"
          },
          {
            "sha": "a0f2a3b82fbcfe1f2593eeee35d93cfe0effa2f0",
            "date": "2025-01-14T09:24:50Z",
            "author_login": "zdover23"
          },
          {
            "sha": "f8ba6c61c2ede07dba2df62fc4801aa2101f378a",
            "date": "2025-01-14T08:25:26Z",
            "author_login": "aclamk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-617",
    "description": "RADOS Gateway in Ceph 12.1.0 through 12.2.1 allows remote authenticated users to cause a denial of service (assertion failure and application exit) by leveraging \"full\" (not necessarily admin) privileges to post an invalid profile to the admin API, related to rgw/rgw_iam_policy.cc, rgw/rgw_basic_types.h, and rgw/rgw_iam_types.h.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-12-20T17:29:00.307",
    "last_modified": "2024-11-21T03:17:01.840",
    "fix_date": "2017-10-10T20:21:48Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1515872",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ceph/ceph/commit/b3118cabb8060a8cc6a01c4e8264cb18e7b1745a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/U6VJA32U7HKGDRJQDJVM7JBYWD4T7BJL/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1515872",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ceph/ceph/commit/b3118cabb8060a8cc6a01c4e8264cb18e7b1745a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/U6VJA32U7HKGDRJQDJVM7JBYWD4T7BJL/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:12.783729",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ceph",
    "owner": "ceph",
    "created_at": "2011-09-01T21:41:26Z",
    "updated_at": "2025-01-14T13:14:58Z",
    "pushed_at": "2025-01-14T13:14:52Z",
    "size": 812257,
    "stars": 14427,
    "forks": 6048,
    "open_issues": 848,
    "watchers": 14427,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "argonaut",
      "bobtail",
      "cuttlefish"
    ],
    "languages": {
      "C++": 50285765,
      "Python": 12334734,
      "Raku": 3800803,
      "C": 3470858,
      "TypeScript": 3405230,
      "Shell": 2345539,
      "HTML": 881613,
      "CMake": 874020,
      "Terra": 773718,
      "Cython": 630103,
      "Jsonnet": 382417,
      "JavaScript": 141459,
      "Java": 109488,
      "Gherkin": 97105,
      "Perl": 68932,
      "Assembly": 53250,
      "SCSS": 50600,
      "Jinja": 37039,
      "Roff": 26436,
      "PowerShell": 10012,
      "Dockerfile": 9328,
      "Makefile": 4786,
      "Awk": 3196,
      "CSS": 2086,
      "DIGITAL Command Language": 2074,
      "Lua": 1304,
      "SWIG": 951,
      "Turing": 941,
      "Smarty": 173
    },
    "commit_activity": {
      "total_commits_last_year": 6520,
      "avg_commits_per_week": 125.38461538461539,
      "days_active_last_year": 355
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:03:33.965039"
  }
}