{
  "cve_id": "CVE-2017-16833",
  "github_data": {
    "repository": "PierreRambaud/gemirro",
    "fix_commit": "9659f9b7ce15a723da8e361bd41b9203b19c97de",
    "related_commits": [
      "9659f9b7ce15a723da8e361bd41b9203b19c97de",
      "9659f9b7ce15a723da8e361bd41b9203b19c97de"
    ],
    "patch_url": "https://github.com/PierreRambaud/gemirro/commit/9659f9b7ce15a723da8e361bd41b9203b19c97de.patch",
    "fix_commit_details": {
      "sha": "9659f9b7ce15a723da8e361bd41b9203b19c97de",
      "commit_date": "2017-11-14T12:03:20Z",
      "author": {
        "login": "PierreRambaud",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security Fix again, thanks to Yasin Soliman",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 13,
        "deletions": 2
      },
      "files": [
        {
          "filename": "Gemfile.lock",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n PATH\n   remote: .\n   specs:\n-    gemirro (0.14.0)\n+    gemirro (0.15.0)\n       builder (~> 3.2)\n       confstruct (~> 1.0)\n       erubis (~> 2.7)"
        },
        {
          "filename": "lib/gemirro/server.rb",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -1,5 +1,6 @@\n require 'sinatra/base'\n require 'thin'\n+require 'uri'\n \n module Gemirro\n   ##\n@@ -271,6 +272,16 @@ def spec_for(gemname, version, platform = 'ruby')\n       def escape(string)\n         Rack::Utils.escape_html(string)\n       end\n+\n+      ##\n+      # Homepage link\n+      #\n+      # @param [Gem] spec\n+      # @return [String]\n+      #\n+      def homepage(spec)\n+        URI.parse(URI.escape(spec.homepage))\n+      end\n     end\n   end\n end"
        },
        {
          "filename": "views/gem.erb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -31,7 +31,7 @@\n             <ul class=\"list-group\">\n               <% spec.authors.each do |author| %>\n                 <li class=\"list-group-item\">\n-                  <a href=\"<%= escape(spec.homepage) %>\"><%= escape(author) %></a>\n+                  <a href=\"<%= homepage(spec) %>\"><%= escape(author) %></a>\n                 </li>\n               <% end %>\n             </ul>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a9b3a978c411723c12971ac6123ad5a9db64772e",
            "date": "2024-10-10T12:05:28Z",
            "author_login": "PierreRambaud"
          },
          {
            "sha": "246a57299b1590b75cd1b377cb62ee64d901b5e8",
            "date": "2024-10-10T11:47:24Z",
            "author_login": "PierreRambaud"
          },
          {
            "sha": "59e7e9df62a2228e64434dbe4720cb254c9b8abb",
            "date": "2024-10-10T11:46:39Z",
            "author_login": "PierreRambaud"
          },
          {
            "sha": "75717ec19df526c4ddf7e188654ba74383347f36",
            "date": "2024-10-10T11:46:27Z",
            "author_login": "PierreRambaud"
          },
          {
            "sha": "a5bb6028869ec8092c8fec5c12ab48c47899da7f",
            "date": "2024-09-20T18:42:40Z",
            "author_login": "bli111"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Stored cross-site scripting (XSS) vulnerability in Gemirro before 0.16.0 allows attackers to inject arbitrary web script via a crafted javascript: URL in the \"homepage\" value of a \".gemspec\" file.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-11-15T09:29:00.210",
    "last_modified": "2024-11-21T03:17:03.497",
    "fix_date": "2017-11-14T12:03:20Z"
  },
  "references": [
    {
      "url": "https://github.com/PierreRambaud/gemirro/commit/9659f9b7ce15a723da8e361bd41b9203b19c97de",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PierreRambaud/gemirro/commit/9659f9b7ce15a723da8e361bd41b9203b19c97de",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.736037",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gemirro",
    "owner": "PierreRambaud",
    "created_at": "2014-08-20T21:51:25Z",
    "updated_at": "2024-11-25T17:22:18Z",
    "pushed_at": "2024-10-10T12:06:29Z",
    "size": 682,
    "stars": 138,
    "forks": 27,
    "open_issues": 9,
    "watchers": 138,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Ruby": 104177,
      "HTML": 4699
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:11:17.091218"
  }
}