{
  "cve_id": "CVE-2017-16876",
  "github_data": {
    "repository": "lepture/mistune",
    "fix_commit": "5f06d724bc05580e7f203db2d4a4905fc1127f98",
    "related_commits": [
      "5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "5f06d724bc05580e7f203db2d4a4905fc1127f98"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "commit_date": "2017-11-20T15:15:09Z",
      "author": {
        "login": "lepture",
        "type": "User",
        "stats": {
          "total_commits": 572,
          "average_weekly_commits": 1.0,
          "total_additions": 62615,
          "total_deletions": 47818,
          "weeks_active": 132
        }
      },
      "commit_message": {
        "title": "Fix CVE-2017-16876",
        "length": 18,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
      },
      "files": [
        {
          "filename": "mistune.py",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -11,7 +11,7 @@\n import re\n import inspect\n \n-__version__ = '0.8'\n+__version__ = '0.8.1'\n __author__ = 'Hsiaoming Yang <me@lepture.com>'\n __all__ = [\n     'BlockGrammar', 'BlockLexer',\n@@ -48,7 +48,8 @@ def _pure_pattern(regex):\n \n \n def _keyify(key):\n-    return _key_pattern.sub(' ', key.lower())\n+    key = escape(key.lower(), quote=True)\n+    return _key_pattern.sub(' ', key)\n \n \n def escape(text, quote=False, smart_amp=True):\n@@ -445,7 +446,8 @@ class InlineGrammar(object):\n     inline_html = re.compile(\n         r'^(?:%s|%s|%s)' % (\n             r'<!--[\\s\\S]*?-->',\n-            r'<(\\w+%s)((?:%s)*?)\\s*>([\\s\\S]*?)<\\/\\1>' % (_valid_end, _valid_attr),\n+            r'<(\\w+%s)((?:%s)*?)\\s*>([\\s\\S]*?)<\\/\\1>' % (\n+                _valid_end, _valid_attr),\n             r'<\\w+%s(?:%s)*?\\s*\\/?>' % (_valid_end, _valid_attr),\n         )\n     )"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "042a8065c3aa600a57a5e48bb07252d1fe61fe51",
            "date": "2025-01-11T06:37:10Z",
            "author_login": "lepture"
          },
          {
            "sha": "f86ad483afaebdb09f8b36796356240c26e95805",
            "date": "2025-01-09T12:46:19Z",
            "author_login": "impocode"
          },
          {
            "sha": "8d6ab0483e9153d0929fea2531f43a287e44b2b0",
            "date": "2025-01-05T11:19:52Z",
            "author_login": "lepture"
          },
          {
            "sha": "cbfe8d41ff3996affc701e0242d677096ecef4c7",
            "date": "2025-01-01T19:15:04Z",
            "author_login": "impocode"
          },
          {
            "sha": "177a0ceefd23a8ebc7f7efb5c89c0be8023ae3bf",
            "date": "2024-12-30T02:06:06Z",
            "author_login": "lepture"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting (XSS) vulnerability in the _keyify function in mistune.py in Mistune before 0.8.1 allows remote attackers to inject arbitrary web script or HTML by leveraging failure to escape the \"key\" argument.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-12-29T15:29:00.610",
    "last_modified": "2024-11-21T03:17:09.317",
    "fix_date": "2017-11-20T15:15:09Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1524596",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/lepture/mistune/blob/master/CHANGES.rst",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lepture/mistune/commit/5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NUR3GMHQBMA3UC4PFMCK6GCLOQC4LQQC/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1524596",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/lepture/mistune/blob/master/CHANGES.rst",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lepture/mistune/commit/5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NUR3GMHQBMA3UC4PFMCK6GCLOQC4LQQC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:12.799826",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mistune",
    "owner": "lepture",
    "created_at": "2014-02-18T10:13:04Z",
    "updated_at": "2025-01-25T20:32:10Z",
    "pushed_at": "2025-01-11T06:37:10Z",
    "size": 1212,
    "stars": 2653,
    "forks": 253,
    "open_issues": 39,
    "watchers": 2653,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 164310,
      "Makefile": 381
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T08:16:22.022873"
  }
}