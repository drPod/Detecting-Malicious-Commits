{
  "cve_id": "CVE-2017-16932",
  "github_data": {
    "repository": "GNOME/libxml2",
    "fix_commit": "899a5d9f0ed13b8e32449a08a361e0de127dd961",
    "related_commits": [
      "899a5d9f0ed13b8e32449a08a361e0de127dd961",
      "899a5d9f0ed13b8e32449a08a361e0de127dd961"
    ],
    "patch_url": "https://github.com/GNOME/libxml2/commit/899a5d9f0ed13b8e32449a08a361e0de127dd961.patch",
    "fix_commit_details": {
      "sha": "899a5d9f0ed13b8e32449a08a361e0de127dd961",
      "commit_date": "2017-07-25T12:59:49Z",
      "author": {
        "login": "nwellnhof",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Detect infinite recursion in parameter entities",
        "length": 233,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 35,
        "additions": 34,
        "deletions": 1
      },
      "files": [
        {
          "filename": "parser.c",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -2250,6 +2250,13 @@ xmlPushInput(xmlParserCtxtPtr ctxt, xmlParserInputPtr input) {\n \txmlGenericError(xmlGenericErrorContext,\n \t\t\"Pushing input %d : %.30s\\n\", ctxt->inputNr+1, input->cur);\n     }\n+    if (((ctxt->inputNr > 40) && ((ctxt->options & XML_PARSE_HUGE) == 0)) ||\n+        (ctxt->inputNr > 1024)) {\n+        xmlFatalErr(ctxt, XML_ERR_ENTITY_LOOP, NULL);\n+        while (ctxt->inputNr > 1)\n+            xmlFreeInputStream(inputPop(ctxt));\n+\treturn(-1);\n+    }\n     ret = inputPush(ctxt, input);\n     if (ctxt->instate == XML_PARSER_EOF)\n         return(-1);\n@@ -7916,8 +7923,10 @@ xmlParsePEReference(xmlParserCtxtPtr ctxt)\n \t\treturn;\n \n \t    input = xmlNewEntityInputStream(ctxt, entity);\n-\t    if (xmlPushInput(ctxt, input) < 0)\n+\t    if (xmlPushInput(ctxt, input) < 0) {\n+                xmlFreeInputStream(input);\n \t\treturn;\n+            }\n \n \t    if (entity->etype == XML_EXTERNAL_PARAMETER_ENTITY) {\n                 /*"
        },
        {
          "filename": "result/errors/759579.xml",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "result/errors/759579.xml.err",
          "status": "added",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -0,0 +1,6 @@\n+Entity: line 2: parser error : Detected an entity reference loop\n+        %z; %z; %z; %z; %z;\n+           ^\n+Entity: line 2: \n+        %z; %z; %z; %z; %z;\n+           ^"
        },
        {
          "filename": "result/errors/759579.xml.str",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+Entity: line 2: parser error : Detected an entity reference loop\n+        %z; %z; %z; %z; %z;\n+           ^\n+Entity: line 2: \n+        %z; %z; %z; %z; %z;\n+           ^\n+./test/errors/759579.xml : failed to parse"
        },
        {
          "filename": "test/errors/759579.xml",
          "status": "added",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -0,0 +1,11 @@\n+<!DOCTYPE doc [\n+    <!ENTITY % z '\n+        &#37;z; &#37;z; &#37;z; &#37;z; &#37;z;\n+        &#37;z; &#37;z; &#37;z; &#37;z; &#37;z;\n+        &#37;z; &#37;z; &#37;z; &#37;z; &#37;z;\n+        &#37;z; &#37;z; &#37;z; &#37;z; &#37;z;\n+        &#37;z; &#37;z; &#37;z; &#37;z; &#37;z;\n+    '>\n+    %z;\n+]>\n+<doc/>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "86401cc3d293d6ea3c4552885e3cadcd952021d1",
            "date": "2025-01-07T18:01:57Z",
            "author_login": "nwellnhof"
          },
          {
            "sha": "c0c69cb868d4e5b9682c7c4ac9c724055323ce0d",
            "date": "2025-01-07T17:55:35Z",
            "author_login": "nwellnhof"
          },
          {
            "sha": "a5be2cc30315751d39be53f6cefcbd72491cf5cd",
            "date": "2025-01-04T21:52:19Z",
            "author_login": "nwellnhof"
          },
          {
            "sha": "f22707f42b27d3273d5ad900e6a13387a4f0c471",
            "date": "2024-12-30T22:21:56Z",
            "author_login": "nwellnhof"
          },
          {
            "sha": "ca8191602309fcdfc07d432ec643c1b565327654",
            "date": "2025-01-03T19:50:08Z",
            "author_login": "nwellnhof"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-835",
    "description": "parser.c in libxml2 before 2.9.5 does not prevent infinite recursion in parameter entities.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-11-23T21:29:00.437",
    "last_modified": "2024-11-21T03:17:16.070",
    "fix_date": "2017-07-25T12:59:49Z"
  },
  "references": [
    {
      "url": "http://xmlsoft.org/news.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://blog.clamav.net/2018/07/clamav-01001-has-been-released.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugzilla.gnome.org/show_bug.cgi?id=759579",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/GNOME/libxml2/commit/899a5d9f0ed13b8e32449a08a361e0de127dd961",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2017/11/msg00041.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/04/msg00004.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3739-1/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://xmlsoft.org/news.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://blog.clamav.net/2018/07/clamav-01001-has-been-released.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.gnome.org/show_bug.cgi?id=759579",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/GNOME/libxml2/commit/899a5d9f0ed13b8e32449a08a361e0de127dd961",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4%40%3Cissues.bookkeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2017/11/msg00041.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/04/msg00004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3739-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:09.748692",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libxml2",
    "owner": "GNOME",
    "created_at": "2012-06-03T12:37:38Z",
    "updated_at": "2025-01-07T18:15:28Z",
    "pushed_at": "2025-01-07T18:15:22Z",
    "size": 33229,
    "stars": 612,
    "forks": 372,
    "open_issues": 0,
    "watchers": 612,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 7666847,
      "RPGLE": 880308,
      "HTML": 590791,
      "Python": 292950,
      "C++": 172432,
      "M4": 48743,
      "Shell": 48293,
      "CMake": 38875,
      "JavaScript": 29341,
      "Meson": 24533,
      "Makefile": 22991,
      "XSLT": 17980,
      "Batchfile": 15298,
      "Clean": 6801,
      "PowerShell": 1722,
      "Dockerfile": 1377,
      "PHP": 1319,
      "Max": 296
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:44:34.046242"
  }
}