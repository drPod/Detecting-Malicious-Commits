{
  "cve_id": "CVE-2017-18594",
  "github_data": {
    "repository": "nmap/nmap",
    "fix_commit": "350bbe0597d37ad67abe5fef8fba984707b4e9ad",
    "related_commits": [
      "350bbe0597d37ad67abe5fef8fba984707b4e9ad",
      "350bbe0597d37ad67abe5fef8fba984707b4e9ad"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "350bbe0597d37ad67abe5fef8fba984707b4e9ad",
      "commit_date": "2018-11-29T17:42:09Z",
      "author": {
        "login": "bonsaiviking",
        "type": "User",
        "stats": {
          "total_commits": 3314,
          "average_weekly_commits": 5.036474164133739,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 472
        }
      },
      "commit_message": {
        "title": "Avoid a crash (double-free) when SSH connection fails",
        "length": 53,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "nse_libssh2.cc",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -12,7 +12,6 @@ extern \"C\" {\n }\n #include \"nse_lua.h\"\n \n-#include \"nse_debug.h\"\n #include \"nse_nsock.h\"\n #include \"nse_utility.h\"\n \n@@ -295,6 +294,7 @@ static int do_session_handshake (lua_State *L, int status, lua_KContext ctx) {\n \n     if (rc) {\n         libssh2_session_free(sshu->session);\n+        sshu->session = NULL;\n         return luaL_error(L, \"Unable to complete libssh2 handshake.\");\n     }\n \n@@ -478,7 +478,7 @@ static int userauth_list (lua_State *L, int status, lua_KContext ctx) {\n }\n \n /*\n-* Returns list of supported authenication methods\n+* Returns list of supported authentication methods\n */\n static int l_userauth_list (lua_State *L) {\n     return userauth_list(L, 0, 0);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6f72b2ea434d91a97f1197ba2c306e8d994af860",
            "date": "2025-01-17T16:27:17Z",
            "author_login": "bonsaiviking"
          },
          {
            "sha": "3b8a780c43c99ed2cbf1c314bfe88b325448d700",
            "date": "2025-01-17T16:27:17Z",
            "author_login": "bonsaiviking"
          },
          {
            "sha": "390e0266db49d2658e3a3f9b1fd6927fa3379f25",
            "date": "2025-01-16T23:00:13Z",
            "author_login": "bonsaiviking"
          },
          {
            "sha": "3584adf32d81552df56abfaac36b8f96dbb7c2cd",
            "date": "2025-01-06T21:25:47Z",
            "author_login": "bonsaiviking"
          },
          {
            "sha": "fabe04887d577f61f693c341cf6f964cd79ad59a",
            "date": "2025-01-06T21:25:20Z",
            "author_login": "bonsaiviking"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-415",
    "description": "nse_libssh2.cc in Nmap 7.70 is subject to a denial of service condition due to a double free when an SSH connection fails, as demonstrated by a leading \\n character to ssh-brute.nse or ssh-auth-methods.nse.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-08-29T00:15:10.467",
    "last_modified": "2024-11-21T03:20:28.903",
    "fix_date": "2018-11-29T17:42:09Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00073.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00075.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/AMatchandaHaystack/Research/blob/master/Nmap%26libsshDF",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nmap/nmap/commit/350bbe0597d37ad67abe5fef8fba984707b4e9ad",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nmap/nmap/issues/1077",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nmap/nmap/issues/1227",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://seclists.org/nmap-announce/2019/0",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://seclists.org/nmap-dev/2018/q2/45",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00073.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-09/msg00075.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/AMatchandaHaystack/Research/blob/master/Nmap%26libsshDF",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nmap/nmap/commit/350bbe0597d37ad67abe5fef8fba984707b4e9ad",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nmap/nmap/issues/1077",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nmap/nmap/issues/1227",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://seclists.org/nmap-announce/2019/0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://seclists.org/nmap-dev/2018/q2/45",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:57.295227",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "nmap",
    "owner": "nmap",
    "created_at": "2012-03-09T14:47:43Z",
    "updated_at": "2025-01-26T07:13:07Z",
    "pushed_at": "2025-01-17T16:30:06Z",
    "size": 111201,
    "stars": 10505,
    "forks": 2443,
    "open_issues": 907,
    "watchers": 10505,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 10588042,
      "Lua": 8118407,
      "C++": 4876252,
      "Shell": 1277441,
      "Python": 1213888,
      "Makefile": 524354,
      "Roff": 319183,
      "CMake": 247872,
      "M4": 247247,
      "Perl": 106652,
      "Ada": 89080,
      "HTML": 68978,
      "C#": 55623,
      "Pascal": 42411,
      "RPGLE": 41861,
      "NSIS": 30089,
      "Assembly": 27595,
      "DIGITAL Command Language": 27305,
      "Clean": 22718,
      "Lex": 17129,
      "Batchfile": 3580,
      "Java": 2420,
      "Emacs Lisp": 2038,
      "Objective-C": 1913,
      "SAS": 1847,
      "Module Management System": 1545,
      "Awk": 750,
      "BitBake": 58
    },
    "commit_activity": {
      "total_commits_last_year": 259,
      "avg_commits_per_week": 4.980769230769231,
      "days_active_last_year": 76
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:22:24.754105"
  }
}