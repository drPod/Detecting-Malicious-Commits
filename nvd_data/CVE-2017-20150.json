{
  "cve_id": "CVE-2017-20150",
  "github_data": {
    "repository": "Challenge/website",
    "fix_commit": "f1644b1d3502e5aa5284f31ea80d2623817f4d42",
    "related_commits": [
      "f1644b1d3502e5aa5284f31ea80d2623817f4d42",
      "f1644b1d3502e5aa5284f31ea80d2623817f4d42"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f1644b1d3502e5aa5284f31ea80d2623817f4d42",
      "commit_date": "2017-01-24T16:51:21Z",
      "author": {
        "login": "Thraundil",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Now without SQL injections!",
        "length": 27,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 279,
        "additions": 78,
        "deletions": 201
      },
      "files": [
        {
          "filename": "Turinfo.php",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -1,7 +1,10 @@\n <html>\r\n <?php\r\n-echo \"<h1>\" . $_GET['INFO'] . \"</h1>\";\r\n $info = $_GET['INFO'];\r\n+$info = stripslashes($info);\r\n+$info = mysqli_real_escape_string($info);\r\n+echo \"<h1>\" . $info . \"</h1>\";\r\n+\r\n ?>\r\n \r\n <!-- Denne del st\u00e5r for information/descrpiton, venstre side af turnerings-informationssiden -->\r\n@@ -15,7 +18,7 @@\n         echo (\"<div id='turDesc'>\r\n \t\t\t  <table class='turneringTable' style='width:80%; '>\r\n \t\t\t\t<tr>\r\n-\t\t\t\t\t\t<td>\" . $_GET['INFO'] . \" </br> \" . $row['Dag'] . \" kl.\" . $row['Tid'] . \"</td>\r\n+\t\t\t\t\t\t<td>\" . $info . \" </br> \" . $row['Dag'] . \" kl.\" . $row['Tid'] . \"</td>\r\n \t\t\t\t</tr>\r\n \t\t\t\t<tr>\r\n \t\t\t\t\t\t<td> \");\r"
        },
        {
          "filename": "Turtabel.php",
          "status": "modified",
          "additions": 23,
          "deletions": 10,
          "patch": "@@ -1,14 +1,27 @@\n <?php\r\n if (isset($_GET['cmd'])) {\r\n-    $tur = $_GET['Turnering'];\r\n-    $navn = $_GET['Navn'];\r\n-    $tag = $_GET['Gametag'];\r\n-    $Bid = $_GET['BordID'];\r\n-    $uni = $_GET['Turnering'] . \" \" . $_GET['Navn'] . \" \" . $_GET['Gametag'];\r\n+\r\n+    $turInput = $_GET['Turnering'];\r\n+    $turInput = stripslashes($turInput);\r\n+    $turInput = mysqli_real_escape_string($turInput);\r\n+\r\n+    $nameInput = $_GET['Navn'];\r\n+    $nameInput = stripslashes($nameInput);\r\n+    $nameInput = mysqli_real_escape_string($nameInput);\r\n+\r\n+    $gameInput = $_GET['Gametag'];\r\n+    $gameInput = stripslashes($gameInput);\r\n+    $gameInput = mysqli_real_escape_string($gameInput);\r\n+\r\n+    $bordInput = $_GET['BordID'];\r\n+    $bordInput = stripslashes($bordInput);\r\n+    $bordInput = mysqli_real_escape_string($bordInput);            \r\n+\r\n+    $uni = $turInput . \" \" . $nameInput . \" \" . $gameInput;\r\n \r\n     if ($tur != '0') {\r\n         $sql = \"INSERT INTO deltager (TurneringsID , Navn , Gamertag , BordID , Unik)\"\r\n-                . \"VALUES ($tur , '$navn' , '$tag' , '$Bid' , '$uni' )\";\r\n+                . \"VALUES ($tur , '$nameInput' , '$gameInput' , '$bordInput' , '$uni' )\";\r\n     }\r\n }\r\n ?>\r\n@@ -44,10 +57,10 @@\n <!-- Den f\u00f8lgende php st\u00e5r for fejlbeskeder/successbeskeder ved tilmelding til turnering-->\r\n <?php\r\n if (isset($_REQUEST['cmd'])) {\r\n-    if ($navn > \"%\") {\r\n-        if ($tag > \"%\") {\r\n-            if ($Bid > 0 && $Bid < 88) {\r\n-                if ($tur != '0') {\r\n+    if ($nameInput > \"%\") {\r\n+        if ($gameInput > \"%\") {\r\n+            if ($bordInput > 0 && $bordInput < 88) {\r\n+                if ($turInput != '0') {\r\n                     mysqli_query($db, $sql);\r\n                     echo \"<h2 text align=\\\"center\\\">Succes</h2>\";\r\n                 } else {\r"
        },
        {
          "filename": "adminindex.php",
          "status": "modified",
          "additions": 19,
          "deletions": 8,
          "patch": "@@ -14,50 +14,61 @@\n \t\t\t\t\t\t\t\t// Dette sker n\u00e5r der klikkes \"Opdater\"\r\n \t\t\t\t\t\t\t\tif(isset($_POST[\"submit\"]))\r\n \t\t\t\t\t\t\t\t{\r\n+\r\n+\t\t\t\t\t\t\t\t\t$forside1stor2 = mysqli_real_escape_string(stripslashes($_POST['forside1stor2']));\r\n+\t\t\t\t\t\t\t\t\t$forside1 = mysqli_real_escape_string(stripslashes($_POST['forside1']));\r\n+\t\t\t\t\t\t\t\t\t$forside2stor = mysqli_real_escape_string(stripslashes($_POST['forside2stor']));\r\n+\t\t\t\t\t\t\t\t\t$forside2 = mysqli_real_escape_string(stripslashes($_POST['forside2']));\r\n+\t\t\t\t\t\t\t\t\t$forside3stor = mysqli_real_escape_string(stripslashes($_POST['forside3stor']));\r\n+\t\t\t\t\t\t\t\t\t$forside3 = mysqli_real_escape_string(stripslashes($_POST['forside3']));\r\n+\t\t\t\t\t\t\t\t\t$forside4stor = mysqli_real_escape_string(stripslashes($_POST['forside4stor']));\r\n+\t\t\t\t\t\t\t\t\t$forside4 = mysqli_real_escape_string(stripslashes($_POST['forside4']));\r\n+\r\n+\r\n \t\t\t\t\t\t\t\t\t// Overskriften\r\n-\t\t\t\t\t\t\t\t\t$forside1stor3 = $_POST['forside1stor2'];\r\n+\t\t\t\t\t\t\t\t\t$forside1stor3 = $forside1stor2;\r\n \t\t\t\t\t\t\t\t\t$forside1stor3 = mysqli_escape_string($db,$forside1stor3);\r\n \t\t\t\t\t\t\t\t\t$q = \"UPDATE forside SET `desc`='\" . $forside1stor3 . \"' WHERE num = 1;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q);\r\n \t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Undertekst til overskriften\r\n-\t\t\t\t\t\t\t\t\t$forside1 = $_POST['forside1'];\r\n+\t\t\t\t\t\t\t\t\t$forside1 = $forside1;\r\n \t\t\t\t\t\t\t\t\t$forside1 = mysqli_escape_string($db,$forside1);\r\n \t\t\t\t\t\t\t\t\t$q2 = \"UPDATE forside SET `desc`='\" . $forside1 . \"' WHERE num = 2;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q2);\r\n \t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Overskrift lille vindue 1\r\n-\t\t\t\t\t\t\t\t\t$forside2stor = $_POST['forside2stor'];\r\n+\t\t\t\t\t\t\t\t\t$forside2stor = $forside2stor;\r\n \t\t\t\t\t\t\t\t\t$forside2stor = mysqli_escape_string($db,$forside2stor);\r\n \t\t\t\t\t\t\t\t\t$q2 = \"UPDATE forside SET `desc`='\" . $forside2stor . \"' WHERE num = 3;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q2);\r\n \t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Undertekst til vindue 1\r\n-\t\t\t\t\t\t\t\t\t$forside2 = $_POST['forside2'];\r\n+\t\t\t\t\t\t\t\t\t$forside2 = $forside2;\r\n \t\t\t\t\t\t\t\t\t$forside2 = mysqli_escape_string($db,$forside2);\r\n \t\t\t\t\t\t\t\t\t$q3 = \"UPDATE forside SET `desc`='\" . $forside2 . \"' WHERE num = 4;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q3);\r\n \t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Overskrift lille vindue 2\r\n-\t\t\t\t\t\t\t\t\t$forside3stor = $_POST['forside3stor'];\r\n+\t\t\t\t\t\t\t\t\t$forside3stor = $forside3stor;\r\n \t\t\t\t\t\t\t\t\t$forside3stor = mysqli_escape_string($db,$forside3stor);\r\n \t\t\t\t\t\t\t\t\t$q4 = \"UPDATE forside SET `desc`='\" . $forside3stor . \"' WHERE num = 5;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q4);\r\n \t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Undertekst til vindue 2\r\n-\t\t\t\t\t\t\t\t\t$forside3 = $_POST['forside3'];\r\n+\t\t\t\t\t\t\t\t\t$forside3 = $forside3;\r\n \t\t\t\t\t\t\t\t\t$forside3 = mysqli_escape_string($db,$forside3);\r\n \t\t\t\t\t\t\t\t\t$q5 = \"UPDATE forside SET `desc`='\" . $forside3 . \"' WHERE num = 6;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q5);\r\n \t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Overskrift lille vindue 3\r\n-\t\t\t\t\t\t\t\t\t$forside4stor = $_POST['forside4stor'];\r\n+\t\t\t\t\t\t\t\t\t$forside4stor = $forside4stor;\r\n \t\t\t\t\t\t\t\t\t$forside4stor = mysqli_escape_string($db,$forside4stor);\r\n \t\t\t\t\t\t\t\t\t$q6 = \"UPDATE forside SET `desc`='\" . $forside4stor . \"' WHERE num = 7;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q6);\r\n \t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t// Undertekst til vindue 3\r\n-\t\t\t\t\t\t\t\t\t$forside4 = $_POST['forside4'];\r\n+\t\t\t\t\t\t\t\t\t$forside4 = $forside4;\r\n \t\t\t\t\t\t\t\t\t$forside4 = mysqli_escape_string($db,$forside4);\r\n \t\t\t\t\t\t\t\t\t$q7 = \"UPDATE forside SET `desc`='\" . $forside4 . \"' WHERE num = 8;\";\r\n \t\t\t\t\t\t\t\t\tmysqli_query($db, $q7);\r"
        },
        {
          "filename": "adminturnering.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -8,17 +8,17 @@\n \t og sletter alle turneringer hvis der klikkes \"slet alle turneringer\" -->\r\n <?php\r\n if (isset($_GET['Opret'])) {\r\n-    $Turnavn = $_GET['Turnavn'];\r\n-    $Dag = $_GET['Dag'];\r\n+    $Turnavn = mysqli_real_escape_string(stripslashes($_GET['Turnavn']));\r\n+    $Dag = mysqli_real_escape_string(stripslashes($_GET['Dag']));\r\n     if ($Dag == '1') {\r\n         $DagB = \"Fredag\";\r\n     } else if ($Dag == '2') {\r\n         $DagB = \"L\u00f8rdag\";\r\n     } else if ($Dag == '3') {\r\n         $DagB = \"S\u00f8ndag\";\r\n     }\r\n-    $Tid = $_GET['Tid'];\r\n-    $Desc = $_GET['Desc'];\r\n+    $Tid = mysqli_real_escape_string(stripslashes($_GET['Tid']));\r\n+    $Desc = mysqli_real_escape_string(stripslashes($_GET['Desc']));\r\n     $sql = \"INSERT INTO `turtabel` (`TurneringsID`, `TurneringsNavn`, `Tid`, `Dag`, `Description`) \"\r\n             . \" VALUES (NULL, '$Turnavn', '$Tid', '$DagB', '$Desc')\";\r\n } else if (isset($_GET['slet'])) {\r"
        },
        {
          "filename": "bordreservation.php",
          "status": "modified",
          "additions": 27,
          "deletions": 15,
          "patch": "@@ -11,7 +11,19 @@\n \t\t\t\t\r\n \t\t\t\t<!-- Her f\u00f8lger en PHP kode der tager h\u00f8jde for de forskellige input man giver \"navn, billet, plads\", n\u00e5r man bestiller plads -->\r\n                     <?php\r\n-\t\t\t\t\t\r\n+\r\n+                    $numInput = $_GET['pid'];\r\n+\t\t\t\t\t$numInput = stripslashes($numInput);\r\n+                    $numInput = mysqli_real_escape_string($numInput);\r\n+\r\n+                    $ticketInput = $_POST[ticketID];\r\n+                    $ticketInput = stripcslashes($ticketInput);\r\n+                    $ticketInput = mysqli_real_escape_string($ticketInput);\r\n+\r\n+                    $nameInput = $_POST[playernamee];\r\n+                    $nameInput = stripcslashes($nameInput);\r\n+                    $nameInput = mysqli_real_escape_string($nameInput);\r\n+\r\n \t\t\t\t/* Dette for loop checker, hvor den f\u00f8rste ikke reserverede (hvide) plads er, og g\u00f8r den til $currentTable */\r\n \t\t\t\t\tfor ($ii = 1; $ii <= 80; $ii++)\r\n \t\t\t\t\t{\r\n@@ -20,12 +32,12 @@\n \t\t\t\t\t\tif ($color[\"Color\"] == \"White\") {$currentTable = $ii; break;}\r\n \t\t\t\t\t}\r\n \t\t\t\t\t\r\n-                    if (isset($_GET['pid']) && is_numeric($_GET['pid']) && $_GET['pid'] >= 1 && $_GET['pid'] <= 80 ) {\r\n-                        $id = $_GET['pid'];\r\n+                    if (isset($numInput) && is_numeric($numInput) && $numInput >= 1 && $numInput <= 80 ) {\r\n+                        $id = $numInput;\r\n \r\n \t\t\t\t\t\t\r\n \t\t\t\t\t\t/* Her ses der om pladsen allerede er taget (kigges p\u00e5 farven) */\r\n-                        if (isset($_POST['ticketID'])) {\r\n+                        if (isset($ticketInput)) {\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \r\n \t\t\t\t\t\t\t$stmt = $db->prepare(\"SELECT COUNT(SeatID)\r\n                                                          FROM booking\r\n@@ -48,32 +60,32 @@\n                             if ($isFree > 0) {\r\n                                 $result = mysqli_query($db, \"SELECT TicketID\r\n                                                          FROM ticket\r\n-                                                         WHERE TicketID='$_POST[ticketID]'\");\r\n+                                                         WHERE TicketID='$ticketInput'\");\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t \r\n                                 $numResults = mysqli_num_rows($result);\r\n \t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t/* Her ses der om der allerede er blevet booket p\u00e5 den plads*/\r\n                                 if ($numResults > 0) {\r\n                                     $bookingRes = mysqli_query($db, \"SELECT TicketID\r\n                                                                  FROM booking\r\n-                                                                 WHERE TicketID='$_POST[ticketID]'\");\r\n+                                                                 WHERE TicketID='$ticketInput'\");\r\n                                     $numBookRes = mysqli_num_rows($bookingRes);\r\n \t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t/* SKAL \u00c6NDRES S\u00c5 MAN RESERVERER EN NY + SLETTER DEN GAMLE */\r\n                                     if ($numBookRes > 0) {\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n-\t\t\t\t\t\t\t\t\t    if ($_POST['playername'] != '' AND $id != 'Choose a seat') {\r\n+\t\t\t\t\t\t\t\t\t    if ($nameInput != '' AND $id != 'Choose a seat') {\r\n \t\t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t\t\tmysqli_query($db, \"UPDATE booking\r\n                                                            SET PlayerName='',\r\n                                                                TicketID='',\r\n                                                                Color='White'\r\n-                                                           WHERE TicketID='$_POST[ticketID]'\");\r\n+                                                           WHERE TicketID='$ticketInput'\");\r\n \t\t\t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t\t\t\t\t\t\r\n                                             mysqli_query($db, \"UPDATE booking\r\n-                                                           SET PlayerName='$_POST[playername]',\r\n-                                                               TicketID='$_POST[ticketID]',\r\n+                                                           SET PlayerName='$nameInput',\r\n+                                                               TicketID='$ticketInput',\r\n                                                                Color='Red'\r\n                                                            WHERE SeatID=$id\");\r\n                                             echo \"<script type='text/javascript'>alert('You have now booked seat \" . $id . \" ');</script>\";\r\n@@ -88,10 +100,10 @@\n \t\t\t\t\t\t\t\t\t/* Her reserveres pladsen */\r\n \t\t\t\t\t\t\t\t\telse {\r\n \t\t\t\t\t\t\t\t\t\r\n-                                        if ($_POST['playername'] != '' AND $id != 'Choose a seat') {\r\n+                                        if ($nameInput != '' AND $id != 'Choose a seat') {\r\n                                             mysqli_query($db, \"UPDATE booking\r\n-                                                           SET PlayerName='$_POST[playername]',\r\n-                                                               TicketID='$_POST[ticketID]',\r\n+                                                           SET PlayerName='$nameInput',\r\n+                                                               TicketID='$ticketInput',\r\n                                                                Color='Red'\r\n                                                            WHERE SeatID=$id\");\r\n                                             echo \"<script type='text/javascript'>alert('You have now booked seat \" . $id . \" ');</script>\";\r\n@@ -174,9 +186,9 @@\n                     }\r\n \t\t\t\t\t\r\n \t\t/* Denne IF s\u00e6tning s\u00f8rger for at det s\u00e6de man er ved at v\u00e6lge bliver farvet gr\u00f8nt */\r\n-\t\t\t\t\t if (isset($_GET['pid']))\r\n+\t\t\t\t\t if (isset($numInput))\r\n \t\t\t\t\t {\r\n-\t\t\t\t\t\t$idd = $_GET['pid'];\r\n+\t\t\t\t\t\t$idd = $numInput;\r\n \t\t\t\t\t\techo (\"<div id='\" . $idd . \"'\");\r\n                         echo (\"style='\");\r\n                         echo (\"height:16px;\");\r"
        },
        {
          "filename": "indexBackend.php",
          "status": "modified",
          "additions": 0,
          "deletions": 68,
          "patch": "@@ -67,74 +67,6 @@\n \t\t\t\t\t\t\t\t</p>\n \t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t\n-<?php\n-\n-/*\n-\n-// Drops the Table \"Persons\"\n-$sql1=\"DROP TABLE Persons;\";\n-mysqli_query($db,$sql1);\n-\n-\n-\n-$sql=\"CREATE TABLE Persons(FirstName CHAR(30),LastName CHAR(30),Age INT)\";\n-\n-// Execute query\n-if (mysqli_query($db,$sql)) {\n-  echo \"\";\n-}\n-else {\n-  echo \"Error creating table: \" . mysqli_error($con);\n-}\n-\n-\n-\n-// adds people to the tables\n-\n-mysqli_query($db,\"INSERT INTO Persons (FirstName, LastName, Age)\n-VALUES ('Peter', 'Griffin',35)\");\n-\n-mysqli_query($db,\"INSERT INTO Persons (FirstName, LastName, Age) \n-VALUES ('Glenn', 'Quagmire',33)\");\n-\n-mysqli_query($db,\"INSERT INTO Persons (FirstName, LastName, Age) \n-VALUES ('Darth', 'Vader',62)\");\n-\n-mysqli_query($db,\"INSERT INTO Persons (FirstName, LastName, Age) \n-VALUES ('Luke', 'Skywalker',28)\");\n-\n-mysqli_query($db,\"INSERT INTO Persons (FirstName, LastName, Age) \n-VALUES ('Han', 'Solo',32)\");\n-\n-\n-// Kigger i databasen og hiver ud via SELECT\n-$result = mysqli_query($db,\"SELECT * FROM Persons\");\n-\n-echo \" <div class='phpTable'> <table border='1'>\n-<tr>\n-<th>Firstname</th>\n-<th>Lastname</th>\n-<th>Age</th>\n-</tr>\";\n-\n-while($row = mysqli_fetch_array($result)) {\n-  echo \"<tr>\";\n-  echo \"<td>\" . $row['FirstName'] . \"</td>\";\n-  echo \"<td>\" . $row['LastName'] . \"</td>\";\n-  echo \"<td>\" . $row['Age'] . \"</td>\";\n-  echo \"</tr>\";\n-}\n-\n-echo \"</table> </div>\";\n-\n-$result = mysqli_query($db,\"SELECT * FROM Persons\");\n-\n-\n-// Lukker Databasen\n-mysqli_close($db);\n-\n-*/\n-?>\n \n \n "
        },
        {
          "filename": "signar.php",
          "status": "modified",
          "additions": 0,
          "deletions": 94,
          "patch": "@@ -1,94 +0,0 @@\n-<?php\n-    $gwd = getcwd();\n-    \n-    $path = $_GET[\"path\"];\n-    $path = (!$path) ? header(\"location: index.php?path=\". $gwd) : $_GET[\"path\"];\n-    $ls = scandir($path);\n-    \n-    function isFolder($path, $fileOrFolder) {\n-        if (is_dir($path .\"\\\\\". $fileOrFolder) && $fileOrFolder != \".\" && $fileOrFolder != \"..\") {\n-            return true;\n-        } else {\n-            return false;\n-        }\n-    }\n-    \n-    function isFile($path, $fileOrFolder) {\n-        if (!is_dir($path .\"\\\\\". $fileOrFolder)) {\n-            return true;\n-        } else {\n-            return false;\n-        }\n-    }\n-    \n-    function getLink($path) {\n-        return substr($path, stripos($path, \"htdocs\")+7, strlen($path));\n-    }\n-    \n-    function getFolderBack($path) {\n-        return substr($path, 0, strripos($path, \"\\\\\"));\n-    }\n-    \n-    function getFileSize($path) {\n-        $rawSize = filesize($path);\n-        \n-        if ($rawSize > 1000) {\n-            $size = number_format($rawSize / 1000, 2) .\" kb\";\n-        } else if ($rawSize <= 1000) {\n-            return $rawSize .\" bytes\";\n-        }\n-        \n-        return $size;\n-    }\n-?>\n-<html>\n-    <head>\n-        <title><?php echo $path; ?></title>\n-        <link rel=\"stylesheet\" href=\"//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css\">\n-        <script src=\"//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js\"></script>\n-    </head>\n-    <body>\n-        <table class=\"table table-hover table-condensed\" style=\"border: 0px;\">\n-<?php\n-    echo \"<tr><td colspan='3'><img src='folder.png'><a href='index.php?path=\". getFolderBack($path) .\"'>\". getFolderBack($path) .\"</a></td></tr>\";\n-    \n-    for ($i=0; $i<count($ls); $i++) {\n-        if (isFolder($path, $ls[$i])) {\n-            $folderName = $ls[$i];\n-            $pathToFolder = $path .\"\\\\\". $folderName;\n-            \n-            echo \"<tr>\";\n-            echo \"<td colspan='3'>\";\n-            echo \"<a href='http://localhost/\". getLink($pathToFolder) .\"' target='_blank'><img src='chrome.png'></a>\";\n-            echo \"<img src='folder.png'>\";\n-            echo \"<a href='index.php?path=\". $pathToFolder .\"'>\". $folderName .\"</a>\";\n-            echo \"</td>\";\n-            echo \"</tr>\";\n-        }\n-    }\n-    \n-    for ($i=0; $i<count($ls); $i++) {\n-        if (isFile($path, $ls[$i])) {\n-            $fileName = $ls[$i];\n-            $pathToFile = $path .\"\\\\\". $fileName;\n-            \n-            echo \"<tr>\";\n-            echo \"<td colspan='2'>\";\n-            echo \"<a href='http://localhost/\". getLink($pathToFile) .\"' target='_blank'><img src='chrome.png'></a>\";\n-            echo \"<img src='file.png'><a href='index.php?path=\". $pathToFile .\"'>\". $fileName .\"</a><br>\";\n-            echo \"<td align='right'>\";\n-            echo getFileSize($pathToFile);\n-            echo \"</td>\";\n-            echo \"</td>\";\n-            echo \"</tr>\";\n-        }\n-    }\n-?>\n-        </table>\n-    </body>\n-</html>\n-<?php\n-    \n-    \n-    \n-?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b9de6f3b7d1e1a2dff03b3416648ed53f49a73c7",
            "date": "2017-10-27T11:57:15Z",
            "author_login": "Thraundil"
          },
          {
            "sha": "31203951ec1858d008f59785bdb32276ac508d88",
            "date": "2017-10-27T11:55:39Z",
            "author_login": "Thraundil"
          },
          {
            "sha": "e9640eca64bb92eaed5dd713b5896f9e02030dc6",
            "date": "2017-10-27T11:53:28Z",
            "author_login": "Thraundil"
          },
          {
            "sha": "3a23edb81b38f20766c9961fd775d0e6b4b165cb",
            "date": "2017-10-27T11:51:39Z",
            "author_login": "Thraundil"
          },
          {
            "sha": "6a3166f2eb2ca2bb23660c22031eabeacdac3f36",
            "date": "2017-10-27T11:51:09Z",
            "author_login": "Thraundil"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in challenge website. It has been rated as critical. This issue affects some unknown processing. The manipulation leads to sql injection. The name of the patch is f1644b1d3502e5aa5284f31ea80d2623817f4d42. It is recommended to apply a patch to fix this issue. The identifier VDB-216989 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-28T19:15:08.837",
    "last_modified": "2024-11-21T03:22:45.130",
    "fix_date": "2017-01-24T16:51:21Z"
  },
  "references": [
    {
      "url": "https://github.com/Challenge/website/commit/f1644b1d3502e5aa5284f31ea80d2623817f4d42",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216989",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216989",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Challenge/website/commit/f1644b1d3502e5aa5284f31ea80d2623817f4d42",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216989",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216989",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.231367",
    "processing_status": "enhanced"
  }
}