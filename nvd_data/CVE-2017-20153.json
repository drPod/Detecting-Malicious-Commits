{
  "cve_id": "CVE-2017-20153",
  "github_data": {
    "repository": "aerouk/imageserve",
    "fix_commit": "2ac3cd4f90b4df66874fab171376ca26868604c4",
    "related_commits": [
      "2ac3cd4f90b4df66874fab171376ca26868604c4",
      "2ac3cd4f90b4df66874fab171376ca26868604c4"
    ],
    "patch_url": "https://github.com/aerouk/imageserve/commit/2ac3cd4f90b4df66874fab171376ca26868604c4.patch",
    "fix_commit_details": {
      "sha": "2ac3cd4f90b4df66874fab171376ca26868604c4",
      "commit_date": "2017-03-01T02:19:53Z",
      "author": {
        "login": "ssl",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed XSS",
        "length": 155,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "public/protected/templates/viewer.phtml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -13,7 +13,7 @@\n         <meta name=\"twitter:site\" content=\"<?php echo TWITTER_HANDLE; ?>\" />\n         <meta name=\"twitter:title\" content=\"<?php echo $file . '.' . $type; ?>\" />\n         <meta name=\"twitter:image\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . $imgurl; ?>\" />\n-        <meta name=\"twitter:url\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI']; ?>\" />\n+        <meta name=\"twitter:url\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . htmlspecialchars($_SERVER['REQUEST_URI']); ?>\" />\n <?php } ?>\n     </head>\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "faeef8820c3e281101477a276387ab3e39001c83",
            "date": "2021-03-22T19:15:02Z",
            "author_login": "aerouk"
          },
          {
            "sha": "ed97393b60fdfd8a4128ad6f6b40c8a3027022ab",
            "date": "2017-10-23T12:35:28Z",
            "author_login": "aerouk"
          },
          {
            "sha": "8b233220207e7c7560f2bf30244f004b8ab1181e",
            "date": "2017-10-22T13:42:21Z",
            "author_login": "linuxgemini"
          },
          {
            "sha": "7eb7575ba00ae6c192d4f5b9264fc4153dd59fde",
            "date": "2017-03-01T02:41:49Z",
            "author_login": "aerouk"
          },
          {
            "sha": "2aecd26f2aeb1e57406a9d1601f167381167b7f0",
            "date": "2017-03-01T02:41:35Z",
            "author_login": "aerouk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability has been found in aerouk imageserve and classified as problematic. Affected by this vulnerability is an unknown functionality. The manipulation of the argument REQUEST_URI leads to cross site scripting. The attack can be launched remotely. The complexity of an attack is rather high. The exploitation appears to be difficult. The exploit has been disclosed to the public and may be used. The identifier of the patch is 2ac3cd4f90b4df66874fab171376ca26868604c4. It is recommended to apply a patch to fix this issue. The identifier VDB-217057 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-30T12:15:08.910",
    "last_modified": "2024-11-21T03:22:45.563",
    "fix_date": "2017-03-01T02:19:53Z"
  },
  "references": [
    {
      "url": "https://github.com/aerouk/imageserve/commit/2ac3cd4f90b4df66874fab171376ca26868604c4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aerouk/imageserve/pull/27",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217057",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217057",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aerouk/imageserve/commit/2ac3cd4f90b4df66874fab171376ca26868604c4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aerouk/imageserve/pull/27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217057",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217057",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.237306",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "imageserve",
    "owner": "aerouk",
    "created_at": "2014-08-01T13:50:21Z",
    "updated_at": "2024-10-01T19:32:57Z",
    "pushed_at": "2021-07-26T00:58:28Z",
    "size": 45,
    "stars": 128,
    "forks": 33,
    "open_issues": 4,
    "watchers": 128,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3390,
      "HTML": 2801,
      "CSS": 955
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:28:50.845005"
  }
}