{
  "cve_id": "CVE-2017-20156",
  "github_data": {
    "repository": "exciting-io/printer",
    "fix_commit": "5f8c715d6e2cc000f621a6833f0a86a673462136",
    "related_commits": [
      "5f8c715d6e2cc000f621a6833f0a86a673462136",
      "5f8c715d6e2cc000f621a6833f0a86a673462136"
    ],
    "patch_url": "https://github.com/exciting-io/printer/commit/5f8c715d6e2cc000f621a6833f0a86a673462136.patch",
    "fix_commit_details": {
      "sha": "5f8c715d6e2cc000f621a6833f0a86a673462136",
      "commit_date": "2017-07-08T10:32:01Z",
      "author": {
        "login": "lazyatom",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Patch shell injection vulnerability in prepare page",
        "length": 161,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/printer/jobs/prepare_page.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -3,6 +3,7 @@\n require \"printer/id_generator\"\n require \"printer/preview\"\n require \"timeout\"\n+require \"shellwords\"\n \n class Printer::Jobs::PreparePage\n   def self.queue\n@@ -36,7 +37,7 @@ def self.perform(url, width, id, kind=\"print\")\n   end\n \n   def self.save_url_to_path(url, width, path)\n-    cmd = \"phantomjs rasterise.js #{url} #{width} #{path}\"\n+    cmd = \"phantomjs rasterise.js #{url.shellescape} #{width} #{path}\"\n     run(cmd)\n   end\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1df647e4fab2375033c44b0a35c5fc25eee765b9",
            "date": "2023-10-20T09:35:12Z",
            "author_login": "lazyatom"
          },
          {
            "sha": "d90ccb6b6807544a6b7140b17d88d93393570802",
            "date": "2023-10-19T13:53:14Z",
            "author_login": "lazyatom"
          },
          {
            "sha": "7a366c5831ccc7c62f96b6c90cd436110851c746",
            "date": "2023-09-26T11:26:17Z",
            "author_login": "lazyatom"
          },
          {
            "sha": "ff1477b5a47f448f91b4dca0c342b17d970e1f14",
            "date": "2023-09-18T12:55:43Z",
            "author_login": "lazyatom"
          },
          {
            "sha": "1b58ae983124aecd6f9cbb910a6e8ce97ae7ec15",
            "date": "2023-09-18T12:46:19Z",
            "author_login": "lazyatom"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-77",
    "description": "A vulnerability was found in Exciting Printer and classified as critical. This issue affects some unknown processing of the file lib/printer/jobs/prepare_page.rb of the component Argument Handler. The manipulation of the argument URL leads to command injection. The patch is named 5f8c715d6e2cc000f621a6833f0a86a673462136. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217139.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-31T10:15:09.183",
    "last_modified": "2024-11-21T03:22:45.993",
    "fix_date": "2017-07-08T10:32:01Z"
  },
  "references": [
    {
      "url": "https://github.com/exciting-io/printer/commit/5f8c715d6e2cc000f621a6833f0a86a673462136",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exciting-io/printer/issues/56",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217139",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217139",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/exciting-io/printer/commit/5f8c715d6e2cc000f621a6833f0a86a673462136",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exciting-io/printer/issues/56",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217139",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217139",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.239917",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "printer",
    "owner": "exciting-io",
    "created_at": "2012-03-11T11:41:18Z",
    "updated_at": "2025-01-11T09:34:15Z",
    "pushed_at": "2023-10-20T09:35:53Z",
    "size": 700,
    "stars": 484,
    "forks": 73,
    "open_issues": 29,
    "watchers": 484,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 72938,
      "HTML": 25884,
      "C++": 10603,
      "JavaScript": 8506,
      "Shell": 6195,
      "SCSS": 3193,
      "Procfile": 80
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:57:11.806599"
  }
}