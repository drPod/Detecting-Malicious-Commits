{
  "cve_id": "CVE-2017-20159",
  "github_data": {
    "repository": "rf-/keynote",
    "fix_commit": "05be4356b0a6ca7de48da926a9b997beb5ffeb4a",
    "related_commits": [
      "05be4356b0a6ca7de48da926a9b997beb5ffeb4a",
      "05be4356b0a6ca7de48da926a9b997beb5ffeb4a"
    ],
    "patch_url": "https://github.com/rf-/keynote/commit/05be4356b0a6ca7de48da926a9b997beb5ffeb4a.patch",
    "fix_commit_details": {
      "sha": "05be4356b0a6ca7de48da926a9b997beb5ffeb4a",
      "commit_date": "2017-07-22T21:55:25Z",
      "author": {
        "login": "rf-",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Always escape quotes in attributes; support array attrs",
        "length": 413,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 32,
        "additions": 26,
        "deletions": 6
      },
      "files": [
        {
          "filename": "lib/keynote/rumble.rb",
          "status": "modified",
          "additions": 12,
          "deletions": 4,
          "patch": "@@ -323,10 +323,18 @@ def inspect; to_s.inspect end\n \n       def attrs_to_s\n         attributes.inject(\"\") do |res, (name, value)|\n-          if value\n-            value = (value == true) ? name : Rumble.html_escape(value)\n-            res << \" #{name}=\\\"#{value}\\\"\"\n-          end\n+          next unless value\n+\n+          value =\n+            if value.is_a?(Array)\n+              value.map { |val| Rumble.html_escape(val) }.join(\" \")\n+            elsif value == true\n+              name\n+            else\n+              Rumble.html_escape(value)\n+            end\n+\n+          res << \" #{name}=\\\"#{value.gsub('\"'.freeze, '&quot;'.freeze)}\\\"\"\n           res\n         end\n       end"
        },
        {
          "filename": "spec/rumble_spec.rb",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -67,11 +67,23 @@ def test_string_data\n \n   def test_hash_data\n     str = <<-HTML\n-      <div data-modal=\"true\" data-test=\"&quot;test&quot;\"></div>\n+      <div data-modal=\"true\" data-safe=\"&quot;&quot;&quot;\" data-unsafe=\"&quot;&amp;quot;&quot;\">\n+      </div>\n+    HTML\n+\n+    assert_rumble str do\n+      div data: { modal: true, safe: '\"&quot;\"'.html_safe, unsafe: '\"&quot;\"' }\n+    end\n+  end\n+\n+  def test_array_attrs\n+    str = <<-HTML\n+      <div class=\"hello &quot;uns&amp;amp;fe&quot; &quot;w&amp;rld&quot;\">\n+      </div>\n     HTML\n \n     assert_rumble str do\n-      div data: { modal: true, test: '\"test\"' }\n+      div class: [\"hello\", '\"uns&amp;fe\"', '\"w&amp;rld\"'.html_safe]\n     end\n   end\n "
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "cc6b10c1e9dfa274448b634de87e4d8cd0ba70d9",
            "date": "2025-01-13T18:38:14Z",
            "author_login": "palkan"
          },
          {
            "sha": "034f3a5f947506692c43b584656f5a79bcae312e",
            "date": "2025-01-13T18:11:38Z",
            "author_login": "palkan"
          },
          {
            "sha": "2c2850690b8145dd6475a166686f3a10fc9dbeb8",
            "date": "2025-01-10T22:02:21Z",
            "author_login": "palkan"
          },
          {
            "sha": "7867b968918669d550320719ff6060e5147801fe",
            "date": "2025-01-10T22:01:36Z",
            "author_login": "palkan"
          },
          {
            "sha": "13c255d0ddef3f6e059c6e856ba15ed6ca19a457",
            "date": "2025-01-10T21:55:51Z",
            "author_login": "palkan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in rf Keynote up to 0.x on Rails. It has been rated as problematic. Affected by this issue is some unknown functionality of the file lib/keynote/rumble.rb. The manipulation of the argument value leads to cross site scripting. The attack may be launched remotely. Upgrading to version 1.0.0 is able to address this issue. The patch is identified as 05be4356b0a6ca7de48da926a9b997beb5ffeb4a. It is recommended to upgrade the affected component. VDB-217142 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-31T11:15:10.750",
    "last_modified": "2024-11-21T03:22:46.417",
    "fix_date": "2017-07-22T21:55:25Z"
  },
  "references": [
    {
      "url": "https://github.com/rf-/keynote/commit/05be4356b0a6ca7de48da926a9b997beb5ffeb4a",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rf-/keynote/releases/tag/v1.0.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217142",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217142",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rf-/keynote/commit/05be4356b0a6ca7de48da926a9b997beb5ffeb4a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rf-/keynote/releases/tag/v1.0.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217142",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217142",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.240512",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "keynote",
    "owner": "rf-",
    "created_at": "2012-10-15T05:38:52Z",
    "updated_at": "2025-01-13T18:38:21Z",
    "pushed_at": "2025-01-13T18:40:42Z",
    "size": 152,
    "stars": 159,
    "forks": 11,
    "open_issues": 0,
    "watchers": 159,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 56820,
      "Makefile": 232
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:33:03.888361"
  }
}