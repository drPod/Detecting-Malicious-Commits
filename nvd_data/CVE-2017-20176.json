{
  "cve_id": "CVE-2017-20176",
  "github_data": {
    "repository": "ciubotaru/share-on-diaspora",
    "fix_commit": "fb6fae2f8a9b146471450b5b0281046a17d1ac8d",
    "related_commits": [
      "fb6fae2f8a9b146471450b5b0281046a17d1ac8d",
      "fb6fae2f8a9b146471450b5b0281046a17d1ac8d"
    ],
    "patch_url": "https://github.com/ciubotaru/share-on-diaspora/commit/fb6fae2f8a9b146471450b5b0281046a17d1ac8d.patch",
    "fix_commit_details": {
      "sha": "fb6fae2f8a9b146471450b5b0281046a17d1ac8d",
      "commit_date": "2017-08-21T20:55:51Z",
      "author": {
        "login": "Framartin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix reflected XSS in new_window.php",
        "length": 35,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
      },
      "files": [
        {
          "filename": "trunk/new_window.php",
          "status": "modified",
          "additions": 12,
          "deletions": 2,
          "patch": "@@ -42,6 +42,16 @@\n </style>\n \n <script type=\"text/javascript\">\n+// Use to prevent XSS\n+// Code from http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\n+// Use the browser's built-in functionality to quickly and safely escape\n+// the string\n+function escapeHtml(str) {\n+    var div = document.createElement('div');\n+    div.appendChild(document.createTextNode(str));\n+    return div.innerHTML;\n+}\n+\n function extras(a) {\n     var b = document.getElementById(\"remember\").checked;\n     var c = document.getElementById(\"markdown\").checked;\n@@ -252,7 +262,7 @@ function redirect() {\n         location.href = \"about\"\n     } else {\n         if (localStorage[\"remember\"] && localStorage[\"remember\"] === \"true\" && localStorage[\"lastPod\"] && redir !== \"false\") {\n-            document.getElementsByTagName('body')[0].innerHTML = \"Sharing <b>\" + title + \"</b> (\" + url + \") to \" + localStorage[\"lastPod\"];\n+            document.getElementsByTagName('body')[0].innerHTML = \"Sharing <b>\" + escapeHtml(title) + \"</b> (\" + escapeHtml(url) + \") to \" + escapeHtml(localStorage[\"lastPod\"]);\n             var a = \"http://\" + localStorage[\"lastPod\"] + \"/bookmarklet?url=\" + encodeURIComponent(url) + \"&title=\" + encodeURIComponent(title);\n             if (notes !== \"\") {\n                 a += \"&notes=\" + encodeURIComponent(notes)\n@@ -262,7 +272,7 @@ function redirect() {\n             return true\n         } else {\n             document.getElementById(\"sharetitle\").value = title;\n-            document.getElementById(\"shareurl\").innerHTML = url;\n+            document.getElementById(\"shareurl\").innerHTML = escapeHtml(url);\n             crealinks();\n             return false\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "332e198b69932d992d73a4815da333fe8afc6103",
            "date": "2021-04-23T18:06:41Z",
            "author_login": "ciubotaru"
          },
          {
            "sha": "d7ae7f35f113a586e58c51f40b1cfdaeff46c72e",
            "date": "2021-04-23T18:04:33Z",
            "author_login": "ciubotaru"
          },
          {
            "sha": "96e7ba089eeaa751ea7566dad712b5fa02a43c65",
            "date": "2021-04-23T17:52:28Z",
            "author_login": "ciubotaru"
          },
          {
            "sha": "8bbaddf4c267bb4895e0c40c932f7cba6c367da8",
            "date": "2019-05-17T08:09:39Z",
            "author_login": "ciubotaru"
          },
          {
            "sha": "6eb10a625a1f4a8f820656e64503ddbc2ba14ab8",
            "date": "2019-05-17T07:43:31Z",
            "author_login": "ciubotaru"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic was found in ciubotaru share-on-diaspora 0.7.9. This vulnerability affects unknown code of the file new_window.php. The manipulation of the argument title/url leads to cross site scripting. The attack can be initiated remotely. The name of the patch is fb6fae2f8a9b146471450b5b0281046a17d1ac8d. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-220204.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-06T04:15:08.043",
    "last_modified": "2024-11-21T03:22:48.790",
    "fix_date": "2017-08-21T20:55:51Z"
  },
  "references": [
    {
      "url": "https://github.com/ciubotaru/share-on-diaspora/commit/fb6fae2f8a9b146471450b5b0281046a17d1ac8d",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220204",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220204",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ciubotaru/share-on-diaspora/commit/fb6fae2f8a9b146471450b5b0281046a17d1ac8d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220204",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220204",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.990321",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "share-on-diaspora",
    "owner": "ciubotaru",
    "created_at": "2013-08-26T16:10:26Z",
    "updated_at": "2021-04-23T18:08:00Z",
    "pushed_at": "2021-05-10T02:52:56Z",
    "size": 2815,
    "stars": 7,
    "forks": 3,
    "open_issues": 2,
    "watchers": 7,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 115078,
      "JavaScript": 2056
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:29:30.525148"
  }
}