{
  "cve_id": "CVE-2017-20177",
  "github_data": {
    "repository": "joseconti/WangGuard",
    "fix_commit": "88414951e30773c8d2ec13b99642688284bf3189",
    "related_commits": [
      "88414951e30773c8d2ec13b99642688284bf3189",
      "88414951e30773c8d2ec13b99642688284bf3189"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "88414951e30773c8d2ec13b99642688284bf3189",
      "commit_date": "2017-01-18T12:41:38Z",
      "author": {
        "login": "igmoweb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed XSS Vulneraibility",
        "length": 367,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
      },
      "files": [
        {
          "filename": "wangguard-class-wp-users.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -226,7 +226,7 @@ function single_row( $row_data, $style = '' , $numposts) {\n \t\t\t\t\t} else {\n \t\t\t\t\t\t$url = esc_url( network_admin_url( add_query_arg( array( 'page' => 'wangguard_users_info' ), 'admin.php' ) ) );\n \t\t\t\t\t}\n-\t\t\t\t\t$arrayUrl = array ('userID' => $user_id, 'userIP' => $row_data->user_ip, '?TB_iframe' => 'true', 'width' => '900', 'height' => '550' );\n+\t\t\t\t\t$arrayUrl = array ('userID' => $user_id, '?TB_iframe' => 'true', 'width' => '900', 'height' => '550' );\n \t\t\t\t\t$final_user_info_url = esc_url( add_query_arg(  $arrayUrl , $url ));\n \t\t\t\t\t$cell_contents = \"<a class='thickbox' title='\" . __( 'Info about','wangguard') . \" {$row_data->first_name} {$row_data->last_name}' href='\" . $final_user_info_url . \"'><img class='alignnone size-full wp-image-2055' alt='Info about {$row_data->first_name} {$row_data->last_name}' src='\" . plugins_url( 'img/info-wgg.png' , __FILE__ ) . \"' width='15' height='15' /> \" . __('User Info', 'wangguard' ) . \"</a>\";\n \t\t\t\t\tbreak;"
        },
        {
          "filename": "wangguard-user-info.php",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -7,9 +7,12 @@ function wangguard_users_info() {\n \tglobal $wpdb,$wangguard_nonce, $wangguard_api_key, $blog_id;\n \tif ( !current_user_can('level_10') )\n \t\tdie(__('Cheatin&#8217; uh?', 'wangguard'));\n-\t\t$userID = $_GET[\"userID\"];\n-\t\t$userIP = $_GET[\"userIP\"];\n+\t\t$userID = absint( $_GET[\"userID\"] );\n \t\t$user_info = get_userdata($userID);\n+\n+\t\t$table = $wpdb->base_prefix . 'wangguarduserstatus';\n+\t\t$userIP = $wpdb->get_var( $wpdb->prepare( \"SELECT user_ip FROM $table WHERE ID = %d\", $userID ) );\n+\t\t$userIP = $userIP ? $userIP : '';\n \t//$blogID = $user_info->primary_blog;\n \t//if ( function_exists( is_multisite() ) ) {\n \t//$blog_details = get_blog_details( array( 'blog_id' => $blogID ) );"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c1681eba6d7e8c17ff1393c6ee7edb043a01091f",
            "date": "2017-01-18T13:17:57Z",
            "author_login": "joseconti"
          },
          {
            "sha": "d6d8e915bf72d38c458eebcb9fbb2349f23b4ac3",
            "date": "2017-01-18T13:17:46Z",
            "author_login": "joseconti"
          },
          {
            "sha": "d6006aa0a4fd6409656f246b8ac5225e06462bfe",
            "date": "2017-01-18T12:45:30Z",
            "author_login": "igmoweb"
          },
          {
            "sha": "88414951e30773c8d2ec13b99642688284bf3189",
            "date": "2017-01-18T12:41:38Z",
            "author_login": "igmoweb"
          },
          {
            "sha": "68ec7ed0cea2db8ea05bce3289811b82abfc9600",
            "date": "2017-01-18T12:34:13Z",
            "author_login": "igmoweb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability, which was classified as problematic, has been found in WangGuard Plugin 1.8.0 on WordPress. Affected by this issue is the function wangguard_users_info of the file wangguard-user-info.php of the component WGG User List Handler. The manipulation of the argument userIP leads to cross site scripting. The attack may be launched remotely. The patch is identified as 88414951e30773c8d2ec13b99642688284bf3189. It is recommended to apply a patch to fix this issue. VDB-220214 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-06T20:15:10.763",
    "last_modified": "2024-11-21T03:22:48.930",
    "fix_date": "2017-01-18T12:41:38Z"
  },
  "references": [
    {
      "url": "https://github.com/joseconti/WangGuard/commit/88414951e30773c8d2ec13b99642688284bf3189",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/joseconti/WangGuard/pull/14",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220214",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220214",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/joseconti/WangGuard/commit/88414951e30773c8d2ec13b99642688284bf3189",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/joseconti/WangGuard/pull/14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220214",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220214",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.995659",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "WangGuard",
    "owner": "joseconti",
    "created_at": "2013-03-21T16:04:38Z",
    "updated_at": "2023-04-01T01:12:00Z",
    "pushed_at": "2017-01-18T13:17:58Z",
    "size": 4615,
    "stars": 15,
    "forks": 20,
    "open_issues": 6,
    "watchers": 15,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 376550,
      "CSS": 23382,
      "JavaScript": 2551
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:16:28.026407"
  }
}