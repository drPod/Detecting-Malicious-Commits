{
  "cve_id": "CVE-2017-20185",
  "github_data": {
    "repository": "fuzzymannerz/swmp",
    "fix_commit": "792bcab637cb8c3bd251d8fc8771512c5329a93e",
    "related_commits": [
      "792bcab637cb8c3bd251d8fc8771512c5329a93e",
      "792bcab637cb8c3bd251d8fc8771512c5329a93e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "792bcab637cb8c3bd251d8fc8771512c5329a93e",
      "commit_date": "2017-05-26T07:24:48Z",
      "author": {
        "login": "liamjack",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed an XSS vulnerability and 'Undefined index' error for 'theme' GET parameter (#12)",
        "length": 277,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
      },
      "files": [
        {
          "filename": "php/swmp.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -50,7 +50,6 @@\n \n $ramdata = getRamInfo($all_errors);\n \n-\n $swap = getSwapData($all_errors);\n $network = getNetworkData($all_errors);\n $disk = getDiskData($all_errors);\n@@ -75,6 +74,9 @@\n \n // Allow the user to specify the theme in the address\n \n-if ($_GET['theme']) {\n-    $config['theme'] = $_GET['theme'];\n+if (isset($_GET['theme'])) {\n+    $theme = basename($_GET['theme']);\n+    \n+    if(file_exists(\"css/themes/{$theme}.css\"))\n+        $config['theme'] = $theme;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "096616172310cbb6be09d70d0f76369b41db2bb2",
            "date": "2021-09-09T12:32:03Z",
            "author_login": "fuzzymannerz"
          },
          {
            "sha": "bdf3940fc7e66b2e2438a1896e0ce23ef4be1f02",
            "date": "2021-09-09T12:28:05Z",
            "author_login": "fuzzymannerz"
          },
          {
            "sha": "3e86caaba5dfee9a6a530ec9181cb7acba405d83",
            "date": "2020-08-24T08:43:54Z",
            "author_login": "fuzzymannerz"
          },
          {
            "sha": "3a1f6ca6be2923364a60ac2ef5424e0ffb36ba53",
            "date": "2020-08-24T08:30:20Z",
            "author_login": "fuzzymannerz"
          },
          {
            "sha": "7f901f1b8a126d9943ba5a3617a173aa5330d3fd",
            "date": "2019-08-27T11:45:29Z",
            "author_login": "fuzzymannerz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability was found in Fuzzy SWMP. It has been rated as problematic. This issue affects some unknown processing of the file swmp.php of the component GET Parameter Handler. The manipulation of the argument theme leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. This product takes the approach of rolling releases to provide continious delivery. Therefore, version details for affected and updated releases are not available. The identifier of the patch is 792bcab637cb8c3bd251d8fc8771512c5329a93e. It is recommended to apply a patch to fix this issue. The identifier VDB-230669 was assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-06T02:15:09.473",
    "last_modified": "2024-11-21T03:22:50.070",
    "fix_date": "2017-05-26T07:24:48Z"
  },
  "references": [
    {
      "url": "https://github.com/fuzzymannerz/swmp/commit/792bcab637cb8c3bd251d8fc8771512c5329a93e",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fuzzymannerz/swmp/pull/12",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.230669",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.230669",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/fuzzymannerz/swmp/commit/792bcab637cb8c3bd251d8fc8771512c5329a93e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fuzzymannerz/swmp/pull/12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.230669",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.230669",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.307973",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "swmp",
    "owner": "fuzzymannerz",
    "created_at": "2016-08-26T08:18:31Z",
    "updated_at": "2025-01-23T21:54:35Z",
    "pushed_at": "2021-09-09T12:34:36Z",
    "size": 635,
    "stars": 253,
    "forks": 25,
    "open_issues": 2,
    "watchers": 253,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "CSS": 344392,
      "PHP": 79482,
      "JavaScript": 18380,
      "Hack": 602
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:40:16.745817"
  }
}