{
  "cve_id": "CVE-2017-20195",
  "github_data": {
    "repository": "LUNAD3v/areaload",
    "fix_commit": "264813c546dba03989ac0fc365f2022bf65e3be2",
    "related_commits": [
      "264813c546dba03989ac0fc365f2022bf65e3be2"
    ],
    "patch_url": "https://github.com/LUNAD3v/areaload/commit/264813c546dba03989ac0fc365f2022bf65e3be2.patch",
    "fix_commit_details": {
      "sha": "264813c546dba03989ac0fc365f2022bf65e3be2",
      "commit_date": "2017-06-01T12:42:00Z",
      "author": {
        "login": "n0vad3v",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added simple SQL injection prevention on request.php",
        "length": 52,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 12,
        "additions": 10,
        "deletions": 2
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -63,7 +63,7 @@ zip -r /var/www/areaload/homework.zip /var/www/areaload/upload\n - [ ] \u7ba1\u7406\u9875\u9762SQL\u9632\u6ce8\u5165\n - [ ] \u591a\u7528\u6237\u7ba1\u7406\n - [ ] \u540e\u53f0\u754c\u9762\u6dfb\u52a0\u6536\u4f5c\u4e1a\u529f\u80fd\n-- [ ] request\u9875\u9762\u9632\u6ce8\u5165\n+- [x] request\u9875\u9762\u9632\u6ce8\u5165\n - [ ] \u89e3\u51b3\u4e0d\u540c\u5b66\u53f7\u4e0a\u4f20\u540c\u540d\u6587\u4ef6\u8986\u76d6\u95ee\u9898\n - [ ] \u6539\u5584\u6536\u4f5c\u4e1a\u529f\u80fd\n "
        },
        {
          "filename": "request.php",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -8,10 +8,18 @@\n $stunumber = substr($stunumber,0,12);\n $stunumber = strip_tags($stunumber);\n $phone = $_POST['phone'];\n+$phone = strip_tags($phone);\n+//SQL injection prevention\n+if (preg_match('#(DROP|INSERT|UPDATE|TABLE|DETELE|;)#i',$phone))\n+{\n+  header(\"Location: ./problem.php\");\n+  exit();\n+}\n+//End SQL injection prevention\n $problem = $_POST[\"problem\"];\n $problem = strip_tags($problem);\n //SQL injection prevention\n-if (preg_match('#(DROP|INSERT|UPDATE|TABLE|;)#i',$problem))\n+if (preg_match('#(DROP|INSERT|UPDATE|TABLE|DELETE|;)#i',$problem))\n {\n   header(\"Location: ./problem.php\");\n   exit();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3cede71c335c592c8cb3f3439a3211a73cd4ee49",
            "date": "2017-11-25T03:48:03Z",
            "author_login": "n0vad3v"
          },
          {
            "sha": "b91ee1fb526ae25fdd8053e7337645cb4ad0ad13",
            "date": "2017-10-31T14:44:10Z",
            "author_login": "n0vad3v"
          },
          {
            "sha": "6f6192589f917c1625c855fb841fabbb12d237bd",
            "date": "2017-10-27T11:50:30Z",
            "author_login": "n0vad3v"
          },
          {
            "sha": "bfaf0bf8507726410e5229e17a0446e6ed599842",
            "date": "2017-10-13T11:47:57Z",
            "author_login": "n0vad3v"
          },
          {
            "sha": "f4593dd8dceacaedfc1747d55b3a84c3df7cec44",
            "date": "2017-10-11T10:25:59Z",
            "author_login": "n0vad3v"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in LUNAD3v AreaLoad up to 1a1103182ed63a06dde63d1712f3262eda19c3ec. It has been rated as critical. This issue affects some unknown processing of the file request.php. The manipulation of the argument phone leads to sql injection. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The patch is named 264813c546dba03989ac0fc365f2022bf65e3be2. It is recommended to apply a patch to fix this issue.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-29T12:15:02.917",
    "last_modified": "2024-10-29T14:34:04.427",
    "fix_date": "2017-06-01T12:42:00Z"
  },
  "references": [
    {
      "url": "https://github.com/LUNAD3v/areaload/commit/264813c546dba03989ac0fc365f2022bf65e3be2",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?ctiid.281987",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?id.281987",
      "source": "cna@vuldb.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:27.103312",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "areaload",
    "owner": "LUNAD3v",
    "created_at": "2017-04-30T12:29:50Z",
    "updated_at": "2022-05-22T02:33:44Z",
    "pushed_at": "2017-11-25T03:49:26Z",
    "size": 32127,
    "stars": 6,
    "forks": 0,
    "open_issues": 0,
    "watchers": 6,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 258055,
      "JavaScript": 8615,
      "HTML": 7165,
      "CSS": 1080
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:45:06.926255"
  }
}