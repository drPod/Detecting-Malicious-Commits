{
  "cve_id": "CVE-2017-2601",
  "github_data": {
    "repository": "jenkinsci/jenkins",
    "fix_commit": "fd2e081b947124c90bcd97bfc55e1a7f2ef41a74",
    "related_commits": [
      "fd2e081b947124c90bcd97bfc55e1a7f2ef41a74",
      "fd2e081b947124c90bcd97bfc55e1a7f2ef41a74"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "fd2e081b947124c90bcd97bfc55e1a7f2ef41a74",
      "commit_date": "2017-01-03T19:46:59Z",
      "author": {
        "login": "jglick",
        "type": "User",
        "stats": {
          "total_commits": 3950,
          "average_weekly_commits": 5.064102564102564,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 479
        }
      },
      "commit_message": {
        "title": "Merge pull request #95 from jenkinsci-cert/SECURITY-353",
        "length": 138,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 145,
        "additions": 119,
        "deletions": 26
      },
      "files": [
        {
          "filename": "core/src/main/java/hudson/model/ParameterValue.java",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -31,11 +31,16 @@\n import hudson.tasks.BuildWrapper;\n import hudson.tasks.Builder;\n import hudson.util.VariableResolver;\n+import java.io.IOException;\n \n import java.io.Serializable;\n import java.util.Map;\n+import java.util.logging.Logger;\n+import jenkins.model.Jenkins;\n \n import net.sf.json.JSONObject;\n+import org.kohsuke.accmod.Restricted;\n+import org.kohsuke.accmod.restrictions.DoNotUse;\n \n import org.kohsuke.stapler.StaplerRequest;\n import org.kohsuke.stapler.export.Exported;\n@@ -70,6 +75,9 @@\n  */\n @ExportedBean(defaultVisibility=3)\n public abstract class ParameterValue implements Serializable {\n+\n+    private static final Logger LOGGER = Logger.getLogger(ParameterValue.class.getName());\n+\n     protected final String name;\n \n     private String description;\n@@ -91,6 +99,16 @@ public void setDescription(String description) {\n         this.description = description;\n     }\n \n+    @Restricted(DoNotUse.class) // for value.jelly\n+    public String getFormattedDescription() {\n+        try {\n+            return Jenkins.getInstance().getMarkupFormatter().translate(description);\n+        } catch (IOException e) {\n+            LOGGER.warning(\"failed to translate description using configured markup formatter\");\n+            return \"\";\n+        }\n+    }\n+\n     /**\n      * Name of the parameter.\n      *"
        },
        {
          "filename": "core/src/main/resources/hudson/model/BooleanParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<div name=\"parameter\">\n \t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n \t\t\t<f:checkbox name=\"value\" checked=\"${it.defaultValue}\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/BooleanParameterValue/value.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<f:checkbox name=\"value\" checked=\"${it.value}\" readonly=\"true\" />\n \t</f:entry>\n </j:jelly>\n\\ No newline at end of file"
        },
        {
          "filename": "core/src/main/resources/hudson/model/ChoiceParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<div name=\"parameter\">\n \t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n             <select name=\"value\">"
        },
        {
          "filename": "core/src/main/resources/hudson/model/FileParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<div name=\"parameter\">\n \t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n \t\t\t<input name=\"file\" type=\"file\" jsonAware=\"true\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/FileParameterValue/value.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-    <f:entry title=\"${it.name}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n         <j:if test=\"${it.originalFileName != null}\">\n             <j:invokeStatic var=\"encodedName\" className=\"hudson.Util\" method=\"rawEncode\">\n                 <j:arg value=\"${it.name}\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/ParametersAction/index.jelly",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -36,6 +36,7 @@ THE SOFTWARE.\n \t\t<l:main-panel>\n \t\t\t<h1>${%Build} ${build.displayName}</h1>\n \t\t\t<l:pane title=\"${%Parameters}\" width=\"3\">\n+                        <j:set var=\"escapeEntryTitleAndDescription\" value=\"true\"/> <!-- SECURITY-353 defense unless overridden -->\n \t\t\t<j:forEach var=\"parameterValue\" items=\"${it.parameters}\">\n \t\t\t\t<st:include it=\"${parameterValue}\"\n \t\t\t\t\tpage=\"value.jelly\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/ParametersDefinitionProperty/index.jelly",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -45,6 +45,7 @@ THE SOFTWARE.\n       <f:form method=\"post\" action=\"build${empty(delay)?'':'?delay='+delay}\" name=\"parameters\"\n               tableClass=\"parameters\">\n         <j:forEach var=\"parameterDefinition\" items=\"${it.parameterDefinitions}\">\n+          <j:set var=\"escapeEntryTitleAndDescription\" value=\"true\"/> <!-- SECURITY-353 defense unless overridden -->\n           <tbody>\n             <st:include it=\"${parameterDefinition}\"\n                         page=\"${parameterDefinition.descriptor.valuePage}\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/PasswordParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<div name=\"parameter\">\n \t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n \t\t\t<f:password name=\"value\" value=\"${it.defaultValueAsSecret}\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/PasswordParameterValue/value.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<f:password name=\"value\" value=\"********\" readonly=\"true\" />\n \t</f:entry>\n </j:jelly>\n\\ No newline at end of file"
        },
        {
          "filename": "core/src/main/resources/hudson/model/RunParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<div name=\"parameter\">\n \t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n             <select name=\"runId\">"
        },
        {
          "filename": "core/src/main/resources/hudson/model/RunParameterValue/value.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<a href=\"${rootURL}/${it.run.url}\" class=\"model-link inside\">${it.run.fullDisplayName}</a>\n \t</f:entry>\n </j:jelly>"
        },
        {
          "filename": "core/src/main/resources/hudson/model/StringParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<div name=\"parameter\">\n \t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n \t\t\t<f:textbox name=\"value\" value=\"${it.defaultValue}\" />"
        },
        {
          "filename": "core/src/main/resources/hudson/model/StringParameterValue/value.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<f:textbox name=\"value\" value=\"${it.value}\" readonly=\"true\" />\n \t</f:entry>\n </j:jelly>\n\\ No newline at end of file"
        },
        {
          "filename": "core/src/main/resources/hudson/model/TextParameterDefinition/index.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -24,7 +24,8 @@ THE SOFTWARE.\n -->\n <?jelly escape-by-default='true'?>\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\" xmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-  <f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n+    <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+    <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n     <div name=\"parameter\">\n       <input type=\"hidden\" name=\"name\" value=\"${it.name}\"/>\n       <f:textarea name=\"value\" value=\"${it.defaultValue}\"/>"
        },
        {
          "filename": "core/src/main/resources/hudson/model/TextParameterValue/value.jelly",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -26,7 +26,8 @@ THE SOFTWARE.\n <j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n \txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n \txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n-\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n+        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n+        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n \t\t<f:textarea name=\"value\" value=\"${it.value}\" readonly=\"readonly\" />\n \t</f:entry>\n </j:jelly>\n\\ No newline at end of file"
        },
        {
          "filename": "core/src/main/resources/lib/form/entry.jelly",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -32,6 +32,8 @@ THE SOFTWARE.\n \n     <st:attribute name=\"title\">\n       Name of the entry. Think of this like a label for the control.\n+\n+      This content is HTML (unless the boolean variable escapeEntryTitleAndDescription is set). Use h.escape if necessary.\n     </st:attribute>\n     <st:attribute name=\"field\">\n       Used for the databinding. TBD. When this attribute\n@@ -46,6 +48,8 @@ THE SOFTWARE.\n       This text shouldn't get too long, and in recent Hudson, this feature\n       is somewhat de-emphasized, in favor of the inline foldable help page\n       specified via @help.\n+\n+      This content is HTML (unless the boolean variable escapeEntryTitleAndDescription is set). Use h.escape if necessary.\n     </st:attribute>\n     <st:attribute name=\"help\">\n       URL to the HTML page. When this attribute is specified, the entry gets\n@@ -67,7 +71,7 @@ THE SOFTWARE.\n   <tr>\n     <td class=\"setting-leftspace\"><st:nbsp/></td>\n     <td class=\"setting-name\">\n-      <j:out value=\"${attrs.title}\" />\n+      <j:out value=\"${escapeEntryTitleAndDescription ? h.escape(attrs.title) : attrs.title}\" />\n     </td>\n     <td class=\"setting-main\">\n       <d:invokeBody />\n@@ -78,7 +82,7 @@ THE SOFTWARE.\n   <tr class=\"validation-error-area\"><td colspan=\"2\" /><td /><td /></tr>\n   <j:if test=\"${!empty(attrs.description)}\">\n     <f:description>\n-      <j:out value=\"${description}\"/>\n+      <j:out value=\"${escapeEntryTitleAndDescription ? h.escape(attrs.description) : attrs.description}\"/>\n     </f:description>\n   </j:if>\n   <j:if test=\"${attrs.help!=null}\">"
        },
        {
          "filename": "test/src/test/java/hudson/model/ParametersTest.java",
          "status": "modified",
          "additions": 67,
          "deletions": 11,
          "patch": "@@ -1,25 +1,30 @@\n package hudson.model;\n \n-import static org.junit.Assert.*;\n-\n import com.gargoylesoftware.htmlunit.html.DomNodeUtil;\n+import com.gargoylesoftware.htmlunit.html.HtmlCheckBoxInput;\n+import com.gargoylesoftware.htmlunit.html.HtmlElement;\n+import com.gargoylesoftware.htmlunit.html.HtmlForm;\n import com.gargoylesoftware.htmlunit.html.HtmlFormUtil;\n-import org.junit.Rule;\n-import org.junit.Test;\n-\n+import com.gargoylesoftware.htmlunit.html.HtmlOption;\n import com.gargoylesoftware.htmlunit.html.HtmlPage;\n-import com.gargoylesoftware.htmlunit.html.HtmlForm;\n-import com.gargoylesoftware.htmlunit.html.HtmlElement;\n import com.gargoylesoftware.htmlunit.html.HtmlTextInput;\n-import com.gargoylesoftware.htmlunit.html.HtmlCheckBoxInput;\n-import com.gargoylesoftware.htmlunit.html.HtmlOption;\n+import hudson.markup.MarkupFormatter;\n+import java.io.IOException;\n+import java.io.Writer;\n+import java.util.Set;\n+import java.util.regex.Matcher;\n+import java.util.regex.Pattern;\n+import org.apache.http.HttpStatus;\n+import static org.hamcrest.Matchers.*;\n+import static org.junit.Assert.*;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.junit.rules.ErrorCollector;\n import org.jvnet.hudson.test.CaptureEnvironmentBuilder;\n import org.jvnet.hudson.test.Issue;\n import org.jvnet.hudson.test.JenkinsRule;\n import org.jvnet.hudson.test.JenkinsRule.WebClient;\n \n-import java.util.Set;\n-\n /**\n  * @author huybrechts\n  */\n@@ -28,6 +33,9 @@ public class ParametersTest {\n     @Rule\n     public JenkinsRule j = new JenkinsRule();\n \n+    @Rule\n+    public ErrorCollector collector = new ErrorCollector();\n+\n     @Test\n     public void parameterTypes() throws Exception {\n         FreeStyleProject otherProject = j.createFreeStyleProject();\n@@ -216,4 +224,52 @@ public void unicodeParametersArePresetCorrectly() throws Exception {\n         final HtmlForm form = page.getFormByName(\"parameters\");\n         HtmlFormUtil.submit(form, HtmlFormUtil.getButtonByCaption(form, \"Build\"));\n     }\n+\n+    @Issue(\"SECURITY-353\")\n+    @Test\n+    public void xss() throws Exception {\n+        j.jenkins.setMarkupFormatter(new MyMarkupFormatter());\n+        FreeStyleProject p = j.createFreeStyleProject(\"p\");\n+        StringParameterDefinition param = new StringParameterDefinition(\"<param name>\", \"<param default>\", \"<param description>\");\n+        assertEquals(\"<b>[</b>param description<b>]</b>\", param.getFormattedDescription());\n+        p.addProperty(new ParametersDefinitionProperty(param));\n+        WebClient wc = j.createWebClient();\n+        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n+        HtmlPage page = wc.getPage(p, \"build?delay=0sec\");\n+        collector.checkThat(page.getWebResponse().getStatusCode(), is(HttpStatus.SC_METHOD_NOT_ALLOWED)); // 405 to dissuade scripts from thinking this triggered the build\n+        String text = page.getWebResponse().getContentAsString();\n+        collector.checkThat(\"build page should escape param name\", text, containsString(\"&lt;param name&gt;\"));\n+        collector.checkThat(\"build page should not leave param name unescaped\", text, not(containsString(\"<param name>\")));\n+        collector.checkThat(\"build page should escape param default\", text, containsString(\"&lt;param default&gt;\"));\n+        collector.checkThat(\"build page should not leave param default unescaped\", text, not(containsString(\"<param default>\")));\n+        collector.checkThat(\"build page should mark up param description\", text, containsString(\"<b>[</b>param description<b>]</b>\"));\n+        collector.checkThat(\"build page should not leave param description unescaped\", text, not(containsString(\"<param description>\")));\n+        HtmlForm form = page.getFormByName(\"parameters\");\n+        HtmlTextInput value = form.getInputByValue(\"<param default>\");\n+        value.setText(\"<param value>\");\n+        j.submit(form);\n+        j.waitUntilNoActivity();\n+        FreeStyleBuild b = p.getBuildByNumber(1);\n+        page = j.createWebClient().getPage(b, \"parameters/\");\n+        text = page.getWebResponse().getContentAsString();\n+        collector.checkThat(\"parameters page should escape param name\", text, containsString(\"&lt;param name&gt;\"));\n+        collector.checkThat(\"parameters page should not leave param name unescaped\", text, not(containsString(\"<param name>\")));\n+        collector.checkThat(\"parameters page should escape param value\", text, containsString(\"&lt;param value&gt;\"));\n+        collector.checkThat(\"parameters page should not leave param value unescaped\", text, not(containsString(\"<param value>\")));\n+        collector.checkThat(\"parameters page should mark up param description\", text, containsString(\"<b>[</b>param description<b>]</b>\"));\n+        collector.checkThat(\"parameters page should not leave param description unescaped\", text, not(containsString(\"<param description>\")));\n+    }\n+    static class MyMarkupFormatter extends MarkupFormatter {\n+        @Override\n+        public void translate(String markup, Writer output) throws IOException {\n+            Matcher m = Pattern.compile(\"[<>]\").matcher(markup);\n+            StringBuffer buf = new StringBuffer();\n+            while (m.find()) {\n+                m.appendReplacement(buf, m.group().equals(\"<\") ? \"<b>[</b>\" : \"<b>]</b>\");\n+            }\n+            m.appendTail(buf);\n+            output.write(buf.toString());\n+        }\n+    }\n+\n }"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 18,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5327cd59bdd289a299ff2557798613a8ffb107f9",
            "date": "2025-01-25T20:31:24Z",
            "author_login": "krisstern"
          },
          {
            "sha": "2183bcac4ca52be0c47e56dc802023312b5472d0",
            "date": "2025-01-24T18:29:26Z",
            "author_login": "krisstern"
          },
          {
            "sha": "331bd7ea13fef6bde1b109a6c2c58393e2487d25",
            "date": "2025-01-24T18:27:05Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "4db68bf59547787a030449434c7ecbaff074998c",
            "date": "2025-01-24T18:26:23Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "b5a5e0411bcd7d5cd09a6eaa5e64f09f7cff35f3",
            "date": "2025-01-24T07:31:57Z",
            "author_login": "krisstern"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Jenkins before versions 2.44, 2.32.2 is vulnerable to a persisted cross-site scripting in parameter names and descriptions (SECURITY-353). Users with the permission to configure jobs were able to inject JavaScript into parameter names and descriptions.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2018-05-10T13:29:00.233",
    "last_modified": "2024-11-21T03:23:48.437",
    "fix_date": "2017-01-03T19:46:59Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/04/12/5",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/05/17/8",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/06/22/3",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/06/30/3",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/10/19/3",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/95960",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-2601",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/fd2e081b947124c90bcd97bfc55e1a7f2ef41a74",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jenkins.io/security/advisory/2017-02-01/",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/04/12/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/05/17/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/06/22/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/06/30/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/10/19/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/95960",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-2601",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/fd2e081b947124c90bcd97bfc55e1a7f2ef41a74",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jenkins.io/security/advisory/2017-02-01/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:25.837429",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "jenkins",
    "owner": "jenkinsci",
    "created_at": "2010-11-22T21:21:23Z",
    "updated_at": "2025-01-26T06:19:41Z",
    "pushed_at": "2025-01-25T20:31:24Z",
    "size": 162432,
    "stars": 23526,
    "forks": 8902,
    "open_issues": 77,
    "watchers": 23526,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable-1.625",
      "stable-1.642",
      "stable-1.651",
      "stable-2.7",
      "stable-2.19",
      "stable-2.32",
      "stable-2.46",
      "stable-2.60",
      "stable-2.73",
      "stable-2.89",
      "stable-2.107",
      "stable-2.121",
      "stable-2.138",
      "stable-2.150",
      "stable-2.164",
      "stable-2.176",
      "stable-2.190",
      "stable-2.204",
      "stable-2.222",
      "stable-2.235",
      "stable-2.249",
      "stable-2.263",
      "stable-2.277",
      "stable-2.289",
      "stable-2.302"
    ],
    "languages": {
      "Java": 12302562,
      "HTML": 970700,
      "JavaScript": 398467,
      "SCSS": 322300,
      "Groovy": 68795,
      "CSS": 41799,
      "Ruby": 17290,
      "Perl": 16145,
      "Handlebars": 14958,
      "Python": 4925,
      "ANTLR": 4633,
      "Shell": 2871,
      "C": 2091,
      "Batchfile": 1023,
      "Dockerfile": 210
    },
    "commit_activity": {
      "total_commits_last_year": 1422,
      "avg_commits_per_week": 27.346153846153847,
      "days_active_last_year": 304
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:41:43.638362"
  }
}