{
  "cve_id": "CVE-2017-2602",
  "github_data": {
    "repository": "jenkinsci/jenkins",
    "fix_commit": "414ff7e30aba66bed18c4ee8a8660fb36fc8c655",
    "related_commits": [
      "414ff7e30aba66bed18c4ee8a8660fb36fc8c655",
      "414ff7e30aba66bed18c4ee8a8660fb36fc8c655"
    ],
    "patch_url": "https://github.com/jenkinsci/jenkins/commit/414ff7e30aba66bed18c4ee8a8660fb36fc8c655.patch",
    "fix_commit_details": {
      "sha": "414ff7e30aba66bed18c4ee8a8660fb36fc8c655",
      "commit_date": "2017-01-10T22:26:00Z",
      "author": {
        "login": "jglick",
        "type": "User",
        "stats": {
          "total_commits": 3950,
          "average_weekly_commits": 5.077120822622108,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 479
        }
      },
      "commit_message": {
        "title": "Merge pull request #89 from jenkinsci-cert/SECURITY-358",
        "length": 119,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 75,
        "additions": 64,
        "deletions": 11
      },
      "files": [
        {
          "filename": "core/src/main/resources/jenkins/security/s2m/filepath-filter.conf",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -23,6 +23,9 @@ allow read,stat <JENKINS_HOME>/userContent($|/.*)\n # In the next rule we grant general access under build directories, so first we protect\n # the actual build record that Jenkins core reads, which nothing should be touching.\n deny all <BUILDDIR>/build.xml\n+# Similarly for Pipeline build (WorkflowRun) metadata:\n+deny all <BUILDDIR>/program.dat\n+deny all <BUILDDIR>/workflow($|/.*)\n \n # Various plugins read/write files under build directories, so allow them all.\n # - git 1.x writes changelog.xml from the slave (2.x writes from the master so need not be listed)"
        },
        {
          "filename": "test/src/test/java/jenkins/security/s2m/AdminFilePathFilterTest.java",
          "status": "added",
          "additions": 60,
          "deletions": 0,
          "patch": "@@ -0,0 +1,60 @@\n+/*\n+ * The MIT License\n+ *\n+ * Copyright 2016 CloudBees, Inc.\n+ *\n+ * Permission is hereby granted, free of charge, to any person obtaining a copy\n+ * of this software and associated documentation files (the \"Software\"), to deal\n+ * in the Software without restriction, including without limitation the rights\n+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n+ * copies of the Software, and to permit persons to whom the Software is\n+ * furnished to do so, subject to the following conditions:\n+ *\n+ * The above copyright notice and this permission notice shall be included in\n+ * all copies or substantial portions of the Software.\n+ *\n+ * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n+ * THE SOFTWARE.\n+ */\n+\n+package jenkins.security.s2m;\n+\n+import java.io.File;\n+import javax.inject.Inject;\n+import static org.junit.Assert.*;\n+import org.junit.Before;\n+import org.junit.Rule;\n+import org.junit.Test;\n+import org.jvnet.hudson.test.JenkinsRule;\n+\n+public class AdminFilePathFilterTest {\n+\n+    @Rule\n+    public JenkinsRule r = new JenkinsRule();\n+\n+    @Inject\n+    AdminWhitelistRule rule;\n+\n+    @Before\n+    public void setUp() {\n+        r.jenkins.getInjector().injectMembers(this);\n+        rule.setMasterKillSwitch(false);\n+    }\n+\n+    // TODO in master when using a version taking a String[]: @Issue({\"JENKINS-27055\", \"SECURITY-358\"})\n+    @Test\n+    public void matchBuildDir() throws Exception {\n+        File buildDir = r.buildAndAssertSuccess(r.createFreeStyleProject()).getRootDir();\n+        assertTrue(rule.checkFileAccess(\"write\", new File(buildDir, \"whatever\")));\n+        assertFalse(rule.checkFileAccess(\"write\", new File(buildDir, \"build.xml\")));\n+        // WorkflowRun:\n+        assertFalse(rule.checkFileAccess(\"write\", new File(buildDir, \"program.dat\")));\n+        assertFalse(rule.checkFileAccess(\"write\", new File(buildDir, \"workflow/23.xml\")));\n+    }\n+\n+}"
        },
        {
          "filename": "test/src/test/java/jenkins/security/s2m/DefaultFilePathFilterTest.java",
          "status": "renamed",
          "additions": 1,
          "deletions": 11,
          "patch": "@@ -22,7 +22,7 @@\n  * THE SOFTWARE.\n  */\n \n-package jenkins.security;\n+package jenkins.security.s2m;\n \n import hudson.FilePath;\n import hudson.model.Slave;\n@@ -31,8 +31,6 @@\n import java.io.PrintWriter;\n import java.io.StringWriter;\n \n-import jenkins.security.s2m.AdminWhitelistRule;\n-import jenkins.security.s2m.DefaultFilePathFilter;\n import org.jenkinsci.remoting.RoleChecker;\n import org.junit.Before;\n import org.junit.Test;\n@@ -41,7 +39,6 @@\n import org.jvnet.hudson.test.JenkinsRule;\n \n import javax.inject.Inject;\n-import org.jvnet.hudson.test.Issue;\n \n public class DefaultFilePathFilterTest {\n \n@@ -112,11 +109,4 @@ public void checkRoles(RoleChecker checker) throws SecurityException {\n         }\n     }\n \n-    @Issue(\"JENKINS-27055\")\n-    @Test public void matchBuildDir() throws Exception {\n-        File f = new File(r.buildAndAssertSuccess(r.createFreeStyleProject()).getRootDir(), \"whatever\");\n-        rule.setMasterKillSwitch(false);\n-        assertTrue(rule.checkFileAccess(\"write\", f));\n-    }\n-\n }"
        }
      ],
      "file_patterns": {
        "security_files": 3,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "81af439caeefa41e70fdaa43e738e4e507413615",
            "date": "2025-01-14T16:07:47Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "6f37252727aeab611b5cae5f0605b2e2a4c1a7ad",
            "date": "2025-01-14T16:07:22Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "ab605fad8b35d3a38cdb7499175f0dd131ff8ee4",
            "date": "2025-01-14T13:40:54Z",
            "author_login": "jenkins-release-bot"
          },
          {
            "sha": "475d33c97dfd8a2e6e503672ef246694c91eda4d",
            "date": "2025-01-14T13:40:38Z",
            "author_login": "jenkins-release-bot"
          },
          {
            "sha": "e7f5953809d4d60257a6bfaaf1bc932d077a8597",
            "date": "2025-01-14T07:48:04Z",
            "author_login": "mawinter69"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-184",
    "description": "jenkins before versions 2.44, 2.32.2 is vulnerable to an improper blacklisting of the Pipeline metadata files in the agent-to-master security subsystem. This could allow metadata files to be written to by malicious agents (SECURITY-358).",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-05-15T21:29:00.227",
    "last_modified": "2024-11-21T03:23:48.583",
    "fix_date": "2017-01-10T22:26:00Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/95952",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-2602",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/414ff7e30aba66bed18c4ee8a8660fb36fc8c655",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://jenkins.io/security/advisory/2017-02-01/",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95952",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-2602",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/jenkinsci/jenkins/commit/414ff7e30aba66bed18c4ee8a8660fb36fc8c655",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://jenkins.io/security/advisory/2017-02-01/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:25.842526",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jenkins",
    "owner": "jenkinsci",
    "created_at": "2010-11-22T21:21:23Z",
    "updated_at": "2025-01-14T11:56:32Z",
    "pushed_at": "2025-01-14T07:48:05Z",
    "size": 162004,
    "stars": 23472,
    "forks": 8877,
    "open_issues": 74,
    "watchers": 23472,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable-1.625",
      "stable-1.642",
      "stable-1.651",
      "stable-2.7",
      "stable-2.19",
      "stable-2.32",
      "stable-2.46",
      "stable-2.60",
      "stable-2.73",
      "stable-2.89",
      "stable-2.107",
      "stable-2.121",
      "stable-2.138",
      "stable-2.150",
      "stable-2.164",
      "stable-2.176",
      "stable-2.190",
      "stable-2.204",
      "stable-2.222",
      "stable-2.235",
      "stable-2.249",
      "stable-2.263",
      "stable-2.277",
      "stable-2.289",
      "stable-2.302"
    ],
    "languages": {
      "Java": 12325164,
      "HTML": 970700,
      "JavaScript": 398710,
      "SCSS": 330642,
      "Groovy": 68802,
      "CSS": 41768,
      "Ruby": 17290,
      "Perl": 16145,
      "Handlebars": 14958,
      "Python": 4925,
      "ANTLR": 4633,
      "Shell": 2872,
      "C": 2091,
      "Batchfile": 1023,
      "Dockerfile": 210
    },
    "commit_activity": {
      "total_commits_last_year": 1355,
      "avg_commits_per_week": 26.057692307692307,
      "days_active_last_year": 302
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:17:56.125951"
  }
}