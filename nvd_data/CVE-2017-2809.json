{
  "cve_id": "CVE-2017-2809",
  "github_data": {
    "repository": "tomoh1r/ansible-vault",
    "fix_commit": "3f8f659ef443ab870bb19f95d43543470168ae04",
    "related_commits": [
      "3f8f659ef443ab870bb19f95d43543470168ae04",
      "3f8f659ef443ab870bb19f95d43543470168ae04"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3f8f659ef443ab870bb19f95d43543470168ae04",
      "commit_date": "2017-09-13T11:49:38Z",
      "author": {
        "login": "tomoh1r",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix security issue refs #4",
        "length": 106,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 84,
        "additions": 55,
        "deletions": 29
      },
      "files": [
        {
          "filename": ".travis.yml",
          "status": "modified",
          "additions": 13,
          "deletions": 7,
          "patch": "@@ -1,14 +1,20 @@\n ---\n language: python\n sudo: false\n+cache:\n+  directories:\n+    - $HOME/.cache/pip\n python:\n-- 2.7\n-env:\n-  matrix:\n-    - TOXENV=py27\n-    - TOXENV=py27-ansible2\n+  - \"2.7\"\n+  - \"3.3\"\n+  - \"3.4\"\n+  - \"3.5\"\n+  - \"3.6\"\n install:\n-  - pip install tox\n-script: tox\n+  - python -m pip install -U setuptools pip\n+  - python setup.py setup_test\n+script:\n+  - python -m pytest\n+  - if [ \"$TRAVIS_PYTHON_VERSION\" == '2.7' ] ; then python -m pip install -U 'ansible<2.0.0' && python -m pytest ; fi\n \n # vim:st=2 sts=2 sw=2:"
        },
        {
          "filename": "CHANGES.txt",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -1,3 +1,13 @@\n+1.0.5 (2017/09/13)\n+\n+* Update to use yaml.safe_load()$\n+* Update to tomoh1r$\n+\n+1.0.4 (2015/11/29)\n+\n+* Apply to Ansible 2\n+* Add unit tests\n+\n 1.0.3 (2015/05/18)\n \n * fix README.rst typo"
        },
        {
          "filename": "README.rst",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,8 +2,8 @@\n ansible-vault\n =============\n \n-.. image:: https://travis-ci.org/jptomo/ansible-vault.svg?branch=master\n-   :target: https://travis-ci.org/jptomo/ansible-vault\n+.. image:: https://travis-ci.org/tomoh1r/ansible-vault.svg?branch=master\n+   :target: https://travis-ci.org/tomoh1r/ansible-vault\n \n This project aim to R/W an ansible-vault yaml file\n "
        },
        {
          "filename": "README_test.rst",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -12,4 +12,5 @@ how to test\n \n    .. code-block:: console\n \n+      $ ./venvtest/bin/python setup.py setup_test\n       $ ./venvtest/bin/python setup.py test"
        },
        {
          "filename": "ansible_vault/api.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -15,7 +15,7 @@ def __init__(self, password):\n \n     def load(self, stream):\n         '''read vault steam and return python object'''\n-        return yaml.load(self.vault.decrypt(stream))\n+        return yaml.safe_load(self.vault.decrypt(stream))\n \n     def dump(self, data, stream=None):\n         '''encrypt data and print stdout or write to stream'''"
        },
        {
          "filename": "ansible_vault/test/file/pwned.txt",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+$ANSIBLE_VAULT;1.1;AES256\n+31616433623434626463363932323936663066353063393731346536636437633463633137643032\n+3663656431663830396662646132343735623538346330640a363532326262353732636161633431\n+61353936346235396464333333653831356638393264343662363362653433353762396663653465\n+6439366430336336660a363931663030323665633136363362353162333864653933653763656462\n+31656431653333343834623731393263393865353831333963616165613237376630646665306363\n+6238373037663462343565643737303136333032386136356438"
        },
        {
          "filename": "ansible_vault/test/test_api.py",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -1,9 +1,9 @@\n import os\n from tempfile import mkstemp\n \n-from testfixtures import ShouldRaise\n-\n from ansible.errors import AnsibleError\n+from testfixtures import ShouldRaise\n+from yaml.constructor import ConstructorError\n \n \n here = os.path.dirname(os.path.abspath(__file__))\n@@ -28,6 +28,12 @@ def test_cannot(self):\n         with ShouldRaise(AnsibleError('Decryption failed')):\n             vault.load(open(fpath).read())\n \n+    def test_not_pwned(self):\n+        fpath = os.path.join(here, 'file', 'pwned.txt')\n+        vault = self._makeOne('password')\n+        with ShouldRaise(ConstructorError):\n+            vault.load(open(fpath).read())\n+\n \n class TestVaultDump(object):\n     def _getTargetClass(self):"
        },
        {
          "filename": "setup.cfg",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -1,2 +1,10 @@\n [metadata]\n description-file = README.rst\n+\n+[aliases]\n+setup_test = develop easy_install ansible-vault[test]\n+release = register clean --all sdist\n+\n+[tools:pytest]\n+norecursedirs = venv\n+testpaths = ansible_vault/test"
        },
        {
          "filename": "setup.py",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -32,19 +32,21 @@ def run_tests(self):\n \n setup(\n     name='ansible-vault',\n-    version='1.0.4',\n+    version='1.0.5',\n     author='Tomohiro NAKAMURA',\n     author_email='quickness.net@gmail.com',\n-    url='https://github.com/jptomo/ansible-vault',\n+    url='https://github.com/tomoh1r/ansible-vault',\n     description='R/W an ansible-vault yaml file',\n     long_description=_read('README.rst'),\n     packages=find_packages(),\n     install_requires=['ansible'],\n-    tests_require=['pytest', 'testfixtures'],\n     cmdclass={'test': PyTest},\n     classifiers=[\n         'Development Status :: 5 - Production/Stable',\n         'License :: OSI Approved :: GNU General Public License v3 (GPLv3)',\n     ],\n     license='GPLv3',\n+    extras_require = {\n+        'test': ['pytest', 'testfixtures'],\n+    }\n )"
        },
        {
          "filename": "tox.ini",
          "status": "removed",
          "additions": 0,
          "deletions": 14,
          "patch": "@@ -1,14 +0,0 @@\n-[tox]\n-envlist = py27, py27-ansible2\n-setupdir = .\n-\n-[testenv]\n-basepython = python2.7\n-\n-[testenv:py27]\n-commands = python2.7 setup.py test\n-\n-[testenv:py27-ansible2]\n-commands =\n-    pip install -U git+https://github.com/ansible/ansible.git@stable-2.0#egg=ansible\n-    python2.7 setup.py test"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "31457b79c40dbc764a90ccedac65d4b4b28f6553",
            "date": "2021-09-14T00:19:53Z",
            "author_login": "tomoh1r"
          },
          {
            "sha": "265024f8657c68cec9903d010c9aab1bd124928c",
            "date": "2021-05-03T00:26:42Z",
            "author_login": "tomoh1r"
          },
          {
            "sha": "1a73ec90d0cfa26e232d86a14dfa435b981f6600",
            "date": "2021-05-03T00:17:33Z",
            "author_login": "tomoh1r"
          },
          {
            "sha": "d52981ff44d2e3974cc8b781a5beb872356bdf68",
            "date": "2021-05-02T23:34:44Z",
            "author_login": "tomoh1r"
          },
          {
            "sha": "8287426deb241f9f444e44dbe8f6f1b2da1922ac",
            "date": "2021-05-02T23:01:48Z",
            "author_login": "tomoh1r"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-94",
    "description": "An exploitable vulnerability exists in the yaml loading functionality of ansible-vault before 1.0.5. A specially crafted vault can execute arbitrary python commands resulting in command execution. An attacker can insert python into the vault to trigger this vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-09-14T19:29:00.347",
    "last_modified": "2024-11-21T03:24:11.720",
    "fix_date": "2017-09-13T11:49:38Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/100824",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/tomoh1r/ansible-vault/blob/v1.0.5/CHANGES.txt",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tomoh1r/ansible-vault/commit/3f8f659ef443ab870bb19f95d43543470168ae04",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tomoh1r/ansible-vault/issues/4",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.talosintelligence.com/vulnerability_reports/TALOS-2017-0305",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/100824",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/tomoh1r/ansible-vault/blob/v1.0.5/CHANGES.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tomoh1r/ansible-vault/commit/3f8f659ef443ab870bb19f95d43543470168ae04",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tomoh1r/ansible-vault/issues/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.talosintelligence.com/vulnerability_reports/TALOS-2017-0305",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:07.376390",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ansible-vault",
    "owner": "tomoh1r",
    "created_at": "2015-05-16T13:37:37Z",
    "updated_at": "2024-07-24T01:26:10Z",
    "pushed_at": "2021-09-14T00:26:04Z",
    "size": 113,
    "stars": 54,
    "forks": 32,
    "open_issues": 10,
    "watchers": 54,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 30634
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:28:53.808043"
  }
}