{
  "cve_id": "CVE-2017-5539",
  "github_data": {
    "repository": "b2evolution/b2evolution",
    "fix_commit": "e35f7c195d8c1103d2d981a48cda5ab45ecac48a",
    "related_commits": [
      "e35f7c195d8c1103d2d981a48cda5ab45ecac48a",
      "e35f7c195d8c1103d2d981a48cda5ab45ecac48a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e35f7c195d8c1103d2d981a48cda5ab45ecac48a",
      "commit_date": "2017-01-19T16:14:27Z",
      "author": {
        "login": "fplanque",
        "type": "User",
        "stats": {
          "total_commits": 5318,
          "average_weekly_commits": 4.743978590544157,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 490
        }
      },
      "commit_message": {
        "title": "Merge branch 'develop'",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 5111,
        "additions": 4503,
        "deletions": 608
      },
      "files": [
        {
          "filename": "Gruntfile.js",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -229,6 +229,7 @@ module.exports = function(grunt) {\n \t\t\t\t\t\t\t'rsc/js/src/evo_user_contact_groups.js',\n \t\t\t\t\t\t\t'rsc/js/src/evo_rest_api.js',\n \t\t\t\t\t\t\t'rsc/js/src/evo_item_flag.js',\n+\t\t\t\t\t\t\t'rsc/js/src/evo_links.js',\n \t\t\t\t\t\t\t'rsc/js/ajax.js'],\n \t\t\t\tdest: 'rsc/js/build/evo_frontoffice.bmin.js'\n \t\t\t},\n@@ -245,6 +246,7 @@ module.exports = function(grunt) {\n \t\t\t\t\t\t\t'rsc/js/src/evo_user_contact_groups.js',\n \t\t\t\t\t\t\t'rsc/js/src/evo_rest_api.js',\n \t\t\t\t\t\t\t'rsc/js/src/evo_item_flag.js',\n+\t\t\t\t\t\t\t'rsc/js/src/evo_links.js',\n \t\t\t\t\t\t\t'rsc/js/ajax.js'],\n \t\t\t\tdest: 'rsc/js/build/bootstrap-evo_frontoffice.bmin.js'\n \t\t\t},"
        },
        {
          "filename": "conf/_advanced.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -667,6 +667,13 @@\n $dirpath_max_length = ( ( ( strtoupper( substr( PHP_OS, 0, 3 ) ) ) === 'WIN' ) ? ( 247 - 35 /* the maximum additional path length because of the _evocache folder */ ) : 767 ) - $filename_max_length;\n \n \n+/**\n+ * Allow double dots in file names\n+ * Use TRUE if you want to allow \"..\" in file and directory names like \"..filename\" or \"dir..name\"\n+ */\n+$filemanager_allow_dotdot_in_filenames = false;\n+\n+\n /**\n  * XMLRPC logging. Set this to 1 to log XMLRPC calls received by this server (into /xmlsrv/xmlrpc.log).\n  *"
        },
        {
          "filename": "conf/_application.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -15,13 +15,13 @@\n  * Note: This has to be compatible with {@link http://us2.php.net/en/version-compare}.\n  * @global string\n  */\n-$app_version = '6.8.4-stable';\n+$app_version = '6.8.5-stable';\n \n /**\n  * Release date (ISO)\n  * @global string\n  */\n-$app_date = '2017-01-16';\n+$app_date = '2017-01-19';\n \n /**\n  * Long version string for checking differences\n@@ -36,7 +36,7 @@\n  *\n  * {@internal Before changing this in CVS, it should be discussed! }}\n  */\n-$new_db_version = 12140;\n+$new_db_version = 12150;\n \n /**\n  * Minimum PHP version required for b2evolution to function properly. It will contain each module own minimum PHP version as well."
        },
        {
          "filename": "htsrv/anon_async.php",
          "status": "modified",
          "additions": 140,
          "deletions": 0,
          "patch": "@@ -1354,11 +1354,151 @@\n \t\trequire $inc_path.'users/views/_user_groups.form.php';\n \t\tbreak;\n \n+\tcase 'set_object_link_position':\n+\t\t// Change a position of a link on the edit item screen (fieldset \"Images & Attachments\")\n+\n+\t\t// Check that this action request is not a CSRF hacked request:\n+\t\t$Session->assert_received_crumb( 'link' );\n+\n+\t\t// Check item/comment edit permission below after we have the $LinkOwner object ( we call LinkOwner->check_perm ... )\n+\n+\t\tparam('link_ID', 'integer', true);\n+\t\tparam('link_position', 'string', true);\n+\n+\t\t// Don't display the inline position reminder again until the user logs out or loses the session cookie\n+\t\tif( $link_position == 'inline' )\n+\t\t{\n+\t\t\t$Session->set( 'display_inline_reminder', 'false' );\n+\t\t}\n+\n+\t\t$LinkCache = & get_LinkCache();\n+\t\tif( ( $Link = & $LinkCache->get_by_ID( $link_ID ) ) === false )\n+\t\t{\t// Bad request with incorrect link ID\n+\t\t\techo '';\n+\t\t\texit(0);\n+\t\t}\n+\t\t$LinkOwner = & $Link->get_LinkOwner();\n+\n+\t\t// Check permission:\n+\t\t$LinkOwner->check_perm( 'edit', true );\n+\n+\t\tif( $Link->set( 'position', $link_position ) && $Link->dbupdate() )\n+\t\t{ // update was successful\n+\t\t\techo 'OK';\n+\n+\t\t\t// Update last touched date of Owners\n+\t\t\t$LinkOwner->update_last_touched_date();\n+\n+\t\t\tif( $link_position == 'cover' && $LinkOwner->type == 'item' )\n+\t\t\t{ // Position \"Cover\" can be used only by one link\n+\t\t\t  // Replace previous position with \"Inline\"\n+\t\t\t\t$DB->query( 'UPDATE T_links\n+\t\t\t\t\t\tSET link_position = \"aftermore\"\n+\t\t\t\t\tWHERE link_ID != '.$DB->quote( $link_ID ).'\n+\t\t\t\t\t\tAND link_itm_ID = '.$DB->quote( $LinkOwner->Item->ID ).'\n+\t\t\t\t\t\tAND link_position = \"cover\"' );\n+\t\t\t}\n+\t\t}\n+\t\telse\n+\t\t{ // return the current value on failure\n+\t\t\techo $Link->get( 'position' );\n+\t\t}\n+\t\tbreak;\n+\n+\tcase 'update_links_order':\n+\t\t// Update the order of all links at one time:\n+\n+\t\t// Check that this action request is not a CSRF hacked request:\n+\t\t$Session->assert_received_crumb( 'link' );\n+\n+\t\t$link_IDs = param( 'links', 'string' );\n+\n+\t\tif( empty( $link_IDs ) )\n+\t\t{ // No links to update, wrong request, exit here:\n+\t\t\tbreak;\n+\t\t}\n+\n+\t\t$link_IDs = explode( ',', $link_IDs );\n+\n+\t\t// Check permission by first link:\n+\t\t$LinkCache = & get_LinkCache();\n+\t\tif( ( $Link = & $LinkCache->get_by_ID( $link_IDs[0] ) ) === false )\n+\t\t{ // Bad request with incorrect link ID\n+\t\t\texit(0);\n+\t\t}\n+\t\t$LinkOwner = & $Link->get_LinkOwner();\n+\t\t// Check permission:\n+\t\t$LinkOwner->check_perm( 'edit', true );\n+\n+\t\t$DB->begin( 'SERIALIZABLE' );\n+\n+\t\t// Get max order value of the links:\n+\t\t$max_link_order = intval( $DB->get_var( 'SELECT MAX( link_order )\n+\t\t\t FROM T_links\n+\t\t\tWHERE link_ID IN ( '.$DB->quote( $link_IDs ).' )' ) );\n+\n+\t\t// Initialize parts of sql queries to update the links order:\n+\t\t$fake_sql_update_strings = '';\n+\t\t$real_sql_update_strings = '';\n+\t\t$real_link_order = 0;\n+\t\tforeach( $link_IDs as $link_ID )\n+\t\t{\n+\t\t\t$max_link_order++;\n+\t\t\t$fake_sql_update_strings .= ' WHEN link_ID = '.$DB->quote( $link_ID ).' THEN '.$max_link_order;\n+\t\t\t$real_link_order++;\n+\t\t\t$real_sql_update_strings .= ' WHEN link_ID = '.$DB->quote( $link_ID ).' THEN '.$real_link_order;\n+\t\t}\n+\n+\t\t// Do firstly fake ordering start with max order, to avoid duplicate entry error:\n+\t\t$DB->query( 'UPDATE T_links\n+\t\t\t  SET link_order = CASE '.$fake_sql_update_strings.' ELSE link_order END\n+\t\t\tWHERE link_ID IN ( '.$DB->quote( $link_IDs ).' )' );\n+\t\t// Do real ordering start with number 1:\n+\t\t$DB->query( 'UPDATE T_links\n+\t\t\t  SET link_order = CASE '.$real_sql_update_strings.' ELSE link_order END\n+\t\t\tWHERE link_ID IN ( '.$DB->quote( $link_IDs ).' )' );\n+\n+\t\t$DB->commit();\n+\t\tbreak;\n+\n \tcase 'test_api':\n \t\t// Spec action to test API from ctrl=system:\n \t\techo 'ok';\n \t\tbreak;\n \n+\tcase 'get_file_select_item':\n+\t\t$field_params = param( 'params', 'array', true );\n+\t\t$field_name = param( 'field_name', 'string', true );\n+\t\t$root = param( 'root', 'string', true );\n+\t\t$file_path = param( 'path', 'string', true );\n+\n+\t\t$FileCache = & get_FileCache();\n+\t\tlist( $root_type, $root_in_type_ID ) = explode( '_', $root, 2 );\n+\t\tif( ! ( $current_File = $FileCache->get_by_root_and_path( $root_type, $root_in_type_ID, $file_path ) ) )\n+\t\t{\t// No file:\n+\t\t\tdebug_die( 'No such file' );\n+\t\t\t// Exit here.\n+\t\t}\n+\n+\t\tif( ! $current_File->is_image() )\n+\t\t{\n+\t\t\tdebug_die( 'Incorrect file type for '.$field_name );\n+\t\t}\n+\n+\t\t// decode params with HTML tags\n+\t\t$field_params['field_item_start'] = base64_decode( $field_params['field_item_start'] );\n+\t\t$field_params['field_item_end'] = base64_decode( $field_params['field_item_end'] );\n+\n+\t\t$current_File->load_meta( true ); // erhsatingin > can we force create file meta in DB here or should this whole thing require login?\n+\t\t$r = file_select_item( $current_File->ID, $field_params );\n+\n+\t\techo json_encode( array(\n+\t\t\t\t'fieldName' => $field_name,\n+\t\t\t\t'fieldValue' => $current_File->ID,\n+\t\t\t\t'item' => base64_encode( $r )\n+\t\t\t) );\n+\t\tbreak;\n+\n \tdefault:\n \t\t$Ajaxlog->add( T_('Incorrect action!'), 'error' );\n \t\tbreak;"
        },
        {
          "filename": "htsrv/async.php",
          "status": "modified",
          "additions": 35,
          "deletions": 112,
          "patch": "@@ -107,7 +107,7 @@\n \t\t\t// Highlight lines starting with orgname: or org-name: (case insensitive)\n \t\t\tfor( $i = 0; $i < count( $result['rawdata'] ); $i++ )\n \t\t\t{\n-\t\t\t\tif( preg_match( '/^(orgname:|org-name:)/i', $result['rawdata'][$i] ) )\n+\t\t\t\tif( preg_match( '/^(orgname:|org-name:|descr:)/i', $result['rawdata'][$i] ) )\n \t\t\t\t{\n \t\t\t\t\t$result['rawdata'][$i] = '<span style=\"font-weight: bold; background-color: yellow;\">'.$result['rawdata'][$i].'</span>';\n \t\t\t\t}\n@@ -163,113 +163,6 @@\n \t\tautoform_display_field( $set_path, $r['set_meta'], $Form, $set_type, $Plugin, NULL, $r['set_node'] );\n \t\tbreak;\n \n-\tcase 'set_object_link_position':\n-\t\t// Change a position of a link on the edit item screen (fieldset \"Images & Attachments\")\n-\n-\t\t// Check that this action request is not a CSRF hacked request:\n-\t\t$Session->assert_received_crumb( 'link' );\n-\n-\t\t// Check item/comment edit permission below after we have the $LinkOwner object ( we call LinkOwner->check_perm ... )\n-\n-\t\tparam('link_ID', 'integer', true);\n-\t\tparam('link_position', 'string', true);\n-\n-\t\t// Don't display the inline position reminder again until the user logs out or loses the session cookie\n-\t\tif( $link_position == 'inline' )\n-\t\t{\n-\t\t\t$Session->set( 'display_inline_reminder', 'false' );\n-\t\t}\n-\n-\t\t$LinkCache = & get_LinkCache();\n-\t\tif( ( $Link = & $LinkCache->get_by_ID( $link_ID ) ) === false )\n-\t\t{\t// Bad request with incorrect link ID\n-\t\t\techo '';\n-\t\t\texit(0);\n-\t\t}\n-\t\t$LinkOwner = & $Link->get_LinkOwner();\n-\n-\t\t// Check permission:\n-\t\t$LinkOwner->check_perm( 'edit', true );\n-\n-\t\tif( $Link->set( 'position', $link_position ) && $Link->dbupdate() )\n-\t\t{ // update was successful\n-\t\t\techo 'OK';\n-\n-\t\t\t// Update last touched date of Owners\n-\t\t\t$LinkOwner->update_last_touched_date();\n-\n-\t\t\tif( $link_position == 'cover' && $LinkOwner->type == 'item' )\n-\t\t\t{ // Position \"Cover\" can be used only by one link\n-\t\t\t  // Replace previous position with \"Inline\"\n-\t\t\t\t$DB->query( 'UPDATE T_links\n-\t\t\t\t\t\tSET link_position = \"aftermore\"\n-\t\t\t\t\tWHERE link_ID != '.$DB->quote( $link_ID ).'\n-\t\t\t\t\t\tAND link_itm_ID = '.$DB->quote( $LinkOwner->Item->ID ).'\n-\t\t\t\t\t\tAND link_position = \"cover\"' );\n-\t\t\t}\n-\t\t}\n-\t\telse\n-\t\t{ // return the current value on failure\n-\t\t\techo $Link->get( 'position' );\n-\t\t}\n-\t\tbreak;\n-\n-\tcase 'update_links_order':\n-\t\t// Update the order of all links at one time:\n-\n-\t\t// Check that this action request is not a CSRF hacked request:\n-\t\t$Session->assert_received_crumb( 'link' );\n-\n-\t\t$link_IDs = param( 'links', 'string' );\n-\n-\t\tif( empty( $link_IDs ) )\n-\t\t{ // No links to update, wrong request, exit here:\n-\t\t\tbreak;\n-\t\t}\n-\n-\t\t$link_IDs = explode( ',', $link_IDs );\n-\n-\t\t// Check permission by first link:\n-\t\t$LinkCache = & get_LinkCache();\n-\t\tif( ( $Link = & $LinkCache->get_by_ID( $link_IDs[0] ) ) === false )\n-\t\t{ // Bad request with incorrect link ID\n-\t\t\texit(0);\n-\t\t}\n-\t\t$LinkOwner = & $Link->get_LinkOwner();\n-\t\t// Check permission:\n-\t\t$LinkOwner->check_perm( 'edit', true );\n-\n-\t\t$DB->begin( 'SERIALIZABLE' );\n-\n-\t\t// Get max order value of the links:\n-\t\t$max_link_order = intval( $DB->get_var( 'SELECT MAX( link_order )\n-\t\t\t FROM T_links\n-\t\t\tWHERE link_ID IN ( '.$DB->quote( $link_IDs ).' )' ) );\n-\n-\t\t// Initialize parts of sql queries to update the links order:\n-\t\t$fake_sql_update_strings = '';\n-\t\t$real_sql_update_strings = '';\n-\t\t$real_link_order = 0;\n-\t\tforeach( $link_IDs as $link_ID )\n-\t\t{\n-\t\t\t$max_link_order++;\n-\t\t\t$fake_sql_update_strings .= ' WHEN link_ID = '.$DB->quote( $link_ID ).' THEN '.$max_link_order;\n-\t\t\t$real_link_order++;\n-\t\t\t$real_sql_update_strings .= ' WHEN link_ID = '.$DB->quote( $link_ID ).' THEN '.$real_link_order;\n-\t\t}\n-\n-\t\t// Do firstly fake ordering start with max order, to avoid duplicate entry error:\n-\t\t$DB->query( 'UPDATE T_links\n-\t\t\t  SET link_order = CASE '.$fake_sql_update_strings.' ELSE link_order END\n-\t\t\tWHERE link_ID IN ( '.$DB->quote( $link_IDs ).' )' );\n-\t\t// Do real ordering start with number 1:\n-\t\t$DB->query( 'UPDATE T_links\n-\t\t\t  SET link_order = CASE '.$real_sql_update_strings.' ELSE link_order END\n-\t\t\tWHERE link_ID IN ( '.$DB->quote( $link_IDs ).' )' );\n-\n-\t\t$DB->commit();\n-\t\tbreak;\n-\n \tcase 'edit_comment':\n \t\t// Used to edit a comment from back-office (Note: Only for meta comments now!)\n \n@@ -816,9 +709,9 @@\n \t\t// Check permission:\n \t\t$current_User->check_perm( 'files', 'add', true, $fileroot_ID );\n \n-\t\tparam( 'path', 'string' );\n-\t\tparam( 'oldfile', 'string' );\n-\t\tparam( 'newfile', 'string' );\n+\t\tparam( 'path', 'filepath' );\n+\t\tparam( 'oldfile', 'filepath' );\n+\t\tparam( 'newfile', 'filepath' );\n \t\tparam( 'format', 'string' );\n \n \t\t$fileroot = explode( '_', $fileroot_ID );\n@@ -863,7 +756,7 @@\n \t\tparam( 'link_owner_ID', 'integer', true );\n \t\t// Additional params, Used to highlight file/folder\n \t\tparam( 'root', 'string', '' );\n-\t\tparam( 'path', 'string', '' );\n+\t\tparam( 'path', 'filepath', '' );\n \t\tparam( 'fm_highlight', 'string', '' );\n \n \t\t$additional_params = empty( $root ) ? '' : '&amp;root='.$root;\n@@ -879,6 +772,36 @@\n \n \t\tbreak;\n \n+\tcase 'file_attachment':\n+\t\t// The content for popup window to link the files to the items/comments\n+\n+\t\t// Check that this action request is not a CSRF hacked request:\n+\t\t$Session->assert_received_crumb( 'file' );\n+\n+\t\t// Check permission:\n+\t\t$current_User->check_perm( 'files', 'view' );\n+\n+\t\tparam( 'iframe_name', 'string', '' );\n+\t\tparam( 'field_name', 'string', '' );\n+\t\t// Additional params, Used to highlight file/folder\n+\t\tparam( 'root', 'string', '' );\n+\t\tparam( 'path', 'string', '' );\n+\t\tparam( 'fm_highlight', 'string', '' );\n+\n+\t\t$additional_params = empty( $root ) ? '' : '&amp;root='.$root;\n+\t\t$additional_params .= empty( $path ) ? '' : '&amp;path='.$path;\n+\t\t$additional_params .= empty( $fm_highlight ) ? '' : '&amp;fm_highlight='.$fm_highlight;\n+\t\t//$additional_params .= empty( $field_name ) ? '' : '&amp;field_name='.$field_name;\n+\n+\t\techo '<div style=\"background:#FFF;height:90%\">'\n+\t\t\t\t.'<span id=\"link_attachment_loader\" class=\"loader_img absolute_center\" title=\"'.T_('Loading...').'\"></span>'\n+\t\t\t\t.'<iframe src=\"'.$admin_url.'?ctrl=files&amp;mode=upload&amp;field_name='.$field_name.'&amp;ajax_request=1&amp;iframe_name='.$iframe_name.'&amp;fm_mode=file_select'.$additional_params.'\"'\n+\t\t\t\t\t.' width=\"100%\" height=\"100%\" marginwidth=\"0\" marginheight=\"0\" align=\"top\" scrolling=\"auto\" frameborder=\"0\"'\n+\t\t\t\t\t.' onload=\"document.getElementById(\\'link_attachment_loader\\').style.display=\\'none\\'\">loading</iframe>'\n+\t\t\t.'</div>';\n+\n+\t\tbreak;\n+\n \tcase 'import_files':\n \t\t// The content for popup window to import the files for XML importer\n "
        },
        {
          "filename": "htsrv/getfile.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -69,7 +69,7 @@\n }\n \n // Load the other params:\n-param( 'path', 'string', true );\n+param( 'path', 'filepath', true );\n param( 'size', 'string', NULL ); // Can be used for images.\n param( 'size_x', 'integer', 1 ); // Ratio size, can be 1, 2 and etc.\n param( 'mtime', 'integer', 0 );  // used for unique URLs (that never expire)."
        },
        {
          "filename": "htsrv/quick_unsubscribe.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -107,6 +107,12 @@\n \t\t\t\t$UserSettings->dbupdate();\n \t\t\t\tbreak;\n \n+\t\t\tcase 'pst_stale_alert':\n+\t\t\t\t// unsubscribe from stale posts alert notifications:\n+\t\t\t\t$UserSettings->set( 'send_pst_stale_alert', '0', $edited_User->ID );\n+\t\t\t\t$UserSettings->dbupdate();\n+\t\t\t\tbreak;\n+\n \t\t\tcase 'post_moderator':\n \t\t\t\t// unsubscribe from new post moderation notifications:\n \t\t\t\t$UserSettings->set( 'notify_post_moderation', '0', $edited_User->ID );"
        },
        {
          "filename": "htsrv/quick_upload.php",
          "status": "modified",
          "additions": 17,
          "deletions": 9,
          "patch": "@@ -224,7 +224,7 @@ function out_echo( $message ,$specialchars )\n global $current_User;\n \n param( 'upload', 'boolean', true );\n-param( 'root_and_path', 'string', true );\n+param( 'root_and_path', 'filepath', true );\n param( 'blog', 'integer' );\n param( 'link_owner', 'string' );\n // Use the glyph or font-awesome icons if requested by skin\n@@ -342,18 +342,25 @@ function out_echo( $message ,$specialchars )\n \n \t\tif( ! empty( $link_owner ) )\n \t\t{\t// Try to link the uploaded file to the object Item/Comment/EmailCampaign:\n-\t\t\tlist( $link_owner_type, $link_owner_ID ) = explode( '_', $link_owner, 2 );\n+\t\t\tlist( $link_owner_type, $link_owner_ID, $link_owner_is_temp ) = explode( '_', $link_owner, 3 );\n \t\t\t$link_owner_ID = intval( $link_owner_ID );\n \t\t\tif( $link_owner_ID > 0 )\n \t\t\t{\n \t\t\t\tswitch( $link_owner_type )\n \t\t\t\t{\n \t\t\t\t\tcase 'item':\n-\t\t\t\t\t\t// Get LinkOwner object of the Item\n-\t\t\t\t\t\t$ItemCache = & get_ItemCache();\n-\t\t\t\t\t\tif( $linked_Item = & $ItemCache->get_by_ID( $link_owner_ID, false, false ) )\n-\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t$LinkOwner = new LinkItem( $linked_Item );\n+\t\t\t\t\t\tif( $link_owner_is_temp )\n+\t\t\t\t\t\t{\t// Get LinkOwner object of the Temporary ID for new creating Item:\n+\t\t\t\t\t\t\tload_class( 'items/model/_item.class.php', 'Item' );\n+\t\t\t\t\t\t\t$LinkOwner = new LinkItem( new Item(), $link_owner_ID );\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\telse\n+\t\t\t\t\t\t{\t// Get LinkOwner object of the Item:\n+\t\t\t\t\t\t\t$ItemCache = & get_ItemCache();\n+\t\t\t\t\t\t\tif( $linked_Item = & $ItemCache->get_by_ID( $link_owner_ID, false, false ) )\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t$LinkOwner = new LinkItem( $linked_Item );\n+\t\t\t\t\t\t\t}\n \t\t\t\t\t\t}\n \t\t\t\t\t\tbreak;\n \n@@ -377,7 +384,8 @@ function out_echo( $message ,$specialchars )\n \n \t\t\t\t\tcase 'message':\n \t\t\t\t\t\t// Get LinkOwner object of the Message:\n-\t\t\t\t\t\t$LinkOwner = new LinkMessage( NULL, $link_owner_ID );\n+\t\t\t\t\t\tload_class( 'messaging/model/_message.class.php', 'Message' );\n+\t\t\t\t\t\t$LinkOwner = new LinkMessage( new Message(), $link_owner_ID );\n \t\t\t\t\t\tbreak;\n \t\t\t\t}\n \t\t\t}\n@@ -449,7 +457,7 @@ function out_echo( $message ,$specialchars )\n \t\t\t$message['status'] = 'success';\n \t\t\treport_user_upload( $newFile );\n \t\t}\n-\n+\t\t$message['filetype'] = $newFile->get( 'type' );\n \t\t$message['newname'] = $newName;\n \t\t$message['newpath'] = $newFile->get_root_and_rel_path();\n \t\t$message['warning'] = $warning;"
        },
        {
          "filename": "htsrv/viewfile.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -51,7 +51,7 @@\n \n // Load the other params:\n param( 'viewtype', 'string', true, true );\n-param( 'path', 'string', true, true );\n+param( 'path', 'filepath', true, true );\n \n if ( false !== strpos( urldecode( $path ), '..' ) )\n {"
        },
        {
          "filename": "inc/_core/_misc.funcs.php",
          "status": "modified",
          "additions": 8,
          "deletions": 5,
          "patch": "@@ -8150,10 +8150,13 @@ function render_inline_files( $content, $Object, $params = array() )\n \t{\t// There are inline tags in the content...\n \n \t\t$rendered_tags = render_inline_tags( $Object, $inlines[0], $params );\n-\t\tforeach( $rendered_tags as $current_link_tag => $rendered_link_tag )\n-\t\t{\n-\t\t\t$content = str_replace( $current_link_tag, $rendered_link_tag, $content );\n-\t\t}\n+\t\tif( $rendered_tags )\n+\t\t{\t// Do replacing if the object really contains inline attached tags:\n+\t\t\tforeach( $rendered_tags as $current_link_tag => $rendered_link_tag )\n+\t\t\t{\n+\t\t\t\t$content = str_replace( $current_link_tag, $rendered_link_tag, $content );\n+\t\t\t}\n+\t\t}\t\n \t}\n \n \treturn $content;\n@@ -8201,7 +8204,7 @@ function render_inline_tags( $Object, $tags, $params = array() )\n \t\tswitch( $object_class )\n \t\t{\n \t\t\tcase 'Item':\n-\t\t\t\t$LinkOwner = new LinkItem( $Object );\n+\t\t\t\t$LinkOwner = new LinkItem( $Object, $temp_link_owner_ID );\n \t\t\t\t$prepare_plugin_event_name = 'PrepareForRenderItemAttachment';\n \t\t\t\t$render_plugin_event_name = 'RenderItemAttachment';\n \t\t\t\tbreak;"
        },
        {
          "filename": "inc/_core/_param.funcs.php",
          "status": "modified",
          "additions": 77,
          "deletions": 5,
          "patch": "@@ -118,12 +118,15 @@ function param_format( $value, $type = 'raw' )\n  * - float, double\n  * - string (strips (HTML-)Tags, trims whitespace)\n  * - text like string but allows multiple lines\n+ * - filepath like string but die execution if it contains unsecure string like \"../\"\n  * - array (it may contains arbitrary array elements) NOTE: If there is one way to avoid and use some other array type then it should not be used\n  * - array:integer (elements of array must be integer)\n  * - array:string (strips (HTML-)Tags, trims whitespace of array's elements)\n+ * - array:filepath (elements of array must be allowed file paths)\n  * - array:/regexp/ (elements of array must match to the given regular expression) e.g. 'array:/^[a-z]*$/'\n  * - array:array:integer (two dimensional array and the elements must be integers)\n  * - array:array:string (strips (HTML-)Tags, trims whitespace of the two dimensional array's elements)\n+ * - array:array:filepath (elements of array must be allowed file paths)\n  * - html (does nothing, for now)\n  * - raw (does nothing)\n  * - '' (does nothing) -- DEPRECATED, use \"raw\" instead\n@@ -289,26 +292,45 @@ function param( $var, $type = 'raw', $default = '', $memorize = false,\n \t\t\t\t$Debuglog->add( 'param(-): <strong>'.$var.'</strong> as url', 'params' );\n \t\t\t\tbreak;\n \n+\t\t\tcase 'filepath':\n+\t\t\t\tif( ! is_scalar( $GLOBALS[$var] ) )\n+\t\t\t\t{\t// This happens if someone uses \"foo[]=x\" where \"foo\" is expected as string\n+\t\t\t\t\tdebug_die( 'param(-): <strong>'.$var.'</strong> is not scalar!' );\n+\t\t\t\t}\n+\n+\t\t\t\t// Format param to valid value:\n+\t\t\t\t$GLOBALS[$var] = param_format( $GLOBALS[$var], 'string' );\n+\n+\t\t\t\tif( ! is_safe_filepath( $GLOBALS[$var] ) )\n+\t\t\t\t{\t// We cannot accept this unsecure file path:\n+\t\t\t\t\tbad_request_die( sprintf( T_('Illegal value received for parameter &laquo;%s&raquo;!'), $var ) );\n+\t\t\t\t}\n+\n+\t\t\t\t$Debuglog->add( 'param(-): <strong>'.$var.'</strong> as filepath', 'params' );\n+\t\t\t\tbreak;\n+\n \t\t\tcase 'array:integer':\n \t\t\tcase 'array:array:integer':\n \t\t\t\t// Set elements type to integer, and set the corresponding regular expression\n \t\t\t\t$elements_type = 'integer';\n \t\t\t\t$elements_regexp = '/^(\\+|-)?[0-9]+$/';\n \t\t\tcase 'array':\n \t\t\tcase 'array:string':\n+\t\t\tcase 'array:filepath':\n \t\t\tcase 'array:regexp':\n \t\t\tcase 'array:array:string':\n+\t\t\tcase 'array:array:filepath':\n \t\t\t\tif( ! is_array( $GLOBALS[$var] ) )\n \t\t\t\t{ // This param must be array\n \t\t\t\t\tdebug_die( 'param(-): <strong>'.$var.'</strong> is not array!' );\n \t\t\t\t}\n \n-\t\t\t\t// Store current array in temp var for checking and preparing\n+\t\t\t\t// Store current array in temp var for checking and preparing:\n \t\t\t\t$globals_var = $GLOBALS[$var];\n-\t\t\t\t// Check if the given array type is one dimensional array\n-\t\t\t\t$one_dimensional = ( ( $type == 'array' ) || ( $type == 'array:integer' ) || ( $type == 'array:string' ) || ( $type == 'array:regexp' ) );\n-\t\t\t\t// Check if the given array type should contains string elements\n-\t\t\t\t$contains_strings = ( ( $type == 'array:string' ) || ( $type == 'array:array:string' ) );\n+\t\t\t\t// Check if the given array type is one dimensional array:\n+\t\t\t\t$one_dimensional = ( ( $type == 'array' ) || ( $type == 'array:integer' ) || ( $type == 'array:string' ) || ( $type == 'array:filepath' ) || ( $type == 'array:regexp' ) );\n+\t\t\t\t// Check if the given array type should contains string elements:\n+\t\t\t\t$contains_strings = ( ( $type == 'array:string' ) || ( $type == 'array:array:string' ) || ( $type == 'array:filepath' ) || ( $type == 'array:array:filepath' ) );\n \t\t\t\tif( $one_dimensional )\n \t\t\t\t{ // Convert to a two dimensional array to handle one and two dimensional arrays the same way\n \t\t\t\t\t$globals_var = array( $globals_var );\n@@ -339,6 +361,14 @@ function param( $var, $type = 'raw', $default = '', $memorize = false,\n \t\t\t\t\t\t{ // Prepare string elements of array\n \t\t\t\t\t\t\t// Format param to valid value:\n \t\t\t\t\t\t\t$globals_var[$i][$j] = param_format( $var_value, 'string' );\n+\n+\t\t\t\t\t\t\tif( $type == 'array:filepath' || $type == 'array:array:filepath' )\n+\t\t\t\t\t\t\t{\t// Special verifying for file path params:\n+\t\t\t\t\t\t\t\tif( ! is_safe_filepath( $globals_var[$i][$j] ) )\n+\t\t\t\t\t\t\t\t{\t// We cannot accept this unsecure file path:\n+\t\t\t\t\t\t\t\t\tbad_request_die( sprintf( T_('Illegal value received for parameter &laquo;%s&raquo;!'), $var ) );\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\tcontinue;\n \t\t\t\t\t\t}\n \n@@ -2699,4 +2729,46 @@ function param_check_serialized_array( $param_name )\n \t}\n }\n \n+\n+/**\n+ * Check if the file path is safe\n+ *\n+ * @param string File path\n+ * @return boolean\n+ */\n+function is_safe_filepath( $filepath )\n+{\n+\tglobal $filemanager_allow_dotdot_in_filenames;\n+\n+\tif( ! isset( $filemanager_allow_dotdot_in_filenames ) )\n+\t{\t// This config var is required:\n+\t\tdebug_die( 'The var <strong>$filemanager_allow_dotdot_in_filenames</strong> must be defined in config file.' );\n+\t}\n+\n+\tif( empty( $filepath ) )\n+\t{\t// Allow empty file path:\n+\t\treturn true;\n+\t}\n+\n+\tif( ! $filemanager_allow_dotdot_in_filenames &&\n+\t    strpos( $filepath, '..' ) !== false )\n+\t{\t// Don't allow .. in file path because it is disable by config:\n+\t\treturn false;\n+\t}\n+\n+\tdo\n+\t{\t// Decode file path while it is possible:\n+\t\t$orig_filepath = $filepath;\n+\t\t$filepath = urldecode( $filepath );\n+\n+\t\tif( strpos( $filepath, '../' ) !== false || strpos( $filepath, '..\\\\' ) !== false )\n+\t\t{\t// Don't allow a traversal directory:\n+\t\t\treturn false;\n+\t\t}\n+\t}\n+\twhile( $filepath != $orig_filepath );\n+\n+\treturn true;\n+}\n+\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "inc/_core/ui/forms/_form.class.php",
          "status": "modified",
          "additions": 260,
          "deletions": 0,
          "patch": "@@ -3678,6 +3678,266 @@ function input_field( $field_params = array() )\n \t}\n \n \n+\tfunction fileselect( $field_name, $field_value, $field_label, $field_note = '', $field_params = array() )\n+\t{\n+\t\tglobal $thumbnail_sizes, $file_select_js_initialized;\n+\n+\t\t$field_params['note'] = $field_note;\n+\t\t$this->handle_common_params( $field_params, $field_name, $field_label );\n+\n+\t\t$field_params = array_merge( array(\n+\t\t\t\t'field_item_start' => '<div class=\"file_select_item\" data-item-value=\"%value%\">',\n+\t\t\t\t'field_item_end' => '</div>',\n+\t\t\t\t'size_name' => 'crop-64x64',\n+\t\t\t\t'class' => '',\n+\t\t\t\t'remove_file_text' => T_('Remove file'),\n+\t\t\t\t'edit_file_text' => T_('Select another'),\n+\t\t\t\t'max_file_num' => 1,\n+\n+\t\t\t\t'window_title' => T_('Attach files'),\n+\t\t\t\t'value_separator' => ';',\n+\t\t\t\t'overflow_mode' => 'queue', // valid values are queue and stack\n+\t\t\t\t'root' => '',\n+\t\t\t\t'path' => ''\n+\t\t\t), $field_params );\n+\n+\t\t\t$FileCache = & get_FileCache();\n+\t\t\t$counter = 0;\n+\n+\t\t\t$field_values = empty( $field_value ) ? $field_value : explode( $field_params['value_separator'], $field_value );\n+\n+\t\t\t$r = $this->begin_field();\n+\t\t\t$remove_icon = get_icon( 'remove' ); // we'll use this to replace the icon in the AJAX added file_select_items later\n+\t\t\t$edit_icon = get_icon( 'edit' ); // we'll use this to replace the icon in the AJAX added file_select_items later\n+\n+\t\t\t$r .= '<input type=\"hidden\" id=\"'.$field_name.'\" name=\"'.$field_name.'\" value=\"'.$field_value.'\">';\n+\n+\t\t\t$r .= '<div name=\"'.$field_name.'\" class=\"file_select_wrapper\" data-max-length=\"'.$field_params['max_file_num']\n+\t\t\t\t\t.'\" data-thumb-size=\"'.$field_params['size_name']\n+\t\t\t\t\t.'\" data-root=\"'.$field_params['root']\n+\t\t\t\t\t.'\" data-path=\"'.$field_params['path']\n+\t\t\t\t\t.'\" data-overflow-mode=\"'.$field_params['overflow_mode'].'\">';\n+\n+\t\t\tif( ! empty( $field_values ) )\n+\t\t\t{\n+\t\t\t\tforeach( $field_values as $file_ID )\n+\t\t\t\t{\n+\t\t\t\t\t$r .= file_select_item( $file_ID, $field_params );\n+\t\t\t\t\t$counter++;\n+\t\t\t\t}\n+\t\t\t}\n+\n+\t\t\tif( ! isset( $thumbnail_sizes[ $field_params['size_name'] ] ) )\n+\t\t\t{ // Wrong thumbnail size name\n+\t\t\t\tdebug_die( 'Invalid thumbnail size name' );\n+\t\t\t}\n+\t\t\t$thumb_type = $thumbnail_sizes[ $field_params['size_name'] ][0];\n+\t\t\t$thumb_width = $thumbnail_sizes[ $field_params['size_name'] ][1];\n+\t\t\t$thumb_height = $thumbnail_sizes[ $field_params['size_name'] ][2];\n+\n+\t\t\t$button_label = ( $counter === 0 ? T_('Select') : get_icon( 'new' ).' '.T_('Add') );\n+\n+\t\t\t$r .= '<button class=\"btn btn-sm btn-info file_select_item\" onclick=\"return window.parent.file_select_attachment_window( this, false );\" style=\"display: '.( $counter < $field_params['max_file_num'] ? 'block' : 'none' ).';\">'.$button_label.'</button>';\n+\n+\t\t\t$r .= '</div>';\n+\t\t\t$r .= $this->end_field();\n+\t\t\techo_modalwindow_js();\n+\n+\t\t\t// We have to encode the params that contain HTML tags\n+\t\t\t$script_params = $field_params;\n+\t\t\t$script_params['field_item_start'] = base64_encode( $script_params['field_item_start'] );\n+\t\t\t$script_params['field_item_end'] = base64_encode( $script_params['field_item_end'] );\n+\n+\t\t\tif( empty( $file_select_js_initialized ) )\n+\t\t\t{\n+\t\t\t\t$r .= '\n+\t\t\t\t\t\t<script type=\"text/javascript\">\n+\t\t\t\t\t\tvar fsel_size, fsel_name, fsel_obj, fsel_replace = false;\n+\n+\t\t\t\t\t\tfunction file_select_attachment_window( event_object, replace_item, fm_highlight )\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tfsel_obj = event_object;\n+\t\t\t\t\t\t\tfsel_replace = replace_item;\n+\t\t\t\t\t\t\tfield_object = jQuery( event_object ).closest( \".file_select_wrapper\" );\n+\t\t\t\t\t\t\tfsel_size = field_object.data( \"thumbSize\" );\n+\t\t\t\t\t\t\tfsel_name = field_object.attr( \"name\" );\n+\t\t\t\t\t\t\troot = field_object.data( \"root\" );\n+\t\t\t\t\t\t\tpath = field_object.data( \"path\" );\n+\n+\t\t\t\t\t\t\topenModalWindow( \\'<span class=\"loader_img loader_user_report absolute_center\" title=\"'.T_('Loading...').'\"></span>\\',\n+\t\t\t\t\t\t\t\t\"90%\", \"80%\", true, \"'.$field_params['window_title'].'\", \"\", true );\n+\t\t\t\t\t\t\tjQuery.ajax(\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\ttype: \"POST\",\n+\t\t\t\t\t\t\t\turl: \"'.get_htsrv_url().'async.php\",\n+\t\t\t\t\t\t\t\tdata:\n+\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\"action\": \"file_attachment\",\n+\t\t\t\t\t\t\t\t\t\"crumb_file\": \"'.get_crumb( 'file' ).'\",\n+\t\t\t\t\t\t\t\t\t\"root\": typeof( root ) == \"undefined\" ? \"\" : root,\n+\t\t\t\t\t\t\t\t\t\"path\": typeof( path ) == \"undefined\" ? \"\" : path,\n+\t\t\t\t\t\t\t\t\t\"fm_highlight\": typeof( fm_highlight ) == \"undefined\" ? \"\" : fm_highlight,\n+\t\t\t\t\t\t\t\t\t\"field_name\": field_object.attr( \"name\" )\n+\t\t\t\t\t\t\t\t},\n+\t\t\t\t\t\t\t\tsuccess: function(result)\n+\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\topenModalWindow( result, \"90%\", \"80%\", true, \"'.$field_params['window_title'].'\", \"\" );\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t} );\n+\t\t\t\t\t\t\treturn false;\n+\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\tfunction file_select_add( fieldName, root, path )\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t// check if value is already present\n+\t\t\t\t\t\t\tvar inputField = jQuery( \"input#\" + fieldName );\n+\t\t\t\t\t\t\tvar values = inputField.val().split( \"'.$field_params['value_separator'].'\" );\n+\n+\t\t\t\t\t\t\t// Add new item\n+\t\t\t\t\t\t\tjQuery.ajax({\n+\t\t\t\t\t\t\t\ttype: \"GET\",\n+\t\t\t\t\t\t\t\turl: \"'.get_htsrv_url().'anon_async.php\",\n+\t\t\t\t\t\t\t\tdata: {\n+\t\t\t\t\t\t\t\t\t\t\"action\": \"get_file_select_item\",\n+\t\t\t\t\t\t\t\t\t\t\"field_name\": fieldName,\n+\t\t\t\t\t\t\t\t\t\t\"root\": root,\n+\t\t\t\t\t\t\t\t\t\t\"path\": path,\n+\t\t\t\t\t\t\t\t\t\t\"params\": '.json_encode( $script_params ).'\n+\t\t\t\t\t\t\t\t\t},\n+\t\t\t\t\t\t\t\tsuccess: function( result )\n+\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\tresult = jQuery.parseJSON( ajax_debug_clear( result) );\n+\t\t\t\t\t\t\t\t\t\tvar fieldName = result.fieldName;\n+\t\t\t\t\t\t\t\t\t\tvar fieldValue = result.fieldValue;\n+\t\t\t\t\t\t\t\t\t\tvar inputField = jQuery( \"input#\" + fieldName );\n+\t\t\t\t\t\t\t\t\t\tvar wrapper = jQuery( \"div[name=\" + fieldName + \"].file_select_wrapper\" );\n+\t\t\t\t\t\t\t\t\t\tvar maxLength = wrapper.data( \"maxLength\" );\n+\t\t\t\t\t\t\t\t\t\tvar overflowMode = wrapper.data( \"overflowMode\" );\n+\t\t\t\t\t\t\t\t\t\tvar addButton = jQuery( \"button\", wrapper );\n+\t\t\t\t\t\t\t\t\t\tvar items = jQuery( \".file_select_item:not(button)\", wrapper );\n+\t\t\t\t\t\t\t\t\t\tvar lastItem = items.last();\n+\n+\t\t\t\t\t\t\t\t\t\tvar newItem = jQuery( atob( result.item ) );\n+\n+\t\t\t\t\t\t\t\t\t\tif( fsel_replace )\n+\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\tvar item = jQuery( fsel_obj ).closest( \".file_select_item\" );\n+\t\t\t\t\t\t\t\t\t\t\tnewItem.insertAfter( item );\n+\t\t\t\t\t\t\t\t\t\t\tfile_select_delete( item );\n+\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t\telse\n+\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\t// Attach new item\n+\t\t\t\t\t\t\t\t\t\t\t// check if adding item will result to an overflow\n+\t\t\t\t\t\t\t\t\t\t\tif( items.length >= maxLength )\n+\t\t\t\t\t\t\t\t\t\t\t{ // remove extra item first depending on overflow mode\n+\t\t\t\t\t\t\t\t\t\t\t\tif( overflowMode == \"queue\" )\n+\t\t\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\t\t\tfile_select_delete( items.first() );\n+\t\t\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t\t\t\telse if( overflowMode == \"stack\" )\n+\t\t\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\t\t\tfile_select_delete( items.last() );\n+\t\t\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\t\t\titems = jQuery( \".file_select_item:not(button)\", wrapper );\n+\t\t\t\t\t\t\t\t\t\t\t\tlastItem = items.last();\n+\t\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\t\tif( lastItem.length )\n+\t\t\t\t\t\t\t\t\t\t\t{ // attachment already exists, add to the last\n+\t\t\t\t\t\t\t\t\t\t\t\tnewItem.insertAfter( lastItem );\n+\t\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t\t\telse\n+\t\t\t\t\t\t\t\t\t\t\t{ // no attachments yet\n+\t\t\t\t\t\t\t\t\t\t\t\twrapper.prepend( newItem );\n+\t\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\tnewItem.find( \"span.remove_file_icon\" ).replaceWith(\\''.$remove_icon.'\\'); // replace unlink icon with skin specific icon saved earlier\n+\t\t\t\t\t\t\t\t\t\tnewItem.find( \"span.edit_file_icon\" ).replaceWith(\\''.$edit_icon.'\\'); // replace unlink icon with skin specific icon saved earlier\n+\n+\t\t\t\t\t\t\t\t\t\titems = jQuery( \".file_select_item:not(button)\", wrapper );\n+\t\t\t\t\t\t\t\t\t\tlastItem = items.last();\n+\n+\t\t\t\t\t\t\t\t\t\t// Toggle add button\n+\t\t\t\t\t\t\t\t\t\taddButton.html( items.length === 0 ? \"'.T_('Select').'\" : \\''.get_icon( 'new' ).' '.T_('Add').'\\' );\n+\t\t\t\t\t\t\t\t\t\tif( maxLength > items.length )\n+\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\taddButton.show();\n+\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t\telse\n+\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\taddButton.hide();\n+\t\t\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t\t\t// append field value\n+\t\t\t\t\t\t\t\t\t\tvar values = inputField.val();\n+\t\t\t\t\t\t\t\t\t\tvalues = values ? ( inputField.val().split( \"'.$field_params['value_separator'].'\" ) ) : [];\n+\t\t\t\t\t\t\t\t\t\tvalues.push( fieldValue );\n+\t\t\t\t\t\t\t\t\t\tinputField.val( values.join( \"'.$field_params['value_separator'].'\" ) );\n+\n+\t\t\t\t\t\t\t\t\t\t// Trigger change so bozo validator will pickup the change\n+\t\t\t\t\t\t\t\t\t\tinputField.trigger( \"change\" );\n+\n+\t\t\t\t\t\t\t\t\t\t// close modal if single item select\n+\t\t\t\t\t\t\t\t\t\tif( maxLength == 1 )\n+\t\t\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t\t\t\tcloseModalWindow();\n+\t\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t});\n+\n+\t\t\t\t\t\t\treturn false;\n+\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\tfunction file_select_delete( event_object )\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tvar wrapper = jQuery( event_object ).closest( \".file_select_wrapper\" );\n+\t\t\t\t\t\t\tvar item = jQuery( event_object ).closest( \".file_select_item\" );\n+\t\t\t\t\t\t\tvar fieldName = wrapper.attr( \"name\" );\n+\t\t\t\t\t\t\tvar fieldValue = item.data( \"itemValue\" ).toString(); // converted to string because it will later be compared to array of strings\n+\t\t\t\t\t\t\tvar maxLength = wrapper.data( \"maxLength\" );\n+\t\t\t\t\t\t\tvar addButton = jQuery( \"button\", wrapper );\n+\n+\t\t\t\t\t\t\t// Remove file select item\n+\t\t\t\t\t\t\titem.remove();\n+\n+\t\t\t\t\t\t\tvar items = jQuery( \".file_select_item:not(button)\", wrapper );\n+\t\t\t\t\t\t\tvar lastItem = items.last();\n+\n+\t\t\t\t\t\t\t// Toggle add button\n+\t\t\t\t\t\t\taddButton.html( items.length === 0 ? \"'.T_('Select').'\" : \\''.get_icon( 'new' ).' '.T_('Add').'\\' );\n+\t\t\t\t\t\t\tif( maxLength > items.length )\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\taddButton.show();\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\telse\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\taddButton.hide();\n+\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t// Change input value\n+\t\t\t\t\t\t\tvar inputField = jQuery( \"input#\" + fieldName );\n+\t\t\t\t\t\t\tvar values = inputField.val().split( \"'.$field_params['value_separator'].'\" );\n+\t\t\t\t\t\t\tvar index =  values.indexOf( fieldValue );\n+\t\t\t\t\t\t\tif( index != -1 )\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tvalues.splice( index, 1 );\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tinputField.val( values.join( \"'.$field_params['value_separator'].'\" ) );\n+\t\t\t\t\t\t\tinputField.trigger( \"change\" );\n+\n+\t\t\t\t\t\t\treturn false;\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\t</script>';\n+\t\t\t}\n+\n+\t\t\t$file_select_js_initialized = true;\n+\t\t\treturn $this->display_or_return( $r );\n+\t}\n+\n+\n \t/**\n \t * Generate a general input element.\n \t *"
        },
        {
          "filename": "inc/_core/ui/forms/_form.funcs.php",
          "status": "modified",
          "additions": 57,
          "deletions": 0,
          "patch": "@@ -305,4 +305,61 @@ function form_textarea( $field_name, $field_value, $field_rows, $field_label, $f\n \techo $r;\n }\n \n+\n+/**\n+ * Builds a fileselect item\n+ *\n+ * @param integer ID of file to generate thumbnail\n+ * @param array params\n+ */\n+function file_select_item( $file_ID, $params = array() )\n+{\n+\t$FileCache = & get_FileCache();\n+\t$File = & $FileCache->get_by_ID( $file_ID, false );\n+\n+\t$params = array_merge( array(\n+\t\t\t'field_item_start' => '<div class=\"file_select_item\" data-item-value=\"%value%\">',\n+\t\t\t'field_item_end' => '</div>',\n+\t\t\t'size_name' => 'crop-64x64',\n+\t\t\t'class' => '',\n+\t\t\t'remove_file_text' => T_('Remove file'),\n+\t\t\t'edit_file_text' => T_('Select another'),\n+\t\t\t'max_file_num' => 1\n+\t\t), $params );\n+\n+\t$r = str_replace( '%value%', $file_ID, $params['field_item_start'] );\n+\t$r .= $params['max_file_num'] > 1 ? '<div>' : '';\n+\tif( $File )\n+\t{\n+\t\t$r .= $File->get_thumb_imgtag( $params['size_name'], $params['class'] );\n+\t}\n+\telse\n+\t{\n+\t\t$r .= '<div class=\"bg-danger\">File Not Found</div>';\n+\t}\n+\t$blog_param = empty( $blog ) ? '' : '&amp;blog='.$blog;\n+\tif( $params['max_file_num'] > 1 )\n+\t{\n+\t\t$r .= '<div>';\n+\t}\n+\telse\n+\t{\n+\t\t$r .= '<div class=\"item_actions\">';\n+\t}\n+\t$r .= action_icon( $params['remove_file_text'], 'remove',\n+\t\t\t'', T_('Remove'), NULL, $params['max_file_num'] > 1 ? NULL : 4,\n+\t\t\tarray( 'onclick' => 'return file_select_delete( this );' ),\n+\t\t\tarray( 'class' => 'remove_file_icon' ) );\n+\t//$r .= $params['max_file_num'] > 1 ? '' : '<br>';\n+\t$r .= action_icon( $params['edit_file_text'], 'edit',\n+\t\t\t'', T_('Select another'), NULL, $params['max_file_num'] > 1 ? NULL : 4,\n+\t\t\tarray( 'onclick' => 'return window.parent.file_select_attachment_window( this, true );' ),\n+\t\t\tarray( 'class' => 'edit_file_icon' ) );\n+\t//$r .= $params['max_file_num'] > 1 ? '' : '</div>';\n+\t$r .= '</div>';\n+\t$r .= $params['max_file_num'] > 1 ? '</div>' : '';\n+\t$r .= $params['field_item_end'];\n+\n+\treturn $r;\n+}\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "inc/_ext/phpwhois/whois.client.php",
          "status": "modified",
          "additions": 89,
          "deletions": 86,
          "patch": "@@ -30,7 +30,7 @@\n require_once('whois.ip.lib.php');\r\n \r\n class WhoisClient {\r\n-\t\r\n+\r\n \t// Recursion allowed ?\r\n \tvar $gtld_recurse = false;\r\n \r\n@@ -45,13 +45,13 @@ class WhoisClient {\n \r\n \t// Read buffer size (0 == char by char)\r\n \tvar $BUFFER = 1024;\r\n-\t\r\n+\r\n \t// Communications timeout\r\n \tvar $STIMEOUT = 10;\r\n \r\n \t// List of servers and handlers (loaded from servers.whois)\r\n-\tvar $DATA = array(); \t\r\n-\t\r\n+\tvar $DATA = array();\r\n+\r\n \t// Array to contain all query variables\r\n \tvar $Query = array(\r\n \t\t'tld' => '',\r\n@@ -63,56 +63,56 @@ class WhoisClient {\n \r\n \t// This release of the package\r\n \tvar $CODE_VERSION = '4.2.2';\r\n-\t\r\n+\r\n \t// Full code and data version string (e.g. 'Whois2.php v3.01:16')\r\n \tvar $VERSION;\r\n-\t\r\n+\r\n \t/*\r\n \t * Constructor function\r\n \t */\r\n \tfunction __construct () {\r\n \r\n \t\t// Load DATA array\r\n-\t\t@require('whois.servers.php');\t\t\r\n+\t\t@require('whois.servers.php');\r\n \r\n \t\t// Set version\r\n \t\t$this->VERSION = sprintf(\"phpWhois v%s-%s\", $this->CODE_VERSION, $this->DATA_VERSION);\r\n \t}\r\n-\t\t\r\n+\r\n \t/*\r\n \t * Perform lookup\r\n \t */\r\n \r\n \tfunction GetRawData ($query) {\r\n-\t\t\r\n+\r\n \t\t$this->Query['query'] = $query;\r\n-\t\t\r\n+\r\n \t\t// clear error description\r\n \t\tif (isset($this->Query['errstr'])) unset($this->Query['errstr']);\r\n-\t\t\r\n+\r\n \t\tif (!isset($this->Query['server'])) {\r\n \t\t\t$this->Query['status'] = 'error';\r\n \t\t\t$this->Query['errstr'][] = 'No server specified';\r\n \t\t\treturn(array());\r\n \t\t\t}\r\n \r\n \t\t// Check if protocol is http\r\n-\t\t\r\n+\r\n \t\tif (substr($this->Query['server'],0,7)=='http://' ||\r\n \t\t\tsubstr($this->Query['server'],0,8)=='https://')\r\n \t\t\t{\r\n \t\t\t$output = $this->httpQuery($this->Query['server']);\r\n-\t\t\t\r\n+\r\n \t\t\tif (!$output)\r\n \t\t\t\t{\r\n \t\t\t\t$this->Query['status'] = 'error';\r\n \t\t\t\t$this->Query['errstr'][] = 'Connect failed to: '.$this->Query['server'];\r\n \t\t\t\treturn(array());\r\n \t\t\t\t}\r\n-\t\t\t\t\r\n+\r\n \t\t\t$this->Query['args'] = substr(strchr($this->Query['server'],'?'),1);\r\n \t\t\t$this->Query['server'] = strtok($this->Query['server'],'?');\r\n-\t\t\t\r\n+\r\n \t\t\tif (substr($this->Query['server'],0,7)=='http://')\r\n \t\t\t\t$this->Query['server_port'] = 80;\r\n \t\t\telse\r\n@@ -121,22 +121,22 @@ function GetRawData ($query) {\n \t\telse\r\n \t\t\t{\r\n \t\t\t// Get args\r\n-\t\t\t\r\n+\r\n \t\t\tif (strpos($this->Query['server'],'?'))\r\n \t\t\t\t{\r\n \t\t\t\t$parts = explode('?',$this->Query['server']);\r\n \t\t\t\t$this->Query['server'] = trim($parts[0]);\r\n \t\t\t\t$query_args = trim($parts[1]);\r\n-\t\t\t\t\r\n-\t\t\t\t// replace substitution parameters\t\t\t\r\n+\r\n+\t\t\t\t// replace substitution parameters\r\n \t\t\t\t$query_args = str_replace('{query}', $query, $query_args);\r\n \t\t\t\t$query_args = str_replace('{version}', 'phpWhois'.$this->CODE_VERSION, $query_args);\r\n-\t\t\t\t\r\n+\r\n \t\t\t\tif (strpos($query_args,'{ip}')!==false)\r\n \t\t\t\t\t{\r\n \t\t\t\t\t$query_args = str_replace('{ip}', phpwhois_getclientip(), $query_args);\r\n \t\t\t\t\t}\r\n-\t\t\t\t\t\r\n+\r\n \t\t\t\tif (strpos($query_args,'{hname}')!==false)\r\n \t\t\t\t\t{\r\n \t\t\t\t\t$query_args = str_replace('{hname}', gethostbyaddr(phpwhois_getclientip()), $query_args);\r\n@@ -161,18 +161,18 @@ function GetRawData ($query) {\n \t\t\t\t{\r\n \t\t\t\t$this->Query['server'] = substr($this->Query['server'],8);\r\n \t\t\t\t}\r\n-\t\t\t\r\n+\r\n \t\t\t// Get port\r\n-\t\t\t\r\n+\r\n \t\t\tif (strpos($this->Query['server'],':'))\r\n \t\t\t\t{\r\n \t\t\t\t$parts = explode(':',$this->Query['server']);\r\n \t\t\t\t$this->Query['server'] = trim($parts[0]);\r\n \t\t\t\t$this->Query['server_port'] = trim($parts[1]);\r\n \t\t\t\t}\r\n-\t\t\telse\t\t\t\r\n+\t\t\telse\r\n \t\t\t\t$this->Query['server_port'] = $this->PORT;\r\n-\t\t\t\t\r\n+\r\n \t\t\t// Connect to whois server, or return if failed\r\n \r\n \t\t\t$ptr = $this->Connect();\r\n@@ -185,10 +185,10 @@ function GetRawData ($query) {\n \r\n \t\t\tstream_set_timeout($ptr,$this->STIMEOUT);\r\n \t\t\tstream_set_blocking($ptr,0);\r\n-\t\t\t\r\n+\r\n \t\t\t// Send query\r\n \t\t\tfputs($ptr, trim($query_args).\"\\r\\n\");\r\n-\t\t\t\r\n+\r\n \t\t\t// Prepare to receive result\r\n \t\t\t$raw = '';\r\n \t\t\t$start = time();\r\n@@ -197,9 +197,12 @@ function GetRawData ($query) {\n \r\n \t\t\twhile (!feof($ptr))\r\n \t\t\t\t{\r\n-\t\t\t\tif (stream_select($r,$null,$null,$this->STIMEOUT))\r\n+\t\t\t\tif(!empty($r))\r\n \t\t\t\t\t{\r\n-\t\t\t\t\t$raw .= fgets($ptr, $this->BUFFER);\r\n+\t\t\t\t\tif (stream_select($r,$null,$null,$this->STIMEOUT))\r\n+\t\t\t\t\t\t{\r\n+\t\t\t\t\t\t$raw .= fgets($ptr, $this->BUFFER);\r\n+\t\t\t\t\t\t}\r\n \t\t\t\t\t}\r\n \r\n \t\t\t\tif (time()-$start > $this->STIMEOUT)\r\n@@ -221,8 +224,8 @@ function GetRawData ($query) {\n \t\t\tif (empty($output[count($output)-1]))\r\n \t\t\t\tunset($output[count($output)-1]);\r\n \t\t\t}\r\n-\t\t\r\n-\t\treturn $output;\t\r\n+\r\n+\t\treturn $output;\r\n \t}\r\n \r\n \t/*\r\n@@ -233,59 +236,59 @@ function GetRawData ($query) {\n \t */\r\n \r\n \tfunction GetData ($query='', $deep_whois=true) {\r\n-\t\r\n+\r\n \t\t// If domain to query passed in, use it, otherwise use domain from initialisation\r\n \t\t$query = !empty($query) ? $query : $this->Query['query'];\r\n-\t\t\t\t\r\n+\r\n \t\t$output = $this->GetRawData($query);\r\n-\t\t\t\t\t\t\r\n+\r\n \t\t// Create result and set 'rawdata'\r\n-\t\t$result = array( 'rawdata' => $output );\t\t\r\n+\t\t$result = array( 'rawdata' => $output );\r\n \t\t$result = $this->set_whois_info($result);\r\n \r\n \t\t// Return now on error\r\n \t\tif (empty($output)) return $result;\r\n-\t\t\r\n+\r\n \t\t// If we have a handler, post-process it with it\r\n \t\tif (isSet($this->Query['handler']))\r\n \t\t\t{\r\n \t\t\t// Keep server list\r\n \t\t\t$servers = $result['regyinfo']['servers'];\r\n \t\t\tunset($result['regyinfo']['servers']);\r\n-\t\t\t\r\n+\r\n \t\t\t// Process data\r\n \t\t\t$result = $this->Process($result,$deep_whois);\r\n-\t\t\r\n+\r\n \t\t\t// Add new servers to the server list\r\n \t\t\tif (isset($result['regyinfo']['servers']))\r\n \t\t\t\t$result['regyinfo']['servers'] = array_merge($servers,$result['regyinfo']['servers']);\r\n \t\t\telse\r\n \t\t\t\t$result['regyinfo']['servers'] = $servers;\r\n-\t\t\t\r\n+\r\n \t\t\t// Handler may forget to set rawdata\r\n \t\t\tif (!isset($result['rawdata']))\r\n \t\t\t\t$result['rawdata'] = $output;\r\n \t\t\t}\r\n \r\n \t\t// Type defaults to domain\r\n \t\tif (!isset($result['regyinfo']['type']))\r\n-\t\t\t$result['regyinfo']['type'] = 'domain';\t\r\n-\t\t\r\n+\t\t\t$result['regyinfo']['type'] = 'domain';\r\n+\r\n \t\t// Add error information if any\r\n \t\tif (isset($this->Query['errstr']))\r\n \t\t\t$result['errstr'] = $this->Query['errstr'];\r\n \r\n \t\t// Fix/add nameserver information\r\n \t\tif (method_exists($this,'FixResult') && $this->Query['tld'] != 'ip')\r\n \t\t\t$this->FixResult($result,$query);\r\n-\t\t\t\r\n+\r\n \t\treturn($result);\r\n \t}\r\n-\t\r\n+\r\n \t/*\r\n \t*   Adds whois server query information to result\r\n \t*/\r\n-\t\r\n+\r\n \tfunction set_whois_info ($result)\r\n \t\t{\r\n \t\t$info = array(\r\n@@ -296,35 +299,35 @@ function set_whois_info ($result)\n \t\t\t$info['args'] = $this->Query['args'];\r\n \t\telse\r\n \t\t\t$info['args'] = $this->Query['query'];\r\n-\t\t\r\n+\r\n \t\tif (!empty($this->Query['server_port']))\r\n \t\t\t$info['port'] = $this->Query['server_port'];\r\n \t\telse\r\n \t\t\t$info['port'] = 43;\r\n-\t\t\t\r\n+\r\n \t\tif (isset($result['regyinfo']['whois']))\r\n \t\t\tunset($result['regyinfo']['whois']);\r\n-\t\t\r\n+\r\n \t\tif (isset($result['regyinfo']['rwhois']))\r\n \t\t\tunset($result['regyinfo']['rwhois']);\r\n-\t\t\t\r\n+\r\n \t\t$result['regyinfo']['servers'][] = $info;\r\n-\t\t\r\n+\r\n \t\treturn $result;\r\n \t\t}\r\n \r\n \t/*\r\n \t*   Convert html output to plain text\r\n \t*/\r\n \tfunction httpQuery ($query) {\r\n-\t\t\r\n+\r\n \t\t//echo ini_get('allow_url_fopen');\r\n-\t\t\r\n+\r\n \t\t//if (ini_get('allow_url_fopen'))\r\n-\t\t\t$lines = @file($this->Query['server']);\t\t\r\n-\t\t\t\r\n+\t\t\t$lines = @file($this->Query['server']);\r\n+\r\n \t\tif (!$lines) return false;\r\n-\t\t\r\n+\r\n \t\t$output = '';\r\n \t\t$pre = '';\r\n \r\n@@ -345,7 +348,7 @@ function httpQuery ($query) {\n \t\t\t\t}\r\n \t\t\t$output.=$val.$pre;\r\n \t\t\t}\r\n-\t\t\t\r\n+\r\n \t\t$search = array (\r\n \t\t\t\t'<BR>', '<P>', '</TITLE>',\r\n \t\t\t\t'</H1>', '</H2>', '</H3>',\r\n@@ -358,7 +361,7 @@ function httpQuery ($query) {\n \t\t$output = str_replace('<tr',\"\\n<tr\",$output);\r\n \t\t$output = str_replace('<TR',\"\\n<tr\",$output);\r\n \t\t$output = str_replace('&nbsp;',' ',$output);\r\n-\t\t$output = strip_tags($output);\t\t\r\n+\t\t$output = strip_tags($output);\r\n \t\t$output = explode(\"\\n\",$output);\r\n \r\n \t\t$rawdata = array();\r\n@@ -374,52 +377,52 @@ function httpQuery ($query) {\n \t\t}\r\n \t\treturn $rawdata;\r\n \t}\r\n-\t\r\n+\r\n \t/*\r\n \t * Open a socket to the whois server.\r\n \t *\r\n \t * Returns a socket connection pointer on success, or -1 on failure.\r\n \t */\r\n \tfunction Connect ($server = '') {\r\n-\t\r\n+\r\n \t\tif ($server == '')\r\n \t\t\t$server = $this->Query['server'];\r\n-\t\t\t\r\n+\r\n \t\t// Fail if server not set\r\n \t\tif($server == '')\r\n \t\t\treturn(-1);\r\n \r\n \t\t// Get rid of protocol and/or get port\r\n \t\t$port = $this->Query['server_port'];\r\n-\t\t\r\n+\r\n \t\t$pos = strpos($server,'://');\r\n-\t\t\r\n+\r\n \t\tif ($pos !== false)\r\n \t\t\t$server = substr($server, $pos+3);\r\n-\t\t\t\r\n+\r\n \t\t$pos = strpos($server,':');\r\n-\t\t\r\n+\r\n \t\tif ($pos !== false)\r\n \t\t\t{\r\n \t\t\t$port = substr($server,$pos+1);\r\n-\t\t\t$server = substr($server,0,$pos);\t\t\t\r\n+\t\t\t$server = substr($server,0,$pos);\r\n \t\t\t}\r\n-\t\t\t\r\n+\r\n \t\t// Enter connection attempt loop\r\n \t\t$retry = 0;\r\n-\t\t\r\n+\r\n \t\twhile($retry <= $this->RETRY) {\r\n \t\t\t// Set query status\r\n \t\t\t$this->Query['status'] = 'ready';\r\n \r\n \t\t\t// Connect to whois port\r\n \t\t\t$ptr = @fsockopen($server, $port, $errno, $errstr, $this->STIMEOUT);\r\n-\t\t\t\r\n+\r\n \t\t\tif($ptr > 0) {\r\n \t\t\t\t$this->Query['status'] = 'ok';\r\n \t\t\t\treturn($ptr);\r\n \t\t\t}\r\n-\t\t\t\r\n+\r\n \t\t\t// Failed this attempt\r\n \t\t\t$this->Query['status'] = 'error';\r\n \t\t\t$this->Query['error'][] = $errstr;\r\n@@ -428,11 +431,11 @@ function Connect ($server = '') {\n \t\t\t// Sleep before retrying\r\n \t\t\tsleep($this->SLEEP);\r\n \t\t}\r\n-\t\t\r\n+\r\n \t\t// If we get this far, it hasn't worked\r\n \t\treturn(-1);\r\n-\t} \t\r\n-\t\r\n+\t}\r\n+\r\n \t/*\r\n \t * Post-process result with handler class. On success, returns the result\r\n \t * from the handler. On failure, returns passed result unaltered.\r\n@@ -459,7 +462,7 @@ function Process (&$result, $deep_whois=true) {\n \r\n \t\t// Pass result to handler\r\n \t\t$object = $handler_name.'_handler';\r\n-\t\t\r\n+\r\n \t\t$handler = new $object('');\r\n \r\n \t\t// If handler returned an error, append it to the query errors list\r\n@@ -473,16 +476,16 @@ function Process (&$result, $deep_whois=true) {\n \r\n \t\t// Return the result\r\n \t\treturn $res;\r\n-\t}\t\r\n-\t\r\n+\t}\r\n+\r\n \t/*\r\n \t * Does more (deeper) whois ...\r\n \t */\r\n-\t \r\n+\r\n \tfunction DeepWhois ($query, $result) {\r\n-\t\r\n+\r\n \t\tif (!isset($result['regyinfo']['whois'])) return $result;\r\n-\t\t\r\n+\r\n \t\t$this->Query['server'] = $wserver = $result['regyinfo']['whois'];\r\n \t\tunset($result['regyinfo']['whois']);\r\n \t\t$subresult = $this->GetRawData($query);\r\n@@ -491,7 +494,7 @@ function DeepWhois ($query, $result) {\n \t\t\t{\r\n \t\t\t$result = $this->set_whois_info($result);\r\n \t\t\t$result['rawdata'] = $subresult;\r\n-\t\t\r\n+\r\n \t\t\tif (isset($this->WHOIS_GTLD_HANDLER[$wserver]))\r\n \t\t\t\t$this->Query['handler'] = $this->WHOIS_GTLD_HANDLER[$wserver];\r\n \t\t\telse\r\n@@ -502,27 +505,27 @@ function DeepWhois ($query, $result) {\n \t\t\t\tif (($fp = @fopen('whois.gtld.'.$hname.'.php', 'r', 1)) and fclose($fp))\r\n \t\t\t\t\t$this->Query['handler'] = $hname;\r\n \t\t\t\t}\r\n-\t\t\t\t\r\n+\r\n \t\t\tif (!empty($this->Query['handler']))\r\n-\t\t\t\t{\t\t\t\r\n+\t\t\t\t{\r\n \t\t\t\t$this->Query['file'] = sprintf('whois.gtld.%s.php', $this->Query['handler']);\r\n \t\t\t\t$regrinfo = $this->Process($subresult); //$result['rawdata']);\r\n \t\t\t\t$result['regrinfo'] = $this->merge_results($result['regrinfo'], $regrinfo);\r\n \t\t\t\t//$result['rawdata'] = $subresult;\r\n \t\t\t\t}\r\n \t\t\t}\r\n-\t\t\t\t\r\n+\r\n \t\treturn $result;\r\n \t}\r\n-\t\r\n+\r\n \t/*\r\n \t *  Merge results\r\n \t */\r\n-\t \r\n+\r\n \tfunction merge_results($a1, $a2) {\r\n \r\n \t\treset($a2);\r\n-\t\r\n+\r\n \t\twhile (list($key, $val) = each($a2))\r\n \t\t\t{\r\n \t\t\tif (isset($a1[$key]))\r\n@@ -542,10 +545,10 @@ function merge_results($a1, $a2) {\n \t\t\telse\r\n \t\t\t\t$a1[$key] = $val;\r\n \t\t\t}\r\n-\t\r\n+\r\n \t\treturn $a1;\r\n \t}\r\n-\t\r\n+\r\n \tfunction FixNameServer($nserver)\r\n \t\t{\r\n \t\t$dns = array();\r\n@@ -588,7 +591,7 @@ function FixNameServer($nserver)\n \t\t\t\t}\r\n \r\n \t\t\tif (substr($host,-1,1) == '.') $host = substr($host,0,-1);\r\n-\t\t\t\t\r\n+\r\n \t\t\t$dns[strtolower($host)] = $ip;\r\n \t\t\t}\r\n \r"
        },
        {
          "filename": "inc/_ext/phpwhois/whois.ip.php",
          "status": "modified",
          "additions": 26,
          "deletions": 15,
          "patch": "@@ -23,7 +23,9 @@\n You should have received a copy of the GNU General Public License\n along with this program; if not, write to the Free Software\n Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n- */\n+\n+erhsatingin > Added fix for empty ip range\n+*/\n \n if (!defined('__IP_HANDLER__'))\n \tdefine('__IP_HANDLER__', 1);\n@@ -100,25 +102,34 @@ function parse($data, $query)\n \t\t\t\tif ($p !== false)\n \t\t\t\t\t{\n \t\t\t\t\t$net = strtok(substr($line,$p+1),') ');\n-\t\t\t\t\tlist($low,$high) = explode('-',str_replace(' ','',substr($line,$p+strlen($net)+3)));\n-\n-\t\t\t\t\tif (!isset($done[$net]) && $ip >= ip2long($low) && $ip <= ip2long($high))\n+\t\t\t\t\t$iprange = substr($line,$p+strlen($net)+3);\n+\t\t\t\t\tif( $iprange )\n \t\t\t\t\t\t{\n-\t\t\t\t\t\t$owner = substr($line,0,$p-1);\n+\t\t\t\t\t\tlist($low,$high) = explode('-',str_replace(' ','',substr($line,$p+strlen($net)+3)));\n \n-\t\t\t\t\t\tif (!empty($this->REGISTRARS['owner']))\n+\n+\t\t\t\t\t\tif (!isset($done[$net]) && $ip >= ip2long($low) && $ip <= ip2long($high))\n \t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t$this->handle_rwhois($this->REGISTRARS['owner'],$query);\n-\t\t\t\t\t\t\tbreak 2;\n+\t\t\t\t\t\t\t$owner = substr($line,0,$p-1);\n+\n+\t\t\t\t\t\t\tif (!empty($this->REGISTRARS['owner']))\n+\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t$this->handle_rwhois($this->REGISTRARS['owner'],$query);\n+\t\t\t\t\t\t\t\tbreak 2;\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\telse\n+\t\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\t$this->Query['args'] = 'n '.$net;\n+\t\t\t\t\t\t\t\t$presults[] = $this->GetRawData($net);\n+\t\t\t\t\t\t\t\t$done[$net] = 1;\n+\t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t}\n+\t\t\t\t\t\t$found = true;\n+\t\t\t\t\t\t}\n \t\t\t\t\t\telse\n-\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t$this->Query['args'] = 'n '.$net;\n-\t\t\t\t\t\t\t$presults[] = $this->GetRawData($net);\n-\t\t\t\t\t\t\t$done[$net] = 1;\n-\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t$found = false;\n \t\t\t\t\t\t}\n-\t\t\t\t\t$found = true;\n \t\t\t\t\t}\n \t\t\t\t}\n \n@@ -132,7 +143,7 @@ function parse($data, $query)\n \n \t\tunset($this->Query['args']);\n \n-\t\twhile (count($this->more_data) > 0)\r\n+\t\twhile (count($this->more_data) > 0)\n \t\t\t{\n \t\t\t$srv_data = array_shift($this->more_data);\n \t\t\t$this->Query['server'] = $srv_data['server'];"
        },
        {
          "filename": "inc/chapters/model/_chapter.class.php",
          "status": "modified",
          "additions": 17,
          "deletions": 1,
          "patch": "@@ -85,6 +85,11 @@ class Chapter extends DataObject\n \t */\n \tvar $subcat_ordering;\n \n+\t/**\n+\t * Category image\n+ \t */\n+\tvar $image_file_ID;\n+\n \t/**\n \t * Constructor\n \t *\n@@ -101,11 +106,12 @@ function __construct( $db_row = NULL, $subset_ID = NULL )\n \t\t\t$this->set( 'blog_ID', $subset_ID );\n \t\t}\n \t\telse\n-\t\t{\t// Wa are loading an object:\n+\t\t{\t// We are loading an object:\n \t\t\t$this->ID = $db_row->cat_ID;\n \t\t\t$this->name = $db_row->cat_name;\n \t\t\t$this->parent_ID = $db_row->cat_parent_ID;\n \t\t\t$this->blog_ID = $db_row->cat_blog_ID;\n+\t\t\t$this->image_file_ID = $db_row->cat_image_file_ID;\n \t\t\t$this->urlname = $db_row->cat_urlname;\n \t\t\t$this->description = $db_row->cat_description;\n \t\t\t$this->order = $db_row->cat_order;\n@@ -298,6 +304,10 @@ function load_from_request()\n \t\t\t$this->set_from_Request( 'parent_ID' );\n \t\t}\n \n+\t\t// Check image file\n+\t\tparam( 'cat_image_file_ID', 'integer' );\n+\t\t$this->set_from_Request( 'image_file_ID' );\n+\n \t\t// Check url name\n \t\tparam( 'cat_urlname', 'string' );\n \t\t$this->set_from_Request( 'urlname' );\n@@ -609,6 +619,9 @@ function get( $parname )\n \t\t{\n \t\t\tcase 'subcat_ordering':\n \t\t\t\treturn $this->get_subcat_ordering( false );\n+\n+\t\t\tcase 'image_file_ID':\n+\t\t\t\treturn $this->image_file_ID;\n \t\t}\n \n \t\treturn parent::get( $parname );\n@@ -823,6 +836,9 @@ function set( $parname, $parvalue, $make_null = false )\n  \t\t\tcase 'parent_ID':\n \t\t\t\treturn $this->set_param( $parname, 'string', $parvalue, true );\n \n+\t\t\tcase 'image_file_ID':\n+\t\t\t\treturn $this->set_param( $parname, 'integer', $parvalue, true );\n+\n \t\t\tcase 'name':\n \t\t\tcase 'urlname':\n \t\t\tcase 'description':"
        },
        {
          "filename": "inc/chapters/model/_chaptercache.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -722,7 +722,7 @@ function sort_root_cats( $subset_ID = NULL )\n \t/**\n \t * Return recursive display of loaded categories\n \t *\n-\t * @param array callback funtions (to format the display)\n+\t * @param array callback functions (to format the display)\n \t * @param integer|NULL NULL for all subsets\n \t * @param array categories list to display\n \t * @param integer depth of categories list"
        },
        {
          "filename": "inc/chapters/views/_chapter.form.php",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -28,7 +28,7 @@\n // Determine if we are creating or updating...\n $creating = is_create_action( $action );\n \n-$Form = new Form( NULL, 'form' );\n+$Form = new Form( NULL, 'form_checkchanges' );\n \n $close_url = get_chapter_redirect_url( get_param( 'redirect_page' ), $edited_Chapter->parent_ID, $edited_Chapter->ID );\n $Form->global_icon( T_('Cancel editing!'), 'close', $close_url );\n@@ -57,6 +57,9 @@\n \n \t$Form->text_input( 'cat_urlname', $edited_Chapter->urlname, 40, T_('URL \"slug\"'), T_('Used for clean URLs. Must be unique.'), array( 'maxlength' => 255 ) );\n \n+\t$field_params = array( 'file_type' => 'image', 'max_file_num' => 1, 'window_title' => T_('Select category image'), 'size_name' => 'fit-320x320' );\n+\t$Form->fileselect( 'cat_image_file_ID', $edited_Chapter->get( 'image_file_ID' ), T_('Category image'), NULL, $field_params );\n+\n \t$Form->text_input( 'cat_description', $edited_Chapter->description, 40, T_('Description'), T_('May be used as a title tag and/or meta description.'), array( 'maxlength' => 255 ) );\n \n \t$parent_cat_order = $edited_Chapter->get_parent_subcat_ordering();\n@@ -75,6 +78,7 @@\n \n \t$Form->checkbox_input( 'cat_lock', $edited_Chapter->lock, T_('Locked category'), array( 'note' => T_('Check this to lock all posts under this category. (Note: for posts with multiple categories, the post is only locked if *all* its categories are locked.)') ) );\n \n+\n $Form->end_fieldset();\n \n $Form->end_form( array( array( 'submit', 'submit', ( $creating ? T_('Record') : T_('Save Changes!') ), 'SaveButton' ) ) );"
        },
        {
          "filename": "inc/chapters/views/_chapter_list.view.php",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -80,6 +80,20 @@ function cat_line( $Chapter, $level )\n \t}\n \t$r .= '<td class=\"center\">'.$makedef_icon.'</td>';\n \n+\t// Image\n+\t$file_ID = $Chapter->get( 'image_file_ID' );\n+\t$cat_thumb = '';\n+\tif( $file_ID )\n+\t{\n+\t\t$FileCache = & get_FileCache();\n+\t\t$cat_image_File = & $FileCache->get_by_ID( $file_ID, false, false );\n+\t\tif( $cat_image_File )\n+\t\t{\n+\t\t\t$cat_thumb = $cat_image_File->get_thumb_imgtag( 'crop-48x48' );\n+\t\t}\n+\t}\n+\t$r .= '<td>'.$cat_thumb.'</td>';\n+\n \t// Name\n \tif( $permission_to_edit )\n \t{\t// We have permission permission to edit:\n@@ -235,6 +249,10 @@ function cat_after_level( $level )\n \t\t\t\t\t\t'th' => T_('Default'),\n \t\t\t\t\t\t'th_class' => 'shrinkwrap',\n \t\t\t\t\t);\n+$Table->cols[] = array(\n+\t\t\t\t\t\t'th' => T_('Image'),\n+\t\t\t\t\t\t'th_class' => 'shrinkwrap',\n+\t\t\t\t\t);\n $Table->cols[] = array(\n \t\t\t\t\t\t'th' => T_('Name'),\n \t\t\t\t\t);"
        },
        {
          "filename": "inc/collections/_collections.init.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -1020,6 +1020,12 @@ function get_cron_jobs()\n \t\t\t\t'ctrl'   => 'cron/jobs/_post_moderation_reminder.job.php',\n \t\t\t\t'params' => NULL,\n \t\t\t),\n+\t\t\t'monthly-alert-old-contents' => array(\n+\t\t\t\t'name'   => T_('Monthly alert on old contents'),\n+\t\t\t\t'help'   => '#',\n+\t\t\t\t'ctrl'   => 'cron/jobs/_monthly_alert_old_contents.job.php',\n+\t\t\t\t'params' => NULL,\n+\t\t\t),\n \t\t);\n \t}\n "
        },
        {
          "filename": "inc/collections/collections.ctrl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -346,9 +346,8 @@\n \t\t// Site long name\n \t\t$Settings->set( 'notification_long_name', param( 'notification_long_name', 'string', '' ) );\n \n-\t\t// Small site logo url\n-\t\tparam( 'notification_logo', 'url', '' );\n-\t\tparam_check_url( 'notification_logo', 'http-https' );\n+\t\t// Small site logo\n+\t\tparam( 'notification_logo', 'integer', NULL );\n \t\t$Settings->set( 'notification_logo', get_param( 'notification_logo' ) );\n \n \t\t// Site footer text"
        },
        {
          "filename": "inc/collections/model/_blog.class.php",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -818,6 +818,10 @@ function load_from_Request( $groups = array() )\n \n \t\t\t$this->set_setting( 'default_post_status', param( 'default_post_status', 'string', NULL ) );\n \n+\t\t\tparam( 'old_content_alert', 'integer', NULL );\n+\t\t\tparam_check_range( 'old_content_alert', 1, 12, T_('Old content alert must be numeric (1-12).'), false );\n+\t\t\t$this->set_setting( 'old_content_alert', get_param( 'old_content_alert' ), true );\n+\n \t\t\t$this->set_setting( 'post_categories', param( 'post_categories', 'string', NULL ) );\n \n \t\t\tif( $current_User->check_perm( 'blog_admin', 'edit', false, $this->ID ) )"
        },
        {
          "filename": "inc/collections/model/_collections.install.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -108,6 +108,7 @@\n \t\t\tcat_name            varchar(255) NOT NULL,\n \t\t\tcat_urlname         varchar(255) COLLATE ascii_general_ci NOT NULL,\n \t\t\tcat_blog_ID         int(10) unsigned NOT NULL default 2,\n+\t\t\tcat_image_file_ID   int(10) unsigned NULL,\n \t\t\tcat_description     varchar(255) NULL DEFAULT NULL,\n \t\t\tcat_order           int(11) NULL DEFAULT NULL,\n \t\t\tcat_subcat_ordering enum('parent', 'alpha', 'manual') COLLATE ascii_general_ci NULL DEFAULT NULL,\n@@ -514,10 +515,11 @@\n \t\t) ENGINE = innodb DEFAULT CHARSET = $db_storage_charset\" ),\n \n \t'T_temporary_ID' => array(\n-\t\t'Creating table for temporary ID',\n+\t\t'Creating table for temporary IDs (used for uploads on new posts or messages)',\n \t\t\"CREATE TABLE T_temporary_ID (\n-\t\t\ttmp_ID   INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,\n-\t\t\ttmp_type VARCHAR(32) COLLATE ascii_general_ci NOT NULL,\n+\t\t\ttmp_ID      INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,\n+\t\t\ttmp_type    VARCHAR(32) COLLATE ascii_general_ci NOT NULL,\n+\t\t\ttmp_coll_ID INT(11) UNSIGNED NULL,\n \t\t\tPRIMARY KEY (tmp_ID)\n \t\t) ENGINE = innodb DEFAULT CHARSET = $db_storage_charset\" ),\n "
        },
        {
          "filename": "inc/collections/views/_coll_features.form.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -218,6 +218,8 @@\n \t}\n \t$Form->checklist( $checklist_options, 'post_moderation_statuses', T_('\"Require moderation\" statuses'), false, false, array( 'note' => T_('Posts with the selected statuses will be considered to require moderation. They will trigger \"moderation required\" notifications and will appear as such on the collection dashboard.') ) );\n \n+\t$Form->text_input( 'old_content_alert', $edited_Blog->get_setting( 'old_content_alert' ), 2, T_('Old content alert'), T_('Posts that have not been updated within the set delay will be reported to content moderators. Leave empty if you don\\'t want such alerts.'), array( 'input_suffix' => ' '.T_('months').'.' ) );\n+\n $Form->end_fieldset();\n \n // display features settings provided by optional modules:"
        },
        {
          "filename": "inc/collections/views/_coll_settings_site.form.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -57,7 +57,8 @@\n \t$Form->color_input( 'site_color', $Settings->get( 'site_color' ), T_('Site color'), T_('E-g: #ff0000 for red') );\n \t$Form->text_input( 'notification_short_name', $Settings->get( 'notification_short_name' ), 50, T_( 'Short site name' ), T_('Shared with email settings'), array( 'maxlength' => 127, 'required' => true ) );\n \t$Form->text_input( 'notification_long_name', $Settings->get( 'notification_long_name' ), 50, T_( 'Long site name' ), T_('Shared with email settings'), array( 'maxlength' => 255 ) );\n-\t$Form->text_input( 'notification_logo', $Settings->get( 'notification_logo' ), 50, T_( 'Small site logo (URL)' ), T_('Shared with email settings'), array( 'maxlength' => 5000 ) );\n+\t$fileselect_params = array( 'file_type' => 'image', 'max_file_num' => 1, 'window_title' => T_('Select site logo'), 'root' => 'shared_0', 'size_name' => 'fit-320x320' );\n+\t$Form->fileselect( 'notification_logo', $Settings->get( 'notification_logo' ), T_('Site logo'), NULL, $fileselect_params );\n \t$Form->text_input( 'site_footer_text', $Settings->get( 'site_footer_text' ), 50, T_('Site footer text'), '', array( 'maxlength' => 5000 ) );\n \t$Form->checkbox_input( 'site_skins_enabled', $Settings->get( 'site_skins_enabled' ), T_('Enable site skins'), array( 'note' => T_('Enables a sitewide header and footer') ) );\n \t$Form->begin_line( T_('Terms & Conditions'), 'site_terms_enabled' );"
        },
        {
          "filename": "inc/comments/views/_comment.form.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -180,11 +180,13 @@\n \t$Form->end_fieldset();\n \n \t// -------------------------- ATTACHMENTS/LINKS --------------------------\n-\tif( isset($GLOBALS['files_Module']) )\n-\t{\n+\tif( $current_User->check_perm( 'files', 'view' ) )\n+\t{\t// If current user has a permission to view the files:\n \t\tload_class( 'links/model/_linkcomment.class.php', 'LinkComment' );\n-\t\tglobal $LinkOwner; // Initialize this object as global because this is used in many link functions\n+\t\t// Initialize this object as global because this is used in many link functions:\n+\t\tglobal $LinkOwner;\n \t\t$LinkOwner = new LinkComment( $edited_Comment );\n+\t\t// Display attachments fieldset:\n \t\tdisplay_attachments_fieldset( $Form, $LinkOwner, false, true );\n \t}\n "
        },
        {
          "filename": "inc/cron/jobs/_monthly_alert_old_contents.job.php",
          "status": "added",
          "additions": 279,
          "deletions": 0,
          "patch": "@@ -0,0 +1,279 @@\n+<?php\n+/**\n+ * This file implements the monthly alert on old contents\n+ *\n+ * @author fplanque: Fran\u00e7ois PLANQUE\n+ */\n+if( !defined('EVO_MAIN_INIT') ) die( 'Please, do not access this page directly.' );\n+\n+\n+global $UserSettings;\n+\n+// Check if UserSettings exists because it must be initialized before email sending:\n+if( empty( $UserSettings ) )\n+{\t// initialize UserSettings, because in CLI mode is not initialized yet:\n+\tload_class( 'users/model/_usersettings.class.php', 'UserSettings' );\n+\t$UserSettings = new UserSettings();\n+}\n+\n+// Select collections where we should find old posts to alert for moderators:\n+$SQL = new SQL( 'Select collections which alert on old contents' );\n+$SQL->SELECT( 'T_blogs.*' );\n+$SQL->FROM( 'T_blogs' );\n+$SQL->FROM_add( 'INNER JOIN T_coll_settings ON blog_ID = cset_coll_ID' );\n+$SQL->WHERE( 'cset_name = \"old_content_alert\"' );\n+$SQL->WHERE_and( 'cset_value >= 1' );\n+$SQL->WHERE_and( 'cset_value <= 12' );\n+\n+// Load collections by above SQL:\n+$BlogCache = & get_BlogCache();\n+$BlogCache->clear( true );\n+$BlogCache->load_by_sql( $SQL );\n+\n+if( empty( $BlogCache->cache ) )\n+{\t// There are no collections where we should find old posts to alert for moderators\n+\t$result_message = 'No collection with alert on old contents.';\n+\treturn 1;\n+}\n+\n+$alert_coll_IDs = array();\n+foreach( $BlogCache->cache as $alert_Blog )\n+{\n+\t$alert_coll_IDs[] = $alert_Blog->ID;\n+}\n+$alert_colls_cond = '%s IN ( '.implode( ',', $alert_coll_IDs ).' )';\n+\n+// Select global moderators:\n+$SQL = new SQL( 'Get global moderators of all collections' );\n+$SQL->SELECT( 'user_ID' );\n+$SQL->FROM( 'T_users' );\n+$SQL->FROM_add( 'LEFT JOIN T_groups ON grp_ID = user_grp_ID' );\n+$SQL->WHERE( 'grp_perm_blogs = \"editall\"' );\n+$global_moderator_IDs = $DB->get_col( $SQL->get(), 0, $SQL->title );\n+\n+$not_global_moderators_cond = ( count( $global_moderator_IDs ) ) ? '%s NOT IN ( '.implode( ',', $global_moderator_IDs ).' )' : NULL;\n+\n+// Select collection owners, because they are moderators in their own collections:\n+$SQL = new SQL( 'Get collection owners with their collection IDs' );\n+$SQL->SELECT( 'blog_owner_user_ID, GROUP_CONCAT( DISTINCT cast(blog_ID as CHAR) ORDER BY blog_ID SEPARATOR \\',\\') as blogs' );\n+$SQL->FROM( 'T_blogs' );\n+$SQL->WHERE( sprintf( $not_global_moderators_cond, 'blog_owner_user_ID' ) );\n+$SQL->WHERE_and( sprintf( $alert_colls_cond, 'blog_ID' ) );\n+$SQL->GROUP_BY( 'blog_owner_user_ID' );\n+$coll_owners = $DB->get_assoc( $SQL->get(), $SQL->title );\n+foreach( $coll_owners as $coll_owner_ID => $coll_IDs )\n+{\n+\t$coll_owners[ $coll_owner_ID ] = explode( ',', $coll_IDs );\n+}\n+\n+// Alert only on posts with the following statuses:\n+$alert_post_statuses = array( 'published', 'community', 'protected' );\n+$alert_post_statuses_cond = '';\n+foreach( $alert_post_statuses as $i => $alert_post_status )\n+{\n+\t$alert_post_statuses_cond .= 'FIND_IN_SET( \"'.$alert_post_status.'\", $field_name$ ) > 0';\n+\tif( $i < count( $alert_post_statuses ) - 1 )\n+\t{\n+\t\t$alert_post_statuses_cond .= ' OR ';\n+\t}\n+}\n+\n+// Select post moderators based on the collection advanced user permissions:\n+$bloguser_SQL = new SQL();\n+$bloguser_SQL->SELECT( 'bloguser_user_ID AS user_ID, bloguser_blog_ID AS blog_ID, bloguser_perm_poststatuses + 0 AS perm_poststatuses, bloguser_perm_edit AS perm_edit, bloguser_perm_edit + 0 AS perm_edit_num' );\n+$bloguser_SQL->FROM( 'T_coll_user_perms' );\n+$bloguser_SQL->FROM_add( 'LEFT JOIN T_blogs ON blog_ID = bloguser_blog_ID' );\n+$bloguser_SQL->WHERE( 'blog_advanced_perms <> 0' );\n+$bloguser_SQL->WHERE_and( sprintf( $not_global_moderators_cond, 'bloguser_user_ID' ) );\n+$bloguser_SQL->WHERE_and( sprintf( $alert_colls_cond, 'bloguser_blog_ID' ) );\n+$bloguser_SQL->WHERE_and( 'bloguser_perm_edit <> \"no\"' );\n+$bloguser_SQL->WHERE_and( str_replace( '$field_name$', 'bloguser_perm_poststatuses', $alert_post_statuses_cond ) );\n+// Select post moderators based on the collection advanced group permissions:\n+$bloggroup_SQL = new  SQL();\n+$bloggroup_SQL->SELECT( 'user_ID, bloggroup_blog_ID AS blog_ID, bloggroup_perm_poststatuses + 0 AS perm_poststatuses, bloggroup_perm_edit AS perm_edit, bloggroup_perm_edit + 0 AS perm_edit_num' );\n+$bloggroup_SQL->FROM( 'T_users' );\n+$bloggroup_SQL->FROM_add( 'LEFT JOIN T_coll_group_perms ON ( bloggroup_group_ID = user_grp_ID\n+\tOR bloggroup_group_ID IN ( SELECT sug_grp_ID FROM T_users__secondary_user_groups WHERE sug_user_ID = user_ID ) )' );\n+$bloggroup_SQL->FROM_add( 'LEFT JOIN T_blogs ON blog_ID = bloggroup_blog_ID' );\n+$bloggroup_SQL->WHERE( 'blog_advanced_perms <> 0' );\n+$bloggroup_SQL->WHERE_and( sprintf( $not_global_moderators_cond, 'user_ID' ) );\n+$bloggroup_SQL->WHERE_and( sprintf( $alert_colls_cond, 'bloggroup_blog_ID' ) );\n+$bloggroup_SQL->WHERE_and( 'bloggroup_perm_edit <> \"no\"' );\n+$bloggroup_SQL->WHERE_and( str_replace( '$field_name$', 'bloggroup_perm_poststatuses', $alert_post_statuses_cond ) );\n+// Get specific moderators with their permissions in each different collection:\n+$specific_coll_moderators = $DB->get_results( '( '.$bloguser_SQL->get().' ) UNION ( '.$bloggroup_SQL->get().' ) ORDER BY user_ID, blog_ID', OBJECT,\n+\t'Select post moderators based on the collection advanced user and group permissions' );\n+\n+// Create a general moderators array:\n+$moderators = array();\n+foreach( $specific_coll_moderators as $row )\n+{\t// Loop through each different collection's moderator users and their permissions:\n+\tif( ! isset( $moderators[$row->user_ID] ) )\n+\t{\t// Initialize user perm array:\n+\t\t$moderators[$row->user_ID] = array();\n+\t}\n+\tif( isset( $moderators[$row->user_ID][$row->blog_ID] ) )\n+\t{\t// Update user permissions on this collection:\n+\t\t// perm_edit    : 'no', 'own', 'lt', 'le', 'all' (real value from DB)\n+\t\t// perm_edit_num:  1,    2,     3,    4,    5    (index of the value from DB)\n+\t\tif( $moderators[$row->user_ID][$row->blog_ID]['perm_edit_num'] < $row->perm_edit_num )\n+\t\t{\t// The user and the group advanced post edit perm for this user are not the same, keep the higher perm value:\n+\t\t\t$moderators[$row->user_ID][$row->blog_ID]['perm_edit_num'] = intval( $row->perm_edit_num );\n+\t\t\t$moderators[$row->user_ID][$row->blog_ID]['perm_edit'] = $row->perm_edit;\n+\t\t}\n+\t\t$current_perm_statuses = $moderators[$row->user_ID][$row->blog_ID]['perm_statuses'];\n+\t\t$row_perm_status = intval( $row->perm_poststatuses );\n+\t\tif( $current_perm_statuses != $row_perm_status )\n+\t\t{\t// The advanced user and the group post statuses perm for this user are not the same, the union of this perms must be accepted:\n+\t\t\t$moderators[$row->user_ID][$row->blog_ID]['perm_statuses'] = ( $current_perm_statuses | $row_perm_status );\n+\t\t}\n+\t}\n+\telse\n+\t{\t// Initialize a new setting for the moderator per collection:\n+\t\t$moderators[$row->user_ID][$row->blog_ID] = array(\n+\t\t\t\t'perm_edit'     => $row->perm_edit,\n+\t\t\t\t'perm_edit_num' => intval( $row->perm_edit_num ),\n+\t\t\t\t'perm_statuses' => intval( $row->perm_poststatuses ),\n+\t\t\t);\n+\t}\n+}\n+\n+// Select blocked and spam email addresses to prevent sending emails to them:\n+$blocked_emails = $DB->get_col( 'SELECT emadr_address FROM T_email__address WHERE '.get_mail_blocked_condition() );\n+\n+// load all required Users ( global moderators, blog owners and users with advanced blog perms )\n+$all_required_user_IDs = array_unique( array_merge( $global_moderator_IDs, array_keys( $coll_owners ), array_keys( $moderators ) ) );\n+$SQL = new SQL( 'Get all users for alert on old contents' );\n+$SQL->SELECT( '*' );\n+$SQL->FROM( 'T_users' );\n+$SQL->FROM_add( 'LEFT JOIN T_users__usersettings ON uset_user_ID = user_ID AND uset_name = \"send_pst_stale_alert\"' );\n+$SQL->WHERE( 'user_ID IN ('.implode( ',', $all_required_user_IDs ).')' );\n+$SQL->WHERE_and( 'LENGTH( TRIM( user_email ) ) > 0' );\n+// Set notify moderation condition:\n+if( $UserSettings->get( 'send_pst_stale_alert' ) )\n+{\t// A send stale posts alerter is set by default\n+\t$SQL->WHERE_and( '( ( uset_value IS NOT NULL AND uset_value <> \\'0\\' ) OR ( uset_value IS NULL ) )' );\n+}\n+else\n+{\t// A send stale posts alerter is NOT set by default\n+\t$SQL->WHERE_and( '( uset_value IS NOT NULL AND uset_value <> \\'0\\' )' );\n+}\n+if( count( $blocked_emails ) )\n+{\t// Restrict users by blocked email addresses:\n+\t$SQL->WHERE_and( 'user_email NOT IN ( \"'.implode( '\",\"', $blocked_emails ).'\" )' );\n+}\n+\n+// Load moderator users who would like to get notificaions\n+$UserCache = & get_UserCache();\n+$UserCache->clear( true );\n+$UserCache->load_by_sql( $SQL );\n+\n+if( empty( $UserCache->cache ) )\n+{\t// UserCache result is empty which means nobody wants to receive alert on old contents:\n+\t$result_message = 'Could not find any moderators wanting to receive post moderation notifications for the blogs that have stale posts!';\n+\treturn 1;\n+}\n+\n+$mail_moderator_sent = array();\n+$mail_coll_sent = 0;\n+foreach( $BlogCache->cache as $alert_Blog )\n+{\n+\t// Get all old posts of the collection to alert for moderators:\n+\t$SQL = new SQL( 'Get all old posts of the collection '.$alert_Blog->ID.' to alert for moderators' );\n+\t$SQL->SELECT( 'post_ID, post_status, user_level as author_level, post_creator_user_ID' );\n+\t$SQL->FROM( 'T_items__item' );\n+\t$SQL->FROM_add( 'INNER JOIN T_users ON user_ID = post_creator_user_ID' );\n+\t$SQL->FROM_add( 'INNER JOIN T_categories ON cat_ID = post_main_cat_ID' );\n+\t$SQL->WHERE( 'cat_blog_ID = '.$alert_Blog->ID );\n+\t$SQL->WHERE_and( 'post_status IN ( '.$DB->quote( $alert_post_statuses ).' )' );\n+\t$x_months_ago = date( 'Y-m-d H:i:s', mktime( 0, 0, 0, date( 'n' ) - $alert_Blog->get_setting( 'old_content_alert' ) ) );\n+\t$SQL->WHERE_and( 'post_datemodified < '.$DB->quote( $x_months_ago ) );\n+\t$old_posts = $DB->get_results( $SQL->get(), OBJECT, $SQL->title );\n+\n+\tif( empty( $old_posts ) )\n+\t{\t// No old posts on the collection:\n+\t\tcontinue;\n+\t}\n+\n+\tforeach( $UserCache->cache as $alert_User )\n+\t{\n+\t\t$moderator_old_posts = array();\n+\t\tif( in_array( $alert_User->ID, $global_moderator_IDs ) ||\n+\t\t    ( isset( $coll_owners[ $alert_User->ID ] ) && in_array( $alert_Blog->ID, $coll_owners[ $alert_User->ID ] ) ) )\n+\t\t{\t// Allow to send alert on all old post if the user is a global moderator or he is an owner of the collection:\n+\t\t\tforeach( $old_posts as $old_post )\n+\t\t\t{\n+\t\t\t\t$moderator_old_posts[] = $old_post->post_ID;\n+\t\t\t}\n+\t\t}\n+\t\telseif( isset( $moderators[ $alert_User->ID ][ $alert_Blog->ID ] ) )\n+\t\t{\t// Check what post the moderator can edit:\n+\t\t\t$perms = $moderators[ $alert_User->ID ][ $alert_Blog->ID ];\n+\t\t\tforeach( $old_posts as $old_post )\n+\t\t\t{\n+\t\t\t\t$status_perm_value = get_status_permvalue( $old_post->post_status );\n+\t\t\t\tif( $perms['perm_statuses'] & $status_perm_value )\n+\t\t\t\t{\t// If user has permission to edit posts with this status\n+\t\t\t\t\t// Check if the post author level allows the edit permission:\n+\t\t\t\t\tswitch( $perms['perm_edit'] )\n+\t\t\t\t\t{\n+\t\t\t\t\t\tcase 'all':\n+\t\t\t\t\t\t\t$allowed = true;\n+\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\tcase 'le':\n+\t\t\t\t\t\t\t$allowed = ( $old_post->author_level <= $alert_User->level );\n+\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\tcase 'lt':\n+\t\t\t\t\t\t\t$allowed = ( $old_post->author_level < $alert_User->level );\n+\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\tcase 'own':\n+\t\t\t\t\t\t\t$allowed = ( $old_post->post_creator_user_ID == $alert_User->ID );\n+\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\tdefault:\n+\t\t\t\t\t\t\t$allowed = false;\n+\t\t\t\t\t}\n+\t\t\t\t\tif( $allowed )\n+\t\t\t\t\t{\t// User has permission to edit the post with this author level:\n+\t\t\t\t\t\t$moderator_old_posts[] = $old_post->post_ID;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\n+\t\tif( empty( $moderator_old_posts ) )\n+\t\t{\t// The user has no old posts to be alerted:\n+\t\t\tcontinue;\n+\t\t}\n+\n+\t\t$email_params = array(\n+\t\t\t\t'months' => intval( $alert_Blog->get_setting( 'old_content_alert' ) ),\n+\t\t\t\t'posts'  => $moderator_old_posts,\n+\t\t\t);\n+\n+\t\t// Change locale here to localize the email subject and content:\n+\t\tlocale_temp_switch( $alert_User->get( 'locale' ) );\n+\n+\t\t// Send one email message for each moderator per collection:\n+\t\tif( send_mail_to_User( $alert_User->ID, sprintf( T_('Stale contents found in %s'), $alert_Blog->get( 'shortname' ) ), 'posts_stale_alert', $email_params, false ) )\n+\t\t{\n+\t\t\t$mail_moderator_sent[ $alert_User->ID ] = 0;\n+\t\t}\n+\n+\t\t// Restore locale:\n+\t\tlocale_restore_previous();\n+\t}\n+\n+\t$mail_coll_sent++;\n+}\n+\n+if( count( $mail_moderator_sent ) )\n+{\n+\t$result_message = sprintf( '%s moderators have been alerted on old contents of %s collections!', count( $mail_moderator_sent ), $mail_coll_sent );\n+}\n+else\n+{\n+\t$result_message = 'No moderators have been alerted on old contents!';\n+}\n+\n+return 1; /*OK*/\n+?>\n\\ No newline at end of file"
        },
        {
          "filename": "inc/cron/jobs/_post_moderation_reminder.job.php",
          "status": "modified",
          "additions": 15,
          "deletions": 8,
          "patch": "@@ -63,7 +63,7 @@\n \n // Select post moderators based on the blogs advanced user permissions\n $bloguser_SQL = new SQL();\n-$bloguser_SQL->SELECT( 'bloguser_user_ID as user_ID, bloguser_blog_ID as blog_ID, bloguser_perm_poststatuses + 0 as perm_poststatuses, bloguser_perm_edit as perm_edit' );\n+$bloguser_SQL->SELECT( 'bloguser_user_ID as user_ID, bloguser_blog_ID as blog_ID, bloguser_perm_poststatuses + 0 as perm_poststatuses, bloguser_perm_edit as perm_edit, bloguser_perm_edit + 0 AS perm_edit_num' );\n $bloguser_SQL->FROM( 'T_coll_user_perms' );\n $bloguser_SQL->FROM_add( 'LEFT JOIN T_blogs ON blog_ID = bloguser_blog_ID' );\n $bloguser_SQL->WHERE( sprintf( $not_global_moderator, 'bloguser_user_ID' ) );\n@@ -72,7 +72,7 @@\n $bloguser_SQL->WHERE_and( 'bloguser_perm_poststatuses <> \"\" AND bloguser_perm_edit <> \"no\" AND bloguser_perm_edit <> \"own\"' );\n // Select post moderators based on the blogs advanced group permissions\n $bloggroup_SQL = new  SQL();\n-$bloggroup_SQL->SELECT( 'user_ID, bloggroup_blog_ID as blog_ID, bloggroup_perm_poststatuses + 0 as perm_poststatuses, bloggroup_perm_edit as perm_edit' );\n+$bloggroup_SQL->SELECT( 'user_ID, bloggroup_blog_ID as blog_ID, bloggroup_perm_poststatuses + 0 as perm_poststatuses, bloggroup_perm_edit as perm_edit, bloggroup_perm_edit + 0 AS perm_edit_num' );\n $bloggroup_SQL->FROM( 'T_users' );\n $bloggroup_SQL->FROM_add( 'LEFT JOIN T_coll_group_perms ON ( bloggroup_group_ID = user_grp_ID\n \tOR bloggroup_group_ID IN ( SELECT sug_grp_ID FROM T_users__secondary_user_groups WHERE sug_user_ID = user_ID ) )' );\n@@ -97,21 +97,28 @@\n \t\t$moderators[$row->user_ID] = array();\n \t}\n \tif( isset( $moderators[$row->user_ID][$row->blog_ID] ) )\n-\t{ // Update user permissions on this blog\n-\t\tif( $moderators[$row->user_ID][$row->blog_ID]['perm_edit'] < $row->perm_edit )\n-\t\t{ // The user and the group advanced post edit perm for this user are not the same, keep the higher perm value\n+\t{\t// Update user permissions on this collection:\n+\t\t// perm_edit    : 'no', 'own', 'lt', 'le', 'all' (real value from DB)\n+\t\t// perm_edit_num:  1,    2,     3,    4,    5    (index of the value from DB)\n+\t\tif( $moderators[$row->user_ID][$row->blog_ID]['perm_edit_num'] < $row->perm_edit_num )\n+\t\t{\t// The user and the group advanced post edit perm for this user are not the same, keep the higher perm value:\n+\t\t\t$moderators[$row->user_ID][$row->blog_ID]['perm_edit_num'] = intval( $row->perm_edit_num );\n \t\t\t$moderators[$row->user_ID][$row->blog_ID]['perm_edit'] = $row->perm_edit;\n \t\t}\n \t\t$current_perm_statuses = $moderators[$row->user_ID][$row->blog_ID]['perm_statuses'];\n-\t\t$row_perm_status = (int) $row->perm_poststatuses;\n+\t\t$row_perm_status = intval( $row->perm_poststatuses );\n \t\tif( $current_perm_statuses != $row_perm_status )\n \t\t{ // The advanced user and the group post statuses perm for this user are not the same, the union of this perms must be accepted\n \t\t\t$moderators[$row->user_ID][$row->blog_ID]['perm_statuses'] = ( $current_perm_statuses | $row_perm_status );\n \t\t}\n \t}\n \telse\n-\t{ // Initialize a new setting for this user / blog\n-\t\t$moderators[$row->user_ID][$row->blog_ID] = array( 'perm_edit' => $row->perm_edit, 'perm_statuses' => (int) $row->perm_poststatuses );\n+\t{\t// Initialize a new setting for the moderator per collection:\n+\t\t$moderators[$row->user_ID][$row->blog_ID] = array(\n+\t\t\t\t'perm_edit'     => $row->perm_edit,\n+\t\t\t\t'perm_edit_num' => intval( $row->perm_edit_num ),\n+\t\t\t\t'perm_statuses' => intval( $row->perm_poststatuses ),\n+\t\t\t);\n \t}\n }\n foreach( $blog_owners as $moderator_ID => $moderator_blogs )"
        },
        {
          "filename": "inc/dashboard/model/_dashboard.funcs.php",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -38,6 +38,11 @@ function b2evonet_get_updates( $force_short_delay = false )\n \t\treturn NULL;\n \t}\n \n+\tif( $Settings->get( 'evonet_last_error' ) > $servertimenow - 5400 )\n+\t{\t// The previous error was less than 90 minutes ago, skip this:\n+\t\treturn false;\n+\t}\n+\n \tif( $debug == 2 )\n \t{\n \t\t$update_every = 8;\n@@ -193,6 +198,11 @@ function b2evonet_get_updates( $force_short_delay = false )\n \t\t}\n \t}\n \n+\t// Response is an error,\n+\t// Save current server time of this error to don't repeat it during 90 minutes:\n+\t$Settings->set( 'evonet_last_error', $servertimenow );\n+\t$Settings->dbupdate();\n+\n \t$Timer->pause('evonet: check for updates');\n \treturn false;\n }"
        },
        {
          "filename": "inc/email_campaigns/views/_campaigns_compose.form.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -87,13 +87,13 @@\n \n \n // ####################### ATTACHMENTS/LINKS #########################\n-if( isset( $GLOBALS['files_Module'] )\n-\t&& $current_User->check_perm( 'emails', 'edit' )\n-\t&& $current_User->check_perm( 'files', 'view' ) )\n-{\t// Files module is enabled, but in case of creating new posts we should show file attachments block only if user has all required permissions to attach files:\n+if( $current_User->check_perm( 'files', 'view' ) )\n+{\t// If current user has a permission to view the files:\n \tload_class( 'links/model/_linkemailcampaign.class.php', 'LinkEmailCampaign' );\n-\tglobal $LinkOwner; // Initialize this object as global because this is used in many link functions\n+\t// Initialize this object as global because this is used in many link functions:\n+\tglobal $LinkOwner;\n \t$LinkOwner = new LinkEmailCampaign( $edited_EmailCampaign );\n+\t// Display attachments fieldset:\n \tdisplay_attachments_fieldset( $Form, $LinkOwner );\n }\n "
        },
        {
          "filename": "inc/files/files.ctrl.php",
          "status": "modified",
          "additions": 15,
          "deletions": 16,
          "patch": "@@ -49,7 +49,7 @@\n param( 'ajax_request', 'integer', 0, true );\n \n // INIT params:\n-if( param( 'root_and_path', 'string', '', false ) /* not memorized (default) */ && strpos( $root_and_path, '::' ) )\n+if( param( 'root_and_path', 'filepath', '', false ) /* not memorized (default) */ && strpos( $root_and_path, '::' ) )\n { // root and path together: decode and override (used by \"radio-click-dirtree\")\n \tlist( $root, $path ) = explode( '::', $root_and_path, 2 );\n \t// Memorize new root:\n@@ -59,7 +59,7 @@\n else\n {\n \tparam( 'root', 'string', NULL, true ); // the root directory from the dropdown box (user_X or blog_X; X is ID - 'user' for current user (default))\n-\tparam( 'path', 'string', '/', true );  // the path relative to the root dir\n+\tparam( 'path', 'filepath', '/', true );  // the path relative to the root dir\n \tif( param( 'new_root', 'string', '' )\n \t\t&& $new_root != $root )\n \t{ // We have changed root in the select list\n@@ -157,6 +157,7 @@\n \n // Name of the iframe we want some actions to come back to:\n param( 'iframe_name', 'string', '', true );\n+param( 'field_name', 'string', '', true );\n \n // Get root:\n $ads_list_path = false; // false by default, gets set if we have a valid root\n@@ -335,7 +336,7 @@\n  *\n  * @global array\n  */\n-$fm_selected = param( 'fm_selected', 'array:string', array(), true );\n+$fm_selected = param( 'fm_selected', 'array:filepath', array(), true );\n $Debuglog->add( count($fm_selected).' selected files/directories', 'files' );\n /**\n  * The selected files (must be within current fileroot)\n@@ -344,14 +345,8 @@\n  */\n $selected_Filelist = new Filelist( $fm_FileRoot, $ads_list_path );\n \n-// Prevent directory traversal using '..'\n-$re = '/\\/?\\.\\.\\/+/';\n foreach( $fm_selected as $l_source_path )\n {\n-\tif( preg_match( $re, $l_source_path ) )\n-\t{\n-\t\tdebug_die( 'Invalid fm_selected parameter value' );\n-\t}\n \t$selected_Filelist->add_by_subpath( urldecode($l_source_path), true );\n }\n \n@@ -802,7 +797,7 @@\n \t\t}\n \n \t\tparam( 'confirmed', 'integer', 0 );\n-\t\tparam( 'new_names', 'array:string', array() );\n+\t\tparam( 'new_names', 'array:filepath', array() );\n \n \t\t// Check params for each file to rename:\n \t\twhile( $loop_src_File = & $source_Filelist->get_next() )\n@@ -843,14 +838,14 @@\n \t\t\t\t\t\tif( $new_name == $old_name )\n \t\t\t\t\t\t{ // Name has not changed...\n \t\t\t\t\t\t\t$Messages->add_to_group( sprintf( T_('&laquo;%s&raquo; has not been renamed'), $old_name ), 'note', T_('Renaming files:') );\n-\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t\tcontinue 2;\n \t\t\t\t\t\t}\n \t\t\t\t\t\t// Perform rename:\n \t\t\t\t\t\tif( ! $loop_src_File->rename_to( $new_name ) )\n \t\t\t\t\t\t{\n \t\t\t\t\t\t\t$Messages->add_to_group( sprintf( T_('&laquo;%s&raquo; could not be renamed to &laquo;%s&raquo;'),\n \t\t\t\t\t\t\t\t$old_name, $new_name ), 'error', T_('Renaming files') );\n-\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t\tcontinue 2;\n \t\t\t\t\t\t}\n \n \t\t\t\t\t\t$success_message = sprintf( T_('&laquo;%s&raquo; has been successfully renamed to &laquo;%s&raquo;'), $old_name, $new_name );\n@@ -865,7 +860,7 @@\n \t\t\t\t\t\tif( $old_path == $new_path && $loop_src_File->_FileRoot->ID == $selected_Filelist->_FileRoot->ID )\n \t\t\t\t\t\t{ // File path has not changed...\n \t\t\t\t\t\t\t$Messages->add_to_group( sprintf( T_('&laquo;%s&raquo; has not been copied'), $old_path ), 'note', T_('Copying files:') );\n-\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t\tcontinue 2;\n \t\t\t\t\t\t}\n \n \t\t\t\t\t\t// Get a pointer on dest file\n@@ -875,9 +870,13 @@\n \t\t\t\t\t\tif( ! $loop_src_File->copy_to( $dest_File ) )\n \t\t\t\t\t\t{ // failed\n \t\t\t\t\t\t\t$Messages->add_to_group( sprintf( T_('&laquo;%s&raquo; could not be copied to &laquo;%s&raquo;'), $old_path, $new_path ), 'error', T_('Copying files:') );\n-\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t\tcontinue 2;\n \t\t\t\t\t\t}\n \n+\t\t\t\t\t\t// Use new file instead of source to update all file properties especially file root:\n+\t\t\t\t\t\t// (to avoid debug die when file is moved to another root, @see Filelist::add())\n+\t\t\t\t\t\t$loop_src_File = $dest_File;\n+\n \t\t\t\t\t\t$success_message = sprintf( T_('&laquo;%s&raquo; has been successfully copied to &laquo;%s&raquo;'), $old_path, $new_path );\n \t\t\t\t\t\t$success_title = T_('Copying files:');\n \t\t\t\t\t\tbreak;\n@@ -890,14 +889,14 @@\n \t\t\t\t\t\tif( $old_path == $new_path && $loop_src_File->_FileRoot->ID == $selected_Filelist->_FileRoot->ID )\n \t\t\t\t\t\t{ // File path has not changed...\n \t\t\t\t\t\t\t$Messages->add_to_group( sprintf( T_('&laquo;%s&raquo; has not been moved'), $old_path ), 'note', T_('Moving files:') );\n-\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t\tcontinue 2;\n \t\t\t\t\t\t}\n \n \t\t\t\t\t\t// Perform move:\n \t\t\t\t\t\tif( ! $loop_src_File->move_to( $selected_Filelist->get_root_type(), $selected_Filelist->get_root_ID(), $new_path ) )\n \t\t\t\t\t\t{ // failed\n \t\t\t\t\t\t\t$Messages->add_to_group( sprintf( T_('&laquo;%s&raquo; could not be moved to &laquo;%s&raquo;'), $old_path, $new_path ), 'error', T_('Moving files:') );\n-\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t\tcontinue 2;\n \t\t\t\t\t\t}\n \n \t\t\t\t\t\t$success_message = sprintf( T_('&laquo;%s&raquo; has been successfully moved to &laquo;%s&raquo;'), $old_path, $new_path );"
        },
        {
          "filename": "inc/files/model/_file.funcs.php",
          "status": "modified",
          "additions": 19,
          "deletions": 6,
          "patch": "@@ -1991,7 +1991,7 @@ function get_available_filetype_icons()\n  */\n function copy_file( $file_path, $root_ID, $path, $check_perms = true )\n {\n-\tglobal $current_User;\n+\tglobal $current_User, $force_upload_forbiddenext;\n \n \t$FileRootCache = & get_FileRootCache();\n \t$fm_FileRoot = & $FileRootCache->get_by_ID($root_ID, true);\n@@ -2249,6 +2249,7 @@ function display_dragdrop_upload_button( $params = array() )\n \t\t\t'conflict_file_format'   => 'simple', // 'simple' - file name text, 'full_path_link' - a link with text as full file path\n \t\t\t'resize_frame'           => false, // Resize frame on upload new image\n \t\t\t'table_headers'          => '', // Use this html text as table headers when first file is loaded\n+\t\t\t'filename_select'        => '', // Append this text before file name on success uploading of new file\n \t\t), $params );\n \n \t$FileRootCache = & get_FileRootCache();\n@@ -2266,7 +2267,7 @@ function display_dragdrop_upload_button( $params = array() )\n \n \techo $params['before'];\n \n-\tif( $params['LinkOwner'] !== NULL && $params['LinkOwner']->is_temp )\n+\tif( $params['LinkOwner'] !== NULL && $params['LinkOwner']->is_temp() )\n \t{\t// Use this field to know a form is submitted with temporary link owner(when object is creating and still doesn't exist in DB):\n \t\techo '<input type=\"hidden\" name=\"temp_link_owner_ID\" value=\"'.$params['LinkOwner']->get_ID().'\" />';\n \t}\n@@ -2303,8 +2304,7 @@ function display_dragdrop_upload_button( $params = array() )\n \t\t<?php\n \t\tif( $params['LinkOwner'] !== NULL )\n \t\t{\t// Add params to link a file right after uploading:\n-\t\t\t$link_owner_type = $params['LinkOwner']->type;\n-\t\t\techo 'url += \"&link_owner='.$link_owner_type.'_'.$params['LinkOwner']->get_ID().'\"';\n+\t\t\techo 'url += \"&link_owner='.$params['LinkOwner']->type.'_'.$params['LinkOwner']->get_ID().'_'.intval( $params['LinkOwner']->is_temp() ).'\"';\n \t\t}\n \t\t?>\n \n@@ -2318,7 +2318,7 @@ function display_dragdrop_upload_button( $params = array() )\n \t\t\t\tadditional_dropzone: '<?php echo $params['additional_dropzone']; ?>',\n \t\t\t\taction: url,\n \t\t\t\tsizeLimit: <?php echo ( $Settings->get( 'upload_maxkb' ) * 1024 ); ?>,\n-\t\t\t\tdebug: true,\n+\t\t\t\tdebug: false,\n \t\t\t\tmessages: {\n \t\t\t\t\ttypeError: '<?php echo /* TRANS: strings in {} must NOT be translated */ TS_('{file} has an invalid extension. Only {extensions} are allowed.'); ?>',\n \t\t\t\t\tsizeError: '<?php echo /* TRANS: strings in {} must NOT be translated */ TS_('{file} cannot be uploaded because it is too large ({fileSize}). The maximum allowed upload size is {sizeLimit}.'); ?>',\n@@ -2389,11 +2389,24 @@ function display_dragdrop_upload_button( $params = array() )\n \t\t\t\t\t\tvar table_view = typeof( responseJSON.success.link_ID ) != 'undefined' ? 'link' : 'file';\n \n \t\t\t\t\t\tvar filename_before = '<?php echo str_replace( \"'\", \"\\'\", $params['filename_before'] ); ?>';\n+\t\t\t\t\t\tvar filename_select = '<?php echo str_replace( \"'\", \"\\'\", $params['filename_select'] ); ?>';\n \t\t\t\t\t\tif( filename_before != '' )\n \t\t\t\t\t\t{\n \t\t\t\t\t\t\tfilename_before = filename_before.replace( '$file_path$', decodeURIComponent( responseJSON.success.path ) );\n \t\t\t\t\t\t}\n \n+\t\t\t\t\t\tif( filename_select != '' )\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t\tif( responseJSON.success.filetype == 'image' )\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tfilename_select = filename_select.replace( '$file_path$', decodeURIComponent( responseJSON.success.path ) );\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\telse\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tfilename_select = '';\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t}\n+\n \t\t\t\t\t\tvar warning = '';\n \t\t\t\t\t\tif( responseJSON.success.warning != '' )\n \t\t\t\t\t\t{\n@@ -2416,7 +2429,7 @@ function display_dragdrop_upload_button( $params = array() )\n \t\t\t\t\t\t\tthis_row.find( '.qq-upload-status' ).html( '' );\n \t\t\t\t\t\t\t<?php } ?>\n \t\t\t\t\t\t\tthis_row.find( '.qq-upload-image' ).html( text );\n-\t\t\t\t\t\t\tthis_row.find( '.qq-upload-file' ).html( filename_before\n+\t\t\t\t\t\t\tthis_row.find( '.qq-upload-file' ).html( filename_before + filename_select\n \t\t\t\t\t\t\t\t+ '<input type=\"hidden\" value=\"' + responseJSON.success.newpath + '\" />'\n \t\t\t\t\t\t\t\t+ '<span class=\"fname\">' + file_name + '</span>' + warning );\n \t\t\t\t\t\t}"
        },
        {
          "filename": "inc/files/model/_filelist.class.php",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -492,10 +492,16 @@ function update_caches()\n \t */\n \tfunction add_by_subpath( $rel_path, $mustExist = false )\n \t{\n-\t\t$FileCache = & get_FileCache();\n-\t\t$NewFile = & $FileCache->get_by_root_and_path( $this->_FileRoot->type, $this->_FileRoot->in_type_ID, $rel_path );\n+\t\t$FileRoot = & $this->get_FileRoot();\n \n-\t\treturn $this->add( $NewFile, $mustExist );\n+\t\tif( $FileRoot->contains( $rel_path ) )\n+\t\t{\t// If a file is really contained in the FileRoot of this list:\n+\t\t\t$FileCache = & get_FileCache();\n+\t\t\t$NewFile = & $FileCache->get_by_root_and_path( $this->_FileRoot->type, $this->_FileRoot->in_type_ID, $rel_path );\n+\n+\t\t\t// Add a file to this list:\n+\t\t\treturn $this->add( $NewFile, $mustExist );\n+\t\t}\n \t}\n \n "
        },
        {
          "filename": "inc/files/model/_fileroot.class.php",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -258,6 +258,26 @@ static function gen_ID( $root_type, $root_in_type_ID )\n \t\tdebug_die( \"Invalid root type\" );\n \t}\n \n+\n+\t/**\n+\t * Check if this file root contains a file/folder with given relative path\n+\t *\n+\t * @param string Subpath for file/folder, relative the associated root, including trailing slash (if directory)\n+\t * @return boolean\n+\t */\n+\tfunction contains( $rel_path )\n+\t{\n+\t\t// Convert a path from \"/dir1/dir2/../dir3/file.txt\" to \"/dir1/dir3/file.txt\":\n+\t\t$real_abs_path = get_canonical_path( $this->ads_path.$rel_path );\n+\n+\t\t// Check if the given file/folder is realy contained in this root:\n+\t\tif( ! empty( $real_abs_path ) && strpos( $real_abs_path, $this->ads_path ) !== 0 )\n+\t\t{\t// Deny access from another file root:\n+\t\t\tdebug_die( 'Denied access to files from another root!' );\n+\t\t}\n+\n+\t\treturn true;\n+\t}\n }\n \n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "inc/files/upload.ctrl.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -56,7 +56,7 @@\n $action = param_action();\n \n // INIT params:\n-if( param( 'root_and_path', 'string', '', false ) /* not memorized (default) */ && strpos( $root_and_path, '::' ) )\n+if( param( 'root_and_path', 'filepath', '', false ) /* not memorized (default) */ && strpos( $root_and_path, '::' ) )\n { // root and path together: decode and override (used by \"radio-click-dirtree\")\n \tlist( $root, $path ) = explode( '::', $root_and_path, 2 );\n \t// Memorize new root:\n@@ -66,7 +66,7 @@\n else\n {\n \tparam( 'root', 'string', NULL, true ); // the root directory from the dropdown box (user_X or blog_X; X is ID - 'user' for current user (default))\n-\tparam( 'path', 'string', '', true );  // the path relative to the root dir\n+\tparam( 'path', 'filepath', '', true );  // the path relative to the root dir\n \tif( param( 'new_root', 'string', '' )\n \t\t&& $new_root != $root )\n \t{ // We have changed root in the select list\n@@ -227,7 +227,7 @@\n  * Remember renamed files (and the messages)\n  * @var array\n  */\n-param( 'renamedFiles', 'array:array:string', array(), true );\n+param( 'renamedFiles', 'array:array:filepath', array(), true );\n $renamedMessages = array();\n \n // Process files we want to get from an URL:"
        },
        {
          "filename": "inc/files/views/_file_list.inc.php",
          "status": "modified",
          "additions": 47,
          "deletions": 1,
          "patch": "@@ -58,7 +58,7 @@\n global $linkctrl, $linkdata;\n \n // Name of the iframe we want some actions to come back to:\n-global $iframe_name;\n+global $iframe_name, $field_name;\n \n $Form = new Form( NULL, 'FilesForm', 'post', 'none' );\n $Form->begin_form();\n@@ -330,6 +330,21 @@\n \n \t\t\t\t\techo ' ';\n \t\t\t\t}\n+\n+\t\t\t\tif( $fm_mode == 'file_select' && !empty( $field_name )  && !$lFile->is_dir() && $lFile->is_image() )\n+\t\t\t\t{\n+\t\t\t\t\t$sfile_root = FileRoot::gen_ID( $fm_Filelist->get_root_type(), $fm_Filelist->get_root_ID() );\n+\t\t\t\t\t$sfile_path = $lFile->get_rdfp_rel_path();\n+\t\t\t\t\t$link_attribs = array();\n+\t\t\t\t\t$link_action = 'set_field';\n+\t\t\t\t\t$link_attribs['target'] = '_parent';\n+\t\t\t\t\t$link_attribs['class'] = 'action_icon select_file btn btn-primary btn-xs';\n+\t\t\t\t\t$link_attribs['onclick'] = 'return window.parent.file_select_add( select_field_name, \\''.$sfile_root.'\\', \\''.$sfile_path.'\\' );';\n+\t\t\t\t\techo action_icon( T_('Select file'), 'link',\n+\t\t\t\t\t\t\tregenerate_url( 'fm_selected', 'action=file_select&amp;fm_selected[]='.rawurlencode($lFile->get_rdfp_rel_path()).'&amp;'.url_crumb('file') ),\n+\t\t\t\t\t\t\t' '.T_('Select'), NULL, 5, $link_attribs );\n+\t\t\t\t\techo ' ';\n+\t\t\t\t}\n \t\t\t}\n \n \t\t\t/********************  Filename  ********************/\n@@ -559,6 +574,24 @@\n \t\t\t\t$icon_to_link_files = '';\n \t\t\t}\n \n+\t\t\tif( $fm_mode == 'file_select' && !empty( $field_name ) )\n+\t\t\t{\n+\t\t\t\t$sfile_root = FileRoot::gen_ID( $fm_Filelist->get_root_type(), $fm_Filelist->get_root_ID() );\n+\t\t\t\t$link_attribs = array();\n+\t\t\t\t$link_action = 'set_field';\n+\t\t\t\t$link_attribs['target'] = '_parent';\n+\t\t\t\t$link_attribs['class'] = 'action_icon select_file btn btn-primary btn-xs';\n+\t\t\t\t$link_attribs['onclick'] = 'return window.parent.file_select_add( select_field_name, \\''.$sfile_root.'\\', \\''.'$file_path$'.'\\' );';\n+\t\t\t\t$icon_to_select_files = action_icon( T_('Select file'), 'link',\n+\t\t\t\t\t\tregenerate_url( 'fm_selected', 'action=file_select&amp;fm_selected[]='.'$file_path$'.'&amp;'.url_crumb('file') ),\n+\t\t\t\t\t\t' '.T_('Select'), NULL, 5, $link_attribs ).' ';\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\t$icon_to_select_files = '';\n+\t\t\t}\n+\n+\n \t\t\t$template_filerow = '<table><tr>'\n \t\t\t\t.'<td class=\"checkbox firstcol qq-upload-checkbox\">&nbsp;</td>'\n \t\t\t\t.'<td class=\"icon_type qq-upload-image\"><span class=\"qq-upload-spinner\">&nbsp;</span></td>';\n@@ -614,6 +647,7 @@\n \t\t\t\t\t'display_support_msg' => false,\n \t\t\t\t\t'additional_dropzone' => '#filelist_tbody',\n \t\t\t\t\t'filename_before'     => $icon_to_link_files,\n+\t\t\t\t\t'filename_select'     => $icon_to_select_files,\n \t\t\t\t) );\n \t\t\t?>\n \t\t\t</td>\n@@ -726,6 +760,8 @@\n \t\t?>\n \t\t<script type=\"text/javascript\">\n \t\t\t<!--\n+\t\t\tvar select_field_name = '<?php echo $field_name;?>';\n+\n \t\t\tfunction js_act_on_selected()\n \t\t\t{\n \t\t\t\t// There may be an easier selector than below but couldn't make sense of it :(\n@@ -822,6 +858,16 @@ function insert_tag_for_selected_files()\n \t\t\t\t\tjQuery( this ).parent().append( '<div class=\"green\"><?php echo TS_('The file has been linked.'); ?></div>' );\n \t\t\t\t} );\n \t\t\t} );\n+\n+\t\t\t// Display a message to inform user after the file was selected\n+\t\t\tjQuery( document ).ready( function()\n+\t\t\t{\n+\t\t\t\tjQuery( document ).on( 'click', 'a.select_file', function()\n+\t\t\t\t{\n+\t\t\t\t\tjQuery( '.selected_msg' ).remove();\n+\t\t\t\t\tjQuery( this ).parent().append( '<div class=\"green selected_msg\"><?php echo TS_('The file has been selected.'); ?></div>' );\n+\t\t\t\t} );\n+\t\t\t} );\n \t\t\t// -->\n \t\t</script>\n \t\t<?php"
        },
        {
          "filename": "inc/items/items.ctrl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -236,7 +236,7 @@\n \n \t\t$FileRootCache = & get_FileRootCache();\n \t\t// getting root\n-\t\t$root = param( 'root' );\n+\t\t$root = param( 'root', 'string' );\n \n \t\t$fm_FileRoot = & $FileRootCache->get_by_ID( $root, true );\n "
        },
        {
          "filename": "inc/items/model/_item.class.php",
          "status": "modified",
          "additions": 82,
          "deletions": 2,
          "patch": "@@ -1046,6 +1046,73 @@ function load_from_Request( $editing = false, $creating = false )\n \t}\n \n \n+\t/**\n+\t * Link attachments from temporary object to new created Item\n+\t */\n+\tfunction link_from_Request()\n+\t{\n+\t\tglobal $DB;\n+\n+\t\tif( $this->ID == 0 )\n+\t\t{\t// The item must be stored in DB:\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t$temp_link_owner_ID = param( 'temp_link_owner_ID', 'integer', 0 );\n+\n+\t\t$TemporaryIDCache = & get_TemporaryIDCache();\n+\t\tif( ! ( $TemporaryID = & $TemporaryIDCache->get_by_ID( $temp_link_owner_ID, false, false ) ) )\n+\t\t{\t// No temporary object of attachments:\n+\t\t\treturn;\n+\t\t}\n+\n+\t\tif( $TemporaryID->type != 'item' )\n+\t\t{\t// Wrong temporary object:\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Load all links:\n+\t\t$LinkOwner = new LinkItem( new Item(), $TemporaryID->ID );\n+\t\t$LinkOwner->load_Links();\n+\n+\t\tif( empty( $LinkOwner->Links ) )\n+\t\t{\t// No links:\n+\t\t\treturn;\n+\t\t}\n+\n+\t\t// Change link owner from temporary to message object:\n+\t\t$DB->query( 'UPDATE T_links\n+\t\t\t  SET link_itm_ID = '.$this->ID.',\n+\t\t\t      link_tmp_ID = NULL\n+\t\t\tWHERE link_tmp_ID = '.$TemporaryID->ID );\n+\n+\t\t// Move all temporary files to folder of new created message:\n+\t\tforeach( $LinkOwner->Links as $item_Link )\n+\t\t{\n+\t\t\tif( $item_File = & $item_Link->get_File() &&\n+\t\t\t    $item_FileRoot = & $item_File->get_FileRoot() )\n+\t\t\t{\n+\t\t\t\tif( ! file_exists( $item_FileRoot->ads_path.'quick-uploads/p'.$this->ID.'/' ) )\n+\t\t\t\t{\t// Create if folder doesn't exist for files of new created message:\n+\t\t\t\t\tif( mkdir_r( $item_FileRoot->ads_path.'quick-uploads/p'.$this->ID.'/' ) )\n+\t\t\t\t\t{\n+\t\t\t\t\t\t$tmp_folder_path = $item_FileRoot->ads_path.'quick-uploads/tmp'.$TemporaryID->ID.'/';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t\t$item_File->move_to( $item_FileRoot->type, $item_FileRoot->in_type_ID, 'quick-uploads/p'.$this->ID.'/'.$item_File->get_name() );\n+\t\t\t}\n+\t\t}\n+\n+\t\tif( isset( $tmp_folder_path ) && file_exists( $tmp_folder_path ) )\n+\t\t{\t// Remove temp folder from disk completely:\n+\t\t\trmdir_r( $tmp_folder_path );\n+\t\t}\n+\n+\t\t// Delete temporary object from DB:\n+\t\t$TemporaryID->dbdelete();\n+\t}\n+\n+\n \t/**\n \t * Template function: display anchor for permalinks to refer to.\n \t */\n@@ -1485,7 +1552,7 @@ function can_attach()\n \t */\n \tfunction check_and_clear_inline_files( $content )\n \t{\n-\t\tpreg_match_all( '/\\[(image|file):(\\d+):?[^\\]]*\\]/i', $content, $inline_images );\n+\t\tpreg_match_all( '/\\[(image|file|inline|video|audio|thumbnail):(\\d+):?[^\\]]*\\]/i', $content, $inline_images );\n \n \t\tif( empty( $inline_images[1] ) )\n \t\t{ // There are no inline image placeholders in the post content\n@@ -3076,7 +3143,17 @@ function get_images( $params = array(), $format = 'htmlbody' )\n \t\t\t\t'sql_select_add' => $params['links_sql_select'],\n \t\t\t\t'sql_order_by'   => $params['links_sql_orderby']\n \t\t\t);\n-\t\t$LinkOwner = new LinkItem( $this );\n+\n+\t\tif( empty( $this->ID ) )\n+\t\t{\t// Preview mode for new creating item:\n+\t\t\t$tmp_object_ID = param( 'temp_link_owner_ID', 'integer', 0 );\n+\t\t}\n+\t\telse\n+\t\t{\t// Normal mode for existing Item in DB:\n+\t\t\t$tmp_object_ID = NULL;\n+\t\t}\n+\n+\t\t$LinkOwner = new LinkItem( $this, $tmp_object_ID );\n \t\tif( ! $LinkList = $LinkOwner->get_attachment_LinkList( 1000, $params['restrict_to_image_position'], NULL, $links_params ) )\n \t\t{\n \t\t\treturn '';\n@@ -5602,6 +5679,9 @@ function dbinsert()\n \t\tif( $result = parent::dbinsert() )\n \t\t{ // We could insert the item object..\n \n+\t\t\t// Link attachments from temporary object to new created Item:\n+\t\t\t$this->link_from_Request();\n+\n \t\t\t// Let's handle the extracats:\n \t\t\t$result = $this->insert_update_extracats( 'insert' );\n "
        },
        {
          "filename": "inc/items/model/_item.funcs.php",
          "status": "modified",
          "additions": 37,
          "deletions": 0,
          "patch": "@@ -3739,6 +3739,10 @@ function items_manual_results_block( $params = array() )\n \t$Table->cols[] = array(\n \t\t\t\t\t\t\t'th' => T_('Name'),\n \t\t\t\t\t\t);\n+\t$Table->cols[] = array(\n+\t\t\t\t\t\t\t'th' => T_('Image'),\n+\t\t\t\t\t\t\t'th_class' => 'shrinkwrap',\n+\t\t\t\t\t\t);\n \t$Table->cols[] = array(\n \t\t\t\t\t\t\t'th' => T_('URL \"slug\"'),\n \t\t\t\t\t\t);\n@@ -4652,6 +4656,20 @@ function manual_display_chapter_row( $Chapter, $level, $params = array() )\n \t}\n \t$r .= '</strong></td>';\n \n+\t// Category image\n+\t$file_ID = $Chapter->get( 'image_file_ID' );\n+\t$cat_thumb = '';\n+\tif( $file_ID )\n+\t{\n+\t\t$FileCache = & get_FileCache();\n+\t\t$cat_image_File = & $FileCache->get_by_ID( $file_ID, false, false );\n+\t\tif( $cat_image_File )\n+\t\t{\n+\t\t\t$cat_thumb = $cat_image_File->get_thumb_imgtag( 'crop-48x48' );\n+\t\t}\n+\t}\n+\t$r .= '<td>'.$cat_thumb.'</td>';\n+\n \t// URL \"slug\"\n \t$r .= '<td><a href=\"'.htmlspecialchars($Chapter->get_permanent_url()).'\">'.$Chapter->dget('urlname').'</a></td>';\n \n@@ -4754,6 +4772,25 @@ function manual_display_post_row( $Item, $level, $params = array() )\n \t$r .= !empty( $item_edit_url ) ? '</a>' : '';\n \t$r .= '</strong></td>';\n \n+\t// Category image\n+\t$cat_thumb = '';\n+\t$ChapterCache = & get_ChapterCache();\n+\tif( $Item->main_cat_ID && ( $Chapter = & $ChapterCache->get_by_ID( $Item->main_cat_ID, false, false ) ) )\n+\t{\n+\t\t$file_ID = $Chapter->get( 'image_file_ID' );\n+\n+\t\tif( $file_ID )\n+\t\t{\n+\t\t\t$FileCache = & get_FileCache();\n+\t\t\t$cat_image_File = & $FileCache->get_by_ID( $file_ID, false, false );\n+\t\t\tif( $cat_image_File )\n+\t\t\t{\n+\t\t\t\t$cat_thumb = $cat_image_File->get_thumb_imgtag( 'crop-48x48' );\n+\t\t\t}\n+\t\t}\n+\t}\n+\t$r .= '<td>'.$cat_thumb.'</td>';\n+\n \t// URL \"slug\"\n \t$edit_url = regenerate_url( 'action,cat_ID', 'cat_ID='.$Item->ID.'&amp;action=edit' );\n \t$r .= '<td>'.$Item->get_title( $params );"
        },
        {
          "filename": "inc/items/views/_item_expert.form.php",
          "status": "modified",
          "additions": 8,
          "deletions": 7,
          "patch": "@@ -268,15 +268,16 @@\n \n \n \t// ####################### ATTACHMENTS/LINKS #########################\n-\tif( isset( $GLOBALS['files_Module'] )\n-\t\t&& $current_User->check_perm( 'item_post!CURSTATUS', 'edit', false, $edited_Item )\n-\t\t&& $current_User->check_perm( 'files', 'view', false ) )\n-\t{ // Files module is enabled, but in case of creating new posts we should show file attachments block only if user has all required permissions to attach files\n+\tif( $edited_Item->get_type_setting( 'allow_attachments' ) &&\n+\t    $current_User->check_perm( 'files', 'view', false ) )\n+\t{\t// If current user has a permission to view the files AND attachments are allowed for the item type:\n \t\tload_class( 'links/model/_linkitem.class.php', 'LinkItem' );\n-\t\tglobal $LinkOwner; // Initialize this object as global because this is used in many link functions\n-\t\t$LinkOwner = new LinkItem( $edited_Item );\n+\t\t// Initialize this object as global because this is used in many link functions:\n+\t\tglobal $LinkOwner;\n+\t\t$LinkOwner = new LinkItem( $edited_Item, param( 'temp_link_owner_ID', 'integer', 0 ) );\n+\t\t// Display attachments fieldset:\n \t\t$fold_images_attachments_block = ( $orig_action != 'update_edit' && $orig_action != 'create_edit' ); // don't fold the links block on these two actions\n-\t\tdisplay_attachments_fieldset( $Form, $LinkOwner, $creating, $fold_images_attachments_block );\n+\t\tdisplay_attachments_fieldset( $Form, $LinkOwner, false, $fold_images_attachments_block );\n \t}\n \n "
        },
        {
          "filename": "inc/links/model/_link.funcs.php",
          "status": "modified",
          "additions": 30,
          "deletions": 20,
          "patch": "@@ -74,11 +74,16 @@ function & get_link_owner( $link_type, $object_ID )\n \t\t\tswitch( $TemporaryID->get( 'type' ) )\n \t\t\t{\n \t\t\t\tcase 'message':\n-\t\t\t\t\t$LinkOwner = new LinkMessage( NULL, $object_ID );\n+\t\t\t\t\t$LinkOwner = new LinkMessage( new Message(), $object_ID );\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tcase 'item':\n+\t\t\t\t\tload_class( 'items/model/_item.class.php', 'Item' );\n+\t\t\t\t\t$LinkOwner = new LinkItem( new Item(), $object_ID );\n \t\t\t\t\tbreak;\n \t\t\t}\n+\t\t\t$LinkOwner->tmp_ID = $object_ID;\n \t\t\t$LinkOwner->type = 'temporary';\n-\t\t\t$LinkOwner->is_temp = true;\n \t\t\tbreak;\n \n \t\tdefault:\n@@ -98,24 +103,26 @@ function & get_link_owner( $link_type, $object_ID )\n  */\n function display_attachments_fieldset( & $Form, & $LinkOwner, $creating = false, $fold = false )\n {\n-\tglobal $admin_url, $AdminUI;\n+\tglobal $admin_url, $inc_path;\n \tglobal $current_User, $action;\n \n-\tif( $LinkOwner->type == 'item' && ! $LinkOwner->is_temp && ! $LinkOwner->Item->get_type_setting( 'allow_attachments' ) )\n-\t{ // Attachments are not allowed for current post type\n+\tif( ! isset( $GLOBALS[ 'files_Module' ] ) )\n+\t{\t// Files module is not enabled:\n \t\treturn;\n \t}\n \n-\tif( ! isset( $GLOBALS[ 'files_Module' ] ) )\n-\t{\n+\tif( ! is_logged_in()\n+\t    || ! $current_User->check_perm( 'files', 'view' )\n+\t    || ! $LinkOwner->check_perm( 'edit', false ) )\n+\t{\t// Current user has no perm to view files:\n \t\treturn;\n \t}\n \n \t// Set title for modal window:\n \tswitch( $LinkOwner->type )\n \t{\n \t\tcase 'item':\n-\t\t\t$window_title = $LinkOwner->is_temp ? '' : format_to_js( sprintf( T_('Attach files to \"%s\"'), $LinkOwner->Item->get( 'title' ) ) );\n+\t\t\t$window_title = $LinkOwner->is_temp() ? '' : format_to_js( sprintf( T_('Attach files to \"%s\"'), $LinkOwner->Item->get( 'title' ) ) );\n \t\t\t$form_id = 'itemform_links';\n \t\t\tbreak;\n \n@@ -160,12 +167,14 @@ function display_attachments_fieldset( & $Form, & $LinkOwner, $creating = false,\n \t\treturn;\n \t}\n \n-\t$fieldset_title .= ' '.get_manual_link( 'images-attachments-panel' );\n+\tif( is_admin_page() )\n+\t{\t// Display a link to manual page only on back-office:\n+\t\t$fieldset_title .= ' '.get_manual_link( 'images-attachments-panel' );\n+\t}\n \n-\tif( $current_User->check_perm( 'files', 'view' )\n-\t\t&& $LinkOwner->check_perm( 'edit', false ) )\n-\t{ // Check that we have permission to edit owner:\n-\t\t$attach_files_url = $admin_url.'?ctrl=files&amp;fm_mode=link_object&amp;link_type='.$LinkOwner->type.( $LinkOwner->type != 'message' ? '&amp;link_object_ID='.$LinkOwner->get_ID() : '' );\n+\tif( $current_User->check_perm( 'admin', 'restricted' ) )\n+\t{\t// Check if current user has a permission to back-office files manager:\n+\t\t$attach_files_url = $admin_url.'?ctrl=files&amp;fm_mode=link_object&amp;link_type='.( $LinkOwner->is_temp() ? 'temporary' : $LinkOwner->type ).( $LinkOwner->type != 'message' ? '&amp;link_object_ID='.$LinkOwner->get_ID() : '' );\n \t\tif( $linkowner_FileList = $LinkOwner->get_attachment_FileList( 1 ) )\n \t\t{\t// Get first file of the Link Owner:\n \t\t\t$linkowner_File = & $linkowner_FileList->get_next();\n@@ -179,7 +188,7 @@ function display_attachments_fieldset( & $Form, & $LinkOwner, $creating = false,\n \t\t$fieldset_title .= ' - '\n \t\t\t.action_icon( T_('Attach existing files'), 'folder', $attach_files_url,\n \t\t\t\tT_('Attach existing files'), 3, 4,\n-\t\t\t\tarray( 'onclick' => 'return link_attachment_window( \\''.$LinkOwner->type.'\\', \\''.$LinkOwner->get_ID().'\\' )' ) )\n+\t\t\t\tarray( 'onclick' => 'return link_attachment_window( \\''.( $LinkOwner->is_temp() ? 'temporary' : $LinkOwner->type ).'\\', \\''.$LinkOwner->get_ID().'\\' )' ) )\n \t\t\t.action_icon( T_('Attach existing files'), 'permalink', $attach_files_url,\n \t\t\t\tT_('Attach existing files'), 1, 0,\n \t\t\t\tarray( 'target' => '_blank' ) );\n@@ -188,11 +197,12 @@ function display_attachments_fieldset( & $Form, & $LinkOwner, $creating = false,\n \t$fieldset_title .= '<span class=\"floatright\">&nbsp;'\n \n \t\t\t.action_icon( T_('Refresh'), 'refresh', $LinkOwner->get_edit_url(),\n-\t\t\t\tT_('Refresh'), 3, 4, array( 'class' => 'action_icon btn btn-default btn-sm', 'onclick' => 'return evo_link_refresh_list( \\''.$LinkOwner->type.'\\', \\''.$LinkOwner->get_ID().'\\' )' ) )\n+\t\t\t\tT_('Refresh'), 3, 4, array( 'class' => 'action_icon btn btn-default btn-sm', 'onclick' => 'return evo_link_refresh_list( \\''.( $LinkOwner->is_temp() ? 'temporary' : $LinkOwner->type ).'\\', \\''.$LinkOwner->get_ID().'\\' )' ) )\n \n-\t\t\t.action_icon( T_('Sort'), 'ascending', $admin_url\n-\t\t\t\t.'?ctrl=links&amp;action=sort_links&amp;link_type='.$LinkOwner->type.'&amp;link_object_ID='.$LinkOwner->get_ID().'&amp;'.url_crumb( 'link' ),\n-\t\t\t\tT_('Sort'), 3, 4, array( 'class' => 'action_icon btn btn-default btn-sm', 'onclick' => 'return evo_link_refresh_list( \\''.$LinkOwner->type.'\\', \\''.$LinkOwner->get_ID().'\\', \\'sort\\' )' ) )\n+\t\t\t.action_icon( T_('Sort'), 'ascending', ( is_admin_page() || $current_User->check_perm( 'admin', 'restricted' ) )\n+\t\t\t\t? $admin_url.'?ctrl=links&amp;action=sort_links&amp;link_type='.$LinkOwner->type.'&amp;link_object_ID='.$LinkOwner->get_ID().'&amp;'.url_crumb( 'link' )\n+\t\t\t\t: $LinkOwner->get_edit_url().'#',\n+\t\t\t\tT_('Sort'), 3, 4, array( 'class' => 'action_icon btn btn-default btn-sm', 'onclick' => 'return evo_link_refresh_list( \\''.( $LinkOwner->is_temp() ? 'temporary' : $LinkOwner->type ).'\\', \\''.$LinkOwner->get_ID().'\\', \\'sort\\' )' ) )\n \n \t\t.'</span>';\n \n@@ -208,7 +218,7 @@ function display_attachments_fieldset( & $Form, & $LinkOwner, $creating = false,\n \techo '<div id=\"attachments_fieldset_wrapper\">';\n \t\techo '<div id=\"attachments_fieldset_block\">';\n \t\t\techo '<div id=\"attachments_fieldset_table\">';\n-\t\t\t\t$AdminUI->disp_view( 'links/views/_link_list.view.php' );\n+\t\t\t\trequire $inc_path.'links/views/_link_list.view.php';\n \t\t\techo '</div>';\n \t\techo '</div>';\n \techo '</div>';\n@@ -575,7 +585,7 @@ function echo_link_sortable_js()\n \n \t\t\tjQuery.ajax(\n \t\t\t{\n-\t\t\t\turl: '<?php echo get_htsrv_url(); ?>async.php',\n+\t\t\t\turl: '<?php echo get_htsrv_url(); ?>anon_async.php',\n \t\t\t\ttype: 'POST',\n \t\t\t\tdata:\n \t\t\t\t{"
        },
        {
          "filename": "inc/links/model/_linkitem.class.php",
          "status": "modified",
          "additions": 97,
          "deletions": 17,
          "patch": "@@ -27,11 +27,14 @@ class LinkItem extends LinkOwner\n \n \t/**\n \t * Constructor\n+\t *\n+\t * @param object Item\n+\t * @param integer ID of temporary object from table T_temporary_ID (used for uploads on new items)\n \t */\n-\tfunction __construct( $Item )\n+\tfunction __construct( $Item, $tmp_ID = NULL )\n \t{\n \t\t// call parent contsructor\n-\t\tparent::__construct( $Item, 'item', 'itm_ID' );\n+\t\tparent::__construct( $Item, 'item', 'itm_ID', $tmp_ID );\n \t\t$this->Item = & $this->link_Object;\n \n \t\t$this->_trans = array(\n@@ -56,7 +59,15 @@ function __construct( $Item )\n \tfunction check_perm( $permlevel, $assert = false )\n \t{\n \t\tglobal $current_User;\n-\t\treturn $current_User->check_perm( 'item_post!CURSTATUS', $permlevel, $assert, $this->Item );\n+\n+\t\tif( $this->is_temp() )\n+\t\t{\t// Check permission for new creating item:\n+\t\t\treturn $current_User->check_perm( 'blog_post_statuses', 'edit', false, $this->link_Object->tmp_coll_ID );\n+\t\t}\n+\t\telse\n+\t\t{\t// Check permission for existing item in DB:\n+\t\t\treturn $current_User->check_perm( 'item_post!CURSTATUS', $permlevel, $assert, $this->Item );\n+\t\t}\n \t}\n \n \t/**\n@@ -143,7 +154,14 @@ function load_Links()\n \t\tif( is_null( $this->Links ) )\n \t\t{ // Links have not been loaded yet:\n \t\t\t$LinkCache = & get_LinkCache();\n-\t\t\t$this->Links = $LinkCache->get_by_item_ID( $this->Item->ID );\n+\t\t\tif( $this->is_temp() )\n+\t\t\t{\n+\t\t\t\t$this->Links = $LinkCache->get_by_temporary_ID( $this->get_ID() );\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\t$this->Links = $LinkCache->get_by_item_ID( $this->Item->ID );\n+\t\t\t}\n \t\t}\n \t}\n \n@@ -170,17 +188,19 @@ function add_link( $file_ID, $position = NULL, $order = 1, $update_owner = true\n \t\t$edited_Link->set( 'order', $order );\n \t\tif( $edited_Link->dbinsert() )\n \t\t{\n-\t\t\t// New link was added to the item, invalidate blog's media BlockCache\n-\t\t\tBlockCache::invalidate_key( 'media_coll_ID', $this->Item->get_blog_ID() );\n+\t\t\tif( ! $this->is_temp() )\n+\t\t\t{\t// New link was added to the item, invalidate blog's media BlockCache:\n+\t\t\t\tBlockCache::invalidate_key( 'media_coll_ID', $this->Item->get_blog_ID() );\n+\t\t\t}\n \n \t\t\t$FileCache = & get_FileCache();\n \t\t\t$File = $FileCache->get_by_ID( $file_ID, false, false );\n \t\t\t$file_name = empty( $File ) ? '' : $File->get_name();\n \t\t\t$file_dir = $File->dir_or_file();\n \t\t\tsyslog_insert( sprintf( '%s %s was linked to %s with ID=%s',  ucfirst( $file_dir ), '[['.$file_name.']]', $this->type, $this->get_ID() ), 'info', 'file', $file_ID );\n \n-\t\t\tif( $update_owner )\n-\t\t\t{ // Update last touched date of the Item\n+\t\t\tif( ! $this->is_temp() && $update_owner )\n+\t\t\t{\t// Update last touched date of the Item:\n \t\t\t\t$this->update_last_touched_date();\n \t\t\t}\n \n@@ -201,7 +221,17 @@ function load_Blog()\n \t{\n \t\tif( is_null( $this->Blog ) )\n \t\t{\n-\t\t\t$this->Blog = & $this->Item->get_Blog();\n+\t\t\t$Item = $this->Item;\n+\t\t\tif( $Item->ID == 0 )\n+\t\t\t{\t// This is a request of new creating Item (for example, preview mode),\n+\t\t\t\t// We should use current collection, because new Item has no category ID yet here to load Collection:\n+\t\t\t\tglobal $Blog;\n+\t\t\t\t$this->Blog = $Blog;\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\t// Use Collection of the existing Item:\n+\t\t\t\t$this->Blog = & $this->Item->get_Blog();\n+\t\t\t}\n \t\t}\n \t}\n \n@@ -223,20 +253,68 @@ function get( $parname )\n \n \t/**\n \t * Get Item edit url\n+\t *\n+\t * @return string URL\n \t */\n \tfunction get_edit_url()\n \t{\n-\t\t$this->load_Blog();\n-\t\treturn '?ctrl=items&amp;blog='.$this->Blog->ID.'&amp;action=edit&amp;p='.$this->Item->ID;\n+\t\tif( is_admin_page() )\n+\t\t{\t// Back-office:\n+\t\t\tglobal $admin_url;\n+\t\t\tif( $this->is_temp() )\n+\t\t\t{\t// New creating Item:\n+\t\t\t\treturn $admin_url.'?ctrl=items&amp;blog='.$this->link_Object->tmp_coll_ID.'&amp;action=new';\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\t// The edited Item:\n+\t\t\t\t$this->load_Blog();\n+\t\t\t\treturn $admin_url.'?ctrl=items&amp;blog='.$this->Blog->ID.'&amp;action=edit&amp;p='.$this->Item->ID;\n+\t\t\t}\n+\t\t}\n+\t\telse\n+\t\t{\t// Front-office:\n+\t\t\tglobal $Blog;\n+\t\t\tif( $this->is_temp() )\n+\t\t\t{\t// New creating Item:\n+\t\t\t\treturn url_add_param( $Blog->get( 'url' ), 'disp=edit' );\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\t// The edited Item:\n+\t\t\t\treturn url_add_param( $Blog->get( 'url' ), 'disp=edit&amp;p='.$this->Item->ID );\n+\t\t\t}\n+\t\t}\n \t}\n \n \t/**\n \t * Get Item view url\n \t */\n \tfunction get_view_url()\n \t{\n-\t\t$this->load_Blog();\n-\t\treturn '?ctrl=items&amp;blog='.$this->Blog->ID.'&amp;p='.$this->Item->ID;\n+\t\tif( is_admin_page() )\n+\t\t{\t// Back-office:\n+\t\t\tglobal $admin_url;\n+\t\t\tif( $this->is_temp() )\n+\t\t\t{\t// New creating Item:\n+\t\t\t\treturn $admin_url.'?ctrl=items&amp;blog='.$this->link_Object->tmp_coll_ID.'&amp;action=new';\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\t// The edited Item:\n+\t\t\t\t$this->load_Blog();\n+\t\t\t\treturn $admin_url.'?ctrl=items&amp;blog='.$this->Blog->ID.'&amp;p='.$this->Item->ID;\n+\t\t\t}\n+\t\t}\n+\t\telse\n+\t\t{\t// Front-office:\n+\t\t\tglobal $Blog;\n+\t\t\tif( $this->is_temp() )\n+\t\t\t{\t// New creating Item:\n+\t\t\t\treturn url_add_param( $Blog->get( 'url' ), 'disp=edit' );\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\t// The edited Item:\n+\t\t\t\treturn url_add_param( $Blog->get( 'url' ), 'disp=edit&amp;p='.$this->Item->ID );\n+\t\t\t}\n+\t\t}\n \t}\n \n \n@@ -245,7 +323,7 @@ function get_view_url()\n \t */\n \tfunction update_last_touched_date()\n \t{\n-\t\tif( !empty( $this->Item ) )\n+\t\tif( ! empty( $this->Item ) && ! $this->is_temp() )\n \t\t{\t// Update Item if it exists\n \t\t\t$this->Item->update_last_touched_date();\n \t\t}\n@@ -265,7 +343,7 @@ function after_unlink_action( $link_ID = 0 )\n \n \t\tif( ! empty( $link_ID ) )\n \t\t{ // Find inline image placeholders if link ID is defined\n-\t\t\tpreg_match_all( '/\\[(image|file|inline|video|audio):'.$link_ID.':?[^\\]]*\\]/i', $this->Item->content, $inline_images );\n+\t\t\tpreg_match_all( '/\\[(image|file|inline|video|audio|thumbnail):'.$link_ID.':?[^\\]]*\\]/i', $this->Item->content, $inline_images );\n \t\t\tif( ! empty( $inline_images[0] ) )\n \t\t\t{ // There are inline image placeholders in the post content\n \t\t\t\t$this->Item->set( 'content', str_replace( $inline_images[0], '', $this->Item->content ) );\n@@ -274,8 +352,10 @@ function after_unlink_action( $link_ID = 0 )\n \t\t\t}\n \t\t}\n \n-\t\t// Update last touched date of the Item\n-\t\t$this->update_last_touched_date();\n+\t\tif( ! $this->is_temp() )\n+\t\t{\t// Update last touched date of the Item\n+\t\t\t$this->update_last_touched_date();\n+\t\t}\n \t}\n }\n "
        },
        {
          "filename": "inc/links/model/_linkmessage.class.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -29,7 +29,7 @@ class LinkMessage extends LinkOwner\n \t * Constructor\n \t *\n \t * @param object Message\n-\t * @param integer ID of temporary object from table T_temporary_ID (Used to link files to new creating message)\n+\t * @param integer ID of temporary object from table T_temporary_ID (used for uploads on new messages)\n \t */\n \tfunction __construct( $Message, $tmp_ID = NULL )\n \t{\n@@ -94,7 +94,7 @@ function load_Links()\n \t\tif( is_null( $this->Links ) )\n \t\t{\t// Links have not been loaded yet:\n \t\t\t$LinkCache = & get_LinkCache();\n-\t\t\tif( $this->is_temp )\n+\t\t\tif( $this->is_temp() )\n \t\t\t{\n \t\t\t\t$this->Links = $LinkCache->get_by_temporary_ID( $this->get_ID() );\n \t\t\t}\n@@ -183,6 +183,8 @@ function get_edit_url()\n \t */\n \tfunction get_view_url()\n \t{\n+\t\tglobal $admin_url;\n+\n \t\t$view_url = '';\n \t\tif( ! empty( $this->Message ) && ( $this->Message instanceof Message ) && $Thread = & $this->Message->get_Thread() )\n \t\t{"
        },
        {
          "filename": "inc/links/model/_linkowner.class.php",
          "status": "modified",
          "additions": 29,
          "deletions": 24,
          "patch": "@@ -66,12 +66,6 @@ class LinkOwner\n \t */\n \tvar $ID_field_name;\n \n-\t/**\n-\t * Flag to know if link owner is used for temporary object(new creating object)\n-\t *\n-\t * @var boolean\n-\t */\n-\tvar $is_temp = false;\n \n \t/**\n \t * Abstract methods that needs to be overriden in every subclass\n@@ -99,14 +93,7 @@ function __construct( $link_Object, $type, $ID_field_name, $tmp_ID = NULL )\n \t{\n \t\t$this->ID_field_name = $ID_field_name;\n \t\t$this->type = $type;\n-\t\tif( $type == 'message' )\n-\t\t{\t// Allow to link files only for new creating message:\n-\t\t\t$this->set_object( $link_Object, $tmp_ID );\n-\t\t}\n-\t\telse\n-\t\t{\t// Others allow to link files only for existing object:\n-\t\t\t$this->link_Object = $link_Object;\n-\t\t}\n+\t\t$this->set_object( $link_Object, $tmp_ID );\n \t}\n \n \n@@ -118,25 +105,32 @@ function __construct( $link_Object, $type, $ID_field_name, $tmp_ID = NULL )\n \t */\n \tfunction set_object( $link_Object, $tmp_ID = NULL )\n \t{\n+\t\t$this->link_Object = $link_Object;\n+\n \t\tif( empty( $link_Object ) || empty( $link_Object->ID ) )\n \t\t{\t// The object is creating currently, we should use a temporary object:\n \t\t\tif( $tmp_ID )\n \t\t\t{\t// Get already created temporary object:\n \t\t\t\t$TemporaryIDCache = & get_TemporaryIDCache();\n-\t\t\t\t$link_Object = & $TemporaryIDCache->get_by_ID( $tmp_ID, false, false );\n+\t\t\t\t$tmp_link_Object = & $TemporaryIDCache->get_by_ID( $tmp_ID, false, false );\n \t\t\t}\n \t\t\telse\n \t\t\t{\t// Create new temporary object:\n-\t\t\t\t$link_Object = new TemporaryID();\n-\t\t\t\t$link_Object->set( 'type', $this->type );\n-\t\t\t\t$link_Object->dbinsert();\n+\t\t\t\tglobal $blog;\n+\t\t\t\t$tmp_link_Object = new TemporaryID();\n+\t\t\t\t$tmp_link_Object->set( 'type', $this->type );\n+\t\t\t\tif( ! empty( $blog ) )\n+\t\t\t\t{\n+\t\t\t\t\t$tmp_link_Object->set( 'coll_ID', $blog );\n+\t\t\t\t}\n+\t\t\t\t$tmp_link_Object->dbinsert();\n \t\t\t}\n \n-\t\t\t// Mark this link owner is using temporary object:\n-\t\t\t$this->is_temp = true;\n+\t\t\t// Mark this link owner is using a temporary object:\n+\t\t\t$this->link_Object->tmp_ID = $tmp_link_Object->ID;\n+\t\t\t$this->link_Object->tmp_coll_ID = $tmp_link_Object->get( 'coll_ID' );\n+\t\t\t$this->link_Object->type = $tmp_link_Object->get( 'type' );\n \t\t}\n-\n-\t\t$this->link_Object = $link_Object;\n \t}\n \n \n@@ -273,12 +267,23 @@ function get_SQL( $order_by = NULL )\n \t\treturn $SQL;\n \t}\n \n+\n+\t/**\n+\t * Check if current link owner is used as temporary for new creating object\n+\t *\n+\t * @return boolean TRUE if link owner is temporary\n+\t */\n+\tfunction is_temp()\n+\t{\n+\t\treturn ! empty( $this->link_Object->tmp_ID );\n+\t}\n+\n \t/**\n \t * Get link owner object ID\n \t */\n \tfunction get_ID()\n \t{\n-\t\treturn $this->link_Object->ID;\n+\t\treturn $this->is_temp() ? $this->link_Object->tmp_ID : $this->link_Object->ID;\n \t}\n \n \n@@ -289,7 +294,7 @@ function get_ID()\n \t */\n \tfunction get_ID_field_name()\n \t{\n-\t\treturn $this->is_temp ? 'tmp_ID' : $this->ID_field_name;\n+\t\treturn $this->is_temp() ? 'tmp_ID' : $this->ID_field_name;\n \t}\n \n "
        },
        {
          "filename": "inc/links/model/_temporaryid.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -23,6 +23,7 @@\n class TemporaryID extends DataObject\n {\n \tvar $type;\n+\tvar $coll_ID;\n \n \t/**\n \t * Constructor\n@@ -38,6 +39,7 @@ function __construct( $db_row = NULL )\n \t\t{\n \t\t\t$this->ID = $db_row->tmp_ID;\n \t\t\t$this->type = $db_row->tmp_type;\n+\t\t\t$this->coll_ID = $db_row->tmp_coll_ID;\n \t\t}\n \t}\n }"
        },
        {
          "filename": "inc/links/views/_link_list.view.php",
          "status": "modified",
          "additions": 8,
          "deletions": 6,
          "patch": "@@ -24,7 +24,7 @@\n  */\n global $LinkOwner;\n \n-global $AdminUI, $current_User;\n+global $AdminUI, $Skin, $current_User;\n \n if( empty( $Blog ) )\n {\n@@ -111,7 +111,7 @@ function display_subtype( $link_ID )\n }\n \n // Add attr \"id\" to handle quick uploader\n-$compact_results_params = $AdminUI->get_template( 'compact_results' );\n+$compact_results_params = is_admin_page() ? $AdminUI->get_template( 'compact_results' ) : $Skin->get_template( 'compact_results' );\n $compact_results_params['body_start'] = str_replace( '<tbody', '<tbody id=\"filelist_tbody\"', $compact_results_params['body_start'] );\n $compact_results_params['no_results_start'] = str_replace( '<tbody', '<tbody id=\"filelist_tbody\"', $compact_results_params['no_results_start'] );\n \n@@ -136,11 +136,13 @@ function display_subtype( $link_ID )\n // Load FileRoot class to get fileroot ID of collection below:\n load_class( '/files/model/_fileroot.class.php', 'FileRoot' );\n \n-switch( $LinkOwner->type )\n+$link_owner_type = ( $LinkOwner->type == 'temporary' ) ? $LinkOwner->link_Object->type : $LinkOwner->type;\n+\n+switch( $link_owner_type )\n {\n \tcase 'item':\n-\t\t$upload_fileroot = FileRoot::gen_ID( 'collection', $Blog->ID );\n-\t\t$upload_path = '/quick-uploads/p'.$LinkOwner->get_ID().'/';\n+\t\t$upload_fileroot = FileRoot::gen_ID( 'collection', ( $LinkOwner->is_temp() ? $LinkOwner->link_Object->tmp_coll_ID : $Blog->ID ) );\n+\t\t$upload_path = '/quick-uploads/'.( $LinkOwner->is_temp() ? 'tmp' : 'p' ).$LinkOwner->get_ID().'/';\n \t\tbreak;\n \n \tcase 'comment':\n@@ -155,7 +157,7 @@ function display_subtype( $link_ID )\n \n \tcase 'message':\n \t\t$upload_fileroot = FileRoot::gen_ID( 'user', $current_User->ID );\n-\t\t$upload_path = '/private_message/'.( $LinkOwner->is_temp ? 'tmp' : 'pm' ).$LinkOwner->get_ID().'/';\n+\t\t$upload_path = '/private_message/'.( $LinkOwner->is_temp() ? 'tmp' : 'pm' ).$LinkOwner->get_ID().'/';\n \t\tbreak;\n }\n "
        },
        {
          "filename": "inc/messaging/messages.ctrl.php",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -80,6 +80,10 @@\n \t\t$action = 'nil';\n \t}\n }\n+else\n+{\t// Create new Message:\n+\t$edited_Message = new Message();\n+}\n \n if( ! $Messages->has_errors() && ( empty( $thrd_ID ) || empty( $edited_Thread ) ) )\n { // Display this error only when no error above"
        },
        {
          "filename": "inc/messaging/model/_message.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -228,7 +228,7 @@ function link_from_Request()\n \t\t}\n \n \t\t// Load all links:\n-\t\t$LinkOwner = new LinkMessage( NULL, $TemporaryID->ID );\n+\t\t$LinkOwner = new LinkMessage( new Message(), $TemporaryID->ID );\n \t\t$LinkOwner->load_Links();\n \n \t\tif( empty( $LinkOwner->Links ) )"
        },
        {
          "filename": "inc/messaging/views/_message_list.view.php",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -334,12 +334,13 @@ function filter_messages( & $Form )\n \t\t\t}\n \n \t\t\t// ####################### ATTACHMENTS/LINKS #########################\n-\t\t\tif( is_admin_page() && isset( $GLOBALS['files_Module'] )\n-\t\t\t\t&& $current_User->check_perm( 'files', 'view' ) )\n-\t\t\t{\t// Files module is enabled, but in case of creating new posts we should show file attachments block only if user has all required permissions to attach files:\n+\t\t\tif( is_admin_page() && $current_User->check_perm( 'files', 'view' ) )\n+\t\t\t{\t// If current user has a permission to view the files AND it is back-office:\n \t\t\t\tload_class( 'links/model/_linkmessage.class.php', 'LinkMessage' );\n-\t\t\t\tglobal $LinkOwner; // Initialize this object as global because this is used in many link functions\n+\t\t\t\t// Initialize this object as global because this is used in many link functions:\n+\t\t\t\tglobal $LinkOwner;\n \t\t\t\t$LinkOwner = new LinkMessage( $edited_Message, param( 'temp_link_owner_ID', 'integer', 0 ) );\n+\t\t\t\t// Display attachments fieldset:\n \t\t\t\tdisplay_attachments_fieldset( $Form, $LinkOwner );\n \t\t\t}\n "
        },
        {
          "filename": "inc/messaging/views/_thread.form.php",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -124,12 +124,13 @@\n }\n \n // ####################### ATTACHMENTS/LINKS #########################\n-if( is_admin_page() && isset( $GLOBALS['files_Module'] )\n-\t&& $current_User->check_perm( 'files', 'view' ) )\n-{\t// Files module is enabled, but in case of creating new posts we should show file attachments block only if user has all required permissions to attach files:\n+if( is_admin_page() && $current_User->check_perm( 'files', 'view' ) )\n+{\t// If current user has a permission to view the files AND it is back-office:\n \tload_class( 'links/model/_linkmessage.class.php', 'LinkMessage' );\n-\tglobal $LinkOwner; // Initialize this object as global because this is used in many link functions\n+\t// Initialize this object as global because this is used in many link functions:\n+\tglobal $LinkOwner;\n \t$LinkOwner = new LinkMessage( $edited_Message, param( 'temp_link_owner_ID', 'integer', 0 ) );\n+\t// Display attachments fieldset:\n \tdisplay_attachments_fieldset( $Form, $LinkOwner );\n }\n "
        },
        {
          "filename": "inc/plugins/_plugin.class.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -483,8 +483,12 @@ function get_template( $param_name, $replaces = NULL )\n \t *              (with label, note etc). (optional, default is numeric keys, which are not editable)\n \t *        'max_count': maximum count of sets (optional, default is no restriction)\n \t *        'min_count': minimum count of sets (optional, default is no restriction)\n-\t *      'info': a form info field with label and info text see {@link Form::info()}; you must set 'info' for text.\n-\t *      'color': a form color picker field, use 'defaultvalue' in format '#FFFFFF'\n+\t *\t   'fileselect': opens a modal window to select file. The following can be set for this type:\n+\t *        'root': default root\n+\t *\t\t  'path': default path\n+\t *        'thumbnail_size': thumbnail size\n+\t *     'info': a form info field with label and info text see {@link Form::info()}; you must set 'info' for text.\n+\t *     'color': a form color picker field, use 'defaultvalue' in format '#FFFFFF'\n \t * 'note' (gets displayed as a note to the param field),\n \t * 'info': Text for param with type 'info'\n \t * 'size': Size of the HTML input field (applies to types 'text', 'password' and 'integer'; defaults to 15)"
        },
        {
          "filename": "inc/plugins/_plugin.funcs.php",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -479,6 +479,18 @@ function(r, status) {\n \t\t\t$Form->color_input( $input_name, $set_value, $set_label, '', $params );\n \t\t\tbreak;\n \n+\t\tcase 'fileselect':\n+\t\t\tif( isset( $parmeta['size'] ) )\n+\t\t\t{\n+\t\t\t\t$params['max_file_num'] = $parmeta['size'];\n+\t\t\t}\n+\n+\t\t\t$params['root'] = isset( $parmeta['root'] ) ? $parmeta['root'] : '';\n+\t\t\t$params['path'] = isset( $parmeta['path'] ) ? $parmeta['path'] : '';\n+\t\t\t$params['size_name'] = isset( $parmeta['thumbnail_size'] ) ? $parmeta['thumbnail_size'] : 'crop-64x64';\n+\t\t\t$Form->fileselect( $input_name, $set_value, $set_label, '', $params );\n+\t\t\tbreak;\n+\n \t\tdefault:\n \t\t\tdebug_die( 'Unsupported type ['.$parmeta['type'].'] from GetDefaultSettings()!' );\n \t}"
        },
        {
          "filename": "inc/rest/_restapi.class.php",
          "status": "modified",
          "additions": 28,
          "deletions": 2,
          "patch": "@@ -1859,14 +1859,17 @@ private function controller_link_delete()\n \t\t$this->link_check_perm();\n \n \t\t// Action: 'unlink - just unlink file from the owner, 'delete' - unlink and delete the file from disk and DB completely\n-\t\t$action = param( 'action', 'string', '' );\n+\n+\t\t// Note: param() currently does not work with DELETE and PUT requests\n+\t\tparse_str( file_get_contents('php://input'), $request_params );\n+\t\t$action = isset( $request_params['action'] ) ? $request_params['action'] : '';\n \n \t\t$deleted_Link = & $this->get_Link();\n \t\t$LinkOwner = & $deleted_Link->get_LinkOwner();\n \n \t\tif( $link_File = & $deleted_Link->get_File() )\n \t\t{\n-\t\t\tsyslog_insert( sprintf( 'File %s was unlinked from %s with ID=%s', '[['.$link_File->get_name().']]', $LinkOwner->type, $LinkOwner->link_Object->ID ), 'info', 'file', $link_File->ID );\n+\t\t\tsyslog_insert( sprintf( 'File %s was unlinked from %s with ID=%s', '[['.$link_File->get_name().']]', $LinkOwner->type, $LinkOwner->get_ID() ), 'info', 'file', $link_File->ID );\n \t\t}\n \n \t\tif( $action == 'delete' && $deleted_Link->can_be_file_deleted() )\n@@ -2002,6 +2005,28 @@ private function controller_link_attach()\n \t\t\t// Use the glyph or font-awesome icons if requested by skin\n \t\t\tparam( 'b2evo_icons_type', 'string', 'fontawesome-glyphicons' );\n \n+\t\t\tglobal $LinkOwner, $current_File, $disable_evo_flush;\n+\n+\t\t\t$link_type = param( 'type', 'string' );\n+\t\t\t$link_object_ID = param( 'object_ID', 'string' );\n+\n+\t\t\t$LinkOwner = get_link_owner( $link_type, $link_object_ID );\n+\n+\t\t\t// Initialize admin skin:\n+\t\t\tglobal $current_User, $UserSettings, $is_admin_page, $adminskins_path, $AdminUI;\n+\t\t\t$admin_skin = $UserSettings->get( 'admin_skin', $current_User->ID );\n+\t\t\t$is_admin_page = true;\n+\t\t\trequire_once $adminskins_path.$admin_skin.'/_adminUI.class.php';\n+\t\t\t$AdminUI = new AdminUI();\n+\n+\t\t\t// Disable function evo_flush() to correct handle a content below:\n+\t\t\t$disable_evo_flush = true;\n+\n+\t\t\t// Get the refreshed content:\n+\t\t\tob_start();\n+\t\t\t$AdminUI->disp_view( 'links/views/_link_list.view.php' );\n+\t\t\t$refreshed_content = ob_get_clean();\n+\n \t\t\t$mask_row = (object) array(\n \t\t\t\t\t'link_ID'       => $Link->ID,\n \t\t\t\t\t'file_ID'       => $current_File->ID,\n@@ -2014,6 +2039,7 @@ private function controller_link_attach()\n \t\t\t\t\t'actions'  => link_actions( $Link->ID, 'last', $link_type ),\n \t\t\t\t\t'position' => display_link_position( $mask_row ),\n \t\t\t\t) );\n+\t\t\t$this->add_response( 'list_content', $refreshed_content );\n \t\t}\n \n \t\t// File has been attached successfully:"
        },
        {
          "filename": "inc/skins/model/_skin.class.php",
          "status": "modified",
          "additions": 22,
          "deletions": 1,
          "patch": "@@ -1185,6 +1185,13 @@ function display_init( /*optional: $features = array() */ )\n \t\t\t\t\t{\t// Only if user wants this:\n \t\t\t\t\t\trequire_js( 'bozo_validator.js', 'blog' );\n \t\t\t\t\t}\n+\n+\t\t\t\t\t// Require File Uploader js and css:\n+\t\t\t\t\trequire_js( 'multiupload/fileuploader.js', 'blog' );\n+\t\t\t\t\trequire_css( 'fileuploader.css', 'blog' );\n+\t\t\t\t\t// Load JS files to make the links table sortable:\n+\t\t\t\t\trequire_js( '#jquery#' );\n+\t\t\t\t\trequire_js( 'jquery/jquery.sortable.min.js' );\n \t\t\t\t\tbreak;\n \n \t\t\t\tcase 'disp_edit_comment':\n@@ -1306,8 +1313,9 @@ function get_template( $name )\n \t\t\t\tswitch( $name )\n \t\t\t\t{\n \t\t\t\t\tcase 'Results':\n+\t\t\t\t\tcase 'compact_results':\n \t\t\t\t\t\t// Results list (Used to view the lists of the users, messages, contacts and etc.):\n-\t\t\t\t\t\treturn array(\n+\t\t\t\t\t\t$results_template = array(\n \t\t\t\t\t\t\t'page_url' => '', // All generated links will refer to the current page\n \t\t\t\t\t\t\t'before' => '<div class=\"results panel panel-default\">',\n \t\t\t\t\t\t\t'content_start' => '<div id=\"$prefix$ajax_content\">',\n@@ -1401,6 +1409,18 @@ function get_template( $name )\n \t\t\t\t\t\t\t'after' => '</div>',\n \t\t\t\t\t\t\t'sort_type' => 'basic'\n \t\t\t\t\t\t);\n+\t\t\t\t\t\tif( $name == 'compact_results' )\n+\t\t\t\t\t\t{\t// Use a little different template for compact results table:\n+\t\t\t\t\t\t\t$results_template = array_merge( $results_template, array(\n+\t\t\t\t\t\t\t\t\t'before' => '<div class=\"results\">',\n+\t\t\t\t\t\t\t\t\t'head_title' => '',\n+\t\t\t\t\t\t\t\t\t'no_results_start' => '<div class=\"table_scroll\">'.\"\\n\"\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.'<table class=\"table table-striped table-bordered table-hover table-condensed\" cellspacing=\"0\"><tbody>'.\"\\n\",\n+\t\t\t\t\t\t\t\t\t'no_results_end'   => '<tr class=\"lastline noresults\"><td class=\"firstcol lastcol\">$no_results$</td></tr>'\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.'</tbody></table></div>'.\"\\n\\n\",\n+\t\t\t\t\t\t\t\t) );\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\treturn $results_template;\n \n \t\t\t\t\tcase 'blockspan_form':\n \t\t\t\t\t\t// Form settings for filter area:\n@@ -1646,6 +1666,7 @@ function get_template( $name )\n \t\tswitch( $name )\n \t\t{\n \t\t\tcase 'Results':\n+\t\t\tcase 'compact_results':\n \t\t\t\t// Results list:\n \t\t\t\treturn array(\n \t\t\t\t\t'page_url' => '', // All generated links will refer to the current page"
        },
        {
          "filename": "inc/tools/email.ctrl.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -86,7 +86,8 @@\n \t\t\t\t$Settings->set( 'notification_long_name',  param( 'notification_long_name', 'string', '' ) );\n \n \t\t\t\t// Site logo url\n-\t\t\t\t$Settings->set( 'notification_logo',  param( 'notification_logo', 'string', '' ) );\n+\t\t\t\t//$Settings->set( 'notification_logo',  param( 'notification_logo', 'string', '' ) );\n+\t\t\t\t$Settings->set( 'notification_logo',  param( 'notification_logo', 'integer', NULL ) );\n \t\t\t\tbreak;\n \n \t\t\tcase 'plugins':\n@@ -255,7 +256,7 @@\n \t\t}\n \n \t\tif( ! $Messages->has_errors() )\n-\t\t{  \n+\t\t{\n \t\t\tif( $Settings->dbupdate() )\n \t\t\t{\n \t\t\t\tif( ! empty( $syslog_message ) )"
        },
        {
          "filename": "inc/tools/system.ctrl.php",
          "status": "modified",
          "additions": 50,
          "deletions": 56,
          "patch": "@@ -43,23 +43,25 @@\n // Begin payload block:\n $AdminUI->disp_payload_begin();\n \n-function init_system_check( $name, $value )\n+function init_system_check( $name, $value, $info = '' )\n {\n-\tglobal $syscheck_name, $syscheck_value;\n+\tglobal $syscheck_name, $syscheck_value, $syscheck_info;\n \t$syscheck_name = $name;\n \t$syscheck_value = $value;\n+\t$syscheck_info = $info;\n }\n \n function disp_system_check( $condition, $message = '' )\n {\n-\tglobal $syscheck_name, $syscheck_value;\n+\tglobal $syscheck_name, $syscheck_value, $syscheck_info;\n \techo '<div class=\"system_check\">';\n \techo '<div class=\"system_check_name\">';\n \techo $syscheck_name;\n \techo '</div>';\n \techo '<div class=\"system_check_value_'.$condition.'\">';\n \techo $syscheck_value;\n \techo '&nbsp;</div>';\n+\techo $syscheck_info;\n \tif( !empty( $message ) )\n \t{\n \t\techo '<div class=\"system_check_message_'.$condition.'\">';\n@@ -69,6 +71,30 @@ function disp_system_check( $condition, $message = '' )\n \techo '</div>';\n }\n \n+\n+/**\n+ * Check API url\n+ *\n+ * @param string Title\n+ * @param string Url\n+ */\n+function system_check_api_url( $title, $url )\n+{\n+\t$ajax_response = @file_get_contents( $url );\n+\tif( $ajax_response !== false )\n+\t{\t// Response is correct data:\n+\t\tinit_system_check( $title, 'OK', $url );\n+\t\tdisp_system_check( 'ok' );\n+\t}\n+\telse\n+\t{\t// Response is not correct data:\n+\t\t$last_error = error_get_last();\n+\t\tinit_system_check( $title, T_('Failed'), $url );\n+\t\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' )\n+\t\t\t.( isset( $last_error['message'] ) ? ' <b>'.sprintf( T_( 'Error: %s' ), $last_error['message'] ).'</b>' : '' ) );\n+\t}\n+}\n+\n $facilitate_exploits = '<p>'.T_('When enabled, this feature is known to facilitate hacking exploits in any PHP application.').\"</p>\\n<p>\"\n \t.T_('b2evolution includes additional measures in order not to be affected by this. However, for maximum security, we still recommend disabling this PHP feature.').\"</p>\\n\";\n $change_ini = '<p>'.T_('If possible, change this setting to <code>%s</code> in your php.ini or ask your hosting provider about it.').'</p>';\n@@ -650,87 +676,55 @@ function disp_system_check( $condition, $message = '' )\n $block_item_Widget->disp_template_replaced( 'block_start' );\n \n // REST API:\n-$json_response = @file_get_contents( $baseurl.'api/v6/collections' );\n+$api_title = 'REST API';\n+$api_url = $baseurl.'api/v6/collections';\n+$json_response = @file_get_contents( $api_url );\n json_decode( $json_response );\n if( json_last_error() === JSON_ERROR_NONE )\n {\t// Response is correct json data:\n-\tinit_system_check( 'REST API', 'OK' );\n+\tinit_system_check( $api_title, 'OK', $api_url );\n \tdisp_system_check( 'ok' );\n }\n else\n {\t// Response is not json data:\n-\tinit_system_check( 'REST API', T_('Failed') );\n-\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' ).' '.sprintf( T_('Probably you should update a file %s to the latest version or check permissions to use this file.'), '<code>.htaccess</code>' ) );\n+\t$last_error = error_get_last();\n+\tinit_system_check( $api_title, T_('Failed'), $api_url );\n+\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' )\n+\t\t.' '.sprintf( T_('Probably you should update a file %s to the latest version or check permissions to use this file.'), '<code>.htaccess</code>' )\n+\t\t.( isset( $last_error['message'] ) ? ' <b>'.sprintf( T_( 'Error: %s' ), $last_error['message'] ).'</b>' : '' ) );\n }\n \n // XML-RPC:\n+$api_title = 'XML-RPC';\n+$api_file = 'xmlrpc.php';\n+$api_url = $baseurl.$api_file;\n load_funcs( 'xmlrpc/model/_xmlrpc.funcs.php' );\n-$url_data = parse_url( $baseurl );\n-$client = new xmlrpc_client( 'xmlrpc.php', $url_data['host'], $url_data['port'] );\n+$url_data = parse_url( $api_url );\n+$client = new xmlrpc_client( $api_file, $url_data['host'], ( isset( $url_data['port'] ) ? $url_data['port'] : '' ) );\n $message = new xmlrpcmsg( 'system.listMethods' );\n $result = $client->send( $message );\n if( $result && ! $result->faultCode() )\n {\t// XML-RPC request is successful:\n-\tinit_system_check( 'XML-RPC', 'OK' );\n+\tinit_system_check( $api_title, 'OK', $api_url );\n \tdisp_system_check( 'ok' );\n }\n else\n {\t// Some error on XML-RPC request:\n-\tinit_system_check( 'XML-RPC', T_('Failed') );\n-\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.') );\n+\tinit_system_check( $api_title, T_('Failed'), $api_url );\n+\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.').' <b>'.sprintf( T_( 'Error: %s' ), $result->faultString() ).'</b>' );\n }\n \n // AJAX anon_async.php:\n-$ajax_response = @file_get_contents( $htsrv_url.'anon_async.php?action=test_api' );\n-if( $ajax_response !== false )\n-{\t// Response is correct data:\n-\tinit_system_check( 'AJAX anon_async.php', 'OK' );\n-\tdisp_system_check( 'ok' );\n-}\n-else\n-{\t// Response is not correct data:\n-\tinit_system_check( 'AJAX anon_async.php', T_('Failed') );\n-\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' ) );\n-}\n+system_check_api_url( 'AJAX anon_async.php', $htsrv_url.'anon_async.php?action=test_api' );\n \n // AJAX async.php:\n-$ajax_response = @file_get_contents( $htsrv_url.'async.php?action=test_api' );\n-if( $ajax_response !== false )\n-{\t// Response is correct data:\n-\tinit_system_check( 'AJAX async.php', 'OK' );\n-\tdisp_system_check( 'ok' );\n-}\n-else\n-{\t// Response is not correct data:\n-\tinit_system_check( 'AJAX async.php', T_('Failed') );\n-\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' ) );\n-}\n+system_check_api_url( 'AJAX async.php', $htsrv_url.'async.php?action=test_api' );\n \n // AJAX action.php:\n-$ajax_response = @file_get_contents( $htsrv_url.'action.php?mname=test_api' );\n-if( $ajax_response !== false )\n-{\t// Response is correct data:\n-\tinit_system_check( 'AJAX action.php', 'OK' );\n-\tdisp_system_check( 'ok' );\n-}\n-else\n-{\t// Response is not correct data:\n-\tinit_system_check( 'AJAX action.php', T_('Failed') );\n-\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' ) );\n-}\n+system_check_api_url( 'AJAX action.php', $htsrv_url.'action.php?mname=test_api' );\n \n // AJAX call_plugin.php:\n-$ajax_response = @file_get_contents( $htsrv_url.'call_plugin.php?plugin_ID=-1&method=test_api' );\n-if( $ajax_response !== false )\n-{\t// Response is correct data:\n-\tinit_system_check( 'AJAX call_plugin.php', 'OK' );\n-\tdisp_system_check( 'ok' );\n-}\n-else\n-{\t// Response is not correct data:\n-\tinit_system_check( 'AJAX call_plugin.php', T_('Failed') );\n-\tdisp_system_check( 'warning', T_('This API doesn\\'t work properly on this server.' ) );\n-}\n+system_check_api_url( 'AJAX call_plugin.php', $htsrv_url.'call_plugin.php?plugin_ID=-1&method=test_api' );\n \n $block_item_Widget->disp_template_raw( 'block_end' );\n "
        },
        {
          "filename": "inc/tools/views/_email_settings.form.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -74,7 +74,8 @@\n \t$Form->text_input( 'notification_return_path', $Settings->get( 'notification_return_path' ), 50, T_( 'Return path' ), '', array( 'maxlength' => 127, 'required' => true ) );\n \t$Form->text_input( 'notification_short_name', $Settings->get( 'notification_short_name' ), 50, T_( 'Short site name' ), T_('Shared with site settings'), array( 'maxlength' => 127, 'required' => true ) );\n \t$Form->text_input( 'notification_long_name', $Settings->get( 'notification_long_name' ), 50, T_( 'Long site name' ), T_('Shared with site settings'), array( 'maxlength' => 255 ) );\n-\t$Form->text_input( 'notification_logo', $Settings->get( 'notification_logo' ), 50, T_( 'Site logo (URL)' ), T_('Shared with site settings'), array( 'maxlength' => 5000 ) );\n+\t$fileselect_params = array( 'file_type' => 'image', 'max_file_num' => 1, 'window_title' => T_('Select site logo'), 'root' => 'shared_0' );\n+\t$Form->fileselect( 'notification_logo', $Settings->get( 'notification_logo' ), T_('Select site logo'), NULL, $fileselect_params );\n $Form->end_fieldset();\n \n if( $current_User->check_perm( 'emails', 'edit' ) )"
        },
        {
          "filename": "inc/users/model/_group.class.php",
          "status": "modified",
          "additions": 0,
          "deletions": 8,
          "patch": "@@ -388,14 +388,6 @@ function check_perm( $permname, $permlevel = 'any', $perm_target = NULL )\n \t\t\t\t}\n \t\t\t\tbreak;\n \n-\t\t\tcase 'perm_files':\n-\t\t\t\tif( ! $this->check_perm( 'admin', 'restricted' ) )\n-\t\t\t\t{\n-\t\t\t\t\t$perm = false;\n-\t\t\t\t\tbreak;\n-\t\t\t\t}\n-\t\t\t\t// no break, perm_files is pluggable permission\n-\n \t\t\tdefault:\n \n \t\t\t\t// Check pluggable permissions using group permission check function"
        },
        {
          "filename": "inc/users/model/_user.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1231,6 +1231,7 @@ function load_from_Request()\n \t\t\t\t\t$UserSettings->set( 'notify_post_moderation', param( 'edited_user_notify_post_moderation', 'integer', 0 ), $this->ID );\n \t\t\t\t\t$UserSettings->set( 'notify_edit_pst_moderation', param( 'edited_user_notify_edit_pst_moderation', 'integer', 0 ), $this->ID );\n \t\t\t\t\t$UserSettings->set( 'send_pst_moderation_reminder', param( 'edited_user_send_pst_moderation_reminder', 'integer', 0 ), $this->ID );\n+\t\t\t\t\t$UserSettings->set( 'send_pst_stale_alert', param( 'edited_user_send_pst_stale_alert', 'integer', 0 ), $this->ID );\n \t\t\t\t}\n \t\t\t\tif( $this->grp_ID == 1 )\n \t\t\t\t{"
        },
        {
          "filename": "inc/users/model/_usersettings.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -90,6 +90,7 @@ class UserSettings extends AbstractSettings\n \t\t// admin user notifications\n \t\t'send_cmt_moderation_reminder' => 1, // Send reminders about comments awaiting moderation\n \t\t'send_pst_moderation_reminder' => 1, // Send reminders about posts awaiting moderation\n+\t\t'send_pst_stale_alert' => 1, // Send alert about stale posts\n \t\t'notify_new_user_registration' => 1, // Notify admin user when a new user has registered\n \t\t'notify_activated_account' => 1, // Notify admin user when an account has been activated by email\n \t\t'notify_closed_account' => 1, // Notify admin user when an account has been closed by the account owner"
        },
        {
          "filename": "inc/users/views/_user_admin.form.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -424,7 +424,7 @@\n \t\t}\n \t}\n \t$Form->begin_line( T_('From Domain'), NULL, ( $display_user_domain && $perm_stat_edit ? '' : 'info' ) );\n-\t\t$Form->info_field( '', $user_domain_formatted.' '.action_icon( NULL, 'magnifier', '', NULL, NULL, NULL, array( 'onclick' => 'return get_whois_info(\\''.int2ip( $UserSettings->get( 'created_fromIPv4', $edited_User->ID ) ).'\\');' ), array( 'alt' => 'View Whois info' ) ) );\n+\t\t$Form->info_field( '', $user_domain_formatted.' <button class=\"btn btn-default\" onclick=\"return get_whois_info(\\''.int2ip( $UserSettings->get( 'created_fromIPv4', $edited_User->ID ) ).'\\');\">'.get_icon( 'magnifier' ).'</button>' );\n \t\tif( $display_user_domain )\n \t\t{\t// Display status of Domain if current user has a permission:\n \t\t\t$domain_status = $Domain ? $Domain->get( 'status' ) : 'unknown';\n@@ -683,7 +683,11 @@ function get_whois_info( ip_address )\n \t\t},\n \t\tsuccess: function( result )\n \t\t{\n-\t\t\topenModalWindow( result, '90%', modal_height + 'px', true, 'WHOIS - ' + ip_address, true );\n+\t\t\tif( ajax_response_is_correct( result ) )\n+\t\t\t{\n+\t\t\t\tresult = ajax_debug_clear( result );\n+\t\t\t\topenModalWindow( result, '90%', modal_height + 'px', true, 'WHOIS - ' + ip_address, true );\n+\t\t\t}\n \t\t}\n \t} );\n "
        },
        {
          "filename": "inc/users/views/_user_subscriptions.form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -414,6 +414,7 @@\n \t\t$notify_options[] = array( 'edited_user_notify_post_moderation', 1, T_('a post is created and I have permissions to moderate it.'), $UserSettings->get( 'notify_post_moderation', $edited_User->ID ), $disabled );\n \t\t$notify_options[] = array( 'edited_user_notify_edit_pst_moderation', 1, T_('a post is modified and I have permissions to moderate it.'), $UserSettings->get( 'notify_edit_pst_moderation', $edited_User->ID ), $disabled );\n \t\t$notify_options[] = array( 'edited_user_send_pst_moderation_reminder', 1, sprintf( T_('posts are awaiting moderation for more than %s.'), seconds_to_period( $post_moderation_reminder_threshold ) ), $UserSettings->get( 'send_pst_moderation_reminder', $edited_User->ID ), $disabled );\n+\t\t$notify_options[] = array( 'edited_user_send_pst_stale_alert', 1, T_('there are stale posts and I have permission to moderate them.'), $UserSettings->get( 'send_pst_stale_alert', $edited_User->ID ), $disabled );\n \t}\n \tif( $current_User->check_perm( 'users', 'edit' ) )\n \t{ // current User is an administrator"
        },
        {
          "filename": "inc/widgets/widgets/_coll_item_list.widget.php",
          "status": "modified",
          "additions": 67,
          "deletions": 43,
          "patch": "@@ -218,8 +218,9 @@ function get_param_definitions( $params )\n \t\t\t\t\t'type' => 'radio',\n \t\t\t\t\t'options' => array(\n \t\t\t\t\t\t\tarray( 'none', T_('None') ),\n-\t\t\t\t\t\t\tarray( 'first', T_('Display first picture') ),\n-\t\t\t\t\t\t\tarray( 'all', T_('Display all pictures') ) ),\n+\t\t\t\t\t\t\tarray( 'category', T_('Display main category picture' ) ),\n+\t\t\t\t\t\t\tarray( 'first', T_('Display first post picture') ),\n+\t\t\t\t\t\t\tarray( 'all', T_('Display all post pictures') ) ),\n \t\t\t\t\t'defaultvalue' => 'none',\n \t\t\t\t),\n \t\t\t\t'disp_first_image' => array(\n@@ -799,9 +800,10 @@ function disp_contents( & $disp_Item, $chapter_mode = false, & $item_index )\n \t\t}\n \n \t\tif( $this->disp_params['attached_pics'] == 'all' ||\n-\t\t   ( $this->disp_params['attached_pics'] == 'first' && $this->disp_params['disp_first_image'] == 'normal' ) )\n+\t\t   ( $this->disp_params['attached_pics'] == 'first' && $this->disp_params['disp_first_image'] == 'normal' ) ||\n+\t\t\t ( $this->disp_params['attached_pics'] == 'category' && $this->disp_params['disp_first_image'] == 'normal' ) )\n \t\t{ // Display attached pictures\n-\t\t\tif( $this->disp_params['attached_pics'] == 'first' )\n+\t\t\tif( $this->disp_params['attached_pics'] == 'first' || $this->disp_params['attached_pics'] == 'category' )\n \t\t\t{\t// Display only one first image:\n \t\t\t\t$picture_limit = 1;\n \t\t\t}\n@@ -865,61 +867,83 @@ function disp_images( $params = array(), & $content_is_displayed )\n \t\t\t);\n \n \t\t$disp_Item = & $params['Item'];\n+\t\tswitch( $this->disp_params[ 'item_pic_link_type' ] )\n+\t\t{\t// Set url for picture link\n+\t\t\tcase 'none':\n+\t\t\t\t$pic_url = NULL;\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'permalink':\n+\t\t\t\t$pic_url = $disp_Item->get_permanent_url();\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'linkto_url':\n+\t\t\t\t$pic_url = $disp_Item->url;\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'auto':\n+\t\t\tdefault:\n+\t\t\t\t$pic_url = ( empty( $disp_Item->url ) ? $disp_Item->get_permanent_url() : $disp_Item->url );\n+\t\t\t\tbreak;\n+\t\t}\n \n-\t\t// Get list of ALL attached files:\n-\t\t$LinkOwner = new LinkItem( $disp_Item );\n+\t\tif( $this->disp_params['attached_pics'] != 'category' )\n+\t\t{\n+\t\t\t// Get list of ALL attached files:\n+\t\t\t$LinkOwner = new LinkItem( $disp_Item );\n \n-\t\t$images = '';\n+\t\t\t$images = '';\n \n-\t\tif( $LinkList = $LinkOwner->get_attachment_LinkList( $params['limit'], $params['restrict_to_image_position'], 'image', $links_params ) )\n-\t\t{\t// Get list of attached files\n-\t\t\t$image_num = 1;\n-\t\t\twhile( $Link = & $LinkList->get_next() )\n-\t\t\t{\n-\t\t\t\tif( ( $File = & $Link->get_File() ) && $File->is_image() )\n-\t\t\t\t{\t// Get only images\n-\t\t\t\t\tif( $image_num < $params['start'] )\n-\t\t\t\t\t{ // Skip these first images\n-\t\t\t\t\t\t$image_num++;\n-\t\t\t\t\t\tcontinue;\n-\t\t\t\t\t}\n-\t\t\t\t\tswitch( $this->disp_params[ 'item_pic_link_type' ] )\n-\t\t\t\t\t{\t// Set url for picture link\n-\t\t\t\t\t\tcase 'none':\n-\t\t\t\t\t\t\t$pic_url = NULL;\n-\t\t\t\t\t\t\tbreak;\n-\n-\t\t\t\t\t\tcase 'permalink':\n-\t\t\t\t\t\t\t$pic_url = $disp_Item->get_permanent_url();\n-\t\t\t\t\t\t\tbreak;\n-\n-\t\t\t\t\t\tcase 'linkto_url':\n-\t\t\t\t\t\t\t$pic_url = $disp_Item->url;\n-\t\t\t\t\t\t\tbreak;\n-\n-\t\t\t\t\t\tcase 'auto':\n-\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t$pic_url = ( empty( $disp_Item->url ) ? $disp_Item->get_permanent_url() : $disp_Item->url );\n-\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t}\n+\t\t\tif( $LinkList = $LinkOwner->get_attachment_LinkList( $params['limit'], $params['restrict_to_image_position'], 'image', $links_params ) )\n+\t\t\t{\t// Get list of attached files\n+\t\t\t\t$image_num = 1;\n+\t\t\t\twhile( $Link = & $LinkList->get_next() )\n+\t\t\t\t{\n+\t\t\t\t\tif( ( $File = & $Link->get_File() ) && $File->is_image() )\n+\t\t\t\t\t{\t// Get only images\n+\t\t\t\t\t\tif( $image_num < $params['start'] )\n+\t\t\t\t\t\t{ // Skip these first images\n+\t\t\t\t\t\t\t$image_num++;\n+\t\t\t\t\t\t\tcontinue;\n+\t\t\t\t\t\t}\n \n-\t\t\t\t\t// Print attached picture\n-\t\t\t\t\t$images .= $File->get_tag( '', '', '', '', $this->disp_params['thumb_size'], $pic_url );\n+\t\t\t\t\t\t// Print attached picture\n+\t\t\t\t\t\t$images .= $File->get_tag( '', '', '', '', $this->disp_params['thumb_size'], $pic_url );\n \n-\t\t\t\t\t$content_is_displayed = true;\n+\t\t\t\t\t\t$content_is_displayed = true;\n \n-\t\t\t\t\t$image_num++;\n+\t\t\t\t\t\t$image_num++;\n+\t\t\t\t\t}\n \t\t\t\t}\n \t\t\t}\n \t\t}\n \n+\t\t$display_placeholder = true;\n \t\tif( ! empty( $images ) )\n \t\t{ // Print out images only when at least one exists\n \t\t\techo $params['before'];\n \t\t\techo $images;\n \t\t\techo $params['after'];\n+\t\t\t$display_placeholder = false;\n \t\t}\n-\t\telse\n+\t\telseif( $params['limit'] == 1 )\n+\t\t{ // First picture is empty, fallback to category picture\n+\t\t\t$main_Chapter = $disp_Item->get_main_Chapter();\n+\t\t\t$file_ID = $main_Chapter->get( 'image_file_ID' );\n+\t\t\tif( $file_ID )\n+\t\t\t{\n+\t\t\t\t$FileCache = & get_FileCache();\n+\t\t\t\tif( ( $File = $FileCache->get_by_ID( $main_Chapter->get( 'image_file_ID' ) ) ) && $File->is_image() )\n+\t\t\t\t{\n+\t\t\t\t\techo $params['before'];\n+\t\t\t\t\techo $File->get_tag( '', '', '', '', $this->disp_params['thumb_size'], $pic_url );\n+\t\t\t\t\techo $params['after'];\n+\t\t\t\t\t$display_placeholder = false;\n+\t\t\t\t}\n+\t\t\t}\n+\t\t}\n+\n+\t\tif( $display_placeholder )\n \t\t{\t// Display placeholder if no images:\n \t\t\t// Replace mask $item_permaurl$ with the item permanent URL:\n \t\t\techo str_replace( '$item_permaurl$', $disp_Item->get_permanent_url(), $params['placeholder'] );"
        },
        {
          "filename": "inc/widgets/widgets/_coll_logo.widget.php",
          "status": "modified",
          "additions": 55,
          "deletions": 11,
          "patch": "@@ -91,8 +91,14 @@ function get_desc()\n \tfunction get_param_definitions( $params )\n \t{\n \t\t$r = array_merge( array(\n+\t\t\t\t'logo_file_ID' => array(\n+\t\t\t\t\t'label' => T_('Image'),\n+\t\t\t\t\t'defaultvalue' => '',\n+\t\t\t\t\t'type' => 'fileselect',\n+\t\t\t\t\t'thumbnail_size' => 'fit-320x320',\n+\t\t\t\t),\n \t\t\t\t'image_source' => array(\n-\t\t\t\t\t'label' => T_('Image source'),\n+\t\t\t\t\t'label' => T_('Fallback image source'),\n \t\t\t\t\t'note' => '',\n \t\t\t\t\t'type' => 'radio',\n \t\t\t\t\t'options' => array(\n@@ -102,8 +108,8 @@ function get_param_definitions( $params )\n \t\t\t\t\t'defaultvalue' => 'coll',\n \t\t\t\t),\n \t\t\t\t'logo_file' => array(\n-\t\t\t\t\t'label' => T_('Image filename'),\n-\t\t\t\t\t'note' => T_('Relative to the root of the selected source.'),\n+\t\t\t\t\t'label' => T_('Fallback image filename'),\n+\t\t\t\t\t'note' => T_('If no file was selected. Relative to the root of the selected source.'),\n \t\t\t\t\t'defaultvalue' => 'logo.png',\n \t\t\t\t\t'valid_pattern' => array( 'pattern'=>'~^[a-z0-9_\\-/][a-z0-9_.\\-/]*$~i',\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'error'=>T_('Invalid filename.') ),\n@@ -199,8 +205,16 @@ function display( $params )\n \n \t\t// Get a widget setting to know how we should check a file:\n \t\t$check_file = $this->disp_params['check_file'];\n+\t\t$file_ID = $this->disp_params['logo_file_ID'];\n+\t\t$FileCache = & get_FileCache();\n+\t\t$File = false;\n+\n+\t\tif( ! empty( $file_ID ) )\n+\t\t{\n+\t\t\t$File = & $FileCache->get_by_ID( $file_ID, false );\n+\t\t}\n \n-\t\tif( ( $check_file == 'check' || $check_file === '1' ) && ! file_exists( $image_path.$this->disp_params['logo_file'] ) )\n+\t\tif( ( $check_file == 'check' || $check_file === '1' ) && ! $File && ! file_exists( $image_path.$this->disp_params['logo_file'] ) )\n \t\t{ // Logo file doesn't exist, Exit here because widget setting requires this:\n \t\t\treturn true;\n \t\t}\n@@ -212,18 +226,25 @@ function display( $params )\n \n \t\t$title = '<a href=\"'.$Blog->get( 'url' ).'\">';\n \n-\t\tif( $check_file == 'title' && ! file_exists( $image_path.$this->disp_params['logo_file'] ) )\n-\t\t{ // Logo file doesn't exist, Display a collection title because widget setting requires this:\n-\t\t\t$title .= $Blog->get( 'name' );\n+\t\t// Initialize the image tag for logo:\n+\t\t$image_attrs = '';\n+\t\tif( ! empty( $this->disp_params['width'] ) )\n+\t\t{ // Image width\n+\t\t\t$image_attrs .= ' width=\"'.intval( $this->disp_params['width'] ).'\"';\n+\t\t}\n+\t\tif( ! empty( $this->disp_params['height'] ) )\n+\t\t{ // Image height\n+\t\t\t$image_attrs .= ' height=\"'.intval( $this->disp_params['height'] ).'\"';\n \t\t}\n-\t\telse\n-\t\t{\t// Initialize the image tag for logo:\n \n+\t\tif( ! empty( $File ) )\n+\t\t{\n \t\t\t// Initialize image attributes:\n \t\t\t$image_attrs = array(\n-\t\t\t\t\t'src'   => $image_url.$this->disp_params['logo_file'],\n-\t\t\t\t\t'alt'   => empty( $this->disp_params['alt'] ) ? $Blog->dget( 'name', 'htmlattr' ) : $this->disp_params['alt'],\n+\t\t\t\t\t'src' => $File->get_url(),\n+\t\t\t\t\t'alt' => empty( $this->disp_params['alt'] ) ? $Blog->dget( 'name', 'htmlattr' ) : $this->disp_params['alt']\n \t\t\t\t);\n+\n \t\t\t// Image width:\n \t\t\t$image_attrs['style'] = 'width:'.( empty( $this->disp_params['width'] ) ? 'auto' : format_to_output( $this->disp_params['width'], 'htmlattr' ) ).';';\n \t\t\t// Image height:\n@@ -233,6 +254,29 @@ function display( $params )\n \n \t\t\t$title .= '<img'.get_field_attribs_as_string( $image_attrs ).' />';\n \t\t}\n+\t\telse\n+\t\t{\n+\t\t\tif( $check_file == 'title' && ! file_exists( $image_path.$this->disp_params['logo_file'] ) )\n+\t\t\t{ // Logo file doesn't exist, Display a collection title because widget setting requires this:\n+\t\t\t\t$title .= $Blog->get( 'name' );\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\t// Initialize image attributes:\n+\t\t\t\t$image_attrs = array(\n+\t\t\t\t\t\t'src'   => $image_url.$this->disp_params['logo_file'],\n+\t\t\t\t\t\t'alt'   => empty( $this->disp_params['alt'] ) ? $Blog->dget( 'name', 'htmlattr' ) : $this->disp_params['alt'],\n+\t\t\t\t\t);\n+\t\t\t\t// Image width:\n+\t\t\t\t$image_attrs['style'] = 'width:'.( empty( $this->disp_params['width'] ) ? 'auto' : format_to_output( $this->disp_params['width'], 'htmlattr' ) ).';';\n+\t\t\t\t// Image height:\n+\t\t\t\t$image_attrs['style'] .= 'height:'.( empty( $this->disp_params['height'] ) ? 'auto' : format_to_output( $this->disp_params['height'], 'htmlattr' ) ).';';\n+\t\t\t\t// If no unit is specified in a size, consider the unit to be px:\n+\t\t\t\t$image_attrs['style'] = preg_replace( '/(\\d+);/', '$1px;', $image_attrs['style'] );\n+\n+\t\t\t\t$title .= '<img'.get_field_attribs_as_string( $image_attrs ).' />';\n+\t\t\t}\n+\t\t}\n \n \t\t$title .= '</a>';\n "
        },
        {
          "filename": "inc/widgets/widgets/_image.widget.php",
          "status": "modified",
          "additions": 30,
          "deletions": 7,
          "patch": "@@ -91,8 +91,14 @@ function get_desc()\n \tfunction get_param_definitions( $params )\n \t{\n \t\t$r = array_merge( array(\n+\t\t\t\t'image_file_ID' => array(\n+\t\t\t\t\t'label' => T_('Image'),\n+\t\t\t\t\t'defaultvalue' => '',\n+\t\t\t\t\t'type' => 'fileselect',\n+\t\t\t\t\t'thumbnail_size' => 'fit-320x320',\n+\t\t\t\t),\n \t\t\t\t'image_source' => array(\n-\t\t\t\t\t'label' => T_('Image source'),\n+\t\t\t\t\t'label' => T_('Fallback image source'),\n \t\t\t\t\t'note' => '',\n \t\t\t\t\t'type' => 'radio',\n \t\t\t\t\t'options' => array(\n@@ -102,12 +108,11 @@ function get_param_definitions( $params )\n \t\t\t\t\t'defaultvalue' => 'skin',\n \t\t\t\t),\n \t\t\t\t'image_file' => array(\n-\t\t\t\t\t'label' => T_('Image filename'),\n-\t\t\t\t\t'note' => T_('Relative to the root of the selected source.'),\n+\t\t\t\t\t'label' => T_('Fallback image filename'),\n+\t\t\t\t\t'note' => T_('If no file was selected. Relative to the root of the selected source.'),\n \t\t\t\t\t'defaultvalue' => 'logo.png',\n \t\t\t\t\t'valid_pattern' => array( 'pattern'=>'~^[a-z0-9_\\-/][a-z0-9_.\\-/]*$~i',\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'error'=>T_('Invalid filename.') ),\n-\t\t\t\t\t'size' => 128,\n \t\t\t\t),\n \t\t\t\t'size_begin_line' => array(\n \t\t\t\t\t'type' => 'begin_line',\n@@ -171,6 +176,15 @@ function display( $params )\n \t{\n \t\tglobal $Collection, $Blog;\n \n+\t\t$file_ID = $this->disp_params['image_file_ID'];\n+\t\t$FileCache = & get_FileCache();\n+\t\t$File = false;\n+\n+\t\tif( ! empty( $file_ID ) )\n+\t\t{\n+\t\t\t$File = & $FileCache->get_by_ID( $file_ID, false );\n+\t\t}\n+\n \t\tswitch( $this->disp_params['image_source'] )\n \t\t{\n \t\t\tcase 'skin':\n@@ -202,12 +216,21 @@ function display( $params )\n \n \t\techo $this->disp_params['block_start'];\n \n-\t\t// Initialize image attributes:\n-\t\t$image_attrs = array(\n+\t\tif( ! empty( $File ) )\n+\t\t{\n+\t\t\t$image_attrs = array(\n+\t\t\t\t'src'   => $File->get_url(),\n+\t\t\t\t'alt'   => $this->disp_params['alt'],\n+\t\t\t);\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\t$image_attrs = array(\n \t\t\t\t'src'   => $image_url.$this->disp_params['image_file'],\n \t\t\t\t'alt'   => $this->disp_params['alt'],\n \t\t\t);\n-\t\t// Image width:\n+\t\t}\n+\t\t// Initialize image attributes:\n \t\t$image_attrs['style'] = 'width:'.( empty( $this->disp_params['width'] ) ? 'auto' : format_to_output( $this->disp_params['width'], 'htmlattr' ) ).';';\n \t\t// Image height:\n \t\t$image_attrs['style'] .= 'height:'.( empty( $this->disp_params['height'] ) ? 'auto' : format_to_output( $this->disp_params['height'], 'htmlattr' ) ).';';"
        },
        {
          "filename": "install/_functions_create.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -1211,6 +1211,7 @@ function create_default_jobs( $is_upgrade = false )\n \t$comment_reminder_key     = 'send-unmoderated-comments-reminders';\n \t$messages_reminder_key    = 'send-unread-messages-reminders';\n \t$post_reminder_key        = 'send-unmoderated-posts-reminders';\n+\t$alert_old_contents_key   = 'monthly-alert-old-contents';\n \n \t// init insert values\n \t$insert_values = array(\n@@ -1228,6 +1229,7 @@ function create_default_jobs( $is_upgrade = false )\n \t\t\t$light_db_maintenance_key => \"( \".$DB->quote( form_date( $date, '06:00:00' ) ).\", 86400, \".$DB->quote( $light_db_maintenance_key ).\", \".$ctsk_params.\" )\",\n \t\t\t$heavy_db_maintenance_key => \"( \".$DB->quote( form_date( $next_sunday, '06:30:00' ) ).\", 604800, \".$DB->quote( $heavy_db_maintenance_key ).\", \".$ctsk_params.\" )\",\n \t\t\t$post_reminder_key        => \"( \".$DB->quote( form_date( $date, '07:00:00' ) ).\", 86400, \".$DB->quote( $post_reminder_key ).\", \".$ctsk_params.\" )\",\n+\t\t\t$alert_old_contents_key   => \"( \".$DB->quote( form_date( $next_sunday, '07:30:00' ) ).\", 604800, \".$DB->quote( $alert_old_contents_key ).\", \".$ctsk_params.\" )\",\n \t\t);\n \tif( $is_upgrade )\n \t{ // Check if these jobs already exist, and don't create another"
        },
        {
          "filename": "install/_functions_evoupgrade.php",
          "status": "modified",
          "additions": 15,
          "deletions": 2,
          "patch": "@@ -7795,7 +7795,7 @@ function add_basic_widget_11670( $blog_ID, $container_name, $code, $type, $order\n \t\tupg_task_end();\n \t}\n \n-\tif( upg_task_start( 12070, 'Create table for temporary ID...' ) )\n+\tif( upg_task_start( 12070, 'Create table for temporary IDs...' ) )\n \t{\t// part of 6.8.0-alpha\n \t\tdb_create_table( 'T_temporary_ID', '\n \t\t\ttmp_ID   INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,\n@@ -8089,13 +8089,26 @@ function add_basic_widget_11670( $blog_ID, $container_name, $code, $type, $order\n \t}\n \n \tif( upg_task_start( 12140, 'Updating file types table...' ) )\n-\t{ // part of 6.7.10-stable moved here so it also applies to 6.8.3 -> 6.8.4 upgrades\n+\t{\t// part of 6.7.10-stable moved here so it also applies to 6.8.3 -> 6.8.4 upgrades\n \t\t$DB->query( 'UPDATE T_filetypes\n \t\t\t\tSET ftyp_allowed = \"admin\"\n \t\t\tWHERE ftyp_extensions REGEXP \"[[:<:]]swf[[:>:]]\"' );\n \t\tupg_task_end();\n \t}\n \n+\tif( upg_task_start( 12145, 'Upgrade Temporary IDs table...' ) )\n+\t{\t// part of 6.8.4-stable\n+\t\t$DB->query( 'ALTER TABLE T_temporary_ID\n+\t\t\tADD tmp_coll_ID INT(11) UNSIGNED NULL' );\n+\t\tupg_task_end();\n+\t}\n+\n+\tif( upg_task_start( 12150, 'Upgrade categories table...' ) )\n+\t{\t// part of 6.8.4-alpha\n+\t\tdb_add_col( 'T_categories', 'cat_image_file_ID', 'int(10) unsigned  NULL AFTER cat_blog_ID' );\n+\t\tupg_task_end();\n+\t}\n+\n \t/*\n \t * ADD UPGRADES __ABOVE__ IN A NEW UPGRADE BLOCK.\n \t *"
        },
        {
          "filename": "plugins/_smilies.plugin.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -431,7 +431,7 @@ function ReplaceTagSafe( $text )\n \t */\n \tfunction ReplaceInlinePlaceholderSafe( $text )\n \t{\n-\t\treturn callback_on_non_matching_blocks( $text, '~\\[(image|file|inline|video|audio):\\d+:?[^\\]]*\\]~', array( & $this, 'preg_insert_smilies_callback' ) );\n+\t\treturn callback_on_non_matching_blocks( $text, '~\\[(image|file|inline|video|audio|thumbnail):\\d+:?[^\\]]*\\]~', array( & $this, 'preg_insert_smilies_callback' ) );\n \t}\n \n "
        },
        {
          "filename": "plugins/markdown_plugin/_parsedown.inc.php",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -29,6 +29,7 @@\n \t9. Don't apply <p> around list and already existing paragraph tags\n \t10. Don't convert HTML entities inside <code> html tags because the \"Escape code\" plugin does this\n \t11. Fix the missed empty lines in code blocks which are started and ended with ```\n+\t12. Ignore wrong URLs for links and images; Allow only which begin with http://, https:// or /\n */\n \n class Parsedown\n@@ -100,7 +101,7 @@ function parse($text)\n \n \t\t# Extracts link references.\n \n-\t\tif (preg_match_all('/^[ ]{0,3}\\[(.+)\\][ ]?:[ ]*\\n?[ ]*(.+)$/m', $text, $matches, PREG_SET_ORDER))\n+\t\tif (preg_match_all('/^[ ]{0,3}\\[(.+)\\][ ]?:[ ]*\\n?[ ]*((https?:\\/\\/|\\/).+)$/m', $text, $matches, PREG_SET_ORDER))\n \t\t{\n \t\t\tforeach ($matches as $matches)\n \t\t\t{\n@@ -589,23 +590,23 @@ private function parse_inline_elements($text)\n \t\t\tif( strpos($text, '](') !== FALSE ) # inline\n \t\t\t{\n \t\t\t\t$text = str_replace( '&quot;', '\"', $text ); // revert from html entity\n-\t\t\t\tif( preg_match_all( '/(!?)(\\[((?:[^][]+|(?2))*)\\])\\(([^\"]*?)( \"([^\"]+)\")?\\)/', $text, $matches, PREG_SET_ORDER ) )\n+\t\t\t\tif( preg_match_all( '/(!?)(\\[((?:[^][]+|(?2))*)\\])\\((https?:\\/\\/|\\/)([^\"]*?)( \"([^\"]+)\")?\\)/', $text, $matches, PREG_SET_ORDER ) )\n \t\t\t\t{\n \t\t\t\t\tforeach ($matches as $matches)\n \t\t\t\t\t{\n \t\t\t\t\t\tif ($matches[1]) # image\n \t\t\t\t\t\t{\n \t\t\t\t\t\t\tif( $this->parse_images )\n \t\t\t\t\t\t\t{ // Parse images only if it is enabled\n-\t\t\t\t\t\t\t\t$element = '<img src=\"'.$matches[4].'\" alt=\"'.$matches[3].'\"'.( ! empty( $matches[6] ) ? ' title=\"'.$matches[6].'\"' : '' ).'>';\n+\t\t\t\t\t\t\t\t$element = '<img src=\"'.$matches[4].$matches[5].'\" alt=\"'.$matches[3].'\"'.( ! empty( $matches[7] ) ? ' title=\"'.$matches[7].'\"' : '' ).'>';\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t}\n \t\t\t\t\t\telse\n \t\t\t\t\t\t{\n \t\t\t\t\t\t\tif( $this->parse_links )\n \t\t\t\t\t\t\t{ // Parse links only if it is enabled\n \t\t\t\t\t\t\t\t$element_text = $this->parse_inline_elements($matches[3]);\n-\t\t\t\t\t\t\t\t$element = '<a href=\"'.$matches[4].'\"'.( ! empty( $matches[6] ) ? ' title=\"'.$matches[6].'\"' : '' ).'>'.$element_text.'</a>';\n+\t\t\t\t\t\t\t\t$element = '<a href=\"'.$matches[4].$matches[5].'\"'.( ! empty( $matches[7] ) ? ' title=\"'.$matches[7].'\"' : '' ).'>'.$element_text.'</a>';\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t}\n "
        },
        {
          "filename": "rsc/build/b2evo_base.bmin.css",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "rsc/build/b2evo_base.bundle.css",
          "status": "modified",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -1856,6 +1856,55 @@ textarea.form_textarea_input {\n label.radiooption {\n   margin-right: 1em;\n }\n+.file_select_wrapper {\n+  display: -webkit-box;\n+  display: -webkit-flex;\n+  display: -ms-flexbox;\n+  display: flex;\n+  -webkit-flex-flow: row wrap;\n+      -ms-flex-flow: row wrap;\n+          flex-flow: row wrap;\n+  -webkit-box-align: start;\n+  -webkit-align-items: flex-start;\n+      -ms-flex-align: start;\n+          align-items: flex-start;\n+}\n+.file_select_wrapper .file_select_item {\n+  display: -webkit-box;\n+  display: -webkit-flex;\n+  display: -ms-flexbox;\n+  display: flex;\n+  -webkit-flex-flow: row wrap;\n+      -ms-flex-flow: row wrap;\n+          flex-flow: row wrap;\n+  margin-right: 8px;\n+  text-align: center;\n+}\n+.file_select_wrapper .file_select_item .item_actions {\n+  display: -webkit-box;\n+  display: -webkit-flex;\n+  display: -ms-flexbox;\n+  display: flex;\n+  -webkit-flex-shrink: 1;\n+      -ms-flex-negative: 1;\n+          flex-shrink: 1;\n+  -webkit-flex-flow: column wrap;\n+      -ms-flex-flow: column wrap;\n+          flex-flow: column wrap;\n+  -webkit-box-pack: start;\n+  -webkit-justify-content: flex-start;\n+      -ms-flex-pack: start;\n+          justify-content: flex-start;\n+  -webkit-align-content: center;\n+      -ms-flex-line-pack: center;\n+          align-content: center;\n+  -webkit-box-pack: center;\n+  -webkit-justify-content: center;\n+      -ms-flex-pack: center;\n+          justify-content: center;\n+  text-align: left;\n+  margin-left: 8px;\n+}\n .eform label {\n   font-weight: bold;\n }"
        },
        {
          "filename": "rsc/build/bootstrap-b2evo_base.bmin.css",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "rsc/build/bootstrap-b2evo_base.bundle.css",
          "status": "modified",
          "additions": 86,
          "deletions": 0,
          "patch": "@@ -1475,6 +1475,27 @@ textarea.form_textarea_input {\n label.radiooption {\n   margin-right: 1em;\n }\n+.file_select_wrapper {\n+  display: flex;\n+  flex-flow: row wrap;\n+  align-items: flex-start;\n+}\n+.file_select_wrapper .file_select_item {\n+  display: flex;\n+  flex-flow: row wrap;\n+  margin-right: 8px;\n+  text-align: center;\n+}\n+.file_select_wrapper .file_select_item .item_actions {\n+  display: flex;\n+  flex-shrink: 1;\n+  flex-flow: column wrap;\n+  justify-content: flex-start;\n+  align-content: center;\n+  justify-content: center;\n+  text-align: left;\n+  margin-left: 8px;\n+}\n div.log_container ul,\n div.action_messages ul,\n div.log_container ol,\n@@ -3258,6 +3279,71 @@ input.btn-lg {\n .evo_container__sidebar .evo_poll__title {\n   white-space: normal;\n }\n+#itemform_links .panel-body {\n+  padding: 0;\n+}\n+div.qq-upload-button,\n+div.qq-upload-drop-area,\n+div.qq-upload-drop-area-active {\n+  border: 2px dashed #fff;\n+  background: #5bc0de;\n+  -webkit-border-radius: 9px;\n+  -moz-border-radius: 9px;\n+  -ms-border-radius: 9px;\n+  -o-border-radius: 9px;\n+  border-radius: 9px;\n+}\n+div.qq-upload-button-hover,\n+div.qq-upload-drop-area,\n+div.qq-upload-drop-area-active {\n+  background: #5cb85c;\n+}\n+ul.qq-upload-list {\n+  margin: 0;\n+}\n+div#fileuploader_form {\n+  padding: 5px;\n+  height: 65px;\n+  background: #f5f5f5;\n+}\n+#attachments_fieldset_wrapper {\n+  width: 100%;\n+  height: 160px;\n+  position: relative;\n+  padding-bottom: 6px;\n+  box-sizing: content-box;\n+}\n+#attachments_fieldset_wrapper #attachments_fieldset_block {\n+  overflow: auto;\n+  height: 100%;\n+}\n+#attachments_fieldset_wrapper .ui-resizable-s {\n+  background: #c0c0c0;\n+  height: 6px;\n+  bottom: 0;\n+}\n+#attachments_fieldset_wrapper .ui-resizable-s:after {\n+  content: \"...\";\n+  font-size: 10px;\n+  top: -7px;\n+  position: relative;\n+  text-align: center;\n+  display: block;\n+}\n+#attachments_fieldset_wrapper .table_scroll {\n+  position: relative;\n+}\n+#attachments_fieldset_wrapper table tbody .dragged {\n+  opacity: 0.8;\n+  position: absolute;\n+}\n+#attachments_fieldset_wrapper table tbody td {\n+  cursor: move;\n+}\n+#filelist_tbody tr:first-child .action_icon_link_move_up,\n+#filelist_tbody tr:last-child .action_icon_link_move_down {\n+  visibility: hidden;\n+}\n \n /**\n  * item_base.css "
        },
        {
          "filename": "rsc/build/bootstrap-backoffice-b2evo_base.bmin.css",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-.red{color:red}.orange{color:#f60}.green{color:#0c0}.black{color:#000}.dimmed,.disabled,.gray,.grey{color:#999}.note,.notes{font-size:84%;color:#999;font-weight:400}.left{text-align:left}.center{text-align:center}.right{text-align:right}.line,.nobr,.nowrap{white-space:nowrap}.expanded li{margin-top:1ex;margin-bottom:1ex}a.discreet{text-decoration:none}.deleted,del{color:#999}.inserted,ins{color:#a44}abbr,acronym{border-bottom:1px dotted #666;cursor:help}code,pre{hyphens:none}img{border:none;max-width:100%;height:auto}.top{vertical-align:top}.middle{vertical-align:middle}.bottom,img.icon{vertical-align:bottom}.baseline{vertical-align:baseline}.text-bottom{vertical-align:text-bottom}.image_block.raised img,img.raised{box-shadow:0 0 11px 0 rgba(0,0,0,.3)}.image_block.noshadow img,img.noshadow{box-shadow:none}.image_block.border img,img.border{border:1px solid #666}.image_block.noborder img,img.noborder{border:none}.image_block.squared img,img.squared{border-radius:0}.image_block.rounded img,img.rounded{border-radius:4px}.image_block.round img,img.round{border-radius:50%}.image_block.embossed img,img.embossed{border:5px solid;border-color:rgba(238,238,238,.6) rgba(34,34,34,.6) rgba(51,51,51,.8) rgba(231,231,231,.6)}.floatleft{float:left}.floatright{float:right}.leftmargin{float:left;margin-right:1ex;margin-top:.2ex;margin-bottom:.2ex}.rightmargin{float:right;margin-left:1ex;margin-top:.2ex;margin-bottom:.2ex}.clear{clear:both}.inline-block{display:inline-block}.inline{display:inline}.margin1ex{margin:1ex}.margin2ex{margin:2ex}.indented{padding-left:3em}span.flag{border:1px solid #666;background:url(../icons/flags_sprite.png) no-repeat;width:16px;height:11px;line-height:11px;padding:0!important;font-size:6px;display:inline-block!important;margin-bottom:-2px;box-sizing:content-box}span.icon{background:url(../icons/icons_sprite.png) -112px -48px no-repeat;width:16px;height:16px;line-height:16px;padding:0!important;font-size:9px;display:inline-block;overflow:hidden;vertical-align:middle}span.icon.voted{margin:0 2px}a.rollover_sprite:hover span.icon{visibility:hidden;visibility:visible\\0/}@media screen and (min-width:0\\0){a.rollover_sprite:hover span.icon{visibility:visible}}a.rollover_sprite:hover span.icon:before{visibility:visible!important;background:inherit;float:left;width:32px;height:16px;content:\"\";margin-left:-16px}.vote_spam span.icon.voted{margin:auto}.action_icon:hover{text-decoration:none}.action_icon.hoverlink:hover{text-decoration:underline}button.action_icon{background:0 0;border:none;padding:0;cursor:pointer}span.fa{line-height:inherit;font-size:14px}.btn span.fa{line-height:14px}a.action_icon span.fa{margin-right:2px}span.fa.action_icon.empty_placeholder{margin-right:4px;visibility:hidden}a.roundbutton .fa,a.roundbutton:hover .fa,a.roundbutton_text .fa,a.roundbutton_text:hover .fa{color:#000}a:hover .fa-x-rollover-green{color:#0C0!important}a:hover .fa-x-rollover-red{color:#C00!important}a:hover .fa-x-rollover-red-light{color:red!important}a:hover .fa-x-rollover-orange{color:#F90!important}a:hover .fa-x-rollover-black{color:#000!important}a:hover .fa-x-rollover-grey{color:#7f7f7f!important}a:hover .fa-flag.fa-x--hover{color:red!important}a:hover .fa-flag.fa-x--hover:before{content:\"\\f11d\"}a:hover .fa-flag-o.fa-x--hover{color:red!important}a:hover .fa-flag-o.fa-x--hover:before{content:\"\\f024\"}.fa-x-external-link--nudge:before{position:relative;top:.05em;left:.11em}.fa-x-linkedin--nudge:before{position:relative;top:-.05em;left:.04em}.fa-x-google-plus--nudge:before{position:relative;left:.1em}span.loader_img{display:inline-block;width:32px;height:32px;background:url(../img/ajax-loader/fff.gif) center no-repeat}span.loader_img.loader_user_deldata,span.loader_img.loader_user_report{background-image:url(../img/ajax-loader/777.gif)}.status_color_draft{color:#ff9}.status_color_review{color:#c09}.status_color_community{color:#2e8bb9}.status_color_protected{color:#ff9c2a}.status_color_private{color:#dc143c}.status_color_published{color:#9e4}.status_color_deprecated{color:#000}.status_color_redirected{color:#639}.status_color_trash{color:#f66}.status_color_meta{color:#5bc0de}.btn[class*=btn-status-]{border:1px solid #ccc}.btn-status-draft{color:#000;background-color:#ff9;border-color:#dfdfdf}.btn-status-draft:hover{color:#000;background-color:#f3f392}.btn-status-review{color:#fff;background-color:#c09}.btn-status-review:hover{color:#fff;background-color:#c20092}.btn-status-community{color:#fff;background-color:#2e8bb9}.btn-status-community:hover{color:#fff;background-color:#2c84b0}.btn-status-protected{color:#fff;background-color:#ff9c2a}.btn-status-protected:hover{color:#fff;background-color:#f39528}.btn-status-private{color:#fff;background-color:#dc143c}.btn-status-private:hover{color:#fff;background-color:#d21339}.btn-status-published{color:#000;background-color:#9e4}.btn-status-published .glyphicon{color:inherit!important}.btn-status-published:hover{color:#000;background-color:#92e341}.btn-status-deprecated{color:#fff;background-color:#000}.btn-status-deprecated:hover{color:#fff;background-color:#333}.btn-status-redirected{color:#fff;background-color:#639}.btn-status-redirected:hover{color:#fff;background-color:#613192}.btn-status-trash{color:#fff;background-color:#f66}.btn-status-trash:hover{color:#fff;background-color:#f44}.ufld_yahooim.ufld__hovertextcolor:hover,.ufld_yahooim.ufld__textcolor{color:#7b0099}.ufld_yahooim.ufld__bgcolor,.ufld_yahooim.ufld__hoverbgcolor:hover{background-color:#7b0099}.ufld_skype.ufld__hovertextcolor:hover,.ufld_skype.ufld__textcolor{color:#00aff0}.ufld_skype.ufld__bgcolor,.ufld_skype.ufld__hoverbgcolor:hover{background-color:#00aff0}.ufld_twitter.ufld__hovertextcolor:hover,.ufld_twitter.ufld__textcolor{color:#00aced}.ufld_twitter.ufld__bgcolor,.ufld_twitter.ufld__hoverbgcolor:hover{background-color:#00aced}.ufld_facebook.ufld__hovertextcolor:hover,.ufld_facebook.ufld__textcolor{color:#3b5998}.ufld_facebook.ufld__bgcolor,.ufld_facebook.ufld__hoverbgcolor:hover{background-color:#3b5998}.ufld_googleplus.ufld__hovertextcolor:hover,.ufld_googleplus.ufld__textcolor{color:#dd4b39}.ufld_googleplus.ufld__bgcolor,.ufld_googleplus.ufld__hoverbgcolor:hover{background-color:#dd4b39}.ufld_linkedin.ufld__hovertextcolor:hover,.ufld_linkedin.ufld__textcolor{color:#007bb6}.ufld_linkedin.ufld__bgcolor,.ufld_linkedin.ufld__hoverbgcolor:hover{background-color:#007bb6}.ufld_github.ufld__hovertextcolor:hover,.ufld_github.ufld__textcolor{color:#333}.ufld_github.ufld__bgcolor,.ufld_github.ufld__hoverbgcolor:hover{background-color:#333}.ufld_flickr.ufld__hovertextcolor:hover,.ufld_flickr.ufld__textcolor{color:#ff0084}.ufld_flickr.ufld__bgcolor,.ufld_flickr.ufld__hoverbgcolor:hover{background-color:#ff0084}.ufld_youtube.ufld__hovertextcolor:hover,.ufld_youtube.ufld__textcolor{color:#b00}.ufld_youtube.ufld__bgcolor,.ufld_youtube.ufld__hoverbgcolor:hover{background-color:#b00}.ufld_digg.ufld__hovertextcolor:hover,.ufld_digg.ufld__textcolor{color:#356aa0}.ufld_digg.ufld__bgcolor,.ufld_digg.ufld__hoverbgcolor:hover{background-color:#356aa0}.ufld_stumbleupon.ufld__hovertextcolor:hover,.ufld_stumbleupon.ufld__textcolor{color:#eb4924}.ufld_stumbleupon.ufld__bgcolor,.ufld_stumbleupon.ufld__hoverbgcolor:hover{background-color:#eb4924}.ufld_pinterest.ufld__hovertextcolor:hover,.ufld_pinterest.ufld__textcolor{color:#cb2027}.ufld_pinterest.ufld__bgcolor,.ufld_pinterest.ufld__hoverbgcolor:hover{background-color:#cb2027}.filter_item{display:inline-block;vertical-align:middle;margin:1px}.filter_item div{margin:0;padding:3px 5px;color:#FFF;float:left}.filter_item div:first-child{border-radius:5px 0 0 5px}.filter_item div.icon{border-radius:0 5px 5px 0;float:right;padding:0}.filter_item div.icon a{display:block;padding:4px 5px 5px;margin:0}.filter_item .name{background:#3d8f3d}.filter_item div.group,.filter_item div.icon,.filter_item:hover .name{background:#45a145}.filter_item div.icon:hover{background:#4db34d}.filter_item.yellow .name{background:#caca3f}.filter_item.yellow div.group,.filter_item.yellow div.icon,.filter_item.yellow:hover .name{background:#dbdb57}.filter_item.yellow div.icon:hover{background:#ecec73}.filter_item.orange .name{background:#d18335}.filter_item.orange div.group,.filter_item.orange div.icon,.filter_item.orange:hover .name{background:#e09952}.filter_item.orange div.icon:hover{background:#edac6b}.filter_item.red .name{background:#c12d2d}.filter_item.red div.group,.filter_item.red div.icon,.filter_item.red:hover .name{background:#cb4d4d}.filter_item.red div.icon:hover{background:#e57373}.filter_item.magenta .name{background:#8618bd}.filter_item.magenta div.group,.filter_item.magenta div.icon,.filter_item.magenta:hover .name{background:#93c}.filter_item.magenta div.icon:hover{background:#b053df}.filter_item.blue .name{background:#2f60c0}.filter_item.blue div.group,.filter_item.blue div.icon,.filter_item.blue:hover .name{background:#4d77cb}.filter_item.blue div.icon:hover{background:#6a91df}.filter_item div{height:24px!important;line-height:18px!important}div.filters .filter_item{margin:1px}div.filters .filter_item div{margin:0}.widget_core_coll_category_list label{font-weight:400}.widget_core_coll_category_list ul{margin-left:0}.widget_core_coll_category_list ul ul{margin-left:19px}.widget_core_coll_category_list li{list-style:none}.widget_core_coll_category_list input[type=checkbox],.widget_core_coll_category_list input[type=radio]{margin:0;display:inline-block}.widget_core_coll_category_list .evo_cat_meta{font-weight:700;color:#000;list-style:square;margin-left:20px}.widget_core_coll_category_list .evo_cat_meta a,.widget_core_coll_category_list .evo_cat_meta label{font-weight:700;color:#000}.widget_core_coll_category_list .evo_cat_meta ul{font-weight:400}.widget_core_coll_category_list .evo_cat_meta input[disabled=disabled]{display:none}.widget_core_coll_category_list .tile label{display:inline}.evo_comment__meta{border:2px solid #5bc0de}.evo_comment__meta:last-child{margin-bottom:0}.evo_comment__meta .panel-heading{border-bottom:1px solid #5bc0de;background-color:#d9edf7}.evo_comment__meta .panel-footer{border-top:1px solid #5bc0de;background-color:#d9edf7}.panel-meta{border:2px solid #5bc0de}.panel-meta .panel-heading{border-bottom:1px solid #5bc0de;background-color:#d9edf7}.panel-meta .panel-body{background-color:#d9edf7}.evo_voting_panel>span.fa{margin-right:4px;margin-left:2px}div#evo_toolbar{background-color:#d2d2d2;border-bottom:1px solid #aeaeae;text-align:left;margin:0;font:14px \"Helvetica Neue\",Helvetica,sans-serif,Arial;position:fixed;z-index:11000;left:0;top:0;width:100%;-webkit-text-size-adjust:none}@media only screen and (max-device-width:1024px){div#evo_toolbar{position:relative}div#skin_wrapper.skin_wrapper_loggedin{margin-top:0}}div.skin_wrapper_loggedin{margin-top:26px;padding-top:1px}div#evo_toolbar .actions_left{float:left}div#evo_toolbar .actions_right{float:right}@media (max-width:479px){div#evo_toolbar .actions_right .debug_dev_button{display:none}}.evobar-menu,.evobar-menu *{margin:0;padding:0;list-style:none;box-sizing:content-box;-webkit-font-smoothing:antialiased}.evobar-menu ul{position:absolute;top:-99999em;opacity:0;width:25ex;border:1px solid #aeaeae;box-shadow:2px 2px 4px -1px rgba(0,0,0,.25);-webkit-transition:opacity .2s ease-in-out;-o-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out}.evobar-menu ul li{width:100%}.evobar-menu>li:hover>ul{opacity:1;z-index:99;top:26px}.evobar-menu li{float:left;position:relative}.evobar-menu li:hover li ul{top:-999em}.evobar-menu li ul li:last-child a{border:none}.evobar-menu li li ul{top:-999em;left:25ex}.evobar-menu li li:hover ul{top:0;opacity:1}.evobar-menu li li:hover li ul{top:-999em;opacity:0}.evobar-menu li li li:hover ul{top:0;opacity:1}.evobar-menu li li a,.evobar-menu li li a:hover,.evobar-menu li li a:link,.evobar-menu li li a:visited{display:block;background-color:#d2d2d2;color:#4f4f4f}.evobar-menu li li a:hover{background-color:#bfbfbf}.evobar-menu li.separator{background-color:#d2d2d2}.evobar-menu li.separator hr{border:none;background-color:#4f4f4f;height:1px;margin:10px 4px}.evobar-menu li u{text-decoration:none}.evobar-menu a{display:inline-block;position:relative;background-color:#d2d2d2;-webkit-transition:background-color .15s ease-out;-o-transition:background-color .15s ease-out;transition:background-color .15s ease-out;padding:6px 1ex;text-decoration:none;min-height:14px;line-height:14px;color:#4f4f4f}.evobar-menu a:hover,.evobar-menu a:link,.evobar-menu a:visited{color:#4f4f4f}.evobar-menu a:hover{background-color:#bfbfbf;-webkit-transition:none;-o-transition:none;transition:none;text-decoration:none}.evobar-menu a.disabled,.evobar-menu a.disabled:hover{color:#999}.evobar-menu [class^=evobar-icon-]{margin-left:6px;float:right}@media (max-width:800px){.evobar-menu li u,.evobar-menu li.rwdhide{display:none}}.actions_left .evobar-menu.evobar-menu-left{float:left}.actions_right .evobar-menu>li>ul{right:0}.actions_right .evobar-menu li li ul{left:-25.3ex;z-index:-1}.bubbletip_user ul{padding:0;margin:0}.bubbletip_user ul li{margin:.5ex 0;padding:0;list-style:none;text-align:center}.bubbletip_user__buttons{text-align:center;margin:0;color:#FFF}.bubbletip_user__buttons a.btn{color:#FFF;margin:5px 0 0}.bubbletip_user__buttons a.btn:first-child{margin:0}.bubbletip_anon{text-align:center}.bubbletip_anon div{margin-top:5px}.bubletip_overlay_text{position:relative}.bubletip_overlay_text div{position:absolute;top:0;left:0;width:100%;text-align:center;text-shadow:-1px -1px #000,-2px 0 #000,-1px 1px #000,0 2px #000,1px 1px #000,2px 0 #000,1px -1px #000,0 -2px #000;color:#FFF;font-weight:700}a.overlay_link:hover{text-decoration:none}a.overlay_link:hover b{text-decoration:underline}.user,.user.anonymous{font-weight:700;word-wrap:break-word}.user.closed,.user.deleted{color:#666}.user.man{color:#0080FF}.user.woman{color:#F6F}.user.anonymous.nogender,.user.nogender{color:#000}div.debug{font-family:Arial,Helvetica,sans-serif;font-size:10pt;border:2px solid #000;padding:1ex;background-color:#ccc;text-align:left;color:#000}div.debug h2,div.debug h3,div.debug h4{color:#03F}div.debug code{font-family:Monaco,\"Courier New\",Courier,monospace;font-size:9pt;margin:1ex 1ex 0;display:block}div.debug div.query_info{background-color:#fff;font-size:12px;margin:1ex}div.debug table{border:1px solid #000;border-collapse:collapse;font-family:Monaco,\"Courier New\",Courier,monospace;margin:1ex}div.debug table,div.debug td,div.debug th{font-size:8pt}div.debug th{background-color:#fff;border:1px solid #000;padding:2px;white-space:nowrap}div.debug th span.type{font-weight:400;color:#999}div.debug td{background-color:#ddd;border:1px solid #000;padding:2px;vertical-align:top;white-space:nowrap}div.debug td.odd{background-color:#eee}a.jslog_switcher{cursor:pointer}div#debug_ajax_info{display:none;position:fixed;top:27px;left:0;z-index:100000;min-width:190px;min-height:83px;opacity:.85;filter:alpha(opacity=85)}div#debug_ajax_info.debug{padding:0}div#debug_ajax_info h2{margin-top:0}div#debug_ajax_info h4{margin-bottom:5px}div#debug_ajax_info h4.error{color:red}div#debug_ajax_info p{margin:5px 0 2px;font-weight:700}div#debug_ajax_info #jslog_container{max-height:500px;overflow-y:auto;padding:0 10px;min-height:43px}div#debug_ajax_info .jslog_statusbar,div#debug_ajax_info .jslog_titlebar{padding:1px 3px}div#debug_ajax_info .jslog_titlebar{border-bottom:1px solid #AAA;cursor:move;background:#006;opacity:.85;color:#FFF;font-weight:700}div#debug_ajax_info .jslog_statusbar{border-top:1px solid #AAA;padding-right:10px}div#debug_ajax_info .ui-resizable-e{right:0;z-index:999}div#debug_ajax_info .ui-resizable-s{bottom:0;z-index:999}div#debug_ajax_info .ui-resizable-se{z-index:1000}div.jslog{display:none}ul.jslog_error,ul.jslog_note{background:#DDD;border:1px solid #6287C2;margin:0 auto 1ex;padding:1ex 1ex 1ex 3ex}ul.jslog_error{border:1px solid #d99;background:#fbf2ee;color:#e00}.item_custom_fields{border:none;margin-bottom:10px;border-collapse:collapse}.item_custom_fields td,.item_custom_fields th{padding:0 10px 0 0}.item_custom_fields th{text-align:left}.b2evo_alert{width:270px;position:fixed;right:10px;top:40px;background:#d64141;border:1px solid #FFF;color:#FFF;font-weight:700;padding:5px;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;-khtml-border-radius:3px;z-index:11000}body,html{width:auto!important;overflow-x:hidden!important}div.dev-blocks{border:1px solid red;margin:0;padding:0;border-radius:3px}div.dev-blocks div.dev-blocks{margin:2px}div.dev-blocks-name{font-family:\"Helvetica Neue\",sans-serif;margin:0;font-size:7pt;text-align:left;font-weight:400;border-radius:2px 2px 0;padding:1px 4px}span.dev-blocks-action{float:right}div.dev-blocks--siteinclude{border-color:#f0f}div.dev-blocks--siteinclude>.dev-blocks-name{color:#d0d;background-color:#fdf}div.dev-blocks--include{border-color:#0c0}div.dev-blocks--include>.dev-blocks-name{color:#0d0;background-color:#dfd}div.dev-blocks--container>.dev-blocks-name{color:red;background-color:#fdd}div.dev-blocks--widget{border-color:#00f}div.dev-blocks--widget>.dev-blocks-name{color:#00f;background-color:#eef}div.dev-blocks--widget--incache{border-color:#00f8f8}div.dev-blocks--widget--incache>.dev-blocks-name{color:#0ee;background-color:#e8f8f8}div.dev-blocks--widget--notincache{border-color:#ec0}div.dev-blocks--widget--notincache>.dev-blocks-name{color:#f8bb00;background-color:#fff0e0}div.dev-blocks--belowtoolbar{margin:27px 0 -27px}.results_ajax_loading{position:absolute;top:0;left:0;background:#000;filter:alpha(opacity=50);-moz-opacity:.5;-khtml-opacity:.5;opacity:.5}.results_ajax_loading div{text-align:center;vertical-align:middle;background:url(../img/ajax-loader/333.gif) center center no-repeat;height:32px;margin:auto;position:absolute;top:0;left:0;right:0;bottom:0}.results_unavailable{background:#FFF;border:1px solid #BBB;color:red;text-align:center;padding:2px}a[rel~=nofollow]:not([class~=btn]):hover{background:#f8e0e0;-moz-border-radius:2px;-webkit-border-radius:2px;-khtml-border-radius:2px;border-radius:2px}img.loadimg{min-width:64px;min-height:64px;background:url(../img/ajax-loader/fff.gif) center no-repeat}figure{margin:1em 0}.evo_image_block{text-align:center}.evo_image_block .img-responsive{display:inline-block}.evo_thumbnail{max-width:100%}.evo_thumbnail__left{float:left;margin:0 4px 4px 0}.evo_thumbnail__right{float:right;margin:0 0 4px 4px}.replied_comment .evo_image_block img{max-width:100%;height:auto}.evo_image_legend{font-size:84%;color:#aaa;padding:9px 6px 6px;text-align:center}.image_rounded img{-webkit-border-radius:50%;-moz-border-radius:50%;-ms-border-radius:50%;-o-border-radius:50%;border-radius:50%}img.avatar_before_login{margin-right:2px;vertical-align:top}img.avatar_before_login_middle{margin-right:2px;vertical-align:middle}img.avatar_above_login{display:block;margin:0 auto}.shrinkwrap{width:1%;white-space:nowrap;text-align:center}.shrinkwrap.left{text-align:left}.block{margin:1ex;white-space:nowrap}a.selected{font-weight:700}.avatar_rounded{background:#FFF;border:1px solid #CCC;padding:2px;display:inline-block;-moz-border-radius:4px;-webkit-border-radius:4px;-khtml-border-radius:4px;border-radius:4px;text-align:center;box-sizing:content-box}.avatar_rounded:hover{text-decoration:none}.avatar_rounded img{-moz-border-radius-topleft:2px;-moz-border-radius-topright:2px;-webkit-border-radius:2px 2px 0 0;-khtml-border-radius-topleft:2px;-khtml-border-radius-topright:2px;border-radius:2px 2px 0 0;margin-bottom:2px}div.avatartag{display:inline-block;vertical-align:top;margin:0 .5em .5em 0}div.avatartag a{outline:0}div.avatartag.main{display:block;float:none!important}div.avatartag.main>a{float:left}div.avatartag.main .avatar_actions,div.avatartag.main a:first-child{margin-right:25px}.avatar_actions{float:left;line-height:26px}.avatar_main_frame{background:#FFF;border:1px solid #CCC;padding:2px;-moz-border-radius:4px;-webkit-border-radius:4px;-khtml-border-radius:4px;border-radius:4px;display:table;vertical-align:middle}.avatar_main_frame img{-moz-border-radius-topleft:2px;-moz-border-radius-bottomleft:2px;-webkit-border-radius:2px 0 0 2px;-khtml-border-radius-topleft:2px;-khtml-border-radius-bottomleft:2px;border-radius:2px 0 0 2px}.avatar_main_frame>a:first-child{float:left;margin-right:5px}.duplicated_avatars{text-align:center;max-width:160px}.avatar_main_frame .duplicated_avatars{max-width:320px}.duplicated_avatars a.user img{vertical-align:text-top}div.avatartag.main>img:first-child{float:left;margin-right:25px}@media only screen and (max-width:600px){div.avatar_main_frame>a:first-child{margin-right:0;float:none}div.avatar_main_frame .avatar_actions{display:block}}@media only screen and (max-width:480px){.avatar_main_frame>a:first-child{margin-right:0}.avatar_main_frame img{max-width:245px;max-height:245px}}form div.avatartag{float:left;margin:0 .5em .5em 0}form div.avatartag a{outline:0}#fieldset_wrapper_image_crop .crop_button{display:none}#image_crop_block{display:table}#image_crop_block>div{display:table-cell;vertical-align:top}#target_cropped_image{float:left;margin:0 10px 10px 0;box-shadow:1px 1px 3px 0 rgba(0,0,0,.25)}#target_cropped_image img{height:auto;width:auto}.preview_cropped_images{width:128px;text-align:center}.preview_cropped_images.only_small_preview{width:auto}.preview_cropped_image{display:inline-block;overflow:hidden;box-shadow:1px 1px 3px 0 rgba(0,0,0,.25)}.preview_cropped_image.circle{border-radius:50%}.crop_button{text-align:center}.crop_button.top{display:none}.jcrop-keymgr{visibility:hidden}#user_crop_workarea img,.preview_cropped_image img{max-width:none}.evo_label_inline{margin-left:2ex}div.fieldset_icons,div.right_icons{text-align:right}span.fieldset_icons,span.right_icons{float:right}span.label_field_required{color:red;font-weight:700;margin-right:4px}.not_required span.label_field_required{display:none}span.field_error{color:red}span.help-inline span.field_error,span.notes span.field_error{display:none}input.field_error,select.field_error,textarea.field_error{background:#fbf2ee;border:1px solid #d99}span.checkbox_error{background:#fbf2ee;border:1px solid #d99;display:inline-block;padding:0 5px;margin-left:-26px}span.checkbox_error input[type=checkbox]{position:relative;margin:0}span.checkbox_surround{background:#fbf2ee;border:1px solid #F825F1}span.checkbox_surround input.checkbox{background:#fbf2ee}span.checkbox_surround_init{padding:1px}input.large,textarea.form_textarea_input{width:97%;margin:0;display:block}label.radiooption{margin-right:1em}div.action_messages li,div.action_messages ol,div.action_messages ul,div.log_container li,div.log_container ol,div.log_container ul{list-style:none;margin:0;padding-left:0}div.action_messages ul.message_group li,div.log_container ul.message_group li{margin-left:25px;list-style:disc}div.skin_error{border:2px dotted #d99;background:#fbf2ee;color:#e00;padding:1em;margin:1em}table.widget_grid{margin:8px auto 1px;border-collapse:separate;border-spacing:3px}table.widget_grid td{padding:0;background-color:#fff;border:1px solid #ddd;vertical-align:top}table.widget_grid img{padding:1px}table.widget_grid .note{text-align:center;padding:2px;border-top:1px solid #ddd;line-height:normal;display:block}#sidebar table.widget_grid .note{margin:0}.widget_core_user_avatars .panel-body{padding-bottom:0!important}.widget_core_user_avatars .panel-body .widget_grid{margin-bottom:23px!important}.widget_flow_blocks,table.widget_grid{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;flex-flow:row wrap;-webkit-flex-flow:row wrap;justify-content:center;-webkit-justify-content:center;align-content:center;-webkit-align-content:center;align-items:center;-webkit-align-items:center}.widget_flow_blocks div,table.widget_grid div{margin:3px}.widget_flow_blocks>div img{border-radius:3px}.table_scroll table.table tr td{vertical-align:middle}.table_scroll table.table tr td.firstcol.shrinkwrap{padding:1px 5px}.table_scroll table.table tr td.firstcol.shrinkwrap a img,.table_scroll table.table tr td.firstcol.shrinkwrap span img{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px}.evo_private_messages_list .table_scroll table.table tr td{vertical-align:top}table.table td.thread_with img{margin-bottom:5px}table.table td.thread_with>span:last-child img{margin-bottom:0}.ufld_icon_links,.ufld_icon_links a{text-align:center}li[class*=\" listnav_distance_\"],li[class^=listnav_distance_]{display:none}@media only screen and (min-width:320px){li.listnav_next,li.listnav_next_list,li.listnav_prev,li.listnav_prev_list,li[class*=\" active_distance_\"],li[class^=active_distance_]{display:none}li.listnav_first>a{border-top-left-radius:4px;border-bottom-left-radius:4px}li.listnav_last>a{border-top-right-radius:4px;border-bottom-right-radius:4px}li[class=active_distance_1],li[class=listnav_distance_1]{display:inline}}@media only screen and (min-width:480px){li[class=active_distance_2]{display:inline}li[class=listnav_distance_1]{display:none}li[class=listnav_distance_2]{display:inline}}@media only screen and (min-width:768px){li[class*=\" active_distance_\"],li[class^=active_distance_]{display:inline}li[class*=\" listnav_distance_\"],li[class^=listnav_distance_]{display:none}li.listnav_next_list,li.listnav_prev_list{display:inline}}@media only screen and (min-width:992px){li.listnav_next,li.listnav_prev{display:inline}li.listnav_first>a,li.listnav_last>a{border-radius:0}}blockquote{font-size:100%;margin:1em 0}pre{overflow:hidden}.codespan,pre.codeblock,samp{background-color:#F2F1F0;border:1px solid #CCC;border-radius:2px;padding:0 .5ex}pre.codeblock{overflow:auto;padding:.5ex 2ex}pre.codeblock code{display:block;font-size:110%}div.codeblock{background-color:#FBFAF9;border:1px solid #CCC;border-radius:2px;box-shadow:0 0 5px #CCC inset;margin:1ex 0;padding:6px;overflow:auto}div.codeblock_with_title{margin-top:0}div.codeblock pre{margin:0}.evo_comment p.codeblock_title,p.codeblock_title{font-family:Verdana,sans-serif;letter-spacing:.1em;line-height:95%;font-weight:700;font-size:72%;color:#ABAAA9;margin:1ex 3px 0}div.codeblock>p{display:none}div.videoblock{text-align:center;margin:auto;overflow:auto}div.podplayer{margin:1em 0}span.NonExistentWikiWord{border-bottom:1px dotted #ccc}@media (min-width:768px){div.checkbox:last-of-type,div.radio:last-of-type{padding-bottom:7px}.text-left-sm{text-align:left}.text-right-sm{text-align:right}}@media (min-width:992px){.text-left-md{text-align:left}.text-right-md{text-align:right}}@media (min-width:1200px){.text-left-lg{text-align:left}.text-right-lg{text-align:right}}.glyphicon{font-family:'Glyphicons Halflings'!important}ol,ul{margin:0 0 10px 25px;padding:0}.table-hover>tbody>tr:hover{background-color:#ffc}.btn.btn-danger .fa,.btn.btn-success .fa{color:#FFF!important}.btn.active[disabled]{opacity:1;color:#333;background:#e6e6e6;border-color:#adadad;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}a.btn.action_icon{font-weight:400;text-decoration:none}a.btn.action_icon.hoverlink{text-decoration:none}.form-horizontal .custom_content,.form-horizontal .form-group{margin-left:0;margin-right:0}.form-horizontal .control-label{padding-left:0}.form-horizontal .form-control-inline{display:inline-block;width:auto}.form-horizontal .info_full{padding:0 20px}.form-horizontal .info_full .control-label{width:auto;padding:0}.form-horizontal .info_full .controls-info{margin:0 5px}.form-horizontal .info_full_height .form-control-static{padding-top:0;padding-bottom:0}.form-horizontal .controls{padding-left:0;padding-right:0}.form-horizontal .controls .help-inline{color:#999;font-size:84%}.form-horizontal .controls .form-control{display:inline-block;width:auto;max-width:100%}.form-horizontal .controls span.help-inline a.btn{margin-top:-5px}.form-horizontal .controls input.large,.form-horizontal .controls textarea.form_textarea_input{width:100%}.form-horizontal .radio-group .controls>.help-inline{padding-top:10px;display:inline-block;vertical-align:middle}.form-horizontal .field_inline label{width:auto}.form-horizontal .field_inline label input{width:auto;display:inline-block}.form-horizontal .field_wide label{width:100%;text-align:left}.form-horizontal .field_wide .controls{margin-left:40px}.form-horizontal div.tile,.form-horizontal div.tile label{display:inline-block;white-space:nowrap}.form-horizontal input[type=checkbox],.form-horizontal input[type=radio]{display:inline-block}.form-horizontal .control-buttons{padding-left:0}.form-horizontal div.checkbox label,.form-horizontal div.radio label,.form-horizontal label.radio-inline{font-weight:400}.form-horizontal div.radio label .form_text_input{vertical-align:top;margin-left:7px}.form-horizontal .compose_layout{margin-bottom:15px}.form-horizontal .compose_layout td{padding:0 2px 2px 0;vertical-align:middle}.form-horizontal .compose_layout td.label,.form-horizontal .compose_layout th.label{display:table-cell;color:#333;font-size:100%}.form-horizontal .compose_layout td.label label,.form-horizontal .compose_layout th.label label{margin:0}.form-horizontal .compose_layout td.input div.tile label.control-label{display:none}.form-horizontal #itemform_categories .panel-body.extracats{padding:0}.form-horizontal #itemform_categories .panel-body.extracats table.table{margin:0;border:none}.form-horizontal #itemform_edit_timestamp>input[type=text]{display:inline-block;width:auto}.form-horizontal #itemform_edit_timestamp #itemform_edit_timestamp,.form-horizontal #itemform_extra #itemform_edit_timestamp{padding:10px 0}.form-horizontal #itemform_edit_timestamp label,.form-horizontal #itemform_extra label{padding-left:20px;margin-right:5px;position:relative}.form-horizontal #itemform_edit_timestamp label input[type=radio],.form-horizontal #itemform_extra label input[type=radio]{margin:4px 0 0;position:absolute;left:0}.form-horizontal #itemform_edit_timestamp .form-group,.form-horizontal #itemform_extra .form-group{display:inline-block;margin:0 0 2px}.form-horizontal #itemform_edit_timestamp .form-group input[type=text]:not(#item_issue_date),.form-horizontal #itemform_extra .form-group input[type=text]:not(#item_issue_date){max-width:85px}.form-horizontal #itemform_edit_timestamp td,.form-horizontal #itemform_extra td{vertical-align:middle;padding-right:5px}.form-horizontal #itemform_renderers div[id^=block_renderer_]{padding-left:20px;position:relative}.form-horizontal #itemform_renderers div[id^=block_renderer_] input[type=checkbox]{margin:4px 0 0;position:absolute;left:0}.form-horizontal input.checkbox,.form-horizontal input.radio{min-height:0}.form-inline .form-control{display:inline-block;width:auto}.form-inline .form-control.large{width:97%}.form-inline #criteria_type_A2,.form-inline .form-group{margin-top:2px}.form-inline #criteria_type_A2.large,.form-inline .form-group.large{width:100%}#register_form div#ffield_m{margin-bottom:4px}#register_form div#p-status{margin-left:5px}#register_form #pass2_status .icon{margin-top:-2px}#register_form #p-container{max-width:100%}#register_form input[name^=captcha_qstn_]{width:250px}select#report_user_status{margin-top:-7px}.fixedform-group .fixedform-label{clear:both;float:left;width:150px}.fixedform-group .fixedform-controls{margin-left:165px}@media (max-width:639px){.fixedform-group .fixedform-label{clear:both;float:none;width:100%}.fixedform-group .fixedform-controls{margin-left:0}}a.action_icon{font-size:12px}form ul.token-input-list-facebook{font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:14px;background-color:#FFF;border:1px solid #CCC;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;padding:4px 4px 0}form ul.token-input-list-facebook.token-input-list-error{background:#fbf2ee;border:1px solid #d99}form ul.token-input-list-facebook input,form ul.token-input-list-facebook input:focus{box-shadow:none}form ul.token-input-list-facebook li{font:inherit;height:24px}form ul.token-input-list-facebook li input{padding:2px 0 1px}form ul.token-input-list-facebook li.token-input-input-token-facebook,form ul.token-input-list-facebook li.token-input-token-facebook{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;margin:0 4px 4px 0}div.results{margin-top:0}div.results div.table_scroll{overflow:auto;width:100%}div.results .table-bordered{border-left:none;border-right:none}div.results .table-bordered td.firstcol,div.results .table-bordered th.firstcol{border-left:none}div.results .table-bordered td.lastcol,div.results .table-bordered th.lastcol{border-right:none}div.results .table-bordered th{border-bottom:none}div.results .page_size_selector{margin-bottom:5px;display:block}div.results .page_size_selector select.form-control{display:inline-block;width:auto}div.results .pagination{margin-top:5px;margin-bottom:5px}div.results tr.placeholder{position:relative}div.results tr.placeholder:before{content:\"\";position:absolute;width:0;height:0;border:6px solid transparent;border-left-color:red;border-right:none;margin-top:-5px;left:0}div.results tr.placeholder:after{content:\"\";position:absolute;width:100%;height:2px;background:red;left:0;margin-top:1px}div.results tr.placeholder td{border:none;height:0;padding:0}div.results tr.dragged+tr:not(:nth-child(2)):not(.dragged)>td,div.results tr.placeholder+tr:not(:nth-child(2)):not(.dragged)>td{border-top:none}div.results img{max-width:none}div.filters{margin-bottom:0;background:0 0;border:none}div.filters>div{margin-left:0}div.filters button.filter{float:right;padding:4px 12px}div.filters .block{display:inline-block;margin:2px}div.filters.panel-body{padding:15px}div.filters .twitter-typeahead{vertical-align:middle}div.filters .twitter-typeahead .tt-dropdown-menu div{margin-left:0}.table_scroll .table{margin-bottom:0}div.messages{border-bottom:1px solid #bbb}.popover{max-width:100%;color:#333}.popover.right{text-align:left}.popover.right.popover-userfield{margin-left:35px!important;cursor:pointer}.popover p{margin:10px 0 0}.glyphicon{font-size:12px;color:#428BCA}a:hover .glyphicon{color:#2A6496}.glyphicon:before{position:absolute;top:0;left:0;right:0;bottom:0;text-align:center}#colorbox #cboxVoting label{display:inline;font-size:10px!important;line-height:0;margin:0}#colorbox #cboxVoting label input{margin-top:0}#itemform_edit_timestamp label,#itemform_renderers label,table.catselect label{display:inline-block;margin-right:5px}#itemform_edit_timestamp label input,#itemform_renderers label input,table.catselect label input{margin:0 2px 4px 0}.nav{margin:20px 0}.well{background:#F5F5F5}.well .nav{padding:0 15px;margin:0}.well .nav li>a{padding:3px 15px;margin:0 -15px}.well .nav .active>a,.well .nav .active>a:hover{background-color:#08C;color:#FFF;text-shadow:0 -1px 0 rgba(0,0,0,.2)}input:focus:invalid,select:focus:invalid,textarea:focus:invalid{color:#b94a48;border-color:#ee5f5b}input:focus:invalid:focus,select:focus:invalid:focus,textarea:focus:invalid:focus{border-color:#e9322d;-webkit-box-shadow:0 0 6px #f8b9b7;-moz-box-shadow:0 0 6px #f8b9b7;box-shadow:0 0 6px #f8b9b7}#login_form input:focus:invalid:focus,#login_form select:focus:invalid:focus,#login_form textarea:focus:invalid:focus{border-color:#66afe9;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.panel-heading h4{margin:0}.panel-heading .close{position:relative;top:-4px}.panel-heading .btn{margin:-6px 0 0 6px}.panel-heading .btn-group{margin-left:6px}legend.panel-heading{font-size:16px;font-weight:400;margin-bottom:0}legend.panel-heading a.action_icon.pull-right{line-height:16px}legend.panel-heading a.action_icon.pull-right span.fa{position:relative;top:1px}.panel-title .icon{vertical-align:middle;position:relative;top:-1px}.panel-title a.help_plugin_icon{color:#337ab7}.panel-title a.help_plugin_icon:hover{color:#23527c}.panel-warning>.panel-footer{background-color:#fcf8e3;border-color:#faebcc}.evo_confirm_delete__title{margin-top:0}.form_add_contacts{display:block;padding:5px 0 20px}.form_add_contacts .label{color:#333;font-size:100%;padding-left:0}.form_add_contacts .controls{padding-left:0}.form_add_contacts .control-label{width:auto;padding-top:2px;padding-left:0;line-height:24px}.form_add_contacts .control-label span.fa{top:-2px!important;left:-5px}.form_add_contacts .form-control{display:inline-block;width:auto}.form_send_contacts span.fa{top:-2px!important;left:-5px}.panel-body #ffield_contact_groups label{white-space:nowrap}.panel-body #ffield_contact_groups .contact_group_new input[type=checkbox]{margin-top:12px}.form-horizontal .controls .form-control.form_textarea_input,.form-horizontal .controls input.large{display:block}div.edit_toolbars{margin-top:5px;text-align:left}div.edit_toolbars,div.message_toolbars{line-height:1}.btn-toolbar[class*=\"_toolbar\"]{display:inline-block;margin:0 2px 0 0;line-height:1.42857143;background-color:#f5f5f5;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;padding:2px 2px 0}.btn-toolbar[class*=\"_toolbar\"] .btn-group:first-child{margin-left:0}.btn-toolbar[class*=\"_toolbar\"] .btn{margin-bottom:2px}.btn-toolbar[class*=\"_toolbar\"] .btn-toolbar-title{padding-left:5px;float:left;font-weight:700}.btn-toolbar[class*=\"_toolbar\"].disabled span.btn{opacity:.5;cursor:default}.btn-toolbar[class*=\"_toolbar\"].disabled span.btn:hover{background:#FFF}.edit_plugin_actions{padding-top:7px}.badge-important{background-color:red!important;color:#FFF!important}.badge-info{background-color:#5bc0de!important;color:#FFF!important}.badge-warning{background-color:#f0ad4e!important;color:#fff!important}.badge-meta{background-color:#5bc0de!important;color:#fff!important}.dropdown-menu>li>a .tooltip{white-space:normal}.panel-heading .badge{position:relative;top:-1px}.evobar-menu .badge{font-weight:400;padding:3px 7px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.nav .badge{font-weight:400}#colorbox,#colorbox *,#colorbox :after,#colorbox :before{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}.modal{z-index:10001}.modal-backdrop{position:fixed}.modal-dialog{margin:30px auto}.tt-dropdown-menu{background-color:#FFF;border:1px solid rgba(0,0,0,.2);-webkit-border-radius:8px;-moz-border-radius:8px;-ms-border-radius:8px;-o-border-radius:8px;border-radius:8px;box-shadow:0 5px 10px rgba(0,0,0,.2);padding:8px 0}.tt-dropdown-menu .tt-suggestion{font-size:18px;line-height:24px;padding:3px 20px}.tt-dropdown-menu .tt-suggestion.tt-cursor{background-color:#0097CF;color:#FFF}.tt-dropdown-menu .tt-suggestion p{margin:0}.jumbotron{font-size:21px;font-weight:200}.mce-container label.mce-label{max-width:none}.evo_content_block img{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px}.ufld_icon_links a{display:inline-block;text-decoration:none;color:#FFF;background:#ddd;border-radius:50%;width:40px;height:40px;margin:2px;position:relative;-webkit-transition:border-radius 250ms ease-out,background-color 250ms ease-out;-moz-transition:border-radius 250ms ease-out,background-color 250ms ease-out;-o-transition:border-radius 250ms ease-out,background-color 250ms ease-out;transition:border-radius 250ms ease-out,background-color 250ms ease-out}.ufld_icon_links a:hover{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;color:#FFF;background:#23527c}.ufld_icon_links a .fa{font-size:20px;line-height:40px;display:block}.ufld_icon_links.small a{width:20px;height:20px}.ufld_icon_links.small a .fa{font-size:10px;line-height:20px}.evo_private_messages_list .messages_navigation{padding:5px}.evo_private_messages_list>h2{margin-top:0}.evo_private_messages_list .messages_list_actions{text-align:center;padding:10px 0}.evo_private_messages_list .messages_list_actions p{margin:0;padding:0;text-align:center}.evo_private_messages_list .messages_list_actions a{display:inline-block}.evo_private_messages_list .messages_list_actions a:last-child{margin-bottom:0}.evo_private_messages_list span.error{border:1px solid #BBB;border-bottom:none;padding:10px;text-align:center;display:block}.evo_private_messages_list .panel{margin-bottom:0}.evo_private_messages_list .panel.results{margin-bottom:20px}.evo_private_messages_list .image_block img{max-width:100%;height:auto}@media (min-width:768px){div.coll-dashboard-block-3{float:left}}@media (min-width:992px){div.coll-dashboard-block-3{float:left}}@media (min-width:1200px){div.coll-dashboard-block-3{float:right}}.btn-spinner{background-image:url(../img/ajax-loader/000.gif);background-size:14px 14px;background-repeat:no-repeat;background-position:left 5px center}\n\\ No newline at end of file\n+.red{color:red}.orange{color:#f60}.green{color:#0c0}.black{color:#000}.dimmed,.disabled,.gray,.grey{color:#999}.note,.notes{font-size:84%;color:#999;font-weight:400}.left{text-align:left}.center{text-align:center}.right{text-align:right}.line,.nobr,.nowrap{white-space:nowrap}.expanded li{margin-top:1ex;margin-bottom:1ex}a.discreet{text-decoration:none}.deleted,del{color:#999}.inserted,ins{color:#a44}abbr,acronym{border-bottom:1px dotted #666;cursor:help}code,pre{hyphens:none}img{border:none;max-width:100%;height:auto}.top{vertical-align:top}.middle{vertical-align:middle}.bottom,img.icon{vertical-align:bottom}.baseline{vertical-align:baseline}.text-bottom{vertical-align:text-bottom}.image_block.raised img,img.raised{box-shadow:0 0 11px 0 rgba(0,0,0,.3)}.image_block.noshadow img,img.noshadow{box-shadow:none}.image_block.border img,img.border{border:1px solid #666}.image_block.noborder img,img.noborder{border:none}.image_block.squared img,img.squared{border-radius:0}.image_block.rounded img,img.rounded{border-radius:4px}.image_block.round img,img.round{border-radius:50%}.image_block.embossed img,img.embossed{border:5px solid;border-color:rgba(238,238,238,.6) rgba(34,34,34,.6) rgba(51,51,51,.8) rgba(231,231,231,.6)}.floatleft{float:left}.floatright{float:right}.leftmargin{float:left;margin-right:1ex;margin-top:.2ex;margin-bottom:.2ex}.rightmargin{float:right;margin-left:1ex;margin-top:.2ex;margin-bottom:.2ex}.clear{clear:both}.inline-block{display:inline-block}.inline{display:inline}.margin1ex{margin:1ex}.margin2ex{margin:2ex}.indented{padding-left:3em}span.flag{border:1px solid #666;background:url(../icons/flags_sprite.png) no-repeat;width:16px;height:11px;line-height:11px;padding:0!important;font-size:6px;display:inline-block!important;margin-bottom:-2px;box-sizing:content-box}span.icon{background:url(../icons/icons_sprite.png) -112px -48px no-repeat;width:16px;height:16px;line-height:16px;padding:0!important;font-size:9px;display:inline-block;overflow:hidden;vertical-align:middle}span.icon.voted{margin:0 2px}a.rollover_sprite:hover span.icon{visibility:hidden;visibility:visible\\0/}@media screen and (min-width:0\\0){a.rollover_sprite:hover span.icon{visibility:visible}}a.rollover_sprite:hover span.icon:before{visibility:visible!important;background:inherit;float:left;width:32px;height:16px;content:\"\";margin-left:-16px}.vote_spam span.icon.voted{margin:auto}.action_icon:hover{text-decoration:none}.action_icon.hoverlink:hover{text-decoration:underline}button.action_icon{background:0 0;border:none;padding:0;cursor:pointer}span.fa{line-height:inherit;font-size:14px}.btn span.fa{line-height:14px}a.action_icon span.fa{margin-right:2px}span.fa.action_icon.empty_placeholder{margin-right:4px;visibility:hidden}a.roundbutton .fa,a.roundbutton:hover .fa,a.roundbutton_text .fa,a.roundbutton_text:hover .fa{color:#000}a:hover .fa-x-rollover-green{color:#0C0!important}a:hover .fa-x-rollover-red{color:#C00!important}a:hover .fa-x-rollover-red-light{color:red!important}a:hover .fa-x-rollover-orange{color:#F90!important}a:hover .fa-x-rollover-black{color:#000!important}a:hover .fa-x-rollover-grey{color:#7f7f7f!important}a:hover .fa-flag.fa-x--hover{color:red!important}a:hover .fa-flag.fa-x--hover:before{content:\"\\f11d\"}a:hover .fa-flag-o.fa-x--hover{color:red!important}a:hover .fa-flag-o.fa-x--hover:before{content:\"\\f024\"}.fa-x-external-link--nudge:before{position:relative;top:.05em;left:.11em}.fa-x-linkedin--nudge:before{position:relative;top:-.05em;left:.04em}.fa-x-google-plus--nudge:before{position:relative;left:.1em}span.loader_img{display:inline-block;width:32px;height:32px;background:url(../img/ajax-loader/fff.gif) center no-repeat}span.loader_img.loader_user_deldata,span.loader_img.loader_user_report{background-image:url(../img/ajax-loader/777.gif)}.status_color_draft{color:#ff9}.status_color_review{color:#c09}.status_color_community{color:#2e8bb9}.status_color_protected{color:#ff9c2a}.status_color_private{color:#dc143c}.status_color_published{color:#9e4}.status_color_deprecated{color:#000}.status_color_redirected{color:#639}.status_color_trash{color:#f66}.status_color_meta{color:#5bc0de}.btn[class*=btn-status-]{border:1px solid #ccc}.btn-status-draft{color:#000;background-color:#ff9;border-color:#dfdfdf}.btn-status-draft:hover{color:#000;background-color:#f3f392}.btn-status-review{color:#fff;background-color:#c09}.btn-status-review:hover{color:#fff;background-color:#c20092}.btn-status-community{color:#fff;background-color:#2e8bb9}.btn-status-community:hover{color:#fff;background-color:#2c84b0}.btn-status-protected{color:#fff;background-color:#ff9c2a}.btn-status-protected:hover{color:#fff;background-color:#f39528}.btn-status-private{color:#fff;background-color:#dc143c}.btn-status-private:hover{color:#fff;background-color:#d21339}.btn-status-published{color:#000;background-color:#9e4}.btn-status-published .glyphicon{color:inherit!important}.btn-status-published:hover{color:#000;background-color:#92e341}.btn-status-deprecated{color:#fff;background-color:#000}.btn-status-deprecated:hover{color:#fff;background-color:#333}.btn-status-redirected{color:#fff;background-color:#639}.btn-status-redirected:hover{color:#fff;background-color:#613192}.btn-status-trash{color:#fff;background-color:#f66}.btn-status-trash:hover{color:#fff;background-color:#f44}.ufld_yahooim.ufld__hovertextcolor:hover,.ufld_yahooim.ufld__textcolor{color:#7b0099}.ufld_yahooim.ufld__bgcolor,.ufld_yahooim.ufld__hoverbgcolor:hover{background-color:#7b0099}.ufld_skype.ufld__hovertextcolor:hover,.ufld_skype.ufld__textcolor{color:#00aff0}.ufld_skype.ufld__bgcolor,.ufld_skype.ufld__hoverbgcolor:hover{background-color:#00aff0}.ufld_twitter.ufld__hovertextcolor:hover,.ufld_twitter.ufld__textcolor{color:#00aced}.ufld_twitter.ufld__bgcolor,.ufld_twitter.ufld__hoverbgcolor:hover{background-color:#00aced}.ufld_facebook.ufld__hovertextcolor:hover,.ufld_facebook.ufld__textcolor{color:#3b5998}.ufld_facebook.ufld__bgcolor,.ufld_facebook.ufld__hoverbgcolor:hover{background-color:#3b5998}.ufld_googleplus.ufld__hovertextcolor:hover,.ufld_googleplus.ufld__textcolor{color:#dd4b39}.ufld_googleplus.ufld__bgcolor,.ufld_googleplus.ufld__hoverbgcolor:hover{background-color:#dd4b39}.ufld_linkedin.ufld__hovertextcolor:hover,.ufld_linkedin.ufld__textcolor{color:#007bb6}.ufld_linkedin.ufld__bgcolor,.ufld_linkedin.ufld__hoverbgcolor:hover{background-color:#007bb6}.ufld_github.ufld__hovertextcolor:hover,.ufld_github.ufld__textcolor{color:#333}.ufld_github.ufld__bgcolor,.ufld_github.ufld__hoverbgcolor:hover{background-color:#333}.ufld_flickr.ufld__hovertextcolor:hover,.ufld_flickr.ufld__textcolor{color:#ff0084}.ufld_flickr.ufld__bgcolor,.ufld_flickr.ufld__hoverbgcolor:hover{background-color:#ff0084}.ufld_youtube.ufld__hovertextcolor:hover,.ufld_youtube.ufld__textcolor{color:#b00}.ufld_youtube.ufld__bgcolor,.ufld_youtube.ufld__hoverbgcolor:hover{background-color:#b00}.ufld_digg.ufld__hovertextcolor:hover,.ufld_digg.ufld__textcolor{color:#356aa0}.ufld_digg.ufld__bgcolor,.ufld_digg.ufld__hoverbgcolor:hover{background-color:#356aa0}.ufld_stumbleupon.ufld__hovertextcolor:hover,.ufld_stumbleupon.ufld__textcolor{color:#eb4924}.ufld_stumbleupon.ufld__bgcolor,.ufld_stumbleupon.ufld__hoverbgcolor:hover{background-color:#eb4924}.ufld_pinterest.ufld__hovertextcolor:hover,.ufld_pinterest.ufld__textcolor{color:#cb2027}.ufld_pinterest.ufld__bgcolor,.ufld_pinterest.ufld__hoverbgcolor:hover{background-color:#cb2027}.filter_item{display:inline-block;vertical-align:middle;margin:1px}.filter_item div{margin:0;padding:3px 5px;color:#FFF;float:left}.filter_item div:first-child{border-radius:5px 0 0 5px}.filter_item div.icon{border-radius:0 5px 5px 0;float:right;padding:0}.filter_item div.icon a{display:block;padding:4px 5px 5px;margin:0}.filter_item .name{background:#3d8f3d}.filter_item div.group,.filter_item div.icon,.filter_item:hover .name{background:#45a145}.filter_item div.icon:hover{background:#4db34d}.filter_item.yellow .name{background:#caca3f}.filter_item.yellow div.group,.filter_item.yellow div.icon,.filter_item.yellow:hover .name{background:#dbdb57}.filter_item.yellow div.icon:hover{background:#ecec73}.filter_item.orange .name{background:#d18335}.filter_item.orange div.group,.filter_item.orange div.icon,.filter_item.orange:hover .name{background:#e09952}.filter_item.orange div.icon:hover{background:#edac6b}.filter_item.red .name{background:#c12d2d}.filter_item.red div.group,.filter_item.red div.icon,.filter_item.red:hover .name{background:#cb4d4d}.filter_item.red div.icon:hover{background:#e57373}.filter_item.magenta .name{background:#8618bd}.filter_item.magenta div.group,.filter_item.magenta div.icon,.filter_item.magenta:hover .name{background:#93c}.filter_item.magenta div.icon:hover{background:#b053df}.filter_item.blue .name{background:#2f60c0}.filter_item.blue div.group,.filter_item.blue div.icon,.filter_item.blue:hover .name{background:#4d77cb}.filter_item.blue div.icon:hover{background:#6a91df}.filter_item div{height:24px!important;line-height:18px!important}div.filters .filter_item{margin:1px}div.filters .filter_item div{margin:0}.widget_core_coll_category_list label{font-weight:400}.widget_core_coll_category_list ul{margin-left:0}.widget_core_coll_category_list ul ul{margin-left:19px}.widget_core_coll_category_list li{list-style:none}.widget_core_coll_category_list input[type=checkbox],.widget_core_coll_category_list input[type=radio]{margin:0;display:inline-block}.widget_core_coll_category_list .evo_cat_meta{font-weight:700;color:#000;list-style:square;margin-left:20px}.widget_core_coll_category_list .evo_cat_meta a,.widget_core_coll_category_list .evo_cat_meta label{font-weight:700;color:#000}.widget_core_coll_category_list .evo_cat_meta ul{font-weight:400}.widget_core_coll_category_list .evo_cat_meta input[disabled=disabled]{display:none}.widget_core_coll_category_list .tile label{display:inline}.evo_comment__meta{border:2px solid #5bc0de}.evo_comment__meta:last-child{margin-bottom:0}.evo_comment__meta .panel-heading{border-bottom:1px solid #5bc0de;background-color:#d9edf7}.evo_comment__meta .panel-footer{border-top:1px solid #5bc0de;background-color:#d9edf7}.panel-meta{border:2px solid #5bc0de}.panel-meta .panel-heading{border-bottom:1px solid #5bc0de;background-color:#d9edf7}.panel-meta .panel-body{background-color:#d9edf7}.evo_voting_panel>span.fa{margin-right:4px;margin-left:2px}div#evo_toolbar{background-color:#d2d2d2;border-bottom:1px solid #aeaeae;text-align:left;margin:0;font:14px \"Helvetica Neue\",Helvetica,sans-serif,Arial;position:fixed;z-index:11000;left:0;top:0;width:100%;-webkit-text-size-adjust:none}@media only screen and (max-device-width:1024px){div#evo_toolbar{position:relative}div#skin_wrapper.skin_wrapper_loggedin{margin-top:0}}div.skin_wrapper_loggedin{margin-top:26px;padding-top:1px}div#evo_toolbar .actions_left{float:left}div#evo_toolbar .actions_right{float:right}@media (max-width:479px){div#evo_toolbar .actions_right .debug_dev_button{display:none}}.evobar-menu,.evobar-menu *{margin:0;padding:0;list-style:none;box-sizing:content-box;-webkit-font-smoothing:antialiased}.evobar-menu ul{position:absolute;top:-99999em;opacity:0;width:25ex;border:1px solid #aeaeae;box-shadow:2px 2px 4px -1px rgba(0,0,0,.25);-webkit-transition:opacity .2s ease-in-out;-o-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out}.evobar-menu ul li{width:100%}.evobar-menu>li:hover>ul{opacity:1;z-index:99;top:26px}.evobar-menu li{float:left;position:relative}.evobar-menu li:hover li ul{top:-999em}.evobar-menu li ul li:last-child a{border:none}.evobar-menu li li ul{top:-999em;left:25ex}.evobar-menu li li:hover ul{top:0;opacity:1}.evobar-menu li li:hover li ul{top:-999em;opacity:0}.evobar-menu li li li:hover ul{top:0;opacity:1}.evobar-menu li li a,.evobar-menu li li a:hover,.evobar-menu li li a:link,.evobar-menu li li a:visited{display:block;background-color:#d2d2d2;color:#4f4f4f}.evobar-menu li li a:hover{background-color:#bfbfbf}.evobar-menu li.separator{background-color:#d2d2d2}.evobar-menu li.separator hr{border:none;background-color:#4f4f4f;height:1px;margin:10px 4px}.evobar-menu li u{text-decoration:none}.evobar-menu a{display:inline-block;position:relative;background-color:#d2d2d2;-webkit-transition:background-color .15s ease-out;-o-transition:background-color .15s ease-out;transition:background-color .15s ease-out;padding:6px 1ex;text-decoration:none;min-height:14px;line-height:14px;color:#4f4f4f}.evobar-menu a:hover,.evobar-menu a:link,.evobar-menu a:visited{color:#4f4f4f}.evobar-menu a:hover{background-color:#bfbfbf;-webkit-transition:none;-o-transition:none;transition:none;text-decoration:none}.evobar-menu a.disabled,.evobar-menu a.disabled:hover{color:#999}.evobar-menu [class^=evobar-icon-]{margin-left:6px;float:right}@media (max-width:800px){.evobar-menu li u,.evobar-menu li.rwdhide{display:none}}.actions_left .evobar-menu.evobar-menu-left{float:left}.actions_right .evobar-menu>li>ul{right:0}.actions_right .evobar-menu li li ul{left:-25.3ex;z-index:-1}.bubbletip_user ul{padding:0;margin:0}.bubbletip_user ul li{margin:.5ex 0;padding:0;list-style:none;text-align:center}.bubbletip_user__buttons{text-align:center;margin:0;color:#FFF}.bubbletip_user__buttons a.btn{color:#FFF;margin:5px 0 0}.bubbletip_user__buttons a.btn:first-child{margin:0}.bubbletip_anon{text-align:center}.bubbletip_anon div{margin-top:5px}.bubletip_overlay_text{position:relative}.bubletip_overlay_text div{position:absolute;top:0;left:0;width:100%;text-align:center;text-shadow:-1px -1px #000,-2px 0 #000,-1px 1px #000,0 2px #000,1px 1px #000,2px 0 #000,1px -1px #000,0 -2px #000;color:#FFF;font-weight:700}a.overlay_link:hover{text-decoration:none}a.overlay_link:hover b{text-decoration:underline}.user,.user.anonymous{font-weight:700;word-wrap:break-word}.user.closed,.user.deleted{color:#666}.user.man{color:#0080FF}.user.woman{color:#F6F}.user.anonymous.nogender,.user.nogender{color:#000}div.debug{font-family:Arial,Helvetica,sans-serif;font-size:10pt;border:2px solid #000;padding:1ex;background-color:#ccc;text-align:left;color:#000}div.debug h2,div.debug h3,div.debug h4{color:#03F}div.debug code{font-family:Monaco,\"Courier New\",Courier,monospace;font-size:9pt;margin:1ex 1ex 0;display:block}div.debug div.query_info{background-color:#fff;font-size:12px;margin:1ex}div.debug table{border:1px solid #000;border-collapse:collapse;font-family:Monaco,\"Courier New\",Courier,monospace;margin:1ex}div.debug table,div.debug td,div.debug th{font-size:8pt}div.debug th{background-color:#fff;border:1px solid #000;padding:2px;white-space:nowrap}div.debug th span.type{font-weight:400;color:#999}div.debug td{background-color:#ddd;border:1px solid #000;padding:2px;vertical-align:top;white-space:nowrap}div.debug td.odd{background-color:#eee}a.jslog_switcher{cursor:pointer}div#debug_ajax_info{display:none;position:fixed;top:27px;left:0;z-index:100000;min-width:190px;min-height:83px;opacity:.85;filter:alpha(opacity=85)}div#debug_ajax_info.debug{padding:0}div#debug_ajax_info h2{margin-top:0}div#debug_ajax_info h4{margin-bottom:5px}div#debug_ajax_info h4.error{color:red}div#debug_ajax_info p{margin:5px 0 2px;font-weight:700}div#debug_ajax_info #jslog_container{max-height:500px;overflow-y:auto;padding:0 10px;min-height:43px}div#debug_ajax_info .jslog_statusbar,div#debug_ajax_info .jslog_titlebar{padding:1px 3px}div#debug_ajax_info .jslog_titlebar{border-bottom:1px solid #AAA;cursor:move;background:#006;opacity:.85;color:#FFF;font-weight:700}div#debug_ajax_info .jslog_statusbar{border-top:1px solid #AAA;padding-right:10px}div#debug_ajax_info .ui-resizable-e{right:0;z-index:999}div#debug_ajax_info .ui-resizable-s{bottom:0;z-index:999}div#debug_ajax_info .ui-resizable-se{z-index:1000}div.jslog{display:none}ul.jslog_error,ul.jslog_note{background:#DDD;border:1px solid #6287C2;margin:0 auto 1ex;padding:1ex 1ex 1ex 3ex}ul.jslog_error{border:1px solid #d99;background:#fbf2ee;color:#e00}.item_custom_fields{border:none;margin-bottom:10px;border-collapse:collapse}.item_custom_fields td,.item_custom_fields th{padding:0 10px 0 0}.item_custom_fields th{text-align:left}.b2evo_alert{width:270px;position:fixed;right:10px;top:40px;background:#d64141;border:1px solid #FFF;color:#FFF;font-weight:700;padding:5px;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;-khtml-border-radius:3px;z-index:11000}body,html{width:auto!important;overflow-x:hidden!important}div.dev-blocks{border:1px solid red;margin:0;padding:0;border-radius:3px}div.dev-blocks div.dev-blocks{margin:2px}div.dev-blocks-name{font-family:\"Helvetica Neue\",sans-serif;margin:0;font-size:7pt;text-align:left;font-weight:400;border-radius:2px 2px 0;padding:1px 4px}span.dev-blocks-action{float:right}div.dev-blocks--siteinclude{border-color:#f0f}div.dev-blocks--siteinclude>.dev-blocks-name{color:#d0d;background-color:#fdf}div.dev-blocks--include{border-color:#0c0}div.dev-blocks--include>.dev-blocks-name{color:#0d0;background-color:#dfd}div.dev-blocks--container>.dev-blocks-name{color:red;background-color:#fdd}div.dev-blocks--widget{border-color:#00f}div.dev-blocks--widget>.dev-blocks-name{color:#00f;background-color:#eef}div.dev-blocks--widget--incache{border-color:#00f8f8}div.dev-blocks--widget--incache>.dev-blocks-name{color:#0ee;background-color:#e8f8f8}div.dev-blocks--widget--notincache{border-color:#ec0}div.dev-blocks--widget--notincache>.dev-blocks-name{color:#f8bb00;background-color:#fff0e0}div.dev-blocks--belowtoolbar{margin:27px 0 -27px}.results_ajax_loading{position:absolute;top:0;left:0;background:#000;filter:alpha(opacity=50);-moz-opacity:.5;-khtml-opacity:.5;opacity:.5}.results_ajax_loading div{text-align:center;vertical-align:middle;background:url(../img/ajax-loader/333.gif) center center no-repeat;height:32px;margin:auto;position:absolute;top:0;left:0;right:0;bottom:0}.results_unavailable{background:#FFF;border:1px solid #BBB;color:red;text-align:center;padding:2px}a[rel~=nofollow]:not([class~=btn]):hover{background:#f8e0e0;-moz-border-radius:2px;-webkit-border-radius:2px;-khtml-border-radius:2px;border-radius:2px}img.loadimg{min-width:64px;min-height:64px;background:url(../img/ajax-loader/fff.gif) center no-repeat}figure{margin:1em 0}.evo_image_block{text-align:center}.evo_image_block .img-responsive{display:inline-block}.evo_thumbnail{max-width:100%}.evo_thumbnail__left{float:left;margin:0 4px 4px 0}.evo_thumbnail__right{float:right;margin:0 0 4px 4px}.replied_comment .evo_image_block img{max-width:100%;height:auto}.evo_image_legend{font-size:84%;color:#aaa;padding:9px 6px 6px;text-align:center}.image_rounded img{-webkit-border-radius:50%;-moz-border-radius:50%;-ms-border-radius:50%;-o-border-radius:50%;border-radius:50%}img.avatar_before_login{margin-right:2px;vertical-align:top}img.avatar_before_login_middle{margin-right:2px;vertical-align:middle}img.avatar_above_login{display:block;margin:0 auto}.shrinkwrap{width:1%;white-space:nowrap;text-align:center}.shrinkwrap.left{text-align:left}.block{margin:1ex;white-space:nowrap}a.selected{font-weight:700}.avatar_rounded{background:#FFF;border:1px solid #CCC;padding:2px;display:inline-block;-moz-border-radius:4px;-webkit-border-radius:4px;-khtml-border-radius:4px;border-radius:4px;text-align:center;box-sizing:content-box}.avatar_rounded:hover{text-decoration:none}.avatar_rounded img{-moz-border-radius-topleft:2px;-moz-border-radius-topright:2px;-webkit-border-radius:2px 2px 0 0;-khtml-border-radius-topleft:2px;-khtml-border-radius-topright:2px;border-radius:2px 2px 0 0;margin-bottom:2px}div.avatartag{display:inline-block;vertical-align:top;margin:0 .5em .5em 0}div.avatartag a{outline:0}div.avatartag.main{display:block;float:none!important}div.avatartag.main>a{float:left}div.avatartag.main .avatar_actions,div.avatartag.main a:first-child{margin-right:25px}.avatar_actions{float:left;line-height:26px}.avatar_main_frame{background:#FFF;border:1px solid #CCC;padding:2px;-moz-border-radius:4px;-webkit-border-radius:4px;-khtml-border-radius:4px;border-radius:4px;display:table;vertical-align:middle}.avatar_main_frame img{-moz-border-radius-topleft:2px;-moz-border-radius-bottomleft:2px;-webkit-border-radius:2px 0 0 2px;-khtml-border-radius-topleft:2px;-khtml-border-radius-bottomleft:2px;border-radius:2px 0 0 2px}.avatar_main_frame>a:first-child{float:left;margin-right:5px}.duplicated_avatars{text-align:center;max-width:160px}.avatar_main_frame .duplicated_avatars{max-width:320px}.duplicated_avatars a.user img{vertical-align:text-top}div.avatartag.main>img:first-child{float:left;margin-right:25px}@media only screen and (max-width:600px){div.avatar_main_frame>a:first-child{margin-right:0;float:none}div.avatar_main_frame .avatar_actions{display:block}}@media only screen and (max-width:480px){.avatar_main_frame>a:first-child{margin-right:0}.avatar_main_frame img{max-width:245px;max-height:245px}}form div.avatartag{float:left;margin:0 .5em .5em 0}form div.avatartag a{outline:0}#fieldset_wrapper_image_crop .crop_button{display:none}#image_crop_block{display:table}#image_crop_block>div{display:table-cell;vertical-align:top}#target_cropped_image{float:left;margin:0 10px 10px 0;box-shadow:1px 1px 3px 0 rgba(0,0,0,.25)}#target_cropped_image img{height:auto;width:auto}.preview_cropped_images{width:128px;text-align:center}.preview_cropped_images.only_small_preview{width:auto}.preview_cropped_image{display:inline-block;overflow:hidden;box-shadow:1px 1px 3px 0 rgba(0,0,0,.25)}.preview_cropped_image.circle{border-radius:50%}.crop_button{text-align:center}.crop_button.top{display:none}.jcrop-keymgr{visibility:hidden}#user_crop_workarea img,.preview_cropped_image img{max-width:none}.evo_label_inline{margin-left:2ex}div.fieldset_icons,div.right_icons{text-align:right}span.fieldset_icons,span.right_icons{float:right}span.label_field_required{color:red;font-weight:700;margin-right:4px}.not_required span.label_field_required{display:none}span.field_error{color:red}span.help-inline span.field_error,span.notes span.field_error{display:none}input.field_error,select.field_error,textarea.field_error{background:#fbf2ee;border:1px solid #d99}span.checkbox_error{background:#fbf2ee;border:1px solid #d99;display:inline-block;padding:0 5px;margin-left:-26px}span.checkbox_error input[type=checkbox]{position:relative;margin:0}span.checkbox_surround{background:#fbf2ee;border:1px solid #F825F1}span.checkbox_surround input.checkbox{background:#fbf2ee}span.checkbox_surround_init{padding:1px}input.large,textarea.form_textarea_input{width:97%;margin:0;display:block}label.radiooption{margin-right:1em}.file_select_wrapper{display:flex;flex-flow:row wrap;align-items:flex-start}.file_select_wrapper .file_select_item{display:flex;flex-flow:row wrap;margin-right:8px;text-align:center}.file_select_wrapper .file_select_item .item_actions{display:flex;flex-shrink:1;flex-flow:column wrap;align-content:center;justify-content:center;text-align:left;margin-left:8px}div.action_messages li,div.action_messages ol,div.action_messages ul,div.log_container li,div.log_container ol,div.log_container ul{list-style:none;margin:0;padding-left:0}div.action_messages ul.message_group li,div.log_container ul.message_group li{margin-left:25px;list-style:disc}div.skin_error{border:2px dotted #d99;background:#fbf2ee;color:#e00;padding:1em;margin:1em}table.widget_grid{margin:8px auto 1px;border-collapse:separate;border-spacing:3px}table.widget_grid td{padding:0;background-color:#fff;border:1px solid #ddd;vertical-align:top}table.widget_grid img{padding:1px}table.widget_grid .note{text-align:center;padding:2px;border-top:1px solid #ddd;line-height:normal;display:block}#sidebar table.widget_grid .note{margin:0}.widget_core_user_avatars .panel-body{padding-bottom:0!important}.widget_core_user_avatars .panel-body .widget_grid{margin-bottom:23px!important}.widget_flow_blocks,table.widget_grid{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;flex-flow:row wrap;-webkit-flex-flow:row wrap;justify-content:center;-webkit-justify-content:center;align-content:center;-webkit-align-content:center;align-items:center;-webkit-align-items:center}.widget_flow_blocks div,table.widget_grid div{margin:3px}.widget_flow_blocks>div img{border-radius:3px}.table_scroll table.table tr td{vertical-align:middle}.table_scroll table.table tr td.firstcol.shrinkwrap{padding:1px 5px}.table_scroll table.table tr td.firstcol.shrinkwrap a img,.table_scroll table.table tr td.firstcol.shrinkwrap span img{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px}.evo_private_messages_list .table_scroll table.table tr td{vertical-align:top}table.table td.thread_with img{margin-bottom:5px}table.table td.thread_with>span:last-child img{margin-bottom:0}.ufld_icon_links,.ufld_icon_links a{text-align:center}li[class*=\" listnav_distance_\"],li[class^=listnav_distance_]{display:none}@media only screen and (min-width:320px){li.listnav_next,li.listnav_next_list,li.listnav_prev,li.listnav_prev_list,li[class*=\" active_distance_\"],li[class^=active_distance_]{display:none}li.listnav_first>a{border-top-left-radius:4px;border-bottom-left-radius:4px}li.listnav_last>a{border-top-right-radius:4px;border-bottom-right-radius:4px}li[class=active_distance_1],li[class=listnav_distance_1]{display:inline}}@media only screen and (min-width:480px){li[class=active_distance_2]{display:inline}li[class=listnav_distance_1]{display:none}li[class=listnav_distance_2]{display:inline}}@media only screen and (min-width:768px){li[class*=\" active_distance_\"],li[class^=active_distance_]{display:inline}li[class*=\" listnav_distance_\"],li[class^=listnav_distance_]{display:none}li.listnav_next_list,li.listnav_prev_list{display:inline}}@media only screen and (min-width:992px){li.listnav_next,li.listnav_prev{display:inline}li.listnav_first>a,li.listnav_last>a{border-radius:0}}blockquote{font-size:100%;margin:1em 0}pre{overflow:hidden}.codespan,pre.codeblock,samp{background-color:#F2F1F0;border:1px solid #CCC;border-radius:2px;padding:0 .5ex}pre.codeblock{overflow:auto;padding:.5ex 2ex}pre.codeblock code{display:block;font-size:110%}div.codeblock{background-color:#FBFAF9;border:1px solid #CCC;border-radius:2px;box-shadow:0 0 5px #CCC inset;margin:1ex 0;padding:6px;overflow:auto}div.codeblock_with_title{margin-top:0}div.codeblock pre{margin:0}.evo_comment p.codeblock_title,p.codeblock_title{font-family:Verdana,sans-serif;letter-spacing:.1em;line-height:95%;font-weight:700;font-size:72%;color:#ABAAA9;margin:1ex 3px 0}div.codeblock>p{display:none}div.videoblock{text-align:center;margin:auto;overflow:auto}div.podplayer{margin:1em 0}span.NonExistentWikiWord{border-bottom:1px dotted #ccc}@media (min-width:768px){div.checkbox:last-of-type,div.radio:last-of-type{padding-bottom:7px}.text-left-sm{text-align:left}.text-right-sm{text-align:right}}@media (min-width:992px){.text-left-md{text-align:left}.text-right-md{text-align:right}}@media (min-width:1200px){.text-left-lg{text-align:left}.text-right-lg{text-align:right}}.glyphicon{font-family:'Glyphicons Halflings'!important}ol,ul{margin:0 0 10px 25px;padding:0}.table-hover>tbody>tr:hover{background-color:#ffc}.btn.btn-danger .fa,.btn.btn-success .fa{color:#FFF!important}.btn.active[disabled]{opacity:1;color:#333;background:#e6e6e6;border-color:#adadad;-webkit-box-shadow:inset 0 3px 5px rgba(0,0,0,.125);box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}a.btn.action_icon{font-weight:400;text-decoration:none}a.btn.action_icon.hoverlink{text-decoration:none}.form-horizontal .custom_content,.form-horizontal .form-group{margin-left:0;margin-right:0}.form-horizontal .control-label{padding-left:0}.form-horizontal .form-control-inline{display:inline-block;width:auto}.form-horizontal .info_full{padding:0 20px}.form-horizontal .info_full .control-label{width:auto;padding:0}.form-horizontal .info_full .controls-info{margin:0 5px}.form-horizontal .info_full_height .form-control-static{padding-top:0;padding-bottom:0}.form-horizontal .controls{padding-left:0;padding-right:0}.form-horizontal .controls .help-inline{color:#999;font-size:84%}.form-horizontal .controls .form-control{display:inline-block;width:auto;max-width:100%}.form-horizontal .controls span.help-inline a.btn{margin-top:-5px}.form-horizontal .controls input.large,.form-horizontal .controls textarea.form_textarea_input{width:100%}.form-horizontal .radio-group .controls>.help-inline{padding-top:10px;display:inline-block;vertical-align:middle}.form-horizontal .field_inline label{width:auto}.form-horizontal .field_inline label input{width:auto;display:inline-block}.form-horizontal .field_wide label{width:100%;text-align:left}.form-horizontal .field_wide .controls{margin-left:40px}.form-horizontal div.tile,.form-horizontal div.tile label{display:inline-block;white-space:nowrap}.form-horizontal input[type=checkbox],.form-horizontal input[type=radio]{display:inline-block}.form-horizontal .control-buttons{padding-left:0}.form-horizontal div.checkbox label,.form-horizontal div.radio label,.form-horizontal label.radio-inline{font-weight:400}.form-horizontal div.radio label .form_text_input{vertical-align:top;margin-left:7px}.form-horizontal .compose_layout{margin-bottom:15px}.form-horizontal .compose_layout td{padding:0 2px 2px 0;vertical-align:middle}.form-horizontal .compose_layout td.label,.form-horizontal .compose_layout th.label{display:table-cell;color:#333;font-size:100%}.form-horizontal .compose_layout td.label label,.form-horizontal .compose_layout th.label label{margin:0}.form-horizontal .compose_layout td.input div.tile label.control-label{display:none}.form-horizontal #itemform_categories .panel-body.extracats{padding:0}.form-horizontal #itemform_categories .panel-body.extracats table.table{margin:0;border:none}.form-horizontal #itemform_edit_timestamp>input[type=text]{display:inline-block;width:auto}.form-horizontal #itemform_edit_timestamp #itemform_edit_timestamp,.form-horizontal #itemform_extra #itemform_edit_timestamp{padding:10px 0}.form-horizontal #itemform_edit_timestamp label,.form-horizontal #itemform_extra label{padding-left:20px;margin-right:5px;position:relative}.form-horizontal #itemform_edit_timestamp label input[type=radio],.form-horizontal #itemform_extra label input[type=radio]{margin:4px 0 0;position:absolute;left:0}.form-horizontal #itemform_edit_timestamp .form-group,.form-horizontal #itemform_extra .form-group{display:inline-block;margin:0 0 2px}.form-horizontal #itemform_edit_timestamp .form-group input[type=text]:not(#item_issue_date),.form-horizontal #itemform_extra .form-group input[type=text]:not(#item_issue_date){max-width:85px}.form-horizontal #itemform_edit_timestamp td,.form-horizontal #itemform_extra td{vertical-align:middle;padding-right:5px}.form-horizontal #itemform_renderers div[id^=block_renderer_]{padding-left:20px;position:relative}.form-horizontal #itemform_renderers div[id^=block_renderer_] input[type=checkbox]{margin:4px 0 0;position:absolute;left:0}.form-horizontal input.checkbox,.form-horizontal input.radio{min-height:0}.form-inline .form-control{display:inline-block;width:auto}.form-inline .form-control.large{width:97%}.form-inline #criteria_type_A2,.form-inline .form-group{margin-top:2px}.form-inline #criteria_type_A2.large,.form-inline .form-group.large{width:100%}#register_form div#ffield_m{margin-bottom:4px}#register_form div#p-status{margin-left:5px}#register_form #pass2_status .icon{margin-top:-2px}#register_form #p-container{max-width:100%}#register_form input[name^=captcha_qstn_]{width:250px}select#report_user_status{margin-top:-7px}.fixedform-group .fixedform-label{clear:both;float:left;width:150px}.fixedform-group .fixedform-controls{margin-left:165px}@media (max-width:639px){.fixedform-group .fixedform-label{clear:both;float:none;width:100%}.fixedform-group .fixedform-controls{margin-left:0}}a.action_icon{font-size:12px}form ul.token-input-list-facebook{font-family:\"Helvetica Neue\",Helvetica,Arial,sans-serif;font-size:14px;background-color:#FFF;border:1px solid #CCC;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075);box-shadow:inset 0 1px 1px rgba(0,0,0,.075);-webkit-transition:border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;-o-transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;padding:4px 4px 0}form ul.token-input-list-facebook.token-input-list-error{background:#fbf2ee;border:1px solid #d99}form ul.token-input-list-facebook input,form ul.token-input-list-facebook input:focus{box-shadow:none}form ul.token-input-list-facebook li{font:inherit;height:24px}form ul.token-input-list-facebook li input{padding:2px 0 1px}form ul.token-input-list-facebook li.token-input-input-token-facebook,form ul.token-input-list-facebook li.token-input-token-facebook{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;margin:0 4px 4px 0}div.results{margin-top:0}div.results div.table_scroll{overflow:auto;width:100%}div.results .table-bordered{border-left:none;border-right:none}div.results .table-bordered td.firstcol,div.results .table-bordered th.firstcol{border-left:none}div.results .table-bordered td.lastcol,div.results .table-bordered th.lastcol{border-right:none}div.results .table-bordered th{border-bottom:none}div.results .page_size_selector{margin-bottom:5px;display:block}div.results .page_size_selector select.form-control{display:inline-block;width:auto}div.results .pagination{margin-top:5px;margin-bottom:5px}div.results tr.placeholder{position:relative}div.results tr.placeholder:before{content:\"\";position:absolute;width:0;height:0;border:6px solid transparent;border-left-color:red;border-right:none;margin-top:-5px;left:0}div.results tr.placeholder:after{content:\"\";position:absolute;width:100%;height:2px;background:red;left:0;margin-top:1px}div.results tr.placeholder td{border:none;height:0;padding:0}div.results tr.dragged+tr:not(:nth-child(2)):not(.dragged)>td,div.results tr.placeholder+tr:not(:nth-child(2)):not(.dragged)>td{border-top:none}div.results img{max-width:none}div.filters{margin-bottom:0;background:0 0;border:none}div.filters>div{margin-left:0}div.filters button.filter{float:right;padding:4px 12px}div.filters .block{display:inline-block;margin:2px}div.filters.panel-body{padding:15px}div.filters .twitter-typeahead{vertical-align:middle}div.filters .twitter-typeahead .tt-dropdown-menu div{margin-left:0}.table_scroll .table{margin-bottom:0}div.messages{border-bottom:1px solid #bbb}.popover{max-width:100%;color:#333}.popover.right{text-align:left}.popover.right.popover-userfield{margin-left:35px!important;cursor:pointer}.popover p{margin:10px 0 0}.glyphicon{font-size:12px;color:#428BCA}a:hover .glyphicon{color:#2A6496}.glyphicon:before{position:absolute;top:0;left:0;right:0;bottom:0;text-align:center}#colorbox #cboxVoting label{display:inline;font-size:10px!important;line-height:0;margin:0}#colorbox #cboxVoting label input{margin-top:0}#itemform_edit_timestamp label,#itemform_renderers label,table.catselect label{display:inline-block;margin-right:5px}#itemform_edit_timestamp label input,#itemform_renderers label input,table.catselect label input{margin:0 2px 4px 0}.nav{margin:20px 0}.well{background:#F5F5F5}.well .nav{padding:0 15px;margin:0}.well .nav li>a{padding:3px 15px;margin:0 -15px}.well .nav .active>a,.well .nav .active>a:hover{background-color:#08C;color:#FFF;text-shadow:0 -1px 0 rgba(0,0,0,.2)}input:focus:invalid,select:focus:invalid,textarea:focus:invalid{color:#b94a48;border-color:#ee5f5b}input:focus:invalid:focus,select:focus:invalid:focus,textarea:focus:invalid:focus{border-color:#e9322d;-webkit-box-shadow:0 0 6px #f8b9b7;-moz-box-shadow:0 0 6px #f8b9b7;box-shadow:0 0 6px #f8b9b7}#login_form input:focus:invalid:focus,#login_form select:focus:invalid:focus,#login_form textarea:focus:invalid:focus{border-color:#66afe9;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.panel-heading h4{margin:0}.panel-heading .close{position:relative;top:-4px}.panel-heading .btn{margin:-6px 0 0 6px}.panel-heading .btn-group{margin-left:6px}legend.panel-heading{font-size:16px;font-weight:400;margin-bottom:0}legend.panel-heading a.action_icon.pull-right{line-height:16px}legend.panel-heading a.action_icon.pull-right span.fa{position:relative;top:1px}.panel-title .icon{vertical-align:middle;position:relative;top:-1px}.panel-title a.help_plugin_icon{color:#337ab7}.panel-title a.help_plugin_icon:hover{color:#23527c}.panel-warning>.panel-footer{background-color:#fcf8e3;border-color:#faebcc}.evo_confirm_delete__title{margin-top:0}.form_add_contacts{display:block;padding:5px 0 20px}.form_add_contacts .label{color:#333;font-size:100%;padding-left:0}.form_add_contacts .controls{padding-left:0}.form_add_contacts .control-label{width:auto;padding-top:2px;padding-left:0;line-height:24px}.form_add_contacts .control-label span.fa{top:-2px!important;left:-5px}.form_add_contacts .form-control{display:inline-block;width:auto}.form_send_contacts span.fa{top:-2px!important;left:-5px}.panel-body #ffield_contact_groups label{white-space:nowrap}.panel-body #ffield_contact_groups .contact_group_new input[type=checkbox]{margin-top:12px}.form-horizontal .controls .form-control.form_textarea_input,.form-horizontal .controls input.large{display:block}div.edit_toolbars{margin-top:5px;text-align:left}div.edit_toolbars,div.message_toolbars{line-height:1}.btn-toolbar[class*=\"_toolbar\"]{display:inline-block;margin:0 2px 0 0;line-height:1.42857143;background-color:#f5f5f5;-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;padding:2px 2px 0}.btn-toolbar[class*=\"_toolbar\"] .btn-group:first-child{margin-left:0}.btn-toolbar[class*=\"_toolbar\"] .btn{margin-bottom:2px}.btn-toolbar[class*=\"_toolbar\"] .btn-toolbar-title{padding-left:5px;float:left;font-weight:700}.btn-toolbar[class*=\"_toolbar\"].disabled span.btn{opacity:.5;cursor:default}.btn-toolbar[class*=\"_toolbar\"].disabled span.btn:hover{background:#FFF}.edit_plugin_actions{padding-top:7px}.badge-important{background-color:red!important;color:#FFF!important}.badge-info{background-color:#5bc0de!important;color:#FFF!important}.badge-warning{background-color:#f0ad4e!important;color:#fff!important}.badge-meta{background-color:#5bc0de!important;color:#fff!important}.dropdown-menu>li>a .tooltip{white-space:normal}.panel-heading .badge{position:relative;top:-1px}.evobar-menu .badge{font-weight:400;padding:3px 7px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.nav .badge{font-weight:400}#colorbox,#colorbox *,#colorbox :after,#colorbox :before{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box}.modal{z-index:10001}.modal-backdrop{position:fixed}.modal-dialog{margin:30px auto}.tt-dropdown-menu{background-color:#FFF;border:1px solid rgba(0,0,0,.2);-webkit-border-radius:8px;-moz-border-radius:8px;-ms-border-radius:8px;-o-border-radius:8px;border-radius:8px;box-shadow:0 5px 10px rgba(0,0,0,.2);padding:8px 0}.tt-dropdown-menu .tt-suggestion{font-size:18px;line-height:24px;padding:3px 20px}.tt-dropdown-menu .tt-suggestion.tt-cursor{background-color:#0097CF;color:#FFF}.tt-dropdown-menu .tt-suggestion p{margin:0}.jumbotron{font-size:21px;font-weight:200}.mce-container label.mce-label{max-width:none}.evo_content_block img{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px}.ufld_icon_links a{display:inline-block;text-decoration:none;color:#FFF;background:#ddd;border-radius:50%;width:40px;height:40px;margin:2px;position:relative;-webkit-transition:border-radius 250ms ease-out,background-color 250ms ease-out;-moz-transition:border-radius 250ms ease-out,background-color 250ms ease-out;-o-transition:border-radius 250ms ease-out,background-color 250ms ease-out;transition:border-radius 250ms ease-out,background-color 250ms ease-out}.ufld_icon_links a:hover{-webkit-border-radius:4px;-moz-border-radius:4px;-ms-border-radius:4px;-o-border-radius:4px;border-radius:4px;color:#FFF;background:#23527c}.ufld_icon_links a .fa{font-size:20px;line-height:40px;display:block}.ufld_icon_links.small a{width:20px;height:20px}.ufld_icon_links.small a .fa{font-size:10px;line-height:20px}.evo_private_messages_list .messages_navigation{padding:5px}.evo_private_messages_list>h2{margin-top:0}.evo_private_messages_list .messages_list_actions{text-align:center;padding:10px 0}.evo_private_messages_list .messages_list_actions p{margin:0;padding:0;text-align:center}.evo_private_messages_list .messages_list_actions a{display:inline-block}.evo_private_messages_list .messages_list_actions a:last-child{margin-bottom:0}.evo_private_messages_list span.error{border:1px solid #BBB;border-bottom:none;padding:10px;text-align:center;display:block}.evo_private_messages_list .panel{margin-bottom:0}.evo_private_messages_list .panel.results{margin-bottom:20px}.evo_private_messages_list .image_block img{max-width:100%;height:auto}@media (min-width:768px){div.coll-dashboard-block-3{float:left}}@media (min-width:992px){div.coll-dashboard-block-3{float:left}}@media (min-width:1200px){div.coll-dashboard-block-3{float:right}}.btn-spinner{background-image:url(../img/ajax-loader/000.gif);background-size:14px 14px;background-repeat:no-repeat;background-position:left 5px center}\n\\ No newline at end of file"
        },
        {
          "filename": "rsc/build/bootstrap-backoffice-b2evo_base.bundle.css",
          "status": "modified",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -1475,6 +1475,27 @@ textarea.form_textarea_input {\n label.radiooption {\n   margin-right: 1em;\n }\n+.file_select_wrapper {\n+  display: flex;\n+  flex-flow: row wrap;\n+  align-items: flex-start;\n+}\n+.file_select_wrapper .file_select_item {\n+  display: flex;\n+  flex-flow: row wrap;\n+  margin-right: 8px;\n+  text-align: center;\n+}\n+.file_select_wrapper .file_select_item .item_actions {\n+  display: flex;\n+  flex-shrink: 1;\n+  flex-flow: column wrap;\n+  justify-content: flex-start;\n+  align-content: center;\n+  justify-content: center;\n+  text-align: left;\n+  margin-left: 8px;\n+}\n div.log_container ul,\n div.action_messages ul,\n div.log_container ol,"
        },
        {
          "filename": "rsc/css/basic.css",
          "status": "modified",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -817,6 +817,55 @@ textarea.form_textarea_input {\n label.radiooption {\n   margin-right: 1em;\n }\n+.file_select_wrapper {\n+  display: -webkit-box;\n+  display: -webkit-flex;\n+  display: -ms-flexbox;\n+  display: flex;\n+  -webkit-flex-flow: row wrap;\n+      -ms-flex-flow: row wrap;\n+          flex-flow: row wrap;\n+  -webkit-box-align: start;\n+  -webkit-align-items: flex-start;\n+      -ms-flex-align: start;\n+          align-items: flex-start;\n+}\n+.file_select_wrapper .file_select_item {\n+  display: -webkit-box;\n+  display: -webkit-flex;\n+  display: -ms-flexbox;\n+  display: flex;\n+  -webkit-flex-flow: row wrap;\n+      -ms-flex-flow: row wrap;\n+          flex-flow: row wrap;\n+  margin-right: 8px;\n+  text-align: center;\n+}\n+.file_select_wrapper .file_select_item .item_actions {\n+  display: -webkit-box;\n+  display: -webkit-flex;\n+  display: -ms-flexbox;\n+  display: flex;\n+  -webkit-flex-shrink: 1;\n+      -ms-flex-negative: 1;\n+          flex-shrink: 1;\n+  -webkit-flex-flow: column wrap;\n+      -ms-flex-flow: column wrap;\n+          flex-flow: column wrap;\n+  -webkit-box-pack: start;\n+  -webkit-justify-content: flex-start;\n+      -ms-flex-pack: start;\n+          justify-content: flex-start;\n+  -webkit-align-content: center;\n+      -ms-flex-line-pack: center;\n+          align-content: center;\n+  -webkit-box-pack: center;\n+  -webkit-justify-content: center;\n+      -ms-flex-pack: center;\n+          justify-content: center;\n+  text-align: left;\n+  margin-left: 8px;\n+}\n .eform label {\n   font-weight: bold;\n }"
        },
        {
          "filename": "rsc/css/bootstrap-blog_base.css",
          "status": "modified",
          "additions": 61,
          "deletions": 0,
          "patch": "@@ -1581,3 +1581,64 @@ input.btn-lg {\n .evo_container__sidebar .evo_poll__title {\n   white-space: normal;\n }\n+#itemform_links .panel-body {\n+  padding: 0;\n+}\n+div.qq-upload-button,\n+div.qq-upload-drop-area,\n+div.qq-upload-drop-area-active {\n+  border: 2px dashed #fff;\n+  background: #5bc0de;\n+  border-radius: 9px;\n+}\n+div.qq-upload-button-hover,\n+div.qq-upload-drop-area,\n+div.qq-upload-drop-area-active {\n+  background: #5cb85c;\n+}\n+ul.qq-upload-list {\n+  margin: 0;\n+}\n+div#fileuploader_form {\n+  padding: 5px;\n+  height: 65px;\n+  background: #f5f5f5;\n+}\n+#attachments_fieldset_wrapper {\n+  width: 100%;\n+  height: 160px;\n+  position: relative;\n+  padding-bottom: 6px;\n+  box-sizing: content-box;\n+}\n+#attachments_fieldset_wrapper #attachments_fieldset_block {\n+  overflow: auto;\n+  height: 100%;\n+}\n+#attachments_fieldset_wrapper .ui-resizable-s {\n+  background: #c0c0c0;\n+  height: 6px;\n+  bottom: 0;\n+}\n+#attachments_fieldset_wrapper .ui-resizable-s:after {\n+  content: \"...\";\n+  font-size: 10px;\n+  top: -7px;\n+  position: relative;\n+  text-align: center;\n+  display: block;\n+}\n+#attachments_fieldset_wrapper .table_scroll {\n+  position: relative;\n+}\n+#attachments_fieldset_wrapper table tbody .dragged {\n+  opacity: 0.8;\n+  position: absolute;\n+}\n+#attachments_fieldset_wrapper table tbody td {\n+  cursor: move;\n+}\n+#filelist_tbody tr:first-child .action_icon_link_move_up,\n+#filelist_tbody tr:last-child .action_icon_link_move_down {\n+  visibility: hidden;\n+}"
        },
        {
          "filename": "rsc/js/bozo_validator.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -34,7 +34,7 @@ var bozo = {\n \t\t\t// Hook \"click\" event for reset elements:\n \t\t\t.find(\"input[type=reset]:not([class$=_nocheckchanges])\").click(bozo.reset_changes).end()\n \t\t\t// Hook \"change\" and \"keypress\" event for all others:\n-\t\t\t.find(\"input[type=text], input[type=password], input[type=radio], input[type=checkbox], input[type=file], textarea\")\n+\t\t\t.find(\"input[type=text], input[type=password], input[type=radio], input[type=checkbox], input[type=file], input[type=hidden], textarea\")\n \t\t\t\t.not(\"[class$=_nocheckchanges]\")\n \t\t\t\t\t.bind(\"change\", bozo.change)\n \t\t\t\t\t.bind(\"keypress\", bozo.change);"
        },
        {
          "filename": "rsc/js/build/bootstrap-evo_backoffice.bmin.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,3 +1,3 @@\n /* This includes 15 files: functions.js, ajax.js, communication.js, form_extensions.js, backoffice.js, extracats.js, dynamic_select.js, src/bootstrap-evo_modal_window.js, src/evo_images.js, src/evo_user_crop.js, src/evo_user_report.js, src/evo_user_deldata.js, src/evo_user_org.js, src/evo_rest_api.js, src/evo_links.js */\n-function pop_up_window(a,b,c,d,e){\"undefined\"==typeof c&&(c=750),\"undefined\"==typeof d&&(d=550);var f=(screen.width-c)/2,g=(screen.height-d)/2;return\"undefined\"==typeof e&&(e=\"scrollbars=yes, status=yes, resizable=yes, menubar=yes\"),e=\"width=\"+c+\", height=\"+d+\", left=\"+f+\", top=\"+g+\", \"+e,opened=window.open(a,b,e),opened.focus(),\"undefined\"==typeof openedWindows?openedWindows=new Array(opened):openedWindows.push(opened),!1}function textarea_replace_selection(a,b,c){textarea_wrap_selection(a,b,\"\",1,c)}function textarea_wrap_selection(a,b,c,d,e){e=e||document;var f={element:a,before:b,after:c,replace:d,target_document:e};if(!b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f))return}catch(g){}if(!(window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)))if(e.selection)a.focus(),sel=e.selection.createRange(),d?sel.text=b+c:sel.text=b+sel.text+c,a.focus();else if(a.selectionStart||\"0\"==a.selectionStart){var h,i,j,k=a.selectionStart,l=a.selectionEnd;\"textarea\"==a.type&&\"undefined\"!=typeof a.scrollTop&&(i=a.scrollTop,j=a.scrollLeft),d?(a.value=a.value.substring(0,k)+b+c+a.value.substring(l,a.value.length),h=k+b.length+c.length):(a.value=a.value.substring(0,k)+b+a.value.substring(k,l)+c+a.value.substring(l,a.value.length),h=l+b.length+c.length),\"undefined\"!=typeof i&&(a.scrollTop=i,a.scrollLeft=j),a.focus(),a.selectionStart=h,a.selectionEnd=h}else a.value+=b+c,a.focus()}}function textarea_str_replace(a,b,c,d){d=d||document;var e={element:a,search:b,replace:c,target_document:d};if(!b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e))return}catch(f){}window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)||(a.value=a.value.replace(b,c),a.focus())}}function toggle_filter_area(a){var b=jQuery(\"#clickdiv_\"+a),c=jQuery(\"#clickimg_\"+a);if(0==b.length||0==c.length)return alert(\"ID \"+a+\" not found!\"),!1;if(c.hasClass(\"fa\")||c.hasClass(\"glyphicon\")){if(\"\"!=c.data(\"toggle\")&&void 0!=c.data(\"toggle\")){var d=c.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==c.data(\"toggle-orig-class\")&&c.data(\"toggle-orig-class\",c.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),c.hasClass(c.data(\"toggle-orig-class\"))?c.removeClass(c.data(\"toggle-orig-class\")).addClass(d+\"-\"+c.data(\"toggle\")):c.removeClass(d+\"-\"+c.data(\"toggle\")).addClass(c.data(\"toggle-orig-class\"))}}else{var e=c.css(\"background-position\").match(/-*\\d+/g);c.css(\"background-position\",parseInt(e[0])+(b.is(\":hidden\")?-16:16)+\"px \"+parseInt(e[1])+\"px\")}return b.is(\":hidden\")?(b.slideDown(500),jQuery.post(htsrv_url+\"anon_async.php?action=expand_filter&target=\"+a)):(b.slideUp(500),jQuery.post(htsrv_url+\"anon_async.php?action=collapse_filter&target=\"+a)),!1}function b2evo_Callbacks(){this.eventHandlers=new Array}function evoAlert(a){var b=jQuery(\".b2evo_alert\");b.length>0&&b.remove(),jQuery(\"body\").append('<div class=\"b2evo_alert\">'+a+\"</div>\"),setTimeout(function(){jQuery(\".b2evo_alert\").fadeOut({complete:function(){jQuery(this).remove()}})},3e3),evo_alert_events_initialized||(evo_alert_events_initialized=!0,jQuery(document).on(\"click\",\".b2evo_alert\",function(){jQuery(this).remove()}))}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}function SendAdminRequest(a,b,c,d){if(void 0===d||d){var e=new Date;c+=(\"\"!==c?\"&\":\"\")+\"nocache_dummy=\"+e.getTime()}SendServerRequest(b2evo_dispatcher_url+\"?ctrl=\"+a+\"&action=\"+b+(c?\"&\"+c:\"\"))}function SendServerRequest(a){a+=-1!=a.indexOf(\"?\")?\"&\":\"?\",a+=\"display_mode=js\";var b=a.split(\"?\");a=b[0],b=b[1],jQuery.ajax({type:\"POST\",url:a,data:b,dataType:\"script\"})}function AttachServerRequest(a){jQuery('<input type=\"hidden\" name=\"display_mode\" value=\"js\" /><input type=\"hidden\" name=\"js_target\" value=\"window.parent.\" />').appendTo(\"#\"+a),jQuery(\"#\"+a).attr(\"target\",\"server_postback\")}function DisplayServerMessages(a,b){jQuery(\"#server_messages\").html(a),\"object\"==typeof b&&(jQuery(\"input.field_error, select.field_error, textarea.field_error\").each(function(){jQuery(this).removeClass(\"field_error\");var a=jQuery(this).next();a.hasClass(\"notes\")&&\"SPAN\"==a.get(0).tagName&&a.remove()}),jQuery.each(b,function(a,b){jQuery(\"#\"+a).addClass(\"field_error\").after('<span class=\"oneline notes\"> <span class=\"field_error\" rel=\"'+a+'\">'+b+\"</span></span>\")})),jQuery(\"#server_messages .log_success\").animate({backgroundColor:\"#88ff88\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")}),jQuery(\"#server_messages > .log_error\").animate({backgroundColor:\"#ff8888\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")})}function get_form(a){for(;\"FORM\"!=a.tagName;){if(\"undefined\"==typeof a)return!1;a=a.parentNode}return a}function check(a,b){if(form_obj=get_form(a),!form_obj)return alert(\"Could not find form\"),!1;for(i=0;i<form_obj.length;)\"checkbox\"==form_obj.elements[i].type&&(form_obj.elements[i].checked=b),i++;return!1}function check_all(a){return target=findTarget(a),check(target,!0),cancelClick(a),!1}function uncheck_all(a){return target=findTarget(a),check(target,!1),cancelClick(a),!1}function cancelClick(a){return window.event&&window.event.returnValue&&(window.event.returnValue=!1),a&&a.preventDefault&&a.preventDefault(),!1}function surround_check(a,b,c){var d=findTarget(a);for(el_form=get_form(d),el_inputs=el_form.getElementsByTagName(\"INPUT\"),i=0;i<el_inputs.length;i++)el_input=el_inputs[i],\"checkbox\"==el_input.type&&(null!=c&&el_input.checked!=c||(el_input.parentNode.className=b))}function surround_unchecked(a){surround_check(a,\"checkbox_surround\",!1)}function surround_checked(a){surround_check(a,\"checkbox_surround\",!0)}function unsurround_all(a){surround_check(a,\"checkbox_surround_init\",null)}function init_check_all(){for(var a=document.getElementsByName(\"check_all_nocheckchanges\"),b=0;b<a.length;b++){var c=a[b];jQuery(c).bind({click:check_all,mouseover:surround_unchecked,mouseout:unsurround_all})}for(var d=document.getElementsByName(\"uncheck_all_nocheckchanges\"),b=0;b<d.length;b++){var c=d[b];jQuery(c).bind({click:uncheck_all,mouseover:surround_checked,mouseout:unsurround_all})}}function clear_form(a){for(a=check(a,!1),i=0;i<a.length;)\"text\"==a.elements[i].type&&(a.elements[i].value=\"\"),i++;return a}function focus_on_first_input(){if(all_inputs=document.getElementsByTagName(\"input\"),all_inputs.length)for(i=0;i<all_inputs.length;i++)if(\"text\"==all_inputs[i].type&&1!=all_inputs[i].disabled){try{all_inputs[i].focus()}catch(a){}break}}function check_combo(a,b,c){\"new\"==b?(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"inline\",input_text.focus()):(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"none\")}function input_decorated_help(a,b){var c=document.getElementById(a),d=function(){\"\"!=c.value&&c.value!=b||(c.style.color=\"#666\",c.value=b)};jQuery(c).bind(\"blur\",d),jQuery(c).bind(\"focus\",function(){c.style.color=\"\",c.value==b&&(c.value=\"\")}),jQuery(c.form).bind(\"submit\",function(){c.value==b&&(c.value=\"\")}),d()}function findTarget(a){var b;if(window.event&&window.event.srcElement?b=window.event.srcElement:a&&a.target&&(b=a.target),!b)return null;for(;b!=document.body&&\"a\"!=b.nodeName.toLowerCase();)b=b.parentNode;return\"a\"!=b.nodeName.toLowerCase()?null:b}function addSpinner(a){a=jQuery(a),a.addClass(\"btn-spinner\"),a.css(\"width\",\"+=24px\")}function check_extracat(a){for(var b=a.value,c=document.getElementsByName(\"post_extracats[]\"),d=0;d<c.length;d++){var e=c[d];e.value==b&&(e.checked=!0)}}function init_dynamicSelect(){for(var a=0;a<nb_dynamicSelects;a++)dynamicSelect(tab_dynamicSelects[a].parent,tab_dynamicSelects[a].child)}function dynamicSelect(a,b){if(document.getElementById&&document.getElementsByTagName){var c=document.getElementById(a),d=document.getElementById(b),e=d.cloneNode(!0),f=e.getElementsByTagName(\"option\");refreshDynamicSelectOptions(c,d,f),c.onchange=function(){refreshDynamicSelectOptions(c,d,f)}}}function refreshDynamicSelectOptions(a,b,c){for(;b.options.length;)b.remove(0);for(var d=new RegExp(\"^\"+a.options[a.selectedIndex].value+\"-.*$\"),e=0;e<c.length;e++)(c[e].value.match(d)||\"\"==c[e].value)&&b.appendChild(c[e].cloneNode(!0))}function toggle_clickopen(a,b,c){if(!(clickdiv=document.getElementById(\"clickdiv_\"+a))||!(clickimg=document.getElementById(\"clickimg_\"+a)))return alert(\"ID \"+a+\" not found!\"),!1;if(\"undefined\"==typeof b&&(b=\"none\"!=clickdiv.style.display),\"undefined\"==typeof c&&(c=\"\"),clickimg=jQuery(clickimg),clickimg.hasClass(\"fa\")||clickimg.hasClass(\"glyphicon\")){if(\"\"!=clickimg.data(\"toggle\")){var d=clickimg.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==clickimg.data(\"toggle-orig-class\")&&clickimg.data(\"toggle-orig-class\",clickimg.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),clickimg.hasClass(clickimg.data(\"toggle-orig-class\"))?clickimg.removeClass(clickimg.data(\"toggle-orig-class\")).addClass(d+\"-\"+clickimg.data(\"toggle\")):clickimg.removeClass(d+\"-\"+clickimg.data(\"toggle\")).addClass(clickimg.data(\"toggle-orig-class\"))}}else{var e=clickimg.css(\"background-position\").match(/-*\\d+/g);clickimg.css(\"background-position\",parseInt(e[0])+(b?16:-16)+\"px \"+parseInt(e[1])+\"px\")}return clickdiv.style.display=b?\"none\":c,!1}function evoFadeSuccess(a){evoFadeBg(a,new Array(\"#ddff00\",\"#bbff00\"))}function evoFadeFailure(a){evoFadeBg(a,new Array(\"#9300ff\",\"#ff000a\",\"#ff0000\"))}function evoFadeHighlight(a){evoFadeBg(a,new Array(\"#ffbf00\",\"#ffe79f\"))}function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css(\"backgroundColor\"),speed=options&&options.speed||'\"slow\"',toEval=\"jQuery(selector).animate({ backgroundColor: \";for(e in bgs)\"string\"==typeof bgs[e]&&(toEval+='\"'+bgs[e]+'\"}, '+speed+\" ).animate({ backgroundColor: \");toEval+=\"origBg }, \"+speed+', \"\", function(){jQuery( this ).css( \"backgroundColor\", \"\" );});',eval(toEval)}function set_new_form_action(a,b){a.attributes.getNamedItem(\"action\").value;a.attributes.getNamedItem(\"action\").value=b;var c=location.href.replace(/(\\/)[^\\/]*$/,\"$1\");return a.attributes.getNamedItem(\"action\").value!=b&&a.attributes.getNamedItem(\"action\").value!=c+b&&(a.action=b,a.attributes.getNamedItem(\"action\").value!=b)?(alert(\"set_new_form_action: Cannot set new form action (Safari workaround).\"),!1):!0}function b2edit_open_preview(a,b){if(\"b2evo_preview\"==a.target)return!1;var c=a.attributes.getNamedItem(\"action\").value;return set_new_form_action(a,b)?(a.target=\"b2evo_preview\",preview_window=window.open(\"\",\"b2evo_preview\"),preview_window.focus(),a.submit(),a.attributes.getNamedItem(\"action\").value=c,a.target=\"_self\",!1):(alert(\"Preview not supported. Sorry. (Could not set form.action for preview)\"),!1)}function b2edit_reload(a,b,c,d,e){if(!set_new_form_action(a,b))return!1;var f=!1;if(a.elements.namedItem(\"actionArray[update]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"edit_switchtab\" />'),f=!0):a.elements.namedItem(\"actionArray[create]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"new_switchtab\" />'),f=!0):(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"switchtab\" />'),f=!0),f&&\"undefined\"!=typeof d)for(param in d)jQuery(a).append('<input type=\"hidden\" name=\"'+param+'\" value=\"'+d[param]+'\" />');return\"undefined\"!=typeof c&&\"undefined\"!=c&&(null==c&&(c=\"\"),a.elements.blog.value=c),window.onbeforeunload=null,\"undefined\"!=typeof e&&1==e&&a.reset(),a.submit(),!1}function b2edit_type(a,b,c){var d=!1;return bozo.nb_changes>0&&(d=!confirm(a)),b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},d)}function b2edit_confirm(a,b,c){return bozo.nb_changes>0&&!confirm(a)?!1:b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},!1)}function makeDragnDrop(a){makeDraggable(a),makeDroppable(a)}function makeDraggable(a){jQuery(a).draggable({helper:\"clone\",scroll:!0,scrollSensitivity:100,zIndex:999,opacity:.8,cursor:\"move\",start:function(){jQuery(this).hide()},stop:function(){jQuery(this).show()}}).addClass(\"draggable_widget\")}function makeDroppable(a){jQuery(a).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(this).hasClass(\"available_widgets\")?jQuery(b.draggable).hasClass(\"new_widget\")||jQuery(b.draggable).remove():jQuery(b.draggable).hasClass(\"new_widget\")?addNewWidget(b.draggable,this):(jQuery(b.draggable).insertAfter(this),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\")),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}function doFade(a){evoFadeSuccess(a)}function sendWidgetOrder(){1>reorder_delay_remaining&&jQuery(\"#server_messages\").html('<div class=\"log_container\"><div class=\"log_error\"></div></div>'),reorder_delay_remaining=reorder_delay,bufferedServerCall()}function sendWidgetOrderCallback(a){doFade(\".server_updating\"),jQuery(\".server_updating\").removeClass(\"server_updating\"),colourWidgets()}function bufferedServerCall(){var a=getWidgetOrder();a!=current_widgets?(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-info fade in\">'+T_(\"Saving changes\")+\"</div></li></ul></div>\"),current_widgets=a,a+=\"&\"+crumb_url,jQuery(\".pending_update\").removeClass(\"pending_update\").addClass(\"server_updating\"),SendAdminRequest(\"widgets\",\"re-order\",a,!1)):(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-warning fade in\">'+T_(\"Widget order unchanged\")+\"</div></li></ul></div>\"),jQuery(\".pending_update\").removeClass(\"pending_update\"),colourWidgets())}function getWidgetOrder(){var a=new Array;jQuery(\".widget_container\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=\"\",jQuery(\"#\"+b+\" .draggable_widget\").each(function(){jQuery(this).attr(\"id\")&&\"undefined\"!=jQuery(this).attr(\"id\")&&(a[b]+=jQuery(this).attr(\"id\")+\", \")})});var b=\"\",c=\"\";for(container in a)b+=container+\"=\"+a[container]+\"&\",c+=container+\",\";var d=(\"undefined\"!=typeof blog?\"blog=\"+blog:\"\")+\"&\"+b+\"container_list=\"+c;return d}function colourWidgets(){jQuery(\".draggable_widget\").removeClass(\"odd\"),jQuery(\".draggable_widget\").removeClass(\"even\");var a=!1;jQuery(\"#current_widgets .draggable_widget\").each(function(){a=!a,jQuery(this).addClass(a?\"even\":\"odd\")})}function deleteWidget(a){return jQuery(\"#wi_ID_\"+a.substr(6,a.length)).animate({backgroundColor:\"#f88\"},\"fast\",function(){jQuery(this).remove(),colourWidgets(),sendWidgetOrder()}),!1}function editWidget(a){return jQuery(\"#server_messages\").html(\"\"),msg=\"wi_ID=\"+a.substr(6,a.length),SendAdminRequest(\"widgets\",\"edit\",msg,!0),!1}function widgetSettings(a,b,c){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeWidgetSettings()\"></div><div id=\"widget_settings\" class=\"modal-content\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#widget_settings\").html(a).addClass(\"widget_settings_active edit_widget_\"+b+\"_\"+c),jQuery(\"#widget_settings\").prepend(jQuery(\"#server_messages\")),AttachServerRequest(\"form\");var d=jQuery(\"#widget_settings\").find(\"h2.page-title:first\");if(d.length>0){var e=jQuery(\"#widget_settings\").find(\"span.pull-right:first\"),f=\"\";e.length>0&&(e.find(\"a.close_link\").remove(),f='<span class=\"pull-right\">'+e.html()+\"</span>\",e.remove()),jQuery(\"#widget_settings\").prepend('<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>'+f+'<h4 class=\"modal-title\">'+d.html()+\"</h4></div>\"),d.remove(),jQuery(\"#widget_settings button.close\").bind(\"click\",closeWidgetSettings)}jQuery(\"#widget_settings a.close_link\").bind(\"click\",closeWidgetSettings);var g=27;jQuery(document).keyup(function(a){a.keyCode==g&&closeWidgetSettings()})}function widgetSettingsCallback(a,b,c){jQuery(\"#wi_ID_\"+a+\" .widget_name\").html(b),jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,c))}function closeWidgetSettings(){return jQuery(\"#widget_settings\").hide(),jQuery(\"#server_messages\").insertBefore(\".available_widgets\"),jQuery(\"#widget_settings\").remove(),jQuery(\"#screen_mask\").remove(),!1}function showMessagesWidgetSettings(){return jQuery(\"#widget_settings\").animate({scrollTop:jQuery(\"#widget_settings\").scrollTop()+ +jQuery(\"#server_messages\").position().top-20},100),!1}function T_(a){return\"undefined\"==typeof T_arr[a]?a:T_arr[a]}function convertAvailableList(){jQuery(\".fieldset_title > span > a[id^='add_new']\").attr(\"href\",\"#\").bind(\"click\",function(a){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeAvailableWidgets()\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),offset=jQuery(this).offset();var b=offset.top,c=jQuery(document).height()-10-jQuery(\".available_widgets\").height();return 20>c&&(c=20),b>c&&(b=c),jQuery(\".available_widgets\").addClass(\"available_widgets_active\").attr(\"id\",\"available_\"+jQuery(this).attr(\"id\")),!1}),jQuery(\".available_widgets_toolbar > a\").bind(\"click\",function(a){return closeAvailableWidgets(),!1});var a=27;jQuery(document).keyup(function(b){return b.keyCode==a?(closeAvailableWidgets(),!1):void 0}),jQuery(\".available_widgets li\").each(function(){jQuery(this).addClass(\"new_widget\");var a=jQuery(this).children(\"a\").attr(\"href\");a=a.substr(a.indexOf(\"&type\")+1,a.length),jQuery(this).children(\"a:first\").attr(\"href\",\"#\").bind(\"click\",function(){return addNewWidget(this,a),!1})})}function closeAvailableWidgets(){jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(\"#screen_mask\").remove()}function addNewWidget(a,b){closeAvailableWidgets();var c=jQuery(a).attr(\"id\");jQuery(a).attr(\"id\",c);var d=(jQuery(a).html(),jQuery(\".available_widgets\").attr(\"id\"));d=d.substr(18,d.length).replace(/_/g,\" \").replace(/-/g,\":\"),SendAdminRequest(\"widgets\",\"create\",b+\"&blog=\"+blog+\"&container=\"+d,!0)}function addNewWidgetCallback(a,b,c,d,e){jQuery(\".fade_me\").removeClass(\"fade_me\"),createWidget(\"wi_ID_\"+a,b.replace(/ /g,\"_\").replace(/:/g,\"-\"),c,d,\"\",1,e),doFade(\"#wi_ID_\"+a),reorder_delay_remaining>0?reorder_delay_remaining=0:current_widgets=getWidgetOrder()}function createWidget(a,b,c,d,e,f,g){var h=jQuery('<li id=\"'+a+'\" class=\"draggable_widget\"><span>'+d+\"</span></li>\");h.find(\"a.widget_name\").click(function(){return editWidget(a)}),e&&jQuery(h).addClass(e),jQuery(h).prepend(jQuery('<span class=\"widget_state\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?enabled_icon_tag:disabled_icon_tag)+\"</a></span>\"));var i=jQuery('<span class=\"widget_cache_status\">'+getWidgetCacheIcon(a,g)+\"</span>\");jQuery(h).prepend(i);var j=jQuery('<span class=\"widget_actions\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?deactivate_icon_tag:activate_icon_tag)+'</a><a href=\"#\" onclick=\"return editWidget( \\''+a+\"' );\\\">\"+edit_icon_tag+'</a><a href=\"#\" onclick=\"return deleteWidget( \\''+a+\"' );\\\">\"+delete_icon_tag+\"</a></span>\");jQuery(h).prepend(j),jQuery(h).prepend(jQuery('<span class=\"widget_checkbox'+(f?\" widget_checkbox_enabled\":\"\")+'\"><input type=\"checkbox\" name=\"widgets[]\" value=\"'+a.replace(\"wi_ID_\",\"\")+'\" /></span>')),jQuery(\"#container_\"+b).append(h),makeDragnDrop(\"#\"+a),colourWidgets()}function toggleWidget(a){return SendAdminRequest(\"widgets\",\"toggle\",\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggle(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_state\").html('<a href=\"#\" class=\"toggle_state\" onclick=\"return toggleWidget( \\'wi_ID_'+a+\"', '\"+crumb_url+\"' );\\\">\"+(b?enabled_icon_tag:disabled_icon_tag)+\"</a>\"),b?jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").addClass(\"widget_checkbox_enabled\"):jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").removeClass(\"widget_checkbox_enabled\"),jQuery(\"#wi_ID_\"+a+\" .toggle_action\").html(b?deactivate_icon_tag:activate_icon_tag),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function toggleCacheWidget(a,b){return SendAdminRequest(\"widgets\",\"cache_\"+b,\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggleCache(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,b)),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function str_repeat(a,b){return new Array(b+1).join(a)}function getWidgetCacheIcon(a,b){switch(b){case\"enabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'disable' );\\\">\"+cache_enabled_icon_tag+\"</a>\";case\"disabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'enable' );\\\">\"+cache_disabled_icon_tag+\"</a>\";case\"disallowed\":return cache_disallowed_icon_tag;case\"denied\":return'<a href=\"?ctrl=coll_settings&amp;tab=advanced&amp;blog='+blog+'#fieldset_wrapper_caching\">'+cache_denied_icon_tag+\"</a>\"}}function openModalWindow(a,b,c,d,e,f,g,h,i){var j=\"undefined\"==typeof b||\"auto\"==b?\"\":\"width:\"+b+\";\",k=\"undefined\"==typeof c||0==c||\"\"==c?\"\":\"height:\"+c,l=k.match(/%$/i)?' style=\"height:100%;overflow:hidden;\"':\"\",m=c.match(/px/i)?' style=\"min-height:'+(c.replace(\"px\",\"\")-157)+'px\"':\"\",n=\"undefined\"==typeof f||0!=f;if(\"undefined\"!=typeof f&&\"\"!=f)if(\"object\"==typeof f)var o=f[0],p=f[1],q=\"undefined\"==typeof f[2]?\"form\":f[2];else var o=f,p=\"btn-primary\",q=\"form\";if(\"undefined\"!=typeof g&&g&&jQuery(\"#modal_window\").remove(),0==jQuery(\"#modal_window\").length){var r='<div id=\"modal_window\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"modal-dialog\" style=\"'+j+k+'\"><div class=\"modal-content\"'+l+\">\";if(\"undefined\"!=typeof e&&\"\"!=e&&(r+='<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button><h4 class=\"modal-title\">'+e+\"</h4></div>\"),r+='<div class=\"modal-body\"'+l+m+\">\"+a,i){jQuery(\"#\"+i);r+=\"<script>jQuery( document ).ready( function() {var iframe = jQuery( '#\"+i+\"' );iframe.on( 'load', function() {iframe.closest( '.modal-body' ).find( 'span.loader_img' ).remove();setModalIFrameUnload( '\"+i+\"' );});});</script>\"}r+=\"</div>\",n&&(r+='<div class=\"modal-footer\">',\"undefined\"!=typeof f&&\"\"!=f&&(r+='<button class=\"btn '+p+'\" type=\"submit\" style=\"display:none\">'+o+\"</button>\"),r+='<button class=\"btn btn-default\" data-dismiss=\"modal\" aria-hidden=\"true\">'+evo_js_lang_close+\"</button></div>\"),r+=\"</div></div></div>\",jQuery(\"body\").append(r)}else jQuery(\"#modal_window .modal-body\").html(a);\"undefined\"!=typeof i?jQuery(\"#\"+i).load(function(){prepareModalWindow(jQuery(this).contents(),q,n,h),jQuery(\"#modal_window .loader_img\").remove(),jQuery(\"#\"+i).show()}):prepareModalWindow(\"#modal_window\",q,n,h);var s={};modal_window_js_initialized&&(s=\"show\"),jQuery(\"#modal_window\").modal(s),\"\"==j&&(jQuery(\"#modal_window .modal-dialog\").css({display:\"table\",width:\"auto\"}),jQuery(\"#modal_window .modal-dialog .modal-content\").css({display:\"table-cell\"})),jQuery(\"#modal_window\").on(\"hidden\",function(){jQuery(this).remove()}),modal_window_js_initialized=!0}function prepareModalWindow(a,b,c,d){c&&(\"undefined\"!=typeof d&&d||(jQuery(\"legend\",a).remove(),jQuery(\"#close_button\",a).remove(),jQuery(\".panel, .panel-body\",a).removeClass(\"panel panel-default panel-body\")),0==jQuery(b+\" input[type=submit]\",a).length?jQuery(\"#modal_window .modal-footer button[type=submit]\").hide():(jQuery(b+\" input[type=submit]\",a).hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()),jQuery(b,a).change(function(){var a=jQuery(this).find(\"input[type=submit]\");a.length>0?(a.hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()):jQuery(\"#modal_window .modal-footer button[type=submit]\").hide()}),jQuery(\"#modal_window .modal-footer button[type=submit]\").click(function(){jQuery(b+\" input[type=submit]\",a).click()})),jQuery(b+\" a.btn\",a).each(function(){jQuery(\"#modal_window .modal-footer\").prepend(\"<a href=\"+jQuery(this).attr(\"href\")+'><button type=\"button\" class=\"'+jQuery(this).attr(\"class\")+'\">'+jQuery(this).html()+\"</button></a>\"),jQuery(this).remove()}),jQuery(b+\" #current_modal_title\",a).length>0&&jQuery(\"#modal_window .modal-title\").html(jQuery(b+\" #current_modal_title\",a).html())}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#modal_window\",a).remove(),!1}function setModalIFrameUnload(a){var b=jQuery(\"#\"+a);b[0].contentWindow.onunload=function(){var a=b.closest(\".modal-body\"),c=jQuery('<span class=\"loader_img absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>');jQuery(a).prepend(c)}}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_deldata(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"],!0),jQuery.ajax({type:\"POST\",url:evo_js_user_deldata_ajax_url,data:{ctrl:\"user\",user_tab:\"deldata\",user_tab_from:b,user_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"])}}),!1}function user_add_org(a){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"add_user\",org_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add),jQuery(\"input.autocomplete_login\").trigger(\"added\")}}),!1}function user_edit(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"edit_user\",org_ID:a,user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit)}}),!1}function user_remove(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"remove_user\",user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height();b>a&&jQuery(\"#attachments_fieldset_wrapper\").height(jQuery(\"#attachments_fieldset_table\").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+\"async.php?action=set_object_link_position&link_ID=\"+a.id.substr(17)+\"&link_position=\"+e+\"&crumb_link=\"+c,{},function(b,c){b=ajax_debug_clear(b),\"OK\"==b?(evoFadeSuccess(jQuery(d).closest(\"tr\")),jQuery(d).closest(\"td\").removeClass(\"error\"),\"cover\"==e&&jQuery(\"select[name=link_position][id!=\"+a.id+\"] option[value=cover]:selected\").each(function(){jQuery(this).parent().val(\"aftermore\"),evoFadeSuccess(jQuery(this).closest(\"tr\"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest(\"tr\")),jQuery(d.form).closest(\"td\").addClass(\"error\"))}),!1}function evo_link_insert_inline(a,b,c){if(\"undefined\"!=typeof b2evoCanvas){var d=\"[\"+a+\":\"+b;c.length&&(d+=\":\"+c),d+=\"]\",textarea_wrap_selection(b2evoCanvas,d,\"\",0,window.document);var e=jQuery(\"#display_position_\"+b);0!=e.length&&\"inline\"!=e.val()&&(deferInlineReminder=!0,e.val(\"inline\").change(),deferInlineReminder=!1)}}function evo_link_delete(a,b,c,d){return evo_rest_api_request(\"links/\"+c,{action:d},function(d){if(\"item\"==b){var e=window.document.getElementById(\"itemform_post_content\");if(null!=e){var f=new RegExp(\"\\\\[(image|file|inline|video|audio):\"+c+\":?[^\\\\]]*\\\\]\",\"ig\");textarea_str_replace(e,f,\"\",window.document)}}jQuery(a).closest(\"tr\").remove(),evo_link_fix_wrapper_height()},\"DELETE\"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request(\"links/\"+b+\"/\"+c,function(b){var d=jQuery(a).closest(\"tr\");\"move_up\"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},\"POST\"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request(\"links\",{action:\"attach\",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery(\"#attachments_fieldset_table table\",window.parent.document);b.length>0&&\"undefined\"!=typeof a.link&&b.append('<tr><td class=\"firstcol shrinkwrap\">'+a.link.preview+'</td><td class=\"fm_filename\">'+a.link.url+'</td><td class=\"shrinkwrap link_id_cell\">'+a.link.ID+'</td><td class=\"shrinkwrap\">'+a.link.actions+'</td><td class=\"lastcol shrinkwrap\">'+a.link.position+\"</td></tr>\");\n-}),!1}function evo_link_ajax_loading_overlay(){var a=jQuery(\"#attachments_fieldset_table\"),b=!1;return 0==a.find(\".results_ajax_loading\").length&&(b=jQuery('<div class=\"results_ajax_loading\"><div>&nbsp;</div></div>'),a.css(\"position\",\"relative\"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request(\"links\",{action:\"undefined\"==typeof c?\"refresh\":\"sort\",type:a,object_ID:b},function(a){jQuery(\"#attachments_fieldset_table\").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}b2evo_Callbacks.prototype={register_callback:function(a,b,c){\"undefined\"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=new Array),\"undefined\"!=typeof c&&c?this.eventHandlers[a][0]=b:this.eventHandlers[a][this.eventHandlers[a].length]=b},trigger_callback:function(event,args){if(\"undefined\"==typeof this.eventHandlers[event])return null;for(var r=!1,cb_args=\"\",cb_arguments=arguments,i=1;i<arguments.length;i++)cb_args+=\"cb_arguments[\"+i+\"], \";cb_args.length&&(cb_args=cb_args.substring(0,cb_args.length-2));for(var i=0;i<this.eventHandlers[event].length;i++){var f=this.eventHandlers[event][i];r=eval(\"f(\"+cb_args+\");\")||r}return r}};var b2evo_Callbacks=new b2evo_Callbacks;evo_alert_events_initialized=!1,jQuery(document).ready(function(){function a(a){var b=a.data(\"prefix\")?a.data(\"prefix\"):\"\",c=jQuery(\".\"+b+a.val()+\"_toolbar\");return 0==c.length?!0:void(a.is(\":checked\")?(c.removeClass(\"disabled\"),c.find(\"input[type=button]\").removeAttr(\"disabled\")):(c.addClass(\"disabled\"),c.find(\"input[type=button]\").attr(\"disabled\",\"disabled\")))}jQuery(document).on(\"click\",\"[data-func]\",function(){var a=jQuery(this).data(\"func\").match(/([^\\\\|]|\\\\\\|)+/g),b=a[0];a.splice(0,1);for(var c=0;c<a.length;c++)a[c].indexOf(\"b2evoCanvas\")>-1?a[c]=window[a[c]]:\" \"==a[c]?a[c]=\"\":a[c]=a[c].replace(/\\\\\\|/g,\"|\");return jQuery(this).closest(\".disabled[class*=_toolbar]\").length>0?!1:(window[b].apply(null,a),!1)}),jQuery('input[type=checkbox][name=\"renderers[]\"]').each(function(){a(jQuery(this))}),jQuery('input[type=checkbox][name=\"renderers[]\"]').click(function(){a(jQuery(this))})}),jQuery(document).ready(function(){jQuery(\".pblock\").length?jQuery('<div id=\"server_messages\"></div>').prependTo(\".pblock\"):jQuery(\".level2\").length?jQuery(\".level2\").after('<div id=\"server_messages\"></div>'):jQuery(\".navbar.level1\").after('<div id=\"server_messages\"></div>'),jQuery('<iframe id=\"server_postback\" name=\"server_postback\"></iframe>').appendTo(\"body\").css({position:\"absolute\",left:\"-1000em\",top:\"-1000em\"})});var _b2evoCommunications=function(){var a,b,c=2500,d=250;return{Init:function(){var e=jQuery.fn.extend({delay:c,interval:d,dispatcher:b},arguments.length?arguments[0]:\"\");c=e.delay,d=e.interval,b=e.dispatcher,a=this,b2evoHelper.info(\"Communications object ready\")},BufferedServerCall:function(){var b=jQuery.fn.extend({ticker_callback:function(){return!0},send_callback:function(){},delay:c,interval:d,buffer_name:\"\"},arguments.length?arguments[0]:\"\");if(ticker_status=b.ticker_callback(b.delay))switch(ticker_status!==!0&&b2evoHelper.log(\"Ticker status : \"+ticker_status),ticker_status){case\"cancel\":return void b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Update cancelled\")+\"</div>\");case\"pause\":return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Update Paused\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);case\"ignore\":return void a.BufferedServerLoop(b);case\"immediate\":break;default:if(b.delay-=b.interval,b.delay>0)return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Changes pending\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Saving changes\")+\"</div>\"),b.send_callback()}},BufferedServerLoop:function(b){var c=jQuery(a).data(\"buffers\");\"undefined\"==typeof c&&(c=Array()),c[b.buffer_name]=b,jQuery(a).data(\"buffers\",c),window.setTimeout('b2evoCommunications.BufferedServerCallback( \"'+b.buffer_name+'\" )',b.interval)},BufferedServerCallback:function(b){var c=jQuery(a).data(\"buffers\");a.BufferedServerCall(c[b])},SendAdminRequest:function(){var c=jQuery.fn.extend({ctrl:\"\",action:\"\",data:\"\",key:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\"),d=\"ctrl=\"+c.ctrl+\"&key=\"+c.key+\"&action=\"+c.action+\"&\"+c.data;a.SendServerRequest({url:b,data:d,error:c.error,ok:c.ok})},SendServerRequest:function(){var a=jQuery.fn.extend({url:\"\",data:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\");if(a.url){a.url+=(a.url.indexOf(\"?\")===!0?\"&\":\"?\")+\"mode=js\",a.data&&(a.url+=\"&\"+a.data);var b=jQuery('<script type=\"text/javascript\"></script>');b.attr(\"src\",a.url),b.load(a.ok()),b.error(a.error()),b.appendTo(\"body\"),b2evoHelper.log(\"Sending request : \"+a.url)}}}},b2evoCommunications=new _b2evoCommunications;jQuery(document).ready(function(){jQuery(\"[id^=fadeout-]\").each(function(){evoFadeBg(this,new Array(\"#FFFF33\"),{speed:3e3})})}),jQuery(document).on(\"change\",\".btn-file :file\",function(){var a=jQuery(this).val().replace(/\\\\/g,\"/\").replace(/.*\\//,\"\");jQuery(this).parent().next().html(a)});var edit_icon_tag=\"\",delete_icon_tag=\"\",current_widgets=\"\",reorder_widgets_queue,reorder_delay=200,reorder_delay_remaining=0,crumb_url=\"\";jQuery(document).ready(function(){if(0!=jQuery(\"#current_widgets\").length){edit_icon_tag=jQuery(\".edit_icon_hook\").find(\"a\").html(),delete_icon_tag=jQuery(\".delete_icon_hook\").find(\"a\").html(),crumb_url=jQuery(\".delete_icon_hook\").find(\"a\").attr(\"href\"),\"undefined\"!=typeof crumb_url&&(crumb_url=crumb_url.match(/crumb_.*?$/)),jQuery(\".new_widget\").parent().parent().remove(),jQuery(\".odd\").addClass(\"widget_row\").removeClass(\".odd\"),jQuery(\".even\").addClass(\"widget_row\").removeClass(\".even\"),jQuery(\".fieldset_title\").each(function(){jQuery(this).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(b.draggable).prependTo(jQuery(\"#container_\"+jQuery(this).find(\".container_name\").html().replace(/ /g,\"_\").replace(/:/g,\"-\"))),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\"),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}),jQuery(\".widget_row td:nth-child(7)\").each(function(){var a=jQuery(this).find(\"a\").attr(\"href\");a=a.match(/wi_ID=([0-9]+)/)[1],jQuery(this).parent().attr(\"id\",\"wi_ID_\"+a)});var a=new Array;jQuery(\".widget_container_list\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=new Array,jQuery(\"#\"+b+\" .widget_row\").each(function(){var c=jQuery(this).attr(\"id\");a[b][c]=new Array,a[b][c].name=jQuery(\"#\"+c).find(\".widget_name\").parent().html(),a[b][c][\"class\"]=jQuery(this).attr(\"className\"),a[b][c].enabled=jQuery(\"#\"+c+\" .widget_is_enabled\").size(),a[b][c].cache=jQuery(\"#\"+c+\" .widget_cache_status [rel]\").attr(\"rel\")})});for(container in a){var b=!jQuery(\"#\"+container).hasClass(\"no-drop\");newContainer=jQuery('<ul id=\"container_'+container+'\" class=\"widget_container\"></ul>'),b||jQuery(newContainer).addClass(\"no-drop\"),jQuery(\"#\"+container).replaceWith(newContainer);for(widget in a[container])createWidget(widget,container,0,a[container][widget].name,a[container][widget][\"class\"],a[container][widget].enabled,a[container][widget].cache)}jQuery(\".no-drop .draggable_widget\").droppable(\"disable\"),jQuery(\".draggable_widget\").bind(\"mousedown\",function(){jQuery(this).hasClass(\"new_widget\")||jQuery(\".available_widgets_active\").removeClass(\"available_widgets_active\")}),colourWidgets(),convertAvailableList(),current_widgets=getWidgetOrder(),doFade(\".fadeout-ffff00\"),jQuery(\"#widget_button_check_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!0)}),jQuery(\"#widget_button_uncheck_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_active\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!0),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_inactive\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!1),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!0)})}});var modal_window_js_initialized=!1;jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).ready(function(){var a=jQuery(\"#attachments_fieldset_table\").height();a=a>320?320:97>a?97:a,jQuery(\"#attachments_fieldset_wrapper\").height(a),jQuery(\"#attachments_fieldset_wrapper\").resizable({minHeight:80,handles:\"s\",resize:function(a,b){jQuery(\"#attachments_fieldset_wrapper\").resizable(\"option\",\"maxHeight\",jQuery(\"#attachments_fieldset_table\").height())}}),jQuery(document).on(\"click\",\"#attachments_fieldset_wrapper .ui-resizable-handle\",function(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height()+80;jQuery(\"#attachments_fieldset_wrapper\").css(\"height\",b>a?a:b)})});\n\\ No newline at end of file\n+function pop_up_window(a,b,c,d,e){\"undefined\"==typeof c&&(c=750),\"undefined\"==typeof d&&(d=550);var f=(screen.width-c)/2,g=(screen.height-d)/2;return\"undefined\"==typeof e&&(e=\"scrollbars=yes, status=yes, resizable=yes, menubar=yes\"),e=\"width=\"+c+\", height=\"+d+\", left=\"+f+\", top=\"+g+\", \"+e,opened=window.open(a,b,e),opened.focus(),\"undefined\"==typeof openedWindows?openedWindows=new Array(opened):openedWindows.push(opened),!1}function textarea_replace_selection(a,b,c){textarea_wrap_selection(a,b,\"\",1,c)}function textarea_wrap_selection(a,b,c,d,e){e=e||document;var f={element:a,before:b,after:c,replace:d,target_document:e};if(!b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f))return}catch(g){}if(!(window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)))if(e.selection)a.focus(),sel=e.selection.createRange(),d?sel.text=b+c:sel.text=b+sel.text+c,a.focus();else if(a.selectionStart||\"0\"==a.selectionStart){var h,i,j,k=a.selectionStart,l=a.selectionEnd;\"textarea\"==a.type&&\"undefined\"!=typeof a.scrollTop&&(i=a.scrollTop,j=a.scrollLeft),d?(a.value=a.value.substring(0,k)+b+c+a.value.substring(l,a.value.length),h=k+b.length+c.length):(a.value=a.value.substring(0,k)+b+a.value.substring(k,l)+c+a.value.substring(l,a.value.length),h=l+b.length+c.length),\"undefined\"!=typeof i&&(a.scrollTop=i,a.scrollLeft=j),a.focus(),a.selectionStart=h,a.selectionEnd=h}else a.value+=b+c,a.focus()}}function textarea_str_replace(a,b,c,d){d=d||document;var e={element:a,search:b,replace:c,target_document:d};if(!b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e))return}catch(f){}window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)||(a.value=a.value.replace(b,c),a.focus())}}function toggle_filter_area(a){var b=jQuery(\"#clickdiv_\"+a),c=jQuery(\"#clickimg_\"+a);if(0==b.length||0==c.length)return alert(\"ID \"+a+\" not found!\"),!1;if(c.hasClass(\"fa\")||c.hasClass(\"glyphicon\")){if(\"\"!=c.data(\"toggle\")&&void 0!=c.data(\"toggle\")){var d=c.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==c.data(\"toggle-orig-class\")&&c.data(\"toggle-orig-class\",c.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),c.hasClass(c.data(\"toggle-orig-class\"))?c.removeClass(c.data(\"toggle-orig-class\")).addClass(d+\"-\"+c.data(\"toggle\")):c.removeClass(d+\"-\"+c.data(\"toggle\")).addClass(c.data(\"toggle-orig-class\"))}}else{var e=c.css(\"background-position\").match(/-*\\d+/g);c.css(\"background-position\",parseInt(e[0])+(b.is(\":hidden\")?-16:16)+\"px \"+parseInt(e[1])+\"px\")}return b.is(\":hidden\")?(b.slideDown(500),jQuery.post(htsrv_url+\"anon_async.php?action=expand_filter&target=\"+a)):(b.slideUp(500),jQuery.post(htsrv_url+\"anon_async.php?action=collapse_filter&target=\"+a)),!1}function b2evo_Callbacks(){this.eventHandlers=new Array}function evoAlert(a){var b=jQuery(\".b2evo_alert\");b.length>0&&b.remove(),jQuery(\"body\").append('<div class=\"b2evo_alert\">'+a+\"</div>\"),setTimeout(function(){jQuery(\".b2evo_alert\").fadeOut({complete:function(){jQuery(this).remove()}})},3e3),evo_alert_events_initialized||(evo_alert_events_initialized=!0,jQuery(document).on(\"click\",\".b2evo_alert\",function(){jQuery(this).remove()}))}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}function SendAdminRequest(a,b,c,d){if(void 0===d||d){var e=new Date;c+=(\"\"!==c?\"&\":\"\")+\"nocache_dummy=\"+e.getTime()}SendServerRequest(b2evo_dispatcher_url+\"?ctrl=\"+a+\"&action=\"+b+(c?\"&\"+c:\"\"))}function SendServerRequest(a){a+=-1!=a.indexOf(\"?\")?\"&\":\"?\",a+=\"display_mode=js\";var b=a.split(\"?\");a=b[0],b=b[1],jQuery.ajax({type:\"POST\",url:a,data:b,dataType:\"script\"})}function AttachServerRequest(a){jQuery('<input type=\"hidden\" name=\"display_mode\" value=\"js\" /><input type=\"hidden\" name=\"js_target\" value=\"window.parent.\" />').appendTo(\"#\"+a),jQuery(\"#\"+a).attr(\"target\",\"server_postback\")}function DisplayServerMessages(a,b){jQuery(\"#server_messages\").html(a),\"object\"==typeof b&&(jQuery(\"input.field_error, select.field_error, textarea.field_error\").each(function(){jQuery(this).removeClass(\"field_error\");var a=jQuery(this).next();a.hasClass(\"notes\")&&\"SPAN\"==a.get(0).tagName&&a.remove()}),jQuery.each(b,function(a,b){jQuery(\"#\"+a).addClass(\"field_error\").after('<span class=\"oneline notes\"> <span class=\"field_error\" rel=\"'+a+'\">'+b+\"</span></span>\")})),jQuery(\"#server_messages .log_success\").animate({backgroundColor:\"#88ff88\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")}),jQuery(\"#server_messages > .log_error\").animate({backgroundColor:\"#ff8888\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")})}function get_form(a){for(;\"FORM\"!=a.tagName;){if(\"undefined\"==typeof a)return!1;a=a.parentNode}return a}function check(a,b){if(form_obj=get_form(a),!form_obj)return alert(\"Could not find form\"),!1;for(i=0;i<form_obj.length;)\"checkbox\"==form_obj.elements[i].type&&(form_obj.elements[i].checked=b),i++;return!1}function check_all(a){return target=findTarget(a),check(target,!0),cancelClick(a),!1}function uncheck_all(a){return target=findTarget(a),check(target,!1),cancelClick(a),!1}function cancelClick(a){return window.event&&window.event.returnValue&&(window.event.returnValue=!1),a&&a.preventDefault&&a.preventDefault(),!1}function surround_check(a,b,c){var d=findTarget(a);for(el_form=get_form(d),el_inputs=el_form.getElementsByTagName(\"INPUT\"),i=0;i<el_inputs.length;i++)el_input=el_inputs[i],\"checkbox\"==el_input.type&&(null!=c&&el_input.checked!=c||(el_input.parentNode.className=b))}function surround_unchecked(a){surround_check(a,\"checkbox_surround\",!1)}function surround_checked(a){surround_check(a,\"checkbox_surround\",!0)}function unsurround_all(a){surround_check(a,\"checkbox_surround_init\",null)}function init_check_all(){for(var a=document.getElementsByName(\"check_all_nocheckchanges\"),b=0;b<a.length;b++){var c=a[b];jQuery(c).bind({click:check_all,mouseover:surround_unchecked,mouseout:unsurround_all})}for(var d=document.getElementsByName(\"uncheck_all_nocheckchanges\"),b=0;b<d.length;b++){var c=d[b];jQuery(c).bind({click:uncheck_all,mouseover:surround_checked,mouseout:unsurround_all})}}function clear_form(a){for(a=check(a,!1),i=0;i<a.length;)\"text\"==a.elements[i].type&&(a.elements[i].value=\"\"),i++;return a}function focus_on_first_input(){if(all_inputs=document.getElementsByTagName(\"input\"),all_inputs.length)for(i=0;i<all_inputs.length;i++)if(\"text\"==all_inputs[i].type&&1!=all_inputs[i].disabled){try{all_inputs[i].focus()}catch(a){}break}}function check_combo(a,b,c){\"new\"==b?(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"inline\",input_text.focus()):(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"none\")}function input_decorated_help(a,b){var c=document.getElementById(a),d=function(){\"\"!=c.value&&c.value!=b||(c.style.color=\"#666\",c.value=b)};jQuery(c).bind(\"blur\",d),jQuery(c).bind(\"focus\",function(){c.style.color=\"\",c.value==b&&(c.value=\"\")}),jQuery(c.form).bind(\"submit\",function(){c.value==b&&(c.value=\"\")}),d()}function findTarget(a){var b;if(window.event&&window.event.srcElement?b=window.event.srcElement:a&&a.target&&(b=a.target),!b)return null;for(;b!=document.body&&\"a\"!=b.nodeName.toLowerCase();)b=b.parentNode;return\"a\"!=b.nodeName.toLowerCase()?null:b}function addSpinner(a){a=jQuery(a),a.addClass(\"btn-spinner\"),a.css(\"width\",\"+=24px\")}function check_extracat(a){for(var b=a.value,c=document.getElementsByName(\"post_extracats[]\"),d=0;d<c.length;d++){var e=c[d];e.value==b&&(e.checked=!0)}}function init_dynamicSelect(){for(var a=0;a<nb_dynamicSelects;a++)dynamicSelect(tab_dynamicSelects[a].parent,tab_dynamicSelects[a].child)}function dynamicSelect(a,b){if(document.getElementById&&document.getElementsByTagName){var c=document.getElementById(a),d=document.getElementById(b),e=d.cloneNode(!0),f=e.getElementsByTagName(\"option\");refreshDynamicSelectOptions(c,d,f),c.onchange=function(){refreshDynamicSelectOptions(c,d,f)}}}function refreshDynamicSelectOptions(a,b,c){for(;b.options.length;)b.remove(0);for(var d=new RegExp(\"^\"+a.options[a.selectedIndex].value+\"-.*$\"),e=0;e<c.length;e++)(c[e].value.match(d)||\"\"==c[e].value)&&b.appendChild(c[e].cloneNode(!0))}function toggle_clickopen(a,b,c){if(!(clickdiv=document.getElementById(\"clickdiv_\"+a))||!(clickimg=document.getElementById(\"clickimg_\"+a)))return alert(\"ID \"+a+\" not found!\"),!1;if(\"undefined\"==typeof b&&(b=\"none\"!=clickdiv.style.display),\"undefined\"==typeof c&&(c=\"\"),clickimg=jQuery(clickimg),clickimg.hasClass(\"fa\")||clickimg.hasClass(\"glyphicon\")){if(\"\"!=clickimg.data(\"toggle\")){var d=clickimg.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==clickimg.data(\"toggle-orig-class\")&&clickimg.data(\"toggle-orig-class\",clickimg.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),clickimg.hasClass(clickimg.data(\"toggle-orig-class\"))?clickimg.removeClass(clickimg.data(\"toggle-orig-class\")).addClass(d+\"-\"+clickimg.data(\"toggle\")):clickimg.removeClass(d+\"-\"+clickimg.data(\"toggle\")).addClass(clickimg.data(\"toggle-orig-class\"))}}else{var e=clickimg.css(\"background-position\").match(/-*\\d+/g);clickimg.css(\"background-position\",parseInt(e[0])+(b?16:-16)+\"px \"+parseInt(e[1])+\"px\")}return clickdiv.style.display=b?\"none\":c,!1}function evoFadeSuccess(a){evoFadeBg(a,new Array(\"#ddff00\",\"#bbff00\"))}function evoFadeFailure(a){evoFadeBg(a,new Array(\"#9300ff\",\"#ff000a\",\"#ff0000\"))}function evoFadeHighlight(a){evoFadeBg(a,new Array(\"#ffbf00\",\"#ffe79f\"))}function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css(\"backgroundColor\"),speed=options&&options.speed||'\"slow\"',toEval=\"jQuery(selector).animate({ backgroundColor: \";for(e in bgs)\"string\"==typeof bgs[e]&&(toEval+='\"'+bgs[e]+'\"}, '+speed+\" ).animate({ backgroundColor: \");toEval+=\"origBg }, \"+speed+', \"\", function(){jQuery( this ).css( \"backgroundColor\", \"\" );});',eval(toEval)}function set_new_form_action(a,b){a.attributes.getNamedItem(\"action\").value;a.attributes.getNamedItem(\"action\").value=b;var c=location.href.replace(/(\\/)[^\\/]*$/,\"$1\");return a.attributes.getNamedItem(\"action\").value!=b&&a.attributes.getNamedItem(\"action\").value!=c+b&&(a.action=b,a.attributes.getNamedItem(\"action\").value!=b)?(alert(\"set_new_form_action: Cannot set new form action (Safari workaround).\"),!1):!0}function b2edit_open_preview(a,b){if(\"b2evo_preview\"==a.target)return!1;var c=a.attributes.getNamedItem(\"action\").value;return set_new_form_action(a,b)?(a.target=\"b2evo_preview\",preview_window=window.open(\"\",\"b2evo_preview\"),preview_window.focus(),a.submit(),a.attributes.getNamedItem(\"action\").value=c,a.target=\"_self\",!1):(alert(\"Preview not supported. Sorry. (Could not set form.action for preview)\"),!1)}function b2edit_reload(a,b,c,d,e){if(!set_new_form_action(a,b))return!1;var f=!1;if(a.elements.namedItem(\"actionArray[update]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"edit_switchtab\" />'),f=!0):a.elements.namedItem(\"actionArray[create]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"new_switchtab\" />'),f=!0):(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"switchtab\" />'),f=!0),f&&\"undefined\"!=typeof d)for(param in d)jQuery(a).append('<input type=\"hidden\" name=\"'+param+'\" value=\"'+d[param]+'\" />');return\"undefined\"!=typeof c&&\"undefined\"!=c&&(null==c&&(c=\"\"),a.elements.blog.value=c),window.onbeforeunload=null,\"undefined\"!=typeof e&&1==e&&a.reset(),a.submit(),!1}function b2edit_type(a,b,c){var d=!1;return bozo.nb_changes>0&&(d=!confirm(a)),b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},d)}function b2edit_confirm(a,b,c){return bozo.nb_changes>0&&!confirm(a)?!1:b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},!1)}function makeDragnDrop(a){makeDraggable(a),makeDroppable(a)}function makeDraggable(a){jQuery(a).draggable({helper:\"clone\",scroll:!0,scrollSensitivity:100,zIndex:999,opacity:.8,cursor:\"move\",start:function(){jQuery(this).hide()},stop:function(){jQuery(this).show()}}).addClass(\"draggable_widget\")}function makeDroppable(a){jQuery(a).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(this).hasClass(\"available_widgets\")?jQuery(b.draggable).hasClass(\"new_widget\")||jQuery(b.draggable).remove():jQuery(b.draggable).hasClass(\"new_widget\")?addNewWidget(b.draggable,this):(jQuery(b.draggable).insertAfter(this),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\")),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}function doFade(a){evoFadeSuccess(a)}function sendWidgetOrder(){1>reorder_delay_remaining&&jQuery(\"#server_messages\").html('<div class=\"log_container\"><div class=\"log_error\"></div></div>'),reorder_delay_remaining=reorder_delay,bufferedServerCall()}function sendWidgetOrderCallback(a){doFade(\".server_updating\"),jQuery(\".server_updating\").removeClass(\"server_updating\"),colourWidgets()}function bufferedServerCall(){var a=getWidgetOrder();a!=current_widgets?(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-info fade in\">'+T_(\"Saving changes\")+\"</div></li></ul></div>\"),current_widgets=a,a+=\"&\"+crumb_url,jQuery(\".pending_update\").removeClass(\"pending_update\").addClass(\"server_updating\"),SendAdminRequest(\"widgets\",\"re-order\",a,!1)):(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-warning fade in\">'+T_(\"Widget order unchanged\")+\"</div></li></ul></div>\"),jQuery(\".pending_update\").removeClass(\"pending_update\"),colourWidgets())}function getWidgetOrder(){var a=new Array;jQuery(\".widget_container\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=\"\",jQuery(\"#\"+b+\" .draggable_widget\").each(function(){jQuery(this).attr(\"id\")&&\"undefined\"!=jQuery(this).attr(\"id\")&&(a[b]+=jQuery(this).attr(\"id\")+\", \")})});var b=\"\",c=\"\";for(container in a)b+=container+\"=\"+a[container]+\"&\",c+=container+\",\";var d=(\"undefined\"!=typeof blog?\"blog=\"+blog:\"\")+\"&\"+b+\"container_list=\"+c;return d}function colourWidgets(){jQuery(\".draggable_widget\").removeClass(\"odd\"),jQuery(\".draggable_widget\").removeClass(\"even\");var a=!1;jQuery(\"#current_widgets .draggable_widget\").each(function(){a=!a,jQuery(this).addClass(a?\"even\":\"odd\")})}function deleteWidget(a){return jQuery(\"#wi_ID_\"+a.substr(6,a.length)).animate({backgroundColor:\"#f88\"},\"fast\",function(){jQuery(this).remove(),colourWidgets(),sendWidgetOrder()}),!1}function editWidget(a){return jQuery(\"#server_messages\").html(\"\"),msg=\"wi_ID=\"+a.substr(6,a.length),SendAdminRequest(\"widgets\",\"edit\",msg,!0),!1}function widgetSettings(a,b,c){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeWidgetSettings()\"></div><div id=\"widget_settings\" class=\"modal-content\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#widget_settings\").html(a).addClass(\"widget_settings_active edit_widget_\"+b+\"_\"+c),jQuery(\"#widget_settings\").prepend(jQuery(\"#server_messages\")),AttachServerRequest(\"form\");var d=jQuery(\"#widget_settings\").find(\"h2.page-title:first\");if(d.length>0){var e=jQuery(\"#widget_settings\").find(\"span.pull-right:first\"),f=\"\";e.length>0&&(e.find(\"a.close_link\").remove(),f='<span class=\"pull-right\">'+e.html()+\"</span>\",e.remove()),jQuery(\"#widget_settings\").prepend('<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>'+f+'<h4 class=\"modal-title\">'+d.html()+\"</h4></div>\"),d.remove(),jQuery(\"#widget_settings button.close\").bind(\"click\",closeWidgetSettings)}jQuery(\"#widget_settings a.close_link\").bind(\"click\",closeWidgetSettings);var g=27;jQuery(document).keyup(function(a){a.keyCode==g&&closeWidgetSettings()})}function widgetSettingsCallback(a,b,c){jQuery(\"#wi_ID_\"+a+\" .widget_name\").html(b),jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,c))}function closeWidgetSettings(){return jQuery(\"#widget_settings\").hide(),jQuery(\"#server_messages\").insertBefore(\".available_widgets\"),jQuery(\"#widget_settings\").remove(),jQuery(\"#screen_mask\").remove(),!1}function showMessagesWidgetSettings(){return jQuery(\"#widget_settings\").animate({scrollTop:jQuery(\"#widget_settings\").scrollTop()+ +jQuery(\"#server_messages\").position().top-20},100),!1}function T_(a){return\"undefined\"==typeof T_arr[a]?a:T_arr[a]}function convertAvailableList(){jQuery(\".fieldset_title > span > a[id^='add_new']\").attr(\"href\",\"#\").bind(\"click\",function(a){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeAvailableWidgets()\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),offset=jQuery(this).offset();var b=offset.top,c=jQuery(document).height()-10-jQuery(\".available_widgets\").height();return 20>c&&(c=20),b>c&&(b=c),jQuery(\".available_widgets\").addClass(\"available_widgets_active\").attr(\"id\",\"available_\"+jQuery(this).attr(\"id\")),!1}),jQuery(\".available_widgets_toolbar > a\").bind(\"click\",function(a){return closeAvailableWidgets(),!1});var a=27;jQuery(document).keyup(function(b){return b.keyCode==a?(closeAvailableWidgets(),!1):void 0}),jQuery(\".available_widgets li\").each(function(){jQuery(this).addClass(\"new_widget\");var a=jQuery(this).children(\"a\").attr(\"href\");a=a.substr(a.indexOf(\"&type\")+1,a.length),jQuery(this).children(\"a:first\").attr(\"href\",\"#\").bind(\"click\",function(){return addNewWidget(this,a),!1})})}function closeAvailableWidgets(){jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(\"#screen_mask\").remove()}function addNewWidget(a,b){closeAvailableWidgets();var c=jQuery(a).attr(\"id\");jQuery(a).attr(\"id\",c);var d=(jQuery(a).html(),jQuery(\".available_widgets\").attr(\"id\"));d=d.substr(18,d.length).replace(/_/g,\" \").replace(/-/g,\":\"),SendAdminRequest(\"widgets\",\"create\",b+\"&blog=\"+blog+\"&container=\"+d,!0)}function addNewWidgetCallback(a,b,c,d,e){jQuery(\".fade_me\").removeClass(\"fade_me\"),createWidget(\"wi_ID_\"+a,b.replace(/ /g,\"_\").replace(/:/g,\"-\"),c,d,\"\",1,e),doFade(\"#wi_ID_\"+a),reorder_delay_remaining>0?reorder_delay_remaining=0:current_widgets=getWidgetOrder()}function createWidget(a,b,c,d,e,f,g){var h=jQuery('<li id=\"'+a+'\" class=\"draggable_widget\"><span>'+d+\"</span></li>\");h.find(\"a.widget_name\").click(function(){return editWidget(a)}),e&&jQuery(h).addClass(e),jQuery(h).prepend(jQuery('<span class=\"widget_state\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?enabled_icon_tag:disabled_icon_tag)+\"</a></span>\"));var i=jQuery('<span class=\"widget_cache_status\">'+getWidgetCacheIcon(a,g)+\"</span>\");jQuery(h).prepend(i);var j=jQuery('<span class=\"widget_actions\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?deactivate_icon_tag:activate_icon_tag)+'</a><a href=\"#\" onclick=\"return editWidget( \\''+a+\"' );\\\">\"+edit_icon_tag+'</a><a href=\"#\" onclick=\"return deleteWidget( \\''+a+\"' );\\\">\"+delete_icon_tag+\"</a></span>\");jQuery(h).prepend(j),jQuery(h).prepend(jQuery('<span class=\"widget_checkbox'+(f?\" widget_checkbox_enabled\":\"\")+'\"><input type=\"checkbox\" name=\"widgets[]\" value=\"'+a.replace(\"wi_ID_\",\"\")+'\" /></span>')),jQuery(\"#container_\"+b).append(h),makeDragnDrop(\"#\"+a),colourWidgets()}function toggleWidget(a){return SendAdminRequest(\"widgets\",\"toggle\",\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggle(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_state\").html('<a href=\"#\" class=\"toggle_state\" onclick=\"return toggleWidget( \\'wi_ID_'+a+\"', '\"+crumb_url+\"' );\\\">\"+(b?enabled_icon_tag:disabled_icon_tag)+\"</a>\"),b?jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").addClass(\"widget_checkbox_enabled\"):jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").removeClass(\"widget_checkbox_enabled\"),jQuery(\"#wi_ID_\"+a+\" .toggle_action\").html(b?deactivate_icon_tag:activate_icon_tag),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function toggleCacheWidget(a,b){return SendAdminRequest(\"widgets\",\"cache_\"+b,\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggleCache(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,b)),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function str_repeat(a,b){return new Array(b+1).join(a)}function getWidgetCacheIcon(a,b){switch(b){case\"enabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'disable' );\\\">\"+cache_enabled_icon_tag+\"</a>\";case\"disabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'enable' );\\\">\"+cache_disabled_icon_tag+\"</a>\";case\"disallowed\":return cache_disallowed_icon_tag;case\"denied\":return'<a href=\"?ctrl=coll_settings&amp;tab=advanced&amp;blog='+blog+'#fieldset_wrapper_caching\">'+cache_denied_icon_tag+\"</a>\"}}function openModalWindow(a,b,c,d,e,f,g,h,i){var j=\"undefined\"==typeof b||\"auto\"==b?\"\":\"width:\"+b+\";\",k=\"undefined\"==typeof c||0==c||\"\"==c?\"\":\"height:\"+c,l=k.match(/%$/i)?' style=\"height:100%;overflow:hidden;\"':\"\",m=c.match(/px/i)?' style=\"min-height:'+(c.replace(\"px\",\"\")-157)+'px\"':\"\",n=\"undefined\"==typeof f||0!=f;if(\"undefined\"!=typeof f&&\"\"!=f)if(\"object\"==typeof f)var o=f[0],p=f[1],q=\"undefined\"==typeof f[2]?\"form\":f[2];else var o=f,p=\"btn-primary\",q=\"form\";if(\"undefined\"!=typeof g&&g&&jQuery(\"#modal_window\").remove(),0==jQuery(\"#modal_window\").length){var r='<div id=\"modal_window\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"modal-dialog\" style=\"'+j+k+'\"><div class=\"modal-content\"'+l+\">\";if(\"undefined\"!=typeof e&&\"\"!=e&&(r+='<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button><h4 class=\"modal-title\">'+e+\"</h4></div>\"),r+='<div class=\"modal-body\"'+l+m+\">\"+a,i){jQuery(\"#\"+i);r+=\"<script>jQuery( document ).ready( function() {var iframe = jQuery( '#\"+i+\"' );iframe.on( 'load', function() {iframe.closest( '.modal-body' ).find( 'span.loader_img' ).remove();setModalIFrameUnload( '\"+i+\"' );});});</script>\"}r+=\"</div>\",n&&(r+='<div class=\"modal-footer\">',\"undefined\"!=typeof f&&\"\"!=f&&(r+='<button class=\"btn '+p+'\" type=\"submit\" style=\"display:none\">'+o+\"</button>\"),r+='<button class=\"btn btn-default\" data-dismiss=\"modal\" aria-hidden=\"true\">'+evo_js_lang_close+\"</button></div>\"),r+=\"</div></div></div>\",jQuery(\"body\").append(r)}else jQuery(\"#modal_window .modal-body\").html(a);\"undefined\"!=typeof i?jQuery(\"#\"+i).load(function(){prepareModalWindow(jQuery(this).contents(),q,n,h),jQuery(\"#modal_window .loader_img\").remove(),jQuery(\"#\"+i).show()}):prepareModalWindow(\"#modal_window\",q,n,h);var s={};modal_window_js_initialized&&(s=\"show\"),jQuery(\"#modal_window\").modal(s),\"\"==j&&(jQuery(\"#modal_window .modal-dialog\").css({display:\"table\",width:\"auto\"}),jQuery(\"#modal_window .modal-dialog .modal-content\").css({display:\"table-cell\"})),jQuery(\"#modal_window\").on(\"hidden\",function(){jQuery(this).remove()}),modal_window_js_initialized=!0}function prepareModalWindow(a,b,c,d){c&&(\"undefined\"!=typeof d&&d||(jQuery(\"legend\",a).remove(),jQuery(\"#close_button\",a).remove(),jQuery(\".panel, .panel-body\",a).removeClass(\"panel panel-default panel-body\")),0==jQuery(b+\" input[type=submit]\",a).length?jQuery(\"#modal_window .modal-footer button[type=submit]\").hide():(jQuery(b+\" input[type=submit]\",a).hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()),jQuery(b,a).change(function(){var a=jQuery(this).find(\"input[type=submit]\");a.length>0?(a.hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()):jQuery(\"#modal_window .modal-footer button[type=submit]\").hide()}),jQuery(\"#modal_window .modal-footer button[type=submit]\").click(function(){jQuery(b+\" input[type=submit]\",a).click()})),jQuery(b+\" a.btn\",a).each(function(){jQuery(\"#modal_window .modal-footer\").prepend(\"<a href=\"+jQuery(this).attr(\"href\")+'><button type=\"button\" class=\"'+jQuery(this).attr(\"class\")+'\">'+jQuery(this).html()+\"</button></a>\"),jQuery(this).remove()}),jQuery(b+\" #current_modal_title\",a).length>0&&jQuery(\"#modal_window .modal-title\").html(jQuery(b+\" #current_modal_title\",a).html())}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#modal_window\",a).remove(),!1}function setModalIFrameUnload(a){var b=jQuery(\"#\"+a);b[0].contentWindow.onunload=function(){var a=b.closest(\".modal-body\"),c=jQuery('<span class=\"loader_img absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>');jQuery(a).prepend(c)}}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_deldata(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"],!0),jQuery.ajax({type:\"POST\",url:evo_js_user_deldata_ajax_url,data:{ctrl:\"user\",user_tab:\"deldata\",user_tab_from:b,user_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"])}}),!1}function user_add_org(a){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"add_user\",org_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add),jQuery(\"input.autocomplete_login\").trigger(\"added\")}}),!1}function user_edit(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"edit_user\",org_ID:a,user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit)}}),!1}function user_remove(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"remove_user\",user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height();b!=a&&jQuery(\"#attachments_fieldset_wrapper\").height(jQuery(\"#attachments_fieldset_table\").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+\"anon_async.php?action=set_object_link_position&link_ID=\"+a.id.substr(17)+\"&link_position=\"+e+\"&crumb_link=\"+c,{},function(b,c){b=ajax_debug_clear(b),\"OK\"==b?(evoFadeSuccess(jQuery(d).closest(\"tr\")),jQuery(d).closest(\"td\").removeClass(\"error\"),\"cover\"==e&&jQuery(\"select[name=link_position][id!=\"+a.id+\"] option[value=cover]:selected\").each(function(){jQuery(this).parent().val(\"aftermore\"),evoFadeSuccess(jQuery(this).closest(\"tr\"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest(\"tr\")),jQuery(d.form).closest(\"td\").addClass(\"error\"))}),!1}function evo_link_insert_inline(a,b,c){if(\"undefined\"!=typeof b2evoCanvas){var d=\"[\"+a+\":\"+b;c.length&&(d+=\":\"+c),d+=\"]\",textarea_wrap_selection(b2evoCanvas,d,\"\",0,window.document);var e=jQuery(\"#display_position_\"+b);0!=e.length&&\"inline\"!=e.val()&&(deferInlineReminder=!0,e.val(\"inline\").change(),deferInlineReminder=!1)}}function evo_link_delete(a,b,c,d){return evo_rest_api_request(\"links/\"+c,{action:d},function(d){if(\"item\"==b){var e=window.document.getElementById(\"itemform_post_content\");if(null!=e){var f=new RegExp(\"\\\\[(image|file|inline|video|audio|thumbnail):\"+c+\":?[^\\\\]]*\\\\]\",\"ig\");textarea_str_replace(e,f,\"\",window.document)}}jQuery(a).closest(\"tr\").remove(),evo_link_fix_wrapper_height()},\"DELETE\"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request(\"links/\"+b+\"/\"+c,function(b){var d=jQuery(a).closest(\"tr\");\"move_up\"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},\"POST\"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request(\"links\",{action:\"attach\",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery(\"#attachments_fieldset_table table\",window.parent.document),c=(b.parent,jQuery(a.list_content));b.replaceWith(jQuery(\"table\",c)).promise().done(function(a){setTimeout(function(){window.parent.evo_link_fix_wrapper_height()},10)})}),!1}function evo_link_ajax_loading_overlay(){\n+var a=jQuery(\"#attachments_fieldset_table\"),b=!1;return 0==a.find(\".results_ajax_loading\").length&&(b=jQuery('<div class=\"results_ajax_loading\"><div>&nbsp;</div></div>'),a.css(\"position\",\"relative\"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request(\"links\",{action:\"undefined\"==typeof c?\"refresh\":\"sort\",type:a,object_ID:b},function(a){jQuery(\"#attachments_fieldset_table\").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}b2evo_Callbacks.prototype={register_callback:function(a,b,c){\"undefined\"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=new Array),\"undefined\"!=typeof c&&c?this.eventHandlers[a][0]=b:this.eventHandlers[a][this.eventHandlers[a].length]=b},trigger_callback:function(event,args){if(\"undefined\"==typeof this.eventHandlers[event])return null;for(var r=!1,cb_args=\"\",cb_arguments=arguments,i=1;i<arguments.length;i++)cb_args+=\"cb_arguments[\"+i+\"], \";cb_args.length&&(cb_args=cb_args.substring(0,cb_args.length-2));for(var i=0;i<this.eventHandlers[event].length;i++){var f=this.eventHandlers[event][i];r=eval(\"f(\"+cb_args+\");\")||r}return r}};var b2evo_Callbacks=new b2evo_Callbacks;evo_alert_events_initialized=!1,jQuery(document).ready(function(){function a(a){var b=a.data(\"prefix\")?a.data(\"prefix\"):\"\",c=jQuery(\".\"+b+a.val()+\"_toolbar\");return 0==c.length?!0:void(a.is(\":checked\")?(c.removeClass(\"disabled\"),c.find(\"input[type=button]\").removeAttr(\"disabled\")):(c.addClass(\"disabled\"),c.find(\"input[type=button]\").attr(\"disabled\",\"disabled\")))}jQuery(document).on(\"click\",\"[data-func]\",function(){var a=jQuery(this).data(\"func\").match(/([^\\\\|]|\\\\\\|)+/g),b=a[0];a.splice(0,1);for(var c=0;c<a.length;c++)a[c].indexOf(\"b2evoCanvas\")>-1?a[c]=window[a[c]]:\" \"==a[c]?a[c]=\"\":a[c]=a[c].replace(/\\\\\\|/g,\"|\");return jQuery(this).closest(\".disabled[class*=_toolbar]\").length>0?!1:(window[b].apply(null,a),!1)}),jQuery('input[type=checkbox][name=\"renderers[]\"]').each(function(){a(jQuery(this))}),jQuery('input[type=checkbox][name=\"renderers[]\"]').click(function(){a(jQuery(this))})}),jQuery(document).ready(function(){jQuery(\".pblock\").length?jQuery('<div id=\"server_messages\"></div>').prependTo(\".pblock\"):jQuery(\".level2\").length?jQuery(\".level2\").after('<div id=\"server_messages\"></div>'):jQuery(\".navbar.level1\").after('<div id=\"server_messages\"></div>'),jQuery('<iframe id=\"server_postback\" name=\"server_postback\"></iframe>').appendTo(\"body\").css({position:\"absolute\",left:\"-1000em\",top:\"-1000em\"})});var _b2evoCommunications=function(){var a,b,c=2500,d=250;return{Init:function(){var e=jQuery.fn.extend({delay:c,interval:d,dispatcher:b},arguments.length?arguments[0]:\"\");c=e.delay,d=e.interval,b=e.dispatcher,a=this,b2evoHelper.info(\"Communications object ready\")},BufferedServerCall:function(){var b=jQuery.fn.extend({ticker_callback:function(){return!0},send_callback:function(){},delay:c,interval:d,buffer_name:\"\"},arguments.length?arguments[0]:\"\");if(ticker_status=b.ticker_callback(b.delay))switch(ticker_status!==!0&&b2evoHelper.log(\"Ticker status : \"+ticker_status),ticker_status){case\"cancel\":return void b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Update cancelled\")+\"</div>\");case\"pause\":return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Update Paused\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);case\"ignore\":return void a.BufferedServerLoop(b);case\"immediate\":break;default:if(b.delay-=b.interval,b.delay>0)return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Changes pending\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Saving changes\")+\"</div>\"),b.send_callback()}},BufferedServerLoop:function(b){var c=jQuery(a).data(\"buffers\");\"undefined\"==typeof c&&(c=Array()),c[b.buffer_name]=b,jQuery(a).data(\"buffers\",c),window.setTimeout('b2evoCommunications.BufferedServerCallback( \"'+b.buffer_name+'\" )',b.interval)},BufferedServerCallback:function(b){var c=jQuery(a).data(\"buffers\");a.BufferedServerCall(c[b])},SendAdminRequest:function(){var c=jQuery.fn.extend({ctrl:\"\",action:\"\",data:\"\",key:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\"),d=\"ctrl=\"+c.ctrl+\"&key=\"+c.key+\"&action=\"+c.action+\"&\"+c.data;a.SendServerRequest({url:b,data:d,error:c.error,ok:c.ok})},SendServerRequest:function(){var a=jQuery.fn.extend({url:\"\",data:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\");if(a.url){a.url+=(a.url.indexOf(\"?\")===!0?\"&\":\"?\")+\"mode=js\",a.data&&(a.url+=\"&\"+a.data);var b=jQuery('<script type=\"text/javascript\"></script>');b.attr(\"src\",a.url),b.load(a.ok()),b.error(a.error()),b.appendTo(\"body\"),b2evoHelper.log(\"Sending request : \"+a.url)}}}},b2evoCommunications=new _b2evoCommunications;jQuery(document).ready(function(){jQuery(\"[id^=fadeout-]\").each(function(){evoFadeBg(this,new Array(\"#FFFF33\"),{speed:3e3})})}),jQuery(document).on(\"change\",\".btn-file :file\",function(){var a=jQuery(this).val().replace(/\\\\/g,\"/\").replace(/.*\\//,\"\");jQuery(this).parent().next().html(a)});var edit_icon_tag=\"\",delete_icon_tag=\"\",current_widgets=\"\",reorder_widgets_queue,reorder_delay=200,reorder_delay_remaining=0,crumb_url=\"\";jQuery(document).ready(function(){if(0!=jQuery(\"#current_widgets\").length){edit_icon_tag=jQuery(\".edit_icon_hook\").find(\"a\").html(),delete_icon_tag=jQuery(\".delete_icon_hook\").find(\"a\").html(),crumb_url=jQuery(\".delete_icon_hook\").find(\"a\").attr(\"href\"),\"undefined\"!=typeof crumb_url&&(crumb_url=crumb_url.match(/crumb_.*?$/)),jQuery(\".new_widget\").parent().parent().remove(),jQuery(\".odd\").addClass(\"widget_row\").removeClass(\".odd\"),jQuery(\".even\").addClass(\"widget_row\").removeClass(\".even\"),jQuery(\".fieldset_title\").each(function(){jQuery(this).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(b.draggable).prependTo(jQuery(\"#container_\"+jQuery(this).find(\".container_name\").html().replace(/ /g,\"_\").replace(/:/g,\"-\"))),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\"),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}),jQuery(\".widget_row td:nth-child(7)\").each(function(){var a=jQuery(this).find(\"a\").attr(\"href\");a=a.match(/wi_ID=([0-9]+)/)[1],jQuery(this).parent().attr(\"id\",\"wi_ID_\"+a)});var a=new Array;jQuery(\".widget_container_list\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=new Array,jQuery(\"#\"+b+\" .widget_row\").each(function(){var c=jQuery(this).attr(\"id\");a[b][c]=new Array,a[b][c].name=jQuery(\"#\"+c).find(\".widget_name\").parent().html(),a[b][c][\"class\"]=jQuery(this).attr(\"className\"),a[b][c].enabled=jQuery(\"#\"+c+\" .widget_is_enabled\").size(),a[b][c].cache=jQuery(\"#\"+c+\" .widget_cache_status [rel]\").attr(\"rel\")})});for(container in a){var b=!jQuery(\"#\"+container).hasClass(\"no-drop\");newContainer=jQuery('<ul id=\"container_'+container+'\" class=\"widget_container\"></ul>'),b||jQuery(newContainer).addClass(\"no-drop\"),jQuery(\"#\"+container).replaceWith(newContainer);for(widget in a[container])createWidget(widget,container,0,a[container][widget].name,a[container][widget][\"class\"],a[container][widget].enabled,a[container][widget].cache)}jQuery(\".no-drop .draggable_widget\").droppable(\"disable\"),jQuery(\".draggable_widget\").bind(\"mousedown\",function(){jQuery(this).hasClass(\"new_widget\")||jQuery(\".available_widgets_active\").removeClass(\"available_widgets_active\")}),colourWidgets(),convertAvailableList(),current_widgets=getWidgetOrder(),doFade(\".fadeout-ffff00\"),jQuery(\"#widget_button_check_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!0)}),jQuery(\"#widget_button_uncheck_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_active\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!0),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_inactive\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!1),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!0)})}});var modal_window_js_initialized=!1;jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).ready(function(){var a=jQuery(\"#attachments_fieldset_table\").height();a=a>320?320:97>a?97:a,jQuery(\"#attachments_fieldset_wrapper\").height(a),jQuery(\"#attachments_fieldset_wrapper\").resizable({minHeight:80,handles:\"s\",resize:function(a,b){jQuery(\"#attachments_fieldset_wrapper\").resizable(\"option\",\"maxHeight\",jQuery(\"#attachments_fieldset_table\").height())}}),jQuery(document).on(\"click\",\"#attachments_fieldset_wrapper .ui-resizable-handle\",function(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height()+80;jQuery(\"#attachments_fieldset_wrapper\").css(\"height\",b>a?a:b)})});\n\\ No newline at end of file"
        },
        {
          "filename": "rsc/js/build/bootstrap-evo_frontoffice.bmin.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,2 +1,2 @@\n /* This includes 8 files: src/bootstrap-evo_modal_window.js, src/evo_images.js, src/evo_user_crop.js, src/evo_user_report.js, src/evo_user_contact_groups.js, src/evo_rest_api.js, src/evo_item_flag.js, ajax.js */\n-function openModalWindow(a,b,c,d,e,f,g,h,i){var j=\"undefined\"==typeof b||\"auto\"==b?\"\":\"width:\"+b+\";\",k=\"undefined\"==typeof c||0==c||\"\"==c?\"\":\"height:\"+c,l=k.match(/%$/i)?' style=\"height:100%;overflow:hidden;\"':\"\",m=c.match(/px/i)?' style=\"min-height:'+(c.replace(\"px\",\"\")-157)+'px\"':\"\",n=\"undefined\"==typeof f||0!=f;if(\"undefined\"!=typeof f&&\"\"!=f)if(\"object\"==typeof f)var o=f[0],p=f[1],q=\"undefined\"==typeof f[2]?\"form\":f[2];else var o=f,p=\"btn-primary\",q=\"form\";if(\"undefined\"!=typeof g&&g&&jQuery(\"#modal_window\").remove(),0==jQuery(\"#modal_window\").length){var r='<div id=\"modal_window\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"modal-dialog\" style=\"'+j+k+'\"><div class=\"modal-content\"'+l+\">\";if(\"undefined\"!=typeof e&&\"\"!=e&&(r+='<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button><h4 class=\"modal-title\">'+e+\"</h4></div>\"),r+='<div class=\"modal-body\"'+l+m+\">\"+a,i){jQuery(\"#\"+i);r+=\"<script>jQuery( document ).ready( function() {var iframe = jQuery( '#\"+i+\"' );iframe.on( 'load', function() {iframe.closest( '.modal-body' ).find( 'span.loader_img' ).remove();setModalIFrameUnload( '\"+i+\"' );});});</script>\"}r+=\"</div>\",n&&(r+='<div class=\"modal-footer\">',\"undefined\"!=typeof f&&\"\"!=f&&(r+='<button class=\"btn '+p+'\" type=\"submit\" style=\"display:none\">'+o+\"</button>\"),r+='<button class=\"btn btn-default\" data-dismiss=\"modal\" aria-hidden=\"true\">'+evo_js_lang_close+\"</button></div>\"),r+=\"</div></div></div>\",jQuery(\"body\").append(r)}else jQuery(\"#modal_window .modal-body\").html(a);\"undefined\"!=typeof i?jQuery(\"#\"+i).load(function(){prepareModalWindow(jQuery(this).contents(),q,n,h),jQuery(\"#modal_window .loader_img\").remove(),jQuery(\"#\"+i).show()}):prepareModalWindow(\"#modal_window\",q,n,h);var s={};modal_window_js_initialized&&(s=\"show\"),jQuery(\"#modal_window\").modal(s),\"\"==j&&(jQuery(\"#modal_window .modal-dialog\").css({display:\"table\",width:\"auto\"}),jQuery(\"#modal_window .modal-dialog .modal-content\").css({display:\"table-cell\"})),jQuery(\"#modal_window\").on(\"hidden\",function(){jQuery(this).remove()}),modal_window_js_initialized=!0}function prepareModalWindow(a,b,c,d){c&&(\"undefined\"!=typeof d&&d||(jQuery(\"legend\",a).remove(),jQuery(\"#close_button\",a).remove(),jQuery(\".panel, .panel-body\",a).removeClass(\"panel panel-default panel-body\")),0==jQuery(b+\" input[type=submit]\",a).length?jQuery(\"#modal_window .modal-footer button[type=submit]\").hide():(jQuery(b+\" input[type=submit]\",a).hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()),jQuery(b,a).change(function(){var a=jQuery(this).find(\"input[type=submit]\");a.length>0?(a.hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()):jQuery(\"#modal_window .modal-footer button[type=submit]\").hide()}),jQuery(\"#modal_window .modal-footer button[type=submit]\").click(function(){jQuery(b+\" input[type=submit]\",a).click()})),jQuery(b+\" a.btn\",a).each(function(){jQuery(\"#modal_window .modal-footer\").prepend(\"<a href=\"+jQuery(this).attr(\"href\")+'><button type=\"button\" class=\"'+jQuery(this).attr(\"class\")+'\">'+jQuery(this).html()+\"</button></a>\"),jQuery(this).remove()}),jQuery(b+\" #current_modal_title\",a).length>0&&jQuery(\"#modal_window .modal-title\").html(jQuery(b+\" #current_modal_title\",a).html())}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#modal_window\",a).remove(),!1}function setModalIFrameUnload(a){var b=jQuery(\"#\"+a);b[0].contentWindow.onunload=function(){var a=b.closest(\".modal-body\"),c=jQuery('<span class=\"loader_img absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>');jQuery(a).prepend(c)}}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_contact_groups(a){return openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_contact_groups_ajax_url,data:{action:\"get_user_contact_form\",blog:evo_js_blog,user_ID:a,crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}var modal_window_js_initialized=!1;jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).on(\"click\",\"a.evo_post_flag_btn\",function(){var a=jQuery(this),b=parseInt(a.data(\"id\"));return b>0&&(a.data(\"status\",\"inprogress\"),jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\"),evo_rest_api_request(\"collections/\"+a.data(\"coll\")+\"/items/\"+b+\"/flag\",function(b){b.flag?(a.find(\"span:first\").show(),a.find(\"span:last\").hide()):(a.find(\"span:last\").show(),a.find(\"span:first\").hide()),jQuery(\"span\",a).removeClass(\"fa-x--hover\"),setTimeout(function(){a.removeData(\"status\")},500)})),!1}),jQuery(document).on(\"mouseover\",\"a.evo_post_flag_btn\",function(){\"inprogress\"!=jQuery(this).data(\"status\")&&jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\")});\n\\ No newline at end of file\n+function openModalWindow(a,b,c,d,e,f,g,h,i){var j=\"undefined\"==typeof b||\"auto\"==b?\"\":\"width:\"+b+\";\",k=\"undefined\"==typeof c||0==c||\"\"==c?\"\":\"height:\"+c,l=k.match(/%$/i)?' style=\"height:100%;overflow:hidden;\"':\"\",m=c.match(/px/i)?' style=\"min-height:'+(c.replace(\"px\",\"\")-157)+'px\"':\"\",n=\"undefined\"==typeof f||0!=f;if(\"undefined\"!=typeof f&&\"\"!=f)if(\"object\"==typeof f)var o=f[0],p=f[1],q=\"undefined\"==typeof f[2]?\"form\":f[2];else var o=f,p=\"btn-primary\",q=\"form\";if(\"undefined\"!=typeof g&&g&&jQuery(\"#modal_window\").remove(),0==jQuery(\"#modal_window\").length){var r='<div id=\"modal_window\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"><div class=\"modal-dialog\" style=\"'+j+k+'\"><div class=\"modal-content\"'+l+\">\";if(\"undefined\"!=typeof e&&\"\"!=e&&(r+='<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button><h4 class=\"modal-title\">'+e+\"</h4></div>\"),r+='<div class=\"modal-body\"'+l+m+\">\"+a,i){jQuery(\"#\"+i);r+=\"<script>jQuery( document ).ready( function() {var iframe = jQuery( '#\"+i+\"' );iframe.on( 'load', function() {iframe.closest( '.modal-body' ).find( 'span.loader_img' ).remove();setModalIFrameUnload( '\"+i+\"' );});});</script>\"}r+=\"</div>\",n&&(r+='<div class=\"modal-footer\">',\"undefined\"!=typeof f&&\"\"!=f&&(r+='<button class=\"btn '+p+'\" type=\"submit\" style=\"display:none\">'+o+\"</button>\"),r+='<button class=\"btn btn-default\" data-dismiss=\"modal\" aria-hidden=\"true\">'+evo_js_lang_close+\"</button></div>\"),r+=\"</div></div></div>\",jQuery(\"body\").append(r)}else jQuery(\"#modal_window .modal-body\").html(a);\"undefined\"!=typeof i?jQuery(\"#\"+i).load(function(){prepareModalWindow(jQuery(this).contents(),q,n,h),jQuery(\"#modal_window .loader_img\").remove(),jQuery(\"#\"+i).show()}):prepareModalWindow(\"#modal_window\",q,n,h);var s={};modal_window_js_initialized&&(s=\"show\"),jQuery(\"#modal_window\").modal(s),\"\"==j&&(jQuery(\"#modal_window .modal-dialog\").css({display:\"table\",width:\"auto\"}),jQuery(\"#modal_window .modal-dialog .modal-content\").css({display:\"table-cell\"})),jQuery(\"#modal_window\").on(\"hidden\",function(){jQuery(this).remove()}),modal_window_js_initialized=!0}function prepareModalWindow(a,b,c,d){c&&(\"undefined\"!=typeof d&&d||(jQuery(\"legend\",a).remove(),jQuery(\"#close_button\",a).remove(),jQuery(\".panel, .panel-body\",a).removeClass(\"panel panel-default panel-body\")),0==jQuery(b+\" input[type=submit]\",a).length?jQuery(\"#modal_window .modal-footer button[type=submit]\").hide():(jQuery(b+\" input[type=submit]\",a).hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()),jQuery(b,a).change(function(){var a=jQuery(this).find(\"input[type=submit]\");a.length>0?(a.hide(),jQuery(\"#modal_window .modal-footer button[type=submit]\").show()):jQuery(\"#modal_window .modal-footer button[type=submit]\").hide()}),jQuery(\"#modal_window .modal-footer button[type=submit]\").click(function(){jQuery(b+\" input[type=submit]\",a).click()})),jQuery(b+\" a.btn\",a).each(function(){jQuery(\"#modal_window .modal-footer\").prepend(\"<a href=\"+jQuery(this).attr(\"href\")+'><button type=\"button\" class=\"'+jQuery(this).attr(\"class\")+'\">'+jQuery(this).html()+\"</button></a>\"),jQuery(this).remove()}),jQuery(b+\" #current_modal_title\",a).length>0&&jQuery(\"#modal_window .modal-title\").html(jQuery(b+\" #current_modal_title\",a).html())}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#modal_window\",a).remove(),!1}function setModalIFrameUnload(a){var b=jQuery(\"#\"+a);b[0].contentWindow.onunload=function(){var a=b.closest(\".modal-body\"),c=jQuery('<span class=\"loader_img absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>');jQuery(a).prepend(c)}}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_contact_groups(a){return openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_contact_groups_ajax_url,data:{action:\"get_user_contact_form\",blog:evo_js_blog,user_ID:a,crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height();b!=a&&jQuery(\"#attachments_fieldset_wrapper\").height(jQuery(\"#attachments_fieldset_table\").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+\"anon_async.php?action=set_object_link_position&link_ID=\"+a.id.substr(17)+\"&link_position=\"+e+\"&crumb_link=\"+c,{},function(b,c){b=ajax_debug_clear(b),\"OK\"==b?(evoFadeSuccess(jQuery(d).closest(\"tr\")),jQuery(d).closest(\"td\").removeClass(\"error\"),\"cover\"==e&&jQuery(\"select[name=link_position][id!=\"+a.id+\"] option[value=cover]:selected\").each(function(){jQuery(this).parent().val(\"aftermore\"),evoFadeSuccess(jQuery(this).closest(\"tr\"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest(\"tr\")),jQuery(d.form).closest(\"td\").addClass(\"error\"))}),!1}function evo_link_insert_inline(a,b,c){if(\"undefined\"!=typeof b2evoCanvas){var d=\"[\"+a+\":\"+b;c.length&&(d+=\":\"+c),d+=\"]\",textarea_wrap_selection(b2evoCanvas,d,\"\",0,window.document);var e=jQuery(\"#display_position_\"+b);0!=e.length&&\"inline\"!=e.val()&&(deferInlineReminder=!0,e.val(\"inline\").change(),deferInlineReminder=!1)}}function evo_link_delete(a,b,c,d){return evo_rest_api_request(\"links/\"+c,{action:d},function(d){if(\"item\"==b){var e=window.document.getElementById(\"itemform_post_content\");if(null!=e){var f=new RegExp(\"\\\\[(image|file|inline|video|audio|thumbnail):\"+c+\":?[^\\\\]]*\\\\]\",\"ig\");textarea_str_replace(e,f,\"\",window.document)}}jQuery(a).closest(\"tr\").remove(),evo_link_fix_wrapper_height()},\"DELETE\"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request(\"links/\"+b+\"/\"+c,function(b){var d=jQuery(a).closest(\"tr\");\"move_up\"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},\"POST\"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request(\"links\",{action:\"attach\",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery(\"#attachments_fieldset_table table\",window.parent.document),c=(b.parent,jQuery(a.list_content));b.replaceWith(jQuery(\"table\",c)).promise().done(function(a){setTimeout(function(){window.parent.evo_link_fix_wrapper_height()},10)})}),!1}function evo_link_ajax_loading_overlay(){var a=jQuery(\"#attachments_fieldset_table\"),b=!1;return 0==a.find(\".results_ajax_loading\").length&&(b=jQuery('<div class=\"results_ajax_loading\"><div>&nbsp;</div></div>'),a.css(\"position\",\"relative\"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request(\"links\",{action:\"undefined\"==typeof c?\"refresh\":\"sort\",type:a,object_ID:b},function(a){jQuery(\"#attachments_fieldset_table\").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}var modal_window_js_initialized=!1;jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).on(\"click\",\"a.evo_post_flag_btn\",function(){var a=jQuery(this),b=parseInt(a.data(\"id\"));return b>0&&(a.data(\"status\",\"inprogress\"),jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\"),evo_rest_api_request(\"collections/\"+a.data(\"coll\")+\"/items/\"+b+\"/flag\",function(b){b.flag?(a.find(\"span:first\").show(),a.find(\"span:last\").hide()):(a.find(\"span:last\").show(),a.find(\"span:first\").hide()),jQuery(\"span\",a).removeClass(\"fa-x--hover\"),setTimeout(function(){a.removeData(\"status\")},500)})),!1}),jQuery(document).on(\"mouseover\",\"a.evo_post_flag_btn\",function(){\"inprogress\"!=jQuery(this).data(\"status\")&&jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\")}),jQuery(document).ready(function(){var a=jQuery(\"#attachments_fieldset_table\").height();a=a>320?320:97>a?97:a,jQuery(\"#attachments_fieldset_wrapper\").height(a),jQuery(\"#attachments_fieldset_wrapper\").resizable({minHeight:80,handles:\"s\",resize:function(a,b){jQuery(\"#attachments_fieldset_wrapper\").resizable(\"option\",\"maxHeight\",jQuery(\"#attachments_fieldset_table\").height())}}),jQuery(document).on(\"click\",\"#attachments_fieldset_wrapper .ui-resizable-handle\",function(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height()+80;jQuery(\"#attachments_fieldset_wrapper\").css(\"height\",b>a?a:b)})});\n\\ No newline at end of file"
        },
        {
          "filename": "rsc/js/build/evo_backoffice.bmin.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,3 +1,3 @@\n /* This includes 15 files: functions.js, ajax.js, communication.js, form_extensions.js, backoffice.js, extracats.js, dynamic_select.js, src/evo_modal_window.js, src/evo_images.js, src/evo_user_crop.js, src/evo_user_report.js, src/evo_user_deldata.js, src/evo_user_org.js, src/evo_rest_api.js, src/evo_links.js */\n-function pop_up_window(a,b,c,d,e){\"undefined\"==typeof c&&(c=750),\"undefined\"==typeof d&&(d=550);var f=(screen.width-c)/2,g=(screen.height-d)/2;return\"undefined\"==typeof e&&(e=\"scrollbars=yes, status=yes, resizable=yes, menubar=yes\"),e=\"width=\"+c+\", height=\"+d+\", left=\"+f+\", top=\"+g+\", \"+e,opened=window.open(a,b,e),opened.focus(),\"undefined\"==typeof openedWindows?openedWindows=new Array(opened):openedWindows.push(opened),!1}function textarea_replace_selection(a,b,c){textarea_wrap_selection(a,b,\"\",1,c)}function textarea_wrap_selection(a,b,c,d,e){e=e||document;var f={element:a,before:b,after:c,replace:d,target_document:e};if(!b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f))return}catch(g){}if(!(window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)))if(e.selection)a.focus(),sel=e.selection.createRange(),d?sel.text=b+c:sel.text=b+sel.text+c,a.focus();else if(a.selectionStart||\"0\"==a.selectionStart){var h,i,j,k=a.selectionStart,l=a.selectionEnd;\"textarea\"==a.type&&\"undefined\"!=typeof a.scrollTop&&(i=a.scrollTop,j=a.scrollLeft),d?(a.value=a.value.substring(0,k)+b+c+a.value.substring(l,a.value.length),h=k+b.length+c.length):(a.value=a.value.substring(0,k)+b+a.value.substring(k,l)+c+a.value.substring(l,a.value.length),h=l+b.length+c.length),\"undefined\"!=typeof i&&(a.scrollTop=i,a.scrollLeft=j),a.focus(),a.selectionStart=h,a.selectionEnd=h}else a.value+=b+c,a.focus()}}function textarea_str_replace(a,b,c,d){d=d||document;var e={element:a,search:b,replace:c,target_document:d};if(!b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e))return}catch(f){}window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)||(a.value=a.value.replace(b,c),a.focus())}}function toggle_filter_area(a){var b=jQuery(\"#clickdiv_\"+a),c=jQuery(\"#clickimg_\"+a);if(0==b.length||0==c.length)return alert(\"ID \"+a+\" not found!\"),!1;if(c.hasClass(\"fa\")||c.hasClass(\"glyphicon\")){if(\"\"!=c.data(\"toggle\")&&void 0!=c.data(\"toggle\")){var d=c.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==c.data(\"toggle-orig-class\")&&c.data(\"toggle-orig-class\",c.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),c.hasClass(c.data(\"toggle-orig-class\"))?c.removeClass(c.data(\"toggle-orig-class\")).addClass(d+\"-\"+c.data(\"toggle\")):c.removeClass(d+\"-\"+c.data(\"toggle\")).addClass(c.data(\"toggle-orig-class\"))}}else{var e=c.css(\"background-position\").match(/-*\\d+/g);c.css(\"background-position\",parseInt(e[0])+(b.is(\":hidden\")?-16:16)+\"px \"+parseInt(e[1])+\"px\")}return b.is(\":hidden\")?(b.slideDown(500),jQuery.post(htsrv_url+\"anon_async.php?action=expand_filter&target=\"+a)):(b.slideUp(500),jQuery.post(htsrv_url+\"anon_async.php?action=collapse_filter&target=\"+a)),!1}function b2evo_Callbacks(){this.eventHandlers=new Array}function evoAlert(a){var b=jQuery(\".b2evo_alert\");b.length>0&&b.remove(),jQuery(\"body\").append('<div class=\"b2evo_alert\">'+a+\"</div>\"),setTimeout(function(){jQuery(\".b2evo_alert\").fadeOut({complete:function(){jQuery(this).remove()}})},3e3),evo_alert_events_initialized||(evo_alert_events_initialized=!0,jQuery(document).on(\"click\",\".b2evo_alert\",function(){jQuery(this).remove()}))}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}function SendAdminRequest(a,b,c,d){if(void 0===d||d){var e=new Date;c+=(\"\"!==c?\"&\":\"\")+\"nocache_dummy=\"+e.getTime()}SendServerRequest(b2evo_dispatcher_url+\"?ctrl=\"+a+\"&action=\"+b+(c?\"&\"+c:\"\"))}function SendServerRequest(a){a+=-1!=a.indexOf(\"?\")?\"&\":\"?\",a+=\"display_mode=js\";var b=a.split(\"?\");a=b[0],b=b[1],jQuery.ajax({type:\"POST\",url:a,data:b,dataType:\"script\"})}function AttachServerRequest(a){jQuery('<input type=\"hidden\" name=\"display_mode\" value=\"js\" /><input type=\"hidden\" name=\"js_target\" value=\"window.parent.\" />').appendTo(\"#\"+a),jQuery(\"#\"+a).attr(\"target\",\"server_postback\")}function DisplayServerMessages(a,b){jQuery(\"#server_messages\").html(a),\"object\"==typeof b&&(jQuery(\"input.field_error, select.field_error, textarea.field_error\").each(function(){jQuery(this).removeClass(\"field_error\");var a=jQuery(this).next();a.hasClass(\"notes\")&&\"SPAN\"==a.get(0).tagName&&a.remove()}),jQuery.each(b,function(a,b){jQuery(\"#\"+a).addClass(\"field_error\").after('<span class=\"oneline notes\"> <span class=\"field_error\" rel=\"'+a+'\">'+b+\"</span></span>\")})),jQuery(\"#server_messages .log_success\").animate({backgroundColor:\"#88ff88\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")}),jQuery(\"#server_messages > .log_error\").animate({backgroundColor:\"#ff8888\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")})}function get_form(a){for(;\"FORM\"!=a.tagName;){if(\"undefined\"==typeof a)return!1;a=a.parentNode}return a}function check(a,b){if(form_obj=get_form(a),!form_obj)return alert(\"Could not find form\"),!1;for(i=0;i<form_obj.length;)\"checkbox\"==form_obj.elements[i].type&&(form_obj.elements[i].checked=b),i++;return!1}function check_all(a){return target=findTarget(a),check(target,!0),cancelClick(a),!1}function uncheck_all(a){return target=findTarget(a),check(target,!1),cancelClick(a),!1}function cancelClick(a){return window.event&&window.event.returnValue&&(window.event.returnValue=!1),a&&a.preventDefault&&a.preventDefault(),!1}function surround_check(a,b,c){var d=findTarget(a);for(el_form=get_form(d),el_inputs=el_form.getElementsByTagName(\"INPUT\"),i=0;i<el_inputs.length;i++)el_input=el_inputs[i],\"checkbox\"==el_input.type&&(null!=c&&el_input.checked!=c||(el_input.parentNode.className=b))}function surround_unchecked(a){surround_check(a,\"checkbox_surround\",!1)}function surround_checked(a){surround_check(a,\"checkbox_surround\",!0)}function unsurround_all(a){surround_check(a,\"checkbox_surround_init\",null)}function init_check_all(){for(var a=document.getElementsByName(\"check_all_nocheckchanges\"),b=0;b<a.length;b++){var c=a[b];jQuery(c).bind({click:check_all,mouseover:surround_unchecked,mouseout:unsurround_all})}for(var d=document.getElementsByName(\"uncheck_all_nocheckchanges\"),b=0;b<d.length;b++){var c=d[b];jQuery(c).bind({click:uncheck_all,mouseover:surround_checked,mouseout:unsurround_all})}}function clear_form(a){for(a=check(a,!1),i=0;i<a.length;)\"text\"==a.elements[i].type&&(a.elements[i].value=\"\"),i++;return a}function focus_on_first_input(){if(all_inputs=document.getElementsByTagName(\"input\"),all_inputs.length)for(i=0;i<all_inputs.length;i++)if(\"text\"==all_inputs[i].type&&1!=all_inputs[i].disabled){try{all_inputs[i].focus()}catch(a){}break}}function check_combo(a,b,c){\"new\"==b?(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"inline\",input_text.focus()):(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"none\")}function input_decorated_help(a,b){var c=document.getElementById(a),d=function(){\"\"!=c.value&&c.value!=b||(c.style.color=\"#666\",c.value=b)};jQuery(c).bind(\"blur\",d),jQuery(c).bind(\"focus\",function(){c.style.color=\"\",c.value==b&&(c.value=\"\")}),jQuery(c.form).bind(\"submit\",function(){c.value==b&&(c.value=\"\")}),d()}function findTarget(a){var b;if(window.event&&window.event.srcElement?b=window.event.srcElement:a&&a.target&&(b=a.target),!b)return null;for(;b!=document.body&&\"a\"!=b.nodeName.toLowerCase();)b=b.parentNode;return\"a\"!=b.nodeName.toLowerCase()?null:b}function addSpinner(a){a=jQuery(a),a.addClass(\"btn-spinner\"),a.css(\"width\",\"+=24px\")}function check_extracat(a){for(var b=a.value,c=document.getElementsByName(\"post_extracats[]\"),d=0;d<c.length;d++){var e=c[d];e.value==b&&(e.checked=!0)}}function init_dynamicSelect(){for(var a=0;a<nb_dynamicSelects;a++)dynamicSelect(tab_dynamicSelects[a].parent,tab_dynamicSelects[a].child)}function dynamicSelect(a,b){if(document.getElementById&&document.getElementsByTagName){var c=document.getElementById(a),d=document.getElementById(b),e=d.cloneNode(!0),f=e.getElementsByTagName(\"option\");refreshDynamicSelectOptions(c,d,f),c.onchange=function(){refreshDynamicSelectOptions(c,d,f)}}}function refreshDynamicSelectOptions(a,b,c){for(;b.options.length;)b.remove(0);for(var d=new RegExp(\"^\"+a.options[a.selectedIndex].value+\"-.*$\"),e=0;e<c.length;e++)(c[e].value.match(d)||\"\"==c[e].value)&&b.appendChild(c[e].cloneNode(!0))}function toggle_clickopen(a,b,c){if(!(clickdiv=document.getElementById(\"clickdiv_\"+a))||!(clickimg=document.getElementById(\"clickimg_\"+a)))return alert(\"ID \"+a+\" not found!\"),!1;if(\"undefined\"==typeof b&&(b=\"none\"!=clickdiv.style.display),\"undefined\"==typeof c&&(c=\"\"),clickimg=jQuery(clickimg),clickimg.hasClass(\"fa\")||clickimg.hasClass(\"glyphicon\")){if(\"\"!=clickimg.data(\"toggle\")){var d=clickimg.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==clickimg.data(\"toggle-orig-class\")&&clickimg.data(\"toggle-orig-class\",clickimg.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),clickimg.hasClass(clickimg.data(\"toggle-orig-class\"))?clickimg.removeClass(clickimg.data(\"toggle-orig-class\")).addClass(d+\"-\"+clickimg.data(\"toggle\")):clickimg.removeClass(d+\"-\"+clickimg.data(\"toggle\")).addClass(clickimg.data(\"toggle-orig-class\"))}}else{var e=clickimg.css(\"background-position\").match(/-*\\d+/g);clickimg.css(\"background-position\",parseInt(e[0])+(b?16:-16)+\"px \"+parseInt(e[1])+\"px\")}return clickdiv.style.display=b?\"none\":c,!1}function evoFadeSuccess(a){evoFadeBg(a,new Array(\"#ddff00\",\"#bbff00\"))}function evoFadeFailure(a){evoFadeBg(a,new Array(\"#9300ff\",\"#ff000a\",\"#ff0000\"))}function evoFadeHighlight(a){evoFadeBg(a,new Array(\"#ffbf00\",\"#ffe79f\"))}function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css(\"backgroundColor\"),speed=options&&options.speed||'\"slow\"',toEval=\"jQuery(selector).animate({ backgroundColor: \";for(e in bgs)\"string\"==typeof bgs[e]&&(toEval+='\"'+bgs[e]+'\"}, '+speed+\" ).animate({ backgroundColor: \");toEval+=\"origBg }, \"+speed+', \"\", function(){jQuery( this ).css( \"backgroundColor\", \"\" );});',eval(toEval)}function set_new_form_action(a,b){a.attributes.getNamedItem(\"action\").value;a.attributes.getNamedItem(\"action\").value=b;var c=location.href.replace(/(\\/)[^\\/]*$/,\"$1\");return a.attributes.getNamedItem(\"action\").value!=b&&a.attributes.getNamedItem(\"action\").value!=c+b&&(a.action=b,a.attributes.getNamedItem(\"action\").value!=b)?(alert(\"set_new_form_action: Cannot set new form action (Safari workaround).\"),!1):!0}function b2edit_open_preview(a,b){if(\"b2evo_preview\"==a.target)return!1;var c=a.attributes.getNamedItem(\"action\").value;return set_new_form_action(a,b)?(a.target=\"b2evo_preview\",preview_window=window.open(\"\",\"b2evo_preview\"),preview_window.focus(),a.submit(),a.attributes.getNamedItem(\"action\").value=c,a.target=\"_self\",!1):(alert(\"Preview not supported. Sorry. (Could not set form.action for preview)\"),!1)}function b2edit_reload(a,b,c,d,e){if(!set_new_form_action(a,b))return!1;var f=!1;if(a.elements.namedItem(\"actionArray[update]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"edit_switchtab\" />'),f=!0):a.elements.namedItem(\"actionArray[create]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"new_switchtab\" />'),f=!0):(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"switchtab\" />'),f=!0),f&&\"undefined\"!=typeof d)for(param in d)jQuery(a).append('<input type=\"hidden\" name=\"'+param+'\" value=\"'+d[param]+'\" />');return\"undefined\"!=typeof c&&\"undefined\"!=c&&(null==c&&(c=\"\"),a.elements.blog.value=c),window.onbeforeunload=null,\"undefined\"!=typeof e&&1==e&&a.reset(),a.submit(),!1}function b2edit_type(a,b,c){var d=!1;return bozo.nb_changes>0&&(d=!confirm(a)),b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},d)}function b2edit_confirm(a,b,c){return bozo.nb_changes>0&&!confirm(a)?!1:b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},!1)}function makeDragnDrop(a){makeDraggable(a),makeDroppable(a)}function makeDraggable(a){jQuery(a).draggable({helper:\"clone\",scroll:!0,scrollSensitivity:100,zIndex:999,opacity:.8,cursor:\"move\",start:function(){jQuery(this).hide()},stop:function(){jQuery(this).show()}}).addClass(\"draggable_widget\")}function makeDroppable(a){jQuery(a).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(this).hasClass(\"available_widgets\")?jQuery(b.draggable).hasClass(\"new_widget\")||jQuery(b.draggable).remove():jQuery(b.draggable).hasClass(\"new_widget\")?addNewWidget(b.draggable,this):(jQuery(b.draggable).insertAfter(this),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\")),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}function doFade(a){evoFadeSuccess(a)}function sendWidgetOrder(){1>reorder_delay_remaining&&jQuery(\"#server_messages\").html('<div class=\"log_container\"><div class=\"log_error\"></div></div>'),reorder_delay_remaining=reorder_delay,bufferedServerCall()}function sendWidgetOrderCallback(a){doFade(\".server_updating\"),jQuery(\".server_updating\").removeClass(\"server_updating\"),colourWidgets()}function bufferedServerCall(){var a=getWidgetOrder();a!=current_widgets?(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-info fade in\">'+T_(\"Saving changes\")+\"</div></li></ul></div>\"),current_widgets=a,a+=\"&\"+crumb_url,jQuery(\".pending_update\").removeClass(\"pending_update\").addClass(\"server_updating\"),SendAdminRequest(\"widgets\",\"re-order\",a,!1)):(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-warning fade in\">'+T_(\"Widget order unchanged\")+\"</div></li></ul></div>\"),jQuery(\".pending_update\").removeClass(\"pending_update\"),colourWidgets())}function getWidgetOrder(){var a=new Array;jQuery(\".widget_container\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=\"\",jQuery(\"#\"+b+\" .draggable_widget\").each(function(){jQuery(this).attr(\"id\")&&\"undefined\"!=jQuery(this).attr(\"id\")&&(a[b]+=jQuery(this).attr(\"id\")+\", \")})});var b=\"\",c=\"\";for(container in a)b+=container+\"=\"+a[container]+\"&\",c+=container+\",\";var d=(\"undefined\"!=typeof blog?\"blog=\"+blog:\"\")+\"&\"+b+\"container_list=\"+c;return d}function colourWidgets(){jQuery(\".draggable_widget\").removeClass(\"odd\"),jQuery(\".draggable_widget\").removeClass(\"even\");var a=!1;jQuery(\"#current_widgets .draggable_widget\").each(function(){a=!a,jQuery(this).addClass(a?\"even\":\"odd\")})}function deleteWidget(a){return jQuery(\"#wi_ID_\"+a.substr(6,a.length)).animate({backgroundColor:\"#f88\"},\"fast\",function(){jQuery(this).remove(),colourWidgets(),sendWidgetOrder()}),!1}function editWidget(a){return jQuery(\"#server_messages\").html(\"\"),msg=\"wi_ID=\"+a.substr(6,a.length),SendAdminRequest(\"widgets\",\"edit\",msg,!0),!1}function widgetSettings(a,b,c){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeWidgetSettings()\"></div><div id=\"widget_settings\" class=\"modal-content\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#widget_settings\").html(a).addClass(\"widget_settings_active edit_widget_\"+b+\"_\"+c),jQuery(\"#widget_settings\").prepend(jQuery(\"#server_messages\")),AttachServerRequest(\"form\");var d=jQuery(\"#widget_settings\").find(\"h2.page-title:first\");if(d.length>0){var e=jQuery(\"#widget_settings\").find(\"span.pull-right:first\"),f=\"\";e.length>0&&(e.find(\"a.close_link\").remove(),f='<span class=\"pull-right\">'+e.html()+\"</span>\",e.remove()),jQuery(\"#widget_settings\").prepend('<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>'+f+'<h4 class=\"modal-title\">'+d.html()+\"</h4></div>\"),d.remove(),jQuery(\"#widget_settings button.close\").bind(\"click\",closeWidgetSettings)}jQuery(\"#widget_settings a.close_link\").bind(\"click\",closeWidgetSettings);var g=27;jQuery(document).keyup(function(a){a.keyCode==g&&closeWidgetSettings()})}function widgetSettingsCallback(a,b,c){jQuery(\"#wi_ID_\"+a+\" .widget_name\").html(b),jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,c))}function closeWidgetSettings(){return jQuery(\"#widget_settings\").hide(),jQuery(\"#server_messages\").insertBefore(\".available_widgets\"),jQuery(\"#widget_settings\").remove(),jQuery(\"#screen_mask\").remove(),!1}function showMessagesWidgetSettings(){return jQuery(\"#widget_settings\").animate({scrollTop:jQuery(\"#widget_settings\").scrollTop()+ +jQuery(\"#server_messages\").position().top-20},100),!1}function T_(a){return\"undefined\"==typeof T_arr[a]?a:T_arr[a]}function convertAvailableList(){jQuery(\".fieldset_title > span > a[id^='add_new']\").attr(\"href\",\"#\").bind(\"click\",function(a){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeAvailableWidgets()\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),offset=jQuery(this).offset();var b=offset.top,c=jQuery(document).height()-10-jQuery(\".available_widgets\").height();return 20>c&&(c=20),b>c&&(b=c),jQuery(\".available_widgets\").addClass(\"available_widgets_active\").attr(\"id\",\"available_\"+jQuery(this).attr(\"id\")),!1}),jQuery(\".available_widgets_toolbar > a\").bind(\"click\",function(a){return closeAvailableWidgets(),!1});var a=27;jQuery(document).keyup(function(b){return b.keyCode==a?(closeAvailableWidgets(),!1):void 0}),jQuery(\".available_widgets li\").each(function(){jQuery(this).addClass(\"new_widget\");var a=jQuery(this).children(\"a\").attr(\"href\");a=a.substr(a.indexOf(\"&type\")+1,a.length),jQuery(this).children(\"a:first\").attr(\"href\",\"#\").bind(\"click\",function(){return addNewWidget(this,a),!1})})}function closeAvailableWidgets(){jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(\"#screen_mask\").remove()}function addNewWidget(a,b){closeAvailableWidgets();var c=jQuery(a).attr(\"id\");jQuery(a).attr(\"id\",c);var d=(jQuery(a).html(),jQuery(\".available_widgets\").attr(\"id\"));d=d.substr(18,d.length).replace(/_/g,\" \").replace(/-/g,\":\"),SendAdminRequest(\"widgets\",\"create\",b+\"&blog=\"+blog+\"&container=\"+d,!0)}function addNewWidgetCallback(a,b,c,d,e){jQuery(\".fade_me\").removeClass(\"fade_me\"),createWidget(\"wi_ID_\"+a,b.replace(/ /g,\"_\").replace(/:/g,\"-\"),c,d,\"\",1,e),doFade(\"#wi_ID_\"+a),reorder_delay_remaining>0?reorder_delay_remaining=0:current_widgets=getWidgetOrder()}function createWidget(a,b,c,d,e,f,g){var h=jQuery('<li id=\"'+a+'\" class=\"draggable_widget\"><span>'+d+\"</span></li>\");h.find(\"a.widget_name\").click(function(){return editWidget(a)}),e&&jQuery(h).addClass(e),jQuery(h).prepend(jQuery('<span class=\"widget_state\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?enabled_icon_tag:disabled_icon_tag)+\"</a></span>\"));var i=jQuery('<span class=\"widget_cache_status\">'+getWidgetCacheIcon(a,g)+\"</span>\");jQuery(h).prepend(i);var j=jQuery('<span class=\"widget_actions\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?deactivate_icon_tag:activate_icon_tag)+'</a><a href=\"#\" onclick=\"return editWidget( \\''+a+\"' );\\\">\"+edit_icon_tag+'</a><a href=\"#\" onclick=\"return deleteWidget( \\''+a+\"' );\\\">\"+delete_icon_tag+\"</a></span>\");jQuery(h).prepend(j),jQuery(h).prepend(jQuery('<span class=\"widget_checkbox'+(f?\" widget_checkbox_enabled\":\"\")+'\"><input type=\"checkbox\" name=\"widgets[]\" value=\"'+a.replace(\"wi_ID_\",\"\")+'\" /></span>')),jQuery(\"#container_\"+b).append(h),makeDragnDrop(\"#\"+a),colourWidgets()}function toggleWidget(a){return SendAdminRequest(\"widgets\",\"toggle\",\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggle(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_state\").html('<a href=\"#\" class=\"toggle_state\" onclick=\"return toggleWidget( \\'wi_ID_'+a+\"', '\"+crumb_url+\"' );\\\">\"+(b?enabled_icon_tag:disabled_icon_tag)+\"</a>\"),b?jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").addClass(\"widget_checkbox_enabled\"):jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").removeClass(\"widget_checkbox_enabled\"),jQuery(\"#wi_ID_\"+a+\" .toggle_action\").html(b?deactivate_icon_tag:activate_icon_tag),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function toggleCacheWidget(a,b){return SendAdminRequest(\"widgets\",\"cache_\"+b,\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggleCache(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,b)),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function str_repeat(a,b){return new Array(b+1).join(a)}function getWidgetCacheIcon(a,b){switch(b){case\"enabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'disable' );\\\">\"+cache_enabled_icon_tag+\"</a>\";case\"disabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'enable' );\\\">\"+cache_disabled_icon_tag+\"</a>\";case\"disallowed\":return cache_disallowed_icon_tag;case\"denied\":return'<a href=\"?ctrl=coll_settings&amp;tab=advanced&amp;blog='+blog+'#fieldset_wrapper_caching\">'+cache_denied_icon_tag+\"</a>\"}}function openModalWindow(a,b,c,d,e,f){var g=\"overlay_page_active\";\"undefined\"!=typeof d&&1==d&&(g=\"overlay_page_active_transparent\"),\"undefined\"==typeof b&&(b=\"560px\");var h=\"\";return\"undefined\"!=typeof c&&(c>0||\"\"!=c)&&(h=' style=\"height:'+c+'\"'),jQuery(\"#overlay_page\").length>0?void jQuery(\"#overlay_page\").html(a):(jQuery(\"body\").append('<div id=\"screen_mask\"></div><div id=\"overlay_wrap\" style=\"width:'+b+'\"><div id=\"overlay_layout\"><div id=\"overlay_page\"'+h+\"></div></div></div>\"),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#overlay_page\").html(a).addClass(g),void jQuery(document).on(\"click\",\"#close_button, #screen_mask, #overlay_page\",function(a){if(\"overlay_page\"==jQuery(this).attr(\"id\")){var b=jQuery(\"#overlay_page form\");if(b.length){var c=b.position().top+jQuery(\"#overlay_wrap\").position().top,d=c+b.height();a.clientY>c&&a.clientY<d||closeModalWindow()}return!0}return closeModalWindow(),!1}))}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#overlay_page\",a).hide(),jQuery(\".action_messages\",a).remove(),jQuery(\"#server_messages\",a).insertBefore(\".first_payload_block\"),jQuery(\"#overlay_wrap\",a).remove(),jQuery(\"#screen_mask\",a).remove(),!1}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_deldata(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"],!0),jQuery.ajax({type:\"POST\",url:evo_js_user_deldata_ajax_url,data:{ctrl:\"user\",user_tab:\"deldata\",user_tab_from:b,user_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"])}}),!1}function user_add_org(a){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"add_user\",org_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add),jQuery(\"input.autocomplete_login\").trigger(\"added\")}}),!1}function user_edit(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"edit_user\",org_ID:a,user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit)}}),!1}function user_remove(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"remove_user\",user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height();b>a&&jQuery(\"#attachments_fieldset_wrapper\").height(jQuery(\"#attachments_fieldset_table\").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+\"async.php?action=set_object_link_position&link_ID=\"+a.id.substr(17)+\"&link_position=\"+e+\"&crumb_link=\"+c,{},function(b,c){b=ajax_debug_clear(b),\"OK\"==b?(evoFadeSuccess(jQuery(d).closest(\"tr\")),jQuery(d).closest(\"td\").removeClass(\"error\"),\"cover\"==e&&jQuery(\"select[name=link_position][id!=\"+a.id+\"] option[value=cover]:selected\").each(function(){jQuery(this).parent().val(\"aftermore\"),evoFadeSuccess(jQuery(this).closest(\"tr\"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest(\"tr\")),jQuery(d.form).closest(\"td\").addClass(\"error\"))}),!1}function evo_link_insert_inline(a,b,c){if(\"undefined\"!=typeof b2evoCanvas){var d=\"[\"+a+\":\"+b;c.length&&(d+=\":\"+c),d+=\"]\",textarea_wrap_selection(b2evoCanvas,d,\"\",0,window.document);var e=jQuery(\"#display_position_\"+b);0!=e.length&&\"inline\"!=e.val()&&(deferInlineReminder=!0,e.val(\"inline\").change(),deferInlineReminder=!1)}}function evo_link_delete(a,b,c,d){return evo_rest_api_request(\"links/\"+c,{action:d},function(d){if(\"item\"==b){var e=window.document.getElementById(\"itemform_post_content\");if(null!=e){var f=new RegExp(\"\\\\[(image|file|inline|video|audio):\"+c+\":?[^\\\\]]*\\\\]\",\"ig\");textarea_str_replace(e,f,\"\",window.document)}}jQuery(a).closest(\"tr\").remove(),evo_link_fix_wrapper_height()},\"DELETE\"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request(\"links/\"+b+\"/\"+c,function(b){var d=jQuery(a).closest(\"tr\");\"move_up\"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},\"POST\"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request(\"links\",{action:\"attach\",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery(\"#attachments_fieldset_table table\",window.parent.document);b.length>0&&\"undefined\"!=typeof a.link&&b.append('<tr><td class=\"firstcol shrinkwrap\">'+a.link.preview+'</td><td class=\"fm_filename\">'+a.link.url+'</td><td class=\"shrinkwrap link_id_cell\">'+a.link.ID+'</td><td class=\"shrinkwrap\">'+a.link.actions+'</td><td class=\"lastcol shrinkwrap\">'+a.link.position+\"</td></tr>\")}),!1}function evo_link_ajax_loading_overlay(){var a=jQuery(\"#attachments_fieldset_table\"),b=!1;return 0==a.find(\".results_ajax_loading\").length&&(b=jQuery('<div class=\"results_ajax_loading\"><div>&nbsp;</div></div>'),a.css(\"position\",\"relative\"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request(\"links\",{action:\"undefined\"==typeof c?\"refresh\":\"sort\",type:a,object_ID:b},function(a){jQuery(\"#attachments_fieldset_table\").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}b2evo_Callbacks.prototype={register_callback:function(a,b,c){\"undefined\"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=new Array),\"undefined\"!=typeof c&&c?this.eventHandlers[a][0]=b:this.eventHandlers[a][this.eventHandlers[a].length]=b},trigger_callback:function(event,args){if(\"undefined\"==typeof this.eventHandlers[event])return null;for(var r=!1,cb_args=\"\",cb_arguments=arguments,i=1;i<arguments.length;i++)cb_args+=\"cb_arguments[\"+i+\"], \";cb_args.length&&(cb_args=cb_args.substring(0,cb_args.length-2));for(var i=0;i<this.eventHandlers[event].length;i++){var f=this.eventHandlers[event][i];r=eval(\"f(\"+cb_args+\");\")||r}return r}};var b2evo_Callbacks=new b2evo_Callbacks;evo_alert_events_initialized=!1,jQuery(document).ready(function(){function a(a){var b=a.data(\"prefix\")?a.data(\"prefix\"):\"\",c=jQuery(\".\"+b+a.val()+\"_toolbar\");return 0==c.length?!0:void(a.is(\":checked\")?(c.removeClass(\"disabled\"),c.find(\"input[type=button]\").removeAttr(\"disabled\")):(c.addClass(\"disabled\"),c.find(\"input[type=button]\").attr(\"disabled\",\"disabled\")))}jQuery(document).on(\"click\",\"[data-func]\",function(){var a=jQuery(this).data(\"func\").match(/([^\\\\|]|\\\\\\|)+/g),b=a[0];a.splice(0,1);for(var c=0;c<a.length;c++)a[c].indexOf(\"b2evoCanvas\")>-1?a[c]=window[a[c]]:\" \"==a[c]?a[c]=\"\":a[c]=a[c].replace(/\\\\\\|/g,\"|\");return jQuery(this).closest(\".disabled[class*=_toolbar]\").length>0?!1:(window[b].apply(null,a),!1)}),jQuery('input[type=checkbox][name=\"renderers[]\"]').each(function(){a(jQuery(this))}),jQuery('input[type=checkbox][name=\"renderers[]\"]').click(function(){a(jQuery(this))})}),jQuery(document).ready(function(){jQuery(\".pblock\").length?jQuery('<div id=\"server_messages\"></div>').prependTo(\".pblock\"):jQuery(\".level2\").length?jQuery(\".level2\").after('<div id=\"server_messages\"></div>'):jQuery(\".navbar.level1\").after('<div id=\"server_messages\"></div>'),\n-jQuery('<iframe id=\"server_postback\" name=\"server_postback\"></iframe>').appendTo(\"body\").css({position:\"absolute\",left:\"-1000em\",top:\"-1000em\"})});var _b2evoCommunications=function(){var a,b,c=2500,d=250;return{Init:function(){var e=jQuery.fn.extend({delay:c,interval:d,dispatcher:b},arguments.length?arguments[0]:\"\");c=e.delay,d=e.interval,b=e.dispatcher,a=this,b2evoHelper.info(\"Communications object ready\")},BufferedServerCall:function(){var b=jQuery.fn.extend({ticker_callback:function(){return!0},send_callback:function(){},delay:c,interval:d,buffer_name:\"\"},arguments.length?arguments[0]:\"\");if(ticker_status=b.ticker_callback(b.delay))switch(ticker_status!==!0&&b2evoHelper.log(\"Ticker status : \"+ticker_status),ticker_status){case\"cancel\":return void b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Update cancelled\")+\"</div>\");case\"pause\":return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Update Paused\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);case\"ignore\":return void a.BufferedServerLoop(b);case\"immediate\":break;default:if(b.delay-=b.interval,b.delay>0)return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Changes pending\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Saving changes\")+\"</div>\"),b.send_callback()}},BufferedServerLoop:function(b){var c=jQuery(a).data(\"buffers\");\"undefined\"==typeof c&&(c=Array()),c[b.buffer_name]=b,jQuery(a).data(\"buffers\",c),window.setTimeout('b2evoCommunications.BufferedServerCallback( \"'+b.buffer_name+'\" )',b.interval)},BufferedServerCallback:function(b){var c=jQuery(a).data(\"buffers\");a.BufferedServerCall(c[b])},SendAdminRequest:function(){var c=jQuery.fn.extend({ctrl:\"\",action:\"\",data:\"\",key:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\"),d=\"ctrl=\"+c.ctrl+\"&key=\"+c.key+\"&action=\"+c.action+\"&\"+c.data;a.SendServerRequest({url:b,data:d,error:c.error,ok:c.ok})},SendServerRequest:function(){var a=jQuery.fn.extend({url:\"\",data:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\");if(a.url){a.url+=(a.url.indexOf(\"?\")===!0?\"&\":\"?\")+\"mode=js\",a.data&&(a.url+=\"&\"+a.data);var b=jQuery('<script type=\"text/javascript\"></script>');b.attr(\"src\",a.url),b.load(a.ok()),b.error(a.error()),b.appendTo(\"body\"),b2evoHelper.log(\"Sending request : \"+a.url)}}}},b2evoCommunications=new _b2evoCommunications;jQuery(document).ready(function(){jQuery(\"[id^=fadeout-]\").each(function(){evoFadeBg(this,new Array(\"#FFFF33\"),{speed:3e3})})}),jQuery(document).on(\"change\",\".btn-file :file\",function(){var a=jQuery(this).val().replace(/\\\\/g,\"/\").replace(/.*\\//,\"\");jQuery(this).parent().next().html(a)});var edit_icon_tag=\"\",delete_icon_tag=\"\",current_widgets=\"\",reorder_widgets_queue,reorder_delay=200,reorder_delay_remaining=0,crumb_url=\"\";jQuery(document).ready(function(){if(0!=jQuery(\"#current_widgets\").length){edit_icon_tag=jQuery(\".edit_icon_hook\").find(\"a\").html(),delete_icon_tag=jQuery(\".delete_icon_hook\").find(\"a\").html(),crumb_url=jQuery(\".delete_icon_hook\").find(\"a\").attr(\"href\"),\"undefined\"!=typeof crumb_url&&(crumb_url=crumb_url.match(/crumb_.*?$/)),jQuery(\".new_widget\").parent().parent().remove(),jQuery(\".odd\").addClass(\"widget_row\").removeClass(\".odd\"),jQuery(\".even\").addClass(\"widget_row\").removeClass(\".even\"),jQuery(\".fieldset_title\").each(function(){jQuery(this).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(b.draggable).prependTo(jQuery(\"#container_\"+jQuery(this).find(\".container_name\").html().replace(/ /g,\"_\").replace(/:/g,\"-\"))),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\"),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}),jQuery(\".widget_row td:nth-child(7)\").each(function(){var a=jQuery(this).find(\"a\").attr(\"href\");a=a.match(/wi_ID=([0-9]+)/)[1],jQuery(this).parent().attr(\"id\",\"wi_ID_\"+a)});var a=new Array;jQuery(\".widget_container_list\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=new Array,jQuery(\"#\"+b+\" .widget_row\").each(function(){var c=jQuery(this).attr(\"id\");a[b][c]=new Array,a[b][c].name=jQuery(\"#\"+c).find(\".widget_name\").parent().html(),a[b][c][\"class\"]=jQuery(this).attr(\"className\"),a[b][c].enabled=jQuery(\"#\"+c+\" .widget_is_enabled\").size(),a[b][c].cache=jQuery(\"#\"+c+\" .widget_cache_status [rel]\").attr(\"rel\")})});for(container in a){var b=!jQuery(\"#\"+container).hasClass(\"no-drop\");newContainer=jQuery('<ul id=\"container_'+container+'\" class=\"widget_container\"></ul>'),b||jQuery(newContainer).addClass(\"no-drop\"),jQuery(\"#\"+container).replaceWith(newContainer);for(widget in a[container])createWidget(widget,container,0,a[container][widget].name,a[container][widget][\"class\"],a[container][widget].enabled,a[container][widget].cache)}jQuery(\".no-drop .draggable_widget\").droppable(\"disable\"),jQuery(\".draggable_widget\").bind(\"mousedown\",function(){jQuery(this).hasClass(\"new_widget\")||jQuery(\".available_widgets_active\").removeClass(\"available_widgets_active\")}),colourWidgets(),convertAvailableList(),current_widgets=getWidgetOrder(),doFade(\".fadeout-ffff00\"),jQuery(\"#widget_button_check_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!0)}),jQuery(\"#widget_button_uncheck_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_active\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!0),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_inactive\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!1),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!0)})}}),jQuery(document).keyup(function(a){27==a.keyCode&&closeModalWindow()}),jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).ready(function(){var a=jQuery(\"#attachments_fieldset_table\").height();a=a>320?320:97>a?97:a,jQuery(\"#attachments_fieldset_wrapper\").height(a),jQuery(\"#attachments_fieldset_wrapper\").resizable({minHeight:80,handles:\"s\",resize:function(a,b){jQuery(\"#attachments_fieldset_wrapper\").resizable(\"option\",\"maxHeight\",jQuery(\"#attachments_fieldset_table\").height())}}),jQuery(document).on(\"click\",\"#attachments_fieldset_wrapper .ui-resizable-handle\",function(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height()+80;jQuery(\"#attachments_fieldset_wrapper\").css(\"height\",b>a?a:b)})});\n\\ No newline at end of file\n+function pop_up_window(a,b,c,d,e){\"undefined\"==typeof c&&(c=750),\"undefined\"==typeof d&&(d=550);var f=(screen.width-c)/2,g=(screen.height-d)/2;return\"undefined\"==typeof e&&(e=\"scrollbars=yes, status=yes, resizable=yes, menubar=yes\"),e=\"width=\"+c+\", height=\"+d+\", left=\"+f+\", top=\"+g+\", \"+e,opened=window.open(a,b,e),opened.focus(),\"undefined\"==typeof openedWindows?openedWindows=new Array(opened):openedWindows.push(opened),!1}function textarea_replace_selection(a,b,c){textarea_wrap_selection(a,b,\"\",1,c)}function textarea_wrap_selection(a,b,c,d,e){e=e||document;var f={element:a,before:b,after:c,replace:d,target_document:e};if(!b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f))return}catch(g){}if(!(window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"wrap_selection_for_\"+a.id,f)))if(e.selection)a.focus(),sel=e.selection.createRange(),d?sel.text=b+c:sel.text=b+sel.text+c,a.focus();else if(a.selectionStart||\"0\"==a.selectionStart){var h,i,j,k=a.selectionStart,l=a.selectionEnd;\"textarea\"==a.type&&\"undefined\"!=typeof a.scrollTop&&(i=a.scrollTop,j=a.scrollLeft),d?(a.value=a.value.substring(0,k)+b+c+a.value.substring(l,a.value.length),h=k+b.length+c.length):(a.value=a.value.substring(0,k)+b+a.value.substring(k,l)+c+a.value.substring(l,a.value.length),h=l+b.length+c.length),\"undefined\"!=typeof i&&(a.scrollTop=i,a.scrollLeft=j),a.focus(),a.selectionStart=h,a.selectionEnd=h}else a.value+=b+c,a.focus()}}function textarea_str_replace(a,b,c,d){d=d||document;var e={element:a,search:b,replace:c,target_document:d};if(!b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)){if(window.opener&&\"undefined\"!=typeof window.opener)try{if(window.opener.b2evo_Callbacks&&\"undefined\"!=typeof window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e))return}catch(f){}window.parent&&\"undefined\"!=typeof window.parent&&window.parent.b2evo_Callbacks&&\"undefined\"!=typeof window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback(\"str_replace_for_\"+a.id,e)||(a.value=a.value.replace(b,c),a.focus())}}function toggle_filter_area(a){var b=jQuery(\"#clickdiv_\"+a),c=jQuery(\"#clickimg_\"+a);if(0==b.length||0==c.length)return alert(\"ID \"+a+\" not found!\"),!1;if(c.hasClass(\"fa\")||c.hasClass(\"glyphicon\")){if(\"\"!=c.data(\"toggle\")&&void 0!=c.data(\"toggle\")){var d=c.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==c.data(\"toggle-orig-class\")&&c.data(\"toggle-orig-class\",c.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),c.hasClass(c.data(\"toggle-orig-class\"))?c.removeClass(c.data(\"toggle-orig-class\")).addClass(d+\"-\"+c.data(\"toggle\")):c.removeClass(d+\"-\"+c.data(\"toggle\")).addClass(c.data(\"toggle-orig-class\"))}}else{var e=c.css(\"background-position\").match(/-*\\d+/g);c.css(\"background-position\",parseInt(e[0])+(b.is(\":hidden\")?-16:16)+\"px \"+parseInt(e[1])+\"px\")}return b.is(\":hidden\")?(b.slideDown(500),jQuery.post(htsrv_url+\"anon_async.php?action=expand_filter&target=\"+a)):(b.slideUp(500),jQuery.post(htsrv_url+\"anon_async.php?action=collapse_filter&target=\"+a)),!1}function b2evo_Callbacks(){this.eventHandlers=new Array}function evoAlert(a){var b=jQuery(\".b2evo_alert\");b.length>0&&b.remove(),jQuery(\"body\").append('<div class=\"b2evo_alert\">'+a+\"</div>\"),setTimeout(function(){jQuery(\".b2evo_alert\").fadeOut({complete:function(){jQuery(this).remove()}})},3e3),evo_alert_events_initialized||(evo_alert_events_initialized=!0,jQuery(document).on(\"click\",\".b2evo_alert\",function(){jQuery(this).remove()}))}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}function SendAdminRequest(a,b,c,d){if(void 0===d||d){var e=new Date;c+=(\"\"!==c?\"&\":\"\")+\"nocache_dummy=\"+e.getTime()}SendServerRequest(b2evo_dispatcher_url+\"?ctrl=\"+a+\"&action=\"+b+(c?\"&\"+c:\"\"))}function SendServerRequest(a){a+=-1!=a.indexOf(\"?\")?\"&\":\"?\",a+=\"display_mode=js\";var b=a.split(\"?\");a=b[0],b=b[1],jQuery.ajax({type:\"POST\",url:a,data:b,dataType:\"script\"})}function AttachServerRequest(a){jQuery('<input type=\"hidden\" name=\"display_mode\" value=\"js\" /><input type=\"hidden\" name=\"js_target\" value=\"window.parent.\" />').appendTo(\"#\"+a),jQuery(\"#\"+a).attr(\"target\",\"server_postback\")}function DisplayServerMessages(a,b){jQuery(\"#server_messages\").html(a),\"object\"==typeof b&&(jQuery(\"input.field_error, select.field_error, textarea.field_error\").each(function(){jQuery(this).removeClass(\"field_error\");var a=jQuery(this).next();a.hasClass(\"notes\")&&\"SPAN\"==a.get(0).tagName&&a.remove()}),jQuery.each(b,function(a,b){jQuery(\"#\"+a).addClass(\"field_error\").after('<span class=\"oneline notes\"> <span class=\"field_error\" rel=\"'+a+'\">'+b+\"</span></span>\")})),jQuery(\"#server_messages .log_success\").animate({backgroundColor:\"#88ff88\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")}),jQuery(\"#server_messages > .log_error\").animate({backgroundColor:\"#ff8888\"},\"fast\").animate({backgroundColor:\"#ffffff\"},\"fast\",\"\",function(){jQuery(this).removeAttr(\"style\")})}function get_form(a){for(;\"FORM\"!=a.tagName;){if(\"undefined\"==typeof a)return!1;a=a.parentNode}return a}function check(a,b){if(form_obj=get_form(a),!form_obj)return alert(\"Could not find form\"),!1;for(i=0;i<form_obj.length;)\"checkbox\"==form_obj.elements[i].type&&(form_obj.elements[i].checked=b),i++;return!1}function check_all(a){return target=findTarget(a),check(target,!0),cancelClick(a),!1}function uncheck_all(a){return target=findTarget(a),check(target,!1),cancelClick(a),!1}function cancelClick(a){return window.event&&window.event.returnValue&&(window.event.returnValue=!1),a&&a.preventDefault&&a.preventDefault(),!1}function surround_check(a,b,c){var d=findTarget(a);for(el_form=get_form(d),el_inputs=el_form.getElementsByTagName(\"INPUT\"),i=0;i<el_inputs.length;i++)el_input=el_inputs[i],\"checkbox\"==el_input.type&&(null!=c&&el_input.checked!=c||(el_input.parentNode.className=b))}function surround_unchecked(a){surround_check(a,\"checkbox_surround\",!1)}function surround_checked(a){surround_check(a,\"checkbox_surround\",!0)}function unsurround_all(a){surround_check(a,\"checkbox_surround_init\",null)}function init_check_all(){for(var a=document.getElementsByName(\"check_all_nocheckchanges\"),b=0;b<a.length;b++){var c=a[b];jQuery(c).bind({click:check_all,mouseover:surround_unchecked,mouseout:unsurround_all})}for(var d=document.getElementsByName(\"uncheck_all_nocheckchanges\"),b=0;b<d.length;b++){var c=d[b];jQuery(c).bind({click:uncheck_all,mouseover:surround_checked,mouseout:unsurround_all})}}function clear_form(a){for(a=check(a,!1),i=0;i<a.length;)\"text\"==a.elements[i].type&&(a.elements[i].value=\"\"),i++;return a}function focus_on_first_input(){if(all_inputs=document.getElementsByTagName(\"input\"),all_inputs.length)for(i=0;i<all_inputs.length;i++)if(\"text\"==all_inputs[i].type&&1!=all_inputs[i].disabled){try{all_inputs[i].focus()}catch(a){}break}}function check_combo(a,b,c){\"new\"==b?(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"inline\",input_text.focus()):(input_text=document.getElementById(a+\"_combo\"),input_text.style.display=\"none\")}function input_decorated_help(a,b){var c=document.getElementById(a),d=function(){\"\"!=c.value&&c.value!=b||(c.style.color=\"#666\",c.value=b)};jQuery(c).bind(\"blur\",d),jQuery(c).bind(\"focus\",function(){c.style.color=\"\",c.value==b&&(c.value=\"\")}),jQuery(c.form).bind(\"submit\",function(){c.value==b&&(c.value=\"\")}),d()}function findTarget(a){var b;if(window.event&&window.event.srcElement?b=window.event.srcElement:a&&a.target&&(b=a.target),!b)return null;for(;b!=document.body&&\"a\"!=b.nodeName.toLowerCase();)b=b.parentNode;return\"a\"!=b.nodeName.toLowerCase()?null:b}function addSpinner(a){a=jQuery(a),a.addClass(\"btn-spinner\"),a.css(\"width\",\"+=24px\")}function check_extracat(a){for(var b=a.value,c=document.getElementsByName(\"post_extracats[]\"),d=0;d<c.length;d++){var e=c[d];e.value==b&&(e.checked=!0)}}function init_dynamicSelect(){for(var a=0;a<nb_dynamicSelects;a++)dynamicSelect(tab_dynamicSelects[a].parent,tab_dynamicSelects[a].child)}function dynamicSelect(a,b){if(document.getElementById&&document.getElementsByTagName){var c=document.getElementById(a),d=document.getElementById(b),e=d.cloneNode(!0),f=e.getElementsByTagName(\"option\");refreshDynamicSelectOptions(c,d,f),c.onchange=function(){refreshDynamicSelectOptions(c,d,f)}}}function refreshDynamicSelectOptions(a,b,c){for(;b.options.length;)b.remove(0);for(var d=new RegExp(\"^\"+a.options[a.selectedIndex].value+\"-.*$\"),e=0;e<c.length;e++)(c[e].value.match(d)||\"\"==c[e].value)&&b.appendChild(c[e].cloneNode(!0))}function toggle_clickopen(a,b,c){if(!(clickdiv=document.getElementById(\"clickdiv_\"+a))||!(clickimg=document.getElementById(\"clickimg_\"+a)))return alert(\"ID \"+a+\" not found!\"),!1;if(\"undefined\"==typeof b&&(b=\"none\"!=clickdiv.style.display),\"undefined\"==typeof c&&(c=\"\"),clickimg=jQuery(clickimg),clickimg.hasClass(\"fa\")||clickimg.hasClass(\"glyphicon\")){if(\"\"!=clickimg.data(\"toggle\")){var d=clickimg.hasClass(\"fa\")?\"fa\":\"glyphicon\";void 0==clickimg.data(\"toggle-orig-class\")&&clickimg.data(\"toggle-orig-class\",clickimg.attr(\"class\").replace(new RegExp(\"^\"+d+\" (.+)$\",\"g\"),\"$1\")),clickimg.hasClass(clickimg.data(\"toggle-orig-class\"))?clickimg.removeClass(clickimg.data(\"toggle-orig-class\")).addClass(d+\"-\"+clickimg.data(\"toggle\")):clickimg.removeClass(d+\"-\"+clickimg.data(\"toggle\")).addClass(clickimg.data(\"toggle-orig-class\"))}}else{var e=clickimg.css(\"background-position\").match(/-*\\d+/g);clickimg.css(\"background-position\",parseInt(e[0])+(b?16:-16)+\"px \"+parseInt(e[1])+\"px\")}return clickdiv.style.display=b?\"none\":c,!1}function evoFadeSuccess(a){evoFadeBg(a,new Array(\"#ddff00\",\"#bbff00\"))}function evoFadeFailure(a){evoFadeBg(a,new Array(\"#9300ff\",\"#ff000a\",\"#ff0000\"))}function evoFadeHighlight(a){evoFadeBg(a,new Array(\"#ffbf00\",\"#ffe79f\"))}function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css(\"backgroundColor\"),speed=options&&options.speed||'\"slow\"',toEval=\"jQuery(selector).animate({ backgroundColor: \";for(e in bgs)\"string\"==typeof bgs[e]&&(toEval+='\"'+bgs[e]+'\"}, '+speed+\" ).animate({ backgroundColor: \");toEval+=\"origBg }, \"+speed+', \"\", function(){jQuery( this ).css( \"backgroundColor\", \"\" );});',eval(toEval)}function set_new_form_action(a,b){a.attributes.getNamedItem(\"action\").value;a.attributes.getNamedItem(\"action\").value=b;var c=location.href.replace(/(\\/)[^\\/]*$/,\"$1\");return a.attributes.getNamedItem(\"action\").value!=b&&a.attributes.getNamedItem(\"action\").value!=c+b&&(a.action=b,a.attributes.getNamedItem(\"action\").value!=b)?(alert(\"set_new_form_action: Cannot set new form action (Safari workaround).\"),!1):!0}function b2edit_open_preview(a,b){if(\"b2evo_preview\"==a.target)return!1;var c=a.attributes.getNamedItem(\"action\").value;return set_new_form_action(a,b)?(a.target=\"b2evo_preview\",preview_window=window.open(\"\",\"b2evo_preview\"),preview_window.focus(),a.submit(),a.attributes.getNamedItem(\"action\").value=c,a.target=\"_self\",!1):(alert(\"Preview not supported. Sorry. (Could not set form.action for preview)\"),!1)}function b2edit_reload(a,b,c,d,e){if(!set_new_form_action(a,b))return!1;var f=!1;if(a.elements.namedItem(\"actionArray[update]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"edit_switchtab\" />'),f=!0):a.elements.namedItem(\"actionArray[create]\")?(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"new_switchtab\" />'),f=!0):(jQuery(a).append('<input type=\"hidden\" name=\"action\" value=\"switchtab\" />'),f=!0),f&&\"undefined\"!=typeof d)for(param in d)jQuery(a).append('<input type=\"hidden\" name=\"'+param+'\" value=\"'+d[param]+'\" />');return\"undefined\"!=typeof c&&\"undefined\"!=c&&(null==c&&(c=\"\"),a.elements.blog.value=c),window.onbeforeunload=null,\"undefined\"!=typeof e&&1==e&&a.reset(),a.submit(),!1}function b2edit_type(a,b,c){var d=!1;return bozo.nb_changes>0&&(d=!confirm(a)),b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},d)}function b2edit_confirm(a,b,c){return bozo.nb_changes>0&&!confirm(a)?!1:b2edit_reload(document.getElementById(\"item_checkchanges\"),b,null,{action:c},!1)}function makeDragnDrop(a){makeDraggable(a),makeDroppable(a)}function makeDraggable(a){jQuery(a).draggable({helper:\"clone\",scroll:!0,scrollSensitivity:100,zIndex:999,opacity:.8,cursor:\"move\",start:function(){jQuery(this).hide()},stop:function(){jQuery(this).show()}}).addClass(\"draggable_widget\")}function makeDroppable(a){jQuery(a).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(this).hasClass(\"available_widgets\")?jQuery(b.draggable).hasClass(\"new_widget\")||jQuery(b.draggable).remove():jQuery(b.draggable).hasClass(\"new_widget\")?addNewWidget(b.draggable,this):(jQuery(b.draggable).insertAfter(this),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\")),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}function doFade(a){evoFadeSuccess(a)}function sendWidgetOrder(){1>reorder_delay_remaining&&jQuery(\"#server_messages\").html('<div class=\"log_container\"><div class=\"log_error\"></div></div>'),reorder_delay_remaining=reorder_delay,bufferedServerCall()}function sendWidgetOrderCallback(a){doFade(\".server_updating\"),jQuery(\".server_updating\").removeClass(\"server_updating\"),colourWidgets()}function bufferedServerCall(){var a=getWidgetOrder();a!=current_widgets?(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-info fade in\">'+T_(\"Saving changes\")+\"</div></li></ul></div>\"),current_widgets=a,a+=\"&\"+crumb_url,jQuery(\".pending_update\").removeClass(\"pending_update\").addClass(\"server_updating\"),SendAdminRequest(\"widgets\",\"re-order\",a,!1)):(jQuery(\"#server_messages\").html('<div class=\"action_messages container-fluid\"><ul><li><div class=\"alert alert-dismissible alert-warning fade in\">'+T_(\"Widget order unchanged\")+\"</div></li></ul></div>\"),jQuery(\".pending_update\").removeClass(\"pending_update\"),colourWidgets())}function getWidgetOrder(){var a=new Array;jQuery(\".widget_container\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=\"\",jQuery(\"#\"+b+\" .draggable_widget\").each(function(){jQuery(this).attr(\"id\")&&\"undefined\"!=jQuery(this).attr(\"id\")&&(a[b]+=jQuery(this).attr(\"id\")+\", \")})});var b=\"\",c=\"\";for(container in a)b+=container+\"=\"+a[container]+\"&\",c+=container+\",\";var d=(\"undefined\"!=typeof blog?\"blog=\"+blog:\"\")+\"&\"+b+\"container_list=\"+c;return d}function colourWidgets(){jQuery(\".draggable_widget\").removeClass(\"odd\"),jQuery(\".draggable_widget\").removeClass(\"even\");var a=!1;jQuery(\"#current_widgets .draggable_widget\").each(function(){a=!a,jQuery(this).addClass(a?\"even\":\"odd\")})}function deleteWidget(a){return jQuery(\"#wi_ID_\"+a.substr(6,a.length)).animate({backgroundColor:\"#f88\"},\"fast\",function(){jQuery(this).remove(),colourWidgets(),sendWidgetOrder()}),!1}function editWidget(a){return jQuery(\"#server_messages\").html(\"\"),msg=\"wi_ID=\"+a.substr(6,a.length),SendAdminRequest(\"widgets\",\"edit\",msg,!0),!1}function widgetSettings(a,b,c){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeWidgetSettings()\"></div><div id=\"widget_settings\" class=\"modal-content\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#widget_settings\").html(a).addClass(\"widget_settings_active edit_widget_\"+b+\"_\"+c),jQuery(\"#widget_settings\").prepend(jQuery(\"#server_messages\")),AttachServerRequest(\"form\");var d=jQuery(\"#widget_settings\").find(\"h2.page-title:first\");if(d.length>0){var e=jQuery(\"#widget_settings\").find(\"span.pull-right:first\"),f=\"\";e.length>0&&(e.find(\"a.close_link\").remove(),f='<span class=\"pull-right\">'+e.html()+\"</span>\",e.remove()),jQuery(\"#widget_settings\").prepend('<div class=\"modal-header\"><button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>'+f+'<h4 class=\"modal-title\">'+d.html()+\"</h4></div>\"),d.remove(),jQuery(\"#widget_settings button.close\").bind(\"click\",closeWidgetSettings)}jQuery(\"#widget_settings a.close_link\").bind(\"click\",closeWidgetSettings);var g=27;jQuery(document).keyup(function(a){a.keyCode==g&&closeWidgetSettings()})}function widgetSettingsCallback(a,b,c){jQuery(\"#wi_ID_\"+a+\" .widget_name\").html(b),jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,c))}function closeWidgetSettings(){return jQuery(\"#widget_settings\").hide(),jQuery(\"#server_messages\").insertBefore(\".available_widgets\"),jQuery(\"#widget_settings\").remove(),jQuery(\"#screen_mask\").remove(),!1}function showMessagesWidgetSettings(){return jQuery(\"#widget_settings\").animate({scrollTop:jQuery(\"#widget_settings\").scrollTop()+ +jQuery(\"#server_messages\").position().top-20},100),!1}function T_(a){return\"undefined\"==typeof T_arr[a]?a:T_arr[a]}function convertAvailableList(){jQuery(\".fieldset_title > span > a[id^='add_new']\").attr(\"href\",\"#\").bind(\"click\",function(a){jQuery(\"body\").append('<div id=\"screen_mask\" onclick=\"closeAvailableWidgets()\"></div>'),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),offset=jQuery(this).offset();var b=offset.top,c=jQuery(document).height()-10-jQuery(\".available_widgets\").height();return 20>c&&(c=20),b>c&&(b=c),jQuery(\".available_widgets\").addClass(\"available_widgets_active\").attr(\"id\",\"available_\"+jQuery(this).attr(\"id\")),!1}),jQuery(\".available_widgets_toolbar > a\").bind(\"click\",function(a){return closeAvailableWidgets(),!1});var a=27;jQuery(document).keyup(function(b){return b.keyCode==a?(closeAvailableWidgets(),!1):void 0}),jQuery(\".available_widgets li\").each(function(){jQuery(this).addClass(\"new_widget\");var a=jQuery(this).children(\"a\").attr(\"href\");a=a.substr(a.indexOf(\"&type\")+1,a.length),jQuery(this).children(\"a:first\").attr(\"href\",\"#\").bind(\"click\",function(){return addNewWidget(this,a),!1})})}function closeAvailableWidgets(){jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(\"#screen_mask\").remove()}function addNewWidget(a,b){closeAvailableWidgets();var c=jQuery(a).attr(\"id\");jQuery(a).attr(\"id\",c);var d=(jQuery(a).html(),jQuery(\".available_widgets\").attr(\"id\"));d=d.substr(18,d.length).replace(/_/g,\" \").replace(/-/g,\":\"),SendAdminRequest(\"widgets\",\"create\",b+\"&blog=\"+blog+\"&container=\"+d,!0)}function addNewWidgetCallback(a,b,c,d,e){jQuery(\".fade_me\").removeClass(\"fade_me\"),createWidget(\"wi_ID_\"+a,b.replace(/ /g,\"_\").replace(/:/g,\"-\"),c,d,\"\",1,e),doFade(\"#wi_ID_\"+a),reorder_delay_remaining>0?reorder_delay_remaining=0:current_widgets=getWidgetOrder()}function createWidget(a,b,c,d,e,f,g){var h=jQuery('<li id=\"'+a+'\" class=\"draggable_widget\"><span>'+d+\"</span></li>\");h.find(\"a.widget_name\").click(function(){return editWidget(a)}),e&&jQuery(h).addClass(e),jQuery(h).prepend(jQuery('<span class=\"widget_state\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?enabled_icon_tag:disabled_icon_tag)+\"</a></span>\"));var i=jQuery('<span class=\"widget_cache_status\">'+getWidgetCacheIcon(a,g)+\"</span>\");jQuery(h).prepend(i);var j=jQuery('<span class=\"widget_actions\"><a href=\"#\" class=\"toggle_action\" onclick=\"return toggleWidget( \\''+a+\"' );\\\">\"+(f?deactivate_icon_tag:activate_icon_tag)+'</a><a href=\"#\" onclick=\"return editWidget( \\''+a+\"' );\\\">\"+edit_icon_tag+'</a><a href=\"#\" onclick=\"return deleteWidget( \\''+a+\"' );\\\">\"+delete_icon_tag+\"</a></span>\");jQuery(h).prepend(j),jQuery(h).prepend(jQuery('<span class=\"widget_checkbox'+(f?\" widget_checkbox_enabled\":\"\")+'\"><input type=\"checkbox\" name=\"widgets[]\" value=\"'+a.replace(\"wi_ID_\",\"\")+'\" /></span>')),jQuery(\"#container_\"+b).append(h),makeDragnDrop(\"#\"+a),colourWidgets()}function toggleWidget(a){return SendAdminRequest(\"widgets\",\"toggle\",\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggle(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_state\").html('<a href=\"#\" class=\"toggle_state\" onclick=\"return toggleWidget( \\'wi_ID_'+a+\"', '\"+crumb_url+\"' );\\\">\"+(b?enabled_icon_tag:disabled_icon_tag)+\"</a>\"),b?jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").addClass(\"widget_checkbox_enabled\"):jQuery(\"#wi_ID_\"+a+\" .widget_checkbox\").removeClass(\"widget_checkbox_enabled\"),jQuery(\"#wi_ID_\"+a+\" .toggle_action\").html(b?deactivate_icon_tag:activate_icon_tag),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function toggleCacheWidget(a,b){return SendAdminRequest(\"widgets\",\"cache_\"+b,\"wi_ID=\"+a.substr(6)+\"&\"+crumb_url,!0),!1}function doToggleCache(a,b){jQuery(\"#wi_ID_\"+a+\" .widget_cache_status\").html(getWidgetCacheIcon(\"wi_ID_\"+a,b)),evoFadeBg(jQuery(\"#wi_ID_\"+a),new Array(\"#FFFF33\"),{speed:3e3})}function str_repeat(a,b){return new Array(b+1).join(a)}function getWidgetCacheIcon(a,b){switch(b){case\"enabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'disable' );\\\">\"+cache_enabled_icon_tag+\"</a>\";case\"disabled\":return'<a href=\"#\" class=\"cache_action\" onclick=\"return toggleCacheWidget( \\''+a+\"', 'enable' );\\\">\"+cache_disabled_icon_tag+\"</a>\";case\"disallowed\":return cache_disallowed_icon_tag;case\"denied\":return'<a href=\"?ctrl=coll_settings&amp;tab=advanced&amp;blog='+blog+'#fieldset_wrapper_caching\">'+cache_denied_icon_tag+\"</a>\"}}function openModalWindow(a,b,c,d,e,f){var g=\"overlay_page_active\";\"undefined\"!=typeof d&&1==d&&(g=\"overlay_page_active_transparent\"),\"undefined\"==typeof b&&(b=\"560px\");var h=\"\";return\"undefined\"!=typeof c&&(c>0||\"\"!=c)&&(h=' style=\"height:'+c+'\"'),jQuery(\"#overlay_page\").length>0?void jQuery(\"#overlay_page\").html(a):(jQuery(\"body\").append('<div id=\"screen_mask\"></div><div id=\"overlay_wrap\" style=\"width:'+b+'\"><div id=\"overlay_layout\"><div id=\"overlay_page\"'+h+\"></div></div></div>\"),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#overlay_page\").html(a).addClass(g),void jQuery(document).on(\"click\",\"#close_button, #screen_mask, #overlay_page\",function(a){if(\"overlay_page\"==jQuery(this).attr(\"id\")){var b=jQuery(\"#overlay_page form\");if(b.length){var c=b.position().top+jQuery(\"#overlay_wrap\").position().top,d=c+b.height();a.clientY>c&&a.clientY<d||closeModalWindow()}return!0}return closeModalWindow(),!1}))}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#overlay_page\",a).hide(),jQuery(\".action_messages\",a).remove(),jQuery(\"#server_messages\",a).insertBefore(\".first_payload_block\"),jQuery(\"#overlay_wrap\",a).remove(),jQuery(\"#screen_mask\",a).remove(),!1}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_deldata(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"],!0),jQuery.ajax({type:\"POST\",url:evo_js_user_deldata_ajax_url,data:{ctrl:\"user\",user_tab:\"deldata\",user_tab_from:b,user_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,\"btn-danger\"])}}),!1}function user_add_org(a){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"add_user\",org_ID:a,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add),jQuery(\"input.autocomplete_login\").trigger(\"added\")}}),!1}function user_edit(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"edit_user\",org_ID:a,user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,evo_js_lang_edit_membership,evo_js_lang_edit)}}),!1}function user_remove(a,b){return openModalWindow('<span class=\"loader_img loader_user_deldata absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_org_ajax_url,data:{ctrl:\"organizations\",action:\"remove_user\",user_ID:b,display_mode:\"js\",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,\"450px\",\"\",!0,'<span class=\"text-danger\">'+evo_js_lang_remove_user_membership+\"</span>\",evo_js_lang_remove)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height();b!=a&&jQuery(\"#attachments_fieldset_wrapper\").height(jQuery(\"#attachments_fieldset_table\").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+\"anon_async.php?action=set_object_link_position&link_ID=\"+a.id.substr(17)+\"&link_position=\"+e+\"&crumb_link=\"+c,{},function(b,c){b=ajax_debug_clear(b),\"OK\"==b?(evoFadeSuccess(jQuery(d).closest(\"tr\")),jQuery(d).closest(\"td\").removeClass(\"error\"),\"cover\"==e&&jQuery(\"select[name=link_position][id!=\"+a.id+\"] option[value=cover]:selected\").each(function(){jQuery(this).parent().val(\"aftermore\"),evoFadeSuccess(jQuery(this).closest(\"tr\"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest(\"tr\")),jQuery(d.form).closest(\"td\").addClass(\"error\"))}),!1}function evo_link_insert_inline(a,b,c){if(\"undefined\"!=typeof b2evoCanvas){var d=\"[\"+a+\":\"+b;c.length&&(d+=\":\"+c),d+=\"]\",textarea_wrap_selection(b2evoCanvas,d,\"\",0,window.document);var e=jQuery(\"#display_position_\"+b);0!=e.length&&\"inline\"!=e.val()&&(deferInlineReminder=!0,e.val(\"inline\").change(),deferInlineReminder=!1)}}function evo_link_delete(a,b,c,d){return evo_rest_api_request(\"links/\"+c,{action:d},function(d){if(\"item\"==b){var e=window.document.getElementById(\"itemform_post_content\");if(null!=e){var f=new RegExp(\"\\\\[(image|file|inline|video|audio|thumbnail):\"+c+\":?[^\\\\]]*\\\\]\",\"ig\");textarea_str_replace(e,f,\"\",window.document)}}jQuery(a).closest(\"tr\").remove(),evo_link_fix_wrapper_height()},\"DELETE\"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request(\"links/\"+b+\"/\"+c,function(b){var d=jQuery(a).closest(\"tr\");\"move_up\"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},\"POST\"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request(\"links\",{action:\"attach\",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery(\"#attachments_fieldset_table table\",window.parent.document),c=(b.parent,jQuery(a.list_content));b.replaceWith(jQuery(\"table\",c)).promise().done(function(a){setTimeout(function(){window.parent.evo_link_fix_wrapper_height()},10)})}),!1}function evo_link_ajax_loading_overlay(){var a=jQuery(\"#attachments_fieldset_table\"),b=!1;return 0==a.find(\".results_ajax_loading\").length&&(b=jQuery('<div class=\"results_ajax_loading\"><div>&nbsp;</div></div>'),a.css(\"position\",\"relative\"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request(\"links\",{action:\"undefined\"==typeof c?\"refresh\":\"sort\",type:a,object_ID:b},function(a){jQuery(\"#attachments_fieldset_table\").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}b2evo_Callbacks.prototype={register_callback:function(a,b,c){\"undefined\"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=new Array),\"undefined\"!=typeof c&&c?this.eventHandlers[a][0]=b:this.eventHandlers[a][this.eventHandlers[a].length]=b},trigger_callback:function(event,args){if(\"undefined\"==typeof this.eventHandlers[event])return null;for(var r=!1,cb_args=\"\",cb_arguments=arguments,i=1;i<arguments.length;i++)cb_args+=\"cb_arguments[\"+i+\"], \";cb_args.length&&(cb_args=cb_args.substring(0,cb_args.length-2));for(var i=0;i<this.eventHandlers[event].length;i++){var f=this.eventHandlers[event][i];r=eval(\"f(\"+cb_args+\");\")||r}return r}};var b2evo_Callbacks=new b2evo_Callbacks;evo_alert_events_initialized=!1,jQuery(document).ready(function(){function a(a){var b=a.data(\"prefix\")?a.data(\"prefix\"):\"\",c=jQuery(\".\"+b+a.val()+\"_toolbar\");return 0==c.length?!0:void(a.is(\":checked\")?(c.removeClass(\"disabled\"),c.find(\"input[type=button]\").removeAttr(\"disabled\")):(c.addClass(\"disabled\"),c.find(\"input[type=button]\").attr(\"disabled\",\"disabled\")))}jQuery(document).on(\"click\",\"[data-func]\",function(){var a=jQuery(this).data(\"func\").match(/([^\\\\|]|\\\\\\|)+/g),b=a[0];a.splice(0,1);for(var c=0;c<a.length;c++)a[c].indexOf(\"b2evoCanvas\")>-1?a[c]=window[a[c]]:\" \"==a[c]?a[c]=\"\":a[c]=a[c].replace(/\\\\\\|/g,\"|\");return jQuery(this).closest(\".disabled[class*=_toolbar]\").length>0?!1:(window[b].apply(null,a),!1)}),jQuery('input[type=checkbox][name=\"renderers[]\"]').each(function(){a(jQuery(this))}),jQuery('input[type=checkbox][name=\"renderers[]\"]').click(function(){a(jQuery(this))})}),jQuery(document).ready(function(){jQuery(\".pblock\").length?jQuery('<div id=\"server_messages\"></div>').prependTo(\".pblock\"):jQuery(\".level2\").length?jQuery(\".level2\").after('<div id=\"server_messages\"></div>'):jQuery(\".navbar.level1\").after('<div id=\"server_messages\"></div>'),jQuery('<iframe id=\"server_postback\" name=\"server_postback\"></iframe>').appendTo(\"body\").css({\n+position:\"absolute\",left:\"-1000em\",top:\"-1000em\"})});var _b2evoCommunications=function(){var a,b,c=2500,d=250;return{Init:function(){var e=jQuery.fn.extend({delay:c,interval:d,dispatcher:b},arguments.length?arguments[0]:\"\");c=e.delay,d=e.interval,b=e.dispatcher,a=this,b2evoHelper.info(\"Communications object ready\")},BufferedServerCall:function(){var b=jQuery.fn.extend({ticker_callback:function(){return!0},send_callback:function(){},delay:c,interval:d,buffer_name:\"\"},arguments.length?arguments[0]:\"\");if(ticker_status=b.ticker_callback(b.delay))switch(ticker_status!==!0&&b2evoHelper.log(\"Ticker status : \"+ticker_status),ticker_status){case\"cancel\":return void b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Update cancelled\")+\"</div>\");case\"pause\":return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Update Paused\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);case\"ignore\":return void a.BufferedServerLoop(b);case\"immediate\":break;default:if(b.delay-=b.interval,b.delay>0)return b2evoHelper.DisplayMessage('<div class=\"log_error\">'+T_(\"Changes pending\")+\" : \"+b2evoHelper.str_repeat(\".\",b.delay/b.interval)+\"</div>\"),void a.BufferedServerLoop(b);b2evoHelper.DisplayMessage('<div class=\"log_message\">'+T_(\"Saving changes\")+\"</div>\"),b.send_callback()}},BufferedServerLoop:function(b){var c=jQuery(a).data(\"buffers\");\"undefined\"==typeof c&&(c=Array()),c[b.buffer_name]=b,jQuery(a).data(\"buffers\",c),window.setTimeout('b2evoCommunications.BufferedServerCallback( \"'+b.buffer_name+'\" )',b.interval)},BufferedServerCallback:function(b){var c=jQuery(a).data(\"buffers\");a.BufferedServerCall(c[b])},SendAdminRequest:function(){var c=jQuery.fn.extend({ctrl:\"\",action:\"\",data:\"\",key:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\"),d=\"ctrl=\"+c.ctrl+\"&key=\"+c.key+\"&action=\"+c.action+\"&\"+c.data;a.SendServerRequest({url:b,data:d,error:c.error,ok:c.ok})},SendServerRequest:function(){var a=jQuery.fn.extend({url:\"\",data:\"\",error:function(){return!1},ok:function(){return!1}},arguments.length?arguments[0]:\"\");if(a.url){a.url+=(a.url.indexOf(\"?\")===!0?\"&\":\"?\")+\"mode=js\",a.data&&(a.url+=\"&\"+a.data);var b=jQuery('<script type=\"text/javascript\"></script>');b.attr(\"src\",a.url),b.load(a.ok()),b.error(a.error()),b.appendTo(\"body\"),b2evoHelper.log(\"Sending request : \"+a.url)}}}},b2evoCommunications=new _b2evoCommunications;jQuery(document).ready(function(){jQuery(\"[id^=fadeout-]\").each(function(){evoFadeBg(this,new Array(\"#FFFF33\"),{speed:3e3})})}),jQuery(document).on(\"change\",\".btn-file :file\",function(){var a=jQuery(this).val().replace(/\\\\/g,\"/\").replace(/.*\\//,\"\");jQuery(this).parent().next().html(a)});var edit_icon_tag=\"\",delete_icon_tag=\"\",current_widgets=\"\",reorder_widgets_queue,reorder_delay=200,reorder_delay_remaining=0,crumb_url=\"\";jQuery(document).ready(function(){if(0!=jQuery(\"#current_widgets\").length){edit_icon_tag=jQuery(\".edit_icon_hook\").find(\"a\").html(),delete_icon_tag=jQuery(\".delete_icon_hook\").find(\"a\").html(),crumb_url=jQuery(\".delete_icon_hook\").find(\"a\").attr(\"href\"),\"undefined\"!=typeof crumb_url&&(crumb_url=crumb_url.match(/crumb_.*?$/)),jQuery(\".new_widget\").parent().parent().remove(),jQuery(\".odd\").addClass(\"widget_row\").removeClass(\".odd\"),jQuery(\".even\").addClass(\"widget_row\").removeClass(\".even\"),jQuery(\".fieldset_title\").each(function(){jQuery(this).droppable({accept:\".draggable_widget\",hoverClass:\"droppable-hover\",greedy:!0,tolerance:\"pointer\",delay:1e3,drop:function(a,b){jQuery(\".fade_me\").removeClass(\"fade_me\"),jQuery(\".available_widgets\").removeClass(\"available_widgets_active\"),jQuery(b.draggable).prependTo(jQuery(\"#container_\"+jQuery(this).find(\".container_name\").html().replace(/ /g,\"_\").replace(/:/g,\"-\"))),jQuery(b.draggable).addClass(\"fade_me server_update\"),jQuery(b.draggable).droppable(\"enable\"),doFade(\".fade_me\"),colourWidgets(),sendWidgetOrder()}})}),jQuery(\".widget_row td:nth-child(7)\").each(function(){var a=jQuery(this).find(\"a\").attr(\"href\");a=a.match(/wi_ID=([0-9]+)/)[1],jQuery(this).parent().attr(\"id\",\"wi_ID_\"+a)});var a=new Array;jQuery(\".widget_container_list\").each(function(){var b=jQuery(this).attr(\"id\");a[b]=new Array,jQuery(\"#\"+b+\" .widget_row\").each(function(){var c=jQuery(this).attr(\"id\");a[b][c]=new Array,a[b][c].name=jQuery(\"#\"+c).find(\".widget_name\").parent().html(),a[b][c][\"class\"]=jQuery(this).attr(\"className\"),a[b][c].enabled=jQuery(\"#\"+c+\" .widget_is_enabled\").size(),a[b][c].cache=jQuery(\"#\"+c+\" .widget_cache_status [rel]\").attr(\"rel\")})});for(container in a){var b=!jQuery(\"#\"+container).hasClass(\"no-drop\");newContainer=jQuery('<ul id=\"container_'+container+'\" class=\"widget_container\"></ul>'),b||jQuery(newContainer).addClass(\"no-drop\"),jQuery(\"#\"+container).replaceWith(newContainer);for(widget in a[container])createWidget(widget,container,0,a[container][widget].name,a[container][widget][\"class\"],a[container][widget].enabled,a[container][widget].cache)}jQuery(\".no-drop .draggable_widget\").droppable(\"disable\"),jQuery(\".draggable_widget\").bind(\"mousedown\",function(){jQuery(this).hasClass(\"new_widget\")||jQuery(\".available_widgets_active\").removeClass(\"available_widgets_active\")}),colourWidgets(),convertAvailableList(),current_widgets=getWidgetOrder(),doFade(\".fadeout-ffff00\"),jQuery(\"#widget_button_check_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!0)}),jQuery(\"#widget_button_uncheck_all\").click(function(){jQuery(this).closest(\"form\").find(\"input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_active\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!0),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!1)}),jQuery(\"#widget_button_check_inactive\").click(function(){jQuery(this).closest(\"form\").find(\".widget_checkbox.widget_checkbox_enabled input[type=checkbox]\").prop(\"checked\",!1),jQuery(this).closest(\"form\").find(\".widget_checkbox:not(.widget_checkbox_enabled) input[type=checkbox]\").prop(\"checked\",!0)})}}),jQuery(document).keyup(function(a){27==a.keyCode&&closeModalWindow()}),jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).ready(function(){var a=jQuery(\"#attachments_fieldset_table\").height();a=a>320?320:97>a?97:a,jQuery(\"#attachments_fieldset_wrapper\").height(a),jQuery(\"#attachments_fieldset_wrapper\").resizable({minHeight:80,handles:\"s\",resize:function(a,b){jQuery(\"#attachments_fieldset_wrapper\").resizable(\"option\",\"maxHeight\",jQuery(\"#attachments_fieldset_table\").height())}}),jQuery(document).on(\"click\",\"#attachments_fieldset_wrapper .ui-resizable-handle\",function(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height()+80;jQuery(\"#attachments_fieldset_wrapper\").css(\"height\",b>a?a:b)})});\n\\ No newline at end of file"
        },
        {
          "filename": "rsc/js/build/evo_frontoffice.bmin.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,2 +1,2 @@\n /* This includes 8 files: src/evo_modal_window.js, src/evo_images.js, src/evo_user_crop.js, src/evo_user_report.js, src/evo_user_contact_groups.js, src/evo_rest_api.js, src/evo_item_flag.js, ajax.js */\n-function openModalWindow(a,b,c,d,e,f){var g=\"overlay_page_active\";\"undefined\"!=typeof d&&1==d&&(g=\"overlay_page_active_transparent\"),\"undefined\"==typeof b&&(b=\"560px\");var h=\"\";return\"undefined\"!=typeof c&&(c>0||\"\"!=c)&&(h=' style=\"height:'+c+'\"'),jQuery(\"#overlay_page\").length>0?void jQuery(\"#overlay_page\").html(a):(jQuery(\"body\").append('<div id=\"screen_mask\"></div><div id=\"overlay_wrap\" style=\"width:'+b+'\"><div id=\"overlay_layout\"><div id=\"overlay_page\"'+h+\"></div></div></div>\"),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#overlay_page\").html(a).addClass(g),void jQuery(document).on(\"click\",\"#close_button, #screen_mask, #overlay_page\",function(a){if(\"overlay_page\"==jQuery(this).attr(\"id\")){var b=jQuery(\"#overlay_page form\");if(b.length){var c=b.position().top+jQuery(\"#overlay_wrap\").position().top,d=c+b.height();a.clientY>c&&a.clientY<d||closeModalWindow()}return!0}return closeModalWindow(),!1}))}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#overlay_page\",a).hide(),jQuery(\".action_messages\",a).remove(),jQuery(\"#server_messages\",a).insertBefore(\".first_payload_block\"),jQuery(\"#overlay_wrap\",a).remove(),jQuery(\"#screen_mask\",a).remove(),!1}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_contact_groups(a){return openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_contact_groups_ajax_url,data:{action:\"get_user_contact_form\",blog:evo_js_blog,user_ID:a,crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}jQuery(document).keyup(function(a){27==a.keyCode&&closeModalWindow()}),jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).on(\"click\",\"a.evo_post_flag_btn\",function(){var a=jQuery(this),b=parseInt(a.data(\"id\"));return b>0&&(a.data(\"status\",\"inprogress\"),jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\"),evo_rest_api_request(\"collections/\"+a.data(\"coll\")+\"/items/\"+b+\"/flag\",function(b){b.flag?(a.find(\"span:first\").show(),a.find(\"span:last\").hide()):(a.find(\"span:last\").show(),a.find(\"span:first\").hide()),jQuery(\"span\",a).removeClass(\"fa-x--hover\"),setTimeout(function(){a.removeData(\"status\")},500)})),!1}),jQuery(document).on(\"mouseover\",\"a.evo_post_flag_btn\",function(){\"inprogress\"!=jQuery(this).data(\"status\")&&jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\")});\n\\ No newline at end of file\n+function openModalWindow(a,b,c,d,e,f){var g=\"overlay_page_active\";\"undefined\"!=typeof d&&1==d&&(g=\"overlay_page_active_transparent\"),\"undefined\"==typeof b&&(b=\"560px\");var h=\"\";return\"undefined\"!=typeof c&&(c>0||\"\"!=c)&&(h=' style=\"height:'+c+'\"'),jQuery(\"#overlay_page\").length>0?void jQuery(\"#overlay_page\").html(a):(jQuery(\"body\").append('<div id=\"screen_mask\"></div><div id=\"overlay_wrap\" style=\"width:'+b+'\"><div id=\"overlay_layout\"><div id=\"overlay_page\"'+h+\"></div></div></div>\"),jQuery(\"#screen_mask\").fadeTo(1,.5).fadeIn(200),jQuery(\"#overlay_page\").html(a).addClass(g),void jQuery(document).on(\"click\",\"#close_button, #screen_mask, #overlay_page\",function(a){if(\"overlay_page\"==jQuery(this).attr(\"id\")){var b=jQuery(\"#overlay_page form\");if(b.length){var c=b.position().top+jQuery(\"#overlay_wrap\").position().top,d=c+b.height();a.clientY>c&&a.clientY<d||closeModalWindow()}return!0}return closeModalWindow(),!1}))}function closeModalWindow(a){return\"undefined\"==typeof a&&(a=window.document),jQuery(\"#overlay_page\",a).hide(),jQuery(\".action_messages\",a).remove(),jQuery(\"#server_messages\",a).insertBefore(\".first_payload_block\"),jQuery(\"#overlay_wrap\",a).remove(),jQuery(\"#screen_mask\",a).remove(),!1}function user_crop_avatar(a,b,c){\"undefined\"==typeof c&&(c=\"avatar\");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:e>i?e:i,h=h>d?d:e>h?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id=\"spinner\" class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"],!0);var o=jQuery(\"div.modal-dialog div.modal-body\").length?jQuery(\"div.modal-dialog div.modal-body\"):jQuery(\"#overlay_page\"),p={top:parseInt(o.css(\"paddingTop\")),right:parseInt(o.css(\"paddingRight\")),bottom:parseInt(o.css(\"paddingBottom\")),left:parseInt(o.css(\"paddingLeft\"))},q=(jQuery(\"div.modal-dialog div.modal-body\").length?parseInt(o.css(\"min-height\")):n-100)-(p.top+p.bottom),r=m-(p.left+p.right),s={user_ID:a,file_ID:b,aspect_ratio:j,content_width:r,content_height:q,display_mode:\"js\",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(s.ctrl=\"user\",s.user_tab=\"crop\",s.user_tab_from=c):(s.blog=evo_js_blog,s.disp=\"avatar\",s.action=\"crop\"),jQuery.ajax({type:\"POST\",url:evo_js_user_crop_ajax_url,data:s,success:function(a){openModalWindow(a,m+\"px\",n+\"px\",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,\"btn-primary\"])}}),!1}function user_report(a,b){openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"],!0);var c={action:\"get_user_report_form\",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:\"POST\",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,\"btn-danger\"])}}),!1}function user_contact_groups(a){return openModalWindow('<span class=\"loader_img loader_user_report absolute_center\" title=\"'+evo_js_lang_loading+'\"></span>',\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0),jQuery.ajax({type:\"POST\",url:evo_js_user_contact_groups_ajax_url,data:{action:\"get_user_contact_form\",blog:evo_js_blog,user_ID:a,crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,\"auto\",\"\",!0,evo_js_lang_contact_groups,evo_js_lang_save,!0)}}),!1}function evo_rest_api_request(url,params_func,func_method,method){var params=params_func,func=func_method;\"function\"==typeof params_func&&(func=params_func,params={},method=func_method),\"undefined\"==typeof method&&(method=\"GET\"),jQuery.ajax({contentType:\"application/json; charset=utf-8\",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){\"object\"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height();b!=a&&jQuery(\"#attachments_fieldset_wrapper\").height(jQuery(\"#attachments_fieldset_table\").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+\"anon_async.php?action=set_object_link_position&link_ID=\"+a.id.substr(17)+\"&link_position=\"+e+\"&crumb_link=\"+c,{},function(b,c){b=ajax_debug_clear(b),\"OK\"==b?(evoFadeSuccess(jQuery(d).closest(\"tr\")),jQuery(d).closest(\"td\").removeClass(\"error\"),\"cover\"==e&&jQuery(\"select[name=link_position][id!=\"+a.id+\"] option[value=cover]:selected\").each(function(){jQuery(this).parent().val(\"aftermore\"),evoFadeSuccess(jQuery(this).closest(\"tr\"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest(\"tr\")),jQuery(d.form).closest(\"td\").addClass(\"error\"))}),!1}function evo_link_insert_inline(a,b,c){if(\"undefined\"!=typeof b2evoCanvas){var d=\"[\"+a+\":\"+b;c.length&&(d+=\":\"+c),d+=\"]\",textarea_wrap_selection(b2evoCanvas,d,\"\",0,window.document);var e=jQuery(\"#display_position_\"+b);0!=e.length&&\"inline\"!=e.val()&&(deferInlineReminder=!0,e.val(\"inline\").change(),deferInlineReminder=!1)}}function evo_link_delete(a,b,c,d){return evo_rest_api_request(\"links/\"+c,{action:d},function(d){if(\"item\"==b){var e=window.document.getElementById(\"itemform_post_content\");if(null!=e){var f=new RegExp(\"\\\\[(image|file|inline|video|audio|thumbnail):\"+c+\":?[^\\\\]]*\\\\]\",\"ig\");textarea_str_replace(e,f,\"\",window.document)}}jQuery(a).closest(\"tr\").remove(),evo_link_fix_wrapper_height()},\"DELETE\"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request(\"links/\"+b+\"/\"+c,function(b){var d=jQuery(a).closest(\"tr\");\"move_up\"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},\"POST\"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request(\"links\",{action:\"attach\",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery(\"#attachments_fieldset_table table\",window.parent.document),c=(b.parent,jQuery(a.list_content));b.replaceWith(jQuery(\"table\",c)).promise().done(function(a){setTimeout(function(){window.parent.evo_link_fix_wrapper_height()},10)})}),!1}function evo_link_ajax_loading_overlay(){var a=jQuery(\"#attachments_fieldset_table\"),b=!1;return 0==a.find(\".results_ajax_loading\").length&&(b=jQuery('<div class=\"results_ajax_loading\"><div>&nbsp;</div></div>'),a.css(\"position\",\"relative\"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request(\"links\",{action:\"undefined\"==typeof c?\"refresh\":\"sort\",type:a,object_ID:b},function(a){jQuery(\"#attachments_fieldset_table\").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,\"\"),a=a.replace(/(<div class=\"jslog\">[\\s\\S]*)/i,\"\"),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/,c=a.match(b);return c?(a=ajax_debug_clear(a),\"\"!=a):!1}jQuery(document).keyup(function(a){27==a.keyCode&&closeModalWindow()}),jQuery(document).ready(function(){jQuery(\"img.loadimg\").each(function(){jQuery(this).prop(\"complete\")?(jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")):jQuery(this).on(\"load\",function(){jQuery(this).removeClass(\"loadimg\"),\"\"==jQuery(this).attr(\"class\")&&jQuery(this).removeAttr(\"class\")})})}),jQuery(document).on(\"click\",\"a.evo_post_flag_btn\",function(){var a=jQuery(this),b=parseInt(a.data(\"id\"));return b>0&&(a.data(\"status\",\"inprogress\"),jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\"),evo_rest_api_request(\"collections/\"+a.data(\"coll\")+\"/items/\"+b+\"/flag\",function(b){b.flag?(a.find(\"span:first\").show(),a.find(\"span:last\").hide()):(a.find(\"span:last\").show(),a.find(\"span:first\").hide()),jQuery(\"span\",a).removeClass(\"fa-x--hover\"),setTimeout(function(){a.removeData(\"status\")},500)})),!1}),jQuery(document).on(\"mouseover\",\"a.evo_post_flag_btn\",function(){\"inprogress\"!=jQuery(this).data(\"status\")&&jQuery(\"span\",jQuery(this)).addClass(\"fa-x--hover\")}),jQuery(document).ready(function(){var a=jQuery(\"#attachments_fieldset_table\").height();a=a>320?320:97>a?97:a,jQuery(\"#attachments_fieldset_wrapper\").height(a),jQuery(\"#attachments_fieldset_wrapper\").resizable({minHeight:80,handles:\"s\",resize:function(a,b){jQuery(\"#attachments_fieldset_wrapper\").resizable(\"option\",\"maxHeight\",jQuery(\"#attachments_fieldset_table\").height())}}),jQuery(document).on(\"click\",\"#attachments_fieldset_wrapper .ui-resizable-handle\",function(){var a=jQuery(\"#attachments_fieldset_table\").height(),b=jQuery(\"#attachments_fieldset_wrapper\").height()+80;jQuery(\"#attachments_fieldset_wrapper\").css(\"height\",b>a?a:b)})});\n\\ No newline at end of file"
        },
        {
          "filename": "rsc/js/src/evo_links.js",
          "status": "modified",
          "additions": 11,
          "deletions": 13,
          "patch": "@@ -46,7 +46,7 @@ function evo_link_fix_wrapper_height()\n {\r\n \tvar table_height = jQuery( '#attachments_fieldset_table' ).height();\r\n \tvar wrapper_height = jQuery( '#attachments_fieldset_wrapper' ).height();\r\n-\tif( wrapper_height > table_height )\r\n+\tif( wrapper_height != table_height )\r\n \t{\r\n \t\tjQuery( '#attachments_fieldset_wrapper' ).height( jQuery( '#attachments_fieldset_table' ).height() );\r\n \t}\r\n@@ -64,7 +64,7 @@ function evo_link_change_position( selectInput, url, crumb )\n {\r\n \tvar oThis = selectInput;\r\n \tvar new_position = selectInput.value;\r\n-\tjQuery.get( url + 'async.php?action=set_object_link_position&link_ID=' + selectInput.id.substr(17) + '&link_position=' + new_position + '&crumb_link=' + crumb, {\r\n+\tjQuery.get( url + 'anon_async.php?action=set_object_link_position&link_ID=' + selectInput.id.substr(17) + '&link_position=' + new_position + '&crumb_link=' + crumb, {\r\n \t}, function(r, status) {\r\n \t\tr = ajax_debug_clear( r );\r\n \t\tif( r == \"OK\" ) {\r\n@@ -147,7 +147,7 @@ function evo_link_delete( event_object, type, link_ID, action )\n \t\t\tvar b2evoCanvas = window.document.getElementById( 'itemform_post_content' );\r\n \t\t\tif( b2evoCanvas != null )\r\n \t\t\t{ // Canvas exists\r\n-\t\t\t\tvar regexp = new RegExp( '\\\\\\[(image|file|inline|video|audio):' + link_ID + ':?[^\\\\\\]]*\\\\\\]', 'ig' );\r\n+\t\t\t\tvar regexp = new RegExp( '\\\\\\[(image|file|inline|video|audio|thumbnail):' + link_ID + ':?[^\\\\\\]]*\\\\\\]', 'ig' );\r\n \t\t\t\ttextarea_str_replace( b2evoCanvas, regexp, '', window.document );\r\n \t\t\t}\r\n \t\t}\r\n@@ -217,16 +217,14 @@ function evo_link_attach( type, object_ID, root, path )\n \tfunction( data )\r\n \t{\r\n \t\tvar table_obj = jQuery( '#attachments_fieldset_table table', window.parent.document );\r\n-\t\tif( table_obj.length > 0 && typeof( data.link ) != 'undefined' )\r\n-\t\t{\t// Append new link to the attachments table:\r\n-\t\t\ttable_obj.append( '<tr>' +\r\n-\t\t\t\t\t'<td class=\"firstcol shrinkwrap\">' + data.link.preview + '</td>' +\r\n-\t\t\t\t\t'<td class=\"fm_filename\">' + data.link.url + '</td>' +\r\n-\t\t\t\t\t'<td class=\"shrinkwrap link_id_cell\">' + data.link.ID + '</td>' +\r\n-\t\t\t\t\t'<td class=\"shrinkwrap\">' + data.link.actions + '</td>' +\r\n-\t\t\t\t\t'<td class=\"lastcol shrinkwrap\">' + data.link.position + '</td>' +\r\n-\t\t\t\t'</tr>' );\r\n-\t\t}\r\n+\t\tvar table_parent = table_obj.parent;\r\n+\t\tvar results_obj = jQuery( data.list_content );\r\n+\t\ttable_obj.replaceWith( jQuery( 'table', results_obj ) ).promise().done( function( e ) {\r\n+\t\t\t// Delay for a few milleseconds after content is loaded to get the correct height\r\n+\t\t\tsetTimeout( function() {\r\n+\t\t\t\twindow.parent.evo_link_fix_wrapper_height();\r\n+\t\t\t}, 10 );\r\n+\t\t});\r\n \t} );\r\n \r\n \treturn false;\r"
        },
        {
          "filename": "rsc/less/basic.less",
          "status": "modified",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -380,6 +380,34 @@ label.radiooption {\n }\n // ---------------- //\n \n+// File Select custom control\n+.file_select_wrapper {\n+\tdisplay: flex;\n+\tflex-flow: row wrap;\n+\talign-items: flex-start;\n+\n+\t.file_select_item {\n+\t\t//display: block;\n+\t\t//float: left;\n+\t\tdisplay: flex;\n+\t\tflex-flow: row wrap;\n+\t\tmargin-right: 8px;\n+\t\ttext-align: center;\n+\n+\t\t.item_actions {\n+\t\t\tdisplay: flex;\n+\t\t\tflex-shrink: 1;\n+\t\t\tflex-flow: column wrap;\n+\t\t\tjustify-content: flex-start;\n+\t\t\talign-content: center;\n+\t\t\tjustify-content: center;\n+\t\t\ttext-align: left;\n+\t\t\tmargin-left: 8px;\n+\t\t}\n+\t}\n+}\n+// ---------------- //\n+\n // Enhanced form\n .eform label {\n \tfont-weight:bold;"
        },
        {
          "filename": "rsc/less/bootstrap-basic.less",
          "status": "modified",
          "additions": 29,
          "deletions": 1,
          "patch": "@@ -371,6 +371,34 @@ label.radiooption {\n }\n // ---------------- //\n \n+// File Select custom control\n+.file_select_wrapper {\n+\tdisplay: flex;\n+\tflex-flow: row wrap;\n+\talign-items: flex-start;\n+\n+\t.file_select_item {\n+\t\t//display: block;\n+\t\t//float: left;\n+\t\tdisplay: flex;\n+\t\tflex-flow: row wrap;\n+\t\tmargin-right: 8px;\n+\t\ttext-align: center;\n+\n+\t\t.item_actions {\n+\t\t\tdisplay: flex;\n+\t\t\tflex-shrink: 1;\n+\t\t\tflex-flow: column wrap;\n+\t\t\tjustify-content: flex-start;\n+\t\t\talign-content: center;\n+\t\t\tjustify-content: center;\n+\t\t\ttext-align: left;\n+\t\t\tmargin-left: 8px;\n+\t\t}\n+\t}\n+}\n+// ---------------- //\n+\n // Messages:\n div.log_container, div.action_messages {\n \tul, ol, li {\n@@ -586,4 +614,4 @@ li[class^=\"listnav_distance_\"], li[class*=\" listnav_distance_\"] {\n \tli.listnav_last > a {\n \t\tborder-radius: 0;\n \t}\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "rsc/less/bootstrap-blog_base.less",
          "status": "modified",
          "additions": 68,
          "deletions": 0,
          "patch": "@@ -1006,4 +1006,72 @@ input.btn-lg {\n }\n .evo_container__sidebar .evo_poll__title {\n \twhite-space: normal;\n+}\n+\n+// Attachments table:\n+#itemform_links .panel-body {\n+\tpadding: 0;\n+}\n+div.qq-upload-button,\n+div.qq-upload-drop-area,\n+div.qq-upload-drop-area-active {\n+\tborder: 2px dashed #fff;\n+\tbackground: #5bc0de;\n+\t.border-radius(9px);\n+}\n+div.qq-upload-button-hover,\n+div.qq-upload-drop-area,\n+div.qq-upload-drop-area-active {\n+\tbackground: #5cb85c;\n+}\n+ul.qq-upload-list {\n+\tmargin: 0;\n+}\n+div#fileuploader_form {\n+\tpadding: 5px;\n+\theight: 65px;\n+\tbackground: #f5f5f5;\n+}\n+#attachments_fieldset_wrapper {\n+\twidth: 100%;\n+\theight: 160px;\n+\tposition: relative;\n+\tpadding-bottom: 6px;\n+\tbox-sizing: content-box;\n+\t#attachments_fieldset_block {\n+\t\toverflow: auto;\n+\t\theight: 100%;\n+\t}\n+\t.ui-resizable-s {\n+\t\tbackground: #c0c0c0;\n+\t\theight: 6px;\n+\t\tbottom: 0;\n+\t\t&:after {\n+\t\t\tcontent: \"...\";\n+\t\t\tfont-size: 10px;\n+\t\t\ttop: -7px;\n+\t\t\tposition: relative;\n+\t\t\ttext-align: center;\n+\t\t\tdisplay: block;\n+\t\t}\n+\t}\n+\t.table_scroll {\n+\t\t// Use this position to fix red triangle when attachment is dragged by mouse:\n+\t\tposition: relative;\n+\t}\n+\ttable tbody {\n+\t\t.dragged {\n+\t\t\topacity: 0.8;\n+\t\t\tposition: absolute;\n+\t\t}\n+\t\ttd {\n+\t\t\tcursor: move;\n+\t\t}\n+\t}\n+}\n+#filelist_tbody {\n+\ttr:first-child .action_icon_link_move_up,\n+\ttr:last-child .action_icon_link_move_down {\n+\t\tvisibility: hidden;\n+\t}\n }\n\\ No newline at end of file"
        },
        {
          "filename": "skins/pureforums/pureforums.bmin.css",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+.header{margin-bottom:15px;color:#FFF}.header a{color:#FFF}.header a:hover{color:#D6D9E6}.header.site_skins{margin-top:43px}.header .header_top{background-color:#242D36;background-image:-webkit-linear-gradient(#1e252d,#2b3540);background-image:-moz-linear-gradient(#1e252d,#2b3540);background-image:linear-gradient(#1e252d,#2b3540);height:36px;line-height:36px;color:#9FB5C9;font-weight:700}.header .header_bottom{background-color:#3C597F;background-image:-webkit-linear-gradient(#50739b,#283f63);background-image:-moz-linear-gradient(#50739b,#283f63);background-image:linear-gradient(#50739b,#283f63);box-shadow:0 2px 2px rgba(0,0,0,.2),0 1px #5d8cb7 inset;text-align:center}.header .header_bottom .layout_width{position:relative;min-height:56px;display:inline-block;text-align:left}.header .header_bottom .header_right{float:right;border-right:1px solid rgba(140,176,210,.2);margin-left:250px}.header .widget_core_coll_tagline,.header .widget_core_coll_title{position:absolute;left:25px;width:250px;overflow:hidden;white-space:nowrap}.header .widget_core_coll_title{line-height:45px}.header .widget_core_coll_tagline{top:36px;font-size:10px;line-height:10px}.header h1{margin:0}.header .widget_core_coll_search_form{position:relative;height:55px}.header .widget_core_coll_search_form form{padding:11px}.header .widget_core_coll_search_form form .search_field{outline:0;background-color:#EAECF1;background-image:-webkit-linear-gradient(white,#d5d9e3);background-image:-moz-linear-gradient(white,#d5d9e3);background-image:linear-gradient(white,#d5d9e3);border:none;border-radius:5px;box-shadow:0 1px 2px rgba(36,44,51,.5);height:34px;line-height:34px;padding:0 34px 0 10px;transition:width .2s ease 0s;width:100px}.header .widget_core_coll_search_form form .search_field:focus{width:135px}.header .widget_core_coll_search_form form .search_submit{background:0 0;border:none;border-radius:5px;cursor:pointer;font-family:FontAwesome;height:34px;margin:0;overflow:hidden;position:absolute;right:13px;width:25px}body.mobile_device div.pageHeader.site_skins,body.tablet_device div.pageHeader.site_skins{margin-top:0}.header_top ul,.top_menu{float:right;list-style:none;margin:0;padding:0}.top_menu{border-right:1px solid rgba(0,0,0,.25);text-align:right}.header_top ul li{float:left;border-right:1px solid rgba(140,176,210,.2)}.top_menu li{display:inline-block;border-left:1px solid rgba(0,0,0,.25);border-bottom:1px solid rgba(140,176,210,.2)}.header_top ul a,.top_menu a{display:block;font-weight:700;padding:0 20px;text-shadow:0 1px 2px rgba(36,44,51,.5);border-right:1px solid rgba(0,0,0,.25)}.top_menu a,.top_menu li>div{font-size:16px;line-height:56px;border-bottom:1px solid rgba(0,0,0,.25);border-left:1px solid rgba(140,176,210,.2);border-right:none;display:inline-block}.header_top ul li:first-child{border-left:1px solid rgba(0,0,0,.25)}.header_top ul li:first-child a{border-left:1px solid rgba(140,176,210,.2)}.header_top ul li.selected a,.top_menu li.selected a{background-color:rgba(0,0,0,.2);border-left:1px solid rgba(0,0,0,.3);box-shadow:0 5px 10px #20364A inset;margin-left:-1px}.header_top ul li.selected a{box-shadow:0 1px 7px rgba(255,255,255,.2) inset}.header_top .ufld_icon_links{text-align:right}.header_top .ufld_icon_links a{display:inline-block;width:40px}@media (max-width:1200px){.header .header_bottom .header_right{margin-left:200px}.header .widget_core_coll_tagline,.header .widget_core_coll_title{width:200px}.header .widget_core_coll_search_form form .search_field{width:60px}.header .widget_core_coll_search_form form .search_field:focus{width:110px}}@media (max-width:1100px){.header .header_bottom{font-size:80%}.header .header_bottom .header_right{margin-left:150px}.header .widget_core_coll_tagline,.header .widget_core_coll_title{width:150px}.header .widget_core_coll_search_form form{padding:11px 0}.header .widget_core_coll_search_form form .search_field{width:60px}.header .widget_core_coll_search_form form .search_field:focus{width:80px}.top_menu a,.top_menu li>div{font-size:14px;padding:0 10px}}body{background:#FFF;color:#424A52;font:14px Helvetica,Arial,sans-serif}a{color:#306595;text-decoration:none;-webkit-transition:color 150ms ease 0s;transition:color 150ms ease 0s}a:hover{color:#4082BE}div.token-input-dropdown-facebook,input,li.token-input-token-facebook,optgroup,option,select,textarea,ul.ui-autocomplete{font-size:15px Helvetica,Arial,sans-serif}textarea.form_textarea_input{width:95%}.layout_width{box-sizing:border-box;width:100%;max-width:1140px;padding:0 25px;margin:0 auto}@media (max-width:700px){table.legend td{font-size:88%}}h2.page_title{margin-bottom:15px}div#skin_wrapper .sitewide_header{margin-bottom:0;position:fixed;top:0;width:100%;z-index:10000;-webkit-font-smoothing:subpixel-antialiased}div#skin_wrapper.skin_wrapper_loggedin .sitewide_header{top:27px}div.bComment,form.bComment{border:none;padding:0;margin:0;overflow:inherit}form.inskin{padding:0}form#user_checkchanges.bComment{border:none}.ficon{background:url(img/icons.gif) no-repeat;display:inline-block}.ficon.newTopic{background-position:0 0;width:82px;height:25px}.ficon.postReply{background-position:0 -25px;width:82px;height:25px}.ficon.locked{background-position:0 -50px;width:82px;height:25px}.ficon.catBig{background-position:-82px 0;width:26px;height:25px}.ficon.catBigLocked{background-position:-82px -25px;width:26px;height:25px}.ficon.topic{background-position:-108px 0;width:19px;height:18px}.ficon.topicLocked{background-position:-108px -18px;width:19px;height:18px}.ficon.topicSticky{background-position:-108px -36px;width:19px;height:18px}.ficon.latestReply{background-position:-82px -50px;width:16px;height:9px;margin:0 1px}.ficon.minipost{background-position:-91px -50px;width:7px;height:9px;margin:0 3px 0 2px}.ficon.width_increase{background-position:0 -75px;width:32px;height:32px}.ficon.width_decrease{background-position:-32px -75px;width:32px;height:32px}.form_add_contacts .controls{padding-left:0}#edit_group_contacts,.forums_table{width:100%;box-shadow:0 2px 6px rgba(117,124,142,.6);border-radius:5px;margin-bottom:10px}.forums_table.fixed_layout{table-layout:fixed}.forums_table.fixed_layout tr.fixrow0{margin:0}.forums_table.fixed_layout tr.fixrow0 td{padding-top:0;padding-bottom:0;border:none}.bForums.fixed_layout .ft_avatar{width:80px}.forums_table>tbody>tr:first-child>td:first-child,.forums_table>tbody>tr:first-child>th:first-child{border-top-left-radius:5px}.forums_table>tbody>tr:first-child>td:last-child,.forums_table>tbody>tr:first-child>th:last-child{border-top-right-radius:5px}.forums_table>tbody>tr:last-child>td:first-child,.forums_table>tbody>tr:last-child>th:first-child{border-bottom-left-radius:5px}.forums_table>tbody>tr:last-child>td:last-child,.forums_table>tbody>tr:last-child>th:last-child{border-bottom-right-radius:5px}.forums_table .catselect tr td,.forums_table .catselect tr th,.forums_table .grouped tr td,.forums_table .grouped tr th{border-radius:0!important}.forums_table .meta_category th,.forums_table thead th,.messages_list>h2{padding:12px 20px;background-color:#ECEDF3;background-image:-webkit-linear-gradient(#f1f2f6,#e7e9f0);background-image:-moz-linear-gradient(#f1f2f6,#e7e9f0);background-image:linear-gradient(#f1f2f6,#e7e9f0);color:#535C66;font-size:14px;font-weight:700;text-align:left;text-transform:uppercase;text-shadow:0 1px 1px #FFF;box-shadow:0 -1px 2px rgba(0,0,0,.05) inset}.forums_table thead tr:last-child th:first-child,.forums_table thead tr:last-child th:last-child{border-bottom-left-radius:0;border-bottom-right-radius:0}.forums_table .meta_category th a,.forums_table thead th a{color:#535C66}.forums_table td,.forums_table th{border-bottom:1px solid #D1D2DA}.forums_table>tbody>tr:last-child>td,.forums_table>tbody>tr:last-child>th{border:none}.forums_table>tbody>tr>td{padding:10px 0 10px 20px}.forums_table>tbody>tr>td:last-child{padding-right:20px}.forums_table.highlight tr:hover td{background:#f9fafc}.forums_table .ft_status{width:26px}.forums_table .ft_status_topic{width:19px}.forums_table .ft_title>a.forumlink{font-size:21px}.forums_table .ft_title a.topictitle{color:#535C66;font-size:16px}.forums_table .ft_title a.topictitle.unread{font-weight:700}.forums_table .ft_title a.topictitle:hover{color:#31363C}.forums_table .ft_count,.forums_table .ft_desc{color:#8B96A1}.forums_table .ft_count{width:100px}.forums_table .ft_date{width:220px;white-space:nowrap;padding-right:20px}.forums_table .ft_author_info{color:#9CA5AE}.forums_table .ft_author_avatar{float:left;margin-right:10px;display:block}body.round_avatars .forums_table .ft_author_avatar img{border-radius:3px}.forums_table .track_content{margin:0 5px 5px 0}.forums_table .buttons{text-align:center}.topics_table>tbody>tr:last-child>td,.topics_table>tbody>tr>td{border-top:1px solid #D1D2DA;border-bottom:none}.topics_table .table_title th{text-align:left;padding:8px 25px 8px 20px;color:#535c66;font-weight:400;-moz-border-radius-topleft:5px;-webkit-border-top-left-radius:5px;border-top-left-radius:5px;-moz-border-radius-topright:5px;-webkit-border-top-right-radius:5px;border-top-right-radius:5px;-webkit-box-shadow:inset 0 -1px 2px rgba(0,0,0,.1);-moz-box-shadow:inset 0 -1px 2px rgba(0,0,0,.1);box-shadow:inset 0 -1px 2px rgba(0,0,0,.1);background-image:-webkit-linear-gradient(bottom,#e6e8f1,rgba(230,232,241,.01) 25px);background-image:-moz-linear-gradient(bottom,#e6e8f1,rgba(230,232,241,.01) 25px);background-image:linear-gradient(to top,#e6e8f1,rgba(230,232,241,.01) 25px)}.topics_table .table_title th h2{font-size:14px;margin:0;line-height:48px}.topics_table .form_title{font-weight:700;line-height:30px;text-align:center}.single_topic .table_title th .ft_author_info,.single_topic .table_title th h2{line-height:24px;margin:3px 0}.forums_table th.fieldset,.topics_table tr.panel td,.topics_table tr.panel:hover td{background-image:-webkit-linear-gradient(#f5f6fa,#e6e7f0);background-image:-moz-linear-gradient(#f5f6fa,#e6e7f0);background-image:linear-gradient(#f5f6fa,#e6e7f0);background-color:#edeef5;-webkit-box-shadow:inset 0 -1px 2px rgba(0,0,0,.05);-moz-box-shadow:inset 0 -1px 2px rgba(0,0,0,.05);box-shadow:inset 0 -1px 2px rgba(0,0,0,.05);margin:0;padding:12px 25px}.topics_table tr.panel.white td{background:#FFF}.topics_table tr.panel td:empty{display:none}.topics_table .panel .post_button{float:left}.forums_table .noposts .post_button{display:inline-block;vertical-align:middle;margin-top:-3px}.forums_table .noposts td{line-height:25px}.topics_table .panel .posts_navigation{float:right;margin:6px 0}.topics_table .panel .navigation{float:right;margin-top:2px}.navigation .current_page,.navigation a{background-image:-webkit-linear-gradient(#d4d9e1,#bec4d1);background-image:-moz-linear-gradient(#d4d9e1,#bec4d1);background-image:linear-gradient(#d4d9e1,#bec4d1);background-color:#c9ced9;text-align:center;text-shadow:0 1px 1px rgba(0,0,0,.15);float:left;margin:0;padding:0 6px;border:1px solid rgba(0,0,0,.01);border-bottom-color:rgba(0,0,0,.15);border-left:none;border-right:none;color:#FFF;font-weight:700;font-size:12px;line-height:19px;vertical-align:top}.navigation .current_page:first-child,.navigation a:first-child{border-top-left-radius:3px;border-bottom-left-radius:3px}.navigation .current_page:last-child,.navigation a:last-child{border-top-right-radius:3px;border-bottom-right-radius:3px}.navigation a.next,.navigation a.prev{background-image:-webkit-linear-gradient(#9fa3ac,#787d88);background-image:-moz-linear-gradient(#9fa3ac,#787d88);background-image:linear-gradient(#9fa3ac,#787d88);background-color:#8b909a;border:1px solid #DDD;border-color:rgba(0,0,0,.05) rgba(0,0,0,.2) rgba(0,0,0,.4);text-align:center;text-shadow:0 1px 1px rgba(0,0,0,.15)}.navigation .current_page{box-shadow:inset 0 0 10px rgba(0,0,0,.25);color:#FFF}.ft_search td{text-align:center}.ft_search .search_field{border-radius:3px;-webkit-transition:box-shadow 150ms ease;transition:box-shadow 150ms ease;box-shadow:inset 0 1px 2px rgba(0,0,0,.18);border:1px solid #999;width:600px;height:30px;line-height:30px;padding:0 5px;font-size:15px}.ft_search .search_submit{display:inline-block;border:1px solid #666;border-radius:3px;padding:0 16px;margin-left:5px;text-shadow:0 1px 1px rgba(0,0,0,.15);height:31px;line-height:31px;background-image:-webkit-linear-gradient(#9fa3ac,#787d88);background-image:-moz-linear-gradient(#9fa3ac,#787d88);background-image:linear-gradient(#9fa3ac,#787d88);background-color:#8b909a;position:relative;top:-1px;font-size:15px}.ft_search .search_submit:hover{background-image:-webkit-linear-gradient(#787d88,#9fa3ac);background-image:-moz-linear-gradient(#787d88,#9fa3ac);background-image:linear-gradient(#787d88,#9fa3ac);background-color:#8b909a}.single_topic .ft_avatar{width:80px}.single_topic .ft_avatar a{position:relative}.single_topic .ft_avatar a:before{box-shadow:0 2px 2px rgba(0,0,0,.2) inset;content:\"\";display:block;height:100%;position:absolute;width:100%}.single_topic .ft_avatar a,.single_topic .ft_avatar img,.single_topic .ft_avatar span{display:inline-block}body.round_avatars .single_topic .ft_avatar a,body.round_avatars .single_topic .ft_avatar a:before,body.round_avatars .single_topic .ft_avatar img,body.round_avatars .single_topic .ft_avatar span{border-radius:50%}.single_topic .ft_post_info,.single_topic .ft_post_info td{color:#9CA5AD}.single_topic .ft_post_info a.permalink{color:#9CA5AD;font-weight:700;float:right}.single_topic .ft_comment_response td{background:#F6F6F6}.single_topic .ft_comment_response h3{margin:0}.single_topic .star_rating{display:inline-block;margin-left:10px}table.legend{text-align:center;margin:20px auto}table.legend td{padding:0 20px 0 5px;vertical-align:middle}ul.legend{list-style:none;border:none;text-align:center;padding:0}ul.legend.bForums.bPosts{margin:10px 0}ul.legend li{list-style:none;display:inline-block;white-space:nowrap;vertical-align:middle;margin:5px}ul.legend li span{vertical-align:middle}ul.legend a{text-decoration:none;vertical-align:middle;display:inline-block}ul.legend span.note{float:none}.breadcrumbs{margin-bottom:10px}.breadcrumbs a{position:relative;display:inline-block;padding:0 12px;background-color:#A3ACBE;background-image:-webkit-linear-gradient(#b5bdcb,#929bb1);background-image:-moz-linear-gradient(#b5bdcb,#929bb1);background-image:linear-gradient(#b5bdcb,#929bb1);border:1px solid #000;border-color:transparent rgba(0,0,0,.1) rgba(0,0,0,.3);border-right:none;color:#FFF;font-size:12px;font-weight:700;line-height:26px}.breadcrumbs a:first-child{border-bottom-left-radius:3px;border-top-left-radius:3px}.breadcrumbs a:last-child{background-color:#848C9D;background-image:-webkit-linear-gradient(#98a0af,#70788c);background-image:-moz-linear-gradient(#98a0af,#70788c);background-image:linear-gradient(#98a0af,#70788c);border-bottom-right-radius:3px;border-top-right-radius:3px}.breadcrumbs a:last-child:before{content:\"\";height:20px;margin-top:-10.5px;position:absolute;right:-8px;top:50%;width:20px;background-image:-webkit-linear-gradient(45deg,#98a0af,#70788c);background-image:-moz-linear-gradient(45deg,#98a0af,#70788c);background-image:linear-gradient(45deg,#98a0af,#70788c);-webkit-transform:rotate(135deg) skew(-10deg,-10deg);-moz-transform:rotate(135deg) skew(-10deg,-10deg);-ms-transform:rotate(135deg) skew(-10deg,-10deg);transform:rotate(135deg) skew(-10deg,-10deg);-moz-border-radius-topright:6px;-webkit-border-top-right-radius:6px;border-top-right-radius:6px;-moz-border-radius-bottomleft:6px;-webkit-border-bottom-left-radius:6px;border-bottom-left-radius:6px;-webkit-box-shadow:inset 1px 1px rgba(0,0,0,.2);-moz-box-shadow:inset 1px 1px rgba(0,0,0,.2);box-shadow:inset 1px 1px rgba(0,0,0,.2)}.evo_content_block span[class*=status_]{top:-10px;left:20px}.forums_table span[class*=status_],.legend span[class*=status_]{float:left;width:80px}.forums_table span[class*=status_] span,.legend span[class*=status_] span{text-align:center;padding:3px 0;font-size:11px;font-weight:700;border:1px solid #FFF;border-radius:12px;float:left;width:80px}.forums_table .ft_title span[class*=status_]{margin-top:7px}div.tabs{top:0}div.tabs div a{border-color:#EEE;background:#FFF;padding:10px 15px}div.tabs div a:hover,div.tabs div.selected a{background:#EDEEF5;border-color:#EEE}div.edit_toolbar{width:100%}.profile_pictured_fieldsets{min-height:0}.profile_avatar{text-align:center;margin-bottom:25px}body.round_avatars .profile_avatar img{border-radius:3px}.edit_user_admin_link{margin-bottom:10px}div.results div.table_scroll{box-sizing:border-box;padding:7px}div.results div.filters,div.results div.title{border:none;background:0 0}.pagination{display:inline-block;margin:0;padding:0}.pagination li{list-style:none;display:inline-block;padding:3px}.form_add_contacts>span.label,.form_send_contacts{padding-left:22px}#edit_group_contacts{background-image:-webkit-linear-gradient(#f1f2f6,#e7e9f0);background-image:-moz-linear-gradient(#f1f2f6,#e7e9f0);background-image:linear-gradient(#f1f2f6,#e7e9f0);border:none;padding:10px;box-sizing:border-box}#edit_group_contacts p{margin-top:0}.messages_list>h2{border:none;border-top-left-radius:5px;border-top-right-radius:5px;box-shadow:0 2px 6px rgba(117,124,142,.6);margin:0 5px}.messages_list form.bComment{margin:0 5px;padding-top:0}.messages_list div.messages_list_actions,.messages_list form.bComment{background:0 0;border:none}.messages_list form.bComment .forums_table,.messages_list form.bComment .forums_table tr:first-child td{border-top-left-radius:0;border-top-right-radius:0;background:#FFF}.vote_spam{float:left;padding:1px 5px 0;line-height:19px}.vote_spam a,.vote_spam span{vertical-align:middle;top:-1px;display:inline-block}.vote_helpful{float:left;display:block;line-height:21px;padding-right:5px}.switched_width{transition:all 1s;-moz-transition:all 1s;-webkit-transition:all 1s;-o-transition:all 1s;-ms-transition:all 1s}#width_switcher_layout{position:absolute;top:115px;right:3px;z-index:10001}#width_switcher{display:none}#width_switcher a{width:26px;height:36px;text-decoration:none}#width_switcher.fixed{position:fixed;top:3px;right:3px}@media only screen and (max-device-width:1024px){#width_switcher.fixed{position:absolute;width:75px}}#footer{text-align:right;color:#A1A9B7;font-size:13px;font-weight:700;text-shadow:0 1px 1px rgba(255,255,255,.5)}\n\\ No newline at end of file"
        },
        {
          "filename": "skins/pureforums/pureforums.bundle.css",
          "status": "added",
          "additions": 1070,
          "deletions": 0,
          "patch": "@@ -0,0 +1,1070 @@\n+.header {\n+  margin-bottom: 15px;\n+  color: #FFF;\n+}\n+.header a {\n+  color: #FFF;\n+}\n+.header a:hover {\n+  color: #D6D9E6;\n+}\n+.header.site_skins {\n+  margin-top: 43px;\n+}\n+.header .header_top {\n+  /* autoprefixer: off */\n+  background-color: #242D36;\n+  background-image: -webkit-linear-gradient(#1e252d, #2b3540);\n+  background-image: -moz-linear-gradient(#1e252d, #2b3540);\n+  background-image: linear-gradient(#1e252d, #2b3540);\n+  height: 36px;\n+  line-height: 36px;\n+  color: #9FB5C9;\n+  font-weight: bold;\n+}\n+.header .header_bottom {\n+  /* autoprefixer: off */\n+  background-color: #3C597F;\n+  background-image: -webkit-linear-gradient(#50739b, #283f63);\n+  background-image: -moz-linear-gradient(#50739b, #283f63);\n+  background-image: linear-gradient(#50739b, #283f63);\n+  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2), 0 1px #5d8cb7 inset;\n+  text-align: center;\n+}\n+.header .header_bottom .layout_width {\n+  position: relative;\n+  min-height: 56px;\n+  display: inline-block;\n+  text-align: left;\n+}\n+.header .header_bottom .header_right {\n+  float: right;\n+  border-right: 1px solid rgba(140, 176, 210, 0.2);\n+  margin-left: 250px;\n+}\n+.header .widget_core_coll_title,\n+.header .widget_core_coll_tagline {\n+  position: absolute;\n+  left: 25px;\n+  width: 250px;\n+  overflow: hidden;\n+  white-space: nowrap;\n+}\n+.header .widget_core_coll_title {\n+  line-height: 45px;\n+}\n+.header .widget_core_coll_tagline {\n+  top: 36px;\n+  font-size: 10px;\n+  line-height: 10px;\n+}\n+.header h1 {\n+  margin: 0;\n+}\n+.header .widget_core_coll_search_form {\n+  position: relative;\n+  height: 55px;\n+}\n+.header .widget_core_coll_search_form form {\n+  padding: 11px;\n+}\n+.header .widget_core_coll_search_form form .search_field {\n+  /* autoprefixer: off */\n+  outline: none;\n+  background-color: #EAECF1;\n+  background-image: -webkit-linear-gradient(white, #d5d9e3);\n+  background-image: -moz-linear-gradient(white, #d5d9e3);\n+  background-image: linear-gradient(white, #d5d9e3);\n+  border: medium none;\n+  border-radius: 5px;\n+  box-shadow: 0 1px 2px rgba(36, 44, 51, 0.5);\n+  height: 34px;\n+  line-height: 34px;\n+  padding: 0 34px 0 10px;\n+  transition: width 0.2s ease 0s;\n+  width: 100px;\n+}\n+.header .widget_core_coll_search_form form .search_field:focus {\n+  width: 135px;\n+}\n+.header .widget_core_coll_search_form form .search_submit {\n+  background: transparent none repeat scroll 0 0;\n+  border: medium none;\n+  border-radius: 5px;\n+  cursor: pointer;\n+  font-family: FontAwesome;\n+  height: 34px;\n+  margin: 0;\n+  overflow: hidden;\n+  position: absolute;\n+  right: 13px;\n+  width: 25px;\n+}\n+\n+body.mobile_device div.pageHeader.site_skins,\n+body.tablet_device div.pageHeader.site_skins {\n+  margin-top: 0;\n+}\n+\n+.top_menu, .header_top ul {\n+  float: right;\n+  list-style: none;\n+  margin: 0;\n+  padding: 0;\n+}\n+\n+.top_menu {\n+  border-right: 1px solid rgba(0, 0, 0, 0.25);\n+  text-align: right;\n+}\n+\n+.header_top ul li {\n+  float: left;\n+  border-right: 1px solid rgba(140, 176, 210, 0.2);\n+}\n+\n+.top_menu li {\n+  display: inline-block;\n+  border-left: 1px solid rgba(0, 0, 0, 0.25);\n+  border-bottom: 1px solid rgba(140, 176, 210, 0.2);\n+}\n+\n+.top_menu a, .header_top ul a {\n+  display: block;\n+  font-weight: bold;\n+  padding: 0 20px;\n+  text-shadow: 0 1px 2px rgba(36, 44, 51, 0.5);\n+  border-right: 1px solid rgba(0, 0, 0, 0.25);\n+}\n+\n+.top_menu a, .top_menu li > div {\n+  font-size: 16px;\n+  line-height: 56px;\n+  border-bottom: 1px solid rgba(0, 0, 0, 0.25);\n+  border-left: 1px solid rgba(140, 176, 210, 0.2);\n+  border-right: none;\n+  display: inline-block;\n+}\n+\n+.header_top ul li:first-child {\n+  border-left: 1px solid rgba(0, 0, 0, 0.25);\n+}\n+\n+.header_top ul li:first-child a {\n+  border-left: 1px solid rgba(140, 176, 210, 0.2);\n+}\n+\n+.top_menu li.selected a, .header_top ul li.selected a {\n+  background-color: rgba(0, 0, 0, 0.2);\n+  border-left: 1px solid rgba(0, 0, 0, 0.3);\n+  box-shadow: 0 5px 10px #20364A inset;\n+  margin-left: -1px;\n+}\n+\n+.header_top ul li.selected a {\n+  box-shadow: 0 1px 7px rgba(255, 255, 255, 0.2) inset;\n+}\n+\n+.header_top .ufld_icon_links {\n+  text-align: right;\n+}\n+.header_top .ufld_icon_links a {\n+  display: inline-block;\n+  width: 40px;\n+}\n+\n+@media (max-width: 1200px) {\n+  .header .header_bottom .header_right {\n+    margin-left: 200px;\n+  }\n+  .header .widget_core_coll_title, .header .widget_core_coll_tagline {\n+    width: 200px;\n+  }\n+  .header .widget_core_coll_search_form form .search_field {\n+    width: 60px;\n+  }\n+  .header .widget_core_coll_search_form form .search_field:focus {\n+    width: 110px;\n+  }\n+}\n+@media (max-width: 1100px) {\n+  .header .header_bottom {\n+    font-size: 80%;\n+  }\n+  .header .header_bottom .header_right {\n+    margin-left: 150px;\n+  }\n+  .header .widget_core_coll_title, .header .widget_core_coll_tagline {\n+    width: 150px;\n+  }\n+  .header .widget_core_coll_search_form form {\n+    padding: 11px 0;\n+  }\n+  .header .widget_core_coll_search_form form .search_field {\n+    width: 60px;\n+  }\n+  .header .widget_core_coll_search_form form .search_field:focus {\n+    width: 80px;\n+  }\n+\n+  .top_menu a, .top_menu li > div {\n+    font-size: 14px;\n+    padding: 0 10px;\n+  }\n+}\n+\n+body {\n+  background: #FFF;\n+  color: #424A52;\n+  font: 14px Helvetica, Arial, sans-serif;\n+}\n+\n+a {\n+  color: #306595;\n+  text-decoration: none;\n+  -webkit-transition: color 150ms ease 0s;\n+          transition: color 150ms ease 0s;\n+}\n+\n+a:hover {\n+  color: #4082BE;\n+}\n+\n+textarea, input, select, option, optgroup, ul.ui-autocomplete, li.token-input-token-facebook, div.token-input-dropdown-facebook {\n+  font-size: 15px Helvetica, Arial, sans-serif;\n+}\n+\n+textarea.form_textarea_input {\n+  width: 95%;\n+}\n+\n+.layout_width {\n+  box-sizing: border-box;\n+  width: 100%;\n+  max-width: 1140px;\n+  padding: 0 25px;\n+  margin: 0 auto;\n+}\n+\n+@media (max-width: 700px) {\n+  table.legend td {\n+    font-size: 88%;\n+  }\n+}\n+h2.page_title {\n+  margin-bottom: 15px;\n+}\n+\n+div#skin_wrapper .sitewide_header {\n+  margin-bottom: 0;\n+  position: fixed;\n+  top: 0;\n+  width: 100%;\n+  z-index: 10000;\n+  -webkit-font-smoothing: subpixel-antialiased;\n+}\n+\n+div#skin_wrapper.skin_wrapper_loggedin .sitewide_header {\n+  top: 27px;\n+}\n+\n+div.bComment, form.bComment {\n+  border: none;\n+  padding: 0;\n+  margin: 0;\n+  overflow: inherit;\n+}\n+\n+form.inskin {\n+  padding: 0;\n+}\n+\n+form#user_checkchanges.bComment {\n+  border: none;\n+}\n+\n+/* Forum icons */\n+.ficon {\n+  background: url(img/icons.gif) no-repeat;\n+  display: inline-block;\n+}\n+.ficon.newTopic {\n+  background-position: 0 0;\n+  width: 82px;\n+  height: 25px;\n+}\n+.ficon.postReply {\n+  background-position: 0 -25px;\n+  width: 82px;\n+  height: 25px;\n+}\n+.ficon.locked {\n+  background-position: 0 -50px;\n+  width: 82px;\n+  height: 25px;\n+}\n+.ficon.catBig {\n+  background-position: -82px 0;\n+  width: 26px;\n+  height: 25px;\n+}\n+.ficon.catBigLocked {\n+  background-position: -82px -25px;\n+  width: 26px;\n+  height: 25px;\n+}\n+.ficon.topic {\n+  background-position: -108px 0;\n+  width: 19px;\n+  height: 18px;\n+}\n+.ficon.topicLocked {\n+  background-position: -108px -18px;\n+  width: 19px;\n+  height: 18px;\n+}\n+.ficon.topicSticky {\n+  background-position: -108px -36px;\n+  width: 19px;\n+  height: 18px;\n+}\n+.ficon.latestReply {\n+  background-position: -82px -50px;\n+  width: 16px;\n+  height: 9px;\n+  margin: 0 1px;\n+}\n+.ficon.minipost {\n+  background-position: -91px -50px;\n+  width: 7px;\n+  height: 9px;\n+  margin: 0 3px 0 2px;\n+}\n+.ficon.width_increase {\n+  background-position: 0 -75px;\n+  width: 32px;\n+  height: 32px;\n+}\n+.ficon.width_decrease {\n+  background-position: -32px -75px;\n+  width: 32px;\n+  height: 32px;\n+}\n+\n+.form_add_contacts .controls {\n+  padding-left: 0;\n+}\n+\n+/* Forums & Topics tables */\n+.forums_table, #edit_group_contacts {\n+  width: 100%;\n+  box-shadow: 0 2px 6px rgba(117, 124, 142, 0.6);\n+  border-radius: 5px;\n+  margin-bottom: 10px;\n+}\n+\n+.forums_table.fixed_layout {\n+  table-layout: fixed;\n+}\n+\n+.forums_table.fixed_layout tr.fixrow0 {\n+  margin: 0;\n+}\n+\n+.forums_table.fixed_layout tr.fixrow0 td {\n+  padding-top: 0;\n+  padding-bottom: 0;\n+  border: none;\n+}\n+\n+.bForums.fixed_layout .ft_avatar {\n+  width: 80px;\n+}\n+\n+.forums_table > tbody > tr:first-child > th:first-child,\n+.forums_table > tbody > tr:first-child > td:first-child {\n+  border-top-left-radius: 5px;\n+}\n+\n+.forums_table > tbody > tr:first-child > th:last-child,\n+.forums_table > tbody > tr:first-child > td:last-child {\n+  border-top-right-radius: 5px;\n+}\n+\n+.forums_table > tbody > tr:last-child > th:first-child,\n+.forums_table > tbody > tr:last-child > td:first-child {\n+  border-bottom-left-radius: 5px;\n+}\n+\n+.forums_table > tbody > tr:last-child > th:last-child,\n+.forums_table > tbody > tr:last-child > td:last-child {\n+  border-bottom-right-radius: 5px;\n+}\n+\n+.forums_table .catselect tr th, .forums_table .catselect tr td,\n+.forums_table .grouped tr th, .forums_table .grouped tr td {\n+  border-radius: 0 !important;\n+}\n+\n+.forums_table .meta_category th,\n+.forums_table thead th,\n+.messages_list > h2 {\n+  /* autoprefixer: off */\n+  padding: 12px 20px;\n+  background-color: #ECEDF3;\n+  background-image: -webkit-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: -moz-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: linear-gradient(#f1f2f6, #e7e9f0);\n+  color: #535C66;\n+  font-size: 14px;\n+  font-weight: bold;\n+  text-align: left;\n+  text-transform: uppercase;\n+  text-shadow: 0 1px 1px #FFFFFF;\n+  box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.05) inset;\n+}\n+\n+.forums_table thead tr:last-child th:first-child,\n+.forums_table thead tr:last-child th:last-child {\n+  border-bottom-left-radius: 0;\n+  border-bottom-right-radius: 0;\n+}\n+\n+.forums_table .meta_category th a,\n+.forums_table thead th a {\n+  color: #535C66;\n+}\n+\n+.forums_table th, .forums_table td {\n+  border-bottom: 1px solid #D1D2DA;\n+}\n+\n+.forums_table > tbody > tr:last-child > th, .forums_table > tbody > tr:last-child > td {\n+  border: none;\n+}\n+\n+.forums_table > tbody > tr > td {\n+  padding: 10px 0 10px 20px;\n+}\n+\n+.forums_table > tbody > tr > td:last-child {\n+  padding-right: 20px;\n+}\n+\n+.forums_table.highlight tr:hover td {\n+  background: #f9fafc;\n+}\n+\n+.forums_table .ft_status {\n+  width: 26px;\n+}\n+\n+.forums_table .ft_status_topic {\n+  width: 19px;\n+}\n+\n+.forums_table .ft_title > a.forumlink {\n+  font-size: 21px;\n+}\n+\n+.forums_table .ft_title a.topictitle {\n+  color: #535C66;\n+  font-size: 16px;\n+}\n+\n+.forums_table .ft_title a.topictitle.unread {\n+  font-weight: bold;\n+}\n+\n+.forums_table .ft_title a.topictitle:hover {\n+  color: #31363C;\n+}\n+\n+.forums_table .ft_desc,\n+.forums_table .ft_count {\n+  color: #8B96A1;\n+}\n+\n+.forums_table .ft_count {\n+  width: 100px;\n+}\n+\n+.forums_table .ft_date {\n+  width: 220px;\n+  white-space: nowrap;\n+  padding-right: 20px;\n+}\n+\n+.forums_table .ft_author_info {\n+  color: #9CA5AE;\n+}\n+\n+.forums_table .ft_author_avatar {\n+  float: left;\n+  margin-right: 10px;\n+  display: block;\n+}\n+\n+body.round_avatars .forums_table .ft_author_avatar img {\n+  border-radius: 3px;\n+}\n+\n+.forums_table .track_content {\n+  margin: 0 5px 5px 0;\n+}\n+\n+.forums_table .buttons {\n+  text-align: center;\n+}\n+\n+/* Topics table */\n+.topics_table > tbody > tr > td, .topics_table > tbody > tr:last-child > td {\n+  border-top: 1px solid #D1D2DA;\n+  border-bottom: none;\n+}\n+\n+.topics_table .table_title th {\n+  /* autoprefixer: off */\n+  text-align: left;\n+  padding: 8px 25px 8px 20px;\n+  color: #535c66;\n+  font-weight: normal;\n+  -moz-border-radius-topleft: 5px;\n+  -webkit-border-top-left-radius: 5px;\n+  border-top-left-radius: 5px;\n+  -moz-border-radius-topright: 5px;\n+  -webkit-border-top-right-radius: 5px;\n+  border-top-right-radius: 5px;\n+  -webkit-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);\n+  -moz-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);\n+  box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);\n+  background-image: -webkit-linear-gradient(bottom, #e6e8f1, rgba(230, 232, 241, 0.01) 25px);\n+  background-image: -moz-linear-gradient(bottom, #e6e8f1, rgba(230, 232, 241, 0.01) 25px);\n+  background-image: linear-gradient(to top, #e6e8f1, rgba(230, 232, 241, 0.01) 25px);\n+}\n+\n+.topics_table .table_title th h2 {\n+  font-size: 14px;\n+  margin: 0;\n+  line-height: 48px;\n+}\n+\n+.topics_table .form_title {\n+  font-weight: bold;\n+  line-height: 30px;\n+  text-align: center;\n+}\n+\n+.single_topic .table_title th h2,\n+.single_topic .table_title th .ft_author_info {\n+  line-height: 24px;\n+  margin: 3px 0;\n+}\n+\n+.topics_table tr.panel td, .topics_table tr.panel:hover td,\n+.forums_table th.fieldset {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#f5f6fa, #e6e7f0);\n+  background-image: -moz-linear-gradient(#f5f6fa, #e6e7f0);\n+  background-image: linear-gradient(#f5f6fa, #e6e7f0);\n+  background-color: #edeef5;\n+  -webkit-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.05);\n+  -moz-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.05);\n+  box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.05);\n+  margin: 0;\n+  padding: 12px 25px;\n+}\n+\n+.topics_table tr.panel.white td {\n+  background: #FFF;\n+}\n+\n+.topics_table tr.panel td:empty {\n+  display: none;\n+}\n+\n+.topics_table .panel .post_button {\n+  float: left;\n+}\n+\n+.forums_table .noposts .post_button {\n+  display: inline-block;\n+  vertical-align: middle;\n+  margin-top: -3px;\n+}\n+\n+.forums_table .noposts td {\n+  line-height: 25px;\n+}\n+\n+.topics_table .panel .posts_navigation {\n+  float: right;\n+  margin: 6px 0;\n+}\n+\n+.topics_table .panel .navigation {\n+  float: right;\n+  margin-top: 2px;\n+}\n+\n+.navigation a, .navigation .current_page {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#d4d9e1, #bec4d1);\n+  background-image: -moz-linear-gradient(#d4d9e1, #bec4d1);\n+  background-image: linear-gradient(#d4d9e1, #bec4d1);\n+  background-color: #c9ced9;\n+  text-align: center;\n+  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n+  float: left;\n+  margin: 0;\n+  padding: 0 6px;\n+  border: 1px solid rgba(0, 0, 0, 0.01);\n+  border-bottom-color: rgba(0, 0, 0, 0.15);\n+  border-left: none;\n+  border-right: none;\n+  color: #FFF;\n+  font-weight: bold;\n+  font-size: 12px;\n+  line-height: 19px;\n+  vertical-align: top;\n+}\n+\n+.navigation a:first-child, .navigation .current_page:first-child {\n+  border-top-left-radius: 3px;\n+  border-bottom-left-radius: 3px;\n+}\n+\n+.navigation a:last-child, .navigation .current_page:last-child {\n+  border-top-right-radius: 3px;\n+  border-bottom-right-radius: 3px;\n+}\n+\n+.navigation a.prev, .navigation a.next {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#9fa3ac, #787d88);\n+  background-image: -moz-linear-gradient(#9fa3ac, #787d88);\n+  background-image: linear-gradient(#9fa3ac, #787d88);\n+  background-color: #8b909a;\n+  border: 1px solid #DDD;\n+  border-color: rgba(0, 0, 0, 0.05) rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.4);\n+  text-align: center;\n+  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n+}\n+\n+.navigation .current_page {\n+  box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.25);\n+  color: #FFF;\n+}\n+\n+.ft_search td {\n+  text-align: center;\n+}\n+\n+.ft_search .search_field {\n+  border-radius: 3px;\n+  -webkit-transition: box-shadow 150ms ease;\n+  transition: box-shadow 150ms ease;\n+  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.18);\n+  padding: 6px 7px;\n+  border: 1px solid #999;\n+  width: 600px;\n+  height: 30px;\n+  line-height: 30px;\n+  padding: 0 5px;\n+  font-size: 15px;\n+}\n+\n+.ft_search .search_submit {\n+  /* autoprefixer: off */\n+  display: inline-block;\n+  border: 1px solid #666;\n+  border-radius: 3px;\n+  padding: 0 16px;\n+  margin-left: 5px;\n+  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n+  height: 31px;\n+  line-height: 31px;\n+  background-image: -webkit-linear-gradient(#9fa3ac, #787d88);\n+  background-image: -moz-linear-gradient(#9fa3ac, #787d88);\n+  background-image: linear-gradient(#9fa3ac, #787d88);\n+  background-color: #8b909a;\n+  position: relative;\n+  top: -1px;\n+  font-size: 15px;\n+}\n+\n+.ft_search .search_submit:hover {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#787d88, #9fa3ac);\n+  background-image: -moz-linear-gradient(#787d88, #9fa3ac);\n+  background-image: linear-gradient(#787d88, #9fa3ac);\n+  background-color: #8b909a;\n+}\n+\n+/* Single topic */\n+.single_topic .ft_avatar {\n+  width: 80px;\n+}\n+\n+.single_topic .ft_avatar a {\n+  position: relative;\n+}\n+\n+.single_topic .ft_avatar a:before {\n+  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2) inset;\n+  content: \"\";\n+  display: block;\n+  height: 100%;\n+  position: absolute;\n+  width: 100%;\n+}\n+\n+.single_topic .ft_avatar a,\n+.single_topic .ft_avatar span,\n+.single_topic .ft_avatar img {\n+  display: inline-block;\n+}\n+\n+body.round_avatars .single_topic .ft_avatar a:before,\n+body.round_avatars .single_topic .ft_avatar a,\n+body.round_avatars .single_topic .ft_avatar span,\n+body.round_avatars .single_topic .ft_avatar img {\n+  border-radius: 50%;\n+}\n+\n+.single_topic .ft_post_info, .single_topic .ft_post_info td {\n+  color: #9CA5AD;\n+}\n+\n+.single_topic .ft_post_info a.permalink {\n+  color: #9CA5AD;\n+  font-weight: bold;\n+  float: right;\n+}\n+\n+.single_topic .ft_comment_response td {\n+  background: #F6F6F6;\n+}\n+\n+.single_topic .ft_comment_response h3 {\n+  margin: 0;\n+}\n+\n+.single_topic .star_rating {\n+  display: inline-block;\n+  margin-left: 10px;\n+}\n+\n+/* Legend table & list */\n+table.legend {\n+  text-align: center;\n+  margin: 20px auto;\n+}\n+\n+table.legend td {\n+  padding: 0 20px 0 5px;\n+  vertical-align: middle;\n+}\n+\n+ul.legend {\n+  list-style: none;\n+  border: none;\n+  text-align: center;\n+  padding: 0;\n+}\n+\n+ul.legend.bForums.bPosts {\n+  margin: 10px 0;\n+}\n+\n+ul.legend li {\n+  list-style: none;\n+  display: inline-block;\n+  white-space: nowrap;\n+  vertical-align: middle;\n+  margin: 5px;\n+}\n+\n+ul.legend li span {\n+  vertical-align: middle;\n+}\n+\n+ul.legend a {\n+  text-decoration: none;\n+  vertical-align: middle;\n+  display: inline-block;\n+}\n+\n+ul.legend span.note {\n+  float: none;\n+}\n+\n+/* Breadcrumbs */\n+.breadcrumbs {\n+  margin-bottom: 10px;\n+}\n+\n+.breadcrumbs a {\n+  /* autoprefixer: off */\n+  position: relative;\n+  display: inline-block;\n+  padding: 0 12px;\n+  background-color: #A3ACBE;\n+  background-image: -webkit-linear-gradient(#b5bdcb, #929bb1);\n+  background-image: -moz-linear-gradient(#b5bdcb, #929bb1);\n+  background-image: linear-gradient(#b5bdcb, #929bb1);\n+  border: 1px solid #000;\n+  border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.3);\n+  border-right: none;\n+  color: #FFF;\n+  font-size: 12px;\n+  font-weight: bold;\n+  line-height: 26px;\n+}\n+\n+.breadcrumbs a:first-child {\n+  border-bottom-left-radius: 3px;\n+  border-top-left-radius: 3px;\n+}\n+\n+.breadcrumbs a:last-child {\n+  /* autoprefixer: off */\n+  background-color: #848C9D;\n+  background-image: -webkit-linear-gradient(#98a0af, #70788c);\n+  background-image: -moz-linear-gradient(#98a0af, #70788c);\n+  background-image: linear-gradient(#98a0af, #70788c);\n+  border-bottom-right-radius: 3px;\n+  border-top-right-radius: 3px;\n+}\n+\n+.breadcrumbs a:last-child:before {\n+  /* autoprefixer: off */\n+  content: \"\";\n+  height: 20px;\n+  margin-top: -10.5px;\n+  position: absolute;\n+  right: -8px;\n+  top: 50%;\n+  width: 20px;\n+  background-image: -webkit-linear-gradient(45deg, #98a0af, #70788c);\n+  background-image: -moz-linear-gradient(45deg, #98a0af, #70788c);\n+  background-image: linear-gradient(45deg, #98a0af, #70788c);\n+  -webkit-transform: rotate(135deg) skew(-10deg, -10deg);\n+  -moz-transform: rotate(135deg) skew(-10deg, -10deg);\n+  -ms-transform: rotate(135deg) skew(-10deg, -10deg);\n+  transform: rotate(135deg) skew(-10deg, -10deg);\n+  -moz-border-radius-topright: 6px;\n+  -webkit-border-top-right-radius: 6px;\n+  border-top-right-radius: 6px;\n+  -moz-border-radius-bottomleft: 6px;\n+  -webkit-border-bottom-left-radius: 6px;\n+  border-bottom-left-radius: 6px;\n+  -webkit-box-shadow: inset 1px 1px rgba(0, 0, 0, 0.2);\n+  -moz-box-shadow: inset 1px 1px rgba(0, 0, 0, 0.2);\n+  box-shadow: inset 1px 1px rgba(0, 0, 0, 0.2);\n+}\n+\n+/* Statuses of posts display in table view */\n+.evo_content_block span[class*='status_'] {\n+  top: -10px;\n+  left: 20px;\n+}\n+\n+.forums_table span[class*='status_'],\n+.legend span[class*='status_'] {\n+  float: left;\n+  width: 80px;\n+}\n+\n+.forums_table span[class*='status_'] span,\n+.legend span[class*='status_'] span {\n+  text-align: center;\n+  padding: 3px 0;\n+  font-size: 11px;\n+  font-weight: bold;\n+  border: 1px solid #FFFFFF;\n+  border-radius: 12px 12px 12px 12px;\n+  float: left;\n+  width: 80px;\n+}\n+\n+.forums_table .ft_title span[class*='status_'] {\n+  margin-top: 7px;\n+}\n+\n+/* Tabs of user profile pages */\n+div.tabs {\n+  top: 0;\n+}\n+\n+div.tabs div a {\n+  border-color: #EEE;\n+  background: #FFF;\n+  padding: 10px 15px;\n+}\n+\n+div.tabs div a:hover,\n+div.tabs div.selected a {\n+  background: #EDEEF5;\n+  border-color: #EEE;\n+}\n+\n+div.edit_toolbar {\n+  width: 100%;\n+}\n+\n+.profile_pictured_fieldsets {\n+  min-height: 0;\n+}\n+\n+.profile_avatar {\n+  text-align: center;\n+  margin-bottom: 25px;\n+}\n+\n+body.round_avatars .profile_avatar img {\n+  border-radius: 3px;\n+}\n+\n+.edit_user_admin_link {\n+  margin-bottom: 10px;\n+}\n+\n+div.results div.table_scroll {\n+  box-sizing: border-box;\n+  padding: 7px;\n+}\n+\n+div.results div.title,\n+div.results div.filters {\n+  border: none;\n+  background: none;\n+}\n+\n+.pagination {\n+  display: inline-block;\n+  margin: 0;\n+  padding: 0;\n+}\n+\n+.pagination li {\n+  list-style: none;\n+  display: inline-block;\n+  padding: 3px;\n+}\n+\n+.form_send_contacts, .form_add_contacts > span.label {\n+  padding-left: 22px;\n+}\n+\n+#edit_group_contacts {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: -moz-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: linear-gradient(#f1f2f6, #e7e9f0);\n+  border: none;\n+  padding: 10px;\n+  box-sizing: border-box;\n+}\n+\n+#edit_group_contacts p {\n+  margin-top: 0;\n+}\n+\n+.messages_list > h2 {\n+  border: none;\n+  border-top-left-radius: 5px;\n+  border-top-right-radius: 5px;\n+  box-shadow: 0 2px 6px rgba(117, 124, 142, 0.6);\n+  margin: 0 5px;\n+}\n+\n+.messages_list form.bComment {\n+  margin: 0 5px;\n+  padding-top: 0;\n+}\n+\n+.messages_list form.bComment,\n+.messages_list div.messages_list_actions {\n+  background: none;\n+  border: none;\n+}\n+\n+.messages_list form.bComment .forums_table,\n+.messages_list form.bComment .forums_table tr:first-child td {\n+  border-top-left-radius: 0;\n+  border-top-right-radius: 0;\n+  background: #FFF;\n+}\n+\n+.vote_spam {\n+  float: left;\n+  padding: 1px 5px 0;\n+  line-height: 19px;\n+}\n+\n+.vote_spam a, .vote_spam span {\n+  vertical-align: middle;\n+  top: -1px;\n+  display: inline-block;\n+}\n+\n+.vote_helpful {\n+  float: left;\n+  display: block;\n+  line-height: 21px;\n+  padding-right: 5px;\n+}\n+\n+/* The width switcher */\n+.switched_width {\n+  transition: all 1s;\n+  -moz-transition: all 1s;\n+  /* Firefox 4 */\n+  -webkit-transition: all 1s;\n+  /* Safari and Chrome */\n+  -o-transition: all 1s;\n+  /* Opera */\n+  -ms-transition: all 1s;\n+  /* IE */\n+}\n+\n+#width_switcher_layout {\n+  position: absolute;\n+  top: 115px;\n+  right: 3px;\n+  z-index: 10001;\n+}\n+\n+#width_switcher {\n+  display: none;\n+}\n+\n+#width_switcher a {\n+  width: 26px;\n+  height: 36px;\n+  text-decoration: none;\n+}\n+\n+#width_switcher.fixed {\n+  position: fixed;\n+  top: 3px;\n+  right: 3px;\n+}\n+\n+/* Devices with max width <= 1024px (iPhone,iPad):\n+   Don't fix a width switcher */\n+@media only screen and (max-device-width: 1024px) {\n+  #width_switcher.fixed {\n+    position: absolute;\n+    width: 75px;\n+  }\n+}\n+\n+#footer {\n+  text-align: right;\n+  color: #A1A9B7;\n+  font-size: 13px;\n+  font-weight: bold;\n+  text-shadow: 0 1px 1px rgba(255, 255, 255, 0.5);\n+}"
        },
        {
          "filename": "skins/pureforums/pureforums_header.css",
          "status": "added",
          "additions": 214,
          "deletions": 0,
          "patch": "@@ -0,0 +1,214 @@\n+.header {\n+  margin-bottom: 15px;\n+  color: #FFF;\n+}\n+.header a {\n+  color: #FFF;\n+}\n+.header a:hover {\n+  color: #D6D9E6;\n+}\n+.header.site_skins {\n+  margin-top: 43px;\n+}\n+.header .header_top {\n+  /* autoprefixer: off */\n+  background-color: #242D36;\n+  background-image: -webkit-linear-gradient(#1e252d, #2b3540);\n+  background-image: -moz-linear-gradient(#1e252d, #2b3540);\n+  background-image: linear-gradient(#1e252d, #2b3540);\n+  height: 36px;\n+  line-height: 36px;\n+  color: #9FB5C9;\n+  font-weight: bold;\n+}\n+.header .header_bottom {\n+  /* autoprefixer: off */\n+  background-color: #3C597F;\n+  background-image: -webkit-linear-gradient(#50739b, #283f63);\n+  background-image: -moz-linear-gradient(#50739b, #283f63);\n+  background-image: linear-gradient(#50739b, #283f63);\n+  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2), 0 1px #5d8cb7 inset;\n+  text-align: center;\n+}\n+.header .header_bottom .layout_width {\n+  position: relative;\n+  min-height: 56px;\n+  display: inline-block;\n+  text-align: left;\n+}\n+.header .header_bottom .header_right {\n+  float: right;\n+  border-right: 1px solid rgba(140, 176, 210, 0.2);\n+  margin-left: 250px;\n+}\n+.header .widget_core_coll_title,\n+.header .widget_core_coll_tagline {\n+  position: absolute;\n+  left: 25px;\n+  width: 250px;\n+  overflow: hidden;\n+  white-space: nowrap;\n+}\n+.header .widget_core_coll_title {\n+  line-height: 45px;\n+}\n+.header .widget_core_coll_tagline {\n+  top: 36px;\n+  font-size: 10px;\n+  line-height: 10px;\n+}\n+.header h1 {\n+  margin: 0;\n+}\n+.header .widget_core_coll_search_form {\n+  position: relative;\n+  height: 55px;\n+}\n+.header .widget_core_coll_search_form form {\n+  padding: 11px;\n+}\n+.header .widget_core_coll_search_form form .search_field {\n+  /* autoprefixer: off */\n+  outline: none;\n+  background-color: #EAECF1;\n+  background-image: -webkit-linear-gradient(white, #d5d9e3);\n+  background-image: -moz-linear-gradient(white, #d5d9e3);\n+  background-image: linear-gradient(white, #d5d9e3);\n+  border: medium none;\n+  border-radius: 5px;\n+  box-shadow: 0 1px 2px rgba(36, 44, 51, 0.5);\n+  height: 34px;\n+  line-height: 34px;\n+  padding: 0 34px 0 10px;\n+  transition: width 0.2s ease 0s;\n+  width: 100px;\n+}\n+.header .widget_core_coll_search_form form .search_field:focus {\n+  width: 135px;\n+}\n+.header .widget_core_coll_search_form form .search_submit {\n+  background: transparent none repeat scroll 0 0;\n+  border: medium none;\n+  border-radius: 5px;\n+  cursor: pointer;\n+  font-family: FontAwesome;\n+  height: 34px;\n+  margin: 0;\n+  overflow: hidden;\n+  position: absolute;\n+  right: 13px;\n+  width: 25px;\n+}\n+\n+body.mobile_device div.pageHeader.site_skins,\n+body.tablet_device div.pageHeader.site_skins {\n+  margin-top: 0;\n+}\n+\n+.top_menu, .header_top ul {\n+  float: right;\n+  list-style: none;\n+  margin: 0;\n+  padding: 0;\n+}\n+\n+.top_menu {\n+  border-right: 1px solid rgba(0, 0, 0, 0.25);\n+  text-align: right;\n+}\n+\n+.header_top ul li {\n+  float: left;\n+  border-right: 1px solid rgba(140, 176, 210, 0.2);\n+}\n+\n+.top_menu li {\n+  display: inline-block;\n+  border-left: 1px solid rgba(0, 0, 0, 0.25);\n+  border-bottom: 1px solid rgba(140, 176, 210, 0.2);\n+}\n+\n+.top_menu a, .header_top ul a {\n+  display: block;\n+  font-weight: bold;\n+  padding: 0 20px;\n+  text-shadow: 0 1px 2px rgba(36, 44, 51, 0.5);\n+  border-right: 1px solid rgba(0, 0, 0, 0.25);\n+}\n+\n+.top_menu a, .top_menu li > div {\n+  font-size: 16px;\n+  line-height: 56px;\n+  border-bottom: 1px solid rgba(0, 0, 0, 0.25);\n+  border-left: 1px solid rgba(140, 176, 210, 0.2);\n+  border-right: none;\n+  display: inline-block;\n+}\n+\n+.header_top ul li:first-child {\n+  border-left: 1px solid rgba(0, 0, 0, 0.25);\n+}\n+\n+.header_top ul li:first-child a {\n+  border-left: 1px solid rgba(140, 176, 210, 0.2);\n+}\n+\n+.top_menu li.selected a, .header_top ul li.selected a {\n+  background-color: rgba(0, 0, 0, 0.2);\n+  border-left: 1px solid rgba(0, 0, 0, 0.3);\n+  box-shadow: 0 5px 10px #20364A inset;\n+  margin-left: -1px;\n+}\n+\n+.header_top ul li.selected a {\n+  box-shadow: 0 1px 7px rgba(255, 255, 255, 0.2) inset;\n+}\n+\n+.header_top .ufld_icon_links {\n+  text-align: right;\n+}\n+.header_top .ufld_icon_links a {\n+  display: inline-block;\n+  width: 40px;\n+}\n+\n+@media (max-width: 1200px) {\n+  .header .header_bottom .header_right {\n+    margin-left: 200px;\n+  }\n+  .header .widget_core_coll_title, .header .widget_core_coll_tagline {\n+    width: 200px;\n+  }\n+  .header .widget_core_coll_search_form form .search_field {\n+    width: 60px;\n+  }\n+  .header .widget_core_coll_search_form form .search_field:focus {\n+    width: 110px;\n+  }\n+}\n+@media (max-width: 1100px) {\n+  .header .header_bottom {\n+    font-size: 80%;\n+  }\n+  .header .header_bottom .header_right {\n+    margin-left: 150px;\n+  }\n+  .header .widget_core_coll_title, .header .widget_core_coll_tagline {\n+    width: 150px;\n+  }\n+  .header .widget_core_coll_search_form form {\n+    padding: 11px 0;\n+  }\n+  .header .widget_core_coll_search_form form .search_field {\n+    width: 60px;\n+  }\n+  .header .widget_core_coll_search_form form .search_field:focus {\n+    width: 80px;\n+  }\n+\n+  .top_menu a, .top_menu li > div {\n+    font-size: 14px;\n+    padding: 0 10px;\n+  }\n+}"
        },
        {
          "filename": "skins/pureforums/pureforums_main.css",
          "status": "added",
          "additions": 847,
          "deletions": 0,
          "patch": "@@ -0,0 +1,847 @@\n+body {\n+  background: #FFF;\n+  color: #424A52;\n+  font: 14px Helvetica, Arial, sans-serif;\n+}\n+\n+a {\n+  color: #306595;\n+  text-decoration: none;\n+  -webkit-transition: color 150ms ease 0s;\n+          transition: color 150ms ease 0s;\n+}\n+\n+a:hover {\n+  color: #4082BE;\n+}\n+\n+textarea, input, select, option, optgroup, ul.ui-autocomplete, li.token-input-token-facebook, div.token-input-dropdown-facebook {\n+  font-size: 15px Helvetica, Arial, sans-serif;\n+}\n+\n+textarea.form_textarea_input {\n+  width: 95%;\n+}\n+\n+.layout_width {\n+  box-sizing: border-box;\n+  width: 100%;\n+  max-width: 1140px;\n+  padding: 0 25px;\n+  margin: 0 auto;\n+}\n+\n+@media (max-width: 700px) {\n+  table.legend td {\n+    font-size: 88%;\n+  }\n+}\n+h2.page_title {\n+  margin-bottom: 15px;\n+}\n+\n+div#skin_wrapper .sitewide_header {\n+  margin-bottom: 0;\n+  position: fixed;\n+  top: 0;\n+  width: 100%;\n+  z-index: 10000;\n+  -webkit-font-smoothing: subpixel-antialiased;\n+}\n+\n+div#skin_wrapper.skin_wrapper_loggedin .sitewide_header {\n+  top: 27px;\n+}\n+\n+div.bComment, form.bComment {\n+  border: none;\n+  padding: 0;\n+  margin: 0;\n+  overflow: inherit;\n+}\n+\n+form.inskin {\n+  padding: 0;\n+}\n+\n+form#user_checkchanges.bComment {\n+  border: none;\n+}\n+\n+/* Forum icons */\n+.ficon {\n+  background: url(img/icons.gif) no-repeat;\n+  display: inline-block;\n+}\n+.ficon.newTopic {\n+  background-position: 0 0;\n+  width: 82px;\n+  height: 25px;\n+}\n+.ficon.postReply {\n+  background-position: 0 -25px;\n+  width: 82px;\n+  height: 25px;\n+}\n+.ficon.locked {\n+  background-position: 0 -50px;\n+  width: 82px;\n+  height: 25px;\n+}\n+.ficon.catBig {\n+  background-position: -82px 0;\n+  width: 26px;\n+  height: 25px;\n+}\n+.ficon.catBigLocked {\n+  background-position: -82px -25px;\n+  width: 26px;\n+  height: 25px;\n+}\n+.ficon.topic {\n+  background-position: -108px 0;\n+  width: 19px;\n+  height: 18px;\n+}\n+.ficon.topicLocked {\n+  background-position: -108px -18px;\n+  width: 19px;\n+  height: 18px;\n+}\n+.ficon.topicSticky {\n+  background-position: -108px -36px;\n+  width: 19px;\n+  height: 18px;\n+}\n+.ficon.latestReply {\n+  background-position: -82px -50px;\n+  width: 16px;\n+  height: 9px;\n+  margin: 0 1px;\n+}\n+.ficon.minipost {\n+  background-position: -91px -50px;\n+  width: 7px;\n+  height: 9px;\n+  margin: 0 3px 0 2px;\n+}\n+.ficon.width_increase {\n+  background-position: 0 -75px;\n+  width: 32px;\n+  height: 32px;\n+}\n+.ficon.width_decrease {\n+  background-position: -32px -75px;\n+  width: 32px;\n+  height: 32px;\n+}\n+\n+.form_add_contacts .controls {\n+  padding-left: 0;\n+}\n+\n+/* Forums & Topics tables */\n+.forums_table, #edit_group_contacts {\n+  width: 100%;\n+  box-shadow: 0 2px 6px rgba(117, 124, 142, 0.6);\n+  border-radius: 5px;\n+  margin-bottom: 10px;\n+}\n+\n+.forums_table.fixed_layout {\n+  table-layout: fixed;\n+}\n+\n+.forums_table.fixed_layout tr.fixrow0 {\n+  margin: 0;\n+}\n+\n+.forums_table.fixed_layout tr.fixrow0 td {\n+  padding-top: 0;\n+  padding-bottom: 0;\n+  border: none;\n+}\n+\n+.bForums.fixed_layout .ft_avatar {\n+  width: 80px;\n+}\n+\n+.forums_table > tbody > tr:first-child > th:first-child,\n+.forums_table > tbody > tr:first-child > td:first-child {\n+  border-top-left-radius: 5px;\n+}\n+\n+.forums_table > tbody > tr:first-child > th:last-child,\n+.forums_table > tbody > tr:first-child > td:last-child {\n+  border-top-right-radius: 5px;\n+}\n+\n+.forums_table > tbody > tr:last-child > th:first-child,\n+.forums_table > tbody > tr:last-child > td:first-child {\n+  border-bottom-left-radius: 5px;\n+}\n+\n+.forums_table > tbody > tr:last-child > th:last-child,\n+.forums_table > tbody > tr:last-child > td:last-child {\n+  border-bottom-right-radius: 5px;\n+}\n+\n+.forums_table .catselect tr th, .forums_table .catselect tr td,\n+.forums_table .grouped tr th, .forums_table .grouped tr td {\n+  border-radius: 0 !important;\n+}\n+\n+.forums_table .meta_category th,\n+.forums_table thead th,\n+.messages_list > h2 {\n+  /* autoprefixer: off */\n+  padding: 12px 20px;\n+  background-color: #ECEDF3;\n+  background-image: -webkit-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: -moz-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: linear-gradient(#f1f2f6, #e7e9f0);\n+  color: #535C66;\n+  font-size: 14px;\n+  font-weight: bold;\n+  text-align: left;\n+  text-transform: uppercase;\n+  text-shadow: 0 1px 1px #FFFFFF;\n+  box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.05) inset;\n+}\n+\n+.forums_table thead tr:last-child th:first-child,\n+.forums_table thead tr:last-child th:last-child {\n+  border-bottom-left-radius: 0;\n+  border-bottom-right-radius: 0;\n+}\n+\n+.forums_table .meta_category th a,\n+.forums_table thead th a {\n+  color: #535C66;\n+}\n+\n+.forums_table th, .forums_table td {\n+  border-bottom: 1px solid #D1D2DA;\n+}\n+\n+.forums_table > tbody > tr:last-child > th, .forums_table > tbody > tr:last-child > td {\n+  border: none;\n+}\n+\n+.forums_table > tbody > tr > td {\n+  padding: 10px 0 10px 20px;\n+}\n+\n+.forums_table > tbody > tr > td:last-child {\n+  padding-right: 20px;\n+}\n+\n+.forums_table.highlight tr:hover td {\n+  background: #f9fafc;\n+}\n+\n+.forums_table .ft_status {\n+  width: 26px;\n+}\n+\n+.forums_table .ft_status_topic {\n+  width: 19px;\n+}\n+\n+.forums_table .ft_title > a.forumlink {\n+  font-size: 21px;\n+}\n+\n+.forums_table .ft_title a.topictitle {\n+  color: #535C66;\n+  font-size: 16px;\n+}\n+\n+.forums_table .ft_title a.topictitle.unread {\n+  font-weight: bold;\n+}\n+\n+.forums_table .ft_title a.topictitle:hover {\n+  color: #31363C;\n+}\n+\n+.forums_table .ft_desc,\n+.forums_table .ft_count {\n+  color: #8B96A1;\n+}\n+\n+.forums_table .ft_count {\n+  width: 100px;\n+}\n+\n+.forums_table .ft_date {\n+  width: 220px;\n+  white-space: nowrap;\n+  padding-right: 20px;\n+}\n+\n+.forums_table .ft_author_info {\n+  color: #9CA5AE;\n+}\n+\n+.forums_table .ft_author_avatar {\n+  float: left;\n+  margin-right: 10px;\n+  display: block;\n+}\n+\n+body.round_avatars .forums_table .ft_author_avatar img {\n+  border-radius: 3px;\n+}\n+\n+.forums_table .track_content {\n+  margin: 0 5px 5px 0;\n+}\n+\n+.forums_table .buttons {\n+  text-align: center;\n+}\n+\n+/* Topics table */\n+.topics_table > tbody > tr > td, .topics_table > tbody > tr:last-child > td {\n+  border-top: 1px solid #D1D2DA;\n+  border-bottom: none;\n+}\n+\n+.topics_table .table_title th {\n+  /* autoprefixer: off */\n+  text-align: left;\n+  padding: 8px 25px 8px 20px;\n+  color: #535c66;\n+  font-weight: normal;\n+  -moz-border-radius-topleft: 5px;\n+  -webkit-border-top-left-radius: 5px;\n+  border-top-left-radius: 5px;\n+  -moz-border-radius-topright: 5px;\n+  -webkit-border-top-right-radius: 5px;\n+  border-top-right-radius: 5px;\n+  -webkit-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);\n+  -moz-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);\n+  box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.1);\n+  background-image: -webkit-linear-gradient(bottom, #e6e8f1, rgba(230, 232, 241, 0.01) 25px);\n+  background-image: -moz-linear-gradient(bottom, #e6e8f1, rgba(230, 232, 241, 0.01) 25px);\n+  background-image: linear-gradient(to top, #e6e8f1, rgba(230, 232, 241, 0.01) 25px);\n+}\n+\n+.topics_table .table_title th h2 {\n+  font-size: 14px;\n+  margin: 0;\n+  line-height: 48px;\n+}\n+\n+.topics_table .form_title {\n+  font-weight: bold;\n+  line-height: 30px;\n+  text-align: center;\n+}\n+\n+.single_topic .table_title th h2,\n+.single_topic .table_title th .ft_author_info {\n+  line-height: 24px;\n+  margin: 3px 0;\n+}\n+\n+.topics_table tr.panel td, .topics_table tr.panel:hover td,\n+.forums_table th.fieldset {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#f5f6fa, #e6e7f0);\n+  background-image: -moz-linear-gradient(#f5f6fa, #e6e7f0);\n+  background-image: linear-gradient(#f5f6fa, #e6e7f0);\n+  background-color: #edeef5;\n+  -webkit-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.05);\n+  -moz-box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.05);\n+  box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.05);\n+  margin: 0;\n+  padding: 12px 25px;\n+}\n+\n+.topics_table tr.panel.white td {\n+  background: #FFF;\n+}\n+\n+.topics_table tr.panel td:empty {\n+  display: none;\n+}\n+\n+.topics_table .panel .post_button {\n+  float: left;\n+}\n+\n+.forums_table .noposts .post_button {\n+  display: inline-block;\n+  vertical-align: middle;\n+  margin-top: -3px;\n+}\n+\n+.forums_table .noposts td {\n+  line-height: 25px;\n+}\n+\n+.topics_table .panel .posts_navigation {\n+  float: right;\n+  margin: 6px 0;\n+}\n+\n+.topics_table .panel .navigation {\n+  float: right;\n+  margin-top: 2px;\n+}\n+\n+.navigation a, .navigation .current_page {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#d4d9e1, #bec4d1);\n+  background-image: -moz-linear-gradient(#d4d9e1, #bec4d1);\n+  background-image: linear-gradient(#d4d9e1, #bec4d1);\n+  background-color: #c9ced9;\n+  text-align: center;\n+  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n+  float: left;\n+  margin: 0;\n+  padding: 0 6px;\n+  border: 1px solid rgba(0, 0, 0, 0.01);\n+  border-bottom-color: rgba(0, 0, 0, 0.15);\n+  border-left: none;\n+  border-right: none;\n+  color: #FFF;\n+  font-weight: bold;\n+  font-size: 12px;\n+  line-height: 19px;\n+  vertical-align: top;\n+}\n+\n+.navigation a:first-child, .navigation .current_page:first-child {\n+  border-top-left-radius: 3px;\n+  border-bottom-left-radius: 3px;\n+}\n+\n+.navigation a:last-child, .navigation .current_page:last-child {\n+  border-top-right-radius: 3px;\n+  border-bottom-right-radius: 3px;\n+}\n+\n+.navigation a.prev, .navigation a.next {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#9fa3ac, #787d88);\n+  background-image: -moz-linear-gradient(#9fa3ac, #787d88);\n+  background-image: linear-gradient(#9fa3ac, #787d88);\n+  background-color: #8b909a;\n+  border: 1px solid #DDD;\n+  border-color: rgba(0, 0, 0, 0.05) rgba(0, 0, 0, 0.2) rgba(0, 0, 0, 0.4);\n+  text-align: center;\n+  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n+}\n+\n+.navigation .current_page {\n+  box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.25);\n+  color: #FFF;\n+}\n+\n+.ft_search td {\n+  text-align: center;\n+}\n+\n+.ft_search .search_field {\n+  border-radius: 3px;\n+  -webkit-transition: box-shadow 150ms ease;\n+  transition: box-shadow 150ms ease;\n+  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.18);\n+  padding: 6px 7px;\n+  border: 1px solid #999;\n+  width: 600px;\n+  height: 30px;\n+  line-height: 30px;\n+  padding: 0 5px;\n+  font-size: 15px;\n+}\n+\n+.ft_search .search_submit {\n+  /* autoprefixer: off */\n+  display: inline-block;\n+  border: 1px solid #666;\n+  border-radius: 3px;\n+  padding: 0 16px;\n+  margin-left: 5px;\n+  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);\n+  height: 31px;\n+  line-height: 31px;\n+  background-image: -webkit-linear-gradient(#9fa3ac, #787d88);\n+  background-image: -moz-linear-gradient(#9fa3ac, #787d88);\n+  background-image: linear-gradient(#9fa3ac, #787d88);\n+  background-color: #8b909a;\n+  position: relative;\n+  top: -1px;\n+  font-size: 15px;\n+}\n+\n+.ft_search .search_submit:hover {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#787d88, #9fa3ac);\n+  background-image: -moz-linear-gradient(#787d88, #9fa3ac);\n+  background-image: linear-gradient(#787d88, #9fa3ac);\n+  background-color: #8b909a;\n+}\n+\n+/* Single topic */\n+.single_topic .ft_avatar {\n+  width: 80px;\n+}\n+\n+.single_topic .ft_avatar a {\n+  position: relative;\n+}\n+\n+.single_topic .ft_avatar a:before {\n+  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2) inset;\n+  content: \"\";\n+  display: block;\n+  height: 100%;\n+  position: absolute;\n+  width: 100%;\n+}\n+\n+.single_topic .ft_avatar a,\n+.single_topic .ft_avatar span,\n+.single_topic .ft_avatar img {\n+  display: inline-block;\n+}\n+\n+body.round_avatars .single_topic .ft_avatar a:before,\n+body.round_avatars .single_topic .ft_avatar a,\n+body.round_avatars .single_topic .ft_avatar span,\n+body.round_avatars .single_topic .ft_avatar img {\n+  border-radius: 50%;\n+}\n+\n+.single_topic .ft_post_info, .single_topic .ft_post_info td {\n+  color: #9CA5AD;\n+}\n+\n+.single_topic .ft_post_info a.permalink {\n+  color: #9CA5AD;\n+  font-weight: bold;\n+  float: right;\n+}\n+\n+.single_topic .ft_comment_response td {\n+  background: #F6F6F6;\n+}\n+\n+.single_topic .ft_comment_response h3 {\n+  margin: 0;\n+}\n+\n+.single_topic .star_rating {\n+  display: inline-block;\n+  margin-left: 10px;\n+}\n+\n+/* Legend table & list */\n+table.legend {\n+  text-align: center;\n+  margin: 20px auto;\n+}\n+\n+table.legend td {\n+  padding: 0 20px 0 5px;\n+  vertical-align: middle;\n+}\n+\n+ul.legend {\n+  list-style: none;\n+  border: none;\n+  text-align: center;\n+  padding: 0;\n+}\n+\n+ul.legend.bForums.bPosts {\n+  margin: 10px 0;\n+}\n+\n+ul.legend li {\n+  list-style: none;\n+  display: inline-block;\n+  white-space: nowrap;\n+  vertical-align: middle;\n+  margin: 5px;\n+}\n+\n+ul.legend li span {\n+  vertical-align: middle;\n+}\n+\n+ul.legend a {\n+  text-decoration: none;\n+  vertical-align: middle;\n+  display: inline-block;\n+}\n+\n+ul.legend span.note {\n+  float: none;\n+}\n+\n+/* Breadcrumbs */\n+.breadcrumbs {\n+  margin-bottom: 10px;\n+}\n+\n+.breadcrumbs a {\n+  /* autoprefixer: off */\n+  position: relative;\n+  display: inline-block;\n+  padding: 0 12px;\n+  background-color: #A3ACBE;\n+  background-image: -webkit-linear-gradient(#b5bdcb, #929bb1);\n+  background-image: -moz-linear-gradient(#b5bdcb, #929bb1);\n+  background-image: linear-gradient(#b5bdcb, #929bb1);\n+  border: 1px solid #000;\n+  border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.3);\n+  border-right: none;\n+  color: #FFF;\n+  font-size: 12px;\n+  font-weight: bold;\n+  line-height: 26px;\n+}\n+\n+.breadcrumbs a:first-child {\n+  border-bottom-left-radius: 3px;\n+  border-top-left-radius: 3px;\n+}\n+\n+.breadcrumbs a:last-child {\n+  /* autoprefixer: off */\n+  background-color: #848C9D;\n+  background-image: -webkit-linear-gradient(#98a0af, #70788c);\n+  background-image: -moz-linear-gradient(#98a0af, #70788c);\n+  background-image: linear-gradient(#98a0af, #70788c);\n+  border-bottom-right-radius: 3px;\n+  border-top-right-radius: 3px;\n+}\n+\n+.breadcrumbs a:last-child:before {\n+  /* autoprefixer: off */\n+  content: \"\";\n+  height: 20px;\n+  margin-top: -10.5px;\n+  position: absolute;\n+  right: -8px;\n+  top: 50%;\n+  width: 20px;\n+  background-image: -webkit-linear-gradient(45deg, #98a0af, #70788c);\n+  background-image: -moz-linear-gradient(45deg, #98a0af, #70788c);\n+  background-image: linear-gradient(45deg, #98a0af, #70788c);\n+  -webkit-transform: rotate(135deg) skew(-10deg, -10deg);\n+  -moz-transform: rotate(135deg) skew(-10deg, -10deg);\n+  -ms-transform: rotate(135deg) skew(-10deg, -10deg);\n+  transform: rotate(135deg) skew(-10deg, -10deg);\n+  -moz-border-radius-topright: 6px;\n+  -webkit-border-top-right-radius: 6px;\n+  border-top-right-radius: 6px;\n+  -moz-border-radius-bottomleft: 6px;\n+  -webkit-border-bottom-left-radius: 6px;\n+  border-bottom-left-radius: 6px;\n+  -webkit-box-shadow: inset 1px 1px rgba(0, 0, 0, 0.2);\n+  -moz-box-shadow: inset 1px 1px rgba(0, 0, 0, 0.2);\n+  box-shadow: inset 1px 1px rgba(0, 0, 0, 0.2);\n+}\n+\n+/* Statuses of posts display in table view */\n+.evo_content_block span[class*='status_'] {\n+  top: -10px;\n+  left: 20px;\n+}\n+\n+.forums_table span[class*='status_'],\n+.legend span[class*='status_'] {\n+  float: left;\n+  width: 80px;\n+}\n+\n+.forums_table span[class*='status_'] span,\n+.legend span[class*='status_'] span {\n+  text-align: center;\n+  padding: 3px 0;\n+  font-size: 11px;\n+  font-weight: bold;\n+  border: 1px solid #FFFFFF;\n+  border-radius: 12px 12px 12px 12px;\n+  float: left;\n+  width: 80px;\n+}\n+\n+.forums_table .ft_title span[class*='status_'] {\n+  margin-top: 7px;\n+}\n+\n+/* Tabs of user profile pages */\n+div.tabs {\n+  top: 0;\n+}\n+\n+div.tabs div a {\n+  border-color: #EEE;\n+  background: #FFF;\n+  padding: 10px 15px;\n+}\n+\n+div.tabs div a:hover,\n+div.tabs div.selected a {\n+  background: #EDEEF5;\n+  border-color: #EEE;\n+}\n+\n+div.edit_toolbar {\n+  width: 100%;\n+}\n+\n+.profile_pictured_fieldsets {\n+  min-height: 0;\n+}\n+\n+.profile_avatar {\n+  text-align: center;\n+  margin-bottom: 25px;\n+}\n+\n+body.round_avatars .profile_avatar img {\n+  border-radius: 3px;\n+}\n+\n+.edit_user_admin_link {\n+  margin-bottom: 10px;\n+}\n+\n+div.results div.table_scroll {\n+  box-sizing: border-box;\n+  padding: 7px;\n+}\n+\n+div.results div.title,\n+div.results div.filters {\n+  border: none;\n+  background: none;\n+}\n+\n+.pagination {\n+  display: inline-block;\n+  margin: 0;\n+  padding: 0;\n+}\n+\n+.pagination li {\n+  list-style: none;\n+  display: inline-block;\n+  padding: 3px;\n+}\n+\n+.form_send_contacts, .form_add_contacts > span.label {\n+  padding-left: 22px;\n+}\n+\n+#edit_group_contacts {\n+  /* autoprefixer: off */\n+  background-image: -webkit-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: -moz-linear-gradient(#f1f2f6, #e7e9f0);\n+  background-image: linear-gradient(#f1f2f6, #e7e9f0);\n+  border: none;\n+  padding: 10px;\n+  box-sizing: border-box;\n+}\n+\n+#edit_group_contacts p {\n+  margin-top: 0;\n+}\n+\n+.messages_list > h2 {\n+  border: none;\n+  border-top-left-radius: 5px;\n+  border-top-right-radius: 5px;\n+  box-shadow: 0 2px 6px rgba(117, 124, 142, 0.6);\n+  margin: 0 5px;\n+}\n+\n+.messages_list form.bComment {\n+  margin: 0 5px;\n+  padding-top: 0;\n+}\n+\n+.messages_list form.bComment,\n+.messages_list div.messages_list_actions {\n+  background: none;\n+  border: none;\n+}\n+\n+.messages_list form.bComment .forums_table,\n+.messages_list form.bComment .forums_table tr:first-child td {\n+  border-top-left-radius: 0;\n+  border-top-right-radius: 0;\n+  background: #FFF;\n+}\n+\n+.vote_spam {\n+  float: left;\n+  padding: 1px 5px 0;\n+  line-height: 19px;\n+}\n+\n+.vote_spam a, .vote_spam span {\n+  vertical-align: middle;\n+  top: -1px;\n+  display: inline-block;\n+}\n+\n+.vote_helpful {\n+  float: left;\n+  display: block;\n+  line-height: 21px;\n+  padding-right: 5px;\n+}\n+\n+/* The width switcher */\n+.switched_width {\n+  transition: all 1s;\n+  -moz-transition: all 1s;\n+  /* Firefox 4 */\n+  -webkit-transition: all 1s;\n+  /* Safari and Chrome */\n+  -o-transition: all 1s;\n+  /* Opera */\n+  -ms-transition: all 1s;\n+  /* IE */\n+}\n+\n+#width_switcher_layout {\n+  position: absolute;\n+  top: 115px;\n+  right: 3px;\n+  z-index: 10001;\n+}\n+\n+#width_switcher {\n+  display: none;\n+}\n+\n+#width_switcher a {\n+  width: 26px;\n+  height: 36px;\n+  text-decoration: none;\n+}\n+\n+#width_switcher.fixed {\n+  position: fixed;\n+  top: 3px;\n+  right: 3px;\n+}\n+\n+/* Devices with max width <= 1024px (iPhone,iPad):\n+   Don't fix a width switcher */\n+@media only screen and (max-device-width: 1024px) {\n+  #width_switcher.fixed {\n+    position: absolute;\n+    width: 75px;\n+  }\n+}"
        },
        {
          "filename": "skins_adm/bootstrap/_adminUI.class.php",
          "status": "modified",
          "additions": 0,
          "deletions": 12,
          "patch": "@@ -429,18 +429,6 @@ function get_template( $name, $depth = 0, $die_on_unknown = false )\n \t\t\t\t}\n \t\t\t\treturn $results_template;\n \n-\t\t\tcase 'compact_results':\n-\t\t\t\t// Compact Results list:\n-\t\t\t\treturn array_merge( $this->get_template( 'Results' ), array(\n-\t\t\t\t\t\t'before'           => '<div class=\"results results_compact panel panel-default\">',\n-\t\t\t\t\t\t'header_text'      => '',\n-\t\t\t\t\t\t'head_title'       => '',\n-\t\t\t\t\t\t'no_results_start' => '<div class=\"table_scroll\">'.\"\\n\"\n-\t\t\t\t\t\t\t\t.'<table class=\"table table-striped table-bordered table-hover table-condensed\" cellspacing=\"0\"><tbody>'.\"\\n\\n\",\n-\t\t\t\t\t\t'no_results_end'   => '<tr class=\"lastline noresults\"><td class=\"firstcol lastcol\">$no_results$</td></tr>'\n-\t\t\t\t\t\t\t\t.'</tbody></table></div>'.\"\\n\\n\",\n-\t\t\t\t\t) );\n-\n \t\t\tcase 'blockspan_form':\n \t\t\t\t// Form settings for filter area:\n \t\t\t\treturn array("
        },
        {
          "filename": "skins_email/_email_footer.inc.txt.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -28,7 +28,7 @@\n echo \"\\n\\n\";\n \n echo T_( 'Too many emails?' ).\"\\n\";\n-echo sprintf( T_('To edit your email notification preferences, click here: %s'), get_notifications_url( '&amp;', $recipient_user_ID ) );\n+echo sprintf( T_('To edit your email notification preferences, click here: %s'), get_notifications_url( '&', $recipient_user_ID ) );\n if( !empty( $params['unsubscribe_text'] ) )\n { // Display the unsubscribe message with link\n \techo \"\\n\".$params['unsubscribe_text'];"
        },
        {
          "filename": "skins_email/_email_header.inc.html.php",
          "status": "modified",
          "additions": 10,
          "deletions": 2,
          "patch": "@@ -40,8 +40,16 @@\n <?php\n if( $Settings->get( 'notification_logo' ) != '' )\n { // Display site logo\n-\t$site_name = $Settings->get( 'notification_long_name' ) != '' ? $Settings->get( 'notification_long_name' ) : $Settings->get( 'notification_short_name' );\n-\techo '<img src=\"'.$Settings->get( 'notification_logo' ).'\" alt=\"'.$site_name.'\" />';\n+\t$FileCache = & get_FileCache();\n+\tif( ( $File = get_FileCache()->get_by_ID( $Settings->get( 'notification_logo' ), false ) ) && $File->is_image() )\n+\t{\n+\t\t$site_name = $Settings->get( 'notification_long_name' ) != '' ? $Settings->get( 'notification_long_name' ) : $Settings->get( 'notification_short_name' );\n+\t\techo '<img src=\"'.$File->get_url().'\" alt=\"'.$site_name.'\" />';\n+\t}\n+\telse\n+\t{\n+\t\techo '<p'.emailskin_style( '.p+p.sitename' ).'>'.$Settings->get( 'notification_long_name' ).'</p>';\n+\t}\n }\n else\n { // No logo, Display only long site name"
        },
        {
          "filename": "skins_email/posts_stale_alert.html.php",
          "status": "added",
          "additions": 46,
          "deletions": 0,
          "patch": "@@ -0,0 +1,46 @@\n+<?php\n+/**\n+ * This is sent to ((Moderators)) to alert them that some posts are old.\n+ *\n+ * For more info about email skins, see: http://b2evolution.net/man/themes-templates-skins/email-skins/\n+ *\n+ * b2evolution - {@link http://b2evolution.net/}\n+ * Released under GNU GPL License - {@link http://b2evolution.net/about/gnu-gpl-license}\n+ * @copyright (c)2003-2016 by Francois Planque - {@link http://fplanque.com/}\n+ */\n+if( !defined('EVO_MAIN_INIT') ) die( 'Please, do not access this page directly.' );\n+\n+// ---------------------------- EMAIL HEADER INCLUDED HERE ----------------------------\n+emailskin_include( '_email_header.inc.html.php', $params );\n+// ------------------------------- END OF EMAIL HEADER --------------------------------\n+\n+$ItemCache = & get_ItemCache();\n+\n+// Default params:\n+$params = array_merge( array(\n+\t\t'months' => 1,\n+\t\t'posts'  => array(),\n+\t), $params );\n+\n+echo '<p'.emailskin_style( '.p' ).'>'.sprintf( T_('The following posts have not been updated in %s months:'), $params['months'] ).'</p>';\n+\n+echo '<ul>';\n+foreach( $params['posts'] as $post_ID )\n+{\n+\t$old_Item = $ItemCache->get_by_ID( $post_ID );\n+\techo '<li>'\n+\t\t\t.'<a href=\"'.$old_Item->get_permanent_url( '', '', '&' ).'\"'.emailskin_style( '.a' ).'>'.$old_Item->get( 'title' ).'</a>'\n+\t\t.'</li>';\n+}\n+echo '</ul>';\n+\n+// Footer vars:\n+$params['unsubscribe_text'] = T_( 'You are a moderator in this collection, and you are receiving notifications when stale posts may need moderation.' ).'<br />'.\"\\n\"\n+\t\t\t.T_( 'If you don\\'t want to receive any more notifications about stale posts, click here' ).': '\n+\t\t\t.'<a href=\"'.get_htsrv_url().'quick_unsubscribe.php?type=pst_stale_alert&user_ID=$user_ID$&key=$unsubscribe_key$\"'.emailskin_style( '.a' ).'>'\n+\t\t\t.T_('instant unsubscribe').'</a>.';\n+\n+// ---------------------------- EMAIL FOOTER INCLUDED HERE ----------------------------\n+emailskin_include( '_email_footer.inc.html.php', $params );\n+// ------------------------------- END OF EMAIL FOOTER --------------------------------\n+?>"
        },
        {
          "filename": "skins_email/posts_stale_alert.txt.php",
          "status": "added",
          "additions": 42,
          "deletions": 0,
          "patch": "@@ -0,0 +1,42 @@\n+<?php\n+/**\n+ * This is sent to ((Moderators)) to alert them that some posts are old.\n+ *\n+ * For more info about email skins, see: http://b2evolution.net/man/themes-templates-skins/email-skins/\n+ *\n+ * b2evolution - {@link http://b2evolution.net/}\n+ * Released under GNU GPL License - {@link http://b2evolution.net/about/gnu-gpl-license}\n+ * @copyright (c)2003-2016 by Francois Planque - {@link http://fplanque.com/}\n+ */\n+if( !defined('EVO_MAIN_INIT') ) die( 'Please, do not access this page directly.' );\n+\n+// ---------------------------- EMAIL HEADER INCLUDED HERE ----------------------------\n+emailskin_include( '_email_header.inc.txt.php', $params );\n+// ------------------------------- END OF EMAIL HEADER --------------------------------\n+\n+$ItemCache = & get_ItemCache();\n+\n+// Default params:\n+$params = array_merge( array(\n+\t\t'months' => 1,\n+\t\t'posts'  => array(),\n+\t), $params );\n+\n+echo sprintf( T_('The following posts have not been updated in %s months:'), $params['months'] );\n+echo \"\\n\\n\";\n+\n+foreach( $params['posts'] as $post_ID )\n+{\n+\t$old_Item = $ItemCache->get_by_ID( $post_ID );\n+\techo \"\\t - \".$old_Item->get( 'title' ).' - '.$old_Item->get_permanent_url( '', '', '&' ).\"\\n\";\n+}\n+\n+// Footer vars:\n+$params['unsubscribe_text'] = T_( 'You are a moderator in this collection, and you are receiving notifications when stale posts may need moderation.' ).\"\\n\".\n+\t\tT_( 'If you don\\'t want to receive any more notifications about stale posts, click here' ).': '.\n+\t\tget_htsrv_url().'quick_unsubscribe.php?type=pst_stale_alert&user_ID=$user_ID$&key=$unsubscribe_key$';\n+\n+// ---------------------------- EMAIL FOOTER INCLUDED HERE ----------------------------\n+emailskin_include( '_email_footer.inc.txt.php', $params );\n+// ------------------------------- END OF EMAIL FOOTER --------------------------------\n+?>\n\\ No newline at end of file"
        },
        {
          "filename": "skins_fallback_v6/_edit.disp.php",
          "status": "modified",
          "additions": 10,
          "deletions": 44,
          "patch": "@@ -376,50 +376,16 @@\n \t}\n }\n \n-if( $edited_Item->get_type_setting( 'allow_attachments' ) )\n-{ // ####################### ATTACHMENTS FIELDSETS #########################\n-\tglobal $advanced_edit_link;\n-\t$perm_view_files = $current_User->check_perm( 'files', 'view' );\n-\tif( $perm_view_files && $current_User->check_perm( 'admin', 'restricted' ) )\n-\t{\t// If current user has a permission to attach files to the edited Item from back-office:\n-\t\t$advanced_edit_link_params = ' href=\"'.$advanced_edit_link['href'].'\" onclick=\"'.$advanced_edit_link['onclick'].'\"';\n-\t\techo '<div class=\"well center\">';\n-\t\tif( $creating )\n-\t\t{\t// New post\n-\t\t\techo sprintf( T_('If you need to attach files, please use <a %s>Advanced Edit</a>.'), $advanced_edit_link_params );\n-\t\t}\n-\t\telse\n-\t\t{\t// Edit post\n-\t\t\techo sprintf( T_('If you need to attach additional files, please use <a %s>Advanced Edit</a>.'), $advanced_edit_link_params );\n-\t\t}\n-\t\techo '</div>';\n-\t}\n-\telseif( $edited_Item->can_attach() )\n-\t{\t// If current user can attach files to comments of the edited Item\n-\t\techo '<div class=\"well center\">';\n-\t\tif( $creating )\n-\t\t{\t// New post\n-\t\t\techo T_('If you need to attach files, please add a comment right after you post this.');\n-\t\t}\n-\t\telse\n-\t\t{\t// Edit post\n-\t\t\techo T_('If you need to attach additional files, please add a comment right after you edit this.');\n-\t\t}\n-\t\techo '</div>';\n-\t}\n-\tif( $perm_view_files && $edited_Item->ID > 0 )\n-\t{\t// If current user has a permission to view files\n-\t\t$LinkOwner = new LinkItem( $edited_Item );\n-\t\tif( $LinkOwner->count_links() )\n-\t\t{\t// Display the attached files:\n-\t\t\t$Form->begin_fieldset( T_('Attachments'), array( 'id' => 'post_attachments' ) );\n-\t\t\t\tdisplay_attachments( $LinkOwner, array(\n-\t\t\t\t\t\t'block_start' => '<div class=\"attachment_list results\">',\n-\t\t\t\t\t\t'table_start' => '<table class=\"table table-striped table-bordered table-hover table-condensed\" cellspacing=\"0\" cellpadding=\"0\">',\n-\t\t\t\t\t) );\n-\t\t\t$Form->end_fieldset();\n-\t\t}\n-\t}\n+// ####################### ATTACHMENTS/LINKS #########################\n+if( $edited_Item->get_type_setting( 'allow_attachments' ) &&\n+    $current_User->check_perm( 'files', 'view', false ) )\n+{\t// If current user has a permission to view the files AND attachments are allowed for the item type:\n+\tload_class( 'links/model/_linkitem.class.php', 'LinkItem' );\n+\t// Initialize this object as global because this is used in many link functions:\n+\tglobal $LinkOwner;\n+\t$LinkOwner = new LinkItem( $edited_Item, param( 'temp_link_owner_ID', 'integer', 0 ) );\n+\t// Display attachments fieldset:\n+\tdisplay_attachments_fieldset( $Form, $LinkOwner );\n }\n \n // ####################### PLUGIN FIELDSETS #########################"
        },
        {
          "filename": "skins_site/_site_body_header.inc.php",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -17,9 +17,18 @@\n <?php\n if( $Settings->get( 'notification_logo' ) != '' )\n {\n-\t$site_title = $Settings->get( 'notification_long_name' ) != '' ? ' title=\"'.$Settings->dget( 'notification_long_name', 'htmlattr' ).'\"' : '';\n-\t$site_name_text = '<img src=\"'.$Settings->get( 'notification_logo' ).'\" alt=\"'.$Settings->dget( 'notification_short_name', 'htmlattr' ).'\"'.$site_title.' />';\n-\t$site_title_class = ' swhead_logo';\n+\t$FileCache = & get_FileCache();\n+\tif( ( $File = get_FileCache()->get_by_ID( $Settings->get( 'notification_logo' ), false ) ) && $File->is_image() )\n+\t{\n+\t\t$site_title = $Settings->get( 'notification_long_name' ) != '' ? ' title=\"'.$Settings->dget( 'notification_long_name', 'htmlattr' ).'\"' : '';\n+\t\t$site_name_text = '<img src=\"'.$File->get_url().'\" alt=\"'.$Settings->dget( 'notification_short_name', 'htmlattr' ).'\"'.$site_title.' />';\n+\t\t$site_title_class = ' swhead_logo';\n+\t}\n+\telse\n+\t{\n+\t\t$site_name_text = $Settings->get( 'notification_short_name' );\n+\t\t$site_title_class = '';\n+\t}\n }\n else\n {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 4,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 48,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a7920fa31b433793ff59c14f70e6f01f613f595f",
            "date": "2022-09-09T13:59:39Z",
            "author_login": "fplanque"
          },
          {
            "sha": "d5c2e39d3748a4cb01c7796e506ef1c3bf303b93",
            "date": "2022-08-06T11:12:47Z",
            "author_login": "fplanque"
          },
          {
            "sha": "f370d003395ed952d2c8530107718f012637e0b9",
            "date": "2022-08-06T11:11:21Z",
            "author_login": "fplanque"
          },
          {
            "sha": "936822a34307d4442b490dc92570f2d2775d1703",
            "date": "2022-06-08T19:40:57Z",
            "author_login": "fplanque"
          },
          {
            "sha": "b983b82a19e96d69d8e87e8639093e893c8ae369",
            "date": "2022-06-07T20:11:05Z",
            "author_login": "fplanque"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "The patch for directory traversal (CVE-2017-5480) in b2evolution version 6.8.4-stable has a bypass vulnerability. An attacker can use ..\\/ to bypass the filter rule. Then, this attacker can exploit this vulnerability to delete or read any files on the server. It can also be used to determine whether a file exists.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-01-23T07:59:00.500",
    "last_modified": "2024-11-21T03:27:50.920",
    "fix_date": "2017-01-19T16:14:27Z"
  },
  "references": [
    {
      "url": "http://b2evolution.net/downloads/6-8-5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95700",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/b2evolution/b2evolution/commit/e35f7c195d8c1103d2d981a48cda5ab45ecac48a",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/b2evolution/b2evolution/issues/36",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://b2evolution.net/downloads/6-8-5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95700",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/b2evolution/b2evolution/commit/e35f7c195d8c1103d2d981a48cda5ab45ecac48a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/b2evolution/b2evolution/issues/36",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:49.839315",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "b2evolution",
    "owner": "b2evolution",
    "created_at": "2014-06-18T00:08:10Z",
    "updated_at": "2025-01-11T19:27:43Z",
    "pushed_at": "2022-12-06T19:28:38Z",
    "size": 186741,
    "stars": 178,
    "forks": 88,
    "open_issues": 7,
    "watchers": 178,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 19993657,
      "JavaScript": 7173401,
      "CSS": 708761,
      "Less": 354448,
      "HTML": 55597,
      "Pascal": 42369,
      "C": 20339,
      "Shell": 4778,
      "M4": 1601
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:31:19.972745"
  }
}