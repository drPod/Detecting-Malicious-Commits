{
  "cve_id": "CVE-2017-5602",
  "github_data": {
    "repository": "jappix/jappix",
    "fix_commit": "ea6de7c65b80880bdf85df47c1a8a5d3d68491af",
    "related_commits": [
      "ea6de7c65b80880bdf85df47c1a8a5d3d68491af",
      "ea6de7c65b80880bdf85df47c1a8a5d3d68491af"
    ],
    "patch_url": "https://github.com/jappix/jappix/commit/ea6de7c65b80880bdf85df47c1a8a5d3d68491af.patch",
    "fix_commit_details": {
      "sha": "ea6de7c65b80880bdf85df47c1a8a5d3d68491af",
      "commit_date": "2017-01-26T15:47:28Z",
      "author": {
        "login": "valeriansaliou",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bump up to v1.1.7",
        "length": 17,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 19,
        "additions": 11,
        "deletions": 8
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -4,10 +4,10 @@ Jappix Changelog\n Here's the log of what has changed over the Jappix releases.\n \n \n-Primo, v1.1.7 (Development)\n----------------------------\n+Primo, v1.1.7 (January 2017)\n+----------------------------\n \n- * (...)\n+ * Improve Carbons  @valeriansaliou\n \n \n Primo, v1.1.6 (August 2015)"
        },
        {
          "filename": "VERSION",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Primo [1.1.7~dev]\n+Primo [1.1.7]"
        },
        {
          "filename": "app/javascripts/carbons.js",
          "status": "modified",
          "additions": 7,
          "deletions": 4,
          "patch": "@@ -127,10 +127,13 @@ var Carbons = (function () {\n     self._getForwarded = function(message) {\n \n         try {\n-            var forwarded_message = $(message.getNode()).find('forwarded[xmlns=\"' + NS_URN_FORWARD + '\"]:first message:first');\n+            // Check message is forwarded from our local user\n+            if(Common.bareXID(Common.getStanzaFrom(message)) == Common.getXID()) {\n+                var forwarded_message = $(message.getNode()).find('forwarded[xmlns=\"' + NS_URN_FORWARD + '\"]:first message:first');\n \n-            if(forwarded_message[0]) {\n-                return JSJaCPacket.wrapNode(forwarded_message[0]);\n+                if(forwarded_message[0]) {\n+                    return JSJaCPacket.wrapNode(forwarded_message[0]);\n+                }\n             }\n \n             return null;\n@@ -238,4 +241,4 @@ var Carbons = (function () {\n      */\n     return self;\n \n-})();\n\\ No newline at end of file\n+})();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d4cc9f0fb9ef0706ba62a781f8acae2f20fd17f0",
            "date": "2020-12-10T08:43:55Z",
            "author_login": "valeriansaliou"
          },
          {
            "sha": "ea6de7c65b80880bdf85df47c1a8a5d3d68491af",
            "date": "2017-01-26T15:47:28Z",
            "author_login": "valeriansaliou"
          },
          {
            "sha": "53b16217d247897af04e67a5dd80e07a53b8edc1",
            "date": "2016-10-10T16:06:31Z",
            "author_login": "valeriansaliou"
          },
          {
            "sha": "941df95f4d4f89c6b8b1e35753d6444342a8726b",
            "date": "2016-06-10T09:04:25Z",
            "author_login": "valeriansaliou"
          },
          {
            "sha": "1c6c58c66da210d29b9fcbe424a943e8bbd30316",
            "date": "2016-06-09T09:59:46Z",
            "author_login": "valeriansaliou"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "An incorrect implementation of \"XEP-0280: Message Carbons\" in multiple XMPP clients allows a remote attacker to impersonate any user, including contacts, in the vulnerable application's display. This allows for various kinds of social engineering attacks. This CVE is for jappix 1.0.0 to 1.1.6.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-02-09T20:59:00.373",
    "last_modified": "2024-11-21T03:27:58.890",
    "fix_date": "2017-01-26T15:47:28Z"
  },
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/02/09/29",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96176",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/jappix/jappix/commit/ea6de7c65b80880bdf85df47c1a8a5d3d68491af",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://rt-solutions.de/en/2017/02/CVE-2017-5589_xmpp_carbons/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://rt-solutions.de/wp-content/uploads/2017/02/CVE-2017-5589_xmpp_carbons.pdf",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/02/09/29",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96176",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/jappix/jappix/commit/ea6de7c65b80880bdf85df47c1a8a5d3d68491af",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://rt-solutions.de/en/2017/02/CVE-2017-5589_xmpp_carbons/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://rt-solutions.de/wp-content/uploads/2017/02/CVE-2017-5589_xmpp_carbons.pdf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.218303",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jappix",
    "owner": "jappix",
    "created_at": "2012-01-18T16:55:44Z",
    "updated_at": "2024-09-19T11:47:45Z",
    "pushed_at": "2020-12-10T08:44:00Z",
    "size": 26309,
    "stars": 433,
    "forks": 143,
    "open_issues": 80,
    "watchers": 433,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 2735311,
      "PHP": 318318,
      "CSS": 243135,
      "Shell": 7436,
      "HTML": 261
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:36:01.333650"
  }
}