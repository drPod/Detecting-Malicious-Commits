{
  "cve_id": "CVE-2017-6310",
  "github_data": {
    "repository": "verdammelt/tnef",
    "fix_commit": "8dccf79857ceeb7a6d3e42c1e762e7b865d5344d",
    "related_commits": [
      "8dccf79857ceeb7a6d3e42c1e762e7b865d5344d",
      "8dccf79857ceeb7a6d3e42c1e762e7b865d5344d"
    ],
    "patch_url": "https://github.com/verdammelt/tnef/commit/8dccf79857ceeb7a6d3e42c1e762e7b865d5344d.patch",
    "fix_commit_details": {
      "sha": "8dccf79857ceeb7a6d3e42c1e762e7b865d5344d",
      "commit_date": "2017-02-19T18:36:35Z",
      "author": {
        "login": "EricSesterhennX41",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Check types to avoid invalid reads/writes.",
        "length": 42,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
      },
      "files": [
        {
          "filename": "src/file.c",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -173,24 +173,28 @@ file_add_mapi_attrs (File* file, MAPI_Attr** attrs)\n \t    switch (a->name)\n \t    {\n \t    case MAPI_ATTACH_LONG_FILENAME:\n+\t\tassert(a->type == szMAPI_STRING);\n \t\tif (file->name) XFREE(file->name);\n \t\tfile->name = strdup( (char*)a->values[0].data.buf );\n \t\tbreak;\n \n \t    case MAPI_ATTACH_DATA_OBJ:\n+\t\tassert((a->type == szMAPI_BINARY) || (a->type == szMAPI_OBJECT));\n \t\tfile->len = a->values[0].len;\n \t\tif (file->data) XFREE (file->data);\n \t\tfile->data = CHECKED_XMALLOC (unsigned char, file->len);\n \t\tmemmove (file->data, a->values[0].data.buf, file->len);\n \t\tbreak;\n \n              case MAPI_ATTACH_MIME_TAG:\n+\t\tassert(a->type == szMAPI_STRING);\n \t\tif (file->mime_type) XFREE (file->mime_type);\n \t\tfile->mime_type = CHECKED_XMALLOC (char, a->values[0].len);\n \t\tmemmove (file->mime_type, a->values[0].data.buf, a->values[0].len);\n \t\tbreak;\n \n                 case MAPI_ATTACH_CONTENT_ID:\n+                    assert(a->type == szMAPI_STRING);\n                     if (file->content_id) XFREE(file->content_id);\n                     file->content_id = CHECKED_XMALLOC (char, a->values[0].len);\n                     memmove (file->content_id, a->values[0].data.buf, a->values[0].len);"
        },
        {
          "filename": "src/tnef.c",
          "status": "modified",
          "additions": 9,
          "deletions": 7,
          "patch": "@@ -165,10 +165,12 @@ get_html_data (MAPI_Attr *a)\n     int j;\n     for (j = 0; j < a->num_values; j++)\n     {\n-\tbody[j] = XMALLOC(VarLenData, 1);\n-\tbody[j]->len = a->values[j].len;\n-\tbody[j]->data = CHECKED_XCALLOC(unsigned char, a->values[j].len);\n-\tmemmove (body[j]->data, a->values[j].data.buf, body[j]->len);\n+        if (a->type == szMAPI_BINARY) {\n+ \t    body[j] = XMALLOC(VarLenData, 1);\n+\t    body[j]->len = a->values[j].len;\n+\t    body[j]->data = CHECKED_XCALLOC(unsigned char, a->values[j].len);\n+\t    memmove (body[j]->data, a->values[j].data.buf, body[j]->len);\n+        }\n     }\n     return body;\n }\n@@ -306,13 +308,13 @@ parse_file (FILE* input_file, char* directory,\n \t\t    for (i = 0; mapi_attrs[i]; i++)\n \t\t    {\n \t\t\tMAPI_Attr *a = mapi_attrs[i];\n-\t\t\t    \n-\t\t\tif (a->name == MAPI_BODY_HTML)\n+\t\t\n+\t\t\tif (a->type == szMAPI_BINARY && a->name == MAPI_BODY_HTML)\n \t\t\t{\n \t\t\t    body.html_bodies = get_html_data (a);\n                                 html_size = a->num_values;\n \t\t\t}\n-\t\t\telse if (a->name == MAPI_RTF_COMPRESSED)\n+\t\t\telse if (a->type == szMAPI_BINARY && a->name == MAPI_RTF_COMPRESSED)\n \t\t\t{\n \t\t\t    body.rtf_bodies = get_rtf_data (a);\n                                 rtf_size = a->num_values;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c5a5b7537c9b4d3f8a3196c2edf2b65bd9315b99",
            "date": "2020-12-23T15:06:09Z",
            "author_login": "verdammelt"
          },
          {
            "sha": "45459a21f8c3ef1af31fb5df999269756265f0ce",
            "date": "2020-12-22T11:17:47Z",
            "author_login": "ddeka2910"
          },
          {
            "sha": "1810f3a99a79026c84db38afa5181f25d7d48b37",
            "date": "2019-12-07T02:12:19Z",
            "author_login": "verdammelt"
          },
          {
            "sha": "d1500b172eda132365122ca5835fcc67b36fb022",
            "date": "2019-11-15T10:18:20Z",
            "author_login": "joankaradimov"
          },
          {
            "sha": "5a7a2cd7ca16e8a4722b48551e736dc9545a9c3e",
            "date": "2019-11-15T10:18:03Z",
            "author_login": "joankaradimov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "An issue was discovered in tnef before 1.4.13. Four type confusions have been identified in the file_add_mapi_attrs() function. These might lead to invalid read and write operations, controlled by an attacker.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-02-24T04:59:00.670",
    "last_modified": "2024-11-21T03:29:32.073",
    "fix_date": "2017-02-19T18:36:35Z"
  },
  "references": [
    {
      "url": "http://www.debian.org/security/2017/dsa-3798",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96427",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/verdammelt/tnef/blob/master/ChangeLog",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/verdammelt/tnef/commit/8dccf79857ceeb7a6d3e42c1e762e7b865d5344d",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201708-02",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.x41-dsec.de/lab/advisories/x41-2017-004-tnef/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-3798",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96427",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/verdammelt/tnef/blob/master/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/verdammelt/tnef/commit/8dccf79857ceeb7a6d3e42c1e762e7b865d5344d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201708-02",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.x41-dsec.de/lab/advisories/x41-2017-004-tnef/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.236710",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tnef",
    "owner": "verdammelt",
    "created_at": "2011-11-05T22:33:05Z",
    "updated_at": "2024-07-11T20:59:40Z",
    "pushed_at": "2020-12-23T15:06:10Z",
    "size": 3927,
    "stars": 58,
    "forks": 21,
    "open_issues": 0,
    "watchers": 58,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 140113,
      "Shell": 71078,
      "Makefile": 5138,
      "Awk": 4439,
      "Perl": 3811,
      "M4": 2732
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:25:18.608066"
  }
}