{
  "cve_id": "CVE-2017-6391",
  "github_data": {
    "repository": "kaltura/server",
    "fix_commit": "041a6d5e8336f7713985b120139c8f4b6279a337",
    "related_commits": [
      "041a6d5e8336f7713985b120139c8f4b6279a337",
      "041a6d5e8336f7713985b120139c8f4b6279a337"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "041a6d5e8336f7713985b120139c8f4b6279a337",
      "commit_date": "2017-02-27T20:48:03Z",
      "author": {
        "login": "etameran",
        "type": "User",
        "stats": {
          "total_commits": 404,
          "average_weekly_commits": 0.6699834162520729,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 88
        }
      },
      "commit_message": {
        "title": "Merge pull request #5304 from kaltura/strip_tags",
        "length": 102,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 40,
        "additions": 20,
        "deletions": 20
      },
      "files": [
        {
          "filename": "admin_console/web/tools/AkamaiBroadcaster.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -12,11 +12,11 @@\n <script language=\"javascript\">\n \n \t\n-\tvar flashVars = 'cpcode=<?php echo $_GET['streamUsername']; ?>';\n-\tflashVars += '&passwd=<?php echo $_GET['streamPassword']; ?>';\n-\tflashVars += '&streamname=<?php echo $_GET['entryId']; ?>@<?php echo $_GET['streamRemoteId']; ?>';\n-\tflashVars += '&primaryep=p.ep<?php echo $_GET['streamRemoteId']; ?>.i.akamaientrypoint.net';\n-\tflashVars += '&backupep=b.ep<?php echo $_GET['streamRemoteBackupId']; ?>.i.akamaientrypoint.net';\n+\tvar flashVars = 'cpcode=<?php echo strip_tags($_GET['streamUsername']); ?>';\n+\tflashVars += '&passwd=<?php echo strip_tags($_GET['streamPassword']); ?>';\n+\tflashVars += '&streamname=<?php echo strip_tags($_GET['entryId']); ?>@<?php echo strip_tags($_GET['streamRemoteId']); ?>';\n+\tflashVars += '&primaryep=p.ep<?php echo strip_tags($_GET['streamRemoteId']); ?>.i.akamaientrypoint.net';\n+\tflashVars += '&backupep=b.ep<?php echo strip_tags($_GET['streamRemoteBackupId']); ?>.i.akamaientrypoint.net';\n \t\n \n \tif (AC_FL_RunContent == 0) {"
        },
        {
          "filename": "admin_console/web/tools/SimpleJWPlayer.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,13 +7,13 @@\n         value=\"non-commercial.swf\" />\n         <param name=\"wmode\" value=\"transparent\" />\n         <param name=\"allowScriptAccess\" value=\"always\" />\n-        <param name=\"flashvars\" value=\"file=<?php echo $_GET['entryId']; ?>_1@<?php echo $_GET['streamRemoteId']; ?>&subscribe=true&streamer=rtmp://cp<?php echo $_GET['streamUsername']; ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n+        <param name=\"flashvars\" value=\"file=<?php echo strip_tags($_GET['entryId']); ?>_1@<?php echo strip_tags($_GET['streamRemoteId']); ?>&subscribe=true&streamer=rtmp://cp<?php echo strip_tags($_GET['streamUsername']); ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n         <embed id=\"jw_player__1267721422280\"\n         name=\"jw_player__1267721422280\"\n         src=\"non-commercial.swf\"\n         width=\"400\" height=\"319\" allowfullscreen=\"true\"\n         wmode=\"transparent\" allowscriptaccess=\"always\"\n-        flashvars=\"file=<?php echo $_GET['entryId']; ?>_1@<?php echo $_GET['streamRemoteId']; ?>&subscribe=true&streamer=rtmp://cp<?php echo $_GET['streamUsername']; ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n+        flashvars=\"file=<?php echo strip_tags($_GET['entryId']); ?>_1@<?php echo strip_tags($_GET['streamRemoteId']); ?>&subscribe=true&streamer=rtmp://cp<?php echo strip_tags($_GET['streamUsername']); ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n         <noembed>\n           <a href=\"http://www.kaltura.org/\">Open Source Video</a>\n         </noembed>"
        },
        {
          "filename": "admin_console/web/tools/XmlJWPlayer.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,13 +7,13 @@\n         value=\"non-commercial.swf\" />\n         <param name=\"wmode\" value=\"transparent\" />\n         <param name=\"allowScriptAccess\" value=\"always\" />\n-        <param name=\"flashvars\" value=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo $_GET['entryId']; ?>\" />\n+        <param name=\"flashvars\" value=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo strip_tags($_GET['entryId']); ?>\" />\n         <embed id=\"jw_player__1267721422280\"\n         name=\"jw_player__1267721422280\"\n         src=\"non-commercial.swf\"\n         width=\"400\" height=\"319\" allowfullscreen=\"true\"\n         wmode=\"transparent\" allowscriptaccess=\"always\" \n-        flashvars=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo $_GET['entryId']; ?>\" />\n+        flashvars=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo strip_tags($_GET['entryId']); ?>\" />\n         <noembed>\n           <a href=\"http://www.kaltura.org/\">Open Source Video</a>\n         </noembed>"
        },
        {
          "filename": "admin_console/web/tools/bigRedButton.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -5,9 +5,9 @@\n if(!isset($_GET['playerVersion']))\n \tdie('html5 lib version must be supplied in query string');\n \n-$partnerId = $_GET['partnerId'];\n+$partnerId = strip_tags($_GET['partnerId']);\n \n-$html5Version = $_GET['playerVersion'];\n+$html5Version = strip_tags($_GET['playerVersion']);\n ?>\n <!DOCTYPE html>\n <!--[if lt IE 7]>      <html class=\"lt-ie10 lt-ie9 lt-ie8 lt-ie7\"> <![endif]-->\n@@ -305,15 +305,15 @@ function updateSystemTime()\n \t\t</tr>\n \t\t<tr>\n \t\t\t<td>Admin Secret:</td>\n-\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? $_GET['secret'] : ''; ?>\" />\n+\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? strip_tags($_GET['secret']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr>\n \t\t\t<td>Entry Id:</td>\n-\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? $_GET['entryId'] : ''; ?>\" />\n+\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? strip_tags($_GET['entryId']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr>\n         \t<td>uiConf Id:</td>\n-            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? $_GET['uiConfId'] : ''; ?>\" />\n+            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? strip_tags($_GET['uiConfId']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr>\n \t\t\t<td colspan=\"2\">"
        },
        {
          "filename": "admin_console/web/tools/bigRedButtonPtsPoc.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -5,9 +5,9 @@\n if(!isset($_GET['playerVersion']))\n \tdie('html5 lib version must be supplied in query string');\n \n-$partnerId = $_GET['partnerId'];\n+$partnerId = strip_tags($_GET['partnerId']);\n \n-$html5Version = $_GET['playerVersion'];\n+$html5Version = strip_tags($_GET['playerVersion']);\n ?>\n <!DOCTYPE html>\n <!--[if lt IE 7]>      <html class=\"lt-ie10 lt-ie9 lt-ie8 lt-ie7\"> <![endif]-->\n@@ -210,19 +210,19 @@ function sendAd(){\n \t  \t<table>\n \t\t<tr style=\"display: none; \">\n \t\t\t<td>Admin Secret:</td>\n-\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? $_GET['secret'] : ''; ?>\" />\n+\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? strip_tags($_GET['secret']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr style=\"display: none; \">\n \t\t\t<td>Entry Id:</td>\n-\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? $_GET['entryId'] : ''; ?>\" />\n+\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? strip_tags($_GET['entryId']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr style=\"display: none; \">\n         \t<td>Admin uiConf Id:</td>\n-            <td><input type=\"text\" id=\"txtAdminUiConfId\" value=\"<?php echo isset($_GET['adminUiConfId']) ? $_GET['adminUiConfId'] : ''; ?>\" />\n+            <td><input type=\"text\" id=\"txtAdminUiConfId\" value=\"<?php echo isset($_GET['adminUiConfId']) ? strip_tags($_GET['adminUiConfId']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr style=\"display: none; \">\n         \t<td>User uiConf Id:</td>\n-            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? $_GET['uiConfId'] : ''; ?>\" />\n+            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? strip_tags($_GET['uiConfId']) : ''; ?>\" />\n \t\t</td>\n \t\t<tr style=\"display: none; \">\n \t\t\t<td colspan=\"2\">"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2ec0e7e180a28dd231c1ba1d9f2eadeabc7af320",
            "date": "2025-01-22T17:55:17Z",
            "author_login": "yossipapi"
          },
          {
            "sha": "d719b57b797b6120bccf4e4e2166a1c0729beaf8",
            "date": "2025-01-22T10:51:53Z",
            "author_login": "yossipapi"
          },
          {
            "sha": "5f0309e595bb6fc6f62f38c12e43feddbc831578",
            "date": "2025-01-21T19:48:44Z",
            "author_login": "MosheMaorKaltura"
          },
          {
            "sha": "7e9e74c8dac22634e0db2a2ec0f5accd9cc34a87",
            "date": "2025-01-21T14:57:45Z",
            "author_login": "ravitshalem"
          },
          {
            "sha": "718b99181e436a78aa2e4aaf725d7df87ddcf20c",
            "date": "2025-01-21T13:17:13Z",
            "author_login": "salma2222"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "An issue was discovered in Kaltura server Lynx-12.11.0. The vulnerability exists due to insufficient filtration of user-supplied data passed to the \"admin_console/web/tools/SimpleJWPlayer.php\" URL, the \"admin_console/web/tools/AkamaiBroadcaster.php\" URL, the \"admin_console/web/tools/bigRedButton.php\" URL, and the \"admin_console/web/tools/bigRedButtonPtsPoc.php\" URL. An attacker could execute arbitrary HTML and script code in a browser in the context of the vulnerable website.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-03-02T06:59:00.340",
    "last_modified": "2024-11-21T03:29:39.960",
    "fix_date": "2017-02-27T20:48:03Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/96534",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/kaltura/server/commit/041a6d5e8336f7713985b120139c8f4b6279a337",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/server/issues/5300",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96534",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/kaltura/server/commit/041a6d5e8336f7713985b120139c8f4b6279a337",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/server/issues/5300",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.242179",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "server",
    "owner": "kaltura",
    "created_at": "2013-07-12T08:59:26Z",
    "updated_at": "2025-01-14T16:20:33Z",
    "pushed_at": "2025-01-14T16:20:29Z",
    "size": 318066,
    "stars": 380,
    "forks": 175,
    "open_issues": 298,
    "watchers": 380,
    "has_security_policy": false,
    "default_branch": "Ursa-21.8.0",
    "protected_branches": [],
    "languages": {
      "PHP": 33405617,
      "JavaScript": 3724154,
      "HTML": 1396614,
      "CSS": 488697,
      "XSLT": 87985,
      "Hack": 62818,
      "Python": 55158,
      "Shell": 39188,
      "Java": 22994,
      "Makefile": 285,
      "PowerShell": 131
    },
    "commit_activity": {
      "total_commits_last_year": 1226,
      "avg_commits_per_week": 23.576923076923077,
      "days_active_last_year": 229
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T16:26:33.011095"
  }
}