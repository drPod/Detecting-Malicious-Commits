{
  "cve_id": "CVE-2017-6429",
  "github_data": {
    "repository": "appneta/tcpreplay",
    "fix_commit": "d689d14dbcd768c028eab2fb378d849e543dcfe9",
    "related_commits": [
      "d689d14dbcd768c028eab2fb378d849e543dcfe9",
      "d689d14dbcd768c028eab2fb378d849e543dcfe9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "d689d14dbcd768c028eab2fb378d849e543dcfe9",
      "commit_date": "2017-02-27T04:45:59Z",
      "author": {
        "login": "fklassen",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "#278 fail if capture has a packet that is too large (#286)",
        "length": 135,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
      },
      "files": [
        {
          "filename": "docs/CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,4 +1,5 @@\n 02/26/2017 Version 4.2.0beta1\n+    - tcpcapinfo buffer overflow vulnerablily (#278)\n     - Update git-clone instructions by Kyle McDonald (#277) \n     - Add protection against packet drift by Guillaume Scott (#268)\n     - Include Travis-CI build support by Ilya Shipitsin (#264) (#285)"
        },
        {
          "filename": "src/tcpcapinfo.c",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -281,6 +281,15 @@ main(int argc, char *argv[])\n                 caplen = pcap_ph.caplen;\n             }\n \n+            if (caplentoobig) {\n+                printf(\"\\n\\nCapture file appears to be damaged or corrupt.\\n\"\n+                        \"Contains packet of size %u, bigger than snap length %u\\n\",\n+                        caplen, pcap_fh.snaplen);\n+\n+                close(fd);\n+                break;\n+            }\n+\n             /* check to make sure timestamps don't go backwards */\n             if (last_sec > 0 && last_usec > 0) {\n                 if ((pcap_ph.ts.tv_sec == last_sec) ? \n@@ -306,7 +315,7 @@ main(int argc, char *argv[])\n                 }\n \n                 close(fd);\n-                continue;\n+                break;\n             }\n \n             /* print the frame checksum */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6fcbf0324088561d95c356fe8337f4faac275f1a",
            "date": "2024-07-12T17:24:12Z",
            "author_login": "fklassen"
          },
          {
            "sha": "0ba7d17fcb9ddedf61168f99c249b30731310d4e",
            "date": "2024-07-12T16:15:38Z",
            "author_login": "fklassen"
          },
          {
            "sha": "214c131056832d37822636d62bf13860ffded588",
            "date": "2024-07-12T17:03:36Z",
            "author_login": "fklassen"
          },
          {
            "sha": "d62a6852b5a5086e402640c30cae87999a7f8e25",
            "date": "2024-07-12T15:52:39Z",
            "author_login": "fklassen"
          },
          {
            "sha": "8e9cad01e02efcc4940c14e902b281a936f76d62",
            "date": "2024-07-12T05:25:00Z",
            "author_login": "fklassen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-119",
    "description": "Buffer overflow in the tcpcapinfo utility in Tcpreplay before 4.2.0 Beta 1 allows remote attackers to have unspecified impact via a pcap file with an over-size packet.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-03-15T15:59:01.000",
    "last_modified": "2024-11-21T03:29:45.223",
    "fix_date": "2017-02-27T04:45:59Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/archive/1/540221/100/0/threaded",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96579",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/appneta/tcpreplay/commit/d689d14dbcd768c028eab2fb378d849e543dcfe9",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/appneta/tcpreplay/issues/278",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/appneta/tcpreplay/releases/tag/v4.2.0-beta1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/archive/1/540221/100/0/threaded",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/96579",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/appneta/tcpreplay/commit/d689d14dbcd768c028eab2fb378d849e543dcfe9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/appneta/tcpreplay/issues/278",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/appneta/tcpreplay/releases/tag/v4.2.0-beta1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:52.269827",
    "processing_status": "enhanced"
  }
}