{
  "cve_id": "CVE-2017-7412",
  "github_data": {
    "repository": "NixOS/nixpkgs",
    "fix_commit": "6c59d851e2967410cc8fb6ba3f374b1d3efa988e",
    "related_commits": [
      "6c59d851e2967410cc8fb6ba3f374b1d3efa988e",
      "fa4fe7110566d8370983fa81f2b04a833339236d",
      "6c59d851e2967410cc8fb6ba3f374b1d3efa988e",
      "fa4fe7110566d8370983fa81f2b04a833339236d"
    ],
    "patch_url": "https://github.com/NixOS/nixpkgs/commit/6c59d851e2967410cc8fb6ba3f374b1d3efa988e.patch",
    "fix_commit_details": {
      "sha": "6c59d851e2967410cc8fb6ba3f374b1d3efa988e",
      "commit_date": "2017-03-27T13:11:44Z",
      "author": {
        "login": "rasendubi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "docker: fix socket permissions",
        "length": 420,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
      },
      "files": [
        {
          "filename": "nixos/modules/virtualisation/docker.nix",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -126,7 +126,17 @@ in\n \n         path = [ pkgs.kmod ] ++ (optional (cfg.storageDriver == \"zfs\") pkgs.zfs);\n       };\n-      systemd.sockets.docker.socketConfig.ListenStream = cfg.listenOptions;\n+\n+      systemd.sockets.docker = {\n+        description = \"Docker Socket for the API\";\n+        wantedBy = [ \"sockets.target\" ];\n+        socketConfig = {\n+          ListenStream = cfg.listenOptions;\n+          SocketMode = \"0660\";\n+          SocketUser = \"root\";\n+          SocketGroup = \"docker\";\n+        };\n+      };\n     }\n   ]);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "be96678fad9c20b149e977600ac19e24cbad0de7",
            "date": "2025-01-14T17:42:30Z",
            "author_login": "misuzu"
          },
          {
            "sha": "5d19bc443c456b03949caa7638a6ad7b62d196af",
            "date": "2025-01-14T17:30:46Z",
            "author_login": "Mic92"
          },
          {
            "sha": "c01257f8132ebcab98e26162e8b6b6e2fe1bf8cb",
            "date": "2025-01-14T17:25:05Z",
            "author_login": "Mic92"
          },
          {
            "sha": "6cacf1e7f031ef5d2c37c13bedcc83521264f8c8",
            "date": "2025-01-14T17:19:29Z",
            "author_login": "r-vdp"
          },
          {
            "sha": "94cde4b3e53c2c0bf2c1da58ae7abc42487580ed",
            "date": "2025-01-12T14:58:25Z",
            "author_login": "TakodaS"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": null,
    "description": "NixOS 17.03 before 17.03.887 has a world-writable Docker socket, which allows local users to gain privileges by executing docker commands.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2017-04-04T00:59:00.160",
    "last_modified": "2024-11-21T03:31:50.847",
    "fix_date": "2017-03-27T13:11:44Z"
  },
  "references": [
    {
      "url": "http://lists.science.uu.nl/pipermail/nix-dev/2017-April/023329.html",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/NixOS/nixpkgs/commit/6c59d851e2967410cc8fb6ba3f374b1d3efa988e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NixOS/nixpkgs/commit/fa4fe7110566d8370983fa81f2b04a833339236d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.science.uu.nl/pipermail/nix-dev/2017-April/023329.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/NixOS/nixpkgs/commit/6c59d851e2967410cc8fb6ba3f374b1d3efa988e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NixOS/nixpkgs/commit/fa4fe7110566d8370983fa81f2b04a833339236d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.841135",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "nixpkgs",
    "owner": "NixOS",
    "created_at": "2012-06-04T02:49:46Z",
    "updated_at": "2025-01-14T14:37:41Z",
    "pushed_at": "2025-01-14T14:37:33Z",
    "size": 4796325,
    "stars": 18917,
    "forks": 14675,
    "open_issues": 15863,
    "watchers": 18917,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Nix": 79429827,
      "Shell": 1640623,
      "Python": 1225583,
      "Perl": 203325,
      "Rust": 172380,
      "C": 168053,
      "Ruby": 89197,
      "JavaScript": 70213,
      "Haskell": 45124,
      "Roff": 38988,
      "Common Lisp": 29230,
      "Emacs Lisp": 25232,
      "Meson": 21889,
      "Vim Script": 21329,
      "Prolog": 10474,
      "sed": 10188,
      "M4": 9030,
      "Scheme": 8506,
      "TypeScript": 7936,
      "Julia": 7373,
      "SmPL": 6641,
      "Nim": 5753,
      "XSLT": 5287,
      "D": 5281,
      "R": 4720,
      "Awk": 4234,
      "CMake": 3618,
      "Go": 3275,
      "TeX": 2959,
      "PLpgSQL": 2748,
      "C++": 2562,
      "VHDL": 2420,
      "Boogie": 2147,
      "PHP": 2002,
      "C#": 1961,
      "Cuda": 1902,
      "Nushell": 1711,
      "Makefile": 1657,
      "Lua": 1521,
      "Java": 1497,
      "Erlang": 1437,
      "jq": 1038,
      "CUE": 876,
      "Jupyter Notebook": 826,
      "CSS": 774,
      "Jasmin": 656,
      "Smarty": 342,
      "Nu": 338,
      "Elvish": 213,
      "HCL": 210,
      "Tcl": 183,
      "Reason": 182,
      "PureScript": 170,
      "Verilog": 125,
      "Dune": 33
    },
    "commit_activity": {
      "total_commits_last_year": 161896,
      "avg_commits_per_week": 3113.3846153846152,
      "days_active_last_year": 360
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:38:47.889412"
  }
}