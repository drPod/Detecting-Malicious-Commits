{
  "cve_id": "CVE-2017-8098",
  "github_data": {
    "repository": "e107inc/e107",
    "fix_commit": "7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5",
    "related_commits": [
      "7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5",
      "7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5"
    ],
    "patch_url": "https://github.com/e107inc/e107/commit/7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5.patch",
    "fix_commit_details": {
      "sha": "7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5",
      "commit_date": "2017-03-02T20:51:03Z",
      "author": {
        "login": "CaMer0n",
        "type": "User",
        "stats": {
          "total_commits": 8048,
          "average_weekly_commits": 8.50739957716702,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 634
        }
      },
      "commit_message": {
        "title": "Token fixes.",
        "length": 12,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 26,
        "deletions": 5
      },
      "files": [
        {
          "filename": "e107_admin/frontpage.php",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -18,6 +18,10 @@\n  *\t@version \t$Id$;\r\n  */\r\n \r\n+if(!empty($_POST) && !isset($_POST['e-token']))\r\n+{\r\n+\t$_POST['e-token'] = '';\r\n+}\r\n require_once ('../class2.php');\r\n if(! getperms('G'))\r\n {\r\n@@ -392,6 +396,7 @@ function select_class(&$fp_settings, $show_button = TRUE)\n \t\t$show_legend = $show_button ? \" class='e-hideme'\" : '';\r\n \t\t$text = \"\r\n \t\t<form method='post' action='\".e_SELF.\"'>\r\n+\t\t<input type='hidden' name='e-token' value='\".e_TOKEN.\"' />\r\n \t\t\t<fieldset id='frontpage-settings'>\r\n \t\t\t\t<legend{$show_legend}>\".FRTLAN_13.\"</legend>\r\n \r\n@@ -494,7 +499,9 @@ function edit_rule($rule_info)\n // <legend class='e-hideme'>\".($rule_info['order'] ? FRTLAN_46 : FRTLAN_42).\"</legend>\r\n \r\n \t\t$text = \"\r\n-\t\t<form method='post' action='\".e_SELF.\"'>\";\r\n+\t\t<form method='post' action='\".e_SELF.\"'>\r\n+\t\t<input type='hidden' name='e-token' value='\".e_TOKEN.\"' />\r\n+\t\t\";\r\n \t\t\r\n \t\t$text .= '<ul class=\"nav nav-tabs\" id=\"myTabs\">\r\n \t\t\t<li class=\"active\"><a data-toggle=\"tab\" href=\"#home\">'.FRTLAN_49.'</a></li>\r"
        },
        {
          "filename": "e107_admin/meta.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -10,6 +10,10 @@\n  *\n  *\n */\n+if(!empty($_POST) && !isset($_POST['e-token']))\n+{\n+\t$_POST['e-token'] = '';\n+}\n require_once(\"../class2.php\");\n \n if (!getperms(\"T\")) \n@@ -128,6 +132,7 @@\n \t\t\t<div class='buttons-bar center'>\".\n \t\t\t\t$frm->admin_button('metasubmit','no-value','update', LAN_UPDATE).\"\n \t\t\t</div>\n+\t\t\t<input type='hidden' name='e-token' value='\".e_TOKEN.\"' />\n \t\t</fieldset>\n \t</form>\n \";"
        },
        {
          "filename": "e107_admin/plugin.php",
          "status": "modified",
          "additions": 8,
          "deletions": 4,
          "patch": "@@ -212,7 +212,6 @@ public function init()\n \t\t\t}\n \n \n-\n \t\t\tif($this->getMode()=== 'avail')\n \t\t\t{\n \t\t\t\t$this->listQry  = \"SELECT * FROM `#plugin` WHERE plugin_installflag = 0 AND plugin_category != 'menu'  \";\n@@ -397,7 +396,10 @@ function uninstallPage()\n \n \t\t\t$post = e107::getParser()->filter($_POST);\n \n-\n+\t\t\tif(empty($_POST['e-token']))\n+\t\t\t{\n+\t\t\t\treturn false;\n+\t\t\t}\n \n \t\t//\t$id = e107::getPlugin\n \n@@ -811,13 +813,15 @@ private function pluginConfirmUninstall($plug_vars)\n \t\t\t*/\n              //   $frm->admin_button($name, $value, $action = 'submit', $label = '', $options = array());\n \n-\t\t\t$text .= \"</div>\n+\n+\n+\t\t\t$text .= \"<input type='hidden' name='e-token' value='\".e_TOKEN.\"' /></div>\n \t\t\t</fieldset>\n \t\t\t</form>\n \t\t\t\";\n \n \t\t\treturn $text;\n-\t\t\te107::getRender()->tablerender(EPL_ADLAN_63.SEP.$tp->toHtml($plug_vars['@attributes']['name'], \"\", \"defs,emotes_off, no_make_clickable\"),$mes->render(). $text);\n+\t\t//\te107::getRender()->tablerender(EPL_ADLAN_63.SEP.$tp->toHtml($plug_vars['@attributes']['name'], \"\", \"defs,emotes_off, no_make_clickable\"),$mes->render(). $text);\n \n \t\t}\n \t/*"
        },
        {
          "filename": "e107_admin/prefs.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -10,6 +10,10 @@\n  *\n  */\n \n+if(!empty($_POST) && !isset($_POST['e-token']))\n+{\n+\t$_POST['e-token'] = '';\n+}\n require_once (\"../class2.php\");\n \n if(isset($_POST['newver']))\n@@ -309,6 +313,7 @@ function sendTest()\n $text = \"\n <div id='core-prefs'>\n \t<form class='admin-menu' method='post' action='\".e_SELF.\"' autocomplete='off'>\n+\t<input type='hidden' name='e-token' value='\".e_TOKEN.\"' />\n \t\t<fieldset id='core-prefs-main'>\n \t\t\t<legend>\".PRFLAN_1.\"</legend>\n \t\t\t<table class='table adminform'>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b51833b794a5fa3ff42ed748fef75b87250f9418",
            "date": "2025-01-13T23:35:28Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "6aa42ccad90cbdcc1c9e6a3933bcd7124380a1a2",
            "date": "2025-01-13T19:41:57Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "d86eeac7bc3cc714532d46eb96c3c9429d4be5fd",
            "date": "2025-01-13T19:20:05Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "73c5760cbb55bb61af60dcda02e523d2ea4c4caa",
            "date": "2025-01-10T18:48:13Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "a5f790dab1650d1bd1438ca2f46b8f958f7a2da0",
            "date": "2025-01-10T18:39:18Z",
            "author_login": "CaMer0n"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "e107 2.1.4 is vulnerable to cross-site request forgery in plugin-installing, meta-changing, and settings-changing. A malicious web page can use forged requests to make e107 download and install a plug-in provided by the attacker.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-04-24T18:59:00.663",
    "last_modified": "2024-11-21T03:33:18.993",
    "fix_date": "2017-03-02T20:51:03Z"
  },
  "references": [
    {
      "url": "http://seclists.org/fulldisclosure/2017/Apr/40",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/e107inc/e107/commit/7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2017/Apr/40",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/e107inc/e107/commit/7a3e3d9fc7e05ce6941b9af1c14010bf2141f1a5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.873796",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "e107",
    "owner": "e107inc",
    "created_at": "2012-11-16T19:49:01Z",
    "updated_at": "2025-01-13T23:35:38Z",
    "pushed_at": "2025-01-13T23:35:33Z",
    "size": 93949,
    "stars": 324,
    "forks": 213,
    "open_issues": 662,
    "watchers": 324,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 10485316,
      "JavaScript": 1136648,
      "CSS": 973571,
      "HTML": 20946,
      "Scala": 20715,
      "Clojure": 14453,
      "SaltStack": 3602,
      "SuperCollider": 3212,
      "Go": 1300,
      "BlitzBasic": 161
    },
    "commit_activity": {
      "total_commits_last_year": 110,
      "avg_commits_per_week": 2.1153846153846154,
      "days_active_last_year": 44
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:12:18.206807"
  }
}