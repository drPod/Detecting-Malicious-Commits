{
  "cve_id": "CVE-2017-8284",
  "github_data": {
    "repository": "qemu/qemu",
    "fix_commit": "30663fd26c0307e414622c7a8607fbc04f92ec14",
    "related_commits": [
      "30663fd26c0307e414622c7a8607fbc04f92ec14",
      "30663fd26c0307e414622c7a8607fbc04f92ec14"
    ],
    "patch_url": "https://github.com/qemu/qemu/commit/30663fd26c0307e414622c7a8607fbc04f92ec14.patch",
    "fix_commit_details": {
      "sha": "30663fd26c0307e414622c7a8607fbc04f92ec14",
      "commit_date": "2017-03-23T17:58:51Z",
      "author": {
        "login": "pranith",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "tcg/i386: Check the size of instruction being translated",
        "length": 569,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
      },
      "files": [
        {
          "filename": "target/i386/translate.c",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -4418,6 +4418,13 @@ static target_ulong disas_insn(CPUX86State *env, DisasContext *s,\n     s->vex_l = 0;\n     s->vex_v = 0;\n  next_byte:\n+    /* x86 has an upper limit of 15 bytes for an instruction. Since we\n+     * do not want to decode and generate IR for an illegal\n+     * instruction, the following check limits the instruction size to\n+     * 25 bytes: 14 prefix + 1 opc + 6 (modrm+sib+ofs) + 4 imm */\n+    if (s->pc - pc_start > 14) {\n+        goto illegal_op;\n+    }\n     b = cpu_ldub_code(env, s->pc);\n     s->pc++;\n     /* Collect prefixes.  */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e8aa7fdcddfc8589bdc7c973a052e76e8f999455",
            "date": "2025-01-13T14:43:48Z",
            "author_login": "stefanhaRH"
          },
          {
            "sha": "435d260e7ec5ff9c79e3e62f1d66ec82d2d691ae",
            "date": "2025-01-13T12:35:35Z",
            "author_login": "pbo-linaro"
          },
          {
            "sha": "132f8ec799cea261ad6b60ac8ae86f17cc98b9a1",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pbo-linaro"
          },
          {
            "sha": "39d70016d9abe15967f7051741dd5621c659b1f4",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pm215"
          },
          {
            "sha": "86a00f2046f5f5b613bdf18d6c972b495a907c37",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pbo-linaro"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-94",
    "description": "The disas_insn function in target/i386/translate.c in QEMU before 2.9.0, when TCG mode without hardware acceleration is used, does not limit the instruction size, which allows local users to gain privileges by creating a modified basic block that injects code into a setuid program, as demonstrated by procmail. NOTE: the vendor has stated \"this bug does not violate any security guarantees QEMU makes.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-04-26T14:59:00.270",
    "last_modified": "2024-11-21T03:33:41.913",
    "fix_date": "2017-03-23T17:58:51Z"
  },
  "references": [
    {
      "url": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1122",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qemu/qemu/commit/30663fd26c0307e414622c7a8607fbc04f92ec14",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.chromium.org/p/project-zero/issues/detail?id=1122",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qemu/qemu/commit/30663fd26c0307e414622c7a8607fbc04f92ec14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:58:54.876143",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qemu",
    "owner": "qemu",
    "created_at": "2012-08-11T21:48:37Z",
    "updated_at": "2025-01-14T15:30:43Z",
    "pushed_at": "2025-01-13T16:01:34Z",
    "size": 597325,
    "stars": 10728,
    "forks": 5703,
    "open_issues": 0,
    "watchers": 10728,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 72752071,
      "C++": 10865548,
      "Python": 3771166,
      "Shell": 1394621,
      "Assembly": 661208,
      "Meson": 485678,
      "Haxe": 351509,
      "Perl": 223220,
      "Rust": 153760,
      "Objective-C": 153251,
      "Makefile": 107378,
      "Pawn": 50592,
      "SmPL": 33510,
      "Yacc": 29612,
      "Lex": 23760,
      "NSIS": 6939,
      "DenizenScript": 2931,
      "Dockerfile": 1012,
      "GLSL": 585,
      "GDB": 326,
      "Vim Script": 220,
      "Emacs Lisp": 75
    },
    "commit_activity": {
      "total_commits_last_year": 6588,
      "avg_commits_per_week": 126.6923076923077,
      "days_active_last_year": 335
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:49:13.645950"
  }
}