{
  "cve_id": "CVE-2017-9434",
  "github_data": {
    "repository": "weidai11/cryptopp",
    "fix_commit": "07dbcc3d9644b18e05c1776db2a57fe04d780965",
    "related_commits": [
      "07dbcc3d9644b18e05c1776db2a57fe04d780965",
      "07dbcc3d9644b18e05c1776db2a57fe04d780965"
    ],
    "patch_url": "https://github.com/weidai11/cryptopp/commit/07dbcc3d9644b18e05c1776db2a57fe04d780965.patch",
    "fix_commit_details": {
      "sha": "07dbcc3d9644b18e05c1776db2a57fe04d780965",
      "commit_date": "2017-05-10T22:17:12Z",
      "author": {
        "login": "noloader",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add Inflator::BadDistanceErr exception (Issue 414)",
        "length": 159,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 14,
        "deletions": 4
      },
      "files": [
        {
          "filename": "validat1.cpp",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -623,7 +623,7 @@ bool TestRandomPool()\n \t\t\tstd::cout << \"FAILED:\";\r\n \t\telse\r\n \t\t\tstd::cout << \"passed:\";\r\n-\t\tstd::cout << \"  GenerateWord32 and Crop\\n\";\t\r\n+\t\tstd::cout << \"  GenerateWord32 and Crop\\n\";\r\n \t}\r\n \r\n #if !defined(NO_OS_DEPENDENCE)\r\n@@ -711,7 +711,7 @@ bool TestRandomPool()\n \t\t\tstd::cout << \"FAILED:\";\r\n \t\telse\r\n \t\t\tstd::cout << \"passed:\";\r\n-\t\tstd::cout << \"  GenerateWord32 and Crop\\n\";\t\r\n+\t\tstd::cout << \"  GenerateWord32 and Crop\\n\";\r\n \t}\r\n #endif\r\n \r\n@@ -808,7 +808,7 @@ bool TestAutoSeededX917()\n \t\tstd::cout << \"FAILED:\";\r\n \telse\r\n \t\tstd::cout << \"passed:\";\r\n-\tstd::cout << \"  GenerateWord32 and Crop\\n\";\t\r\n+\tstd::cout << \"  GenerateWord32 and Crop\\n\";\r\n \r\n \tstd::cout.flush();\r\n \treturn pass;\r"
        },
        {
          "filename": "zinflate.cpp",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -552,12 +552,18 @@ bool Inflator::DecodeBody()\n \t\tcase DISTANCE_BITS:\r\n \t\t\t\t\t// TODO: this surfaced during fuzzing. What do we do???\r\n \t\t\t\t\tCRYPTOPP_ASSERT(m_distance < COUNTOF(distanceExtraBits));\r\n-\t\t\t\t\tbits = (m_distance >= COUNTOF(distanceExtraBits)) ? distanceExtraBits[29] : distanceExtraBits[m_distance];\r\n+\t\t\t\t\tif (m_distance >= COUNTOF(distanceExtraBits))\r\n+\t\t\t\t\t\tthrow BadDistanceErr();\r\n+\t\t\t\t\tbits = distanceExtraBits[m_distance];\r\n \t\t\t\t\tif (!m_reader.FillBuffer(bits))\r\n \t\t\t\t\t{\r\n \t\t\t\t\t\tm_nextDecode = DISTANCE_BITS;\r\n \t\t\t\t\t\tbreak;\r\n \t\t\t\t\t}\r\n+\t\t\t\t\t// TODO: this surfaced during fuzzing. What do we do???\r\n+\t\t\t\t\tCRYPTOPP_ASSERT(m_distance < COUNTOF(distanceStarts));\r\n+\t\t\t\t\tif (m_distance >= COUNTOF(distanceStarts))\r\n+\t\t\t\t\t\tthrow BadDistanceErr();\r\n \t\t\t\t\tm_distance = m_reader.GetBits(bits) + distanceStarts[m_distance];\r\n \t\t\t\t\tOutputPast(m_literal, m_distance);\r\n \t\t\t\t}\r"
        },
        {
          "filename": "zinflate.h",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -98,8 +98,12 @@ class Inflator : public AutoSignaling<Filter>\n \t\tErr(ErrorType e, const std::string &s)\r\n \t\t\t: Exception(e, s) {}\r\n \t};\r\n+\t//! \\brief Exception thrown when a truncated stream is encountered\r\n \tclass UnexpectedEndErr : public Err {public: UnexpectedEndErr() : Err(INVALID_DATA_FORMAT, \"Inflator: unexpected end of compressed block\") {}};\r\n+\t//! \\brief Exception thrown when a bad block is encountered\r\n \tclass BadBlockErr : public Err {public: BadBlockErr() : Err(INVALID_DATA_FORMAT, \"Inflator: error in compressed block\") {}};\r\n+\t//! \\brief Exception thrown when an invalid distance is encountered\r\n+\tclass BadDistanceErr : public Err {public: BadDistanceErr() : Err(INVALID_DATA_FORMAT, \"Inflator: error in bit distance\") {}};\r\n \r\n \t//! \\brief RFC 1951 Decompressor\r\n \t//! \\param attachment the filter's attached transformation\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "60f81a77e0c9a0e7ffc1ca1bc438ddfa2e43b78e",
            "date": "2024-06-23T15:59:34Z",
            "author_login": "noloader"
          },
          {
            "sha": "9aa07aebbdc62461c3ac32f958d7c3ab89ff6f73",
            "date": "2024-06-10T14:27:30Z",
            "author_login": "noloader"
          },
          {
            "sha": "9bb6680cfaedd3d46eff082ede8d0c76be6a2145",
            "date": "2024-04-25T05:33:44Z",
            "author_login": "noloader"
          },
          {
            "sha": "c2bd7efb49610c97cbd2e2258654bd51f741112d",
            "date": "2024-04-23T14:04:07Z",
            "author_login": "xiaoxianBoy"
          },
          {
            "sha": "782057f5f18fbdad2bd2b291fb1ec558a8ab8225",
            "date": "2024-02-07T05:03:38Z",
            "author_login": "noloader"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "Crypto++ (aka cryptopp) through 5.6.5 contains an out-of-bounds read vulnerability in zinflate.cpp in the Inflator filter.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-06-05T14:29:00.653",
    "last_modified": "2024-11-21T03:36:07.047",
    "fix_date": "2017-05-10T22:17:12Z"
  },
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/06/06/2",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/99007",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/weidai11/cryptopp/commit/07dbcc3d9644b18e05c1776db2a57fe04d780965",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/weidai11/cryptopp/issues/414",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7IL5A6465IEPW5GAWGXB2ENJPFYVWTJM/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://openwall.com/lists/oss-security/2017/06/06/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/99007",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/weidai11/cryptopp/commit/07dbcc3d9644b18e05c1776db2a57fe04d780965",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/weidai11/cryptopp/issues/414",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7IL5A6465IEPW5GAWGXB2ENJPFYVWTJM/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:01.647396",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cryptopp",
    "owner": "weidai11",
    "created_at": "2015-06-03T21:53:52Z",
    "updated_at": "2025-01-14T07:33:53Z",
    "pushed_at": "2024-08-01T06:15:57Z",
    "size": 28432,
    "stars": 4972,
    "forks": 1521,
    "open_issues": 63,
    "watchers": 4972,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 5721263,
      "Shell": 457646,
      "C": 452544,
      "Assembly": 263481,
      "Makefile": 62312,
      "Batchfile": 728
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:43:47.328150"
  }
}