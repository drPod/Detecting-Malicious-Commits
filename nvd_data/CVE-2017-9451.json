{
  "cve_id": "CVE-2017-9451",
  "github_data": {
    "repository": "flatCore/flatCore-CMS",
    "fix_commit": "f1b42b338693a9c240182e76ef2131057f2c2a87",
    "related_commits": [
      "f1b42b338693a9c240182e76ef2131057f2c2a87",
      "f1b42b338693a9c240182e76ef2131057f2c2a87"
    ],
    "patch_url": "https://github.com/flatCore/flatCore-CMS/commit/f1b42b338693a9c240182e76ef2131057f2c2a87.patch",
    "fix_commit_details": {
      "sha": "f1b42b338693a9c240182e76ef2131057f2c2a87",
      "commit_date": "2017-06-07T07:11:36Z",
      "author": {
        "login": "patkon",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Prevent XSS Vulnerability",
        "length": 97,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 125,
        "additions": 61,
        "deletions": 64
      },
      "files": [
        {
          "filename": "acp/core/dashboard.system.php",
          "status": "modified",
          "additions": 33,
          "deletions": 26,
          "patch": "@@ -3,85 +3,92 @@\n //prohibit unauthorized access\n require 'core/access.php';\n \n-echo '<h3>System</h3>';\n+\n+echo '<hr class=\"shadow\" style=\"margin-top:0;\">';\n \n echo '<div class=\"row\">';\n \n echo '<div class=\"col-md-4\">';\n-echo '<h5>Config</h5>';\n-echo '<dl class=\"dl-horizontal\">';\n-echo '<dt>Server:</dt><dd>' . $_SERVER['SERVER_NAME'] . ' (PHP '.phpversion().')</dd>';\n+\n+echo '<div class=\"panel panel-default\">';\n+\n+echo '<div class=\"panel-heading\">Config</div>';\n+echo '<table class=\"table table-condensed\">';\n+echo '<tr><td>Server:</td><td>' . $_SERVER['SERVER_NAME'] . ' (PHP '.phpversion().')</td></tr>';\n if($prefs_mailer_adr != '') {\n-\techo '<dt>System E-Mails:</dt><dd>' . $prefs_mailer_adr . '</dd>';\n+\techo '<tr><td>System E-Mails:</td><td>' . $prefs_mailer_adr . '</td></tr>';\n } else {\n-\techo '<dt>System E-Mails:</dt><dd><span class=\"text-danger\">'.$lang['missing_value'].'</span></dd>';\n+\techo '<tr><td>System E-Mails:</td><td><span class=\"text-danger\">'.$lang['missing_value'].'</span></td></tr>';\n }\n if($prefs_mailer_name != '') {\n-\techo '<dt>E-Mail Name:</dt><dd>' . $prefs_mailer_name . '</dd>';\n+\techo '<tr><td>E-Mail Name:</td><td>' . $prefs_mailer_name . '</td></tr>';\n } else {\n-\techo '<dt>E-Mail Name:</dt><dd><span class=\"text-danger\">'.$lang['missing_value'].'</span></dd>';\n+\techo '<tr><td>E-Mail Name:</td><td><span class=\"text-danger\">'.$lang['missing_value'].'</span></td></tr>';\n }\n-echo '</dl>';\n-\n+echo '</table>';\n \n-echo '<hr>';\n+echo '</div>';\n \n-echo '<h4>' . $lang['f_user_drm'] . '</h4>';\n \n+echo '<div class=\"panel panel-default\">';\n+echo '<div class=\"panel-heading\">' . $lang['f_user_drm'] . '</div>';\n+echo '<div class=\"panel-body\">';\n \n echo\"<p><span class='glyphicon glyphicon-user'></span> $_SESSION[user_firstname] $_SESSION[user_lastname] ($_SESSION[user_nick])</p>\";\n \n $list_str = '<ul class=\"list-unstyled\" style=\"padding-left:16px;\">';\n \n if($_SESSION['acp_pages'] == \"allowed\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_pages]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_pages'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_pages]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_pages'].'</li>';\n }\n \n if($_SESSION['acp_editpages'] == \"allowed\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_editpages]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_editpages'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_editpages]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_editpages'].'</li>';\n }\n \n if($_SESSION['acp_editownpages'] == \"allowed\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_editownpages]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_editownpages'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_editownpages]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_editownpages'].'</li>';\n }\n \n if($_SESSION['acp_files'] == \"allowed\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_files]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_files'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_files]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_files'].'</li>';\n }\n \n if($_SESSION['acp_user'] == \"allowed\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_user]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_user'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_files]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_user'].'</li>';\n }\n \n if($_SESSION['acp_system'] == \"allowed\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_system]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_system'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_files]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_files'].'</li>';\n }\n \n if($_SESSION['drm_can_publish'] == \"true\") {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-ok-circle'></span> $lang[drm_user_can_publish]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-ok-circle text-success\"></span> '. $lang['drm_user_can_publish'].'</li>';\n } else {\n-\t$list_str .= \"<li><span class='glyphicon glyphicon-remove-circle'></span> $lang[drm_user_can_publish]</li>\";\n+\t$list_str .= '<li><span class=\"glyphicon glyphicon-remove-circle text-danger\"></span> '. $lang['drm_user_can_publish'].'</li>';\n }\n \n \n $list_str .= \"</ul>\";\n \n echo $list_str;\n \n+echo '</div>';\n \n echo '</div>';\n+echo '</div>';\n \n \n echo '<div class=\"col-md-8\">';"
        },
        {
          "filename": "acp/core/list.themes.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -47,7 +47,7 @@\n \tprint_sysmsg(\"$sys_message\");\n }\n \n-echo '<form action=\"'.$_SERVER['PHP_SELF'].'?tn=moduls&sub=t\" method=\"POST\" class=\"form-horizontal\">';\n+echo '<form action=\"acp.php?tn=moduls&sub=t\" method=\"POST\" class=\"form-horizontal\">';\n echo '<fieldset>';\n echo '<legend>'.$lang['f_prefs_layout'].'</legend>';\n "
        },
        {
          "filename": "acp/core/pages.edit_form.php",
          "status": "modified",
          "additions": 22,
          "deletions": 32,
          "patch": "@@ -3,7 +3,7 @@\n require 'core/access.php';\n \n \n-echo\"\\n <form id='editpage' action='$_SERVER[PHP_SELF]?tn=pages&sub=edit&editpage=$editpage' class='form-horizontal' method='POST'>\\n\";\n+echo '<form id=\"editpage\" action=\"acp.php?tn=pages&sub=edit&editpage='.$editpage.'\" class=\"form-horizontal\" method=\"POST\">';\n \n $custom_fields = get_custom_fields();\n sort($custom_fields);\n@@ -135,11 +135,11 @@\n \n echo tpl_form_control_group('',$lang['f_page_redirect'],'<div class=\"row\"><div class=\"col-md-3\">'.$select_page_redirect_code.'</div><div class=\"col-md-9\"><input class=\"form-control\" type=\"text\" name=\"page_redirect\" value=\"'.$page_redirect.'\"></div></div>');\n \n-echo'</div>'; /* EOL tab_info */\n+echo '</div>'; /* EOL tab_info */\n \n \n /* tab_content */\n-echo'<div class=\"tab-pane fade\" id=\"content\">';\n+echo '<div class=\"tab-pane fade\" id=\"content\">';\n \n echo '<textarea name=\"page_content\" class=\"form-control mceEditor textEditor switchEditor\" id=\"textEditor\">'.$page_content.'</textarea>';\n \n@@ -149,16 +149,16 @@\n \n /* tab_extracontent */\n \n-echo'<div class=\"tab-pane fade\" id=\"extracontent\">';\n+echo '<div class=\"tab-pane fade\" id=\"extracontent\">';\n \n echo '<textarea name=\"page_extracontent\" class=\"form-control mceEditor textEditor switchEditor\" id=\"textEditor2\">'.$page_extracontent.'</textarea>';\n \n-echo\"</div>\"; /* EOL tab_extracontent */\n+echo '</div>'; /* EOL tab_extracontent */\n \n \n \n /* tab_meta */\n-echo'<div class=\"tab-pane fade\" id=\"meta\">';\n+echo '<div class=\"tab-pane fade\" id=\"meta\">';\n \n echo tpl_form_control_group('',$lang['f_page_title'],'<input class=\"form-control\" type=\"text\" name=\"page_title\" value=\"'.$page_title.'\">');\n \n@@ -171,13 +171,13 @@\n echo tpl_form_control_group('',$lang['f_meta_description'],\"<textarea name='page_meta_description' class='form-control cntValues' rows='5'>$page_meta_description</textarea>\");\n \n \n-echo\"<div class='form-group'>\n-\t\t<label class='control-label control-label-normal col-sm-2'>$lang[page_thumbnail]</label>\n-\t\t<div class='col-sm-10'>\";\n+echo '<div class=\"form-group\">';\n+echo '<label class=\"control-label control-label-normal col-sm-2\">'.$lang['page_thumbnail'].'</label>';\n+echo '<div class=\"col-sm-10\">';\n \t\t\n echo '<div class=\"scroll-container\">';\n echo '<select name=\"page_thumbnail\" class=\"form-control image-picker\">';\n-echo \"<option value=''>$lang[page_thumbnail]</option>\";\n+echo '<option value=\"\">'.$lang['page_thumbnail'].'</option>';\n $arr_Images = get_all_images();\n \tforeach($arr_Images as $page_thumbnails) {\n \t\t$selected = \"\";\n@@ -186,24 +186,14 @@\n \t\t}\n \t\techo '<option '.$selected.' data-img-src=\"/content/images/'.$page_thumbnails.'\" class=\"masonry-item\" value=\"'.$page_thumbnails.'\">'.$page_thumbnails.'</option>';\n }\n-echo\"</select>\";\n+echo '</select>';\n+echo '</div>';\n+echo '</div>';\n echo '</div>';\n-echo\"</div>\n-\t </div>\";\n-\n-echo\"</fieldset>\";\n-\n \n-foreach($arr_Images as $page_thumbnails) {\n-\t\t$selected = \"\";\n-\t\tif($page_thumbnail == \"$page_thumbnails\") {\n-\t\t\t$selected = \"selected\";\n-\t\t}\n-\t\techo \"<option $selected data-img-src='/content/iamages/$page_thumbnails' value='$page_thumbnails'>$page_thumbnails</option>\";\n-}\n+echo '</fieldset>';\n \n \n-\t\t\n $select_page_meta_robots  = '<select name=\"page_meta_robots\" class=\"form-control\">';\n $select_page_meta_robots .= '<option value=\"all\" '.($page_meta_robots == \"all\" ? 'selected=\"selected\"' :'').'>all</option>';\n $select_page_meta_robots .= '<option value=\"noindex\" '.($page_meta_robots == \"noindex\" ? 'selected=\"selected\"' :'').'>noindex</option>';\n@@ -215,33 +205,33 @@\n \n \n \n-echo'</div>'; /* EOL tab_meta */\n+echo '</div>'; /* EOL tab_meta */\n \n \n \n /* tab_head */\n-echo'<div class=\"tab-pane fade\" id=\"head\">';\n+echo '<div class=\"tab-pane fade\" id=\"head\">';\n \n echo $lang['f_head_styles'];\n echo '<span class=\"silent\"> &lt;style type=&quot;text/css&quot;&gt;</span> ... <span class=\"silent\">&lt;/styles&gt;</span>';\n-echo \"<textarea name='page_head_styles' class='form-control aceEditor_css' rows='12'>$page_head_styles</textarea>\";\n+echo '<textarea name=\"page_head_styles\" class=\"form-control aceEditor_css\" rows=\"12\">'.$page_head_styles.'</textarea>';\n echo '<div id=\"CSSeditor\"></div>';\n \n echo '<hr>';\n \n echo $lang['f_head_enhanced'];\n echo '<span class=\"silent\"> &lt;head&gt;</span> ... <span class=\"silent\">&lt;/head&gt;</span>';\n-echo \"<textarea name='page_head_enhanced' class='form-control aceEditor_html' rows='12'>$page_head_enhanced</textarea>\";\n+echo '<textarea name=\"page_head_enhanced\" class=\"form-control aceEditor_html\" rows=\"12\">'.$page_head_enhanced.'</textarea>';\n echo '<div id=\"HTMLeditor\"></div>';\n \n-echo'</div>'; /* EOL tab_head */\n+echo '</div>'; /* EOL tab_head */\n \n \n \n if($cnt_custom_fields > 0) {\n \n /* tab custom fields */\n-echo'<div class=\"tab-pane fade\" id=\"custom\">';\n+echo '<div class=\"tab-pane fade\" id=\"custom\">';\n \n \tfor($i=0;$i<$cnt_custom_fields;$i++) {\n \t\t\n@@ -259,11 +249,11 @@\n \t\t}\t\t\n \t}\n \n-echo'</div>'; /* EOL tab custom fields */\n+echo '</div>'; /* EOL tab custom fields */\n \n }\n \n-echo\"</div>\"; // EOL fancytabs\n+echo '</div>'; // EOL fancytabs\n \n echo '</div>';\n echo '<div class=\"col-lg-3 col-md-4 col-sm-12\">';"
        },
        {
          "filename": "acp/core/pages.snippets.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -182,7 +182,7 @@\n echo '</div>';\n echo '<div class=\"col-md-9\">';\n \n-echo \"<form action='$_SERVER[PHP_SELF]?tn=pages&sub=snippets' method='POST'>\";\n+echo \"<form action='acp.php?tn=pages&sub=snippets' method='POST'>\";\n \n \n "
        },
        {
          "filename": "acp/core/system.stats.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -45,7 +45,7 @@\n \n echo\"<fieldset>\";\n echo\"<legend>$lang[select_logfile]</legend>\";\n-echo\"<form action='$_SERVER[PHP_SELF]?tn=system&sub=stats' method='POST' class='form-inline'>\";\n+echo\"<form action='acp.php?tn=system&sub=stats' method='POST' class='form-inline'>\";\n echo '<div class=\"form-group\">';\n echo\"<select name='select_logfile' class='form-control'>\";\n "
        },
        {
          "filename": "acp/core/user.groups.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -161,7 +161,7 @@\n \n echo '<fieldset>';\n echo '<legend>'.$lang['legend_choose_group'].'</legend>';\n-echo '<form action=\"'.$_SERVER['PHP_SELF'].'?tn=user&sub=groups\" method=\"POST\">';\n+echo '<form action=\"acp.php?tn=user&sub=groups\" method=\"POST\">';\n \n echo '<div class=\"row\">';\n echo '<div class=\"col-md-5\">';\n@@ -231,7 +231,7 @@\n echo '<fieldset>';\n echo '<legend>'.$lang['legend_groups_data'].'</legend>';\n \n-echo '<form action=\"'.$_SERVER[PHP_SELF].'?tn=user&sub=groups\" method=\"POST\">';\n+echo '<form action=\"acp.php?tn=user&sub=groups\" method=\"POST\">';\n \n echo '<div class=\"row\">';\n echo '<div class=\"col-md-8\">';"
        },
        {
          "filename": "acp/core/user.list.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -196,7 +196,7 @@\n \n echo '<div class=\"row\">';\n echo '<div class=\"col-md-5\">';\n-echo \"<form action='$_SERVER[PHP_SELF]?tn=user' class='form-inline' method='POST'>\";\n+echo \"<form action='acp.php?tn=user' class='form-inline' method='POST'>\";\n \n echo '<div class=\"input-group\">';\n echo '<span class=\"input-group-addon\"><span class=\"glyphicon glyphicon-filter\"></span></span>';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9dcc9be2b8857eebe8449f6d387e47386d02dccf",
            "date": "2022-12-20T06:15:17Z",
            "author_login": "patkon"
          },
          {
            "sha": "4586fab8a176864daef748fac975775dcdbb80c3",
            "date": "2022-12-20T06:13:23Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e89e55f319692fb112bacbe6846d25197dee4f9e",
            "date": "2022-12-20T06:12:48Z",
            "author_login": "patkon"
          },
          {
            "sha": "6839e4a978135c8a225f73a53703c9319ddcb655",
            "date": "2022-12-09T00:43:32Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e517fc03ab5ae212859efb20c6c94a12d2db623b",
            "date": "2022-06-15T19:07:22Z",
            "author_login": "patkon"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross site scripting (XSS) vulnerability in pages.edit_form.php in flatCore 1.4.6 allows remote attackers to inject arbitrary JavaScript via the PATH_INFO in an acp.php URL, due to use of unsanitized $_SERVER['PHP_SELF'] to generate URLs.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2017-06-06T16:29:00.267",
    "last_modified": "2024-11-21T03:36:09.727",
    "fix_date": "2017-06-07T07:11:36Z"
  },
  "references": [
    {
      "url": "https://github.com/flatCore/flatCore-CMS/commit/f1b42b338693a9c240182e76ef2131057f2c2a87",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/flatCore/flatCore-CMS/issues/34",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flatCore/flatCore-CMS/commit/f1b42b338693a9c240182e76ef2131057f2c2a87",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/flatCore/flatCore-CMS/issues/34",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:01.649076",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "flatCore-CMS",
    "owner": "flatCore",
    "created_at": "2012-12-01T20:42:10Z",
    "updated_at": "2024-01-02T23:38:36Z",
    "pushed_at": "2022-12-20T06:15:26Z",
    "size": 22030,
    "stars": 50,
    "forks": 16,
    "open_issues": 0,
    "watchers": 50,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 5571192,
      "PHP": 2515682,
      "CSS": 1676163,
      "HTML": 161004,
      "Smarty": 109909,
      "SCSS": 48151
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:03:12.765465"
  }
}