{
  "cve_id": "CVE-2018-1000079",
  "github_data": {
    "repository": "rubygems/rubygems",
    "fix_commit": "666ef793cad42eed96f7aee1cdf77865db921099",
    "related_commits": [
      "666ef793cad42eed96f7aee1cdf77865db921099",
      "f83f911e19e27cbac1ccce7471d96642241dd759",
      "666ef793cad42eed96f7aee1cdf77865db921099",
      "f83f911e19e27cbac1ccce7471d96642241dd759"
    ],
    "patch_url": "https://github.com/rubygems/rubygems/commit/666ef793cad42eed96f7aee1cdf77865db921099.patch",
    "fix_commit_details": {
      "sha": "666ef793cad42eed96f7aee1cdf77865db921099",
      "commit_date": "2018-02-12T05:44:58Z",
      "author": {
        "login": "segiddins",
        "type": "User",
        "stats": {
          "total_commits": 1768,
          "average_weekly_commits": 1.546806649168854,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 229
        }
      },
      "commit_message": {
        "title": "Implement a safe mkdir for package that verifies were inside the destination dir for all new directories ccreated",
        "length": 113,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 35,
        "additions": 29,
        "deletions": 6
      },
      "files": [
        {
          "filename": "lib/rubygems/package.rb",
          "status": "modified",
          "additions": 28,
          "deletions": 5,
          "patch": "@@ -378,7 +378,7 @@ def extract_tar_gz io, destination_dir, pattern = \"*\" # :nodoc:\n             File.dirname destination\n           end\n \n-        FileUtils.mkdir_p mkdir, mkdir_options\n+        mkdir_p_safe mkdir, mkdir_options, destination_dir, entry.full_name\n \n         File.open destination, 'wb' do |out|\n           out.write entry.read\n@@ -416,13 +416,10 @@ def install_location filename, destination_dir # :nodoc:\n     raise Gem::Package::PathError.new(filename, destination_dir) if\n       filename.start_with? '/'\n \n-    destination_dir = File.realpath destination_dir if\n-      File.respond_to? :realpath\n+    destination_dir = realpath destination_dir\n     destination_dir = File.expand_path destination_dir\n \n     destination = File.join destination_dir, filename\n-    destination = File.realpath destination if\n-      File.respond_to? :realpath\n     destination = File.expand_path destination\n \n     raise Gem::Package::PathError.new(destination, destination_dir) unless\n@@ -432,6 +429,22 @@ def install_location filename, destination_dir # :nodoc:\n     destination\n   end\n \n+  def mkdir_p_safe mkdir, mkdir_options, destination_dir, file_name\n+    destination_dir = realpath File.expand_path(destination_dir)\n+    parts = mkdir.split(File::SEPARATOR)\n+    parts.reduce do |path, basename|\n+      path = realpath path  unless path == \"\"\n+      path = File.expand_path(path + File::SEPARATOR + basename)\n+      lstat = File.lstat path rescue nil\n+      if !lstat || !lstat.directory?\n+        unless path.start_with? destination_dir and (FileUtils.mkdir path, mkdir_options rescue false)\n+          raise Gem::Package::PathError.new(file_name, destination_dir)\n+        end\n+      end\n+      path\n+    end\n+  end\n+\n   ##\n   # Loads a Gem::Specification from the TarEntry +entry+\n \n@@ -622,6 +635,16 @@ def verify_gz entry # :nodoc:\n     raise Gem::Package::FormatError.new(e.message, entry.full_name)\n   end\n \n+  if File.respond_to? :realpath\n+    def realpath file\n+      File.realpath file\n+    end\n+  else\n+    def realpath file\n+      file\n+    end\n+  end\n+\n end\n \n require 'rubygems/package/digest_io'"
        },
        {
          "filename": "test/rubygems/test_gem_package.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -476,7 +476,7 @@ def test_extract_symlink_parent\n      package.extract_tar_gz tgz_io, destination_subdir\n    end\n \n-   assert_equal(\"installing into parent path ../outside.txt of \" +\n+   assert_equal(\"installing into parent path lib/link/outside.txt of \" +\n                  \"#{destination_subdir} is not allowed\", e.message)\n   end\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4f0365f22d4201eba4ffeece1fbee61e0f11a7ea",
            "date": "2025-01-13T22:48:04Z",
            "author_login": "hsbt"
          },
          {
            "sha": "f2d927807f50c25a285085fc4e1005cb290253dc",
            "date": "2025-01-13T22:47:53Z",
            "author_login": "hsbt"
          },
          {
            "sha": "437821ed897d34a2d7001079bc5e5e10bafe32ab",
            "date": "2025-01-13T17:41:01Z",
            "author_login": "simi"
          },
          {
            "sha": "85156ce286e282ca977e6c290f67c48f36f4c918",
            "date": "2025-01-13T16:05:34Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "091f704d0d21faf12cee27398921087bd4f91a5d",
            "date": "2025-01-13T15:48:07Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "RubyGems version Ruby 2.2 series: 2.2.9 and earlier, Ruby 2.3 series: 2.3.6 and earlier, Ruby 2.4 series: 2.4.3 and earlier, Ruby 2.5 series: 2.5.0 and earlier, prior to trunk revision 62422 contains a Directory Traversal vulnerability in gem installation that can result in the gem could write to arbitrary filesystem locations during installation. This attack appear to be exploitable via the victim must install a malicious gem. This vulnerability appears to have been fixed in 2.7.6.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-13T15:29:00.783",
    "last_modified": "2024-11-21T03:39:35.650",
    "fix_date": "2018-02-12T05:44:58Z"
  },
  "references": [
    {
      "url": "http://blog.rubygems.org/2018/02/15/2.7.6-released.html",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00036.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3729",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3730",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3731",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2028",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0542",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0591",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0663",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/rubygems/rubygems/commit/666ef793cad42eed96f7aee1cdf77865db921099",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rubygems/rubygems/commit/f83f911e19e27cbac1ccce7471d96642241dd759",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3621-1/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4219",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4259",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://blog.rubygems.org/2018/02/15/2.7.6-released.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00036.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3729",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3730",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3731",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2028",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0542",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0591",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0663",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/rubygems/rubygems/commit/666ef793cad42eed96f7aee1cdf77865db921099",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rubygems/rubygems/commit/f83f911e19e27cbac1ccce7471d96642241dd759",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3621-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4219",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4259",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.556426",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rubygems",
    "owner": "rubygems",
    "created_at": "2010-04-16T19:02:44Z",
    "updated_at": "2025-01-13T22:48:08Z",
    "pushed_at": "2025-01-14T06:42:36Z",
    "size": 201459,
    "stars": 3719,
    "forks": 1762,
    "open_issues": 256,
    "watchers": 3719,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.3.7.1",
      "1.4",
      "1.5.2",
      "1.6",
      "1.7",
      "1.8",
      "1.8.23",
      "2.0",
      "2.1",
      "2.2",
      "2.4",
      "2.5",
      "2.6",
      "2.7",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "3.4",
      "3.5",
      "3.6"
    ],
    "languages": {
      "Ruby": 4699637,
      "Roff": 129542,
      "Rust": 2535,
      "Shell": 2364,
      "Dockerfile": 636,
      "Batchfile": 37
    },
    "commit_activity": {
      "total_commits_last_year": 1591,
      "avg_commits_per_week": 30.596153846153847,
      "days_active_last_year": 259
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:02:08.526245"
  }
}