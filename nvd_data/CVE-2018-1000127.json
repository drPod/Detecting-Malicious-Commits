{
  "cve_id": "CVE-2018-1000127",
  "github_data": {
    "repository": "memcached/memcached",
    "fix_commit": "a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00",
    "related_commits": [
      "a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00",
      "a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00"
    ],
    "patch_url": "https://github.com/memcached/memcached/commit/a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00.patch",
    "fix_commit_details": {
      "sha": "a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00",
      "commit_date": "2017-05-22T04:49:54Z",
      "author": {
        "login": "dormando",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Don't overflow item refcount on get",
        "length": 384,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
      },
      "files": [
        {
          "filename": "memcached.c",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -3249,6 +3249,16 @@ static inline int make_ascii_get_suffix(char *suffix, item *it, bool return_cas)\n     return (p - suffix) + 2;\n }\n \n+#define IT_REFCOUNT_LIMIT 60000\n+static inline item* limited_get(char *key, size_t nkey, conn *c) {\n+    item *it = item_get(key, nkey, c, DO_UPDATE);\n+    if (it && it->refcount > IT_REFCOUNT_LIMIT) {\n+        item_remove(it);\n+        it = NULL;\n+    }\n+    return it;\n+}\n+\n /* ntokens is overwritten here... shrug.. */\n static inline void process_get_command(conn *c, token_t *tokens, size_t ntokens, bool return_cas) {\n     char *key;\n@@ -3273,7 +3283,7 @@ static inline void process_get_command(conn *c, token_t *tokens, size_t ntokens,\n                 return;\n             }\n \n-            it = item_get(key, nkey, c, DO_UPDATE);\n+            it = limited_get(key, nkey, c);\n             if (settings.detail_enabled) {\n                 stats_prefix_record_get(key, nkey, NULL != it);\n             }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7d6bc7b09e3c6bb8eaff8b2b3d78d01e0bf17f6f",
            "date": "2024-12-23T00:57:30Z",
            "author_login": "dormando"
          },
          {
            "sha": "dc68c54c84b8302995ef33facd6ffdfe2865ed08",
            "date": "2024-12-22T23:40:51Z",
            "author_login": "dormando"
          },
          {
            "sha": "550b0fa0bdbca40ceca8a40d7c423a207ed7875c",
            "date": "2024-12-22T23:33:32Z",
            "author_login": "dormando"
          },
          {
            "sha": "f392de251b5974fb3e6b80956b289984b99c4c63",
            "date": "2024-12-22T23:24:49Z",
            "author_login": "dormando"
          },
          {
            "sha": "c360ce8693a610f4e37a23fd8091ce0d08ba4119",
            "date": "2024-12-20T19:37:26Z",
            "author_login": "dormando"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "memcached version prior to 1.4.37 contains an Integer Overflow vulnerability in items.c:item_free() that can result in data corruption and deadlocks due to items existing in hash table being reused from free list. This attack appear to be exploitable via network connectivity to the memcached service. This vulnerability appears to have been fixed in 1.4.37 and later.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-13T21:29:00.477",
    "last_modified": "2024-11-21T03:39:44.437",
    "fix_date": "2017-05-22T04:49:54Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:2290",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/memcached/memcached/commit/a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/memcached/memcached/issues/271",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/memcached/memcached/wiki/ReleaseNotes1437",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/03/msg00031.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3601-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4218",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:2290",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/memcached/memcached/commit/a8c4a82787b8b6c256d61bd5c42fb7f92d1bae00",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/memcached/memcached/issues/271",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/memcached/memcached/wiki/ReleaseNotes1437",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/03/msg00031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3601-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4218",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.558916",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "memcached",
    "owner": "memcached",
    "created_at": "2009-04-24T23:34:25Z",
    "updated_at": "2025-01-14T05:51:40Z",
    "pushed_at": "2025-01-13T22:43:51Z",
    "size": 6228,
    "stars": 13649,
    "forks": 3295,
    "open_issues": 75,
    "watchers": 13649,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1727725,
      "Perl": 476083,
      "Lua": 78034,
      "C++": 34629,
      "M4": 32313,
      "Python": 22347,
      "DTrace": 10604,
      "Makefile": 6758,
      "Shell": 6233,
      "Roff": 1894,
      "Starlark": 726
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:00:59.490793"
  }
}