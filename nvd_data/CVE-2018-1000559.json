{
  "cve_id": "CVE-2018-1000559",
  "github_data": {
    "repository": "qutebrowser/qutebrowser",
    "fix_commit": "4c9360237f186681b1e3f2a0f30c45161cf405c7",
    "related_commits": [
      "4c9360237f186681b1e3f2a0f30c45161cf405c7",
      "5a7869f2feaa346853d2a85413d6527c87ef0d9f",
      "4c9360237f186681b1e3f2a0f30c45161cf405c7",
      "5a7869f2feaa346853d2a85413d6527c87ef0d9f"
    ],
    "patch_url": "https://github.com/qutebrowser/qutebrowser/commit/4c9360237f186681b1e3f2a0f30c45161cf405c7.patch",
    "fix_commit_details": {
      "sha": "4c9360237f186681b1e3f2a0f30c45161cf405c7",
      "commit_date": "2018-06-21T19:20:19Z",
      "author": {
        "login": "The-Compiler",
        "type": "User",
        "stats": {
          "total_commits": 18349,
          "average_weekly_commits": 31.636206896551723,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 545
        }
      },
      "commit_message": {
        "title": "Fix XSS issue on qute://history",
        "length": 114,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 19,
        "deletions": 2
      },
      "files": [
        {
          "filename": "qutebrowser/browser/qutescheme.py",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -24,6 +24,7 @@\n     _HANDLERS: The handlers registered via decorators.\n \"\"\"\n \n+import html\n import json\n import os\n import time\n@@ -241,8 +242,9 @@ def history_data(start_time, offset=None):\n         end_time = start_time - 24*60*60\n         entries = hist.entries_between(end_time, start_time)\n \n-    return [{\"url\": e.url, \"title\": e.title or e.url, \"time\": e.atime}\n-            for e in entries]\n+    return [{\"url\": html.escape(e.url),\n+             \"title\": html.escape(e.title) or html.escape(e.url),\n+             \"time\": e.atime} for e in entries]\n \n \n @add_handler('history')"
        },
        {
          "filename": "tests/end2end/data/issue4011.html",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+<!DOCTYPE html>\n+<html>\n+    <head>\n+        <meta charset=\"utf-8\">\n+        <title>&lt;img src=&quot;x&quot; onerror=&quot;console.log('XSS')&quot;&gt;foo</title>\n+    </head>\n+    <body>\n+        foo\n+    </body>\n+</html>"
        },
        {
          "filename": "tests/end2end/features/history.feature",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -111,3 +111,8 @@ Feature: Page history\n         And I wait until qute://history is loaded\n         Then the page should contain the plaintext \"3.txt\"\n         Then the page should contain the plaintext \"4.txt\"\n+\n+    Scenario: XSS in :history\n+        When I open data/issue4011.html\n+        And I open qute://history\n+        Then the javascript message \"XSS\" should not be logged"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0a32d6fef5550c2c0c38073533d36c3f47d6b130",
            "date": "2025-01-09T10:50:34Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "c5395c23f7033d8884a6b89549fc73e0308711f6",
            "date": "2025-01-09T10:27:40Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "d272804126de00a4a59776aa7b1808abb96ecb0e",
            "date": "2025-01-09T10:20:48Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "ed8141cb4b97427c4fc69b2c60f5d734cb7d9d1b",
            "date": "2025-01-06T14:14:21Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "2b8c053aee5c847f0f324e6c9a4262a79144f2c8",
            "date": "2025-01-06T14:07:30Z",
            "author_login": "The-Compiler"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "qutebrowser version introduced in v0.11.0 (1179ee7a937fb31414d77d9970bac21095358449) contains a Cross Site Scripting (XSS) vulnerability in history command, qute://history page that can result in Via injected JavaScript code, a website can steal the user's browsing history. This attack appear to be exploitable via the victim must open a page with a specially crafted <title> attribute, and then open the qute://history site via the :history command. This vulnerability appears to have been fixed in fixed in v1.3.3 (4c9360237f186681b1e3f2a0f30c45161cf405c7, to be released today) and v1.4.0 (5a7869f2feaa346853d2a85413d6527c87ef0d9f, released later this week).",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-06-26T16:29:02.930",
    "last_modified": "2024-11-21T03:40:11.847",
    "fix_date": "2018-06-21T19:20:19Z"
  },
  "references": [
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/4c9360237f186681b1e3f2a0f30c45161cf405c7",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/5a7869f2feaa346853d2a85413d6527c87ef0d9f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/issues/4011",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/4c9360237f186681b1e3f2a0f30c45161cf405c7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/5a7869f2feaa346853d2a85413d6527c87ef0d9f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/issues/4011",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:28.550331",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qutebrowser",
    "owner": "qutebrowser",
    "created_at": "2014-06-26T14:59:34Z",
    "updated_at": "2025-01-13T20:25:55Z",
    "pushed_at": "2025-01-13T04:22:22Z",
    "size": 63852,
    "stars": 10002,
    "forks": 1018,
    "open_issues": 1235,
    "watchers": 10002,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v0.11.x",
      "v1.1.x",
      "v1.2.x",
      "v1.3.x",
      "v1.4.x",
      "v1.5.x",
      "v1.6.x",
      "v1.7.x",
      "v1.8.x",
      "v1.9.x"
    ],
    "languages": {
      "Python": 4059218,
      "JavaScript": 771996,
      "Gherkin": 373139,
      "HTML": 131743,
      "Shell": 50490,
      "NSIS": 41173,
      "CSS": 4753,
      "Jinja": 3137,
      "Batchfile": 2012,
      "Makefile": 1510,
      "C++": 456,
      "QMake": 192
    },
    "commit_activity": {
      "total_commits_last_year": 476,
      "avg_commits_per_week": 9.153846153846153,
      "days_active_last_year": 143
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:16:35.329343"
  }
}