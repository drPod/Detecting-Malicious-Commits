{
  "cve_id": "CVE-2018-1000882",
  "github_data": {
    "repository": "renlok/WeBid",
    "fix_commit": "256a5f9d3eafbc477dcf77c7682446cc4b449c7f",
    "related_commits": [
      "256a5f9d3eafbc477dcf77c7682446cc4b449c7f",
      "256a5f9d3eafbc477dcf77c7682446cc4b449c7f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "256a5f9d3eafbc477dcf77c7682446cc4b449c7f",
      "commit_date": "2018-11-22T01:36:55Z",
      "author": {
        "login": "renlok",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Number of secerity fixes & fix for setup fee #510",
        "length": 49,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 120,
        "additions": 69,
        "deletions": 51
      },
      "files": [
        {
          "filename": "active_auctions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -66,7 +66,7 @@\n $k = 0;\n while ($row = $db->fetch()) {\n     if (strlen($row['pict_url']) > 0) {\n-        $row['pict_url'] = $system->SETTINGS['siteurl'] . 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&fromfile=' . UPLOAD_FOLDER . $row['id'] . '/' . $row['pict_url'];\n+        $row['pict_url'] = $system->SETTINGS['siteurl'] . 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&auction_id=' . $row['id'] . '&fromfile=' . $row['pict_url'];\n     } else {\n         $row['pict_url'] = get_lang_img('nopicture.gif');\n     }"
        },
        {
          "filename": "admin/editauction.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,7 +36,7 @@ function load_gallery($auc_id)\n         if ($dir = opendir(UPLOAD_PATH . $auc_id)) {\n             while ($file = @readdir($dir)) {\n                 if ($file != '.' && $file != '..' && strpos($file, 'thumb-') === false) {\n-                    $UPLOADED_PICTURES[] = UPLOAD_FOLDER . $auc_id . '/' . $file;\n+                    $UPLOADED_PICTURES[] = $file;\n                 }\n             }\n             closedir($dir);"
        },
        {
          "filename": "bid.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -561,7 +561,7 @@ function extend_auction($id, $ends)\n             'ERROR' => (isset($errmsg)) ? $errmsg : '',\n             'BID_HISTORY' => (isset($ARETHEREBIDS)) ? $ARETHEREBIDS : '',\n             'ID' => $id,\n-            'IMAGE' => (!empty($pict_url_plain)) ? '<img src=\"getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&fromfile=' . UPLOAD_FOLDER . $id . '/' . $pict_url_plain . '\" border=\"0\" align=\"center\">' : '&nbsp;',\n+            'IMAGE' => (!empty($pict_url_plain)) ? '<img src=\"getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&auction_id=' . $id . '&fromfile=' . $pict_url_plain . '\" border=\"0\" align=\"center\">' : '',\n             'TITLE' => $item_title,\n             'CURRENT_BID' => $system->print_money($cbid),\n             'ATYPE' => $atype,"
        },
        {
          "filename": "closed_auctions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -65,7 +65,7 @@\n     $starting_price = $row['current_bid'];\n \n     if (strlen($row['pict_url']) > 0) {\n-        $row['pict_url'] = $system->SETTINGS['siteurl'] . 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&fromfile=' . UPLOAD_FOLDER . $row['id'] . '/' . $row['pict_url'];\n+        $row['pict_url'] = $system->SETTINGS['siteurl'] . 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&auction_id=' . $row['id'] . '&fromfile=' . $row['pict_url'];\n     } else {\n         $row['pict_url'] = get_lang_img('nopicture.gif');\n     }"
        },
        {
          "filename": "getthumb.php",
          "status": "modified",
          "additions": 29,
          "deletions": 16,
          "patch": "@@ -14,9 +14,31 @@\n \n include 'common.php';\n \n+// get passed values\n $w = (isset($_GET['w'])) ? intval($_GET['w']) : '';\n-$_w = $w;\n-$fromfile = (isset($_GET['fromfile'])) ? $_GET['fromfile'] : '';\n+$fromfile = $_GET['fromfile'];\n+$auction_id = $_GET['auction_id'];\n+\n+// check passed values\n+if (!isset($_GET['fromfile']) ||\n+\t!isset($_GET['auction_id']) || !is_numeric($auction_id)) {\n+    ErrorPNG($ERR_716);\n+    exit;\n+} elseif (!file_exists($_GET['fromfile']) && !fopen($_GET['fromfile'], 'r')) {\n+    ErrorPNG($ERR_716);\n+    exit;\n+}\n+\n+if ($fromfile != '') {\n+\t// clean fromfile\n+\t$fromfile = basename($fromfile);\n+\t// build file path\n+\t$file_path = UPLOAD_FOLDER . $auction_id . '/' . $fromfile;\n+} else {\n+\t// if empty filename just show default image\n+\t$file_path = MAIN_PATH . 'images/email_alerts/default_item_img.jpg';\n+}\n+\n $nomanage = false;\n $accepted_widths = array(\n     $system->SETTINGS['thumb_show'],\n@@ -47,17 +69,8 @@ function load_image($file, $mime, $image_type, $output_type)\n     exit;\n }\n \n-// control parameters and file existence\n-if (!isset($_GET['fromfile']) || $fromfile == '') {\n-    ErrorPNG($ERR_716);\n-    exit;\n-} elseif (!file_exists($_GET['fromfile']) && !fopen($_GET['fromfile'], 'r')) {\n-    ErrorPNG($ERR_716);\n-    exit;\n-}\n-\n if (file_exists(UPLOAD_PATH . 'cache/' . $w . '-' . md5($fromfile))) {\n-    $img = getimagesize($fromfile);\n+    $img = getimagesize($file_path);\n     switch ($img[2]) {\n         case IMAGETYPE_GIF:\n             if (!(imagetypes() &IMG_GIF)) {\n@@ -98,7 +111,7 @@ function load_image($file, $mime, $image_type, $output_type)\n             mkdir(UPLOAD_PATH . 'cache', 0777);\n         }\n \n-        $img = @getimagesize($fromfile);\n+        $img = @getimagesize($file_path);\n         if (is_array($img)) {\n             switch ($img[2]) {\n                 case IMAGETYPE_GIF:\n@@ -141,7 +154,7 @@ function load_image($file, $mime, $image_type, $output_type)\n         }\n         if ($w == '') {\n             // just load the image\n-            load_image($fromfile, $img['mime'], $image_type, $output_type);\n+            load_image($file_path, $img['mime'], $image_type, $output_type);\n         } else {\n             // check image orientation\n             if ($img[0] < $img[1]) {\n@@ -156,9 +169,9 @@ function load_image($file, $mime, $image_type, $output_type)\n             $ou = imagecreatetruecolor($w, $h);\n             imagealphablending($ou, false);\n             $funcall = \"imagecreatefrom$image_type\";\n-            imagecopyresampled($ou, $funcall($fromfile), 0, 0, 0, 0, $w, $h, $img[0], $img[1]);\n+            imagecopyresampled($ou, $funcall($file_path), 0, 0, 0, 0, $w, $h, $img[0], $img[1]);\n             $funcall = \"image$output_type\";\n-            $funcall($ou, UPLOAD_PATH . 'cache/' . $_w . '-' . md5($fromfile));\n+            $funcall($ou, UPLOAD_PATH . 'cache/' . $w . '-' . md5($fromfile));\n             header('Content-type: ' . $img['mime']);\n             $funcall($ou);\n             exit;"
        },
        {
          "filename": "includes/browseitems.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -116,7 +116,7 @@ function build_items($row)\n \n     // image icon\n     if (!empty($row['pict_url'])) {\n-        $row['pict_url'] = $system->SETTINGS['siteurl'] . 'getthumb.php?w=' . $system->SETTINGS['thumb_list'] . '&fromfile=' . UPLOAD_FOLDER . $row['id'] . '/' . $row['pict_url'];\n+        $row['pict_url'] = $system->SETTINGS['siteurl'] . 'getthumb.php?w=' . $system->SETTINGS['thumb_list'] . '&auction_id=' . $row['id'] . '&fromfile=' . $row['pict_url'];\n     } else {\n         $row['pict_url'] = get_lang_img('nopicture.gif');\n     }"
        },
        {
          "filename": "includes/functions_sell.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -398,7 +398,7 @@ function get_fee($minimum_bid, $just_fee = true)\n         'extracat_fee' => 0\n     );\n     while ($row = $db->fetch()) {\n-        if ($minimum_bid >= $row['fee_from'] && $minimum_bid <= $row['fee_to'] && $row['type'] == 'setup') {\n+        if ($minimum_bid >= $row['fee_from'] && $minimum_bid <= $row['fee_to'] && $row['type'] == 'setup_fee') {\n             if ($row['fee_type'] == 'flat') {\n                 $fee_data['setup_fee'] = $row['value'];\n                 $fee_value = bcadd($fee_value, $row['value'], $system->SETTINGS['moneydecimals']);"
        },
        {
          "filename": "index.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -104,7 +104,7 @@ function ShowFlags()\n             'ENDS' => $ends_string,\n             'ID' => $row['id'],\n             'BID' => $system->print_money($high_bid),\n-            'IMAGE' => (!empty($row['pict_url'])) ? 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&amp;fromfile=' . UPLOAD_FOLDER . $row['id'] . '/' . $row['pict_url'] : 'images/email_alerts/default_item_img.jpg',\n+            'IMAGE' => (!empty($row['pict_url'])) ? 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&auction_id=' . $row['id'] . '&fromfile=' . $row['pict_url'] : '',\n             'TITLE' => htmlspecialchars($row['title'])\n             ));\n     $i++;\n@@ -188,7 +188,7 @@ function ShowFlags()\n             'ENDS' => $ends_string,\n             'ID' => $row['id'],\n             'BID' => $system->print_money($high_bid),\n-            'IMAGE' => (!empty($row['pict_url'])) ? 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&amp;fromfile=' . UPLOAD_FOLDER . $row['id'] . '/' . $row['pict_url'] : 'images/email_alerts/default_item_img.jpg',\n+            'IMAGE' => (!empty($row['pict_url'])) ? 'getthumb.php?w=' . $system->SETTINGS['thumb_show'] . '&auction_id=' . $row['id'] . '&amp;fromfile=' . $row['pict_url'] : '',\n             'TITLE' => htmlspecialchars($row['title'])\n             ));\n }"
        },
        {
          "filename": "item.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -466,7 +466,7 @@\n         'TITLE' => htmlspecialchars($auction_data['title']),\n         'SUBTITLE' => htmlspecialchars($auction_data['subtitle']),\n         'AUCTION_DESCRIPTION' => $auction_data['description'],\n-        'PIC_URL' => UPLOAD_FOLDER . $id . '/' . $auction_data['pict_url'],\n+        'PIC_URL' => $auction_data['pict_url'],\n         'SHIPPING_COST' => ($auction_data['shipping_cost'] > 0) ? $system->print_money($auction_data['shipping_cost']) : $MSG['1152'],\n         'ADDITIONAL_SHIPPING_COST' => $system->print_money($auction_data['additional_shipping_cost']),\n         'COUNTRY' => $auction_data['country'],"
        },
        {
          "filename": "register.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -448,15 +448,15 @@ function emailDomainIsBlacklisted($email)\n \n         'V_YNEWSL' => ((isset($_POST['TPL_nletter']) && $_POST['TPL_nletter'] == 1) || !isset($_POST['TPL_nletter'])) ? 'checked=true' : '',\n         'V_NNEWSL' => (isset($_POST['TPL_nletter']) && $_POST['TPL_nletter'] == 2) ? 'checked=true' : '',\n-        'V_YNAME' => (isset($_POST['TPL_name'])) ? $_POST['TPL_name'] : '',\n-        'V_UNAME' => (isset($_POST['TPL_nick'])) ? $_POST['TPL_nick'] : '',\n-        'V_EMAIL' => (isset($_POST['TPL_email'])) ? $_POST['TPL_email'] : '',\n-        'V_YEAR' => (isset($_POST['TPL_year'])) ? $_POST['TPL_year'] : '',\n-        'V_ADDRE' => (isset($_POST['TPL_address'])) ? $_POST['TPL_address'] : '',\n-        'V_CITY' => (isset($_POST['TPL_city'])) ? $_POST['TPL_city'] : '',\n-        'V_PROV' => (isset($_POST['TPL_prov'])) ? $_POST['TPL_prov'] : '',\n-        'V_POSTCODE' => (isset($_POST['TPL_zip'])) ? $_POST['TPL_zip'] : '',\n-        'V_PHONE' => (isset($_POST['TPL_phone'])) ? $_POST['TPL_phone'] : ''\n+        'V_YNAME' => (isset($_POST['TPL_name'])) ? $system->cleanvars($_POST['TPL_name']) : '',\n+        'V_UNAME' => (isset($_POST['TPL_nick'])) ? $system->cleanvars($_POST['TPL_nick']) : '',\n+        'V_EMAIL' => (isset($_POST['TPL_email'])) ? $system->cleanvars($_POST['TPL_email']) : '',\n+        'V_YEAR' => (isset($_POST['TPL_year'])) ? $system->cleanvars($_POST['TPL_year']) : '',\n+        'V_ADDRE' => (isset($_POST['TPL_address'])) ? $system->cleanvars($_POST['TPL_address']) : '',\n+        'V_CITY' => (isset($_POST['TPL_city'])) ? $system->cleanvars($_POST['TPL_city']) : '',\n+        'V_PROV' => (isset($_POST['TPL_prov'])) ? $system->cleanvars($_POST['TPL_prov']) : '',\n+        'V_POSTCODE' => (isset($_POST['TPL_zip'])) ? $system->cleanvars($_POST['TPL_zip']) : '',\n+        'V_PHONE' => (isset($_POST['TPL_phone'])) ? $system->cleanvars($_POST['TPL_phone']) : ''\n         ));\n \n include 'header.php';"
        },
        {
          "filename": "themes/adminClassic/editauction.tpl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -71,7 +71,7 @@\n <!-- BEGIN gallery -->\n \t\t\t\t\t\t\t<div class=\"button\" style=\" height:100px; float:left; margin:5px; padding:10px 5px 20px 10px;\">\n \t\t\t\t\t\t\t\t<a href=\"{SITEURL}/{gallery.V}\" title=\"{gallery.V}\" target=\"_blank\">\n-\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?fromfile={gallery.V}\" border=\"0\" height=\"100px\">\n+\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?fromfile={gallery.V}&auction_id={ID}\" border=\"0\" height=\"100px\">\n \t\t\t\t\t\t\t\t</a><br>\n \t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"gallery[]\" value=\"{gallery.V}\">\n \t\t\t\t\t\t\t</div>"
        },
        {
          "filename": "themes/adminModern/editauction.tpl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -71,7 +71,7 @@\n <!-- BEGIN gallery -->\n \t\t\t\t\t\t\t<div style=\"width:50px; float: left;\">\n \t\t\t\t\t\t\t\t<a href=\"{SITEURL}/{gallery.V}\" title=\"{gallery.V}\" target=\"_blank\">\n-\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?fromfile={gallery.V}\" border=\"0\" hspace=\"10\">\n+\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?fromfile={gallery.V}&auction_id={ID}\" border=\"0\" hspace=\"10\">\n \t\t\t\t\t\t\t\t</a>\n \t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"gallery[]\" value=\"{gallery.V}\">\n \t\t\t\t\t\t\t</div>"
        },
        {
          "filename": "themes/classic/item.tpl",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -81,7 +81,7 @@ $(document).ready(function() {\n \t\t\t\t\t\t\t\t\t<table bgcolor=\"#ffffff\">\n \t\t\t\t\t\t\t\t\t\t<tr>\n \t\t\t\t\t\t\t\t\t\t\t<td align='center'>\n-\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?w={THUMBWIDTH}&fromfile={PIC_URL}\" border=\"0\" align=\"center\"><br>\n+\t\t\t\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?w={THUMBWIDTH}&fromfile={PIC_URL}&auction_id={ID}\" border=\"0\" align=\"center\"><br>\n \t<!-- IF B_HASGALELRY -->\n \t\t\t\t\t\t\t\t\t\t\t\t<a href=\"#gallery\"><img src=\"{SITEURL}images/gallery.gif\" border=\"0\" alt=\"gallery\"> {L_694}</a>\n \t<!-- ENDIF -->\n@@ -308,7 +308,7 @@ $(document).ready(function() {\n \t<!-- BEGIN gallery -->\n \t\t\t\t\t\t\t<td>\n \t\t\t\t\t\t\t\t<a href=\"{SITEURL}{UPLOADEDPATH}{ID}/{gallery.V}\" title=\"\" data-lightbox=\"gallery\">\n-\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?w={THUMBWIDTH}&fromfile={UPLOADEDPATH}{ID}/{gallery.V}\" border=\"0\" hspace=\"10\">\n+\t\t\t\t\t\t\t\t\t<img src=\"{SITEURL}getthumb.php?w={THUMBWIDTH}&fromfile={gallery.V}&auction_id={ID}\" border=\"0\" hspace=\"10\">\n \t\t\t\t\t\t\t\t</a>\n \t\t\t\t\t\t\t</td>\n \t<!-- END gallery -->"
        },
        {
          "filename": "themes/modern/item.tpl",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -57,7 +57,7 @@ $(document).ready(function() {\n \t\t\t\t\t<div class=\"panel-heading\"><span class=\"label label-default\">{L_113}: {ID}</span></div>\n \t\t\t\t\t<div class=\"panel-body\">\n \t\t\t\t\t\t<div class=\"col-md-12\">\n-\t\t\t\t\t\t\t<img class=\"img-rounded img-responsive center-block\" src=\"{SITEURL}getthumb.php?w=430&fromfile={PIC_URL}\" border=\"0\" align=\"center\" width=\"430px\">\n+\t\t\t\t\t\t\t<img class=\"img-rounded img-responsive center-block\" src=\"{SITEURL}getthumb.php?w=430&fromfile={PIC_URL}&auction_id={ID}\" border=\"0\" align=\"center\" width=\"430px\">\n \t\t\t\t\t\t</div>\n \t<!-- IF B_HASGALELRY -->\n \t\t\t\t\t\t<div>\n@@ -66,7 +66,7 @@ $(document).ready(function() {\n \t\t<!-- BEGIN gallery -->\n \t\t\t\t\t\t\t\t<div class=\"col-md-4 col-xs-4 col-sm-4\">\n \t\t\t\t\t\t\t\t\t<a href=\"{SITEURL}{UPLOADEDPATH}{ID}/{gallery.V}\" title=\"\" data-lightbox=\"gallery\">\n-\t\t\t\t\t\t\t\t\t<img class=\"img-rounded img-responsive\" src=\"{SITEURL}getthumb.php?w={THUMBWIDTH}&fromfile={UPLOADEDPATH}{ID}/{gallery.V}\" border=\"0\"></a>\n+\t\t\t\t\t\t\t\t\t<img class=\"img-rounded img-responsive\" src=\"{SITEURL}getthumb.php?w={THUMBWIDTH}&fromfile={gallery.V}&auction_id={ID}\" border=\"0\"></a>\n \t\t\t\t\t\t\t\t</div>\n \t\t<!-- END gallery -->\n \t\t\t\t\t\t\t</div>"
        },
        {
          "filename": "user_login.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -124,7 +124,7 @@\n \n $template->assign_vars(array(\n         'ERROR' => (isset($ERR)) ? $ERR : '',\n-        'USER' => (isset($_POST['username'])) ? $_POST['username'] : ''\n+        'USER' => (isset($_POST['username'])) ? $system->cleanvars($_POST['username']) : ''\n         ));\n \n include 'header.php';"
        },
        {
          "filename": "yourauctions.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -99,8 +99,9 @@\n     $_SESSION['oa_ord'] = 'title';\n     $_SESSION['oa_type'] = 'asc';\n } elseif (!empty($_GET['oa_ord'])) {\n-    $_SESSION['oa_ord'] = $_GET['oa_ord'];\n-    $_SESSION['oa_type'] = $_GET['oa_type'];\n+\t// check oa_ord && oa_type are valid\n+    $_SESSION['oa_ord'] = (in_array($_GET['oa_ord'], array('title', 'starts', 'ends', 'num_bids', 'current_bid'))) ? $_GET['oa_ord'] : 'title';\n+    $_SESSION['oa_type'] = (in_array($_GET['oa_type'], array('asc', 'desc'))) ? $_GET['oa_type'] : 'asc';\n } elseif (isset($_SESSION['oa_ord']) && empty($_GET['oa_ord'])) {\n     $_SESSION['oa_nexttype'] = $_SESSION['oa_type'];\n }"
        },
        {
          "filename": "yourauctions_c.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -204,8 +204,9 @@\n     $_SESSION['ca_ord'] = 'title';\n     $_SESSION['ca_type'] = 'asc';\n } elseif (!empty($_GET['ca_ord'])) {\n-    $_SESSION['ca_ord'] = $_GET['ca_ord'];\n-    $_SESSION['ca_type'] = $_GET['ca_type'];\n+\t// check oa_ord && oa_type are valid\n+    $_SESSION['ca_ord'] = (in_array($_GET['ca_ord'], array('title', 'starts', 'ends', 'num_bids', 'current_bid'))) ? $_GET['ca_ord'] : 'title';\n+    $_SESSION['ca_type'] = (in_array($_GET['ca_type'], array('asc', 'desc'))) ? $_GET['ca_type'] : 'asc';\n } elseif (isset($_SESSION['ca_ord']) && empty($_GET['ca_ord'])) {\n     $_SESSION['ca_nexttype'] = $_SESSION['ca_type'];\n }"
        },
        {
          "filename": "yourauctions_p.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -109,8 +109,9 @@\n     $_SESSION['pa_ord'] = 'title';\n     $_SESSION['pa_type'] = 'asc';\n } elseif (!empty($_GET['pa_ord'])) {\n-    $_SESSION['pa_ord'] = $_GET['pa_ord'];\n-    $_SESSION['pa_type'] = $_GET['pa_type'];\n+\t// check oa_ord && oa_type are valid\n+    $_SESSION['pa_ord'] = (in_array($_GET['pa_ord'], array('title', 'starts', 'ends'))) ? $_GET['pa_ord'] : 'title';\n+    $_SESSION['pa_type'] = (in_array($_GET['pa_type'], array('asc', 'desc'))) ? $_GET['pa_type'] : 'asc';\n } elseif (isset($_SESSION['pa_ord']) && empty($_GET['pa_ord'])) {\n     $_SESSION['pa_nexttype'] = $_SESSION['pa_type'];\n }"
        },
        {
          "filename": "yourauctions_s.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -81,8 +81,9 @@\n     $_SESSION['sa_ord'] = 'title';\n     $_SESSION['sa_type'] = 'asc';\n } elseif (!empty($_GET['sa_ord'])) {\n-    $_SESSION['sa_ord'] = $_GET['sa_ord'];\n-    $_SESSION['sa_type'] = $_GET['sa_type'];\n+\t// check oa_ord && oa_type are valid\n+    $_SESSION['sa_ord'] = (in_array($_GET['sa_ord'], array('title', 'num_bids', 'current_bid'))) ? $_GET['sa_ord'] : 'title';\n+    $_SESSION['sa_type'] = (in_array($_GET['sa_type'], array('asc', 'desc'))) ? $_GET['sa_type'] : 'asc';\n } elseif (isset($_SESSION['sa_ord']) && empty($_GET['sa_ord'])) {\n     $_SESSION['sa_nexttype'] = $_SESSION['sa_type'];\n }"
        },
        {
          "filename": "yourauctions_sold.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -149,8 +149,9 @@\n     $_SESSION['solda_ord'] = 'title';\n     $_SESSION['solda_type'] = 'asc';\n } elseif (!empty($_GET['solda_ord'])) {\n-    $_SESSION['solda_ord'] = $_GET['solda_ord'];\n-    $_SESSION['solda_type'] = $_GET['solda_type'];\n+\t// check oa_ord && oa_type are valid\n+    $_SESSION['solda_ord'] = (in_array($_GET['solda_ord'], array('title', 'starts', 'ends', 'num_bids', 'current_bid'))) ? $_GET['solda_ord'] : 'title';\n+    $_SESSION['solda_type'] = (in_array($_GET['solda_type'], array('asc', 'desc'))) ? $_GET['solda_type'] : 'asc';\n } elseif (isset($_SESSION['solda_ord']) && empty($_GET['solda_ord'])) {\n     $_SESSION['solda_nexttype'] = $_SESSION['solda_type'];\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 7,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fe500f64b65294842f0c25ce1fd1210dd649dd6e",
            "date": "2018-11-30T23:10:19Z",
            "author_login": "renlok"
          },
          {
            "sha": "2b77b467878fc7ff993c268a288102cfe6f52a0c",
            "date": "2018-11-27T17:43:16Z",
            "author_login": "MESWEB"
          },
          {
            "sha": "2bfa851ac5fa3d8665ba8a7a425afd9897ecb540",
            "date": "2018-11-26T21:39:11Z",
            "author_login": "renlok"
          },
          {
            "sha": "256a5f9d3eafbc477dcf77c7682446cc4b449c7f",
            "date": "2018-11-22T01:36:55Z",
            "author_login": "renlok"
          },
          {
            "sha": "3eb457d841398a192549ae874e43c9126134c9bc",
            "date": "2018-11-21T20:27:52Z",
            "author_login": "renlok"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "WeBid version up to current version 1.2.2 contains a Directory Traversal vulnerability in getthumb.php that can result in Arbitrary Image File Read. This attack appear to be exploitable via HTTP GET Request. This vulnerability appears to have been fixed in after commit 256a5f9d3eafbc477dcf77c7682446cc4b449c7f.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-12-20T17:29:01.410",
    "last_modified": "2024-11-21T03:40:34.673",
    "fix_date": "2018-11-22T01:36:55Z"
  },
  "references": [
    {
      "url": "http://bugs.webidsupport.com/view.php?id=646",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/renlok/WeBid/commit/256a5f9d3eafbc477dcf77c7682446cc4b449c7f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://telekomsecurity.github.io/assets/advisories/20181108_WeBid_Multiple_Vulnerabilities.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://bugs.webidsupport.com/view.php?id=646",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/renlok/WeBid/commit/256a5f9d3eafbc477dcf77c7682446cc4b449c7f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://telekomsecurity.github.io/assets/advisories/20181108_WeBid_Multiple_Vulnerabilities.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:42.192276",
    "processing_status": "enhanced"
  }
}