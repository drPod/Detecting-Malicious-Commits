{
  "cve_id": "CVE-2018-10573",
  "github_data": {
    "repository": "openemr/openemr",
    "fix_commit": "699e3c2ef68545357cac714505df1419b8bf2051",
    "related_commits": [
      "699e3c2ef68545357cac714505df1419b8bf2051",
      "699e3c2ef68545357cac714505df1419b8bf2051"
    ],
    "patch_url": "https://github.com/openemr/openemr/commit/699e3c2ef68545357cac714505df1419b8bf2051.patch",
    "fix_commit_details": {
      "sha": "699e3c2ef68545357cac714505df1419b8bf2051",
      "commit_date": "2018-03-22T15:05:32Z",
      "author": {
        "login": "bradymiller",
        "type": "User",
        "stats": {
          "total_commits": 3166,
          "average_weekly_commits": 4.1878306878306875,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 593
        }
      },
      "commit_message": {
        "title": "security fixes (#1519)",
        "length": 22,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 456,
        "additions": 243,
        "deletions": 213
      },
      "files": [
        {
          "filename": "interface/billing/get_claim_file.php",
          "status": "modified",
          "additions": 11,
          "deletions": 5,
          "patch": "@@ -1,8 +1,14 @@\n <?php\n-// This program is free software; you can redistribute it and/or\n-// modify it under the terms of the GNU General Public License\n-// as published by the Free Software Foundation; either version 2\n-// of the License, or (at your option) any later version.\n+/**\n+ * get_claim_file.php\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n+\n \n require_once(dirname(__FILE__) . \"/../globals.php\");\n require_once $GLOBALS['OE_SITE_DIR'] . \"/config.php\";\n@@ -22,7 +28,7 @@\n $fname = $claim_file_dir . $fname;\n \n if (!file_exists($fname)) {\n-    echo xl(\"The claim file: \") . $_GET['key'] . xl(\" could not be accessed.\");\n+    echo xl(\"The claim file: \") . text($_GET['key']) . xl(\" could not be accessed.\");\n } else {\n     $fp = fopen($fname, 'r');\n "
        },
        {
          "filename": "interface/billing/sl_eob_process.php",
          "status": "modified",
          "additions": 30,
          "deletions": 26,
          "patch": "@@ -1,15 +1,19 @@\n <?php\n-    // Copyright (C) 2006-2010 Rod Roark <rod@sunsetsystems.com>\n-    //\n-    // This program is free software; you can redistribute it and/or\n-    // modify it under the terms of the GNU General Public License\n-    // as published by the Free Software Foundation; either version 2\n-    // of the License, or (at your option) any later version.\n-\n-    // This processes X12 835 remittances and produces a report.\n-\n-    // Buffer all output so we can archive it to a file.\n-    ob_start();\n+/**\n+ * This processes X12 835 remittances and produces a report.\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Rod Roark <rod@sunsetsystems.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2006-2010 Rod Roark <rod@sunsetsystems.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n+\n+\n+// Buffer all output so we can archive it to a file.\n+ob_start();\n \n require_once(\"../globals.php\");\n require_once(\"$srcdir/invoice_summary.inc.php\");\n@@ -20,15 +24,15 @@\n require_once(\"remark_codes.php\");\n require_once(\"$srcdir/billing.inc\");\n \n-    $debug = $_GET['debug'] ? 1 : 0; // set to 1 for debugging mode\n-    $paydate = parse_date($_GET['paydate']);\n-    $encount = 0;\n+$debug = $_GET['debug'] ? 1 : 0; // set to 1 for debugging mode\n+$paydate = parse_date($_GET['paydate']);\n+$encount = 0;\n \n-    $last_ptname = '';\n-    $last_invnumber = '';\n-    $last_code = '';\n-    $invoice_total = 0.00;\n-    $InsertionId;//last inserted ID of\n+$last_ptname = '';\n+$last_invnumber = '';\n+$last_code = '';\n+$invoice_total = 0.00;\n+$InsertionId;//last inserted ID of\n \n ///////////////////////// Assorted Functions /////////////////////////\n \n@@ -640,7 +644,7 @@ function era_callback(&$out)\n     $fnreport = \"$nameprefix$namesuffix.html\";\n     $fhreport = fopen($fnreport, 'w');\n     if (!$fhreport) {\n-        die(xl(\"Cannot create\") . \" '$fnreport'\");\n+        die(xl(\"Cannot create\") . \" '\" . text($fnreport) . \"'\");\n     }\n }\n \n@@ -738,12 +742,12 @@ function era_callback(&$out)\n }\n ?>\n </script>\n-<input type=\"hidden\" name=\"paydate\" value=\"<?php echo DateToYYYYMMDD($_REQUEST['paydate']);?>\" />\n-<input type=\"hidden\" name=\"post_to_date\" value=\"<?php echo DateToYYYYMMDD($_REQUEST['post_to_date']);?>\" />\n-<input type=\"hidden\" name=\"deposit_date\" value=\"<?php echo DateToYYYYMMDD($_REQUEST['deposit_date']);?>\" />\n-<input type=\"hidden\" name=\"debug\" value=\"<?php echo $_REQUEST['debug'];?>\" />\n-<input type=\"hidden\" name=\"InsId\" value=\"<?php echo $_REQUEST['InsId'];?>\" />\n-<input type=\"hidden\" name=\"eraname\" value=\"<?php echo $eraname?>\" />\n+<input type=\"hidden\" name=\"paydate\" value=\"<?php echo attr(DateToYYYYMMDD($_REQUEST['paydate'])); ?>\" />\n+<input type=\"hidden\" name=\"post_to_date\" value=\"<?php echo attr(DateToYYYYMMDD($_REQUEST['post_to_date'])); ?>\" />\n+<input type=\"hidden\" name=\"deposit_date\" value=\"<?php echo attr(DateToYYYYMMDD($_REQUEST['deposit_date'])); ?>\" />\n+<input type=\"hidden\" name=\"debug\" value=\"<?php echo attr($_REQUEST['debug']); ?>\" />\n+<input type=\"hidden\" name=\"InsId\" value=\"<?php echo attr($_REQUEST['InsId']); ?>\" />\n+<input type=\"hidden\" name=\"eraname\" value=\"<?php echo attr($eraname); ?>\" />\n </form>\n </body>\n </html>"
        },
        {
          "filename": "interface/billing/sl_eob_search.php",
          "status": "modified",
          "additions": 22,
          "deletions": 29,
          "patch": "@@ -2,28 +2,21 @@\n /**\n  * This the first of two pages to support posting of EOBs.\n  * The second is sl_eob_invoice.php.\n- * Windows compatibility and statement downloading:\n- *      2009 Bill Cernansky and Tony McCormick [mi-squared.com]\n  *\n- * Copyright (C) 2005-2010 Rod Roark <rod@sunsetsystems.com>\n- *\n- * LICENSE: This program is free software; you can redistribute it and/or\n- * modify it under the terms of the GNU General Public License\n- * as published by the Free Software Foundation; either version 2\n- * of the License, or (at your option) any later version.\n- * This program is distributed in the hope that it will be useful,\n- * but WITHOUT ANY WARRANTY; without even the implied warranty of\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n- * GNU General Public License for more details.\n- * You should have received a copy of the GNU General Public License\n- * along with this program. If not, see <http://opensource.org/licenses/gpl-license.php>;.\n- *\n- * @package OpenEMR\n- * @author  Rod Roark <rod@sunsetsystems.com>\n- * @author  Roberto Vasquez <robertogagliotta@gmail.com>\n- * @author  Jerry Padgett <sjpadgett@gmail.com>\n- * @link    http://www.open-emr.org\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Rod Roark <rod@sunsetsystems.com>\n+ * @author    Bill Cernansky\n+ * @author    Tony McCormick\n+ * @author    Roberto Vasquez <robertogagliotta@gmail.com>\n+ * @author    Jerry Padgett <sjpadgett@gmail.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2005-2010 Rod Roark <rod@sunsetsystems.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n+\n+\n require_once(\"../globals.php\");\n require_once(\"$srcdir/patient.inc\");\n require_once(\"$srcdir/invoice_summary.inc.php\");\n@@ -642,14 +635,14 @@ function npopup(pid) {\n             <?php xl('Source:', 'e'); ?>\n        </td>\n        <td>\n-         <input type='text' name='form_source' size='10' value='<?php echo $_POST['form_source']; ?>'\n+         <input type='text' name='form_source' size='10' value='<?php echo attr($_POST['form_source']); ?>'\n          title='<?php xl(\"A check number or claim number to identify the payment\", \"e\"); ?>'>\n        </td>\n        <td>\n             <?php xl('Pay Date:', 'e'); ?>\n        </td>\n        <td>\n-         <input type='text' name='form_paydate' size='10' value='<?php echo $_POST['form_paydate']; ?>'\n+         <input type='text' name='form_paydate' size='10' value='<?php echo attr($_POST['form_paydate']); ?>'\n          onkeyup='datekeyup(this,mypcc)' onblur='dateblur(this,mypcc)'\n          title='<?php xl(\"Date of payment yyyy-mm-dd\", \"e\"); ?>'>\n        </td>\n@@ -658,7 +651,7 @@ function npopup(pid) {\n             <?php xl('Deposit Date:', 'e'); ?>\n        </td>\n        <td>\n-         <input type='text' name='form_deposit_date' size='10' value='<?php echo $_POST['form_deposit_date']; ?>'\n+         <input type='text' name='form_deposit_date' size='10' value='<?php echo attr($_POST['form_deposit_date']); ?>'\n          onkeyup='datekeyup(this,mypcc)' onblur='dateblur(this,mypcc)'\n          title='<?php xl(\"Date of bank deposit yyyy-mm-dd\", \"e\"); ?>'>\n        </td>\n@@ -667,7 +660,7 @@ function npopup(pid) {\n             <?php xl('Amount:', 'e'); ?>\n        </td>\n        <td>\n-         <input type='text' name='form_amount' size='10' value='<?php echo $_POST['form_amount']; ?>'\n+         <input type='text' name='form_amount' size='10' value='<?php echo attr($_POST['form_amount']); ?>'\n          title='<?php xl(\"Paid amount that you will allocate\", \"e\"); ?>'>\n        </td>\n        <td align='right'>\n@@ -684,35 +677,35 @@ function npopup(pid) {\n         <?php xl('Name:', 'e'); ?>\n      </td>\n      <td>\n-       <input type='text' name='form_name' size='10' value='<?php echo $_POST['form_name']; ?>'\n+       <input type='text' name='form_name' size='10' value='<?php echo attr($_POST['form_name']); ?>'\n        title='<?php xl(\"Any part of the patient name, or \\\"last,first\\\", or \\\"X-Y\\\"\", \"e\"); ?>'>\n      </td>\n      <td>\n         <?php xl('Chart ID:', 'e'); ?>\n      </td>\n      <td>\n-       <input type='text' name='form_pid' size='10' value='<?php echo $_POST['form_pid']; ?>'\n+       <input type='text' name='form_pid' size='10' value='<?php echo attr($_POST['form_pid']); ?>'\n        title='<?php xl(\"Patient chart ID\", \"e\"); ?>'>\n      </td>\n      <td>\n         <?php xl('Encounter:', 'e'); ?>\n      </td>\n      <td>\n-       <input type='text' name='form_encounter' size='10' value='<?php echo $_POST['form_encounter']; ?>'\n+       <input type='text' name='form_encounter' size='10' value='<?php echo attr($_POST['form_encounter']); ?>'\n        title='<?php xl(\"Encounter number\", \"e\"); ?>'>\n      </td>\n      <td>\n         <?php xl('Svc Date:', 'e'); ?>\n      </td>\n      <td>\n-       <input type='text' name='form_date' size='10' value='<?php echo $_POST['form_date']; ?>'\n+       <input type='text' name='form_date' size='10' value='<?php echo attr($_POST['form_date']); ?>'\n        title='<?php xl(\"Date of service mm/dd/yyyy\", \"e\"); ?>'>\n      </td>\n      <td>\n         <?php xl('To:', 'e'); ?>\n      </td>\n      <td>\n-       <input type='text' name='form_to_date' size='10' value='<?php echo $_POST['form_to_date']; ?>'\n+       <input type='text' name='form_to_date' size='10' value='<?php echo attr($_POST['form_to_date']); ?>'\n        title='<?php xl(\"Ending DOS mm/dd/yyyy if you wish to enter a range\", \"e\"); ?>'>\n      </td>\n      <td>"
        },
        {
          "filename": "interface/de_identification_forms/find_code_popup.php",
          "status": "modified",
          "additions": 33,
          "deletions": 37,
          "patch": "@@ -1,21 +1,17 @@\n <?php\n-/********************************************************************************\\\n- * Copyright (C) ViCarePlus, Visolve (vicareplus_engg@visolve.com)              *\n- *                                                                              *\n- * This program is free software; you can redistribute it and/or                *\n- * modify it under the terms of the GNU General Public License                  *\n- * as published by the Free Software Foundation; either version 2               *\n- * of the License, or (at your option) any later version.                       *\n- *                                                                              *\n- * This program is distributed in the hope that it will be useful,              *\n- * but WITHOUT ANY WARRANTY; without even the implied warranty of               *\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                *\n- * GNU General Public License for more details.                                 *\n- *                                                                              *\n- * You should have received a copy of the GNU General Public License            *\n- * along with this program; if not, write to the Free Software                  *\n- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.  *\n- \\********************************************************************************/\n+/**\n+ * find_code_popup.php\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Visolve <vicareplus_engg@visolve.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) ViCarePlus, Visolve <vicareplus_engg@visolve.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n+\n+\n require_once(\"../globals.php\");\n require_once(\"$srcdir/patient.inc\");\n require_once(\"../../custom/code_types.inc.php\");\n@@ -37,14 +33,14 @@\n <script language=\"JavaScript\">\n //pass value selected to the parent window\n  function window_submit(chk)\n- { \n+ {\n   var str;\n   var len=chk.length;\n-  if (len==undefined && chk.checked==1) \n+  if (len==undefined && chk.checked==1)\n   {\n     if(!str)\n       str = chk.value;\n-    else  \n+    else\n     str = \"#\"+chk.value;\n   }\n   else\n@@ -55,7 +51,7 @@ function window_submit(chk)\n     {\n      if(!str)\n       str = chk[pr].value;\n-     else \n+     else\n       str = str+\"#\"+chk[pr].value;\n     }\n    }\n@@ -66,16 +62,16 @@ function window_submit(chk)\n    alert(\"<?php echo xl('The destination form was closed');?>\");\n   else\n    opener.set_related(str,\"diagnosis\");\n-   \n+\n   window.close();\n-  \n+\n  }\n- \n+\n function window_close(chk)\n {\n  window.close();\n }\n- \n+\n function chkbox_select_none(chk)\n {\n  var len=chk.length;\n@@ -111,7 +107,7 @@ function check_search_str()\n   return false;\n  }\n  top.restoreSession();\n- return true; \n+ return true;\n }\n \n </script>\n@@ -130,7 +126,7 @@ function check_search_str()\n    <b>\n <?php\n if ($codetype) {\n-    echo \"<input type='text' name='form_code_type' value='$codetype' size='5' readonly>\\n\";\n+    echo \"<input type='text' name='form_code_type' value='\" . attr($codetype) . \"' size='5' readonly>\\n\";\n } else {\n     echo \"   <select name='form_code_type'\";\n     echo \">\\n\";\n@@ -153,10 +149,10 @@ function check_search_str()\n }\n ?>\n     <?php xl('Search for', 'e'); ?>\n-   <input type='text' name='search_term' id='search_term' size='12' value='<?php echo $_REQUEST['search_term']; ?>'\n+   <input type='text' name='search_term' id='search_term' size='12' value='<?php echo attr($_REQUEST['search_term']); ?>'\n     title='<?php xl('Any part of the desired code or its description', 'e'); ?>' />\n-   &nbsp;  \n-   <input type='submit' name='bn_search' id='bn_search' value='<?php xl('Search', 'e'); ?>' />   \n+   &nbsp;\n+   <input type='submit' name='bn_search' id='bn_search' value='<?php xl('Search', 'e'); ?>' />\n    </b>\n   </td>\n  </tr>\n@@ -187,7 +183,7 @@ function check_search_str()\n             $drug_id = addslashes($row['drug_id']);\n             $selector = addslashes($row['selector']);\n             $desc = addslashes($row['name']);\n-            ?>    \n+            ?>\n              <input type=\"checkbox\" name=\"diagnosis[row_count]\" value= \"<?php echo $desc; ?>\" > <?php echo $drug_id.\"    \".$selector.\"     \".$desc.\"</br>\";\n         }\n     } else {\n@@ -205,7 +201,7 @@ function check_search_str()\n             echo xl('Please enter new search string');?>\");\n           document.theform.search_term.value=\" \";\n              document.theform.search_term.focus();\n-             </script>    \n+             </script>\n                 <?php\n             }\n \n@@ -232,14 +228,14 @@ function check_search_str()\n <center>\n </br>\n  <input type='button' id='select_all' value='<?php xl('Select All', 'e'); ?>' onclick=\"chkbox_select_all(document.select_diagonsis.chkbox);\"/>\n- \n+\n  <input type='button' id='unselect_all' value='<?php xl('Unselect All', 'e'); ?>' onclick=\"chkbox_select_none(document.select_diagonsis.chkbox);\"/>\n- \n+\n  <input type='button' id='submit' value='<?php xl('Submit', 'e'); ?>' onclick=\"window_submit(document.select_diagonsis.chkbox);\"/>\n- \n+\n  <input type='button' id='cancel' value='<?php xl('Cancel', 'e'); ?>' onclick=\"window_close();\"/>\n- \n-</center> \n+\n+</center>\n <?php } ?>\n </form>\n </body>"
        },
        {
          "filename": "interface/de_identification_forms/find_immunization_popup.php",
          "status": "modified",
          "additions": 30,
          "deletions": 34,
          "patch": "@@ -1,21 +1,17 @@\n <?php\n-/********************************************************************************\\\n- * Copyright (C) ViCarePlus, Visolve (vicareplus_engg@visolve.com)              *\n- *                                                                              *\n- * This program is free software; you can redistribute it and/or                *\n- * modify it under the terms of the GNU General Public License                  *\n- * as published by the Free Software Foundation; either version 2               *\n- * of the License, or (at your option) any later version.                       *\n- *                                                                              *\n- * This program is distributed in the hope that it will be useful,              *\n- * but WITHOUT ANY WARRANTY; without even the implied warranty of               *\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                *\n- * GNU General Public License for more details.                                 *\n- *                                                                              *\n- * You should have received a copy of the GNU General Public License            *\n- * along with this program; if not, write to the Free Software                  *\n- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.  *\n- \\********************************************************************************/\n+/**\n+ * find_immunization_popup.php\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Visolve <vicareplus_engg@visolve.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) ViCarePlus, Visolve <vicareplus_engg@visolve.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n+\n+\n require_once(\"../globals.php\");\n require_once(\"$srcdir/patient.inc\");\n require_once(\"../../custom/code_types.inc.php\");\n@@ -35,14 +31,14 @@\n <script language=\"JavaScript\">\n //pass value selected to the parent window\n  function window_submit(chk)\n- { \n+ {\n   var str;\n   var len=chk.length;\n-  if (len==undefined && chk.checked==1) \n+  if (len==undefined && chk.checked==1)\n   {\n     if(!str)\n       str = chk.value;\n-    else  \n+    else\n     str = \"#\"+chk.value;\n   }\n   else\n@@ -53,7 +49,7 @@ function window_submit(chk)\n     {\n      if(!str)\n       str = chk[pr].value;\n-     else \n+     else\n       str = str+\"#\"+chk[pr].value;\n     }\n    }\n@@ -64,16 +60,16 @@ function window_submit(chk)\n    alert(\"<?php echo xl('The destination form was closed');?>\");\n   else\n    opener.set_related(str,\"immunizations\");\n-   \n+\n   window.close();\n-  \n+\n  }\n- \n+\n function window_close(chk)\n {\n  window.close();\n }\n- \n+\n function chkbox_select_none(chk)\n {\n  var len=chk.length;\n@@ -110,7 +106,7 @@ function check_search_str()\n  }\n  top.restoreSession();\n  return true;\n-}   \n+}\n </script>\n </head>\n <body class=\"body_top\">\n@@ -125,10 +121,10 @@ function check_search_str()\n   <td>\n    <b>\n     <?php xl('Search for', 'e'); ?>\n-   <input type='text' name='search_term' id='search_term' size='12' value='<?php echo $_REQUEST['search_term']; ?>'\n+   <input type='text' name='search_term' id='search_term' size='12' value='<?php echo attr($_REQUEST['search_term']); ?>'\n     title='<?php xl('Any part of the immunization id or immunization name', 'e'); ?>' />\n    &nbsp;\n-   <input type='submit' name='bn_search' value='<?php xl('Search', 'e'); ?>' />  \n+   <input type='submit' name='bn_search' value='<?php xl('Search', 'e'); ?>' />\n    </b>\n   </td>\n  </tr>\n@@ -143,7 +139,7 @@ function check_search_str()\n <?php if ($_REQUEST['bn_search']) { ?>\n <table border='0'>\n  <tr>\n-  <td colspan=\"4\">  \n+  <td colspan=\"4\">\n <?php\n   $search_term = $_REQUEST['search_term'];\n   {\n@@ -160,7 +156,7 @@ function check_search_str()\n         echo xl('Please enter new search string');?>\");\n      document.theform.search_term.value=\" \";\n      document.theform.search_term.focus();\n-     </script>    \n+     </script>\n         <?php\n     }\n \n@@ -185,13 +181,13 @@ function check_search_str()\n  </table>\n <center>\n  <input type='button' name='select_all' value='<?php xl('Select All', 'e'); ?>' onclick=\"chkbox_select_all(document.select_immunization.chkbox);\"/>\n- \n+\n  <input type='button' name='select_none' value='<?php xl('Unselect All', 'e'); ?>' onclick=\"chkbox_select_none(document.select_immunization.chkbox);\"/>\n- \n+\n  <input type='button' name='submit' value='<?php xl('Submit', 'e'); ?>' onclick=\"window_submit(document.select_immunization.chkbox);\"/>\n- \n+\n  <input type='button' name='cancel' value='<?php xl('Cancel', 'e'); ?>' onclick=\"window_close();\"/>\n- \n+\n  </center>\n <?php } ?>\n </form>"
        },
        {
          "filename": "interface/fax/fax_dispatch.php",
          "status": "modified",
          "additions": 7,
          "deletions": 2,
          "patch": "@@ -7,10 +7,11 @@\n  * @author    Rod Roark <rod@sunsetsystems.com>\n  * @author    Brady Miller <brady.g.miller@gmail.com>\n  * @copyright Copyright (c) 2006-2010 Rod Roark <rod@sunsetsystems.com>\n- * @copyright Copyright (c) 2017 Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2017-2018 Brady Miller <brady.g.miller@gmail.com>\n  * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n \n+\n require_once(\"../globals.php\");\n require_once(\"$srcdir/patient.inc\");\n require_once(\"$srcdir/pnotes.inc\");\n@@ -22,13 +23,17 @@\n     $mode = 'fax';\n     $filename = $_GET['file'];\n \n-  // ensure the file variable has no illegal characters\n+    // ensure the file variable has no illegal characters\n     check_file_dir_name($filename);\n \n     $filepath = $GLOBALS['hylafax_basedir'] . '/recvq/' . $filename;\n } else if ($_GET['scan']) {\n     $mode = 'scan';\n     $filename = $_GET['scan'];\n+\n+    // ensure the file variable has no illegal characters\n+    check_file_dir_name($filename);\n+\n     $filepath = $GLOBALS['scanner_output_directory'] . '/' . $filename;\n } else {\n     die(\"No filename was given.\");"
        },
        {
          "filename": "interface/forms/CAMOS/view.php",
          "status": "modified",
          "additions": 19,
          "deletions": 17,
          "patch": "@@ -1,30 +1,32 @@\n <?php\n /**\n- * Generated DocBlock\n+ * CAMOS view.php\n  *\n- * @package OpenEMR\n- * @link    http://www.open-emr.org\n- * @author  markleeds <markleeds>\n- * @author  fndtn357 <fndtn357@gmail.com>\n- * @author  cornfeed <jdough823@gmail.com>\n- * @author  cfapress <cfapress>\n- * @author  Wakie87 <scott@npclinics.com.au>\n- * @author  Robert Down <robertdown@live.com>\n- * @author  Brady Miller <brady.g.miller@gmail.com>\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    markleeds <markleeds>\n+ * @author    fndtn357 <fndtn357@gmail.com>\n+ * @author    cornfeed <jdough823@gmail.com>\n+ * @author    cfapress <cfapress>\n+ * @author    Wakie87 <scott@npclinics.com.au>\n+ * @author    Robert Down <robertdown@live.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2008 cfapress <cfapress>\n  * @copyright Copyright (c) 2009 markleeds <markleeds>\n- * @copyright Copyright (c) 2012 fndtn357 <fndtn357@gmail.com>\n  * @copyright Copyright (c) 2011 cornfeed <jdough823@gmail.com>\n- * @copyright Copyright (c) 2008 cfapress <cfapress>\n+ * @copyright Copyright (c) 2012 fndtn357 <fndtn357@gmail.com>\n  * @copyright Copyright (c) 2016 Wakie87 <scott@npclinics.com.au>\n+ * @copyright Copyright (c) 2016-2018 Brady Miller <brady.g.miller@gmail.com>\n  * @copyright Copyright (c) 2017 Robert Down <robertdown@live.com>\n- * @copyright Copyright (c) 2016 Brady Miller <brady.g.miller@gmail.com>\n- * @license https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n+\n+\n ?>\n <!-- view.php -->\n <?php\n-include_once(\"../../globals.php\");\n-include_once(\"../../../library/api.inc\");\n+require_once(\"../../globals.php\");\n+require_once(\"../../../library/api.inc\");\n formHeader(\"Form: CAMOS\");\n $textarea_rows = 22;\n $textarea_cols = 90;\n@@ -71,7 +73,7 @@ function show_edit(t) {\n <link rel=\"stylesheet\" href=\"<?php echo $css_header;?>\" type=\"text/css\">\n </head>\n <body class=\"body_top\">\n-<form method=post action=\"<?php echo $rootdir?>/forms/CAMOS/save.php?mode=delete&id=<?php echo $_GET[\"id\"];?>\" name=\"my_form\">\n+<form method=post action=\"<?php echo $rootdir?>/forms/CAMOS/save.php?mode=delete&id=<?php echo attr($_GET[\"id\"]); ?>\" name=\"my_form\">\n <h1> <?php xl('CAMOS', 'e'); ?> </h1>\n <input type=\"submit\" name=\"delete\" value=\"<?php xl('Delete Selected Items', 'e'); ?>\" />\n <input type=\"submit\" name=\"update\" value=\"<?php xl('Update Selected Items', 'e'); ?>\" />"
        },
        {
          "filename": "interface/forms/reviewofs/view.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -8,7 +8,7 @@\n  * @author    Brady Miller <brady.g.miller@gmail.com>\n  * @author    Robert Down <robertdown@live.com>\n  * @copyright Copyright (c) 2008 cfapress <cfapress>\n- * @copyright Copyright (c) 2016-2017 Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2016-2018 Brady Miller <brady.g.miller@gmail.com>\n  * @copyright Copyright (c) 2017 Robert Down <robertdown@live.com>\n  * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n@@ -40,7 +40,7 @@\n             </div>\n         </div>\n         <div class=\"row\">\n-            <form method=post action=\"<?php echo $rootdir; ?>/forms/reviewofs/save.php?mode=update&id=<?php echo $_GET[\"id\"]; ?>\" name=\"my_form\" onsubmit=\"return top.restoreSession()\">\n+            <form method=post action=\"<?php echo $rootdir; ?>/forms/reviewofs/save.php?mode=update&id=<?php echo attr($_GET[\"id\"]); ?>\" name=\"my_form\" onsubmit=\"return top.restoreSession()\">\n                 <fieldset>\n                     <legend><?php echo xlt('General')?></legend>\n                     <div class=\"row\">"
        },
        {
          "filename": "interface/main/finder/finder_navigation.php",
          "status": "modified",
          "additions": 13,
          "deletions": 2,
          "patch": "@@ -1,5 +1,16 @@\n <?php\n-include_once(\"../../globals.php\");\n+/**\n+ * finder_navigation.php\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n+\n+\n+require_once(\"../../globals.php\");\n ?>\n \n <html>\n@@ -19,7 +30,7 @@\n <tr>\n \n <td style=\"text-align:left; width: 250px; white-space: nowrap;\">\n-<input type=\"textbox\" size=\"10\" name=\"patient\" value=\"<?php echo $_REQUEST['patient']; ?>\" >\n+<input type=\"textbox\" size=\"10\" name=\"patient\" value=\"<?php echo attr($_REQUEST['patient']); ?>\" >\n <select name=\"findBy\">\n <option value=\"Last\" <?php if ($_REQUEST['findBy'] == 'Last') {\n     echo 'selected';"
        },
        {
          "filename": "interface/orders/types.php",
          "status": "modified",
          "additions": 11,
          "deletions": 7,
          "patch": "@@ -1,13 +1,17 @@\n <?php\n /**\n- * Copyright (C) 2010-2012 Rod Roark <rod@sunsetsystems.com>\n+ * types.php\n  *\n- * This program is free software; you can redistribute it and/or\n- * modify it under the terms of the GNU General Public License\n- * as published by the Free Software Foundation; either version 2\n- * of the License, or (at your option) any later version.\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Rod Roark <rod@sunsetsystems.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2010-2012 Rod Roark <rod@sunsetsystems.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n \n+\n require_once(\"../globals.php\");\n require_once(\"$srcdir/acl.inc\");\n \n@@ -248,11 +252,11 @@ function recolor() {\n <form method='post' name='theform' action='types.php?popup=<?php echo $popup ?>&order=<?php\n echo $order;\n if (isset($_GET['formid' ])) {\n-    echo '&formid='  . $_GET['formid'];\n+    echo '&formid='  . attr($_GET['formid']);\n }\n \n if (isset($_GET['formseq'])) {\n-    echo '&formseq=' . $_GET['formseq'];\n+    echo '&formseq=' . attr($_GET['formseq']);\n }\n ?>'>\n "
        },
        {
          "filename": "interface/patient_file/letter.php",
          "status": "modified",
          "additions": 42,
          "deletions": 16,
          "patch": "@@ -1,16 +1,22 @@\n <?php\n-// Copyright (C) 2007-2011 Rod Roark <rod@sunsetsystems.com>\n-//\n-// This program is free software; you can redistribute it and/or\n-// modify it under the terms of the GNU General Public License\n-// as published by the Free Software Foundation; either version 2\n-// of the License, or (at your option) any later version.\n+/**\n+ * letter.php\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Rod Roark <rod@sunsetsystems.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2007-2011 Rod Roark <rod@sunsetsystems.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n+\n+\n+require_once(\"../globals.php\");\n+require_once($GLOBALS['srcdir'] . \"/patient.inc\");\n \n use OpenEMR\\Core\\Header;\n \n-include_once(\"../globals.php\");\n-include_once($GLOBALS['srcdir'] . \"/patient.inc\");\n-\n $template_dir = $GLOBALS['OE_SITE_DIR'] . \"/letter_templates\";\n \n // array of field name tags to allow internationalization\n@@ -199,7 +205,12 @@\n } else if (isset($_GET['template']) && $_GET['template'] != \"\") {\n     // utilized to go back to autosaved template\n     $bodytext = \"\";\n-    $fh = fopen(\"$template_dir/\".$_GET['template'], 'r');\n+    $fh = fopen(\"$template_dir/\" . convert_safe_file_dir_name($_GET['template']), 'r');\n+\n+    if (!$fh) {\n+        die(xlt(\"Requested template does not exist\"));\n+    }\n+\n     while (!feof($fh)) {\n         $bodytext.= fread($fh, 8192);\n     }\n@@ -211,7 +222,12 @@\n     }\n } else if ($_POST['formaction'] == \"loadtemplate\" && $_POST['form_template'] != \"\") {\n     $bodytext = \"\";\n-    $fh = fopen(\"$template_dir/\".$_POST['form_template'], 'r');\n+    $fh = fopen(\"$template_dir/\" . convert_safe_file_dir_name($_POST['form_template']), 'r');\n+\n+    if (!$fh) {\n+        die(xlt(\"Requested template does not exist\"));\n+    }\n+\n     while (!feof($fh)) {\n         $bodytext.= fread($fh, 8192);\n     }\n@@ -223,23 +239,28 @@\n     }\n } else if ($_POST['formaction'] == \"newtemplate\" && $_POST['newtemplatename'] != \"\") {\n     // attempt to save the template\n-    $fh = fopen(\"$template_dir/\".$_POST['newtemplatename'], 'w');\n+    $fh = fopen(\"$template_dir/\" . convert_safe_file_dir_name($_POST['newtemplatename']), 'w');\n     // translate from definition to the constant\n     $temp_bodytext = $_POST['form_body'];\n     foreach ($FIELD_TAG as $key => $value) {\n         $temp_bodytext = str_replace(\"{\".$value.\"}\", \"{\".$key.\"}\", $temp_bodytext);\n     }\n \n     if (! fwrite($fh, $temp_bodytext)) {\n-        echo xlt('Error while writing to file') . ' ' . $template_dir.\"/\".$_POST['newtemplatename'];\n+        echo xlt('Error while writing to file') . ' ' . $template_dir.\"/\" . $_POST['newtemplatename'];\n         die;\n     }\n \n     fclose($fh);\n \n     // read the saved file back\n     $_POST['form_template'] = $_POST['newtemplatename'];\n-    $fh = fopen(\"$template_dir/\".$_POST['form_template'], 'r');\n+    $fh = fopen(\"$template_dir/\" . convert_safe_file_dir_name($_POST['form_template']), 'r');\n+\n+    if (!$fh) {\n+        die(xlt(\"Requested template does not exist\"));\n+    }\n+\n     while (!feof($fh)) {\n         $bodytext.= fread($fh, 8192);\n     }\n@@ -251,7 +272,7 @@\n     }\n } else if ($_POST['formaction'] == \"savetemplate\" && $_POST['form_template'] != \"\") {\n     // attempt to save the template\n-    $fh = fopen(\"$template_dir/\".$_POST['form_template'], 'w');\n+    $fh = fopen(\"$template_dir/\" . convert_safe_file_dir_name($_POST['form_template']), 'w');\n     // translate from definition to the constant\n     $temp_bodytext = $_POST['form_body'];\n     foreach ($FIELD_TAG as $key => $value) {\n@@ -266,7 +287,12 @@\n     fclose($fh);\n \n     // read the saved file back\n-    $fh = fopen(\"$template_dir/\".$_POST['form_template'], 'r');\n+    $fh = fopen(\"$template_dir/\" . convert_safe_file_dir_name($_POST['form_template']), 'r');\n+\n+    if (!$fh) {\n+        die(xlt(\"Requested template does not exist\"));\n+    }\n+\n     while (!feof($fh)) {\n         $bodytext.= fread($fh, 8192);\n     }"
        },
        {
          "filename": "interface/patient_file/transaction/add_transaction.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,7 +7,7 @@\n  * @link      http://www.open-emr.org\n  * @author    Rod Roark <rod@sunsetsystems.com>\n  * @author    Brady Miller <brady.g.miller@gmail.com>\n- * @copyright Copyright (c) 2017 Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2017-2018 Brady Miller <brady.g.miller@gmail.com>\n  * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n \n@@ -24,7 +24,7 @@\n $form_id = $title;\n \n // Plugin support.\n-$fname = $GLOBALS['OE_SITE_DIR'] . \"/LBF/$form_id.plugin.php\";\n+$fname = $GLOBALS['OE_SITE_DIR'] . \"/LBF/\" . convert_safe_file_dir_name($form_id) . \".plugin.php\";\n if (file_exists($fname)) {\n     include_once($fname);\n }"
        },
        {
          "filename": "library/custom_template/personalize.php",
          "status": "modified",
          "additions": 13,
          "deletions": 26,
          "patch": "@@ -1,29 +1,16 @@\n <?php\n-// +-----------------------------------------------------------------------------+\n-// Copyright (C) 2011 Z&H Consultancy Services Private Limited <sam@zhservices.com>\n-//\n-//\n-// This program is free software; you can redistribute it and/or\n-// modify it under the terms of the GNU General Public License\n-// as published by the Free Software Foundation; either version 2\n-// of the License, or (at your option) any later version.\n-//\n-//\n-// This program is distributed in the hope that it will be useful,\n-// but WITHOUT ANY WARRANTY; without even the implied warranty of\n-// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-// GNU General Public License for more details.\n-//\n-//\n-// A copy of the GNU General Public License is included along with this program:\n-// openemr/interface/login/GnuGPL.html\n-// For more information write to the Free Software\n-// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n-//\n-// Author:   Eldho Chacko <eldho@zhservices.com>\n-//           Jacob T Paul <jacob@zhservices.com>\n-//\n-// +------------------------------------------------------------------------------+\n+/**\n+ * personalize.php\n+ *\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Eldho Chacko <eldho@zhservices.com>\n+ * @author    Jacob T Paul <jacob@zhservices.com>\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @copyright Copyright (c) 2011 Z&H Consultancy Services Private Limited <sam@zhservices.com>\n+ * @copyright Copyright (c) 2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ */\n \n \n require_once(\"../../interface/globals.php\");\n@@ -353,7 +340,7 @@ function personalize_save() {\n                 <?php\n                 if (acl_check('nationnotes', 'nn_configure')) {\n                     ?>\n-                    <a href=\"add_template.php?list_id=<?php echo $_REQUEST['list_id']; ?>\"\n+                    <a href=\"add_template.php?list_id=<?php echo attr($_REQUEST['list_id']); ?>\"\n                        onclick=\"top.restoreSession();\" class=\"iframe_small css_button\"\n                        title=\"<?php echo htmlspecialchars(xl('Add Category'), ENT_QUOTES); ?>\"><span><?php echo htmlspecialchars(xl('Add Category'), ENT_QUOTES); ?></span></a>\n                     <?php"
        },
        {
          "filename": "library/sanitize.inc.php",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -3,13 +3,13 @@\n * Function to check and/or sanitize things for security such as\n * directories names, file names, etc.\n  *\n- * @package OpenEMR\n- * @link    http://www.open-emr.org\n- * @author  Brady Miller <brady.g.miller@gmail.com>\n- * @author  Roberto Vasquez <robertogagliotta@gmail.com>\n- * @author  Shachar Zilbershlag <shaharzi@matrix.co.il>\n- * @copyright Copyright (c) 2012-2017 Brady Miller <brady.g.miller@gmail.com>\n- * @license https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n+ * @package   OpenEMR\n+ * @link      http://www.open-emr.org\n+ * @author    Brady Miller <brady.g.miller@gmail.com>\n+ * @author    Roberto Vasquez <robertogagliotta@gmail.com>\n+ * @author    Shachar Zilbershlag <shaharzi@matrix.co.il>\n+ * @copyright Copyright (c) 2012-2018 Brady Miller <brady.g.miller@gmail.com>\n+ * @license   https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3\n  */\n \n \n@@ -28,7 +28,7 @@ function convert_safe_file_dir_name($label)\n     return preg_replace('/[^A-Za-z0-9_.-]/', '_', $label);\n }\n \n-//Basename functionality for nonenglish languages (without this, basename function ommits nonenglish characters).\n+//Basename functionality for nonenglish languages (without this, basename function omits nonenglish characters).\n function basename_international($path)\n {\n     $parts = preg_split('~[\\\\\\\\/]~', $path);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 11,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5a6ce59033e28da4977509da60f4fc0cbf084b43",
            "date": "2025-01-12T07:59:34Z",
            "author_login": "bradymiller"
          },
          {
            "sha": "48858bcad419eb537a0879d8261845df39d793f2",
            "date": "2025-01-10T22:28:46Z",
            "author_login": "stephenwaite"
          },
          {
            "sha": "ee3beb58f73619e04004e526c56423a14d6689fd",
            "date": "2025-01-09T07:11:34Z",
            "author_login": "bradymiller"
          },
          {
            "sha": "1480ee627b317622a122abb293b74be50ad86795",
            "date": "2025-01-08T17:44:10Z",
            "author_login": "sjpadgett"
          },
          {
            "sha": "6a444b1c9ac5773008ab7a6c8fb81a4e9a365e6b",
            "date": "2025-01-06T12:49:47Z",
            "author_login": "NileshHake"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "interface/fax/fax_dispatch.php in OpenEMR before 5.0.1 allows remote authenticated users to bypass intended access restrictions via the scan parameter.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-04-30T17:29:00.360",
    "last_modified": "2024-11-21T03:41:35.210",
    "fix_date": "2018-03-22T15:05:32Z"
  },
  "references": [
    {
      "url": "https://csticsfrontline.wordpress.com/2018/05/24/openemr-%E5%BC%B1%E9%BB%9E%E5%88%86%E6%9E%90/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openemr/openemr/commit/699e3c2ef68545357cac714505df1419b8bf2051",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openemr/openemr/issues/1518",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openemr/openemr/pull/1519",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.open-emr.org/wiki/index.php/Release_Features#Version_5.0.1",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://csticsfrontline.wordpress.com/2018/05/24/openemr-%E5%BC%B1%E9%BB%9E%E5%88%86%E6%9E%90/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openemr/openemr/commit/699e3c2ef68545357cac714505df1419b8bf2051",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openemr/openemr/issues/1518",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openemr/openemr/pull/1519",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.open-emr.org/wiki/index.php/Release_Features#Version_5.0.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:21.846144",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "openemr",
    "owner": "openemr",
    "created_at": "2010-05-21T19:54:08Z",
    "updated_at": "2025-01-12T07:59:39Z",
    "pushed_at": "2025-01-12T07:59:34Z",
    "size": 613406,
    "stars": 3249,
    "forks": 2204,
    "open_issues": 360,
    "watchers": 3249,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "rel-320",
      "rel-400",
      "rel-410",
      "rel-411",
      "rel-412",
      "rel-413",
      "rel-420",
      "rel-421"
    ],
    "languages": {
      "PHP": 38302611,
      "JavaScript": 2254920,
      "XSLT": 1868397,
      "HTML": 1450911,
      "Twig": 590132,
      "CSS": 530442,
      "SCSS": 189517,
      "Mustache": 127165,
      "Perl": 114453,
      "Shell": 79764,
      "Smarty": 70819,
      "Dockerfile": 57349,
      "Makefile": 1915,
      "Roff": 911
    },
    "commit_activity": {
      "total_commits_last_year": 325,
      "avg_commits_per_week": 6.25,
      "days_active_last_year": 161
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:15:48.369791"
  }
}