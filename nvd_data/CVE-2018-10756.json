{
  "cve_id": "CVE-2018-10756",
  "github_data": {
    "repository": "transmission/transmission",
    "fix_commit": "2123adf8e5e1c2b48791f9d22fc8c747e974180e",
    "related_commits": [
      "2123adf8e5e1c2b48791f9d22fc8c747e974180e",
      "2123adf8e5e1c2b48791f9d22fc8c747e974180e"
    ],
    "patch_url": "https://github.com/transmission/transmission/commit/2123adf8e5e1c2b48791f9d22fc8c747e974180e.patch",
    "fix_commit_details": {
      "sha": "2123adf8e5e1c2b48791f9d22fc8c747e974180e",
      "commit_date": "2019-04-28T08:27:33Z",
      "author": {
        "login": "mikedld",
        "type": "User",
        "stats": {
          "total_commits": 1229,
          "average_weekly_commits": 1.2376636455186305,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 225
        }
      },
      "commit_message": {
        "title": "CVE-2018-10756: Fix heap-use-after-free in tr_variantWalk",
        "length": 522,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 14,
        "deletions": 8
      },
      "files": [
        {
          "filename": "libtransmission/variant.c",
          "status": "modified",
          "additions": 14,
          "deletions": 8,
          "patch": "@@ -758,7 +758,7 @@ static int compareKeyIndex(void const* va, void const* vb)\n struct SaveNode\n {\n     tr_variant const* v;\n-    tr_variant sorted;\n+    tr_variant* sorted;\n     size_t childIndex;\n     bool isVisited;\n };\n@@ -783,30 +783,36 @@ static void nodeConstruct(struct SaveNode* node, tr_variant const* v, bool sort_\n \n         qsort(tmp, n, sizeof(struct KeyIndex), compareKeyIndex);\n \n-        tr_variantInitDict(&node->sorted, n);\n+        node->sorted = tr_new(tr_variant, 1);\n+        tr_variantInitDict(node->sorted, n);\n \n         for (size_t i = 0; i < n; ++i)\n         {\n-            node->sorted.val.l.vals[i] = *tmp[i].val;\n+            node->sorted->val.l.vals[i] = *tmp[i].val;\n         }\n \n-        node->sorted.val.l.count = n;\n+        node->sorted->val.l.count = n;\n \n         tr_free(tmp);\n \n-        node->v = &node->sorted;\n+        v = node->sorted;\n     }\n     else\n     {\n-        node->v = v;\n+        node->sorted = NULL;\n     }\n+\n+    node->v = v;\n }\n \n static void nodeDestruct(struct SaveNode* node)\n {\n-    if (node->v == &node->sorted)\n+    TR_ASSERT(node != NULL);\n+\n+    if (node->sorted != NULL)\n     {\n-        tr_free(node->sorted.val.l.vals);\n+        tr_free(node->sorted->val.l.vals);\n+        tr_free(node->sorted);\n     }\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "50eacf693365e96306db15a932ea5f8d70ad69ba",
            "date": "2025-01-09T16:26:48Z",
            "author_login": "reardonia"
          },
          {
            "sha": "cbba2e0390e6972fdc14eb95ef0e28f485aa4112",
            "date": "2025-01-01T14:55:51Z",
            "author_login": "mikedld"
          },
          {
            "sha": "aa9aff113186c64d637b1c955f2b440824c7b7eb",
            "date": "2025-01-01T12:04:53Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "3af627e725c16975cf5142cd5e1a80bfe8211bf2",
            "date": "2024-12-30T18:38:12Z",
            "author_login": "tearfur"
          },
          {
            "sha": "4f88a660a29586b50084835ebfcac248ebd42905",
            "date": "2024-12-30T17:59:41Z",
            "author_login": "Rukario"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-416",
    "description": "Use-after-free in libtransmission/variant.c in Transmission before 3.00 allows remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via a crafted torrent file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-05-15T16:15:11.437",
    "last_modified": "2024-11-21T03:41:59.273",
    "fix_date": "2019-04-28T08:27:33Z"
  },
  "references": [
    {
      "url": "https://github.com/transmission/transmission/commit/2123adf8e5e1c2b48791f9d22fc8c747e974180e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/05/msg00022.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00001.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CD3GLZ5URIK74RCGLSH72IVLDIJJMLQC/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OVAG2HNKNRLWOACFN5F2ANJD2SQ53WI7/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202007-07",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://tomrichards.net/2020/05/cve-2018-10756-transmission/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/transmission/transmission/commit/2123adf8e5e1c2b48791f9d22fc8c747e974180e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/05/msg00022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CD3GLZ5URIK74RCGLSH72IVLDIJJMLQC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OVAG2HNKNRLWOACFN5F2ANJD2SQ53WI7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202007-07",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://tomrichards.net/2020/05/cve-2018-10756-transmission/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.991811",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "transmission",
    "owner": "transmission",
    "created_at": "2015-05-05T23:53:02Z",
    "updated_at": "2025-01-14T14:32:02Z",
    "pushed_at": "2025-01-09T16:26:49Z",
    "size": 131641,
    "stars": 12536,
    "forks": 1236,
    "open_issues": 810,
    "watchers": 12536,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.7x",
      "0.8x",
      "0.9x",
      "1.0x",
      "1.1x",
      "1.2x",
      "1.3x",
      "1.4x",
      "1.5x",
      "1.6x",
      "1.7x",
      "1.8x",
      "1.9x",
      "2.0x",
      "2.1x",
      "2.2x",
      "2.4x",
      "2.7x",
      "2.8x",
      "2.9x",
      "4.0.x"
    ],
    "languages": {
      "C++": 3692095,
      "Objective-C++": 814677,
      "JavaScript": 203151,
      "CMake": 122909,
      "Objective-C": 102051,
      "HTML": 52334,
      "SCSS": 35165,
      "Roff": 33042,
      "PowerShell": 31247,
      "Shell": 10053,
      "Rich Text Format": 7019,
      "CSS": 5997,
      "C": 3376,
      "Batchfile": 958
    },
    "commit_activity": {
      "total_commits_last_year": 323,
      "avg_commits_per_week": 6.211538461538462,
      "days_active_last_year": 119
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:41:03.403444"
  }
}