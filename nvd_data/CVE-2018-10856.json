{
  "cve_id": "CVE-2018-10856",
  "github_data": {
    "repository": "projectatomic/libpod",
    "fix_commit": "bae80a0b663925ec751ad2784ca32989403cdc24",
    "related_commits": [
      "bae80a0b663925ec751ad2784ca32989403cdc24",
      "bae80a0b663925ec751ad2784ca32989403cdc24"
    ],
    "patch_url": "https://github.com/projectatomic/libpod/commit/bae80a0b663925ec751ad2784ca32989403cdc24.patch",
    "fix_commit_details": {
      "sha": "bae80a0b663925ec751ad2784ca32989403cdc24",
      "commit_date": "2018-05-30T17:16:10Z",
      "author": {
        "login": "rhatdan",
        "type": "User",
        "stats": {
          "total_commits": 1561,
          "average_weekly_commits": 4.140583554376658,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 321
        }
      },
      "commit_message": {
        "title": "Clear all caps, except the bounding set, when --user is specified.",
        "length": 428,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 28,
        "deletions": 0
      },
      "files": [
        {
          "filename": "pkg/spec/spec.go",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -388,8 +388,19 @@ func addRlimits(config *CreateConfig, g *generate.Generator) error {\n }\n \n func setupCapabilities(config *CreateConfig, configSpec *spec.Spec) error {\n+\tuseNotRoot := func(user string) bool {\n+\t\tif user == \"\" || user == \"root\" || user == \"0\" {\n+\t\t\treturn false\n+\t\t}\n+\t\treturn true\n+\t}\n+\n \tvar err error\n \tvar caplist []string\n+\tbounding := configSpec.Process.Capabilities.Bounding\n+\tif useNotRoot(config.User) {\n+\t\tconfigSpec.Process.Capabilities.Bounding = caplist\n+\t}\n \tcaplist, err = caps.TweakCapabilities(configSpec.Process.Capabilities.Bounding, config.CapAdd, config.CapDrop)\n \tif err != nil {\n \t\treturn err\n@@ -399,6 +410,14 @@ func setupCapabilities(config *CreateConfig, configSpec *spec.Spec) error {\n \tconfigSpec.Process.Capabilities.Permitted = caplist\n \tconfigSpec.Process.Capabilities.Inheritable = caplist\n \tconfigSpec.Process.Capabilities.Effective = caplist\n+\tconfigSpec.Process.Capabilities.Ambient = caplist\n+\tif useNotRoot(config.User) {\n+\t\tcaplist, err = caps.TweakCapabilities(bounding, config.CapAdd, config.CapDrop)\n+\t\tif err != nil {\n+\t\t\treturn err\n+\t\t}\n+\t}\n+\tconfigSpec.Process.Capabilities.Bounding = caplist\n \treturn nil\n }\n "
        },
        {
          "filename": "test/e2e/run_test.go",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -5,6 +5,7 @@ import (\n \t\"io/ioutil\"\n \t\"os\"\n \t\"path/filepath\"\n+\t\"strings\"\n \n \t\"github.com/mrunalp/fileutils\"\n \t. \"github.com/onsi/ginkgo\"\n@@ -369,6 +370,14 @@ var _ = Describe(\"Podman run\", func() {\n \t\tExpect(session.OutputToString()).To(Equal(\"uid=8(mail) gid=21(ftp)\"))\n \t})\n \n+\tIt(\"podman run with user, verify caps dropped\", func() {\n+\t\tsession := podmanTest.Podman([]string{\"run\", \"--rm\", \"--user=1234\", ALPINE, \"grep\", \"CapEff\", \"/proc/self/status\"})\n+\t\tsession.WaitWithDefaultTimeout()\n+\t\tExpect(session.ExitCode()).To(Equal(0))\n+\t\tcapEff := strings.Split(session.OutputToString(), \" \")\n+\t\tExpect(\"0000000000000000\").To(Equal(capEff[1]))\n+\t})\n+\n \tIt(\"podman run with attach stdin outputs container ID\", func() {\n \t\tsession := podmanTest.Podman([]string{\"run\", \"--attach\", \"stdin\", ALPINE, \"printenv\"})\n \t\tsession.WaitWithDefaultTimeout()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec6b0355bf9c9b90b774707b6adc49a743cbebd4",
            "date": "2025-01-14T18:39:13Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "0d0a78cc6b687e713f7160dcb1e297442e038f60",
            "date": "2025-01-14T12:49:45Z",
            "author_login": "robertgzr"
          },
          {
            "sha": "9f1fee2a0b119024750975e2b16c1a89edc615d9",
            "date": "2025-01-13T17:15:37Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "75b4a1b2aa6c0440cfac61fcd38d70d57a9b1472",
            "date": "2025-01-09T17:46:00Z",
            "author_login": "AhmedMoalla"
          },
          {
            "sha": "11945578fc357225acdf753bc87f8852564286c5",
            "date": "2025-01-10T15:15:11Z",
            "author_login": "openshift-merge-bot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-250",
    "description": "It has been discovered that podman before version 0.6.1 does not drop capabilities when executing a container as a non-root user. This results in unnecessary privileges being granted to the container.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-07-03T01:29:00.643",
    "last_modified": "2024-11-21T03:42:09.173",
    "fix_date": "2018-05-30T17:16:10Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:2037",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10856",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/projectatomic/libpod/commit/bae80a0b663925ec751ad2784ca32989403cdc24",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:2037",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10856",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/projectatomic/libpod/commit/bae80a0b663925ec751ad2784ca32989403cdc24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:28.558413",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "podman",
    "owner": "projectatomic",
    "created_at": "2017-11-01T15:01:27Z",
    "updated_at": "2025-01-14T20:45:26Z",
    "pushed_at": "2025-01-14T18:39:13Z",
    "size": 150858,
    "stars": 24521,
    "forks": 2461,
    "open_issues": 753,
    "watchers": 24521,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v1.0",
      "v1.4.1-crio114",
      "v1.4.2-stable",
      "v1.6",
      "v1.6.4-rhel",
      "v1.9",
      "v2.0",
      "v2.0.5-rhel",
      "v2.1",
      "v2.1.1-rhel",
      "v2.2",
      "v2.2.1-rhel",
      "v3.0",
      "v3.0.1-rhel",
      "v3.1",
      "v3.2",
      "v3.2.3-rhel"
    ],
    "languages": {
      "Go": 8182685,
      "Shell": 1395561,
      "Perl": 211314,
      "Python": 108784,
      "PowerShell": 56174,
      "C": 54393,
      "Makefile": 47235,
      "Dockerfile": 4348,
      "Ruby": 3511,
      "Awk": 570,
      "HTML": 404,
      "Batchfile": 222
    },
    "commit_activity": {
      "total_commits_last_year": 2914,
      "avg_commits_per_week": 56.03846153846154,
      "days_active_last_year": 304
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T21:12:27.333270"
  }
}