{
  "cve_id": "CVE-2018-10887",
  "github_data": {
    "repository": "libgit2/libgit2",
    "fix_commit": "3f461902dc1072acb8b7607ee65d0a0458ffac2a",
    "related_commits": [
      "3f461902dc1072acb8b7607ee65d0a0458ffac2a",
      "c1577110467b701dcbcf9439ac225ea851b47d22",
      "3f461902dc1072acb8b7607ee65d0a0458ffac2a",
      "c1577110467b701dcbcf9439ac225ea851b47d22"
    ],
    "patch_url": "https://github.com/libgit2/libgit2/commit/3f461902dc1072acb8b7607ee65d0a0458ffac2a.patch",
    "fix_commit_details": {
      "sha": "3f461902dc1072acb8b7607ee65d0a0458ffac2a",
      "commit_date": "2018-06-29T05:45:18Z",
      "author": {
        "login": "pks-t",
        "type": "User",
        "stats": {
          "total_commits": 1434,
          "average_weekly_commits": 1.693034238488784,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 185
        }
      },
      "commit_message": {
        "title": "delta: fix sign-extension of big left-shift",
        "length": 1979,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 45,
        "additions": 28,
        "deletions": 17
      },
      "files": [
        {
          "filename": "src/delta.c",
          "status": "modified",
          "additions": 15,
          "deletions": 17,
          "patch": "@@ -539,10 +539,11 @@ int git_delta_apply(\n \t*out = NULL;\n \t*out_len = 0;\n \n-\t/* Check that the base size matches the data we were given;\n-\t* if not we would underflow while accessing data from the\n-\t* base object, resulting in data corruption or segfault.\n-\t*/\n+\t/*\n+\t * Check that the base size matches the data we were given;\n+\t * if not we would underflow while accessing data from the\n+\t * base object, resulting in data corruption or segfault.\n+\t */\n \tif ((hdr_sz(&base_sz, &delta, delta_end) < 0) || (base_sz != base_len)) {\n \t\tgiterr_set(GITERR_INVALID, \"failed to apply delta: base size does not match given data\");\n \t\treturn -1;\n@@ -564,42 +565,39 @@ int git_delta_apply(\n \twhile (delta < delta_end) {\n \t\tunsigned char cmd = *delta++;\n \t\tif (cmd & 0x80) {\n-\t\t\t/* cmd is a copy instruction; copy from the base.\n-\t\t\t*/\n+\t\t\t/* cmd is a copy instruction; copy from the base. */\n \t\t\tsize_t off = 0, len = 0;\n \n \t\t\tif (cmd & 0x01) off = *delta++;\n \t\t\tif (cmd & 0x02) off |= *delta++ << 8UL;\n \t\t\tif (cmd & 0x04) off |= *delta++ << 16UL;\n-\t\t\tif (cmd & 0x08) off |= *delta++ << 24UL;\n+\t\t\tif (cmd & 0x08) off |= ((unsigned) *delta++ << 24UL);\n \n \t\t\tif (cmd & 0x10) len = *delta++;\n \t\t\tif (cmd & 0x20) len |= *delta++ << 8UL;\n \t\t\tif (cmd & 0x40) len |= *delta++ << 16UL;\n-\t\t\tif (!len)\t\tlen = 0x10000;\n+\t\t\tif (!len)       len = 0x10000;\n \n \t\t\tif (base_len < off + len || res_sz < len)\n \t\t\t\tgoto fail;\n \t\t\tmemcpy(res_dp, base + off, len);\n \t\t\tres_dp += len;\n \t\t\tres_sz -= len;\n \n-\t\t}\n-\t\telse if (cmd) {\n-\t\t\t/* cmd is a literal insert instruction; copy from\n-\t\t\t* the delta stream itself.\n-\t\t\t*/\n+\t\t} else if (cmd) {\n+\t\t\t/*\n+\t\t\t * cmd is a literal insert instruction; copy from\n+\t\t\t * the delta stream itself.\n+\t\t\t */\n \t\t\tif (delta_end - delta < cmd || res_sz < cmd)\n \t\t\t\tgoto fail;\n \t\t\tmemcpy(res_dp, delta, cmd);\n \t\t\tdelta += cmd;\n \t\t\tres_dp += cmd;\n \t\t\tres_sz -= cmd;\n \n-\t\t}\n-\t\telse {\n-\t\t\t/* cmd == 0 is reserved for future encodings.\n-\t\t\t*/\n+\t\t} else {\n+\t\t\t/* cmd == 0 is reserved for future encodings. */\n \t\t\tgoto fail;\n \t\t}\n \t}"
        },
        {
          "filename": "tests/delta/apply.c",
          "status": "added",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -0,0 +1,12 @@\n+#include \"clar_libgit2.h\"\n+\n+#include \"delta.h\"\n+\n+void test_delta_apply__read_at_off(void)\n+{\n+\tunsigned char base[16] = { 0 }, delta[] = { 0x10, 0x10, 0xff, 0xff, 0xff, 0xff, 0xff, 0x10, 0x00, 0x00 };\n+\tvoid *out;\n+\tsize_t outlen;\n+\n+\tcl_git_fail(git_delta_apply(&out, &outlen, base, sizeof(base), delta, sizeof(delta)));\n+}"
        },
        {
          "filename": "tests/diff/binary.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -3,6 +3,7 @@\n #include \"git2/sys/diff.h\"\n \n #include \"buffer.h\"\n+#include \"delta.h\"\n #include \"filebuf.h\"\n #include \"repository.h\"\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9692f45ca8d9286da96e8849cf75460382e7d02d",
            "date": "2025-01-14T15:45:52Z",
            "author_login": "ethomson"
          },
          {
            "sha": "f9e9ddd88400311d203ed4a9f86f3862abaec7a1",
            "date": "2025-01-14T12:48:28Z",
            "author_login": "ethomson"
          },
          {
            "sha": "7daaf6151a630cf0c6f2a3cda2f78a313fb6ec94",
            "date": "2025-01-13T23:19:48Z",
            "author_login": "ethomson"
          },
          {
            "sha": "02435d7647619107f90871b7c9420f9ec00b0805",
            "date": "2025-01-10T22:35:55Z",
            "author_login": "ethomson"
          },
          {
            "sha": "9c2b827cefb070c8dbbeea521d89473d082b8e1b",
            "date": "2025-01-10T22:28:05Z",
            "author_login": "ethomson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:H",
    "cwe_id": "CWE-194",
    "description": "A flaw was found in libgit2 before version 0.27.3. It has been discovered that an unexpected sign extension in git_delta_apply function in delta.c file may lead to an integer overflow which in turn leads to an out of bound read, allowing to read before the base object. An attacker may use this flaw to leak memory addresses or cause a Denial of Service.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2018-07-10T14:29:00.260",
    "last_modified": "2024-11-21T03:42:13.670",
    "fix_date": "2018-06-29T05:45:18Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1598021",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/3f461902dc1072acb8b7607ee65d0a0458ffac2a",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/c1577110467b701dcbcf9439ac225ea851b47d22",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/releases/tag/v0.27.3",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Release Notes"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/08/msg00024.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/03/msg00031.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1598021",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/3f461902dc1072acb8b7607ee65d0a0458ffac2a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/c1577110467b701dcbcf9439ac225ea851b47d22",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/releases/tag/v0.27.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/08/msg00024.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/03/msg00031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:28.631904",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libgit2",
    "owner": "libgit2",
    "created_at": "2010-09-10T16:17:48Z",
    "updated_at": "2025-01-14T07:38:21Z",
    "pushed_at": "2025-01-14T12:48:46Z",
    "size": 72477,
    "stars": 9776,
    "forks": 2431,
    "open_issues": 439,
    "watchers": 9776,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 8196097,
      "Perl": 112049,
      "JavaScript": 93351,
      "CMake": 87027,
      "Shell": 57464,
      "Python": 20757,
      "Awk": 16256,
      "PHP": 5691
    },
    "commit_activity": {
      "total_commits_last_year": 573,
      "avg_commits_per_week": 11.01923076923077,
      "days_active_last_year": 141
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:39:41.885143"
  }
}