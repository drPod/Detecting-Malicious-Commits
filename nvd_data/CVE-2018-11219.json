{
  "cve_id": "CVE-2018-11219",
  "github_data": {
    "repository": "antirez/redis",
    "fix_commit": "1eb08bcd4634ae42ec45e8284923ac048beaa4c3",
    "related_commits": [
      "1eb08bcd4634ae42ec45e8284923ac048beaa4c3",
      "e89086e09a38cc6713bcd4b9c29abf92cf393936",
      "1eb08bcd4634ae42ec45e8284923ac048beaa4c3",
      "e89086e09a38cc6713bcd4b9c29abf92cf393936"
    ],
    "patch_url": "https://github.com/antirez/redis/commit/1eb08bcd4634ae42ec45e8284923ac048beaa4c3.patch",
    "fix_commit_details": {
      "sha": "1eb08bcd4634ae42ec45e8284923ac048beaa4c3",
      "commit_date": "2018-05-14T15:49:06Z",
      "author": {
        "login": "antirez",
        "type": "User",
        "stats": {
          "total_commits": 7037,
          "average_weekly_commits": 8.519370460048426,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 522
        }
      },
      "commit_message": {
        "title": "Security: update Lua struct package for security.",
        "length": 545,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 23,
        "deletions": 23
      },
      "files": [
        {
          "filename": "deps/lua/src/lua_struct.c",
          "status": "modified",
          "additions": 23,
          "deletions": 23,
          "patch": "@@ -1,7 +1,7 @@\n /*\n ** {======================================================\n ** Library for packing/unpacking structures.\n-** $Id: struct.c,v 1.4 2012/07/04 18:54:29 roberto Exp $\n+** $Id: struct.c,v 1.7 2018/05/11 22:04:31 roberto Exp $\n ** See Copyright Notice at the end of this file\n ** =======================================================\n */\n@@ -15,8 +15,8 @@\n ** h/H - signed/unsigned short\n ** l/L - signed/unsigned long\n ** T   - size_t\n-** i/In - signed/unsigned integer with size `n' (default is size of int)\n-** cn - sequence of `n' chars (from/to a string); when packing, n==0 means\n+** i/In - signed/unsigned integer with size 'n' (default is size of int)\n+** cn - sequence of 'n' chars (from/to a string); when packing, n==0 means\n         the whole string; when unpacking, n==0 means use the previous\n         read number as the string length\n ** s - zero-terminated string\n@@ -89,14 +89,12 @@ typedef struct Header {\n } Header;\n \n \n-static int getnum (lua_State *L, const char **fmt, int df) {\n+static int getnum (const char **fmt, int df) {\n   if (!isdigit(**fmt))  /* no number? */\n     return df;  /* return default value */\n   else {\n     int a = 0;\n     do {\n-      if (a > (INT_MAX / 10) || a * 10 > (INT_MAX - (**fmt - '0')))\n-        luaL_error(L, \"integral size overflow\");\n       a = a*10 + *((*fmt)++) - '0';\n     } while (isdigit(**fmt));\n     return a;\n@@ -117,9 +115,9 @@ static size_t optsize (lua_State *L, char opt, const char **fmt) {\n     case 'f':  return sizeof(float);\n     case 'd':  return sizeof(double);\n     case 'x': return 1;\n-    case 'c': return getnum(L, fmt, 1);\n+    case 'c': return getnum(fmt, 1);\n     case 'i': case 'I': {\n-      int sz = getnum(L, fmt, sizeof(int));\n+      int sz = getnum(fmt, sizeof(int));\n       if (sz > MAXINTSIZE)\n         luaL_error(L, \"integral size %d is larger than limit of %d\",\n                        sz, MAXINTSIZE);\n@@ -152,7 +150,7 @@ static void controloptions (lua_State *L, int opt, const char **fmt,\n     case '>': h->endian = BIG; return;\n     case '<': h->endian = LITTLE; return;\n     case '!': {\n-      int a = getnum(L, fmt, MAXALIGN);\n+      int a = getnum(fmt, MAXALIGN);\n       if (!isp2(a))\n         luaL_error(L, \"alignment %d is not a power of 2\", a);\n       h->align = a;\n@@ -296,20 +294,21 @@ static int b_unpack (lua_State *L) {\n   size_t ld;\n   const char *data = luaL_checklstring(L, 2, &ld);\n   size_t pos = luaL_optinteger(L, 3, 1) - 1;\n+  int n = 0;  /* number of results */\n   defaultoptions(&h);\n-  lua_settop(L, 2);\n   while (*fmt) {\n     int opt = *fmt++;\n     size_t size = optsize(L, opt, &fmt);\n     pos += gettoalign(pos, &h, opt, size);\n     luaL_argcheck(L, pos+size <= ld, 2, \"data string too short\");\n-    luaL_checkstack(L, 1, \"too many results\");\n+    /* stack space for item + next position */\n+    luaL_checkstack(L, 2, \"too many results\");\n     switch (opt) {\n       case 'b': case 'B': case 'h': case 'H':\n       case 'l': case 'L': case 'T': case 'i':  case 'I': {  /* integer types */\n         int issigned = islower(opt);\n         lua_Number res = getinteger(data+pos, h.endian, issigned, size);\n-        lua_pushnumber(L, res);\n+        lua_pushnumber(L, res); n++;\n         break;\n       }\n       case 'x': {\n@@ -319,41 +318,42 @@ static int b_unpack (lua_State *L) {\n         float f;\n         memcpy(&f, data+pos, size);\n         correctbytes((char *)&f, sizeof(f), h.endian);\n-        lua_pushnumber(L, f);\n+        lua_pushnumber(L, f); n++;\n         break;\n       }\n       case 'd': {\n         double d;\n         memcpy(&d, data+pos, size);\n         correctbytes((char *)&d, sizeof(d), h.endian);\n-        lua_pushnumber(L, d);\n+        lua_pushnumber(L, d); n++;\n         break;\n       }\n       case 'c': {\n         if (size == 0) {\n-          if (!lua_isnumber(L, -1))\n-            luaL_error(L, \"format `c0' needs a previous size\");\n+          if (n == 0 || !lua_isnumber(L, -1))\n+            luaL_error(L, \"format 'c0' needs a previous size\");\n           size = lua_tonumber(L, -1);\n-          lua_pop(L, 1);\n-          luaL_argcheck(L, pos+size <= ld, 2, \"data string too short\");\n+          lua_pop(L, 1); n--;\n+          luaL_argcheck(L, size <= ld && pos <= ld - size,\n+                           2, \"data string too short\");\n         }\n-        lua_pushlstring(L, data+pos, size);\n+        lua_pushlstring(L, data+pos, size); n++;\n         break;\n       }\n       case 's': {\n         const char *e = (const char *)memchr(data+pos, '\\0', ld - pos);\n         if (e == NULL)\n           luaL_error(L, \"unfinished string in data\");\n         size = (e - (data+pos)) + 1;\n-        lua_pushlstring(L, data+pos, size - 1);\n+        lua_pushlstring(L, data+pos, size - 1); n++;\n         break;\n       }\n       default: controloptions(L, opt, &fmt, &h);\n     }\n     pos += size;\n   }\n-  lua_pushinteger(L, pos + 1);\n-  return lua_gettop(L) - 2;\n+  lua_pushinteger(L, pos + 1);  /* next position */\n+  return n + 1;\n }\n \n \n@@ -399,7 +399,7 @@ LUALIB_API int luaopen_struct (lua_State *L) {\n \n \n /******************************************************************************\n-* Copyright (C) 2010-2012 Lua.org, PUC-Rio.  All rights reserved.\n+* Copyright (C) 2010-2018 Lua.org, PUC-Rio.  All rights reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0f65806b5b0f21b96e9c688ce7d2d00062203a51",
            "date": "2025-01-14T09:30:18Z",
            "author_login": "sundb"
          },
          {
            "sha": "5b8b58e472fc567337429f63e93927f86db7f838",
            "date": "2025-01-14T07:51:05Z",
            "author_login": "ShooterIT"
          },
          {
            "sha": "342ee426ad0d0731b2272553bd4db2cd78e24772",
            "date": "2024-12-15T19:41:45Z",
            "author_login": "YaacovHazan"
          },
          {
            "sha": "4a95b3005a140165bbb9df373ba61f775c936554",
            "date": "2024-12-15T09:27:48Z",
            "author_login": "YaacovHazan"
          },
          {
            "sha": "73a9b916c9f42f2e07b9338a975f9a473ad0cd9b",
            "date": "2025-01-13T12:09:52Z",
            "author_login": "tezc"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "An Integer Overflow issue was discovered in the struct library in the Lua subsystem in Redis before 3.2.12, 4.x before 4.0.10, and 5.x before 5.0 RC2, leading to a failure of bounds checking.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-06-17T17:29:00.337",
    "last_modified": "2024-11-21T03:42:55.570",
    "fix_date": "2018-05-14T15:49:06Z"
  },
  "references": [
    {
      "url": "http://antirez.com/news/119",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/104552",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0052",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0094",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:1860",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/antirez/redis/commit/1eb08bcd4634ae42ec45e8284923ac048beaa4c3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/antirez/redis/commit/e89086e09a38cc6713bcd4b9c29abf92cf393936",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/antirez/redis/issues/5017",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://raw.githubusercontent.com/antirez/redis/4.0/00-RELEASENOTES",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201908-04",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4230",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://antirez.com/news/119",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/104552",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0052",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0094",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:1860",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/antirez/redis/commit/1eb08bcd4634ae42ec45e8284923ac048beaa4c3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/antirez/redis/commit/e89086e09a38cc6713bcd4b9c29abf92cf393936",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/antirez/redis/issues/5017",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://raw.githubusercontent.com/antirez/redis/4.0/00-RELEASENOTES",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://raw.githubusercontent.com/antirez/redis/5.0/00-RELEASENOTES",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201908-04",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4230",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:28.537330",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "redis",
    "owner": "antirez",
    "created_at": "2009-03-21T22:32:25Z",
    "updated_at": "2025-01-14T14:56:41Z",
    "pushed_at": "2025-01-14T13:24:52Z",
    "size": 142869,
    "stars": 67707,
    "forks": 23864,
    "open_issues": 2530,
    "watchers": 67707,
    "has_security_policy": false,
    "default_branch": "unstable",
    "protected_branches": [
      "2.2",
      "2.4",
      "2.6",
      "2.8",
      "3.0",
      "3.2",
      "4.0",
      "5.0",
      "6.0",
      "6.2",
      "7.0",
      "7.2",
      "7.4",
      "8.0",
      "LiorKogan-patch-1",
      "LiorKogan-patch-2",
      "acl-api-pr",
      "acl-log",
      "antiaffinity",
      "aofrdb",
      "argv-accounting",
      "arm",
      "client-unblock",
      "conduct",
      "cow-pipe",
      "csc2",
      "current-client-fix",
      "dict-clustered-entries",
      "dict-split-by-slot"
    ],
    "languages": {
      "C": 6937367,
      "Tcl": 2354158,
      "Python": 40222,
      "Makefile": 26062,
      "Shell": 23597,
      "Ruby": 23260,
      "C++": 5987,
      "Smarty": 1047,
      "JavaScript": 953
    },
    "commit_activity": {
      "total_commits_last_year": 425,
      "avg_commits_per_week": 8.173076923076923,
      "days_active_last_year": 171
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:14:19.005029"
  }
}