{
  "cve_id": "CVE-2018-11562",
  "github_data": {
    "repository": "MISP/MISP",
    "fix_commit": "10080096879d1076756f62760d6daf582b6db722",
    "related_commits": [
      "10080096879d1076756f62760d6daf582b6db722",
      "10080096879d1076756f62760d6daf582b6db722"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "10080096879d1076756f62760d6daf582b6db722",
      "commit_date": "2018-05-30T13:02:15Z",
      "author": {
        "login": "iglocska",
        "type": "User",
        "stats": {
          "total_commits": 9409,
          "average_weekly_commits": 13.656023222060957,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 546
        }
      },
      "commit_message": {
        "title": "fix: Reflected XSS via the event view",
        "length": 240,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "app/View/Elements/eventattribute.ctp",
          "status": "modified",
          "additions": 9,
          "deletions": 2,
          "patch": "@@ -1,4 +1,11 @@\n <?php\n+\t$urlHere = $this->here;\n+\t$urlHere = explode('/', $urlHere);\n+\tforeach ($urlHere as $k => $v) {\n+\t\t$urlHere[$k] = urlencode($v);\n+\t}\n+\t$urlHere = implode('/', $urlHere);\n+\t$urlHere = $baseurl . $urlHere;\n \t$mayModify = ($isSiteAdmin || ($isAclModify && $event['Event']['user_id'] == $me['id'] && $event['Orgc']['id'] == $me['org_id']) || ($isAclModifyOrg && $event['Orgc']['id'] == $me['org_id']));\n \t$mayPublish = ($isAclPublish && $event['Orgc']['id'] == $me['org_id']);\n \t$mayChangeCorrelation = !Configure::read('MISP.completely_disable_correlation') && ($isSiteAdmin || ($mayModify && Configure::read('MISP.allow_disabling_correlation')));\n@@ -138,7 +145,7 @@\n \t\t<div id=\"filter_correlation\" title=\"Only show correlating attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show correlating attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'correlation') echo '_active'; ?>\" onClick=\"filterAttributes('correlation', '<?php echo h($event['Event']['id']); ?>');\">Correlation</div>\n \t\t<div id=\"filter_warning\" title=\"Only show potentially false positive attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show potentially false positive attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'warning') echo '_active'; ?>\" onClick=\"filterAttributes('warning', '<?php echo h($event['Event']['id']); ?>');\">Warnings</div>\n \t\t<?php if ($me['Role']['perm_sync'] || $event['Orgc']['id'] == $me['org_id']): ?>\n-\t\t\t<div id=\"filter_deleted\" title=\"Include deleted attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Include deleted attributes\" class=\"attribute_filter_text<?php if ($deleted) echo '_active'; ?>\" onClick=\"toggleDeletedAttributes('<?php echo Router::url( $this->here, true );?>');\">Include deleted attributes</div>\n+\t\t\t<div id=\"filter_deleted\" title=\"Include deleted attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Include deleted attributes\" class=\"attribute_filter_text<?php if ($deleted) echo '_active'; ?>\" onClick=\"toggleDeletedAttributes('<?php echo $urlHere;?>');\">Include deleted attributes</div>\n \t\t<?php endif; ?>\n \t\t<div id=\"show_context\" title=\"Show attribute context fields\" role=\"button\" tabindex=\"0\" aria-label=\"Show attribute context fields\" class=\"attribute_filter_text\" onClick=\"toggleContextFields();\">Show context fields</div>\n \t\t<div title=\"input filter\" tabindex=\"0\" aria-label=\"input filter\" class=\"attribute_filter_text\" style=\"padding-top:0px;\">\n@@ -168,7 +175,7 @@\n \t\t\t?>\n \t\t\t\t\t<th class=\"event_id\"><?php echo $this->Paginator->sort('event_id', 'Event');?></th>\n \t\t\t<?php\n-\t\tendif;\n+\t\t\t\tendif;\n \t\t\t?>\n \t\t\t<th><?php echo $this->Paginator->sort('Org.name', 'Org'); ?>\n \t\t\t<th><?php echo $this->Paginator->sort('category');?></th>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8031c316958fe138f7e7454996461f706f5de65b",
            "date": "2025-01-24T21:43:57Z",
            "author_login": "adulau"
          },
          {
            "sha": "075ac07928928b85b0e6ba16ff8bb257c2a43f31",
            "date": "2025-01-23T18:28:16Z",
            "author_login": "DocArmoryTech"
          },
          {
            "sha": "0bed57728fdf15e55138e3cc5bf77c9416d9f4ee",
            "date": "2025-01-17T13:24:52Z",
            "author_login": "iglocska"
          },
          {
            "sha": "ae8e0623697977dbcdb625b8cb8c287ccb3060a1",
            "date": "2025-01-17T13:17:58Z",
            "author_login": "iglocska"
          },
          {
            "sha": "ba58d0318443b3fa565d4c290d1e3b70bebf8022",
            "date": "2025-01-16T10:39:00Z",
            "author_login": "adulau"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "An issue was discovered in MISP 2.4.91. A vulnerability in app/View/Elements/eventattribute.ctp allows reflected XSS if a user clicks on a malicious link for an event view and then clicks on the deleted attributes quick filter.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-05-30T20:29:00.313",
    "last_modified": "2024-11-21T03:43:37.383",
    "fix_date": "2018-05-30T13:02:15Z"
  },
  "references": [
    {
      "url": "https://github.com/MISP/MISP/commit/10080096879d1076756f62760d6daf582b6db722",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MISP/MISP/commit/10080096879d1076756f62760d6daf582b6db722",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:25.866421",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "MISP",
    "owner": "MISP",
    "created_at": "2013-02-07T17:10:34Z",
    "updated_at": "2025-01-25T09:46:55Z",
    "pushed_at": "2025-01-24T21:43:57Z",
    "size": 158413,
    "stars": 5488,
    "forks": 1426,
    "open_issues": 2649,
    "watchers": 5488,
    "has_security_policy": false,
    "default_branch": "2.5",
    "protected_branches": [
      "2.4",
      "3.x"
    ],
    "languages": {
      "PHP": 9033626,
      "JavaScript": 1901843,
      "Python": 401628,
      "CSS": 156405,
      "Shell": 105142,
      "Perl": 6169,
      "Makefile": 759
    },
    "commit_activity": {
      "total_commits_last_year": 1591,
      "avg_commits_per_week": 30.596153846153847,
      "days_active_last_year": 224
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T07:39:48.002351"
  }
}