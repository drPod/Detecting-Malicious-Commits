{
  "cve_id": "CVE-2018-11647",
  "github_data": {
    "repository": "jaredhanson/oauth2orize-fprm",
    "fix_commit": "2bf9faee787eb004abbdfb6f4cc2fb06653defd5",
    "related_commits": [
      "2bf9faee787eb004abbdfb6f4cc2fb06653defd5",
      "2bf9faee787eb004abbdfb6f4cc2fb06653defd5"
    ],
    "patch_url": "https://github.com/jaredhanson/oauth2orize-fprm/commit/2bf9faee787eb004abbdfb6f4cc2fb06653defd5.patch",
    "fix_commit_details": {
      "sha": "2bf9faee787eb004abbdfb6f4cc2fb06653defd5",
      "commit_date": "2018-05-01T20:24:35Z",
      "author": {
        "login": "jaredhanson",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #4 from MarcinHoppe/fix-number-encoding",
        "length": 106,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 10,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/index.js",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -27,7 +27,12 @@ exports = module.exports = function (txn, res, params) {\n   var inputs = [];\n   \n   Object.keys(params).forEach(function (k) {\n-    inputs.push(input.replace('{NAME}', k).replace('{VALUE}', entities.encode(params[k])));\n+    var encoded = params[k];\n+    if (typeof params[k] === 'string') {\n+      encoded = entities.encode(params[k]);\n+    }\n+\n+    inputs.push(input.replace('{NAME}', k).replace('{VALUE}', encoded));\n    });\n \n   res.setHeader('Content-Type', 'text/html;charset=UTF-8');"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"oauth2orize-fprm\",\n-  \"version\": \"0.2.0\",\n+  \"version\": \"0.2.1\",\n   \"description\": \"Form Post response mode support for OAuth2orize.\",\n   \"keywords\": [\n     \"oauth2\","
        },
        {
          "filename": "test/package.test.js",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -74,7 +74,8 @@ nrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc\\\n             scope: '\"></a>openid email user_metadata',\n             response_mode: '\"></a>form_post',\n             state: req.oauth2.req.state,\n-            id_token: '\"></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw'\n+            id_token: '\"></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw',\n+            expires_in: 86400\n           };\n \n           fprm(req.oauth2, res, params);\n@@ -100,6 +101,7 @@ nrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc\\\n <input type=\"hidden\" name=\"response_mode\" value=\"&quot;&gt;&lt;/a&gt;form_post\"/>\\\n <input type=\"hidden\" name=\"state\" value=\"&quot;&gt;&lt;/a&gt;DcP7csa3hMlvybERqcieLHrRzKBra\"/>\\\n <input type=\"hidden\" name=\"id_token\" value=\"&quot;&gt;&lt;/a&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw\"/>\\\n+<input type=\"hidden\" name=\"expires_in\" value=\"86400\"/>\\\n </form></body></html>');\n     });\n   });"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3f5c6148f45686c1ae1354d7854aed5b9f134771",
            "date": "2021-11-29T17:40:15Z",
            "author_login": "jaredhanson"
          },
          {
            "sha": "9add035a5ce8e8d5f5582fea09f5976c8a60c6f0",
            "date": "2021-11-29T17:34:18Z",
            "author_login": "jaredhanson"
          },
          {
            "sha": "ad03d3501061af57ed091fc1db2ead07dd1f1c51",
            "date": "2019-05-25T21:14:36Z",
            "author_login": "jaredhanson"
          },
          {
            "sha": "fa2aa9bf9722b000e194959cc4c95df2f3ea4155",
            "date": "2018-10-15T20:14:08Z",
            "author_login": "jaredhanson"
          },
          {
            "sha": "27be8f9e8e6b4c97e39b22006622a92253d69631",
            "date": "2018-10-09T00:36:35Z",
            "author_login": "jaredhanson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "index.js in oauth2orize-fprm before 0.2.1 has XSS via a crafted URL.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-06-17T16:29:00.330",
    "last_modified": "2024-11-21T03:43:46.093",
    "fix_date": "2018-05-01T20:24:35Z"
  },
  "references": [
    {
      "url": "https://github.com/jaredhanson/oauth2orize-fprm/blob/master/SECURITY-NOTICE.md",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jaredhanson/oauth2orize-fprm/commit/2bf9faee787eb004abbdfb6f4cc2fb06653defd5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jaredhanson/oauth2orize-fprm/blob/master/SECURITY-NOTICE.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jaredhanson/oauth2orize-fprm/commit/2bf9faee787eb004abbdfb6f4cc2fb06653defd5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:28.536613",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "oauth2orize-fprm",
    "owner": "jaredhanson",
    "created_at": "2015-10-31T03:24:15Z",
    "updated_at": "2021-11-29T17:40:23Z",
    "pushed_at": "2021-11-29T17:40:20Z",
    "size": 30,
    "stars": 3,
    "forks": 7,
    "open_issues": 0,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 8749,
      "Makefile": 1704
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:43:47.650422"
  }
}