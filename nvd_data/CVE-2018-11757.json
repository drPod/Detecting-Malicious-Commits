{
  "cve_id": "CVE-2018-11757",
  "github_data": {
    "repository": "apache/incubator-openwhisk-runtime-docker",
    "fix_commit": "891896f25c39bc336ef6dda53f80f466ac4ca3c8",
    "related_commits": [
      "891896f25c39bc336ef6dda53f80f466ac4ca3c8",
      "891896f25c39bc336ef6dda53f80f466ac4ca3c8"
    ],
    "patch_url": "https://github.com/apache/incubator-openwhisk-runtime-docker/commit/891896f25c39bc336ef6dda53f80f466ac4ca3c8.patch",
    "fix_commit_details": {
      "sha": "891896f25c39bc336ef6dda53f80f466ac4ca3c8",
      "commit_date": "2018-07-05T19:19:21Z",
      "author": {
        "login": "rabbah",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Do not allow re-init of the action exec.",
        "length": 230,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
      },
      "files": [
        {
          "filename": "core/actionProxy/actionproxy.py",
          "status": "modified",
          "additions": 12,
          "deletions": 1,
          "patch": "@@ -203,16 +203,26 @@ def initCodeFromZip(self, message):\n \n proxy = flask.Flask(__name__)\n proxy.debug = False\n+# disable re-initialization of the executable unless explicitly allowed via an environment\n+# variable PROXY_ALLOW_REINIT == \"1\" (this is generally useful for local testing and development)\n+proxy.rejectReinit = 'PROXY_ALLOW_REINIT' not in os.environ or os.environ['PROXY_ALLOW_REINIT'] != \"1\"\n+proxy.initialized = False\n runner = None\n \n-\n def setRunner(r):\n     global runner\n     runner = r\n \n \n @proxy.route('/init', methods=['POST'])\n def init():\n+    if proxy.rejectReinit is True and proxy.initialized is True:\n+        msg = 'Cannot initialize the action more than once.'\n+        sys.stderr.write(msg + '\\n')\n+        response = flask.jsonify({'error': msg})\n+        response.status_code = 403\n+        return complete(response)\n+\n     message = flask.request.get_json(force=True, silent=True)\n     if message and not isinstance(message, dict):\n         flask.abort(404)\n@@ -228,6 +238,7 @@ def init():\n         status = False\n \n     if status is True:\n+        proxy.initialized = True\n         return ('OK', 200)\n     else:\n         response = flask.jsonify({'error': 'The action failed to generate or locate a binary. See logs for details.'})"
        },
        {
          "filename": "tests/src/test/scala/runtime/actionContainers/ActionProxyContainerTests.scala",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -245,4 +245,5 @@ class ActionProxyContainerTests extends BasicActionRunnerTests with WskActorSyst\n   testUnicode(stdUnicodeSamples)\n   testEnv(stdEnvSamples)\n   testLargeInput(stdLargeInputSamples)\n+  testInitCannotBeCalledMoreThanOnce(codeNotReturningJson) // any code sample will do\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "84037281ae006b6dee93942f83a49d2b6af920ba",
            "date": "2024-09-24T14:21:47Z",
            "author_login": "jbampton"
          },
          {
            "sha": "64943d7cfb393b6d4d137569f502e61a0efd212e",
            "date": "2024-09-01T07:03:22Z",
            "author_login": "dgrove-oss"
          },
          {
            "sha": "c2a100c44edbeb6c26883fae199ac0afac20fb20",
            "date": "2024-08-23T07:58:24Z",
            "author_login": "dgrove-oss"
          },
          {
            "sha": "0c9ee4c5c35a0a0d570c71e92b6b01fb07365776",
            "date": "2024-03-19T14:03:03Z",
            "author_login": "dgrove-oss"
          },
          {
            "sha": "6df9d14374270b95f0f7e6be182b341ea202628a",
            "date": "2023-10-18T09:57:29Z",
            "author_login": "falkzoll"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "In Docker Skeleton Runtime for Apache OpenWhisk, a Docker action inheriting the Docker tag openwhisk/dockerskeleton:1.3.0 (or earlier) may allow an attacker to replace the user function inside the container if the user code is vulnerable to code exploitation.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-07-23T17:29:00.307",
    "last_modified": "2024-11-21T03:43:58.050",
    "fix_date": "2018-07-05T19:19:21Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/104913",
      "source": "security@apache.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/apache/incubator-openwhisk-runtime-docker/commit/891896f25c39bc336ef6dda53f80f466ac4ca3c8",
      "source": "security@apache.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/0b6d8a677f1c063ed32eb3638ef4d1a47dfba8907de4b222ddd24b05%40%3Cdev.openwhisk.apache.org%3E",
      "source": "security@apache.org",
      "tags": []
    },
    {
      "url": "https://www.puresec.io/hubfs/Apache%20OpenWhisk%20PureSec%20Security%20Advisory.pdf",
      "source": "nvd@nist.gov",
      "tags": [
        "Mitigation",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/104913",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/apache/incubator-openwhisk-runtime-docker/commit/891896f25c39bc336ef6dda53f80f466ac4ca3c8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/0b6d8a677f1c063ed32eb3638ef4d1a47dfba8907de4b222ddd24b05%40%3Cdev.openwhisk.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:32.411468",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "openwhisk-runtime-docker",
    "owner": "apache",
    "created_at": "2017-10-05T19:31:46Z",
    "updated_at": "2024-09-30T17:18:54Z",
    "pushed_at": "2024-09-24T14:21:48Z",
    "size": 3188,
    "stars": 25,
    "forks": 43,
    "open_issues": 0,
    "watchers": 25,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 30639,
      "Scala": 15647,
      "Dockerfile": 4805,
      "Shell": 4458,
      "C": 1427
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:25:40.926945"
  }
}