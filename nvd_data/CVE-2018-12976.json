{
  "cve_id": "CVE-2018-12976",
  "github_data": {
    "repository": "golang/gddo",
    "fix_commit": "daffe1f90ec57f8ed69464f9094753fc6452e983",
    "related_commits": [
      "daffe1f90ec57f8ed69464f9094753fc6452e983",
      "daffe1f90ec57f8ed69464f9094753fc6452e983"
    ],
    "patch_url": "https://github.com/golang/gddo/commit/daffe1f90ec57f8ed69464f9094753fc6452e983.patch",
    "fix_commit_details": {
      "sha": "daffe1f90ec57f8ed69464f9094753fc6452e983",
      "commit_date": "2018-06-28T04:27:15Z",
      "author": {
        "login": "shantuo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "gosrc: validate repo from meta",
        "length": 213,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "gosrc/gosrc.go",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -378,6 +378,9 @@ func getDynamic(ctx context.Context, client *http.Client, importPath, etag strin\n \tproto := im.repo[:i]\n \tclonePath := im.repo[i+len(\"://\"):]\n \trepo := strings.TrimSuffix(clonePath, \".\"+im.vcs)\n+\tif !IsValidRemotePath(repo) {\n+\t\treturn nil, fmt.Errorf(\"bad path from meta: %s\", repo)\n+\t}\n \tdirName := importPath[len(im.projectRoot):]\n \n \tresolvedPath := repo + dirName"
        },
        {
          "filename": "gosrc/gosrc_test.go",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -94,6 +94,9 @@ var testWeb = map[string]string{\n \t\t`<meta name=\"go-import\" content=\"myitcv.io/blah2 mod https://raw.githubusercontent.com/myitcv/pubx/master\">` +\n \t\t`<meta name=\"go-source\" content=\"myitcv.io https://github.com/myitcv/x/wiki https://github.com/myitcv/x/tree/master{/dir} https://github.com/myitcv/x/blob/master{/dir}/{file}#L{line}\">` +\n \t\t`</head>`,\n+\n+\t// The repo element of go-import includes \"../\"\n+\t\"http://my.host/pkg\": `<head> <meta name=\"go-import\" content=\"my.host/pkg git http://vcs.net/myhost/../../tmp/pkg.git\"></head>`,\n }\n \n var getDynamicTests = []struct {\n@@ -221,6 +224,7 @@ var getDynamicTests = []struct {\n \t\tVCS:          \"git\",\n \t\tFiles:        []*File{{Name: \"main.go\", BrowseURL: \"https://github.com/myitcv/x/blob/master/main.go\"}},\n \t}},\n+\t{\"my.host/pkg\", nil},\n }\n \n type testTransport map[string]string\n@@ -293,13 +297,13 @@ func TestGetDynamic(t *testing.T) {\n \n \t\tif tt.dir == nil {\n \t\t\tif err == nil {\n-\t\t\t\tt.Errorf(\"getDynamic(client, %q, etag) did not return expected error\", tt.importPath)\n+\t\t\t\tt.Errorf(\"getDynamic(ctx, client, %q, etag) did not return expected error\", tt.importPath)\n \t\t\t}\n \t\t\tcontinue\n \t\t}\n \n \t\tif err != nil {\n-\t\t\tt.Errorf(\"getDynamic(client, %q, etag) return unexpected error: %v\", tt.importPath, err)\n+\t\t\tt.Errorf(\"getDynamic(ctx, client, %q, etag) return unexpected error: %v\", tt.importPath, err)\n \t\t\tcontinue\n \t\t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "20d68f94ee1f7547de2b1c68627253df20c8d45e",
            "date": "2021-01-06T22:14:22Z",
            "author_login": "julieqiu"
          },
          {
            "sha": "17b648fae2959f9d9b49c82b70fd4f6e35a1b27f",
            "date": "2020-12-21T03:53:42Z",
            "author_login": "julieqiu"
          },
          {
            "sha": "5b05951d42115f07f1e6e9d7e3c431c455df59f8",
            "date": "2020-12-21T04:12:09Z",
            "author_login": "julieqiu"
          },
          {
            "sha": "9cf165be3e76143f1ad7c3d4e577649554befe47",
            "date": "2020-12-21T04:31:59Z",
            "author_login": "julieqiu"
          },
          {
            "sha": "c1279c47a32e58b7ab57ef6eace6457d70bf362d",
            "date": "2020-12-21T04:18:01Z",
            "author_login": "julieqiu"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "In Go Doc Dot Org (gddo) through 2018-06-27, an attacker could use specially crafted <go-import> tags in packages being fetched by gddo to cause a directory traversal and remote code execution.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-07-05T18:29:00.487",
    "last_modified": "2024-11-21T03:46:10.573",
    "fix_date": "2018-06-28T04:27:15Z"
  },
  "references": [
    {
      "url": "https://github.com/golang/gddo/commit/daffe1f90ec57f8ed69464f9094753fc6452e983",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://groups.google.com/forum/#%21msg/golang-announce/4rpTbfzYB1k/no6MEwlQAwAJ",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/golang/gddo/commit/daffe1f90ec57f8ed69464f9094753fc6452e983",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://groups.google.com/forum/#%21msg/golang-announce/4rpTbfzYB1k/no6MEwlQAwAJ",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:28.579726",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gddo",
    "owner": "golang",
    "created_at": "2011-06-18T02:42:58Z",
    "updated_at": "2024-12-11T13:20:45Z",
    "pushed_at": "2021-01-15T22:23:57Z",
    "size": 6126,
    "stars": 1103,
    "forks": 264,
    "open_issues": 167,
    "watchers": 1103,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Go": 402915,
      "HTML": 32190,
      "JavaScript": 7190,
      "CSS": 5723,
      "Dockerfile": 1504,
      "Shell": 550
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T20:00:45.968120"
  }
}