{
  "cve_id": "CVE-2018-14363",
  "github_data": {
    "repository": "neomutt/neomutt",
    "fix_commit": "9bfab35522301794483f8f9ed60820bdec9be59e",
    "related_commits": [
      "9bfab35522301794483f8f9ed60820bdec9be59e",
      "9bfab35522301794483f8f9ed60820bdec9be59e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "9bfab35522301794483f8f9ed60820bdec9be59e",
      "commit_date": "2018-07-05T12:32:17Z",
      "author": {
        "login": "flatcap",
        "type": "User",
        "stats": {
          "total_commits": 7267,
          "average_weekly_commits": 2.5276521739130433,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 416
        }
      },
      "commit_message": {
        "title": "sanitise cache paths",
        "length": 67,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 42,
        "additions": 35,
        "deletions": 7
      },
      "files": [
        {
          "filename": "newsrc.c",
          "status": "modified",
          "additions": 12,
          "deletions": 1,
          "patch": "@@ -715,7 +715,18 @@ int nntp_active_save_cache(struct NntpServer *nserv)\n  */\n static int nntp_hcache_namer(const char *path, char *dest, size_t destlen)\n {\n-  return snprintf(dest, destlen, \"%s.hcache\", path);\n+  int count = snprintf(dest, destlen, \"%s.hcache\", path);\n+\n+  /* Strip out any directories in the path */\n+  char *first = strchr(dest, '/');\n+  char *last = strrchr(dest, '/');\n+  if (first && last && (last > first))\n+  {\n+    memmove(first, last, strlen(last) + 1);\n+    count -= (last - first);\n+  }\n+\n+  return count;\n }\n \n /**"
        },
        {
          "filename": "pop.c",
          "status": "modified",
          "additions": 23,
          "deletions": 6,
          "patch": "@@ -63,6 +63,23 @@\n #define HC_FEXT \"hcache\"   /* extension for hcache as POP lacks paths */\n #endif\n \n+/**\n+ * cache_id - Make a message-cache-compatible id\n+ * @param id POP message id\n+ * @retval ptr Sanitised string\n+ *\n+ * The POP message id may contain '/' and other awkward characters.\n+ *\n+ * @note This function returns a pointer to a static buffer.\n+ */\n+static const char *cache_id(const char *id)\n+{\n+  static char clean[SHORT_STRING];\n+  mutt_str_strfcpy(clean, id, sizeof(clean));\n+  mutt_file_sanitize_filename(clean, true);\n+  return clean;\n+}\n+\n /**\n  * fetch_message - write line to file\n  * @param line String to write\n@@ -242,7 +259,7 @@ static int msg_cache_check(const char *id, struct BodyCache *bcache, void *data)\n   /* message not found in context -> remove it from cache\n    * return the result of bcache, so we stop upon its first error\n    */\n-  return mutt_bcache_del(bcache, id);\n+  return mutt_bcache_del(bcache, cache_id(id));\n }\n \n #ifdef USE_HCACHE\n@@ -407,7 +424,7 @@ static int pop_fetch_headers(struct Context *ctx)\n        *        - if we don't have a body: new\n        */\n       const bool bcached =\n-          (mutt_bcache_exists(pop_data->bcache, ctx->hdrs[i]->data) == 0);\n+          (mutt_bcache_exists(pop_data->bcache, cache_id(ctx->hdrs[i]->data)) == 0);\n       ctx->hdrs[i]->old = false;\n       ctx->hdrs[i]->read = false;\n       if (hcached)\n@@ -597,7 +614,7 @@ static int pop_fetch_message(struct Context *ctx, struct Message *msg, int msgno\n   unsigned short bcache = 1;\n \n   /* see if we already have the message in body cache */\n-  msg->fp = mutt_bcache_get(pop_data->bcache, h->data);\n+  msg->fp = mutt_bcache_get(pop_data->bcache, cache_id(h->data));\n   if (msg->fp)\n     return 0;\n \n@@ -644,7 +661,7 @@ static int pop_fetch_message(struct Context *ctx, struct Message *msg, int msgno\n                        NetInc, h->content->length + h->content->offset - 1);\n \n     /* see if we can put in body cache; use our cache as fallback */\n-    msg->fp = mutt_bcache_put(pop_data->bcache, h->data);\n+    msg->fp = mutt_bcache_put(pop_data->bcache, cache_id(h->data));\n     if (!msg->fp)\n     {\n       /* no */\n@@ -689,7 +706,7 @@ static int pop_fetch_message(struct Context *ctx, struct Message *msg, int msgno\n    * portion of the headers, those required for the main display.\n    */\n   if (bcache)\n-    mutt_bcache_commit(pop_data->bcache, h->data);\n+    mutt_bcache_commit(pop_data->bcache, cache_id(h->data));\n   else\n   {\n     cache->index = h->index;\n@@ -783,7 +800,7 @@ static int pop_sync_mailbox(struct Context *ctx, int *index_hint)\n         ret = pop_query(pop_data, buf, sizeof(buf));\n         if (ret == 0)\n         {\n-          mutt_bcache_del(pop_data->bcache, ctx->hdrs[i]->data);\n+          mutt_bcache_del(pop_data->bcache, cache_id(ctx->hdrs[i]->data));\n #ifdef USE_HCACHE\n           mutt_hcache_delete(hc, ctx->hdrs[i]->data, strlen(ctx->hdrs[i]->data));\n #endif"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "753ae004ed15f8fdc8288bde71f310b2a6426fa0",
            "date": "2025-01-23T17:27:18Z",
            "author_login": "flatcap"
          },
          {
            "sha": "210dd978b3f9a346e63fc836b704cdcc2bc6769d",
            "date": "2025-01-16T15:32:37Z",
            "author_login": "flatcap"
          },
          {
            "sha": "73f71b2b4a8cfc5d3f039252bbcf72c918c16c4f",
            "date": "2025-01-16T12:45:09Z",
            "author_login": "flatcap"
          },
          {
            "sha": "a34fdc4312cd0c4fd20d134fcf91ad4c9305e740",
            "date": "2025-01-22T15:26:39Z",
            "author_login": "flatcap"
          },
          {
            "sha": "9a012e3f2f48981321c3f3cd7bd76d2ea31d6e96",
            "date": "2025-01-22T13:33:42Z",
            "author_login": "gahr"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "An issue was discovered in NeoMutt before 2018-07-16. newsrc.c does not properly restrict '/' characters that may have unsafe interaction with cache pathnames.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2018-07-17T17:29:01.027",
    "last_modified": "2024-11-21T03:48:55.537",
    "fix_date": "2018-07-05T12:32:17Z"
  },
  "references": [
    {
      "url": "https://github.com/neomutt/neomutt/commit/9bfab35522301794483f8f9ed60820bdec9be59e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/08/msg00001.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://neomutt.org/2018/07/16/release",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4277",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neomutt/neomutt/commit/9bfab35522301794483f8f9ed60820bdec9be59e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/08/msg00001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://neomutt.org/2018/07/16/release",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4277",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:32.398179",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "neomutt",
    "owner": "neomutt",
    "created_at": "2015-12-21T02:12:54Z",
    "updated_at": "2025-01-25T23:07:18Z",
    "pushed_at": "2025-01-26T00:30:16Z",
    "size": 171803,
    "stars": 3325,
    "forks": 312,
    "open_issues": 222,
    "watchers": 3325,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 8619853,
      "Tcl": 157287,
      "Shell": 93753,
      "Perl": 31089,
      "Python": 22976
    },
    "commit_activity": {
      "total_commits_last_year": 668,
      "avg_commits_per_week": 12.846153846153847,
      "days_active_last_year": 181
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:36:06.868013"
  }
}