{
  "cve_id": "CVE-2018-14938",
  "github_data": {
    "repository": "simsong/tcpflow",
    "fix_commit": "a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb",
    "related_commits": [
      "a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb",
      "a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb"
    ],
    "patch_url": "https://github.com/simsong/tcpflow/commit/a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb.patch",
    "fix_commit_details": {
      "sha": "a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb",
      "commit_date": "2018-08-03T01:33:09Z",
      "author": {
        "login": "simsong",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed buffer overflow",
        "length": 21,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 26,
        "additions": 15,
        "deletions": 11
      },
      "files": [
        {
          "filename": "src/wifipcap/wifipcap.cpp",
          "status": "modified",
          "additions": 15,
          "deletions": 11,
          "patch": "@@ -1492,17 +1492,19 @@ void WifiPacket::handle_prism(const u_char *pc, size_t len)\n     prism2_pkthdr hdr;\n \n     /* get the fields */\n-    hdr.host_time \t= EXTRACT_LE_32BITS(pc+32);\n-    hdr.mac_time \t= EXTRACT_LE_32BITS(pc+44);\n-    hdr.channel \t= EXTRACT_LE_32BITS(pc+56);\n-    hdr.rssi \t\t= EXTRACT_LE_32BITS(pc+68);\n-    hdr.sq \t\t= EXTRACT_LE_32BITS(pc+80);\n-    hdr.signal  \t= EXTRACT_LE_32BITS(pc+92);\n-    hdr.noise   \t= EXTRACT_LE_32BITS(pc+104);\n-    hdr.rate\t\t= EXTRACT_LE_32BITS(pc+116)/2;\n-    hdr.istx\t\t= EXTRACT_LE_32BITS(pc+128);\n-    cbs->HandlePrism( *this, &hdr, pc + 144, len - 144);\n-    handle_80211(pc+144,len-144);\n+    if (len>=144){\n+        hdr.host_time \t= EXTRACT_LE_32BITS(pc+32);\n+        hdr.mac_time \t= EXTRACT_LE_32BITS(pc+44);\n+        hdr.channel \t= EXTRACT_LE_32BITS(pc+56);\n+        hdr.rssi \t\t= EXTRACT_LE_32BITS(pc+68);\n+        hdr.sq \t\t= EXTRACT_LE_32BITS(pc+80);\n+        hdr.signal  \t= EXTRACT_LE_32BITS(pc+92);\n+        hdr.noise   \t= EXTRACT_LE_32BITS(pc+104);\n+        hdr.rate\t\t= EXTRACT_LE_32BITS(pc+116)/2;\n+        hdr.istx\t\t= EXTRACT_LE_32BITS(pc+128);\n+        cbs->HandlePrism( *this, &hdr, pc + 144, len - 144);\n+        handle_80211(pc+144,len-144);\n+    }\n }\n \n ///////////////////////////////////////////////////////////////////////////////\n@@ -1511,6 +1513,7 @@ void WifiPacket::handle_prism(const u_char *pc, size_t len)\n /// handle each of the packet types\n ///\n \n+/// 2018-08-02: slg - I'm not sure why this is commented out.\n void WifiPacket::handle_ether(const u_char *ptr, size_t len)\n {\n #if 0\n@@ -1715,6 +1718,7 @@ void Wifipcap::handle_packet(WifipcapCallbacks *cbs,int header_type,\n         break;\n     default:\n #if 0\n+        /// 2018-08-02: slg - I'm also not sure why this is commented out.\n \t// try handling it as default IP assuming framing is ethernet \n \t// (this is for testing)\n         pkt.handle_ip(packet,header->caplen);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "790e433ac8ec26b46c7ce92f81e7483c7abcfe72",
            "date": "2024-12-23T14:56:27Z",
            "author_login": "catap"
          },
          {
            "sha": "2a2dd880de08ec890c9c1fd0e2fbd9b29b058401",
            "date": "2024-12-19T09:50:48Z",
            "author_login": "simsong"
          },
          {
            "sha": "c9cdbcc56fd76f60437f09e874a91cb2d92a8386",
            "date": "2024-12-19T02:44:16Z",
            "author_login": "catap"
          },
          {
            "sha": "467b380642e8e126d1ef5ddf30638deffb6fb2ad",
            "date": "2024-09-19T01:40:48Z",
            "author_login": "catap"
          },
          {
            "sha": "158b0d31591937ef57680e26b1c9b8f395265ec5",
            "date": "2024-06-17T04:31:16Z",
            "author_login": "simsong"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "An issue was discovered in wifipcap/wifipcap.cpp in TCPFLOW through 1.5.0-alpha. There is an integer overflow in the function handle_prism during caplen processing. If the caplen is less than 144, one can cause an integer overflow in the function handle_80211, which will result in an out-of-bounds read and may allow access to sensitive memory (or a denial of service).",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-08-05T03:29:00.217",
    "last_modified": "2024-11-21T03:50:07.610",
    "fix_date": "2018-08-03T01:33:09Z"
  },
  "references": [
    {
      "url": "https://github.com/simsong/tcpflow/commit/a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/simsong/tcpflow/issues/182",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/11/msg00046.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3955-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/simsong/tcpflow/commit/a4e1cd14eb5ccc51ed271b65b3420f7d692c40eb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/simsong/tcpflow/issues/182",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/11/msg00046.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3955-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:32.427687",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tcpflow",
    "owner": "simsong",
    "created_at": "2012-04-01T00:44:11Z",
    "updated_at": "2025-01-12T10:57:28Z",
    "pushed_at": "2024-12-23T14:56:27Z",
    "size": 52008,
    "stars": 1708,
    "forks": 238,
    "open_issues": 69,
    "watchers": 1708,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C++": 810414,
      "C": 89163,
      "M4": 85919,
      "Shell": 29820,
      "CMake": 26256,
      "Makefile": 6159,
      "Python": 2792,
      "HTML": 139
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:43:30.363328"
  }
}