{
  "cve_id": "CVE-2018-15581",
  "github_data": {
    "repository": "gnuboard/gnuboard5",
    "fix_commit": "b1fc952c7600b825c4b02e2789ddafdea18c8d13",
    "related_commits": [
      "b1fc952c7600b825c4b02e2789ddafdea18c8d13",
      "b1fc952c7600b825c4b02e2789ddafdea18c8d13"
    ],
    "patch_url": "https://github.com/gnuboard/gnuboard5/commit/b1fc952c7600b825c4b02e2789ddafdea18c8d13.patch",
    "fix_commit_details": {
      "sha": "b1fc952c7600b825c4b02e2789ddafdea18c8d13",
      "commit_date": "2018-08-22T05:02:14Z",
      "author": {
        "login": "thisgun",
        "type": "User",
        "stats": {
          "total_commits": 1546,
          "average_weekly_commits": 2.4080996884735204,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 261
        }
      },
      "commit_message": {
        "title": "XSS \ucde8\uc57d\uc810 \uc218\uc815",
        "length": 10,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 39,
        "additions": 26,
        "deletions": 13
      },
      "files": [
        {
          "filename": "adm/boardgroup_form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n if ($w == '') {\n     $gr_id_attr = 'required';\n     $sound_only = '<strong class=\"sound_only\"> \ud544\uc218</strong>';\n-    $gr['gr_use_access'] = 0;\n+    $gr = array('gr_use_access' => 0);\n     $html_title .= ' \uc0dd\uc131';\n } else if ($w == 'u') {\n     $gr_id_attr = 'readonly';"
        },
        {
          "filename": "adm/boardgroup_form_update.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -16,7 +16,9 @@\n \n if (!$gr_subject) alert('\uadf8\ub8f9 \uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694.');\n \n-$sql_common = \" gr_subject = '{$_POST['gr_subject']}',\n+$gr_subject = isset($_POST['gr_subject']) ? strip_tags($_POST['gr_subject']) : '';\n+\n+$sql_common = \" gr_subject = '{$gr_subject}',\n                 gr_device = '{$_POST['gr_device']}',\n                 gr_admin  = '{$_POST['gr_admin']}',\n                 gr_1_subj = '{$_POST['gr_1_subj']}',"
        },
        {
          "filename": "adm/boardgroup_list_update.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -19,10 +19,11 @@\n {\n     $k     = $_POST['chk'][$i];\n     $gr_id = $_POST['group_id'][$k];\n+    $gr_subject = strip_tags($_POST['gr_subject'][$k]);\n \n     if($_POST['act_button'] == '\uc120\ud0dd\uc218\uc815') {\n         $sql = \" update {$g5['group_table']}\n-                    set gr_subject    = '{$_POST['gr_subject'][$k]}',\n+                    set gr_subject    = '{$gr_subject}',\n                         gr_device     = '{$_POST['gr_device'][$k]}',\n                         gr_admin      = '{$_POST['gr_admin'][$k]}',\n                         gr_use_access = '{$_POST['gr_use_access'][$k]}',"
        },
        {
          "filename": "adm/contentform.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -49,9 +49,11 @@\n else\r\n {\r\n     $html_title .= ' \uc785\ub825';\r\n-    $co['co_html'] = 2;\r\n-    $co['co_skin'] = 'basic';\r\n-    $co['co_mobile_skin'] = 'basic';\r\n+    $co = array(\r\n+        'co_html' => 2,\r\n+        'co_skin' => 'basic',\r\n+        'co_mobile_skin' => 'basic'\r\n+        );\r\n }\r\n \r\n include_once (G5_ADMIN_PATH.'/admin.head.php');\r"
        },
        {
          "filename": "adm/contentformupdate.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -20,6 +20,7 @@\n     $co_row = sql_fetch($sql);\r\n }\r\n \r\n+$co_subject = strip_tags($co_subject);\r\n $co_include_head = preg_replace(array(\"#[\\\\\\]+$#\", \"#(<\\?php|<\\?)#i\"), \"\", substr($co_include_head, 0, 255));\r\n $co_include_tail = preg_replace(array(\"#[\\\\\\]+$#\", \"#(<\\?php|<\\?)#i\"), \"\", substr($co_include_tail, 0, 255));\r\n \r"
        },
        {
          "filename": "adm/faqmasterform.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -21,6 +21,7 @@\n else\r\n {\r\n     $html_title .= ' \uc785\ub825';\r\n+    $fm = array();\r\n }\r\n \r\n $g5['title'] = $html_title.' \uad00\ub9ac';\r"
        },
        {
          "filename": "adm/faqmasterformupdate.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -18,6 +18,8 @@\n if ($fm_himg_del)  @unlink(G5_DATA_PATH.\"/faq/{$fm_id}_h\");\r\n if ($fm_timg_del)  @unlink(G5_DATA_PATH.\"/faq/{$fm_id}_t\");\r\n \r\n+$fm_subject = strip_tags($fm_subject);\r\n+\r\n $sql_common = \" set fm_subject = '$fm_subject',\r\n                     fm_head_html = '$fm_head_html',\r\n                     fm_tail_html = '$fm_tail_html',\r"
        },
        {
          "filename": "adm/newwinform.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -109,7 +109,7 @@\n     <tr>\r\n         <th scope=\"row\"><label for=\"nw_subject\">\ud31d\uc5c5 \uc81c\ubaa9<strong class=\"sound_only\"> \ud544\uc218</strong></label></th>\r\n         <td>\r\n-            <input type=\"text\" name=\"nw_subject\" value=\"<?php echo stripslashes($nw['nw_subject']) ?>\" id=\"nw_subject\" required class=\"frm_input required\" size=\"80\">\r\n+            <input type=\"text\" name=\"nw_subject\" value=\"<?php echo get_sanitize_input($nw['nw_subject']); ?>\" id=\"nw_subject\" required class=\"frm_input required\" size=\"80\">\r\n         </td>\r\n     </tr>\r\n     <tr>\r"
        },
        {
          "filename": "adm/newwinformupdate.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -12,6 +12,8 @@\n \r\n check_admin_token();\r\n \r\n+$nw_subject = isset($_POST['nw_subject']) ? strip_tags($_POST['nw_subject']) : '';\r\n+\r\n $sql_common = \" nw_device = '{$_POST['nw_device']}',\r\n                 nw_begin_time = '{$_POST['nw_begin_time']}',\r\n                 nw_end_time = '{$_POST['nw_end_time']}',\r\n@@ -20,7 +22,7 @@\n                 nw_top = '{$_POST['nw_top']}',\r\n                 nw_height = '{$_POST['nw_height']}',\r\n                 nw_width = '{$_POST['nw_width']}',\r\n-                nw_subject = '{$_POST['nw_subject']}',\r\n+                nw_subject = '{$nw_subject}',\r\n                 nw_content = '{$_POST['nw_content']}',\r\n                 nw_content_html = '{$_POST['nw_content_html']}' \";\r\n \r"
        },
        {
          "filename": "adm/point_update.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -6,9 +6,9 @@\n \n check_admin_token();\n \n-$mb_id = $_POST['mb_id'];\n-$po_point = $_POST['po_point'];\n-$po_content = $_POST['po_content'];\n+$mb_id = strip_tags($_POST['mb_id']);\n+$po_point = strip_tags($_POST['po_point']);\n+$po_content = strip_tags($_POST['po_content']);\n $expire = preg_replace('/[^0-9]/', '', $_POST['po_expire_term']);\n \n $mb = get_member($mb_id);"
        },
        {
          "filename": "adm/sms_admin/num_book_update.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -21,6 +21,8 @@\n     if (!strlen(trim($bk_name)))\r\n         alert('\uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694');\r\n \r\n+    $bk_name = strip_tags($bk_name);\r\n+\r\n     if ($bk_hp == '')\r\n         alert('\ud734\ub300\ud3f0\ubc88\ud638\ub9cc \uc785\ub825 \uac00\ub2a5\ud569\ub2c8\ub2e4.');\r\n /*\r"
        },
        {
          "filename": "adm/sms_admin/num_book_write.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -30,7 +30,7 @@\n     $g5['title'] .= '\uc218\uc815';\r\n }\r\n else  {\r\n-    $write['bg_no'] = $bg_no;\r\n+    $write = array('bg_no' => (int) $bg_no);\r\n     $g5['title'] .= '\ucd94\uac00';\r\n }\r\n \r\n@@ -74,7 +74,7 @@\n     </tr>\r\n     <tr>\r\n         <th scope=\"row\"><label for=\"bk_name\">\uc774\ub984<strong class=\"sound_only\"> \ud544\uc218</strong></label></th>\r\n-        <td><input type=\"text\" name=\"bk_name\" id=\"bk_name\" maxlength=\"50\" value=\"<?php echo $write['bk_name']?>\" required class=\"frm_input required\"></td>\r\n+        <td><input type=\"text\" name=\"bk_name\" id=\"bk_name\" maxlength=\"50\" value=\"<?php echo get_sanitize_input($write['bk_name']); ?>\" required class=\"frm_input required\"></td>\r\n     </tr>\r\n     <tr>\r\n         <th scope=\"row\"><label for=\"bk_hp\">\ud734\ub300\ud3f0\ubc88\ud638<strong class=\"sound_only\"> \ud544\uc218</strong></label></th>\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "af92ea064ef91a2f6a519df0cdf2e44e44b93023",
            "date": "2024-11-26T08:36:29Z",
            "author_login": "thisgun"
          },
          {
            "sha": "dab5abb89a2190d0d6ed60120ce10a4261097cde",
            "date": "2024-11-26T08:33:04Z",
            "author_login": "thisgun"
          },
          {
            "sha": "8893b112fa2dfda5576545658a686e1a5134123e",
            "date": "2024-11-21T02:58:55Z",
            "author_login": "thisgun"
          },
          {
            "sha": "d65fa99e3c3ba0b02250d9753b4051b13e01b915",
            "date": "2024-11-04T07:13:43Z",
            "author_login": "thisgun"
          },
          {
            "sha": "29381da2cef81b061e858a8b0dcc5b77835e39b5",
            "date": "2024-10-31T07:19:11Z",
            "author_login": "thisgun"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Cross-Site Scripting (XSS) vulnerability in adm/faqmasterformupdate.php in gnuboard5 before 5.3.1.6 allows remote attackers to inject arbitrary web script or HTML.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-04-26T20:29:00.317",
    "last_modified": "2024-11-21T03:51:06.400",
    "fix_date": "2018-08-22T05:02:14Z"
  },
  "references": [
    {
      "url": "https://github.com/gnuboard/gnuboard5/commit/b1fc952c7600b825c4b02e2789ddafdea18c8d13#diff-4280d95d6643b5d9673962736ada210b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gnuboard/gnuboard5/commit/b1fc952c7600b825c4b02e2789ddafdea18c8d13#diff-4280d95d6643b5d9673962736ada210b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:50.454003",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gnuboard5",
    "owner": "gnuboard",
    "created_at": "2014-06-09T04:51:56Z",
    "updated_at": "2025-01-08T06:56:29Z",
    "pushed_at": "2025-01-02T00:34:27Z",
    "size": 63695,
    "stars": 312,
    "forks": 249,
    "open_issues": 45,
    "watchers": 312,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 12602254,
      "JavaScript": 3119949,
      "CSS": 1817938,
      "HTML": 853624,
      "GLSL": 2468,
      "Shell": 398,
      "Hack": 388
    },
    "commit_activity": {
      "total_commits_last_year": 91,
      "avg_commits_per_week": 1.75,
      "days_active_last_year": 36
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:58:32.210945"
  }
}