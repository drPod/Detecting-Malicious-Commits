{
  "cve_id": "CVE-2018-16435",
  "github_data": {
    "repository": "mm2/Little-CMS",
    "fix_commit": "768f70ca405cd3159d990e962d54456773bb8cf8",
    "related_commits": [
      "768f70ca405cd3159d990e962d54456773bb8cf8",
      "768f70ca405cd3159d990e962d54456773bb8cf8"
    ],
    "patch_url": "https://github.com/mm2/Little-CMS/commit/768f70ca405cd3159d990e962d54456773bb8cf8.patch",
    "fix_commit_details": {
      "sha": "768f70ca405cd3159d990e962d54456773bb8cf8",
      "commit_date": "2018-08-15T18:07:56Z",
      "author": {
        "login": "mm2",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Upgrade Visual studio 2017 15.8",
        "length": 136,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 30,
        "additions": 19,
        "deletions": 11
      },
      "files": [
        {
          "filename": "Projects/VC2017/jpegicc/jpegicc.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -22,6 +22,7 @@\n     <ProjectGuid>{62812507-F926-4968-96A9-17678460AD90}</ProjectGuid>\n     <RootNamespace>jpegicc</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/lcms2_DLL/lcms2_DLL.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{8C51BE48-ADB8-4089-A9EC-F6BF993A0548}</ProjectGuid>\n     <RootNamespace>lcms2_DLL</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/lcms2_static/lcms2_static.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{71DEDE59-3F1E-486B-A899-4283000F76B5}</ProjectGuid>\n     <RootNamespace>lcms2_static</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/linkicc/linkicc.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{FBFBE1DC-DB84-4BA1-9552-B4780F457849}</ProjectGuid>\n     <RootNamespace>linkicc</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/psicc/psicc.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{EF6A8851-65FE-46F5-B9EF-14F0B671F693}</ProjectGuid>\n     <RootNamespace>psicc</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/testbed/testbed.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{928A3A2B-46EF-4279-959C-513B3652FF0E}</ProjectGuid>\n     <RootNamespace>testbed</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/tiffdiff/tiffdiff.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{75B91835-CCD7-48BE-A606-A9C997D5DBEE}</ProjectGuid>\n     <RootNamespace>tiffdiff</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/tifficc/tifficc.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n     <ProjectGuid>{2256DE16-ED92-4A6F-9C54-F65BB61E64A2}</ProjectGuid>\n     <RootNamespace>tifficc</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n-    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "Projects/VC2017/transicc/transicc.vcxproj",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -22,6 +22,7 @@\n     <ProjectGuid>{9EE22D66-C849-474C-9ED5-C3E141DAB160}</ProjectGuid>\n     <RootNamespace>transicc</RootNamespace>\n     <Keyword>Win32Proj</Keyword>\n+    <WindowsTargetPlatformVersion>10.0.17134.0</WindowsTargetPlatformVersion>\n   </PropertyGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.Default.props\" />\n   <PropertyGroup Condition=\"'$(Configuration)|$(Platform)'=='Release|Win32'\" Label=\"Configuration\">"
        },
        {
          "filename": "src/cmscgats.c",
          "status": "modified",
          "additions": 10,
          "deletions": 4,
          "patch": "@@ -1,7 +1,7 @@\n //---------------------------------------------------------------------------------\n //\n //  Little Color Management System\n-//  Copyright (c) 1998-2017 Marti Maria Saguer\n+//  Copyright (c) 1998-2018 Marti Maria Saguer\n //\n // Permission is hereby granted, free of charge, to any person obtaining\n // a copy of this software and associated documentation files (the \"Software\"),\n@@ -1506,10 +1506,16 @@ void AllocateDataSet(cmsIT8* it8)\n     t-> nSamples   = atoi(cmsIT8GetProperty(it8, \"NUMBER_OF_FIELDS\"));\n     t-> nPatches   = atoi(cmsIT8GetProperty(it8, \"NUMBER_OF_SETS\"));\n \n-    t-> Data = (char**)AllocChunk (it8, ((cmsUInt32Number) t->nSamples + 1) * ((cmsUInt32Number) t->nPatches + 1) *sizeof (char*));\n-    if (t->Data == NULL) {\n+    if (t -> nSamples < 0 || t->nSamples > 0x7ffe || t->nPatches < 0 || t->nPatches > 0x7ffe)\n+    {\n+        SynError(it8, \"AllocateDataSet: too much data\");\n+    }\n+    else {\n+        t->Data = (char**)AllocChunk(it8, ((cmsUInt32Number)t->nSamples + 1) * ((cmsUInt32Number)t->nPatches + 1) * sizeof(char*));\n+        if (t->Data == NULL) {\n \n-        SynError(it8, \"AllocateDataSet: Unable to allocate data array\");\n+            SynError(it8, \"AllocateDataSet: Unable to allocate data array\");\n+        }\n     }\n \n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 10,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0680de11eefde8ab218129dd9c00ae4c85ed33fe",
            "date": "2025-01-13T13:15:35Z",
            "author_login": "mm2"
          },
          {
            "sha": "c2055d8e78bee22842a04c5f9879c672f9d5b364",
            "date": "2025-01-13T08:29:03Z",
            "author_login": "mm2"
          },
          {
            "sha": "347ae8dcd5cacda7243bbab593a88f7949055a31",
            "date": "2025-01-12T22:21:22Z",
            "author_login": "GerHobbelt"
          },
          {
            "sha": "0f14fc7f4fdba249efe8b9a6534ac096ab772a54",
            "date": "2025-01-12T22:37:42Z",
            "author_login": "GerHobbelt"
          },
          {
            "sha": "4001dd2d8d7466c7ebbaf377ae9814038431632d",
            "date": "2025-01-06T17:11:04Z",
            "author_login": "mm2"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-190",
    "description": "Little CMS (aka Little Color Management System) 2.9 has an integer overflow in the AllocateDataSet function in cmscgats.c, leading to a heap-based buffer overflow in the SetData function via a crafted file in the second argument to cmsIT8LoadFromFile.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-09-04T00:29:02.183",
    "last_modified": "2024-11-21T03:52:44.907",
    "fix_date": "2018-08-15T18:07:56Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3004",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mm2/Little-CMS/commit/768f70ca405cd3159d990e962d54456773bb8cf8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mm2/Little-CMS/issues/171",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/09/msg00005.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202105-18",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3770-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3770-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4284",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3004",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mm2/Little-CMS/commit/768f70ca405cd3159d990e962d54456773bb8cf8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mm2/Little-CMS/issues/171",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/09/msg00005.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202105-18",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/3770-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3770-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4284",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:35.793089",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Little-CMS",
    "owner": "mm2",
    "created_at": "2010-02-08T15:38:58Z",
    "updated_at": "2025-01-14T06:09:17Z",
    "pushed_at": "2025-01-13T13:15:35Z",
    "size": 93077,
    "stars": 584,
    "forks": 178,
    "open_issues": 11,
    "watchers": 584,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 2150265,
      "Makefile": 442178,
      "Shell": 388789,
      "Pascal": 124014,
      "C++": 109636,
      "M4": 50095,
      "Roff": 13382,
      "Meson": 9667,
      "QMake": 1354,
      "Batchfile": 284
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:18:15.565517"
  }
}