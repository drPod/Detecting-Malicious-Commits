{
  "cve_id": "CVE-2018-16807",
  "github_data": {
    "repository": "bro/bro",
    "fix_commit": "34d0cf886ca16c665f673a299e295b2a2bc14533",
    "related_commits": [
      "34d0cf886ca16c665f673a299e295b2a2bc14533",
      "34d0cf886ca16c665f673a299e295b2a2bc14533"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "34d0cf886ca16c665f673a299e295b2a2bc14533",
      "commit_date": "2018-09-10T23:06:07Z",
      "author": {
        "login": "jsiwek",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix potential memory leak in Kerberos scripts",
        "length": 74,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
      },
      "files": [
        {
          "filename": "scripts/base/protocols/krb/main.bro",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -140,7 +140,8 @@ event krb_as_request(c: connection, msg: KDC_Request) &priority=5\n \n \tc$krb$request_type = \"AS\";\n \tc$krb$client       = fmt(\"%s/%s\", msg?$client_name ? msg$client_name : \"\", msg$service_realm);\n-\tc$krb$service      = msg$service_name;\n+\tif ( msg?$service_name )\n+\t\tc$krb$service      = msg$service_name;\n \n \tif ( msg?$from )\n \t\tc$krb$from = msg$from;\n@@ -183,7 +184,8 @@ event krb_tgs_request(c: connection, msg: KDC_Request) &priority=5\n \t\treturn;\n \n \tc$krb$request_type = \"TGS\";\n-\tc$krb$service = msg$service_name;\n+\tif ( msg?$service_name )\n+\t\tc$krb$service = msg$service_name;\n \tif ( msg?$from ) \n \t\tc$krb$from = msg$from;\n \tc$krb$till = msg$till;"
        },
        {
          "filename": "testing/btest/Traces/krb/optional-service-name.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "testing/btest/core/leaks/krb-service-name.test",
          "status": "added",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -0,0 +1,8 @@\n+# Needs perftools support.\n+#\n+# @TEST-REQUIRES: bro  --help 2>&1 | grep -q mem-leaks\n+#\n+# @TEST-GROUP: leaks\n+#\n+# @TEST-EXEC: HEAP_CHECK_DUMP_DIRECTORY=. HEAPCHECK=local btest-bg-run bro bro -m -r $TRACES/krb/optional-service-name.pcap\n+# @TEST-EXEC: btest-bg-wait 60"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0478c45f811f4a3e0efacf3cd30d2604413a1bd3",
            "date": "2023-03-24T00:29:58Z",
            "author_login": "zeek-bot"
          },
          {
            "sha": "71f487bd209bf88d5c271ae4f3be69c0a0874ef1",
            "date": "2023-03-23T12:40:26Z",
            "author_login": "awelzel"
          },
          {
            "sha": "890d2b5e07e3ab96a12d0deafd5864fbcf741f77",
            "date": "2023-03-23T12:35:28Z",
            "author_login": "awelzel"
          },
          {
            "sha": "fd15a33f8c57e9fd16cd2dec1fb817cf890dc892",
            "date": "2023-03-23T11:35:30Z",
            "author_login": "awelzel"
          },
          {
            "sha": "833dd158de56948ecfec98c7749c00e8254d7a6a",
            "date": "2023-03-20T13:24:48Z",
            "author_login": "awelzel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-772",
    "description": "In Bro through 2.5.5, there is a memory leak potentially leading to DoS in scripts/base/protocols/krb/main.bro in the Kerberos protocol parser.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-09-11T02:29:00.240",
    "last_modified": "2024-11-21T03:53:23.300",
    "fix_date": "2018-09-10T23:06:07Z"
  },
  "references": [
    {
      "url": "https://github.com/bro/bro/commit/34d0cf886ca16c665f673a299e295b2a2bc14533",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bro/bro/commit/34d0cf886ca16c665f673a299e295b2a2bc14533",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:35.809851",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "bro",
    "owner": "bro",
    "created_at": "2018-12-05T15:30:12Z",
    "updated_at": "2025-01-19T06:53:43Z",
    "pushed_at": "2023-03-24T00:40:41Z",
    "size": 137794,
    "stars": 169,
    "forks": 49,
    "open_issues": 0,
    "watchers": 169,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 5744981,
      "Zeek": 4631033,
      "CMake": 110742,
      "Yacc": 68545,
      "Shell": 59447,
      "Lex": 42201,
      "Dockerfile": 15777,
      "Python": 14618,
      "Makefile": 6130,
      "C": 4087,
      "Batchfile": 1008
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:15:42.865762"
  }
}