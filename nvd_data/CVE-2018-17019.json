{
  "cve_id": "CVE-2018-17019",
  "github_data": {
    "repository": "bro/bro",
    "fix_commit": "c2b18849f8bb833253538f5dfedb4ed1dc176a30",
    "related_commits": [
      "c2b18849f8bb833253538f5dfedb4ed1dc176a30",
      "c2b18849f8bb833253538f5dfedb4ed1dc176a30"
    ],
    "patch_url": "https://github.com/bro/bro/commit/c2b18849f8bb833253538f5dfedb4ed1dc176a30.patch",
    "fix_commit_details": {
      "sha": "c2b18849f8bb833253538f5dfedb4ed1dc176a30",
      "commit_date": "2018-09-13T00:47:57Z",
      "author": {
        "login": "jsiwek",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix IRC names command parsing",
        "length": 29,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 21,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/analyzer/protocol/irc/IRC.cc",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -252,14 +252,15 @@ void IRC_Analyzer::DeliverStream(int length, const u_char* line, bool orig)\n \t\t\t{\n \t\t\tvector<string> parts = SplitWords(params, ' ');\n \n-\t\t\t// Remove nick name.\n-\t\t\tparts.erase(parts.begin());\n-\t\t\tif ( parts.size() < 2 )\n+\t\t\tif ( parts.size() < 3 )\n \t\t\t\t{\n \t\t\t\tWeird(\"irc_invalid_names_line\");\n \t\t\t\treturn;\n \t\t\t\t}\n \n+\t\t\t// Remove nick name.\n+\t\t\tparts.erase(parts.begin());\n+\n \t\t\tstring type = parts[0];\n \t\t\tstring channel = parts[1];\n "
        },
        {
          "filename": "testing/btest/Baseline/scripts.base.protocols.irc.names-weird/weird.log",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+#separator \\x09\n+#set_separator\t,\n+#empty_field\t(empty)\n+#unset_field\t-\n+#path\tweird\n+#open\t2018-09-13-00-31-10\n+#fields\tts\tuid\tid.orig_h\tid.orig_p\tid.resp_h\tid.resp_p\tname\taddl\tnotice\tpeer\n+#types\ttime\tstring\taddr\tport\taddr\tport\tstring\tstring\tbool\tstring\n+1536797872.428637\tClEkJM2Vm5giqnMf4h\t127.0.0.1\t65389\t127.0.0.1\t6666\tirc_invalid_names_line\t-\tF\tbro\n+#close\t2018-09-13-00-31-10"
        },
        {
          "filename": "testing/btest/Traces/irc-353.pcap",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "testing/btest/scripts/base/protocols/irc/names-weird.bro",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+# @TEST-EXEC: bro -C -r $TRACES/irc-353.pcap %INPUT\n+# @TEST-EXEC: btest-diff weird.log\n+\n+event irc_names_info(c: connection, is_orig: bool, c_type: string, channel: string, users: string_set)\n+\t{\n+\tprint channel, users;\n+\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 4,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0478c45f811f4a3e0efacf3cd30d2604413a1bd3",
            "date": "2023-03-24T00:29:58Z",
            "author_login": "zeek-bot"
          },
          {
            "sha": "71f487bd209bf88d5c271ae4f3be69c0a0874ef1",
            "date": "2023-03-23T12:40:26Z",
            "author_login": "awelzel"
          },
          {
            "sha": "890d2b5e07e3ab96a12d0deafd5864fbcf741f77",
            "date": "2023-03-23T12:35:28Z",
            "author_login": "awelzel"
          },
          {
            "sha": "fd15a33f8c57e9fd16cd2dec1fb817cf890dc892",
            "date": "2023-03-23T11:35:30Z",
            "author_login": "awelzel"
          },
          {
            "sha": "833dd158de56948ecfec98c7749c00e8254d7a6a",
            "date": "2023-03-20T13:24:48Z",
            "author_login": "awelzel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "In Bro through 2.5.5, there is a DoS in IRC protocol names command parsing in analyzer/protocol/irc/IRC.cc.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-09-13T19:29:00.557",
    "last_modified": "2024-11-21T03:53:43.073",
    "fix_date": "2018-09-13T00:47:57Z"
  },
  "references": [
    {
      "url": "https://github.com/bro/bro/commit/c2b18849f8bb833253538f5dfedb4ed1dc176a30",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bro/bro/commit/c2b18849f8bb833253538f5dfedb4ed1dc176a30",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:35.816374",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bro",
    "owner": "bro",
    "created_at": "2018-12-05T15:30:12Z",
    "updated_at": "2025-01-08T22:44:55Z",
    "pushed_at": "2023-03-24T00:40:41Z",
    "size": 137794,
    "stars": 168,
    "forks": 48,
    "open_issues": 0,
    "watchers": 168,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 5744981,
      "Zeek": 4631033,
      "CMake": 110742,
      "Yacc": 68545,
      "Shell": 59447,
      "Lex": 42201,
      "Dockerfile": 15777,
      "Python": 14618,
      "Makefile": 6130,
      "C": 4087,
      "Batchfile": 1008
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:23:31.807878"
  }
}