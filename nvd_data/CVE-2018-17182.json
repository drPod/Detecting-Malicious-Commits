{
  "cve_id": "CVE-2018-17182",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
    "related_commits": [
      "7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
      "7a9cdebdcc17e426fb5287e4a82db1dfe86339b2"
    ],
    "patch_url": "https://github.com/torvalds/linux/commit/7a9cdebdcc17e426fb5287e4a82db1dfe86339b2.patch",
    "fix_commit_details": {
      "sha": "7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
      "commit_date": "2018-09-13T09:57:48Z",
      "author": {
        "login": "torvalds",
        "type": "User",
        "stats": {
          "total_commits": 38386,
          "average_weekly_commits": 32.28427249789739,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 880
        }
      },
      "commit_message": {
        "title": "mm: get rid of vmacache_flush_all() entirely",
        "length": 964,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 52,
        "additions": 4,
        "deletions": 48
      },
      "files": [
        {
          "filename": "include/linux/mm_types.h",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -341,7 +341,7 @@ struct mm_struct {\n \tstruct {\n \t\tstruct vm_area_struct *mmap;\t\t/* list of VMAs */\n \t\tstruct rb_root mm_rb;\n-\t\tu32 vmacache_seqnum;                   /* per-thread vmacache */\n+\t\tu64 vmacache_seqnum;                   /* per-thread vmacache */\n #ifdef CONFIG_MMU\n \t\tunsigned long (*get_unmapped_area) (struct file *filp,\n \t\t\t\tunsigned long addr, unsigned long len,"
        },
        {
          "filename": "include/linux/mm_types_task.h",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -32,7 +32,7 @@\n #define VMACACHE_MASK (VMACACHE_SIZE - 1)\n \n struct vmacache {\n-\tu32 seqnum;\n+\tu64 seqnum;\n \tstruct vm_area_struct *vmas[VMACACHE_SIZE];\n };\n "
        },
        {
          "filename": "include/linux/vm_event_item.h",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -105,7 +105,6 @@ enum vm_event_item { PGPGIN, PGPGOUT, PSWPIN, PSWPOUT,\n #ifdef CONFIG_DEBUG_VM_VMACACHE\n \t\tVMACACHE_FIND_CALLS,\n \t\tVMACACHE_FIND_HITS,\n-\t\tVMACACHE_FULL_FLUSHES,\n #endif\n #ifdef CONFIG_SWAP\n \t\tSWAP_RA,"
        },
        {
          "filename": "include/linux/vmacache.h",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -10,7 +10,6 @@ static inline void vmacache_flush(struct task_struct *tsk)\n \tmemset(tsk->vmacache.vmas, 0, sizeof(tsk->vmacache.vmas));\n }\n \n-extern void vmacache_flush_all(struct mm_struct *mm);\n extern void vmacache_update(unsigned long addr, struct vm_area_struct *newvma);\n extern struct vm_area_struct *vmacache_find(struct mm_struct *mm,\n \t\t\t\t\t\t    unsigned long addr);\n@@ -24,10 +23,6 @@ extern struct vm_area_struct *vmacache_find_exact(struct mm_struct *mm,\n static inline void vmacache_invalidate(struct mm_struct *mm)\n {\n \tmm->vmacache_seqnum++;\n-\n-\t/* deal with overflows */\n-\tif (unlikely(mm->vmacache_seqnum == 0))\n-\t\tvmacache_flush_all(mm);\n }\n \n #endif /* __LINUX_VMACACHE_H */"
        },
        {
          "filename": "mm/debug.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -114,7 +114,7 @@ EXPORT_SYMBOL(dump_vma);\n \n void dump_mm(const struct mm_struct *mm)\n {\n-\tpr_emerg(\"mm %px mmap %px seqnum %d task_size %lu\\n\"\n+\tpr_emerg(\"mm %px mmap %px seqnum %llu task_size %lu\\n\"\n #ifdef CONFIG_MMU\n \t\t\"get_unmapped_area %px\\n\"\n #endif\n@@ -142,7 +142,7 @@ void dump_mm(const struct mm_struct *mm)\n \t\t\"tlb_flush_pending %d\\n\"\n \t\t\"def_flags: %#lx(%pGv)\\n\",\n \n-\t\tmm, mm->mmap, mm->vmacache_seqnum, mm->task_size,\n+\t\tmm, mm->mmap, (long long) mm->vmacache_seqnum, mm->task_size,\n #ifdef CONFIG_MMU\n \t\tmm->get_unmapped_area,\n #endif"
        },
        {
          "filename": "mm/vmacache.c",
          "status": "modified",
          "additions": 0,
          "deletions": 38,
          "patch": "@@ -19,44 +19,6 @@\n #endif\n #define VMACACHE_HASH(addr) ((addr >> VMACACHE_SHIFT) & VMACACHE_MASK)\n \n-/*\n- * Flush vma caches for threads that share a given mm.\n- *\n- * The operation is safe because the caller holds the mmap_sem\n- * exclusively and other threads accessing the vma cache will\n- * have mmap_sem held at least for read, so no extra locking\n- * is required to maintain the vma cache.\n- */\n-void vmacache_flush_all(struct mm_struct *mm)\n-{\n-\tstruct task_struct *g, *p;\n-\n-\tcount_vm_vmacache_event(VMACACHE_FULL_FLUSHES);\n-\n-\t/*\n-\t * Single threaded tasks need not iterate the entire\n-\t * list of process. We can avoid the flushing as well\n-\t * since the mm's seqnum was increased and don't have\n-\t * to worry about other threads' seqnum. Current's\n-\t * flush will occur upon the next lookup.\n-\t */\n-\tif (atomic_read(&mm->mm_users) == 1)\n-\t\treturn;\n-\n-\trcu_read_lock();\n-\tfor_each_process_thread(g, p) {\n-\t\t/*\n-\t\t * Only flush the vmacache pointers as the\n-\t\t * mm seqnum is already set and curr's will\n-\t\t * be set upon invalidation when the next\n-\t\t * lookup is done.\n-\t\t */\n-\t\tif (mm == p->mm)\n-\t\t\tvmacache_flush(p);\n-\t}\n-\trcu_read_unlock();\n-}\n-\n /*\n  * This task may be accessing a foreign mm via (for example)\n  * get_user_pages()->find_vma().  The vmacache is task-local and this"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7f5b6a8ec18e3add4c74682f60b90c31bdf849f2",
            "date": "2025-01-14T19:32:14Z",
            "author_login": "torvalds"
          },
          {
            "sha": "c3812b15000cc5b7b17c7238f8b12f6a22df0b1d",
            "date": "2025-01-14T18:07:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "79a1d390f879563119bf2848b621bc7eed228c7d",
            "date": "2025-01-14T17:54:57Z",
            "author_login": "torvalds"
          },
          {
            "sha": "c45323b7560ec87c37c729b703c86ee65f136d75",
            "date": "2025-01-13T17:03:18Z",
            "author_login": "torvalds"
          },
          {
            "sha": "34c8e74cd6667ef5da90d448a1af702c4b873bd3",
            "date": "2025-01-13T08:52:08Z",
            "author_login": "YageGeng"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-416",
    "description": "An issue was discovered in the Linux kernel through 4.18.8. The vmacache_flush_all function in mm/vmacache.c mishandles sequence number overflows. An attacker can trigger a use-after-free (and possibly gain privileges) via certain thread creation, map, unmap, invalidation, and dereference operations.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2018-09-19T09:29:00.620",
    "last_modified": "2024-11-21T03:54:02.213",
    "fix_date": "2018-09-13T09:57:48Z"
  },
  "references": [
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/105417",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/106503",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1041748",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3656",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/10/msg00003.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20190204-0001/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3776-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3776-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3777-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3777-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3777-3/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4308",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/45497/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2018/09/18/4",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/105417",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/106503",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securitytracker.com/id/1041748",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:3656",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/7a9cdebdcc17e426fb5287e4a82db1dfe86339b2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/10/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20190204-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3776-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3776-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3777-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3777-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3777-3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4308",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/45497/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2018/09/18/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:35.827053",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-14T12:39:03Z",
    "pushed_at": "2025-01-13T17:27:04Z",
    "size": 5361369,
    "stars": 185823,
    "forks": 54743,
    "open_issues": 437,
    "watchers": 185823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1326937103,
      "Assembly": 9568292,
      "Shell": 5072004,
      "Python": 2974128,
      "Makefile": 2713905,
      "Perl": 1253637,
      "Rust": 807711,
      "Roff": 202277,
      "C++": 173382,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71321,
      "Awk": 69539,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10172,
      "M4": 3329,
      "MATLAB": 2482,
      "sed": 2433,
      "Clojure": 2411,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 46007,
      "avg_commits_per_week": 884.75,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:59.486675"
  }
}