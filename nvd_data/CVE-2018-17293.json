{
  "cve_id": "CVE-2018-17293",
  "github_data": {
    "repository": "WAVM/WAVM",
    "fix_commit": "31d670b6489e6d708c3b04b911cdf14ac43d846d",
    "related_commits": [
      "31d670b6489e6d708c3b04b911cdf14ac43d846d",
      "31d670b6489e6d708c3b04b911cdf14ac43d846d"
    ],
    "patch_url": "https://github.com/WAVM/WAVM/commit/31d670b6489e6d708c3b04b911cdf14ac43d846d.patch",
    "fix_commit_details": {
      "sha": "31d670b6489e6d708c3b04b911cdf14ac43d846d",
      "commit_date": "2018-09-16T13:55:34Z",
      "author": {
        "login": "AndrewScheidecker",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix dereferencing null pointer when running wavm with WebAssembly main function that takes command-line arguments but no Emscripten memory to write them to",
        "length": 155,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 10,
        "deletions": 8
      },
      "files": [
        {
          "filename": "Programs/wavm/wavm.cpp",
          "status": "modified",
          "additions": 10,
          "deletions": 8,
          "patch": "@@ -250,21 +250,23 @@ static int run(const CommandLineOptions& options)\n \t{\n \t\tif(functionType.params().size() == 2)\n \t\t{\n-\t\t\tMemoryInstance* defaultMemory = Runtime::getDefaultMemory(moduleInstance);\n-\t\t\tif(!defaultMemory)\n+\t\t\tif(!emscriptenInstance)\n \t\t\t{\n \t\t\t\tLog::printf(\n \t\t\t\t\tLog::error,\n \t\t\t\t\t\"Module does not declare a default memory object to put arguments in.\\n\");\n \t\t\t\treturn EXIT_FAILURE;\n \t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\tstd::vector<const char*> argStrings;\n+\t\t\t\targStrings.push_back(options.filename);\n+\t\t\t\tchar** args = options.args;\n+\t\t\t\twhile(*args) { argStrings.push_back(*args++); };\n \n-\t\t\tstd::vector<const char*> argStrings;\n-\t\t\targStrings.push_back(options.filename);\n-\t\t\tchar** args = options.args;\n-\t\t\twhile(*args) { argStrings.push_back(*args++); };\n-\n-\t\t\tEmscripten::injectCommandArgs(emscriptenInstance, argStrings, invokeArgs);\n+\t\t\t\twavmAssert(emscriptenInstance);\n+\t\t\t\tEmscripten::injectCommandArgs(emscriptenInstance, argStrings, invokeArgs);\n+\t\t\t}\n \t\t}\n \t\telse if(functionType.params().size() > 0)\n \t\t{"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3f9a150cac7faf28eab357a2c5b83d2ec740c7d9",
            "date": "2022-05-14T07:51:49Z",
            "author_login": "AndrewScheidecker"
          },
          {
            "sha": "0ccbeb6d98b2f3b33b9b0fc9a58e4b10b443b5fe",
            "date": "2022-05-03T07:14:18Z",
            "author_login": "AndrewScheidecker"
          },
          {
            "sha": "21344d0160d73e3e79259ec92081e35e9dd0042a",
            "date": "2022-05-03T11:21:56Z",
            "author_login": "AndrewScheidecker"
          },
          {
            "sha": "46d25c2ae35bc39cc0f42f4ec0f0c653f2ef4e18",
            "date": "2021-07-15T11:22:06Z",
            "author_login": "CZDanol"
          },
          {
            "sha": "0185b0754a48502708ab56bd710f0815bc98150b",
            "date": "2022-02-09T15:01:02Z",
            "author_login": "eigenraven"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-476",
    "description": "An issue was discovered in WAVM before 2018-09-16. The run function in Programs/wavm/wavm.cpp does not check whether there is Emscripten memory to store the command-line arguments passed by the input WebAssembly file's main function, which allows attackers to cause a denial of service (application crash by NULL pointer dereference) or possibly have unspecified other impact by crafting certain WebAssembly files.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-09-21T07:29:00.457",
    "last_modified": "2024-11-21T03:54:11.387",
    "fix_date": "2018-09-16T13:55:34Z"
  },
  "references": [
    {
      "url": "https://github.com/WAVM/WAVM/commit/31d670b6489e6d708c3b04b911cdf14ac43d846d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/WAVM/WAVM/issues/110#issuecomment-421764693",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/WAVM/WAVM/commit/31d670b6489e6d708c3b04b911cdf14ac43d846d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/WAVM/WAVM/issues/110#issuecomment-421764693",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:35.830269",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "WAVM",
    "owner": "WAVM",
    "created_at": "2015-08-21T11:14:30Z",
    "updated_at": "2025-01-14T06:56:27Z",
    "pushed_at": "2024-02-14T18:05:44Z",
    "size": 16121,
    "stars": 2667,
    "forks": 226,
    "open_issues": 94,
    "watchers": 2667,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 1711431,
      "Python": 488570,
      "C": 322362,
      "CMake": 59799,
      "Shell": 13787,
      "Assembly": 2892,
      "Dockerfile": 532
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T17:17:25.568705"
  }
}