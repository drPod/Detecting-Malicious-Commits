{
  "cve_id": "CVE-2018-17942",
  "github_data": {
    "repository": "coreutils/gnulib",
    "fix_commit": "278b4175c9d7dd47c1a3071554aac02add3b3c35",
    "related_commits": [
      "278b4175c9d7dd47c1a3071554aac02add3b3c35",
      "278b4175c9d7dd47c1a3071554aac02add3b3c35"
    ],
    "patch_url": "https://github.com/coreutils/gnulib/commit/278b4175c9d7dd47c1a3071554aac02add3b3c35.patch",
    "fix_commit_details": {
      "sha": "278b4175c9d7dd47c1a3071554aac02add3b3c35",
      "commit_date": "2018-09-23T12:13:52Z",
      "author": {
        "login": "bhaible",
        "type": "User",
        "stats": {
          "total_commits": 10257,
          "average_weekly_commits": 6.076421800947867,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 746
        }
      },
      "commit_message": {
        "title": "vasnprintf: Fix heap memory overrun bug.",
        "length": 296,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 32,
        "deletions": 2
      },
      "files": [
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,3 +1,12 @@\n+2018-09-23  Bruno Haible  <bruno@clisp.org>\n+\n+\tvasnprintf: Fix heap memory overrun bug.\n+\tReported by Ben Pfaff <blp@cs.stanford.edu> in\n+\t<https://lists.gnu.org/archive/html/bug-gnulib/2018-09/msg00107.html>.\n+\t* lib/vasnprintf.c (convert_to_decimal): Allocate one more byte of\n+\tmemory.\n+\t* tests/test-vasnprintf.c (test_function): Add another test.\n+\n 2018-09-19  Paul Eggert  <eggert@cs.ucla.edu>\n \n \tmaint: mktime.c now shared with glibc"
        },
        {
          "filename": "lib/vasnprintf.c",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -860,7 +860,9 @@ convert_to_decimal (mpn_t a, size_t extra_zeroes)\n   size_t a_len = a.nlimbs;\n   /* 0.03345 is slightly larger than log(2)/(9*log(10)).  */\n   size_t c_len = 9 * ((size_t)(a_len * (GMP_LIMB_BITS * 0.03345f)) + 1);\n-  char *c_ptr = (char *) malloc (xsum (c_len, extra_zeroes));\n+  /* We need extra_zeroes bytes for zeroes, followed by c_len bytes for the\n+     digits of a, followed by 1 byte for the terminating NUL.  */\n+  char *c_ptr = (char *) malloc (xsum (xsum (extra_zeroes, c_len), 1));\n   if (c_ptr != NULL)\n     {\n       char *d_ptr = c_ptr;"
        },
        {
          "filename": "tests/test-vasnprintf.c",
          "status": "modified",
          "additions": 20,
          "deletions": 1,
          "patch": "@@ -53,7 +53,26 @@ test_function (char * (*my_asnprintf) (char *, size_t *, const char *, ...))\n       ASSERT (result != NULL);\n       ASSERT (strcmp (result, \"12345\") == 0);\n       ASSERT (length == 5);\n-      if (size < 6)\n+      if (size < 5 + 1)\n+        ASSERT (result != buf);\n+      ASSERT (memcmp (buf + size, &\"DEADBEEF\"[size], 8 - size) == 0);\n+      if (result != buf)\n+        free (result);\n+    }\n+\n+  /* Note: This test assumes IEEE 754 representation of 'double' floats.  */\n+  for (size = 0; size <= 8; size++)\n+    {\n+      size_t length;\n+      char *result;\n+\n+      memcpy (buf, \"DEADBEEF\", 8);\n+      length = size;\n+      result = my_asnprintf (buf, &length, \"%2.0f\", 1.6314159265358979e+125);\n+      ASSERT (result != NULL);\n+      ASSERT (strcmp (result, \"163141592653589790215729350939528493057529598899734151772468186268423257777068536614838678161083520756952076273094236944990208\") == 0);\n+      ASSERT (length == 126);\n+      if (size < 126 + 1)\n         ASSERT (result != buf);\n       ASSERT (memcmp (buf + size, &\"DEADBEEF\"[size], 8 - size) == 0);\n       if (result != buf)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "359c0781e609bd93c6d79a5161a8186ebf15eda2",
            "date": "2025-01-14T15:21:08Z",
            "author_login": "jas4711"
          },
          {
            "sha": "bafecc478e9a351fd0f98846110a34d4bde6944a",
            "date": "2025-01-14T06:25:24Z",
            "author_login": "jas4711"
          },
          {
            "sha": "5a2d28dfb0bd327a491bf4eaea41ea861d43d771",
            "date": "2025-01-13T18:17:21Z",
            "author_login": "eggert"
          },
          {
            "sha": "54636e00ee0fb69518b8eb3a111a6c566cc11bde",
            "date": "2025-01-13T09:04:04Z",
            "author_login": "bhaible"
          },
          {
            "sha": "539fa8c1d705c63d4e034def4719b0977d8a72a2",
            "date": "2025-01-13T06:28:44Z",
            "author_login": "collinfunk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-787",
    "description": "The convert_to_decimal function in vasnprintf.c in Gnulib before 2018-09-23 has a heap-based buffer overflow because memory is not allocated for a trailing '\\0' character during %f processing.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-10-03T08:29:00.430",
    "last_modified": "2024-11-21T03:55:15.160",
    "fix_date": "2018-09-23T12:13:52Z"
  },
  "references": [
    {
      "url": "https://github.com/coreutils/gnulib/commit/278b4175c9d7dd47c1a3071554aac02add3b3c35",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/A5UQRNQE6XHMD5UYYHAU3VQWAYHIPMQS/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TMGHTVYH3KAFN34QXNSGEQDSTV7MCOQW/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.gnu.org/archive/html/bug-gnulib/2018-09/msg00107.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://savannah.gnu.org/bugs/?func=detailitem&item_id=54686",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/coreutils/gnulib/commit/278b4175c9d7dd47c1a3071554aac02add3b3c35",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/A5UQRNQE6XHMD5UYYHAU3VQWAYHIPMQS/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TMGHTVYH3KAFN34QXNSGEQDSTV7MCOQW/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.gnu.org/archive/html/bug-gnulib/2018-09/msg00107.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://savannah.gnu.org/bugs/?func=detailitem&item_id=54686",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:35.843917",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gnulib",
    "owner": "coreutils",
    "created_at": "2015-01-24T00:33:41Z",
    "updated_at": "2025-01-14T15:44:48Z",
    "pushed_at": "2025-01-14T15:44:44Z",
    "size": 367969,
    "stars": 281,
    "forks": 111,
    "open_issues": 3,
    "watchers": 281,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 27020981,
      "M4": 2760166,
      "Shell": 1132279,
      "C++": 644210,
      "Python": 496628,
      "TeX": 382610,
      "Makefile": 103191,
      "Perl": 77519,
      "Yacc": 75727,
      "Awk": 25009,
      "Common Lisp": 17532,
      "CSS": 3371,
      "Java": 1133,
      "sed": 862,
      "Roff": 550
    },
    "commit_activity": {
      "total_commits_last_year": 1839,
      "avg_commits_per_week": 35.36538461538461,
      "days_active_last_year": 309
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T18:21:39.412469"
  }
}