{
  "cve_id": "CVE-2018-18670",
  "github_data": {
    "repository": "gnuboard/gnuboard5",
    "fix_commit": "a45241f4bc46aee1ab2cc0749f6444b043681edf",
    "related_commits": [
      "a45241f4bc46aee1ab2cc0749f6444b043681edf",
      "a45241f4bc46aee1ab2cc0749f6444b043681edf"
    ],
    "patch_url": "https://github.com/gnuboard/gnuboard5/commit/a45241f4bc46aee1ab2cc0749f6444b043681edf.patch",
    "fix_commit_details": {
      "sha": "a45241f4bc46aee1ab2cc0749f6444b043681edf",
      "commit_date": "2018-10-30T00:42:48Z",
      "author": {
        "login": "thisgun",
        "type": "User",
        "stats": {
          "total_commits": 1546,
          "average_weekly_commits": 2.4080996884735204,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 261
        }
      },
      "commit_message": {
        "title": "XSS \ucde8\uc57d\uc810 \uc218\uc815",
        "length": 10,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 43,
        "additions": 31,
        "deletions": 12
      },
      "files": [
        {
          "filename": "adm/board_form_update.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -72,6 +72,9 @@\n //https://github.com/gnuboard/gnuboard5/commit/f5f4925d4eb28ba1af728e1065fc2bdd9ce1da58 \uc5d0 \ub530\ub978 \uc870\uce58\n $str_bo_category_list = isset($_POST['bo_category_list']) ? preg_replace(\"/[\\<\\>\\'\\\"\\\\\\'\\\\\\\"\\%\\=\\(\\)\\/\\^\\*]/\", \"\", $_POST['bo_category_list']) : '';\n \n+$_POST['bo_subject'] = strip_tags($_POST['bo_subject']);\n+$_POST['bo_mobile_subject'] = strip_tags($_POST['bo_mobile_subject']);\n+\n $sql_common = \" gr_id               = '{$_POST['gr_id']}',\n                 bo_subject          = '{$_POST['bo_subject']}',\n                 bo_mobile_subject   = '{$_POST['bo_mobile_subject']}',"
        },
        {
          "filename": "adm/boardgroup_form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -117,7 +117,7 @@\n             <label for=\"gr_<?php echo $i ?>_subj\">\uc5ec\ubd84\ud544\ub4dc <?php echo $i ?> \uc81c\ubaa9</label>\n             <input type=\"text\" name=\"gr_<?php echo $i ?>_subj\" value=\"<?php echo get_text($group['gr_'.$i.'_subj']) ?>\" id=\"gr_<?php echo $i ?>_subj\" class=\"frm_input\">\n             <label for=\"gr_<?php echo $i ?>\">\uc5ec\ubd84\ud544\ub4dc <?php echo $i ?> \ub0b4\uc6a9</label>\n-            <input type=\"text\" name=\"gr_<?php echo $i ?>\" value=\"<?php echo $gr['gr_'.$i] ?>\" id=\"gr_<?php echo $i ?>\" class=\"frm_input\">\n+            <input type=\"text\" name=\"gr_<?php echo $i ?>\" value=\"<?php echo get_sanitize_input($gr['gr_'.$i]); ?>\" id=\"gr_<?php echo $i ?>\" class=\"frm_input\">\n         </td>\n     </tr>\n     <?php } ?>"
        },
        {
          "filename": "adm/config_form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1317,7 +1317,7 @@\n                 <label for=\"cf_<?php echo $i ?>_subj\">\uc5ec\ubd84\ud544\ub4dc<?php echo $i ?> \uc81c\ubaa9</label>\n                 <input type=\"text\" name=\"cf_<?php echo $i ?>_subj\" value=\"<?php echo get_text($config['cf_'.$i.'_subj']) ?>\" id=\"cf_<?php echo $i ?>_subj\" class=\"frm_input\" size=\"30\">\n                 <label for=\"cf_<?php echo $i ?>\">\uc5ec\ubd84\ud544\ub4dc<?php echo $i ?> \uac12</label>\n-                <input type=\"text\" name=\"cf_<?php echo $i ?>\" value=\"<?php echo $config['cf_'.$i] ?>\" id=\"cf_<?php echo $i ?>\" class=\"frm_input\" size=\"30\">\n+                <input type=\"text\" name=\"cf_<?php echo $i ?>\" value=\"<?php echo get_sanitize_input($config['cf_'.$i]); ?>\" id=\"cf_<?php echo $i ?>\" class=\"frm_input\" size=\"30\">\n             </td>\n         </tr>\n         <?php } ?>"
        },
        {
          "filename": "adm/config_form_update.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -26,6 +26,8 @@\n \n $cf_social_servicelist = !empty($_POST['cf_social_servicelist']) ? implode(',', $_POST['cf_social_servicelist']) : '';\n \n+$_POST['cf_title'] = strip_tags($_POST['cf_title']);\n+\n $sql = \" update {$g5['config_table']}\n             set cf_title = '{$_POST['cf_title']}',\n                 cf_admin = '{$_POST['cf_admin']}',"
        },
        {
          "filename": "adm/menu_list.php",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -196,6 +196,20 @@ function base_convert(number, frombase, tobase) {\n \n function fmenulist_submit(f)\n {\n+\n+    var me_links = document.getElementsByName('me_link[]');\n+    var reg = /^javascript/; \n+\n+\tfor (i=0; i<me_links.length; i++){\n+        \n+\t    if( reg.test(me_links[i].value) ){ \n+        \n+            alert('\ub9c1\ud06c\uc5d0 \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8\ubb38\uc744 \uc785\ub825\ud560\uc218 \uc5c6\uc2b5\ub2c8\ub2e4.');\n+            me_links[i].focus();\n+            return false;\n+        }\n+    }\n+\n     return true;\n }\n </script>"
        },
        {
          "filename": "adm/menu_list_update.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -23,8 +23,8 @@\n \n     $code    = $_POST['code'][$i];\n     $me_name = $_POST['me_name'][$i];\n-    $me_link = $_POST['me_link'][$i];\n-\n+    $me_link = preg_match('/^javascript/', $_POST['me_link'][$i]) ? G5_URL : strip_tags($_POST['me_link'][$i]);\n+    \n     if(!$code || !$me_name || !$me_link)\n         continue;\n "
        },
        {
          "filename": "bbs/board_head.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -5,13 +5,13 @@\n if (G5_IS_MOBILE) {\n     // \ubaa8\ubc14\uc77c\uc758 \uacbd\uc6b0 \uc124\uc815\uc744 \ub530\ub974\uc9c0 \uc54a\ub294\ub2e4.\n     include_once(G5_BBS_PATH.'/_head.php');\n-    echo stripslashes($board['bo_mobile_content_head']);\n+    echo html_purifier(stripslashes($board['bo_mobile_content_head']));\n } else {\n     if(is_include_path_check($board['bo_include_head'])) {  //\ud30c\uc77c\uacbd\ub85c \uccb4\ud06c\n         @include ($board['bo_include_head']);\n     } else {    //\ud30c\uc77c\uacbd\ub85c\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc73c\uba74 \uae30\ubcf8\ud30c\uc77c\uc744 \uac00\uc838\uc634\n         include_once(G5_BBS_PATH.'/_head.php');\n     }\n-    echo stripslashes($board['bo_content_head']);\n+    echo html_purifier(stripslashes($board['bo_content_head']));\n }\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "bbs/board_tail.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -3,11 +3,11 @@\n \n // \uac8c\uc2dc\ud310 \uad00\ub9ac\uc758 \ud558\ub2e8 \ud30c\uc77c \uacbd\ub85c\n if (G5_IS_MOBILE) {\n-    echo stripslashes($board['bo_mobile_content_tail']);\n+    echo html_purifier(stripslashes($board['bo_mobile_content_tail']));\n     // \ubaa8\ubc14\uc77c\uc758 \uacbd\uc6b0 \uc124\uc815\uc744 \ub530\ub974\uc9c0 \uc54a\ub294\ub2e4.\n     include_once(G5_BBS_PATH.'/_tail.php');\n } else {\n-    echo stripslashes($board['bo_content_tail']);\n+    echo html_purifier(stripslashes($board['bo_content_tail']));\n     if(is_include_path_check($board['bo_include_tail'])) {  //\ud30c\uc77c\uacbd\ub85c \uccb4\ud06c\n         @include ($board['bo_include_tail']);\n     } else {    //\ud30c\uc77c\uacbd\ub85c\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc73c\uba74 \uae30\ubcf8\ud30c\uc77c\uc744 \uac00\uc838\uc634"
        },
        {
          "filename": "bbs/password.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -43,8 +43,8 @@\n \n include_once(G5_PATH.'/head.sub.php');\n \n-//if ($board['bo_include_head']) { @include ($board['bo_include_head']); }\n-//if ($board['bo_content_head']) { echo stripslashes($board['bo_content_head']); }\n+//if ($board['bo_include_head'] && is_include_path_check($board['bo_content_head'])) { @include ($board['bo_include_head']); }\n+//if ($board['bo_content_head']) { echo html_purifier(stripslashes($board['bo_content_head'])); }\n \n /* \ube44\ubc00\uae00\uc758 \uc81c\ubaa9\uc744 \uac00\uc838\uc634 \uc9c0\uc6b4\uc544\ube60 2013-01-29 */\n $sql = \" select wr_subject from {$write_table}\n@@ -57,8 +57,8 @@\n \n include_once($member_skin_path.'/password.skin.php');\n \n-//if ($board['bo_content_tail']) { echo stripslashes($board['bo_content_tail']); }\n-//if ($board['bo_include_tail']) { @include ($board['bo_include_tail']); }\n+//if ($board['bo_content_tail']) { echo html_purifier(stripslashes($board['bo_content_tail'])); }\n+//if ($board['bo_include_tail'] && is_include_path_check($board['bo_content_tail'])) { @include ($board['bo_include_tail']); }\n \n include_once(G5_PATH.'/tail.sub.php');\n ?>"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "af92ea064ef91a2f6a519df0cdf2e44e44b93023",
            "date": "2024-11-26T08:36:29Z",
            "author_login": "thisgun"
          },
          {
            "sha": "dab5abb89a2190d0d6ed60120ce10a4261097cde",
            "date": "2024-11-26T08:33:04Z",
            "author_login": "thisgun"
          },
          {
            "sha": "8893b112fa2dfda5576545658a686e1a5134123e",
            "date": "2024-11-21T02:58:55Z",
            "author_login": "thisgun"
          },
          {
            "sha": "d65fa99e3c3ba0b02250d9753b4051b13e01b915",
            "date": "2024-11-04T07:13:43Z",
            "author_login": "thisgun"
          },
          {
            "sha": "29381da2cef81b061e858a8b0dcc5b77835e39b5",
            "date": "2024-10-31T07:19:11Z",
            "author_login": "thisgun"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "GNUBOARD5 5.3.1.9 has XSS that allows remote attackers to inject arbitrary web script or HTML via the \"Extra Contents\" parameter, aka the adm/config_form_update.php cf_1~10 parameter.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-07-23T17:15:11.153",
    "last_modified": "2024-11-21T03:56:21.127",
    "fix_date": "2018-10-30T00:42:48Z"
  },
  "references": [
    {
      "url": "https://github.com/gnuboard/gnuboard5/commit/a45241f4bc46aee1ab2cc0749f6444b043681edf#diff-d1ecbee80f57fde59063c4fafcef1bce",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gnuboard/gnuboard5/compare/15b2e73...2549172",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gnuboard/gnuboard5/releases/tag/5.3.2.0",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gnuboard/gnuboard5/commit/a45241f4bc46aee1ab2cc0749f6444b043681edf#diff-d1ecbee80f57fde59063c4fafcef1bce",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gnuboard/gnuboard5/compare/15b2e73...2549172",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gnuboard/gnuboard5/releases/tag/5.3.2.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:54.803029",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gnuboard5",
    "owner": "gnuboard",
    "created_at": "2014-06-09T04:51:56Z",
    "updated_at": "2025-01-08T06:56:29Z",
    "pushed_at": "2025-01-02T00:34:27Z",
    "size": 63695,
    "stars": 312,
    "forks": 249,
    "open_issues": 45,
    "watchers": 312,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 12602254,
      "JavaScript": 3119949,
      "CSS": 1817938,
      "HTML": 853624,
      "GLSL": 2468,
      "Shell": 398,
      "Hack": 388
    },
    "commit_activity": {
      "total_commits_last_year": 91,
      "avg_commits_per_week": 1.75,
      "days_active_last_year": 36
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:58:32.210945"
  }
}