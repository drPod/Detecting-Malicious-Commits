{
  "cve_id": "CVE-2018-19182",
  "github_data": {
    "repository": "engelsystem/engelsystem",
    "fix_commit": "2e28336818183e2c63c8015fb476bc01c822f50a",
    "related_commits": [
      "2e28336818183e2c63c8015fb476bc01c822f50a",
      "2e28336818183e2c63c8015fb476bc01c822f50a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2e28336818183e2c63c8015fb476bc01c822f50a",
      "commit_date": "2018-11-20T15:02:03Z",
      "author": {
        "login": "MyIgel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Require POST for sending forms",
        "length": 161,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 582,
        "additions": 304,
        "deletions": 278
      },
      "files": [
        {
          "filename": "includes/controller/angeltypes_controller.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -86,7 +86,7 @@ function angeltype_delete_controller()\n \n     $angeltype = load_angeltype();\n \n-    if (request()->has('confirmed')) {\n+    if (request()->hasPostData('delete')) {\n         AngelType_delete($angeltype);\n         success(sprintf(__('Angeltype %s deleted.'), AngelType_name_render($angeltype)));\n         redirect(page_link_to('angeltypes'));\n@@ -127,7 +127,7 @@ function angeltype_edit_controller()\n         $angeltype = AngelType_new();\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         if (!$supporter_mode) {"
        },
        {
          "filename": "includes/controller/event_config_controller.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,7 @@ function event_config_edit_controller()\n     /** @var Carbon $teardown_end_date */\n     $teardown_end_date = $config->get('teardown_end');\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         if ($request->has('event_name')) {"
        },
        {
          "filename": "includes/controller/shift_entries_controller.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -96,7 +96,7 @@ function shift_entry_create_controller_admin($shift, $angeltype)\n         $angeltype = $angeltypes[0];\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         ShiftEntry_create([\n             'SID'              => $shift['SID'],\n             'TID'              => $angeltype['id'],\n@@ -167,7 +167,7 @@ function shift_entry_create_controller_supporter($shift, $angeltype)\n         redirect(shift_link($shift));\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         ShiftEntry_create([\n             'SID'              => $shift['SID'],\n             'TID'              => $angeltype['id'],\n@@ -246,7 +246,7 @@ function shift_entry_create_controller_user($shift, $angeltype)\n     }\n \n     $comment = '';\n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $comment = strip_request_item_nl('comment');\n         ShiftEntry_create([\n             'SID'              => $shift['SID'],\n@@ -346,7 +346,7 @@ function shift_entry_delete_controller()\n         redirect(user_link($signout_user->id));\n     }\n \n-    if ($request->has('continue')) {\n+    if ($request->hasPostData('delete')) {\n         ShiftEntry_delete($shiftEntry);\n         success(__('Shift entry removed.'));\n         redirect(shift_link($shift));\n@@ -355,13 +355,13 @@ function shift_entry_delete_controller()\n     if ($user->id == $signout_user->id) {\n         return [\n             ShiftEntry_delete_title(),\n-            ShiftEntry_delete_view($shiftEntry, $shift, $angeltype, $signout_user->id)\n+            ShiftEntry_delete_view($shift, $angeltype, $signout_user->id)\n         ];\n     }\n \n     return [\n         ShiftEntry_delete_title(),\n-        ShiftEntry_delete_view_admin($shiftEntry, $shift, $angeltype, $signout_user)\n+        ShiftEntry_delete_view_admin($shift, $angeltype, $signout_user)\n     ];\n }\n "
        },
        {
          "filename": "includes/controller/shifts_controller.php",
          "status": "modified",
          "additions": 6,
          "deletions": 5,
          "patch": "@@ -81,7 +81,7 @@ function shift_edit_controller()\n     $start = $shift['start'];\n     $end = $shift['end'];\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         // Name/Bezeichnung der Schicht, darf leer sein\n         $title = strip_request_item('title');\n \n@@ -222,7 +222,7 @@ function shift_delete_controller()\n     }\n \n     // Schicht l\u00f6schen best\u00e4tigt\n-    if ($request->has('delete')) {\n+    if ($request->hasPostData('delete')) {\n         Shift_delete($shift_id);\n \n         engelsystem_log(\n@@ -241,9 +241,10 @@ function shift_delete_controller()\n             date('Y-m-d H:i', $shift['start']),\n             date('H:i', $shift['end'])\n         ), true),\n-        '<a class=\"button\" href=\"'\n-        . page_link_to('user_shifts', ['delete_shift' => $shift_id, 'delete' => 1]) .\n-        '\">' . __('delete') . '</a>'\n+        form([\n+            form_hidden('delete_shift', $shift_id),\n+            form_submit('delete', __('delete')),\n+        ]),\n     ]);\n }\n "
        },
        {
          "filename": "includes/controller/shifttypes_controller.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -26,7 +26,7 @@ function shifttype_delete_controller()\n         redirect(page_link_to('shifttypes'));\n     }\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('delete')) {\n         ShiftType_delete($shifttype['id']);\n \n         engelsystem_log('Deleted shifttype ' . $shifttype['name']);\n@@ -67,7 +67,7 @@ function shifttype_edit_controller()\n         $description = $shifttype['description'];\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         if ($request->has('name') && $request->input('name') != '') {"
        },
        {
          "filename": "includes/controller/user_angeltypes_controller.php",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -59,7 +59,7 @@ function user_angeltypes_delete_all_controller()\n         redirect(page_link_to('angeltypes'));\n     }\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('deny_all')) {\n         UserAngelTypes_delete_all($angeltype['id']);\n \n         engelsystem_log(sprintf('Denied all users for angeltype %s', AngelType_name_render($angeltype)));\n@@ -100,7 +100,7 @@ function user_angeltypes_confirm_all_controller()\n         redirect(page_link_to('angeltypes'));\n     }\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('confirm_all')) {\n         UserAngelTypes_confirm_all($angeltype['id'], $user->id);\n \n         engelsystem_log(sprintf('Confirmed all users for angeltype %s', AngelType_name_render($angeltype)));\n@@ -152,7 +152,7 @@ function user_angeltype_confirm_controller()\n         redirect(page_link_to('angeltypes'));\n     }\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('confirm_user')) {\n         UserAngelType_confirm($user_angeltype['id'], $user->id);\n \n         engelsystem_log(sprintf(\n@@ -212,7 +212,7 @@ function user_angeltype_delete_controller()\n         redirect(page_link_to('angeltypes'));\n     }\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('delete')) {\n         UserAngelType_delete($user_angeltype);\n \n         $success_message = sprintf(__('User %s removed from %s.'), User_Nick_render($user_source), $angeltype['name']);\n@@ -274,7 +274,7 @@ function user_angeltype_update_controller()\n         redirect(page_link_to('angeltypes'));\n     }\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('submit')) {\n         UserAngelType_update($user_angeltype['id'], $supporter);\n \n         $success_message = sprintf(\n@@ -318,7 +318,7 @@ function user_angeltype_add_controller()\n     // Load possible users, that are not in the angeltype already\n     $users_source = Users_by_angeltype_inverted($angeltype);\n \n-    if (request()->has('submit')) {\n+    if (request()->hasPostData('submit')) {\n         $user_source = load_user();\n \n         if (!UserAngelType_exists($user_source->id, $angeltype)) {\n@@ -369,7 +369,7 @@ function user_angeltype_join_controller($angeltype)\n         redirect(page_link_to('angeltypes'));\n     }\n \n-    if (request()->has('confirmed')) {\n+    if (request()->hasPostData('submit')) {\n         $user_angeltype_id = UserAngelType_create($user->id, $angeltype);\n \n         $success_message = sprintf(__('You joined %s.'), $angeltype['name']);"
        },
        {
          "filename": "includes/controller/user_driver_licenses_controller.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -114,7 +114,7 @@ function user_driver_license_edit_controller()\n         $wants_to_drive = true;\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $wants_to_drive = $request->has('wants_to_drive');\n         if ($wants_to_drive) {\n             $user_driver_license['has_car'] = $request->has('has_car');"
        },
        {
          "filename": "includes/controller/user_worklog_controller.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -16,7 +16,7 @@ function user_worklog_delete_controller()\n     }\n     $user_source = User::find($userWorkLog['user_id']);\n \n-    if ($request->has('confirmed')) {\n+    if ($request->hasPostData('submit')) {\n         UserWorkLog_delete($userWorkLog);\n \n         success(__('Work log entry deleted.'));\n@@ -25,7 +25,7 @@ function user_worklog_delete_controller()\n \n     return [\n         UserWorkLog_delete_title(),\n-        UserWorkLog_delete_view($user_source, $userWorkLog)\n+        UserWorkLog_delete_view($user_source)\n     ];\n }\n \n@@ -43,7 +43,7 @@ function user_worklog_edit_controller()\n     }\n     $user_source = User::find($userWorkLog['user_id']);\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         list ($valid, $userWorkLog) = user_worklog_from_request($userWorkLog);\n \n         if ($valid) {\n@@ -114,7 +114,7 @@ function user_worklog_add_controller()\n \n     $userWorkLog = UserWorkLog_new($user_source->id);\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         list ($valid, $userWorkLog) = user_worklog_from_request($userWorkLog);\n \n         if ($valid) {"
        },
        {
          "filename": "includes/controller/users_controller.php",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -66,7 +66,7 @@ function user_delete_controller()\n         redirect(user_link($user->id));\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         if (\n@@ -80,6 +80,8 @@ function user_delete_controller()\n         }\n \n         if ($valid) {\n+            // Load data before user deletion to prevent errors when displaying\n+            $user_source->load(['contact', 'personalData', 'settings', 'state']);\n             $user_source->delete();\n \n             mail_user_delete($user_source);\n@@ -150,7 +152,7 @@ function user_edit_vouchers_controller()\n         redirect(page_link_to(''));\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         $vouchers = '';\n@@ -326,7 +328,7 @@ function user_password_recovery_set_new_controller()\n         redirect(page_link_to('login'));\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         if (\n@@ -361,7 +363,7 @@ function user_password_recovery_set_new_controller()\n function user_password_recovery_start_controller()\n {\n     $request = request();\n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         $user_source = null;"
        },
        {
          "filename": "includes/pages/admin_active.php",
          "status": "modified",
          "additions": 67,
          "deletions": 66,
          "patch": "@@ -49,7 +49,7 @@ function admin_active()\n             redirect(page_link_to('admin_active'));\n         }\n \n-        if ($request->has('ack')) {\n+        if ($request->hasPostData('ack')) {\n             State::query()\n                 ->where('got_shirt', '=', false)\n                 ->where('got_shirt', '=', false)\n@@ -94,61 +94,58 @@ function admin_active()\n \n             $msg = success(__('Marked angels.'), true);\n         } else {\n-            $set_active = '<a href=\"' . page_link_to('admin_active', ['search' => $search]) . '\">&laquo; '\n-                . __('back')\n-                . '</a> | <a href=\"'\n-                . page_link_to(\n-                    'admin_active',\n-                    ['search' => $search, 'count' => $count, 'set_active' => 1, 'ack' => 1]\n-                ) . '\">'\n-                . __('apply')\n-                . '</a>';\n+            $set_active = form([\n+                button(page_link_to('admin_active', ['search' => $search]), '&laquo; ' . __('back')),\n+                form_submit('ack', '&raquo; ' . __('apply')),\n+            ], page_link_to('admin_active', ['search' => $search, 'count' => $count, 'set_active' => 1]));\n         }\n     }\n \n-    if ($request->has('active') && preg_match('/^\\d+$/', $request->input('active'))) {\n-        $user_id = $request->input('active');\n-        $user_source = User::find($user_id);\n-        if ($user_source) {\n-            $user_source->state->active = true;\n-            $user_source->state->save();\n-            engelsystem_log('User ' . User_Nick_render($user_source) . ' is active now.');\n-            $msg = success(__('Angel has been marked as active.'), true);\n-        } else {\n-            $msg = error(__('Angel not found.'), true);\n-        }\n-    } elseif ($request->has('not_active') && preg_match('/^\\d+$/', $request->input('not_active'))) {\n-        $user_id = $request->input('not_active');\n-        $user_source = User::find($user_id);\n-        if ($user_source) {\n-            $user_source->state->active = false;\n-            $user_source->state->save();\n-            engelsystem_log('User ' . User_Nick_render($user_source) . ' is NOT active now.');\n-            $msg = success(__('Angel has been marked as not active.'), true);\n-        } else {\n-            $msg = error(__('Angel not found.'), true);\n-        }\n-    } elseif ($request->has('tshirt') && preg_match('/^\\d+$/', $request->input('tshirt'))) {\n-        $user_id = $request->input('tshirt');\n-        $user_source = User::find($user_id);\n-        if ($user_source) {\n-            $user_source->state->got_shirt = true;\n-            $user_source->state->save();\n-            engelsystem_log('User ' . User_Nick_render($user_source) . ' has tshirt now.');\n-            $msg = success(__('Angel has got a t-shirt.'), true);\n-        } else {\n-            $msg = error('Angel not found.', true);\n-        }\n-    } elseif ($request->has('not_tshirt') && preg_match('/^\\d+$/', $request->input('not_tshirt'))) {\n-        $user_id = $request->input('not_tshirt');\n-        $user_source = User::find($user_id);\n-        if ($user_source) {\n-            $user_source->state->got_shirt = false;\n-            $user_source->state->save();\n-            engelsystem_log('User ' . User_Nick_render($user_source) . ' has NO tshirt.');\n-            $msg = success(__('Angel has got no t-shirt.'), true);\n-        } else {\n-            $msg = error(__('Angel not found.'), true);\n+    if ($request->hasPostData('submit')) {\n+        if ($request->has('active') && preg_match('/^\\d+$/', $request->input('active'))) {\n+            $user_id = $request->input('active');\n+            $user_source = User::find($user_id);\n+            if ($user_source) {\n+                $user_source->state->active = true;\n+                $user_source->state->save();\n+                engelsystem_log('User ' . User_Nick_render($user_source) . ' is active now.');\n+                $msg = success(__('Angel has been marked as active.'), true);\n+            } else {\n+                $msg = error(__('Angel not found.'), true);\n+            }\n+        } elseif ($request->has('not_active') && preg_match('/^\\d+$/', $request->input('not_active'))) {\n+            $user_id = $request->input('not_active');\n+            $user_source = User::find($user_id);\n+            if ($user_source) {\n+                $user_source->state->active = false;\n+                $user_source->state->save();\n+                engelsystem_log('User ' . User_Nick_render($user_source) . ' is NOT active now.');\n+                $msg = success(__('Angel has been marked as not active.'), true);\n+            } else {\n+                $msg = error(__('Angel not found.'), true);\n+            }\n+        } elseif ($request->has('tshirt') && preg_match('/^\\d+$/', $request->input('tshirt'))) {\n+            $user_id = $request->input('tshirt');\n+            $user_source = User::find($user_id);\n+            if ($user_source) {\n+                $user_source->state->got_shirt = true;\n+                $user_source->state->save();\n+                engelsystem_log('User ' . User_Nick_render($user_source) . ' has tshirt now.');\n+                $msg = success(__('Angel has got a t-shirt.'), true);\n+            } else {\n+                $msg = error('Angel not found.', true);\n+            }\n+        } elseif ($request->has('not_tshirt') && preg_match('/^\\d+$/', $request->input('not_tshirt'))) {\n+            $user_id = $request->input('not_tshirt');\n+            $user_source = User::find($user_id);\n+            if ($user_source) {\n+                $user_source->state->got_shirt = false;\n+                $user_source->state->save();\n+                engelsystem_log('User ' . User_Nick_render($user_source) . ' has NO tshirt.');\n+                $msg = success(__('Angel has got no t-shirt.'), true);\n+            } else {\n+                $msg = error(__('Angel not found.'), true);\n+            }\n         }\n     }\n \n@@ -232,9 +229,10 @@ function admin_active()\n             if ($show_all_shifts) {\n                 $parameters['show_all_shifts'] = 1;\n             }\n-            $actions[] = '<a href=\"' . page_link_to('admin_active', $parameters) . '\">'\n-                . __('set active')\n-                . '</a>';\n+            $actions[] = form(\n+                [form_submit('submit', __('set active'), 'btn-xs', false)],\n+                page_link_to('admin_active', $parameters)\n+            );\n         }\n         if ($usr->state->active) {\n             $parametersRemove = [\n@@ -244,9 +242,10 @@ function admin_active()\n             if ($show_all_shifts) {\n                 $parametersRemove['show_all_shifts'] = 1;\n             }\n-            $actions[] = '<a href=\"' . page_link_to('admin_active', $parametersRemove) . '\">'\n-                . __('remove active')\n-                . '</a>';\n+            $actions[] = form(\n+                [form_submit('submit', __('remove active'), 'btn-xs', false)],\n+                page_link_to('admin_active', $parametersRemove)\n+            );\n         }\n         if (!$usr->state->got_shirt) {\n             $parametersShirt = [\n@@ -256,9 +255,10 @@ function admin_active()\n             if ($show_all_shifts) {\n                 $parametersShirt['show_all_shifts'] = 1;\n             }\n-            $actions[] = '<a href=\"' . page_link_to('admin_active', $parametersShirt) . '\">'\n-                . __('got t-shirt')\n-                . '</a>';\n+            $actions[] = form(\n+                [form_submit('submit', __('got t-shirt'), 'btn-xs', false)],\n+                page_link_to('admin_active', $parametersShirt)\n+            );\n         }\n         if ($usr->state->got_shirt) {\n             $parameters = [\n@@ -268,12 +268,13 @@ function admin_active()\n             if ($show_all_shifts) {\n                 $parameters['show_all_shifts'] = 1;\n             }\n-            $actions[] = '<a href=\"' . page_link_to('admin_active', $parameters) . '\">'\n-                . __('remove t-shirt')\n-                . '</a>';\n+            $actions[] = form(\n+                [form_submit('submit', __('remove t-shirt'), 'btn-xs', false)],\n+                page_link_to('admin_active', $parameters)\n+            );\n         }\n \n-        $userData['actions'] = join(' ', $actions);\n+        $userData['actions'] = buttons($actions);\n \n         $matched_users[] = $userData;\n     }"
        },
        {
          "filename": "includes/pages/admin_arrive.php",
          "status": "modified",
          "additions": 19,
          "deletions": 14,
          "patch": "@@ -24,8 +24,13 @@ function admin_arrive()\n         $search = trim($search);\n     }\n \n-    if ($request->has('reset') && preg_match('/^\\d+$/', $request->input('reset'))) {\n-        $user_id = $request->input('reset');\n+    $action = $request->get('action');\n+    if (\n+        $action == 'reset'\n+        && preg_match('/^\\d+$/', $request->input('user'))\n+        && $request->hasPostData('submit')\n+    ) {\n+        $user_id = $request->input('user');\n         $user_source = User::find($user_id);\n         if ($user_source) {\n             $user_source->state->arrived = false;\n@@ -38,8 +43,12 @@ function admin_arrive()\n         } else {\n             $msg = error(__('Angel not found.'), true);\n         }\n-    } elseif ($request->has('arrived') && preg_match('/^\\d+$/', $request->input('arrived'))) {\n-        $user_id = $request->input('arrived');\n+    } elseif (\n+        $action == 'arrived'\n+        && preg_match('/^\\d+$/', $request->input('user'))\n+        && $request->hasPostData('submit')\n+    ) {\n+        $user_id = $request->input('user');\n         $user_source = User::find($user_id);\n         if ($user_source) {\n             $user_source->state->arrived = true;\n@@ -88,15 +97,11 @@ function admin_arrive()\n         $usr['rendered_planned_arrival_date'] = $plannedArrivalDate ? $plannedArrivalDate->format('Y-m-d') : '-';\n         $usr['rendered_arrival_date'] = $arrivalDate ? $arrivalDate->format('Y-m-d') : '-';\n         $usr['arrived'] = $usr->state->arrived ? __('yes') : '';\n-        $usr['actions'] = $usr->state->arrived == 1\n-            ? '<a href=\"' . page_link_to(\n-                'admin_arrive',\n-                ['reset' => $usr->id, 'search' => $search]\n-            ) . '\">' . __('reset') . '</a>'\n-            : '<a href=\"' . page_link_to(\n-                'admin_arrive',\n-                ['arrived' => $usr->id, 'search' => $search]\n-            ) . '\">' . __('arrived') . '</a>';\n+        $usr['actions'] = form([\n+            form_hidden('action', $usr->state->arrived ? 'reset' : 'arrived'),\n+            form_hidden('user', $usr->id),\n+            form_submit('submit', $usr->state->arrived ? __('reset') : __('arrived'), 'btn-xs'),\n+        ]);\n \n         if ($usr->state->arrival_date) {\n             $day = $usr->state->arrival_date->format('Y-m-d');\n@@ -167,7 +172,7 @@ function admin_arrive()\n         form([\n             form_text('search', __('Search'), $search),\n             form_submit('submit', __('Search'))\n-        ]),\n+        ], page_link_to('admin_arrive')),\n         table([\n             'name'                            => __('Nickname'),\n             'rendered_planned_arrival_date'   => __('Planned arrival'),"
        },
        {
          "filename": "includes/pages/admin_groups.php",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -110,7 +110,11 @@ function admin_groups()\n                 break;\n \n             case 'save':\n-                if ($request->has('id') && preg_match('/^-\\d{1,11}$/', $request->input('id'))) {\n+                if (\n+                    $request->has('id')\n+                    && preg_match('/^-\\d{1,11}$/', $request->input('id'))\n+                    && $request->hasPostData('submit')\n+                ) {\n                     $group_id = $request->input('id');\n                 } else {\n                     return error('Incomplete call, missing Groups ID.', true);"
        },
        {
          "filename": "includes/pages/admin_import.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -54,7 +54,7 @@ function admin_import()\n         case 'input':\n             $valid = false;\n \n-            if ($request->has('submit')) {\n+            if ($request->hasPostData('submit')) {\n                 $valid = true;\n \n                 if ($request->has('shifttype_id') && isset($shifttypes[$request->input('shifttype_id')])) {"
        },
        {
          "filename": "includes/pages/admin_questions.php",
          "status": "modified",
          "additions": 16,
          "deletions": 12,
          "patch": "@@ -56,11 +56,9 @@ function admin_questions()\n                     form_textarea('answer', '', ''),\n                     form_submit('submit', __('Save'))\n                 ], page_link_to('admin_questions', ['action' => 'answer', 'id' => $question['QID']])),\n-                'actions'  => button(\n-                    page_link_to('admin_questions', ['action' => 'delete', 'id' => $question['QID']]),\n-                    __('delete'),\n-                    'btn-xs'\n-                )\n+                'actions'  => form([\n+                    form_submit('submit', __('delete'), 'btn-xs'),\n+                ], page_link_to('admin_questions', ['action' => 'delete', 'id' => $question['QID']])),\n             ];\n         }\n \n@@ -74,11 +72,9 @@ function admin_questions()\n                 'question'    => str_replace(\"\\n\", '<br />', $question['Question']),\n                 'answered_by' => User_Nick_render($answer_user_source),\n                 'answer'      => str_replace(\"\\n\", '<br />', $question['Answer']),\n-                'actions'     => button(\n-                    page_link_to('admin_questions', ['action' => 'delete', 'id' => $question['QID']]),\n-                    __('delete'),\n-                    'btn-xs'\n-                )\n+                'actions'     => form([\n+                    form_submit('submit', __('delete'), 'btn-xs')\n+                ], page_link_to('admin_questions', ['action' => 'delete', 'id' => $question['QID']]))\n             ];\n         }\n \n@@ -102,7 +98,11 @@ function admin_questions()\n     } else {\n         switch ($request->input('action')) {\n             case 'answer':\n-                if ($request->has('id') && preg_match('/^\\d{1,11}$/', $request->input('id'))) {\n+                if (\n+                    $request->has('id')\n+                    && preg_match('/^\\d{1,11}$/', $request->input('id'))\n+                    && $request->hasPostData('submit')\n+                ) {\n                     $question_id = $request->input('id');\n                 } else {\n                     return error('Incomplete call, missing Question ID.', true);\n@@ -142,7 +142,11 @@ function admin_questions()\n                 }\n                 break;\n             case 'delete':\n-                if ($request->has('id') && preg_match('/^\\d{1,11}$/', $request->input('id'))) {\n+                if (\n+                    $request->has('id')\n+                    && preg_match('/^\\d{1,11}$/', $request->input('id'))\n+                    && $request->hasPostData('submit')\n+                ) {\n                     $question_id = $request->input('id');\n                 } else {\n                     return error('Incomplete call, missing Question ID.', true);"
        },
        {
          "filename": "includes/pages/admin_rooms.php",
          "status": "modified",
          "additions": 5,
          "deletions": 9,
          "patch": "@@ -72,7 +72,7 @@ function admin_rooms()\n         }\n \n         if ($request->input('show') == 'edit') {\n-            if ($request->has('submit')) {\n+            if ($request->hasPostData('submit')) {\n                 $valid = true;\n \n                 if ($request->has('name') && strlen(strip_request_item('name')) > 0) {\n@@ -178,7 +178,7 @@ function admin_rooms()\n                 ])\n             ]);\n         } elseif ($request->input('show') == 'delete') {\n-            if ($request->has('ack')) {\n+            if ($request->hasPostData('ack')) {\n                 Room_delete($room_id);\n \n                 engelsystem_log('Room deleted: ' . $name);\n@@ -191,13 +191,9 @@ function admin_rooms()\n                     button(page_link_to('admin_rooms'), __('back'), 'back')\n                 ]),\n                 sprintf(__('Do you want to delete room %s?'), $name),\n-                buttons([\n-                    button(\n-                        page_link_to('admin_rooms', ['show' => 'delete', 'id' => $room_id, 'ack' => 1]),\n-                        __('Delete'),\n-                        'delete btn-danger'\n-                    )\n-                ])\n+                form([\n+                    form_submit('ack', __('Delete'), 'delete btn-danger'),\n+                ], page_link_to('admin_rooms', ['show' => 'delete', 'id' => $room_id])),\n             ]);\n         }\n     }"
        },
        {
          "filename": "includes/pages/admin_shifts.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -307,7 +307,7 @@ function admin_shifts()\n                 ])\n             ]);\n         }\n-    } elseif ($request->has('submit')) {\n+    } elseif ($request->hasPostData('submit')) {\n         if (\n             !is_array($session->get('admin_shifts_shifts'))\n             || !is_array($session->get('admin_shifts_types'))"
        },
        {
          "filename": "includes/pages/guest_login.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -79,7 +79,7 @@ function guest_register()\n         ]);\n     }\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $valid = true;\n \n         if ($request->has('nick') && strlen(User_validate_Nick($request->input('nick'))) > 1) {\n@@ -388,7 +388,7 @@ function guest_login()\n \n     $session->remove('uid');\n \n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         if ($request->has('nick') && strlen(User_validate_Nick($request->input('nick'))) > 0) {\n             $nick = User_validate_Nick($request->input('nick'));\n             $login_user = User::whereName($nick)->first();"
        },
        {
          "filename": "includes/pages/user_myshifts.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -77,7 +77,7 @@ function user_myshifts()\n             $freeloaded = $shift['freeloaded'];\n             $freeload_comment = $shift['freeload_comment'];\n \n-            if ($request->has('submit')) {\n+            if ($request->hasPostData('submit')) {\n                 $valid = true;\n                 if (in_array('user_shifts_admin', $privileges)) {\n                     $freeloaded = $request->has('freeloaded');"
        },
        {
          "filename": "includes/pages/user_news.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -142,7 +142,7 @@ function user_news_comments()\n     ) {\n         $nid = $request->input('nid');\n         $news = DB::selectOne('SELECT * FROM `News` WHERE `ID`=? LIMIT 1', [$nid]);\n-        if ($request->has('text')) {\n+        if ($request->hasPostData('submit') && $request->has('text')) {\n             $text = preg_replace(\n                 \"/([^\\p{L}\\p{P}\\p{Z}\\p{N}\\n]{1,})/ui\",\n                 '',"
        },
        {
          "filename": "includes/pages/user_questions.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -43,7 +43,7 @@ function user_questions()\n         switch ($request->input('action')) {\n             case 'ask':\n                 $question = strip_request_item_nl('question');\n-                if ($question != '') {\n+                if ($question != '' && $request->hasPostData('submit')) {\n                     DB::insert('\n                         INSERT INTO `Questions` (`UID`, `Question`)\n                         VALUES (?, ?)\n@@ -60,7 +60,11 @@ function user_questions()\n                 }\n                 break;\n             case 'delete':\n-                if ($request->has('id') && preg_match('/^\\d{1,11}$/', $request->input('id'))) {\n+                if (\n+                    $request->has('id')\n+                    && preg_match('/^\\d{1,11}$/', $request->input('id'))\n+                    && $request->hasPostData('submit')\n+                ) {\n                     $question_id = $request->input('id');\n                 } else {\n                     return error(__('Incomplete call, missing Question ID.'), true);"
        },
        {
          "filename": "includes/pages/user_settings.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -204,13 +204,13 @@ function user_settings()\n     }\n \n     $user_source = auth()->user();\n-    if ($request->has('submit')) {\n+    if ($request->hasPostData('submit')) {\n         $user_source = user_settings_main($user_source, $enable_tshirt_size, $tshirt_sizes);\n-    } elseif ($request->has('submit_password')) {\n+    } elseif ($request->hasPostData('submit_password')) {\n         user_settings_password($user_source);\n-    } elseif ($request->has('submit_theme')) {\n+    } elseif ($request->hasPostData('submit_theme')) {\n         $user_source = user_settings_theme($user_source, $themes);\n-    } elseif ($request->has('submit_language')) {\n+    } elseif ($request->hasPostData('submit_language')) {\n         $user_source = user_settings_locale($user_source, $locales);\n     }\n "
        },
        {
          "filename": "includes/sys_form.php",
          "status": "modified",
          "additions": 14,
          "deletions": 4,
          "patch": "@@ -216,13 +216,23 @@ function form_info($label, $text = '')\n  *\n  * @param string $name\n  * @param string $label\n+ * @param string $class\n+ * @param bool   $wrapForm\n  * @return string\n  */\n-function form_submit($name, $label)\n+function form_submit($name, $label, $class = '', $wrapForm = true)\n {\n+    $button = '<button class=\"btn btn-primary' . ($class ? ' ' . $class : '') . '\" type=\"submit\" name=\"' . $name . '\">'\n+        . $label\n+        . '</button>';\n+\n+    if (!$wrapForm) {\n+        return $button;\n+    }\n+\n     return form_element(\n-        '<button class=\"btn btn-primary\" type=\"submit\" name=\"' . $name . '\">' . $label . '</button>',\n-        ''\n+        null,\n+        $button\n     );\n }\n \n@@ -391,7 +401,7 @@ function form_select($name, $label, $values, $selected, $selectText = '')\n  */\n function form_element($label, $input, $for = '')\n {\n-    if ($label == '') {\n+    if (empty($label)) {\n         return '<div class=\"form-group\">' . $input . '</div>';\n     }\n "
        },
        {
          "filename": "includes/view/AngelTypes_view.php",
          "status": "modified",
          "additions": 6,
          "deletions": 11,
          "patch": "@@ -53,17 +53,12 @@ function AngelType_delete_view($angeltype)\n {\n     return page_with_title(sprintf(__('Delete angeltype %s'), $angeltype['name']), [\n         info(sprintf(__('Do you want to delete angeltype %s?'), $angeltype['name']), true),\n-        buttons([\n-            button(page_link_to('angeltypes'), glyph('remove') . __('cancel')),\n-            button(\n-                page_link_to(\n-                    'angeltypes',\n-                    ['action' => 'delete', 'angeltype_id' => $angeltype['id'], 'confirmed' => 1]\n-                ),\n-                glyph('ok') . __('delete'),\n-                'btn-danger'\n-            )\n-        ])\n+        form([\n+            buttons([\n+                button(page_link_to('angeltypes'), glyph('remove') . __('cancel')),\n+                form_submit('delete', glyph('ok') . __('delete'), 'btn-danger', false),\n+            ])\n+        ]),\n     ]);\n }\n "
        },
        {
          "filename": "includes/view/Questions_view.php",
          "status": "modified",
          "additions": 6,
          "deletions": 10,
          "patch": "@@ -9,22 +9,18 @@\n function Questions_view($open_questions, $answered_questions, $ask_action)\n {\n     foreach ($open_questions as &$question) {\n-        $question['actions'] = '<a href=\"'\n-            . page_link_to('user_questions', ['action' => 'delete', 'id' => $question['QID']])\n-            . '\">'\n-            . __('delete')\n-            . '</a>';\n+        $question['actions'] = form([\n+            form_submit('submit', __('delete'), 'btn-default btn-xs')\n+        ], page_link_to('user_questions', ['action' => 'delete', 'id' => $question['QID']]));\n         $question['Question'] = str_replace(\"\\n\", '<br />', $question['Question']);\n     }\n \n     foreach ($answered_questions as &$question) {\n         $question['Question'] = str_replace(\"\\n\", '<br />', $question['Question']);\n         $question['Answer'] = str_replace(\"\\n\", '<br />', $question['Answer']);\n-        $question['actions'] = '<a href=\"'\n-            . page_link_to('user_questions', ['action' => 'delete', 'id' => $question['QID']])\n-            . '\">'\n-            . __('delete')\n-            . '</a>';\n+        $question['actions'] = form([\n+            form_submit('submit', __('delete'), 'btn-default btn-xs')\n+        ], page_link_to('user_questions', ['action' => 'delete', 'id' => $question['QID']]));\n     }\n \n     return page_with_title(questions_title(), ["
        },
        {
          "filename": "includes/view/ShiftEntry_view.php",
          "status": "modified",
          "additions": 15,
          "deletions": 16,
          "patch": "@@ -5,14 +5,13 @@\n /**\n  * Sign off from an user from a shift with admin permissions, asking for ack.\n  *\n- * @param array $shiftEntry\n  * @param array $shift\n  * @param array $angeltype\n  * @param User  $signoff_user\n  *\n  * @return string HTML\n  */\n-function ShiftEntry_delete_view_admin($shiftEntry, $shift, $angeltype, $signoff_user)\n+function ShiftEntry_delete_view_admin($shift, $angeltype, $signoff_user)\n {\n     return page_with_title(ShiftEntry_delete_title(), [\n         info(sprintf(\n@@ -23,26 +22,25 @@ function ShiftEntry_delete_view_admin($shiftEntry, $shift, $angeltype, $signoff_\n             date('Y-m-d H:i', $shift['end']),\n             $angeltype['name']\n         ), true),\n-        buttons([\n-            button(user_link($signoff_user->id), glyph('remove') . __('cancel')),\n-            button(shift_entry_delete_link($shiftEntry, [\n-                'continue' => 1\n-            ]), glyph('ok') . __('delete'), 'btn-danger')\n-        ])\n+        form([\n+            buttons([\n+                button(user_link($signoff_user->id), glyph('remove') . __('cancel')),\n+                form_submit('delete', glyph('ok') . __('delete'), 'btn-danger', false)\n+            ]),\n+        ]),\n     ]);\n }\n \n /**\n  * Sign off from a shift, asking for ack.\n  *\n- * @param array $shiftEntry\n  * @param array $shift\n  * @param array $angeltype\n  * @param int   $signoff_user_id\n  *\n  * @return string HTML\n  */\n-function ShiftEntry_delete_view($shiftEntry, $shift, $angeltype, $signoff_user_id)\n+function ShiftEntry_delete_view($shift, $angeltype, $signoff_user_id)\n {\n     return page_with_title(ShiftEntry_delete_title(), [\n         info(sprintf(\n@@ -52,12 +50,13 @@ function ShiftEntry_delete_view($shiftEntry, $shift, $angeltype, $signoff_user_i\n             date('Y-m-d H:i', $shift['end']),\n             $angeltype['name']\n         ), true),\n-        buttons([\n-            button(user_link($signoff_user_id), glyph('remove') . __('cancel')),\n-            button(shift_entry_delete_link($shiftEntry, [\n-                'continue' => 1\n-            ]), glyph('ok') . __('delete'), 'btn-danger')\n-        ])\n+\n+        form([\n+            buttons([\n+                button(user_link($signoff_user_id), glyph('remove') . __('cancel')),\n+                form_submit('delete', glyph('ok') . __('delete'), 'btn-danger', false),\n+            ]),\n+        ]),\n     ]);\n }\n "
        },
        {
          "filename": "includes/view/ShiftTypes_view.php",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -21,17 +21,17 @@ function ShiftType_delete_view($shifttype)\n {\n     return page_with_title(sprintf(__('Delete shifttype %s'), $shifttype['name']), [\n         info(sprintf(__('Do you want to delete shifttype %s?'), $shifttype['name']), true),\n-        buttons([\n-            button(page_link_to('shifttypes'), glyph('remove') . __('cancel')),\n-            button(\n-                page_link_to(\n-                    'shifttypes',\n-                    ['action' => 'delete', 'shifttype_id' => $shifttype['id'], 'confirmed' => 1]\n+        form([\n+            buttons([\n+                button(page_link_to('shifttypes'), glyph('remove') . __('cancel')),\n+                form_submit(\n+                    'delete',\n+                    glyph('ok') . __('delete'),\n+                    'btn-danger',\n+                    false\n                 ),\n-                glyph('ok') . __('delete'),\n-                'btn-danger'\n-            )\n-        ])\n+            ]),\n+        ]),\n     ]);\n }\n "
        },
        {
          "filename": "includes/view/UserAngelTypes_view.php",
          "status": "modified",
          "additions": 51,
          "deletions": 72,
          "patch": "@@ -20,22 +20,19 @@ function UserAngelType_update_view($user_angeltype, $user, $angeltype, $supporte\n             $angeltype['name'],\n             User_Nick_render($user)\n         ), true),\n-        buttons([\n-            button(\n-                page_link_to('angeltypes', ['action' => 'view', 'angeltype_id' => $angeltype['id']]),\n-                glyph('remove') . __('cancel')\n-            ),\n-            button(\n-                page_link_to('user_angeltypes', [\n-                    'action'            => 'update',\n-                    'user_angeltype_id' => $user_angeltype['id'],\n-                    'supporter'         => ($supporter ? '1' : '0'),\n-                    'confirmed'         => 1,\n-                ]),\n-                glyph('ok') . __('yes'),\n-                'btn-primary'\n-            )\n-        ])\n+        form([\n+            buttons([\n+                button(\n+                    page_link_to('angeltypes', ['action' => 'view', 'angeltype_id' => $angeltype['id']]),\n+                    glyph('remove') . __('cancel')\n+                ),\n+                form_submit('submit', glyph('ok') . __('yes'), 'btn-primary', false),\n+            ]),\n+        ], page_link_to('user_angeltypes', [\n+            'action'            => 'update',\n+            'user_angeltype_id' => $user_angeltype['id'],\n+            'supporter'         => ($supporter ? '1' : '0'),\n+        ])),\n     ]);\n }\n \n@@ -48,23 +45,18 @@ function UserAngelTypes_delete_all_view($angeltype)\n     return page_with_title(__('Deny all users'), [\n         msg(),\n         info(sprintf(__('Do you really want to deny all users for %s?'), $angeltype['name']), true),\n-        buttons([\n-            button(\n-                page_link_to(\n-                    'angeltypes',\n-                    ['action' => 'view', 'angeltype_id' => $angeltype['id']]\n-                ),\n-                glyph('remove') . __('cancel')\n-            ),\n-            button(\n-                page_link_to(\n-                    'user_angeltypes',\n-                    ['action' => 'delete_all', 'angeltype_id' => $angeltype['id'], 'confirmed' => 1]\n+        form([\n+            buttons([\n+                button(\n+                    page_link_to(\n+                        'angeltypes',\n+                        ['action' => 'view', 'angeltype_id' => $angeltype['id']]\n+                    ),\n+                    glyph('remove') . __('cancel')\n                 ),\n-                glyph('ok') . __('yes'),\n-                'btn-primary'\n-            )\n-        ])\n+                form_submit('deny_all', glyph('ok') . __('yes'), 'btn-primary', false)\n+            ]),\n+        ], page_link_to('user_angeltypes', ['action' => 'delete_all', 'angeltype_id' => $angeltype['id']])),\n     ]);\n }\n \n@@ -77,15 +69,12 @@ function UserAngelTypes_confirm_all_view($angeltype)\n     return page_with_title(__('Confirm all users'), [\n         msg(),\n         info(sprintf(__('Do you really want to confirm all users for %s?'), $angeltype['name']), true),\n-        buttons([\n-            button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n-            button(\n-                page_link_to('user_angeltypes',\n-                    ['action' => 'confirm_all', 'angeltype_id' => $angeltype['id'], 'confirmed' => 1]),\n-                glyph('ok') . __('yes'),\n-                'btn-primary'\n-            )\n-        ])\n+        form([\n+            buttons([\n+                button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n+                form_submit('confirm_all', glyph('ok') . __('yes'), 'btn-primary', false),\n+            ]),\n+        ], page_link_to('user_angeltypes', ['action' => 'confirm_all', 'angeltype_id' => $angeltype['id']])),\n     ]);\n }\n \n@@ -104,17 +93,12 @@ function UserAngelType_confirm_view($user_angeltype, $user, $angeltype)\n             User_Nick_render($user),\n             $angeltype['name']\n         ), true),\n-        buttons([\n-            button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n-            button(\n-                page_link_to(\n-                    'user_angeltypes',\n-                    ['action' => 'confirm', 'user_angeltype_id' => $user_angeltype['id'], 'confirmed' => 1]\n-                ),\n-                glyph('ok') . __('yes'),\n-                'btn-primary'\n-            )\n-        ])\n+        form([\n+            buttons([\n+                button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n+                form_submit('confirm_user', glyph('ok') . __('yes'), 'btn-primary', false),\n+            ]),\n+        ], page_link_to('user_angeltypes', ['action' => 'confirm', 'user_angeltype_id' => $user_angeltype['id']])),\n     ]);\n }\n \n@@ -133,15 +117,12 @@ function UserAngelType_delete_view($user_angeltype, $user, $angeltype)\n             User_Nick_render($user),\n             $angeltype['name']\n         ), true),\n-        buttons([\n-            button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n-            button(\n-                page_link_to('user_angeltypes',\n-                    ['action' => 'delete', 'user_angeltype_id' => $user_angeltype['id'], 'confirmed' => 1]),\n-                glyph('ok') . __('yes'),\n-                'btn-primary'\n-            )\n-        ])\n+        form([\n+            buttons([\n+                button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n+                form_submit('delete', glyph('ok') . __('yes'), 'btn-primary', false),\n+            ]),\n+        ], page_link_to('user_angeltypes', ['action' => 'delete', 'user_angeltype_id' => $user_angeltype['id']])),\n     ]);\n }\n \n@@ -189,16 +170,14 @@ function UserAngelType_join_view($user, $angeltype)\n             User_Nick_render($user),\n             $angeltype['name']\n         ), true),\n-        buttons([\n-            button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n-            button(\n-                page_link_to(\n-                    'user_angeltypes',\n-                    ['action' => 'add', 'angeltype_id' => $angeltype['id'], 'user_id' => $user->id, 'confirmed' => 1]\n-                ),\n-                glyph('ok') . __('save'),\n-                'btn-primary'\n-            )\n-        ])\n+        form([\n+            buttons([\n+                button(angeltype_link($angeltype['id']), glyph('remove') . __('cancel')),\n+                form_submit('submit', glyph('ok') . __('save'), 'btn-primary', false)\n+            ]),\n+        ], page_link_to(\n+            'user_angeltypes',\n+            ['action' => 'add', 'angeltype_id' => $angeltype['id'], 'user_id' => $user->id]\n+        )),\n     ]);\n }"
        },
        {
          "filename": "includes/view/UserWorkLog_view.php",
          "status": "modified",
          "additions": 8,
          "deletions": 9,
          "patch": "@@ -5,23 +5,22 @@\n /**\n  * Delete work log entry.\n  *\n- * @param User  $user_source\n- * @param array $userWorkLog\n+ * @param User $user_source\n  * @return string\n  */\n-function UserWorkLog_delete_view($user_source, $userWorkLog)\n+function UserWorkLog_delete_view($user_source)\n {\n     return page_with_title(UserWorkLog_delete_title(), [\n         info(sprintf(\n             __('Do you want to delete the worklog entry for %s?'),\n             User_Nick_render($user_source)\n         ), true),\n-        buttons([\n-            button(user_link($user_source->id), glyph('remove') . __('cancel')),\n-            button(user_worklog_delete_link($userWorkLog, [\n-                'confirmed' => 1\n-            ]), glyph('ok') . __('delete'), 'btn-danger')\n-        ])\n+        form([\n+            buttons([\n+                button(user_link($user_source->id), glyph('remove') . __('cancel')),\n+                form_submit('submit', glyph('ok') . __('delete'), 'btn-danger', false),\n+            ]),\n+        ]),\n     ]);\n }\n "
        },
        {
          "filename": "src/Http/Request.php",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -51,6 +51,19 @@ public function has($key)\n         return !is_null($value);\n     }\n \n+    /**\n+     * Checks if the POST data exists\n+     *\n+     * @param string $key\n+     * @return bool\n+     */\n+    public function hasPostData($key)\n+    {\n+        $value = $this->postData($key);\n+\n+        return !is_null($value);\n+    }\n+\n     /**\n      * Get the requested path\n      *"
        },
        {
          "filename": "tests/Unit/Http/RequestTest.php",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -66,6 +66,24 @@ public function testHas()\n         $this->assertFalse($request->has('baz'));\n     }\n \n+    /**\n+     * @covers \\Engelsystem\\Http\\Request::hasPostData\n+     */\n+    public function testHasPostData()\n+    {\n+        $request = new Request([\n+            'foo' => 'bar',\n+        ], [\n+            'lorem' => 'ipsum',\n+        ]);\n+\n+        $this->assertTrue($request->has('foo'));\n+        $this->assertFalse($request->hasPostData('foo'));\n+\n+        $this->assertTrue($request->has('lorem'));\n+        $this->assertTrue($request->hasPostData('lorem'));\n+    }\n+\n     /**\n      * @covers \\Engelsystem\\Http\\Request::path\n      */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 6,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd3c1f373149cdfbde169926f92fb7a7c0688c76",
            "date": "2024-12-29T17:53:54Z",
            "author_login": "xuwhite"
          },
          {
            "sha": "ea0bab3c6315351130c7f54a53da0b71f34ad2c4",
            "date": "2024-12-27T13:50:37Z",
            "author_login": "MyIgel"
          },
          {
            "sha": "e8e9a6b4f5eef89faf9dfe45de23b6f3bcdb4c68",
            "date": "2024-12-28T15:27:36Z",
            "author_login": "MyIgel"
          },
          {
            "sha": "2a12e1b9868f48525ee8e1e00f8b25bac047ba72",
            "date": "2024-12-26T15:16:41Z",
            "author_login": "MyIgel"
          },
          {
            "sha": "d5c55dbef01f0f4f7f623120a6e3c31a00636a43",
            "date": "2024-12-26T14:05:26Z",
            "author_login": "MyIgel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "Engelsystem before commit hash 2e28336 allows CSRF.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-12-26T21:29:01.997",
    "last_modified": "2024-11-21T03:57:29.437",
    "fix_date": "2018-11-20T15:02:03Z"
  },
  "references": [
    {
      "url": "https://github.com/MyIgel/engelsystem/commit/2e28336818183e2c63c8015fb476bc01c822f50a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/engelsystem/engelsystem/issues/494",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MyIgel/engelsystem/commit/2e28336818183e2c63c8015fb476bc01c822f50a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/engelsystem/engelsystem/issues/494",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:42.206107",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "engelsystem",
    "owner": "engelsystem",
    "created_at": "2012-04-11T17:36:00Z",
    "updated_at": "2025-01-25T06:38:43Z",
    "pushed_at": "2025-01-08T21:37:05Z",
    "size": 20920,
    "stars": 458,
    "forks": 244,
    "open_issues": 216,
    "watchers": 458,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 2098832,
      "Twig": 204709,
      "SCSS": 81104,
      "JavaScript": 22404,
      "HTML": 6510,
      "Shell": 3629,
      "Dockerfile": 3423
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:01:44.036077"
  }
}