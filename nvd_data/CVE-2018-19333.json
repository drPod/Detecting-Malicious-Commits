{
  "cve_id": "CVE-2018-19333",
  "github_data": {
    "repository": "google/gvisor",
    "fix_commit": "0e277a39c8b6f905e289b75e8ad0594e6b3562ca",
    "related_commits": [
      "0e277a39c8b6f905e289b75e8ad0594e6b3562ca",
      "0e277a39c8b6f905e289b75e8ad0594e6b3562ca"
    ],
    "patch_url": "https://github.com/google/gvisor/commit/0e277a39c8b6f905e289b75e8ad0594e6b3562ca.patch",
    "fix_commit_details": {
      "sha": "0e277a39c8b6f905e289b75e8ad0594e6b3562ca",
      "commit_date": "2018-11-01T22:53:25Z",
      "author": {
        "login": "mrahatm",
        "type": "User",
        "stats": {
          "total_commits": 152,
          "average_weekly_commits": 0.4318181818181818,
          "total_additions": 28617,
          "total_deletions": 7224,
          "weeks_active": 91
        }
      },
      "commit_message": {
        "title": "Prevent premature destruction of shm segments.",
        "length": 690,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 12,
        "deletions": 3
      },
      "files": [
        {
          "filename": "pkg/sentry/kernel/shm/shm.go",
          "status": "modified",
          "additions": 11,
          "deletions": 2,
          "patch": "@@ -575,10 +575,19 @@ func (s *Shm) destroy() {\n func (s *Shm) MarkDestroyed() {\n \ts.mu.Lock()\n \tdefer s.mu.Unlock()\n+\n \t// Prevent the segment from being found in the registry.\n \ts.key = linux.IPC_PRIVATE\n-\ts.pendingDestruction = true\n-\ts.DecRef()\n+\n+\t// Only drop the segment's self-reference once, when destruction is\n+\t// requested. Otherwise, repeated calls shmctl(IPC_RMID) would force a\n+\t// segment to be destroyed prematurely, potentially with active maps to the\n+\t// segment's address range. Remaining references are dropped when the\n+\t// segment is detached or unmaped.\n+\tif !s.pendingDestruction {\n+\t\ts.pendingDestruction = true\n+\t\ts.DecRef()\n+\t}\n }\n \n // checkOwnership verifies whether a segment may be accessed by ctx as an"
        },
        {
          "filename": "pkg/sentry/syscalls/linux/sys_shm.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -144,7 +144,7 @@ func Shmctl(t *kernel.Task, args arch.SyscallArguments) (uintptr, *kernel.Syscal\n \t\treturn 0, nil, nil\n \n \tcase linux.SHM_LOCK, linux.SHM_UNLOCK:\n-\t\t// We currently do not support memmory locking anywhere.\n+\t\t// We currently do not support memory locking anywhere.\n \t\t// mlock(2)/munlock(2) are currently stubbed out as no-ops so do the\n \t\t// same here.\n \t\tt.Kernel().EmitUnimplementedEvent(t)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3649ca9d9eb6cd4aed8ecfbfd13aef5fa8bdae7a",
            "date": "2025-01-14T05:08:55Z",
            "author_login": "EtiennePerot"
          },
          {
            "sha": "4ba931dd226e5a04d0d8b89586239ebba72b9e0e",
            "date": "2025-01-11T06:31:22Z",
            "author_login": "EtiennePerot"
          },
          {
            "sha": "3f0c7ccf85dfb162bd63e3065bf3f5f3882c9235",
            "date": "2025-01-11T03:41:27Z",
            "author_login": "EtiennePerot"
          },
          {
            "sha": "17962e58c1130cd150b4a1475f4e8cad3ae67423",
            "date": "2025-01-10T23:07:01Z",
            "author_login": "konstantin-s-bogom"
          },
          {
            "sha": "2d0e39a87f4cdaf24737973c4c9682a9ad2dbcc0",
            "date": "2025-01-10T19:41:53Z",
            "author_login": "gvisor-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "pkg/sentry/kernel/shm/shm.go in Google gVisor before 2018-11-01 allows attackers to overwrite memory locations in processes running as root (but not escape the sandbox) via vectors involving IPC_RMID shmctl calls, because reference counting is mishandled.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-11-17T17:29:00.227",
    "last_modified": "2024-11-21T03:57:44.773",
    "fix_date": "2018-11-01T22:53:25Z"
  },
  "references": [
    {
      "url": "https://github.com/google/gvisor/commit/0e277a39c8b6f905e289b75e8ad0594e6b3562ca",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://justi.cz/security/2018/11/14/gvisor-lpe.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/gvisor/commit/0e277a39c8b6f905e289b75e8ad0594e6b3562ca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://justi.cz/security/2018/11/14/gvisor-lpe.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:38.562681",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gvisor",
    "owner": "google",
    "created_at": "2018-04-26T21:28:49Z",
    "updated_at": "2025-01-14T17:52:56Z",
    "pushed_at": "2025-01-14T07:11:20Z",
    "size": 91944,
    "stars": 16008,
    "forks": 1316,
    "open_issues": 428,
    "watchers": 16008,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "go",
      "master",
      "test/cl253260121",
      "test/cl258263294",
      "test/cl258809497",
      "test/cl260256471",
      "test/cl261281902",
      "test/cl263041320",
      "test/cl263368268",
      "test/cl264733455",
      "test/cl265283160",
      "test/cl265338961",
      "test/cl265530468",
      "test/cl266023098",
      "test/cl270351980",
      "test/cl273329276",
      "test/cl274909441",
      "test/cl275514308",
      "test/cl276483963",
      "test/cl277059836",
      "test/cl279796286"
    ],
    "languages": {
      "Go": 18512741,
      "C++": 4149254,
      "Starlark": 880509,
      "Assembly": 196145,
      "C": 103908,
      "Shell": 88273,
      "Makefile": 57766,
      "HTML": 29166,
      "Python": 21977,
      "Dockerfile": 11741,
      "Cuda": 9042,
      "SCSS": 8661,
      "Ruby": 2430,
      "JavaScript": 983,
      "Handlebars": 103,
      "Rust": 45
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T18:05:41.166884"
  }
}