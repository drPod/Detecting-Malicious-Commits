{
  "cve_id": "CVE-2018-1999010",
  "github_data": {
    "repository": "FFmpeg/FFmpeg",
    "fix_commit": "cced03dd667a5df6df8fd40d8de0bff477ee02e8",
    "related_commits": [
      "cced03dd667a5df6df8fd40d8de0bff477ee02e8",
      "cced03dd667a5df6df8fd40d8de0bff477ee02e8"
    ],
    "patch_url": "https://github.com/FFmpeg/FFmpeg/commit/cced03dd667a5df6df8fd40d8de0bff477ee02e8.patch",
    "fix_commit_details": {
      "sha": "cced03dd667a5df6df8fd40d8de0bff477ee02e8",
      "commit_date": "2018-07-03T18:33:04Z",
      "author": {
        "login": "michaelni",
        "type": "User",
        "stats": {
          "total_commits": 30563,
          "average_weekly_commits": 24.352988047808765,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1151
        }
      },
      "commit_message": {
        "title": "avformat/mms: Add missing chunksize check",
        "length": 309,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 44,
        "additions": 26,
        "deletions": 18
      },
      "files": [
        {
          "filename": "libavformat/mms.c",
          "status": "modified",
          "additions": 26,
          "deletions": 18,
          "patch": "@@ -94,24 +94,26 @@ int ff_mms_asf_header_parser(MMSContext *mms)\n                 }\n             }\n         } else if (!memcmp(p, ff_asf_stream_header, sizeof(ff_asf_guid))) {\n-            flags     = AV_RL16(p + sizeof(ff_asf_guid)*3 + 24);\n-            stream_id = flags & 0x7F;\n-            //The second condition is for checking CS_PKT_STREAM_ID_REQUEST packet size,\n-            //we can calculate the packet size by stream_num.\n-            //Please see function send_stream_selection_request().\n-            if (mms->stream_num < MMS_MAX_STREAMS &&\n-                    46 + mms->stream_num * 6 < sizeof(mms->out_buffer)) {\n-                mms->streams = av_fast_realloc(mms->streams,\n-                                   &mms->nb_streams_allocated,\n-                                   (mms->stream_num + 1) * sizeof(MMSStream));\n-                if (!mms->streams)\n-                    return AVERROR(ENOMEM);\n-                mms->streams[mms->stream_num].id = stream_id;\n-                mms->stream_num++;\n-            } else {\n-                av_log(NULL, AV_LOG_ERROR,\n-                       \"Corrupt stream (too many A/V streams)\\n\");\n-                return AVERROR_INVALIDDATA;\n+            if (end - p >= (sizeof(ff_asf_guid) * 3 + 26)) {\n+                flags     = AV_RL16(p + sizeof(ff_asf_guid)*3 + 24);\n+                stream_id = flags & 0x7F;\n+                //The second condition is for checking CS_PKT_STREAM_ID_REQUEST packet size,\n+                //we can calculate the packet size by stream_num.\n+                //Please see function send_stream_selection_request().\n+                if (mms->stream_num < MMS_MAX_STREAMS &&\n+                        46 + mms->stream_num * 6 < sizeof(mms->out_buffer)) {\n+                    mms->streams = av_fast_realloc(mms->streams,\n+                                       &mms->nb_streams_allocated,\n+                                       (mms->stream_num + 1) * sizeof(MMSStream));\n+                    if (!mms->streams)\n+                        return AVERROR(ENOMEM);\n+                    mms->streams[mms->stream_num].id = stream_id;\n+                    mms->stream_num++;\n+                } else {\n+                    av_log(NULL, AV_LOG_ERROR,\n+                           \"Corrupt stream (too many A/V streams)\\n\");\n+                    return AVERROR_INVALIDDATA;\n+                }\n             }\n         } else if (!memcmp(p, ff_asf_ext_stream_header, sizeof(ff_asf_guid))) {\n             if (end - p >= 88) {\n@@ -143,6 +145,12 @@ int ff_mms_asf_header_parser(MMSContext *mms)\n             }\n         } else if (!memcmp(p, ff_asf_head1_guid, sizeof(ff_asf_guid))) {\n             chunksize = 46; // see references [2] section 3.4. This should be set 46.\n+            if (chunksize > end - p) {\n+                av_log(NULL, AV_LOG_ERROR,\n+                    \"Corrupt stream (header chunksize %\"PRId64\" is invalid)\\n\",\n+                    chunksize);\n+                return AVERROR_INVALIDDATA;\n+            }\n         }\n         p += chunksize;\n     }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd1772b7475d0d5673a5dd314ee78443d0be4cf1",
            "date": "2025-01-13T21:17:06Z",
            "author_login": "jamrial"
          },
          {
            "sha": "8eb1d76e146a0e557d596a4039efebac746b4d83",
            "date": "2025-01-12T03:34:17Z",
            "author_login": "nuomi2021"
          },
          {
            "sha": "d5873be583ada9e1fb887e2fe8dcfd4b12e0efcd",
            "date": "2025-01-13T20:28:02Z",
            "author_login": "jamrial"
          },
          {
            "sha": "b88fc4e098607bed98c74e6d13ed77b907776685",
            "date": "2025-01-08T11:06:30Z",
            "author_login": "mypopydev"
          },
          {
            "sha": "8ded602edad43227aa5b84ac8041d4b174ec9431",
            "date": "2025-01-08T11:04:12Z",
            "author_login": "mypopydev"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "FFmpeg before commit cced03dd667a5df6df8fd40d8de0bff477ee02e8 contains multiple out of array access vulnerabilities in the mms protocol that can result in attackers accessing out of bound data. This attack appear to be exploitable via network connectivity. This vulnerability appears to have been fixed in cced03dd667a5df6df8fd40d8de0bff477ee02e8 and later.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-07-23T15:29:00.297",
    "last_modified": "2024-11-21T03:57:02.590",
    "fix_date": "2018-07-03T18:33:04Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/104896",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/FFmpeg/FFmpeg/commit/cced03dd667a5df6df8fd40d8de0bff477ee02e8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/01/msg00006.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/104896",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/FFmpeg/FFmpeg/commit/cced03dd667a5df6df8fd40d8de0bff477ee02e8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/01/msg00006.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:32.409939",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "FFmpeg",
    "owner": "FFmpeg",
    "created_at": "2011-04-14T14:12:38Z",
    "updated_at": "2025-01-14T12:22:35Z",
    "pushed_at": "2025-01-13T21:15:03Z",
    "size": 431834,
    "stars": 47243,
    "forks": 12316,
    "open_issues": 3,
    "watchers": 47243,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/0.5",
      "release/0.6",
      "release/0.7",
      "release/0.8",
      "release/0.9",
      "release/0.10",
      "release/0.11",
      "release/1.0",
      "release/1.1",
      "release/1.2",
      "release/2.0",
      "release/2.1",
      "release/2.2",
      "release/2.3",
      "release/2.4",
      "release/2.5",
      "release/2.6",
      "release/2.7",
      "release/2.8",
      "release/3.0",
      "release/3.1",
      "release/3.2",
      "release/3.3",
      "release/3.4",
      "release/4.0",
      "release/4.1",
      "release/4.2",
      "release/4.3"
    ],
    "languages": {
      "C": 65826781,
      "Assembly": 5688727,
      "Makefile": 948271,
      "C++": 141194,
      "Objective-C": 108023,
      "Cuda": 85420,
      "Shell": 59093,
      "Perl": 29093,
      "Metal": 7961,
      "Python": 5992,
      "Awk": 1912,
      "HTML": 1631,
      "Ruby": 1462,
      "Verilog": 729,
      "Roff": 132
    },
    "commit_activity": {
      "total_commits_last_year": 4412,
      "avg_commits_per_week": 84.84615384615384,
      "days_active_last_year": 353
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:03:32.126548"
  }
}