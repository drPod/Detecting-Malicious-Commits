{
  "cve_id": "CVE-2018-1999015",
  "github_data": {
    "repository": "FFmpeg/FFmpeg",
    "fix_commit": "5aba5b89d0b1d73164d3b81764828bb8b20ff32a",
    "related_commits": [
      "5aba5b89d0b1d73164d3b81764828bb8b20ff32a",
      "5aba5b89d0b1d73164d3b81764828bb8b20ff32a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5aba5b89d0b1d73164d3b81764828bb8b20ff32a",
      "commit_date": "2018-07-03T20:48:32Z",
      "author": {
        "login": "michaelni",
        "type": "User",
        "stats": {
          "total_commits": 30587,
          "average_weekly_commits": 24.333333333333332,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1154
        }
      },
      "commit_message": {
        "title": "avcodec/mpeg4videodec: Check for bitstream end in read_quant_matrix_ext()",
        "length": 259,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
      },
      "files": [
        {
          "filename": "libavcodec/mpeg4videodec.c",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -2867,11 +2867,13 @@ static int decode_vop_header(Mpeg4DecContext *ctx, GetBitContext *gb)\n     return 0;\n }\n \n-static void read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n+static int read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n {\n     int i, j, v;\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             v = get_bits(gb, 8);\n@@ -2882,13 +2884,17 @@ static void read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n     }\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* non_intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             get_bits(gb, 8);\n         }\n     }\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* chroma_intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             v = get_bits(gb, 8);\n@@ -2898,13 +2904,16 @@ static void read_quant_matrix_ext(MpegEncContext *s, GetBitContext *gb)\n     }\n \n     if (get_bits1(gb)) {\n+        if (get_bits_left(gb) < 64*8)\n+            return AVERROR_INVALIDDATA;\n         /* chroma_non_intra_quantiser_matrix */\n         for (i = 0; i < 64; i++) {\n             get_bits(gb, 8);\n         }\n     }\n \n     next_start_code_studio(gb);\n+    return 0;\n }\n \n static void extension_and_user_data(MpegEncContext *s, GetBitContext *gb, int id)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "712140be75d11e6ac83f06a39352e5b4686f7558",
            "date": "2025-01-26T00:28:29Z",
            "author_login": "jamrial"
          },
          {
            "sha": "4f9afbb1b2039599b0571f63b2bca6645272c68b",
            "date": "2024-12-27T15:03:41Z",
            "author_login": "jamrial"
          },
          {
            "sha": "6a282cdf7e51376546404264d2698a07bd1ba554",
            "date": "2024-12-27T15:02:22Z",
            "author_login": "jamrial"
          },
          {
            "sha": "ea3c3b42dff56ab45d6674cd3d64273dd62fab58",
            "date": "2024-12-29T13:55:48Z",
            "author_login": "jamrial"
          },
          {
            "sha": "0bed1b89530042f0a835b8d1178aa52b40a751f6",
            "date": "2024-12-27T14:53:16Z",
            "author_login": "jamrial"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-125",
    "description": "FFmpeg before commit 5aba5b89d0b1d73164d3b81764828bb8b20ff32a contains an out of array read vulnerability in ASF_F format demuxer that can result in heap memory reading. This attack appear to be exploitable via specially crafted ASF file that has to provided as input. This vulnerability appears to have been fixed in 5aba5b89d0b1d73164d3b81764828bb8b20ff32a and later.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-07-23T15:29:00.503",
    "last_modified": "2024-11-21T03:57:03.340",
    "fix_date": "2018-07-03T20:48:32Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/104896",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/FFmpeg/FFmpeg/commit/5aba5b89d0b1d73164d3b81764828bb8b20ff32a",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/104896",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/FFmpeg/FFmpeg/commit/5aba5b89d0b1d73164d3b81764828bb8b20ff32a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:32.410628",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "FFmpeg",
    "owner": "FFmpeg",
    "created_at": "2011-04-14T14:12:38Z",
    "updated_at": "2025-01-26T07:12:33Z",
    "pushed_at": "2025-01-26T01:00:04Z",
    "size": 429900,
    "stars": 47417,
    "forks": 12345,
    "open_issues": 3,
    "watchers": 47417,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/0.5",
      "release/0.6",
      "release/0.7",
      "release/0.8",
      "release/0.9",
      "release/0.10",
      "release/0.11",
      "release/1.0",
      "release/1.1",
      "release/1.2",
      "release/2.0",
      "release/2.1",
      "release/2.2",
      "release/2.3",
      "release/2.4",
      "release/2.5",
      "release/2.6",
      "release/2.7",
      "release/2.8",
      "release/3.0",
      "release/3.1",
      "release/3.2",
      "release/3.3",
      "release/3.4",
      "release/4.0",
      "release/4.1",
      "release/4.2",
      "release/4.3"
    ],
    "languages": {
      "C": 65857319,
      "Assembly": 5688794,
      "Makefile": 948598,
      "C++": 141194,
      "Objective-C": 108023,
      "Cuda": 85420,
      "Shell": 59093,
      "Perl": 29093,
      "Metal": 7961,
      "Python": 5992,
      "Awk": 1912,
      "HTML": 1631,
      "Ruby": 1462,
      "Verilog": 729,
      "Roff": 132
    },
    "commit_activity": {
      "total_commits_last_year": 4312,
      "avg_commits_per_week": 82.92307692307692,
      "days_active_last_year": 348
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:38:37.983030"
  }
}