{
  "cve_id": "CVE-2018-19995",
  "github_data": {
    "repository": "Dolibarr/dolibarr",
    "fix_commit": "4b8be6ed64763327018ac1c076f81ddffa87855e",
    "related_commits": [
      "4b8be6ed64763327018ac1c076f81ddffa87855e",
      "bacd5110fbdc81a35030fdc322775fa15ea85924",
      "4b8be6ed64763327018ac1c076f81ddffa87855e",
      "bacd5110fbdc81a35030fdc322775fa15ea85924"
    ],
    "patch_url": "https://github.com/Dolibarr/dolibarr/commit/4b8be6ed64763327018ac1c076f81ddffa87855e.patch",
    "fix_commit_details": {
      "sha": "4b8be6ed64763327018ac1c076f81ddffa87855e",
      "commit_date": "2018-12-22T16:08:55Z",
      "author": {
        "login": "eldy",
        "type": "User",
        "stats": {
          "total_commits": 81587,
          "average_weekly_commits": 68.79173693086004,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1074
        }
      },
      "commit_message": {
        "title": "FIX CVE-2018-19995",
        "length": 18,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 56,
        "additions": 28,
        "deletions": 28
      },
      "files": [
        {
          "filename": "htdocs/user/card.php",
          "status": "modified",
          "additions": 28,
          "deletions": 28,
          "patch": "@@ -191,31 +191,31 @@\n \t\t\t$birth = dol_mktime(0, 0, 0, GETPOST('birthmonth'), GETPOST('birthday'), GETPOST('birthyear'));\n \t\t\t$object->birth = $birth;\n \t\t\t$object->admin = GETPOST(\"admin\", 'alpha');\n-\t\t\t$object->address = GETPOST('address', 'alpha');\n-\t\t\t$object->zip = GETPOST('zipcode', 'alpha');\n-\t\t\t$object->town = GETPOST('town', 'alpha');\n+\t\t\t$object->address = GETPOST('address', 'alphanohtml');\n+\t\t\t$object->zip = GETPOST('zipcode', 'alphanohtml');\n+\t\t\t$object->town = GETPOST('town', 'alphanohtml');\n \t\t\t$object->country_id = GETPOST('country_id', 'int');\n \t\t\t$object->state_id = GETPOST('state_id', 'int');\n-\t\t\t$object->office_phone = GETPOST(\"office_phone\", 'alpha');\n-\t\t\t$object->office_fax = GETPOST(\"office_fax\", 'alpha');\n-\t\t\t$object->user_mobile = GETPOST(\"user_mobile\");\n-\t\t\t$object->skype = GETPOST(\"skype\", 'alpha');\n+\t\t\t$object->office_phone = GETPOST(\"office_phone\", 'alphanohtml');\n+\t\t\t$object->office_fax = GETPOST(\"office_fax\", 'alphanohtml');\n+\t\t\t$object->user_mobile = GETPOST(\"user_mobile\", 'alphanohtml');\n+\t\t\t$object->skype = GETPOST(\"skype\", 'alphanohtml');\n \t\t\t$object->email = preg_replace('/\\s+/', '', GETPOST(\"email\", 'alpha'));\n \t\t\t$object->job = GETPOST(\"job\", 'alpha');\n-\t\t\t$object->signature = GETPOST(\"signature\");\n-\t\t\t$object->accountancy_code = GETPOST(\"accountancy_code\");\n-\t\t\t$object->note = GETPOST(\"note\");\n-\t\t\t$object->ldap_sid = GETPOST(\"ldap_sid\");\n-\t\t\t$object->fk_user = GETPOST(\"fk_user\") > 0 ? GETPOST(\"fk_user\") : 0;\n-\t\t\t$object->employee = GETPOST('employee');\n-\n-\t\t\t$object->thm = GETPOST(\"thm\") != '' ? GETPOST(\"thm\") : '';\n-\t\t\t$object->tjm = GETPOST(\"tjm\") != '' ? GETPOST(\"tjm\") : '';\n-\t\t\t$object->salary = GETPOST(\"salary\") != '' ? GETPOST(\"salary\") : '';\n-\t\t\t$object->salaryextra = GETPOST(\"salaryextra\") != '' ? GETPOST(\"salaryextra\") : '';\n-\t\t\t$object->weeklyhours = GETPOST(\"weeklyhours\") != '' ? GETPOST(\"weeklyhours\") : '';\n-\n-\t\t\t$object->color = GETPOST(\"color\") != '' ? GETPOST(\"color\") : '';\n+\t\t\t$object->signature = GETPOST(\"signature\", 'none');\n+\t\t\t$object->accountancy_code = GETPOST(\"accountancy_code\", 'alphanohtml');\n+\t\t\t$object->note = GETPOST(\"note\", 'none');\n+\t\t\t$object->ldap_sid = GETPOST(\"ldap_sid\", 'alphanohtml');\n+\t\t\t$object->fk_user = GETPOST(\"fk_user\", 'int') > 0 ? GETPOST(\"fk_user\", 'int') : 0;\n+\t\t\t$object->employee = GETPOST('employee', 'alphanohtml');\n+\n+\t\t\t$object->thm = GETPOST(\"thm\", 'alphanohtml') != '' ? GETPOST(\"thm\", 'alphanohtml') : '';\n+\t\t\t$object->tjm = GETPOST(\"tjm\", 'alphanohtml') != '' ? GETPOST(\"tjm\", 'alphanohtml') : '';\n+\t\t\t$object->salary = GETPOST(\"salary\", 'alphanohtml') != '' ? GETPOST(\"salary\", 'alphanohtml') : '';\n+\t\t\t$object->salaryextra = GETPOST(\"salaryextra\", 'alphanohtml') != '' ? GETPOST(\"salaryextra\", 'alphanohtml') : '';\n+\t\t\t$object->weeklyhours = GETPOST(\"weeklyhours\", 'alphanohtml') != '' ? GETPOST(\"weeklyhours\", 'alphanohtml') : '';\n+\n+\t\t\t$object->color = GETPOST(\"color\", 'alphanohtml') != '' ? GETPOST(\"color\", 'alphanohtml') : '';\n \t\t\t$dateemployment = dol_mktime(0, 0, 0, GETPOST('dateemploymentmonth'), GETPOST('dateemploymentday'), GETPOST('dateemploymentyear'));\n \t\t\t$object->dateemployment = $dateemployment;\n \n@@ -335,22 +335,22 @@\n \t\t\t\t$object->pass = GETPOST(\"password\",'none');\n \t\t\t\t$object->api_key = (GETPOST(\"api_key\", 'alpha')) ? GETPOST(\"api_key\", 'alpha') : $object->api_key;\n \t\t\t\tif (! empty($user->admin)) $object->admin = GETPOST(\"admin\"); \t// admin flag can only be set/unset by an admin user. A test is also done later when forging sql request\n-\t\t\t\t$object->address = GETPOST('address', 'alpha');\n-\t\t\t\t$object->zip = GETPOST('zipcode', 'alpha');\n-\t\t\t\t$object->town = GETPOST('town', 'alpha');\n+\t\t\t\t$object->address = GETPOST('address', 'alphanohtml');\n+\t\t\t\t$object->zip = GETPOST('zipcode', 'alphanohtml');\n+\t\t\t\t$object->town = GETPOST('town', 'alphanohtml');\n \t\t\t\t$object->country_id = GETPOST('country_id', 'int');\n \t\t\t\t$object->state_id = GETPOST('state_id', 'int');\n-\t\t\t\t$object->office_phone = GETPOST(\"office_phone\", 'alpha');\n-\t\t\t\t$object->office_fax = GETPOST(\"office_fax\", 'alpha');\n-\t\t\t\t$object->user_mobile = GETPOST(\"user_mobile\");\n+\t\t\t\t$object->office_phone = GETPOST(\"office_phone\", 'alphanohtml');\n+\t\t\t\t$object->office_fax = GETPOST(\"office_fax\", 'alphanohtml');\n+\t\t\t\t$object->user_mobile = GETPOST(\"user_mobile\", 'alphanohtml');\n \t\t\t\t$object->skype = GETPOST(\"skype\", 'alpha');\n \t\t\t\t$object->email = preg_replace('/\\s+/', '', GETPOST(\"email\", 'alpha'));\n \t\t\t\t$object->job = GETPOST(\"job\", 'alpha');\n \t\t\t\t$object->signature = GETPOST(\"signature\",'none');\n \t\t\t\t$object->accountancy_code = GETPOST(\"accountancy_code\",'alpha');\n \t\t\t\t$object->openid = GETPOST(\"openid\",'alpha');\n \t\t\t\t$object->fk_user = GETPOST(\"fk_user\",'int') > 0 ? GETPOST(\"fk_user\",'int') : 0;\n-\t\t\t\t$object->employee = GETPOST('employee');\n+\t\t\t\t$object->employee = GETPOST('employee','alphanothtml');\n \n \t\t\t\t$object->thm = GETPOST(\"thm\",'alphanohtml') != '' ? GETPOST(\"thm\",'alphanohtml') : '';\n \t\t\t\t$object->tjm = GETPOST(\"tjm\",'alphanohtml') != '' ? GETPOST(\"tjm\",'alphanohtml') : '';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1198ae576900a672d95bc4750dbdffb80d5cd30e",
            "date": "2025-01-14T11:03:57Z",
            "author_login": "eldy"
          },
          {
            "sha": "84940c6f84946601d0d3bc3912ab1fedd2f0f456",
            "date": "2025-01-14T11:02:52Z",
            "author_login": "eldy"
          },
          {
            "sha": "ad36bdadad6e158a2043d88d98ff58cf2c7cd863",
            "date": "2025-01-14T08:26:48Z",
            "author_login": "eldy"
          },
          {
            "sha": "2edee4dba19d198be86aa986a354b78c765beb3c",
            "date": "2025-01-14T08:26:09Z",
            "author_login": "eldy"
          },
          {
            "sha": "a3fd2ad245fd01f60508aef183a35771ca9946f9",
            "date": "2025-01-14T06:40:08Z",
            "author_login": "hregis"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "A stored cross-site scripting (XSS) vulnerability in Dolibarr 8.0.2 allows remote authenticated users to inject arbitrary web script or HTML via the \"address\" (POST) or \"town\" (POST) parameter to user/card.php.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-01-03T19:29:01.087",
    "last_modified": "2024-11-21T03:58:57.960",
    "fix_date": "2018-12-22T16:08:55Z"
  },
  "references": [
    {
      "url": "https://github.com/Dolibarr/dolibarr/commit/4b8be6ed64763327018ac1c076f81ddffa87855e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/commit/bacd5110fbdc81a35030fdc322775fa15ea85924",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/commit/4b8be6ed64763327018ac1c076f81ddffa87855e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Dolibarr/dolibarr/commit/bacd5110fbdc81a35030fdc322775fa15ea85924",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:42.225474",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dolibarr",
    "owner": "Dolibarr",
    "created_at": "2011-06-26T21:55:03Z",
    "updated_at": "2025-01-14T11:04:10Z",
    "pushed_at": "2025-01-14T11:04:06Z",
    "size": 1507317,
    "stars": 5629,
    "forks": 2830,
    "open_issues": 1162,
    "watchers": 5629,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "18.0"
    ],
    "languages": {
      "PHP": 72587948,
      "JavaScript": 19205220,
      "CSS": 416812,
      "SCSS": 227818,
      "Less": 206987,
      "Shell": 115721,
      "Perl": 111381,
      "Inno Setup": 72215,
      "HTML": 36084,
      "Promela": 24625,
      "PLpgSQL": 23627,
      "Gherkin": 10705,
      "Makefile": 8752,
      "C++": 8363,
      "Batchfile": 4681,
      "Python": 4235,
      "Dockerfile": 3723
    },
    "commit_activity": {
      "total_commits_last_year": 12583,
      "avg_commits_per_week": 241.98076923076923,
      "days_active_last_year": 350
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:10:40.684709"
  }
}