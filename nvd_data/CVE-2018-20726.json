{
  "cve_id": "CVE-2018-20726",
  "github_data": {
    "repository": "Cacti/cacti",
    "fix_commit": "80c2a88fb2afb93f87703ba4641f9970478c102d",
    "related_commits": [
      "80c2a88fb2afb93f87703ba4641f9970478c102d",
      "80c2a88fb2afb93f87703ba4641f9970478c102d"
    ],
    "patch_url": "https://github.com/Cacti/cacti/commit/80c2a88fb2afb93f87703ba4641f9970478c102d.patch",
    "fix_commit_details": {
      "sha": "80c2a88fb2afb93f87703ba4641f9970478c102d",
      "commit_date": "2018-12-16T15:54:11Z",
      "author": {
        "login": "cigamit",
        "type": "User",
        "stats": {
          "total_commits": 4797,
          "average_weekly_commits": 4.05152027027027,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 279
        }
      },
      "commit_message": {
        "title": "Resolving Issues #2213, #2214, #2215 and Additional",
        "length": 203,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 250,
        "additions": 127,
        "deletions": 123
      },
      "files": [
        {
          "filename": "CHANGELOG",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -6,6 +6,9 @@ Cacti CHANGELOG\n -issue#2202: Can't create more than one graph with add_graphs.php from one template\n -issue#2207: Removing Graph Template does not Remove Data Query Associations\n -issue#2212: Stored XSS in \"Website Hostname\" field\n+-issue#2213: Stored XSS in \"Website Hostname\" field - Devices\n+-issue#2214: Stored XSS in \"Vertical Label\" field - Graph\n+-issue#2215: Stored XSS in \"Name\" field - Color \n -feature: Update phpseclib to version 2.0.12\n \n 1.2.0 Beta 4"
        },
        {
          "filename": "aggregate_graphs.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -1199,12 +1199,12 @@ function clearFilter() {\n \t\t\tif (validate_is_regex(get_request_var('rfilter'))) {\n \t\t\t\tform_selectable_cell(filter_value($graph['title_cache'], get_request_var('rfilter')), $graph['local_graph_id']);\n \t\t\t} else {\n-\t\t\t\tform_selectable_cell(get_request_var('rfilter') != '' ? aggregate_format_text(html_escape($graph['title_cache']), get_request_var('rfilter')) : html_escape($graph['title_cache']), $graph['local_graph_id']);\n+\t\t\t\tform_selectable_ecell(get_request_var('rfilter') != '' ? aggregate_format_text($graph['title_cache'], get_request_var('rfilter')) : $graph['title_cache'], $graph['local_graph_id']);\n \t\t\t}\n \n \t\t\tform_selectable_cell($graph['local_graph_id'], $graph['local_graph_id'], '', 'right');\n \t\t\tform_selectable_cell(($graph['agg_graph_id'] != '' ? \"<span class='associated'>\" . __('Yes') . '</span>':\"<span class='notAssociated'>\" . __('No') . \"</span>\"), $graph['local_graph_id']);\n-\t\t\tform_selectable_cell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id'], '', 'right');\n+\t\t\tform_selectable_ecell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id'], '', 'right');\n \t\t\tform_checkbox_cell($graph['title_cache'], $graph['local_graph_id']);\n \t\t\tform_end_row();\n \t\t}\n@@ -1528,7 +1528,7 @@ function clearFilter() {\n \t\t\tform_selectable_cell(filter_value(title_trim($graph['title_cache'], read_config_option('max_title_length')), get_request_var('filter'), 'aggregate_graphs.php?action=edit&id=' . $graph['local_graph_id']), $graph['local_graph_id']);\n \t\t\tform_selectable_cell($graph['local_graph_id'], $graph['local_graph_id'], '', 'right');\n \t\t\tform_selectable_cell((empty($graph['name']) ? '<em>' . __('None') . '</em>' : filter_value($template_name, get_request_var('filter'))), $graph['local_graph_id']);\n-\t\t\tform_selectable_cell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id'], '', 'right');\n+\t\t\tform_selectable_ecell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id'], '', 'right');\n \t\t\tform_checkbox_cell($graph['title_cache'], $graph['local_graph_id']);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "aggregate_templates.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -658,8 +658,8 @@ function aggregate_template() {\n \n \t\t\tform_alternate_row('line' . $template['id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value($template['name'], get_request_var('filter'), 'aggregate_templates.php?action=edit&id=' . $template['id'] . '&page=1'), $template['id']);\n-\t\t\tform_selectable_cell($disabled ? 'No':'Yes', $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('aggregate_graphs.php?reset=true&template_id=' . $template['id']) . '\">' . number_format_i18n($template['graphs'], '-1') . '</a>', $template['id'], '', 'text-align:right;');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'right');\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('aggregate_graphs.php?reset=true&template_id=' . $template['id']) . '\">' . number_format_i18n($template['graphs'], '-1') . '</a>', $template['id'], '', 'right');\n \t\t\tform_selectable_cell(filter_value($template['graph_template_name'], get_request_var('filter')), $template['id']);\n \t\t\tform_checkbox_cell($template['graph_template_name'], $template['id'], $disabled);\n \t\t\tform_end_row();"
        },
        {
          "filename": "automation_networks.php",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -1133,17 +1133,17 @@ function networks() {\n \t\t\t}\n \n \t\t\tform_alternate_row('line' . $network['id'], true);\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('automation_networks.php?action=edit&id=' . $network['id']) . '\">' . $network['name'] . '</a>', $network['id']);\n-\t\t\tform_selectable_cell($network['data_collector'], $network['id']);\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('automation_networks.php?action=edit&id=' . $network['id']) . '\">' . html_escape($network['name']) . '</a>', $network['id']);\n+\t\t\tform_selectable_ecell($network['data_collector'], $network['id']);\n \t\t\tform_selectable_cell($sched_types[$network['sched_type']], $network['id']);\n-\t\t\tform_selectable_cell(number_format_i18n($network['total_ips']), $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell($mystat, $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell($progress, $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell(number_format_i18n($updown['up']) . '/' . number_format_i18n($updown['snmp']), $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell(number_format_i18n($network['threads']), $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell(round($network['last_runtime'],2), $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell($network['enabled'] == '' || $network['sched_type'] == '1' ? __('N/A'):($network['next_start'] == '0000-00-00 00:00:00' ? substr($network['start_at'],0,16):substr($network['next_start'],0,16)), $network['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell($network['last_started'] == '0000-00-00 00:00:00' ? 'Never':substr($network['last_started'],0,16), $network['id'], '', 'text-align:right;');\n+\t\t\tform_selectable_cell(number_format_i18n($network['total_ips']), $network['id'], '', 'right');\n+\t\t\tform_selectable_cell($mystat, $network['id'], '', 'right');\n+\t\t\tform_selectable_cell($progress, $network['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($updown['up']) . '/' . number_format_i18n($updown['snmp']), $network['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($network['threads']), $network['id'], '', 'right');\n+\t\t\tform_selectable_cell(round($network['last_runtime'],2), $network['id'], '', 'right');\n+\t\t\tform_selectable_cell($network['enabled'] == '' || $network['sched_type'] == '1' ? __('N/A'):($network['next_start'] == '0000-00-00 00:00:00' ? substr($network['start_at'],0,16):substr($network['next_start'],0,16)), $network['id'], '', 'right');\n+\t\t\tform_selectable_cell($network['last_started'] == '0000-00-00 00:00:00' ? __('Never'):substr($network['last_started'],0,16), $network['id'], '', 'right');\n \t\t\tform_checkbox_cell($network['name'], $network['id']);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "automation_tree_rules.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -947,13 +947,13 @@ function clearFilter() {\n \tif (cacti_sizeof($automation_tree_rules)) {\n \t\tforeach ($automation_tree_rules as \t$automation_tree_rule) {\n \t\t\t$tree_item_type_name = ((empty($automation_tree_rule['leaf_type'])) ? '<em>' . __('None') . '</em>' : $automation_tree_item_types[$automation_tree_rule['leaf_type']]);\n-\t\t\t$subtree_name = ((empty($automation_tree_rule['subtree_name'])) ? '<em>' . __('ROOT') . '</em>' : $automation_tree_rule['subtree_name']);\n+\t\t\t$subtree_name = ((empty($automation_tree_rule['subtree_name'])) ? '<em>' . __('ROOT') . '</em>' : html_escape($automation_tree_rule['subtree_name']));\n \t\t\t$tree_host_grouping_type = ((empty($host_group_types[$automation_tree_rule['host_grouping_type']])) ? '' : $host_group_types[$automation_tree_rule['host_grouping_type']]);\n \t\t\tform_alternate_row('line' .  $automation_tree_rule['id'], true);\n \n \t\t\tform_selectable_cell(filter_value($automation_tree_rule['name'], get_request_var('filter'), 'automation_tree_rules.php?action=edit&id=' . $automation_tree_rule['id'] . '&page=1'), $automation_tree_rule['id']);\n \t\t\tform_selectable_cell($automation_tree_rule['id'], $automation_tree_rule['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($automation_tree_rule['tree_name'], $automation_tree_rule['id']);\n+\t\t\tform_selectable_ecell($automation_tree_rule['tree_name'], $automation_tree_rule['id']);\n \t\t\tform_selectable_cell($subtree_name, $automation_tree_rule['id']);\n \t\t\tform_selectable_cell($tree_item_type_name, $automation_tree_rule['id']);\n \t\t\tform_selectable_cell($tree_host_grouping_type, $automation_tree_rule['id']);"
        },
        {
          "filename": "cdef.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -106,7 +106,7 @@ function draw_cdef_preview($cdef_id) {\n \t?>\n \t<tr class='even'>\n \t\t<td style='padding:4px'>\n-\t\t\t<pre>cdef=<?php print get_cdef($cdef_id, true);?></pre>\n+\t\t\t<pre>cdef=<?php print html_escape(get_cdef($cdef_id, true));?></pre>\n \t\t</td>\n \t</tr>\n \t<?php\n@@ -433,7 +433,7 @@ function item_edit() {\n \tdraw_cdef_preview(get_request_var('cdef_id'));\n \thtml_end_box();\n \n-\tform_start('cdef.php', 'form_cdef');\n+\tform_start('cdef.php', 'chk');\n \n \t$cdef_name = db_fetch_cell_prepared('SELECT name\n \t\tFROM cdef\n@@ -897,9 +897,9 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $cdef['id'], false, $disabled);\n \t\t\tform_selectable_cell(filter_value($cdef['name'], get_request_var('filter'), 'cdef.php?action=edit&id=' . $cdef['id']), $cdef['id']);\n-\t\t\tform_selectable_cell($disabled ? __('No') : __('Yes'), $cdef['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($cdef['graphs'], '-1'), $cdef['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($cdef['templates'], '-1'), $cdef['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $cdef['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($cdef['graphs'], '-1'), $cdef['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($cdef['templates'], '-1'), $cdef['id'], '', 'right');\n \t\t\tform_checkbox_cell($cdef['name'], $cdef['id'], $disabled);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "color_templates.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -575,9 +575,9 @@ function aggregate_color_template() {\n \t\t\tform_alternate_row('line' . $template['color_template_id'], true);\n \n \t\t\tform_selectable_cell(filter_value($template['name'], get_request_var('filter'), 'color_templates.php?action=template_edit&color_template_id=' . $template['color_template_id'] . '&page=1'), $template['color_template_id']);\n-\t\t\tform_selectable_cell($disabled ? __('No') : __('Yes'), $template['color_template_id'], '', 'text-align:right');\n-            form_selectable_cell(number_format_i18n($template['graphs']), $template['color_template_id'], '', 'text-align:right;');\n-            form_selectable_cell(number_format_i18n($template['templates']), $template['color_template_id'], '', 'text-align:right;');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['color_template_id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($template['graphs']), $template['color_template_id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($template['templates']), $template['color_template_id'], '', 'right');\n \t\t\tform_checkbox_cell($template['name'], $template['color_template_id'], $disabled);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "data_debug.php",
          "status": "modified",
          "additions": 14,
          "deletions": 23,
          "patch": "@@ -259,18 +259,18 @@ function debug_wizard() {\n \t\t\tif (strlen($name) > 50) {\n \t\t\t\t$name = substr($name, 0, 50);\n \t\t\t}\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" title=\"' . $title .'\" href=\"' . htmlspecialchars('data_debug.php?action=view&id=' . $check['id']) . '\">' . $name . '</a>', $check['id']);\n-\t\t\tform_selectable_cell($user, $check['id']);\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" title=\"' . $title .'\" href=\"' . html_escape('data_debug.php?action=view&id=' . $check['id']) . '\">' . html_escape($name) . '</a>', $check['id']);\n+\t\t\tform_selectable_ecell($user, $check['id']);\n \t\t\tform_selectable_cell(date('F j, Y, G:i', $check['started']), $check['id']);\n-\t\t\tform_selectable_cell($check['datasource'], $check['id']);\n-\t\t\tform_selectable_cell(debug_icon(($check['done'] ? (strlen($issue_line) ? 'off' : 'on' ) : '')), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell(debug_icon($info['rrd_writable']), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell(debug_icon($info['rrd_exists']), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell(debug_icon($info['active']), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell(debug_icon($info['rrd_match']), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell(debug_icon($info['valid_data']), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell(debug_icon(($info['rra_timestamp2'] != '' ? 1 : '')), $check['id'], '', 'text-align: center;');\n-\t\t\tform_selectable_cell('<a class=\\'linkEditMain\\' href=\\'#\\' title=\"' . html_escape($issue_title) . '\">' . html_escape(strlen(trim($issue_line)) ? $issue_line : '<none>') . '</a>', $check['id']);\n+\t\t\tform_selectable_ecell($check['datasource'], $check['id']);\n+\t\t\tform_selectable_cell(debug_icon(($check['done'] ? (strlen($issue_line) ? 'off' : 'on' ) : '')), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell(debug_icon($info['rrd_writable']), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell(debug_icon($info['rrd_exists']), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell(debug_icon($info['active']), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell(debug_icon($info['rrd_match']), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell(debug_icon($info['valid_data']), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell(debug_icon(($info['rra_timestamp2'] != '' ? 1 : '')), $check['id'], '', 'center');\n+\t\t\tform_selectable_cell('<a class=\\'linkEditMain\\' href=\\'#\\' title=\"' . html_escape($issue_title) . '\">' . html_escape(strlen(trim($issue_line)) ? $issue_line : __('<none>')) . '</a>', $check['id']);\n \t\t\tform_checkbox_cell($check['id'], $check['id']);\n \t\t\tform_end_row();\n \t\t}\n@@ -345,9 +345,9 @@ function debug_view() {\n \t\t$field_name = $field['name'];\n \n \t\tform_alternate_row('line' . $i);\n-\t\tform_selectable_cell($field['title'], $i);\n+\t\tform_selectable_ecell($field['title'], $i);\n \n-\t\t$value = '<not set>';\n+\t\t$value = __('<not set>');\n \t\t$icon  = '';\n \n \t\tif (array_key_exists($field_name, $check['info'])) {\n@@ -368,7 +368,7 @@ function debug_view() {\n \t\t\t$value = substr($value, 0, 100);\n \t\t}\n \n-\t\tform_selectable_cell($value, $i, '', '', $value_title);\n+\t\tform_selectable_ecell($value, $i, '', '', $value_title);\n \t\tform_selectable_cell($icon, $i);\n \n \t\tform_end_row();\n@@ -377,15 +377,6 @@ function debug_view() {\n \n \n \thtml_end_box(false);\n-\n-/*\n-\tprint \"<pre>\";\n-\tif (isset($check) && is_array($check)) {\n-\t\tprint_r($check);\n-\t}\n-\tprint \"</pre>\";\n-*/\n-\n }\n \n function debug_icon($result) {"
        },
        {
          "filename": "data_input.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -922,9 +922,9 @@ function clearFilter() {\n \t\t\t}\n \t\t\tform_alternate_row('line' . $data_input['id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value($data_input['name'], get_request_var('filter'), 'data_input.php?action=edit&id=' . $data_input['id']), $data_input['id']);\n-\t\t\tform_selectable_cell($disabled ? __('No'): __('Yes'), $data_input['id'],'', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($data_input['data_sources'], '-1'), $data_input['id'],'', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($data_input['templates'], '-1'), $data_input['id'],'', 'text-align:right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $data_input['id'],'', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($data_input['data_sources'], '-1'), $data_input['id'],'', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($data_input['templates'], '-1'), $data_input['id'],'', 'right');\n \t\t\tform_selectable_cell($input_types[$data_input['type_id']], $data_input['id']);\n \t\t\tform_checkbox_cell($data_input['name'], $data_input['id'], $disabled);\n \t\t\tform_end_row();"
        },
        {
          "filename": "data_queries.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -1379,10 +1379,10 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $snmp_query['id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value($snmp_query['name'], get_request_var('filter'), 'data_queries.php?action=edit&id=' . $snmp_query['id']), $snmp_query['id']);\n-\t\t\tform_selectable_cell($snmp_query['id'], $snmp_query['id'], '', 'text-align:right;');\n-\t\t\tform_selectable_cell($disabled ? __('No') : __('Yes'), $snmp_query['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($snmp_query['graphs'], '-1'), $snmp_query['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($snmp_query['templates'], '-1'), $snmp_query['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($snmp_query['id'], $snmp_query['id'], '', 'right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $snmp_query['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($snmp_query['graphs'], '-1'), $snmp_query['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($snmp_query['templates'], '-1'), $snmp_query['id'], '', 'right');\n \t\t\tform_selectable_cell(filter_value($snmp_query['data_input_method'], get_request_var('filter')), $snmp_query['id']);\n \t\t\tform_checkbox_cell($snmp_query['name'], $snmp_query['id'], $disabled);\n \t\t\tform_end_row();"
        },
        {
          "filename": "data_source_profiles.php",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -1001,13 +1001,13 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $profile['id'], false, $disabled);\n \t\t\tform_selectable_cell(filter_value($profile['name'], get_request_var('filter'), 'data_source_profiles.php?action=edit&id=' . $profile['id']), $profile['id']);\n-\t\t\tform_selectable_cell($profile['default'] == 'on' ? __('Yes'):'', $profile['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($disabled ? __('No') : __('Yes'), $profile['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($readonly ? __('Yes') : __('No'), $profile['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($sampling_intervals[$profile['step']], $profile['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($heartbeats[$profile['heartbeat']], $profile['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($ds, $profile['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($dt, $profile['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($profile['default'] == 'on' ? __('Yes'):'', $profile['id'], '', 'right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $profile['id'], '', 'right');\n+\t\t\tform_selectable_cell($readonly ? __('Yes'):__('No'), $profile['id'], '', 'right');\n+\t\t\tform_selectable_cell($sampling_intervals[$profile['step']], $profile['id'], '', 'right');\n+\t\t\tform_selectable_cell($heartbeats[$profile['heartbeat']], $profile['id'], '', 'right');\n+\t\t\tform_selectable_cell($ds, $profile['id'], '', 'right');\n+\t\t\tform_selectable_cell($dt, $profile['id'], '', 'right');\n \t\t\tform_checkbox_cell($profile['name'], $profile['id'], $disabled);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "data_sources.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1560,10 +1560,10 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $data_source['local_data_id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value(title_trim($data_source['name_cache'], read_config_option('max_title_length')), get_request_var('rfilter'), 'data_sources.php?action=ds_edit&id=' . $data_source['local_data_id']), $data_source['local_data_id']);\n-\t\t\tform_selectable_cell($data_source['local_data_id'], $data_source['local_data_id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($data_source['local_data_id'], $data_source['local_data_id'], '', 'right');\n \t\t\tform_selectable_cell(get_poller_interval($data_source['rrd_step'], $data_source['data_source_profile_id']), $data_source['local_data_id']);\n \t\t\tform_selectable_cell(api_data_source_deletable($data_source['local_data_id']) ? __('Yes') : __('No'), $data_source['local_data_id']);\n-\t\t\tform_selectable_cell(($data_source['active'] == 'on' ? __('Yes') : __('No')), $data_source['local_data_id']);\n+\t\t\tform_selectable_cell(($data_source['active'] == 'on' ? __('Yes'):__('No')), $data_source['local_data_id']);\n \t\t\tform_selectable_cell($data_template_name, $data_source['local_data_id']);\n \t\t\tform_checkbox_cell($data_source['name_cache'], $data_source['local_data_id'], $disabled);\n \t\t\tform_end_row();"
        },
        {
          "filename": "data_templates.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -1016,9 +1016,9 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $template['id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value($template['name'], get_request_var('filter'), 'data_templates.php?action=template_edit&id=' . $template['id']), $template['id']);\n-\t\t\tform_selectable_cell($template['id'], $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('data_sources.php?reset=true&template_id=' . $template['id']) . '\">' . number_format_i18n($template['data_sources']) . '</a>', $template['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($template['id'], $template['id'], '', 'right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'right');\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('data_sources.php?reset=true&template_id=' . $template['id']) . '\">' . number_format_i18n($template['data_sources']) . '</a>', $template['id'], '', 'right');\n \t\t\tform_selectable_cell((empty($template['data_input_method']) ? '<em>' . __('None') .'</em>': html_escape($template['data_input_method'])), $template['id']);\n \t\t\tform_selectable_cell((empty($template['profile_name']) ? __('External'):html_escape($template['profile_name'])), $template['id']);\n \t\t\tform_selectable_cell((($template['active'] == 'on') ? __('Active'):__('Disabled')), $template['id']);"
        },
        {
          "filename": "gprint_presets.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -410,10 +410,10 @@ function clearFilter() {\n \n             form_alternate_row('line' . $gp['id'], false, $disabled);\n \t\t\tform_selectable_cell(filter_value($gp['name'], get_request_var('filter'), 'gprint_presets.php?action=edit&id=' . $gp['id']), $gp['id']);\n-            form_selectable_cell($gp['gprint_text'], $gp['id'], '', 'text-align:right');\n-            form_selectable_cell($disabled ? __('No'):__('Yes'), $gp['id'], '', 'text-align:right');\n-            form_selectable_cell(number_format_i18n($gp['graphs'], '-1'), $gp['id'], '', 'text-align:right');\n-            form_selectable_cell(number_format_i18n($gp['templates'], '-1'), $gp['id'], '', 'text-align:right');\n+            form_selectable_cell($gp['gprint_text'], $gp['id'], '', 'right');\n+            form_selectable_cell($disabled ? __('No'):__('Yes'), $gp['id'], '', 'right');\n+            form_selectable_cell(number_format_i18n($gp['graphs'], '-1'), $gp['id'], '', 'right');\n+            form_selectable_cell(number_format_i18n($gp['templates'], '-1'), $gp['id'], '', 'right');\n             form_checkbox_cell($gp['name'], $gp['id'], $disabled);\n             form_end_row();\n \t\t}"
        },
        {
          "filename": "graph_templates.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -808,12 +808,12 @@ function clearFilter() {\n \t\t\t}\n \t\t\tform_alternate_row('line' . $template['id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value($template['name'], get_request_var('filter'), 'graph_templates.php?action=template_edit&id=' . $template['id']), $template['id']);\n-\t\t\tform_selectable_cell($template['id'], $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell(number_format_i18n($template['graphs'], '-1'), $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($template['size'], $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($image_types[$template['image_format_id']], $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($template['vertical_label'], $template['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($template['id'], $template['id'], '', 'right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'right');\n+\t\t\tform_selectable_cell(number_format_i18n($template['graphs'], '-1'), $template['id'], '', 'right');\n+\t\t\tform_selectable_ecell($template['size'], $template['id'], '', 'right');\n+\t\t\tform_selectable_cell($image_types[$template['image_format_id']], $template['id'], '', 'right');\n+\t\t\tform_selectable_ecell($template['vertical_label'], $template['id'], '', 'right');\n \t\t\tform_checkbox_cell($template['name'], $template['id'], $disabled);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "graph_view.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -721,9 +721,9 @@ function get_matching_nodes() {\n \n \t\t\tform_alternate_row('line' . $graph['local_graph_id'], true);\n \t\t\tform_selectable_cell(filter_value($graph['title_cache'], get_request_var('rfilter'), 'graph.php?local_graph_id=' . $graph['local_graph_id'] . '&rra_id=0'), $graph['local_graph_id']);\n-\t\t\tform_selectable_cell($graph['description'], $graph['local_graph_id']);\n-\t\t\tform_selectable_cell($graph['template_name'], $graph['local_graph_id']);\n-\t\t\tform_selectable_cell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id']);\n+\t\t\tform_selectable_ecell($graph['description'], $graph['local_graph_id']);\n+\t\t\tform_selectable_ecell($graph['template_name'], $graph['local_graph_id']);\n+\t\t\tform_selectable_ecell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id']);\n \t\t\tform_checkbox_cell($graph['title_cache'], $graph['local_graph_id']);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "graphs.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2043,10 +2043,10 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $graph['local_graph_id'], true);\n \t\t\tform_selectable_cell(filter_value(title_trim($graph['title_cache'], read_config_option('max_title_length')), get_request_var('rfilter'), 'graphs.php?action=graph_edit&id=' . $graph['local_graph_id']), $graph['local_graph_id']);\n-\t\t\tform_selectable_cell($graph['local_graph_id'], $graph['local_graph_id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($graph['local_graph_id'], $graph['local_graph_id'], '', 'right');\n \t\t\tform_selectable_cell(filter_value($sources[$graph['source']], get_request_var('rfilter')), $graph['local_graph_id'], '', 'right');\n \t\t\tform_selectable_cell(filter_value($template_details['name'], get_request_var('rfilter'), $url), $graph['local_graph_id'], '', 'right');\n-\t\t\tform_selectable_cell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id'], '', 'right');\n+\t\t\tform_selectable_ecell($graph['height'] . 'x' . $graph['width'], $graph['local_graph_id'], '', 'right');\n \t\t\tform_checkbox_cell($graph['title_cache'], $graph['local_graph_id']);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "host_templates.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -851,9 +851,9 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $template['id'], true, $disabled);\n \t\t\tform_selectable_cell(filter_value($template['name'], get_request_var('filter'), 'host_templates.php?action=edit&id=' . $template['id']), $template['id']);\n-\t\t\tform_selectable_cell($template['id'], $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('host.php?reset=true&host_template_id=' . $template['id']) . '\">' . number_format_i18n($template['hosts'], '-1') . '</a>', $template['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($template['id'], $template['id'], '', 'right');\n+\t\t\tform_selectable_cell($disabled ? __('No'):__('Yes'), $template['id'], '', 'right');\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape('host.php?reset=true&host_template_id=' . $template['id']) . '\">' . number_format_i18n($template['hosts'], '-1') . '</a>', $template['id'], '', 'right');\n \t\t\tform_checkbox_cell($template['name'], $template['id'], $disabled);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "lib/html_reports.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -1622,7 +1622,7 @@ function reports() {\n \n \t\t\tif (is_reports_admin()) {\n \t\t\t\tif (reports_html_account_exists($report['user_id'])) {\n-\t\t\t\t\tform_selectable_cell($report['full_name'], $report['id']);\n+\t\t\t\t\tform_selectable_ecell($report['full_name'], $report['id']);\n \t\t\t\t} else {\n \t\t\t\t\tform_selectable_cell(__('Report Disabled - No Owner'), $report['id']);\n \t\t\t\t}\n@@ -1633,10 +1633,10 @@ function reports() {\n \t\t\tform_selectable_cell($interval, $report['id']);\n \t\t\tform_selectable_cell(($report['lastsent'] == 0) ? __('Never') : date($date_format, $report['lastsent']), $report['lastsent']);\n \t\t\tform_selectable_cell(date($date_format, $report['mailtime']), $report['id']);\n-\t\t\tform_selectable_cell($report['from_name'], $report['id']);\n-\t\t\tform_selectable_cell((substr_count($report['email'], ',') ? __('Multiple'): $report['email']), $report['id']);\n+\t\t\tform_selectable_ecell($report['from_name'], $report['id']);\n+\t\t\tform_selectable_ecell((substr_count($report['email'], ',') ? __('Multiple'): $report['email']), $report['id']);\n \t\t\tform_selectable_cell((isset($attach_types[$report['attachment_type']])) ? $attach_types[$report['attachment_type']] : __('Invalid'), $report['id']);\n-\t\t\tform_selectable_cell($report['enabled'] ? __('Enabled'): __('Disabled'), $report['id']);\n+\t\t\tform_selectable_cell($report['enabled'] ? __('Enabled'):__('Disabled'), $report['id']);\n \t\t\tform_checkbox_cell($report['name'], $report['id']);\n \n \t\t\tform_end_row();"
        },
        {
          "filename": "lib/html_utility.php",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -149,6 +149,16 @@ function form_alternate_row($row_id = '', $light = false, $disabled = false) {\n \t}\n }\n \n+/* form_selectable_ecell - a wrapper to form_selectable_cell that escapes the contents\n+   @arg $contents - the readable portion of the\n+   @arg $id - the id of the object that will be highlighted\n+   @arg $width - the width of the table element\n+   @arg $style_or_class - the style or class to apply to the table element\n+   @arg $title - optional title for the column */\n+function form_selectable_ecell($contents, $id, $width = '', $style_or_class = '', $title = '') {\n+\tform_selectable_cell(html_escape($contents), $id, $width, $style_or_class, $title);\n+}\n+\n /* form_selectable_cell - format's a table row such that it can be highlighted using cacti's js actions\n    @arg $contents - the readable portion of the\n    @arg $id - the id of the object that will be highlighted"
        },
        {
          "filename": "links.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -397,10 +397,10 @@ function clearFilter() {\n \t\t\t}\n \n \t\t\tform_selectable_cell($actions, $page['id'], '50');\n-\t\t\tform_selectable_cell(html_escape($page['contentfile']), $page['id']);\n-\t\t\tform_selectable_cell(html_escape($page['title']), $page['id']);\n-\t\t\tform_selectable_cell(html_escape($style_translate[$page['style']]) . ($page['style'] == 'CONSOLE' ? ' ( ' . ($page['extendedstyle'] == '' ? 'External Links':$page['extendedstyle']) . ' )':''), $page['id']);\n-\t\t\tform_selectable_cell(($page['enabled'] == 'on' ? 'Yes':'No'), $page['id']);\n+\t\t\tform_selectable_ecell($page['contentfile'], $page['id']);\n+\t\t\tform_selectable_ecell($page['title'], $page['id']);\n+\t\t\tform_selectable_ecell($style_translate[$page['style']] . ($page['style'] == 'CONSOLE' ? ' ( ' . ($page['extendedstyle'] == '' ? __('External Links'):$page['extendedstyle']) . ' )':''), $page['id']);\n+\t\t\tform_selectable_cell(($page['enabled'] == 'on' ? __('Yes'):__('No')), $page['id']);\n \n \t\t\tif (get_request_var('sort_column') == 'sortorder') {\n \t\t\t\tif ($i != 0) {"
        },
        {
          "filename": "managers.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -66,7 +66,7 @@\n }\n \n function manager(){\n-\tglobal $manager_actions, $item_rows;\n+\tglobal $config, $manager_actions, $item_rows;\n \n \t/* ================= input validation and session storage ================= */\n \t$filters = array(\n@@ -238,12 +238,12 @@ function clearFilter() {\n \t\t\t$description = filter_value($item['description'], get_request_var('filter'));\n \t\t\t$hostname    = filter_value($item['hostname'], get_request_var('filter'));\n \t\t\tform_alternate_row('line' . $item['id'], false);\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"managers.php?action=edit&id=' . $item['id'] . '\">' . $description . '</a>', $item['id']);\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape($config['url_path'] . 'managers.php?action=edit&id=' . $item['id']) . '\">' . html_escape($description) . '</a>', $item['id']);\n \t\t\tform_selectable_cell($item['id'], $item['id']);\n \t\t\tform_selectable_cell($item['disabled'] ? '<span class=\"deviceDown\">' . __('Disabled') . '</span>' : '<span class=\"deviceUp\">' . __('Enabled') . '</span>', $item['id']);\n-\t\t\tform_selectable_cell($hostname, $item['id']);\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"managers.php?action=edit&tab=notifications&id=' . $item['id'] . '\">' . ($item['count_notify'] ? $item['count_notify'] : 0) . '</a>' , $item['id']);\n-\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"managers.php?action=edit&tab=logs&id=' . $item['id'] . '\">' . ($item['count_log'] ? $item['count_log'] : 0 ) . '</a>', $item['id']);\n+\t\t\tform_selectable_ecell($hostname, $item['id']);\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape($config['url_path'] . 'managers.php?action=edit&tab=notifications&id=' . $item['id']) . '\">' . ($item['count_notify'] ? $item['count_notify'] : 0) . '</a>' , $item['id']);\n+\t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . html_escape($config['url_path'] . 'managers.php?action=edit&tab=logs&id=' . $item['id']) . '\">' . ($item['count_log'] ? $item['count_log'] : 0 ) . '</a>', $item['id']);\n \t\t\tform_checkbox_cell($item['description'], $item['id']);\n \t\t\tform_end_row();\n \t\t}\n@@ -595,7 +595,7 @@ function clearFilter() {\n \t\t\tform_selectable_cell($mib, $row_id);\n \t\t\tform_selectable_cell($item['kind'], $row_id);\n \t\t\tform_selectable_cell($item['max-access'],$row_id);\n-\t\t\tform_selectable_cell(((isset($notifications[$item['mib']]) && isset($notifications[$item['mib']][$item['name']])) ? '<span class=\"deviceUp\">' .__('Enabled') : '<span class=\"deviceDown\">' .  __('Disabled')) . '</span>', $row_id);\n+\t\t\tform_selectable_cell(((isset($notifications[$item['mib']]) && isset($notifications[$item['mib']][$item['name']])) ? '<span class=\"deviceUp\">' . __('Enabled'):'<span class=\"deviceDown\">' . __('Disabled')) . '</span>', $row_id);\n \t\t\tform_checkbox_cell($item['oid'], $row_id);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "sites.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -529,14 +529,14 @@ function clearFilter() {\n \t$i = 0;\n \tif (cacti_sizeof($site_list)) {\n \t\tforeach ($site_list as $site) {\n-\t\t\t$devices_url = $config['url_path'] . 'host.php?reset=1&site_id=' . $site['id'];\n+\t\t\t$devices_url = html_escape($config['url_path'] . 'host.php?reset=1&site_id=' . $site['id']);\n \t\t\tform_alternate_row('line' . $site['id'], true);\n \t\t\tform_selectable_cell(filter_value($site['name'], get_request_var('filter'), 'sites.php?action=edit&id=' . $site['id']), $site['id']);\n \t\t\tform_selectable_cell($site['id'], $site['id'], '', 'right');\n \t\t\tform_selectable_cell('<a class=\"linkEditMain\" href=\"' . $devices_url . '\">' . number_format_i18n($site['hosts'], '-1') . '</a>', $site['id'], '', 'right');\n-\t\t\tform_selectable_cell($site['city'], $site['id'], '', 'left');\n-\t\t\tform_selectable_cell($site['state'], $site['id'], '', 'left');\n-\t\t\tform_selectable_cell($site['country'], $site['id'], '', 'left');\n+\t\t\tform_selectable_ecell($site['city'], $site['id'], '', 'left');\n+\t\t\tform_selectable_ecell($site['state'], $site['id'], '', 'left');\n+\t\t\tform_selectable_ecell($site['country'], $site['id'], '', 'left');\n \t\t\tform_checkbox_cell($site['name'], $site['id']);\n \t\t\tform_end_row();\n \t\t}"
        },
        {
          "filename": "tree.php",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -2009,17 +2009,17 @@ function clearFilter() {\n \n \t\t\tform_alternate_row('line' . $tree['id'], true);\n \t\t\tform_selectable_cell(filter_value($tree['name'], get_request_var('filter'), 'tree.php?action=edit&id=' . $tree['id']), $tree['id']);\n-\t\t\tform_selectable_cell($tree['id'], $tree['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell($tree['id'], $tree['id'], '', 'right');\n \t\t\tform_selectable_cell($tree['enabled'] == 'on' ? __('Yes'):__('No'), $tree['id']);\n \t\t\tform_selectable_cell($tree['locked'] == '1' ? __('Yes'):__('No'), $tree['id']);\n \t\t\tform_selectable_cell(get_username($tree['user_id']), $tree['id']);\n \t\t\tform_selectable_cell($sequence, $tree['id'], '', 'nowrap center');\n-\t\t\tform_selectable_cell(substr($tree['last_modified'],0,16), $tree['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell(get_username($tree['modified_by']), $tree['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($tree['sites'] > 0 ? number_format_i18n($tree['sites'], '-1'):'-', $tree['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($tree['branches'] > 0 ? number_format_i18n($tree['branches'], '-1'):'-', $tree['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($tree['hosts'] > 0 ? number_format_i18n($tree['hosts'], '-1'):'-', $tree['id'], '', 'text-align:right');\n-\t\t\tform_selectable_cell($tree['graphs'] > 0 ? number_format_i18n($tree['graphs'], '-1'):'-', $tree['id'], '', 'text-align:right');\n+\t\t\tform_selectable_cell(substr($tree['last_modified'],0,16), $tree['id'], '', 'right');\n+\t\t\tform_selectable_cell(get_username($tree['modified_by']), $tree['id'], '', 'right');\n+\t\t\tform_selectable_cell($tree['sites'] > 0 ? number_format_i18n($tree['sites'], '-1'):'-', $tree['id'], '', 'right');\n+\t\t\tform_selectable_cell($tree['branches'] > 0 ? number_format_i18n($tree['branches'], '-1'):'-', $tree['id'], '', 'right');\n+\t\t\tform_selectable_cell($tree['hosts'] > 0 ? number_format_i18n($tree['hosts'], '-1'):'-', $tree['id'], '', 'right');\n+\t\t\tform_selectable_cell($tree['graphs'] > 0 ? number_format_i18n($tree['graphs'], '-1'):'-', $tree['id'], '', 'right');\n \t\t\tform_checkbox_cell($tree['name'], $tree['id']);\n \t\t\tform_end_row();\n "
        },
        {
          "filename": "user_admin.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1241,7 +1241,7 @@ function graph_perms_edit($tab, $header_label) {\n \t\t\tforeach ($hosts as $host) {\n \t\t\t\tform_alternate_row('line' . $host['id'], true);\n \t\t\t\tform_selectable_cell(filter_value($host['description'], get_request_var('filter')), $host['id']);\n-\t\t\t\tform_selectable_cell(round(($host['id']), 2), $host['id']);\n+\t\t\t\tform_selectable_cell($host['id'], $host['id']);\n \t\t\t\tif (empty($host['user_id']) || $host['user_id'] == NULL) {\n \t\t\t\t\tif ($policy['policy_hosts'] == 1) {\n \t\t\t\t\t\tform_selectable_cell('<span class=\"accessGranted\">' . __('Access Granted') . '</span>', $host['id']);"
        },
        {
          "filename": "user_domains.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -760,9 +760,9 @@ function clearFilter() {\n \t\t\tform_selectable_cell(filter_value($domain['domain_name'], get_request_var('filter'), 'user_domains.php?action=edit&domain_id=' . $domain['domain_id']), $domain['domain_id']);\n \t\t\tform_selectable_cell($domain_types[$domain['type']], $domain['domain_id']);\n \t\t\tform_selectable_cell(($domain['defdomain'] == '0' ? '--': __('Yes') ), $domain['domain_id']);\n-\t\t\tform_selectable_cell(($domain['user_id'] == '0' ? __('None Selected') : db_fetch_cell_prepared('SELECT username FROM user_auth WHERE id = ?', array($domain['user_id']))), $domain['domain_id']);\n-\t\t\tform_selectable_cell(db_fetch_cell_prepared('SELECT cn_full_name FROM user_domains_ldap WHERE domain_id = ?', array($domain['domain_id'])), $domain['domain_id']);\n-\t\t\tform_selectable_cell(db_fetch_cell_prepared('SELECT cn_email FROM user_domains_ldap WHERE domain_id = ?', array($domain['domain_id'])), $domain['domain_id']);\n+\t\t\tform_selectable_ecell(($domain['user_id'] == '0' ? __('None Selected') : db_fetch_cell_prepared('SELECT username FROM user_auth WHERE id = ?', array($domain['user_id']))), $domain['domain_id']);\n+\t\t\tform_selectable_ecell(db_fetch_cell_prepared('SELECT cn_full_name FROM user_domains_ldap WHERE domain_id = ?', array($domain['domain_id'])), $domain['domain_id']);\n+\t\t\tform_selectable_ecell(db_fetch_cell_prepared('SELECT cn_email FROM user_domains_ldap WHERE domain_id = ?', array($domain['domain_id'])), $domain['domain_id']);\n \t\t\tform_selectable_cell($domain['enabled'] == 'on' ? __('Yes'):__('No'), $domain['domain_id']);\n \t\t\tform_checkbox_cell($domain['domain_name'], $domain['domain_id']);\n \t\t\tform_end_row();"
        },
        {
          "filename": "user_group_admin.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -688,7 +688,7 @@ function user_group_members_edit($header_label) {\n \t\t\t} else {\n \t\t\t\tform_selectable_cell('<span class=\"accessRestricted\">' . __('Non Member') . '</span>', $g['id']);\n \t\t\t}\n-\t\t\tform_selectable_cell(($g['enabled'] == 'on' ? __('Enabled'): __('Disabled') ), $g['id']);\n+\t\t\tform_selectable_cell(($g['enabled'] == 'on' ? __('Enabled'):__('Disabled') ), $g['id']);\n \t\t\tform_selectable_cell((isset($auth_realms[$g['realm']]) ? $auth_realms[$g['realm']]:'Unknown'), $g['id']);\n \t\t\tform_checkbox_cell($g['full_name'], $g['id']);\n \t\t\tform_end_row();\n@@ -975,7 +975,7 @@ function user_group_graph_perms_edit($tab, $header_label) {\n \t\t\tforeach ($hosts as $host) {\n \t\t\t\tform_alternate_row('line' . $host['id'], true);\n \t\t\t\tform_selectable_cell(filter_value($host['description'], get_request_var('filter')), $host['id']);\n-\t\t\t\tform_selectable_cell(round(($host['id']), 2), $host['id']);\n+\t\t\t\tform_selectable_cell($host['id'], $host['id']);\n \t\t\t\tif (empty($host['group_id']) || $host['group_id'] == NULL) {\n \t\t\t\t\tif ($policy['policy_hosts'] == 1) {\n \t\t\t\t\t\tform_selectable_cell('<span class=\"accessGranted\">' . __('Access Granted') . '</span>', $host['id']);"
        },
        {
          "filename": "utilities.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2481,7 +2481,7 @@ function clearFilter() {\n \t\t\t$max_access = filter_value($item['max-access'], get_request_var('filter'));\n \n \t\t\tform_alternate_row('line' . $item['oid'], false);\n-\t\t\tform_selectable_cell( $oid, $item['oid']);\n+\t\t\tform_selectable_cell($oid, $item['oid']);\n \t\t\tif($item['description']) {\n \t\t\t\tprint '<td><a href=\"#\" title=\"<div class=\\'header\\'>' . $name . '</div><div class=\\'content preformatted\\'>' . html_escape($item['description']) . '</div>\" class=\"tooltip\">' . $name . '</a></td>';\n \t\t\t}else {\n@@ -2490,7 +2490,7 @@ function clearFilter() {\n \t\t\tform_selectable_cell($mib, $item['oid']);\n \t\t\tform_selectable_cell($item['kind'], $item['oid']);\n \t\t\tform_selectable_cell($max_access, $item['oid']);\n-\t\t\tform_selectable_cell((in_array($item['kind'], array(__('Scalar'), __('Column Data'))) ? $item['value'] : __('N/A')), $item['oid']);\n+\t\t\tform_selectable_ecell((in_array($item['kind'], array(__('Scalar'), __('Column Data'))) ? $item['value'] : __('N/A')), $item['oid']);\n \t\t\tform_end_row();\n \t\t}\n \t}"
        },
        {
          "filename": "vdef.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -99,7 +99,7 @@ function draw_vdef_preview($vdef_id) {\n \t?>\n \t<tr class='even'>\n \t\t<td style='padding:4px'>\n-\t\t\t<pre>vdef=<?php print get_vdef($vdef_id, true);?></pre>\n+\t\t\t<pre>vdef=<?php print html_escape(get_vdef($vdef_id, true));?></pre>\n \t\t</td>\n \t</tr>\n \t<?php\n@@ -404,7 +404,7 @@ function vdef_item_edit() {\n \t\t$header_label = __('VDEF Items [new]');\n \t}\n \n-\tform_start('vdef.php', 'form_vdef');\n+\tform_start('vdef.php', 'chk');\n \n \thtml_start_box($header_label, '100%', '', '3', 'center', '');\n \n@@ -897,9 +897,9 @@ function vdef($refresh = true) {\n \n             form_alternate_row('line' . $vdef['id'], false, $disabled);\n \t\t\tform_selectable_cell(filter_value($vdef['name'], get_request_var('filter'), 'vdef.php?action=edit&id=' . $vdef['id']), $vdef['id']);\n-            form_selectable_cell($disabled ? __('No'):__('Yes'), $vdef['id'], '', 'text-align:right');\n-            form_selectable_cell(number_format_i18n($vdef['graphs'], '-1'), $vdef['id'], '', 'text-align:right');\n-            form_selectable_cell(number_format_i18n($vdef['templates'], '-1'), $vdef['id'], '', 'text-align:right');\n+            form_selectable_cell($disabled ? __('No'):__('Yes'), $vdef['id'], '', 'right');\n+            form_selectable_cell(number_format_i18n($vdef['graphs'], '-1'), $vdef['id'], '', 'right');\n+            form_selectable_cell(number_format_i18n($vdef['templates'], '-1'), $vdef['id'], '', 'right');\n             form_checkbox_cell($vdef['name'], $vdef['id'], $disabled);\n             form_end_row();\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a10a2e0e6064e8d9624f107302ea72bdd207ec8c",
            "date": "2025-01-14T20:40:49Z",
            "author_login": "xmacan"
          },
          {
            "sha": "48223acbc4013a23593904ee2affd5a9c3cc73f9",
            "date": "2025-01-14T01:29:39Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "80dedbfd4a5ec0654948af54067fa08e09774eb7",
            "date": "2025-01-14T01:07:08Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "1cc3e01ec730211e9d456513afe5ac8a9ff380eb",
            "date": "2025-01-14T00:55:44Z",
            "author_login": "TheWitness"
          },
          {
            "sha": "4927e821722d1273c64fe01b5f92546cbb436a74",
            "date": "2025-01-14T00:15:45Z",
            "author_login": "TheWitness"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "A cross-site scripting (XSS) vulnerability exists in host.php (via tree.php) in Cacti before 1.2.0 due to lack of escaping of unintended characters in the Website Hostname field for Devices.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-01-16T16:29:00.697",
    "last_modified": "2024-11-21T04:02:02.620",
    "fix_date": "2018-12-16T15:54:11Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00001.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00005.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00042.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00048.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Cacti/cacti/blob/develop/CHANGELOG",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/80c2a88fb2afb93f87703ba4641f9970478c102d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/issues/2213",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00005.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00042.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00048.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Cacti/cacti/blob/develop/CHANGELOG",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/commit/80c2a88fb2afb93f87703ba4641f9970478c102d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Cacti/cacti/issues/2213",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:42.250989",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cacti",
    "owner": "Cacti",
    "created_at": "2015-01-19T05:36:15Z",
    "updated_at": "2025-01-14T05:23:12Z",
    "pushed_at": "2025-01-14T01:29:41Z",
    "size": 274359,
    "stars": 1675,
    "forks": 406,
    "open_issues": 144,
    "watchers": 1675,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "1.2.x",
      "develop",
      "master",
      "old-develop"
    ],
    "languages": {
      "PHP": 6996697,
      "HTML": 2708532,
      "JavaScript": 2534022,
      "CSS": 1763474,
      "SCSS": 1596996,
      "Less": 246030,
      "Shell": 48853,
      "Perl": 7357,
      "Ruby": 2138
    },
    "commit_activity": {
      "total_commits_last_year": 1068,
      "avg_commits_per_week": 20.53846153846154,
      "days_active_last_year": 177
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:59:13.884661"
  }
}