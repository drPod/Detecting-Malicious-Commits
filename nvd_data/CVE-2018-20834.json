{
  "cve_id": "CVE-2018-20834",
  "github_data": {
    "repository": "npm/node-tar",
    "fix_commit": "7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d",
    "related_commits": [
      "7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d",
      "b0c58433c22f5e7fe8b1c76373f27e3f81dcd4c8",
      "7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d",
      "b0c58433c22f5e7fe8b1c76373f27e3f81dcd4c8"
    ],
    "patch_url": "https://github.com/npm/node-tar/commit/7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d.patch",
    "fix_commit_details": {
      "sha": "7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d",
      "commit_date": "2019-05-15T00:43:20Z",
      "author": {
        "login": "isaacs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bump fstream to fix hardlink overwriting vulnerability",
        "length": 73,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 70,
        "additions": 65,
        "deletions": 5
      },
      "files": [
        {
          "filename": "lib/parse.js",
          "status": "modified",
          "additions": 0,
          "deletions": 4,
          "patch": "@@ -251,10 +251,6 @@ Parse.prototype._startEntry = function (c) {\n \n   if (onend) entry.on(\"end\", onend)\n \n-  if (entry.type === \"File\" && this._hardLinks[entry.path]) {\n-    ev = \"ignoredEntry\"\n-  }\n-\n   this._entry = entry\n \n   if (entry.type === \"Link\") {"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -13,7 +13,7 @@\n   },\n   \"dependencies\": {\n     \"block-stream\": \"*\",\n-    \"fstream\": \"^1.0.2\",\n+    \"fstream\": \"^1.0.12\",\n     \"inherits\": \"2\"\n   },\n   \"devDependencies\": {"
        },
        {
          "filename": "test/link-file-entry-collision.js",
          "status": "added",
          "additions": 39,
          "deletions": 0,
          "patch": "@@ -0,0 +1,39 @@\n+// Set the umask, so that it works the same everywhere.\n+process.umask(parseInt('22', 8))\n+\n+var tap = require(\"tap\")\n+  , tar = require(\"../tar.js\")\n+  , fs = require(\"fs\")\n+  , path = require(\"path\")\n+  , file = path.resolve(__dirname, \"link-file-entry-collision/bad-link.tar\")\n+  , target = path.resolve(__dirname, \"tmp/link-file-entry-collision\")\n+  , index = 0\n+  , fstream = require(\"fstream\")\n+  , mkdirp = require(\"mkdirp\")\n+  , rimraf = require(\"rimraf\")\n+\n+tap.test(\"preclean\", function (t) {\n+  rimraf.sync(target)\n+  t.pass(\"cleaned!\")\n+  t.end()\n+})\n+\n+tap.test(\"extract test\", function (t) {\n+  var extract = tar.Extract(target)\n+  var inp = fs.createReadStream(file)\n+  inp.pipe(extract)\n+\n+  extract.on(\"end\", function () {\n+    t.equal(fs.readFileSync(target + \"/bad-link-target\", \"utf8\"),\n+      \"this should remain the same\\n\")\n+    t.equal(fs.readFileSync(target + \"/a.txt\", \"utf8\"),\n+      \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\")\n+    t.end()\n+  })\n+})\n+\n+tap.test(\"cleanup\", function (t) {\n+  rimraf.sync(target)\n+  t.pass(\"cleaned!\")\n+  t.end()\n+})"
        },
        {
          "filename": "test/link-file-entry-collision/bad-link.hex",
          "status": "added",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -0,0 +1,25 @@\n+-- header for the link target --\n+6261642d6c696e6b2d74617267657400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000303030363434200030303037363520003030303032342000303030303030303030333420313334363636353530353620303134333731002030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # bad-link-target.....................................................................................000644..000765..000024..00000000034.13466655056.014371..0...................................................................................................\n+00757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # .ustar.00isaacs..........................staff...........................000000..000000.........................................................................................................................................................................\n+\n+-- link target file contents (should not be overwritten) --\n+746869732073686f756c642072656d61696e207468652073616d650a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # this.should.remain.the.same.....................................................................................................................................................................................................................................\n+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # ................................................................................................................................................................................................................................................................\n+\n+-- header for the link named a.txt --\n+612e74787400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003030303634342000303030373635200030303030323420003030303030303030303030203133343636363535303536203031353334320020316261642d6c696e6b2d746172676574000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # a.txt...............................................................................................000644..000765..000024..00000000000.13466655056.015342..1bad-link-target....................................................................................\n+00757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # .ustar.00isaacs..........................staff...........................000000..000000.........................................................................................................................................................................\n+\n+-- header for file entry which attempts to overwrite the link --\n+612e7478740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000303030363434200030353737363120003030303032342000303030303030303034303120313136353133363033333320303132343531002030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # a.txt...............................................................................................000644..057761..000024..00000000401.11651360333.012451..0...................................................................................................\n+00757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # .ustar.00isaacs..........................staff...........................000000..000000.........................................................................................................................................................................\n+\n+-- contents that threaten to overwrite the link target --\n+61616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161  # aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n+61000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # a...............................................................................................................................................................................................................................................................\n+\n+-- tar eof --\n+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # ................................................................................................................................................................................................................................................................\n+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # ................................................................................................................................................................................................................................................................\n+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # ................................................................................................................................................................................................................................................................\n+00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000  # ................................................................................................................................................................................................................................................................"
        },
        {
          "filename": "test/link-file-entry-collision/bad-link.tar",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 3,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d3cd4392d4a35a8f1e10287a07e57da6ae079e78",
            "date": "2024-08-14T16:04:53Z",
            "author_login": "isaacs"
          },
          {
            "sha": "02f883aa4d3336c023fb826d4ba11dde01c7f338",
            "date": "2024-08-14T16:03:40Z",
            "author_login": "isaacs"
          },
          {
            "sha": "206fcf91b01fae95ae859b8f3254bfd88744602a",
            "date": "2024-07-26T04:33:27Z",
            "author_login": "isaacs"
          },
          {
            "sha": "bf13718dc6b6636a234327122e8df05df52674d3",
            "date": "2024-07-26T04:32:21Z",
            "author_login": "isaacs"
          },
          {
            "sha": "68a685b30eadddad71cec56bc136bd276fa7e7f6",
            "date": "2024-07-24T23:57:43Z",
            "author_login": "isaacs"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-59",
    "description": "A vulnerability was found in node-tar before version 4.4.2 (excluding version 2.2.2). An Arbitrary File Overwrite issue exists when extracting a tarball containing a hardlink to a file that already exists on the system, in conjunction with a later plain file with the same name as the hardlink. This plain file content replaces the existing file content. A patch has been applied to node-tar v2.2.2).",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-04-30T19:29:03.327",
    "last_modified": "2024-11-21T04:02:16.243",
    "fix_date": "2019-05-15T00:43:20Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:1821",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/npm/node-tar/commit/7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/npm/node-tar/commit/b0c58433c22f5e7fe8b1c76373f27e3f81dcd4c8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/npm/node-tar/commits/v2.2.2",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/npm/node-tar/compare/58a8d43...a5f7779",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/344595",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2018-20834",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:1821",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/npm/node-tar/commit/7ecef07da6a9e72cc0c4d0c9c6a8e85b6b52395d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/npm/node-tar/commit/b0c58433c22f5e7fe8b1c76373f27e3f81dcd4c8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/npm/node-tar/commits/v2.2.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/npm/node-tar/compare/58a8d43...a5f7779",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/344595",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2018-20834",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:50.457421",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "node-tar",
    "owner": "npm",
    "created_at": "2011-03-27T22:17:23Z",
    "updated_at": "2025-01-13T09:09:37Z",
    "pushed_at": "2024-08-14T16:04:55Z",
    "size": 10002,
    "stars": 850,
    "forks": 185,
    "open_issues": 16,
    "watchers": 850,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "JavaScript": 271712,
      "TypeScript": 211914
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "isc"
    },
    "collected_at": "2025-01-14T15:12:20.768321"
  }
}