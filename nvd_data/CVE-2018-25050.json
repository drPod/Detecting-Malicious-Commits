{
  "cve_id": "CVE-2018-25050",
  "github_data": {
    "repository": "harvesthq/chosen",
    "fix_commit": "77fd031d541e77510268d1041ed37798fdd1017e",
    "related_commits": [
      "77fd031d541e77510268d1041ed37798fdd1017e",
      "77fd031d541e77510268d1041ed37798fdd1017e"
    ],
    "patch_url": "https://github.com/harvesthq/chosen/commit/77fd031d541e77510268d1041ed37798fdd1017e.patch",
    "fix_commit_details": {
      "sha": "77fd031d541e77510268d1041ed37798fdd1017e",
      "commit_date": "2018-06-08T18:21:58Z",
      "author": {
        "login": "tjschuck",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #2997 from harvesthq/fix-group-label-xss-vulnerability",
        "length": 117,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 64,
        "additions": 63,
        "deletions": 1
      },
      "files": [
        {
          "filename": "coffee/lib/abstract-chosen.coffee",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -51,7 +51,7 @@ class AbstractChosen\n \n   choice_label: (item) ->\n     if @include_group_label_in_selected and item.group_label?\n-      \"<b class='group-name'>#{item.group_label}</b>#{item.html}\"\n+      \"<b class='group-name'>#{this.escape_html(item.group_label)}</b>#{item.html}\"\n     else\n       item.html\n "
        },
        {
          "filename": "spec/jquery/bugfixes.spec.coffee",
          "status": "added",
          "additions": 30,
          "deletions": 0,
          "patch": "@@ -0,0 +1,30 @@\n+describe \"Bugfixes\", ->\n+  it \"https://github.com/harvesthq/chosen/issues/2996 - XSS Vulnerability with `include_group_label_in_selected: true`\", ->\n+    tmpl = \"\n+      <select>\n+        <option value=''></option>\n+        <optgroup label='</script><script>console.log(1)</script>'>\n+          <option>an xss option</option>\n+        </optgroup>\n+      </select>\n+    \"\n+\n+    div = $(\"<div>\").html(tmpl)\n+    select = div.find(\"select\")\n+\n+    select.chosen\n+      include_group_label_in_selected: true\n+\n+    # open the drop\n+    container = div.find(\".chosen-container\")\n+    container.trigger(\"mousedown\")\n+\n+    xss_option = container.find(\".active-result\").last()\n+    expect(xss_option.html()).toBe \"an xss option\"\n+\n+    # trigger the selection of the xss option\n+    xss_option.trigger(\"mouseup\")\n+\n+    # make sure the script tags are escaped correctly\n+    label_html = container.find(\"a.chosen-single\").html()\n+    expect(label_html).toContain('&lt;/script&gt;&lt;script&gt;console.log(1)&lt;/script&gt;')"
        },
        {
          "filename": "spec/proto/bugfixes.spec.coffee",
          "status": "added",
          "additions": 32,
          "deletions": 0,
          "patch": "@@ -0,0 +1,32 @@\n+describe \"Bugfixes\", ->\n+  it \"https://github.com/harvesthq/chosen/issues/2996 - XSS Vulnerability with `include_group_label_in_selected: true`\", ->\n+    tmpl = \"\n+      <select>\n+        <option value=''></option>\n+        <optgroup id='xss' label='</script><script>console.log(1)</script>'>\n+          <option>an xss option</option>\n+        </optgroup>\n+      </select>\n+    \"\n+    div = new Element(\"div\")\n+    document.body.insert(div)\n+    div.innerHTML = tmpl\n+\n+    select = div.down(\"select\")\n+    new Chosen select,\n+      include_group_label_in_selected: true\n+\n+    # open the drop\n+    container = div.down(\".chosen-container\")\n+    simulant.fire(container, \"mousedown\") # open the drop\n+\n+    xss_option = container.select(\".active-result\").last()\n+    expect(xss_option.innerHTML).toBe \"an xss option\"\n+\n+    # trigger the selection of the xss option\n+    simulant.fire(xss_option, \"mouseup\")\n+\n+    # make sure the script tags are escaped correctly\n+    label_html = container.down(\"a.chosen-single\").innerHTML\n+    expect(label_html).toContain('&lt;/script&gt;&lt;script&gt;console.log(1)&lt;/script&gt;')\n+"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c914ecd5120c0681fa349a8d33a12caad148d026",
            "date": "2022-09-26T21:24:39Z",
            "author_login": "tjschuck"
          },
          {
            "sha": "91041bc9dd6867f9a1668050a1b092d92027f13b",
            "date": "2020-01-17T12:04:31Z",
            "author_login": "Pezmc"
          },
          {
            "sha": "0035be8e3e0daea556dc36ab480f9a266a34dfab",
            "date": "2019-06-04T19:40:58Z",
            "author_login": "tjschuck"
          },
          {
            "sha": "69fcb908699916b8acf3534b4a76046bd26489e3",
            "date": "2019-06-02T19:42:41Z",
            "author_login": "codetriage-readme-bot"
          },
          {
            "sha": "4133dd9d53f13bc28953949441d09a7c3538912d",
            "date": "2018-06-29T22:08:39Z",
            "author_login": "tjschuck"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability, which was classified as problematic, has been found in Harvest Chosen up to 1.8.6. Affected by this issue is the function AbstractChosen of the file coffee/lib/abstract-chosen.coffee. The manipulation of the argument group_label leads to cross site scripting. The attack may be launched remotely. Upgrading to version 1.8.7 is able to address this issue. The name of the patch is 77fd031d541e77510268d1041ed37798fdd1017e. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216956.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-28T10:15:08.783",
    "last_modified": "2024-11-21T04:03:26.563",
    "fix_date": "2018-06-08T18:21:58Z"
  },
  "references": [
    {
      "url": "https://github.com/harvesthq/chosen/commit/77fd031d541e77510268d1041ed37798fdd1017e",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/harvesthq/chosen/pull/2997",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/harvesthq/chosen/releases/tag/v1.8.7",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216956",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216956",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/harvesthq/chosen/commit/77fd031d541e77510268d1041ed37798fdd1017e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/harvesthq/chosen/pull/2997",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/harvesthq/chosen/releases/tag/v1.8.7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216956",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216956",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.227499",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "chosen",
    "owner": "harvesthq",
    "created_at": "2011-04-18T15:07:41Z",
    "updated_at": "2025-01-14T07:31:45Z",
    "pushed_at": "2024-12-02T12:10:35Z",
    "size": 3057,
    "stars": 21832,
    "forks": 4082,
    "open_issues": 311,
    "watchers": 21832,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "HTML": 185210,
      "CoffeeScript": 96118,
      "SCSS": 9648,
      "CSS": 8683,
      "Shell": 1116,
      "JavaScript": 977
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:14:09.966066"
  }
}