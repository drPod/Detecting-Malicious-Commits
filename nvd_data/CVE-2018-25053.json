{
  "cve_id": "CVE-2018-25053",
  "github_data": {
    "repository": "moappi/json2html",
    "fix_commit": "2d3d24d971b19a8ed1fb823596300b9835d55801",
    "related_commits": [
      "2d3d24d971b19a8ed1fb823596300b9835d55801",
      "2d3d24d971b19a8ed1fb823596300b9835d55801"
    ],
    "patch_url": "https://github.com/moappi/json2html/commit/2d3d24d971b19a8ed1fb823596300b9835d55801.patch",
    "fix_commit_details": {
      "sha": "2d3d24d971b19a8ed1fb823596300b9835d55801",
      "commit_date": "2018-02-09T20:32:32Z",
      "author": {
        "login": "moappi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added Text Attribute",
        "length": 116,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 178,
        "additions": 134,
        "deletions": 44
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -28,7 +28,7 @@ Transform (template)\n ```javascript\n var transform = \n  {\"<>\": \"li\", \"id\":\"${id}\", \"html\":[\n-\t{\"<>\": \"span\", \"html\": \"${name} (${year})\"}\n+\t{\"<>\": \"span\", \"text\": \"${name} (${year})\"}\n   ]};\t\t\n ```\n Plus JSON Data"
        },
        {
          "filename": "examples/default.html",
          "status": "removed",
          "additions": 0,
          "deletions": 16,
          "patch": "@@ -1,16 +0,0 @@\n-<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n-<html>\n- <head>\n-\t<title> json2html examples </title>\n-\n-\t<!-- Add JSON2HTML -->\n-\t<script type=\"text/javascript\" src=\"../json2html.js\"></script>\n-\t\n- </head>\n- <body>\n-\t<!-- Run the tests -->\n-\t<script type=\"text/javascript\" src=\"example.nested.js\"></script>\n-\t<script type=\"text/javascript\" src=\"example.shorthand.js\"></script>\n-\t<script type=\"text/javascript\" src=\"example.escape.js\"></script>\n- </body>\n-</html>"
        },
        {
          "filename": "json2html.js",
          "status": "modified",
          "additions": 88,
          "deletions": 26,
          "patch": "@@ -1,4 +1,4 @@\n-//Copyright (c) 2016 Crystalline Technologies\n+//Copyright (c) 2018 Crystalline Technologies\n //\n //  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'),\n //  to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, \n@@ -135,14 +135,61 @@ var json2html = {\n \n \t\t\t\t\tswitch(key) {\n \t\t\t\t\t\t\n-\t\t\t\t\t\t//LEGACY support for tag\n+\t\t\t\t\t\t//DEPRECATED (use <> instead)\n \t\t\t\t\t\tcase 'tag':\n+\n+\t\t\t\t\t\t//HTML element to render\n \t\t\t\t\t\tcase '<>':\n \t\t\t\t\t\t\t//Do nothing as we have already created the element\n \t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\n+\t\t\t\t\t\t//Encode as text\n+\t\t\t\t\t\tcase 'text':\n+\t\t\t\t\t\t\t//Get the transform value associated with this key\n+\t\t\t\t\t\t\tvar _transform = transform[key];\n+\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\t//Determine what kind of object this is\n+\t\t\t\t\t\t\t// array => NOT SUPPORTED\n+\t\t\t\t\t\t\t// other => text\n+\t\t\t\t\t\t\tif(json2html._isArray(_transform)) {\n+                                //NOT Supported\n+\t\t\t\t\t\t\t} else if(typeof _transform === 'function') {\n+\t\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\t\t//Get the result from the function\n+\t\t\t\t\t\t\t\tvar temp = _transform.call(obj, obj, index);\n+\t\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\t\t//Don't allow arrays as return objects from functions\n+    \t\t\t\t\t\t\tif(!json2html._isArray(temp)) {\n+\n+    \t\t\t\t\t\t\t\t//Determine what type of object was returned\n+    \t\t\t\t\t\t\t\tswitch(typeof temp){\n+                                    \n+    \t\t\t\t\t\t\t\t\t//Not supported for text\n+    \t\t\t\t\t\t\t\t\tcase 'function':\n+    \t\t\t\t\t\t\t\t\tcase 'undefined':\n+    \t\t\t\t\t\t\t\t\tcase 'object':\n+    \t\t\t\t\t\t\t\t\tbreak; \n+    \t\t\t\t\t\t\t\t\t\n+    \t\t\t\t\t\t\t\t\t//Append as text\n+    \t\t\t\t\t\t\t\t\t// string, number, boolean\n+    \t\t\t\t\t\t\t\t\tdefault:\n+    \t\t\t\t\t\t\t\t\t\t//Insure we encode as text first\n+    \t\t\t\t\t\t\t\t\t\tchildren.html += json2html.toText(temp);\n+    \t\t\t\t\t\t\t\t\tbreak;\n+    \t\t\t\t\t\t\t\t}\n+    \t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\t\t\n+\t\t\t\t\t\t\t\t//Get the encoded text associated with this element\n+\t\t\t\t\t\t\t\thtml = json2html.toText( json2html._getValue(obj,transform,key,index) );\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\tbreak;\n \n-\t\t\t\t\t\t//LEGACY support for children\n+\t\t\t\t\t\t//DEPRECATED (use HTML instead)\n \t\t\t\t\t\tcase 'children':\n+\n+\t\t\t\t\t\t//Encode as HTML\n+\t\t\t\t\t\t// accepts Array of children, functions, string, number, boolean\n \t\t\t\t\t\tcase 'html':\n \n \t\t\t\t\t\t\t//Get the transform value associated with this key\n@@ -160,31 +207,35 @@ var json2html = {\n \t\t\t\t\t\t\t\t\n \t\t\t\t\t\t\t\t//Get the result from the function\n \t\t\t\t\t\t\t\tvar temp = _transform.call(obj, obj, index);\n-\n-\t\t\t\t\t\t\t\t//Determine what type of object was returned\n-\t\t\t\t\t\t\t\tswitch(typeof temp){\n-\n-\t\t\t\t\t\t\t\t\t//Only returned by json2html.transform or $.json2html calls\n-\t\t\t\t\t\t\t\t\tcase 'object':\n-\t\t\t\t\t\t\t\t\t\t//make sure this object is a valid json2html response object\n-\t\t\t\t\t\t\t\t\t\t// we ignore all other objects (since we don't know how to represent them in html)\n-\t\t\t\t\t\t\t\t\t\tif(temp.html !== undefined && temp.events !== undefined) children = json2html._append(children,temp);\n-\t\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\t\t\t\n-\t\t\t\t\t\t\t\t\t//Not supported\n-\t\t\t\t\t\t\t\t\tcase 'function':\n-\t\t\t\t\t\t\t\t\tcase 'undefined':\n-\t\t\t\t\t\t\t\t\tbreak; \n-\n-\t\t\t\t\t\t\t\t\t//Append to html\n-\t\t\t\t\t\t\t\t\t// string, number, boolean\n-\t\t\t\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t\t\t\tchildren.html += temp;\n-\t\t\t\t\t\t\t\t\tbreak;\n-\t\t\t\t\t\t\t\t}\n+                                \n+                                //Don't allow arrays as return objects from functions\n+                                if(!json2html._isArray(temp)) {\n+                                    \n+    \t\t\t\t\t\t\t\t//Determine what type of object was returned\n+    \t\t\t\t\t\t\t\tswitch(typeof temp){\n+    \n+    \t\t\t\t\t\t\t\t\t//Only returned by json2html.transform or $.json2html calls\n+    \t\t\t\t\t\t\t\t\tcase 'object':\n+    \t\t\t\t\t\t\t\t\t\t//make sure this object is a valid json2html response object\n+    \t\t\t\t\t\t\t\t\t\t// we ignore all other objects (since we don't know how to represent them in html)\n+    \t\t\t\t\t\t\t\t\t\tif(temp.html !== undefined && temp.events !== undefined) children = json2html._append(children,temp);\n+    \t\t\t\t\t\t\t\t\tbreak;\n+    \t\t\t\t\t\t\t\t\t\n+    \t\t\t\t\t\t\t\t\t//Not supported\n+    \t\t\t\t\t\t\t\t\tcase 'function':\n+    \t\t\t\t\t\t\t\t\tcase 'undefined':\n+    \t\t\t\t\t\t\t\t\tbreak; \n+    \n+    \t\t\t\t\t\t\t\t\t//Append to html\n+    \t\t\t\t\t\t\t\t\t// string, number, boolean\n+    \t\t\t\t\t\t\t\t\tdefault:\n+    \t\t\t\t\t\t\t\t\t\tchildren.html += temp;\n+    \t\t\t\t\t\t\t\t\tbreak;\n+    \t\t\t\t\t\t\t\t}\n+                                }\n \t\t\t\t\t\t\t} else {\n \t\t\t\t\t\t\t\t\n-\t\t\t\t\t\t\t\t//Create the html attribute for this element\n+\t\t\t\t\t\t\t\t//Get the HTML associated with this element\n \t\t\t\t\t\t\t\thtml = json2html._getValue(obj,transform,key,index);\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\tbreak;\n@@ -319,6 +370,17 @@ var json2html = {\n \n \t\treturn(out);\n \t},\n+\n+\t//Encode the html to text\n+\t'toText':function(html) {\n+\t\treturn html\n+\t\t\t.replace(/&/g, '&amp;')\n+\t\t\t.replace(/</g, '&lt;')\n+\t\t\t.replace(/>/g, '&gt;')\n+\t\t\t.replace(/\\\"/g, '&quot;')\n+\t\t\t.replace(/\\'/g, '&#39;')\n+\t\t\t.replace(/\\//g, '&#x2F;');\n+\t},\n \t\n \t//Tokenizer\n \t'_tokenizer':function( tokenizers, doBuild ){"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n   },\n   \"name\": \"json2html\",\n   \"description\": \"json2html - HTML Templating\",\n-  \"version\": \"1.0.1\",\n+  \"version\": \"1.1.0\",\n   \"homepage\": \"http://json2html.com\",\n   \"repository\": {\n     \"url\": \"https://github.com/moappi/json2html.git\""
        },
        {
          "filename": "test/index.html",
          "status": "added",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -0,0 +1,17 @@\n+<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n+<html>\n+ <head>\n+\t<title> json2html tests </title>\n+\n+\t<!-- Add JSON2HTML -->\n+\t<script type=\"text/javascript\" src=\"../json2html.js\"></script>\n+\t\n+ </head>\n+ <body>\n+\t<!-- Run the tests -->\n+\t<script type=\"text/javascript\" src=\"test.nested.js\"></script>\n+\t<script type=\"text/javascript\" src=\"test.shorthand.js\"></script>\n+\t<script type=\"text/javascript\" src=\"test.escape.js\"></script>\n+\t<script type=\"text/javascript\" src=\"test.text.js\"></script>\n+ </body>\n+</html>"
        },
        {
          "filename": "test/test.escape.js",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "test/test.nested.js",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "test/test.shorthand.js",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "test/test.text.js",
          "status": "added",
          "additions": 27,
          "deletions": 0,
          "patch": "@@ -0,0 +1,27 @@\n+\n+(function() {\n+    \n+\t//Test the handling of quoted strings \n+    var test_data = [\n+\t\t{\"text\":\"<script>alert(0);</script> no alert\"},\n+\t\t{\"text\":\"<strong>non highlighted</strong>\"},\n+\t\t{\"text\":\"& (ampersand) : ' (single quote) : \\\" (double quote) \"}\n+\t];\n+\n+    var transform = [\n+        {\"<>\":\"div\", \"text\":\"${text}\"},\n+        {\"<>\":\"div\",\"text\":[\n+            {\"<>\":\"span\",\"text\":\"this shouldn't be rendered\"}\n+        ]},\n+        {\"<>\":\"div\", \"text\":function(){\n+            return(this.text);\n+        }},\n+        {\"<>\":\"div\", \"text\":function(){\n+            return([\"not rendered\"]);\n+        }}\n+    ];\n+        \n+    var html = json2html.transform(test_data, transform);\n+\n+    document.write('<h1>Text Encoding Test</h1>'+ html);\n+})();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 5,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3f1580642b13de9cc1820b3825189e2fb6d9556c",
            "date": "2024-11-21T08:37:44Z",
            "author_login": "moappi"
          },
          {
            "sha": "3932916c88a093dfbe0bcbb1c50ecd2358ee7057",
            "date": "2024-11-21T08:36:44Z",
            "author_login": "moappi"
          },
          {
            "sha": "b25edb9bd262c451e91bfd7e96a2ee61748dc87c",
            "date": "2024-11-21T08:33:36Z",
            "author_login": "moappi"
          },
          {
            "sha": "5e9d5bb4080ff319b4226f77d61a13a60c4be677",
            "date": "2024-11-21T08:29:18Z",
            "author_login": "moappi"
          },
          {
            "sha": "ecf136f28d34c71882583ab6cfa0f7cb9d065117",
            "date": "2024-09-11T01:53:22Z",
            "author_login": "moappi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in moappi Json2html up to 1.1.x and classified as problematic. This issue affects some unknown processing of the file json2html.js. The manipulation leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 1.2.0 is able to address this issue. The name of the patch is 2d3d24d971b19a8ed1fb823596300b9835d55801. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216959.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-28T12:15:08.680",
    "last_modified": "2024-11-21T04:03:26.953",
    "fix_date": "2018-02-09T20:32:32Z"
  },
  "references": [
    {
      "url": "https://github.com/moappi/json2html/commit/2d3d24d971b19a8ed1fb823596300b9835d55801",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moappi/json2html/releases/tag/1.2.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216959",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216959",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moappi/json2html/commit/2d3d24d971b19a8ed1fb823596300b9835d55801",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moappi/json2html/releases/tag/1.2.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216959",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216959",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.227955",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "json2html",
    "owner": "moappi",
    "created_at": "2011-12-29T06:13:25Z",
    "updated_at": "2024-12-18T12:59:20Z",
    "pushed_at": "2024-12-11T06:31:18Z",
    "size": 190,
    "stars": 632,
    "forks": 104,
    "open_issues": 7,
    "watchers": 632,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 86139,
      "HTML": 1163
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:03:21.886821"
  }
}