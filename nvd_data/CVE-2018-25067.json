{
  "cve_id": "CVE-2018-25067",
  "github_data": {
    "repository": "JoomGallery/JoomGallery",
    "fix_commit": "dc414ee954e849082260f8613e15a1c1e1d354a1",
    "related_commits": [
      "dc414ee954e849082260f8613e15a1c1e1d354a1",
      "dc414ee954e849082260f8613e15a1c1e1d354a1"
    ],
    "patch_url": "https://github.com/JoomGallery/JoomGallery/commit/dc414ee954e849082260f8613e15a1c1e1d354a1.patch",
    "fix_commit_details": {
      "sha": "dc414ee954e849082260f8613e15a1c1e1d354a1",
      "commit_date": "2018-01-21T00:29:10Z",
      "author": {
        "login": "Chraneco",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #122 from Erftralle/fix-sql-injection-image-ordering",
        "length": 137,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 53,
        "additions": 47,
        "deletions": 6
      },
      "files": [
        {
          "filename": "administrator/components/com_joomgallery/helpers/config.php",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -337,6 +337,14 @@ class JoomConfig extends JObject\n    */\n   protected $_extended = false;\n \n+  /**\n+   * Contains all valid ORDER BY clauses for the image sorting\n+   * options $jg_firstorder, $jg_secondorder and $jg_thirdorder.\n+   *\n+   * @var array\n+   */\n+  private static $_validImageSortingOrderByClauses = array('ordering ASC', 'ordering DESC', 'imgdate ASC', 'imgdate DESC', 'imgtitle ASC', 'imgtitle DESC');\n+\n   /**\n    * Constructor\n    *\n@@ -472,4 +480,18 @@ public function getStyleSheetName($id = 0)\n \n     return 'joom_settings'.$this->_id.'.css';\n   }\n+\n+  /**\n+   * Returns a string containing a valid image sorting ORDER BY clause for a given index or an\n+   * array containing all of them.\n+   *\n+   * @param   mixed  $index\n+   * @return  mixed  A string containing a valid image sorting ORDER BY clause or an array\n+   *                 containing all of them.\n+   * @since   3.3\n+   */\n+  public static function getValidImageSortingOrderByClauses($index = false)\n+  {\n+    return $index !== false ? self::$_validImageSortingOrderByClauses[$index] : self::$_validImageSortingOrderByClauses;\n+  }\n }\n\\ No newline at end of file"
        },
        {
          "filename": "administrator/components/com_joomgallery/tables/joomgalleryconfig.php",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -414,6 +414,25 @@ public function check()\n       $this->jg_usercatorderlist  = implode(',', $this->jg_usercatorderlist);\n     }\n \n+    // Checking for a SQL injection in the image sorting ORDER BY clauses\n+    if(!in_array($this->jg_firstorder, JoomConfig::getValidImageSortingOrderByClauses()))\n+    {\n+      JFactory::getApplication()->enqueueMessage('SQL injection hacking attempt prevented!', 'warning');\n+      $this->jg_firstorder = JoomConfig::getValidImageSortingOrderByClauses(0);\n+    }\n+\n+    if(!empty($this->jg_secondorder) && !in_array($this->jg_secondorder, JoomConfig::getValidImageSortingOrderByClauses()))\n+    {\n+      JFactory::getApplication()->enqueueMessage('SQL injection hacking attempt prevented!', 'warning');\n+      $this->jg_secondorder = JoomConfig::getValidImageSortingOrderByClauses(2);\n+    }\n+\n+    if(!empty($this->jg_thirdorder) && !in_array($this->jg_thirdorder, JoomConfig::getValidImageSortingOrderByClauses()))\n+    {\n+      JFactory::getApplication()->enqueueMessage('SQL injection hacking attempt prevented!', 'warning');\n+      $this->jg_thirdorder = JoomConfig::getValidImageSortingOrderByClauses(4);\n+    }\n+\n     // When no array there are no ticked checkboxes submitted per $_POST\n     if(is_array($this->jg_subifdtags))\n     {"
        },
        {
          "filename": "administrator/components/com_joomgallery/views/config/tmpl/default.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -332,12 +332,12 @@\n \n JHTML::_('joomconfig.start', 'page10');\n     JHTML::_('joomconfig.intro', JText::_('COM_JOOMGALLERY_CONFIG_FS_IO_INTRO'));\n-    $picorder[] = JHTML::_('select.option','ordering ASC', JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_ORDERING_ASC'));\n-    $picorder[] = JHTML::_('select.option','ordering DESC', JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_ORDERING_DESC'));\n-    $picorder[] = JHTML::_('select.option','imgdate ASC', JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_UPLOADTIME_ASC'));\n-    $picorder[] = JHTML::_('select.option','imgdate DESC', JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_UPLOADTIME_DESC'));\n-    $picorder[] = JHTML::_('select.option','imgtitle ASC', JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_IMGTITLE_ASC'));\n-    $picorder[] = JHTML::_('select.option','imgtitle DESC', JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_IMGTITLE_DESC'));\n+    $picorder[] = JHTML::_('select.option', JoomConfig::getValidImageSortingOrderByClauses(0), JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_ORDERING_ASC'));\n+    $picorder[] = JHTML::_('select.option', JoomConfig::getValidImageSortingOrderByClauses(1), JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_ORDERING_DESC'));\n+    $picorder[] = JHTML::_('select.option', JoomConfig::getValidImageSortingOrderByClauses(2), JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_UPLOADTIME_ASC'));\n+    $picorder[] = JHTML::_('select.option', JoomConfig::getValidImageSortingOrderByClauses(3), JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_UPLOADTIME_DESC'));\n+    $picorder[] = JHTML::_('select.option', JoomConfig::getValidImageSortingOrderByClauses(4), JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_IMGTITLE_ASC'));\n+    $picorder[] = JHTML::_('select.option', JoomConfig::getValidImageSortingOrderByClauses(5), JText::_('COM_JOOMGALLERY_COMMON_OPTION_ORDERBY_IMGTITLE_DESC'));\n     $mc_jg_firstorder = JHTML::_('select.genericlist',$picorder, 'jg_firstorder', 'class=\"inputbox\" size=\"1\"', 'value', 'text', $this->_config->jg_firstorder);\n     JHTML::_('joomconfig.row', 'jg_firstorder', 'custom', 'COM_JOOMGALLERY_CONFIG_FS_IO_FIRST', $mc_jg_firstorder);\n     array_unshift($picorder, JHTML::_('select.option','', JText::_('COM_JOOMGALLERY_CONFIG_FS_IO_EMPTY')));"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 3,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b636939e06362d020b659baadb53d7f627386b43",
            "date": "2018-04-28T19:39:44Z",
            "author_login": "Chraneco"
          },
          {
            "sha": "c9580c5e1f38f2671261371211820b7a8153fd90",
            "date": "2018-04-05T15:44:36Z",
            "author_login": "Erftralle"
          },
          {
            "sha": "8cf0d6de95cffb6beed772d16f5dc21692dc0bfc",
            "date": "2018-02-27T16:49:49Z",
            "author_login": "Chraneco"
          },
          {
            "sha": "c82ed40d45982443805075871f5beabff6208cf3",
            "date": "2018-02-26T14:30:58Z",
            "author_login": "MrMusic"
          },
          {
            "sha": "9aca28137cedb06b5eb48bae13623858f863db0b",
            "date": "2018-02-26T14:25:22Z",
            "author_login": "MrMusic"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability, which was classified as critical, was found in JoomGallery up to 3.3.3. This affects an unknown part of the file administrator/components/com_joomgallery/views/config/tmpl/default.php of the component Image Sort Handler. The manipulation leads to sql injection. Upgrading to version 3.3.4 is able to address this issue. The identifier of the patch is dc414ee954e849082260f8613e15a1c1e1d354a1. It is recommended to upgrade the affected component. The identifier VDB-217569 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-06T21:15:09.167",
    "last_modified": "2024-11-21T04:03:28.840",
    "fix_date": "2018-01-21T00:29:10Z"
  },
  "references": [
    {
      "url": "https://github.com/JoomGallery/JoomGallery/commit/dc414ee954e849082260f8613e15a1c1e1d354a1",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/JoomGallery/JoomGallery/pull/122",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/JoomGallery/JoomGallery/releases/tag/v3.3.4",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217569",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217569",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/JoomGallery/JoomGallery/commit/dc414ee954e849082260f8613e15a1c1e1d354a1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/JoomGallery/JoomGallery/pull/122",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/JoomGallery/JoomGallery/releases/tag/v3.3.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217569",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217569",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.521793",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "JoomGallery",
    "owner": "JoomGallery",
    "created_at": "2014-10-26T22:15:35Z",
    "updated_at": "2023-12-17T18:49:05Z",
    "pushed_at": "2019-07-30T12:30:17Z",
    "size": 1991,
    "stars": 19,
    "forks": 29,
    "open_issues": 37,
    "watchers": 19,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 2350060,
      "JavaScript": 560222,
      "CSS": 47796,
      "HTML": 5724
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T18:15:33.170951"
  }
}