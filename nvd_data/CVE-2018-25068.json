{
  "cve_id": "CVE-2018-25068",
  "github_data": {
    "repository": "devent/globalpom-utils",
    "fix_commit": "77a820bac2f68e662ce261ecb050c643bd7ee560",
    "related_commits": [
      "77a820bac2f68e662ce261ecb050c643bd7ee560",
      "77a820bac2f68e662ce261ecb050c643bd7ee560"
    ],
    "patch_url": "https://github.com/devent/globalpom-utils/commit/77a820bac2f68e662ce261ecb050c643bd7ee560.patch",
    "fix_commit_details": {
      "sha": "77a820bac2f68e662ce261ecb050c643bd7ee560",
      "commit_date": "2018-10-10T10:02:07Z",
      "author": {
        "login": "devent",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Feature #4100 Fix critical Vulnerability",
        "length": 104,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 135,
        "additions": 57,
        "deletions": 78
      },
      "files": [
        {
          "filename": "globalpomutils-fileresources/src/main/java/com/anrisoftware/globalpom/fileresourcemanager/FileResourceManagerProvider.java",
          "status": "modified",
          "additions": 57,
          "deletions": 78,
          "patch": "@@ -1,18 +1,3 @@\n-/*\n- * Copyright 2016 Erwin M\u00fcller <erwin.mueller@deventm.org>\n- *\n- * Licensed under the Apache License, Version 2.0 (the \"License\");\n- * you may not use this file except in compliance with the License.\n- * You may obtain a copy of the License at\n- *\n- *     http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n package com.anrisoftware.globalpom.fileresourcemanager;\n \n /*-\n@@ -24,9 +9,9 @@\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n  * You may obtain a copy of the License at\n- * \n+ *\n  *      http://www.apache.org/licenses/LICENSE-2.0\n- * \n+ *\n  * Unless required by applicable law or agreed to in writing, software\n  * distributed under the License is distributed on an \"AS IS\" BASIS,\n  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n@@ -39,6 +24,7 @@\n import java.io.File;\n import java.io.IOException;\n import java.io.PrintWriter;\n+import java.nio.file.Files;\n \n import javax.inject.Inject;\n \n@@ -51,77 +37,70 @@\n /**\n  * Provides the file resource manager for ACID file operations. The store\n  * directory must be set before creating the manager.\n- * \n+ *\n  * @author Erwin Mueller, erwin.mueller@deventm.org\n  * @since 1.8\n  */\n-public class FileResourceManagerProvider implements\n-\t\tProvider<FileResourceManager> {\n+public class FileResourceManagerProvider implements Provider<FileResourceManager> {\n \n-\t@Inject\n-\tprivate FileResourceManagerProviderLogger log;\n+    @Inject\n+    private FileResourceManagerProviderLogger log;\n \n-\tprivate String storeDir;\n+    private String storeDir;\n \n-\tprivate boolean debug;\n+    private boolean debug;\n \n-\t/**\n-\t * Sets debug enabled for the file resource manager.\n-\t * \n-\t * @param debug\n-\t *            set to {@code true} to enable debug before creating the\n-\t *            manager.\n-\t */\n-\tpublic void setDebug(boolean debug) {\n-\t\tthis.debug = debug;\n-\t}\n+    /**\n+     * Sets debug enabled for the file resource manager.\n+     *\n+     * @param debug set to {@code true} to enable debug before creating the manager.\n+     */\n+    public void setDebug(boolean debug) {\n+        this.debug = debug;\n+    }\n \n-\t/**\n-\t * Sets the store directory path for the file resource manager.\n-\t * \n-\t * @param path\n-\t *            the store directory {@link File} path.\n-\t */\n-\tpublic void setStoreDir(File path) {\n-\t\tsetStoreDir(path.getAbsolutePath());\n-\t}\n+    /**\n+     * Sets the store directory path for the file resource manager.\n+     *\n+     * @param path the store directory {@link File} path.\n+     */\n+    public void setStoreDir(File path) {\n+        setStoreDir(path.getAbsolutePath());\n+    }\n \n-\t/**\n-\t * Sets the store directory path for the file resource manager.\n-\t * \n-\t * @param path\n-\t *            the store directory path.\n-\t */\n-\tpublic void setStoreDir(String path) {\n-\t\tthis.storeDir = path;\n-\t}\n+    /**\n+     * Sets the store directory path for the file resource manager.\n+     *\n+     * @param path the store directory path.\n+     */\n+    public void setStoreDir(String path) {\n+        this.storeDir = path;\n+    }\n \n-\t@Override\n-\tpublic FileResourceManager get() {\n-\t\tString workDir = createTmpDir();\n-\t\tboolean urlEncodePath = false;\n-\t\tfinal ByteArrayOutputStream stream = new ByteArrayOutputStream(1024);\n-\t\tPrintWriter printWriter = new PrintWriter(stream) {\n-\t\t\t@Override\n-\t\t\tpublic void flush() {\n-\t\t\t\tsuper.flush();\n-\t\t\t\tlog.logFileResourceMessage(stream.toString());\n-\t\t\t}\n-\t\t};\n-\t\tLoggerFacade logger = new PrintWriterLogger(printWriter, \"\", debug);\n-\t\treturn new FileResourceManager(storeDir, workDir, urlEncodePath, logger);\n-\t}\n+    @Override\n+    public FileResourceManager get() {\n+        String workDir = createTmpDir();\n+        boolean urlEncodePath = false;\n+        final ByteArrayOutputStream stream = new ByteArrayOutputStream(1024);\n+        PrintWriter printWriter = new PrintWriter(stream) {\n+            @Override\n+            public void flush() {\n+                super.flush();\n+                log.logFileResourceMessage(stream.toString());\n+            }\n+        };\n+        LoggerFacade logger = new PrintWriterLogger(printWriter, \"\", debug);\n+        return new FileResourceManager(storeDir, workDir, urlEncodePath, logger);\n+    }\n \n-\tprivate String createTmpDir() {\n-\t\ttry {\n-\t\t\tFile tmp = File.createTempFile(\"fileresourcemanager\", null);\n-\t\t\ttmp.delete();\n-\t\t\ttmp.mkdir();\n-\t\t\tString workDir = tmp.getAbsolutePath();\n-\t\t\treturn workDir;\n-\t\t} catch (IOException e) {\n-\t\t\tthrow log.errorCreateWorkDir(e);\n-\t\t}\n-\t}\n+    private String createTmpDir() {\n+        try {\n+            File tmp = Files.createTempDirectory(\"fileresourcemanager\").toFile();\n+            String workDir = tmp.getAbsolutePath();\n+            return workDir;\n+        } catch (IOException e) {\n+            throw log.errorCreateWorkDir(e);\n+        }\n+    }\n \n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a4a1219eccb82005b18c9acd3963b5649e4fa2a6",
            "date": "2024-12-23T11:17:37Z",
            "author_login": "devent"
          },
          {
            "sha": "2f2424508df5257c2810cee59dba31e57a832370",
            "date": "2024-12-22T13:58:57Z",
            "author_login": "devent"
          },
          {
            "sha": "37429a1517fd99885b3e503e17a6c6e58c08e735",
            "date": "2024-12-22T11:54:24Z",
            "author_login": "devent"
          },
          {
            "sha": "62ad0f03b19d39733d5bf9eb2c5ce128f56d3c4c",
            "date": "2024-12-22T11:51:14Z",
            "author_login": "devent"
          },
          {
            "sha": "ee5bb77d606618d9d4ed9e7603bfe92ca7ea206f",
            "date": "2024-12-22T11:44:39Z",
            "author_login": "devent"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-377",
    "description": "A vulnerability has been found in devent globalpom-utils up to 4.5.0 and classified as critical. This vulnerability affects the function createTmpDir of the file globalpomutils-fileresources/src/main/java/com/anrisoftware/globalpom/fileresourcemanager/FileResourceManagerProvider.java. The manipulation leads to insecure temporary file. The attack can be initiated remotely. Upgrading to version 4.5.1 is able to address this issue. The patch is identified as 77a820bac2f68e662ce261ecb050c643bd7ee560. It is recommended to upgrade the affected component. VDB-217570 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-06T21:15:09.243",
    "last_modified": "2024-11-21T04:03:28.983",
    "fix_date": "2018-10-10T10:02:07Z"
  },
  "references": [
    {
      "url": "https://github.com/devent/globalpom-utils/commit/77a820bac2f68e662ce261ecb050c643bd7ee560",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/devent/globalpom-utils/releases/tag/globalpomutils-4.5.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217570",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217570",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/devent/globalpom-utils/commit/77a820bac2f68e662ce261ecb050c643bd7ee560",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/devent/globalpom-utils/releases/tag/globalpomutils-4.5.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217570",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217570",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.521971",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "globalpom-utils",
    "owner": "devent",
    "created_at": "2014-03-06T15:28:18Z",
    "updated_at": "2024-12-23T11:18:00Z",
    "pushed_at": "2024-12-23T11:17:55Z",
    "size": 3286,
    "stars": 0,
    "forks": 0,
    "open_issues": 0,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Java": 1206392,
      "Groovy": 336799,
      "CSS": 26136,
      "Makefile": 5010,
      "Shell": 502
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:28:39.649758"
  }
}