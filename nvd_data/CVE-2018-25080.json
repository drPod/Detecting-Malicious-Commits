{
  "cve_id": "CVE-2018-25080",
  "github_data": {
    "repository": "serbanghita/Mobile-Detect",
    "fix_commit": "31818a441b095bdc4838602dbb17b8377d1e5cce",
    "related_commits": [
      "31818a441b095bdc4838602dbb17b8377d1e5cce",
      "31818a441b095bdc4838602dbb17b8377d1e5cce"
    ],
    "patch_url": "https://github.com/serbanghita/Mobile-Detect/commit/31818a441b095bdc4838602dbb17b8377d1e5cce.patch",
    "fix_commit_details": {
      "sha": "31818a441b095bdc4838602dbb17b8377d1e5cce",
      "commit_date": "2018-05-30T19:22:09Z",
      "author": {
        "login": "timersys",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "XSS vulnerability (#741)",
        "length": 44,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "examples/session_example.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -121,7 +121,7 @@ function initLayoutType()\n \n     <!-- example page #1 -->\n     <h1>Demo page number one.</h1>\n-    <p>You can go to page <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>?page=two\">two</a>.</p>\n+    <p>You can go to page <a href=\"<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>?page=two\">two</a>.</p>\n     <p>Showing you the <b><?php echo $layoutType; ?></b> version.</p>\n     <p><b>Note:</b> When running this test using the same browser with multiple User-Agents, clear your cookies/session before each test.</p>\n \n@@ -131,7 +131,7 @@ function initLayoutType()\n \n     <!-- example page #2 -->\n     <h1>Demo page number two.</h1>\n-    <p>You can go back to page <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>\">one</a>.</p>\n+    <p>You can go back to page <a href=\"<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>\">one</a>.</p>\n     <p>Showing you the <b><?php echo $layoutType; ?></b> version.</p>\n \n <?php endif; ?>\n@@ -141,6 +141,6 @@ function initLayoutType()\n     <?php if($_layoutType == $layoutType): ?>\n         <?php echo strtoupper($_layoutType); ?>\n     <?php else: ?>\n-        <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>?layoutType=<?php echo $_layoutType; ?>\"><?php echo strtoupper($_layoutType); ?></a>\n+        <a href=\"<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>?layoutType=<?php echo $_layoutType; ?>\"><?php echo strtoupper($_layoutType); ?></a>\n     <?php endif; ?>\n <?php endforeach;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d6a49388770f4c564483b432d6be89e470d11ff1",
            "date": "2024-12-12T13:43:21Z",
            "author_login": "serbanghita"
          },
          {
            "sha": "a66726cb604ee0d959d48d789f0999962b7af194",
            "date": "2024-12-12T13:30:45Z",
            "author_login": "serbanghita"
          },
          {
            "sha": "dc325f800dd3d9b767bd3db6c128b6b9f64e81f4",
            "date": "2024-12-12T12:59:09Z",
            "author_login": "serbanghita"
          },
          {
            "sha": "2702f755ac29f0b324d6a30507401754193a7874",
            "date": "2024-12-12T12:58:54Z",
            "author_login": "serbanghita"
          },
          {
            "sha": "cfc6d4001c73360e8155b6eb285a4891c44261fb",
            "date": "2024-12-12T12:10:49Z",
            "author_login": "serbanghita"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability, which was classified as problematic, has been found in MobileDetect 2.8.31. This issue affects the function initLayoutType of the file examples/session_example.php of the component Example. The manipulation of the argument $_SERVER['PHP_SELF'] leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2.8.32 is able to address this issue. The identifier of the patch is 31818a441b095bdc4838602dbb17b8377d1e5cce. It is recommended to upgrade the affected component. The identifier VDB-220061 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-04T08:15:07.607",
    "last_modified": "2024-11-21T04:03:30.707",
    "fix_date": "2018-05-30T19:22:09Z"
  },
  "references": [
    {
      "url": "https://github.com/serbanghita/Mobile-Detect/commit/31818a441b095bdc4838602dbb17b8377d1e5cce",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/serbanghita/Mobile-Detect/pull/741",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/serbanghita/Mobile-Detect/releases/tag/2.8.32",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220061",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220061",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/serbanghita/Mobile-Detect/commit/31818a441b095bdc4838602dbb17b8377d1e5cce",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/serbanghita/Mobile-Detect/pull/741",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/serbanghita/Mobile-Detect/releases/tag/2.8.32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220061",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220061",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.985609",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Mobile-Detect",
    "owner": "serbanghita",
    "created_at": "2012-08-31T10:58:16Z",
    "updated_at": "2025-01-14T15:51:44Z",
    "pushed_at": "2024-12-15T19:14:53Z",
    "size": 4461,
    "stars": 10580,
    "forks": 2669,
    "open_issues": 17,
    "watchers": 10580,
    "has_security_policy": false,
    "default_branch": "4.8.x",
    "protected_branches": [
      "devel-3-workinprogress",
      "devel-3"
    ],
    "languages": {
      "PHP": 149802,
      "Shell": 519
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:12:32.292207"
  }
}