{
  "cve_id": "CVE-2018-25083",
  "github_data": {
    "repository": "jkup/pullit",
    "fix_commit": "4fec455774ee08f4dce0ef2ef934ffcc37219bfb",
    "related_commits": [
      "4fec455774ee08f4dce0ef2ef934ffcc37219bfb",
      "4fec455774ee08f4dce0ef2ef934ffcc37219bfb"
    ],
    "patch_url": "https://github.com/jkup/pullit/commit/4fec455774ee08f4dce0ef2ef934ffcc37219bfb.patch",
    "fix_commit_details": {
      "sha": "4fec455774ee08f4dce0ef2ef934ffcc37219bfb",
      "commit_date": "2018-02-19T02:44:07Z",
      "author": {
        "login": "jkup",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix security vuln",
        "length": 17,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 101,
        "additions": 46,
        "deletions": 55
      },
      "files": [
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 6,
          "deletions": 18,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"pullit\",\n-  \"version\": \"1.3.0\",\n+  \"version\": \"1.4.0\",\n   \"description\": \"Display and pull branches from GitHub pull requests\",\n   \"main\": \"src/index.js\",\n   \"preferGlobal\": true,\n@@ -12,13 +12,7 @@\n     \"type\": \"git\",\n     \"url\": \"git+https://github.com/jkup/pullit.git\"\n   },\n-  \"keywords\": [\n-    \"github\",\n-    \"pull\",\n-    \"request\",\n-    \"pr\",\n-    \"cli\"\n-  ],\n+  \"keywords\": [\"github\", \"pull\", \"request\", \"pr\", \"cli\"],\n   \"author\": \"Jon Kuperman\",\n   \"license\": \"MIT\",\n   \"bin\": {\n@@ -38,15 +32,9 @@\n     \"terminal-menu\": \"^2.1.1\"\n   },\n   \"jest\": {\n-    \"collectCoverageFrom\": [\n-      \"src/**/*.js\"\n-    ],\n+    \"collectCoverageFrom\": [\"src/**/*.js\"],\n     \"testEnvironment\": \"node\",\n-    \"modulePathIgnorePatterns\": [\n-      \"__tests__/fixtures/\"\n-    ],\n-    \"testPathIgnorePatterns\": [\n-      \"__tests__/fixtures/\"\n-    ]\n+    \"modulePathIgnorePatterns\": [\"__tests__/fixtures/\"],\n+    \"testPathIgnorePatterns\": [\"__tests__/fixtures/\"]\n   }\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "src/index.js",
          "status": "modified",
          "additions": 40,
          "deletions": 37,
          "patch": "@@ -1,9 +1,7 @@\n-const GitHubApi = require('github');\n-const Menu = require('terminal-menu');\n-const {\n-  execSync\n-} = require('child_process');\n-const parse = require('parse-github-repo-url');\n+const GitHubApi = require(\"github\");\n+const Menu = require(\"terminal-menu\");\n+const { execFileSync } = require(\"child_process\");\n+const parse = require(\"parse-github-repo-url\");\n \n class Pullit {\n   constructor() {\n@@ -12,8 +10,8 @@ class Pullit {\n   }\n \n   init() {\n-    const url = execSync(`git config --get remote.origin.url`, {\n-      encoding: 'utf8'\n+    const url = execFileSync(\"git\", [\"config\", \"--get\", \"remote.origin.url\"], {\n+      encoding: \"utf8\"\n     }).trim();\n \n     return this.parsedGithubUrl(url);\n@@ -34,12 +32,11 @@ class Pullit {\n       })\n       .then(res => {\n         const branch = res.data.head.ref;\n-        execSync(\n-          `git fetch origin pull/${id}/head:${branch} && git checkout ${branch}`\n-        );\n+        execFileSync(\"git\", [\"fetch\", \"origin\", `pull/${id}/head:${branch}`]);\n+        execFileSync(\"git\", [\"checkout\", branch]);\n       })\n       .catch(err => {\n-        console.log('Error: Could not find the specified pull request.');\n+        console.log(\"Error: Could not find the specified pull request.\");\n       });\n   }\n \n@@ -51,36 +48,42 @@ class Pullit {\n   }\n \n   display() {\n-    this.fetchRequests().then(results => {\n-      const menu = Menu({\n-       width: process.stdout.columns - 4,\n-        x: 0,\n-        y: 2\n-      });\n-      menu.reset();\n-      menu.write('Currently open pull requests:\\n');\n-      menu.write('-------------------------\\n');\n+    this.fetchRequests()\n+      .then(results => {\n+        const menu = Menu({\n+          width: process.stdout.columns - 4,\n+          x: 0,\n+          y: 2\n+        });\n+        menu.reset();\n+        menu.write(\"Currently open pull requests:\\n\");\n+        menu.write(\"-------------------------\\n\");\n \n-      results.data.forEach(element => {\n-        menu.add(`${element.number} - ${element.title} - ${element.head.user.login}`);\n-      });\n+        results.data.forEach(element => {\n+          menu.add(\n+            `${element.number} - ${element.title} - ${element.head.user.login}`\n+          );\n+        });\n \n-      menu.add(`Exit`);\n+        menu.add(`Exit`);\n \n-      menu.on('select', label => {\n-        menu.close();\n-        this.fetch(label.split(' ')[0]);\n-      });\n-      process.stdin.pipe(menu.createStream()).pipe(process.stdout);\n+        menu.on(\"select\", label => {\n+          menu.close();\n+          this.fetch(label.split(\" \")[0]);\n+        });\n+        process.stdin.pipe(menu.createStream()).pipe(process.stdout);\n \n-      process.stdin.setRawMode(true);\n-      menu.on('close', () => {\n-        process.stdin.setRawMode(false);\n-        process.stdin.end();\n+        process.stdin.setRawMode(true);\n+        menu.on(\"close\", () => {\n+          process.stdin.setRawMode(false);\n+          process.stdin.end();\n+        });\n+      })\n+      .catch(err => {\n+        console.log(\n+          \"Error: could not display pull requests. Please make sure this is a valid repository.\"\n+        );\n       });\n-    }).catch(err => {\n-      console.log('Error: could not display pull requests. Please make sure this is a valid repository.')\n-    });\n   }\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "76db0d9149d4b1f9419808556d8fbc5794cf1b93",
            "date": "2022-02-17T02:24:46Z",
            "author_login": "jkup"
          },
          {
            "sha": "76ae3ce018a29ff02fd52c4b5c78663407f82bae",
            "date": "2022-02-17T02:24:31Z",
            "author_login": "jkup"
          },
          {
            "sha": "5d212b8a022922836d47d8199a6d472284debfca",
            "date": "2022-02-17T02:24:18Z",
            "author_login": "jkup"
          },
          {
            "sha": "812fa83ef928c040d4c6bd8e6a710be6acadc30e",
            "date": "2022-02-17T02:24:05Z",
            "author_login": "jkup"
          },
          {
            "sha": "fb954b2bd3a1b4522aebc9ab6f351f1e54f2571b",
            "date": "2022-02-15T17:47:43Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "The pullit package before 1.4.0 for Node.js allows OS Command Injection because eval is used on an attacker-supplied Git branch name.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-27T03:15:07.103",
    "last_modified": "2024-11-21T04:03:31.223",
    "fix_date": "2018-02-19T02:44:07Z"
  },
  "references": [
    {
      "url": "https://github.com/jkup/pullit/commit/4fec455774ee08f4dce0ef2ef934ffcc37219bfb",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/npm:pullit:20180214",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jkup/pullit/commit/4fec455774ee08f4dce0ef2ef934ffcc37219bfb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/npm:pullit:20180214",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.012673",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pullit",
    "owner": "jkup",
    "created_at": "2017-09-16T22:51:04Z",
    "updated_at": "2024-12-28T08:37:41Z",
    "pushed_at": "2023-03-28T06:28:15Z",
    "size": 298,
    "stars": 181,
    "forks": 7,
    "open_issues": 13,
    "watchers": 181,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 2542
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:20:06.525598"
  }
}