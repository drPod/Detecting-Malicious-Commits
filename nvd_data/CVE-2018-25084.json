{
  "cve_id": "CVE-2018-25084",
  "github_data": {
    "repository": "pingidentity/ssam",
    "fix_commit": "f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251",
    "related_commits": [
      "f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251",
      "f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251"
    ],
    "patch_url": "https://github.com/pingidentity/ssam/commit/f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251.patch",
    "fix_commit_details": {
      "sha": "f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251",
      "commit_date": "2018-01-31T20:16:25Z",
      "author": {
        "login": "tannermitchell",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added html escaping to help with XSS. Added frame busting to help with XFS. Added a method override filter so that only GETs and POSTs are accepted. Disabled autocomplete for password fields. Added ability for customer to set their HPKP headers.",
        "length": 245,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 179,
        "additions": 167,
        "deletions": 12
      },
      "files": [
        {
          "filename": "src/main/java/com/unboundid/webapp/ssam/HTTPHeaderFilter.java",
          "status": "added",
          "additions": 44,
          "deletions": 0,
          "patch": "@@ -0,0 +1,44 @@\n+/*\n+ * Copyright 2014-2017 Ping Identity Corporation\n+ * All Rights Reserved.\n+ */\n+\n+package com.unboundid.webapp.ssam;\n+\n+import org.springframework.stereotype.Component;\n+import javax.servlet.FilterConfig;\n+import javax.servlet.ServletRequest;\n+import javax.servlet.ServletResponse;\n+import javax.servlet.FilterChain;\n+import javax.servlet.http.HttpServletResponse;\n+\n+@Component\n+public class HTTPHeaderFilter implements javax.servlet.Filter {\n+    public FilterConfig filterConfig;\n+\n+    public void doFilter(final ServletRequest request,\n+                         final ServletResponse response, FilterChain chain)\n+            throws java.io.IOException, javax.servlet.ServletException {\n+\n+        HttpServletResponse res = (HttpServletResponse) response;\n+\n+        // Set this variable to the sha256 pin of your public key\n+        // This value can be generated using the \"openssl\" command line tool\n+        // https://developer.mozilla.org/en-US/docs/Web/HTTP/Public_Key_Pinning\n+        String pinSha256 = \"\";\n+\n+        if(pinSha256.length() > 0)\n+        {\n+            res.setHeader(\"Public-Key-Pins\", \"max-age=518400; \" +\n+                    \"pin-sha256=\\\"\" + pinSha256 + \"\\\"; \" +\n+                    \"includeSubDomains\");\n+        }\n+\n+        chain.doFilter(request, response);\n+    }\n+\n+    public void init(final FilterConfig filterConfig) { this.filterConfig = filterConfig; }\n+\n+    public void destroy() {}\n+\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "src/main/java/com/unboundid/webapp/ssam/HTTPRequestParameterFilter.java",
          "status": "added",
          "additions": 35,
          "deletions": 0,
          "patch": "@@ -0,0 +1,35 @@\n+/*\n+ * Copyright 2014-2017 Ping Identity Corporation\n+ * All Rights Reserved.\n+ */\n+\n+package com.unboundid.webapp.ssam;\n+\n+import org.springframework.stereotype.Component;\n+import javax.servlet.FilterConfig;\n+import javax.servlet.ServletRequest;\n+import javax.servlet.ServletResponse;\n+import javax.servlet.FilterChain;\n+import javax.servlet.http.HttpServletRequest;\n+\n+@Component\n+public class HTTPRequestParameterFilter implements javax.servlet.Filter {\n+  public FilterConfig filterConfig;\n+\n+  public void doFilter(final ServletRequest request,\n+    final ServletResponse response, FilterChain chain)\n+    throws java.io.IOException, javax.servlet.ServletException {\n+\n+    String curMethod = ((HttpServletRequest) request).getMethod();\n+    //only allow for GET and POST requests.\n+    if (curMethod.equalsIgnoreCase(\"get\") || curMethod.equalsIgnoreCase(\"post\"))\n+    {\n+      chain.doFilter(request, response);\n+    }\n+  }\n+\n+  public void init(final FilterConfig filterConfig) {\n+        this.filterConfig = filterConfig;\n+    }\n+  public void destroy() {}\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "src/main/java/com/unboundid/webapp/ssam/SSAMController.java",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -44,6 +44,7 @@\n import org.springframework.web.bind.annotation.RequestParam;\n import org.springframework.web.bind.annotation.ResponseBody;\n import org.springframework.web.client.RestTemplate;\n+import org.springframework.web.util.HtmlUtils;\n \n import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n import com.fasterxml.jackson.annotation.JsonProperty;\n@@ -971,7 +972,7 @@ private void populateUserModel(String username, Entry entry, Model model)\n     model.addAttribute(\"username\", username);\n     for(Attribute attribute : entry.getAttributes())\n     {\n-      model.addAttribute(attribute.getName(), attribute.getValue());\n+      model.addAttribute(attribute.getName(), HtmlUtils.htmlEscape(attribute.getValue()));\n     }\n     model.addAttribute(\"entry\", entry);\n   }\n@@ -989,7 +990,7 @@ private void populateRegistrationModel(Map<String, String> parameters,\n         String value = parameter.getValue().trim();\n         if(!value.isEmpty())\n         {\n-          model.addAttribute(name, value);\n+          model.addAttribute(name, HtmlUtils.htmlEscape(value));\n         }\n       }\n     }"
        },
        {
          "filename": "src/main/resources/static/css/ssam.css",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,3 +1,12 @@\n+/*\n+ * None style added to help with Frame Busting\n+ * intended for older browsers without 'X-Frame-Options' header support.\n+ * This method comes from an OWASP write up by Gustav Rydstedt.\n+ */\n+html {\n+  display: none;\n+}\n+\n .navbar-static-top {\n   margin-bottom: 19px;\n }"
        },
        {
          "filename": "src/main/resources/static/js/ssam-security-patch.js",
          "status": "added",
          "additions": 26,
          "deletions": 0,
          "patch": "@@ -0,0 +1,26 @@\n+// frame busting\n+function buster(document_in, top_in) {\n+ if (self === top_in) {\n+   document_in.documentElement.style.display = \"block\";\n+ } else {\n+   top_in.location = self.location;\n+ }\n+}\n+\n+// html escaping for potentially unsafe jQuery methods such as \".append()\"\n+var entityMap = {\n+    '&': '&amp;',\n+    '<': '&lt;',\n+    '>': '&gt;',\n+    '\"': '&quot;',\n+    \"'\": '&#x27;',\n+    '/': '&#x2F;',\n+    '`': '&#x60;',\n+    '=': '&#x3D;'\n+};\n+\n+function escapeHtml (string) {\n+    return String(string).replace(/[&<>\"'`=\\/]/g, function (s) {\n+      return entityMap[s];\n+    });\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "src/main/resources/templates/deletion-success.vm",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -25,7 +25,11 @@\n         </div>\n       </div>\n     </div>\n-    \n+\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>"
        },
        {
          "filename": "src/main/resources/templates/error.vm",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -13,5 +13,9 @@\n     <div class=\"container\">\n       Something went wrong: $!status $error\n     </div>\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n   </body>\n </html>\n\\ No newline at end of file"
        },
        {
          "filename": "src/main/resources/templates/login.vm",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@\n         <label for=\"inputUsername\" class=\"sr-only\">Email/Username</label>\n         <input type=\"text\" id=\"inputUsername\" name=\"username\" class=\"form-control\" placeholder=\"Email/Username\" required autofocus>\n         <label for=\"inputPassword\" class=\"sr-only\">Password</label>\n-        <input type=\"password\" id=\"inputPassword\" name=\"password\" class=\"form-control\" placeholder=\"Password\" required>\n+        <input type=\"password\" id=\"inputPassword\" name=\"password\" class=\"form-control\" placeholder=\"Password\" autocomplete=\"off\" required>\n         <button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">Sign in</button>\n         <div style=\"margin-top: 5px;\">\n           <a href=\"recoverPassword\">Forgot password?</a>\n@@ -31,6 +31,10 @@\n         </div>\n       </form>\n     </div>\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n   </body>"
        },
        {
          "filename": "src/main/resources/templates/recover-password-success.vm",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -25,7 +25,11 @@\n         </div>\n       </div>\n     </div>\n-    \n+\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script type=\"text/javascript\">\n       $(document).ready(function() {"
        },
        {
          "filename": "src/main/resources/templates/recover-password-verify.vm",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -90,6 +90,10 @@\n       </div>\n     </div>\n \n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>"
        },
        {
          "filename": "src/main/resources/templates/recover-password.vm",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -51,6 +51,10 @@\n       </div>\n     </div>\n \n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>"
        },
        {
          "filename": "src/main/resources/templates/register.vm",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -93,6 +93,10 @@\n       </div>\n     </div>\n \n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>"
        },
        {
          "filename": "src/main/resources/templates/registration-success.vm",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -25,7 +25,11 @@\n         </div>\n       </div>\n     </div>\n-    \n+\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>"
        },
        {
          "filename": "src/main/resources/templates/registration-verify.vm",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -56,7 +56,11 @@\n         </div>\n       </div>\n     </div>\n-    \n+\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+    <script type=\"text/javascript\">\n+      buster(document, top);\n+    </script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>"
        },
        {
          "filename": "src/main/resources/templates/user.vm",
          "status": "modified",
          "additions": 9,
          "deletions": 5,
          "patch": "@@ -113,20 +113,20 @@\n               <div class=\"form-group\">\n                 <label class=\"col-sm-4 control-label\">Current Password </label>\n                 <div class=\"col-sm-8\">\n-                  <input id=\"currentPassword\" type=\"password\" class=\"form-control\" placeholder=\"Enter Current Password\">\n+                  <input id=\"currentPassword\" type=\"password\" class=\"form-control\" placeholder=\"Enter Current Password\" autocomplete=\"off\">\n                 </div>\n               </div>\n               <div class=\"form-group\">\n                 <label class=\"col-sm-4 control-label\">Password </label>\n                 <div class=\"col-sm-8\">\n-                  <input id=\"password\" type=\"password\" class=\"form-control\" placeholder=\"Enter New Password\">\n+                  <input id=\"password\" type=\"password\" class=\"form-control\" placeholder=\"Enter New Password\" autocomplete=\"off\">\n                     #parse(\"_password-requirements.vm\")  \n                 </div>\n               </div>\n               <div class=\"form-group\">\n                 <label class=\"col-sm-4 control-label\">Confirm&nbsp;Password </label>\n                 <div class=\"col-sm-8\">\n-                  <input id=\"confirmPassword\" type=\"password\" class=\"form-control\" placeholder=\"Re-Enter New Password\">\n+                  <input id=\"confirmPassword\" type=\"password\" class=\"form-control\" placeholder=\"Re-Enter New Password\" autocomplete=\"off\">\n                 </div>\n               </div>\n             </form>\n@@ -161,6 +161,10 @@\n       </div>\n     </div>\n   #end\n+    <script src=\"js/ssam-security-patch.js\"></script>\n+   \t<script type=\"text/javascript\">\n+   \t  buster(document, top);\n+   \t</script>\n     <script src=\"js/jquery-2.1.4.min.js\"></script>\n     <script src=\"js/bootstrap.min.js\"></script>\n     <script src=\"js/ssam.js\"></script>\n@@ -277,8 +281,8 @@\n             cn = first + \" \" + last;\n           }\n           var address = cn + '$' + $('input[name=\"street\"]').val().trim() + '$' + $('input[name=\"l\"]').val().trim() + ', ' + $('input[name=\"st\"]').val().trim() + '  ' + $('input[name=\"postalCode\"]').val().trim();\n-          userForm.append('<input type=\"hidden\" name=\"cn\" value=\"' + cn + '\">');\n-          userForm.append('<input type=\"hidden\" name=\"postalAddress\" value=\"' + address + '\">');\n+          userForm.append('<input type=\"hidden\" name=\"cn\" value=\"' + escapeHtml(cn) + '\">');\n+          userForm.append('<input type=\"hidden\" name=\"postalAddress\" value=\"' + escapeHtml(address) + '\">');\n           userForm.submit();\n         });\n       });"
        }
      ],
      "file_patterns": {
        "security_files": 4,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d74e55698db79b74f9e51f18c213c0353995856b",
            "date": "2024-03-18T13:12:04Z",
            "author_login": "richardcardona"
          },
          {
            "sha": "2f8545b68268475244c9a24d21ea0a874a523882",
            "date": "2024-03-15T16:29:51Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "5c540a27c64318a61938a5551ac611ea20c6e63d",
            "date": "2024-02-02T22:09:58Z",
            "author_login": "richardcardona"
          },
          {
            "sha": "573e98ae1cddaeb3070454bf295ebde31f580b5a",
            "date": "2024-02-02T22:09:16Z",
            "author_login": "richardcardona"
          },
          {
            "sha": "2a6e64b39b745fcbd0c29cb4679396406ed23fb0",
            "date": "2024-02-02T20:32:30Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability, which was classified as problematic, has been found in Ping Identity Self-Service Account Manager 1.1.2. Affected by this issue is some unknown functionality of the file src/main/java/com/unboundid/webapp/ssam/SSAMController.java. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 1.1.3 is able to address this issue. The patch is identified as f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251. It is recommended to upgrade the affected component. VDB-225362 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-10T18:15:07.993",
    "last_modified": "2024-11-21T04:03:31.363",
    "fix_date": "2018-01-31T20:16:25Z"
  },
  "references": [
    {
      "url": "https://github.com/pingidentity/ssam/commit/f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pingidentity/ssam/releases/tag/ssam-1.1.3",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.225362",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.225362",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pingidentity/ssam/commit/f64b10d63bb19ca2228b0c2d561a1a6e5a3bf251",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pingidentity/ssam/releases/tag/ssam-1.1.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.225362",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.225362",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.725884",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ssam",
    "owner": "pingidentity",
    "created_at": "2015-10-12T21:12:42Z",
    "updated_at": "2024-03-23T16:02:19Z",
    "pushed_at": "2024-05-15T08:01:13Z",
    "size": 1240,
    "stars": 7,
    "forks": 2,
    "open_issues": 10,
    "watchers": 7,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 172552,
      "JavaScript": 3974,
      "CSS": 2250,
      "Shell": 1815,
      "Batchfile": 1657
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T22:13:25.085630"
  }
}