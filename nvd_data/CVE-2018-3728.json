{
  "cve_id": "CVE-2018-3728",
  "github_data": {
    "repository": "hapijs/hoek",
    "fix_commit": "32ed5c9413321fbc37da5ca81a7cbab693786dee",
    "related_commits": [
      "32ed5c9413321fbc37da5ca81a7cbab693786dee",
      "32ed5c9413321fbc37da5ca81a7cbab693786dee"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "32ed5c9413321fbc37da5ca81a7cbab693786dee",
      "commit_date": "2018-02-06T17:55:01Z",
      "author": {
        "login": "nlf",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "skip assignment to __proto__",
        "length": 28,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 13,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/index.js",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -115,6 +115,10 @@ exports.merge = function (target, source, isNullOverride /* = true */, isMergeAr\n     const keys = Object.keys(source);\n     for (let i = 0; i < keys.length; ++i) {\n         const key = keys[i];\n+        if (key === '__proto__') {\n+            continue;\n+        }\n+\n         const value = source[key];\n         if (value &&\n             typeof value === 'object') {"
        },
        {
          "filename": "test/index.js",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -585,6 +585,15 @@ describe('merge()', () => {\n         Hoek.merge({ x: {} }, a);\n         expect(a.x.toString()).to.equal('abc');\n     });\n+\n+    it('skips __proto__', () => {\n+\n+        const a = '{ \"ok\": \"value\", \"__proto__\": { \"test\": \"value\" } }';\n+\n+        const b = Hoek.merge({}, JSON.parse(a));\n+        expect(b).to.equal({ ok: 'value' });\n+        expect(b.test).to.equal(undefined);\n+    });\n });\n \n describe('applyToDefaults()', () => {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "40e7940363febdb4d427d57c88eba96accdcc0e1",
            "date": "2024-11-14T15:53:24Z",
            "author_login": "Marsup"
          },
          {
            "sha": "5870f1f2bccb6dfd038702be3b60e72aa14773e3",
            "date": "2024-11-14T15:15:29Z",
            "author_login": "kanongil"
          },
          {
            "sha": "9b91eee216baef735d362d803d0f9e7460805ba0",
            "date": "2024-10-24T22:04:06Z",
            "author_login": "Marsup"
          },
          {
            "sha": "721762a70871a3b4eef3ef8bdfd9c4e812752fcb",
            "date": "2024-10-24T16:18:17Z",
            "author_login": "kanongil"
          },
          {
            "sha": "d9960cfa79bebf1744d5d192d8b0f9ebaaf57755",
            "date": "2024-10-24T09:55:35Z",
            "author_login": "Marsup"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-471",
    "description": "hoek node module before 4.2.0 and 5.0.x before 5.0.3 suffers from a Modification of Assumed-Immutable Data (MAID) vulnerability via 'merge' and 'applyToDefaults' functions, which allows a malicious user to modify the prototype of \"Object\" via __proto__, causing the addition or modification of an existing property that will exist on all objects.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-30T19:29:00.210",
    "last_modified": "2024-11-21T04:05:57.820",
    "fix_date": "2018-02-06T17:55:01Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/103108",
      "source": "support@hackerone.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1263",
      "source": "support@hackerone.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1264",
      "source": "support@hackerone.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hapijs/hoek/commit/32ed5c9413321fbc37da5ca81a7cbab693786dee",
      "source": "support@hackerone.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/310439",
      "source": "support@hackerone.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://nodesecurity.io/advisories/566",
      "source": "support@hackerone.com",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://snyk.io/vuln/npm:hoek:20180212",
      "source": "support@hackerone.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/103108",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1263",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1264",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hapijs/hoek/commit/32ed5c9413321fbc37da5ca81a7cbab693786dee",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/310439",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://nodesecurity.io/advisories/566",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://snyk.io/vuln/npm:hoek:20180212",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:21.808929",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "hoek",
    "owner": "hapijs",
    "created_at": "2012-09-16T17:07:35Z",
    "updated_at": "2024-11-14T15:53:40Z",
    "pushed_at": "2024-11-19T22:56:07Z",
    "size": 4135,
    "stars": 480,
    "forks": 172,
    "open_issues": 3,
    "watchers": 480,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 146431,
      "TypeScript": 9559
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:39:42.754761"
  }
}