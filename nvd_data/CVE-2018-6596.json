{
  "cve_id": "CVE-2018-6596",
  "github_data": {
    "repository": "anymail/django-anymail",
    "fix_commit": "c07998304b4a31df4c61deddcb03d3607a04691b",
    "related_commits": [
      "c07998304b4a31df4c61deddcb03d3607a04691b",
      "db586ede1fbb41dce21310ea28ae15a1cf1286c5",
      "c07998304b4a31df4c61deddcb03d3607a04691b",
      "db586ede1fbb41dce21310ea28ae15a1cf1286c5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c07998304b4a31df4c61deddcb03d3607a04691b",
      "commit_date": "2018-02-02T19:41:14Z",
      "author": {
        "login": "medmunds",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security: prevent timing attack on WEBHOOK_AUTHORIZATION secret",
        "length": 1017,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 12,
        "deletions": 3
      },
      "files": [
        {
          "filename": "anymail/webhooks/base.py",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -3,6 +3,7 @@\n \n import six\n from django.http import HttpResponse\n+from django.utils.crypto import constant_time_compare\n from django.utils.decorators import method_decorator\n from django.views.decorators.csrf import csrf_exempt\n from django.views.generic import View\n@@ -41,8 +42,13 @@ def __init__(self, **kwargs):\n     def validate_request(self, request):\n         \"\"\"If configured for webhook basic auth, validate request has correct auth.\"\"\"\n         if self.basic_auth:\n-            basic_auth = get_request_basic_auth(request)\n-            if basic_auth is None or basic_auth not in self.basic_auth:\n+            request_auth = get_request_basic_auth(request)\n+            # Use constant_time_compare to avoid timing attack on basic auth. (It's OK that any()\n+            # can terminate early: we're not trying to protect how many auth strings are allowed,\n+            # just the contents of each individual auth string.)\n+            auth_ok = any(constant_time_compare(request_auth, allowed_auth)\n+                          for allowed_auth in self.basic_auth)\n+            if not auth_ok:\n                 # noinspection PyUnresolvedReferences\n                 raise AnymailWebhookValidationFailure(\n                     \"Missing or invalid basic auth in Anymail %s webhook\" % self.esp_name)\n@@ -78,8 +84,11 @@ def validate_request(self, request):\n         *All* definitions of this method in the class chain (including mixins)\n         will be called. There is no need to chain to the superclass.\n         (See self.run_validators and collect_all_methods.)\n+\n+        Security note: use django.utils.crypto.constant_time_compare for string\n+        comparisons, to avoid exposing your validation to a timing attack.\n         \"\"\"\n-        # if request.POST['signature'] != expected_signature:\n+        # if not constant_time_compare(request.POST['signature'], expected_signature):\n         #     raise AnymailWebhookValidationFailure(\"...message...\")\n         # (else just do nothing)\n         pass"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0d1aa533ecd36794e8d5a9d2d924a724fedd8bdf",
            "date": "2024-12-11T22:27:21Z",
            "author_login": "medmunds"
          },
          {
            "sha": "5987e8377a7ec93687203f7a0d12fdb7ed54ef06",
            "date": "2024-12-11T19:54:54Z",
            "author_login": "medmunds"
          },
          {
            "sha": "77b9701b5eefd9bb7e471fc2e07e96b22d0493db",
            "date": "2024-12-10T21:01:18Z",
            "author_login": "medmunds"
          },
          {
            "sha": "8def0bdc067948de2c1b4e7967809035a3feadd8",
            "date": "2024-12-10T20:28:47Z",
            "author_login": "medmunds"
          },
          {
            "sha": "c7f7428b7a34b6ea3e31aa98f0d328f0468530ce",
            "date": "2024-12-10T20:01:17Z",
            "author_login": "medmunds"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-200",
    "description": "webhooks/base.py in Anymail (aka django-anymail) before 1.2.1 is prone to a timing attack vulnerability on the WEBHOOK_AUTHORIZATION secret, which allows remote attackers to post arbitrary e-mail tracking events.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-02-03T21:29:00.210",
    "last_modified": "2024-11-21T04:10:58.043",
    "fix_date": "2018-02-02T19:41:14Z"
  },
  "references": [
    {
      "url": "https://bugs.debian.org/889450",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/commit/c07998304b4a31df4c61deddcb03d3607a04691b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/commit/db586ede1fbb41dce21310ea28ae15a1cf1286c5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/releases/tag/v1.2.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/releases/tag/v1.3",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4107",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.debian.org/889450",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/commit/c07998304b4a31df4c61deddcb03d3607a04691b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/commit/db586ede1fbb41dce21310ea28ae15a1cf1286c5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/releases/tag/v1.2.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/anymail/django-anymail/releases/tag/v1.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4107",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:15.394585",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "django-anymail",
    "owner": "anymail",
    "created_at": "2016-03-10T02:55:09Z",
    "updated_at": "2025-01-25T19:51:07Z",
    "pushed_at": "2024-12-11T22:27:29Z",
    "size": 2415,
    "stars": 1718,
    "forks": 133,
    "open_issues": 8,
    "watchers": 1718,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "master",
      "v0.3.x",
      "v0.4.x",
      "v0.6.x",
      "v0.11.x",
      "v1.2.x",
      "v7.2.x"
    ],
    "languages": {
      "Python": 1475645
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T08:34:04.982452"
  }
}