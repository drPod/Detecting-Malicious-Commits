{
  "cve_id": "CVE-2018-6611",
  "github_data": {
    "repository": "OpenMPT/openmpt",
    "fix_commit": "b60b322cf9f0ffa624018f1bb9783edf0dc908c3",
    "related_commits": [
      "b60b322cf9f0ffa624018f1bb9783edf0dc908c3",
      "b60b322cf9f0ffa624018f1bb9783edf0dc908c3"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b60b322cf9f0ffa624018f1bb9783edf0dc908c3",
      "commit_date": "2018-02-03T16:14:38Z",
      "author": {
        "login": "manxorist",
        "type": "User",
        "stats": {
          "total_commits": 9091,
          "average_weekly_commits": 11.182041820418204,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 555
        }
      },
      "commit_message": {
        "title": "[Sec] STP: Possible out-of-bounds memory read with malformed STP files (caught with afl-fuzz).",
        "length": 271,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 9,
        "deletions": 4
      },
      "files": [
        {
          "filename": "soundlib/Load_stp.cpp",
          "status": "modified",
          "additions": 9,
          "deletions": 4,
          "patch": "@@ -108,7 +108,12 @@ static TEMPO ConvertTempo(uint16 ciaSpeed)\n \n static void ConvertLoopSlice(ModSample &src, ModSample &dest, SmpLength start, SmpLength len, bool loop)\n {\n-\tif(!src.HasSampleData()) return;\n+\tif(!src.HasSampleData()\n+\t\t|| start >= src.nLength\n+\t\t|| src.nLength - start < len)\n+\t{\n+\t\treturn;\n+\t}\n \n \tdest.FreeSample();\n \tdest = src;\n@@ -156,9 +161,9 @@ static void ConvertLoopSequence(ModSample &smp, STPLoopList &loopList)\n \n \t\t// If adding this loop would cause the sample length to exceed maximum,\n \t\t// then limit and bail out\n-\t\tif((newSmp.nLength + info.loopLength > MAX_SAMPLE_LENGTH) ||\n-\t\t   (info.loopLength > MAX_SAMPLE_LENGTH) ||\n-\t\t   (info.loopStart + info.loopLength > smp.nLength))\n+\t\tif(info.loopStart >= smp.nLength\n+\t\t\t|| smp.nLength - info.loopStart < info.loopLength\n+\t\t\t|| newSmp.nLength > MAX_SAMPLE_LENGTH - info.loopLength)\n \t\t{\n \t\t\tnumLoops = i;\n \t\t\tbreak;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "04e5d16590b186502c0df27fd7bc5d73a69325b3",
            "date": "2025-01-19T22:08:35Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "573f1761b323012688aeeb960f242ae7da520009",
            "date": "2025-01-19T19:31:50Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "cbd92b882e5099fb449fdd1307e6ad7754f52e3e",
            "date": "2025-01-15T17:24:06Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "016390240a8e3be6b5363c50ed17ace671f78c19",
            "date": "2025-01-15T17:23:23Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "9c80f9c36a66bd792b4f553d4937d951af500016",
            "date": "2025-01-09T20:11:38Z",
            "author_login": "sagamusix"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-125",
    "description": "soundlib/Load_stp.cpp in OpenMPT through 1.27.04.00, and libopenmpt before 0.3.6, has an out-of-bounds read via a malformed STP file.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2018-02-04T12:29:00.317",
    "last_modified": "2024-11-21T04:10:59.580",
    "fix_date": "2018-02-03T16:14:38Z"
  },
  "references": [
    {
      "url": "https://github.com/OpenMPT/openmpt/commit/b60b322cf9f0ffa624018f1bb9783edf0dc908c3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lib.openmpt.org/libopenmpt/2018/02/03/security-update-0.3.6/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/commit/b60b322cf9f0ffa624018f1bb9783edf0dc908c3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lib.openmpt.org/libopenmpt/2018/02/03/security-update-0.3.6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:15.394875",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "openmpt",
    "owner": "OpenMPT",
    "created_at": "2017-02-23T10:04:01Z",
    "updated_at": "2025-01-20T21:26:12Z",
    "pushed_at": "2025-01-19T22:22:23Z",
    "size": 194524,
    "stars": 604,
    "forks": 71,
    "open_issues": 0,
    "watchers": 604,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 9763824,
      "C": 474904,
      "Makefile": 259454,
      "Lua": 142963,
      "FreeBASIC": 127523,
      "Batchfile": 110462,
      "Inno Setup": 82266,
      "M4": 76794,
      "Shell": 67062,
      "Python": 57959,
      "HTML": 8725,
      "VBScript": 861,
      "PowerShell": 801,
      "CSS": 505
    },
    "commit_activity": {
      "total_commits_last_year": 1451,
      "avg_commits_per_week": 27.903846153846153,
      "days_active_last_year": 266
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T07:50:24.613623"
  }
}