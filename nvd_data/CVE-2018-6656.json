{
  "cve_id": "CVE-2018-6656",
  "github_data": {
    "repository": "zblogcn/zblogphp",
    "fix_commit": "c51da34a27798b5fe6d1cb5133a15da6a6384e43",
    "related_commits": [
      "c51da34a27798b5fe6d1cb5133a15da6a6384e43",
      "c51da34a27798b5fe6d1cb5133a15da6a6384e43"
    ],
    "patch_url": "https://github.com/zblogcn/zblogphp/commit/c51da34a27798b5fe6d1cb5133a15da6a6384e43.patch",
    "fix_commit_details": {
      "sha": "c51da34a27798b5fe6d1cb5133a15da6a6384e43",
      "commit_date": "2016-05-30T09:52:56Z",
      "author": {
        "login": "zsxsoft",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "\u5220\u9664AppCentre",
        "length": 11,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2112,
        "additions": 0,
        "deletions": 2112
      },
      "files": [
        {
          "filename": ".gitignore",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -27,7 +27,6 @@\n /zb_users/plugin/*\r\n !/zb_users/plugin/api\r\n !/zb_users/plugin/AdminColor\r\n-!/zb_users/plugin/AppCentre\r\n !/zb_users/plugin/AuditRecords\r\n !/zb_users/plugin/AutoPublisher\r\n !/zb_users/plugin/CloudStorage\r"
        },
        {
          "filename": "zb_users/plugin/AppCentre/app_del.php",
          "status": "removed",
          "additions": 0,
          "deletions": 38,
          "patch": "@@ -1,38 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-function rrmdir($dir) {\r\n-\tif (is_dir($dir)) {\r\n-\t\t$objects = scandir($dir);\r\n-\t\tforeach ($objects as $object) {\r\n-\t\t\tif ($object != '.' && $object != '..') {\r\n-\t\t\t\tif (filetype($dir . '/' . $object) == 'dir') {\r\n-\t\t\t\t\trrmdir($dir . '/' . $object);\r\n-\t\t\t\t} else {\r\n-\t\t\t\t\tunlink($dir . '/' . $object);\r\n-\t\t\t\t}\r\n-\r\n-\t\t\t}\r\n-\t\t}\r\n-\t\treset($objects);\r\n-\t\trmdir($dir);\r\n-\t}\r\n-}\r\n-\r\n-rrmdir($zbp->usersdir . $_GET['type'] . '/' . $_GET['id']);\r\n-if ($_GET['type'] == \"theme\") {\r\n-\trrmdir($zbp->usersdir . '/cache/template/' . $_GET['id']);\r\n-}\r\n-\r\n-Redirect($_SERVER[\"HTTP_REFERER\"]);\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/app_pack.php",
          "status": "removed",
          "additions": 0,
          "deletions": 37,
          "patch": "@@ -1,37 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$type = $_GET['type'];\r\n-\r\n-$id = $_GET['id'];\r\n-\r\n-$app = new App;\r\n-\r\n-if (!$app->LoadInfoByXml($type, $id)) {\r\n-\texit;\r\n-}\r\n-\r\n-ob_clean();\r\n-\r\n-if (\r\n-\tfunction_exists('gzencode') &&\r\n-\t$zbp->Config('AppCentre')->enablegzipapp &&\r\n-\t$app->adapted > 140614// 1.3\u548c\u4e4b\u524d\u7248\u672c\u4e0d\u6253\u5305\u4e3agzba\r\n-) {\r\n-\theader('Content-Disposition:attachment;filename=' . $id . '.gzba');\r\n-\techo AppCentre_Pack($app, true);\r\n-} else {\r\n-\theader('Content-Disposition:attachment;filename=' . $id . '.zba');\r\n-\techo AppCentre_Pack($app, false);\r\n-}\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/app_upload.php",
          "status": "removed",
          "additions": 0,
          "deletions": 36,
          "patch": "@@ -1,36 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-if (!$zbp->ValidToken(GetVars('token', 'GET'))) {$zbp->ShowError(5, __FILE__, __LINE__);die();}\r\n-foreach ($_FILES as $key => $value) {\r\n-\tif ($_FILES[$key]['error'] == 0) {\r\n-\t\tif (is_uploaded_file($_FILES[$key]['tmp_name'])) {\r\n-\t\t\t$tmp_name = $_FILES[$key]['tmp_name'];\r\n-\t\t\t$name = $_FILES[$key]['name'];\r\n-\r\n-\t\t\t$xml = file_get_contents($tmp_name);\r\n-\t\t\tif (App::UnPack($xml)) {\r\n-\t\t\t\t$zbp->SetHint('good', '\u4e0a\u4f20APP\u5e76\u89e3\u538b\u6210\u529f!');\r\n-\t\t\t\tRedirect($_SERVER[\"HTTP_REFERER\"]);\r\n-\t\t\t} else {\r\n-\t\t\t\t$zbp->SetHint('bad', $zbp->lang['error']['64']);\r\n-\t\t\t\tRedirect($_SERVER[\"HTTP_REFERER\"]);\r\n-\t\t\t}\r\n-\t\t\t;\r\n-\t\t}\r\n-\t} else {\r\n-\t\t$zbp->SetHint('bad', $zbp->lang['error']['88']);\r\n-\t}\r\n-\r\n-}\r\n-\r\n-Redirect($_SERVER[\"HTTP_REFERER\"]);\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/client.php",
          "status": "removed",
          "additions": 0,
          "deletions": 92,
          "patch": "@@ -1,92 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-require dirname(__FILE__) . '/function.php';\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-if (!$zbp->Config('AppCentre')->username || !$zbp->Config('AppCentre')->password) {\r\n-\t$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u767b\u5f55\u5e94\u7528\u5546\u57ce';\r\n-} else {\r\n-\t$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u6211\u7684\u5e94\u7528\u4ed3\u5e93';\r\n-}\r\n-\r\n-if (GetVars('act') == 'login') {\r\n-\r\n-\t$s = Server_Open('vaild');\r\n-\tif ($s) {\r\n-\r\n-\t\t$zbp->Config('AppCentre')->username = GetVars(\"app_username\");\r\n-\t\t$zbp->Config('AppCentre')->password = $s;\r\n-\t\t$zbp->SaveConfig('AppCentre');\r\n-\r\n-\t\t$zbp->SetHint('good', '\u60a8\u5df2\u6210\u529f\u767b\u5f55APP\u5e94\u7528\u4e2d\u5fc3.');\r\n-\t\tRedirect('./main.php');\r\n-\t\tdie;\r\n-\t} else {\r\n-\t\t$zbp->SetHint('bad', '\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef.');\r\n-\t\tRedirect('./client.php');\r\n-\t\tdie;\r\n-\t}\r\n-}\r\n-\r\n-if (GetVars('act') == 'logout') {\r\n-\t$zbp->Config('AppCentre')->username = '';\r\n-\t$zbp->Config('AppCentre')->password = '';\r\n-\t$zbp->SaveConfig('AppCentre');\r\n-\t$zbp->SetHint('good', '\u60a8\u5df2\u9000\u51faAPP\u5e94\u7528\u4e2d\u5fc3.');\r\n-\tRedirect('./client.php');\r\n-\tdie;\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus(9);?></div>\r\n-  <div id=\"divMain2\">\r\n-<?php if (!$zbp->Config('AppCentre')->username) {?>\r\n-            <div class=\"divHeader2\">\u5e94\u7528\u4e2d\u5fc3\u8d26\u6237\u767b\u5f55</div>\r\n-            <form action=\"?act=login\" method=\"post\">\r\n-              <table style=\"line-height:3em;\" width=\"100%\" border=\"0\">\r\n-                <tr height=\"32\">\r\n-                  <th  align=\"center\">\u8d26\u6237\u767b\u5f55\r\n-                    </td>\r\n-                </tr>\r\n-                <tr height=\"32\">\r\n-                  <td  align=\"center\">\u7528\u6237\u540d:\r\n-                    <input type=\"text\" name=\"app_username\" value=\"\" style=\"width:40%\"/></td>\r\n-                </tr>\r\n-                <tr height=\"32\">\r\n-                  <td  align=\"center\">\u5bc6&nbsp;&nbsp;&nbsp;&nbsp;\u7801:\r\n-                    <input type=\"password\" name=\"app_password\" value=\"\" style=\"width:40%\" /></td>\r\n-                </tr>\r\n-                <tr height=\"32\" align=\"center\">\r\n-                  <td align=\"center\"><input type=\"submit\" value=\"\u767b\u9646\" class=\"button\" /></td>\r\n-                </tr>\r\n-              </table>\r\n-            </form>\r\n-<?php } else {\r\n-\r\n-//\u5df2\u767b\u5f55\r\n-\tServer_Open('shoplist');\r\n-\r\n-}\r\n-?>\r\n-\r\n-\r\n-\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/function.php",
          "status": "removed",
          "additions": 0,
          "deletions": 470,
          "patch": "@@ -1,470 +0,0 @@\n-<?php\r\n-\r\n-function AppCentre_SubMenus($id) {\r\n-\t//m-now\r\n-\tglobal $zbp;\r\n-\r\n-\techo '<a href=\"main.php\"><span class=\"m-left ' . ($id == 1 ? 'm-now' : '') . '\">\u6d4f\u89c8\u5728\u7ebf\u5e94\u7528</span></a>';\r\n-\techo '<a href=\"main.php?method=check\"><span class=\"m-left ' . ($id == 2 ? 'm-now' : '') . '\">\u68c0\u67e5\u5e94\u7528\u66f4\u65b0</span></a>';\r\n-\techo '<a href=\"update.php\"><span class=\"m-left ' . ($id == 3 ? 'm-now' : '') . '\">\u7cfb\u7edf\u66f4\u65b0\u4e0e\u6821\u9a8c</span></a>';\r\n-\r\n-\tif ($zbp->Config('AppCentre')->username && $zbp->Config('AppCentre')->password) {\r\n-\t\techo '<a href=\"client.php\"><span class=\"m-left ' . ($id == 9 ? 'm-now' : '') . '\">\u6211\u7684\u5e94\u7528\u4ed3\u5e93</span></a>';\r\n-\t} else {\r\n-\t\techo '<a href=\"client.php\"><span class=\"m-left ' . ($id == 9 ? 'm-now' : '') . '\">\u767b\u5f55\u5e94\u7528\u5546\u57ce</span></a>';\r\n-\t}\r\n-\r\n-\techo '<a href=\"setting.php\"><span class=\"m-right ' . ($id == 4 ? 'm-now' : '') . '\">\u8bbe\u7f6e</span></a>';\r\n-\techo '<a href=\"plugin_edit.php\"><span class=\"m-right ' . ($id == 5 ? 'm-now' : '') . '\">\u65b0\u5efa\u63d2\u4ef6</span></a>';\r\n-\techo '<a href=\"theme_edit.php\"><span class=\"m-right ' . ($id == 6 ? 'm-now' : '') . '\">\u65b0\u5efa\u4e3b\u9898</span></a>';\r\n-}\r\n-\r\n-function AppCentre_GetCheckQueryString() {\r\n-\tglobal $zbp;\r\n-\t$check = '';\r\n-\t$app = new app;\r\n-\tif ($app->LoadInfoByXml('theme', $zbp->theme) == true) {\r\n-\t\t$check .= $app->id . ':' . $app->modified . ';';\r\n-\t}\r\n-\tforeach (explode('|', $zbp->option['ZC_USING_PLUGIN_LIST']) as $id) {\r\n-\t\t$app = new app;\r\n-\t\tif ($app->LoadInfoByXml('plugin', $id) == true) {\r\n-\t\t\t$check .= $app->id . ':' . $app->modified . ';';\r\n-\t\t}\r\n-\t}\r\n-\treturn $check;\r\n-}\r\n-\r\n-function Server_Open($method) {\r\n-\tglobal $zbp, $blogversion;\r\n-\r\n-\tswitch ($method) {\r\n-\tcase 'down':\r\n-\t\tAdd_Filter_Plugin('Filter_Plugin_Zbp_ShowError', 'ScriptError', PLUGIN_EXITSIGNAL_RETURN);\r\n-\t\theader('Content-type: application/x-javascript; Charset=utf-8');\r\n-\t\tob_clean();\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?down=' . GetVars('id', 'GET'));\r\n-\t\tif (App::UnPack($s)) {\r\n-\t\t\t$zbp->SetHint('good', '\u4e0b\u8f7dAPP\u5e76\u89e3\u538b\u5b89\u88c5\u6210\u529f!');\r\n-\t\t}\r\n-\t\t;\r\n-\t\tdie();\r\n-\t\tbreak;\r\n-\tcase 'search':\r\n-\t\tif (trim(GetVars('q', 'GET')) == '') {\r\n-\t\t\tcontinue;\r\n-\t\t}\r\n-\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?search=' . urlencode(GetVars('q', 'GET')));\r\n-\t\techo str_replace('%bloghost%', $zbp->host . 'zb_users/plugin/AppCentre/main.php', $s);\r\n-\t\tbreak;\r\n-\tcase 'view':\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?' . GetVars('QUERY_STRING', 'SERVER'));\r\n-\t\tif (strpos($s, '<!--developer-nologin-->') !== false) {\r\n-\t\t\tif ($zbp->Config('AppCentre')->username || $zbp->Config('AppCentre')->password) {\r\n-\t\t\t\t$zbp->Config('AppCentre')->username = '';\r\n-\t\t\t\t$zbp->Config('AppCentre')->password = '';\r\n-\t\t\t\t$zbp->SaveConfig('AppCentre');\r\n-\t\t\t}\r\n-\t\t}\r\n-\t\tif (strpos($s, '<!--shop-nologin-->') !== false) {\r\n-\t\t\tif ($zbp->Config('AppCentre')->shop_username || $zbp->Config('AppCentre')->shop_password) {\r\n-\t\t\t\t$zbp->Config('AppCentre')->shop_username = '';\r\n-\t\t\t\t$zbp->Config('AppCentre')->shop_password = '';\r\n-\t\t\t\t$zbp->SaveConfig('AppCentre');\r\n-\t\t\t}\r\n-\t\t}\r\n-\t\tif (strpos($s, 'app.zblogcn.com') === false) {\r\n-\t\t\t$zbp->ShowHint('bad', '\u540e\u53f0\u8bbf\u95ee\u5e94\u7528\u4e2d\u5fc3\u6545\u969c\uff0c\u4e0d\u80fd\u767b\u5f55\u548c\u4e0b\u8f7d\u5e94\u7528\uff0c\u8bf7\u68c0\u67e5\u4e3b\u673a\u7a7a\u95f4\u662f\u5426\u80fd\u8fdc\u7a0b\u8bbf\u95eeapp.zblogcn.com\u3002');\r\n-\t\t}\r\n-\r\n-\t\techo str_replace('%bloghost%', $zbp->host . 'zb_users/plugin/AppCentre/main.php', $s);\r\n-\t\tbreak;\r\n-\tcase 'check':\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?check=' . urlencode(AppCentre_GetCheckQueryString())) . '';\r\n-\t\techo str_replace('%bloghost%', $zbp->host . 'zb_users/plugin/AppCentre/main.php', $s);\r\n-\t\tbreak;\r\n-\tcase 'checksilent':\r\n-\t\theader('Content-type: application/x-javascript; Charset=utf-8');\r\n-\t\tob_clean();\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?blogsilent=1' . ($zbp->Config('AppCentre')->checkbeta ? '&betablog=1' : '') . '&check=' . urlencode(AppCentre_GetCheckQueryString())) . '';\r\n-\t\tif (strpos($s, ';') !== false) {\r\n-\t\t\t$newversion = substr($s, 0, 6);\r\n-\t\t\t$s = str_replace(($newversion . ';'), '', $s);\r\n-\t\t\tif ((int) $newversion > (int) $blogversion) {\r\n-\t\t\t\techo '$(\".main\").prepend(\"<div class=\\'hint\\'><p class=\\'hint hint_tips\\'>\u63d0\u793a:Z-BlogPHP\u6709\u65b0\u7248\u672c,\u8bf7\u7528APP\u5e94\u7528\u4e2d\u5fc3\u63d2\u4ef6\u7684<a href=\\'../../zb_users/plugin/AppCentre/update.php\\'>\u201c\u7cfb\u7edf\u66f4\u65b0\u4e0e\u6821\u9a8c\u201d</a>\u5347\u7ea7' . $newversion . '\u7248(' . ($zbp->Config('AppCentre')->checkbeta ? 'Beta' : '') . ').</p></div>\");';\r\n-\t\t\t}\r\n-\t\t}\r\n-\t\tif ($s != 0) {\r\n-\t\t\techo '$(\".main\").prepend(\"<div class=\\'hint\\'><p class=\\'hint hint_tips\\'>\u63d0\u793a:\u6709' . $s . '\u4e2a\u5e94\u7528\u9700\u8981\u66f4\u65b0,\u8bf7\u5728\u5e94\u7528\u4e2d\u5fc3\u7684<a href=\\'../../zb_users/plugin/AppCentre/main.php?method=check\\'>\u201c\u68c0\u67e5\u5e94\u7528\u66f4\u65b0\u201d</a>\u9875\u5347\u7ea7.</p></div>\");';\r\n-\t\t}\r\n-\t\tdie();\r\n-\t\tbreak;\r\n-\tcase 'vaild':\r\n-\t\t$data = array();\r\n-\t\t$data[\"username\"] = GetVars(\"app_username\");\r\n-\t\t$data[\"password\"] = md5(GetVars(\"app_password\"));\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?vaild', $data);\r\n-\t\treturn $s;\r\n-\t\tbreak;\r\n-\tcase 'submitpre':\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?submitpre=' . urlencode(GetVars('id')));\r\n-\t\treturn $s;\r\n-\tcase 'submit':\r\n-\t\t$app = New App;\r\n-\t\t$app->LoadInfoByXml($_GET['type'], $_GET['id']);\r\n-\t\t$data[\"zba\"] = $app->Pack();\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?submit=' . urlencode(GetVars('id')), $data);\r\n-\t\treturn $s;\r\n-\tcase 'shopvaild':\r\n-\t\t$data = array();\r\n-\t\t$data[\"shop_username\"] = GetVars(\"shop_username\");\r\n-\t\t$data[\"shop_password\"] = md5(GetVars(\"shop_password\"));\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?shopvaild', $data);\r\n-\t\treturn $s;\r\n-\t\tbreak;\r\n-\tcase 'shoplist':\r\n-\t\t$s = Server_SendRequest(APPCENTRE_URL . '?shoplist');\r\n-\t\techo str_replace('%bloghost%', $zbp->host . 'zb_users/plugin/AppCentre/main.php', $s);\r\n-\t\tbreak;\r\n-\tcase 'apptype':\r\n-\t\t$zbp->Config('AppCentre')->apptype = GetVars(\"type\");\r\n-\t\t$zbp->SaveConfig('AppCentre');\r\n-\t\tRedirect('main.php');\r\n-\t\tbreak;\r\n-\tdefault:\r\n-\t\t# code...\r\n-\t\tbreak;\r\n-\t}\r\n-\r\n-}\r\n-\r\n-function Server_SendRequest($url, $data = array(), $u = '', $c = '') {\r\n-\tglobal $zbp;\r\n-\r\n-\t$un = $zbp->Config('AppCentre')->username;\r\n-\t$ps = $zbp->Config('AppCentre')->password;\r\n-\t$c .= ' apptype=' . urlencode($zbp->Config('AppCentre')->apptype) . '; ';\r\n-\t$c .= ' app_guestver=' . urlencode('2.0') . '; ';\r\n-\t$c .= ' app_host=' . urlencode($zbp->host) . '; ';\r\n-\t$c .= ' app_email=' . urlencode($zbp->user->Email) . '; ';\r\n-\t$c .= ' app_user=' . urlencode($zbp->user->Name) . '; ';\r\n-\tif ($un && $ps) {\r\n-\t\t$c .= \"username=\" . urlencode($un) . \"; password=\" . urlencode($ps);\r\n-\t}\r\n-\r\n-\t$shopun = $zbp->Config('AppCentre')->shop_username;\r\n-\t$shopps = $zbp->Config('AppCentre')->shop_password;\r\n-\r\n-\tif ($shopun && $shopps) {\r\n-\t\tif ($c !== '') {\r\n-\t\t\t$c .= '; ';\r\n-\t\t}\r\n-\r\n-\t\t$c .= \"shop_username=\" . urlencode($shopun) . \"; shop_password=\" . urlencode($shopps);\r\n-\t}\r\n-\r\n-\t$u = 'ZBlogPHP/' . substr(ZC_BLOG_VERSION, -6, 6) . ' ' . GetGuestAgent();\r\n-\r\n-\tif (!class_exists('NetworkFactory', false)) {\r\n-\t\tif (class_exists('Network')) {\r\n-\t\t\treturn Server_SendRequest_Network($url, $data, $u, $c);\r\n-\t\t}\r\n-\t}\r\n-\r\n-\tif (function_exists(\"curl_init\") && function_exists('curl_exec')) {\r\n-\t\treturn Server_SendRequest_CUrl($url, $data, $u, $c);\r\n-\t}\r\n-\r\n-\tif (!ini_get(\"allow_url_fopen\")) {\r\n-\t\treturn \"\";\r\n-\t}\r\n-\r\n-\tif ($data) {\r\n-//POST\r\n-\t\t$data = http_build_query($data);\r\n-\t\t$opts = array(\r\n-\t\t\t'http' => array(\r\n-\t\t\t\t'method' => 'POST',\r\n-\t\t\t\t'header' => \"Content-Type:application/x-www-form-urlencoded\\r\\n\" .\r\n-\t\t\t\t'Content-Length: ' . strlen($data) . \"\\r\\n\" .\r\n-\t\t\t\t\"Cookie: \" . $c . \"\\r\\n\",\r\n-\t\t\t\t'user_agent' => $u,\r\n-\t\t\t\t'content' => $data,\r\n-\t\t\t),\r\n-\t\t);\r\n-\t\t$content = stream_context_create($opts);\r\n-\t} else {\r\n-//GET\r\n-\t\t$opts = array(\r\n-\t\t\t'http' => array(\r\n-\t\t\t\t'method' => 'GET',\r\n-\t\t\t\t'header' => \"Cookie: \" . $c . \"\\r\\n\",\r\n-\t\t\t\t'user_agent' => $u,\r\n-\t\t\t),\r\n-\t\t);\r\n-\t\t$content = stream_context_create($opts);\r\n-\t}\r\n-\r\n-\tif (function_exists('ini_set')) {\r\n-\t\tini_set('default_socket_timeout', 120);\r\n-\t}\r\n-\r\n-\tif (extension_loaded('zlib')) {\r\n-\t\treturn file_get_contents('compress.zlib://' . $url, false, $content);\r\n-\t} else {\r\n-\t\treturn file_get_contents($url, false, $content);\r\n-\t}\r\n-}\r\n-\r\n-function Server_SendRequest_CUrl($url, $data = array(), $u, $c) {\r\n-\tglobal $zbp;\r\n-\r\n-\t$ch = curl_init($url);\r\n-\tif (extension_loaded('zlib')) {\r\n-\t\tcurl_setopt($ch, CURLOPT_ENCODING, 'gzip');\r\n-\t}\r\n-\tcurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n-\tcurl_setopt($ch, CURLOPT_TIMEOUT, 120);\r\n-\tcurl_setopt($ch, CURLOPT_USERAGENT, $u);\r\n-\tcurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);\r\n-\tcurl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);\r\n-\tif (ini_get(\"safe_mode\") == false && ini_get(\"open_basedir\") == false) {\r\n-\t\tcurl_setopt($ch, CURLOPT_MAXREDIRS, 10);\r\n-\t\tcurl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\r\n-\t}\r\n-\tif ($c) {\r\n-\t\tcurl_setopt($ch, CURLOPT_COOKIE, $c);\r\n-\t}\r\n-\r\n-\tif ($data) {\r\n-//POST\r\n-\t\tcurl_setopt($ch, CURLOPT_POST, 1);\r\n-\t\tcurl_setopt($ch, CURLOPT_POSTFIELDS, $data);\r\n-\t} else { //GET\r\n-\t}\r\n-\r\n-\t$r = curl_exec($ch);\r\n-\tcurl_close($ch);\r\n-\r\n-\treturn $r;\r\n-}\r\n-\r\n-function Server_SendRequest_Network($url, $data = array(), $u, $c) {\r\n-\tglobal $zbp;\r\n-\r\n-\t$ajax = Network::Create();\r\n-\tif (!$ajax) {\r\n-\t\tthrow new Exception('\u4e3b\u673a\u6ca1\u6709\u5f00\u542f\u8bbf\u95ee\u5916\u90e8\u7f51\u7edc\u529f\u80fd');\r\n-\t}\r\n-\r\n-\tif ($data) {\r\n-//POST\r\n-\t\t$ajax->open('POST', $url);\r\n-\t\t$ajax->enableGzip();\r\n-\t\t$ajax->setTimeOuts(120, 120, 0, 0);\r\n-\t\t$ajax->setRequestHeader('User-Agent', $u);\r\n-\t\t$ajax->setRequestHeader('Cookie', $c);\r\n-\t\t$ajax->send($data);\r\n-\t} else {\r\n-\t\t$ajax->open('GET', $url);\r\n-\t\t$ajax->enableGzip();\r\n-\t\t$ajax->setTimeOuts(120, 120, 0, 0);\r\n-\t\t$ajax->setRequestHeader('User-Agent', $u);\r\n-\t\t$ajax->setRequestHeader('Cookie', $c);\r\n-\t\t$ajax->send();\r\n-\t}\r\n-\r\n-\treturn $ajax->responseText;\r\n-}\r\n-\r\n-function AppCentre_CreateOptoinsOfVersion($default) {\r\n-\tglobal $zbp;\r\n-\r\n-\t$s = null;\r\n-\t$array = $GLOBALS['zbpvers'];\r\n-\tkrsort($array);\r\n-\t$i = 0;\r\n-\tforeach ($array as $key => $value) {\r\n-\t\t$i += 1;\r\n-\t\tif (($i == 1) or strpos($value, 'Beta') === False) {\r\n-\t\t\t$s .= '<option value=\"' . $key . '\" ' . ($default == $key ? 'selected=\"selected\"' : '') . ' >' . $value . '</option>';\r\n-\t\t}\r\n-\r\n-\t}\r\n-\treturn $s;\r\n-}\r\n-\r\n-function AppCentre_GetHttpContent($url) {\r\n-\r\n-\tif (function_exists(\"GetHttpContent\")) {\r\n-\t\treturn GetHttpContent($url);\r\n-\t}\r\n-\r\n-\t$r = null;\r\n-\tif (function_exists(\"curl_init\")) {\r\n-\t\t$ch = curl_init($url);\r\n-\t\tcurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\r\n-\t\tcurl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);\r\n-\t\tcurl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);\r\n-\t\tif (ini_get(\"safe_mode\") == false && ini_get(\"open_basedir\") == false) {\r\n-\t\t\tcurl_setopt($ch, CURLOPT_MAXREDIRS, 1);\r\n-\t\t\tcurl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);\r\n-\t\t}\r\n-\t\t$r = curl_exec($ch);\r\n-\t\tcurl_close($ch);\r\n-\t} elseif (ini_get(\"allow_url_fopen\")) {\r\n-\t\t$r = file_get_contents($url);\r\n-\t}\r\n-\r\n-\treturn $r;\r\n-}\r\n-\r\n-function AppCentre_crc32_signed($num) {\r\n-\t$crc = crc32($num);\r\n-\tif ($crc & 0x80000000) {\r\n-\t\t$crc ^= 0xffffffff;\r\n-\t\t$crc += 1;\r\n-\t\t$crc = -$crc;\r\n-\t}\r\n-\treturn $crc;\r\n-}\r\n-\r\n-$AppCentre_dirs = array();\r\n-$AppCentre_files = array();\r\n-\r\n-function AppCentre_GetAllFileDir($dir) {\r\n-\tglobal $AppCentre_dirs;\r\n-\tglobal $AppCentre_files;\r\n-\tif (function_exists('scandir')) {\r\n-\t\tforeach (scandir($dir) as $d) {\r\n-\t\t\tif (is_dir($dir . $d)) {\r\n-\t\t\t\tif (substr($d, 0, 1) != '.') {\r\n-\t\t\t\t\tAppCentre_GetAllFileDir($dir . $d . '/');\r\n-\t\t\t\t\t$AppCentre_dirs[] = $dir . $d . '/';\r\n-\t\t\t\t}\r\n-\t\t\t} else {\r\n-\t\t\t\t$AppCentre_files[] = $dir . $d;\r\n-\t\t\t}\r\n-\t\t}\r\n-\t} else {\r\n-\t\tif ($handle = opendir($dir)) {\r\n-\t\t\twhile (false !== ($file = readdir($handle))) {\r\n-\t\t\t\tif (substr($file, 0, 1) != '.') {\r\n-\t\t\t\t\tif (is_dir($dir . $file)) {\r\n-\t\t\t\t\t\t$AppCentre_dirs[] = $dir . $file . '/';\r\n-\t\t\t\t\t\tAppCentre_GetAllFileDir($dir . $file . '/');\r\n-\t\t\t\t\t} else {\r\n-\t\t\t\t\t\t$AppCentre_files[] = $dir . $file;\r\n-\t\t\t\t\t}\r\n-\t\t\t\t}\r\n-\t\t\t}\r\n-\t\t\tclosedir($handle);\r\n-\t\t}\r\n-\t}\r\n-\r\n-}\r\n-\r\n-function AppCentre_Pack($app, $gzip) {\r\n-\r\n-\tglobal $zbp;\r\n-\tglobal $AppCentre_dirs;\r\n-\tglobal $AppCentre_files;\r\n-\r\n-\t$AppCentre_dirs = array();\r\n-\t$AppCentre_files = array();\r\n-\r\n-\t$dir = $app->GetDir();\r\n-\tAppCentre_GetAllFileDir($dir);\r\n-\r\n-\t$s = '<?xml version=\"1.0\" encoding=\"utf-8\"?>';\r\n-\t$s .= '<app version=\"php\" type=\"' . $app->type . '\">';\r\n-\r\n-\t$s .= '<id>' . htmlspecialchars($app->id) . '</id>';\r\n-\t$s .= '<name>' . htmlspecialchars($app->name) . '</name>';\r\n-\t$s .= '<url>' . htmlspecialchars($app->url) . '</url>';\r\n-\t$s .= '<note>' . htmlspecialchars($app->note) . '</note>';\r\n-\t$s .= '<description>' . htmlspecialchars($app->description) . '</description>';\r\n-\r\n-\t$s .= '<path>' . htmlspecialchars($app->path) . '</path>';\r\n-\t$s .= '<include>' . htmlspecialchars($app->include) . '</include>';\r\n-\t$s .= '<level>' . htmlspecialchars($app->level) . '</level>';\r\n-\r\n-\t$s .= '<author>';\r\n-\t$s .= '<name>' . htmlspecialchars($app->author_name) . '</name>';\r\n-\t$s .= '<email>' . htmlspecialchars($app->author_email) . '</email>';\r\n-\t$s .= '<url>' . htmlspecialchars($app->author_url) . '</url>';\r\n-\t$s .= '</author>';\r\n-\r\n-\t$s .= '<source>';\r\n-\t$s .= '<name>' . htmlspecialchars($app->source_name) . '</name>';\r\n-\t$s .= '<email>' . htmlspecialchars($app->source_email) . '</email>';\r\n-\t$s .= '<url>' . htmlspecialchars($app->source_url) . '</url>';\r\n-\t$s .= '</source>';\r\n-\r\n-\t$s .= '<adapted>' . htmlspecialchars($app->adapted) . '</adapted>';\r\n-\t$s .= '<version>' . htmlspecialchars($app->version) . '</version>';\r\n-\t$s .= '<pubdate>' . htmlspecialchars($app->pubdate) . '</pubdate>';\r\n-\t$s .= '<modified>' . htmlspecialchars($app->modified) . '</modified>';\r\n-\t$s .= '<price>' . htmlspecialchars($app->price) . '</price>';\r\n-\r\n-\t$s .= '<advanced>';\r\n-\t$s .= '<dependency>' . htmlspecialchars($app->advanced_dependency) . '</dependency>';\r\n-\t$s .= '<rewritefunctions>' . htmlspecialchars($app->advanced_rewritefunctions) . '</rewritefunctions>';\r\n-\t$s .= '<conflict>' . htmlspecialchars($app->advanced_conflict) . '</conflict>';\r\n-\t$s .= '</advanced>';\r\n-\r\n-\t$s .= '<sidebars>';\r\n-\t$s .= '<sidebar1>' . htmlspecialchars($app->sidebars_sidebar1) . '</sidebar1>';\r\n-\t$s .= '<sidebar2>' . htmlspecialchars($app->sidebars_sidebar2) . '</sidebar2>';\r\n-\t$s .= '<sidebar3>' . htmlspecialchars($app->sidebars_sidebar3) . '</sidebar3>';\r\n-\t$s .= '<sidebar4>' . htmlspecialchars($app->sidebars_sidebar4) . '</sidebar4>';\r\n-\t$s .= '<sidebar5>' . htmlspecialchars($app->sidebars_sidebar5) . '</sidebar5>';\r\n-\t$s .= '</sidebars>';\r\n-\r\n-\tforeach ($AppCentre_dirs as $key => $value) {\r\n-\t\t$value = preg_replace('/[^(\\x20-\\x7F)]*/', '', $value);\r\n-\t\t$d = $app->id . '/' . str_replace($dir, '', $value);\r\n-\t\t$s .= '<folder><path>' . htmlspecialchars($d) . '</path></folder>';\r\n-\t}\r\n-\tforeach ($AppCentre_files as $key => $value) {\r\n-\t\t$d = $app->id . '/' . str_replace($dir, '', $value);\r\n-\t\t$ext = pathinfo($value, PATHINFO_EXTENSION);\r\n-\t\tif ($ext == 'php' || $ext == 'inc') {\r\n-\t\t\t$c = base64_encode(RemoveBOM(file_get_contents($value)));\r\n-\t\t} else {\r\n-\t\t\tif (strripos($d, '/plugin.xml') !== false) {\r\n-\t\t\t\t$x = file_get_contents($value);\r\n-\t\t\t\t$x1 = 'app_host:' . $zbp->host . ';';\r\n-\t\t\t\t$x2 = 'app_email:' . $zbp->user->Email . ';';\r\n-\t\t\t\t$x3 = 'app_user:' . $zbp->user->Name . ';';\r\n-\t\t\t\t$x = str_replace('</plugin>', '</plugin><!-- ' . $x1 . $x2 . $x3 . ' -->', $x);\r\n-\t\t\t\t$c = base64_encode($x);\r\n-\t\t\t} elseif (strripos($d, '/theme.xml') !== false) {\r\n-\t\t\t\t$x = file_get_contents($value);\r\n-\t\t\t\t$x1 = 'app_host:' . $zbp->host . ';';\r\n-\t\t\t\t$x2 = 'app_email:' . $zbp->user->Email . ';';\r\n-\t\t\t\t$x3 = 'app_user:' . $zbp->user->Name . ';';\r\n-\t\t\t\t$x = str_replace('</theme>', '</theme><!-- ' . $x1 . $x2 . $x3 . ' -->', $x);\r\n-\t\t\t\t$c = base64_encode($x);\r\n-\t\t\t} else {\r\n-\t\t\t\t$c = base64_encode(file_get_contents($value));\r\n-\t\t\t}\r\n-\r\n-\t\t}\r\n-\t\tif (IS_WINDOWS) {\r\n-\t\t\t$d = iconv($zbp->lang['windows_character_set'], 'UTF-8//IGNORE', $d);\r\n-\t\t}\r\n-\r\n-\t\t$s .= '<file><path>' . htmlspecialchars($d) . '</path><stream>' . $c . '</stream></file>';\r\n-\t}\r\n-\r\n-\t$s .= '</app>';\r\n-\r\n-\tif ($gzip) {\r\n-\t\treturn gzencode($s, 9, FORCE_GZIP);\r\n-\t} else {\r\n-\t\treturn $s;\r\n-\t}\r\n-\r\n-}\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/Cube1.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/Cube2.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/application_edit.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/bricks.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/delete.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/document_empty.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/download.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/drive-upload.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/loading.gif",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/plugin.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/refresh.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/refresh2.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/style.css",
          "status": "removed",
          "additions": 0,
          "deletions": 32,
          "patch": "@@ -1,32 +0,0 @@\n-.app-theme{\r\n-\tfloat:left;\r\n-\tfloat:left;\r\n-\twidth:350px;\r\n-\tbackground:#f0f0f0;\r\n-\tmargin:5px 20px 40px 5px;\r\n-\r\n-}\r\n-\r\n-\r\n-.app-plugin{\r\n-\tfloat:left;\r\n-\twidth:350px;\r\n-\tbackground:#f0f0f0;\r\n-\tmargin:5px 20px 40px 5px;\r\n-\tbox-shadow: 0 0 10px #aaa;\r\n-}\r\n-\r\n-.app-theme-image img{\r\n-\twidth:320px;\r\n-\theight:240px;\r\n-}\r\n-\r\n-.app-plugin-image img{\r\n-\twidth:128px;\r\n-\theight:128px;\r\n-}\r\n-\r\n-\r\n-.app-plugin-id,.app-theme-id{\r\n-\tdisplay:none;\r\n-}\r"
        },
        {
          "filename": "zb_users/plugin/AppCentre/images/theme.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/include.php",
          "status": "removed",
          "additions": 0,
          "deletions": 109,
          "patch": "@@ -1,109 +0,0 @@\n-<?php\r\n-#\u6ce8\u518c\u63d2\u4ef6\r\n-RegisterPlugin(\"AppCentre\", \"ActivePlugin_AppCentre\");\r\n-if (!function_exists('GetScheme')) {\r\n-\tfunction GetScheme($array) {\r\n-\t\tif (array_key_exists('REQUEST_SCHEME', $array)) {\r\n-\t\t\tif (strtolower($array['REQUEST_SCHEME']) == 'https') {\r\n-\t\t\t\treturn 'https://';\r\n-\t\t\t}\r\n-\t\t} elseif (array_key_exists('HTTPS', $array)) {\r\n-\t\t\tif (strtolower($array['HTTPS']) == 'on') {\r\n-\t\t\t\treturn 'https://';\r\n-\t\t\t}\r\n-\t\t}\r\n-\t\treturn 'http://';\r\n-\t}\r\n-}\r\n-if (!defined('HTTP_SCHEME')) {\r\n-\tdefine('HTTP_SCHEME', GetScheme($_SERVER));\r\n-}\r\n-\r\n-define('APPCENTRE_URL', HTTP_SCHEME . 'app.zblogcn.com/client/');\r\n-define('APPCENTRE_SYSTEM_UPDATE', HTTP_SCHEME . 'update.zblogcn.com/zblogphp/');\r\n-\r\n-define('APPCENTRE_API_URL', HTTP_SCHEME . 'app.zblogcn.com/api/index.php?api=');\r\n-define('APPCENTRE_API_APP_ISBUY', 'isbuy');\r\n-define('APPCENTRE_API_USER_INFO', 'userinfo');\r\n-define('APPCENTRE_API_ORDER_LIST', 'orderlist');\r\n-define('APPCENTRE_API_ORDER_DETAIL', 'orderdetail');\r\n-\r\n-function ActivePlugin_AppCentre() {\r\n-\tglobal $zbp;\r\n-\tAdd_Filter_Plugin('Filter_Plugin_Admin_LeftMenu', 'AppCentre_AddMenu');\r\n-\tAdd_Filter_Plugin('Filter_Plugin_Admin_ThemeMng_SubMenu', 'AppCentre_AddThemeMenu');\r\n-\tAdd_Filter_Plugin('Filter_Plugin_Admin_PluginMng_SubMenu', 'AppCentre_AddPluginMenu');\r\n-\tAdd_Filter_Plugin('Filter_Plugin_Admin_SiteInfo_SubMenu', 'AppCentre_AddSiteInfoMenu');\r\n-\r\n-\tif (method_exists('ZBlogPHP', 'LoadLanguage')) {\r\n-\t\t$zbp->LoadLanguage('plugin', 'AppCentre');\r\n-\t} else {\r\n-\t\tif (is_readable($f = $zbp->path . 'zb_users/plugin/AppCentre/language/' . $zbp->option['ZC_BLOG_LANGUAGEPACK'] . '.php')) {\r\n-\t\t\t$zbp->lang['AppCentre'] = require $f;\r\n-\t\t} elseif (is_readable($f = $zbp->path . 'zb_users/plugin/AppCentre/language/' . 'zh-cn' . '.php')) {\r\n-\t\t\t$zbp->lang['AppCentre'] = require $f;\r\n-\t\t}\r\n-\r\n-\t}\r\n-}\r\n-\r\n-function InstallPlugin_AppCentre() {\r\n-\tglobal $zbp;\r\n-\t$zbp->Config('AppCentre')->enabledcheck = 1;\r\n-\t$zbp->Config('AppCentre')->checkbeta = 0;\r\n-\t$zbp->Config('AppCentre')->enabledevelop = 0;\r\n-\t$zbp->Config('AppCentre')->enablegzipapp = 0;\r\n-\t$zbp->SaveConfig('AppCentre');\r\n-}\r\n-\r\n-function AppCentre_AddMenu(&$m) {\r\n-\tglobal $zbp;\r\n-\t$m['nav_AppCentre'] = MakeLeftMenu(\"root\", $zbp->lang['AppCentre']['name'], $zbp->host . \"zb_users/plugin/AppCentre/main.php\", \"nav_AppCentre\", \"aAppCentre\", $zbp->host . \"zb_users/plugin/AppCentre/images/Cube1.png\");\r\n-}\r\n-\r\n-function AppCentre_AddSiteInfoMenu() {\r\n-\tglobal $zbp;\r\n-\tif ($zbp->Config('AppCentre')->enabledcheck) {\r\n-\t\t$last = (int) $zbp->Config('AppCentre')->lastchecktime;\r\n-\t\tif ((time() - $last) > 11 * 60 * 60) {\r\n-\t\t\techo \"<script type='text/javascript'>$(document).ready(function(){  $.getScript('{$zbp->host}zb_users/plugin/AppCentre/main.php?method=checksilent&rnd='); });</script>\";\r\n-\t\t\t$zbp->Config('AppCentre')->lastchecktime = time();\r\n-\t\t\t$zbp->SaveConfig('AppCentre');\r\n-\t\t}\r\n-\t}\r\n-\tif ($zbp->version >= 150101 && (int) $zbp->option['ZC_LAST_VERSION'] < 150101) {\r\n-\t\techo \"<script type='text/javascript'>$('.main').prepend('<div class=\\\"hint\\\"><p class=\\\"hint hint_tips\\\"><a href=\\\"{$zbp->host}zb_users/plugin/AppCentre/update.php?updatedb\\\">\u8bf7\u70b9\u51fb\u8be5\u94fe\u63a5\u5347\u7ea7\u6570\u636e\u5e93\u7ed3\u6784</a></p></div>');</script>\";\r\n-\t}\r\n-\r\n-}\r\n-\r\n-function AppCentre_AddThemeMenu() {\r\n-\tglobal $zbp;\r\n-\techo \"<script type='text/javascript'>var app_enabledevelop=\" . (int) $zbp->Config('AppCentre')->enabledevelop . \";</script>\";\r\n-\techo \"<script type='text/javascript'>var app_username='\" . $zbp->Config('AppCentre')->username . \"';</script>\";\r\n-\techo \"<script src='{$zbp->host}zb_users/plugin/AppCentre/theme.js.php' type='text/javascript'></script>\";\r\n-}\r\n-\r\n-function AppCentre_AddPluginMenu() {\r\n-\tglobal $zbp;\r\n-\techo \"<script type='text/javascript'>var app_enabledevelop=\" . (int) $zbp->Config('AppCentre')->enabledevelop . \";</script>\";\r\n-\techo \"<script type='text/javascript'>var app_username='\" . $zbp->Config('AppCentre')->username . \"';</script>\";\r\n-\techo \"<script src='{$zbp->host}zb_users/plugin/AppCentre/plugin.js.php' type='text/javascript'></script>\";\r\n-}\r\n-\r\n-//$appid\u662fApp\u5728\u5e94\u7528\u4e2d\u5fc3\u7684\u53d1\u5e03\u540e\u7684\u6587\u7ae0ID\u6570\u5b57\u53f7\uff0c\u975eApp\u7684ID\u540d\u79f0\u3002\r\n-function AppCentre_App_Check_ISBUY($appid) {\r\n-\tglobal $zbp;\r\n-\t$postdate = array(\r\n-\t\t'email' => $zbp->Config('AppCentre')->shop_username,\r\n-\t\t'password' => $zbp->Config('AppCentre')->shop_password,\r\n-\t\t'appid' => $appid,\r\n-\t\t\u00a0\u00a0\u00a0\u00a0);\r\n-\t$http_post = Network::Create();\r\n-\t$http_post->open('POST', APPCENTRE_API_URL . APPCENTRE_API_APP_ISBUY);\r\n-\t$http_post->setRequestHeader('Referer', substr($zbp->host, 0, -1) . $zbp->currenturl);\r\n-\r\n-\t$http_post->send($postdate);\r\n-\t$result = json_decode($http_post->responseText, true);\r\n-\treturn $result;\r\n-}\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/language/en.php",
          "status": "removed",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -1,6 +0,0 @@\n-<?php\r\n-return array(\r\n-\r\n-'name'=>'App Store',\r\n-\r\n-);\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/language/zh-cn.php",
          "status": "removed",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -1,6 +0,0 @@\n-<?php\r\n-return array(\r\n-\r\n-'name'=>'\u5e94\u7528\u4e2d\u5fc3',\r\n-\r\n-);\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/language/zh-tw.php",
          "status": "removed",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -1,6 +0,0 @@\n-<?php\r\n-return array(\r\n-\r\n-'name'=>'\u61c9\u7528\u5e02\u96c6',\r\n-\r\n-);\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/logo.png",
          "status": "removed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "zb_users/plugin/AppCentre/main.php",
          "status": "removed",
          "additions": 0,
          "deletions": 60,
          "patch": "@@ -1,60 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle = '\u5e94\u7528\u4e2d\u5fc3';\r\n-\r\n-if (!$zbp->Config('AppCentre')->HasKey('enabledcheck')) {\r\n-\t$zbp->Config('AppCentre')->enabledcheck = 1;\r\n-\t$zbp->Config('AppCentre')->checkbeta = 0;\r\n-\t$zbp->Config('AppCentre')->enabledevelop = 0;\r\n-\t$zbp->SaveConfig('AppCentre');\r\n-}\r\n-\r\n-if (count($_POST) > 0) {\r\n-\r\n-\t$zbp->SetHint('good');\r\n-\tRedirect('./main.php');\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus(GetVars('method', 'GET') == 'check' ? 2 : 1);?></div>\r\n-  <div id=\"divMain2\">\r\n-\r\n-<?php\r\n-$method = GetVars('method', 'GET');\r\n-if (!$method) {\r\n-\t$method = 'view';\r\n-}\r\n-\r\n-Server_Open($method);\r\n-?>\r\n-\t<script type=\"text/javascript\">\r\n-\t\twindow.plug_list = \"<?php echo AddNameInString($option['ZC_USING_PLUGIN_LIST'], $option['ZC_BLOG_THEME'])?>\";\r\n-\t\twindow.signkey = '<?php echo $zbp->GetToken()?>';\r\n-\t</script>\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/plugin.js.php",
          "status": "removed",
          "additions": 0,
          "deletions": 56,
          "patch": "@@ -1,56 +0,0 @@\n-<?php\n-require '../../../zb_system/function/c_system_base.php';\n-\n-require '../../../zb_system/function/c_system_admin.php';\n-\n-require dirname(__FILE__) . '/function.php';\n-\n-$zbp->Load();\n-ob_clean();\n-header('Content-Type: application/x-javascript; charset=utf-8');\n-?>\n-\n-$(document).ready(function(){ \n-\n-$(\"#divMain2\").prepend(\"<form class='search' name='edit' id='edit' method='post' enctype='multipart/form-data' action='\"+bloghost+\"zb_users/plugin/AppCentre/app_upload.php?token=<?php echo $zbp->GetToken();?>'><p>\u672c\u5730\u4e0a\u4f20\u5e76\u5b89\u88c5\u63d2\u4ef6zba\u6587\u4ef6:&nbsp;<input type='file' id='edtFileLoad' name='edtFileLoad' size='40' />&nbsp;&nbsp;&nbsp;&nbsp;<input type='submit' class='button' value='\u63d0\u4ea4' name='B1' />&nbsp;&nbsp;<input class='button' type='reset' value='\u91cd\u7f6e' name='B2' />&nbsp;</p></form>\")\n-\n-if(app_enabledevelop){\n-\n-$(\"tr\").each(function(){\n-\t$(this).append(\"<td class='td15' align='center'></td>\");\n-});\n-$(\"tr\").first().children().last().append(\"<b>\u5f00\u53d1\u8005\u6a21\u5f0f</b>\");\n-\n-}\n-\n-$(\".plugin\").each(function(){\n-\n-\tvar t=$(this).data(\"pluginid\");\n-\tif(t==undefined)t=$(this).find(\"strong\").html();\n-\tvar s=\"\"\n-\ts=s+\"<a class=\\\"button\\\"  href='\"+bloghost+\"zb_users/plugin/AppCentre/plugin_edit.php?id=\"+t+\"' title='\u7f16\u8f91\u8be5\u63d2\u4ef6\u4fe1\u606f'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/application_edit.png'/></a>\";\n-\n-\ts=s+\"&nbsp;&nbsp;&nbsp;&nbsp;<a class=\\\"button\\\"  href='\"+bloghost+\"zb_users/plugin/AppCentre/app_pack.php?type=plugin&id=\"+t+\"' title='\u5bfc\u51fa\u8be5\u63d2\u4ef6' target='_blank'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/download.png'/></a>\";\n-\n-\tif(app_username){\n-\t\ts=s+\"&nbsp;&nbsp;&nbsp;&nbsp;<a class=\\\"button\\\" href='\"+bloghost+\"zb_users/plugin/AppCentre/submit.php?type=plugin&amp;id=\"+t+\"' title='\u4e0a\u4f20\u5e94\u7528\u5230\u5b98\u65b9\u7f51\u7ad9\u5e94\u7528\u4e2d\u5fc3' target='_blank'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/drive-upload.png'/></a>\";\n-\t}\n-\n-\n-\t\n-\tif(app_enabledevelop){\n-\t\n-\t\t$(this).parent().children().last().append(s);\n-\n-\t}\n-\n-\tif(!$(this).hasClass(\"plugin-on\")){\n-\t\t$(this).parent().children().eq(4).append(\"&nbsp;&nbsp;&nbsp;&nbsp;<a class=\\\"button\\\"  href='\"+bloghost+\"zb_users/plugin/AppCentre/app_del.php?type=plugin&id=\"+t+\"' title='\u5220\u9664\u8be5\u63d2\u4ef6' onclick='return window.confirm(\\\"\u5355\u51fb\u201c\u786e\u5b9a\u201d\u7ee7\u7eed\u3002\u5355\u51fb\u201c\u53d6\u6d88\u201d\u505c\u6b62\u3002\\\");'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/delete.png'/></a>\");\n-\t}else{\n-\t};\n-\n-});\n-\n-\n-\n-});\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/plugin.xml",
          "status": "removed",
          "additions": 0,
          "deletions": 38,
          "patch": "@@ -1,38 +0,0 @@\n-<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n-<plugin version=\"php\">\r\n-<id>AppCentre</id>\r\n-<name>\u5e94\u7528\u4e2d\u5fc3</name>\r\n-<url>http://www.zblogcn.com/</url>\r\n-<note>Z-BlogPHP\u7248\u7684\u8d44\u6e90\u5927\u672c\u8425</note>\r\n-<description></description>\r\n-<path>main.php</path>\r\n-<include>include.php</include>\r\n-<level>1</level>\r\n-<author>\r\n-  <name>zx.asd</name>\r\n-  <email>rainbowsoft@gmail.com</email>\r\n-  <url>http://www.zblogcn.com/</url>\r\n-</author>\r\n-<source>\r\n-  <name></name>\r\n-  <email></email>\r\n-  <url></url>\r\n-</source>\r\n-<adapted>131221</adapted>\r\n-<version>2.1</version>\r\n-<pubdate>2013-07-07</pubdate>\r\n-<modified>2015-12-08</modified>\r\n-<price>0</price>\r\n-<advanced>\r\n-  <dependency></dependency>\r\n-  <rewritefunctions></rewritefunctions>\r\n-  <conflict></conflict>\r\n-</advanced>\r\n-<sidebars>\r\n-  <sidebar1></sidebar1>\r\n-  <sidebar2></sidebar2>\r\n-  <sidebar3></sidebar3>\r\n-  <sidebar4></sidebar4>\r\n-  <sidebar5></sidebar5>\r\n-</sidebars>\r\n-</plugin>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/plugin_edit.php",
          "status": "removed",
          "additions": 0,
          "deletions": 262,
          "patch": "@@ -1,262 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u63d2\u4ef6\u7f16\u8f91';\r\n-\r\n-if (GetVars('id')) {\r\n-\t$app = $zbp->LoadApp('plugin', GetVars('id'));\r\n-\t$mt = array();\r\n-\t$ft = GetFilesInDir($zbp->path . '/zb_users/plugin/' . $app->id . '/', 'php|inc|png');\r\n-\tforeach ($ft as $f) {\r\n-\t\t$mt[] = filemtime($f);\r\n-\t}\r\n-\trsort($mt);\r\n-\tif (count($mt) == 0) {\r\n-\t\t$mt[] = time();\r\n-\t}\r\n-\r\n-\t$app->modified = date('Y-m-d', reset($mt));\r\n-} else {\r\n-\t$app = new App;\r\n-\t$app->price = 0;\r\n-\t$app->version = '1.0';\r\n-\t$app->pubdate = date('Y-m-d', time());\r\n-\t$app->modified = date('Y-m-d', time());\r\n-\t$v = array_keys($zbpvers);\r\n-\t$app->adapted = (string) end($v);\r\n-\t$app->type = 'plugin';\r\n-\t$app->author_name = $zbp->user->Name;\r\n-\t$app->author_email = $zbp->user->Email;\r\n-\t$app->author_url = $zbp->user->HomePage;\r\n-\t$app->path = 'main.php';\r\n-\t$app->include = 'include.php';\r\n-\r\n-}\r\n-\r\n-if (count($_POST) > 0) {\r\n-\r\n-\t$app->id = trim($_POST['app_id']);\r\n-\tif (!CheckRegExp($app->id, \"/^[A-Za-z0-9_]{3,30}/\")) {$zbp->ShowError('ID\u540d\u5fc5\u987b\u662f\u5b57\u6bcd\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210,\u957f\u5ea63-30\u5b57\u7b26.');die();}\r\n-\tif (!GetVars('id')) {\r\n-\t\t$app2 = $zbp->LoadApp('plugin', $app->id);\r\n-\t\tif ($app2->id) {$zbp->ShowError('\u5df2\u5b58\u5728\u540c\u540d\u7684APP\u5e94\u7528.');die();}\r\n-\t\t@mkdir($zbp->usersdir . 'plugin/' . $app->id . '/');\r\n-\t\t@copy($zbp->usersdir . 'plugin/AppCentre/images/plugin.png', $zbp->usersdir . 'plugin/' . $app->id . '/logo.png');\r\n-\r\n-\t\tif (trim($_POST['app_path'])) {\r\n-\t\t\t$file = file_get_contents('tpl/main.html');\r\n-\t\t\t$file = str_replace(\"<%appid%>\", $app->id, $file);\r\n-\t\t\t$path = $zbp->usersdir . 'plugin/' . $app->id . '/' . trim($_POST['app_path']);\r\n-\t\t\t@file_put_contents($path, $file);\r\n-\t\t}\r\n-\t\tif (trim($_POST['app_include'])) {\r\n-\t\t\t$file = file_get_contents('tpl/include.html');\r\n-\t\t\t$file = str_replace(\"<%appid%>\", $app->id, $file);\r\n-\t\t\t$path = $zbp->usersdir . 'plugin/' . $app->id . '/include.php';\r\n-\t\t\t@file_put_contents($path, $file);\r\n-\t\t}\r\n-\t}\r\n-\r\n-\t$app->name = trim($_POST['app_name']);\r\n-\t$app->url = trim($_POST['app_url']);\r\n-\t$app->note = trim($_POST['app_note']);\r\n-\t$app->adapted = $_POST['app_adapted'];\r\n-\t$app->version = (float) $_POST['app_version'];\r\n-\tif ($app->version == 1) {\r\n-\t\t$app->version = '1.0';\r\n-\t}\r\n-\r\n-\t$app->pubdate = date('Y-m-d', strtotime($_POST['app_pubdate']));\r\n-\t$app->modified = date('Y-m-d', time());\r\n-\r\n-\t$app->author_name = trim($_POST['app_author_name']);\r\n-\t$app->author_email = trim($_POST['app_author_email']);\r\n-\t$app->author_url = trim($_POST['app_author_url']);\r\n-\r\n-\t$app->path = trim($_POST['app_path']);\r\n-\t$app->include = trim($_POST['app_include']);\r\n-\t$app->level = (int) $_POST['app_level'];\r\n-\t$app->price = (float) $_POST['app_price'];\r\n-\r\n-\t$app->advanced_dependency = trim($_POST['app_advanced_dependency']);\r\n-\t$app->advanced_rewritefunctions = trim($_POST['app_advanced_rewritefunctions']);\r\n-\t$app->advanced_conflict = trim($_POST['app_advanced_conflict']);\r\n-\r\n-\t$app->description = trim($_POST['app_description']);\r\n-\r\n-\t$app->SaveInfoByXml();\r\n-\r\n-\t$zbp->SetHint('good', '\u63d0\u4ea4\u6210\u529f\uff01<a href=\"submit.php?type=plugin&id=' . $app->id . '\">\u73b0\u5728\u7acb\u523b\u4e0a\u4f20\u5230\u5e94\u7528\u4e2d\u5fc3\uff01</a>');\r\n-\tRedirect($_SERVER[\"HTTP_REFERER\"]);\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus(GetVars('id', 'GET') == '' ? 5 : '');?></div>\r\n-  <div id=\"divMain2\">\r\n-\r\n-<form method=\"post\" action=\"\">\r\n-  <table border=\"1\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" class=\"tableBorder tableBorder-thcenter\">\r\n-    <tr>\r\n-      <th width='28%'>&nbsp;</th>\r\n-      <th>&nbsp;</th>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6ID</b><br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u63d2\u4ef6ID\u4e3a\u63d2\u4ef6\u7684\u76ee\u5f55\u540d,\u4e14\u4e0d\u80fd\u91cd\u590d.ID\u540d\u53ea\u80fd\u7528\u5b57\u6bcd\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7684\u7ec4\u5408.</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_id\" name=\"app_id\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->id;?>\" <?php if ($app->id) {\r\n-\techo 'readonly=\"readonly\"';\r\n-}\r\n-?>  />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u540d\u79f0</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_name\" name=\"app_name\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->name;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u53d1\u5e03\u9875\u9762</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_url\" name=\"app_url\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->url;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u7b80\u4ecb</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_note\" name=\"app_note\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->note;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u9002\u7528\u7684\u6700\u4f4e\u8981\u6c42 Z-Blog \u7248\u672c</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <select name=\"app_adapted\" id=\"app_adapted\" style=\"width:400px;\">\r\n-<?php echo AppCentre_CreateOptoinsOfVersion($app->adapted);?>\r\n-          </select>\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u7248\u672c\u53f7</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_version\" name=\"app_version\" style=\"width:550px;\" type=\"number\" step=\"0.1\" value=\"<?php echo $app->version;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u9996\u53d1\u65f6\u95f4</b><br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u65e5\u671f\u683c\u5f0f\u4e3a2012-12-12</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_pubdate\" name=\"app_pubdate\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->pubdate;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u6700\u540e\u4fee\u6539\u65f6\u95f4</b><br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u7cfb\u7edf\u81ea\u52a8\u68c0\u67e5include.php\u7684\u6700\u540e\u4fee\u6539\u65e5\u671f</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_modified\" name=\"app_modified\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->modified;?>\" readonly />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4f5c\u8005\u540d\u79f0</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_author_name\" name=\"app_author_name\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->author_name;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4f5c\u8005\u90ae\u7bb1</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_author_email\" name=\"app_author_email\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->author_email;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4f5c\u8005\u7f51\u7ad9</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_author_url\" name=\"app_author_url\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->author_url;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u7ba1\u7406\u9875</b> (\u53ef\u9009)<br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u4e60\u60ef\u547d\u540d\u4e3amain.php</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_path\" name=\"app_path\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->path;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u5d4c\u5165\u9875</b> (\u53ef\u9009)<br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u53ea\u80fd\u547d\u540d\u4e3ainclude.php</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_include\" name=\"app_include\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->include;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u7ba1\u7406\u6743\u9650</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <select name=\"app_level\" id=\"app_level\" style=\"width:200px;\">\r\n-<?php echo CreateOptoinsOfMemberLevel(1)?>\r\n-          </select>\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u63d2\u4ef6\u5b9a\u4ef7</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_price\" name=\"app_price\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->price;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u3010\u9ad8\u7ea7\u3011\u4f9d\u8d56\u63d2\u4ef6\uff08\u4ee5|\u5206\u9694\uff09</b>(\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_advanced_dependency\" name=\"app_advanced_dependency\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->advanced_dependency;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr style=\"display: none\">\r\n-      <td><p><b>\u00b7 \u3010\u9ad8\u7ea7\u3011\u63d2\u4ef6\u91cd\u5199\u7cfb\u7edf\u51fd\u6570\u5217\u8868\uff08\u4ee5|\u5206\u9694\uff09</b>(\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_advanced_rewritefunctions\" name=\"app_advanced_rewritefunctions\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->advanced_rewritefunctions;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u3010\u9ad8\u7ea7\u3011\u63d2\u4ef6\u51b2\u7a81\u63d2\u4ef6\u5217\u8868\uff08\u4ee5|\u5206\u9694\uff09</b>(\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_advanced_conflict\" name=\"app_advanced_conflict\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->advanced_conflict;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u8be6\u7ec6\u8bf4\u660e</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <textarea cols=\"3\" rows=\"6\" id=\"app_description\" name=\"app_description\" style=\"width:550px;\"><?php echo htmlspecialchars($app->description);?></textarea>\r\n-        </p></td>\r\n-    </tr>\r\n-  </table>\r\n-  <p> \u63d0\u793a:\u63d2\u4ef6\u7684\u56fe\u6807\u662f\u540d\u4e3alogo.png\u7684<b>128 x 128 px</b>\u5927\u5c0f\u7684png\u6587\u4ef6,\u63a8\u8350\u4f7f\u7528<a href=\"http://www.syncfusion.com/downloads/metrostudio\" target=\"_blank\">Metro Studio</a>\u8f6f\u4ef6\u521b\u5efalogo,\u63d2\u4ef6\u7684\u7f29\u7565\u56fe(\u53ef\u9009)\u662f\u540d\u4e3ascreenshot.png\u7684<b>300x240px</b>\u5927\u5c0f\u7684png\u6587\u4ef6,\u653e\u5728\u63d2\u4ef6\u7684\u76ee\u5f55\u4e0b.</p>\r\n-  <p><br/>\r\n-    <input type=\"submit\" class=\"button\" value=\"\u63d0\u4ea4\" id=\"btnPost\" onclick='' />\r\n-  </p>\r\n-  <p>&nbsp;</p>\r\n-</form>\r\n-\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/setting.php",
          "status": "removed",
          "additions": 0,
          "deletions": 83,
          "patch": "@@ -1,83 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u8bbe\u7f6e';\r\n-\r\n-if (GetVars('act') == 'save') {\r\n-\r\n-\t$zbp->Config('AppCentre')->enabledcheck = (int) GetVars(\"app_enabledcheck\");\r\n-\t$zbp->Config('AppCentre')->checkbeta = (int) GetVars(\"app_checkbeta\");\r\n-\t$zbp->Config('AppCentre')->enabledevelop = (int) GetVars(\"app_enabledevelop\");\r\n-\t$zbp->Config('AppCentre')->enablegzipapp = (int) GetVars(\"app_enablegzipapp\");\r\n-\t$zbp->SaveConfig('AppCentre');\r\n-\r\n-\t$zbp->SetHint('good');\r\n-\tRedirect('./setting.php');\r\n-\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus(4);?></div>\r\n-  <div id=\"divMain2\">\r\n-\r\n-            <form action=\"?act=save\" method=\"post\">\r\n-              <table width=\"100%\" border=\"0\">\r\n-                <tr height=\"32\">\r\n-                  <th colspan=\"2\" align=\"center\">\u8bbe\u7f6e\r\n-                    </td>\r\n-                </tr>\r\n-                <tr height=\"32\">\r\n-                  <td width=\"30%\" align=\"left\"><p><b>\u00b7 \u542f\u7528\u81ea\u52a8\u68c0\u67e5\u66f4\u65b0</b><br/>\r\n-                      <span class=\"note\">&nbsp;&nbsp;\u5728\u8fdb\u5165\u540e\u53f0\u65f6\u4f1a\u68c0\u67e5\u5e94\u7528\u66f4\u65b0\u548c\u7cfb\u7edf\u66f4\u65b0 </span></p></td>\r\n-                  <td><input id=\"app_enabledcheck\" name=\"app_enabledcheck\" type=\"text\" value=\"<?php echo $zbp->Config('AppCentre')->enabledcheck;?>\" class=\"checkbox\"/></td>\r\n-                </tr>\r\n-                <tr height=\"32\">\r\n-                  <td width=\"30%\" align=\"left\"><p><b>\u00b7 \u68c0\u67e5Beta\u7248\u7a0b\u5e8f</b><br/>\r\n-                      <span class=\"note\">&nbsp;&nbsp;\u82e5\u6253\u5f00\uff0c\u5219\u7cfb\u7edf\u5c06\u68c0\u67e5\u6700\u65b0\u6d4b\u8bd5\u7248\u7684Z-Blog\u66f4\u65b0</span></p></td>\r\n-                  <td><input id=\"app_checkbeta\" name=\"app_checkbeta\" type=\"text\" value=\"<?php echo $zbp->Config('AppCentre')->checkbeta;?>\" class=\"checkbox\"/></td>\r\n-                </tr>\r\n-                <tr height=\"32\">\r\n-                  <td width=\"30%\" align=\"left\"><p><b>\u00b7 \u542f\u7528\u5f00\u53d1\u8005\u6a21\u5f0f</b><br/>\r\n-                      <span class=\"note\">&nbsp;&nbsp;\u542f\u7528\u5f00\u53d1\u8005\u6a21\u5f0f\u53ef\u4ee5\u4fee\u6539\u5e94\u7528\u4fe1\u606f\u3001\u5bfc\u51fa\u5e94\u7528\u548c\u8fdc\u7a0b\u63d0\u4ea4\u5e94\u7528</span></p></td>\r\n-                  <td><input id=\"app_enabledevelop\" name=\"app_enabledevelop\" type=\"text\" value=\"<?php echo $zbp->Config('AppCentre')->enabledevelop;?>\" class=\"checkbox\"/></td>\r\n-                </tr>\r\n-                <tr height=\"32\">\r\n-                  <td width=\"30%\" align=\"left\"><p><b>\u00b7 \u5bfc\u51fa\u7ecf\u8fc7GZip\u538b\u7f29\u7684\u5e94\u7528\u5305</b><br/>\r\n-                      <span class=\"note\">&nbsp;&nbsp;1.4\u4ee5\u4e0b\u7248\u672c\u4e0d\u652f\u6301\u5e94\u7528\u538b\u7f29\u5305\u5bfc\u5165\u53ca\u5bfc\u51fa</span></p></td>\r\n-                  <td><input id=\"app_enablegzipapp\" name=\"app_enablegzipapp\" type=\"text\" value=\"<?php echo $zbp->Config('AppCentre')->enablegzipapp;?>\" class=\"checkbox\"/></td>\r\n-                </tr>\r\n-              </table>\r\n-              <hr/>\r\n-              <p>\r\n-                <input type=\"submit\" value=\"\u63d0\u4ea4\" class=\"button\" />\r\n-              </p>\r\n-              <hr/>\r\n-            </form>\r\n-\r\n-\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-\r\n-\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/submit.php",
          "status": "removed",
          "additions": 0,
          "deletions": 103,
          "patch": "@@ -1,103 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u63d0\u4ea4\u5e94\u7528';\r\n-\r\n-$s = '';\r\n-$t = '';\r\n-\r\n-$app = New App;\r\n-$app->LoadInfoByXml($_GET['type'], $_GET['id']);\r\n-\r\n-$t['id'] = $app->id;\r\n-$t['author'] = $app->author_name;\r\n-$t['modified'] = $app->modified;\r\n-\r\n-$t = json_encode($t);\r\n-\r\n-if ($_SERVER['REQUEST_METHOD'] == 'GET') {\r\n-\t$s = Server_Open('submitpre');\r\n-}\r\n-\r\n-if ($_SERVER['REQUEST_METHOD'] == 'POST') {\r\n-\t$url = Server_Open('submit');\r\n-\tif (substr($url, 0, 4) == 'http') {\r\n-\t\tRedirect($url);\r\n-\t} else {\r\n-\t\techo '<script type=\"text/javascript\">alert(\\'' . $url . '\\')</script>';\r\n-\t}\r\n-}\r\n-\r\n-if (!$s) {\r\n-\t$s = '{\"id\":\"\u672a\u63d0\u4ea4\",\"author\":\"\u672a\u63d0\u4ea4\",\"modified\":\"\u672a\u63d0\u4ea4\"}';\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus('');?></div>\r\n-  <div id=\"divMain2\">\r\n-\r\n-\r\n-<form method=\"post\" action=\"\">\r\n-<table class=\"tableFull tableBorder tableBorder-thcenter\">\r\n-<tr><th colspan=\"2\">&nbsp;\u62df\u63d0\u4ea4\u53d1\u5e03\u6216\u66f4\u65b0\u7684\u5e94\u7528\u4fe1\u606f<a href=\"<?php echo GetVars('type', 'GET') == 'plugin' ? 'plugin' : 'theme'?>_edit.php?id=<?php echo $app->id?>\">[\u7f16\u8f91]</a></th></tr>\r\n-\r\n-<tr><td class=\"td30\"><p><b>\u00b7 \u5e94\u7528ID</b></p></td><td><p>&nbsp;<input id=\"local_app_id\" name=\"local_app_id\" style=\"width:550px;\"  type=\"text\" value=\"\" readonly /></p></td></tr>\r\n-<tr><td><p><b>\u00b7 \u5e94\u7528\u6587\u4ef6\u540d</b></p></td><td><p>&nbsp;<input id=\"local_app_user\" name=\"local_app_user\" style=\"width:550px;\"  type=\"text\" value=\"\" readonly /></p></td></tr>\r\n-<tr><td><p><b>\u00b7 \u6700\u540e\u66f4\u65b0\u65e5\u671f</b></p></td><td><p>&nbsp;<input id=\"local_app_date\" name=\"local_app_date\" style=\"width:550px;\"  type=\"text\" value=\"\" readonly /></p></td></tr>\r\n-</table>\r\n-\r\n-\r\n-<table class=\"tableFull tableBorder tableBorder-thcenter\">\r\n-<tr><th colspan=\"2\">&nbsp;\u201cZ-Blog\u5e94\u7528\u4e2d\u5fc3\u201d\u76ee\u6807\u5e94\u7528\u7684\u76f8\u5173\u4fe1\u606f</th></tr>\r\n-<tr><td class=\"td30\"><p><b>\u00b7 \u5e94\u7528\u53d1\u5e03ID</b></p></td><td><p>&nbsp;<input id=\"zblog_app_id\" name=\"zblog_app_id\" style=\"width:550px;\"  type=\"text\" value=\"\" readonly /></p></td></tr>\r\n-<tr><td><p><b>\u00b7 \u5e94\u7528\u63d0\u4ea4\u7528\u6237</b></p></td><td><p>&nbsp;<input id=\"zblog_app_user\" name=\"zblog_app_user\" style=\"width:550px;\"  type=\"text\" value=\"\" readonly /></p></td></tr>\r\n-<tr><td><p><b>\u00b7 \u6700\u540e\u66f4\u65b0\u65e5\u671f</b></p></td><td><p>&nbsp;<input id=\"zblog_app_date\" name=\"zblog_app_date\" style=\"width:550px;\"  type=\"text\" value=\"\" readonly /></p></td></tr>\r\n-</table>\r\n-<script type=\"text/javascript\">\r\n-var jsoninfo=eval(<?php echo $t;?>);\r\n-$(\"#local_app_id\").val(jsoninfo.id);\r\n-$(\"#local_app_user\").val(jsoninfo.author);\r\n-$(\"#local_app_date\").val(jsoninfo.modified);\r\n-\r\n-var jsoninfo=eval(<?php echo $s;?>);\r\n-$(\"#zblog_app_id\").val(jsoninfo.id);\r\n-$(\"#zblog_app_user\").val(jsoninfo.author);\r\n-$(\"#zblog_app_date\").val(jsoninfo.modified);\r\n-</script>\r\n-\r\n-\r\n-<p> \u63d0\u793a:\u91d1\u724c\u5f00\u53d1\u8005\u3001\u94f6\u724c\u5f00\u53d1\u8005\u3001\u94dc\u724c\u5f00\u53d1\u8005\u548c\u94c1\u724c\u5f00\u53d1\u8005\u53ea\u80fd\u66f4\u65b0\u548c\u63d0\u4ea4\u81ea\u5df1\u7684\u5e94\u7528,\u767d\u91d1\u5f00\u53d1\u8005\u53ef\u4ee5\u66f4\u65b0\u548c\u63d0\u4ea4\u6240\u6709\u5e94\u7528.</p>\r\n-<p><br/><input type=\"submit\" class=\"button\" value=\"\u63d0\u4ea4\" id=\"btnPost\" onclick='return confirm(\"\u60a8\u786e\u5b9a\u8981\u63d0\u4ea4\u5417\uff1f\")' /></p><p>&nbsp;</p>\r\n-\r\n-\r\n-</form>\r\n-\r\n-\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-\r\n-\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/theme.js.php",
          "status": "removed",
          "additions": 0,
          "deletions": 47,
          "patch": "@@ -1,47 +0,0 @@\n-<?php\n-require '../../../zb_system/function/c_system_base.php';\n-\n-require '../../../zb_system/function/c_system_admin.php';\n-\n-require dirname(__FILE__) . '/function.php';\n-\n-$zbp->Load();\n-?>\n-\n-$(document).ready(function(){ \n-\n-$(\"#divMain2\").prepend(\"<form class='search' name='edit' id='edit' method='post' enctype='multipart/form-data' action='\"+bloghost+\"zb_users/plugin/AppCentre/app_upload.php?token=<?php echo $zbp->GetToken();?>'><p>\u672c\u5730\u4e0a\u4f20\u5e76\u5b89\u88c5\u4e3b\u9898zba\u6587\u4ef6:&nbsp;<input type='file' id='edtFileLoad' name='edtFileLoad' size='40' />&nbsp;&nbsp;&nbsp;&nbsp;<input type='submit' class='button' value='\u63d0\u4ea4' name='B1' />&nbsp;&nbsp;<input class='button' type='reset' value='\u91cd\u7f6e' name='B2' />&nbsp;</p></form>\");\n-\n-\n-\n-$(\".theme\").each(function(){\n-\tvar t=$(this).find(\"strong\").html();\n-\tvar s=\"<p>\";\n-\n-\tif(app_enabledevelop){\n-\n-\ts=s+\"<a class=\\\"button\\\" href='\"+bloghost+\"zb_users/plugin/AppCentre/theme_edit.php?id=\"+t+\"' title='\u7f16\u8f91\u8be5\u4e3b\u9898\u4fe1\u606f'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/application_edit.png'/></a>&nbsp;&nbsp;&nbsp;&nbsp;\";\n-\n-\ts=s+\"<a class=\\\"button\\\" href='\"+bloghost+\"zb_users/plugin/AppCentre/app_pack.php?type=theme&id=\"+t+\"' title='\u5bfc\u51fa\u8be5\u4e3b\u9898' target='_blank'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/download.png'/></a>&nbsp;&nbsp;&nbsp;&nbsp;\";\n-\n-\t}\n-\n-\tif($(this).hasClass(\"theme-now\")){\n-\t\ts=s+\"<a class=\\\"button\\\" href='\"+bloghost+\"zb_system/admin/module_edit.php?source=theme' title='\u7ed9\u8be5\u4e3b\u9898\u589e\u52a0\u4fa7\u680f\u6a21\u5757'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/bricks.png'/></a>&nbsp;&nbsp;&nbsp;&nbsp;\";\n-\t}\n-\n-\n-\tif($(this).hasClass(\"theme-other\")){\n-\t\ts=s+\"<a class=\\\"button\\\" href='\"+bloghost+\"zb_users/plugin/AppCentre/app_del.php?type=theme&id=\"+t+\"' title='\u5220\u9664\u8be5\u4e3b\u9898' onclick='return window.confirm(\\\"\u5355\u51fb\u201c\u786e\u5b9a\u201d\u7ee7\u7eed\u3002\u5355\u51fb\u201c\u53d6\u6d88\u201d\u505c\u6b62\u3002\\\");'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/delete.png'/></a>&nbsp;&nbsp;&nbsp;&nbsp;\";\n-\t}\n-\n-\tif(app_enabledevelop&&app_username){\n-\t\ts=s+\"<a class=\\\"button\\\" href='\"+bloghost+\"zb_users/plugin/AppCentre/submit.php?type=theme&amp;id=\"+t+\"' title='\u4e0a\u4f20\u5e94\u7528\u5230\u5b98\u65b9\u7f51\u7ad9\u5e94\u7528\u4e2d\u5fc3' target='_blank'><img height='16' width='16' src='\"+bloghost+\"zb_users/plugin/AppCentre/images/drive-upload.png'/></a>\";\n-\t}\n-\n-\ts=s+\"</p>\";\n-\t$(this).append(s);\n-\t\n-});\n-\n-});\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/theme_edit.php",
          "status": "removed",
          "additions": 0,
          "deletions": 363,
          "patch": "@@ -1,363 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u4e3b\u9898\u7f16\u8f91';\r\n-\r\n-if (GetVars('id')) {\r\n-\t$app = $zbp->LoadApp('theme', GetVars('id'));\r\n-\t$mt = array();\r\n-\t$ft = GetFilesInDir($zbp->path . '/zb_users/theme/' . $app->id . '/', 'php|inc|png');\r\n-\tforeach ($ft as $f) {\r\n-\t\t$mt[] = filemtime($f);\r\n-\t}\r\n-\t$ft = GetFilesInDir($zbp->path . '/zb_users/theme/' . $app->id . '/include/', 'php|inc|png');\r\n-\tforeach ($ft as $f) {\r\n-\t\t$mt[] = filemtime($f);\r\n-\t}\r\n-\t$ft = GetFilesInDir($zbp->path . '/zb_users/theme/' . $app->id . '/style/', 'php|inc|png');\r\n-\tforeach ($ft as $f) {\r\n-\t\t$mt[] = filemtime($f);\r\n-\t}\r\n-\t$ft = GetFilesInDir($zbp->path . '/zb_users/theme/' . $app->id . '/template/', 'php|inc|png');\r\n-\tforeach ($ft as $f) {\r\n-\t\t$mt[] = filemtime($f);\r\n-\t}\r\n-\t$ft = GetFilesInDir($zbp->path . '/zb_users/theme/' . $app->id . '/source/', 'php|inc|png');\r\n-\tforeach ($ft as $f) {\r\n-\t\t$mt[] = filemtime($f);\r\n-\t}\r\n-\trsort($mt);\r\n-\tif (count($mt) == 0) {\r\n-\t\t$mt[] = time();\r\n-\t}\r\n-\r\n-\t$app->modified = date('Y-m-d', reset($mt));\r\n-} else {\r\n-\t$app = new App;\r\n-\t$app->price = 0;\r\n-\t$app->version = '1.0';\r\n-\t$app->pubdate = date('Y-m-d', time());\r\n-\t$app->modified = date('Y-m-d', time());\r\n-\t$v = array_keys($zbpvers);\r\n-\t$app->adapted = (string) end($v);\r\n-\t$app->type = 'theme';\r\n-}\r\n-\r\n-if (count($_POST) > 0) {\r\n-\r\n-\t$app->id = trim($_POST['app_id']);\r\n-\tif (!CheckRegExp($app->id, \"/^[A-Za-z0-9_]{3,30}/\")) {$zbp->ShowError('ID\u540d\u5fc5\u987b\u662f\u5b57\u6bcd\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210,\u957f\u5ea63-30\u5b57\u7b26.');die();}\r\n-\tif (!GetVars('id')) {\r\n-\t\t$app2 = $zbp->LoadApp('theme', $app->id);\r\n-\t\tif ($app2->id) {$zbp->ShowError('\u5df2\u5b58\u5728\u540c\u540d\u7684APP\u5e94\u7528.');die();}\r\n-\t\t@mkdir($zbp->usersdir . 'theme/' . $app->id);\r\n-\t\t@mkdir($zbp->usersdir . 'theme/' . $app->id . '/style');\r\n-\t\t//@mkdir($zbp->usersdir . 'theme/' . $app->id . '/compile');\r\n-\t\t@mkdir($zbp->usersdir . 'theme/' . $app->id . '/template');\r\n-\t\t@copy($zbp->usersdir . 'plugin/AppCentre/images/theme.png', $zbp->usersdir . 'theme/' . $app->id . '/screenshot.png');\r\n-\t\t@file_put_contents($zbp->usersdir . 'theme/' . $app->id . '/style/style.css', '');\r\n-\r\n-\t\tif (trim($_POST['app_path'])) {\r\n-\t\t\t$file = file_get_contents('tpl/main.html');\r\n-\t\t\t$file = str_replace(\"<%appid%>\", $app->id, $file);\r\n-\t\t\t$path = $zbp->usersdir . 'theme/' . $app->id . '/' . trim($_POST['app_path']);\r\n-\t\t\t@file_put_contents($path, $file);\r\n-\t\t}\r\n-\t\tif (trim($_POST['app_include'])) {\r\n-\t\t\t$file = file_get_contents('tpl/include.html');\r\n-\t\t\t$file = str_replace(\"<%appid%>\", $app->id, $file);\r\n-\t\t\t$path = $zbp->usersdir . 'theme/' . $app->id . '/include.php';\r\n-\t\t\t@file_put_contents($path, $file);\r\n-\t\t}\r\n-\t}\r\n-\r\n-\t$app->name = trim($_POST['app_name']);\r\n-\t$app->url = trim($_POST['app_url']);\r\n-\t$app->note = trim($_POST['app_note']);\r\n-\t$app->adapted = $_POST['app_adapted'];\r\n-\t$app->version = (float) $_POST['app_version'];\r\n-\tif ($app->version == 1) {\r\n-\t\t$app->version = '1.0';\r\n-\t}\r\n-\r\n-\t$app->pubdate = date('Y-m-d', strtotime($_POST['app_pubdate']));\r\n-\t$app->modified = date('Y-m-d', time());\r\n-\r\n-\t$app->author_name = trim($_POST['app_author_name']);\r\n-\t$app->author_email = trim($_POST['app_author_email']);\r\n-\t$app->author_url = trim($_POST['app_author_url']);\r\n-\t$app->source_name = trim($_POST['app_source_name']);\r\n-\t$app->source_email = trim($_POST['app_source_email']);\r\n-\t$app->source_url = trim($_POST['app_source_url']);\r\n-\r\n-\t$app->path = trim($_POST['app_path']);\r\n-\t$app->include = trim($_POST['app_include']);\r\n-\t$app->level = (int) $_POST['app_level'];\r\n-\t$app->price = (float) $_POST['app_price'];\r\n-\r\n-\t$app->advanced_dependency = trim($_POST['app_advanced_dependency']);\r\n-\t$app->advanced_rewritefunctions = trim($_POST['app_advanced_rewritefunctions']);\r\n-\t$app->advanced_conflict = trim($_POST['app_advanced_conflict']);\r\n-\r\n-\t$app->description = trim($_POST['app_description']);\r\n-\r\n-\tif (GetVars('app_sidebars_sidebar1')) {\r\n-\t\t$app->sidebars_sidebar1 = $zbp->option['ZC_SIDEBAR_ORDER'];\r\n-\t} else {\r\n-\t\t$app->sidebars_sidebar1 = '';\r\n-\t}\r\n-\tif (GetVars('app_sidebars_sidebar2')) {\r\n-\t\t$app->sidebars_sidebar2 = $zbp->option['ZC_SIDEBAR2_ORDER'];\r\n-\t} else {\r\n-\t\t$app->sidebars_sidebar2 = '';\r\n-\t}\r\n-\tif (GetVars('app_sidebars_sidebar3')) {\r\n-\t\t$app->sidebars_sidebar3 = $zbp->option['ZC_SIDEBAR3_ORDER'];\r\n-\t} else {\r\n-\t\t$app->sidebars_sidebar3 = '';\r\n-\t}\r\n-\tif (GetVars('app_sidebars_sidebar4')) {\r\n-\t\t$app->sidebars_sidebar4 = $zbp->option['ZC_SIDEBAR4_ORDER'];\r\n-\t} else {\r\n-\t\t$app->sidebars_sidebar4 = '';\r\n-\t}\r\n-\tif (GetVars('app_sidebars_sidebar5')) {\r\n-\t\t$app->sidebars_sidebar5 = $zbp->option['ZC_SIDEBAR5_ORDER'];\r\n-\t} else {\r\n-\t\t$app->sidebars_sidebar5 = '';\r\n-\t}\r\n-\r\n-\t$app->SaveInfoByXml();\r\n-\r\n-\t$zbp->SetHint('good', '\u63d0\u4ea4\u6210\u529f\uff01<a href=\"submit.php?type=theme&id=' . $app->id . '\">\u73b0\u5728\u7acb\u523b\u4e0a\u4f20\u5230\u5e94\u7528\u4e2d\u5fc3\uff01</a>');\r\n-\tRedirect($_SERVER[\"HTTP_REFERER\"]);\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus(GetVars('id', 'GET') == '' ? 6 : '');?></div>\r\n-  <div id=\"divMain2\">\r\n-\r\n-<form method=\"post\" action=\"\">\r\n-  <table border=\"1\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" class=\"tableBorder tableBorder-thcenter\">\r\n-    <tr>\r\n-      <th width='28%'>&nbsp;</th>\r\n-      <th>&nbsp;</th>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898ID</b><br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u4e3b\u9898ID\u4e3a\u4e3b\u9898\u7684\u76ee\u5f55\u540d,\u4e14\u4e0d\u80fd\u91cd\u590d.ID\u540d\u53ea\u80fd\u7528\u5b57\u6bcd\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7684\u7ec4\u5408.</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_id\" name=\"app_id\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->id;?>\" <?php if ($app->id) {\r\n-\techo 'readonly=\"readonly\"';\r\n-}\r\n-?>  />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u540d\u79f0</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_name\" name=\"app_name\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->name;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u53d1\u5e03\u9875\u9762</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_url\" name=\"app_url\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->url;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u7b80\u4ecb</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_note\" name=\"app_note\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->note;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u9002\u7528\u7684\u6700\u4f4e\u8981\u6c42 Z-Blog \u7248\u672c</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <select name=\"app_adapted\" id=\"app_adapted\" style=\"width:400px;\">\r\n-<?php echo AppCentre_CreateOptoinsOfVersion($app->adapted);?>\r\n-          </select>\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u7248\u672c\u53f7</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_version\" name=\"app_version\" style=\"width:550px;\" type=\"number\" step=\"0.1\" value=\"<?php echo $app->version;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u9996\u53d1\u65f6\u95f4</b><br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u65e5\u671f\u683c\u5f0f\u4e3a2012-12-12</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_pubdate\" name=\"app_pubdate\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->pubdate;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u6700\u540e\u4fee\u6539\u65f6\u95f4</b><br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u7cfb\u7edf\u81ea\u52a8\u68c0\u67e5\u76ee\u5f55\u5185\u6587\u4ef6\u7684\u6700\u540e\u4fee\u6539\u65e5\u671f</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_modified\" name=\"app_modified\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->modified;?>\" readonly=\"readonly\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4f5c\u8005\u540d\u79f0</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_author_name\" name=\"app_author_name\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->author_name;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4f5c\u8005\u90ae\u7bb1</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_author_email\" name=\"app_author_email\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->author_email;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4f5c\u8005\u7f51\u7ad9</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_author_url\" name=\"app_author_url\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->author_url;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u6e90\u4f5c\u8005\u540d\u79f0</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_source_name\" name=\"app_source_name\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->source_name;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u6e90\u4f5c\u8005\u90ae\u7bb1</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_source_email\" name=\"app_source_email\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->source_email;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u6e90\u4f5c\u8005\u7f51\u7ad9</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_source_url\" name=\"app_source_url\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->source_url;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u5185\u7f6e\u63d2\u4ef6\u7ba1\u7406\u9875</b> (\u53ef\u9009)<br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u4e60\u60ef\u547d\u540d\u4e3amain.php</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_path\" name=\"app_path\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->path;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u5185\u7f6e\u63d2\u4ef6\u5d4c\u5165\u9875</b> (\u53ef\u9009)<br/>\r\n-          <span class=\"note\">&nbsp;&nbsp;\u53ea\u80fd\u547d\u540d\u4e3ainclude.php</span></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_include\" name=\"app_include\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->include;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u5185\u7f6e\u63d2\u4ef6\u7ba1\u7406\u6743\u9650</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <select name=\"app_level\" id=\"app_level\" style=\"width:200px;\">\r\n-<?php echo CreateOptoinsOfMemberLevel(1)?>\r\n-          </select>\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4e3b\u9898\u5b9a\u4ef7</b></p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_price\" name=\"app_price\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->price;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u3010\u9ad8\u7ea7\u3011\u4f9d\u8d56\u63d2\u4ef6\uff08\u4ee5|\u5206\u9694\uff09</b>(\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_advanced_dependency\" name=\"app_advanced_dependency\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->advanced_dependency;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr style=\"display:none;\">\r\n-      <td><p><b>\u00b7 \u3010\u9ad8\u7ea7\u3011\u5185\u7f6e\u63d2\u4ef6\u91cd\u5199\u7cfb\u7edf\u51fd\u6570\u5217\u8868\uff08\u4ee5|\u5206\u9694\uff09</b>(\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_advanced_rewritefunctions\" name=\"app_advanced_rewritefunctions\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->advanced_rewritefunctions;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u3010\u9ad8\u7ea7\u3011\u5185\u7f6e\u63d2\u4ef6\u51b2\u7a81\u63d2\u4ef6\u5217\u8868\uff08\u4ee5|\u5206\u9694\uff09</b>(\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <input id=\"app_advanced_conflict\" name=\"app_advanced_conflict\" style=\"width:550px;\"  type=\"text\" value=\"<?php echo $app->advanced_conflict;?>\" />\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u8be6\u7ec6\u8bf4\u660e</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <textarea cols=\"3\" rows=\"6\" id=\"app_description\" name=\"app_description\" style=\"width:550px;\"><?php echo htmlspecialchars($app->description);?></textarea>\r\n-        </p></td>\r\n-    </tr>\r\n-    <tr>\r\n-      <td><p><b>\u00b7 \u4fa7\u680f\u914d\u7f6e\u5bfc\u51fa</b> (\u53ef\u9009)</p></td>\r\n-      <td><p>&nbsp;\r\n-          <label>\r\n-            <input type=\"checkbox\" name=\"app_sidebars_sidebar1\" value=\"1\" <?php if ($app->sidebars_sidebar1) {\r\n-\techo 'checked=\"checked\"';\r\n-}\r\n-?>  />\r\n-            \u4fa7\u680f</label>\r\n-          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n-          <label>\r\n-            <input type=\"checkbox\" name=\"app_sidebars_sidebar2\" value=\"1\" <?php if ($app->sidebars_sidebar2) {\r\n-\techo 'checked=\"checked\"';\r\n-}\r\n-?>   />\r\n-            \u4fa7\u680f2</label>\r\n-          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n-          <label>\r\n-            <input type=\"checkbox\" name=\"app_sidebars_sidebar3\" value=\"1\" <?php if ($app->sidebars_sidebar3) {\r\n-\techo 'checked=\"checked\"';\r\n-}\r\n-?>   />\r\n-            \u4fa7\u680f3</label>\r\n-          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n-          <label>\r\n-            <input type=\"checkbox\" name=\"app_sidebars_sidebar4\" value=\"1\" <?php if ($app->sidebars_sidebar4) {\r\n-\techo 'checked=\"checked\"';\r\n-}\r\n-?>   />\r\n-            \u4fa7\u680f4</label>\r\n-          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n-          <label>\r\n-            <input type=\"checkbox\" name=\"app_sidebars_sidebar5\" value=\"1\" <?php if ($app->sidebars_sidebar5) {\r\n-\techo 'checked=\"checked\"';\r\n-}\r\n-?>   />\r\n-            \u4fa7\u680f5</label>\r\n-          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p></td>\r\n-    </tr>\r\n-  </table>\r\n-  <p> \u63d0\u793a:\u4e3b\u9898\u7684\u7f29\u7565\u56fe\u662f\u540d\u4e3ascreenshot.png\u7684<b>300x240px</b>\u5927\u5c0f\u7684png\u6587\u4ef6,\u653e\u5728\u63d2\u4ef6\u7684\u76ee\u5f55\u4e0b.</p>\r\n-  <p><br/>\r\n-    <input type=\"submit\" class=\"button\" value=\"\u63d0\u4ea4\" id=\"btnPost\" onclick='' />\r\n-  </p>\r\n-  <p>&nbsp;</p>\r\n-</form>\r\n-\r\n-\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/tpl/include.html",
          "status": "removed",
          "additions": 0,
          "deletions": 7,
          "patch": "@@ -1,7 +0,0 @@\n-<?php\r\n-#\u6ce8\u518c\u63d2\u4ef6\r\n-RegisterPlugin(\"<%appid%>\",\"ActivePlugin_<%appid%>\");\r\n-\r\n-function ActivePlugin_<%appid%>() {}\r\n-function InstallPlugin_<%appid%>() {}\r\n-function UninstallPlugin_<%appid%>() {}\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/tpl/main.html",
          "status": "removed",
          "additions": 0,
          "deletions": 25,
          "patch": "@@ -1,25 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-$zbp->Load();\r\n-$action='root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-if (!$zbp->CheckPlugin('<%appid%>')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle='<%appid%>';\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-?>\r\n-<div id=\"divMain\">\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-  <div class=\"SubMenu\">\r\n-  </div>\r\n-  <div id=\"divMain2\">\r\n-<!--\u4ee3\u7801-->\r\n-  </div>\r\n-</div>\r\n-\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        },
        {
          "filename": "zb_users/plugin/AppCentre/update.php",
          "status": "removed",
          "additions": 0,
          "deletions": 235,
          "patch": "@@ -1,235 +0,0 @@\n-<?php\r\n-require '../../../zb_system/function/c_system_base.php';\r\n-\r\n-require '../../../zb_system/function/c_system_admin.php';\r\n-\r\n-require dirname(__FILE__) . '/function.php';\r\n-\r\n-$zbp->Load();\r\n-\r\n-$action = 'root';\r\n-if (!$zbp->CheckRights($action)) {$zbp->ShowError(6);die();}\r\n-\r\n-if (!$zbp->CheckPlugin('AppCentre')) {$zbp->ShowError(48);die();}\r\n-\r\n-$blogtitle = '\u5e94\u7528\u4e2d\u5fc3-\u7cfb\u7edf\u66f4\u65b0\u4e0e\u6821\u9a8c';\r\n-\r\n-$checkbegin = false;\r\n-$nowxml = '';\r\n-\r\n-function updatedb_14() {\r\n-\tglobal $zbp, $table;\r\n-\r\n-\tif ($zbp->db->type == 'mysql') {\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Post'] . \" DROP INDEX  \" . $zbp->db->dbpre . \"log_TISC ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Post'] . \" DROP INDEX  \" . $zbp->db->dbpre . \"log_PT ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Post'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"log_TPISC(log_Type,log_PostTime,log_IsTop,log_Status,log_CateID) ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Comment'] . \" DROP INDEX  \" . $zbp->db->dbpre . \"comm_PT ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Comment'] . \" DROP INDEX  \" . $zbp->db->dbpre . \"comm_RIL ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Comment'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"comm_LRI(comm_LogID,comm_RootID,comm_IsChecking) ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Comment'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"comm_IsChecking(comm_IsChecking) ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Category'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"cate_Order(cate_Order) ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Member'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"mem_Alias(mem_Alias) ;\");\r\n-\t\t$zbp->db->Query(\"ALTER TABLE \" . $table['Member'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"mem_Level(mem_Level) ;\");\r\n-\t} elseif ($zbp->db->type == 'sqlite') {\r\n-\t\t$zbp->db->Query(\"CREATE INDEX \" . $zbp->db->dbpre . \"cate_Order on \" . $table['Category'] . \"(cate_Order) ;\");\r\n-\t\t$zbp->db->Query(\"CREATE INDEX \" . $zbp->db->dbpre . \"mem_Alias on \" . $table['Member'] . \"(mem_Alias) ;\");\r\n-\t}\r\n-\tif ($zbp->db->type == 'mysql' || $zbp->db->type == 'sqlite') {\r\n-\t\t$zbp->db->DelTable($GLOBALS['table']['Config']);\r\n-\t\t$s = $zbp->db->sql->CreateTable($GLOBALS['table']['Config'], $GLOBALS['datainfo']['Config']);\r\n-\t\t$zbp->db->QueryMulit($s);\r\n-\t\tif ($zbp->db->type == 'mysql') {\r\n-\t\t\t$zbp->db->Query(\"ALTER TABLE \" . $GLOBALS['table']['Config'] . \" ADD INDEX  \" . $zbp->db->dbpre . \"conf_Name(conf_Name) ;\");\r\n-\t\t} elseif ($zbp->db->type == 'sqlite') {\r\n-\t\t\t$zbp->db->Query(\"CREATE INDEX \" . $zbp->db->dbpre . \"conf_Name on \" . $GLOBALS['table']['Config'] . \"(conf_Name) ;\");\r\n-\t\t}\r\n-\r\n-\t\tarray_unshift($zbp->configs, $zbp->configs['system'], $zbp->configs['cache']);\r\n-\t\tforeach ($zbp->configs as $c) {\r\n-\t\t\t$c->Save();\r\n-\t\t}\r\n-\t}\r\n-\t$zbp->option['ZC_LAST_VERSION'] = $zbp->version;\r\n-\t$zbp->SaveOption();\r\n-\r\n-\t$zbp->SetHint('good');\r\n-\tRedirect('./update.php?ok');return;\r\n-}\r\n-if (isset($_GET['updatedb'])) {\r\n-\tif ($zbp->version >= 150101 && (int) $zbp->option['ZC_LAST_VERSION'] < 150101) {\r\n-\t\tupdatedb_14();\r\n-\t}\r\n-\r\n-}\r\n-if (GetVars('update', 'GET') != '') {\r\n-\t$url = APPCENTRE_SYSTEM_UPDATE . '?' . GetVars('update', 'GET') . '.xml';\r\n-\t$f = AppCentre_GetHttpContent($url);\r\n-\t$xml = simplexml_load_string($f);\r\n-\tif ($xml) {\r\n-\t\tforeach ($xml->children() as $file) {\r\n-\t\t\t$full = $zbp->path . str_replace('\\\\', '/', $file['name']);\r\n-\t\t\t$dir = dirname($full);\r\n-\t\t\tif (!file_exists($dir . '/')) {\r\n-\t\t\t\t@mkdir($dir, 0755, true);\r\n-\t\t\t}\r\n-\r\n-\t\t\t$f = base64_decode($file);\r\n-\t\t\t@file_put_contents($full, $f);\r\n-\t\t}\r\n-\t\t$zbp->SetHint('good');\r\n-\t}\r\n-\tRedirect('./update.php?updatedb');\r\n-}\r\n-\r\n-if (GetVars('restore', 'GET') != '') {\r\n-\t$file = base64_decode(GetVars('restore', 'GET'));\r\n-\t$url = APPCENTRE_SYSTEM_UPDATE . '?' . substr(ZC_BLOG_VERSION, -6, 6) . '\\\\' . $file;\r\n-\t$f = AppCentre_GetHttpContent($url);\r\n-\t$file = $zbp->path . str_replace('\\\\', '/', $file);\r\n-\t$dir = dirname($file);\r\n-\tif (!file_exists($dir . '/')) {\r\n-\t\t@mkdir($dir, 0755, true);\r\n-\t}\r\n-\r\n-\t@file_put_contents($file, $f);\r\n-\techo '<img src=\"' . $zbp->host . 'zb_system/image/admin/ok.png\" width=\"16\" alt=\"\" />';\r\n-\tdie();\r\n-}\r\n-\r\n-if (GetVars('check', 'GET') == 'now') {\r\n-\t$r = AppCentre_GetHttpContent(APPCENTRE_SYSTEM_UPDATE . array_search(ZC_BLOG_VERSION, $zbpvers) . '.xml');\r\n-\t//file_put_contents($zbp->usersdir . 'cache/now.xml', $r);\r\n-\t$nowxml = $r;\r\n-\t$checkbegin = true;\r\n-}\r\n-\r\n-require $blogpath . 'zb_system/admin/admin_header.php';\r\n-require $blogpath . 'zb_system/admin/admin_top.php';\r\n-\r\n-$newversion = AppCentre_GetHttpContent(APPCENTRE_SYSTEM_UPDATE . ($zbp->Config('AppCentre')->checkbeta == true ? '?beta' : ''));\r\n-\r\n-?>\r\n-<div id=\"divMain\">\r\n-\r\n-  <div class=\"divHeader\"><?php echo $blogtitle;?></div>\r\n-<div class=\"SubMenu\"><?php AppCentre_SubMenus(3);?></div>\r\n-  <div id=\"divMain2\">\r\n-\r\n-            <form method=\"post\" action=\"\">\r\n-\r\n-<p>\r\n-<?php\r\n-if ($zbp->version >= 150101 && (int) $zbp->option['ZC_LAST_VERSION'] < 150101) {\r\n-\techo '<input id=\"updatenow\" type=\"button\" onclick=\"location.href=\\'?updatedb\\'\" value=\"\u5347\u7ea7\u6570\u636e\u5e93\u7ed3\u6784\" />';\r\n-}\r\n-\r\n-?>\r\n-\t\t\t  </p><hr/>\r\n-\r\n-              <table border=\"1\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" class=\"tableBorder tableBorder-thcenter\">\r\n-                <tr>\r\n-                  <th width='50%'>\u5f53\u524d\u7248\u672c</th>\r\n-                  <th>\u6700\u65b0\u7248\u672c</th>\r\n-                </tr>\r\n-                <tr>\r\n-                  <td align='center' id='now'>Z-BlogPHP <?php echo ZC_BLOG_VERSION?></td>\r\n-                  <td align='center' id='last'>Z-BlogPHP <?php echo $newversion;?></td>\r\n-                </tr>\r\n-              </table>\r\n-              <p>\r\n-\r\n-<?php\r\n-\r\n-$nowbuild = (int) $blogversion;\r\n-$newbuild = (int) substr($newversion, -6, 6);\r\n-\r\n-if ($newbuild - $nowbuild > 0) {\r\n-\techo '<input id=\"updatenow\" type=\"button\" onclick=\"location.href=\\'?update=' . $nowbuild . '-' . $newbuild . '\\'\" value=\"\u5347\u7ea7\u65b0\u7248\u7a0b\u5e8f\" />';\r\n-}\r\n-?>\r\n-              </p>\r\n-\t\t\t  <hr/>\r\n-              <div class=\"divHeader\">\u6821\u9a8c\u5f53\u524d\u7248\u672c\u7684\u7cfb\u7edf\u6838\u5fc3\u6587\u4ef6&nbsp;&nbsp;<span id=\"checknow\"><a href=\"?check=now\" title=\"\u5f00\u59cb\u6821\u9a8c\"><img src=\"images/refresh.png\" width=\"16\" alt=\"\u6821\u9a8c\" /></a></span></div>\r\n-\t\t\t  <!--<div>\u8fdb\u5ea6<span id=\"status\">0</span>%\uff1b\u5df2\u53d1\u73b0<span id=\"count\">0</span>\u4e2a\u4fee\u6539\u8fc7\u7684\u7cfb\u7edf\u6587\u4ef6\u3002<div id=\"bar\"></div></div>-->\r\n-              <table border=\"1\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" class=\"tableBorder tableBorder-thcenter\">\r\n-                <tr>\r\n-                  <th width='78%'>\u6587\u4ef6\u540d</th>\r\n-                  <th id=\"_s\">\u72b6\u6001</th>\r\n-                </tr>\r\n-<?php\r\n-$i = 0;\r\n-//if (file_exists($zbp->usersdir . 'cache/now.xml')) {\r\n-if ($nowxml != '') {\r\n-\r\n-\t$i = 0;\r\n-\tlibxml_use_internal_errors(true);\r\n-\t//$xml=simplexml_load_file($zbp->usersdir . 'cache/now.xml');\r\n-\t$xml = simplexml_load_string($nowxml);\r\n-\tif ($xml) {\r\n-\t\tforeach ($xml->children() as $file) {\r\n-\t\t\tif (file_exists($f = $zbp->path . str_replace('\\\\', '/', $file['name']))) {\r\n-\t\t\t\t$f = file_get_contents($f);\r\n-\t\t\t\t$newcrc32 = substr(strtoupper(dechex(AppCentre_crc32_signed($f))), -8);\r\n-\t\t\t\t$f = str_replace(\"\\n\", \"\\r\\n\", $f);\r\n-\t\t\t\t$newcrc32_2 = substr(strtoupper(dechex(AppCentre_crc32_signed($f))), -8);\r\n-\t\t\t} else {\r\n-\t\t\t\t$newcrc32 = '';\r\n-\t\t\t\t$newcrc32_2 = '';\r\n-\t\t\t}\r\n-\t\t\t//echo PHP_INT_SIZE;\r\n-\t\t\tif (($newcrc32 == $file['crc32']) || ($newcrc32_2 == $file['crc32'])) {\r\n-\t\t\t\techo '<tr style=\"display:none;\"><td><b>' . str_replace('\\\\', '/', $file['name']) . '</b></td>';\r\n-\t\t\t\t$s = '<img src=\"' . $zbp->host . 'zb_system/image/admin/ok.png\" width=\"16\" alt=\"\" />';\r\n-\t\t\t} else {\r\n-\t\t\t\t$i += 1;\r\n-\t\t\t\techo '<tr><td><b>' . str_replace('\\\\', '/', $file['name']) . '</b></td>';\r\n-\t\t\t\t$s = '<a href=\"javascript:void(0)\" onclick=\"restore(\\'' . base64_encode($file['name']) . '\\',\\'file' . md5($file['name']) . '\\')\" class=\"resotrefile button\" title=\"\u8fd8\u539f\u7cfb\u7edf\u6587\u4ef6\"><img src=\"' . $zbp->host . 'zb_system/image/admin/exclamation.png\" width=\"16\" alt=\"\"></a>';\r\n-\t\t\t}\r\n-\t\t\techo '<td class=\"tdCenter\" id=\"file' . md5($file['name']) . '\">' . $s . '</td></tr>';\r\n-\t\t}\r\n-\t}\r\n-\techo '<tr><th colspan=\"2\">' . $i . '\u4e2a\u6587\u4ef6\u4e0d\u540c\u6216\u88ab\u4fee\u6539\u8fc7.</tr>';\r\n-\t//@unlink($zbp->usersdir . 'cache/now.xml');\r\n-}\r\n-?>\r\n-\r\n-              </table>\r\n-<?php if ($i > 0) {?>\r\n-              <p>\r\n-                <input name=\"submit\" type=\"button\" id=\"autorestor\" onclick=\"restoreauto();$(this).hide();\" value=\"\u81ea\u52a8\u4f9d\u6b21\u66f4\u65b0\u6587\u4ef6\" class=\"button\" />\r\n-              </p>\r\n-<?php }\r\n-?>\r\n-              <p> </p>\r\n-            </form>\r\n-<script type=\"text/javascript\">\r\n-\r\n-$(\"#autorestor\").bind('click', function(){restoresingle();$(this).hide()});\r\n-\r\n-function restoresingle(){\r\n-  if($(\"a.resotrefile\").get(0)){\r\n-    $(\"a.resotrefile\").get(0).click();\r\n-    setTimeout(\"restoresingle()\",1000);\r\n-  }\r\n-}\r\n-\r\n-\r\n-function restore(f,id){\r\n-\t$.get(bloghost+\"zb_users/plugin/AppCentre/update.php?restore=\"+f, function(data){\r\n-\t\t//alert(data);\r\n-\t\t$('#'+id).html(data);\r\n-\t});\r\n-}\r\n-</script>\r\n-\t<script type=\"text/javascript\">ActiveLeftMenu(\"aAppCentre\");</script>\r\n-\t<script type=\"text/javascript\">AddHeaderIcon(\"<?php echo $bloghost . 'zb_users/plugin/AppCentre/logo.png';?>\");</script>\r\n-  </div>\r\n-</div>\r\n-\r\n-\r\n-<?php\r\n-require $blogpath . 'zb_system/admin/admin_footer.php';\r\n-\r\n-RunTime();\r\n-?>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a239218821627be3eb9ed5e141b75d136bf602f5",
            "date": "2025-01-02T08:01:38Z",
            "author_login": "rainbowsoft"
          },
          {
            "sha": "1f8f75a3516196a5b20c6790738ea260e56328b5",
            "date": "2024-12-23T13:33:47Z",
            "author_login": "rainbowsoft"
          },
          {
            "sha": "2ccde3bae1d7b1b63438282f02a09439d6a8d6c7",
            "date": "2024-12-23T09:55:03Z",
            "author_login": "rainbowsoft"
          },
          {
            "sha": "070db96bb58cc0ae8b63be5d3e6e379d8f2b9ddd",
            "date": "2024-12-20T05:40:56Z",
            "author_login": "rainbowsoft"
          },
          {
            "sha": "0e171d4aa25dfe42d9a400d7e7907e10b7a460cc",
            "date": "2024-12-20T05:40:29Z",
            "author_login": "rainbowsoft"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "Z-BlogPHP 1.5.1 has CSRF via zb_users/plugin/AppCentre/app_del.php, as demonstrated by deleting files and directories.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-02-06T14:29:00.537",
    "last_modified": "2024-11-21T04:11:04.067",
    "fix_date": "2016-05-30T09:52:56Z"
  },
  "references": [
    {
      "url": "https://github.com/zblogcn/zblogphp/commit/c51da34a27798b5fe6d1cb5133a15da6a6384e43",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zblogcn/zblogphp/issues/175",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zblogcn/zblogphp/commit/c51da34a27798b5fe6d1cb5133a15da6a6384e43",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zblogcn/zblogphp/issues/175",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:15.397452",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "zblogphp",
    "owner": "zblogcn",
    "created_at": "2014-09-15T01:46:16Z",
    "updated_at": "2025-01-10T07:48:17Z",
    "pushed_at": "2025-01-02T08:01:46Z",
    "size": 55071,
    "stars": 823,
    "forks": 258,
    "open_issues": 28,
    "watchers": 823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 2931540,
      "HTML": 1570281,
      "CSS": 586709,
      "JavaScript": 520475,
      "Hack": 245096,
      "Less": 95444,
      "Batchfile": 58
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:44:31.807091"
  }
}