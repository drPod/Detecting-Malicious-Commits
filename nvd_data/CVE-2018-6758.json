{
  "cve_id": "CVE-2018-6758",
  "github_data": {
    "repository": "unbit/uwsgi",
    "fix_commit": "cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe",
    "related_commits": [
      "cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe",
      "cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe"
    ],
    "patch_url": "https://github.com/unbit/uwsgi/commit/cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe.patch",
    "fix_commit_details": {
      "sha": "cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe",
      "commit_date": "2018-02-06T15:01:47Z",
      "author": {
        "login": "unbit",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "improve uwsgi_expand_path() to sanitize input, avoiding stack corruption and potential security issue",
        "length": 101,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
      },
      "files": [
        {
          "filename": "core/utils.c",
          "status": "modified",
          "additions": 8,
          "deletions": 3,
          "patch": "@@ -3674,18 +3674,23 @@ void uwsgi_write_pidfile_explicit(char *pidfile_name, pid_t pid) {\n }\n \n char *uwsgi_expand_path(char *dir, int dir_len, char *ptr) {\n-\tchar src[PATH_MAX + 1];\n-\tmemcpy(src, dir, dir_len);\n-\tsrc[dir_len] = 0;\n+\tif (dir_len > PATH_MAX)\n+\t{\n+\t\tuwsgi_log(\"invalid path size: %d (max %d)\\n\", dir_len, PATH_MAX);\n+\t\treturn NULL;\n+\t}\n+\tchar *src = uwsgi_concat2n(dir, dir_len, \"\", 0);\n \tchar *dst = ptr;\n \tif (!dst)\n \t\tdst = uwsgi_malloc(PATH_MAX + 1);\n \tif (!realpath(src, dst)) {\n \t\tuwsgi_error_realpath(src);\n \t\tif (!ptr)\n \t\t\tfree(dst);\n+\t\tfree(src);\n \t\treturn NULL;\n \t}\n+\tfree(src);\n \treturn dst;\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "89cb161cda959697a4afe013f348b06646b960aa",
            "date": "2024-10-26T09:39:02Z",
            "author_login": "shaform"
          },
          {
            "sha": "9c3be6bbd4049c09b4f12f41c42db451825eaa2a",
            "date": "2024-10-26T09:35:29Z",
            "author_login": "niol"
          },
          {
            "sha": "e77e41b1e6c16db9997482da47ac83e9da7d7440",
            "date": "2024-10-26T09:13:54Z",
            "author_login": "Lalufu"
          },
          {
            "sha": "b738f550fd74ebf77cc966708d26e4f64ce2a7a3",
            "date": "2024-09-15T08:28:59Z",
            "author_login": "xrmx"
          },
          {
            "sha": "621d00619ebdd8d2e73c99c050f890c4b8bb7a19",
            "date": "2024-09-09T10:02:58Z",
            "author_login": "niol"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-787",
    "description": "The uwsgi_expand_path function in core/utils.c in Unbit uWSGI through 2.0.15 has a stack-based buffer overflow via a large directory length.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-02-06T18:29:00.447",
    "last_modified": "2024-11-21T04:11:08.123",
    "fix_date": "2018-02-06T15:01:47Z"
  },
  "references": [
    {
      "url": "http://lists.unbit.it/pipermail/uwsgi/2018-February/008835.html",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/unbit/uwsgi/commit/cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/02/msg00010.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.unbit.it/pipermail/uwsgi/2018-February/008835.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/unbit/uwsgi/commit/cb4636f7c0af2e97a4eef7a3cdcbd85a71247bfe",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/02/msg00010.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:15.399914",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "uwsgi",
    "owner": "unbit",
    "created_at": "2011-10-09T07:25:31Z",
    "updated_at": "2025-01-13T08:12:32Z",
    "pushed_at": "2024-10-26T10:05:23Z",
    "size": 30728,
    "stars": 3474,
    "forks": 694,
    "open_issues": 862,
    "watchers": 3474,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 3382556,
      "Python": 252815,
      "C++": 48190,
      "Perl": 34067,
      "Ruby": 26275,
      "Java": 20982,
      "C#": 15636,
      "Shell": 10796,
      "Go": 7990,
      "Lua": 5782,
      "Clojure": 4006,
      "Objective-C": 1395,
      "HTML": 1273,
      "Makefile": 1030,
      "Erlang": 693,
      "XSLT": 675,
      "PHP": 355,
      "ASP.NET": 130,
      "Starlark": 29
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:02:59.005903"
  }
}