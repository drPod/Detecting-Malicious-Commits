{
  "cve_id": "CVE-2018-7536",
  "github_data": {
    "repository": "django/django",
    "fix_commit": "1ca63a66ef3163149ad822701273e8a1844192c2",
    "related_commits": [
      "1ca63a66ef3163149ad822701273e8a1844192c2",
      "abf89d729f210c692a50e0ad3f75fb6bec6fae16",
      "e157315da3ae7005fa0683ffc9751dbeca7306c8",
      "1ca63a66ef3163149ad822701273e8a1844192c2",
      "abf89d729f210c692a50e0ad3f75fb6bec6fae16",
      "e157315da3ae7005fa0683ffc9751dbeca7306c8"
    ],
    "patch_url": "https://github.com/django/django/commit/1ca63a66ef3163149ad822701273e8a1844192c2.patch",
    "fix_commit_details": {
      "sha": "1ca63a66ef3163149ad822701273e8a1844192c2",
      "commit_date": "2018-02-24T16:30:11Z",
      "author": {
        "login": "timgraham",
        "type": "User",
        "stats": {
          "total_commits": 3481,
          "average_weekly_commits": 3.4160942100098137,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 441
        }
      },
      "commit_message": {
        "title": "[1.8.x] Fixed CVE-2018-7536 -- Fixed catastrophic backtracking in urlize and urlizetrunc template filters.",
        "length": 162,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 37,
        "additions": 35,
        "deletions": 2
      },
      "files": [
        {
          "filename": "django/utils/html.py",
          "status": "modified",
          "additions": 16,
          "deletions": 2,
          "patch": "@@ -30,7 +30,6 @@\n word_split_re = re.compile(r'(\\s+)')\n simple_url_re = re.compile(r'^https?://\\[?\\w', re.IGNORECASE)\n simple_url_2_re = re.compile(r'^www\\.|^(?!http)\\w[^@]+\\.(com|edu|gov|int|mil|net|org)($|/.*)$', re.IGNORECASE)\n-simple_email_re = re.compile(r'^\\S+@\\S+\\.\\S+$')\n link_target_attribute_re = re.compile(r'(<a [^>]*?)target=[^\\s>]+')\n html_gunk_re = re.compile(\n     r'(?:<br clear=\"all\">|<i><\\/i>|<b><\\/b>|<em><\\/em>|<strong><\\/strong>|'\n@@ -304,6 +303,21 @@ def unescape(text, trail):\n             trail = ''\n         return text, unescaped, trail\n \n+    def is_email_simple(value):\n+        \"\"\"Return True if value looks like an email address.\"\"\"\n+        # An @ must be in the middle of the value.\n+        if '@' not in value or value.startswith('@') or value.endswith('@'):\n+            return False\n+        try:\n+            p1, p2 = value.split('@')\n+        except ValueError:\n+            # value contains more than one @.\n+            return False\n+        # Dot must be in p2 (e.g. example.com)\n+        if '.' not in p2 or p2.startswith('.'):\n+            return False\n+        return True\n+\n     words = word_split_re.split(force_text(text))\n     for i, word in enumerate(words):\n         if '.' in word or '@' in word or ':' in word:\n@@ -332,7 +346,7 @@ def unescape(text, trail):\n             elif simple_url_2_re.match(middle):\n                 middle, middle_unescaped, trail = unescape(middle, trail)\n                 url = smart_urlquote('http://%s' % middle_unescaped)\n-            elif ':' not in middle and simple_email_re.match(middle):\n+            elif ':' not in middle and is_email_simple(middle):\n                 local, domain = middle.rsplit('@', 1)\n                 try:\n                     domain = domain.encode('idna').decode('ascii')"
        },
        {
          "filename": "docs/releases/1.8.19.txt",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -5,3 +5,14 @@ Django 1.8.19 release notes\n *March 6, 2018*\n \n Django 1.8.19 fixes two security issues in 1.18.18.\n+\n+CVE-2018-7536: Denial-of-service possibility in ``urlize`` and ``urlizetrunc`` template filters\n+===============================================================================================\n+\n+The ``django.utils.html.urlize()`` function was extremely slow to evaluate\n+certain inputs due to a catastrophic backtracking vulnerability in a regular\n+expression. The ``urlize()`` function is used to implement the ``urlize`` and\n+``urlizetrunc`` template filters, which were thus vulnerable.\n+\n+The problematic regular expression is replaced with parsing logic that behaves\n+similarly."
        },
        {
          "filename": "tests/utils_tests/test_html.py",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -248,3 +248,11 @@ def test_html_safe_doesnt_define_str(self):\n             @html.html_safe\n             class HtmlClass(object):\n                 pass\n+\n+    def test_urlize_unchanged_inputs(self):\n+        tests = (\n+            ('a' + '@a' * 50000) + 'a',  # simple_email_re catastrophic test\n+            ('a' + '.' * 1000000) + 'a',  # trailing_punctuation catastrophic test\n+        )\n+        for value in tests:\n+            self.assertEqual(html.urlize(value), value)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b721f127603516c75ebda6912046ff5f0694e150",
            "date": "2024-10-11T11:44:12Z",
            "author_login": "sarahboyce"
          },
          {
            "sha": "d206d4c200d71c0847e7f6720d88c587e7b46843",
            "date": "2025-01-01T20:27:52Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "f07360e8087d3b403d1d12ff696da3138116055a",
            "date": "2025-01-14T03:04:33Z",
            "author_login": "charettes"
          },
          {
            "sha": "161e79d277ffe8b79b15ad51cb0d23de54270202",
            "date": "2025-01-13T18:55:41Z",
            "author_login": "charettes"
          },
          {
            "sha": "4bfec242b488b174f7d386ab5bbd3363751cdb93",
            "date": "2025-01-13T18:53:57Z",
            "author_login": "charettes"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-185",
    "description": "An issue was discovered in Django 2.0 before 2.0.3, 1.11 before 1.11.11, and 1.8 before 1.8.19. The django.utils.html.urlize() function was extremely slow to evaluate certain inputs due to catastrophic backtracking vulnerabilities in two regular expressions (only one regular expression for Django 1.8.x). The urlize() function is used to implement the urlize and urlizetrunc template filters, which were thus vulnerable.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-09T20:29:00.613",
    "last_modified": "2024-11-21T04:12:19.070",
    "fix_date": "2018-02-24T16:30:11Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/103361",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:2927",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0051",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0082",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0265",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/1ca63a66ef3163149ad822701273e8a1844192c2",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/abf89d729f210c692a50e0ad3f75fb6bec6fae16",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/e157315da3ae7005fa0683ffc9751dbeca7306c8",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/03/msg00006.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3591-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4161",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.djangoproject.com/weblog/2018/mar/06/security-releases/",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/103361",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:2927",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0051",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0082",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:0265",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/1ca63a66ef3163149ad822701273e8a1844192c2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/abf89d729f210c692a50e0ad3f75fb6bec6fae16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/e157315da3ae7005fa0683ffc9751dbeca7306c8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/03/msg00006.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3591-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2018/dsa-4161",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.djangoproject.com/weblog/2018/mar/06/security-releases/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.550784",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "django",
    "owner": "django",
    "created_at": "2012-04-28T02:47:18Z",
    "updated_at": "2025-01-14T13:27:58Z",
    "pushed_at": "2025-01-14T11:34:55Z",
    "size": 264981,
    "stars": 81851,
    "forks": 32045,
    "open_issues": 301,
    "watchers": 81851,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "stable/0.90.x",
      "stable/0.91.x",
      "stable/0.95.x",
      "stable/0.96.x",
      "stable/1.0.x",
      "stable/1.1.x",
      "stable/1.2.x",
      "stable/1.3.x",
      "stable/1.4.x",
      "stable/1.5.x",
      "stable/1.6.x",
      "stable/1.7.x",
      "stable/1.8.x",
      "stable/1.9.x",
      "stable/1.10.x",
      "stable/1.11.x",
      "stable/2.0.x",
      "stable/2.1.x",
      "stable/2.2.x",
      "stable/3.0.x",
      "stable/3.1.x",
      "stable/3.2.x",
      "stable/4.0.x",
      "stable/4.1.x",
      "stable/4.2.x",
      "stable/5.0.x",
      "stable/5.1.x"
    ],
    "languages": {
      "Python": 17607947,
      "HTML": 250858,
      "JavaScript": 158876,
      "CSS": 92030,
      "Smarty": 392,
      "Procfile": 47
    },
    "commit_activity": {
      "total_commits_last_year": 938,
      "avg_commits_per_week": 18.03846153846154,
      "days_active_last_year": 299
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:28:27.491590"
  }
}