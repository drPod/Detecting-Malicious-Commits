{
  "cve_id": "CVE-2018-7634",
  "github_data": {
    "repository": "Enalean/tuleap",
    "fix_commit": "0843c046eee54b16ec6a7753c575838212770189",
    "related_commits": [
      "0843c046eee54b16ec6a7753c575838212770189",
      "0843c046eee54b16ec6a7753c575838212770189"
    ],
    "patch_url": "https://github.com/Enalean/tuleap/commit/0843c046eee54b16ec6a7753c575838212770189.patch",
    "fix_commit_details": {
      "sha": "0843c046eee54b16ec6a7753c575838212770189",
      "commit_date": "2018-03-01T13:40:05Z",
      "author": {
        "login": "LeSuisse",
        "type": "User",
        "stats": {
          "total_commits": 13553,
          "average_weekly_commits": 13.158252427184467,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 479
        }
      },
      "commit_message": {
        "title": "Merge 'gerrit #10714' into stable/master",
        "length": 185,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 691,
        "additions": 484,
        "deletions": 207
      },
      "files": [
        {
          "filename": "site-content/en_US/account/account.tab",
          "status": "modified",
          "additions": 0,
          "deletions": 23,
          "patch": "@@ -110,29 +110,6 @@ account_preferences\thtml_format\tHTML\n account_preferences\ttext_format\tText\n #\n #-----------------------------------------------\n-# Script: SF/www/account/change_email.php\n-#\n-account_change_email\ttitle\tChange Email Address\n-account_change_email\tmessage\t<P>Changing your email address will require confirmation from your new email address, so that we can ensure we have a good email address on file. <P>Submitting the form below will mail a confirmation URL to the new email address. Visiting this link will complete the email change.\n-account_change_email\tlabel_new\tNew Email Address\n-account_change_email\tsend_new\tSend Confirmation to New Address\n-#\n-#-----------------------------------------------\n-# Script: SF/www/account/change_email-confirm.php\n-#\n-account_change_email-confirm\tmessage\tYou have requested a change of email address on $1.\\nPlease visit the following URL to complete the email change:\\n\\n$2\\n\\n-- The $1 Team\n-account_change_email-confirm\ttitle\tEmail Change Confirmation\n-account_change_email-confirm\tmailsent\tAn email has been sent to the new address. Follow the instructions in the email to complete the email change.\n-#\n-#-----------------------------------------------\n-# Script: SF/www/account/change_email-complete.php\n-#\n-account_change_email-complete\tinvalid_hash\tInvalid confirmation hash.\n-account_change_email-complete\tduplicate_hash\tThis hash key exists more than once.\n-account_change_email-complete\ttitle\tEmail Change Complete\n-account_change_email-complete\tmessage\tWelcome, $1.<P>Your email change is complete. Your new email address on file is <B>$2</B>. Mail sent to $3 user $1 (login $4) will now be forwarded to this new email address.\n-#\n-#-----------------------------------------------\n # Script: SF/www/account/change_pw.php\n #\n account_change_pw\ttitle_success\tSuccessfully Changed Password"
        },
        {
          "filename": "site-content/fr_FR/LC_MESSAGES/tuleap-core.po",
          "status": "modified",
          "additions": 94,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@ msgstr \"\"\n \"Content-Type: text/plain; charset=UTF-8\\n\"\n \"Content-Transfer-Encoding: 8bit\\n\"\n \"Plural-Forms: nplurals=2; plural=(n > 1);\\n\"\n-\"X-Generator: Poedit 2.0.3\\n\"\n+\"X-Generator: Poedit 1.8.7.1\\n\"\n \n #, php-format\n msgid \"\"\n@@ -85,6 +85,14 @@ msgstr \"Tous les groupes\"\n msgid \"Already used\"\n msgstr \"D\u00e9j\u00e0 utilis\u00e9\"\n \n+msgid \"\"\n+\"An email has been sent to the new address. Follow the instructions in the \"\n+\"email to complete the email change.\"\n+msgstr \"\"\n+\"Un courrier \u00e9lectronique vient d'\u00eatre envoy\u00e9 \u00e0 votre nouvelle adresse e-\"\n+\"mail. Suivez les instructions fournies dans ce message pour confirmer \"\n+\"d\u00e9finitivement le changement.\"\n+\n msgid \"\"\n \"An error occured with your upload. Please try again or choose another image.\"\n msgstr \"\"\n@@ -172,6 +180,17 @@ msgstr \"Impossible de mettre \u00e0 jour le groupe utilisateur\"\n msgid \"Categories\"\n msgstr \"Cat\u00e9gories\"\n \n+msgid \"Change email address\"\n+msgstr \"Changer l'adresse e-mail\"\n+\n+msgid \"\"\n+\"Changing your email address will require confirmation from your new email \"\n+\"address, so that we can ensure we have a good email address on file.\"\n+msgstr \"\"\n+\"Le changement d'adresse e-mail n\u00e9cessite une confirmation depuis votre \"\n+\"nouvelle adresse e-mail de fa\u00e7on \u00e0 s'assurer que nous disposons d'une \"\n+\"adresse valide.\"\n+\n msgid \"Child projects\"\n msgstr \"Projets enfants\"\n \n@@ -302,6 +321,15 @@ msgstr \"\u00c9diter les param\u00e8tres\"\n msgid \"Edit widget\"\n msgstr \"\u00c9diter le widget\"\n \n+msgid \"Email change complete\"\n+msgstr \"Changement d'e-mail confirm\u00e9\"\n+\n+msgid \"Email change confirmation\"\n+msgstr \"Confirmation de changement d'adresse e-mail\"\n+\n+msgid \"Email format invalid\"\n+msgstr \"Le formal de l'e-mail n'est pas valide\"\n+\n msgid \"Emergency\"\n msgstr \"Urgent\"\n \n@@ -473,6 +501,9 @@ msgstr \"Barre de menu\"\n msgid \"Nb members\"\n msgstr \"Nb membres\"\n \n+msgid \"New email address:\"\n+msgstr \"Nouvelle adresse e-mail\"\n+\n msgid \"News\"\n msgstr \"Annonces\"\n \n@@ -682,6 +713,9 @@ msgstr \"Rechercher\"\n msgid \"See permissions\"\n msgstr \"Voir les permissions\"\n \n+msgid \"Send confirmation to new address\"\n+msgstr \"Envoyer la confirmation\"\n+\n msgid \"Service news is disabled for this project.\"\n msgstr \"Le service annonces est d\u00e9sactiv\u00e9 pour ce projet.\"\n \n@@ -712,6 +746,14 @@ msgstr \"Commencez par choisir un widget\"\n msgid \"Style\"\n msgstr \"Style\"\n \n+msgid \"\"\n+\"Submitting the form below will mail a confirmation URL to the new email \"\n+\"address. Visiting this link will complete the email change.\"\n+msgstr \"\"\n+\"La soumission de ce formulaire d\u00e9clenchera l'envoi d'un e-mail \u00e0 votre \"\n+\"nouvelle adresse incluant un lien \u00e0 visiter pour confirmer d\u00e9finitivement le \"\n+\"changement.\"\n+\n msgid \"System\"\n msgstr \"Syst\u00e8me\"\n \n@@ -752,6 +794,14 @@ msgid \"The last project administrator cannot be removed.\"\n msgstr \"\"\n \"Il n'est pas possible de supprimer le dernier administrateur du projet.\"\n \n+#, php-format\n+msgid \"\"\n+\"The mail was not accepted for the delivery. Please contact the administrator \"\n+\"at %s.\"\n+msgstr \"\"\n+\"L'e-mail n'a pas pu \u00eatre envoy\u00e9. Veuillez contacter les administrateurs \u00e0 \"\n+\"l'adresse %s.\"\n+\n msgid \"The name is missing for creating a dashboard.\"\n msgstr \"Il manque le nom pour cr\u00e9er un tableau de bord.\"\n \n@@ -822,6 +872,9 @@ msgstr \"\"\n msgid \"This group does not have any members yet.\"\n msgstr \"Ce groupe n'a pas encore de membres.\"\n \n+msgid \"This hash key exists more than once\"\n+msgstr \"Cette cl\u00e9 de confirmation est pr\u00e9sente plus d'une fois dans la base.\"\n+\n msgid \"This is a system group, you cannot delete it.\"\n msgstr \"Ceci est un groupe syst\u00e8me, vous ne pouvez pas le supprimer.\"\n \n@@ -887,6 +940,9 @@ msgstr \"Import outils de suivi v3\"\n msgid \"Unable to fetch the latest activities of the project\"\n msgstr \"Impossible de r\u00e9cup\u00e9rer les derni\u00e8res activit\u00e9s du projet\"\n \n+msgid \"Unauthorized action for anonymous\"\n+msgstr \"Cette action n'est pas autoris\u00e9e pour les anonymes\"\n+\n msgid \"Unix name\"\n msgstr \"Now unix\"\n \n@@ -947,6 +1003,9 @@ msgstr \"Bienvenue \u00e0 bord\"\n msgid \"Welcome message and information for users\"\n msgstr \"Message de bienvenue et informations g\u00e9n\u00e9rales pour les utilisateurs\"\n \n+msgid \"Welcome, %s.\"\n+msgstr \"Bienvenue, %s\"\n+\n msgid \"\"\n \"Why don't you start by editing your dashboard <br> and adding some widgets?\"\n msgstr \"\"\n@@ -1013,6 +1072,11 @@ msgstr \"\"\n \"Vous \u00eates sur le point de supprimer le widget \\\"%s\\\". Cette action est \"\n \"irr\u00e9versible. Merci de confirmer cette suppression.\"\n \n+msgid \"You are not the user who asked for email change\"\n+msgstr \"\"\n+\"Vous n'etes pas l'utilisateur \u00e0 l'origine de la demande de changement d'e-\"\n+\"mail\"\n+\n msgid \"\"\n \"You can delegate to this group several permissions. All the members of this\\n\"\n \"                        group will take advantage of these permissions.\"\n@@ -1063,6 +1127,22 @@ msgstr \"\"\n \"Vous n\u2019avez pas les droits pour mettre \u00e0 jour des tableaux de bord du projet \"\n \"\\\"%s\\\".\"\n \n+#, php-format\n+msgid \"\"\n+\"You have requested a change of email address on %s.\\n\"\n+\"Please visit the following URL to complete the email change:\\n\"\n+\"\\n\"\n+\"%s\\n\"\n+\"\\n\"\n+\"-- The %s Team\"\n+msgstr \"\"\n+\"Vous avez demand\u00e9 a changer votre adresse e-mail en %s.\\n\"\n+\"Merci de visiter le lien ci-dessous pour confirmer ce changement :\\n\"\n+\"\\n\"\n+\"%s\\n\"\n+\"\\n\"\n+\"-- L'\u00e9quipe %s\"\n+\n msgid \"You must be a project admin to edit this widget.\"\n msgstr \"\"\n \"Vous devez \u00eatre administrateur du projet pour pouvoir \u00e9diter ce widget.\"\n@@ -1084,12 +1164,25 @@ msgstr \"\"\n \"Vous devez supprimer l'utilisateur des administrateurs d'annonces avant de \"\n \"pouvoir l'enlever des r\u00e9dacteurs\"\n \n+msgid \"\"\n+\"Your email change is complete. Your new email address is <strong>%s</strong>.\"\n+msgstr \"\"\n+\"Votre changement d'adresse e-mail est confirm\u00e9. Votre nouvelle adresse e-\"\n+\"mail est <strong>%s</strong>\"\n+\n msgid \"Your history is empty\"\n msgstr \"Votre historique est vide\"\n \n msgid \"Your platform does not allow restricted users.\"\n msgstr \"Votre plateforme n'authorise pas les utilisateurs restreints\"\n \n+#, php-format\n+msgid \"[%s] Email change confirmation\"\n+msgstr \"[%s] Confirmation de changement d'e-mail\"\n+\n+msgid \"back to home page\"\n+msgstr \"Retour \u00e0 la page d'accueil\"\n+\n msgid \"categories\"\n msgstr \"cat\u00e9gories\"\n "
        },
        {
          "filename": "site-content/fr_FR/account/account.tab",
          "status": "modified",
          "additions": 0,
          "deletions": 23,
          "patch": "@@ -102,29 +102,6 @@ account_preferences\thtml_format\tHTML\n account_preferences\ttext_format\tTexte\n #\n #-----------------------------------------------\n-# Script: SF/www/account/change_email.php\n-#\n-account_change_email\ttitle\tChanger l'adresse e-mail\n-account_change_email\tmessage\t<P>Le changement d'adresse e-mail n\u00e9cessite une confirmation depuis votre nouvelle adresse e-mail de fa\u00e7on \u00e0 s'assurer que nous disposons d'une adresse valide. <P>La soumission de ce formulaire d\u00e9clenchera l'envoi d'un e-mail \u00e0 votre nouvelle adresse incluant un lien \u00e0 visiter pour confirmer d\u00e9finitivement le changement.\n-account_change_email\tlabel_new\tNouvelle adresse e-mail\n-account_change_email\tsend_new\tEnvoyer la confirmation\n-#\n-#-----------------------------------------------\n-# Script: SF/www/account/change_email-confirm.php\n-#\n-account_change_email-confirm\tmessage\tVous avez demand\u00e9 a changer votre adresse e-mail en $1.\\nMerci de visiter le lien ci-dessous pour confirmer ce changement :\\n\\n$2\\n\\n-- L'\u00e9quipe $1\n-account_change_email-confirm\ttitle\tConfirmation de changement d'adresse e-mail\n-account_change_email-confirm\tmailsent\tUn courrier \u00e9lectronique vient d'\u00eatre envoy\u00e9 \u00e0 votre nouvelle adresse e-mail. Suivez les instructions fournies dans ce message pour confirmer d\u00e9finitivement le changement.\n-#\n-#-----------------------------------------------\n-# Script: SF/www/account/change_email-complete.php\n-#\n-account_change_email-complete\tinvalid_hash\tCl\u00e9 de confirmation invalide.\n-account_change_email-complete\tduplicate_hash\tCette cl\u00e9 de confirmation est pr\u00e9sente plus d'une fois dans la base.\n-account_change_email-complete\ttitle\tChangement d'e-mail confirm\u00e9\n-account_change_email-complete\tmessage\tBienvenue, $1.<P>Votre changement d'adresse e-mail est confirm\u00e9. Votre nouvelle adresse e-mail est <B>$2</B>. Les courriers \u00e9lectroniques envoy\u00e9s \u00e0 $3, utilisateur $1 (compte $4) seront d\u00e9sormais envoy\u00e9s \u00e0 cette nouvelle adresse e-mail.\n-#\n-#-----------------------------------------------\n # Script: SF/www/account/change_pw.php\n #\n account_change_pw\ttitle_success\tMot de passe modifi\u00e9 avec succ\u00e8s"
        },
        {
          "filename": "site-content/tuleap-core.pot",
          "status": "modified",
          "additions": 72,
          "deletions": 0,
          "patch": "@@ -69,6 +69,11 @@ msgstr \"\"\n msgid \"Already used\"\n msgstr \"\"\n \n+msgid \"\"\n+\"An email has been sent to the new address. Follow the instructions in the \"\n+\"email to complete the email change.\"\n+msgstr \"\"\n+\n msgid \"\"\n \"An error occured with your upload. Please try again or choose another image.\"\n msgstr \"\"\n@@ -148,6 +153,14 @@ msgstr \"\"\n msgid \"Categories\"\n msgstr \"\"\n \n+msgid \"Change email address\"\n+msgstr \"\"\n+\n+msgid \"\"\n+\"Changing your email address will require confirmation from your new email \"\n+\"address, so that we can ensure we have a good email address on file.\"\n+msgstr \"\"\n+\n msgid \"Child projects\"\n msgstr \"\"\n \n@@ -276,6 +289,15 @@ msgstr \"\"\n msgid \"Edit widget\"\n msgstr \"\"\n \n+msgid \"Email change complete\"\n+msgstr \"\"\n+\n+msgid \"Email change confirmation\"\n+msgstr \"\"\n+\n+msgid \"Email format invalid\"\n+msgstr \"\"\n+\n msgid \"Emergency\"\n msgstr \"\"\n \n@@ -445,6 +467,9 @@ msgstr \"\"\n msgid \"Nb members\"\n msgstr \"\"\n \n+msgid \"New email address:\"\n+msgstr \"\"\n+\n msgid \"News\"\n msgstr \"\"\n \n@@ -647,6 +672,9 @@ msgstr \"\"\n msgid \"See permissions\"\n msgstr \"\"\n \n+msgid \"Send confirmation to new address\"\n+msgstr \"\"\n+\n msgid \"Service news is disabled for this project.\"\n msgstr \"\"\n \n@@ -677,6 +705,11 @@ msgstr \"\"\n msgid \"Style\"\n msgstr \"\"\n \n+msgid \"\"\n+\"Submitting the form below will mail a confirmation URL to the new email \"\n+\"address. Visiting this link will complete the email change.\"\n+msgstr \"\"\n+\n msgid \"System\"\n msgstr \"\"\n \n@@ -715,6 +748,12 @@ msgstr \"\"\n msgid \"The last project administrator cannot be removed.\"\n msgstr \"\"\n \n+#, php-format\n+msgid \"\"\n+\"The mail was not accepted for the delivery. Please contact the administrator \"\n+\"at %s.\"\n+msgstr \"\"\n+\n msgid \"The name is missing for creating a dashboard.\"\n msgstr \"\"\n \n@@ -777,6 +816,9 @@ msgstr \"\"\n msgid \"This group does not have any members yet.\"\n msgstr \"\"\n \n+msgid \"This hash key exists more than once\"\n+msgstr \"\"\n+\n msgid \"This is a system group, you cannot delete it.\"\n msgstr \"\"\n \n@@ -837,6 +879,9 @@ msgstr \"\"\n msgid \"Unable to fetch the latest activities of the project\"\n msgstr \"\"\n \n+msgid \"Unauthorized action for anonymous\"\n+msgstr \"\"\n+\n msgid \"Unix name\"\n msgstr \"\"\n \n@@ -895,6 +940,9 @@ msgstr \"\"\n msgid \"Welcome message and information for users\"\n msgstr \"\"\n \n+msgid \"Welcome, %s.\"\n+msgstr \"\"\n+\n msgid \"\"\n \"Why don't you start by editing your dashboard <br> and adding some widgets?\"\n msgstr \"\"\n@@ -945,6 +993,9 @@ msgid \"\"\n \"                This action is irreversible. Please confirm this deletion.\"\n msgstr \"\"\n \n+msgid \"You are not the user who asked for email change\"\n+msgstr \"\"\n+\n msgid \"\"\n \"You can delegate to this group several permissions. All the members of this\\n\"\n \"                        group will take advantage of these permissions.\"\n@@ -983,6 +1034,16 @@ msgstr \"\"\n msgid \"You have not rights to update dashboards of the project \\\"%s\\\".\"\n msgstr \"\"\n \n+#, php-format\n+msgid \"\"\n+\"You have requested a change of email address on %s.\\n\"\n+\"Please visit the following URL to complete the email change:\\n\"\n+\"\\n\"\n+\"%s\\n\"\n+\"\\n\"\n+\"-- The %s Team\"\n+msgstr \"\"\n+\n msgid \"You must be a project admin to edit this widget.\"\n msgstr \"\"\n \n@@ -999,12 +1060,23 @@ msgid \"\"\n \"him from writers.\"\n msgstr \"\"\n \n+msgid \"\"\n+\"Your email change is complete. Your new email address is <strong>%s</strong>.\"\n+msgstr \"\"\n+\n msgid \"Your history is empty\"\n msgstr \"\"\n \n msgid \"Your platform does not allow restricted users.\"\n msgstr \"\"\n \n+#, php-format\n+msgid \"[%s] Email change confirmation\"\n+msgstr \"\"\n+\n+msgid \"back to home page\"\n+msgstr \"\"\n+\n msgid \"categories\"\n msgstr \"\"\n "
        },
        {
          "filename": "src/common/autoload.php",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n // @codingStandardsIgnoreFile\n // @codeCoverageIgnoreStart\n // this is an autogenerated file - do not edit\n-function autoload5968920175c8826d1e7743c6dd8b7ecc($class) {\n+function autoload98e39cb101b034b8e47fa5f904bbcbfb($class) {\n     static $classes = null;\n     if ($classes === null) {\n         $classes = array(\n@@ -1083,6 +1083,9 @@ function autoload5968920175c8826d1e7743c6dd8b7ecc($class) {\n             'tuleap\\\\trove\\\\trovecatrouter' => '/trove/TroveCatRouter.php',\n             'tuleap\\\\trovecat\\\\trovecatlinkdao' => '/trove/TroveCatLinkDao.php',\n             'tuleap\\\\uri\\\\urimodifier' => '/URI/URIModifier.php',\n+            'tuleap\\\\user\\\\account\\\\changepasswordconfirmpresenter' => '/user/Account/ChangePasswordConfirmPresenter.php',\n+            'tuleap\\\\user\\\\account\\\\changepasswordcontroller' => '/user/Account/ChangePasswordController.php',\n+            'tuleap\\\\user\\\\account\\\\changepasswordpresenter' => '/user/Account/ChangePasswordPresenter.php',\n             'tuleap\\\\user\\\\admin\\\\pendingprojectbuilder' => '/user/Admin/PendingProjectBuilder.php',\n             'tuleap\\\\user\\\\admin\\\\pendinguserpresenter' => '/user/Admin/PendingUserPresenter.php',\n             'tuleap\\\\user\\\\admin\\\\pendinguserscollectionpresenter' => '/user/Admin/PendingUsersCollectionPresenter.php',\n@@ -1344,5 +1347,5 @@ function autoload5968920175c8826d1e7743c6dd8b7ecc($class) {\n         require dirname(__FILE__) . $classes[$cn];\n     }\n }\n-spl_autoload_register('autoload5968920175c8826d1e7743c6dd8b7ecc');\n+spl_autoload_register('autoload98e39cb101b034b8e47fa5f904bbcbfb');\n // @codeCoverageIgnoreEnd"
        },
        {
          "filename": "src/common/dao/UserDao.class.php",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -769,4 +769,14 @@ public function removeConfirmHash($confirm_hash) {\n         $sql = \"UPDATE user SET confirm_hash = null WHERE confirm_hash=$confirm_hash\";\n         return $this->update($sql);\n     }\n+\n+    public function setEmailChangeConfirm($user_id, $confirm_hash, $email_new)\n+    {\n+        $user_id      = $this->da->escapeInt($user_id);\n+        $confirm_hash = $this->da->quoteSmart($confirm_hash);\n+        $email_new    = $this->da->quoteSmart($email_new);\n+\n+        $sql = \"UPDATE user SET confirm_hash=$confirm_hash, email_new=$email_new WHERE user_id=$user_id\";\n+        return $this->update($sql);\n+    }\n }"
        },
        {
          "filename": "src/common/event/Event.class.php",
          "status": "modified",
          "additions": 0,
          "deletions": 10,
          "patch": "@@ -67,16 +67,6 @@ class Event {\n      */\n     const LIST_SSH_KEYS = 'list_ssh_keys';\n \n-    /**\n-     * The user has just changed his email address.\n-     *\n-     * Parameters:\n-     *  'user_id' => User ID\n-     *\n-     * No expected results\n-     */\n-    const USER_EMAIL_CHANGED = 'user_email_changed';\n-\n     /**\n      * Force aliases database update.\n      *"
        },
        {
          "filename": "src/common/system_event/SystemEventManager.class.php",
          "status": "modified",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -38,7 +38,6 @@ private function __construct(SystemEventDao $dao = null, SystemEventsFollowersDa\n         $event_manager = $this->_getEventManager();\n         $events_to_listen = array(\n             Event::SYSTEM_CHECK,\n-            Event::USER_EMAIL_CHANGED,\n             Event::PROJECT_RENAME,\n             Event::USER_RENAME,\n             Event::COMPUTE_MD5SUM,\n@@ -157,11 +156,6 @@ function addSystemEvent($event, $params) {\n                                $this->concatParameters($params, array('project_path', 'file_id', 'old_path' )),\n                                SystemEvent::PRIORITY_HIGH);\n             break;\n-        case Event::USER_EMAIL_CHANGED:\n-            $this->createEvent(SystemEvent::TYPE_USER_EMAIL_CHANGED,\n-                               $params['user_id'],\n-                               SystemEvent::PRIORITY_LOW);\n-            break;\n         case 'approve_pending_project':\n             $this->createEvent(SystemEvent::TYPE_PROJECT_CREATE,\n                                $params['group_id'],"
        },
        {
          "filename": "src/common/user/Account/ChangePasswordController.php",
          "status": "added",
          "additions": 171,
          "deletions": 0,
          "patch": "@@ -0,0 +1,171 @@\n+<?php\n+/**\n+ * Copyright (c) Enalean, 2018. All Rights Reserved.\n+ *\n+ * This file is a part of Tuleap.\n+ *\n+ * Tuleap is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Tuleap is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Tuleap. If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ */\n+\n+namespace Tuleap\\User\\Account;\n+\n+use Tuleap\\Layout\\BaseLayout;\n+\n+class ChangePasswordController\n+{\n+    const URL = '/account/change_email.php';\n+\n+    /**\n+     * @var \\UserManager\n+     */\n+    private $user_manager;\n+    /**\n+     * @var \\EventManager\n+     */\n+    private $event_manager;\n+\n+    public function __construct(\\UserManager $user_manager, \\EventManager $event_manager)\n+    {\n+        $this->user_manager  = $user_manager;\n+        $this->event_manager = $event_manager;\n+    }\n+\n+    public function change(\\HTTPRequest $request, BaseLayout $response)\n+    {\n+        $this->event_manager->processEvent('before_change_email', array());\n+\n+        $current_user = $request->getCurrentUser();\n+        if ($current_user->isAnonymous()) {\n+            $response->addFeedback(\\Feedback::ERROR, _('Unauthorized action for anonymous'));\n+            $response->redirect('/');\n+        }\n+\n+        $response->header(['title' =>_('Change email address')]);\n+\n+        $presenter = new ChangePasswordPresenter(\n+            new \\CSRFSynchronizerToken(self::URL),\n+            $current_user->getId()\n+        );\n+\n+        $renderer = \\TemplateRendererFactory::build()->getRenderer(__DIR__.'/../../../templates/user');\n+        $renderer->renderToPage('change-email', $presenter);\n+\n+        $response->footer(array());\n+    }\n+\n+    public function confirm(\\HTTPRequest $request, BaseLayout $response)\n+    {\n+        $this->event_manager->processEvent('before_change_email-confirm', []);\n+\n+        $token = new \\CSRFSynchronizerToken(self::URL);\n+        $token->check();\n+\n+        $current_user = $request->getCurrentUser();\n+        if ($current_user->isAnonymous()) {\n+            $response->addFeedback(\\Feedback::ERROR, _('Unauthorized action for anonymous'));\n+            $response->redirect('/');\n+        }\n+\n+        $new_mail = $request->getValidated('form_newemail', new \\Valid_Email(), '');\n+        if ($new_mail === '') {\n+            $response->addFeedback(\\Feedback::ERROR, _('Email format invalid'));\n+            $response->redirect('/change_email.php');\n+        }\n+\n+        $confirmation_hash = (new \\RandomNumberGenerator())->getNumber();\n+        $this->user_manager->setEmailChangeConfirm($current_user->getId(), $confirmation_hash, $new_mail);\n+\n+        $subject = sprintf(\n+            _('[%s] Email change confirmation'),\n+            \\ForgeConfig::get('sys_name')\n+        );\n+        $message = sprintf(\n+            _(\"You have requested a change of email address on %s.\\nPlease visit the following URL to complete the email change:\\n\\n%s\\n\\n-- The %s Team\"),\n+            \\ForgeConfig::get('sys_name'),\n+            $request->getServerUrl().$this->getChangeCompleteUrl($confirmation_hash),\n+            \\ForgeConfig::get('sys_name')\n+        );\n+\n+        $mail = new \\Mail();\n+        $mail->setTo($new_mail, true);\n+        $mail->setSubject($subject);\n+        $mail->setBody($message);\n+        $mail->setFrom(\\ForgeConfig::get('sys_noreply'));\n+        if (! $mail->send()) {\n+            $error_message = sprintf(_('The mail was not accepted for the delivery. Please contact the administrator at %s.'), \\ForgeConfig::get('sys_email_admin'));\n+            $response->addFeedback(\\Feedback::ERROR, $error_message);\n+            $response->redirect('/change_email.php');\n+        }\n+\n+        $response->header(['title' => _('Email change confirmation')]);\n+\n+        $renderer = \\TemplateRendererFactory::build()->getRenderer(__DIR__.'/../../../templates/user');\n+        $renderer->renderToPage('change-email-confirm', []);\n+\n+        $response->footer([]);\n+    }\n+\n+    public function complete(\\HTTPRequest $request, BaseLayout $response)\n+    {\n+        $this->event_manager->processEvent('before_change_email-complete', []);\n+\n+        $current_user = $request->getCurrentUser();\n+        if ($current_user->isAnonymous()) {\n+            $url_redirect  = new \\URLRedirect($this->event_manager);\n+            $return_to     = $this->getChangeCompleteUrl($request->getValidated('confirm_hash', 'string', ''));\n+            $response->redirect($url_redirect->makeReturnToUrl('/account/login.php', $return_to));\n+        }\n+\n+        $user = $this->user_manager->getUserByConfirmHash(\n+            $request->getValidated('confirm_hash', 'string', '')\n+        );\n+\n+        if ($user === null) {\n+            $response->addFeedback(\\Feedback::ERROR, _('This hash key exists more than once'));\n+            $response->redirect('/');\n+        }\n+\n+        if ($user->getId() != $current_user->getId()) {\n+            $response->addFeedback(\\Feedback::ERROR, _('You are not the user who asked for email change'));\n+            $response->redirect('/');\n+        }\n+\n+        $old_email_user = clone $user;\n+        $user->clearConfirmHash();\n+        $user->setEmail($old_email_user->getEmailNew());\n+        $user->setEmailNew($old_email_user->getEmail());\n+\n+        $this->user_manager->updateDb($user);\n+\n+\n+        $response->header(['title' => _('Email change complete')]);\n+\n+        $renderer = \\TemplateRendererFactory::build()->getRenderer(__DIR__.'/../../../templates/user');\n+        $renderer->renderToPage(\n+            'change-email-complete',\n+            [\n+                'realname' => $user->getRealName(),\n+                'email'    => $user->getEmail(),\n+            ]\n+        );\n+\n+        $response->footer([]);\n+    }\n+\n+    private function getChangeCompleteUrl($confirmation_hash)\n+    {\n+        return '/account/change_email-complete.php?confirm_hash='.$confirmation_hash;\n+    }\n+}"
        },
        {
          "filename": "src/common/user/Account/ChangePasswordPresenter.php",
          "status": "added",
          "additions": 40,
          "deletions": 0,
          "patch": "@@ -0,0 +1,40 @@\n+<?php\n+/**\n+ * Copyright (c) Enalean, 2018. All Rights Reserved.\n+ *\n+ * This file is a part of Tuleap.\n+ *\n+ * Tuleap is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Tuleap is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Tuleap. If not, see <http://www.gnu.org/licenses/>.\n+ *\n+ */\n+\n+namespace Tuleap\\User\\Account;\n+\n+class ChangePasswordPresenter\n+{\n+    /**\n+     * @var int\n+     */\n+    public $user_id;\n+    /**\n+     * @var CSRFSynchronizerToken\n+     */\n+    public $csrf_token;\n+\n+    public function __construct(\\CSRFSynchronizerToken $csrf_token, $user_id)\n+    {\n+        $this->csrf_token = $csrf_token;\n+        $this->user_id    = $user_id;\n+    }\n+}"
        },
        {
          "filename": "src/common/user/UserManager.class.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1006,4 +1006,9 @@ public function removeConfirmHash($confirm_hash) {\n         $dao = $this->getDao();\n         $dao->removeConfirmHash($confirm_hash);\n     }\n+\n+    public function setEmailChangeConfirm($user_id, $confirm_hash, $email_new)\n+    {\n+        return $this->getDao()->setEmailChangeConfirm($user_id, $confirm_hash, $email_new);\n+    }\n }"
        },
        {
          "filename": "src/templates/user/change-email-complete.mustache",
          "status": "added",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -0,0 +1,9 @@\n+<h2>{{# gettext }}Email change complete{{/ gettext}}</h2>\n+\n+<p>{{# gettext }}Welcome, %s.| {{ realname }}{{/ gettext }}</p>\n+\n+<p>{{# gettext }}Your email change is complete. Your new email address is <strong>%s</strong>. | {{ email }}{{/ gettext}}</p>\n+\n+<p>\n+    <a href=\"/\">{{# gettext }}back to home page{{/ gettext }}</a>\n+</p>"
        },
        {
          "filename": "src/templates/user/change-email-confirm.mustache",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+<h2>{{# gettext }}Email change confirmation{{/ gettext}}</h2>\n+\n+<p>{{# gettext }}An email has been sent to the new address. Follow the instructions in the email to complete the email change.{{/ gettext}}</p>\n+\n+<p>\n+    <a href=\"/\">{{# gettext }}back to home page{{/ gettext }}</a>\n+</p>"
        },
        {
          "filename": "src/templates/user/change-email.mustache",
          "status": "added",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -0,0 +1,17 @@\n+<h2>{{# gettext }}Change email address{{/ gettext}}</h2>\n+\n+<p>{{# gettext }}Changing your email address will require confirmation from your new email address, so that we can ensure we have a good email address on file.{{/ gettext }}</p>\n+\n+<p>{{# gettext }}Submitting the form below will mail a confirmation URL to the new email address. Visiting this link will complete the email change.{{/ gettext }}</p>\n+\n+<form action=\"change_email-confirm.php\" method=\"post\" class=\"form-inline\">\n+    {{# csrf_token }}\n+        {{> csrf_token_input }}\n+    {{/ csrf_token }}\n+    {{# gettext }}New email address:{{/ gettext }} <input type=\"text\" size=\"30\" name=\"form_newemail\" />\n+    <input class=\"btn btn-primary\" type=\"submit\" name=\"Send Confirmation to New Address\" value=\"{{# gettext }}Send confirmation to new address{{/ gettext }}\">\n+</form>\n+\n+<p>\n+    <a href=\"/\">{{# gettext }}back to home page{{/ gettext }}</a>\n+</p>"
        },
        {
          "filename": "src/www/account/change_email-complete.php",
          "status": "modified",
          "additions": 7,
          "deletions": 43,
          "patch": "@@ -1,6 +1,6 @@\n <?php\n-/* SourceForge: Breaking Down the Barriers to Open Source Development\n- * Copyright (c) Enalean, 2015. All Rights Reserved.\n+/**\n+ * Copyright (c) Enalean, 2018. All rights reserved\n  *\n  * This file is a part of Tuleap.\n  *\n@@ -11,50 +11,14 @@\n  *\n  * Tuleap is distributed in the hope that it will be useful,\n  * but WITHOUT ANY WARRANTY; without even the implied warranty of\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  * GNU General Public License for more details.\n  *\n  * You should have received a copy of the GNU General Public License\n- * along with Tuleap. If not, see <http://www.gnu.org/licenses/>.\n+ * along with Tuleap. If not, see <http://www.gnu.org/licenses/\n  */\n \n-require_once('pre.php');    \n+require_once 'pre.php';\n \n-$em = EventManager::instance();\n-$em->processEvent('before_change_email-complete', array());\n-\n-$hp = Codendi_HTMLPurifier::instance();\n-$request = HTTPRequest::instance();\n-$user_manager = UserManager::instance();\n-\n-\n-/** @var PFUser */\n-$user = $user_manager->getUserByConfirmHash($request->getValidated('confirm_hash', 'string', ''));\n-\n-if ($user === null) {\n-    $GLOBALS['Response']->addFeedback(Feedback::ERROR, $Language->getText('account_change_email-complete', 'duplicate_hash'));\n-    $GLOBALS['Response']->redirect('/');\n-}\n-\n-$old_email_user = clone $user;\n-$user->clearConfirmHash();\n-$user->setEmail($old_email_user->getEmailNew());\n-$user->setEmailNew($old_email_user->getEmail());\n-\n-$user_manager->updateDb($user);\n-\n-$em->processEvent(Event::USER_EMAIL_CHANGED, $user->getId());\n-\n-$HTML->header(array('title'=>$Language->getText('account_change_email-complete', 'title')));\n-?>\n-<p><b><?php echo $Language->getText('account_change_email-complete', 'title'); ?></b>\n-<P><?php echo $Language->getText('account_change_email-complete', 'message',\n-\t\t\t     array(  $hp->purify($user->getRealname(), CODENDI_PURIFIER_CONVERT_HTML) , $user->getEmail(),\n-\t\t\t\t    $GLOBALS['sys_name'], $user->getUsername())); ?>\n-\n-<P><A href=\"/\">[ <?php echo $Language->getText('global', 'back_home'); ?> ]</A>\n-\n-<?php\n-$HTML->footer(array());\n-\n-?>\n+$controller = new \\Tuleap\\User\\Account\\ChangePasswordController(UserManager::instance(), EventManager::instance());\n+$controller->complete(HTTPRequest::instance(), $GLOBALS['Response']);"
        },
        {
          "filename": "src/www/account/change_email-confirm.php",
          "status": "modified",
          "additions": 23,
          "deletions": 57,
          "patch": "@@ -1,58 +1,24 @@\n <?php\n-//\n-// SourceForge: Breaking Down the Barriers to Open Source Development\n-// Copyright 1999-2000 (c) The SourceForge Crew\n-// http://sourceforge.net\n-//\n-// \n-\n-require_once('pre.php');\n-require_once('common/mail/Mail.class.php');\n-require_once('common/event/EventManager.class.php');\n-\n-\n-$em =& EventManager::instance();\n-$em->processEvent('before_change_email-confirm', array());\n-\n-$request =& HTTPRequest::instance();\n-\n-$confirm_hash = substr(md5($GLOBALS['session_hash'] . time()),0,16);\n-\n-$res_user = db_query(\"SELECT * FROM user WHERE user_id=\".user_getid());\n-if (db_numrows($res_user) < 1) exit_error(\"Invalid User\",\"That user does not exist.\");\n-$row_user = db_fetch_array($res_user);\n-\n-$mail_is_sent = false;\n-\n-$form_newemail = $request->get('form_newemail');\n-if(validate_email($form_newemail)) {\n-\n-    db_query(\"UPDATE user SET confirm_hash='\".$confirm_hash.\"',email_new='\".db_es($form_newemail).\"' \"\n-             . \"WHERE user_id=\".$row_user['user_id']);\n-\n-    $message = stripcslashes($Language->getText('account_change_email-confirm', 'message', array($GLOBALS['sys_name'], get_server_url().\"/account/change_email-complete.php?confirm_hash=\".$confirm_hash)));\n-\n-    $mail = new Mail();\n-    $mail->setTo($form_newemail,true);\n-    $mail->setSubject($GLOBALS['sys_name'].': '.$Language->getText('account_change_email-confirm', 'title'));\n-    $mail->setBody($message);\n-    $mail->setFrom($GLOBALS['sys_noreply']);\n-    $mail_is_sent = $mail->send();\n-    if (!$mail_is_sent) {\n-        $GLOBALS['Response']->addFeedback('error', $GLOBALS['Language']->getText('global', 'mail_failed', array($GLOBALS['sys_email_admin'])));\n-    }\n-} else {\n-    $GLOBALS['Response']->addFeedback('error', $GLOBALS['Language']->getText('include_utils', 'invalid_email'));\n-}\n-site_header(array('title'=>$Language->getText('account_change_email-confirm', 'title'))); ?>\n-\n-<P><B><?php if ($mail_is_sent) { echo $Language->getText('account_change_email-confirm', 'title'); ?></B>\n-\n-<P><?php echo $Language->getText('account_change_email-confirm', 'mailsent'); ?>.\n-\n-<?php\n-}\n-echo '<p><a href=\"/\">['. $Language->getText('global', 'back_home'). ']</a></p>';\n-site_footer(array());\n-\n-?>\n+/**\n+ * Copyright (c) Enalean, 2018. All rights reserved\n+ *\n+ * This file is a part of Tuleap.\n+ *\n+ * Tuleap is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Tuleap is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Tuleap. If not, see <http://www.gnu.org/licenses/\n+ */\n+\n+require_once 'pre.php';\n+\n+$controller = new \\Tuleap\\User\\Account\\ChangePasswordController(UserManager::instance(), EventManager::instance());\n+$controller->confirm(HTTPRequest::instance(), $GLOBALS['Response']);"
        },
        {
          "filename": "src/www/account/change_email.php",
          "status": "modified",
          "additions": 23,
          "deletions": 41,
          "patch": "@@ -1,42 +1,24 @@\n <?php\n-//\n-// SourceForge: Breaking Down the Barriers to Open Source Development\n-// Copyright 1999-2000 (c) The SourceForge Crew\n-// http://sourceforge.net\n-//\n-// \n-\n-require_once('pre.php');\n-require_once('common/event/EventManager.class.php');\n-\n-$em =& EventManager::instance();\n-$em->processEvent('before_change_email', array());\n-\n-session_require(array('isloggedin'=>1));\n-\n-\n-$HTML->header(array('title'=> $Language->getText('account_change_email', 'title')));\n-$csrf = new CSRFSynchronizerToken('/account/change_email.php');\n-?>\n-\n-<h2><?php echo $Language->getText('account_change_email', 'title'); ?></h2>\n-\n-<?php echo $Language->getText('account_change_email', 'message'); ?>\n-\n-<FORM action=\"change_email-confirm.php\" method=\"post\" class=\"form-inline\">\n-<?php\n-echo $csrf->fetchHTMLInput();\n-?>\n-<INPUT type=\"hidden\" name=\"form_user\" value=\"<?php print user_getid(); ?>\">\n-<BR>\n-<?php echo $Language->getText('account_change_email', 'label_new'); ?>:\n-<INPUT type=\"text\" size=\"30\" name=\"form_newemail\">\n-<INPUT class=\"btn btn-primary\" type=\"submit\" name=\"Send Confirmation to New Address\" value=\"<?php echo $Language->getText('account_change_email', 'send_new'); ?>\">\n-</FORM>\n-\n-<A href=\"/\">[<?php echo $Language->getText('global', 'back_home'); ?>]</A>\n-\n-<?php\n-$HTML->footer(array());\n-\n-?>\n+/**\n+ * Copyright (c) Enalean, 2018. All rights reserved\n+ *\n+ * This file is a part of Tuleap.\n+ *\n+ * Tuleap is free software; you can redistribute it and/or modify\n+ * it under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation; either version 2 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * Tuleap is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with Tuleap. If not, see <http://www.gnu.org/licenses/\n+ */\n+\n+require_once 'pre.php';\n+\n+$controller = new \\Tuleap\\User\\Account\\ChangePasswordController(UserManager::instance(), EventManager::instance());\n+$controller->change(HTTPRequest::instance(), $GLOBALS['Response']);"
        },
        {
          "filename": "src/www/project/admin/editgenericmember.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -86,7 +86,7 @@\n         '. $generic_user->getRealName() .'\n     </p>\n     <p>\n-        <label for=\"generic_user_email\"><b>'. $Language->getText('account_change_email', 'title') .'</b>:</label><br />\n+        <label for=\"generic_user_email\"><b>'. _('Change email address') .'</b>:</label><br />\n         <input type=\"email\" name=\"email\" id=\"generic_user_email\" value=\"'.\n             $hp->purify($generic_user->getEmail(), CODENDI_PURIFIER_CONVERT_HTML) .'\" />\n      </p>"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 13,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9853bbe9eefcf4ad385b6e8474c59bd1aa8a6545",
            "date": "2025-01-14T16:07:28Z",
            "author_login": "magarnier"
          },
          {
            "sha": "f0aaaefd3ef209c794869a752a86b4f174d53d16",
            "date": "2025-01-14T16:07:20Z",
            "author_login": "magarnier"
          },
          {
            "sha": "e0da8b7336dcef7fb38b41cfee101f34f9249442",
            "date": "2025-01-14T14:59:51Z",
            "author_login": "nterray"
          },
          {
            "sha": "336f9ed6a3e16d12c03792f0764bbe06da36ced9",
            "date": "2025-01-14T14:59:12Z",
            "author_login": "nterray"
          },
          {
            "sha": "a4a770f2f7a401e471fde4bc167c5973d97dbd81",
            "date": "2025-01-14T13:19:55Z",
            "author_login": "Gashmob"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-352",
    "description": "An issue was discovered in Enalean Tuleap 9.17. Lack of CSRF attack mitigation while changing an e-mail address makes it possible to abuse the functionality by attackers. By making a CSRF attack, an attacker could make a victim change his registered e-mail address on the application, leading to account takeover.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-01T23:29:00.607",
    "last_modified": "2024-11-21T04:12:26.653",
    "fix_date": "2018-03-01T13:40:05Z"
  },
  "references": [
    {
      "url": "https://github.com/Enalean/tuleap/commit/0843c046eee54b16ec6a7753c575838212770189",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://mustafairan.wordpress.com/2018/03/05/tuleap-mail-change-csrf-vulnerability-leads-to-account-takeover/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://tuleap.net/plugins/git/tuleap/tuleap/stable?p=tuleap%2Fstable.git&a=commit&h=d6701289ae55de900929ff0f66313fa9771a198d",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://tuleap.net/plugins/tracker/?aid=11217",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://twitter.com/Mustafaran/status/970745812887199744",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Enalean/tuleap/commit/0843c046eee54b16ec6a7753c575838212770189",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://mustafairan.wordpress.com/2018/03/05/tuleap-mail-change-csrf-vulnerability-leads-to-account-takeover/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://tuleap.net/plugins/git/tuleap/tuleap/stable?p=tuleap%2Fstable.git&a=commit&h=d6701289ae55de900929ff0f66313fa9771a198d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://tuleap.net/plugins/tracker/?aid=11217",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://twitter.com/Mustafaran/status/970745812887199744",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.536463",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tuleap",
    "owner": "Enalean",
    "created_at": "2012-06-12T15:48:54Z",
    "updated_at": "2025-01-14T09:23:28Z",
    "pushed_at": "2025-01-14T09:23:22Z",
    "size": 382430,
    "stars": 1043,
    "forks": 285,
    "open_issues": 3,
    "watchers": 1043,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 64309783,
      "TypeScript": 12164261,
      "JavaScript": 4302645,
      "Vue": 3161023,
      "Mustache": 2174238,
      "SCSS": 1603030,
      "HTML": 502284,
      "CSS": 281155,
      "Shell": 126767,
      "Smarty": 121199,
      "MDX": 89474,
      "Nix": 48015,
      "Go": 44709,
      "Makefile": 41978,
      "Rust": 27741,
      "Groovy": 13947,
      "PEG.js": 12394,
      "Perl": 11384,
      "Dockerfile": 10302,
      "Python": 3977,
      "XSLT": 1077,
      "Awk": 597
    },
    "commit_activity": {
      "total_commits_last_year": 5447,
      "avg_commits_per_week": 104.75,
      "days_active_last_year": 255
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:46:56.606881"
  }
}