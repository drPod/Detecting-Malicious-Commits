{
  "cve_id": "CVE-2018-7651",
  "github_data": {
    "repository": "zkat/ssri",
    "fix_commit": "d0ebcdc22cb5c8f47f89716d08b3518b2485d65d",
    "related_commits": [
      "d0ebcdc22cb5c8f47f89716d08b3518b2485d65d",
      "d0ebcdc22cb5c8f47f89716d08b3518b2485d65d"
    ],
    "patch_url": "https://github.com/zkat/ssri/commit/d0ebcdc22cb5c8f47f89716d08b3518b2485d65d.patch",
    "fix_commit_details": {
      "sha": "d0ebcdc22cb5c8f47f89716d08b3518b2485d65d",
      "commit_date": "2018-02-14T20:35:23Z",
      "author": {
        "login": "zkat",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(security): tweak strict SRI regex (#10)",
        "length": 216,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 12,
        "deletions": 9
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@ const SPEC_ALGORITHMS = ['sha256', 'sha384', 'sha512']\n \n const BASE64_REGEX = /^[a-z0-9+/]+(?:=?=?)$/i\n const SRI_REGEX = /^([^-]+)-([^?]+)([?\\S*]*)$/\n-const STRICT_SRI_REGEX = /^([^-]+)-([A-Za-z0-9+/]+(?:=?=?))([?\\x21-\\x7E]*)$/\n+const STRICT_SRI_REGEX = /^([^-]+)-([A-Za-z0-9+/=]{44,88})(\\?[\\x21-\\x7E]*)*$/\n const VCHAR_REGEX = /^[\\x21-\\x7E]+$/\n \n class Hash {"
        },
        {
          "filename": "test/integrity.js",
          "status": "modified",
          "additions": 9,
          "deletions": 6,
          "patch": "@@ -7,20 +7,20 @@ const test = require('tap').test\n const ssri = require('..')\n \n test('toString()', t => {\n-  const sri = ssri.parse('sha512-foo sha256-bar!')\n+  const sri = ssri.parse('sha1-eUN/Xt2hP5wGabl43XqQZt0gWfE= sha256-Qhx213Vjr6GRSEawEL0WTzlb00whAuXpngy5zxc8HYc=')\n   t.equal(\n     sri.toString(),\n-    'sha512-foo sha256-bar!',\n+    'sha1-eUN/Xt2hP5wGabl43XqQZt0gWfE= sha256-Qhx213Vjr6GRSEawEL0WTzlb00whAuXpngy5zxc8HYc=',\n     'integrity objects from ssri.parse() can use toString()'\n   )\n   t.equal(\n     sri.toString({strict: true}),\n-    'sha512-foo',\n+    'sha256-Qhx213Vjr6GRSEawEL0WTzlb00whAuXpngy5zxc8HYc=',\n     'accepts strict mode option'\n   )\n   t.equal(\n     sri.toString({sep: '\\n'}),\n-    'sha512-foo\\nsha256-bar!',\n+    'sha1-eUN/Xt2hP5wGabl43XqQZt0gWfE=\\nsha256-Qhx213Vjr6GRSEawEL0WTzlb00whAuXpngy5zxc8HYc=',\n     'accepts separator option'\n   )\n   t.done()\n@@ -72,9 +72,12 @@ test('concat()', t => {\n     'sha512-foo sha512-quux sha1-bar sha1-baz',\n     'preserves relative order for algorithms between different concatenations'\n   )\n+  const strictSri = ssri.parse('sha512-WrLorGiX4iEWOOOaJSiCrmDIamA47exH+Bz7tVwIPb4sCU8w4iNqGCqYuspMMeU5pgz/sU7koP5u8W3RCUojGw==')\n   t.equal(\n-    sri.concat('sha1-bar!', {strict: true}).toString(),\n-    'sha512-foo',\n+    strictSri.concat('sha1-eUN/Xt2hP5wGabl43XqQZt0gWfE=', {\n+      strict: true\n+    }).toString(),\n+    'sha512-WrLorGiX4iEWOOOaJSiCrmDIamA47exH+Bz7tVwIPb4sCU8w4iNqGCqYuspMMeU5pgz/sU7koP5u8W3RCUojGw==',\n     'accepts strict mode option'\n   )\n   t.done()"
        },
        {
          "filename": "test/stringify.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -108,8 +108,8 @@ test('support strict serialization', t => {\n     'entries that do not conform to strict spec interpretation removed'\n   )\n   t.equal(\n-    ssri.stringify('sha512-foo sha256-bar', {sep: ' \\r|\\n\\t', strict: true}),\n-    'sha512-foo \\r \\n\\tsha256-bar',\n+    ssri.stringify('sha512-WrLorGiX4iEWOOOaJSiCrmDIamA47exH+Bz7tVwIPb4sCU8w4iNqGCqYuspMMeU5pgz/sU7koP5u8W3RCUojGw== sha256-Qhx213Vjr6GRSEawEL0WTzlb00whAuXpngy5zxc8HYc=', {sep: ' \\r|\\n\\t', strict: true}),\n+    'sha512-WrLorGiX4iEWOOOaJSiCrmDIamA47exH+Bz7tVwIPb4sCU8w4iNqGCqYuspMMeU5pgz/sU7koP5u8W3RCUojGw== \\r \\n\\tsha256-Qhx213Vjr6GRSEawEL0WTzlb00whAuXpngy5zxc8HYc=',\n     'strict mode replaces non-whitespace characters in separator with space'\n   )\n   t.done()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f36c606ae0637c3e36d426096b60692e9f3d3e4d",
            "date": "2019-05-29T06:15:39Z",
            "author_login": "zkat"
          },
          {
            "sha": "a4337cd672f341deee2b52699b6720d82e4d0ddf",
            "date": "2018-08-27T19:48:52Z",
            "author_login": "zkat"
          },
          {
            "sha": "cf86553adf39e0de84fa99b07858d83b6a950914",
            "date": "2018-08-27T19:48:45Z",
            "author_login": "zkat"
          },
          {
            "sha": "97b032d938a0206bcd7e3eb4cb3a081648052c42",
            "date": "2018-08-27T19:48:07Z",
            "author_login": "zkat"
          },
          {
            "sha": "d1aa2f789a8cbfe8592d63a87cee4127864fdcad",
            "date": "2018-04-09T18:19:23Z",
            "author_login": "zkat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-400",
    "description": "index.js in the ssri module before 5.2.2 for Node.js is prone to a regular expression denial of service vulnerability in strict mode functionality via a long base64 hash string.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-04T01:29:00.347",
    "last_modified": "2024-11-21T04:12:28.640",
    "fix_date": "2018-02-14T20:35:23Z"
  },
  "references": [
    {
      "url": "https://github.com/zkat/ssri/commit/d0ebcdc22cb5c8f47f89716d08b3518b2485d65d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zkat/ssri/issues/10",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://nodesecurity.io/advisories/565",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zkat/ssri/commit/d0ebcdc22cb5c8f47f89716d08b3518b2485d65d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zkat/ssri/issues/10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://nodesecurity.io/advisories/565",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.538747",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ssri",
    "owner": "zkat",
    "created_at": "2017-03-23T07:20:01Z",
    "updated_at": "2024-11-30T05:48:29Z",
    "pushed_at": "2022-12-06T16:27:44Z",
    "size": 520,
    "stars": 83,
    "forks": 13,
    "open_issues": 10,
    "watchers": 83,
    "has_security_policy": false,
    "default_branch": "latest",
    "protected_branches": [],
    "languages": {
      "JavaScript": 36124
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T20:32:38.690829"
  }
}