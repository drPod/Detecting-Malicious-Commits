{
  "cve_id": "CVE-2018-7750",
  "github_data": {
    "repository": "paramiko/paramiko",
    "fix_commit": "fa29bd8446c8eab237f5187d28787727b4610516",
    "related_commits": [
      "fa29bd8446c8eab237f5187d28787727b4610516",
      "fa29bd8446c8eab237f5187d28787727b4610516"
    ],
    "patch_url": "https://github.com/paramiko/paramiko/commit/fa29bd8446c8eab237f5187d28787727b4610516.patch",
    "fix_commit_details": {
      "sha": "fa29bd8446c8eab237f5187d28787727b4610516",
      "commit_date": "2018-03-12T22:34:06Z",
      "author": {
        "login": "bitprophet",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixes CVE-2018-7750 / #1175",
        "length": 72,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 44,
        "deletions": 2
      },
      "files": [
        {
          "filename": "paramiko/common.py",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -32,6 +32,7 @@\n MSG_USERAUTH_GSSAPI_RESPONSE, MSG_USERAUTH_GSSAPI_TOKEN = range(60, 62)\n MSG_USERAUTH_GSSAPI_EXCHANGE_COMPLETE, MSG_USERAUTH_GSSAPI_ERROR,\\\n     MSG_USERAUTH_GSSAPI_ERRTOK, MSG_USERAUTH_GSSAPI_MIC = range(63, 67)\n+HIGHEST_USERAUTH_MESSAGE_ID = 79\n MSG_GLOBAL_REQUEST, MSG_REQUEST_SUCCESS, MSG_REQUEST_FAILURE = range(80, 83)\n MSG_CHANNEL_OPEN, MSG_CHANNEL_OPEN_SUCCESS, MSG_CHANNEL_OPEN_FAILURE, \\\n     MSG_CHANNEL_WINDOW_ADJUST, MSG_CHANNEL_DATA, MSG_CHANNEL_EXTENDED_DATA, \\"
        },
        {
          "filename": "paramiko/transport.py",
          "status": "modified",
          "additions": 43,
          "deletions": 2,
          "patch": "@@ -49,7 +49,7 @@\n     MSG_CHANNEL_FAILURE, MSG_CHANNEL_DATA, MSG_CHANNEL_EXTENDED_DATA,\n     MSG_CHANNEL_WINDOW_ADJUST, MSG_CHANNEL_REQUEST, MSG_CHANNEL_EOF,\n     MSG_CHANNEL_CLOSE, MIN_WINDOW_SIZE, MIN_PACKET_SIZE, MAX_WINDOW_SIZE,\n-    DEFAULT_WINDOW_SIZE, DEFAULT_MAX_PACKET_SIZE,\n+    DEFAULT_WINDOW_SIZE, DEFAULT_MAX_PACKET_SIZE, HIGHEST_USERAUTH_MESSAGE_ID,\n )\n from paramiko.compress import ZlibCompressor, ZlibDecompressor\n from paramiko.dsskey import DSSKey\n@@ -1760,6 +1760,43 @@ def _sanitize_packet_size(self, max_packet_size):\n             max_packet_size = self.default_max_packet_size\n         return clamp_value(MIN_PACKET_SIZE, max_packet_size, MAX_WINDOW_SIZE)\n \n+    def _ensure_authed(self, ptype, message):\n+        \"\"\"\n+        Checks message type against current auth state.\n+\n+        If server mode, and auth has not succeeded, and the message is of a\n+        post-auth type (channel open or global request) an appropriate error\n+        response Message is crafted and returned to caller for sending.\n+\n+        Otherwise (client mode, authed, or pre-auth message) returns None.\n+        \"\"\"\n+        if (\n+            not self.server_mode\n+            or ptype <= HIGHEST_USERAUTH_MESSAGE_ID\n+            or self.is_authenticated()\n+        ):\n+            return None\n+        # WELP. We must be dealing with someone trying to do non-auth things\n+        # without being authed. Tell them off, based on message class.\n+        reply = Message()\n+        # Global requests have no details, just failure.\n+        if ptype == MSG_GLOBAL_REQUEST:\n+            reply.add_byte(cMSG_REQUEST_FAILURE)\n+        # Channel opens let us reject w/ a specific type + message.\n+        elif ptype == MSG_CHANNEL_OPEN:\n+            kind = message.get_text()\n+            chanid = message.get_int()\n+            reply.add_byte(cMSG_CHANNEL_OPEN_FAILURE)\n+            reply.add_int(chanid)\n+            reply.add_int(OPEN_FAILED_ADMINISTRATIVELY_PROHIBITED)\n+            reply.add_string('')\n+            reply.add_string('en')\n+        # NOTE: Post-open channel messages do not need checking; the above will\n+        # reject attemps to open channels, meaning that even if a malicious\n+        # user tries to send a MSG_CHANNEL_REQUEST, it will simply fall under\n+        # the logic that handles unknown channel IDs (as the channel list will\n+        # be empty.)\n+        return reply\n \n     def run(self):\n         # (use the exposed \"run\" method, because if we specify a thread target\n@@ -1820,7 +1857,11 @@ def run(self):\n                             continue\n \n                     if ptype in self._handler_table:\n-                        self._handler_table[ptype](self, m)\n+                        error_msg = self._ensure_authed(ptype, m)\n+                        if error_msg:\n+                            self._send_message(error_msg)\n+                        else:\n+                            self._handler_table[ptype](self, m)\n                     elif ptype in self._channel_handler_table:\n                         chanid = m.get_int()\n                         chan = self._channels.get(chanid)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "23f92003898b060df0e2b8b1d889455264e63a3e",
            "date": "2024-09-15T23:57:50Z",
            "author_login": "bitprophet"
          },
          {
            "sha": "eb7dbbc262f1ff41567152ab8e8d03c6436774f9",
            "date": "2024-09-15T23:09:54Z",
            "author_login": "bitprophet"
          },
          {
            "sha": "977913f5004862528c9a5d53c281048f19d8d9b7",
            "date": "2024-09-15T23:03:45Z",
            "author_login": "bitprophet"
          },
          {
            "sha": "f2ebac506d405ca7068e9cd301232c6e73821a1f",
            "date": "2024-09-15T23:02:40Z",
            "author_login": "bitprophet"
          },
          {
            "sha": "f5d4ff3ee69eba90b84da78c7caf50c28ba3aba5",
            "date": "2024-09-15T23:02:07Z",
            "author_login": "bitprophet"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-287",
    "description": "transport.py in the SSH server implementation of Paramiko before 1.17.6, 1.18.x before 1.18.5, 2.0.x before 2.0.8, 2.1.x before 2.1.5, 2.2.x before 2.2.3, 2.3.x before 2.3.2, and 2.4.x before 2.4.1 does not properly check whether authentication is completed before processing other requests, as demonstrated by channel-open. A customized SSH client can simply skip the authentication step.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2018-03-13T18:29:00.303",
    "last_modified": "2024-11-21T04:12:39.650",
    "fix_date": "2018-03-12T22:34:06Z"
  },
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/103713",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:0591",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:0646",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1124",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1125",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1213",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1274",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1328",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1525",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1972",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paramiko/paramiko/blob/master/sites/www/changelog.rst",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paramiko/paramiko/commit/fa29bd8446c8eab237f5187d28787727b4610516",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paramiko/paramiko/issues/1175",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/10/msg00018.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/12/msg00025.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3603-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3603-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/45712/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/103713",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:0591",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:0646",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1124",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1125",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1213",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1274",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1328",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1525",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2018:1972",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paramiko/paramiko/blob/master/sites/www/changelog.rst",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paramiko/paramiko/commit/fa29bd8446c8eab237f5187d28787727b4610516",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paramiko/paramiko/issues/1175",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2018/10/msg00018.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/12/msg00025.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3603-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/3603-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/45712/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.558288",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "paramiko",
    "owner": "paramiko",
    "created_at": "2009-02-02T03:41:08Z",
    "updated_at": "2025-01-13T18:09:25Z",
    "pushed_at": "2024-10-02T14:24:28Z",
    "size": 8248,
    "stars": 9215,
    "forks": 2002,
    "open_issues": 1108,
    "watchers": 9215,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 1138755
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T13:20:17.408537"
  }
}