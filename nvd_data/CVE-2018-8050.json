{
  "cve_id": "CVE-2018-8050",
  "github_data": {
    "repository": "sshock/AFFLIBv3",
    "fix_commit": "435a2ca802358a3debb6d164d2c33049131df81c",
    "related_commits": [
      "435a2ca802358a3debb6d164d2c33049131df81c",
      "435a2ca802358a3debb6d164d2c33049131df81c"
    ],
    "patch_url": "https://github.com/sshock/AFFLIBv3/commit/435a2ca802358a3debb6d164d2c33049131df81c.patch",
    "fix_commit_details": {
      "sha": "435a2ca802358a3debb6d164d2c33049131df81c",
      "commit_date": "2018-03-11T01:05:39Z",
      "author": {
        "login": "sshock",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Sanity check size passed to malloc...",
        "length": 264,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/afflib_pages.cpp",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -219,6 +219,11 @@ int af_get_page(AFFILE *af,int64_t pagenum,unsigned char *data,size_t *bytes)\n \t    return -3;\t\t\t// read error\n \t}\n \n+\t/* Sanity check to avoid undefined behaviour when calling malloc below with pagesize from a corrupt AFF image. */\n+\tif(af->image_pagesize <= 0 || af->image_pagesize > 16*1024*1024)\n+\t    return -1;\n+\n+\n \t/* Now uncompress directly into the buffer provided by the caller, unless the caller didn't\n \t * provide a buffer. If that happens, allocate our own...\n \t */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "95bf6cb9cf344ed6dccb8eb12bc159a17e616adb",
            "date": "2024-03-24T15:34:39Z",
            "author_login": "sshock"
          },
          {
            "sha": "6494d53cbb641a0dc25d29daa4ba93c15d5c92f1",
            "date": "2024-03-23T22:36:57Z",
            "author_login": "sshock"
          },
          {
            "sha": "78a83680522fa492148123517eddb4aee3378d35",
            "date": "2024-03-23T18:58:48Z",
            "author_login": "sshock"
          },
          {
            "sha": "01210f488410a23838c54fcc22297cf08ac7de66",
            "date": "2024-02-14T07:43:56Z",
            "author_login": "sshock"
          },
          {
            "sha": "4309b86f4a5e9beab4c41e16a7a971f79b56f644",
            "date": "2024-02-14T07:18:03Z",
            "author_login": "sshock"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "The af_get_page() function in lib/afflib_pages.cpp in AFFLIB (aka AFFLIBv3) through 3.7.16 allows remote attackers to cause a denial of service (segmentation fault) via a corrupt AFF image that triggers an unexpected pagesize value.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-11T06:29:00.207",
    "last_modified": "2024-11-21T04:13:11.690",
    "fix_date": "2018-03-11T01:05:39Z"
  },
  "references": [
    {
      "url": "https://github.com/sshock/AFFLIBv3/commit/435a2ca802358a3debb6d164d2c33049131df81c",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/sshock/AFFLIBv3/commit/435a2ca802358a3debb6d164d2c33049131df81c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.551506",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "AFFLIBv3",
    "owner": "sshock",
    "created_at": "2014-10-03T04:42:16Z",
    "updated_at": "2025-01-12T05:11:42Z",
    "pushed_at": "2024-03-24T15:38:50Z",
    "size": 1088,
    "stars": 83,
    "forks": 22,
    "open_issues": 3,
    "watchers": 83,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 726634,
      "C": 569959,
      "M4": 33672,
      "Makefile": 22391,
      "Shell": 20018,
      "HTML": 15193,
      "Python": 7140,
      "Cython": 3163,
      "Batchfile": 41
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:20:08.289280"
  }
}