{
  "cve_id": "CVE-2018-8729",
  "github_data": {
    "repository": "pojome/activity-log",
    "fix_commit": "950c46b2290c991187ff3471640e9688b16908fb",
    "related_commits": [
      "950c46b2290c991187ff3471640e9688b16908fb",
      "e7bcd12fcb0add82bed762a971f427a360664bd9",
      "950c46b2290c991187ff3471640e9688b16908fb",
      "e7bcd12fcb0add82bed762a971f427a360664bd9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "950c46b2290c991187ff3471640e9688b16908fb",
      "commit_date": "2018-03-08T11:37:03Z",
      "author": {
        "login": "KingYes",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix potential security issue",
        "length": 28,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 9,
        "deletions": 9
      },
      "files": [
        {
          "filename": "classes/class-aal-activity-log-list-table.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -202,16 +202,16 @@ public function column_label( $item ) {\n \t}\n \t\n \tpublic function column_description( $item ) {\n-\t\t$return = $item->object_name;\n+\t\t$return = esc_html( $item->object_name );\n \t\t\n \t\tswitch ( $item->object_type ) {\n \t\t\tcase 'Post' :\n-\t\t\t\t$return = sprintf( '<a href=\"%s\">%s</a>', get_edit_post_link( $item->object_id ), $item->object_name );\n+\t\t\t\t$return = sprintf( '<a href=\"%s\">%s</a>', get_edit_post_link( $item->object_id ), esc_html( $item->object_name ) );\n \t\t\t\tbreak;\n \t\t\t\n \t\t\tcase 'Taxonomy' :\n \t\t\t\tif ( ! empty( $item->object_id ) )\n-\t\t\t\t\t$return = sprintf( '<a href=\"%s\">%s</a>', get_edit_term_link( $item->object_id, $item->object_subtype ), $item->object_name );\n+\t\t\t\t\t$return = sprintf( '<a href=\"%s\">%s</a>', get_edit_term_link( $item->object_id, $item->object_subtype ), esc_html( $item->object_name ) );\n \t\t\t\tbreak;\n \t\t\t\n \t\t\tcase 'Comments' :\n@@ -224,7 +224,7 @@ public function column_description( $item ) {\n \t\t\t\tif ( 'all' === $item->object_name ) {\n \t\t\t\t\t$return = __( 'All', 'aryo-activity-log' );\n \t\t\t\t} else {\n-\t\t\t\t\t$pt     = get_post_type_object( $item->object_name );\n+\t\t\t\t\t$pt = get_post_type_object( $item->object_name );\n \t\t\t\t\t$return = ! empty( $pt->label ) ? $pt->label : $item->object_name;\n \t\t\t\t}\n \t\t\t\tbreak;"
        },
        {
          "filename": "hooks/class-aal-hook-attachment.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -11,7 +11,7 @@ protected function _add_log_attachment( $action, $attachment_id ) {\n \t\t\t'object_type'    => 'Attachment',\n \t\t\t'object_subtype' => $post->post_type,\n \t\t\t'object_id'      => $attachment_id,\n-\t\t\t'object_name'    => get_the_title( $post->ID ),\n+\t\t\t'object_name'    => esc_html( get_the_title( $post->ID ) ),\n \t\t) );\n \t}\n \n@@ -35,4 +35,4 @@ public function __construct() {\n \t\tparent::__construct();\n \t}\n \n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "hooks/class-aal-hook-comments.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -11,7 +11,7 @@ protected function _add_comment_log( $id, $action, $comment = null ) {\n \t\t\t'action'         => $action,\n \t\t\t'object_type'    => 'Comments',\n \t\t\t'object_subtype' => get_post_type( $comment->comment_post_ID ),\n-\t\t\t'object_name'    => get_the_title( $comment->comment_post_ID ),\n+\t\t\t'object_name'    => esc_html( get_the_title( $comment->comment_post_ID ) ),\n \t\t\t'object_id'      => $id,\n \t\t) );\n \t}\n@@ -71,4 +71,4 @@ public function __construct() {\n \t\tparent::__construct();\n \t}\n \t\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "hooks/class-aal-hook-posts.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -4,7 +4,7 @@\n class AAL_Hook_Posts extends AAL_Hook_Base {\n \t\n \tprotected function _draft_or_post_title( $post = 0 ) {\n-\t\t$title = get_the_title( $post );\n+\t\t$title = esc_html( get_the_title( $post ) );\n \t\t\n \t\tif ( empty( $title ) )\n \t\t\t$title = __( '(no title)', 'aryo-activity-log' );"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f75ee2a477ca459a5054014904bca7c97f4ea93e",
            "date": "2024-11-12T14:48:03Z",
            "author_login": "KingYes"
          },
          {
            "sha": "097bf6802f5d72f36289f968feb6b023b0d5ff4b",
            "date": "2024-11-12T12:49:21Z",
            "author_login": "KingYes"
          },
          {
            "sha": "ae8ae22da2395f8b3a4d5c0a61c25de903792f17",
            "date": "2024-11-05T16:47:48Z",
            "author_login": "arielk"
          },
          {
            "sha": "03f7fe57dd8f3dcc6330503bb8492af2a2a5c73a",
            "date": "2024-11-05T16:40:00Z",
            "author_login": "KingYes"
          },
          {
            "sha": "b385bb7f773472a77ddd53b0df8d2a60b454304d",
            "date": "2024-11-05T16:39:55Z",
            "author_login": "KingYes"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Multiple cross-site scripting (XSS) vulnerabilities in the Activity Log plugin before 2.4.1 for WordPress allow remote attackers to inject arbitrary JavaScript or HTML via a title that is not escaped.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-03-15T17:29:00.210",
    "last_modified": "2024-11-21T04:14:13.517",
    "fix_date": "2018-03-08T11:37:03Z"
  },
  "references": [
    {
      "url": "https://github.com/pojome/activity-log/commit/950c46b2290c991187ff3471640e9688b16908fb",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pojome/activity-log/commit/e7bcd12fcb0add82bed762a971f427a360664bd9",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset/1836276",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://wordpress.org/plugins/aryo-activity-log/#developers",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/44437/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/pojome/activity-log/commit/950c46b2290c991187ff3471640e9688b16908fb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pojome/activity-log/commit/e7bcd12fcb0add82bed762a971f427a360664bd9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset/1836276",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://wordpress.org/plugins/aryo-activity-log/#developers",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/44437/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:17.561679",
    "processing_status": "enhanced"
  }
}