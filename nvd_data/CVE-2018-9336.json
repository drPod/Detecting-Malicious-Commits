{
  "cve_id": "CVE-2018-9336",
  "github_data": {
    "repository": "OpenVPN/openvpn",
    "fix_commit": "1394192b210cb3c6624a7419bcf3ff966742e79b",
    "related_commits": [
      "1394192b210cb3c6624a7419bcf3ff966742e79b",
      "1394192b210cb3c6624a7419bcf3ff966742e79b"
    ],
    "patch_url": "https://github.com/OpenVPN/openvpn/commit/1394192b210cb3c6624a7419bcf3ff966742e79b.patch",
    "fix_commit_details": {
      "sha": "1394192b210cb3c6624a7419bcf3ff966742e79b",
      "commit_date": "2018-04-14T07:26:17Z",
      "author": {
        "login": "cron2",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix potential double-free() in Interactive Service (CVE-2018-9336)",
        "length": 1134,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 11,
        "deletions": 12
      },
      "files": [
        {
          "filename": "src/openvpnserv/interactive.c",
          "status": "modified",
          "additions": 11,
          "deletions": 12,
          "patch": "@@ -453,7 +453,6 @@ static BOOL\n GetStartupData(HANDLE pipe, STARTUP_DATA *sud)\n {\n     size_t size, len;\n-    BOOL ret = FALSE;\n     WCHAR *data = NULL;\n     DWORD bytes, read;\n \n@@ -462,38 +461,38 @@ GetStartupData(HANDLE pipe, STARTUP_DATA *sud)\n     {\n         MsgToEventLog(M_SYSERR, TEXT(\"PeekNamedPipeAsync failed\"));\n         ReturnLastError(pipe, L\"PeekNamedPipeAsync\");\n-        goto out;\n+        goto err;\n     }\n \n     size = bytes / sizeof(*data);\n     if (size == 0)\n     {\n         MsgToEventLog(M_SYSERR, TEXT(\"malformed startup data: 1 byte received\"));\n         ReturnError(pipe, ERROR_STARTUP_DATA, L\"GetStartupData\", 1, &exit_event);\n-        goto out;\n+        goto err;\n     }\n \n     data = malloc(bytes);\n     if (data == NULL)\n     {\n         MsgToEventLog(M_SYSERR, TEXT(\"malloc failed\"));\n         ReturnLastError(pipe, L\"malloc\");\n-        goto out;\n+        goto err;\n     }\n \n     read = ReadPipeAsync(pipe, data, bytes, 1, &exit_event);\n     if (bytes != read)\n     {\n         MsgToEventLog(M_SYSERR, TEXT(\"ReadPipeAsync failed\"));\n         ReturnLastError(pipe, L\"ReadPipeAsync\");\n-        goto out;\n+        goto err;\n     }\n \n     if (data[size - 1] != 0)\n     {\n         MsgToEventLog(M_ERR, TEXT(\"Startup data is not NULL terminated\"));\n         ReturnError(pipe, ERROR_STARTUP_DATA, L\"GetStartupData\", 1, &exit_event);\n-        goto out;\n+        goto err;\n     }\n \n     sud->directory = data;\n@@ -503,7 +502,7 @@ GetStartupData(HANDLE pipe, STARTUP_DATA *sud)\n     {\n         MsgToEventLog(M_ERR, TEXT(\"Startup data ends at working directory\"));\n         ReturnError(pipe, ERROR_STARTUP_DATA, L\"GetStartupData\", 1, &exit_event);\n-        goto out;\n+        goto err;\n     }\n \n     sud->options = sud->directory + len;\n@@ -513,16 +512,16 @@ GetStartupData(HANDLE pipe, STARTUP_DATA *sud)\n     {\n         MsgToEventLog(M_ERR, TEXT(\"Startup data ends at command line options\"));\n         ReturnError(pipe, ERROR_STARTUP_DATA, L\"GetStartupData\", 1, &exit_event);\n-        goto out;\n+        goto err;\n     }\n \n     sud->std_input = sud->options + len;\n-    data = NULL; /* don't free data */\n-    ret = TRUE;\n+    return TRUE;\n \n-out:\n+err:\n+    sud->directory = NULL;\t\t/* caller must not free() */\n     free(data);\n-    return ret;\n+    return FALSE;\n }\n \n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8084990ccecbf803498419e553bc1a6f073f8175",
            "date": "2024-12-31T20:46:29Z",
            "author_login": "mathstuf"
          },
          {
            "sha": "cb9fdc8479a2744b9db95ef8ef97222ee86454fd",
            "date": "2025-01-14T13:49:09Z",
            "author_login": "schwabe"
          },
          {
            "sha": "5e086c08f2ce4428fd014b74441f0197a71d6da8",
            "date": "2025-01-13T11:22:26Z",
            "author_login": "flichtenheld"
          },
          {
            "sha": "0671a4d009ae89870b645d1a8f3078d9943d5010",
            "date": "2025-01-09T21:28:03Z",
            "author_login": "schwabe"
          },
          {
            "sha": "92adbc88b1b37095cebde2a1c5b6ae242f382678",
            "date": "2025-01-09T18:05:37Z",
            "author_login": "schwabe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-415",
    "description": "openvpnserv.exe (aka the interactive service helper) in OpenVPN 2.4.x before 2.4.6 allows a local attacker to cause a double-free of memory by sending a malformed request to the interactive service. This could cause a denial-of-service through memory corruption or possibly have unspecified other impact including privilege escalation.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2018-05-01T18:29:00.697",
    "last_modified": "2024-11-21T04:15:21.590",
    "fix_date": "2018-04-14T07:26:17Z"
  },
  "references": [
    {
      "url": "http://www.slackware.com/security/viewer.php?l=slackware-security&y=2018&m=slackware-security.568761",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://community.openvpn.net/openvpn/wiki/ChangesInOpenvpn24",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenVPN/openvpn/commit/1394192b210cb3c6624a7419bcf3ff966742e79b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenVPN/openvpn/releases/tag/v2.4.6",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/security/research/tra-2018-09",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.slackware.com/security/viewer.php?l=slackware-security&y=2018&m=slackware-security.568761",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://community.openvpn.net/openvpn/wiki/ChangesInOpenvpn24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenVPN/openvpn/commit/1394192b210cb3c6624a7419bcf3ff966742e79b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenVPN/openvpn/releases/tag/v2.4.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/security/research/tra-2018-09",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:25.825067",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "openvpn",
    "owner": "OpenVPN",
    "created_at": "2012-04-26T20:42:48Z",
    "updated_at": "2025-01-14T17:17:48Z",
    "pushed_at": "2025-01-14T17:17:41Z",
    "size": 22350,
    "stars": 11246,
    "forks": 3045,
    "open_issues": 143,
    "watchers": 11246,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/2.1",
      "release/2.2",
      "release/2.3",
      "release/2.4",
      "release/2.5",
      "release/2.6"
    ],
    "languages": {
      "C": 4136752,
      "Shell": 72794,
      "M4": 59590,
      "CMake": 48596,
      "Makefile": 30232,
      "Python": 15180,
      "BitBake": 645
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:21:15.243666"
  }
}