{
  "cve_id": "CVE-2018-9839",
  "github_data": {
    "repository": "mantisbt/mantisbt",
    "fix_commit": "1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea",
    "related_commits": [
      "1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea",
      "1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea",
      "commit_date": "2018-04-25T16:31:45Z",
      "author": {
        "login": "dregad",
        "type": "User",
        "stats": {
          "total_commits": 3418,
          "average_weekly_commits": 2.886824324324324,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 500
        }
      },
      "commit_message": {
        "title": "Prevent cloning private issues by unauthorized users",
        "length": 1503,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
      },
      "files": [
        {
          "filename": "bug_report.php",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -69,6 +69,10 @@\n \n if( $f_master_bug_id > 0 ) {\n \tbug_ensure_exists( $f_master_bug_id );\n+\n+\t# User can view the master bug\n+\taccess_ensure_bug_level( config_get( 'view_bug_threshold' ), $f_master_bug_id );\n+\n \tif( bug_is_readonly( $f_master_bug_id ) ) {\n \t\terror_parameters( $f_master_bug_id );\n \t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );"
        },
        {
          "filename": "bug_report_page.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -89,6 +89,9 @@\n \t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n \t}\n \n+\t# User can view the master bug\n+\taccess_ensure_bug_level( config_get( 'view_bug_threshold' ), $f_master_bug_id );\n+\n \t$t_bug = bug_get( $f_master_bug_id, true );\n \n \t#@@@ (thraxisp) Note that the master bug is cloned into the same project as the master, independent of"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "924fb05df417dc639fd50a518dba20531a322851",
            "date": "2025-01-23T12:46:58Z",
            "author_login": "dregad"
          },
          {
            "sha": "60cb1d4e48e3e4578a1b8f662e22ba59dea9cb21",
            "date": "2025-01-23T12:41:32Z",
            "author_login": "raspopov"
          },
          {
            "sha": "7626b72778eaa1d3767b21f613219b0d1c46d9ca",
            "date": "2025-01-23T12:29:11Z",
            "author_login": "dregad"
          },
          {
            "sha": "4994c09658dd16045cc2ff62f184842029fb43fc",
            "date": "2025-01-23T12:07:11Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "64a6c746c971d6f7ecc3063f5bafe9cb357cca93",
            "date": "2025-01-20T12:07:27Z",
            "author_login": "translatewiki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "An issue was discovered in MantisBT through 1.3.14, and 2.0.0. Using a crafted request on bug_report_page.php (modifying the 'm_id' parameter), any user with REPORTER access or above is able to view any private issue's details (summary, description, steps to reproduce, additional information) when cloning it. By checking the 'Copy issue notes' and 'Copy attachments' checkboxes and completing the clone operation, this data also becomes public (except private notes).",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-06-06T19:29:00.297",
    "last_modified": "2024-11-21T04:15:46.760",
    "fix_date": "2018-04-25T16:31:45Z"
  },
  "references": [
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://mantisbt.org/bugs/view.php?id=24221",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mantisbt/mantisbt/commit/1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://mantisbt.org/bugs/view.php?id=24221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:52.552488",
    "processing_status": "enhanced"
  }
}