{
  "cve_id": "CVE-2019-1010239",
  "github_data": {
    "repository": "DaveGamble/cJSON",
    "fix_commit": "be749d7efa7c9021da746e685bd6dec79f9dd99b",
    "related_commits": [
      "be749d7efa7c9021da746e685bd6dec79f9dd99b",
      "be749d7efa7c9021da746e685bd6dec79f9dd99b"
    ],
    "patch_url": "https://github.com/DaveGamble/cJSON/commit/be749d7efa7c9021da746e685bd6dec79f9dd99b.patch",
    "fix_commit_details": {
      "sha": "be749d7efa7c9021da746e685bd6dec79f9dd99b",
      "commit_date": "2018-12-16T10:06:40Z",
      "author": {
        "login": "FSMaxB",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix crash of cJSON_GetObjectItemCaseSensitive when calling it on arrays",
        "length": 71,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 29,
        "deletions": 1
      },
      "files": [
        {
          "filename": "cJSON.c",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -1781,7 +1781,7 @@ static cJSON *get_object_item(const cJSON * const object, const char * const nam\n     current_element = object->child;\n     if (case_sensitive)\n     {\n-        while ((current_element != NULL) && (strcmp(name, current_element->string) != 0))\n+        while ((current_element != NULL) && (current_element->string != NULL) && (strcmp(name, current_element->string) != 0))\n         {\n             current_element = current_element->next;\n         }\n@@ -1794,6 +1794,10 @@ static cJSON *get_object_item(const cJSON * const object, const char * const nam\n         }\n     }\n \n+    if ((current_element == NULL) || (current_element->string == NULL)) {\n+        return NULL;\n+    }\n+\n     return current_element;\n }\n "
        },
        {
          "filename": "tests/misc_tests.c",
          "status": "modified",
          "additions": 24,
          "deletions": 0,
          "patch": "@@ -127,6 +127,28 @@ static void cjson_get_object_item_case_sensitive_should_get_object_items(void)\n     cJSON_Delete(item);\n }\n \n+static void cjson_get_object_item_should_not_crash_with_array(void) {\n+    cJSON *array = NULL;\n+    cJSON *found = NULL;\n+    array = cJSON_Parse(\"[1]\");\n+\n+    found = cJSON_GetObjectItem(array, \"name\");\n+    TEST_ASSERT_NULL(found);\n+\n+    cJSON_Delete(array);\n+}\n+\n+static void cjson_get_object_item_case_sensitive_should_not_crash_with_array(void) {\n+    cJSON *array = NULL;\n+    cJSON *found = NULL;\n+    array = cJSON_Parse(\"[1]\");\n+\n+    found = cJSON_GetObjectItemCaseSensitive(array, \"name\");\n+    TEST_ASSERT_NULL(found);\n+\n+    cJSON_Delete(array);\n+}\n+\n static void typecheck_functions_should_check_type(void)\n {\n     cJSON invalid[1];\n@@ -535,6 +557,8 @@ int CJSON_CDECL main(void)\n     RUN_TEST(cjson_array_foreach_should_not_dereference_null_pointer);\n     RUN_TEST(cjson_get_object_item_should_get_object_items);\n     RUN_TEST(cjson_get_object_item_case_sensitive_should_get_object_items);\n+    RUN_TEST(cjson_get_object_item_should_not_crash_with_array);\n+    RUN_TEST(cjson_get_object_item_case_sensitive_should_not_crash_with_array);\n     RUN_TEST(typecheck_functions_should_check_type);\n     RUN_TEST(cjson_should_not_parse_to_deeply_nested_jsons);\n     RUN_TEST(cjson_set_number_value_should_set_numbers);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "12c4bf1986c288950a3d06da757109a6aa1ece38",
            "date": "2024-08-30T13:09:28Z",
            "author_login": "vwvw"
          },
          {
            "sha": "9d1b229086a7b069fb5f4e3be0226a22480a6707",
            "date": "2024-08-30T11:36:22Z",
            "author_login": "vwvw"
          },
          {
            "sha": "078c4e6c53f13dff15f0eaac1611abb6379e0206",
            "date": "2024-08-26T07:48:59Z",
            "author_login": "vwvw"
          },
          {
            "sha": "4f4d7f70c253927c4d8130771168c9fa7864d2d4",
            "date": "2024-08-25T21:06:21Z",
            "author_login": "vwvw"
          },
          {
            "sha": "b47edc4750301a17bcc72bf20323d2f625a4ae05",
            "date": "2024-08-25T20:32:02Z",
            "author_login": "vwvw"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-476",
    "description": "DaveGamble/cJSON cJSON 1.7.8 is affected by: Improper Check for Unusual or Exceptional Conditions. The impact is: Null dereference, so attack can cause denial of service. The component is: cJSON_GetObjectItemCaseSensitive() function. The attack vector is: crafted json file. The fixed version is: 1.7.9 and later.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-07-19T17:15:11.783",
    "last_modified": "2024-11-21T04:18:04.983",
    "fix_date": "2018-12-16T10:06:40Z"
  },
  "references": [
    {
      "url": "https://github.com/DaveGamble/cJSON/commit/be749d7efa7c9021da746e685bd6dec79f9dd99b",
      "source": "josh@bress.net",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DaveGamble/cJSON/issues/315",
      "source": "josh@bress.net",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2020.html",
      "source": "josh@bress.net",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DaveGamble/cJSON/commit/be749d7efa7c9021da746e685bd6dec79f9dd99b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DaveGamble/cJSON/issues/315",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:54.799099",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cJSON",
    "owner": "DaveGamble",
    "created_at": "2016-03-19T18:22:54Z",
    "updated_at": "2025-01-14T06:35:37Z",
    "pushed_at": "2024-09-23T11:08:58Z",
    "size": 2572,
    "stars": 11041,
    "forks": 3232,
    "open_issues": 250,
    "watchers": 11041,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 708394,
      "Ruby": 131482,
      "CMake": 17813,
      "Makefile": 13634,
      "Python": 11112,
      "Shell": 874
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:16:01.805557"
  }
}