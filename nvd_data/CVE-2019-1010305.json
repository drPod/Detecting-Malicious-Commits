{
  "cve_id": "CVE-2019-1010305",
  "github_data": {
    "repository": "kyz/libmspack",
    "fix_commit": "2f084136cfe0d05e5bf5703f3e83c6d955234b4d",
    "related_commits": [
      "2f084136cfe0d05e5bf5703f3e83c6d955234b4d",
      "2f084136cfe0d05e5bf5703f3e83c6d955234b4d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2f084136cfe0d05e5bf5703f3e83c6d955234b4d",
      "commit_date": "2019-02-18T13:04:58Z",
      "author": {
        "login": "kyz",
        "type": "User",
        "stats": {
          "total_commits": 408,
          "average_weekly_commits": 0.36526410026857653,
          "total_additions": 186528,
          "total_deletions": 161284,
          "weeks_active": 99
        }
      },
      "commit_message": {
        "title": "length checks when looking for control files",
        "length": 44,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 32,
        "additions": 19,
        "deletions": 13
      },
      "files": [
        {
          "filename": "libmspack/ChangeLog",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -1,3 +1,11 @@\n+2019-02-18  Stuart Caie <kyzer@cabextract.org.uk>\n+\n+\t* chmd_read_headers(): a CHM file name beginning \"::\" but shorter\n+\tthan 33 bytes will lead to reading past the freshly-allocated name\n+\tbuffer - checks for specific control filenames didn't take length\n+\tinto account. Thanks to ADLab of Venustech for the report and\n+\tproof of concept.\n+\n 2018-11-03  Stuart Caie <kyzer@cabextract.org.uk>\n \n \t* configure.ac, doc/Makefile.in, doc/Doxyfile.in: remove these"
        },
        {
          "filename": "libmspack/mspack/chmd.c",
          "status": "modified",
          "additions": 11,
          "deletions": 13,
          "patch": "@@ -483,19 +483,17 @@ static int chmd_read_headers(struct mspack_system *sys, struct mspack_file *fh,\n \n       if (name[0] == ':' && name[1] == ':') {\n         /* system file */\n-        if (memcmp(&name[2], &content_name[2], 31L) == 0) {\n-          if (memcmp(&name[33], &content_name[33], 8L) == 0) {\n-            chm->sec1.content = fi;\n-          }\n-          else if (memcmp(&name[33], &control_name[33], 11L) == 0) {\n-            chm->sec1.control = fi;\n-          }\n-          else if (memcmp(&name[33], &spaninfo_name[33], 8L) == 0) {\n-            chm->sec1.spaninfo = fi;\n-          }\n-          else if (memcmp(&name[33], &rtable_name[33], 72L) == 0) {\n-            chm->sec1.rtable = fi;\n-          }\n+        if (name_len == 40 && memcmp(name, content_name, 40) == 0) {\n+          chm->sec1.content = fi;\n+        }\n+        else if (name_len == 44 && memcmp(name, control_name, 44) == 0) {\n+          chm->sec1.control = fi;\n+        }\n+        else if (name_len == 41 && memcmp(name, spaninfo_name, 41) == 0) {\n+          chm->sec1.spaninfo = fi;\n+        }\n+        else if (name_len == 105 && memcmp(name, rtable_name, 105) == 0) {\n+          chm->sec1.rtable = fi;\n         }\n         fi->next = chm->sysfiles;\n         chm->sysfiles = fi;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "305907723a4e7ab2018e58040059ffb5e77db837",
            "date": "2023-02-24T12:01:05Z",
            "author_login": "kyz"
          },
          {
            "sha": "e1d7bdd6d8f1a8ee863f1b33188c2b2fb1117d29",
            "date": "2023-02-24T12:00:46Z",
            "author_login": "kyz"
          },
          {
            "sha": "a1be011bdd4a5ff5fe5a88bffc4dd90938709a6f",
            "date": "2023-02-24T12:00:27Z",
            "author_login": "kyz"
          },
          {
            "sha": "d80cd5ee33d494ab3a08eb8e79c7d97776f6b973",
            "date": "2023-02-24T11:58:31Z",
            "author_login": "kyz"
          },
          {
            "sha": "66d24943a0e9ff5fd03beb26848e907c22849be9",
            "date": "2023-02-24T11:56:16Z",
            "author_login": "kyz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-119",
    "description": "libmspack 0.9.1alpha is affected by: Buffer Overflow. The impact is: Information Disclosure. The component is: function chmd_read_headers() in libmspack(file libmspack/mspack/chmd.c). The attack vector is: the victim must open a specially crafted chm file. The fixed version is: after commit 2f084136cfe0d05e5bf5703f3e83c6d955234b4d.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-07-15T15:15:11.377",
    "last_modified": "2024-11-21T04:18:08.950",
    "fix_date": "2019-02-18T13:04:58Z"
  },
  "references": [
    {
      "url": "https://github.com/kyz/libmspack/commit/2f084136cfe0d05e5bf5703f3e83c6d955234b4d",
      "source": "josh@bress.net",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kyz/libmspack/issues/27",
      "source": "josh@bress.net",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/08/msg00028.html",
      "source": "josh@bress.net",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/10/msg00033.html",
      "source": "josh@bress.net",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/IXWNEY4CJBLPRKV6LG7FQUPD6WVZYBTB/",
      "source": "josh@bress.net",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/S2QJTUAGP22YY7453MHGTFN4YQE5HJBR/",
      "source": "josh@bress.net",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/4066-1/",
      "source": "josh@bress.net",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4066-2/",
      "source": "josh@bress.net",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kyz/libmspack/commit/2f084136cfe0d05e5bf5703f3e83c6d955234b4d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kyz/libmspack/issues/27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/08/msg00028.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/10/msg00033.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/IXWNEY4CJBLPRKV6LG7FQUPD6WVZYBTB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/S2QJTUAGP22YY7453MHGTFN4YQE5HJBR/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/4066-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4066-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:54.785398",
    "processing_status": "enhanced"
  }
}