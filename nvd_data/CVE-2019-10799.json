{
  "cve_id": "CVE-2019-10799",
  "github_data": {
    "repository": "eiskalteschatten/compile-sass",
    "fix_commit": "d9ada7797ff93875b6466dea7a78768e90a0f8d2",
    "related_commits": [
      "d9ada7797ff93875b6466dea7a78768e90a0f8d2",
      "d9ada7797ff93875b6466dea7a78768e90a0f8d2"
    ],
    "patch_url": "https://github.com/eiskalteschatten/compile-sass/commit/d9ada7797ff93875b6466dea7a78768e90a0f8d2.patch",
    "fix_commit_details": {
      "sha": "d9ada7797ff93875b6466dea7a78768e90a0f8d2",
      "commit_date": "2020-02-21T12:17:07Z",
      "author": {
        "login": "eiskalteschatten",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix a security vulnerability",
        "length": 28,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 61,
        "additions": 37,
        "deletions": 24
      },
      "files": [
        {
          "filename": "Readme.md",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -183,6 +183,11 @@ process.on('SIGINT', () => {\n \n ## Release Notes\n \n+### 1.0.5\n+\n+- Fix a critical security vulnerability\n+\n+\n ### 1.0.4\n \n - Security updates"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 16,
          "deletions": 16,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"compile-sass\",\n-  \"version\": \"1.0.4\",\n+  \"version\": \"1.0.5\",\n   \"lockfileVersion\": 1,\n   \"requires\": true,\n   \"dependencies\": {\n@@ -589,9 +589,9 @@\n       }\n     },\n     \"@types/babel__core\": {\n-      \"version\": \"7.1.4\",\n-      \"resolved\": \"https://registry.npmjs.org/@types/babel__core/-/babel__core-7.1.4.tgz\",\n-      \"integrity\": \"sha512-c/5MuRz5HM4aizqL5ViYfW4iEnmfPcfbH4Xa6GgLT21dMc1NGeNnuS6egHheOmP+kCJ9CAzC4pv4SDCWTnRkbg==\",\n+      \"version\": \"7.1.5\",\n+      \"resolved\": \"https://registry.npmjs.org/@types/babel__core/-/babel__core-7.1.5.tgz\",\n+      \"integrity\": \"sha512-+ckxwNj892FWgvwrUWLOghQ2JDgOgeqTPwrcl+0t1pG59CP8qMJ6S/efmEd999vCFSJKOpyMakvU+w380rduUQ==\",\n       \"dev\": true,\n       \"requires\": {\n         \"@babel/parser\": \"^7.1.0\",\n@@ -621,9 +621,9 @@\n       }\n     },\n     \"@types/babel__traverse\": {\n-      \"version\": \"7.0.8\",\n-      \"resolved\": \"https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.0.8.tgz\",\n-      \"integrity\": \"sha512-yGeB2dHEdvxjP0y4UbRtQaSkXJ9649fYCmIdRoul5kfAoGCwxuCbMhag0k3RPfnuh9kPGm8x89btcfDEXdVWGw==\",\n+      \"version\": \"7.0.9\",\n+      \"resolved\": \"https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.0.9.tgz\",\n+      \"integrity\": \"sha512-jEFQ8L1tuvPjOI8lnpaf73oCJe+aoxL6ygqSy6c8LcW98zaC+4mzWuQIRCEvKeCOu+lbqdXcg4Uqmm1S8AP1tw==\",\n       \"dev\": true,\n       \"requires\": {\n         \"@babel/types\": \"^7.3.0\"\n@@ -673,9 +673,9 @@\n       }\n     },\n     \"@types/node\": {\n-      \"version\": \"12.12.27\",\n-      \"resolved\": \"https://registry.npmjs.org/@types/node/-/node-12.12.27.tgz\",\n-      \"integrity\": \"sha512-odQFl/+B9idbdS0e8IxDl2ia/LP8KZLXhV3BUeI98TrZp0uoIzQPhGd+5EtzHmT0SMOIaPd7jfz6pOHLWTtl7A==\",\n+      \"version\": \"12.12.28\",\n+      \"resolved\": \"https://registry.npmjs.org/@types/node/-/node-12.12.28.tgz\",\n+      \"integrity\": \"sha512-g73GJYJDXgf0jqg+P9S8h2acWbDXNkoCX8DLtJVu7Fkn788pzQ/oJsrdJz/2JejRf/SjfZaAhsw+3nd1D5EWGg==\",\n       \"dev\": true\n     },\n     \"@types/node-sass\": {\n@@ -4595,9 +4595,9 @@\n       }\n     },\n     \"make-error\": {\n-      \"version\": \"1.3.5\",\n-      \"resolved\": \"https://registry.npmjs.org/make-error/-/make-error-1.3.5.tgz\",\n-      \"integrity\": \"sha512-c3sIjNUow0+8swNwVpqoH4YCShKNFkMaw6oH1mNS2haDZQqkeZFlHS3dhoeEbKKmJB4vXpJucU6oH75aDYeE9g==\",\n+      \"version\": \"1.3.6\",\n+      \"resolved\": \"https://registry.npmjs.org/make-error/-/make-error-1.3.6.tgz\",\n+      \"integrity\": \"sha512-s8UhlNe7vPKomQhC1qFelMokr/Sc3AgNbso3n74mVPA5LTZwkB9NlXf4XPamLxJE8h0gh73rM94xvwRT2CVInw==\",\n       \"dev\": true\n     },\n     \"makeerror\": {\n@@ -6382,9 +6382,9 @@\n       }\n     },\n     \"typescript\": {\n-      \"version\": \"3.7.5\",\n-      \"resolved\": \"https://registry.npmjs.org/typescript/-/typescript-3.7.5.tgz\",\n-      \"integrity\": \"sha512-/P5lkRXkWHNAbcJIiHPfRoKqyd7bsyCma1hZNUGfn20qm64T6ZBlrzprymeu918H+mB/0rIg2gGK/BXkhhYgBw==\",\n+      \"version\": \"3.8.2\",\n+      \"resolved\": \"https://registry.npmjs.org/typescript/-/typescript-3.8.2.tgz\",\n+      \"integrity\": \"sha512-EgOVgL/4xfVrCMbhYKUQTdF37SQn4Iw73H5BgCrF1Abdun7Kwy/QZsE/ssAy0y4LxBbvua3PIbFsbRczWWnDdQ==\",\n       \"dev\": true\n     },\n     \"union-value\": {"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"compile-sass\",\n-  \"version\": \"1.0.4\",\n+  \"version\": \"1.0.5\",\n   \"description\": \"A module to compile SASS on-the-fly and/or save it to CSS files\",\n   \"main\": \"dist/index.js\",\n   \"typings\": \"dist/index.d.ts\","
        },
        {
          "filename": "src/index.ts",
          "status": "modified",
          "additions": 15,
          "deletions": 7,
          "patch": "@@ -144,16 +144,24 @@ export function setupCleanupOnExit(cssPath: string) {\n     process.on('SIGINT', () => {\n       console.log('Exiting, running CSS cleanup');\n \n-      exec(`rm -r ${cssPath}`, function(error) {\n-        if (error) {\n-          console.error(error);\n+      fs.lstat(cssPath, (error: Error, stats: fs.Stats): void => {\n+        if (stats.isDirectory) {\n+          exec(`rm -r ${cssPath}`, function(error) {\n+            if (error) {\n+              console.error(error);\n+              process.exit(1);\n+            }\n+    \n+            console.log('Deleted CSS files');\n+          });\n+        }\n+        else {\n+          console.error('Could not delete CSS files because the given path is not a directory:', cssPath);\n           process.exit(1);\n         }\n-\n-        console.log('Deleted CSS files');\n       });\n+  \n+      hasSetupCleanupOnExit = true;        \n     });\n-\n-    hasSetupCleanupOnExit = true;\n   }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5320450ecf1c1f553c2e42bdaae821a93ebf1ef9",
            "date": "2024-10-19T10:48:20Z",
            "author_login": "eiskalteschatten"
          },
          {
            "sha": "f7dbbd9655135c542a713694f153b0f6cce09c44",
            "date": "2024-10-19T10:26:15Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "9381387d2d94852b8e16cadf915d712e7ca0db7b",
            "date": "2024-09-17T20:25:39Z",
            "author_login": "eiskalteschatten"
          },
          {
            "sha": "3575cc5a880ed25882bea1402722ec5f828cceed",
            "date": "2024-09-17T20:22:20Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a4e8bf62c3385b05f22416edaeee2b7f4b291d7c",
            "date": "2024-06-23T10:01:19Z",
            "author_login": "eiskalteschatten"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N",
    "cwe_id": "CWE-78",
    "description": "compile-sass prior to 1.0.5 allows execution of arbritary commands. The function \"setupCleanupOnExit(cssPath)\" within \"dist/index.js\" is executed as part of the \"rm\" command without any sanitization.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-02-24T18:15:15.290",
    "last_modified": "2024-11-21T04:19:56.607",
    "fix_date": "2020-02-21T12:17:07Z"
  },
  "references": [
    {
      "url": "https://github.com/eiskalteschatten/compile-sass/commit/d9ada7797ff93875b6466dea7a78768e90a0f8d2",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-COMPILESASS-551804",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eiskalteschatten/compile-sass/commit/d9ada7797ff93875b6466dea7a78768e90a0f8d2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-COMPILESASS-551804",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:39.864620",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "compile-sass",
    "owner": "eiskalteschatten",
    "created_at": "2017-12-14T10:28:25Z",
    "updated_at": "2024-10-19T10:48:26Z",
    "pushed_at": "2024-10-19T10:49:11Z",
    "size": 663,
    "stars": 4,
    "forks": 5,
    "open_issues": 0,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "TypeScript": 8670,
      "JavaScript": 282,
      "SCSS": 100
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T23:04:33.805840"
  }
}