{
  "cve_id": "CVE-2019-11409",
  "github_data": {
    "repository": "fusionpbx/fusionpbx",
    "fix_commit": "e43ca27ba2d9c0109a6bf198fe2f8d79f63e0611",
    "related_commits": [
      "e43ca27ba2d9c0109a6bf198fe2f8d79f63e0611",
      "e43ca27ba2d9c0109a6bf198fe2f8d79f63e0611"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e43ca27ba2d9c0109a6bf198fe2f8d79f63e0611",
      "commit_date": "2019-04-05T22:40:17Z",
      "author": {
        "login": "markjcrane",
        "type": "User",
        "stats": {
          "total_commits": 13715,
          "average_weekly_commits": 20.748865355521936,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 656
        }
      },
      "commit_message": {
        "title": "Update exec.php",
        "length": 15,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 191,
        "additions": 105,
        "deletions": 86
      },
      "files": [
        {
          "filename": "app/operator_panel/exec.php",
          "status": "modified",
          "additions": 105,
          "deletions": 86,
          "patch": "@@ -81,104 +81,123 @@\n \t//setup the event socket connection\n \t\t$fp = event_socket_create($_SESSION['event_socket_ip_address'], $_SESSION['event_socket_port'], $_SESSION['event_socket_password']);\n \n-\tif (stristr($action, 'user_status') == true) {\n-\t\t$user_status = $data;\n-\t\tswitch ($user_status) {\n-\t\tcase \"Available\":\n-\t\t\t$user_status = \"Available\";\n-\t\t\t//update the user state\n-\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n-\t\t\t$response = event_socket_request($fp, $cmd);\n-\t\t\tbreak;\n-\t\tcase \"Available_On_Demand\":\n-\t\t\t$user_status = \"Available (On Demand)\";\n-\t\t\t//update the user state\n-\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n-\t\t\t$response = event_socket_request($fp, $cmd);\n-\t\t\tbreak;\n-\t\tcase \"Logged_Out\":\n-\t\t\t$user_status = \"Logged Out\";\n-\t\t\t//update the user state\n-\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n-\t\t\t$response = event_socket_request($fp, $cmd);\n-\t\t\tbreak;\n-\t\tcase \"On_Break\":\n-\t\t\t$user_status = \"On Break\";\n-\t\t\t//update the user state\n-\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n-\t\t\t$response = event_socket_request($fp, $cmd);\n-\t\t\tbreak;\n-\t\tcase \"Do_Not_Disturb\":\n-\t\t\t$user_status = \"Do Not Disturb\";\n-\t\t\t//update the user state\n-\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n-\t\t\t$response = event_socket_request($fp, $cmd);\n-\t\t\tbreak;\n-\t\tdefault:\n-\t\t\t$user_status = \"\";\n+\t//get the status\n+\t\tif (stristr($action, 'user_status') == true) {\n+\t\t\t$user_status = $data;\n+\t\t\tswitch ($user_status) {\n+\t\t\tcase \"Available\":\n+\t\t\t\t$user_status = \"Available\";\n+\t\t\t\t//update the user state\n+\t\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n+\t\t\t\t$response = event_socket_request($fp, $cmd);\n+\t\t\t\tbreak;\n+\t\t\tcase \"Available_On_Demand\":\n+\t\t\t\t$user_status = \"Available (On Demand)\";\n+\t\t\t\t//update the user state\n+\t\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n+\t\t\t\t$response = event_socket_request($fp, $cmd);\n+\t\t\t\tbreak;\n+\t\t\tcase \"Logged_Out\":\n+\t\t\t\t$user_status = \"Logged Out\";\n+\t\t\t\t//update the user state\n+\t\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n+\t\t\t\t$response = event_socket_request($fp, $cmd);\n+\t\t\t\tbreak;\n+\t\t\tcase \"On_Break\":\n+\t\t\t\t$user_status = \"On Break\";\n+\t\t\t\t//update the user state\n+\t\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n+\t\t\t\t$response = event_socket_request($fp, $cmd);\n+\t\t\t\tbreak;\n+\t\t\tcase \"Do_Not_Disturb\":\n+\t\t\t\t$user_status = \"Do Not Disturb\";\n+\t\t\t\t//update the user state\n+\t\t\t\t$cmd = \"api callcenter_config agent set state \".$username.\"@\".$_SESSION['domain_name'].\" Waiting\";\n+\t\t\t\t$response = event_socket_request($fp, $cmd);\n+\t\t\t\tbreak;\n+\t\t\tdefault:\n+\t\t\t\t$user_status = \"\";\n+\t\t\t}\n \t\t}\n-\t}\n \n-\t//fs cmd\n-\tif (strlen($switch_cmd) > 0) {\n+\t//allow specific commands\n+\t\tif (strlen($switch_cmd) > 0) {\n+\t\t\tif (stristr($switch_cmd, 'originate') == true) {}\n+\t\t\telseif (stristr($switch_cmd, 'uuid_record') == true) {}\n+\t\t\telseif (stristr($switch_cmd, 'uuid_transfer') == true) {}\n+\t\t\telseif (stristr($switch_cmd, 'eavesdrop') == true) {}\n+\t\t\telseif (stristr($switch_cmd, 'uuid_kill') == true) {}\n+\t\t\telse {\n+\t\t\t\t$switch_cmd = '';\n+\t\t\t}\n+\t\t\tif (stristr($switch_cmd, 'system') == true) {\n+\t\t\t\t$switch_cmd = '';\n+\t\t\t}\n+\t\t}\n \n-\t\t//set the status so they are compatible with mod_callcenter\n+\t//switch cmd\n+\t\tif (strlen($switch_cmd) > 0) {\n+\n+\t\t\t//set the status so they are compatible with mod_callcenter\n \t\t\t$switch_cmd = str_replace(\"Available_On_Demand\", \"'Available (On Demand)'\", $switch_cmd);\n \t\t\t$switch_cmd = str_replace(\"Logged_Out\", \"'Logged Out'\", $switch_cmd);\n \t\t\t$switch_cmd = str_replace(\"On_Break\", \"'On Break'\", $switch_cmd);\n \t\t\t$switch_cmd = str_replace(\"Do_Not_Disturb\", \"'Logged Out'\", $switch_cmd);\n \n-\t\t/*\n-\t\t//if ($action == \"energy\") {\n-\t\t\t//conference 3001-example.org energy 103\n-\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n-\t\t\t$result_array = explode(\"=\",$switch_result);\n-\t\t\t$tmp_value = $result_array[1];\n-\t\t\t//if ($direction == \"up\") { $tmp_value = $tmp_value + 100; }\n-\t\t\t//if ($direction == \"down\") { $tmp_value = $tmp_value - 100; }\n-\t\t\t//echo \"energy $tmp_value<br />\\n\";\n-\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd.' '.$tmp_value);\n-\t\t//}\n-\t\tif ($action == \"volume_in\") {\n-\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n-\t\t\t$result_array = explode(\"=\",$switch_result);\n-\t\t\t$tmp_value = $result_array[1];\n-\t\t\tif ($direction == \"up\") { $tmp_value = $tmp_value + 1; }\n-\t\t\tif ($direction == \"down\") { $tmp_value = $tmp_value - 1; }\n-\t\t\t//echo \"volume $tmp_value<br />\\n\";\n-\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd.' '.$tmp_value);\n-\t\t}\n-\t\tif ($action == \"volume_out\") {\n+\t\t\t/*\n+\t\t\t//if ($action == \"energy\") {\n+\t\t\t\t//conference 3001-example.org energy 103\n+\t\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n+\t\t\t\t$result_array = explode(\"=\",$switch_result);\n+\t\t\t\t$tmp_value = $result_array[1];\n+\t\t\t\t//if ($direction == \"up\") { $tmp_value = $tmp_value + 100; }\n+\t\t\t\t//if ($direction == \"down\") { $tmp_value = $tmp_value - 100; }\n+\t\t\t\t//echo \"energy $tmp_value<br />\\n\";\n+\t\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd.' '.$tmp_value);\n+\t\t\t//}\n+\t\t\tif ($action == \"volume_in\") {\n+\t\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n+\t\t\t\t$result_array = explode(\"=\",$switch_result);\n+\t\t\t\t$tmp_value = $result_array[1];\n+\t\t\t\tif ($direction == \"up\") { $tmp_value = $tmp_value + 1; }\n+\t\t\t\tif ($direction == \"down\") { $tmp_value = $tmp_value - 1; }\n+\t\t\t\t//echo \"volume $tmp_value<br />\\n\";\n+\t\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd.' '.$tmp_value);\n+\t\t\t}\n+\t\t\tif ($action == \"volume_out\") {\n+\t\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n+\t\t\t\t$result_array = explode(\"=\",$switch_result);\n+\t\t\t\t$tmp_value = $result_array[1];\n+\t\t\t\tif ($direction == \"up\") { $tmp_value = $tmp_value + 1; }\n+\t\t\t\tif ($direction == \"down\") { $tmp_value = $tmp_value - 1; }\n+\t\t\t\t//echo \"volume $tmp_value<br />\\n\";\n+\t\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd.' '.$tmp_value);\n+\t\t\t}\n+\t\t\t*/\n+\n+\t\t\t//run the command\n \t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n-\t\t\t$result_array = explode(\"=\",$switch_result);\n-\t\t\t$tmp_value = $result_array[1];\n-\t\t\tif ($direction == \"up\") { $tmp_value = $tmp_value + 1; }\n-\t\t\tif ($direction == \"down\") { $tmp_value = $tmp_value - 1; }\n-\t\t\t//echo \"volume $tmp_value<br />\\n\";\n-\t\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd.' '.$tmp_value);\n-\t\t}\n-\t\t*/\n-\n-\t\t$switch_result = event_socket_request($fp, 'api '.$switch_cmd);\n-\t\tif ($action == \"record\") {\n-\t\t\tif (trim($_GET[\"action2\"]) == \"stop\") {\n-\t\t\t\t$x=0;\n-\t\t\t\twhile (true) {\n-\t\t\t\t\tif ($x > 0) {\n-\t\t\t\t\t\t$dest_file = $_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$_GET[\"uuid\"].\"_\".$x.\".wav\";\n-\t\t\t\t\t}\n-\t\t\t\t\telse {\n-\t\t\t\t\t\t$dest_file = $_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$_GET[\"uuid\"].\".wav\";\n-\t\t\t\t\t}\n-\t\t\t\t\tif (!file_exists($dest_file)) {\n-\t\t\t\t\t\trename($_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$_GET[\"uuid\"].\".wav\", $dest_file);\n-\t\t\t\t\t\tbreak;\n+\n+\t\t\t//record stop\n+\t\t\tif ($action == \"record\") {\n+\t\t\t\tif (trim($_GET[\"action2\"]) == \"stop\") {\n+\t\t\t\t\t$x=0;\n+\t\t\t\t\twhile (true) {\n+\t\t\t\t\t\tif ($x > 0) {\n+\t\t\t\t\t\t\t$dest_file = $_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$_GET[\"uuid\"].\"_\".$x.\".wav\";\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\telse {\n+\t\t\t\t\t\t\t$dest_file = $_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$_GET[\"uuid\"].\".wav\";\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\tif (!file_exists($dest_file)) {\n+\t\t\t\t\t\t\trename($_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$_GET[\"uuid\"].\".wav\", $dest_file);\n+\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\t$x++;\n \t\t\t\t\t}\n-\t\t\t\t\t$x++;\n \t\t\t\t}\n \t\t\t}\n \t\t}\n-\t}\n }\n \n-?>\n\\ No newline at end of file\n+?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "43612a5049f92e5104f0ffc1f21e46d84c0b5836",
            "date": "2025-01-26T02:32:25Z",
            "author_login": "rabbidiesel"
          },
          {
            "sha": "a87bdc997ef81aadd2dc163b8c39b2bba98d694d",
            "date": "2025-01-26T02:24:47Z",
            "author_login": "nktech1135"
          },
          {
            "sha": "da1da92d01cedfb2440c14097897e6bb333efcc8",
            "date": "2025-01-24T23:05:37Z",
            "author_login": "frytimo"
          },
          {
            "sha": "965b24579454666767653d6819a3c35a9d9e4ea4",
            "date": "2025-01-24T23:03:53Z",
            "author_login": "markjcrane"
          },
          {
            "sha": "d77b69b4d54c2388a2fc88384a01d0301299aa95",
            "date": "2025-01-24T17:15:36Z",
            "author_login": "frytimo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "app/operator_panel/exec.php in the Operator Panel module in FusionPBX 4.4.3 suffers from a command injection vulnerability due to a lack of input validation that allows authenticated non-administrative attackers to execute commands on the host. This can further lead to remote code execution when combined with an XSS vulnerability also present in the FusionPBX Operator Panel module.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-06-17T19:15:11.327",
    "last_modified": "2024-11-21T04:21:03.357",
    "fix_date": "2019-04-05T22:40:17Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/153256/FusionPBX-4.4.3-Remote-Command-Execution.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/155344/FusionPBX-Operator-Panel-exec.php-Command-Execution.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://blog.gdssecurity.com/labs/2019/6/7/rce-using-caller-id-multiple-vulnerabilities-in-fusionpbx.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/e43ca27ba2d9c0109a6bf198fe2f8d79f63e0611",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/153256/FusionPBX-4.4.3-Remote-Command-Execution.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/155344/FusionPBX-Operator-Panel-exec.php-Command-Execution.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://blog.gdssecurity.com/labs/2019/6/7/rce-using-caller-id-multiple-vulnerabilities-in-fusionpbx.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/e43ca27ba2d9c0109a6bf198fe2f8d79f63e0611",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:52.564511",
    "processing_status": "enhanced"
  }
}