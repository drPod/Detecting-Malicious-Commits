{
  "cve_id": "CVE-2019-11502",
  "github_data": {
    "repository": "snapcore/snapd",
    "fix_commit": "bdbfeebef03245176ae0dc323392bb0522a339b1",
    "related_commits": [
      "bdbfeebef03245176ae0dc323392bb0522a339b1",
      "bdbfeebef03245176ae0dc323392bb0522a339b1"
    ],
    "patch_url": "https://github.com/snapcore/snapd/commit/bdbfeebef03245176ae0dc323392bb0522a339b1.patch",
    "fix_commit_details": {
      "sha": "bdbfeebef03245176ae0dc323392bb0522a339b1",
      "commit_date": "2019-03-04T17:40:11Z",
      "author": {
        "login": "zyga",
        "type": "User",
        "stats": {
          "total_commits": 8231,
          "average_weekly_commits": 15.589015151515152,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 294
        }
      },
      "commit_message": {
        "title": "cmd/snap-confine: chown private /tmp parent to root.root",
        "length": 693,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 1,
        "deletions": 3
      },
      "files": [
        {
          "filename": "cmd/snap-confine/mount-support.c",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -62,8 +62,6 @@\n // TODO: fold this into bootstrap\n static void setup_private_mount(const char *snap_name)\n {\n-\tuid_t uid = getuid();\n-\tgid_t gid = getgid();\n \tchar tmpdir[MAX_BUF] = { 0 };\n \n \t// Create a 0700 base directory, this is the base dir that is\n@@ -98,7 +96,7 @@ static void setup_private_mount(const char *snap_name)\n \t// MS_PRIVATE needs linux > 2.6.11\n \tsc_do_mount(\"none\", \"/tmp\", NULL, MS_PRIVATE, NULL);\n \t// do the chown after the bind mount to avoid potential shenanigans\n-\tif (chown(\"/tmp/\", uid, gid) < 0) {\n+\tif (chown(\"/tmp/\", 0, 0) < 0) {\n \t\tdie(\"cannot change ownership of /tmp\");\n \t}\n \t// chdir to original directory"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0a0cebb56ba688002917b423dca84f9e90a4e31d",
            "date": "2025-01-14T16:44:29Z",
            "author_login": "maykathm"
          },
          {
            "sha": "29cf0e069786b38071499bee50bdee67bd1874a3",
            "date": "2025-01-14T15:03:35Z",
            "author_login": "andrewphelpsj"
          },
          {
            "sha": "41b3b2be04842e08322713e36638684a0c74bb0b",
            "date": "2025-01-14T12:43:22Z",
            "author_login": "bboozzoo"
          },
          {
            "sha": "e2ff00fea3578c22103487f8e851a913e0c135c5",
            "date": "2025-01-14T08:04:48Z",
            "author_login": "maykathm"
          },
          {
            "sha": "3b68396cb05f389d9094addaefdef18363beae8f",
            "date": "2025-01-13T21:55:56Z",
            "author_login": "alfonsosanchezbeato"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-59",
    "description": "snap-confine in snapd before 2.38 incorrectly set the ownership of a snap application to the uid and gid of the first calling user. Consequently, that user had unintended access to a private /tmp directory.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-04-24T21:29:00.727",
    "last_modified": "2024-11-21T04:21:12.973",
    "fix_date": "2019-03-04T17:40:11Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/04/25/7",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/snapcore/snapd/commit/bdbfeebef03245176ae0dc323392bb0522a339b1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2019/04/18/4",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/04/25/7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/snapcore/snapd/commit/bdbfeebef03245176ae0dc323392bb0522a339b1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2019/04/18/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:50.451430",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "snapd",
    "owner": "snapcore",
    "created_at": "2015-10-21T11:51:46Z",
    "updated_at": "2025-01-14T12:43:28Z",
    "pushed_at": "2025-01-14T12:43:23Z",
    "size": 161408,
    "stars": 1915,
    "forks": 591,
    "open_issues": 142,
    "watchers": 1915,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "fde-manager-features",
      "master",
      "release/2.16",
      "release/2.17",
      "release/2.17.1",
      "release/2.18",
      "release/2.18.1",
      "release/2.19.1",
      "release/2.20",
      "release/2.20.1",
      "release/2.21",
      "release/2.22",
      "release/2.23",
      "release/2.24",
      "release/2.25",
      "release/2.26",
      "release/2.27"
    ],
    "languages": {
      "Go": 27089545,
      "C": 807343,
      "Shell": 615686,
      "Python": 226099,
      "Makefile": 104313,
      "M4": 13227,
      "Tcl": 1269,
      "HTML": 980,
      "Meson": 295,
      "Roff": 12
    },
    "commit_activity": {
      "total_commits_last_year": 1621,
      "avg_commits_per_week": 31.173076923076923,
      "days_active_last_year": 250
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:16:07.730623"
  }
}