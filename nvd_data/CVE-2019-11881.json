{
  "cve_id": "CVE-2019-11881",
  "github_data": {
    "repository": "rancher/rancher",
    "fix_commit": "e59adbc7565251919d84d6e353421104be8da06e",
    "related_commits": [
      "e59adbc7565251919d84d6e353421104be8da06e"
    ],
    "patch_url": "https://github.com/rancher/rancher/commit/e59adbc7565251919d84d6e353421104be8da06e.patch",
    "fix_commit_details": {
      "sha": "e59adbc7565251919d84d6e353421104be8da06e",
      "commit_date": "2019-05-21T18:19:32Z",
      "author": {
        "login": "mrajashree",
        "type": "User",
        "stats": {
          "total_commits": 274,
          "average_weekly_commits": 0.7306666666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 92
        }
      },
      "commit_message": {
        "title": "Send translation key as error message",
        "length": 37,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "pkg/auth/providers/saml/saml_client.go",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -33,6 +33,8 @@ var root *mux.Router\n var appliedVersion string\n var initMu sync.Mutex\n \n+const UITranslationKeyForErrorMessage = \"invalidSamlAttrs\"\n+\n func InitializeSamlServiceProvider(configToSet *v3.SamlConfig, name string) error {\n \n \tinitMu.Lock()\n@@ -276,7 +278,8 @@ func (s *Provider) HandleSamlAssertion(w http.ResponseWriter, r *http.Request, a\n \tuserPrincipal, groupPrincipals, err = s.getSamlPrincipals(config, samlData)\n \tif err != nil {\n \t\tlog.Error(err)\n-\t\thttp.Redirect(w, r, redirectURL+\"errorCode=422&errorMsg=Invalid saml attributes\", http.StatusFound)\n+\t\t// UI uses this translation key to get the error message\n+\t\thttp.Redirect(w, r, redirectURL+\"errorCode=422&errorMsg=\"+UITranslationKeyForErrorMessage, http.StatusFound)\n \t\treturn\n \t}\n \tallowedPrincipals := config.AllowedPrincipalIDs"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "cf830778aeeaf9949add74495a8644bddbf8fb1f",
            "date": "2025-01-14T03:39:03Z",
            "author_login": "tashima42"
          },
          {
            "sha": "1e40bc40c55a020fc67dc3c3dde47b41dc94caf1",
            "date": "2025-01-13T15:53:31Z",
            "author_login": "tomleb"
          },
          {
            "sha": "2053ce644a31cd8053d1f58e2487154b0b8513b6",
            "date": "2025-01-10T21:27:05Z",
            "author_login": "tashima42"
          },
          {
            "sha": "e7a4be3400abdf76808aea517c90deab265dc4bf",
            "date": "2025-01-10T20:00:16Z",
            "author_login": "jiaqiluo"
          },
          {
            "sha": "60bb4a4e5ec0e083d746895f68a05c8c5d0a1d02",
            "date": "2025-01-09T20:56:46Z",
            "author_login": "pedromfcarvalho"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": null,
    "description": "A vulnerability exists in Rancher before 2.2.4 in the login component, where the errorMsg parameter can be tampered to display arbitrary content, filtering tags but not special characters or symbols. There's no other limitation of the message, allowing malicious users to lure legitimate users to visit phishing sites with scare tactics, e.g., displaying a \"This version of Rancher is outdated, please visit https://malicious.rancher.site/upgrading\" message.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-06-10T20:29:01.090",
    "last_modified": "2024-12-04T15:15:07.187",
    "fix_date": "2019-05-21T18:19:32Z"
  },
  "references": [
    {
      "url": "https://github.com/MauroEldritch/VanCleef",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rancher/rancher/blob/v2.2.4/pkg/auth/providers/saml/saml_client.go#L282",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/rancher/rancher/commit/e59adbc7565251919d84d6e353421104be8da06e",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/rancher/rancher/issues/20216",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MauroEldritch/VanCleef",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rancher/rancher/issues/20216",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:52.559520",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rancher",
    "owner": "rancher",
    "created_at": "2014-11-07T20:49:31Z",
    "updated_at": "2025-01-14T12:58:53Z",
    "pushed_at": "2025-01-14T13:57:57Z",
    "size": 159271,
    "stars": 23663,
    "forks": 2997,
    "open_issues": 2999,
    "watchers": 23663,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "alpha",
      "branch-v1.6.14",
      "branch-v1.6.18"
    ],
    "languages": {
      "Go": 11437667,
      "Python": 1455203,
      "Groovy": 290622,
      "Shell": 177072,
      "HCL": 39777,
      "PowerShell": 38206,
      "Dockerfile": 36163,
      "Jinja": 30303,
      "Mustache": 2354,
      "JavaScript": 609,
      "Makefile": 542,
      "Batchfile": 395
    },
    "commit_activity": {
      "total_commits_last_year": 1336,
      "avg_commits_per_week": 25.692307692307693,
      "days_active_last_year": 269
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:35:46.929869"
  }
}