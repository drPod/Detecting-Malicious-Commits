{
  "cve_id": "CVE-2019-12816",
  "github_data": {
    "repository": "znc/znc",
    "fix_commit": "8de9e376ce531fe7f3c8b0aa4876d15b479b7311",
    "related_commits": [
      "8de9e376ce531fe7f3c8b0aa4876d15b479b7311",
      "8de9e376ce531fe7f3c8b0aa4876d15b479b7311"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8de9e376ce531fe7f3c8b0aa4876d15b479b7311",
      "commit_date": "2019-06-12T07:57:29Z",
      "author": {
        "login": "DarthGandalf",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix remote code execution and privilege escalation vulnerability.",
        "length": 203,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 39,
        "additions": 30,
        "deletions": 9
      },
      "files": [
        {
          "filename": "include/znc/Modules.h",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1600,6 +1600,7 @@ class CModules : public std::vector<CModule*>, private CCoreTranslationMixin {\n   private:\n     static ModHandle OpenModule(const CString& sModule, const CString& sModPath,\n                                 CModInfo& Info, CString& sRetMsg);\n+    static bool ValidateModuleName(const CString& sModule, CString& sRetMsg);\n \n   protected:\n     CUser* m_pUser;"
        },
        {
          "filename": "src/Modules.cpp",
          "status": "modified",
          "additions": 29,
          "deletions": 9,
          "patch": "@@ -1624,11 +1624,30 @@ CModule* CModules::FindModule(const CString& sModule) const {\n     return nullptr;\n }\n \n+bool CModules::ValidateModuleName(const CString& sModule, CString& sRetMsg) {\n+    for (unsigned int a = 0; a < sModule.length(); a++) {\n+        if (((sModule[a] < '0') || (sModule[a] > '9')) &&\n+            ((sModule[a] < 'a') || (sModule[a] > 'z')) &&\n+            ((sModule[a] < 'A') || (sModule[a] > 'Z')) && (sModule[a] != '_')) {\n+            sRetMsg =\n+                t_f(\"Module names can only contain letters, numbers and \"\n+                    \"underscores, [{1}] is invalid\")(sModule);\n+            return false;\n+        }\n+    }\n+\n+    return true;\n+}\n+\n bool CModules::LoadModule(const CString& sModule, const CString& sArgs,\n                           CModInfo::EModuleType eType, CUser* pUser,\n                           CIRCNetwork* pNetwork, CString& sRetMsg) {\n     sRetMsg = \"\";\n \n+    if (!ValidateModuleName(sModule, sRetMsg)) {\n+        return false;\n+    }\n+\n     if (FindModule(sModule) != nullptr) {\n         sRetMsg = t_f(\"Module {1} already loaded.\")(sModule);\n         return false;\n@@ -1781,6 +1800,10 @@ bool CModules::ReloadModule(const CString& sModule, const CString& sArgs,\n \n bool CModules::GetModInfo(CModInfo& ModInfo, const CString& sModule,\n                           CString& sRetMsg) {\n+    if (!ValidateModuleName(sModule, sRetMsg)) {\n+        return false;\n+    }\n+\n     CString sModPath, sTmp;\n \n     bool bSuccess;\n@@ -1799,6 +1822,10 @@ bool CModules::GetModInfo(CModInfo& ModInfo, const CString& sModule,\n \n bool CModules::GetModPathInfo(CModInfo& ModInfo, const CString& sModule,\n                               const CString& sModPath, CString& sRetMsg) {\n+    if (!ValidateModuleName(sModule, sRetMsg)) {\n+        return false;\n+    }\n+\n     ModInfo.SetName(sModule);\n     ModInfo.SetPath(sModPath);\n \n@@ -1911,15 +1938,8 @@ ModHandle CModules::OpenModule(const CString& sModule, const CString& sModPath,\n     // Some sane defaults in case anything errors out below\n     sRetMsg.clear();\n \n-    for (unsigned int a = 0; a < sModule.length(); a++) {\n-        if (((sModule[a] < '0') || (sModule[a] > '9')) &&\n-            ((sModule[a] < 'a') || (sModule[a] > 'z')) &&\n-            ((sModule[a] < 'A') || (sModule[a] > 'Z')) && (sModule[a] != '_')) {\n-            sRetMsg =\n-                t_f(\"Module names can only contain letters, numbers and \"\n-                    \"underscores, [{1}] is invalid\")(sModule);\n-            return nullptr;\n-        }\n+    if (!ValidateModuleName(sModule, sRetMsg)) {\n+        return nullptr;\n     }\n \n     // The second argument to dlopen() has a long history. It seems clear"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dd99d3e9503ca20337850bf17b606bdbf9bb8266",
            "date": "2024-12-29T15:16:27Z",
            "author_login": "DarthGandalf"
          },
          {
            "sha": "7c616f10ee061b8a959d64f701186748a9223a32",
            "date": "2024-12-29T15:00:20Z",
            "author_login": "DarthGandalf"
          },
          {
            "sha": "579906d686fc2f2276ccb8d09b15b6aaa9106f69",
            "date": "2024-12-29T14:54:20Z",
            "author_login": "DarthGandalf"
          },
          {
            "sha": "1224d303aa1e4d06dea3c5dc9ce2c41a2675f9a0",
            "date": "2024-12-29T10:11:00Z",
            "author_login": "DarthGandalf"
          },
          {
            "sha": "bfd731cfc6a06c909ef10e360f1ad8c23561b5c0",
            "date": "2024-11-01T15:55:41Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-20",
    "description": "Modules.cpp in ZNC before 1.7.4-rc1 allows remote authenticated non-admin users to escalate privileges and execute arbitrary code by loading a module with a crafted name.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-06-15T16:29:00.210",
    "last_modified": "2024-11-21T04:23:38.520",
    "fix_date": "2019-06-12T07:57:29Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00037.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00018.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/znc/znc/commit/8de9e376ce531fe7f3c8b0aa4876d15b479b7311",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/znc/znc/compare/be1b6bc...d1997d6",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/06/msg00017.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4O24TQOB73X57GACLZVMRVUK4UKHLE5G/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NHR6OD52FQAG5ZPZ42NJM2T765C3V2XC/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TEESIGRNFLZUWXZPDGXAZ7JZTHYBDJ7G/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Jun/23",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201908-15",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/4044-1/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00037.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00018.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/znc/znc/commit/8de9e376ce531fe7f3c8b0aa4876d15b479b7311",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/znc/znc/compare/be1b6bc...d1997d6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/06/msg00017.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4O24TQOB73X57GACLZVMRVUK4UKHLE5G/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NHR6OD52FQAG5ZPZ42NJM2T765C3V2XC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TEESIGRNFLZUWXZPDGXAZ7JZTHYBDJ7G/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Jun/23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/201908-15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/4044-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:52.562814",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "znc",
    "owner": "znc",
    "created_at": "2010-01-09T23:44:05Z",
    "updated_at": "2025-01-25T15:13:52Z",
    "pushed_at": "2024-12-29T15:16:34Z",
    "size": 21510,
    "stars": 2028,
    "forks": 377,
    "open_issues": 396,
    "watchers": 2028,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.6.x",
      "master"
    ],
    "languages": {
      "C++": 1904082,
      "JavaScript": 178904,
      "CMake": 76169,
      "CSS": 43971,
      "Perl": 42046,
      "Python": 38962,
      "SWIG": 26669,
      "C": 15550,
      "Tcl": 9805,
      "Shell": 6474,
      "Groovy": 6317,
      "Dockerfile": 1278
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:36:32.358524"
  }
}