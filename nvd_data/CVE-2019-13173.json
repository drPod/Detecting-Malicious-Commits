{
  "cve_id": "CVE-2019-13173",
  "github_data": {
    "repository": "npm/fstream",
    "fix_commit": "6a77d2fa6e1462693cf8e46f930da96ec1b0bb22",
    "related_commits": [
      "6a77d2fa6e1462693cf8e46f930da96ec1b0bb22",
      "6a77d2fa6e1462693cf8e46f930da96ec1b0bb22"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "6a77d2fa6e1462693cf8e46f930da96ec1b0bb22",
      "commit_date": "2019-05-15T00:37:57Z",
      "author": {
        "login": "isaacs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Clobber a Link if it's in the way of a File",
        "length": 93,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/writer.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -147,7 +147,7 @@ Writer.prototype._stat = function (current) {\n \n     // if it's a type change, then we need to clobber or error.\n     // if it's not a type change, then let the impl take care of it.\n-    if (currentType !== self.type) {\n+    if (currentType !== self.type || self.type === 'File' && current.nlink > 1) {\n       return rimraf(self._path, function (er) {\n         if (er) return self.error(er)\n         self._old = null"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bffea43c6a201c76bc85842539e09a779508790b",
            "date": "2020-02-17T15:52:04Z",
            "author_login": "pradeepggowda"
          },
          {
            "sha": "42354590e23bb514eb5c869eea64406be2947c6c",
            "date": "2019-05-15T00:38:01Z",
            "author_login": "isaacs"
          },
          {
            "sha": "6a77d2fa6e1462693cf8e46f930da96ec1b0bb22",
            "date": "2019-05-15T00:37:57Z",
            "author_login": "isaacs"
          },
          {
            "sha": "1e4527ffe8688d4f5325283d7cf2cf2d61f14c6b",
            "date": "2017-03-07T21:46:53Z",
            "author_login": "zkat"
          },
          {
            "sha": "ac4a9e3d86d39a5b979dbdda44376be85b91ece7",
            "date": "2017-03-07T21:45:29Z",
            "author_login": "ZJONSSON"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-59",
    "description": "fstream before 1.0.12 is vulnerable to Arbitrary File Overwrite. Extracting tarballs containing a hardlink to a file that already exists in the system, and a file that matches the hardlink, will overwrite the system's file with the contents of the extracted file. The fstream.DirWriter() function is vulnerable.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-07-02T20:15:11.823",
    "last_modified": "2024-11-21T04:24:21.393",
    "fix_date": "2019-05-15T00:37:57Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00010.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00052.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/npm/fstream/commit/6a77d2fa6e1462693cf8e46f930da96ec1b0bb22",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4123-1/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.npmjs.com/advisories/886",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00010.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00052.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/npm/fstream/commit/6a77d2fa6e1462693cf8e46f930da96ec1b0bb22",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4123-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.npmjs.com/advisories/886",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:52.592273",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "fstream",
    "owner": "npm",
    "created_at": "2011-10-29T21:36:05Z",
    "updated_at": "2025-01-20T12:31:15Z",
    "pushed_at": "2021-06-16T23:40:29Z",
    "size": 216,
    "stars": 209,
    "forks": 43,
    "open_issues": 33,
    "watchers": 209,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 50964
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "isc"
    },
    "collected_at": "2025-01-26T08:04:20.096587"
  }
}