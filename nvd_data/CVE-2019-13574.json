{
  "cve_id": "CVE-2019-13574",
  "github_data": {
    "repository": "minimagick/minimagick",
    "fix_commit": "4cd5081e58810d3394d27a67219e8e4e0445d851",
    "related_commits": [
      "4cd5081e58810d3394d27a67219e8e4e0445d851",
      "4cd5081e58810d3394d27a67219e8e4e0445d851"
    ],
    "patch_url": "https://github.com/minimagick/minimagick/commit/4cd5081e58810d3394d27a67219e8e4e0445d851.patch",
    "fix_commit_details": {
      "sha": "4cd5081e58810d3394d27a67219e8e4e0445d851",
      "commit_date": "2019-05-26T15:30:14Z",
      "author": {
        "login": "janko",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Don't allow remote shell execution",
        "length": 492,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 14,
        "deletions": 8
      },
      "files": [
        {
          "filename": "lib/mini_magick/image.rb",
          "status": "modified",
          "additions": 6,
          "deletions": 8,
          "patch": "@@ -82,17 +82,15 @@ def self.import_pixels(blob, columns, rows, depth, map, format = 'png')\n     def self.open(path_or_url, ext = nil, options = {})\n       options, ext = ext, nil if ext.is_a?(Hash)\n \n-      ext ||=\n-        if File.exist?(path_or_url)\n-          File.extname(path_or_url)\n-        else\n-          File.extname(URI(path_or_url).path)\n-        end\n+      uri = URI(path_or_url.to_s)\n \n+      ext ||= File.extname(uri.path)\n       ext.sub!(/:.*/, '') # hack for filenames or URLs that include a colon\n \n-      Kernel.open(path_or_url, \"rb\", options) do |file|\n-        read(file, ext)\n+      if uri.is_a?(URI::HTTP) || uri.is_a?(URI::FTP)\n+        uri.open(options) { |file| read(file, ext) }\n+      else\n+        File.open(uri.to_s, \"rb\", options) { |file| read(file, ext) }\n       end\n     end\n "
        },
        {
          "filename": "spec/lib/mini_magick/image_spec.rb",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -76,6 +76,14 @@\n           expect(File.extname(image.path)).to eq \".jpg\"\n         end\n \n+        it \"doesn't allow remote shell execution\" do\n+          expect {\n+            described_class.open(\"| touch file.txt\") # Kernel#open accepts this\n+          }.to raise_error(URI::InvalidURIError)\n+\n+          expect(File.exist?(\"file.txt\")).to eq(false)\n+        end\n+\n         it \"accepts open-uri options\" do\n           stub_request(:get, \"http://example.com/image.jpg\")\n             .with(headers: {\"Foo\" => \"Bar\"})"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "67378773d5b1ccfafc64a1e9d126116ef90dac18",
            "date": "2025-01-12T21:07:42Z",
            "author_login": "janko"
          },
          {
            "sha": "a3473ee33fddf9c12c1406dfa02b117b325186f4",
            "date": "2025-01-12T21:13:45Z",
            "author_login": "janko"
          },
          {
            "sha": "8a7e56c684943fc2cf0ad7bdc37ddd821557c0ed",
            "date": "2025-01-12T21:00:43Z",
            "author_login": "janko"
          },
          {
            "sha": "9c25a7166f6a5d2dd5a7dd54e7b981a7d92915d7",
            "date": "2025-01-12T20:58:00Z",
            "author_login": "janko"
          },
          {
            "sha": "b9ab172c78b77ef92028cdca649aed0e378bb707",
            "date": "2025-01-12T20:44:13Z",
            "author_login": "janko"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-78",
    "description": "In lib/mini_magick/image.rb in MiniMagick before 4.9.4, a fetched remote image filename could cause remote command execution because Image.open input is directly passed to Kernel#open, which accepts a '|' character followed by a command.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-07-12T03:15:10.467",
    "last_modified": "2024-11-21T04:25:13.390",
    "fix_date": "2019-05-26T15:30:14Z"
  },
  "references": [
    {
      "url": "https://benjamin-bouchet.com/blog/vulnerabilite-dans-la-gem-mini_magick-version-4-9-4/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minimagick/minimagick/commit/4cd5081e58810d3394d27a67219e8e4e0445d851",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minimagick/minimagick/compare/d484786...293f9bb",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minimagick/minimagick/releases/tag/v4.9.4",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00007.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Jul/20",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4481",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://benjamin-bouchet.com/blog/vulnerabilite-dans-la-gem-mini_magick-version-4-9-4/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minimagick/minimagick/commit/4cd5081e58810d3394d27a67219e8e4e0445d851",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minimagick/minimagick/compare/d484786...293f9bb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minimagick/minimagick/releases/tag/v4.9.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00007.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Jul/20",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4481",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:54.782974",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "minimagick",
    "owner": "minimagick",
    "created_at": "2008-03-06T01:35:38Z",
    "updated_at": "2025-01-13T18:42:49Z",
    "pushed_at": "2025-01-12T21:14:55Z",
    "size": 3741,
    "stars": 2835,
    "forks": 347,
    "open_issues": 0,
    "watchers": 2835,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Ruby": 68204
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:05:11.975702"
  }
}