{
  "cve_id": "CVE-2019-14495",
  "github_data": {
    "repository": "z3APA3A/3proxy",
    "fix_commit": "3b67dc844789dc0f00e934270c7b349bcb547865",
    "related_commits": [
      "3b67dc844789dc0f00e934270c7b349bcb547865",
      "3b67dc844789dc0f00e934270c7b349bcb547865"
    ],
    "patch_url": "https://github.com/z3APA3A/3proxy/commit/3b67dc844789dc0f00e934270c7b349bcb547865.patch",
    "fix_commit_details": {
      "sha": "3b67dc844789dc0f00e934270c7b349bcb547865",
      "commit_date": "2019-08-01T13:46:22Z",
      "author": {
        "login": "z3APA3A",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix: out-of-bounds write and few more bugs in 'admin' configuration upload",
        "length": 74,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 10,
        "deletions": 10
      },
      "files": [
        {
          "filename": "src/webadmin.c",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -10,7 +10,7 @@\n \n #define RETURN(xxx) { param->res = xxx; goto CLEANRET; }\n \n-#define LINESIZE 2048\n+#define LINESIZE 65536\n \n extern FILE *writable;\n FILE * confopen();\n@@ -341,7 +341,7 @@ void * adminchild(struct clientparam* param) {\n  char *sb;\n  char *req = NULL;\n  struct printparam pp;\n- int contentlen = 0;\n+ unsigned contentlen = 0;\n  int isform = 0;\n \n  pp.inbuf = 0;\n@@ -390,7 +390,8 @@ void * adminchild(struct clientparam* param) {\n \telse if(i > 15 && (!strncasecmp(buf, \"content-length:\", 15))){\n \t\tsb = buf + 15;\n \t\twhile(isspace(*sb))sb++;\n-\t\tcontentlen = atoi(sb);\n+\t\tsscanf(sb, \"%u\", &contentlen);\n+\t\tif(contentlen > LINESIZE*1024) contentlen = 0;\n \t}\n \telse if(i > 13 && (!strncasecmp(buf, \"content-type:\", 13))){\n \t\tsb = buf + 13;\n@@ -520,7 +521,7 @@ void * adminchild(struct clientparam* param) {\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\t\tprintstr(&pp, \"<h3>Please be careful editing config file remotely</h3>\");\n-\t\t\t\tprintstr(&pp, \"<form method=\\\"POST\\\" action=\\\"/U\\\"><textarea cols=\\\"80\\\" rows=\\\"30\\\" name=\\\"conffile\\\">\");\n+\t\t\t\tprintstr(&pp, \"<form method=\\\"POST\\\" action=\\\"/U\\\" enctype=\\\"application/x-www-form-urlencoded\\\"><textarea cols=\\\"80\\\" rows=\\\"30\\\" name=\\\"conffile\\\">\");\n \t\t\t\twhile(fgets(buf, 256, fp)){\n \t\t\t\t\tprintstr(&pp, buf);\n \t\t\t\t}\n@@ -530,24 +531,23 @@ void * adminchild(struct clientparam* param) {\n \t\t}\n \tcase 'U':\n \t\t{\n-\t\t\tint l=0;\n+\t\t\tunsigned l=0;\n \t\t\tint error = 0;\n \n-\t\t\tif(!writable || fseek(writable, 0, 0)){\n+\t\t\tif(!writable || !contentlen || fseek(writable, 0, 0)){\n \t\t\t\terror = 1;\n \t\t\t}\n-\t\t\twhile((i = sockgetlinebuf(param, CLIENT, (unsigned char *)buf, LINESIZE - 1, '+', conf.timeouts[STRING_S])) > 0){\n+\t\t\twhile(l < contentlen && (i = sockgetlinebuf(param, CLIENT, (unsigned char *)buf, (contentlen - l) > LINESIZE - 1?LINESIZE - 1:contentlen - l, '+', conf.timeouts[STRING_S])) > 0){\n \t\t\t\tif(i > (contentlen - l)) i = (contentlen - l);\n-\t\t\t\tbuf[i] = 0;\n \t\t\t\tif(!l){\n-\t\t\t\t\tif(strncasecmp(buf, \"conffile=\", 9)) error = 1;\n+\t\t\t\t\tif(i<9 || strncasecmp(buf, \"conffile=\", 9)) error = 1;\n \t\t\t\t}\n \t\t\t\tif(!error){\n+\t\t\t\t\tbuf[i] = 0;\n \t\t\t\t\tdecodeurl((unsigned char *)buf, 1);\n \t\t\t\t\tfprintf(writable, \"%s\", l? buf : buf + 9);\n \t\t\t\t}\n \t\t\t\tl += i;\n-\t\t\t\tif(l >= contentlen) break;\n \t\t\t}\n \t\t\tif(writable && !error){\n \t\t\t\tfflush(writable);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6387bed4f282c43ed1fcca715a73fabbecb0390b",
            "date": "2024-12-20T11:38:58Z",
            "author_login": "z3APA3A"
          },
          {
            "sha": "cb6a4166b77c079d25c153a7a5f8138be5575679",
            "date": "2024-09-11T15:34:40Z",
            "author_login": "z3APA3A"
          },
          {
            "sha": "cf6946cc8b3999d92c71dff62571123d8708102e",
            "date": "2024-07-18T09:50:59Z",
            "author_login": "z3APA3A"
          },
          {
            "sha": "ab8db00b1fdd57b8728790da91c23f137ede105f",
            "date": "2024-06-04T16:26:34Z",
            "author_login": "z3APA3A"
          },
          {
            "sha": "94dfa195dbca92bca07cf16264b8eed0058f47a7",
            "date": "2024-05-31T16:53:28Z",
            "author_login": "z3APA3A"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "webadmin.c in 3proxy before 0.8.13 has an out-of-bounds write in the admin interface.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-08-01T17:15:13.733",
    "last_modified": "2024-11-21T04:26:51.553",
    "fix_date": "2019-08-01T13:46:22Z"
  },
  "references": [
    {
      "url": "https://github.com/z3APA3A/3proxy/commit/3b67dc844789dc0f00e934270c7b349bcb547865",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/z3APA3A/3proxy/compare/0.8.12...0.8.13",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/z3APA3A/3proxy/releases/tag/0.8.13",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/z3APA3A/3proxy/commit/3b67dc844789dc0f00e934270c7b349bcb547865",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/z3APA3A/3proxy/compare/0.8.12...0.8.13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/z3APA3A/3proxy/releases/tag/0.8.13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:54.827315",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "3proxy",
    "owner": "z3APA3A",
    "created_at": "2014-04-08T08:59:11Z",
    "updated_at": "2025-01-14T02:50:23Z",
    "pushed_at": "2024-12-20T11:39:04Z",
    "size": 2118,
    "stars": 4042,
    "forks": 790,
    "open_issues": 105,
    "watchers": 4042,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1865984,
      "Shell": 25126,
      "Makefile": 15305,
      "Roff": 8847,
      "Batchfile": 191
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:41:37.006382"
  }
}