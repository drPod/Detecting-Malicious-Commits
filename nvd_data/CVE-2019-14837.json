{
  "cve_id": "CVE-2019-14837",
  "github_data": {
    "repository": "keycloak/keycloak",
    "fix_commit": "9a7c1a91a59ab85e7f8889a505be04a71580777f",
    "related_commits": [
      "9a7c1a91a59ab85e7f8889a505be04a71580777f",
      "9a7c1a91a59ab85e7f8889a505be04a71580777f"
    ],
    "patch_url": "https://github.com/keycloak/keycloak/commit/9a7c1a91a59ab85e7f8889a505be04a71580777f.patch",
    "fix_commit_details": {
      "sha": "9a7c1a91a59ab85e7f8889a505be04a71580777f",
      "commit_date": "2019-10-25T14:46:27Z",
      "author": {
        "login": "sguilhen",
        "type": "User",
        "stats": {
          "total_commits": 198,
          "average_weekly_commits": 0.3283582089552239,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 107
        }
      },
      "commit_message": {
        "title": "KEYCLOAK-10780 Stop creating placeholder e-mails for service accounts (#228)",
        "length": 76,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 2,
        "deletions": 4
      },
      "files": [
        {
          "filename": "examples/demo-template/testrealm.json",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -76,7 +76,6 @@\n         {\n             \"username\" : \"service-account-product-sa-client\",\n             \"enabled\": true,\n-            \"email\" : \"service-account-product-sa-client@placeholder.org\",\n             \"serviceAccountClientId\": \"product-sa-client\",\n             \"realmRoles\": [ \"user\" ]\n         }"
        },
        {
          "filename": "services/src/main/java/org/keycloak/services/managers/ClientManager.java",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -164,7 +164,6 @@ public void enableServiceAccount(ClientModel client) {\n             // Don't use federation for service account user\n             UserModel user = realmManager.getSession().userLocalStorage().addUser(client.getRealm(), username);\n             user.setEnabled(true);\n-            user.setEmail(username + \"@placeholder.org\");\n             user.setServiceAccountClientLink(client.getId());\n         }\n \n@@ -205,7 +204,6 @@ public void clientIdChanged(ClientModel client, String newClientId) {\n         if (serviceAccountUser != null) {\n             String username = ServiceAccountConstants.SERVICE_ACCOUNT_USER_PREFIX + newClientId;\n             serviceAccountUser.setUsername(username);\n-            serviceAccountUser.setEmail(username + \"@placeholder.org\");\n         }\n     }\n "
        },
        {
          "filename": "testsuite/integration-arquillian/test-apps/photoz/photoz-realm.json",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -111,7 +111,6 @@\n     {\n       \"username\": \"service-account-photoz-restful-api\",\n       \"enabled\": true,\n-      \"email\": \"service-account-photoz-restful-api@placeholder.org\",\n       \"serviceAccountClientId\": \"photoz-restful-api\",\n       \"clientRoles\": {\n         \"photoz-restful-api\" : [\"uma_protection\"]"
        },
        {
          "filename": "testsuite/integration-arquillian/tests/base/src/test/java/org/keycloak/testsuite/admin/ClientTest.java",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -231,6 +231,8 @@ public void serviceAccount() {\n         response.close();\n         UserRepresentation userRep = realm.clients().get(id).getServiceAccountUser();\n         assertEquals(\"service-account-serviceclient\", userRep.getUsername());\n+        // KEYCLOAK-11197 service accounts are no longer created with a placeholder e-mail.\n+        assertNull(userRep.getEmail());\n     }\n \n     // KEYCLOAK-3421"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 4,
        "max_directory_depth": 11
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "388fa5a3ebae20d1bdf8f92ee3ad29fbe438a622",
            "date": "2025-01-14T13:32:03Z",
            "author_login": "stianst"
          },
          {
            "sha": "01f5a8c1c3e97944f8919c11338b1cebed9056ee",
            "date": "2025-01-14T12:20:01Z",
            "author_login": "stianst"
          },
          {
            "sha": "53a2ed6fdbd8673e9b914f650e598cd9122763e6",
            "date": "2025-01-14T12:02:51Z",
            "author_login": "SebastEnn"
          },
          {
            "sha": "8ddf94ca3b0a3c34fe1441fe24cf90a063d3ae3f",
            "date": "2025-01-14T11:22:01Z",
            "author_login": "Yogu"
          },
          {
            "sha": "6322554da02c5fd425ebfcbb5f1c25ca2cbc158d",
            "date": "2025-01-13T17:15:20Z",
            "author_login": "ahus1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-547",
    "description": "A flaw was found in keycloack before version 8.0.0. The owner of 'placeholder.org' domain can setup mail server on this domain and knowing only name of a client can reset password and then log in. For example, for client name 'test' the email address will be 'service-account-test@placeholder.org'.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-01-07T17:15:11.033",
    "last_modified": "2024-11-21T04:27:28.110",
    "fix_date": "2019-10-25T14:46:27Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-14837",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/keycloak/keycloak/commit/9a7c1a91a59ab85e7f8889a505be04a71580777f",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://issues.jboss.org/browse/KEYCLOAK-10780",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Permissions Required",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-14837",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/keycloak/keycloak/commit/9a7c1a91a59ab85e7f8889a505be04a71580777f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://issues.jboss.org/browse/KEYCLOAK-10780",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Permissions Required",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:37.459752",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "keycloak",
    "owner": "keycloak",
    "created_at": "2013-07-02T13:38:51Z",
    "updated_at": "2025-01-14T13:32:13Z",
    "pushed_at": "2025-01-14T14:08:52Z",
    "size": 519673,
    "stars": 24649,
    "forks": 6948,
    "open_issues": 1920,
    "watchers": 24649,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release/22.0",
      "release/24.0",
      "release/26.0",
      "release/26.1"
    ],
    "languages": {
      "Java": 35124416,
      "TypeScript": 3242946,
      "FreeMarker": 278229,
      "JavaScript": 136844,
      "CSS": 44624,
      "Shell": 35073,
      "XSLT": 31908,
      "HTML": 10031,
      "mupad": 8593,
      "Mustache": 5212,
      "Groovy": 4915,
      "Dockerfile": 4760,
      "Batchfile": 2651,
      "Fluent": 217
    },
    "commit_activity": {
      "total_commits_last_year": 3682,
      "avg_commits_per_week": 70.8076923076923,
      "days_active_last_year": 292
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:10:04.689797"
  }
}