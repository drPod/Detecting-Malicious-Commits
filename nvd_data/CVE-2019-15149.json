{
  "cve_id": "CVE-2019-15149",
  "github_data": {
    "repository": "dw/mitogen",
    "fix_commit": "5924af1566763e48c42028399ea0cd95c457b3dc",
    "related_commits": [
      "5924af1566763e48c42028399ea0cd95c457b3dc",
      "5924af1566763e48c42028399ea0cd95c457b3dc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5924af1566763e48c42028399ea0cd95c457b3dc",
      "commit_date": "2019-08-08T22:03:43Z",
      "author": {
        "login": "dw",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[security] core: undirectional routing wasn't respected in some cases",
        "length": 485,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 50,
        "additions": 36,
        "deletions": 14
      },
      "files": [
        {
          "filename": "mitogen/core.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3623,7 +3623,7 @@ def _setup_master(self):\n         self.broker = Broker(activate_compat=False)\n         self.router = Router(self.broker)\n         self.router.debug = self.config.get('debug', False)\n-        self.router.undirectional = self.config['unidirectional']\n+        self.router.unidirectional = self.config['unidirectional']\n         self.router.add_handler(\n             fn=self._on_shutdown_msg,\n             handle=SHUTDOWN,"
        },
        {
          "filename": "tests/router_test.py",
          "status": "modified",
          "additions": 35,
          "deletions": 13,
          "patch": "@@ -1,9 +1,11 @@\n+import sys\n import time\n import zlib\n \n import unittest2\n \n import testlib\n+import mitogen.core\n import mitogen.master\n import mitogen.parent\n import mitogen.utils\n@@ -341,22 +343,42 @@ def test_previously_alive_context_returns_dead(self):\n         ))\n \n \n+def test_siblings_cant_talk(router):\n+    l1 = router.local()\n+    l2 = router.local()\n+    logs = testlib.LogCapturer()\n+    logs.start()\n+\n+    try:\n+        l2.call(ping_context, l1)\n+    except mitogen.core.CallError:\n+        e = sys.exc_info()[1]\n+\n+    msg = mitogen.core.Router.unidirectional_msg % (\n+        l2.context_id,\n+        l1.context_id,\n+    )\n+    assert msg in str(e)\n+    assert 'routing mode prevents forward of ' in logs.stop()\n+\n+\n+@mitogen.core.takes_econtext\n+def test_siblings_cant_talk_remote(econtext):\n+    mitogen.parent.upgrade_router(econtext)\n+    test_siblings_cant_talk(econtext.router)\n+\n+\n class UnidirectionalTest(testlib.RouterMixin, testlib.TestCase):\n-    def test_siblings_cant_talk(self):\n+    def test_siblings_cant_talk_master(self):\n         self.router.unidirectional = True\n-        l1 = self.router.local()\n-        l2 = self.router.local()\n-        logs = testlib.LogCapturer()\n-        logs.start()\n-        e = self.assertRaises(mitogen.core.CallError,\n-                              lambda: l2.call(ping_context, l1))\n+        test_siblings_cant_talk(self.router)\n \n-        msg = self.router.unidirectional_msg % (\n-            l2.context_id,\n-            l1.context_id,\n-        )\n-        self.assertTrue(msg in str(e))\n-        self.assertTrue('routing mode prevents forward of ' in logs.stop())\n+    def test_siblings_cant_talk_parent(self):\n+        # ensure 'unidirectional' attribute is respected for contexts started\n+        # by children.\n+        self.router.unidirectional = True\n+        parent = self.router.local()\n+        parent.call(test_siblings_cant_talk_remote)\n \n     def test_auth_id_can_talk(self):\n         self.router.unidirectional = True"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fca7578cdf18d6c33e3388058d1581cbba287b92",
            "date": "2025-01-23T14:58:18Z",
            "author_login": "moreati"
          },
          {
            "sha": "e97d20c9d1c90614bc30343a94a6ee9bb9b3e66a",
            "date": "2025-01-23T13:13:18Z",
            "author_login": "moreati"
          },
          {
            "sha": "51c7b789f7ed9140b31617f0d8e0998221711793",
            "date": "2025-01-23T13:03:42Z",
            "author_login": "moreati"
          },
          {
            "sha": "356be2e65f76e045143b8b9cab306ed511afe2c9",
            "date": "2025-01-23T12:59:36Z",
            "author_login": "moreati"
          },
          {
            "sha": "1b8b2c8b1af8226b00ad2e26f0644c58f98c2fa2",
            "date": "2025-01-23T12:58:12Z",
            "author_login": "moreati"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-254",
    "description": "core.py in Mitogen before 0.2.8 has a typo that drops the unidirectional-routing protection mechanism in the case of a child that is initiated by another child. The Ansible extension is unaffected. NOTE: the vendor disputes this issue because it is exploitable only in conjunction with hypothetical other factors, i.e., an affected use case within a library caller, and a bug in the message receiver policy code that led to reliance on this extra protection mechanism",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-08-18T20:15:09.220",
    "last_modified": "2024-11-21T04:28:10.043",
    "fix_date": "2019-08-08T22:03:43Z"
  },
  "references": [
    {
      "url": "https://github.com/dw/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://mitogen.networkgenomics.com/changelog.html#v0-2-8-2019-08-18",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/dw/mitogen/commit/5924af1566763e48c42028399ea0cd95c457b3dc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://mitogen.networkgenomics.com/changelog.html#v0-2-8-2019-08-18",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:57.274918",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mitogen",
    "owner": "dw",
    "created_at": "2016-08-14T02:24:16Z",
    "updated_at": "2025-01-24T22:40:29Z",
    "pushed_at": "2025-01-23T14:58:18Z",
    "size": 14279,
    "stars": 2355,
    "forks": 199,
    "open_issues": 286,
    "watchers": 2355,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable"
    ],
    "languages": {
      "Python": 1259796,
      "Shell": 7391,
      "Jinja": 5224,
      "Perl": 530,
      "Makefile": 428,
      "C": 397
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T08:00:32.048650"
  }
}