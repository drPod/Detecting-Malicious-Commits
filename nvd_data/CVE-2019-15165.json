{
  "cve_id": "CVE-2019-15165",
  "github_data": {
    "repository": "the-tcpdump-group/libpcap",
    "fix_commit": "87d6bef033062f969e70fa40c43dfd945d5a20ab",
    "related_commits": [
      "87d6bef033062f969e70fa40c43dfd945d5a20ab",
      "a5a36d9e82dde7265e38fe1f87b7f11c461c29f6",
      "87d6bef033062f969e70fa40c43dfd945d5a20ab",
      "a5a36d9e82dde7265e38fe1f87b7f11c461c29f6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "87d6bef033062f969e70fa40c43dfd945d5a20ab",
      "commit_date": "2019-09-20T15:02:00Z",
      "author": {
        "login": "mcr",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "do sanity checks on PHB header length before allocating memory. There was no fault; but doing the check results in a more consistent error",
        "length": 138,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 10,
        "deletions": 16
      },
      "files": [
        {
          "filename": "sf-pcapng.c",
          "status": "modified",
          "additions": 10,
          "deletions": 16,
          "patch": "@@ -85,7 +85,7 @@ struct option_header {\n  * Section Header Block.\n  */\n #define BT_SHB\t\t\t0x0A0D0D0A\n-\n+#define BT_SHB_INSANE_MAX       1024*1024*1  /* 1MB should be enough */\n struct section_header_block {\n \tbpf_u_int32\tbyte_order_magic;\n \tu_short\t\tmajor_version;\n@@ -266,7 +266,7 @@ read_bytes(FILE *fp, void *buf, size_t bytes_to_read, int fail_on_eof,\n \t\t\tif (amt_read == 0 && !fail_on_eof)\n \t\t\t\treturn (0);\t/* EOF */\n \t\t\tpcap_snprintf(errbuf, PCAP_ERRBUF_SIZE,\n-\t\t\t    \"truncated dump file; tried to read %\" PRIsize \" bytes, only got %\" PRIsize,\n+\t\t\t    \"truncated pcapng dump file; tried to read %\" PRIsize \" bytes, only got %\" PRIsize,\n \t\t\t    bytes_to_read, amt_read);\n \t\t}\n \t\treturn (-1);\n@@ -856,26 +856,20 @@ pcap_ng_check_header(const uint8_t *magic, FILE *fp, u_int precision,\n \t/*\n \t * Check the sanity of the total length.\n \t */\n-\tif (total_length < sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer)) {\n+\tif (total_length < sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer) ||\n+            (total_length > BT_SHB_INSANE_MAX)) {\n \t\tpcap_snprintf(errbuf, PCAP_ERRBUF_SIZE,\n-\t\t    \"Section Header Block in pcapng dump file has a length of %u < %\" PRIsize,\n-\t\t    total_length,\n-\t\t    sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer));\n-\t\t*err = 1;\n-\t\treturn (NULL);\n-\t}\n+\t\t    \"Section Header Block in pcapng dump file has invalid length %\" PRIsize \" < _%lu_ < %lu (BT_SHB_INSANE_MAX)\",\n+                              sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer),\n+                              total_length,\n+                              BT_SHB_INSANE_MAX);\n \n-\t/*\n-\t * Make sure it's not too big.\n-\t */\n-\tif (total_length > INITIAL_MAX_BLOCKSIZE) {\n-\t\tpcap_snprintf(errbuf, PCAP_ERRBUF_SIZE,\n-\t\t    \"pcapng block size %u > maximum %u\",\n-\t\t    total_length, INITIAL_MAX_BLOCKSIZE);\n \t\t*err = 1;\n \t\treturn (NULL);\n \t}\n \n+\n+\n \t/*\n \t * OK, this is a good pcapng file.\n \t * Allocate a pcap_t for it."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b7af3524d2ad694021d68f91aa8cc4894f837c1a",
            "date": "2025-01-25T16:33:33Z",
            "author_login": "infrastation"
          },
          {
            "sha": "cae8bdc7557382835440fba026353a2e52af6ad7",
            "date": "2025-01-24T20:32:08Z",
            "author_login": "infrastation"
          },
          {
            "sha": "f9f9b228943efeb18f9d5867e4dd0b8deb11feb5",
            "date": "2025-01-23T19:13:38Z",
            "author_login": "infrastation"
          },
          {
            "sha": "31e311a5537fa6c30284ea05f91bc91a52d9e107",
            "date": "2025-01-24T22:21:51Z",
            "author_login": "infrastation"
          },
          {
            "sha": "e3d34e7e69b2aa37cbc124411ec7a862ee3694b3",
            "date": "2025-01-21T20:55:30Z",
            "author_login": "guyharris"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-770",
    "description": "sf-pcapng.c in libpcap before 1.9.1 does not properly validate the PHB header length before allocating memory.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-03T19:15:09.473",
    "last_modified": "2024-11-21T04:28:11.327",
    "fix_date": "2019-09-20T15:02:00Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00051.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00052.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2019/Dec/26",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/blob/libpcap-1.9/CHANGES",
      "source": "cve@mitre.org",
      "tags": [
        "Product",
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/commit/87d6bef033062f969e70fa40c43dfd945d5a20ab",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/commit/a5a36d9e82dde7265e38fe1f87b7f11c461c29f6",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00031.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/12/msg00014.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/5P5K3DQ4TFSZBDB3XN4CZNJNQ3UIF3D3/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/GBIEKWLNIR62KZ5GA7EDXZS52HU6OE5F/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UZTIPUWABYUE5KQOLCKAW65AUUSB7QO6/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Dec/23",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210785",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210788",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210789",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210790",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4221-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4221-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2020.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tcpdump.org/public-cve-list.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00051.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00052.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2019/Dec/26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/blob/libpcap-1.9/CHANGES",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/commit/87d6bef033062f969e70fa40c43dfd945d5a20ab",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/commit/a5a36d9e82dde7265e38fe1f87b7f11c461c29f6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/12/msg00014.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/5P5K3DQ4TFSZBDB3XN4CZNJNQ3UIF3D3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/GBIEKWLNIR62KZ5GA7EDXZS52HU6OE5F/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UZTIPUWABYUE5KQOLCKAW65AUUSB7QO6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Dec/23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210785",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210788",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210789",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT210790",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4221-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4221-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tcpdump.org/public-cve-list.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.931565",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libpcap",
    "owner": "the-tcpdump-group",
    "created_at": "2013-04-14T21:46:36Z",
    "updated_at": "2025-01-25T16:38:11Z",
    "pushed_at": "2025-01-25T16:38:06Z",
    "size": 19363,
    "stars": 2766,
    "forks": 862,
    "open_issues": 133,
    "watchers": 2766,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "libpcap-0.6",
      "libpcap-0.7",
      "libpcap-0.8",
      "libpcap-0.9",
      "libpcap-1.0",
      "libpcap-1.1",
      "libpcap-1.2",
      "libpcap-1.3",
      "libpcap-1.4",
      "libpcap-1.5",
      "libpcap-1.6",
      "libpcap-1.7",
      "libpcap-1.8",
      "libpcap-1.9",
      "libpcap-1.10",
      "master"
    ],
    "languages": {
      "C": 2213383,
      "Roff": 196005,
      "Perl": 171557,
      "CMake": 160284,
      "M4": 86167,
      "Shell": 48212,
      "Makefile": 38449,
      "Lex": 18192,
      "Python": 10732
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:02:57.455284"
  }
}