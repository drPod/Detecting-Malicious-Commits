{
  "cve_id": "CVE-2019-15810",
  "github_data": {
    "repository": "netdisco/netdisco",
    "fix_commit": "deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3",
    "related_commits": [
      "deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3",
      "deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3"
    ],
    "patch_url": "https://github.com/netdisco/netdisco/commit/deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3.patch",
    "fix_commit_details": {
      "sha": "deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3",
      "commit_date": "2019-09-23T13:22:00Z",
      "author": {
        "login": "ollyg",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Enforce escaping on all template content",
        "length": 40,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 779,
        "additions": 392,
        "deletions": 387
      },
      "files": [
        {
          "filename": "Build.PL",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -81,6 +81,7 @@ Module::Build->new(\n     'SQL::Abstract' => '1.85',\n     'SQL::Translator' => '0.11024',\n     'Template' => '2.24',\n+    'Template::AutoFilter' => '0',\n     'Template::Plugin::CSV' => '0.04',\n     'Template::Plugin::Number::Format' => '1.02',\n     'Term::ReadLine' => '0',"
        },
        {
          "filename": "share/config.yml",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -483,11 +483,15 @@ show_errors: false\n logger: 'console'\n engines:\n   netdisco_template_toolkit:\n+    subclass: 'Template::AutoFilter'\n     encoding: 'utf8'\n     start_tag: '[%'\n     end_tag: '%]'\n+    ANYCASE: 1\n+    ABSOLUTE: 1\n     PRE_CHOMP: 1\n     INCLUDE_PATH: []\n+    AUTO_FILTER: 'html_entity'\n layout: 'main'\n plugins:\n   Swagger:"
        },
        {
          "filename": "share/views/admintask.tt",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -9,14 +9,14 @@\n         rel=\"tooltip\" data-placement=\"left\" data-offset=\"5\" data-title=\"Unpin Sidebar\" data-container=\"body\"></i>\n \n       <div class=\"tab-content\">\n-        <div id=\"[% task.tag %]_search\" class=\"tab-pane active\">\n-          <form id=\"[% task.tag %]_form\" class=\"nd_sidebar-form form-stacked\"\n-              method=\"get\" action=\"[% uri_for('/admin') %]\">\n+        <div id=\"[% task.tag | html_entity %]_search\" class=\"tab-pane active\">\n+          <form id=\"[% task.tag | html_entity %]_form\" class=\"nd_sidebar-form form-stacked\"\n+              method=\"get\" action=\"[% uri_for('/admin') | none %]\">\n             [% TRY %]\n-            <script type=\"text/javascript\">has_sidebar[\"[% task.tag %]\"] = 1;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% task.tag | html_entity %]\"] = 1;</script>\n             [% INCLUDE \"sidebar/admintask/${task.tag}.tt\" %]\n             [% CATCH %]\n-            <script type=\"text/javascript\">has_sidebar[\"[% task.tag %]\"] = 0;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% task.tag | html_entity %]\"] = 0;</script>\n             [% END %]\n           </form>\n         </div> <!-- /tab-pane -->\n@@ -26,8 +26,8 @@\n \n   <div class=\"content\">\n     <ul id=\"nd_search-results\" class=\"nav nav-tabs\">\n-      <li class=\"active\"><a id=\"[% task.tag %]_link\" class=\"nd_single-tab\"\n-        href=\"#[% task.tag %]_pane\">[% task.label %]</a></li>\n+      <li class=\"active\"><a id=\"[% task.tag | html_entity %]_link\" class=\"nd_single-tab\"\n+        href=\"#[% task.tag | html_entity %]_pane\">[% task.label | html_entity %]</a></li>\n       [% IF task.tag == 'jobqueue' %]\n       <span id=\"nd_device-name\">\n         <a class=\"nd_adminbutton\" name=\"delall\" href=\"#\"><i class=\"icon-trash text-error\"></i></a>\n@@ -49,7 +49,7 @@\n       [% END %]\n     </ul>\n     <div class=\"tab-content\">\n-      <div class=\"tab-pane active\" id=\"[% task.tag %]_pane\"></div>\n+      <div class=\"tab-pane active\" id=\"[% task.tag | html_entity %]_pane\"></div>\n   </div>\n </div>\n "
        },
        {
          "filename": "share/views/ajax/admintask/duplicatedevices.tt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -21,7 +21,7 @@\n     [% SET count = count + 1 %]\n     <tr>\n       <td class=\"nd_center-cell\"><a class=\"nd_linkcell\"\n-        href=\"[% uri_for('/device') %]?tab=details&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n+        href=\"[% uri_for('/device') | none %]?tab=details&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n         [% row.dns | html_entity %]</td>\n       <td class=\"nd_center-cell\">[% row.contact  | html_entity %]</td>\n       <td class=\"nd_center-cell\">[% row.location | html_entity %]</td>\n@@ -33,15 +33,15 @@\n \n       <td class=\"nd_center-cell\">\n         <button class=\"btn btn-danger btn-small\"\n-          data-toggle=\"modal\" data-target=\"#nd_devdel-[% count %]\" type=\"button\">\n+          data-toggle=\"modal\" data-target=\"#nd_devdel-[% count | html_entity %]\" type=\"button\">\n           <i class=\"icon-trash text-danger\"></i>\n         </button>\n \n-        <div id=\"nd_devdel-[% count %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n-          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count %]\" aria-hidden=\"true\">\n+        <div id=\"nd_devdel-[% count | html_entity %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n+          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count | html_entity %]\" aria-hidden=\"true\">\n           <div class=\"modal-header\">\n             <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">x</button>\n-            <h3 id=\"nd_devdel-label-[% count %]\">Confirm Delete: [% row.ip || row.dns | html_entity %]</h3>\n+            <h3 id=\"nd_devdel-label-[% count | html_entity %]\">Confirm Delete: [% row.ip || row.dns | html_entity %]</h3>\n           </div>\n           <div class=\"modal-body\">\n             <blockquote>"
        },
        {
          "filename": "share/views/ajax/admintask/jobqueue.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -37,9 +37,9 @@\n       [% END %]\n       <td class=\"nd_center-cell\">\n         [% IF row.action == 'discover' AND row.status == 'error' %]\n-        <a href=\"[% uri_for('/') %]?device=[% row.device | uri %]\">[% row.device | html_entity %]</a>\n+        <a href=\"[% uri_for('/') | none %]?device=[% row.device | uri %]\">[% row.device | html_entity %]</a>\n         [% ELSE %]\n-        <a href=\"[% uri_for('/device') %]?q=[% row.device | uri %]\">[% row.target.dns || row.device | html_entity %]</a>\n+        <a href=\"[% uri_for('/device') | none %]?q=[% row.device | uri %]\">[% row.target.dns || row.device | html_entity %]</a>\n         [% END %]\n       </td>\n       <td class=\"nd_center-cell\">[% row.port | html_entity %]</td>"
        },
        {
          "filename": "share/views/ajax/admintask/nodemonitor.tt",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -48,13 +48,13 @@\n         <button class=\"btn nd_adminbutton\" name=\"update\" type=\"submit\"><i class=\"icon-save text-warning\"></i></button>\n \n         <button class=\"btn\" data-toggle=\"modal\"\n-          data-target=\"#nd_devdel-[% count %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n+          data-target=\"#nd_devdel-[% count | html_entity %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n \n-        <div id=\"nd_devdel-[% count %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n-          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count %]\" aria-hidden=\"true\">\n+        <div id=\"nd_devdel-[% count | html_entity %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n+          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count | html_entity %]\" aria-hidden=\"true\">\n           <div class=\"modal-header\">\n             <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">x</button>\n-            <h3 id=\"nd_devdel-label-[% count %]\">Are you sure?</h3>\n+            <h3 id=\"nd_devdel-label-[% count | html_entity %]\">Are you sure?</h3>\n           </div>\n           <div class=\"modal-body\">\n             <blockquote>"
        },
        {
          "filename": "share/views/ajax/admintask/orphaned.tt",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -22,11 +22,11 @@\n         <tbody>\n           [% FOREACH row IN orphans %]\n           <tr>\n-            <td><a href=\"[% uri_for('/device') %]?q=[% row.ip | uri %]\">\n+            <td><a href=\"[% uri_for('/device') | none %]?q=[% row.ip | uri %]\">\n             [% row.dns || row.name || row.ip | html_entity %]</a></td>\n             <td>\n               [% IF row.location %]\n-                <a href=\"[% search_device %]&q=[% row.location | uri %]&location=[% row.location | uri %]\">\n+                <a href=\"[% search_device | none %]&q=[% row.location | uri %]&location=[% row.location | uri %]\">\n                  [% row.location | html_entity %]</a>\n               [% ELSE %]\n                 [Not Set]\n@@ -55,12 +55,12 @@\n   [% NEXT IF count == 1 %]\n   <div class=\"accordion-group\">\n       <div class=\"accordion-heading\"> \n-          <a class=\"accordion-toggle\" data-toggle=\"collapse\" data-target=\"#collapse-[% count %]\" href=\"#collapse-[% count %]\">\n+          <a class=\"accordion-toggle\" data-toggle=\"collapse\" data-target=\"#collapse-[% count | html_entity %]\" href=\"#collapse-[% count | html_entity %]\">\n             <i class=\"icon-chevron-up\"></i> &nbsp;\n               Orphaned Network: [% count - 1 | html_entity  %] Size: [% network.size | html_entity  %] Devices\n           </a>\n       </div>\n-    <div id=\"collapse-[% count %]\" class=\"accordion-body collapse\">\n+    <div id=\"collapse-[% count | html_entity %]\" class=\"accordion-body collapse\">\n       <div class=\"accordion-inner\">\n       <table class=\"table table-bordered table-condensed\">\n         <thead>\n@@ -75,11 +75,11 @@\n         <tbody>\n         [% FOREACH row IN network %]\n           <tr>\n-            <td><a href=\"[% uri_for('/device') %]?tab=netmap&q=[% row.ip | uri %]&firstsearch=on\">\n+            <td><a href=\"[% uri_for('/device') | none %]?tab=netmap&q=[% row.ip | uri %]&firstsearch=on\">\n             [% row.dns || row.name || row.ip | html_entity %]</a></td>\n             <td>\n               [% IF row.location %]\n-                <a href=\"[% search_device %]&q=[% row.location | uri %]&location=[% row.location | uri %]\">\n+                <a href=\"[% search_device | none %]&q=[% row.location | uri %]&location=[% row.location | uri %]\">\n                  [% row.location | html_entity %]</a>\n               [% ELSE %]\n                 [Not Set]"
        },
        {
          "filename": "share/views/ajax/admintask/pseudodevice.tt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -27,7 +27,7 @@\n     [% SET count = count + 1 %]\n     <tr>\n       <td class=\"nd_center-cell\"><a class=\"nd_linkcell\"\n-        href=\"[% uri_for('/device') %]?q=[% row.ip | uri %]\">[% row.dns | html_entity %]</a></td>\n+        href=\"[% uri_for('/device') | none %]?q=[% row.ip | uri %]\">[% row.dns | html_entity %]</a></td>\n       <td class=\"nd_center-cell\">[% row.ip | html_entity %]</td>\n       <td class=\"nd_center-cell\">\n         <input data-form=\"update\" name=\"ports\" type=\"number\" value=\"[% row.port_count | html_entity %]\">\n@@ -43,13 +43,13 @@\n         <button class=\"btn nd_adminbutton\" name=\"update\" type=\"submit\"><i class=\"icon-save text-warning\"></i></button>\n \n         <button class=\"btn\" data-toggle=\"modal\"\n-          data-target=\"#nd_devdel-[% count %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n+          data-target=\"#nd_devdel-[% count | html_entity %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n \n-        <div id=\"nd_devdel-[% count %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n-          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count %]\" aria-hidden=\"true\">\n+        <div id=\"nd_devdel-[% count | html_entity %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n+          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count | html_entity %]\" aria-hidden=\"true\">\n           <div class=\"modal-header\">\n             <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">x</button>\n-            <h3 id=\"nd_devdel-label-[% count %]\">Are you sure?</h3>\n+            <h3 id=\"nd_devdel-label-[% count | html_entity %]\">Are you sure?</h3>\n           </div>\n           <div class=\"modal-body\">\n             <blockquote>"
        },
        {
          "filename": "share/views/ajax/admintask/slowdevices.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -16,7 +16,7 @@\n     <tr>\n       <td class=\"nd_center-cell\">[% row.action.ucfirst | html_entity %]</td>\n       <td class=\"nd_center-cell\"><a class=\"nd_linkcell\"\n-        href=\"[% uri_for('/device') %]?q=[% row.device | uri %]\">[% row.device | html_entity %]</a></td>\n+        href=\"[% uri_for('/device') | none %]?q=[% row.device | uri %]\">[% row.device | html_entity %]</a></td>\n       <td class=\"nd_center-cell\">[% row.started  | html_entity %]</td>\n       <td class=\"nd_center-cell\">[% row.finished | html_entity %]</td>\n       <td class=\"nd_center-cell\">[% row.elapsed  | html_entity %]</td>"
        },
        {
          "filename": "share/views/ajax/admintask/timedoutdevices.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -17,7 +17,7 @@\n     <tr>\n       <td class=\"nd_center-cell\">[% row.backend | html_entity %]</td>\n       <td class=\"nd_center-cell\"><a class=\"nd_linkcell\"\n-        href=\"[% uri_for('/search') %]?tab=node&q=[% row.device | uri %]\">[% row.device | html_entity %]</a></td>\n+        href=\"[% uri_for('/search') | none %]?tab=node&q=[% row.device | uri %]\">[% row.device | html_entity %]</a></td>\n       <td class=\"nd_center-cell\">[% row.dns | html_entity %]</td>\n       <td class=\"nd_center-cell\">[% row.deferrals | html_entity %]</td>\n       <td class=\"nd_center-cell\">[% row.last_defer | html_entity %]</td>"
        },
        {
          "filename": "share/views/ajax/admintask/topology.tt",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -42,22 +42,22 @@\n     [% WHILE (row = results.next) %]\n     [% SET count = count + 1 %]\n     <tr>\n-      <td class=\"nd_center-cell\"><a class=\"nd_linkcell\" href=\"[% uri_for('/device') %]?q=[% row.device1.ip | uri %]\">\n+      <td class=\"nd_center-cell\"><a class=\"nd_linkcell\" href=\"[% uri_for('/device') | none %]?q=[% row.device1.ip | uri %]\">\n         [% (row.device1.dns || row.device1.name || row.device1.ip) | html_entity %]</a>\n       </td>\n       <td class=\"nd_center-cell\">[% row.port1 | html_entity %]</td>\n-      <td class=\"nd_center-cell\"><a class=\"nd_linkcell\" href=\"[% uri_for('/device') %]?q=[% row.device2.ip | uri %]\">\n+      <td class=\"nd_center-cell\"><a class=\"nd_linkcell\" href=\"[% uri_for('/device') | none %]?q=[% row.device2.ip | uri %]\">\n         [% (row.device2.dns || row.device2.name || row.device2.ip) | html_entity %]</a></td>\n       <td class=\"nd_center-cell\">[% row.port2 | html_entity %]</td>\n       <td class=\"nd_center-cell\">\n         <button class=\"btn\" data-toggle=\"modal\"\n-          data-target=\"#nd_devdel-[% count %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n+          data-target=\"#nd_devdel-[% count | html_entity %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n \n-        <div id=\"nd_devdel-[% count %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n-          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count %]\" aria-hidden=\"true\">\n+        <div id=\"nd_devdel-[% count | html_entity %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n+          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count | html_entity %]\" aria-hidden=\"true\">\n           <div class=\"modal-header\">\n             <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">x</button>\n-            <h3 id=\"nd_devdel-label-[% count %]\">Are you sure?</h3>\n+            <h3 id=\"nd_devdel-label-[% count | html_entity %]\">Are you sure?</h3>\n           </div>\n           <div class=\"modal-body\">\n             <blockquote>"
        },
        {
          "filename": "share/views/ajax/admintask/undiscoveredneighbors.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -11,14 +11,14 @@\n     [% FOREACH row IN results %]\n     [% NEXT IF NOT row.remote_ip %]\n     <tr>\n-      <td nowrap><a href=\"[% device_ports %]&q=[% row.ip | uri %]\">\n+      <td nowrap><a href=\"[% device_ports | none %]&q=[% row.ip | uri %]\">\n               [% row.dns || row.name || row.ip | html_entity %]</a><br>\n-          <a href=\"[% device_ports %]&q=[% row.ip | uri %]&f=[% row.port | uri %]\">\n+          <a href=\"[% device_ports | none %]&q=[% row.ip | uri %]&f=[% row.port | uri %]\">\n               [% row.port | html_entity %]</a>\n           [% IF row.port_description %]<br>[% row.port_description | html_entity %][% END %]\n           [% IF row.comment %]<br>&quot;<em>[% row.comment | html_entity %]</em>&quot;[% END %]\n       </td>\n-      <td nowrap><a href=\"[% search_node %]&q=[% row.remote_ip | uri %]\">\n+      <td nowrap><a href=\"[% search_node | none %]&q=[% row.remote_ip | uri %]\">\n           [% row.remote_ip | html_entity %]</a><br>\n           [% row.remote_port | html_entity %]</td>\n       <td>[% row.remote_id | html_entity %]<br>"
        },
        {
          "filename": "share/views/ajax/admintask/userlog.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -19,7 +19,7 @@ $(document).ready(function() {\n   $('#aul-data-table').dataTable( {\n     \"serverSide\": true,\n     \"order\": [[ 0, \"desc\" ]],\n-    \"ajax\": \"[% uri_for('/ajax/control/admin/userlog/data') %]\",\n+    \"ajax\": \"[% uri_for('/ajax/control/admin/userlog/data') | none %]\",\n     \"columns\": [{\n       \"data\": 'creation',\n       \"className\": \"nd_center-cell\","
        },
        {
          "filename": "share/views/ajax/admintask/users.tt",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -66,13 +66,13 @@\n         <button class=\"btn nd_adminbutton\" name=\"update\" type=\"submit\"><i class=\"icon-save text-warning\"></i></button>\n \n         <button class=\"btn\" data-toggle=\"modal\"\n-          data-target=\"#nd_devdel-[% count %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n+          data-target=\"#nd_devdel-[% count | html_entity %]\" type=\"button\"><i class=\"icon-trash text-error\"></i></button>\n \n-        <div id=\"nd_devdel-[% count %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n-          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count %]\" aria-hidden=\"true\">\n+        <div id=\"nd_devdel-[% count | html_entity %]\" class=\"nd_modal nd_deep-horizon modal hide fade\" tabindex=\"-1\"\n+          role=\"dialog\" aria-labelledby=\"nd_devdel-label-[% count | html_entity %]\" aria-hidden=\"true\">\n           <div class=\"modal-header\">\n             <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">x</button>\n-            <h3 id=\"nd_devdel-label-[% count %]\">Are you sure?</h3>\n+            <h3 id=\"nd_devdel-label-[% count | html_entity %]\">Are you sure?</h3>\n           </div>\n           <div class=\"modal-body\">\n             <blockquote>"
        },
        {
          "filename": "share/views/ajax/datatabledefaults.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,8 +1,8 @@\n \n     \"processing\": true\n     ,\"stateSave\": true\n-    ,\"pageLength\": [% settings.table_pagesize %]\n-    ,\"lengthMenu\": [% table_showrecordsmenu %]\n+    ,\"pageLength\": [% settings.table_pagesize | none %]\n+    ,\"lengthMenu\": [% table_showrecordsmenu | none %]\n     ,\"dom\": '<\"top\"l<\"nd_datatables-pager\"p>f>rit<\"bottom\"><\"clear\">'\n     ,\"language\": {\n       \"search\": '_INPUT_'"
        },
        {
          "filename": "share/views/ajax/device/addresses.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -14,7 +14,7 @@\n $(document).ready(function() {\n   var table = $('#da-data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'alias',\n@@ -31,7 +31,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {\n@@ -42,7 +42,7 @@ $(document).ready(function() {\n       }, {\n         \"data\": 'subnet',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '&ip=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '&ip=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }\n     ],"
        },
        {
          "filename": "share/views/ajax/device/details.tt",
          "status": "modified",
          "additions": 22,
          "deletions": 22,
          "patch": "@@ -3,7 +3,7 @@\n   <tbody>\n     <tr>\n       <td>System Name</td>\n-      <td>[% d.name %]</td>\n+      <td>[% d.name | html_entity %]</td>\n     </tr>\n     <tr>\n       <td>Location\n@@ -13,13 +13,13 @@\n       </td>\n       [% IF user_can_port_control %]\n       <td class=\"nd_editable-cell\" contenteditable=\"true\"\n-        data-field=\"location\" data-for-device=\"[% d.ip %]\">\n+        data-field=\"location\" data-for-device=\"[% d.ip | html_entity %]\">\n           [% d.location | html_entity %]\n       </td>\n       [% ELSE %]\n       <td>\n         <a rel=\"tooltip\" data-placement=\"top\" data-offset=\"5\" data-title=\"Find Similar Devices\"\n-        href=\"[% search_device %]&q=[% d.location | uri %]&location=[% d.location | uri %]\">[% d.location | html_entity %]</a>\n+        href=\"[% search_device | none %]&q=[% d.location | uri %]&location=[% d.location | uri %]\">[% d.location | html_entity %]</a>\n       </td>\n       [% END %]\n     </tr>\n@@ -42,20 +42,20 @@\n       <td>Vendor / Model</td>\n       <td>\n         <a rel=\"tooltip\" data-placement=\"top\" data-offset=\"5\" data-title=\"Find Similar Devices\"\n-        href=\"[% search_device %]&q=[% d.vendor | uri %]&vendor=[% d.vendor | uri %]\">[% d.vendor | html_entity %]</a>\n+        href=\"[% search_device | none %]&q=[% d.vendor | uri %]&vendor=[% d.vendor | uri %]\">[% d.vendor | html_entity %]</a>\n         /\n         <a rel=\"tooltip\" data-placement=\"top\" data-offset=\"5\" data-title=\"Find Similar Devices\"\n-        href=\"[% search_device %]&q=[% d.model | uri %]&model=[% d.model | uri %]\">[% d.model | html_entity %]</a>\n+        href=\"[% search_device | none %]&q=[% d.model | uri %]&model=[% d.model | uri %]\">[% d.model | html_entity %]</a>\n       </td>\n     </tr>\n     <tr>\n       <td>OS / Version</td>\n       <td>\n         <a rel=\"tooltip\" data-placement=\"top\" data-offset=\"5\" data-title=\"Find Similar Devices\"\n-        href=\"[% search_device %]&q=[% d.os | uri %]&os=[% d.os | uri %]\">[% d.os | html_entity %]</a>\n+        href=\"[% search_device | none %]&q=[% d.os | uri %]&os=[% d.os | uri %]\">[% d.os | html_entity %]</a>\n         /\n         <a rel=\"tooltip\" data-placement=\"top\" data-offset=\"5\" data-title=\"Find Similar Devices\"\n-        href=\"[% search_device %]&q=[% d.os_ver | uri %]&os_ver=[% d.os_ver | uri %]\">[% d.os_ver | html_entity %]</a>\n+        href=\"[% search_device | none %]&q=[% d.os_ver | uri %]&os_ver=[% d.os_ver | uri %]\">[% d.os_ver | html_entity %]</a>\n       </td>\n     </tr>\n     <tr>\n@@ -70,7 +70,7 @@\n     [% FOREACH config IN settings._extra_device_details %]\n     <tr>\n       <td>\n-          [% config.label %]\n+          [% config.label | html_entity %]\n       </td>\n       <td>\n           [% TRY %]\n@@ -104,13 +104,13 @@\n     <tr>\n       <td>Layers</td>\n       <td>\n-        [% d.layers.substr(7,1) ? '<span class=\"badge badge-success\">1</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n-        [% d.layers.substr(6,1) ? '<span class=\"badge badge-success\">2</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n-        [% d.layers.substr(5,1) ? '<span class=\"badge badge-success\">3</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n-        [% d.layers.substr(4,1) ? '<span class=\"badge badge-success\">4</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n-        [% d.layers.substr(3,1) ? '<span class=\"badge badge-success\">5</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n-        [% d.layers.substr(2,1) ? '<span class=\"badge badge-success\">6</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n-        [% d.layers.substr(1,1) ? '<span class=\"badge badge-success\">7</span>' : '<span class=\"badge\">&nbsp;</span>' %]\n+        [% (d.layers.substr(7,1) ? '<span class=\"badge badge-success\">1</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n+        [% (d.layers.substr(6,1) ? '<span class=\"badge badge-success\">2</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n+        [% (d.layers.substr(5,1) ? '<span class=\"badge badge-success\">3</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n+        [% (d.layers.substr(4,1) ? '<span class=\"badge badge-success\">4</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n+        [% (d.layers.substr(3,1) ? '<span class=\"badge badge-success\">5</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n+        [% (d.layers.substr(2,1) ? '<span class=\"badge badge-success\">6</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n+        [% (d.layers.substr(1,1) ? '<span class=\"badge badge-success\">7</span>' : '<span class=\"badge\">&nbsp;</span>') | none %]\n       </td>\n     </tr>\n     <tr>\n@@ -139,7 +139,7 @@\n         [% UNLESS m.module == 1 %]\n           <br/>\n         [% END %]\n-        Module [% m.module %]: [% m.status | html_entity %], [% m.poe_capable_ports %] power-capable ports, [% m.poe_powered_ports %] powered ([% m.poe_disabled_ports %] admin disabled, [% m.poe_errored_ports %] errors), [% m.poe_power_committed %]/[% m.power %] watts committed.\n+        Module [% m.module | html_entity %]: [% m.status | html_entity %], [% m.poe_capable_ports | html_entity %] power-capable ports, [% m.poe_powered_ports | html_entity %] powered ([% m.poe_disabled_ports | html_entity %] admin disabled, [% m.poe_errored_ports | html_entity %] errors), [% m.poe_power_committed | html_entity %]/[% m.power | html_entity %] watts committed.\n       [% END %]\n       </td>\n     </tr>\n@@ -153,16 +153,16 @@\n       <td>[% d.vtp_domain | html_entity %]</td>\n     </tr>\n     [% IF user_has_role('admin') %]\n-    <tr data-for-device=\"[% d.ip %]\">\n+    <tr data-for-device=\"[% d.ip | html_entity %]\">\n       <td>Admin Tasks</td>\n       <td>\n-        <input type=\"hidden\" data-form=\"discover\" value=\"[% d.ip %]\" name=\"device\"/>\n+        <input type=\"hidden\" data-form=\"discover\" value=\"[% d.ip | html_entity %]\" name=\"device\"/>\n         <button class=\"btn btn-info btn-small nd_adminbutton\" name=\"discover\">Discover</button>\n-        <input type=\"hidden\" data-form=\"arpnip\" value=\"[% d.ip %]\" name=\"device\"/>\n+        <input type=\"hidden\" data-form=\"arpnip\" value=\"[% d.ip | html_entity %]\" name=\"device\"/>\n         <button class=\"btn btn-info btn-small nd_adminbutton\" name=\"arpnip\">Arpnip</button>\n-        <input type=\"hidden\" data-form=\"macsuck\" value=\"[% d.ip %]\" name=\"device\"/>\n+        <input type=\"hidden\" data-form=\"macsuck\" value=\"[% d.ip | html_entity %]\" name=\"device\"/>\n         <button class=\"btn btn-info btn-small nd_adminbutton\" name=\"macsuck\">Macsuck</button>\n-        <input type=\"hidden\" data-form=\"nbtstat\" value=\"[% d.ip %]\" name=\"device\"/>\n+        <input type=\"hidden\" data-form=\"nbtstat\" value=\"[% d.ip | html_entity %]\" name=\"device\"/>\n         <button class=\"btn btn-info btn-small nd_adminbutton\" name=\"nbtstat\">NBTstat</button>\n \n         <button class=\"btn btn-danger btn-small pull-right\"\n@@ -187,7 +187,7 @@\n               <input id=\"nd_devdel-archive\" type=\"checkbox\" data-form=\"delete\" name=\"archive\">\n               <h4 class=\"nd_unbolden\">Archive Nodes</h4>\n             </label>\n-            <input type=\"hidden\" data-form=\"delete\" value=\"[% d.ip %]\" name=\"device\"/>\n+            <input type=\"hidden\" data-form=\"delete\" value=\"[% d.ip | html_entity %]\" name=\"device\"/>\n           </div>\n           <div class=\"modal-footer\">\n             <button class=\"btn btn-success\" data-dismiss=\"modal\" aria-hidden=\"true\">Cancel</button>"
        },
        {
          "filename": "share/views/ajax/device/modules.tt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -20,9 +20,9 @@\n [%- ELSE -%]\n <span><i class=\"icon-leaf\"></i>&nbsp;\n [%- END -%]\n- <a href=\"[% uri_for('/report/moduleinventory') %]?description=[% nodes.$item.module.description | uri %]\">[% nodes.$item.module.description -%]</a>\n+ <a href=\"[% uri_for('/report/moduleinventory') | none %]?description=[% nodes.$item.module.description | uri %]\">[% nodes.$item.module.description -%]</a>\n [%- IF nodes.$item.module.name -%]\n- <a href=\"[% uri_for('/report/moduleinventory') %]?name=[% nodes.$item.module.name | uri %]\">([% nodes.$item.module.name %])</a>\n+ <a href=\"[% uri_for('/report/moduleinventory') | none %]?name=[% nodes.$item.module.name | uri %]\">([% nodes.$item.module.name %])</a>\n [%- END -%]\n [%- IF nodes.$item.module.fw_ver -%]\n  fw: [% nodes.$item.module.fw_ver %]\n@@ -34,13 +34,13 @@\n  sw: [% nodes.$item.module.sw_ver %]\n [%- END -%]\n [%- IF nodes.$item.module.serial -%]\n- <a href=\"[% uri_for('/report/moduleinventory') %]?serial=[% nodes.$item.module.serial | uri %]\">[serial: [% nodes.$item.module.serial %]]</a>\n+ <a href=\"[% uri_for('/report/moduleinventory') | none %]?serial=[% nodes.$item.module.serial | uri %]\">[serial: [% nodes.$item.module.serial %]]</a>\n [%- END -%]\n [%- IF nodes.$item.module.type -%]\n- / <a href=\"[% uri_for('/report/moduleinventory') %]?type=[% nodes.$item.module.type | uri %]\">[% nodes.$item.module.type %]</a>\n+ / <a href=\"[% uri_for('/report/moduleinventory') | none %]?type=[% nodes.$item.module.type | uri %]\">[% nodes.$item.module.type %]</a>\n [%- END -%]\n [%- IF nodes.$item.module.model -%]\n- / <a href=\"[% uri_for('/report/moduleinventory') %]?model=[% nodes.$item.module.model | uri %]\">[% nodes.$item.module.model %]</a>\n+ / <a href=\"[% uri_for('/report/moduleinventory') | none %]?model=[% nodes.$item.module.model | uri %]\">[% nodes.$item.module.model %]</a>\n [%- END -%]\n [%- IF nodes.$item.module.fru -%]\n  <b>[FRU]</b>"
        },
        {
          "filename": "share/views/ajax/device/netmap.tt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -5,7 +5,7 @@\n // ************ retrieve network map *************\n // ***********************************************\n \n-$.getJSON('[% uri_for('/ajax/data/device/netmap') %]?[% my_query %]', function(mapdata) {\n+$.getJSON('[% uri_for('/ajax/data/device/netmap') | none %]?[% my_query | none %]', function(mapdata) {\n \n   jQuery(document).ready(function() {\n     window.graph = netGobrechtsD3Force('netmap_pane')\n@@ -22,7 +22,7 @@ $.getJSON('[% uri_for('/ajax/data/device/netmap') %]?[% my_query %]', function(m\n       .showLinkDirection(false)\n       .colorScheme('color10')\n       //.preventLabelOverlappingOnForceEnd(\n-      //  (mapdata['newnodes'] && ('[% params.mapshow %]' == 'neighbors'))\n+      //  (mapdata['newnodes'] && ('[% params.mapshow | html_entity %]' == 'neighbors'))\n       //  ? true : false\n       //)\n       .nodeEventToStopPinMode('none')\n@@ -158,9 +158,9 @@ $.getJSON('[% uri_for('/ajax/data/device/netmap') %]?[% my_query %]', function(m\n     graph.start(mapdata);\n \n     // about a second after render starts, zoom in a bit\n-    if ('[% params.mapshow %]' == 'neighbors') {\n+    if ('[% params.mapshow | html_entity %]' == 'neighbors') {\n       setTimeout(function() {\n-        //if ('[% params.dynamicsize %]' == 'on') {\n+        //if ('[% params.dynamicsize | html_entity %]' == 'on') {\n         //  graph.zoomToFit();\n         //} else {\n           var node = graph.nodeDataById( graph['nd2']['centernode'] );\n@@ -215,7 +215,7 @@ function spin(selection, duration) {\n function saveMapPositions() {\n   graph.inspect().main.nodes.each(function(n) { n.fixed = true });\n   $.post(\n-    '[% uri_for('/ajax/data/device/netmappositions') %]'\n+    '[% uri_for('/ajax/data/device/netmappositions') | none %]'\n     ,$(\"#nd_vlan-entry, #nd_hgroup-select, #nd_lgroup-select, #nq, input[name='mapshow']\").serialize()\n       + '&positions=' + JSON.stringify(graph.positions())\n   );"
        },
        {
          "filename": "share/views/ajax/device/ports.tt",
          "status": "modified",
          "additions": 17,
          "deletions": 17,
          "patch": "@@ -11,7 +11,7 @@\n         [% IF (item.name == 'c_port' OR item.name == 'c_descr' OR item.name == 'c_name') %]\n           [% th_class = ' class=\"portsort\"' %]\n         [% END %]\n-        <th[% th_class %]>\n+        <th[% th_class | html_entity %]>\n           [% IF item.name == 'c_neighbors' %]\n           [% IF params.c_nodes %]\n           Connected Nodes &amp; Devices\n@@ -84,7 +84,7 @@\n       <td nowrap data-order=\"[% row.port | html_entity %]\" data-filter=\"[% row.port | html_entity %]\">\n       [% END %]\n         <a class=\"nd_log-icon\"\n-          href=\"[% uri_for('/report/portlog') %]?q=[% device.ip | uri %]&f=[% row.port | uri %]\">\n+          href=\"[% uri_for('/report/portlog') | none %]?q=[% device.ip | uri %]&f=[% row.port | uri %]\">\n           <i class=\"icon-file-text-alt\"\n             rel=\"tooltip\" data-placement=\"top\" data-offset=\"3\"\n             data-animation=\"\" data-title=\"View Port Log\"></i>\n@@ -110,13 +110,13 @@\n         </span>\n       [% END %]\n       [% END %]\n-        <a class=\"nd_this-port-only nd_port-only-first\" href=\"[% device_ports %]&q=[% params.q | uri %]&f=[% row.port | uri %]&prefer=port\">\n+        <a class=\"nd_this-port-only nd_port-only-first\" href=\"[% device_ports | none %]&q=[% params.q | uri %]&f=[% row.port | uri %]&prefer=port\">\n           [% IF row.is_master %]\n             <small><i class=\"icon-group muted\"></i></small>&nbsp;\n           [% END %]\n         [% row.port | html_entity %]</a>\n         [% IF row.slave_of %]<br/>\n-          <a class=\"nd_this-port-only\" href=\"[% device_ports %]&q=[% params.q | uri %]&f=[% row.slave_of | uri %]&prefer=port\">\n+          <a class=\"nd_this-port-only\" href=\"[% device_ports | none %]&q=[% params.q | uri %]&f=[% row.slave_of | uri %]&prefer=port\">\n           [% row.slave_of | html_entity %]</a>\n         [% END %]\n       </td>\n@@ -204,7 +204,7 @@\n       <td>\n         [% IF row.vlan AND row.vlan > 0 %]\n         <a class=\"nd_linkcell\"\n-          href=\"[% uri_for('/search') %]?tab=vlan&q=[% row.vlan | uri %]\">\n+          href=\"[% uri_for('/search') | none %]?tab=vlan&q=[% row.vlan | uri %]\">\n             [% row.vlan | html_entity %]</a>\n         [% END %]\n       </td>\n@@ -229,7 +229,7 @@\n                 <div class=\"nd_collapsing nd_collapse-pre-hidden\">' _ output %]\n             [% SET output = output _ '</div>' %]\n           [% END %]\n-          [% output %]\n+          [% output | none %]\n         [% ELSE %]\n         <i class=\"icon-asterisk text-warning\"></i> ([% vlans.$portname.vlan_count %] is too many to list)\n         [% END %]\n@@ -292,16 +292,16 @@\n             [% ELSIF row.remote_is_wap %]\n               <i class=\"icon-rss\"></i>&nbsp;\n             [% END %]\n-            <a href=\"[% device_ports %]&q=[% row.get_column('neighbor_ip') | uri %]\">\n+            <a href=\"[% device_ports | none %]&q=[% row.get_column('neighbor_ip') | uri %]\">\n                 [% row.get_column('neighbor_dns').remove(settings.domain_suffix) || row.get_column('neighbor_ip') | html_entity %]</a>\n             [% IF row.remote_port and has_snmp(row.remote_type) %]\n                 -\n-                <a href=\"[% device_ports %]&q=[% row.get_column('neighbor_ip') | uri %]&f=[% row.remote_port | uri %]&prefer=port\">\n+                <a href=\"[% device_ports | none %]&q=[% row.get_column('neighbor_ip') | uri %]&f=[% row.remote_port | uri %]&prefer=port\">\n                     [% row.remote_port | html_entity %]</a>\n             [% END %]\n             <br/>\n             [% IF params.n_inventory and row.remote_inventory %]\n-              [% row.remote_inventory %]<br/>\n+              [% row.remote_inventory | html_entity %]<br/>\n             [% END %]\n             [% IF params.n_detailed_inventory and (row.remote_id or row.remote_type) %]\n               ([% 'id: '_ row.remote_id IF row.remote_id %]\n@@ -314,14 +314,14 @@\n             [% ELSIF row.remote_is_wap %]\n               <i class=\"icon-rss\"></i>&nbsp;\n             [% END %]\n-            <a href=\"[% search_node %]&q=[% row.remote_ip | uri %]\">\n+            <a href=\"[% search_node | none %]&q=[% row.remote_ip | uri %]\">\n               [% row.remote_ip | html_entity %]\n               [% IF row.remote_port and has_snmp(row.remote_type) %]\n                 - [% row.remote_port | html_entity %]\n               [% END %]\n             </a><br/>\n             [% IF params.n_inventory and row.remote_inventory %]\n-              [% row.remote_inventory %]<br/>\n+              [% row.remote_inventory | html_entity %]<br/>\n             [% END %]\n             [% IF params.n_detailed_inventory and (row.remote_id or row.remote_type) %]\n               ([% 'id: '_ row.remote_id IF row.remote_id %]\n@@ -336,7 +336,7 @@\n           [% '<br/>' IF (row.remote_ip OR row.is_uplink) OR NOT loop.first %]\n           [% '<i class=\"icon-book\"></i>&nbsp; ' IF NOT node.active %]\n           [% '<i class=\"icon-signal\"></i>&nbsp;' IF node.wireless.defined %]\n-          <a href=\"[% search_node %]&q=[% node.net_mac.$mac_format_call | uri %]\">\n+          <a href=\"[% search_node | none %]&q=[% node.net_mac.$mac_format_call | uri %]\">\n             [% node.net_mac.$mac_format_call | html_entity %]</a>\n           [% IF (node.vlan > 0) && (node.vlan != row.vlan) %]\n             (on vlan [% node.vlan | html_entity %])\n@@ -361,23 +361,23 @@\n             <br/>&nbsp; [% '<i class=\"icon-book\"></i>&nbsp; ' IF NOT ip.active %]\n               [% SET dns = ip.dns %]\n               [% IF dns %]\n-              <a href=\"[% search_node %]&q=[% ip.ip | uri %]\">[% dns %] ([% ip.ip | html_entity %])</a>\n+              <a href=\"[% search_node | none %]&q=[% ip.ip | uri %]\">[% dns | html_entity %] ([% ip.ip | html_entity %])</a>\n               [% ELSE %]\n-              <a href=\"[% search_node %]&q=[% ip.ip | uri %]\">[% ip.ip | html_entity %]</a>\n+              <a href=\"[% search_node | none %]&q=[% ip.ip | uri %]\">[% ip.ip | html_entity %]</a>\n               [% END %]\n             [% END %]\n           [% END %]\n           [% IF params.n_netbios %]\n             [% FOREACH nbt IN node.netbios %]\n-            <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\<a href=\"[% uri_for('/report/netbios') %]?domain=[% nbt.domain | uri %]\" title=\"Nodes in this Domain\">[% nbt.domain | html_entity %]</a>\\<a href=\"[% search_node %]&q=[% nbt.nbname | uri %]\">[% nbt.nbname | html_entity %]</a>\n-            <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[% nbt.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node %]&q=[% nbt.ip | uri %]\">[% nbt.ip | html_entity %]</a>\n+            <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\<a href=\"[% uri_for('/report/netbios') | none %]?domain=[% nbt.domain | uri %]\" title=\"Nodes in this Domain\">[% nbt.domain | html_entity %]</a>\\<a href=\"[% search_node | none %]&q=[% nbt.nbname | uri %]\">[% nbt.nbname | html_entity %]</a>\n+            <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[% nbt.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node | none %]&q=[% nbt.ip | uri %]\">[% nbt.ip | html_entity %]</a>\n             [% END %]\n           [% END %]\n         [% END %]\n         [% END %]\n         [% IF user_can_port_control AND params.c_admin %]\n         <a class=\"nd_log-icon\"\n-          href=\"[% uri_for('/admin/topology') %]?dev1=[% device.ip | uri %]&port1=[% row.port | uri %]\">\n+          href=\"[% uri_for('/admin/topology') | none %]?dev1=[% device.ip | uri %]&port1=[% row.port | uri %]\">\n           <i class=\"icon-link text-warning\"\n             rel=\"tooltip\" data-placement=\"top\" data-offset=\"3\"\n             data-animation=\"\" data-title=\"Manual Topology\"></i>"
        },
        {
          "filename": "share/views/ajax/device/vlans.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -11,17 +11,17 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'vlan',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + data + '</a>';\n+          return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + data + '</a>';\n         }\n       }, {\n         \"data\": 'description',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/search') %]?tab=vlan&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% uri_for('/search') | none %]?tab=vlan&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }\n     ],"
        },
        {
          "filename": "share/views/ajax/report/apchanneldist.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@ $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n     \"order\": [[ 1, \"desc\" ]],\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'channel'"
        },
        {
          "filename": "share/views/ajax/report/apclients.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -16,13 +16,13 @@ $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n     \"order\": [[ 5, \"desc\" ]],\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% uri_for('/device') %]?tab=details&q=' + encodeURIComponent(row.ip) + '\">'\n+            '<a href=\"[% uri_for('/device') | none %]?tab=details&q=' + encodeURIComponent(row.ip) + '\">'\n             + he.encode(row.dns || row.name || row.ip) + '</a>' :\n           data;\n         }\n@@ -41,7 +41,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {"
        },
        {
          "filename": "share/views/ajax/report/apradiochannelpower.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -25,7 +25,7 @@ function groupString(d) {\n     \"use strict\";\n     var s = '';\n     s = s + 'Device: ';\n-    s = s + '<a href=\"[% uri_for('/device') %]?tab=details&q=' + encodeURIComponent(d.ip) + '\">';\n+    s = s + '<a href=\"[% uri_for('/device') | none %]?tab=details&q=' + encodeURIComponent(d.ip) + '\">';\n     s = s + he.encode(d.dns || d.device_name || d.ip);\n     if (d.dns || d.device_name) {\n         s = s + ' (' +  he.encode(d.ip) + ') ';\n@@ -39,7 +39,7 @@ function groupString(d) {\n $(document).ready(function() {\n   var table = $('#data-table').DataTable({\n     \"serverSide\": true,\n-    \"ajax\": \"[% uri_for('/ajax/content/report/apradiochannelpower/data') %]\",\n+    \"ajax\": \"[% uri_for('/ajax/content/report/apradiochannelpower/data') | none %]\",\n     \"order\": [[ 0, 'asc' ]],\n     \"columns\": [\n       {\n@@ -59,7 +59,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {"
        },
        {
          "filename": "share/views/ajax/report/deviceaddrnodns.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -13,11 +13,11 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [{\n         \"data\": 'ip',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.name || row.ip) + '</a>';\n+          return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.name || row.ip) + '</a>';\n         }\n       }, {\n         \"data\": 'alias',"
        },
        {
          "filename": "share/views/ajax/report/devicebylocation.tt",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -15,13 +15,13 @@ $(document).ready(function() {\n     var table = $('#data-table').dataTable({\n         \"deferRender\": true,\n         \"order\": [[ 0, \"asc\" ], [2, \"asc\"], [ 3, \"asc\" ], [4, \"asc\"]],\n-        \"data\": [% results %],\n+        \"data\": [% results | none %],\n         \"columns\": [\n            {\n                 \"data\": 'location',\n                 \"render\": function(data, type, row, meta) {\n                   if (data) {\n-                    return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '&location=' + encodeURIComponent(data) + '\">' + he.encode(data) + '</a>';\n+                    return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '&location=' + encodeURIComponent(data) + '\">' + he.encode(data) + '</a>';\n \n                   } else {\n                     return '[Not Set]';\n@@ -30,22 +30,22 @@ $(document).ready(function() {\n             }, {\n                 \"data\": 'ip',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% uri_for('/device') %]?q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.ip) + '</a>';\n+                    return '<a href=\"[% uri_for('/device') | none %]?q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.ip) + '</a>';\n                 }\n             }, {\n                 \"data\": 'name',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+                    return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n                 }\n             }, {\n                 \"data\": 'vendor',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+                    return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n                 }\n             }, {\n                 \"data\": 'model',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+                    return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n                 }\n             }\n         ],"
        },
        {
          "filename": "share/views/ajax/report/devicednsmismatch.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,12 +14,12 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n         \"render\": function(data, type, row, meta) {\n-            return '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '\">' + he.encode(row.name || row.ip) + '</a>';\n+            return '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(row.name || row.ip) + '</a>';\n           }\n       }, {\n         \"data\": 'dns',"
        },
        {
          "filename": "share/views/ajax/report/devicepoestatus.tt",
          "status": "modified",
          "additions": 16,
          "deletions": 16,
          "patch": "@@ -20,20 +20,20 @@\n   <tbody>\n     [% FOREACH row IN results %]\n     <tr>\n-      <td>[% row.ip %]</td>\n-      <td>[% row.dns %]</td>\n-      <td>[% row.name %]</td>\n-      <td>[% row.model %]</td>\n-      <td>[% row.location %]</td>\n-      <td>[% row.module %]</td>\n-      <td class=\"nd_center-cell\">[% row.power %]</td>\n-      <td class=\"nd_center-cell\">[% row.status %]</td>\n-      <td class=\"nd_center-cell\">[% row.poe_capable_ports %]</td>\n-      <td class=\"nd_center-cell\">[% row.poe_powered_ports %]</td>\n-      <td class=\"nd_center-cell\">[% row.poe_disabled_ports %]</td>\n-      <td class=\"nd_center-cell\">[% row.poe_errored_ports %]</td>\n-      <td class=\"nd_center-cell\">[% row.poe_power_committed %]</td>\n-      <td class=\"nd_center-cell\">[% row.poe_power_delivering %]</td>\n+      <td>[% row.ip | html_entity %]</td>\n+      <td>[% row.dns | html_entity %]</td>\n+      <td>[% row.name | html_entity %]</td>\n+      <td>[% row.model | html_entity %]</td>\n+      <td>[% row.location | html_entity %]</td>\n+      <td>[% row.module | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.power | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.status | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.poe_capable_ports | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.poe_powered_ports | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.poe_disabled_ports | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.poe_errored_ports | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.poe_power_committed | html_entity %]</td>\n+      <td class=\"nd_center-cell\">[% row.poe_power_delivering | html_entity %]</td>\n     </tr>\n     [% END %]\n   </tbody>\n@@ -51,7 +51,7 @@ function groupString(d) {\n     \"use strict\";\n     var s = '';\n     s = s + 'Device: ';\n-    s = s + '<a href=\"[% uri_for('/device') %]?tab=details&q=' + encodeURIComponent(d.ip) + '\">';\n+    s = s + '<a href=\"[% uri_for('/device') | none %]?tab=details&q=' + encodeURIComponent(d.ip) + '\">';\n     s = s + he.encode(d.dns || d.name || d.ip);\n     if (d.dns || d.name) {\n         s = s + ' (' +  he.encode(d.ip) + ') ';\n@@ -65,7 +65,7 @@ function groupString(d) {\n $(document).ready(function() {\n     var table = $('#data-table').DataTable({\n     \"serverSide\": true,\n-    \"ajax\": \"[% uri_for('/ajax/content/report/devicepoestatus/data') %]\",\n+    \"ajax\": \"[% uri_for('/ajax/content/report/devicepoestatus/data') | none %]\",\n     \"order\": [[ 0, 'asc' ]],\n     \"columns\": [\n       {"
        },
        {
          "filename": "share/views/ajax/report/duplexmismatch.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -15,7 +15,7 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'left_ip',\n@@ -27,7 +27,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.left_dns || row.left_ip) + '&f=' + encodeURIComponent(data) + '&c_duplex=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.left_dns || row.left_ip) + '&f=' + encodeURIComponent(data) + '&c_duplex=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {\n@@ -45,7 +45,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.right_dns || row.right_ip) + '&f=' + encodeURIComponent(data) + '&c_duplex=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.right_dns || row.right_ip) + '&f=' + encodeURIComponent(data) + '&c_duplex=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {"
        },
        {
          "filename": "share/views/ajax/report/halfduplex.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -13,7 +13,7 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n@@ -25,7 +25,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_duplex=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_duplex=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {"
        },
        {
          "filename": "share/views/ajax/report/inventorybymodelbyos.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,13 +10,13 @@\n     [% FOREACH row IN results %]\n     <tr>\n       <td>\n-        <a href=\"[% search_device %]&q=[% row.model | uri %]&vendor=[% row.vendor | uri %]&model=[% row.model | uri %]\">\n+        <a href=\"[% search_device | none %]&q=[% row.model | uri %]&vendor=[% row.vendor | uri %]&model=[% row.model | uri %]\">\n             [% row.vendor.ucfirst | html_entity %]&nbsp;[% row.model | html_entity %]</a>\n             [% IF row.os %] running &quot;[% row.os | html_entity %]&quot;[% END %]\n       </td>\n       <td>\n         <a class=\"nd_linkcell\"\n-          href=\"[% search_device %]&q=[% row.os_ver | uri %]&vendor=[% row.vendor | uri %]&model=[% row.model | uri %]&os=[% row.os | uri %]&os_ver=[% row.os_ver | uri %]&matchall=on\">\n+          href=\"[% search_device | none %]&q=[% row.os_ver | uri %]&vendor=[% row.vendor | uri %]&model=[% row.model | uri %]&os=[% row.os | uri %]&os_ver=[% row.os_ver | uri %]&matchall=on\">\n             [% row.os_ver | html_entity %]</a>\n       </td>\n       <td>[% row.os_ver_count | html_entity %]</td>"
        },
        {
          "filename": "share/views/ajax/report/ipinventory.tt",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -13,20 +13,20 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n         \"render\": function(data, type, row, meta) {\n           var cell_str = he.encode(data);\n           if (type == 'display') {\n             if (row.time_last && row.node) {\n-              cell_str = '<a href=\"[% search_node %]&q=' + encodeURIComponent(data)\n+              cell_str = '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data)\n                 + (row.active ? '' : '&archived=on') + '\">' + he.encode(data)\n                 + (row.active ? '' : '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;') + '</a>';\n             }\n             else if (row.time_last) {\n-              cell_str = '<a href=\"[% search_device %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data) + '</a>';\n+              cell_str = '<a href=\"[% search_device | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data) + '</a>';\n             }\n           }\n           return cell_str;\n@@ -36,7 +36,7 @@ $(document).ready(function() {\n         \"render\": function(data, type, row, meta) {\n           var cell_str = he.encode(data || '');\n           if (type == 'display' && data && row.time_last) {\n-            cell_str = '<a href=\"[% search_node %]&q=' + encodeURIComponent(data)\n+            cell_str = '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data)\n               + (row.active ? '' : '&archived=on') + '\">' + he.encode(data)\n               + (row.active ? '' : '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;') + '</a>';\n           }"
        },
        {
          "filename": "share/views/ajax/report/moduleinventory.tt",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -34,42 +34,42 @@ $(document).ready(function() {\n     \"serverSide\": true,\n     \"searching\": false,\n     \"order\": [[ 0, \"desc\" ]],\n-    \"ajax\": \"[% uri_for('/ajax/content/report/moduleinventory/data') %]?[% url(params('query').hash) %]\",\n+    \"ajax\": \"[% uri_for('/ajax/content/report/moduleinventory/data') | none %]?[% url(params('query').hash) | none %]\",\n     \"columns\": [\n       {\n       \"data\": 'ip',\n       \"render\": function(data, type, row, meta) {\n-        return '<a href=\"[% uri_for('/device') %]?tab=modules&q=' + encodeURIComponent(data) + '\">' + he.encode(row.device.dns || row.device.name || row.ip) + '</a>';\n+        return '<a href=\"[% uri_for('/device') | none %]?tab=modules&q=' + encodeURIComponent(data) + '\">' + he.encode(row.device.dns || row.device.name || row.ip) + '</a>';\n         }\n       }, {\n         \"data\": 'description',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&description=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&description=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'name',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&name=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&name=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'class',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&class=' + encodeURIComponent(data) + '\">' + he.encode(capitalizeFirstLetter(data + '')) + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&class=' + encodeURIComponent(data) + '\">' + he.encode(capitalizeFirstLetter(data + '')) + '</a>';\n         }\n       }, {\n         \"data\": 'type',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&type=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&type=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'model',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&model=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'serial',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&serial=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&serial=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'hw_ver',\n@@ -90,12 +90,12 @@ $(document).ready(function() {\n     ],\n     [% ELSE %]\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'class',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% report_moduleinventory %]&class=' + encodeURIComponent(data) + '\">' + he.encode(capitalizeFirstLetter(data + '')) + '</a>';\n+          return '<a href=\"[% report_moduleinventory | none %]&class=' + encodeURIComponent(data) + '\">' + he.encode(capitalizeFirstLetter(data + '')) + '</a>';\n         }\n       }, {\n         \"data\": 'count',"
        },
        {
          "filename": "share/views/ajax/report/netbios.tt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -29,7 +29,7 @@ $(document).ready(function() {\n     [% IF opt %]\n     \"serverSide\": true,\n     \"order\": [[ 0, \"desc\" ]],\n-    \"ajax\": \"[% uri_for('/ajax/content/report/netbios/data') %]?[% url(params('query').hash) %]\",\n+    \"ajax\": \"[% uri_for('/ajax/content/report/netbios/data') | none %]?[% url(params('query').hash) | none %]\",\n     \"columns\": [\n       {\n         \"data\": 'domain',\n@@ -39,7 +39,7 @@ $(document).ready(function() {\n       }, {\n         \"data\": 'mac',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% search_node %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data.toUpperCase()) + '</a>';\n+          return '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data.toUpperCase()) + '</a>';\n         }\n       }, {\n         \"data\": 'nbname',\n@@ -48,7 +48,7 @@ $(document).ready(function() {\n           if (row.domain) {\n             prefix = '\\\\\\\\' + row.domain + '\\\\';\n           }\n-          return he.encode(prefix) + '<a href=\"[% search_node %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data) + '</a>';\n+          return he.encode(prefix) + '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data) + '</a>';\n         }\n       }, {\n         \"data\": 'nbuser',\n@@ -70,12 +70,12 @@ $(document).ready(function() {\n     \"order\": [[0, \"asc\"], [5, \"desc\"]],\n     [% ELSE %]\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [    \n       {\n         \"data\": 'domain',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/report/netbios') %]?domain=' + encodeURIComponent(data || 'blank') + '\">' + he.encode(data || '(Blank Domain)') + '</a>';\n+          return '<a href=\"[% uri_for('/report/netbios') | none %]?domain=' + encodeURIComponent(data || 'blank') + '\">' + he.encode(data || '(Blank Domain)') + '</a>';\n         }\n       }, {\n         \"data\": 'count',"
        },
        {
          "filename": "share/views/ajax/report/nodemultiips.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -15,12 +15,12 @@ $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n     \"order\": [[ 3, \"desc\" ]],\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'mac',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% search_node %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data.toUpperCase()) + '</a>';\n+          return '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data.toUpperCase()) + '</a>';\n         }\n       }, {\n         \"data\": 'vendor',\n@@ -30,7 +30,7 @@ $(document).ready(function() {\n       }, {\n         \"data\": 'port',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.switch) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(row.dns || row.name || row.switch) + '(' + he.encode(data) + ')</a>';\n+          return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.switch) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(row.dns || row.name || row.switch) + '(' + he.encode(data) + ')</a>';\n         }\n       }, {\n         \"data\": 'ip_count',"
        },
        {
          "filename": "share/views/ajax/report/nodesdiscovered.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -15,7 +15,7 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n@@ -27,7 +27,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&c_nodes=on&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&c_nodes=on&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {\n@@ -38,7 +38,7 @@ $(document).ready(function() {\n       }, {\n         \"data\": 'remote_ip',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% search_node %]&q=' + encodeURIComponent(data || '') + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data || '') + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'remote_port',"
        },
        {
          "filename": "share/views/ajax/report/nodevendor.tt",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -29,7 +29,7 @@ $(document).ready(function() {\n     [% IF opt %]\n     \"serverSide\": true,\n     \"order\": [[ 0, \"desc\" ]],\n-    \"ajax\": \"[% uri_for('/ajax/content/report/nodevendor/data') %]?[% url(params('query').hash) %]\",\n+    \"ajax\": \"[% uri_for('/ajax/content/report/nodevendor/data') | none %]?[% url(params('query').hash) | none %]\",\n     \"columns\": [\n       {\n         \"data\": 'mac',\n@@ -38,17 +38,17 @@ $(document).ready(function() {\n           if (row.active) {\n             icon = '';\n           }\n-          return '<a href=\"[% search_node %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data.toUpperCase()) + icon + '</a>';\n+          return '<a href=\"[% search_node | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data.toUpperCase()) + icon + '</a>';\n         }\n       }, {\n         \"data\": 'oui.abbrev',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/report/nodevendor') %]?vendor=' + encodeURIComponent(row.oui.abbrev || 'blank') + '\">' + he.encode(row.oui.company ||'(Unknown Vendor)') + '</a>';\n+          return '<a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=' + encodeURIComponent(row.oui.abbrev || 'blank') + '\">' + he.encode(row.oui.company ||'(Unknown Vendor)') + '</a>';\n         }\n       }, {\n         \"data\": 'port',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.switch) + '&f=' + encodeURIComponent(data) + '&c_nodes=on&n_ssid=on\">' + he.encode(row.device.dns || row.device.name || row.switch) + '(' + he.encode(data) + ')</a>';\n+          return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.switch) + '&f=' + encodeURIComponent(data) + '&c_nodes=on&n_ssid=on\">' + he.encode(row.device.dns || row.device.name || row.switch) + '(' + he.encode(data) + ')</a>';\n         }\n       }, {\n         // Included for filtering\n@@ -66,12 +66,12 @@ $(document).ready(function() {\n     ],\n     [% ELSE %]\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [    \n       {\n         \"data\": 'vendor',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/report/nodevendor') %]?vendor=' + encodeURIComponent(row.abbrev || 'blank') + '\">' + he.encode(row.vendor ||'(Unknown Vendor)') + '</a>';\n+          return '<a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=' + encodeURIComponent(row.abbrev || 'blank') + '\">' + he.encode(row.vendor ||'(Unknown Vendor)') + '</a>';\n         }\n       }, {\n         \"data\": 'count',"
        },
        {
          "filename": "share/views/ajax/report/portadmindown.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -25,7 +25,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {\n@@ -42,7 +42,7 @@ $(document).ready(function() {\n         }\n       }\n     ],\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n [% INCLUDE 'ajax/datatabledefaults.tt' -%]\n   });\n });"
        },
        {
          "filename": "share/views/ajax/report/portblocking.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,7 +14,7 @@ $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n     \"order\": [[ 0, \"asc\" ], [1, \"asc\"]],\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n@@ -26,7 +26,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {"
        },
        {
          "filename": "share/views/ajax/report/portmultinodes.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,7 +14,7 @@ $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n     \"order\": [[ 3, \"desc\" ]],\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'ip',\n@@ -26,7 +26,7 @@ $(document).ready(function() {\n         \"type\": 'portsort',\n         \"render\": function(data, type, row, meta) {\n           return type === 'display' ?\n-            '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n+            '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '&c_nodes=on\">' + he.encode(data || '') + '</a>' :\n             he.encode(data || '');\n         }\n       }, {"
        },
        {
          "filename": "share/views/ajax/report/portssid.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -27,13 +27,13 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     [% IF opt %]\n     \"columns\": [\n       {\n       \"data\": 'ip',\n       \"render\": function(data, type, row, meta) {\n-        return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(data) + '&f=' + encodeURIComponent(row.port.port) + '&c_nodes=on&n_ssid=on\">' + he.encode(row.device.dns || row.device.name || row.ip) + '(' + he.encode(row.port.port) + ')</a>';\n+        return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(data) + '&f=' + encodeURIComponent(row.port.port) + '&c_nodes=on&n_ssid=on\">' + he.encode(row.device.dns || row.device.name || row.ip) + '(' + he.encode(row.port.port) + ')</a>';\n         }\n       }, {\n         \"data\": 'broadcast',\n@@ -64,7 +64,7 @@ $(document).ready(function() {\n       {\n         \"data\": 'ssid',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/report/portssid') %]?ssid=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% uri_for('/report/portssid') | none %]?ssid=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'broadcast',"
        },
        {
          "filename": "share/views/ajax/report/portutilization.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,12 +14,12 @@\n $(document).ready(function() {\n     var table = $('#data-table').dataTable({\n         \"deferRender\": true,\n-        \"data\": [% results %],\n+        \"data\": [% results | none %],\n         \"columns\": [\n            {\n                 \"data\": 'ip',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.ip) + '</a>';\n+                    return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.ip) + '</a>';\n                 }\n             }, {\n                 \"data\": 'port_count',"
        },
        {
          "filename": "share/views/ajax/report/portvlanmismatch.tt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -15,31 +15,31 @@\n $(document).ready(function() {\n     var table = $('#data-table').dataTable({\n         \"deferRender\": true,\n-        \"data\": [% results %],\n+        \"data\": [% results | none %],\n         \"columns\": [\n                {\n                 \"data\": 'left_device',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>'; }\n+                    return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>'; }\n             }, {\n               \"data\": 'left_port',\n               \"type\": 'portsort',\n               \"render\": function(data, type, row, meta) {\n                 return type === 'display' ?\n-                  '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.left_device) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n+                  '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.left_device) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n                   he.encode(data || ''); }\n             }, {\n                 \"data\": 'left_vlans'\n             }, {\n                 \"data\": 'right_device',\n                 \"render\": function(data, type, row, meta) {\n-                    return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>'; }\n+                    return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>'; }\n             }, {\n               \"data\": 'right_port',\n               \"type\": 'portsort',\n               \"render\": function(data, type, row, meta) {\n                 return type === 'display' ?\n-                  '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.right_device) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n+                  '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.right_device) + '&f=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>' :\n                   he.encode(data || ''); }\n             }, {\n                 \"data\": 'right_vlans'"
        },
        {
          "filename": "share/views/ajax/report/subnets.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n   <tbody>\n     [% FOREACH row IN results %]\n     <tr>\n-      <td class=\"nd_center-cell\"><a href=\"[% uri_for('/report/ipinventory') %]?subnet=[% row.subnet | uri %]&daterange=[% params.daterange | uri %]&age_invert=[% params.age_invert | uri %]&limit=[% row.subnet_size | uri %]\">\n+      <td class=\"nd_center-cell\"><a href=\"[% uri_for('/report/ipinventory') | none %]?subnet=[% row.subnet | uri %]&daterange=[% params.daterange | uri %]&age_invert=[% params.age_invert | uri %]&limit=[% row.subnet_size | uri %]\">\n                [% row.subnet | html_entity %]</a></td>\n       <td class=\"nd_center-cell\">[% row.subnet_size | format_number %]</td>\n       <td class=\"nd_center-cell\">[% row.active | format_number %]</td>"
        },
        {
          "filename": "share/views/ajax/report/vlaninventory.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -13,17 +13,17 @@\n $(document).ready(function() {\n   var table = $('#data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [\n       {\n         \"data\": 'vlan',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/search') %]?tab=vlan&q=' + encodeURIComponent(data) + '\">' + data + '</a>';\n+          return '<a href=\"[% uri_for('/search') | none %]?tab=vlan&q=' + encodeURIComponent(data) + '\">' + data + '</a>';\n         }\n       }, {\n         \"data\": 'description',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/search') %]?tab=vlan&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a href=\"[% uri_for('/search') | none %]?tab=vlan&q=' + encodeURIComponent(data) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'dcount',"
        },
        {
          "filename": "share/views/ajax/search/device.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -18,11 +18,11 @@\n $(document).ready(function() {\n   var table = $('#ds-data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [{\n         \"data\": 'ip',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% uri_for('/device') %]?q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.name || row.ip) + '</a>';\n+          return '<a href=\"[% uri_for('/device') | none %]?q=' + encodeURIComponent(data) + '\">' + he.encode(row.dns || row.name || row.ip) + '</a>';\n         }\n       }, {\n         \"data\": 'location',"
        },
        {
          "filename": "share/views/ajax/search/node_by_ip.tt",
          "status": "modified",
          "additions": 23,
          "deletions": 23,
          "patch": "@@ -16,16 +16,16 @@\n     [% WHILE (row = macs.next) %]\n     [% IF row.nbname %]\n     <tr>\n-      <td>MAC: <a href=\"[% search_node %]&q=[% row.net_mac.$mac_format_call | uri %]\">\n+      <td>MAC: <a href=\"[% search_node | none %]&q=[% row.net_mac.$mac_format_call | uri %]\">\n           [% row.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% row.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% row.oui.abbrev | uri %]\">\n         [% row.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>NetBIOS</td>\n-      <td class=\"nd_linkcell nd_center-cell\">\\\\<a href=\"[% uri_for('/report/netbios') %]?domain=[% row.domain | uri %]\" title=\"Devices in this Domain\">[% row.domain | html_entity %]</a>\\<a href=\"[% search_node %]&q=[% row.nbname | uri %]\">[% row.nbname | html_entity %]</a>\n-        <br>[% row.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node %]&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n+      <td class=\"nd_linkcell nd_center-cell\">\\\\<a href=\"[% uri_for('/report/netbios') | none %]?domain=[% row.domain | uri %]\" title=\"Devices in this Domain\">[% row.domain | html_entity %]</a>\\<a href=\"[% search_node | none %]&q=[% row.nbname | uri %]\">[% row.nbname | html_entity %]</a>\n+        <br>[% row.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node | none %]&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n       </td>\n       [% IF params.stamps %]\n       <td>[% row.time_first_stamp | html_entity %]</td>\n@@ -34,16 +34,16 @@\n     </tr>\n     [% ELSE %]\n     <tr>\n-      <td>MAC: <a href=\"[% search_node %]&q=[% row.net_mac.$mac_format_call | uri %]\">\n+      <td>MAC: <a href=\"[% search_node | none %]&q=[% row.net_mac.$mac_format_call | uri %]\">\n           [% row.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% row.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% row.oui.abbrev | uri %]\">\n         [% row.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>IP &rarr; MAC</td>\n       <td class=\"nd_center-cell\">\n-        <a href=\"[% search_node %]&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n+        <a href=\"[% search_node | none %]&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n         [% '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;' IF NOT row.active %]\n         [% ' (' _ row.dns.remove(settings.domain_suffix) _ ')' IF row.dns %]\n       </td>\n@@ -55,16 +55,16 @@\n     [% END %]\n     [% FOREACH nbt IN row.netbios %]\n     <tr>\n-      <td>MAC: <a href=\"[% search_node %]&q=[% nbt.net_mac.$mac_format_call | uri %]\">\n+      <td>MAC: <a href=\"[% search_node | none %]&q=[% nbt.net_mac.$mac_format_call | uri %]\">\n           [% nbt.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% nbt.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% nbt.oui.abbrev | uri %]\">\n         [% nbt.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>NetBIOS</td>\n-      <td class=\"nd_linkcell nd_center-cell\">\\\\<a href=\"[% uri_for('/report/netbios') %]?domain=[% nbt.domain | uri %]\" title=\"Devices in this Domain\">[% nbt.domain | html_entity %]</a>\\<a href=\"[% search_node %]&q=[% nbt.nbname | uri %]\">[% nbt.nbname | html_entity %]</a>\n-        <br>[% nbt.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node %]&q=[% nbt.ip | uri %]\">[% nbt.ip | html_entity %]</a>\n+      <td class=\"nd_linkcell nd_center-cell\">\\\\<a href=\"[% uri_for('/report/netbios') | none %]?domain=[% nbt.domain | uri %]\" title=\"Devices in this Domain\">[% nbt.domain | html_entity %]</a>\\<a href=\"[% search_node | none %]&q=[% nbt.nbname | uri %]\">[% nbt.nbname | html_entity %]</a>\n+        <br>[% nbt.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node | none %]&q=[% nbt.ip | uri %]\">[% nbt.ip | html_entity %]</a>\n       </td>\n       [% IF params.stamps %]\n       <td>[% date.format(nbt.time_first) | html_entity %]</td>\n@@ -74,16 +74,16 @@\n     [% END %]\n     [% FOREACH ni IN row.nodeips %]\n     <tr>\n-      <td>MAC: <a href=\"[% search_node %]&q=[% ni.net_mac.$mac_format_call | uri %]\">\n+      <td>MAC: <a href=\"[% search_node | none %]&q=[% ni.net_mac.$mac_format_call | uri %]\">\n           [% ni.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% ni.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% ni.oui.abbrev | uri %]\">\n         [% ni.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>IP &rarr; MAC</td>\n       <td class=\"nd_center-cell\">\n-        <a href=\"[% search_node %]&q=[% ni.ip | uri %]\">[% ni.ip | html_entity %]</a>\n+        <a href=\"[% search_node | none %]&q=[% ni.ip | uri %]\">[% ni.ip | html_entity %]</a>\n         [% '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;' IF NOT ni.active %]\n         [% ' (' _ ni.dns.remove(settings.domain_suffix) _ ')' IF ni.dns %]\n       </td>\n@@ -95,23 +95,23 @@\n     [% END %]\n     [% FOREACH node IN row.node_sightings(archive_filter) %]\n     <tr>\n-      <td>MAC: <a href=\"[% search_node %]&q=[% node.net_mac.$mac_format_call | uri %]\">\n+      <td>MAC: <a href=\"[% search_node | none %]&q=[% node.net_mac.$mac_format_call | uri %]\">\n           [% node.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% node.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% node.oui.abbrev | uri %]\">\n         [% node.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>Switch Port</td>\n       <td class=\"nd_center-cell\">\n         <a class=\"nd_linkcell\"\n-          href=\"[% device_ports %]&q=[% node.switch | uri %]&f=[% node.port | uri %]&c_nodes=on&c_neighbors=on&prefer=port\">\n+          href=\"[% device_ports | none %]&q=[% node.switch | uri %]&f=[% node.port | uri %]&c_nodes=on&c_neighbors=on&prefer=port\">\n           [% node.switch | html_entity %] - [% node.port | html_entity %]\n         [% '&nbsp;<i class=\"icon-book text-warning\"></i>' IF NOT node.active %]</a>\n         [% IF node.device.dns AND node.device_port AND node.device_port.name %]\n           ([% node.device.dns | html_entity %] - [% node.device_port.name | html_entity %])\n         [% END %]\n-            on vlan [% node.vlan %]\n+            on vlan [% node.vlan | html_entity %]\n       </td>\n       [% IF params.stamps %]\n       <td>[% node.time_first_stamp | html_entity %]</td>\n@@ -120,10 +120,10 @@\n     </tr>\n       [% FOREACH wlan IN node.wireless %]\n       <tr>\n-        <td>MAC: <a href=\"[% search_node %]&q=[% wlan.net_mac.$mac_format_call | uri %]\">\n+        <td>MAC: <a href=\"[% search_node | none %]&q=[% wlan.net_mac.$mac_format_call | uri %]\">\n             [% wlan.net_mac.$mac_format_call | html_entity %]</a>\n         [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% wlan.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% wlan.oui.abbrev | uri %]\">\n         [% wlan.oui.company | html_entity %]</a> )\n         [% END %]\n         </td>\n@@ -143,16 +143,16 @@\n     [% END %]\n     [% FOREACH nodeip IN row.ip_aliases(archive_filter) %]\n     <tr>\n-      <td>MAC: <a href=\"[% search_node %]&q=[% nodeip.net_mac.$mac_format_call | uri %]\">\n+      <td>MAC: <a href=\"[% search_node | none %]&q=[% nodeip.net_mac.$mac_format_call | uri %]\">\n           [% nodeip.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% nodeip.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% nodeip.oui.abbrev | uri %]\">\n         [% nodeip.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>MAC &rarr; IP</td>\n       <td class=\"nd_center-cell\">\n-        <a href=\"[% search_node %]&q=[% nodeip.ip | uri %]\">[% nodeip.ip | html_entity %]</a>\n+        <a href=\"[% search_node | none %]&q=[% nodeip.ip | uri %]\">[% nodeip.ip | html_entity %]</a>\n         [% '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;' IF NOT nodeip.active %]\n         [% ' (' _ nodeip.dns.remove(settings.domain_suffix) _ ')' IF nodeip.dns %]\n       </td>"
        },
        {
          "filename": "share/views/ajax/search/node_by_mac.tt",
          "status": "modified",
          "additions": 16,
          "deletions": 16,
          "patch": "@@ -15,15 +15,15 @@\n     [% WHILE (row = ips.next) %]\n     <tr>\n       <td>\n-          MAC: <a href=\"[% search_node %]&q=[% row.net_mac.$mac_format_call | uri %]\">\n+          MAC: <a href=\"[% search_node | none %]&q=[% row.net_mac.$mac_format_call | uri %]\">\n             [% row.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% row.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% row.oui.abbrev | uri %]\">\n         [% row.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>MAC &rarr; IP</td>\n-      <td class=\"nd_center-cell\"><a href=\"[% search_node %]&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n+      <td class=\"nd_center-cell\"><a href=\"[% search_node | none %]&q=[% row.ip | uri %]\">[% row.ip | html_entity %]</a>\n         [% '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;' IF NOT row.active %]\n         [% ' (' _ row.dns.remove(settings.domain_suffix) _ ')' IF row.dns %]\n       </td>\n@@ -36,22 +36,22 @@\n     [% WHILE (node = sightings.next) %]\n     <tr>\n       <td>\n-        MAC: <a href=\"[% search_node %]&q=[% node.net_mac.$mac_format_call | uri %]\">\n+        MAC: <a href=\"[% search_node | none %]&q=[% node.net_mac.$mac_format_call | uri %]\">\n             [% node.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% node.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% node.oui.abbrev | uri %]\">\n         [% node.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>Switch Port</td>\n       <td class=\"nd_center-cell\">\n-            <a href=\"[% device_ports %]&q=[% node.switch | uri %]&f=[% node.port | uri %]&c_nodes=on&c_neighbors=on&prefer=port\">\n+            <a href=\"[% device_ports | none %]&q=[% node.switch | uri %]&f=[% node.port | uri %]&c_nodes=on&c_neighbors=on&prefer=port\">\n             [% node.switch | html_entity %] - [% node.port | html_entity %]</a>\n         [% '&nbsp;<i class=\"icon-book text-warning\"></i>&nbsp;' IF NOT node.active %]\n         [% IF node.device.dns AND node.device_port AND node.device_port.name %]\n           ([% node.device.dns | html_entity %] - [% node.device_port.name | html_entity %])\n         [% END %]\n-            on vlan [% node.vlan %]\n+            on vlan [% node.vlan | html_entity %]\n       </td>\n       [% IF params.stamps %]\n       <td>[% node.time_first_stamp | html_entity %]</td>\n@@ -62,15 +62,15 @@\n     [% WHILE (port = ports.next) %]\n     <tr>\n       <td>\n-        MAC: <a href=\"[% search_node %]&q=[% port.net_mac.$mac_format_call | uri %]\">[% port.net_mac.$mac_format_call | html_entity %]</a>\n+        MAC: <a href=\"[% search_node | none %]&q=[% port.net_mac.$mac_format_call | uri %]\">[% port.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% port.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% port.oui.abbrev | uri %]\">\n         [% port.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>Switch Port</td>\n       <td class=\"nd_center-cell\">\n-            <a href=\"[% device_ports %]&q=[% port.ip | uri %]&f=[% port.port | uri %]&c_mac=on&c_nodes=on&c_neighbors=on\">\n+            <a href=\"[% device_ports | none %]&q=[% port.ip | uri %]&f=[% port.port | uri %]&c_mac=on&c_nodes=on&c_neighbors=on\">\n             [% port.ip | html_entity %] - [% port.descr | html_entity %]</a>\n         [% IF port.device.dns AND port.name %]\n           ([% port.device.dns | html_entity %] - [% port.name | html_entity %])\n@@ -85,15 +85,15 @@\n     [% WHILE (nbt = netbios.next) %]\n     <tr>\n       <td>\n-        MAC: <a href=\"[% search_node %]&q=[% nbt.net_mac.$mac_format_call | uri %]\">[% nbt.net_mac.$mac_format_call | html_entity %]</a>\n+        MAC: <a href=\"[% search_node | none %]&q=[% nbt.net_mac.$mac_format_call | uri %]\">[% nbt.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% nbt.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% nbt.oui.abbrev | uri %]\">\n         [% nbt.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>\n       <td>NetBIOS</td>\n-      <td class=\"nd_center-cell\">\\\\<a href=\"[% uri_for('/report/netbios') %]?domain=[% nbt.domain | uri %]\" title=\"Devices in this Domain\">[% nbt.domain | html_entity %]</a>\\<a href=\"[% search_node %]&q=[% nbt.nbname | uri %]\">[% nbt.nbname | html_entity %]</a>\n-        <br>[% nbt.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node %]&q=[% nbt.ip | uri %]\">[% nbt.ip | html_entity %]</a>\n+      <td class=\"nd_center-cell\">\\\\<a href=\"[% uri_for('/report/netbios') | none %]?domain=[% nbt.domain | uri %]\" title=\"Devices in this Domain\">[% nbt.domain | html_entity %]</a>\\<a href=\"[% search_node | none %]&q=[% nbt.nbname | uri %]\">[% nbt.nbname | html_entity %]</a>\n+        <br>[% nbt.nbuser || '[No User]' | html_entity %]@<a href=\"[% search_node | none %]&q=[% nbt.ip | uri %]\">[% nbt.ip | html_entity %]</a>\n       </td>\n       [% IF params.stamps %]\n       <td>[% nbt.time_first_stamp | html_entity %]</td>\n@@ -104,9 +104,9 @@\n     [% WHILE (wlan = wireless.next) %]\n     <tr>\n       <td>\n-        MAC: <a href=\"[% search_node %]&q=[% wlan.net_mac.$mac_format_call | uri %]\">[% wlan.net_mac.$mac_format_call | html_entity %]</a>\n+        MAC: <a href=\"[% search_node | none %]&q=[% wlan.net_mac.$mac_format_call | uri %]\">[% wlan.net_mac.$mac_format_call | html_entity %]</a>\n       [% IF params.show_vendor %]\n-        ( <a href=\"[% uri_for('/report/nodevendor') %]?vendor=[% wlan.oui.abbrev | uri %]\">\n+        ( <a href=\"[% uri_for('/report/nodevendor') | none %]?vendor=[% wlan.oui.abbrev | uri %]\">\n         [% wlan.oui.company | html_entity %]</a> )\n       [% END %]\n       </td>"
        },
        {
          "filename": "share/views/ajax/search/port.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -15,7 +15,7 @@\n $(document).ready(function() {\n   var table = $('#ps-data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columnDefs\": [\n         { \"sortable\": false, \"targets\": 0 },\n         { \"searchable\": false, \"targets\": 0 },\n@@ -49,7 +49,7 @@ $(document).ready(function() {\n           if (row.device.dns || row.device.name) {\n             ddns = '<br>(' + he.encode(row.device.dns || row.device.name)  + ')';\n           }\n-          return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(data)\n+          return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(data)\n             + '&f=' + encodeURIComponent(row.port) + '\">' + he.encode(data)\n             + ' [' + he.encode(row.port) + ']</a>' + ddns;\n         }"
        },
        {
          "filename": "share/views/ajax/search/vlan.tt",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -15,36 +15,36 @@\n $(document).ready(function() {\n   var table = $('#vs-data-table').dataTable({\n     \"deferRender\": true,\n-    \"data\": [% results %],\n+    \"data\": [% results | none %],\n     \"columns\": [{\n         \"data\": 'vlans.vlan',\n         \"render\": function(data, type, row, meta) {\n-          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + data + '</a>';\n+          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(data) + '\">' + data + '</a>';\n         }\n       }, {\n         \"data\": 'ip',\n         \"render\": function(data, type, row, meta) {\n-          return '<a href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(row.dns || row.ip) + '</a>';\n+          return '<a href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(row.dns || row.ip) + '</a>';\n         }\n       }, {\n         \"data\": 'vlans.description',\n         \"render\": function(data, type, row, meta) {\n-          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'model',\n         \"render\": function(data, type, row, meta) {\n-          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'os',\n         \"render\": function(data, type, row, meta) {\n-          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }, {\n         \"data\": 'vendor',\n         \"render\": function(data, type, row, meta) {\n-          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n+          return '<a class=\"nd_linkcell nd_stealth-link\" href=\"[% device_ports | none %]&q=' + encodeURIComponent(row.ip) + '&f=' + encodeURIComponent(row.vlans.vlan) + '\">' + he.encode(data || '') + '</a>';\n         }\n       }\n     ],"
        },
        {
          "filename": "share/views/ajax/statistics.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -29,7 +29,7 @@\n               <th>[% stats.ip_table_count | format_number %] IPs logged, of which [% stats.ip_active_count | format_number %] are active</th>\n             </tr>\n             <tr>\n-              <th>Statistics last generated on [% stats.day %]</th>\n+              <th>Statistics last generated on [% stats.day | html_entity %]</th>\n             </tr>\n           </tbody>\n         </table>"
        },
        {
          "filename": "share/views/device.tt",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -13,18 +13,18 @@\n       </a>\n       <div class=\"tab-content\">\n         [% FOREACH tab IN settings._device_tabs %]\n-        <div id=\"[% tab.tag %]_search\" class=\"tab-pane [% 'active' IF params.tab == tab.tag %]\">\n-          <form id=\"[% tab.tag %]_form\" class=\"nd_sidebar-form form-stacked\"\n-              method=\"get\" action=\"[% uri_for('/device') %]\">\n-            <input name=\"tab\" value=\"[% tab.tag %]\" type=\"hidden\"/>\n+        <div id=\"[% tab.tag | html_entity %]_search\" class=\"tab-pane [% 'active' IF params.tab == tab.tag %]\">\n+          <form id=\"[% tab.tag | html_entity %]_form\" class=\"nd_sidebar-form form-stacked\"\n+              method=\"get\" action=\"[% uri_for('/device') | none %]\">\n+            <input name=\"tab\" value=\"[% tab.tag | html_entity %]\" type=\"hidden\"/>\n             [% TRY %]\n-            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag %]\"] = 1;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag | html_entity %]\"] = 1;</script>\n             [% INCLUDE \"sidebar/device/${tab.tag}.tt\" %]\n             [% CATCH %]\n-            <!-- no \"[% tab.tag %]\" search options -->\n+            <!-- no \"[% tab.tag | html_entity %]\" search options -->\n             <input name=\"q\" value=\"[% params.q | html_entity %]\" type=\"hidden\"/>\n             <input name=\"f\" value=\"[% params.f | html_entity %]\" type=\"hidden\"/>\n-            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag %]\"] = 0;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag | html_entity %]\"] = 0;</script>\n             [% END %]\n           </form>\n         </div> <!-- /tab-pane -->\n@@ -36,7 +36,7 @@\n   <div class=\"content\">\n     <ul id=\"nd_search-results\" class=\"nav nav-tabs\">\n       [% FOREACH tab IN settings._device_tabs %]\n-      <li[% ' class=\"active\"' IF params.tab == tab.tag %]><a id=\"[% tab.tag %]_link\" href=\"#[% tab.tag %]_pane\">[% tab.label %]</a></li>\n+      <li[% ' class=\"active\"' IF params.tab == tab.tag %]><a id=\"[% tab.tag | html_entity %]_link\" href=\"#[% tab.tag | html_entity %]_pane\">[% tab.label | html_entity %]</a></li>\n       [% END %]\n       <span id=\"nd_device-name\">\n         [% display_name | html_entity %]\n@@ -47,7 +47,7 @@\n     </ul>\n     <div class=\"tab-content\">\n       [% FOREACH tab IN settings._device_tabs %]\n-      <div class=\"tab-pane[% ' active' IF params.tab == tab.tag %]\" id=\"[% tab.tag %]_pane\"></div>\n+      <div class=\"tab-pane[% ' active' IF params.tab == tab.tag %]\" id=\"[% tab.tag | html_entity %]_pane\"></div>\n       [% END %]\n   </div>\n </div>"
        },
        {
          "filename": "share/views/index.tt",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -36,13 +36,13 @@\n         <h2>Welcome to Netdisco</h2>\n         <small>Netdisco is an Open Source management tool designed for network administrators.</small>\n         [% IF NOT session.logged_in_user %]\n-        <form class=\"nd_login-form\" method=\"post\" action=\"[% uri_for('/login') %]\">\n+        <form class=\"nd_login-form\" method=\"post\" action=\"[% uri_for('/login') | none %]\">\n           <div class=\"form-horizontal\">\n             <input id='loginuser' placeholder=\"Username\" class=\"span2\" name=\"username\" type=\"text\" required=\"required\"/>\n             <input placeholder=\"Password\" class=\"span2\" name=\"password\" type=\"password\" required=\"required\"/>\n             <button type=\"submit\" class=\"btn btn-info\">Log In</button>\n             [% IF settings.login_logo %]\n-            <img src=\"[% settings.login_logo %]\" alt=\"Login Logo\" />\n+            <img src=\"[% settings.login_logo | none %]\" alt=\"Login Logo\" />\n             [% END %]\n           </div>\n           [% IF params.return_url %]\n@@ -51,7 +51,7 @@\n         </form>\n         [% ELSE %]\n           <p></p> <p></p>\n-          <form class=\"\" method=\"get\" action=\"[% uri_for('/search') %]\">\n+          <form class=\"\" method=\"get\" action=\"[% uri_for('/search') | none %]\">\n             <div class=\"form-horizontal\">\n               <input placeholder=\"Find Anything\" class=\"span4\" id=\"nqbody\" name=\"q\" type=\"text\" autocomplete=\"off\"/>\n               <input name=\"firstsearch\" type=\"hidden\" value=\"on\">\n@@ -70,9 +70,9 @@\n             </div>\n           </form>\n           [% IF user_has_role('admin') %]\n-          <form class=\"nd_login-form\" method=\"post\" action=\"[% uri_for('/admin/discover') %]\">\n+          <form class=\"nd_login-form\" method=\"post\" action=\"[% uri_for('/admin/discover') | none %]\">\n             <div class=\"form-horizontal\">\n-              <input placeholder=\"Device hostname or IP\" class=\"span4\" name=\"device\" value=\"[% params.device %]\" type=\"text\"/>\n+              <input placeholder=\"Device hostname or IP\" class=\"span4\" name=\"device\" value=\"[% params.device | html_entity %]\" type=\"text\"/>\n               <input type=\"hidden\" name=\"extra\" value=\"with-nodes\"/>\n               <button type=\"submit\" class=\"btn btn-info\">Discover</button>\n             </div>\n@@ -113,7 +113,7 @@\n     $('.nd_chevron').toggleClass('icon-chevron-up icon-chevron-down');\n \n     if (! stats_loaded) {\n-      $('#nd_stats').load(\"[% uri_for('/ajax/content/statistics') %]\", function(r,s,x) {\n+      $('#nd_stats').load(\"[% uri_for('/ajax/content/statistics') | none %]\", function(r,s,x) {\n         if (s == \"error\") {\n           $('#nd_stats_status').addClass('alert-error')\n             .html('<i class=\"icon-warning-sign\"></i> Failed to retrieve system information.');"
        },
        {
          "filename": "share/views/inventory.tt",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -18,14 +18,14 @@\n             <th>\n               [% IF platform.vendor %]\n               <a class=\"nd_linkcell\"\n-                href=\"[% search_device %]&q=[% platform.vendor | uri %]&vendor=[% platform.vendor | uri %]\">\n+                href=\"[% search_device | none %]&q=[% platform.vendor | uri %]&vendor=[% platform.vendor | uri %]\">\n                   [% platform.vendor | html_entity %]</a>\n               [% ELSE %]unknown[% END %]\n             </th>\n             <th>\n               [% IF platform.model %]\n               <a class=\"nd_linkcell\"\n-                href=\"[% search_device %]&q=[% platform.model | uri %]&model=[% platform.model | uri %]\">\n+                href=\"[% search_device | none %]&q=[% platform.model | uri %]&model=[% platform.model | uri %]\">\n                   [% platform.model | html_entity %]</a>\n               [% ELSE %]unknown[% END %]\n             </th>\n@@ -52,14 +52,14 @@\n             <th>\n               [% IF release.os %]\n               <a class=\"nd_linkcell\"\n-                href=\"[% search_device %]&q=[% release.os | uri %]&os=[% release.os | uri %]\">\n+                href=\"[% search_device | none %]&q=[% release.os | uri %]&os=[% release.os | uri %]\">\n                   [% release.os | html_entity %]</a>\n               [% ELSE %]unknown[% END %]\n             </th>\n             <th>\n               [% IF release.os_ver %]\n               <a class=\"nd_linkcell\"\n-                href=\"[% search_device %]&q=[% release.os_ver | uri %]&os_ver=[% release.os_ver | uri %]\">\n+                href=\"[% search_device | none %]&q=[% release.os_ver | uri %]&os_ver=[% release.os_ver | uri %]\">\n                   [% release.os_ver | html_entity %]</a>\n               [% ELSE %]unknown[% END %]\n             </th>"
        },
        {
          "filename": "share/views/js/admintask.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -78,7 +78,7 @@\n \n   // on load, establish global delegations for now and future\n   $(document).ready(function() {\n-    var tab = '[% task.tag %]'\n+    var tab = '[% task.tag | html_entity %]'\n     var target = '#' + tab + '_pane';\n \n     // get all devices on device input focus"
        },
        {
          "filename": "share/views/js/common.js",
          "status": "modified",
          "additions": 21,
          "deletions": 21,
          "patch": "@@ -73,11 +73,11 @@\n     // search tabs\n     [% FOREACH tab IN settings._search_tabs %]\n     $('[% \"#${tab.tag}_form\" %]').submit(function (event) {\n-      var pgtitle = update_page_title('[% tab.tag %]');\n-      copy_navbar_to_sidebar('[% tab.tag %]');\n-      update_browser_history('[% tab.tag %]', pgtitle, '');\n-      update_csv_download_link('search', '[% tab.tag %]', '[% tab.provides_csv %]');\n-      do_search(event, '[% tab.tag %]');\n+      var pgtitle = update_page_title('[% tab.tag | html_entity %]');\n+      copy_navbar_to_sidebar('[% tab.tag | html_entity %]');\n+      update_browser_history('[% tab.tag | html_entity %]', pgtitle, '');\n+      update_csv_download_link('search', '[% tab.tag | html_entity %]', '[% tab.provides_csv | html_entity %]');\n+      do_search(event, '[% tab.tag | html_entity %]');\n     });\n     [% END %]\n     [% END %]\n@@ -86,54 +86,54 @@\n     // device tabs\n     [% FOREACH tab IN settings._device_tabs %]\n     $('[% \"#${tab.tag}_form\" %]').submit(function (event) {\n-      var pgtitle = update_page_title('[% tab.tag %]');\n-      copy_navbar_to_sidebar('[% tab.tag %]');\n-      update_browser_history('[% tab.tag %]', pgtitle, '');\n-      update_csv_download_link('device', '[% tab.tag %]', '[% tab.provides_csv %]');\n+      var pgtitle = update_page_title('[% tab.tag | html_entity %]');\n+      copy_navbar_to_sidebar('[% tab.tag | html_entity %]');\n+      update_browser_history('[% tab.tag | html_entity %]', pgtitle, '');\n+      update_csv_download_link('device', '[% tab.tag | html_entity %]', '[% tab.provides_csv | html_entity %]');\n \n       [% IF tab.tag == 'ports' %]\n       // form reset icon on ports tab\n-      $('#nd_sidebar-reset-link').attr('href', uri_base + '/device?tab=[% tab.tag %]&reset=on&firstsearch=on&' +\n+      $('#nd_sidebar-reset-link').attr('href', uri_base + '/device?tab=[% tab.tag | html_entity %]&reset=on&firstsearch=on&' +\n         $('#ports_form')\n           .find('input[name=\"q\"],input[name=\"f\"],input[name=\"partial\"],input[name=\"invert\"]')\n           .serialize());\n \n       [% ELSIF tab.tag == 'netmap' %]\n       // form reset icon on netmap tab\n-      $('#nd_sidebar-reset-link').attr('href', uri_base + '/device?tab=[% tab.tag %]&reset=on&firstsearch=on&' +\n+      $('#nd_sidebar-reset-link').attr('href', uri_base + '/device?tab=[% tab.tag | html_entity %]&reset=on&firstsearch=on&' +\n         $('#netmap_form').find('input[name=\"q\"]').serialize());\n       [% END %]\n \n-      do_search(event, '[% tab.tag %]');\n+      do_search(event, '[% tab.tag | html_entity %]');\n     });\n     [% END %]\n     [% END %]\n \n     [% IF report %]\n     // for the report pages\n     $('[% \"#${report.tag}_form\" %]').submit(function (event) {\n-      var pgtitle = update_page_title('[% report.tag %]');\n-      update_browser_history('[% report.tag %]', pgtitle, '1');\n-      update_csv_download_link('report', '[% report.tag %]', '1');\n-      do_search(event, '[% report.tag %]');\n+      var pgtitle = update_page_title('[% report.tag | html_entity %]');\n+      update_browser_history('[% report.tag | html_entity %]', pgtitle, '1');\n+      update_csv_download_link('report', '[% report.tag | html_entity %]', '1');\n+      do_search(event, '[% report.tag | html_entity %]');\n     });\n     [% END -%]\n \n     [% IF task %]\n     // for the admin pages\n     $('[% \"#${task.tag}_form\" %]').submit(function (event) {\n-      update_page_title('[% task.tag %]');\n-      update_csv_download_link('admin', '[% task.tag %]', '1');\n-      do_search(event, '[% task.tag %]');\n+      update_page_title('[% task.tag | html_entity %]');\n+      update_csv_download_link('admin', '[% task.tag | html_entity %]', '1');\n+      do_search(event, '[% task.tag | html_entity %]');\n     });\n     [% END %]\n \n     // on page load, load the content for the active tab\n     [% IF params.tab %]\n     [% IF params.tab == 'ipinventory' OR params.tab == 'subnets' %]\n-      $('#[% params.tab %]_submit').click();\n+      $('#[% params.tab | html_entity %]_submit').click();\n     [% ELSE %]\n-      $('#[% params.tab %]_form').trigger(\"submit\");\n+      $('#[% params.tab | html_entity %]_form').trigger(\"submit\");\n     [% END %]\n     [% END %]\n   });"
        },
        {
          "filename": "share/views/js/device.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -27,7 +27,7 @@\n \n   // on load, establish global delegations for now and future\n   $(document).ready(function() {\n-    var tab = '[% tab.tag %]'\n+    var tab = '[% tab.tag | html_entity %]'\n     var target = '#' + tab + '_pane';\n     var portfilter = $('#ports_form').find(\"input[name=f]\");\n "
        },
        {
          "filename": "share/views/js/report.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n   // on load, check initial Report Options form state,\n   // and on each change to the form fields\n   $(document).ready(function() {\n-    var tab = '[% report.tag %]'\n+    var tab = '[% report.tag | html_entity %]'\n     var target = '#' + tab + '_pane';\n \n     // sidebar form fields should change colour and have trash icon"
        },
        {
          "filename": "share/views/js/search.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -14,7 +14,7 @@\n \n   // on load, establish global delegations for now and future\n   $(document).ready(function() {\n-    var tab = '[% tab.tag %]'\n+    var tab = '[% tab.tag | html_entity %]'\n     var target = '#' + tab + '_pane';\n \n     // sidebar form fields should change colour and have bin/copy icon"
        },
        {
          "filename": "share/views/layouts/main.tt",
          "status": "modified",
          "additions": 56,
          "deletions": 56,
          "patch": "@@ -3,82 +3,82 @@\n <html xmlns=\"http://www.w3.org/1999/xhtml\">\n <head>\n   <meta http-equiv=\"Content-type\" content=\"text/html; charset=[% settings.charset | html_entity %]\" />\n-  <link rel=\"shortcut icon\" href=\"[% uri_base %]/images/favicon.ico\" type=\"image/x-icon\">\n-  <link rel=\"icon\" href=\"[% uri_base %]/images/favicon.ico\" type=\"image/x-icon\">\n+  <link rel=\"shortcut icon\" href=\"[% uri_base | none %]/images/favicon.ico\" type=\"image/x-icon\">\n+  <link rel=\"icon\" href=\"[% uri_base | none %]/images/favicon.ico\" type=\"image/x-icon\">\n   <title>Netdisco</title>\n \n   <!-- HTML5 shim, for IE6-8 support of HTML elements -->\n   <!--[if lt IE 9]>\n     <script src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"></script>\n   <![endif]-->\n \n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery-latest.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery-latest.min.js\"></script>\n <!--  <script type=\"text/javascript\" src=\"http://code.jquery.com/jquery-migrate-1.1.1.js\"></script> -->\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery-ui.custom.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery-history.js\"></script>\n-<!--  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery.cookie.js\"></script> -->\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery-deserialize.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/bootstrap.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/bootstrap2-toggle.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/underscore.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery.qtip.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/d3-3.5.17.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/d3-force-network-chart.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/toastr.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery.floatThead.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/daterangepicker.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/moment.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/jquery.dataTables.min.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/dataTables.bootstrap.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/dataTables.ip-address-detect.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/dataTables.ip-address-sort.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/he.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/natural.js\"></script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/portsort.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery-ui.custom.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery-history.js\"></script>\n+<!--  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery.cookie.js\"></script> -->\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery-deserialize.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/bootstrap.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/bootstrap2-toggle.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/underscore.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery.qtip.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/d3-3.5.17.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/d3-force-network-chart.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/toastr.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery.floatThead.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/daterangepicker.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/moment.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/jquery.dataTables.min.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/dataTables.bootstrap.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/dataTables.ip-address-detect.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/dataTables.ip-address-sort.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/he.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/natural.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/portsort.js\"></script>\n \n   <script type=\"text/javascript\">\n-    var uri_base = '[% uri_base %]';\n-    var nd_check_userlog = '[% settings.check_userlog %]';\n+    var uri_base = '[% uri_base | none %]';\n+    var nd_check_userlog = '[% settings.check_userlog | html_entity %]';\n   </script>\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/netdisco.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/netdisco.js\"></script>\n \n   [% IF user_has_role('port_control') %]\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/javascripts/netdisco_portcontrol.js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/javascripts/netdisco_portcontrol.js\"></script>\n   [% END %]\n \n   [% FOREACH add_js IN settings._additional_javascript %]\n-  <script type=\"text/javascript\" src=\"[% uri_base %]/plugin/[% add_js %]/[% add_js %].js\"></script>\n+  <script type=\"text/javascript\" src=\"[% uri_base | none %]/plugin/[% add_js | none %]/[% add_js | none %].js\"></script>\n   [% END %]\n \n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/bootstrap.min.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/bootstrap2-toggle.min.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/awesome-bootstrap-checkbox.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/jquery.qtip.min.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/smoothness/jquery-ui.custom.min.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/font-awesome.min.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/toastr.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/d3-force-network-chart.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/netdisco.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/bootstrap-tree.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/daterangepicker-bs2.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/dataTables.bootstrap.css\"/>\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/css/nd_print.css\" media=\"print\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/bootstrap.min.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/bootstrap2-toggle.min.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/awesome-bootstrap-checkbox.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/jquery.qtip.min.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/smoothness/jquery-ui.custom.min.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/font-awesome.min.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/toastr.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/d3-force-network-chart.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/netdisco.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/bootstrap-tree.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/daterangepicker-bs2.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/dataTables.bootstrap.css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/css/nd_print.css\" media=\"print\"/>\n \n   [% FOREACH add_css IN settings._additional_css %]\n-  <link rel=\"stylesheet\" href=\"[% uri_base %]/plugin/[% add_css %]/[% add_css %].css\"/>\n+  <link rel=\"stylesheet\" href=\"[% uri_base | none %]/plugin/[% add_css | none %]/[% add_css | none %].css\"/>\n   [% END %]\n </head>\n \n <body>\n <div class=\"navbar navbar-inverse navbar-fixed-top\">\n   <div class=\"navbar-inner\">\n     <div class=\"container\">\n-      <a class=\"brand\" href=\"[% uri_for('/') %]\">Netdisco</a>\n+      <a class=\"brand\" href=\"[% uri_for('/') | none %]\">Netdisco</a>\n       [% IF session.logged_in_user %]\n       <ul class=\"nav\">\n         [% FOREACH ni IN settings._navbar_items %]\n         <li[% ' class=\"active\"' IF vars.nav == ni.tag %]>\n-          <a href=\"[% uri_for(ni.path) %]\">[% ni.label | html_entity %]</a>\n+          <a href=\"[% uri_for(ni.path) | none %]\">[% ni.label | html_entity %]</a>\n         </li>\n         [% END %]\n         [% IF settings._reports.size %]\n@@ -106,32 +106,32 @@\n           <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">Admin <b class=\"caret\"></b></a>\n           <ul class=\"dropdown-menu\">\n           <li>\n-            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/discoverall') %]\">\n+            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/discoverall') | none %]\">\n               <button type=\"submit\" class=\"btn btn-link nd_btn-link\">Discover All</button>\n             </form>\n           </li>\n           <li>\n-            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/arpwalk') %]\">\n+            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/arpwalk') | none %]\">\n               <button type=\"submit\" class=\"btn btn-link nd_btn-link\">Arpnip All</button>\n             </form>\n           </li>\n           <li>\n-            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/macwalk') %]\">\n+            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/macwalk') | none %]\">\n               <button type=\"submit\" class=\"btn btn-link nd_btn-link\">Macsuck All</button>\n             </form>\n           </li>\n           <li>\n-            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/nbtwalk') %]\">\n+            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/nbtwalk') | none %]\">\n               <button type=\"submit\" class=\"btn btn-link nd_btn-link\">NBTstat All</button>\n             </form>\n           </li>\n           <li>\n-            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/expire') %]\">\n+            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/expire') | none %]\">\n               <button type=\"submit\" class=\"btn btn-link nd_btn-link\">Run Expire Job</button>\n             </form>\n           </li>\n           <li>\n-            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/stats') %]\">\n+            <form method=\"post\" class=\"nd_inline-form\" action=\"[% uri_for('/admin/stats') | none %]\">\n               <button type=\"submit\" class=\"btn btn-link nd_btn-link\">Update Statistics</button>\n             </form>\n           </li>\n@@ -146,9 +146,9 @@\n         </li> <!-- /dropdown -->\n         [% END %]\n       </ul>\n-      <form class=\"navbar-search pull-left\" method=\"get\" action=\"[% uri_for('/search') %]\">\n+      <form class=\"navbar-search pull-left\" method=\"get\" action=\"[% uri_for('/search') | none %]\">\n         <input placeholder=\"Find Anything\" class=\"search-query span3\"\n-          id=\"nq\" name=\"q\" value=\"[% display_name %]\" type=\"text\" autocomplete=\"off\"/>\n+          id=\"nq\" name=\"q\" value=\"[% display_name | html_entity %]\" type=\"text\" autocomplete=\"off\"/>\n         <input name=\"firstsearch\" type=\"hidden\" value=\"on\">\n         <div class=\"btn-group nd_navbar-search-group\">\n           <button class=\"btn btn-inverse nd_navbar-search-icon\">\n@@ -182,10 +182,10 @@\n           </a>\n           <ul class=\"dropdown-menu\">\n           [% IF NOT ( user_has_role('ldap') OR user_has_role('radius') ) %]\n-            <li><a href=\"[% uri_for('/password') %]\">Change Password</a></li>\n+            <li><a href=\"[% uri_for('/password') | none %]\">Change Password</a></li>\n           [% END %]\n           [% IF NOT settings.no_auth %]\n-            <li><a href=\"[% uri_for('/logout') %]\">Log Out</a></li>\n+            <li><a href=\"[% uri_for('/logout') | none %]\">Log Out</a></li>\n           [% END %]\n           </ul>\n         </li> <!-- /dropdown -->\n@@ -195,7 +195,7 @@\n   </div>\n </div>\n \n-[% content %]\n+[% content | none %]\n \n <script type=\"text/javascript\">\n [%+ INCLUDE 'js/common.js' -%]"
        },
        {
          "filename": "share/views/password.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -15,7 +15,7 @@\n       [% END %]\n       <div class=\"hero-unit\">\n         <h2>Change Password</h2>\n-        <form class=\"nd_login-form\" method=\"post\" action=\"[% uri_for('/password') %]\">\n+        <form class=\"nd_login-form\" method=\"post\" action=\"[% uri_for('/password') | none %]\">\n           <div class=\"form-horizontal\">\n             <input placeholder=\"Current Password\" class=\"span2\" name=\"old\" type=\"password\" required=\"required\"/><br/>\n             <input placeholder=\"New Password\" class=\"span2\" name=\"new\" type=\"password\" required=\"required\"/>"
        },
        {
          "filename": "share/views/report.tt",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -9,14 +9,14 @@\n         rel=\"tooltip\" data-placement=\"left\" data-offset=\"5\" data-title=\"Unpin Sidebar\" data-container=\"body\"></i>\n \n       <div class=\"tab-content\">\n-        <div id=\"[% report.tag %]_search\" class=\"tab-pane active\">\n-          <form id=\"[% report.tag %]_form\" class=\"nd_sidebar-form form-stacked\"\n-              method=\"get\" action=\"[% uri_for('/report') %]\">\n+        <div id=\"[% report.tag | html_entity %]_search\" class=\"tab-pane active\">\n+          <form id=\"[% report.tag | html_entity %]_form\" class=\"nd_sidebar-form form-stacked\"\n+              method=\"get\" action=\"[% uri_for('/report') | none %]\">\n             [% TRY %]\n-            <script type=\"text/javascript\">has_sidebar[\"[% report.tag %]\"] = 1;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% report.tag | html_entity %]\"] = 1;</script>\n             [% INCLUDE \"sidebar/report/${report.tag}.tt\" %]\n             [% CATCH %]\n-            <script type=\"text/javascript\">has_sidebar[\"[% report.tag %]\"] = 0;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% report.tag | html_entity %]\"] = 0;</script>\n             [% INCLUDE \"sidebar/report/generic_report.tt\" %]\n             [% END %]\n           </form>\n@@ -27,13 +27,13 @@\n \n   <div class=\"content\">\n     <ul id=\"nd_search-results\" class=\"nav nav-tabs\">\n-      <li class=\"active\"><a id=\"[% report.tag %]_link\" class=\"nd_single-tab\"\n-        href=\"#[% report.tag %]_pane\">[% report.label %]</a></li>\n+      <li class=\"active\"><a id=\"[% report.tag | html_entity %]_link\" class=\"nd_single-tab\"\n+        href=\"#[% report.tag | html_entity %]_pane\">[% report.label | html_entity %]</a></li>\n       [% IF report.tag == 'portlog' %]\n       <span id=\"nd_device-name\">\n-        <a href=\"[% device_ports %]&q=[% params.q | uri %]\">[% params.q %]</a>\n+        <a href=\"[% device_ports | none %]&q=[% params.q | uri %]\">[% params.q | html_entity %]</a>\n         -\n-        <a href=\"[% device_ports %]&q=[% params.q | uri %]&f=[% params.f | uri %]\">[% params.f %]</a>\n+        <a href=\"[% device_ports | none %]&q=[% params.q | uri %]&f=[% params.f | uri %]\">[% params.f | html_entity %]</a>\n       </span>\n       [% ELSIF report.provides_csv %]\n       <span id=\"nd_device-name\">\n@@ -44,7 +44,7 @@\n       [% END %]\n     </ul>\n     <div class=\"tab-content\">\n-      <div class=\"tab-pane active\" id=\"[% report.tag %]_pane\"></div>\n+      <div class=\"tab-pane active\" id=\"[% report.tag | html_entity %]_pane\"></div>\n   </div>\n </div>\n "
        },
        {
          "filename": "share/views/search.tt",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -9,16 +9,16 @@\n         rel=\"tooltip\" data-placement=\"left\" data-offset=\"5\" data-title=\"Pin Sidebar\" data-container=\"body\"></i>\n       <div class=\"tab-content\">\n         [% FOREACH tab IN settings._search_tabs %]\n-        <div id=\"[% tab.tag %]_search\" class=\"tab-pane [% 'active' IF params.tab == tab.tag %]\">\n-          <form id=\"[% tab.tag %]_form\" class=\"nd_sidebar-form form-stacked\" method=\"get\" action=\"[% uri_for('/search') %]\">\n-            <input name=\"tab\" value=\"[% tab.tag %]\" type=\"hidden\"/>\n+        <div id=\"[% tab.tag | html_entity %]_search\" class=\"tab-pane [% 'active' IF params.tab == tab.tag %]\">\n+          <form id=\"[% tab.tag | html_entity %]_form\" class=\"nd_sidebar-form form-stacked\" method=\"get\" action=\"[% uri_for('/search') | none %]\">\n+            <input name=\"tab\" value=\"[% tab.tag | html_entity %]\" type=\"hidden\"/>\n             [% TRY %]\n-            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag %]\"] = 1;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag | html_entity %]\"] = 1;</script>\n             [% INCLUDE \"sidebar/search/${tab.tag}.tt\" %]\n             [% CATCH %]\n-            <!-- no \"[% tab.tag %]\" search options -->\n+            <!-- no \"[% tab.tag | html_entity %]\" search options -->\n             <input name=\"q\" value=\"[% params.q | html_entity %]\" type=\"hidden\"/>\n-            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag %]\"] = 0;</script>\n+            <script type=\"text/javascript\">has_sidebar[\"[% tab.tag | html_entity %]\"] = 0;</script>\n             [% END %]\n           </form>\n         </div> <!-- /tab-pane -->\n@@ -30,7 +30,7 @@\n   <div class=\"content\">\n     <ul id=\"nd_search-results\" class=\"nav nav-tabs\">\n       [% FOREACH tab IN settings._search_tabs %]\n-      <li[% ' class=\"active\"' IF params.tab == tab.tag %]><a id=\"[% tab.tag %]_link\" href=\"#[% tab.tag %]_pane\">[% tab.label %]</a></li>\n+      <li[% ' class=\"active\"' IF params.tab == tab.tag %]><a id=\"[% tab.tag | html_entity %]_link\" href=\"#[% tab.tag | html_entity %]_pane\">[% tab.label | html_entity %]</a></li>\n       [% END %]\n       <span id=\"nd_device-name\">\n         <a id=\"nd_csv-download\" href=\"#\" download=\"netdisco.csv\">\n@@ -40,7 +40,7 @@\n     </ul>\n     <div class=\"tab-content\">\n       [% FOREACH tab IN settings._search_tabs %]\n-      <div class=\"tab-pane[% ' active' IF params.tab == tab.tag %]\" id=\"[% tab.tag %]_pane\"></div>\n+      <div class=\"tab-pane[% ' active' IF params.tab == tab.tag %]\" id=\"[% tab.tag | html_entity %]_pane\"></div>\n       [% END %]\n   </div>\n </div>"
        },
        {
          "filename": "share/views/sidebar/device/netmap.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -82,7 +82,7 @@\n               rel=\"tooltip\" data-placement=\"left\" data-offset=\"5\" data-title=\"Host Groups\">\n               [% FOREACH opt IN hgroup_list.pairs %]\n               <option[% ' selected=\"selected\"' IF hgroup_lkp.exists(opt.key) %]\n-                value=\"[% opt.key %]\">[% opt.value | html_entity %]</option>\n+                value=\"[% opt.key | html_entity %]\">[% opt.value | html_entity %]</option>\n               [% END %]\n             </select>\n             [% END %]\n@@ -92,7 +92,7 @@\n               rel=\"tooltip\" data-placement=\"left\" data-offset=\"5\" data-title=\"Device Locations\">\n               [% FOREACH loc IN lgroup_list %]\n               <option[% ' selected=\"selected\"' IF lgroup_lkp.exists(loc) %]\n-                value=\"[% loc %]\">[% loc | html_entity %]</option>\n+                value=\"[% loc | html_entity %]\">[% loc | html_entity %]</option>\n               [% END %]\n             </select>\n             [% END %]\n@@ -132,6 +132,6 @@\n \n             </div>\n \n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n                 <i class=\"icon-pencil icon-large pull-left nd_navbar-icon\"></i>\n             Redraw Map</button>"
        },
        {
          "filename": "share/views/sidebar/device/ports.tt",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -89,7 +89,7 @@\n                     <em class=\"muted\">MAC address format:</em><br/>\n                     <select id=\"nd_mac-format\" name=\"mac_format\">\n                       [% FOREACH format IN [ 'IEEE', 'Cisco', 'Microsoft', 'Sun' ] %]\n-                      <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.device_ports.mac_format == format %]>[% format %]</option>\n+                      <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.device_ports.mac_format == format %]>[% format | html_entity %]</option>\n                       [% END %]\n                     </select>\n                   </li>\n@@ -116,12 +116,12 @@\n                     <em class=\"muted\">Mark as Free if Down for:</em><br/>\n                     <select id=\"nd_days-select\" name=\"age_num\">\n                       [% FOREACH count IN [1..31] %]\n-                      <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.device_ports.age_num == count %]>[% count %]</option>\n+                      <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.device_ports.age_num == count %]>[% count | html_entity %]</option>\n                       [% END %]\n                     </select>\n                     <select id=\"nd_age-select\" name=\"age_unit\">\n                       [% FOREACH unit IN [ 'days', 'weeks', 'months', 'years' ] %]\n-                      <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.device_ports.age_unit == unit %]>[% unit %]</option>\n+                      <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.device_ports.age_unit == unit %]>[% unit | html_entity %]</option>\n                       [% END %]\n                     </select>\n                   </li>\n@@ -140,7 +140,7 @@\n               </div>\n             </div>\n             <div class=\"btn-group\">\n-              <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info nd_sidebar-btn-drop\">\n+              <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info nd_sidebar-btn-drop\">\n                 <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Update View</button>\n               <button class=\"btn btn-info dropdown-toggle nd_sidebar-btn-drop-drop\" data-toggle=\"dropdown\">\n                 <span class=\"caret\"></span>"
        },
        {
          "filename": "share/views/sidebar/report/ipinventory.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -37,7 +37,7 @@\n                     <select id=\"nd_mac-format\" class=\"nd_side-select\" name=\"limit\">\n                       [% FOREACH size IN [ '32', '64', '128', '256', '512', '1024', '2048', '4096', '8192' ] %]\n                       <option[% ' selected=\"selected\"' IF (params.limit == size OR (NOT params.limit AND size == 2048)) %]>\n-                        [% size %]</option>\n+                        [% size | html_entity %]</option>\n                       [% END %]\n                     </select>\n                   </li>\n@@ -55,6 +55,6 @@\n               </div>\n             </fieldset>\n \n-            <button id=\"[% report.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% report.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n              <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search IPs</button>\n "
        },
        {
          "filename": "share/views/sidebar/report/moduleinventory.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -74,5 +74,5 @@\n               </label>\n             </div>\n             </fieldset>\n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n               <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Modules</button>"
        },
        {
          "filename": "share/views/sidebar/report/netbios.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -14,6 +14,6 @@\n               </select>\n             </div>\n \n-            <button id=\"[% report.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% report.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n              <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search NetBIOS</button>\n "
        },
        {
          "filename": "share/views/sidebar/report/nodesdiscovered.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -48,5 +48,5 @@\n                 <span class=\"nd_searchcheckbox uneditable-input\">Match All Options</span>\n               </label>\n             </div>\n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n               <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Nodes</button>"
        },
        {
          "filename": "share/views/sidebar/report/nodevendor.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,6 +35,6 @@\n                 </div>\n             </fieldset>\n \n-            <button id=\"[% report.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% report.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n              <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Vendors</button>\n "
        },
        {
          "filename": "share/views/sidebar/report/portmultinodes.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,6 +5,6 @@\n                 name=\"vlan\" value=\"[% params.vlan | html_entity %]\" type=\"text\"\n                 rel=\"tooltip\" data-placement=\"left\" data-offset=\"5\" data-title=\"VLAN\"/>\n             </div>\n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n                 <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Ports</button>\n "
        },
        {
          "filename": "share/views/sidebar/report/portssid.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,6 +10,6 @@\n               </select>\n             </div>\n \n-            <button id=\"[% report.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% report.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n              <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search SSID</button>\n "
        },
        {
          "filename": "share/views/sidebar/report/portutilization.tt",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -4,16 +4,16 @@\n               <em class=\"muted\">Mark as Free if Down for:</em><br/>\n               <select id=\"nd_days-select\" name=\"age_num\">\n                 [% FOREACH count IN [1..31] %]\n-                <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.report_portutilization.age_num == count %]>[% count %]</option>\n+                <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.report_portutilization.age_num == count %]>[% count | html_entity %]</option>\n                 [% END %]\n               </select>\n               <select id=\"nd_age-select\" name=\"age_unit\">\n                 [% FOREACH unit IN [ 'days', 'weeks', 'months', 'years' ] %]\n-                <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.report_portutilization.age_unit == unit %]>[% unit %]</option>\n+                <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.report_portutilization.age_unit == unit %]>[% unit | html_entity %]</option>\n                 [% END %]\n               </select>\n             </div>\n \n-            <button id=\"[% report.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% report.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n              <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Run Report</button>\n "
        },
        {
          "filename": "share/views/sidebar/report/subnets.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -28,5 +28,5 @@\n               </div>\n             </fieldset>\n \n-            <button id=\"[% report.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% report.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n              <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Subnets</button>"
        },
        {
          "filename": "share/views/sidebar/search/device.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -95,5 +95,5 @@\n                 <span class=\"nd_searchcheckbox uneditable-input\">Match All Options</span>\n               </label>\n             </div>\n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n               <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Devices</button>"
        },
        {
          "filename": "share/views/sidebar/search/node.tt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -65,10 +65,10 @@\n               <em class=\"muted\">MAC address format:</em><br/>\n               <select id=\"nd_node-mac-format\" name=\"mac_format\">\n                 [% FOREACH format IN [ 'IEEE', 'Cisco', 'Microsoft', 'Sun' ] %]\n-                <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.search_node.mac_format == format %]>[% format %]</option>\n+                <option[% ' selected=\"selected\"' IF vars.sidebar_defaults.search_node.mac_format == format %]>[% format | html_entity %]</option>\n                 [% END %]\n               </select>\n             </div>\n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n               <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Nodes</button>\n "
        },
        {
          "filename": "share/views/sidebar/search/port.tt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -28,5 +28,5 @@\n                 <span class=\"nd_searchcheckbox uneditable-input\">Ethernet Only</span>\n               </label>\n             </div>\n-            <button id=\"[% tab.tag %]_submit\" type=\"submit\" class=\"btn btn-info\">\n+            <button id=\"[% tab.tag | html_entity %]_submit\" type=\"submit\" class=\"btn btn-info\">\n               <i class=\"icon-search icon-large pull-left nd_navbar-icon\"></i> Search Ports</button>"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 13,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d3850332abd100a2993c75f35797e4e4ad1158ec",
            "date": "2025-01-14T17:59:03Z",
            "author_login": "ollyg"
          },
          {
            "sha": "dcad3d8f06e74711a23cf410e83aacbfe19d38cd",
            "date": "2025-01-02T21:57:11Z",
            "author_login": "ollyg"
          },
          {
            "sha": "5b7420f0b672842332f57103dc58c03bcf9ea695",
            "date": "2024-12-31T18:09:57Z",
            "author_login": "ollyg"
          },
          {
            "sha": "981b4da8366f7fe5262c3982a06fde218a93eb0b",
            "date": "2024-12-31T18:07:34Z",
            "author_login": "ollyg"
          },
          {
            "sha": "0c2d8e6dd8dcbdea4dcdffd9fd5057ab69b8ea47",
            "date": "2024-12-31T14:03:15Z",
            "author_login": "ollyg"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Insufficient sanitization during device search in Netdisco 2.042010 allows for reflected XSS via manipulation of a URL parameter.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-09-30T17:15:11.720",
    "last_modified": "2024-11-21T04:29:30.860",
    "fix_date": "2019-09-23T13:22:00Z"
  },
  "references": [
    {
      "url": "https://github.com/netdisco/netdisco/commit/deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netdisco/netdisco/commits/master",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netdisco/netdisco/commit/deb9b62c7f839f5e41aa4d620bcdac5f9321a8a3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netdisco/netdisco/commits/master",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.921190",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "netdisco",
    "owner": "netdisco",
    "created_at": "2017-01-04T16:07:45Z",
    "updated_at": "2025-01-08T16:46:42Z",
    "pushed_at": "2024-12-31T18:10:05Z",
    "size": 10396,
    "stars": 676,
    "forks": 78,
    "open_issues": 63,
    "watchers": 676,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Perl": 961558,
      "JavaScript": 155596,
      "CSS": 78935,
      "PLpgSQL": 33998,
      "HTML": 15516,
      "Python": 8621
    },
    "commit_activity": {
      "total_commits_last_year": 183,
      "avg_commits_per_week": 3.519230769230769,
      "days_active_last_year": 50
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T12:56:26.209576"
  }
}