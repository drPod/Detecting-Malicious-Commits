{
  "cve_id": "CVE-2019-16161",
  "github_data": {
    "repository": "k-takata/Onigmo",
    "fix_commit": "9827d5a0298ee766f6041db9c0080166ff6cdce8",
    "related_commits": [
      "9827d5a0298ee766f6041db9c0080166ff6cdce8",
      "9827d5a0298ee766f6041db9c0080166ff6cdce8"
    ],
    "patch_url": "https://github.com/k-takata/Onigmo/commit/9827d5a0298ee766f6041db9c0080166ff6cdce8.patch",
    "fix_commit_details": {
      "sha": "9827d5a0298ee766f6041db9c0080166ff6cdce8",
      "commit_date": "2019-07-29T12:43:26Z",
      "author": {
        "login": "k-takata",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #134 from k-takata/fix-segv-in-error-str",
        "length": 108,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "regparse.c",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -3910,7 +3910,11 @@ fetch_token(OnigToken* tok, UChar** src, UChar* end, ScanEnv* env)\n \n \t  if (c == 'R' || c == '0') {\n \t    PINC;   /* skip 'R' / '0' */\n-\t    if (!PPEEK_IS(')')) return ONIGERR_INVALID_GROUP_NAME;\n+\t    if (!PPEEK_IS(')')) {\n+\t      r = ONIGERR_INVALID_GROUP_NAME;\n+\t      onig_scan_env_set_error_string(env, r, p - 1, p + 1);\n+\t      return r;\n+\t    }\n \t    PINC;   /* skip ')' */\n \t    name_end = name = p;\n \t    gnum = 0;"
        },
        {
          "filename": "testpy.py",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1320,6 +1320,7 @@ def main():\n     n(\"\\\\M#\", \"\", err=onigmo.ONIGERR_META_CODE_SYNTAX)\n     n(\"\\\\C\", \"\", err=onigmo.ONIGERR_END_PATTERN_AT_CONTROL)\n     n(\"\\\\C#\", \"\", err=onigmo.ONIGERR_CONTROL_CODE_SYNTAX)\n+    n(\"(?0d\", \"\", syn=onigmo.ONIG_SYNTAX_PERL, err=onigmo.ONIGERR_INVALID_GROUP_NAME) # Issue #132\n \n     # ONIG_OPTION_FIND_LONGEST option\n     x2(\"foo|foobar\", \"foobar\", 0, 3)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1d7ee878b3e4a9e41bf9825c937ae6cf0a9cd68c",
            "date": "2024-06-15T01:29:11Z",
            "author_login": "k-takata"
          },
          {
            "sha": "a6990740f6e1d02a0ceece822186f84329c78775",
            "date": "2024-06-15T01:28:43Z",
            "author_login": "k-takata"
          },
          {
            "sha": "9b450d0a0836498ab5d5757dcd7dc027597f4d27",
            "date": "2024-06-09T16:40:22Z",
            "author_login": "spaette"
          },
          {
            "sha": "c654f8d2e15054986a98d4072dfcaefcbe45efa5",
            "date": "2024-06-09T16:35:14Z",
            "author_login": "spaette"
          },
          {
            "sha": "dd8a18af5c2f2871104b1bdbf3bbb597ec9e4665",
            "date": "2021-02-04T06:52:12Z",
            "author_login": "k-takata"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-476",
    "description": "Onigmo through 6.2.0 has a NULL pointer dereference in onig_error_code_to_str because of fetch_token in regparse.c.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-09-09T17:15:13.173",
    "last_modified": "2024-11-21T04:30:10.373",
    "fix_date": "2019-07-29T12:43:26Z"
  },
  "references": [
    {
      "url": "https://github.com/k-takata/Onigmo/commit/9827d5a0298ee766f6041db9c0080166ff6cdce8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/k-takata/Onigmo/issues/132",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/k-takata/Onigmo/commit/9827d5a0298ee766f6041db9c0080166ff6cdce8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/k-takata/Onigmo/issues/132",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:57.314128",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Onigmo",
    "owner": "k-takata",
    "created_at": "2011-06-10T13:08:12Z",
    "updated_at": "2025-01-12T05:27:45Z",
    "pushed_at": "2024-06-15T01:29:11Z",
    "size": 4182,
    "stars": 628,
    "forks": 96,
    "open_issues": 44,
    "watchers": 628,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 2332798,
      "Python": 108182,
      "Ruby": 76629,
      "Makefile": 18155,
      "Shell": 3091,
      "M4": 1908,
      "Batchfile": 67
    },
    "commit_activity": {
      "total_commits_last_year": 2,
      "avg_commits_per_week": 0.038461538461538464,
      "days_active_last_year": 1
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:16:43.084933"
  }
}