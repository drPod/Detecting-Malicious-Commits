{
  "cve_id": "CVE-2019-16986",
  "github_data": {
    "repository": "fusionpbx/fusionpbx",
    "fix_commit": "9482d9ee0e4287df21339be4276125e38e048951",
    "related_commits": [
      "9482d9ee0e4287df21339be4276125e38e048951",
      "9c61191049c949e01f99ea1fbab1feb44709e108",
      "9482d9ee0e4287df21339be4276125e38e048951",
      "9c61191049c949e01f99ea1fbab1feb44709e108"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "9482d9ee0e4287df21339be4276125e38e048951",
      "commit_date": "2019-08-10T22:50:03Z",
      "author": {
        "login": "markjcrane",
        "type": "User",
        "stats": {
          "total_commits": 13715,
          "average_weekly_commits": 20.748865355521936,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 656
        }
      },
      "commit_message": {
        "title": "Delete secure_download.php",
        "length": 26,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 91,
        "additions": 0,
        "deletions": 91
      },
      "files": [
        {
          "filename": "resources/secure_download.php",
          "status": "removed",
          "additions": 0,
          "deletions": 91,
          "patch": "@@ -1,91 +0,0 @@\n-<?php\n-/*\n-\tFusionPBX\n-\tVersion: MPL 1.1\n-\n-\tThe contents of this file are subject to the Mozilla Public License Version\n-\t1.1 (the \"License\"); you may not use this file except in compliance with\n-\tthe License. You may obtain a copy of the License at\n-\thttp://www.mozilla.org/MPL/\n-\n-\tSoftware distributed under the License is distributed on an \"AS IS\" basis,\n-\tWITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n-\tfor the specific language governing rights and limitations under the\n-\tLicense.\n-\n-\tThe Original Code is FusionPBX\n-\n-\tThe Initial Developer of the Original Code is\n-\tMark J Crane <markjcrane@fusionpbx.com>\n-\tPortions created by the Initial Developer are Copyright (C) 2008-2012\n-\tthe Initial Developer. All Rights Reserved.\n-\n-\tContributor(s):\n-\tMark J Crane <markjcrane@fusionpbx.com>\n-*/\n-include \"root.php\";\n-require_once \"resources/require.php\";\n-require_once \"resources/check_auth.php\";\n-\n-//clears if file exists cache\n-clearstatcache();\n-\n-\n-function getDownloadFilename($strfile) {\n-\t// Get download file name and path\n-\t//$basedir = \"c:\\\\products\\\\\";\n-    //$basedir = \"/home/wwwbeta/secure/files/\";\n-\t\t$basedir = \"c:/www/demo.netprofx.com/secure/files/\";\n-\t// Build and return download file name\n-\treturn $basedir . $strfile;\n-}\n-\n-function DownloadFile($filename) {\n-\t// Check filename\n-\tif (empty($filename) || !file_exists($filename)) {\n-        echo \"Error: file doesn't exist or is empty. <br>\\n $filename\";\n-\t\treturn FALSE;\n-\t}\n-\n-    $file_extension = strtolower(substr(strrchr($filename,\".\"),1));\n-     switch ($file_extension) {\n-         case \"pdf\": $ctype=\"application/pdf\"; break;\n-         case \"exe\": $ctype=\"application/octet-stream\"; break;\n-         case \"zip\": $ctype=\"application/zip\"; break;\n-         case \"doc\": $ctype=\"application/msword\"; break;\n-         case \"xls\": $ctype=\"application/vnd.ms-excel\"; break;\n-         case \"ppt\": $ctype=\"application/vnd.ms-powerpoint\"; break;\n-         case \"gif\": $ctype=\"image/gif\"; break;\n-         case \"png\": $ctype=\"image/png\"; break;\n-         case \"jpe\": case \"jpeg\":\n-         case \"jpg\": $ctype=\"image/jpg\"; break;\n-         default: $ctype=\"application/force-download\";\n-     }\n-\n-     //if (!file_exists($filename)) {\n-     //    die(\"NO FILE HERE<br>$filename\");\n-     //}\n-\n-\t// Create download file name to be displayed to user\n-\t$saveasname = basename($filename);\n-\n-    header(\"Expires: 0\");\n-    header(\"Pragma: public\");\n-    header(\"Expires: 0\");\n-    header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\");\n-    header(\"Cache-Control: private\",false);\n-    header(\"Content-Type: $ctype\");\n-    header(\"Content-Disposition: attachment; filename=\\\"\".basename($filename).\"\\\";\");\n-    header(\"Content-Transfer-Encoding: binary\");\n-    header(\"Content-Length: \".@filesize($filename));\n-\n-    set_time_limit(0);\n-    @readfile($filename) or die(\"File not found.\");\n-\n-    // Done\n-\treturn TRUE;\n-}\n-\n-\n-\n-?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "43612a5049f92e5104f0ffc1f21e46d84c0b5836",
            "date": "2025-01-26T02:32:25Z",
            "author_login": "rabbidiesel"
          },
          {
            "sha": "a87bdc997ef81aadd2dc163b8c39b2bba98d694d",
            "date": "2025-01-26T02:24:47Z",
            "author_login": "nktech1135"
          },
          {
            "sha": "da1da92d01cedfb2440c14097897e6bb333efcc8",
            "date": "2025-01-24T23:05:37Z",
            "author_login": "frytimo"
          },
          {
            "sha": "965b24579454666767653d6819a3c35a9d9e4ea4",
            "date": "2025-01-24T23:03:53Z",
            "author_login": "markjcrane"
          },
          {
            "sha": "d77b69b4d54c2388a2fc88384a01d0301299aa95",
            "date": "2025-01-24T17:15:36Z",
            "author_login": "frytimo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "In FusionPBX up to v4.5.7, the file resources\\download.php uses an unsanitized \"f\" variable coming from the URL, which takes any pathname and allows a download of it. (resources\\secure_download.php is also affected.)",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-21T16:15:18.133",
    "last_modified": "2024-11-21T04:31:29.017",
    "fix_date": "2019-08-10T22:50:03Z"
  },
  "references": [
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/9482d9ee0e4287df21339be4276125e38e048951",
      "source": "cve@mitre.org",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/9c61191049c949e01f99ea1fbab1feb44709e108",
      "source": "cve@mitre.org",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://resp3ctblog.wordpress.com/2019/10/19/fusionpbx-path-traversal-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/9482d9ee0e4287df21339be4276125e38e048951",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/9c61191049c949e01f99ea1fbab1feb44709e108",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://resp3ctblog.wordpress.com/2019/10/19/fusionpbx-path-traversal-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.968208",
    "processing_status": "enhanced"
  }
}