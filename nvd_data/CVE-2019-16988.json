{
  "cve_id": "CVE-2019-16988",
  "github_data": {
    "repository": "fusionpbx/fusionpbx",
    "fix_commit": "7fec1014ff0d08e36be6a3f7664edb3a9df7b4ac",
    "related_commits": [
      "7fec1014ff0d08e36be6a3f7664edb3a9df7b4ac",
      "7fec1014ff0d08e36be6a3f7664edb3a9df7b4ac"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7fec1014ff0d08e36be6a3f7664edb3a9df7b4ac",
      "commit_date": "2019-08-10T15:56:11Z",
      "author": {
        "login": "markjcrane",
        "type": "User",
        "stats": {
          "total_commits": 13715,
          "average_weekly_commits": 20.748865355521936,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 656
        }
      },
      "commit_message": {
        "title": "Update content.php",
        "length": 18,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 72,
        "additions": 36,
        "deletions": 36
      },
      "files": [
        {
          "filename": "app/basic_operator_panel/resources/content.php",
          "status": "modified",
          "additions": 36,
          "deletions": 36,
          "patch": "@@ -114,38 +114,38 @@\n if (permission_exists('operator_panel_eavesdrop')) {\n \techo \"\t\t\t\t<td valign='top' nowrap='nowrap'>\";\n \tif (sizeof($_SESSION['user']['extensions']) > 1) {\n-\t\techo \"\t\t\t\t<input type='hidden' id='eavesdrop_dest' value=\\\"\".(($_REQUEST['eavesdrop_dest'] == '') ? $_SESSION['user']['extension'][0]['destination'] : $_REQUEST['eavesdrop_dest']).\"\\\">\";\n+\t\techo \"\t\t\t\t<input type='hidden' id='eavesdrop_dest' value=\\\"\".(($_REQUEST['eavesdrop_dest'] == '') ? $_SESSION['user']['extension'][0]['destination'] : escape($_REQUEST['eavesdrop_dest'])).\"\\\">\";\n \t\techo \"\t\t\t\t<img src='resources/images/eavesdrop.png' style='width: 12px; height: 12px; border: none; margin: 0px 5px; cursor: help;' title='\".$text['description-eavesdrop_destination'].\"' align='absmiddle'>\";\n \t\techo \"\t\t\t\t<select class='formfld' style='margin-right: 5px;' align='absmiddle' onchange=\\\"document.getElementById('eavesdrop_dest').value = this.options[this.selectedIndex].value; refresh_start();\\\" onfocus='refresh_stop();'>\\n\";\n \t\tif (is_array($_SESSION['user']['extensions'])) foreach ($_SESSION['user']['extensions'] as $user_extension) {\n-\t\t\techo \"\t\t\t\t<option value='\".$user_extension.\"' \".(($_REQUEST['eavesdrop_dest'] == $user_extension) ? \"selected\" : null).\">\".$user_extension.\"</option>\\n\";\n+\t\t\techo \"\t\t\t\t<option value='\".escape($user_extension).\"' \".(($_REQUEST['eavesdrop_dest'] == $user_extension) ? \"selected\" : null).\">\".escape($user_extension).\"</option>\\n\";\n \t\t}\n \t\techo \"\t\t\t\t</select>\\n\";\n \t}\n \telse if (sizeof($_SESSION['user']['extensions']) == 1) {\n-\t\techo \"\t\t\t\t<input type='hidden' id='eavesdrop_dest' value=\\\"\".$_SESSION['user']['extension'][0]['destination'].\"\\\">\";\n+\t\techo \"\t\t\t\t<input type='hidden' id='eavesdrop_dest' value=\\\"\".escape($_SESSION['user']['extension'][0]['destination']).\"\\\">\";\n \t}\n \techo \"\t\t\t\t</td>\";\n }\n \n if (sizeof($groups) > 0) {\n \techo \"\t\t\t\t<td valign='top' nowrap='nowrap'>\";\n-\techo \"\t\t\t\t\t<input type='hidden' id='group' value=\\\"\".$_REQUEST['group'].\"\\\">\";\n+\techo \"\t\t\t\t\t<input type='hidden' id='group' value=\\\"\".escape($_REQUEST['group']).\"\\\">\";\n \tif (sizeof($groups) > 5) {\n \t\t//show select box\n \t\techo \"\t\t\t\t<select class='formfld' onchange=\\\"document.getElementById('group').value = this.options[this.selectedIndex].value; refresh_start();\\\" onfocus='refresh_stop();'>\\n\";\n \t\techo \"\t\t\t\t\t<option value='' \".(($_REQUEST['group'] == '') ? \"selected\" : null).\">\".$text['label-call_group'].\"</option>\";\n \t\techo \"\t\t\t\t\t<option value=''>\".$text['button-all'].\"</option>\";\n \t\tif (is_array($groups)) foreach ($groups as $group) {\n-\t\t\techo \"\t\t\t\t<option value='\".$group.\"' \".(($_REQUEST['group'] == $group) ? \"selected\" : null).\">\".$group.\"</option>\\n\";\n+\t\t\techo \"\t\t\t\t<option value='\".escape($group).\"' \".(($_REQUEST['group'] == $group) ? \"selected\" : null).\">\".escape($group).\"</option>\\n\";\n \t\t}\n \t\techo \"\t\t\t\t</select>\\n\";\n \t}\n \telse {\n \t\t//show buttons\n \t\techo \"\t\t\t\t<input type='button' class='btn' title=\\\"\".$text['label-call_group'].\"\\\" value=\\\"\".$text['button-all'].\"\\\" onclick=\\\"document.getElementById('group').value = '';\\\" \".$onhover_pause_refresh.\">\";\n \t\tif (is_array($groups)) foreach ($groups as $group) {\n-\t\t\techo \"\t\t\t<input type='button' class='btn' title=\\\"\".$text['label-call_group'].\"\\\" value=\\\"\".$group.\"\\\" \".(($_REQUEST['group'] == $group) ? \"disabled='disabled'\" : null).\" onclick=\\\"document.getElementById('group').value = this.value;\\\" \".$onhover_pause_refresh.\">\";\n+\t\t\techo \"\t\t\t<input type='button' class='btn' title=\\\"\".$text['label-call_group'].\"\\\" value=\\\"\".escape($group).\"\\\" \".(($_REQUEST['group'] == $group) ? \"disabled='disabled'\" : null).\" onclick=\\\"document.getElementById('group').value = this.value;\\\" \".$onhover_pause_refresh.\">\";\n \t\t}\n \t}\n \techo \"\t\t\t\t</td>\";\n@@ -309,35 +309,35 @@\n \t\t\t$status_hover = $text['label-status_logged_out_or_unknown'];\n \t}\n \n-\t$block .= \"<div id='\".$extension.\"' class='op_ext \".$style.\"' \".(($_GET['vd_ext_from'] == $extension || $_GET['vd_ext_to'] == $extension) ? \"style='border-style: dotted;'\" : null).\" \".(($ext_state != 'active' && $ext_state != 'ringing') ? \"ondrop='drop(event, this.id);' ondragover='allowDrop(event, this.id);' ondragleave='discardDrop(event, this.id);'\" : null).\">\"; // DRAG TO\n+\t$block .= \"<div id='\".escape($extension).\"' class='op_ext \".$style.\"' \".(($_GET['vd_ext_from'] == $extension || $_GET['vd_ext_to'] == $extension) ? \"style='border-style: dotted;'\" : null).\" \".(($ext_state != 'active' && $ext_state != 'ringing') ? \"ondrop='drop(event, this.id);' ondragover='allowDrop(event, this.id);' ondragleave='discardDrop(event, this.id);'\" : null).\">\"; // DRAG TO\n \t$block .= \"<table class='op_ext \".$style.\"'>\";\n \t$block .= \"\t<tr>\";\n \t$block .= \"\t\t<td class='op_ext_icon'>\";\n-\t$block .= \"\t\t\t<span name='\".$extension.\"'>\"; // DRAG FROM\n-\t$block .= \t\t\t\t\"<img id='\".$call_identifier.\"' class='op_ext_icon' src='resources/images/status_\".$status_icon.\".png' title='\".$status_hover.\"' \".(($draggable) ? \"draggable='true' ondragstart=\\\"drag(event, this.parentNode.getAttribute('name'));\\\" onclick=\\\"virtual_drag('\".$call_identifier.\"', '\".$extension.\"');\\\"\" : \"onfocus='this.blur();' draggable='false' style='cursor: not-allowed;'\").\">\";\n+\t$block .= \"\t\t\t<span name='\".escape($extension).\"'>\"; // DRAG FROM\n+\t$block .= \t\t\t\t\"<img id='\".escape($call_identifier).\"' class='op_ext_icon' src='resources/images/status_\".$status_icon.\".png' title='\".$status_hover.\"' \".(($draggable) ? \"draggable='true' ondragstart=\\\"drag(event, this.parentNode.getAttribute('name'));\\\" onclick=\\\"virtual_drag('\".escape($call_identifier).\"', '\".escape($extension).\"');\\\"\" : \"onfocus='this.blur();' draggable='false' style='cursor: not-allowed;'\").\">\";\n \t$block .= \t\t\t\"</span>\";\n \t$block .= \"\t\t</td>\";\n \t$block .= \"\t\t<td class='op_ext_info \".$style.\"'>\";\n \tif ($dir_icon != '') {\n \t\t$block .= \"\t\t\t<img src='resources/images/\".$dir_icon.\".png' align='right' style='margin-top: 3px; margin-right: 1px; width: 12px; height: 12px; cursor: help;' draggable='false' alt=\\\"\".$text['label-call_direction'].\"\\\" title=\\\"\".$text['label-call_direction'].\"\\\">\";\n \t}\n \t$block .= \"\t\t\t<span class='op_user_info'>\";\n-\tif ($ext['effective_caller_id_name'] != '' && $ext['effective_caller_id_name'] != $extension) {\n-\t\t$block .= \"\t\t\t<strong class='strong'>\".$ext['effective_caller_id_name'].\"</strong> (\".$extension.\")\";\n+\tif ($ext['effective_caller_id_name'] != '' && escape($ext['effective_caller_id_name']) != $extension) {\n+\t\t$block .= \"\t\t\t<strong class='strong'>\".escape($ext['effective_caller_id_name']).\"</strong> (\".escape($extension).\")\";\n \t}\n \telse {\n-\t\t$block .= \"\t\t\t<strong class='strong'>\".$extension.\"</strong>\";\n+\t\t$block .= \"\t\t\t<strong class='strong'>\".escape($extension).\"</strong>\";\n \t}\n \t$block .= \"\t\t\t</span><br>\";\n \tif ($ext_state != '') {\n \t\t$block .= \"\t\t<span class='op_caller_info'>\";\n \t\t$block .= \"\t\t\t<table align='right'><tr><td style='text-align: right;'>\";\n-\t\t$block .= \"\t\t\t\t<span class='op_call_info'>\".$ext['call_length'].\"</span><br>\";\n+\t\t$block .= \"\t\t\t\t<span class='op_call_info'>\".escape($ext['call_length']).\"</span><br>\";\n \t\t$block .= \"\t\t\t\t<span class='call_control'>\";\n \t\t//record\n \t\tif (permission_exists('operator_panel_record') && $ext_state == 'active') {\n \t\t\t$call_identifier_record = $ext['call_uuid'];\n-\t\t\t$rec_file = $_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".$call_identifier_record.\".wav\";\n+\t\t\t$rec_file = $_SESSION['switch']['recordings']['dir'].\"/archive/\".date(\"Y\").\"/\".date(\"M\").\"/\".date(\"d\").\"/\".escape($call_identifier_record).\".wav\";\n \t\t\tif (file_exists($rec_file)) {\n \t\t\t\t$block .= \t\t\"<img src='resources/images/recording.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: help;' title=\\\"\".$text['label-recording'].\"\\\" \".$onhover_pause_refresh.\">\";\n \t\t\t}\n@@ -347,7 +347,7 @@\n \t\t}\n \t\t//eavesdrop\n \t\tif (permission_exists('operator_panel_eavesdrop') && $ext_state == 'active' && sizeof($_SESSION['user']['extensions']) > 0 && !in_array($extension, $_SESSION['user']['extensions'])) {\n-\t\t\t$block .= \t\t\t\"<img src='resources/images/eavesdrop.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: pointer;' title='\".$text['label-eavesdrop'].\"' onclick=\\\"eavesdrop_call('\".$ext['destination'].\"','\".$call_identifier.\"');\\\" \".$onhover_pause_refresh.\">\";\n+\t\t\t$block .= \t\t\t\"<img src='resources/images/eavesdrop.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: pointer;' title='\".$text['label-eavesdrop'].\"' onclick=\\\"eavesdrop_call('\".escape($ext['destination']).\"','\".escape($call_identifier).\"');\\\" \".$onhover_pause_refresh.\">\";\n \t\t}\n \t\t//hangup\n \t\tif (permission_exists('operator_panel_hangup') || in_array($extension, $_SESSION['user']['extensions'])) {\n@@ -360,32 +360,32 @@\n \t\t\telse {\n \t\t\t\t$call_identifier_hangup_uuid = $call_identifier;\n \t\t\t}\n-\t\t\t$block .= \t\t\t\"<img src='resources/images/kill.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: pointer;' title='\".$text['label-hangup'].\"' onclick=\\\"hangup_call('\".$call_identifier_hangup_uuid.\"');\\\" \".$onhover_pause_refresh.\">\";\n+\t\t\t$block .= \t\t\t\"<img src='resources/images/kill.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: pointer;' title='\".$text['label-hangup'].\"' onclick=\\\"hangup_call('\".escape($call_identifier_hangup_uuid).\"');\\\" \".$onhover_pause_refresh.\">\";\n \t\t}\n \t\t$block .=\t\t\t\t\"</span>\";\n \t\t//transfer\n \t\tif (in_array($extension, $_SESSION['user']['extensions']) && $ext_state == 'active') {\n-\t\t\t$block .= \t\t\t\"<img id='destination_control_\".$extension.\"_transfer' class='destination_control' src='resources/images/keypad_transfer.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: pointer;' onclick=\\\"toggle_destination('\".$extension.\"', 'transfer');\\\" \".$onhover_pause_refresh.\">\";\n+\t\t\t$block .= \t\t\t\"<img id='destination_control_\".escape($extension).\"_transfer' class='destination_control' src='resources/images/keypad_transfer.png' style='width: 12px; height: 12px; border: none; margin: 4px 0px 0px 5px; cursor: pointer;' onclick=\\\"toggle_destination('\".escape($extension).\"', 'transfer');\\\" \".$onhover_pause_refresh.\">\";\n \t\t}\n \t\t$block .= \"\t\t\t</td></tr></table>\";\n \t\tif (permission_exists('operator_panel_call_details')) {\n-\t\t\t$block .= \"\t\t\t<span id='op_caller_details_\".$extension.\"'><strong>\".escape($call_name).\"</strong><br>\".escape($call_number).\"</span>\";\n+\t\t\t$block .= \"\t\t\t<span id='op_caller_details_\".escape($extension).\"'><strong>\".escape($call_name).\"</strong><br>\".escape($call_number).\"</span>\";\n \t\t}\n \t\t$block .= \"\t\t</span>\";\n \t\t//transfer\n \t\tif (in_array($extension, $_SESSION['user']['extensions']) && $ext_state == 'active') {\n \t\t\t$call_identifier_transfer = $ext['variable_bridge_uuid'];\n-\t\t\t$block .= \"\t\t<form id='frm_destination_\".$extension.\"_transfer' onsubmit=\\\"go_destination('\".$extension.\"', document.getElementById('destination_\".$extension.\"_transfer').value, 'transfer', '\".$call_identifier_transfer.\"'); return false;\\\">\";\n-\t\t\t$block .= \"\t\t\t<input type='text' class='formfld' id='destination_\".$extension.\"_transfer' style='width: 100px; min-width: 100px; max-width: 100px; margin-top: 3px; text-align: center; display: none;' onblur=\\\"toggle_destination('\".$extension.\"', 'transfer');\\\">\";\n+\t\t\t$block .= \"\t\t<form id='frm_destination_\".escape($extension).\"_transfer' onsubmit=\\\"go_destination('\".escape($extension).\"', document.getElementById('destination_\".escape($extension).\"_transfer').value, 'transfer', '\".escape($call_identifier_transfer).\"'); return false;\\\">\";\n+\t\t\t$block .= \"\t\t\t<input type='text' class='formfld' id='destination_\".escape($extension).\"_transfer' style='width: 100px; min-width: 100px; max-width: 100px; margin-top: 3px; text-align: center; display: none;' onblur=\\\"toggle_destination('\".escape($extension).\"', 'transfer');\\\">\";\n \t\t\t$block .= \"\t\t</form>\\n\";\n \t\t}\n \t}\n \telse {\n \t\t//call\n \t\tif (in_array($extension, $_SESSION['user']['extensions'])) {\n-\t\t\t$block .= \"\t\t<img id='destination_control_\".$extension.\"_call' class='destination_control' src='resources/images/keypad_call.png' style='width: 12px; height: 12px; border: none; margin-top: 26px; margin-right: 1px; cursor: pointer;' align='right' onclick=\\\"toggle_destination('\".$extension.\"', 'call');\\\" \".$onhover_pause_refresh.\">\";\n-\t\t\t$block .= \"\t\t<form id='frm_destination_\".$extension.\"_call' onsubmit=\\\"go_destination('\".$extension.\"', document.getElementById('destination_\".$extension.\"_call').value, 'call'); return false;\\\">\";\n-\t\t\t$block .= \"\t\t\t<input type='text' class='formfld' id='destination_\".$extension.\"_call' style='width: 100px; min-width: 100px; max-width: 100px; margin-top: 10px; text-align: center; display: none;' onblur=\\\"toggle_destination('\".$extension.\"', 'call');\\\">\";\n+\t\t\t$block .= \"\t\t<img id='destination_control_\".escape($extension).\"_call' class='destination_control' src='resources/images/keypad_call.png' style='width: 12px; height: 12px; border: none; margin-top: 26px; margin-right: 1px; cursor: pointer;' align='right' onclick=\\\"toggle_destination('\".escape($extension).\"', 'call');\\\" \".$onhover_pause_refresh.\">\";\n+\t\t\t$block .= \"\t\t<form id='frm_destination_\".escape($extension).\"_call' onsubmit=\\\"go_destination('\".escape($extension).\"', document.getElementById('destination_\".escape($extension).\"_call').value, 'call'); return false;\\\">\";\n+\t\t\t$block .= \"\t\t\t<input type='text' class='formfld' id='destination_\".escape($extension).\"_call' style='width: 100px; min-width: 100px; max-width: 100px; margin-top: 10px; text-align: center; display: none;' onblur=\\\"toggle_destination('\".escape($extension).\"', 'call');\\\">\";\n \t\t\t$block .= \"\t\t</form>\\n\";\n \t\t}\n \t}\n@@ -395,18 +395,18 @@\n \n \tif (if_group(\"superadmin\") && isset($_GET['debug'])) {\n \t\t$block .= \"<span style='font-size: 10px;'>\";\n-\t\t$block .= \"From ID<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: maroon'>\".$extension.\"</strong><br>\";\n-\t\t$block .= \"uuid<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: \".($call_identifier == $ext['uuid'] ? 'blue' : 'black').\";'>\".$ext['uuid'].\"</strong><br>\";\n-\t\t$block .= \"call_uuid<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: \".($call_identifier == $ext['call_uuid'] ? 'blue' : 'black').\";'>\".$ext['call_uuid'].\"</strong><br>\";\n-\t\t$block .= \"variable_bridge_uuid<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: \".($call_identifier == $ext['variable_bridge_uuid'] ? 'blue' : 'black').\";'>\".$ext['variable_bridge_uuid'].\"</strong><br>\";\n-\t\t$block .= \"direction<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['direction'].\"</strong><br>\";\n-\t\t$block .= \"variable_call_direction<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['variable_call_direction'].\"</strong><br>\";\n-\t\t$block .= \"state<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['state'].\"</strong><br>\";\n-\t\t$block .= \"cid_num<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['cid_num'].\"</strong><br>\";\n-\t\t$block .= \"dest<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['dest'].\"</strong><br>\";\n-\t\t$block .= \"context<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['context'].\"</strong><br>\";\n-\t\t$block .= \"presence_id<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['presence_id'].\"</strong><br>\";\n-\t\t$block .= \"callstate<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".$ext['callstate'].\"</strong><br>\";\n+\t\t$block .= \"From ID<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: maroon'>\".escape($extension).\"</strong><br>\";\n+\t\t$block .= \"uuid<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: \".($call_identifier == $ext['uuid'] ? 'blue' : 'black').\";'>\".escape($ext['uuid']).\"</strong><br>\";\n+\t\t$block .= \"call_uuid<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: \".($call_identifier == $ext['call_uuid'] ? 'blue' : 'black').\";'>\".escape($ext['call_uuid']).\"</strong><br>\";\n+\t\t$block .= \"variable_bridge_uuid<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: \".($call_identifier == $ext['variable_bridge_uuid'] ? 'blue' : 'black').\";'>\".escape($ext['variable_bridge_uuid']).\"</strong><br>\";\n+\t\t$block .= \"direction<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['direction']).\"</strong><br>\";\n+\t\t$block .= \"variable_call_direction<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['variable_call_direction']).\"</strong><br>\";\n+\t\t$block .= \"state<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['state']).\"</strong><br>\";\n+\t\t$block .= \"cid_num<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['cid_num']).\"</strong><br>\";\n+\t\t$block .= \"dest<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['dest']).\"</strong><br>\";\n+\t\t$block .= \"context<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['context']).\"</strong><br>\";\n+\t\t$block .= \"presence_id<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['presence_id']).\"</strong><br>\";\n+\t\t$block .= \"callstate<br>&nbsp;&nbsp;&nbsp;&nbsp;<strong style='color: black;'>\".escape($ext['callstate']).\"</strong><br>\";\n \t\t$block .= \"</span>\";\n \t}\n \t$block .= \"</div>\";\n@@ -430,7 +430,7 @@\n \n if ($_REQUEST['group'] != '') {\n \tif (sizeof($user_extensions) > 0) { echo \"<br>\"; }\n-\techo \"<strong style='color: black;'>\".ucwords($_REQUEST['group']).\"</strong>\";\n+\techo \"<strong style='color: black;'>\".ucwords(escape($_REQUEST['group'])).\"</strong>\";\n \techo \"<br><br>\";\n }\n else if (sizeof($user_extensions) > 0) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "43612a5049f92e5104f0ffc1f21e46d84c0b5836",
            "date": "2025-01-26T02:32:25Z",
            "author_login": "rabbidiesel"
          },
          {
            "sha": "a87bdc997ef81aadd2dc163b8c39b2bba98d694d",
            "date": "2025-01-26T02:24:47Z",
            "author_login": "nktech1135"
          },
          {
            "sha": "da1da92d01cedfb2440c14097897e6bb333efcc8",
            "date": "2025-01-24T23:05:37Z",
            "author_login": "frytimo"
          },
          {
            "sha": "965b24579454666767653d6819a3c35a9d9e4ea4",
            "date": "2025-01-24T23:03:53Z",
            "author_login": "markjcrane"
          },
          {
            "sha": "d77b69b4d54c2388a2fc88384a01d0301299aa95",
            "date": "2025-01-24T17:15:36Z",
            "author_login": "frytimo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "In FusionPBX up to v4.5.7, the file app\\basic_operator_panel\\resources\\content.php uses an unsanitized \"eavesdrop_dest\" variable coming from the URL, which is reflected on 3 occasions in HTML, leading to XSS.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-21T16:15:18.273",
    "last_modified": "2024-11-21T04:31:29.300",
    "fix_date": "2019-08-10T15:56:11Z"
  },
  "references": [
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/7fec1014ff0d08e36be6a3f7664edb3a9df7b4ac",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://resp3ctblog.wordpress.com/2019/10/19/fusionpbx-xss-18/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fusionpbx/fusionpbx/commit/7fec1014ff0d08e36be6a3f7664edb3a9df7b4ac",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://resp3ctblog.wordpress.com/2019/10/19/fusionpbx-xss-18/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.968482",
    "processing_status": "enhanced"
  }
}