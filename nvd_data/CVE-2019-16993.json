{
  "cve_id": "CVE-2019-16993",
  "github_data": {
    "repository": "phpbb/phpbb",
    "fix_commit": "18abef716ecf42a35416444f3f84f5459d573789",
    "related_commits": [
      "18abef716ecf42a35416444f3f84f5459d573789",
      "18abef716ecf42a35416444f3f84f5459d573789"
    ],
    "patch_url": "https://github.com/phpbb/phpbb/commit/18abef716ecf42a35416444f3f84f5459d573789.patch",
    "fix_commit_details": {
      "sha": "18abef716ecf42a35416444f3f84f5459d573789",
      "commit_date": "2015-12-23T16:31:43Z",
      "author": {
        "login": "marc1706",
        "type": "User",
        "stats": {
          "total_commits": 7238,
          "average_weekly_commits": 6.332458442694663,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 549
        }
      },
      "commit_message": {
        "title": "[ticket/security-188] Check form key in acp_bbcodes",
        "length": 65,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
      },
      "files": [
        {
          "filename": "phpBB/includes/acp/acp_bbcodes.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -33,13 +33,19 @@ function main($id, $mode)\n \t\t// Set up general vars\n \t\t$action\t= request_var('action', '');\n \t\t$bbcode_id = request_var('bbcode', 0);\n+\t\t$submit = $request->is_set_post('submit');\n \n \t\t$this->tpl_name = 'acp_bbcodes';\n \t\t$this->page_title = 'ACP_BBCODES';\n \t\t$form_key = 'acp_bbcodes';\n \n \t\tadd_form_key($form_key);\n \n+\t\tif ($submit && !check_form_key($form_key))\n+\t\t{\n+\t\t\ttrigger_error($user->lang['FORM_INVALID'] . adm_back_link($this->u_action), E_USER_WARNING);\n+\t\t}\n+\n \t\t// Set up mode-specific vars\n \t\tswitch ($action)\n \t\t{"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a9efd4a2340b601b0c7d5addcfa1ab1704cc9ffa",
            "date": "2025-01-14T20:08:27Z",
            "author_login": "marc1706"
          },
          {
            "sha": "353ea362f08e17f0065b206a566e248657dcc6e9",
            "date": "2025-01-09T14:27:54Z",
            "author_login": "rxu"
          },
          {
            "sha": "485d72f0e8c422a3dbeb444fff2d7fa0e7ab359c",
            "date": "2025-01-08T18:35:19Z",
            "author_login": "marc1706"
          },
          {
            "sha": "a2f99248cb5550ac7641676457a8450c8d499d1a",
            "date": "2025-01-08T03:27:55Z",
            "author_login": "rxu"
          },
          {
            "sha": "3e0270d0cff96a9696211570528f521789913f00",
            "date": "2025-01-07T04:54:11Z",
            "author_login": "rxu"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-352",
    "description": "In phpBB before 3.1.7-PL1, includes/acp/acp_bbcodes.php has improper verification of a CSRF token on the BBCode page in the Administration Control Panel. An actual CSRF attack is possible if an attacker also manages to retrieve the session id of a reauthenticated administrator prior to targeting them.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-09-30T12:15:10.860",
    "last_modified": "2024-11-21T04:31:30.007",
    "fix_date": "2015-12-23T16:31:43Z"
  },
  "references": [
    {
      "url": "https://github.com/phpbb/phpbb/commit/18abef716ecf42a35416444f3f84f5459d573789",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/09/msg00036.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00006.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.phpbb.com/community/viewtopic.php?t=2352606",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.phpbb.com/support/documents.php?mode=changelog&version=3#v317",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/phpbb/phpbb/commit/18abef716ecf42a35416444f3f84f5459d573789",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/09/msg00036.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00006.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.phpbb.com/community/viewtopic.php?t=2352606",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.phpbb.com/support/documents.php?mode=changelog&version=3#v317",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.919021",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "phpbb",
    "owner": "phpbb",
    "created_at": "2010-03-01T22:33:17Z",
    "updated_at": "2025-01-12T21:30:29Z",
    "pushed_at": "2025-01-08T18:35:20Z",
    "size": 92800,
    "stars": 1881,
    "forks": 955,
    "open_issues": 44,
    "watchers": 1881,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "2.0.x",
      "3.0.x",
      "3.1.x",
      "3.2.x",
      "3.3.x",
      "feature/gsoc-pm",
      "master"
    ],
    "languages": {
      "PHP": 11243177,
      "HTML": 961660,
      "JavaScript": 306732,
      "CSS": 180149,
      "Shell": 19442,
      "Twig": 7978,
      "PLpgSQL": 2152,
      "Python": 1619,
      "TSQL": 1462,
      "Dockerfile": 570
    },
    "commit_activity": {
      "total_commits_last_year": 777,
      "avg_commits_per_week": 14.942307692307692,
      "days_active_last_year": 206
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T15:31:05.733009"
  }
}