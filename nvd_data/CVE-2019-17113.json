{
  "cve_id": "CVE-2019-17113",
  "github_data": {
    "repository": "OpenMPT/openmpt",
    "fix_commit": "927688ddab43c2b203569de79407a899e734fabe",
    "related_commits": [
      "927688ddab43c2b203569de79407a899e734fabe",
      "927688ddab43c2b203569de79407a899e734fabe"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "927688ddab43c2b203569de79407a899e734fabe",
      "commit_date": "2019-10-02T13:37:46Z",
      "author": {
        "login": "manxorist",
        "type": "User",
        "stats": {
          "total_commits": 9091,
          "average_weekly_commits": 11.182041820418204,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 555
        }
      },
      "commit_message": {
        "title": "[Fix] libmodplug: C API: Limit the length of strings copied to the output buffer of ModPlug_InstrumentName() and ModPlug_SampleName() to 32 bytes (including terminating null) as is done by original libmodplug. This avoids potential buffer overflows in software relying on this limit instead of querying the required buffer size beforehand. libopenmpt can return strings longer than 32 bytes here beacuse the internal limit of 32 bytes applies to strings encoded in arbitrary character encodings but the API returns them converted to UTF-8, which can be longer. (reported by Antonio Morales Maldonado of Semmle Security Research Team)",
        "length": 742,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 14,
        "deletions": 32
      },
      "files": [
        {
          "filename": "libopenmpt/libopenmpt_modplug.c",
          "status": "modified",
          "additions": 14,
          "deletions": 32,
          "patch": "@@ -478,53 +478,35 @@ LIBOPENMPT_MODPLUG_API unsigned int ModPlug_NumChannels(ModPlugFile* file)\n LIBOPENMPT_MODPLUG_API unsigned int ModPlug_SampleName(ModPlugFile* file, unsigned int qual, char* buff)\n {\n \tconst char* str;\n-\tunsigned int retval;\n-\tsize_t tmpretval;\n+\tchar buf[32];\n \tif(!file) return 0;\n \tstr = openmpt_module_get_sample_name(file->mod,qual-1);\n-\tif(!str){\n-\t\tif(buff){\n-\t\t\t*buff = '\\0';\n-\t\t}\n-\t\treturn 0;\n-\t}\n-\ttmpretval = strlen(str);\n-\tif(tmpretval>=INT_MAX){\n-\t\ttmpretval = INT_MAX-1;\n+\tmemset(buf,0,32);\n+\tif(str){\n+\t\tstrncpy(buf,str,31);\n+\t\topenmpt_free_string(str);\n \t}\n-\tretval = (int)tmpretval;\n \tif(buff){\n-\t\tmemcpy(buff,str,retval+1);\n-\t\tbuff[retval] = '\\0';\n+\t\tstrncpy(buff,buf,32);\n \t}\n-\topenmpt_free_string(str);\n-\treturn retval;\n+\treturn (unsigned int)strlen(buf);\n }\n \n LIBOPENMPT_MODPLUG_API unsigned int ModPlug_InstrumentName(ModPlugFile* file, unsigned int qual, char* buff)\n {\n \tconst char* str;\n-\tunsigned int retval;\n-\tsize_t tmpretval;\n+\tchar buf[32];\n \tif(!file) return 0;\n \tstr = openmpt_module_get_instrument_name(file->mod,qual-1);\n-\tif(!str){\n-\t\tif(buff){\n-\t\t\t*buff = '\\0';\n-\t\t}\n-\t\treturn 0;\n-\t}\n-\ttmpretval = strlen(str);\n-\tif(tmpretval>=INT_MAX){\n-\t\ttmpretval = INT_MAX-1;\n+\tmemset(buf,0,32);\n+\tif(str){\n+\t\tstrncpy(buf,str,31);\n+\t\topenmpt_free_string(str);\n \t}\n-\tretval = (int)tmpretval;\n \tif(buff){\n-\t\tmemcpy(buff,str,retval+1);\n-\t\tbuff[retval] = '\\0';\n+\t\tstrncpy(buff,buf,32);\n \t}\n-\topenmpt_free_string(str);\n-\treturn retval;\n+\treturn (unsigned int)strlen(buf);\n }\n \n LIBOPENMPT_MODPLUG_API ModPlugNote* ModPlug_GetPattern(ModPlugFile* file, int pattern, unsigned int* numrows)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "04e5d16590b186502c0df27fd7bc5d73a69325b3",
            "date": "2025-01-19T22:08:35Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "573f1761b323012688aeeb960f242ae7da520009",
            "date": "2025-01-19T19:31:50Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "cbd92b882e5099fb449fdd1307e6ad7754f52e3e",
            "date": "2025-01-15T17:24:06Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "016390240a8e3be6b5363c50ed17ace671f78c19",
            "date": "2025-01-15T17:23:23Z",
            "author_login": "sagamusix"
          },
          {
            "sha": "9c80f9c36a66bd792b4f553d4937d951af500016",
            "date": "2025-01-09T20:11:38Z",
            "author_login": "sagamusix"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-120",
    "description": "In libopenmpt before 0.3.19 and 0.4.x before 0.4.9, ModPlug_InstrumentName and ModPlug_SampleName in libopenmpt_modplug.c do not restrict the lengths of libmodplug output-buffer strings in the C API, leading to a buffer overflow.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-04T00:15:10.747",
    "last_modified": "2024-11-21T04:31:43.057",
    "fix_date": "2019-10-02T13:37:46Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00035.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00044.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/commit/927688ddab43c2b203569de79407a899e734fabe",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/compare/libopenmpt-0.3.18...libopenmpt-0.3.19",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/compare/libopenmpt-0.4.8...libopenmpt-0.4.9",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00003.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://source.openmpt.org/browse/openmpt/trunk/OpenMPT/?op=revision&rev=12127&peg=12127",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4729",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00035.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-10/msg00044.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/commit/927688ddab43c2b203569de79407a899e734fabe",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/compare/libopenmpt-0.3.18...libopenmpt-0.3.19",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMPT/openmpt/compare/libopenmpt-0.4.8...libopenmpt-0.4.9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://source.openmpt.org/browse/openmpt/trunk/OpenMPT/?op=revision&rev=12127&peg=12127",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4729",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.933069",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "openmpt",
    "owner": "OpenMPT",
    "created_at": "2017-02-23T10:04:01Z",
    "updated_at": "2025-01-20T21:26:12Z",
    "pushed_at": "2025-01-19T22:22:23Z",
    "size": 194524,
    "stars": 604,
    "forks": 71,
    "open_issues": 0,
    "watchers": 604,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 9763824,
      "C": 474904,
      "Makefile": 259454,
      "Lua": 142963,
      "FreeBASIC": 127523,
      "Batchfile": 110462,
      "Inno Setup": 82266,
      "M4": 76794,
      "Shell": 67062,
      "Python": 57959,
      "HTML": 8725,
      "VBScript": 861,
      "PowerShell": 801,
      "CSS": 505
    },
    "commit_activity": {
      "total_commits_last_year": 1451,
      "avg_commits_per_week": 27.903846153846153,
      "days_active_last_year": 266
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T07:50:24.613623"
  }
}