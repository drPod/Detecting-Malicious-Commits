{
  "cve_id": "CVE-2019-17367",
  "github_data": {
    "repository": "openwrt/luci",
    "fix_commit": "f8c6eb67cd9da09ee20248fec6ab742069635e47",
    "related_commits": [
      "f8c6eb67cd9da09ee20248fec6ab742069635e47",
      "f8c6eb67cd9da09ee20248fec6ab742069635e47"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f8c6eb67cd9da09ee20248fec6ab742069635e47",
      "commit_date": "2019-10-09T07:55:44Z",
      "author": {
        "login": "jow-",
        "type": "User",
        "stats": {
          "total_commits": 5956,
          "average_weekly_commits": 6.745186862967158,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 602
        }
      },
      "commit_message": {
        "title": "luci-base: fix CSRF prevention for arcombine targets",
        "length": 285,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "modules/luci-base/luasrc/dispatcher.lua",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -149,7 +149,11 @@ function httpdispatch(request, prefix)\n \t--context._disable_memtrace()\n end\n \n-local function require_post_security(target)\n+local function require_post_security(target, args)\n+\tif type(target) == \"table\" and target.type == \"arcombine\" and type(target.targets) == \"table\" then\n+\t\treturn require_post_security((type(args) == \"table\" and #args > 0) and target.targets[2] or target.targets[1], args)\n+\tend\n+\n \tif type(target) == \"table\" then\n \t\tif type(target.post) == \"table\" then\n \t\t\tlocal param_name, required_val, request_val\n@@ -470,7 +474,7 @@ function dispatch(request)\n \t\treturn\n \tend\n \n-\tif c and require_post_security(c.target) then\n+\tif c and require_post_security(c.target, args) then\n \t\tif not test_post_security(c) then\n \t\t\treturn\n \t\tend"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "97a7f5c3144ae2acd3f55aae6798176c5a2df37e",
            "date": "2025-01-26T04:33:46Z",
            "author_login": "weblate"
          },
          {
            "sha": "a86c3ad6f1ba43a247c4958c96a173a31b5f3136",
            "date": "2025-01-25T15:54:27Z",
            "author_login": "hnyman"
          },
          {
            "sha": "ea4e57877bd33b7f59fa0687f805b14c2dec464e",
            "date": "2025-01-25T15:48:47Z",
            "author_login": "hnyman"
          },
          {
            "sha": "be25137852759ada6943e0c2197c5f5faef0c026",
            "date": "2025-01-25T04:21:17Z",
            "author_login": "weblate"
          },
          {
            "sha": "2c7b18b0f6fc04eb4005a7b8cc9d5051b27b7100",
            "date": "2025-01-23T23:15:23Z",
            "author_login": "efahl"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-352",
    "description": "OpenWRT firmware version 18.06.4 is vulnerable to CSRF via wireless/radio0.network1, wireless/radio1.network1, firewall, firewall/zones, firewall/forwards, firewall/rules, network/wan, network/wan6, or network/lan under /cgi-bin/luci/admin/network/.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-18T17:15:10.343",
    "last_modified": "2024-11-21T04:32:11.700",
    "fix_date": "2019-10-09T07:55:44Z"
  },
  "references": [
    {
      "url": "https://github.com/openwrt/luci/commit/f8c6eb67cd9da09ee20248fec6ab742069635e47",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openwrt/luci/commit/f8c6eb67cd9da09ee20248fec6ab742069635e47",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.965446",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "luci",
    "owner": "openwrt",
    "created_at": "2014-10-09T16:02:20Z",
    "updated_at": "2025-01-26T05:55:14Z",
    "pushed_at": "2025-01-26T05:55:07Z",
    "size": 452461,
    "stars": 6575,
    "forks": 2593,
    "open_issues": 277,
    "watchers": 6575,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "for-15.05",
      "lede-17.01",
      "luci-0.8",
      "luci-0.9",
      "luci-0.10",
      "luci-0.11",
      "luci-0.12",
      "master",
      "openwrt-18.06",
      "openwrt-19.07",
      "openwrt-21.02",
      "openwrt-22.03",
      "openwrt-23.05",
      "openwrt-24.10"
    ],
    "languages": {
      "JavaScript": 3082172,
      "C": 1710331,
      "Lua": 809153,
      "HTML": 392684,
      "CSS": 210422,
      "Makefile": 153694,
      "Shell": 105267,
      "UnrealScript": 81556,
      "Perl": 58132,
      "Java": 49574,
      "C#": 42820,
      "Visual Basic .NET": 33030,
      "Yacc": 17409,
      "Lex": 7173,
      "CMake": 1240,
      "Python": 1165
    },
    "commit_activity": {
      "total_commits_last_year": 1473,
      "avg_commits_per_week": 28.326923076923077,
      "days_active_last_year": 268
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:54:12.104870"
  }
}