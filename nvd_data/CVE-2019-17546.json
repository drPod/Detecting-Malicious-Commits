{
  "cve_id": "CVE-2019-17546",
  "github_data": {
    "repository": "OSGeo/gdal",
    "fix_commit": "21674033ee246f698887604c7af7ba1962a40ddf",
    "related_commits": [
      "21674033ee246f698887604c7af7ba1962a40ddf",
      "21674033ee246f698887604c7af7ba1962a40ddf"
    ],
    "patch_url": "https://github.com/OSGeo/gdal/commit/21674033ee246f698887604c7af7ba1962a40ddf.patch",
    "fix_commit_details": {
      "sha": "21674033ee246f698887604c7af7ba1962a40ddf",
      "commit_date": "2019-08-15T13:04:58Z",
      "author": {
        "login": "rouault",
        "type": "User",
        "stats": {
          "total_commits": 33213,
          "average_weekly_commits": 24.2253829321663,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 892
        }
      },
      "commit_message": {
        "title": "Internal libtiff: fix integer overflow potentially causing write heap buffer overflow, especially on 32 bit builds. Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16443. Credit to OSS Fuzz",
        "length": 201,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 26,
        "additions": 20,
        "deletions": 6
      },
      "files": [
        {
          "filename": "gdal/frmts/gtiff/libtiff/tif_getimage.c",
          "status": "modified",
          "additions": 20,
          "deletions": 6,
          "patch": "@@ -949,16 +949,23 @@ gtStripContig(TIFFRGBAImage* img, uint32* raster, uint32 w, uint32 h)\n \tfromskew = (w < imagewidth ? imagewidth - w : 0);\n \tfor (row = 0; row < h; row += nrow)\n \t{\n+\t\tuint32 temp;\n \t\trowstoread = rowsperstrip - (row + img->row_offset) % rowsperstrip;\n \t\tnrow = (row + rowstoread > h ? h - row : rowstoread);\n \t\tnrowsub = nrow;\n \t\tif ((nrowsub%subsamplingver)!=0)\n \t\t\tnrowsub+=subsamplingver-nrowsub%subsamplingver;\n+\t\ttemp = (row + img->row_offset)%rowsperstrip + nrowsub;\n+\t\tif( scanline > 0 && temp > (size_t)(TIFF_TMSIZE_T_MAX / scanline) )\n+\t\t{\n+\t\t\tTIFFErrorExt(tif->tif_clientdata, TIFFFileName(tif), \"Integer overflow in gtStripContig\");\n+\t\t\treturn 0;\n+\t\t}\n \t\tif (_TIFFReadEncodedStripAndAllocBuffer(tif,\n \t\t    TIFFComputeStrip(tif,row+img->row_offset, 0),\n \t\t    (void**)(&buf),\n                     maxstripsize,\n-\t\t    ((row + img->row_offset)%rowsperstrip + nrowsub) * scanline)==(tmsize_t)(-1)\n+\t\t    temp * scanline)==(tmsize_t)(-1)\n \t\t    && (buf == NULL || img->stoponerr))\n \t\t{\n \t\t\tret = 0;\n@@ -1051,15 +1058,22 @@ gtStripSeparate(TIFFRGBAImage* img, uint32* raster, uint32 w, uint32 h)\n \tfromskew = (w < imagewidth ? imagewidth - w : 0);\n \tfor (row = 0; row < h; row += nrow)\n \t{\n+                uint32 temp;\n \t\trowstoread = rowsperstrip - (row + img->row_offset) % rowsperstrip;\n \t\tnrow = (row + rowstoread > h ? h - row : rowstoread);\n \t\toffset_row = row + img->row_offset;\n+                temp = (row + img->row_offset)%rowsperstrip + nrow;\n+                if( scanline > 0 && temp > (size_t)(TIFF_TMSIZE_T_MAX / scanline) )\n+                {\n+                        TIFFErrorExt(tif->tif_clientdata, TIFFFileName(tif), \"Integer overflow in gtStripSeparate\");\n+                        return 0;\n+                }\n                 if( buf == NULL )\n                 {\n                     if (_TIFFReadEncodedStripAndAllocBuffer(\n                             tif, TIFFComputeStrip(tif, offset_row, 0),\n                             (void**) &buf, bufsize,\n-                            ((row + img->row_offset)%rowsperstrip + nrow) * scanline)==(tmsize_t)(-1)\n+                            temp * scanline)==(tmsize_t)(-1)\n                         && (buf == NULL || img->stoponerr))\n                     {\n                             ret = 0;\n@@ -1079,23 +1093,23 @@ gtStripSeparate(TIFFRGBAImage* img, uint32* raster, uint32 w, uint32 h)\n                     }\n                 }\n \t\telse if (TIFFReadEncodedStrip(tif, TIFFComputeStrip(tif, offset_row, 0),\n-\t\t    p0, ((row + img->row_offset)%rowsperstrip + nrow) * scanline)==(tmsize_t)(-1)\n+\t\t    p0, temp * scanline)==(tmsize_t)(-1)\n \t\t    && img->stoponerr)\n \t\t{\n \t\t\tret = 0;\n \t\t\tbreak;\n \t\t}\n \t\tif (colorchannels > 1 \n                     && TIFFReadEncodedStrip(tif, TIFFComputeStrip(tif, offset_row, 1),\n-                                            p1, ((row + img->row_offset)%rowsperstrip + nrow) * scanline) == (tmsize_t)(-1)\n+                                            p1, temp * scanline) == (tmsize_t)(-1)\n \t\t    && img->stoponerr)\n \t\t{\n \t\t\tret = 0;\n \t\t\tbreak;\n \t\t}\n \t\tif (colorchannels > 1 \n                     && TIFFReadEncodedStrip(tif, TIFFComputeStrip(tif, offset_row, 2),\n-                                            p2, ((row + img->row_offset)%rowsperstrip + nrow) * scanline) == (tmsize_t)(-1)\n+                                            p2, temp * scanline) == (tmsize_t)(-1)\n \t\t    && img->stoponerr)\n \t\t{\n \t\t\tret = 0;\n@@ -1104,7 +1118,7 @@ gtStripSeparate(TIFFRGBAImage* img, uint32* raster, uint32 w, uint32 h)\n \t\tif (alpha)\n \t\t{\n \t\t\tif (TIFFReadEncodedStrip(tif, TIFFComputeStrip(tif, offset_row, colorchannels),\n-\t\t\t    pa, ((row + img->row_offset)%rowsperstrip + nrow) * scanline)==(tmsize_t)(-1)\n+\t\t\t    pa, temp * scanline)==(tmsize_t)(-1)\n \t\t\t    && img->stoponerr)\n \t\t\t{\n \t\t\t\tret = 0;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a12a5f6cca255159db509fb351d6e1fa6a7a3c4e",
            "date": "2025-01-14T17:00:38Z",
            "author_login": "dbaston"
          },
          {
            "sha": "07a271a2d5b3ba8bc70e3acf82e4e57414548b6b",
            "date": "2025-01-14T16:50:07Z",
            "author_login": "rouault"
          },
          {
            "sha": "f3ecbf9c96ff23fe849d41ab74d799249bad7427",
            "date": "2025-01-14T15:59:00Z",
            "author_login": "rouault"
          },
          {
            "sha": "0a7c14b0a0e8d0de892dafb801a9b768be12b45b",
            "date": "2025-01-14T15:56:59Z",
            "author_login": "rouault"
          },
          {
            "sha": "d10604ff998f2ddd9c4000f678a50a55016a30c5",
            "date": "2025-01-14T15:25:43Z",
            "author_login": "rouault"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-190",
    "description": "tif_getimage.c in LibTIFF through 4.0.10, as used in GDAL through 3.0.1 and other products, has an integer overflow that potentially causes a heap-based buffer overflow via a crafted RGBA image, related to a \"Negative-size-param\" condition.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-14T02:15:11.107",
    "last_modified": "2024-12-20T13:15:16.870",
    "fix_date": "2019-08-15T13:04:58Z"
  },
  "references": [
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16443",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OSGeo/gdal/commit/21674033ee246f698887604c7af7ba1962a40ddf",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitlab.com/libtiff/libtiff/commit/4bb584a35f87af42d6cf09d15e9ce8909a839145",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/11/msg00027.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/03/msg00020.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LM5ZW7E3IEW7LT2BPJP7D3RN6OUOE3MX/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/M3S4WNIMZ7XSLY2LD5FPRPZMGNUBVKOG/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2020/Jan/32",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-25",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4608",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4670",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16443",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OSGeo/gdal/commit/21674033ee246f698887604c7af7ba1962a40ddf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitlab.com/libtiff/libtiff/commit/4bb584a35f87af42d6cf09d15e9ce8909a839145",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/11/msg00027.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/03/msg00020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LM5ZW7E3IEW7LT2BPJP7D3RN6OUOE3MX/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/M3S4WNIMZ7XSLY2LD5FPRPZMGNUBVKOG/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2020/Jan/32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-25",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20241220-0007/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4608",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4670",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.957174",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gdal",
    "owner": "OSGeo",
    "created_at": "2012-10-09T21:39:58Z",
    "updated_at": "2025-01-14T15:59:04Z",
    "pushed_at": "2025-01-14T16:07:40Z",
    "size": 400815,
    "stars": 5027,
    "forks": 2600,
    "open_issues": 518,
    "watchers": 5027,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/1.4",
      "release/1.5",
      "release/1.6",
      "release/1.7",
      "release/1.8",
      "release/1.9",
      "release/1.10",
      "release/1.11",
      "release/2.0",
      "release/2.1",
      "release/2.2",
      "release/2.3",
      "release/2.4",
      "release/3.0",
      "release/3.1",
      "release/3.2",
      "release/3.3",
      "release/3.4",
      "release/3.5",
      "release/3.5.0patches",
      "release/3.6",
      "release/3.6.0patches",
      "release/3.7",
      "release/3.8",
      "release/3.9",
      "release/3.10"
    ],
    "languages": {
      "C++": 59160514,
      "Python": 14889792,
      "C": 12348575,
      "SWIG": 1325945,
      "CMake": 769671,
      "Java": 722149,
      "Shell": 182222,
      "C#": 141902,
      "Dockerfile": 64383,
      "Yacc": 37755,
      "QML": 26435,
      "HTML": 17375,
      "F*": 16644,
      "Perl": 15582,
      "Game Maker Language": 14887,
      "Pawn": 8164,
      "Makefile": 7378,
      "XSLT": 6630,
      "Roff": 4608,
      "AGS Script": 4367,
      "RouterOS Script": 650,
      "TeX": 378,
      "Batchfile": 343
    },
    "commit_activity": {
      "total_commits_last_year": 4382,
      "avg_commits_per_week": 84.26923076923077,
      "days_active_last_year": 338
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:08:35.486339"
  }
}