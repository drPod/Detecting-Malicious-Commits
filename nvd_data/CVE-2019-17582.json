{
  "cve_id": "CVE-2019-17582",
  "github_data": {
    "repository": "nih-at/libzip",
    "fix_commit": "2217022b7d1142738656d891e00b3d2d9179b796",
    "related_commits": [
      "2217022b7d1142738656d891e00b3d2d9179b796",
      "2217022b7d1142738656d891e00b3d2d9179b796"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2217022b7d1142738656d891e00b3d2d9179b796",
      "commit_date": "2017-08-14T08:55:44Z",
      "author": {
        "login": "0-wiz-0",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix double free().",
        "length": 65,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 1,
        "deletions": 3
      },
      "files": [
        {
          "filename": "THANKS",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -12,6 +12,7 @@ BALATON Zoltan <balaton@eik.bme.hu>\n Benjamin Gilbert <bgilbert@backtick.net>\n Boaz Stolk <bstolk@aweta.nl>\n Bogdan <bogiebog@gmail.com>\n+Brian 'geeknik' Carpenter <geeknik@protonmail.ch>\n Chris Nehren <cnehren+libzip@pobox.com>\n Coverity <info@coverity.com>\n Dane Springmeyer <dane.springmeyer@gmail.com>"
        },
        {
          "filename": "lib/zip_dirent.c",
          "status": "modified",
          "additions": 0,
          "deletions": 3,
          "patch": "@@ -579,9 +579,6 @@ _zip_dirent_read(zip_dirent_t *zde, zip_source_t *src, zip_buffer_t *buffer, boo\n     }\n \n     if (!_zip_dirent_process_winzip_aes(zde, error)) {\n-\tif (!from_buffer) {\n-\t    _zip_buffer_free(buffer);\n-\t}\n \treturn -1;\n     }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa3a6b4da7577de63581f8db2f9d2757481b4cc8",
            "date": "2025-01-23T10:01:57Z",
            "author_login": "dillof"
          },
          {
            "sha": "37b02a6ddfa6d15628177396ffe7f40f46a04444",
            "date": "2025-01-20T14:59:24Z",
            "author_login": "0-wiz-0"
          },
          {
            "sha": "f30f5290de485348442d168cd7b2eb714d1f20f9",
            "date": "2025-01-20T10:58:47Z",
            "author_login": "0-wiz-0"
          },
          {
            "sha": "09bc74d0f3be5c862945790d497c84f50f8a49e1",
            "date": "2025-01-20T10:58:20Z",
            "author_login": "dillof"
          },
          {
            "sha": "5e7532472d3306d3b6e8ff34001cdc2f6752cf8f",
            "date": "2025-01-20T10:24:27Z",
            "author_login": "0-wiz-0"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-416",
    "description": "A use-after-free in the _zip_dirent_read function of zip_dirent.c in libzip 1.2.0 allows attackers to have an unspecified impact by attempting to unzip a malformed ZIP archive. NOTE: the discoverer states \"This use-after-free is triggered prior to the double free reported in CVE-2017-12858.\"",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-09T19:15:12.553",
    "last_modified": "2024-11-21T04:32:35.243",
    "fix_date": "2017-08-14T08:55:44Z"
  },
  "references": [
    {
      "url": "https://github.com/nih-at/libzip/commit/2217022b7d1142738656d891e00b3d2d9179b796",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nih-at/libzip/issues/5",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://libzip.org/libzip-discuss/",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/nih-at/libzip/commit/2217022b7d1142738656d891e00b3d2d9179b796",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nih-at/libzip/issues/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://libzip.org/libzip-discuss/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.193306",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libzip",
    "owner": "nih-at",
    "created_at": "2016-02-17T10:07:33Z",
    "updated_at": "2025-01-24T06:24:29Z",
    "pushed_at": "2025-01-23T10:02:00Z",
    "size": 48377,
    "stars": 873,
    "forks": 279,
    "open_issues": 2,
    "watchers": 873,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 898063,
      "CMake": 95121,
      "Batchfile": 7591,
      "Shell": 3519,
      "Dockerfile": 3467
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:51:33.611079"
  }
}