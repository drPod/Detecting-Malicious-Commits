{
  "cve_id": "CVE-2019-18218",
  "github_data": {
    "repository": "file/file",
    "fix_commit": "46a8443f76cec4b41ec736eca396984c74664f84",
    "related_commits": [
      "46a8443f76cec4b41ec736eca396984c74664f84",
      "46a8443f76cec4b41ec736eca396984c74664f84"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "46a8443f76cec4b41ec736eca396984c74664f84",
      "commit_date": "2019-08-26T14:31:39Z",
      "author": {
        "login": "zoulasc",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Limit the number of elements in a vector (found by oss-fuzz)",
        "length": 60,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
      },
      "files": [
        {
          "filename": "src/cdf.c",
          "status": "modified",
          "additions": 4,
          "deletions": 5,
          "patch": "@@ -35,7 +35,7 @@\n #include \"file.h\"\n \n #ifndef lint\n-FILE_RCSID(\"@(#)$File: cdf.c,v 1.115 2019/08/23 14:29:14 christos Exp $\")\n+FILE_RCSID(\"@(#)$File: cdf.c,v 1.116 2019/08/26 14:31:39 christos Exp $\")\n #endif\n \n #include <assert.h>\n@@ -1027,8 +1027,9 @@ cdf_read_property_info(const cdf_stream_t *sst, const cdf_header_t *h,\n \t\t\t\tgoto out;\n \t\t\t}\n \t\t\tnelements = CDF_GETUINT32(q, 1);\n-\t\t\tif (nelements == 0) {\n-\t\t\t\tDPRINTF((\"CDF_VECTOR with nelements == 0\\n\"));\n+\t\t\tif (nelements > CDF_ELEMENT_LIMIT || nelements == 0) {\n+\t\t\t\tDPRINTF((\"CDF_VECTOR with nelements == %\"\n+\t\t\t\t    SIZE_T_FORMAT \"u\\n\", nelements));\n \t\t\t\tgoto out;\n \t\t\t}\n \t\t\tslen = 2;\n@@ -1070,8 +1071,6 @@ cdf_read_property_info(const cdf_stream_t *sst, const cdf_header_t *h,\n \t\t\t\t\tgoto out;\n \t\t\t\tinp += nelem;\n \t\t\t}\n-\t\t\tDPRINTF((\"nelements = %\" SIZE_T_FORMAT \"u\\n\",\n-\t\t\t    nelements));\n \t\t\tfor (j = 0; j < nelements && i < sh.sh_properties;\n \t\t\t    j++, i++)\n \t\t\t{"
        },
        {
          "filename": "src/cdf.h",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -48,6 +48,7 @@\n typedef int32_t cdf_secid_t;\n \n #define CDF_LOOP_LIMIT\t\t\t\t\t10000\n+#define CDF_ELEMENT_LIMIT\t\t\t\t100000\n \n #define CDF_SECID_NULL\t\t\t\t\t0\n #define CDF_SECID_FREE\t\t\t\t\t-1"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dcb4d1620b493c15dbb199e5ce93c0848addd26e",
            "date": "2025-01-25T16:20:34Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "b874d520c592ecd55ebcae0d662dc6e54f5c5414",
            "date": "2025-01-25T16:11:03Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "cd534c3a08c28ccd8701c900d9c45b8d278212d8",
            "date": "2025-01-25T01:39:28Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "81a0cbd10c347496bdee7dde78f7e47a16b4e79f",
            "date": "2025-01-22T17:58:05Z",
            "author_login": "zoulasc"
          },
          {
            "sha": "1778642b8ba3d947a779a36fcd81f8e807220a19",
            "date": "2024-12-31T19:57:14Z",
            "author_login": "zoulasc"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "cdf_read_property_info in cdf.c in file through 5.37 does not restrict the number of CDF_VECTOR elements, which allows a heap-based buffer overflow (4-byte out-of-bounds write).",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-10-21T05:15:10.520",
    "last_modified": "2024-11-21T04:32:51.430",
    "fix_date": "2019-08-26T14:31:39Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00044.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16780",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/file/file/commit/46a8443f76cec4b41ec736eca396984c74664f84",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00032.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/07/msg00008.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CV6PFCEYHYALMTT45QE2U5C5TEJZQPXJ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/D6BJVGXSCC6NMIAWX36FPWHEIFON3OSE/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VBK6XOJR6OVWT2FUEBO7V7KCOSSLAP52/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-24",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20200115-0001/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4172-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4172-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4550",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00044.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16780",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/file/file/commit/46a8443f76cec4b41ec736eca396984c74664f84",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/10/msg00032.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/07/msg00008.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CV6PFCEYHYALMTT45QE2U5C5TEJZQPXJ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/D6BJVGXSCC6NMIAWX36FPWHEIFON3OSE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VBK6XOJR6OVWT2FUEBO7V7KCOSSLAP52/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20200115-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4172-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4172-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4550",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.966774",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "file",
    "owner": "file",
    "created_at": "2011-01-28T15:20:14Z",
    "updated_at": "2025-01-26T01:21:18Z",
    "pushed_at": "2025-01-25T17:00:08Z",
    "size": 10328,
    "stars": 1326,
    "forks": 382,
    "open_issues": 0,
    "watchers": 1326,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 579007,
      "Makefile": 18126,
      "Python": 15517,
      "M4": 14679,
      "Shell": 3261,
      "Dockerfile": 870
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:10:04.378350"
  }
}