{
  "cve_id": "CVE-2019-18609",
  "github_data": {
    "repository": "alanxz/rabbitmq-c",
    "fix_commit": "fc85be7123050b91b054e45b91c78d3241a5047a",
    "related_commits": [
      "fc85be7123050b91b054e45b91c78d3241a5047a",
      "fc85be7123050b91b054e45b91c78d3241a5047a"
    ],
    "patch_url": "https://github.com/alanxz/rabbitmq-c/commit/fc85be7123050b91b054e45b91c78d3241a5047a.patch",
    "fix_commit_details": {
      "sha": "fc85be7123050b91b054e45b91c78d3241a5047a",
      "commit_date": "2019-11-04T07:50:07Z",
      "author": {
        "login": "alanxz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "lib: check frame_size is >= INT32_MAX",
        "length": 584,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 12,
        "deletions": 3
      },
      "files": [
        {
          "filename": "librabbitmq/amqp_connection.c",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -287,12 +287,21 @@ int amqp_handle_input(amqp_connection_state_t state, amqp_bytes_t received_data,\n     case CONNECTION_STATE_HEADER: {\n       amqp_channel_t channel;\n       amqp_pool_t *channel_pool;\n-      /* frame length is 3 bytes in */\n+      uint32_t frame_size;\n+\n       channel = amqp_d16(amqp_offset(raw_frame, 1));\n \n-      state->target_size =\n-          amqp_d32(amqp_offset(raw_frame, 3)) + HEADER_SIZE + FOOTER_SIZE;\n+      /* frame length is 3 bytes in */\n+      frame_size = amqp_d32(amqp_offset(raw_frame, 3));\n+      /* To prevent the target_size calculation below from overflowing, check\n+       * that the stated frame_size is smaller than a signed 32-bit. Given\n+       * the library only allows configuring frame_max as an int32_t, and\n+       * frame_size is uint32_t, the math below is safe from overflow. */\n+      if (frame_size >= INT32_MAX) {\n+        return AMQP_STATUS_BAD_AMQP_DATA;\n+      }\n \n+      state->target_size = frame_size + HEADER_SIZE + FOOTER_SIZE;\n       if ((size_t)state->frame_max < state->target_size) {\n         return AMQP_STATUS_BAD_AMQP_DATA;\n       }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "377a387b5770f018625ff8ade32f9d7e529bbb1c",
            "date": "2024-12-22T23:12:49Z",
            "author_login": "tobim"
          },
          {
            "sha": "32fa2d5d25ea927763921c58ed6a42c9bbfe79c1",
            "date": "2024-11-20T02:48:32Z",
            "author_login": "alanxz"
          },
          {
            "sha": "84b81cd97a1b5515d3d4b304796680da24c666d8",
            "date": "2024-11-20T02:47:06Z",
            "author_login": "alanxz"
          },
          {
            "sha": "22202e12ee3eee7dbb61d3deefd61bc05aa79d27",
            "date": "2024-10-28T09:10:18Z",
            "author_login": "vfjpl"
          },
          {
            "sha": "d279b3e154fbee3d8cd19d86cac56c22b353e8ee",
            "date": "2024-10-25T12:45:56Z",
            "author_login": "vfjpl"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "An issue was discovered in amqp_handle_input in amqp_connection.c in rabbitmq-c 0.9.0. There is an integer overflow that leads to heap memory corruption in the handling of CONNECTION_STATE_HEADER. A rogue server could return a malicious frame header that leads to a smaller target_size value than needed. This condition is then carried on to a memcpy function that copies too much data into a heap buffer.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-12-01T22:15:10.897",
    "last_modified": "2024-11-21T04:33:21.440",
    "fix_date": "2019-11-04T07:50:07Z"
  },
  "references": [
    {
      "url": "https://github.com/alanxz/rabbitmq-c/blob/master/ChangeLog.md",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alanxz/rabbitmq-c/commit/fc85be7123050b91b054e45b91c78d3241a5047a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/12/msg00004.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WA7CPNVYMF6OQNIYNLWUY6U2GTKFOKH3/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XQER6XTKYMHNQR7QTHW7DJAH645WQROU/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://news.ycombinator.com/item?id=21681976",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-07",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4214-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4214-2/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alanxz/rabbitmq-c/blob/master/ChangeLog.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alanxz/rabbitmq-c/commit/fc85be7123050b91b054e45b91c78d3241a5047a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/12/msg00004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WA7CPNVYMF6OQNIYNLWUY6U2GTKFOKH3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XQER6XTKYMHNQR7QTHW7DJAH645WQROU/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://news.ycombinator.com/item?id=21681976",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-07",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4214-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4214-2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:24.241267",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rabbitmq-c",
    "owner": "alanxz",
    "created_at": "2011-06-06T16:42:17Z",
    "updated_at": "2025-01-12T13:23:58Z",
    "pushed_at": "2024-12-23T04:15:49Z",
    "size": 3320,
    "stars": 1782,
    "forks": 676,
    "open_issues": 113,
    "watchers": 1782,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 499615,
      "CMake": 24967,
      "Python": 22100,
      "Shell": 5704,
      "Dockerfile": 785
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:45:35.085958"
  }
}