{
  "cve_id": "CVE-2019-18848",
  "github_data": {
    "repository": "nov/json-jwt",
    "fix_commit": "ada16e772906efdd035e3df49cb2ae372f0f948a",
    "related_commits": [
      "ada16e772906efdd035e3df49cb2ae372f0f948a",
      "ada16e772906efdd035e3df49cb2ae372f0f948a"
    ],
    "patch_url": "https://github.com/nov/json-jwt/commit/ada16e772906efdd035e3df49cb2ae372f0f948a.patch",
    "fix_commit_details": {
      "sha": "ada16e772906efdd035e3df49cb2ae372f0f948a",
      "commit_date": "2019-11-11T14:28:48Z",
      "author": {
        "login": "nov",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "explicitly specifying number of elements when splitting JWE string",
        "length": 88,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/json/jwe.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -254,7 +254,7 @@ def decode_compact_serialized(input, private_key_or_secret, algorithms = nil, en\n           raise InvalidFormat.new(\"Invalid JWE Format. JWE should include #{NUM_OF_SEGMENTS} segments.\")\n         end\n         jwe = new\n-        _header_json_, jwe.jwe_encrypted_key, jwe.iv, jwe.cipher_text, jwe.authentication_tag = input.split('.').collect do |segment|\n+        _header_json_, jwe.jwe_encrypted_key, jwe.iv, jwe.cipher_text, jwe.authentication_tag = input.split('.', NUM_OF_SEGMENTS).collect do |segment|\n           begin\n             Base64.urlsafe_decode64 segment\n           rescue ArgumentError"
        },
        {
          "filename": "lib/json/jws.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -179,7 +179,7 @@ def decode_compact_serialized(input, public_key_or_secret, algorithms = nil, all\n         unless input.count('.') + 1 == NUM_OF_SEGMENTS\n           raise InvalidFormat.new(\"Invalid JWS Format. JWS should include #{NUM_OF_SEGMENTS} segments.\")\n         end\n-        header, claims, signature = input.split('.', JWS::NUM_OF_SEGMENTS).collect do |segment|\n+        header, claims, signature = input.split('.', NUM_OF_SEGMENTS).collect do |segment|\n           Base64.urlsafe_decode64 segment.to_s\n         end\n         header = JSON.parse(header).with_indifferent_access\n@@ -191,7 +191,7 @@ def decode_compact_serialized(input, public_key_or_secret, algorithms = nil, all\n         jws = new claims\n         jws.header = header\n         jws.signature = signature\n-        jws.signature_base_string = input.split('.')[0, JWS::NUM_OF_SEGMENTS - 1].join('.')\n+        jws.signature_base_string = input.split('.')[0, NUM_OF_SEGMENTS - 1].join('.')\n         jws.verify! public_key_or_secret, algorithms unless public_key_or_secret == :skip_verification\n         jws\n       end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9160130ed9216c4128e0cdf414fc04376a376c76",
            "date": "2024-10-15T16:02:33Z",
            "author_login": "nov"
          },
          {
            "sha": "6407f1d39065312ea5ecf20d47581d1ce2c63418",
            "date": "2024-10-15T16:00:15Z",
            "author_login": "nov"
          },
          {
            "sha": "394de1bbd72e028cc7745236621fb1589f8392c0",
            "date": "2024-08-27T19:16:43Z",
            "author_login": "ccutrer"
          },
          {
            "sha": "22fce184d450ebc34a9e4896c1b4f713bce2e27e",
            "date": "2024-03-06T23:06:44Z",
            "author_login": "nov"
          },
          {
            "sha": "fcc22b0033dff3ec7624dfadcbb4a3deae516573",
            "date": "2024-03-03T07:58:35Z",
            "author_login": "nov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-287",
    "description": "The json-jwt gem before 1.11.0 for Ruby lacks an element count during the splitting of a JWE string.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-11-12T15:15:10.880",
    "last_modified": "2024-11-21T04:33:42.370",
    "fix_date": "2019-11-11T14:28:48Z"
  },
  "references": [
    {
      "url": "https://github.com/nov/json-jwt/commit/ada16e772906efdd035e3df49cb2ae372f0f948a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nov/json-jwt/compare/v1.10.2...v1.11.0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/10/msg00001.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nov/json-jwt/commit/ada16e772906efdd035e3df49cb2ae372f0f948a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nov/json-jwt/compare/v1.10.2...v1.11.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/10/msg00001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:09.187545",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "json-jwt",
    "owner": "nov",
    "created_at": "2011-09-14T16:09:22Z",
    "updated_at": "2024-12-17T08:03:36Z",
    "pushed_at": "2024-10-15T16:02:41Z",
    "size": 393,
    "stars": 298,
    "forks": 81,
    "open_issues": 1,
    "watchers": 298,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 99325
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:50:41.405301"
  }
}