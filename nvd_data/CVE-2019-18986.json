{
  "cve_id": "CVE-2019-18986",
  "github_data": {
    "repository": "pimcore/pimcore",
    "fix_commit": "4a7bba5c3f818852cbbd29fa124f7fb09a207185",
    "related_commits": [
      "4a7bba5c3f818852cbbd29fa124f7fb09a207185",
      "4a7bba5c3f818852cbbd29fa124f7fb09a207185"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "4a7bba5c3f818852cbbd29fa124f7fb09a207185",
      "commit_date": "2019-10-21T14:47:15Z",
      "author": {
        "login": "brusch",
        "type": "User",
        "stats": {
          "total_commits": 7798,
          "average_weekly_commits": 15.441584158415841,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 421
        }
      },
      "commit_message": {
        "title": "Lost password service: do not expose info whether a user exists or not (avoid brute-force attacks)",
        "length": 98,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 39,
        "additions": 15,
        "deletions": 24
      },
      "files": [
        {
          "filename": "bundles/AdminBundle/Controller/Admin/LoginController.php",
          "status": "modified",
          "additions": 10,
          "deletions": 11,
          "patch": "@@ -22,6 +22,7 @@\n use Pimcore\\Controller\\EventedControllerInterface;\n use Pimcore\\Event\\Admin\\Login\\LostPasswordEvent;\n use Pimcore\\Event\\AdminEvents;\n+use Pimcore\\Logger;\n use Pimcore\\Model\\User;\n use Pimcore\\Templating\\Model\\ViewModel;\n use Pimcore\\Tool;\n@@ -116,29 +117,28 @@ public function loginCheckAction()\n     public function lostpasswordAction(Request $request, BruteforceProtectionHandler $bruteforceProtectionHandler)\n     {\n         $view = $this->buildLoginPageViewModel();\n-        $view->success = false;\n+        $error = null;\n \n-        // TODO is the error on the view used somewhere?\n         if ($request->getMethod() === 'POST' && $username = $request->get('username')) {\n             $user = User::getByName($username);\n \n             if ($user instanceof User) {\n                 if (!$user->isActive()) {\n-                    $view->error = 'user inactive';\n+                    $error = 'user inactive';\n                 }\n \n                 if (!$user->getEmail()) {\n-                    $view->error = 'user has no email address';\n+                    $error = 'user has no email address';\n                 }\n \n                 if (!$user->getPassword()) {\n-                    $view->error = 'user has no password';\n+                    $error = 'user has no password';\n                 }\n             } else {\n-                $view->error = 'user unknown';\n+                $error = 'user unknown';\n             }\n \n-            if (!$view->error) {\n+            if (!$error) {\n                 $token = Authentication::generateToken($username, $user->getPassword());\n \n                 $loginUrl = $this->generateUrl('pimcore_admin_login_check', [\n@@ -163,14 +163,13 @@ public function lostpasswordAction(Request $request, BruteforceProtectionHandler\n                     if ($event->hasResponse()) {\n                         return $event->getResponse();\n                     }\n-\n-                    $view->success = true;\n                 } catch (\\Exception $e) {\n-                    $view->error = 'could not send email';\n+                    $error = 'could not send email';\n                 }\n             }\n \n-            if ($view->error) {\n+            if ($error) {\n+                Logger::error('Lost password service: ' . $error);\n                 $bruteforceProtectionHandler->addEntry($request->get('username'), $request);\n             }\n         }"
        },
        {
          "filename": "bundles/AdminBundle/Resources/views/Admin/Login/lostpassword.html.php",
          "status": "modified",
          "additions": 5,
          "deletions": 12,
          "patch": "@@ -8,23 +8,16 @@\n \n \n \n-<?php if ($this->success) { ?>\n-    <div class=\"text info\">\n+<?php if ($this->getRequest()->getMethod() === 'POST') { ?>\n+    <div class=\"text error\">\n         <?= $this->translate(\"A temporary login link has been sent to your email address.\"); ?>\n         <br/>\n         <?= $this->translate(\"Please check your mailbox.\"); ?>\n     </div>\n <?php } else { ?>\n-    <?php if ($this->error) { ?>\n-        <div class=\"text error\">\n-            <?= $this->translate('lostpassword_reset_error'); ?>\n-        </div>\n-    <?php } else { ?>\n-        <div class=\"text info\">\n-            <?= $this->translate(\"Enter your username and pimcore will send a login link to your email address\"); ?>\n-        </div>\n-    <?php } ?>\n-\n+    <div class=\"text info\">\n+        <?= $this->translate(\"Enter your username and pimcore will send a login link to your email address\"); ?>\n+    </div>\n \n     <form method=\"post\" action=\"<?= $view->router()->path('pimcore_admin_login_lostpassword') ?>\">\n         <input type=\"text\" name=\"username\" placeholder=\"<?= $this->translate(\"Username\"); ?>\" required autofocus>"
        },
        {
          "filename": "bundles/CoreBundle/Resources/translations/en.json",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -147,7 +147,6 @@\n   \"send\": \"Send\",\n   \"Password\": \"Password\",\n   \"Forgot your password\": \"Forgot your password\",\n-  \"lostpassword_reset_error\": \"There was an error while sending the lost password info. Please try again or contact your administrator.\",\n   \"Back to Login\": \"Back to Login\",\n   \"Enter your username and pimcore will send a login link to your email address\": \"Enter your username and Pimcore will send a login link to your email address\",\n   \"Please check your mailbox.\": \"Please check your mailbox.\","
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8069dbf289a883420d0d044bbc625b70bfe6ab69",
            "date": "2025-01-24T08:43:32Z",
            "author_login": "herbertroth"
          },
          {
            "sha": "ca25fd2d12528a83dc3e84b3391e109d5401ba1f",
            "date": "2025-01-24T08:28:47Z",
            "author_login": "herbertroth"
          },
          {
            "sha": "d67add7f7a776c41749baecb4e7b17a0a7cef4bb",
            "date": "2025-01-22T09:34:54Z",
            "author_login": "bluvulture"
          },
          {
            "sha": "8462b49987cdcdba6e6cba997956561db46e0b3c",
            "date": "2025-01-22T08:21:33Z",
            "author_login": "bluvulture"
          },
          {
            "sha": "3c6946c51fa457835af5b9ecd6a6c07006b287a8",
            "date": "2025-01-21T15:14:51Z",
            "author_login": "alexz707"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-307",
    "description": "Pimcore before 6.2.2 allow attackers to brute-force (guess) valid usernames by using the 'forgot password' functionality as it returns distinct messages for invalid password and non-existing users.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-11-15T05:15:13.063",
    "last_modified": "2024-11-21T04:33:56.293",
    "fix_date": "2019-10-21T14:47:15Z"
  },
  "references": [
    {
      "url": "https://github.com/pimcore/pimcore/commit/4a7bba5c3f818852cbbd29fa124f7fb09a207185",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/compare/v6.2.1...v6.2.2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/commit/4a7bba5c3f818852cbbd29fa124f7fb09a207185",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/compare/v6.2.1...v6.2.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:09.194328",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "pimcore",
    "owner": "pimcore",
    "created_at": "2011-11-01T09:16:14Z",
    "updated_at": "2025-01-24T13:32:34Z",
    "pushed_at": "2025-01-24T11:49:46Z",
    "size": 524713,
    "stars": 3468,
    "forks": 1456,
    "open_issues": 492,
    "watchers": 3468,
    "has_security_policy": false,
    "default_branch": "12.x",
    "protected_branches": [
      "11.5",
      "12.x"
    ],
    "languages": {
      "PHP": 6723770,
      "JavaScript": 330727,
      "Twig": 9213,
      "CSS": 2342,
      "HTML": 687,
      "Shell": 538
    },
    "commit_activity": {
      "total_commits_last_year": 610,
      "avg_commits_per_week": 11.73076923076923,
      "days_active_last_year": 182
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:37:53.640257"
  }
}