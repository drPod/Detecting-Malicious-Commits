{
  "cve_id": "CVE-2019-19619",
  "github_data": {
    "repository": "documize/community",
    "fix_commit": "a4384210d4d0d6b18e6fdb7e155de96d4a1cf9f3",
    "related_commits": [
      "a4384210d4d0d6b18e6fdb7e155de96d4a1cf9f3",
      "a4384210d4d0d6b18e6fdb7e155de96d4a1cf9f3"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a4384210d4d0d6b18e6fdb7e155de96d4a1cf9f3",
      "commit_date": "2019-11-19T11:47:51Z",
      "author": {
        "login": "sauls8t",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Sanitize HTML in Markdown sections",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "domain/section/markdown/markdown.go",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -18,6 +18,7 @@ import (\n \t\"github.com/documize/community/core/env\"\n \t\"github.com/documize/community/domain/section/provider\"\n \t\"github.com/documize/community/domain/store\"\n+\t\"github.com/microcosm-cc/bluemonday\"\n )\n \n // Provider represents Markdown\n@@ -47,9 +48,11 @@ func (*Provider) Command(ctx *provider.Context, w http.ResponseWriter, r *http.R\n \n // Render converts markdown data into HTML suitable for browser rendering.\n func (*Provider) Render(ctx *provider.Context, config, data string) string {\n-\tresult := blackfriday.Run([]byte(data))\n+\tunsafe := blackfriday.Run([]byte(data))\n \n-\treturn string(result)\n+\tsafe := bluemonday.UGCPolicy().SanitizeBytes(unsafe)\n+\n+\treturn string(safe)\n }\n \n // Refresh just sends back data as-is."
        },
        {
          "filename": "go.mod",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -23,6 +23,7 @@ require (\n \tgithub.com/kr/pretty v0.1.0 // indirect\n \tgithub.com/lib/pq v1.2.0\n \tgithub.com/mb0/diff v0.0.0-20131118162322-d8d9a906c24d // indirect\n+\tgithub.com/microcosm-cc/bluemonday v1.0.2\n \tgithub.com/nu7hatch/gouuid v0.0.0-20131221200532-179d4d0c4d8d\n \tgithub.com/pkg/errors v0.8.0\n \tgithub.com/rainycape/unidecode v0.0.0-20150907023854-cb7f23ec59be // indirect"
        },
        {
          "filename": "go.sum",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -94,6 +94,8 @@ github.com/mattn/go-sqlite3 v1.9.0/go.mod h1:FPy6KqzDD04eiIsT53CuJW3U88zkxoIYsOq\n github.com/matttproud/golang_protobuf_extensions v1.0.1/go.mod h1:D8He9yQNgCq6Z5Ld7szi9bcBfOoFv/3dc6xSMkL2PC0=\n github.com/mb0/diff v0.0.0-20131118162322-d8d9a906c24d h1:eAS2t2Vy+6psf9LZ4T5WXWsbkBt3Tu5PWekJy5AGyEU=\n github.com/mb0/diff v0.0.0-20131118162322-d8d9a906c24d/go.mod h1:3YMHqrw2Qu3Liy82v4QdAG17e9k91HZ7w3hqlpWqhDo=\n+github.com/microcosm-cc/bluemonday v1.0.2 h1:5lPfLTTAvAbtS0VqT+94yOtFnGfUWYyx0+iToC3Os3s=\n+github.com/microcosm-cc/bluemonday v1.0.2/go.mod h1:iVP4YcDBq+n/5fb23BhYFvIMq/leAFZyRl6bYmGDlGc=\n github.com/mwitkow/go-conntrack v0.0.0-20161129095857-cc309e4a2223/go.mod h1:qRWi+5nqEBWmkhHvq77mSJWrCKwh8bxhgT7d/eI7P4U=\n github.com/nu7hatch/gouuid v0.0.0-20131221200532-179d4d0c4d8d h1:VhgPp6v9qf9Agr/56bj7Y/xa04UccTW04VP0Qed4vnQ=\n github.com/nu7hatch/gouuid v0.0.0-20131221200532-179d4d0c4d8d/go.mod h1:YUTz3bUH2ZwIWBy3CJBeOBEugqcmXREj14T+iG/4k4U=\n@@ -137,6 +139,7 @@ golang.org/x/net v0.0.0-20180724234803-3673e40ba225/go.mod h1:mL1N/T3taQHkDXs73r\n golang.org/x/net v0.0.0-20180826012351-8a410e7b638d/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\n golang.org/x/net v0.0.0-20180906233101-161cd47e91fd/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\n golang.org/x/net v0.0.0-20181114220301-adae6a3d119a/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\n+golang.org/x/net v0.0.0-20181220203305-927f97764cc3/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\n golang.org/x/net v0.0.0-20190108225652-1e06a53dbb7e/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\n golang.org/x/net v0.0.0-20190125091013-d26f9f9a57f3/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\n golang.org/x/net v0.0.0-20190213061140-3a22650c66bd/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4="
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "efb092ef8f3f1d07dbcbede3f73800f7c431ccee",
            "date": "2024-12-31T18:09:30Z",
            "author_login": "HarveyKandola"
          },
          {
            "sha": "3fc0a15f87b8d20be9c12d3a43b30c6e2c20c262",
            "date": "2024-12-31T17:05:21Z",
            "author_login": "HarveyKandola"
          },
          {
            "sha": "c841c85478e35b4985c5f868d2cac2db96eff050",
            "date": "2024-12-30T18:49:39Z",
            "author_login": "HarveyKandola"
          },
          {
            "sha": "2dae03332b7e408b2f75a35eb36533ea6a13fdc2",
            "date": "2024-06-18T15:53:23Z",
            "author_login": "HarveyKandola"
          },
          {
            "sha": "44b1f263cd2a660b348014be7bcc9fd7eb36d8ac",
            "date": "2024-06-18T15:53:15Z",
            "author_login": "HarveyKandola"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "domain/section/markdown/markdown.go in Documize before 3.5.1 mishandles untrusted Markdown content. This was addressed by adding the bluemonday HTML sanitizer to defend against XSS.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-12-06T04:15:10.660",
    "last_modified": "2024-11-21T04:35:04.533",
    "fix_date": "2019-11-19T11:47:51Z"
  },
  "references": [
    {
      "url": "https://github.com/documize/community/commit/a4384210d4d0d6b18e6fdb7e155de96d4a1cf9f3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/documize/community/compare/v3.5.0...v3.5.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/documize/community/releases/tag/v3.5.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/documize/community/commit/a4384210d4d0d6b18e6fdb7e155de96d4a1cf9f3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/documize/community/compare/v3.5.0...v3.5.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/documize/community/releases/tag/v3.5.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:24.247783",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "community",
    "owner": "documize",
    "created_at": "2016-04-29T23:35:07Z",
    "updated_at": "2025-01-21T20:57:08Z",
    "pushed_at": "2024-12-31T18:23:51Z",
    "size": 205239,
    "stars": 2185,
    "forks": 215,
    "open_issues": 46,
    "watchers": 2185,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 1714433,
      "Go": 1526745,
      "Handlebars": 361062,
      "SCSS": 253413,
      "HTML": 92751,
      "CSS": 68770,
      "Shell": 3258,
      "Dockerfile": 2649,
      "Batchfile": 2441
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T08:02:44.437326"
  }
}