{
  "cve_id": "CVE-2019-19954",
  "github_data": {
    "repository": "signalapp/Signal-Desktop",
    "fix_commit": "2da39cca673cc11be3c6d70d4fb95889f9ab6688",
    "related_commits": [
      "2da39cca673cc11be3c6d70d4fb95889f9ab6688",
      "2da39cca673cc11be3c6d70d4fb95889f9ab6688"
    ],
    "patch_url": "https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688.patch",
    "fix_commit_details": {
      "sha": "2da39cca673cc11be3c6d70d4fb95889f9ab6688",
      "commit_date": "2019-12-16T14:46:37Z",
      "author": {
        "login": "scottnonnenberg-signal",
        "type": "User",
        "stats": {
          "total_commits": 2278,
          "average_weekly_commits": 3.954861111111111,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 309
        }
      },
      "commit_message": {
        "title": "os-locale: Include 'preferLocal: false' option when using execa",
        "length": 108,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 46,
        "additions": 46,
        "deletions": 0
      },
      "files": [
        {
          "filename": "patches/os-locale+2.1.0.patch",
          "status": "added",
          "additions": 46,
          "deletions": 0,
          "patch": "@@ -0,0 +1,46 @@\n+diff --git a/node_modules/os-locale/index.js b/node_modules/os-locale/index.js\n+index 1ada7a4..1304aa1 100644\n+--- a/node_modules/os-locale/index.js\n++++ b/node_modules/os-locale/index.js\n+@@ -25,11 +25,11 @@ function getLocale(str) {\n+ }\n+ \n+ function getAppleLocale() {\n+-\treturn execa.stdout('defaults', ['read', '-g', 'AppleLocale']);\n++\treturn execa.stdout('defaults', ['read', '-g', 'AppleLocale'], { preferLocal: false });\n+ }\n+ \n+ function getAppleLocaleSync() {\n+-\treturn execa.sync('defaults', ['read', '-g', 'AppleLocale']).stdout;\n++\treturn execa.sync('defaults', ['read', '-g', 'AppleLocale'], { preferLocal: false }).stdout;\n+ }\n+ \n+ function getUnixLocale() {\n+@@ -37,7 +37,8 @@ function getUnixLocale() {\n+ \t\treturn getAppleLocale();\n+ \t}\n+ \n+-\treturn execa.stdout('locale')\n++\tconst args = null;\n++\treturn execa.stdout('locale', args, { preferLocal: false })\n+ \t\t.then(stdout => getLocale(parseLocale(stdout)));\n+ }\n+ \n+@@ -50,7 +51,7 @@ function getUnixLocaleSync() {\n+ }\n+ \n+ function getWinLocale() {\n+-\treturn execa.stdout('wmic', ['os', 'get', 'locale'])\n++\treturn execa.stdout('wmic', ['os', 'get', 'locale'], { preferLocal: false })\n+ \t\t.then(stdout => {\n+ \t\t\tconst lcidCode = parseInt(stdout.replace('Locale', ''), 16);\n+ \t\t\treturn lcid.from(lcidCode);\n+@@ -58,7 +59,7 @@ function getWinLocale() {\n+ }\n+ \n+ function getWinLocaleSync() {\n+-\tconst stdout = execa.sync('wmic', ['os', 'get', 'locale']).stdout;\n++\tconst stdout = execa.sync('wmic', ['os', 'get', 'locale'], { preferLocal: false }).stdout;\n+ \tconst lcidCode = parseInt(stdout.replace('Locale', ''), 16);\n+ \treturn lcid.from(lcidCode);\n+ }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bfb53efb72bcbf799992805f63cdccbd937ad99c",
            "date": "2025-01-09T15:50:14Z",
            "author_login": "trevor-signal"
          },
          {
            "sha": "40bbce5e060cebe52ab6622e1b89e28fa0903ab9",
            "date": "2025-01-09T15:50:14Z",
            "author_login": "trevor-signal"
          },
          {
            "sha": "8dc48b0b16b9dc1e38376aa2b2a6ae99105adb06",
            "date": "2025-01-09T15:45:31Z",
            "author_login": "trevor-signal"
          },
          {
            "sha": "99b3a8361583852c886483ca49311cdbb0ca9dd9",
            "date": "2025-01-08T19:17:15Z",
            "author_login": "trevor-signal"
          },
          {
            "sha": "3a1addbfe505936df4c40fa100a3fdcb97e6931b",
            "date": "2025-01-09T02:23:13Z",
            "author_login": "indutny-signal"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-427",
    "description": "Signal Desktop before 1.29.1 on Windows allows local users to gain privileges by creating a Trojan horse %SYSTEMDRIVE%\\node_modules\\.bin\\wmic.exe file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-12-24T15:15:11.473",
    "last_modified": "2024-11-21T04:35:44.270",
    "fix_date": "2019-12-16T14:46:37Z"
  },
  "references": [
    {
      "url": "https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://blog.mirch.io/2019/12/18/signal-desktop-windows-lpe/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/signalapp/Signal-Desktop/commit/2da39cca673cc11be3c6d70d4fb95889f9ab6688",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:24.269579",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Signal-Desktop",
    "owner": "signalapp",
    "created_at": "2014-02-24T19:53:36Z",
    "updated_at": "2025-01-14T02:37:43Z",
    "pushed_at": "2025-01-09T15:57:55Z",
    "size": 675345,
    "stars": 14784,
    "forks": 2699,
    "open_issues": 761,
    "watchers": 14784,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 12048847,
      "JavaScript": 1854122,
      "SCSS": 718850,
      "HTML": 12472,
      "NSIS": 11202,
      "Shell": 4461,
      "CSS": 2641,
      "Dockerfile": 2638
    },
    "commit_activity": {
      "total_commits_last_year": 1320,
      "avg_commits_per_week": 25.384615384615383,
      "days_active_last_year": 242
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T22:03:29.726342"
  }
}