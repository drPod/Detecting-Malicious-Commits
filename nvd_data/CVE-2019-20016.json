{
  "cve_id": "CVE-2019-20016",
  "github_data": {
    "repository": "hoene/libmysofa",
    "fix_commit": "2e6fac6ab6156dae8e8c6f417741388084b70d6f",
    "related_commits": [
      "2e6fac6ab6156dae8e8c6f417741388084b70d6f",
      "2e6fac6ab6156dae8e8c6f417741388084b70d6f"
    ],
    "patch_url": "https://github.com/hoene/libmysofa/commit/2e6fac6ab6156dae8e8c6f417741388084b70d6f.patch",
    "fix_commit_details": {
      "sha": "2e6fac6ab6156dae8e8c6f417741388084b70d6f",
      "commit_date": "2019-11-24T09:42:37Z",
      "author": {
        "login": "hoene",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed recursive function calls",
        "length": 30,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/hdf/fractalhead.c",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -33,12 +33,17 @@ static int directblockRead(struct READER *reader, struct DATAOBJECT *dataobject,\n \tUNUSED(block_size);\n \tUNUSED(block_offset);\n \n+\tif(reader->recursive_counter >= 10)\n+\t\treturn MYSOFA_INVALID_FORMAT;\n+\telse\n+\t\treader->recursive_counter++;\n+\n \t/* read signature */\n \tif (fread(buf, 1, 4, reader->fhd) != 4 || strncmp(buf, \"FHDB\", 4)) {\n \t\tlog(\"cannot read signature of fractal heap indirect block\\n\");\n \t\treturn MYSOFA_INVALID_FORMAT;\n \t}\n-\tlog(\"%08\" PRIX64 \" %.4s\\n\", (uint64_t )ftell(reader->fhd) - 4, buf);\n+\tlog(\"%08\" PRIX64 \" %.4s stack %d\\n\", (uint64_t )ftell(reader->fhd) - 4, buf, reader->recursive_counter);\n \n \tif (fgetc(reader->fhd) != 0) {\n \t\tlog(\"object FHDB must have version 0\\n\");\n@@ -218,6 +223,7 @@ static int directblockRead(struct READER *reader, struct DATAOBJECT *dataobject,\n \n \t} while (typeandversion != 0);\n \n+\treader->recursive_counter--;\n \treturn MYSOFA_OK;\n }\n "
        },
        {
          "filename": "src/hdf/reader.h",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -182,6 +182,8 @@ struct READER {\n \tstruct SUPERBLOCK superblock;\n \n \tstruct GCOL *gcol;\n+\n+\tint recursive_counter;\n };\n \n int validAddress(struct READER *reader, uint64_t address);"
        },
        {
          "filename": "src/hrtf/reader.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -244,6 +244,7 @@ MYSOFA_EXPORT struct MYSOFA_HRTF* mysofa_load(const char *filename, int *err) {\n \t}\n \treader.gcol = NULL;\n \treader.all = NULL;\n+\treader.recursive_counter = 0;\n \n \t*err = superblockRead(&reader, &reader.superblock);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dd315a8ec1fee7193d40e4a59b12c5590a4a918c",
            "date": "2024-12-17T20:25:15Z",
            "author_login": "hoene"
          },
          {
            "sha": "b05b1611d5bca221506f8ecf42a2594af8135c36",
            "date": "2024-11-05T11:49:37Z",
            "author_login": "hoene"
          },
          {
            "sha": "49032b51215e73d8547c442426ef020805635927",
            "date": "2024-11-04T09:15:41Z",
            "author_login": "jperkin"
          },
          {
            "sha": "9e2eb4dc74cd738c458beb60939fad2c86def7ca",
            "date": "2024-10-29T16:32:26Z",
            "author_login": "naortega"
          },
          {
            "sha": "444d2c1d7ececf5cc2d96d3b17b209047b02318d",
            "date": "2024-10-19T19:02:33Z",
            "author_login": "hoene"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-787",
    "description": "libmysofa before 2019-11-24 does not properly restrict recursive function calls, as demonstrated by reports of stack consumption in readOHDRHeaderMessageDatatype in dataobject.c and directblockRead in fractalhead.c. NOTE: a download of v0.9 after 2019-12-06 should fully remediate this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-12-27T02:15:10.467",
    "last_modified": "2024-11-21T04:37:53.783",
    "fix_date": "2019-11-24T09:42:37Z"
  },
  "references": [
    {
      "url": "https://github.com/hoene/libmysofa/commit/2e6fac6ab6156dae8e8c6f417741388084b70d6f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hoene/libmysofa/issues/83",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hoene/libmysofa/issues/84",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hoene/libmysofa/commit/2e6fac6ab6156dae8e8c6f417741388084b70d6f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hoene/libmysofa/issues/83",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hoene/libmysofa/issues/84",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:24.275544",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libmysofa",
    "owner": "hoene",
    "created_at": "2016-12-06T22:13:29Z",
    "updated_at": "2025-01-09T06:47:21Z",
    "pushed_at": "2024-12-17T20:26:57Z",
    "size": 258803,
    "stars": 146,
    "forks": 75,
    "open_issues": 5,
    "watchers": 146,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 259485,
      "JavaScript": 22870,
      "CMake": 14971,
      "C++": 2873,
      "Shell": 1500,
      "MATLAB": 1463,
      "Emacs Lisp": 100
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:52:19.488940"
  }
}