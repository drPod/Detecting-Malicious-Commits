{
  "cve_id": "CVE-2019-20922",
  "github_data": {
    "repository": "handlebars-lang/handlebars.js",
    "fix_commit": "8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b",
    "related_commits": [
      "8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b",
      "8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b"
    ],
    "patch_url": "https://github.com/handlebars-lang/handlebars.js/commit/8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b.patch",
    "fix_commit_details": {
      "sha": "8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b",
      "commit_date": "2019-10-20T20:53:56Z",
      "author": {
        "login": "nknapp",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: non-eager matching raw-block-contents",
        "length": 294,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 15,
        "deletions": 2
      },
      "files": [
        {
          "filename": "spec/helpers.js",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -47,10 +47,18 @@ describe('helpers', function() {\n       runWithIdentityHelper('{{{{identity}}}}{{{{/identity}}}}', '');\n     });\n \n-    it('helper for nested raw block works if nested raw blocks are broken', function() {\n+    xit('helper for nested raw block works if nested raw blocks are broken', function() {\n+      // This test was introduced in 4.4.4, but it was not the actual problem that lead to the patch release\n+      // The test is deactivated, because in 3.x this template cases an exception and it also does not work in 4.4.3\n+      // If anyone can make this template work without breaking everything else, then go for it,\n+      // but for now, this is just a known bug, that will be documented.\n       runWithIdentityHelper('{{{{identity}}}} {{{{a}}}} {{{{ {{{{/ }}}} }}}} {{{{/identity}}}}', ' {{{{a}}}} {{{{ {{{{/ }}}} }}}} ');\n     });\n \n+    it('helper for nested raw block closes after first matching close', function() {\n+      runWithIdentityHelper('{{{{identity}}}}abc{{{{/identity}}}} {{{{identity}}}}abc{{{{/identity}}}}', 'abc abc');\n+    });\n+\n     it('helper for nested raw block throw exception when with missing closing braces', function() {\n       var string = '{{{{a}}}} {{{{/a';\n       shouldThrow(function() {"
        },
        {
          "filename": "spec/tokenizer.js",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -441,4 +441,9 @@ describe('Tokenizer', function() {\n     result = tokenize('{{else foo as |bar baz|}}');\n     shouldMatchTokens(result, ['OPEN_INVERSE_CHAIN', 'ID', 'OPEN_BLOCK_PARAMS', 'ID', 'ID', 'CLOSE_BLOCK_PARAMS', 'CLOSE']);\n   });\n+\n+  it('tokenizes raw blocks', function() {\n+    var result = tokenize('{{{{a}}}} abc {{{{/a}}}} aaa {{{{a}}}} abc {{{{/a}}}}');\n+    shouldMatchTokens(result, ['OPEN_RAW_BLOCK', 'ID', 'CLOSE_RAW_BLOCK', 'CONTENT', 'END_RAW_BLOCK', 'CONTENT', 'OPEN_RAW_BLOCK', 'ID', 'CLOSE_RAW_BLOCK', 'CONTENT', 'END_RAW_BLOCK']);\n+  });\n });"
        },
        {
          "filename": "src/handlebars.l",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -63,7 +63,7 @@ ID    [^\\s!\"#%-,\\.\\/;->@\\[-\\^`\\{-~]+/{LOOKAHEAD}\n                                     return 'END_RAW_BLOCK';\n                                   }\n                                  }\n-<raw>[^\\x00]+/(\"{{{{\")          { return 'CONTENT'; }\n+<raw>[^\\x00]+?/(\"{{{{\")          { return 'CONTENT'; }\n \n <com>[\\s\\S]*?\"--\"{RIGHT_STRIP}?\"}}\" {\n   this.popState();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f422bfdf3ed321c32c6eecfaa778de46275fb76d",
            "date": "2024-09-01T16:23:54Z",
            "author_login": "mohd-akram"
          },
          {
            "sha": "25c696b8891e65f7f7e8405ecdf0a6b17808d237",
            "date": "2023-12-12T21:11:31Z",
            "author_login": "cclauss"
          },
          {
            "sha": "1fc4ef09c1ac0ffb4c0f88ca685f44d1e0f32f89",
            "date": "2020-10-08T17:19:54Z",
            "author_login": "bvallee-thefork"
          },
          {
            "sha": "ce1f2abf5aae40e3581510880d39a7153f9b9df7",
            "date": "2023-09-20T19:44:20Z",
            "author_login": "mohd-akram"
          },
          {
            "sha": "2afecb25db9b7b5f8c6c6891f1eb8d388e999f4e",
            "date": "2023-09-20T11:22:57Z",
            "author_login": "mohd-akram"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Handlebars before 4.4.5 allows Regular Expression Denial of Service (ReDoS) because of eager matching. The parser may be forced into an endless loop while processing crafted templates. This may allow attackers to exhaust system resources.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-09-30T18:15:18.100",
    "last_modified": "2024-11-21T04:39:41.877",
    "fix_date": "2019-10-20T20:53:56Z"
  },
  "references": [
    {
      "url": "https://github.com/handlebars-lang/handlebars.js/commit/8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-HANDLEBARS-480388",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/advisories/1300",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/handlebars-lang/handlebars.js/commit/8d5530ee2c3ea9f0aee3fde310b9f36887d00b8b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-HANDLEBARS-480388",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/advisories/1300",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.157108",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "handlebars.js",
    "owner": "handlebars-lang",
    "created_at": "2010-07-31T18:54:46Z",
    "updated_at": "2025-01-14T13:26:32Z",
    "pushed_at": "2024-09-03T20:27:37Z",
    "size": 4058,
    "stars": 18094,
    "forks": 2043,
    "open_issues": 100,
    "watchers": 18094,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 379340,
      "HTML": 8793,
      "TypeScript": 8788,
      "Shell": 2105,
      "Ruby": 952,
      "Handlebars": 533,
      "Mustache": 260
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:54:14.687010"
  }
}