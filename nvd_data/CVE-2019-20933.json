{
  "cve_id": "CVE-2019-20933",
  "github_data": {
    "repository": "influxdata/influxdb",
    "fix_commit": "761b557315ff9c1642cf3b0e5797cd3d983a24c0",
    "related_commits": [
      "761b557315ff9c1642cf3b0e5797cd3d983a24c0",
      "761b557315ff9c1642cf3b0e5797cd3d983a24c0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "761b557315ff9c1642cf3b0e5797cd3d983a24c0",
      "commit_date": "2019-04-02T15:26:57Z",
      "author": {
        "login": "dgnorton",
        "type": "User",
        "stats": {
          "total_commits": 481,
          "average_weekly_commits": 0.779578606158833,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 94
        }
      },
      "commit_message": {
        "title": "fix(httpd): fail bearerauth if shared secret blank",
        "length": 50,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 23,
        "deletions": 0
      },
      "files": [
        {
          "filename": "services/httpd/handler.go",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1581,6 +1581,11 @@ func authenticate(inner func(http.ResponseWriter, *http.Request, meta.User), h *\n \t\t\t\t\treturn\n \t\t\t\t}\n \t\t\tcase BearerAuthentication:\n+\t\t\t\tif h.Config.SharedSecret == \"\" {\n+\t\t\t\t\tatomic.AddInt64(&h.stats.AuthenticationFailures, 1)\n+\t\t\t\t\th.httpError(w, \"bearer auth disabled\", http.StatusUnauthorized)\n+\t\t\t\t\treturn\n+\t\t\t\t}\n \t\t\t\tkeyLookupFn := func(token *jwt.Token) (interface{}, error) {\n \t\t\t\t\t// Check for expected signing method.\n \t\t\t\t\tif _, ok := token.Method.(*jwt.SigningMethodHMAC); !ok {"
        },
        {
          "filename": "services/httpd/handler_test.go",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -232,6 +232,24 @@ func TestHandler_Query_Auth(t *testing.T) {\n \t\tt.Fatalf(\"unexpected body: %s\", body)\n \t}\n \n+\t// Test that auth fails if shared secret is blank.\n+\torigSecret := h.Config.SharedSecret\n+\th.Config.SharedSecret = \"\"\n+\ttoken, _ = MustJWTToken(\"user1\", h.Config.SharedSecret, false)\n+\tsignedToken, err = token.SignedString([]byte(h.Config.SharedSecret))\n+\tif err != nil {\n+\t\tt.Fatal(err)\n+\t}\n+\treq.Header.Set(\"Authorization\", fmt.Sprintf(\"Bearer %s\", signedToken))\n+\tw = httptest.NewRecorder()\n+\th.ServeHTTP(w, req)\n+\tif w.Code != http.StatusUnauthorized {\n+\t\tt.Fatalf(\"unexpected status: %d: %s\", w.Code, w.Body.String())\n+\t} else if body := strings.TrimSpace(w.Body.String()); body != `{\"error\":\"bearer auth disabled\"}` {\n+\t\tt.Fatalf(\"unexpected body: %s\", body)\n+\t}\n+\th.Config.SharedSecret = origSecret\n+\n \t// Test the handler with valid user and password in the url and invalid in\n \t// basic auth (prioritize url).\n \tw = httptest.NewRecorder()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "43e186d76192e2d04f0cafbec03feca03bb7d292",
            "date": "2025-01-24T18:34:38Z",
            "author_login": "mgattozzi"
          },
          {
            "sha": "061b62a09b06e36ada92da958937d77e27434b5b",
            "date": "2025-01-24T15:02:44Z",
            "author_login": "mgattozzi"
          },
          {
            "sha": "4ef972eab4b09ed04053a245dda742ee29a8daeb",
            "date": "2025-01-24T14:36:06Z",
            "author_login": "praveen-influx"
          },
          {
            "sha": "07bd04b4233bbe6fc7938ab77f431095ff016a5e",
            "date": "2025-01-24T03:10:16Z",
            "author_login": "hiltontj"
          },
          {
            "sha": "d451ef0de64e6a589cdeed939a0fccc6e9a74dcc",
            "date": "2025-01-23T23:09:24Z",
            "author_login": "hiltontj"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-287",
    "description": "InfluxDB before 1.7.6 has an authentication bypass vulnerability in the authenticate function in services/httpd/handler.go because a JWT token may have an empty SharedSecret (aka shared secret).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-11-19T02:15:11.913",
    "last_modified": "2024-11-21T04:39:42.407",
    "fix_date": "2019-04-02T15:26:57Z"
  },
  "references": [
    {
      "url": "https://github.com/influxdata/influxdb/commit/761b557315ff9c1642cf3b0e5797cd3d983a24c0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/influxdata/influxdb/compare/v1.7.5...v1.7.6",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/influxdata/influxdb/issues/12927",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/12/msg00030.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4823",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/influxdata/influxdb/commit/761b557315ff9c1642cf3b0e5797cd3d983a24c0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/influxdata/influxdb/compare/v1.7.5...v1.7.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/influxdata/influxdb/issues/12927",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/12/msg00030.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4823",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.467039",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "influxdb",
    "owner": "influxdata",
    "created_at": "2013-09-26T14:31:10Z",
    "updated_at": "2025-01-25T20:58:42Z",
    "pushed_at": "2025-01-25T19:46:58Z",
    "size": 198474,
    "stars": 29372,
    "forks": 3576,
    "open_issues": 2060,
    "watchers": 29372,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.0",
      "1.1",
      "1.2",
      "1.3",
      "1.4",
      "1.5",
      "1.6",
      "1.7",
      "1.7.8",
      "1.7.9-dev",
      "1.7.11",
      "1.8-quiet-static-analysis",
      "1.8",
      "1.8.3",
      "1.8.4",
      "1.9-enable-oss-build",
      "1.9-max-del-typo",
      "1.9",
      "1.10-fix-ci",
      "1.10",
      "1.11",
      "2.0-fix-aws-destroy-query",
      "2.0",
      "2.1"
    ],
    "languages": {
      "Rust": 1870888,
      "Shell": 41249,
      "HTML": 9508,
      "Python": 3707,
      "Dockerfile": 2434,
      "HCL": 2156
    },
    "commit_activity": {
      "total_commits_last_year": 351,
      "avg_commits_per_week": 6.75,
      "days_active_last_year": 160
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:57:16.338842"
  }
}