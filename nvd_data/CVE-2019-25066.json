{
  "cve_id": "CVE-2019-25066",
  "github_data": {
    "repository": "ajenti/ajenti",
    "fix_commit": "7aa146b724e0e20cfee2c71ca78fafbf53a8767c",
    "related_commits": [
      "7aa146b724e0e20cfee2c71ca78fafbf53a8767c",
      "7aa146b724e0e20cfee2c71ca78fafbf53a8767c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7aa146b724e0e20cfee2c71ca78fafbf53a8767c",
      "commit_date": "2019-10-05T14:06:48Z",
      "author": {
        "login": "Eugeny",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed shell injection in os auth provider",
        "length": 41,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "ajenti-core/aj/auth.py",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -5,6 +5,7 @@\n import subprocess\n import syslog\n from jadi import component, service, interface\n+from six import PY3\n \n import aj\n from aj.api.http import BaseHttpHandler\n@@ -99,8 +100,14 @@ class OSAuthenticationProvider(AuthenticationProvider):\n \n     def authenticate(self, username, password):\n         child = None\n+\n+        if PY3:\n+            from shlex import quote\n+        else:\n+            from pipes import quote\n+\n         try:\n-            child = pexpect.spawn('/bin/sh', ['-c', '/bin/su -c \"/bin/echo SUCCESS\" - %s' % username], timeout=5)\n+            child = pexpect.spawn('/bin/sh', ['-c', '/bin/su -c \"/bin/echo SUCCESS\" - %s' % quote(username)], timeout=5)\n             child.expect('.*:')\n             child.sendline(password)\n             result = child.expect(['su: .*', 'SUCCESS'])"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6888765e43192f6afcf547464c3d2401a4f0206d",
            "date": "2025-01-05T18:47:23Z",
            "author_login": "kiarn"
          },
          {
            "sha": "a7667d4606c81663df90b91d81f6d2efdb4ad444",
            "date": "2025-01-05T18:46:44Z",
            "author_login": "kiarn"
          },
          {
            "sha": "ca95e57982fc57decdc2842ab660f27e3debb1f6",
            "date": "2025-01-05T18:45:54Z",
            "author_login": "kiarn"
          },
          {
            "sha": "f799bb8fa20dd08381e5f6548848f22c04b47046",
            "date": "2025-01-05T15:09:36Z",
            "author_login": "kiarn"
          },
          {
            "sha": "9393e52a3b029f56f52ed12ba1d7bc9e5269f5dc",
            "date": "2024-12-30T11:50:10Z",
            "author_login": "kiarn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-269",
    "description": "A vulnerability has been found in ajenti 2.1.31 and classified as critical. This vulnerability affects unknown code of the component API. The manipulation leads to privilege escalation. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2.1.32 is able to address this issue. The name of the patch is 7aa146b724e0e20cfee2c71ca78fafbf53a8767c. It is recommended to upgrade the affected component.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-09T17:15:08.250",
    "last_modified": "2024-11-21T04:39:52.443",
    "fix_date": "2019-10-05T14:06:48Z"
  },
  "references": [
    {
      "url": "https://github.com/ajenti/ajenti/commit/7aa146b724e0e20cfee2c71ca78fafbf53a8767c",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.143950",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/47497",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/ajenti/ajenti/commit/7aa146b724e0e20cfee2c71ca78fafbf53a8767c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.143950",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/47497",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.423519",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ajenti",
    "owner": "ajenti",
    "created_at": "2010-03-03T08:04:15Z",
    "updated_at": "2025-01-26T03:45:46Z",
    "pushed_at": "2025-01-05T18:47:26Z",
    "size": 38188,
    "stars": 7641,
    "forks": 849,
    "open_issues": 11,
    "watchers": 7641,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 390147,
      "JavaScript": 181321,
      "HTML": 174813,
      "CoffeeScript": 36135,
      "Less": 27428,
      "Shell": 21478,
      "Makefile": 1969,
      "Augeas": 1372
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:32:47.795260"
  }
}