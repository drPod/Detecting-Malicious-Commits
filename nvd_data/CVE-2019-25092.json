{
  "cve_id": "CVE-2019-25092",
  "github_data": {
    "repository": "Nakiami/mellivora",
    "fix_commit": "e0b6965f8dde608a3d2621617c05695eb406cbb9",
    "related_commits": [
      "e0b6965f8dde608a3d2621617c05695eb406cbb9",
      "e0b6965f8dde608a3d2621617c05695eb406cbb9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e0b6965f8dde608a3d2621617c05695eb406cbb9",
      "commit_date": "2019-11-21T10:00:05Z",
      "author": {
        "login": "Nakiami",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix hostname lookup xss in admin panel reported in issue 123 by Sin42",
        "length": 69,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "include/layout/user.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -300,7 +300,7 @@ function print_user_ip_log($user_id, $limit = 0) {\n         echo '\n         <tr>\n             <td><a href=\"',Config::get('MELLIVORA_CONFIG_SITE_ADMIN_URL'),'list_ip_log.php?ip=',htmlspecialchars($entry['ip']),'\">',htmlspecialchars($entry['ip']),'</a></td>\n-            <td>',(Config::get('MELLIVORA_CONFIG_GET_IP_HOST_BY_ADDRESS') ? gethostbyaddr($entry['ip']) : '<i>Lookup disabled in config</i>'),'</td>\n+            <td>',(Config::get('MELLIVORA_CONFIG_GET_IP_HOST_BY_ADDRESS') ? htmlspecialchars(gethostbyaddr($entry['ip'])) : '<i>Lookup disabled in config</i>'),'</td>\n             <td>',date_time($entry['added']),'</td>\n             <td>',date_time($entry['last_used']),'</td>\n             <td>',number_format($entry['times_used']),'</td>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "24c06dea501879d90df7b5caa4acab4721125425",
            "date": "2023-09-06T01:34:55Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "23c95b2bc194dccc66e3a54668847f6eb08e0564",
            "date": "2022-09-29T01:25:48Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3ce0029d2750a58aa001fb049183b41d94e2eaaa",
            "date": "2022-05-25T22:55:43Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "442d0f0058e4098a1a52a4230cc5a90dc5ab06aa",
            "date": "2022-05-25T22:55:31Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3f6602de3e9270cf8dd6a8b1805405cc19a9b70b",
            "date": "2022-01-07T05:21:18Z",
            "author_login": "Nakiami"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic was found in Nakiami Mellivora up to 2.1.x. Affected by this vulnerability is the function print_user_ip_log of the file include/layout/user.inc.php of the component Admin Panel. The manipulation of the argument $entry['ip'] leads to cross site scripting. The attack can be launched remotely. Upgrading to version 2.2.0 is able to address this issue. The name of the patch is e0b6965f8dde608a3d2621617c05695eb406cbb9. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216955.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-28T09:15:07.910",
    "last_modified": "2024-11-21T04:39:55.220",
    "fix_date": "2019-11-21T10:00:05Z"
  },
  "references": [
    {
      "url": "https://github.com/Nakiami/mellivora/commit/e0b6965f8dde608a3d2621617c05695eb406cbb9",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Nakiami/mellivora/releases/tag/v2.2.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216955",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216955",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Nakiami/mellivora/commit/e0b6965f8dde608a3d2621617c05695eb406cbb9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Nakiami/mellivora/releases/tag/v2.2.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216955",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216955",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.227201",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mellivora",
    "owner": "Nakiami",
    "created_at": "2013-07-15T10:20:07Z",
    "updated_at": "2025-01-11T15:02:10Z",
    "pushed_at": "2023-12-21T23:27:05Z",
    "size": 1687,
    "stars": 444,
    "forks": 170,
    "open_issues": 29,
    "watchers": 444,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 290070,
      "CSS": 6544,
      "JavaScript": 2939,
      "Shell": 2838,
      "Dockerfile": 674
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:28:14.610205"
  }
}