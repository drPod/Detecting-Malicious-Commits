{
  "cve_id": "CVE-2019-25157",
  "github_data": {
    "repository": "ethex-bet/ethex-contracts",
    "fix_commit": "6b8664b698d3d953e16c284fadc6caeb9e58e3db",
    "related_commits": [
      "6b8664b698d3d953e16c284fadc6caeb9e58e3db",
      "6b8664b698d3d953e16c284fadc6caeb9e58e3db"
    ],
    "patch_url": "https://github.com/ethex-bet/ethex-contracts/commit/6b8664b698d3d953e16c284fadc6caeb9e58e3db.patch",
    "fix_commit_details": {
      "sha": "6b8664b698d3d953e16c284fadc6caeb9e58e3db",
      "commit_date": "2019-06-26T19:38:48Z",
      "author": {
        "login": "ethexbet",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security vulnerability issue fixed",
        "length": 128,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 8,
        "deletions": 7
      },
      "files": [
        {
          "filename": "EthexJackpot.sol",
          "status": "modified",
          "additions": 8,
          "deletions": 7,
          "patch": "@@ -209,18 +209,17 @@ contract EthexJackpot {\n         if (seasonalPayAmount > 0)\n             getAddress(seasonalWin).transfer(seasonalPayAmount);\n     }\n-    \n+\n     function paySuperPrize(address payable winner) external onlyLoto {\n         uint256 superPrizeAmount = dailyAmount + weeklyAmount + monthlyAmount + seasonalAmount;\n+        dailyAmount = 0;\n+        weeklyAmount = 0;\n+        monthlyAmount = 0;\n+        seasonalAmount = 0;\n         emit SuperPrize(superPrizeAmount, winner);\n         winner.transfer(superPrizeAmount);\n     }\n     \n-    function loadTickets(address payable[] calldata addresses, uint256[] calldata numbers) external {\n-        for (uint i = 0; i < addresses.length; i++)\n-            tickets[numbers[i]] = addresses[i];\n-    }\n-    \n     function setOldVersion(address payable oldAddress) external onlyOwner {\n         previousContract = EthexJackpot(oldAddress);\n         dailyStart = previousContract.dailyStart();\n@@ -252,7 +251,9 @@ contract EthexJackpot {\n         weeklyAmount = previousContract.weeklyAmount();\n         monthlyAmount = previousContract.monthlyAmount();\n         seasonalAmount = previousContract.seasonalAmount();\n-        firstNumber = numberEnd;\n+        firstNumber = weeklyNumberStart;\n+        for (uint256 i = firstNumber; i <= numberEnd; i++)\n+            tickets[i] = previousContract.getAddress(i);\n         previousContract.migrate();\n     }\n     "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "65c8bd1761d87d508648f6d06c5195761754ac42",
            "date": "2019-10-29T13:19:25Z",
            "author_login": "ethexbet"
          },
          {
            "sha": "710f0b84f5410799fdb3450fe0d528b3009dd28e",
            "date": "2019-10-29T13:16:13Z",
            "author_login": "ethexbet"
          },
          {
            "sha": "3d15111459b01740246b24bf1dad6cd04ff9545c",
            "date": "2019-10-29T13:14:53Z",
            "author_login": "ethexbet"
          },
          {
            "sha": "f9392c3f4c054ccddc6966264f6535aabf9d070a",
            "date": "2019-10-29T13:13:30Z",
            "author_login": "ethexbet"
          },
          {
            "sha": "12d45b34b2cef26b773c1a6930f02e4aa5d50503",
            "date": "2019-10-29T13:12:50Z",
            "author_login": "ethexbet"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-284",
    "description": "A vulnerability was found in Ethex Contracts. It has been classified as critical. This affects an unknown part of the file EthexJackpot.sol of the component Monthly Jackpot Handler. The manipulation leads to improper access controls. It is possible to initiate the attack remotely. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The patch is named 6b8664b698d3d953e16c284fadc6caeb9e58e3db. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-248271.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-12-19T03:15:07.693",
    "last_modified": "2024-11-21T04:39:59.870",
    "fix_date": "2019-06-26T19:38:48Z"
  },
  "references": [
    {
      "url": "https://bitcointalk.org/index.php?topic=5120151.msg50827730#msg50827730",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/ethex-bet/ethex-contracts/commit/6b8664b698d3d953e16c284fadc6caeb9e58e3db",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.248271",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.248271",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://bitcointalk.org/index.php?topic=5120151.msg50827730#msg50827730",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/ethex-bet/ethex-contracts/commit/6b8664b698d3d953e16c284fadc6caeb9e58e3db",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.248271",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.248271",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:41.586047",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ethex-contracts",
    "owner": "ethex-bet",
    "created_at": "2019-03-04T13:40:18Z",
    "updated_at": "2021-11-04T08:18:17Z",
    "pushed_at": "2022-02-11T01:02:40Z",
    "size": 84,
    "stars": 5,
    "forks": 6,
    "open_issues": 2,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 32153
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T19:52:19.410043"
  }
}