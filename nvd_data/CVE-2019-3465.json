{
  "cve_id": "CVE-2019-3465",
  "github_data": {
    "repository": "robrichards/xmlseclibs",
    "fix_commit": "0a53d3c3aa87564910cae4ed01416441d3ae0db5",
    "related_commits": [
      "0a53d3c3aa87564910cae4ed01416441d3ae0db5",
      "0a53d3c3aa87564910cae4ed01416441d3ae0db5"
    ],
    "patch_url": "https://github.com/robrichards/xmlseclibs/commit/0a53d3c3aa87564910cae4ed01416441d3ae0db5.patch",
    "fix_commit_details": {
      "sha": "0a53d3c3aa87564910cae4ed01416441d3ae0db5",
      "commit_date": "2019-11-05T11:44:22Z",
      "author": {
        "login": "robrichards",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Release 3.0.4. Security release for CVE-2019-3465",
        "length": 49,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 25,
        "additions": 19,
        "deletions": 6
      },
      "files": [
        {
          "filename": "CHANGELOG.txt",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -1,6 +1,11 @@\n xmlseclibs.php\n |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n-??, ??? 2018, 3.0.4-dev\n+06, Nov 2019, 3.0.4\n+Security Improvements:\n+- Insure only a single SignedInfo element exists within a signature during \n+  verification. Refs CVE-2019-3465.\n+Bug Fixes:\n+- Fix variable casing.\n \n 15, Nov 2018, 3.0.3\n Bug Fixes:"
        },
        {
          "filename": "LICENSE",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-Copyright (c) 2007-2018, Robert Richards <rrichards@cdatazone.org>.\n+Copyright (c) 2007-2019, Robert Richards <rrichards@cdatazone.org>.\n All rights reserved.\n \n Redistribution and use in source and binary forms, with or without"
        },
        {
          "filename": "src/XMLSecurityDSig.php",
          "status": "modified",
          "additions": 11,
          "deletions": 3,
          "patch": "@@ -194,6 +194,11 @@ public function locateSignature($objDoc, $pos=0)\n             $query = \".//secdsig:Signature\";\n             $nodeset = $xpath->query($query, $objDoc);\n             $this->sigNode = $nodeset->item($pos);\n+            $query = \"./secdsig:SignedInfo\";\n+            $nodeset = $xpath->query($query, $this->sigNode);\n+            if ($nodeset->length > 1) {\n+                throw new Exception(\"Invalid structure - Too many SignedInfo elements found\");\n+            }\n             return $this->sigNode;\n         }\n         return null;\n@@ -303,6 +308,9 @@ public function canonicalizeSignedInfo()\n             $xpath = $this->getXPathObj();\n             $query = \"./secdsig:SignedInfo\";\n             $nodeset = $xpath->query($query, $this->sigNode);\n+            if ($nodeset->length > 1) {\n+                throw new Exception(\"Invalid structure - Too many SignedInfo elements found\");\n+            }\n             if ($signInfoNode = $nodeset->item(0)) {\n                 $query = \"./secdsig:CanonicalizationMethod\";\n                 $nodeset = $xpath->query($query, $signInfoNode);\n@@ -440,7 +448,7 @@ public function processTransforms($refNode, $objData, $includeCommentNodes = tru\n                         if ($node->localName == 'XPath') {\n                             $arXPath = array();\n                             $arXPath['query'] = '(.//. | .//@* | .//namespace::*)['.$node->nodeValue.']';\n-                            $arXpath['namespaces'] = array();\n+                            $arXPath['namespaces'] = array();\n                             $nslist = $xpath->query('./namespace::*', $node);\n                             foreach ($nslist AS $nsnode) {\n                                 if ($nsnode->localName != \"xml\") {\n@@ -554,7 +562,7 @@ public function getRefIDs()\n         $refids = array();\n \n         $xpath = $this->getXPathObj();\n-        $query = \"./secdsig:SignedInfo/secdsig:Reference\";\n+        $query = \"./secdsig:SignedInfo[1]/secdsig:Reference\";\n         $nodeset = $xpath->query($query, $this->sigNode);\n         if ($nodeset->length == 0) {\n             throw new Exception(\"Reference nodes not found\");\n@@ -578,7 +586,7 @@ public function validateReference()\n             }\n         }\n         $xpath = $this->getXPathObj();\n-        $query = \"./secdsig:SignedInfo/secdsig:Reference\";\n+        $query = \"./secdsig:SignedInfo[1]/secdsig:Reference\";\n         $nodeset = $xpath->query($query, $this->sigNode);\n         if ($nodeset->length == 0) {\n             throw new Exception(\"Reference nodes not found\");"
        },
        {
          "filename": "xmlseclibs.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -37,7 +37,7 @@\n  * @author    Robert Richards <rrichards@cdatazone.org>\n  * @copyright 2007-2019 Robert Richards <rrichards@cdatazone.org>\n  * @license   http://www.opensource.org/licenses/bsd-license.php  BSD License\n- * @version   3.0.4-dev\n+ * @version   3.0.4\n  */\n \n $xmlseclibs_srcdir = dirname(__FILE__) . '/src/';"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2bdfd742624d739dfadbd415f00181b4a77aaf07",
            "date": "2024-11-20T21:13:56Z",
            "author_login": "robrichards"
          },
          {
            "sha": "56361cc2970162539ffbaaaaecb8127a715f380f",
            "date": "2024-11-20T13:01:55Z",
            "author_login": "robrichards"
          },
          {
            "sha": "cf50b5023964550d714df76ba9adf21eb6fdaa35",
            "date": "2023-07-31T14:32:47Z",
            "author_login": "DannyvdSluijs"
          },
          {
            "sha": "e899d2b5bbe071455c00601b886a373890390d83",
            "date": "2023-07-17T20:25:50Z",
            "author_login": "robrichards"
          },
          {
            "sha": "158c73571e395d7e50b366ebc6821a2affcbdaae",
            "date": "2023-07-17T20:16:46Z",
            "author_login": "sammarshallou"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-347",
    "description": "Rob Richards XmlSecLibs, all versions prior to v3.0.3, as used for example by SimpleSAMLphp, performed incorrect validation of cryptographic signatures in XML messages, allowing an authenticated attacker to impersonate others or elevate privileges by creating a crafted XML message.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-11-07T20:15:11.090",
    "last_modified": "2024-11-21T04:42:06.050",
    "fix_date": "2019-11-05T11:44:22Z"
  },
  "references": [
    {
      "url": "https://github.com/robrichards/xmlseclibs/commit/0a53d3c3aa87564910cae4ed01416441d3ae0db5",
      "source": "security@debian.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/11/msg00003.html",
      "source": "security@debian.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7KID7C4AZPYYIZQIPSLANP4R2RQR6YK3/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AB34ILMJ67CUROBOR6YPKB46VHXLOAJ4/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BBKVDUZ7G5ZOUO4BFJWLNJ6VOKBQJX5U/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BNFMY5RRLU63P25HEBVDO5KAVI7TX7JV/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ESKJTWLE7QZBQ3EKMYXKMBQG3JDEJWM6/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HBE2SJSXG7J4XYLJ2H6HC2VPPOG2OMUN/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MAWOVYLZKYDCQBLQEJCFAAD3KQTBPHXE/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OCSR3V6LNWJAD37VQB6M2K7P4RQSCVFG/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XBSSRV5Q7JFCYO46A3EN624UZ4KXFQ2M/",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Nov/8",
      "source": "security@debian.org",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://simplesamlphp.org/security/201911-01",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4560",
      "source": "security@debian.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/security/tns-2019-09",
      "source": "security@debian.org",
      "tags": []
    },
    {
      "url": "https://github.com/robrichards/xmlseclibs/commit/0a53d3c3aa87564910cae4ed01416441d3ae0db5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/11/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7KID7C4AZPYYIZQIPSLANP4R2RQR6YK3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AB34ILMJ67CUROBOR6YPKB46VHXLOAJ4/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BBKVDUZ7G5ZOUO4BFJWLNJ6VOKBQJX5U/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BNFMY5RRLU63P25HEBVDO5KAVI7TX7JV/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ESKJTWLE7QZBQ3EKMYXKMBQG3JDEJWM6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HBE2SJSXG7J4XYLJ2H6HC2VPPOG2OMUN/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MAWOVYLZKYDCQBLQEJCFAAD3KQTBPHXE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OCSR3V6LNWJAD37VQB6M2K7P4RQSCVFG/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XBSSRV5Q7JFCYO46A3EN624UZ4KXFQ2M/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Nov/8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://simplesamlphp.org/security/201911-01",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4560",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.tenable.com/security/tns-2019-09",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:09.184591",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xmlseclibs",
    "owner": "robrichards",
    "created_at": "2015-03-31T18:20:11Z",
    "updated_at": "2024-12-27T22:59:34Z",
    "pushed_at": "2024-11-20T21:15:25Z",
    "size": 425,
    "stars": 396,
    "forks": 182,
    "open_issues": 93,
    "watchers": 396,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 131703
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T14:34:58.766457"
  }
}