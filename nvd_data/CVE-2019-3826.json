{
  "cve_id": "CVE-2019-3826",
  "github_data": {
    "repository": "prometheus/prometheus",
    "fix_commit": "62e591f9",
    "related_commits": [
      "62e591f9",
      "62e591f9"
    ],
    "patch_url": "https://github.com/prometheus/prometheus/commit/62e591f9.patch",
    "fix_commit_details": {
      "sha": "62e591f9",
      "commit_date": "2019-01-31T11:13:25Z",
      "author": {
        "login": "gouthamve",
        "type": "User",
        "stats": {
          "total_commits": 302,
          "average_weekly_commits": 0.4755905511811024,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 92
        }
      },
      "commit_message": {
        "title": "*: cut 2.7.1 (#5164)",
        "length": 81,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -1,3 +1,11 @@\n+## 2.7.1 / 2019-01-31\n+\n+This release has a fix for a Stored DOM XSS vulnerability that can be triggered when using the query history functionality. Thanks to Dor Tumarkin from Checkmarx for reporting it.\n+\n+* [BUGFIX/SECURITY] Fix a Stored DOM XSS vulnerability with query history. #5163\n+* [BUGFIX] `prometheus_rule_group_last_duration_seconds` now reports seconds instead of nanoseconds. #5153\n+* [BUGFIX] Make sure the targets are consistently sorted in the targets page. #5161\n+\n ## 2.7.0 / 2019-01-28\n \n We're rolling back the Dockerfile changes introduced in 2.6.0. If you made changes to your docker deployment in 2.6.0, you will need to roll them back. This release also adds experimental support for disk size based retention. To accomodate that we are deprecating the flag `storage.tsdb.retention` in favour of `storage.tsdb.retention.time`. We print a warning if the flag is in use, but it will function without breaking until Prometheus 3.0."
        },
        {
          "filename": "VERSION",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-2.7.0\n+2.7.1"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5303e515afe40966ebac5451a5a27275a6cdfa1a",
            "date": "2025-01-14T14:33:31Z",
            "author_login": "sh0rez"
          },
          {
            "sha": "e5e8f90119808aa4d7ccdd9504ebf5cc2d1b8d11",
            "date": "2025-01-14T14:15:37Z",
            "author_login": "bwplotka"
          },
          {
            "sha": "1e81fd216631913104b37fc6a43312cb3af0eec4",
            "date": "2025-01-13T22:14:05Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "93ca2e6113ab0b47ff782bc04ace63fed7303107",
            "date": "2025-01-13T22:13:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "f34f717b3d714a536fd32a4d25ac310072cf2e1c",
            "date": "2025-01-13T20:57:52Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "A stored, DOM based, cross-site scripting (XSS) flaw was found in Prometheus before version 2.7.1. An attacker could exploit this by convincing an authenticated user to visit a crafted URL on a Prometheus server, allowing for the execution and persistent storage of arbitrary scripts.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-03-26T18:29:00.623",
    "last_modified": "2024-11-21T04:42:37.547",
    "fix_date": "2019-01-31T11:13:25Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHBA-2019:0327",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://advisory.checkmarx.net/advisory/CX-2019-4297",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3826",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/prometheus/prometheus/commit/62e591f9",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/prometheus/prometheus/pull/5163",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r48d5019bd42e0770f7e5351e420a63a41ff1f16924942442c6aff6a8%40%3Ccommits.zookeeper.apache.org%3E",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/r8e3f7da12bf5750b0a02e69a78a61073a2ac950eed7451ce70a65177%40%3Ccommits.zookeeper.apache.org%3E",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/rdf2a0d94c3b5b523aeff7741ae71347415276062811b687f30ea6573%40%3Ccommits.zookeeper.apache.org%3E",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHBA-2019:0327",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://advisory.checkmarx.net/advisory/CX-2019-4297",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-3826",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/prometheus/prometheus/commit/62e591f9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/prometheus/prometheus/pull/5163",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r48d5019bd42e0770f7e5351e420a63a41ff1f16924942442c6aff6a8%40%3Ccommits.zookeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/r8e3f7da12bf5750b0a02e69a78a61073a2ac950eed7451ce70a65177%40%3Ccommits.zookeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.apache.org/thread.html/rdf2a0d94c3b5b523aeff7741ae71347415276062811b687f30ea6573%40%3Ccommits.zookeeper.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:47.004536",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "prometheus",
    "owner": "prometheus",
    "created_at": "2012-11-24T11:14:12Z",
    "updated_at": "2025-01-14T14:33:37Z",
    "pushed_at": "2025-01-14T14:33:32Z",
    "size": 252486,
    "stars": 56826,
    "forks": 9291,
    "open_issues": 731,
    "watchers": 56826,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Go": 7340894,
      "TypeScript": 1135048,
      "Yacc": 36168,
      "Shell": 19069,
      "SCSS": 18605,
      "CSS": 10898,
      "JavaScript": 8143,
      "Makefile": 6812,
      "Lex": 6493,
      "HTML": 4562,
      "Dockerfile": 931
    },
    "commit_activity": {
      "total_commits_last_year": 2815,
      "avg_commits_per_week": 54.13461538461539,
      "days_active_last_year": 314
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:04:40.686171"
  }
}