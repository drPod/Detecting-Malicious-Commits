{
  "cve_id": "CVE-2019-5489",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "574823bfab82d9d8fa47f422778043fbb4b4f50e",
    "related_commits": [
      "574823bfab82d9d8fa47f422778043fbb4b4f50e",
      "574823bfab82d9d8fa47f422778043fbb4b4f50e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "574823bfab82d9d8fa47f422778043fbb4b4f50e",
      "commit_date": "2019-01-06T01:50:59Z",
      "author": {
        "login": "torvalds",
        "type": "User",
        "stats": {
          "total_commits": 38557,
          "average_weekly_commits": 32.37363560033585,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 881
        }
      },
      "commit_message": {
        "title": "Change mincore() to count \"mapped\" pages rather than \"cached\" pages",
        "length": 2149,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 94,
        "additions": 13,
        "deletions": 81
      },
      "files": [
        {
          "filename": "mm/mincore.c",
          "status": "modified",
          "additions": 13,
          "deletions": 81,
          "patch": "@@ -42,72 +42,14 @@ static int mincore_hugetlb(pte_t *pte, unsigned long hmask, unsigned long addr,\n \treturn 0;\n }\n \n-/*\n- * Later we can get more picky about what \"in core\" means precisely.\n- * For now, simply check to see if the page is in the page cache,\n- * and is up to date; i.e. that no page-in operation would be required\n- * at this time if an application were to map and access this page.\n- */\n-static unsigned char mincore_page(struct address_space *mapping, pgoff_t pgoff)\n-{\n-\tunsigned char present = 0;\n-\tstruct page *page;\n-\n-\t/*\n-\t * When tmpfs swaps out a page from a file, any process mapping that\n-\t * file will not get a swp_entry_t in its pte, but rather it is like\n-\t * any other file mapping (ie. marked !present and faulted in with\n-\t * tmpfs's .fault). So swapped out tmpfs mappings are tested here.\n-\t */\n-#ifdef CONFIG_SWAP\n-\tif (shmem_mapping(mapping)) {\n-\t\tpage = find_get_entry(mapping, pgoff);\n-\t\t/*\n-\t\t * shmem/tmpfs may return swap: account for swapcache\n-\t\t * page too.\n-\t\t */\n-\t\tif (xa_is_value(page)) {\n-\t\t\tswp_entry_t swp = radix_to_swp_entry(page);\n-\t\t\tpage = find_get_page(swap_address_space(swp),\n-\t\t\t\t\t     swp_offset(swp));\n-\t\t}\n-\t} else\n-\t\tpage = find_get_page(mapping, pgoff);\n-#else\n-\tpage = find_get_page(mapping, pgoff);\n-#endif\n-\tif (page) {\n-\t\tpresent = PageUptodate(page);\n-\t\tput_page(page);\n-\t}\n-\n-\treturn present;\n-}\n-\n-static int __mincore_unmapped_range(unsigned long addr, unsigned long end,\n-\t\t\t\tstruct vm_area_struct *vma, unsigned char *vec)\n-{\n-\tunsigned long nr = (end - addr) >> PAGE_SHIFT;\n-\tint i;\n-\n-\tif (vma->vm_file) {\n-\t\tpgoff_t pgoff;\n-\n-\t\tpgoff = linear_page_index(vma, addr);\n-\t\tfor (i = 0; i < nr; i++, pgoff++)\n-\t\t\tvec[i] = mincore_page(vma->vm_file->f_mapping, pgoff);\n-\t} else {\n-\t\tfor (i = 0; i < nr; i++)\n-\t\t\tvec[i] = 0;\n-\t}\n-\treturn nr;\n-}\n-\n static int mincore_unmapped_range(unsigned long addr, unsigned long end,\n \t\t\t\t   struct mm_walk *walk)\n {\n-\twalk->private += __mincore_unmapped_range(addr, end,\n-\t\t\t\t\t\t  walk->vma, walk->private);\n+\tunsigned char *vec = walk->private;\n+\tunsigned long nr = (end - addr) >> PAGE_SHIFT;\n+\n+\tmemset(vec, 0, nr);\n+\twalk->private += nr;\n \treturn 0;\n }\n \n@@ -127,8 +69,9 @@ static int mincore_pte_range(pmd_t *pmd, unsigned long addr, unsigned long end,\n \t\tgoto out;\n \t}\n \n+\t/* We'll consider a THP page under construction to be there */\n \tif (pmd_trans_unstable(pmd)) {\n-\t\t__mincore_unmapped_range(addr, end, vma, vec);\n+\t\tmemset(vec, 1, nr);\n \t\tgoto out;\n \t}\n \n@@ -137,28 +80,17 @@ static int mincore_pte_range(pmd_t *pmd, unsigned long addr, unsigned long end,\n \t\tpte_t pte = *ptep;\n \n \t\tif (pte_none(pte))\n-\t\t\t__mincore_unmapped_range(addr, addr + PAGE_SIZE,\n-\t\t\t\t\t\t vma, vec);\n+\t\t\t*vec = 0;\n \t\telse if (pte_present(pte))\n \t\t\t*vec = 1;\n \t\telse { /* pte is a swap entry */\n \t\t\tswp_entry_t entry = pte_to_swp_entry(pte);\n \n-\t\t\tif (non_swap_entry(entry)) {\n-\t\t\t\t/*\n-\t\t\t\t * migration or hwpoison entries are always\n-\t\t\t\t * uptodate\n-\t\t\t\t */\n-\t\t\t\t*vec = 1;\n-\t\t\t} else {\n-#ifdef CONFIG_SWAP\n-\t\t\t\t*vec = mincore_page(swap_address_space(entry),\n-\t\t\t\t\t\t    swp_offset(entry));\n-#else\n-\t\t\t\tWARN_ON(1);\n-\t\t\t\t*vec = 1;\n-#endif\n-\t\t\t}\n+\t\t\t/*\n+\t\t\t * migration or hwpoison entries are always\n+\t\t\t * uptodate\n+\t\t\t */\n+\t\t\t*vec = !!non_swap_entry(entry);\n \t\t}\n \t\tvec++;\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa22f4da2a46b484a257d167c67a2adc1b7aaf68",
            "date": "2025-01-26T00:23:38Z",
            "author_login": "torvalds"
          },
          {
            "sha": "eda061cccd146fcbe71051bb4aa5a8672b71216e",
            "date": "2025-01-26T00:19:10Z",
            "author_login": "torvalds"
          },
          {
            "sha": "08de7f9d4d39fd9aa5e747a13acc891214fa2d5f",
            "date": "2025-01-26T00:12:07Z",
            "author_login": "torvalds"
          },
          {
            "sha": "647d69605c70368d54fc012fce8a43e8e5955b04",
            "date": "2025-01-26T00:03:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "184a0997fb77f4a9527fc867fcd16806776c27ce",
            "date": "2025-01-25T23:59:46Z",
            "author_login": "torvalds"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-319",
    "description": "The mincore() implementation in mm/mincore.c in the Linux kernel through 4.19.13 allowed local attackers to observe page cache access patterns of other processes on the same system, potentially allowing sniffing of secret information. (Fixing this affects the output of the fincore program.) Limited remote exploitation may be possible, as demonstrated by latency differences in accessing public files from an Apache HTTP Server.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-01-07T17:29:00.470",
    "last_modified": "2024-11-21T04:45:02.283",
    "fix_date": "2019-01-06T01:50:59Z"
  },
  "references": [
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=574823bfab82d9d8fa47f422778043fbb4b4f50e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00071.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-06/msg00039.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-06/msg00048.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.huawei.com/en/psirt/security-advisories/huawei-sa-20200115-01-pagecache-en",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/106478",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2029",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2043",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2473",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2808",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2809",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2837",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:3309",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:3517",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:3967",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4056",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4057",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4058",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4159",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4164",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4255",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0204",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://arxiv.org/abs/1901.01161",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1120843",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/574823bfab82d9d8fa47f422778043fbb4b4f50e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/06/msg00010.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/06/msg00011.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Jun/26",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20190307-0001/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4465",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2020.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.theregister.co.uk/2019/01/05/boffins_beat_page_cache/",
      "source": "cve@mitre.org",
      "tags": [
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=574823bfab82d9d8fa47f422778043fbb4b4f50e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-05/msg00071.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-06/msg00039.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2019-06/msg00048.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.huawei.com/en/psirt/security-advisories/huawei-sa-20200115-01-pagecache-en",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.securityfocus.com/bid/106478",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2029",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2043",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2473",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2808",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2809",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2837",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:3309",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:3517",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:3967",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4056",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4057",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4058",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4159",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4164",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:4255",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2020:0204",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://arxiv.org/abs/1901.01161",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1120843",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/574823bfab82d9d8fa47f422778043fbb4b4f50e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/06/msg00010.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2019/06/msg00011.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2019/Jun/26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20190307-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2019/dsa-4465",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.theregister.co.uk/2019/01/05/boffins_beat_page_cache/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Technical Description",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:42.226910",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-14T12:39:03Z",
    "pushed_at": "2025-01-13T17:27:04Z",
    "size": 5361369,
    "stars": 185823,
    "forks": 54743,
    "open_issues": 437,
    "watchers": 185823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1326937103,
      "Assembly": 9568292,
      "Shell": 5072004,
      "Python": 2974128,
      "Makefile": 2713905,
      "Perl": 1253637,
      "Rust": 807711,
      "Roff": 202277,
      "C++": 173382,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71321,
      "Awk": 69539,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10172,
      "M4": 3329,
      "MATLAB": 2482,
      "sed": 2433,
      "Clojure": 2411,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 46007,
      "avg_commits_per_week": 884.75,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:59.486675"
  }
}