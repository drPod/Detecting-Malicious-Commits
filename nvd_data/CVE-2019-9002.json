{
  "cve_id": "CVE-2019-9002",
  "github_data": {
    "repository": "pixeline/bugs",
    "fix_commit": "9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41",
    "related_commits": [
      "9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41",
      "9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41"
    ],
    "patch_url": "https://github.com/pixeline/bugs/commit/9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41.patch",
    "fix_commit_details": {
      "sha": "9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41",
      "commit_date": "2019-02-20T14:08:03Z",
      "author": {
        "login": "Patriboom",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "config-setup deleted after install ... safety concern",
        "length": 53,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 57,
        "additions": 38,
        "deletions": 19
      },
      "files": [
        {
          "filename": "install/config-setup.php",
          "status": "modified",
          "additions": 27,
          "deletions": 17,
          "patch": "@@ -79,7 +79,7 @@ function ChgLng(Lng = 'en') {\n \t}\n \t//From the freshly made mysql-structure.php file, we'll create tables and default data along the install.php process\n \trequire \"./install.php\";\n-\t$install = new install();\r\n+\t$install = new install();\n \t$database_check = $install->check_connect();\r\n \t$install->config = require '../config.app.php';\n \t$install->create_database($_POST);\n@@ -219,7 +219,16 @@ function ChgLng(Lng = 'en') {\n \t\t\t<tr>\n \t\t\t\t<th><?php echo $MyLng['Email_port']; ?></th>\n \t\t\t\t<td>\n-\t\t\t\t\t<input type=\"text\" name=\"email_port\" value=\"\" placeholder=\"default: 25; gmail: 587\" />\n+\t\t\t\t\t<select name=\"email_port\">\n+\t\t\t\t\t<option value=\"25\"> 25 (default)</option>\n+\t\t\t\t\t<option value=\"587\">587 (gmail)</option>\n+\t\t\t\t\t<option value=\"465\">465 (SSL / TLS)</option>\n+\t\t\t\t\t<?php\n+\t\t\t\t\t\tfor ($x=1; $x<999; $x++) {\n+\t\t\t\t\t\t\techo '<option value=\"'.$x.'\">'.$x.'</option>';\n+\t\t\t\t\t\t}\n+\t\t\t\t\t?>\n+\t\t\t\t\t</select>\n \t\t\t\t</td>\n \t\t\t</tr>\n \t\t\t<tr>\n@@ -253,21 +262,22 @@ function ChgLng(Lng = 'en') {\n \t\t\t\t<th><?php echo $MyLng['Time_Timezone']; ?></th>\n \t\t\t\t<td>\n \t\t\t\t\t<select name=\"timezone\">\n-<?php\n-$timezones = timezone_identifiers_list();\n-\n-echo 'select name=\"timezone\" size=\"10\">' . \"\\n\";\n-\n-foreach($timezones as $timezone)\n-{\n-  echo '<option';\n-  echo $timezone == 'Europe/Brussels' ? ' selected' : '';\n-  echo '>' . $timezone . '</option>' . \"\\n\";\n-}\n-\n-echo '</select>' . \"\\n\";\n-?>\n-\t\t\t\t\t\t</select>\n+\t\t\t\t\t\t<?php\n+\t\t\t\t\t\t$timezones = timezone_identifiers_list();\n+\t\t\t\t\t\t\n+\t\t\t\t\t\techo 'select name=\"timezone\" size=\"10\">' . \"\\n\";\n+\t\t\t\t\t\t\n+\t\t\t\t\t\tforeach($timezones as $timezone)\n+\t\t\t\t\t\t{\n+\t\t\t\t\t\t  echo '<option';\n+//\t\t\t\t\t\t  echo $timezone == 'Europe/Brussels' ? ' selected' : '';\n+\t\t\t\t\t\t  echo $timezone == date(\"e\") ? ' selected' : '';\n+\t\t\t\t\t\t  echo '>' . $timezone . '</option>' . \"\\n\";\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\t\n+\t\t\t\t\t\techo '</select>' . \"\\n\";\n+\t\t\t\t\t\t?>\n+\t\t\t\t\t</select>\n \t\t\t\t\t</td>\n \t\t\t\t</tr>\n \t\t\t\t<tr>"
        },
        {
          "filename": "install/index.php",
          "status": "modified",
          "additions": 11,
          "deletions": 2,
          "patch": "@@ -3,7 +3,15 @@\n $EnLng = require_once(\"../app/application/language/en/install.php\");\n if (!isset($_GET[\"Lng\"]) || !file_exists(\"../app/application/language/\".@$_GET[\"Lng\"].\"/install.php\")) { $_GET[\"Lng\"] = 'en'; }\n if (@$_GET[\"Lng\"] != 'en' ) { $MyLng = require_once(\"../app/application/language/\".$_GET[\"Lng\"].\"/install.php\"); $MyLng = array_merge($EnLng, $MyLng); } else {$MyLng = $EnLng; }\r\n-require './config-setup.php';\r\n+if (!file_exists('./config-setup.php')) {\n+\techo '<script>';\n+\techo 'alert(\"Install already has been proceessed\");';\n+\techo 'document.location.href=\"../index.php\";';\n+\techo '</script>';\n+\tdie();\n+} else {\n+\trequire './config-setup.php';\n+}\r\n require '../app/laravel/hash.php';\r\n require '../app/laravel/str.php';\r\n \r\n@@ -30,7 +38,8 @@\n \t\t\t\t$_SESSION[\"Msg\"] .= '<p style=\"color: #060;\">'.$MyLng['Complete_presentation'].'</p>';\n \t\t\t\t$_SESSION[\"usr\"] = $_POST['email'];  \r\n \t\t\t\t$_SESSION[\"psw\"] = $_POST['password'];  \r\n-\t\t\t\t//header('location: complete.php?Lng=fr');\r\n+\t\t\t\t//header('location: complete.php?Lng=fr');\n+\t\t\t\tunlink (\"./config-setup.php\");\r\n \t\t\t\theader('location: ../');\r\n \t\t\t\tdie();\r\n \t\t\t}\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2f676596ed464eb66b746b5b359713c2a71a55cd",
            "date": "2022-11-11T03:01:34Z",
            "author_login": "Patriboom"
          },
          {
            "sha": "f01f231fdb0f3ac6bcce9c4b603ede3685da33b7",
            "date": "2022-11-11T02:59:53Z",
            "author_login": "Patriboom"
          },
          {
            "sha": "b73916639cb5d0b00c23c4546ec43246d805959b",
            "date": "2022-11-11T02:56:38Z",
            "author_login": "Patriboom"
          },
          {
            "sha": "abc7dd8e50f7143ecf1e3b5995bf3c1ca33a1352",
            "date": "2022-11-11T02:55:42Z",
            "author_login": "Patriboom"
          },
          {
            "sha": "4ddcd55dfd9cffeb4c0b2d151736e5ce20fab1e0",
            "date": "2022-10-13T22:20:10Z",
            "author_login": "Patriboom"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-862",
    "description": "An issue was discovered in Tiny Issue 1.3.1 and pixeline Bugs through 1.3.2c. install/config-setup.php allows remote attackers to execute arbitrary PHP code via the database_host parameter if the installer remains present in its original directory after installation is completed.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2019-02-22T07:29:00.240",
    "last_modified": "2024-11-21T04:50:47.490",
    "fix_date": "2019-02-20T14:08:03Z"
  },
  "references": [
    {
      "url": "https://github.com/mikelbring/tinyissue/issues/237",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pixeline/bugs/commit/9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mikelbring/tinyissue/issues/237",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pixeline/bugs/commit/9d2d3fcdea22e94f7b497f6ed83791ab3a31ee41",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:44.487676",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bugs",
    "owner": "pixeline",
    "created_at": "2014-08-26T18:27:25Z",
    "updated_at": "2024-09-27T14:12:02Z",
    "pushed_at": "2022-11-11T03:01:34Z",
    "size": 16850,
    "stars": 88,
    "forks": 24,
    "open_issues": 2,
    "watchers": 88,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 1845126,
      "CSS": 231404,
      "JavaScript": 106878,
      "HTML": 24514,
      "Blade": 3588,
      "Hack": 650
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:44:03.887913"
  }
}