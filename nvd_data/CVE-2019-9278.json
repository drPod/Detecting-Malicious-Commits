{
  "cve_id": "CVE-2019-9278",
  "github_data": {
    "repository": "libexif/libexif",
    "fix_commit": "75aa73267fdb1e0ebfbc00369e7312bac43d0566",
    "related_commits": [
      "75aa73267fdb1e0ebfbc00369e7312bac43d0566",
      "75aa73267fdb1e0ebfbc00369e7312bac43d0566"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "75aa73267fdb1e0ebfbc00369e7312bac43d0566",
      "commit_date": "2020-01-18T08:29:42Z",
      "author": {
        "login": "msmeissn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix CVE-2019-9278",
        "length": 375,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 18,
        "deletions": 10
      },
      "files": [
        {
          "filename": "libexif/exif-data.c",
          "status": "modified",
          "additions": 18,
          "deletions": 10,
          "patch": "@@ -192,9 +192,15 @@ exif_data_load_data_entry (ExifData *data, ExifEntry *entry,\n \t\tdoff = offset + 8;\n \n \t/* Sanity checks */\n-\tif ((doff + s < doff) || (doff + s < s) || (doff + s > size)) {\n+\tif (doff >= size) {\n \t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n-\t\t\t\t  \"Tag data past end of buffer (%u > %u)\", doff+s, size);\t\n+\t\t\t\t  \"Tag starts past end of buffer (%u > %u)\", doff, size);\n+\t\treturn 0;\n+\t}\n+\n+\tif (s > size - doff) {\n+\t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n+\t\t\t\t  \"Tag data goes past end of buffer (%u > %u)\", doff+s, size);\n \t\treturn 0;\n \t}\n \n@@ -315,13 +321,14 @@ exif_data_load_data_thumbnail (ExifData *data, const unsigned char *d,\n \t\t\t       unsigned int ds, ExifLong o, ExifLong s)\n {\n \t/* Sanity checks */\n-\tif ((o + s < o) || (o + s < s) || (o + s > ds) || (o > ds)) {\n-\t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n-\t\t\t  \"Bogus thumbnail offset (%u) or size (%u).\",\n-\t\t\t  o, s);\n+\tif (o >= ds) {\n+\t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\", \"Bogus thumbnail offset (%u).\", o);\n+\t\treturn;\n+\t}\n+\tif (s > ds - o) {\n+\t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\", \"Bogus thumbnail size (%u), max would be %u.\", s, ds-o);\n \t\treturn;\n \t}\n-\n \tif (data->data) \n \t\texif_mem_free (data->priv->mem, data->data);\n \tif (!(data->data = exif_data_alloc (data, s))) {\n@@ -947,7 +954,7 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,\n \texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\", \n \t\t  \"IFD 0 at %i.\", (int) offset);\n \n-\t/* Sanity check the offset, being careful about overflow */\n+\t/* ds is restricted to 16 bit above, so offset is restricted too, and offset+8 should not overflow. */\n \tif (offset > ds || offset + 6 + 2 > ds)\n \t\treturn;\n \n@@ -956,6 +963,7 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,\n \n \t/* IFD 1 offset */\n \tn = exif_get_short (d + 6 + offset, data->priv->order);\n+\t/* offset < 2<<16, n is 16 bit at most, so this op will not overflow */\n \tif (offset + 6 + 2 + 12 * n + 4 > ds)\n \t\treturn;\n \n@@ -964,8 +972,8 @@ exif_data_load_data (ExifData *data, const unsigned char *d_orig,\n \t\texif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, \"ExifData\",\n \t\t\t  \"IFD 1 at %i.\", (int) offset);\n \n-\t\t/* Sanity check. */\n-\t\tif (offset > ds || offset + 6 > ds) {\n+\t\t/* Sanity check. ds is ensured to be above 6 above, offset is 16bit */\n+\t\tif (offset > ds - 6) {\n \t\t\texif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,\n \t\t\t\t  \"ExifData\", \"Bogus offset of IFD1.\");\n \t\t} else {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "859cc8832fd86919db8d0bdad598180b1bac3315",
            "date": "2025-01-17T14:36:10Z",
            "author_login": "msmeissn"
          },
          {
            "sha": "e99f14785ef02ee249bccbad8a97595eadbab810",
            "date": "2025-01-17T14:26:41Z",
            "author_login": "msmeissn"
          },
          {
            "sha": "9fd952fb179428ab7f09be232d8b355b4b249e7f",
            "date": "2025-01-16T09:36:28Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "f554c2226f429a5d9498b0412530f03a7676defc",
            "date": "2025-01-16T09:35:59Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "8f013418c2ee71f7aaa81b1699e48d9d3c22dd9b",
            "date": "2025-01-07T10:36:30Z",
            "author_login": "msmeissn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-190",
    "description": "In libexif, there is a possible out of bounds write due to an integer overflow. This could lead to remote escalation of privilege in the media content provider with no additional execution privileges needed. User interaction is needed for exploitation. Product: AndroidVersions: Android-10Android ID: A-112537774",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2019-09-27T19:15:19.060",
    "last_modified": "2024-11-21T04:51:20.630",
    "fix_date": "2020-01-18T08:29:42Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00000.html",
      "source": "security@android.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-06/msg00017.html",
      "source": "security@android.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/10/25/17",
      "source": "security@android.com",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/10/27/1",
      "source": "security@android.com",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/11/07/1",
      "source": "security@android.com",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://github.com/libexif/libexif/commit/75aa73267fdb1e0ebfbc00369e7312bac43d0566",
      "source": "security@android.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libexif/libexif/issues/26",
      "source": "security@android.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/02/msg00007.html",
      "source": "security@android.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MO2VTHD7OLPJDCJBHKUQTBAHZOBBCF6X/",
      "source": "security@android.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VA5BPQLOFXIZOOJHBYDU635Z5KLUMTDD/",
      "source": "security@android.com",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2020/Feb/9",
      "source": "security@android.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202007-05",
      "source": "security@android.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://source.android.com/security/bulletin/android-10",
      "source": "security@android.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4277-1/",
      "source": "security@android.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4618",
      "source": "security@android.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00000.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-06/msg00017.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/10/25/17",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/10/27/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2019/11/07/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://github.com/libexif/libexif/commit/75aa73267fdb1e0ebfbc00369e7312bac43d0566",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libexif/libexif/issues/26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/02/msg00007.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MO2VTHD7OLPJDCJBHKUQTBAHZOBBCF6X/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VA5BPQLOFXIZOOJHBYDU635Z5KLUMTDD/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://seclists.org/bugtraq/2020/Feb/9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202007-05",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://source.android.com/security/bulletin/android-10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4277-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4618",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T22:59:59.917283",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libexif",
    "owner": "libexif",
    "created_at": "2017-12-01T00:54:13Z",
    "updated_at": "2025-01-09T03:14:32Z",
    "pushed_at": "2025-01-13T18:29:49Z",
    "size": 5369,
    "stars": 313,
    "forks": 99,
    "open_issues": 30,
    "watchers": 313,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 612663,
      "M4": 45906,
      "C++": 32391,
      "Makefile": 18426,
      "Shell": 10687
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T17:18:55.970818"
  }
}