{
  "cve_id": "CVE-2020-10236",
  "github_data": {
    "repository": "Froxlor/Froxlor",
    "fix_commit": "6b09720ef8a1cc008751dd0ca0140a0597fedce5",
    "related_commits": [
      "6b09720ef8a1cc008751dd0ca0140a0597fedce5",
      "6b09720ef8a1cc008751dd0ca0140a0597fedce5"
    ],
    "patch_url": "https://github.com/Froxlor/Froxlor/commit/6b09720ef8a1cc008751dd0ca0140a0597fedce5.patch",
    "fix_commit_details": {
      "sha": "6b09720ef8a1cc008751dd0ca0140a0597fedce5",
      "commit_date": "2020-03-04T18:34:18Z",
      "author": {
        "login": "d00p",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "use unpredictable tmpfile-name in installation if lib/userdata.inc.php cannot be written due to permission",
        "length": 158,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 27,
        "additions": 16,
        "deletions": 11
      },
      "files": [
        {
          "filename": "install/lib/class.FroxlorInstall.php",
          "status": "modified",
          "additions": 13,
          "deletions": 8,
          "patch": "@@ -338,15 +338,20 @@ private function _createUserdataConf()\n \t\t\t@fclose($fp);\n \t\t\t$content .= $this->_status_message('green', 'OK');\n \t\t\tchmod($userdata_file, 0440);\n-\t\t} elseif ($fp = @fopen('/tmp/userdata.inc.php', 'w')) {\n-\t\t\t$result = @fputs($fp, $userdata, strlen($userdata));\n-\t\t\t@fclose($fp);\n-\t\t\t$content .= $this->_status_message('orange', $this->_lng['install']['creating_configfile_temp']);\n-\t\t\tchmod('/tmp/userdata.inc.php', 0440);\n \t\t} else {\n-\t\t\t$content .= $this->_status_message('red', $this->_lng['install']['creating_configfile_failed']);\n-\t\t\t$escpduserdata = nl2br(htmlspecialchars($userdata));\n-\t\t\teval(\"\\$content .= \\\"\" . $this->_getTemplate(\"textarea\") . \"\\\";\");\n+\t\t\t// try creating it in a temporary file\n+\t\t\t$temp_file = tempnam(sys_get_temp_dir(), 'fx');\n+\t\t\tif (touch($temp_file)) {\n+\t\t\t\tchmod($temp_file, 0400);\n+\t\t\t\t$fp = @fopen($temp_file, 'w');\n+\t\t\t\t$result = @fputs($fp, $userdata, strlen($userdata));\n+\t\t\t\t@fclose($fp);\n+\t\t\t\t$content .= $this->_status_message('orange', sprintf($this->_lng['install']['creating_configfile_temp'], $temp_file));\n+\t\t\t} else {\n+\t\t\t\t$content .= $this->_status_message('red', $this->_lng['install']['creating_configfile_failed']);\n+\t\t\t\t$escpduserdata = nl2br(htmlspecialchars($userdata));\n+\t\t\t\teval(\"\\$content .= \\\"\" . $this->_getTemplate(\"textarea\") . \"\\\";\");\n+\t\t\t}\n \t\t}\n \n \t\treturn $content;"
        },
        {
          "filename": "install/lng/english.lng.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -86,7 +86,7 @@\n $lng['install']['creating_entries'] = 'Inserting new values...';\n $lng['install']['adding_admin_user'] = 'Creating admin-account...';\n $lng['install']['creating_configfile'] = 'Creating configfile...';\n-$lng['install']['creating_configfile_temp'] = 'File was saved in /tmp/userdata.inc.php, please move to ' . dirname(dirname(__DIR__)) . '/lib/.';\n+$lng['install']['creating_configfile_temp'] = 'File was saved in %s, please move to ' . dirname(dirname(__DIR__)) . '/lib/userdata.inc.php';\n $lng['install']['creating_configfile_failed'] = 'Could not create ' . dirname(dirname(__DIR__)) . '/lib/userdata.inc.php, please create it manually with the following content:';\n $lng['install']['froxlor_succ_installed'] = 'Froxlor was installed successfully.';\n "
        },
        {
          "filename": "install/lng/french.lng.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -76,7 +76,7 @@\n $lng['install']['creating_entries'] = 'Insertion des nouvelles valeurs...';\n $lng['install']['adding_admin_user'] = 'Cr\u00e9ation du compte administrateur...';\n $lng['install']['creating_configfile'] = 'Cr\u00e9ation du fichier de configuration...';\n-$lng['install']['creating_configfile_temp'] = 'Le fichier a \u00e9t\u00e9 enregistr\u00e9 dans /tmp/userdata.inc.php, merci de le d\u00e9placer dans ' . dirname(dirname(__DIR__)) . '/lib/.';\n+$lng['install']['creating_configfile_temp'] = 'Le fichier a \u00e9t\u00e9 enregistr\u00e9 dans %s, merci de le d\u00e9placer dans ' . dirname(dirname(__DIR__)) . '/lib/userdata.inc.php';\n $lng['install']['creating_configfile_failed'] = 'Impossible de cr\u00e9er ' . dirname(dirname(__DIR__)) . '/lib/userdata.inc.php, merci de le cr\u00e9er manuellement avec le contenu suivant:';\n $lng['install']['froxlor_succ_installed'] = 'Froxlor a \u00e9t\u00e9 install\u00e9 avec succ\u00e8s.';\n "
        },
        {
          "filename": "install/lng/german.lng.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -86,7 +86,7 @@\n $lng['install']['creating_entries'] = 'Trage neue Werte ein...';\n $lng['install']['adding_admin_user'] = 'Erstelle Admin-Benutzer...';\n $lng['install']['creating_configfile'] = 'Erstelle Konfigurationsdatei...';\n-$lng['install']['creating_configfile_temp'] = 'Datei wurde in /tmp/userdata.inc.php gespeichert, bitte nach ' . dirname(dirname(__DIR__)) . '/lib/ verschieben.';\n+$lng['install']['creating_configfile_temp'] = 'Datei wurde in %s gespeichert, bitte nach ' . dirname(dirname(__DIR__)) . '/lib/userdata.inc.php verschieben.';\n $lng['install']['creating_configfile_failed'] = 'Konnte ' . dirname(dirname(__DIR__)) . '/lib/userdata.inc.php nicht erstellen, bitte manuell mit folgendem Inhalt anlegen:';\n $lng['install']['froxlor_succ_installed'] = 'Froxlor wurde erfolgreich installiert.';\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec42003367df64c5645a9d5ee5bcd95c75a82b6c",
            "date": "2025-01-12T15:53:05Z",
            "author_login": "d00p"
          },
          {
            "sha": "fde43f80600f1035e1e3d2297411b666d805549a",
            "date": "2025-01-12T09:27:44Z",
            "author_login": "d00p"
          },
          {
            "sha": "a43d53d54034805e3e404702a01312fa0c40b623",
            "date": "2025-01-12T09:27:02Z",
            "author_login": "d00p"
          },
          {
            "sha": "3638dc08ea4fe55ce0d2458cdcb436cfb5697ed3",
            "date": "2024-12-24T08:34:59Z",
            "author_login": "d00p"
          },
          {
            "sha": "c2d166c86666f4c50c1402c1b3a2986ddabeee90",
            "date": "2024-12-19T07:59:00Z",
            "author_login": "d00p"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:H",
    "cwe_id": "CWE-20",
    "description": "An issue was discovered in Froxlor before 0.10.14. It created files with static names in /tmp during installation if the installation directory was not writable. This allowed local attackers to cause DoS or disclose information out of the config files, because of _createUserdataConf in install/lib/class.FroxlorInstall.php.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-03-09T16:15:12.140",
    "last_modified": "2024-11-21T04:55:01.773",
    "fix_date": "2020-03-04T18:34:18Z"
  },
  "references": [
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1165718",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Froxlor/Froxlor/commit/6b09720ef8a1cc008751dd0ca0140a0597fedce5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Froxlor/Froxlor/compare/0.10.13...0.10.14",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1165718",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Froxlor/Froxlor/commit/6b09720ef8a1cc008751dd0ca0140a0597fedce5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Froxlor/Froxlor/compare/0.10.13...0.10.14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:39.883354",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Froxlor",
    "owner": "Froxlor",
    "created_at": "2012-03-06T15:14:46Z",
    "updated_at": "2025-01-12T15:57:15Z",
    "pushed_at": "2025-01-12T15:57:10Z",
    "size": 28867,
    "stars": 1651,
    "forks": 457,
    "open_issues": 35,
    "watchers": 1651,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "extras",
      "main"
    ],
    "languages": {
      "PHP": 3752037,
      "Twig": 153143,
      "HTML": 28494,
      "SCSS": 8015,
      "JavaScript": 942
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:29:33.083399"
  }
}