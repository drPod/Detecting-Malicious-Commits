{
  "cve_id": "CVE-2020-10758",
  "github_data": {
    "repository": "keycloak/keycloak",
    "fix_commit": "bee4ca89897766c4b68856eafe14f1a3dad34251",
    "related_commits": [
      "bee4ca89897766c4b68856eafe14f1a3dad34251",
      "bee4ca89897766c4b68856eafe14f1a3dad34251"
    ],
    "patch_url": "https://github.com/keycloak/keycloak/commit/bee4ca89897766c4b68856eafe14f1a3dad34251.patch",
    "fix_commit_details": {
      "sha": "bee4ca89897766c4b68856eafe14f1a3dad34251",
      "commit_date": "2020-06-25T09:31:05Z",
      "author": {
        "login": "tkyjovsk",
        "type": "User",
        "stats": {
          "total_commits": 161,
          "average_weekly_commits": 0.2669983416252073,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 72
        }
      },
      "commit_message": {
        "title": "KEYCLOAK-14872 CL DoS",
        "length": 196,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 87,
        "additions": 85,
        "deletions": 2
      },
      "files": [
        {
          "filename": "distribution/feature-packs/server-feature-pack/src/main/resources/content/bin/migrate-domain-clustered.cli",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -695,6 +695,26 @@ if (result != fixed) of /profile=$clusteredProfile/subsystem=keycloak-server/spi\n     end-try\n end-if\n \n+# Migrate from 8.0.0 to 9.0.5\n+\n+if (result == 120000 || result == undefined) of /profile=$clusteredProfile/subsystem=undertow/server=default-server/http-listener=default/:read-attribute(name=read-timeout)\n+    echo Updating value of http listener read-timeout.\n+    /profile=$clusteredProfile/subsystem=undertow/server=default-server/http-listener=default/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 120000 || result == undefined) of /profile=$clusteredProfile/subsystem=undertow/server=default-server/https-listener=https/:read-attribute(name=read-timeout)\n+    echo Updating value of https listener read-timeout.\n+    /profile=$clusteredProfile/subsystem=undertow/server=default-server/https-listener=https/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 20 || result == undefined) of /profile=$clusteredProfile/subsystem=datasources/data-source=KeycloakDS/:read-attribute(name=max-pool-size)\n+    echo Updating value of datasource max-pool-size.\n+    /profile=$clusteredProfile/subsystem=datasources/data-source=KeycloakDS/:write-attribute(name=max-pool-size,value=100)\n+    echo\n+end-if\n+\n # Migrate from 10.0.2 to 11.0.0 (migration changes for infinispan update from 9.4.18.Final to 10.1.8.Final)\n \n if (result != org.keycloak.keycloak-model-infinispan) of /profile=$clusteredProfile/subsystem=infinispan/cache-container=keycloak:read-attribute(name=module)"
        },
        {
          "filename": "distribution/feature-packs/server-feature-pack/src/main/resources/content/bin/migrate-domain-standalone.cli",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -596,6 +596,26 @@ if (result != fixed) of /profile=$standaloneProfile/subsystem=keycloak-server/sp\n     end-try\n end-if\n \n+# Migrate from 8.0.0 to 9.0.5\n+\n+if (result == 120000 || result == undefined) of /profile=$standaloneProfile/subsystem=undertow/server=default-server/http-listener=default/:read-attribute(name=read-timeout)\n+    echo Updating value of http listener read-timeout.\n+    /profile=$standaloneProfile/subsystem=undertow/server=default-server/http-listener=default/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 120000 || result == undefined) of /profile=$standaloneProfile/subsystem=undertow/server=default-server/https-listener=https/:read-attribute(name=read-timeout)\n+    echo Updating value of https listener read-timeout.\n+    /profile=$standaloneProfile/subsystem=undertow/server=default-server/https-listener=https/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 20 || result == undefined) of /profile=$standaloneProfile/subsystem=datasources/data-source=KeycloakDS/:read-attribute(name=max-pool-size)\n+    echo Updating value of datasource max-pool-size.\n+    /profile=$standaloneProfile/subsystem=datasources/data-source=KeycloakDS/:write-attribute(name=max-pool-size,value=100)\n+    echo\n+end-if\n+\n # Migrate from 10.0.2 to 11.0.0 (migration changes for infinispan update from 9.4.18.Final to 10.1.8.Final)\n \n if (result != org.keycloak.keycloak-model-infinispan) of /profile=$standaloneProfile/subsystem=infinispan/cache-container=keycloak:read-attribute(name=module)"
        },
        {
          "filename": "distribution/feature-packs/server-feature-pack/src/main/resources/content/bin/migrate-standalone-ha.cli",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -774,6 +774,26 @@ if (result != fixed) of /subsystem=keycloak-server/spi=hostname/:read-attribute(\n     end-try\n end-if\n \n+# Migrate from 8.0.0 to 9.0.5\n+\n+if (result == 120000 || result == undefined) of /subsystem=undertow/server=default-server/http-listener=default/:read-attribute(name=read-timeout)\n+    echo Updating value of http listener read-timeout.\n+    /subsystem=undertow/server=default-server/http-listener=default/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 120000 || result == undefined) of /subsystem=undertow/server=default-server/https-listener=https/:read-attribute(name=read-timeout)\n+    echo Updating value of https listener read-timeout.\n+    /subsystem=undertow/server=default-server/https-listener=https/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 20 || result == undefined) of /subsystem=datasources/data-source=KeycloakDS/:read-attribute(name=max-pool-size)\n+    echo Updating value of datasource max-pool-size.\n+    /subsystem=datasources/data-source=KeycloakDS/:write-attribute(name=max-pool-size,value=100)\n+    echo\n+end-if\n+\n # Migrate from 10.0.2 to 11.0.0 (migration changes for infinispan update from 9.4.18.Final to 10.1.8.Final)\n \n if (result != org.keycloak.keycloak-model-infinispan) of /subsystem=infinispan/cache-container=keycloak:read-attribute(name=module)"
        },
        {
          "filename": "distribution/feature-packs/server-feature-pack/src/main/resources/content/bin/migrate-standalone.cli",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -639,6 +639,26 @@ if (result != fixed) of /subsystem=keycloak-server/spi=hostname/:read-attribute(\n     end-try\n end-if\n \n+# Migrate from 8.0.0 to 9.0.5\n+\n+if (result == 120000 || result == undefined) of /subsystem=undertow/server=default-server/http-listener=default/:read-attribute(name=read-timeout)\n+    echo Updating value of http listener read-timeout.\n+    /subsystem=undertow/server=default-server/http-listener=default/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 120000 || result == undefined) of /subsystem=undertow/server=default-server/https-listener=https/:read-attribute(name=read-timeout)\n+    echo Updating value of https listener read-timeout.\n+    /subsystem=undertow/server=default-server/https-listener=https/:write-attribute(name=read-timeout,value=30000)\n+    echo\n+end-if\n+\n+if (result == 20 || result == undefined) of /subsystem=datasources/data-source=KeycloakDS/:read-attribute(name=max-pool-size)\n+    echo Updating value of datasource max-pool-size.\n+    /subsystem=datasources/data-source=KeycloakDS/:write-attribute(name=max-pool-size,value=100)\n+    echo\n+end-if\n+\n # Migrate from 10.0.2 to 11.0.0 (migration changes for infinispan update from 9.4.18.Final to 10.1.8.Final)\n \n if (result != org.keycloak.keycloak-model-infinispan) of /subsystem=infinispan/cache-container=keycloak:read-attribute(name=module)"
        },
        {
          "filename": "wildfly/server-subsystem/src/main/resources/subsystem-templates/keycloak-datasources.xml",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -36,6 +36,9 @@\n                     <user-name>sa</user-name>\n                     <password>sa</password>\n                 </security>\n+                <pool>\n+                    <max-pool-size>100</max-pool-size>\n+                </pool>\n             </datasource>\n             <drivers>\n                 <driver name=\"h2\" module=\"com.h2database.h2\">"
        },
        {
          "filename": "wildfly/server-subsystem/src/main/resources/subsystem-templates/keycloak-undertow.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -28,8 +28,8 @@\n         <buffer-cache name=\"default\"/>\n         <server name=\"default-server\">\n             <?AJP?>\n-            <http-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\" enable-http2=\"true\"/>\n-            <https-listener name=\"https\" socket-binding=\"https\" security-realm=\"ApplicationRealm\" enable-http2=\"true\"/>\n+            <http-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\" enable-http2=\"true\" read-timeout=\"30000\"/>\n+            <https-listener name=\"https\" socket-binding=\"https\" security-realm=\"ApplicationRealm\" enable-http2=\"true\" read-timeout=\"30000\"/>\n             <host name=\"default-host\" alias=\"localhost\">\n                 <location name=\"/\" handler=\"welcome-content\"/>\n                 <http-invoker security-realm=\"ApplicationRealm\"/>"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "388fa5a3ebae20d1bdf8f92ee3ad29fbe438a622",
            "date": "2025-01-14T13:32:03Z",
            "author_login": "stianst"
          },
          {
            "sha": "01f5a8c1c3e97944f8919c11338b1cebed9056ee",
            "date": "2025-01-14T12:20:01Z",
            "author_login": "stianst"
          },
          {
            "sha": "53a2ed6fdbd8673e9b914f650e598cd9122763e6",
            "date": "2025-01-14T12:02:51Z",
            "author_login": "SebastEnn"
          },
          {
            "sha": "8ddf94ca3b0a3c34fe1441fe24cf90a063d3ae3f",
            "date": "2025-01-14T11:22:01Z",
            "author_login": "Yogu"
          },
          {
            "sha": "6322554da02c5fd425ebfcbb5f1c25ca2cbc158d",
            "date": "2025-01-13T17:15:20Z",
            "author_login": "ahus1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-770",
    "description": "A vulnerability was found in Keycloak before 11.0.1 where DoS attack is possible by sending twenty requests simultaneously to the specified keycloak server, all with a Content-Length header value that exceeds the actual byte count of the request body.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-09-16T16:15:14.797",
    "last_modified": "2024-11-21T04:56:00.697",
    "fix_date": "2020-06-25T09:31:05Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1843849",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/keycloak/keycloak/commit/bee4ca89897766c4b68856eafe14f1a3dad34251",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1843849",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/keycloak/keycloak/commit/bee4ca89897766c4b68856eafe14f1a3dad34251",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:03.833757",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "keycloak",
    "owner": "keycloak",
    "created_at": "2013-07-02T13:38:51Z",
    "updated_at": "2025-01-14T13:32:13Z",
    "pushed_at": "2025-01-14T14:08:52Z",
    "size": 519673,
    "stars": 24649,
    "forks": 6948,
    "open_issues": 1920,
    "watchers": 24649,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release/22.0",
      "release/24.0",
      "release/26.0",
      "release/26.1"
    ],
    "languages": {
      "Java": 35124416,
      "TypeScript": 3242946,
      "FreeMarker": 278229,
      "JavaScript": 136844,
      "CSS": 44624,
      "Shell": 35073,
      "XSLT": 31908,
      "HTML": 10031,
      "mupad": 8593,
      "Mustache": 5212,
      "Groovy": 4915,
      "Dockerfile": 4760,
      "Batchfile": 2651,
      "Fluent": 217
    },
    "commit_activity": {
      "total_commits_last_year": 3682,
      "avg_commits_per_week": 70.8076923076923,
      "days_active_last_year": 292
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:10:04.689797"
  }
}