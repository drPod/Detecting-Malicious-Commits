{
  "cve_id": "CVE-2020-11004",
  "github_data": {
    "repository": "Admidio/admidio",
    "fix_commit": "ea5d6f114b151ed11ec0ad7cb47bd729e77a874a",
    "related_commits": [
      "ea5d6f114b151ed11ec0ad7cb47bd729e77a874a",
      "ea5d6f114b151ed11ec0ad7cb47bd729e77a874a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "ea5d6f114b151ed11ec0ad7cb47bd729e77a874a",
      "commit_date": "2020-04-12T19:29:04Z",
      "author": {
        "login": "Fasse",
        "type": "User",
        "stats": {
          "total_commits": 6698,
          "average_weekly_commits": 6.638255698711595,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 829
        }
      },
      "commit_message": {
        "title": "Unauthenticated Blind SQL injection #908",
        "length": 40,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "adm_program/system/classes/TableAccess.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -444,11 +444,11 @@ public function readDataByColumns(array $columnArray)\n         // add every array element as a sql condition to the condition string\n         foreach ($columnArray as $columnName => $columnValue)\n         {\n-            $sqlWhereCondition .= ' AND ' . $columnName . ' = \\'' . $columnValue . '\\' ';\n+            $sqlWhereCondition .= ' AND ' . $columnName . ' = ? ';\n         }\n \n         // call method to read data out of database\n-        $returnCode = $this->readData($sqlWhereCondition);\n+        $returnCode = $this->readData($sqlWhereCondition, array_values($columnArray));\n \n         // save the array fields in the object\n         if (!$returnCode)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "00eed34b64f4edfc34441c80fde054751de0e546",
            "date": "2025-01-23T19:53:46Z",
            "author_login": "Fasse"
          },
          {
            "sha": "8af815bf5111ad7c35737b3830b10e565a778928",
            "date": "2025-01-21T15:57:22Z",
            "author_login": "kainhofer"
          },
          {
            "sha": "a720ec9e6204387e926c648640d694430178d105",
            "date": "2025-01-23T05:41:31Z",
            "author_login": "Fasse"
          },
          {
            "sha": "59ff38abc905a8c88cd88e161a71b4fe2ed8a756",
            "date": "2025-01-23T05:35:20Z",
            "author_login": "Fasse"
          },
          {
            "sha": "31390c4fdf8d5d00d6ab4f798b8f014acff285d2",
            "date": "2025-01-22T21:02:26Z",
            "author_login": "kainhofer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-89",
    "description": "SQL Injection was discovered in Admidio before version 3.3.13. The main cookie parameter is concatenated into a SQL query without any input validation/sanitization, thus an attacker without logging in, can send a GET request with arbitrary SQL queries appended to the cookie parameter and execute SQL queries. The vulnerability impacts the confidentiality of the system. This has been patched in version 3.3.13.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-04-24T21:15:13.747",
    "last_modified": "2024-11-21T04:56:33.703",
    "fix_date": "2020-04-12T19:29:04Z"
  },
  "references": [
    {
      "url": "https://github.com/Admidio/admidio/commit/ea5d6f114b151ed11ec0ad7cb47bd729e77a874a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Admidio/admidio/issues/908",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Admidio/admidio/security/advisories/GHSA-qh57-rcff-gx54",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Admidio/admidio/commit/ea5d6f114b151ed11ec0ad7cb47bd729e77a874a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Admidio/admidio/issues/908",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Admidio/admidio/security/advisories/GHSA-qh57-rcff-gx54",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.956020",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "admidio",
    "owner": "Admidio",
    "created_at": "2015-01-05T11:03:46Z",
    "updated_at": "2025-01-14T08:00:57Z",
    "pushed_at": "2025-01-14T06:12:48Z",
    "size": 122123,
    "stars": 349,
    "forks": 134,
    "open_issues": 157,
    "watchers": 349,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3162563,
      "JavaScript": 806324,
      "Smarty": 240740,
      "CSS": 89897,
      "HTML": 37144,
      "Shell": 12111,
      "Dockerfile": 3439
    },
    "commit_activity": {
      "total_commits_last_year": 581,
      "avg_commits_per_week": 11.173076923076923,
      "days_active_last_year": 183
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:34:38.133059"
  }
}