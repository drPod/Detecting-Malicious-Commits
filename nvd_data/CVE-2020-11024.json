{
  "cve_id": "CVE-2020-11024",
  "github_data": {
    "repository": "moonlight-stream/moonlight-ios",
    "fix_commit": "b0149b2fe9125a77ee11fe133382673694b6e8cc",
    "related_commits": [
      "b0149b2fe9125a77ee11fe133382673694b6e8cc",
      "b0149b2fe9125a77ee11fe133382673694b6e8cc"
    ],
    "patch_url": "https://github.com/moonlight-stream/moonlight-ios/commit/b0149b2fe9125a77ee11fe133382673694b6e8cc.patch",
    "fix_commit_details": {
      "sha": "b0149b2fe9125a77ee11fe133382673694b6e8cc",
      "commit_date": "2020-04-17T19:40:29Z",
      "author": {
        "login": "cgutman",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #405 from loki-47-6F-64/master",
        "length": 72,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 6,
        "deletions": 11
      },
      "files": [
        {
          "filename": "Limelight/Network/PairManager.m",
          "status": "modified",
          "additions": 6,
          "deletions": 11,
          "patch": "@@ -91,8 +91,10 @@ - (void) initiatePairWithPin:(NSString*)PIN forServerMajorVersion:(int)serverMaj\n         Log(LOG_W, @\"Background pairing time has expired!\");\n     }];\n     \n-    NSData* salt = [self saltPIN:PIN];\n-    Log(LOG_I, @\"PIN: %@, saltedPIN: %@\", PIN, salt);\n+    NSData* salt = [Utils randomBytes:16];\n+    NSData* saltedPIN = [self concatData:salt with:[PIN dataUsingEncoding:NSUTF8StringEncoding]];\n+\n+    Log(LOG_I, @\"PIN: %@, salt %@\", PIN, salt);\n     \n     HttpResponse* pairResp = [[HttpResponse alloc] init];\n     [_httpManager executeRequestSynchronously:[HttpRequest requestForResponse:pairResp withUrlRequest:[_httpManager newPairRequest:salt clientCert:_clientCert]]];\n@@ -117,11 +119,11 @@ - (void) initiatePairWithPin:(NSString*)PIN forServerMajorVersion:(int)serverMaj\n     // Gen 7 servers use SHA256 to get the key\n     int hashLength;\n     if (serverMajorVersion >= 7) {\n-        aesKey = [cryptoMan createAESKeyFromSaltSHA256:salt];\n+        aesKey = [cryptoMan createAESKeyFromSaltSHA256:saltedPIN];\n         hashLength = 32;\n     }\n     else {\n-        aesKey = [cryptoMan createAESKeyFromSaltSHA1:salt];\n+        aesKey = [cryptoMan createAESKeyFromSaltSHA1:saltedPIN];\n         hashLength = 20;\n     }\n     \n@@ -227,11 +229,4 @@ - (NSString*) generatePIN {\n     return PIN;\n }\n \n-- (NSData*) saltPIN:(NSString*)PIN {\n-    NSMutableData* saltedPIN = [[NSMutableData alloc] initWithCapacity:20];\n-    [saltedPIN appendData:[Utils randomBytes:16]];\n-    [saltedPIN appendBytes:[PIN UTF8String] length:4];\n-    return saltedPIN;\n-}\n-\n @end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "da470355257ddc843d6f3354bd621d0577630fe6",
            "date": "2024-03-30T08:42:15Z",
            "author_login": "bogsen"
          },
          {
            "sha": "db9a4ab7c291d9246074d3f1a81d66f34a76a449",
            "date": "2024-12-20T21:40:30Z",
            "author_login": "cgutman"
          },
          {
            "sha": "a528ce7e2a868434d581939269d0ed5dc559ec03",
            "date": "2024-12-20T21:34:17Z",
            "author_login": "cgutman"
          },
          {
            "sha": "1e0714ce700cb3cafecebe665f85796d799816de",
            "date": "2024-12-20T21:33:02Z",
            "author_login": "cgutman"
          },
          {
            "sha": "997525c71e4ac85bb3b9a06a90d2cd0798c6626d",
            "date": "2024-12-20T21:31:45Z",
            "author_login": "cgutman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:P/AC:H/PR:L/UI:R/S:C/C:H/I:L/A:L",
    "cwe_id": "CWE-300",
    "description": "In Moonlight iOS/tvOS before 4.0.1, the pairing process is vulnerable to a man-in-the-middle attack. The bug has been fixed in Moonlight v4.0.1 for iOS and tvOS.",
    "attack_vector": "PHYSICAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-04-29T21:15:11.807",
    "last_modified": "2024-11-21T04:56:36.803",
    "fix_date": "2020-04-17T19:40:29Z"
  },
  "references": [
    {
      "url": "https://github.com/moonlight-stream/moonlight-ios/commit/b0149b2fe9125a77ee11fe133382673694b6e8cc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moonlight-stream/moonlight-ios/pull/405",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moonlight-stream/moonlight-ios/security/advisories/GHSA-g298-gp8q-h6j3",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moonlight-stream/moonlight-ios/commit/b0149b2fe9125a77ee11fe133382673694b6e8cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moonlight-stream/moonlight-ios/pull/405",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moonlight-stream/moonlight-ios/security/advisories/GHSA-g298-gp8q-h6j3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.964531",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "moonlight-ios",
    "owner": "moonlight-stream",
    "created_at": "2014-01-18T03:11:26Z",
    "updated_at": "2025-01-13T23:54:05Z",
    "pushed_at": "2024-12-20T21:46:19Z",
    "size": 241528,
    "stars": 1222,
    "forks": 302,
    "open_issues": 136,
    "watchers": 1222,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 3667099,
      "Objective-C": 612959,
      "C++": 35329,
      "Shell": 5291
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T20:36:00.366246"
  }
}