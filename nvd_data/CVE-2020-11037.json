{
  "cve_id": "CVE-2020-11037",
  "github_data": {
    "repository": "wagtail/wagtail",
    "fix_commit": "3c030490ed575bb9cd01dfb3a890477dcaeb2edf",
    "related_commits": [
      "3c030490ed575bb9cd01dfb3a890477dcaeb2edf",
      "b76ab57ee859732b9cf9287d380493ab24061090",
      "ba9d424bd1ca5ce1910d3de74f5cc07214fbfb11",
      "bac3cd0a26b023e595cf2959aae7da15bb5e4340"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3c030490ed575bb9cd01dfb3a890477dcaeb2edf",
      "commit_date": "2020-04-28T13:45:23Z",
      "author": {
        "login": "gasman",
        "type": "User",
        "stats": {
          "total_commits": 6011,
          "average_weekly_commits": 10.43576388888889,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 515
        }
      },
      "commit_message": {
        "title": "Use constant_time_compare for view restriction password checks",
        "length": 62,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "wagtail/core/forms.py",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1,4 +1,5 @@\n from django import forms\n+from django.utils.crypto import constant_time_compare\n from django.utils.translation import ugettext as _\n from django.utils.translation import ugettext_lazy\n \n@@ -13,7 +14,7 @@ def __init__(self, *args, **kwargs):\n \n     def clean_password(self):\n         data = self.cleaned_data['password']\n-        if data != self.restriction.password:\n+        if not constant_time_compare(data, self.restriction.password):\n             raise forms.ValidationError(_(\"The password you have entered is not correct. Please try again.\"))\n \n         return data"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "77a55e3f60db7c27d1139d5455b7ff7ce6f037f1",
            "date": "2025-01-24T22:53:03Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "9d496be14c805d08101288a795198e270c822680",
            "date": "2025-01-23T17:07:48Z",
            "author_login": "thibaudcolas"
          },
          {
            "sha": "29e41ea6fc3e0928d3ba91369ac05ba5689377b8",
            "date": "2025-01-23T16:54:05Z",
            "author_login": "thibaudcolas"
          },
          {
            "sha": "484c71c539813f35d65d8fd30ac721d8a26da888",
            "date": "2025-01-23T16:40:19Z",
            "author_login": "thibaudcolas"
          },
          {
            "sha": "4b99a1755423f2db3216f7eca0d292f3f5f87d72",
            "date": "2025-01-23T12:54:44Z",
            "author_login": "gasman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:N",
    "cwe_id": "CWE-208",
    "description": "In Wagtail before versions 2.7.3 and 2.8.2, a potential timing attack exists on pages or documents that have been protected with a shared password through Wagtail's \"Privacy\" controls. This password check is performed through a character-by-character string comparison, and so an attacker who is able to measure the time taken by this check to a high degree of accuracy could potentially use timing differences to gain knowledge of the password. This is [understood to be feasible on a local network, but not on the public internet](https://groups.google.com/d/msg/django-developers/iAaq0pvHXuA/fpUuwjK3i2wJ).\n\nPrivacy settings that restrict access to pages/documents on a per-user or per-group basis (as opposed to a shared password) are unaffected by this vulnerability.\n\nThis has been patched in 2.7.3, 2.8.2, 2.9.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-04-30T23:15:11.887",
    "last_modified": "2024-11-21T04:56:39.240",
    "fix_date": "2020-04-28T13:45:23Z"
  },
  "references": [
    {
      "url": "https://github.com/wagtail/wagtail/commit/3c030490ed575bb9cd01dfb3a890477dcaeb2edf",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/wagtail/wagtail/commit/b76ab57ee859732b9cf9287d380493ab24061090",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/wagtail/wagtail/commit/ba9d424bd1ca5ce1910d3de74f5cc07214fbfb11",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/wagtail/wagtail/commit/bac3cd0a26b023e595cf2959aae7da15bb5e4340",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/wagtail/wagtail/security/advisories/GHSA-jjjr-3jcw-f8v6",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wagtail/wagtail/security/advisories/GHSA-jjjr-3jcw-f8v6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.969009",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "wagtail",
    "owner": "wagtail",
    "created_at": "2014-02-03T12:41:59Z",
    "updated_at": "2025-01-26T03:30:16Z",
    "pushed_at": "2025-01-25T11:43:50Z",
    "size": 227639,
    "stars": 18657,
    "forks": 3967,
    "open_issues": 975,
    "watchers": 18657,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 8307657,
      "JavaScript": 1144779,
      "TypeScript": 559700,
      "HTML": 526327,
      "SCSS": 231062,
      "Shell": 6841,
      "CSS": 2719,
      "Dockerfile": 2038,
      "Makefile": 1389,
      "MDX": 271
    },
    "commit_activity": {
      "total_commits_last_year": 1475,
      "avg_commits_per_week": 28.365384615384617,
      "days_active_last_year": 269
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T07:34:58.418633"
  }
}