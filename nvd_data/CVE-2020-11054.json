{
  "cve_id": "CVE-2020-11054",
  "github_data": {
    "repository": "qutebrowser/qutebrowser",
    "fix_commit": "021ab572a319ca3db5907a33a59774f502b3b975",
    "related_commits": [
      "021ab572a319ca3db5907a33a59774f502b3b975",
      "19f01bb42d02da539446a52a25bb0c1232b86327",
      "1b7946ed14b386a24db050f2d6dba81ba6518755",
      "2281a205c3e70ec20f35ec8fafecee0d5c4f3478",
      "4020210b193f77cf1785b21717f6ef7c5de5f0f8",
      "6821c236f9ae23adf21d46ce0d56768ac8d0c467",
      "9bd1cf585fccdfe8318fff7af793730e74a04db3",
      "a45ca9c788f648d10cccce2af41405bf25ee2948",
      "d28ed758d077a5bf19ddac4da468f7224114df23",
      "f5d801251aa5436aff44660c87d7013e29ac5864",
      "021ab572a319ca3db5907a33a59774f502b3b975",
      "19f01bb42d02da539446a52a25bb0c1232b86327",
      "1b7946ed14b386a24db050f2d6dba81ba6518755",
      "2281a205c3e70ec20f35ec8fafecee0d5c4f3478",
      "4020210b193f77cf1785b21717f6ef7c5de5f0f8",
      "6821c236f9ae23adf21d46ce0d56768ac8d0c467",
      "9bd1cf585fccdfe8318fff7af793730e74a04db3",
      "a45ca9c788f648d10cccce2af41405bf25ee2948",
      "d28ed758d077a5bf19ddac4da468f7224114df23",
      "f5d801251aa5436aff44660c87d7013e29ac5864"
    ],
    "patch_url": "https://github.com/qutebrowser/qutebrowser/commit/021ab572a319ca3db5907a33a59774f502b3b975.patch",
    "fix_commit_details": {
      "sha": "021ab572a319ca3db5907a33a59774f502b3b975",
      "commit_date": "2020-05-02T16:54:05Z",
      "author": {
        "login": "The-Compiler",
        "type": "User",
        "stats": {
          "total_commits": 18349,
          "average_weekly_commits": 31.636206896551723,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 545
        }
      },
      "commit_message": {
        "title": "Security: Remember hosts with ignored cert errors for load status",
        "length": 339,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 26,
        "additions": 17,
        "deletions": 9
      },
      "files": [
        {
          "filename": "qutebrowser/browser/browsertab.py",
          "status": "modified",
          "additions": 12,
          "deletions": 4,
          "patch": "@@ -869,6 +869,13 @@ class AbstractTab(QWidget):\n     # arg 1: The exit code.\n     renderer_process_terminated = pyqtSignal(TerminationStatus, int)\n \n+    # Hosts for which a certificate error happened. Shared between all tabs.\n+    #\n+    # Note that we remember hosts here, without scheme/port:\n+    # QtWebEngine/Chromium also only remembers hostnames, and certificates are\n+    # for a given hostname anyways.\n+    _insecure_hosts = set()  # type: typing.Set[str]\n+\n     def __init__(self, *, win_id: int, private: bool,\n                  parent: QWidget = None) -> None:\n         self.is_private = private\n@@ -886,7 +893,6 @@ def __init__(self, *, win_id: int, private: bool,\n         self._layout = miscwidgets.WrapperLayout(self)\n         self._widget = typing.cast(QWidget, None)\n         self._progress = 0\n-        self._has_ssl_errors = False\n         self._load_status = usertypes.LoadStatus.none\n         self._tab_event_filter = eventfilter.TabEventFilter(\n             self, parent=self)\n@@ -973,7 +979,6 @@ def _on_url_changed(self, url: QUrl) -> None:\n     @pyqtSlot()\n     def _on_load_started(self) -> None:\n         self._progress = 0\n-        self._has_ssl_errors = False\n         self.data.viewing_source = False\n         self._set_load_status(usertypes.LoadStatus.loading)\n         self.load_started.emit()\n@@ -1032,9 +1037,12 @@ def _update_load_status(self, ok: bool) -> None:\n         Needs to be called by subclasses to trigger a load status update, e.g.\n         as a response to a loadFinished signal.\n         \"\"\"\n-        if ok and not self._has_ssl_errors:\n+        if ok:\n             if self.url().scheme() == 'https':\n-                self._set_load_status(usertypes.LoadStatus.success_https)\n+                if self.url().host() in self._insecure_hosts:\n+                    self._set_load_status(usertypes.LoadStatus.warn)\n+                else:\n+                    self._set_load_status(usertypes.LoadStatus.success_https)\n             else:\n                 self._set_load_status(usertypes.LoadStatus.success)\n         elif ok:"
        },
        {
          "filename": "qutebrowser/browser/webengine/webenginetab.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1549,9 +1549,9 @@ def _on_load_finished(self, ok: bool) -> None:\n \n     @pyqtSlot(certificateerror.CertificateErrorWrapper)\n     def _on_ssl_errors(self, error):\n-        self._has_ssl_errors = True\n-\n         url = error.url()\n+        self._insecure_hosts.add(url.host())\n+\n         log.webview.debug(\"Certificate error: {}\".format(error))\n \n         if error.is_overridable():"
        },
        {
          "filename": "qutebrowser/browser/webkit/webkittab.py",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -849,9 +849,9 @@ def _on_navigation_request(self, navigation):\n         if navigation.is_main_frame:\n             self.settings.update_for_url(navigation.url)\n \n-    @pyqtSlot()\n-    def _on_ssl_errors(self):\n-        self._has_ssl_errors = True\n+    @pyqtSlot('QNetworkReply*')\n+    def _on_ssl_errors(self, reply):\n+        self._insecure_hosts.add(reply.url().host())\n \n     def _connect_signals(self):\n         view = self._widget"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0a32d6fef5550c2c0c38073533d36c3f47d6b130",
            "date": "2025-01-09T10:50:34Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "c5395c23f7033d8884a6b89549fc73e0308711f6",
            "date": "2025-01-09T10:27:40Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "d272804126de00a4a59776aa7b1808abb96ecb0e",
            "date": "2025-01-09T10:20:48Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "ed8141cb4b97427c4fc69b2c60f5d734cb7d9d1b",
            "date": "2025-01-06T14:14:21Z",
            "author_login": "The-Compiler"
          },
          {
            "sha": "2b8c053aee5c847f0f324e6c9a4262a79144f2c8",
            "date": "2025-01-06T14:07:30Z",
            "author_login": "The-Compiler"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-684",
    "description": "In qutebrowser versions less than 1.11.1, reloading a page with certificate errors shows a green URL. After a certificate error was overridden by the user, qutebrowser displays the URL as yellow (colors.statusbar.url.warn.fg). However, when the affected website was subsequently loaded again, the URL was mistakenly displayed as green (colors.statusbar.url.success_https). While the user already has seen a certificate error prompt at this point (or set content.ssl_strict to false, which is not recommended), this could still provide a false sense of security. This has been fixed in 1.11.1 and 1.12.0. All versions of qutebrowser are believed to be affected, though versions before v0.11.x couldn't be tested. Backported patches for older versions (greater than or equal to 1.4.0 and less than or equal to 1.10.2) are available, but no further releases are planned.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-05-07T21:15:11.590",
    "last_modified": "2024-11-21T04:56:41.400",
    "fix_date": "2020-05-02T16:54:05Z"
  },
  "references": [
    {
      "url": "https://bugs.kde.org/show_bug.cgi?id=420902",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/021ab572a319ca3db5907a33a59774f502b3b975",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/19f01bb42d02da539446a52a25bb0c1232b86327",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/1b7946ed14b386a24db050f2d6dba81ba6518755",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/2281a205c3e70ec20f35ec8fafecee0d5c4f3478",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/4020210b193f77cf1785b21717f6ef7c5de5f0f8",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/6821c236f9ae23adf21d46ce0d56768ac8d0c467",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/9bd1cf585fccdfe8318fff7af793730e74a04db3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/a45ca9c788f648d10cccce2af41405bf25ee2948",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/d28ed758d077a5bf19ddac4da468f7224114df23",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/f5d801251aa5436aff44660c87d7013e29ac5864",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/issues/5403",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/security/advisories/GHSA-4rcq-jv2f-898j",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7YWJ5QNHXKTGG5NLV7EGEOKPBVZBA5GS/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MKAZOOTJ2MBHTYVYQQ52NL53F5CB2XAP/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://tracker.die-offenbachs.homelinux.org/eric/issue328",
      "source": "security-advisories@github.com",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.kde.org/show_bug.cgi?id=420902",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/021ab572a319ca3db5907a33a59774f502b3b975",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/19f01bb42d02da539446a52a25bb0c1232b86327",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/1b7946ed14b386a24db050f2d6dba81ba6518755",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/2281a205c3e70ec20f35ec8fafecee0d5c4f3478",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/4020210b193f77cf1785b21717f6ef7c5de5f0f8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/6821c236f9ae23adf21d46ce0d56768ac8d0c467",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/9bd1cf585fccdfe8318fff7af793730e74a04db3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/a45ca9c788f648d10cccce2af41405bf25ee2948",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/d28ed758d077a5bf19ddac4da468f7224114df23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/commit/f5d801251aa5436aff44660c87d7013e29ac5864",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/issues/5403",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/qutebrowser/qutebrowser/security/advisories/GHSA-4rcq-jv2f-898j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7YWJ5QNHXKTGG5NLV7EGEOKPBVZBA5GS/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MKAZOOTJ2MBHTYVYQQ52NL53F5CB2XAP/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://tracker.die-offenbachs.homelinux.org/eric/issue328",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.981513",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qutebrowser",
    "owner": "qutebrowser",
    "created_at": "2014-06-26T14:59:34Z",
    "updated_at": "2025-01-13T20:25:55Z",
    "pushed_at": "2025-01-13T04:22:22Z",
    "size": 63852,
    "stars": 10002,
    "forks": 1018,
    "open_issues": 1235,
    "watchers": 10002,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v0.11.x",
      "v1.1.x",
      "v1.2.x",
      "v1.3.x",
      "v1.4.x",
      "v1.5.x",
      "v1.6.x",
      "v1.7.x",
      "v1.8.x",
      "v1.9.x"
    ],
    "languages": {
      "Python": 4059218,
      "JavaScript": 771996,
      "Gherkin": 373139,
      "HTML": 131743,
      "Shell": 50490,
      "NSIS": 41173,
      "CSS": 4753,
      "Jinja": 3137,
      "Batchfile": 2012,
      "Makefile": 1510,
      "C++": 456,
      "QMake": 192
    },
    "commit_activity": {
      "total_commits_last_year": 476,
      "avg_commits_per_week": 9.153846153846153,
      "days_active_last_year": 143
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:16:35.329343"
  }
}