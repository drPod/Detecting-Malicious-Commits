{
  "cve_id": "CVE-2020-11068",
  "github_data": {
    "repository": "Lora-net/LoRaMac-node",
    "fix_commit": "e3063a91daa7ad8a687223efa63079f0c24568e4",
    "related_commits": [
      "e3063a91daa7ad8a687223efa63079f0c24568e4",
      "e3063a91daa7ad8a687223efa63079f0c24568e4"
    ],
    "patch_url": "https://github.com/Lora-net/LoRaMac-node/commit/e3063a91daa7ad8a687223efa63079f0c24568e4.patch",
    "fix_commit_details": {
      "sha": "e3063a91daa7ad8a687223efa63079f0c24568e4",
      "commit_date": "2020-04-16T15:05:15Z",
      "author": {
        "login": "mluis1",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added received buffer size checks.",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 28,
        "additions": 27,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/mac/LoRaMac.c",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -997,6 +997,13 @@ static void ProcessRadioRxDone( void )\n     switch( macHdr.Bits.MType )\r\n     {\r\n         case FRAME_TYPE_JOIN_ACCEPT:\r\n+            // Check if the received frame size is valid\r\n+            if( size < LORAMAC_JOIN_ACCEPT_FRAME_MIN_SIZE )\r\n+            {\r\n+                MacCtx.McpsIndication.Status = LORAMAC_EVENT_INFO_STATUS_ERROR;\r\n+                PrepareRxDoneAbort( );\r\n+                return;\r\n+            }\r\n             macMsgJoinAccept.Buffer = payload;\r\n             macMsgJoinAccept.BufSize = size;\r\n \r\n@@ -1068,7 +1075,8 @@ static void ProcessRadioRxDone( void )\n             getPhy.Datarate = MacCtx.McpsIndication.RxDatarate;\r\n             getPhy.Attribute = PHY_MAX_PAYLOAD;\r\n             phyParam = RegionGetPhyParam( MacCtx.NvmCtx->Region, &getPhy );\r\n-            if( MAX( 0, ( int16_t )( ( int16_t ) size - ( int16_t ) LORA_MAC_FRMPAYLOAD_OVERHEAD ) ) > ( int16_t )phyParam.Value )\r\n+            if( ( MAX( 0, ( int16_t )( ( int16_t ) size - ( int16_t ) LORAMAC_FRAME_PAYLOAD_OVERHEAD_SIZE ) ) > ( int16_t )phyParam.Value ) ||\r\n+                ( size < LORAMAC_FRAME_PAYLOAD_MIN_SIZE ) )\r\n             {\r\n                 MacCtx.McpsIndication.Status = LORAMAC_EVENT_INFO_STATUS_ERROR;\r\n                 PrepareRxDoneAbort( );\r"
        },
        {
          "filename": "src/peripherals/atecc608a-tnglora-se/atecc608a-tnglora-se.c",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -499,6 +499,12 @@ SecureElementStatus_t SecureElementProcessJoinAccept( JoinReqIdentifier_t joinRe\n         return SECURE_ELEMENT_ERROR_NPE;\n     }\n \n+    // Check that frame size isn't bigger than a JoinAccept with CFList size\n+    if( encJoinAcceptSize > LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE )\n+    {\n+        return SECURE_ELEMENT_ERROR_BUF_SIZE;\n+    }\n+\n     // Determine decryption key\n     KeyIdentifier_t encKeyID = NWK_KEY;\n "
        },
        {
          "filename": "src/peripherals/lr1110-se/lr1110-se.c",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -290,6 +290,12 @@ SecureElementStatus_t SecureElementProcessJoinAccept( JoinReqIdentifier_t joinRe\n         return SECURE_ELEMENT_ERROR_NPE;\n     }\n \n+    // Check that frame size isn't bigger than a JoinAccept with CFList size\n+    if( encJoinAcceptSize > LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE )\n+    {\n+        return SECURE_ELEMENT_ERROR_BUF_SIZE;\n+    }\n+\n     // Determine decryption key\n     KeyIdentifier_t encKeyID = NWK_KEY;\n "
        },
        {
          "filename": "src/peripherals/soft-se/soft-se.c",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -395,6 +395,12 @@ SecureElementStatus_t SecureElementProcessJoinAccept( JoinReqIdentifier_t joinRe\n         return SECURE_ELEMENT_ERROR_NPE;\n     }\n \n+    // Check that frame size isn't bigger than a JoinAccept with CFList size\n+    if( encJoinAcceptSize > LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE )\n+    {\n+        return SECURE_ELEMENT_ERROR_BUF_SIZE;\n+    }\n+\n     // Determine decryption key\n     KeyIdentifier_t encKeyID = NWK_KEY;\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dcbcfb329b4a343ab007bc19ac43a8dc952b3354",
            "date": "2024-02-06T07:43:14Z",
            "author_login": "martinjaeger"
          },
          {
            "sha": "99c2e5378dde37e3331bf3efdf9df8f77d4847ee",
            "date": "2023-12-15T09:19:38Z",
            "author_login": "mluis1"
          },
          {
            "sha": "6384af8f4c4a57016c83f3d34430f0f68855e695",
            "date": "2023-09-25T11:09:41Z",
            "author_login": "mluis1"
          },
          {
            "sha": "0dc490387e2228c792c0956c12d755f5bc33d732",
            "date": "2023-06-08T13:31:20Z",
            "author_login": "mluis1"
          },
          {
            "sha": "d08d0d548a2964834eeac430f06755dd58a444c4",
            "date": "2023-06-08T13:27:49Z",
            "author_login": "mluis1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-120",
    "description": "In LoRaMac-node before 4.4.4, a reception buffer overflow can happen due to the received buffer size not being checked. This has been fixed in 4.4.4.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-06-23T17:15:11.500",
    "last_modified": "2024-11-21T04:56:43.137",
    "fix_date": "2020-04-16T15:05:15Z"
  },
  "references": [
    {
      "url": "https://github.com/Lora-net/LoRaMac-node/commit/e3063a91daa7ad8a687223efa63079f0c24568e4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Lora-net/LoRaMac-node/security/advisories/GHSA-559p-6xgm-fpv9",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Lora-net/LoRaMac-node/commit/e3063a91daa7ad8a687223efa63079f0c24568e4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Lora-net/LoRaMac-node/security/advisories/GHSA-559p-6xgm-fpv9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.870575",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "LoRaMac-node",
    "owner": "Lora-net",
    "created_at": "2014-01-29T14:20:23Z",
    "updated_at": "2025-01-09T14:03:09Z",
    "pushed_at": "2024-07-03T05:05:51Z",
    "size": 27302,
    "stars": 1901,
    "forks": 1092,
    "open_issues": 53,
    "watchers": 1901,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 39321152,
      "Assembly": 210906,
      "CMake": 113851
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:10:52.208625"
  }
}