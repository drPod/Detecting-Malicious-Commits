{
  "cve_id": "CVE-2020-11079",
  "github_data": {
    "repository": "skoranga/node-dns-sync",
    "fix_commit": "cb10a5ac7913eacc031ade7d91596277f31645dc",
    "related_commits": [
      "cb10a5ac7913eacc031ade7d91596277f31645dc",
      "cb10a5ac7913eacc031ade7d91596277f31645dc"
    ],
    "patch_url": "https://github.com/skoranga/node-dns-sync/commit/cb10a5ac7913eacc031ade7d91596277f31645dc.patch",
    "fix_commit_details": {
      "sha": "cb10a5ac7913eacc031ade7d91596277f31645dc",
      "commit_date": "2020-05-20T01:48:24Z",
      "author": {
        "login": "skoranga",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "allowing only valid rrtypes",
        "length": 27,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 57,
        "additions": 50,
        "deletions": 7
      },
      "files": [
        {
          "filename": ".travis.yml",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -4,3 +4,5 @@ node_js:\n   - \"6\"\n   - \"8\"\n   - \"10\"\n+  - \"12\"\n+  - \"14\""
        },
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 17,
          "deletions": 5,
          "patch": "@@ -1,6 +1,18 @@\n-####0.2.0\n- - Updating dependencies\n+CHANGELOG\n+==========\n \n-####0.1.3\n- - Added support for resolving AAAA and NS records\n- - Upgrading to latest shelljs dependency\n+0.2.1\n+-----\n+\n+- Allowing only valid rrtypes as per https://nodejs.org/api/dns.html#dns_dns_resolve_hostname_rrtype_callback.\n+\n+0.2.0\n+-----\n+\n+- Updating dependencies\n+\n+0.1.3\n+-----\n+\n+- Added support for resolving AAAA and NS records\n+- Upgrading to latest shelljs dependency"
        },
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -5,7 +5,9 @@ node-dns-sync\n \n Sync/Blocking DNS resolve. Main usecase is in node server startup.\n \n-### How to Use\n+How to Use\n+-------\n+\n ```javascript\n var dnsSync = require('dns-sync');\n "
        },
        {
          "filename": "lib/dns-sync.js",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -8,6 +8,20 @@ var util = require('util'),\n //source - http://stackoverflow.com/questions/106179/regular-expression-to-match-dns-hostname-or-ip-address\n var ValidHostnameRegex = new RegExp(\"^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$\");\n \n+// https://nodejs.org/api/dns.html#dns_dns_resolve_hostname_rrtype_callback\n+var RRecordTypes = [\n+    'A',\n+    'AAAA',\n+    'NS',\n+    'NAPTR',\n+    'CNAME',\n+    'SOA',\n+    'SRV',\n+    'PTR',\n+    'MX',\n+    'TXT',\n+    'ANY'];\n+\n function isValidHostName(hostname) {\n     return ValidHostnameRegex.test(hostname);\n }\n@@ -26,6 +40,10 @@ module.exports = {\n             console.error('Invalid hostname:', hostname);\n             return null;\n         }\n+        if (typeof type !== 'undefined' && RRecordTypes.indexOf(type) === -1) {\n+            console.error('Invalid rrtype:', type);\n+            return null;\n+        }\n \n         var scriptPath = path.join(__dirname, \"../scripts/dns-lookup-script\"),\n             response,"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"dns-sync\",\n-  \"version\": \"0.2.0\",\n+  \"version\": \"0.2.1\",\n   \"description\": \"dns-sync\",\n   \"main\": \"index.js\",\n   \"scripts\": {"
        },
        {
          "filename": "test/test.js",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,6 +1,7 @@\n 'use strict';\n \n var assert = require('assert'),\n+    fs = require('fs'),\n     dnsSync = require('../index');\n \n describe('dns sync', function () {\n@@ -38,4 +39,12 @@ describe('dns sync', function () {\n         assert.ok(ns.length >= 1);\n         assert.ok(ns[0].match(/^ns[0-9]+\\.google\\.com$/));\n     });\n+\n+    it('should fail to resolve if invalid record is asked', function () {\n+        var rs1 = dnsSync.resolve('www.google.com', 'Test');\n+        var rs2 = dnsSync.resolve('www.google.com', ' && touch test.txt');\n+        assert.ok(!rs1);\n+        assert.ok(!rs2);\n+        assert.ok(!fs.existsSync('test.txt'));\n+    });\n });"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2b8735816644145523e0619c58d59d557227da84",
            "date": "2020-05-20T17:10:43Z",
            "author_login": "skoranga"
          },
          {
            "sha": "cb10a5ac7913eacc031ade7d91596277f31645dc",
            "date": "2020-05-20T01:48:24Z",
            "author_login": "skoranga"
          },
          {
            "sha": "93b8034e9475ae65102dac15fffe065616fede1b",
            "date": "2019-07-26T16:45:55Z",
            "author_login": "skoranga"
          },
          {
            "sha": "983499b0b106c2b6fa9861742875a91eecc8f79d",
            "date": "2019-07-26T16:40:53Z",
            "author_login": "skoranga"
          },
          {
            "sha": "cfa0c5b89fa3a03f10b35fb9018ac8ceafc157d9",
            "date": "2016-01-21T20:19:46Z",
            "author_login": "skoranga"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N",
    "cwe_id": "CWE-94",
    "description": "node-dns-sync (npm module dns-sync) through 0.2.0 allows execution of arbitrary commands . This issue may lead to remote code execution if a client of the library calls the vulnerable method with untrusted input. This has been fixed in 0.2.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-05-28T19:15:10.640",
    "last_modified": "2024-11-21T04:56:44.530",
    "fix_date": "2020-05-20T01:48:24Z"
  },
  "references": [
    {
      "url": "https://github.com/skoranga/node-dns-sync/commit/cb10a5ac7913eacc031ade7d91596277f31645dc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/security/advisories/GHSA-wh69-wc6q-7888",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/commit/cb10a5ac7913eacc031ade7d91596277f31645dc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/skoranga/node-dns-sync/security/advisories/GHSA-wh69-wc6q-7888",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.823212",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "node-dns-sync",
    "owner": "skoranga",
    "created_at": "2014-03-25T02:35:19Z",
    "updated_at": "2021-02-27T06:43:11Z",
    "pushed_at": "2020-08-20T11:08:41Z",
    "size": 15,
    "stars": 7,
    "forks": 10,
    "open_issues": 3,
    "watchers": 7,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 4682
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:20:30.210901"
  }
}