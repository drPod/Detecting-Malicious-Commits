{
  "cve_id": "CVE-2020-12274",
  "github_data": {
    "repository": "TestLinkOpenSourceTRMS/testlink-code",
    "fix_commit": "2d17cd00f981f8e8c97de34a12e368ba2a55e3d0",
    "related_commits": [
      "2d17cd00f981f8e8c97de34a12e368ba2a55e3d0",
      "2d17cd00f981f8e8c97de34a12e368ba2a55e3d0"
    ],
    "patch_url": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/2d17cd00f981f8e8c97de34a12e368ba2a55e3d0.patch",
    "fix_commit_details": {
      "sha": "2d17cd00f981f8e8c97de34a12e368ba2a55e3d0",
      "commit_date": "2020-04-04T18:22:23Z",
      "author": {
        "login": "fmancardi",
        "type": "User",
        "stats": {
          "total_commits": 3545,
          "average_weekly_commits": 4.876203576341128,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 420
        }
      },
      "commit_message": {
        "title": "fix goback url to avoid security issues",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 43,
        "additions": 20,
        "deletions": 23
      },
      "files": [
        {
          "filename": "lib/cfields/cfieldsExport.php",
          "status": "modified",
          "additions": 11,
          "deletions": 10,
          "patch": "@@ -7,14 +7,9 @@\n  *\n  * @package   TestLink\n  * @author    Francisco Mancardi (francisco.mancardi@gmail.com)\n- * @copyright   2005-2009, TestLink community \n- * @version     CVS: $Id: cfieldsExport.php,v 1.4 2010/03/15 20:23:09 franciscom Exp $\n- * @link    http://www.teamst.org/index.php\n+ * @copyright   2005-2020, TestLink community \n  * @uses    config.inc.php\n  *\n- * @internal Revisions:\n- * 20100315 - franciscom - added tlInputParameter() on init_args + goback managament\n- * 20090719 - franciscom - db table prefix management   \n  *\n  */\n require_once(\"../../config.inc.php\");\n@@ -25,6 +20,7 @@\n $templateCfg = templateConfiguration();\n $args = init_args();\n \n+\n $gui = new stdClass();\n $gui->page_title = lang_get('export_cfields');\n $gui->do_it = 1;\n@@ -61,12 +57,17 @@ function init_args()\n   $args = new stdClass();\n   $_REQUEST = strings_stripSlashes($_REQUEST);\n \n-  $iParams = array(\"doAction\" => array(tlInputParameter::STRING_N,0,50),\n-           \"export_filename\" => array(tlInputParameter::STRING_N,0,100),\n-           \"goback_url\" => array(tlInputParameter::STRING_N,0,2048));\n+  $iParams = \n+    array(\"doAction\" \n+             => array(tlInputParameter::STRING_N,0,50),\n+           \"export_filename\" \n+              => array(tlInputParameter::STRING_N,0,100));\n \n   R_PARAMS($iParams,$args);\n-    $args->userID = $_SESSION['userID'];\n+  $args->userID = $_SESSION['userID'];\n+\n+  $args->goback_url = $_SESSION['basehref'] .\n+                      'lib/cfields/cfieldsView.php';\n \n   return $args;\n }"
        },
        {
          "filename": "lib/cfields/cfieldsImport.php",
          "status": "modified",
          "additions": 9,
          "deletions": 13,
          "patch": "@@ -7,13 +7,10 @@\n  *\n  * @package \t  TestLink\n  * @author \t\t  Francisco Mancardi (francisco.mancardi@gmail.com)\n- * @copyright \t2005-2013, TestLink community \n- * @filesource  cfieldsImport.php,v 1.5 2010/03/15 20:22:42 franciscom Exp $\n- * @link \t\t    http://www.teamst.org/index.php\n+ * @copyright \t2005-2020, TestLink community \n+ * @filesource  cfieldsImport.php\n  * @uses \t\t    config.inc.php\n  *\n- * @internal revisions\n- * @since 1.9.9\n  */\n require('../../config.inc.php');\n require_once('common.php');\n@@ -64,17 +61,16 @@ function init_args()\n \t$args = new stdClass();\n \t$_REQUEST = strings_stripSlashes($_REQUEST);\n \n-\t$iParams = array(\"doAction\" => array(tlInputParameter::STRING_N,0,50),\n-\t \t\t\t\t \"export_filename\" => array(tlInputParameter::STRING_N,0,100),\n-\t \t\t\t\t \"goback_url\" => array(tlInputParameter::STRING_N,0,2048));\n+\t$iParams = \n+    array(\"doAction\" => array(tlInputParameter::STRING_N,0,50),\n+\t \t\t\t\t\"export_filename\" \n+             => array(tlInputParameter::STRING_N,0,100));\n \n \tR_PARAMS($iParams,$args);\n+  $args->userID = $_SESSION['userID'];\n \n-  \t// $args->doAction = isset($_REQUEST['doAction']) ? $_REQUEST['doAction'] : null;\n-  \t// $args->export_filename=isset($_REQUEST['export_filename']) ? $_REQUEST['export_filename'] : null;\n-  \t// $args->goback_url = isset($_REQUEST['goback_url']) ? $_REQUEST['goback_url'] : null;\n-\n-  \t$args->userID = $_SESSION['userID'];\n+  $args->goback_url = $_SESSION['basehref'] .\n+                      'lib/cfields/cfieldsView.php';\n \n \treturn $args;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "da36677d5020f7fafbc3d1db2c5e5a60cf9430b5",
            "date": "2024-10-25T14:20:52Z",
            "author_login": "fmancardi"
          },
          {
            "sha": "d99acb88d9b10199ea0ff088623bde6683632f66",
            "date": "2024-10-20T13:53:17Z",
            "author_login": "fmancardi"
          },
          {
            "sha": "43fa29fad3dc8db5f1734236c525ff5042d0e24b",
            "date": "2024-10-20T09:53:37Z",
            "author_login": "fmancardi"
          },
          {
            "sha": "5802d7b54bf4b9e966b40be48d93c3e17a8caeb6",
            "date": "2024-10-20T09:49:29Z",
            "author_login": "fmancardi"
          },
          {
            "sha": "c839c85f725cdc79d1af8645a808d3f45830f389",
            "date": "2024-10-20T09:44:32Z",
            "author_login": "atisne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": null,
    "description": "In TestLink 1.9.20, the lib/cfields/cfieldsExport.php goback_url parameter causes a security risk because it depends on client input and is not constrained to lib/cfields/cfieldsView.php at the web site associated with the session.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-04-27T13:15:12.553",
    "last_modified": "2024-11-21T04:59:25.480",
    "fix_date": "2020-04-04T18:22:23Z"
  },
  "references": [
    {
      "url": "http://mantis.testlink.org/view.php?id=8894",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/2d17cd00f981f8e8c97de34a12e368ba2a55e3d0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "http://mantis.testlink.org/view.php?id=8894",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/TestLinkOpenSourceTRMS/testlink-code/commit/2d17cd00f981f8e8c97de34a12e368ba2a55e3d0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.957422",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "testlink-code",
    "owner": "TestLinkOpenSourceTRMS",
    "created_at": "2014-12-14T10:18:34Z",
    "updated_at": "2025-01-13T08:38:09Z",
    "pushed_at": "2024-10-25T14:21:00Z",
    "size": 103323,
    "stars": 1431,
    "forks": 588,
    "open_issues": 49,
    "watchers": 1431,
    "has_security_policy": false,
    "default_branch": "testlink_1_9_20_fixed",
    "protected_branches": [],
    "languages": {
      "PHP": 6516476,
      "Smarty": 1157944,
      "JavaScript": 1001803,
      "CSS": 214493,
      "SCSS": 73128,
      "Less": 69047,
      "HTML": 41789,
      "Shell": 6381,
      "PLpgSQL": 5901,
      "Python": 4737,
      "Perl": 4467,
      "Java": 4400,
      "Ruby": 1580,
      "Dockerfile": 868,
      "Batchfile": 261
    },
    "commit_activity": {
      "total_commits_last_year": 23,
      "avg_commits_per_week": 0.4423076923076923,
      "days_active_last_year": 3
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:28:39.645128"
  }
}