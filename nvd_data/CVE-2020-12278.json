{
  "cve_id": "CVE-2020-12278",
  "github_data": {
    "repository": "libgit2/libgit2",
    "fix_commit": "3f7851eadca36a99627ad78cbe56a40d3776ed01",
    "related_commits": [
      "3f7851eadca36a99627ad78cbe56a40d3776ed01",
      "e1832eb20a7089f6383cfce474f213157f5300cb",
      "3f7851eadca36a99627ad78cbe56a40d3776ed01",
      "e1832eb20a7089f6383cfce474f213157f5300cb"
    ],
    "patch_url": "https://github.com/libgit2/libgit2/commit/3f7851eadca36a99627ad78cbe56a40d3776ed01.patch",
    "fix_commit_details": {
      "sha": "3f7851eadca36a99627ad78cbe56a40d3776ed01",
      "commit_date": "2019-09-18T12:32:05Z",
      "author": {
        "login": "dscho",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Disallow NTFS Alternate Data Stream attacks, even on Linux/macOS",
        "length": 1273,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 19,
        "additions": 17,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/path.c",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -1624,8 +1624,12 @@ GIT_INLINE(bool) verify_dotgit_ntfs(git_repository *repo, const char *path, size\n \tif (!start)\n \t\treturn true;\n \n-\t/* Reject paths like \".git\\\" */\n-\tif (path[start] == '\\\\')\n+\t/*\n+\t * Reject paths that start with Windows-style directory separators\n+\t * (\".git\\\") or NTFS alternate streams (\".git:\") and could be used\n+\t * to write to the \".git\" directory on Windows platforms.\n+\t */\n+\tif (path[start] == '\\\\' || path[start] == ':')\n \t\treturn false;\n \n \t/* Reject paths like '.git ' or '.git.' */"
        },
        {
          "filename": "tests/checkout/nasty.c",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -273,6 +273,16 @@ void test_checkout_nasty__dot_git_colon_stuff(void)\n #endif\n }\n \n+/* A tree that contains an entry \".git::$INDEX_ALLOCATION\" because NTFS\n+ * will interpret that as a synonym to \".git\", even when mounted via SMB\n+ * on macOS.\n+ */\n+void test_checkout_nasty__dotgit_alternate_data_stream(void)\n+{\n+\ttest_checkout_fails(\"refs/heads/dotgit_alternate_data_stream\", \".git/dummy-file\");\n+\ttest_checkout_fails(\"refs/heads/dotgit_alternate_data_stream\", \".git::$INDEX_ALLOCATION/dummy-file\");\n+}\n+\n /* Trees that contains entries with a tree \".git\" that contain\n  * byte sequences:\n  * { 0xe2, 0x80, 0x8c }"
        },
        {
          "filename": "tests/resources/nasty/.gitted/objects/33/8190107c7ee7d8f5aa30061fc19b7d5ddcda86",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/resources/nasty/.gitted/objects/97/c14994866466aeb73e769a6f34e07c7f4b53f7",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/resources/nasty/.gitted/objects/b8/edf3ad62dbcbc983857a5bfee7b0181ee1a513",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/resources/nasty/.gitted/refs/heads/dotgit_alternate_data_stream",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+b8edf3ad62dbcbc983857a5bfee7b0181ee1a513"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 5,
        "unique_directories": 6,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9692f45ca8d9286da96e8849cf75460382e7d02d",
            "date": "2025-01-14T15:45:52Z",
            "author_login": "ethomson"
          },
          {
            "sha": "f9e9ddd88400311d203ed4a9f86f3862abaec7a1",
            "date": "2025-01-14T12:48:28Z",
            "author_login": "ethomson"
          },
          {
            "sha": "7daaf6151a630cf0c6f2a3cda2f78a313fb6ec94",
            "date": "2025-01-13T23:19:48Z",
            "author_login": "ethomson"
          },
          {
            "sha": "02435d7647619107f90871b7c9420f9ec00b0805",
            "date": "2025-01-10T22:35:55Z",
            "author_login": "ethomson"
          },
          {
            "sha": "9c2b827cefb070c8dbbeea521d89473d082b8e1b",
            "date": "2025-01-10T22:28:05Z",
            "author_login": "ethomson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-706",
    "description": "An issue was discovered in libgit2 before 0.28.4 and 0.9x before 0.99.0. path.c mishandles equivalent filenames that exist because of NTFS Alternate Data Streams. This may allow remote code execution when cloning a repository. This issue is similar to CVE-2019-1352.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-04-27T17:15:13.407",
    "last_modified": "2024-11-21T04:59:26.073",
    "fix_date": "2019-09-18T12:32:05Z"
  },
  "references": [
    {
      "url": "https://github.com/git/git/security/advisories/GHSA-5wph-8frv-58vj",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/3f7851eadca36a99627ad78cbe56a40d3776ed01",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/e1832eb20a7089f6383cfce474f213157f5300cb",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/releases/tag/v0.28.4",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/releases/tag/v0.99.0",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/03/msg00031.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/02/msg00034.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/git/git/security/advisories/GHSA-5wph-8frv-58vj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/3f7851eadca36a99627ad78cbe56a40d3776ed01",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/commit/e1832eb20a7089f6383cfce474f213157f5300cb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/releases/tag/v0.28.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libgit2/libgit2/releases/tag/v0.99.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/03/msg00031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/02/msg00034.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.958451",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libgit2",
    "owner": "libgit2",
    "created_at": "2010-09-10T16:17:48Z",
    "updated_at": "2025-01-14T07:38:21Z",
    "pushed_at": "2025-01-14T12:48:46Z",
    "size": 72477,
    "stars": 9776,
    "forks": 2431,
    "open_issues": 439,
    "watchers": 9776,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 8196097,
      "Perl": 112049,
      "JavaScript": 93351,
      "CMake": 87027,
      "Shell": 57464,
      "Python": 20757,
      "Awk": 16256,
      "PHP": 5691
    },
    "commit_activity": {
      "total_commits_last_year": 573,
      "avg_commits_per_week": 11.01923076923077,
      "days_active_last_year": 141
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:39:41.885143"
  }
}