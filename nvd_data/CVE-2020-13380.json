{
  "cve_id": "CVE-2020-13380",
  "github_data": {
    "repository": "OS4ED/openSIS-Responsive-Design",
    "fix_commit": "1127ae0bb7c3a2883febeabc6b71ad8d73510de8",
    "related_commits": [
      "1127ae0bb7c3a2883febeabc6b71ad8d73510de8",
      "1127ae0bb7c3a2883febeabc6b71ad8d73510de8"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1127ae0bb7c3a2883febeabc6b71ad8d73510de8",
      "commit_date": "2020-04-25T21:45:25Z",
      "author": {
        "login": "openSISAdmin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Version 7.4 release update",
        "length": 54,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 4357,
        "additions": 275,
        "deletions": 4082
      },
      "files": [
        {
          "filename": "CalendarModal.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -36,6 +36,9 @@\n \n echo '<div id=err_message ></div>';\n \n+echo '<div class=\"form-group\">';\n+echo '<label class=\"control-label\">Date : '.$_REQUEST['school_date'].'&nbsp;</label>';\n+echo '</div>';\n \n if ($RET[1]['TITLE'] == '') {\n     echo '<div class=\"form-group\">';"
        },
        {
          "filename": "Modules.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -358,7 +358,7 @@\n \r\n     //===================================================================================================\r\n \r\n-    //For Marking Period\r\n+    // For Marking Period\r\n     echo \"<li><div class=\\\"form-group\\\"><FORM name=head_frm id=head_frm action=Side.php?modfunc=update&btnn=$btn&nsc=$ns method=POST>\r\n                         <INPUT type=hidden name=modcat value='' id=modcat_input>\";\r\n \r\n@@ -386,10 +386,10 @@\n             echo \"<OPTION value=$quarter[MARKING_PERIOD_ID]\" . (UserMP() == $quarter['MARKING_PERIOD_ID'] ? ' SELECTED' : '') . \">\" . $quarter['TITLE'] . \"</OPTION>\";\r\n     }\r\n     echo \"</SELECT>\";\r\n-    //Marking Period\r\n+    // Marking Period\r\n \r\n     echo '</FORM></div></li>';\r\n-}##################Porfile Not Teacher End##########################################\r\n+}################## Porfile Not Teacher End ##########################################\r\n \r\n if (UserStudentID() && User('PROFILE') != 'parent' && User('PROFILE') != 'student') {\r\n     $RET = DBGet(DBQuery(\"SELECT FIRST_NAME,LAST_NAME,MIDDLE_NAME,NAME_SUFFIX FROM students WHERE STUDENT_ID='\" . UserStudentID() . \"'\"));\r\n@@ -458,7 +458,7 @@\n             $ret_increment++;\r\n         }\r\n     }\r\n-   // print_r($RET);\r\n+   \r\n     if (!UserCourse()) {\r\n         $_SESSION['UserCourse'] = $RET[1]['COURSE_ID'];\r\n     }\r"
        },
        {
          "filename": "install/SqlForClientSchoolAndSampleDataInc.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -54,11 +54,11 @@\n --\n \n INSERT INTO `app` (`name`, `value`) VALUES\n-('version', '7.3'),\n-('date', 'August 23, 2019'),\n-('build', '20190823001'),\n+('version', '7.4'),\n+('date', 'April 25, 2020'),\n+('build', '20200425001'),\n ('update', '0'),\n-('last_updated', 'August 23, 2019');\n+('last_updated', 'April 25, 2020');\n \n --\n -- Dumping data for table `attendance_calendar`"
        },
        {
          "filename": "install/SqlForClientSchoolInc.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -34,11 +34,11 @@\n \n \n INSERT INTO `app` (`name`, `value`) VALUES\n-('version', '7.3'),\n-('date', 'August 23, 2019'),\n-('build', '20190823001'),\n+('version', '7.4'),\n+('date', 'April 25, 2020'),\n+('build', '20200425001'),\n ('update', '0'),\n-('last_updated', 'August 23, 2019');\n+('last_updated', 'April 25, 2020');\n \n --\n -- Dumping data for table `address`"
        },
        {
          "filename": "install/SqlSampleDataInc.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -52,13 +52,13 @@\n --\n -- Dumping data for table `app`\n --\n-\n INSERT INTO `app` (`name`, `value`) VALUES\n-('version', '7.3'),\n-('date', 'August 23, 2019'),\n-('build', '20190823001'),\n+('version', '7.4'),\n+('date', 'April 25, 2020'),\n+('build', '20200425001'),\n ('update', '0'),\n-('last_updated', 'August 23, 2019');\n+('last_updated', 'April 25, 2020');\n+\n \n --\n -- Dumping data for table `attendance_calendar`"
        },
        {
          "filename": "install/Step0.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -84,7 +84,7 @@\n                                             echo '</tr><tr>';\n                                             echo '<td valign=\"middle\" align=\"center\"><a href=\"Step0.1.php?mod=upgrade\"><img src=\"assets/images/icon-upgrade.png\" alt=\"Upgrade OpenSIS\" /><br/><h5 class=\"text-black\"><b>Upgrade</b><br/><small>(From ver 4.7 thru 6.0)</small></h5></a></td>';\n                                         } else {\n-                                            echo '<td valign=\"middle\" align=\"center\"><a href=\"SystemCheck.php\"><img src=\"assets/images/icon-package.png\" alt=\"New Installation\" /><br/><h5 class=\"text-black\"><b>New Installation</b><br/><small>(Ver 7.3)</small></h5></a></td>';\n+                                            echo '<td valign=\"middle\" align=\"center\"><a href=\"SystemCheck.php\"><img src=\"assets/images/icon-package.png\" alt=\"New Installation\" /><br/><h5 class=\"text-black\"><b>New Installation</b><br/><small>(Ver 7.4)</small></h5></a></td>';\n                                             echo '<td valign=\"middle\" align=\"center\"><a href=\"Step0.1.php?mod=upgrade\"><img src=\"assets/images/icon-upgrade.png\" alt=\"Upgrade OpenSIS\"/><br/><h5 class=\"text-black\"><b>Upgrade</b><br/><small>(From ver 7.1 onwards)</small></h5></a></td>';\n                                         }\n                                         ?>"
        },
        {
          "filename": "js/Ajaxload.js",
          "status": "modified",
          "additions": 145,
          "deletions": 10,
          "patch": "@@ -86,16 +86,26 @@ function usercheck_init(i) {\n         return;\r\n \r\n     var err = new Array();\r\n-    if (i.value.match(/[^A-Za-z0-9_]/))\r\n-        err[err.length] = 'Username can only contain letters, numbers and underscores';\r\n+    if (i.value.match(/[^A-Za-z0-9_@.]/))\r\n+        err[err.length] = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n     if (i.value.length < 3)\r\n         err[err.length] = 'Username too short';\r\n     if (err != '') {\r\n         obj.style.color = '#ff0000';\r\n         obj.innerHTML = err.join('<br />');\r\n+\r\n+        if(i.value.length > 1)\r\n+        {\r\n+            window.$(\"#staff_username_flag\").val(\"0\");\r\n+            window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+        }\r\n+\r\n         return;\r\n     }\r\n \r\n+    window.$(\"#staff_username_flag\").val(\"1\");\r\n+    window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+\r\n     var pqr = i.value;\r\n \r\n \r\n@@ -112,6 +122,23 @@ function usercheck_callback(data) {\n         obj.innerHTML = 'Username Available';\r\n     else\r\n         obj.innerHTML = 'Username already taken';\r\n+\r\n+\r\n+    var staff_username = document.getElementById(\"USERNAME\").value;\r\n+    var staff_username_flag = document.getElementById(\"staff_username_flag\").value;\r\n+\r\n+    if(staff_username != '' && staff_username_flag == '0')\r\n+    {\r\n+        var obj = document.getElementById('ajax_output');\r\n+        obj.style.color = '#ff0000';\r\n+        obj.innerHTML = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n+\r\n+        window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+    }\r\n+    else\r\n+    {\r\n+        window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+    }\r\n }\r\n \r\n function usercheck_init_mod(i, opt) {\r\n@@ -122,16 +149,26 @@ function usercheck_init_mod(i, opt) {\n         return;\r\n \r\n     var err = new Array();\r\n-    if (i.value.match(/[^A-Za-z0-9_]/))\r\n-        err[err.length] = 'Username can only contain letters, numbers and underscores';\r\n+    if (i.value.match(/[^A-Za-z0-9_@.]/))\r\n+        err[err.length] = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n     if (i.value.length < 3)\r\n         err[err.length] = 'Username Too Short';\r\n     if (err != '') {\r\n         obj.style.color = '#ff0000';\r\n         obj.innerHTML = err.join('<br />');\r\n+\r\n+        if(i.value.length > 1)\r\n+        {\r\n+            window.$(\"#staff_username_flag\").val(\"0\");\r\n+            window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+        }\r\n+\r\n         return;\r\n     }\r\n \r\n+    window.$(\"#staff_username_flag\").val(\"1\");\r\n+    window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+\r\n     var pqr = i.value;\r\n \r\n     if (opt == '1')\r\n@@ -147,6 +184,22 @@ function usercheck_callback_p(data) {\n     var obj = document.getElementById('ajax_output_1');\r\n     obj.style.color = (response) ? '#008800' : '#ff0000';\r\n     obj.innerHTML = (response == 1) ? 'Username Available' : 'Username already taken';\r\n+\r\n+    var staff_username = document.getElementById(\"USERNAME\").value;\r\n+    var staff_username_flag = document.getElementById(\"staff_username_flag\").value;\r\n+\r\n+    if(staff_username != '' && staff_username_flag == '0')\r\n+    {\r\n+        var obj = document.getElementById('ajax_output_1');\r\n+        obj.style.color = '#ff0000';\r\n+        obj.innerHTML = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n+\r\n+        window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+    }\r\n+    else\r\n+    {\r\n+        window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+    }\r\n }\r\n \r\n function usercheck_callback_s(data) {\r\n@@ -155,6 +208,22 @@ function usercheck_callback_s(data) {\n     var obj = document.getElementById('ajax_output_2');\r\n     obj.style.color = (response) ? '#008800' : '#ff0000';\r\n     obj.innerHTML = (response == 1) ? 'Username Available' : 'Username already taken';\r\n+\r\n+    var staff_username = document.getElementById(\"USERNAME\").value;\r\n+    var staff_username_flag = document.getElementById(\"staff_username_flag\").value;\r\n+\r\n+    if(staff_username != '' && staff_username_flag == '0')\r\n+    {\r\n+        var obj = document.getElementById('ajax_output_1');\r\n+        obj.style.color = '#ff0000';\r\n+        obj.innerHTML = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n+\r\n+        window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+    }\r\n+    else\r\n+    {\r\n+        window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+    }\r\n }\r\n \r\n \r\n@@ -232,16 +301,57 @@ function usercheck_init_staff(i) {\n         return;\r\n \r\n     var err = new Array();\r\n-    if (i.value.match(/[^A-Za-z0-9_]/))\r\n-        err[err.length] = 'Username can only contain letters, numbers and underscores';\r\n+    if (i.value.match(/[^A-Za-z0-9_@.]/))\r\n+        err[err.length] = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n+    if (i.value.length < 3)\r\n+        err[err.length] = 'Username Too Short';\r\n+    if (err != '') {\r\n+        obj.style.color = '#ff0000';\r\n+        obj.innerHTML = err.join('<br />');\r\n+\r\n+        if(i.value.length > 1)\r\n+        {\r\n+            window.$(\"#staff_username_flag\").val(\"0\");\r\n+            window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+        }\r\n+\r\n+        return;\r\n+    }\r\n+\r\n+    window.$(\"#staff_username_flag\").val(\"1\");\r\n+    window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+\r\n+    ajax_call('Validator.php?u=' + i.value + 'stud', usercheck_callback_staff);\r\n+}\r\n+\r\n+function usercheck_init_staff_2(i) {\r\n+    var obj = document.getElementById('ajax_output_st');\r\n+    obj.innerHTML = '';\r\n+    document.getElementById('usr_err_check').value = '0';\r\n+    if (i.value.length < 1)\r\n+        return;\r\n+\r\n+    var err = new Array();\r\n+    if (i.value.match(/[^A-Za-z0-9_@.]/))\r\n+        err[err.length] = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n     if (i.value.length < 3)\r\n         err[err.length] = 'Username Too Short';\r\n     if (err != '') {\r\n         obj.style.color = '#ff0000';\r\n         obj.innerHTML = err.join('<br />');\r\n+\r\n+        if(i.value.length > 1)\r\n+        {\r\n+            window.$(\"#staff_username_flag\").val(\"0\");\r\n+            window.$(\"#mod_staff_btn\").attr(\"disabled\", true);\r\n+        }\r\n+\r\n         return;\r\n     }\r\n \r\n+    window.$(\"#staff_username_flag\").val(\"1\");\r\n+    window.$(\"#mod_staff_btn\").attr(\"disabled\", false);\r\n+\r\n     ajax_call('Validator.php?u=' + i.value + 'stud', usercheck_callback_staff);\r\n }\r\n \r\n@@ -266,15 +376,24 @@ function usercheck_init_student(i) {\n         return;\r\n \r\n     var err = new Array();\r\n-    if (i.value.match(/[^A-Za-z0-9_]/))\r\n-        err[err.length] = 'Username can only contain letters, numbers and underscores';\r\n+    if (i.value.match(/[^A-Za-z0-9_@.]/))\r\n+        err[err.length] = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n     if (i.value.length < 3)\r\n         err[err.length] = 'Username Too Short';\r\n     if (err != '') {\r\n         obj.style.color = '#ff0000';\r\n         obj.innerHTML = err.join('<br />');\r\n+\r\n+        if(i.value.length > 1)\r\n+        {\r\n+            window.$(\"#stu_username_flag\").val(\"0\");\r\n+            window.$(\"#mod_student_btn\").attr(\"disabled\", true);\r\n+        }\r\n+\r\n         return;\r\n     }\r\n+    window.$(\"#stu_username_flag\").val(\"1\");\r\n+    window.$(\"#mod_student_btn\").attr(\"disabled\", false);\r\n     ajax_call('Validator.php?u=' + i.value + 'stud', usercheck_callback_student, usercheck_error_student);\r\n }\r\n \r\n@@ -303,6 +422,22 @@ function usercheck_callback_student_Mod(data) {\n         document.getElementById('students[USERNAME]').value = '';\r\n         document.getElementById('students[PASSWORD]').value = '';\r\n     }\r\n+\r\n+    var student_username = document.getElementById(\"students[USERNAME]\").value;\r\n+    var student_username_flag = document.getElementById(\"stu_username_flag\").value;\r\n+\r\n+    if(student_username != '' && student_username_flag == '0')\r\n+    {\r\n+        var obj = document.getElementById('ajax_output_st');\r\n+        obj.style.color = '#ff0000';\r\n+        obj.innerHTML = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n+\r\n+        window.$(\"#mod_student_btn\").attr(\"disabled\", true);\r\n+    }\r\n+    else\r\n+    {\r\n+        window.$(\"#mod_student_btn\").attr(\"disabled\", false);\r\n+    }\r\n }\r\n \r\n function usercheck_error_student_Mod(err) {\r\n@@ -2066,8 +2201,8 @@ function usercheck_init_noacess(i) {\n         return;\r\n \r\n     var err = new Array();\r\n-    if (i.value.match(/[^A-Za-z0-9_]/))\r\n-        err[err.length] = 'Username can only contain letters, numbers and underscores';\r\n+    if (i.value.match(/[^A-Za-z0-9_@.]/))\r\n+        err[err.length] = 'Username can only contain letters, numbers, underscores, at the rate and dots';\r\n     if (i.value.length < 3)\r\n         err[err.length] = 'Username Too Short';\r\n     if (err != '') {\r"
        },
        {
          "filename": "js/DivControl.js",
          "status": "modified",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -664,6 +664,31 @@ function checkAllDtMod(elem,name)\n     }\r\n }\r\n \r\n+function checkAllDtMod2(elem,name)\r\n+{\r\n+    var res_length=document.getElementById('res_length').value;\r\n+    var res_len=document.getElementById('res_len').value;\r\n+    var unique_id=res_len.split(',');\r\n+    \r\n+    for(var i=0;i<res_length;i++){\r\n+        if(elem.checked==true){\r\n+            if(document.getElementById(unique_id[i])){\r\n+                $('#hidden_checkboxes').append(\"<input type=hidden name='\"+name+\"[\"+unique_id[i]+\"]' value='\"+unique_id[i]+\"' data-checkbox-hidden-id='\"+unique_id[i]+\"' />\");\r\n+                // document.getElementById(unique_id[i]).checked=true;\r\n+                // window.$('#'+unique_id[i]).attr(\"checked\",true);\r\n+                $(\".student_label_cbx\").prop('checked', true);\r\n+                // alert(unique_id[i]);\r\n+            }\r\n+        }else{\r\n+            if(document.getElementById(unique_id[i])){\r\n+                $('[data-checkbox-hidden-id='+unique_id[i]+']').remove();   \r\n+                // document.getElementById(unique_id[i]).checked=false;\r\n+                $(\".student_label_cbx\").prop('checked', false);\r\n+            }\r\n+        }\r\n+    }\r\n+}\r\n+\r\n function addseccheck_button(){\r\n     if (document.getElementById('values[people][SECONDARY][RELATIONSHIP]').value != ''){\r\n         document.getElementById('rss').checked=true;\r"
        },
        {
          "filename": "modules/eligibility/EntryTimes.php",
          "status": "modified",
          "additions": 13,
          "deletions": 5,
          "patch": "@@ -113,25 +113,33 @@\n echo \"<FORM name=F1 id=F1 class=form-horizontal action=Modules.php?modname=\" . strip_tags(trim($_REQUEST[modname])) . \" method=POST>\";\n PopTable('header', 'Allow Extracurricular Posting');\n echo '<div>';\n+\n+\n if (count($start_end_RET)) {\n     $start_value = $days[$arr['START_DAY']] . ', ' . $START_HOUR . ':' . str_pad($arr['START_MINUTE'], 2, 0, STR_PAD_LEFT) . ' ' . $START_M;\n     $end_value = $days[$arr['END_DAY']] . ', ' . $END_HOUR . ':' . str_pad($arr['END_MINUTE'], 2, 0, STR_PAD_LEFT) . ' ' . $END_M;\n     $start_time = $START_HOUR . ':' . str_pad($arr['START_MINUTE'], 2, 0, STR_PAD_LEFT) . ' ' . $START_M;\n     $end_time = $END_HOUR . ':' . str_pad($arr['END_MINUTE'], 2, 0, STR_PAD_LEFT) . ' ' . $END_M;\n+\n     echo '<div class=\"form-group\"><label class=\"control-label col-md-2 text-right\">From :</label>';\n-    echo '<div class=\"col-md-10\"><div class=\"form-inline\">' . SelectInput($arr['START_DAY'], 'values[START_DAY]', '', $day_options, false, '', false) . ' &nbsp; '. TextInput_time($start_time, 'values[START_TIME]', '', NULL) . '</div></div>';\n+    echo '<div class=\"col-md-10\"><div class=\"form-inline\"><div class=\"row\"><div class= col-sm-3>' . SelectInput($arr['START_DAY'], 'values[START_DAY]', '', $day_options,false, '') . '</div> &nbsp; <div class= col-sm-4>'. TextInput_time($start_time, 'values[START_TIME]', '', NULL) . '</div></div></div></div>';\n     echo '</div>'; //form-group\n+\n     echo '<div class=\"form-group\"><label class=\"control-label col-md-2 text-right\">To :</label>';\n-    echo '<div class=\"col-md-10\"><div class=\"form-inline\">' . SelectInput($arr['END_DAY'], 'values[END_DAY]', '', $day_options, false, '', false) . ' &nbsp; '. TextInput_time($end_time, 'values[END_TIME]', '', NULL) . '</div></div>';\n+    // echo '<div class=\"col-md-10\"><div class=\"form-inline\">' . SelectInput($arr['END_DAY'], 'values[END_DAY]', '', $day_options, false, '', false) . ' &nbsp; '. TextInput_time($end_time, 'values[END_TIME]', '', NULL) . '</div></div>';\n+    echo '<div class=\"col-md-10\"><div class=\"form-inline\"><div class=\"row\"><div class= col-sm-3>' . SelectInput($arr['END_DAY'], 'values[END_DAY]','', $day_options,false, '') . '</div> &nbsp; <div class= col-sm-4>'. TextInput_time($end_time, 'values[END_TIME]', '', NULL) . '</div></div></div></div>';\n     echo '</div>';\n } else {\n-    echo '<div class=\"form-group\"><div class=\"col-md-4\"><div class=\"form-inline\"><label class=\"control-label col-md-3\">From</label>' . SelectInput($START_DAY, 'values[START_DAY]', '', $day_options, false, '', false) . ' &nbsp; '. TextInput_time('', 'values[START_TIME]', '', NULL) . '</div></div></div>';\n-    echo '<div class=\"form-group\"><div class=\"col-md-4\"><div class=\"form-inline\"><label class=\"control-label col-md-2\">To</label>' . SelectInput($END_DAY, 'values[END_DAY]', '', $day_options, false, '', false) . ' &nbsp; ' . TextInput_time('', 'values[END_TIME]', '', NULL)  . '</div></div></div>';\n+    echo '<div class=\"form-group\"><label class=\"control-label col-md-2 text-right\">From :</label><div class=\"col-md-10\"><div class=\"form-inline\"><div class=\"row\"><div class= col-sm-3>' . SelectInput($START_DAY, 'values[START_DAY]', '', $day_options, false, '', false) . ' </div> &nbsp; <div class= col-sm-4>'. TextInput_time('', 'values[START_TIME]', '', NULL) . '</div></div></div></div></div>';\n+\n+    echo '<div class=\"form-group\"><label class=\"control-label col-md-2 text-right\">To :</label><div class=\"col-md-10\"><div class=\"form-inline\"><div class=\"row\"><div class= col-sm-3>' . SelectInput($END_DAY, 'values[END_DAY]', '', $day_options, false, '', false) . ' </div> &nbsp; <div class= col-sm-4>' . TextInput_time('', 'values[END_TIME]', '', NULL)  . '</div></div></div></div></div>';\n }\n+\n+\n $btn = SubmitButton('Save', '', 'class=\"btn btn-primary\" onclick=\"formcheck_eligibility_entrytimes();\"');\n echo '</div>';\n PopTable('footer',  $btn);\n echo '</FORM>';\n echo '</div>';\n echo '</div>';\n-?>\n\\ No newline at end of file\n+?>"
        },
        {
          "filename": "modules/grades/Assignments.php",
          "status": "modified",
          "additions": 9,
          "deletions": 6,
          "patch": "@@ -75,6 +75,7 @@\n     $table = trim($_REQUEST['table']);\n         $err=false;\n         $f=0;\n+\n \tforeach($_REQUEST['tables'] as $id=>$columns)\n \t{\n \t\tif($table=='gradebook_assignment_types' && substr($programconfig['WEIGHT'],0,1)=='Y' && $columns['FINAL_GRADE_PERCENT']!='')\n@@ -189,10 +190,11 @@\n                         }\n                     }\n \n-                                if((($column=='ASSIGNED_DATE'&& $value!='' && $due_date_sql[1]['ASSIGNED_DATE']!=$value) ||($column=='DUE_DATE'&& $value!='' && $due_date_sql[1]['DUE_DATE']!=$value) ) && $table=='gradebook_assignments')\n-                                {\n+                    if((($column=='ASSIGNED_DATE'&& $value!='' && $due_date_sql[1]['ASSIGNED_DATE']!=$value) ||($column=='DUE_DATE'&& $value!='' && $due_date_sql[1]['DUE_DATE']!=$value) ) && $table=='gradebook_assignments')\n+                    {\n \n-$grade_assign_qr=  DBGet(DBQuery('SELECT COUNT(STUDENT_ID) AS TOT FROM   student_report_card_grades WHERE  COURSE_PERIOD_ID='.$course_period_id.' and marking_period_id='.UserMP().''));\n+                        // $grade_assign_qr = DBGet(DBQuery('SELECT COUNT(STUDENT_ID) AS TOT FROM   student_report_card_grades WHERE  COURSE_PERIOD_ID='.$course_period_id.' and marking_period_id='.UserMP().''));\n+                        $grade_assign_qr = DBGet(DBQuery(\"SELECT COUNT(STUDENT_ID) AS TOT FROM   gradebook_grades WHERE ASSIGNMENT_ID = '\".$_REQUEST['assignment_id'].\"'\"));\n                         if($grade_assign_qr[1]['TOT']>0)\n                         {\n                             $f=1;\n@@ -201,10 +203,11 @@\n                     }\n \n \n-                                     if($column=='POINTS' && $value!='' && $table=='gradebook_assignments')\n-                                {\n+                    if($column=='POINTS' && $value!='' && $table=='gradebook_assignments')\n+                    {\n \n-$grade_assign_qr=  DBGet(DBQuery(\"SELECT COUNT(STUDENT_ID) AS TOT FROM   student_report_card_grades WHERE COURSE_PERIOD_ID='$course_period_id'\"));\n+                        // $grade_assign_qr = DBGet(DBQuery(\"SELECT COUNT(STUDENT_ID) AS TOT FROM   student_report_card_grades WHERE COURSE_PERIOD_ID='$course_period_id'\"));\n+                        $grade_assign_qr = DBGet(DBQuery(\"SELECT COUNT(STUDENT_ID) AS TOT FROM   gradebook_grades WHERE ASSIGNMENT_ID = '\".$_REQUEST['assignment_id'].\"'\"));\n                         if($grade_assign_qr[1]['TOT']>0)\n                         {\n                             $f=1;"
        },
        {
          "filename": "modules/schoolsetup/Courses.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -70,7 +70,7 @@\n     }\n }\n if ($_REQUEST['course_period_id'] != 'new') {\n-    if ($_REQUEST['tables']['course_periods'][$_REQUEST['course_period_id']]['SCHEDULE_TYPE'] == 'FIXED') { // echo 'sss';\n+    if ($_REQUEST['tables']['course_periods'][$_REQUEST['course_period_id']]['SCHEDULE_TYPE'] == 'FIXED') { \n         if ($_REQUEST['tables']['course_periods'][$_REQUEST['course_period_id']]['TOTAL_SEATS'] != '')\n             $total_seats = $_REQUEST['tables']['course_periods'][$_REQUEST['course_period_id']]['TOTAL_SEATS'];\n         else {\n@@ -369,7 +369,7 @@\n \n     if ($_REQUEST['tables']['parent_id'])\n         $_REQUEST['tables']['course_periods'][$_REQUEST['course_period_id']]['PARENT_ID'] = $_REQUEST['tables']['parent_id'];\n-    //===================================For custom range==========================\n+    //================================ For Custom Range ========================\n \n     if ($_REQUEST['month_begin'] && $_REQUEST['day_begin'] && $_REQUEST['year_begin']) {\n         while (!VerifyDate($begin = $_REQUEST['day_begin'] . '-' . $_REQUEST['month_begin'] . '-' . $_REQUEST['year_begin']))"
        },
        {
          "filename": "modules/students/AdvancedReport.php",
          "status": "modified",
          "additions": 7,
          "deletions": 4,
          "patch": "@@ -67,7 +67,7 @@\n     $extra['search'] .= '<div class=\"form-group\"><label>Include courses active as of</label>' . DateInputAY('', 'include_active_date', 1) . '</div>';\n     $extra['new'] = true;\n     include('modules/miscellaneous/Export.php');\n-    echo '<BR><CENTER><INPUT type=submit value=\\'Create Report for Selected Students\\' class=\"btn btn-primary\"></CENTER>';\n+    echo '<BR><CENTER><INPUT type=submit value=\\'Create Report for Selected Fields\\' class=\"btn btn-primary\"></CENTER>';\n     echo \"</FORM>\";\n }\n $modal_flag = 1;\n@@ -158,7 +158,8 @@\n         $extra['functions'] = array('CHECKBOX' => '_makeChooseCheckbox');\n //        $extra['SELECT'] = \",CONCAT('<INPUT type=checkbox name=st_arr[] value=',s.STUDENT_ID,' checked>') AS CHECKBOX\";\n \n-        $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick=\"checkAllDtMod(this,\\'st_arr\\');\"><A>');\n+        // $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick=\"checkAllDtMod(this,\\'st_arr\\');\"><A>');\n+        $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick=\"checkAllDtMod2(this,\\'st_arr\\');\"><A>');\n         $extra['options']['search'] = false;\n \n \n@@ -230,8 +231,10 @@\n \n function _makeChooseCheckbox($value, $title) {\n     global $THIS_RET;\n-//    return '<INPUT type=checkbox name=st_arr[] value=' . $value . ' checked>';\n+    // return '<INPUT type=checkbox name=st_arr[] value=' . $value . ' checked>';\n     \n-    return \"<input name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);' />\";\n+    // return \"<input name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);' />\";\n+\n+    return \"<input  class='student_label_cbx' name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);' />\";\n }\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "modules/students/PrintStudentInfo.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -278,6 +278,7 @@\n                ORDER BY ADDRESS ASC,CUSTODY ASC,STUDENT_RELATION ' ;\n                     $addresses_RET = DBGet(DBQuery($addr_sql));\n                     $address_previous = \"x\";\n+\n                     if($addresses_RET[1]['ADDRESS']=='' && $addresses_RET[2]['ADDRESS']!='' || $addresses_RET[2]['ADDRESS']!=$addresses_RET[1]['ADDRESS']){\n                         unset ($addresses_RET[1]);\n                     }\n@@ -513,7 +514,7 @@\n \n                     $contacts_RET2 = DBGet(DBQuery('SELECT p.STAFF_ID as PERSON_ID,p.FIRST_NAME,p.MIDDLE_NAME,p.LAST_NAME,p.CUSTODY,sjp.EMERGENCY_TYPE AS EMERGENCY,sjp.RELATIONSHIP AS STUDENT_RELATION FROM people p,students_join_people sjp WHERE p.STAFF_ID=sjp.PERSON_ID AND sjp.STUDENT_ID=' . UserStudentID()));\n                     foreach ($contacts_RET2 as $contact) {\n-                        echo '<B>' . $contact['FIRST_NAME'] . ' ' . ($contact['MIDDLE_NAME'] ? $contact['MIDDLE_NAME'] . ' ' : '') . $contact['LAST_NAME'] . ($contact['STUDENT_RELATION'] ? ': ' . $contact['STUDENT_RELATION'] : '') . ' &nbsp;</B>';\n+                        // echo '<B>' . $contact['FIRST_NAME'] . ' ' . ($contact['MIDDLE_NAME'] ? $contact['MIDDLE_NAME'] . ' ' : '') . $contact['LAST_NAME'] . ($contact['STUDENT_RELATION'] ? ': ' . $contact['STUDENT_RELATION'] : '') . ' &nbsp;</B>';\n \n \n                         foreach ($people_categories_RET as $categories)"
        },
        {
          "filename": "modules/students/Student.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -1824,7 +1824,7 @@\n                     }\n \n                     if (isset($_REQUEST['goal_id']) && $_REQUEST['goal_id'] != 'new' && !isset($_REQUEST['progress_id']))\n-                        $buttons = SubmitButton('Save', '', 'class=\"btn btn-primary pull-right\" onclick=\"formcheck_student_student();\"');\n+                        $buttons = SubmitButton('Save', '', 'id=\"mod_student_btn\" class=\"btn btn-primary pull-right\" onclick=\"formcheck_student_student();\"');\n                     else {\n                         if ($_REQUEST['student_id'] != 'new') {\n \n@@ -1833,15 +1833,15 @@\n                             $enrollment_info = DBGet(DBQuery('SELECT ENROLLMENT_CODE FROM student_enrollment WHERE STUDENT_ID=' . $student_id));\n                             $enrollment_code = $enrollment_info[1]['ENROLLMENT_CODE'];\n                             if ($_REQUEST['category_id'] == 1 && $enrollment_code == NULL)\n-                                $buttons = SubmitButton('Save', '', 'class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n+                                $buttons = SubmitButton('Save', '', 'id=\"mod_student_btn\" class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n                             else\n-                                $buttons = SubmitButton('Save', '', 'class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n+                                $buttons = SubmitButton('Save', '', 'id=\"mod_student_btn\" class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n                         }\n                         else {\n                             if ($_REQUEST['category_id'] == 1)\n-                                $buttons = SubmitButton('Save & Next', '', 'class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n+                                $buttons = SubmitButton('Save & Next', '', 'id=\"mod_student_btn\" class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n                             else\n-                                $buttons = SubmitButton('Save', '', 'class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n+                                $buttons = SubmitButton('Save', '', 'id=\"mod_student_btn\" class=\"btn btn-primary\" onclick=\"formcheck_student_student();\"');\n                         }\n                     }\n                     echo PopTable('footer',$buttons);"
        },
        {
          "filename": "modules/students/StudentLabels.php",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -44,7 +44,6 @@\n                     $extra['SELECT'] .= ',(SELECT GROUP_CONCAT(r.TITLE) AS ROOM  FROM course_period_var cpv,rooms r WHERE cpv.ROOM_ID=r.ROOM_ID AND cpv.COURSE_PERIOD_ID=\\'' . $_REQUEST[w_course_period_id] . '\\') AS ROOM';\n             }\n             else {\n-\n                 if ($_REQUEST['teacher'])\n                     $extra['SELECT'] .= ',(SELECT CONCAT(st.FIRST_NAME,\\'' . ' ' . '\\',st.LAST_NAME) FROM staff st,course_periods cp,school_periods p,schedule ss,course_period_var cpv WHERE cp.COURSE_PERIOD_ID=cpv.COURSE_PERIOD_ID AND st.STAFF_ID=cp.TEACHER_ID AND cpv.PERIOD_ID=p.PERIOD_ID AND p.ATTENDANCE=\\'' . 'Y' . '\\' AND cp.COURSE_PERIOD_ID=ss.COURSE_PERIOD_ID AND ss.STUDENT_ID=s.STUDENT_ID AND ss.SYEAR=\\'' . UserSyear() . '\\' ' . ($_REQUEST['_search_all_schools'] != 'Y' ? ' AND ss.MARKING_PERIOD_ID IN(' . $qtr . ') ' : '') . ' AND (ss.START_DATE<=\\'' . DBDate() . '\\' AND (ss.END_DATE>=\\'' . DBDate() . '\\' OR ss.END_DATE IS NULL)) ORDER BY p.SORT_ORDER LIMIT 1) AS TEACHER';\n                 if ($_REQUEST['room'])\n@@ -195,11 +194,11 @@\n     $extra['search'] .= '</div>';\n     $extra['search'] .= '</div>';\n \n-\n     $extra['link'] = array('FULL_NAME' => false);\n     $extra['SELECT'] = \",s.STUDENT_ID AS CHECKBOX\";\n     $extra['functions'] = array('CHECKBOX' => '_makeChooseCheckbox');\n-    $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick=\"checkAllDtMod(this,\\'st_arr\\');\"><A>');\n+    // $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onClick=\"checkAllDtMod(this,\\'st_arr\\')\"><A>');\n+    $extra['columns_before'] = array('CHECKBOX' => '</A><INPUT type=checkbox value=Y name=controller onclick=\"checkAllDtMod2(this,\\'st_arr\\');\"><A>');\n     $extra['options']['search'] = false;\n     $extra['new'] = true;\n \n@@ -248,7 +247,10 @@\n function _makeChooseCheckbox($value, $title) {\n     //    return '<INPUT type=checkbox name=st_arr[] value=' . $value . ' checked>';\n     global $THIS_RET;\n-    return \"<input name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);' />\";\n+\n+    // return \"<input name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);'/>\";\n+\n+    return \"<input  class='student_label_cbx' name=unused[$THIS_RET[STUDENT_ID]] value=\" . $THIS_RET[STUDENT_ID] . \"  type='checkbox' id=$THIS_RET[STUDENT_ID] onClick='setHiddenCheckboxStudents(\\\"st_arr[]\\\",this,$THIS_RET[STUDENT_ID]);' />\";\n }\n \n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "modules/students/includes/GeneralInfoInc.php",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -357,6 +357,16 @@\n echo '</div>'; //.row\n \n \n+if($student['USERNAME'] && $student['USERNAME'] != '')\n+{\n+    echo '<input id=\"stu_username_flag\" type=\"hidden\" value=\"1\">';\n+}\n+else\n+{\n+    echo '<input id=\"stu_username_flag\" type=\"hidden\" value=\"0\">';\n+}\n+\n+\n echo '<div class=\"row\">';\n if ($_REQUEST['student_id'] != 'new') {\n     echo '<div class=\"col-lg-6\">';"
        },
        {
          "filename": "modules/tools/Menu.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -29,14 +29,14 @@\n $menu['tools']['admin'] = array(\n \t\t\t\t\t\t\n                                'tools/LogDetails.php'=>'Access Log',\n-\t\t\t       'tools/DeleteLog.php'=>'Delete Log',\n+\t\t\t                         'tools/DeleteLog.php'=>'Delete Log',\n                                'tools/Rollover.php'=>'Rollover',\n                                'tools/Backup.php'=>'Backup Database',\n                                'tools/DataImport.php'=>'Data Import Utility',\n                                'tools/GenerateApi.php'=>'API Token',\n                                 1=>'Reports',  \n                                'tools/Reports.php?func=Basic'=>'At a Glance',\n                                'tools/Reports.php?func=Ins_r'=>'Institute Reports',\n-//                               'tools/Reports.php?func=Ins_cf'=>'Institute Custom Field Reports',                                \n+                               'tools/Reports.php?func=Ins_cf'=>'Institute Custom Field Reports',                                \n     );\n ?>"
        },
        {
          "filename": "modules/tools/Reports.php",
          "status": "modified",
          "additions": 10,
          "deletions": 9,
          "patch": "@@ -103,13 +103,15 @@\n     echo '</div>'; //.well\n     echo '</div>'; //.col-md-4\n     echo '</div>'; //.row\n-//    echo '<div id=\"d\"><TABLE align=center cellpadding=5 cellspacing=5>';\n-//    echo '<tr><td><b>Number of Institutions</b></td><td>:</td><td>&nbsp ' . $num_schools . ' &nbsp </td></tr>';\n-//    echo '<tr><td><b>Number of Students</b></td><td>:</td><td>&nbsp ' . $num_students . ' &nbsp </td><td> &nbsp Male : ' . $male . ' &nbsp| &nbspFemale : ' . $female . '</td></tr>';\n-//    echo '<tr><td><b>Number of Teachers</b></td><td>:</td><td colspan=2>&nbsp ' . $num_teacher . '</td></tr>';\n-//    echo '<tr><td><b>Number of Staff</b></td><td>:</td><td colspan=2>&nbsp ' . $num_staff . '</td></tr>';\n-//    echo '<tr><td><b>Number of Parents</b></td><td>:</td><td colspan=2>&nbsp ' . $num_parent . '</td></tr>';\n-//    echo '</TABLE></div>';\n+\n+    //    echo '<div id=\"d\"><TABLE align=center cellpadding=5 cellspacing=5>';\n+    //    echo '<tr><td><b>Number of Institutions</b></td><td>:</td><td>&nbsp ' . $num_schools . ' &nbsp </td></tr>';\n+    //    echo '<tr><td><b>Number of Students</b></td><td>:</td><td>&nbsp ' . $num_students . ' &nbsp </td><td> &nbsp Male : ' . $male . ' &nbsp| &nbspFemale : ' . $female . '</td></tr>';\n+    //    echo '<tr><td><b>Number of Teachers</b></td><td>:</td><td colspan=2>&nbsp ' . $num_teacher . '</td></tr>';\n+    //    echo '<tr><td><b>Number of Staff</b></td><td>:</td><td colspan=2>&nbsp ' . $num_staff . '</td></tr>';\n+    //    echo '<tr><td><b>Number of Parents</b></td><td>:</td><td colspan=2>&nbsp ' . $num_parent . '</td></tr>';\n+    //    echo '</TABLE></div>';\n+\n     echo '</div>';\n     echo '</div>';//.tabbable\n     echo '</div>';//.panel\n@@ -177,8 +179,7 @@\n                 }\n             }\n             echo '<br>';\n-            // print_r($arr);print_r($arr);\n-            // echo 'SELECT ID,' . $columns . ' FROM schools';\n+            \n             $get_school_info = DBGet(DBQuery('SELECT ID,' . $columns . ' FROM schools'));\n \n             echo '<br>';"
        },
        {
          "filename": "modules/users/Staff.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -839,26 +839,26 @@\n \n             if ($_REQUEST['staff_id'] != 'new') {\n                 if ($_REQUEST['category_id'] == 1 && ($username == '' || $password == '' || $this_school['JOINING_DATE'] == '')) {\n-                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save & Next', '', 'class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n+                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save & Next', '', 'id=\"mod_staff_btn\" class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n                 }\n                 if ($_REQUEST['category_id'] == 1 && $username != '' && $password != '' && $this_school['JOINING_DATE'] != '') {\n-                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n+                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'id=\"mod_staff_btn\" class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n                 }\n                 if ($_REQUEST['category_id'] != 1) {\n                     $btn_flag=1;\n                     if(User('PROFILE')=='admin' && $_REQUEST['modname']=='users/Staff.php' && isset($_REQUEST['include']) && $_REQUEST['include']=='ScheduleInc')\n                     $btn_flag=0;\n                     if($btn_flag==1)\n-                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n+                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'id=\"mod_staff_btn\" class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n                 }\n             } else {\n                 if ($_REQUEST['category_id'] != 3) {\n-                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save & Next', '', 'class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n+                    echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save & Next', '', 'id=\"mod_staff_btn\" class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n                 } else {\n                     if ($_SESSION[staff_school_chkbox_id] != '') {\n-                        echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(' . $_SESSION[staff_school_chkbox_id] . ');\"') . '</div></div>';\n+                        echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'id=\"mod_staff_btn\" class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(' . $_SESSION[staff_school_chkbox_id] . ');\"') . '</div></div>';\n                     } else\n-                        echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n+                        echo '<div class=\"panel-footer\"><div class=\"heading-elements\">' . SubmitButton('Save', '', 'id=\"mod_staff_btn\" class=\"btn btn-primary pull-right\" onClick=\"return formcheck_add_staff(0);\"') . '</div></div>';\n                     unset($_SESSION[staff_school_chkbox_id]);\n                 }\n             }"
        },
        {
          "filename": "modules/users/UserFields.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -227,7 +227,7 @@\n         if ($has_assigned > 0) {\n             UnableDeletePromptMod('Cannot delete becauses this people field is associated.');\n         } else {\n-            if (DeletePromptMod('staff field')) {\n+            if (DeletePromptMod('parent field')) {\n                 $id = clean_param($_REQUEST['id'], PARAM_INT);\n                 DBQuery('DELETE FROM people_fields WHERE ID=\\'' . $id . '\\'');\n                 DBQuery('ALTER TABLE people DROP COLUMN CUSTOM_' . $id . '');\n@@ -241,7 +241,7 @@\n         if ($has_assigned > 0) {\n             UnableDeletePromptMod('Cannot delete becauses this people field category is associated.');\n         } else {\n-            if (DeletePromptMod('staff field category and all fields in the category')) {\n+            if (DeletePromptMod('parent field category')) {\n                 $fields = DBGet(DBQuery('SELECT ID FROM people_fields WHERE CATEGORY_ID=\\'' . $_REQUEST[category_id] . '\\''));\n                 foreach ($fields as $field) {\n                     DBQuery('DELETE FROM people_fields WHERE ID=\\'' . $field[ID] . '\\'');"
        },
        {
          "filename": "modules/users/includes/SchoolsInfoInc.php",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -768,7 +768,7 @@\n             echo '<div class=\"col-lg-6\">';\n             echo '<div class=\"form-group\"><label class=\"control-label text-right col-lg-4\">Username <span class=text-danger>*</span></label><div class=\"col-lg-8\">';\n             if (!$this_school_mod['USERNAME']) {\n-                echo TextInput('', 'USERNAME', '', 'size=20 maxlength=50 onblur=\"usercheck_init_staff(this)\"');\n+                echo TextInput('', 'USERNAME', '', 'size=20 maxlength=50 onkeyup=\"usercheck_init_staff_2(this)\" onblur=\"usercheck_init_staff(this)\"');\n                 echo '<span id=\"ajax_output_st\"></span><input type=hidden id=usr_err_check value=0>';\n             } else {\n                 echo NoInput($this_school_mod['USERNAME'], '', '', 'onkeyup=\"usercheck_init(this)\"') . '<div id=\"ajax_output\"></div>';\n@@ -787,6 +787,15 @@\n             echo \"<span id='passwordStrength'></span></div></div>\";\n             echo '</div>'; //.col-lg-6\n             echo '</div>'; //.row\n+\n+            if($this_school_mod['USERNAME'] && $this_school_mod['USERNAME'] != '')\n+            {\n+                echo '<input id=\"staff_username_flag\" type=\"hidden\" value=\"1\">';\n+            }\n+            else\n+            {\n+                echo '<input id=\"staff_username_flag\" type=\"hidden\" value=\"0\">';\n+            }\n             \n             echo '<div class=\"row\">';\n             echo '<div class=\"col-md-6\">';"
        },
        {
          "filename": "opensis_databackup/feeder.sql",
          "status": "removed",
          "additions": 0,
          "deletions": 4007,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 12,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4a5ccdc050e13d8f3d97b9d776c129228c74ab10",
            "date": "2024-02-06T12:31:51Z",
            "author_login": "sayan-os4ed"
          },
          {
            "sha": "b28124728b16279ebfdfc3262a6d9633a7bce2fa",
            "date": "2024-02-06T12:30:43Z",
            "author_login": "sayan-os4ed"
          },
          {
            "sha": "87c2d326055597284011ea10f2491e91050d4a45",
            "date": "2024-02-03T17:27:01Z",
            "author_login": "discapacidad5"
          },
          {
            "sha": "5333adc4e84516b810d48ae5b3e519ec0857ac87",
            "date": "2024-02-03T17:19:43Z",
            "author_login": "discapacidad5"
          },
          {
            "sha": "53407797404f05612b774e233bec52951986013b",
            "date": "2023-12-23T17:23:16Z",
            "author_login": "openSISAdmin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "openSIS before 7.4 allows SQL Injection.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-07-01T15:15:13.063",
    "last_modified": "2024-11-21T05:01:08.380",
    "fix_date": "2020-04-25T21:45:25Z"
  },
  "references": [
    {
      "url": "https://github.com/OS4ED/openSIS-Responsive-Design/commit/1127ae0bb7c3a2883febeabc6b71ad8d73510de8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packetstormsecurity.com/files/158257/openSIS-7.4-SQL-Injection.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/OS4ED/openSIS-Responsive-Design/commit/1127ae0bb7c3a2883febeabc6b71ad8d73510de8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packetstormsecurity.com/files/158257/openSIS-7.4-SQL-Injection.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:01.349382",
    "processing_status": "enhanced"
  }
}