{
  "cve_id": "CVE-2020-13432",
  "github_data": {
    "repository": "rejetto/hfs2",
    "fix_commit": "b8ebfc4e22948e1a61506cd66e397b61ea5ea5de",
    "related_commits": [
      "b8ebfc4e22948e1a61506cd66e397b61ea5ea5de",
      "b8ebfc4e22948e1a61506cd66e397b61ea5ea5de"
    ],
    "patch_url": "https://github.com/rejetto/hfs2/commit/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de.patch",
    "fix_commit_details": {
      "sha": "b8ebfc4e22948e1a61506cd66e397b61ea5ea5de",
      "commit_date": "2020-05-19T16:07:23Z",
      "author": {
        "login": "rejetto",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "limit URL parameters to 1000 characters",
        "length": 39,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 79,
        "additions": 47,
        "deletions": 32
      },
      "files": [
        {
          "filename": "main.dfm",
          "status": "modified",
          "additions": 38,
          "deletions": 27,
          "patch": "@@ -2,8 +2,8 @@ object mainFrm: TmainFrm\n   Left = 293\n   Top = 219\n   Caption = 'HFS ~ HTTP File Server'\n-  ClientHeight = 391\n-  ClientWidth = 913\n+  ClientHeight = 483\n+  ClientWidth = 879\n   Color = clBtnFace\n   Constraints.MinHeight = 260\n   Constraints.MinWidth = 390\n@@ -27,7 +27,7 @@ object mainFrm: TmainFrm\n   object graphSplitter: TSplitter\n     Left = 0\n     Top = 78\n-    Width = 913\n+    Width = 879\n     Height = 5\n     Cursor = crVSplit\n     Align = alTop\n@@ -42,7 +42,7 @@ object mainFrm: TmainFrm\n   object graphBox: TPaintBox\n     Left = 0\n     Top = 48\n-    Width = 913\n+    Width = 879\n     Height = 30\n     Hint = 'Pink = Out'#13#10'Yellow = In'\n     Align = alTop\n@@ -62,7 +62,7 @@ object mainFrm: TmainFrm\n   object topToolbar: TToolBar\n     Left = 0\n     Top = 0\n-    Width = 913\n+    Width = 879\n     Height = 24\n     AutoSize = True\n     ButtonWidth = 150\n@@ -78,6 +78,7 @@ object mainFrm: TmainFrm\n     ParentFont = False\n     ShowCaptions = True\n     TabOrder = 1\n+    ExplicitWidth = 976\n     object menuBtn: TToolButton\n       Left = 0\n       Top = 0\n@@ -173,7 +174,7 @@ object mainFrm: TmainFrm\n   object urlToolbar: TToolBar\n     Left = 0\n     Top = 24\n-    Width = 913\n+    Width = 879\n     Height = 24\n     AutoSize = True\n     ButtonWidth = 122\n@@ -189,6 +190,7 @@ object mainFrm: TmainFrm\n     ShowCaptions = True\n     TabOrder = 2\n     Wrapable = False\n+    ExplicitWidth = 976\n     object browseBtn: TToolButton\n       Left = 0\n       Top = 0\n@@ -217,8 +219,8 @@ object mainFrm: TmainFrm\n   object centralPnl: TPanel\n     Left = 0\n     Top = 83\n-    Width = 913\n-    Height = 308\n+    Width = 879\n+    Height = 400\n     Align = alClient\n     BevelOuter = bvNone\n     Font.Charset = DEFAULT_CHARSET\n@@ -228,10 +230,11 @@ object mainFrm: TmainFrm\n     Font.Style = []\n     ParentFont = False\n     TabOrder = 0\n+    ExplicitWidth = 976\n     object splitV: TSplitter\n       Left = 313\n       Top = 0\n-      Height = 197\n+      Height = 289\n       Beveled = True\n       Constraints.MaxWidth = 3\n       Constraints.MinWidth = 3\n@@ -241,8 +244,8 @@ object mainFrm: TmainFrm\n     end\n     object splitH: TSplitter\n       Left = 0\n-      Top = 197\n-      Width = 913\n+      Top = 289\n+      Width = 879\n       Height = 5\n       Cursor = crVSplit\n       Align = alBottom\n@@ -256,16 +259,17 @@ object mainFrm: TmainFrm\n     object logPnl: TPanel\n       Left = 316\n       Top = 0\n-      Width = 597\n-      Height = 197\n+      Width = 563\n+      Height = 289\n       Align = alClient\n       BevelOuter = bvNone\n       TabOrder = 1\n+      ExplicitWidth = 660\n       object logBox: TRichEdit\n         Left = 0\n         Top = 23\n-        Width = 597\n-        Height = 174\n+        Width = 563\n+        Height = 266\n         Align = alClient\n         Font.Charset = ANSI_CHARSET\n         Font.Color = clWindowText\n@@ -282,34 +286,38 @@ object mainFrm: TmainFrm\n         Zoom = 100\n         OnChange = logBoxChange\n         OnMouseDown = logBoxMouseDown\n+        ExplicitWidth = 660\n       end\n       object logTitle: TPanel\n         Left = 0\n         Top = 0\n-        Width = 597\n+        Width = 563\n         Height = 23\n         Align = alTop\n         BevelOuter = bvNone\n         TabOrder = 1\n+        ExplicitWidth = 660\n         object titlePnl: TPanel\n           Left = 0\n           Top = 0\n-          Width = 337\n+          Width = 303\n           Height = 23\n           Align = alClient\n           BevelOuter = bvNone\n           Caption = 'Log'\n           TabOrder = 0\n+          ExplicitWidth = 400\n         end\n         object logToolbar: TPanel\n-          Left = 337\n+          Left = 303\n           Top = 0\n           Width = 260\n           Height = 23\n           Align = alRight\n           AutoSize = True\n           BevelOuter = bvNone\n           TabOrder = 1\n+          ExplicitLeft = 400\n           object collapsedPnl: TPanel\n             Left = 0\n             Top = 0\n@@ -557,7 +565,7 @@ object mainFrm: TmainFrm\n       Left = 0\n       Top = 0\n       Width = 313\n-      Height = 197\n+      Height = 289\n       Align = alLeft\n       BevelOuter = bvNone\n       Caption = 'filesPnl'\n@@ -566,7 +574,7 @@ object mainFrm: TmainFrm\n         Left = 0\n         Top = 23\n         Width = 313\n-        Height = 174\n+        Height = 266\n         Align = alClient\n         BevelInner = bvLowered\n         BevelOuter = bvSpace\n@@ -616,28 +624,30 @@ object mainFrm: TmainFrm\n     end\n     object connPnl: TPanel\n       Left = 0\n-      Top = 202\n-      Width = 913\n+      Top = 294\n+      Width = 879\n       Height = 106\n       Align = alBottom\n       BevelOuter = bvNone\n       TabOrder = 2\n+      ExplicitWidth = 976\n       object sbar: TStatusBar\n         Left = 0\n         Top = 87\n-        Width = 913\n+        Width = 879\n         Height = 19\n         Panels = <\n           item\n             Width = 2000\n           end>\n         OnDblClick = sbarDblClick\n         OnMouseDown = sbarMouseDown\n+        ExplicitWidth = 976\n       end\n       object connBox: TListView\n         Left = 0\n         Top = 0\n-        Width = 913\n+        Width = 879\n         Height = 87\n         Align = alClient\n         Columns = <\n@@ -660,6 +670,7 @@ object mainFrm: TmainFrm\n           item\n             Alignment = taCenter\n             Caption = 'Speed'\n+            Width = 100\n           end\n           item\n             Alignment = taCenter\n@@ -684,6 +695,7 @@ object mainFrm: TmainFrm\n         ViewStyle = vsReport\n         OnAdvancedCustomDrawSubItem = connBoxAdvancedCustomDrawSubItem\n         OnData = connBoxData\n+        ExplicitWidth = 976\n       end\n     end\n   end\n@@ -3153,8 +3165,8 @@ object mainFrm: TmainFrm\n   object connmenu: TPopupMenu\n     Images = images\n     OnPopup = connmenuPopup\n-    Left = 248\n-    Top = 320\n+    Left = 264\n+    Top = 408\n     object Kickconnection1: TMenuItem\n       Caption = 'Kick connection'\n       OnClick = Kickconnection1Click\n@@ -3272,7 +3284,6 @@ object mainFrm: TmainFrm\n       object logRequestsChk: TMenuItem\n         AutoCheck = True\n         Caption = 'Requests'\n-        Checked = True\n       end\n       object DumprequestsChk: TMenuItem\n         AutoCheck = True"
        },
        {
          "filename": "main.pas",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -4781,6 +4781,8 @@ procedure Tmainfrm.httpEvent(event:ThttpEvent; conn:ThttpConn);\n   end; // limitsExceededOnDownload\n \n   procedure extractParams();\n+  const\n+    MAX = 1000;\n   var\n     s: string;\n     i: integer;\n@@ -4790,7 +4792,12 @@ procedure Tmainfrm.httpEvent(event:ThttpEvent; conn:ThttpConn);\n   s:=replaceStr(s,'+',' ');\n   data.urlvars.text:=s;\n   for i:=0 to data.urlvars.count-1 do\n-    data.urlvars[i]:=decodeURL(ansistring(data.urlvars[i]));\n+    begin\n+    s:=decodeURL(ansistring(data.urlvars[i]));\n+    if length(s) > MAX then\n+      setLength(s, MAX);\n+    data.urlvars[i]:=s;\n+    end;\n   end; // extractParams\n \n   procedure closeUploadingFile();"
        },
        {
          "filename": "scriptLib.pas",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -1783,10 +1783,7 @@ function cbMacros(fullMacro:string; pars:Tstrings; cbData:pointer):string;\n       end;\n \n     if not mainfrm.enableMacrosChk.checked then\n-      begin\n-      result:=fullMacro;\n-      exit;\n-      end;\n+      exit(fullMacro);\n \n     if pars.count = 0 then exit;\n     // extract first parameter as 'name'"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "140528bac87e4ae37d444b218b5ef6ff793edc80",
            "date": "2023-03-12T16:42:10Z",
            "author_login": "rejetto"
          },
          {
            "sha": "29f6bac31c94651b18474cec9e489ce376abbb34",
            "date": "2020-08-30T21:26:11Z",
            "author_login": "rejetto"
          },
          {
            "sha": "e233f6d29ab533906c1dea5763a8227a7f2bb5f9",
            "date": "2020-08-04T20:39:02Z",
            "author_login": "rejetto"
          },
          {
            "sha": "6e4dcf5b56a149bbecfb4fbb6d4cb361303ba07b",
            "date": "2020-08-04T19:16:37Z",
            "author_login": "rejetto"
          },
          {
            "sha": "61f1a14be6ae310b60a65838842174dbdad02dd5",
            "date": "2020-08-02T16:31:17Z",
            "author_login": "rejetto"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-120",
    "description": "rejetto HFS (aka HTTP File Server) v2.3m Build #300, when virtual files or folders are used, allows remote attackers to trigger an invalid-pointer write access violation via concurrent HTTP requests with a long URI or long HTTP headers.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-06-08T18:15:11.710",
    "last_modified": "2024-11-21T05:01:15.097",
    "fix_date": "2020-05-19T16:07:23Z"
  },
  "references": [
    {
      "url": "http://hyp3rlinx.altervista.org/advisories/HFS-HTTP-FILE-SERVER-v2.3-REMOTE-BUFFER-OVERFLOW-DoS.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/157980/HFS-Http-File-Server-2.3m-Build-300-Buffer-Overflow.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2020/Jun/13",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2021/Apr/12",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/rejetto/hfs2/commit/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packetstormsecurity.com/files/157980/HFS-Http-File-Server-2.3m-Build-300-Buffer-Overflow.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://www.rejetto.com/hfs/?f=wn",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://hyp3rlinx.altervista.org/advisories/HFS-HTTP-FILE-SERVER-v2.3-REMOTE-BUFFER-OVERFLOW-DoS.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/157980/HFS-Http-File-Server-2.3m-Build-300-Buffer-Overflow.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2020/Jun/13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2021/Apr/12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/rejetto/hfs2/commit/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packetstormsecurity.com/files/157980/HFS-Http-File-Server-2.3m-Build-300-Buffer-Overflow.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://www.rejetto.com/hfs/?f=wn",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.839999",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "hfs2",
    "owner": "rejetto",
    "created_at": "2020-05-02T14:34:09Z",
    "updated_at": "2025-01-12T15:04:39Z",
    "pushed_at": "2023-03-25T11:45:23Z",
    "size": 748,
    "stars": 624,
    "forks": 139,
    "open_issues": 25,
    "watchers": 624,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Pascal": 919262,
      "Smarty": 61905,
      "Batchfile": 3188,
      "POV-Ray SDL": 270
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:48:42.768437"
  }
}