{
  "cve_id": "CVE-2020-13798",
  "github_data": {
    "repository": "NavigateCMS/Navigate-CMS",
    "fix_commit": "e690bb5d7bbe9df9052b13c403ca0ac5e58054d4",
    "related_commits": [
      "e690bb5d7bbe9df9052b13c403ca0ac5e58054d4",
      "e690bb5d7bbe9df9052b13c403ca0ac5e58054d4"
    ],
    "patch_url": "https://github.com/NavigateCMS/Navigate-CMS/commit/e690bb5d7bbe9df9052b13c403ca0ac5e58054d4.patch",
    "fix_commit_details": {
      "sha": "e690bb5d7bbe9df9052b13c403ca0ac5e58054d4",
      "commit_date": "2020-05-17T14:16:05Z",
      "author": {
        "login": "NavigateCMS",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "+ HTML Purify some fields to prevent XSS attacks",
        "length": 48,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 197,
        "additions": 142,
        "deletions": 55
      },
      "files": [
        {
          "filename": "lib/packages/feeds/feed.class.php",
          "status": "modified",
          "additions": 53,
          "deletions": 13,
          "patch": "@@ -52,6 +52,8 @@ public function load_from_resultset($rs)\n \t\r\n \tpublic function load_from_post()\r\n \t{\r\n+\t    global $purifier;\r\n+\r\n \t\t$this->permission\t= intval($_REQUEST['permission']);\r\n \t\t$this->enabled\t\t= intval($_REQUEST['enabled']);\r\n \t\t$this->format  \t\t= $_REQUEST['format'];\r\n@@ -67,31 +69,42 @@ public function load_from_post()\n \t\t\r\n \t\tforeach($_REQUEST as $key => $value)\r\n \t\t{\r\n-\t\t\tif(empty($value)) continue;\r\n+\t\t\tif(empty($value))\r\n+            {\r\n+                continue;\r\n+            }\r\n \t\t\t\r\n \t\t\tforeach($fields as $field)\r\n \t\t\t{\r\n \t\t\t\tif(substr($key, 0, strlen($field.'-'))==$field.'-')\r\n-\t\t\t\t\t$this->dictionary[substr($key, strlen($field.'-'))][$field] = $value;\r\n+                {\r\n+                    $this->dictionary[substr($key, strlen($field.'-'))][$field] = $purifier->purify($value);\r\n+                }\r\n \t\t\t}\r\n \t\t\r\n \t\t\tif(substr($key, 0, strlen('path-'))=='path-')\r\n-\t\t\t\t$this->paths[substr($key, strlen('path-'))] = $value;\r\n+            {\r\n+                $this->paths[substr($key, strlen('path-'))] = $purifier->purify($value);\r\n+            }\r\n \t\t}\t\r\n \t\t\r\n \t\t$this->categories \t= '';\r\n \t\tif($_REQUEST['categories']!='true')\r\n-\t\t\t$this->categories\t= explode(',', $_REQUEST['categories']);\t\t\t\t\r\n+        {\r\n+            $this->categories\t= explode(',', $_REQUEST['categories']);\r\n+        }\r\n \t}\r\n \r\n \tpublic function save()\r\n \t{\r\n-\t\tglobal $DB;\r\n-\r\n \t\tif(!empty($this->id))\r\n-\t\t\treturn $this->update();\r\n+        {\r\n+            return $this->update();\r\n+        }\r\n \t\telse\r\n-\t\t\treturn $this->insert();\t\t\t\r\n+        {\r\n+            return $this->insert();\r\n+        }\r\n \t}\r\n \t\r\n \tpublic function delete()\r\n@@ -159,7 +172,9 @@ public function insert()\n \t\t);\r\n \r\n         if(!$ok)\r\n+        {\r\n             throw new Exception($DB->get_last_error());\r\n+        }\r\n \r\n \t\t$this->id = $DB->get_last_id();\r\n \t\t\t\r\n@@ -208,7 +223,9 @@ public function update()\n \t\t);\r\n \t\t\t\t\t\t\t  \r\n \t\tif(!$ok)\r\n-\t\t    throw new Exception($DB->get_last_error());\r\n+        {\r\n+            throw new Exception($DB->get_last_error());\r\n+        }\r\n \t\t\r\n \t\twebdictionary::save_element_strings('feed', $this->id, $this->dictionary);\r\n \t\tpath::saveElementPaths('feed', $this->id, $this->paths);\r\n@@ -248,7 +265,9 @@ public function quicksearch($text)\n \t\t$cols[] = 'i.id' . $like;\r\n \r\n \t\tif(!empty($dict_ids))\r\n-\t\t\t$cols[] = 'i.id IN ('.implode(',', $dict_ids).')';\r\n+        {\r\n+            $cols[] = 'i.id IN ('.implode(',', $dict_ids).')';\r\n+        }\r\n \t\t\t\r\n \t\t$where = ' AND ( ';\t\r\n \t\t$where.= implode( ' OR ', $cols); \r\n@@ -264,15 +283,19 @@ public static function generate_feed($id = NULL)\n \t\tglobal $DB;\r\n \t\r\n \t\tif(empty($id))\r\n-\t\t\t$id = $current['id'];\r\n+        {\r\n+            $id = $current['id'];\r\n+        }\r\n \r\n \t\t$item = new feed();\r\n \t\t$item->load($id);\r\n \t\t\r\n \t\t$permission = nvweb_object_enabled($item);\r\n \t\r\n \t\tif(!$permission)\r\n+        {\r\n             return;\r\n+        }\r\n \r\n         $feed = new UniversalFeedCreator();\r\n \t\t\r\n@@ -296,7 +319,10 @@ public static function generate_feed($id = NULL)\n \t\tif(!empty($item->categories[0]))\r\n \t\t{\t\t\t\r\n \t\t\t$limit = intval($item->entries);\t\t \r\n-\t\t\tif($limit <= 0)\t$limit = 10;\r\n+\t\t\tif($limit <= 0)\r\n+            {\r\n+                $limit = 10;\r\n+            }\r\n \r\n             $DB->query(' SELECT SQL_CALC_FOUND_ROWS i.id, i.permission, i.date_published, i.date_unpublish,\r\n                                 i.date_to_display, COALESCE(NULLIF(i.date_to_display, 0), i.date_created) as pdate, d.text as title, i.position as position,\r\n@@ -380,7 +406,9 @@ public static function generate_feed($id = NULL)\n                         $galleries = mb_unserialize($rs[$x]->galleries);\r\n                         $photo = @array_shift(array_keys($galleries[0]));\r\n                         if(!empty($photo))\r\n+                        {\r\n                             $image = $website->absolute_path(false) . '/object?type=image&id='.$photo;\r\n+                        }\r\n                     }\r\n \r\n                     if(empty($image))\r\n@@ -393,9 +421,13 @@ public static function generate_feed($id = NULL)\n                             if($properties[$p]->type=='image')\r\n                             {\r\n                                 if(!empty($properties[$p]->value))\r\n+                                {\r\n                                     $image = $properties[$p]->value;\r\n+                                }\r\n                                 else if(!empty($properties[$p]->dvalue))\r\n+                                {\r\n                                     $image = $properties[$p]->dvalue;\r\n+                                }\r\n \r\n                                 if(is_array($image))\r\n                                 {\r\n@@ -404,12 +436,16 @@ public static function generate_feed($id = NULL)\n                                 }\r\n \r\n                                 if(!empty($image))\r\n+                                {\r\n                                     $image = $website->absolute_path(false) . '/object?type=image&id='.$image;\r\n+                                }\r\n                             }\r\n \r\n                             // we only need the first image\r\n                             if(!empty($image))\r\n+                            {\r\n                                 break;\r\n+                            }\r\n                         }\r\n                     }\r\n \r\n@@ -418,7 +454,9 @@ public static function generate_feed($id = NULL)\n                         $fitem->image = $image;\r\n \t                    // feedly will only display images of >450px --> http://blog.feedly.com/2015/07/31/10-ways-to-optimize-your-feed-for-feedly/\r\n \t\t\t\t\t\tif(strpos($item->format, 'RSS')!==false)\r\n-\t\t\t\t\t\t\t$fitem->description = '<img src=\"'.$image.'&width=640\"><br />'.$fitem->description;\r\n+                        {\r\n+                            $fitem->description = '<img src=\"'.$image.'&width=640\"><br />'.$fitem->description;\r\n+                        }\r\n \t\t\t\t\t}\r\n \r\n \t\t\t\t\t//$item->author = $contents->rows[$x]->author_name;\r\n@@ -460,7 +498,9 @@ public function backup($type='json')\n         $out = $DB->result();\r\n \r\n         if($type='json')\r\n+        {\r\n             $out = json_encode($out);\r\n+        }\r\n \r\n         return $out;\r\n     }\r"
        },
        {
          "filename": "lib/packages/menus/menu.class.php",
          "status": "modified",
          "additions": 22,
          "deletions": 10,
          "patch": "@@ -42,7 +42,10 @@ public function load_from_resultset($rs)\n \t\t$this->functions = $DB->result('function_id');\r\n \t\t*/\r\n \t\t$this->functions\t= json_decode($main->functions);\r\n-\t\tif(empty($this->functions))\t$this->functions = array();\t\t\r\n+\t\tif(empty($this->functions))\r\n+        {\r\n+            $this->functions = array();\r\n+        }\r\n \t}\r\n \t\r\n \tpublic function load_from_post()\r\n@@ -59,19 +62,22 @@ public function load_from_post()\n \t\tforeach($functions as $function)\r\n \t\t{\r\n \t\t\tif(!empty($function))\r\n-\t\t\t\t$this->functions[] = $function;\r\n+            {\r\n+                $this->functions[] = $function;\r\n+            }\r\n \t\t}\r\n-\t}\t\r\n-\t\r\n+\t}\r\n \t\r\n \tpublic function save()\r\n \t{\r\n-\t\tglobal $DB;\r\n-\r\n \t\tif(!empty($this->id))\r\n-\t\t  return $this->update();\r\n+        {\r\n+            return $this->update();\r\n+        }\r\n \t\telse\r\n-\t\t  return $this->insert();\r\n+        {\r\n+            return $this->insert();\r\n+        }\r\n \t}\r\n \t\r\n \tpublic function delete()\r\n@@ -111,7 +117,9 @@ public function insert()\n \t\t);\r\n \t\t\t\t\r\n \t\tif(!$ok)\r\n-\t\t\tthrow new Exception($DB->get_last_error());\r\n+        {\r\n+            throw new Exception($DB->get_last_error());\r\n+        }\r\n \t\t\r\n \t\t$this->id = $DB->get_last_id();\r\n \t\t\r\n@@ -139,7 +147,9 @@ functions = :functions, enabled = :enabled\n         );\r\n \t\t\r\n \t\tif(!$ok)\r\n-\t\t\tthrow new Exception($DB->get_last_error());\r\n+        {\r\n+            throw new Exception($DB->get_last_error());\r\n+        }\r\n \t\t\r\n \t\treturn true;\r\n \t}\r\n@@ -179,7 +189,9 @@ public function backup($type='json')\n         $out = $DB->result();\r\n \r\n         if($type='json')\r\n+        {\r\n             $out = json_encode($out);\r\n+        }\r\n \r\n         return $out;\r\n     }\r"
        },
        {
          "filename": "lib/packages/menus/menus.php",
          "status": "modified",
          "additions": 61,
          "deletions": 29,
          "patch": "@@ -58,12 +58,14 @@ function run()\n                     }\r\n                     $orderby = $_REQUEST['sidx'].' '.$_REQUEST['sord'];\r\n \t\t\t\t\r\n-\t\t\t\t\t$DB->queryLimit('id,lid,codename,icon,enabled', \r\n-\t\t\t\t\t\t\t\t\t'nv_menus', \r\n-\t\t\t\t\t\t\t\t\t$where, \r\n-\t\t\t\t\t\t\t\t\t$orderby, \r\n-\t\t\t\t\t\t\t\t\t$offset, \r\n-\t\t\t\t\t\t\t\t\t$max);\r\n+\t\t\t\t\t$DB->queryLimit(\r\n+\t\t\t\t\t    'id,lid,codename,icon,enabled',\r\n+                        'nv_menus',\r\n+                        $where,\r\n+                        $orderby,\r\n+                        $offset,\r\n+                        $max\r\n+                    );\r\n \t\t\t\t\t\t\t\t\t\r\n \t\t\t\t\t$dataset = $DB->result();\r\n \t\t\t\t\t$total = $DB->foundRows();\r\n@@ -152,9 +154,13 @@ function functions_list()\n \t\r\n \t$navibars->title(t(244, 'Menus'));\r\n \r\n-\t$navibars->add_actions(\tarray(\t'<a href=\"?fid='.$_REQUEST['fid'].'&act=2\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/add.png\"> '.t(38, 'Create').'</a>',\r\n-\t\t\t\t\t\t\t\t\t'<a href=\"?fid='.$_REQUEST['fid'].'&act=0\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/application_view_list.png\"> '.t(39, 'List').'</a>',\r\n-\t\t\t\t\t\t\t\t\t'search_form' ));\r\n+\t$navibars->add_actions(\r\n+\t    array(\r\n+\t        '<a href=\"?fid='.$_REQUEST['fid'].'&act=2\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/add.png\"> '.t(38, 'Create').'</a>',\r\n+\t\t\t'<a href=\"?fid='.$_REQUEST['fid'].'&act=0\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/application_view_list.png\"> '.t(39, 'List').'</a>',\r\n+\t\t\t'search_form'\r\n+        )\r\n+    );\r\n \t\r\n \tif($_REQUEST['quicksearch']=='true')\r\n     {\r\n@@ -189,9 +195,13 @@ function functions_form($item)\n \t$naviforms = new naviforms();\r\n \t\r\n \tif(empty($item->id))\r\n-\t\t$navibars->title(t(244, 'Menus').' / '.t(38, 'Create'));\t\r\n+    {\r\n+        $navibars->title(t(244, 'Menus').' / '.t(38, 'Create'));\r\n+    }\r\n \telse\r\n-\t\t$navibars->title(t(244, 'Menus').' / '.t(170, 'Edit').' ['.$item->id.']');\t\t\r\n+    {\r\n+        $navibars->title(t(244, 'Menus').' / '.t(170, 'Edit').' ['.$item->id.']');\r\n+    }\r\n \r\n \tif(empty($item->id))\r\n \t{\r\n@@ -221,9 +231,13 @@ function() { window.location.href = \"?fid=menus&act=delete&id='.$item->id.'\"; },\n         ');\r\n \t}\r\n \t\r\n-\t$navibars->add_actions(\tarray(\t(!empty($item->id)? '<a href=\"?fid=menus&act=2\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/add.png\"> '.t(38, 'Create').'</a>' : ''),\r\n-\t\t\t\t\t\t\t\t\t'<a href=\"?fid=menus&act=0\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/application_view_list.png\"> '.t(39, 'List').'</a>',\r\n-\t\t\t\t\t\t\t\t\t'search_form' ));\r\n+\t$navibars->add_actions(\r\n+\t    array(\r\n+\t        (!empty($item->id)? '<a href=\"?fid=menus&act=2\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/add.png\"> '.t(38, 'Create').'</a>' : ''),\r\n+\t\t\t'<a href=\"?fid=menus&act=0\"><img height=\"16\" align=\"absmiddle\" width=\"16\" src=\"img/icons/silk/application_view_list.png\"> '.t(39, 'List').'</a>',\r\n+\t\t\t'search_form'\r\n+        )\r\n+    );\r\n \r\n \t$navibars->form();\r\n \r\n@@ -290,7 +304,10 @@ function() { window.location.href = \"?fid=menus&act=delete&id='.$item->id.'\"; },\n \t$sortable_assigned[] = '<ul id=\"sortable_assigned\" class=\"connectedSortable\">';\r\n \t$sortable_unassigned[] = '<ul id=\"sortable_unassigned\" class=\"connectedSortable\">';\t\r\n \t\r\n-\tif(empty($item->functions)) $item->functions = array();\r\n+\tif(empty($item->functions))\r\n+    {\r\n+        $item->functions = array();\r\n+    }\r\n \t\r\n \t// already included menus on the profile\r\n \tforeach($item->functions as $f)\r\n@@ -300,9 +317,13 @@ function() { window.location.href = \"?fid=menus&act=delete&id='.$item->id.'\"; },\n \t\t\tif($function->id == $f)\r\n \t\t\t{\r\n \t\t\t\tif($function->enabled=='1')\r\n-\t\t\t\t\t$sortable_assigned[] = '<li class=\"ui-state-highlight\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+                {\r\n+                    $sortable_assigned[] = '<li class=\"ui-state-highlight\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+                }\r\n \t\t\t\telse\r\n-\t\t\t\t\t$sortable_assigned[] = '<li class=\"ui-state-highlight ui-state-disabled\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+                {\r\n+                    $sortable_assigned[] = '<li class=\"ui-state-highlight ui-state-disabled\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+                }\r\n \t\t\t}\t\t\t\r\n \t\t}\r\n \t}\r\n@@ -313,9 +334,13 @@ function() { window.location.href = \"?fid=menus&act=delete&id='.$item->id.'\"; },\n \t\tif(!in_array($function->id, $item->functions))\r\n \t\t{\r\n \t\t\tif($function->enabled=='1')\r\n-\t\t\t\t$sortable_unassigned[] = '<li class=\"ui-state-default\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+            {\r\n+                $sortable_unassigned[] = '<li class=\"ui-state-default\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+            }\r\n \t\t\telse\r\n-\t\t\t\t$sortable_unassigned[] = '<li class=\"ui-state-default ui-state-disabled\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+            {\r\n+                $sortable_unassigned[] = '<li class=\"ui-state-default ui-state-disabled\" value=\"'.$function->id.'\" category=\"'.$function->category.'\"><img src=\"'.NAVIGATE_URL.'/'.$function->icon.'\" align=\"absmiddle\" /> '.t($function->lid, $function->lid).'</li>';\r\n+            }\r\n \t\t}\r\n \t}\r\n \t\r\n@@ -325,17 +350,24 @@ function() { window.location.href = \"?fid=menus&act=delete&id='.$item->id.'\"; },\n \t//$navibars->add_tab_content('<pre>'.print_r($item->menus, true).'</pre>'); // margin-top: 12px; margin-left: 5px; float: left;\r\n \t// position: absolute; margin-left: 483px; margin-top: -9px; width: 291px; height: 20px;\r\n \r\n-\t$navibars->add_tab_content_row(array(\t'<label>'.t(78, 'Category').'</label>',\r\n-\t\t\t\t\t\t\t\t\t\t\t$naviforms->selectfield('menus_functions_category_select', $func_cats, $func_cats, 'web', \"navigate_menus_change_functions_category();\", false)\r\n-\t\t\t\t\t\t\t\t\t\t)\r\n-\t\t\t\t\t\t\t\t\t);\r\n+\t$navibars->add_tab_content_row(\r\n+\t    array(\r\n+\t        '<label>'.t(78, 'Category').'</label>',\r\n+\t\t\t$naviforms->selectfield('menus_functions_category_select', $func_cats, $func_cats, 'web', \"navigate_menus_change_functions_category();\", false)\r\n+        )\r\n+    );\r\n \t\r\n-\t$navibars->add_tab_content($naviforms->hidden(\"menu-functions\", implode('#', $item->functions)));\t\r\n-\t$navibars->add_tab_content_row(array(\t'<label>'.t(240, 'Functions').'</label>',\r\n-\t\t\t\t\t\t\t\t\t\t\timplode(\"\\n\", $sortable_assigned),\r\n-\t\t\t\t\t\t\t\t\t\t\timplode(\"\\n\", $sortable_unassigned)\r\n-\t\t\t\t\t\t\t\t\t\t)\r\n-\t\t\t\t\t\t\t\t\t);\r\n+\t$navibars->add_tab_content(\r\n+\t    $naviforms->hidden(\"menu-functions\", implode('#', $item->functions))\r\n+    );\r\n+\r\n+\t$navibars->add_tab_content_row(\r\n+\t    array(\r\n+\t        '<label>'.t(240, 'Functions').'</label>',\r\n+\t\t\timplode(\"\\n\", $sortable_assigned),\r\n+\t\t\timplode(\"\\n\", $sortable_unassigned)\r\n+        )\r\n+    );\r\n \t\t\t\t\t\t\t\t\t\r\n \t$layout->add_script('\r\n \t\t$(\"#menus_functions_category_select\").css({ \"width\": \"300px\", \"margin-left\": \"303px\" });\r"
        },
        {
          "filename": "lib/packages/structure/structure.class.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -83,6 +83,8 @@ public function load_from_resultset($rs)\n \t\r\n \tpublic function load_from_post()\r\n \t{\r\n+\t    global $purifier;\r\n+\r\n \t\tif(intval($_REQUEST['parent'])!=$this->id)\t// protection against selecting this same category as parent of itself\r\n         {\r\n             $this->parent \t\t= intval($_REQUEST['parent']);\r\n@@ -119,13 +121,13 @@ public function load_from_post()\n \t\t\t{\r\n \t\t\t\tif(substr($key, 0, strlen($field.'-'))==$field.'-')\r\n                 {\r\n-                    $this->dictionary[substr($key, strlen($field.'-'))][$field] = $value;\r\n+                    $this->dictionary[substr($key, strlen($field.'-'))][$field] = $purifier->purify($value);\r\n                 }\r\n \t\t\t}\r\n \t\t\r\n \t\t\tif(substr($key, 0, strlen('path-'))=='path-')\r\n             {\r\n-                $this->paths[substr($key, strlen('path-'))] = $value;\r\n+                $this->paths[substr($key, strlen('path-'))] = $purifier->purify($value);\r\n             }\r\n \t\t}\t\t\r\n \t}\r"
        },
        {
          "filename": "lib/packages/websites/website.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -168,6 +168,7 @@ public function load_from_resultset($rs)\n \tpublic function load_from_post()\r\n \t{\r\n         global $theme;\r\n+        global $purifier;\r\n \r\n \t\t$ws_theme = $theme;\r\n \t\tif($this->theme != $theme->name)\r\n@@ -176,7 +177,7 @@ public function load_from_post()\n \t\t\t$ws_theme->load($this->theme);\r\n \t\t}\r\n \r\n-\t\t$this->name\t\t\t\t= $_REQUEST['title'];\r\n+\t\t$this->name\t\t\t\t= $purifier->purify($_REQUEST['title']);\r\n \t\t\r\n \t\t$this->protocol\t\t\t= $_REQUEST['protocol'];\r\n \t\t$this->subdomain\t\t= $_REQUEST['subdomain'];\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "abbdf661397eb953b29ca7545c08295e086db2a2",
            "date": "2023-05-21T08:48:06Z",
            "author_login": "NavigateCMS"
          },
          {
            "sha": "92ec28b7ea58aa617f338c4b2b20c20a9c678adc",
            "date": "2023-05-21T08:22:43Z",
            "author_login": "NavigateCMS"
          },
          {
            "sha": "e1cf0ee0d1b27213e54913c532f7f6a03d7b2049",
            "date": "2023-05-14T07:24:26Z",
            "author_login": "NavigateCMS"
          },
          {
            "sha": "8674e0b5dc1a918e5075c64fd8b4519b57d8e55b",
            "date": "2023-05-14T07:23:22Z",
            "author_login": "NavigateCMS"
          },
          {
            "sha": "dad8cc80f3b48acae27f656c84618c70daf36ea7",
            "date": "2023-05-14T07:21:12Z",
            "author_login": "NavigateCMS"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "An issue was discovered in Navigate CMS through 2.8.7. It allows XSS because of a lack of purify calls in lib/packages/feeds/feed.class.php.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-06-03T22:15:11.440",
    "last_modified": "2024-11-21T05:01:52.880",
    "fix_date": "2020-05-17T14:16:05Z"
  },
  "references": [
    {
      "url": "https://github.com/NavigateCMS/Navigate-CMS/commit/e690bb5d7bbe9df9052b13c403ca0ac5e58054d4",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NavigateCMS/Navigate-CMS/commit/e690bb5d7bbe9df9052b13c403ca0ac5e58054d4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.831662",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Navigate-CMS",
    "owner": "NavigateCMS",
    "created_at": "2011-10-10T06:39:08Z",
    "updated_at": "2024-03-12T12:36:58Z",
    "pushed_at": "2023-05-21T08:48:10Z",
    "size": 137522,
    "stars": 8,
    "forks": 4,
    "open_issues": 3,
    "watchers": 8,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3154678,
      "JavaScript": 1006156,
      "CSS": 311979,
      "HTML": 147096,
      "Less": 5592,
      "Hack": 232
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:59:13.887073"
  }
}