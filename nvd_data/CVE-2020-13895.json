{
  "cve_id": "CVE-2020-13895",
  "github_data": {
    "repository": "FGasper/p5-Crypt-Perl",
    "fix_commit": "f960ce75502acf7404187231a706672f8369acb2",
    "related_commits": [
      "f960ce75502acf7404187231a706672f8369acb2",
      "f960ce75502acf7404187231a706672f8369acb2"
    ],
    "patch_url": "https://github.com/FGasper/p5-Crypt-Perl/commit/f960ce75502acf7404187231a706672f8369acb2.patch",
    "fix_commit_details": {
      "sha": "f960ce75502acf7404187231a706672f8369acb2",
      "commit_date": "2020-06-04T12:27:02Z",
      "author": {
        "login": "FGasper",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix ECDSA verify when r and s are small.",
        "length": 86,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 362,
        "additions": 362,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/Crypt/Perl/ECDSA/KeyBase.pm",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -216,6 +216,8 @@ sub _get_jwk_curve_name {\n sub _verify {\n     my ($self, $msg, $r, $s) = @_;\n \n+    $_ = Crypt::Perl::BigInt->new($_) for ($r, $s);\n+\n     if ($r->is_positive() && $s->is_positive()) {\n         my ($x, $y) = Crypt::Perl::ECDSA::Utils::split_G_or_public( $self->_decompress_public_point() );\n         $_ = Crypt::Perl::BigInt->from_bytes($_) for ($x, $y);"
        },
        {
          "filename": "t/google_wycheoproof.t",
          "status": "added",
          "additions": 360,
          "deletions": 0,
          "patch": "@@ -0,0 +1,360 @@\n+#!/usr/bin/env perl\n+\n+use strict;\n+use warnings;\n+\n+use Crypt::Perl::ECDSA;\n+use Crypt::Perl::ECDSA::Generate;\n+use Crypt::Perl::ECDSA::Parse;\n+use Digest::SHA;\n+use JSON;\n+use Carp::Always;\n+\n+use Test::More;\n+use Test::FailWarnings;\n+\n+my $file_content = <<'END';\n+{\n+  \"algorithm\" : \"ECDSA\",\n+  \"generatorVersion\" : \"0.8r12\",\n+  \"numberOfTests\" : 387,\n+  \"header\" : [\n+    \"Test vectors of type EcdsaVerify are meant for the verification\",\n+    \"of ASN encoded ECDSA signatures.\"\n+  ],\n+  \"notes\" : {\n+    \"BER\" : \"This is a signature with correct values for (r, s) but using some alternative BER encoding instead of DER encoding. Implementations should not accept such signatures to limit signature malleability.\",\n+    \"EdgeCase\" : \"Edge case values such as r=1 and s=0 can lead to forgeries if the ECDSA implementation does not check boundaries and computes s^(-1)==0.\",\n+    \"MissingZero\" : \"Some implementations of ECDSA and DSA incorrectly encode r and s by not including leading zeros in the ASN encoding of integers when necessary. Hence, some implementations (e.g. jdk) allow signatures with incorrect ASN encodings assuming that the signature is otherwise valid.\",\n+    \"PointDuplication\" : \"Some implementations of ECDSA do not handle duplication and points at infinity correctly. This is a test vector that has been specially crafted to check for such an omission.\"\n+  },\n+  \"schema\" : \"ecdsa_verify_schema.json\",\n+  \"testGroups\" : [\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"04a71af64de5126a4a4e02b7922d66ce9415ce88a4c9d25514d91082c8725ac9575d47723c8fbe580bb369fec9c2665d8e30a435b9932645482e7c9f11e872296b\",\n+        \"wx\" : \"00a71af64de5126a4a4e02b7922d66ce9415ce88a4c9d25514d91082c8725ac957\",\n+        \"wy\" : \"5d47723c8fbe580bb369fec9c2665d8e30a435b9932645482e7c9f11e872296b\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d03010703420004a71af64de5126a4a4e02b7922d66ce9415ce88a4c9d25514d91082c8725ac9575d47723c8fbe580bb369fec9c2665d8e30a435b9932645482e7c9f11e872296b\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEpxr2TeUSakpOAreSLWbOlBXOiKTJ\\n0lUU2RCCyHJayVddR3I8j75YC7Np/snCZl2OMKQ1uZMmRUgufJ8R6HIpaw==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 290,\n+          \"comment\" : \"small r and s\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3006020105020101\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"046627cec4f0731ea23fc2931f90ebe5b7572f597d20df08fc2b31ee8ef16b15726170ed77d8d0a14fc5c9c3c4c9be7f0d3ee18f709bb275eaf2073e258fe694a5\",\n+        \"wx\" : \"6627cec4f0731ea23fc2931f90ebe5b7572f597d20df08fc2b31ee8ef16b1572\",\n+        \"wy\" : \"6170ed77d8d0a14fc5c9c3c4c9be7f0d3ee18f709bb275eaf2073e258fe694a5\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200046627cec4f0731ea23fc2931f90ebe5b7572f597d20df08fc2b31ee8ef16b15726170ed77d8d0a14fc5c9c3c4c9be7f0d3ee18f709bb275eaf2073e258fe694a5\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEZifOxPBzHqI/wpMfkOvlt1cvWX0g\\n3wj8KzHujvFrFXJhcO132NChT8XJw8TJvn8NPuGPcJuyderyBz4lj+aUpQ==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 291,\n+          \"comment\" : \"small r and s\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3006020105020103\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"045a7c8825e85691cce1f5e7544c54e73f14afc010cb731343262ca7ec5a77f5bfef6edf62a4497c1bd7b147fb6c3d22af3c39bfce95f30e13a16d3d7b2812f813\",\n+        \"wx\" : \"5a7c8825e85691cce1f5e7544c54e73f14afc010cb731343262ca7ec5a77f5bf\",\n+        \"wy\" : \"00ef6edf62a4497c1bd7b147fb6c3d22af3c39bfce95f30e13a16d3d7b2812f813\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200045a7c8825e85691cce1f5e7544c54e73f14afc010cb731343262ca7ec5a77f5bfef6edf62a4497c1bd7b147fb6c3d22af3c39bfce95f30e13a16d3d7b2812f813\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWnyIJehWkczh9edUTFTnPxSvwBDL\\ncxNDJiyn7Fp39b/vbt9ipEl8G9exR/tsPSKvPDm/zpXzDhOhbT17KBL4Ew==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 292,\n+          \"comment\" : \"small r and s\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3006020105020105\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"04cbe0c29132cd738364fedd603152990c048e5e2fff996d883fa6caca7978c73770af6a8ce44cb41224b2603606f4c04d188e80bff7cc31ad5189d4ab0d70e8c1\",\n+        \"wx\" : \"00cbe0c29132cd738364fedd603152990c048e5e2fff996d883fa6caca7978c737\",\n+        \"wy\" : \"70af6a8ce44cb41224b2603606f4c04d188e80bff7cc31ad5189d4ab0d70e8c1\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d03010703420004cbe0c29132cd738364fedd603152990c048e5e2fff996d883fa6caca7978c73770af6a8ce44cb41224b2603606f4c04d188e80bff7cc31ad5189d4ab0d70e8c1\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEy+DCkTLNc4Nk/t1gMVKZDASOXi//\\nmW2IP6bKynl4xzdwr2qM5Ey0EiSyYDYG9MBNGI6Av/fMMa1RidSrDXDowQ==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 293,\n+          \"comment\" : \"small r and s\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3006020105020106\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        },\n+        {\n+          \"tcId\" : 294,\n+          \"comment\" : \"r is larger than n\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3026022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632556020106\",\n+          \"result\" : \"invalid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"044be4178097002f0deab68f0d9a130e0ed33a6795d02a20796db83444b037e13920f13051e0eecdcfce4dacea0f50d1f247caa669f193c1b4075b51ae296d2d56\",\n+        \"wx\" : \"4be4178097002f0deab68f0d9a130e0ed33a6795d02a20796db83444b037e139\",\n+        \"wy\" : \"20f13051e0eecdcfce4dacea0f50d1f247caa669f193c1b4075b51ae296d2d56\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200044be4178097002f0deab68f0d9a130e0ed33a6795d02a20796db83444b037e13920f13051e0eecdcfce4dacea0f50d1f247caa669f193c1b4075b51ae296d2d56\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAES+QXgJcALw3qto8NmhMODtM6Z5XQ\\nKiB5bbg0RLA34Tkg8TBR4O7Nz85NrOoPUNHyR8qmafGTwbQHW1GuKW0tVg==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 295,\n+          \"comment\" : \"s is larger than n\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3026020105022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc75fbd8\",\n+          \"result\" : \"invalid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"04d0f73792203716afd4be4329faa48d269f15313ebbba379d7783c97bf3e890d9971f4a3206605bec21782bf5e275c714417e8f566549e6bc68690d2363c89cc1\",\n+        \"wx\" : \"00d0f73792203716afd4be4329faa48d269f15313ebbba379d7783c97bf3e890d9\",\n+        \"wy\" : \"00971f4a3206605bec21782bf5e275c714417e8f566549e6bc68690d2363c89cc1\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d03010703420004d0f73792203716afd4be4329faa48d269f15313ebbba379d7783c97bf3e890d9971f4a3206605bec21782bf5e275c714417e8f566549e6bc68690d2363c89cc1\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE0Pc3kiA3Fq/UvkMp+qSNJp8VMT67\\nujedd4PJe/PokNmXH0oyBmBb7CF4K/XidccUQX6PVmVJ5rxoaQ0jY8icwQ==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 296,\n+          \"comment\" : \"small r and s^-1\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3027020201000221008f1e3c7862c58b16bb76eddbb76eddbb516af4f63f2d74d76e0d28c9bb75ea88\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"044838b2be35a6276a80ef9e228140f9d9b96ce83b7a254f71ccdebbb8054ce05ffa9cbc123c919b19e00238198d04069043bd660a828814051fcb8aac738a6c6b\",\n+        \"wx\" : \"4838b2be35a6276a80ef9e228140f9d9b96ce83b7a254f71ccdebbb8054ce05f\",\n+        \"wy\" : \"00fa9cbc123c919b19e00238198d04069043bd660a828814051fcb8aac738a6c6b\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200044838b2be35a6276a80ef9e228140f9d9b96ce83b7a254f71ccdebbb8054ce05ffa9cbc123c919b19e00238198d04069043bd660a828814051fcb8aac738a6c6b\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAESDiyvjWmJ2qA754igUD52bls6Dt6\\nJU9xzN67uAVM4F/6nLwSPJGbGeACOBmNBAaQQ71mCoKIFAUfy4qsc4psaw==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 297,\n+          \"comment\" : \"smallish r and s^-1\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"302c02072d9b4d347952d6022100ef3043e7329581dbb3974497710ab11505ee1c87ff907beebadd195a0ffe6d7a\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"047393983ca30a520bbc4783dc9960746aab444ef520c0a8e771119aa4e74b0f64e9d7be1ab01a0bf626e709863e6a486dbaf32793afccf774e2c6cd27b1857526\",\n+        \"wx\" : \"7393983ca30a520bbc4783dc9960746aab444ef520c0a8e771119aa4e74b0f64\",\n+        \"wy\" : \"00e9d7be1ab01a0bf626e709863e6a486dbaf32793afccf774e2c6cd27b1857526\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200047393983ca30a520bbc4783dc9960746aab444ef520c0a8e771119aa4e74b0f64e9d7be1ab01a0bf626e709863e6a486dbaf32793afccf774e2c6cd27b1857526\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEc5OYPKMKUgu8R4PcmWB0aqtETvUg\\nwKjncRGapOdLD2Tp174asBoL9ibnCYY+akhtuvMnk6/M93Tixs0nsYV1Jg==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 298,\n+          \"comment\" : \"100-bit r and small s^-1\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3032020d1033e67e37b32b445580bf4eff0221008b748b74000000008b748b748b748b7466e769ad4a16d3dcd87129b8e91d1b4d\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"045ac331a1103fe966697379f356a937f350588a05477e308851b8a502d5dfcdc5fe9993df4b57939b2b8da095bf6d794265204cfe03be995a02e65d408c871c0b\",\n+        \"wx\" : \"5ac331a1103fe966697379f356a937f350588a05477e308851b8a502d5dfcdc5\",\n+        \"wy\" : \"00fe9993df4b57939b2b8da095bf6d794265204cfe03be995a02e65d408c871c0b\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200045ac331a1103fe966697379f356a937f350588a05477e308851b8a502d5dfcdc5fe9993df4b57939b2b8da095bf6d794265204cfe03be995a02e65d408c871c0b\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEWsMxoRA/6WZpc3nzVqk381BYigVH\\nfjCIUbilAtXfzcX+mZPfS1eTmyuNoJW/bXlCZSBM/gO+mVoC5l1AjIccCw==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 299,\n+          \"comment\" : \"small r and 100 bit s^-1\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"302702020100022100ef9f6ba4d97c09d03178fa20b4aaad83be3cf9cb824a879fec3270fc4b81ef5b\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"041d209be8de2de877095a399d3904c74cc458d926e27bb8e58e5eae5767c41509dd59e04c214f7b18dce351fc2a549893a6860e80163f38cc60a4f2c9d040d8c9\",\n+        \"wx\" : \"1d209be8de2de877095a399d3904c74cc458d926e27bb8e58e5eae5767c41509\",\n+        \"wy\" : \"00dd59e04c214f7b18dce351fc2a549893a6860e80163f38cc60a4f2c9d040d8c9\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200041d209be8de2de877095a399d3904c74cc458d926e27bb8e58e5eae5767c41509dd59e04c214f7b18dce351fc2a549893a6860e80163f38cc60a4f2c9d040d8c9\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEHSCb6N4t6HcJWjmdOQTHTMRY2Sbi\\ne7jljl6uV2fEFQndWeBMIU97GNzjUfwqVJiTpoYOgBY/OMxgpPLJ0EDYyQ==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 300,\n+          \"comment\" : \"100-bit r and s^-1\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3032020d062522bbd3ecbe7c39e93e7c25022100ef9f6ba4d97c09d03178fa20b4aaad83be3cf9cb824a879fec3270fc4b81ef5b\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"04083539fbee44625e3acaafa2fcb41349392cef0633a1b8fabecee0c133b10e99915c1ebe7bf00df8535196770a58047ae2a402f26326bb7d41d4d7616337911e\",\n+        \"wx\" : \"083539fbee44625e3acaafa2fcb41349392cef0633a1b8fabecee0c133b10e99\",\n+        \"wy\" : \"00915c1ebe7bf00df8535196770a58047ae2a402f26326bb7d41d4d7616337911e\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d03010703420004083539fbee44625e3acaafa2fcb41349392cef0633a1b8fabecee0c133b10e99915c1ebe7bf00df8535196770a58047ae2a402f26326bb7d41d4d7616337911e\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAECDU5++5EYl46yq+i/LQTSTks7wYz\\nobj6vs7gwTOxDpmRXB6+e/AN+FNRlncKWAR64qQC8mMmu31B1NdhYzeRHg==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 301,\n+          \"comment\" : \"r and s^-1 are close to n\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"3045022100ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc6324d50220555555550000000055555555555555553ef7a8e48d07df81a693439654210c70\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    },\n+    {\n+      \"key\" : {\n+        \"curve\" : \"secp256r1\",\n+        \"keySize\" : 256,\n+        \"type\" : \"EcPublicKey\",\n+        \"uncompressed\" : \"048aeb368a7027a4d64abdea37390c0c1d6a26f399e2d9734de1eb3d0e1937387405bd13834715e1dbae9b875cf07bd55e1b6691c7f7536aef3b19bf7a4adf576d\",\n+        \"wx\" : \"008aeb368a7027a4d64abdea37390c0c1d6a26f399e2d9734de1eb3d0e19373874\",\n+        \"wy\" : \"05bd13834715e1dbae9b875cf07bd55e1b6691c7f7536aef3b19bf7a4adf576d\"\n+      },\n+      \"keyDer\" : \"3059301306072a8648ce3d020106082a8648ce3d030107034200048aeb368a7027a4d64abdea37390c0c1d6a26f399e2d9734de1eb3d0e1937387405bd13834715e1dbae9b875cf07bd55e1b6691c7f7536aef3b19bf7a4adf576d\",\n+      \"keyPem\" : \"-----BEGIN PUBLIC KEY-----\\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEius2inAnpNZKveo3OQwMHWom85ni\\n2XNN4es9Dhk3OHQFvRODRxXh266bh1zwe9VeG2aRx/dTau87Gb96St9XbQ==\\n-----END PUBLIC KEY-----\",\n+      \"sha\" : \"SHA-256\",\n+      \"type\" : \"EcdsaVerify\",\n+      \"tests\" : [\n+        {\n+          \"tcId\" : 302,\n+          \"comment\" : \"s == 1\",\n+          \"msg\" : \"313233343030\",\n+          \"sig\" : \"30250220555555550000000055555555555555553ef7a8e48d07df81a693439654210c70020101\",\n+          \"result\" : \"valid\",\n+          \"flags\" : []\n+        }\n+      ]\n+    }\n+  ]\n+}\n+END\n+\n+my $json = JSON->new;\n+my $data = $json->decode($file_content);\n+\n+\n+diag \"Parsing...\";\n+\n+my $aref = $data->{testGroups};\n+for my $element (@$aref) {\n+    my $public = Crypt::Perl::ECDSA::Parse::public($element->{keyPem});\n+    my $bref = $element->{tests};\n+\n+    for my $test (@$bref) {\n+        my $msg_bytes = pack \"H*\", $test->{msg};\n+        my $sig_bytes = pack \"H*\", $test->{sig};\n+        my $hash = Digest::SHA::sha256($msg_bytes);\n+\n+            my $result = $public->verify($hash, $sig_bytes);\n+\n+            is(\n+                $test->{result} eq \"valid\" || $test->{result} eq \"acceptable\",\n+                !!$result,\n+                \"tcId: $test->{tcId}\",\n+            );\n+\n+    }\n+}\n+\n+done_testing;"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6c08b11b6191ff13628e566c4c4c9b39b226c917",
            "date": "2022-10-17T15:03:24Z",
            "author_login": "FGasper"
          },
          {
            "sha": "99df48f16d1fff7734a47013addd0ac46e83a9ca",
            "date": "2022-10-17T13:52:50Z",
            "author_login": "FGasper"
          },
          {
            "sha": "ed47f3e32d11b817a77d8aa35d13ca0a5e5de82b",
            "date": "2022-10-17T13:46:16Z",
            "author_login": "FGasper"
          },
          {
            "sha": "2fa167f2f55d2f6f0cec9fd18ecce073c764c764",
            "date": "2022-10-17T13:44:17Z",
            "author_login": "FGasper"
          },
          {
            "sha": "a5a9050f8cb6b0ebda166a9ea717ef2bf2a5a745",
            "date": "2022-10-17T12:47:21Z",
            "author_login": "FGasper"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-347",
    "description": "Crypt::Perl::ECDSA in the Crypt::Perl (aka p5-Crypt-Perl) module before 0.32 for Perl fails to verify correct ECDSA signatures when r and s are small and when s = 1. This happens when using the curve secp256r1 (prime256v1). This could conceivably have a security-relevant impact if an attacker wishes to use public r and s values when guessing whether signature verification will fail.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-06-07T01:15:10.550",
    "last_modified": "2024-11-21T05:02:05.990",
    "fix_date": "2020-06-04T12:27:02Z"
  },
  "references": [
    {
      "url": "https://github.com/FGasper/p5-Crypt-Perl/commit/f960ce75502acf7404187231a706672f8369acb2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FGasper/p5-Crypt-Perl/issues/14",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FGasper/p5-Crypt-Perl/commit/f960ce75502acf7404187231a706672f8369acb2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FGasper/p5-Crypt-Perl/issues/14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.838562",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "p5-Crypt-Perl",
    "owner": "FGasper",
    "created_at": "2016-12-10T18:48:15Z",
    "updated_at": "2023-01-06T20:52:56Z",
    "pushed_at": "2024-06-03T14:14:04Z",
    "size": 1081,
    "stars": 4,
    "forks": 4,
    "open_issues": 8,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Perl": 416253,
      "Raku": 2915
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:18:41.406872"
  }
}