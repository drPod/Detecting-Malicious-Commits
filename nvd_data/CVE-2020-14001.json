{
  "cve_id": "CVE-2020-14001",
  "github_data": {
    "repository": "gettalong/kramdown",
    "fix_commit": "1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde",
    "related_commits": [
      "1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde",
      "1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde"
    ],
    "patch_url": "https://github.com/gettalong/kramdown/commit/1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde.patch",
    "fix_commit_details": {
      "sha": "1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde",
      "commit_date": "2020-06-27T12:47:21Z",
      "author": {
        "login": "gettalong",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add option forbidden_inline_options",
        "length": 270,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 18,
        "additions": 18,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/kramdown/options.rb",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -589,6 +589,16 @@ def self.simple_hash_validator(val, name)\n       Used by: HTML converter\n     EOF\n \n+    define(:forbidden_inline_options, Object, %w[template], <<~EOF) do |val|\n+      Defines the options that may not be set using the {::options} extension\n+\n+      Default: template\n+      Used by: HTML converter\n+    EOF\n+      val.map! {|item| item.kind_of?(String) ? str_to_sym(item) : item }\n+      simple_array_validator(val, :forbidden_inline_options)\n+    end\n+\n   end\n \n end"
        },
        {
          "filename": "lib/kramdown/parser/kramdown/extensions.rb",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -110,6 +110,12 @@ def handle_extension(name, opts, body, type, line_no = nil)\n           opts.select do |k, v|\n             k = k.to_sym\n             if Kramdown::Options.defined?(k)\n+              if @options[:forbidden_inline_options].include?(k) ||\n+                  k == :forbidden_inline_options\n+                warning(\"Option #{k} may not be set inline\")\n+                next false\n+              end\n+\n               begin\n                 val = Kramdown::Options.parse(k, v)\n                 @options[k] = val"
        },
        {
          "filename": "test/testcases/block/12_extension/options.text",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -19,3 +19,5 @@ some <span>*para*</span>\n Some text[^ab].\n \n [^ab]: Some text.\n+\n+{::options template=\"/etc/passwd\" /}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fc051a9d93e4dc3ff05bf41b70a79297ebdb669f",
            "date": "2024-11-18T16:39:17Z",
            "author_login": "gettalong"
          },
          {
            "sha": "d8057be46573a24c9f35af118376077551435a0e",
            "date": "2024-11-18T16:38:49Z",
            "author_login": "gettalong"
          },
          {
            "sha": "415315f282337cfe0f4d9a5be5eaa06580dadb3d",
            "date": "2024-11-18T09:08:59Z",
            "author_login": "gettalong"
          },
          {
            "sha": "e5a9d64caaf3a455341919f76c778e4068c008ee",
            "date": "2024-11-18T08:14:09Z",
            "author_login": "gettalong"
          },
          {
            "sha": "b970b40f26f2634c89c1f4677e8e70474cb98dd0",
            "date": "2024-11-17T22:14:25Z",
            "author_login": "gettalong"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-862",
    "description": "The kramdown gem before 2.3.0 for Ruby processes the template option inside Kramdown documents by default, which allows unintended read access (such as template=\"/etc/passwd\") or unintended embedded Ruby code execution (such as a string that begins with template=\"string://<%= `). NOTE: kramdown is used in Jekyll, GitLab Pages, GitHub Pages, and Thredded Forum.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-07-17T16:15:11.230",
    "last_modified": "2024-11-21T05:02:19.567",
    "fix_date": "2020-06-27T12:47:21Z"
  },
  "references": [
    {
      "url": "https://github.com/gettalong/kramdown",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gettalong/kramdown/commit/1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gettalong/kramdown/compare/REL_2_2_1...REL_2_3_0",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://kramdown.gettalong.org",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://kramdown.gettalong.org/news.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r96df7899fbb456fe2705882f710a0c8e8614b573fbffd8d12e3f54d2%40%3Cnotifications.fluo.apache.org%3E",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00014.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ENMMGKHRQIZ3QKGOMBBBGB6B4LB5I7NQ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KBLTGBYU7NKOUOHDKVCU4GFZMGA6BP4L/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://rubygems.org/gems/kramdown",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20200731-0004/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4562-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4743",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gettalong/kramdown",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gettalong/kramdown/commit/1b8fd33c3120bfc6e5164b449e2c2fc9c9306fde",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gettalong/kramdown/compare/REL_2_2_1...REL_2_3_0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://kramdown.gettalong.org",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://kramdown.gettalong.org/news.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r96df7899fbb456fe2705882f710a0c8e8614b573fbffd8d12e3f54d2%40%3Cnotifications.fluo.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00014.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ENMMGKHRQIZ3QKGOMBBBGB6B4LB5I7NQ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KBLTGBYU7NKOUOHDKVCU4GFZMGA6BP4L/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://rubygems.org/gems/kramdown",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20200731-0004/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://usn.ubuntu.com/4562-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4743",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:01.369126",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "kramdown",
    "owner": "gettalong",
    "created_at": "2008-11-30T08:32:47Z",
    "updated_at": "2025-01-12T11:11:14Z",
    "pushed_at": "2024-11-18T16:41:59Z",
    "size": 3487,
    "stars": 1722,
    "forks": 277,
    "open_issues": 9,
    "watchers": 1722,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Ruby": 363976,
      "HTML": 73840,
      "Shell": 2818,
      "Roff": 2025
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T22:59:47.494074"
  }
}