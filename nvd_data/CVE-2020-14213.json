{
  "cve_id": "CVE-2020-14213",
  "github_data": {
    "repository": "zammad/zammad",
    "fix_commit": "6e56aee25439b7a3211a6704a9d60453ad623ae4",
    "related_commits": [
      "6e56aee25439b7a3211a6704a9d60453ad623ae4",
      "6e56aee25439b7a3211a6704a9d60453ad623ae4"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "6e56aee25439b7a3211a6704a9d60453ad623ae4",
      "commit_date": "2020-05-05T08:50:03Z",
      "author": {
        "login": "rolfschmidt",
        "type": "User",
        "stats": {
          "total_commits": 863,
          "average_weekly_commits": 1.289985052316891,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 237
        }
      },
      "commit_message": {
        "title": "Enhancement: Added authorization checks for ticket controller actions: ticket_customer ticket_history ticket_related ticket_recent ticket_merge ticket_split.",
        "length": 157,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 45,
        "additions": 43,
        "deletions": 2
      },
      "files": [
        {
          "filename": "app/controllers/tickets_controller.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@ class TicketsController < ApplicationController\n   include ChecksUserAttributesByCurrentUserPermission\n   include TicketStats\n \n-  prepend_before_action -> { authorize! }, only: %i[create selector import_example import_start]\n+  prepend_before_action -> { authorize! }, only: %i[create selector import_example import_start ticket_customer ticket_history ticket_related ticket_recent ticket_merge ticket_split]\n   prepend_before_action :authentication_check\n \n   # GET /api/v1/tickets"
        },
        {
          "filename": "app/policies/controllers/tickets_controller_policy.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,5 +1,6 @@\n class Controllers::TicketsControllerPolicy < Controllers::ApplicationControllerPolicy\n   permit! %i[import_example import_start], to: 'admin'\n   permit! :selector, to: 'admin.*'\n+  permit! %i[ticket_customer ticket_history ticket_related ticket_recent ticket_merge ticket_split], to: 'ticket.agent'\n   permit! :create, to: ['ticket.agent', 'ticket.customer']\n end"
        },
        {
          "filename": "spec/requests/ticket_spec.rb",
          "status": "modified",
          "additions": 41,
          "deletions": 1,
          "patch": "@@ -1793,6 +1793,10 @@\n         created_by_id: 1,\n       )\n \n+      authenticated_as(customer_user)\n+      get \"/api/v1/ticket_split?ticket_id=#{ticket.id}&article_id=#{article.id}&form_id=new_form_id123\", params: {}, as: :json\n+      expect(response).to have_http_status(:unauthorized)\n+\n       authenticated_as(agent_user)\n       get \"/api/v1/ticket_split?ticket_id=#{ticket.id}&article_id=#{article.id}&form_id=new_form_id123\", params: {}, as: :json\n       expect(response).to have_http_status(:ok)\n@@ -1918,6 +1922,10 @@\n         customer_id: customer_user.id,\n       )\n \n+      authenticated_as(customer_user)\n+      get \"/api/v1/ticket_merge/#{ticket2.id}/#{ticket1.id}\", params: {}, as: :json\n+      expect(response).to have_http_status(:unauthorized)\n+\n       authenticated_as(agent_user)\n       get \"/api/v1/ticket_merge/#{ticket2.id}/#{ticket1.id}\", params: {}, as: :json\n       expect(response).to have_http_status(:ok)\n@@ -2068,7 +2076,39 @@\n       expect(json_response['assets'].class).to eq(Hash)\n       expect(json_response['assets']['User'][customer_user.id.to_s]).not_to be_nil\n       expect(json_response['assets']['Ticket'][ticket1.id.to_s]).not_to be_nil\n+\n+      authenticated_as(customer_user)\n+      get \"/api/v1/ticket_history/#{ticket1.id}\", params: {}, as: :json\n+      expect(response).to have_http_status(:unauthorized)\n+    end\n+\n+    it 'does ticket related' do\n+      ticket1 = create(\n+        :ticket,\n+        title:       'some title',\n+        group:       ticket_group,\n+        customer_id: customer_user.id,\n+      )\n+\n+      authenticated_as(agent_user)\n+      get \"/api/v1/ticket_related/#{ticket1.id}\", params: {}, as: :json\n+      expect(response).to have_http_status(:ok)\n+\n+      authenticated_as(customer_user)\n+      get \"/api/v1/ticket_related/#{ticket1.id}\", params: {}, as: :json\n+      expect(response).to have_http_status(:unauthorized)\n+    end\n+\n+    it 'does ticket recent' do\n+      authenticated_as(agent_user)\n+      get '/api/v1/ticket_recent', params: {}, as: :json\n+      expect(response).to have_http_status(:ok)\n+\n+      authenticated_as(customer_user)\n+      get '/api/v1/ticket_recent', params: {}, as: :json\n+      expect(response).to have_http_status(:unauthorized)\n     end\n+\n   end\n \n   describe 'stats' do\n@@ -2213,7 +2253,7 @@\n       end\n \n       context 'as authorized customer', authenticated_as: -> { customer_authorized } do\n-        include_examples 'has access'\n+        include_examples 'has no access'\n       end\n \n       context 'as unauthorized customer', authenticated_as: -> { customer_unauthorized } do"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "98ea2e924935a8ae2cfc92f6b4d4434ea1e2efe8",
            "date": "2025-01-25T15:52:03Z",
            "author_login": "mgruner"
          },
          {
            "sha": "7f5fac4eb074b03907a0210b1bc63aa407dea3cb",
            "date": "2025-01-24T22:49:19Z",
            "author_login": "vBenTec"
          },
          {
            "sha": "260dd9c94c8e088e2b26aed3e1f0db1d0c2ac298",
            "date": "2025-01-24T16:50:05Z",
            "author_login": "rolfschmidt"
          },
          {
            "sha": "c2395f4e1d43fbee37c70b2e8cff3107dcb2d655",
            "date": "2025-01-24T15:34:11Z",
            "author_login": "rolfschmidt"
          },
          {
            "sha": "7c1489eea5893e737652dc19607f4fe688db926b",
            "date": "2025-01-24T15:14:07Z",
            "author_login": "dominikklein"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-862",
    "description": "In Zammad before 3.3.1, a Customer has ticket access that should only be available to an Agent (e.g., read internal data, split, or merge).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-06-16T23:15:11.173",
    "last_modified": "2024-11-21T05:02:52.893",
    "fix_date": "2020-05-05T08:50:03Z"
  },
  "references": [
    {
      "url": "https://github.com/zammad/zammad/commit/6e56aee25439b7a3211a6704a9d60453ad623ae4",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://zammad.com/news/security-advisory-zaa-2020-13",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/zammad/zammad/commit/6e56aee25439b7a3211a6704a9d60453ad623ae4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://zammad.com/news/security-advisory-zaa-2020-13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.855982",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "zammad",
    "owner": "zammad",
    "created_at": "2012-04-02T08:50:33Z",
    "updated_at": "2025-01-14T16:43:45Z",
    "pushed_at": "2025-01-14T12:55:08Z",
    "size": 614035,
    "stars": 4579,
    "forks": 780,
    "open_issues": 473,
    "watchers": 4579,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "Ruby": 12092834,
      "TypeScript": 4400117,
      "CoffeeScript": 2299732,
      "Vue": 1438308,
      "JavaScript": 1294158,
      "HTML": 469188,
      "SCSS": 284398,
      "Shell": 75274,
      "CSS": 44030,
      "PHP": 7732,
      "Raku": 3038,
      "Dockerfile": 1289,
      "Perl": 1236,
      "Procfile": 275
    },
    "commit_activity": {
      "total_commits_last_year": 1712,
      "avg_commits_per_week": 32.92307692307692,
      "days_active_last_year": 252
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T16:48:55.646726"
  }
}