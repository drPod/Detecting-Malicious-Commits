{
  "cve_id": "CVE-2020-15124",
  "github_data": {
    "repository": "intranda/goobi-viewer-core",
    "fix_commit": "44ceb8e2e7e888391e8a941127171d6366770df3",
    "related_commits": [
      "44ceb8e2e7e888391e8a941127171d6366770df3",
      "44ceb8e2e7e888391e8a941127171d6366770df3"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "44ceb8e2e7e888391e8a941127171d6366770df3",
      "commit_date": "2020-07-22T08:36:58Z",
      "author": {
        "login": "Beechwell",
        "type": "User",
        "stats": {
          "total_commits": 4564,
          "average_weekly_commits": 11.43859649122807,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 252
        }
      },
      "commit_message": {
        "title": "Don't allow filepaths as Filename when requesting source files",
        "length": 62,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
      },
      "files": [
        {
          "filename": "goobi-viewer-core/src/main/java/io/goobi/viewer/controller/DataFileTools.java",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -186,6 +186,8 @@ public static Path getDataFolder(String pi, String dataFolderName, String dataRe\n      */\n     public static Path getDataFilePath(String pi, String dataFolderName, String altDataFolderName, String fileName)\n             throws PresentationException, IndexUnreachableException {\n+        //make sure fileName is a pure filename and not a path\n+        fileName = Paths.get(fileName).getFileName().toString();\n         java.nio.file.Path dataFolderPath = getDataFolder(pi, dataFolderName);\n         if (StringUtils.isNotBlank(fileName)) {\n             dataFolderPath = dataFolderPath.resolve(fileName);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a88b73a76a10ae12aac1403dfa2304c741f086f4",
            "date": "2024-12-21T09:41:47Z",
            "author_login": "janvonde"
          },
          {
            "sha": "e1c9bab2d1e5734c533beac85733317af69e5745",
            "date": "2024-12-20T18:16:08Z",
            "author_login": "janvonde"
          },
          {
            "sha": "ef9140a9ce362b0feca105e29eb0fb5c0cc329e2",
            "date": "2024-12-20T16:51:45Z",
            "author_login": "Keelhaul"
          },
          {
            "sha": "b3a20c466480fc67105f60e31e591bfce69b2e15",
            "date": "2024-12-20T16:08:36Z",
            "author_login": "Keelhaul"
          },
          {
            "sha": "0ccbb39db2ada4b29445bd7f003562889bf1581e",
            "date": "2024-12-20T15:43:28Z",
            "author_login": "Keelhaul"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "In Goobi Viewer Core before version 4.8.3, a path traversal vulnerability allows for remote attackers to access files on the server via the application. This is limited to files accessible to the application server user, eg. tomcat, but can potentially lead to the disclosure of sensitive information. The vulnerability has been fixed in version 4.8.3",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-07-22T18:15:11.863",
    "last_modified": "2024-11-21T05:04:52.370",
    "fix_date": "2020-07-22T08:36:58Z"
  },
  "references": [
    {
      "url": "https://github.com/intranda/goobi-viewer-core/commit/44ceb8e2e7e888391e8a941127171d6366770df3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/intranda/goobi-viewer-core/security/advisories/GHSA-7gwq-xqw3-cr63",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/intranda/goobi-viewer-core/commit/44ceb8e2e7e888391e8a941127171d6366770df3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/intranda/goobi-viewer-core/security/advisories/GHSA-7gwq-xqw3-cr63",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:01.374021",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "goobi-viewer-core",
    "owner": "intranda",
    "created_at": "2017-06-16T08:47:48Z",
    "updated_at": "2024-12-21T09:42:23Z",
    "pushed_at": "2025-01-24T14:47:10Z",
    "size": 551405,
    "stars": 21,
    "forks": 14,
    "open_issues": 10,
    "watchers": 21,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 10294005,
      "JavaScript": 8013313,
      "HTML": 2431310,
      "Less": 661289,
      "CSS": 356544,
      "XSLT": 186258
    },
    "commit_activity": {
      "total_commits_last_year": 1246,
      "avg_commits_per_week": 23.96153846153846,
      "days_active_last_year": 221
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:49:04.106306"
  }
}