{
  "cve_id": "CVE-2020-15149",
  "github_data": {
    "repository": "NodeBB/NodeBB",
    "fix_commit": "c2477d9d5ffc43e5ffeb537ea2ceb4ce9592aa39",
    "related_commits": [
      "c2477d9d5ffc43e5ffeb537ea2ceb4ce9592aa39",
      "c2477d9d5ffc43e5ffeb537ea2ceb4ce9592aa39"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c2477d9d5ffc43e5ffeb537ea2ceb4ce9592aa39",
      "commit_date": "2020-08-12T17:23:58Z",
      "author": {
        "login": "julianlam",
        "type": "User",
        "stats": {
          "total_commits": 6953,
          "average_weekly_commits": 11.30569105691057,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 564
        }
      },
      "commit_message": {
        "title": "fix: improper targetUid check during password change",
        "length": 52,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/user/profile.js",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -280,13 +280,18 @@ module.exports = function (User) {\n \t\t}\n \t\tlet isAdminOrPasswordMatch = false;\n \t\tconst isSelf = parseInt(uid, 10) === parseInt(data.uid, 10);\n+\n+\t\tif (!isAdmin && !isSelf) {\n+\t\t\tthrow new Error('[[user:change_password_error_privileges]]');\n+\t\t}\n+\n \t\tif (\n \t\t\t(isAdmin && !isSelf) || // Admins ok\n \t\t\t(!hasPassword && isSelf)\t// Initial password set ok\n \t\t) {\n \t\t\tisAdminOrPasswordMatch = true;\n \t\t} else {\n-\t\t\tisAdminOrPasswordMatch = await User.isPasswordCorrect(uid, data.currentPassword, data.ip);\n+\t\t\tisAdminOrPasswordMatch = await User.isPasswordCorrect(data.uid, data.currentPassword, data.ip);\n \t\t}\n \n \t\tif (!isAdminOrPasswordMatch) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4caae7307cff28bce83294acc8e13f998f10d7b0",
            "date": "2025-01-25T20:19:29Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "c95848003c4563eb3108b68a41a2ff07f5cfa27b",
            "date": "2025-01-25T20:00:55Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "10409e0e1e9572c966ddc704b7cc9b14eabeda41",
            "date": "2025-01-25T15:13:54Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "6918c3f3a4bc42413e2c307d894f3d3f3d2211d1",
            "date": "2025-01-25T14:17:13Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "b3b8b9e98d148ce78cf56f5dd39952c326fb57ca",
            "date": "2025-01-25T04:41:19Z",
            "author_login": "julianlam"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L",
    "cwe_id": "CWE-269",
    "description": "NodeBB before version 1.14.3 has a bug introduced in version 1.12.2 in the validation logic that makes it possible to change the password of any user on a running NodeBB forum by sending a specially crafted socket.io call to the server. This could lead to a privilege escalation event due via an account takeover. As a workaround you may cherry-pick the following commit from the project's repository to your running instance of NodeBB: 16cee1b03ba3eee177834a1fdac4aa8a12b39d2a. This is fixed in version 1.14.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-08-20T01:17:12.337",
    "last_modified": "2024-11-21T05:04:56.843",
    "fix_date": "2020-08-12T17:23:58Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/159560/NodeBB-Forum-1.14.2-Account-Takeover.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/c2477d9d5ffc43e5ffeb537ea2ceb4ce9592aa39",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-hr66-c8pg-5mg7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://zeroauth.ltd/blog/2020/08/20/proof-of-concept-exploit-for-cve-2020-15149-nodebb-arbitrary-user-password-change/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/159560/NodeBB-Forum-1.14.2-Account-Takeover.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/c2477d9d5ffc43e5ffeb537ea2ceb4ce9592aa39",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-hr66-c8pg-5mg7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://zeroauth.ltd/blog/2020/08/20/proof-of-concept-exploit-for-cve-2020-15149-nodebb-arbitrary-user-password-change/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:03.800311",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "NodeBB",
    "owner": "NodeBB",
    "created_at": "2013-04-22T16:49:40Z",
    "updated_at": "2025-01-26T07:54:38Z",
    "pushed_at": "2025-01-25T20:20:32Z",
    "size": 94693,
    "stars": 14379,
    "forks": 2818,
    "open_issues": 186,
    "watchers": 14379,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "JavaScript": 3870133,
      "Smarty": 501663,
      "SCSS": 35684,
      "HTML": 6457,
      "Shell": 5633,
      "Dockerfile": 4900,
      "CSS": 3261,
      "Batchfile": 42
    },
    "commit_activity": {
      "total_commits_last_year": 2179,
      "avg_commits_per_week": 41.90384615384615,
      "days_active_last_year": 305
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:33:43.310578"
  }
}