{
  "cve_id": "CVE-2020-15158",
  "github_data": {
    "repository": "mz-automation/libiec61850",
    "fix_commit": "033ab5b6488250c8c3b838f25a7cbc3e099230bb",
    "related_commits": [
      "033ab5b6488250c8c3b838f25a7cbc3e099230bb",
      "033ab5b6488250c8c3b838f25a7cbc3e099230bb"
    ],
    "patch_url": "https://github.com/mz-automation/libiec61850/commit/033ab5b6488250c8c3b838f25a7cbc3e099230bb.patch",
    "fix_commit_details": {
      "sha": "033ab5b6488250c8c3b838f25a7cbc3e099230bb",
      "commit_date": "2020-08-12T05:25:37Z",
      "author": {
        "login": "mzillgith",
        "type": "User",
        "stats": {
          "total_commits": 1184,
          "average_weekly_commits": 2.2381852551984878,
          "total_additions": 205717,
          "total_deletions": 92615,
          "weeks_active": 335
        }
      },
      "commit_message": {
        "title": "- COTP: fixed possible heap buffer overflow when handling message with invalid (zero) value in length field (#250)",
        "length": 114,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/mms/iso_cotp/cotp.c",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -720,6 +720,9 @@ CotpConnection_readToTpktBuffer(CotpConnection* self)\n             goto exit_waiting;\n     }\n \n+    if (self->packetSize <= bufPos)\n+        goto exit_error;\n+\n     readBytes = readFromSocket(self, buffer + bufPos, self->packetSize - bufPos);\n \n     if (readBytes < 0)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3a1480e5948ca53b4dcc5fa15b05598fa3322bb9",
            "date": "2024-11-18T15:00:54Z",
            "author_login": "mzillgith"
          },
          {
            "sha": "37596ec559993a5485670da50b86acb0c385e0d3",
            "date": "2024-11-18T10:58:11Z",
            "author_login": "mzillgith"
          },
          {
            "sha": "7b12c07711853adda856d403acfaae8042cdacdc",
            "date": "2024-11-18T10:37:24Z",
            "author_login": "mzillgith"
          },
          {
            "sha": "519b0208cc79d1af09d5ca40fb9ad1fd93822e93",
            "date": "2024-08-13T11:58:56Z",
            "author_login": "mzillgith"
          },
          {
            "sha": "d3090183408dbc2d34887a7d985cf95c140fe6aa",
            "date": "2024-08-13T10:20:03Z",
            "author_login": "mzillgith"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:H",
    "cwe_id": "CWE-119",
    "description": "In libIEC61850 before version 1.4.3, when a message with COTP message length field with value < 4 is received an integer underflow will happen leading to heap buffer overflow. This can cause an application crash or on some platforms even the execution of remote code. If your application is used in open networks or there are untrusted nodes in the network it is highly recommend to apply the patch. This was patched with commit 033ab5b. Users of version 1.4.x should upgrade to version 1.4.3 when available. As a workaround changes of commit 033ab5b can be applied to older versions.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-08-26T18:15:10.287",
    "last_modified": "2024-11-21T05:04:58.113",
    "fix_date": "2020-08-12T05:25:37Z"
  },
  "references": [
    {
      "url": "https://github.com/mz-automation/libiec61850/commit/033ab5b6488250c8c3b838f25a7cbc3e099230bb",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mz-automation/libiec61850/issues/250",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mz-automation/libiec61850/security/advisories/GHSA-pq77-fmf7-hjw8",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mz-automation/libiec61850/commit/033ab5b6488250c8c3b838f25a7cbc3e099230bb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mz-automation/libiec61850/issues/250",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mz-automation/libiec61850/security/advisories/GHSA-pq77-fmf7-hjw8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:03.810685",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libiec61850",
    "owner": "mz-automation",
    "created_at": "2017-02-10T19:10:20Z",
    "updated_at": "2025-01-14T06:52:56Z",
    "pushed_at": "2024-11-22T18:26:49Z",
    "size": 7528,
    "stars": 913,
    "forks": 478,
    "open_issues": 194,
    "watchers": 913,
    "has_security_policy": false,
    "default_branch": "v1.6",
    "protected_branches": [
      "v1.5",
      "v1.6_develop",
      "v1.6"
    ],
    "languages": {
      "C": 3700964,
      "C#": 616664,
      "Java": 253359,
      "CSS": 50382,
      "CMake": 41669,
      "C++": 30506,
      "Python": 15062,
      "Makefile": 10906,
      "SWIG": 5423,
      "HTML": 2788,
      "Shell": 819
    },
    "commit_activity": {
      "total_commits_last_year": 98,
      "avg_commits_per_week": 1.8846153846153846,
      "days_active_last_year": 38
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:33:28.690742"
  }
}