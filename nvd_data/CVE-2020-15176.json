{
  "cve_id": "CVE-2020-15176",
  "github_data": {
    "repository": "glpi-project/glpi",
    "fix_commit": "f021f1f365b4acea5066d3e57c6d22658cf32575",
    "related_commits": [
      "f021f1f365b4acea5066d3e57c6d22658cf32575",
      "f021f1f365b4acea5066d3e57c6d22658cf32575"
    ],
    "patch_url": "https://github.com/glpi-project/glpi/commit/f021f1f365b4acea5066d3e57c6d22658cf32575.patch",
    "fix_commit_details": {
      "sha": "f021f1f365b4acea5066d3e57c6d22658cf32575",
      "commit_date": "2020-10-06T11:51:37Z",
      "author": {
        "login": "cedric-anne",
        "type": "User",
        "stats": {
          "total_commits": 2969,
          "average_weekly_commits": 2.716376944190302,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 324
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-x93w-64x9-58qw",
        "length": 196,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 26,
        "additions": 16,
        "deletions": 10
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -3,7 +3,15 @@\n The present file will list all changes made to the project; according to the\n [Keep a Changelog](http://keepachangelog.com/) project.\n \n-## [9.5.1] unreleased\n+## [9.5.2] unreleased\n+\n+### API changes\n+\n+#### Removed\n+\n+- Ability to use SQL expressions as string in criterion values in SQL iterator (replaced by usage of `QueryExpression`).\n+\n+## [9.5.1] 2020-07-16\n \n ## [9.5.0] 2020-07-07\n "
        },
        {
          "filename": "ajax/dropdownConnectNetworkPort.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -97,7 +97,7 @@\n                'glpi_networkports_networkports' => 'networkports_id_1',\n                'glpi_networkports'              => 'id', [\n                   'OR'  => [\n-                     'glpi_networkports_networkports.networkports_id_2' => $DB->quoteName('glpi_networkports.id')\n+                     'glpi_networkports_networkports.networkports_id_2' => new QueryExpression($DB->quoteName('glpi_networkports.id'))\n                   ]\n                ]\n             ]"
        },
        {
          "filename": "inc/crontask.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -396,12 +396,12 @@ function getNeedToRun($mode = 0, $name = '') {\n          // Build query for frequency and allowed hour\n          $WHERE[] = ['OR' => [\n             ['AND' => [\n-               ['hourmin'   => ['<', $DB->quoteName('hourmax')]],\n+               ['hourmin'   => ['<', new QueryExpression($DB->quoteName('hourmax'))]],\n                'hourmin'   => ['<=', $hour],\n                'hourmax'   => ['>', $hour]\n             ]],\n             ['AND' => [\n-               'hourmin'   => ['>', $DB->quoteName('hourmax')],\n+               'hourmin'   => ['>', new QueryExpression($DB->quoteName('hourmax'))],\n                'OR'        => [\n                   'hourmin'   => ['<=', $hour],\n                   'hourmax'   => ['>', $hour]"
        },
        {
          "filename": "inc/dbmysql.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1077,7 +1077,7 @@ public static function quoteValue($value) {\n          $value = $value->getValue();\n       } else if ($value === null || $value === 'NULL' || $value === 'null') {\n          $value = 'NULL';\n-      } else if (!preg_match(\"/^`.*?`$/\", $value)) { //`field` is valid only for mysql :/\n+      } else {\n          //phone numbers may start with '+' and will be considered as numeric\n          $value = \"'$value'\";\n       }"
        },
        {
          "filename": "inc/dbmysqliterator.class.php",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -589,8 +589,6 @@ private function getCriterionValue($value) {\n          return $value->getQuery();\n       } else if ($value instanceof \\QueryExpression) {\n          return $value->getValue();\n-      } else if (DBmysql::isNameQuoted($value)) { //FIXME: database related\n-         return $value;\n       } else if ($value instanceof \\QueryParam) {\n          return $value->getValue();\n       } else {"
        },
        {
          "filename": "inc/report.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -393,7 +393,7 @@ static function reportForNetworkInformations(\n                   'LINK'   => 'networkports_id_1',\n                   'PORT_1' => 'id', [\n                      'OR'     => [\n-                        'LINK.networkports_id_2'   => $DB->quoteName('PORT_1.id')\n+                        'LINK.networkports_id_2'   => new QueryExpression($DB->quoteName('PORT_1.id'))\n                      ]\n                   ]\n                ]"
        },
        {
          "filename": "tests/units/DB.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -96,7 +96,7 @@ protected function dataValue() {\n          [null, 'NULL'],\n          ['null', 'NULL'],\n          ['NULL', 'NULL'],\n-         ['`field`', '`field`'],\n+         [new \\QueryExpression('`field`'), '`field`'],\n          ['`field', \"'`field'\"]\n       ];\n    }"
        },
        {
          "filename": "tests/units/DBmysqlIterator.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -562,7 +562,7 @@ function() {\n       $it = $this->it->execute('foo', ['bar' => 'val']);\n       $this->string($it->getSql())->isIdenticalTo(\"SELECT * FROM `foo` WHERE `bar` = 'val'\");\n \n-      $it = $this->it->execute('foo', ['bar' => '`field`']);\n+      $it = $this->it->execute('foo', ['bar' => new \\QueryExpression('`field`')]);\n       $this->string($it->getSql())->isIdenticalTo('SELECT * FROM `foo` WHERE `bar` = `field`');\n \n       $it = $this->it->execute('foo', ['bar' => '?']);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec0e2a11b56e8ef9d1d28f503a363e4ba64fd4ab",
            "date": "2025-01-14T16:55:01Z",
            "author_login": "ccailly"
          },
          {
            "sha": "50989595d9386f3eed353125d7a693ef1241b517",
            "date": "2025-01-14T15:16:58Z",
            "author_login": "cconard96"
          },
          {
            "sha": "515f37f98fdfc8fdc1eb2f090252b2f3af1fdfa4",
            "date": "2025-01-14T14:43:36Z",
            "author_login": "ccailly"
          },
          {
            "sha": "9869867f24c899d79e4675ad93131bbb2cba53a2",
            "date": "2025-01-14T14:39:56Z",
            "author_login": "ccailly"
          },
          {
            "sha": "4b9fbaea0bb355b49990ee51c690fed5e7302443",
            "date": "2025-01-14T13:22:29Z",
            "author_login": "SebSept"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-89",
    "description": "In GLPI before version 9.5.2, when supplying a back tick in input that gets put into a SQL query,the application does not escape or sanitize allowing for SQL Injection to occur. Leveraging this vulnerability an attacker is able to exfiltrate sensitive information like passwords, reset tokens, personal details, and more. The issue is patched in version 9.5.2",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-10-07T19:15:12.720",
    "last_modified": "2024-11-21T05:05:00.597",
    "fix_date": "2020-10-06T11:51:37Z"
  },
  "references": [
    {
      "url": "https://github.com/glpi-project/glpi/commit/f021f1f365b4acea5066d3e57c6d22658cf32575",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/glpi-project/glpi/security/advisories/GHSA-x93w-64x9-58qw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/glpi-project/glpi/commit/f021f1f365b4acea5066d3e57c6d22658cf32575",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/glpi-project/glpi/security/advisories/GHSA-x93w-64x9-58qw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.172069",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "glpi",
    "owner": "glpi-project",
    "created_at": "2015-07-16T07:20:21Z",
    "updated_at": "2025-01-14T12:00:43Z",
    "pushed_at": "2025-01-14T12:00:37Z",
    "size": 864638,
    "stars": 4447,
    "forks": 1324,
    "open_issues": 223,
    "watchers": 4447,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.70/bugfixes",
      "0.71/bugfixes",
      "0.72/bugfixes",
      "0.78/bugfixes",
      "0.80/bugfixes",
      "0.83/bugfixes",
      "0.84/bugfixes",
      "0.85/bugfixes",
      "0.90/bugfixes",
      "9.1/bugfixes",
      "9.2/bugfixes",
      "9.3/bugfixes",
      "9.4/bugfixes",
      "9.5/bugfixes",
      "10.0/bugfixes",
      "main"
    ],
    "languages": {
      "PHP": 24867216,
      "Twig": 1834187,
      "JavaScript": 1339721,
      "SCSS": 362786,
      "Vue": 188168,
      "Shell": 24779,
      "Makefile": 2692,
      "CSS": 1716,
      "Dockerfile": 638
    },
    "commit_activity": {
      "total_commits_last_year": 1737,
      "avg_commits_per_week": 33.40384615384615,
      "days_active_last_year": 259
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:16:26.208966"
  }
}