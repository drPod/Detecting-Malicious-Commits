{
  "cve_id": "CVE-2020-15205",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "0462de5b544ed4731aa2fb23946ac22c01856b80",
    "related_commits": [
      "0462de5b544ed4731aa2fb23946ac22c01856b80",
      "0462de5b544ed4731aa2fb23946ac22c01856b80"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/0462de5b544ed4731aa2fb23946ac22c01856b80.patch",
    "fix_commit_details": {
      "sha": "0462de5b544ed4731aa2fb23946ac22c01856b80",
      "commit_date": "2020-09-18T22:52:05Z",
      "author": {
        "login": "mihaimaruseac",
        "type": "User",
        "stats": {
          "total_commits": 1590,
          "average_weekly_commits": 3.3125,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 214
        }
      },
      "commit_message": {
        "title": "Validate `data_splits` for `tf.StringNGrams`.",
        "length": 233,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 36,
        "additions": 35,
        "deletions": 1
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/string_ngrams_op.cc",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -19,6 +19,7 @@ limitations under the License.\n #include \"absl/strings/ascii.h\"\n #include \"absl/strings/str_cat.h\"\n #include \"tensorflow/core/framework/op_kernel.h\"\n+#include \"tensorflow/core/platform/errors.h\"\n \n namespace tensorflow {\n namespace text {\n@@ -60,6 +61,18 @@ class StringNGramsOp : public tensorflow::OpKernel {\n     OP_REQUIRES_OK(context, context->input(\"data_splits\", &splits));\n     const auto& splits_vec = splits->flat<SPLITS_TYPE>();\n \n+    // Validate that the splits are valid indices into data\n+    const int input_data_size = data->flat<tstring>().size();\n+    const int splits_vec_size = splits_vec.size();\n+    for (int i = 0; i < splits_vec_size; ++i) {\n+      bool valid_splits = splits_vec(i) >= 0;\n+      valid_splits = valid_splits && (splits_vec(i) <= input_data_size);\n+      OP_REQUIRES(\n+          context, valid_splits,\n+          errors::InvalidArgument(\"Invalid split value \", splits_vec(i),\n+                                  \", must be in [0,\", input_data_size, \"]\"));\n+    }\n+\n     int num_batch_items = splits_vec.size() - 1;\n     tensorflow::Tensor* ngrams_splits;\n     OP_REQUIRES_OK("
        },
        {
          "filename": "tensorflow/python/ops/raw_ops_test.py",
          "status": "modified",
          "additions": 22,
          "deletions": 1,
          "patch": "@@ -18,16 +18,21 @@\n from __future__ import division\n from __future__ import print_function\n \n+from absl.testing import parameterized\n+\n from tensorflow.python.eager import context\n from tensorflow.python.framework import constant_op\n+from tensorflow.python.framework import errors\n from tensorflow.python.framework import ops\n from tensorflow.python.framework import test_util\n from tensorflow.python.ops import gen_math_ops\n+from tensorflow.python.ops import gen_string_ops\n from tensorflow.python.platform import test\n \n \n @test_util.run_all_in_graph_and_eager_modes\n-class RawOpsTest(test.TestCase):\n+@test_util.disable_tfrt\n+class RawOpsTest(test.TestCase, parameterized.TestCase):\n \n   def testSimple(self):\n     x = constant_op.constant(1)\n@@ -58,6 +63,22 @@ def testDefaults(self):\n         gen_math_ops.Any(input=x, axis=0),\n         gen_math_ops.Any(input=x, axis=0, keep_dims=False))\n \n+  @parameterized.parameters([[0, 8]], [[-1, 6]])\n+  def testStringNGramsBadDataSplits(self, splits):\n+    data = [\"aa\", \"bb\", \"cc\", \"dd\", \"ee\", \"ff\"]\n+    with self.assertRaisesRegex(errors.InvalidArgumentError,\n+                                \"Invalid split value\"):\n+      self.evaluate(\n+          gen_string_ops.string_n_grams(\n+              data=data,\n+              data_splits=splits,\n+              separator=\"\",\n+              ngram_widths=[2],\n+              left_pad=\"\",\n+              right_pad=\"\",\n+              pad_width=0,\n+              preserve_short_sequences=False))\n+\n \n if __name__ == \"__main__\":\n   ops.enable_eager_execution()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "56e196bc47a70e2f41926613f4cd370ddd734f3a",
            "date": "2025-01-14T18:00:32Z",
            "author_login": "loislo"
          },
          {
            "sha": "b13ee8b852a232dc6dd339e0de4e22f735136b7a",
            "date": "2025-01-14T16:59:22Z",
            "author_login": "Moerafaat"
          },
          {
            "sha": "d65ab241c92b18a8e82a53b03575775279713930",
            "date": "2025-01-14T16:17:42Z",
            "author_login": "akuegel"
          },
          {
            "sha": "7f1cdb4f94bf497a8f81b47cb0b0f6f33dfcdf2f",
            "date": "2025-01-14T15:43:26Z",
            "author_login": "vwbaker"
          },
          {
            "sha": "8f888e57d9fab1d2e4127fdeaabc3f8976471065",
            "date": "2025-01-14T15:28:59Z",
            "author_login": "ddunl"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-119",
    "description": "In Tensorflow before versions 1.15.4, 2.0.3, 2.1.2, 2.2.1 and 2.3.1, the `data_splits` argument of `tf.raw_ops.StringNGrams` lacks validation. This allows a user to pass values that can cause heap overflow errors and even leak contents of memory In the linked code snippet, all the binary strings after `ee ff` are contents from the memory stack. Since these can contain return addresses, this data leak can be used to defeat ASLR. The issue is patched in commit 0462de5b544ed4731aa2fb23946ac22c01856b80, and is released in TensorFlow versions 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-09-25T19:15:15.823",
    "last_modified": "2024-11-21T05:05:04.937",
    "fix_date": "2020-09-18T22:52:05Z"
  },
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/0462de5b544ed4731aa2fb23946ac22c01856b80",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-g7p5-5759-qv46",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/0462de5b544ed4731aa2fb23946ac22c01856b80",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-g7p5-5759-qv46",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.154500",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}