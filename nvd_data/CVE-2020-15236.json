{
  "cve_id": "CVE-2020-15236",
  "github_data": {
    "repository": "Requarks/wiki",
    "fix_commit": "084dcd69d1591586ee4752101e675d5f0ac6dcdc",
    "related_commits": [
      "084dcd69d1591586ee4752101e675d5f0ac6dcdc",
      "084dcd69d1591586ee4752101e675d5f0ac6dcdc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "084dcd69d1591586ee4752101e675d5f0ac6dcdc",
      "commit_date": "2020-10-03T05:44:57Z",
      "author": {
        "login": "NGPixel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: strip directory traversal sequences from asset paths",
        "length": 57,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
      },
      "files": [
        {
          "filename": "server/helpers/page.js",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -5,6 +5,8 @@ const path = require('path')\n \n const localeSegmentRegex = /^[A-Z]{2}(-[A-Z]{2})?$/i\n const localeFolderRegex = /^([a-z]{2}(?:-[a-z]{2})?\\/)?(.*)/i\n+// eslint-disable-next-line no-control-regex\n+const unsafeCharsRegex = /[\\x00-\\x1f\\x80-\\x9f\\\\\"|<>:*?]/\n \n const contentToExt = {\n   markdown: 'md',\n@@ -30,10 +32,14 @@ module.exports = {\n     // Clean Path\n     rawPath = _.trim(qs.unescape(rawPath))\n     if (_.startsWith(rawPath, '/')) { rawPath = rawPath.substring(1) }\n+    rawPath = rawPath.replace(unsafeCharsRegex, '')\n     if (rawPath === '') { rawPath = 'home' }\n \n     // Extract Info\n-    let pathParts = _.filter(_.split(rawPath, '/'), p => !_.isEmpty(p))\n+    let pathParts = _.filter(_.split(rawPath, '/'), p => {\n+      p = _.trim(p)\n+      return !_.isEmpty(p) && p !== '..' && p !== '.'\n+    })\n     if (pathParts[0].length === 1) {\n       pathParts.shift()\n     }\n@@ -73,7 +79,7 @@ module.exports = {\n       ['date', page.updatedAt],\n       ['tags', page.tags ? page.tags.map(t => t.tag).join(', ') : ''],\n       ['editor', page.editorKey],\n-      ['dateCreated', page.createdAt],\n+      ['dateCreated', page.createdAt]\n     ]\n     switch (page.contentType) {\n       case 'markdown':"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "abc8dce9ccb9b9f90e5681e01abce3929183f6a4",
            "date": "2025-01-01T05:18:42Z",
            "author_login": "Vasfed"
          },
          {
            "sha": "94d253bf596a976a85034a1317b896af5b720b6b",
            "date": "2024-11-22T19:31:07Z",
            "author_login": "maarous"
          },
          {
            "sha": "c7c20579fd893387236d11688660a4d20cee8f1d",
            "date": "2024-11-18T22:18:28Z",
            "author_login": "NGPixel"
          },
          {
            "sha": "583ea44a72aecb94c93721880cdd6c2bb6491cf1",
            "date": "2024-11-18T22:13:52Z",
            "author_login": "NGPixel"
          },
          {
            "sha": "ab5c620d5046cfa4713fca9a44a78477baac4b40",
            "date": "2024-10-12T08:51:48Z",
            "author_login": "NGPixel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "In Wiki.js before version 2.5.151, directory traversal outside of Wiki.js context is possible when a storage module with local asset cache fetching is enabled. A malicious user can potentially read any file on the file system by crafting a special URL that allows for directory traversal. This is only possible when a storage module implementing local asset cache (e.g Local File System or Git) is enabled and that no web application firewall solution (e.g. cloudflare) strips potentially malicious URLs. Commit 084dcd69d1591586ee4752101e675d5f0ac6dcdc fixes this vulnerability by sanitizing the path before it is passed on to the storage module. The sanitization step removes any directory traversal (e.g. `..` and `.`) sequences as well as invalid filesystem characters from the path. As a workaround, disable any storage module with local asset caching capabilities such as Local File System and Git.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-10-05T15:15:12.047",
    "last_modified": "2024-11-21T05:05:09.460",
    "fix_date": "2020-10-03T05:44:57Z"
  },
  "references": [
    {
      "url": "https://github.com/Requarks/wiki/commit/084dcd69d1591586ee4752101e675d5f0ac6dcdc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-whpv-5xg2-w527",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/commit/084dcd69d1591586ee4752101e675d5f0ac6dcdc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-whpv-5xg2-w527",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.168092",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "wiki",
    "owner": "Requarks",
    "created_at": "2016-08-16T19:35:26Z",
    "updated_at": "2025-01-26T00:00:32Z",
    "pushed_at": "2025-01-01T05:18:42Z",
    "size": 40284,
    "stars": 25466,
    "forks": 2820,
    "open_issues": 162,
    "watchers": 25466,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Vue": 885886,
      "JavaScript": 785105,
      "SCSS": 93552,
      "HTML": 37190,
      "Shell": 31046,
      "Pug": 14489,
      "Go": 3549,
      "CSS": 3199,
      "Dockerfile": 3028,
      "Mustache": 2944
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T07:37:39.716437"
  }
}