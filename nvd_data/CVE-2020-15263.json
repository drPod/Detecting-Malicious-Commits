{
  "cve_id": "CVE-2020-15263",
  "github_data": {
    "repository": "orchidsoftware/platform",
    "fix_commit": "03f9a113b1a70bc5075ce86a918707f0e7d82169",
    "related_commits": [
      "03f9a113b1a70bc5075ce86a918707f0e7d82169",
      "03f9a113b1a70bc5075ce86a918707f0e7d82169"
    ],
    "patch_url": "https://github.com/orchidsoftware/platform/commit/03f9a113b1a70bc5075ce86a918707f0e7d82169.patch",
    "fix_commit_details": {
      "sha": "03f9a113b1a70bc5075ce86a918707f0e7d82169",
      "commit_date": "2020-10-19T13:23:38Z",
      "author": {
        "login": "tabuna",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "refs #1313 Escape inline attributes (#1314)",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 32,
        "additions": 26,
        "deletions": 6
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -4,6 +4,11 @@ All notable changes to this project will be documented in this file.\n The format is based on [Keep a Changelog](http://keepachangelog.com/en/1.0.0/)\n and this project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html).\n \n+## 9.4.4 - 2020-10-19\n+\n+### Fixed\n+- Escape inline attributes [#1313](https://github.com/orchidsoftware/platform/pull/1313)\n+\n ## 9.4.3 - 2020-10-17\n \n ### Changed"
        },
        {
          "filename": "src/Platform/Dashboard.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -17,7 +17,7 @@ class Dashboard\n     /**\n      * ORCHID Version.\n      */\n-    public const VERSION = '9.4.3';\n+    public const VERSION = '9.4.4';\n \n     /**\n      * The Dashboard configuration options."
        },
        {
          "filename": "src/Screen/Field.php",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -245,11 +245,13 @@ protected function getAllowAttributes(): ComponentAttributeBag\n     {\n         $allow = array_merge($this->universalAttributes, $this->inlineAttributes);\n \n-        $attribute = new ComponentAttributeBag($this->getAttributes());\n+        $attributes = collect($this->getAttributes())\n+            ->filter(function ($value, $attribute) use ($allow) {\n+                return Str::is($allow, $attribute);\n+            })->toArray();\n \n-        return $attribute->filter(function ($value, $attribute) use ($allow) {\n-            return Str::is($allow, $attribute);\n-        });\n+        return (new ComponentAttributeBag())\n+            ->merge($attributes);\n     }\n \n     /**"
        },
        {
          "filename": "src/Screen/Fields/Upload.php",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -81,7 +81,6 @@ class Upload extends Field\n         'multiple',\n         'placeholder',\n         'required',\n-        'value',\n         'groups',\n         'storage',\n         'media',"
        },
        {
          "filename": "tests/Unit/Screen/Fields/InputTest.php",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -68,4 +68,18 @@ public function testDataAttributes(): void\n         $this->assertStringContainsString('data-location=\"Russia\"', $input);\n         $this->assertStringContainsString('data-hello=\"world!\"', $input);\n     }\n+\n+    public function testEscapeAttributes(): void\n+    {\n+        $input = (string) Input::make('name')->value('valueQuote\"');\n+\n+        $this->assertStringContainsString('value=\"valueQuote&quot;\"', $input);\n+    }\n+\n+    public function testRemoveBooleanAttributes(): void\n+    {\n+        $input = (string) Input::make('name')->required(false);\n+\n+        $this->assertStringNotContainsString('required', $input);\n+    }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1bf5f4891ab42ccf013098891882c0f878e53472",
            "date": "2025-01-14T09:58:49Z",
            "author_login": "kalexhaym"
          },
          {
            "sha": "e8b021018c471b8eb276d5a7c57ab506a69e13c2",
            "date": "2025-01-11T08:00:01Z",
            "author_login": "mavsan"
          },
          {
            "sha": "e2f5f2f0d858d768b7a2a167001f1c416b26d063",
            "date": "2024-12-31T00:31:46Z",
            "author_login": "tabuna"
          },
          {
            "sha": "7c0c5487b50586378e4c117d06afe3417f937f9f",
            "date": "2024-12-31T00:31:15Z",
            "author_login": "tabuna"
          },
          {
            "sha": "db54f8d4a3663ce1b072d43d95acb01a898b29d0",
            "date": "2024-12-30T23:59:15Z",
            "author_login": "tabuna"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "In platform before version 9.4.4, inline attributes are not properly escaped. If the data that came from users was not escaped, then an XSS vulnerability is possible. The issue was introduced in 9.0.0 and fixed in 9.4.4.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-10-19T21:15:12.983",
    "last_modified": "2024-11-21T05:05:13.467",
    "fix_date": "2020-10-19T13:23:38Z"
  },
  "references": [
    {
      "url": "https://github.com/orchidsoftware/platform/commit/03f9a113b1a70bc5075ce86a918707f0e7d82169",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchidsoftware/platform/security/advisories/GHSA-589w-hccm-265x",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchidsoftware/platform/commit/03f9a113b1a70bc5075ce86a918707f0e7d82169",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchidsoftware/platform/security/advisories/GHSA-589w-hccm-265x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.184970",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "platform",
    "owner": "orchidsoftware",
    "created_at": "2016-11-15T05:59:27Z",
    "updated_at": "2025-01-14T21:27:19Z",
    "pushed_at": "2025-01-14T09:58:49Z",
    "size": 119529,
    "stars": 4497,
    "forks": 659,
    "open_issues": 142,
    "watchers": 4497,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "9.x",
      "master"
    ],
    "languages": {
      "PHP": 849157,
      "Blade": 114183,
      "JavaScript": 110477,
      "SCSS": 65720
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T23:05:53.812732"
  }
}