{
  "cve_id": "CVE-2020-1896",
  "github_data": {
    "repository": "facebook/hermes",
    "fix_commit": "86543ac47e59c522976b5632b8bf9a2a4583c7d2",
    "related_commits": [
      "86543ac47e59c522976b5632b8bf9a2a4583c7d2",
      "86543ac47e59c522976b5632b8bf9a2a4583c7d2"
    ],
    "patch_url": "https://github.com/facebook/hermes/commit/86543ac47e59c522976b5632b8bf9a2a4583c7d2.patch",
    "fix_commit_details": {
      "sha": "86543ac47e59c522976b5632b8bf9a2a4583c7d2",
      "commit_date": "2020-02-27T02:57:41Z",
      "author": {
        "login": "kodafb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added stack overflow check for hermes::vm:: hermesBuiltinApply",
        "length": 235,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 14,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/VM/JSLib/HermesBuiltin.cpp",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -653,6 +653,9 @@ hermesBuiltinApply(void *, Runtime *runtime, NativeArgs args) {\n \n   ScopedNativeCallFrame newFrame{\n       runtime, len, *fn, isConstructor, thisVal.getHermesValue()};\n+  if (LLVM_UNLIKELY(newFrame.overflowed()))\n+    return runtime->raiseStackOverflow(Runtime::StackOverflowKind::NativeStack);\n+\n   for (uint32_t i = 0; i < len; ++i) {\n     newFrame->getArgRef(i) = argArray->at(runtime, i);\n   }"
        },
        {
          "filename": "test/hermes/stack-overflow-apply.js",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -32,3 +32,14 @@ try {\n     print(\"caught:\", e.name, e.message);\n }\n //CHECK: caught: RangeError {{.*}}\n+\n+try {\n+  v0 = [1.1];\n+  function v1() {\n+    v1(...v0);\n+  }\n+  v1();\n+} catch (e) {\n+    print(\"caught:\", e.name, e.message);\n+}\n+//CHECK: caught: RangeError {{.*}}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a942ef374897d85da38e9c8904574f8376555388",
            "date": "2025-01-09T13:15:51Z",
            "author_login": "tsaichien"
          },
          {
            "sha": "9f0b77fc801b1bed97e6097776a6baa1c4ed2e00",
            "date": "2025-01-09T13:15:51Z",
            "author_login": "tsaichien"
          },
          {
            "sha": "c995d195adaf07811cf35d81423a5a4afa7d60cf",
            "date": "2025-01-09T13:15:51Z",
            "author_login": "tsaichien"
          },
          {
            "sha": "e08fb5fc02177d55ca13fd71324a0e94e33ffb76",
            "date": "2025-01-09T13:15:51Z",
            "author_login": "tsaichien"
          },
          {
            "sha": "a49b895b12e3a9d6cfa79204daa480dcc831cbe0",
            "date": "2025-01-08T16:47:41Z",
            "author_login": "SamChou19815"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-121",
    "description": "A stack overflow vulnerability in Facebook Hermes 'builtin apply' prior to commit 86543ac47e59c522976b5632b8bf9a2a4583c7d2 (https://github.com/facebook/hermes/commit/86543ac47e59c522976b5632b8bf9a2a4583c7d2) allows attackers to potentially execute arbitrary code via crafted JavaScript. Note that this is only exploitable if the application using Hermes permits evaluation of untrusted JavaScript. Hence, most React Native applications are not affected.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-02T07:15:13.333",
    "last_modified": "2024-11-21T05:11:34.030",
    "fix_date": "2020-02-27T02:57:41Z"
  },
  "references": [
    {
      "url": "https://github.com/facebook/hermes/commit/86543ac47e59c522976b5632b8bf9a2a4583c7d2",
      "source": "cve-assign@fb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.facebook.com/security/advisories/cve-2020-1896",
      "source": "cve-assign@fb.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/facebook/hermes/commit/86543ac47e59c522976b5632b8bf9a2a4583c7d2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.facebook.com/security/advisories/cve-2020-1896",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.177906",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "hermes",
    "owner": "facebook",
    "created_at": "2018-10-22T19:13:00Z",
    "updated_at": "2025-01-13T03:07:27Z",
    "pushed_at": "2025-01-13T14:55:56Z",
    "size": 98978,
    "stars": 10032,
    "forks": 648,
    "open_issues": 161,
    "watchers": 10032,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "gh-pages",
      "main"
    ],
    "languages": {
      "C++": 10937781,
      "JavaScript": 7932464,
      "Rust": 1201532,
      "Python": 337453,
      "Java": 319660,
      "TypeScript": 184977,
      "Objective-C++": 113458,
      "CMake": 113065,
      "C": 41344,
      "Shell": 38189,
      "Swift": 22129,
      "NASL": 4993,
      "Ruby": 3189,
      "DTrace": 574,
      "Objective-C": 303,
      "D": 225
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:50:37.887799"
  }
}