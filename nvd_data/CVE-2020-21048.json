{
  "cve_id": "CVE-2020-21048",
  "github_data": {
    "repository": "saitoha/libsixel",
    "fix_commit": "cb373ab6614c910407c5e5a93ab935144e62b037",
    "related_commits": [
      "cb373ab6614c910407c5e5a93ab935144e62b037",
      "cb373ab6614c910407c5e5a93ab935144e62b037"
    ],
    "patch_url": "https://github.com/saitoha/libsixel/commit/cb373ab6614c910407c5e5a93ab935144e62b037.patch",
    "fix_commit_details": {
      "sha": "cb373ab6614c910407c5e5a93ab935144e62b037",
      "commit_date": "2019-12-15T12:56:23Z",
      "author": {
        "login": "saitoha",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Avoid illegal memory access problem with 1 color paletted png(#73),",
        "length": 89,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/dither.c",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -284,9 +284,13 @@ sixel_dither_new(\n         quality_mode = SIXEL_QUALITY_HIGHCOLOR;\n     } else {\n         if (ncolors > SIXEL_PALETTE_MAX) {\n+            status = SIXEL_BAD_INPUT;\n             ncolors = 256;\n-        } else if (ncolors < 2) {\n-            ncolors = 2;\n+        } else if (ncolors < 1) {\n+            status = SIXEL_BAD_INPUT;\n+            sixel_helper_set_additional_message(\n+                \"sixel_dither_new: palette colors must be more than 0\");\n+            goto end;\n         }\n         quality_mode = SIXEL_QUALITY_LOW;\n     }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6a5be8b72d84037b83a5ea838e17bcf372ab1d5f",
            "date": "2020-01-13T17:27:00Z",
            "author_login": "saitoha"
          },
          {
            "sha": "51f44ded1138a7a061924a46ea51ea47e2e25eab",
            "date": "2020-01-13T12:09:03Z",
            "author_login": "saitoha"
          },
          {
            "sha": "36378554e9515b13ff15a8814f60714ab0f47555",
            "date": "2020-01-13T12:08:40Z",
            "author_login": "saitoha"
          },
          {
            "sha": "1add68f523b1029ebf41ce15d5f38754c59990dd",
            "date": "2020-01-13T09:33:14Z",
            "author_login": "saitoha"
          },
          {
            "sha": "ee77c2f979dbccc86651a482e748fe7bf80bc89c",
            "date": "2020-01-13T09:33:04Z",
            "author_login": "saitoha"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": null,
    "description": "An issue in the dither.c component of libsixel prior to v1.8.4 allows attackers to cause a denial of service (DOS) via a crafted PNG file.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-14T16:15:08.403",
    "last_modified": "2024-11-21T05:12:23.457",
    "fix_date": "2019-12-15T12:56:23Z"
  },
  "references": [
    {
      "url": "https://bitbucket.org/netbsd/pkgsrc/commits/6f0c011cbfccdffa635d04c84433b1a02687adad",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/blob/master/ChangeLog",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/commit/cb373ab6614c910407c5e5a93ab935144e62b037",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/issues/73",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/releases/tag/v1.8.4",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bitbucket.org/netbsd/pkgsrc/commits/6f0c011cbfccdffa635d04c84433b1a02687adad",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/blob/master/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/commit/cb373ab6614c910407c5e5a93ab935144e62b037",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/issues/73",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/releases/tag/v1.8.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.753250",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libsixel",
    "owner": "saitoha",
    "created_at": "2013-08-20T15:52:45Z",
    "updated_at": "2025-01-14T02:09:38Z",
    "pushed_at": "2023-08-20T10:27:23Z",
    "size": 34592,
    "stars": 2540,
    "forks": 87,
    "open_issues": 56,
    "watchers": 2540,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 843191,
      "Shell": 394959,
      "Makefile": 223455,
      "Objective-C": 138541,
      "M4": 44300,
      "C++": 42674,
      "Python": 42303,
      "Roff": 16887,
      "Perl": 4692,
      "XS": 4266,
      "Ruby": 2172,
      "PHP": 797,
      "JavaScript": 198,
      "Perl 6": 118
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:00:27.404499"
  }
}