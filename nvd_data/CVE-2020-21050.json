{
  "cve_id": "CVE-2020-21050",
  "github_data": {
    "repository": "saitoha/libsixel",
    "fix_commit": "7808a06b88c11dbc502318cdd51fa374f8cd47ee",
    "related_commits": [
      "7808a06b88c11dbc502318cdd51fa374f8cd47ee",
      "7808a06b88c11dbc502318cdd51fa374f8cd47ee"
    ],
    "patch_url": "https://github.com/saitoha/libsixel/commit/7808a06b88c11dbc502318cdd51fa374f8cd47ee.patch",
    "fix_commit_details": {
      "sha": "7808a06b88c11dbc502318cdd51fa374f8cd47ee",
      "commit_date": "2018-08-01T16:59:41Z",
      "author": {
        "login": "saitoha",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "gif loader: check LZW code size (Issue #75)",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/fromgif.c",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -58,14 +58,18 @@ typedef struct\n    unsigned char suffix;\n } gif_lzw;\n \n+enum {\n+   gif_lzw_max_code_size = 12\n+};\n+\n typedef struct\n {\n    int w, h;\n    unsigned char *out;  /* output buffer (always 4 components) */\n    int flags, bgindex, ratio, transparent, eflags;\n    unsigned char pal[256][3];\n    unsigned char lpal[256][3];\n-   gif_lzw codes[4096];\n+   gif_lzw codes[1 << gif_lzw_max_code_size];\n    unsigned char *color_table;\n    int parse, step;\n    int lflags;\n@@ -299,7 +303,15 @@ gif_process_raster(\n     signed int codesize, codemask, avail, oldcode, bits, valid_bits, clear;\n     gif_lzw *p;\n \n+    /* LZW Minimum Code Size */\n     lzw_cs = gif_get8(s);\n+    if (lzw_cs > gif_lzw_max_code_size) {\n+        sixel_helper_set_additional_message(\n+            \"Unsupported GIF (LZW code size)\");\n+        status = SIXEL_RUNTIME_ERROR;\n+        goto end;\n+    }\n+\n     clear = 1 << lzw_cs;\n     first = 1;\n     codesize = lzw_cs + 1;\n@@ -353,7 +365,7 @@ gif_process_raster(\n                     goto end;\n                 }\n                 if (oldcode >= 0) {\n-                    if (avail < 4096) {\n+                    if (avail < (1 << gif_lzw_max_code_size)) {\n                         p = &g->codes[avail++];\n                         p->prefix = (signed short) oldcode;\n                         p->first = g->codes[oldcode].first;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6a5be8b72d84037b83a5ea838e17bcf372ab1d5f",
            "date": "2020-01-13T17:27:00Z",
            "author_login": "saitoha"
          },
          {
            "sha": "51f44ded1138a7a061924a46ea51ea47e2e25eab",
            "date": "2020-01-13T12:09:03Z",
            "author_login": "saitoha"
          },
          {
            "sha": "36378554e9515b13ff15a8814f60714ab0f47555",
            "date": "2020-01-13T12:08:40Z",
            "author_login": "saitoha"
          },
          {
            "sha": "1add68f523b1029ebf41ce15d5f38754c59990dd",
            "date": "2020-01-13T09:33:14Z",
            "author_login": "saitoha"
          },
          {
            "sha": "ee77c2f979dbccc86651a482e748fe7bf80bc89c",
            "date": "2020-01-13T09:33:04Z",
            "author_login": "saitoha"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-787",
    "description": "Libsixel prior to v1.8.3 contains a stack buffer overflow in the function gif_process_raster at fromgif.c.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-14T16:15:08.987",
    "last_modified": "2024-11-21T05:12:23.757",
    "fix_date": "2018-08-01T16:59:41Z"
  },
  "references": [
    {
      "url": "https://bitbucket.org/netbsd/pkgsrc/commits/a27113e21179cbfbfae0c35f6a9edd6aa498faae",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/121.html",
      "source": "cve@mitre.org",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/blob/master/ChangeLog",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/commit/7808a06b88c11dbc502318cdd51fa374f8cd47ee",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/issues/75",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/releases/tag/v1.8.5",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bitbucket.org/netbsd/pkgsrc/commits/a27113e21179cbfbfae0c35f6a9edd6aa498faae",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/121.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/blob/master/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/commit/7808a06b88c11dbc502318cdd51fa374f8cd47ee",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/issues/75",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saitoha/libsixel/releases/tag/v1.8.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.753581",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libsixel",
    "owner": "saitoha",
    "created_at": "2013-08-20T15:52:45Z",
    "updated_at": "2025-01-14T02:09:38Z",
    "pushed_at": "2023-08-20T10:27:23Z",
    "size": 34592,
    "stars": 2540,
    "forks": 87,
    "open_issues": 56,
    "watchers": 2540,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 843191,
      "Shell": 394959,
      "Makefile": 223455,
      "Objective-C": 138541,
      "M4": 44300,
      "C++": 42674,
      "Python": 42303,
      "Roff": 16887,
      "Perl": 4692,
      "XS": 4266,
      "Ruby": 2172,
      "PHP": 797,
      "JavaScript": 198,
      "Perl 6": 118
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:00:27.404499"
  }
}