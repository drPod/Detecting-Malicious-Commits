{
  "cve_id": "CVE-2020-23014",
  "github_data": {
    "repository": "its-a-feature/Apfell",
    "fix_commit": "5fc64502bc008388514f2b5d1160b677e3b4a7f3",
    "related_commits": [
      "5fc64502bc008388514f2b5d1160b677e3b4a7f3",
      "5fc64502bc008388514f2b5d1160b677e3b4a7f3"
    ],
    "patch_url": "https://github.com/its-a-feature/Apfell/commit/5fc64502bc008388514f2b5d1160b677e3b4a7f3.patch",
    "fix_commit_details": {
      "sha": "5fc64502bc008388514f2b5d1160b677e3b4a7f3",
      "commit_date": "2020-04-19T16:58:23Z",
      "author": {
        "login": "its-a-feature",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed an 'Authenticated Cross-Site Scripting' bug on the command help page reported by 'Mohamed A. Baset' of 'Seekurity SA de C.V.' at 'Seekurity.com' on April 17,2020",
        "length": 167,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 7,
        "deletions": 2
      },
      "files": [
        {
          "filename": "apfell-docker/app/routes/api_routes.py",
          "status": "modified",
          "additions": 7,
          "deletions": 2,
          "patch": "@@ -1,9 +1,10 @@\n-from app import apfell, links, use_ssl\n+from app import apfell, links, use_ssl, db_objects\n from sanic import response\n from jinja2 import Environment, PackageLoader\n from sanic_jwt.decorators import scoped, inject_user\n from app.routes.routes import respect_pivot\n import urllib.parse\n+import app.database_models.model as db_model\n \n env = Environment(loader=PackageLoader('app', 'templates'))\n \n@@ -15,7 +16,11 @@ async def apiui_command_help(request, user):\n     template = env.get_template('apiui_command_help.html')\n     if len(request.query_args) != 0:\n         data = urllib.parse.unquote(request.query_args[0][1])\n-        print(data)\n+        query = await db_model.payloadtype_query()\n+        try:\n+            payloadtype = await db_objects.get(query, ptype=data)\n+        except Exception as e:\n+            data = \"\"\n     else:\n         data = \"\"\n     if use_ssl:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "156bca469269688d2a5fe682909aca69361be5b6",
            "date": "2024-12-31T23:24:06Z",
            "author_login": "its-a-feature"
          },
          {
            "sha": "e22274760c61ffe937dabc9e73bc393de4b781be",
            "date": "2024-12-31T21:54:15Z",
            "author_login": "its-a-feature"
          },
          {
            "sha": "6ded9fa3f73702e53d2271e2b8bb831c61406851",
            "date": "2024-12-31T19:31:00Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "191191e53800af6202f5c0164d2f4511f1f975bd",
            "date": "2024-12-31T19:15:49Z",
            "author_login": "its-a-feature"
          },
          {
            "sha": "8d63fadb2a385f6a52f65d5b5477881944a29bd7",
            "date": "2024-12-31T17:58:46Z",
            "author_login": "github-actions[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "APfell 1.4 is vulnerable to authenticated reflected cross-site scripting (XSS) in /apiui/command_ through the payloadtypes_callback function, which allows an attacker to steal remote admin/user session and/or adding new users to the administration panel.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-26T18:15:42.257",
    "last_modified": "2024-11-21T05:13:29.773",
    "fix_date": "2020-04-19T16:58:23Z"
  },
  "references": [
    {
      "url": "https://github.com/its-a-feature/Apfell/commit/5fc64502bc008388514f2b5d1160b677e3b4a7f3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://seekurity.com/blog/2020/04/19/admin/advisories/apfell-post-exploitation-red-team-framework-authenticated-cross-site-scripting-vulnerability",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/its-a-feature/Apfell/commit/5fc64502bc008388514f2b5d1160b677e3b4a7f3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://seekurity.com/blog/2020/04/19/admin/advisories/apfell-post-exploitation-red-team-framework-authenticated-cross-site-scripting-vulnerability",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.163813",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Mythic",
    "owner": "its-a-feature",
    "created_at": "2018-07-05T02:09:59Z",
    "updated_at": "2025-01-14T13:04:06Z",
    "pushed_at": "2024-12-31T23:24:13Z",
    "size": 672571,
    "stars": 3373,
    "forks": 434,
    "open_issues": 16,
    "watchers": 3373,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 2708836,
      "Go": 2031393,
      "HTML": 170896,
      "Jupyter Notebook": 132367,
      "CSS": 90221,
      "PLpgSQL": 38317,
      "Dockerfile": 7479,
      "Makefile": 4490,
      "Shell": 2694,
      "Python": 2089
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:21:40.609814"
  }
}