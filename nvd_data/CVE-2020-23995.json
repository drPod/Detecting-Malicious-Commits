{
  "cve_id": "CVE-2020-23995",
  "github_data": {
    "repository": "ILIAS-eLearning/ILIAS",
    "fix_commit": "94d9b16010ec3abeae8d2cbb05622ccd999119ad",
    "related_commits": [
      "94d9b16010ec3abeae8d2cbb05622ccd999119ad",
      "94d9b16010ec3abeae8d2cbb05622ccd999119ad"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "94d9b16010ec3abeae8d2cbb05622ccd999119ad",
      "commit_date": "2020-05-18T15:01:57Z",
      "author": {
        "login": "chfsx",
        "type": "User",
        "stats": {
          "total_commits": 3707,
          "average_weekly_commits": 3.149532710280374,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 436
        }
      },
      "commit_message": {
        "title": "[FIX] 0027430",
        "length": 13,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 7,
        "deletions": 12
      },
      "files": [
        {
          "filename": "Modules/File/classes/class.ilObjFileGUI.php",
          "status": "modified",
          "additions": 3,
          "deletions": 10,
          "patch": "@@ -36,6 +36,7 @@ public function __construct($a_id = 0, $a_id_type = self::REPOSITORY_NODE_ID, $a\n     {\n         $this->log = ilLoggerFactory::getLogger('file');\n         parent::__construct($a_id, $a_id_type, $a_parent_node_id);\n+        $this->lng->loadLanguageModule('file');\n     }\n \n \n@@ -187,7 +188,6 @@ protected function initCreationForms($a_new_type)\n \n         if ($this->id_type == self::WORKSPACE_NODE_ID) {\n             if (!ilDiskQuotaHandler::isUploadPossible()) {\n-                $this->lng->loadLanguageModule(\"file\");\n                 ilUtil::sendFailure($this->lng->txt(\"personal_workspace_quota_exceeded_warning\"), true);\n                 $this->ctrl->redirect($this, \"cancel\");\n             }\n@@ -564,8 +564,6 @@ public function edit()\n      */\n     protected function initPropertiesForm($mode = \"create\")\n     {\n-        $this->lng->loadLanguageModule('file');\n-\n         $form = new ilPropertyFormGUI();\n         $form->setFormAction($this->ctrl->getFormAction($this, 'update'));\n         $form->setTitle($this->lng->txt('file_edit'));\n@@ -706,9 +704,6 @@ public function infoScreenForward()\n         $info = new ilInfoScreenGUI($this);\n \n         if ($this->checkPermissionBool(\"read\", \"sendfile\")) {\n-            // #9876\n-            $this->lng->loadLanguageModule(\"file\");\n-\n             // #14378\n             include_once \"Services/UIComponent/Button/classes/class.ilLinkButton.php\";\n             $button = ilLinkButton::getInstance();\n@@ -763,7 +758,6 @@ public function infoScreenForward()\n         $uploader = array_shift($uploader);\n         $uploader = $uploader[\"user_id\"];\n \n-        $this->lng->loadLanguageModule(\"file\");\n         include_once \"Services/User/classes/class.ilUserUtil.php\";\n         $info->addProperty($this->lng->txt(\"file_uploaded_by\"), ilUserUtil::getNamePresentation($uploader));\n \n@@ -1008,7 +1002,7 @@ public function uploadFiles()\n                     }\n                 }\n             } catch (Exception $ex) {\n-                $response->error = $ex->getMessage();\n+                $response->error = $this->lng->txt('general_upload_error_occured');\n             }\n         } else {\n             $dnd_input = $dnd_form_gui->getItemByPostVar(\"upload_files\");\n@@ -1031,7 +1025,6 @@ public function uploadFiles()\n         if ($DIC->upload()->hasBeenProcessed()) {\n             foreach ($DIC->upload()->getResults() as $result) {\n                 if (!ilFileUtils::hasValidExtension($result->getName())) {\n-                    $this->lng->loadLanguageModule('file');\n                     ilUtil::sendInfo(\n                         $this->lng->txt('file_upload_info_file_with_critical_unknown_extension_later_renamed_when_downloading'),\n                         true\n@@ -1155,7 +1148,7 @@ protected function handleFileUpload($file_upload)\n             } catch (ilFileUtilsException $e) {\n                 $response->error = $e->getMessage();\n             } catch (Exception $ex) {\n-                $response->error = $ex->getMessage();\n+                $response->error = $this->lng->txt('general_upload_error_occured');\n             }\n \n             ilUtil::delDir($newDir);"
        },
        {
          "filename": "Services/Utilities/classes/class.ilFileUtils.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -882,7 +882,7 @@ public static function rename($a_source, $a_target)\n         $pi = pathinfo($a_target);\n         if (!in_array(strtolower($pi[\"extension\"]), self::getValidExtensions())) {\n             include_once(\"./Services/Utilities/classes/class.ilFileUtilsException.php\");\n-            throw new ilFileUtilsException(\"Invalid target file \" . $pi[\"basename\"] . \".\");\n+            throw new ilFileUtilsException(\"Invalid target file\");\n         }\n \n         return rename($a_source, $a_target);"
        },
        {
          "filename": "lang/ilias_de.lang",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -8530,7 +8530,8 @@ feed#:#feed_no_valid_url#:#Die URL des Webfeeds ist nicht g\u00fcltig.\n feed#:#feed_nr_pd_feeds#:#Anzahl externer Webfeeds auf dem Pers\u00f6nlichen Schreibtisch\n feed#:#feed_nr_pd_feeds_info#:#Bestimmt die maximale Anzahl externer Webfeeds, die ein Benutzer auf seinen Pers\u00f6nlichen Schreibtisch legen kann.\n feed#:#feed_open_source_page#:#Gehe zur externen Nachricht\n-feed#:#feed_settings#:#Externe Webfeeds\n+feed#:#feed_settings#:#Externe Webfeeds^\n+file#:#general_upload_error_occured#:#Beim Verarbeiten der Datei ist ein unerwartetet Fehler aufgetreten.\n file#:#enable_personal_workspace_disk_quota#:#Disk-Quota f\u00fcr den Pers\u00f6nlichen Arbeitsraum aktivieren\n file#:#enable_personal_workspace_disk_quota_info#:#Erlaubt die Begrenzung des verf\u00fcgbaren Plattenplatzes f\u00fcr jedes Benutzerkonto und jede globale Rolle. Dies betrifft nur Dateien im pers\u00f6nlichen Arbeitsraum und in Portfolios. Sobald ein Benutzer die definierte Disk-Quota erreicht, kann dieser keine weiteren Dateien mehr hochladen.\n file#:#file_copy#:#Datei kopieren"
        },
        {
          "filename": "lang/ilias_en.lang",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -10969,6 +10969,7 @@ crs#:#event_list_registered_only#:#Only Registered\n didactic#:#didactic_default_type#:#Default\n pd#:#pd_info_delete_sure_remove#:#Are you sure you want to remove the following objects from your Personal Desktop?\n pd#:#pd_info_delete_sure_unsubscribe#:#Are you sure you want to unsubscribe from the following objects?\n+file#:#general_upload_error_occured#:#An unexpected error occured during upload.\n file#:#enable_personal_workspace_disk_quota#:#Activate Hard Quota for Personal Workspace\n file#:#enable_personal_workspace_disk_quota_info#:#Allows definition of a hard disk quota for each user account and each global role. This quota only affects files in the personal workspace and in portfolios. As soon as a user exceeds the defined quota, ILIAS will prohibit the user to upload more files until the used disk space is again under quota.\n file#:#personal_workspace_disk_quota#:#Hard Disk Quota for Personal Workspace"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7a99709688810050113f709dea04f8c3a08f36bf",
            "date": "2025-01-24T12:52:10Z",
            "author_login": "fwolf-ilias"
          },
          {
            "sha": "35ee154dc568c14cf471e62ec7fb92e4f82e6d57",
            "date": "2025-01-24T13:27:13Z",
            "author_login": "lscharmer"
          },
          {
            "sha": "707fc76998559809546409a6d4962cb100c21697",
            "date": "2025-01-24T06:50:07Z",
            "author_login": "chfsx"
          },
          {
            "sha": "ed6778ec23b7a97adc316bce1ee12ac01fb1cc38",
            "date": "2025-01-17T15:06:45Z",
            "author_login": "chfsx"
          },
          {
            "sha": "ab1c5a61bb41c48a7d6d0d73d8907df623511add",
            "date": "2025-01-23T16:42:13Z",
            "author_login": "lscharmer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-209",
    "description": "An information disclosure vulnerability in ILIAS before 5.3.19, 5.4.12 and 6.0 allows remote authenticated attackers to get the upload data path via a workspace upload.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-05-13T20:15:08.220",
    "last_modified": "2024-11-21T05:14:18.557",
    "fix_date": "2020-05-18T15:01:57Z"
  },
  "references": [
    {
      "url": "https://cwe.mitre.org/data/definitions/209.html",
      "source": "cve@mitre.org",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://docu.ilias.de/goto_docu_pg_118817_35.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docu.ilias.de/goto_docu_pg_122177_35.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docu.ilias.de/goto_docu_pg_124761_35.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ILIAS-eLearning/ILIAS/commit/94d9b16010ec3abeae8d2cbb05622ccd999119ad",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/209.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://docu.ilias.de/goto_docu_pg_118817_35.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docu.ilias.de/goto_docu_pg_122177_35.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docu.ilias.de/goto_docu_pg_124761_35.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ILIAS-eLearning/ILIAS/commit/94d9b16010ec3abeae8d2cbb05622ccd999119ad",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.080723",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ILIAS",
    "owner": "ILIAS-eLearning",
    "created_at": "2015-02-11T06:44:39Z",
    "updated_at": "2025-01-13T16:57:13Z",
    "pushed_at": "2025-01-14T12:35:33Z",
    "size": 2880187,
    "stars": 413,
    "forks": 344,
    "open_issues": 192,
    "watchers": 413,
    "has_security_policy": false,
    "default_branch": "release_9",
    "protected_branches": [
      "release_8",
      "release_9",
      "release_10",
      "trunk"
    ],
    "languages": {
      "PHP": 56484914,
      "JavaScript": 3216878,
      "HTML": 1049290,
      "XSLT": 553008,
      "CSS": 487462,
      "SCSS": 476887,
      "Java": 353023,
      "Less": 34995,
      "Shell": 25102,
      "TypeScript": 17319,
      "Hack": 6739
    },
    "commit_activity": {
      "total_commits_last_year": 2154,
      "avg_commits_per_week": 41.42307692307692,
      "days_active_last_year": 280
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:01:22.205031"
  }
}