{
  "cve_id": "CVE-2020-24369",
  "github_data": {
    "repository": "lua/lua",
    "fix_commit": "ae5b5ba529753c7a653901ffc29b5ea24c3fdf3a",
    "related_commits": [
      "ae5b5ba529753c7a653901ffc29b5ea24c3fdf3a",
      "ae5b5ba529753c7a653901ffc29b5ea24c3fdf3a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "ae5b5ba529753c7a653901ffc29b5ea24c3fdf3a",
      "commit_date": "2020-07-27T16:23:05Z",
      "author": {
        "login": "roberto-ieru",
        "type": "User",
        "stats": {
          "total_commits": 5548,
          "average_weekly_commits": 3.372644376899696,
          "total_additions": 217047,
          "total_deletions": 161720,
          "weeks_active": 1125
        }
      },
      "commit_message": {
        "title": "Fixed bug: line hooks in stripped functions",
        "length": 130,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 21,
        "deletions": 2
      },
      "files": [
        {
          "filename": "ldebug.c",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -783,11 +783,13 @@ l_noret luaG_runerror (lua_State *L, const char *fmt, ...) {\n ** previous instruction 'oldpc'.\n */\n static int changedline (const Proto *p, int oldpc, int newpc) {\n+  if (p->lineinfo == NULL)  /* no debug information? */\n+    return 0;\n   while (oldpc++ < newpc) {\n     if (p->lineinfo[oldpc] != 0)\n       return (luaG_getfuncline(p, oldpc - 1) != luaG_getfuncline(p, newpc));\n   }\n-  return 0;  /* no line changes in the way */\n+  return 0;  /* no line changes between positions */\n }\n \n "
        },
        {
          "filename": "testes/db.lua",
          "status": "modified",
          "additions": 18,
          "deletions": 1,
          "patch": "@@ -884,7 +884,7 @@ end\n \n \n print(\"testing debug functions on chunk without debug info\")\n-prog = [[-- program to be loaded without debug information\n+prog = [[-- program to be loaded without debug information (strip)\n local debug = require'debug'\n local a = 12  -- a local variable\n \n@@ -927,6 +927,23 @@ local f = assert(load(string.dump(load(prog), true)))\n \n assert(f() == 13)\n \n+do   -- bug in 5.4.0: line hooks in stripped code\n+  local function foo ()\n+    local a = 1\n+    local b = 2\n+    return b\n+  end\n+\n+  local s = load(string.dump(foo, true))\n+  local line = true\n+  debug.sethook(function (e, l)\n+    assert(e == \"line\")\n+    line = l\n+  end, \"l\")\n+  assert(s() == 2); debug.sethook(nil)\n+  assert(line == nil)  -- hook called withoug debug info for 1st instruction\n+end\n+\n do   -- tests for 'source' in binary dumps\n   local prog = [[\n     return function (x)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3cdd49c94a8feed94853ba3a6adaa556fb34fd8d",
            "date": "2025-01-14T19:24:46Z",
            "author_login": "roberto-ieru"
          },
          {
            "sha": "10e931da82268a9d190c17a9bdb9b1a4b48c2947",
            "date": "2025-01-13T14:23:07Z",
            "author_login": "roberto-ieru"
          },
          {
            "sha": "4b107a87760ee5f85185a904c9088ca476b94be5",
            "date": "2025-01-10T18:27:17Z",
            "author_login": "roberto-ieru"
          },
          {
            "sha": "429761d7d29226dd0c220de9fdc7c28ea54d95c0",
            "date": "2025-01-10T18:14:01Z",
            "author_login": "roberto-ieru"
          },
          {
            "sha": "915c29f8bd0d4b0435a4b51a6c7913f5e170d09e",
            "date": "2025-01-10T18:11:54Z",
            "author_login": "roberto-ieru"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-476",
    "description": "ldebug.c in Lua 5.4.0 attempts to access debug information via the line hook of a stripped function, leading to a NULL pointer dereference.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-08-17T17:15:13.817",
    "last_modified": "2024-11-21T05:14:40.963",
    "fix_date": "2020-07-27T16:23:05Z"
  },
  "references": [
    {
      "url": "https://github.com/lua/lua/commit/ae5b5ba529753c7a653901ffc29b5ea24c3fdf3a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.lua.org/bugs.html#5.4.0-12",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/lua/lua/commit/ae5b5ba529753c7a653901ffc29b5ea24c3fdf3a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.lua.org/bugs.html#5.4.0-12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:03.796188",
    "processing_status": "enhanced"
  }
}