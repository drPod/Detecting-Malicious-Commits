{
  "cve_id": "CVE-2020-24572",
  "github_data": {
    "repository": "billz/raspap-webgui",
    "fix_commit": "dd5ab7bdc213381ee552001dd80c41ca47afab00",
    "related_commits": [
      "dd5ab7bdc213381ee552001dd80c41ca47afab00",
      "dd5ab7bdc213381ee552001dd80c41ca47afab00"
    ],
    "patch_url": "https://github.com/billz/raspap-webgui/commit/dd5ab7bdc213381ee552001dd80c41ca47afab00.patch",
    "fix_commit_details": {
      "sha": "dd5ab7bdc213381ee552001dd80c41ca47afab00",
      "commit_date": "2020-08-22T10:41:33Z",
      "author": {
        "login": "billz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Remove webconsole, fixes RCE via json-rpc. Thanks @lb0x",
        "length": 55,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 980,
        "additions": 0,
        "deletions": 980
      },
      "files": [
        {
          "filename": "app/css/custom.php",
          "status": "modified",
          "additions": 0,
          "deletions": 15,
          "patch": "@@ -129,21 +129,6 @@\n   float: left;\n }\n \n-.webconsole {\n-  width:100%;\n-  height:100%;\n-  border:1px solid;\n-}\n-\n-#console {\n-  height:500px;\n-}\n-\n-.systemtabcontent {\n-  height:100%;\n-  min-height:500px;\n-}\n-\n .service-status {\n   border-width: 0;\n }"
        },
        {
          "filename": "app/css/lightsout.css",
          "status": "modified",
          "additions": 0,
          "deletions": 10,
          "patch": "@@ -357,16 +357,6 @@ color: #d2d2d2 !important\n   border-color: #404040;\n }\n \n-.webconsole {\n-  width: 100%;\n-  height: 20rem;\n-  border: 1px solid #404040;\n-}\n-\n-#console {\n-  height: 500px;\n-}\n-\n tspan, rect {\n   fill: #d2d2d2;\n }"
        },
        {
          "filename": "includes/adblock.php",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "includes/internetRoute.php",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "includes/webconsole.php",
          "status": "removed",
          "additions": 0,
          "deletions": 938,
          "patch": null
        },
        {
          "filename": "templates/system.php",
          "status": "modified",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -16,19 +16,13 @@\n           <li role=\"presentation\" class=\"nav-item\"><a class=\"nav-link active\" id=\"basictab\" href=\"#basic\" aria-controls=\"basic\" role=\"tab\" data-toggle=\"tab\"><?php echo _(\"Basic\"); ?></a></li>\n           <li role=\"presentation\" class=\"nav-item\"><a class=\"nav-link\" id=\"languagetab\" href=\"#language\" aria-controls=\"language\" role=\"tab\" data-toggle=\"tab\"><?php echo _(\"Language\"); ?></a></li>\n           <li role=\"presentation\" class=\"nav-item\"><a class=\"nav-link\" id=\"advancedtab\" href=\"#advanced\" aria-controls=\"advanced\" role=\"tab\" data-toggle=\"tab\"><?php echo _(\"Advanced\"); ?></a></li>\n-          <li role=\"presentation\" class=\"nav-item\"><a class=\"nav-link\" id=\"consoletab\" href=\"#console\" aria-controls=\"console\" role=\"tab\" data-toggle=\"tab\"><?php echo _(\"Console\"); ?></a></li>\n         </ul>\n-\n-        <div class=\"systemtabcontent tab-content\">\n           <!-- Tab panes -->\n           <div class=\"tab-content\">\n             <?php echo renderTemplate(\"system/basic\", $__template_data) ?>\n             <?php echo renderTemplate(\"system/language\", $__template_data) ?>\n             <?php echo renderTemplate(\"system/advanced\", $__template_data) ?>\n-            <?php echo renderTemplate(\"system/console\", $__template_data) ?>\n           </div><!-- /.tab-content -->\n-        </div><!-- /.systemtabcontent -->\n-\n         </form>\n       </div><!-- /.card-body -->\n       <div class=\"card-footer\"></div>"
        },
        {
          "filename": "templates/system/console.php",
          "status": "removed",
          "additions": 0,
          "deletions": 11,
          "patch": "@@ -1,11 +0,0 @@\n-<!-- console tab -->\n-<div role=\"tabpanel\" class=\"tab-pane\" id=\"console\">\n-  <div class=\"row\">\n-    <div class=\"col-lg-12 mt-3\">\n-    <?php if (!RASPI_MONITOR_ENABLED) : ?>\n-      <iframe src=\"/includes/webconsole.php\" class=\"webconsole\"></iframe>\n-    <?php endif ?>\n-    </div>\n-  </div>\n-</div>\n-"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "94b502a3364c1613486400f944ce57c81e9fd242",
            "date": "2025-01-03T08:49:38Z",
            "author_login": "billz"
          },
          {
            "sha": "bfd5859ce1b87cb0f9c3e85f1ee5bfce6aaa6b4a",
            "date": "2025-01-03T08:38:45Z",
            "author_login": "billz"
          },
          {
            "sha": "13cdfbd8cb121cd60b5bd226e0051452567232b1",
            "date": "2025-01-01T09:22:46Z",
            "author_login": "billz"
          },
          {
            "sha": "531970d9c6c6d4ed0c7e286ba905d1b17c191816",
            "date": "2025-01-01T08:41:56Z",
            "author_login": "billz"
          },
          {
            "sha": "5902a8d6a014ca94884c302ccf09eb40b667fdcc",
            "date": "2025-01-01T08:37:25Z",
            "author_login": "billz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "An issue was discovered in includes/webconsole.php in RaspAP 2.5. With authenticated access, an attacker can use a misconfigured (and virtually unrestricted) web console to attack the underlying OS (Raspberry Pi) running this software, and execute commands on the system (including ones for uploading of files and execution of code).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-08-24T20:15:10.300",
    "last_modified": "2024-11-21T05:15:01.263",
    "fix_date": "2020-08-22T10:41:33Z"
  },
  "references": [
    {
      "url": "https://deadb0x.io/lunchb0x/cve-2020-24572/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/billz/raspap-webgui/commit/dd5ab7bdc213381ee552001dd80c41ca47afab00",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/billz/raspap-webgui/releases",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lb0x",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://deadb0x.io/lunchb0x/cve-2020-24572/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/billz/raspap-webgui/commit/dd5ab7bdc213381ee552001dd80c41ca47afab00",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/billz/raspap-webgui/releases",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lb0x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:03.807136",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "raspap-webgui",
    "owner": "billz",
    "created_at": "2015-02-27T15:17:59Z",
    "updated_at": "2025-01-14T04:05:10Z",
    "pushed_at": "2025-01-05T10:17:10Z",
    "size": 24709,
    "stars": 4517,
    "forks": 797,
    "open_issues": 31,
    "watchers": 4517,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 435370,
      "Shell": 128023,
      "JavaScript": 45787,
      "Python": 25637,
      "CSS": 10962,
      "HTML": 3270
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T18:42:45.405099"
  }
}