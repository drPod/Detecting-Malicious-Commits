{
  "cve_id": "CVE-2020-24619",
  "github_data": {
    "repository": "mltframework/shotcut",
    "fix_commit": "f008adc039642307f6ee3378d378cdb842e52c1d",
    "related_commits": [
      "f008adc039642307f6ee3378d378cdb842e52c1d",
      "f008adc039642307f6ee3378d378cdb842e52c1d"
    ],
    "patch_url": "https://github.com/mltframework/shotcut/commit/f008adc039642307f6ee3378d378cdb842e52c1d.patch",
    "fix_commit_details": {
      "sha": "f008adc039642307f6ee3378d378cdb842e52c1d",
      "commit_date": "2020-08-22T21:03:33Z",
      "author": {
        "login": "ddennedy",
        "type": "User",
        "stats": {
          "total_commits": 5379,
          "average_weekly_commits": 7.773121387283237,
          "total_additions": 2706675,
          "total_deletions": 1927874,
          "weeks_active": 625
        }
      },
      "commit_message": {
        "title": "fix upgrade check is not using TLS correctly",
        "length": 44,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 2,
        "deletions": 7
      },
      "files": [
        {
          "filename": "src/mainwindow.cpp",
          "status": "modified",
          "additions": 2,
          "deletions": 7,
          "patch": "@@ -3240,13 +3240,8 @@ void MainWindow::showUpgradePrompt()\n {\n     if (Settings.checkUpgradeAutomatic()) {\n         showStatusMessage(\"Checking for upgrade...\");\n-        QNetworkRequest request(QUrl(\"https://check.shotcut.org/version.json\"));\n-        QSslConfiguration sslConfig = request.sslConfiguration();\n-        sslConfig.setPeerVerifyMode(QSslSocket::VerifyNone);\n-        request.setSslConfiguration(sslConfig);\n-        m_network.get(request);\n+        m_network.get(QNetworkRequest(QUrl(\"https://check.shotcut.org/version.json\")));\n     } else {\n-        m_network.setStrictTransportSecurityEnabled(false);\n         QAction* action = new QAction(tr(\"Click here to check for a new version of Shotcut.\"), 0);\n         connect(action, SIGNAL(triggered(bool)), SLOT(on_actionUpgrade_triggered()));\n         showStatusMessage(action, 15 /* seconds */);\n@@ -3702,7 +3697,7 @@ void MainWindow::on_actionUpgrade_triggered()\n             Settings.setAskUpgradeAutomatic(false);\n     }\n     showStatusMessage(\"Checking for upgrade...\");\n-    m_network.get(QNetworkRequest(QUrl(\"http://check.shotcut.org/version.json\")));\n+    m_network.get(QNetworkRequest(QUrl(\"https://check.shotcut.org/version.json\")));\n }\n \n void MainWindow::on_actionOpenXML_triggered()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fcdd9c64559a98b5e5ed8e596bb72cb41c0611fc",
            "date": "2025-01-13T01:55:01Z",
            "author_login": "bmatherly"
          },
          {
            "sha": "5fa6e30503696c99e275a81fe65df026ff3a73ed",
            "date": "2025-01-12T05:18:54Z",
            "author_login": "ddennedy"
          },
          {
            "sha": "6b7de9b0f5ef5cb5387dab45bbe7a38bbf2728b5",
            "date": "2025-01-11T19:26:05Z",
            "author_login": "ddennedy"
          },
          {
            "sha": "e718efa199d4293f53e3961fb813a2e928348184",
            "date": "2025-01-11T19:16:54Z",
            "author_login": "ddennedy"
          },
          {
            "sha": "0c333878e6e6d90c5e48269409a84281129c38ed",
            "date": "2025-01-11T19:13:38Z",
            "author_login": "ddennedy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-295",
    "description": "In mainwindow.cpp in Shotcut before 20.09.13, the upgrade check misuses TLS because of setPeerVerifyMode(QSslSocket::VerifyNone). A man-in-the-middle attacker could offer a spoofed download resource.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-09-22T12:15:12.253",
    "last_modified": "2024-11-21T05:15:11.800",
    "fix_date": "2020-08-22T21:03:33Z"
  },
  "references": [
    {
      "url": "https://github.com/mltframework/shotcut/commit/f008adc039642307f6ee3378d378cdb842e52c1d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://shotcut.org/blog/new-release-200913/",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/mltframework/shotcut/commit/f008adc039642307f6ee3378d378cdb842e52c1d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://shotcut.org/blog/new-release-200913/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.143468",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "shotcut",
    "owner": "mltframework",
    "created_at": "2012-04-23T22:37:04Z",
    "updated_at": "2025-01-14T20:24:57Z",
    "pushed_at": "2025-01-13T02:36:38Z",
    "size": 96940,
    "stars": 11338,
    "forks": 1154,
    "open_issues": 45,
    "watchers": 11338,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 3032182,
      "QML": 2101101,
      "JavaScript": 476105,
      "Shell": 132293,
      "C": 22736,
      "CMake": 21795,
      "Objective-C++": 14445,
      "Inno Setup": 5408,
      "Python": 3092,
      "Roff": 1224,
      "Makefile": 1081,
      "QMake": 838
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T21:29:44.685631"
  }
}