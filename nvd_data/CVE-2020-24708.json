{
  "cve_id": "CVE-2020-24708",
  "github_data": {
    "repository": "gophish/gophish",
    "fix_commit": "90fed5a575628b89eaf941e1627b49e0f3693812",
    "related_commits": [
      "90fed5a575628b89eaf941e1627b49e0f3693812",
      "90fed5a575628b89eaf941e1627b49e0f3693812"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "90fed5a575628b89eaf941e1627b49e0f3693812",
      "commit_date": "2020-08-07T03:21:36Z",
      "author": {
        "login": "jordan-wright",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added escaping for error message in sending profile hostname",
        "length": 60,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "static/js/dist/app/sending_profiles.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-var profiles=[];function sendTestEmail(){var o=[];$.each($(\"#headersTable\").DataTable().rows().data(),function(e,a){o.push({key:unescapeHtml(a[0]),value:unescapeHtml(a[1])})});var e={template:{},first_name:$(\"input[name=to_first_name]\").val(),last_name:$(\"input[name=to_last_name]\").val(),email:$(\"input[name=to_email]\").val(),position:$(\"input[name=to_position]\").val(),url:\"\",smtp:{from_address:$(\"#from\").val(),host:$(\"#host\").val(),username:$(\"#username\").val(),password:$(\"#password\").val(),ignore_cert_errors:$(\"#ignore_cert_errors\").prop(\"checked\"),headers:o}};btnHtml=$(\"#sendTestModalSubmit\").html(),$(\"#sendTestModalSubmit\").html('<i class=\"fa fa-spinner fa-spin\"></i> Sending'),api.send_test_email(e).success(function(e){$(\"#sendTestEmailModal\\\\.flashes\").empty().append('<div style=\"text-align:center\" class=\"alert alert-success\">\\t    <i class=\"fa fa-check-circle\"></i> Email Sent!</div>'),$(\"#sendTestModalSubmit\").html(btnHtml)}).error(function(e){$(\"#sendTestEmailModal\\\\.flashes\").empty().append('<div style=\"text-align:center\" class=\"alert alert-danger\">\\t    <i class=\"fa fa-exclamation-circle\"></i> '+e.responseJSON.message+\"</div>\"),$(\"#sendTestModalSubmit\").html(btnHtml)})}function save(e){var o={headers:[]};$.each($(\"#headersTable\").DataTable().rows().data(),function(e,a){o.headers.push({key:unescapeHtml(a[0]),value:unescapeHtml(a[1])})}),o.name=$(\"#name\").val(),o.interface_type=$(\"#interface_type\").val(),o.from_address=$(\"#from\").val(),o.host=$(\"#host\").val(),o.username=$(\"#username\").val(),o.password=$(\"#password\").val(),o.ignore_cert_errors=$(\"#ignore_cert_errors\").prop(\"checked\"),-1!=e?(o.id=profiles[e].id,api.SMTPId.put(o).success(function(e){successFlash(\"Profile edited successfully!\"),load(),dismiss()}).error(function(e){modalError(e.responseJSON.message)})):api.SMTP.post(o).success(function(e){successFlash(\"Profile added successfully!\"),load(),dismiss()}).error(function(e){modalError(e.responseJSON.message)})}function dismiss(){$(\"#modal\\\\.flashes\").empty(),$(\"#name\").val(\"\"),$(\"#interface_type\").val(\"SMTP\"),$(\"#from\").val(\"\"),$(\"#host\").val(\"\"),$(\"#username\").val(\"\"),$(\"#password\").val(\"\"),$(\"#ignore_cert_errors\").prop(\"checked\",!0),$(\"#headersTable\").dataTable().DataTable().clear().draw(),$(\"#modal\").modal(\"hide\")}var dismissSendTestEmailModal=function(){$(\"#sendTestEmailModal\\\\.flashes\").empty(),$(\"#sendTestModalSubmit\").html(\"<i class='fa fa-envelope'></i> Send\")},deleteProfile=function(e){Swal.fire({title:\"Are you sure?\",text:\"This will delete the sending profile. This can't be undone!\",type:\"warning\",animation:!1,showCancelButton:!0,confirmButtonText:\"Delete \"+escapeHtml(profiles[e].name),confirmButtonColor:\"#428bca\",reverseButtons:!0,allowOutsideClick:!1,preConfirm:function(){return new Promise(function(a,o){api.SMTPId.delete(profiles[e].id).success(function(e){a()}).error(function(e){o(e.responseJSON.message)})})}}).then(function(e){e.value&&Swal.fire(\"Sending Profile Deleted!\",\"This sending profile has been deleted!\",\"success\"),$('button:contains(\"OK\")').on(\"click\",function(){location.reload()})})};function edit(e){headers=$(\"#headersTable\").dataTable({destroy:!0,columnDefs:[{orderable:!1,targets:\"no-sort\"}]}),$(\"#modalSubmit\").unbind(\"click\").click(function(){save(e)});var a={};-1!=e&&(a=profiles[e],$(\"#name\").val(a.name),$(\"#interface_type\").val(a.interface_type),$(\"#from\").val(a.from_address),$(\"#host\").val(a.host),$(\"#username\").val(a.username),$(\"#password\").val(a.password),$(\"#ignore_cert_errors\").prop(\"checked\",a.ignore_cert_errors),$.each(a.headers,function(e,a){addCustomHeader(a.key,a.value)}))}function copy(e){$(\"#modalSubmit\").unbind(\"click\").click(function(){save(-1)});var a;a=profiles[e],$(\"#name\").val(\"Copy of \"+a.name),$(\"#interface_type\").val(a.interface_type),$(\"#from\").val(a.from_address),$(\"#host\").val(a.host),$(\"#username\").val(a.username),$(\"#password\").val(a.password),$(\"#ignore_cert_errors\").prop(\"checked\",a.ignore_cert_errors)}function load(){$(\"#profileTable\").hide(),$(\"#emptyMessage\").hide(),$(\"#loading\").show(),api.SMTP.get().success(function(e){profiles=e,$(\"#loading\").hide(),0<profiles.length?($(\"#profileTable\").show(),profileTable=$(\"#profileTable\").DataTable({destroy:!0,columnDefs:[{orderable:!1,targets:\"no-sort\"}]}),profileTable.clear(),profileRows=[],$.each(profiles,function(e,a){profileRows.push([escapeHtml(a.name),a.interface_type,moment(a.modified_date).format(\"MMMM Do YYYY, h:mm:ss a\"),\"<div class='pull-right'><span data-toggle='modal' data-backdrop='static' data-target='#modal'><button class='btn btn-primary' data-toggle='tooltip' data-placement='left' title='Edit Profile' onclick='edit(\"+e+\")'>                    <i class='fa fa-pencil'></i>                    </button></span>\\t\\t    <span data-toggle='modal' data-target='#modal'><button class='btn btn-primary' data-toggle='tooltip' data-placement='left' title='Copy Profile' onclick='copy(\"+e+\")'>                    <i class='fa fa-copy'></i>                    </button></span>                    <button class='btn btn-danger' data-toggle='tooltip' data-placement='left' title='Delete Profile' onclick='deleteProfile(\"+e+\")'>                    <i class='fa fa-trash-o'></i>                    </button></div>\"])}),profileTable.rows.add(profileRows).draw(),$('[data-toggle=\"tooltip\"]').tooltip()):$(\"#emptyMessage\").show()}).error(function(){$(\"#loading\").hide(),errorFlash(\"Error fetching profiles\")})}function addCustomHeader(e,a){var o=[escapeHtml(e),escapeHtml(a),'<span style=\"cursor:pointer;\"><i class=\"fa fa-trash-o\"></i></span>'],s=headers.DataTable(),t=s.column(0).data().indexOf(escapeHtml(e));0<=t?s.row(t,{order:\"index\"}).data(o):s.row.add(o),s.draw()}$(document).ready(function(){$(\".modal\").on(\"hidden.bs.modal\",function(e){$(this).removeClass(\"fv-modal-stack\"),$(\"body\").data(\"fv_open_modals\",$(\"body\").data(\"fv_open_modals\")-1)}),$(\".modal\").on(\"shown.bs.modal\",function(e){void 0===$(\"body\").data(\"fv_open_modals\")&&$(\"body\").data(\"fv_open_modals\",0),$(this).hasClass(\"fv-modal-stack\")||($(this).addClass(\"fv-modal-stack\"),$(\"body\").data(\"fv_open_modals\",$(\"body\").data(\"fv_open_modals\")+1),$(this).css(\"z-index\",1040+10*$(\"body\").data(\"fv_open_modals\")),$(\".modal-backdrop\").not(\".fv-modal-stack\").css(\"z-index\",1039+10*$(\"body\").data(\"fv_open_modals\")),$(\".modal-backdrop\").not(\"fv-modal-stack\").addClass(\"fv-modal-stack\"))}),$.fn.modal.Constructor.prototype.enforceFocus=function(){$(document).off(\"focusin.bs.modal\").on(\"focusin.bs.modal\",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||$(e.target).closest(\".cke_dialog, .cke\").length||this.$element.trigger(\"focus\")},this))},$(document).on(\"hidden.bs.modal\",\".modal\",function(){$(\".modal:visible\").length&&$(document.body).addClass(\"modal-open\")}),$(\"#modal\").on(\"hidden.bs.modal\",function(e){dismiss()}),$(\"#sendTestEmailModal\").on(\"hidden.bs.modal\",function(e){dismissSendTestEmailModal()}),$(\"#headersForm\").on(\"submit\",function(){return headerKey=$(\"#headerKey\").val(),headerValue=$(\"#headerValue\").val(),\"\"==headerKey||\"\"==headerValue||(addCustomHeader(headerKey,headerValue),$(\"#headersForm>div>input\").val(\"\"),$(\"#headerKey\").focus()),!1}),$(\"#headersTable\").on(\"click\",\"span>i.fa-trash-o\",function(){headers.DataTable().row($(this).parents(\"tr\")).remove().draw()}),load()});\n\\ No newline at end of file\n+var profiles=[];function sendTestEmail(){var s=[];$.each($(\"#headersTable\").DataTable().rows().data(),function(e,a){s.push({key:unescapeHtml(a[0]),value:unescapeHtml(a[1])})});var e={template:{},first_name:$(\"input[name=to_first_name]\").val(),last_name:$(\"input[name=to_last_name]\").val(),email:$(\"input[name=to_email]\").val(),position:$(\"input[name=to_position]\").val(),url:\"\",smtp:{from_address:$(\"#from\").val(),host:$(\"#host\").val(),username:$(\"#username\").val(),password:$(\"#password\").val(),ignore_cert_errors:$(\"#ignore_cert_errors\").prop(\"checked\"),headers:s}};btnHtml=$(\"#sendTestModalSubmit\").html(),$(\"#sendTestModalSubmit\").html('<i class=\"fa fa-spinner fa-spin\"></i> Sending'),api.send_test_email(e).success(function(e){$(\"#sendTestEmailModal\\\\.flashes\").empty().append('<div style=\"text-align:center\" class=\"alert alert-success\">\\t    <i class=\"fa fa-check-circle\"></i> Email Sent!</div>'),$(\"#sendTestModalSubmit\").html(btnHtml)}).error(function(e){$(\"#sendTestEmailModal\\\\.flashes\").empty().append('<div style=\"text-align:center\" class=\"alert alert-danger\">\\t    <i class=\"fa fa-exclamation-circle\"></i> '+escapeHtml(e.responseJSON.message)+\"</div>\"),$(\"#sendTestModalSubmit\").html(btnHtml)})}function save(e){var s={headers:[]};$.each($(\"#headersTable\").DataTable().rows().data(),function(e,a){s.headers.push({key:unescapeHtml(a[0]),value:unescapeHtml(a[1])})}),s.name=$(\"#name\").val(),s.interface_type=$(\"#interface_type\").val(),s.from_address=$(\"#from\").val(),s.host=$(\"#host\").val(),s.username=$(\"#username\").val(),s.password=$(\"#password\").val(),s.ignore_cert_errors=$(\"#ignore_cert_errors\").prop(\"checked\"),-1!=e?(s.id=profiles[e].id,api.SMTPId.put(s).success(function(e){successFlash(\"Profile edited successfully!\"),load(),dismiss()}).error(function(e){modalError(e.responseJSON.message)})):api.SMTP.post(s).success(function(e){successFlash(\"Profile added successfully!\"),load(),dismiss()}).error(function(e){modalError(e.responseJSON.message)})}function dismiss(){$(\"#modal\\\\.flashes\").empty(),$(\"#name\").val(\"\"),$(\"#interface_type\").val(\"SMTP\"),$(\"#from\").val(\"\"),$(\"#host\").val(\"\"),$(\"#username\").val(\"\"),$(\"#password\").val(\"\"),$(\"#ignore_cert_errors\").prop(\"checked\",!0),$(\"#headersTable\").dataTable().DataTable().clear().draw(),$(\"#modal\").modal(\"hide\")}var dismissSendTestEmailModal=function(){$(\"#sendTestEmailModal\\\\.flashes\").empty(),$(\"#sendTestModalSubmit\").html(\"<i class='fa fa-envelope'></i> Send\")},deleteProfile=function(e){Swal.fire({title:\"Are you sure?\",text:\"This will delete the sending profile. This can't be undone!\",type:\"warning\",animation:!1,showCancelButton:!0,confirmButtonText:\"Delete \"+escapeHtml(profiles[e].name),confirmButtonColor:\"#428bca\",reverseButtons:!0,allowOutsideClick:!1,preConfirm:function(){return new Promise(function(a,s){api.SMTPId.delete(profiles[e].id).success(function(e){a()}).error(function(e){s(e.responseJSON.message)})})}}).then(function(e){e.value&&Swal.fire(\"Sending Profile Deleted!\",\"This sending profile has been deleted!\",\"success\"),$('button:contains(\"OK\")').on(\"click\",function(){location.reload()})})};function edit(e){headers=$(\"#headersTable\").dataTable({destroy:!0,columnDefs:[{orderable:!1,targets:\"no-sort\"}]}),$(\"#modalSubmit\").unbind(\"click\").click(function(){save(e)});var a={};-1!=e&&(a=profiles[e],$(\"#name\").val(a.name),$(\"#interface_type\").val(a.interface_type),$(\"#from\").val(a.from_address),$(\"#host\").val(a.host),$(\"#username\").val(a.username),$(\"#password\").val(a.password),$(\"#ignore_cert_errors\").prop(\"checked\",a.ignore_cert_errors),$.each(a.headers,function(e,a){addCustomHeader(a.key,a.value)}))}function copy(e){$(\"#modalSubmit\").unbind(\"click\").click(function(){save(-1)});var a;a=profiles[e],$(\"#name\").val(\"Copy of \"+a.name),$(\"#interface_type\").val(a.interface_type),$(\"#from\").val(a.from_address),$(\"#host\").val(a.host),$(\"#username\").val(a.username),$(\"#password\").val(a.password),$(\"#ignore_cert_errors\").prop(\"checked\",a.ignore_cert_errors)}function load(){$(\"#profileTable\").hide(),$(\"#emptyMessage\").hide(),$(\"#loading\").show(),api.SMTP.get().success(function(e){profiles=e,$(\"#loading\").hide(),0<profiles.length?($(\"#profileTable\").show(),profileTable=$(\"#profileTable\").DataTable({destroy:!0,columnDefs:[{orderable:!1,targets:\"no-sort\"}]}),profileTable.clear(),profileRows=[],$.each(profiles,function(e,a){profileRows.push([escapeHtml(a.name),a.interface_type,moment(a.modified_date).format(\"MMMM Do YYYY, h:mm:ss a\"),\"<div class='pull-right'><span data-toggle='modal' data-backdrop='static' data-target='#modal'><button class='btn btn-primary' data-toggle='tooltip' data-placement='left' title='Edit Profile' onclick='edit(\"+e+\")'>                    <i class='fa fa-pencil'></i>                    </button></span>\\t\\t    <span data-toggle='modal' data-target='#modal'><button class='btn btn-primary' data-toggle='tooltip' data-placement='left' title='Copy Profile' onclick='copy(\"+e+\")'>                    <i class='fa fa-copy'></i>                    </button></span>                    <button class='btn btn-danger' data-toggle='tooltip' data-placement='left' title='Delete Profile' onclick='deleteProfile(\"+e+\")'>                    <i class='fa fa-trash-o'></i>                    </button></div>\"])}),profileTable.rows.add(profileRows).draw(),$('[data-toggle=\"tooltip\"]').tooltip()):$(\"#emptyMessage\").show()}).error(function(){$(\"#loading\").hide(),errorFlash(\"Error fetching profiles\")})}function addCustomHeader(e,a){var s=[escapeHtml(e),escapeHtml(a),'<span style=\"cursor:pointer;\"><i class=\"fa fa-trash-o\"></i></span>'],t=headers.DataTable(),o=t.column(0).data().indexOf(escapeHtml(e));0<=o?t.row(o,{order:\"index\"}).data(s):t.row.add(s),t.draw()}$(document).ready(function(){$(\".modal\").on(\"hidden.bs.modal\",function(e){$(this).removeClass(\"fv-modal-stack\"),$(\"body\").data(\"fv_open_modals\",$(\"body\").data(\"fv_open_modals\")-1)}),$(\".modal\").on(\"shown.bs.modal\",function(e){void 0===$(\"body\").data(\"fv_open_modals\")&&$(\"body\").data(\"fv_open_modals\",0),$(this).hasClass(\"fv-modal-stack\")||($(this).addClass(\"fv-modal-stack\"),$(\"body\").data(\"fv_open_modals\",$(\"body\").data(\"fv_open_modals\")+1),$(this).css(\"z-index\",1040+10*$(\"body\").data(\"fv_open_modals\")),$(\".modal-backdrop\").not(\".fv-modal-stack\").css(\"z-index\",1039+10*$(\"body\").data(\"fv_open_modals\")),$(\".modal-backdrop\").not(\"fv-modal-stack\").addClass(\"fv-modal-stack\"))}),$.fn.modal.Constructor.prototype.enforceFocus=function(){$(document).off(\"focusin.bs.modal\").on(\"focusin.bs.modal\",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||$(e.target).closest(\".cke_dialog, .cke\").length||this.$element.trigger(\"focus\")},this))},$(document).on(\"hidden.bs.modal\",\".modal\",function(){$(\".modal:visible\").length&&$(document.body).addClass(\"modal-open\")}),$(\"#modal\").on(\"hidden.bs.modal\",function(e){dismiss()}),$(\"#sendTestEmailModal\").on(\"hidden.bs.modal\",function(e){dismissSendTestEmailModal()}),$(\"#headersForm\").on(\"submit\",function(){return headerKey=$(\"#headerKey\").val(),headerValue=$(\"#headerValue\").val(),\"\"==headerKey||\"\"==headerValue||(addCustomHeader(headerKey,headerValue),$(\"#headersForm>div>input\").val(\"\"),$(\"#headerKey\").focus()),!1}),$(\"#headersTable\").on(\"click\",\"span>i.fa-trash-o\",function(){headers.DataTable().row($(this).parents(\"tr\")).remove().draw()}),load()});\n\\ No newline at end of file"
        },
        {
          "filename": "static/js/src/app/sending_profiles.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,7 +36,7 @@ function sendTestEmail() {\n         })\n         .error(function (data) {\n             $(\"#sendTestEmailModal\\\\.flashes\").empty().append(\"<div style=\\\"text-align:center\\\" class=\\\"alert alert-danger\\\">\\\n-\t    <i class=\\\"fa fa-exclamation-circle\\\"></i> \" + data.responseJSON.message + \"</div>\")\n+\t    <i class=\\\"fa fa-exclamation-circle\\\"></i> \" + escapeHtml(data.responseJSON.message) + \"</div>\")\n             $(\"#sendTestModalSubmit\").html(btnHtml)\n         })\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "95618469799295e2c0fec980805a2dfbb818816b",
            "date": "2024-09-23T04:24:43Z",
            "author_login": "jordan-wright"
          },
          {
            "sha": "908886f2cd9567ddd0523d43532e33e4df8fd200",
            "date": "2024-09-23T03:53:08Z",
            "author_login": "Caetan"
          },
          {
            "sha": "8e79294413932fa302212d8e785b281fb0f8896d",
            "date": "2023-09-15T14:45:30Z",
            "author_login": "glennzw"
          },
          {
            "sha": "ac9e6a719004a1cf08cf1585a996372dbd301c9f",
            "date": "2023-08-23T02:03:39Z",
            "author_login": "rpsteinbrueck"
          },
          {
            "sha": "04f0fb6dfd9498f68fed145e1c3fbe515697cf0a",
            "date": "2023-08-23T01:50:03Z",
            "author_login": "wmnnd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross Site Scripting (XSS) vulnerability in Gophish before 0.11.0 via the Host field on the send profile form.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-10-28T20:15:13.227",
    "last_modified": "2024-11-21T05:15:55.590",
    "fix_date": "2020-08-07T03:21:36Z"
  },
  "references": [
    {
      "url": "https://github.com/gophish/gophish/commit/90fed5a575628b89eaf941e1627b49e0f3693812",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://herolab.usd.de/security-advisories/usd-2020-0048/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gophish/gophish/commit/90fed5a575628b89eaf941e1627b49e0f3693812",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://herolab.usd.de/security-advisories/usd-2020-0048/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.438457",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "gophish",
    "owner": "gophish",
    "created_at": "2013-11-18T23:26:43Z",
    "updated_at": "2025-01-26T05:39:32Z",
    "pushed_at": "2024-09-23T04:24:43Z",
    "size": 55052,
    "stars": 12059,
    "forks": 2327,
    "open_issues": 598,
    "watchers": 12059,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Go": 372379,
      "JavaScript": 154041,
      "HTML": 72203,
      "Shell": 3070,
      "Jinja": 2399,
      "Dockerfile": 1081
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:55:55.888259"
  }
}