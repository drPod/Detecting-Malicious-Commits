{
  "cve_id": "CVE-2020-24712",
  "github_data": {
    "repository": "gophish/gophish",
    "fix_commit": "4e9b94b641755f359542b246cc0c555fa3bc6715",
    "related_commits": [
      "4e9b94b641755f359542b246cc0c555fa3bc6715",
      "4e9b94b641755f359542b246cc0c555fa3bc6715"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "4e9b94b641755f359542b246cc0c555fa3bc6715",
      "commit_date": "2020-07-18T03:40:10Z",
      "author": {
        "login": "jordan-wright",
        "type": "User",
        "stats": {
          "total_commits": 569,
          "average_weekly_commits": 0.9726495726495726,
          "total_additions": 165115,
          "total_deletions": 118436,
          "weeks_active": 148
        }
      },
      "commit_message": {
        "title": "Fixed validation when setting IMAP hostname",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "static/js/dist/app/settings.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-$(document).ready(function(){function t(){api.IMAP.get().success(function(e){0==e.length?$(\"#lastlogindiv\").hide():(0==(e=e[0]).enabled?$(\"#lastlogindiv\").hide():$(\"#lastlogindiv\").show(),$(\"#imapusername\").val(e.username),$(\"#imaphost\").val(e.host),$(\"#imapport\").val(e.port),$(\"#imappassword\").val(e.password),$(\"#use_tls\").prop(\"checked\",e.tls),$(\"#use_imap\").prop(\"checked\",e.enabled),$(\"#folder\").val(e.folder),$(\"#restrictdomain\").val(e.restrict_domain),$(\"#deletecampaign\").prop(\"checked\",e.delete_reported_campaign_email),$(\"#lastloginraw\").val(e.last_login),$(\"#lastlogin\").val(moment.utc(e.last_login).fromNow()),$(\"#imapfreq\").val(e.imap_freq))}).error(function(){errorFlash(\"Error fetching IMAP settings\")})}$('[data-toggle=\"tooltip\"]').tooltip(),$(\"#apiResetForm\").submit(function(e){return api.reset().success(function(e){user.api_key=e.data,successFlash(e.message),$(\"#api_key\").val(user.api_key)}).error(function(e){errorFlash(e.message)}),!1}),$(\"#settingsForm\").submit(function(e){return $.post(\"/settings\",$(this).serialize()).done(function(e){successFlash(e.message)}).fail(function(e){errorFlash(e.responseJSON.message)}),!1}),$(\"#savesettings\").click(function(){var e={};return e.host=$(\"#imaphost\").val(),e.port=$(\"#imapport\").val(),e.username=$(\"#imapusername\").val(),e.password=$(\"#imappassword\").val(),e.enabled=$(\"#use_imap\").prop(\"checked\"),e.tls=$(\"#use_tls\").prop(\"checked\"),e.folder=$(\"#folder\").val(),e.imap_freq=$(\"#imapfreq\").val(),e.restrict_domain=$(\"#restrictdomain\").val(),e.delete_reported_campaign_email=$(\"#deletecampaign\").prop(\"checked\"),\"\"==e.host?(errorFlash(\"No IMAP Host specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0):\"\"==e.port?(errorFlash(\"No IMAP Port specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0):isNaN(e.port)||e.port<1||65535<e.port?(errorFlash(\"Invalid IMAP Port\"),document.body.scrollTop=0,document.documentElement.scrollTop=0):(\"\"==e.imap_freq&&(e.imap_freq=\"60\"),api.IMAP.post(e).done(function(e){1==e.success?successFlashFade(\"Successfully updated IMAP settings.\",2):errorFlash(\"Unable to update IMAP settings.\")}).success(function(e){t()}).fail(function(e){errorFlash(e.responseJSON.message)}).always(function(e){document.body.scrollTop=0,document.documentElement.scrollTop=0})),!1}),$(\"#validateimap\").click(function(){var e={};if(e.host=$(\"#imaphost\").val(),e.port=$(\"#imapport\").val(),e.username=$(\"#imapusername\").val(),e.password=$(\"#imappassword\").val(),e.tls=$(\"#use_tls\").prop(\"checked\"),\"\"==e.host)return errorFlash(\"No IMAP Host specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1;if(\"\"==e.port)return errorFlash(\"No IMAP Port specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1;if(isNaN(e.port)||e.port<1||65535<e.port)return errorFlash(\"Invalid IMAP Port\"),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1;var t=$(\"#validateimap\").html();$(\"#imaphost\").attr(\"disabled\",!0),$(\"#imapport\").attr(\"disabled\",!0),$(\"#imapusername\").attr(\"disabled\",!0),$(\"#imappassword\").attr(\"disabled\",!0),$(\"#use_imap\").attr(\"disabled\",!0),$(\"#use_tls\").attr(\"disabled\",!0),$(\"#folder\").attr(\"disabled\",!0),$(\"#restrictdomain\").attr(\"disabled\",!0),$(\"#deletecampaign\").attr(\"disabled\",!0),$(\"#lastlogin\").attr(\"disabled\",!0),$(\"#imapfreq\").attr(\"disabled\",!0),$(\"#validateimap\").attr(\"disabled\",!0),$(\"#validateimap\").html(\"<i class='fa fa-circle-o-notch fa-spin'></i> Testing...\"),api.IMAP.validate(e).done(function(t){1==t.success?Swal.fire({title:\"Success\",html:\"Logged into <b>\"+$(\"#imaphost\").val()+\"</b>\",type:\"success\"}):Swal.fire({title:\"Failed!\",html:\"Unable to login to <b>\"+$(\"#imaphost\").val()+\"</b>.\",type:\"error\",showCancelButton:!0,cancelButtonText:\"Close\",confirmButtonText:\"More Info\",confirmButtonColor:\"#428bca\",allowOutsideClick:!1}).then(function(e){e.value&&Swal.fire({title:\"Error:\",text:t.message})})}).fail(function(){Swal.fire({title:\"Failed!\",text:\"An unecpected error occured.\",type:\"error\"})}).always(function(){$(\"#imaphost\").attr(\"disabled\",!1),$(\"#imapport\").attr(\"disabled\",!1),$(\"#imapusername\").attr(\"disabled\",!1),$(\"#imappassword\").attr(\"disabled\",!1),$(\"#use_imap\").attr(\"disabled\",!1),$(\"#use_tls\").attr(\"disabled\",!1),$(\"#folder\").attr(\"disabled\",!1),$(\"#restrictdomain\").attr(\"disabled\",!1),$(\"#deletecampaign\").attr(\"disabled\",!1),$(\"#lastlogin\").attr(\"disabled\",!1),$(\"#imapfreq\").attr(\"disabled\",!1),$(\"#validateimap\").attr(\"disabled\",!1),$(\"#validateimap\").html(t)})}),$(\"#reporttab\").click(function(){t()}),$(\"#advanced\").click(function(){$(\"#advancedarea\").toggle()});var e=localStorage.getItem(\"gophish.use_map\");$(\"#use_map\").prop(\"checked\",JSON.parse(e)),$(\"#use_map\").on(\"change\",function(){localStorage.setItem(\"gophish.use_map\",JSON.stringify(this.checked))}),t()});\n\\ No newline at end of file\n+$(document).ready(function(){function t(){api.IMAP.get().success(function(e){0==e.length?$(\"#lastlogindiv\").hide():(0==(e=e[0]).enabled?$(\"#lastlogindiv\").hide():$(\"#lastlogindiv\").show(),$(\"#imapusername\").val(e.username),$(\"#imaphost\").val(e.host),$(\"#imapport\").val(e.port),$(\"#imappassword\").val(e.password),$(\"#use_tls\").prop(\"checked\",e.tls),$(\"#use_imap\").prop(\"checked\",e.enabled),$(\"#folder\").val(e.folder),$(\"#restrictdomain\").val(e.restrict_domain),$(\"#deletecampaign\").prop(\"checked\",e.delete_reported_campaign_email),$(\"#lastloginraw\").val(e.last_login),$(\"#lastlogin\").val(moment.utc(e.last_login).fromNow()),$(\"#imapfreq\").val(e.imap_freq))}).error(function(){errorFlash(\"Error fetching IMAP settings\")})}$('[data-toggle=\"tooltip\"]').tooltip(),$(\"#apiResetForm\").submit(function(e){return api.reset().success(function(e){user.api_key=e.data,successFlash(e.message),$(\"#api_key\").val(user.api_key)}).error(function(e){errorFlash(e.message)}),!1}),$(\"#settingsForm\").submit(function(e){return $.post(\"/settings\",$(this).serialize()).done(function(e){successFlash(e.message)}).fail(function(e){errorFlash(e.responseJSON.message)}),!1}),$(\"#savesettings\").click(function(){var e={};return e.host=$(\"#imaphost\").val(),e.port=$(\"#imapport\").val(),e.username=$(\"#imapusername\").val(),e.password=$(\"#imappassword\").val(),e.enabled=$(\"#use_imap\").prop(\"checked\"),e.tls=$(\"#use_tls\").prop(\"checked\"),e.folder=$(\"#folder\").val(),e.imap_freq=$(\"#imapfreq\").val(),e.restrict_domain=$(\"#restrictdomain\").val(),e.delete_reported_campaign_email=$(\"#deletecampaign\").prop(\"checked\"),\"\"==e.host?(errorFlash(\"No IMAP Host specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0):\"\"==e.port?(errorFlash(\"No IMAP Port specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0):isNaN(e.port)||e.port<1||65535<e.port?(errorFlash(\"Invalid IMAP Port\"),document.body.scrollTop=0,document.documentElement.scrollTop=0):(\"\"==e.imap_freq&&(e.imap_freq=\"60\"),api.IMAP.post(e).done(function(e){1==e.success?successFlashFade(\"Successfully updated IMAP settings.\",2):errorFlash(\"Unable to update IMAP settings.\")}).success(function(e){t()}).fail(function(e){errorFlash(e.responseJSON.message)}).always(function(e){document.body.scrollTop=0,document.documentElement.scrollTop=0})),!1}),$(\"#validateimap\").click(function(){var e={};if(e.host=$(\"#imaphost\").val(),e.port=$(\"#imapport\").val(),e.username=$(\"#imapusername\").val(),e.password=$(\"#imappassword\").val(),e.tls=$(\"#use_tls\").prop(\"checked\"),\"\"==e.host)return errorFlash(\"No IMAP Host specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1;if(\"\"==e.port)return errorFlash(\"No IMAP Port specified\"),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1;if(isNaN(e.port)||e.port<1||65535<e.port)return errorFlash(\"Invalid IMAP Port\"),document.body.scrollTop=0,document.documentElement.scrollTop=0,!1;var t=$(\"#validateimap\").html();$(\"#imaphost\").attr(\"disabled\",!0),$(\"#imapport\").attr(\"disabled\",!0),$(\"#imapusername\").attr(\"disabled\",!0),$(\"#imappassword\").attr(\"disabled\",!0),$(\"#use_imap\").attr(\"disabled\",!0),$(\"#use_tls\").attr(\"disabled\",!0),$(\"#folder\").attr(\"disabled\",!0),$(\"#restrictdomain\").attr(\"disabled\",!0),$(\"#deletecampaign\").attr(\"disabled\",!0),$(\"#lastlogin\").attr(\"disabled\",!0),$(\"#imapfreq\").attr(\"disabled\",!0),$(\"#validateimap\").attr(\"disabled\",!0),$(\"#validateimap\").html(\"<i class='fa fa-circle-o-notch fa-spin'></i> Testing...\"),api.IMAP.validate(e).done(function(t){1==t.success?Swal.fire({title:\"Success\",html:\"Logged into <b>\"+escapeHtml($(\"#imaphost\").val())+\"</b>\",type:\"success\"}):Swal.fire({title:\"Failed!\",html:\"Unable to login to <b>\"+escapeHtml($(\"#imaphost\").val())+\"</b>.\",type:\"error\",showCancelButton:!0,cancelButtonText:\"Close\",confirmButtonText:\"More Info\",confirmButtonColor:\"#428bca\",allowOutsideClick:!1}).then(function(e){e.value&&Swal.fire({title:\"Error:\",text:t.message})})}).fail(function(){Swal.fire({title:\"Failed!\",text:\"An unecpected error occured.\",type:\"error\"})}).always(function(){$(\"#imaphost\").attr(\"disabled\",!1),$(\"#imapport\").attr(\"disabled\",!1),$(\"#imapusername\").attr(\"disabled\",!1),$(\"#imappassword\").attr(\"disabled\",!1),$(\"#use_imap\").attr(\"disabled\",!1),$(\"#use_tls\").attr(\"disabled\",!1),$(\"#folder\").attr(\"disabled\",!1),$(\"#restrictdomain\").attr(\"disabled\",!1),$(\"#deletecampaign\").attr(\"disabled\",!1),$(\"#lastlogin\").attr(\"disabled\",!1),$(\"#imapfreq\").attr(\"disabled\",!1),$(\"#validateimap\").attr(\"disabled\",!1),$(\"#validateimap\").html(t)})}),$(\"#reporttab\").click(function(){t()}),$(\"#advanced\").click(function(){$(\"#advancedarea\").toggle()});var e=localStorage.getItem(\"gophish.use_map\");$(\"#use_map\").prop(\"checked\",JSON.parse(e)),$(\"#use_map\").on(\"change\",function(){localStorage.setItem(\"gophish.use_map\",JSON.stringify(this.checked))}),t()});\n\\ No newline at end of file"
        },
        {
          "filename": "static/js/src/app/settings.js",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -132,13 +132,13 @@ $(document).ready(function () {\n             if (data.success == true) {\n                 Swal.fire({\n                     title: \"Success\",\n-                    html: \"Logged into <b>\" + $(\"#imaphost\").val() + \"</b>\",\n+                    html: \"Logged into <b>\" + escapeHtml($(\"#imaphost\").val()) + \"</b>\",\n                     type: \"success\",\n                 })\n             } else {\n                 Swal.fire({\n                     title: \"Failed!\",\n-                    html: \"Unable to login to <b>\" + $(\"#imaphost\").val() + \"</b>.\",\n+                    html: \"Unable to login to <b>\" + escapeHtml($(\"#imaphost\").val()) + \"</b>.\",\n                     type: \"error\",\n                     showCancelButton: true,\n                     cancelButtonText: \"Close\",\n@@ -230,4 +230,4 @@ $(document).ready(function () {\n     })\n \n     loadIMAPSettings()\n-})\n\\ No newline at end of file\n+})"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "95618469799295e2c0fec980805a2dfbb818816b",
            "date": "2024-09-23T04:24:43Z",
            "author_login": "jordan-wright"
          },
          {
            "sha": "908886f2cd9567ddd0523d43532e33e4df8fd200",
            "date": "2024-09-23T03:53:08Z",
            "author_login": "Caetan"
          },
          {
            "sha": "8e79294413932fa302212d8e785b281fb0f8896d",
            "date": "2023-09-15T14:45:30Z",
            "author_login": "glennzw"
          },
          {
            "sha": "ac9e6a719004a1cf08cf1585a996372dbd301c9f",
            "date": "2023-08-23T02:03:39Z",
            "author_login": "rpsteinbrueck"
          },
          {
            "sha": "04f0fb6dfd9498f68fed145e1c3fbe515697cf0a",
            "date": "2023-08-23T01:50:03Z",
            "author_login": "wmnnd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross Site Scripting (XSS) vulnerability in Gophish before 0.11.0 via the IMAP Host field on the account settings page.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-10-28T20:15:13.527",
    "last_modified": "2024-11-21T05:15:56.690",
    "fix_date": "2020-07-18T03:40:10Z"
  },
  "references": [
    {
      "url": "https://github.com/gophish/gophish/commit/4e9b94b641755f359542b246cc0c555fa3bc6715",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gophish/gophish/releases/tag/v0.11.0",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://herolab.usd.de/security-advisories/usd-2020-0050/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gophish/gophish/commit/4e9b94b641755f359542b246cc0c555fa3bc6715",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gophish/gophish/releases/tag/v0.11.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://herolab.usd.de/security-advisories/usd-2020-0050/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.438910",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "gophish",
    "owner": "gophish",
    "created_at": "2013-11-18T23:26:43Z",
    "updated_at": "2025-01-26T05:39:32Z",
    "pushed_at": "2024-09-23T04:24:43Z",
    "size": 55052,
    "stars": 12059,
    "forks": 2327,
    "open_issues": 598,
    "watchers": 12059,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Go": 372379,
      "JavaScript": 154041,
      "HTML": 72203,
      "Shell": 3070,
      "Jinja": 2399,
      "Dockerfile": 1081
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:55:55.888259"
  }
}