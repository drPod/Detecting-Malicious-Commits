{
  "cve_id": "CVE-2020-25613",
  "github_data": {
    "repository": "ruby/webrick",
    "fix_commit": "8946bb38b4d87549f0d99ed73c62c41933f97cc7",
    "related_commits": [
      "8946bb38b4d87549f0d99ed73c62c41933f97cc7",
      "8946bb38b4d87549f0d99ed73c62c41933f97cc7"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8946bb38b4d87549f0d99ed73c62c41933f97cc7",
      "commit_date": "2020-09-29T04:15:58Z",
      "author": {
        "login": "mame",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Make it more strict to interpret some headers",
        "length": 78,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/webrick/httprequest.rb",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -227,9 +227,9 @@ def parse(socket=nil)\n         raise HTTPStatus::BadRequest, \"bad URI `#{@unparsed_uri}'.\"\n       end\n \n-      if /close/io =~ self[\"connection\"]\n+      if /\\Aclose\\z/io =~ self[\"connection\"]\n         @keep_alive = false\n-      elsif /keep-alive/io =~ self[\"connection\"]\n+      elsif /\\Akeep-alive\\z/io =~ self[\"connection\"]\n         @keep_alive = true\n       elsif @http_version < \"1.1\"\n         @keep_alive = false\n@@ -508,7 +508,7 @@ def read_body(socket, block)\n       return unless socket\n       if tc = self['transfer-encoding']\n         case tc\n-        when /chunked/io then read_chunked(socket, block)\n+        when /\\Achunked\\z/io then read_chunked(socket, block)\n         else raise HTTPStatus::NotImplemented, \"Transfer-Encoding: #{tc}.\"\n         end\n       elsif self['content-length'] || @remaining_size"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b0866430dadfa50ce9aa1f7dbdcdab10308691c3",
            "date": "2025-01-20T23:50:44Z",
            "author_login": "hsbt"
          },
          {
            "sha": "cd4d166342adca1a8f370a12e5b7d7a179a6058e",
            "date": "2025-01-20T23:19:55Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "0b1bb5768a1ab4ab6564fad14ccc58103321d1dc",
            "date": "2025-01-13T23:18:46Z",
            "author_login": "olleolleolle"
          },
          {
            "sha": "b7e24bbb687fb065691878f6537ca77bf03e5a92",
            "date": "2025-01-13T23:14:10Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c7712df6d318cef80d0aa631232c17467984bdf6",
            "date": "2024-12-24T00:33:48Z",
            "author_login": "hsbt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-444",
    "description": "An issue was discovered in Ruby through 2.5.8, 2.6.x through 2.6.6, and 2.7.x through 2.7.1. WEBrick, a simple HTTP server bundled with Ruby, had not checked the transfer-encoding header value rigorously. An attacker may potentially exploit this issue to bypass a reverse proxy (which also has a poor header check), which may lead to an HTTP Request Smuggling attack.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-10-06T13:15:13.823",
    "last_modified": "2024-11-21T05:18:14.437",
    "fix_date": "2020-09-29T04:15:58Z"
  },
  "references": [
    {
      "url": "https://github.com/ruby/webrick/commit/8946bb38b4d87549f0d99ed73c62c41933f97cc7",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/965267",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00033.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PFP3E7KXXT3H3KA6CBZPUOGA5VPFARRJ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YTZURYROG3FFED3TYCQOBV66BS4K6WOV/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202401-27",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210115-0008/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.ruby-lang.org/en/news/2020/09/29/http-request-smuggling-cve-2020-25613/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ruby/webrick/commit/8946bb38b4d87549f0d99ed73c62c41933f97cc7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/965267",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00033.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PFP3E7KXXT3H3KA6CBZPUOGA5VPFARRJ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YTZURYROG3FFED3TYCQOBV66BS4K6WOV/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202401-27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210115-0008/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.ruby-lang.org/en/news/2020/09/29/http-request-smuggling-cve-2020-25613/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.169476",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "webrick",
    "owner": "ruby",
    "created_at": "2017-03-30T01:16:49Z",
    "updated_at": "2025-01-26T03:29:14Z",
    "pushed_at": "2025-01-20T23:50:45Z",
    "size": 832,
    "stars": 285,
    "forks": 99,
    "open_issues": 20,
    "watchers": 285,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Ruby": 340470,
      "Shell": 131,
      "HTML": 79
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-2-clause"
    },
    "collected_at": "2025-01-26T08:07:31.748770"
  }
}