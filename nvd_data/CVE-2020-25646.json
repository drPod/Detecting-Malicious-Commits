{
  "cve_id": "CVE-2020-25646",
  "github_data": {
    "repository": "ansible-collections/community.crypto",
    "fix_commit": "233d1afc296f6770e905a1785ee2f35af7605e43",
    "related_commits": [
      "233d1afc296f6770e905a1785ee2f35af7605e43",
      "233d1afc296f6770e905a1785ee2f35af7605e43"
    ],
    "patch_url": "https://github.com/ansible-collections/community.crypto/commit/233d1afc296f6770e905a1785ee2f35af7605e43.patch",
    "fix_commit_details": {
      "sha": "233d1afc296f6770e905a1785ee2f35af7605e43",
      "commit_date": "2020-10-13T12:14:05Z",
      "author": {
        "login": "felixfontein",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "CVE-2020-25646: no_log=True missing for private key content options (#125)",
        "length": 245,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 16,
        "deletions": 7
      },
      "files": [
        {
          "filename": "changelogs/fragments/cve-2020-25646.yml",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+security_fixes:\n+- \"openssl_csr - the option ``privatekey_content`` was not marked as ``no_log``, resulting in it being dumped into the system log by default, and returned in the registered results in the ``invocation`` field (CVE-2020-25646, https://github.com/ansible-collections/community.crypto/pull/125).\"\n+- \"openssl_privatekey_info - the option ``content`` was not marked as ``no_log``, resulting in it being dumped into the system log by default, and returned in the registered results in the ``invocation`` field (CVE-2020-25646, https://github.com/ansible-collections/community.crypto/pull/125).\"\n+- \"openssl_publickey - the option ``privatekey_content`` was not marked as ``no_log``, resulting in it being dumped into the system log by default, and returned in the registered results in the ``invocation`` field (CVE-2020-25646, https://github.com/ansible-collections/community.crypto/pull/125).\"\n+- \"openssl_signature - the option ``privatekey_content`` was not marked as ``no_log``, resulting in it being dumped into the system log by default, and returned in the registered results in the ``invocation`` field (CVE-2020-25646, https://github.com/ansible-collections/community.crypto/pull/125).\"\n+- \"x509_certificate - the options ``privatekey_content`` and ``ownca_privatekey_content`` were not marked as ``no_log``, resulting in it being dumped into the system log by default, and returned in the registered results in the ``invocation`` field (CVE-2020-25646, https://github.com/ansible-collections/community.crypto/pull/125).\"\n+- \"x509_crl - the option ``privatekey_content`` was not marked as ``no_log``, resulting in it being dumped into the system log by default, and returned in the registered results in the ``invocation`` field (CVE-2020-25646, https://github.com/ansible-collections/community.crypto/pull/125).\""
        },
        {
          "filename": "plugins/modules/openssl_csr.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1163,7 +1163,7 @@ def main():\n             state=dict(type='str', default='present', choices=['absent', 'present']),\n             digest=dict(type='str', default='sha256'),\n             privatekey_path=dict(type='path'),\n-            privatekey_content=dict(type='str'),\n+            privatekey_content=dict(type='str', no_log=True),\n             privatekey_passphrase=dict(type='str', no_log=True),\n             version=dict(type='int', default=1),\n             force=dict(type='bool', default=False),"
        },
        {
          "filename": "plugins/modules/openssl_privatekey.py",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -152,6 +152,8 @@\n             - If set to C(yes), will return the (current or generated) private key's content as I(privatekey).\n             - Note that especially if the private key is not encrypted, you have to make sure that the returned\n               value is treated appropriately and not accidentally written to logs etc.! Use with care!\n+            - Use Ansible's I(no_log) task option to avoid the output being shown. See also\n+              U(https://docs.ansible.com/ansible/latest/reference_appendices/faq.html#how-do-i-keep-secret-data-in-my-playbook).\n         type: bool\n         default: no\n         version_added: '1.0.0'"
        },
        {
          "filename": "plugins/modules/openssl_privatekey_info.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -583,7 +583,7 @@ def main():\n     module = AnsibleModule(\n         argument_spec=dict(\n             path=dict(type='path'),\n-            content=dict(type='str'),\n+            content=dict(type='str', no_log=True),\n             passphrase=dict(type='str', no_log=True),\n             return_private_key_data=dict(type='bool', default=False),\n             select_crypto_backend=dict(type='str', default='auto', choices=['auto', 'cryptography', 'pyopenssl']),"
        },
        {
          "filename": "plugins/modules/openssl_publickey.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -395,7 +395,7 @@ def main():\n             force=dict(type='bool', default=False),\n             path=dict(type='path', required=True),\n             privatekey_path=dict(type='path'),\n-            privatekey_content=dict(type='str'),\n+            privatekey_content=dict(type='str', no_log=True),\n             format=dict(type='str', default='PEM', choices=['OpenSSH', 'PEM']),\n             privatekey_passphrase=dict(type='str', no_log=True),\n             backup=dict(type='bool', default=False),"
        },
        {
          "filename": "plugins/modules/openssl_signature.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -259,7 +259,7 @@ def main():\n     module = AnsibleModule(\n         argument_spec=dict(\n             privatekey_path=dict(type='path'),\n-            privatekey_content=dict(type='str'),\n+            privatekey_content=dict(type='str', no_log=True),\n             privatekey_passphrase=dict(type='str', no_log=True),\n             path=dict(type='path', required=True),\n             select_crypto_backend=dict(type='str', choices=['auto', 'pyopenssl', 'cryptography'], default='auto'),"
        },
        {
          "filename": "plugins/modules/x509_certificate.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2565,7 +2565,7 @@ def main():\n \n             # General properties of a certificate\n             privatekey_path=dict(type='path'),\n-            privatekey_content=dict(type='str'),\n+            privatekey_content=dict(type='str', no_log=True),\n             privatekey_passphrase=dict(type='str', no_log=True),\n \n             # provider: assertonly\n@@ -2609,7 +2609,7 @@ def main():\n             ownca_path=dict(type='path'),\n             ownca_content=dict(type='str'),\n             ownca_privatekey_path=dict(type='path'),\n-            ownca_privatekey_content=dict(type='str'),\n+            ownca_privatekey_content=dict(type='str', no_log=True),\n             ownca_privatekey_passphrase=dict(type='str', no_log=True),\n             ownca_digest=dict(type='str', default='sha256'),\n             ownca_version=dict(type='int', default=3),"
        },
        {
          "filename": "plugins/modules/x509_crl.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -754,7 +754,7 @@ def main():\n             path=dict(type='path', required=True),\n             format=dict(type='str', default='pem', choices=['pem', 'der']),\n             privatekey_path=dict(type='path'),\n-            privatekey_content=dict(type='str'),\n+            privatekey_content=dict(type='str', no_log=True),\n             privatekey_passphrase=dict(type='str', no_log=True),\n             issuer=dict(type='dict'),\n             last_update=dict(type='str', default='+0s'),"
        }
      ],
      "file_patterns": {
        "security_files": 3,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd67767538a63ca549cb469bed086e8dedad9ee9",
            "date": "2025-01-14T18:31:03Z",
            "author_login": "felixfontein"
          },
          {
            "sha": "ae35be3437605f60379b6bedfbe9ced2c08546fa",
            "date": "2025-01-13T20:43:29Z",
            "author_login": "felixfontein"
          },
          {
            "sha": "01e7bf1f3341e53d169599b1c1bd0ba8e720983d",
            "date": "2025-01-12T20:42:24Z",
            "author_login": "felixfontein"
          },
          {
            "sha": "49354f2121e8b294d73907e8da3796c9d868682d",
            "date": "2025-01-12T16:10:58Z",
            "author_login": "felixfontein"
          },
          {
            "sha": "072318466ec8850229b529beb2e1b37bfc9773d9",
            "date": "2025-01-12T12:59:08Z",
            "author_login": "felixfontein"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-117",
    "description": "A flaw was found in Ansible Collection community.crypto. openssl_privatekey_info exposes private key in logs. This directly impacts confidentiality",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-10-29T20:15:19.087",
    "last_modified": "2024-11-21T05:18:19.733",
    "fix_date": "2020-10-13T12:14:05Z"
  },
  "references": [
    {
      "url": "https://github.com/ansible-collections/community.crypto/commit/233d1afc296f6770e905a1785ee2f35af7605e43",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ansible-collections/community.crypto/commit/233d1afc296f6770e905a1785ee2f35af7605e43",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.440445",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "community.crypto",
    "owner": "ansible-collections",
    "created_at": "2020-02-27T12:28:58Z",
    "updated_at": "2025-01-14T18:31:07Z",
    "pushed_at": "2025-01-14T18:31:03Z",
    "size": 21811,
    "stars": 101,
    "forks": 90,
    "open_issues": 57,
    "watchers": 101,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 1517888,
      "Shell": 16917
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:14:37.328213"
  }
}