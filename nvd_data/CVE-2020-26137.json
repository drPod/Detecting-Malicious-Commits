{
  "cve_id": "CVE-2020-26137",
  "github_data": {
    "repository": "urllib3/urllib3",
    "fix_commit": "1dd69c5c5982fae7c87a620d487c2ebf7a6b436b",
    "related_commits": [
      "1dd69c5c5982fae7c87a620d487c2ebf7a6b436b",
      "1dd69c5c5982fae7c87a620d487c2ebf7a6b436b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1dd69c5c5982fae7c87a620d487c2ebf7a6b436b",
      "commit_date": "2020-02-17T21:34:48Z",
      "author": {
        "login": "sethmlarson",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Raise ValueError if method contains control characters (#1800)",
        "length": 62,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 27,
        "deletions": 0
      },
      "files": [
        {
          "filename": "CHANGES.rst",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -1,6 +1,13 @@\n Changes\n =======\n \n+master (dev)\n+------------\n+\n+* Raise ``ValueError`` if control characters are given in\n+  the ``method`` parameter of ``HTTPConnection.request()`` (Pull #1800)\n+\n+\n 1.25.8 (2020-01-20)\n -------------------\n "
        },
        {
          "filename": "src/urllib3/connection.py",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -1,4 +1,5 @@\n from __future__ import absolute_import\n+import re\n import datetime\n import logging\n import os\n@@ -58,6 +59,8 @@ class ConnectionError(Exception):\n # (ie test_recent_date is failing) update it to ~6 months before the current date.\n RECENT_DATE = datetime.date(2019, 1, 1)\n \n+_CONTAINS_CONTROL_CHAR_RE = re.compile(r\"[^-!#$%&'*+.^_`|~0-9a-zA-Z]\")\n+\n \n class DummyConnection(object):\n     \"\"\"Used to detect a failed ConnectionCls import.\"\"\"\n@@ -184,6 +187,17 @@ def connect(self):\n         conn = self._new_conn()\n         self._prepare_conn(conn)\n \n+    def putrequest(self, method, url, *args, **kwargs):\n+        \"\"\"Send a request to the server\"\"\"\n+        match = _CONTAINS_CONTROL_CHAR_RE.search(method)\n+        if match:\n+            raise ValueError(\n+                \"Method cannot contain non-token characters %r (found at least %r)\"\n+                % (method, match.group())\n+            )\n+\n+        return _HTTPConnection.putrequest(self, method, url, *args, **kwargs)\n+\n     def request_chunked(self, method, url, body=None, headers=None):\n         \"\"\"\n         Alternative to the common request method, which sends the"
        },
        {
          "filename": "test/with_dummyserver/test_connectionpool.py",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -677,6 +677,12 @@ def test_dns_error(self):\n             with pytest.raises(MaxRetryError):\n                 pool.request(\"GET\", \"/test\", retries=2)\n \n+    @pytest.mark.parametrize(\"char\", [\" \", \"\\r\", \"\\n\", \"\\x00\"])\n+    def test_invalid_method_not_allowed(self, char):\n+        with pytest.raises(ValueError):\n+            with HTTPConnectionPool(self.host, self.port) as pool:\n+                pool.request(\"GET\" + char, \"/\")\n+\n     def test_percent_encode_invalid_target_chars(self):\n         with HTTPConnectionPool(self.host, self.port) as pool:\n             r = pool.request(\"GET\", \"/echo_params?q=\\r&k=\\n \\n\")"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "37565dc3addfa92ac89b0a3ae7b0134e4f3d6c72",
            "date": "2025-01-17T16:02:57Z",
            "author_login": "illia-v"
          },
          {
            "sha": "bd8355c8c255d2e135c7ca01986a02bb76c578af",
            "date": "2025-01-17T16:02:47Z",
            "author_login": "illia-v"
          },
          {
            "sha": "d86e15d05a5c1b1d6152cecda98b894d3578cbde",
            "date": "2025-01-17T13:53:33Z",
            "author_login": "illia-v"
          },
          {
            "sha": "f5f876c985faa063c5ff40cb97f20fc021be6a98",
            "date": "2025-01-13T09:34:59Z",
            "author_login": "graingert"
          },
          {
            "sha": "c82d8e506abff905e366ea72ef62c65eed584b17",
            "date": "2025-01-10T10:32:20Z",
            "author_login": "s-t-e-v-e-n-k"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-74",
    "description": "urllib3 before 1.25.9 allows CRLF injection if the attacker controls the HTTP request method, as demonstrated by inserting CR and LF control characters in the first argument of putrequest(). NOTE: this is similar to CVE-2020-26116.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-09-30T18:15:26.773",
    "last_modified": "2024-11-21T05:19:19.680",
    "fix_date": "2020-02-17T21:34:48Z"
  },
  "references": [
    {
      "url": "https://bugs.python.org/issue39603",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/urllib3/urllib3/commit/1dd69c5c5982fae7c87a620d487c2ebf7a6b436b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/urllib3/urllib3/pull/1800",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/06/msg00015.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00012.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/4570-1/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.python.org/issue39603",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/urllib3/urllib3/commit/1dd69c5c5982fae7c87a620d487c2ebf7a6b436b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/urllib3/urllib3/pull/1800",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/06/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00012.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://usn.ubuntu.com/4570-1/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:06.159825",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "urllib3",
    "owner": "urllib3",
    "created_at": "2011-09-18T18:08:28Z",
    "updated_at": "2025-01-26T01:29:25Z",
    "pushed_at": "2025-01-20T04:56:39Z",
    "size": 7533,
    "stars": 3831,
    "forks": 1170,
    "open_issues": 135,
    "watchers": 3831,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.24-series",
      "1.25-series",
      "1.26.x",
      "2.0.x",
      "main",
      "misleading-error-truncated-response",
      "release",
      "sethmlarson-patch-1",
      "v2"
    ],
    "languages": {
      "Python": 1106696,
      "HTML": 8787,
      "JavaScript": 3655,
      "Shell": 183,
      "Gherkin": 66
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:51:15.959976"
  }
}