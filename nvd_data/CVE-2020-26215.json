{
  "cve_id": "CVE-2020-26215",
  "github_data": {
    "repository": "jupyter/notebook",
    "fix_commit": "3cec4bbe21756de9f0c4bccf18cf61d840314d74",
    "related_commits": [
      "3cec4bbe21756de9f0c4bccf18cf61d840314d74",
      "3cec4bbe21756de9f0c4bccf18cf61d840314d74"
    ],
    "patch_url": "https://github.com/jupyter/notebook/commit/3cec4bbe21756de9f0c4bccf18cf61d840314d74.patch",
    "fix_commit_details": {
      "sha": "3cec4bbe21756de9f0c4bccf18cf61d840314d74",
      "commit_date": "2020-11-06T12:50:59Z",
      "author": {
        "login": "minrk",
        "type": "User",
        "stats": {
          "total_commits": 2970,
          "average_weekly_commits": 3.3904109589041096,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 362
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-c7vm-f5p4-8fqh",
        "length": 74,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 41,
        "additions": 37,
        "deletions": 4
      },
      "files": [
        {
          "filename": "docs/source/changelog.rst",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -22,6 +22,15 @@ We strongly recommend that you upgrade pip to version 9+ of pip before upgrading\n     ``pip --version``.\n \n \n+.. _release-6.1.5:\n+\n+6.1.5\n+-----\n+\n+6.1.5 is a security release, fixing one vulnerability:\n+\n+- Fix open redirect vulnerability GHSA-c7vm-f5p4-8fqh (CVE to be assigned)\n+\n .. _release-6.1.4:\n \n 6.1.4"
        },
        {
          "filename": "notebook/base/handlers.py",
          "status": "modified",
          "additions": 10,
          "deletions": 4,
          "patch": "@@ -854,13 +854,18 @@ def get(self):\n \n class TrailingSlashHandler(web.RequestHandler):\n     \"\"\"Simple redirect handler that strips trailing slashes\n-    \n+\n     This should be the first, highest priority handler.\n     \"\"\"\n-    \n+\n     def get(self):\n-        self.redirect(self.request.uri.rstrip('/'))\n-    \n+        path, *rest = self.request.uri.partition(\"?\")\n+        # trim trailing *and* leading /\n+        # to avoid misinterpreting repeated '//'\n+        path = \"/\" + path.strip(\"/\")\n+        new_uri = \"\".join([path, *rest])\n+        self.redirect(new_uri)\n+\n     post = put = get\n \n \n@@ -911,6 +916,7 @@ def get(self):\n         url = sep.join([self._url, self.request.query])\n         self.redirect(url, permanent=self._permanent)\n \n+\n class PrometheusMetricsHandler(IPythonHandler):\n     \"\"\"\n     Return prometheus metrics for this notebook server"
        },
        {
          "filename": "notebook/tests/test_paths.py",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -3,10 +3,13 @@\n from nose.tools import assert_regex, assert_not_regex\n \n from notebook.base.handlers import path_regex\n+from notebook.utils import url_path_join\n+from .launchnotebook import NotebookTestBase\n \n # build regexps that tornado uses:\n path_pat = re.compile('^' + '/x%s' % path_regex + '$')\n \n+\n def test_path_regex():\n     for path in (\n         '/x',\n@@ -30,3 +33,18 @@ def test_path_regex_bad():\n         '/y/x/foo',\n     ):\n         assert_not_regex(path, path_pat)\n+\n+\n+class RedirectTestCase(NotebookTestBase):\n+    def test_trailing_slash(self):\n+        for uri, expected in (\n+            (\"/notebooks/mynotebook/\", \"/notebooks/mynotebook\"),\n+            (\"////foo///\", \"/foo\"),\n+            (\"//example.com/\", \"/example.com\"),\n+            (\"/has/param/?hasparam=true\", \"/has/param?hasparam=true\"),\n+        ):\n+            r = self.request(\"GET\", uri, allow_redirects=False)\n+            print(uri, expected)\n+            assert r.status_code == 302\n+            assert \"Location\" in r.headers\n+            assert r.headers[\"Location\"] == url_path_join(self.url_prefix, expected)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1f0ab8365b03589afb150874f97958bb0e6c7a04",
            "date": "2025-01-07T10:55:25Z",
            "author_login": "jtpio"
          },
          {
            "sha": "18672b7e85ec5181e4c5c18d2e32c3e9eab7260c",
            "date": "2025-01-07T10:44:59Z",
            "author_login": "jtpio"
          },
          {
            "sha": "e1cd13abfe393ace14c630abec10de8f5e490aaf",
            "date": "2025-01-07T09:42:11Z",
            "author_login": "jtpio"
          },
          {
            "sha": "99af31ec212aad9550b4ae38802633e127d08b2b",
            "date": "2025-01-07T09:33:13Z",
            "author_login": "jtpio"
          },
          {
            "sha": "4680e1a6753ab3f420fe7b31e2a62a96af14faa1",
            "date": "2024-12-23T08:37:52Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:L",
    "cwe_id": "CWE-601",
    "description": "Jupyter Notebook before version 6.1.5 has an Open redirect vulnerability. A maliciously crafted link to a notebook server could redirect the browser to a different website. All notebook servers are technically affected, however, these maliciously crafted links can only be reasonably made for known notebook server hosts. A link to your notebook server may appear safe, but ultimately redirect to a spoofed server on the public internet. The issue is patched in version 6.1.5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-11-18T22:15:11.947",
    "last_modified": "2024-11-21T05:19:32.947",
    "fix_date": "2020-11-06T12:50:59Z"
  },
  "references": [
    {
      "url": "https://github.com/jupyter/notebook/commit/3cec4bbe21756de9f0c4bccf18cf61d840314d74",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jupyter/notebook/security/advisories/GHSA-c7vm-f5p4-8fqh",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/12/msg00004.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jupyter/notebook/commit/3cec4bbe21756de9f0c4bccf18cf61d840314d74",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jupyter/notebook/security/advisories/GHSA-c7vm-f5p4-8fqh",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/12/msg00004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.466688",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "notebook",
    "owner": "jupyter",
    "created_at": "2015-04-09T06:58:03Z",
    "updated_at": "2025-01-13T19:48:54Z",
    "pushed_at": "2025-01-07T10:55:30Z",
    "size": 41178,
    "stars": 11913,
    "forks": 5065,
    "open_issues": 1962,
    "watchers": 11913,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "4.x",
      "4.0.x",
      "4.2.x",
      "5.2.1",
      "5.2.2",
      "5.4.x",
      "5.7.x",
      "6.x",
      "6.1.x",
      "6.4.x",
      "6.4",
      "6.5.x",
      "7.0.x",
      "7.1.x",
      "7.2.x",
      "7.3.x",
      "dependabot/github_actions/actions-bf4f1792d2",
      "dependabot/npm_and_yarn/nanoid-3.3.8",
      "main",
      "pre-commit-ci-update-config"
    ],
    "languages": {
      "Jupyter Notebook": 774643,
      "TypeScript": 181780,
      "Python": 23026,
      "JavaScript": 20679,
      "CSS": 17732,
      "HTML": 8408,
      "Shell": 83
    },
    "commit_activity": {
      "total_commits_last_year": 134,
      "avg_commits_per_week": 2.576923076923077,
      "days_active_last_year": 55
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:38:09.734114"
  }
}