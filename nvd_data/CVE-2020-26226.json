{
  "cve_id": "CVE-2020-26226",
  "github_data": {
    "repository": "semantic-release/semantic-release",
    "fix_commit": "ca90b34c4a9333438cc4d69faeb43362bb991e5a",
    "related_commits": [
      "ca90b34c4a9333438cc4d69faeb43362bb991e5a",
      "ca90b34c4a9333438cc4d69faeb43362bb991e5a"
    ],
    "patch_url": "https://github.com/semantic-release/semantic-release/commit/ca90b34c4a9333438cc4d69faeb43362bb991e5a.patch",
    "fix_commit_details": {
      "sha": "ca90b34c4a9333438cc4d69faeb43362bb991e5a",
      "commit_date": "2020-11-07T06:19:32Z",
      "author": {
        "login": "travi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: mask secrets when characters get uri encoded",
        "length": 49,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 14,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/hide-sensitive.js",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -11,7 +11,12 @@ module.exports = (env) => {\n     return /token|password|credential|secret|private/i.test(envVar) && size(env[envVar].trim()) >= SECRET_MIN_SIZE;\n   });\n \n-  const regexp = new RegExp(toReplace.map((envVar) => escapeRegExp(env[envVar])).join('|'), 'g');\n+  const regexp = new RegExp(\n+    toReplace\n+      .map((envVar) => `${escapeRegExp(env[envVar])}|${encodeURI(escapeRegExp(env[envVar]))}`)\n+      .join('|'),\n+    'g'\n+  );\n   return (output) =>\n     output && isString(output) && toReplace.length > 0 ? output.toString().replace(regexp, SECRET_REPLACEMENT) : output;\n };"
        },
        {
          "filename": "test/hide-sensitive.test.js",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -24,6 +24,14 @@ test('Replace sensitive environment variable matching specific regex for \"privat\n   t.is(hideSensitive(env)(`https://host.com?token=${env.privateKey}`), `https://host.com?token=${SECRET_REPLACEMENT}`);\n });\n \n+test('Replace url-encoded environment variable', (t) => {\n+  const env = {privateKey: 'secret '};\n+  t.is(\n+    hideSensitive(env)(`https://host.com?token=${encodeURI(env.privateKey)}`),\n+    `https://host.com?token=${SECRET_REPLACEMENT}`\n+  );\n+});\n+\n test('Escape regexp special characters', (t) => {\n   const env = {SOME_CREDENTIALS: 'p$^{.+}\\\\w[a-z]o.*rd'};\n   t.is("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "698a05be2a0da2482006e8e8d380f92ff12d07a1",
            "date": "2025-01-13T18:04:39Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "5c006d1f7b34cb1d943aa691ecd211da67182b3d",
            "date": "2025-01-13T01:40:05Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "e9467d1bfb507d6dfe7238f67272e700a38a6529",
            "date": "2025-01-13T00:29:20Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "9bac2016d5c9eb4d33981be0cfd9a51d5b28abb3",
            "date": "2025-01-11T18:24:53Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "81eec14f5dc22c566f65bb7ab89a999e871b5c73",
            "date": "2025-01-10T17:53:07Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-116",
    "description": "In the npm package semantic-release before version 17.2.3, secrets that would normally be masked by `semantic-release` can be accidentally disclosed if they contain characters that become encoded when included in a URL. Secrets that do not contain characters that become encoded when included in a URL are already masked properly. The issue is fixed in version 17.2.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-11-18T22:15:12.197",
    "last_modified": "2024-11-21T05:19:35.237",
    "fix_date": "2020-11-07T06:19:32Z"
  },
  "references": [
    {
      "url": "https://github.com/semantic-release/semantic-release/commit/ca90b34c4a9333438cc4d69faeb43362bb991e5a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/semantic-release/semantic-release/security/advisories/GHSA-r2j6-p67h-q639",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/semantic-release/semantic-release/commit/ca90b34c4a9333438cc4d69faeb43362bb991e5a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/semantic-release/semantic-release/security/advisories/GHSA-r2j6-p67h-q639",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.466845",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "semantic-release",
    "owner": "semantic-release",
    "created_at": "2014-09-15T16:18:28Z",
    "updated_at": "2025-01-14T10:56:31Z",
    "pushed_at": "2025-01-14T15:38:55Z",
    "size": 7166,
    "stars": 21240,
    "forks": 1686,
    "open_issues": 368,
    "watchers": 21240,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 388768
    },
    "commit_activity": {
      "total_commits_last_year": 234,
      "avg_commits_per_week": 4.5,
      "days_active_last_year": 150
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:13:54.685615"
  }
}