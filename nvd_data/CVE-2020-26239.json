{
  "cve_id": "CVE-2020-26239",
  "github_data": {
    "repository": "ScratchAddons/ScratchAddons",
    "fix_commit": "b9a52d6532c8514254c7cc1d8e18710dbedc41ff",
    "related_commits": [
      "b9a52d6532c8514254c7cc1d8e18710dbedc41ff",
      "b9a52d6532c8514254c7cc1d8e18710dbedc41ff"
    ],
    "patch_url": "https://github.com/ScratchAddons/ScratchAddons/commit/b9a52d6532c8514254c7cc1d8e18710dbedc41ff.patch",
    "fix_commit_details": {
      "sha": "b9a52d6532c8514254c7cc1d8e18710dbedc41ff",
      "commit_date": "2020-11-23T14:56:17Z",
      "author": {
        "login": "apple502j",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "SECURITY: Fix DOM XSS in More Links addon",
        "length": 41,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "addons/more-links/userscript.js",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -15,7 +15,10 @@ export default async function ({ addon, console }) {\n           let element = await addon.tab.waitForElement(\".project-description\", { markAsSeen: true });\n           // Need to convert #[numbers] to solve conflict between tags and external Scratch player links.\n           document.querySelectorAll(\".project-description a\").forEach((element) => {\n-            if (/\\d+/.test(element.textContent)) element.outerHTML = element.textContent;\n+              if (/^#\\d+$/.test(element.textContent) && element.previousSibling instanceof Text) {\n+                  element.previousSibling.textContent += element.textContent;\n+                  element.remove();\n+              }\n           });\n           element.normalize();\n           linkifyElement(element);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3162bbf51e53d0d09858eb813022a7a9ae6b85ef",
            "date": "2025-01-11T18:45:48Z",
            "author_login": "Samq64"
          },
          {
            "sha": "8300d6337f4cc25aac7ce8ce3aac20796407be35",
            "date": "2025-01-11T18:44:59Z",
            "author_login": "scratchaddons-bot[bot]"
          },
          {
            "sha": "a2a3dd5764df5f10bace29112c355a129307b828",
            "date": "2025-01-11T18:37:26Z",
            "author_login": "WorldLanguages"
          },
          {
            "sha": "1fc1912304e068a1bd00f6cb80fc75ea1018ba8b",
            "date": "2025-01-10T01:10:52Z",
            "author_login": "Samq64"
          },
          {
            "sha": "56b9054843baa3855b5f1648e983879a60d63212",
            "date": "2025-01-08T21:37:40Z",
            "author_login": "scratchaddons-bot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Scratch Addons is a WebExtension that supports both Chrome and Firefox. Scratch Addons before version 1.3.2 is vulnerable to DOM-based XSS. If the victim visited a specific website, the More Links addon of the Scratch Addons extension used incorrect regular expression which caused the HTML-escaped values to be unescaped, leading to XSS. Scratch Addons version 1.3.2 fixes the bug. The extension will be automatically updated by the browser. More Links addon can be disabled via the option of the extension.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-11-23T19:15:11.117",
    "last_modified": "2024-11-21T05:19:37.520",
    "fix_date": "2020-11-23T14:56:17Z"
  },
  "references": [
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/blob/a471893df403f86c9182970678175d4772a0690c/addons/more-links/userscript.js#L15",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/commit/b9a52d6532c8514254c7cc1d8e18710dbedc41ff",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/releases/tag/v1.3.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/security/advisories/GHSA-6qfq-px3r-xj4p",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/blob/a471893df403f86c9182970678175d4772a0690c/addons/more-links/userscript.js#L15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/commit/b9a52d6532c8514254c7cc1d8e18710dbedc41ff",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/releases/tag/v1.3.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ScratchAddons/ScratchAddons/security/advisories/GHSA-6qfq-px3r-xj4p",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.470423",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ScratchAddons",
    "owner": "ScratchAddons",
    "created_at": "2020-07-24T16:48:38Z",
    "updated_at": "2025-01-11T20:13:09Z",
    "pushed_at": "2025-01-14T00:57:49Z",
    "size": 20649,
    "stars": 730,
    "forks": 371,
    "open_issues": 1009,
    "watchers": 730,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "mv3"
    ],
    "languages": {
      "JavaScript": 1533923,
      "CSS": 440507,
      "HTML": 129883
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T19:23:49.169657"
  }
}