{
  "cve_id": "CVE-2020-26252",
  "github_data": {
    "repository": "OpenMage/magento-lts",
    "fix_commit": "0786aa48bc7b618cfe37b59f45e1da3714c533c3",
    "related_commits": [
      "0786aa48bc7b618cfe37b59f45e1da3714c533c3",
      "0786aa48bc7b618cfe37b59f45e1da3714c533c3"
    ],
    "patch_url": "https://github.com/OpenMage/magento-lts/commit/0786aa48bc7b618cfe37b59f45e1da3714c533c3.patch",
    "fix_commit_details": {
      "sha": "0786aa48bc7b618cfe37b59f45e1da3714c533c3",
      "commit_date": "2021-01-19T15:17:49Z",
      "author": {
        "login": "mark-netalico",
        "type": "User",
        "stats": {
          "total_commits": 16,
          "average_weekly_commits": 0.019138755980861243,
          "total_additions": 149,
          "total_deletions": 39,
          "weeks_active": 12
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-99m6-r53j-4hh2",
        "length": 81,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 28,
        "deletions": 0
      },
      "files": [
        {
          "filename": "app/code/core/Mage/Core/Model/Layout.php",
          "status": "modified",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -74,6 +74,14 @@ class Mage_Core_Model_Layout extends Varien_Simplexml_Config\n      */\n     protected $_directOutput = false;\n \n+    protected $invalidActions\n+        = [\n+            // explicitly not using class constant here Mage_Page_Block_Html_Topmenu_Renderer::class\n+            // if the class does not exists it breaks.\n+            ['block' => 'Mage_Page_Block_Html_Topmenu_Renderer', 'method' => 'render'],\n+            ['block' => 'Mage_Core_Block_Template', 'method' => 'fetchview'],\n+        ];\n+\n     /**\n      * Class constructor\n      *\n@@ -345,6 +353,8 @@ protected function _generateAction($node, $parent)\n                 }\n             }\n \n+            $this->validateAgainstBlacklist($block, $method, $args);\n+\n             $this->_translateLayoutNode($node, $args);\n             call_user_func_array(array($block, $method), array_values($args));\n         }\n@@ -354,6 +364,24 @@ protected function _generateAction($node, $parent)\n         return $this;\n     }\n \n+    /**\n+     * @param Mage_Core_Block_Abstract $block\n+     * @param string                   $method\n+     * @param string[]                 $args\n+     *\n+     * @throws Mage_Core_Exception\n+     */\n+    protected function validateAgainstBlacklist(Mage_Core_Block_Abstract $block, $method, array $args)\n+    {\n+        foreach ($this->invalidActions as $action) {\n+            if ($block instanceof $action['block'] && $action['method'] === strtolower($method)) {\n+                Mage::throwException(\n+                    sprintf('Action with combination block %s and method %s is forbidden.', get_class($block), $method)\n+                );\n+            }\n+        }\n+    }\n+\n     /**\n      * Translate layout node\n      *"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "87934ab2e2f1d01b7b6f261d093d81ce9fdc8b35",
            "date": "2025-01-14T07:25:10Z",
            "author_login": "sreichel"
          },
          {
            "sha": "1abb8363e23e435514b6508c5507953b3f54cbe6",
            "date": "2025-01-13T17:46:29Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "7d4622c9a9cd5c67af81592b58373bb13548f9e0",
            "date": "2025-01-13T16:32:52Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e727e755c32bd9507ce4517629416b1c002e19f3",
            "date": "2025-01-13T16:32:17Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "2a4ebc41f76b7ea11c2e2401bdad1b38a85bff1c",
            "date": "2025-01-11T17:40:49Z",
            "author_login": "sreichel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "OpenMage is a community-driven alternative to Magento CE. In OpenMage before versions 19.4.10 and 20.0.6, there is a vulnerability which enables remote code execution. In affected versions an administrator with permission to update product data to be able to store an executable file on the server and load it via layout xml. The latest OpenMage Versions up from 19.4.10 and 20.0.6 have this issue solved.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-20T22:15:11.000",
    "last_modified": "2024-11-21T05:19:39.980",
    "fix_date": "2021-01-19T15:17:49Z"
  },
  "references": [
    {
      "url": "https://github.com/OpenMage/magento-lts/commit/0786aa48bc7b618cfe37b59f45e1da3714c533c3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/security/advisories/GHSA-99m6-r53j-4hh2",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/commit/0786aa48bc7b618cfe37b59f45e1da3714c533c3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/security/advisories/GHSA-99m6-r53j-4hh2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.159684",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "magento-lts",
    "owner": "OpenMage",
    "created_at": "2014-10-17T14:23:00Z",
    "updated_at": "2025-01-14T07:25:14Z",
    "pushed_at": "2025-01-14T07:25:10Z",
    "size": 135363,
    "stars": 875,
    "forks": 436,
    "open_issues": 207,
    "watchers": 875,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "next",
      "v19"
    ],
    "languages": {
      "PHP": 26801624,
      "HTML": 4073323,
      "JavaScript": 957533,
      "CSS": 494354,
      "SCSS": 346314,
      "Shell": 15885,
      "Ruby": 288
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "osl-3.0"
    },
    "collected_at": "2025-01-14T14:10:18.125518"
  }
}