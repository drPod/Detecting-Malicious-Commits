{
  "cve_id": "CVE-2020-26256",
  "github_data": {
    "repository": "C2FO/fast-csv",
    "fix_commit": "4bbd39f26a8cd7382151ab4f5fb102234b2f829e",
    "related_commits": [
      "4bbd39f26a8cd7382151ab4f5fb102234b2f829e",
      "4bbd39f26a8cd7382151ab4f5fb102234b2f829e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "4bbd39f26a8cd7382151ab4f5fb102234b2f829e",
      "commit_date": "2020-12-03T15:33:00Z",
      "author": {
        "login": "doug-martin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: Simplify empty row check by removing complex regex",
        "length": 55,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 43,
        "additions": 40,
        "deletions": 3
      },
      "files": [
        {
          "filename": "packages/parse/__tests__/issues/issue540.spec.ts",
          "status": "added",
          "additions": 33,
          "deletions": 0,
          "patch": "@@ -0,0 +1,33 @@\n+import { EOL } from 'os';\n+import { parseString, RowMap, RowArray } from '../../src';\n+\n+describe('Issue #540 - https://github.com/C2FO/fast-csv/issues/540', () => {\n+    const CSV_CONTENT = [\n+        ' , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , -',\n+    ].join(EOL);\n+\n+    const expectedRows = [\n+        [\n+            ' , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,' +\n+                ' , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,' +\n+                ' , , , , , , , , , , , , , , -',\n+        ],\n+    ];\n+\n+    it('allow transforming to any object shape', () => {\n+        return new Promise((res, rej) => {\n+            const invalid: RowArray[] = [];\n+            const rows: RowMap[] = [];\n+            parseString(CSV_CONTENT, { ignoreEmpty: true, delimiter: '\\t' })\n+                .on('data-invalid', (row: RowArray) => invalid.push(row))\n+                .on('data', (r) => rows.push(r))\n+                .on('error', rej)\n+                .on('end', (count: number) => {\n+                    expect(rows).toEqual(expectedRows);\n+                    expect(invalid).toHaveLength(0);\n+                    expect(count).toBe(expectedRows.length + invalid.length);\n+                    res();\n+                });\n+        });\n+    });\n+});"
        },
        {
          "filename": "packages/parse/src/parser/Parser.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -4,8 +4,6 @@ import { ParserOptions } from '../ParserOptions';\n import { RowArray } from '../types';\n import { Token } from './Token';\n \n-const EMPTY_ROW_REGEXP = /^\\s*(?:''|\"\")?\\s*(?:,\\s*(?:''|\"\")?\\s*)*$/;\n-\n export interface ParseResult {\n     line: string;\n     rows: string[][];\n@@ -79,7 +77,7 @@ export class Parser {\n         if (row === null) {\n             return false;\n         }\n-        if (this.parserOptions.ignoreEmpty && EMPTY_ROW_REGEXP.test(row.join(''))) {\n+        if (this.parserOptions.ignoreEmpty && RowParser.isEmptyRow(row)) {\n             return true;\n         }\n         rows.push(row);"
        },
        {
          "filename": "packages/parse/src/parser/RowParser.ts",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -4,7 +4,13 @@ import { ParserOptions } from '../ParserOptions';\n import { RowArray } from '../types';\n import { MaybeToken, Token } from './Token';\n \n+const EMPTY_STRING = '';\n+\n export class RowParser {\n+    static isEmptyRow(row: RowArray): boolean {\n+        return row.join(EMPTY_STRING).replace(/\\s+/g, EMPTY_STRING) === EMPTY_STRING;\n+    }\n+\n     private readonly parserOptions: ParserOptions;\n \n     private readonly columnParser: ColumnParser;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5771f03db2848235bbbad5c6303b3448f45af4df",
            "date": "2025-01-24T01:25:14Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "c301b25b15d7e74c27952774cebf0f53405097e1",
            "date": "2025-01-23T12:25:11Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "dd31e20e408db5b4305fdadcb4d0d5c580083a10",
            "date": "2025-01-19T13:08:22Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "05e4394a44b3f39e76213cadc4d1be91a57fa79c",
            "date": "2025-01-16T16:48:22Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "0f6cd3e0e9e495abf0bf80b01a7d3fd275f9c06a",
            "date": "2025-01-15T14:04:50Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Fast-csv is an npm package for parsing and formatting CSVs or any other delimited value file in node. In fast-cvs before version 4.3.6 there is a possible ReDoS vulnerability (Regular Expression Denial of Service) when using ignoreEmpty option when parsing. This has been patched in `v4.3.6` You will only be affected by this if you use the `ignoreEmpty` parsing option. If you do use this option it is recommended that you upgrade to the latest version `v4.3.6` This vulnerability was found using a CodeQL query which identified `EMPTY_ROW_REGEXP` regular expression as vulnerable.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-12-08T22:15:17.540",
    "last_modified": "2024-11-21T05:19:40.500",
    "fix_date": "2020-12-03T15:33:00Z"
  },
  "references": [
    {
      "url": "https://github.com/C2FO/fast-csv/commit/4bbd39f26a8cd7382151ab4f5fb102234b2f829e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/C2FO/fast-csv/issues/540",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/C2FO/fast-csv/security/advisories/GHSA-8cv5-p934-3hwp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lgtm.com/query/8609731774537641779/",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/%40fast-csv/parse",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.npmjs.com/package/fast-csv",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/C2FO/fast-csv/commit/4bbd39f26a8cd7382151ab4f5fb102234b2f829e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/C2FO/fast-csv/issues/540",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/C2FO/fast-csv/security/advisories/GHSA-8cv5-p934-3hwp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lgtm.com/query/8609731774537641779/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/%40fast-csv/parse",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.npmjs.com/package/fast-csv",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.497796",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "fast-csv",
    "owner": "C2FO",
    "created_at": "2012-09-10T21:56:55Z",
    "updated_at": "2025-01-24T01:25:18Z",
    "pushed_at": "2025-01-24T21:48:43Z",
    "size": 6984,
    "stars": 1681,
    "forks": 214,
    "open_issues": 52,
    "watchers": 1681,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 346240,
      "JavaScript": 2757
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:25:25.446675"
  }
}