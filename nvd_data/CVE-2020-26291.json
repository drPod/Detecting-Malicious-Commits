{
  "cve_id": "CVE-2020-26291",
  "github_data": {
    "repository": "medialize/URI.js",
    "fix_commit": "b02bf037c99ac9316b77ff8bfd840e90becf1155",
    "related_commits": [
      "b02bf037c99ac9316b77ff8bfd840e90becf1155",
      "b02bf037c99ac9316b77ff8bfd840e90becf1155"
    ],
    "patch_url": "https://github.com/medialize/URI.js/commit/b02bf037c99ac9316b77ff8bfd840e90becf1155.patch",
    "fix_commit_details": {
      "sha": "b02bf037c99ac9316b77ff8bfd840e90becf1155",
      "commit_date": "2020-12-23T15:46:27Z",
      "author": {
        "login": "alesandroortiz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(parse): treat backslash as forwardslash in authority (#403)",
        "length": 195,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 58,
        "additions": 55,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/URI.js",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -612,19 +612,22 @@\n   };\n   URI.parseUserinfo = function(string, parts) {\n     // extract username:password\n+    var _string = string\n     var firstBackSlash = string.indexOf('\\\\');\n+    if (firstBackSlash !== -1) {\n+      string = string.replace(/\\\\/g, '/')\n+    }\n     var firstSlash = string.indexOf('/');\n-    var slash = firstBackSlash === -1 ? firstSlash : (firstSlash !== -1 ? Math.min(firstBackSlash, firstSlash): firstSlash)\n     var pos = string.lastIndexOf('@', firstSlash > -1 ? firstSlash : string.length - 1);\n     var t;\n \n     // authority@ must come before /path or \\path\n-    if (pos > -1 && (slash === -1 || pos < slash)) {\n+    if (pos > -1 && (firstSlash === -1 || pos < firstSlash)) {\n       t = string.substring(0, pos).split(':');\n       parts.username = t[0] ? URI.decode(t[0]) : null;\n       t.shift();\n       parts.password = t[0] ? URI.decode(t.join(':')) : null;\n-      string = string.substring(pos + 1);\n+      string = _string.substring(pos + 1);\n     } else {\n       parts.username = null;\n       parts.password = null;"
        },
        {
          "filename": "test/urls.js",
          "status": "modified",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -2033,6 +2033,55 @@ var urls = [{\n         idn: false,\n         punycode: false\n       }\n+    }, {\n+      name: 'backslashes authority, no ending slash',\n+      url: 'https://attacker.com\\\\@example.com',\n+      _url: 'https://attacker.com/@example.com',\n+      parts: {\n+        protocol: 'https',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/@example.com',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'https',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/@example.com',\n+        query: '',\n+        fragment: '',\n+        resource: '/@example.com',\n+        authority: 'attacker.com',\n+        origin: 'https://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '@example.com',\n+        suffix: 'com',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n     }\n ];\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28976cde5bb32a433ab78c4a32ef58f39d2cabf6",
            "date": "2022-04-03T09:31:17Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b655c1b972111ade9f181b02374305942e68e30a",
            "date": "2022-04-03T09:30:13Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
            "date": "2022-04-03T09:24:54Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
            "date": "2022-04-03T08:51:52Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "119e6abe4579f6a76b078586ec4d8fbce9da962c",
            "date": "2022-03-05T15:17:44Z",
            "author_login": "rodneyrehm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-20",
    "description": "URI.js is a javascript URL mutation library (npm package urijs). In URI.js before version 1.19.4, the hostname can be spoofed by using a backslash (`\\`) character followed by an at (`@`) character. If the hostname is used in security decisions, the decision may be incorrect. Depending on library usage and attacker intent, impacts may include allow/block list bypasses, SSRF attacks, open redirects, or other undesired behavior. For example the URL `https://expected-example.com\\@observed-example.com` will incorrectly return `observed-example.com` if using an affected version. Patched versions correctly return `expected-example.com`. Patched versions match the behavior of other parsers which implement the WHATWG URL specification, including web browsers and Node's built-in URL class. Version 1.19.4 is patched against all known payload variants. Version 1.19.3 has a partial patch but is still vulnerable to a payload variant.]",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-12-31T00:15:12.327",
    "last_modified": "2024-11-21T05:19:46.683",
    "fix_date": "2020-12-23T15:46:27Z"
  },
  "references": [
    {
      "url": "https://github.com/medialize/URI.js/commit/b02bf037c99ac9316b77ff8bfd840e90becf1155",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/releases/tag/v1.19.4",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/security/advisories/GHSA-3329-pjwv-fjpg",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/urijs",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/commit/b02bf037c99ac9316b77ff8bfd840e90becf1155",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/releases/tag/v1.19.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/security/advisories/GHSA-3329-pjwv-fjpg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/urijs",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:10.555228",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "URI.js",
    "owner": "medialize",
    "created_at": "2011-12-27T10:46:47Z",
    "updated_at": "2025-01-13T05:48:53Z",
    "pushed_at": "2023-08-27T10:51:22Z",
    "size": 3202,
    "stars": 6258,
    "forks": 476,
    "open_issues": 104,
    "watchers": 6258,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 377871,
      "HTML": 120393,
      "CSS": 9642,
      "PHP": 1226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:53:07.731779"
  }
}