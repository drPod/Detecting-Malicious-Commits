{
  "cve_id": "CVE-2020-26295",
  "github_data": {
    "repository": "OpenMage/magento-lts",
    "fix_commit": "9cf8c0aa1d1306051a18ace08d40279dadc1fb35",
    "related_commits": [
      "9cf8c0aa1d1306051a18ace08d40279dadc1fb35",
      "9cf8c0aa1d1306051a18ace08d40279dadc1fb35"
    ],
    "patch_url": "https://github.com/OpenMage/magento-lts/commit/9cf8c0aa1d1306051a18ace08d40279dadc1fb35.patch",
    "fix_commit_details": {
      "sha": "9cf8c0aa1d1306051a18ace08d40279dadc1fb35",
      "commit_date": "2021-01-19T15:32:06Z",
      "author": {
        "login": "mark-netalico",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-52c6-6v3v-f3fg",
        "length": 77,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 34,
        "additions": 33,
        "deletions": 1
      },
      "files": [
        {
          "filename": "app/code/core/Mage/Core/Block/Abstract.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -536,6 +536,7 @@ public function unsetCallChild($alias, $callback, $result, $params)\n                 $params = $args;\n             }\n \n+            Mage::helper('core/security')->validateAgainstBlockMethodBlacklist($child, $callback, $params);\n             if ($result == call_user_func_array(array(&$child, $callback), $params)) {\n                 $this->unsetChild($alias);\n             }"
        },
        {
          "filename": "app/code/core/Mage/Core/Helper/Security.php",
          "status": "added",
          "additions": 31,
          "deletions": 0,
          "patch": "@@ -0,0 +1,31 @@\n+<?php\n+\n+class Mage_Core_Helper_Security\n+{\n+\n+    private $invalidBlockActions\n+        = [\n+            // explicitly not using class constant here Mage_Page_Block_Html_Topmenu_Renderer::class\n+            // if the class does not exists it breaks.\n+            ['block' => Mage_Page_Block_Html_Topmenu_Renderer::class, 'method' => 'render'],\n+            ['block' => Mage_Core_Block_Template::class, 'method' => 'fetchView'],\n+        ];\n+\n+    /**\n+     * @param Mage_Core_Block_Abstract $block\n+     * @param string                   $method\n+     * @param string[]                 $args\n+     *\n+     * @throws Mage_Core_Exception\n+     */\n+    public function validateAgainstBlockMethodBlacklist(Mage_Core_Block_Abstract $block, $method, array $args)\n+    {\n+        foreach ($this->invalidBlockActions as $action) {\n+            if ($block instanceof $action['block'] && strtolower($action['method']) === strtolower($method)) {\n+                Mage::throwException(\n+                    sprintf('Action with combination block %s and method %s is forbidden.', get_class($block), $method)\n+                );\n+            }\n+        }\n+    }\n+}"
        },
        {
          "filename": "app/code/core/Mage/Core/Model/Layout.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -353,7 +353,7 @@ protected function _generateAction($node, $parent)\n                 }\n             }\n \n-            $this->validateAgainstBlacklist($block, $method, $args);\n+            Mage::helper('core/security')->validateAgainstBlockMethodBlacklist($block, $method, $args);\n \n             $this->_translateLayoutNode($node, $args);\n             call_user_func_array(array($block, $method), array_values($args));"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1dabe2dd07232f4e08a23de898d8b0f845df6a21",
            "date": "2025-01-14T16:39:56Z",
            "author_login": "allcontributors[bot]"
          },
          {
            "sha": "29ae988e30dcaf33b9348a9128710ad2ac6b68d6",
            "date": "2025-01-14T15:35:41Z",
            "author_login": "sreichel"
          },
          {
            "sha": "d1d63586e3d0de327858d4ce122481bb0ffe2b75",
            "date": "2025-01-14T15:35:08Z",
            "author_login": "sreichel"
          },
          {
            "sha": "360b6f546a561e53168880015f8c3c9a12242e4d",
            "date": "2025-01-14T15:34:10Z",
            "author_login": "sreichel"
          },
          {
            "sha": "4e2711135c6bba674a7ae14c8a063f2290580c16",
            "date": "2025-01-14T15:32:57Z",
            "author_login": "sreichel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "OpenMage is a community-driven alternative to Magento CE. In OpenMage before versions 19.4.10 and 20.0.5, an administrator with permission to import/export data and to edit cms pages was able to inject an executable file on the server via layout xml. The latest OpenMage Versions up from 19.4.9 and 20.0.5 have this Issue solved",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-21T14:15:12.817",
    "last_modified": "2024-11-21T05:19:47.370",
    "fix_date": "2021-01-19T15:32:06Z"
  },
  "references": [
    {
      "url": "https://github.com/OpenMage/magento-lts/commit/9cf8c0aa1d1306051a18ace08d40279dadc1fb35",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/releases/tag/v19.4.10",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/security/advisories/GHSA-52c6-6v3v-f3fg",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/commit/9cf8c0aa1d1306051a18ace08d40279dadc1fb35",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/releases/tag/v19.4.10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenMage/magento-lts/security/advisories/GHSA-52c6-6v3v-f3fg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.160321",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "magento-lts",
    "owner": "OpenMage",
    "created_at": "2014-10-17T14:23:00Z",
    "updated_at": "2025-01-14T07:25:14Z",
    "pushed_at": "2025-01-14T07:25:10Z",
    "size": 135363,
    "stars": 875,
    "forks": 436,
    "open_issues": 207,
    "watchers": 875,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "next",
      "v19"
    ],
    "languages": {
      "PHP": 26801624,
      "HTML": 4073323,
      "JavaScript": 957533,
      "CSS": 494354,
      "SCSS": 346314,
      "Shell": 15885,
      "Ruby": 288
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "osl-3.0"
    },
    "collected_at": "2025-01-14T14:10:18.125518"
  }
}