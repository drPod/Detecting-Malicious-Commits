{
  "cve_id": "CVE-2020-26297",
  "github_data": {
    "repository": "rust-lang/mdBook",
    "fix_commit": "32abeef088e98327ca0dfccdad92e84afa9d2e9b",
    "related_commits": [
      "32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "32abeef088e98327ca0dfccdad92e84afa9d2e9b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "commit_date": "2020-12-30T21:13:15Z",
      "author": {
        "login": "pietroalbini",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix xss in the search page",
        "length": 131,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/theme/searcher/searcher.js",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -145,6 +145,11 @@ window.search = window.search || {};\n             url.push(\"\");\n         }\n \n+        // encodeURIComponent escapes all chars that could allow an XSS except\n+        // for '. Due to that we also manually replace ' with its url-encoded\n+        // representation (%27).\n+        var searchterms = encodeURIComponent(searchterms.join(\" \")).replace(/\\'/g, \"%27\");\n+\n         return '<a href=\"' + path_to_root + url[0] + '?' + URL_MARK_PARAM + '=' + searchterms + '#' + url[1]\n             + '\" aria-details=\"teaser_' + teaser_count + '\">' + result.doc.breadcrumbs + '</a>'\n             + '<span class=\"teaser\" id=\"teaser_' + teaser_count + '\" aria-label=\"Search Result Teaser\">' "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dff5ac64e59c9c8df7327eba22561770fd65e958",
            "date": "2025-01-25T21:54:30Z",
            "author_login": "ehuss"
          },
          {
            "sha": "0ee565a5ffb541f12c55e181e23a5beff6b04df3",
            "date": "2025-01-25T21:50:47Z",
            "author_login": "ehuss"
          },
          {
            "sha": "9e4854f3490976fa29393307905c2eb2e4c6dce2",
            "date": "2025-01-25T21:17:31Z",
            "author_login": "ehuss"
          },
          {
            "sha": "74d48f5ad20568c610156c3b399375bdd22dc6ce",
            "date": "2025-01-23T17:15:25Z",
            "author_login": "notriddle"
          },
          {
            "sha": "0b51a74c16f172f452bc5563c8b50931d167cde1",
            "date": "2025-01-23T14:33:22Z",
            "author_login": "ehuss"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "mdBook is a utility to create modern online books from Markdown files and is written in Rust. In mdBook before version 0.4.5, there is a vulnerability affecting the search feature of mdBook, which could allow an attacker to execute arbitrary JavaScript code on the page. The search feature of mdBook (introduced in version 0.1.4) was affected by a cross site scripting vulnerability that allowed an attacker to execute arbitrary JavaScript code on an user's browser by tricking the user into typing a malicious search query, or tricking the user into clicking a link to the search page with the malicious search query prefilled. mdBook 0.4.5 fixes the vulnerability by properly escaping the search query. Owners of websites built with mdBook have to upgrade to mdBook 0.4.5 or greater and rebuild their website contents with it.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-04T19:15:15.173",
    "last_modified": "2024-11-21T05:19:47.737",
    "fix_date": "2020-12-30T21:13:15Z"
  },
  "references": [
    {
      "url": "https://crates.io/crates/mdbook",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rust-lang/mdBook/blob/master/CHANGELOG.md#mdbook-045",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rust-lang/mdBook/commit/32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rust-lang/mdBook/security/advisories/GHSA-gx5w-rrhp-f436",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://groups.google.com/g/rustlang-security-announcements/c/3-sO6of29O0",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://crates.io/crates/mdbook",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rust-lang/mdBook/blob/master/CHANGELOG.md#mdbook-045",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rust-lang/mdBook/commit/32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rust-lang/mdBook/security/advisories/GHSA-gx5w-rrhp-f436",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://groups.google.com/g/rustlang-security-announcements/c/3-sO6of29O0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:10.563407",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mdBook",
    "owner": "rust-lang",
    "created_at": "2015-07-07T00:57:25Z",
    "updated_at": "2025-01-26T07:56:19Z",
    "pushed_at": "2025-01-25T22:01:03Z",
    "size": 5846,
    "stars": 18852,
    "forks": 1678,
    "open_issues": 593,
    "watchers": 18852,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Rust": 434236,
      "JavaScript": 44512,
      "CSS": 36503,
      "Handlebars": 20095,
      "Shell": 2669
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mpl-2.0"
    },
    "collected_at": "2025-01-26T08:11:12.730861"
  }
}