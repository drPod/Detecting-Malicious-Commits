{
  "cve_id": "CVE-2020-27409",
  "github_data": {
    "repository": "OS4ED/openSIS-Responsive-Design",
    "fix_commit": "edca0855e7bc27d5b28dcb2d16f057ada865e282",
    "related_commits": [
      "edca0855e7bc27d5b28dcb2d16f057ada865e282",
      "edca0855e7bc27d5b28dcb2d16f057ada865e282"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "edca0855e7bc27d5b28dcb2d16f057ada865e282",
      "commit_date": "2020-08-05T03:01:48Z",
      "author": {
        "login": "openSISAdmin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Vulnerability fix",
        "length": 36,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 335,
        "additions": 328,
        "deletions": 7
      },
      "files": [
        {
          "filename": "AuthCryp.php",
          "status": "added",
          "additions": 316,
          "deletions": 0,
          "patch": "@@ -0,0 +1,316 @@\n+<?php\n+\n+\n+#**************************************************************************\n+#  openSIS is a free student information system for public and non-public \n+#  schools from Open Solutions for Education, Inc. web: www.os4ed.com\n+#\n+#  openSIS is  web-based, open source, and comes packed with features that \n+#  include student demographic info, scheduling, grade book, attendance, \n+#  report cards, eligibility, transcripts, parent portal, \n+#  student portal and more.   \n+#\n+#  Visit the openSIS web site at http://www.opensis.com to learn more.\n+#  If you have question regarding this system or the license, please send \n+#  an email to info@os4ed.com.\n+#\n+#  This program is released under the terms of the GNU General Public License as  \n+#  published by the Free Software Foundation, version 2 of the License. \n+#  See license.txt.\n+#\n+#  This program is distributed in the hope that it will be useful,\n+#  but WITHOUT ANY WARRANTY; without even the implied warranty of\n+#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+#  GNU General Public License for more details.\n+#\n+#  You should have received a copy of the GNU General Public License\n+#  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+#\n+#***************************************************************************************\n+\n+$requested = $_REQUEST;\n+\n+if(isset($_REQUEST['calling']))\n+{\n+\tif(function_exists($_REQUEST['calling']))\n+\t{\n+\t\t// $requested_params = $_REQUEST['telling'];\n+\t\t// $return_params = array();\n+\n+\t\t// foreach($requested_params as $one_param_key => $one_param_val)\n+\t\t// {\n+\t\t// \t$encoded_string = $_REQUEST['calling']($one_param_val, $_REQUEST['motive'], $_REQUEST['jsc']);\n+\n+\t\t// \t$repack = array(\n+\t\t// \t\t$one_param_key => $encoded_string\n+\t\t// \t);\n+\n+\t\t// \t// $return_params[$one_param_key] = $encoded_string;\n+\t\t// \t// echo $encoded_string.'<br/>';\n+\t\t// \tarray_push($return_params, $repack);\n+\t\t// }\n+\n+\t\t$encoded_string = $_REQUEST['calling']($_REQUEST['telling'], $_REQUEST['motive'], $_REQUEST['jsc']);\n+\t}\n+}\n+\n+function dataCreator($char = '', $type = '')\n+{\n+\tif($char != '')\n+\t{\n+\t\t$permitted_chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n+\n+\t\t$strip_one = substr(str_shuffle($permitted_chars), 0, 1);\n+\t\t$strip_two = substr(str_shuffle($permitted_chars), 0, 2);\n+\n+\t\t$encryp_array = array(\n+\t\t\t// UPPER CASE LETTERS\n+\t\t\t\"A\"\t=>\t\"v\",\n+\t\t\t\"B\"\t=>\t\"l\",\n+\t\t\t\"C\"\t=>\t\"x\",\n+\t\t\t\"D\"\t=>\t\"m\",\n+\t\t\t\"E\"\t=>\t\"w\",\n+\t\t\t\"F\"\t=>\t\"q\",\n+\t\t\t\"G\"\t=>\t\"p\",\n+\t\t\t\"H\"\t=>\t\"a\",\n+\t\t\t\"I\"\t=>\t\"r\",\n+\t\t\t\"J\"\t=>\t\"y\",\n+\t\t\t\"K\"\t=>\t\"b\",\n+\t\t\t\"L\"\t=>\t\"u\",\n+\t\t\t\"M\"\t=>\t\"z\",\n+\t\t\t\"N\"\t=>\t\"c\",\n+\t\t\t\"O\"\t=>\t\"k\",\n+\t\t\t\"P\"\t=>\t\"e\",\n+\t\t\t\"Q\"\t=>\t\"t\",\n+\t\t\t\"R\"\t=>\t\"i\",\n+\t\t\t\"S\"\t=>\t\"d\",\n+\t\t\t\"T\"\t=>\t\"g\",\n+\t\t\t\"U\"\t=>\t\"n\",\n+\t\t\t\"V\"\t=>\t\"o\",\n+\t\t\t\"W\"\t=>\t\"h\",\n+\t\t\t\"X\"\t=>\t\"f\",\n+\t\t\t\"Y\"\t=>\t\"j\",\n+\t\t\t\"Z\"\t=>\t\"s\",\n+\t\t\t// LOWER CASE LETTERS\n+\t\t\t\"a\"\t=>\t\"M\",\n+\t\t\t\"b\"\t=>\t\"K\",\n+\t\t\t\"c\"\t=>\t\"T\",\n+\t\t\t\"d\"\t=>\t\"Q\",\n+\t\t\t\"e\"\t=>\t\"S\",\n+\t\t\t\"f\"\t=>\t\"I\",\n+\t\t\t\"g\"\t=>\t\"N\",\n+\t\t\t\"h\"\t=>\t\"P\",\n+\t\t\t\"i\"\t=>\t\"L\",\n+\t\t\t\"j\"\t=>\t\"B\",\n+\t\t\t\"k\"\t=>\t\"G\",\n+\t\t\t\"l\"\t=>\t\"X\",\n+\t\t\t\"m\"\t=>\t\"D\",\n+\t\t\t\"n\"\t=>\t\"Z\",\n+\t\t\t\"o\"\t=>\t\"W\",\n+\t\t\t\"p\"\t=>\t\"J\",\n+\t\t\t\"q\"\t=>\t\"Z\",\n+\t\t\t\"r\"\t=>\t\"A\",\n+\t\t\t\"s\"\t=>\t\"U\",\n+\t\t\t\"t\"\t=>\t\"E\",\n+\t\t\t\"u\"\t=>\t\"Y\",\n+\t\t\t\"v\"\t=>\t\"C\",\n+\t\t\t\"w\"\t=>\t\"H\",\n+\t\t\t\"x\"\t=>\t\"F\",\n+\t\t\t\"y\"\t=>\t\"R\",\n+\t\t\t\"z\"\t=>\t\"O\",\n+\t\t\t// NUMERICS\n+\t\t\t\"0\"\t=>\t\"6\",\n+\t\t\t\"1\"\t=>\t\"4\",\n+\t\t\t\"2\"\t=>\t\"7\",\n+\t\t\t\"3\"\t=>\t\"8\",\n+\t\t\t\"4\"\t=>\t\"2\",\n+\t\t\t\"5\"\t=>\t\"9\",\n+\t\t\t\"6\"\t=>\t\"3\",\n+\t\t\t\"7\"\t=>\t\"0\",\n+\t\t\t\"8\"\t=>\t\"1\",\n+\t\t\t\"9\"\t=>\t\"5\"\n+\t\t);\n+\n+\t\t$decryp_array_caps = array(\n+\t\t\t// UPPER CASE LETTERS\n+\t\t\t\"M\" => \"a\",\n+\t\t\t\"K\" => \"b\",\n+\t\t\t\"T\" => \"c\",\n+\t\t\t\"Q\" => \"d\",\n+\t\t\t\"S\" => \"e\",\n+\t\t\t\"I\" => \"f\",\n+\t\t\t\"N\" => \"g\",\n+\t\t\t\"P\" => \"h\",\n+\t\t\t\"L\" => \"i\",\n+\t\t\t\"B\" => \"j\",\n+\t\t\t\"G\" => \"k\",\n+\t\t\t\"X\" => \"l\",\n+\t\t\t\"D\" => \"m\",\n+\t\t\t\"Z\" => \"n\",\n+\t\t\t\"W\" => \"o\",\n+\t\t\t\"J\" => \"p\",\n+\t\t\t\"Z\" => \"q\",\n+\t\t\t\"A\" => \"r\",\n+\t\t\t\"U\" => \"s\",\n+\t\t\t\"E\" => \"t\",\n+\t\t\t\"Y\" => \"u\",\n+\t\t\t\"C\" => \"v\",\n+\t\t\t\"H\" => \"w\",\n+\t\t\t\"F\" => \"x\",\n+\t\t\t\"R\" => \"y\",\n+\t\t\t\"O\" => \"z\"\n+\t\t);\n+\n+\t\t$decryp_array_small = array(\n+\t\t\t// LOWER CASE LETTERS\n+\t\t\t\"v\" => \"A\",\n+\t\t\t\"l\" => \"B\",\n+\t\t\t\"x\" => \"C\",\n+\t\t\t\"m\" => \"D\",\n+\t\t\t\"w\" => \"E\",\n+\t\t\t\"q\" => \"F\",\n+\t\t\t\"p\" => \"G\",\n+\t\t\t\"a\" => \"H\",\n+\t\t\t\"r\" => \"I\",\n+\t\t\t\"y\" => \"J\",\n+\t\t\t\"b\" => \"K\",\n+\t\t\t\"u\" => \"L\",\n+\t\t\t\"z\" => \"M\",\n+\t\t\t\"c\" => \"N\",\n+\t\t\t\"k\" => \"O\",\n+\t\t\t\"e\" => \"P\",\n+\t\t\t\"t\" => \"Q\",\n+\t\t\t\"i\" => \"R\",\n+\t\t\t\"d\" => \"S\",\n+\t\t\t\"g\" => \"T\",\n+\t\t\t\"n\" => \"U\",\n+\t\t\t\"o\" => \"V\",\n+\t\t\t\"h\" => \"W\",\n+\t\t\t\"f\" => \"X\",\n+\t\t\t\"j\" => \"Y\",\n+\t\t\t\"s\" => \"Z\"\n+\t\t);\n+\n+\t\t$decryp_array_numbers = array(\n+\t\t\t// NUMERICS\n+\t\t\t\"6\" => \"0\",\n+\t\t\t\"4\" => \"1\",\n+\t\t\t\"7\" => \"2\",\n+\t\t\t\"8\" => \"3\",\n+\t\t\t\"2\" => \"4\",\n+\t\t\t\"9\" => \"5\",\n+\t\t\t\"3\" => \"6\",\n+\t\t\t\"0\" => \"7\",\n+\t\t\t\"1\" => \"8\",\n+\t\t\t\"5\" => \"9\"\n+\t\t);\n+\n+\t\tif($type == 'ENC')\n+\t\t{\n+\t\t\tif(in_array($char, $encryp_array))\n+\t\t\t{\n+\t\t\t\treturn $strip_one.$encryp_array[$char].$strip_two;\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\treturn $strip_one.$char.$strip_two;\n+\t\t\t}\n+\t\t}\n+\n+\t\tif($type == 'DEC')\n+\t\t{\n+\t\t\tif(in_array($char, $decryp_array_caps))\n+\t\t\t{\n+\t\t\t\t// echo '# '.$char.'<br/>';\n+\t\t\t\treturn $decryp_array_small[$char];\n+\t\t\t}\n+\t\t\telseif(in_array($char, $decryp_array_small))\n+\t\t\t{\n+\t\t\t\t// echo '$ '.$char.'<br/>';\n+\t\t\t\treturn $decryp_array_caps[$char];\n+\t\t\t}\n+\t\t\telseif(in_array($char, $decryp_array_numbers))\n+\t\t\t{\n+\t\t\t\t// echo '% '.$char.'<br/>';\n+\t\t\t\treturn $decryp_array_numbers[$char];\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\treturn $char;\n+\t\t\t}\n+\t\t}\n+\t}\n+\telse\n+\t{\n+\t\treturn '*';\n+\t}\n+}\n+\n+function cryptor($word = '', $type = '', $call = '')\n+{\n+\tif($word != '')\n+\t{\n+\t\tif($type == 'ENC')\n+\t\t{\n+\t\t\t$arrayfy = str_split($word);\n+\n+\t\t\t$return_word = '';\n+\n+\t\t\tforeach($arrayfy as $each_letter)\n+\t\t\t{\n+\t\t\t\t$return_word .= dataCreator($each_letter, $type);\n+\t\t\t}\n+\t\t}\n+\n+\t\tif($type == 'DEC')\n+\t\t{\n+\t\t\t$req_word = trim($word);\n+\n+\t\t\t$req_word_len = strlen($req_word);\n+\n+\t\t\tif(($req_word_len % 4) == 0)\n+\t\t\t{\n+\t\t\t\t$req_segment = ($req_word_len / 4);\n+\n+\t\t\t\t$decode_array = array();\n+\n+\t\t\t\tfor($fx = 0; $fx < $req_segment; $fx++)\n+\t\t\t    {\n+\t\t\t    \tarray_push($decode_array, substr($word, ($fx * 4), 4));\n+\t\t\t    }\n+\n+\t\t\t    $return_word = '';\n+\n+\t\t\t\tforeach($decode_array as $one_segment)\n+\t\t\t\t{\n+\t\t\t\t\t$each_letter = '';\n+\n+\t\t\t\t\t$arrayfy = str_split($one_segment);\n+\n+\t\t\t\t\t$each_letter = $arrayfy[1];\n+\n+\t\t\t\t\t$return_word .= dataCreator($each_letter, $type);\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\t$return_word = '';\n+\t\t\t}\n+\t\t}\n+\n+\t\tif($call == '1')\n+\t\t{\n+\t\t\techo $return_word;\n+\t\t}\n+\t\telse\n+\t\t{\n+\t\t\treturn $return_word;\n+\t\t}\n+\t}\n+\telse\n+\t{\n+\t\treturn false;\n+\t}\n+}\n+\n+?>\n\\ No newline at end of file"
        },
        {
          "filename": "ResetUserInfo.php",
          "status": "modified",
          "additions": 10,
          "deletions": 5,
          "patch": "@@ -31,6 +31,7 @@\n include(\"Data.php\");\n include(\"functions/DbGetFnc.php\");\n require_once(\"functions/PragRepFnc.php\");\n+include(\"AuthCryp.php\");\n \n function db_start() {\n     global $DatabaseServer, $DatabaseUsername, $DatabasePassword, $DatabaseName, $DatabasePort, $DatabaseType;\n@@ -246,6 +247,7 @@ function db_show_error($sql, $failnote, $additional = '') {\n     die();\n }\n \n+\n $log_msg = DBGet(DBQuery(\"SELECT MESSAGE FROM login_message WHERE DISPLAY='Y'\"));\n if ($_REQUEST['pass_type_form'] == 'password') {\n     if ($_REQUEST['pass_user_type'] == 'pass_student') {\n@@ -401,12 +403,15 @@ function db_show_error($sql, $failnote, $additional = '') {\n if ($_REQUEST['new_pass'] != '' && $_REQUEST['ver_pass'] != '') {\n     $get_vals = explode(\",\", $_REQUEST['user_info']);\n     $flag = 'submited_value';\n+    \n+    $get_vals[0] = cryptor($get_vals[0], 'DEC', '');\n+    $get_vals[1] = cryptor($get_vals[1], 'DEC', '');\n \n-    $get_info = DBGet(DBQuery('SELECT COUNT(*) AS EX_REC FROM login_authentication WHERE user_id!=' . $get_vals[0] . ' AND profile_id!=' . $get_vals[1] . ' AND password=\\'' . md5($_REQUEST['ver_pass']) . '\\' '));\n+    $get_info = DBGet(DBQuery('SELECT COUNT(*) AS EX_REC FROM login_authentication WHERE user_id!=\\'' . $get_vals[0] . '\\' AND profile_id!=\\'' . $get_vals[1] . '\\' AND password=\\'' . md5($_REQUEST['ver_pass']) . '\\' '));\n     if ($get_info[1]['EX_REC'] > 0) {\n         $_SESSION['err_msg_mod'] = '<font color=\"red\" ><b>Incorrect login credential.</b></font>';\n     } else {\n-        DBQuery('UPDATE login_authentication SET password=\\'' . md5($_REQUEST['ver_pass']) . '\\' WHERE user_id=' . $get_vals[0] . ' AND profile_id=' . $get_vals[1] . ' ');\n+        DBQuery('UPDATE login_authentication SET password=\\'' . md5($_REQUEST['ver_pass']) . '\\' WHERE user_id=\\'' . $get_vals[0] . '\\' AND profile_id=\\'' . $get_vals[1] . '\\' ');\n         $_SESSION['conf_msg'] = '<font color=\"red\" ><b>Password updated successfully.</b></font>';\n         echo'<script>window.location.href=\"index.php\"</script>';\n     }\n@@ -495,17 +500,17 @@ function init(param, param2) {\n                         <form name=\"f1\" method=\"post\" class=\"text-left\" action=\"\">\n \n                             <?php if ($flag == 'stu_pass') { ?>\n-                                <input type=\"hidden\" name=\"user_info\" value=\"<?php echo $stu_info[1]['STUDENT_ID'] . ',3,' . $_REQUEST['uname']; ?>\"/>\n+                                <input type=\"hidden\" name=\"user_info\" value=\"<?php echo cryptor($stu_info[1]['STUDENT_ID'], 'ENC', '') . ',' . cryptor('3', 'ENC', '') . ',' . $_REQUEST['uname']; ?>\"/>\n                                 <?php\n                             }\n                             if ($flag == 'stf_pass') {\n                                 ?>\n-                                <input type=\"hidden\" name=\"user_info\" value=\"<?php echo $stf_info[1]['STAFF_ID'] . ',' . $stf_info[1]['PROFILE_ID'] . ',' . $_REQUEST['uname']; ?>\"/>\n+                                <input type=\"hidden\" name=\"user_info\" value=\"<?php echo cryptor($stf_info[1]['STAFF_ID'], 'ENC', '') . ',' . cryptor($stf_info[1]['PROFILE_ID'], 'ENC', '') . ',' . $_REQUEST['uname']; ?>\"/>\n                                 <?php\n                             }\n                             if ($flag == 'par_pass') {\n                                 ?>\n-                                <input type=\"hidden\" name=\"user_info\" value=\"<?php echo $par_info[1]['STAFF_ID'] . ',' . $par_info[1]['PROFILE_ID'] . ',' . $_REQUEST['uname']; ?>\"/>\n+                                <input type=\"hidden\" name=\"user_info\" value=\"<?php echo cryptor($par_info[1]['STAFF_ID'], 'ENC', '') . ',' . cryptor($par_info[1]['PROFILE_ID'], 'ENC', '') . ',' . $_REQUEST['uname']; ?>\"/>\n                                 <?php\n                             }\n                             if ($flag == 'submited_value') {"
        },
        {
          "filename": "SideForStudent.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -30,7 +30,7 @@\n unset($_SESSION['students_order']);\n unset($_SESSION['_REQUEST_vars']);\n unset($_SESSION['_REQUEST_vars']);\n-echo \"<script>window.location.href='Modules.php?modname=\".strip_tags(trim($_REQUEST['modname'])).\"&ajax=true';</script>\";\n+echo \"<script>window.location.href='Modules.php?modname=\".strip_tags(urlencode(trim($_REQUEST['modname']))).\"&ajax=true';</script>\";\n \n \n-?>\n\\ No newline at end of file\n+?>"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4a5ccdc050e13d8f3d97b9d776c129228c74ab10",
            "date": "2024-02-06T12:31:51Z",
            "author_login": "sayan-os4ed"
          },
          {
            "sha": "b28124728b16279ebfdfc3262a6d9633a7bce2fa",
            "date": "2024-02-06T12:30:43Z",
            "author_login": "sayan-os4ed"
          },
          {
            "sha": "87c2d326055597284011ea10f2491e91050d4a45",
            "date": "2024-02-03T17:27:01Z",
            "author_login": "discapacidad5"
          },
          {
            "sha": "5333adc4e84516b810d48ae5b3e519ec0857ac87",
            "date": "2024-02-03T17:19:43Z",
            "author_login": "discapacidad5"
          },
          {
            "sha": "53407797404f05612b774e233bec52951986013b",
            "date": "2023-12-23T17:23:16Z",
            "author_login": "openSISAdmin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "OpenSIS Community Edition before 7.5 is affected by a cross-site scripting (XSS) vulnerability in SideForStudent.php via the modname parameter.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-12-04T16:15:11.047",
    "last_modified": "2024-11-21T05:21:11.400",
    "fix_date": "2020-08-05T03:01:48Z"
  },
  "references": [
    {
      "url": "https://github.com/OS4ED/openSIS-Responsive-Design/commit/edca0855e7bc27d5b28dcb2d16f057ada865e282#diff-5f88e2ce4cd96451df7580911120b4b2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OS4ED/openSIS-Responsive-Design/compare/ver7.4...V7.5",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://insinuator.net/2020/10/opensis-vulnerabilities/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OS4ED/openSIS-Responsive-Design/commit/edca0855e7bc27d5b28dcb2d16f057ada865e282#diff-5f88e2ce4cd96451df7580911120b4b2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OS4ED/openSIS-Responsive-Design/compare/ver7.4...V7.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://insinuator.net/2020/10/opensis-vulnerabilities/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.492648",
    "processing_status": "enhanced"
  }
}