{
  "cve_id": "CVE-2020-27985",
  "github_data": {
    "repository": "Security-Onion-Solutions/securityonion",
    "fix_commit": "b14670030349a2747a00ace665568ab5f51ac47b",
    "related_commits": [
      "b14670030349a2747a00ace665568ab5f51ac47b",
      "b14670030349a2747a00ace665568ab5f51ac47b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b14670030349a2747a00ace665568ab5f51ac47b",
      "commit_date": "2020-11-17T20:36:25Z",
      "author": {
        "login": "rwwiv",
        "type": "User",
        "stats": {
          "total_commits": 45,
          "average_weekly_commits": 0.1232876712328767,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 8
        }
      },
      "commit_message": {
        "title": "[feat] Remove so-setup permission from sudoers file after iso setup",
        "length": 81,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 11,
        "deletions": 0
      },
      "files": [
        {
          "filename": "salt/common/tools/sbin/soup",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -191,6 +191,7 @@ pillar_changes() {\n     [[ \"$INSTALLEDVERSION\" =~ rc.1 ]] && rc1_to_rc2\n     [[ \"$INSTALLEDVERSION\" =~ rc.2 ]] && rc2_to_rc3\n     [[ \"$INSTALLEDVERSION\" =~ rc.3 ]] && rc3_to_2.3.0\n+\t[[ \"$INSTALLEDVERSION\" =~ 2.3.2 ]] && up_2.3.2_to_2.3.10\n \n }\n \n@@ -292,6 +293,12 @@ unmount_update() {\n   umount /tmp/soagupdate\n }\n \n+up_2.3.2_to_2.3.10() {\n+\tif grep -q \"so-setup\" /etc/sudoers; then\n+\t\techo \"[ INFO ] There is an entry for so-setup in the sudoers file, this can be safely deleted using \\\"visudo\\\".\"\n+\tfi\n+}\n+\n update_centos_repo() {\n   # Update the files in the repo\n   echo \"Syncing new updates to /nsm/repo\""
        },
        {
          "filename": "setup/so-functions",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -1019,6 +1019,10 @@ install_cleanup() {\n \t# If Mysql is running stop it\n \t/usr/sbin/so-mysql-stop\n \n+\tif [[ $install_type == 'iso' ]]; then\n+\t\tinfo \"Removing so-setup permission entry from sudoers file\"\n+\t\tsed -i '/so-setup/d' /etc/sudoers\n+\tfi\n }\n \n import_registry_docker() {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ace6c5c9e4118653c83f414b4a7b0147672acd64",
            "date": "2024-12-18T16:42:42Z",
            "author_login": "TOoSmOotH"
          },
          {
            "sha": "4a4c8eace2d15f410bd9a7ea70bcddb9fc07d59a",
            "date": "2024-12-18T15:36:15Z",
            "author_login": "TOoSmOotH"
          },
          {
            "sha": "ec90adc6d9392721427d86d0d9683df1863ce048",
            "date": "2024-12-18T15:16:50Z",
            "author_login": "TOoSmOotH"
          },
          {
            "sha": "93f3171a632936798ed52234d1195a9c8ac222d9",
            "date": "2024-12-18T15:05:48Z",
            "author_login": "TOoSmOotH"
          },
          {
            "sha": "7d4c6b11740ef0e30ae04d8e30e0dbe1350a8b36",
            "date": "2024-12-18T14:29:08Z",
            "author_login": "TOoSmOotH"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-306",
    "description": "Security Onion v2 prior to 2.3.10 has an incorrect sudo configuration, which allows the administrative user to obtain root access without using the sudo password by editing and executing /home/<user>/SecurityOnion/setup/so-setup.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-11-23T14:15:12.187",
    "last_modified": "2024-11-21T05:22:08.873",
    "fix_date": "2020-11-17T20:36:25Z"
  },
  "references": [
    {
      "url": "https://github.com/Security-Onion-Solutions/securityonion/commit/b14670030349a2747a00ace665568ab5f51ac47b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Security-Onion-Solutions/securityonion/releases",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://s1gh.sh/cve-2020-27985-security-onion-local-privilege-escalation/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Security-Onion-Solutions/securityonion/commit/b14670030349a2747a00ace665568ab5f51ac47b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Security-Onion-Solutions/securityonion/releases",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://s1gh.sh/cve-2020-27985-security-onion-local-privilege-escalation/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.469908",
    "processing_status": "enhanced"
  }
}