{
  "cve_id": "CVE-2020-28896",
  "github_data": {
    "repository": "neomutt/neomutt",
    "fix_commit": "9c36717a3e2af1f2c1b7242035455ec8112b4b06",
    "related_commits": [
      "9c36717a3e2af1f2c1b7242035455ec8112b4b06",
      "9c36717a3e2af1f2c1b7242035455ec8112b4b06"
    ],
    "patch_url": "https://github.com/neomutt/neomutt/commit/9c36717a3e2af1f2c1b7242035455ec8112b4b06.patch",
    "fix_commit_details": {
      "sha": "9c36717a3e2af1f2c1b7242035455ec8112b4b06",
      "commit_date": "2020-11-17T12:29:12Z",
      "author": {
        "login": "flatcap",
        "type": "User",
        "stats": {
          "total_commits": 7233,
          "average_weekly_commits": 2.517577445179255,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 414
        }
      },
      "commit_message": {
        "title": "imap: close connection on all failures",
        "length": 145,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 5,
        "deletions": 8
      },
      "files": [
        {
          "filename": "imap/imap.c",
          "status": "modified",
          "additions": 5,
          "deletions": 8,
          "patch": "@@ -761,7 +761,7 @@ int imap_open_connection(struct ImapAccountData *adata)\n       else if ((ans = query_quadoption(C_SslStarttls,\n                                        _(\"Secure connection with TLS?\"))) == MUTT_ABORT)\n       {\n-        goto err_close_conn;\n+        goto bail;\n       }\n       if (ans == MUTT_YES)\n       {\n@@ -776,7 +776,7 @@ int imap_open_connection(struct ImapAccountData *adata)\n           if (mutt_ssl_starttls(adata->conn))\n           {\n             mutt_error(_(\"Could not negotiate TLS connection\"));\n-            goto err_close_conn;\n+            goto bail;\n           }\n           else\n           {\n@@ -791,7 +791,7 @@ int imap_open_connection(struct ImapAccountData *adata)\n     if (C_SslForceTls && (adata->conn->ssf == 0))\n     {\n       mutt_error(_(\"Encrypted connection unavailable\"));\n-      goto err_close_conn;\n+      goto bail;\n     }\n #endif\n   }\n@@ -807,7 +807,7 @@ int imap_open_connection(struct ImapAccountData *adata)\n     if ((adata->conn->ssf == 0) && C_SslForceTls)\n     {\n       mutt_error(_(\"Encrypted connection unavailable\"));\n-      goto err_close_conn;\n+      goto bail;\n     }\n #endif\n \n@@ -824,11 +824,8 @@ int imap_open_connection(struct ImapAccountData *adata)\n \n   return 0;\n \n-#ifdef USE_SSL\n-err_close_conn:\n-  imap_close_connection(adata);\n-#endif\n bail:\n+  imap_close_connection(adata);\n   FREE(&adata->capstr);\n   return -1;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0e7c2c38957b6638cae4ca0f97acab30248fce04",
            "date": "2025-01-13T14:50:32Z",
            "author_login": "gahr"
          },
          {
            "sha": "fb9fa130fab7db0c731ac73d2f171050559e1142",
            "date": "2025-01-13T10:33:30Z",
            "author_login": "gahr"
          },
          {
            "sha": "e46230806a4608598212620b6c01cadfd48a26e3",
            "date": "2025-01-11T03:13:54Z",
            "author_login": "flatcap"
          },
          {
            "sha": "5736e97d875aa8593b2542e0a84b78337fb472a7",
            "date": "2025-01-11T11:24:39Z",
            "author_login": "flatcap"
          },
          {
            "sha": "fa9e092af905ad677375f1d9e08c861a3cce6e6f",
            "date": "2025-01-11T11:13:51Z",
            "author_login": "flatcap"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-287",
    "description": "Mutt before 2.0.2 and NeoMutt before 2020-11-20 did not ensure that $ssl_force_tls was processed if an IMAP server's initial server response was invalid. The connection was not properly closed, and the code could continue attempting to authenticate. This could result in authentication credentials being exposed on an unencrypted connection, or to a machine-in-the-middle.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-11-23T19:15:11.413",
    "last_modified": "2024-11-21T05:23:14.600",
    "fix_date": "2020-11-17T12:29:12Z"
  },
  "references": [
    {
      "url": "https://github.com/neomutt/neomutt/commit/9c36717a3e2af1f2c1b7242035455ec8112b4b06",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neomutt/neomutt/releases/tag/20201120",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitlab.com/muttmua/mutt/-/commit/04b06aaa3e0cc0022b9b01dbca2863756ebbf59a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitlab.com/muttmua/mutt/-/commit/d92689088dfe80a290ec836e292376e2d9984f8f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/11/msg00048.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202101-32",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neomutt/neomutt/commit/9c36717a3e2af1f2c1b7242035455ec8112b4b06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neomutt/neomutt/releases/tag/20201120",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitlab.com/muttmua/mutt/-/commit/04b06aaa3e0cc0022b9b01dbca2863756ebbf59a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitlab.com/muttmua/mutt/-/commit/d92689088dfe80a290ec836e292376e2d9984f8f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2020/11/msg00048.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202101-32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.470580",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "neomutt",
    "owner": "neomutt",
    "created_at": "2015-12-21T02:12:54Z",
    "updated_at": "2025-01-14T09:57:10Z",
    "pushed_at": "2025-01-13T19:26:30Z",
    "size": 169912,
    "stars": 3311,
    "forks": 312,
    "open_issues": 224,
    "watchers": 3311,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 8599424,
      "Tcl": 157624,
      "Shell": 93753,
      "Perl": 31089,
      "Python": 21960
    },
    "commit_activity": {
      "total_commits_last_year": 674,
      "avg_commits_per_week": 12.961538461538462,
      "days_active_last_year": 184
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:20:20.846292"
  }
}