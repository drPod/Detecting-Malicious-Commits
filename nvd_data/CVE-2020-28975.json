{
  "cve_id": "CVE-2020-28975",
  "github_data": {
    "repository": "scikit-learn/scikit-learn",
    "fix_commit": "1bf13d567d3cd74854aa8343fd25b61dd768bb85",
    "related_commits": [
      "1bf13d567d3cd74854aa8343fd25b61dd768bb85",
      "1bf13d567d3cd74854aa8343fd25b61dd768bb85"
    ],
    "patch_url": "https://github.com/scikit-learn/scikit-learn/commit/1bf13d567d3cd74854aa8343fd25b61dd768bb85.patch",
    "fix_commit_details": {
      "sha": "1bf13d567d3cd74854aa8343fd25b61dd768bb85",
      "commit_date": "2021-10-20T12:30:06Z",
      "author": {
        "login": "thomasjpfan",
        "type": "User",
        "stats": {
          "total_commits": 1369,
          "average_weekly_commits": 1.7439490445859873,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 284
        }
      },
      "commit_message": {
        "title": "FIX Prevents segfault in SVC when internals are altered (#21336)",
        "length": 273,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 29,
        "deletions": 0
      },
      "files": [
        {
          "filename": "doc/whats_new/v1.0.rst",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -67,6 +67,15 @@ Fixed models\n   names out from one step of a pipeline to the next. :pr:`21351` by\n   `Thomas Fan`_.\n \n+:mod:`sklearn.svm`\n+..................\n+\n+- |Fix| :class:`svm.SVC` and :class:`svm.SVR` check for an inconsistency\n+  in its internal representation and raise an error instead of segfaulting.\n+  This fix also resolves\n+  `CVE-2020-28975 <https://nvd.nist.gov/vuln/detail/CVE-2020-28975>`__.\n+  :pr:`21336` by `Thomas Fan`_.\n+\n .. _changes_1_0:\n \n Version 1.0.0"
        },
        {
          "filename": "sklearn/svm/_base.py",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -616,6 +616,13 @@ def _validate_for_predict(self, X):\n                     \"the number of samples at training time\"\n                     % (X.shape[1], self.shape_fit_[0])\n                 )\n+        # Fixes https://nvd.nist.gov/vuln/detail/CVE-2020-28975\n+        # Check that _n_support is consistent with support_vectors\n+        sv = self.support_vectors_\n+        if not self._sparse and sv.size > 0 and self.n_support_.sum() != sv.shape[0]:\n+            raise ValueError(\n+                f\"The internal representation of {self.__class__.__name__} was altered\"\n+            )\n         return X\n \n     @property"
        },
        {
          "filename": "sklearn/svm/tests/test_svm.py",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -1371,3 +1371,16 @@ def string_kernel(X1, X2):\n     else:  # regressor\n         assert_allclose(svc1.predict(data), svc2.predict(X))\n         assert_allclose(svc1.predict(data), svc3.predict(K))\n+\n+\n+def test_svc_raises_error_internal_representation():\n+    \"\"\"Check that SVC raises error when internal representation is altered.\n+\n+    Non-regression test for #18891 and https://nvd.nist.gov/vuln/detail/CVE-2020-28975\n+    \"\"\"\n+    clf = svm.SVC(kernel=\"linear\").fit(X, Y)\n+    clf._n_support[0] = 1000000\n+\n+    msg = \"The internal representation of SVC was altered\"\n+    with pytest.raises(ValueError, match=msg):\n+        clf.predict(X)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2707099b23a0a8580731553629566c1182d26f48",
            "date": "2025-01-14T13:48:56Z",
            "author_login": "scikit-learn-bot"
          },
          {
            "sha": "ae15ed512413ce127df8e413b36e354c6e37f451",
            "date": "2025-01-14T13:20:35Z",
            "author_login": "scikit-learn-bot"
          },
          {
            "sha": "4f7b3e0da3ee2ccba722282a3c1643109fec1e15",
            "date": "2025-01-14T13:20:11Z",
            "author_login": "scikit-learn-bot"
          },
          {
            "sha": "1ab1ead1b3bddeecfd1ffd6e94ae7512494f7e26",
            "date": "2025-01-14T13:19:35Z",
            "author_login": "scikit-learn-bot"
          },
          {
            "sha": "f15ddc05cb4c39b07acf3a950b32471fbaa7f2e2",
            "date": "2025-01-14T11:16:20Z",
            "author_login": "pedro9olivares"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": null,
    "description": "svm_predict_values in svm.cpp in Libsvm v324, as used in scikit-learn 0.23.2 and other products, allows attackers to cause a denial of service (segmentation fault) via a crafted model SVM (introduced via pickle, json, or any other model permanence standard) with a large value in the _n_support array. NOTE: the scikit-learn vendor's position is that the behavior can only occur if the library's API is violated by an application that changes a private attribute.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-11-21T21:15:10.680",
    "last_modified": "2024-11-21T05:23:25.657",
    "fix_date": "2021-10-20T12:30:06Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/160281/SciKit-Learn-0.23.2-Denial-Of-Service.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2020/Nov/44",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/cjlin1/libsvm/blob/9a3a9708926dec87d382c43b203f2ca19c2d56a0/svm.cpp#L2501",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scikit-learn/scikit-learn/commit/1bf13d567d3cd74854aa8343fd25b61dd768bb85",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scikit-learn/scikit-learn/issues/18891",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202301-03",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/160281/SciKit-Learn-0.23.2-Denial-Of-Service.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2020/Nov/44",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/cjlin1/libsvm/blob/9a3a9708926dec87d382c43b203f2ca19c2d56a0/svm.cpp#L2501",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scikit-learn/scikit-learn/commit/1bf13d567d3cd74854aa8343fd25b61dd768bb85",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scikit-learn/scikit-learn/issues/18891",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202301-03",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:08.469730",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "scikit-learn",
    "owner": "scikit-learn",
    "created_at": "2010-08-17T09:43:38Z",
    "updated_at": "2025-01-14T14:58:41Z",
    "pushed_at": "2025-01-14T13:48:57Z",
    "size": 166081,
    "stars": 60753,
    "forks": 25508,
    "open_issues": 2113,
    "watchers": 60753,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.6.X",
      "0.7.X",
      "0.8.X",
      "0.9.X",
      "0.10.X",
      "0.11.X",
      "0.12.X",
      "0.13.X",
      "0.14.X",
      "0.15.X",
      "0.16.X",
      "0.17.X",
      "0.18.X",
      "0.19.X",
      "0.20.X",
      "0.21.X",
      "0.22.X",
      "0.23.X",
      "0.24.X",
      "1.0.X",
      "1.1.X",
      "1.2.X",
      "1.3.X",
      "1.4.X",
      "1.5.X",
      "1.6.X"
    ],
    "languages": {
      "Python": 12297843,
      "Cython": 729063,
      "C++": 147429,
      "Shell": 48254,
      "C": 41896,
      "Meson": 32490,
      "CSS": 11277,
      "JavaScript": 1661,
      "Starlark": 1442,
      "Makefile": 1034
    },
    "commit_activity": {
      "total_commits_last_year": 1939,
      "avg_commits_per_week": 37.28846153846154,
      "days_active_last_year": 274
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:27:34.605468"
  }
}