{
  "cve_id": "CVE-2020-35460",
  "github_data": {
    "repository": "joniles/mpxj",
    "fix_commit": "8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d",
    "related_commits": [
      "8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d",
      "8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d"
    ],
    "patch_url": "https://github.com/joniles/mpxj/commit/8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d.patch",
    "fix_commit_details": {
      "sha": "8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d",
      "commit_date": "2020-12-14T12:13:14Z",
      "author": {
        "login": "joniles",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "zip slip fix",
        "length": 12,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/main/java/net/sf/mpxj/common/InputStreamHelper.java",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -114,6 +114,7 @@ public static File writeZipStreamToTempDir(InputStream inputStream) throws IOExc\n     */\n    private static void processZipStream(File dir, InputStream inputStream) throws IOException\n    {\n+      String canonicalDestinationDirPath = dir.getCanonicalPath();\n       ZipInputStream zip = new ZipInputStream(inputStream);\n       while (true)\n       {\n@@ -124,6 +125,14 @@ private static void processZipStream(File dir, InputStream inputStream) throws I\n          }\n \n          File file = new File(dir, entry.getName());\n+\n+         // https://snyk.io/research/zip-slip-vulnerability\n+         String canonicalDestinationFile = file.getCanonicalPath();\n+         if (!canonicalDestinationFile.startsWith(canonicalDestinationDirPath + File.separator))\n+         {\n+            throw new IOException(\"Entry is outside of the target dir: \" + entry.getName());\n+         }\n+\n          if (entry.isDirectory())\n          {\n             FileHelper.mkdirsQuietly(file);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ffa0c002297c07e2ea92731d93f6bdcc37fc3afb",
            "date": "2025-01-09T19:37:48Z",
            "author_login": "joniles"
          },
          {
            "sha": "2e130ff381e56ddf83dd36805ae616e42f853714",
            "date": "2025-01-09T15:18:49Z",
            "author_login": "joniles"
          },
          {
            "sha": "6947f548c2a0cc893a8dda9bd3eb304ce0eb5424",
            "date": "2025-01-09T15:05:13Z",
            "author_login": "joniles"
          },
          {
            "sha": "12f62054d104fcdaf31ab5e388fcedbe95433466",
            "date": "2025-01-09T14:40:11Z",
            "author_login": "joniles"
          },
          {
            "sha": "77568f8289eb06641c5c18524486d6163e175911",
            "date": "2025-01-09T10:50:03Z",
            "author_login": "joniles"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-22",
    "description": "common/InputStreamHelper.java in Packwood MPXJ before 8.3.5 allows directory traversal in the zip stream handler flow, leading to the writing of files to arbitrary locations.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-12-14T23:15:12.267",
    "last_modified": "2024-11-21T05:27:20.007",
    "fix_date": "2020-12-14T12:13:14Z"
  },
  "references": [
    {
      "url": "http://www.mpxj.org/changes-report.html#a8.3.5",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/joniles/mpxj/commit/8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2021.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.mpxj.org/changes-report.html#a8.3.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/joniles/mpxj/commit/8eaf4225048ea5ba7e59ef4556dab2098fcc4a1d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2021.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:10.516790",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mpxj",
    "owner": "joniles",
    "created_at": "2015-06-07T10:45:11Z",
    "updated_at": "2025-01-11T16:27:03Z",
    "pushed_at": "2025-01-14T14:15:14Z",
    "size": 459316,
    "stars": 253,
    "forks": 105,
    "open_issues": 18,
    "watchers": 253,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 14704319,
      "Ruby": 524731,
      "C#": 55518,
      "VBA": 35875,
      "Visual Basic .NET": 14934,
      "Batchfile": 3947,
      "CSS": 2622,
      "Python": 1196,
      "Shell": 353
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T14:23:00.371697"
  }
}