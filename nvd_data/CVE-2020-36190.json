{
  "cve_id": "CVE-2020-36190",
  "github_data": {
    "repository": "sferik/rails_admin",
    "fix_commit": "d72090ec6a07c3b9b7b48ab50f3d405f91ff4375",
    "related_commits": [
      "d72090ec6a07c3b9b7b48ab50f3d405f91ff4375",
      "d72090ec6a07c3b9b7b48ab50f3d405f91ff4375"
    ],
    "patch_url": "https://github.com/sferik/rails_admin/commit/d72090ec6a07c3b9b7b48ab50f3d405f91ff4375.patch",
    "fix_commit_details": {
      "sha": "d72090ec6a07c3b9b7b48ab50f3d405f91ff4375",
      "commit_date": "2020-03-14T09:14:25Z",
      "author": {
        "login": "mshibuya",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix XSS vulnerability in nested forms",
        "length": 37,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 55,
        "additions": 50,
        "deletions": 5
      },
      "files": [
        {
          "filename": "app/assets/javascripts/rails_admin/ra.nested-form-hooks.js",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -11,7 +11,9 @@\n   $(document).on('nested:fieldAdded', 'form', function(content) {\n     var controls, field, nav, new_tab, one_to_one, parent_group, toggler;\n     field = content.field.addClass('tab-pane').attr('id', 'unique-id-' + (new Date().getTime()));\n-    new_tab = $('<li><a data-toggle=\"tab\" href=\"#' + field.attr('id') + '\">' + field.children('.object-infos').data('object-label') + '</a></li>');\n+    new_tab = $('<li></li>').append(\n+        $('<a></a>').attr('data-toggle', 'tab').attr('href', '#' + field.attr('id')).text(field.children('.object-infos').data('object-label'))\n+    )\n     parent_group = field.closest('.control-group');\n     controls = parent_group.children('.controls');\n     one_to_one = controls.data('nestedone') !== void 0;\n@@ -27,7 +29,7 @@\n     content.select(':hidden').show('slow');\n     toggler.addClass('active').removeClass('disabled').children('i').addClass('icon-chevron-down').removeClass('icon-chevron-right');\n     if (one_to_one) {\n-      controls.find('.add_nested_fields').removeClass('add_nested_fields').html(field.children('.object-infos').data('object-label'));\n+      controls.find('.add_nested_fields').removeClass('add_nested_fields').text(field.children('.object-infos').data('object-label'));\n     }\n   });\n "
        },
        {
          "filename": "app/assets/javascripts/rails_admin/ra.widgets.js",
          "status": "modified",
          "additions": 11,
          "deletions": 3,
          "patch": "@@ -137,7 +137,11 @@\n         toggler = field.find('> .controls > .btn-group > .toggler');\n         tab_content.children('.fields:not(.tab-pane)').addClass('tab-pane').each(function() {\n           $(this).attr('id', 'unique-id-' + (new Date().getTime()) + Math.floor(Math.random() * 100000));\n-          nav.append('<li><a data-toggle=\"tab\" href=\"#' + this.id + '\">' + $(this).children('.object-infos').data('object-label') + '</a></li>');\n+          nav.append(\n+              $('<li></li>').append(\n+                  $('<a></a>').attr('data-toggle', 'tab').attr('href', '#' + this.id).text($(this).children('.object-infos').data('object-label'))\n+              )\n+          );\n         });\n         if (nav.find(\"> li.active\").length === 0) {\n           nav.find(\"> li > a[data-toggle='tab']:first\").tab('show');\n@@ -165,8 +169,12 @@\n         tab_content = field.find(\"> .tab-content\");\n         toggler = field.find('> .controls > .btn-group > .toggler');\n         tab_content.children(\".fields:not(.tab-pane)\").addClass('tab-pane active').each(function() {\n-          field.find('> .controls .add_nested_fields').removeClass('add_nested_fields').html($(this).children('.object-infos').data('object-label'));\n-          nav.append('<li><a data-toggle=\"tab\" href=\"#' + this.id + '\">' + $(this).children('.object-infos').data('object-label') + '</a></li>');\n+          field.find('> .controls .add_nested_fields').removeClass('add_nested_fields').text($(this).children('.object-infos').data('object-label'));\n+          nav.append(\n+              $('<li></li>').append(\n+                  $('<a></a>').attr('data-toggle', 'tab').attr('href', '#' + this.id).text($(this).children('.object-infos').data('object-label'))\n+              )\n+          );\n         });\n         first_tab = nav.find(\"> li > a[data-toggle='tab']:first\");\n         first_tab.tab('show');"
        },
        {
          "filename": "spec/integration/fields/has_many_association_spec.rb",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -211,6 +211,22 @@\n         expect(page.body).to include('field_test_nested_field_tests_attributes_new_nested_field_tests_deeply_nested_field_tests_attributes_new_deeply_nested_field_tests_title')\n       end\n     end\n+\n+    context 'when XSS attack is attempted', js: true do\n+      it 'does not break on adding a new item' do\n+        allow(I18n).to receive(:t).and_call_original\n+        expect(I18n).to receive(:t).with('admin.form.new_model', name: 'Nested field test').and_return('<script>throw \"XSS\";</script>')\n+        @record = FactoryBot.create :field_test\n+        visit edit_path(model_name: 'field_test', id: @record.id)\n+        find('#field_test_nested_field_tests_attributes_field .add_nested_fields').click\n+      end\n+\n+      it 'does not break on editing an existing item' do\n+        @record = FactoryBot.create :field_test\n+        NestedFieldTest.create! title: '<script>throw \"XSS\";</script>', field_test: @record\n+        visit edit_path(model_name: 'field_test', id: @record.id)\n+      end\n+    end\n   end\n \n   context 'with not nullable foreign key', active_record: true do"
        },
        {
          "filename": "spec/integration/fields/has_one_association_spec.rb",
          "status": "renamed",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -91,6 +91,25 @@\n       @record.reload\n       expect(@record.comment).to be_nil\n     end\n+\n+    context 'when XSS attack is attempted', js: true do\n+      it 'does not break on adding a new item' do\n+        allow(I18n).to receive(:t).and_call_original\n+        expect(I18n).to receive(:t).with('admin.form.new_model', name: 'Comment').and_return('<script>throw \"XSS\";</script>')\n+        @record = FactoryBot.create :field_test\n+        visit edit_path(model_name: 'field_test', id: @record.id)\n+        find('#field_test_comment_attributes_field .add_nested_fields').click\n+      end\n+\n+      it 'does not break on adding an existing item' do\n+        RailsAdmin.config Comment do\n+          object_label_method :content\n+        end\n+        @record = FactoryBot.create :field_test\n+        FactoryBot.create :comment, content: '<script>throw \"XSS\";</script>', commentable: @record\n+        visit edit_path(model_name: 'field_test', id: @record.id)\n+      end\n+    end\n   end\n \n   context 'with custom primary_key option' do"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f4cf4b6c9fd1729357b7be0b6587d0d0c706dbb3",
            "date": "2024-12-08T06:18:29Z",
            "author_login": "mshibuya"
          },
          {
            "sha": "e38c12d98e3e11b858d2f3caa752013b7478f926",
            "date": "2024-11-23T08:42:29Z",
            "author_login": "mshibuya"
          },
          {
            "sha": "541285733737f8a79abcac2372f9e2074cc714b8",
            "date": "2024-11-23T08:24:11Z",
            "author_login": "jewilmeer"
          },
          {
            "sha": "b09f770d9f2b743626d5f29ac9449dbcce9e5c70",
            "date": "2024-10-10T14:16:23Z",
            "author_login": "mshibuya"
          },
          {
            "sha": "f54a102c6b0a420244ef044503944574ef1dfbd2",
            "date": "2024-10-06T09:32:59Z",
            "author_login": "mshibuya"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "RailsAdmin (aka rails_admin) before 1.4.3 and 2.x before 2.0.2 allows XSS via nested forms.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-12T20:15:24.697",
    "last_modified": "2024-11-21T05:28:58.547",
    "fix_date": "2020-03-14T09:14:25Z"
  },
  "references": [
    {
      "url": "https://github.com/sferik/rails_admin/blob/master/README.md",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sferik/rails_admin/commit/d72090ec6a07c3b9b7b48ab50f3d405f91ff4375",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sferik/rails_admin/compare/v1.4.2...v1.4.3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sferik/rails_admin/blob/master/README.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sferik/rails_admin/commit/d72090ec6a07c3b9b7b48ab50f3d405f91ff4375",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sferik/rails_admin/compare/v1.4.2...v1.4.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:10.577921",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rails_admin",
    "owner": "sferik",
    "created_at": "2010-08-01T17:01:00Z",
    "updated_at": "2025-01-10T19:36:31Z",
    "pushed_at": "2025-01-13T09:57:30Z",
    "size": 20988,
    "stars": 7908,
    "forks": 2259,
    "open_issues": 192,
    "watchers": 7908,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Ruby": 947690,
      "JavaScript": 85675,
      "HTML": 54278,
      "SCSS": 11734,
      "Dockerfile": 2762,
      "CSS": 526,
      "Shell": 345,
      "TypeScript": 142
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:30:23.248989"
  }
}