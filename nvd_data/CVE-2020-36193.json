{
  "cve_id": "CVE-2020-36193",
  "github_data": {
    "repository": "pear/Archive_Tar",
    "fix_commit": "cde460582ff389404b5b3ccb59374e9b389de916",
    "related_commits": [
      "cde460582ff389404b5b3ccb59374e9b389de916",
      "cde460582ff389404b5b3ccb59374e9b389de916"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "cde460582ff389404b5b3ccb59374e9b389de916",
      "commit_date": "2020-12-14T13:15:41Z",
      "author": {
        "login": "mrook",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Disallow symlinks to out-of-path filenames",
        "length": 42,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 26,
        "deletions": 0
      },
      "files": [
        {
          "filename": "Archive/Tar.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -2124,6 +2124,14 @@ public function _extractList(\n                             }\n                         }\n                     } elseif ($v_header['typeflag'] == \"2\") {\n+                        if (strpos(realpath(dirname($v_header['link'])), realpath($p_path)) !== 0) {\n+                            $this->_error(\n+                                 'Out-of-path file extraction {'\n+                                 . $v_header['filename'] . ' --> ' .\n+                                 $v_header['link'] . '}'\n+                            );\n+                            return false;\n+                        }\n                         if (!$p_symlinks) {\n                             $this->_warning('Symbolic links are not allowed. '\n                                 . 'Unable to extract {'"
        },
        {
          "filename": "tests/out_of_path_fnames.phpt",
          "status": "added",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -0,0 +1,18 @@\n+--TEST--\n+tests writes to out-of-path filenames\n+--SKIPIF--\n+--FILE--\n+<?php\n+require_once dirname(__FILE__) . '/setup.php.inc';\n+$tar = new Archive_Tar(dirname(__FILE__) . '/out_of_path_symlink.tar');\n+$tar->extract();\n+$phpunit->assertErrors(array(array('package' => 'PEAR_Error', 'message' => \"Out-of-path file extraction {symlink --> /tmp/}\")), 'after 1');\n+$phpunit->assertFileNotExists('symlink/whatever-filename', 'Out-of-path filename should not have succeeded');\n+echo 'tests done';\n+?>\n+--CLEAN--\n+<?php\n+@unlink(\"symlink\");\n+?>\n+--EXPECT--\n+tests done"
        },
        {
          "filename": "tests/out_of_path_symlink.tar",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "36778513c36ef464a82757627d672468646ae382",
            "date": "2024-11-24T22:35:52Z",
            "author_login": "ashnazg"
          },
          {
            "sha": "3abb0c27d5f493484cd6be71543ed2f7a954ca83",
            "date": "2024-11-24T20:48:54Z",
            "author_login": "mcdruid"
          },
          {
            "sha": "6b91932f07efbcf790fee38981c9e79d4029c3a9",
            "date": "2024-11-24T20:42:51Z",
            "author_login": "mcdruid"
          },
          {
            "sha": "ba360e066c4f26995b19c7b07d8172964e5dad22",
            "date": "2024-11-24T20:31:20Z",
            "author_login": "mcdruid"
          },
          {
            "sha": "87e03d0e9a012d406bfa1ecfce64236142f2cffa",
            "date": "2024-11-24T20:07:28Z",
            "author_login": "mcdruid"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "Tar.php in Archive_Tar through 1.4.11 allows write operations with Directory Traversal due to inadequate checking of symbolic links, a related issue to CVE-2020-28948.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-18T20:15:12.667",
    "last_modified": "2024-11-21T05:28:59.137",
    "fix_date": "2020-12-14T13:15:41Z"
  },
  "references": [
    {
      "url": "https://github.com/pear/Archive_Tar/commit/cde460582ff389404b5b3ccb59374e9b389de916",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/01/msg00018.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/04/msg00007.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/42GPGVVFTLJYAKRI75IVB5R45NYQGEUR/",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FOZNK4FIIV7FSFCJNNFWMJZTTV7NFJV2/",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VJQQYDAOWHD6RDITDRPHFW7WY6BS3V5N/",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YKD5WEFA4WT6AVTMRAYBNXZNLWZHM7FH/",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202101-23",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4894",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.drupal.org/sa-core-2021-001",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pear/Archive_Tar/commit/cde460582ff389404b5b3ccb59374e9b389de916",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/01/msg00018.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/04/msg00007.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/42GPGVVFTLJYAKRI75IVB5R45NYQGEUR/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FOZNK4FIIV7FSFCJNNFWMJZTTV7NFJV2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VJQQYDAOWHD6RDITDRPHFW7WY6BS3V5N/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YKD5WEFA4WT6AVTMRAYBNXZNLWZHM7FH/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202101-23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4894",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.drupal.org/sa-core-2021-001",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.153763",
    "processing_status": "enhanced"
  }
}