{
  "cve_id": "CVE-2020-36324",
  "github_data": {
    "repository": "wikimedia/analytics-quarry-web",
    "fix_commit": "4b7e1d6a3a52ec6cf826a971135a38b0f74785d2",
    "related_commits": [
      "4b7e1d6a3a52ec6cf826a971135a38b0f74785d2",
      "4b7e1d6a3a52ec6cf826a971135a38b0f74785d2"
    ],
    "patch_url": "https://github.com/wikimedia/analytics-quarry-web/commit/4b7e1d6a3a52ec6cf826a971135a38b0f74785d2.patch",
    "fix_commit_details": {
      "sha": "4b7e1d6a3a52ec6cf826a971135a38b0f74785d2",
      "commit_date": "2020-12-15T16:55:55Z",
      "author": {
        "login": "reedy",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "SECURITY: Set correct Mime Type on /api/preferences",
        "length": 181,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 12,
        "deletions": 3
      },
      "files": [
        {
          "filename": "quarry/web/app.py",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -398,9 +398,15 @@ def pref_get(key):\n         return \"Authentication required\", 401\n \n     if key in get_preferences():\n-        return Response(json.dumps({'key': key, 'value': get_preferences()[key]}))\n+        return Response(\n+            json.dumps({'key': key, 'value': get_preferences()[key]}),\n+            mimetype='application/json'\n+        )\n     else:\n-        return Response(json.dumps({'key': key, 'error': 'novalue'}))\n+        return Response(\n+            json.dumps({'key': key, 'error': 'novalue'}),\n+            mimetype='application/json'\n+        )\n \n \n @app.route(\"/api/preferences/set/<key>/<value>\")\n@@ -409,7 +415,10 @@ def pref_set(key, value):\n         return \"Authentication required\", 401\n \n     get_preferences()[key] = (None if value == 'null' else value)\n-    return Response(json.dumps({'key': key, 'success': ''})), 201\n+    return Response(\n+        json.dumps({'key': key, 'success': ''}),\n+        mimetype='application/json'\n+    ), 201\n \n \n if __name__ == '__main__':"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "23af76b518283b58238a44cea13df9fbedb47c65",
            "date": "2022-09-09T11:23:01Z",
            "author_login": "vivian-rook"
          },
          {
            "sha": "51451cdcc5cadf7af8675b601dc0930fd92b9fd0",
            "date": "2022-08-29T17:27:15Z",
            "author_login": "vivian-rook"
          },
          {
            "sha": "27ffc9055411fdbb32bbd6e25cb73430736e5c2c",
            "date": "2022-08-27T12:40:40Z",
            "author_login": "vivian-rook"
          },
          {
            "sha": "25f21164f27307cdf739d1b903476e9149b7c447",
            "date": "2022-08-19T11:12:41Z",
            "author_login": "RhinosF1"
          },
          {
            "sha": "379b19c3dc545a888078d6d86f360406e4ff9d5a",
            "date": "2022-08-08T18:58:38Z",
            "author_login": "RhinosF1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Wikimedia Quarry analytics-quarry-web before 2020-12-15 allows Reflected XSS because app.py does not explicitly set the application/json content type.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-04-21T20:15:36.870",
    "last_modified": "2024-11-21T05:29:16.960",
    "fix_date": "2020-12-15T16:55:55Z"
  },
  "references": [
    {
      "url": "https://github.com/wikimedia/analytics-quarry-web/commit/4b7e1d6a3a52ec6cf826a971135a38b0f74785d2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://quarry.wmflabs.org/",
      "source": "cve@mitre.org",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wikimedia/analytics-quarry-web/commit/4b7e1d6a3a52ec6cf826a971135a38b0f74785d2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://quarry.wmflabs.org/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:33.548856",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "analytics-quarry-web",
    "owner": "wikimedia",
    "created_at": "2014-07-21T22:22:49Z",
    "updated_at": "2024-02-23T14:08:38Z",
    "pushed_at": "2022-09-09T12:35:31Z",
    "size": 2144,
    "stars": 43,
    "forks": 14,
    "open_issues": 0,
    "watchers": 43,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {},
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:39:00.692195"
  }
}