{
  "cve_id": "CVE-2020-36406",
  "github_data": {
    "repository": "uNetworking/uWebSockets",
    "fix_commit": "03fca626a95130ab80f86adada54b29d27242759",
    "related_commits": [
      "03fca626a95130ab80f86adada54b29d27242759",
      "03fca626a95130ab80f86adada54b29d27242759"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "03fca626a95130ab80f86adada54b29d27242759",
      "commit_date": "2020-09-06T11:05:13Z",
      "author": {
        "login": "uNetworkingAB",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix overflow of triggered topics",
        "length": 32,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 10,
        "deletions": 4
      },
      "files": [
        {
          "filename": "src/TopicTree.h",
          "status": "modified",
          "additions": 10,
          "deletions": 4,
          "patch": "@@ -124,10 +124,6 @@ struct TopicTree {\n \n     /* Should be getData and commit? */\n     void publish(Topic *iterator, size_t start, size_t stop, std::string_view topic, std::pair<std::string_view, std::string_view> message) {\n-        /* If we already have 64 triggered topics make sure to drain it here */\n-        if (numTriggeredTopics == 64) {\n-            drain();\n-        }\n \n         /* Iterate over all segments in given topic */\n         for (; stop != std::string::npos; start = stop + 1) {\n@@ -151,6 +147,11 @@ struct TopicTree {\n \n                 /* Add this topic to triggered */\n                 if (!iterator->terminatingWildcardChild->triggered) {\n+                    /* If we already have 64 triggered topics make sure to drain it here */\n+                    if (numTriggeredTopics == 64) {\n+                        drain();\n+                    }\n+\n                     triggeredTopics[numTriggeredTopics++] = iterator->terminatingWildcardChild;\n                     iterator->terminatingWildcardChild->triggered = true;\n                 }\n@@ -175,6 +176,11 @@ struct TopicTree {\n \n         /* Add this topic to triggered */\n         if (!iterator->triggered) {\n+            /* If we already have 64 triggered topics make sure to drain it here */\n+            if (numTriggeredTopics == 64) {\n+                drain();\n+            }\n+\n             triggeredTopics[numTriggeredTopics++] = iterator;\n             iterator->triggered = true;\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8e2a5e3d941b4ab0bd38cdb9e012d18495c04d1e",
            "date": "2025-01-16T15:46:10Z",
            "author_login": "uNetworkingAB"
          },
          {
            "sha": "42b368e60d610c13d3166b0ee23167a13ac3d954",
            "date": "2025-01-16T15:43:16Z",
            "author_login": "uNetworkingAB"
          },
          {
            "sha": "f4207c00f748c62f804cd44c41700333cd3a3b21",
            "date": "2025-01-08T14:59:42Z",
            "author_login": "stellaryrock"
          },
          {
            "sha": "fa9a76dcb6b46e97af42adf1980ef8f7d77208a0",
            "date": "2025-01-08T11:47:09Z",
            "author_login": "uNetworkingAB"
          },
          {
            "sha": "a634261e24ecc430fc53013dffc694c03beb82fa",
            "date": "2025-01-05T07:54:22Z",
            "author_login": "uNetworkingAB"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "uWebSockets 18.11.0 and 18.12.0 has a stack-based buffer overflow in uWS::TopicTree::trimTree (called from uWS::TopicTree::unsubscribeAll). NOTE: the vendor's position is that this is \"a minor issue or not even an issue at all\" because the developer of an application (that uses uWebSockets) should not be allowing the large number of triggered topics to accumulate",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-01T03:15:08.000",
    "last_modified": "2024-11-21T05:29:25.953",
    "fix_date": "2020-09-06T11:05:13Z"
  },
  "references": [
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25381",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/uwebsockets/OSV-2020-1695.yaml",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/uNetworking/uWebSockets/commit/03fca626a95130ab80f86adada54b29d27242759",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25381",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/uwebsockets/OSV-2020-1695.yaml",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/uNetworking/uWebSockets/commit/03fca626a95130ab80f86adada54b29d27242759",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.768027",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "uWebSockets",
    "owner": "uNetworking",
    "created_at": "2016-03-21T04:39:40Z",
    "updated_at": "2025-01-26T05:31:53Z",
    "pushed_at": "2025-01-16T15:46:10Z",
    "size": 4768,
    "stars": 17617,
    "forks": 1773,
    "open_issues": 30,
    "watchers": 17617,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 406959,
      "C": 29787,
      "Makefile": 6369,
      "JavaScript": 4019
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:36:42.377858"
  }
}