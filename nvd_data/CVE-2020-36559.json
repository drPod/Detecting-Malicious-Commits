{
  "cve_id": "CVE-2020-36559",
  "github_data": {
    "repository": "go-aah/aah",
    "fix_commit": "881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec",
    "related_commits": [
      "881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec",
      "881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec"
    ],
    "patch_url": "https://github.com/go-aah/aah/commit/881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec.patch",
    "fix_commit_details": {
      "sha": "881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec",
      "commit_date": "2020-03-03T09:27:03Z",
      "author": {
        "login": "jeevatkm",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": " #266 addressing path traversal issue on static file delivery (#267)",
        "length": 68,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 32,
        "additions": 20,
        "deletions": 12
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -9,6 +9,7 @@\n \n ### News\n \n+  * `v0.12.4` [released](https://docs.aahframework.org/release-notes.html) and tagged on Mar 03, 2020.\n   * `v0.12.3` [released](https://docs.aahframework.org/release-notes.html) and tagged on Feb 06, 2019.\n   * `v0.12.2` [released](https://docs.aahframework.org/release-notes.html) and tagged on Dec 13, 2018.\n   * `v0.12.0` [released](https://docs.aahframework.org/release-notes.html) and tagged on Dec 02, 2018."
        },
        {
          "filename": "http_engine.go",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -8,13 +8,14 @@ import (\n \t\"errors\"\n \t\"io\"\n \t\"net/http\"\n+\t\"path\"\n \t\"sync\"\n \t\"time\"\n \n \t\"aahframe.work/ahttp\"\n \t\"aahframe.work/ainsp\"\n \t\"aahframe.work/aruntime\"\n-\t\"aahframe.work/essentials\"\n+\tess \"aahframe.work/essentials\"\n \t\"aahframe.work/internal/settings\"\n \t\"aahframe.work/log\"\n \t\"aahframe.work/security\"\n@@ -80,6 +81,9 @@ func (e *HTTPEngine) Handle(w http.ResponseWriter, r *http.Request) {\n \t\tdefer e.a.accessLog.Log(ctx)\n \t}\n \n+\t// Path Clean\n+\tr.URL.Path = path.Clean(r.URL.Path)\n+\n \tctx.Req, ctx.Res = ahttp.AcquireRequest(r), ahttp.AcquireResponseWriter(w)\n \n \t// Recovery handling"
        },
        {
          "filename": "static.go",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -19,7 +19,7 @@ import (\n \t\"strings\"\n \n \t\"aahframe.work/ahttp\"\n-\t\"aahframe.work/essentials\"\n+\tess \"aahframe.work/essentials\"\n \t\"aahframe.work/internal/util\"\n \t\"aahframe.work/vfs\"\n )\n@@ -133,6 +133,7 @@ func (s *staticManager) Serve(ctx *Context) error {\n \n \t// Serve directory\n \tif fi.Mode().IsDir() && ctx.route.ListDir {\n+\t\tfmt.Println(\"here 1\")\n \t\t// redirect if the directory name doesn't end in a slash\n \t\tif ctx.Req.Path[len(ctx.Req.Path)-1] != '/' {\n \t\t\tctx.Log().Debugf(\"redirecting to dir: %s\", ctx.Req.Path+\"/\")"
        },
        {
          "filename": "static_test.go",
          "status": "modified",
          "additions": 11,
          "deletions": 9,
          "patch": "@@ -45,15 +45,17 @@ func TestStaticFilesDelivery(t *testing.T) {\n \tassert.Equal(t, \"no-cache, no-store, must-revalidate\", resp.Header.Get(ahttp.HeaderCacheControl))\n \n \t// Directory Listing - /assets\n-\tt.Log(\"Directory Listing - /assets\")\n-\tresp, err = httpClient.Get(ts.URL + \"/assets\")\n-\tassert.Nil(t, err)\n-\tassert.Equal(t, 200, resp.StatusCode)\n-\tbody := responseBody(resp)\n-\tassert.True(t, strings.Contains(body, \"<title>Listing of /assets/</title>\"))\n-\tassert.True(t, strings.Contains(body, \"<h1>Listing of /assets/</h1><hr>\"))\n-\tassert.True(t, strings.Contains(body, `<a href=\"robots.txt\">robots.txt</a>`))\n-\tassert.Equal(t, \"\", resp.Header.Get(ahttp.HeaderCacheControl))\n+\t// t.Log(\"Directory Listing - /assets\")\n+\t// resp, err = httpClient.Get(ts.URL + \"/assets\")\n+\t// fmt.Println(\"err\", err.Error())\n+\t// assert.Nil(t, err)\n+\t// assert.Equal(t, 200, resp.StatusCode)\n+\t// body := responseBody(resp)\n+\t// fmt.Println(\"body\", body)\n+\t// assert.True(t, strings.Contains(body, \"<title>Listing of /assets/</title>\"))\n+\t// assert.True(t, strings.Contains(body, \"<h1>Listing of /assets/</h1><hr>\"))\n+\t// assert.True(t, strings.Contains(body, `<a href=\"robots.txt\">robots.txt</a>`))\n+\t// assert.Equal(t, \"\", resp.Header.Get(ahttp.HeaderCacheControl))\n \n \t// Static File - /assets/img/aah-framework-logo.png\n \tt.Log(\"Static File - /assets/img/aah-framework-logo.png\")"
        },
        {
          "filename": "version.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,4 +5,4 @@\n package aah\n \n // Version no. of aah framework\n-const Version = \"0.12.3\"\n+const Version = \"0.12.4\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f42ff581c627a997425818a51a96d12078f1e539",
            "date": "2020-09-02T02:31:20Z",
            "author_login": "Equanox"
          },
          {
            "sha": "0bf594d222fb08210d22fae6a2dc7e41e80cc390",
            "date": "2020-09-02T02:27:33Z",
            "author_login": "Equanox"
          },
          {
            "sha": "5d93e2913dbfe95a94379074d9558cadd93f3761",
            "date": "2019-10-12T08:09:30Z",
            "author_login": "jeevatkm"
          },
          {
            "sha": "0b83e7ed596437c81acb7cfaf57ba9af11a4114b",
            "date": "2019-10-12T07:57:08Z",
            "author_login": "jeevatkm"
          },
          {
            "sha": "2af68aaeccc8c983f571f154f74246df445197d3",
            "date": "2019-10-10T07:36:34Z",
            "author_login": "jeevatkm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Due to improper sanitization of user input, HTTPEngine.Handle allows for directory traversal, allowing an attacker to read files outside of the target directory that the server has permission to read.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T22:15:11.500",
    "last_modified": "2024-11-21T05:29:50.100",
    "fix_date": "2020-03-03T09:27:03Z"
  },
  "references": [
    {
      "url": "https://github.com/go-aah/aah/commit/881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec",
      "source": "security@golang.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/go-aah/aah/issues/266",
      "source": "security@golang.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/go-aah/aah/pull/267",
      "source": "security@golang.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pkg.go.dev/vuln/GO-2020-0033",
      "source": "security@golang.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/go-aah/aah/commit/881dc9f71d1f7a4e8a9a39df9c5c081d3a2da1ec",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/go-aah/aah/issues/266",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/go-aah/aah/pull/267",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pkg.go.dev/vuln/GO-2020-0033",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.221642",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "aah",
    "owner": "go-aah",
    "created_at": "2016-06-27T04:47:45Z",
    "updated_at": "2025-01-03T21:45:21Z",
    "pushed_at": "2023-02-24T23:21:10Z",
    "size": 2543,
    "stars": 689,
    "forks": 33,
    "open_issues": 19,
    "watchers": 689,
    "has_security_policy": false,
    "default_branch": "edge",
    "protected_branches": [
      "edge",
      "master",
      "v0-edge",
      "v0-unstable"
    ],
    "languages": {
      "Go": 979686
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:27:37.969438"
  }
}