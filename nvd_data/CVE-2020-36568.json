{
  "cve_id": "CVE-2020-36568",
  "github_data": {
    "repository": "revel/revel",
    "fix_commit": "d160ecb72207824005b19778594cbdc272e8a605",
    "related_commits": [
      "d160ecb72207824005b19778594cbdc272e8a605",
      "d160ecb72207824005b19778594cbdc272e8a605"
    ],
    "patch_url": "https://github.com/revel/revel/commit/d160ecb72207824005b19778594cbdc272e8a605.patch",
    "fix_commit_details": {
      "sha": "d160ecb72207824005b19778594cbdc272e8a605",
      "commit_date": "2019-03-09T03:21:44Z",
      "author": {
        "login": "SYM01",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix issue #1424",
        "length": 15,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 17,
        "deletions": 0
      },
      "files": [
        {
          "filename": "binder.go",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -213,6 +213,8 @@ func bindSlice(params *Params, name string, typ reflect.Type) reflect.Value {\n \tnumNoIndex := 0\n \tsliceValues := []sliceValue{}\n \n+\tmaxIndexBound := Config.IntDefault(\"params.max_index\", 4096)\n+\n \t// Factor out the common slice logic (between form values and files).\n \tprocessElement := func(key string, vals []string, files []*multipart.FileHeader) {\n \t\tif !strings.HasPrefix(key, name+\"[\") {\n@@ -229,6 +231,11 @@ func bindSlice(params *Params, name string, typ reflect.Type) reflect.Value {\n \n \t\t// Handle the indexed case.\n \t\tif index > -1 {\n+\t\t\t// Just ignore illegal index, fix issue #1424\n+\t\t\tif index > maxIndexBound {\n+\t\t\t\tbinderLog.Error(\"Ignoring parameter for security reason\", \"index\", index, \"key\", key)\n+\t\t\t\treturn\n+\t\t\t}\n \t\t\tif index > maxIndex {\n \t\t\t\tmaxIndex = index\n \t\t\t}"
        },
        {
          "filename": "binder_test.go",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -7,6 +7,7 @@ package revel\n import (\n \t\"encoding/json\"\n \t\"fmt\"\n+\t\"github.com/revel/config\"\n \t\"io\"\n \t\"io/ioutil\"\n \t\"os\"\n@@ -98,6 +99,8 @@ var (\n \t\t\"invalidArr\":                     {\"xyz\"},\n \t\t\"int8-overflow\":                  {\"1024\"},\n \t\t\"uint8-overflow\":                 {\"1024\"},\n+\t\t\"arrDoS[2]\":                      {\"2\"},\n+\t\t\"arrDoS[65535]\":                  {\"65535\"},\n \t}\n \n \ttestDate     = time.Date(1982, time.July, 9, 0, 0, 0, 0, time.UTC)\n@@ -168,6 +171,7 @@ var binderTestCases = map[string]interface{}{\n \t\"priv\":           A{},\n \t\"int8-overflow\":  int8(0),\n \t\"uint8-overflow\": uint8(0),\n+\t\"arrDoS\":         []int{0, 0, 2},\n }\n \n // Types that files may be bound to, and a func that can read the content from\n@@ -213,6 +217,12 @@ func TestBinder(t *testing.T) {\n \t// Reuse the mvc_test.go multipart request to test the binder.\n \tparams := &Params{}\n \tc := NewTestController(nil, getMultipartRequest())\n+\tif Config == nil {\n+\t\tConfig = config.NewContext()\n+\t\tdefer func() {\n+\t\t\tConfig = nil\n+\t\t}()\n+\t}\n \tParseParams(params, NewRequest(c.Request.In))\n \tparams.Values = ParamTestValues\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b053175279547526fe914932716bc313558df4bd",
            "date": "2022-04-12T20:53:30Z",
            "author_login": "brendensoares"
          },
          {
            "sha": "bc0e27fae428ec38e23fb62cbd4607f64f99e270",
            "date": "2022-04-12T03:41:19Z",
            "author_login": "brendensoares"
          },
          {
            "sha": "d202b9333092280f6ca14be14363653bcd5fa68c",
            "date": "2022-03-06T16:39:27Z",
            "author_login": "notzippy"
          },
          {
            "sha": "859e5b40319fa30943552efb9379f899cf11658b",
            "date": "2022-03-06T16:37:57Z",
            "author_login": "notzippy"
          },
          {
            "sha": "90489b1d0ea48dba84f8b3ed49fd0bd4d710ab36",
            "date": "2022-03-06T16:35:21Z",
            "author_login": "notzippy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-770",
    "description": "Unsanitized input in the query parser in github.com/revel/revel before v1.0.0 allows remote attackers to cause resource exhaustion via memory allocation.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T22:15:11.783",
    "last_modified": "2024-11-21T05:29:51.420",
    "fix_date": "2019-03-09T03:21:44Z"
  },
  "references": [
    {
      "url": "https://github.com/revel/revel/commit/d160ecb72207824005b19778594cbdc272e8a605",
      "source": "security@golang.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/revel/revel/issues/1424",
      "source": "security@golang.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/revel/revel/pull/1427",
      "source": "security@golang.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pkg.go.dev/vuln/GO-2020-0003",
      "source": "security@golang.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/revel/revel/commit/d160ecb72207824005b19778594cbdc272e8a605",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/revel/revel/issues/1424",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/revel/revel/pull/1427",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pkg.go.dev/vuln/GO-2020-0003",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.222385",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "revel",
    "owner": "revel",
    "created_at": "2011-12-09T04:10:26Z",
    "updated_at": "2025-01-13T22:40:31Z",
    "pushed_at": "2023-10-28T20:48:11Z",
    "size": 2827,
    "stars": 13154,
    "forks": 1387,
    "open_issues": 101,
    "watchers": 13154,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "Go": 474369,
      "HTML": 4398
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:49:39.166229"
  }
}