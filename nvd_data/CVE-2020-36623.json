{
  "cve_id": "CVE-2020-36623",
  "github_data": {
    "repository": "jtojnar/pengu",
    "fix_commit": "aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91",
    "related_commits": [
      "aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91",
      "aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91"
    ],
    "patch_url": "https://github.com/jtojnar/pengu/commit/aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91.patch",
    "fix_commit_details": {
      "sha": "aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91",
      "commit_date": "2020-11-02T13:31:56Z",
      "author": {
        "login": "jtojnar",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add origin whitelist",
        "length": 45,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -35,6 +35,7 @@ pengu uses the following environment variables for configuration:\n * `DATABASE_URL` \u2013 [Connection string](https://node-postgres.com/features/connecting/#connection-uri) for the PostgreSQL database. If omitted, persistence will be missing.\n * `NODE_ENV` \u2013 Can be set to `production` for less verbose logs. Defaults to `development`.\n * `OPENID_PROVIDER` \u2013 If this is set, pengu will use OpenID to log-in. Though it only supports using a hardcoded identity specified by this variable. User will be redirected to the provider, where they will confirm their credentials, and then be redirected back to Pengu with an access code. Pengu will then verify the access code against the OpenID verification URL and realm specified by `OPENID_VERIFY`, `OPENID_REALM` environment variables.\n+* `ACCEPTED_ORIGINS` \u2013 comma-separated list of domain names that are allowed to access the WebSockets server. This is necessary to prevent [cross-site request forgery](https://en.wikipedia.org/wiki/WebSocket#Security_considerations). When the environment variable is not set, only `localhost` and `127.0.0.1` will be allowed to connect.\n \n ## Development\n "
        },
        {
          "filename": "src/index.js",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -28,6 +28,8 @@ function findById(arr, id) {\n \treturn null;\n }\n \n+const acceptedOrigins = process.env.ACCEPTED_ORIGINS ? process.env.ACCEPTED_ORIGINS.split(',') : ['localhost', '127.0.0.1'];\n+\n async function runApp() {\n \tlet app = express();\n \n@@ -68,8 +70,9 @@ async function runApp() {\n \t\tautoAcceptConnections: false\n \t});\n \n-\tfunction originIsAllowed() {\n-\t\treturn true;\n+\tfunction originIsAllowed(origin) {\n+\t\tconst url = new URL(origin);\n+\t\treturn acceptedOrigins.includes(url.hostname);\n \t}\n \n \tlet clients = [];"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "29dcc190c0250b6f5268000449cddc54ca65f597",
            "date": "2023-12-20T21:20:14Z",
            "author_login": "jtojnar"
          },
          {
            "sha": "d49f6d19123e80cb0ca35f1eeddf5f7aa85e037f",
            "date": "2023-12-20T21:15:59Z",
            "author_login": "jtojnar"
          },
          {
            "sha": "f3536ed7df29f36f61f06621096351699917d5f9",
            "date": "2023-12-20T21:14:19Z",
            "author_login": "jtojnar"
          },
          {
            "sha": "36178e3604d8d43d8da1971e7c5e2cce0d88317d",
            "date": "2023-12-17T11:04:10Z",
            "author_login": "jtojnar"
          },
          {
            "sha": "537bb1ae491cd2daaa2cf40e024126743e6911b2",
            "date": "2023-12-17T10:47:27Z",
            "author_login": "jtojnar"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-863",
    "description": "A vulnerability was found in Pengu. It has been declared as problematic. Affected by this vulnerability is the function runApp of the file src/index.js. The manipulation leads to cross-site request forgery. The attack can be launched remotely. The name of the patch is aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216475.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-21T19:15:12.227",
    "last_modified": "2024-11-21T05:29:55.100",
    "fix_date": "2020-11-02T13:31:56Z"
  },
  "references": [
    {
      "url": "https://github.com/jtojnar/pengu/commit/aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216475",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/jtojnar/pengu/commit/aea66f12b8cdfc3c8c50ad6a9c89d8307e9d0a91",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216475",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.192793",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pengu",
    "owner": "jtojnar",
    "created_at": "2013-03-28T16:23:46Z",
    "updated_at": "2023-04-09T18:42:38Z",
    "pushed_at": "2023-12-20T22:06:17Z",
    "size": 6413,
    "stars": 2,
    "forks": 1,
    "open_issues": 25,
    "watchers": 2,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 33117,
      "CSS": 3725,
      "Nix": 891,
      "HTML": 754
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:22:33.098227"
  }
}