{
  "cve_id": "CVE-2020-36626",
  "github_data": {
    "repository": "moderntribe/panel-builder",
    "fix_commit": "4528d4f855dbbf24e9fc12a162fda84ce3bedc2f",
    "related_commits": [
      "4528d4f855dbbf24e9fc12a162fda84ce3bedc2f",
      "4528d4f855dbbf24e9fc12a162fda84ce3bedc2f"
    ],
    "patch_url": "https://github.com/moderntribe/panel-builder/commit/4528d4f855dbbf24e9fc12a162fda84ce3bedc2f.patch",
    "fix_commit_details": {
      "sha": "4528d4f855dbbf24e9fc12a162fda84ce3bedc2f",
      "commit_date": "2020-05-08T04:34:11Z",
      "author": {
        "login": "defunctl",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #173 from moderntribe/security/fix-search-xss",
        "length": 80,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "ModularContent/SearchFilter.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -34,8 +34,8 @@ public function add_post_content_filtered_to_search_sql( $sql, $query ) {\n \t\tif ( $query->get( 'panel_search_filter' ) ) {\n \t\t\tglobal $wpdb;\n \t\t\tremove_filter( 'posts_search', array( $this, 'add_post_content_filtered_to_search_sql' ), 1000, 2 );\n-\t\t\t\n-\t\t\t$pattern = \"#OR \\($wpdb->posts.post_content LIKE '(.*?)'\\)#\";\n+\n+\t\t\t$pattern = \"#OR \\($wpdb->posts.post_content LIKE '{(.*?)}'\\)#\";\n \t\t\t$sql = preg_replace_callback( $pattern, array( $this, 'replace_callback' ), $sql );\n \t\t}\n \t\treturn $sql;\n@@ -54,4 +54,4 @@ private function replace_callback( $matches ) {\n \t\t$post_content_filtered = str_replace( $wpdb->posts.'.post_content', $wpdb->posts.'.post_content_filtered', $post_content );\n \t\treturn $post_content.' '.$post_content_filtered;\n \t}\n-}\n\\ No newline at end of file\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d8208805b08062da1df9b8af281b1039b0a4d205",
            "date": "2024-04-09T16:39:08Z",
            "author_login": "dpellenwood"
          },
          {
            "sha": "4fc2164b9fac609d7db6038f029cc3d999a97c58",
            "date": "2024-04-09T16:27:56Z",
            "author_login": "dpellenwood"
          },
          {
            "sha": "6137e141024ad5c8503de348b6f3396841ca89a5",
            "date": "2024-04-09T16:27:00Z",
            "author_login": "dpellenwood"
          },
          {
            "sha": "7b07e78fa1c0ffc4b4f40a44501f64e45f5d465c",
            "date": "2024-04-09T16:25:49Z",
            "author_login": "dpellenwood"
          },
          {
            "sha": "33d74a0b0f1ebfa769b8f38fd1e15a9a60c6316c",
            "date": "2024-04-09T16:18:41Z",
            "author_login": "dpellenwood"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-707",
    "description": "A vulnerability classified as critical has been found in Modern Tribe Panel Builder Plugin. Affected is the function add_post_content_filtered_to_search_sql of the file ModularContent/SearchFilter.php. The manipulation leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The name of the patch is 4528d4f855dbbf24e9fc12a162fda84ce3bedc2f. It is recommended to apply a patch to fix this issue. VDB-216738 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T15:15:11.310",
    "last_modified": "2024-11-21T05:29:55.593",
    "fix_date": "2020-05-08T04:34:11Z"
  },
  "references": [
    {
      "url": "https://github.com/moderntribe/panel-builder/commit/4528d4f855dbbf24e9fc12a162fda84ce3bedc2f",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moderntribe/panel-builder/pull/173",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216738",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moderntribe/panel-builder/commit/4528d4f855dbbf24e9fc12a162fda84ce3bedc2f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moderntribe/panel-builder/pull/173",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216738",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.217078",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "panel-builder",
    "owner": "moderntribe",
    "created_at": "2014-07-08T18:13:06Z",
    "updated_at": "2024-12-12T16:39:08Z",
    "pushed_at": "2024-04-09T16:40:16Z",
    "size": 125707,
    "stars": 10,
    "forks": 4,
    "open_issues": 9,
    "watchers": 10,
    "has_security_policy": false,
    "default_branch": "3.3-branch",
    "protected_branches": [
      "2.0-branch",
      "3.0-branch",
      "3.1-branch",
      "master"
    ],
    "languages": {
      "JavaScript": 301353,
      "PHP": 251226,
      "CSS": 237824,
      "Less": 152341,
      "HTML": 47297,
      "Sass": 11555
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T21:36:11.649538"
  }
}