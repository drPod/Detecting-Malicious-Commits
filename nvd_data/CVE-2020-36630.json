{
  "cve_id": "CVE-2020-36630",
  "github_data": {
    "repository": "FreePBX/cdr",
    "fix_commit": "f1a9eea2dfff30fb99d825bac194a676a82b9ec8",
    "related_commits": [
      "f1a9eea2dfff30fb99d825bac194a676a82b9ec8",
      "f1a9eea2dfff30fb99d825bac194a676a82b9ec8"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f1a9eea2dfff30fb99d825bac194a676a82b9ec8",
      "commit_date": "2020-08-10T06:53:37Z",
      "author": {
        "login": "kguptasangoma",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #20 in FREEPBX/cdr from ~VMISHRA/cdr:bugfix/FREEI-1763-14 to release/14.0",
        "length": 218,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "ucp/Cdr.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -157,13 +157,13 @@ function ajaxHandler() {\n \t\t$return = array(\"status\" => false, \"message\" => \"\");\n \t\tswitch($_REQUEST['command']) {\n \t\t\tcase \"grid\":\n-\t\t\t\t$limit = $_REQUEST['limit'];\n+\t\t\t\t$limit = filter_var($_REQUEST['limit'], FILTER_SANITIZE_NUMBER_INT);\n \t\t\t\t$ext = $_REQUEST['extension'];\n \t\t\t\t$order = $_REQUEST['order'];\n \t\t\t\t$orderby = !empty($_REQUEST['sort']) ? $_REQUEST['sort'] : \"date\";\n \t\t\t\t$search = !empty($_REQUEST['search']) ? $_REQUEST['search'] : \"\";\n \t\t\t\t$pages = $this->cdr->getPages($ext,$search,$limit);\n-\t\t\t\t$offset = $_REQUEST['offset'];\n+\t\t\t\t$offset = filter_var($_REQUEST['offset'], FILTER_SANITIZE_NUMBER_INT);\n \t\t\t\t$page = ($offset / $limit) + 1;\n \t\t\t\t$total = $this->cdr->getTotalCalls($ext,$search);\n \t\t\t\t$data = $this->postProcessCalls($this->cdr->getCalls($ext,$page,$orderby,$order,$search,$limit),$ext);"
        },
        {
          "filename": "views/ucp_config.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -41,7 +41,7 @@\n \t\t\t\t\t<div class=\"col-md-9\">\n \t\t\t\t\t\t<select data-placeholder=\"Extensions\" id=\"ucp_cdr\" class=\"form-control chosenmultiselect ucp-cdr\" name=\"ucp_cdr[]\" multiple=\"multiple\" <?php echo (!is_null($enable) && !$enable) ? \"disabled\" : \"\"?>>\n \t\t\t\t\t\t\t<?php foreach($ausers as $key => $value) {?>\n-\t\t\t\t\t\t\t\t<option value=\"<?php echo $key?>\" <?php echo in_array($key,$cdrassigned) ? 'selected' : '' ?>><?php echo $value?></option>\n+\t\t\t\t\t\t\t\t<option value=\"<?php echo htmlentities($key)?>\" <?php echo in_array($key,$cdrassigned) ? 'selected' : '' ?>><?php echo htmlentities($value)?></option>\n \t\t\t\t\t\t\t<?php } ?>\n \t\t\t\t\t\t</select>\n \t\t\t\t\t</div>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fc6c9b77d085adb753892178470db9f71160de58",
            "date": "2025-01-21T07:06:57Z",
            "author_login": "kguptasangoma"
          },
          {
            "sha": "600029493e659370d7992510090061107a8de231",
            "date": "2025-01-21T05:48:53Z",
            "author_login": "Rverma032"
          },
          {
            "sha": "328f182b93fc73e9a245c90175e1d054f9a8013a",
            "date": "2025-01-15T10:30:26Z",
            "author_login": "kguptasangoma"
          },
          {
            "sha": "5ca0d379532f27ee5aad194968e9c4c54d4153f2",
            "date": "2025-01-15T10:23:06Z",
            "author_login": "prasanthcode4"
          },
          {
            "sha": "c64fda6c3ca356e52b7d6a6e5522a51ab06ae465",
            "date": "2025-01-09T05:57:35Z",
            "author_login": "kguptasangoma"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "A vulnerability was found in FreePBX cdr 14.0. It has been classified as critical. This affects the function ajaxHandler of the file ucp/Cdr.class.php. The manipulation of the argument limit/offset leads to sql injection. Upgrading to version 14.0.5.21 is able to address this issue. The name of the patch is f1a9eea2dfff30fb99d825bac194a676a82b9ec8. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216771.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-25T20:15:25.100",
    "last_modified": "2024-11-21T05:29:56.250",
    "fix_date": "2020-08-10T06:53:37Z"
  },
  "references": [
    {
      "url": "https://github.com/FreePBX/cdr/commit/f1a9eea2dfff30fb99d825bac194a676a82b9ec8",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreePBX/cdr/releases/tag/release%2F14.0.5.21",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216771",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216771",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreePBX/cdr/commit/f1a9eea2dfff30fb99d825bac194a676a82b9ec8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreePBX/cdr/releases/tag/release%2F14.0.5.21",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216771",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216771",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.209532",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "cdr",
    "owner": "FreePBX",
    "created_at": "2014-01-07T20:34:24Z",
    "updated_at": "2025-01-21T07:06:48Z",
    "pushed_at": "2025-01-21T07:06:44Z",
    "size": 7049,
    "stars": 9,
    "forks": 19,
    "open_issues": 0,
    "watchers": 9,
    "has_security_policy": false,
    "default_branch": "release/17.0",
    "protected_branches": [],
    "languages": {
      "PHP": 183100,
      "JavaScript": 11915,
      "Less": 1967
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:05:54.592787"
  }
}