{
  "cve_id": "CVE-2020-36633",
  "github_data": {
    "repository": "eberhardt/moodle-block_sitenews",
    "fix_commit": "cd18d8b1afe464ae6626832496f4e070bac4c58f",
    "related_commits": [
      "cd18d8b1afe464ae6626832496f4e070bac4c58f",
      "cd18d8b1afe464ae6626832496f4e070bac4c58f"
    ],
    "patch_url": "https://github.com/eberhardt/moodle-block_sitenews/commit/cd18d8b1afe464ae6626832496f4e070bac4c58f.patch",
    "fix_commit_details": {
      "sha": "cd18d8b1afe464ae6626832496f4e070bac4c58f",
      "commit_date": "2020-01-10T12:52:53Z",
      "author": {
        "login": "MartinGauk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add CSRF protection to item number setting",
        "length": 42,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "block_sitenews.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -64,7 +64,7 @@ public function get_content() {\n \n         $updatemynumber = optional_param(\"mynewsitems\", -1, PARAM_INT);\n         $displaysetting = block_sitenews_get_itemsnumber();\n-        if ($updatemynumber >= 0 && $updatemynumber < 11) {\n+        if ($updatemynumber >= 0 && $updatemynumber < 11 && confirm_sesskey()) {\n             block_sitenews_update_itemsnumber($updatemynumber);\n             $displaysetting = $items = $updatemynumber;\n         }"
        },
        {
          "filename": "renderer.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -58,6 +58,7 @@ public function editing_bar_head($selected = 0) {\n         $options = range(0,10);\n         $options[0] = get_string(\"preset\", \"block_sitenews\");\n         $select = new single_select($url, \"mynewsitems\", $options, $selected, array());\n+        $select->method = 'post';\n         $select->set_label(get_string(\"newsitemsnumber\") . \":\");\n         $output .= $this->output->render($select);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "74a9288813c1a087a196af5fbd2f4b1f718c9eb6",
            "date": "2020-03-23T16:58:05Z",
            "author_login": "eberhardt"
          },
          {
            "sha": "17eb5476922d25f3028ff0633d0a3dfa33f11201",
            "date": "2020-03-23T08:41:55Z",
            "author_login": "eberhardt"
          },
          {
            "sha": "a5b3860d4bd61af2db2900da46e54a5b1c06bdc3",
            "date": "2020-03-23T08:31:25Z",
            "author_login": "MartinGauk"
          },
          {
            "sha": "872adf18fe375af96b521e97521b151ef7d3d4fb",
            "date": "2020-01-10T14:52:30Z",
            "author_login": "eberhardt"
          },
          {
            "sha": "bb8c5dfb059b3edb1f45d6d32b22ef63550995f9",
            "date": "2020-01-10T14:07:12Z",
            "author_login": "MartinGauk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-352",
    "description": "A vulnerability was found in moodle-block_sitenews 1.0. It has been classified as problematic. This affects the function get_content of the file block_sitenews.php. The manipulation leads to cross-site request forgery. It is possible to initiate the attack remotely. Upgrading to version 1.1 is able to address this issue. The name of the patch is cd18d8b1afe464ae6626832496f4e070bac4c58f. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216879.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T13:15:10.907",
    "last_modified": "2024-11-21T05:29:56.747",
    "fix_date": "2020-01-10T12:52:53Z"
  },
  "references": [
    {
      "url": "https://github.com/eberhardt/moodle-block_sitenews/commit/cd18d8b1afe464ae6626832496f4e070bac4c58f",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eberhardt/moodle-block_sitenews/pull/5",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eberhardt/moodle-block_sitenews/releases/tag/v1.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216879",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216879",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eberhardt/moodle-block_sitenews/commit/cd18d8b1afe464ae6626832496f4e070bac4c58f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eberhardt/moodle-block_sitenews/pull/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eberhardt/moodle-block_sitenews/releases/tag/v1.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.216179",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "moodle-block_sitenews",
    "owner": "eberhardt",
    "created_at": "2014-07-23T15:40:18Z",
    "updated_at": "2020-03-23T16:58:08Z",
    "pushed_at": "2020-03-23T16:58:05Z",
    "size": 41,
    "stars": 0,
    "forks": 1,
    "open_issues": 1,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "stable",
    "protected_branches": [],
    "languages": {
      "PHP": 20554,
      "CSS": 349
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:57:07.086004"
  }
}