{
  "cve_id": "CVE-2020-36635",
  "github_data": {
    "repository": "openmrs/openmrs-module-appointmentscheduling",
    "fix_commit": "34213c3f6ea22df427573076fb62744694f601d8",
    "related_commits": [
      "34213c3f6ea22df427573076fb62744694f601d8",
      "34213c3f6ea22df427573076fb62744694f601d8"
    ],
    "patch_url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/commit/34213c3f6ea22df427573076fb62744694f601d8.patch",
    "fix_commit_details": {
      "sha": "34213c3f6ea22df427573076fb62744694f601d8",
      "commit_date": "2020-06-09T18:50:44Z",
      "author": {
        "login": "isears",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "RA-1772: Fix stored xss is appointment scheduling (#32)",
        "length": 55,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 23,
        "deletions": 1
      },
      "files": [
        {
          "filename": "api/src/main/java/org/openmrs/module/appointmentscheduling/validator/AppointmentTypeValidator.java",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -18,6 +18,7 @@\n import org.openmrs.annotation.Handler;\r\n import org.openmrs.module.appointmentscheduling.AppointmentType;\r\n import org.openmrs.module.appointmentscheduling.api.AppointmentService;\r\n+import org.openmrs.web.WebUtil;\r\n import org.springframework.beans.factory.annotation.Autowired;\r\n import org.springframework.beans.factory.annotation.Qualifier;\r\n import org.springframework.validation.Errors;\r\n@@ -82,6 +83,9 @@ private void validateFieldName(Errors errors, AppointmentType appointmentType) {\n \t\tif (verifyIfNameHasMoreThan100Characters(appointmentType.getName())) {\r\n \t\t\terrors.rejectValue(\"name\", \"appointmentscheduling.AppointmentType.longName.errorMessage\");\r\n \t\t}\r\n+\t\tif(verifyIfNameHasHtmlEncodableChars(appointmentType.getName())){\r\n+\t\t\terrors.rejectValue(\"name\", \"appointmentscheduling.AppointmentType.unsafeName.errorMessage\");\r\n+\t\t}\r\n \t}\r\n \t\r\n \tprivate boolean verifyIfNameHasMoreThan100Characters(String appointmentName) {\r\n@@ -110,5 +114,12 @@ private boolean verifyIfDescriptionHasMoreThan1024Characters(String description)\n \t\t}\r\n \t\treturn false;\r\n \t}\r\n+\r\n+\tprivate boolean verifyIfNameHasHtmlEncodableChars(String appointmentName) {\r\n+\t\tif(appointmentName != null){\r\n+\t\t\treturn !WebUtil.escapeHTML(appointmentName).equals(appointmentName);\r\n+\t\t}\r\n+\t\treturn false;\r\n+\t}\r\n \t\r\n }\r"
        },
        {
          "filename": "api/src/main/resources/messages.properties",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -24,6 +24,7 @@ ${project.parent.artifactId}.AppointmentType.duration.errorMessage = Duration mu\n ${project.parent.artifactId}.AppointmentType.steps.details=Appointment Type Details\n ${project.parent.artifactId}.AppointmentType.nameDuplicated=Name is duplicated\n ${project.parent.artifactId}.AppointmentType.longName.errorMessage= Name must have less than 100 characters\n+${project.parent.artifactId}.AppointmentType.unsafeName.errorMessage= Name must not have HTML characters\n ${project.parent.artifactId}.AppointmentType.description.errorMessage = Description must have less than 1024 characters\n \n ${project.parent.artifactId}.AppointmentBlock.manage.title=Provider Scheduling"
        },
        {
          "filename": "api/src/test/java/org/openmrs/module/appointmentscheduling/validator/AppointmentTypeValidatorTest.java",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -94,7 +94,17 @@ public void mustRejectAppointmentTypeNameWithMoreThan100Characters() throws Exce\n \t\t\r\n \t\tMockito.verify(errors).rejectValue(\"name\", \"appointmentscheduling.AppointmentType.longName.errorMessage\");\r\n \t}\r\n-\t\r\n+\r\n+\t@Test\r\n+\tpublic void mustRejectAppointmentTypeNameWithXSS() throws Exception {\r\n+\t\tString evilName = \"<script>alert(1)</script>\";\r\n+\t\tAppointmentType appointmentTypeEvilName = new AppointmentType(evilName, \"\", 10);\r\n+\r\n+\t\tappointmentTypeValidator.validate(appointmentTypeEvilName, errors);\r\n+\r\n+\t\tMockito.verify(errors).rejectValue(\"name\", \"appointmentscheduling.AppointmentType.unsafeName.errorMessage\");\r\n+\t}\r\n+\r\n \t@Test\r\n \tpublic void mustRejectAppointmentTypeDescriptionWithMoreThan1024Characters() throws Exception {\r\n \t\tString longDescription = StringUtils.repeat(\"*\", 1025);\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "452e1f8a8376b714ae6a2fc46e119c88931795fc",
            "date": "2024-09-20T21:30:17Z",
            "author_login": "openmrs-bot"
          },
          {
            "sha": "719bc247395e80459993c622f2897eb8bd472678",
            "date": "2024-09-20T21:30:15Z",
            "author_login": "openmrs-bot"
          },
          {
            "sha": "c2470d3a98090974b6ba643ff231825a9f3dd181",
            "date": "2024-08-30T11:59:31Z",
            "author_login": "dkayiwa"
          },
          {
            "sha": "8757a6dc861e8b4c667e9d28721d32935c459999",
            "date": "2023-11-09T21:40:46Z",
            "author_login": "dhelms33"
          },
          {
            "sha": "9ba5254998c48c5348869941c3060158eb49db67",
            "date": "2023-09-15T12:59:57Z",
            "author_login": "mseaton"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in OpenMRS Appointment Scheduling Module up to 1.12.x. It has been classified as problematic. This affects the function validateFieldName of the file api/src/main/java/org/openmrs/module/appointmentscheduling/validator/AppointmentTypeValidator.java. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.13.0 is able to address this issue. The name of the patch is 34213c3f6ea22df427573076fb62744694f601d8. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216915.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T23:15:10.430",
    "last_modified": "2024-11-21T05:29:57.083",
    "fix_date": "2020-06-09T18:50:44Z"
  },
  "references": [
    {
      "url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/commit/34213c3f6ea22df427573076fb62744694f601d8",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/pull/32",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/releases/tag/1.13.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216915",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216915",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/commit/34213c3f6ea22df427573076fb62744694f601d8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/pull/32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-appointmentscheduling/releases/tag/1.13.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216915",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216915",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.224321",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "openmrs-module-appointmentscheduling",
    "owner": "openmrs",
    "created_at": "2012-11-22T08:59:50Z",
    "updated_at": "2024-09-20T21:30:20Z",
    "pushed_at": "2024-09-20T21:30:18Z",
    "size": 2727,
    "stars": 14,
    "forks": 75,
    "open_issues": 0,
    "watchers": 14,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 867018,
      "JavaScript": 229614,
      "CSS": 37988,
      "ActionScript": 3273
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:24:18.124144"
  }
}