{
  "cve_id": "CVE-2020-36636",
  "github_data": {
    "repository": "openmrs/openmrs-module-adminui",
    "fix_commit": "702fbfdac7c4418f23bb5f6452482b4a88020061",
    "related_commits": [
      "702fbfdac7c4418f23bb5f6452482b4a88020061",
      "702fbfdac7c4418f23bb5f6452482b4a88020061"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "702fbfdac7c4418f23bb5f6452482b4a88020061",
      "commit_date": "2020-11-23T10:33:47Z",
      "author": {
        "login": "isears",
        "type": "User",
        "stats": {
          "total_commits": 3,
          "average_weekly_commits": 0.00539568345323741,
          "total_additions": 25,
          "total_deletions": 25,
          "weeks_active": 3
        }
      },
      "commit_message": {
        "title": "RA-1865: Fix possible xss in account setup (#57)",
        "length": 48,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 7,
        "deletions": 7
      },
      "files": [
        {
          "filename": "omod/src/main/java/org/openmrs/module/adminui/page/controller/systemadmin/accounts/AccountPageController.java",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -95,7 +95,7 @@ public void get(PageModel model, @MethodParam(\"getAccount\") Account account,\n \t\t\n \t\tsetModelAttributes(model, account, null, accountService, administrationService, providerManagementService, uu, appFrameworkService);\n \t\tif (account.getPerson().getPersonId() == null) {\n-\t\t\tsetJsonFormData(model, account, null);\n+\t\t\tsetJsonFormData(model, account, null, uu);\n \t\t}\n \t}\n \t\n@@ -222,7 +222,7 @@ public String post(PageModel model, @MethodParam(\"getAccount\") @BindParams Accou\n \t\tsendErrorMessage(errors, model, messageSourceService, request);\n \t\t\n \t\tif (account.getPerson().getPersonId() == null) {\n-\t\t\tsetJsonFormData(model, account, otherAccountData);\n+\t\t\tsetJsonFormData(model, account, otherAccountData, uu);\n \t\t}\n \t\t\n \t\treturn \"systemadmin/accounts/account\";\n@@ -410,21 +410,21 @@ private void sendErrorMessage(Errors errors, PageModel model, MessageSourceServi\n \t\trequest.getSession().setAttribute(UiCommonsConstants.SESSION_ATTRIBUTE_ERROR_MESSAGE, errorMessage.toString());\n \t}\n \t\n-\tprivate void setJsonFormData(PageModel model, Account account, OtherAccountData otherAccountData) throws IOException {\n+\tprivate void setJsonFormData(PageModel model, Account account, OtherAccountData otherAccountData, UiUtils uu) throws IOException {\n \t\t\n \t\tObjectMapper mapper = new ObjectMapper();\n \t\tSimpleObject simplePerson = new SimpleObject();\n-\t\tsimplePerson.put(\"familyName\", account.getFamilyName());\n-\t\tsimplePerson.put(\"givenName\", account.getGivenName());\n-\t\tsimplePerson.put(\"gender\", account.getGender() != null ? account.getGender() : \"\");\n+\t\tsimplePerson.put(\"familyName\", uu.encodeHtml(account.getFamilyName()));\n+\t\tsimplePerson.put(\"givenName\", uu.encodeHtml(account.getGivenName()));\n+\t\tsimplePerson.put(\"gender\", uu.encodeHtml(account.getGender()) != null ? uu.encodeHtml(account.getGender()) : \"\");\n \t\tmodel.addAttribute(\"personJson\", mapper.writeValueAsString(simplePerson));\n \t\t\n \t\tSimpleObject simpleUser = new SimpleObject();\n \t\tSimpleObject simpleProvider = new SimpleObject();\n \t\tif (otherAccountData != null) {\n \t\t\tif (otherAccountData.getAddUserAccount()) {\n \t\t\t\tUser u = account.getUserAccounts().get(0);\n-\t\t\t\tsimpleUser.put(\"username\", u.getUsername());\n+\t\t\t\tsimpleUser.put(\"username\", uu.encodeHtml(u.getUsername()));\n \t\t\t\tsimpleUser.put(\"privilegeLevel\", account.getPrivilegeLevel(u).getUuid());\n \t\t\t\tSimpleObject userProperties = new SimpleObject();\n \t\t\t\tuserProperties"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 12
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b0457d8744851c85e9aea2f400f853f71a8d5c12",
            "date": "2023-12-04T14:14:22Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "ee309c525d3c61119c37a659c31d48cbe25120b0",
            "date": "2023-12-04T14:00:02Z",
            "author_login": "wikumChamith"
          },
          {
            "sha": "aa5a241b06b1f1ba965732fd9d5914fe9e5f4d94",
            "date": "2023-11-15T12:59:56Z",
            "author_login": "dkayiwa"
          },
          {
            "sha": "ac7531697f65b787c586dd78ac1629207bc1159d",
            "date": "2023-11-09T13:12:30Z",
            "author_login": "dkayiwa"
          },
          {
            "sha": "36b16e9589e6fcbda14580b7274c6a4012dd9e03",
            "date": "2021-10-02T20:18:24Z",
            "author_login": "openmrs-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic has been found in OpenMRS Admin UI Module up to 1.4.x. Affected is the function sendErrorMessage of the file omod/src/main/java/org/openmrs/module/adminui/page/controller/systemadmin/accounts/AccountPageController.java of the component Account Setup Handler. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.5.0 is able to address this issue. The name of the patch is 702fbfdac7c4418f23bb5f6452482b4a88020061. It is recommended to upgrade the affected component. VDB-216918 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T23:15:10.507",
    "last_modified": "2024-11-21T05:29:57.260",
    "fix_date": "2020-11-23T10:33:47Z"
  },
  "references": [
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/commit/702fbfdac7c4418f23bb5f6452482b4a88020061",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/pull/57",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/releases/tag/1.5.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216918",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216918",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/commit/702fbfdac7c4418f23bb5f6452482b4a88020061",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/pull/57",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/releases/tag/1.5.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216918",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216918",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.224482",
    "processing_status": "enhanced"
  }
}