{
  "cve_id": "CVE-2020-36762",
  "github_data": {
    "repository": "ONSdigital/ras-collection-instrument",
    "fix_commit": "dcaad2540f7d50c512ff2e031d3778dd9337db2b",
    "related_commits": [
      "dcaad2540f7d50c512ff2e031d3778dd9337db2b",
      "dcaad2540f7d50c512ff2e031d3778dd9337db2b"
    ],
    "patch_url": "https://github.com/ONSdigital/ras-collection-instrument/commit/dcaad2540f7d50c512ff2e031d3778dd9337db2b.patch",
    "fix_commit_details": {
      "sha": "dcaad2540f7d50c512ff2e031d3778dd9337db2b",
      "commit_date": "2020-12-07T14:41:41Z",
      "author": {
        "login": "mfcrocker",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix bash injection vulnerability (#199)",
        "length": 207,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": ".github/workflows/comment.yml",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -16,8 +16,10 @@ jobs:\n     if: contains(github.event.comment.body, '/deploy')\n     steps:\n       - name: set namespace\n+        env:\n+          COMMENT_BODY: ${{ github.event.comment.body }}\n         run: |\n-          echo NAMESPACE=$(echo ${{ github.event.comment.body }} | cut -d' ' -f2) >> $GITHUB_ENV\n+          echo NAMESPACE=$(echo $COMMENT_BODY | cut -d' ' -f2) >> $GITHUB_ENV\n \n       - uses: GoogleCloudPlatform/github-actions/setup-gcloud@master\n         with:"
        },
        {
          "filename": "_infra/helm/collection-instrument/Chart.yaml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,4 +18,4 @@ version: 1.1.2\n \n # This is the version number of the application being deployed. This version number should be\n # incremented each time you make changes to the application.\n-appVersion: 2.0.27\n+appVersion: 2.0.28"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b2b73f7a17b550487f6fcd75620cbbed615a142c",
            "date": "2024-11-08T11:49:57Z",
            "author_login": "anwilkie"
          },
          {
            "sha": "e5f77a4572490868a2ff8038f90c9fe513524943",
            "date": "2024-11-05T14:56:04Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "f0106a282d9099b7fcd961c0e37ed911e2d44286",
            "date": "2024-10-25T10:00:45Z",
            "author_login": "anwilkie"
          },
          {
            "sha": "c7435dc873975e2a7c73f864054f7a341972c1ae",
            "date": "2024-08-20T14:38:11Z",
            "author_login": "arroyoAle"
          },
          {
            "sha": "2e2842486d941f1eeb585aa5e765b2ed16e8ee64",
            "date": "2024-08-15T09:20:22Z",
            "author_login": "arroyoAle"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-78",
    "description": "A vulnerability was found in ONS Digital RAS Collection Instrument up to 2.0.27 and classified as critical. Affected by this issue is the function jobs of the file .github/workflows/comment.yml. The manipulation of the argument $COMMENT_BODY leads to os command injection. Upgrading to version 2.0.28 is able to address this issue. The name of the patch is dcaad2540f7d50c512ff2e031d3778dd9337db2b. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-234248.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-18T15:15:11.133",
    "last_modified": "2024-11-21T05:30:15.013",
    "fix_date": "2020-12-07T14:41:41Z"
  },
  "references": [
    {
      "url": "https://github.com/ONSdigital/ras-collection-instrument/commit/dcaad2540f7d50c512ff2e031d3778dd9337db2b",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ONSdigital/ras-collection-instrument/pull/199",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ONSdigital/ras-collection-instrument/releases/tag/2.0.28",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.234248",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.234248",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/ONSdigital/ras-collection-instrument/commit/dcaad2540f7d50c512ff2e031d3778dd9337db2b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ONSdigital/ras-collection-instrument/pull/199",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ONSdigital/ras-collection-instrument/releases/tag/2.0.28",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.234248",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.234248",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.252483",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ras-collection-instrument",
    "owner": "ONSdigital",
    "created_at": "2017-02-16T11:21:51Z",
    "updated_at": "2024-11-08T11:50:00Z",
    "pushed_at": "2025-01-14T15:01:41Z",
    "size": 4177,
    "stars": 3,
    "forks": 1,
    "open_issues": 3,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 147649,
      "HTML": 1408,
      "Makefile": 527,
      "Mako": 494,
      "Dockerfile": 361
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T20:16:44.214264"
  }
}