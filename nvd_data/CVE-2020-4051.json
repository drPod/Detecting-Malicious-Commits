{
  "cve_id": "CVE-2020-4051",
  "github_data": {
    "repository": "dojo/dijit",
    "fix_commit": "462bdcd60d0333315fe69ab4709c894d78f61301",
    "related_commits": [
      "462bdcd60d0333315fe69ab4709c894d78f61301",
      "462bdcd60d0333315fe69ab4709c894d78f61301"
    ],
    "patch_url": "https://github.com/dojo/dijit/commit/462bdcd60d0333315fe69ab4709c894d78f61301.patch",
    "fix_commit_details": {
      "sha": "462bdcd60d0333315fe69ab4709c894d78f61301",
      "commit_date": "2020-06-13T12:02:38Z",
      "author": {
        "login": "msssk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-cxjc-r2fp-7mq6",
        "length": 886,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 59,
        "additions": 56,
        "deletions": 3
      },
      "files": [
        {
          "filename": "_editor/plugins/LinkDialog.js",
          "status": "modified",
          "additions": 36,
          "deletions": 3,
          "patch": "@@ -1,5 +1,6 @@\n define([\n \t\"require\",\n+\t\"dojo/_base/array\",\n \t\"dojo/_base/declare\", // declare\n \t\"dojo/dom-attr\", // domAttr.get\n \t\"dojo/keys\", // keys.ENTER\n@@ -11,7 +12,7 @@ define([\n \t\"../_Plugin\",\n \t\"../../form/DropDownButton\",\n \t\"../range\"\n-], function(require, declare, domAttr, keys, lang, on, has, query, string,\n+], function(require, array, declare, domAttr, keys, lang, on, has, query, string,\n \t_Plugin, DropDownButton, rangeapi){\n \n \t// module:\n@@ -26,6 +27,21 @@ define([\n \t\t//\n \t\t//\t\t- createLink\n \n+\t\t// allowUnsafeHtml: boolean\n+\t\t//\t\tIf false (default), the link description will be filtered to prevent HTML content.\n+\t\t//\t\tIf true no filtering is done, allowing for HTML content within the link element.\n+\t\t//\t\tThe filter can be specified with the 'linkFilter' option.\n+\t\tallowUnsafeHtml: false,\n+\n+\t\t// linkFilter: function or array of replacement pairs\n+\t\t//\t\tIf 'allowUnsafeHtml' is false then this filter will be applied to the link Description value.\n+\t\t//\t\tfunction: the function will be invoked with the string value of the Description field and its\n+\t\t//\t\t\treturn value will be used\n+\t\t//\t\tarray: each array item should be an array of two values to pass to String#replace\n+\t\tlinkFilter: [\n+\t\t\t[/</g, \"&lt;\"]\n+\t\t],\n+\n \t\t// Override _Plugin.buttonClass.   This plugin is controlled by a DropDownButton\n \t\t// (which triggers a TooltipDialog).\n \t\tbuttonClass: DropDownButton,\n@@ -252,6 +268,16 @@ define([\n \t\t\tif(args && args.urlInput){\n \t\t\t\targs.urlInput = args.urlInput.replace(/\"/g, \"&quot;\");\n \t\t\t}\n+\t\t\tif(!this.allowUnsafeHtml && args && args.textInput){\n+\t\t\t\tif(typeof this.linkFilter === 'function'){\n+\t\t\t\t\targs.textInput = this.linkFilter(args.textInput);\n+\t\t\t\t}\n+\t\t\t\telse{\n+\t\t\t\t\tarray.forEach(this.linkFilter, function (currentFilter) {\n+\t\t\t\t\t\targs.textInput = args.textInput.replace(currentFilter[0], currentFilter[1]);\n+\t\t\t\t\t});\n+\t\t\t\t}\n+\t\t\t}\n \t\t\treturn args;\n \t\t},\n \n@@ -629,8 +655,15 @@ define([\n \t});\n \n \t// Register these plugins\n-\t_Plugin.registry[\"createLink\"] = function(){\n-\t\treturn new LinkDialog({command: \"createLink\"});\n+\t_Plugin.registry[\"createLink\"] = function(args){\n+\t\tvar pluginOptions = {\n+\t\t\tcommand: \"createLink\",\n+\t\t\tallowUnsafeHtml: (\"allowUnsafeHtml\" in args) ? args.allowUnsafeHtml : false\n+\t\t};\n+\t\tif(\"linkFilter\" in args){\n+\t\t\tpluginOptions.linkFilter = args.linkFilter;\n+\t\t}\n+\t\treturn new LinkDialog(pluginOptions);\n \t};\n \t_Plugin.registry[\"insertImage\"] = function(){\n \t\treturn new ImgLinkDialog({command: \"insertImage\"});"
        },
        {
          "filename": "tests/editor/test_LinkDialog.html",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -7,6 +7,10 @@\n \t<script type=\"text/javascript\" src=\"../boilerplate.js\"></script>\n \n \t<script type=\"text/javascript\">\n+\t\tfunction filterLink () {\n+\t\t\treturn 'Filtered Value';\n+\t\t}\n+\n \t\trequire([\n \t\t\t\"dojo/parser\",\n \t\t\t\"dijit/Editor\",\n@@ -36,6 +40,22 @@\n \t\t</div>\n \t</div>\n \n+\t<p>Editor with <code>allowUnsafeHtml</code> set to <code>true</code></p>\n+\t<div style=\"border: 1px dotted black;\">\n+\t\t<div id=\"editorUnsafe\" data-dojo-type=\"dijit/Editor\" data-dojo-props='\"aria-label\":\"editor\",extraPlugins:[{name: \"createLink\", allowUnsafeHtml: true}, \"insertImage\", \"viewSource\"]'>\n+\t\t\t<p>This editor will allow unrestricted HTML in the Description field of links</p>\n+\t\t\t<br>\n+\t\t</div>\n+\t</div>\n+\n+\t<p>Editor with custom <code>linkFilter</code> function</p>\n+\t<div style=\"border: 1px dotted black;\">\n+\t\t<div id=\"editorLinkFilter\" data-dojo-type=\"dijit/Editor\" data-dojo-props='\"aria-label\":\"editor\",extraPlugins:[{name: \"createLink\", linkFilter: filterLink}, \"insertImage\", \"viewSource\"]'>\n+\t\t\t<p>Links created in this editor will always have a description of \"Filtered Value\", which is the value returned by the custom <code>linkFilter</code> function.</p>\n+\t\t\t<br>\n+\t\t</div>\n+\t</div>\n+\n \t<p>RTL Editor:</p>\n \t<div style=\"border: 1px dotted black;\">\n \t\t<div id=\"reditor\" data-dojo-type=\"dijit/Editor\" dir=\"rtl\" data-dojo-props='\"aria-label\":\"reditor\",extraPlugins:[\"createLink\", \"insertImage\"]'>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8ab4cdc2e4bb03d1bca6e76a2a9179dc8c5d846a",
            "date": "2022-08-24T15:06:38Z",
            "author_login": "xmedeko"
          },
          {
            "sha": "448e474ea80388fbd9d37087ca97e9d775eccec3",
            "date": "2022-07-05T15:51:09Z",
            "author_login": "schallm"
          },
          {
            "sha": "e2125fe56ce161ff0d13d7ea33bfe8b8895bc032",
            "date": "2022-03-01T23:57:44Z",
            "author_login": "ehuelsmann"
          },
          {
            "sha": "57403876531902cbbbad28b547c44fe8f8121792",
            "date": "2022-02-20T14:25:45Z",
            "author_login": "dylans"
          },
          {
            "sha": "7d7883d3f32525850d717e99eb2627f9f7878f89",
            "date": "2022-02-20T14:25:44Z",
            "author_login": "dylans"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "In Dijit before versions 1.11.11, and greater than or equal to 1.12.0 and less than 1.12.9, and greater than or equal to 1.13.0 and less than 1.13.8, and greater than or equal to 1.14.0 and less than 1.14.7, and greater than or equal to 1.15.0 and less than 1.15.4, and greater than or equal to 1.16.0 and less than 1.16.3, there is a cross-site scripting vulnerability in the Editor's LinkDialog plugin. This has been fixed in 1.11.11, 1.12.9, 1.13.8, 1.14.7, 1.15.4, 1.16.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-06-15T22:15:09.973",
    "last_modified": "2024-11-21T05:32:13.663",
    "fix_date": "2020-06-13T12:02:38Z"
  },
  "references": [
    {
      "url": "https://github.com/dojo/dijit/commit/462bdcd60d0333315fe69ab4709c894d78f61301",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dojo/dijit/security/advisories/GHSA-cxjc-r2fp-7mq6",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/01/msg00030.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20201023-0003/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2020.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dojo/dijit/commit/462bdcd60d0333315fe69ab4709c894d78f61301",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dojo/dijit/security/advisories/GHSA-cxjc-r2fp-7mq6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/01/msg00030.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20201023-0003/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.854459",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dijit",
    "owner": "dojo",
    "created_at": "2013-05-19T19:50:33Z",
    "updated_at": "2025-01-01T05:33:09Z",
    "pushed_at": "2022-08-25T13:07:39Z",
    "size": 30224,
    "stars": 175,
    "forks": 187,
    "open_issues": 14,
    "watchers": 175,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 3024852,
      "JavaScript": 1581019,
      "CSS": 363789,
      "Less": 132842,
      "PHP": 22297,
      "Roff": 228
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:23:08.365904"
  }
}