{
  "cve_id": "CVE-2020-4068",
  "github_data": {
    "repository": "kylebrowning/APNSwift",
    "fix_commit": "97fa7f69dcdd89168fff84e0ba8f999881ee3d3f",
    "related_commits": [
      "97fa7f69dcdd89168fff84e0ba8f999881ee3d3f",
      "97fa7f69dcdd89168fff84e0ba8f999881ee3d3f"
    ],
    "patch_url": "https://github.com/kylebrowning/APNSwift/commit/97fa7f69dcdd89168fff84e0ba8f999881ee3d3f.patch",
    "fix_commit_details": {
      "sha": "97fa7f69dcdd89168fff84e0ba8f999881ee3d3f",
      "commit_date": "2019-07-23T17:27:07Z",
      "author": {
        "login": "kylebrowning",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Resolves memory issue (#32)",
        "length": 43,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 4,
        "deletions": 7
      },
      "files": [
        {
          "filename": "Sources/APNSwift/APNSwiftSigner.swift",
          "status": "modified",
          "additions": 4,
          "deletions": 7,
          "patch": "@@ -36,9 +36,9 @@ public struct APNSwiftSigner {\n         let bio = BIO_new(BIO_s_mem())\n         defer { BIO_free(bio) }\n         let res = buffer.withUnsafeReadableBytes { ptr in\n-            Int(BIO_puts(bio, ptr.baseAddress?.assumingMemoryBound(to: Int8.self)))\n+            BIO_write(bio, ptr.baseAddress, CInt(ptr.count))\n         }\n-        assert(res >= 0, \"BIO_puts failed\")\n+        assert(res >= 0, \"BIO_write failed\")\n \n         guard let opaquePointer = OpaquePointer.make(optional: PEM_read_bio_ECPrivateKey(bio!, nil, nil, nil)) else {\n             throw APNSwiftError.SigningError.invalidAuthKey\n@@ -50,17 +50,14 @@ public struct APNSwiftSigner {\n         }\n         defer { ECDSA_SIG_free(sig) }\n \n-        var derEncodedSignature: UnsafeMutablePointer<UInt8>?\n+        var derEncodedSignature: UnsafeMutablePointer<CUnsignedChar>?\n         let derLength = i2d_ECDSA_SIG(sig, &derEncodedSignature)\n         guard let derCopy = derEncodedSignature, derLength > 0 else {\n             throw APNSwiftError.SigningError.invalidASN1\n         }\n \n         var derBytes = ByteBufferAllocator().buffer(capacity: Int(derLength))\n-        for b in 0 ..< Int(derLength) {\n-            derBytes.writeBytes([derCopy[b]])\n-        }\n-\n+        derBytes.writeBytes(UnsafeBufferPointer<CUnsignedChar>(start: derCopy, count: Int(derLength)))\n         return derBytes\n     }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "cc8c715763908750b9155928796a8a981688e4fc",
            "date": "2024-10-05T15:01:20Z",
            "author_login": "fpseverino"
          },
          {
            "sha": "ce6ceaae2b97fe422b1e4e2a5405051fe5a29a69",
            "date": "2024-10-05T15:01:04Z",
            "author_login": "kylebrowning"
          },
          {
            "sha": "a53fce249bfc43a79c7aa4c5c77d7f7e6a44a9a0",
            "date": "2024-09-22T14:15:35Z",
            "author_login": "fpseverino"
          },
          {
            "sha": "9b5032e62bca132041f55d66e62ba3d5799a4427",
            "date": "2024-08-21T14:33:04Z",
            "author_login": "kylebrowning"
          },
          {
            "sha": "fe9a00cabbe4fff490b7e4dfc9309375ecc9142d",
            "date": "2024-08-20T19:05:19Z",
            "author_login": "mash3l777"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-122",
    "description": "In APNSwift 1.0.0, calling APNSwiftSigner.sign(digest:) is likely to result in a heap buffer overflow. This has been fixed in 1.0.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-06-22T16:15:11.870",
    "last_modified": "2024-11-21T05:32:14.930",
    "fix_date": "2019-07-23T17:27:07Z"
  },
  "references": [
    {
      "url": "https://github.com/kylebrowning/APNSwift/commit/97fa7f69dcdd89168fff84e0ba8f999881ee3d3f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/issues/31",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/pull/32",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/security/advisories/GHSA-qh2w-vjxg-mjcg",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/commit/97fa7f69dcdd89168fff84e0ba8f999881ee3d3f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/issues/31",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/pull/32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/kylebrowning/APNSwift/security/advisories/GHSA-qh2w-vjxg-mjcg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:47.866379",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "APNSwift",
    "owner": "kylebrowning",
    "created_at": "2019-02-05T19:17:33Z",
    "updated_at": "2025-01-13T03:24:00Z",
    "pushed_at": "2024-10-06T15:40:19Z",
    "size": 514,
    "stars": 713,
    "forks": 106,
    "open_issues": 4,
    "watchers": 713,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Swift": 249643,
      "Shell": 1831,
      "Dockerfile": 305
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T17:21:18.931240"
  }
}