{
  "cve_id": "CVE-2020-5223",
  "github_data": {
    "repository": "PrivateBin/PrivateBin",
    "fix_commit": "8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6",
    "related_commits": [
      "8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6",
      "8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6"
    ],
    "patch_url": "https://github.com/PrivateBin/PrivateBin/commit/8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6.patch",
    "fix_commit_details": {
      "sha": "8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6",
      "commit_date": "2019-12-25T08:14:32Z",
      "author": {
        "login": "elrido",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "addressing jsverifyRngState 8b8f0d4ec2a67139b5, fixes HTML injection via filename, closes #554",
        "length": 94,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 11,
        "deletions": 6
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -4,6 +4,7 @@\n     * ADDED: Translation for Ukrainian (#533)\n     * ADDED: Option to send a mail with the link, when creating a paste (#398)\n     * ADDED: Add support for CONFIG_PATH environment variable (#552)\n+    * FIXED: HTML injection via unescaped attachment filename (#554)\n     * FIXED: Password disabling option (#527)\n   * **1.3.1 (2019-09-22)**\n     * ADDED: Translation for Bulgarian (#455)"
        },
        {
          "filename": "js/privatebin.js",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -2795,8 +2795,12 @@ jQuery.PrivateBin = (function($, RawDeflate) {\n             // move elemement to new place\n             $attachmentLink.appendTo($element);\n \n-            // update text\n-            I18n._($attachmentLink, label, $attachmentLink.attr('download'));\n+            // update text - ensuring no HTML is inserted into the text node\n+            I18n._(\n+                $attachmentLink,\n+                $('<div />').text(label).html(),\n+                $('<div />').text($attachmentLink.attr('download')).html()\n+            );\n         };\n \n         /**"
        },
        {
          "filename": "js/test/AttachmentViewer.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -25,7 +25,7 @@ describe('AttachmentViewer', function () {\n                         mimeType.match(/\\/pdf/i)\n                     ),\n                     results = [];\n-                prefix = prefix.replace(/%(s|d)/g, '%%');\n+                prefix  = prefix.replace(/%(s|d)/g, '%%');\n                 postfix = postfix.replace(/%(s|d)/g, '%%');\n                 $('body').html(\n                     '<div id=\"attachment\" role=\"alert\" class=\"hidden alert ' +\n@@ -90,7 +90,7 @@ describe('AttachmentViewer', function () {\n                     results.push(\n                         element.children()[0].href === data &&\n                         element.children()[0].getAttribute('download') === filename &&\n-                        element.children()[0].text === prefix + filename + postfix\n+                        element.children()[0].text === $('<div />').text(prefix + filename + postfix).html()\n                     );\n                 } else {\n                     results.push(element.children()[0].href === data);"
        },
        {
          "filename": "tpl/bootstrap.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -72,7 +72,7 @@\n ?>\n \t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/purify-2.0.7.js\" integrity=\"sha512-XjNEK1xwh7SJ/7FouwV4VZcGW9cMySL3SwNpXgrURLBcXXQYtZdqhGoNdEwx9vwLvFjUGDQVNgpOrTsXlSTiQg==\" crossorigin=\"anonymous\"></script>\n \t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/legacy.js?<?php echo rawurlencode($VERSION); ?>\" integrity=\"sha512-LYos+qXHIRqFf5ZPNphvtTB0cgzHUizu2wwcOwcwz/VIpRv9lpcBgPYz4uq6jx0INwCAj6Fbnl5HoKiLufS2jg==\" crossorigin=\"anonymous\"></script>\n-\t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/privatebin.js?<?php echo rawurlencode($VERSION); ?>\" integrity=\"sha512-Bppv5Tt3fBwlJMQaL3ktLhrCNKZQwWo9ox4A/CAXiUs3rQLjfPSuEVViyuYy11e9oOaTKrMb7ejrkwDjhK1NmA==\" crossorigin=\"anonymous\"></script>\n+\t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/privatebin.js?<?php echo rawurlencode($VERSION); ?>\" integrity=\"sha512-HxU8g6MFviBCv6fEKEL+bn0fICxg9++ZUxxqySWXkX4iGgLodH/OVZDfr3dgKK5vZAv+0niWLuf+CWZ+/gUwWw==\" crossorigin=\"anonymous\"></script>\n \t\t<link rel=\"apple-touch-icon\" href=\"img/apple-touch-icon.png?<?php echo rawurlencode($VERSION); ?>\" sizes=\"180x180\" />\n \t\t<link rel=\"icon\" type=\"image/png\" href=\"img/favicon-32x32.png?<?php echo rawurlencode($VERSION); ?>\" sizes=\"32x32\" />\n \t\t<link rel=\"icon\" type=\"image/png\" href=\"img/favicon-16x16.png?<?php echo rawurlencode($VERSION); ?>\" sizes=\"16x16\" />"
        },
        {
          "filename": "tpl/page.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -50,7 +50,7 @@\n ?>\n \t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/purify-2.0.7.js\" integrity=\"sha512-XjNEK1xwh7SJ/7FouwV4VZcGW9cMySL3SwNpXgrURLBcXXQYtZdqhGoNdEwx9vwLvFjUGDQVNgpOrTsXlSTiQg==\" crossorigin=\"anonymous\"></script>\n \t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/legacy.js?<?php echo rawurlencode($VERSION); ?>\" integrity=\"sha512-LYos+qXHIRqFf5ZPNphvtTB0cgzHUizu2wwcOwcwz/VIpRv9lpcBgPYz4uq6jx0INwCAj6Fbnl5HoKiLufS2jg==\" crossorigin=\"anonymous\"></script>\n-\t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/privatebin.js?<?php echo rawurlencode($VERSION); ?>\" integrity=\"sha512-Bppv5Tt3fBwlJMQaL3ktLhrCNKZQwWo9ox4A/CAXiUs3rQLjfPSuEVViyuYy11e9oOaTKrMb7ejrkwDjhK1NmA==\" crossorigin=\"anonymous\"></script>\n+\t\t<script type=\"text/javascript\" data-cfasync=\"false\" src=\"js/privatebin.js?<?php echo rawurlencode($VERSION); ?>\" integrity=\"sha512-HxU8g6MFviBCv6fEKEL+bn0fICxg9++ZUxxqySWXkX4iGgLodH/OVZDfr3dgKK5vZAv+0niWLuf+CWZ+/gUwWw==\" crossorigin=\"anonymous\"></script>\n \t\t<link rel=\"apple-touch-icon\" href=\"img/apple-touch-icon.png?<?php echo rawurlencode($VERSION); ?>\" sizes=\"180x180\" />\n \t\t<link rel=\"icon\" type=\"image/png\" href=\"img/favicon-32x32.png?<?php echo rawurlencode($VERSION); ?>\" sizes=\"32x32\" />\n \t\t<link rel=\"icon\" type=\"image/png\" href=\"img/favicon-16x16.png?<?php echo rawurlencode($VERSION); ?>\" sizes=\"16x16\" />"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e27e3ace1637b2e03721396e0ab1509d2eaea87d",
            "date": "2025-01-11T19:37:50Z",
            "author_login": "elrido"
          },
          {
            "sha": "c27c18faf9abd69ba93c56db2379d97780eb1c01",
            "date": "2025-01-11T19:29:03Z",
            "author_login": "elrido"
          },
          {
            "sha": "4b31528fed1ee76b4d5b0fd782155d3114c7148e",
            "date": "2025-01-11T12:22:18Z",
            "author_login": "elrido"
          },
          {
            "sha": "48eb6ef87abe7ee8308182f65e4d4040cb28a113",
            "date": "2025-01-10T14:23:04Z",
            "author_login": "Ribas160"
          },
          {
            "sha": "863c5b320e801178969b5bc64832c7a6f9aeacce",
            "date": "2025-01-09T06:52:26Z",
            "author_login": "elrido"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "In PrivateBin versions 1.2.0 before 1.2.2, and 1.3.0 before 1.3.2, a persistent XSS attack is possible. Under certain conditions, a user provided attachment file name can inject HTML leading to a persistent Cross-site scripting (XSS) vulnerability. The vulnerability has been fixed in PrivateBin v1.3.2 & v1.2.2. Admins are urged to upgrade to these versions to protect the affected users.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-01-23T02:15:13.423",
    "last_modified": "2024-11-21T05:33:42.673",
    "fix_date": "2019-12-25T08:14:32Z"
  },
  "references": [
    {
      "url": "https://github.com/PrivateBin/PrivateBin/commit/8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/PrivateBin/PrivateBin/issues/554",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrivateBin/PrivateBin/security/advisories/GHSA-8j72-p2wm-6738",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://privatebin.info/news/v1.3.2-v1.2.2-release.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/PrivateBin/PrivateBin/commit/8d0ac336d23cd8c98e71d5f21cdadcae9c8a26e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/PrivateBin/PrivateBin/issues/554",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrivateBin/PrivateBin/security/advisories/GHSA-8j72-p2wm-6738",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://privatebin.info/news/v1.3.2-v1.2.2-release.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:37.483245",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PrivateBin",
    "owner": "PrivateBin",
    "created_at": "2016-07-09T07:03:25Z",
    "updated_at": "2025-01-14T11:09:42Z",
    "pushed_at": "2025-01-11T19:38:03Z",
    "size": 14665,
    "stars": 6762,
    "forks": 839,
    "open_issues": 109,
    "watchers": 6762,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 501666,
      "JavaScript": 383443,
      "CSS": 186439,
      "Makefile": 2181,
      "Shell": 260,
      "Procfile": 35
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:34:40.209491"
  }
}