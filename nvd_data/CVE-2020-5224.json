{
  "cve_id": "CVE-2020-5224",
  "github_data": {
    "repository": "jazzband/django-user-sessions",
    "fix_commit": "f0c4077e7d1436ba6d721af85cee89222ca5d2d9",
    "related_commits": [
      "f0c4077e7d1436ba6d721af85cee89222ca5d2d9",
      "f0c4077e7d1436ba6d721af85cee89222ca5d2d9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f0c4077e7d1436ba6d721af85cee89222ca5d2d9",
      "commit_date": "2020-01-24T14:14:29Z",
      "author": {
        "login": "Bouke",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Don't expose session keys in views",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 1,
        "deletions": 12
      },
      "files": [
        {
          "filename": "tests/tests.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -88,8 +88,8 @@ def test_list(self):\n                                      user_agent='Firefox')\n         response = self.client.get(reverse('user_sessions:session_list'))\n         self.assertContains(response, 'Active Sessions')\n-        self.assertContains(response, 'End Session', 3)\n         self.assertContains(response, 'Firefox')\n+        self.assertNotContains(response, 'ABC123')\n \n     def test_delete(self):\n         session_key = self.client.cookies[settings.SESSION_COOKIE_NAME].value"
        },
        {
          "filename": "user_sessions/templates/user_sessions/session_list.html",
          "status": "modified",
          "additions": 0,
          "deletions": 11,
          "patch": "@@ -13,7 +13,6 @@ <h1>{% trans \"Active Sessions\" %}</h1>\n         <th>{% trans \"Location\" %}</th>\n         <th>{% trans \"Device\" %}</th>\n         <th>{% trans \"Last Activity\" %}</th>\n-        <th>{% trans \"End Session\" %}</th>\n       </tr>\n     </thead>\n     {% for object in object_list %}\n@@ -27,16 +26,6 @@ <h1>{% trans \"Active Sessions\" %}</h1>\n             {% blocktrans with time=object.last_activity|timesince %}{{ time }} ago{% endblocktrans %}\n           {% endif %}\n         </td>\n-        <td>\n-          <form method=\"post\" action=\"{% url 'user_sessions:session_delete' object.pk %}\">\n-            {% csrf_token %}\n-            {% if object.session_key == session_key %}\n-              <button type=\"submit\" class=\"btn btn-xs btn-link\">{% trans \"End Session\" %}</button>\n-            {% else %}\n-              <button type=\"submit\" class=\"btn btn-xs btn-warning\">{% trans \"End Session\" %}</button>\n-            {% endif %}\n-          </form>\n-        </td>\n       </tr>\n     {% endfor %}\n   </table>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6fc87ced61d7cc59213d459f32d04097e11e696a",
            "date": "2024-02-21T02:00:39Z",
            "author_login": "ataylor32"
          },
          {
            "sha": "e2bf17e69e2d5bbbacd94761ea994d0fdecd7a04",
            "date": "2024-03-12T22:02:35Z",
            "author_login": "mbeijen"
          },
          {
            "sha": "84534ecb32a538986f068164d1dd98d47a2f65e8",
            "date": "2024-03-12T22:01:31Z",
            "author_login": "mbeijen"
          },
          {
            "sha": "fccea08c270f4f8db5e47ecd28ab7b18da0a4d32",
            "date": "2024-03-12T21:42:14Z",
            "author_login": "mbeijen"
          },
          {
            "sha": "5f5a61e11c5412e9b1edb5f1e2c42c72174e1dac",
            "date": "2024-03-12T20:23:27Z",
            "author_login": "pre-commit-ci[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:L/A:N",
    "cwe_id": "CWE-287",
    "description": "In Django User Sessions (django-user-sessions) before 1.7.1, the views provided allow users to terminate specific sessions. The session key is used to identify sessions, and thus included in the rendered HTML. In itself this is not a problem. However if the website has an XSS vulnerability, the session key could be extracted by the attacker and a session takeover could happen.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2020-01-24T20:15:10.720",
    "last_modified": "2024-11-21T05:33:42.787",
    "fix_date": "2020-01-24T14:14:29Z"
  },
  "references": [
    {
      "url": "https://github.com/Bouke/django-user-sessions/security/advisories/GHSA-5fq8-3q2f-4m5g",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jazzband/django-user-sessions/commit/f0c4077e7d1436ba6d721af85cee89222ca5d2d9",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Bouke/django-user-sessions/security/advisories/GHSA-5fq8-3q2f-4m5g",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jazzband/django-user-sessions/commit/f0c4077e7d1436ba6d721af85cee89222ca5d2d9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:37.487257",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "django-user-sessions",
    "owner": "jazzband",
    "created_at": "2013-11-13T22:39:25Z",
    "updated_at": "2025-01-15T21:29:47Z",
    "pushed_at": "2025-01-20T17:37:45Z",
    "size": 414,
    "stars": 646,
    "forks": 130,
    "open_issues": 33,
    "watchers": 646,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 61867,
      "HTML": 3279,
      "Perl": 2763,
      "Makefile": 1001,
      "Dockerfile": 126
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:46:27.966704"
  }
}