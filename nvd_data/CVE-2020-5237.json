{
  "cve_id": "CVE-2020-5237",
  "github_data": {
    "repository": "1up-lab/OneupUploaderBundle",
    "fix_commit": "a6011449b716f163fe1ae323053077e59212350c",
    "related_commits": [
      "a6011449b716f163fe1ae323053077e59212350c",
      "a6011449b716f163fe1ae323053077e59212350c"
    ],
    "patch_url": "https://github.com/1up-lab/OneupUploaderBundle/commit/a6011449b716f163fe1ae323053077e59212350c.patch",
    "fix_commit_details": {
      "sha": "a6011449b716f163fe1ae323053077e59212350c",
      "commit_date": "2020-02-04T10:37:36Z",
      "author": {
        "login": "bytehead",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-x8wj-6m73-gfqp",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 30,
        "additions": 24,
        "deletions": 6
      },
      "files": [
        {
          "filename": "Controller/DropzoneController.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -42,8 +42,8 @@ public function upload()\n     protected function parseChunkedRequest(Request $request)\n     {\n         $totalChunkCount = $request->get('dztotalchunkcount');\n-        $index = $request->get('dzchunkindex');\n-        $last = ((int) $index + 1) === (int) $totalChunkCount;\n+        $index = (int) $request->get('dzchunkindex');\n+        $last = ($index + 1) === (int) $totalChunkCount;\n         $uuid = $request->get('dzuuid');\n \n         /**"
        },
        {
          "filename": "Controller/FineUploaderController.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -40,11 +40,11 @@ public function upload()\n \n     protected function parseChunkedRequest(Request $request)\n     {\n-        $index = $request->get('qqpartindex');\n-        $total = $request->get('qqtotalparts');\n+        $index = (int) $request->get('qqpartindex');\n+        $total = (int) $request->get('qqtotalparts');\n         $uuid = $request->get('qquuid');\n         $orig = $request->get('qqfilename');\n-        $last = ((int) $total - 1) === (int) $index;\n+        $last = ($total - 1) === $index;\n \n         return [$last, $uuid, $index, $orig];\n     }"
        },
        {
          "filename": "Controller/PluploadController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,7 @@ protected function parseChunkedRequest(Request $request)\n         $session = $this->container->get('session');\n \n         $orig = $request->get('name');\n-        $index = $request->get('chunk');\n+        $index = (int) $request->get('chunk');\n         $last = (int) $request->get('chunks') - 1 === (int) $request->get('chunk');\n \n         // it is possible, that two clients send a file with the"
        },
        {
          "filename": "Uploader/Chunk/Storage/FilesystemStorage.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -38,6 +38,9 @@ public function clear($maxAge)\n \n     public function addChunk($uuid, $index, UploadedFile $chunk, $original)\n     {\n+        // Prevent path traversal attacks\n+        $uuid = basename($uuid);\n+\n         $filesystem = new Filesystem();\n         $path = sprintf('%s/%s', $this->directory, $uuid);\n         $name = sprintf('%s_%s', $index, $original);\n@@ -106,6 +109,9 @@ public function cleanup($path)\n \n     public function getChunks($uuid)\n     {\n+        // Prevent path traversal attacks\n+        $uuid = basename($uuid);\n+\n         $finder = new Finder();\n         $finder\n             ->in(sprintf('%s/%s', $this->directory, $uuid))->files()->sort(function (\\SplFileInfo $a, \\SplFileInfo $b) {"
        },
        {
          "filename": "Uploader/Chunk/Storage/FlysystemStorage.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -65,6 +65,9 @@ public function clear($maxAge, $prefix = null)\n \n     public function addChunk($uuid, $index, UploadedFile $chunk, $original)\n     {\n+        // Prevent path traversal attacks\n+        $uuid = basename($uuid);\n+\n         $this->unhandledChunk = [\n             'uuid' => $uuid,\n             'index' => $index,\n@@ -136,6 +139,9 @@ public function cleanup($path)\n \n     public function getChunks($uuid)\n     {\n+        // Prevent path traversal attacks\n+        $uuid = basename($uuid);\n+\n         return $this->filesystem->listFiles($this->prefix.'/'.$uuid);\n     }\n "
        },
        {
          "filename": "Uploader/Chunk/Storage/GaufretteStorage.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -98,6 +98,9 @@ public function clear($maxAge, $prefix = null)\n      */\n     public function addChunk($uuid, $index, UploadedFile $chunk, $original)\n     {\n+        // Prevent path traversal attacks\n+        $uuid = basename($uuid);\n+\n         $this->unhandledChunk = [\n             'uuid' => $uuid,\n             'index' => $index,\n@@ -170,6 +173,9 @@ public function cleanup($path)\n \n     public function getChunks($uuid)\n     {\n+        // Prevent path traversal attacks\n+        $uuid = basename($uuid);\n+\n         $results = $this->filesystem->listKeys($this->prefix.'/'.$uuid);\n \n         /* exclude files without an index, so if there is a completed file which"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "470b11eeee82946fbf93d5944c63749bcdf65f6f",
            "date": "2024-04-04T06:57:10Z",
            "author_login": "bytehead"
          },
          {
            "sha": "de4fb3797e133b11198e0d577fd8fec4de740495",
            "date": "2024-03-21T07:58:08Z",
            "author_login": "jdecool"
          },
          {
            "sha": "80ae7658ced98fa70b47da454173ccf400a2114f",
            "date": "2024-03-18T13:35:25Z",
            "author_login": "bytehead"
          },
          {
            "sha": "d0323dafd58175a8f003a892795ad12e716128c8",
            "date": "2024-02-19T12:44:30Z",
            "author_login": "knallcharge"
          },
          {
            "sha": "1bf94c18f75f222e8f7852d45d3ecfa7798c7106",
            "date": "2024-02-05T12:14:22Z",
            "author_login": "bytehead"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-23",
    "description": "Multiple relative path traversal vulnerabilities in the oneup/uploader-bundle before 1.9.3 and 2.1.5 allow remote attackers to upload, copy, and modify files on the filesystem (potentially leading to arbitrary code execution) via the (1) filename parameter to BlueimpController.php; the (2) dzchunkindex, (3) dzuuid, or (4) filename parameter to DropzoneController.php; the (5) qqpartindex, (6) qqfilename, or (7) qquuid parameter to FineUploaderController.php; the (8) x-file-id or (9) x-file-name parameter to MooUploadController.php; or the (10) name or (11) chunk parameter to PluploadController.php. This is fixed in versions 1.9.3 and 2.1.5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-02-05T14:15:11.527",
    "last_modified": "2024-11-21T05:33:44.290",
    "fix_date": "2020-02-04T10:37:36Z"
  },
  "references": [
    {
      "url": "https://github.com/1up-lab/OneupUploaderBundle/commit/a6011449b716f163fe1ae323053077e59212350c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/1up-lab/OneupUploaderBundle/security/advisories/GHSA-x8wj-6m73-gfqp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2020-003.txt",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/1up-lab/OneupUploaderBundle/commit/a6011449b716f163fe1ae323053077e59212350c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/1up-lab/OneupUploaderBundle/security/advisories/GHSA-x8wj-6m73-gfqp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2020-003.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:39.833111",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "OneupUploaderBundle",
    "owner": "1up-lab",
    "created_at": "2013-03-08T16:24:35Z",
    "updated_at": "2024-12-18T02:31:54Z",
    "pushed_at": "2024-04-04T06:58:24Z",
    "size": 1053,
    "stars": 609,
    "forks": 176,
    "open_issues": 19,
    "watchers": 609,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 221544
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:40:52.608704"
  }
}