{
  "cve_id": "CVE-2020-5279",
  "github_data": {
    "repository": "PrestaShop/PrestaShop",
    "fix_commit": "4444fb85761667a2206874a3112ccc77f657d76a",
    "related_commits": [
      "4444fb85761667a2206874a3112ccc77f657d76a",
      "4444fb85761667a2206874a3112ccc77f657d76a"
    ],
    "patch_url": "https://github.com/PrestaShop/PrestaShop/commit/4444fb85761667a2206874a3112ccc77f657d76a.patch",
    "fix_commit_details": {
      "sha": "4444fb85761667a2206874a3112ccc77f657d76a",
      "commit_date": "2020-04-15T13:02:29Z",
      "author": {
        "login": "PierreRambaud",
        "type": "User",
        "stats": {
          "total_commits": 2723,
          "average_weekly_commits": 3.787204450625869,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 195
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-74vp-ww64-w2gm",
        "length": 84,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 145,
        "additions": 117,
        "deletions": 28
      },
      "files": [
        {
          "filename": "controllers/admin/AdminCartRulesController.php",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -56,6 +56,10 @@ public function __construct()\n \n     public function ajaxProcessLoadCartRules()\n     {\n+        if (!$this->access('view')) {\n+            return die(json_encode(array('error' => 'You do not have the right permission')));\n+        }\n+\n         $type = $token = $search = '';\n         $limit = $count = $id_cart_rule = 0;\n         if (Tools::getIsset('limit')) {"
        },
        {
          "filename": "controllers/admin/AdminStatsController.php",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -629,6 +629,10 @@ public static function getExpenses($date_from, $date_to, $granularity = false)\n \n     public function displayAjaxGetKpi()\n     {\n+        if (!$this->access('view')) {\n+            return die(json_encode(array('error' => 'You do not have the right permission')));\n+        }\n+\n         $currency = new Currency(Configuration::get('PS_CURRENCY_DEFAULT'));\n         $tooltip = null;\n         switch (Tools::getValue('kpi')) {\n@@ -1039,6 +1043,10 @@ public function displayAjaxGetKpi()\n      */\n     public function displayAjaxGraphDraw()\n     {\n+        if (!$this->access('view')) {\n+            return die(json_encode(array('error' => 'You do not have the right permission')));\n+        }\n+\n         $module = Tools::getValue('module');\n         $render = Tools::getValue('render');\n         $type = Tools::getValue('type');\n@@ -1071,6 +1079,10 @@ public function displayAjaxGraphDraw()\n      */\n     public function displayAjaxGraphGrid()\n     {\n+        if (!$this->access('view')) {\n+            return die(json_encode(array('error' => 'You do not have the right permission')));\n+        }\n+\n         $module = Tools::getValue('module');\n         $render = Tools::getValue('render');\n         $type = Tools::getValue('type');"
        },
        {
          "filename": "controllers/admin/AdminStatusesController.php",
          "status": "modified",
          "additions": 24,
          "deletions": 0,
          "patch": "@@ -540,6 +540,10 @@ public function postProcess()\n         }\n \n         if (Tools::isSubmit('submitAddorder_return_state')) {\n+            if (!$this->access('add')) {\n+                return;\n+            }\n+\n             $id_order_return_state = Tools::getValue('id_order_return_state');\n \n             // Create Object OrderReturnState\n@@ -560,13 +564,21 @@ public function postProcess()\n         }\n \n         if (Tools::isSubmit('submitBulkdeleteorder_return_state')) {\n+            if (!$this->access('delete')) {\n+                return;\n+            }\n+\n             $this->className = 'OrderReturnState';\n             $this->table = 'order_return_state';\n             $this->boxes = Tools::getValue('order_return_stateBox');\n             parent::processBulkDelete();\n         }\n \n         if (Tools::isSubmit('deleteorder_return_state')) {\n+            if (!$this->access('delete')) {\n+                return;\n+            }\n+\n             $id_order_return_state = Tools::getValue('id_order_return_state');\n \n             // Create Object OrderReturnState\n@@ -580,6 +592,10 @@ public function postProcess()\n         }\n \n         if (Tools::isSubmit('submitAdd' . $this->table)) {\n+            if (!$this->access('add')) {\n+                return;\n+            }\n+\n             $this->deleted = false; // Disabling saving historisation\n             $_POST['invoice'] = (int) Tools::getValue('invoice_on');\n             $_POST['logable'] = (int) Tools::getValue('logable_on');\n@@ -598,13 +614,21 @@ public function postProcess()\n \n             return parent::postProcess();\n         } elseif (Tools::isSubmit('delete' . $this->table)) {\n+            if (!$this->access('delete')) {\n+                return;\n+            }\n+\n             $order_state = new OrderState(Tools::getValue('id_order_state'), $this->context->language->id);\n             if (!$order_state->isRemovable()) {\n                 $this->errors[] = $this->trans('For security reasons, you cannot delete default order statuses.', array(), 'Admin.Shopparameters.Notification');\n             } else {\n                 return parent::postProcess();\n             }\n         } elseif (Tools::isSubmit('submitBulkdelete' . $this->table)) {\n+            if (!$this->access('delete')) {\n+                return;\n+            }\n+\n             foreach (Tools::getValue($this->table . 'Box') as $selection) {\n                 $order_state = new OrderState((int) $selection, $this->context->language->id);\n                 if (!$order_state->isRemovable()) {"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/AttributeController.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -39,7 +39,7 @@ class AttributeController extends FrameworkBundleAdminController\n     /**\n      * get All Attributes as json.\n      *\n-     * @AdminSecurity(\"is_granted(['read'], 'ADMINPRODUCTS_')\")\n+     * @AdminSecurity(\"is_granted(['read'], request.get('_legacy_controller'))\")\n      *\n      * @return JsonResponse\n      */\n@@ -82,7 +82,7 @@ public function getAllAttributesAction()\n     /**\n      * Attributes generator.\n      *\n-     * @AdminSecurity(\"is_granted(['create', 'update'], 'ADMINPRODUCTS_')\")\n+     * @AdminSecurity(\"is_granted(['create', 'update'], request.get('_legacy_controller'))\")\n      *\n      * @param Request $request The request\n      *\n@@ -200,7 +200,7 @@ public function ensureProductHasDefaultCombination(Product $product, array $comb\n     /**\n      * Delete a product attribute.\n      *\n-     * @AdminSecurity(\"is_granted(['delete'], 'ADMINPRODUCTS_')\")\n+     * @AdminSecurity(\"is_granted(['delete'], request.get('_legacy_controller'))\")\n      *\n      * @param int $idProduct The product ID\n      * @param Request $request The request\n@@ -237,7 +237,7 @@ public function deleteAttributeAction($idProduct, Request $request)\n     /**\n      * Delete all product attributes.\n      *\n-     * @AdminSecurity(\"is_granted(['delete'], 'ADMINPRODUCTS_')\")\n+     * @AdminSecurity(\"is_granted(['delete'], request.get('_legacy_controller'))\")\n      *\n      * @param int $idProduct The product ID\n      * @param Request $request The request\n@@ -277,7 +277,7 @@ public function deleteAllAttributeAction($idProduct, Request $request)\n     /**\n      * get the images form for a product combinations.\n      *\n-     * @AdminSecurity(\"is_granted(['read'], 'ADMINPRODUCTS_')\")\n+     * @AdminSecurity(\"is_granted(['read'], request.get('_legacy_controller'))\")\n      *\n      * @param int $idProduct The product id\n      * @param Request $request The request"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/Configure/AdvancedParameters/ImportController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -256,7 +256,7 @@ public function getAvailableEntityFieldsAction(Request $request)\n     /**\n      * Process the import.\n      *\n-     * @AdminSecurity(\"is_granted(['read','update', 'create','delete'], request.get('_legacy_controller'))\", redirectRoute=\"admin_import\")\n+     * @AdminSecurity(\"is_granted(['update', 'create', 'delete'], request.get('_legacy_controller'))\", redirectRoute=\"admin_import\")\n      * @DemoRestricted(redirectRoute=\"admin_import\")\n      *\n      * @param Request $request"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/Configure/AdvancedParameters/PerformanceController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -80,7 +80,7 @@ public function indexAction(FormInterface $form = null)\n     /**\n      * Process the Performance configuration form.\n      *\n-     * @AdminSecurity(\"is_granted(['read','update', 'create','delete'], request.get('_legacy_controller'))\", message=\"You do not have permission to update this.\")\n+     * @AdminSecurity(\"is_granted(['update', 'create', 'delete'], request.get('_legacy_controller'))\", message=\"You do not have permission to update this.\")\n      * @DemoRestricted(redirectRoute=\"admin_performance\")\n      *\n      * @param Request $request"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/Configure/ShopParameters/CustomerPreferencesController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -66,7 +66,7 @@ public function indexAction(Request $request)\n     /**\n      * Process the Customer Preferences configuration form.\n      *\n-     * @AdminSecurity(\"is_granted(['read','update', 'create','delete'], request.get('_legacy_controller'))\", message=\"You do not have permission to update this.\", redirectRoute=\"admin_customer_preferences\")\n+     * @AdminSecurity(\"is_granted(['update', 'create','delete'], request.get('_legacy_controller'))\", message=\"You do not have permission to update this.\", redirectRoute=\"admin_customer_preferences\")\n      * @DemoRestricted(redirectRoute=\"admin_customer_preferences\")\n      *\n      * @param Request $request"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/Improve/International/GeolocationController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -68,7 +68,7 @@ public function indexAction(Request $request)\n      * Process geolocation configuration form.\n      *\n      * @AdminSecurity(\n-     *     \"is_granted(['read', 'update', 'create', 'delete'], request.get('_legacy_controller'))\",\n+     *     \"is_granted(['update', 'create', 'delete'], request.get('_legacy_controller'))\",\n      *     message=\"You do not have permission to edit this.\",\n      *     redirectRoute=\"admin_geolocation\"\n      * )"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/Improve/International/LocalizationController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -75,7 +75,7 @@ public function indexAction(Request $request)\n     /**\n      * Save localization settings.\n      *\n-     * @AdminSecurity(\"is_granted(['read','update', 'create','delete'], request.get('_legacy_controller'))\", message=\"You do not have permission to edit this.\")\n+     * @AdminSecurity(\"is_granted(['update', 'create', 'delete'], request.get('_legacy_controller'))\", message=\"You do not have permission to edit this.\")\n      * @DemoRestricted(redirectRoute=\"admin_localization_index\")\n      *\n      * @param Request $request"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Admin/ProductController.php",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -262,6 +262,10 @@ public function listAction(\n         $sortOrder = 'asc',\n         $view = 'full'\n     ) {\n+        if (!$this->isGranted(array(PageVoter::READ), self::PRODUCT_OBJECT)) {\n+            return $this->redirect('admin_dashboard');\n+        }\n+\n         /** @var $productProvider ProductInterfaceProvider */\n         $productProvider = $this->get('prestashop.core.admin.data_provider.product_interface');\n         $adminProductWrapper = $this->get('prestashop.adapter.admin.wrapper.product');"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Api/I18nController.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -27,6 +27,7 @@\n namespace PrestaShopBundle\\Controller\\Api;\n \n use Exception;\n+use PrestaShopBundle\\Security\\Annotation\\AdminSecurity;\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n use Symfony\\Component\\HttpFoundation\\Request;\n use Symfony\\Component\\HttpKernel\\Exception\\BadRequestHttpException;\n@@ -36,6 +37,8 @@ class I18nController extends ApiController\n     /**\n      * Show translation for page-app build with vue-js.\n      *\n+     * @AdminSecurity(\"is_granted('read', request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Api/StockController.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -34,6 +34,7 @@\n use PrestaShopBundle\\Entity\\Repository\\StockRepository;\n use PrestaShopBundle\\Exception\\InvalidPaginationParamsException;\n use PrestaShopBundle\\Exception\\ProductNotFoundException;\n+use PrestaShopBundle\\Security\\Annotation\\AdminSecurity;\n use PrestaShopBundle\\Security\\Voter\\PageVoter;\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n use Symfony\\Component\\HttpFoundation\\Request;\n@@ -64,6 +65,10 @@ class StockController extends ApiController\n      */\n     public function listProductsAction(Request $request)\n     {\n+        if (!$this->isGranted([PageVoter::READ], $request->get('_legacy_controller'))) {\n+            return new JsonResponse(null, Response::HTTP_FORBIDDEN);\n+        }\n+\n         try {\n             $queryParamsCollection = $this->queryParams->fromRequest($request);\n         } catch (InvalidPaginationParamsException $exception) {\n@@ -150,6 +155,10 @@ public function bulkEditProductsAction(Request $request)\n      */\n     public function listProductsExportAction(Request $request)\n     {\n+        if (!$this->isGranted([PageVoter::READ], $request->get('_legacy_controller'))) {\n+            return new JsonResponse(null, Response::HTTP_FORBIDDEN);\n+        }\n+\n         try {\n             $queryParamsCollection = $this->queryParams->fromRequest($request);\n         } catch (InvalidPaginationParamsException $exception) {"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Api/StockMovementController.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -29,6 +29,7 @@\n use PrestaShopBundle\\Api\\QueryStockMovementParamsCollection;\n use PrestaShopBundle\\Entity\\Repository\\StockMovementRepository;\n use PrestaShopBundle\\Exception\\InvalidPaginationParamsException;\n+use PrestaShopBundle\\Security\\Annotation\\AdminSecurity;\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n use Symfony\\Component\\HttpFoundation\\Request;\n use Symfony\\Component\\HttpKernel\\Exception\\BadRequestHttpException;\n@@ -46,6 +47,8 @@ class StockMovementController extends ApiController\n     public $queryParams;\n \n     /**\n+     * @AdminSecurity(\"is_granted(['read'], request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse\n@@ -65,6 +68,8 @@ public function listMovementsAction(Request $request)\n     }\n \n     /**\n+     * @AdminSecurity(\"is_granted(['read'], request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse\n@@ -75,6 +80,8 @@ public function listMovementsEmployeesAction(Request $request)\n     }\n \n     /**\n+     * @AdminSecurity(\"is_granted(['read'], request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse"
        },
        {
          "filename": "src/PrestaShopBundle/Controller/Api/TranslationController.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -29,6 +29,7 @@\n use Exception;\n use PrestaShopBundle\\Api\\QueryTranslationParamsCollection;\n use PrestaShopBundle\\Exception\\InvalidLanguageException;\n+use PrestaShopBundle\\Security\\Annotation\\AdminSecurity;\n use PrestaShopBundle\\Service\\TranslationService;\n use PrestaShopBundle\\Translation\\View\\TreeBuilder;\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n@@ -51,6 +52,8 @@ class TranslationController extends ApiController\n     /**\n      * Show translations for 1 domain & 1 locale given & 1 theme given (optional).\n      *\n+     * @AdminSecurity(\"is_granted('read', request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse\n@@ -115,6 +118,8 @@ public function listDomainTranslationAction(Request $request)\n     /**\n      * Show tree for translation page with some params.\n      *\n+     * @AdminSecurity(\"is_granted('read', request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse\n@@ -166,6 +171,8 @@ public function listTreeAction(Request $request)\n     /**\n      * Route to edit translation.\n      *\n+     * @AdminSecurity(\"is_granted(['create', 'update'], request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse\n@@ -211,6 +218,8 @@ public function translationEditAction(Request $request)\n     /**\n      * Route to reset translation.\n      *\n+     * @AdminSecurity(\"is_granted(['create', 'update'], request.get('_legacy_controller'))\")\n+     *\n      * @param Request $request\n      *\n      * @return JsonResponse"
        },
        {
          "filename": "src/PrestaShopBundle/Resources/config/routing/admin/sell/catalog/products/attributes.yml",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -4,24 +4,28 @@ admin_attribute_get_all:\n     defaults:\n         _controller: PrestaShopBundle:Admin/Attribute:getAllAttributes\n         _format: json\n+        _legacy_controller: AdminProducts\n \n admin_attribute_generator:\n     path:     /generator\n     methods:  [POST]\n     defaults:\n         _controller: PrestaShopBundle:Admin/Attribute:attributesGenerator\n+        _legacy_controller: AdminProducts\n \n admin_delete_attribute:\n     path:     /{idProduct}\n     methods:  [DELETE]\n     defaults:\n         _controller: PrestaShopBundle:Admin/Attribute:deleteAttribute\n+        _legacy_controller: AdminProducts\n \n admin_delete_all_attributes:\n     path:     /delete-all/{idProduct}\n     methods:  [GET]\n     defaults:\n         _controller: PrestaShopBundle:Admin/Attribute:deleteAllAttribute\n+        _legacy_controller: AdminProducts\n         idProduct: 0\n     requirements:\n         idProduct: \\d+\n@@ -32,6 +36,7 @@ admin_get_form_images_combination:\n     defaults:\n         _controller: PrestaShopBundle:Admin/Attribute:getFormImages\n         _format: json\n+        _legacy_controller: AdminProducts\n         idProduct: 0\n     requirements:\n         idProduct: \\d+"
        },
        {
          "filename": "src/PrestaShopBundle/Resources/config/routing/api/i18n.yml",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -3,5 +3,6 @@ api_i18n_translations_list:\n     methods: [GET]\n     defaults:\n         _controller: prestashop.core.api.i18n.controller:listTranslationAction\n+        _legacy_controller: AdminTranslations\n     requirements:\n         page: \\w+"
        },
        {
          "filename": "src/PrestaShopBundle/Resources/config/routing/api/stock_movements.yml",
          "status": "modified",
          "additions": 22,
          "deletions": 18,
          "patch": "@@ -1,26 +1,30 @@\n api_stock_list_movements:\n-     path: /\n-     methods: [GET]\n-     defaults:\n-         _controller: prestashop.core.api.stock_movement.controller:listMovementsAction\n+    path: /\n+    methods: [GET]\n+    defaults:\n+        _controller: prestashop.core.api.stock_movement.controller:listMovementsAction\n+        _legacy_controller: AdminStockManagement\n \n api_stock_product_list_movements:\n-     path: /product/{productId}\n-     methods: [GET]\n-     defaults:\n-         _controller: prestashop.core.api.stock_movement.controller:listMovementsAction\n-     requirements:\n-         productId: \\d+\n+    path: /product/{productId}\n+    methods: [GET]\n+    defaults:\n+        _controller: prestashop.core.api.stock_movement.controller:listMovementsAction\n+        _legacy_controller: AdminStockManagement\n+    requirements:\n+        productId: \\d+\n \n api_stock_list_movements_employees:\n-     path: /employees\n-     methods: [GET]\n-     defaults:\n-         _controller: prestashop.core.api.stock_movement.controller:listMovementsEmployeesAction\n+    path: /employees\n+    methods: [GET]\n+    defaults:\n+        _controller: prestashop.core.api.stock_movement.controller:listMovementsEmployeesAction\n+        _legacy_controller: AdminStockManagement\n \n \n api_stock_list_movements_types:\n-     path: /types\n-     methods: [GET]\n-     defaults:\n-         _controller: prestashop.core.api.stock_movement.controller:listMovementsTypesAction\n+    path: /types\n+    methods: [GET]\n+    defaults:\n+        _controller: prestashop.core.api.stock_movement.controller:listMovementsTypesAction\n+        _legacy_controller: AdminStockManagement"
        },
        {
          "filename": "src/PrestaShopBundle/Resources/config/routing/api/stocks.yml",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -3,18 +3,21 @@ api_stock_list_products:\n     methods: [GET]\n     defaults:\n         _controller: prestashop.core.api.stock.controller:listProductsAction\n+        _legacy_controller: AdminStockManagement\n \n api_stock_list_products_export:\n     path: /export\n     methods: [GET]\n     defaults:\n         _controller: prestashop.core.api.stock.controller:listProductsExportAction\n+        _legacy_controller: AdminStockManagement\n \n api_stock_list_product_combinations:\n     path: /{productId}\n     methods: [GET]\n     defaults:\n         _controller: prestashop.core.api.stock.controller:listProductsAction\n+        _legacy_controller: AdminStockManagement\n     requirements:\n         productId: \\d+\n "
        },
        {
          "filename": "src/PrestaShopBundle/Resources/config/routing/api/translations.yml",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -3,13 +3,15 @@ api_translation_domains_tree:\n     methods: [GET]\n     defaults:\n         _controller: prestashop.core.api.translation.controller:listTreeAction\n+        _legacy_controller: AdminTranslations\n         selected: null\n \n api_translation_domain_catalog:\n     path: /{locale}/{domain}/{theme}\n     methods: [GET]\n     defaults:\n         _controller: prestashop.core.api.translation.controller:listDomainTranslationAction\n+        _legacy_controller: AdminTranslations\n         theme: null\n         module: null\n \n@@ -18,9 +20,11 @@ api_translation_value_edit:\n     methods: [POST]\n     defaults:\n         _controller: prestashop.core.api.translation.controller:translationEditAction\n+        _legacy_controller: AdminTranslations\n \n api_translation_value_reset:\n     path: /reset\n     methods: [POST]\n     defaults:\n         _controller: prestashop.core.api.translation.controller:translationResetAction\n+        _legacy_controller: AdminTranslations"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 8,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 8,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec433fcf5603cc11c33b8ce76940ffca39dfa7ab",
            "date": "2025-01-14T08:52:42Z",
            "author_login": "Progi1984"
          },
          {
            "sha": "2efb789589029b6a04a5a629ba45b71b8f37fd6c",
            "date": "2025-01-13T16:37:17Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "18e642c26a83c05e0a67b05c86385afd070b68fb",
            "date": "2025-01-13T16:11:19Z",
            "author_login": "Progi1984"
          },
          {
            "sha": "9641d8eca066dce510c61ff7298ee98a77f8bf3d",
            "date": "2025-01-13T16:08:47Z",
            "author_login": "Progi1984"
          },
          {
            "sha": "aca73a664e3f3b5873379124794b41d49741ab2e",
            "date": "2025-01-13T06:36:38Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N",
    "cwe_id": "CWE-284",
    "description": "In PrestaShop between versions 1.5.0.0 and 1.7.6.5, there are improper access control since the the version 1.5.0.0 for legacy controllers. - admin-dev/index.php/configure/shop/customer-preferences/ - admin-dev/index.php/improve/international/translations/ - admin-dev/index.php/improve/international/geolocation/ - admin-dev/index.php/improve/international/localization - admin-dev/index.php/configure/advanced/performance - admin-dev/index.php/sell/orders/delivery-slips/ - admin-dev/index.php?controller=AdminStatuses The problem is fixed in 1.7.6.5",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-04-20T17:15:15.960",
    "last_modified": "2024-11-21T05:33:49.437",
    "fix_date": "2020-04-15T13:02:29Z"
  },
  "references": [
    {
      "url": "https://github.com/PrestaShop/PrestaShop/commit/4444fb85761667a2206874a3112ccc77f657d76a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-74vp-ww64-w2gm",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/PrestaShop/commit/4444fb85761667a2206874a3112ccc77f657d76a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-74vp-ww64-w2gm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.948784",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PrestaShop",
    "owner": "PrestaShop",
    "created_at": "2012-11-19T16:41:31Z",
    "updated_at": "2025-01-14T08:52:52Z",
    "pushed_at": "2025-01-14T09:09:53Z",
    "size": 763335,
    "stars": 8320,
    "forks": 4829,
    "open_issues": 2738,
    "watchers": 8320,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "1.7.7.x",
      "1.7.8.x",
      "8.0.x",
      "8.1.x",
      "8.2.x",
      "9.0.x",
      "develop"
    ],
    "languages": {
      "PHP": 29053069,
      "TypeScript": 9773631,
      "Gherkin": 2649810,
      "Twig": 2491625,
      "HTML": 1695839,
      "JavaScript": 1449413,
      "Smarty": 993383,
      "SCSS": 499157,
      "Vue": 331001,
      "CSS": 163083,
      "Less": 19680,
      "Shell": 15677,
      "Makefile": 1814,
      "Dockerfile": 1141
    },
    "commit_activity": {
      "total_commits_last_year": 3038,
      "avg_commits_per_week": 58.42307692307692,
      "days_active_last_year": 281
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:11:29.329599"
  }
}