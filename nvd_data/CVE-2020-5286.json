{
  "cve_id": "CVE-2020-5286",
  "github_data": {
    "repository": "PrestaShop/PrestaShop",
    "fix_commit": "fc0625fb0a9aab1835515f1bea52e8e063384da7",
    "related_commits": [
      "fc0625fb0a9aab1835515f1bea52e8e063384da7",
      "fc0625fb0a9aab1835515f1bea52e8e063384da7"
    ],
    "patch_url": "https://github.com/PrestaShop/PrestaShop/commit/fc0625fb0a9aab1835515f1bea52e8e063384da7.patch",
    "fix_commit_details": {
      "sha": "fc0625fb0a9aab1835515f1bea52e8e063384da7",
      "commit_date": "2020-04-15T09:19:37Z",
      "author": {
        "login": "PierreRambaud",
        "type": "User",
        "stats": {
          "total_commits": 2723,
          "average_weekly_commits": 3.787204450625869,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 195
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-98j8-hvjv-x47j",
        "length": 90,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "admin-dev/themes/new-theme/js/pages/import/ImportPage.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -160,8 +160,8 @@ export default class ImportPage {\n \n     const fileData = fileName + ' (' + this.humanizeSize(fileSize) + ')';\n \n-    $alert.find('.js-file-data').html(fileData);\n-    $alert.find('.js-error-message').html(message);\n+    $alert.find('.js-file-data').text(fileData);\n+    $alert.find('.js-error-message').text(message);\n     $alert.removeClass('d-none');\n   }\n "
        },
        {
          "filename": "admin-dev/themes/new-theme/public/imports.bundle.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-window.imports=function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,\"a\",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=325)}({255:function(e,t,o){\"use strict\";function i(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),l=o(324),r=function(e){return e&&e.__esModule?e:{default:e}}(l),a=window.$,s=function(){function e(){var t=this;i(this,e),new r.default,a(\".js-from-files-history-btn\").on(\"click\",function(){return t.showFilesHistoryHandler()}),a(\".js-close-files-history-block-btn\").on(\"click\",function(){return t.closeFilesHistoryHandler()}),a(\"#fileHistoryTable\").on(\"click\",\".js-use-file-btn\",function(e){return t.useFileFromFilesHistory(e)}),a(\".js-change-import-file-btn\").on(\"click\",function(){return t.changeImportFileHandler()}),a(\".js-import-file\").on(\"change\",function(){return t.uploadFile()}),this.toggleSelectedFile(),this.handleSubmit()}return n(e,[{key:\"handleSubmit\",value:function(){a(\".js-import-form\").on(\"submit\",function(){var e=a(this);if(\"1\"===e.find('input[name=\"truncate\"]:checked').val())return confirm(e.data(\"delete-confirm-message\")+\" \"+a.trim(a(\"#entity > option:selected\").text().toLowerCase())+\"?\")})}},{key:\"toggleSelectedFile\",value:function(){var e=a(\"#csv\").val();e.length>0&&(this.showImportFileAlert(e),this.hideFileUploadBlock())}},{key:\"changeImportFileHandler\",value:function(){this.hideImportFileAlert(),this.showFileUploadBlock()}},{key:\"showFilesHistoryHandler\",value:function(){this.showFilesHistory(),this.hideFileUploadBlock()}},{key:\"closeFilesHistoryHandler\",value:function(){this.closeFilesHistory(),this.showFileUploadBlock()}},{key:\"showFilesHistory\",value:function(){a(\".js-files-history-block\").removeClass(\"d-none\")}},{key:\"closeFilesHistory\",value:function(){a(\".js-files-history-block\").addClass(\"d-none\")}},{key:\"useFileFromFilesHistory\",value:function(e){var t=a(e.target).closest(\".btn-group\").data(\"file\");a(\".js-import-file-input\").val(t),this.showImportFileAlert(t),this.closeFilesHistory()}},{key:\"showImportFileAlert\",value:function(e){a(\".js-import-file-alert\").removeClass(\"d-none\"),a(\".js-import-file\").text(e)}},{key:\"hideImportFileAlert\",value:function(){a(\".js-import-file-alert\").addClass(\"d-none\")}},{key:\"hideFileUploadBlock\",value:function(){a(\".js-file-upload-form-group\").addClass(\"d-none\")}},{key:\"showFileUploadBlock\",value:function(){a(\".js-file-upload-form-group\").removeClass(\"d-none\")}},{key:\"enableFilesHistoryBtn\",value:function(){a(\".js-from-files-history-btn\").removeAttr(\"disabled\")}},{key:\"showImportFileError\",value:function(e,t,o){var i=a(\".js-import-file-error\"),n=e+\" (\"+this.humanizeSize(t)+\")\";i.find(\".js-file-data\").html(n),i.find(\".js-error-message\").html(o),i.removeClass(\"d-none\")}},{key:\"hideImportFileError\",value:function(){a(\".js-import-file-error\").addClass(\"d-none\")}},{key:\"humanizeSize\",value:function(e){return\"number\"!=typeof e?\"\":e>=1e9?(e/1e9).toFixed(2)+\" GB\":e>=1e6?(e/1e6).toFixed(2)+\" MB\":(e/1e3).toFixed(2)+\" KB\"}},{key:\"uploadFile\",value:function(){var e=this;this.hideImportFileError();var t=a(\"#file\"),o=t.prop(\"files\")[0];if(t.data(\"max-file-upload-size\")<o.size)return void this.showImportFileError(o.name,o.size,\"File is too large\");var i=new FormData;i.append(\"file\",o),a.ajax({type:\"POST\",url:a(\".js-import-form\").data(\"file-upload-url\"),data:i,cache:!1,contentType:!1,processData:!1}).then(function(t){if(t.error)return void e.showImportFileError(o.name,o.size,t.error);var i=t.file.name;a(\".js-import-file-input\").val(i),e.showImportFileAlert(i),e.hideFileUploadBlock(),e.addFileToHistoryTable(i),e.enableFilesHistoryBtn()})}},{key:\"addFileToHistoryTable\",value:function(e){var t=a(\"#fileHistoryTable\"),o=t.data(\"delete-file-url\"),i=o+\"&filename=\"+encodeURIComponent(e),n=t.data(\"download-file-url\"),l=n+\"&filename=\"+encodeURIComponent(e),r=t.find(\"tr:first\").clone();r.removeClass(\"d-none\"),r.find(\"td:first\").text(e),r.find(\".btn-group\").attr(\"data-file\",e),r.find(\".js-delete-file-btn\").attr(\"href\",i),r.find(\".js-download-file-btn\").attr(\"href\",l),t.find(\"tbody\").append(r);var s=t.find(\"tr\").length-1;a(\".js-files-history-number\").text(s)}}]),e}();t.default=s},324:function(e,t,o){\"use strict\";function i(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),l=window.$,r=function(){function e(){var t=this;i(this,e),l(\".js-entity-select\").on(\"change\",function(){return t.toggleForm()}),this.toggleForm()}return n(e,[{key:\"toggleForm\",value:function(){var e=l(\"#entity\").find(\"option:selected\"),t=parseInt(e.val()),o=e.text().toLowerCase();this.toggleEntityAlert(t),this.toggleFields(t,o),this.loadAvailableFields(t)}},{key:\"toggleEntityAlert\",value:function(e){var t=l(\".js-entity-alert\");[0,1].includes(e)?t.show():t.hide()}},{key:\"toggleFields\",value:function(e,t){var o=l(\".js-truncate-form-group\"),i=l(\".js-match-ref-form-group\"),n=l(\".js-regenerate-form-group\"),r=l(\".js-force-ids-form-group\"),a=l(\".js-entity-name\");8===e?o.hide():o.show(),[1,2].includes(e)?i.show():i.hide(),[0,1,5,6,8].includes(e)?n.show():n.hide(),[0,1,3,4,5,6,8,7].includes(e)?r.show():r.hide(),a.html(t)}},{key:\"loadAvailableFields\",value:function(e){var t=this,o=l(\".js-available-fields\");l.ajax({url:o.data(\"url\"),data:{entity:e},dataType:\"json\"}).then(function(e){t._removeAvailableFields(o);for(var i=0;i<e.length;i++)t._appendAvailableField(o,e[i].label+(e[i].required?\"*\":\"\"),e[i].description);o.find('[data-toggle=\"popover\"]').popover()})}},{key:\"_removeAvailableFields\",value:function(e){e.find('[data-toggle=\"popover\"]').popover(\"hide\"),e.empty()}},{key:\"_appendHelpBox\",value:function(e,t){var o=l(\".js-available-field-popover-template\").clone();o.attr(\"data-content\",t),o.removeClass(\"js-available-field-popover-template d-none\"),e.append(o)}},{key:\"_appendAvailableField\",value:function(e,t,o){var i=l(\".js-available-field-template\").clone();i.text(t),o&&this._appendHelpBox(i,o),i.removeClass(\"js-available-field-template d-none\"),i.appendTo(e)}}]),e}();t.default=r},325:function(e,t,o){\"use strict\";var i=o(255),n=function(e){return e&&e.__esModule?e:{default:e}}(i);/**\n+window.imports=function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,\"a\",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=325)}({255:function(e,t,o){\"use strict\";function i(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),l=o(324),r=function(e){return e&&e.__esModule?e:{default:e}}(l),a=window.$,s=function(){function e(){var t=this;i(this,e),new r.default,a(\".js-from-files-history-btn\").on(\"click\",function(){return t.showFilesHistoryHandler()}),a(\".js-close-files-history-block-btn\").on(\"click\",function(){return t.closeFilesHistoryHandler()}),a(\"#fileHistoryTable\").on(\"click\",\".js-use-file-btn\",function(e){return t.useFileFromFilesHistory(e)}),a(\".js-change-import-file-btn\").on(\"click\",function(){return t.changeImportFileHandler()}),a(\".js-import-file\").on(\"change\",function(){return t.uploadFile()}),this.toggleSelectedFile(),this.handleSubmit()}return n(e,[{key:\"handleSubmit\",value:function(){a(\".js-import-form\").on(\"submit\",function(){var e=a(this);if(\"1\"===e.find('input[name=\"truncate\"]:checked').val())return confirm(e.data(\"delete-confirm-message\")+\" \"+a.trim(a(\"#entity > option:selected\").text().toLowerCase())+\"?\")})}},{key:\"toggleSelectedFile\",value:function(){var e=a(\"#csv\").val();e.length>0&&(this.showImportFileAlert(e),this.hideFileUploadBlock())}},{key:\"changeImportFileHandler\",value:function(){this.hideImportFileAlert(),this.showFileUploadBlock()}},{key:\"showFilesHistoryHandler\",value:function(){this.showFilesHistory(),this.hideFileUploadBlock()}},{key:\"closeFilesHistoryHandler\",value:function(){this.closeFilesHistory(),this.showFileUploadBlock()}},{key:\"showFilesHistory\",value:function(){a(\".js-files-history-block\").removeClass(\"d-none\")}},{key:\"closeFilesHistory\",value:function(){a(\".js-files-history-block\").addClass(\"d-none\")}},{key:\"useFileFromFilesHistory\",value:function(e){var t=a(e.target).closest(\".btn-group\").data(\"file\");a(\".js-import-file-input\").val(t),this.showImportFileAlert(t),this.closeFilesHistory()}},{key:\"showImportFileAlert\",value:function(e){a(\".js-import-file-alert\").removeClass(\"d-none\"),a(\".js-import-file\").text(e)}},{key:\"hideImportFileAlert\",value:function(){a(\".js-import-file-alert\").addClass(\"d-none\")}},{key:\"hideFileUploadBlock\",value:function(){a(\".js-file-upload-form-group\").addClass(\"d-none\")}},{key:\"showFileUploadBlock\",value:function(){a(\".js-file-upload-form-group\").removeClass(\"d-none\")}},{key:\"enableFilesHistoryBtn\",value:function(){a(\".js-from-files-history-btn\").removeAttr(\"disabled\")}},{key:\"showImportFileError\",value:function(e,t,o){var i=a(\".js-import-file-error\"),n=e+\" (\"+this.humanizeSize(t)+\")\";i.find(\".js-file-data\").text(n),i.find(\".js-error-message\").text(o),i.removeClass(\"d-none\")}},{key:\"hideImportFileError\",value:function(){a(\".js-import-file-error\").addClass(\"d-none\")}},{key:\"humanizeSize\",value:function(e){return\"number\"!=typeof e?\"\":e>=1e9?(e/1e9).toFixed(2)+\" GB\":e>=1e6?(e/1e6).toFixed(2)+\" MB\":(e/1e3).toFixed(2)+\" KB\"}},{key:\"uploadFile\",value:function(){var e=this;this.hideImportFileError();var t=a(\"#file\"),o=t.prop(\"files\")[0];if(t.data(\"max-file-upload-size\")<o.size)return void this.showImportFileError(o.name,o.size,\"File is too large\");var i=new FormData;i.append(\"file\",o),a.ajax({type:\"POST\",url:a(\".js-import-form\").data(\"file-upload-url\"),data:i,cache:!1,contentType:!1,processData:!1}).then(function(t){if(t.error)return void e.showImportFileError(o.name,o.size,t.error);var i=t.file.name;a(\".js-import-file-input\").val(i),e.showImportFileAlert(i),e.hideFileUploadBlock(),e.addFileToHistoryTable(i),e.enableFilesHistoryBtn()})}},{key:\"addFileToHistoryTable\",value:function(e){var t=a(\"#fileHistoryTable\"),o=t.data(\"delete-file-url\"),i=o+\"&filename=\"+encodeURIComponent(e),n=t.data(\"download-file-url\"),l=n+\"&filename=\"+encodeURIComponent(e),r=t.find(\"tr:first\").clone();r.removeClass(\"d-none\"),r.find(\"td:first\").text(e),r.find(\".btn-group\").attr(\"data-file\",e),r.find(\".js-delete-file-btn\").attr(\"href\",i),r.find(\".js-download-file-btn\").attr(\"href\",l),t.find(\"tbody\").append(r);var s=t.find(\"tr\").length-1;a(\".js-files-history-number\").text(s)}}]),e}();t.default=s},324:function(e,t,o){\"use strict\";function i(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),l=window.$,r=function(){function e(){var t=this;i(this,e),l(\".js-entity-select\").on(\"change\",function(){return t.toggleForm()}),this.toggleForm()}return n(e,[{key:\"toggleForm\",value:function(){var e=l(\"#entity\").find(\"option:selected\"),t=parseInt(e.val()),o=e.text().toLowerCase();this.toggleEntityAlert(t),this.toggleFields(t,o),this.loadAvailableFields(t)}},{key:\"toggleEntityAlert\",value:function(e){var t=l(\".js-entity-alert\");[0,1].includes(e)?t.show():t.hide()}},{key:\"toggleFields\",value:function(e,t){var o=l(\".js-truncate-form-group\"),i=l(\".js-match-ref-form-group\"),n=l(\".js-regenerate-form-group\"),r=l(\".js-force-ids-form-group\"),a=l(\".js-entity-name\");8===e?o.hide():o.show(),[1,2].includes(e)?i.show():i.hide(),[0,1,5,6,8].includes(e)?n.show():n.hide(),[0,1,3,4,5,6,8,7].includes(e)?r.show():r.hide(),a.html(t)}},{key:\"loadAvailableFields\",value:function(e){var t=this,o=l(\".js-available-fields\");l.ajax({url:o.data(\"url\"),data:{entity:e},dataType:\"json\"}).then(function(e){t._removeAvailableFields(o);for(var i=0;i<e.length;i++)t._appendAvailableField(o,e[i].label+(e[i].required?\"*\":\"\"),e[i].description);o.find('[data-toggle=\"popover\"]').popover()})}},{key:\"_removeAvailableFields\",value:function(e){e.find('[data-toggle=\"popover\"]').popover(\"hide\"),e.empty()}},{key:\"_appendHelpBox\",value:function(e,t){var o=l(\".js-available-field-popover-template\").clone();o.attr(\"data-content\",t),o.removeClass(\"js-available-field-popover-template d-none\"),e.append(o)}},{key:\"_appendAvailableField\",value:function(e,t,o){var i=l(\".js-available-field-template\").clone();i.text(t),o&&this._appendHelpBox(i,o),i.removeClass(\"js-available-field-template d-none\"),i.appendTo(e)}}]),e}();t.default=r},325:function(e,t,o){\"use strict\";var i=o(255),n=function(e){return e&&e.__esModule?e:{default:e}}(i);/**\n                    * 2007-2019 PrestaShop and Contributors\n                    *\n                    * NOTICE OF LICENSE"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec433fcf5603cc11c33b8ce76940ffca39dfa7ab",
            "date": "2025-01-14T08:52:42Z",
            "author_login": "Progi1984"
          },
          {
            "sha": "2efb789589029b6a04a5a629ba45b71b8f37fd6c",
            "date": "2025-01-13T16:37:17Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "18e642c26a83c05e0a67b05c86385afd070b68fb",
            "date": "2025-01-13T16:11:19Z",
            "author_login": "Progi1984"
          },
          {
            "sha": "9641d8eca066dce510c61ff7298ee98a77f8bf3d",
            "date": "2025-01-13T16:08:47Z",
            "author_login": "Progi1984"
          },
          {
            "sha": "aca73a664e3f3b5873379124794b41d49741ab2e",
            "date": "2025-01-13T06:36:38Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N",
    "cwe_id": "CWE-79",
    "description": "In PrestaShop between versions 1.7.4.0 and 1.7.6.5, there is a reflected XSS when uploading a wrong file. The problem is fixed in 1.7.6.5",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-04-20T17:15:16.117",
    "last_modified": "2024-11-21T05:33:50.227",
    "fix_date": "2020-04-15T09:19:37Z"
  },
  "references": [
    {
      "url": "https://github.com/PrestaShop/PrestaShop/commit/fc0625fb0a9aab1835515f1bea52e8e063384da7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-98j8-hvjv-x47j",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/PrestaShop/commit/fc0625fb0a9aab1835515f1bea52e8e063384da7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-98j8-hvjv-x47j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.949067",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PrestaShop",
    "owner": "PrestaShop",
    "created_at": "2012-11-19T16:41:31Z",
    "updated_at": "2025-01-14T08:52:52Z",
    "pushed_at": "2025-01-14T09:09:53Z",
    "size": 763335,
    "stars": 8320,
    "forks": 4829,
    "open_issues": 2738,
    "watchers": 8320,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "1.7.7.x",
      "1.7.8.x",
      "8.0.x",
      "8.1.x",
      "8.2.x",
      "9.0.x",
      "develop"
    ],
    "languages": {
      "PHP": 29053069,
      "TypeScript": 9773631,
      "Gherkin": 2649810,
      "Twig": 2491625,
      "HTML": 1695839,
      "JavaScript": 1449413,
      "Smarty": 993383,
      "SCSS": 499157,
      "Vue": 331001,
      "CSS": 163083,
      "Less": 19680,
      "Shell": 15677,
      "Makefile": 1814,
      "Dockerfile": 1141
    },
    "commit_activity": {
      "total_commits_last_year": 3038,
      "avg_commits_per_week": 58.42307692307692,
      "days_active_last_year": 281
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:11:29.329599"
  }
}