{
  "cve_id": "CVE-2020-5294",
  "github_data": {
    "repository": "PrestaShop/ps_socialfollow",
    "fix_commit": "c1768bf14c0fcf8311bea15fba4ffdda45522d6b",
    "related_commits": [
      "c1768bf14c0fcf8311bea15fba4ffdda45522d6b",
      "c1768bf14c0fcf8311bea15fba4ffdda45522d6b"
    ],
    "patch_url": "https://github.com/PrestaShop/ps_socialfollow/commit/c1768bf14c0fcf8311bea15fba4ffdda45522d6b.patch",
    "fix_commit_details": {
      "sha": "c1768bf14c0fcf8311bea15fba4ffdda45522d6b",
      "commit_date": "2020-04-15T15:01:19Z",
      "author": {
        "login": "PierreRambaud",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-774w-fg8p-7c8w",
        "length": 68,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 62,
        "additions": 41,
        "deletions": 21
      },
      "files": [
        {
          "filename": "config.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -2,9 +2,10 @@\n <module>\n     <name>ps_socialfollow</name>\n     <displayName><![CDATA[Social media follow links]]></displayName>\n-    <version><![CDATA[1.0]]></version>\n+    <version><![CDATA[2.1.0]]></version>\n     <description><![CDATA[Allows you to add information about your brand&#039;s social networking accounts.]]></description>\n     <author><![CDATA[PrestaShop]]></author>\n+    <tab><![CDATA[]]></tab>\n     <is_configurable>1</is_configurable>\n     <need_instance>1</need_instance>\n \t<limited_countries></limited_countries>"
        },
        {
          "filename": "ps_socialfollow.php",
          "status": "modified",
          "additions": 39,
          "deletions": 20,
          "patch": "@@ -29,16 +29,29 @@\n }\n \n use PrestaShop\\PrestaShop\\Core\\Module\\WidgetInterface;\n+use Symfony\\Component\\Validator\\Constraints\\Url;\n+use Symfony\\Component\\Validator\\Validation;\n \n class Ps_Socialfollow extends Module implements WidgetInterface\n {\n     private $templateFile;\n \n+    const SOCIAL_NETWORKS = [\n+        'facebook',\n+        'twitter',\n+        'rss',\n+        'youtube',\n+        'pinterest',\n+        'vimeo',\n+        'instagram',\n+        'linkedin',\n+    ];\n+\n     public function __construct()\n     {\n         $this->name = 'ps_socialfollow';\n         $this->author = 'PrestaShop';\n-        $this->version = '2.0.0';\n+        $this->version = '2.1.0';\n \n         $this->bootstrap = true;\n         parent::__construct();\n@@ -81,15 +94,7 @@ public function uninstall()\n     public function getContent()\n     {\n         if (Tools::isSubmit('submitModule')) {\n-            Configuration::updateValue('BLOCKSOCIAL_FACEBOOK', Tools::getValue('blocksocial_facebook', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_TWITTER', Tools::getValue('blocksocial_twitter', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_RSS', Tools::getValue('blocksocial_rss', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_YOUTUBE', Tools::getValue('blocksocial_youtube', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_PINTEREST', Tools::getValue('blocksocial_pinterest', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_VIMEO', Tools::getValue('blocksocial_vimeo', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_INSTAGRAM', Tools::getValue('blocksocial_instagram', ''));\n-            Configuration::updateValue('BLOCKSOCIAL_LINKEDIN', Tools::getValue('blocksocial_linkedin', ''));\n-\n+            $this->updateFields();\n             $this->_clearCache('*');\n \n             Tools::redirectAdmin($this->context->link->getAdminLink('AdminModules').'&configure='.$this->name.'&tab_module='.$this->tab.'&conf=4&module_name='.$this->name);\n@@ -180,16 +185,11 @@ public function renderForm()\n \n     public function getConfigFieldsValues()\n     {\n-        return array(\n-            'blocksocial_facebook' => Tools::getValue('blocksocial_facebook', Configuration::get('BLOCKSOCIAL_FACEBOOK')),\n-            'blocksocial_twitter' => Tools::getValue('blocksocial_twitter', Configuration::get('BLOCKSOCIAL_TWITTER')),\n-            'blocksocial_rss' => Tools::getValue('blocksocial_rss', Configuration::get('BLOCKSOCIAL_RSS')),\n-            'blocksocial_youtube' => Tools::getValue('blocksocial_youtube', Configuration::get('BLOCKSOCIAL_YOUTUBE')),\n-            'blocksocial_pinterest' => Tools::getValue('blocksocial_pinterest', Configuration::get('BLOCKSOCIAL_PINTEREST')),\n-            'blocksocial_vimeo' => Tools::getValue('blocksocial_vimeo', Configuration::get('BLOCKSOCIAL_VIMEO')),\n-            'blocksocial_instagram' => Tools::getValue('blocksocial_instagram', Configuration::get('BLOCKSOCIAL_INSTAGRAM')),\n-            'blocksocial_linkedin' => Tools::getValue('blocksocial_linkedin', Configuration::get('BLOCKSOCIAL_LINKEDIN')),\n-        );\n+        $result = [];\n+        foreach (static::SOCIAL_NETWORKS as $social) {\n+            $result['blocksocial_' . $social] = Configuration::get('BLOCKSOCIAL_' . strtoupper($social));\n+        }\n+        return $result;\n     }\n \n     public function renderWidget($hookName = null, array $configuration = [])\n@@ -273,4 +273,23 @@ public function getWidgetVariables($hookName = null, array $configuration = [])\n             'social_links' => $social_links,\n         );\n     }\n+\n+    /**\n+     * Update form fields.\n+     * Check all social networks form value and verify the URL is valid.\n+     * Do nothing if a violation is spotted.\n+     */\n+    protected function updateFields()\n+    {\n+        $validator = Validation::createValidator();\n+        $constraints = [new Url()];\n+\n+        foreach (static::SOCIAL_NETWORKS as $social) {\n+            $value = Tools::getValue('blocksocial_' . $social, '');\n+            $violations = $validator->validate($value, $constraints);\n+            if (0 === count($violations)) {\n+                Configuration::updateValue('BLOCKSOCIAL_' . strtoupper($social), $value);\n+            }\n+        }\n+    }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ae1262ebfe5d3750af6cfcec9d580ad82dcded89",
            "date": "2024-01-10T11:19:43Z",
            "author_login": "Hlavtox"
          },
          {
            "sha": "b2f2a5d80c6e30b7ccfc27c27651fb0825815175",
            "date": "2024-01-10T11:18:21Z",
            "author_login": "Hlavtox"
          },
          {
            "sha": "e479a156d2606c998778127511ae5817e4e25105",
            "date": "2024-01-10T11:17:44Z",
            "author_login": "Hlavtox"
          },
          {
            "sha": "b9d5b5f632292e80b00e5a89889729a9d857c375",
            "date": "2023-12-28T15:05:42Z",
            "author_login": "Hlavtox"
          },
          {
            "sha": "5b4ff2442a73c5bf8a88d935332b9da495cd83bd",
            "date": "2023-12-28T15:00:44Z",
            "author_login": "Hlavtox"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N",
    "cwe_id": "CWE-79",
    "description": "PrestaShop module ps_facetedsearch versions before 2.1.0 has a reflected XSS with social networks fields The problem is fixed in 2.1.0",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-04-16T22:15:13.853",
    "last_modified": "2024-11-21T05:33:51.140",
    "fix_date": "2020-04-15T15:01:19Z"
  },
  "references": [
    {
      "url": "https://github.com/PrestaShop/ps_socialfollow/commit/c1768bf14c0fcf8311bea15fba4ffdda45522d6b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/ps_socialfollow/security/advisories/GHSA-774w-fg8p-7c8w",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/ps_socialfollow/commit/c1768bf14c0fcf8311bea15fba4ffdda45522d6b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PrestaShop/ps_socialfollow/security/advisories/GHSA-774w-fg8p-7c8w",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.945631",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ps_socialfollow",
    "owner": "PrestaShop",
    "created_at": "2016-03-07T09:33:03Z",
    "updated_at": "2023-01-18T14:46:40Z",
    "pushed_at": "2024-07-10T04:37:54Z",
    "size": 142,
    "stars": 7,
    "forks": 21,
    "open_issues": 3,
    "watchers": 7,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "1.7.0.x-prev",
      "dev",
      "master"
    ],
    "languages": {
      "PHP": 22896,
      "Smarty": 1148,
      "Shell": 1066,
      "CSS": 145
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "afl-3.0"
    },
    "collected_at": "2025-01-14T16:33:38.926034"
  }
}