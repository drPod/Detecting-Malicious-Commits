{
  "cve_id": "CVE-2020-6950",
  "github_data": {
    "repository": "eclipse-ee4j/mojarra",
    "fix_commit": "cefbb9447e7be560e59da2da6bd7cb93776f7741",
    "related_commits": [
      "cefbb9447e7be560e59da2da6bd7cb93776f7741",
      "cefbb9447e7be560e59da2da6bd7cb93776f7741"
    ],
    "patch_url": "https://github.com/eclipse-ee4j/mojarra/commit/cefbb9447e7be560e59da2da6bd7cb93776f7741.patch",
    "fix_commit_details": {
      "sha": "cefbb9447e7be560e59da2da6bd7cb93776f7741",
      "commit_date": "2019-09-05T08:12:40Z",
      "author": {
        "login": "ruolli",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Multiple Path Traversal security issues",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
      },
      "files": [
        {
          "filename": "impl/src/main/java/com/sun/faces/application/resource/ClasspathResourceHelper.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -355,7 +355,7 @@ private URL findPathConsideringContracts(ClassLoader loader,\n         } else if (root == null) {\n             String contractName = ctx.getExternalContext().getRequestParameterMap()\n                   .get(\"con\");\n-            if (null != contractName && 0 < contractName.length()) {\n+            if (null != contractName && 0 < contractName.length() && !ResourceManager.nameContainsForbiddenSequence(contractName)) {\n                 contracts = new ArrayList<>();\n                 contracts.add(contractName);\n             } else {"
        },
        {
          "filename": "impl/src/main/java/com/sun/faces/application/resource/ResourceManager.java",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -351,7 +351,7 @@ private String trimLeadingSlash(String s) {\n         }\n     }\n     \n-    private static boolean nameContainsForbiddenSequence(String name) {\n+    static boolean nameContainsForbiddenSequence(String name) {\n         boolean result = false;\n         if (name != null) {\n             name = name.toLowerCase();\n@@ -567,6 +567,8 @@ private String getLocalePrefix(FacesContext context) {\n         \n         if(localePrefix != null && !nameContainsForbiddenSequence(localePrefix)){\n             return localePrefix;\n+        } else {\n+            localePrefix = null; \n         }\n         \n         String appBundleName = context.getApplication().getMessageBundle();"
        },
        {
          "filename": "impl/src/main/java/com/sun/faces/application/resource/WebappResourceHelper.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -315,7 +315,7 @@ private String findPathConsideringContracts(LibraryInfo library,\n         } else if (root == null) {\n             String contractName = ctx.getExternalContext().getRequestParameterMap()\n                   .get(\"con\");\n-            if (null != contractName && 0 < contractName.length()) {\n+            if (null != contractName && 0 < contractName.length() && !ResourceManager.nameContainsForbiddenSequence(contractName)) {\n                 contracts = new ArrayList<>();\n                 contracts.add(contractName);\n             } else {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "539daba9573d4c021ab2d3fcfe4de93f9f50102e",
            "date": "2024-12-28T12:58:11Z",
            "author_login": "BalusC"
          },
          {
            "sha": "55e787888dde6dc6c1c025d3930fb1a485087eee",
            "date": "2024-12-28T12:56:13Z",
            "author_login": "BalusC"
          },
          {
            "sha": "93934edf0f38941a9f8fef06c77fe56b312987d0",
            "date": "2024-12-26T23:49:23Z",
            "author_login": "arjantijms"
          },
          {
            "sha": "99644868bdd33fe1ef061bc6375295bb159ca513",
            "date": "2024-12-26T16:37:23Z",
            "author_login": "BalusC"
          },
          {
            "sha": "fd76e3bd6a80993611cbe201ccf02b6e89486a4e",
            "date": "2024-12-23T09:45:07Z",
            "author_login": "BalusC"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Directory traversal in Eclipse Mojarra before 2.3.14 allows attackers to read arbitrary files via the loc parameter or con parameter.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-06-02T16:15:08.357",
    "last_modified": "2024-11-21T05:36:22.677",
    "fix_date": "2019-09-05T08:12:40Z"
  },
  "references": [
    {
      "url": "https://bugs.eclipse.org/bugs/show_bug.cgi?id=550943",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/eclipse-ee4j/mojarra/commit/cefbb9447e7be560e59da2da6bd7cb93776f7741",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eclipse-ee4j/mojarra/issues/4571",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2022.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.eclipse.org/bugs/show_bug.cgi?id=550943",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/eclipse-ee4j/mojarra/commit/cefbb9447e7be560e59da2da6bd7cb93776f7741",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/eclipse-ee4j/mojarra/issues/4571",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.135620",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mojarra",
    "owner": "eclipse-ee4j",
    "created_at": "2018-04-12T13:53:46Z",
    "updated_at": "2024-12-28T12:58:16Z",
    "pushed_at": "2024-12-28T12:58:16Z",
    "size": 15983,
    "stars": 166,
    "forks": 113,
    "open_issues": 19,
    "watchers": 166,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "2.3",
      "3.0",
      "4.0",
      "EE4J_8",
      "master"
    ],
    "languages": {
      "Java": 4895907,
      "JavaScript": 142199,
      "HTML": 9390,
      "CSS": 8278,
      "XSLT": 2414
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:26:48.772072"
  }
}