{
  "cve_id": "CVE-2020-7597",
  "github_data": {
    "repository": "codecov/codecov-node",
    "fix_commit": "02cf13d8b93ac547b5b4c2cfe186b7d874fd234f",
    "related_commits": [
      "02cf13d8b93ac547b5b4c2cfe186b7d874fd234f",
      "02cf13d8b93ac547b5b4c2cfe186b7d874fd234f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "02cf13d8b93ac547b5b4c2cfe186b7d874fd234f",
      "commit_date": "2020-02-04T15:41:09Z",
      "author": {
        "login": "drazisil",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[CE-1330] Escaping args (#167)",
        "length": 47,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 18,
        "deletions": 13
      },
      "files": [
        {
          "filename": ".gitignore",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -27,3 +27,4 @@ node_modules\n \n lib-cov/\n coverage.json\n+.vs-code"
        },
        {
          "filename": "lib/codecov.js",
          "status": "modified",
          "additions": 10,
          "deletions": 6,
          "patch": "@@ -5,7 +5,6 @@ var urlgrey = require('urlgrey')\n var jsYaml = require('js-yaml')\n var walk = require('ignore-walk')\n var execSync = require('child_process').execSync\n-var validator = require('validator')\n \n var detectProvider = require('./detect')\n \n@@ -394,13 +393,13 @@ var upload = function(args, on_success, on_failure) {\n       if (!isWindows) {\n         gcov =\n           'find ' +\n-          (args.options['gcov-root'] || root) +\n+          (sanitizeVar(args.options['gcov-root']) || root) +\n           \" -type f -name '*.gcno' \" +\n           gcg +\n           ' -exec ' +\n-          (validator.escape(args.options['gcov-exec']) || 'gcov') +\n+          (sanitizeVar(args.options['gcov-exec']) || 'gcov') +\n           ' ' +\n-          (validator.escape(args.options['gcov-args']) || '') +\n+          (sanitizeVar(args.options['gcov-args']) || '') +\n           ' {} +'\n       } else {\n         // @TODO support for root\n@@ -409,9 +408,9 @@ var upload = function(args, on_success, on_failure) {\n           'for /f \"delims=\" %g in (\\'dir /a-d /b /s *.gcno ' +\n           gcg +\n           \"') do \" +\n-          (args.options['gcov-exec'] || 'gcov') +\n+          (sanitizeVar(args.options['gcov-exec']) || 'gcov') +\n           ' ' +\n-          (args.options['gcov-args'] || '') +\n+          (sanitizeVar(args.options['gcov-args']) || '') +\n           ' %g'\n       }\n       debug.push(gcov)\n@@ -556,7 +555,12 @@ var upload = function(args, on_success, on_failure) {\n   }\n }\n \n+function sanitizeVar(arg) {\n+  return arg.replace(/&/g, '')\n+}\n+\n module.exports = {\n+  sanitizeVar: sanitizeVar,\n   upload: upload,\n   version: version,\n   sendToCodecovV2: sendToCodecovV2,"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -6148,11 +6148,6 @@\n         \"spdx-expression-parse\": \"^3.0.0\"\n       }\n     },\n-    \"validator\": {\n-      \"version\": \"12.2.0\",\n-      \"resolved\": \"https://registry.npmjs.org/validator/-/validator-12.2.0.tgz\",\n-      \"integrity\": \"sha512-jJfE/DW6tIK1Ek8nCfNFqt8Wb3nzMoAbocBF6/Icgg1ZFSBpObdnwVY2jQj6qUqzhx5jc71fpvBWyLGO7Xl+nQ==\"\n-    },\n     \"verror\": {\n       \"version\": \"1.10.0\",\n       \"resolved\": \"https://registry.npmjs.org/verror/-/verror-1.10.0.tgz\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,8 +35,7 @@\n     \"ignore-walk\": \"3.0.3\",\n     \"js-yaml\": \"3.13.1\",\n     \"teeny-request\": \"6.0.1\",\n-    \"urlgrey\": \"0.4.4\",\n-    \"validator\": \"12.2.0\"\n+    \"urlgrey\": \"0.4.4\"\n   },\n   \"devDependencies\": {\n     \"eslint\": \"^5.16.0\","
        },
        {
          "filename": "test/index.test.js",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -276,4 +276,10 @@ describe('Codecov', function() {\n     expect(res.query.yaml).toBe(process.cwd() + '/foo.yml')\n     mockFs.restore()\n   })\n+\n+  it('can sanitize inputs', function() {\n+    expect(codecov.sanitizeVar('real & run unsafe & command')).toEqual(\n+      'real  run unsafe  command'\n+    )\n+  })\n })"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7c698b77e3b04abc24a8bbf2e0606d6f77cdba21",
            "date": "2022-02-16T14:52:25Z",
            "author_login": "drazisil-codecov"
          },
          {
            "sha": "4700f3370bd9e11d42a77089a091ade47e085bdc",
            "date": "2022-02-16T14:31:48Z",
            "author_login": "drazisil-codecov"
          },
          {
            "sha": "f45c820d8e7909c8afea02fe9ce7f203838dcb87",
            "date": "2022-02-09T06:01:02Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "86ef8486d549a7b4c49fe78d51d16ff121f2222e",
            "date": "2022-01-19T01:34:26Z",
            "author_login": "drazisil-codecov"
          },
          {
            "sha": "0d8367bd15cd9167a80ff8b94891012aeba0348e",
            "date": "2022-01-18T23:00:54Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "codecov-node npm module before 3.6.5 allows remote attackers to execute arbitrary commands.The value provided as part of the gcov-root argument is executed by the exec function within lib/codecov.js. This vulnerability exists due to an incomplete fix of CVE-2020-7596.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-02-17T19:15:12.367",
    "last_modified": "2024-11-21T05:37:26.790",
    "fix_date": "2020-02-04T15:41:09Z"
  },
  "references": [
    {
      "url": "https://github.com/codecov/codecov-node/commit/02cf13d8b93ac547b5b4c2cfe186b7d874fd234f",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-CODECOV-548879",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/codecov/codecov-node/commit/02cf13d8b93ac547b5b4c2cfe186b7d874fd234f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-CODECOV-548879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:39.853079",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "codecov-node",
    "owner": "codecov",
    "created_at": "2015-10-16T08:27:38Z",
    "updated_at": "2024-11-24T22:29:05Z",
    "pushed_at": "2023-01-06T06:01:14Z",
    "size": 1537,
    "stars": 294,
    "forks": 112,
    "open_issues": 20,
    "watchers": 294,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 67377
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:14:16.828200"
  }
}