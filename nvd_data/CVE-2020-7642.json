{
  "cve_id": "CVE-2020-7642",
  "github_data": {
    "repository": "aFarkas/lazysizes",
    "fix_commit": "3720ab8262552d4e063a38d8492f9490a231fd48",
    "related_commits": [
      "3720ab8262552d4e063a38d8492f9490a231fd48",
      "3720ab8262552d4e063a38d8492f9490a231fd48"
    ],
    "patch_url": "https://github.com/aFarkas/lazysizes/commit/3720ab8262552d4e063a38d8492f9490a231fd48.patch",
    "fix_commit_details": {
      "sha": "3720ab8262552d4e063a38d8492f9490a231fd48",
      "commit_date": "2020-04-15T07:59:40Z",
      "author": {
        "login": "aFarkas",
        "type": "User",
        "stats": {
          "total_commits": 101,
          "average_weekly_commits": 0.18808193668528864,
          "total_additions": 17529,
          "total_deletions": 11450,
          "weeks_active": 37
        }
      },
      "commit_message": {
        "title": "Video embed: test yt/vimeo id (fixes #764)",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 14,
        "deletions": 4
      },
      "files": [
        {
          "filename": "plugins/video-embed/ls.video-embed.js",
          "status": "modified",
          "additions": 13,
          "deletions": 3,
          "patch": "@@ -27,6 +27,7 @@\n \tvar regId = /\\{\\{id}}/;\n \tvar regYtImg = /\\{\\{hqdefault}}/;\n \tvar regAmp = /^&/;\n+\tvar regValidParam = /^[a-z0-9-_&=]+$/i;\n \tvar youtubeImg = protocol + '//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg';\n \tvar youtubeIframe = protocol + '//www.youtube.com/embed/{{id}}?autoplay=1';\n \tvar vimeoApi = protocol + '//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}';\n@@ -64,6 +65,12 @@\n \t\tvar id = elem.getAttribute('data-vimeo');\n \t\tvar vimeoParams = elem.getAttribute('data-vimeoparams') || '';\n \n+\t\telem.removeEventListener('click', embedVimeoIframe);\n+\n+\t\tif (!id || !regValidParam.test(id) || (vimeoParams && !regValidParam.test(vimeoParams))) {\n+\t\t\treturn;\n+\t\t}\n+\n \t\tif(vimeoParams && !regAmp.test(vimeoParams)){\n \t\t\tvimeoParams = '&'+ vimeoParams;\n \t\t}\n@@ -74,7 +81,6 @@\n \t\t\t'frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>'\n \t\t;\n \n-\t\telem.removeEventListener('click', embedVimeoIframe);\n \t}\n \n \tfunction embedYoutubeImg(id, elem){\n@@ -89,6 +95,12 @@\n \t\tvar id = elem.getAttribute('data-youtube');\n \t\tvar youtubeParams = elem.getAttribute('data-ytparams') || '';\n \n+\t\telem.removeEventListener('click', embedYoutubeIframe);\n+\n+\t\tif (!id || !regValidParam.test(id) || (youtubeParams && !regValidParam.test(youtubeParams))) {\n+\t\t\treturn;\n+\t\t}\n+\n \t\tif(youtubeParams && !regAmp.test(youtubeParams)){\n \t\t\tyoutubeParams = '&'+ youtubeParams;\n \t\t}\n@@ -98,8 +110,6 @@\n \t\telem.innerHTML = '<iframe src=\"' + (youtubeIframe.replace(regId, id)) + youtubeParams +'\" ' +\n \t\t\t'frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>'\n \t\t;\n-\n-\t\telem.removeEventListener('click', embedYoutubeIframe);\n \t}\n \n \tdocument.addEventListener('lazybeforeunveil', function(e){"
        },
        {
          "filename": "plugins/video-embed/ls.video-embed.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,2 +1,2 @@\n /*! lazysizes - v5.2.0 */\n-!function(a,b){if(a){var c=function(){b(a.lazySizes),a.removeEventListener(\"lazyunveilread\",c,!0)};b=b.bind(null,a,a.document),\"object\"==typeof module&&module.exports?b(require(\"lazysizes\")):a.lazySizes?c():a.addEventListener(\"lazyunveilread\",c,!0)}}(\"undefined\"!=typeof window?window:0,function(a,b,c){\"use strict\";function d(c,d){var e=\"vimeoCallback\"+j,f=b.createElement(\"script\");c+=\"&callback=\"+e,j++,a[e]=function(b){f.parentNode.removeChild(f),delete a[e],d(b)},f.src=c,b.head.appendChild(f)}function e(a,b){d(p.replace(k,a),function(a){a&&a.thumbnail_url&&(b.style.backgroundImage=\"url(\"+a.thumbnail_url+\")\")}),b.addEventListener(\"click\",f)}function f(a){var b=a.currentTarget,c=b.getAttribute(\"data-vimeo\"),d=b.getAttribute(\"data-vimeoparams\")||\"\";d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+q.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>',b.removeEventListener(\"click\",f)}function g(a,b){var d=b.getAttribute(\"data-thumb-size\")||c.cfg.ytThumb||\"hqdefault\";b.style.backgroundImage=\"url(\"+n.replace(k,a).replace(l,d)+\")\",b.addEventListener(\"click\",h)}function h(a){var b=a.currentTarget,c=b.getAttribute(\"data-youtube\"),d=b.getAttribute(\"data-ytparams\")||\"\";d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+o.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>',b.removeEventListener(\"click\",h)}if(b.getElementsByClassName){var i=\"https:\"==location.protocol?\"https:\":\"http:\",j=Date.now(),k=/\\{\\{id}}/,l=/\\{\\{hqdefault}}/,m=/^&/,n=i+\"//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg\",o=i+\"//www.youtube.com/embed/{{id}}?autoplay=1\",p=i+\"//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}\",q=i+\"//player.vimeo.com/video/{{id}}?autoplay=1\";b.addEventListener(\"lazybeforeunveil\",function(a){if(a.detail.instance==c){var b=a.target,d=b.getAttribute(\"data-youtube\"),f=b.getAttribute(\"data-vimeo\");d&&b&&g(d,b),f&&b&&e(f,b)}})}});\n\\ No newline at end of file\n+!function(a,b){if(a){var c=function(){b(a.lazySizes),a.removeEventListener(\"lazyunveilread\",c,!0)};b=b.bind(null,a,a.document),\"object\"==typeof module&&module.exports?b(require(\"lazysizes\")):a.lazySizes?c():a.addEventListener(\"lazyunveilread\",c,!0)}}(\"undefined\"!=typeof window?window:0,function(a,b,c){\"use strict\";function d(c,d){var e=\"vimeoCallback\"+j,f=b.createElement(\"script\");c+=\"&callback=\"+e,j++,a[e]=function(b){f.parentNode.removeChild(f),delete a[e],d(b)},f.src=c,b.head.appendChild(f)}function e(a,b){d(q.replace(k,a),function(a){a&&a.thumbnail_url&&(b.style.backgroundImage=\"url(\"+a.thumbnail_url+\")\")}),b.addEventListener(\"click\",f)}function f(a){var b=a.currentTarget,c=b.getAttribute(\"data-vimeo\"),d=b.getAttribute(\"data-vimeoparams\")||\"\";b.removeEventListener(\"click\",f),c&&n.test(c)&&(!d||n.test(d))&&(d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+r.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>')}function g(a,b){var d=b.getAttribute(\"data-thumb-size\")||c.cfg.ytThumb||\"hqdefault\";b.style.backgroundImage=\"url(\"+o.replace(k,a).replace(l,d)+\")\",b.addEventListener(\"click\",h)}function h(a){var b=a.currentTarget,c=b.getAttribute(\"data-youtube\"),d=b.getAttribute(\"data-ytparams\")||\"\";b.removeEventListener(\"click\",h),c&&n.test(c)&&(!d||n.test(d))&&(d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+p.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>')}if(b.getElementsByClassName){var i=\"https:\"==location.protocol?\"https:\":\"http:\",j=Date.now(),k=/\\{\\{id}}/,l=/\\{\\{hqdefault}}/,m=/^&/,n=/^[a-z0-9-_&=]+$/i,o=i+\"//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg\",p=i+\"//www.youtube.com/embed/{{id}}?autoplay=1\",q=i+\"//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}\",r=i+\"//player.vimeo.com/video/{{id}}?autoplay=1\";b.addEventListener(\"lazybeforeunveil\",function(a){if(a.detail.instance==c){var b=a.target,d=b.getAttribute(\"data-youtube\"),f=b.getAttribute(\"data-vimeo\");d&&b&&g(d,b),f&&b&&e(f,b)}})}});\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1523a4ff4579e170355c7607f445689b43229caf",
            "date": "2021-05-17T09:26:41Z",
            "author_login": "aFarkas"
          },
          {
            "sha": "27c7ceb7d7371c66d00203e1395d2cf2b357c78b",
            "date": "2021-04-08T15:15:54Z",
            "author_login": "aFarkas"
          },
          {
            "sha": "bb4581281dece0ca50520d52ef2dd990ec705cd9",
            "date": "2021-04-08T15:02:12Z",
            "author_login": "aFarkas"
          },
          {
            "sha": "499f0f834f8421d0a1d4754c1863f37eb8ebfe36",
            "date": "2021-03-31T04:01:40Z",
            "author_login": "aFarkas"
          },
          {
            "sha": "d00a90675e14f3afe0b654c214e05c46e6633c51",
            "date": "2021-03-31T03:35:36Z",
            "author_login": "aFarkas"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "lazysizes through 5.2.0 allows execution of malicious JavaScript. The following attributes are not sanitized by the video-embed plugin: data-vimeo, data-vimeoparams, data-youtube and data-ytparams which can be abused to inject malicious JavaScript.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-04-22T16:15:13.077",
    "last_modified": "2024-11-21T05:37:31.590",
    "fix_date": "2020-04-15T07:59:40Z"
  },
  "references": [
    {
      "url": "https://github.com/aFarkas/lazysizes/commit/3720ab8262552d4e063a38d8492f9490a231fd48",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-LAZYSIZES-567144",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aFarkas/lazysizes/commit/3720ab8262552d4e063a38d8492f9490a231fd48",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-LAZYSIZES-567144",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:00:44.952010",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lazysizes",
    "owner": "aFarkas",
    "created_at": "2014-10-11T21:03:26Z",
    "updated_at": "2025-01-14T08:39:08Z",
    "pushed_at": "2024-04-03T08:17:04Z",
    "size": 2904,
    "stars": 17592,
    "forks": 1729,
    "open_issues": 206,
    "watchers": 17592,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 221166,
      "HTML": 131485,
      "CSS": 16973
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T12:58:49.653532"
  }
}