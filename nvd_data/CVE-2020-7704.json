{
  "cve_id": "CVE-2020-7704",
  "github_data": {
    "repository": "piranna/linux-cmdline",
    "fix_commit": "53c61a88bc47eb25d71832205056beaab95cf677",
    "related_commits": [
      "53c61a88bc47eb25d71832205056beaab95cf677",
      "53c61a88bc47eb25d71832205056beaab95cf677"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "53c61a88bc47eb25d71832205056beaab95cf677",
      "commit_date": "2020-08-14T23:41:49Z",
      "author": {
        "login": "piranna",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[fix] Don't pollute prototype",
        "length": 29,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 49,
        "additions": 37,
        "deletions": 12
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 22,
          "deletions": 12,
          "patch": "@@ -5,17 +5,6 @@ function reducer(result, arg)\n   // Get key node\n   const keypath = arg.shift().split('.')\n \n-  let key = keypath.shift()\n-  let node = result\n-\n-  while(keypath.length)\n-  {\n-    node[key] = node[key] || {}\n-    node = node[key]\n-\n-    key = keypath.shift()\n-  }\n-\n   // Get value\n   let val = true\n   if(arg.length)\n@@ -24,8 +13,29 @@ function reducer(result, arg)\n     if(val.length === 1) val = val[0]\n   }\n \n+  let key = keypath.shift()\n+\n+  if(!keypath.length) return {...result, [key]: val}\n+\n+  if(!result.hasOwnProperty(key)) result = {...result, [key]: {}}\n+\n+  let newKey\n+  let newNode\n+  let node = result\n+\n+  while(true)\n+  {\n+    newKey = keypath.shift()\n+    newNode = node[key]\n+\n+    if(!keypath.length) break\n+\n+    node = node[key] = {...newNode, [newKey]: newNode[newKey] || {}}\n+    key = newKey\n+  }\n+\n   // Store value\n-  node[key] = val\n+  node[key] = {...newNode, [newKey]: val}\n \n   return result\n }"
        },
        {
          "filename": "test.js",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -19,3 +19,18 @@ const expected =\n const result = linuxCmdline(cmdline)\n \n deepStrictEqual(result, expected)\n+\n+\n+// Don't pollute prototype\n+const result2 = linuxCmdline('__proto__.polluted=foo')\n+const expected2 =\n+{\n+  ['__proto__']:\n+  {\n+    polluted: 'foo'\n+  }\n+}\n+\n+deepStrictEqual(result2, expected2)\n+\n+deepStrictEqual({}.__proto__.polluted, undefined)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6c54d57158ecfa924e7755a8022b915496184e3f",
            "date": "2020-08-14T23:43:06Z",
            "author_login": "piranna"
          },
          {
            "sha": "fe515fed99def7f5bbcb70747e13fbec369ef51d",
            "date": "2020-08-14T23:41:56Z",
            "author_login": "piranna"
          },
          {
            "sha": "53c61a88bc47eb25d71832205056beaab95cf677",
            "date": "2020-08-14T23:41:49Z",
            "author_login": "piranna"
          },
          {
            "sha": "8b9f39656aabfa59b1b8b8a80b83fd192de8a73e",
            "date": "2020-08-14T17:16:17Z",
            "author_login": "piranna"
          },
          {
            "sha": "573db95468079b26b37813f1a19d3b78b5a590f3",
            "date": "2020-08-14T17:16:03Z",
            "author_login": "piranna"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-1321",
    "description": "The package linux-cmdline before 1.0.1 are vulnerable to Prototype Pollution via the constructor.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2020-08-17T17:15:14.097",
    "last_modified": "2024-11-21T05:37:38.737",
    "fix_date": "2020-08-14T23:41:49Z"
  },
  "references": [
    {
      "url": "https://github.com/piranna/linux-cmdline/commit/53c61a88bc47eb25d71832205056beaab95cf677",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-LINUXCMDLINE-598674",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/piranna/linux-cmdline/commit/53c61a88bc47eb25d71832205056beaab95cf677",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-LINUXCMDLINE-598674",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:03.796788",
    "processing_status": "enhanced"
  }
}