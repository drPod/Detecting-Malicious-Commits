{
  "cve_id": "CVE-2021-21259",
  "github_data": {
    "repository": "hedgedoc/hedgedoc",
    "fix_commit": "35b0d39a12aa35f27fba8c1f50b1886706e7efef",
    "related_commits": [
      "35b0d39a12aa35f27fba8c1f50b1886706e7efef",
      "35b0d39a12aa35f27fba8c1f50b1886706e7efef"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "35b0d39a12aa35f27fba8c1f50b1886706e7efef",
      "commit_date": "2021-01-14T01:51:08Z",
      "author": {
        "login": "DerMolly",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "added sanitation to the slideMode in frontmatter",
        "length": 585,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 51,
        "additions": 50,
        "deletions": 1
      },
      "files": [
        {
          "filename": "public/js/slide.js",
          "status": "modified",
          "additions": 50,
          "deletions": 1,
          "patch": "@@ -72,7 +72,56 @@ const defaultOptions = {\n \n // options from yaml meta\n const meta = JSON.parse($('#meta').text())\n-var options = meta.slideOptions || {}\n+var options = {\n+  autoPlayMedia: meta.slideOptions.autoPlayMedia,\n+  autoSlide: meta.slideOptions.autoSlide,\n+  autoSlideStoppable: meta.slideOptions.autoSlideStoppable,\n+  backgroundTransition: meta.slideOptions.backgroundTransition,\n+  center: meta.slideOptions.center,\n+  controls: meta.slideOptions.controls,\n+  controlsBackArrows: meta.slideOptions.controlsBackArrows,\n+  controlsLayout: meta.slideOptions.controlsLayout,\n+  controlsTutorial: meta.slideOptions.controlsTutorial,\n+  defaultTiming: meta.slideOptions.defaultTiming,\n+  display: meta.slideOptions.display,\n+  embedded: meta.slideOptions.embedded,\n+  fragmentInURL: meta.slideOptions.fragmentInURL,\n+  fragments: meta.slideOptions.fragments,\n+  hash: meta.slideOptions.hash,\n+  height: meta.slideOptions.height,\n+  help: meta.slideOptions.help,\n+  hideAddressBar: meta.slideOptions.hideAddressBar,\n+  hideCursorTime: meta.slideOptions.hideCursorTime,\n+  hideInactiveCursor: meta.slideOptions.hideInactiveCursor,\n+  history: meta.slideOptions.history,\n+  keyboard: meta.slideOptions.keyboard,\n+  loop: meta.slideOptions.loop,\n+  margin: meta.slideOptions.margin,\n+  maxScale: meta.slideOptions.maxScale,\n+  minScale: meta.slideOptions.minScale,\n+  minimumTimePerSlide: meta.slideOptions.minimumTimePerSlide,\n+  mobileViewDistance: meta.slideOptions.mobileViewDistance,\n+  mouseWheel: meta.slideOptions.mouseWheel,\n+  navigationMode: meta.slideOptions.navigationMode,\n+  overview: meta.slideOptions.overview,\n+  parallaxBackgroundHorizontal: meta.slideOptions.parallaxBackgroundHorizontal,\n+  parallaxBackgroundImage: meta.slideOptions.parallaxBackgroundImage,\n+  parallaxBackgroundSize: meta.slideOptions.parallaxBackgroundSize,\n+  parallaxBackgroundVertical: meta.slideOptions.parallaxBackgroundVertical,\n+  preloadIframes: meta.slideOptions.preloadIframes,\n+  previewLinks: meta.slideOptions.previewLinks,\n+  progress: meta.slideOptions.progress,\n+  rtl: meta.slideOptions.rtl,\n+  showNotes: meta.slideOptions.showNotes,\n+  shuffle: meta.slideOptions.shuffle,\n+  slideNumber: meta.slideOptions.slideNumber,\n+  totalTime: meta.slideOptions.totalTime,\n+  touch: meta.slideOptions.touch,\n+  transition: meta.slideOptions.transition,\n+  transitionSpeed: meta.slideOptions.transitionSpeed,\n+  viewDistance: meta.slideOptions.viewDistance,\n+  width: meta.slideOptions.width\n+} || {}\n \n const view = $('.reveal')\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3a90a750fd068311aa01e0a6f1c465c39c5b2866",
            "date": "2025-01-18T00:32:18Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "e61777612f081f63f85efaa64e2306c88fb45c21",
            "date": "2024-12-30T20:51:24Z",
            "author_login": "Trayshar"
          },
          {
            "sha": "94bb6e9c9f48d59bdd8dce628b81bed486051626",
            "date": "2025-01-04T04:21:03Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "0439e70d888fbdfa5209d710482c05610da51f86",
            "date": "2024-12-18T19:20:34Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "24e2063d6a6be7312c6d0e4abfabcdb46fcb6fcc",
            "date": "2024-12-18T18:22:13Z",
            "author_login": "ErikMichelson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-22T17:15:12.867",
    "last_modified": "2024-11-21T05:47:52.797",
    "fix_date": "2021-01-14T01:51:08Z"
  },
  "references": [
    {
      "url": "https://github.com/hackmdio/codimd/issues/1648",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/commit/35b0d39a12aa35f27fba8c1f50b1886706e7efef",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/releases/tag/1.7.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-44w9-vm8p-3cxw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hackmdio/codimd/issues/1648",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/commit/35b0d39a12aa35f27fba8c1f50b1886706e7efef",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/releases/tag/1.7.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-44w9-vm8p-3cxw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.161910",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "hedgedoc",
    "owner": "hedgedoc",
    "created_at": "2019-03-27T12:14:01Z",
    "updated_at": "2025-01-25T21:33:01Z",
    "pushed_at": "2025-01-24T21:14:35Z",
    "size": 104362,
    "stars": 5413,
    "forks": 413,
    "open_issues": 254,
    "watchers": 5413,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "TypeScript": 2960544,
      "SCSS": 99279,
      "JavaScript": 13932,
      "Dockerfile": 4079,
      "Shell": 3027,
      "CSS": 1071
    },
    "commit_activity": {
      "total_commits_last_year": 330,
      "avg_commits_per_week": 6.346153846153846,
      "days_active_last_year": 54
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T07:53:05.049628"
  }
}