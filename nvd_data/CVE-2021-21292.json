{
  "cve_id": "CVE-2021-21292",
  "github_data": {
    "repository": "traccar/traccar",
    "fix_commit": "cc69a9907ac9878db3750aa14ffedb28626455da",
    "related_commits": [
      "cc69a9907ac9878db3750aa14ffedb28626455da",
      "cc69a9907ac9878db3750aa14ffedb28626455da"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "cc69a9907ac9878db3750aa14ffedb28626455da",
      "commit_date": "2021-01-01T22:50:35Z",
      "author": {
        "login": "tananaev",
        "type": "User",
        "stats": {
          "total_commits": 6084,
          "average_weekly_commits": 7.870633893919793,
          "total_additions": 367168,
          "total_deletions": 264965,
          "weeks_active": 659
        }
      },
      "commit_message": {
        "title": "Quote binary path",
        "length": 17,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/main/java/org/traccar/WindowsService.java",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,5 +1,5 @@\n /*\n- * Copyright 2018 Anton Tananaev (anton@traccar.org)\n+ * Copyright 2018 - 2020 Anton Tananaev (anton@traccar.org)\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -50,7 +50,7 @@ public void install(\n             String account, String password, String config) throws URISyntaxException {\n \n         String javaHome = System.getProperty(\"java.home\");\n-        String javaBinary = javaHome + \"\\\\bin\\\\java.exe\";\n+        String javaBinary = \"\\\"\" + javaHome + \"\\\\bin\\\\java.exe\\\"\";\n \n         File jar = new File(WindowsService.class.getProtectionDomain().getCodeSource().getLocation().toURI());\n         String command = javaBinary"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "edf1ffdc3895c0960b1853a44a418cd29e5123a9",
            "date": "2025-01-26T00:44:00Z",
            "author_login": "tananaev"
          },
          {
            "sha": "a16ad4de29b321386ac0feb2a4a8404b6134b9d9",
            "date": "2025-01-24T14:51:26Z",
            "author_login": "tananaev"
          },
          {
            "sha": "3bba6ec887baa31bdf9012497758a78c0cd521c1",
            "date": "2025-01-23T15:30:20Z",
            "author_login": "tananaev"
          },
          {
            "sha": "2763d8f580d654f819f5daffca8f0eacb0ad9171",
            "date": "2025-01-23T15:26:08Z",
            "author_login": "tananaev"
          },
          {
            "sha": "c50c8db7455fec3e44caa072a3728295569e73b9",
            "date": "2025-01-23T05:43:41Z",
            "author_login": "tananaev"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:N/I:H/A:N",
    "cwe_id": "CWE-428",
    "description": "Traccar is an open source GPS tracking system. In Traccar before version 4.12 there is an unquoted Windows binary path vulnerability. Only Windows versions are impacted. Attacker needs write access to the filesystem on the host machine. If Java path includes a space, then attacker can lift their privilege to the same as Traccar service (system). This is fixed in version 4.12.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-02-02T20:15:12.173",
    "last_modified": "2024-11-21T05:47:57.117",
    "fix_date": "2021-01-01T22:50:35Z"
  },
  "references": [
    {
      "url": "https://github.com/traccar/traccar/commit/cc69a9907ac9878db3750aa14ffedb28626455da",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/security/advisories/GHSA-j75r-7qm5-62q5",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.traccar.org/",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/commit/cc69a9907ac9878db3750aa14ffedb28626455da",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/security/advisories/GHSA-j75r-7qm5-62q5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.traccar.org/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.180251",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "traccar",
    "owner": "traccar",
    "created_at": "2012-04-16T08:33:49Z",
    "updated_at": "2025-01-26T00:44:12Z",
    "pushed_at": "2025-01-26T00:44:05Z",
    "size": 23344,
    "stars": 5506,
    "forks": 2659,
    "open_issues": 442,
    "watchers": 5506,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 5082043,
      "Python": 44005,
      "Shell": 16305,
      "Inno Setup": 516
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:07:59.209489"
  }
}