{
  "cve_id": "CVE-2021-21307",
  "github_data": {
    "repository": "lucee/Lucee",
    "fix_commit": "6208ab7c44c61d26c79e0b0af10382899f57e1ca",
    "related_commits": [
      "6208ab7c44c61d26c79e0b0af10382899f57e1ca",
      "6208ab7c44c61d26c79e0b0af10382899f57e1ca"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "6208ab7c44c61d26c79e0b0af10382899f57e1ca",
      "commit_date": "2020-10-26T14:57:27Z",
      "author": {
        "login": "michaeloffner",
        "type": "User",
        "stats": {
          "total_commits": 6025,
          "average_weekly_commits": 12.270875763747455,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 395
        }
      },
      "commit_message": {
        "title": "fixes LDEV-3119",
        "length": 15,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 13,
        "deletions": 2
      },
      "files": [
        {
          "filename": "core/src/main/cfml/context/admin/Application.cfc",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -32,6 +32,17 @@ this.sessionCookie.httpOnly = true; // prevent access to session cookies from ja\n this.sessionCookie.sameSite = \"strict\";\n this.tag.cookie.sameSite = \"strict\";\n \n+public function onRequestStart() {\n+\t// if not logged in, we only allow access to admin|web|server[.cfm]\n+\tif(!structKeyExists(session, \"passwordWeb\") && !structKeyExists(session, \"passwordServer\")){\n+\t\tvar fileName=listLast(cgi.script_name,\"/\");\n+\t\tif(fileName!=\"admin.cfm\" && fileName!=\"web.cfm\" && fileName!=\"server.cfm\") {\n+\t\t\tcfheader(statuscode=\"404\" statustext=\"Invalid access\");\n+        \tabort;\n+\t\t}\n+\t}\n+}\n+\n public function onApplicationStart(){\n \tif(structKeyExists(server.system.environment,\"LUCEE_ADMIN_ENABLED\") && server.system.environment.LUCEE_ADMIN_ENABLED EQ false){\n \t\tcfheader(statuscode=\"404\" statustext=\"Invalid access\");"
        },
        {
          "filename": "loader/build.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <project default=\"core\" basedir=\".\" name=\"Lucee\" xmlns:artifact=\"antlib:org.apache.maven.artifact.ant\">\n \n-  <property name=\"version\" value=\"5.3.8.88-SNAPSHOT\"/>\n+  <property name=\"version\" value=\"5.3.8.89-SNAPSHOT\"/>\n \n   <path id=\"maven-ant-tasks.classpath\" path=\"../ant/lib/maven-ant-tasks-2.1.3.jar\" />\n   <typedef resource=\"org/apache/maven/artifact/ant/antlib.xml\""
        },
        {
          "filename": "loader/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n \n   <groupId>org.lucee</groupId>\n   <artifactId>lucee</artifactId>\n-  <version>5.3.8.88-SNAPSHOT</version>\n+  <version>5.3.8.89-SNAPSHOT</version>\n   <packaging>jar</packaging>\n \n   <name>Lucee Loader Build</name>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2916178910d261a2639f24d8b64df1cae1e9da6e",
            "date": "2025-01-24T20:31:25Z",
            "author_login": "michaeloffner"
          },
          {
            "sha": "f9bb95ddc11f5c550b609628a80df6dc3784e433",
            "date": "2025-01-24T20:27:16Z",
            "author_login": "michaeloffner"
          },
          {
            "sha": "556d84ece9c1a3da6e8f111acafa9b6015023731",
            "date": "2025-01-24T19:21:44Z",
            "author_login": "michaeloffner"
          },
          {
            "sha": "5217fcb3320f6e535084693b4365807233cd7c62",
            "date": "2025-01-24T16:42:03Z",
            "author_login": "michaeloffner"
          },
          {
            "sha": "6abb87b74c0b88340156c0bf8881352cd0f75c8b",
            "date": "2025-01-24T15:48:05Z",
            "author_login": "michaeloffner"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N",
    "cwe_id": "CWE-862",
    "description": "Lucee Server is a dynamic, Java based (JSR-223), tag and scripting language used for rapid web application development. In Lucee Admin before versions 5.3.7.47, 5.3.6.68 or 5.3.5.96 there is an unauthenticated remote code exploit. This is fixed in versions 5.3.7.47, 5.3.6.68 or 5.3.5.96. As a workaround, one can block access to the Lucee Administrator.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-11T19:15:13.313",
    "last_modified": "2024-11-21T05:47:59.323",
    "fix_date": "2020-10-26T14:57:27Z"
  },
  "references": [
    {
      "url": "http://ciacfug.org/blog/updating-lucee-as-part-of-a-vulnerability-alert-response",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/163864/Lucee-Administrator-imgProcess.cfm-Arbitrary-File-Write.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://dev.lucee.org/t/lucee-vulnerability-alert-november-2020/7643",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/httpvoid/writeups/blob/main/Apple-RCE.md",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lucee/Lucee/commit/6208ab7c44c61d26c79e0b0af10382899f57e1ca",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lucee/Lucee/security/advisories/GHSA-2xvv-723c-8p7r",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://portswigger.net/daily-swig/security-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal",
      "source": "security-advisories@github.com",
      "tags": [
        "Press/Media Coverage",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://ciacfug.org/blog/updating-lucee-as-part-of-a-vulnerability-alert-response",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/163864/Lucee-Administrator-imgProcess.cfm-Arbitrary-File-Write.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://dev.lucee.org/t/lucee-vulnerability-alert-november-2020/7643",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/httpvoid/writeups/blob/main/Apple-RCE.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lucee/Lucee/commit/6208ab7c44c61d26c79e0b0af10382899f57e1ca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lucee/Lucee/security/advisories/GHSA-2xvv-723c-8p7r",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://portswigger.net/daily-swig/security-researchers-earn-50k-after-exposing-critical-flaw-in-apple-travel-portal",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Press/Media Coverage",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.197037",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "Lucee",
    "owner": "lucee",
    "created_at": "2015-09-11T14:39:08Z",
    "updated_at": "2025-01-24T20:31:32Z",
    "pushed_at": "2025-01-24T20:31:27Z",
    "size": 117891,
    "stars": 868,
    "forks": 183,
    "open_issues": 65,
    "watchers": 868,
    "has_security_policy": false,
    "default_branch": "6.2",
    "protected_branches": [
      "5.2.1",
      "5.2.2",
      "5.2.3",
      "5.2.4",
      "5.2.6",
      "5.2.7",
      "5.2.8",
      "5.2.9.37",
      "5.3.8"
    ],
    "languages": {
      "Java": 14603259,
      "ColdFusion": 7109206,
      "JavaScript": 31402,
      "CSS": 30269,
      "XSLT": 19626,
      "Shell": 810,
      "HTML": 15
    },
    "commit_activity": {
      "total_commits_last_year": 2036,
      "avg_commits_per_week": 39.15384615384615,
      "days_active_last_year": 258
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-26T07:43:27.859708"
  }
}