{
  "cve_id": "CVE-2021-21311",
  "github_data": {
    "repository": "vrana/adminer",
    "fix_commit": "ccd2374b0b12bd547417bf0dacdf153826c83351",
    "related_commits": [
      "ccd2374b0b12bd547417bf0dacdf153826c83351",
      "ccd2374b0b12bd547417bf0dacdf153826c83351"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "ccd2374b0b12bd547417bf0dacdf153826c83351",
      "commit_date": "2021-02-05T15:16:23Z",
      "author": {
        "login": "vrana",
        "type": "User",
        "stats": {
          "total_commits": 2095,
          "average_weekly_commits": 2.279651795429815,
          "total_additions": 44953,
          "total_deletions": 21292,
          "weeks_active": 247
        }
      },
      "commit_message": {
        "title": "Elasticsearch, ClickHouse: Do not print response if HTTP code is not 200",
        "length": 115,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "adminer/drivers/clickhouse.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@ function rootQuery($db, $query) {\n \t\t\t\treturn $file;\n \t\t\t}\n \t\t\tif (!preg_match('~^HTTP/[0-9.]+ 2~i', $http_response_header[0])) {\n-\t\t\t\t$this->error = $file;\n+\t\t\t\t$this->error = lang('Invalid credentials.') . \" $http_response_header[0]\";\n \t\t\t\treturn false;\n \t\t\t}\n \t\t\t$return = json_decode($file, true);"
        },
        {
          "filename": "adminer/drivers/elastic.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -28,7 +28,7 @@ function rootQuery($path, $content = array(), $method = 'GET') {\n \t\t\t\t\treturn $file;\n \t\t\t\t}\n \t\t\t\tif (!preg_match('~^HTTP/[0-9.]+ 2~i', $http_response_header[0])) {\n-\t\t\t\t\t$this->error = $file;\n+\t\t\t\t\t$this->error = lang('Invalid credentials.') . \" $http_response_header[0]\";\n \t\t\t\t\treturn false;\n \t\t\t\t}\n \t\t\t\t$return = json_decode($file, true);"
        },
        {
          "filename": "changes.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1,4 +1,5 @@\n Adminer 4.7.9-dev:\n+Elasticsearch, ClickHouse: Do not print response if HTTP code is not 200\n Re-enable PHP warnings (regression from 4.7.8)\n \n Adminer 4.7.8 (released 2020-12-06):"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88647b93e467210f270340e758af6771e2c5638a",
            "date": "2021-04-29T09:35:05Z",
            "author_login": "Limpan"
          },
          {
            "sha": "b8c5eec46d12b6b752e3d7daf30bec75343cb357",
            "date": "2021-05-23T10:50:14Z",
            "author_login": "vrana"
          },
          {
            "sha": "dadbb37f004242fdbca2fe8aa6f76186767483ae",
            "date": "2021-05-23T09:45:57Z",
            "author_login": "vrana"
          },
          {
            "sha": "ea1acfc8bcbbbb7073fc96a03e4065f64165d5ee",
            "date": "2021-05-23T09:38:51Z",
            "author_login": "vrana"
          },
          {
            "sha": "2dd65f0c0f711fe33051954ddde64a78cdea0893",
            "date": "2021-05-23T09:38:04Z",
            "author_login": "vrana"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-918",
    "description": "Adminer is an open-source database management in a single PHP file. In adminer from version 4.0.0 and before 4.7.9 there is a server-side request forgery vulnerability. Users of Adminer versions bundling all drivers (e.g. `adminer.php`) are affected. This is fixed in version 4.7.9.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-11T21:15:13.820",
    "last_modified": "2024-11-21T05:47:59.810",
    "fix_date": "2021-02-05T15:16:23Z"
  },
  "references": [
    {
      "url": "https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00002.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packagist.org/packages/vrana/adminer",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00002.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packagist.org/packages/vrana/adminer",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.197690",
    "processing_status": "enhanced"
  }
}