{
  "cve_id": "CVE-2021-21317",
  "github_data": {
    "repository": "ua-parser/uap-core",
    "fix_commit": "dc9925d458214cfe87b93e35346980612f6ae96c",
    "related_commits": [
      "dc9925d458214cfe87b93e35346980612f6ae96c",
      "dc9925d458214cfe87b93e35346980612f6ae96c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "dc9925d458214cfe87b93e35346980612f6ae96c",
      "commit_date": "2021-01-30T08:40:13Z",
      "author": {
        "login": "commenthol",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-p4pj-mg4r-x6v4",
        "length": 55,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 1577,
        "additions": 902,
        "deletions": 675
      },
      "files": [
        {
          "filename": "regexes.yaml",
          "status": "modified",
          "additions": 621,
          "deletions": 626,
          "patch": null
        },
        {
          "filename": "tests/regexes.js",
          "status": "modified",
          "additions": 271,
          "deletions": 39,
          "patch": "@@ -42,48 +42,280 @@ suite('regexes', function () {\n \n })\n \n-suite('redos', function () {\n-  var parse = refImpl(regexes).parse\n+suite('redos', function(){\n+  const parse = refImpl(regexes).parse\n \n-  function timer () {\n-    var start = Date.now()\n-    return function () {\n-      return Date.now() - start\n-    }\n-  }\n+  const tests = [\n+    '\"a\"+\"a\"*3500+\"a\"',\n+    '\"SmartWatch\"+\" \"*3500+\"z\"',\n+    '\";A Build HuaweiA\"+\"4\"*3500+\"z\"',\n+    '\"HbbTV/0.0.0 (;LGE;\"+\" \"*3500+\"z\"',\n+    '\"HbbTV/0.0.0 (;CUS:;\"+\" \"*3500+\"z\"',\n+    '\"HbbTV/0.0.0 (;\"+\" \"*3500+\"z\"',\n+    '\"HbbTV/0.0.0 (;z;\"+\" \"*3500+\"z\"',\n+    '\"AppleWebKit/1.\"+\"0\"*10000+\"!\"',\n+    '\"AppleWebKit/1.1\"+\" Safari\"*10000+\"!\"',\n+    '\"/0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"Mozilla\"+\"Mobile\"*10000+\"!\"',\n+    '\"Mozilla\"+\"Mobile\"*10000+\"!\"',\n+    '\"Mozilla\"+\"Mobile\"*10000+\"!\"',\n+    '\"Mozilla\"+\"Mobile\"*10000+\"!\"',\n+    '\"Mozilla\"+\"Mobile\"*10000+\"!\"',\n+    '\"Opera/\"+\"Opera Mobi\"*10000+\"!\"',\n+    '\"Opera/1.\"+\"0\"*10000+\"!\"',\n+    '\"Mozilla\"+\"Android\"*10000+\"!\"',\n+    '\"Chrome/1.1.\"+\"0\"*10000+\"!\"',\n+    '\"Chrome/1.1.\"+\"0\"*10000+\"!\"',\n+    '\"MSIE 1.\"+\"0\"*10000+\"!\"',\n+    '\"iPod\"+\"Version/1.1\"*10000+\"!\"',\n+    '\"iPod;ACPUAOS 0_0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"iPod;\"+\"CPU\"*10000+\"!\"',\n+    '\"iPod;\"+\"CPUOS 1_1\"*10000+\"!\"',\n+    '\"iPod;CPU\"+\"OS 1_1\"*10000+\"!\"',\n+    '\"Version/0.0\"+\"0\"*10000+\"\u25ce\\n\"',\n+    '\"HbbTV/0.0.0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"HbbTV/1.1.1 (\"+\";a;\"*10000+\"!\"',\n+    '\"HbbTV/1.1.1 (\"+\";a;2011\"*10000+\"!\"',\n+    '\"HbbTV/1.1.1 (;a;\"+\"2011\"*10000+\"!\"',\n+    '\"CPU OS 0.0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"ArcGIS.iOS-0.0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"x86_64 1.1.\"+\"0\"*10000+\"!\"',\n+    '\"x86_64 1.1.1\"+\"Chrome\"*10000+\"!\"',\n+    '\" Darwin/91\"+\"0\"*10000+\"!\"',\n+    '\" Darwin/101\"+\"0\"*10000+\"!\"',\n+    '\" Darwin/111\"+\"0\"*10000+\"!\"',\n+    '\" Darwin/121\"+\"0\"*10000+\"!\"',\n+    '\" Darwin/131\"+\"0\"*10000+\"!\"',\n+    '\"iPhone\"+\"Mac OS X\"*10000+\"!\"',\n+    '\"CFNetwork/C Darwin/17.0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"CFNetwork/\"+\" Darwin/17.1\"*10000+\"!\"',\n+    '\"CFNetwork/\"+\" Darwin/16.1\"*10000+\"!\"',\n+    '\"CFNetwork/ Darwin/16.\"+\"0\"*10000+\"!\"',\n+    '\"CFNetwork/8\"+\" Darwin/15.1\"*10000+\"!\"',\n+    '\"CFNetwork/8 Darwin/15.\"+\"0\"*10000+\"!\"',\n+    '\"Linux 0.0\"+\"0\"*10000+\"\u25ce\"',\n+    '\" PTST/0\"+\"0\"*10000+\"\u25ce\\n\"',\n+    '\"Mozilla\"+\"Mobile\"*10000+\"!\"',\n+    '\"; AIRIS \"+\" \"*10000+\"\u25ce\"',\n+    '\";ASUS\"+\"_\"*10000+\"!\"',\n+    '\";Excite \"+\"0\"*10000+\"!\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\"',\n+    '\";\"+\"Coolpad_\"*10000+\"!\"',\n+    '\";TAC-\"+\"0\"*10000+\"!\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\"',\n+    '\"; Fly F30\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; FONE 0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\"',\n+    '\";   Build HuaweiA0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\\n\"',\n+    '\"; Ideos  \"+\" \"*10000+\"\u25ce\"',\n+    '\"; NT-0\"+\"0\"*10000+\"\u25ce\"',\n+    '\";ImPAD\"+\"0\"*10000+\"!\"',\n+    '\"; Intex AQUA  \"+\" \"*10000+\"\u25ce\"',\n+    '\"; IBuddy Connect \"+\" \"*10000+\"\u25ce\"',\n+    '\"; I-Buddy  \"+\" \"*10000+\"\u25ce\"',\n+    '\"; Karbonn \"+\" \"*10000+\"\u25ce\"',\n+    '\"; \"+\" \"*10000+\"\u25ce\\n\"',\n+    '\"; LAVA IRIS \"+\" \"*10000+\"\u25ce\"',\n+    '\"; VS60\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; VS60 \"+\" \"*10000+\"\u25ce\"',\n+    '\"; PhonePad 000\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; SmartPad 000\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; meizu_ \"+\" \"*10000+\"\u25ce\"',\n+    '\"; Cynus F5 \"+\" \"*10000+\"\u25ce\"',\n+    '\"; NXM0\"+\"0\"*10000+\"\u25ce\"',\n+    '\";Nokia\"+\"_\"*10000+\"!\"',\n+    '\";IM-A111\"+\"0\"*10000+\"!\"',\n+    '\";Pantech\"+\"0\"*10000+\"!\"',\n+    '\"; Polaroid MIDC0000\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; POMP  \"+\" \"*10000+\"\u25ce\"',\n+    '\"; SAMSUNG Galaxy Note II \"+\" \"*10000+\"\u25ce\"',\n+    '\"; SAMSUNG-\"+\"0\"*10000+\"!\"',\n+    '\"; SCH-0\"+\"0\"*10000+\"\u25ce\\n\"',\n+    '\"; SC-0\"+\"0\"*10000+\"\u25ce\"',\n+    '\" SCH-0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; Xperia X0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; Sprint  \"+\" \"*10000+\"\u25ce\"',\n+    '\"; TM-MID0\"+\"0\"*10000+\"\u25ce\"',\n+    '\";TM-SM\"+\"0\"*10000+\"!\"',\n+    '\"; Videocon   \"+\" \"*10000+\"\u25ce\"',\n+    '\";XOLO \"+\"tab\"*10000+\"!\"',\n+    '\"; PAD 70\"+\"0\"*10000+\"\u25ce\"',\n+    '\";SmartTab\"+\"0\"*10000+\"!\"',\n+    '\"; v89_\"+\"0\"*10000+\"\u25ce\"',\n+    '\"; e0000a_v0\"+\"0\"*10000+\"\u25ce\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ;  IEMobile/ ; ARM; Touch; HTC_blocked \"+\" \"*10000+\"\u25ce\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"Windows Phone  ; \"+\"IEMobile/\"*10000+\"!\"',\n+    '\"SAMSUNG-\"+\"0\"*10000+\"!\"',\n+    '\"(Mobile; LYF/0/ ;\"+\";\"*10000+\"\u25ce\"',\n+    '\"(Mobile; LYF/A/\"+\";0rv:\"*10000+\"!\"',\n+    '\"(Mobile; LYF/A/1;\"+\"rv:\"*10000+\"!\"',\n+    '\"(Mobile; Nokia_A_\"+\"; rv:\"*10000+\"!\"',\n+    '\"CFNetwork/\"+\" Darwin/1\"*10000+\"!\"',\n+    '\"CFNetwork/ Darwin/1\"+\"(Mac\"*10000+\"!\"',\n+    '\"Android 0.0-update1; AA-A ;  \"+\" \"*10000+\"\u25ce\\n\"',\n+    '\"Android 0.0.0; AA-A- ;  \"+\" \"*10000+\"\u25ce\"',\n+    '\"Android 0.0.0; A- ;  \"+\" \"*10000+\"\u25ce\"',\n+    '\"Android 0.0.0; -AA;  \"+\" \"*10000+\"\u25ce\\n\"',\n+    '\"Android 1; \"+\" Build\"*10000+\"!\"',\n+    '\"Android 1; \"+\" Build\"*10000+\"!\"',\n+    '\"foobar!/!./\"+\"/\"*40000+\"\u25ce\"',\n+    '\"  #- regex: \\'(iPad;(Version/0.0.08\"+\"8\"*40000+\"\u25ce\"',\n+    '\"  #- regex: \\'(iPad;\"*8000',\n+    '\"  #- regex: \\'HbbTV/0.0.0 (; Sony;H;\"+\";\"*40000+\"\u25ce1\\n_\\n\"',\n+    '\"  #- regex: \\'HbbTV/1.1.1 (; Sony;\"*600',\n+    '\"Windows Phone  ; IEMobile/ ; ARM; Touch; HTC_blockedd\"+\"d\"*40000+\"\u25ce1\\n_\\n)\"',\n+    '\"Windows Phone \"*8000',\n+    '\"HTC/HTC \"+\" \"*20000+\"\\n\"',\n+    '\"HTC/HTC \"+\" \"*10000+\"\\n\"',\n+    '\"\"+\"Google\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"MSIE 1.1;\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"[FB\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"[FB\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"[Pinterest/\"*5000+\"@1 _SLQ_2\"',\n+    '\"\"+\"Mobile;\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"FirefoxTablet browser 1.\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Opera TabletVersion/1.\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Opera/9180Version/\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"Chrome/1 MMS/11\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"PLAYSTATION 3\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"AppleWebKit1 NX/1.\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"Windows Phone Edge/1.\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"amarok/\"*10000+\"@1 _SLQ_2\"',\n+    '\"\"+\"iPod1GSA/1.\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"iPod\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"PlayBook\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"Blackberry1Version/\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"AppleWebKit/1+ \"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"HbbTV/1.1.1 (;Samsung;SmartTV0000;\"*2000+\"! _1SLQ_2\"',\n+    '\"\"+\"HbbTV/1.1.1 (;Samsung;SmartTV0000;\"*2000+\"! _1SLQ_2\"',\n+    '\"\"+\"HbbTV/1.1.1 (; Philips;\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"HbbTV/1.1.1 (; Philips;\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"HbbTV/1.1.1 (; Philips;\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Symbian/3\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"Symbian/3\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"BB10;1Version/\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"BlackBerry\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/1810 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/1811 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/2610 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/2810 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/3010 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/3210 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Gecko/3410 Firefox/\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"(Mobile;1Firefox/1.\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"DoCoMo\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"Mozilla\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"SmartWatch(\"*10000+\"@1 _SLQ_2\"',\n+    '\"\"+\"Android Application  - Sony 1 \"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android Application  - HTC HTC 1 \"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android Application  - - 1 \"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android 3\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";Vega\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";ALLVIEWSpeed\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";ARCHOSGAMEPAD\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";BlackBird I8\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";BlackBird \"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";CatNova\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";P-1\"*1000+\"@1 _SLQ_2\"',\n+    '\"\"+\";Explay_\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";IQ\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";Pixel\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";GSmart \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";imx51_\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";Haier \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"Build/HCL ME Tablet \"*3000+\"@1 _SLQ_2\"',\n+    '\"\"+\";HP \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"HTC Streaming Player \"*3000+\"@1 _SLQ_2\"',\n+    '\"\"+\";HYUNDAI T1\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";imobile \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";i-style\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";iOCEAN \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";NEC-\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";Pantech \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android 4.\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";PLT0000\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";SAMSUNG \"*10000+\"@1 _SLQ_2\"',\n+    '\"\"+\";GT-B1111\"*10000+\"@1 _SLQ_2\"',\n+    '\"\"+\"; SAMSUNG-\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\";SK-\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";ST1111\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";ST1111\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";Build/\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"TOOKY \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"TOUCHTAB\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"VERTU \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\";GTablet\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"Vodafone \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"sprd-\"*10000+\"@1 _SLQ_2\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"Windows Phone \"*5000+\"@1 _SLQ_2)\"',\n+    '\"\"+\"(Mobile; ALCATELOneTouch ; rv:\"*3000+\"@1 _SLQ_2\"',\n+    '\"\"+\"(Mobile; ZTE ; rv:\"*5000+\"@1 _SLQ_2\"',\n+    '\"\"+\"(Mobile; ALCATELA; rv:\"*3000+\"@1 _SLQ_2\"',\n+    '\"\"+\"PlayBook\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"webOS\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"HPiPAQ\"*10000+\"!1 _SLQ_2\"',\n+    '\"\"+\"HbbTV;CE-HTML;\"*5000+\"@1 _SLQ_2\"',\n+    '\"\"+\"InettvBrowser/0.0 (;Sony\"*3000+\"@1 _SLQ_2\"',\n+    '\"\"+\"InettvBrowser/0.0 (\"*5000+\"@1 _SLQ_2\"',\n+    '\"\"+\"MSIE\"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"SMART-TV; \"*10000+\"! _1SLQ_2\"',\n+    '\"\"+\"SymbianOS/9.1\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android \"*10000+\"@1 _SLQ_2\"',\n+    '\"\"+\"Android-1.1; AA-; WOWMobile \"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android-1.1-update1; AA-;\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android-1.1;AA_;\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android-1.1;-;\"*5000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android 1;   Build\"*3000+\"! _1SLQ_2\"',\n+    '\"\"+\"Android 1;   Build\"*3000+\"! _1SLQ_2\"'\n+  ]\n \n-  function testRedos (ua) {\n-    var time = timer()\n-    parse(ua)\n-    var diff = time()\n-    assert.ok(diff < 300, diff)\n+  function buildAttackString (attackString) {\n+    const uas = attackString\n+      .replace(/^\"|\"$/g, '')\n+      .replace(/\"?\\+\"([^\"]+)\"\\*(\\d+)/, (m, str, i) => {\n+        // console.error({m, str, i})\n+        const size = parseInt(i, 10)\n+        if (!isNaN(size)) {\n+          return (new Array(size).fill(str).join(''))\n+        } else {\n+          return m\n+        }\n+      })\n+      .replace(/\\+\"/, '')\n+    return uas\n   }\n \n-  test('should not backtrack aaaa..', function () {\n-    testRedos(Array(3200).fill('a').join(''))\n-  })\n-\n-  test('should not backtrack Smartwatch', function () {\n-    testRedos('SmartWatch(' + Array(3500).fill(' ').join('') + 'z')\n-  })\n-\n-  test('should not backtrack HuaweiA', function () {\n-    testRedos(';A Build HuaweiA' + Array(3500).fill('4').join('') + 'z')\n-  })\n-\n-  test('should not backtrack HbbTV LGE', function () {\n-    testRedos('HbbTV/0.0.0 (;LGE;' + Array(3500).fill(' ').join('') + 'z')\n-  })\n-\n-  test('should not backtrack HbbTV CUS', function () {\n-    testRedos('HbbTV/0.0.0 (;CUS:;' + Array(3500).fill(' ').join('') + 'z')\n-  })\n-\n-  test('should not backtrack HbbTV', function () {\n-    testRedos('HbbTV/0.0.0 (;' + Array(3500).fill(' ').join('') + 'z')\n-  })\n-\n-  test('should not backtrack HbbTV z', function () {\n-    testRedos('HbbTV/0.0.0 (;z;' + Array(3500).fill(' ').join('') + 'z')\n+  tests.forEach(attackString => {\n+    test(attackString, function() {\n+      const ua = buildAttackString(attackString)\n+      const start = Date.now()\n+      const parsed = parse(ua)\n+      // console.log(parsed)\n+      const diff = Date.now() - start\n+      assert.ok(diff < 500)\n+    })\n   })\n })"
        },
        {
          "filename": "tests/test_ua.yaml",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -7645,9 +7645,9 @@ test_cases:\n \n   - user_agent_string: 'Mozilla/5.0 (iPhone; CPU iPhone OS 10_0_2 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) AppleNews/608.0.1 Version/2.0.1'\n     family: 'Mobile Safari UI/WKWebView'\n-    major: '10'\n+    major: '2'\n     minor: '0'\n-    patch: '2'\n+    patch: '1'\n \n   - user_agent_string: 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.3; WOW64; Trident/7.0; .NET4.0E; .NET4.0C; InfoPath.3)'\n     family: 'IE'\n@@ -8148,7 +8148,7 @@ test_cases:\n     major:\n     minor:\n     patch:\n-  \n+\n   - user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0;) AppleWebKit/537.36 (KHTML, like Gecko) Mobile Safari/537.36 (compatible; AspiegelBot)'\n     family: 'AspiegelBot'\n     major:\n@@ -8184,13 +8184,13 @@ test_cases:\n     major: '10'\n     minor: '5'\n     patch: '1'\n-    \n+\n   - user_agent_string: 'ArcGIS Pro 2.4.2 (000000000) - ArcGIS Pro'\n     family: 'ArcGIS Pro'\n     major: '2'\n     minor: '4'\n     patch: '2'\n-  \n+\n   - user_agent_string: 'ArcGIS Client Using WinInet'\n     family: 'ArcMap'\n     major:\n@@ -8256,7 +8256,7 @@ test_cases:\n     major: '1544'\n     minor:\n     patch:\n-    \n+\n   - user_agent_string: 'Explorer-Android-10.2.10/ArcGIS.Android-10.2.8/5.1.1/SAMSUNG-SM-G361F'\n     family: 'Explorer for ArcGIS'\n     major: '10'\n@@ -8280,7 +8280,7 @@ test_cases:\n     major: '17'\n     minor: '0'\n     patch: '1'\n-    \n+\n   - user_agent_string: 'AR/10.2.6.1704 .Net/Desktop (Win32NT/6.1.7601.65536; Win64) arcgisearth/1.5'\n     family: 'ArcGIS Earth'\n     major: '1'\n@@ -8304,7 +8304,7 @@ test_cases:\n     major: '100'\n     minor: '1'\n     patch: '1'\n-  \n+\n   - user_agent_string: 'ArcGIS.Android-10.2.4/8.0.0/SAMSUNG-SM-A530F'\n     family: 'ArcGIS Runtime SDK for Android'\n     major: '10'\n@@ -8315,7 +8315,7 @@ test_cases:\n     family: 'ArcGIS Runtime SDK for Android'\n     major: '10'\n     minor: '2'\n-    patch: \n+    patch:\n \n   - user_agent_string: 'ArcGISRuntime-Android/100.4 (Android 10.0; arm64-v8a; ONEPLUS-HD1903)'\n     family: 'ArcGIS Runtime SDK for Android'\n@@ -8328,7 +8328,7 @@ test_cases:\n     major: '100'\n     minor: '3'\n     patch:\n-  \n+\n   - user_agent_string: 'ArcGISRuntime-NET/100.7 (Windows 10.0.18362; Win64; WOW64; UAP; Windows.Desktop)'\n     family: 'ArcGIS Runtime SDK for NET'\n     major: '100'"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bc4676f90e9ca81be6583b0ea0afbe65f8a97812",
            "date": "2025-01-22T14:02:15Z",
            "author_login": "lbarthon"
          },
          {
            "sha": "d8a6f55f69104671b3301ac8181b7bace9ab8025",
            "date": "2025-01-22T14:11:54Z",
            "author_login": "lbarthon"
          },
          {
            "sha": "ac59be513e3e87120b4a35088bdbe7213bee78cb",
            "date": "2024-12-06T08:39:13Z",
            "author_login": "KyoUK4n"
          },
          {
            "sha": "2fff8a5bd585e8a39adf10799c2d9ed710d8ff4f",
            "date": "2024-12-06T08:25:52Z",
            "author_login": "KyoUK4n"
          },
          {
            "sha": "d3b3a7894a0fc06eb99554571da4445161325dfc",
            "date": "2024-12-05T04:01:32Z",
            "author_login": "KyoUK4n"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-400",
    "description": "uap-core in an open-source npm package which contains the core of BrowserScope's original user agent string parser. In uap-core before version 0.11.0, some regexes are vulnerable to regular expression denial of service (REDoS) due to overlapping capture groups. This allows remote attackers to overload a server by setting the User-Agent header in an HTTP(S) request to maliciously crafted long strings. This is fixed in version 0.11.0. Downstream packages such as uap-python, uap-ruby etc which depend upon uap-core follow different version schemes.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-16T18:15:12.583",
    "last_modified": "2024-11-21T05:48:00.547",
    "fix_date": "2021-01-30T08:40:13Z"
  },
  "references": [
    {
      "url": "https://github.com/ua-parser/uap-core/commit/dc9925d458214cfe87b93e35346980612f6ae96c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ua-parser/uap-core/security/advisories/GHSA-p4pj-mg4r-x6v4",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/uap-core",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ua-parser/uap-core/commit/dc9925d458214cfe87b93e35346980612f6ae96c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ua-parser/uap-core/security/advisories/GHSA-p4pj-mg4r-x6v4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/uap-core",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.790726",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "uap-core",
    "owner": "ua-parser",
    "created_at": "2014-02-17T14:57:50Z",
    "updated_at": "2025-01-25T05:44:18Z",
    "pushed_at": "2025-01-22T14:19:48Z",
    "size": 7639,
    "stars": 764,
    "forks": 452,
    "open_issues": 124,
    "watchers": 764,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 15721,
      "Perl": 1372
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:24:45.552084"
  }
}