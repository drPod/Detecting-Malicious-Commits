{
  "cve_id": "CVE-2021-21352",
  "github_data": {
    "repository": "anuko/timetracker",
    "fix_commit": "40f3d9345adc20e6f28eb9f59e2489aff87fecf5",
    "related_commits": [
      "40f3d9345adc20e6f28eb9f59e2489aff87fecf5",
      "40f3d9345adc20e6f28eb9f59e2489aff87fecf5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "40f3d9345adc20e6f28eb9f59e2489aff87fecf5",
      "commit_date": "2021-02-27T16:00:53Z",
      "author": {
        "login": "anuko",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed a critical security vulnerability with password resets.",
        "length": 61,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "WEB-INF/templates/report.tpl",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -117,6 +117,7 @@\n         {if $bean->getAttribute('chtimesheet')}<td></td>{/if}\n         {if $bean->getAttribute('chfiles')}<td></td>{/if}\n         {if $use_checkboxes}<td></td>{/if}\n+        {* <td></td>{* column for edit icons *}\n       </tr>\n       <tr><td>&nbsp;</td></tr>\n       {/if}\n@@ -171,6 +172,7 @@\n       {if 1 == $item.type}<td bgcolor=\"white\"><input type=\"checkbox\" name=\"log_id_{$item.id}\"></td>{/if}\n       {if 2 == $item.type}<td bgcolor=\"white\"><input type=\"checkbox\" name=\"item_id_{$item.id}\"></td>{/if}\n     {/if}\n+     {* <td><a href=\"time_edit.php?id={$item.id}\"><img class=\"table_icon\" alt=\"{$i18n.label.edit}\" src=\"img/icon-edit.png\"></a></td>{* column for edit icons *}\n       </tr>\n     {if $note_on_separate_row && $bean->getAttribute('chnote') && $item.note}\n       <tr>\n@@ -220,6 +222,7 @@\n     {if $bean->getAttribute('chtimesheet')}<td></td>{/if}\n     {if $bean->getAttribute('chfiles')}<td></td>{/if}\n     {if $use_checkboxes}<td></td>{/if}\n+    {* <td></td>{* column for edit icons *}\n       </tr>\n   {/if}\n   <!-- print totals -->\n@@ -261,6 +264,7 @@\n     {if $bean->getAttribute('chtimesheet')}<td></td>{/if}\n     {if $bean->getAttribute('chfiles')}<td></td>{/if}\n     {if $use_checkboxes}<td></td>{/if}\n+    {* <td></td>{* column for edit icons *}\n       </tr>\n {/if}\n     </table>"
        },
        {
          "filename": "initialize.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -13,7 +13,7 @@\n ini_set('display_errors', 'Off');\n \n // require_once('init_auth.php');\n-define(\"APP_VERSION\", \"1.19.23.5414\");\n+define(\"APP_VERSION\", \"1.19.24.5415\");\n define(\"APP_DIR\", dirname(__FILE__));\n define(\"LIBRARY_DIR\", APP_DIR.\"/WEB-INF/lib\");\n define(\"TEMPLATE_DIR\", APP_DIR.\"/WEB-INF/templates\");"
        },
        {
          "filename": "password_reset.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -46,7 +46,10 @@\n \n   if ($err->no()) {\n     // Prepare and save a temporary reference for user.\n-    $temp_ref = md5(uniqid());\n+    $cryptographically_strong = true;\n+    $random_bytes = openssl_random_pseudo_bytes(16, $cryptographically_strong);\n+    if ($random_bytes === false) die (\"openssl_random_pseudo_bytes function call failed...\");\n+    $temp_ref = bin2hex($random_bytes);\n     ttUserHelper::saveTmpRef($temp_ref, $user->id);\n \n     $user_i18n = null;"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6711df7ae7c0c0034d6673365d26a0933faac5c",
            "date": "2023-12-28T18:07:21Z",
            "author_login": "anuko"
          },
          {
            "sha": "f92e6ce6d58669ea735767b55e18bcaa7a7935b8",
            "date": "2023-12-27T23:41:06Z",
            "author_login": "ram-fabian-heinrich"
          },
          {
            "sha": "2deafba72d62471a2b1e29f2d625a3dbb4702200",
            "date": "2023-11-11T16:42:19Z",
            "author_login": "anuko"
          },
          {
            "sha": "d123e4534038691c66c342008d464efbe8824a5d",
            "date": "2023-07-08T16:48:07Z",
            "author_login": "anuko"
          },
          {
            "sha": "3c21de2155eec74d2a16c4ccae867df6963388fc",
            "date": "2023-07-06T18:46:39Z",
            "author_login": "anuko"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-330",
    "description": "Anuko Time Tracker is an open source, web-based time tracking application written in PHP. In TimeTracker before version 1.19.24.5415 tokens used in password reset feature in Time Tracker are based on system time and, therefore, are predictable. This opens a window for brute force attacks to guess user tokens and, once successful, change user passwords, including that of a system administrator. This vulnerability is pathced in version 1.19.24.5415 (started to use more secure tokens) with an additional improvement in 1.19.24.5416 (limited an available window for brute force token guessing).",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-03-03T01:15:13.427",
    "last_modified": "2024-11-21T05:48:05.900",
    "fix_date": "2021-02-27T16:00:53Z"
  },
  "references": [
    {
      "url": "https://github.com/anuko/timetracker/commit/40f3d9345adc20e6f28eb9f59e2489aff87fecf5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-43c9-rx4h-4gqq",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.anuko.com/time-tracker/index.htm",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/40f3d9345adc20e6f28eb9f59e2489aff87fecf5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-43c9-rx4h-4gqq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.anuko.com/time-tracker/index.htm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.816811",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "timetracker",
    "owner": "anuko",
    "created_at": "2016-02-28T19:01:14Z",
    "updated_at": "2024-12-10T00:27:13Z",
    "pushed_at": "2023-12-28T18:07:38Z",
    "size": 11493,
    "stars": 191,
    "forks": 124,
    "open_issues": 27,
    "watchers": 191,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 5951736,
      "Smarty": 314330,
      "JavaScript": 30090,
      "CSS": 16132,
      "Batchfile": 13672,
      "Shell": 2274
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:57:26.195471"
  }
}