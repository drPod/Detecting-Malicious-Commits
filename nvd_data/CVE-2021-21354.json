{
  "cve_id": "CVE-2021-21354",
  "github_data": {
    "repository": "mozilla/PollBot",
    "fix_commit": "6db74a4fcbff258c7cdf51a6ff0724fc10c485e5",
    "related_commits": [
      "6db74a4fcbff258c7cdf51a6ff0724fc10c485e5",
      "6db74a4fcbff258c7cdf51a6ff0724fc10c485e5"
    ],
    "patch_url": "https://github.com/mozilla/PollBot/commit/6db74a4fcbff258c7cdf51a6ff0724fc10c485e5.patch",
    "fix_commit_details": {
      "sha": "6db74a4fcbff258c7cdf51a6ff0724fc10c485e5",
      "commit_date": "2021-02-26T10:26:06Z",
      "author": {
        "login": "leplatrem",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Remove leading slashes in 404 redirections",
        "length": 145,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "pollbot/middlewares.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -61,7 +61,7 @@ async def handle_any(request, response):\n async def handle_404(request, response):\n     if 'json' not in response.headers['Content-Type']:\n         if request.path.endswith('/'):\n-            return web.HTTPFound(request.path.rstrip('/'))\n+            return web.HTTPFound('/' + request.path.strip('/'))\n         return web.json_response({\n             \"status\": 404,\n             \"message\": \"Page '{}' not found\".format(request.path)"
        },
        {
          "filename": "tests/test_views.py",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -61,6 +61,11 @@ async def test_redirects_trailing_slashes(cli):\n     assert resp.headers['Location'] == \"/v1/firefox/54.0\"\n \n \n+async def test_redirects_strip_leading_slashes(cli):\n+    resp = await check_response(cli, \"//page/\", status=302, allow_redirects=False)\n+    assert resp.headers['Location'] == \"/page\"\n+\n+\n async def check_yaml_resource(cli, url, filename, **kwargs):\n     with open(os.path.join(HERE, \"..\", \"pollbot\", filename)) as stream:\n         content = yaml.safe_load(stream)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "651305c8b66f605ca1e439a32df6c74a1382b30d",
            "date": "2024-09-23T12:55:32Z",
            "author_login": "JohanLorenzo"
          },
          {
            "sha": "c0a7f607dec1be052b517644126a9f00aaad717f",
            "date": "2024-09-23T08:44:47Z",
            "author_login": "pascalchevrel"
          },
          {
            "sha": "006e1b002efa1445f64c36d447948b44e09e9a20",
            "date": "2024-08-19T19:12:53Z",
            "author_login": "gbrownmozilla"
          },
          {
            "sha": "5ffbc20008421e164eac2c68e80ea8ec365245cb",
            "date": "2024-08-19T19:09:30Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "29858b9e5eba79e5c856641629af4aa8cd18d42d",
            "date": "2024-08-12T22:42:23Z",
            "author_login": "gbrownmozilla"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N",
    "cwe_id": "CWE-601",
    "description": "Pollbot is open source software which \"frees its human masters from the toilsome task of polling for the state of things during the Firefox release process.\" In Pollbot before version 1.4.4 there is an open redirection vulnerability in the path of \"https://pollbot.services.mozilla.com/\". An attacker can redirect anyone to malicious sites. To Reproduce type in this URL: \"https://pollbot.services.mozilla.com//evil.com/\". Affected versions will redirect to that website when you inject a payload like \"//evil.com/\". This is fixed in version 1.4.4.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-03-08T19:15:13.333",
    "last_modified": "2024-11-21T05:48:11.173",
    "fix_date": "2021-02-26T10:26:06Z"
  },
  "references": [
    {
      "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1694684",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/commit/6db74a4fcbff258c7cdf51a6ff0724fc10c485e5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/pull/333",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/releases/tag/v1.4.4",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/security/advisories/GHSA-jhgx-wmq8-jc24",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1694684",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/commit/6db74a4fcbff258c7cdf51a6ff0724fc10c485e5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/pull/333",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/releases/tag/v1.4.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mozilla/PollBot/security/advisories/GHSA-jhgx-wmq8-jc24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.825345",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PollBot",
    "owner": "mozilla",
    "created_at": "2017-08-01T17:39:56Z",
    "updated_at": "2024-10-11T11:20:11Z",
    "pushed_at": "2024-11-18T21:35:31Z",
    "size": 1489,
    "stars": 10,
    "forks": 15,
    "open_issues": 24,
    "watchers": 10,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 165406,
      "Makefile": 1740,
      "Dockerfile": 794,
      "Shell": 305
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mpl-2.0"
    },
    "collected_at": "2025-01-14T21:01:45.565781"
  }
}