{
  "cve_id": "CVE-2021-21383",
  "github_data": {
    "repository": "Requarks/wiki",
    "fix_commit": "5ffa189383dd716f12b56b8cae2ba0d075996cf1",
    "related_commits": [
      "5ffa189383dd716f12b56b8cae2ba0d075996cf1",
      "5ffa189383dd716f12b56b8cae2ba0d075996cf1"
    ],
    "patch_url": "https://github.com/Requarks/wiki/commit/5ffa189383dd716f12b56b8cae2ba0d075996cf1.patch",
    "fix_commit_details": {
      "sha": "5ffa189383dd716f12b56b8cae2ba0d075996cf1",
      "commit_date": "2021-03-12T00:23:24Z",
      "author": {
        "login": "NGPixel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: add v-pre to pre tags at render time",
        "length": 41,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
      },
      "files": [
        {
          "filename": "server/modules/rendering/html-core/renderer.js",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -261,6 +261,10 @@ module.exports = {\n     }\n     iterateMustacheNode($.root())\n \n+    $('pre').each((idx, elm) => {\n+      $(elm).attr('v-pre', true)\n+    })\n+\n     // --------------------------------\n     // STEP: POST\n     // --------------------------------"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "abc8dce9ccb9b9f90e5681e01abce3929183f6a4",
            "date": "2025-01-01T05:18:42Z",
            "author_login": "Vasfed"
          },
          {
            "sha": "94d253bf596a976a85034a1317b896af5b720b6b",
            "date": "2024-11-22T19:31:07Z",
            "author_login": "maarous"
          },
          {
            "sha": "c7c20579fd893387236d11688660a4d20cee8f1d",
            "date": "2024-11-18T22:18:28Z",
            "author_login": "NGPixel"
          },
          {
            "sha": "583ea44a72aecb94c93721880cdd6c2bb6491cf1",
            "date": "2024-11-18T22:13:52Z",
            "author_login": "NGPixel"
          },
          {
            "sha": "ab5c620d5046cfa4713fca9a44a78477baac4b40",
            "date": "2024-10-12T08:51:48Z",
            "author_login": "NGPixel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Wiki.js an open-source wiki app built on Node.js. Wiki.js before version 2.5.191 is vulnerable to stored cross-site scripting through mustache expressions in code blocks. This vulnerability exists due to mustache expressions being parsed by Vue during content injection even though it is contained within a `<pre>` element. By creating a crafted wiki page, a malicious Wiki.js user may stage a stored cross-site scripting attack. This allows the attacker to execute malicious JavaScript when the page is viewed by other users. For an example see referenced GitHub Security Advisory. Commit 5ffa189383dd716f12b56b8cae2ba0d075996cf1 fixes this vulnerability by adding the v-pre directive to all `<pre>` tags during the render.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-03-18T17:15:13.947",
    "last_modified": "2024-11-21T05:48:14.717",
    "fix_date": "2021-03-12T00:23:24Z"
  },
  "references": [
    {
      "url": "https://github.com/Requarks/wiki/commit/5ffa189383dd716f12b56b8cae2ba0d075996cf1",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/releases/tag/2.5.191",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-6xx4-m8gx-826r",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/commit/5ffa189383dd716f12b56b8cae2ba0d075996cf1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/releases/tag/2.5.191",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-6xx4-m8gx-826r",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.845956",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wiki",
    "owner": "Requarks",
    "created_at": "2016-08-16T19:35:26Z",
    "updated_at": "2025-01-14T13:04:23Z",
    "pushed_at": "2025-01-01T05:18:42Z",
    "size": 40284,
    "stars": 25375,
    "forks": 2812,
    "open_issues": 162,
    "watchers": 25375,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Vue": 885886,
      "JavaScript": 785105,
      "SCSS": 93552,
      "HTML": 37190,
      "Shell": 31046,
      "Pug": 14489,
      "Go": 3549,
      "CSS": 3199,
      "Dockerfile": 3028,
      "Mustache": 2944
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:20:59.329863"
  }
}