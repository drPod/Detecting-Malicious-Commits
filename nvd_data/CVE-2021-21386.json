{
  "cve_id": "CVE-2021-21386",
  "github_data": {
    "repository": "dwisiswant0/apkleaks",
    "fix_commit": "a966e781499ff6fd4eea66876d7532301b13a382",
    "related_commits": [
      "a966e781499ff6fd4eea66876d7532301b13a382",
      "a966e781499ff6fd4eea66876d7532301b13a382"
    ],
    "patch_url": "https://github.com/dwisiswant0/apkleaks/commit/a966e781499ff6fd4eea66876d7532301b13a382.patch",
    "fix_commit_details": {
      "sha": "a966e781499ff6fd4eea66876d7532301b13a382",
      "commit_date": "2021-03-14T15:25:42Z",
      "author": {
        "login": "dwisiswant0",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Escapes decompiling arguments",
        "length": 29,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "apkleaks/apkleaks.py",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -2,6 +2,7 @@\n from apkleaks.colors import clr\n from contextlib import closing\n from distutils.spawn import find_executable\n+from pipes import quote\n from pyaxmlparser import APK\n from urllib.request import urlopen\n from zipfile import ZipFile\n@@ -84,8 +85,9 @@ def decompile(self):\n \t\t\t\t\tclasses.write(zipped.read(\"classes.dex\"))\n \t\t\texcept Exception as e:\n \t\t\t\tsys.exit(self.writeln(str(e), clr.WARNING))\n-\t\tdec = \"%s %s -d %s --deobf\" % (self.jadx, dex, self.tempdir)\n-\t\tos.system(dec)\n+\t\targs = [self.jadx, dex, \"-d\", self.tempdir, \"--deobf\"]\n+\t\tcomm = \"%s\" % (\" \".join(quote(arg) for arg in args))\n+\t\tos.system(comm)\n \t\treturn self.tempdir\n \n \tdef unique(self, list): "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "05a83a1cb3f24ce8dca41570c79a2bed9cffa2ba",
            "date": "2024-10-21T01:45:30Z",
            "author_login": "dwisiswant0"
          },
          {
            "sha": "1abc5d6c3452bbd37d3dcd11a5dd566b9d65f2f9",
            "date": "2024-10-21T01:37:51Z",
            "author_login": "branchvincent"
          },
          {
            "sha": "3202df9b9fd99645142b62810184f708fe2b6153",
            "date": "2024-05-17T16:30:38Z",
            "author_login": "dwisiswant0"
          },
          {
            "sha": "e0b2eeaaaf470f99266c81a64c4821ca19e3839c",
            "date": "2024-05-17T16:29:59Z",
            "author_login": "dwisiswant0"
          },
          {
            "sha": "77d32f8f8990306d8b8bc45caa3fbedeba2a3ff0",
            "date": "2024-05-17T16:25:20Z",
            "author_login": "dwisiswant0"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-78",
    "description": "APKLeaks is an open-source project for scanning APK file for URIs, endpoints & secrets. APKLeaks prior to v2.0.3 allows remote attackers to execute arbitrary OS commands via package name inside application manifest. An attacker could include arguments that allow unintended commands or code to be executed, allow sensitive data to be read or modified or could cause other unintended behavior through malicious package name. The problem is fixed in version v2.0.6-dev and above.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-03-24T21:15:15.177",
    "last_modified": "2024-11-21T05:48:15.110",
    "fix_date": "2021-03-14T15:25:42Z"
  },
  "references": [
    {
      "url": "https://github.com/dwisiswant0/apkleaks/commit/a966e781499ff6fd4eea66876d7532301b13a382",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dwisiswant0/apkleaks/security/advisories/GHSA-8434-v7xw-8m9x",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dwisiswant0/apkleaks/commit/a966e781499ff6fd4eea66876d7532301b13a382",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dwisiswant0/apkleaks/security/advisories/GHSA-8434-v7xw-8m9x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.861374",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "apkleaks",
    "owner": "dwisiswant0",
    "created_at": "2020-05-29T21:26:13Z",
    "updated_at": "2025-01-14T18:57:07Z",
    "pushed_at": "2024-10-21T01:50:46Z",
    "size": 116,
    "stars": 5049,
    "forks": 498,
    "open_issues": 26,
    "watchers": 5049,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 7977,
      "Makefile": 1058,
      "Dockerfile": 330
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T20:51:21.728994"
  }
}