{
  "cve_id": "CVE-2021-21431",
  "github_data": {
    "repository": "MirahezeBots/sopel-channelmgnt",
    "fix_commit": "7c96d400358221e59135f0a0be0744f3fad73856",
    "related_commits": [
      "7c96d400358221e59135f0a0be0744f3fad73856",
      "7c96d400358221e59135f0a0be0744f3fad73856"
    ],
    "patch_url": "https://github.com/MirahezeBots/sopel-channelmgnt/commit/7c96d400358221e59135f0a0be0744f3fad73856.patch",
    "fix_commit_details": {
      "sha": "7c96d400358221e59135f0a0be0744f3fad73856",
      "commit_date": "2021-04-08T17:21:42Z",
      "author": {
        "login": "RhinosF1",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[SECURITY] Release 2.0.1 (#65)",
        "length": 52,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 19,
        "deletions": 3
      },
      "files": [
        {
          "filename": "dev-requirements.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -15,7 +15,7 @@ flake8-fixme==1.1.1\n flake8-multiline-containers==0.0.17\n flake8-print==4.0.0\n flake8-pytest-style==1.3.0\n-flake8-return==1.1.2\n+#flake8-return==1.1.2\n flake8-quotes==3.2.0\n flake8-simplify==0.13.0\n flake8-pytest==1.3"
        },
        {
          "filename": "setup.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,12 +10,12 @@\n \n setup(\n     name='sopel_plugins.channelmgnt',\n-    version='2.0',\n+    version='2.0.1',\n     description='Channelmgnt plugin for Sopel',\n     long_description=readme,\n     long_description_content_type='text/markdown',  # This is important!\n     author='MirahezeBot Contributors',\n-    author_email='bots@miraheze.org',\n+    author_email='staff@mirahezebots.org',\n     url='https://github.com/MirahezeBots/sopel-channelmgnt',\n     packages=find_packages('.'),\n     include_package_data=True,"
        },
        {
          "filename": "sopel_channelmgnt/channelmgnt/__init__.py",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -216,6 +216,10 @@ def kick(bot, trigger):\n             return\n         nick = Identifier(text[1])\n         reason = ' '.join(text[2:])\n+        if ',' in str(nick):\n+            return bot.reply('Unable to kick. Kicking multiple users is not allowed.')\n+        if '#' in str(nick):\n+            return bot.reply('Unable to kick. Use of # when kicking is not expected.')\n         if nick != bot.config.core.nick and trigger.account in chanops:\n             bot.write(['KICK', trigger.sender, nick, ':' + reason])\n             if dodeop:\n@@ -263,6 +267,10 @@ def parse_host_mask(text):\n @example('.ban Zppix')\n def ban(bot, trigger):\n     \"\"\"Ban a user from the channel. The bot must be a channel operator for this command to work.\"\"\"\n+    if ',' in str(parse_host_mask(trigger.group().split())):\n+        return bot.reply('Unable to ban. Banning multiple users is not allowed.')\n+    if '#' in str(parse_host_mask(trigger.group().split())):\n+        return bot.reply('Unable to ban. Use of # when banning is not expected.')\n     makemodechange(bot, trigger, '+b', isbqmode=True)\n \n \n@@ -271,6 +279,10 @@ def ban(bot, trigger):\n @example('.unban Zppix')\n def unban(bot, trigger):\n     \"\"\"Unban a user from the channel. The bot must be a channel operator for this command to work.\"\"\"\n+    if ',' in str(parse_host_mask(trigger.group().split())):\n+        return bot.reply('Unable to ban. Banning multiple users is not allowed.')\n+    if '#' in str(parse_host_mask(trigger.group().split())):\n+        return bot.reply('Unable to ban. Use of # when banning is not expected.')\n     makemodechange(bot, trigger, '-b', isbqmode=True)\n \n \n@@ -312,6 +324,10 @@ def kickban(bot, trigger):\n                 deopbot(trigger.sender, bot)\n             return\n         nick = Identifier(text[1])\n+        if ',' in str(nick):\n+            return bot.reply('Unable to kickban. Kickbanning multiple users is not allowed.')\n+        if '#' in str(nick):\n+            return bot.reply('Unable to kickban. Use of # when kickbanning is not expected.')\n         mask = text[2] if any(s in text[2] for s in '!@*') else ''\n         reasonidx = 3 if mask != '' else 2\n         reason = ' '.join(text[reasonidx:])"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2067af0c396fe4e66b57d0a588b364bfdbc52923",
            "date": "2022-08-18T21:23:09Z",
            "author_login": "sario528"
          },
          {
            "sha": "6e9b1433e792282cbc9cc2bd78aaeca0b7aa011b",
            "date": "2022-08-18T21:11:25Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "d2e37518b0785fb573ba9eaf3f6b3e11d340fd34",
            "date": "2022-08-18T21:10:37Z",
            "author_login": "sario528"
          },
          {
            "sha": "88b43822c51ac31705b1a401de6cdfbfc07ed080",
            "date": "2022-08-18T21:05:43Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e58e8ca1f976a6869f3f220e9a7da782c455b403",
            "date": "2022-07-11T08:11:08Z",
            "author_login": "RhinosF1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.6,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:H/UI:R/S:C/C:N/I:H/A:H",
    "cwe_id": "CWE-20",
    "description": "sopel-channelmgnt is a channelmgnt plugin for sopel. In versions prior to 2.0.1, on some IRC servers, restrictions around the removal of the bot using the kick/kickban command could be bypassed when kicking multiple users at once. We also believe it may have been possible to remove users from other channels but due to the wonder that is IRC and following RfCs, We have no POC for that. Freenode is not affected. This is fixed in version 2.0.1. As a workaround, do not use this plugin on networks where TARGMAX > 1.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-04-09T16:15:11.837",
    "last_modified": "2024-11-21T05:48:20.867",
    "fix_date": "2021-04-08T17:21:42Z"
  },
  "references": [
    {
      "url": "https://github.com/MirahezeBots/sopel-channelmgnt/commit/7c96d400358221e59135f0a0be0744f3fad73856",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MirahezeBots/sopel-channelmgnt/security/advisories/GHSA-23c7-6444-399m",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pypi.org/project/sopel-plugins.channelmgnt/",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MirahezeBots/sopel-channelmgnt/commit/7c96d400358221e59135f0a0be0744f3fad73856",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MirahezeBots/sopel-channelmgnt/security/advisories/GHSA-23c7-6444-399m",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pypi.org/project/sopel-plugins.channelmgnt/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:33.522697",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sopel-channelmgnt",
    "owner": "MirahezeBots",
    "created_at": "2020-10-04T21:57:13Z",
    "updated_at": "2023-03-14T17:23:07Z",
    "pushed_at": "2023-03-14T17:23:00Z",
    "size": 301,
    "stars": 0,
    "forks": 3,
    "open_issues": 0,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev",
      "release"
    ],
    "languages": {
      "Python": 19503
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:07:37.810032"
  }
}