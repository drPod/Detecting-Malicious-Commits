{
  "cve_id": "CVE-2021-22548",
  "github_data": {
    "repository": "google/asylo",
    "fix_commit": "53ed5d8fd8118ced1466e509606dd2f473707a5c",
    "related_commits": [
      "53ed5d8fd8118ced1466e509606dd2f473707a5c",
      "53ed5d8fd8118ced1466e509606dd2f473707a5c"
    ],
    "patch_url": "https://github.com/google/asylo/commit/53ed5d8fd8118ced1466e509606dd2f473707a5c.patch",
    "fix_commit_details": {
      "sha": "53ed5d8fd8118ced1466e509606dd2f473707a5c",
      "commit_date": "2021-03-29T20:17:26Z",
      "author": {
        "login": "kongoshuu",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Store untrusted output pointer in enclave",
        "length": 231,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "asylo/platform/primitives/sgx/trusted_sgx.cc",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -306,15 +306,16 @@ PrimitiveStatus TrustedPrimitives::UntrustedCall(uint64_t untrusted_selector,\n   if (sgx_params->input) {\n     untrusted_cache->Free(const_cast<void *>(sgx_params->input));\n   }\n-  if (!TrustedPrimitives::IsOutsideEnclave(sgx_params->output,\n-                                           sgx_params->output_size)) {\n+  const void *output_pointer = sgx_params->output;\n+  uint64_t output_size = sgx_params->output_size;\n+  if (!TrustedPrimitives::IsOutsideEnclave(output_pointer, output_size)) {\n     TrustedPrimitives::BestEffortAbort(\n         \"UntrustedCall: sgx_param output should be in untrusted memory\");\n   }\n   if (sgx_params->output) {\n     // For the results obtained in |output_buffer|, copy them to |output|\n     // before freeing the buffer.\n-    output->Deserialize(sgx_params->output, sgx_params->output_size);\n+    output->Deserialize(output_pointer, output_size);\n     TrustedPrimitives::UntrustedLocalFree(sgx_params->output);\n   }\n   return PrimitiveStatus::OkStatus();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e73365548454950929d339d37d810a789e5c383b",
            "date": "2022-04-12T19:13:42Z",
            "author_login": "tmroeder"
          },
          {
            "sha": "beacccb4506e1115742b7430b97c2e3313c3d022",
            "date": "2022-03-28T21:29:15Z",
            "author_login": "tmroeder"
          },
          {
            "sha": "46a0ae8024b8382dd5b06c9aa1f385daac9b6da8",
            "date": "2022-03-28T20:53:31Z",
            "author_login": "tmroeder"
          },
          {
            "sha": "ec7967c934cf35a397cd441eac9994b1476e27ac",
            "date": "2022-03-28T20:23:37Z",
            "author_login": "tmroeder"
          },
          {
            "sha": "a3b09ebff6c0e3b10e25d40f14991e16bb75d883",
            "date": "2021-10-02T07:26:39Z",
            "author_login": "arkivm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L",
    "cwe_id": "CWE-788",
    "description": "An attacker can change the pointer to untrusted memory to point to trusted memory region which causes copying trusted memory to trusted memory, if the latter is later copied out, it allows for reading of memory regions from the trusted region. It is recommended to update past 0.6.2 or git commit https://github.com/google/asylo/commit/53ed5d8fd8118ced1466e509606dd2f473707a5c",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-06-08T14:15:07.600",
    "last_modified": "2024-11-21T05:50:18.713",
    "fix_date": "2021-03-29T20:17:26Z"
  },
  "references": [
    {
      "url": "https://github.com/google/asylo/commit/53ed5d8fd8118ced1466e509606dd2f473707a5c",
      "source": "cve-coordination@google.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/asylo/commit/53ed5d8fd8118ced1466e509606dd2f473707a5c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.717319",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "asylo",
    "owner": "google",
    "created_at": "2018-04-25T16:43:56Z",
    "updated_at": "2025-01-05T09:23:25Z",
    "pushed_at": "2022-04-12T20:00:07Z",
    "size": 9030,
    "stars": 976,
    "forks": 126,
    "open_issues": 19,
    "watchers": 976,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 5876707,
      "Starlark": 708214,
      "C": 120094,
      "Python": 46063,
      "Shell": 43678,
      "Smarty": 41243,
      "Java": 23045,
      "Dockerfile": 2666,
      "HTML": 2522
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:57:24.686019"
  }
}