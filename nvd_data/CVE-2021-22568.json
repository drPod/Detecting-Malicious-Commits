{
  "cve_id": "CVE-2021-22568",
  "github_data": {
    "repository": "dart-lang/sdk",
    "fix_commit": "d787e78d21e12ec1ef712d229940b1172aafcdf8",
    "related_commits": [
      "d787e78d21e12ec1ef712d229940b1172aafcdf8",
      "d787e78d21e12ec1ef712d229940b1172aafcdf8"
    ],
    "patch_url": "https://github.com/dart-lang/sdk/commit/d787e78d21e12ec1ef712d229940b1172aafcdf8.patch",
    "fix_commit_details": {
      "sha": "d787e78d21e12ec1ef712d229940b1172aafcdf8",
      "commit_date": "2021-09-14T16:05:00Z",
      "author": {
        "login": "sigurdm",
        "type": "User",
        "stats": {
          "total_commits": 436,
          "average_weekly_commits": 0.6282420749279539,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 175
        }
      },
      "commit_message": {
        "title": "Bump pub",
        "length": 645,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 16,
        "deletions": 2
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 15,
          "deletions": 1,
          "patch": "@@ -132,15 +132,29 @@ Updated the Linter to `1.11.0`, which includes changes that\n - fixes false positives in `use_rethrow_when_possible`.\n - improves performance for `annotate_overrides`, `prefer_contains`, and\n   `prefer_void_to_null`.\n+\n ### Pub\n+\n+- Adds support for token-based authorization to third party package-repositories\n+  with the new command `dart pub token`.\n+- Credentials are no longer stored in the pub-cache, but in a platform dependent\n+  config directory:\n+  * On Linux `$XDG_CONFIG_HOME/dart/pub-credentials.json` if `$XDG_CONFIG_HOME`\n+    is defined, otherwise `$HOME/.config/dart/pub-credentials.json`\n+  * On Mac OS: `$HOME/Library/Application Support/dart/pub-credentials.json`\n+  * On Windows: `%APPDATA%/dart/pub-credentials.json`\n+\n - Detect potential leaks in `dart pub publish`.\n   When publishing, pub will examine your files for potential secret keys, and\n   warn you.\n \n   To ignore a file that has a false positive, add it to a\n   [`false_secrets`](https://dart.dev/go/false-secrets) section of your\n   `pubspec.yaml`.\n-- Fixes unicode terminal detection windows\n+- Fixes unicode terminal detection windows.\n+- New flag `--example` to the commands \n+  `dart pub get/upgrade/downgrade/add/remove` that will result in the `example/`\n+  folder dependencies to be updated after operating in the current directory. \n \n ## 2.14.1 - 2021-09-09\n "
        },
        {
          "filename": "DEPS",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -138,7 +138,7 @@ vars = {\n   \"pool_rev\": \"7abe634002a1ba8a0928eded086062f1307ccfae\",\n   \"process_rev\": \"56ece43b53b64c63ae51ec184b76bd5360c28d0b\",\n   \"protobuf_rev\": \"c1eb6cb51af39ccbaa1a8e19349546586a5c8e31\",\n-  \"pub_rev\": \"d95c5713dda518ed53ada70e00789e6aadbfbe48\",\n+  \"pub_rev\": \"cafadd17ba285dad9ebe6d34c617bc0d70d096b3\",\n   \"pub_semver_rev\": \"a43ad72fb6b7869607581b5fedcb186d1e74276a\",\n   \"resource_rev\": \"6b79867d0becf5395e5819a75720963b8298e9a7\",\n   \"root_certificates_rev\": \"692f6d6488af68e0121317a9c2c9eb393eb0ee50\","
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b5232ac632e26ffc4b4ca3d20afd51d337dbb39b",
            "date": "2025-01-14T19:06:10Z",
            "author_login": "Markzipan"
          },
          {
            "sha": "330cc916c6b5ecc76d52dc3daf1aea97184a363b",
            "date": "2025-01-14T18:31:26Z",
            "author_login": "stereotype441"
          },
          {
            "sha": "eafaa1173823e238eff5c9508a2e326da604ab7b",
            "date": "2025-01-14T18:27:18Z",
            "author_login": "scheglov"
          },
          {
            "sha": "6aeb1bffc1b3f1bd126d3904a2da7b1bdf42d004",
            "date": "2025-01-14T18:03:08Z",
            "author_login": "stereotype441"
          },
          {
            "sha": "52cc62938cb93ef747c57d66f19db06260145402",
            "date": "2025-01-14T17:54:23Z",
            "author_login": "rmacnak-google"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:L",
    "cwe_id": "CWE-255",
    "description": "When using the dart pub publish command to publish a package to a third-party package server, the request would be authenticated with an oauth2 access_token that is valid for publishing on pub.dev. Using these obtained credentials, an attacker can impersonate the user on pub.dev. We recommend upgrading past https://github.com/dart-lang/sdk/commit/d787e78d21e12ec1ef712d229940b1172aafcdf8 or beyond version 2.15.0",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-09T17:15:07.567",
    "last_modified": "2024-11-21T05:50:20.490",
    "fix_date": "2021-09-14T16:05:00Z"
  },
  "references": [
    {
      "url": "https://github.com/dart-lang/sdk/blob/main/CHANGELOG.md",
      "source": "cve-coordination@google.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dart-lang/sdk/commit/d787e78d21e12ec1ef712d229940b1172aafcdf8",
      "source": "cve-coordination@google.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dart-lang/sdk/security/advisories/GHSA-r32f-vhjp-qhj7",
      "source": "cve-coordination@google.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/dart-lang/sdk/blob/main/CHANGELOG.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dart-lang/sdk/commit/d787e78d21e12ec1ef712d229940b1172aafcdf8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dart-lang/sdk/security/advisories/GHSA-r32f-vhjp-qhj7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.828551",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sdk",
    "owner": "dart-lang",
    "created_at": "2015-05-16T14:14:58Z",
    "updated_at": "2025-01-14T14:41:25Z",
    "pushed_at": "2025-01-14T14:41:19Z",
    "size": 1476140,
    "stars": 10381,
    "forks": 1603,
    "open_issues": 8145,
    "watchers": 10381,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "beta",
      "dev",
      "main",
      "master",
      "stable"
    ],
    "languages": {
      "Dart": 145669978,
      "C++": 23871549,
      "C": 1579300,
      "Python": 1290938,
      "HTML": 702875,
      "Java": 589555,
      "JavaScript": 277923,
      "Shell": 107149,
      "GAP": 97087,
      "CSS": 76022,
      "ANTLR": 48460,
      "TeX": 37865,
      "SCSS": 22311,
      "Makefile": 10867,
      "Assembly": 8350,
      "Batchfile": 4772,
      "CMake": 1598,
      "Objective-C++": 854,
      "Dockerfile": 499
    },
    "commit_activity": {
      "total_commits_last_year": 5883,
      "avg_commits_per_week": 113.13461538461539,
      "days_active_last_year": 304
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T14:47:50.604306"
  }
}