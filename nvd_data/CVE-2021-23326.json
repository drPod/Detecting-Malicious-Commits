{
  "cve_id": "CVE-2021-23326",
  "github_data": {
    "repository": "ardatan/graphql-tools",
    "fix_commit": "6a966beee8ca8b2f4adfe93318b96e4a5c501eac",
    "related_commits": [
      "6a966beee8ca8b2f4adfe93318b96e4a5c501eac",
      "6a966beee8ca8b2f4adfe93318b96e4a5c501eac"
    ],
    "patch_url": "https://github.com/ardatan/graphql-tools/commit/6a966beee8ca8b2f4adfe93318b96e4a5c501eac.patch",
    "fix_commit_details": {
      "sha": "6a966beee8ca8b2f4adfe93318b96e4a5c501eac",
      "commit_date": "2021-01-13T10:22:00Z",
      "author": {
        "login": "dotansimha",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix vulnerability in git-loader: use execFile instead of exec (#2470)",
        "length": 69,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 10,
        "deletions": 5
      },
      "files": [
        {
          "filename": ".changeset/green-cycles-drive.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+'@graphql-tools/git-loader': patch\n+---\n+\n+Fix vulnerability: use execFile instead of exec"
        },
        {
          "filename": "packages/loaders/git/src/load-git.ts",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -1,10 +1,10 @@\n-import { exec, execSync } from 'child_process';\n+import { execFile, execFileSync } from 'child_process';\n \n type Input = { ref: string; path: string };\n \n const createLoadError = (error: any) => new Error('Unable to load file from git: ' + error);\n-const createCommand = ({ ref, path }: Input) => {\n-  return `git show ${ref}:${path}`;\n+const createCommand = ({ ref, path }: Input): string[] => {\n+  return ['show', `${ref}:${path}`];\n };\n \n /**\n@@ -13,7 +13,7 @@ const createCommand = ({ ref, path }: Input) => {\n export async function loadFromGit(input: Input): Promise<string | never> {\n   try {\n     return await new Promise((resolve, reject) => {\n-      exec(createCommand(input), { encoding: 'utf-8', maxBuffer: 1024 * 1024 * 1024 }, (error, stdout) => {\n+      execFile('git', createCommand(input), { encoding: 'utf-8', maxBuffer: 1024 * 1024 * 1024 }, (error, stdout) => {\n         if (error) {\n           reject(error);\n         } else {\n@@ -31,7 +31,7 @@ export async function loadFromGit(input: Input): Promise<string | never> {\n  */\n export function loadFromGitSync(input: Input): string | never {\n   try {\n-    return execSync(createCommand(input), { encoding: 'utf-8' });\n+    return execFileSync('git', createCommand(input), { encoding: 'utf-8' });\n   } catch (error) {\n     throw createLoadError(error);\n   }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "782a15ab32413c2e1ac046bc2b3ef0706d9be48f",
            "date": "2025-01-14T14:05:19Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "013fd02e9277709edd6a96930768115ff30d6cc0",
            "date": "2025-01-14T10:57:25Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "04cba534893cd3484c7e6ce6c88e239bc40bd3f9",
            "date": "2025-01-14T10:48:49Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "6d06498a616b9e6d09d931d346d5ff145864c329",
            "date": "2025-01-14T10:48:40Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "86740c3d6551c59fce82e4189df57d4657a2f3c9",
            "date": "2025-01-13T16:39:28Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-78",
    "description": "This affects the package @graphql-tools/git-loader before 6.2.6. The use of exec and execSync in packages/loaders/git/src/load-git.ts allows arbitrary command injection.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-01-20T13:15:12.893",
    "last_modified": "2024-11-21T05:51:30.557",
    "fix_date": "2021-01-13T10:22:00Z"
  },
  "references": [
    {
      "url": "https://advisory.checkmarx.net/advisory/CX-2020-4300",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ardatan/graphql-tools/commit/6a966beee8ca8b2f4adfe93318b96e4a5c501eac",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ardatan/graphql-tools/pull/2470",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ardatan/graphql-tools/releases/tag/%40graphql-tools%2Fgit-loader%406.2.6",
      "source": "report@snyk.io",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-GRAPHQLTOOLSGITLOADER-1062543",
      "source": "report@snyk.io",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://advisory.checkmarx.net/advisory/CX-2020-4300",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ardatan/graphql-tools/commit/6a966beee8ca8b2f4adfe93318b96e4a5c501eac",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ardatan/graphql-tools/pull/2470",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ardatan/graphql-tools/releases/tag/%40graphql-tools%2Fgit-loader%406.2.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-GRAPHQLTOOLSGITLOADER-1062543",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.158289",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "graphql-tools",
    "owner": "ardatan",
    "created_at": "2016-03-22T00:14:38Z",
    "updated_at": "2025-01-14T14:05:23Z",
    "pushed_at": "2025-01-14T14:08:24Z",
    "size": 52387,
    "stars": 5362,
    "forks": 820,
    "open_issues": 161,
    "watchers": 5362,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "TypeScript": 1593784,
      "MDX": 142960,
      "JavaScript": 17338,
      "Shell": 293
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:25:29.008988"
  }
}