{
  "cve_id": "CVE-2021-23346",
  "github_data": {
    "repository": "rayd/html-parse-stringify2",
    "fix_commit": "c7274a48e59c92b2b7e906fedf9065159e73fe12",
    "related_commits": [
      "c7274a48e59c92b2b7e906fedf9065159e73fe12",
      "c7274a48e59c92b2b7e906fedf9065159e73fe12"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c7274a48e59c92b2b7e906fedf9065159e73fe12",
      "commit_date": "2021-02-26T18:37:18Z",
      "author": {
        "login": "HenrikJoreteg",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixing reported ReDoS",
        "length": 21,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 18,
        "deletions": 1
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -135,6 +135,7 @@ properties:\n \n ## changelog\n \n+- `2.0.1` Addressing a reported regular expression denial of service issue reported by [Sam Sanoop](https://twitter.com/snoopysecurity) of [Snyk](https://snyk.io/) THANK YOU!. The issue was that sending certain input would cause one of the regular expressions we used to lock up and not finish, freezing the process. See the test that was added for details. To be clear, this lib wasn't meant for parsing non-well formed HTML. But, better safe than sorry! So we're fixing it.\n - `2.0.0` updated to more modern dependencies/build system. Switched to prettier, etc. No big feature differences, just new build system/project structure. Added support for top level text nodes thanks to @jperl. Added support for comments thanks to @pconerly.\n - `1.0.0 - 1.0.3` no big changes, bug fixes and speed improvements.\n "
        },
        {
          "filename": "src/parse.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-const tagRE = /<[a-zA-Z\\-\\!\\/](?:\"[^\"]*\"['\"]*|'[^']*'['\"]*|[^'\">])*>/g\n+const tagRE = /<[a-zA-Z\\-\\!\\/](?:\"[^\"]*\"|'[^']*'|[^'\">])*>/g\n import parseTag from './parse-tag'\n \n // re-used obj for quick lookups of components"
        },
        {
          "filename": "test/parse.js",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -766,3 +766,19 @@ test('simple speed sanity check', function (t) {\n \n   t.end()\n })\n+\n+test('ReDoS vulnerability reported by Sam Sanoop of Snyk', function (t) {\n+  const start = Date.now()\n+  // reported problematic string\n+  HTML.parse(\n+    \"<!''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''!\"\n+  )\n+  // other variant\n+  HTML.parse(\n+    '<!\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"!'\n+  )\n+  const duration = Date.now() - start\n+\n+  t.ok(duration < 100, 'should not hang')\n+  t.end()\n+})"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dbf026f9010a14167e5a9e8589464f660233e446",
            "date": "2017-08-08T17:46:32Z",
            "author_login": "rayd"
          },
          {
            "sha": "83ce38df01609b8877ef71ccc238023b6c14871c",
            "date": "2017-08-08T17:44:03Z",
            "author_login": "rayd"
          },
          {
            "sha": "358f8b37d3f20b7aab45c02ee186cb3193753417",
            "date": "2017-08-01T15:51:50Z",
            "author_login": "des-des"
          },
          {
            "sha": "0460814f20ca1591e749d52f7dfff435249033c8",
            "date": "2017-07-24T20:17:08Z",
            "author_login": "rayd"
          },
          {
            "sha": "151e4fda358432cf92db6f29199965b562543a3f",
            "date": "2017-07-24T19:35:47Z",
            "author_login": "rayd"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": null,
    "description": "This affects the package html-parse-stringify before 2.0.1; all versions of package html-parse-stringify2. Sending certain input could cause one of the regular expressions that is used for parsing to backtrack, freezing the process.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-03-04T17:15:13.700",
    "last_modified": "2024-11-21T05:51:32.960",
    "fix_date": "2021-02-26T18:37:18Z"
  },
  "references": [
    {
      "url": "https://github.com/HenrikJoreteg/html-parse-stringify/blob/master/lib/parse.js%23L2",
      "source": "report@snyk.io",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/HenrikJoreteg/html-parse-stringify/commit/c7274a48e59c92b2b7e906fedf9065159e73fe12",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rayd/html-parse-stringify2/blob/master/lib/parse.js%23L2",
      "source": "report@snyk.io",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1080633",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-HTMLPARSESTRINGIFY-1079306",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-HTMLPARSESTRINGIFY2-1079307",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/HenrikJoreteg/html-parse-stringify/blob/master/lib/parse.js%23L2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/HenrikJoreteg/html-parse-stringify/commit/c7274a48e59c92b2b7e906fedf9065159e73fe12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rayd/html-parse-stringify2/blob/master/lib/parse.js%23L2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1080633",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-HTMLPARSESTRINGIFY-1079306",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-HTMLPARSESTRINGIFY2-1079307",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.820363",
    "processing_status": "enhanced"
  }
}