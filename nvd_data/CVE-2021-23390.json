{
  "cve_id": "CVE-2021-23390",
  "github_data": {
    "repository": "totaljs/framework4",
    "fix_commit": "8a72d8c20f38bbcac031a76a51238aa528f68821",
    "related_commits": [
      "8a72d8c20f38bbcac031a76a51238aa528f68821",
      "8a72d8c20f38bbcac031a76a51238aa528f68821"
    ],
    "patch_url": "https://github.com/totaljs/framework4/commit/8a72d8c20f38bbcac031a76a51238aa528f68821.patch",
    "fix_commit_details": {
      "sha": "8a72d8c20f38bbcac031a76a51238aa528f68821",
      "commit_date": "2021-06-04T09:37:12Z",
      "author": {
        "login": "petersirka",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Removed useless methods.",
        "length": 24,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 148,
        "additions": 4,
        "deletions": 144
      },
      "files": [
        {
          "filename": "changelog.txt",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -3,6 +3,10 @@\n ========================\n \n - improved `flowinstance.newmessage(data)` method\n+- removed method `U.set()`\n+- removed method `U.get()`\n+- removed method `U.sync()` and `global.sync()`\n+- removed method `U.sync2()` and `global.sync2()`\n \n ========================\n 0.0.42"
        },
        {
          "filename": "utils.js",
          "status": "modified",
          "additions": 0,
          "deletions": 144,
          "patch": "@@ -5203,64 +5203,6 @@ FLP.next = function() {\n \tself.onComplete(self.file, self.directory);\n };\n \n-exports.sync = function(fn, owner) {\n-\treturn function() {\n-\n-\t\tvar args = [].slice.call(arguments);\n-\t\tvar params;\n-\t\tvar callback;\n-\t\tvar executed = false;\n-\t\tvar self = owner || this;\n-\n-\t\targs.push(function() {\n-\t\t\tparams = arguments;\n-\t\t\tif (!executed && callback) {\n-\t\t\t\texecuted = true;\n-\t\t\t\tcallback.apply(self, params);\n-\t\t\t}\n-\t\t});\n-\n-\t\tfn.apply(self, args);\n-\n-\t\treturn function(cb) {\n-\t\t\tcallback = cb;\n-\t\t\tif (!executed && params) {\n-\t\t\t\texecuted = true;\n-\t\t\t\tcallback.apply(self, params);\n-\t\t\t}\n-\t\t};\n-\t};\n-};\n-\n-exports.sync2 = function(fn, owner) {\n-\treturn (function() {\n-\n-\t\tvar params;\n-\t\tvar callback;\n-\t\tvar executed = false;\n-\t\tvar self = owner || this;\n-\t\tvar args = [].slice.call(arguments);\n-\n-\t\targs.push(function() {\n-\t\t\tparams = arguments;\n-\t\t\tif (!executed && callback) {\n-\t\t\t\texecuted = true;\n-\t\t\t\tcallback.apply(self, params);\n-\t\t\t}\n-\t\t});\n-\n-\t\tfn.apply(self, args);\n-\n-\t\treturn function(cb) {\n-\t\t\tcallback = cb;\n-\t\t\tif (!executed && params) {\n-\t\t\t\texecuted = true;\n-\t\t\t\tcallback.apply(self, params);\n-\t\t\t}\n-\t\t};\n-\t})();\n-};\n-\n exports.async = function(fn, isApply) {\n \tvar context = this;\n \treturn function(complete) {\n@@ -5475,92 +5417,6 @@ exports.parseTheme = function(value) {\n \treturn value === '?' ? CONF.default_theme : value;\n };\n \n-exports.set = function(obj, path, value) {\n-\tvar cachekey = 'S+' + path;\n-\n-\tif (F.temporary.other[cachekey])\n-\t\treturn F.temporary.other[cachekey](obj, value);\n-\n-\tvar arr = parsepath(path);\n-\tvar builder = [];\n-\n-\tfor (var i = 0; i < arr.length - 1; i++) {\n-\t\tvar type = arr[i + 1] ? (REGISARR.test(arr[i + 1]) ? '[]' : '{}') : '{}';\n-\t\tvar p = 'w' + (arr[i][0] === '[' ? '' : '.') + arr[i];\n-\t\tbuilder.push('if(typeof(' + p + ')!==\\'object\\'||' + p + '==null)' + p + '=' + type + ';');\n-\t}\n-\n-\tvar v = arr[arr.length - 1];\n-\tvar ispush = v.lastIndexOf('[]') !== -1;\n-\tvar a = builder.join(';') + ';var v=typeof(a)===\\'function\\'?a(U.get(b)):a;w' + (v[0] === '[' ? '' : '.') + (ispush ? v.replace(REGREPLACEARR, '.push(v)') : (v + '=v')) + ';return v';\n-\n-\tif ((/__proto__|constructor|prototype|eval/).test(a))\n-\t\tthrow new Error('Potential vulnerability');\n-\n-\tvar fn = new Function('w', 'a', 'b', a);\n-\tF.temporary.other[cachekey] = fn;\n-\tfn(obj, value, path);\n-};\n-\n-exports.get = function(obj, path) {\n-\n-\tvar cachekey = 'G=' + path;\n-\n-\tif (F.temporary.other[cachekey])\n-\t\treturn F.temporary.other[cachekey](obj);\n-\n-\tvar arr = parsepath(path);\n-\tvar builder = [];\n-\n-\tfor (var i = 0, length = arr.length - 1; i < length; i++)\n-\t\tbuilder.push('if(!w' + (!arr[i] || arr[i][0] === '[' ? '' : '.') + arr[i] + ')return');\n-\n-\tvar v = arr[arr.length - 1];\n-\tvar fn = (new Function('w', builder.join(';') + ';return w' + (v[0] === '[' ? '' : '.') + v));\n-\tF.temporary.other[cachekey] = fn;\n-\treturn fn(obj);\n-};\n-\n-function parsepath(path) {\n-\n-\tvar arr = path.split('.');\n-\tvar builder = [];\n-\tvar all = [];\n-\n-\tfor (var i = 0; i < arr.length; i++) {\n-\t\tvar p = arr[i];\n-\t\tvar index = p.indexOf('[');\n-\t\tif (index === -1) {\n-\t\t\tif (p.indexOf('-') === -1) {\n-\t\t\t\tall.push(p);\n-\t\t\t\tbuilder.push(all.join('.'));\n-\t\t\t} else {\n-\t\t\t\tvar a = all.splice(all.length - 1);\n-\t\t\t\tall.push(a + '[\\'' + p + '\\']');\n-\t\t\t\tbuilder.push(all.join('.'));\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif (p.indexOf('-') === -1) {\n-\t\t\t\tall.push(p.substring(0, index));\n-\t\t\t\tbuilder.push(all.join('.'));\n-\t\t\t\tall.splice(all.length - 1);\n-\t\t\t\tall.push(p);\n-\t\t\t\tbuilder.push(all.join('.'));\n-\t\t\t} else {\n-\t\t\t\tall.push('[\\'' + p.substring(0, index) + '\\']');\n-\t\t\t\tbuilder.push(all.join(''));\n-\t\t\t\tall.push(p.substring(index));\n-\t\t\t\tbuilder.push(all.join(''));\n-\t\t\t}\n-\t\t}\n-\t}\n-\n-\treturn builder;\n-}\n-\n-global.sync = exports.sync;\n-global.sync2 = exports.sync2;\n-\n // =============================================\n // SHELL SORT IMPLEMENTATION OF ALGORITHM\n // ============================================="
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5f099d9622d36aa02d491e17581af7ecace0f26b",
            "date": "2025-01-13T08:00:23Z",
            "author_login": "petersirka"
          },
          {
            "sha": "386e5258320f82893900c1f86b476a3acd0f0c0a",
            "date": "2025-01-13T07:59:07Z",
            "author_login": "petersirka"
          },
          {
            "sha": "8b5dcce1a88fdc2ab92ffa95b5b700bef1137573",
            "date": "2024-12-27T10:25:17Z",
            "author_login": "petersirka"
          },
          {
            "sha": "54c3cf8a00a9a5641bdbf93032e54d64ab7adfc7",
            "date": "2024-12-27T10:24:55Z",
            "author_login": "petersirka"
          },
          {
            "sha": "8f3dd1571ef7736581ccf768c98af09c1ff6f2a8",
            "date": "2024-12-27T09:52:22Z",
            "author_login": "petersirka"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-94",
    "description": "The package total4 before 0.0.43 are vulnerable to Arbitrary Code Execution via the U.set() and U.get() functions.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-12T16:15:09.030",
    "last_modified": "2024-11-21T05:51:37.820",
    "fix_date": "2021-06-04T09:37:12Z"
  },
  "references": [
    {
      "url": "https://github.com/totaljs/framework4/blob/master/utils.js%23L5430-L5455",
      "source": "report@snyk.io",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/totaljs/framework4/commit/8a72d8c20f38bbcac031a76a51238aa528f68821",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-TOTAL4-1130527",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/totaljs/framework4/blob/master/utils.js%23L5430-L5455",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/totaljs/framework4/commit/8a72d8c20f38bbcac031a76a51238aa528f68821",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-TOTAL4-1130527",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.297487",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "framework4",
    "owner": "totaljs",
    "created_at": "2020-06-05T10:04:56Z",
    "updated_at": "2025-01-13T08:00:30Z",
    "pushed_at": "2025-01-13T08:00:26Z",
    "size": 5983,
    "stars": 101,
    "forks": 36,
    "open_issues": 2,
    "watchers": 101,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 1626939,
      "HTML": 6152,
      "Shell": 199,
      "TypeScript": 186
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T23:02:04.047080"
  }
}