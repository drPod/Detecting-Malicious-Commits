{
  "cve_id": "CVE-2021-23414",
  "github_data": {
    "repository": "videojs/video.js",
    "fix_commit": "b3acf663641fca0f7a966525a72845af7ec5fab2",
    "related_commits": [
      "b3acf663641fca0f7a966525a72845af7ec5fab2",
      "b3acf663641fca0f7a966525a72845af7ec5fab2"
    ],
    "patch_url": "https://github.com/videojs/video.js/commit/b3acf663641fca0f7a966525a72845af7ec5fab2.patch",
    "fix_commit_details": {
      "sha": "b3acf663641fca0f7a966525a72845af7ec5fab2",
      "commit_date": "2021-07-22T17:14:26Z",
      "author": {
        "login": "gkatsev",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: remove IE8 url parsing workaround (#7334)",
        "length": 46,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 35,
        "additions": 10,
        "deletions": 25
      },
      "files": [
        {
          "filename": "src/js/utils/url.js",
          "status": "modified",
          "additions": 8,
          "deletions": 20,
          "patch": "@@ -41,38 +41,25 @@ import window from 'global/window';\n  *           An object of url details\n  */\n export const parseUrl = function(url) {\n+  // This entire method can be replace with URL once we are able to drop IE11\n+\n   const props = ['protocol', 'hostname', 'port', 'pathname', 'search', 'hash', 'host'];\n \n   // add the url to an anchor and let the browser parse the URL\n-  let a = document.createElement('a');\n+  const a = document.createElement('a');\n \n   a.href = url;\n \n-  // IE8 (and 9?) Fix\n-  // ie8 doesn't parse the URL correctly until the anchor is actually\n-  // added to the body, and an innerHTML is needed to trigger the parsing\n-  const addToBody = (a.host === '' && a.protocol !== 'file:');\n-  let div;\n-\n-  if (addToBody) {\n-    div = document.createElement('div');\n-    div.innerHTML = `<a href=\"${url}\"></a>`;\n-    a = div.firstChild;\n-    // prevent the div from affecting layout\n-    div.setAttribute('style', 'display:none; position:absolute;');\n-    document.body.appendChild(div);\n-  }\n-\n   // Copy the specific URL properties to a new object\n-  // This is also needed for IE8 because the anchor loses its\n+  // This is also needed for IE because the anchor loses its\n   // properties when it's removed from the dom\n   const details = {};\n \n   for (let i = 0; i < props.length; i++) {\n     details[props[i]] = a[props[i]];\n   }\n \n-  // IE9 adds the port to the host property unlike everyone else. If\n+  // IE adds the port to the host property unlike everyone else. If\n   // a port identifier is added for standard ports, strip it.\n   if (details.protocol === 'http:') {\n     details.host = details.host.replace(/:80$/, '');\n@@ -86,8 +73,9 @@ export const parseUrl = function(url) {\n     details.protocol = window.location.protocol;\n   }\n \n-  if (addToBody) {\n-    document.body.removeChild(div);\n+  /* istanbul ignore if */\n+  if (!details.host) {\n+    details.host = window.location.host;\n   }\n \n   return details;"
        },
        {
          "filename": "test/unit/utils/url.test.js",
          "status": "modified",
          "additions": 2,
          "deletions": 5,
          "patch": "@@ -5,12 +5,9 @@ import * as Url from '../../../src/js/utils/url.js';\n \n QUnit.module('url');\n QUnit.test('should parse the details of a url correctly', function(assert) {\n-  assert.equal(\n-    Url.parseUrl('#').protocol,\n-    window.location.protocol,\n-    'parsed relative url protocol'\n-  );\n+  assert.equal(Url.parseUrl('#').protocol, window.location.protocol, 'parsed relative url protocol');\n   assert.equal(Url.parseUrl('#').host, window.location.host, 'parsed relative url host');\n+  assert.equal(Url.parseUrl('#foo').hash, '#foo', 'parsed relative url hash');\n \n   assert.equal(Url.parseUrl('http://example.com').protocol, 'http:', 'parsed example url protocol');\n   assert.equal(Url.parseUrl('http://example.com').hostname, 'example.com', 'parsed example url hostname');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "19ca3f2ebe0ec7f0374fa3bc7df1457f9f185823",
            "date": "2024-12-05T21:48:07Z",
            "author_login": "harisha-swaminathan"
          },
          {
            "sha": "a0ca1681f85cdb4b930caf1619221e123a99a254",
            "date": "2024-12-05T21:46:50Z",
            "author_login": "Mejans"
          },
          {
            "sha": "b6cec4f6b5bbfd22b4c90622370433a20ccf4dba",
            "date": "2024-12-05T21:34:04Z",
            "author_login": "SimonAllen0901"
          },
          {
            "sha": "ca6f8235453d0d45ae4d05c8b056e2a8c206bc26",
            "date": "2024-12-05T19:36:40Z",
            "author_login": "harisha-swaminathan"
          },
          {
            "sha": "a7ba9f2fc5e1ccd0da153f52fd73fdf6b78fc30c",
            "date": "2024-12-05T19:29:33Z",
            "author_login": "harisha-swaminathan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "This affects the package video.js before 7.14.3. The src attribute of track tag allows to bypass HTML escaping and execute arbitrary code.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-28T08:15:07.077",
    "last_modified": "2024-11-21T05:51:40.420",
    "fix_date": "2021-07-22T17:14:26Z"
  },
  "references": [
    {
      "url": "https://github.com/videojs/video.js/commit/b3acf663641fca0f7a966525a72845af7ec5fab2",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2DHYIIAUXUBHMBEDYU7TYNZXEN2W2SA2/",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/74SXNGA5RIWM7QNX7H3G7SYIQLP4UUGV/",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NLRJB5JNKK3VVBLV3NH3RI7COEDAXSAB/",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSBOWER-1533588",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1533587",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-VIDEOJS-1533429",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/videojs/video.js/commit/b3acf663641fca0f7a966525a72845af7ec5fab2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2DHYIIAUXUBHMBEDYU7TYNZXEN2W2SA2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/74SXNGA5RIWM7QNX7H3G7SYIQLP4UUGV/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NLRJB5JNKK3VVBLV3NH3RI7COEDAXSAB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSBOWER-1533588",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-1533587",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-VIDEOJS-1533429",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.345477",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "video.js",
    "owner": "videojs",
    "created_at": "2010-05-14T18:45:10Z",
    "updated_at": "2025-01-14T08:17:05Z",
    "pushed_at": "2024-12-05T21:48:23Z",
    "size": 127927,
    "stars": 38286,
    "forks": 7480,
    "open_issues": 559,
    "watchers": 38286,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "5.x",
      "6.x",
      "gh-pages",
      "main"
    ],
    "languages": {
      "JavaScript": 1694582,
      "SCSS": 53064,
      "CSS": 4370,
      "HTML": 2066
    },
    "commit_activity": {
      "total_commits_last_year": 129,
      "avg_commits_per_week": 2.480769230769231,
      "days_active_last_year": 64
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:32:32.932030"
  }
}