{
  "cve_id": "CVE-2021-23415",
  "github_data": {
    "repository": "mguinness/elFinder.AspNet",
    "fix_commit": "675049b39284a9e84f0915c71d688da8ebc7d720",
    "related_commits": [
      "675049b39284a9e84f0915c71d688da8ebc7d720",
      "675049b39284a9e84f0915c71d688da8ebc7d720"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "675049b39284a9e84f0915c71d688da8ebc7d720",
      "commit_date": "2021-07-10T01:28:34Z",
      "author": {
        "login": "mguinness",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Directory traversal fixes",
        "length": 25,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 16,
        "deletions": 0
      },
      "files": [
        {
          "filename": "elFinder.AspNet/Drivers/FileSystem/FileSystemDriver.cs",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -229,6 +229,12 @@ public async Task<ConnectorResult> ExtractAsync(FullPath fullPath, bool newFolde\n                         string file = Path.Combine(rootPath, entry.FullName)\n                              .Replace(\"/\", separator).Replace(\"\\\\\", separator);\n \n+                        string destPath = Path.GetFullPath(file);\n+                        if (!destPath.StartsWith(rootPath, StringComparison.OrdinalIgnoreCase))\n+                        {\n+                            throw new NotSupportedException($\"Entry '{entry.FullName}' is outside of the destination directory.\");\n+                        }\n+\n                         if (file.EndsWith(separator)) //directory\n                         {\n                             var dir = new FileSystemDirectory(file);\n@@ -636,12 +642,22 @@ public async Task<ConnectorResult> RenameAsync(FullPath path, string name)\n             if (path.IsDirectory)\n             {\n                 var newPath = new FileSystemDirectory(Path.Combine(path.Directory.Parent.FullName, name));\n+                string destPath = Path.GetFullPath(newPath.FullName);\n+                if (!destPath.StartsWith(path.RootVolume.RootDirectory, StringComparison.OrdinalIgnoreCase))\n+                {\n+                    throw new NotSupportedException($\"Entry '{name}' is outside of the home directory.\");\n+                }\n                 Directory.Move(path.Directory.FullName, newPath.FullName);\n                 response.Added.Add(await BaseModel.CreateAsync(newPath, path.RootVolume));\n             }\n             else\n             {\n                 var newPath = new FileSystemFile(Path.Combine(path.File.DirectoryName, name));\n+                string destPath = Path.GetFullPath(newPath.FullName);\n+                if (!destPath.StartsWith(path.RootVolume.RootDirectory, StringComparison.OrdinalIgnoreCase))\n+                {\n+                    throw new NotSupportedException($\"Entry '{name}' is outside of the home directory.\");\n+                }\n                 File.Move(path.File.FullName, newPath.FullName);\n                 response.Added.Add(await BaseModel.CreateAsync(newPath, path.RootVolume));\n             }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "107d1316dd08e0d14c3fee867c5e179670e56304",
            "date": "2021-07-10T01:39:51Z",
            "author_login": "mguinness"
          },
          {
            "sha": "675049b39284a9e84f0915c71d688da8ebc7d720",
            "date": "2021-07-10T01:28:34Z",
            "author_login": "mguinness"
          },
          {
            "sha": "8f2690712bd6cf417d897d70f734d6e972cf0071",
            "date": "2021-03-21T23:06:37Z",
            "author_login": "mguinness"
          },
          {
            "sha": "7db6d0947b119bed365eb88fb27fee08572d7507",
            "date": "2021-03-12T00:48:33Z",
            "author_login": "mguinness"
          },
          {
            "sha": "a6fd7b459758a18c059b86d3e89d0d0796230a09",
            "date": "2021-03-11T01:43:23Z",
            "author_login": "mguinness"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "This affects the package elFinder.AspNet before 1.1.1. The user-controlled file name is not properly sanitized before it is used to create a file system path.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-28T16:15:07.953",
    "last_modified": "2024-11-21T05:51:43.040",
    "fix_date": "2021-07-10T01:28:34Z"
  },
  "references": [
    {
      "url": "https://github.com/mguinness/elFinder.AspNet/commit/675049b39284a9e84f0915c71d688da8ebc7d720",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-DOTNET-ELFINDERASPNET-1315153",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mguinness/elFinder.AspNet/commit/675049b39284a9e84f0915c71d688da8ebc7d720",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-DOTNET-ELFINDERASPNET-1315153",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.345665",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "elFinder.AspNet",
    "owner": "mguinness",
    "created_at": "2021-03-06T17:34:36Z",
    "updated_at": "2023-09-02T18:41:55Z",
    "pushed_at": "2021-07-10T01:39:59Z",
    "size": 1110,
    "stars": 4,
    "forks": 2,
    "open_issues": 0,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "CSS": 190739,
      "C#": 162375,
      "Less": 27625,
      "HTML": 14178,
      "JavaScript": 34
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-2-clause"
    },
    "collected_at": "2025-01-26T08:34:13.300819"
  }
}