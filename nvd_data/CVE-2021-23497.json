{
  "cve_id": "CVE-2021-23497",
  "github_data": {
    "repository": "strikeentco/set",
    "fix_commit": "b2f942c",
    "related_commits": [
      "b2f942c",
      "b2f942c"
    ],
    "patch_url": "https://github.com/strikeentco/set/commit/b2f942c.patch",
    "fix_commit_details": {
      "sha": "b2f942c",
      "commit_date": "2022-01-27T17:25:37Z",
      "author": {
        "login": "strikeentco",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "1.0.2",
        "length": 62,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 1808,
        "additions": 884,
        "deletions": 924
      },
      "files": [
        {
          "filename": ".travis.yml",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -1,5 +1,7 @@\n language: node_js\n node_js:\n+  - \"16\"\n+  - \"14\"\n   - \"12\"\n   - \"10\"\n before_script:"
        },
        {
          "filename": "main.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,9 +1,9 @@\n 'use strict';\n \n-/* eslint-disable no-continue */\n+/* eslint-disable no-continue, eqeqeq */\n \n const isObject = (val) => typeof val === 'object' || typeof val === 'function';\n-const isProto = (val, obj) => val === '__proto__' || (val === 'constructor' && typeof obj.constructor === 'function');\n+const isProto = (val, obj) => val == '__proto__' || (val == 'constructor' && typeof obj.constructor === 'function');\n const set = (obj, parts, length, val) => {\n   let tmp = obj;\n   let i = 0;"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 861,
          "deletions": 915,
          "patch": null
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -1,7 +1,7 @@\n {\n   \"name\": \"@strikeentco/set\",\n   \"author\": \"Alexey Bystrov <strikeentco@gmail.com>\",\n-  \"version\": \"1.0.1\",\n+  \"version\": \"1.0.2\",\n   \"description\": \"Set nested values on an object using a dot path or custom separator\",\n   \"engines\": {\n     \"node\": \">=6.0.0\"\n@@ -50,12 +50,12 @@\n     \"url\": \"https://github.com/strikeentco/set/issues\"\n   },\n   \"devDependencies\": {\n-    \"eslint\": \"^7.12.1\",\n-    \"eslint-config-airbnb\": \"^18.2.0\",\n-    \"eslint-plugin-import\": \"^2.22.1\",\n-    \"eslint-plugin-jsx-a11y\": \"^6.4.1\",\n-    \"eslint-plugin-react\": \"^7.21.5\",\n-    \"mocha\": \"^8.2.0\",\n+    \"eslint\": \"^7.32.0\",\n+    \"eslint-config-airbnb\": \"^18.2.1\",\n+    \"eslint-plugin-import\": \"^2.25.4\",\n+    \"eslint-plugin-jsx-a11y\": \"^6.5.1\",\n+    \"eslint-plugin-react\": \"^7.28.0\",\n+    \"mocha\": \"^8.4.0\",\n     \"nyc\": \"^15.1.0\",\n     \"should\": \"^13.2.3\"\n   },"
        },
        {
          "filename": "test.js",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -114,6 +114,9 @@ describe('set', () => {\n \n     set(o, ['constructor', 'b'], 1);\n     should(o.constructor.b).be.eql(undefined);\n+\n+    set(o, [['constructor'], 'b'], 1);\n+    should(o.constructor.b).be.eql(undefined);\n   });\n \n   it('should not indirectly set Object properties', () => {\n@@ -123,6 +126,9 @@ describe('set', () => {\n \n     set(o, ['__proto__', 'b'], 1);\n     should(o.b).be.eql(undefined);\n+\n+    set(o, [['__proto__'], 'b'], 1);\n+    should(o.b).be.eql(undefined);\n   });\n \n   it('should not indirectly set Object properties', () => {\n@@ -133,6 +139,9 @@ describe('set', () => {\n \n     set(o, ['ob.constructor', 'b'], 1);\n     should(ob.b).be.eql(undefined);\n+\n+    set(o, [['ob.constructor'], 'b'], 1);\n+    should(ob.b).be.eql(undefined);\n   });\n \n   it('should not indirectly set Object properties', () => {\n@@ -143,5 +152,8 @@ describe('set', () => {\n \n     set(o, ['ob.__proto__', 'b'], 1);\n     should(ob.b).be.eql(undefined);\n+\n+    set(o, [['ob.__proto__'], 'b'], 1);\n+    should(ob.b).be.eql(undefined);\n   });\n });"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 3,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b2f942c29652066e484436a8cb0032932f085e9a",
            "date": "2022-01-27T17:25:37Z",
            "author_login": "strikeentco"
          },
          {
            "sha": "102cc6b2e1d1e0c928ced87e75df759d5541ff60",
            "date": "2020-10-29T11:37:56Z",
            "author_login": "strikeentco"
          },
          {
            "sha": "2e246ec3f4515b63bcb5984a99ad5dd57052ac37",
            "date": "2018-03-18T18:29:09Z",
            "author_login": "strikeentco"
          },
          {
            "sha": "ce159ecf78868d0bb781cded425000eb14622542",
            "date": "2018-03-18T18:20:46Z",
            "author_login": "strikeentco"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1321",
    "description": "This affects the package @strikeentco/set before 1.0.2. It allows an attacker to cause a denial of service and may lead to remote code execution. **Note:** This vulnerability derives from an incomplete fix in https://security.snyk.io/vuln/SNYK-JS-STRIKEENTCOSET-1038821",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-04T20:15:08.417",
    "last_modified": "2024-11-21T05:51:48.367",
    "fix_date": "2022-01-27T17:25:37Z"
  },
  "references": [
    {
      "url": "https://github.com/strikeentco/set/commit/b2f942c",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/blog/remediate-javascript-type-confusion-bypassed-input-validation/",
      "source": "report@snyk.io",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-STRIKEENTCOSET-2385945",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/strikeentco/set/commit/b2f942c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/blog/remediate-javascript-type-confusion-bypassed-input-validation/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-STRIKEENTCOSET-2385945",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.135339",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "set",
    "owner": "strikeentco",
    "created_at": "2018-03-18T18:20:45Z",
    "updated_at": "2023-12-05T06:48:34Z",
    "pushed_at": "2023-03-04T02:36:25Z",
    "size": 358,
    "stars": 3,
    "forks": 1,
    "open_issues": 6,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 5950
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T21:38:31.969619"
  }
}