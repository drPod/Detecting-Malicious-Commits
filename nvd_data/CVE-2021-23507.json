{
  "cve_id": "CVE-2021-23507",
  "github_data": {
    "repository": "skratchdot/object-path-set",
    "fix_commit": "2d67a714159c4099589b6661fa84e6d2adc31761",
    "related_commits": [
      "2d67a714159c4099589b6661fa84e6d2adc31761",
      "2d67a714159c4099589b6661fa84e6d2adc31761"
    ],
    "patch_url": "https://github.com/skratchdot/object-path-set/commit/2d67a714159c4099589b6661fa84e6d2adc31761.patch",
    "fix_commit_details": {
      "sha": "2d67a714159c4099589b6661fa84e6d2adc31761",
      "commit_date": "2022-01-30T22:35:21Z",
      "author": {
        "login": "skratchdot",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix new prototype pollution vulnerability",
        "length": 41,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8870,
        "additions": 8838,
        "deletions": 32
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -1,10 +1,12 @@\n+## Unreleased (2022-01-30)\n+\n ## <small>1.0.1 (2020-07-25)</small>\n \n - add prettier and `npm run build` ([1f34461](https://github.com/skratchdot/object-path-set/commit/1f34461))\n - adding contributors ([5bf6e83](https://github.com/skratchdot/object-path-set/commit/5bf6e83))\n - Bump eslint from 4.18.1 to 4.18.2 ([1756583](https://github.com/skratchdot/object-path-set/commit/1756583))\n - fix prototype pollution vulnerability ([55f06d7](https://github.com/skratchdot/object-path-set/commit/55f06d7))\n-- formatting ([6bddc79](https://github.com/skratchdot/object-path-set/commit/6bddc79))\n+- formatting ([577f529](https://github.com/skratchdot/object-path-set/commit/577f529))\n - rename tonic to runkit ([9c2f1ea](https://github.com/skratchdot/object-path-set/commit/9c2f1ea))\n - small readme tweaks ([9750b7a](https://github.com/skratchdot/object-path-set/commit/9750b7a))\n - travis runs node 6+ ([ac1969b](https://github.com/skratchdot/object-path-set/commit/ac1969b))"
        },
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -2,7 +2,12 @@\n \n // https://github.com/jonschlinkert/assign-deep/commit/90bf1c551d05940898168d04066bbf15060f50cc\n var isValidKey = function (key) {\n-  return key !== '__proto__' && key !== 'constructor' && key !== 'prototype';\n+  return (\n+    typeof key === 'string' &&\n+    key !== '__proto__' &&\n+    key !== 'constructor' &&\n+    key !== 'prototype'\n+  );\n };\n \n var setPath = function (obj, path, value, delimiter) {"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 8815,
          "deletions": 24,
          "patch": null
        },
        {
          "filename": "test.js",
          "status": "modified",
          "additions": 14,
          "deletions": 6,
          "patch": "@@ -6,18 +6,18 @@ var getDefaultObject = function () {\n   return {\n     nested: {\n       thing: {\n-        foo: 'bar'\n+        foo: 'bar',\n       },\n       is: {\n-        cool: true\n-      }\n+        cool: true,\n+      },\n     },\n     dataUndefined: undefined,\n     dataDate: now,\n     dataNumber: 42,\n     dataString: 'foo',\n     dataNull: null,\n-    dataBoolean: true\n+    dataBoolean: true,\n   };\n };\n \n@@ -51,13 +51,13 @@ describe('object-path-set', function () {\n     expect(setPath(true, 'a', 42)).toEqual({ a: 42 });\n     expect(setPath({ a: 123 }, 'a.b', 42)).toEqual({ a: { b: 42 } });\n     expect(setPath(null, 'a.b.c.d', null)).toEqual({\n-      a: { b: { c: { d: null } } }\n+      a: { b: { c: { d: null } } },\n     });\n   });\n   it('should be able to use custom delimiters', function () {\n     expect(setPath({}, 'a|b|c|d', 42)).toEqual({ 'a|b|c|d': 42 });\n     expect(setPath({}, 'a|b|c|d', 42, '|')).toEqual({\n-      a: { b: { c: { d: 42 } } }\n+      a: { b: { c: { d: 42 } } },\n     });\n     expect(setPath({}, 'a.b.c.d', 42, '|')).toEqual({ 'a.b.c.d': 42 });\n   });\n@@ -108,6 +108,14 @@ describe('object-path-set', function () {\n     expect(obj.polluted).toBeUndefined();\n     expect(obj2.polluted).toBeUndefined();\n   });\n+  it('should not pollute __proto__ when using arrays', function () {\n+    var obj = {};\n+    expect(obj.polluted).toBeUndefined();\n+    setPath(obj, [['__proto__'], 'polluted'], 'yes');\n+    var obj2 = {};\n+    expect(obj.polluted).toBeUndefined();\n+    expect(obj2.polluted).toBeUndefined();\n+  });\n   it('should not pollute constructor', function () {\n     var obj = {};\n     expect(obj.polluted).toBeUndefined();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6251ba470cad27d5cb762d2cfeeb5dbd104dc305",
            "date": "2022-01-30T22:43:08Z",
            "author_login": "skratchdot"
          },
          {
            "sha": "757d994894daf5b7b23a0b903a4185706858cefa",
            "date": "2022-01-30T22:38:19Z",
            "author_login": "skratchdot"
          },
          {
            "sha": "2d67a714159c4099589b6661fa84e6d2adc31761",
            "date": "2022-01-30T22:35:21Z",
            "author_login": "skratchdot"
          },
          {
            "sha": "577f5299fed15bb9edd11c940ff3cf0b9f4748d5",
            "date": "2020-07-25T22:31:39Z",
            "author_login": "skratchdot"
          },
          {
            "sha": "a9901861d691d2840873f73408b28a9d48da8044",
            "date": "2020-07-25T22:28:59Z",
            "author_login": "skratchdot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1321",
    "description": "The package object-path-set before 1.0.2 are vulnerable to Prototype Pollution via the setPath method, as it allows an attacker to merge object prototypes into it. *Note:* This vulnerability derives from an incomplete fix in https://security.snyk.io/vuln/SNYK-JS-OBJECTPATHSET-607908",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-04T20:15:08.467",
    "last_modified": "2024-11-21T05:51:48.497",
    "fix_date": "2022-01-30T22:35:21Z"
  },
  "references": [
    {
      "url": "https://github.com/skratchdot/object-path-set/blob/577f5299fed15bb9edd11c940ff3cf0b9f4748d5/index.js%23L8",
      "source": "report@snyk.io",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/skratchdot/object-path-set/commit/2d67a714159c4099589b6661fa84e6d2adc31761",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/blog/remediate-javascript-type-confusion-bypassed-input-validation/",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-OBJECTPATHSET-2388576",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/skratchdot/object-path-set/blob/577f5299fed15bb9edd11c940ff3cf0b9f4748d5/index.js%23L8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/skratchdot/object-path-set/commit/2d67a714159c4099589b6661fa84e6d2adc31761",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/blog/remediate-javascript-type-confusion-bypassed-input-validation/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JS-OBJECTPATHSET-2388576",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.135481",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "object-path-set",
    "owner": "skratchdot",
    "created_at": "2014-09-15T21:20:52Z",
    "updated_at": "2023-03-07T04:03:58Z",
    "pushed_at": "2023-03-04T02:34:42Z",
    "size": 1488,
    "stars": 5,
    "forks": 1,
    "open_issues": 11,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 7408
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T23:06:19.330555"
  }
}