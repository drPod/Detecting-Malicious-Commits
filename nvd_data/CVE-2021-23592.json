{
  "cve_id": "CVE-2021-23592",
  "github_data": {
    "repository": "top-think/framework",
    "fix_commit": "d3b5aeae94bc71bae97977d05cd12c3e0550905c",
    "related_commits": [
      "d3b5aeae94bc71bae97977d05cd12c3e0550905c",
      "d3b5aeae94bc71bae97977d05cd12c3e0550905c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "d3b5aeae94bc71bae97977d05cd12c3e0550905c",
      "commit_date": "2022-01-07T04:09:13Z",
      "author": {
        "login": "liu21st",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "\u6539\u8fdb\u7f13\u5b58\u9a71\u52a8unserialize\u65b9\u6cd5\u53c2\u6570\u7c7b\u578b\u9650\u5236",
        "length": 25,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/think/cache/Driver.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -249,7 +249,7 @@ protected function serialize($data): string\n      * @param string $data \u7f13\u5b58\u6570\u636e\n      * @return mixed\n      */\n-    protected function unserialize(string $data)\n+    protected function unserialize($data)\n     {\n         if (is_numeric($data)) {\n             return $data;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "150a715122bf2170a409f459991a7dd80ba08f1f",
            "date": "2025-01-16T06:14:16Z",
            "author_login": "liu21st"
          },
          {
            "sha": "934e61424c8a2d7919318d27743ff7fced411630",
            "date": "2025-01-16T06:13:43Z",
            "author_login": "liu21st"
          },
          {
            "sha": "1cf105d7767a320d6bf7b233bd27ed3293ea19bb",
            "date": "2025-01-16T03:55:22Z",
            "author_login": "big-dream"
          },
          {
            "sha": "93236bcb5c7f99b82e49678f1f22e209322689c7",
            "date": "2025-01-16T03:23:10Z",
            "author_login": "big-dream"
          },
          {
            "sha": "8faec5c9b7a7f2a66ca3140a57e81bd6cd37567c",
            "date": "2025-01-14T08:04:03Z",
            "author_login": "liu21st"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L",
    "cwe_id": "CWE-502",
    "description": "The package topthink/framework before 6.0.12 are vulnerable to Deserialization of Untrusted Data due to insecure unserialize method in the Driver class.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-05-06T20:15:07.807",
    "last_modified": "2024-11-21T05:51:50.490",
    "fix_date": "2022-01-07T04:09:13Z"
  },
  "references": [
    {
      "url": "https://github.com/top-think/framework/commit/d3b5aeae94bc71bae97977d05cd12c3e0550905c",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/top-think/framework/releases/tag/v6.0.12",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-PHP-TOPTHINKFRAMEWORK-2385695",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/top-think/framework/commit/d3b5aeae94bc71bae97977d05cd12c3e0550905c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/top-think/framework/releases/tag/v6.0.12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-PHP-TOPTHINKFRAMEWORK-2385695",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.090550",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "framework",
    "owner": "top-think",
    "created_at": "2015-12-24T07:12:35Z",
    "updated_at": "2025-01-25T12:49:22Z",
    "pushed_at": "2025-01-16T06:14:17Z",
    "size": 19061,
    "stars": 2738,
    "forks": 1051,
    "open_issues": 113,
    "watchers": 2738,
    "has_security_policy": false,
    "default_branch": "8.x",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 725786,
      "Smarty": 17443
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:41:15.650981"
  }
}