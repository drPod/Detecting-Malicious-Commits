{
  "cve_id": "CVE-2021-23758",
  "github_data": {
    "repository": "michaelschwarz/Ajax.NET-Professional",
    "fix_commit": "b0e63be5f0bb20dfce507cb8a1a9568f6e73de57",
    "related_commits": [
      "b0e63be5f0bb20dfce507cb8a1a9568f6e73de57",
      "b0e63be5f0bb20dfce507cb8a1a9568f6e73de57"
    ],
    "patch_url": "https://github.com/michaelschwarz/Ajax.NET-Professional/commit/b0e63be5f0bb20dfce507cb8a1a9568f6e73de57.patch",
    "fix_commit_details": {
      "sha": "b0e63be5f0bb20dfce507cb8a1a9568f6e73de57",
      "commit_date": "2021-10-27T19:17:11Z",
      "author": {
        "login": "michaelschwarz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "added allowed customized types",
        "length": 30,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4717,
        "additions": 94,
        "deletions": 4623
      },
      "files": [
        {
          "filename": ".gitignore",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -6,3 +6,4 @@\n /AjaxPro/.vs/AjaxPro\n /AjaxPro/bin\n /AjaxPro/obj\n+/DemoWebSite"
        },
        {
          "filename": "AjaxPro/AjaxPro.csproj",
          "status": "modified",
          "additions": 1,
          "deletions": 12,
          "patch": "@@ -11,7 +11,7 @@\n     </ApplicationIcon>\r\n     <AssemblyKeyContainerName>\r\n     </AssemblyKeyContainerName>\r\n-    <AssemblyName>AjaxPro</AssemblyName>\r\n+    <AssemblyName>AjaxPro.2</AssemblyName>\r\n     <AssemblyOriginatorKeyFile>\r\n     </AssemblyOriginatorKeyFile>\r\n     <DefaultClientScript>JScript</DefaultClientScript>\r\n@@ -249,10 +249,6 @@\n     <Compile Include=\"Security\\EncryptTransformer.cs\" />\r\n     <Compile Include=\"Security\\WebDecrypter.cs\" />\r\n     <Compile Include=\"Security\\WebEncrypter.cs\" />\r\n-    <Compile Include=\"Services\\AuthenticationService.cs\" />\r\n-    <Compile Include=\"Services\\CartService.cs\" />\r\n-    <Compile Include=\"Services\\ChatService.cs\" />\r\n-    <Compile Include=\"Services\\ProfileService.cs\" />\r\n     <Compile Include=\"Utilities\\AjaxSettings.cs\">\r\n       <SubType>Code</SubType>\r\n     </Compile>\r\n@@ -277,18 +273,11 @@\n     <EmbeddedResource Include=\"core.js\" />\r\n   </ItemGroup>\r\n   <ItemGroup>\r\n-    <None Include=\"build_1.1.bat\" />\r\n-    <None Include=\"build_2.0.bat\" />\r\n     <None Include=\"web.config\" />\r\n   </ItemGroup>\r\n   <ItemGroup>\r\n-    <None Include=\"build.bat\" />\r\n-    <None Include=\"build_json.bat\" />\r\n     <EmbeddedResource Include=\"ms.js\" />\r\n   </ItemGroup>\r\n-  <ItemGroup>\r\n-    <Content Include=\"jquery-1.3.1.js\" />\r\n-  </ItemGroup>\r\n   <Import Project=\"$(MSBuildBinPath)\\Microsoft.CSharp.targets\" />\r\n   <PropertyGroup>\r\n     <PreBuildEvent>\r"
        },
        {
          "filename": "AjaxPro/AjaxPro.sln",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,7 +1,7 @@\n \ufeff\n Microsoft Visual Studio Solution File, Format Version 12.00\n-# Visual Studio 15\n-VisualStudioVersion = 15.0.28307.1705\n+# Visual Studio Version 16\n+VisualStudioVersion = 16.0.31729.503\n MinimumVisualStudioVersion = 10.0.40219.1\n Project(\"{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}\") = \"AjaxPro\", \"AjaxPro.csproj\", \"{9AD42568-07A4-4D8B-9C6D-1FD54683EF4B}\"\n EndProject"
        },
        {
          "filename": "AjaxPro/Configuration/AjaxSettingsSectionHandler.cs",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -34,6 +34,7 @@\n  * MS\t07-04-24\tadded new settings (oldStyle == configuration)\r\n  *\t\t\t\t\tadded provider settings\r\n  *\t\t\t\t\tadded includeTypeProperty\r\n+ * MS\t21-10-27\tadded allowed customized types for JSON deserialization\r\n  * \r\n  * \r\n  */\r\n@@ -154,6 +155,24 @@ public object Create(object parent, object configContext, System.Xml.XmlNode sec\n \t\t\t\t\tif (n.SelectSingleNode(\"@enabled\") != null && n.SelectSingleNode(\"@enabled\").InnerText == \"true\")\r\n \t\t\t\t\t\tsettings.DebugEnabled = true;\r\n \t\t\t\t}\r\n+\t\t\t\telse if (n.Name == \"jsonDeserializationCustomTypes\")\r\n+\t\t\t\t{\r\n+\t\t\t\t\tsettings.IsJsonDeserializationCustomTypesDenied = n.Attributes[\"default\"] == null || n.Attributes[\"default\"].InnerText.ToLower() != \"allow\";\r\n+\r\n+\t\t\t\t\tforeach (XmlNode sn in n.ChildNodes)\r\n+\t\t\t\t\t{\r\n+\t\t\t\t\t\tswitch (sn.Name)\r\n+\t\t\t\t\t\t{\r\n+\t\t\t\t\t\t\tcase \"allow\":\r\n+\t\t\t\t\t\t\t\tsettings.JsonDeserializationCustomTypesAllowed.Add(sn.InnerText);\r\n+\t\t\t\t\t\t\t\tbreak;\r\n+\r\n+\t\t\t\t\t\t\tcase \"deny\":\r\n+\t\t\t\t\t\t\t\tsettings.JsonDeserializationCustomTypesDenied.Add(sn.InnerText);\r\n+\t\t\t\t\t\t\t\tbreak;\r\n+\t\t\t\t\t\t}\r\n+\t\t\t\t\t}\r\n+\t\t\t\t}\r\n \t\t\t\telse if (n.Name == \"oldStyle\" || n.Name == \"configuration\")\r\n \t\t\t\t{\r\n \t\t\t\t\tforeach (XmlNode sn in n.ChildNodes)\r"
        },
        {
          "filename": "AjaxPro/Handler/AjaxProcHelper.cs",
          "status": "modified",
          "additions": 29,
          "deletions": 20,
          "patch": "@@ -36,14 +36,17 @@\n  * MS\t06-06-11\tremoved WebEvent because of SecurityPermissions not available in medium trust environments\r\n  * MS\t06-10-04\tset UTF-8 encoding for XML documents\r\n  * MS\t07-04-24\tfixed Ajax token\r\n+ * MS\t21-10-27\tadded allowed customized types for JSON deserialization\r\n+ * \r\n  * \r\n  */\r\n using System;\r\n using System.Reflection;\r\n using System.Web;\r\n using System.Web.Caching;\r\n using System.IO;\r\n-#if(NET20)\r\n+using System.Collections.Generic;\r\n+#if (NET20)\r\n using System.Web.Management;\r\n using System.Diagnostics;\r\n #endif\r\n@@ -115,25 +118,6 @@ internal void Run()\n \t\t\t\tobject[] po = null;\r\n \t\t\t\tobject res = null;\r\n \r\n-\t\t\t\t#region Retreive Parameters from the HTTP Request\r\n-\r\n-\t\t\t\ttry\r\n-\t\t\t\t{\r\n-\t\t\t\t\t// The IAjaxProcessor will read the values either form the \r\n-\t\t\t\t\t// request URL or the request input stream.\r\n-\r\n-\t\t\t\t\tpo = p.RetreiveParameters();\r\n-\t\t\t\t}\r\n-\t\t\t\tcatch(Exception ex)\r\n-\t\t\t\t{\r\n-\t\t\t\t\tp.SerializeObject(ex);\r\n-\r\n-\t\t\t\t\tif(p.Context.Trace.IsEnabled) p.Context.Trace.Write(Constant.AjaxID, \"End ProcessRequest\");\r\n-\t\t\t\t\treturn;\r\n-\t\t\t\t}\r\n-\r\n-\t\t\t\t#endregion \r\n-\r\n \t\t\t\t// Check if we have the same request already in our cache. The \r\n \t\t\t\t// cacheKey will be the type and a hashcode from the parameter values.\r\n \r\n@@ -151,6 +135,23 @@ internal void Run()\n \t\t\t\t\treturn;\r\n \t\t\t\t}\r\n \r\n+\t\t\t\t#region Retreive Parameters from the HTTP Request\r\n+\r\n+\t\t\t\ttry\r\n+\t\t\t\t{\r\n+\t\t\t\t\t// The IAjaxProcessor will read the values either form the \r\n+\t\t\t\t\t// request URL or the request input stream.\r\n+\r\n+\t\t\t\t\tpo = p.RetreiveParameters();\r\n+\t\t\t\t}\r\n+\t\t\t\tcatch (Exception ex)\r\n+\t\t\t\t{\r\n+\t\t\t\t\tReturnException(ex);\r\n+\t\t\t\t\treturn;\r\n+\t\t\t\t}\r\n+\r\n+\t\t\t\t#endregion\r\n+\r\n \t\t\t\t#region Reflection part of Ajax.NET\r\n \r\n \t\t\t\ttry\r\n@@ -326,5 +327,13 @@ internal void Run()\n \t\t\t\t\twinctx.Undo();\r\n \t\t\t}\r\n \t\t}\r\n+\r\n+\t\tprivate void ReturnException(Exception ex)\r\n+\t\t{\r\n+\t\t\tp.SerializeObject(ex);\r\n+\r\n+\t\t\tif (p.Context.Trace.IsEnabled) p.Context.Trace.Write(Constant.AjaxID, \"End ProcessRequest\");\r\n+\t\t\treturn;\r\n+\t\t}\r\n \t}\r\n }\r"
        },
        {
          "filename": "AjaxPro/JSON/JavaScriptDeserializer.cs",
          "status": "modified",
          "additions": 22,
          "deletions": 4,
          "patch": "@@ -36,6 +36,7 @@\n  * MS\t06-05-30\tchanged to new converter usage\r\n  * MS\t06-07-11\tadded generic method for DeserializeFromJson\r\n  * MS\t06-09-26\timproved performance removing three-times cast\r\n+ * MS\t21-10-27\tadded allowed customized types for JSON deserialization\r\n  * \r\n  * \r\n  */\r\n@@ -212,11 +213,28 @@ public static object Deserialize(IJavaScriptObject o, Type type)\n         /// <returns></returns>\r\n \t\tinternal static object DeserializeCustomObject(JavaScriptObject o, Type type)\r\n \t\t{\r\n-\t\t\tobject c = Activator.CreateInstance(type);\r\n+\t\t\tif (AjaxPro.Utility.Settings.IsJsonDeserializationCustomTypesDenied)\r\n+\t\t\t{\r\n+\t\t\t\tbool isCustomTypeAllowed = false;\r\n+\r\n+\t\t\t\tforeach (var s in AjaxPro.Utility.Settings.JsonDeserializationCustomTypesAllowed)\r\n+\t\t\t\t\tif (type.FullName.StartsWith(s, StringComparison.InvariantCultureIgnoreCase))\r\n+\t\t\t\t\t{\r\n+\t\t\t\t\t\tisCustomTypeAllowed = true;\r\n+\t\t\t\t\t\tbreak;\r\n+\t\t\t\t\t}\r\n \r\n-\t\t\t// TODO: is this a security problem?\r\n-\t\t\t// if(o.GetType().GetCustomAttributes(typeof(AjaxClassAttribute), true).Length == 0)\r\n-\t\t\t//\tthrow new System.Security.SecurityException(\"Could not create class '\" + type.FullName + \"' because of missing AjaxClass attribute.\");\r\n+\t\t\t\tif (!isCustomTypeAllowed)\r\n+\t\t\t\t\tthrow new System.Security.SecurityException(\"This cusomized type is not allowed as argument for this method.\");\r\n+\t\t\t}\r\n+\t\t\telse\r\n+\t\t\t{\r\n+\t\t\t\tforeach (var s in AjaxPro.Utility.Settings.JsonDeserializationCustomTypesDenied)\r\n+\t\t\t\t\tif (type.FullName.StartsWith(s, StringComparison.InvariantCultureIgnoreCase))\r\n+\t\t\t\t\t\tthrow new System.Security.SecurityException(\"This cusomized type is not allowed as argument for this method.\");\r\n+\t\t\t}\r\n+\r\n+\t\t\tobject c = Activator.CreateInstance(type);\r\n \r\n \t\t\tMemberInfo[] members = type.GetMembers(BindingFlags.GetField | BindingFlags.GetProperty | BindingFlags.Public | BindingFlags.Instance);\r\n \t\t\tforeach (MemberInfo memberInfo in members)\r"
        },
        {
          "filename": "AjaxPro/Services/AuthenticationService.cs",
          "status": "removed",
          "additions": 0,
          "deletions": 89,
          "patch": "@@ -1,89 +0,0 @@\n-/*\r\n- * AuthenticationService.cs\r\n- * \r\n- * Copyright \ufffd 2007 Michael Schwarz (http://www.ajaxpro.info).\r\n- * All Rights Reserved.\r\n- * \r\n- * Permission is hereby granted, free of charge, to any person \r\n- * obtaining a copy of this software and associated documentation \r\n- * files (the \"Software\"), to deal in the Software without \r\n- * restriction, including without limitation the rights to use, \r\n- * copy, modify, merge, publish, distribute, sublicense, and/or \r\n- * sell copies of the Software, and to permit persons to whom the \r\n- * Software is furnished to do so, subject to the following conditions:\r\n- *\r\n- * The above copyright notice and this permission notice shall be \r\n- * included in all copies or substantial portions of the Software.\r\n- *\r\n- * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, \r\n- * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES \r\n- * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n- * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR \r\n- * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF \r\n- * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN \r\n- * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n- */\r\n-/*\r\n- * MS\t05-12-20\tinitial version\r\n- * MS\t06-04-16\tchanged methods to static\r\n- * \r\n- * \r\n- * \r\n- * \r\n- */\r\n-using System;\r\n-using System.Web.Security;\r\n-\r\n-namespace AjaxPro.Services\r\n-{\r\n-\t[AjaxNamespace(\"AjaxPro.Services.Authentication\")]\r\n-\tpublic class AuthenticationService\r\n-\t{\r\n-        /// <summary>\r\n-        /// Logins the specified username.\r\n-        /// </summary>\r\n-        /// <param name=\"username\">The username.</param>\r\n-        /// <param name=\"password\">The password.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic static bool Login(string username, string password)\r\n-\t\t{\r\n-#if(NET20)\r\n-\t\t\tif(Membership.Provider.ValidateUser(username, password))\r\n-#else\r\n-\t\t\tif(FormsAuthentication.Authenticate(username, password))\r\n-#endif\r\n-\t\t\t{\r\n-\t\t\t\tFormsAuthentication.SetAuthCookie(username, false);\r\n-\t\t\t\treturn true;\r\n-\t\t\t}\r\n-\r\n-\t\t\treturn false;\r\n-\t\t}\r\n-\r\n-        /// <summary>\r\n-        /// Logouts this instance.\r\n-        /// </summary>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic static void Logout()\r\n-\t\t{\r\n-\t\t\tFormsAuthentication.SignOut();\r\n-\t\t}\r\n-\r\n-        /// <summary>\r\n-        /// Validates the user.\r\n-        /// </summary>\r\n-        /// <param name=\"username\">The username.</param>\r\n-        /// <param name=\"password\">The password.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic static bool ValidateUser(string username, string password)\r\n-\t\t{\r\n-#if(NET20)\r\n-\t\t\treturn Membership.Provider.ValidateUser(username, password);\r\n-#else\r\n-\t\t\tthrow new NotImplementedException(\"ValidateUser is not yet implemented.\");\r\n-#endif\r\n-\t\t}\r\n-\t}\r\n-}\r"
        },
        {
          "filename": "AjaxPro/Services/CartService.cs",
          "status": "removed",
          "additions": 0,
          "deletions": 61,
          "patch": "@@ -1,61 +0,0 @@\n-/*\r\n- * CartService.cs\r\n- * \r\n- * Copyright \ufffd 2007 Michael Schwarz (http://www.ajaxpro.info).\r\n- * All Rights Reserved.\r\n- * \r\n- * Permission is hereby granted, free of charge, to any person \r\n- * obtaining a copy of this software and associated documentation \r\n- * files (the \"Software\"), to deal in the Software without \r\n- * restriction, including without limitation the rights to use, \r\n- * copy, modify, merge, publish, distribute, sublicense, and/or \r\n- * sell copies of the Software, and to permit persons to whom the \r\n- * Software is furnished to do so, subject to the following conditions:\r\n- *\r\n- * The above copyright notice and this permission notice shall be \r\n- * included in all copies or substantial portions of the Software.\r\n- *\r\n- * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, \r\n- * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES \r\n- * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n- * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR \r\n- * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF \r\n- * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN \r\n- * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n- */\r\n-#if(NET20)\r\n-/*\r\n- * MS\t06-04-16\tinitial version\r\n- * \r\n- * \r\n- * \r\n- * \r\n- * \r\n- */\r\n-using System;\r\n-using System.Text;\r\n-\r\n-namespace AjaxPro.Services\r\n-{\r\n-\t[AjaxNamespace(\"AjaxPro.Services.Cart\")]\r\n-\tpublic abstract class ICartService\r\n-\t{\r\n-        /// <summary>\r\n-        /// Adds the item.\r\n-        /// </summary>\r\n-        /// <param name=\"cartName\">Name of the cart.</param>\r\n-        /// <param name=\"item\">The item.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic abstract bool AddItem(string cartName, object item);\r\n-\r\n-        /// <summary>\r\n-        /// Gets the items.\r\n-        /// </summary>\r\n-        /// <param name=\"cartName\">Name of the cart.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic abstract object[] GetItems(string cartName);\r\n-\t}\r\n-}\r\n-#endif\n\\ No newline at end of file"
        },
        {
          "filename": "AjaxPro/Services/ChatService.cs",
          "status": "removed",
          "additions": 0,
          "deletions": 71,
          "patch": "@@ -1,71 +0,0 @@\n-/*\r\n- * ChatService.cs\r\n- * \r\n- * Copyright \ufffd 2007 Michael Schwarz (http://www.ajaxpro.info).\r\n- * All Rights Reserved.\r\n- * \r\n- * Permission is hereby granted, free of charge, to any person \r\n- * obtaining a copy of this software and associated documentation \r\n- * files (the \"Software\"), to deal in the Software without \r\n- * restriction, including without limitation the rights to use, \r\n- * copy, modify, merge, publish, distribute, sublicense, and/or \r\n- * sell copies of the Software, and to permit persons to whom the \r\n- * Software is furnished to do so, subject to the following conditions:\r\n- *\r\n- * The above copyright notice and this permission notice shall be \r\n- * included in all copies or substantial portions of the Software.\r\n- *\r\n- * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, \r\n- * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES \r\n- * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n- * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR \r\n- * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF \r\n- * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN \r\n- * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n- */\r\n-#if(NET20)\r\n-/*\r\n- * MS\t06-04-16\tinitial version\r\n- * \r\n- * \r\n- * \r\n- * \r\n- * \r\n- */\r\n-using System;\r\n-using System.Text;\r\n-\r\n-namespace AjaxPro.Services\r\n-{\r\n-\t[AjaxNamespace(\"AjaxPro.Services.Chat\")]\r\n-\tpublic abstract class IChatService\r\n-\t{\r\n-        /// <summary>\r\n-        /// Sends the message.\r\n-        /// </summary>\r\n-        /// <param name=\"room\">The room.</param>\r\n-        /// <param name=\"message\">The message.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic abstract bool SendMessage(string room, string message);\r\n-\r\n-        /// <summary>\r\n-        /// Retrieves the new.\r\n-        /// </summary>\r\n-        /// <param name=\"room\">The room.</param>\r\n-        /// <param name=\"lastRetreived\">The last retreived.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic abstract object[] RetrieveNew(string room, DateTime lastRetreived);\r\n-\r\n-        /// <summary>\r\n-        /// Retrieves the last.\r\n-        /// </summary>\r\n-        /// <param name=\"room\">The room.</param>\r\n-        /// <param name=\"count\">The count.</param>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic abstract object[] RetrieveLast(string room, int count);\r\n-\t}\r\n-}\r\n-#endif\n\\ No newline at end of file"
        },
        {
          "filename": "AjaxPro/Services/ProfileService.cs",
          "status": "removed",
          "additions": 0,
          "deletions": 91,
          "patch": "@@ -1,91 +0,0 @@\n-/*\r\n- * ProfileService.cs\r\n- * \r\n- * Copyright \ufffd 2007 Michael Schwarz (http://www.ajaxpro.info).\r\n- * All Rights Reserved.\r\n- * \r\n- * Permission is hereby granted, free of charge, to any person \r\n- * obtaining a copy of this software and associated documentation \r\n- * files (the \"Software\"), to deal in the Software without \r\n- * restriction, including without limitation the rights to use, \r\n- * copy, modify, merge, publish, distribute, sublicense, and/or \r\n- * sell copies of the Software, and to permit persons to whom the \r\n- * Software is furnished to do so, subject to the following conditions:\r\n- *\r\n- * The above copyright notice and this permission notice shall be \r\n- * included in all copies or substantial portions of the Software.\r\n- *\r\n- * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, \r\n- * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES \r\n- * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n- * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR \r\n- * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF \r\n- * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN \r\n- * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n- */\r\n-#if(NET20)\r\n-/*\r\n- * MS\t05-12-20\tinitial version\r\n- * MS\t06-04-16\tchanged methods to static\r\n- * MS\t06-04-25\tchanged GetProfile, added ProfileBaseConverter\r\n- * \r\n- * \r\n- * \r\n- */\r\n-using System;\r\n-using System.Data;\r\n-using System.Collections;\r\n-using System.Configuration;\r\n-using System.Web;\r\n-using System.Web.Profile;\r\n-\r\n-namespace AjaxPro.Services\r\n-{\r\n-\t[AjaxNamespace(\"AjaxPro.Services.Profile\")]\r\n-\tpublic class ProfileService\r\n-\t{\r\n-        /// <summary>\r\n-        /// Gets the profile.\r\n-        /// </summary>\r\n-        /// <returns></returns>\r\n-\t\t[AjaxMethod]\r\n-\t\tpublic static ProfileBase GetProfile()\r\n-\t\t{\r\n-\t\t\treturn HttpContext.Current.Profile;\r\n-\t\t}\r\n-\r\n-        /// <summary>\r\n-        /// Gets the profile property.\r\n-        /// </summary>\r\n-        /// <param name=\"property\">The property.</param>\r\n-        /// <returns></returns>\r\n-        [AjaxMethod]\r\n-        public static object GetProfileProperty(string property)\r\n-        {\r\n-            ProfileBase profile = HttpContext.Current.Profile;\r\n-            if (profile == null)\r\n-            {\r\n-                return null;\r\n-            }\r\n-            return profile[property];\r\n-        }\r\n-\r\n-        /// <summary>\r\n-        /// Sets the profile.\r\n-        /// </summary>\r\n-        /// <param name=\"o\">The o.</param>\r\n-        /// <returns></returns>\r\n-        [AjaxMethod]\r\n-        public static bool SetProfile(JavaScriptObject o)\r\n-        {\r\n-            ProfileBase profile = HttpContext.Current.Profile;\r\n-            foreach (string key in o.Keys)\r\n-            {\r\n-\t\t\t\tprofile[key] = JavaScriptDeserializer.Deserialize((IJavaScriptObject)o[key], profile[key].GetType());\r\n-            }\r\n-\r\n-\t\t\treturn true;\r\n-        }\r\n-\t}\r\n-}\r\n-#endif\n\\ No newline at end of file"
        },
        {
          "filename": "AjaxPro/Utilities/AjaxSettings.cs",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -34,7 +34,7 @@\n  *\t\t\t\t\tadded UseSimpleObjectNaming\r\n  *\t\t\t\t\tusing new AjaxSecurityProvider\r\n  *\t\t\t\t\tfixed Ajax token\r\n- * \r\n+ * MS\t21-10-27\tadded allowed customized types for JSON deserialization\r\n  */\r\n using System;\r\n using System.Collections;\r\n@@ -127,6 +127,9 @@ internal AjaxSettings()\n \t\t\tSerializableConverters = new JavaScriptConverterList();\r\n \t\t\tDeserializableConverters = new JavaScriptConverterList();\r\n #endif\r\n+\r\n+\t\t\tJsonDeserializationCustomTypesAllowed = new List<string>();\r\n+\t\t\tJsonDeserializationCustomTypesDenied = new List<string>();\r\n \t\t}\r\n \r\n \t\t#region Public Properties\r\n@@ -244,6 +247,11 @@ internal System.Collections.Specialized.StringDictionary ScriptReplacements\n \t\t\tset{ m_ScriptReplacements = value; }\r\n \t\t}\r\n \r\n+\t\tpublic bool IsJsonDeserializationCustomTypesDenied { get; set; }\r\n+\r\n+\t\tpublic List<string> JsonDeserializationCustomTypesAllowed { get; set; }\r\n+\t\tpublic List<string> JsonDeserializationCustomTypesDenied { get; set; }\r\n+\r\n \t\t#endregion\r\n \t}\r\n #endif\r"
        },
        {
          "filename": "AjaxPro/Utilities/Constant.cs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -52,6 +52,6 @@ public sealed class Constant\n         /// <summary>\r\n \t\t/// The assembly version.\r\n \t\t/// </summary>\r\n-        public const string AssemblyVersion = \"21.10.26.1\";\r\n+        public const string AssemblyVersion = \"21.10.27.1\";\r\n \t}\r\n }\r"
        },
        {
          "filename": "AjaxPro/core.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -169,7 +169,7 @@ Object.extend(AjaxPro, {\n \tcryptProvider: null,\r\n \tqueue: null,\r\n \ttoken: \"\",\r\n-\tversion: \"9.2.17.1\",\r\n+\tversion: \"21.10.27.1\",\r\n \tID: \"AjaxPro\",\r\n \tnoActiveX: false,\r\n \ttimeoutPeriod: 15*1000,\r"
        },
        {
          "filename": "AjaxPro/jquery-1.3.1.js",
          "status": "removed",
          "additions": 0,
          "deletions": 4241,
          "patch": null
        },
        {
          "filename": "AjaxPro/web.config",
          "status": "modified",
          "additions": 9,
          "deletions": 29,
          "patch": "@@ -1,9 +1,7 @@\n <?xml version=\"1.0\"?>\r\n <configuration>\r\n-\t\r\n \t<configSections>\r\n \t\t<sectionGroup name=\"ajaxNet\">\r\n-\r\n \t\t\t<!--\r\n \t\t\t\tIf you are using Microsoft .NET 1.1 please remove the two attributes\r\n \t\t\t\trequirePermission and restartOnExternalChanges, they are only supported\r\n@@ -14,13 +12,10 @@\n \t\t\t\trequirePermission=\"false\"\r\n \t\t\t\trestartOnExternalChanges=\"true\"\r\n \t\t\t/>\r\n-\t\t\t\r\n \t\t</sectionGroup>\r\n \t</configSections>\r\n-\r\n \t<ajaxNet>\r\n \t\t<ajaxSettings>\r\n-\r\n \t\t\t<urlNamespaceMappings useAssemblyQualifiedName=\"false\" allowListOnly=\"false\">\r\n \t\t\t\t<!--\r\n \t\t\t\t\tSet the attribute useAssemblyQualifiedName to true to enable\r\n@@ -33,8 +28,7 @@\n \t\t\t\t\t<add type=\"Namespace.Class1,Assembly\" path=\"mypath\" />\r\n \t\t\t\t-->\r\n \t\t\t</urlNamespaceMappings>\r\n-\r\n-\t\t\t<jsonConverters includeTypeProperty=\"true\">\r\n+\t\t\t<jsonConverters includeTypeProperty=\"false\">\r\n \t\t\t\t<!--\r\n \t\t\t\t\tThis section can be used to add new IJavaScriptConverters to the\r\n \t\t\t\t\tAjax.NET Professional engine. If you want to disable built-in\r\n@@ -46,13 +40,14 @@\n \t\t\t\t\t<add type=\"AjaxPro.BitmapConverter,AjaxPro.2\" mimeType=\"image/jpeg\" quality=\"100\"/>\r\n \t\t\t\t-->\r\n \t\t\t</jsonConverters>\r\n-\r\n+\t\t\t<jsonDeserializationCustomTypes default=\"deny\">\r\n+\t\t\t\t<allow>MyOwnNamespace.</allow>\r\n+\t\t\t</jsonDeserializationCustomTypes>\r\n \t\t\t<!--\r\n \t\t\t\tSet the enabled attribute to true to get Stack, TargetSize and Source \r\n \t\t\t\tinformation if an exception has been thrown.\r\n \t\t\t-->\r\n \t\t\t<debug enabled=\"false\" />\r\n-\r\n \t\t\t<!--\r\n \t\t\t\tThis is the default configuration used with Ajax.NET Professional. You\r\n \t\t\t\tcan put there your static JavaScript files, or remove the path attribute\r\n@@ -64,16 +59,13 @@\n \t\t\t\t\t<file name=\"converter\" path=\"~/ajaxpro/converter.ashx\" />\r\n \t\t\t\t</scriptReplacements>\r\n \t\t\t-->\r\n-\t\t\t\r\n \t\t\t<!-- <encryption cryptType=\"\" keyType=\"\" /> -->\r\n-\t\t\t\r\n \t\t\t<!--\r\n \t\t\t\tSet the enabled attribute to true to enable the use of an Ajax.NET Professional\r\n \t\t\t\ttoken. This will send a token to the client that will be used to identify if the\r\n \t\t\t\trequests comes from the same PC.\r\n \t\t\t-->\r\n \t\t\t<token enabled=\"false\" sitePassword=\"password\" />\r\n-\r\n \t\t\t<!--\r\n \t\t\t\tThe oldStyle (or now configuration) section can be used to enable old styled JavaScript code or\r\n \t\t\t\tfunctions that are not used any more. Some of them cannot be used together.\r\n@@ -91,12 +83,9 @@\n \t\t\t\t\t<useSimpleObjectNaming/>\r\n \t\t\t\t</configuration>\r\n \t\t\t-->\r\n-\t\t\t\r\n \t\t</ajaxSettings>\r\n \t</ajaxNet>\r\n-\r\n \t<!-- Common ASP.NET configuration -->\r\n-\r\n \t<appSettings/>\r\n \t<connectionStrings/>\r\n \t<system.web>\r\n@@ -110,27 +99,19 @@\n \t\t\t-->\r\n \t\t</httpModules>\r\n \t</system.web>\r\n-\r\n \t<!-- Handler configuration for Ajax.NET Professional -->\r\n-\t\r\n \t<location path=\"ajaxpro\">\r\n \t\t<system.web>\r\n \t\t\t<httpHandlers>\r\n \t\t\t\t<add verb=\"*\" path=\"*.ashx\" type=\"AjaxPro.AjaxHandlerFactory,AjaxPro.2\"/>\r\n \t\t\t</httpHandlers>\r\n-\t\t\t<!--\r\n-\t\t\t\tIf you need to have Ajax.NET Professional methods running on the\r\n-\t\t\t\tlogin page you may have to enable your own authorization configuration\r\n-\t\t\t\there.\r\n-\t\t\t-->\r\n-\t\t\t<!--\r\n-\t\t\t<authorization>\r\n-\t\t\t\t<deny users=\"?\"/>\r\n-\t\t\t</authorization>\r\n-\t\t\t-->\r\n \t\t</system.web>\r\n+\t\t<system.webServer>\r\n+\t\t\t<handlers>\r\n+\t\t\t\t<add name=\"@ajaxpro\" verb=\"*\" path=\"*.ashx\" type=\"AjaxPro.AjaxHandlerFactory,AjaxPro.2\" />\r\n+\t\t\t</handlers>\r\n+\t\t</system.webServer>\r\n \t</location>\r\n-\r\n \t<!--\r\n \tIf you are using the AjaxPro.BitmapConverter you have to use following location\r\n \tconfiguration to get a JPEG of the Bitmap.\r\n@@ -144,5 +125,4 @@\n \t\t</system.web>\r\n \t</location>\r\n \t-->\r\n-\t\r\n </configuration>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 3,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 7,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ea43f63d3ae407d35af69638a9ee7d7a959e562d",
            "date": "2024-10-10T09:33:31Z",
            "author_login": "michaelschwarz"
          },
          {
            "sha": "609cd614f82cad73b160d757256d5a2043bc4983",
            "date": "2024-10-10T07:43:32Z",
            "author_login": "michaelschwarz"
          },
          {
            "sha": "1c66c2d3fb473ae28d38c3205914609b9189c645",
            "date": "2024-10-10T07:30:29Z",
            "author_login": "michaelschwarz"
          },
          {
            "sha": "cfbc40a824434e5965d4432074e3df36e214f5d0",
            "date": "2024-10-10T06:50:51Z",
            "author_login": "michaelschwarz"
          },
          {
            "sha": "8d3b71d27d44638ee4035ed43bee8dce2e84b545",
            "date": "2024-10-10T06:44:29Z",
            "author_login": "michaelschwarz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-502",
    "description": "All versions of package ajaxpro.2 are vulnerable to Deserialization of Untrusted Data due to the possibility of deserialization of arbitrary .NET classes, which can be abused to gain remote code execution.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-12-03T20:15:07.557",
    "last_modified": "2024-11-21T05:51:52.743",
    "fix_date": "2021-10-27T19:17:11Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/175677/AjaxPro-Deserialization-Remote-Code-Execution.html",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://github.com/michaelschwarz/Ajax.NET-Professional/commit/b0e63be5f0bb20dfce507cb8a1a9568f6e73de57",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-DOTNET-AJAXPRO2-1925971",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/175677/AjaxPro-Deserialization-Remote-Code-Execution.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/michaelschwarz/Ajax.NET-Professional/commit/b0e63be5f0bb20dfce507cb8a1a9568f6e73de57",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-DOTNET-AJAXPRO2-1925971",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.818452",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Ajax.NET-Professional",
    "owner": "michaelschwarz",
    "created_at": "2017-05-10T13:01:25Z",
    "updated_at": "2024-10-10T09:33:45Z",
    "pushed_at": "2024-10-10T09:33:41Z",
    "size": 473,
    "stars": 39,
    "forks": 27,
    "open_issues": 0,
    "watchers": 39,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C#": 425805,
      "JavaScript": 18765
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:21:53.165282"
  }
}