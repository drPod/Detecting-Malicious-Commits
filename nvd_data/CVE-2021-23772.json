{
  "cve_id": "CVE-2021-23772",
  "github_data": {
    "repository": "kataras/iris",
    "fix_commit": "e213dba0d32ff66653e0ef124bc5088817264b08",
    "related_commits": [
      "e213dba0d32ff66653e0ef124bc5088817264b08",
      "e213dba0d32ff66653e0ef124bc5088817264b08"
    ],
    "patch_url": "https://github.com/kataras/iris/commit/e213dba0d32ff66653e0ef124bc5088817264b08.patch",
    "fix_commit_details": {
      "sha": "e213dba0d32ff66653e0ef124bc5088817264b08",
      "commit_date": "2021-12-23T20:05:26Z",
      "author": {
        "login": "kataras",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "security fix",
        "length": 12,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 6,
        "deletions": 14
      },
      "files": [
        {
          "filename": "HISTORY.md",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -28,6 +28,8 @@ The codebase for Dependency Injection, Internationalization and localization and\n \r\n ## Fixes and Improvements\r\n \r\n+- Push a security fix reported by [Kirill Efimov](https://github.com/kirill89) for older go runtimes.\r\n+\r\n - New `Configuration.Timeout` and `Configuration.TimeoutMessage` fields. Use it to set HTTP timeouts. Note that your http server's (`Application.ConfigureHost`) Read/Write timeouts should be a bit higher than the `Configuration.Timeout` in order to give some time to http timeout handler to kick in and be able to send the `Configuration.TimeoutMessage` properly.\r\n \r\n - New `apps.OnApplicationRegistered` method which listens on new Iris applications hosted under the same binary. Use it on your `init` functions to configure Iris applications by any spot in your project's files.\r"
        },
        {
          "filename": "context/context.go",
          "status": "modified",
          "additions": 4,
          "deletions": 14,
          "patch": "@@ -2032,13 +2032,7 @@ func (ctx *Context) FormFiles(key string, before ...func(*Context, *multipart.Fi\n \n \t\tinnerLoop:\n \t\t\tfor _, header := range fhs[key] {\n-\t\t\t\t// Fix an issue that net/http has,\n-\t\t\t\t// an attacker can push a filename\n-\t\t\t\t// which could lead to override existing system files\n-\t\t\t\t// by ../../$header.\n-\t\t\t\t// Reported by Frank through security reports.\n-\t\t\t\theader.Filename = strings.ReplaceAll(header.Filename, \"../\", \"\")\n-\t\t\t\theader.Filename = strings.ReplaceAll(header.Filename, \"..\\\\\", \"\")\n+\t\t\t\theader.Filename = filepath.Base(header.Filename)\n \n \t\t\t\tfor _, b := range before {\n \t\t\t\t\tif !b(ctx, header) {\n@@ -2100,13 +2094,9 @@ func (ctx *Context) UploadFormFiles(destDirectory string, before ...func(*Contex\n \t\t\tfor _, files := range fhs {\n \t\t\tinnerLoop:\n \t\t\t\tfor _, file := range files {\n-\t\t\t\t\t// Fix an issue that net/http has,\n-\t\t\t\t\t// an attacker can push a filename\n-\t\t\t\t\t// which could lead to override existing system files\n-\t\t\t\t\t// by ../../$file.\n-\t\t\t\t\t// Reported by Frank through security reports.\n-\t\t\t\t\tfile.Filename = strings.ReplaceAll(file.Filename, \"../\", \"\")\n-\t\t\t\t\tfile.Filename = strings.ReplaceAll(file.Filename, \"..\\\\\", \"\")\n+\t\t\t\t\t// Security fix for go < 1.17.5:\n+\t\t\t\t\t// Reported by Kirill Efimov (snyk.io) through security reports.\n+\t\t\t\t\tfile.Filename = filepath.Base(file.Filename)\n \n \t\t\t\t\tfor _, b := range before {\n \t\t\t\t\t\tif !b(ctx, file) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "52fab1bcc86120f5872715fd6d07e468206fd4bd",
            "date": "2025-01-01T01:40:30Z",
            "author_login": "kataras"
          },
          {
            "sha": "1238e13f4f9c2078e51f7b2e1872aded30666a54",
            "date": "2024-12-28T12:20:51Z",
            "author_login": "kataras"
          },
          {
            "sha": "3bd3117182703d1927630f6da2ac5f63e1e319a6",
            "date": "2024-12-05T00:09:59Z",
            "author_login": "kataras"
          },
          {
            "sha": "986d8a07c6ba757bdaf2e74f2c878f546ecdf21d",
            "date": "2024-11-23T20:01:40Z",
            "author_login": "kataras"
          },
          {
            "sha": "d5e0048d7d32cbfba52ea5be5f10d6f38d7c4311",
            "date": "2024-10-16T10:52:20Z",
            "author_login": "kataras"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-59",
    "description": "This affects all versions of package github.com/kataras/iris; all versions of package github.com/kataras/iris/v12. The unsafe handling of file names during upload using UploadFormFiles method may enable attackers to write to arbitrary locations outside the designated target folder.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-12-24T12:15:07.697",
    "last_modified": "2024-11-21T05:51:53.150",
    "fix_date": "2021-12-23T20:05:26Z"
  },
  "references": [
    {
      "url": "https://github.com/kataras/iris/commit/e213dba0d32ff66653e0ef124bc5088817264b08",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRIS-2325169",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRISV12-2325170",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kataras/iris/commit/e213dba0d32ff66653e0ef124bc5088817264b08",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRIS-2325169",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRISV12-2325170",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.025642",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "iris",
    "owner": "kataras",
    "created_at": "2016-01-30T04:36:48Z",
    "updated_at": "2025-01-14T11:37:16Z",
    "pushed_at": "2025-01-07T04:57:55Z",
    "size": 17573,
    "stars": 25321,
    "forks": 2469,
    "open_issues": 130,
    "watchers": 25321,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 2649466,
      "JavaScript": 98505,
      "HTML": 60408,
      "CSS": 15415,
      "Dockerfile": 2408,
      "Pug": 1236,
      "templ": 87
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T22:21:28.686501"
  }
}