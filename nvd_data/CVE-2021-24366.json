{
  "cve_id": "CVE-2021-24366",
  "github_data": {
    "repository": "codepress/admin-columns",
    "fix_commit": "b45571ed21d574d13687213a5002e0c68e4442c7",
    "related_commits": [
      "b45571ed21d574d13687213a5002e0c68e4442c7",
      "b45571ed21d574d13687213a5002e0c68e4442c7"
    ],
    "patch_url": "https://github.com/codepress/admin-columns/commit/b45571ed21d574d13687213a5002e0c68e4442c7.patch",
    "fix_commit_details": {
      "sha": "b45571ed21d574d13687213a5002e0c68e4442c7",
      "commit_date": "2021-03-26T12:08:45Z",
      "author": {
        "login": "tobiasschutter",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Sanitise label + title",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 56,
        "additions": 55,
        "deletions": 1
      },
      "files": [
        {
          "filename": "classes/Controller/ListScreen/Sanitize/FormData.php",
          "status": "added",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -0,0 +1,22 @@\n+<?php\n+\n+namespace AC\\Controller\\ListScreen\\Sanitize;\n+\n+use AC\\Sanitize;\n+\n+class FormData implements Sanitize {\n+\n+\t/**\n+\t * @param array $data\n+\t *\n+\t * @return array\n+\t */\n+\tpublic function sanitize( $data ) {\n+\t\tif ( isset( $data[ Title::FIELD ] ) ) {\n+\t\t\t$data[ Title::FIELD ] = ( new Title() )->sanitize( $data[ Title::FIELD ] );\n+\t\t}\n+\n+\t\treturn $data;\n+\t}\n+\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "classes/Controller/ListScreen/Sanitize/Title.php",
          "status": "added",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -0,0 +1,15 @@\n+<?php\n+\n+namespace AC\\Controller\\ListScreen\\Sanitize;\n+\n+use AC\\Sanitize;\n+\n+class Title implements Sanitize {\n+\n+\tconst FIELD = 'title';\n+\n+\tpublic function sanitize( $data ) {\n+\t\treturn wp_kses( $data, true );\n+\t}\n+\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "classes/Controller/ListScreen/Save.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -14,8 +14,14 @@ class Save {\n \t */\n \tprivate $storage;\n \n+\t/**\n+\t * @var Sanitize\\FormData\n+\t */\n+\tprivate $sanitizer;\n+\n \tpublic function __construct( Storage $storage ) {\n \t\t$this->storage = $storage;\n+\t\t$this->sanitizer = new Sanitize\\FormData();\n \t}\n \n \tpublic function request( Request $request ) {\n@@ -35,6 +41,8 @@ public function request( Request $request ) {\n \t\t\twp_send_json_error( [ 'message' => 'List screen not found' ] );\n \t\t}\n \n+\t\t$data = $this->sanitizer->sanitize( $data );\n+\n \t\t$list_screen->set_title( ! empty( $data['title'] ) ? $data['title'] : $list_screen->get_label() )\n \t\t            ->set_settings( isset( $data['columns'] ) ? $this->maybe_encode_urls( $data['columns'] ) : [] )\n \t\t            ->set_layout_id( $data['list_screen_id'] )"
        },
        {
          "filename": "classes/Sanitize.php",
          "status": "added",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -0,0 +1,9 @@\n+<?php\n+\n+namespace AC;\n+\n+interface Sanitize {\n+\n+\tpublic function sanitize( $data );\n+\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "classes/Settings/Column/Label.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -59,7 +59,7 @@ public function get_label() {\n \t * @param string $label\n \t */\n \tpublic function set_label( $label ) {\n-\t\t$this->label = $label;\n+\t\t$this->label = apply_filters( 'ac/column/label', wp_kses( $label, true ), $label );;\n \t}\n \n \t/**"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "032401b70adc0ec2ef0b8069cc804ce1ebf750af",
            "date": "2024-04-09T08:55:54Z",
            "author_login": "DGStefan"
          },
          {
            "sha": "ba99010d9e02b603863bc6d9995d4c5609509961",
            "date": "2024-04-08T11:16:08Z",
            "author_login": "DGStefan"
          },
          {
            "sha": "8cd7041af20a3f92d26157bdddfdb8f4e01b6bc0",
            "date": "2024-03-11T12:58:27Z",
            "author_login": "DGStefan"
          },
          {
            "sha": "a4741de11bba6cb73fb6bebaecef38c99788a637",
            "date": "2024-02-06T10:24:06Z",
            "author_login": "DGStefan"
          },
          {
            "sha": "63c634c096153b81126b6355ae3b45d08b108c82",
            "date": "2024-02-06T10:10:31Z",
            "author_login": "DGStefan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": null,
    "description": "The Admin Columns WordPress plugin before 4.3 and Admin Columns Pro WordPress plugin before 5.5.1 do not sanitise and escape its Label settings, which could allow high privilege users such as admin to perform Stored Cross-Site Scripting attacks even when the unfiltered_html capability is disallowed (for example in multisite setup)",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-06-21T20:15:08.490",
    "last_modified": "2024-11-21T05:52:55.500",
    "fix_date": "2021-03-26T12:08:45Z"
  },
  "references": [
    {
      "url": "https://github.com/codepress/admin-columns/commit/b45571ed21d574d13687213a5002e0c68e4442c7",
      "source": "contact@wpscan.com",
      "tags": []
    },
    {
      "url": "https://wpscan.com/vulnerability/05427156-4d5c-4aeb-add8-1c574fda5c28",
      "source": "contact@wpscan.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-24366",
      "source": "contact@wpscan.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/codepress/admin-columns/commit/b45571ed21d574d13687213a5002e0c68e4442c7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://wpscan.com/vulnerability/05427156-4d5c-4aeb-add8-1c574fda5c28",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-24366",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.746705",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "admin-columns",
    "owner": "codepress",
    "created_at": "2013-03-13T11:40:07Z",
    "updated_at": "2025-01-04T02:48:18Z",
    "pushed_at": "2025-01-14T10:13:34Z",
    "size": 28959,
    "stars": 67,
    "forks": 26,
    "open_issues": 6,
    "watchers": 67,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 836467,
      "JavaScript": 254127,
      "TypeScript": 133650,
      "SCSS": 124786,
      "Svelte": 37500,
      "CSS": 1096,
      "Shell": 1033,
      "Nunjucks": 942
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T22:47:11.085378"
  }
}