{
  "cve_id": "CVE-2021-25927",
  "github_data": {
    "repository": "jessie-codes/safe-flat",
    "fix_commit": "4b9b7db976bba8c968354f4315f5f9c219b7cbf3",
    "related_commits": [
      "4b9b7db976bba8c968354f4315f5f9c219b7cbf3",
      "4b9b7db976bba8c968354f4315f5f9c219b7cbf3"
    ],
    "patch_url": "https://github.com/jessie-codes/safe-flat/commit/4b9b7db976bba8c968354f4315f5f9c219b7cbf3.patch",
    "fix_commit_details": {
      "sha": "4b9b7db976bba8c968354f4315f5f9c219b7cbf3",
      "commit_date": "2021-01-24T00:14:38Z",
      "author": {
        "login": "jessie-codes",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(unflat): fix potential for prototype pollution",
        "length": 50,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 14,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/index.js",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -45,13 +45,15 @@ const flatten = (obj, delimiter) => {\n const unflatten = (obj, delimiter) => {\n   const result = {}\n   const seperator = delimiter || defaultDelimiter\n+  const proto = ['__proto__', 'constructor', 'prototype']\n \n   if (typeof obj !== 'object' || isDate(obj)) return obj\n \n   const unflat = (original) => {\n     Object.keys(original).forEach((key) => {\n       const newKeys = key.split(seperator)\n       newKeys.reduce((o, k, i) => {\n+        if (proto.includes(newKeys[i])) return o\n         return o[k] || (o[k] = isNaN(Number(newKeys[i + 1])) ? (newKeys.length - 1 === i ? original[key] : {}) : [])\n       }, result)\n     })"
        },
        {
          "filename": "test/unflatten.spec.js",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -150,3 +150,15 @@ test('it should handle date objects', (t) => {\n \n   t.deepEqual(unflatten(original), expected)\n })\n+\n+test('it should not pollute the prototype', (t) => {\n+  const original = {\n+    '__proto__.polluted': 'Attempt to pollute the prototype',\n+    'a.prototype.polluted': 'Attempt to pollute the prototype',\n+    'a.b': 'This attribute is safe',\n+    'c.constructor.polluted': 'Attempt to pollute the prototype',\n+    'constructor.polluted': 'Attempt to pollute the prototype'\n+  }\n+  unflatten(original)\n+  t.assert({}.polluted == null)\n+})"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "77aee99f9afd59f91afecef631cc735e6d07fe80",
            "date": "2024-09-19T05:42:36Z",
            "author_login": "jessie-codes"
          },
          {
            "sha": "d4d347a21361ba2bf39449b2c6015b1a79c0c0a8",
            "date": "2023-11-30T07:10:59Z",
            "author_login": "jessie-codes"
          },
          {
            "sha": "9cfea44396d5ce1f3fa3c895c84598658898a1b3",
            "date": "2023-11-30T07:06:05Z",
            "author_login": "jessie-codes"
          },
          {
            "sha": "5116bb196f1b2eab816cb01aa0bbc70a1b4d09f4",
            "date": "2023-11-30T07:05:48Z",
            "author_login": "jessie-codes"
          },
          {
            "sha": "46186224042b0f7a0dfb8dac37c7dd568bbab632",
            "date": "2023-11-30T07:04:42Z",
            "author_login": "jessie-codes"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-1321",
    "description": "Prototype pollution vulnerability in 'safe-flat' versions 2.0.0 through 2.0.1 allows an attacker to cause a denial of service and may lead to remote code execution.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-04-26T11:15:08.217",
    "last_modified": "2024-11-21T05:55:37.287",
    "fix_date": "2021-01-24T00:14:38Z"
  },
  "references": [
    {
      "url": "https://github.com/jessie-codes/safe-flat/commit/4b9b7db976bba8c968354f4315f5f9c219b7cbf3",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25927",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jessie-codes/safe-flat/commit/4b9b7db976bba8c968354f4315f5f9c219b7cbf3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25927",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:33.557411",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "safe-flat",
    "owner": "jessie-codes",
    "created_at": "2019-04-21T21:09:41Z",
    "updated_at": "2024-09-19T05:42:39Z",
    "pushed_at": "2024-09-19T05:42:36Z",
    "size": 458,
    "stars": 5,
    "forks": 8,
    "open_issues": 1,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/v1.x.x"
    ],
    "languages": {
      "JavaScript": 7638
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T22:08:49.408199"
  }
}