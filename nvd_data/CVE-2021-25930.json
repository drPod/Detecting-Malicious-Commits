{
  "cve_id": "CVE-2021-25930",
  "github_data": {
    "repository": "OpenNMS/opennms",
    "fix_commit": "607151ea8f90212a3fb37c977fa57c7d58d26a84",
    "related_commits": [
      "607151ea8f90212a3fb37c977fa57c7d58d26a84",
      "eb08b5ed4c5548f3e941a1f0d0363ae4439fa98c",
      "607151ea8f90212a3fb37c977fa57c7d58d26a84",
      "eb08b5ed4c5548f3e941a1f0d0363ae4439fa98c"
    ],
    "patch_url": "https://github.com/OpenNMS/opennms/commit/607151ea8f90212a3fb37c977fa57c7d58d26a84.patch",
    "fix_commit_details": {
      "sha": "607151ea8f90212a3fb37c977fa57c7d58d26a84",
      "commit_date": "2021-03-12T16:49:14Z",
      "author": {
        "login": "christianpape",
        "type": "User",
        "stats": {
          "total_commits": 1242,
          "average_weekly_commits": 1.1640112464854733,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 367
        }
      },
      "commit_message": {
        "title": "NMS-13124: Fixed user deletion by renaming bug and CSRF privilege escalation issue",
        "length": 82,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 221,
        "additions": 216,
        "deletions": 5
      },
      "files": [
        {
          "filename": "opennms-config/src/main/java/org/opennms/netmgt/config/UserManager.java",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -995,6 +995,10 @@ public void renameUser(final String oldName, final String newName) throws Except\n                     m_users.remove(oldName);\n                     throw new Exception(\"UserFactory:rename the data contained for old user \" + oldName + \" is null\");\n                 } else {\n+                    if (m_users.containsKey(newName)) {\n+                        throw new Exception(\"UserFactory: cannot rename user \" + oldName + \". An user with the given name \" + newName + \" already exists\");\n+                    }\n+\n                     // Rename the user in the user map.\n                     m_users.remove(oldName);\n                     data.setUserId(newName);"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/WEB-INF/applicationContext-spring-security.xml",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -122,6 +122,18 @@\n   <!-- Allow anonymous access to the webstart portion of the app -->\n   <http pattern=\"/webstart/**\" security=\"none\"/>\n \n+  <http pattern=\"/admin/userGroupView/**\" use-expressions=\"true\" access-denied-page=\"/accessDenied.jsp\" realm=\"OpenNMS Realm\" auto-config=\"false\" entry-point-ref=\"loginUrlAuthenticationEntryPoint\">\n+    <!-- see NMS-13124 -->\n+    <csrf />\n+    <intercept-url pattern=\"/admin/userGroupView/**\" access=\"hasAnyRole('ROLE_ADMIN')\" />\n+    <http-basic entry-point-ref=\"xRequestedWithAwareBasicAuthEntryPoint\" />\n+    <logout logout-success-url=\"/\" />\n+    <custom-filter position=\"FORM_LOGIN_FILTER\" ref=\"onmsUsernamePasswordAuthenticationFilter\" />\n+    <custom-filter position=\"PRE_AUTH_FILTER\" ref=\"attributePreAuthFilter\"/>\n+    <custom-filter after=\"PRE_AUTH_FILTER\" ref=\"headerPreAuthFilter\"/>\n+    <custom-filter position=\"LAST\" ref=\"authFilterEnabler\"/>\n+  </http>\n+\n   <!-- Only one <http> section can match the implicit '/**' pattern -->\n   <http pattern=\"/**\" use-expressions=\"true\" access-denied-page=\"/accessDenied.jsp\" realm=\"OpenNMS Realm\" auto-config=\"false\" entry-point-ref=\"loginUrlAuthenticationEntryPoint\">\n     <intercept-url pattern=\"/\" access=\"hasAnyRole('ROLE_ANONYMOUS','ROLE_USER','ROLE_DASHBOARD')\" />\n@@ -158,7 +170,7 @@\n     <intercept-url pattern=\"/graph/graph.png\" access=\"hasAnyRole('ROLE_USER','ROLE_DASHBOARD')\" />\n     <intercept-url pattern=\"/dashboard/**\" access=\"hasAnyRole('ROLE_USER','ROLE_DASHBOARD')\" />\n     <intercept-url pattern=\"/coreweb/**\" access=\"hasAnyRole('ROLE_USER','ROLE_DASHBOARD')\" />\n-    \n+\n     <!-- DO NOT ALLOW ACCESS TO /osgi -->\n     <intercept-url pattern=\"/osgi/**\" access=\"denyAll\" />\n "
        },
        {
          "filename": "opennms-webapp/src/main/webapp/WEB-INF/jsp/admin/userGroupView/groups/list.jsp",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -102,6 +102,7 @@\n   <input type=\"hidden\" name=\"operation\"/>\n   <input type=\"hidden\" name=\"groupName\"/>\n   <input type=\"hidden\" name=\"newName\"/>\n+  <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n \n   <div class=\"card\">\n     <table class=\"table table-sm table-bordered\">"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/WEB-INF/jsp/admin/userGroupView/groups/modifyGroup.jsp",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -292,6 +292,7 @@\n <form role=\"form\" class=\"form\" method=\"post\" id=\"modifyGroup\" name=\"modifyGroup\">\n   <input type=\"hidden\" name=\"groupName\" value=\"<%=group.getName()%>\"/>\n   <input type=\"hidden\" name=\"operation\"/>\n+  <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n \n     <div class=\"card\">\n         <div class=\"card-header\">"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/WEB-INF/jsp/admin/userGroupView/groups/newGroup.jsp",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -76,6 +76,7 @@\n   <div class=\"card-body\">\n     <form role=\"form\" class=\"form\" id=\"newGroupForm\" method=\"post\" name=\"newGroupForm\" onsubmit=\"return validateFormInput();\">\n       <input type=\"hidden\" name=\"operation\" />\n+      <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n \n       <div class=\"form-group\">\n         <label for=\"groupName\" class=\"\">Group Name</label>"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/roles/editDetails.jsp",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -70,6 +70,7 @@\n   </div>\n   <div class=\"card-body\">\n     <form role=\"form\" class=\"form\" action=\"<c:url value='${reqUrl}'/>\" method=\"post\" name=\"editForm\">\n+      <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n       <input type=\"hidden\" name=\"operation\" value=\"saveDetails\"/>\n       <input type=\"hidden\" name=\"role\" value=\"${fn:escapeXml(role.name)}\"/>\n "
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/roles/editSpecific.jsp",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -59,7 +59,8 @@\n       <input type=\"hidden\" name=\"operation\" value=\"saveEntry\"/>\n       <input type=\"hidden\" name=\"role\" value=\"${fn:escapeXml(role.name)}\"/>\n       <input type=\"hidden\" name=\"schedIndex\" value=\"${schedIndex}\"/>\n-      <input type=\"hidden\" name=\"timeIndex\" value=\"${timeIndex}\" /> \n+      <input type=\"hidden\" name=\"timeIndex\" value=\"${timeIndex}\" />\n+      <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n \n       <div class=\"form-group form-row\">\n         <label class=\"col-sm-2\">On-Call Role</label>"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/roles/list.jsp",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -93,6 +93,7 @@\n <form action=\"<c:url value='${reqUrl}'/>\" method=\"post\" name=\"roleForm\">\n \t<input type=\"hidden\" name=\"operation\" />\n \t<input type=\"hidden\" name=\"role\" />\n+\t<input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n </form>\n \n <div class=\"card\">\n@@ -148,6 +149,7 @@\n </div> <!-- panel -->\n \n <form action=\"<c:url value='${reqUrl}'/>\" method=\"post\" name=\"newForm\">\n+  <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n   <input name=\"operation\" type=\"hidden\" value=\"new\"/>\n   <button type=\"submit\" class=\"btn btn-secondary\">Add New On-Call Role</button>\n </form>"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/roles/view.jsp",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -157,10 +157,12 @@\n <form action=\"<c:url value='${reqUrl}'/>\" method=\"post\" name=\"editForm\">\n   <input type=\"hidden\" name=\"operation\" value=\"editDetails\"/>\n   <input type=\"hidden\" name=\"role\" value=\"${fn:escapeXml(role.name)}\"/>\n+  <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n   <button type=\"submit\" class=\"btn btn-secondary\">Value Details</button>\n </form>\n \n <form action=\"<c:url value='${reqUrl}'/>\" method=\"post\" name=\"doneForm\" class=\"my-4\">\n+  <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n   <button type=\"submit\" class=\"btn btn-secondary\">Done</button>\n </form>\n \n@@ -220,6 +222,7 @@\n </div>\n \n <form action=\"<c:url value='${reqUrl}'/>\" method=\"post\" name=\"doneForm\" class=\"mb-4\">\n+  <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n   <button type=\"submit\" class=\"btn btn-secondary\">Done</button>\n </form>\n "
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/users/list.jsp",
          "status": "modified",
          "additions": 18,
          "deletions": 3,
          "patch": "@@ -95,9 +95,19 @@\n     {\n         document.allUsers.userID.value=userID;\n         var newID = prompt(\"Enter new name for user.\", userID);\n-        \n-        if (newID != null && newID != \"\")\n-        {\n+\n+        if (newID != null && newID != \"\") {\n+          if (/.*[&<>\"`']+.*/.test(newID)) {\n+            alert(\"The user ID must not contain any HTML markup.\");\n+            return;\n+          }\n+\n+          var element =  document.getElementById('users(' + _.escape(newID) + ').doModify');\n+          if (typeof(element) != 'undefined' && element != null) {\n+            alert(\"A user with this ID already exist.\");\n+            return;\n+          }\n+\n           document.allUsers.newID.value = newID;\n           document.allUsers.action=\"admin/userGroupView/users/renameUser\";\n           document.allUsers.submit();\n@@ -112,6 +122,7 @@\n <input type=\"hidden\" name=\"userID\"/>\n <input type=\"hidden\" name=\"newID\"/>\n <input type=\"hidden\" name=\"password\"/>\n+<input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n \n <p>\n   Click on the <i>User ID</i> link to view detailed information about a\n@@ -209,4 +220,8 @@\n   </div> <!-- panel -->\n </form>\n \n+<jsp:include page=\"/assets/load-assets.jsp\" flush=\"false\">\n+    <jsp:param name=\"asset\" value=\"underscore-js\" />\n+</jsp:include>\n+\n <jsp:include page=\"/includes/bootstrap-footer.jsp\" flush=\"false\" />"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/users/modifyUser.jsp",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -256,6 +256,7 @@\n <input id=\"userID\" type=\"hidden\" name=\"userID\" value=\"<%=user.getUserId()%>\"/>\n <input id=\"password\" type=\"hidden\" name=\"password\"/>\n <input id=\"redirect\" type=\"hidden\" name=\"redirect\"/>\n+<input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n \n <div class=\"row\">\n   <div class=\"col-md-6\">"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/users/newPassword.jsp",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -66,6 +66,8 @@\n   </div>\n   <div class=\"card-body\">\n     <form role=\"form\" class=\"form\" method=\"post\" name=\"goForm\">\n+      <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n+\n       <div class=\"form-group\">\n         <label for=\"pass1\" class=\"\">Password</label>\n         <input type=\"password\" class=\"form-control\" id=\"pass1\" name=\"pass1\">"
        },
        {
          "filename": "opennms-webapp/src/main/webapp/admin/userGroupView/users/newUser.jsp",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -82,6 +82,7 @@\n   </div>\n   <div class=\"card-body\">\n     <form class=\"form\" role=\"form\" id=\"newUserForm\" method=\"post\" name=\"newUserForm\" onsubmit=\"return validateFormInput();\">\n+      <input type=\"hidden\" name=\"${_csrf.parameterName}\" value=\"${_csrf.token}\"/>\n       <div class=\"form-group\">\n         <label for=\"userID\" class=\"\">User ID</label>\n         <input id=\"userID\" type=\"text\" name=\"userID\" class=\"form-control\">"
        },
        {
          "filename": "smoke-test/src/test/java/org/opennms/smoketest/UserIT.java",
          "status": "modified",
          "additions": 166,
          "deletions": 0,
          "patch": "@@ -31,6 +31,8 @@\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertTrue;\n \n+import java.time.Duration;\n+import java.time.temporal.ChronoUnit;\n import java.util.List;\n \n import org.junit.Before;\n@@ -158,4 +160,168 @@ public void testChangeAdminPassword() throws Exception {\n         assertTrue(wait.until(pageContainsText(\"Password successfully changed\")));\n     }\n \n+    @Test\n+    public void testInvalidUserIds() {\n+        testInvalidUserId(\"John<b>Doe</b>\",true);\n+        testInvalidUserId(\"Jane'Doe'\",true);\n+        testInvalidUserId(\"John&Doe\",true);\n+        testInvalidUserId(\"Jane\\\"\\\"Doe\",true);\n+    }\n+\n+    @Test\n+    public void testValidUserIds() {\n+        testInvalidUserId(\"John-Doe\",false);\n+        testInvalidUserId(\"Jane/Doe\",false);\n+        testInvalidUserId(\"John.Doe\",false);\n+        testInvalidUserId(\"Jane#Doe\", false);\n+        testInvalidUserId(\"John@D\u00f6e.com\", false);\n+        testInvalidUserId(\"JohnDo\u00e9\", false);\n+    }\n+\n+    @Test\n+    public void testInvalidGroupIds() {\n+        testInvalidGroupId(\"John<b>Doe</b>\",true);\n+        testInvalidGroupId(\"Jane'Doe'\",true);\n+        testInvalidGroupId(\"John&Doe\",true);\n+        testInvalidGroupId(\"Jane\\\"\\\"Doe\",true);\n+    }\n+\n+    @Test\n+    public void testValidGroupIds() {\n+        testInvalidGroupId(\"John-Doe\",false);\n+        testInvalidGroupId(\"Jane/Doe\",false);\n+        testInvalidGroupId(\"John.Doe\",false);\n+        testInvalidGroupId(\"Jane#Doe\", false);\n+        testInvalidGroupId(\"John@D\u00f6e.com\", false);\n+        testInvalidGroupId(\"JohnDo\u00e9\", false);\n+    }\n+\n+    public void testInvalidUserId(final String userId, final boolean mustFail) {\n+        adminPage();\n+        findElementByLink(\"Configure Users, Groups and On-Call Roles\").click();\n+        findElementByLink(\"Configure Users\").click();\n+        findElementByLink(\"Add new user\").click();\n+\n+        enterText(By.id(\"userID\"), userId);\n+        enterText(By.id(\"pass1\"), \"SmokeTestPassword\");\n+        enterText(By.id(\"pass2\"), \"SmokeTestPassword\");\n+        findElementByXpath(\"//button[@type='submit' and text()='OK']\").click();\n+\n+        if (mustFail) {\n+            try {\n+                final Alert alert = wait.withTimeout(Duration.of(5, ChronoUnit.SECONDS)).until(ExpectedConditions.alertIsPresent());\n+                alert.dismiss();\n+            } catch (final Exception e) {\n+                LOG.debug(\"Got an exception waiting for a 'invalid user ID' alert.\", e);\n+                throw e;\n+            }\n+        } else {\n+            wait.until(ExpectedConditions.elementToBeClickable(By.name(\"finish\")));\n+        }\n+    }\n+\n+    public void testInvalidGroupId(final String groupId, final boolean mustFail) {\n+        adminPage();\n+        findElementByLink(\"Configure Users, Groups and On-Call Roles\").click();\n+        findElementByLink(\"Configure Groups\").click();\n+        findElementByLink(\"Add new group\").click();\n+\n+        enterText(By.id(\"groupName\"), groupId);\n+        enterText(By.id(\"groupComment\"), \"SmokeTestComment\");\n+        findElementByXpath(\"//button[@type='submit' and text()='OK']\").click();\n+\n+        if (mustFail) {\n+            try {\n+                final Alert alert = wait.withTimeout(Duration.of(5, ChronoUnit.SECONDS)).until(ExpectedConditions.alertIsPresent());\n+                alert.dismiss();\n+            } catch (final Exception e) {\n+                LOG.debug(\"Got an exception waiting for a 'invalid group ID' alert.\", e);\n+                throw e;\n+            }\n+        } else {\n+            wait.until(ExpectedConditions.elementToBeClickable(By.name(\"finish\")));\n+        }\n+    }\n+\n+    /**\n+     * see NMS-13124\n+     */\n+    @Test\n+    public void testCsrfPrivilegeEscalation() {\n+        // visit the admin's user page\n+        adminPage();\n+        findElementByLink(\"Configure Users, Groups and On-Call Roles\").click();\n+        findElementByLink(\"Configure Users\").click();\n+        findElementByLink(\"Add new user\").click();\n+\n+        // add a new user 'user'\n+        enterText(By.id(\"userID\"), \"user\");\n+        enterText(By.id(\"pass1\"), \"pass\");\n+        enterText(By.id(\"pass2\"), \"pass\");\n+        findElementByXpath(\"//button[@type='submit' and text()='OK']\").click();\n+\n+        // assign just the ROLE_USER\n+        final Select select = new Select(driver.findElement(By.name(\"availableRoles\")));\n+        select.selectByValue(\"ROLE_USER\");\n+        findElementById(\"roles.doAdd\").click();\n+        findElementById(\"saveUserButton\").click();\n+\n+        // assert that this is correctly set\n+        adminPage();\n+        findElementByLink(\"Configure Users, Groups and On-Call Roles\").click();\n+        findElementByLink(\"Configure Users\").click();\n+        findElementById(\"users(user).doDetails\").click();\n+\n+        assertTrue(wait.until(pageContainsText(\"ROLE_USER\")));\n+\n+        // now construct an exploit to set ROLE_ADMIN for user 'user'\n+        final String html = \"<form action='\" + stack.opennms().getBaseUrlInternal() + \"opennms/admin/userGroupView/users/updateUser' method='POST' enctype='application/x-www-form-urlencoded'>\" +\n+                \"<input type='hidden' name='userID' value='user' />\" +\n+                \"<input type='hidden' name='password' value=' ' />\" +\n+                \"<input type='hidden' name='redirect' value='/admin/userGroupView/users/saveUser' /> <input type='hidden' name='fullName' value=' ' />\" +\n+                \"<input type='hidden' name='userComments' value=' ' />\" +\n+                \"<input type='hidden' name='configuredRoles' value='ROLE_ADMIN' />\" +\n+                \"<input type='hidden' name='email' value=' ' />\" +\n+                \"<input type='hidden' name='pemail' value=' ' />\" +\n+                \"<input type='hidden' name='xmppAddress' value=' ' />\" +\n+                \"<input type='hidden' name='microblog' value=' ' />\" +\n+                \"<input type='hidden' name='numericalService' value=' ' />\" +\n+                \"<input type='hidden' name='numericalPin' value=' ' />\" +\n+                \"<input type='hidden' name='textService' value=' ' />\" +\n+                \"<input type='hidden' name='textPin' value=' ' />\" +\n+                \"<input type='hidden' name='workPhone' value=' ' />\" +\n+                \"<input type='hidden' name='mobilePhone' value=' ' />\" +\n+                \"<input type='hidden' name='homePhone' value=' ' />\" +\n+                \"<input type='hidden' name='tuiPin' value=' ' />\" +\n+                \"<input type='hidden' name='timeZoneId' value=' ' />\" +\n+                \"<input type='hidden' name='dutySchedules' value='0' />\" +\n+                \"<input type='hidden' name='numSchedules' value='1' />\" +\n+                \"<input type='submit' id='submitIt' />\" +\n+                \"</form>\";\n+        String script = \"var foo = document.createElement('div'); \" +\n+                \"foo.innerHTML=\\\"\" + html + \"\\\"; \" +\n+                \"document.body.appendChild(foo)\";\n+\n+        // ...and execute it\n+        driver.executeScript(script);\n+        findElementById(\"submitIt\").click();\n+\n+        // this should be denied due to CSRF protection\n+        assertTrue(wait.until(pageContainsText(\"Access denied\")));\n+\n+        // assure that the user's role is still ROLE_USER\n+        adminPage();\n+        findElementByLink(\"Configure Users, Groups and On-Call Roles\").click();\n+        findElementByLink(\"Configure Users\").click();\n+        findElementById(\"users(user).doDetails\").click();\n+        assertTrue(wait.until(pageContainsText(\"ROLE_USER\")));\n+\n+        // delete the user\n+        adminPage();\n+        findElementByLink(\"Configure Users, Groups and On-Call Roles\").click();\n+        findElementByLink(\"Configure Users\").click();\n+\n+        findElementById(\"users(user).doDelete\").click();\n+        handleAlert(\"Are you sure you want to delete the user user?\");\n+    }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 6,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa0a6c01745db1fb97c4e136e7b66f8223fd9023",
            "date": "2025-01-09T20:52:26Z",
            "author_login": "opennms-bamboo"
          },
          {
            "sha": "14ede259455c439c9f3ea8aa76726968661240c8",
            "date": "2025-01-09T18:30:16Z",
            "author_login": "opennms-bamboo"
          },
          {
            "sha": "9843579bedf5627bc55bd455903351be4c681713",
            "date": "2025-01-09T17:00:12Z",
            "author_login": "mershad-manesh"
          },
          {
            "sha": "d5aa086a8545ef95b5fef24a34c5468fe83e4c21",
            "date": "2025-01-08T18:38:01Z",
            "author_login": "mershad-manesh"
          },
          {
            "sha": "1f6ecf40b935a1067adf9068b10d6fd095eee915",
            "date": "2025-01-08T14:24:56Z",
            "author_login": "opennms-bamboo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-352",
    "description": "In OpenNMS Horizon, versions opennms-1-0-stable through opennms-27.1.0-1; OpenNMS Meridian, versions meridian-foundation-2015.1.0-1 through meridian-foundation-2019.1.18-1; meridian-foundation-2020.1.0-1 through meridian-foundation-2020.1.6-1 are vulnerable to CSRF, due to no CSRF protection, and since there is no validation of an existing user name while renaming a user. As a result, privileges of the renamed user are being overwritten by the old user and the old user is being deleted from the user list.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-05-20T14:15:07.737",
    "last_modified": "2024-11-21T05:55:37.643",
    "fix_date": "2021-03-12T16:49:14Z"
  },
  "references": [
    {
      "url": "https://github.com/OpenNMS/opennms/commit/607151ea8f90212a3fb37c977fa57c7d58d26a84",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenNMS/opennms/commit/eb08b5ed4c5548f3e941a1f0d0363ae4439fa98c",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25930",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenNMS/opennms/commit/607151ea8f90212a3fb37c977fa57c7d58d26a84",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenNMS/opennms/commit/eb08b5ed4c5548f3e941a1f0d0363ae4439fa98c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25930",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.110371",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "opennms",
    "owner": "OpenNMS",
    "created_at": "2013-04-11T18:22:33Z",
    "updated_at": "2025-01-14T07:56:39Z",
    "pushed_at": "2025-01-14T11:15:07Z",
    "size": 804409,
    "stars": 1002,
    "forks": 588,
    "open_issues": 62,
    "watchers": 1002,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "1.6",
      "1.8",
      "1.10",
      "1.12"
    ],
    "languages": {
      "Java": 60412677,
      "JavaScript": 3887957,
      "TypeScript": 374916,
      "HTML": 360783,
      "Vue": 352190,
      "Shell": 341289,
      "CSS": 133110,
      "Perl": 73669,
      "Python": 72357,
      "XSLT": 60925,
      "Groovy": 53961,
      "SCSS": 51003,
      "FreeMarker": 41468,
      "M4": 31931,
      "Makefile": 24635,
      "Dockerfile": 16707,
      "C++": 9187,
      "Batchfile": 8017,
      "PLpgSQL": 7633,
      "Smarty": 6633,
      "Jinja": 5483,
      "C": 4048,
      "R": 1375,
      "Clojure": 941,
      "CMake": 898
    },
    "commit_activity": {
      "total_commits_last_year": 874,
      "avg_commits_per_week": 16.807692307692307,
      "days_active_last_year": 181
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:59:41.732233"
  }
}