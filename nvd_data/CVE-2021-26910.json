{
  "cve_id": "CVE-2021-26910",
  "github_data": {
    "repository": "netblue30/firejail",
    "fix_commit": "97d8a03cad19501f017587cc4e47d8418273834b",
    "related_commits": [
      "97d8a03cad19501f017587cc4e47d8418273834b",
      "97d8a03cad19501f017587cc4e47d8418273834b"
    ],
    "patch_url": "https://github.com/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b.patch",
    "fix_commit_details": {
      "sha": "97d8a03cad19501f017587cc4e47d8418273834b",
      "commit_date": "2021-02-05T22:13:37Z",
      "author": {
        "login": "netblue30",
        "type": "User",
        "stats": {
          "total_commits": 867,
          "average_weekly_commits": 1.7621951219512195,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 122
        }
      },
      "commit_message": {
        "title": "disabled overlayfs, 0.9.64.4 testing",
        "length": 36,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 55,
        "additions": 27,
        "deletions": 28
      },
      "files": [
        {
          "filename": "configure",
          "status": "modified",
          "additions": 17,
          "deletions": 21,
          "patch": "@@ -1,6 +1,6 @@\n #! /bin/sh\n # Guess values for system-dependent variables and create Makefiles.\n-# Generated by GNU Autoconf 2.69 for firejail 0.9.64.2.\n+# Generated by GNU Autoconf 2.69 for firejail 0.9.64.4.\n #\n # Report bugs to <netblue30@protonmail.com>.\n #\n@@ -580,8 +580,8 @@ MAKEFLAGS=\n # Identity of this package.\n PACKAGE_NAME='firejail'\n PACKAGE_TARNAME='firejail'\n-PACKAGE_VERSION='0.9.64.2'\n-PACKAGE_STRING='firejail 0.9.64.2'\n+PACKAGE_VERSION='0.9.64.4'\n+PACKAGE_STRING='firejail 0.9.64.4'\n PACKAGE_BUGREPORT='netblue30@protonmail.com'\n PACKAGE_URL='https://firejail.wordpress.com'\n \n@@ -711,7 +711,6 @@ enable_option_checking\n enable_analyzer\n enable_apparmor\n enable_dbusproxy\n-enable_overlayfs\n enable_usertmpfs\n enable_man\n enable_firetunnel\n@@ -1294,7 +1293,7 @@ if test \"$ac_init_help\" = \"long\"; then\n   # Omit some internal or obsolete options to make the list less imposing.\n   # This message is too long to be a string in the A/UX 3.1 sh.\n   cat <<_ACEOF\n-\\`configure' configures firejail 0.9.64.2 to adapt to many kinds of systems.\n+\\`configure' configures firejail 0.9.64.4 to adapt to many kinds of systems.\n \n Usage: $0 [OPTION]... [VAR=VALUE]...\n \n@@ -1356,7 +1355,7 @@ fi\n \n if test -n \"$ac_init_help\"; then\n   case $ac_init_help in\n-     short | recursive ) echo \"Configuration of firejail 0.9.64.2:\";;\n+     short | recursive ) echo \"Configuration of firejail 0.9.64.4:\";;\n    esac\n   cat <<\\_ACEOF\n \n@@ -1367,7 +1366,6 @@ Optional Features:\n   --enable-analyzer       enable GCC 10 static analyzer\n   --enable-apparmor       enable apparmor\n   --disable-dbusproxy     disable dbus proxy\n-  --disable-overlayfs     disable overlayfs\n   --disable-usertmpfs     disable tmpfs as regular user\n   --disable-man           disable man pages\n   --disable-firetunnel    disable firetunnel\n@@ -1473,7 +1471,7 @@ fi\n test -n \"$ac_init_help\" && exit $ac_status\n if $ac_init_version; then\n   cat <<\\_ACEOF\n-firejail configure 0.9.64.2\n+firejail configure 0.9.64.4\n generated by GNU Autoconf 2.69\n \n Copyright (C) 2012 Free Software Foundation, Inc.\n@@ -1775,7 +1773,7 @@ cat >config.log <<_ACEOF\n This file contains any messages produced by compilers while\n running configure, to aid debugging if configure makes a mistake.\n \n-It was created by firejail $as_me 0.9.64.2, which was\n+It was created by firejail $as_me 0.9.64.4, which was\n generated by GNU Autoconf 2.69.  Invocation command line was\n \n   $ $0 $@\n@@ -3530,18 +3528,16 @@ if test \"x$enable_dbusproxy\" != \"xno\"; then :\n \n fi\n \n+# overlayfs features temporarely disabled pending fixes\n HAVE_OVERLAYFS=\"\"\n-# Check whether --enable-overlayfs was given.\n-if test \"${enable_overlayfs+set}\" = set; then :\n-  enableval=$enable_overlayfs;\n-fi\n-\n-if test \"x$enable_overlayfs\" != \"xno\"; then :\n-\n-\tHAVE_OVERLAYFS=\"-DHAVE_OVERLAYFS\"\n \n-\n-fi\n+#\n+#AC_ARG_ENABLE([overlayfs],\n+#    AS_HELP_STRING([--disable-overlayfs], [disable overlayfs]))\n+#AS_IF([test \"x$enable_overlayfs\" != \"xno\"], [\n+#\tHAVE_OVERLAYFS=\"-DHAVE_OVERLAYFS\"\n+#\tAC_SUBST(HAVE_OVERLAYFS)\n+#])\n \n HAVE_USERTMPS=\"\"\n # Check whether --enable-usertmpfs was given.\n@@ -4817,7 +4813,7 @@ cat >>$CONFIG_STATUS <<\\_ACEOF || ac_write_fail=1\n # report actual input values of CONFIG_FILES etc. instead of their\n # values after options handling.\n ac_log=\"\n-This file was extended by firejail $as_me 0.9.64.2, which was\n+This file was extended by firejail $as_me 0.9.64.4, which was\n generated by GNU Autoconf 2.69.  Invocation command line was\n \n   CONFIG_FILES    = $CONFIG_FILES\n@@ -4871,7 +4867,7 @@ _ACEOF\n cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1\n ac_cs_config=\"`$as_echo \"$ac_configure_args\" | sed 's/^ //; s/[\\\\\"\"\\`\\$]/\\\\\\\\&/g'`\"\n ac_cs_version=\"\\\\\n-firejail config.status 0.9.64.2\n+firejail config.status 0.9.64.4\n configured by $0, generated by GNU Autoconf 2.69,\n   with options \\\\\"\\$ac_cs_config\\\\\"\n "
        },
        {
          "filename": "configure.ac",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -12,7 +12,7 @@\n #\n \n AC_PREREQ([2.68])\n-AC_INIT(firejail, 0.9.64.2, netblue30@protonmail.com, , https://firejail.wordpress.com)\n+AC_INIT(firejail, 0.9.64.4, netblue30@protonmail.com, , https://firejail.wordpress.com)\n AC_CONFIG_SRCDIR([src/firejail/main.c])\n \n AC_CONFIG_MACRO_DIR([m4])\n@@ -66,13 +66,16 @@ AS_IF([test \"x$enable_dbusproxy\" != \"xno\"], [\n \tAC_SUBST(HAVE_DBUSPROXY)\n ])\n \n+# overlayfs features temporarely disabled pending fixes\n HAVE_OVERLAYFS=\"\"\n-AC_ARG_ENABLE([overlayfs],\n-    AS_HELP_STRING([--disable-overlayfs], [disable overlayfs]))\n-AS_IF([test \"x$enable_overlayfs\" != \"xno\"], [\n-\tHAVE_OVERLAYFS=\"-DHAVE_OVERLAYFS\"\n-\tAC_SUBST(HAVE_OVERLAYFS)\n-])\n+AC_SUBST(HAVE_OVERLAYFS)\n+#\n+#AC_ARG_ENABLE([overlayfs],\n+#    AS_HELP_STRING([--disable-overlayfs], [disable overlayfs]))\n+#AS_IF([test \"x$enable_overlayfs\" != \"xno\"], [\n+#\tHAVE_OVERLAYFS=\"-DHAVE_OVERLAYFS\"\n+#\tAC_SUBST(HAVE_OVERLAYFS)\n+#])\n \n HAVE_USERTMPS=\"\"\n AC_ARG_ENABLE([usertmpfs],"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a53de4926bcd74e59016b63455b6b87f03e5557c",
            "date": "2025-01-13T08:59:35Z",
            "author_login": "kmk3"
          },
          {
            "sha": "5c6fa6ab584eb6241467b5d5aea76f26dcc922fb",
            "date": "2025-01-13T08:44:29Z",
            "author_login": "kmk3"
          },
          {
            "sha": "e6de48c46caf29fd3089445bfa72da8ebd065a27",
            "date": "2025-01-13T08:42:36Z",
            "author_login": "kmk3"
          },
          {
            "sha": "47467c3551987960d85be585a17ccafca26bc9af",
            "date": "2025-01-13T09:06:24Z",
            "author_login": "kmk3"
          },
          {
            "sha": "ead598769238626cfba0fe1cb88ede222171d3db",
            "date": "2025-01-13T06:20:58Z",
            "author_login": "kmk3"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-367",
    "description": "Firejail before 0.9.64.4 allows attackers to bypass intended access restrictions because there is a TOCTOU race condition between a stat operation and an OverlayFS mount operation.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-08T20:15:13.090",
    "last_modified": "2024-11-21T05:57:01.223",
    "fix_date": "2021-02-05T22:13:37Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2021/02/09/1",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netblue30/firejail/releases/tag/0.9.64.4",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/02/msg00015.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202105-19",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://unparalleled.eu/blog/2021/20210208-rigged-race-against-firejail-for-local-root/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://unparalleled.eu/publications/2021/advisory-unpar-2021-0.txt",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4849",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2021/02/09/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netblue30/firejail/commit/97d8a03cad19501f017587cc4e47d8418273834b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netblue30/firejail/releases/tag/0.9.64.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/02/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202105-19",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://unparalleled.eu/blog/2021/20210208-rigged-race-against-firejail-for-local-root/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://unparalleled.eu/publications/2021/advisory-unpar-2021-0.txt",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4849",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:13.189183",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "firejail",
    "owner": "netblue30",
    "created_at": "2015-08-08T22:25:44Z",
    "updated_at": "2025-01-14T11:16:36Z",
    "pushed_at": "2025-01-13T09:14:45Z",
    "size": 22266,
    "stars": 5896,
    "forks": 578,
    "open_issues": 455,
    "watchers": 5896,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1316671,
      "Roff": 152536,
      "Shell": 91527,
      "Makefile": 26139,
      "Python": 25249,
      "M4": 12459,
      "Awk": 1529,
      "Perl": 769,
      "Vim Script": 731
    },
    "commit_activity": {
      "total_commits_last_year": 460,
      "avg_commits_per_week": 8.846153846153847,
      "days_active_last_year": 161
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:26:29.007963"
  }
}