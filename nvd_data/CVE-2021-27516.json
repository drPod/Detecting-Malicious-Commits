{
  "cve_id": "CVE-2021-27516",
  "github_data": {
    "repository": "medialize/URI.js",
    "fix_commit": "a1ad8bcbc39a4d136d7e252e76e957f3ece70839",
    "related_commits": [
      "a1ad8bcbc39a4d136d7e252e76e957f3ece70839",
      "a1ad8bcbc39a4d136d7e252e76e957f3ece70839"
    ],
    "patch_url": "https://github.com/medialize/URI.js/commit/a1ad8bcbc39a4d136d7e252e76e957f3ece70839.patch",
    "fix_commit_details": {
      "sha": "a1ad8bcbc39a4d136d7e252e76e957f3ece70839",
      "commit_date": "2021-02-13T15:05:10Z",
      "author": {
        "login": "rodneyrehm",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(parse): treat backslash as forwardslash in scheme delimiter",
        "length": 154,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 51,
        "additions": 50,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/URI.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -526,7 +526,7 @@\n         if (parts.protocol && !parts.protocol.match(URI.protocol_expression)) {\n           // : may be within the path\n           parts.protocol = undefined;\n-        } else if (string.substring(pos + 1, pos + 3) === '//') {\n+        } else if (string.substring(pos + 1, pos + 3).replace(/\\\\/g, '/') === '//') {\n           string = string.substring(pos + 3);\n \n           // extract \"user:pass@host:port\""
        },
        {
          "filename": "test/urls.js",
          "status": "modified",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -2082,6 +2082,55 @@ var urls = [{\n         idn: false,\n         punycode: false\n       }\n+    }, {\n+      name: 'backslashes protocol',\n+      url: 'https:/\\\\attacker.com',\n+      _url: 'https://attacker.com/',\n+      parts: {\n+        protocol: 'https',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'https',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'https://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n     }\n ];\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28976cde5bb32a433ab78c4a32ef58f39d2cabf6",
            "date": "2022-04-03T09:31:17Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b655c1b972111ade9f181b02374305942e68e30a",
            "date": "2022-04-03T09:30:13Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
            "date": "2022-04-03T09:24:54Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
            "date": "2022-04-03T08:51:52Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "119e6abe4579f6a76b078586ec4d8fbce9da962c",
            "date": "2022-03-05T15:17:44Z",
            "author_login": "rodneyrehm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": null,
    "description": "URI.js (aka urijs) before 1.19.6 mishandles certain uses of backslash such as http:\\/ and interprets the URI as a relative path.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-02-22T00:15:12.620",
    "last_modified": "2024-11-21T05:58:08.520",
    "fix_date": "2021-02-13T15:05:10Z"
  },
  "references": [
    {
      "url": "https://advisory.checkmarx.net/advisory/CX-2021-4305",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/commit/a1ad8bcbc39a4d136d7e252e76e957f3ece70839",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/releases/tag/v1.19.6",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://advisory.checkmarx.net/advisory/CX-2021-4305",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/commit/a1ad8bcbc39a4d136d7e252e76e957f3ece70839",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/releases/tag/v1.19.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.799802",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "URI.js",
    "owner": "medialize",
    "created_at": "2011-12-27T10:46:47Z",
    "updated_at": "2025-01-13T05:48:53Z",
    "pushed_at": "2023-08-27T10:51:22Z",
    "size": 3202,
    "stars": 6258,
    "forks": 476,
    "open_issues": 104,
    "watchers": 6258,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 377871,
      "HTML": 120393,
      "CSS": 9642,
      "PHP": 1226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:53:07.731779"
  }
}