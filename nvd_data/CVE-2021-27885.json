{
  "cve_id": "CVE-2021-27885",
  "github_data": {
    "repository": "e107inc/e107",
    "fix_commit": "d9efdb9b5f424b4996c276e754a380a5e251f472",
    "related_commits": [
      "d9efdb9b5f424b4996c276e754a380a5e251f472",
      "d9efdb9b5f424b4996c276e754a380a5e251f472"
    ],
    "patch_url": "https://github.com/e107inc/e107/commit/d9efdb9b5f424b4996c276e754a380a5e251f472.patch",
    "fix_commit_details": {
      "sha": "d9efdb9b5f424b4996c276e754a380a5e251f472",
      "commit_date": "2021-03-02T00:41:09Z",
      "author": {
        "login": "CaMer0n",
        "type": "User",
        "stats": {
          "total_commits": 8048,
          "average_weekly_commits": 8.50739957716702,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 634
        }
      },
      "commit_message": {
        "title": "e_TOKEN added.",
        "length": 14,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 12,
        "additions": 6,
        "deletions": 6
      },
      "files": [
        {
          "filename": "usersettings.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -21,7 +21,10 @@\n USET_01 - admin changed user data\n */\n \n-\n+if(!empty($_POST) && !isset($_POST['e-token']))\n+{\n+\t$_POST['e-token'] = '';\n+}\n require_once ('class2.php');\n \n // TODO - Remove all the adminEdit stuff. \n@@ -1032,6 +1035,7 @@ private function renderPasswordForm($changedUserData, $changedEUFData )\n \t\t\t\t<input type='hidden' name='updated_key' value='{$validation_key}' />\n \t\t\t\t<input type='hidden' name='updated_extended' value='{$updated_extended}' />\n \t\t\t\t<input type='hidden' name='extended_key' value='{$extended_key}' />\n+\t\t\t\t<input type='hidden' name='e-token' value='\".defset('e_TOKEN').\"' />\n \t\t\t\t</td></tr>\n \t\t\t\t<tr><td>&nbsp;</td></tr>\n \t\t\t\t<tr><td style='text-align:center'>\n@@ -1085,8 +1089,6 @@ private function renderForm($changedUserData)\n \n \t\t$text = '<form method=\"post\" action=\"'.$target.'\" id=\"dataform\" class=\"usersettings-form form-horizontal\"  enctype=\"multipart/form-data\" autocomplete=\"off\">';\n \n-\t\t//$text = (is_numeric($_uid) ? $rs->form_open(\"post\", e_SELF.\"?\".e_QUERY, \"dataform\", \"\", \" class='form-horizontal' role='form' enctype='multipart/form-data'\") : $rs->form_open(\"post\", e_SELF, \"dataform\", \"\", \" class='form-horizontal' role='form' enctype='multipart/form-data'\"));\n-\n \t\tif (e_QUERY == \"update\")\n \t\t{\n \t\t\t$text .= \"<div class='fborder' style='text-align:center'><br />\".str_replace(\"*\", \"<span class='required'>*</span>\", LAN_USET_9).\"<br />\".LAN_USET_10.\"<br /><br /></div>\";\n@@ -1102,6 +1104,7 @@ private function renderForm($changedUserData)\n \n \n \t\t$text .= \"<div><input type='hidden' name='_uid' value='{$uuid}' /></div>\n+\t\t\t\t<input type='hidden' name='e-token' value='\".defset('e_TOKEN').\"' />\n \t\t</form>\n \t\t\";\n \n@@ -1110,9 +1113,6 @@ private function renderForm($changedUserData)\n \t\t$ns->tablerender($caption, $text);\n \n \n-\n-\n-\n \t}\n \n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b51833b794a5fa3ff42ed748fef75b87250f9418",
            "date": "2025-01-13T23:35:28Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "6aa42ccad90cbdcc1c9e6a3933bcd7124380a1a2",
            "date": "2025-01-13T19:41:57Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "d86eeac7bc3cc714532d46eb96c3c9429d4be5fd",
            "date": "2025-01-13T19:20:05Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "73c5760cbb55bb61af60dcda02e523d2ea4c4caa",
            "date": "2025-01-10T18:48:13Z",
            "author_login": "CaMer0n"
          },
          {
            "sha": "a5f790dab1650d1bd1438ca2f46b8f958f7a2da0",
            "date": "2025-01-10T18:39:18Z",
            "author_login": "CaMer0n"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-352",
    "description": "usersettings.php in e107 through 2.3.0 lacks a certain e_TOKEN protection mechanism.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-03-02T19:15:13.380",
    "last_modified": "2024-11-21T05:58:41.690",
    "fix_date": "2021-03-02T00:41:09Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/161651/e107-CMS-2.3.0-Cross-Site-Request-Forgery.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e107inc/e107/commit/d9efdb9b5f424b4996c276e754a380a5e251f472",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e107inc/e107/releases",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/161651/e107-CMS-2.3.0-Cross-Site-Request-Forgery.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e107inc/e107/commit/d9efdb9b5f424b4996c276e754a380a5e251f472",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e107inc/e107/releases",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.816376",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "e107",
    "owner": "e107inc",
    "created_at": "2012-11-16T19:49:01Z",
    "updated_at": "2025-01-13T23:35:38Z",
    "pushed_at": "2025-01-13T23:35:33Z",
    "size": 93949,
    "stars": 324,
    "forks": 213,
    "open_issues": 662,
    "watchers": 324,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 10485316,
      "JavaScript": 1136648,
      "CSS": 973571,
      "HTML": 20946,
      "Scala": 20715,
      "Clojure": 14453,
      "SaltStack": 3602,
      "SuperCollider": 3212,
      "Go": 1300,
      "BlitzBasic": 161
    },
    "commit_activity": {
      "total_commits_last_year": 110,
      "avg_commits_per_week": 2.1153846153846154,
      "days_active_last_year": 44
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:12:18.206807"
  }
}