{
  "cve_id": "CVE-2021-28957",
  "github_data": {
    "repository": "lxml/lxml",
    "fix_commit": "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
    "related_commits": [
      "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
      "a5f9cb52079dc57477c460dbe6ba0f775e14a999"
    ],
    "patch_url": "https://github.com/lxml/lxml/commit/a5f9cb52079dc57477c460dbe6ba0f775e14a999.patch",
    "fix_commit_details": {
      "sha": "a5f9cb52079dc57477c460dbe6ba0f775e14a999",
      "commit_date": "2021-03-21T14:11:30Z",
      "author": {
        "login": "scoder",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Prepare release of lxml 4.6.3.",
        "length": 30,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 23,
        "additions": 19,
        "deletions": 4
      },
      "files": [
        {
          "filename": "CHANGES.txt",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -2,6 +2,17 @@\n lxml changelog\n ==============\n \n+4.6.3 (2021-03-21)\n+==================\n+\n+Bugs fixed\n+----------\n+\n+* A vulnerability (CVE-2021-28957) was discovered in the HTML Cleaner by Kevin Chung,\n+  which allowed JavaScript to pass through.  The cleaner now removes the HTML5\n+  ``formaction`` attribute.\n+\n+\n 4.6.2 (2020-11-26)\n ==================\n "
        },
        {
          "filename": "doc/main.txt",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -159,8 +159,8 @@ Index <http://pypi.python.org/pypi/lxml/>`_ (PyPI).  It has the source\n that compiles on various platforms.  The source distribution is signed\n with `this key <pubkey.asc>`_.\n \n-The latest version is `lxml 4.6.2`_, released 2020-11-26\n-(`changes for 4.6.2`_).  `Older versions <#old-versions>`_\n+The latest version is `lxml 4.6.3`_, released 2021-03-21\n+(`changes for 4.6.3`_).  `Older versions <#old-versions>`_\n are listed below.\n \n Please take a look at the\n@@ -256,7 +256,9 @@ See the websites of lxml\n ..\n    and the `latest in-development version <http://lxml.de/dev/>`_.\n \n-.. _`PDF documentation`: lxmldoc-4.6.2.pdf\n+.. _`PDF documentation`: lxmldoc-4.6.3.pdf\n+\n+* `lxml 4.6.3`_, released 2021-03-21 (`changes for 4.6.3`_)\n \n * `lxml 4.6.2`_, released 2020-11-26 (`changes for 4.6.2`_)\n \n@@ -280,6 +282,7 @@ See the websites of lxml\n \n * `older releases <http://lxml.de/4.3/#old-versions>`_\n \n+.. _`lxml 4.6.3`: /files/lxml-4.6.3.tgz\n .. _`lxml 4.6.2`: /files/lxml-4.6.2.tgz\n .. _`lxml 4.6.1`: /files/lxml-4.6.1.tgz\n .. _`lxml 4.6.0`: /files/lxml-4.6.0.tgz\n@@ -291,6 +294,7 @@ See the websites of lxml\n .. _`lxml 4.4.1`: /files/lxml-4.4.1.tgz\n .. _`lxml 4.4.0`: /files/lxml-4.4.0.tgz\n \n+.. _`changes for 4.6.3`: /changes-4.6.3.html\n .. _`changes for 4.6.2`: /changes-4.6.2.html\n .. _`changes for 4.6.1`: /changes-4.6.1.html\n .. _`changes for 4.6.0`: /changes-4.6.0.html"
        },
        {
          "filename": "src/lxml/__init__.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n # this is a package\n \n-__version__ = \"4.6.2\"\n+__version__ = \"4.6.3\"\n \n \n def get_include():"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c58e3de71d2a0c74a1c401698ab956d3ca787741",
            "date": "2025-01-13T15:14:43Z",
            "author_login": "scoder"
          },
          {
            "sha": "8bdbbd9c1c04a3b34eee819a4332870c59fe4ed8",
            "date": "2025-01-13T14:13:11Z",
            "author_login": "scoder"
          },
          {
            "sha": "7be20eb3931010b42dfa81427c45fa716f52954c",
            "date": "2024-11-05T09:59:08Z",
            "author_login": "scoder"
          },
          {
            "sha": "9bdf66b1e33b19ac2796d3f210bc861aebe476e3",
            "date": "2024-11-05T09:40:10Z",
            "author_login": "scoder"
          },
          {
            "sha": "224dc56d325d057db14ecf672ead3f1fed5e1b29",
            "date": "2024-11-05T09:16:03Z",
            "author_login": "scoder"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "An XSS vulnerability was discovered in python-lxml's clean module versions before 4.6.3. When disabling the safe_attrs_only and forms arguments, the Cleaner class does not remove the formaction attribute allowing for JS to bypass the sanitizer. A remote attacker could exploit this flaw to run arbitrary JS code on users who interact with incorrectly sanitized HTML. This issue is patched in lxml 4.6.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-03-21T05:15:13.367",
    "last_modified": "2024-11-21T06:00:26.497",
    "fix_date": "2021-03-21T14:11:30Z"
  },
  "references": [
    {
      "url": "https://bugs.launchpad.net/lxml/+bug/1888153",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/a5f9cb52079dc57477c460dbe6ba0f775e14a999",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/pull/316/commits/10ec1b4e9f93713513a3264ed6158af22492f270",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00031.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3C2R44VDUY7FJVMAVRZ2WY7XYL4SVN45/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XXN3QPWCTQVOGW4BMWV3AUUZZ4NRZNSQ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-06",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210521-0004/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4880",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.launchpad.net/lxml/+bug/1888153",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/a5f9cb52079dc57477c460dbe6ba0f775e14a999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/pull/316/commits/10ec1b4e9f93713513a3264ed6158af22492f270",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00031.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/3C2R44VDUY7FJVMAVRZ2WY7XYL4SVN45/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XXN3QPWCTQVOGW4BMWV3AUUZZ4NRZNSQ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210521-0004/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-4880",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:16.849296",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lxml",
    "owner": "lxml",
    "created_at": "2011-02-11T05:43:11Z",
    "updated_at": "2025-01-14T14:28:27Z",
    "pushed_at": "2025-01-13T15:14:45Z",
    "size": 20407,
    "stars": 2745,
    "forks": 569,
    "open_issues": 20,
    "watchers": 2745,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 1261561,
      "Cython": 913329,
      "XSLT": 154294,
      "HTML": 15198,
      "C": 14544,
      "Shell": 6262,
      "Makefile": 5719
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:48:07.726628"
  }
}