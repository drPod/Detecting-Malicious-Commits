{
  "cve_id": "CVE-2021-29503",
  "github_data": {
    "repository": "hedgedoc/hedgedoc",
    "fix_commit": "01dad5821ee28377ebe640c6c72c3e0bb0d51ea7",
    "related_commits": [
      "01dad5821ee28377ebe640c6c72c3e0bb0d51ea7",
      "01dad5821ee28377ebe640c6c72c3e0bb0d51ea7"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "01dad5821ee28377ebe640c6c72c3e0bb0d51ea7",
      "commit_date": "2021-05-11T19:13:25Z",
      "author": {
        "login": "davidmehren",
        "type": "User",
        "stats": {
          "total_commits": 581,
          "average_weekly_commits": 2.3522267206477734,
          "total_additions": 50002,
          "total_deletions": 29810,
          "weeks_active": 84
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-gjg7-4j2h-94fq",
        "length": 82,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/models/user.js",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -2,6 +2,7 @@\n // external modules\n const Sequelize = require('sequelize')\n const scrypt = require('scrypt-kdf')\n+const filterXSS = require('xss')\n \n // core\n const logger = require('../logger')\n@@ -74,7 +75,7 @@ module.exports = function (sequelize, DataTypes) {\n     }\n     if (profile) {\n       profile = {\n-        name: profile.displayName || profile.username,\n+        name: filterXSS(profile.displayName || profile.username),\n         photo: User.parsePhotoByProfile(profile),\n         biggerphoto: User.parsePhotoByProfile(profile, true)\n       }\n@@ -135,7 +136,7 @@ module.exports = function (sequelize, DataTypes) {\n         photo = generateAvatarURL(profile.username)\n         break\n     }\n-    return photo\n+    return filterXSS(photo)\n   }\n   User.parseProfileByEmail = function (email) {\n     return {"
        },
        {
          "filename": "public/views/hedgedoc/head.ejs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n <%- include('../includes/favicon') %>\n <% for (var og in opengraph) { %>\n <% if (opengraph.hasOwnProperty(og) && opengraph[og].trim() !== '') { %>\n-<meta property=\"og:<%- og %>\" content=\"<%- opengraph[og] %>\">\n+<meta property=\"og:<%= og %>\" content=\"<%= opengraph[og] %>\">\n <% }} if (!opengraph.hasOwnProperty('image')) { %>\n <meta property=\"og:image\" content=\"<%- serverURL %>/icons/android-chrome-512x512.png\">\n <meta property=\"og:image:alt\" content=\"HedgeDoc logo\">"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3a90a750fd068311aa01e0a6f1c465c39c5b2866",
            "date": "2025-01-18T00:32:18Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "e61777612f081f63f85efaa64e2306c88fb45c21",
            "date": "2024-12-30T20:51:24Z",
            "author_login": "Trayshar"
          },
          {
            "sha": "94bb6e9c9f48d59bdd8dce628b81bed486051626",
            "date": "2025-01-04T04:21:03Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "0439e70d888fbdfa5209d710482c05610da51f86",
            "date": "2024-12-18T19:20:34Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "24e2063d6a6be7312c6d0e4abfabcdb46fcb6fcc",
            "date": "2024-12-18T18:22:13Z",
            "author_login": "ErikMichelson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-80",
    "description": "HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-05-19T20:15:07.440",
    "last_modified": "2024-11-21T06:01:15.737",
    "fix_date": "2021-05-11T19:13:25Z"
  },
  "references": [
    {
      "url": "https://github.com/hedgedoc/hedgedoc/commit/01dad5821ee28377ebe640c6c72c3e0bb0d51ea7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/releases/tag/1.8.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-gjg7-4j2h-94fq",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/commit/01dad5821ee28377ebe640c6c72c3e0bb0d51ea7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/releases/tag/1.8.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hedgedoc/hedgedoc/security/advisories/GHSA-gjg7-4j2h-94fq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.109346",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "hedgedoc",
    "owner": "hedgedoc",
    "created_at": "2019-03-27T12:14:01Z",
    "updated_at": "2025-01-25T21:33:01Z",
    "pushed_at": "2025-01-24T21:14:35Z",
    "size": 104362,
    "stars": 5413,
    "forks": 413,
    "open_issues": 254,
    "watchers": 5413,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "TypeScript": 2960544,
      "SCSS": 99279,
      "JavaScript": 13932,
      "Dockerfile": 4079,
      "Shell": 3027,
      "CSS": 1071
    },
    "commit_activity": {
      "total_commits_last_year": 330,
      "avg_commits_per_week": 6.346153846153846,
      "days_active_last_year": 54
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T07:53:05.049628"
  }
}