{
  "cve_id": "CVE-2021-29616",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "e6340f0665d53716ef3197ada88936c2a5f7a2d3",
    "related_commits": [
      "e6340f0665d53716ef3197ada88936c2a5f7a2d3",
      "e6340f0665d53716ef3197ada88936c2a5f7a2d3"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/e6340f0665d53716ef3197ada88936c2a5f7a2d3.patch",
    "fix_commit_details": {
      "sha": "e6340f0665d53716ef3197ada88936c2a5f7a2d3",
      "commit_date": "2021-04-19T16:57:01Z",
      "author": {
        "login": "mihaimaruseac",
        "type": "User",
        "stats": {
          "total_commits": 1590,
          "average_weekly_commits": 3.3125,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 214
        }
      },
      "commit_message": {
        "title": "Handle a special grappler case resulting in crash.",
        "length": 324,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 17,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/grappler/optimizers/arithmetic_optimizer.cc",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -2047,6 +2047,12 @@ class ReorderCastLikeAndValuePreserving : public ArithmeticOptimizerStage {\n \n   Status TrySimplify(NodeDef* consumer, string* simplified_node_name) override {\n     NodeDef* producer;\n+\n+    if (consumer->input_size() < 1) {\n+      return errors::FailedPrecondition(\"Node \", simplified_node_name,\n+                                        \" lacks inputs\");\n+    }\n+\n     TF_RETURN_IF_ERROR(GetInputNode(consumer->input(0), &producer));\n     const bool producer_is_cast = IsCastLike(*producer);\n     const bool can_optimize =\n@@ -2538,6 +2544,11 @@ class ReplaceMulWithSquare : public ArithmeticOptimizerStage {\n   ~ReplaceMulWithSquare() override = default;\n \n   bool IsSupported(const NodeDef* node) const override {\n+    if (!node || node->input_size() < 2) {\n+      // Invalid node\n+      return false;\n+    }\n+\n     return IsAnyMul(*node) && node->input(0) == node->input(1);\n   }\n "
        },
        {
          "filename": "tensorflow/core/grappler/optimizers/dependency_optimizer.cc",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -68,6 +68,12 @@ bool DependencyOptimizer::SafeToRemoveIdentity(const NodeDef& node) const {\n     // The output values of this node may be needed.\n     return false;\n   }\n+\n+  if (node.input_size() < 1) {\n+    // Node lacks input, is invalid\n+    return false;\n+  }\n+\n   const NodeDef* input = node_map_->GetNode(NodeName(node.input(0)));\n   CHECK(input != nullptr) << \"node = \" << node.name()\n                           << \" input = \" << node.input(0);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "142a83c2d5dcfe1c08795c2f3939c9eb02687597",
            "date": "2025-01-14T22:43:34Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "359517872b9281259b49f7186a9de6382598d7ee",
            "date": "2025-01-14T22:18:13Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "d93cc4f4f767f0d4a72f2fafcc59005be939c019",
            "date": "2025-01-14T20:36:32Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "d4e4516cc7d11a68a81a82227f3a432f7ab350a0",
            "date": "2025-01-14T19:59:15Z",
            "author_login": "ddunl"
          },
          {
            "sha": "65367823d999b6a36a685617100a7bb6ce03add4",
            "date": "2025-01-14T19:58:00Z",
            "author_login": "sdasgup3"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-476",
    "description": "TensorFlow is an end-to-end open source platform for machine learning. The implementation of TrySimplify(https://github.com/tensorflow/tensorflow/blob/c22d88d6ff33031aa113e48aa3fc9aa74ed79595/tensorflow/core/grappler/optimizers/arithmetic_optimizer.cc#L390-L401) has undefined behavior due to dereferencing a null pointer in corner cases that result in optimizing a node with no inputs. The fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-05-14T20:15:16.173",
    "last_modified": "2024-11-21T06:01:30.087",
    "fix_date": "2021-04-19T16:57:01Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/e6340f0665d53716ef3197ada88936c2a5f7a2d3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4hvv-7x94-7vq8",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/e6340f0665d53716ef3197ada88936c2a5f7a2d3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-4hvv-7x94-7vq8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.099207",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}