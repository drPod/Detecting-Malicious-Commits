{
  "cve_id": "CVE-2021-31572",
  "github_data": {
    "repository": "FreeRTOS/FreeRTOS-Kernel",
    "fix_commit": "d05b9c123f2bf9090bce386a244fc934ae44db5b",
    "related_commits": [
      "d05b9c123f2bf9090bce386a244fc934ae44db5b",
      "d05b9c123f2bf9090bce386a244fc934ae44db5b"
    ],
    "patch_url": "https://github.com/FreeRTOS/FreeRTOS-Kernel/commit/d05b9c123f2bf9090bce386a244fc934ae44db5b.patch",
    "fix_commit_details": {
      "sha": "d05b9c123f2bf9090bce386a244fc934ae44db5b",
      "commit_date": "2020-12-07T19:07:31Z",
      "author": {
        "login": "cobusve",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add addition overflow check for stream buffer (#226)",
        "length": 52,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 10,
        "deletions": 2
      },
      "files": [
        {
          "filename": "stream_buffer.c",
          "status": "modified",
          "additions": 10,
          "deletions": 2,
          "patch": "@@ -258,8 +258,16 @@ static void prvInitialiseNewStreamBuffer( StreamBuffer_t * const pxStreamBuffer,\n          * this is a quirk of the implementation that means otherwise the free\r\n          * space would be reported as one byte smaller than would be logically\r\n          * expected. */\r\n-        xBufferSizeBytes++;\r\n-        pucAllocatedMemory = ( uint8_t * ) pvPortMalloc( xBufferSizeBytes + sizeof( StreamBuffer_t ) ); /*lint !e9079 malloc() only returns void*. */\r\n+        if( xBufferSizeBytes < ( xBufferSizeBytes + 1 + sizeof( StreamBuffer_t ) ) )\r\n+        {\r\n+            xBufferSizeBytes++;\r\n+            pucAllocatedMemory = ( uint8_t * ) pvPortMalloc( xBufferSizeBytes + sizeof( StreamBuffer_t ) ); /*lint !e9079 malloc() only returns void*. */\r\n+        }\r\n+        else\r\n+        {\r\n+            pucAllocatedMemory = NULL;\r\n+        }\r\n+        \r\n \r\n         if( pucAllocatedMemory != NULL )\r\n         {\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "78e0cc778ae01100ce7ca0eaf838567cd19f9720",
            "date": "2025-01-14T05:20:52Z",
            "author_login": "AhmedIsmail02"
          },
          {
            "sha": "c38427eea442b5a58b0b95ad88ff769be3abcc0d",
            "date": "2025-01-13T22:48:10Z",
            "author_login": "creiter64"
          },
          {
            "sha": "3a7b3082cfce01ffba07b9be1398795b8307b05a",
            "date": "2025-01-06T05:35:53Z",
            "author_login": "IotaHydrae"
          },
          {
            "sha": "e55bde213348c8911205f81e89016dd4ba2ba79d",
            "date": "2024-12-30T09:11:52Z",
            "author_login": "jiladahe1997"
          },
          {
            "sha": "f05244a8d55b23428c4a8c097d375d12a9d6e30d",
            "date": "2024-12-30T08:58:49Z",
            "author_login": "felixvanoost"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-190",
    "description": "The kernel in Amazon Web Services FreeRTOS before 10.4.3 has an integer overflow in stream_buffer.c for a stream buffer.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-04-22T18:15:08.547",
    "last_modified": "2024-11-21T06:05:55.653",
    "fix_date": "2020-12-07T19:07:31Z"
  },
  "references": [
    {
      "url": "https://github.com/FreeRTOS/FreeRTOS-Kernel/commit/d05b9c123f2bf9090bce386a244fc934ae44db5b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreeRTOS/FreeRTOS-Kernel/commit/d05b9c123f2bf9090bce386a244fc934ae44db5b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:33.550565",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "FreeRTOS-Kernel",
    "owner": "FreeRTOS",
    "created_at": "2019-09-09T16:28:01Z",
    "updated_at": "2025-01-14T05:20:58Z",
    "pushed_at": "2025-01-14T05:20:52Z",
    "size": 119555,
    "stars": 2942,
    "forks": 1179,
    "open_issues": 24,
    "watchers": 2942,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "smp"
    ],
    "languages": {
      "C": 13512620,
      "Assembly": 1346270,
      "CMake": 75487,
      "Python": 9730,
      "Batchfile": 6591
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:10:09.806841"
  }
}