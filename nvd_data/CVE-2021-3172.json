{
  "cve_id": "CVE-2021-3172",
  "github_data": {
    "repository": "PHPFusion/PHPFusion",
    "fix_commit": "7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e",
    "related_commits": [
      "7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e",
      "7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e"
    ],
    "patch_url": "https://github.com/PHPFusion/PHPFusion/commit/7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e.patch",
    "fix_commit_details": {
      "sha": "7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e",
      "commit_date": "2021-01-14T03:57:43Z",
      "author": {
        "login": "FrederickChan",
        "type": "User",
        "stats": {
          "total_commits": 5132,
          "average_weekly_commits": 9.486136783733826,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 190
        }
      },
      "commit_message": {
        "title": "#2351 - User IP fixes, and Poll Voting form token to 1 count per screen refresh.",
        "length": 80,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "includes/core_functions_include.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1973,7 +1973,7 @@ function fusion_get_username($user_id) {\n function fusion_get_userdata($key = NULL) {\n     global $userdata;\n     if (empty($userdata)) {\n-        $userdata = [\"user_level\" => 0, \"user_rights\" => \"\", \"user_groups\" => \"\", \"user_theme\" => 'Default'];\n+        $userdata = [\"user_level\" => 0, \"user_rights\" => \"\", \"user_groups\" => \"\", \"user_theme\" => 'Default', \"user_ip\"=>USER_IP];\n     }\n     $userdata = $userdata + [\n             \"user_id\"     => 0,"
        },
        {
          "filename": "infusions/member_poll_panel/poll_classes.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -455,9 +455,10 @@ public function DisplayPoll() {\n                     $render['poll_table'][0]['poll_option'][] = form_checkbox('check', $data1, '-1', ['reverse_label' => TRUE, 'type' => 'radio', 'value' => $im1, 'input_id' => 'check-'.$im1]);\n                 }\n \n-                $render['poll_table'][0]['openform'] = openform('voteform', 'post', clean_request(), ['enctype' => TRUE]).form_hidden('poll_id', '', $data['poll_id']);\n+                $render['poll_table'][0]['openform'] = openform('voteform', 'post', clean_request(), ['max_tokens'=>1]).form_hidden('poll_id', '', $data['poll_id']);\n                 $render['poll_table'][0]['button'] = form_button(\"cast_vote\", self::$locale['POLL_020'], self::$locale['POLL_020'], ['class' => 'btn-primary']);\n                 $render['poll_table'][0]['closeform'] = closeform();\n+\n             } else {\n                 if (!empty($data['poll_title']) && $data['poll_started'] < time()) {\n                     $render['poll_table'][0]['max_vote'] = $this->_countVote(\"poll_id='\".$data['poll_id'].\"'\");"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "33adaef9006de1c8d11a1444f3e1731490c8ce71",
            "date": "2024-12-30T10:25:01Z",
            "author_login": "karrak1"
          },
          {
            "sha": "1be014a291a150703e76871ff440a44224d4bd4e",
            "date": "2024-03-17T05:45:56Z",
            "author_login": "FrederickChan"
          },
          {
            "sha": "5b126ab6ecfde00d64c690daa1f1133357695a13",
            "date": "2024-01-03T08:34:01Z",
            "author_login": "karrak1"
          },
          {
            "sha": "233d9c08108f8ef3ad9c0034866a3fcb7d5c7996",
            "date": "2024-01-02T07:39:14Z",
            "author_login": "karrak1"
          },
          {
            "sha": "a1f44ee9178a7e4e18d1b850fa3449ba50f75e37",
            "date": "2024-01-02T05:43:17Z",
            "author_login": "karrak1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H",
    "cwe_id": null,
    "description": "An issue in Php-Fusion v9.03.90 fixed in v9.10.00 allows authenticated attackers to cause a Distributed Denial of Service via the Polling feature.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-17T18:15:11.680",
    "last_modified": "2024-11-21T06:21:03.290",
    "fix_date": "2021-01-14T03:57:43Z"
  },
  "references": [
    {
      "url": "https://github.com/PHPFusion/PHPFusion/commit/7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/PHPFusion/PHPFusion/issues/2351",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/PHPFusion/PHPFusion/commit/7b8df6925cc7cfd8585d4f34d9120ff3a2e5753e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/PHPFusion/PHPFusion/issues/2351",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.075244",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PHPFusion",
    "owner": "PHPFusion",
    "created_at": "2014-09-12T16:09:39Z",
    "updated_at": "2024-12-30T10:25:08Z",
    "pushed_at": "2024-12-30T10:25:01Z",
    "size": 132699,
    "stars": 113,
    "forks": 118,
    "open_issues": 32,
    "watchers": 113,
    "has_security_policy": false,
    "default_branch": "Andromeda",
    "protected_branches": [],
    "languages": {
      "PHP": 8472574,
      "JavaScript": 1512882,
      "CSS": 566377,
      "Twig": 217064,
      "Less": 211817,
      "HTML": 169304
    },
    "commit_activity": {
      "total_commits_last_year": 2,
      "avg_commits_per_week": 0.038461538461538464,
      "days_active_last_year": 2
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:53:48.924788"
  }
}