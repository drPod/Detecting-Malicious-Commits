{
  "cve_id": "CVE-2021-32435",
  "github_data": {
    "repository": "leesavide/abcm2ps",
    "fix_commit": "3169ace6d63f6f517a64e8df0298f44a490c4a15",
    "related_commits": [
      "3169ace6d63f6f517a64e8df0298f44a490c4a15",
      "3169ace6d63f6f517a64e8df0298f44a490c4a15"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3169ace6d63f6f517a64e8df0298f44a490c4a15",
      "commit_date": "2021-04-27T14:39:19Z",
      "author": {
        "login": "moinejf",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: crash when accidental without a note at start of line after K:",
        "length": 79,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 10,
        "deletions": 7
      },
      "files": [
        {
          "filename": "abcparse.c",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -2040,10 +2040,10 @@ static int parse_line(char *p)\n \t\tcase CHAR_NOTE:\n \t\t\tp = parse_note(p - 1, flags);\n \t\t\tflags &= ABC_F_GRACE;\n-\t\t\tparse.last_sym->u.note.slur_st = slur;\n-\t\t\tslur = 0;\n-\t\t\tif (parse.last_sym->u.note.notes[0].len > 0) /* if not space */\n-\t\t\t\tcurvoice->last_note = parse.last_sym;\n+\t\t\tif (slur && parse.last_sym->u.note.notes[0].len) {\n+\t\t\t\tparse.last_sym->u.note.slur_st = slur;\n+\t\t\t\tslur = 0;\n+\t\t\t}\n \t\t\tbreak;\n \t\tcase CHAR_SLASH:\t\t/* '/' */\n \t\t\tif (flags & ABC_F_GRACE)\n@@ -2078,9 +2078,10 @@ static int parse_line(char *p)\n \t\t\tif (p[1] != ':') {\n \t\t\t\tp = parse_note(p - 1, flags); /* chord */\n \t\t\t\tflags &= ABC_F_GRACE;\n-\t\t\t\tparse.last_sym->u.note.slur_st = slur;\n-\t\t\t\tslur = 0;\n-\t\t\t\tcurvoice->last_note = parse.last_sym;\n+\t\t\t\tif (slur && parse.last_sym->u.note.notes[0].len) {\n+\t\t\t\t\tparse.last_sym->u.note.slur_st = slur;\n+\t\t\t\t\tslur = 0;\n+\t\t\t\t}\n \t\t\t\tbreak;\n \t\t\t}\n \n@@ -2511,6 +2512,8 @@ static char *parse_note(char *p,\n \t\tsyntax(\"Not a note in grace note sequence\", p);\n \t\tgoto err;\n \t}\n+\tif (s->u.note.notes[0].len > 0) /* if not space */\n+\t\tcurvoice->last_note = s;\n \treturn p;\n \n err:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4b7651586efbbd70fe757e64fbcff635c3e6530a",
            "date": "2024-09-08T15:32:09Z",
            "author_login": "moinejf"
          },
          {
            "sha": "1727eeee4a49e8bca568385eb7844856b402f61f",
            "date": "2024-09-08T13:54:48Z",
            "author_login": "hkiel"
          },
          {
            "sha": "122bd809dac9a0a30671805385c0de67ba533d99",
            "date": "2024-05-11T13:01:43Z",
            "author_login": "moinejf"
          },
          {
            "sha": "873b49b4b16f6c4fd15f3993ac762900404c30c7",
            "date": "2024-05-11T12:49:41Z",
            "author_login": "moinejf"
          },
          {
            "sha": "b09f9c24bb96c10b5596be27b3362bb954a857fa",
            "date": "2024-03-18T10:36:46Z",
            "author_login": "moinejf"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-787",
    "description": "Stack-based buffer overflow in the function get_key in parse.c of abcm2ps v8.14.11 allows remote attackers to cause a Denial of Service (DoS) via unspecified vectors.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-03-10T17:42:14.457",
    "last_modified": "2024-11-21T06:07:02.823",
    "fix_date": "2021-04-27T14:39:19Z"
  },
  "references": [
    {
      "url": "https://github.com/leesavide/abcm2ps/commit/3169ace6d63f6f517a64e8df0298f44a490c4a15",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/leesavide/abcm2ps/issues/84",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/04/msg00015.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6333SXWMES3K22DBAOAW34G6EU6WIJEY/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EVGJH4HMXI3TWMHQJQCG3M7KSXJWJM7R/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YTF4FXCW22FFB5HNQO3GK3F4FFBLTZKE/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/leesavide/abcm2ps/commit/3169ace6d63f6f517a64e8df0298f44a490c4a15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/leesavide/abcm2ps/issues/84",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/04/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6333SXWMES3K22DBAOAW34G6EU6WIJEY/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EVGJH4HMXI3TWMHQJQCG3M7KSXJWJM7R/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YTF4FXCW22FFB5HNQO3GK3F4FFBLTZKE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.789440",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "abcm2ps",
    "owner": "leesavide",
    "created_at": "2012-10-16T03:44:57Z",
    "updated_at": "2025-01-10T11:33:11Z",
    "pushed_at": "2024-09-08T15:32:09Z",
    "size": 3153,
    "stars": 86,
    "forks": 31,
    "open_issues": 34,
    "watchers": 86,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 788840,
      "Makefile": 1715,
      "HTML": 1048,
      "PostScript": 193
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:12:07.944912"
  }
}