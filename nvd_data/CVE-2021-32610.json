{
  "cve_id": "CVE-2021-32610",
  "github_data": {
    "repository": "pear/Archive_Tar",
    "fix_commit": "7789ebb2f34f9e4adb3a4152ad0d1548930a9755",
    "related_commits": [
      "7789ebb2f34f9e4adb3a4152ad0d1548930a9755",
      "b5832439b1f37331fb4f87e67fe4f",
      "7789ebb2f34f9e4adb3a4152ad0d1548930a9755",
      "b5832439b1f37331fb4f87e67fe4f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7789ebb2f34f9e4adb3a4152ad0d1548930a9755",
      "commit_date": "2021-09-07T07:21:19Z",
      "author": {
        "login": "mrook",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #40 from mcdruid/master",
        "length": 128,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 54,
        "additions": 54,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tests/evil_symlink_win.phpt",
          "status": "added",
          "additions": 24,
          "deletions": 0,
          "patch": "@@ -0,0 +1,24 @@\n+--TEST--\n+tests extraction of out-of-path symlink with a windows path\n+--SKIPIF--\n+--FILE--\n+<?php\n+require_once dirname(__FILE__) . '/setup.php.inc';\n+$extract_target = dirname(__FILE__) . '/evil_symlink_win';\n+mkdir($extract_target, 0777, TRUE);\n+$tar = new Archive_Tar(dirname(__FILE__) . '/evil_symlink_win.tar');\n+$tar->extract($extract_target);\n+// On Windows dirname() will have used backslashes but the error messages do not.\n+$extract_target = str_replace('\\\\', '/', $extract_target);\n+$phpunit->assertErrors(array(array('package' => 'PEAR_Error', 'message' => 'Out-of-path file extraction {' . $extract_target . '/evil.txt --> C:\\windows\\system.ini}')), 'after 1');\n+// N.B. file_exists() typically will not detect a broken symbolic link\n+$phpunit->assertFalse(is_link($extract_target . '/evil.txt'), 'Out-of-path symlink should not have succeeded');\n+echo 'tests done';\n+?>\n+--CLEAN--\n+<?php\n+unlink(dirname(__FILE__) . '/evil_symlink_win/evil.txt');\n+rmdir(dirname(__FILE__) . '/evil_symlink_win');\n+?>\n+--EXPECT--\n+tests done"
        },
        {
          "filename": "tests/evil_symlink_win.tar",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/out_of_path_relative.phpt",
          "status": "added",
          "additions": 30,
          "deletions": 0,
          "patch": "@@ -0,0 +1,30 @@\n+--TEST--\n+tests extraction of out-of-path symlink\n+--SKIPIF--\n+--FILE--\n+<?php\n+require_once dirname(__FILE__) . '/setup.php.inc';\n+$extract_target = dirname(__FILE__) . '/one/two/three/four';\n+mkdir($extract_target, 0777, TRUE);\n+file_put_contents(dirname(__FILE__) . '/one/two/secret.txt', 'password1');\n+$tar = new Archive_Tar(dirname(__FILE__) . '/out_of_path_relative.tar');\n+$tar->extract($extract_target);\n+// On Windows dirname() will have used backslashes but the error messages do not.\n+$extract_target = str_replace('\\\\', '/', $extract_target);\n+$phpunit->assertErrors(array(array('package' => 'PEAR_Error', 'message' => 'Out-of-path file extraction {' . $extract_target . '/five/six/evil.txt --> ../../../../secret.txt}')), 'after 1');\n+$phpunit->assertFileNotExists($extract_target . '/five/six/evil.txt', 'Out-of-path symlink should not have succeeded');\n+echo 'tests done';\n+?>\n+--CLEAN--\n+<?php\n+unlink(dirname(__FILE__) . '/one/two/secret.txt');\n+unlink(dirname(__FILE__) . '/one/two/three/four/five/six/evil.txt');\n+rmdir(dirname(__FILE__) . '/one/two/three/four/five/six');\n+rmdir(dirname(__FILE__) . '/one/two/three/four/five');\n+rmdir(dirname(__FILE__) . '/one/two/three/four');\n+rmdir(dirname(__FILE__) . '/one/two/three');\n+rmdir(dirname(__FILE__) . '/one/two');\n+rmdir(dirname(__FILE__) . '/one');\n+?>\n+--EXPECT--\n+tests done"
        },
        {
          "filename": "tests/out_of_path_relative.tar",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 4,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "36778513c36ef464a82757627d672468646ae382",
            "date": "2024-11-24T22:35:52Z",
            "author_login": "ashnazg"
          },
          {
            "sha": "3abb0c27d5f493484cd6be71543ed2f7a954ca83",
            "date": "2024-11-24T20:48:54Z",
            "author_login": "mcdruid"
          },
          {
            "sha": "6b91932f07efbcf790fee38981c9e79d4029c3a9",
            "date": "2024-11-24T20:42:51Z",
            "author_login": "mcdruid"
          },
          {
            "sha": "ba360e066c4f26995b19c7b07d8172964e5dad22",
            "date": "2024-11-24T20:31:20Z",
            "author_login": "mcdruid"
          },
          {
            "sha": "87e03d0e9a012d406bfa1ecfce64236142f2cffa",
            "date": "2024-11-24T20:07:28Z",
            "author_login": "mcdruid"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-59",
    "description": "In Archive_Tar before 1.4.14, symlinks can refer to targets outside of the extracted archive, a different vulnerability than CVE-2020-36193.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-30T14:15:16.940",
    "last_modified": "2024-11-21T06:07:22.480",
    "fix_date": "2021-09-07T07:21:19Z"
  },
  "references": [
    {
      "url": "https://github.com/pear/Archive_Tar/commit/7789ebb2f34f9e4adb3a4152ad0d1548930a9755",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pear/Archive_Tar/commit/b5832439b1f37331fb4f87e67fe4f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pear/Archive_Tar/releases/tag/1.4.14",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/07/msg00023.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/42GPGVVFTLJYAKRI75IVB5R45NYQGEUR/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CAODVMHGL5MHQWQAQTXQ7G7OE3VQZ7LS/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/G5LTY6COQYNMMHQJ3QIOJHEWCKD4XDFH/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VJQQYDAOWHD6RDITDRPHFW7WY6BS3V5N/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://www.drupal.org/sa-core-2021-004",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pear/Archive_Tar/commit/7789ebb2f34f9e4adb3a4152ad0d1548930a9755",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pear/Archive_Tar/commit/b5832439b1f37331fb4f87e67fe4f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pear/Archive_Tar/releases/tag/1.4.14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/07/msg00023.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/42GPGVVFTLJYAKRI75IVB5R45NYQGEUR/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CAODVMHGL5MHQWQAQTXQ7G7OE3VQZ7LS/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/G5LTY6COQYNMMHQJ3QIOJHEWCKD4XDFH/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VJQQYDAOWHD6RDITDRPHFW7WY6BS3V5N/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.drupal.org/sa-core-2021-004",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.349064",
    "processing_status": "enhanced"
  }
}