{
  "cve_id": "CVE-2021-32645",
  "github_data": {
    "repository": "tenancy/multi-tenant",
    "fix_commit": "9c837a21bccce9bcaeb90033ef200d84f0d9e164",
    "related_commits": [
      "9c837a21bccce9bcaeb90033ef200d84f0d9e164",
      "9c837a21bccce9bcaeb90033ef200d84f0d9e164"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "9c837a21bccce9bcaeb90033ef200d84f0d9e164",
      "commit_date": "2021-05-27T04:40:08Z",
      "author": {
        "login": "JaZo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Trim slashes from request uri before redirecting (#1001)",
        "length": 56,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/Middleware/HostnameActions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -95,7 +95,7 @@ protected function secure(Hostname $hostname, Request $request)\n     {\n         $this->emitEvent(new Secured($hostname));\n \n-        return $this->redirect->secure($request->getRequestUri());\n+        return $this->redirect->secure(ltrim($request->getRequestUri(), '/'));\n     }\n \n     /**"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2beff8fbe999957050bf9e82904ca637b3256c26",
            "date": "2023-08-18T18:02:02Z",
            "author_login": "ArlonAntonius"
          },
          {
            "sha": "29eebfbcb42e96fa487d760883a9302909d7ffaf",
            "date": "2023-08-12T11:57:47Z",
            "author_login": "ArlonAntonius"
          },
          {
            "sha": "9bf47c059408b2911e59f497eda5505c722b2b15",
            "date": "2023-08-12T11:48:07Z",
            "author_login": "ArlonAntonius"
          },
          {
            "sha": "b2783fd7cd9b851f720241805fe6522aaabcefbf",
            "date": "2023-08-12T11:45:09Z",
            "author_login": "ArlonAntonius"
          },
          {
            "sha": "fffde4673d7561b47eaf3a8bc6089c2b17fa9a65",
            "date": "2023-08-12T11:41:24Z",
            "author_login": "ArlonAntonius"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-601",
    "description": "Tenancy multi-tenant is an open source multi-domain controller for the Laravel web framework. In some situations, it is possible to have open redirects where users can be redirected from your site to any other site using a specially crafted URL. This is only the case for installations where the default Hostname Identification is used and the environment uses tenants that have `force_https` set to `true` (default: `false`). Version 5.7.2 contains the relevant patches to fix this bug. Stripping the URL from special characters to prevent specially crafted URL's from being redirected to. As a work around users can set the `force_https` to every tenant to `false`, however this may degrade connection security.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-05-27T17:15:08.127",
    "last_modified": "2024-11-21T06:07:26.863",
    "fix_date": "2021-05-27T04:40:08Z"
  },
  "references": [
    {
      "url": "https://github.com/tenancy/multi-tenant/commit/9c837a21bccce9bcaeb90033ef200d84f0d9e164",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tenancy/multi-tenant/security/advisories/GHSA-4r8q-gv9j-3xx6",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packagist.org/packages/hyn/multi-tenant",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://webmasters.googleblog.com/2009/01/open-redirect-urls-is-your-site-being.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tenancy/multi-tenant/commit/9c837a21bccce9bcaeb90033ef200d84f0d9e164",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tenancy/multi-tenant/security/advisories/GHSA-4r8q-gv9j-3xx6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://packagist.org/packages/hyn/multi-tenant",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://webmasters.googleblog.com/2009/01/open-redirect-urls-is-your-site-being.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:57.126628",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "multi-tenant",
    "owner": "tenancy",
    "created_at": "2015-07-23T18:48:06Z",
    "updated_at": "2025-01-24T12:18:33Z",
    "pushed_at": "2024-05-11T16:32:40Z",
    "size": 1586,
    "stars": 2566,
    "forks": 396,
    "open_issues": 75,
    "watchers": 2566,
    "has_security_policy": false,
    "default_branch": "5.x",
    "protected_branches": [
      "1.x",
      "2.x",
      "3.x",
      "4.x",
      "5.x",
      "5.0",
      "5.1"
    ],
    "languages": {
      "PHP": 315360,
      "Blade": 2824,
      "Shell": 1872
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:02:03.596170"
  }
}