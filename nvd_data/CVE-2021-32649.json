{
  "cve_id": "CVE-2021-32649",
  "github_data": {
    "repository": "octobercms/october",
    "fix_commit": "167b592eed291ae1563c8fcc5b9b34a03a300f26",
    "related_commits": [
      "167b592eed291ae1563c8fcc5b9b34a03a300f26",
      "167b592eed291ae1563c8fcc5b9b34a03a300f26"
    ],
    "patch_url": "https://github.com/octobercms/october/commit/167b592eed291ae1563c8fcc5b9b34a03a300f26.patch",
    "fix_commit_details": {
      "sha": "167b592eed291ae1563c8fcc5b9b34a03a300f26",
      "commit_date": "2021-05-29T05:00:08Z",
      "author": {
        "login": "daftspunk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Backport fixes from 2.0",
        "length": 23,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
      },
      "files": [
        {
          "filename": "modules/cms/controllers/Themes.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -265,6 +265,10 @@ protected function makeExportFormWidget($theme)\n \n     public function index_onLoadImportForm()\n     {\n+        if (\\Cms\\Helpers\\Cms::safeModeEnabled()) {\n+            throw new ApplicationException(trans('cms::lang.cms_object.safe_mode_enabled'));\n+        }\n+\n         $theme = $this->findThemeObject();\n         $this->vars['widget'] = $this->makeImportFormWidget($theme);\n         $this->vars['themeDir'] = $theme->getDirName();\n@@ -274,6 +278,10 @@ public function index_onLoadImportForm()\n \n     public function index_onImport()\n     {\n+        if (\\Cms\\Helpers\\Cms::safeModeEnabled()) {\n+            throw new ApplicationException(trans('cms::lang.cms_object.safe_mode_enabled'));\n+        }\n+\n         $theme = $this->findThemeObject();\n         $widget = $this->makeImportFormWidget($theme);\n "
        },
        {
          "filename": "modules/system/twig/SecurityPolicy.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -18,18 +18,22 @@ final class SecurityPolicy implements SecurityPolicyInterface\n      * @var array List of forbidden methods.\n      */\n     protected $blockedMethods = [\n-        // \\October\\Rain\\Extension\\ExtendableTrait\n+        // Prevent manipulating Twig itself\n+        'getTwig',\n+\n+        // Prevent dynamic methods and props\n         'addDynamicMethod',\n         'addDynamicProperty',\n \n-        // \\October\\Rain\\Support\\Traits\\Emitter\n+        // Prevent binding event logic\n         'bindEvent',\n         'bindEventOnce',\n \n         // Eloquent & Halcyon data modification\n         'insert',\n         'update',\n         'delete',\n+        'write',\n     ];\n \n     /**"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "45fe601f47cdd3e25a4a667c6b9a622b003c006a",
            "date": "2024-11-25T21:28:07Z",
            "author_login": "daftspunk"
          },
          {
            "sha": "ff1816942cf629286f1b1a482595ef005281a14c",
            "date": "2024-11-11T22:11:58Z",
            "author_login": "daftspunk"
          },
          {
            "sha": "5877d59e2b999852e60b85e6bbce132ac4ab2993",
            "date": "2024-10-17T23:14:13Z",
            "author_login": "daftspunk"
          },
          {
            "sha": "45e757608ae65060ecd0b78e70f5c5c824fdd7f1",
            "date": "2024-10-17T22:10:49Z",
            "author_login": "daftspunk"
          },
          {
            "sha": "f6aa7503065681cbdc18b905e92d51b1a4a94aff",
            "date": "2024-10-16T21:43:54Z",
            "author_login": "daftspunk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-74",
    "description": "October CMS is a self-hosted content management system (CMS) platform based on the Laravel PHP Framework. Prior to versions 1.0.473 and 1.1.6, an attacker with \"create, modify and delete website pages\" privileges in the backend is able to execute PHP code by running specially crafted Twig code in the template markup. The issue has been patched in Build 473 (v1.0.473) and v1.1.6. Those unable to upgrade may apply the patch to their installation manually as a workaround.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-01-14T15:15:07.523",
    "last_modified": "2024-11-21T06:07:27.430",
    "fix_date": "2021-05-29T05:00:08Z"
  },
  "references": [
    {
      "url": "https://github.com/octobercms/october/commit/167b592eed291ae1563c8fcc5b9b34a03a300f26",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/octobercms/october/security/advisories/GHSA-wv23-pfj7-2mjj",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/octobercms/october/commit/167b592eed291ae1563c8fcc5b9b34a03a300f26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/octobercms/october/security/advisories/GHSA-wv23-pfj7-2mjj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.027012",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "october",
    "owner": "octobercms",
    "created_at": "2013-11-26T23:30:43Z",
    "updated_at": "2025-01-13T15:19:04Z",
    "pushed_at": "2025-01-12T01:37:43Z",
    "size": 53556,
    "stars": 11056,
    "forks": 2205,
    "open_issues": 3,
    "watchers": 11056,
    "has_security_policy": false,
    "default_branch": "3.x",
    "protected_branches": [],
    "languages": {
      "PHP": 2058174,
      "HTML": 84753,
      "Less": 48913,
      "JavaScript": 22950,
      "CSS": 11828,
      "Hack": 1770
    },
    "commit_activity": {
      "total_commits_last_year": 29,
      "avg_commits_per_week": 0.5576923076923077,
      "days_active_last_year": 23
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:31:49.007671"
  }
}