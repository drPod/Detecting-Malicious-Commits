{
  "cve_id": "CVE-2021-32673",
  "github_data": {
    "repository": "reg-viz/reg-suit",
    "fix_commit": "f84ad9c7a22144d6c147dc175c52756c0f444d87",
    "related_commits": [
      "f84ad9c7a22144d6c147dc175c52756c0f444d87",
      "f84ad9c7a22144d6c147dc175c52756c0f444d87"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f84ad9c7a22144d6c147dc175c52756c0f444d87",
      "commit_date": "2021-06-08T02:18:59Z",
      "author": {
        "login": "Quramy",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-49q3-8867-5wmp",
        "length": 69,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 18,
        "deletions": 5
      },
      "files": [
        {
          "filename": "packages/reg-keygen-git-hash-plugin/package.json",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -23,10 +23,12 @@\n   \"repository\": \"git+https://github.com/reg-viz/reg-suit.git\",\n   \"license\": \"MIT\",\n   \"dependencies\": {\n-    \"reg-suit-util\": \"^0.10.15\"\n+    \"reg-suit-util\": \"^0.10.15\",\n+    \"shell-escape\": \"^0.2.0\"\n   },\n   \"devDependencies\": {\n     \"@types/jest\": \"26.0.23\",\n+    \"@types/shell-escape\": \"0.2.0\",\n     \"glob\": \"7.1.6\",\n     \"jest\": \"26.6.3\",\n     \"reg-suit-interface\": \"^0.10.15\","
        },
        {
          "filename": "packages/reg-keygen-git-hash-plugin/src/git-cmd-client.ts",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -1,4 +1,5 @@\n import { execSync } from \"child_process\";\n+import shellEscape from \"shell-escape\";\n \n export class GitCmdClient {\n   private _revParseHash: { [key: string]: string } = {};\n@@ -19,22 +20,22 @@ export class GitCmdClient {\n   }\n \n   containedBranches(hash: string): string {\n-    return execSync(`git branch -a --contains ${hash}`, { encoding: \"utf8\" });\n+    return execSync(shellEscape([\"git\", \"branch\", \"-a\", \"--contains\", hash]), { encoding: \"utf8\" });\n   }\n \n   logTime(hash: string) {\n-    return execSync(`git log --pretty=%ci -n 1 ${hash}`, { encoding: \"utf8\" });\n+    return execSync(shellEscape([\"git\", \"log\", \"--pretty=%ci\", \"-n\", \"1\", hash]), { encoding: \"utf8\" });\n   }\n \n   logBetween(a: string, b: string) {\n-    return execSync(`git log --oneline ${a}..${b}`, { encoding: \"utf8\" });\n+    return execSync(shellEscape([\"git\", \"log\", \"--oneline\", `${a}..${b}`]), { encoding: \"utf8\" });\n   }\n \n   logGraph() {\n     return execSync('git log -n 300 --graph --pretty=format:\"%h %p\"', { encoding: \"utf8\" });\n   }\n \n   mergeBase(a: string, b: string) {\n-    return execSync(`git merge-base -a ${a} ${b}`, { encoding: \"utf8\" });\n+    return execSync(shellEscape([\"git\", \"merge-base\", \"-a\", a, b]), { encoding: \"utf8\" });\n   }\n }"
        },
        {
          "filename": "yarn.lock",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -1760,6 +1760,11 @@\n     \"@types/tough-cookie\" \"*\"\n     form-data \"^2.5.0\"\n \n+\"@types/shell-escape@0.2.0\":\n+  version \"0.2.0\"\n+  resolved \"https://registry.yarnpkg.com/@types/shell-escape/-/shell-escape-0.2.0.tgz#cd2f0df814388599dd07196dcc510de2669d1ed2\"\n+  integrity sha512-7kUdtJtUylvyISJbe9FMcvMTjRdP0EvNDO1WbT0lT22k/IPBiPRTpmWaKu5HTWLCGLQRWVHrzVHZktTDvvR23g==\n+\n \"@types/sinon@10.0.2\":\n   version \"10.0.2\"\n   resolved \"https://registry.yarnpkg.com/@types/sinon/-/sinon-10.0.2.tgz#f360d2f189c0fd433d14aeb97b9d705d7e4cc0e4\"\n@@ -8073,6 +8078,11 @@ shebang-regex@^3.0.0:\n   resolved \"https://registry.yarnpkg.com/shebang-regex/-/shebang-regex-3.0.0.tgz#ae16f1644d873ecad843b0307b143362d4c42172\"\n   integrity sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==\n \n+shell-escape@^0.2.0:\n+  version \"0.2.0\"\n+  resolved \"https://registry.yarnpkg.com/shell-escape/-/shell-escape-0.2.0.tgz#68fd025eb0490b4f567a027f0bf22480b5f84133\"\n+  integrity sha1-aP0CXrBJC09WegJ/C/IkgLX4QTM=\n+\n shell-quote@^1.6.1:\n   version \"1.7.1\"\n   resolved \"https://registry.yarnpkg.com/shell-quote/-/shell-quote-1.7.1.tgz#3161d969886fb14f9140c65245a5dd19b6f0b06b\""
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d525fe0328b38e0f7150ef0f2561d71f86abcc10",
            "date": "2024-10-18T15:35:00Z",
            "author_login": "Quramy"
          },
          {
            "sha": "89fccd912b50b52a640ff650029e9469fd6e056e",
            "date": "2024-10-09T13:40:49Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "56aa9492c0184113715de464b35145f248aea291",
            "date": "2024-10-09T13:40:06Z",
            "author_login": "Quramy"
          },
          {
            "sha": "73e56669423f21ff24a3641abe4649c2f8eb1346",
            "date": "2024-10-09T08:08:40Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "f8320472facc7573ef3a3373092e29a97126906c",
            "date": "2024-09-19T14:51:03Z",
            "author_login": "Quramy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L",
    "cwe_id": "CWE-94",
    "description": "reg-keygen-git-hash-plugin is a reg-suit plugin to detect the snapshot key to be compare with using Git commit hash. reg-keygen-git-hash-plugin through and including 0.10.15 allow remote attackers to execute of arbitrary commands. Upgrade to version 0.10.16 or later to resolve this issue.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-06-08T17:15:07.747",
    "last_modified": "2024-11-21T06:07:30.233",
    "fix_date": "2021-06-08T02:18:59Z"
  },
  "references": [
    {
      "url": "https://github.com/reg-viz/reg-suit/commit/f84ad9c7a22144d6c147dc175c52756c0f444d87",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/reg-viz/reg-suit/releases/tag/v0.10.16",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/reg-viz/reg-suit/security/advisories/GHSA-49q3-8867-5wmp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/reg-keygen-git-hash-plugin",
      "source": "security-advisories@github.com",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/reg-viz/reg-suit/commit/f84ad9c7a22144d6c147dc175c52756c0f444d87",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/reg-viz/reg-suit/releases/tag/v0.10.16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/reg-viz/reg-suit/security/advisories/GHSA-49q3-8867-5wmp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/reg-keygen-git-hash-plugin",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.718036",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "reg-suit",
    "owner": "reg-viz",
    "created_at": "2017-06-26T19:23:52Z",
    "updated_at": "2025-01-24T01:58:14Z",
    "pushed_at": "2025-01-23T05:42:45Z",
    "size": 15422,
    "stars": 1192,
    "forks": 101,
    "open_issues": 63,
    "watchers": 1192,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "gh-pages"
    ],
    "languages": {
      "TypeScript": 154573,
      "Shell": 10334,
      "JavaScript": 8393,
      "HTML": 292
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:42:40.684883"
  }
}