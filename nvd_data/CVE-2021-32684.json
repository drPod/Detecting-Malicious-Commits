{
  "cve_id": "CVE-2021-32684",
  "github_data": {
    "repository": "scandipwa/create-magento-app",
    "fix_commit": "89115db7031e181eb8fb4ec2822bc6cab88e7071",
    "related_commits": [
      "89115db7031e181eb8fb4ec2822bc6cab88e7071",
      "89115db7031e181eb8fb4ec2822bc6cab88e7071"
    ],
    "patch_url": "https://github.com/scandipwa/create-magento-app/commit/89115db7031e181eb8fb4ec2822bc6cab88e7071.patch",
    "fix_commit_details": {
      "sha": "89115db7031e181eb8fb4ec2822bc6cab88e7071",
      "commit_date": "2021-06-08T13:37:58Z",
      "author": {
        "login": "ejnshtein",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed exec and logs command throwing an error with docker.getContainers",
        "length": 71,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "build-packages/magento-scripts/lib/commands/execute.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -4,7 +4,7 @@ const executeInContainer = require('../tasks/execute');\n \n module.exports = (yargs) => {\n     yargs.command('exec <container name> [commands...]', 'Execute command in docker container', () => {}, async (argv) => {\n-        const containers = docker.getContainers();\n+        const containers = (await docker).getContainers();\n         const services = Object.keys(containers);\n \n         if (services.includes(argv.containername) || services.some((service) => service.includes(argv.containername))) {"
        },
        {
          "filename": "build-packages/magento-scripts/lib/commands/logs.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -60,7 +60,7 @@ module.exports = (yargs) => {\n             );\n         },\n         async (argv) => {\n-            const containers = docker.getContainers();\n+            const containers = (await docker).getContainers();\n             const services = Object.keys(containers);\n \n             if (services.includes(argv.scope) || services.some((service) => service.includes(argv.scope))) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c70e000b5a6d8f650e094ff5ce7c4c0ac671dd0c",
            "date": "2024-12-16T16:45:50Z",
            "author_login": "ejnshtein"
          },
          {
            "sha": "d1799e0d90c79018a4c9893bcc52c89c875d2404",
            "date": "2024-12-16T16:45:16Z",
            "author_login": "ejnshtein"
          },
          {
            "sha": "34550a6463f6b9c33f766805a0b58b3a5aae0bba",
            "date": "2024-12-16T16:43:16Z",
            "author_login": "ejnshtein"
          },
          {
            "sha": "1b753337f649cf9e6eac4282538e7f03358d092c",
            "date": "2024-12-11T17:01:48Z",
            "author_login": "ejnshtein"
          },
          {
            "sha": "6b40ea9b17f3658d7f809fdabf8c4a04c4b8ce4d",
            "date": "2024-10-09T15:49:18Z",
            "author_login": "ejnshtein"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.2,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-670",
    "description": "magento-scripts contains scripts and configuration used by Create Magento App, a zero-configuration tool-chain which allows one to deploy Magento 2. In versions 1.5.1 and 1.5.2, after changing the function from synchronous to asynchronous there wasn't implemented handler in the start, stop, exec, and logs commands, effectively making them unusable. Version 1.5.3 contains patches for the problems.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-06-14T23:15:07.547",
    "last_modified": "2024-11-21T06:07:31.613",
    "fix_date": "2021-06-08T13:37:58Z"
  },
  "references": [
    {
      "url": "https://github.com/scandipwa/create-magento-app/commit/89115db7031e181eb8fb4ec2822bc6cab88e7071",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scandipwa/create-magento-app/security/advisories/GHSA-52qp-gwwh-qrg4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scandipwa/create-magento-app/commit/89115db7031e181eb8fb4ec2822bc6cab88e7071",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scandipwa/create-magento-app/security/advisories/GHSA-52qp-gwwh-qrg4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.732381",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "create-magento-app",
    "owner": "scandipwa",
    "created_at": "2020-11-10T17:25:32Z",
    "updated_at": "2024-12-16T16:45:56Z",
    "pushed_at": "2024-12-16T16:45:50Z",
    "size": 8416,
    "stars": 32,
    "forks": 21,
    "open_issues": 15,
    "watchers": 32,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 792348,
      "PHP": 197360,
      "C": 94261,
      "Dockerfile": 73306,
      "Shell": 51134,
      "Makefile": 30843,
      "C++": 21254,
      "VCL": 8787
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "osl-3.0"
    },
    "collected_at": "2025-01-14T15:45:15.085891"
  }
}