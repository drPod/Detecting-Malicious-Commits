{
  "cve_id": "CVE-2021-32724",
  "github_data": {
    "repository": "check-spelling/check-spelling",
    "fix_commit": "436362fc6b588d9d561cbdb575260ca593c8dc56",
    "related_commits": [
      "436362fc6b588d9d561cbdb575260ca593c8dc56",
      "436362fc6b588d9d561cbdb575260ca593c8dc56"
    ],
    "patch_url": "https://github.com/check-spelling/check-spelling/commit/436362fc6b588d9d561cbdb575260ca593c8dc56.patch",
    "fix_commit_details": {
      "sha": "436362fc6b588d9d561cbdb575260ca593c8dc56",
      "commit_date": "2021-07-12T19:37:53Z",
      "author": {
        "login": "jsoref",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-g86g-chm8-7r2p",
        "length": 58,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 32,
        "additions": 29,
        "deletions": 3
      },
      "files": [
        {
          "filename": "common.sh",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1,5 +1,10 @@\n #!/bin/bash\n if [ \"$INITIALIZED\" != defined ]; then\n+  if [ \"$RUNNER_OS\" = \"Windows\" ]; then\n+    echo \"::error ::Windows isn't currently supported\"\n+    exit 5\n+  fi\n+\n   now() {\n     date +'%s%N'\n   }"
        },
        {
          "filename": "spelling-unknown-word-splitter.pl",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,9 +16,9 @@\n \n # skip files that don't exist (including dangling symlinks)\n if (scalar @ARGV) {\n-  @ARGV = grep {-r || $_ eq '-'} @ARGV;\n+  @ARGV = grep {! -l && -f && -r} @ARGV;\n   unless (scalar @ARGV) {\n-    print STDERR \"None of the provided files are readable\\n\";\n+    print STDERR \"::warning ::Was not provided any regular readable files\\n\";\n     exit 0;\n   }\n }"
        },
        {
          "filename": "unknown-words.sh",
          "status": "modified",
          "additions": 22,
          "deletions": 1,
          "patch": "@@ -373,7 +373,28 @@ check_dictionary() {\n }\n \n cleanup_file() {\n-  maybe_bad=\"$1\"\n+  export maybe_bad=\"$1\"\n+\n+  result=0\n+  perl -e '\n+    use Cwd qw(abs_path);\n+    my $maybe_bad=abs_path($ENV{maybe_bad});\n+    my $workspace_path=abs_path($ENV{GITHUB_WORKSPACE});\n+    if ($maybe_bad !~ /^\\Q$workspace_path\\E/) {\n+      print \"::error ::Configuration files must live within $workspace_path...\\n\";\n+      print \"::error ::Unfortunately, file $maybe_bad appears to reside elsewhere.\\n\";\n+      exit 3;\n+    }\n+    if ($maybe_bad =~ m{/\\.git/}i) {\n+      print \"::error ::Configuration files must not live within `.git/`...\\n\";\n+      print \"::error ::Unfortunately, file $maybe_bad appears to.\\n\";\n+      exit 4;\n+    }\n+  ' || result=$?\n+  if [ $result -gt 0 ]; then\n+    quit $result\n+  fi\n+\n   type=\"$2\"\n   case \"$type\" in\n     patterns|excludes|only)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "96936aff2bf9fd5c2e49d370744ac55860fee67d",
            "date": "2024-11-01T13:21:09Z",
            "author_login": "jsoref"
          },
          {
            "sha": "67debf50669c7fc76fc8f5d7f996384535a72b77",
            "date": "2024-11-01T13:18:22Z",
            "author_login": "jsoref"
          },
          {
            "sha": "45fd1fdfd40d09862595b29ec7f492f5a7eabf89",
            "date": "2024-11-01T13:38:50Z",
            "author_login": "jsoref"
          },
          {
            "sha": "d286d554d4096a1b3754c16e5a53c7b66dbb506c",
            "date": "2024-10-23T12:01:24Z",
            "author_login": "jsoref"
          },
          {
            "sha": "9376155f1f3ca1a46f5d854397251c003458fb74",
            "date": "2024-10-27T00:05:19Z",
            "author_login": "jsoref"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-532",
    "description": "check-spelling is a github action which provides CI spell checking. In affected versions and for a repository with the [check-spelling action](https://github.com/marketplace/actions/check-spelling) enabled that triggers on `pull_request_target` (or `schedule`), an attacker can send a crafted Pull Request that causes a `GITHUB_TOKEN` to be exposed. With the `GITHUB_TOKEN`, it's possible to push commits to the repository bypassing standard approval processes. Commits to the repository could then steal any/all secrets available to the repository. As a workaround users may can either: [Disable the workflow](https://docs.github.com/en/actions/managing-workflow-runs/disabling-and-enabling-a-workflow) until you've fixed all branches or Set repository to [Allow specific actions](https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/disabling-or-limiting-github-actions-for-a-repository#allowing-specific-actions-to-run). check-spelling isn't a verified creator and it certainly won't be anytime soon. You could then explicitly add other actions that your repository uses. Set repository [Workflow permissions](https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/disabling-or-limiting-github-actions-for-a-repository#setting-the-permissions-of-the-github_token-for-your-repository) to `Read repository contents permission`. Workflows using `check-spelling/check-spelling@main` will get the fix automatically. Workflows using a pinned sha or tagged version will need to change the affected workflows for all repository branches to the latest version. Users can verify who and which Pull Requests have been running the action by looking up the spelling.yml action in the Actions tab of their repositories, e.g., https://github.com/check-spelling/check-spelling/actions/workflows/spelling.yml - you can filter PRs by adding ?query=event%3Apull_request_target, e.g., https://github.com/check-spelling/check-spelling/actions/workflows/spelling.yml?query=event%3Apull_request_target.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-09T21:15:07.250",
    "last_modified": "2024-11-21T06:07:36.343",
    "fix_date": "2021-07-12T19:37:53Z"
  },
  "references": [
    {
      "url": "https://github.com/check-spelling/check-spelling/commit/436362fc6b588d9d561cbdb575260ca593c8dc56",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/check-spelling/check-spelling/commit/436362fc6b588d9d561cbdb575260ca593c8dc56",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.743565",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "check-spelling",
    "owner": "check-spelling",
    "created_at": "2020-02-16T06:55:44Z",
    "updated_at": "2025-01-13T07:35:53Z",
    "pushed_at": "2025-01-13T14:12:37Z",
    "size": 2761,
    "stars": 265,
    "forks": 32,
    "open_issues": 21,
    "watchers": 265,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Shell": 158027,
      "Perl": 153474,
      "PHP": 1394
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T20:03:44.609917"
  }
}