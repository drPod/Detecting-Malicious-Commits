{
  "cve_id": "CVE-2021-32792",
  "github_data": {
    "repository": "zmartzone/mod_auth_openidc",
    "fix_commit": "00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
    "related_commits": [
      "00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
      "55ea0a085290cd2c8cdfdd960a230cbc38ba8b56",
      "00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
      "55ea0a085290cd2c8cdfdd960a230cbc38ba8b56"
    ],
    "patch_url": "https://github.com/zmartzone/mod_auth_openidc/commit/00c315cb0c8ab77c67be4a2ac08a71a83ac58751.patch",
    "fix_commit_details": {
      "sha": "00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
      "commit_date": "2021-06-25T09:42:57Z",
      "author": {
        "login": "zandbelt",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "avoid XSS vulnerability when using OIDCPreservePost On",
        "length": 180,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
      },
      "files": [
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -1,3 +1,7 @@\n+06/25/2021\n+- avoid XSS vulnerability when using OIDCPreservePost On and supplying URLs that contain single quotes\n+  thanks @oss-aimoto\n+\n 06/21/2021\n - strip A256GCM JWT header from encrypted JWTS used for state cookies, cache encryption and by-value session cookies\n   resulting in smaller cookies and reduced cache content size"
        },
        {
          "filename": "src/mod_auth_openidc.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -513,7 +513,7 @@ static int oidc_request_post_preserved_restore(request_rec *r,\n \t\t\t\t\t\"          input.type = \\\"hidden\\\";\\n\"\n \t\t\t\t\t\"          document.forms[0].appendChild(input);\\n\"\n \t\t\t\t\t\"        }\\n\"\n-\t\t\t\t\t\"        document.forms[0].action = '%s';\\n\"\n+\t\t\t\t\t\"        document.forms[0].action = \\\"%s\\\";\\n\"\n \t\t\t\t\t\"        document.forms[0].submit();\\n\"\n \t\t\t\t\t\"      }\\n\"\n \t\t\t\t\t\"    </script>\\n\", method, original_url);"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4d4b8e0c42b4edc3a3a343103a4f5393a3187868",
            "date": "2025-01-02T11:11:02Z",
            "author_login": "zandbelt"
          },
          {
            "sha": "afa23358b3c52c448f0d6a7d0853deec26042425",
            "date": "2025-01-02T10:48:45Z",
            "author_login": "ahus1"
          },
          {
            "sha": "1a9d3489bca4fb6eb146d5c14042431f6bb4952f",
            "date": "2025-01-02T10:11:08Z",
            "author_login": "zandbelt"
          },
          {
            "sha": "a2b1e662721757802a07c3797c3b40e389c42d1b",
            "date": "2025-01-02T10:07:28Z",
            "author_login": "zandbelt"
          },
          {
            "sha": "127e1706f836946d181366523fab89b2a79f9016",
            "date": "2024-12-17T08:06:04Z",
            "author_login": "zandbelt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-79",
    "description": "mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP server that functions as an OpenID Connect Relying Party, authenticating users against an OpenID Connect Provider. In mod_auth_openidc before version 2.4.9, there is an XSS vulnerability in when using `OIDCPreservePost On`.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-07-26T17:15:08.280",
    "last_modified": "2024-11-21T06:07:45.070",
    "fix_date": "2021-06-25T09:42:57Z"
  },
  "references": [
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/commit/00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/commit/55ea0a085290cd2c8cdfdd960a230cbc38ba8b56",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-458c-7pwg-3j7j",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/commit/00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/commit/55ea0a085290cd2c8cdfdd960a230cbc38ba8b56",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-458c-7pwg-3j7j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.340903",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mod_auth_openidc",
    "owner": "zmartzone",
    "created_at": "2014-03-27T18:54:06Z",
    "updated_at": "2025-01-11T00:58:38Z",
    "pushed_at": "2025-01-02T11:11:02Z",
    "size": 6185,
    "stars": 1003,
    "forks": 327,
    "open_issues": 0,
    "watchers": 1003,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1219433,
      "M4": 5581,
      "Makefile": 3452,
      "Shell": 62
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:04:46.206694"
  }
}