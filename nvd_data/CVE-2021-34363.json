{
  "cve_id": "CVE-2021-34363",
  "github_data": {
    "repository": "nvbn/thefuck",
    "fix_commit": "e343c577cd7da4d304b837d4a07ab4df1e023092",
    "related_commits": [
      "e343c577cd7da4d304b837d4a07ab4df1e023092",
      "e343c577cd7da4d304b837d4a07ab4df1e023092"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e343c577cd7da4d304b837d4a07ab4df1e023092",
      "commit_date": "2021-06-08T20:04:51Z",
      "author": {
        "login": "nvbn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "NA: Fix possible changes in files outside of working directory (#1206)",
        "length": 70,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 8,
        "deletions": 0
      },
      "files": [
        {
          "filename": "thefuck/rules/dirty_untar.py",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -41,6 +41,10 @@ def get_new_command(command):\n def side_effect(old_cmd, command):\n     with tarfile.TarFile(_tar_file(old_cmd.script_parts)[0]) as archive:\n         for file in archive.getnames():\n+            if not os.path.abspath(file).startswith(os.getcwd()):\n+                # it's unsafe to overwrite files outside of the current directory\n+                continue\n+\n             try:\n                 os.remove(file)\n             except OSError:"
        },
        {
          "filename": "thefuck/rules/dirty_unzip.py",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -45,6 +45,10 @@ def get_new_command(command):\n def side_effect(old_cmd, command):\n     with zipfile.ZipFile(_zip_file(old_cmd), 'r') as archive:\n         for file in archive.namelist():\n+            if not os.path.abspath(file).startswith(os.getcwd()):\n+                # it's unsafe to overwrite files outside of the current directory\n+                continue\n+\n             try:\n                 os.remove(file)\n             except OSError:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c7e7e1d884d3bb241ea6448f72a989434c2a35ec",
            "date": "2024-01-25T08:35:11Z",
            "author_login": "AlanGabbianelli"
          },
          {
            "sha": "62e0767c5069aeee176b0fe3459068b7703aaa26",
            "date": "2023-07-30T20:22:37Z",
            "author_login": "scorphus"
          },
          {
            "sha": "3cd187a3bb47351890ac7308464e1a2780507220",
            "date": "2023-07-10T13:09:27Z",
            "author_login": "gerardog"
          },
          {
            "sha": "0420442e778dd7bc53bdbdb50278eea2c207dc74",
            "date": "2023-07-10T12:43:45Z",
            "author_login": "scorphus"
          },
          {
            "sha": "617aaa1fd07271d0b370e56efd307827c085eb7c",
            "date": "2023-07-10T12:40:45Z",
            "author_login": "scorphus"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
    "cwe_id": "CWE-22",
    "description": "The thefuck (aka The Fuck) package before 3.31 for Python allows Path Traversal that leads to arbitrary file deletion via the \"undo archive operation\" feature.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-06-10T11:15:09.357",
    "last_modified": "2024-11-21T06:10:14.617",
    "fix_date": "2021-06-08T20:04:51Z"
  },
  "references": [
    {
      "url": "https://github.com/nvbn/thefuck/commit/e343c577cd7da4d304b837d4a07ab4df1e023092",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nvbn/thefuck/releases/tag/3.31",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4MEDDLBFVRUQHPYIBJ4MFM3M4NUJUXL5/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YA6UNQSOY6M3NJDZLS6YJXTS4WGDMEEJ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://vuln.ryotak.me/advisories/48",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nvbn/thefuck/commit/e343c577cd7da4d304b837d4a07ab4df1e023092",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nvbn/thefuck/releases/tag/3.31",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4MEDDLBFVRUQHPYIBJ4MFM3M4NUJUXL5/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YA6UNQSOY6M3NJDZLS6YJXTS4WGDMEEJ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://vuln.ryotak.me/advisories/48",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.722691",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "thefuck",
    "owner": "nvbn",
    "created_at": "2015-04-08T15:08:04Z",
    "updated_at": "2025-01-26T07:25:42Z",
    "pushed_at": "2024-07-19T14:56:13Z",
    "size": 4043,
    "stars": 89485,
    "forks": 3600,
    "open_issues": 368,
    "watchers": 89485,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 543910,
      "Dockerfile": 754,
      "PowerShell": 622,
      "Shell": 134,
      "Batchfile": 130
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:38:38.606217"
  }
}