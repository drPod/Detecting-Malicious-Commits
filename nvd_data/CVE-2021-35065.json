{
  "cve_id": "CVE-2021-35065",
  "github_data": {
    "repository": "gulpjs/glob-parent",
    "fix_commit": "3e9f04a3b4349db7e1962d87c9a7398cda51f339",
    "related_commits": [
      "3e9f04a3b4349db7e1962d87c9a7398cda51f339",
      "3e9f04a3b4349db7e1962d87c9a7398cda51f339"
    ],
    "patch_url": "https://github.com/gulpjs/glob-parent/commit/3e9f04a3b4349db7e1962d87c9a7398cda51f339.patch",
    "fix_commit_details": {
      "sha": "3e9f04a3b4349db7e1962d87c9a7398cda51f339",
      "commit_date": "2021-07-20T05:46:33Z",
      "author": {
        "login": "sttk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: Resolve ReDoS vulnerability from CVE-2021-35065 (#49)",
        "length": 58,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 45,
        "additions": 43,
        "deletions": 2
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 25,
          "deletions": 2,
          "patch": "@@ -6,7 +6,6 @@ var isWin32 = require('os').platform() === 'win32';\n \n var slash = '/';\n var backslash = /\\\\/g;\n-var enclosure = /[{[].*\\/.*[}\\]]$/;\n var globby = /(^|[^\\\\])([{[]|\\([^)]+$)/;\n var escaped = /\\\\([!*?|[\\](){}])/g;\n \n@@ -24,7 +23,7 @@ module.exports = function globParent(str, opts) {\n   }\n \n   // special case for strings ending in enclosure containing path separator\n-  if (enclosure.test(str)) {\n+  if (isEnclosure(str)) {\n     str += slash;\n   }\n \n@@ -39,3 +38,27 @@ module.exports = function globParent(str, opts) {\n   // remove escape chars and return result\n   return str.replace(escaped, '$1');\n };\n+\n+\n+function isEnclosure(str) {\n+  var lastChar = str.slice(-1)\n+\n+  var enclosureStart;\n+  switch (lastChar) {\n+    case '}':\n+      enclosureStart = '{';\n+      break;\n+    case ']':\n+      enclosureStart = '[';\n+      break;\n+    default:\n+      return false;\n+  }\n+\n+  var foundIndex = str.indexOf(enclosureStart);\n+  if (foundIndex < 0) {\n+    return false;\n+  }\n+\n+  return str.slice(foundIndex + 1, -1).includes(slash);\n+}"
        },
        {
          "filename": "test/index.test.js",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -224,6 +224,24 @@ describe('glob2base test patterns', function () {\n \n     done();\n   });\n+\n+  it('should finish in reasonable time for \\'{\\' + \\'/\\'.repeat(n) [CVE-2021-35065]', function(done) {\n+    this.timeout(1000);\n+    gp('{' + '/'.repeat(500000));\n+    done();\n+  });\n+\n+  it('should finish in reasonable time for \\'{\\'.repeat(n)', function(done) {\n+    this.timeout(1000);\n+    gp('{'.repeat(500000));\n+    done();\n+  });\n+\n+  it('should finish in reasonable time for \\'(\\'.repeat(n)', function(done) {\n+    this.timeout(1000);\n+    gp('('.repeat(500000));\n+    done();\n+  });\n });\n \n if (isWin32) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3a14ff5125d9fa9614dc214532327711fa6bbd93",
            "date": "2023-04-15T22:03:21Z",
            "author_login": "sttk"
          },
          {
            "sha": "3aa3ed70a996548af5b3f55250f34451ba261e19",
            "date": "2021-09-29T22:13:55Z",
            "author_login": "phated"
          },
          {
            "sha": "26ce5ecec10c687cffb9891c108fb2d2800b9140",
            "date": "2021-09-29T22:13:27Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "98c4781c215e59e629187a52b7550bd2e8e98718",
            "date": "2021-09-29T22:04:42Z",
            "author_login": "phated"
          },
          {
            "sha": "843f8de1c177e9a5c06c4cfd2349ca5207168e00",
            "date": "2021-09-29T22:04:13Z",
            "author_login": "Trott"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1333",
    "description": "The glob-parent package before 6.0.1 for Node.js allows ReDoS (regular expression denial of service) attacks against the enclosure regular expression.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-26T07:15:11.730",
    "last_modified": "2024-11-21T06:11:46.787",
    "fix_date": "2021-07-20T05:46:33Z"
  },
  "references": [
    {
      "url": "https://github.com/gulpjs/glob-parent/commit/3e9f04a3b4349db7e1962d87c9a7398cda51f339",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gulpjs/glob-parent/pull/49",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-GLOBPARENT-1314294",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gulpjs/glob-parent/commit/3e9f04a3b4349db7e1962d87c9a7398cda51f339",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gulpjs/glob-parent/pull/49",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230214-0010/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-GLOBPARENT-1314294",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.211528",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "glob-parent",
    "owner": "gulpjs",
    "created_at": "2015-01-12T20:18:40Z",
    "updated_at": "2024-12-07T00:38:13Z",
    "pushed_at": "2024-07-26T13:03:16Z",
    "size": 60,
    "stars": 80,
    "forks": 45,
    "open_issues": 7,
    "watchers": 80,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 10831
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "isc"
    },
    "collected_at": "2025-01-14T18:46:29.329526"
  }
}