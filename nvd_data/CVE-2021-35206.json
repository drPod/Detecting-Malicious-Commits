{
  "cve_id": "CVE-2021-35206",
  "github_data": {
    "repository": "gitpod-io/gitpod",
    "fix_commit": "8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5",
    "related_commits": [
      "8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5",
      "8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5"
    ],
    "patch_url": "https://github.com/gitpod-io/gitpod/commit/8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5.patch",
    "fix_commit_details": {
      "sha": "8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5",
      "commit_date": "2021-01-13T08:36:53Z",
      "author": {
        "login": "AlexTugarev",
        "type": "User",
        "stats": {
          "total_commits": 500,
          "average_weekly_commits": 2.1739130434782608,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 136
        }
      },
      "commit_message": {
        "title": "[server/auth] ensure safe returnTo param",
        "length": 40,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
      },
      "files": [
        {
          "filename": "components/server/src/user/user-controller.ts",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -81,13 +81,15 @@ export class UserController {\n             }\n \n             // Proceed with login\n+            this.ensureSafeReturnToParam(req);\n             await this.authenticator.authenticate(req, res, next);\n         });\n         router.get(\"/authorize\", (req: express.Request, res: express.Response, next: express.NextFunction) => {\n             if (!User.is(req.user)) {\n                 res.sendStatus(401);\n                 return;\n             }\n+            this.ensureSafeReturnToParam(req);\n             this.authenticator.authorize(req, res, next);\n         });\n         const branding = this.env.brandingConfig;\n@@ -483,6 +485,10 @@ export class UserController {\n         }\n     }\n \n+    protected ensureSafeReturnToParam(req: express.Request) {\n+        req.query.returnTo = this.getSafeReturnToParam(req);\n+    }\n+\n     protected getSafeReturnToParam(req: express.Request) {\n         const returnToURL: string | undefined = req.query.redirect || req.query.returnTo;\n         if (returnToURL) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c48d05d9b0313b002661fb71a524d911ce2ecc1d",
            "date": "2025-01-14T18:07:29Z",
            "author_login": "roboquat"
          },
          {
            "sha": "8c8685cd99ee328aeacaec14f9f3d57f719e8672",
            "date": "2025-01-10T15:38:25Z",
            "author_login": "filiptronicek"
          },
          {
            "sha": "d54bd04999de812be44865004d82d62cb72fc320",
            "date": "2025-01-08T16:05:23Z",
            "author_login": "filiptronicek"
          },
          {
            "sha": "663fcb958750e345c38521e18e06d401255e3b97",
            "date": "2025-01-08T06:31:23Z",
            "author_login": "iQQBot"
          },
          {
            "sha": "a5847d2c6d14d35c4da1c623220f8f204b4da7f4",
            "date": "2025-01-07T16:46:23Z",
            "author_login": "iQQBot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-601",
    "description": "Gitpod before 0.6.0 allows unvalidated redirects.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-06-22T14:15:09.057",
    "last_modified": "2024-11-21T06:12:03.183",
    "fix_date": "2021-01-13T08:36:53Z"
  },
  "references": [
    {
      "url": "https://github.com/gitpod-io/gitpod/blob/main/CHANGELOG.md",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/commit/8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/compare/0.6.0-beta5...0.6.0",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/2879",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/2879#issuecomment-865662372",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/4567",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/4567/commits/f78b7d18e509e28e71b65bbd4dfd52c16ca57c18",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.gitpod.io/changelog",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/blob/main/CHANGELOG.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/commit/8ca431f86ae3a6f9a17afcfed51cdd065fcff1a5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/compare/0.6.0-beta5...0.6.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/2879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/2879#issuecomment-865662372",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/4567",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gitpod-io/gitpod/pull/4567/commits/f78b7d18e509e28e71b65bbd4dfd52c16ca57c18",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.gitpod.io/changelog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:01:59.748393",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gitpod",
    "owner": "gitpod-io",
    "created_at": "2018-04-24T15:56:54Z",
    "updated_at": "2025-01-14T21:05:15Z",
    "pushed_at": "2025-01-14T19:07:01Z",
    "size": 102688,
    "stars": 13061,
    "forks": 1250,
    "open_issues": 477,
    "watchers": 13061,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 5204309,
      "Go": 5001337,
      "Kotlin": 262372,
      "Shell": 158140,
      "Dockerfile": 71564,
      "JavaScript": 39239,
      "Java": 35325,
      "Jsonnet": 26326,
      "HCL": 14440,
      "CSS": 11339,
      "Makefile": 9588,
      "HTML": 6929,
      "Jupyter Notebook": 6676,
      "C": 4512,
      "Mustache": 1054,
      "Smarty": 972
    },
    "commit_activity": {
      "total_commits_last_year": 931,
      "avg_commits_per_week": 17.903846153846153,
      "days_active_last_year": 244
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T21:39:57.328668"
  }
}