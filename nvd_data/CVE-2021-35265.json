{
  "cve_id": "CVE-2021-35265",
  "github_data": {
    "repository": "maxsite/cms",
    "fix_commit": "6b0ab1de9f3d471485d1347e800a9ce43fedbf1a",
    "related_commits": [
      "6b0ab1de9f3d471485d1347e800a9ce43fedbf1a",
      "6b0ab1de9f3d471485d1347e800a9ce43fedbf1a"
    ],
    "patch_url": "https://github.com/maxsite/cms/commit/6b0ab1de9f3d471485d1347e800a9ce43fedbf1a.patch",
    "fix_commit_details": {
      "sha": "6b0ab1de9f3d471485d1347e800a9ce43fedbf1a",
      "commit_date": "2020-10-21T09:51:57Z",
      "author": {
        "login": "maxsite",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix #414",
        "length": 8,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 9,
        "deletions": 6
      },
      "files": [
        {
          "filename": "application/maxsite/common/core/format.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -80,7 +80,8 @@ function mso_menu_build($menu = '', $select_css = 'selected', $add_link_admin =\n \t}\r\n \r\n \t// \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 url\r\n-\t$current_url = getinfo('site_protocol') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n+\t$current_url = mso_current_url(true);\r\n+\t// $current_url = getinfo('site_protocol') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n \r\n \t$out = '';\r\n \r"
        },
        {
          "filename": "application/maxsite/common/core/url.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -44,7 +44,7 @@ function mso_segment_array()\n \tif (isset($_SERVER['REQUEST_URI']) and $_SERVER['REQUEST_URI']) {\r\n \t\t// http://localhost/page/privet?get=hello\r\n \t\t$url = getinfo('site_protocol');\r\n-\t\t$url .= $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n+\t\t$url .= $_SERVER['HTTP_HOST'] . mso_clean_str($_SERVER['REQUEST_URI']);\r\n \t\t$url = str_replace($CI->config->config['base_url'], '', $url); // page/privet?get=hello\r\n \r\n \t\tif (strpos($url, '?') !== FALSE) {\r\n@@ -78,7 +78,7 @@ function mso_url_get()\n {\r\n \t$CI = &get_instance();\r\n \tif (isset($_SERVER['REQUEST_URI']) and $_SERVER['REQUEST_URI'] and (strpos($_SERVER['REQUEST_URI'], '?') !== FALSE)) {\r\n-\t\t$url = getinfo('site_protocol') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n+\t\t$url = getinfo('site_protocol') . $_SERVER['HTTP_HOST'] . mso_clean_str($_SERVER['REQUEST_URI']);\r\n \t\t$url = str_replace($CI->config->config['base_url'], \"\", $url);\r\n \t\t$url = explode('?', $url);\r\n \r\n@@ -221,7 +221,9 @@ function mso_get_permalink_page($id = 0, $prefix = 'page/')\n // \u0435\u0441\u043b\u0438 $absolute = true, \u0442\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044f \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0443\u0440\u043b \u043a\u0430\u043a \u0435\u0441\u0442\u044c\r\n function mso_current_url($absolute = false, $explode = false, $delete_request = false)\r\n {\r\n-\t$url = getinfo('site_protocol') . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n+\t$url = getinfo('site_protocol') . $_SERVER['HTTP_HOST'] . mso_clean_str($_SERVER['REQUEST_URI']);\r\n+\t\r\n+\t//pr($url);\r\n \r\n \tif ($delete_request) {\r\n \t\t// \u043e\u0442\u0434\u0435\u043b\u0438\u043c \u043f\u043e \u00ab?\u00bb\r"
        },
        {
          "filename": "application/maxsite/plugins/global_cache/index.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -65,7 +65,7 @@ function global_cache_uninstall($args = array())\n # \u0435\u0441\u043b\u0438 $dir = true, \u0442\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043a\u0430\u0442\u0430\u043b\u043e\u0433 html\r\n function global_cache_key($dir = true)\r\n {\r\n-\t$cache_key = $_SERVER['REQUEST_URI'];\r\n+\t$cache_key =  mso_clean_str($_SERVER['REQUEST_URI']); //$_SERVER['REQUEST_URI'];\r\n \t$cache_key = str_replace('/', '-', $cache_key);\r\n \t$cache_key = mso_slug(' ' . $cache_key);\r\n \t\r"
        },
        {
          "filename": "application/maxsite/plugins/sape/index.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -78,7 +78,7 @@ function sape_init($args = array())\n \t\t\t// \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0430\u0436\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\r\n \t\t\tif (isset($_SERVER['argv']) and $_SERVER['argv']) // \u0435\u0441\u0442\u044c \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b - \u0434\u0435\u043b\u0430\u0435\u043c \u0440\u0435\u0434\u0438\u0440\u0435\u043a\u0442\r\n \t\t\t{\r\n-\t\t\t\t$url = $_SERVER['REQUEST_URI']; // /?nono  /about/?momo\r\n+\t\t\t\t$url =  mso_clean_str($_SERVER['REQUEST_URI']); // $_SERVER['REQUEST_URI']; // /?nono  /about/?momo\r\n \t\t\t\t\r\n \t\t\t\t$url = explode('?', $url);\r\n \t\t\t\tif (isset($url[0])) $url = $url[0];\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "56895d2fae80870d9bb2b2f4f2b382277e3cfb1c",
            "date": "2024-02-23T07:45:28Z",
            "author_login": "maxsite"
          },
          {
            "sha": "e664fa65b8f850aaa9b7ba324c4519f187209c88",
            "date": "2024-02-13T12:19:55Z",
            "author_login": "maxsite"
          },
          {
            "sha": "195c738e28cf7563c91a8f1d1b67718b72c48562",
            "date": "2024-02-13T12:15:34Z",
            "author_login": "maxsite"
          },
          {
            "sha": "dc95b228c43f76a5754f783c36d6ba66549655ba",
            "date": "2023-05-02T07:48:52Z",
            "author_login": "maxsite"
          },
          {
            "sha": "8c849995ca7bf24bf2c22dadc81064211a621e8c",
            "date": "2023-03-14T10:22:20Z",
            "author_login": "maxsite"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A reflected cross-site scripting (XSS) vulnerability in MaxSite CMS before V106 via product/page/* allows remote attackers to inject arbitrary web script to a page.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-08-03T12:15:07.880",
    "last_modified": "2024-11-21T06:12:10.037",
    "fix_date": "2020-10-21T09:51:57Z"
  },
  "references": [
    {
      "url": "https://github.com/maxsite/cms/commit/6b0ab1de9f3d471485d1347e800a9ce43fedbf1a",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/maxsite/cms/issues/414#issue-726249183",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/maxsite/cms/commit/6b0ab1de9f3d471485d1347e800a9ce43fedbf1a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/maxsite/cms/issues/414#issue-726249183",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.354676",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cms",
    "owner": "maxsite",
    "created_at": "2012-11-14T12:12:35Z",
    "updated_at": "2025-01-02T03:34:04Z",
    "pushed_at": "2024-02-23T07:45:41Z",
    "size": 12258,
    "stars": 147,
    "forks": 64,
    "open_issues": 6,
    "watchers": 147,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3936653,
      "JavaScript": 244665,
      "SCSS": 231673,
      "Less": 126097,
      "HTML": 90134,
      "CSS": 32284
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:51:13.886398"
  }
}