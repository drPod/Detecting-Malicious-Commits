{
  "cve_id": "CVE-2021-3647",
  "github_data": {
    "repository": "medialize/URI.js",
    "fix_commit": "ac43ca8f80c042f0256fb551ea5203863dec4481",
    "related_commits": [
      "ac43ca8f80c042f0256fb551ea5203863dec4481",
      "ac43ca8f80c042f0256fb551ea5203863dec4481"
    ],
    "patch_url": "https://github.com/medialize/URI.js/commit/ac43ca8f80c042f0256fb551ea5203863dec4481.patch",
    "fix_commit_details": {
      "sha": "ac43ca8f80c042f0256fb551ea5203863dec4481",
      "commit_date": "2021-07-11T18:16:43Z",
      "author": {
        "login": "rodneyrehm",
        "type": "User",
        "stats": {
          "total_commits": 467,
          "average_weekly_commits": 0.6837481698389458,
          "total_additions": 32609,
          "total_deletions": 17144,
          "weeks_active": 99
        }
      },
      "commit_message": {
        "title": "fix(parse): more backslash galore #410",
        "length": 106,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 346,
        "additions": 346,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/URI.js",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -512,6 +512,9 @@\n       string = string.substring(0, pos);\n     }\n \n+    // slashes and backslashes have lost all meaning for the web protocols (https, http, wss, ws)\n+    string = string.replace(/^(https?|ftp|wss?)?:[/\\\\]*/, '$1://');\n+\n     // extract protocol\n     if (string.substring(0, 2) === '//') {\n       // relative-scheme"
        },
        {
          "filename": "test/urls.js",
          "status": "modified",
          "additions": 343,
          "deletions": 0,
          "patch": "@@ -2131,6 +2131,349 @@ var urls = [{\n         idn: false,\n         punycode: false\n       }\n+    }, {\n+      name: 'backslashes protocol excessive',\n+      url: 'https:/\\/\\/\\attacker.com',\n+      _url: 'https://attacker.com/',\n+      parts: {\n+        protocol: 'https',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'https',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'https://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n+    }, {\n+      name: 'no slash protocol https',\n+      url: 'https:attacker.com',\n+      _url: 'https://attacker.com/',\n+      parts: {\n+        protocol: 'https',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'https',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'https://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n+    }, {\n+      name: 'single slash protocol https',\n+      url: 'https:/attacker.com',\n+      _url: 'https://attacker.com/',\n+      parts: {\n+        protocol: 'https',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'https',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'https://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n+    }, {\n+      name: 'excessive slash protocol https',\n+      url: 'https://////attacker.com',\n+      _url: 'https://attacker.com/',\n+      parts: {\n+        protocol: 'https',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'https',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'https://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n+    }, {\n+      name: 'no slash protocol ftp',\n+      url: 'ftp:attacker.com',\n+      _url: 'ftp://attacker.com/',\n+      parts: {\n+        protocol: 'ftp',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'ftp',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'ftp://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n+    }, {\n+      name: 'single slash protocol ftp',\n+      url: 'ftp:/attacker.com',\n+      _url: 'ftp://attacker.com/',\n+      parts: {\n+        protocol: 'ftp',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'ftp',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'ftp://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n+    }, {\n+      name: 'excessive slash protocol ftp',\n+      url: 'ftp://////attacker.com',\n+      _url: 'ftp://attacker.com/',\n+      parts: {\n+        protocol: 'ftp',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'ftp',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'ftp://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n     }, {\n       name: '__proto__ in query',\n       url: 'http://www.example.org/?__proto__=hasOwnProperty&__proto__=eviltwin&uuid',"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28976cde5bb32a433ab78c4a32ef58f39d2cabf6",
            "date": "2022-04-03T09:31:17Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b655c1b972111ade9f181b02374305942e68e30a",
            "date": "2022-04-03T09:30:13Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
            "date": "2022-04-03T09:24:54Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
            "date": "2022-04-03T08:51:52Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "119e6abe4579f6a76b078586ec4d8fbce9da962c",
            "date": "2022-03-05T15:17:44Z",
            "author_login": "rodneyrehm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-601",
    "description": "URI.js is vulnerable to URL Redirection to Untrusted Site",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-16T11:15:11.383",
    "last_modified": "2024-11-21T06:22:04.223",
    "fix_date": "2021-07-11T18:16:43Z"
  },
  "references": [
    {
      "url": "https://github.com/medialize/URI.js/commit/ac43ca8f80c042f0256fb551ea5203863dec4481",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/1625558772840-medialize/URI.js",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/URI.js/commit/ac43ca8f80c042f0256fb551ea5203863dec4481",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/1625558772840-medialize/URI.js",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.311011",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "URI.js",
    "owner": "medialize",
    "created_at": "2011-12-27T10:46:47Z",
    "updated_at": "2025-01-13T05:48:53Z",
    "pushed_at": "2023-08-27T10:51:22Z",
    "size": 3202,
    "stars": 6258,
    "forks": 476,
    "open_issues": 104,
    "watchers": 6258,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 377871,
      "HTML": 120393,
      "CSS": 9642,
      "PHP": 1226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:53:07.731779"
  }
}