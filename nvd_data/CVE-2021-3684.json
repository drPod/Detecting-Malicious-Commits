{
  "cve_id": "CVE-2021-3684",
  "github_data": {
    "repository": "openshift/assisted-installer",
    "fix_commit": "2403dad3795406f2c5d923af0894e07bc8b0bdc4",
    "related_commits": [
      "2403dad3795406f2c5d923af0894e07bc8b0bdc4",
      "f3800cfa3d64ce6dcd6f7b73f0578bb99bfdaf7a",
      "2403dad3795406f2c5d923af0894e07bc8b0bdc4",
      "f3800cfa3d64ce6dcd6f7b73f0578bb99bfdaf7a"
    ],
    "patch_url": "https://github.com/openshift/assisted-installer/commit/2403dad3795406f2c5d923af0894e07bc8b0bdc4.patch",
    "fix_commit_details": {
      "sha": "2403dad3795406f2c5d923af0894e07bc8b0bdc4",
      "commit_date": "2021-08-05T09:40:56Z",
      "author": {
        "login": "tsorya",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "MGMT-7452: Remove token from assisted-installer-controller log (#338)",
        "length": 69,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/assisted_installer_controller/assisted_installer_controller.go",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -70,9 +70,9 @@ var (\n // as a first step it will wait till nodes are added to cluster and update their status to Done\n \n type ControllerConfig struct {\n-\tClusterID             string `envconfig:\"CLUSTER_ID\" required:\"true\" `\n+\tClusterID             string `envconfig:\"CLUSTER_ID\" required:\"true\"`\n \tURL                   string `envconfig:\"INVENTORY_URL\" required:\"true\"`\n-\tPullSecretToken       string `envconfig:\"PULL_SECRET_TOKEN\" required:\"true\"`\n+\tPullSecretToken       string `envconfig:\"PULL_SECRET_TOKEN\" required:\"true\" secret:\"true\"`\n \tSkipCertVerification  bool   `envconfig:\"SKIP_CERT_VERIFICATION\" required:\"false\" default:\"false\"`\n \tCACertPath            string `envconfig:\"CA_CERT_PATH\" required:\"false\" default:\"\"`\n \tNamespace             string `envconfig:\"NAMESPACE\" required:\"false\" default:\"assisted-installer\"`"
        },
        {
          "filename": "src/ops/ops.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -238,7 +238,7 @@ func (o *ops) SetBootOrder(device string) error {\n }\n \n func (o *ops) ExtractFromIgnition(ignitionPath string, fileToExtract string) error {\n-\to.log.Infof(\"Getting pull secret from %s\", ignitionPath)\n+\to.log.Infof(\"Getting data from %s\", ignitionPath)\n \tignitionData, err := ioutil.ReadFile(ignitionPath)\n \tif err != nil {\n \t\to.log.Errorf(\"Error occurred while trying to read %s : %e\", ignitionPath, err)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d73c2b59e30546e67db321419191e30884aeee0c",
            "date": "2025-01-14T10:37:51Z",
            "author_login": "giladravid16"
          },
          {
            "sha": "34bae2a162fe2a380538178f20585f66c3677e6e",
            "date": "2025-01-07T22:44:50Z",
            "author_login": "giladravid16"
          },
          {
            "sha": "cc66be88c6a43d748bec841f36bafff084eb283a",
            "date": "2025-01-07T18:37:16Z",
            "author_login": "giladravid16"
          },
          {
            "sha": "a8f401a89080ab905a3e1342d2a90c4d1f1657c1",
            "date": "2025-01-02T22:50:58Z",
            "author_login": "openshift-bot"
          },
          {
            "sha": "f73273192d5fee59c6a17af19eac2e5d43f54d22",
            "date": "2024-12-26T14:54:49Z",
            "author_login": "eranco74"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-532",
    "description": "A vulnerability was found in OpenShift Assisted Installer. During generation of the Discovery ISO, image pull secrets were leaked as plaintext in the installation logs. An authenticated user could exploit this by re-using the image pull secret to pull container images from the registry as the associated user.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-24T20:15:08.160",
    "last_modified": "2024-11-21T06:22:09.373",
    "fix_date": "2021-08-05T09:40:56Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1985962",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/openshift/assisted-installer/commit/2403dad3795406f2c5d923af0894e07bc8b0bdc4",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openshift/assisted-installer/commit/f3800cfa3d64ce6dcd6f7b73f0578bb99bfdaf7a",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1985962",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/openshift/assisted-installer/commit/2403dad3795406f2c5d923af0894e07bc8b0bdc4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openshift/assisted-installer/commit/f3800cfa3d64ce6dcd6f7b73f0578bb99bfdaf7a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.002415",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "assisted-installer",
    "owner": "openshift",
    "created_at": "2020-06-29T23:13:24Z",
    "updated_at": "2025-01-14T10:37:56Z",
    "pushed_at": "2025-01-14T12:23:38Z",
    "size": 24998,
    "stars": 70,
    "forks": 100,
    "open_issues": 20,
    "watchers": 70,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release-ocm-2.7",
      "release-ocm-2.8",
      "release-ocm-2.9",
      "release-ocm-2.10",
      "release-ocm-2.11"
    ],
    "languages": {
      "Go": 473461,
      "Makefile": 3177,
      "Shell": 1378
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:53:55.092250"
  }
}