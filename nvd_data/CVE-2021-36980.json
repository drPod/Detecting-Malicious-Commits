{
  "cve_id": "CVE-2021-36980",
  "github_data": {
    "repository": "openvswitch/ovs",
    "fix_commit": "38744b1bcb022c611712527f039722115300f58f",
    "related_commits": [
      "38744b1bcb022c611712527f039722115300f58f",
      "65c61b0c23a0d474696d7b1cea522a5016a8aeb3",
      "6d67310f4d2524b466b98f05ebccc1add1e8cf35",
      "77cccc74deede443e8b9102299efc869a52b65b2",
      "8ce8dc34b5f73b30ce0c1869af9947013c3c6575",
      "9926637a80d0d243dbf9c49761046895e9d1a8e2",
      "38744b1bcb022c611712527f039722115300f58f",
      "65c61b0c23a0d474696d7b1cea522a5016a8aeb3",
      "6d67310f4d2524b466b98f05ebccc1add1e8cf35",
      "77cccc74deede443e8b9102299efc869a52b65b2",
      "8ce8dc34b5f73b30ce0c1869af9947013c3c6575",
      "9926637a80d0d243dbf9c49761046895e9d1a8e2"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "38744b1bcb022c611712527f039722115300f58f",
      "commit_date": "2021-02-16T22:27:30Z",
      "author": {
        "login": "igsilya",
        "type": "User",
        "stats": {
          "total_commits": 967,
          "average_weekly_commits": 1.1821515892420538,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 299
        }
      },
      "commit_message": {
        "title": "ofp-actions: Fix use-after-free while decoding RAW_ENCAP.",
        "length": 1915,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/ofp-actions.c",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -4431,6 +4431,7 @@ decode_NXAST_RAW_ENCAP(const struct nx_action_encap *nae,\n {\n     struct ofpact_encap *encap;\n     const struct ofp_ed_prop_header *ofp_prop;\n+    const size_t encap_ofs = out->size;\n     size_t props_len;\n     uint16_t n_props = 0;\n     int err;\n@@ -4458,6 +4459,7 @@ decode_NXAST_RAW_ENCAP(const struct nx_action_encap *nae,\n         }\n         n_props++;\n     }\n+    encap = ofpbuf_at_assert(out, encap_ofs, sizeof *encap);\n     encap->n_props = n_props;\n     out->header = &encap->ofpact;\n     ofpact_finish_ENCAP(out, &encap);"
        },
        {
          "filename": "tests/automake.mk",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -134,7 +134,8 @@ FUZZ_REGRESSION_TESTS = \\\n \ttests/fuzz-regression/ofp_print_fuzzer-5722747668791296 \\\n \ttests/fuzz-regression/ofp_print_fuzzer-6285128790704128 \\\n \ttests/fuzz-regression/ofp_print_fuzzer-6470117922701312 \\\n-\ttests/fuzz-regression/ofp_print_fuzzer-6502620041576448\n+\ttests/fuzz-regression/ofp_print_fuzzer-6502620041576448 \\\n+\ttests/fuzz-regression/ofp_print_fuzzer-6540965472632832\n $(srcdir)/tests/fuzz-regression-list.at: tests/automake.mk\n \t$(AM_V_GEN)for name in $(FUZZ_REGRESSION_TESTS); do \\\n             basename=`echo $$name | sed 's,^.*/,,'`; \\"
        },
        {
          "filename": "tests/fuzz-regression-list.at",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -21,3 +21,4 @@ TEST_FUZZ_REGRESSION([ofp_print_fuzzer-5722747668791296])\n TEST_FUZZ_REGRESSION([ofp_print_fuzzer-6285128790704128])\n TEST_FUZZ_REGRESSION([ofp_print_fuzzer-6470117922701312])\n TEST_FUZZ_REGRESSION([ofp_print_fuzzer-6502620041576448])\n+TEST_FUZZ_REGRESSION([ofp_print_fuzzer-6540965472632832])"
        },
        {
          "filename": "tests/fuzz-regression/ofp_print_fuzzer-6540965472632832",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2472845c39b41473cff56a99bad029bc6c85489b",
            "date": "2025-01-20T15:00:46Z",
            "author_login": "roidayan"
          },
          {
            "sha": "ad59bb8514e246a3fd1e61f1586da27e4175b727",
            "date": "2025-01-21T10:41:39Z",
            "author_login": "roidayan"
          },
          {
            "sha": "ae8dafe6b047733129a91a475eff3a5dcd5536d6",
            "date": "2025-01-21T10:41:38Z",
            "author_login": "elibritstein"
          },
          {
            "sha": "1594c5086121ce6f3ab73239960ed4b04edc1de7",
            "date": "2025-01-22T10:47:55Z",
            "author_login": "chaudron"
          },
          {
            "sha": "a3c06c309ab9f21fd9ce4e8dca542119d46be9c5",
            "date": "2025-01-21T13:57:30Z",
            "author_login": "fnordahl"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-416",
    "description": "Open vSwitch (aka openvswitch) 2.11.0 through 2.15.0 has a use-after-free in decode_NXAST_RAW_ENCAP (called from ofpact_decode and ofpacts_decode) during the decoding of a RAW_ENCAP action.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-07-20T07:15:08.113",
    "last_modified": "2024-11-21T06:14:26.057",
    "fix_date": "2021-02-16T22:27:30Z"
  },
  "references": [
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=27851",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/openvswitch/OSV-2020-2197.yaml",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/38744b1bcb022c611712527f039722115300f58f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/65c61b0c23a0d474696d7b1cea522a5016a8aeb3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/6d67310f4d2524b466b98f05ebccc1add1e8cf35",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/77cccc74deede443e8b9102299efc869a52b65b2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/8ce8dc34b5f73b30ce0c1869af9947013c3c6575",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/9926637a80d0d243dbf9c49761046895e9d1a8e2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202311-16",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=27851",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/openvswitch/OSV-2020-2197.yaml",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/38744b1bcb022c611712527f039722115300f58f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/65c61b0c23a0d474696d7b1cea522a5016a8aeb3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/6d67310f4d2524b466b98f05ebccc1add1e8cf35",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/77cccc74deede443e8b9102299efc869a52b65b2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/8ce8dc34b5f73b30ce0c1869af9947013c3c6575",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openvswitch/ovs/commit/9926637a80d0d243dbf9c49761046895e9d1a8e2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202311-16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.317970",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ovs",
    "owner": "openvswitch",
    "created_at": "2014-04-02T22:15:28Z",
    "updated_at": "2025-01-13T08:48:23Z",
    "pushed_at": "2025-01-10T20:35:45Z",
    "size": 130086,
    "stars": 3622,
    "forks": 1923,
    "open_issues": 1,
    "watchers": 3622,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "branch-1.1",
      "branch-1.2",
      "branch-1.3",
      "branch-1.4",
      "branch-1.5",
      "branch-1.6",
      "branch-1.7",
      "branch-1.8",
      "branch-1.9",
      "branch-1.10",
      "branch-1.11",
      "branch-2.0",
      "branch-2.1",
      "branch-2.2",
      "branch-2.3",
      "branch-2.4",
      "branch-2.5",
      "branch-2.6",
      "branch-2.7",
      "branch-2.8",
      "branch-2.9",
      "branch-2.10",
      "branch-2.11",
      "branch-2.12",
      "branch-2.13",
      "branch-2.14",
      "branch-2.15",
      "branch-2.16"
    ],
    "languages": {
      "C": 14279493,
      "Python": 1379833,
      "Roff": 308620,
      "Shell": 210318,
      "M4": 114595,
      "Makefile": 103515,
      "C++": 76426,
      "JavaScript": 7350,
      "PowerShell": 5683,
      "Ruby": 1565,
      "Dockerfile": 569,
      "Batchfile": 85
    },
    "commit_activity": {
      "total_commits_last_year": 375,
      "avg_commits_per_week": 7.211538461538462,
      "days_active_last_year": 143
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:16:25.807865"
  }
}