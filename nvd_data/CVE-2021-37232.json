{
  "cve_id": "CVE-2021-37232",
  "github_data": {
    "repository": "wez/atomicparsley",
    "fix_commit": "d72ccf06c98259d7261e0f3ac4fd8717778782c1",
    "related_commits": [
      "d72ccf06c98259d7261e0f3ac4fd8717778782c1",
      "d72ccf06c98259d7261e0f3ac4fd8717778782c1"
    ],
    "patch_url": "https://github.com/wez/atomicparsley/commit/d72ccf06c98259d7261e0f3ac4fd8717778782c1.patch",
    "fix_commit_details": {
      "sha": "d72ccf06c98259d7261e0f3ac4fd8717778782c1",
      "commit_date": "2021-07-13T06:10:28Z",
      "author": {
        "login": "wez",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Avoid stack overflow",
        "length": 74,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 17,
        "deletions": 1
      },
      "files": [
        {
          "filename": ".github/workflows/ci.yml",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -23,3 +23,16 @@ jobs:\n       run: cmake .\n     - name: build\n       run: cmake --build . --config Release\n+\n+  asan:\n+    runs-on: ubuntu-latest\n+    strategy:\n+      fail-fast: false\n+    steps:\n+    - uses: actions/checkout@v2\n+    - name: configure\n+      run: cmake -DASAN=on -DCMAKE_BUILD_TYPE=Debug .\n+    - name: build\n+      run: cmake --build .\n+    - name: test\n+      run: tests/test.sh"
        },
        {
          "filename": "src/extracts.cpp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1588,7 +1588,7 @@ void APar_Print_TrackDetails(TrackInfo *track_info) {\n }\n \n void APar_ExtractDetails(FILE *isofile, uint8_t optional_output) {\n-  char uint32_buffer[5];\n+  char uint32_buffer[8];\n   Trackage track = {0};\n \n   AtomicInfo *mvhdAtom = APar_FindAtom(\"moov.mvhd\", false, VERSIONED_ATOM, 0);"
        },
        {
          "filename": "tests/issue-32.mp4",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/test.sh",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+#!/bin/bash\n+set -xe\n+./AtomicParsley ./tests/issue-32.mp4 -T 1 -t +"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1ca825de2b92d0eadf29b2f7d781399796528b7c",
            "date": "2024-11-25T21:34:10Z",
            "author_login": "jmcintyre"
          },
          {
            "sha": "1ed9031faaea5c75f88b2135d04b29ef24766788",
            "date": "2024-06-05T10:58:29Z",
            "author_login": "malhal"
          },
          {
            "sha": "a2a613c1a65e82cb07153209d07572cb6d249e50",
            "date": "2024-05-24T09:12:03Z",
            "author_login": "malhal"
          },
          {
            "sha": "9224de3a251e991893a091832ccc6ccc5f83220b",
            "date": "2024-02-07T21:53:31Z",
            "author_login": "wilhuff"
          },
          {
            "sha": "882bbaf6ac018fcd12bf40b15e29f6599e19ee40",
            "date": "2024-02-06T05:41:27Z",
            "author_login": "wilhuff"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "A stack overflow vulnerability occurs in Atomicparsley 20210124.204813.840499f through APar_read64() in src/util.cpp due to the lack of buffer size of uint32_buffer while reading more bytes in APar_read64.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-08-04T10:15:07.983",
    "last_modified": "2024-11-21T06:14:54.170",
    "fix_date": "2021-07-13T06:10:28Z"
  },
  "references": [
    {
      "url": "https://github.com/wez/atomicparsley/commit/d72ccf06c98259d7261e0f3ac4fd8717778782c1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wez/atomicparsley/issues/32",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202305-01",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/wez/atomicparsley/commit/d72ccf06c98259d7261e0f3ac4fd8717778782c1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wez/atomicparsley/issues/32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202305-01",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.358900",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "atomicparsley",
    "owner": "wez",
    "created_at": "2011-03-12T23:13:08Z",
    "updated_at": "2025-01-11T08:36:12Z",
    "pushed_at": "2024-12-04T22:10:32Z",
    "size": 3943,
    "stars": 598,
    "forks": 73,
    "open_issues": 15,
    "watchers": 598,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C++": 863711,
      "C": 94692,
      "Objective-C++": 17242,
      "Perl": 5714,
      "CMake": 2194,
      "Shell": 226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T17:52:57.810044"
  }
}