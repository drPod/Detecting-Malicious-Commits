{
  "cve_id": "CVE-2021-3756",
  "github_data": {
    "repository": "hoene/libmysofa",
    "fix_commit": "890400ebd092c574707d0c132124f8ff047e20e1",
    "related_commits": [
      "890400ebd092c574707d0c132124f8ff047e20e1",
      "890400ebd092c574707d0c132124f8ff047e20e1"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "890400ebd092c574707d0c132124f8ff047e20e1",
      "commit_date": "2021-10-03T15:48:38Z",
      "author": {
        "login": "hoene",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix for issue 163",
        "length": 17,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 10,
        "deletions": 7
      },
      "files": [
        {
          "filename": "src/hdf/dataobject.c",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -500,14 +500,17 @@ static int readOHDRHeaderMessageDataLayout(struct READER *reader,\n       store = ftell(reader->fhd);\n       if (fseek(reader->fhd, data_address, SEEK_SET) < 0)\n         return errno; // LCOV_EXCL_LINE\n-      if (!data->data) {\n-        if (data_size > 0x10000000)\n-          return MYSOFA_INVALID_FORMAT;\n-        data->data_len = data_size;\n-        data->data = calloc(1, data_size);\n-        if (!data->data)\n-          return MYSOFA_NO_MEMORY; // LCOV_EXCL_LINE\n+      if (data->data) {\n+        free(data->data);\n+        data->data = NULL;\n       }\n+      if (data_size > 0x10000000)\n+        return MYSOFA_INVALID_FORMAT;\n+      data->data_len = data_size;\n+      data->data = calloc(1, data_size);\n+      if (!data->data)\n+        return MYSOFA_NO_MEMORY; // LCOV_EXCL_LINE\n+\n       err = fread(data->data, 1, data_size, reader->fhd);\n       if (err != data_size)\n         return MYSOFA_READ_ERROR; // LCOV_EXCL_LINE"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dd315a8ec1fee7193d40e4a59b12c5590a4a918c",
            "date": "2024-12-17T20:25:15Z",
            "author_login": "hoene"
          },
          {
            "sha": "b05b1611d5bca221506f8ecf42a2594af8135c36",
            "date": "2024-11-05T11:49:37Z",
            "author_login": "hoene"
          },
          {
            "sha": "49032b51215e73d8547c442426ef020805635927",
            "date": "2024-11-04T09:15:41Z",
            "author_login": "jperkin"
          },
          {
            "sha": "9e2eb4dc74cd738c458beb60939fad2c86def7ca",
            "date": "2024-10-29T16:32:26Z",
            "author_login": "naortega"
          },
          {
            "sha": "444d2c1d7ececf5cc2d96d3b17b209047b02318d",
            "date": "2024-10-19T19:02:33Z",
            "author_login": "hoene"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-122",
    "description": "libmysofa is vulnerable to Heap-based Buffer Overflow",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-10-29T16:15:07.537",
    "last_modified": "2024-11-21T06:22:20.937",
    "fix_date": "2021-10-03T15:48:38Z"
  },
  "references": [
    {
      "url": "https://github.com/hoene/libmysofa/commit/890400ebd092c574707d0c132124f8ff047e20e1",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/7ca8d9ea-e2a6-4294-af28-70260bb53bc1",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PGQ45S4RH7MC42NHTAGOIHYR4C5IRTMZ/",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WGY7TAZX2M4NYXXGNHIBBKKN5XMSMKQ4/",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/hoene/libmysofa/commit/890400ebd092c574707d0c132124f8ff047e20e1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/7ca8d9ea-e2a6-4294-af28-70260bb53bc1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PGQ45S4RH7MC42NHTAGOIHYR4C5IRTMZ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WGY7TAZX2M4NYXXGNHIBBKKN5XMSMKQ4/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.856623",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libmysofa",
    "owner": "hoene",
    "created_at": "2016-12-06T22:13:29Z",
    "updated_at": "2025-01-23T06:10:22Z",
    "pushed_at": "2024-12-17T20:26:57Z",
    "size": 258803,
    "stars": 147,
    "forks": 75,
    "open_issues": 5,
    "watchers": 147,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 259485,
      "JavaScript": 22870,
      "CMake": 14971,
      "C++": 2873,
      "Shell": 1500,
      "MATLAB": 1463,
      "Emacs Lisp": 100
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:44:35.902262"
  }
}