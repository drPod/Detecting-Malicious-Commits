{
  "cve_id": "CVE-2021-3765",
  "github_data": {
    "repository": "validatorjs/validator.js",
    "fix_commit": "496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1",
    "related_commits": [
      "496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1",
      "496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1"
    ],
    "patch_url": "https://github.com/validatorjs/validator.js/commit/496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1.patch",
    "fix_commit_details": {
      "sha": "496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1",
      "commit_date": "2021-11-01T20:30:39Z",
      "author": {
        "login": "tux-tn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(rtrim): remove regex to prevent ReDOS attack (#1738)",
        "length": 56,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 12,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/lib/rtrim.js",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -2,7 +2,16 @@ import assertString from './util/assertString';\n \n export default function rtrim(str, chars) {\n   assertString(str);\n-  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping\n-  const pattern = chars ? new RegExp(`[${chars.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}]+$`, 'g') : /(\\s)+$/g;\n-  return str.replace(pattern, '');\n+  if (chars) {\n+    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#Escaping\n+    const pattern = new RegExp(`[${chars.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}]+$`, 'g');\n+    return str.replace(pattern, '');\n+  }\n+  // Use a faster and more safe than regex trim method https://blog.stevenlevithan.com/archives/faster-trim-javascript\n+  let strIndex = str.length - 1;\n+  while (/\\s/.test(str.charAt(strIndex))) {\n+    strIndex -= 1;\n+  }\n+\n+  return str.slice(0, strIndex + 1);\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "86911d817fbcd177c295b13d7ca0fdff87341191",
            "date": "2024-11-21T07:18:17Z",
            "author_login": "weikangchia"
          },
          {
            "sha": "f54599c8fbd43b1febb2cbc18190107417fbdd5e",
            "date": "2024-11-13T14:56:22Z",
            "author_login": "ticmaisdev"
          },
          {
            "sha": "def7f3e5657a7d1f47c0d5f9315336fed15325ff",
            "date": "2024-11-12T16:29:39Z",
            "author_login": "NanaAb-116"
          },
          {
            "sha": "a066cd2a67988a43190e434911a3f92f5203c035",
            "date": "2024-11-12T15:11:29Z",
            "author_login": "joelcuy"
          },
          {
            "sha": "fc31e6e7dccf9af4876bbb0062d0cc0e46f6cb3a",
            "date": "2024-10-27T16:16:43Z",
            "author_login": "sonikishan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1333",
    "description": "validator.js is vulnerable to Inefficient Regular Expression Complexity",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-11-02T07:15:07.280",
    "last_modified": "2024-11-21T06:22:22.297",
    "fix_date": "2021-11-01T20:30:39Z"
  },
  "references": [
    {
      "url": "https://github.com/validatorjs/validator.js/commit/496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/c37e975c-21a3-4c5f-9b57-04d63b28cfc9",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/validatorjs/validator.js/commit/496fc8b2a7f5997acaaec33cc44d0b8dba5fb5e1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/c37e975c-21a3-4c5f-9b57-04d63b28cfc9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.861666",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "validator.js",
    "owner": "validatorjs",
    "created_at": "2010-10-06T06:58:48Z",
    "updated_at": "2025-01-14T16:37:02Z",
    "pushed_at": "2024-11-21T07:18:17Z",
    "size": 5258,
    "stars": 23248,
    "forks": 2330,
    "open_issues": 352,
    "watchers": 23248,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 550173
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:34:54.364632"
  }
}