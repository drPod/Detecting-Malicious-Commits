{
  "cve_id": "CVE-2021-3794",
  "github_data": {
    "repository": "vuelidate/vuelidate",
    "fix_commit": "1f0ca31c30e5032f00dbd14c4791b5ee7928f71d",
    "related_commits": [
      "1f0ca31c30e5032f00dbd14c4791b5ee7928f71d",
      "1f0ca31c30e5032f00dbd14c4791b5ee7928f71d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1f0ca31c30e5032f00dbd14c4791b5ee7928f71d",
      "commit_date": "2021-09-10T07:20:41Z",
      "author": {
        "login": "dobromir-hristov",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(validators): update the url validator, to reduce potential ReDos attacks (#933)",
        "length": 83,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 14,
        "deletions": 11
      },
      "files": [
        {
          "filename": "packages/validators/src/raw/__tests__/url.spec.js",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -10,6 +10,11 @@ describe('url validator', () => {\n     'HTTP://FOO.COM/BLAH_BLAH',\n     'HTTP://FOO.COM/blah_blah',\n     'http://foo.com/blah_blah/',\n+    /** domains ending with a dot at the end are valid, {@see http://www.dns-sd.org/trailingdotsindomainnames.html} */\n+    'http://www.foo.bar./',\n+    'http://www.foo.bar.',\n+    'http://foo.bar.',\n+    'http://foo.bar./',\n     'http://foo.com/blah_blah_(wikipedia)',\n     'http://foo.com/blah_blah_(wikipedia)_(again)',\n     'http://www.example.com/wpstyle/?p=364',\n@@ -40,7 +45,7 @@ describe('url validator', () => {\n     'http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631',\n     'http://\u4f8b\u5b50.\u6d4b\u8bd5',\n     'http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e',\n-    \"http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com\",\n+    'http://-.~_!$&\\'()*+,;=:%40:80%2f::::::@example.com',\n     'http://1337.net',\n     'http://a.b-c.de',\n     'http://223.255.255.254'\n@@ -80,21 +85,16 @@ describe('url validator', () => {\n     'http://123.123.123',\n     'http://3628126748',\n     'http://.www.foo.bar/',\n-    'http://www.foo.bar./',\n     'http://.www.foo.bar./',\n     'http://10.1.1.1',\n     'http://10.1.1.254'\n   ]\n \n-  correctUrls.forEach((urlString) => {\n-    it(`should validate correct url ${urlString}`, () => {\n-      expect(url(urlString)).toBe(true)\n-    })\n+  it.each(correctUrls)('should validate correct url %s', (urlString) => {\n+    expect(url(urlString)).toBe(true)\n   })\n \n-  incorrectUrls.forEach((urlString) => {\n-    it(`should not validate incorrect url ${urlString}`, () => {\n-      expect(url(urlString)).toBe(false)\n-    })\n+  it.each(incorrectUrls)('should not validate incorrect url %s', (urlString) => {\n+    expect(url(urlString)).toBe(false)\n   })\n })"
        },
        {
          "filename": "packages/validators/src/raw/url.js",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -1,5 +1,8 @@\n import { regex } from '../common'\n \n-const urlRegex = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\n+/**\n+ * Regex taken from {@link https://gist.github.com/dperini/729294}\n+ */\n+const urlRegex = /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\n \n export default regex(urlRegex)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "08aa51495a4590c17d407a56cbbada9cf370c5d7",
            "date": "2023-12-22T13:21:42Z",
            "author_login": "shentao"
          },
          {
            "sha": "214a23a7cd0f0317f0f6d198b8f77d4293f90873",
            "date": "2023-12-22T13:21:10Z",
            "author_login": "shentao"
          },
          {
            "sha": "ea3f7bc9c2c3eda0a5b639be1e5e46a712d660ff",
            "date": "2023-08-28T13:19:49Z",
            "author_login": "sey"
          },
          {
            "sha": "bdb672d334456461bcf9058dc551a21f0152d3d9",
            "date": "2023-08-25T06:16:04Z",
            "author_login": "dobromir-hristov"
          },
          {
            "sha": "ec27c51cc045ef5f856cebd44cba932f7bb48797",
            "date": "2023-08-24T17:21:06Z",
            "author_login": "vaidd4"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1333",
    "description": "vuelidate is vulnerable to Inefficient Regular Expression Complexity",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-15T13:15:08.167",
    "last_modified": "2024-11-21T06:22:27.183",
    "fix_date": "2021-09-10T07:20:41Z"
  },
  "references": [
    {
      "url": "https://github.com/vuelidate/vuelidate/commit/1f0ca31c30e5032f00dbd14c4791b5ee7928f71d",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/d8201b98-fb91-4c12-a6f7-181b4a20d9b7",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vuelidate/vuelidate/commit/1f0ca31c30e5032f00dbd14c4791b5ee7928f71d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/d8201b98-fb91-4c12-a6f7-181b4a20d9b7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.755791",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "vuelidate",
    "owner": "vuelidate",
    "created_at": "2016-11-05T14:30:37Z",
    "updated_at": "2025-01-24T13:43:41Z",
    "pushed_at": "2024-04-22T12:15:25Z",
    "size": 5370,
    "stars": 6902,
    "forks": 496,
    "open_issues": 213,
    "watchers": 6902,
    "has_security_policy": false,
    "default_branch": "next",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 257864,
      "Vue": 49731,
      "Sass": 43348,
      "Pug": 38117,
      "SCSS": 5379,
      "HTML": 2637
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:47:10.869935"
  }
}