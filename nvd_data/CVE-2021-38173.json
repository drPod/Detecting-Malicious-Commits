{
  "cve_id": "CVE-2021-38173",
  "github_data": {
    "repository": "digint/btrbk",
    "fix_commit": "58212de771c381cd4fa05625927080bf264e9584",
    "related_commits": [
      "58212de771c381cd4fa05625927080bf264e9584",
      "58212de771c381cd4fa05625927080bf264e9584"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "58212de771c381cd4fa05625927080bf264e9584",
      "commit_date": "2021-03-21T11:53:22Z",
      "author": {
        "login": "digint",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "ssh_filter_btrbk.sh: fix alternation regex",
        "length": 361,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "ssh_filter_btrbk.sh",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -86,7 +86,7 @@ reject_filtered_cmd()\n         return 0\n     fi\n \n-    exact_cmd_match=\"^${allow_exact_list}$\";\n+    exact_cmd_match=\"^(${allow_exact_list})$\";\n     if [[ $SSH_ORIGINAL_COMMAND =~ $exact_cmd_match ]] ; then\n         return 0\n     fi"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "18ddc659790de489967c2c82213fb5fba7955d40",
            "date": "2023-08-28T17:14:35Z",
            "author_login": "digint"
          },
          {
            "sha": "225f60f56521cd71532275535066f204830ac7fb",
            "date": "2023-08-28T16:55:44Z",
            "author_login": "digint"
          },
          {
            "sha": "f7e1265e7a70cb5329fb2d9e14537a8a5ce132ca",
            "date": "2023-08-28T16:42:40Z",
            "author_login": "digint"
          },
          {
            "sha": "a4d4dff0d12489137aae3d4b629f9c5a5764593c",
            "date": "2023-08-05T18:56:39Z",
            "author_login": "digint"
          },
          {
            "sha": "d819f17e441f5c8c4361e2a1885aa31295bd38b4",
            "date": "2023-08-05T18:56:39Z",
            "author_login": "digint"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-77",
    "description": "Btrbk before 0.31.2 allows command execution because of the mishandling of remote hosts filtering SSH commands using ssh_filter_btrbk.sh in authorized_keys.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-08-07T19:15:06.997",
    "last_modified": "2024-11-21T06:16:33.690",
    "fix_date": "2021-03-21T11:53:22Z"
  },
  "references": [
    {
      "url": "https://github.com/digint/btrbk/blob/master/ChangeLog",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/digint/btrbk/commit/58212de771c381cd4fa05625927080bf264e9584",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/09/msg00002.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BP2T32JMENJFRP2HWXR7FTTZVRTTPECL/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LM7GLTUN5YS4KE2RNBX732EAMVVGNEX3/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/digint/btrbk/blob/master/ChangeLog",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/digint/btrbk/commit/58212de771c381cd4fa05625927080bf264e9584",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/09/msg00002.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BP2T32JMENJFRP2HWXR7FTTZVRTTPECL/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LM7GLTUN5YS4KE2RNBX732EAMVVGNEX3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:02.368100",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "btrbk",
    "owner": "digint",
    "created_at": "2015-02-10T14:41:47Z",
    "updated_at": "2025-01-26T07:24:56Z",
    "pushed_at": "2023-12-03T15:31:49Z",
    "size": 2511,
    "stars": 1762,
    "forks": 125,
    "open_issues": 235,
    "watchers": 1762,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Perl": 278838,
      "Shell": 31616,
      "Python": 9390,
      "Makefile": 3461
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:21:48.371813"
  }
}