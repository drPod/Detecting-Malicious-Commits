{
  "cve_id": "CVE-2021-3828",
  "github_data": {
    "repository": "nltk/nltk",
    "fix_commit": "277711ab1dec729e626b27aab6fa35ea5efbd7e6",
    "related_commits": [
      "277711ab1dec729e626b27aab6fa35ea5efbd7e6",
      "277711ab1dec729e626b27aab6fa35ea5efbd7e6"
    ],
    "patch_url": "https://github.com/nltk/nltk/commit/277711ab1dec729e626b27aab6fa35ea5efbd7e6.patch",
    "fix_commit_details": {
      "sha": "277711ab1dec729e626b27aab6fa35ea5efbd7e6",
      "commit_date": "2021-09-24T23:14:32Z",
      "author": {
        "login": "tomaarsen",
        "type": "User",
        "stats": {
          "total_commits": 209,
          "average_weekly_commits": 0.1707516339869281,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 56
        }
      },
      "commit_message": {
        "title": "Resolved ReDoS vulnerability in Corpus Reader (#2816)",
        "length": 177,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 33,
        "deletions": 1
      },
      "files": [
        {
          "filename": "nltk/corpus/reader/comparative_sents.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -45,7 +45,7 @@\n GRAD_COMPARISON = re.compile(r\"<cs-[123]>\")\n NON_GRAD_COMPARISON = re.compile(r\"<cs-4>\")\n ENTITIES_FEATS = re.compile(r\"(\\d)_((?:[\\.\\w\\s/-](?!\\d_))+)\")\n-KEYWORD = re.compile(r\"\\((?!.*\\()(.*)\\)$\")\n+KEYWORD = re.compile(r\"\\(([^\\(]*)\\)$\")\n \n \n class Comparison:"
        },
        {
          "filename": "nltk/test/corpus.doctest",
          "status": "modified",
          "additions": 32,
          "deletions": 0,
          "patch": "@@ -2162,3 +2162,35 @@ access to its tuples() method\n     >>> from nltk.corpus import qc\n     >>> qc.tuples('test.txt')\n     [('NUM:dist', 'How far is it from Denver to Aspen ?'), ('LOC:city', 'What county is Modesto , California in ?'), ...]\n+\n+Ensure that KEYWORD from `comparative_sents.py` no longer contains a ReDoS vulnerability.\n+\n+    >>> import re\n+    >>> import time\n+    >>> from nltk.corpus.reader.comparative_sents import KEYWORD\n+    >>> sizes = {\n+    ...     \"short\": 4000,\n+    ...     \"long\": 40000\n+    ... }\n+    >>> exec_times = {\n+    ...     \"short\": [],\n+    ...     \"long\": [],\n+    ... }\n+    >>> for size_name, size in sizes.items():\n+    ...     for j in range(9):\n+    ...         start_t = time.perf_counter()\n+    ...         payload = \"( \" + \"(\" * size\n+    ...         output = KEYWORD.findall(payload)\n+    ...         exec_times[size_name].append(time.perf_counter() - start_t)\n+    ...     exec_times[size_name] = sorted(exec_times[size_name])[4] # Get the mean\n+\n+Ideally, the execution time of such a regular expression is linear\n+in the length of the input. As such, we would expect exec_times[\"long\"]\n+to be roughly 10 times as big as exec_times[\"short\"].\n+With the ReDoS in place, it took roughly 80 times as long.\n+For now, we accept values below 30 (times as long), due to the potential\n+for variance. This ensures that the ReDoS has certainly been reduced,\n+if not removed.\n+\n+    >>> exec_times[\"long\"] / exec_times[\"short\"] < 30\n+    True"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7397ccfed06e7c836d3acb0b9197f6e6b26c6741",
            "date": "2024-11-11T06:24:40Z",
            "author_login": "ekaf"
          },
          {
            "sha": "e7f6724af9fbfee9b8d3bdd636cbd75c57dc9323",
            "date": "2024-10-21T08:33:09Z",
            "author_login": "drewvid"
          },
          {
            "sha": "9a5622f8a5b228df9499cd03181d9f8491e39f17",
            "date": "2024-09-25T08:35:04Z",
            "author_login": "stevenbird"
          },
          {
            "sha": "d1dabecd1fe57035e836d1942e897398c49c42db",
            "date": "2024-09-24T00:50:33Z",
            "author_login": "stevenbird"
          },
          {
            "sha": "1502e55d491d54bcbf5a3e3040ac2415fcda0f6f",
            "date": "2024-09-10T10:47:29Z",
            "author_login": "ekaf"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1333",
    "description": "nltk is vulnerable to Inefficient Regular Expression Complexity",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-27T13:15:07.993",
    "last_modified": "2024-11-21T06:22:33.317",
    "fix_date": "2021-09-24T23:14:32Z"
  },
  "references": [
    {
      "url": "https://github.com/nltk/nltk/commit/277711ab1dec729e626b27aab6fa35ea5efbd7e6",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/d19aed43-75bc-4a03-91a0-4d0bb516bc32",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nltk/nltk/commit/277711ab1dec729e626b27aab6fa35ea5efbd7e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/d19aed43-75bc-4a03-91a0-4d0bb516bc32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.789156",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "nltk",
    "owner": "nltk",
    "created_at": "2009-09-07T10:53:58Z",
    "updated_at": "2025-01-14T09:59:07Z",
    "pushed_at": "2024-11-11T06:24:40Z",
    "size": 353364,
    "stars": 13765,
    "forks": 2907,
    "open_issues": 283,
    "watchers": 13765,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "Python": 4882494,
      "Jupyter Notebook": 56591,
      "HTML": 24786,
      "Makefile": 7734,
      "Shell": 4707,
      "CSS": 705
    },
    "commit_activity": {
      "total_commits_last_year": 161,
      "avg_commits_per_week": 3.0961538461538463,
      "days_active_last_year": 41
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T17:48:59.248251"
  }
}