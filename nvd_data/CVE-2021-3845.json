{
  "cve_id": "CVE-2021-3845",
  "github_data": {
    "repository": "netristv/ws-scrcpy",
    "fix_commit": "e83cf65438bef83a3503b25358bba97bcc156fef",
    "related_commits": [
      "e83cf65438bef83a3503b25358bba97bcc156fef",
      "e83cf65438bef83a3503b25358bba97bcc156fef"
    ],
    "patch_url": "https://github.com/netristv/ws-scrcpy/commit/e83cf65438bef83a3503b25358bba97bcc156fef.patch",
    "fix_commit_details": {
      "sha": "e83cf65438bef83a3503b25358bba97bcc156fef",
      "commit_date": "2021-12-15T17:14:56Z",
      "author": {
        "login": "drauggres",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: file access outside the public dir",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/server/services/HttpServer.ts",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -45,6 +45,11 @@ export class HttpServer implements Service {\n             }\n             const parsedUrl = url.parse(req.url);\n             let pathname = path.join(publicDir, (parsedUrl.pathname || '.').replace(/^(\\.)+/, '.'));\n+            if (pathname.indexOf(publicDir) !== 0) {\n+                res.statusCode = 403;\n+                res.end();\n+                return;\n+            }\n             fs.stat(pathname, (statErr, stat) => {\n                 if (statErr) {\n                     if (statErr.code === 'ENOENT') {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c67177174b6615789860ec3cf12e6e960307b6b4",
            "date": "2025-01-07T09:36:34Z",
            "author_login": "drauggres"
          },
          {
            "sha": "2a4aa3ecaa8c815705df4ad750da5cfeeeec762a",
            "date": "2025-01-05T18:05:46Z",
            "author_login": "drauggres"
          },
          {
            "sha": "653937694fd6a0793c534a7df5b0d15fea82e07a",
            "date": "2025-01-05T11:44:56Z",
            "author_login": "drauggres"
          },
          {
            "sha": "8cf04dbef5308b349c96343c68f310ec70b02acb",
            "date": "2024-12-05T22:57:04Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "42636e095d5a653e6dc4002d841fcec196c188fb",
            "date": "2024-10-19T12:22:05Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-73",
    "description": "ws-scrcpy is vulnerable to External Control of File Name or Path",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-01-04T17:15:08.230",
    "last_modified": "2024-11-21T06:22:38.310",
    "fix_date": "2021-12-15T17:14:56Z"
  },
  "references": [
    {
      "url": "https://github.com/netristv/ws-scrcpy/commit/e83cf65438bef83a3503b25358bba97bcc156fef",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/dc7fc98f-4f4f-440a-b6f6-124a56ea36ef",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/netristv/ws-scrcpy/commit/e83cf65438bef83a3503b25358bba97bcc156fef",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/dc7fc98f-4f4f-440a-b6f6-124a56ea36ef",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.045229",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ws-scrcpy",
    "owner": "netristv",
    "created_at": "2019-06-07T15:16:37Z",
    "updated_at": "2025-01-14T06:38:13Z",
    "pushed_at": "2025-01-07T09:36:34Z",
    "size": 4131,
    "stars": 1787,
    "forks": 344,
    "open_issues": 63,
    "watchers": 1787,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "TypeScript": 624283,
      "CSS": 19925,
      "HTML": 260
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:27:55.258111"
  }
}