{
  "cve_id": "CVE-2021-3863",
  "github_data": {
    "repository": "snipe/snipe-it",
    "fix_commit": "fc5efd857f61f7e45c61db567bb66612bcb53128",
    "related_commits": [
      "fc5efd857f61f7e45c61db567bb66612bcb53128",
      "fc5efd857f61f7e45c61db567bb66612bcb53128"
    ],
    "patch_url": "https://github.com/snipe/snipe-it/commit/fc5efd857f61f7e45c61db567bb66612bcb53128.patch",
    "fix_commit_details": {
      "sha": "fc5efd857f61f7e45c61db567bb66612bcb53128",
      "commit_date": "2021-10-06T19:38:51Z",
      "author": {
        "login": "snipe",
        "type": "User",
        "stats": {
          "total_commits": 11824,
          "average_weekly_commits": 25.648590021691973,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 415
        }
      },
      "commit_message": {
        "title": "Merge pull request #10171 from snipe/fixes/xss_svg_in_file_uploads",
        "length": 86,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 231,
        "additions": 143,
        "deletions": 88
      },
      "files": [
        {
          "filename": "app/Http/Controllers/Assets/AssetFilesController.php",
          "status": "modified",
          "additions": 22,
          "deletions": 2,
          "patch": "@@ -2,14 +2,14 @@\n \n namespace App\\Http\\Controllers\\Assets;\n \n-\n use App\\Http\\Controllers\\Controller;\n use App\\Http\\Requests\\AssetFileRequest;\n use App\\Models\\Actionlog;\n use App\\Models\\Asset;\n use Illuminate\\Support\\Facades\\Response;\n use Illuminate\\Support\\Facades\\Storage;\n use App\\Helpers\\StorageHelper;\n+use enshrined\\svgSanitize\\Sanitizer;\n \n class AssetFilesController extends Controller\n {\n@@ -36,9 +36,29 @@ public function store(AssetFileRequest $request, $assetId = null)\n             if (!Storage::exists('private_uploads/assets')) Storage::makeDirectory('private_uploads/assets', 775);\n \n             foreach ($request->file('file') as $file) {\n+\n                 $extension = $file->getClientOriginalExtension();\n                 $file_name = 'hardware-'.$asset->id.'-'.str_random(8).'-'.str_slug(basename($file->getClientOriginalName(), '.'.$extension)).'.'.$extension;\n-                Storage::put('private_uploads/assets/'.$file_name, file_get_contents($file));\n+\n+                // Check for SVG and sanitize it\n+                if ($extension=='svg') {\n+                    \\Log::debug('This is an SVG');\n+\n+                        $sanitizer = new Sanitizer();\n+                        $dirtySVG = file_get_contents($file->getRealPath());\n+                        $cleanSVG = $sanitizer->sanitize($dirtySVG);\n+\n+                        try {\n+                            Storage::put('private_uploads/assets/'.$file_name, $cleanSVG);\n+                        } catch (\\Exception $e) {\n+                            \\Log::debug('Upload no workie :( ');\n+                            \\Log::debug($e);\n+                        }\n+                } else {\n+                    Storage::put('private_uploads/assets/'.$file_name, file_get_contents($file));\n+                }\n+               \n+                \n                 $asset->logUpload($file_name, e($request->get('notes')));\n             }\n             return redirect()->back()->with('success', trans('admin/hardware/message.upload.success'));"
        },
        {
          "filename": "app/Http/Controllers/Licenses/LicenseFilesController.php",
          "status": "modified",
          "additions": 23,
          "deletions": 12,
          "patch": "@@ -6,11 +6,11 @@\n use App\\Http\\Requests\\AssetFileRequest;\n use App\\Models\\Actionlog;\n use App\\Models\\License;\n-use Illuminate\\Support\\Facades\\Input;\n use Illuminate\\Support\\Facades\\Response;\n use Illuminate\\Support\\Facades\\Storage;\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n use App\\Helpers\\StorageHelper;\n+use enshrined\\svgSanitize\\Sanitizer;\n \n class LicenseFilesController extends Controller\n {\n@@ -37,28 +37,39 @@ public function store(AssetFileRequest $request, $licenseId = null)\n \n                 if (!Storage::exists('private_uploads/licenses')) Storage::makeDirectory('private_uploads/licenses', 775);\n \n-                $upload_success = false;\n                 foreach ($request->file('file') as $file) {\n \n+                    $extension = $file->getClientOriginalExtension();\n+                    $file_name = 'license-'.$license->id.'-'.str_random(8).'-'.str_slug(basename($file->getClientOriginalName(), '.'.$extension)).'.'.$extension;\n \n-                    $file_name = 'license-'.$license->id.'-'.str_random(8).'-'.str_slug(basename($file->getClientOriginalName(), '.'.$file->getClientOriginalExtension())).'.'.$file->getClientOriginalExtension();\n \n+                        // Check for SVG and sanitize it\n+                        if ($extension == 'svg') {\n+                            \\Log::debug('This is an SVG');\n+                            \\Log::debug($file_name);\n \n-                    $upload_success = $file->storeAs('private_uploads/licenses', $file_name);\n-                    // $upload_success = $file->storeAs('private_uploads/licenses/'.$file_name, $file);\n+                                $sanitizer = new Sanitizer();\n+                                $dirtySVG = file_get_contents($file->getRealPath());\n+                                $cleanSVG = $sanitizer->sanitize($dirtySVG);\n+\n+                                try {\n+                                    Storage::put('private_uploads/licenses/'.$file_name, $cleanSVG);\n+                                } catch (\\Exception $e) {\n+                                    \\Log::debug('Upload no workie :( ');\n+                                    \\Log::debug($e);\n+                                }\n+\n+                        } else {\n+                            Storage::put('private_uploads/licenses/'.$file_name, file_get_contents($file));\n+                        }\n \n                     //Log the upload to the log\n                     $license->logUpload($file_name, e($request->input('notes')));\n                 }\n \n-                // This being called from a modal seems to confuse redirect()->back()\n-                // It thinks we should go to the dashboard.  As this is only used\n-                // from the modal at present, hardcode the redirect.  Longterm\n-                // maybe we evaluate something else.\n-                if ($upload_success) {\n+\n                     return redirect()->route('licenses.show', $license->id)->with('success', trans('admin/licenses/message.upload.success'));\n-                }\n-                return redirect()->route('licenses.show', $license->id)->with('error', trans('admin/licenses/message.upload.error'));\n+                \n             }\n             return redirect()->route('licenses.show', $license->id)->with('error', trans('admin/licenses/message.upload.nofiles'));\n         }"
        },
        {
          "filename": "app/Http/Controllers/Users/UserFilesController.php",
          "status": "modified",
          "additions": 27,
          "deletions": 6,
          "patch": "@@ -10,6 +10,8 @@\n use Illuminate\\Support\\Facades\\Input;\n use Illuminate\\Support\\Facades\\Response;\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n+use enshrined\\svgSanitize\\Sanitizer;\n+use Illuminate\\Support\\Facades\\Storage;\n \n class UserFilesController extends Controller\n {\n@@ -38,12 +40,31 @@ public function store(AssetFileRequest $request, $userId = null)\n                 return redirect()->back()->with('error', trans('admin/users/message.upload.nofiles'));\n             }\n             foreach($files as $file) {\n+                \n                 $extension = $file->getClientOriginalExtension();\n-                $filename = 'user-' . $user->id . '-' . str_random(8);\n-                $filename .= '-' . str_slug($file->getClientOriginalName()) . '.' . $extension;\n-                if (!$file->move($destinationPath, $filename)) {\n-                    return redirect()->back()->with('error', trans('admin/users/message.upload.invalidfiles'));\n-                }\n+                $file_name = 'user-'.$user->id.'-'.str_random(8).'-'.str_slug(basename($file->getClientOriginalName(), '.'.$extension)).'.'.$extension;\n+\n+\n+                    // Check for SVG and sanitize it\n+                    if ($extension == 'svg') {\n+                        \\Log::debug('This is an SVG');\n+                        \\Log::debug($file_name);\n+\n+                            $sanitizer = new Sanitizer();\n+                            $dirtySVG = file_get_contents($file->getRealPath());\n+                            $cleanSVG = $sanitizer->sanitize($dirtySVG);\n+\n+                            try {\n+                                Storage::put('private_uploads/users/'.$file_name, $cleanSVG);\n+                            } catch (\\Exception $e) {\n+                                \\Log::debug('Upload no workie :( ');\n+                                \\Log::debug($e);\n+                            }\n+\n+                    } else {\n+                        Storage::put('private_uploads/users/'.$file_name, file_get_contents($file));\n+                    }\n+\n                 //Log the uploaded file to the log\n                 $logAction = new Actionlog();\n                 $logAction->item_id = $user->id;\n@@ -52,7 +73,7 @@ public function store(AssetFileRequest $request, $userId = null)\n                 $logAction->note = $request->input('notes');\n                 $logAction->target_id = null;\n                 $logAction->created_at = date(\"Y-m-d H:i:s\");\n-                $logAction->filename = $filename;\n+                $logAction->filename = $file_name;\n                 $logAction->action_type = 'uploaded';\n \n                 if (!$logAction->save()) {"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 61,
          "deletions": 61,
          "patch": "@@ -1501,7 +1501,7 @@\n     \"accepts\": {\n       \"version\": \"1.3.7\",\n       \"resolved\": \"https://registry.npmjs.org/accepts/-/accepts-1.3.7.tgz\",\n-      \"integrity\": \"sha1-UxvHJlF6OytB+FACHGzBXqq1B80=\",\n+      \"integrity\": \"sha512-Il80Qs2WjYlJIBNzNkK6KYqlVMTbZLXgHx2oT0pU/fjRHyEp+PEfEPY0R3WCwAGVOtauxh1hOxNgIf5bv7dQpA==\",\n       \"dev\": true,\n       \"requires\": {\n         \"mime-types\": \"~2.1.24\",\n@@ -1720,7 +1720,7 @@\n     \"array-flatten\": {\n       \"version\": \"2.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/array-flatten/-/array-flatten-2.1.2.tgz\",\n-      \"integrity\": \"sha1-JO+AoowaiTYX4hSbDG0NeIKTsJk=\",\n+      \"integrity\": \"sha512-hNfzcOV8W4NdualtqBFPyVO+54DSJuZGY9qT4pRroB6S9e3iiido2ISIC5h9R2sPJ8H3FHCIiEnsv1lPXO3KtQ==\",\n       \"dev\": true\n     },\n     \"array-union\": {\n@@ -1818,7 +1818,7 @@\n     \"async\": {\n       \"version\": \"2.6.3\",\n       \"resolved\": \"https://registry.npmjs.org/async/-/async-2.6.3.tgz\",\n-      \"integrity\": \"sha1-1yYl4jRKNlbjo61Pp0n6gymdgv8=\",\n+      \"integrity\": \"sha512-zflvls11DCy+dQWzTW2dzuilv8Z5X/pjfmZOWba6TNIVDm+2UDaJmXSOXlasHKfNBs8oo3M0aT50fDEWfKZjXg==\",\n       \"requires\": {\n         \"lodash\": \"^4.17.14\"\n       }\n@@ -1838,7 +1838,7 @@\n     \"atob\": {\n       \"version\": \"2.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/atob/-/atob-2.1.2.tgz\",\n-      \"integrity\": \"sha1-bZUX654DDSQ2ZmZR6GvZ9vE1M8k=\"\n+      \"integrity\": \"sha512-Wm6ukoaOGJi/73p/cl2GvLjTI5JM1k/O14isD73YML8StrH/7/lRFgmg8nICZgD3bZZvjwCGxtMOD3wWNAu8cg==\"\n     },\n     \"autoprefixer\": {\n       \"version\": \"9.8.6\",\n@@ -2576,7 +2576,7 @@\n     \"bluebird\": {\n       \"version\": \"3.7.2\",\n       \"resolved\": \"https://registry.npmjs.org/bluebird/-/bluebird-3.7.2.tgz\",\n-      \"integrity\": \"sha1-nyKcFb4nJFT/qXOs4NvueaGww28=\",\n+      \"integrity\": \"sha512-XpNj6GDQzdfW+r2Wnn7xiSAd7TM3jzkxGXBGTtWKuSXv1xUV+azxAm8jdWZN06QTQk+2N2XB9jRDkvbmQmcRtg==\",\n       \"dev\": true\n     },\n     \"blueimp-canvas-to-blob\": {\n@@ -2615,7 +2615,7 @@\n     \"body-parser\": {\n       \"version\": \"1.19.0\",\n       \"resolved\": \"https://registry.npmjs.org/body-parser/-/body-parser-1.19.0.tgz\",\n-      \"integrity\": \"sha1-lrJwnlfJxOCab9Zqj9l5hE9p8Io=\",\n+      \"integrity\": \"sha512-dhEPs72UPbDnAQJ9ZKMNTP6ptJaionhP5cBb541nXPlW60Jepo9RV/a4fX4XWW9CuFNK22krhrj1+rgzifNCsw==\",\n       \"dev\": true,\n       \"requires\": {\n         \"bytes\": \"3.1.0\",\n@@ -2633,7 +2633,7 @@\n         \"bytes\": {\n           \"version\": \"3.1.0\",\n           \"resolved\": \"https://registry.npmjs.org/bytes/-/bytes-3.1.0.tgz\",\n-          \"integrity\": \"sha1-9s95M6Ng4FiPqf3oVlHNx/gF0fY=\",\n+          \"integrity\": \"sha512-zauLjrfCG+xvoyaqLoV8bLVXXNGC4JqlxFCutSDWA6fJrTo2ZuvLYTqZ7aHBLZSMOopbzwv8f+wZcVzfVTI2Dg==\",\n           \"dev\": true\n         },\n         \"qs\": {\n@@ -3009,7 +3009,7 @@\n     \"buffer-indexof\": {\n       \"version\": \"1.1.1\",\n       \"resolved\": \"https://registry.npmjs.org/buffer-indexof/-/buffer-indexof-1.1.1.tgz\",\n-      \"integrity\": \"sha1-Uvq8xqYG0aADAoAmSO9o9jnaJow=\",\n+      \"integrity\": \"sha512-4/rOEg86jivtPTeOUUT61jJO1Ya1TrR/OkqCSZDyq84WJh3LuuiphBYJN+fm5xufIk4XAFcEwte/8WzC8If/1g==\",\n       \"dev\": true\n     },\n     \"buffer-xor\": {\n@@ -3609,7 +3609,7 @@\n     \"combined-stream\": {\n       \"version\": \"1.0.8\",\n       \"resolved\": \"https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz\",\n-      \"integrity\": \"sha1-w9RaizT9cwYxoRCoolIGgrMdWn8=\",\n+      \"integrity\": \"sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==\",\n       \"requires\": {\n         \"delayed-stream\": \"~1.0.0\"\n       }\n@@ -3634,7 +3634,7 @@\n     \"compressible\": {\n       \"version\": \"2.0.18\",\n       \"resolved\": \"https://registry.npmjs.org/compressible/-/compressible-2.0.18.tgz\",\n-      \"integrity\": \"sha1-r1PMprBw1MPAdQ+9dyhqbXzEb7o=\",\n+      \"integrity\": \"sha512-AF3r7P5dWxL8MxyITRMlORQNaOA2IkAFaTr4k7BUumjPtRpGDTZpl0Pb1XCO6JeDCBdp126Cgs9sMxqSjgYyRg==\",\n       \"dev\": true,\n       \"requires\": {\n         \"mime-db\": \">= 1.43.0 < 2\"\n@@ -3643,7 +3643,7 @@\n     \"compression\": {\n       \"version\": \"1.7.4\",\n       \"resolved\": \"https://registry.npmjs.org/compression/-/compression-1.7.4.tgz\",\n-      \"integrity\": \"sha1-lVI+/xcMpXwpoMpB5v4TH0Hlu48=\",\n+      \"integrity\": \"sha512-jaSIDzP9pZVS4ZfQ+TzvtiWhdpFhE2RDHz8QJkpX9SIpLq88VueF5jJw6t+6CUQcAoA6t+x89MLrWAqpfDE8iQ==\",\n       \"dev\": true,\n       \"requires\": {\n         \"accepts\": \"~1.3.5\",\n@@ -3682,7 +3682,7 @@\n     \"connect-history-api-fallback\": {\n       \"version\": \"1.6.0\",\n       \"resolved\": \"https://registry.npmjs.org/connect-history-api-fallback/-/connect-history-api-fallback-1.6.0.tgz\",\n-      \"integrity\": \"sha1-izIIk1kwjRERFdgcrT/Oq4iPl7w=\",\n+      \"integrity\": \"sha512-e54B99q/OUoH64zYYRf3HBP5z24G38h5D3qXu23JGRoigpX5Ss4r9ZnDk3g0Z8uQC2x2lPaJ+UlWBc1ZWBWdLg==\",\n       \"dev\": true\n     },\n     \"console-browserify\": {\n@@ -3707,7 +3707,7 @@\n     \"content-disposition\": {\n       \"version\": \"0.5.3\",\n       \"resolved\": \"https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.3.tgz\",\n-      \"integrity\": \"sha1-4TDK9+cnkIfFYWwgB9BIVpiYT70=\",\n+      \"integrity\": \"sha512-ExO0774ikEObIAEV9kDo50o+79VCUdEB6n6lzKgGwupcVeRlhrj3qGAfwq8G6uBJjkqLrhT0qEYFcWng8z1z0g==\",\n       \"dev\": true,\n       \"requires\": {\n         \"safe-buffer\": \"5.1.2\"\n@@ -3716,7 +3716,7 @@\n     \"content-type\": {\n       \"version\": \"1.0.4\",\n       \"resolved\": \"https://registry.npmjs.org/content-type/-/content-type-1.0.4.tgz\",\n-      \"integrity\": \"sha1-4TjMdeBAxyexlm/l5fjJruJW/js=\",\n+      \"integrity\": \"sha512-hIP3EEPs8tB9AT1L+NUqtwOAps4mk2Zob89MWXMHjHWg9milF/j4osnnQLXBCBFBk/tvIG/tUc9mOUJiPBhPXA==\",\n       \"dev\": true\n     },\n     \"convert-source-map\": {\n@@ -3731,7 +3731,7 @@\n     \"cookie\": {\n       \"version\": \"0.4.0\",\n       \"resolved\": \"https://registry.npmjs.org/cookie/-/cookie-0.4.0.tgz\",\n-      \"integrity\": \"sha1-vrQ35wIrO21JAZ0IhmUwPr6cFLo=\",\n+      \"integrity\": \"sha512-+Hp8fLp57wnUSt0tY0tHEXh4voZRDnoIrZPqlo3DPiI4y9lwg/jqx+1Om94/W6ZaPDOUbnjOt/99w66zk+l1Xg==\",\n       \"dev\": true\n     },\n     \"cookie-signature\": {\n@@ -4641,7 +4641,7 @@\n     \"error-ex\": {\n       \"version\": \"1.3.2\",\n       \"resolved\": \"https://registry.npmjs.org/error-ex/-/error-ex-1.3.2.tgz\",\n-      \"integrity\": \"sha1-tKxAZIEH/c3PriQvQovqihTU8b8=\",\n+      \"integrity\": \"sha512-7dFHNmqeFSEt2ZBsCriorKnn3Z2pj+fd9kmI6QoWw4//DL+icEBfc0U7qJCisqrTsKTjw4fNFy2pW9OqStD84g==\",\n       \"dev\": true,\n       \"requires\": {\n         \"is-arrayish\": \"^0.2.1\"\n@@ -4774,7 +4774,7 @@\n     \"estraverse\": {\n       \"version\": \"4.3.0\",\n       \"resolved\": \"https://registry.npmjs.org/estraverse/-/estraverse-4.3.0.tgz\",\n-      \"integrity\": \"sha1-OYrT88WiSUi+dyXoPRGn3ijNvR0=\"\n+      \"integrity\": \"sha512-39nnKffWz8xN1BU/2c79n9nB9HDzo0niYUqx6xyqUnyoAnQyyWpOTdZEeiCch8BBu515t4wp9ZmgVfVhn9EBpw==\"\n     },\n     \"esutils\": {\n       \"version\": \"2.0.3\",\n@@ -4976,7 +4976,7 @@\n     \"express\": {\n       \"version\": \"4.17.1\",\n       \"resolved\": \"https://registry.npmjs.org/express/-/express-4.17.1.tgz\",\n-      \"integrity\": \"sha1-RJH8OGBc9R+GKdOcK10Cb5ikwTQ=\",\n+      \"integrity\": \"sha512-mHJ9O79RqluphRrcw2X/GTh3k9tVv8YcoyY4Kkh4WDMUYKRZUq0h1o0w2rrrxBqM7VoeUVqgb27xlEMXTnYt4g==\",\n       \"dev\": true,\n       \"requires\": {\n         \"accepts\": \"~1.3.7\",\n@@ -5241,7 +5241,7 @@\n     \"finalhandler\": {\n       \"version\": \"1.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/finalhandler/-/finalhandler-1.1.2.tgz\",\n-      \"integrity\": \"sha1-t+fQAP/RGTjQ/bBTUG9uur6fWH0=\",\n+      \"integrity\": \"sha512-aAWcW57uxVNrQZqFXjITpW3sIUQmHGG3qSb9mUah9MgMC4NeWhNOlNjXEYq3HjRAvL6arUviZGGJsBg6z0zsWA==\",\n       \"dev\": true,\n       \"requires\": {\n         \"debug\": \"2.6.9\",\n@@ -15134,7 +15134,7 @@\n     \"handle-thing\": {\n       \"version\": \"2.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/handle-thing/-/handle-thing-2.0.1.tgz\",\n-      \"integrity\": \"sha1-hX95zjWVgMNA1DCBzGSJcNC7I04=\",\n+      \"integrity\": \"sha512-9Qn4yBxelxoh2Ow62nP+Ka/kMnOXRi8BXnRaUwezLNhqelnN49xKz4F/dPP8OYLxLxq6JDtZb2i9XznUQbNPTg==\",\n       \"dev\": true\n     },\n     \"har-validator\": {\n@@ -15421,7 +15421,7 @@\n     \"http-errors\": {\n       \"version\": \"1.7.2\",\n       \"resolved\": \"https://registry.npmjs.org/http-errors/-/http-errors-1.7.2.tgz\",\n-      \"integrity\": \"sha1-T1ApzxMjnzEDblsuVSkrz7zIXI8=\",\n+      \"integrity\": \"sha512-uUQBt3H/cSIVfch6i1EuPNy/YsRSOUBXTVfZ+yR7Zjez3qjBz6i9+i4zjNaoqcoFVI4lQJ5plg63TvGfRSDCRg==\",\n       \"dev\": true,\n       \"requires\": {\n         \"depd\": \"~1.1.2\",\n@@ -15491,7 +15491,7 @@\n     \"iconv-lite\": {\n       \"version\": \"0.4.24\",\n       \"resolved\": \"https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.4.24.tgz\",\n-      \"integrity\": \"sha1-ICK0sl+93CHS9SSXSkdKr+czkIs=\",\n+      \"integrity\": \"sha512-v3MXnZAcvnywkTUEZomIActle7RXXeedOR31wwl7VlyoXO4Qi9arvSenNQWne1TcRwhCL1HwLI21bEqdpj8/rA==\",\n       \"requires\": {\n         \"safer-buffer\": \">= 2.1.2 < 3\"\n       }\n@@ -15970,7 +15970,7 @@\n     \"is-glob\": {\n       \"version\": \"4.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/is-glob/-/is-glob-4.0.1.tgz\",\n-      \"integrity\": \"sha1-dWfb6fL14kZ7x3q4PEopSCQHpdw=\",\n+      \"integrity\": \"sha512-5G0tKtBTFImOqDnLB2hG6Bp2qcKEFduo4tZu9MT/H6NQv/ghhy30o55ufafxJ/LdH79LLs2Kfrn85TLKyA7BUg==\",\n       \"dev\": true,\n       \"requires\": {\n         \"is-extglob\": \"^2.1.1\"\n@@ -16050,7 +16050,7 @@\n     \"is-plain-object\": {\n       \"version\": \"2.0.4\",\n       \"resolved\": \"https://registry.npmjs.org/is-plain-object/-/is-plain-object-2.0.4.tgz\",\n-      \"integrity\": \"sha1-LBY7P6+xtgbZ0Xko8FwqHDjgdnc=\",\n+      \"integrity\": \"sha512-h5PpgXkWitc38BBMYawTYMWJHFZJVnBquFE57xFpjB8pJFiF6gZ+bU+WyI/yqXiFR5mdLsgYNaPe8uao6Uv9Og==\",\n       \"dev\": true,\n       \"requires\": {\n         \"isobject\": \"^3.0.1\"\n@@ -16313,7 +16313,7 @@\n     \"json-parse-better-errors\": {\n       \"version\": \"1.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/json-parse-better-errors/-/json-parse-better-errors-1.0.2.tgz\",\n-      \"integrity\": \"sha1-u4Z8+zRQ5pEHwTHRxRS6s9yLyqk=\",\n+      \"integrity\": \"sha512-mrqyZKfX5EhL7hvqcV6WG1yYjnjeuYDzDhhcAAUrq8Po85NBQBJP+ZDUT75qZQ98IkUoBqdkExkukOU7Ts2wrw==\",\n       \"dev\": true\n     },\n     \"json-schema\": {\n@@ -17121,7 +17121,7 @@\n     \"mime\": {\n       \"version\": \"1.6.0\",\n       \"resolved\": \"https://registry.npmjs.org/mime/-/mime-1.6.0.tgz\",\n-      \"integrity\": \"sha1-Ms2eXGRVO9WNGaVor0Uqz/BJgbE=\"\n+      \"integrity\": \"sha512-x0Vn8spI+wuJ1O6S7gnbaQg8Pxh4NNHb7KSINmEWKiPE4RKOplvijn+NkmYmmRgP68mc70j2EbeTFRsrswaQeg==\"\n     },\n     \"mime-db\": {\n       \"version\": \"1.46.0\",\n@@ -17139,7 +17139,7 @@\n     \"mimic-response\": {\n       \"version\": \"1.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/mimic-response/-/mimic-response-1.0.1.tgz\",\n-      \"integrity\": \"sha1-SSNTiHju9CBjy4o+OweYeBSHqxs=\"\n+      \"integrity\": \"sha512-j5EctnkH7amfV/q5Hgmoal1g2QHFJRraOtmx0JpIqkxhBhI/lJSl1nMpQ45hVarwNETOoWEimndZ4QK0RHxuxQ==\"\n     },\n     \"minimalistic-assert\": {\n       \"version\": \"1.0.1\",\n@@ -17373,7 +17373,7 @@\n     \"multicast-dns\": {\n       \"version\": \"6.2.3\",\n       \"resolved\": \"https://registry.npmjs.org/multicast-dns/-/multicast-dns-6.2.3.tgz\",\n-      \"integrity\": \"sha1-oOx72QVcQoL3kMPIL04o2zsxsik=\",\n+      \"integrity\": \"sha512-ji6J5enbMyGRHIAkAOu3WdV8nggqviKCEKtXcOqfphZZtQrmHKycfynJ2V7eVPUA4NhJ6V7Wf4TmGbTwKE9B6g==\",\n       \"dev\": true,\n       \"requires\": {\n         \"dns-packet\": \"^1.3.1\",\n@@ -17448,7 +17448,7 @@\n     \"negotiator\": {\n       \"version\": \"0.6.2\",\n       \"resolved\": \"https://registry.npmjs.org/negotiator/-/negotiator-0.6.2.tgz\",\n-      \"integrity\": \"sha1-/qz3zPUlp3rpY0Q2pkiD/+yjRvs=\",\n+      \"integrity\": \"sha512-hZXc7K2e+PgeI1eDBe/10Ard4ekbfrrqG8Ep+8Jmf4JID2bNg7NvCPOZN+kfF574pFQI7mum2AUqDidoKqcTOw==\",\n       \"dev\": true\n     },\n     \"neo-async\": {\n@@ -17481,7 +17481,7 @@\n     \"node-libs-browser\": {\n       \"version\": \"2.2.1\",\n       \"resolved\": \"https://registry.npmjs.org/node-libs-browser/-/node-libs-browser-2.2.1.tgz\",\n-      \"integrity\": \"sha1-tk9RPRgzhiX5A0bSew0jXmMfZCU=\",\n+      \"integrity\": \"sha512-h/zcD8H9kaDZ9ALUWwlBUDo6TKF8a7qBSCSEGfjTVIYeqsioSKaAX+BN7NgiMGp6iSIXZ3PxgCu8KS3b71YK5Q==\",\n       \"dev\": true,\n       \"requires\": {\n         \"assert\": \"^1.1.1\",\n@@ -17622,7 +17622,7 @@\n         \"util\": {\n           \"version\": \"0.11.1\",\n           \"resolved\": \"https://registry.npmjs.org/util/-/util-0.11.1.tgz\",\n-          \"integrity\": \"sha1-MjZzNyDsZLsn9uJvQhqqLhtYjWE=\",\n+          \"integrity\": \"sha512-HShAsny+zS2TZfaXxD9tYj4HQGlBezXZMZuM/S5PKLLoZkShZiGk9o5CzukI1LVHZvjdvZ2Sj1aW/Ndn2NB/HQ==\",\n           \"dev\": true,\n           \"requires\": {\n             \"inherits\": \"2.0.3\"\n@@ -17914,7 +17914,7 @@\n     \"obuf\": {\n       \"version\": \"1.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/obuf/-/obuf-1.1.2.tgz\",\n-      \"integrity\": \"sha1-Cb6jND1BhZ69RGKS0RydTbYZCE4=\",\n+      \"integrity\": \"sha512-PX1wu0AmAdPqOL1mWhqmlOd8kOIZQwGZw6rh7uby9fTc5lhaOWFLX3I6R1hrF9k3zUY40e6igsLGkDXK92LJNg==\",\n       \"dev\": true\n     },\n     \"omggif\": {\n@@ -17934,7 +17934,7 @@\n     \"on-headers\": {\n       \"version\": \"1.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/on-headers/-/on-headers-1.0.2.tgz\",\n-      \"integrity\": \"sha1-dysK5qqlJcOZ5Imt+tkMQD6zwo8=\",\n+      \"integrity\": \"sha512-pZAE+FJLoyITytdqK0U5s+FIpjN0JP3OzFi/u8Rx+EV5/W+JTWGXG8xFzevE7AjBfDqHv/8vL8qQsIhHnqRkrA==\",\n       \"dev\": true\n     },\n     \"once\": {\n@@ -18175,7 +18175,7 @@\n     \"parseurl\": {\n       \"version\": \"1.3.3\",\n       \"resolved\": \"https://registry.npmjs.org/parseurl/-/parseurl-1.3.3.tgz\",\n-      \"integrity\": \"sha1-naGee+6NEt/wUT7Vt2lXeTvC6NQ=\",\n+      \"integrity\": \"sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ==\",\n       \"dev\": true\n     },\n     \"pascalcase\": {\n@@ -19012,7 +19012,7 @@\n     \"prettier\": {\n       \"version\": \"1.19.1\",\n       \"resolved\": \"https://registry.npmjs.org/prettier/-/prettier-1.19.1.tgz\",\n-      \"integrity\": \"sha1-99f1/4qc2HKnvkyhQglZVqYHl8s=\",\n+      \"integrity\": \"sha512-s7PoyDv/II1ObgQunCbB9PdLmUcBZcnWOcxDh7O0N/UwDEsHyqkW+Qh28jW+mVuCdx7gLB0BotYI1Y6uI9iyew==\",\n       \"dev\": true,\n       \"optional\": true\n     },\n@@ -19198,7 +19198,7 @@\n     \"range-parser\": {\n       \"version\": \"1.2.1\",\n       \"resolved\": \"https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz\",\n-      \"integrity\": \"sha1-PPNwI9GZ4cJNGlW4SADC8+ZGgDE=\",\n+      \"integrity\": \"sha512-Hrgsx+orqoygnmhFbKaHE6c296J+HTAQXoxEF6gNupROmmGJRoyzfG3ccAveqCBrwr/2yxQ5BVd/GTl5agOwSg==\",\n       \"dev\": true\n     },\n     \"raphael\": {\n@@ -19212,7 +19212,7 @@\n     \"raw-body\": {\n       \"version\": \"2.4.0\",\n       \"resolved\": \"https://registry.npmjs.org/raw-body/-/raw-body-2.4.0.tgz\",\n-      \"integrity\": \"sha1-oc5vucm8NWylLoklarWQWeE9AzI=\",\n+      \"integrity\": \"sha512-4Oz8DUIwdvoa5qMJelxipzi/iJIi40O5cGV1wNYp5hvZP8ZN0T+jiNkL0QepXs+EsQ9XJ8ipEDoiH70ySUJP3Q==\",\n       \"dev\": true,\n       \"requires\": {\n         \"bytes\": \"3.1.0\",\n@@ -19224,7 +19224,7 @@\n         \"bytes\": {\n           \"version\": \"3.1.0\",\n           \"resolved\": \"https://registry.npmjs.org/bytes/-/bytes-3.1.0.tgz\",\n-          \"integrity\": \"sha1-9s95M6Ng4FiPqf3oVlHNx/gF0fY=\",\n+          \"integrity\": \"sha512-zauLjrfCG+xvoyaqLoV8bLVXXNGC4JqlxFCutSDWA6fJrTo2ZuvLYTqZ7aHBLZSMOopbzwv8f+wZcVzfVTI2Dg==\",\n           \"dev\": true\n         }\n       }\n@@ -19630,7 +19630,7 @@\n     \"sax\": {\n       \"version\": \"1.2.4\",\n       \"resolved\": \"https://registry.npmjs.org/sax/-/sax-1.2.4.tgz\",\n-      \"integrity\": \"sha1-KBYjTiN4vdxOU1T6tcqold9xANk=\"\n+      \"integrity\": \"sha512-NqVDv9TpANUjFm0N8uM5GxL36UgKi9/atZw+x7YFnQ8ckwFGKrl4xX4yWtrey3UJm5nP1kUbnYgLopqWNSRhWw==\"\n     },\n     \"schema-utils\": {\n       \"version\": \"2.7.1\",\n@@ -19670,7 +19670,7 @@\n     \"send\": {\n       \"version\": \"0.17.1\",\n       \"resolved\": \"https://registry.npmjs.org/send/-/send-0.17.1.tgz\",\n-      \"integrity\": \"sha1-wdiwWfeQD3Rm3Uk4vcROEd2zdsg=\",\n+      \"integrity\": \"sha512-BsVKsiGcQMFwT8UxypobUKyv7irCNRHk1T0G680vk88yf6LBByGcZJOTJCrTP2xVN6yI+XjPJcNuE3V4fT9sAg==\",\n       \"dev\": true,\n       \"requires\": {\n         \"debug\": \"2.6.9\",\n@@ -19691,7 +19691,7 @@\n         \"ms\": {\n           \"version\": \"2.1.1\",\n           \"resolved\": \"https://registry.npmjs.org/ms/-/ms-2.1.1.tgz\",\n-          \"integrity\": \"sha1-MKWGTrPrsKZvLr5tcnrwagnYbgo=\",\n+          \"integrity\": \"sha512-tgp+dl5cGk28utYktBsrFqA7HKgrhgPsg6Z/EfhWI4gl1Hwq8B/GmY/0oXZ6nF8hDVesS/FpnYaD/kOWhYQvyg==\",\n           \"dev\": true\n         }\n       }\n@@ -19741,15 +19741,15 @@\n         \"setprototypeof\": {\n           \"version\": \"1.1.0\",\n           \"resolved\": \"https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.1.0.tgz\",\n-          \"integrity\": \"sha1-0L2FU2iHtv58DYGMuWLZ2RxU5lY=\",\n+          \"integrity\": \"sha512-BvE/TwpZX4FXExxOxZyRGQQv651MSwmWKZGqvmPcRIjDqWub67kTKuIMx43cZZrS/cBBzwBcNDWoFxt2XEFIpQ==\",\n           \"dev\": true\n         }\n       }\n     },\n     \"serve-static\": {\n       \"version\": \"1.14.1\",\n       \"resolved\": \"https://registry.npmjs.org/serve-static/-/serve-static-1.14.1.tgz\",\n-      \"integrity\": \"sha1-Zm5jbcTwEPfvKZcKiKZ0MgiYsvk=\",\n+      \"integrity\": \"sha512-JMrvUwE54emCYWlTI+hGrGv5I8dEwmco/00EvkzIIsR7MqrHonbD9pO2MOfFnpFntl7ecpZs+3mW+XbQZu9QCg==\",\n       \"dev\": true,\n       \"requires\": {\n         \"encodeurl\": \"~1.0.2\",\n@@ -19785,7 +19785,7 @@\n     \"setprototypeof\": {\n       \"version\": \"1.1.1\",\n       \"resolved\": \"https://registry.npmjs.org/setprototypeof/-/setprototypeof-1.1.1.tgz\",\n-      \"integrity\": \"sha1-fpWsskqpL1iF4KvvW6ExMw1K5oM=\",\n+      \"integrity\": \"sha512-JvdAWfbXeIGaZ9cILp38HntZSFSo3mWg6xGcJJsd+d4aRMOqauag1C63dJfDw7OaMYwEbHMOxEZ1lqVRYP2OAw==\",\n       \"dev\": true\n     },\n     \"sha.js\": {\n@@ -19833,7 +19833,7 @@\n     \"shellwords\": {\n       \"version\": \"0.1.1\",\n       \"resolved\": \"https://registry.npmjs.org/shellwords/-/shellwords-0.1.1.tgz\",\n-      \"integrity\": \"sha1-1rkYHBpI05cyTISHHvvPxz/AZUs=\",\n+      \"integrity\": \"sha512-vFwSUfQvqybiICwZY5+DAWIPLKsWO31Q91JSKl3UYv+K5c2QRPzn0qzec6QPu1Qc9eHYItiP3NdJqNVqetYAww==\",\n       \"dev\": true\n     },\n     \"signal-exit\": {\n@@ -20037,7 +20037,7 @@\n     \"source-list-map\": {\n       \"version\": \"2.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/source-list-map/-/source-list-map-2.0.1.tgz\",\n-      \"integrity\": \"sha1-OZO9hzv8SEecyp6jpUeDXHwVSzQ=\",\n+      \"integrity\": \"sha512-qnQ7gVMxGNxsiL4lEuJwe/To8UnK7fAnmbGEEH8RpLouuKbeEm0lhbQVFIrNSuB+G7tVrAlVsZgETT5nljf+Iw==\",\n       \"dev\": true\n     },\n     \"source-map\": {\n@@ -20085,7 +20085,7 @@\n     \"spdy\": {\n       \"version\": \"4.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/spdy/-/spdy-4.0.2.tgz\",\n-      \"integrity\": \"sha1-t09GYgOj7aRSwCSSuR+56EonZ3s=\",\n+      \"integrity\": \"sha512-r46gZQZQV+Kl9oItvl1JZZqJKGr+oEkB08A6BzkiR7593/7IbtuncXHd2YoYeTsG4157ZssMu9KYvUHLcjcDoA==\",\n       \"dev\": true,\n       \"requires\": {\n         \"debug\": \"^4.1.0\",\n@@ -20107,15 +20107,15 @@\n         \"ms\": {\n           \"version\": \"2.1.2\",\n           \"resolved\": \"https://registry.npmjs.org/ms/-/ms-2.1.2.tgz\",\n-          \"integrity\": \"sha1-0J0fNXtEP0kzgqjrPM0YOHKuYAk=\",\n+          \"integrity\": \"sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==\",\n           \"dev\": true\n         }\n       }\n     },\n     \"spdy-transport\": {\n       \"version\": \"3.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/spdy-transport/-/spdy-transport-3.0.0.tgz\",\n-      \"integrity\": \"sha1-ANSGOmQArXXfkzYaFghgXl3NzzE=\",\n+      \"integrity\": \"sha512-hsLVFE5SjA6TCisWeJXFKniGGOpBgMLmerfO2aCyCU5s7nJ/rpAepqmFifv/GCbSbueEeAJJnmSQ2rKC/g8Fcw==\",\n       \"dev\": true,\n       \"requires\": {\n         \"debug\": \"^4.1.0\",\n@@ -20138,13 +20138,13 @@\n         \"ms\": {\n           \"version\": \"2.1.2\",\n           \"resolved\": \"https://registry.npmjs.org/ms/-/ms-2.1.2.tgz\",\n-          \"integrity\": \"sha1-0J0fNXtEP0kzgqjrPM0YOHKuYAk=\",\n+          \"integrity\": \"sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w==\",\n           \"dev\": true\n         },\n         \"readable-stream\": {\n           \"version\": \"3.6.0\",\n           \"resolved\": \"https://registry.npmjs.org/readable-stream/-/readable-stream-3.6.0.tgz\",\n-          \"integrity\": \"sha1-M3u9o63AcGvT4CRCaihtS0sskZg=\",\n+          \"integrity\": \"sha512-BViHy7LKeTz4oNnkcLJ+lVSL6vpiFeX6/d3oSH8zCW7UxP2onchk+vTGB143xuFjHS3deTgkKoXXymXqymiIdA==\",\n           \"dev\": true,\n           \"requires\": {\n             \"inherits\": \"^2.0.3\",\n@@ -20782,7 +20782,7 @@\n     \"thunky\": {\n       \"version\": \"1.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/thunky/-/thunky-1.1.0.tgz\",\n-      \"integrity\": \"sha1-Wrr3FKlAXbBQRzK7zNLO3Z75U30=\",\n+      \"integrity\": \"sha512-eHY7nBftgThBqOyHGVN+l8gF0BucP09fMo0oO/Lb0w1OF80dJv+lDVpXG60WMQvkcxAkNybKsrEIE3ZtKGmPrA==\",\n       \"dev\": true\n     },\n     \"timed-out\": {\n@@ -20871,7 +20871,7 @@\n     \"toidentifier\": {\n       \"version\": \"1.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/toidentifier/-/toidentifier-1.0.0.tgz\",\n-      \"integrity\": \"sha1-fhvjRw8ed5SLxD2Uo8j013UrpVM=\",\n+      \"integrity\": \"sha512-yaOH/Pk/VEhBWWTlhI+qXxDFXlejDGcQipMlyxda9nthulaxLZUNcUqFxokp0vcYnvteJln5FNQDRrxj3YcbVw==\",\n       \"dev\": true\n     },\n     \"tough-cookie\": {\n@@ -20915,7 +20915,7 @@\n     \"type-is\": {\n       \"version\": \"1.6.18\",\n       \"resolved\": \"https://registry.npmjs.org/type-is/-/type-is-1.6.18.tgz\",\n-      \"integrity\": \"sha1-TlUs0F3wlGfcvE73Od6J8s83wTE=\",\n+      \"integrity\": \"sha512-TkRKr9sUTxEH8MdfuCSP7VizJyzRNMjj2J2do2Jr3Kym598JVdEksuzPQCnlFPW4ky9Q+iA+ma9BGm06XQBy8g==\",\n       \"dev\": true,\n       \"requires\": {\n         \"media-typer\": \"0.3.0\",\n@@ -21238,7 +21238,7 @@\n     \"uuid\": {\n       \"version\": \"3.4.0\",\n       \"resolved\": \"https://registry.npmjs.org/uuid/-/uuid-3.4.0.tgz\",\n-      \"integrity\": \"sha1-sj5DWK+oogL+ehAK8fX4g/AgB+4=\",\n+      \"integrity\": \"sha512-HjSDRw6gZE5JMggctHBcjVak08+KEVhSIiDzFnT9S9aegmp85S/bReBVTb4QTFaRNptJ9kuYaNhnbNEOkbKb/A==\",\n       \"dev\": true\n     },\n     \"v8-compile-cache\": {\n@@ -21256,7 +21256,7 @@\n     \"vendors\": {\n       \"version\": \"1.0.4\",\n       \"resolved\": \"https://registry.npmjs.org/vendors/-/vendors-1.0.4.tgz\",\n-      \"integrity\": \"sha1-4rgApT56Kbk1BsPPQRANFsTErY4=\",\n+      \"integrity\": \"sha512-/juG65kTL4Cy2su4P8HjtkTxk6VmJDiOPBufWniqQ6wknac6jNiXS9vU+hO3wgusiyqWlzTbVHi0dyJqRONg3w==\",\n       \"dev\": true\n     },\n     \"verror\": {\n@@ -21290,7 +21290,7 @@\n     \"vue-hot-reload-api\": {\n       \"version\": \"2.3.4\",\n       \"resolved\": \"https://registry.npmjs.org/vue-hot-reload-api/-/vue-hot-reload-api-2.3.4.tgz\",\n-      \"integrity\": \"sha1-UylVzB6yCKPZkLOp+acFdGV+CPI=\",\n+      \"integrity\": \"sha512-BXq3jwIagosjgNVae6tkHzzIk6a8MHFtzAdwhnV5VlvPTFxDCvIttgSiHWjdGoTJvXtmRu5HacExfdarRcFhog==\",\n       \"dev\": true\n     },\n     \"vue-loader\": {\n@@ -21337,7 +21337,7 @@\n     \"vue-template-es2015-compiler\": {\n       \"version\": \"1.9.1\",\n       \"resolved\": \"https://registry.npmjs.org/vue-template-es2015-compiler/-/vue-template-es2015-compiler-1.9.1.tgz\",\n-      \"integrity\": \"sha1-HuO8mhbsv1EYvjNLsV+cRvgvWCU=\",\n+      \"integrity\": \"sha512-4gDntzrifFnCEvyoO8PqyJDmguXgVPxKiIxrBKjIowvL9l+N66196+72XVYR8BBf1Uv1Fgt3bGevJ+sEmxfZzw==\",\n       \"dev\": true\n     },\n     \"watchpack\": {\n@@ -21476,7 +21476,7 @@\n     \"wbuf\": {\n       \"version\": \"1.7.3\",\n       \"resolved\": \"https://registry.npmjs.org/wbuf/-/wbuf-1.7.3.tgz\",\n-      \"integrity\": \"sha1-wdjRSTFtPqhShIiVy2oL/oh7h98=\",\n+      \"integrity\": \"sha512-O84QOnr0icsbFGLS0O3bI5FswxzRr8/gHwWkDlQFskhSPryQXvrTMxjxGP4+iWYoauLoBvfDpkrOauZ+0iZpDA==\",\n       \"dev\": true,\n       \"requires\": {\n         \"minimalistic-assert\": \"^1.0.0\"\n@@ -22226,7 +22226,7 @@\n     \"webpack-sources\": {\n       \"version\": \"1.4.3\",\n       \"resolved\": \"https://registry.npmjs.org/webpack-sources/-/webpack-sources-1.4.3.tgz\",\n-      \"integrity\": \"sha1-7t2OwLko+/HL/plOItLYkPMwqTM=\",\n+      \"integrity\": \"sha512-lgTS3Xhv1lCOKo7SA5TjKXMjpSM4sBjNV5+q2bqesbSPs5FjGmU6jjtBSkX9b4qW87vDIsCIlUPOEhbZrMdjeQ==\",\n       \"dev\": true,\n       \"requires\": {\n         \"source-list-map\": \"^2.0.0\",\n@@ -22236,7 +22236,7 @@\n         \"source-map\": {\n           \"version\": \"0.6.1\",\n           \"resolved\": \"https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz\",\n-          \"integrity\": \"sha1-dHIq8y6WFOnCh6jQu95IteLxomM=\",\n+          \"integrity\": \"sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\",\n           \"dev\": true\n         }\n       }"
        },
        {
          "filename": "public/js/build/app.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "public/js/dist/all.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "public/mix-manifest.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,5 +1,5 @@\n {\n-    \"/js/build/app.js\": \"/js/build/app.js?id=ea4abe6bc23035e9ec2b\",\n+    \"/js/build/app.js\": \"/js/build/app.js?id=7019b66f037a748a1f53\",\n     \"/css/build/AdminLTE.css\": \"/css/build/AdminLTE.css?id=89f2b7816c4e00784b59\",\n     \"/css/build/app.css\": \"/css/build/app.css?id=5d0d4ed9f5ea4d02b6fe\",\n     \"/css/build/overrides.css\": \"/css/build/overrides.css?id=1a11d122b620ebdc8354\",\n@@ -26,7 +26,7 @@\n     \"/css/dist/bootstrap-table.css\": \"/css/dist/bootstrap-table.css?id=d729a1e2e97f290cc4e2\",\n     \"/js/build/vendor.js\": \"/js/build/vendor.js?id=b93877b4a88a76e1b18b\",\n     \"/js/dist/bootstrap-table.js\": \"/js/dist/bootstrap-table.js?id=a17945119a381c758e1f\",\n-    \"/js/dist/all.js\": \"/js/dist/all.js?id=4bac8bfa5026af54600a\",\n+    \"/js/dist/all.js\": \"/js/dist/all.js?id=a2822770e4525cd4d568\",\n     \"/css/dist/skins/skin-green.min.css\": \"/css/dist/skins/skin-green.min.css?id=1f137fd2dcbac676d291\",\n     \"/css/dist/skins/skin-green-dark.min.css\": \"/css/dist/skins/skin-green-dark.min.css?id=af88a4cc8e58dc298963\",\n     \"/css/dist/skins/skin-black.min.css\": \"/css/dist/skins/skin-black.min.css?id=5ef650950378aeb72dfa\","
        },
        {
          "filename": "resources/assets/js/snipeit.js",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -514,7 +514,7 @@ $(document).ready(function () {\n \n         for (var i = 0; i < this.files.length; i++) {\n             total_size += this.files[i].size;\n-            $(id + '-info').append('<span class=\"label label-default\">' + this.files[i].name + ' (' + formatBytes(this.files[i].size) + ')</span> ');\n+            $(id + '-info').append('<span class=\"label label-default\">' + htmlEntities(this.files[i].name) + ' (' + formatBytes(this.files[i].size) + ')</span> ');\n         }\n \n         console.log('Max size is: ' + max_size);\n@@ -535,6 +535,9 @@ $(document).ready(function () {\n \n });\n \n+function htmlEntities(str) {\n+    return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n+}\n \n /**\n  * Toggle disabled"
        },
        {
          "filename": "resources/views/modals/upload-file.blade.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -19,15 +19,15 @@\n \n                         <label class=\"btn btn-default\">\n                             {{ trans('button.select_file')  }}\n-                            <input type=\"file\" name=\"file[]\" multiple=\"true\" class=\"js-uploadFile\" id=\"uploadFile\" data-maxsize=\"{{ \\App\\Helpers\\Helper::file_upload_max_size() }}\" accept=\"image/*,.csv,.zip,.rar,.doc,.docx,.xls,.xlsx,.xml,.lic,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/plain,.pdf,application/rtf\" style=\"display:none\" required>\n+                            <input type=\"file\" name=\"file[]\" multiple=\"true\" class=\"js-uploadFile\" id=\"uploadFile\" data-maxsize=\"{{ Helper::file_upload_max_size() }}\" accept=\"image/*,.csv,.zip,.rar,.doc,.docx,.xls,.xlsx,.xml,.lic,.xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,text/plain,.pdf,application/rtf\" style=\"display:none\" required>\n                         </label>\n \n                     </div>\n                     <div class=\"col-md-9\">\n                         <span id=\"uploadFile-info\"></span>\n                     </div>\n                     <div class=\"col-md-12\">\n-                        <p class=\"help-block\" id=\"uploadFile-status\">{{ trans('general.upload_filetypes_help', ['size' => \\App\\Helpers\\Helper::file_upload_max_size_readable()]) }}</p>\n+                        <p class=\"help-block\" id=\"uploadFile-status\">{{ trans('general.upload_filetypes_help', ['size' => Helper::file_upload_max_size_readable()]) }}</p>\n                     </div>\n \n                     <div class=\"col-md-12\">"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 9,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ca11efd3ee47a3313fc3a586f2ca2c843a7dc045",
            "date": "2025-01-13T22:23:30Z",
            "author_login": "snipe"
          },
          {
            "sha": "4a6a94a50ebc4bc86f7000aa5cb70987e20b7c80",
            "date": "2025-01-13T22:23:13Z",
            "author_login": "snipe"
          },
          {
            "sha": "2d65b381559d1817ecf201099e80201c7ad22378",
            "date": "2025-01-13T21:00:04Z",
            "author_login": "snipe"
          },
          {
            "sha": "587449ef970b3e2523da5a33a24f681cf699d382",
            "date": "2025-01-13T17:35:58Z",
            "author_login": "snipe"
          },
          {
            "sha": "06ffac9d7d0677ea74ff043a225588cc6a5a2aa8",
            "date": "2025-01-13T17:33:13Z",
            "author_login": "snipe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "snipe-it is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-10-19T13:15:11.727",
    "last_modified": "2024-11-21T06:22:41.033",
    "fix_date": "2021-10-06T19:38:51Z"
  },
  "references": [
    {
      "url": "https://github.com/snipe/snipe-it/commit/fc5efd857f61f7e45c61db567bb66612bcb53128",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/1dbc8d79-1b53-44a3-a576-faec78f29ba0",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/snipe/snipe-it/commit/fc5efd857f61f7e45c61db567bb66612bcb53128",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/1dbc8d79-1b53-44a3-a576-faec78f29ba0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.835746",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "snipe-it",
    "owner": "snipe",
    "created_at": "2013-11-12T22:25:47Z",
    "updated_at": "2025-01-14T04:38:00Z",
    "pushed_at": "2025-01-14T12:34:04Z",
    "size": 224867,
    "stars": 11511,
    "forks": 3256,
    "open_issues": 1797,
    "watchers": 11511,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 18130643,
      "JavaScript": 4627209,
      "Blade": 1576739,
      "CSS": 250828,
      "Less": 196359,
      "Shell": 43713,
      "Dockerfile": 4408,
      "Python": 522,
      "Jinja": 229,
      "Procfile": 57
    },
    "commit_activity": {
      "total_commits_last_year": 3771,
      "avg_commits_per_week": 72.51923076923077,
      "days_active_last_year": 253
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:15:50.526515"
  }
}