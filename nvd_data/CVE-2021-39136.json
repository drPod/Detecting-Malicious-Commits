{
  "cve_id": "CVE-2021-39136",
  "github_data": {
    "repository": "baserproject/basercms",
    "fix_commit": "568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc",
    "related_commits": [
      "568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc",
      "568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc",
      "commit_date": "2021-08-25T12:52:17Z",
      "author": {
        "login": "ryuring",
        "type": "User",
        "stats": {
          "total_commits": 6546,
          "average_weekly_commits": 9.654867256637168,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 570
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-hgjr-632x-qpp3",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 22,
        "additions": 17,
        "deletions": 5
      },
      "files": [
        {
          "filename": "app/webroot/theme/admin-third/UploaderFiles/admin/ajax_image.php",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -5,16 +5,22 @@\n  *\n  * @copyright       Copyright (c) baserCMS Users Community\n  * @link            https://basercms.net baserCMS Project\n- * @package            Uploader.View\n+ * @package         Uploader.View\n  * @since           baserCMS v 3.0.10\n  * @license         https://basercms.net/license/index.html\n  */\n-$url = $this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name']));\n+\n+/**\n+ * @var BcAppView $this\n+ * @var array $file\n+ * @var string $size\n+ */\n+$url = h($this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name'])));\n ?>\n \n \n <p class=\"url\">\n-\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo FULL_BASE_URL . $url ?></a>\n+\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo Router::url($url, true) ?></a>\n </p>\n <p class=\"image\">\n \t<a href=\"<?php echo $url ?>\""
        },
        {
          "filename": "lib/Baser/Plugin/Uploader/View/UploaderFiles/admin/ajax_image.php",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -9,12 +9,18 @@\n  * @since           baserCMS v 3.0.10\n  * @license         https://basercms.net/license/index.html\n  */\n-$url = $this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name']));\n+\n+/**\n+ * @var BcAppView $this\n+ * @var array $file\n+ * @var string $size\n+ */\n+$url = h($this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name'])));\n ?>\n \n \n <p class=\"url\">\n-\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo FULL_BASE_URL . $url ?></a>\n+\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo Router::url($url, true) ?></a>\n </p>\n <p class=\"image\">\n \t<a href=\"<?php echo $url ?>\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4639019bcac88bbef2acefc74ee45fe17a453429",
            "date": "2025-01-23T06:42:11Z",
            "author_login": "momofff"
          },
          {
            "sha": "3ca87fbd2100851756133fc486a94bb2f5301642",
            "date": "2025-01-23T06:29:03Z",
            "author_login": "momofff"
          },
          {
            "sha": "4d855801d1065b3b75189194a76b806200466dae",
            "date": "2025-01-23T06:16:13Z",
            "author_login": "momofff"
          },
          {
            "sha": "6a85e7b486fce4d26990b461727689e5486feb35",
            "date": "2025-01-23T06:05:33Z",
            "author_login": "seto1"
          },
          {
            "sha": "b867cb1da3c13ea9bdda67aac5eec4c79842ef51",
            "date": "2025-01-23T06:03:56Z",
            "author_login": "seto1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "baserCMS is an open source content management system with a focus on Japanese language support. In affected versions there is a cross-site scripting vulnerability in the file upload function of the management system of baserCMS. Users are advised to update as soon as possible. No workaround are available to mitigate this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-08-25T18:15:07.177",
    "last_modified": "2024-11-21T06:18:39.977",
    "fix_date": "2021-08-25T12:52:17Z"
  },
  "references": [
    {
      "url": "http://jvn.jp/en/jp/JVN14134801/index.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://basercms.net/security/JVN_14134801",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/commit/568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/security/advisories/GHSA-hgjr-632x-qpp3",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://jvn.jp/en/jp/JVN14134801/index.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://basercms.net/security/JVN_14134801",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/commit/568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/security/advisories/GHSA-hgjr-632x-qpp3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:05.109546",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "basercms",
    "owner": "baserproject",
    "created_at": "2012-02-12T06:13:53Z",
    "updated_at": "2025-01-23T06:43:01Z",
    "pushed_at": "2025-01-23T06:42:58Z",
    "size": 100922,
    "stars": 174,
    "forks": 131,
    "open_issues": 276,
    "watchers": 174,
    "has_security_policy": false,
    "default_branch": "5.1.x",
    "protected_branches": [
      "5.1.x"
    ],
    "languages": {
      "PHP": 8898382,
      "CSS": 1244410,
      "JavaScript": 342744,
      "SCSS": 236685,
      "HTML": 150870,
      "Vue": 16205,
      "Shell": 6070,
      "Batchfile": 835
    },
    "commit_activity": {
      "total_commits_last_year": 1850,
      "avg_commits_per_week": 35.57692307692308,
      "days_active_last_year": 215
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:53:59.160625"
  }
}