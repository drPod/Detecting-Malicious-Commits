{
  "cve_id": "CVE-2021-39157",
  "github_data": {
    "repository": "sonicdoe/detect-character-encoding",
    "fix_commit": "992a11007fff6cfd40b952150ab8d30410c4a20a",
    "related_commits": [
      "992a11007fff6cfd40b952150ab8d30410c4a20a",
      "992a11007fff6cfd40b952150ab8d30410c4a20a"
    ],
    "patch_url": "https://github.com/sonicdoe/detect-character-encoding/commit/992a11007fff6cfd40b952150ab8d30410c4a20a.patch",
    "fix_commit_details": {
      "sha": "992a11007fff6cfd40b952150ab8d30410c4a20a",
      "commit_date": "2018-11-06T18:10:49Z",
      "author": {
        "login": "sonicdoe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Return null if no charset matches",
        "length": 297,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 12,
        "deletions": 0
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -27,6 +27,8 @@ console.log(charsetMatch);\n // }\n ```\n \n+detect-character-encoding may return `null` if no charset matches.\n+\n ## Supported operating systems\n \n - macOS High Sierra"
        },
        {
          "filename": "icuWrapper.cpp",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -40,6 +40,12 @@ NAN_METHOD(DetectCharacterEncoding) {\n \t\treturn;\n \t}\n \n+\tif(charsetMatch == NULL) {\n+\t\tinfo.GetReturnValue().Set(Nan::Null());\n+\t\tucsdet_close(charsetDetector);\n+\t\treturn;\n+\t}\n+\n \tconst char *charsetName = ucsdet_getName(charsetMatch, &errorCode);\n \n \tif(U_FAILURE(errorCode)) {"
        },
        {
          "filename": "test/index.js",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -18,6 +18,10 @@ it('should return a confidence value', () => {\n \tassert(typeof detectCharacterEncoding(getFixture('utf-8.txt')).confidence === 'number');\n });\n \n+it('should return null if no charset matches', () => {\n+\tassert.strictEqual(detectCharacterEncoding(Buffer.from([0xAB])), null);\n+});\n+\n it('should throw a TypeError if argument is not a buffer', () => {\n \tassert.throws(() => {\n \t\tdetectCharacterEncoding('string');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "27d8f93f9e31032ad14e80632da501cbf9f96363",
            "date": "2024-01-06T12:31:36Z",
            "author_login": "sonicdoe"
          },
          {
            "sha": "303987dca50954479ff0834aebf4b3689226bb6b",
            "date": "2024-01-06T12:31:25Z",
            "author_login": "sonicdoe"
          },
          {
            "sha": "6d939e8bb4e0810d017696e42674514b77bb179b",
            "date": "2024-01-06T12:31:00Z",
            "author_login": "sonicdoe"
          },
          {
            "sha": "a0b8c999b90d033d6ddb24f1e4524281afbd966b",
            "date": "2024-01-06T12:30:36Z",
            "author_login": "sonicdoe"
          },
          {
            "sha": "ce1b432feb25f94a3bdce1fda8509106cffab071",
            "date": "2024-01-06T12:30:32Z",
            "author_login": "sonicdoe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-755",
    "description": "detect-character-encoding is an open source character encoding inspection library. In detect-character-encoding v0.6.0 and earlier, data matching no charset causes the Node.js process to crash. The problem has been patched in [detect-character-encoding v0.7.0](https://github.com/sonicdoe/detect-character-encoding/releases/tag/v0.7.0). No workaround are available and all users should update to resolve this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-08-24T19:15:32.127",
    "last_modified": "2024-11-21T06:18:44.680",
    "fix_date": "2018-11-06T18:10:49Z"
  },
  "references": [
    {
      "url": "https://github.com/sonicdoe/detect-character-encoding/commit/992a11007fff6cfd40b952150ab8d30410c4a20a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sonicdoe/detect-character-encoding/issues/15",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sonicdoe/detect-character-encoding/security/advisories/GHSA-jqfh-8hw5-fqjr",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sonicdoe/detect-character-encoding/commit/992a11007fff6cfd40b952150ab8d30410c4a20a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sonicdoe/detect-character-encoding/issues/15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sonicdoe/detect-character-encoding/security/advisories/GHSA-jqfh-8hw5-fqjr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:05.107564",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "detect-character-encoding",
    "owner": "sonicdoe",
    "created_at": "2015-03-15T11:01:13Z",
    "updated_at": "2024-03-05T12:08:32Z",
    "pushed_at": "2024-01-06T12:33:37Z",
    "size": 59812,
    "stars": 84,
    "forks": 15,
    "open_issues": 3,
    "watchers": 84,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "C++": 2073,
      "JavaScript": 1054,
      "Python": 496
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:14:10.608142"
  }
}