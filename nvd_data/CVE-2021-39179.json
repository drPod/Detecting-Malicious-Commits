{
  "cve_id": "CVE-2021-39179",
  "github_data": {
    "repository": "dhis2/dhis2-core",
    "fix_commit": "16674ac75127b0e83691c6b1c9ce745e67ab58b6",
    "related_commits": [
      "16674ac75127b0e83691c6b1c9ce745e67ab58b6",
      "16674ac75127b0e83691c6b1c9ce745e67ab58b6"
    ],
    "patch_url": "https://github.com/dhis2/dhis2-core/commit/16674ac75127b0e83691c6b1c9ce745e67ab58b6.patch",
    "fix_commit_details": {
      "sha": "16674ac75127b0e83691c6b1c9ce745e67ab58b6",
      "commit_date": "2021-09-20T19:55:47Z",
      "author": {
        "login": "Philip-Larsen-Donnelly",
        "type": "User",
        "stats": {
          "total_commits": 62,
          "average_weekly_commits": 0.1415525114155251,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 46
        }
      },
      "commit_message": {
        "title": "build: correct patch PRs (#8771)",
        "length": 107,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 5,
        "deletions": 9
      },
      "files": [
        {
          "filename": ".patches/security/advisories.json",
          "status": "modified",
          "additions": 5,
          "deletions": 9,
          "patch": "@@ -6,19 +6,15 @@\n         \"status\": \"FIXED\",\n         \"pullRequests\": [\n           {\n-            \"prNumber\": 11,\n-            \"target\": \"patch/2.34.7\"\n-          },\n-          {\n-            \"prNumber\": 4,\n+            \"prNumber\": 14,\n             \"target\": \"patch/2.35.7\"\n           },\n           {\n             \"prNumber\": 15,\n             \"target\": \"patch/2.35.8\"\n           },\n           {\n-            \"prNumber\": 3,\n+            \"prNumber\": 16,\n             \"target\": \"patch/2.36.4\"\n           }\n         ]\n@@ -29,15 +25,15 @@\n         \"status\": \"FIXED\",\n         \"pullRequests\": [\n           {\n-            \"prNumber\": 6,\n+            \"prNumber\": 7,\n             \"target\": \"patch/2.34.7\"\n           },\n           {\n-            \"prNumber\": 3,\n+            \"prNumber\": 8,\n             \"target\": \"patch/2.35.8\"\n           },\n           {\n-            \"prNumber\": 2,\n+            \"prNumber\": 9,\n             \"target\": \"patch/2.36.4\"\n           }\n         ]"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8067233d8e78f9769377211af02f97c22fa01be4",
            "date": "2025-01-14T14:31:47Z",
            "author_login": "jbee"
          },
          {
            "sha": "5b2be03d181d9c2d497817d79e2accfe1cbe67b7",
            "date": "2025-01-14T13:16:01Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "b032630779a1bbc61f23e9ab5d170a702394dd3e",
            "date": "2025-01-14T08:27:14Z",
            "author_login": "Philip-Larsen-Donnelly"
          },
          {
            "sha": "092ca7f4868aa741b26c7fa44ba567f96ec20b2e",
            "date": "2025-01-14T08:25:16Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "10ca85f0088733d6ebdb03d36609977ea281a6e4",
            "date": "2025-01-14T08:24:51Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "DHIS 2 is an information system for data capture, management, validation, analytics and visualization. A SQL Injection vulnerability in the Tracker component in DHIS2 Server allows authenticated remote attackers to execute arbitrary SQL commands via unspecified vectors. This vulnerability affects the `/api/trackedEntityInstances` and `/api/trackedEntityInstances/query` API endpoints in all DHIS2 versions 2.34, 2.35, and 2.36. It also affects versions 2.32 and 2.33 which have reached _end of support_ - exceptional security updates have been added to the latest *end of support* builds for these versions. Versions 2.31 and older are unaffected. The system is vulnerable to attack only from users that are logged in to DHIS2, and there is no known way of exploiting the vulnerability without first being logged in as a DHIS2 user. The vulnerability is not exposed to a non-malicious user - the vulnerability requires a conscious attack to be exploited. A successful exploit of this vulnerability could allow the malicious user to read, edit and delete data in the DHIS2 instance. There are no known exploits of the security vulnerabilities addressed by these patch releases. Security patches are available in DHIS2 versions 2.32-EOS, 2.33-EOS, 2.34.7, 2.35.7, and 2.36.4. There is no straightforward known workaround for DHIS2 instances using the Tracker functionality other than upgrading the affected DHIS2 server to one of the patches in which this vulnerability has been fixed. For implementations which do NOT use Tracker functionality, it may be possible to block all network access to POST to the `/api/trackedEntityInstances`, and `/api/trackedEntityInstances/query` endpoints as a temporary workaround while waiting to upgrade.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-10-29T14:15:07.667",
    "last_modified": "2024-11-21T06:18:48.367",
    "fix_date": "2021-09-20T19:55:47Z"
  },
  "references": [
    {
      "url": "https://github.com/dhis2/dhis2-core/commit/16674ac75127b0e83691c6b1c9ce745e67ab58b6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dhis2/dhis2-core/pull/8771",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dhis2/dhis2-core/security/advisories/GHSA-cmpc-frjv-rrmw",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dhis2/dhis2-core/commit/16674ac75127b0e83691c6b1c9ce745e67ab58b6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dhis2/dhis2-core/pull/8771",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/dhis2/dhis2-core/security/advisories/GHSA-cmpc-frjv-rrmw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.856346",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dhis2-core",
    "owner": "dhis2",
    "created_at": "2016-08-30T12:57:05Z",
    "updated_at": "2025-01-14T14:31:52Z",
    "pushed_at": "2025-01-14T17:42:41Z",
    "size": 219461,
    "stars": 297,
    "forks": 355,
    "open_issues": 43,
    "watchers": 297,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "2.21",
      "2.22",
      "2.23",
      "2.24",
      "2.25",
      "2.26",
      "2.27",
      "2.28",
      "2.29",
      "2.30",
      "2.31",
      "2.32",
      "2.33",
      "2.34",
      "2.35-DHIS2-TECH842-backport",
      "2.35",
      "2.35.8_rwanda_eq",
      "2.35.9_log4j_upgrade_2.15.0",
      "2.35.11_rwanda_eq",
      "2.36_ks",
      "2.36",
      "2.37-DHIS2-10907",
      "2.37-DHIS2-12152-backport",
      "2.37-DHIS2-14805-backport",
      "2.37",
      "2.38-DHIS2-11190",
      "2.38-DHIS2-12656-2",
      "2.38-DHIS2-12853",
      "2.38-DHIS2-15268-backport",
      "2.38-DHIS2-15724"
    ],
    "languages": {
      "Java": 36883803,
      "JavaScript": 758945,
      "CSS": 169636,
      "PLpgSQL": 75232,
      "HTML": 61589,
      "Groovy": 33500,
      "Shell": 17966,
      "XSLT": 6968,
      "SCSS": 4229,
      "Ruby": 1011,
      "Dockerfile": 107
    },
    "commit_activity": {
      "total_commits_last_year": 1649,
      "avg_commits_per_week": 31.71153846153846,
      "days_active_last_year": 279
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T17:49:30.609715"
  }
}