{
  "cve_id": "CVE-2021-40540",
  "github_data": {
    "repository": "babelouest/ulfius",
    "fix_commit": "c83f564c184a27145e07c274b305cabe943bbfaa",
    "related_commits": [
      "c83f564c184a27145e07c274b305cabe943bbfaa",
      "c83f564c184a27145e07c274b305cabe943bbfaa"
    ],
    "patch_url": "https://github.com/babelouest/ulfius/commit/c83f564c184a27145e07c274b305cabe943bbfaa.patch",
    "fix_commit_details": {
      "sha": "c83f564c184a27145e07c274b305cabe943bbfaa",
      "commit_date": "2021-09-06T20:30:07Z",
      "author": {
        "login": "babelouest",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix bug when malformed HTTP requests are sent, thanks Jeremy Brown!",
        "length": 67,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/ulfius.c",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -207,6 +207,7 @@ void * ulfius_uri_logger (void * cls, const char * uri) {\n   UNUSED(cls);\n \n   if (con_info != NULL) {\n+    memset(con_info, 0, sizeof(struct connection_info_struct));\n     con_info->callback_first_iteration = 1;\n     con_info->u_instance = NULL;\n     u_map_init(&con_info->map_url_initial);\n@@ -217,7 +218,8 @@ void * ulfius_uri_logger (void * cls, const char * uri) {\n       return NULL;\n     }\n \n-    if (NULL == con_info->request || ulfius_init_request(con_info->request) != U_OK) {\n+    if (ulfius_init_request(con_info->request) != U_OK) {\n+      y_log_message(Y_LOG_LEVEL_ERROR, \"Ulfius - Error initializing con_info->request\");\n       ulfius_clean_request_full(con_info->request);\n       o_free(con_info);\n       return NULL;\n@@ -433,7 +435,6 @@ static int ulfius_webservice_dispatcher (void * cls,\n                                          size_t * upload_data_size,\n                                          void ** con_cls) {\n #endif\n-\n   struct _u_endpoint * endpoint_list = ((struct _u_instance *)cls)->endpoint_list, ** current_endpoint_list = NULL, * current_endpoint = NULL;\n   struct connection_info_struct * con_info = * con_cls;\n   int mhd_ret = MHD_NO, callback_ret = U_OK, i, close_loop = 0, inner_error = U_OK, mhd_response_flag;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3fd9d8d39a7ea2fe86234246526b65b40bea9322",
            "date": "2024-08-08T11:23:39Z",
            "author_login": "babelouest"
          },
          {
            "sha": "9db083b7d0b8b5c6a5fb09ba3b3910e24e430470",
            "date": "2024-08-08T11:20:17Z",
            "author_login": "babelouest"
          },
          {
            "sha": "27be66105a53bede0a8f65adcc5f5d3991517355",
            "date": "2024-05-01T11:28:32Z",
            "author_login": "babelouest"
          },
          {
            "sha": "bf9fc9df40f6abbd3fcc91cf3c745ee644929350",
            "date": "2024-05-01T07:17:24Z",
            "author_login": "pabs3"
          },
          {
            "sha": "3f669903765b099043e0a19a20d48412a3bfa659",
            "date": "2024-03-04T22:54:43Z",
            "author_login": "babelouest"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": null,
    "description": "ulfius_uri_logger in Ulfius HTTP Framework before 2.7.4 omits con_info initialization and a con_info->request NULL check for certain malformed HTTP requests.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-07T02:15:07.130",
    "last_modified": "2024-11-21T06:24:21.287",
    "fix_date": "2021-09-06T20:30:07Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/164152/Ulfius-Web-Framework-Remote-Memory-Corruption.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/babelouest/ulfius/commit/c83f564c184a27145e07c274b305cabe943bbfaa",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/babelouest/ulfius/compare/v2.7.3...v2.7.4",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/164152/Ulfius-Web-Framework-Remote-Memory-Corruption.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/babelouest/ulfius/commit/c83f564c184a27145e07c274b305cabe943bbfaa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/babelouest/ulfius/compare/v2.7.3...v2.7.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:05.134376",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ulfius",
    "owner": "babelouest",
    "created_at": "2015-11-01T23:31:15Z",
    "updated_at": "2025-01-13T08:41:06Z",
    "pushed_at": "2024-10-13T13:03:16Z",
    "size": 5570,
    "stars": 1100,
    "forks": 183,
    "open_issues": 16,
    "watchers": 1100,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1840972,
      "CMake": 51551,
      "Makefile": 39421,
      "HTML": 12260,
      "Shell": 4510,
      "Roff": 1974,
      "CSS": 416,
      "Dockerfile": 346
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T18:30:28.928732"
  }
}