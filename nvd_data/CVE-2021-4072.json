{
  "cve_id": "CVE-2021-4072",
  "github_data": {
    "repository": "elgg/elgg",
    "fix_commit": "c30b17bf75256ed3fcc84e2083147cc3951423d0",
    "related_commits": [
      "c30b17bf75256ed3fcc84e2083147cc3951423d0",
      "c30b17bf75256ed3fcc84e2083147cc3951423d0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c30b17bf75256ed3fcc84e2083147cc3951423d0",
      "commit_date": "2021-12-06T14:39:10Z",
      "author": {
        "login": "jeabakker",
        "type": "User",
        "stats": {
          "total_commits": 2750,
          "average_weekly_commits": 3.3783783783783785,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 362
        }
      },
      "commit_message": {
        "title": "fix(reported_content): sanitize report URLs",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "mod/reportedcontent/actions/reportedcontent/add.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n $report = new ElggReportedContent();\n $report->owner_guid = elgg_get_logged_in_user_guid();\n $report->title = $title;\n-$report->address = $address;\n+$report->address = elgg_normalize_site_url($address);\n $report->description = $description;\n $report->access_id = $access;\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2137ec9dca0f354f2b1943c508a846d442ff4385",
            "date": "2025-01-24T12:51:00Z",
            "author_login": "jdalsem"
          },
          {
            "sha": "501dc5ec2c5f2f3be14afe4daf2ab848eecab6b2",
            "date": "2025-01-24T08:48:43Z",
            "author_login": "jdalsem"
          },
          {
            "sha": "c3deac4c8a215e01684ea431b3e7487fc6b9e8c8",
            "date": "2025-01-17T10:33:44Z",
            "author_login": "jdalsem"
          },
          {
            "sha": "7ea56c6dfebd0937c854a92fc12f37b9b19c6c4c",
            "date": "2025-01-15T12:47:36Z",
            "author_login": "jeabakker"
          },
          {
            "sha": "7d499e7e9f9b6b63d76af05386f8b22c0218db19",
            "date": "2025-01-10T13:04:01Z",
            "author_login": "callpri"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "elgg is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-24T14:15:07.327",
    "last_modified": "2024-11-21T06:36:50.880",
    "fix_date": "2021-12-06T14:39:10Z"
  },
  "references": [
    {
      "url": "https://github.com/elgg/elgg/commit/c30b17bf75256ed3fcc84e2083147cc3951423d0",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/74034253-732a-4251-a0f9-eca5f576c955",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/elgg/elgg/commit/c30b17bf75256ed3fcc84e2083147cc3951423d0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/74034253-732a-4251-a0f9-eca5f576c955",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.025771",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "Elgg",
    "owner": "elgg",
    "created_at": "2009-09-06T17:10:11Z",
    "updated_at": "2025-01-24T12:51:10Z",
    "pushed_at": "2025-01-24T12:51:00Z",
    "size": 112180,
    "stars": 1646,
    "forks": 665,
    "open_issues": 61,
    "watchers": 1646,
    "has_security_policy": false,
    "default_branch": "6.x",
    "protected_branches": [
      "1.9",
      "1.10",
      "1.11",
      "1.12",
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "4.0",
      "4.1",
      "4.2",
      "4.3",
      "5.0",
      "5.1",
      "6.x",
      "6.0",
      "6.1",
      "historical",
      "master"
    ],
    "languages": {
      "PHP": 7490904,
      "JavaScript": 126858,
      "CSS": 90887,
      "HTML": 29948,
      "Hack": 2033
    },
    "commit_activity": {
      "total_commits_last_year": 439,
      "avg_commits_per_week": 8.442307692307692,
      "days_active_last_year": 99
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:26:48.839133"
  }
}