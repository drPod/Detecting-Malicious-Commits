{
  "cve_id": "CVE-2021-40864",
  "github_data": {
    "repository": "ONLYOFFICE/plugin-translator",
    "fix_commit": "2206c0179cb97e3b8b290a0ab5719b1f0f54542b",
    "related_commits": [
      "2206c0179cb97e3b8b290a0ab5719b1f0f54542b",
      "2206c0179cb97e3b8b290a0ab5719b1f0f54542b"
    ],
    "patch_url": "https://github.com/ONLYOFFICE/plugin-translator/commit/2206c0179cb97e3b8b290a0ab5719b1f0f54542b.patch",
    "fix_commit_details": {
      "sha": "2206c0179cb97e3b8b290a0ab5719b1f0f54542b",
      "commit_date": "2021-04-28T10:20:12Z",
      "author": {
        "login": "KhromovNikita",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Added escaping characters",
        "length": 25,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "index.html",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -4,6 +4,7 @@\n \t<meta charset=\"UTF-8\">\n \t<title>translate</title>\n     <script type=\"text/javascript\" src=\"https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.js\"></script>\n+\t<script type=\"text/javascript\" src=\"https://onlyoffice.github.io/sdkjs-plugins/v1/plugins-ui.js\"></script>\n \t<script src=\"scripts/translate.js\"></script>\n \t<style>\n \t\thtml, body {"
        },
        {
          "filename": "index_widget.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -148,7 +148,7 @@\n \t\t\telse\r\n \t\t\t{\r\n \t\t\t\tif (msg.data !== \"onchange_goog-te-combo\") {\r\n-\t\t\t\tdocument.getElementById(\"google_translate_element\").innerHTML = msg.data;\r\n+\t\t\t\tdocument.getElementById(\"google_translate_element\").innerHTML = escape(msg.data);\r\n \t\t\t\t}\r\n \t\t\t\ttimeOut = setTimeout(function() {\r\n \t\t\t\t\tdocument.getElementById(\"google_translate_element\").style.opacity = 1;\r"
        },
        {
          "filename": "scripts/translate.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -30,7 +30,7 @@\n \t\t\tifr.onload = function() {\r\n \t\t\t\tif (ifr.contentWindow.document.readyState == 'complete')\r\n \t\t\t\t\tsetTimeout(function() {\r\n-\t\t\t\t\t\tifr.contentDocument.getElementById(\"google_translate_element\").innerHTML = text;\r\n+\t\t\t\t\t\tifr.contentDocument.getElementById(\"google_translate_element\").innerHTML = escape(text);\r\n \t\t\t\t\t\tif (text.length)\r\n \t\t\t\t\t\t\tifr.contentDocument.getElementById(\"div_btn\").classList.remove(\"hidden\");\r\n \t\t\t\t\t}, 500);\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dfefba29ccae8796de31b06131dfb2a6416fa6ea",
            "date": "2022-09-27T08:38:45Z",
            "author_login": "catbasilio"
          },
          {
            "sha": "11874cd95810c762daa997a0739e4ae3333fceca",
            "date": "2022-07-18T10:00:07Z",
            "author_login": "catbasilio"
          },
          {
            "sha": "4605187982a4405351caf0ec5e3c61c9091eadc9",
            "date": "2022-06-25T08:44:03Z",
            "author_login": "trofim24"
          },
          {
            "sha": "159fe0c3dec39d646fa915968dd41258399e6b58",
            "date": "2022-06-22T13:53:46Z",
            "author_login": "AlexeyMatveev686"
          },
          {
            "sha": "632a5f98150eb83d277a15fcf4d6e64851ea6348",
            "date": "2022-06-22T08:39:47Z",
            "author_login": "KhromovNikita"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": null,
    "description": "The Translate plugin 6.1.x through 6.3.x before 6.3.0.72 for ONLYOFFICE Document Server lacks escape calls for the msg.data and text fields.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-09-10T19:15:08.267",
    "last_modified": "2024-11-21T06:24:57.913",
    "fix_date": "2021-04-28T10:20:12Z"
  },
  "references": [
    {
      "url": "https://github.com/ONLYOFFICE/plugin-translator/commit/2206c0179cb97e3b8b290a0ab5719b1f0f54542b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ONLYOFFICE/plugin-translator/compare/v6.3.0.71...v6.3.0.72",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ONLYOFFICE/plugin-translator/commit/2206c0179cb97e3b8b290a0ab5719b1f0f54542b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ONLYOFFICE/plugin-translator/compare/v6.3.0.71...v6.3.0.72",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.747801",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "plugin-translator",
    "owner": "ONLYOFFICE",
    "created_at": "2020-03-26T10:16:07Z",
    "updated_at": "2023-01-27T20:47:52Z",
    "pushed_at": "2022-09-27T08:38:45Z",
    "size": 270,
    "stars": 3,
    "forks": 8,
    "open_issues": 0,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 7514,
      "HTML": 4057
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T21:16:45.407266"
  }
}