{
  "cve_id": "CVE-2021-41089",
  "github_data": {
    "repository": "moby/moby",
    "fix_commit": "bce32e5c93be4caf1a592582155b9cb837fc129a",
    "related_commits": [
      "bce32e5c93be4caf1a592582155b9cb837fc129a",
      "bce32e5c93be4caf1a592582155b9cb837fc129a"
    ],
    "patch_url": "https://github.com/moby/moby/commit/bce32e5c93be4caf1a592582155b9cb837fc129a.patch",
    "fix_commit_details": {
      "sha": "bce32e5c93be4caf1a592582155b9cb837fc129a",
      "commit_date": "2021-09-09T18:50:12Z",
      "author": {
        "login": "thaJeztah",
        "type": "User",
        "stats": {
          "total_commits": 9523,
          "average_weekly_commits": 15.188197767145136,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 506
        }
      },
      "commit_message": {
        "title": "Merge pull request #4 from moby/20.10-ghsa-v994-f8vw-g7j4-chroot-mkdir",
        "length": 137,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 10,
        "deletions": 6
      },
      "files": [
        {
          "filename": "pkg/chrootarchive/archive.go",
          "status": "modified",
          "additions": 10,
          "deletions": 6,
          "patch": "@@ -74,13 +74,17 @@ func untarHandler(tarArchive io.Reader, dest string, options *archive.TarOptions\n \t\toptions.ExcludePatterns = []string{}\n \t}\n \n-\tidMapping := idtools.NewIDMappingsFromMaps(options.UIDMaps, options.GIDMaps)\n-\trootIDs := idMapping.RootPair()\n+\t// If dest is inside a root then directory is created within chroot by extractor.\n+\t// This case is only currently used by cp.\n+\tif dest == root {\n+\t\tidMapping := idtools.NewIDMappingsFromMaps(options.UIDMaps, options.GIDMaps)\n+\t\trootIDs := idMapping.RootPair()\n \n-\tdest = filepath.Clean(dest)\n-\tif _, err := os.Stat(dest); os.IsNotExist(err) {\n-\t\tif err := idtools.MkdirAllAndChownNew(dest, 0755, rootIDs); err != nil {\n-\t\t\treturn err\n+\t\tdest = filepath.Clean(dest)\n+\t\tif _, err := os.Stat(dest); os.IsNotExist(err) {\n+\t\t\tif err := idtools.MkdirAllAndChownNew(dest, 0755, rootIDs); err != nil {\n+\t\t\t\treturn err\n+\t\t\t}\n \t\t}\n \t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a2b1ac7959b849e0304168ed3850773678ed8e65",
            "date": "2025-01-14T19:41:16Z",
            "author_login": "thaJeztah"
          },
          {
            "sha": "cc120c4c053e1f9c9f8ecf8c0f60878e0f80538b",
            "date": "2025-01-14T18:20:17Z",
            "author_login": "thaJeztah"
          },
          {
            "sha": "2b7e859c49d3603ecd43fd4ccba1976a90064913",
            "date": "2025-01-14T16:30:14Z",
            "author_login": "thaJeztah"
          },
          {
            "sha": "04b03cfc0a99f50088ac9c811a9992e5b05463bc",
            "date": "2025-01-14T14:26:28Z",
            "author_login": "thaJeztah"
          },
          {
            "sha": "48e6b4e8f7329422a13074c7911f524cac45c165",
            "date": "2025-01-14T09:50:06Z",
            "author_login": "thaJeztah"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N",
    "cwe_id": "CWE-281",
    "description": "Moby is an open-source project created by Docker to enable software containerization. A bug was found in Moby (Docker Engine) where attempting to copy files using `docker cp` into a specially-crafted container can result in Unix file permission changes for existing files in the host\u2019s filesystem, widening access to others. This bug does not directly allow files to be read, modified, or executed without an additional cooperating process. This bug has been fixed in Moby (Docker Engine) 20.10.9. Users should update to this version as soon as possible. Running containers do not need to be restarted.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-10-04T21:15:12.620",
    "last_modified": "2024-11-21T06:25:26.147",
    "fix_date": "2021-09-09T18:50:12Z"
  },
  "references": [
    {
      "url": "https://cert-portal.siemens.com/productcert/pdf/ssa-222547.pdf",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/moby/moby/commit/bce32e5c93be4caf1a592582155b9cb837fc129a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moby/moby/security/advisories/GHSA-v994-f8vw-g7j4",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B5Q6G6I4W5COQE25QMC7FJY3I3PAYFBB/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZNFADTCHHYWVM6W4NJ6CB4FNFM2VMBIB/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://cert-portal.siemens.com/productcert/pdf/ssa-222547.pdf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/moby/moby/commit/bce32e5c93be4caf1a592582155b9cb837fc129a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/moby/moby/security/advisories/GHSA-v994-f8vw-g7j4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B5Q6G6I4W5COQE25QMC7FJY3I3PAYFBB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZNFADTCHHYWVM6W4NJ6CB4FNFM2VMBIB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:07.811324",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "moby",
    "owner": "moby",
    "created_at": "2013-01-18T18:10:57Z",
    "updated_at": "2025-01-14T12:58:30Z",
    "pushed_at": "2025-01-14T12:58:23Z",
    "size": 224938,
    "stars": 68998,
    "forks": 18677,
    "open_issues": 3533,
    "watchers": 68998,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.12.x",
      "1.13.x",
      "17.03.x",
      "17.04.x",
      "17.05.x",
      "19.03",
      "20.10",
      "22.06",
      "23.0",
      "24.0",
      "25.0",
      "26.0",
      "26.1",
      "27.x",
      "master"
    ],
    "languages": {
      "Go": 10171312,
      "Shell": 157078,
      "Dockerfile": 56212,
      "PowerShell": 31839,
      "Makefile": 9923,
      "Python": 7179,
      "C": 4815,
      "HCL": 3897,
      "Assembly": 81
    },
    "commit_activity": {
      "total_commits_last_year": 2581,
      "avg_commits_per_week": 49.63461538461539,
      "days_active_last_year": 295
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:08:15.569963"
  }
}