{
  "cve_id": "CVE-2021-41139",
  "github_data": {
    "repository": "anuko/timetracker",
    "fix_commit": "559906731f153c9b3a632c2839ed11669b76d593",
    "related_commits": [
      "559906731f153c9b3a632c2839ed11669b76d593",
      "d3f60bd3e3ea8ff8ec31a596baec6750af601b7c",
      "559906731f153c9b3a632c2839ed11669b76d593",
      "d3f60bd3e3ea8ff8ec31a596baec6750af601b7c"
    ],
    "patch_url": "https://github.com/anuko/timetracker/commit/559906731f153c9b3a632c2839ed11669b76d593.patch",
    "fix_commit_details": {
      "sha": "559906731f153c9b3a632c2839ed11669b76d593",
      "commit_date": "2021-10-12T20:01:36Z",
      "author": {
        "login": "anuko",
        "type": "User",
        "stats": {
          "total_commits": 2668,
          "average_weekly_commits": 5.75,
          "total_additions": 281516,
          "total_deletions": 116840,
          "weeks_active": 228
        }
      },
      "commit_message": {
        "title": "Added a check for passed in date to time.php.",
        "length": 45,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
      },
      "files": [
        {
          "filename": "initialize.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n // Disable displaying errors on screen.\n ini_set('display_errors', 'Off');\n \n-define(\"APP_VERSION\", \"1.19.29.5598\");\n+define(\"APP_VERSION\", \"1.19.30.5599\");\n define(\"APP_DIR\", dirname(__FILE__));\n define(\"LIBRARY_DIR\", APP_DIR.\"/WEB-INF/lib\");\n define(\"TEMPLATE_DIR\", APP_DIR.\"/WEB-INF/templates\");"
        },
        {
          "filename": "time.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -32,6 +32,12 @@\n     exit();\n   }\n }\n+// If we are passed in a date, make sure it is in correct format.\n+$date = $request->getParameter('date');\n+if ($date && !ttValidDate($date)) {\n+  header('Location: access_denied.php');\n+  exit();\n+}\n // End of access checks.\n \n // Determine user for whom we display this page."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6711df7ae7c0c0034d6673365d26a0933faac5c",
            "date": "2023-12-28T18:07:21Z",
            "author_login": "anuko"
          },
          {
            "sha": "f92e6ce6d58669ea735767b55e18bcaa7a7935b8",
            "date": "2023-12-27T23:41:06Z",
            "author_login": "ram-fabian-heinrich"
          },
          {
            "sha": "2deafba72d62471a2b1e29f2d625a3dbb4702200",
            "date": "2023-11-11T16:42:19Z",
            "author_login": "anuko"
          },
          {
            "sha": "d123e4534038691c66c342008d464efbe8824a5d",
            "date": "2023-07-08T16:48:07Z",
            "author_login": "anuko"
          },
          {
            "sha": "3c21de2155eec74d2a16c4ccae867df6963388fc",
            "date": "2023-07-06T18:46:39Z",
            "author_login": "anuko"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Anuko Time Tracker is an open source, web-based time tracking application written in PHP. When a logged on user selects a date in Time Tracker, it is being passed on via the date parameter in URI. Because of not checking this parameter for sanity in versions prior to 1.19.30.5600, it was possible to craft the URI with malicious JavaScript, use social engineering to convince logged on user to click on such link, and have the attacker-supplied JavaScript to be executed in user's browser. This issue is patched in version 1.19.30.5600. As a workaround, one may introduce `ttValidDbDateFormatDate` function as in the latest version and add a call to it within the access checks block in time.php.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-10-13T17:15:07.697",
    "last_modified": "2024-11-21T06:25:34.300",
    "fix_date": "2021-10-12T20:01:36Z"
  },
  "references": [
    {
      "url": "https://github.com/anuko/timetracker/commit/559906731f153c9b3a632c2839ed11669b76d593",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/d3f60bd3e3ea8ff8ec31a596baec6750af601b7c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-h2v8-87c9-86cw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/559906731f153c9b3a632c2839ed11669b76d593",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/d3f60bd3e3ea8ff8ec31a596baec6750af601b7c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-h2v8-87c9-86cw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.827146",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "timetracker",
    "owner": "anuko",
    "created_at": "2016-02-28T19:01:14Z",
    "updated_at": "2024-12-10T00:27:13Z",
    "pushed_at": "2023-12-28T18:07:38Z",
    "size": 11493,
    "stars": 191,
    "forks": 124,
    "open_issues": 27,
    "watchers": 191,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 5951736,
      "Smarty": 314330,
      "JavaScript": 30090,
      "CSS": 16132,
      "Batchfile": 13672,
      "Shell": 2274
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:32:50.847474"
  }
}