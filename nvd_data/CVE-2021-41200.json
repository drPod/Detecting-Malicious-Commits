{
  "cve_id": "CVE-2021-41200",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "874bda09e6702cd50bac90b453b50bcc65b2769e",
    "related_commits": [
      "874bda09e6702cd50bac90b453b50bcc65b2769e",
      "874bda09e6702cd50bac90b453b50bcc65b2769e"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/874bda09e6702cd50bac90b453b50bcc65b2769e.patch",
    "fix_commit_details": {
      "sha": "874bda09e6702cd50bac90b453b50bcc65b2769e",
      "commit_date": "2021-08-31T23:55:31Z",
      "author": {
        "login": "tensorflower-gardener",
        "type": "User",
        "stats": {
          "total_commits": 51278,
          "average_weekly_commits": 106.82916666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 450
        }
      },
      "commit_message": {
        "title": "Merge pull request #51715 from yongtang:46909-tf.summary.create_file_writer",
        "length": 158,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/summary_kernels.cc",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -38,12 +38,20 @@ class CreateSummaryFileWriterOp : public OpKernel {\n   void Compute(OpKernelContext* ctx) override {\n     const Tensor* tmp;\n     OP_REQUIRES_OK(ctx, ctx->input(\"logdir\", &tmp));\n+    OP_REQUIRES(ctx, TensorShapeUtils::IsScalar(tmp->shape()),\n+                errors::InvalidArgument(\"logdir must be a scalar\"));\n     const string logdir = tmp->scalar<tstring>()();\n     OP_REQUIRES_OK(ctx, ctx->input(\"max_queue\", &tmp));\n+    OP_REQUIRES(ctx, TensorShapeUtils::IsScalar(tmp->shape()),\n+                errors::InvalidArgument(\"max_queue must be a scalar\"));\n     const int32_t max_queue = tmp->scalar<int32>()();\n     OP_REQUIRES_OK(ctx, ctx->input(\"flush_millis\", &tmp));\n+    OP_REQUIRES(ctx, TensorShapeUtils::IsScalar(tmp->shape()),\n+                errors::InvalidArgument(\"flush_millis must be a scalar\"));\n     const int32_t flush_millis = tmp->scalar<int32>()();\n     OP_REQUIRES_OK(ctx, ctx->input(\"filename_suffix\", &tmp));\n+    OP_REQUIRES(ctx, TensorShapeUtils::IsScalar(tmp->shape()),\n+                errors::InvalidArgument(\"filename_suffix must be a scalar\"));\n     const string filename_suffix = tmp->scalar<tstring>()();\n \n     core::RefCountPtr<SummaryWriterInterface> s;"
        },
        {
          "filename": "tensorflow/python/summary/writer/writer_test.py",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -34,6 +34,7 @@\n from tensorflow.python.client import session\n from tensorflow.python.framework import constant_op\n from tensorflow.python.framework import dtypes\n+from tensorflow.python.framework import errors_impl\n from tensorflow.python.framework import meta_graph\n from tensorflow.python.framework import ops\n from tensorflow.python.framework import test_util\n@@ -685,6 +686,16 @@ def testSharing_withExplicitSummaryFileWriters(self):\n     # No more files\n     self.assertRaises(StopIteration, lambda: next(event_paths))\n \n+  def testSummaryFileWritersInvalidInput(self):\n+    # Test case for GitHub issue 46909\n+    logdir = self.get_temp_dir()\n+    with session.Session() as sess:\n+      with self.assertRaises(errors_impl.InvalidArgumentError):\n+        writer = summary_ops_v2.create_file_writer(\n+            logdir=logdir, flush_millis=[1, 2])\n+        sess.run(writer.init())\n+        sess.run(writer.flush())\n+\n \n class FileWriterCacheTest(test.TestCase):\n   \"\"\"FileWriterCache tests.\"\"\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd41705e0ad7a123a9d01b8be2a3b34b3266493e",
            "date": "2025-01-14T13:33:52Z",
            "author_login": "loislo"
          },
          {
            "sha": "af5275c5731565cbf2a2c01ee418a8cf62388431",
            "date": "2025-01-14T12:48:20Z",
            "author_login": "akuegel"
          },
          {
            "sha": "ee156c15e5d1cd7d2bd85885e7fd2bf7e143c2c3",
            "date": "2025-01-14T12:46:22Z",
            "author_login": "pifon2a"
          },
          {
            "sha": "bd43a8255ce9e203b740bcdc09e8f79d3a26f887",
            "date": "2025-01-14T12:33:02Z",
            "author_login": "metaflow"
          },
          {
            "sha": "8003fb40987f176d35364da2af8fcdfab339349e",
            "date": "2025-01-14T11:27:47Z",
            "author_login": "vwbaker"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. In affected versions if `tf.summary.create_file_writer` is called with non-scalar arguments code crashes due to a `CHECK`-fail. The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-11-05T20:15:08.037",
    "last_modified": "2024-11-21T06:25:45.353",
    "fix_date": "2021-08-31T23:55:31Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/874bda09e6702cd50bac90b453b50bcc65b2769e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/issues/46909",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-gh8h-7j2j-qv4f",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/874bda09e6702cd50bac90b453b50bcc65b2769e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/issues/46909",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-gh8h-7j2j-qv4f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.874785",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}