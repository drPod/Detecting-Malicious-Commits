{
  "cve_id": "CVE-2021-41207",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "f2c3931113eaafe9ef558faaddd48e00a6606235",
    "related_commits": [
      "f2c3931113eaafe9ef558faaddd48e00a6606235",
      "f2c3931113eaafe9ef558faaddd48e00a6606235"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235.patch",
    "fix_commit_details": {
      "sha": "f2c3931113eaafe9ef558faaddd48e00a6606235",
      "commit_date": "2021-10-12T15:29:53Z",
      "author": {
        "login": "rohan100jain",
        "type": "User",
        "stats": {
          "total_commits": 432,
          "average_weekly_commits": 0.9,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 162
        }
      },
      "commit_message": {
        "title": "Adding more validation checks to _ParallelConcatUpdate to avoid NPE.",
        "length": 151,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 26,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/inplace_ops.cc",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -71,6 +71,15 @@ class ParallelConcatUpdate : public OpKernel {\n \n   void Compute(OpKernelContext* ctx) override {\n     auto value = ctx->input(0);\n+    // Value should be at least rank 1. Also the 0th dimension should be\n+    // at least loc_.\n+    OP_REQUIRES(ctx, value.dims() >= 1,\n+                errors::InvalidArgument(\"value should be at least rank 1.\"));\n+    OP_REQUIRES(\n+        ctx, value.dim_size(0) > loc_,\n+        errors::InvalidArgument(\"0th dimension of value = \", value.dim_size(0),\n+                                \" is less than loc_=\", loc_));\n+\n     auto update = ctx->input(1);\n \n     OP_REQUIRES("
        },
        {
          "filename": "tensorflow/python/kernel_tests/array_ops/stack_op_test.py",
          "status": "modified",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -16,12 +16,16 @@\n \n import numpy as np\n \n+from tensorflow.python import tf2\n from tensorflow.python.eager import context\n+from tensorflow.python.eager import def_function\n from tensorflow.python.framework import constant_op\n from tensorflow.python.framework import dtypes\n+from tensorflow.python.framework import errors\n from tensorflow.python.framework import ops\n from tensorflow.python.framework import test_util\n from tensorflow.python.ops import array_ops\n+from tensorflow.python.ops import gen_array_ops\n from tensorflow.python.ops import gradient_checker_v2\n from tensorflow.python.platform import test\n \n@@ -69,6 +73,19 @@ def testSimpleParallelCPU(self):\n             c = array_ops.parallel_stack(xs)\n             self.assertAllEqual(c, data)\n \n+  def testParallelConcatShapeZero(self):\n+    if not tf2.enabled():\n+      self.skipTest(\"only fails in TF2\")\n+\n+    @def_function.function\n+    def f():\n+      y = gen_array_ops.parallel_concat(values=[[\"tf\"]], shape=0)\n+      return y\n+\n+    with self.assertRaisesRegex(errors.InvalidArgumentError,\n+                                r\"0th dimension of value .* is less than\"):\n+      f()\n+\n   def testSimpleParallelGPU(self):\n     # tf.parallel_stack is only supported in graph mode.\n     with ops.Graph().as_default():"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d93cc4f4f767f0d4a72f2fafcc59005be939c019",
            "date": "2025-01-14T20:36:32Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "d4e4516cc7d11a68a81a82227f3a432f7ab350a0",
            "date": "2025-01-14T19:59:15Z",
            "author_login": "ddunl"
          },
          {
            "sha": "65367823d999b6a36a685617100a7bb6ce03add4",
            "date": "2025-01-14T19:58:00Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "36cbae5466dbf356d91cf56127b2ab2ccd5a8b1f",
            "date": "2025-01-14T19:54:19Z",
            "author_login": "penpornk"
          },
          {
            "sha": "0a99598a8f76735ac32b5466385b0f5af08a06bb",
            "date": "2025-01-14T19:45:23Z",
            "author_login": "wangpengmit"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-369",
    "description": "TensorFlow is an open source platform for machine learning. In affected versions the implementation of `ParallelConcat` misses some input validation and can produce a division by 0. The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-11-05T22:15:08.470",
    "last_modified": "2024-11-21T06:25:46.530",
    "fix_date": "2021-10-12T15:29:53Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:31.877525",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}