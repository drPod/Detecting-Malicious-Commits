{
  "cve_id": "CVE-2021-4124",
  "github_data": {
    "repository": "meetecho/janus-gateway",
    "fix_commit": "f62bba6513ec840761f2434b93168106c7c65a3d",
    "related_commits": [
      "f62bba6513ec840761f2434b93168106c7c65a3d",
      "f62bba6513ec840761f2434b93168106c7c65a3d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f62bba6513ec840761f2434b93168106c7c65a3d",
      "commit_date": "2021-12-15T13:10:01Z",
      "author": {
        "login": "lminiero",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed missing XSS mitigation (see #2817)",
        "length": 40,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "html/textroomtest.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -351,7 +351,7 @@ function sendPrivateMsg(username) {\n \t\t\t\ttext: JSON.stringify(message),\n \t\t\t\terror: function(reason) { bootbox.alert(reason); },\n \t\t\t\tsuccess: function() {\n-\t\t\t\t\t$('#chatroom').append('<p style=\"color: purple;\">[' + getDateString() + '] <b>[whisper to ' + display + ']</b> ' + result);\n+\t\t\t\t\t$('#chatroom').append('<p style=\"color: purple;\">[' + getDateString() + '] <b>[whisper to ' + display + ']</b> ' + escapeXmlTags(result));\n \t\t\t\t\t$('#chatroom').get(0).scrollTop = $('#chatroom').get(0).scrollHeight;\n \t\t\t\t}\n \t\t\t});"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0998af8c95fa4151c9463aec05ffaaec2454b06a",
            "date": "2025-01-23T15:25:44Z",
            "author_login": "lminiero"
          },
          {
            "sha": "7c637fd86e223286a6a5b96b7cee071f220555bb",
            "date": "2025-01-23T14:57:43Z",
            "author_login": "lminiero"
          },
          {
            "sha": "c55499ea0c8c77356c5eb250bc8501a13553e7a1",
            "date": "2025-01-20T11:48:14Z",
            "author_login": "spscream"
          },
          {
            "sha": "3cdd6ff6a6cc32efc3ceba98e4e7ac7a34efeaad",
            "date": "2025-01-17T14:42:54Z",
            "author_login": "atoppi"
          },
          {
            "sha": "bbe648d4161a53f41a95b05fba63c74fc5225db1",
            "date": "2025-01-17T14:41:26Z",
            "author_login": "lminiero"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "janus-gateway is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-16T14:15:08.187",
    "last_modified": "2024-11-21T06:36:57.150",
    "fix_date": "2021-12-15T13:10:01Z"
  },
  "references": [
    {
      "url": "https://github.com/meetecho/janus-gateway/commit/f62bba6513ec840761f2434b93168106c7c65a3d",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a6ca142e-60aa-4d6f-b231-5d1bcd1b7190",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/meetecho/janus-gateway/commit/f62bba6513ec840761f2434b93168106c7c65a3d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a6ca142e-60aa-4d6f-b231-5d1bcd1b7190",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.847240",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "janus-gateway",
    "owner": "meetecho",
    "created_at": "2014-02-11T15:14:39Z",
    "updated_at": "2025-01-26T03:47:59Z",
    "pushed_at": "2025-01-23T15:26:29Z",
    "size": 44114,
    "stars": 8380,
    "forks": 2503,
    "open_issues": 28,
    "watchers": 8380,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 4811404,
      "JavaScript": 702347,
      "HTML": 157378,
      "Lua": 62821,
      "M4": 43346,
      "Makefile": 23229,
      "Roff": 16649,
      "Shell": 11746,
      "Python": 10405,
      "CSS": 1892,
      "Emacs Lisp": 574
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:04:58.542650"
  }
}