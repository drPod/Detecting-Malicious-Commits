{
  "cve_id": "CVE-2021-4244",
  "github_data": {
    "repository": "EvanHerman/yikes-inc-easy-mailchimp-extender",
    "fix_commit": "3662c6593aa1bb4286781214891d26de2e947695",
    "related_commits": [
      "3662c6593aa1bb4286781214891d26de2e947695",
      "3662c6593aa1bb4286781214891d26de2e947695"
    ],
    "patch_url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/commit/3662c6593aa1bb4286781214891d26de2e947695.patch",
    "fix_commit_details": {
      "sha": "3662c6593aa1bb4286781214891d26de2e947695",
      "commit_date": "2021-12-17T20:07:24Z",
      "author": {
        "login": "jpowersdev",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #889 from yikesinc/fix/audit",
        "length": 89,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 33,
        "additions": 18,
        "deletions": 15
      },
      "files": [
        {
          "filename": "admin/partials/ajax/add_field_to_form.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -1,9 +1,9 @@\n <?php\n $form_data = array(\n-\t'field_name' => $_POST['field_name'],\n-\t'merge_tag'  => $_POST['merge_tag'],\n-\t'field_type' => $_POST['field_type'],\n-\t'list_id'    => $_POST['list_id'],\n+\t'field_name' => isset( $_POST['field_name'] ) ? sanitize_text_field($_POST['field_name']) : '',\n+\t'merge_tag'  => isset( $_POST['merge_tag'] ) ? sanitize_text_field($_POST['merge_tag']) : '',\n+\t'field_type' => isset( $_POST['field_type'] ) ? sanitize_text_field($_POST['field_type']) : '',\n+\t'list_id'    => isset( $_POST['list_id'] ) ? sanitize_text_field($_POST['list_id']) : '',\n );\n \n // Grab our list handler.\n@@ -33,21 +33,21 @@\n // store it and use it to pre-populate field data (only on initial add to form)\n $merge_field_data = $available_merge_variables['merge_fields'][ $index ];\n ?>\n-<section class=\"draggable\" id=\"<?php echo $form_data['field_name']; ?>\">\n+<section class=\"draggable\" id=\"<?php echo esc_attr( $form_data['field_name'] ); ?>\">\n \t<!-- top -->\n \t<a href=\"#\" class=\"expansion-section-title settings-sidebar\">\n \t\t<span class=\"dashicons dashicons-plus yikes-mc-expansion-toggle\" title=\"<?php _e( 'Expand Field' , 'yikes-inc-easy-mailchimp-extender' ); ?>\"></span>\n-\t\t<?php echo stripslashes( $form_data['field_name'] ); ?>\n-\t\t<span class=\"field-type-text\"><small><?php echo __( 'type' , 'yikes-inc-easy-mailchimp-extender' ) . ' : ' . $form_data['field_type']; ?></small></span>\n+\t\t<?php echo wp_kses_post( stripslashes( $form_data['field_name'] ) ); ?>\n+\t\t<span class=\"field-type-text\"><small><?php echo __( 'type' , 'yikes-inc-easy-mailchimp-extender' ) . ' : ' . esc_html( $form_data['field_type'] ); ?></small></span>\n \t</a>\n \t<!-- expansion section -->\n \t<div class=\"yikes-mc-settings-expansion-section\">\n \n \t\t<!-- Single or Double Opt-in -->\n \t\t<p class=\"type-container form-field-container\"><!-- necessary to prevent skipping on slideToggle(); -->\n \t\t\t<!-- store the label -->\n-\t\t\t<input type=\"hidden\" name=\"field[<?php echo $merge_field_data['tag']; ?>][label]\" value=\"<?php echo htmlspecialchars( $form_data['field_name'] ); ?>\" />\n-\t\t\t<input type=\"hidden\" name=\"field[<?php echo $merge_field_data['tag']; ?>][type]\" value=\"<?php echo $form_data['field_type']; ?>\" />\n+\t\t\t<input type=\"hidden\" name=\"field[<?php echo $merge_field_data['tag']; ?>][label]\" value=\"<?php echo esc_attr( htmlspecialchars( $form_data['field_name'] ) ); ?>\" />\n+\t\t\t<input type=\"hidden\" name=\"field[<?php echo $merge_field_data['tag']; ?>][type]\" value=\"<?php echo esc_attr( $form_data['field_type'] ); ?>\" />\n \t\t\t<input type=\"hidden\" name=\"field[<?php echo $merge_field_data['tag']; ?>][merge]\" value=\"<?php echo $merge_field_data['tag']; ?>\" />\n \t\t\t<input type=\"hidden\" class=\"field-<?php echo $merge_field_data['tag']; ?>-position position-input\" name=\"field[<?php echo $merge_field_data['tag']; ?>][position]\" value=\"\" />\n "
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,11 +1,11 @@\n {\n \t\"name\": \"yikes-inc-easy-mailchimp-extender\",\n-\t\"version\": \"6.8.5\",\n+\t\"version\": \"6.8.6\",\n \t\"lockfileVersion\": 2,\n \t\"requires\": true,\n \t\"packages\": {\n \t\t\"\": {\n-\t\t\t\"version\": \"6.8.5\",\n+\t\t\t\"version\": \"6.8.6\",\n \t\t\t\"license\": \"MIT\",\n \t\t\t\"dependencies\": {\n \t\t\t\t\"@wordpress/hooks\": \"^2.0.3\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n \t\"name\": \"yikes-inc-easy-mailchimp-extender\",\n-\t\"version\": \"6.8.5\",\n+\t\"version\": \"6.8.6\",\n \t\"devDependencies\": {\n \t\t\"@wordpress/scripts\": \"^11.0.0\",\n \t\t\"braces\": \">=2.3.1\","
        },
        {
          "filename": "readme.txt",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@ Tags: Mailchimp, Mailchimp forms, Mailchimp lists, opt-in forms, sign up form, M\n Requires at least: 4.0\r\n Tested up to: 5.8\r\n Requires PHP: 5.2.13\r\n-Stable tag: 6.8.5\r\n+Stable tag: 6.8.6\r\n License: GPLv2 or later\r\n License URI: http://www.gnu.org/licenses/gpl-2.0.html\r\n \r\n@@ -172,6 +172,9 @@ For information and code examples on how to implement the hooks and filters prov\n \r\n == Changelog ==\r\n \r\n+= 6.8.6 - December 17, 2021 =\r\n+* Addressed potential XSS vulnerability\r\n+\r\n = 6.8.5 - September 2, 2021 =\r\n * Deprecated filter block_categories is replaced by block_categories_all in WP 5.8\r\n \r"
        },
        {
          "filename": "yikes-inc-easy-mailchimp-extender.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -3,7 +3,7 @@\n  * Plugin Name: Easy Forms for Mailchimp\n  * Plugin URI:  https://yikesplugins.com/plugin/easy-forms-for-mailchimp/\n  * Description: The ultimate Mailchimp WordPress plugin. Easily build <strong>unlimited forms for your Mailchimp lists</strong>, add them to your site and track subscriber activity. To get started, go to the settings page and enter your <a href=\"https://yikesplugins.com/support/knowledge-base/finding-your-mailchimp-api-key/\" target=\"_blank\">Mailchimp API key</a>.\n- * Version:     6.8.5\n+ * Version:     6.8.6\n  * Author:      YIKES, Inc.\n  * Author URI:  https://www.yikesplugins.com/\n  * License:     GPL-3.0+\n@@ -42,7 +42,7 @@\n  *  @since 6.1.3\n  */\n if ( ! defined( 'YIKES_MC_VERSION' ) ) {\n-\tdefine( 'YIKES_MC_VERSION', '6.8.5' );\n+\tdefine( 'YIKES_MC_VERSION', '6.8.6' );\n }\n \n /**"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "54752d8a4d25e3a8d3e5fbc7206f09aabc8bb71b",
            "date": "2024-02-26T08:24:47Z",
            "author_login": "EvanHerman"
          },
          {
            "sha": "f8331148af1f8c0d02820846cc3619558b6bbbb3",
            "date": "2024-02-26T08:19:03Z",
            "author_login": "EvanHerman"
          },
          {
            "sha": "7e6a8fbb07a78eb7400c1144041eb34b66556245",
            "date": "2024-02-26T08:15:51Z",
            "author_login": "EvanHerman"
          },
          {
            "sha": "932ff284c3fd3d00379f6e3597136567b18a434e",
            "date": "2024-02-26T08:11:53Z",
            "author_login": "EvanHerman"
          },
          {
            "sha": "47d5364cec65aa5eea0921b05a5e891b6c2a7dce",
            "date": "2024-02-26T07:59:51Z",
            "author_login": "EvanHerman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability classified as problematic has been found in yikes-inc-easy-mailchimp-extender Plugin up to 6.8.5. This affects an unknown part of the file admin/partials/ajax/add_field_to_form.php. The manipulation of the argument field_name/merge_tag/field_type/list_id leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 6.8.6 is able to address this issue. The name of the patch is 3662c6593aa1bb4286781214891d26de2e947695. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-215307.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-12T14:15:10.400",
    "last_modified": "2024-11-21T06:37:13.320",
    "fix_date": "2021-12-17T20:07:24Z"
  },
  "references": [
    {
      "url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/commit/3662c6593aa1bb4286781214891d26de2e947695",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/pull/889",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/releases/tag/6.8.6",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215307",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/commit/3662c6593aa1bb4286781214891d26de2e947695",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/pull/889",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/EvanHerman/yikes-inc-easy-mailchimp-extender/releases/tag/6.8.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215307",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.223077",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "yikes-inc-easy-mailchimp-extender",
    "owner": "EvanHerman",
    "created_at": "2011-11-02T18:45:36Z",
    "updated_at": "2024-06-09T03:38:00Z",
    "pushed_at": "2024-02-26T08:29:25Z",
    "size": 19276,
    "stars": 25,
    "forks": 28,
    "open_issues": 40,
    "watchers": 25,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 738050,
      "JavaScript": 135534,
      "Hack": 3703,
      "Shell": 3610,
      "CSS": 1018,
      "SCSS": 180
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T20:55:44.846515"
  }
}