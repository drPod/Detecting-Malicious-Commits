{
  "cve_id": "CVE-2021-4258",
  "github_data": {
    "repository": "whohas/whohas",
    "fix_commit": "667c3e2e9178f15c23d7918b5db25cd0792c8472",
    "related_commits": [
      "667c3e2e9178f15c23d7918b5db25cd0792c8472",
      "667c3e2e9178f15c23d7918b5db25cd0792c8472"
    ],
    "patch_url": "https://github.com/whohas/whohas/commit/667c3e2e9178f15c23d7918b5db25cd0792c8472.patch",
    "fix_commit_details": {
      "sha": "667c3e2e9178f15c23d7918b5db25cd0792c8472",
      "commit_date": "2021-11-02T01:20:03Z",
      "author": {
        "login": "pabs3",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Use https when checking package information",
        "length": 202,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 30,
        "additions": 15,
        "deletions": 15
      },
      "files": [
        {
          "filename": "whohas",
          "status": "modified",
          "additions": 15,
          "deletions": 15,
          "patch": "@@ -187,7 +187,7 @@ sub maxthreads {\n }\n \n sub fedora {\n-\tmy $baseurl = \"http://dl.fedoraproject.org/pub/fedora/linux/releases/\";\n+\tmy $baseurl = \"https://dl.fedoraproject.org/pub/fedora/linux/releases/\";\n \tmy $distroname = \"Fedora\";\n \tmy $arch = \"x86_64\";\n \tmy $searchy = $_[0];\n@@ -261,7 +261,7 @@ sub month_to_digits {\n }\n \n sub macports {\n-\tmy $baseurl = \"http://www.macports.org\";\n+\tmy $baseurl = \"https://www.macports.org\";\n \tmy @names;\n \tmy @versions;\n \tmy @dates;\n@@ -291,7 +291,7 @@ sub macports {\n \n \n sub fink {\n-\tmy $baseurl = \"http://pdb.finkproject.org/pdb/\";\n+\tmy $baseurl = \"https://pdb.finkproject.org/pdb/\";\n \tmy @names;\n \tmy @versions;\n \tmy @dates;\n@@ -388,7 +388,7 @@ sub size_trim {\n \n \n sub freebsd {\n-\tmy $query = \"http://www.freebsd.org/cgi/ports.cgi?query=\".$_[0].\"&stype=all\";\n+\tmy $query = \"https://www.freebsd.org/cgi/ports.cgi?query=\".$_[0].\"&stype=all\";\n \tmy @lines = split /\\n/, &fetchdoc($query);\n \tmy @names;\n \tmy @versions;\n@@ -404,7 +404,7 @@ sub freebsd {\n \t\t\tmy @subparts = split /\\//, $parts[3];\n \t\t\tpush @sizes, \"\";\n \t\t\tpush @repos, $subparts[@subparts-2];\n-\t\t\tpush @urls,  \"http://www.freebsd.org/cgi/ports.cgi?stype=all&query=$names[$now]\";\n+\t\t\tpush @urls,  \"https://www.freebsd.org/cgi/ports.cgi?stype=all&query=$names[$now]\";\n \t\t\t$now++;\n \t\t\tpush @dates, \"\";\n \t\t}\n@@ -552,7 +552,7 @@ sub openbsd_combos {\n sub openbsd_newer {\n \tmy $rel = $openbsd_release;\n \tmy $arch = \"i386\";\n-\tmy $baseurl = 'http://ftp.openbsd.org/pub/OpenBSD/'.$rel.'/packages/'.$arch.'/';\n+\tmy $baseurl = 'https://ftp.openbsd.org/pub/OpenBSD/'.$rel.'/packages/'.$arch.'/';\n \tmy @names;\n \tmy @versions;\n \tmy @urls;\n@@ -599,7 +599,7 @@ sub openbsd_newer {\n sub openbsd_older {\n \tmy $rel = $openbsd_release;\n \tmy $arch = \"i386\";\n-\tmy $baseurl = \"http://www.openbsd.org/\".$rel.'_packages/';\n+\tmy $baseurl = \"https://www.openbsd.org/\".$rel.'_packages/';\n \tmy @names;\n \tmy @versions;\n \tmy @urls;\n@@ -646,7 +646,7 @@ sub openbsd_older {\n }\n \n sub cygwin {\n-\tmy $baseurl = \"http://www.cygwin.com/packages\";\n+\tmy $baseurl = \"https://www.cygwin.com/packages\";\n \tmy @names;\n \tmy @versions;\n \tmy @urls;\n@@ -693,8 +693,8 @@ sub cygwin {\n }\n \n sub gentoo {\n-\tmy $gentoobase = \"http://gpo.zugaina.org/\";\n-\tmy $gentoobaseofficial = \"http://packages.gentoo.org/package\";\n+\tmy $gentoobase = \"https://gpo.zugaina.org/\";\n+\tmy $gentoobaseofficial = \"https://packages.gentoo.org/package\";\n \tmy $distroname = \"Gentoo\";\n \tmy @names;\n \tmy @versions;\n@@ -816,7 +816,7 @@ sub slack_combos {\n }\n \n sub slack {\n-\tmy $slackbase  = \"http://packages.slackware.com/\";\n+\tmy $slackbase  = \"https://packages.slackware.com/\";\n \tmy @repos;\n \tmy @groups;\n \tmy @names;\n@@ -892,13 +892,13 @@ sub debian_size_convert {\n \n sub debian {\n \tmy @dists = ($debian_current_release);\n-\t&debuntu('http://packages.debian.org','Debian',\\@dists,$_[0]);\n+\t&debuntu('https://packages.debian.org','Debian',\\@dists,$_[0]);\n \treturn();\n }\n \n sub ubuntu {\n \tmy @array = ($ubuntu_current_release);\n-\t&debuntu('http://packages.ubuntu.com','Ubuntu',\\@array,$_[0]);\n+\t&debuntu('https://packages.ubuntu.com','Ubuntu',\\@array,$_[0]);\n \treturn();\n }\n \n@@ -1155,7 +1155,7 @@ sub trim($) {\n }\n \n sub opensuse {\n-\tmy $opensusebase = \"http://software.opensuse.org\";\n+\tmy $opensusebase = \"https://software.opensuse.org\";\n \tmy @names;\n \tmy @repos;\n \tmy @groups;\n@@ -1238,7 +1238,7 @@ sub sizeconvert {\n }\n \n sub netbsd {\n-\tmy @lines = split /\\n|<br\\/>/, &fetchdoc(\"http://pkgsrc.se/search.php?so=\".$_[0]);\n+\tmy @lines = split /\\n|<br\\/>/, &fetchdoc(\"https://pkgsrc.se/search.php?so=\".$_[0]);\n \tmy @names;\n \tmy @versions;\n \tmy @dates;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5feb1a4c3e2cbe8cc4eef9d84a1aeef16c555720",
            "date": "2022-07-14T20:50:51Z",
            "author_login": "philippwesche"
          },
          {
            "sha": "97c53c4402660377b8950229bc67de07ee3b0a98",
            "date": "2022-07-14T20:49:42Z",
            "author_login": "philippwesche"
          },
          {
            "sha": "8cfd8137d719ef798386b2700ff45c6e181db6d4",
            "date": "2022-07-14T20:45:22Z",
            "author_login": "philippwesche"
          },
          {
            "sha": "aedf185315081c08ec7fce4fe061a4f7ce696fd3",
            "date": "2022-07-14T20:41:37Z",
            "author_login": "philippwesche"
          },
          {
            "sha": "8fa7e7593ca44da99bc3a19a2a3f03ddd9f9120b",
            "date": "2022-07-13T18:28:04Z",
            "author_login": "philippwesche"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-310",
    "description": "A vulnerability was found in whohas. It has been rated as problematic. This issue affects some unknown processing of the component Package Information Handler. The manipulation leads to cleartext transmission of sensitive information. The attack may be initiated remotely. The real existence of this vulnerability is still doubted at the moment. The name of the patch is 667c3e2e9178f15c23d7918b5db25cd0792c8472. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216251. NOTE: Most sources redirect to the encrypted site which limits the possibilities of an attack.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-19T14:15:10.383",
    "last_modified": "2024-11-21T06:37:15.270",
    "fix_date": "2021-11-02T01:20:03Z"
  },
  "references": [
    {
      "url": "https://github.com/whohas/whohas/commit/667c3e2e9178f15c23d7918b5db25cd0792c8472",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216251",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/whohas/whohas/commit/667c3e2e9178f15c23d7918b5db25cd0792c8472",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216251",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.183084",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "whohas",
    "owner": "whohas",
    "created_at": "2011-12-01T14:02:56Z",
    "updated_at": "2024-12-11T07:24:06Z",
    "pushed_at": "2022-07-14T20:50:51Z",
    "size": 558,
    "stars": 64,
    "forks": 13,
    "open_issues": 0,
    "watchers": 64,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Perl": 39008,
      "HTML": 8373,
      "Roff": 3450,
      "CSS": 2806,
      "Makefile": 2161
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T21:08:47.492036"
  }
}