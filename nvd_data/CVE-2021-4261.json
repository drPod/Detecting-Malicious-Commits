{
  "cve_id": "CVE-2021-4261",
  "github_data": {
    "repository": "platzhersh/pacman-canvas",
    "fix_commit": "29522c90ca1cebfce6453a5af5a45281d99b0646",
    "related_commits": [
      "29522c90ca1cebfce6453a5af5a45281d99b0646",
      "29522c90ca1cebfce6453a5af5a45281d99b0646"
    ],
    "patch_url": "https://github.com/platzhersh/pacman-canvas/commit/29522c90ca1cebfce6453a5af5a45281d99b0646.patch",
    "fix_commit_details": {
      "sha": "29522c90ca1cebfce6453a5af5a45281d99b0646",
      "commit_date": "2021-05-04T22:21:21Z",
      "author": {
        "login": "platzhersh",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "get rid of sql injection vulnerability",
        "length": 38,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 2,
        "deletions": 13
      },
      "files": [
        {
          "filename": "data/db-handler.php",
          "status": "modified",
          "additions": 2,
          "deletions": 13,
          "patch": "@@ -96,19 +96,8 @@ function addHighscore($name, $score, $level) {\n \t$name_clean = htmlspecialchars($name);\n \t$score_clean = htmlspecialchars($score);\n \n-\t$db->exec('INSERT INTO highscore (name, score, level, date, log_referer, log_user_agent, log_remote_addr, log_remote_host, cheater) '\n-\t\t. 'VALUES (\"' \n-\t\t\t. $name . '\", ' \n-\t\t\t. $score . ', ' \n-\t\t\t. $level . ', \"' \n-\t\t\t. $date . '\", \"' \n-\t\t\t. $ref .'\", \"'\n-\t\t\t. $ua . '\", \"'\n-\t\t\t. $remA .'\", \"'\n-\t\t\t. $remH . '\", \"'\n-\t\t\t. $cheater\n-\t\t.'\")'\n-\t);\n+\t$db->exec('INSERT INTO highscore (name, score, level, date, log_referer, log_user_agent, log_remote_addr, log_remote_host, cheater)VALUES(?,?,?,?,?,?,?,?,?)',$name, $score,$level,$date,$ref,$ua,$remA,$remH,$cheater);\n+\n \n \t$response['status'] = \"success\";\n \t$response['level'] = $level;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0a8fbd8331bfcb81bb04f4782b9a21bb7be2a37b",
            "date": "2024-02-11T12:28:26Z",
            "author_login": "platzhersh"
          },
          {
            "sha": "026d3a94e4e72596b7ce376b09f0c9e46be41cd3",
            "date": "2024-02-11T12:25:25Z",
            "author_login": "platzhersh"
          },
          {
            "sha": "c6fa6b1094eb1cb063d304ff69a08a4878c2b826",
            "date": "2023-10-17T11:24:24Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "7415754764bcab8a3c298b84379f737c276c56be",
            "date": "2023-10-17T11:24:14Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "29b9b46be8895200465a5e33a8d3cb42aedf2008",
            "date": "2023-10-17T11:23:56Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-707",
    "description": "A vulnerability classified as critical has been found in pacman-canvas up to 1.0.5. Affected is the function addHighscore of the file data/db-handler.php. The manipulation leads to sql injection. It is possible to launch the attack remotely. Upgrading to version 1.0.6 is able to address this issue. The name of the patch is 29522c90ca1cebfce6453a5af5a45281d99b0646. It is recommended to upgrade the affected component. VDB-216270 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-19T14:15:10.700",
    "last_modified": "2024-11-21T06:37:15.680",
    "fix_date": "2021-05-04T22:21:21Z"
  },
  "references": [
    {
      "url": "https://github.com/platzhersh/pacman-canvas/commit/29522c90ca1cebfce6453a5af5a45281d99b0646",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/platzhersh/pacman-canvas/releases/tag/1.0.6",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216270",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/platzhersh/pacman-canvas/commit/29522c90ca1cebfce6453a5af5a45281d99b0646",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/platzhersh/pacman-canvas/releases/tag/1.0.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216270",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.183513",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pacman-canvas",
    "owner": "platzhersh",
    "created_at": "2012-07-20T09:37:41Z",
    "updated_at": "2024-12-30T09:44:30Z",
    "pushed_at": "2024-03-28T08:25:47Z",
    "size": 15249,
    "stars": 342,
    "forks": 554,
    "open_issues": 9,
    "watchers": 342,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 60637,
      "CSS": 14591,
      "HTML": 10321,
      "Shell": 3828,
      "PHP": 3528
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "cc0-1.0"
    },
    "collected_at": "2025-01-14T22:29:56.375542"
  }
}