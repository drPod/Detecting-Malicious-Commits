{
  "cve_id": "CVE-2021-4268",
  "github_data": {
    "repository": "erikdubbelboer/phpRedisAdmin",
    "fix_commit": "b9039adbb264c81333328faa9575ecf8e0d2be94",
    "related_commits": [
      "b9039adbb264c81333328faa9575ecf8e0d2be94",
      "b9039adbb264c81333328faa9575ecf8e0d2be94"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b9039adbb264c81333328faa9575ecf8e0d2be94",
      "commit_date": "2021-08-26T18:19:02Z",
      "author": {
        "login": "erikdubbelboer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Prevent Cross-Site Request Forgery",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 24,
        "additions": 24,
        "deletions": 0
      },
      "files": [
        {
          "filename": "edit.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -145,6 +145,7 @@\n ?>\n <h2><?php echo $edit ? 'Edit' : 'Add'?></h2>\n <form action=\"<?php echo format_html(getRelativePath('edit.php'))?>\" method=\"post\">\n+<input type=\"hidden\" name=\"csrf\" value=\"<?php echo $csrfToken; ?>\" />\n \n <p>\n <label for=\"type\">Type:</label>"
        },
        {
          "filename": "export.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -187,6 +187,7 @@ function export_json($key) {\n <h2>Export <?php echo isset($_GET['key']) ? format_html($_GET['key']) : ''?></h2>\n \n <form action=\"<?php echo format_html(getRelativePath('export.php'))?>\" method=\"post\">\n+<input type=\"hidden\" name=\"csrf\" value=\"<?php echo $csrfToken; ?>\" />\n \n <p>\n <label for=\"type\">Type:</label>"
        },
        {
          "filename": "import.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -92,6 +92,7 @@\n ?>\n <h2>Import</h2>\n <form action=\"<?php echo format_html(getRelativePath('import.php'))?>\" method=\"post\">\n+<input type=\"hidden\" name=\"csrf\" value=\"<?php echo $csrfToken; ?>\" />\n \n <p>\n <label for=\"commands\">Commands:<br>"
        },
        {
          "filename": "includes/common.inc.php",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -4,6 +4,24 @@\n define('PHPREDIS_ADMIN_PATH', dirname(__DIR__));\n \n \n+if (session_status() !== PHP_SESSION_DISABLED) {\n+  session_start();\n+\n+  if (isset($_SESSION['phpredisadmin_csrf'])) {\n+    $csrfToken = $_SESSION['phpredisadmin_csrf'];\n+  } else {\n+    $csrfToken = bin2hex(random_bytes(16));\n+    $_SESSION['phpredisadmin_csrf'] = $csrfToken;\n+  }\n+} else {\n+  $csrfToken = 'nosession';\n+}\n+\n+if ($_SERVER['REQUEST_METHOD'] === 'POST') {\n+  if ($_POST['csrf'] !== $csrfToken) {\n+    die('bad csrf token');\n+  }\n+}\n \n \n // These includes are needed by each script."
        },
        {
          "filename": "login.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -13,6 +13,7 @@\n <h1 class=\"logo\">phpRedisAdmin</h1>\n \n <form class=\"form-signin\" method=\"post\" action=\"login.php\">\n+<input type=\"hidden\" name=\"csrf\" value=\"<?php echo $csrfToken; ?>\" />\n     <h2 class=\"form-signin-heading\">Please log in</h2>\n \n     <?php if (isset($_POST['username']) || isset($_POST['password'])): ?>"
        },
        {
          "filename": "rename.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -36,6 +36,7 @@\n ?>\n <h2>Edit Name of <?php echo format_html($_GET['key'])?></h2>\n <form action=\"<?php echo format_html(getRelativePath('rename.php'))?>\" method=\"post\">\n+<input type=\"hidden\" name=\"csrf\" value=\"<?php echo $csrfToken; ?>\" />\n \n <input type=\"hidden\" name=\"old\" value=\"<?php echo format_html($_GET['key'])?>\">\n "
        },
        {
          "filename": "ttl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -27,6 +27,7 @@\n ?>\n <h2>Edit TTL</h2>\n <form action=\"<?php echo format_html(getRelativePath('ttl.php'))?>\" method=\"post\">\n+<input type=\"hidden\" name=\"csrf\" value=\"<?php echo $csrfToken; ?>\" />\n \n <p>\n <label for=\"key\">Key:</label>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6f9fae06b4edeaa758113407d90b4a3d2915ad76",
            "date": "2024-12-20T07:31:12Z",
            "author_login": "erikdubbelboer"
          },
          {
            "sha": "543cbc7997874fae7967aaaa85bf190a6b24d0b4",
            "date": "2024-12-20T07:28:42Z",
            "author_login": "erikdubbelboer"
          },
          {
            "sha": "3e60b217dae70e0be700202c2fb3d4cf46ac02fe",
            "date": "2024-12-09T12:05:05Z",
            "author_login": "erikdubbelboer"
          },
          {
            "sha": "5e8c6ecb19e68988994ac20a1dff30b3fa65cf3e",
            "date": "2024-12-09T12:04:25Z",
            "author_login": "erikdubbelboer"
          },
          {
            "sha": "644162e932230d8eef642ebce327260a4dd54b0a",
            "date": "2024-12-08T09:41:43Z",
            "author_login": "erikdubbelboer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-863",
    "description": "A vulnerability, which was classified as problematic, was found in phpRedisAdmin up to 1.17.3. This affects an unknown part. The manipulation leads to cross-site request forgery. It is possible to initiate the attack remotely. Upgrading to version 1.18.0 is able to address this issue. The name of the patch is b9039adbb264c81333328faa9575ecf8e0d2be94. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216471.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-21T19:15:13.360",
    "last_modified": "2024-11-21T06:37:16.643",
    "fix_date": "2021-08-26T18:19:02Z"
  },
  "references": [
    {
      "url": "https://github.com/erikdubbelboer/phpRedisAdmin/commit/b9039adbb264c81333328faa9575ecf8e0d2be94",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/erikdubbelboer/phpRedisAdmin/releases/tag/v1.18.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216471",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/erikdubbelboer/phpRedisAdmin/commit/b9039adbb264c81333328faa9575ecf8e0d2be94",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/erikdubbelboer/phpRedisAdmin/releases/tag/v1.18.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216471",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.193764",
    "processing_status": "enhanced"
  }
}