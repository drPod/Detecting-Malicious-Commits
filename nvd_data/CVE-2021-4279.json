{
  "cve_id": "CVE-2021-4279",
  "github_data": {
    "repository": "Starcounter-Jack/JSON-Patch",
    "fix_commit": "7ad6af41eabb2d799f698740a91284d762c955c9",
    "related_commits": [
      "7ad6af41eabb2d799f698740a91284d762c955c9",
      "7ad6af41eabb2d799f698740a91284d762c955c9"
    ],
    "patch_url": "https://github.com/Starcounter-Jack/JSON-Patch/commit/7ad6af41eabb2d799f698740a91284d762c955c9.patch",
    "fix_commit_details": {
      "sha": "7ad6af41eabb2d799f698740a91284d762c955c9",
      "commit_date": "2021-08-13T10:10:25Z",
      "author": {
        "login": "Starcounter-Jack",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #262 from 418sec/1-npm-fast-json-patch",
        "length": 107,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 13,
        "deletions": 6
      },
      "files": [
        {
          "filename": "commonjs/core.js",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -188,8 +188,10 @@ function applyOperation(document, operation, validateOperation, mutateDocument,\n             if (key && key.indexOf('~') != -1) {\n                 key = helpers_js_1.unescapePathComponent(key);\n             }\n-            if (banPrototypeModifications && key == '__proto__') {\n-                throw new TypeError('JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README');\n+            if (banPrototypeModifications &&\n+                (key == '__proto__' ||\n+                    (key == 'prototype' && t > 0 && keys[t - 1] == 'constructor'))) {\n+                throw new TypeError('JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README');\n             }\n             if (validateOperation) {\n                 if (existingPathFragment === undefined) {"
        },
        {
          "filename": "module/core.mjs",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -186,8 +186,10 @@ export function applyOperation(document, operation, validateOperation, mutateDoc\n             if (key && key.indexOf('~') != -1) {\n                 key = unescapePathComponent(key);\n             }\n-            if (banPrototypeModifications && key == '__proto__') {\n-                throw new TypeError('JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README');\n+            if (banPrototypeModifications &&\n+                (key == '__proto__' ||\n+                    (key == 'prototype' && t > 0 && keys[t - 1] == 'constructor'))) {\n+                throw new TypeError('JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README');\n             }\n             if (validateOperation) {\n                 if (existingPathFragment === undefined) {"
        },
        {
          "filename": "src/core.ts",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -251,8 +251,11 @@ export function applyOperation<T>(document: T, operation: Operation, validateOpe\n         key = unescapePathComponent(key);\n       }\n \n-      if(banPrototypeModifications && key == '__proto__') {\n-        throw new TypeError('JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README');\n+      if(banPrototypeModifications && \n+          (key == '__proto__' || \n+          (key == 'prototype' && t>0 && keys[t-1] == 'constructor'))\n+        ) {\n+        throw new TypeError('JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README');\n       }\n \n       if (validateOperation) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9d313ac01916e525e9204074f06e5295edec491b",
            "date": "2022-03-24T18:37:00Z",
            "author_login": "Starcounter-Jack"
          },
          {
            "sha": "e4f4eb3e680fdedf0c51374ec8b9f0467f53a327",
            "date": "2022-03-24T18:28:08Z",
            "author_login": "Starcounter-Jack"
          },
          {
            "sha": "d7903fba45c7090845c87e740aa63951e97e51c8",
            "date": "2022-03-24T18:27:49Z",
            "author_login": "Starcounter-Jack"
          },
          {
            "sha": "5f04488153d0d6b5b422bdf11e6b8a9031d80029",
            "date": "2022-03-24T18:13:20Z",
            "author_login": "Starcounter-Jack"
          },
          {
            "sha": "7e9fe1332d2f4bf9d8b03e0dc4a76d5b1d755e77",
            "date": "2022-03-24T18:07:28Z",
            "author_login": "Starcounter-Jack"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-1321",
    "description": "A vulnerability has been found in Starcounter-Jack JSON-Patch up to 3.1.0 and classified as problematic. This vulnerability affects unknown code. The manipulation leads to improperly controlled modification of object prototype attributes ('prototype pollution'). The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 3.1.1 is able to address this issue. The name of the patch is 7ad6af41eabb2d799f698740a91284d762c955c9. It is recommended to upgrade the affected component. VDB-216778 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-25T20:15:25.610",
    "last_modified": "2024-11-21T06:37:18.260",
    "fix_date": "2021-08-13T10:10:25Z"
  },
  "references": [
    {
      "url": "https://github.com/Starcounter-Jack/JSON-Patch/commit/7ad6af41eabb2d799f698740a91284d762c955c9",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Starcounter-Jack/JSON-Patch/pull/262",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Starcounter-Jack/JSON-Patch/releases/tag/3.1.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216778",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216778",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Starcounter-Jack/JSON-Patch/commit/7ad6af41eabb2d799f698740a91284d762c955c9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Starcounter-Jack/JSON-Patch/pull/262",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Starcounter-Jack/JSON-Patch/releases/tag/3.1.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216778",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216778",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.210035",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "JSON-Patch",
    "owner": "Starcounter-Jack",
    "created_at": "2013-03-16T13:08:46Z",
    "updated_at": "2025-01-10T19:03:38Z",
    "pushed_at": "2024-07-17T00:41:04Z",
    "size": 4058,
    "stars": 1831,
    "forks": 217,
    "open_issues": 75,
    "watchers": 1831,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 231552,
      "TypeScript": 32834,
      "HTML": 1457,
      "CSS": 1172,
      "Shell": 405
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:03:05.164450"
  }
}