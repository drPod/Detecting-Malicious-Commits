{
  "cve_id": "CVE-2021-4281",
  "github_data": {
    "repository": "BraveUX/for-the-badge",
    "fix_commit": "55b5a234c0fab935df5fb08365bc8fe9c37cf46b",
    "related_commits": [
      "55b5a234c0fab935df5fb08365bc8fe9c37cf46b",
      "55b5a234c0fab935df5fb08365bc8fe9c37cf46b"
    ],
    "patch_url": "https://github.com/BraveUX/for-the-badge/commit/55b5a234c0fab935df5fb08365bc8fe9c37cf46b.patch",
    "fix_commit_details": {
      "sha": "55b5a234c0fab935df5fb08365bc8fe9c37cf46b",
      "commit_date": "2021-07-30T07:27:42Z",
      "author": {
        "login": "martingjaldbaek",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix potential injection vulnerability",
        "length": 107,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": ".github/workflows/combine-prs.yml",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -106,7 +106,7 @@ jobs:\n           BRANCHES_TO_COMBINE: ${{ steps.fetch-branch-names.outputs.result }}\n           COMBINE_BRANCH_NAME: ${{ github.event.inputs.combineBranchName }}\n         run: |\n-          echo \"${{steps.fetch-branch-names.outputs.result}}\"\n+          echo \"$BRANCHES_TO_COMBINE\"\n           sourcebranches=\"${BRANCHES_TO_COMBINE%\\\"}\"\n           sourcebranches=\"${sourcebranches#\\\"}\"\n \n@@ -124,10 +124,12 @@ jobs:\n       # Creates a PR with the new combined branch\n       - uses: actions/github-script@v3\n         name: Create Combined Pull Request\n+        env:\n+          PRS_STRING: ${{ steps.fetch-branch-names.outputs.prs-string }}\n         with:\n           github-token: ${{secrets.GITHUB_TOKEN}}\n           script: |\n-            const prString = `${{ steps.fetch-branch-names.outputs.prs-string }}`;\n+            const prString = process.env.PRS_STRING;\n             const body = 'This PR was created by the Combine PRs action by combining the following PRs:\\n' + prString;\n             await github.pulls.create({\n               owner: context.repo.owner,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "30be8943b476e23792295f7637c486ea98d5da2f",
            "date": "2024-09-13T05:31:46Z",
            "author_login": "andrewsbarbaro"
          },
          {
            "sha": "c0149d7b44fcb8cf8f60645a4912e24b8db1a192",
            "date": "2024-02-15T05:59:51Z",
            "author_login": "andrewsbarbaro"
          },
          {
            "sha": "557c0ac3496680e4c8a832bd7137c800aae1e27b",
            "date": "2024-02-09T05:18:22Z",
            "author_login": "andrewsbarbaro"
          },
          {
            "sha": "c9410ed938a97afaf29b5a497e02b6bf6d322564",
            "date": "2024-02-05T23:50:50Z",
            "author_login": "andrewsbarbaro"
          },
          {
            "sha": "c3831f9d6dd214a1232b9624b697b22d8b56292a",
            "date": "2024-02-05T06:25:26Z",
            "author_login": "andrewsbarbaro"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-78",
    "description": "A vulnerability was found in Brave UX for-the-badge and classified as critical. Affected by this issue is some unknown functionality of the file .github/workflows/combine-prs.yml. The manipulation leads to os command injection. The name of the patch is 55b5a234c0fab935df5fb08365bc8fe9c37cf46b. It is recommended to apply a patch to fix this issue. VDB-216842 is the identifier assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-26T20:15:10.580",
    "last_modified": "2024-11-21T06:37:18.567",
    "fix_date": "2021-07-30T07:27:42Z"
  },
  "references": [
    {
      "url": "https://github.com/BraveUX/for-the-badge/commit/55b5a234c0fab935df5fb08365bc8fe9c37cf46b",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/BraveUX/for-the-badge/pull/165",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216842",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216842",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/BraveUX/for-the-badge/commit/55b5a234c0fab935df5fb08365bc8fe9c37cf46b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/BraveUX/for-the-badge/pull/165",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216842",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216842",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.212173",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "for-the-badge",
    "owner": "BraveUX",
    "created_at": "2014-08-18T20:03:24Z",
    "updated_at": "2024-12-26T06:16:06Z",
    "pushed_at": "2024-09-13T05:31:47Z",
    "size": 2384,
    "stars": 1809,
    "forks": 148,
    "open_issues": 0,
    "watchers": 1809,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "TypeScript": 23488,
      "CSS": 554,
      "HTML": 417,
      "JavaScript": 374,
      "Dockerfile": 241
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T18:08:13.006184"
  }
}