{
  "cve_id": "CVE-2021-4282",
  "github_data": {
    "repository": "FreePBX/voicemail",
    "fix_commit": "12e1469ef9208eda9d8955206e78345949236ee6",
    "related_commits": [
      "12e1469ef9208eda9d8955206e78345949236ee6",
      "12e1469ef9208eda9d8955206e78345949236ee6"
    ],
    "patch_url": "https://github.com/FreePBX/voicemail/commit/12e1469ef9208eda9d8955206e78345949236ee6.patch",
    "fix_commit_details": {
      "sha": "12e1469ef9208eda9d8955206e78345949236ee6",
      "commit_date": "2021-09-15T06:53:32Z",
      "author": {
        "login": "kguptasangoma",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #78 in FREEPBX/voicemail from feature/FREEI-2107-stored-xss-in-freepbx-14 to release/14.0",
        "length": 187,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "page.voicemail.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -398,7 +398,8 @@\n //TODO: Do we really need to say \"UPDATE COMPLETED??\"\n if ($need_update && $action != 'usage') {\n \t$args = array();\n-\tif (voicemail_update_settings($action, $context, $extension, $_REQUEST)) {\n+\t$request = freepbxGetSanitizedRequest(FILTER_UNSAFE_RAW);\n+\tif (voicemail_update_settings($action, $context, $extension, $request)) {\n \t\t$url = \"config.php?type=$type&display=$display&action=$action&ext=$extension&updated=true\";\n \t\t\t\tneedreload();\n \t\t\t\tredirect($url);\n@@ -680,7 +681,8 @@\n \t\t*/\n \t\t$scope = voicemail_get_scope($extension);\n \t\tif ($need_update) {\n-\t\t\tvoicemail_update_usage($vmail_info, $context, $extension, $_REQUEST);\n+\t\t\t$request = freepbxGetSanitizedRequest(FILTER_UNSAFE_RAW);\n+\t\t\tvoicemail_update_usage($vmail_info, $context, $extension, $request);\n \t\t\tif (!empty($extension)) {\n \t\t\t\t$url = \"config.php?display=$display&ext=$extension&action=$action&updated=true\";\n \t\t\t} else {"
        },
        {
          "filename": "views/ssettings.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -39,10 +39,10 @@\n \t\t\t\t\t\t\t\t\t\t<div class=\"col-md-9\">\n \t\t\t\t\t\t\t\t\t\t\t<?php switch($items['type']) {\n \t\t\t\t\t\t\t\t\t\t\t\t\t\tcase \"number\": ?>\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"number\" class=\"form-control\" id=\"<?php echo $id_prefix?>__<?php echo $key?>\" name=\"<?php echo $id_prefix?>__<?php echo $key?>\" value=\"<?php echo !empty($settings[$key]) ? $settings[$key] : $items['default'] ?>\" <?php if(!empty($items['options'])) {?>min=\"<?php echo $items['options'][0]?>\" max=\"<?php echo $items['options'][1]?>\"<?php } ?>>\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"number\" class=\"form-control\" id=\"<?php echo $id_prefix?>__<?php echo $key?>\" name=\"<?php echo $id_prefix?>__<?php echo $key?>\" value=\"<?php echo !empty($settings[$key]) ? htmlentities($settings[$key], ENT_COMPAT, 'UTF-8') : $items['default'] ?>\" <?php if(!empty($items['options'])) {?>min=\"<?php echo $items['options'][0]?>\" max=\"<?php echo $items['options'][1]?>\"<?php } ?>>\n \t\t\t\t\t\t\t\t\t\t\t\t<?php break;\n \t\t\t\t\t\t\t\t\t\t\t\t\t\tcase \"text\": ?>\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"<?php echo $id_prefix?>__<?php echo $key?>\" name=\"<?php echo $id_prefix?>__<?php echo $key?>\" value=\"<?php echo !empty($settings[$key]) ? $settings[$key] : $items['default'] ?>\">\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"<?php echo $id_prefix?>__<?php echo $key?>\" name=\"<?php echo $id_prefix?>__<?php echo $key?>\" value=\"<?php echo !empty($settings[$key]) ? htmlentities($settings[$key], ENT_COMPAT, 'UTF-8') : $items['default'] ?>\">\n \t\t\t\t\t\t\t\t\t\t\t\t<?php break;\n \t\t\t\t\t\t\t\t\t\t\t\t\t\tcase \"textbox\":\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$value = !empty($settings[$key]) ? $settings[$key] : $items['default'];"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7a454f1248e6f2ce9b1cc19cf9a56a26d8913d3b",
            "date": "2025-01-09T05:54:01Z",
            "author_login": "kguptasangoma"
          },
          {
            "sha": "099090a629c9bc08f0d8290f117dfd1b8eea4475",
            "date": "2025-01-09T03:34:41Z",
            "author_login": "Rverma032"
          },
          {
            "sha": "321823584ffb925e138fbfb80c11ecc0078d7ffa",
            "date": "2025-01-06T05:26:11Z",
            "author_login": "kguptasangoma"
          },
          {
            "sha": "40f59b6491166d57f47ec18cf8b8a235b26283e6",
            "date": "2025-01-06T05:24:10Z",
            "author_login": "kguptasangoma"
          },
          {
            "sha": "afcae80516a2f479368fe5b18c106be291c996ee",
            "date": "2025-01-06T02:18:37Z",
            "author_login": "blazestudios97"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in FreePBX voicemail. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file page.voicemail.php. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 14.0.6.25 is able to address this issue. The name of the patch is 12e1469ef9208eda9d8955206e78345949236ee6. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216871.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T10:15:11.390",
    "last_modified": "2024-11-21T06:37:18.713",
    "fix_date": "2021-09-15T06:53:32Z"
  },
  "references": [
    {
      "url": "https://github.com/FreePBX/voicemail/commit/12e1469ef9208eda9d8955206e78345949236ee6",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreePBX/voicemail/releases/tag/release%2F14.0.6.25",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216871",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216871",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreePBX/voicemail/commit/12e1469ef9208eda9d8955206e78345949236ee6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FreePBX/voicemail/releases/tag/release%2F14.0.6.25",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216871",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216871",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.214043",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "voicemail",
    "owner": "FreePBX",
    "created_at": "2014-01-07T21:49:11Z",
    "updated_at": "2025-01-11T07:02:25Z",
    "pushed_at": "2025-01-09T05:53:54Z",
    "size": 24023,
    "stars": 4,
    "forks": 19,
    "open_issues": 0,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "release/17.0",
    "protected_branches": [],
    "languages": {
      "PHP": 362464,
      "JavaScript": 40729,
      "Less": 97
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:49:49.970293"
  }
}