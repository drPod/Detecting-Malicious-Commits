{
  "cve_id": "CVE-2021-4285",
  "github_data": {
    "repository": "NagiosEnterprises/ncpa",
    "fix_commit": "5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5",
    "related_commits": [
      "5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5",
      "5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5"
    ],
    "patch_url": "https://github.com/NagiosEnterprises/ncpa/commit/5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5.patch",
    "fix_commit_details": {
      "sha": "5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5",
      "commit_date": "2021-12-06T19:47:08Z",
      "author": {
        "login": "ne-svandahm",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix XSS issue in log tailing",
        "length": 28,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "agent/listener/templates/tail.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -67,7 +67,7 @@\n     $('.btn-apply').click(function() {\n         var name = $('input[name=\"name\"]').val();\n         query_string = \"name=\" + name;\n-        $('.name').html(name);\n+        $('.name').text(name);\n \n         // Restart the websocket\n         ws.close();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0b8b2137e72b605a29b85744427333a5c299b340",
            "date": "2024-12-26T22:14:10Z",
            "author_login": "ne-bbahn"
          },
          {
            "sha": "0fb0cbe7abcd45fee91f7e975a5b63c99b4feaf2",
            "date": "2024-12-26T22:13:28Z",
            "author_login": "ne-bbahn"
          },
          {
            "sha": "236a16a1e9a7e2af1c28582bbe343cf67e59e5a7",
            "date": "2024-09-23T19:37:44Z",
            "author_login": "ne-bbahn"
          },
          {
            "sha": "203bc9a954eddd9b4af5c5f13a15e57b06f2d170",
            "date": "2024-09-23T19:36:55Z",
            "author_login": "ne-bbahn"
          },
          {
            "sha": "43c62a0229d5cf861962f7a19e14efde9a297f57",
            "date": "2024-09-23T19:36:03Z",
            "author_login": "ne-bbahn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic was found in Nagios NCPA. This vulnerability affects unknown code of the file agent/listener/templates/tail.html. The manipulation of the argument name leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 2.4.0 is able to address this issue. The name of the patch is 5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5. It is recommended to upgrade the affected component. VDB-216874 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T11:15:10.480",
    "last_modified": "2024-11-21T06:37:19.163",
    "fix_date": "2021-12-06T19:47:08Z"
  },
  "references": [
    {
      "url": "https://github.com/NagiosEnterprises/ncpa/commit/5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NagiosEnterprises/ncpa/pull/834",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NagiosEnterprises/ncpa/releases/tag/v2.4.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216874",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216874",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NagiosEnterprises/ncpa/commit/5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NagiosEnterprises/ncpa/pull/834",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NagiosEnterprises/ncpa/releases/tag/v2.4.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216874",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216874",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.214758",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ncpa",
    "owner": "NagiosEnterprises",
    "created_at": "2014-01-16T19:52:04Z",
    "updated_at": "2024-12-26T22:14:14Z",
    "pushed_at": "2025-01-14T19:48:08Z",
    "size": 172949,
    "stars": 183,
    "forks": 92,
    "open_issues": 279,
    "watchers": 183,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 302995,
      "HTML": 170495,
      "Shell": 66885,
      "JavaScript": 45398,
      "CSS": 18480,
      "NSIS": 16268,
      "Batchfile": 6914,
      "PowerShell": 4736
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:09:40.607596"
  }
}