{
  "cve_id": "CVE-2021-4289",
  "github_data": {
    "repository": "openmrs/openmrs-module-referenceapplication",
    "fix_commit": "0410c091d46eed3c132fe0fcafe5964182659f74",
    "related_commits": [
      "0410c091d46eed3c132fe0fcafe5964182659f74",
      "0410c091d46eed3c132fe0fcafe5964182659f74"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "0410c091d46eed3c132fe0fcafe5964182659f74",
      "commit_date": "2021-04-22T16:38:21Z",
      "author": {
        "login": "isears",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #89 from The-Lady/EMPT110",
        "length": 118,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "omod/src/main/java/org/openmrs/module/referenceapplication/page/controller/UserAppPageController.java",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -15,6 +15,7 @@\n \n import javax.servlet.http.HttpSession;\n \n+import org.apache.commons.lang.StringEscapeUtils;\n import org.apache.commons.logging.Log;\n import org.apache.commons.logging.LogFactory;\n import org.codehaus.jackson.map.ObjectMapper;\n@@ -52,7 +53,7 @@ public void get(PageModel model, @RequestParam(value = \"appId\", required = false\n \tpublic String post(PageModel model, @ModelAttribute(value = \"appId\") @BindParams UserApp userApp,\n \t                   @RequestParam(\"action\") String action,\n \t                   @SpringBean(\"appFrameworkService\") AppFrameworkService service, HttpSession session, UiUtils ui) {\n-\t\t\n+\n \t\ttry {\n \t\t\tAppDescriptor descriptor = mapper.readValue(userApp.getJson(), AppDescriptor.class);\n \t\t\tif (!userApp.getAppId().equals(descriptor.getId())) {\n@@ -65,14 +66,14 @@ public String post(PageModel model, @ModelAttribute(value = \"appId\") @BindParams\n \t\t\t\tservice.saveUserApp(userApp);\n \t\t\t\t\n \t\t\t\tInfoErrorMessageUtil.flashInfoMessage(session,\n-\t\t\t\t    ui.message(\"referenceapplication.app.userApp.save.success\", userApp.getAppId()));\n+\t\t\t\t    ui.message(\"referenceapplication.app.userApp.save.success\", StringEscapeUtils.escapeHtml(userApp.getAppId())));\n \t\t\t\t\n \t\t\t\treturn \"redirect:/referenceapplication/manageApps.page\";\n \t\t\t}\n \t\t}\n \t\tcatch (Exception e) {\n \t\t\tsession.setAttribute(UiCommonsConstants.SESSION_ATTRIBUTE_ERROR_MESSAGE,\n-\t\t\t    ui.message(\"referenceapplication.app.userApp.save.fail\", userApp.getAppId()));\n+\t\t\t    ui.message(\"referenceapplication.app.userApp.save.fail\", StringEscapeUtils.escapeHtml(userApp.getAppId())));\n \t\t}\n \t\t\n \t\tmodel.addAttribute(\"userApp\", userApp);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a6dda613b882161b30df45176149e28f4ff3e665",
            "date": "2023-04-13T18:01:18Z",
            "author_login": "jona42-ui"
          },
          {
            "sha": "e0a9d496d9c68fd7a28686aaa70ed07b5c4d4d29",
            "date": "2023-03-13T19:41:19Z",
            "author_login": "openmrs-bot"
          },
          {
            "sha": "f3ea9dc81b48884620543e37557abd5c49257f1a",
            "date": "2023-03-13T19:41:17Z",
            "author_login": "openmrs-bot"
          },
          {
            "sha": "a851717175137668c9bb18c7bd366e01ea9d1cc0",
            "date": "2023-02-12T21:17:36Z",
            "author_login": "dkayiwa"
          },
          {
            "sha": "fb6c8df36b009c2a0b14a21b0ad32aa9bb27f4c7",
            "date": "2022-02-06T01:00:37Z",
            "author_login": "openmrs-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic was found in OpenMRS openmrs-module-referenceapplication up to 2.11.x. Affected by this vulnerability is the function post of the file omod/src/main/java/org/openmrs/module/referenceapplication/page/controller/UserAppPageController.java of the component User App Page. The manipulation of the argument AppId leads to cross site scripting. The attack can be launched remotely. Upgrading to version 2.12.0 is able to address this issue. The name of the patch is 0410c091d46eed3c132fe0fcafe5964182659f74. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216883.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T13:15:11.227",
    "last_modified": "2024-11-21T06:37:19.760",
    "fix_date": "2021-04-22T16:38:21Z"
  },
  "references": [
    {
      "url": "https://github.com/openmrs/openmrs-module-referenceapplication/commit/0410c091d46eed3c132fe0fcafe5964182659f74",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-referenceapplication/pull/89",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-referenceapplication/releases/tag/referenceapplication-2.12.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://issues.openmrs.org/browse/RA-1875",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216883",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216883",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-referenceapplication/commit/0410c091d46eed3c132fe0fcafe5964182659f74",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-referenceapplication/pull/89",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-referenceapplication/releases/tag/referenceapplication-2.12.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://issues.openmrs.org/browse/RA-1875",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216883",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216883",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.216690",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "openmrs-module-referenceapplication",
    "owner": "openmrs",
    "created_at": "2013-04-01T19:41:57Z",
    "updated_at": "2023-02-09T17:30:22Z",
    "pushed_at": "2024-06-19T17:31:01Z",
    "size": 3121,
    "stars": 6,
    "forks": 140,
    "open_issues": 9,
    "watchers": 6,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "SCSS": 224004,
      "Java": 106291,
      "Groovy": 22531,
      "JavaScript": 1999
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:08:00.726186"
  }
}