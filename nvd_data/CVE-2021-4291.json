{
  "cve_id": "CVE-2021-4291",
  "github_data": {
    "repository": "openmrs/openmrs-module-adminui",
    "fix_commit": "a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6",
    "related_commits": [
      "a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6",
      "a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6",
      "commit_date": "2021-06-16T14:07:06Z",
      "author": {
        "login": "jnsereko",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "RA-1424: escapeJs vulnerable to XSS. (#61)",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "omod/src/main/webapp/pages/metadata/locations/location.gsp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@\n \n     def parentLocationOptions = []\n     existingLocations.each {\n-        parentLocationOptions.push([ label: ui.escapeJs(ui.format(it)), value: it.id ])\n+        parentLocationOptions.push([ label: ui.encodeJavaScript(ui.format(it)), value: it.id ])\n     }\n %>\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b0457d8744851c85e9aea2f400f853f71a8d5c12",
            "date": "2023-12-04T14:14:22Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "ee309c525d3c61119c37a659c31d48cbe25120b0",
            "date": "2023-12-04T14:00:02Z",
            "author_login": "wikumChamith"
          },
          {
            "sha": "aa5a241b06b1f1ba965732fd9d5914fe9e5f4d94",
            "date": "2023-11-15T12:59:56Z",
            "author_login": "dkayiwa"
          },
          {
            "sha": "ac7531697f65b787c586dd78ac1629207bc1159d",
            "date": "2023-11-09T13:12:30Z",
            "author_login": "dkayiwa"
          },
          {
            "sha": "36b16e9589e6fcbda14580b7274c6a4012dd9e03",
            "date": "2021-10-02T20:18:24Z",
            "author_login": "openmrs-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in OpenMRS Admin UI Module up to 1.5.x. It has been declared as problematic. This vulnerability affects unknown code of the file omod/src/main/webapp/pages/metadata/locations/location.gsp. The manipulation leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 1.6.0 is able to address this issue. The name of the patch is a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216916.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T23:15:10.677",
    "last_modified": "2024-11-21T06:37:20.053",
    "fix_date": "2021-06-16T14:07:06Z"
  },
  "references": [
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/commit/a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/pull/61",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/releases/tag/1.6.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216916",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216916",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/commit/a7eefb5f69f6c50a3bffcb138bb8ea57cb41a9b6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/pull/61",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openmrs/openmrs-module-adminui/releases/tag/1.6.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216916",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216916",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.224782",
    "processing_status": "enhanced"
  }
}