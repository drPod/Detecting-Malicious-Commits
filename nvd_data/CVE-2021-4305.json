{
  "cve_id": "CVE-2021-4305",
  "github_data": {
    "repository": "Woorank/robots-txt-guard",
    "fix_commit": "c03827cd2f9933619c23894ce7c98401ea824020",
    "related_commits": [
      "c03827cd2f9933619c23894ce7c98401ea824020",
      "c03827cd2f9933619c23894ce7c98401ea824020"
    ],
    "patch_url": "https://github.com/Woorank/robots-txt-guard/commit/c03827cd2f9933619c23894ce7c98401ea824020.patch",
    "fix_commit_details": {
      "sha": "c03827cd2f9933619c23894ce7c98401ea824020",
      "commit_date": "2021-02-07T12:40:28Z",
      "author": {
        "login": "Janpot",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #4 from Woorank/redos",
        "length": 64,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/patterns.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -38,7 +38,7 @@ exports.path = function makePathPattern (pattern) {\n   const specificityString = pattern.replace(/\\*/g, '');\n \n   pattern = pattern\n-    .split('*')\n+    .split(/\\*+/)\n     .map(escapeRegExp)\n     .join('(?:.*)');\n "
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"robots-txt-guard\",\n-  \"version\": \"0.2.1\",\n+  \"version\": \"1.0.0\",\n   \"lockfileVersion\": 1,\n   \"requires\": true,\n   \"dependencies\": {"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"robots-txt-guard\",\n-  \"version\": \"0.2.1\",\n+  \"version\": \"1.0.0\",\n   \"description\": \"Validate urls against robots.txt rules.\",\n   \"main\": \"lib/guard.js\",\n   \"repository\": {"
        },
        {
          "filename": "test/patterns.spec.js",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -150,5 +150,10 @@ describe('patterns', function () {\n \n       assertNoMatch(pattern, '/Fish.PHP');\n     });\n+\n+    it('should handle a ReDos', function () {\n+      const pattern = patterns.path('/*****************************************************************************.js$');\n+      assertMatch(pattern, '/hello.js');\n+    });\n   });\n });"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b615ef3231fd061303bf1fa005e6740391d4573d",
            "date": "2021-02-23T22:09:57Z",
            "author_login": "Janpot"
          },
          {
            "sha": "915ae16ef5e3b218c3d5fa0e9cb3777301388708",
            "date": "2021-02-08T14:30:04Z",
            "author_login": "Janpot"
          },
          {
            "sha": "66bf83d11f6074342db6d9dc679830b06e1cd2a3",
            "date": "2021-02-08T14:29:36Z",
            "author_login": "Janpot"
          },
          {
            "sha": "9eabb07c8948b15f5583743a5975f48b27d159d5",
            "date": "2021-02-08T14:28:52Z",
            "author_login": "Janpot"
          },
          {
            "sha": "1c07c82d0a210fb35b7cbeeb033ec364da0b82ac",
            "date": "2021-02-08T14:17:00Z",
            "author_login": "Janpot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-1333",
    "description": "A vulnerability was found in Woorank robots-txt-guard. It has been rated as problematic. Affected by this issue is the function makePathPattern of the file lib/patterns.js. The manipulation of the argument pattern leads to inefficient regular expression complexity. The exploit has been disclosed to the public and may be used. The name of the patch is c03827cd2f9933619c23894ce7c98401ea824020. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217448.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-05T11:15:09.120",
    "last_modified": "2024-11-21T06:37:22.203",
    "fix_date": "2021-02-07T12:40:28Z"
  },
  "references": [
    {
      "url": "https://github.com/Woorank/robots-txt-guard/commit/c03827cd2f9933619c23894ce7c98401ea824020",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Woorank/robots-txt-guard/pull/4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217448",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217448",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Woorank/robots-txt-guard/commit/c03827cd2f9933619c23894ce7c98401ea824020",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Woorank/robots-txt-guard/pull/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217448",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217448",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.512003",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "robots-txt-guard",
    "owner": "Woorank",
    "created_at": "2014-10-14T15:22:32Z",
    "updated_at": "2024-08-02T23:32:25Z",
    "pushed_at": "2021-06-12T16:39:21Z",
    "size": 303,
    "stars": 3,
    "forks": 2,
    "open_issues": 3,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 22682
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:12:52.368266"
  }
}