{
  "cve_id": "CVE-2021-4312",
  "github_data": {
    "repository": "Th3-822/rapidleech",
    "fix_commit": "885a87ea4ee5e14fa95801eca255604fb2e138c6",
    "related_commits": [
      "885a87ea4ee5e14fa95801eca255604fb2e138c6",
      "885a87ea4ee5e14fa95801eca255604fb2e138c6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "885a87ea4ee5e14fa95801eca255604fb2e138c6",
      "commit_date": "2021-09-11T23:13:43Z",
      "author": {
        "login": "Th3-822",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed XSS on classes/options/zip.php",
        "length": 36,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 13,
        "deletions": 14
      },
      "files": [
        {
          "filename": "classes/options/zip.php",
          "status": "modified",
          "additions": 13,
          "deletions": 14,
          "patch": "@@ -1,8 +1,8 @@\n <?php\r\n function zip() {\r\n-\tglobal $list, $options, $PHP_SELF;\r\n+\tglobal $list, $options;\r\n ?>\r\n-<form name=\"ziplist\" method=\"post\" action=\"<?php echo $PHP_SELF; ?>\"><input type=\"hidden\" name=\"act\" value=\"zip_go\" />\r\n+<form name=\"ziplist\" method=\"post\" action=\"<?php echo $_SERVER['SCRIPT_NAME']; ?>\"><input type=\"hidden\" name=\"act\" value=\"zip_go\" />\r\n \t<table cellspacing=\"5\">\r\n \t\t<tr>\r\n \t\t\t<td align=\"center\"><strong>Adding files to a ZIP archive</strong></td>\r\n@@ -42,7 +42,7 @@ function zip() {\n function zip_go() {\r\n \tglobal $list, $options;\r\n \t$saveTo = realpath ( $options['download_dir'] ) . '/';\r\n-\t$_POST [\"archive\"] = (strlen ( trim ( urldecode ( $_POST [\"archive\"] ) ) ) > 4 && substr ( trim ( urldecode ( $_POST [\"archive\"] ) ), - 4 ) == \".zip\") ? trim ( urldecode ( $_POST [\"archive\"] ) ) : \"archive.zip\";\r\n+\t$_POST [\"archive\"] = (strlen ( trim ( urldecode ($_POST['archive']) ) ) > 4 && substr ( trim ( urldecode ($_POST['archive']) ), - 4 ) == \".zip\") ? trim ( urldecode ($_POST['archive']) ) : \"archive.zip\";\r\n \t$_POST [\"archive\"] = $saveTo.basename($_POST [\"archive\"]);\r\n \tfor($i = 0; $i < count ( $_POST [\"files\"] ); $i ++) {\r\n \t\t$files [] = $list [($_POST [\"files\"] [$i])];\r\n@@ -55,25 +55,24 @@ function zip_go() {\n \t\t}\r\n \t}\r\n \trequire_once (CLASS_DIR . \"pclzip.php\");\r\n-\t$archive = new PclZip ( $_POST [\"archive\"] );\r\n+\t$archive = new PclZip ($_POST['archive']);\r\n \t$no_compression = ($options['disable_archive_compression'] || isset($_POST[\"no_compression\"]));\r\n-\tif (file_exists ( $_POST [\"archive\"] )) {\r\n+\tif (file_exists ($_POST['archive'])) {\r\n \t\tif ($no_compression) { $v_list = $archive->add ( $add_files, PCLZIP_OPT_REMOVE_ALL_PATH, PCLZIP_OPT_NO_COMPRESSION); }\r\n \t\telse { $v_list = $archive->add ( $add_files, PCLZIP_OPT_REMOVE_ALL_PATH); }\r\n \t} else {\r\n \t\tif ($no_compression) { $v_list = $archive->create ( $add_files, PCLZIP_OPT_REMOVE_ALL_PATH, PCLZIP_OPT_NO_COMPRESSION); }\r\n \t\telse { $v_list = $archive->create ( $add_files, PCLZIP_OPT_REMOVE_ALL_PATH); }\r\n \t}\r\n-\tif ($v_list == 0) {\r\n-\t\techo \"Error: \" . $archive->errorInfo ( true ) . \"<br /><br />\";\r\n-\t\treturn;\r\n-\t} else {\r\n-\t\techo \"Archive <b>\" . $_POST [\"archive\"] . \"</b> successfully created!<br /><br />\";\r\n-\t}\r\n-\tif (is_file($_POST['archive'])) {\r\n+\r\n+\tif ($v_list != 0 && is_file($_POST['archive'])) {\r\n+\t\techo \"Archive <b>\" . htmlspecialchars($_POST['archive']) . \"</b> successfully created!<br /><br />\";\r\n+\r\n \t\t$time = filemtime($_POST['archive']); while (isset($list[$time])) { $time++; }\r\n \t\t$list[$time] = array(\"name\" => $_POST['archive'], \"size\" => bytesToKbOrMbOrGb(filesize($_POST['archive'])), \"date\" => $time);\r\n \t\tif (!updateListInFile($list)) { echo lang(146).\"<br /><br />\"; }\r\n+\t} else {\r\n+\t\techo \"Error: \" . htmlspecialchars($archive->errorInfo(true)) . \"<br /><br />\";\r\n+\t\treturn;\r\n \t}\r\n-}\r\n-?>\n\\ No newline at end of file\n+}\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f225851a654594fcd55584eb2a8068a9dc3c4d19",
            "date": "2021-10-12T03:27:57Z",
            "author_login": "Th3-822"
          },
          {
            "sha": "885a87ea4ee5e14fa95801eca255604fb2e138c6",
            "date": "2021-09-11T23:13:43Z",
            "author_login": "Th3-822"
          },
          {
            "sha": "e771690542fd648ae85efa35e0dd034a7d9fae0f",
            "date": "2021-09-07T20:21:25Z",
            "author_login": "Th3-822"
          },
          {
            "sha": "8b478d32636791c743beec900e913c0fddd86402",
            "date": "2021-08-31T21:22:43Z",
            "author_login": "Th3-822"
          },
          {
            "sha": "6e69b9e945c6e26507bb983a38bf0501c82c3b35",
            "date": "2021-05-31T01:49:55Z",
            "author_login": "Th3-822"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in Th3-822 Rapidleech. This affects the function zip_go of the file classes/options/zip.php. The manipulation of the argument archive leads to cross site scripting. It is possible to initiate the attack remotely. The patch is named 885a87ea4ee5e14fa95801eca255604fb2e138c6. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218295. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-13T18:15:10.833",
    "last_modified": "2024-11-21T06:37:23.310",
    "fix_date": "2021-09-11T23:13:43Z"
  },
  "references": [
    {
      "url": "https://github.com/Th3-822/rapidleech/commit/885a87ea4ee5e14fa95801eca255604fb2e138c6",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218295",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218295",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Th3-822/rapidleech/commit/885a87ea4ee5e14fa95801eca255604fb2e138c6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.218295",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.218295",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.550195",
    "processing_status": "enhanced"
  }
}