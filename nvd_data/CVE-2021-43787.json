{
  "cve_id": "CVE-2021-43787",
  "github_data": {
    "repository": "NodeBB/NodeBB",
    "fix_commit": "1783f918bc19568f421473824461ff2ed7755e4c",
    "related_commits": [
      "1783f918bc19568f421473824461ff2ed7755e4c",
      "1783f918bc19568f421473824461ff2ed7755e4c"
    ],
    "patch_url": "https://github.com/NodeBB/NodeBB/commit/1783f918bc19568f421473824461ff2ed7755e4c.patch",
    "fix_commit_details": {
      "sha": "1783f918bc19568f421473824461ff2ed7755e4c",
      "commit_date": "2021-10-25T17:17:33Z",
      "author": {
        "login": "barisusakli",
        "type": "User",
        "stats": {
          "total_commits": 12173,
          "average_weekly_commits": 19.858075040783035,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 600
        }
      },
      "commit_message": {
        "title": "fix: guard against prototype pollution",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/socket.io/uploads.js",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -15,11 +15,12 @@ uploads.upload = async function (socket, data) {\n \t\t'user.updateCover': socketUser.updateCover,\n \t\t'groups.cover.update': socketGroup.cover.update,\n \t};\n-\tif (!socket.uid || !data || !data.chunk || !data.params || !data.params.method || !methodToFunc[data.params.method]) {\n+\tif (!socket.uid || !data || !data.chunk ||\n+\t\t!data.params || !data.params.method || !methodToFunc.hasOwnProperty(data.params.method)) {\n \t\tthrow new Error('[[error:invalid-data]]');\n \t}\n \n-\tinProgress[socket.id] = inProgress[socket.id] || {};\n+\tinProgress[socket.id] = inProgress[socket.id] || Object.create(null);\n \tconst socketUploads = inProgress[socket.id];\n \tconst { method } = data.params;\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5120d11721211405ca7035b450c745747a3b6ad2",
            "date": "2025-01-14T19:45:44Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "c6eaea309e7b49bb5aa288f647efd366786f8462",
            "date": "2025-01-14T15:16:10Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "e89b7ec88762a05e90745d6c89323dc740e0e096",
            "date": "2025-01-13T16:59:42Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "45eabbf5ba2100201fe887a9d6fc81d88379d414",
            "date": "2025-01-08T22:21:05Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "98e5d1b5c2bd33fc4340dc175d1a31c53ab22a83",
            "date": "2025-01-08T17:54:04Z",
            "author_login": "nodebb-misty"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-79",
    "description": "Nodebb is an open source Node.js based forum software. In affected versions a prototype pollution vulnerability in the uploader module allowed a malicious user to inject arbitrary data (i.e. javascript) into the DOM, theoretically allowing for an account takeover when used in conjunction with a path traversal vulnerability disclosed at the same time as this report. The vulnerability has been patched as of v1.18.5. Users are advised to upgrade as soon as possible.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-11-29T20:15:08.190",
    "last_modified": "2024-11-21T06:29:47.300",
    "fix_date": "2021-10-25T17:17:33Z"
  },
  "references": [
    {
      "url": "https://blog.sonarsource.com/nodebb-remote-code-execution-with-one-shot/",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/1783f918bc19568f421473824461ff2ed7755e4c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/releases/tag/v1.18.5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-wx69-rvg3-x7fc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blog.sonarsource.com/nodebb-remote-code-execution-with-one-shot/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/1783f918bc19568f421473824461ff2ed7755e4c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/releases/tag/v1.18.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-wx69-rvg3-x7fc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.808020",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "NodeBB",
    "owner": "NodeBB",
    "created_at": "2013-04-22T16:49:40Z",
    "updated_at": "2025-01-14T17:22:47Z",
    "pushed_at": "2025-01-14T16:53:56Z",
    "size": 94074,
    "stars": 14301,
    "forks": 2808,
    "open_issues": 183,
    "watchers": 14301,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "JavaScript": 3635990,
      "Smarty": 492390,
      "SCSS": 35767,
      "HTML": 6457,
      "Shell": 5633,
      "Dockerfile": 4860,
      "CSS": 3261,
      "Batchfile": 42
    },
    "commit_activity": {
      "total_commits_last_year": 1255,
      "avg_commits_per_week": 24.134615384615383,
      "days_active_last_year": 279
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T18:31:47.568922"
  }
}