{
  "cve_id": "CVE-2021-43800",
  "github_data": {
    "repository": "Requarks/wiki",
    "fix_commit": "414033de9dff66a327e3f3243234852f468a9d85",
    "related_commits": [
      "414033de9dff66a327e3f3243234852f468a9d85",
      "414033de9dff66a327e3f3243234852f468a9d85"
    ],
    "patch_url": "https://github.com/Requarks/wiki/commit/414033de9dff66a327e3f3243234852f468a9d85.patch",
    "fix_commit_details": {
      "sha": "414033de9dff66a327e3f3243234852f468a9d85",
      "commit_date": "2021-12-04T03:30:22Z",
      "author": {
        "login": "NGPixel",
        "type": "User",
        "stats": {
          "total_commits": 1853,
          "average_weekly_commits": 4.211363636363636,
          "total_additions": 616535,
          "total_deletions": 528003,
          "weeks_active": 323
        }
      },
      "commit_message": {
        "title": "fix: asset path traversal on windows",
        "length": 36,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
      },
      "files": [
        {
          "filename": "server/helpers/page.js",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -35,6 +35,8 @@ module.exports = {\n     rawPath = rawPath.replace(unsafeCharsRegex, '')\n     if (rawPath === '') { rawPath = 'home' }\n \n+    rawPath = rawPath.replaceAll('\\\\', '').replaceAll('//', '').replaceAll(/\\.\\.+/ig, '')\n+\n     // Extract Info\n     let pathParts = _.filter(_.split(rawPath, '/'), p => {\n       p = _.trim(p)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "abc8dce9ccb9b9f90e5681e01abce3929183f6a4",
            "date": "2025-01-01T05:18:42Z",
            "author_login": "Vasfed"
          },
          {
            "sha": "94d253bf596a976a85034a1317b896af5b720b6b",
            "date": "2024-11-22T19:31:07Z",
            "author_login": "maarous"
          },
          {
            "sha": "c7c20579fd893387236d11688660a4d20cee8f1d",
            "date": "2024-11-18T22:18:28Z",
            "author_login": "NGPixel"
          },
          {
            "sha": "583ea44a72aecb94c93721880cdd6c2bb6491cf1",
            "date": "2024-11-18T22:13:52Z",
            "author_login": "NGPixel"
          },
          {
            "sha": "ab5c620d5046cfa4713fca9a44a78477baac4b40",
            "date": "2024-10-12T08:51:48Z",
            "author_login": "NGPixel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Wiki.js is a wiki app built on Node.js. Prior to version 2.5.254, directory traversal outside of Wiki.js context is possible when a storage module with local asset cache fetching is enabled on a Windows host. A malicious user can potentially read any file on the file system by crafting a special URL that allows for directory traversal. This is only possible on a Wiki.js server running on Windows, when a storage module implementing local asset cache (e.g Local File System or Git) is enabled and that no web application firewall solution (e.g. cloudflare) strips potentially malicious URLs. Commit number 414033de9dff66a327e3f3243234852f468a9d85 fixes this vulnerability by sanitizing the path before it is passed on to the storage module. The sanitization step removes any windows directory traversal sequences from the path. As a workaround, disable any storage module with local asset caching capabilities (Local File System, Git).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-06T19:15:07.670",
    "last_modified": "2024-11-21T06:29:49.037",
    "fix_date": "2021-12-04T03:30:22Z"
  },
  "references": [
    {
      "url": "https://github.com/Requarks/wiki/commit/414033de9dff66a327e3f3243234852f468a9d85",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/releases/tag/2.5.254",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-r363-73gj-6j25",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/commit/414033de9dff66a327e3f3243234852f468a9d85",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/releases/tag/2.5.254",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Requarks/wiki/security/advisories/GHSA-r363-73gj-6j25",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.821003",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wiki",
    "owner": "Requarks",
    "created_at": "2016-08-16T19:35:26Z",
    "updated_at": "2025-01-14T13:04:23Z",
    "pushed_at": "2025-01-01T05:18:42Z",
    "size": 40284,
    "stars": 25375,
    "forks": 2812,
    "open_issues": 162,
    "watchers": 25375,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Vue": 885886,
      "JavaScript": 785105,
      "SCSS": 93552,
      "HTML": 37190,
      "Shell": 31046,
      "Pug": 14489,
      "Go": 3549,
      "CSS": 3199,
      "Dockerfile": 3028,
      "Mustache": 2944
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:20:59.329863"
  }
}