{
  "cve_id": "CVE-2021-43818",
  "github_data": {
    "repository": "lxml/lxml",
    "fix_commit": "12fa9669007180a7bb87d990c375cf91ca5b664a",
    "related_commits": [
      "12fa9669007180a7bb87d990c375cf91ca5b664a",
      "a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c",
      "f2330237440df7e8f39c3ad1b1aa8852be3b27c0",
      "12fa9669007180a7bb87d990c375cf91ca5b664a",
      "a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c",
      "f2330237440df7e8f39c3ad1b1aa8852be3b27c0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "12fa9669007180a7bb87d990c375cf91ca5b664a",
      "commit_date": "2021-11-11T11:20:57Z",
      "author": {
        "login": "scoder",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Cleaner: Prevent \"@import\" from re-occurring in the CSS after replacements, e.g. \"@@importimport\".",
        "length": 126,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 22,
        "additions": 22,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/lxml/html/clean.py",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -541,6 +541,8 @@ def _has_sneaky_javascript(self, style):\n             return True\n         if 'expression(' in style:\n             return True\n+        if '@import' in style:\n+            return True\n         if '</noscript' in style:\n             # e.g. '<noscript><style><a title=\"</noscript><img src=x onerror=alert(1)>\">'\n             return True"
        },
        {
          "filename": "src/lxml/html/tests/test_clean.py",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -123,6 +123,26 @@ def test_sneaky_js_in_math_style(self):\n             b'<math><style>/* deleted */</style></math>',\n             lxml.html.tostring(clean_html(s)))\n \n+    def test_sneaky_import_in_style(self):\n+        # Prevent \"@@importimport\" -> \"@import\" replacement.\n+        style_codes = [\n+            \"@@importimport(extstyle.css)\",\n+            \"@ @  import import(extstyle.css)\",\n+            \"@ @ importimport(extstyle.css)\",\n+            \"@@  import import(extstyle.css)\",\n+            \"@ @import import(extstyle.css)\",\n+            \"@@importimport()\",\n+        ]\n+        for style_code in style_codes:\n+            html = '<style>%s</style>' % style_code\n+            s = lxml.html.fragment_fromstring(html)\n+\n+            cleaned = lxml.html.tostring(clean_html(s))\n+            self.assertEqual(\n+                b'<style>/* deleted */</style>',\n+                cleaned,\n+                \"%s  ->  %s\" % (style_code, cleaned))\n+\n     def test_formaction_attribute_in_button_input(self):\n         # The formaction attribute overrides the form's action and should be\n         # treated as a malicious link attribute"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c58e3de71d2a0c74a1c401698ab956d3ca787741",
            "date": "2025-01-13T15:14:43Z",
            "author_login": "scoder"
          },
          {
            "sha": "8bdbbd9c1c04a3b34eee819a4332870c59fe4ed8",
            "date": "2025-01-13T14:13:11Z",
            "author_login": "scoder"
          },
          {
            "sha": "7be20eb3931010b42dfa81427c45fa716f52954c",
            "date": "2024-11-05T09:59:08Z",
            "author_login": "scoder"
          },
          {
            "sha": "9bdf66b1e33b19ac2796d3f210bc861aebe476e3",
            "date": "2024-11-05T09:40:10Z",
            "author_login": "scoder"
          },
          {
            "sha": "224dc56d325d057db14ecf672ead3f1fed5e1b29",
            "date": "2024-11-05T09:16:03Z",
            "author_login": "scoder"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N",
    "cwe_id": "CWE-74",
    "description": "lxml is a library for processing XML and HTML in the Python language. Prior to version 4.6.5, the HTML Cleaner in lxml.html lets certain crafted script content pass through, as well as script content in SVG files embedded using data URIs. Users that employ the HTML cleaner in a security relevant context should upgrade to lxml 4.6.5 to receive a patch. There are no known workarounds available.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-13T18:15:08.387",
    "last_modified": "2024-11-21T06:29:51.497",
    "fix_date": "2021-11-11T11:20:57Z"
  },
  "references": [
    {
      "url": "https://github.com/lxml/lxml/commit/12fa9669007180a7bb87d990c375cf91ca5b664a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/f2330237440df7e8f39c3ad1b1aa8852be3b27c0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/security/advisories/GHSA-55x5-fj6c-h6m8",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/12/msg00037.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TUIS2KE3HZ2AAQKXFLTJFZPP2IFHJTC7/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/V2XMOM5PFT6U5AAXY6EFNT5JZCKKHK2V/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WZGNET2A4WGLSUXLBFYKNC5PXHQMI3I7/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZQ4SPKJX3RRJK4UWA6FXCRHD2TVRQI44/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-06",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220107-0005/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5043",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/12fa9669007180a7bb87d990c375cf91ca5b664a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/a3eacbc0dcf1de1c822ec29fb7d090a4b1712a9c#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/commit/f2330237440df7e8f39c3ad1b1aa8852be3b27c0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lxml/lxml/security/advisories/GHSA-55x5-fj6c-h6m8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2021/12/msg00037.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TUIS2KE3HZ2AAQKXFLTJFZPP2IFHJTC7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/V2XMOM5PFT6U5AAXY6EFNT5JZCKKHK2V/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/WZGNET2A4WGLSUXLBFYKNC5PXHQMI3I7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZQ4SPKJX3RRJK4UWA6FXCRHD2TVRQI44/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220107-0005/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5043",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.835284",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "lxml",
    "owner": "lxml",
    "created_at": "2011-02-11T05:43:11Z",
    "updated_at": "2025-01-25T00:43:53Z",
    "pushed_at": "2025-01-20T11:49:16Z",
    "size": 20414,
    "stars": 2753,
    "forks": 568,
    "open_issues": 21,
    "watchers": 2753,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 1261561,
      "Cython": 913329,
      "XSLT": 154294,
      "HTML": 15198,
      "C": 14544,
      "Shell": 6262,
      "Makefile": 5719
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:22:30.704320"
  }
}