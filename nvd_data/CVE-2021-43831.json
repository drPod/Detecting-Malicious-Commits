{
  "cve_id": "CVE-2021-43831",
  "github_data": {
    "repository": "gradio-app/gradio",
    "fix_commit": "41bd3645bdb616e1248b2167ca83636a2653f781",
    "related_commits": [
      "41bd3645bdb616e1248b2167ca83636a2653f781",
      "41bd3645bdb616e1248b2167ca83636a2653f781"
    ],
    "patch_url": "https://github.com/gradio-app/gradio/commit/41bd3645bdb616e1248b2167ca83636a2653f781.patch",
    "fix_commit_details": {
      "sha": "41bd3645bdb616e1248b2167ca83636a2653f781",
      "commit_date": "2021-12-14T21:01:55Z",
      "author": {
        "login": "ikaharudin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "secure path hotfix",
        "length": 18,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 2,
        "deletions": 3
      },
      "files": [
        {
          "filename": "gradio/networking.py",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -377,15 +377,14 @@ def interpret():\n @app.route(\"/file/<path:path>\", methods=[\"GET\"])\n @login_check\n def file(path):\n-    path = secure_filename(path)\n     if app.interface.encrypt and isinstance(app.interface.examples, str) and path.startswith(app.interface.examples):\n-        with open(os.path.join(app.cwd, path), \"rb\") as encrypted_file:\n+        with open(safe_join(app.cwd, path), \"rb\") as encrypted_file:\n             encrypted_data = encrypted_file.read()\n         file_data = encryptor.decrypt(\n             app.interface.encryption_key, encrypted_data)\n         return send_file(io.BytesIO(file_data), attachment_filename=os.path.basename(path))\n     else:\n-        return send_file(os.path.join(app.cwd, path))\n+        return send_file(safe_join(app.cwd, path))\n \n \n @app.route(\"/api/queue/push/\", methods=[\"POST\"])"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "43e05d72f43c9ac8dc18e4b885c9da08605b09e6",
            "date": "2025-01-14T18:43:37Z",
            "author_login": "abidlabs"
          },
          {
            "sha": "62cd4ef302cd7529d1f8842b416f9d8fcf6b5750",
            "date": "2025-01-14T15:52:06Z",
            "author_login": "hannahblair"
          },
          {
            "sha": "a91cb9c42c02b70273b4cd55ab18148a7436fe57",
            "date": "2025-01-13T19:14:27Z",
            "author_login": "amanchauhan11"
          },
          {
            "sha": "7fa9b6fc97b90a4c0d07cbf066b810247fc84724",
            "date": "2025-01-10T20:39:10Z",
            "author_login": "gradio-pr-bot"
          },
          {
            "sha": "e742dcccb376692c9ddd5a6c251080e7c5936574",
            "date": "2025-01-10T19:46:57Z",
            "author_login": "aliabid94"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Gradio is an open source framework for building interactive machine learning models and demos. In versions prior to 2.5.0 there is a vulnerability that affects anyone who creates and publicly shares Gradio interfaces. File paths are not restricted and users who receive a Gradio link can access any files on the host computer if they know the file names or file paths. This is limited only by the host operating system. Paths are opened in read only mode. The problem has been patched in gradio 2.5.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-15T20:15:08.620",
    "last_modified": "2024-11-21T06:29:53.240",
    "fix_date": "2021-12-14T21:01:55Z"
  },
  "references": [
    {
      "url": "https://github.com/gradio-app/gradio/commit/41bd3645bdb616e1248b2167ca83636a2653f781",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gradio-app/gradio/security/advisories/GHSA-rhq2-3vr9-6mcr",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gradio-app/gradio/commit/41bd3645bdb616e1248b2167ca83636a2653f781",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gradio-app/gradio/security/advisories/GHSA-rhq2-3vr9-6mcr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.844306",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gradio",
    "owner": "gradio-app",
    "created_at": "2018-12-19T08:24:04Z",
    "updated_at": "2025-01-14T14:42:12Z",
    "pushed_at": "2025-01-14T12:42:39Z",
    "size": 280474,
    "stars": 35207,
    "forks": 2655,
    "open_issues": 470,
    "watchers": 35207,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 3114195,
      "Svelte": 1181173,
      "TypeScript": 956766,
      "JavaScript": 60749,
      "CSS": 51082,
      "Jupyter Notebook": 32113,
      "HTML": 22988,
      "Batchfile": 6463,
      "Shell": 6049,
      "MDX": 1670
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:07:33.405924"
  }
}