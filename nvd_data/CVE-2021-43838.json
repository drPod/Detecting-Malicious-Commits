{
  "cve_id": "CVE-2021-43838",
  "github_data": {
    "repository": "yhatt/jsx-slack",
    "fix_commit": "36e4a10405e4c7745333e245fcc5029c02c7065d",
    "related_commits": [
      "36e4a10405e4c7745333e245fcc5029c02c7065d",
      "36e4a10405e4c7745333e245fcc5029c02c7065d"
    ],
    "patch_url": "https://github.com/yhatt/jsx-slack/commit/36e4a10405e4c7745333e245fcc5029c02c7065d.patch",
    "fix_commit_details": {
      "sha": "36e4a10405e4c7745333e245fcc5029c02c7065d",
      "commit_date": "2021-12-17T00:12:51Z",
      "author": {
        "login": "yhatt",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-55xv-f85c-248q",
        "length": 89,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 21,
        "deletions": 3
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -2,6 +2,10 @@\n \n ## [Unreleased]\n \n+### Fixed\n+\n+- Fix performance issues of tags in `<blockquote>`\n+\n ## v4.5.0 - 2021-12-02\n \n ### Added"
        },
        {
          "filename": "src/mrkdwn/escape.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -8,9 +8,8 @@ const generateReplacerForEscape = (fallback: string) => (matched: string) =>\n export const escapeReplacers = {\n   blockquote: (partial: string) =>\n     partial\n-      .replace(\n-        /^((?:<.*?>)*)(&gt;)/gm,\n-        (_, leading, character) => `${leading}\\u00ad${character}`\n+      .replace(/^((?:<.*?>)*)(.{4})/gm, (matched, leading, character) =>\n+        character === '&gt;' ? `${leading}\\u00ad&gt;` : matched\n       )\n       .replace(\n         /^((?:<.*?>)*)(\uff1e)/gm,"
        },
        {
          "filename": "test/mrkdwn.tsx",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -587,6 +587,21 @@ describe('HTML parser for mrkdwn', () => {\n       ).toBe('&gt; *A*\\n&gt; \\n&gt; *_B_*\\n&gt; \\n&gt; *C*\\n&gt; ')\n     })\n \n+    it('renders many tags in the blockquote tag immediately', () => {\n+      const startTime = Date.now()\n+\n+      mrkdwn(\n+        <blockquote>\n+          {[...Array(30)].map((_, i) => (\n+            <b>{i}</b>\n+          ))}\n+        </blockquote>\n+      )\n+\n+      const processTime = Date.now() - startTime\n+      expect(processTime).toBeLessThan(1000)\n+    })\n+\n     it('ignores invalid double markup', () =>\n       expect(\n         mrkdwn("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "06b271ceee70aad3f8a7257660201444c5c7f9d3",
            "date": "2024-12-14T16:11:01Z",
            "author_login": "yhatt"
          },
          {
            "sha": "4cc196349b3098f72166c0a887b554cf5ccdfa4e",
            "date": "2024-12-14T15:54:47Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "b7c58b381c7e3b105d450c9abd45ecab09556fff",
            "date": "2024-11-19T01:28:29Z",
            "author_login": "yhatt"
          },
          {
            "sha": "1d4388f606079cb130ec2fec67f4613fcee9f1eb",
            "date": "2024-11-18T22:42:10Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "53ad01cf9e2a52d63433c979b730fcf84350e1d7",
            "date": "2024-10-31T15:29:25Z",
            "author_login": "yhatt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-400",
    "description": "jsx-slack is a library for building JSON objects for Slack Block Kit surfaces from JSX. In versions prior to 4.5.1 users are vulnerable to a regular expression denial-of-service (ReDoS) attack. If attacker can put a lot of JSX elements into `<blockquote>` tag, an internal regular expression for escaping characters may consume an excessive amount of computing resources. jsx-slack v4.5.1 has patched to a regex for escaping blockquote characters. Users are advised to upgrade as soon as possible.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-17T19:15:07.683",
    "last_modified": "2024-11-21T06:29:54.097",
    "fix_date": "2021-12-17T00:12:51Z"
  },
  "references": [
    {
      "url": "https://github.com/yhatt/jsx-slack/commit/36e4a10405e4c7745333e245fcc5029c02c7065d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/security/advisories/GHSA-55xv-f85c-248q",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/commit/36e4a10405e4c7745333e245fcc5029c02c7065d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/security/advisories/GHSA-55xv-f85c-248q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.850695",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jsx-slack",
    "owner": "yhatt",
    "created_at": "2019-02-14T13:55:08Z",
    "updated_at": "2024-12-14T16:11:06Z",
    "pushed_at": "2024-12-14T16:11:02Z",
    "size": 6086,
    "stars": 468,
    "forks": 17,
    "open_issues": 8,
    "watchers": 468,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 378341,
      "JavaScript": 17487
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T22:55:58.612827"
  }
}