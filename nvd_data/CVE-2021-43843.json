{
  "cve_id": "CVE-2021-43843",
  "github_data": {
    "repository": "yhatt/jsx-slack",
    "fix_commit": "46bc88391d89d5fda4ce689e18ca080bcdd29ecc",
    "related_commits": [
      "46bc88391d89d5fda4ce689e18ca080bcdd29ecc",
      "46bc88391d89d5fda4ce689e18ca080bcdd29ecc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "46bc88391d89d5fda4ce689e18ca080bcdd29ecc",
      "commit_date": "2021-12-18T07:03:24Z",
      "author": {
        "login": "yhatt",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Prevent catastrophic backtracking in blockquote escape replacer",
        "length": 63,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
      },
      "files": [
        {
          "filename": "src/mrkdwn/escape.ts",
          "status": "modified",
          "additions": 7,
          "deletions": 6,
          "patch": "@@ -1,20 +1,21 @@\n // An internal HTML tag and emoji shorthand should not escape\n const preventEscapeRegex =\n-  /(<.*?>|:[-a-z0-9\u00c0\u00c1\u00c2\u00c3\u00c4\u00c7\u00c8\u00c9\u00ca\u00cb\u00cd\u00ce\u00cf\u00d1\u00d3\u00d4\u00d5\u00d6\u0152\u0153\u00d9\u00da\u00db\u00dc\u0178\u00df\u00e0\u00e1\u00e2\u00e3\u00e4\u00e7\u00e8\u00e9\u00ea\u00eb\u00ed\u00ee\u00ef\u00f1\u00f3\u00f4\u00f5\u00f6\u00f9\u00fa\u00fb\u00fc\u00ff_\uff3f+\uff0b'\\u1100-\\u11ff\\u2e80-\\u2fd5\\u3005\\u3041-\\u3096\\u30a0-\\u30ff\\u3130-\\u318f\\u3400-\\u4db5\\u4e00-\\u9fcb\\ua960-\\ua97f\\uac00-\\ud7ff\\uff10-\\uff19\\uff41-\\uff5a\\uff61-\\uff9f]+:)/\n+  /(<[^>]*>|:[-a-z0-9\u00c0\u00c1\u00c2\u00c3\u00c4\u00c7\u00c8\u00c9\u00ca\u00cb\u00cd\u00ce\u00cf\u00d1\u00d3\u00d4\u00d5\u00d6\u0152\u0153\u00d9\u00da\u00db\u00dc\u0178\u00df\u00e0\u00e1\u00e2\u00e3\u00e4\u00e7\u00e8\u00e9\u00ea\u00eb\u00ed\u00ee\u00ef\u00f1\u00f3\u00f4\u00f5\u00f6\u00f9\u00fa\u00fb\u00fc\u00ff_\uff3f+\uff0b'\\u1100-\\u11ff\\u2e80-\\u2fd5\\u3005\\u3041-\\u3096\\u30a0-\\u30ff\\u3130-\\u318f\\u3400-\\u4db5\\u4e00-\\u9fcb\\ua960-\\ua97f\\uac00-\\ud7ff\\uff10-\\uff19\\uff41-\\uff5a\\uff61-\\uff9f]+:)/\n \n const generateReplacerForEscape = (fallback: string) => (matched: string) =>\n   `<span data-escape=\"${fallback.repeat(matched.length)}\">${matched}</span>`\n \n export const escapeReplacers = {\n   blockquote: (partial: string) =>\n     partial\n-      .replace(/^((?:<.*?>)*)(.{4})/gm, (matched, leading, character) =>\n-        character === '&gt;' ? `${leading}\\u00ad&gt;` : matched\n+      .replace(\n+        /^((?:<(?:[^>]|>(?=<))*>)?)(&gt;)/gm,\n+        (_, leadingTags, character) => `${leadingTags}\\u00ad${character}`\n       )\n       .replace(\n-        /^((?:<.*?>)*)(\uff1e)/gm,\n-        (_, leading, character) =>\n-          `${leading}${generateReplacerForEscape('\\u00ad\uff1e')(character)}`\n+        /^((?:<(?:[^>]|>(?=<))*>)?)(\uff1e)/gm,\n+        (_, leadingTags, character) =>\n+          `${leadingTags}${generateReplacerForEscape('\\u00ad\uff1e')(character)}`\n       ),\n   bold: (partial: string) =>\n     partial"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "06b271ceee70aad3f8a7257660201444c5c7f9d3",
            "date": "2024-12-14T16:11:01Z",
            "author_login": "yhatt"
          },
          {
            "sha": "4cc196349b3098f72166c0a887b554cf5ccdfa4e",
            "date": "2024-12-14T15:54:47Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "b7c58b381c7e3b105d450c9abd45ecab09556fff",
            "date": "2024-11-19T01:28:29Z",
            "author_login": "yhatt"
          },
          {
            "sha": "1d4388f606079cb130ec2fec67f4613fcee9f1eb",
            "date": "2024-11-18T22:42:10Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "53ad01cf9e2a52d63433c979b730fcf84350e1d7",
            "date": "2024-10-31T15:29:25Z",
            "author_login": "yhatt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-400",
    "description": "jsx-slack is a package for building JSON objects for Slack block kit surfaces from JSX. The maintainers found the patch for CVE-2021-43838 in jsx-slack v4.5.1 is insufficient tfor protection from a Regular Expression Denial of Service (ReDoS) attack. If an attacker can put a lot of JSX elements into `<blockquote>` tag _with including multibyte characters_, an internal regular expression for escaping characters may consume an excessive amount of computing resources. v4.5.1 passes the test against ASCII characters but misses the case of multibyte characters. jsx-slack v4.5.2 has updated regular expressions for escaping blockquote characters to prevent catastrophic backtracking. It is also including an updated test case to confirm rendering multiple tags in `<blockquote>` with multibyte characters.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-12-20T22:15:07.817",
    "last_modified": "2024-11-21T06:29:54.773",
    "fix_date": "2021-12-18T07:03:24Z"
  },
  "references": [
    {
      "url": "https://github.com/yhatt/jsx-slack/commit/46bc88391d89d5fda4ce689e18ca080bcdd29ecc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/releases/tag/v4.5.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/security/advisories/GHSA-55xv-f85c-248q",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/security/advisories/GHSA-hp68-xhvj-x6j6",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/commit/46bc88391d89d5fda4ce689e18ca080bcdd29ecc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/releases/tag/v4.5.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/security/advisories/GHSA-55xv-f85c-248q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yhatt/jsx-slack/security/advisories/GHSA-hp68-xhvj-x6j6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.010696",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "jsx-slack",
    "owner": "yhatt",
    "created_at": "2019-02-14T13:55:08Z",
    "updated_at": "2024-12-14T16:11:06Z",
    "pushed_at": "2024-12-14T16:11:02Z",
    "size": 6086,
    "stars": 468,
    "forks": 17,
    "open_issues": 8,
    "watchers": 468,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 378341,
      "JavaScript": 17487
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:48:34.886774"
  }
}