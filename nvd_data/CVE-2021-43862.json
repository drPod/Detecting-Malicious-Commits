{
  "cve_id": "CVE-2021-43862",
  "github_data": {
    "repository": "jcubic/jquery.terminal",
    "fix_commit": "77eb044d0896e990d48a9157f0bc6648f81a84b5",
    "related_commits": [
      "77eb044d0896e990d48a9157f0bc6648f81a84b5",
      "77eb044d0896e990d48a9157f0bc6648f81a84b5"
    ],
    "patch_url": "https://github.com/jcubic/jquery.terminal/commit/77eb044d0896e990d48a9157f0bc6648f81a84b5.patch",
    "fix_commit_details": {
      "sha": "77eb044d0896e990d48a9157f0bc6648f81a84b5",
      "commit_date": "2021-12-30T10:53:52Z",
      "author": {
        "login": "jcubic",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix Self XSS by injecting data attrbutte #727",
        "length": 45,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 28,
        "deletions": 18
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -1,3 +1,7 @@\n+## 2.31.1\n+### Bugfix\n+* fixing low severity self XSS with potential more security implications [#727](https://github.com/jcubic/jquery.terminal/issues/727)\n+\n ## 2.31.0\n ### Breaking\n * remove undocumented `echo_command` (that was used by old `echo_newline` extension)"
        },
        {
          "filename": "js/jquery.terminal-2.31.0.js",
          "status": "modified",
          "additions": 7,
          "deletions": 5,
          "patch": "@@ -41,7 +41,7 @@\n  *\n  * broken image by Sophia Bai from the Noun Project (CC-BY)\n  *\n- * Date: Mon, 27 Dec 2021 10:26:13 +0000\n+ * Date: Thu, 30 Dec 2021 10:53:02 +0000\n  */\n /* global define, Map */\n /* eslint-disable */\n@@ -5130,7 +5130,7 @@\n     // -------------------------------------------------------------------------\n     $.terminal = {\n         version: '2.31.0',\n-        date: 'Mon, 27 Dec 2021 10:26:13 +0000',\n+        date: 'Thu, 30 Dec 2021 10:53:02 +0000',\n         // colors from https://www.w3.org/wiki/CSS/Properties/color/keywords\n         color_names: [\n             'transparent', 'currentcolor', 'black', 'silver', 'gray', 'white',\n@@ -6180,7 +6180,9 @@\n                     return text;\n                 } else {\n                     return data.replace(/&#93;/g, ']')\n-                        .replace(/>/g, '&gt;').replace(/</g, '&lt;');\n+                        .replace(/>/g, '&gt;')\n+                        .replace(/</g, '&lt;')\n+                        .replace(/\"/g, '&quot;');\n                 }\n             }\n             // -----------------------------------------------------------------\n@@ -6365,7 +6367,7 @@\n                 } else if (style.indexOf('@') !== -1) {\n                     result += ' data-text/>';\n                 } else {\n-                    result += ' data-text=\"' + data.replace(/\"/g, '&quot;') + '\">' +\n+                    result += ' data-text=\"' + data + '\">' +\n                         '<span>' + text + '</span></span>';\n                 }\n                 return result;\n@@ -6386,7 +6388,7 @@\n                     } else {\n                         text = safe(text);\n                         text = text.replace(/\\\\\\]/, '&#93;');\n-                        var data = text;\n+                        var data = clean_data(text);\n                         var extra = extra_css(text, settings);\n                         var prefix;\n                         if (extra.length) {"
        },
        {
          "filename": "js/jquery.terminal-2.31.0.min.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": null
        },
        {
          "filename": "js/jquery.terminal-src.js",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -6180,7 +6180,9 @@\n                     return text;\n                 } else {\n                     return data.replace(/&#93;/g, ']')\n-                        .replace(/>/g, '&gt;').replace(/</g, '&lt;');\n+                        .replace(/>/g, '&gt;')\n+                        .replace(/</g, '&lt;')\n+                        .replace(/\"/g, '&quot;');\n                 }\n             }\n             // -----------------------------------------------------------------\n@@ -6365,7 +6367,7 @@\n                 } else if (style.indexOf('@') !== -1) {\n                     result += ' data-text/>';\n                 } else {\n-                    result += ' data-text=\"' + data.replace(/\"/g, '&quot;') + '\">' +\n+                    result += ' data-text=\"' + data + '\">' +\n                         '<span>' + text + '</span></span>';\n                 }\n                 return result;\n@@ -6386,7 +6388,7 @@\n                     } else {\n                         text = safe(text);\n                         text = text.replace(/\\\\\\]/, '&#93;');\n-                        var data = text;\n+                        var data = clean_data(text);\n                         var extra = extra_css(text, settings);\n                         var prefix;\n                         if (extra.length) {"
        },
        {
          "filename": "js/jquery.terminal.js",
          "status": "modified",
          "additions": 7,
          "deletions": 5,
          "patch": "@@ -41,7 +41,7 @@\n  *\n  * broken image by Sophia Bai from the Noun Project (CC-BY)\n  *\n- * Date: Mon, 27 Dec 2021 10:26:13 +0000\n+ * Date: Thu, 30 Dec 2021 10:53:02 +0000\n  */\n /* global define, Map */\n /* eslint-disable */\n@@ -5130,7 +5130,7 @@\n     // -------------------------------------------------------------------------\n     $.terminal = {\n         version: '2.31.0',\n-        date: 'Mon, 27 Dec 2021 10:26:13 +0000',\n+        date: 'Thu, 30 Dec 2021 10:53:02 +0000',\n         // colors from https://www.w3.org/wiki/CSS/Properties/color/keywords\n         color_names: [\n             'transparent', 'currentcolor', 'black', 'silver', 'gray', 'white',\n@@ -6180,7 +6180,9 @@\n                     return text;\n                 } else {\n                     return data.replace(/&#93;/g, ']')\n-                        .replace(/>/g, '&gt;').replace(/</g, '&lt;');\n+                        .replace(/>/g, '&gt;')\n+                        .replace(/</g, '&lt;')\n+                        .replace(/\"/g, '&quot;');\n                 }\n             }\n             // -----------------------------------------------------------------\n@@ -6365,7 +6367,7 @@\n                 } else if (style.indexOf('@') !== -1) {\n                     result += ' data-text/>';\n                 } else {\n-                    result += ' data-text=\"' + data.replace(/\"/g, '&quot;') + '\">' +\n+                    result += ' data-text=\"' + data + '\">' +\n                         '<span>' + text + '</span></span>';\n                 }\n                 return result;\n@@ -6386,7 +6388,7 @@\n                     } else {\n                         text = safe(text);\n                         text = text.replace(/\\\\\\]/, '&#93;');\n-                        var data = text;\n+                        var data = clean_data(text);\n                         var extra = extra_css(text, settings);\n                         var prefix;\n                         if (extra.length) {"
        },
        {
          "filename": "js/jquery.terminal.min.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": null
        },
        {
          "filename": "js/jquery.terminal.min.js.map",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "468a247c9907864c435354532e844a4f86e4a006",
            "date": "2024-12-28T19:42:35Z",
            "author_login": "jcubic"
          },
          {
            "sha": "54e6e8cde28c83a844a0fa5bc7fdde3b8e66abd6",
            "date": "2024-12-12T15:04:43Z",
            "author_login": "jcubic"
          },
          {
            "sha": "6ed1e52d4d569f609caf8e84868b124187de7fc4",
            "date": "2024-12-11T23:16:18Z",
            "author_login": "jcubic"
          },
          {
            "sha": "a0d628d73136fe655b738ce213db05f3c39f69bc",
            "date": "2024-12-11T02:29:26Z",
            "author_login": "jcubic"
          },
          {
            "sha": "10cb9d8f1ecfae86d2cf4828680110c6df66ac84",
            "date": "2024-12-11T01:28:12Z",
            "author_login": "jcubic"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-80",
    "description": "jQuery Terminal Emulator is a plugin for creating command line interpreters in your applications. Versions prior to 2.31.1 contain a low impact and limited cross-site scripting (XSS) vulnerability. The code for XSS payload is always visible, but an attacker can use other techniques to hide the code the victim sees. If the application uses the `execHash` option and executes code from URL, the attacker can use this URL to execute their code. The scope is limited because the javascript attribute used is added to span tag, so no automatic execution like with `onerror` on images is possible. This issue is fixed in version 2.31.1. As a workaround, the user can use formatting that wrap whole user input and its no op. The code for this workaround is available in the GitHub Security Advisory. The fix will only work when user of the library is not using different formatters (e.g. to highlight code in different way).",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-12-30T15:15:07.470",
    "last_modified": "2024-11-21T06:29:58.023",
    "fix_date": "2021-12-30T10:53:52Z"
  },
  "references": [
    {
      "url": "https://github.com/jcubic/jquery.terminal/commit/77eb044d0896e990d48a9157f0bc6648f81a84b5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/issues/727",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/releases/tag/2.31.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/security/advisories/GHSA-x9r5-jxvq-4387",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/commit/77eb044d0896e990d48a9157f0bc6648f81a84b5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/issues/727",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/releases/tag/2.31.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jcubic/jquery.terminal/security/advisories/GHSA-x9r5-jxvq-4387",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.036109",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jquery.terminal",
    "owner": "jcubic",
    "created_at": "2011-02-24T12:58:32Z",
    "updated_at": "2025-01-14T21:37:07Z",
    "pushed_at": "2025-01-14T21:38:45Z",
    "size": 34333,
    "stars": 3139,
    "forks": 573,
    "open_issues": 98,
    "watchers": 3139,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 2226966,
      "CSS": 106531,
      "TypeScript": 44659,
      "Makefile": 11853,
      "Shell": 1543,
      "HTML": 811
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T22:35:05.569109"
  }
}