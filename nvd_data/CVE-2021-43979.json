{
  "cve_id": "CVE-2021-43979",
  "github_data": {
    "repository": "open-policy-agent/gatekeeper",
    "fix_commit": null,
    "related_commits": [],
    "patch_url": null
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-670",
    "description": "Styra Open Policy Agent (OPA) Gatekeeper through 3.7.0 mishandles concurrency, sometimes resulting in incorrect access control. The data replication mechanism allows policies to access the Kubernetes cluster state. During data replication, OPA/Gatekeeper does not wait for the replication to finish before processing a request, which might cause inconsistencies between the replicated resources in OPA/Gatekeeper and the resources actually present in the cluster. Inconsistency can later be reflected in a policy bypass. NOTE: the vendor disagrees that this is a vulnerability, because Kubernetes states are only eventually consistent",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2021-11-17T19:15:09.220",
    "last_modified": "2024-11-21T06:30:08.037",
    "fix_date": null
  },
  "references": [
    {
      "url": "https://github.com/hkerma/opa-gatekeeper-concurrency-issue",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/open-policy-agent/gatekeeper/releases",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hkerma/opa-gatekeeper-concurrency-issue",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/open-policy-agent/gatekeeper/releases",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:34.793425",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "gatekeeper",
    "owner": "open-policy-agent",
    "created_at": "2018-10-26T21:05:57Z",
    "updated_at": "2025-01-25T19:30:30Z",
    "pushed_at": "2025-01-24T20:57:12Z",
    "size": 168110,
    "stars": 3775,
    "forks": 769,
    "open_issues": 152,
    "watchers": 3775,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release-3.1",
      "release-3.2",
      "release-3.3",
      "release-3.4",
      "release-3.5",
      "release-3.6",
      "release-3.7",
      "release-3.8",
      "release-3.9",
      "release-3.10",
      "release-3.11",
      "release-3.12",
      "release-3.13",
      "release-3.14",
      "release-3.15",
      "release-3.16",
      "release-3.17",
      "release-3.18"
    ],
    "languages": {
      "Go": 2075259,
      "Shell": 55898,
      "Makefile": 23137,
      "JavaScript": 11854,
      "Smarty": 11730,
      "Open Policy Agent": 9016,
      "Dockerfile": 5329,
      "CSS": 4796,
      "Python": 3915
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:01:47.049489"
  }
}