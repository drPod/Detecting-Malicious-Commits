{
  "cve_id": "CVE-2021-44273",
  "github_data": {
    "repository": "e2guardian/e2guardian",
    "fix_commit": "eae46a7e2a57103aadca903c4a24cca94dc502a2",
    "related_commits": [
      "eae46a7e2a57103aadca903c4a24cca94dc502a2",
      "eae46a7e2a57103aadca903c4a24cca94dc502a2"
    ],
    "patch_url": "https://github.com/e2guardian/e2guardian/commit/eae46a7e2a57103aadca903c4a24cca94dc502a2.patch",
    "fix_commit_details": {
      "sha": "eae46a7e2a57103aadca903c4a24cca94dc502a2",
      "commit_date": "2021-11-23T09:52:38Z",
      "author": {
        "login": "philipianpearce",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix bug #707 cert hostnames not being checked",
        "length": 87,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/Socket.cpp",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -377,6 +377,10 @@ int Socket::startSslClient(const std::string &certificate_path, String hostname)\n     //fcntl(this->getFD() ,F_SETFL, O_NONBLOCK); // blocking mode used currently\n     SSL_set_fd(ssl, this->getFD());\n     SSL_set_tlsext_host_name(ssl, hostname.c_str());\n+#if OPENSSL_VERSION_NUMBER < 0x10100000L\n+#else\n+  X509_VERIFY_PARAM_set1_host(SSL_get0_param(ssl),hostname.c_str(),0);\n+#endif\n \n     //make io non blocking as select wont tell us if we can do a read without blocking\n     //BIO_set_nbio(SSL_get_rbio(ssl),1l);  // blocking mode used currently"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2c45ea4eb062bf77432401ec0ac8bf2a05a5e529",
            "date": "2024-12-16T23:01:17Z",
            "author_login": "philipianpearce"
          },
          {
            "sha": "66a2db3cef06d331c4ef53c7e98690b77e9db51d",
            "date": "2024-12-12T22:51:34Z",
            "author_login": "philipianpearce"
          },
          {
            "sha": "851f9272ca5b11e52e6ca13270d50d4542e69828",
            "date": "2024-12-12T22:44:28Z",
            "author_login": "philipianpearce"
          },
          {
            "sha": "736b8735396b136324e1a70eff522b1f58dd2297",
            "date": "2024-12-12T22:44:28Z",
            "author_login": "philipianpearce"
          },
          {
            "sha": "e5c37013614d77271a8be9a3d36c228888cdfee9",
            "date": "2024-12-12T22:21:15Z",
            "author_login": "philipianpearce"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-295",
    "description": "e2guardian v5.4.x <= v5.4.3r is affected by missing SSL certificate validation in the SSL MITM engine. In standalone mode (i.e., acting as a proxy or a transparent proxy), with SSL MITM enabled, e2guardian, if built with OpenSSL v1.1.x, did not validate hostnames in certificates of the web servers that it connected to, and thus was itself vulnerable to MITM attacks.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2021-12-23T12:15:07.387",
    "last_modified": "2024-11-21T06:30:41.833",
    "fix_date": "2021-11-23T09:52:38Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2021/12/23/2",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e2guardian/e2guardian/commit/eae46a7e2a57103aadca903c4a24cca94dc502a2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e2guardian/e2guardian/issues/707",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/09/msg00010.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2021/12/23/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e2guardian/e2guardian/commit/eae46a7e2a57103aadca903c4a24cca94dc502a2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/e2guardian/e2guardian/issues/707",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/09/msg00010.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.023888",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "e2guardian",
    "owner": "e2guardian",
    "created_at": "2013-08-21T15:50:39Z",
    "updated_at": "2025-01-06T20:10:01Z",
    "pushed_at": "2024-12-16T23:42:37Z",
    "size": 11292,
    "stars": 486,
    "forks": 138,
    "open_issues": 64,
    "watchers": 486,
    "has_security_policy": false,
    "default_branch": "v5.5",
    "protected_branches": [],
    "languages": {
      "HTML": 1762582,
      "C++": 1195202,
      "M4": 33071,
      "Makefile": 17415,
      "Gherkin": 14953,
      "Logos": 9050,
      "Shell": 6690,
      "Roff": 6446,
      "CMake": 3053,
      "Perl": 2601,
      "Dockerfile": 2142
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:34:41.728121"
  }
}