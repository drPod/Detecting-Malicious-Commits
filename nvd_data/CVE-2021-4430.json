{
  "cve_id": "CVE-2021-4430",
  "github_data": {
    "repository": "Ortus-Solutions/coldbox-elixir",
    "fix_commit": "a3aa62daea2e44c76d08d1eac63768cd928cd69e",
    "related_commits": [
      "a3aa62daea2e44c76d08d1eac63768cd928cd69e",
      "a3aa62daea2e44c76d08d1eac63768cd928cd69e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a3aa62daea2e44c76d08d1eac63768cd928cd69e",
      "commit_date": "2021-01-12T20:14:11Z",
      "author": {
        "login": "elpete",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix security vulnerability that echoed out all ENV vars.",
        "length": 557,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 10,
        "deletions": 11
      },
      "files": [
        {
          "filename": "src/config/index.js",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -2,12 +2,10 @@ const ElixirConfig = require(\"./config\");\n \n ElixirConfig.addIngredient(\"js\", require(\"./ingredients/js\"));\n ElixirConfig.addIngredient(\"vue\", require(\"./ingredients/vue\"));\n-\n ElixirConfig.addIngredient(\"css\", require(\"./ingredients/css\"));\n ElixirConfig.addIngredient(\"sass\", require(\"./ingredients/sass\"));\n-\n ElixirConfig.addIngredient(\"copy\", require(\"./ingredients/copy\"));\n-\n ElixirConfig.addIngredient(\"browserSync\", require(\"./ingredients/browserSync\"));\n+ElixirConfig.addIngredient(\"env\", require(\"./ingredients/env\"));\n \n module.exports = ElixirConfig;"
        },
        {
          "filename": "src/config/ingredients/env.js",
          "status": "added",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -0,0 +1,9 @@\n+const { EnvironmentPlugin } = require(\"webpack\");\n+\n+module.exports = function(keys) {\n+    return this.mergeConfig({\n+        plugins: [\n+            new EnvironmentPlugin(keys)\n+        ]\n+    });\n+};"
        },
        {
          "filename": "src/defaultConfig.js",
          "status": "modified",
          "additions": 0,
          "deletions": 8,
          "patch": "@@ -7,7 +7,6 @@ const ManifestPlugin = require(\"webpack-manifest-plugin\");\n const TerserPlugin = require(\"terser-webpack-plugin\");\n const styleLoaders = require(\"./utils/styleLoaders\");\n const webpackMerge = require(\"webpack-merge\");\n-const webpack = require(\"webpack\");\n const path = require(\"path\");\n const fs = require(\"fs\");\n \n@@ -115,13 +114,6 @@ module.exports = () => ({\n                 ? \"[name].[contenthash].css\"\n                 : \"[name].css\"\n         }),\n-        new webpack.DefinePlugin({\n-            // stringify each value so webpack doesn't insert variables instead of strings\n-            \"process.env\": Object.keys(process.env).reduce((obj, key) => {\n-                obj[key] = JSON.stringify(process.env[key]);\n-                return obj;\n-            }, {})\n-        })\n     ],\n     stats: {\n         children: false"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 3,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f88f6653972aa670fc65f9b6796d711503053b84",
            "date": "2023-09-13T09:53:48Z",
            "author_login": "lmajano"
          },
          {
            "sha": "f52bd8fdb351a60ec530dcf8e1fa1a4732f8547a",
            "date": "2023-04-04T14:35:00Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3c33d33c18e91f26c7a67df7e706962b03afb2c8",
            "date": "2023-04-04T14:34:03Z",
            "author_login": "elpete"
          },
          {
            "sha": "cd459e2f69d55ef4c93abe52d12b190fa3f26526",
            "date": "2023-04-04T14:33:48Z",
            "author_login": "elpete"
          },
          {
            "sha": "47e1496a2960f394ed5bdd428142eaf38feb7415",
            "date": "2023-02-22T22:33:52Z",
            "author_login": "jclausen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "A vulnerability classified as problematic has been found in Ortus Solutions ColdBox Elixir 3.1.6. This affects an unknown part of the file src/defaultConfig.js of the component ENV Variable Handler. The manipulation leads to information disclosure. Upgrading to version 3.1.7 is able to address this issue. The identifier of the patch is a3aa62daea2e44c76d08d1eac63768cd928cd69e. It is recommended to upgrade the affected component. The identifier VDB-244485 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-06T08:15:21.343",
    "last_modified": "2024-11-21T06:37:42.570",
    "fix_date": "2021-01-12T20:14:11Z"
  },
  "references": [
    {
      "url": "https://github.com/Ortus-Solutions/coldbox-elixir/commit/a3aa62daea2e44c76d08d1eac63768cd928cd69e",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Ortus-Solutions/coldbox-elixir/releases/tag/v3.1.7",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.244485",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.244485",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/Ortus-Solutions/coldbox-elixir/commit/a3aa62daea2e44c76d08d1eac63768cd928cd69e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Ortus-Solutions/coldbox-elixir/releases/tag/v3.1.7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.244485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.244485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.989020",
    "processing_status": "enhanced"
  }
}