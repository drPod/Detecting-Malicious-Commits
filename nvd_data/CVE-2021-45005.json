{
  "cve_id": "CVE-2021-45005",
  "github_data": {
    "repository": "ccxvii/mujs",
    "fix_commit": "df8559e7bdbc6065276e786217eeee70f28fce66",
    "related_commits": [
      "df8559e7bdbc6065276e786217eeee70f28fce66",
      "df8559e7bdbc6065276e786217eeee70f28fce66"
    ],
    "patch_url": "https://github.com/ccxvii/mujs/commit/df8559e7bdbc6065276e786217eeee70f28fce66.patch",
    "fix_commit_details": {
      "sha": "df8559e7bdbc6065276e786217eeee70f28fce66",
      "commit_date": "2021-12-06T10:47:31Z",
      "author": {
        "login": "ccxvii",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bug 704749: Clear jump list after patching jump addresses.",
        "length": 182,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 20,
        "additions": 12,
        "deletions": 8
      },
      "files": [
        {
          "filename": "jscompile.c",
          "status": "modified",
          "additions": 12,
          "deletions": 8,
          "patch": "@@ -794,15 +794,19 @@ static void addjump(JF, enum js_AstType type, js_Ast *target, int inst)\n \ttarget->jumps = jump;\n }\n \n-static void labeljumps(JF, js_JumpList *jump, int baddr, int caddr)\n+static void labeljumps(JF, js_Ast *stm, int baddr, int caddr)\n {\n+\tjs_JumpList *jump = stm->jumps;\n \twhile (jump) {\n+\t\tjs_JumpList *next = jump->next;\n \t\tif (jump->type == STM_BREAK)\n \t\t\tlabelto(J, F, jump->inst, baddr);\n \t\tif (jump->type == STM_CONTINUE)\n \t\t\tlabelto(J, F, jump->inst, caddr);\n-\t\tjump = jump->next;\n+\t\tjs_free(J, jump);\n+\t\tjump = next;\n \t}\n+\tstm->jumps = NULL;\n }\n \n static int isloop(enum js_AstType T)\n@@ -1121,7 +1125,7 @@ static void cstm(JF, js_Ast *stm)\n \t\tcexp(J, F, stm->b);\n \t\temitline(J, F, stm);\n \t\temitjumpto(J, F, OP_JTRUE, loop);\n-\t\tlabeljumps(J, F, stm->jumps, here(J,F), cont);\n+\t\tlabeljumps(J, F, stm, here(J,F), cont);\n \t\tbreak;\n \n \tcase STM_WHILE:\n@@ -1133,7 +1137,7 @@ static void cstm(JF, js_Ast *stm)\n \t\temitline(J, F, stm);\n \t\temitjumpto(J, F, OP_JUMP, loop);\n \t\tlabel(J, F, end);\n-\t\tlabeljumps(J, F, stm->jumps, here(J,F), loop);\n+\t\tlabeljumps(J, F, stm, here(J,F), loop);\n \t\tbreak;\n \n \tcase STM_FOR:\n@@ -1164,7 +1168,7 @@ static void cstm(JF, js_Ast *stm)\n \t\temitjumpto(J, F, OP_JUMP, loop);\n \t\tif (end)\n \t\t\tlabel(J, F, end);\n-\t\tlabeljumps(J, F, stm->jumps, here(J,F), cont);\n+\t\tlabeljumps(J, F, stm, here(J,F), cont);\n \t\tbreak;\n \n \tcase STM_FOR_IN:\n@@ -1189,12 +1193,12 @@ static void cstm(JF, js_Ast *stm)\n \t\t\temitjumpto(J, F, OP_JUMP, loop);\n \t\t}\n \t\tlabel(J, F, end);\n-\t\tlabeljumps(J, F, stm->jumps, here(J,F), loop);\n+\t\tlabeljumps(J, F, stm, here(J,F), loop);\n \t\tbreak;\n \n \tcase STM_SWITCH:\n \t\tcswitch(J, F, stm->a, stm->b);\n-\t\tlabeljumps(J, F, stm->jumps, here(J,F), 0);\n+\t\tlabeljumps(J, F, stm, here(J,F), 0);\n \t\tbreak;\n \n \tcase STM_LABEL:\n@@ -1204,7 +1208,7 @@ static void cstm(JF, js_Ast *stm)\n \t\t\tstm = stm->b;\n \t\t/* loops and switches have already been labelled */\n \t\tif (!isloop(stm->type) && stm->type != STM_SWITCH)\n-\t\t\tlabeljumps(J, F, stm->jumps, here(J,F), 0);\n+\t\t\tlabeljumps(J, F, stm, here(J,F), 0);\n \t\tbreak;\n \n \tcase STM_BREAK:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "91abee564144def1dd802350c9dcc98f6331dcc4",
            "date": "2025-01-03T12:25:06Z",
            "author_login": "ccxvii"
          },
          {
            "sha": "02147f5a9f52bd6016c735ccaf1179eee08e2192",
            "date": "2024-11-21T17:41:32Z",
            "author_login": "ccxvii"
          },
          {
            "sha": "0df0707f2f10187127e36acfbc3ba9b9ca5b5cf0",
            "date": "2024-06-20T11:01:31Z",
            "author_login": "ccxvii"
          },
          {
            "sha": "40556b31c6920491474a4e24784ed3b1c1c832de",
            "date": "2024-01-26T13:18:08Z",
            "author_login": "ccxvii"
          },
          {
            "sha": "d2697fd6435d0ffaae5c424e00ccf3a4b5a21f56",
            "date": "2024-01-23T13:33:04Z",
            "author_login": "ccxvii"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "Artifex MuJS v1.1.3 was discovered to contain a heap buffer overflow which is caused by conflicting JumpList of nested try/finally statements.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-14T22:15:07.670",
    "last_modified": "2024-11-21T06:31:47.800",
    "fix_date": "2021-12-06T10:47:31Z"
  },
  "references": [
    {
      "url": "https://bugs.ghostscript.com/show_bug.cgi?id=704749",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/ccxvii/mujs/commit/df8559e7bdbc6065276e786217eeee70f28fce66",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.ghostscript.com/show_bug.cgi?id=704749",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/ccxvii/mujs/commit/df8559e7bdbc6065276e786217eeee70f28fce66",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.710259",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mujs",
    "owner": "ccxvii",
    "created_at": "2013-12-23T18:35:20Z",
    "updated_at": "2025-01-14T10:42:18Z",
    "pushed_at": "2025-01-03T12:47:07Z",
    "size": 986,
    "stars": 823,
    "forks": 100,
    "open_issues": 21,
    "watchers": 823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 418291,
      "Makefile": 4538,
      "JavaScript": 4302,
      "Shell": 3342,
      "Python": 1620
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "isc"
    },
    "collected_at": "2025-01-14T12:57:27.966991"
  }
}