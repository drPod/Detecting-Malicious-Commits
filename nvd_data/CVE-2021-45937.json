{
  "cve_id": "CVE-2021-45937",
  "github_data": {
    "repository": "wolfSSL/wolfMQTT",
    "fix_commit": "84d4b53122e0fa0280c7872350b89d5777dabbb2",
    "related_commits": [
      "84d4b53122e0fa0280c7872350b89d5777dabbb2",
      "84d4b53122e0fa0280c7872350b89d5777dabbb2"
    ],
    "patch_url": "https://github.com/wolfSSL/wolfMQTT/commit/84d4b53122e0fa0280c7872350b89d5777dabbb2.patch",
    "fix_commit_details": {
      "sha": "84d4b53122e0fa0280c7872350b89d5777dabbb2",
      "commit_date": "2021-09-21T16:46:46Z",
      "author": {
        "login": "embhorn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix wolfmqtt-fuzzer: Null-dereference WRITE in MqttProps_Free",
        "length": 61,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/mqtt_client.c",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -906,8 +906,9 @@ static int MqttClient_WaitType(MqttClient *client, void *packet_obj,\n             /* Determine if we received data for this request */\n             if ((wait_type == MQTT_PACKET_TYPE_ANY ||\n                  wait_type == packet_type ||\n-                 MqttIsPubRespPacket(packet_type) == MqttIsPubRespPacket(wait_type)) &&\n-               (wait_packet_id == 0 || wait_packet_id == packet_id))\n+                 (MqttIsPubRespPacket(packet_type) &&\n+                  MqttIsPubRespPacket(wait_type))) &&\n+                (wait_packet_id == 0 || wait_packet_id == packet_id))\n             {\n                 use_packet_obj = packet_obj;\n                 waitMatchFound = 1;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d5b9743c79f4fdec734d6e8167902b87847310ef",
            "date": "2024-11-11T17:41:45Z",
            "author_login": "philljj"
          },
          {
            "sha": "7af01881e27f8a876c1231cafd1741631581d079",
            "date": "2024-11-11T15:11:13Z",
            "author_login": "embhorn"
          },
          {
            "sha": "6db6c74675360fdc9a8c5d6705c6633a75efc95a",
            "date": "2024-11-06T17:05:58Z",
            "author_login": "dgarske"
          },
          {
            "sha": "1287f15737db5ae86c14994d46aad36d603e75f0",
            "date": "2024-11-06T16:50:03Z",
            "author_login": "embhorn"
          },
          {
            "sha": "448103d3571a979dcb3f972efaf2082a6b70d99b",
            "date": "2024-11-05T16:45:39Z",
            "author_login": "embhorn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-787",
    "description": "wolfSSL wolfMQTT 1.9 has a heap-based buffer overflow in MqttClient_DecodePacket (called from MqttClient_WaitType and MqttClient_Connect).",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-01-01T01:15:08.780",
    "last_modified": "2024-11-21T06:33:18.647",
    "fix_date": "2021-09-21T16:46:46Z"
  },
  "references": [
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39083",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/wolfmqtt/OSV-2021-1349.yaml",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wolfSSL/wolfMQTT/commit/84d4b53122e0fa0280c7872350b89d5777dabbb2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39083",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/google/oss-fuzz-vulns/blob/main/vulns/wolfmqtt/OSV-2021-1349.yaml",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wolfSSL/wolfMQTT/commit/84d4b53122e0fa0280c7872350b89d5777dabbb2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:37.041113",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wolfMQTT",
    "owner": "wolfSSL",
    "created_at": "2015-10-26T16:58:13Z",
    "updated_at": "2025-01-12T02:01:29Z",
    "pushed_at": "2024-11-11T17:41:46Z",
    "size": 1789,
    "stars": 530,
    "forks": 158,
    "open_issues": 12,
    "watchers": 530,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 515615,
      "M4": 168915,
      "CMake": 119943,
      "Shell": 28250,
      "Makefile": 20393,
      "C++": 10555,
      "FreeMarker": 3956,
      "Batchfile": 1317
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:08:09.646015"
  }
}