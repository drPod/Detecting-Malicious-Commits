{
  "cve_id": "CVE-2021-46704",
  "github_data": {
    "repository": "genieacs/genieacs",
    "fix_commit": "7f295beeecc1c1f14308a93c82413bb334045af6",
    "related_commits": [
      "7f295beeecc1c1f14308a93c82413bb334045af6",
      "7f295beeecc1c1f14308a93c82413bb334045af6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7f295beeecc1c1f14308a93c82413bb334045af6",
      "commit_date": "2021-10-14T07:33:35Z",
      "author": {
        "login": "zaidka",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Validate host arg passed to ping",
        "length": 101,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 13,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/ping.ts",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -19,6 +19,7 @@\n \n import { platform } from \"os\";\n import { exec } from \"child_process\";\n+import { domainToASCII } from \"url\";\n \n export interface PingResult {\n   packetsTransmitted: number;\n@@ -30,11 +31,23 @@ export interface PingResult {\n   mdev: number;\n }\n \n+function isValidHost(host: string): boolean {\n+  // Valid chars in IPv4, IPv6, domain names\n+  if (/^[a-zA-Z0-9\\-.:[\\]-]+$/.test(host)) return true;\n+\n+  // Check if input is an IDN convert to Punycode\n+  // Can't merge with above because domainToASCII doesn't accept IP addresses\n+  return /^[a-zA-Z0-9\\-.:[\\]-]+$/.test(domainToASCII(host));\n+}\n+\n export function ping(\n   host: string,\n   callback: (err: Error, res?: PingResult, stdout?: string) => void\n ): void {\n   let cmd: string, parseRegExp1: RegExp, parseRegExp2: RegExp;\n+  // Validate input to prevent possible remote code execution\n+  // Credit to Alex Hordijk for reporting this vulnerability\n+  if (!isValidHost(host)) return callback(new Error(\"Invalid host\"));\n   host = host.replace(\"[\", \"\").replace(\"]\", \"\");\n   switch (platform()) {\n     case \"linux\":"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4be39ed742341144d5fed6b95d3bcf62fe7a0c80",
            "date": "2024-10-04T18:28:04Z",
            "author_login": "zaidka"
          },
          {
            "sha": "8ddb69237053605c987f4a0b546c5480b0e886e0",
            "date": "2024-10-04T18:02:41Z",
            "author_login": "zaidka"
          },
          {
            "sha": "fc80a7d487182d6b378fe3edd4ab004456859ae3",
            "date": "2024-06-06T19:55:38Z",
            "author_login": "zaidka"
          },
          {
            "sha": "f34f10edc78995f6e70681a4432429d33af6e158",
            "date": "2024-06-06T19:55:12Z",
            "author_login": "zaidka"
          },
          {
            "sha": "a416f68b7639b248329df6d407ed70e87fe680da",
            "date": "2024-06-06T19:52:53Z",
            "author_login": "zaidka"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "In GenieACS 1.2.x before 1.2.8, the UI interface API is vulnerable to unauthenticated OS command injection via the ping host argument (lib/ui/api.ts and lib/ping.ts). The vulnerability arises from insufficient input validation combined with a missing authorization check.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-03-06T07:15:07.200",
    "last_modified": "2024-11-21T06:34:36.267",
    "fix_date": "2021-10-14T07:33:35Z"
  },
  "references": [
    {
      "url": "https://github.com/genieacs/genieacs/commit/7f295beeecc1c1f14308a93c82413bb334045af6",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/genieacs/genieacs/releases/tag/v1.2.8",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/genieacs/genieacs/commit/7f295beeecc1c1f14308a93c82413bb334045af6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/genieacs/genieacs/releases/tag/v1.2.8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.782714",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "genieacs",
    "owner": "genieacs",
    "created_at": "2013-06-24T07:22:15Z",
    "updated_at": "2025-01-17T13:57:38Z",
    "pushed_at": "2024-10-04T18:30:32Z",
    "size": 3409,
    "stars": 650,
    "forks": 351,
    "open_issues": 71,
    "watchers": 650,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "TypeScript": 874420,
      "CSS": 15114,
      "Shell": 221
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T08:31:34.735099"
  }
}