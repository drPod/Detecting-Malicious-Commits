{
  "cve_id": "CVE-2021-47154",
  "github_data": {
    "repository": "stigtsp/Net-CIDR-Lite",
    "fix_commit": "23b6ff0590dc279521863a502e890ef19a5a76fc",
    "related_commits": [
      "23b6ff0590dc279521863a502e890ef19a5a76fc",
      "23b6ff0590dc279521863a502e890ef19a5a76fc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "23b6ff0590dc279521863a502e890ef19a5a76fc",
      "commit_date": "2021-03-31T15:27:31Z",
      "author": {
        "login": "stigtsp",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security: Prevent leading zeroes in ipv4 octets",
        "length": 338,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 15,
        "additions": 13,
        "deletions": 2
      },
      "files": [
        {
          "filename": "Lite.pm",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -181,7 +181,7 @@ sub _pack_ipv4 {\n     my @nums = split /\\./, shift(), -1;\n     return unless @nums == 4;\n     for (@nums) {\n-        return unless /^\\d{1,3}$/ and $_ <= 255;\n+        return unless /^\\d{1,3}$/ and !/^0\\d{1,2}$/ and $_ <= 255;\n     }\n     pack(\"CC*\", 0, @nums);\n }"
        },
        {
          "filename": "t/base.t",
          "status": "modified",
          "additions": 12,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n use Test;\n use strict;\n $|++;\n-BEGIN { plan tests => 39 };\n+BEGIN { plan tests => 42 };\n use Net::CIDR::Lite;\n ok(1); # If we made it this far, we are ok.\n \n@@ -133,3 +133,14 @@ ok(join(', ', @list_short_range), '10.0.0.1-2, 10.0.0.5');\n })->list_short_range;\n ok(join(', ', @list_short_range), '10.0.0.250-255, 10.0.1.0-20, 10.0.1.22, 10.0.2.250-255, 10.0.3.0-255, 10.0.4.0-255, 10.0.5.0-8');\n \n+\n+# Tests for vulnerability: https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/\n+eval { Net::CIDR::Lite->new(\"010.0.0.0/8\") };\n+ok($@=~/Can't determine ip format/);\n+\n+my $err_octal = Net::CIDR::Lite->new;\n+eval { $err_octal->add(\"010.0.0.0/8\") };\n+ok($@=~/Can't determine ip format/);\n+\n+eval { $err_octal->add(\"10.01.0.0/8\") };\n+ok($@=~/Can't determine ip format/);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "71aca53d2f2ad8c4058df7a80a01f599bb6118f0",
            "date": "2021-04-04T20:06:04Z",
            "author_login": "stigtsp"
          },
          {
            "sha": "8323ff670b64cbaa2a4428aa8a1d1dba064fdf0e",
            "date": "2021-03-31T15:34:10Z",
            "author_login": "stigtsp"
          },
          {
            "sha": "23b6ff0590dc279521863a502e890ef19a5a76fc",
            "date": "2021-03-31T15:27:31Z",
            "author_login": "stigtsp"
          },
          {
            "sha": "60faf1d92fd403656e9314e1580d395a6dbef7da",
            "date": "2021-03-31T15:21:09Z",
            "author_login": "stigtsp"
          },
          {
            "sha": "14882843e0b0350cefdd12af8cb6e604659632f9",
            "date": "2021-03-31T14:37:32Z",
            "author_login": "stigtsp"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": null,
    "description": "The Net::CIDR::Lite module before 0.22 for Perl does not properly consider extraneous zero characters at the beginning of an IP address string, which (in some situations) allows attackers to bypass access control that is based on IP addresses.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-18T05:15:06.140",
    "last_modified": "2024-11-21T06:35:30.437",
    "fix_date": "2021-03-31T15:27:31Z"
  },
  "references": [
    {
      "url": "https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/stigtsp/Net-CIDR-Lite/commit/23b6ff0590dc279521863a502e890ef19a5a76fc",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/03/msg00023.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://metacpan.org/dist/Net-CIDR-Lite/changes",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://metacpan.org/pod/Net::CIDR::Lite",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://blog.urth.org/2021/03/29/security-issues-in-perl-ip-address-distros/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/stigtsp/Net-CIDR-Lite/commit/23b6ff0590dc279521863a502e890ef19a5a76fc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/03/msg00023.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://metacpan.org/dist/Net-CIDR-Lite/changes",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://metacpan.org/pod/Net::CIDR::Lite",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.510621",
    "processing_status": "enhanced"
  }
}