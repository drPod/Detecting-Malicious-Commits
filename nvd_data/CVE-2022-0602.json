{
  "cve_id": "CVE-2022-0602",
  "github_data": {
    "repository": "tastyigniter/tastyigniter",
    "fix_commit": "992d4ce6444805c3132e3635a01b6fd222063554",
    "related_commits": [
      "992d4ce6444805c3132e3635a01b6fd222063554",
      "992d4ce6444805c3132e3635a01b6fd222063554"
    ],
    "patch_url": "https://github.com/tastyigniter/tastyigniter/commit/992d4ce6444805c3132e3635a01b6fd222063554.patch",
    "fix_commit_details": {
      "sha": "992d4ce6444805c3132e3635a01b6fd222063554",
      "commit_date": "2022-03-10T22:11:52Z",
      "author": {
        "login": "sampoyigi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Minor fixes",
        "length": 83,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 19,
        "deletions": 11
      },
      "files": [
        {
          "filename": "app/admin/formwidgets/ScheduleEditor.php",
          "status": "modified",
          "additions": 12,
          "deletions": 5,
          "patch": "@@ -3,11 +3,13 @@\n namespace Admin\\FormWidgets;\n \n use Admin\\Classes\\BaseFormWidget;\n+use Admin\\Models\\Locations_model;\n use Admin\\Models\\Working_hours_model;\n use Admin\\Traits\\ValidatesForm;\n use Admin\\Widgets\\Form;\n use Igniter\\Flame\\Exception\\ApplicationException;\n use Igniter\\Flame\\Location\\Models\\AbstractLocation;\n+use Igniter\\Flame\\Location\\OrderTypes;\n use Illuminate\\Support\\Facades\\DB;\n \n class ScheduleEditor extends BaseFormWidget\n@@ -72,7 +74,7 @@ public function onLoadRecord()\n         $scheduleCode = post('recordId');\n         $scheduleItem = $this->getSchedule($scheduleCode);\n \n-        $formTitle = sprintf(lang($this->formTitle), lang('admin::lang.text_'.$scheduleCode));\n+        $formTitle = sprintf(lang($this->formTitle), lang($scheduleItem->name));\n \n         return $this->makePartial('recordeditor/form', [\n             'formRecordId' => $scheduleCode,\n@@ -125,10 +127,15 @@ protected function listSchedules()\n         if ($this->schedulesCache)\n             return $this->schedulesCache;\n \n-        $schedules = [];\n-        foreach ($this->model->availableWorkingTypes() as $scheduleCode) {\n-            $schedules[$scheduleCode] = $this->model->createScheduleItem($scheduleCode);\n-        }\n+        $schedules = collect(OrderTypes::instance()->listOrderTypes())\n+            ->prepend(['name' => 'admin::lang.text_opening'], Locations_model::OPENING)\n+            ->mapWithKeys(function ($definition, $code) {\n+                $scheduleItem = $this->model->createScheduleItem($code);\n+                $scheduleItem->name = array_get($definition, 'name');\n+\n+                return [$code => $scheduleItem];\n+            })\n+            ->all();\n \n         return $this->schedulesCache = $schedules;\n     }"
        },
        {
          "filename": "app/admin/formwidgets/scheduleeditor/schedules.blade.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -1,16 +1,16 @@\n-<div class=\"row\">\n-    @foreach ($schedules as $schedule)\n-        <div class=\"col-lg-4 py-3\">\n+<div class=\"d-flex flex-nowrap overflow-auto\">\n+    @foreach ($schedules as $scheduleCode => $schedule)\n+        <div class=\"col-lg-3 {{ $loop->first ? 'py-2 pr-2 pl-0' : 'p-2' }}\">\n             <div\n                 id=\"{{ $this->getId('item-'.$loop->iteration) }}\"\n                 class=\"card bg-light shadow-sm mb-0\"\n                 data-editor-control=\"load-schedule\"\n-                data-schedule-code=\"{{ $schedule->name }}\"\n+                data-schedule-code=\"{{ $scheduleCode }}\"\n                 role=\"button\"\n             >\n                 <div class=\"card-body\">\n                     <div class=\"flex-fill\">\n-                        <h5 class=\"card-title\">{{ lang('admin::lang.text_'.$schedule->name).' '.lang('admin::lang.locations.text_schedule') }}</h5>\n+                        <h5 class=\"card-title\">{{ lang($schedule->name).' '.lang('admin::lang.locations.text_schedule') }}</h5>\n                         <p class=\"card-text\">{{ lang('admin::lang.locations.text_'.$schedule->type) }}</p>\n                     </div>\n "
        },
        {
          "filename": "app/main/formwidgets/components/component.blade.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@ class=\"components-item\"\n     data-control=\"component\"\n     data-component-alias=\"{{ $component->alias }}\"\n >\n-    <div class=\"btn btn-light text-left p-3 component{{ $component->fatalError ? ' border-danger' : '' }}\">\n+    <div class=\"btn btn-light text-left p-3 w-100 component{{ $component->fatalError ? ' border-danger' : '' }}\">\n         <div\n             class=\"components-item-info\"\n             data-component-control=\"load\""
        },
        {
          "filename": "app/system/models/config/mail_templates_model.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -62,6 +62,7 @@\n         'label' => 'lang:admin::lang.column_date_added',\n         'type' => 'timetense',\n         'searchable' => TRUE,\n+        'invisible' => TRUE,\n     ],\n     'template_id' => [\n         'label' => 'lang:admin::lang.column_id',"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fc7a1dcdbb63abce413c59bb7fbb5119c5169664",
            "date": "2024-11-14T15:18:34Z",
            "author_login": "sampoyigi"
          },
          {
            "sha": "fcb489d502efd52cd65f83d3c1a475a1e3b86dbb",
            "date": "2024-11-13T15:59:49Z",
            "author_login": "sampoyigi"
          },
          {
            "sha": "26d270a5df86b118e5f4debe5279c22e1e610a65",
            "date": "2024-09-17T12:07:15Z",
            "author_login": "obinnaelviso"
          },
          {
            "sha": "1692ea4fa5114403bd34eff6f56e18b3b570af33",
            "date": "2024-09-14T11:48:02Z",
            "author_login": "sampoyigi"
          },
          {
            "sha": "e6591750892c70a96d57ab99e6e1c5eb2c3f7342",
            "date": "2024-08-24T13:57:01Z",
            "author_login": "sampoyigi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - DOM in GitHub repository tastyigniter/tastyigniter prior to 3.3.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-05T16:15:13.517",
    "last_modified": "2024-11-21T06:39:00.240",
    "fix_date": "2022-03-10T22:11:52Z"
  },
  "references": [
    {
      "url": "https://github.com/tastyigniter/tastyigniter/commit/992d4ce6444805c3132e3635a01b6fd222063554",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/615f1788-d474-4580-b0ef-5edd50274010",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tastyigniter/tastyigniter/commit/992d4ce6444805c3132e3635a01b6fd222063554",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/615f1788-d474-4580-b0ef-5edd50274010",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.102655",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "TastyIgniter",
    "owner": "tastyigniter",
    "created_at": "2014-02-02T14:14:26Z",
    "updated_at": "2025-01-14T18:48:15Z",
    "pushed_at": "2025-01-03T00:14:34Z",
    "size": 54195,
    "stars": 3066,
    "forks": 1009,
    "open_issues": 7,
    "watchers": 3066,
    "has_security_policy": false,
    "default_branch": "3.x",
    "protected_branches": [
      "3.x",
      "develop",
      "master"
    ],
    "languages": {
      "PHP": 1885286,
      "Blade": 278043
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:06:37.247478"
  }
}