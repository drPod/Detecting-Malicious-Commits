{
  "cve_id": "CVE-2022-0613",
  "github_data": {
    "repository": "medialize/uri.js",
    "fix_commit": "6ea641cc8648b025ed5f30b090c2abd4d1a5249f",
    "related_commits": [
      "6ea641cc8648b025ed5f30b090c2abd4d1a5249f",
      "6ea641cc8648b025ed5f30b090c2abd4d1a5249f"
    ],
    "patch_url": "https://github.com/medialize/uri.js/commit/6ea641cc8648b025ed5f30b090c2abd4d1a5249f.patch",
    "fix_commit_details": {
      "sha": "6ea641cc8648b025ed5f30b090c2abd4d1a5249f",
      "commit_date": "2022-02-14T22:38:32Z",
      "author": {
        "login": "r0hanSH",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(parse): case insensitive scheme - #412",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 53,
        "additions": 51,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/URI.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -513,7 +513,7 @@\n     }\n \n     // slashes and backslashes have lost all meaning for the web protocols (https, http, wss, ws)\n-    string = string.replace(/^(https?|ftp|wss?)?:[/\\\\]*/, '$1://');\n+    string = string.replace(/^(https?|ftp|wss?)?:[/\\\\]*/i, '$1://');\n \n     // extract protocol\n     if (string.substring(0, 2) === '//') {"
        },
        {
          "filename": "src/URI.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,7 @@ function(){d.encode=escape;d.decode=unescape};d.unicode=function(){d.encode=F;d.\n \"%21\":\"!\",\"%24\":\"$\",\"%26\":\"&\",\"%27\":\"'\",\"%28\":\"(\",\"%29\":\")\",\"%2A\":\"*\",\"%2B\":\"+\",\"%2C\":\",\",\"%3B\":\";\",\"%3D\":\"=\"}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/ig,map:{\"%21\":\"!\",\"%24\":\"$\",\"%27\":\"'\",\"%28\":\"(\",\"%29\":\")\",\"%2A\":\"*\",\"%2B\":\"+\",\"%2C\":\",\",\"%3B\":\";\",\"%3D\":\"=\",\"%40\":\"@\"}},decode:{expression:/[\\/\\?#:]/g,map:{\"/\":\"%2F\",\"?\":\"%3F\",\"#\":\"%23\",\":\":\"%3A\"}}}};d.encodeQuery=function(a,b){var c=d.encode(a+\"\");void 0===b&&(b=d.escapeQuerySpace);return b?c.replace(/%20/g,\"+\"):c};d.decodeQuery=\n function(a,b){a+=\"\";void 0===b&&(b=d.escapeQuerySpace);try{return d.decode(b?a.replace(/\\+/g,\"%20\"):a)}catch(c){return a}};var G={encode:\"encode\",decode:\"decode\"},l,t=function(a,b){return function(c){try{return d[b](c+\"\").replace(d.characters[a][b].expression,function(e){return d.characters[a][b].map[e]})}catch(e){return c}}};for(l in G)d[l+\"PathSegment\"]=t(\"pathname\",G[l]),d[l+\"UrnPathSegment\"]=t(\"urnpath\",G[l]);G=function(a,b,c){return function(e){var f=c?function(I){return d[b](d[c](I))}:d[b];\n e=(e+\"\").split(a);for(var n=0,z=e.length;n<z;n++)e[n]=f(e[n]);return e.join(a)}};d.decodePath=G(\"/\",\"decodePathSegment\");d.decodeUrnPath=G(\":\",\"decodeUrnPathSegment\");d.recodePath=G(\"/\",\"encodePathSegment\",\"decode\");d.recodeUrnPath=G(\":\",\"encodeUrnPathSegment\",\"decode\");d.encodeReserved=t(\"reserved\",\"encode\");d.parse=function(a,b){b||(b={preventInvalidHostname:d.preventInvalidHostname});var c=a.indexOf(\"#\");-1<c&&(b.fragment=a.substring(c+1)||null,a=a.substring(0,c));c=a.indexOf(\"?\");-1<c&&(b.query=\n-a.substring(c+1)||null,a=a.substring(0,c));a=a.replace(/^(https?|ftp|wss?)?:[/\\\\]*/,\"$1://\");\"//\"===a.substring(0,2)?(b.protocol=null,a=a.substring(2),a=d.parseAuthority(a,b)):(c=a.indexOf(\":\"),-1<c&&(b.protocol=a.substring(0,c)||null,b.protocol&&!b.protocol.match(d.protocol_expression)?b.protocol=void 0:\"//\"===a.substring(c+1,c+3).replace(/\\\\/g,\"/\")?(a=a.substring(c+3),a=d.parseAuthority(a,b)):(a=a.substring(c+1),b.urn=!0)));b.path=a;return b};d.parseHost=function(a,b){a||(a=\"\");a=a.replace(/\\\\/g,\n+a.substring(c+1)||null,a=a.substring(0,c));a=a.replace(/^(https?|ftp|wss?)?:[/\\\\]*/i,\"$1://\");\"//\"===a.substring(0,2)?(b.protocol=null,a=a.substring(2),a=d.parseAuthority(a,b)):(c=a.indexOf(\":\"),-1<c&&(b.protocol=a.substring(0,c)||null,b.protocol&&!b.protocol.match(d.protocol_expression)?b.protocol=void 0:\"//\"===a.substring(c+1,c+3).replace(/\\\\/g,\"/\")?(a=a.substring(c+3),a=d.parseAuthority(a,b)):(a=a.substring(c+1),b.urn=!0)));b.path=a;return b};d.parseHost=function(a,b){a||(a=\"\");a=a.replace(/\\\\/g,\n \"/\");var c=a.indexOf(\"/\");-1===c&&(c=a.length);if(\"[\"===a.charAt(0)){var e=a.indexOf(\"]\");b.hostname=a.substring(1,e)||null;b.port=a.substring(e+2,c)||null;\"/\"===b.port&&(b.port=null)}else{var f=a.indexOf(\":\");e=a.indexOf(\"/\");f=a.indexOf(\":\",f+1);-1!==f&&(-1===e||f<e)?(b.hostname=a.substring(0,c)||null,b.port=null):(e=a.substring(0,c).split(\":\"),b.hostname=e[0]||null,b.port=e[1]||null)}b.hostname&&\"/\"!==a.substring(c).charAt(0)&&(c++,a=\"/\"+a);b.preventInvalidHostname&&d.ensureValidHostname(b.hostname,\n b.protocol);b.port&&d.ensureValidPort(b.port);return a.substring(c)||\"/\"};d.parseAuthority=function(a,b){a=d.parseUserinfo(a,b);return d.parseHost(a,b)};d.parseUserinfo=function(a,b){var c=a;-1!==a.indexOf(\"\\\\\")&&(a=a.replace(/\\\\/g,\"/\"));var e=a.indexOf(\"/\"),f=a.lastIndexOf(\"@\",-1<e?e:a.length-1);-1<f&&(-1===e||f<e)?(e=a.substring(0,f).split(\":\"),b.username=e[0]?d.decode(e[0]):null,e.shift(),b.password=e[0]?d.decode(e.join(\":\")):null,a=c.substring(f+1)):(b.username=null,b.password=null);return a};\n d.parseQuery=function(a,b){if(!a)return{};a=a.replace(/&+/g,\"&\").replace(/^\\?*&*|&+$/g,\"\");if(!a)return{};for(var c={},e=a.split(\"&\"),f=e.length,n,z,I=0;I<f;I++)if(n=e[I].split(\"=\"),z=d.decodeQuery(n.shift(),b),n=n.length?d.decodeQuery(n.join(\"=\"),b):null,\"__proto__\"!==z)if(B.call(c,z)){if(\"string\"===typeof c[z]||null===c[z])c[z]=[c[z]];c[z].push(n)}else c[z]=n;return c};d.build=function(a){var b=\"\",c=!1;a.protocol&&(b+=a.protocol+\":\");a.urn||!b&&!a.hostname||(b+=\"//\",c=!0);b+=d.buildAuthority(a)||"
        },
        {
          "filename": "test/urls.js",
          "status": "modified",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -2327,6 +2327,55 @@ var urls = [{\n         idn: false,\n         punycode: false\n       }\n+    }, {\n+      name: 'excessive slash protocol https case-insensitive',\n+      url: 'hTTps://////attacker.com',\n+      _url: 'hTTps://attacker.com/',\n+      parts: {\n+        protocol: 'hTTps',\n+        username: null,\n+        password: null,\n+        hostname: 'attacker.com',\n+        port: null,\n+        path: '/',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'hTTps',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: '/',\n+        query: '',\n+        fragment: '',\n+        resource: '/',\n+        authority: 'attacker.com',\n+        origin: 'hTTps://attacker.com',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: 'attacker.com',\n+        tld: 'com',\n+        directory: '/',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: 'attacker.com',\n+        hostname: 'attacker.com'\n+      },\n+      is: {\n+        urn: false,\n+        url: true,\n+        relative: false,\n+        name: true,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n     }, {\n       name: 'no slash protocol ftp',\n       url: 'ftp:attacker.com',"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28976cde5bb32a433ab78c4a32ef58f39d2cabf6",
            "date": "2022-04-03T09:31:17Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b655c1b972111ade9f181b02374305942e68e30a",
            "date": "2022-04-03T09:30:13Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
            "date": "2022-04-03T09:24:54Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
            "date": "2022-04-03T08:51:52Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "119e6abe4579f6a76b078586ec4d8fbce9da962c",
            "date": "2022-03-05T15:17:44Z",
            "author_login": "rodneyrehm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-639",
    "description": "Authorization Bypass Through User-Controlled Key in NPM urijs prior to 1.19.8.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-16T09:15:07.043",
    "last_modified": "2024-11-21T06:39:01.617",
    "fix_date": "2022-02-14T22:38:32Z"
  },
  "references": [
    {
      "url": "https://github.com/medialize/uri.js/commit/6ea641cc8648b025ed5f30b090c2abd4d1a5249f",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/f53d5c42-c108-40b8-917d-9dad51535083",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MXSSATHALUSXXD2KT6UFZAX7EG4GR332/",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/medialize/uri.js/commit/6ea641cc8648b025ed5f30b090c2abd4d1a5249f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/f53d5c42-c108-40b8-917d-9dad51535083",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MXSSATHALUSXXD2KT6UFZAX7EG4GR332/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.718149",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "URI.js",
    "owner": "medialize",
    "created_at": "2011-12-27T10:46:47Z",
    "updated_at": "2025-01-13T05:48:53Z",
    "pushed_at": "2023-08-27T10:51:22Z",
    "size": 3202,
    "stars": 6258,
    "forks": 476,
    "open_issues": 104,
    "watchers": 6258,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 377871,
      "HTML": 120393,
      "CSS": 9642,
      "PHP": 1226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:50:37.086232"
  }
}