{
  "cve_id": "CVE-2022-0921",
  "github_data": {
    "repository": "microweber/microweber",
    "fix_commit": "867bdda1b4660b0795ad7f87ab5abe9e44b2b318",
    "related_commits": [
      "867bdda1b4660b0795ad7f87ab5abe9e44b2b318",
      "867bdda1b4660b0795ad7f87ab5abe9e44b2b318"
    ],
    "patch_url": "https://github.com/microweber/microweber/commit/867bdda1b4660b0795ad7f87ab5abe9e44b2b318.patch",
    "fix_commit_details": {
      "sha": "867bdda1b4660b0795ad7f87ab5abe9e44b2b318",
      "commit_date": "2022-03-11T09:49:04Z",
      "author": {
        "login": "bobimicroweber",
        "type": "User",
        "stats": {
          "total_commits": 5511,
          "average_weekly_commits": 10.378531073446327,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 156
        }
      },
      "commit_message": {
        "title": "secure upgrade on php files upload",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 1103,
        "additions": 161,
        "deletions": 942
      },
      "files": [
        {
          "filename": "composer.json",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -31,7 +31,6 @@\n         \"doctrine/dbal\": \"*\",\n         \"composer/composer\": \"1.10.23\",\n         \"composer/installers\": \"1.9.0\",\n-        \"symplify/monorepo-builder\": \"^8.1\",\n         \"ezyang/htmlpurifier\": \"*\",\n         \"knplabs/knp-menu\": \"^3.2@dev\",\n         \"jenssegers/agent\": \"^3.0@dev\","
        },
        {
          "filename": "composer.lock",
          "status": "modified",
          "additions": 73,
          "deletions": 934,
          "patch": "@@ -4,7 +4,7 @@\n         \"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies\",\n         \"This file is @generated automatically\"\n     ],\n-    \"content-hash\": \"d022c816080bcecc0ba4a49f3890a244\",\n+    \"content-hash\": \"8361e998f6732306b5c86f3f1b12f36b\",\n     \"packages\": [\n         {\n             \"name\": \"arcanedev/php-html\",\n@@ -872,80 +872,6 @@\n             ],\n             \"time\": \"2020-04-07T06:57:05+00:00\"\n         },\n-        {\n-            \"name\": \"composer/package-versions-deprecated\",\n-            \"version\": \"dev-master\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/composer/package-versions-deprecated.git\",\n-                \"reference\": \"b4f54f74ef3453349c24a845d22392cd31e65f1d\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/composer/package-versions-deprecated/zipball/b4f54f74ef3453349c24a845d22392cd31e65f1d\",\n-                \"reference\": \"b4f54f74ef3453349c24a845d22392cd31e65f1d\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"composer-plugin-api\": \"^1.1.0 || ^2.0\",\n-                \"php\": \"^7 || ^8\"\n-            },\n-            \"replace\": {\n-                \"ocramius/package-versions\": \"1.11.99\"\n-            },\n-            \"require-dev\": {\n-                \"composer/composer\": \"^1.9.3 || ^2.0@dev\",\n-                \"ext-zip\": \"^1.13\",\n-                \"phpunit/phpunit\": \"^6.5 || ^7\"\n-            },\n-            \"default-branch\": true,\n-            \"type\": \"composer-plugin\",\n-            \"extra\": {\n-                \"class\": \"PackageVersions\\\\Installer\",\n-                \"branch-alias\": {\n-                    \"dev-master\": \"1.x-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"PackageVersions\\\\\": \"src/PackageVersions\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"Marco Pivetta\",\n-                    \"email\": \"ocramius@gmail.com\"\n-                },\n-                {\n-                    \"name\": \"Jordi Boggiano\",\n-                    \"email\": \"j.boggiano@seld.be\"\n-                }\n-            ],\n-            \"description\": \"Composer plugin that provides efficient querying for installed package versions (no runtime IO)\",\n-            \"support\": {\n-                \"issues\": \"https://github.com/composer/package-versions-deprecated/issues\",\n-                \"source\": \"https://github.com/composer/package-versions-deprecated/tree/1.11.99.5\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://packagist.com\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/composer\",\n-                    \"type\": \"github\"\n-                },\n-                {\n-                    \"url\": \"https://tidelift.com/funding/github/packagist/composer/composer\",\n-                    \"type\": \"tidelift\"\n-                }\n-            ],\n-            \"time\": \"2022-01-17T14:14:24+00:00\"\n-        },\n         {\n             \"name\": \"composer/semver\",\n             \"version\": \"1.x-dev\",\n@@ -3329,62 +3255,6 @@\n             },\n             \"time\": \"2021-12-07T18:35:06+00:00\"\n         },\n-        {\n-            \"name\": \"jean85/pretty-package-versions\",\n-            \"version\": \"dev-master\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/Jean85/pretty-package-versions.git\",\n-                \"reference\": \"a917488320c20057da87f67d0d40543dd9427f7a\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/Jean85/pretty-package-versions/zipball/a917488320c20057da87f67d0d40543dd9427f7a\",\n-                \"reference\": \"a917488320c20057da87f67d0d40543dd9427f7a\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"composer/package-versions-deprecated\": \"^1.8.0\",\n-                \"php\": \"^7.0|^8.0\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^6.0|^8.5|^9.2\"\n-            },\n-            \"default-branch\": true,\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"1.x-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Jean85\\\\\": \"src/\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"Alessandro Lai\",\n-                    \"email\": \"alessandro.lai85@gmail.com\"\n-                }\n-            ],\n-            \"description\": \"A wrapper for ocramius/package-versions to get pretty versions strings\",\n-            \"keywords\": [\n-                \"composer\",\n-                \"package\",\n-                \"release\",\n-                \"versions\"\n-            ],\n-            \"support\": {\n-                \"issues\": \"https://github.com/Jean85/pretty-package-versions/issues\",\n-                \"source\": \"https://github.com/Jean85/pretty-package-versions/tree/1.5.1\"\n-            },\n-            \"time\": \"2020-09-14T08:43:34+00:00\"\n-        },\n         {\n             \"name\": \"jenssegers/agent\",\n             \"version\": \"dev-master\",\n@@ -6273,158 +6143,6 @@\n             ],\n             \"time\": \"2022-02-13T18:13:33+00:00\"\n         },\n-        {\n-            \"name\": \"nette/finder\",\n-            \"version\": \"v2.6.x-dev\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/nette/finder.git\",\n-                \"reference\": \"2071d25db90e7e2a483b18e463466d13dc78f2a1\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/nette/finder/zipball/2071d25db90e7e2a483b18e463466d13dc78f2a1\",\n-                \"reference\": \"2071d25db90e7e2a483b18e463466d13dc78f2a1\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"nette/utils\": \"^2.4 || ^3.0\",\n-                \"php\": \">=7.1\"\n-            },\n-            \"conflict\": {\n-                \"nette/nette\": \"<2.2\"\n-            },\n-            \"require-dev\": {\n-                \"nette/tester\": \"^2.0\",\n-                \"phpstan/phpstan\": \"^0.12\",\n-                \"tracy/tracy\": \"^2.3\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"2.6-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"classmap\": [\n-                    \"src/\"\n-                ]\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"BSD-3-Clause\",\n-                \"GPL-2.0-only\",\n-                \"GPL-3.0-only\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"David Grudl\",\n-                    \"homepage\": \"https://davidgrudl.com\"\n-                },\n-                {\n-                    \"name\": \"Nette Community\",\n-                    \"homepage\": \"https://nette.org/contributors\"\n-                }\n-            ],\n-            \"description\": \"\ud83d\udd0d Nette Finder: find files and directories with an intuitive API.\",\n-            \"homepage\": \"https://nette.org\",\n-            \"keywords\": [\n-                \"filesystem\",\n-                \"glob\",\n-                \"iterator\",\n-                \"nette\"\n-            ],\n-            \"support\": {\n-                \"issues\": \"https://github.com/nette/finder/issues\",\n-                \"source\": \"https://github.com/nette/finder/tree/v2.6\"\n-            },\n-            \"time\": \"2022-01-06T04:58:28+00:00\"\n-        },\n-        {\n-            \"name\": \"nette/utils\",\n-            \"version\": \"v3.2.x-dev\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/nette/utils.git\",\n-                \"reference\": \"32091bbafd8a543d255855bf44fc795742adaf49\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/nette/utils/zipball/32091bbafd8a543d255855bf44fc795742adaf49\",\n-                \"reference\": \"32091bbafd8a543d255855bf44fc795742adaf49\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"php\": \">=7.2 <8.2\"\n-            },\n-            \"conflict\": {\n-                \"nette/di\": \"<3.0.6\"\n-            },\n-            \"require-dev\": {\n-                \"nette/tester\": \"~2.0\",\n-                \"phpstan/phpstan\": \"^1.0\",\n-                \"tracy/tracy\": \"^2.3\"\n-            },\n-            \"suggest\": {\n-                \"ext-gd\": \"to use Image\",\n-                \"ext-iconv\": \"to use Strings::webalize(), toAscii(), chr() and reverse()\",\n-                \"ext-intl\": \"to use Strings::webalize(), toAscii(), normalize() and compare()\",\n-                \"ext-json\": \"to use Nette\\\\Utils\\\\Json\",\n-                \"ext-mbstring\": \"to use Strings::lower() etc...\",\n-                \"ext-tokenizer\": \"to use Nette\\\\Utils\\\\Reflection::getUseStatements()\",\n-                \"ext-xml\": \"to use Strings::length() etc. when mbstring is not available\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"3.2-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"classmap\": [\n-                    \"src/\"\n-                ]\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"BSD-3-Clause\",\n-                \"GPL-2.0-only\",\n-                \"GPL-3.0-only\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"David Grudl\",\n-                    \"homepage\": \"https://davidgrudl.com\"\n-                },\n-                {\n-                    \"name\": \"Nette Community\",\n-                    \"homepage\": \"https://nette.org/contributors\"\n-                }\n-            ],\n-            \"description\": \"\ud83d\udee0  Nette Utils: lightweight utilities for string & array manipulation, image handling, safe JSON encoding/decoding, validation, slug or strong password generating etc.\",\n-            \"homepage\": \"https://nette.org\",\n-            \"keywords\": [\n-                \"array\",\n-                \"core\",\n-                \"datetime\",\n-                \"images\",\n-                \"json\",\n-                \"nette\",\n-                \"paginator\",\n-                \"password\",\n-                \"slugify\",\n-                \"string\",\n-                \"unicode\",\n-                \"utf-8\",\n-                \"utility\",\n-                \"validation\"\n-            ],\n-            \"support\": {\n-                \"issues\": \"https://github.com/nette/utils/issues\",\n-                \"source\": \"https://github.com/nette/utils/tree/v3.2\"\n-            },\n-            \"time\": \"2022-01-28T15:10:59+00:00\"\n-        },\n         {\n             \"name\": \"nikic/php-parser\",\n             \"version\": \"v4.13.2\",\n@@ -7104,57 +6822,6 @@\n             },\n             \"time\": \"2018-07-02T15:55:56+00:00\"\n         },\n-        {\n-            \"name\": \"phar-io/version\",\n-            \"version\": \"3.2.1\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/phar-io/version.git\",\n-                \"reference\": \"4f7fd7836c6f332bb2933569e566a0d6c4cbed74\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/phar-io/version/zipball/4f7fd7836c6f332bb2933569e566a0d6c4cbed74\",\n-                \"reference\": \"4f7fd7836c6f332bb2933569e566a0d6c4cbed74\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"php\": \"^7.2 || ^8.0\"\n-            },\n-            \"type\": \"library\",\n-            \"autoload\": {\n-                \"classmap\": [\n-                    \"src/\"\n-                ]\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"BSD-3-Clause\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"Arne Blankerts\",\n-                    \"email\": \"arne@blankerts.de\",\n-                    \"role\": \"Developer\"\n-                },\n-                {\n-                    \"name\": \"Sebastian Heuer\",\n-                    \"email\": \"sebastian@phpeople.de\",\n-                    \"role\": \"Developer\"\n-                },\n-                {\n-                    \"name\": \"Sebastian Bergmann\",\n-                    \"email\": \"sebastian@phpunit.de\",\n-                    \"role\": \"Developer\"\n-                }\n-            ],\n-            \"description\": \"Library for handling version information and constraints\",\n-            \"support\": {\n-                \"issues\": \"https://github.com/phar-io/version/issues\",\n-                \"source\": \"https://github.com/phar-io/version/tree/3.2.1\"\n-            },\n-            \"time\": \"2022-02-21T01:04:05+00:00\"\n-        },\n         {\n             \"name\": \"phenx/php-font-lib\",\n             \"version\": \"0.5.4\",\n@@ -9504,123 +9171,43 @@\n             \"time\": \"2021-10-18T15:26:12+00:00\"\n         },\n         {\n-            \"name\": \"symfony/config\",\n+            \"name\": \"symfony/console\",\n             \"version\": \"5.4.x-dev\",\n             \"source\": {\n                 \"type\": \"git\",\n-                \"url\": \"https://github.com/symfony/config.git\",\n-                \"reference\": \"d65e1bd990c740e31feb07d2b0927b8d4df9956f\"\n+                \"url\": \"https://github.com/symfony/console.git\",\n+                \"reference\": \"d8111acc99876953f52fe16d4c50eb60940d49ad\"\n             },\n             \"dist\": {\n                 \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symfony/config/zipball/d65e1bd990c740e31feb07d2b0927b8d4df9956f\",\n-                \"reference\": \"d65e1bd990c740e31feb07d2b0927b8d4df9956f\",\n+                \"url\": \"https://api.github.com/repos/symfony/console/zipball/d8111acc99876953f52fe16d4c50eb60940d49ad\",\n+                \"reference\": \"d8111acc99876953f52fe16d4c50eb60940d49ad\",\n                 \"shasum\": \"\"\n             },\n             \"require\": {\n                 \"php\": \">=7.2.5\",\n                 \"symfony/deprecation-contracts\": \"^2.1|^3\",\n-                \"symfony/filesystem\": \"^4.4|^5.0|^6.0\",\n-                \"symfony/polyfill-ctype\": \"~1.8\",\n+                \"symfony/polyfill-mbstring\": \"~1.0\",\n+                \"symfony/polyfill-php73\": \"^1.9\",\n                 \"symfony/polyfill-php80\": \"^1.16\",\n-                \"symfony/polyfill-php81\": \"^1.22\"\n+                \"symfony/service-contracts\": \"^1.1|^2|^3\",\n+                \"symfony/string\": \"^5.1|^6.0\"\n             },\n             \"conflict\": {\n-                \"symfony/finder\": \"<4.4\"\n+                \"psr/log\": \">=3\",\n+                \"symfony/dependency-injection\": \"<4.4\",\n+                \"symfony/dotenv\": \"<5.1\",\n+                \"symfony/event-dispatcher\": \"<4.4\",\n+                \"symfony/lock\": \"<4.4\",\n+                \"symfony/process\": \"<4.4\"\n+            },\n+            \"provide\": {\n+                \"psr/log-implementation\": \"1.0|2.0\"\n             },\n             \"require-dev\": {\n-                \"symfony/event-dispatcher\": \"^4.4|^5.0|^6.0\",\n-                \"symfony/finder\": \"^4.4|^5.0|^6.0\",\n-                \"symfony/messenger\": \"^4.4|^5.0|^6.0\",\n-                \"symfony/service-contracts\": \"^1.1|^2|^3\",\n-                \"symfony/yaml\": \"^4.4|^5.0|^6.0\"\n-            },\n-            \"suggest\": {\n-                \"symfony/yaml\": \"To use the yaml reference dumper\"\n-            },\n-            \"default-branch\": true,\n-            \"type\": \"library\",\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symfony\\\\Component\\\\Config\\\\\": \"\"\n-                },\n-                \"exclude-from-classmap\": [\n-                    \"/Tests/\"\n-                ]\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"Fabien Potencier\",\n-                    \"email\": \"fabien@symfony.com\"\n-                },\n-                {\n-                    \"name\": \"Symfony Community\",\n-                    \"homepage\": \"https://symfony.com/contributors\"\n-                }\n-            ],\n-            \"description\": \"Helps you find, load, combine, autofill and validate configuration values of any kind\",\n-            \"homepage\": \"https://symfony.com\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symfony/config/tree/v5.4.3\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://symfony.com/sponsor\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/fabpot\",\n-                    \"type\": \"github\"\n-                },\n-                {\n-                    \"url\": \"https://tidelift.com/funding/github/packagist/symfony/symfony\",\n-                    \"type\": \"tidelift\"\n-                }\n-            ],\n-            \"time\": \"2022-01-03T09:50:52+00:00\"\n-        },\n-        {\n-            \"name\": \"symfony/console\",\n-            \"version\": \"5.4.x-dev\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symfony/console.git\",\n-                \"reference\": \"d8111acc99876953f52fe16d4c50eb60940d49ad\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symfony/console/zipball/d8111acc99876953f52fe16d4c50eb60940d49ad\",\n-                \"reference\": \"d8111acc99876953f52fe16d4c50eb60940d49ad\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"php\": \">=7.2.5\",\n-                \"symfony/deprecation-contracts\": \"^2.1|^3\",\n-                \"symfony/polyfill-mbstring\": \"~1.0\",\n-                \"symfony/polyfill-php73\": \"^1.9\",\n-                \"symfony/polyfill-php80\": \"^1.16\",\n-                \"symfony/service-contracts\": \"^1.1|^2|^3\",\n-                \"symfony/string\": \"^5.1|^6.0\"\n-            },\n-            \"conflict\": {\n-                \"psr/log\": \">=3\",\n-                \"symfony/dependency-injection\": \"<4.4\",\n-                \"symfony/dotenv\": \"<5.1\",\n-                \"symfony/event-dispatcher\": \"<4.4\",\n-                \"symfony/lock\": \"<4.4\",\n-                \"symfony/process\": \"<4.4\"\n-            },\n-            \"provide\": {\n-                \"psr/log-implementation\": \"1.0|2.0\"\n-            },\n-            \"require-dev\": {\n-                \"psr/log\": \"^1|^2\",\n-                \"symfony/config\": \"^4.4|^5.0|^6.0\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.0|^6.0\",\n+                \"psr/log\": \"^1|^2\",\n+                \"symfony/config\": \"^4.4|^5.0|^6.0\",\n+                \"symfony/dependency-injection\": \"^4.4|^5.0|^6.0\",\n                 \"symfony/event-dispatcher\": \"^4.4|^5.0|^6.0\",\n                 \"symfony/lock\": \"^4.4|^5.0|^6.0\",\n                 \"symfony/process\": \"^4.4|^5.0|^6.0\",\n@@ -9819,96 +9406,6 @@\n             ],\n             \"time\": \"2022-01-02T09:41:36+00:00\"\n         },\n-        {\n-            \"name\": \"symfony/dependency-injection\",\n-            \"version\": \"5.4.x-dev\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symfony/dependency-injection.git\",\n-                \"reference\": \"35588b2afb08ea3a142d62fefdcad4cb09be06ed\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symfony/dependency-injection/zipball/35588b2afb08ea3a142d62fefdcad4cb09be06ed\",\n-                \"reference\": \"35588b2afb08ea3a142d62fefdcad4cb09be06ed\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"php\": \">=7.2.5\",\n-                \"psr/container\": \"^1.1.1\",\n-                \"symfony/deprecation-contracts\": \"^2.1|^3\",\n-                \"symfony/polyfill-php80\": \"^1.16\",\n-                \"symfony/polyfill-php81\": \"^1.22\",\n-                \"symfony/service-contracts\": \"^1.1.6|^2\"\n-            },\n-            \"conflict\": {\n-                \"ext-psr\": \"<1.1|>=2\",\n-                \"symfony/config\": \"<5.3\",\n-                \"symfony/finder\": \"<4.4\",\n-                \"symfony/proxy-manager-bridge\": \"<4.4\",\n-                \"symfony/yaml\": \"<4.4.26\"\n-            },\n-            \"provide\": {\n-                \"psr/container-implementation\": \"1.0\",\n-                \"symfony/service-implementation\": \"1.0|2.0\"\n-            },\n-            \"require-dev\": {\n-                \"symfony/config\": \"^5.3|^6.0\",\n-                \"symfony/expression-language\": \"^4.4|^5.0|^6.0\",\n-                \"symfony/yaml\": \"^4.4.26|^5.0|^6.0\"\n-            },\n-            \"suggest\": {\n-                \"symfony/config\": \"\",\n-                \"symfony/expression-language\": \"For using expressions in service container configuration\",\n-                \"symfony/finder\": \"For using double-star glob patterns or when GLOB_BRACE portability is required\",\n-                \"symfony/proxy-manager-bridge\": \"Generate service proxies to lazy load them\",\n-                \"symfony/yaml\": \"\"\n-            },\n-            \"default-branch\": true,\n-            \"type\": \"library\",\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symfony\\\\Component\\\\DependencyInjection\\\\\": \"\"\n-                },\n-                \"exclude-from-classmap\": [\n-                    \"/Tests/\"\n-                ]\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"authors\": [\n-                {\n-                    \"name\": \"Fabien Potencier\",\n-                    \"email\": \"fabien@symfony.com\"\n-                },\n-                {\n-                    \"name\": \"Symfony Community\",\n-                    \"homepage\": \"https://symfony.com/contributors\"\n-                }\n-            ],\n-            \"description\": \"Allows you to standardize and centralize the way objects are constructed in your application\",\n-            \"homepage\": \"https://symfony.com\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symfony/dependency-injection/tree/5.4\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://symfony.com/sponsor\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/fabpot\",\n-                    \"type\": \"github\"\n-                },\n-                {\n-                    \"url\": \"https://tidelift.com/funding/github/packagist/symfony/symfony\",\n-                    \"type\": \"tidelift\"\n-                }\n-            ],\n-            \"time\": \"2022-03-08T15:43:06+00:00\"\n-        },\n         {\n             \"name\": \"symfony/deprecation-contracts\",\n             \"version\": \"2.5.x-dev\",\n@@ -12413,415 +11910,6 @@\n             ],\n             \"time\": \"2022-01-26T16:32:32+00:00\"\n         },\n-        {\n-            \"name\": \"symplify/autowire-array-parameter\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/autowire-array-parameter.git\",\n-                \"reference\": \"721e29f2e656cc3cf1101fcc0dbb4f4a44d9309b\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/autowire-array-parameter/zipball/721e29f2e656cc3cf1101fcc0dbb4f4a44d9309b\",\n-                \"reference\": \"721e29f2e656cc3cf1101fcc0dbb4f4a44d9309b\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"nette/utils\": \"^3.0\",\n-                \"php\": \">=7.2\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.1\",\n-                \"symplify/package-builder\": \"^8.3.48\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\AutowireArrayParameter\\\\\": \"src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Autowire array parameters for your Symfony applications\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symplify/autowire-array-parameter/tree/8.3.48\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://www.paypal.me/rectorphp\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/tomasvotruba\",\n-                    \"type\": \"github\"\n-                }\n-            ],\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n-        {\n-            \"name\": \"symplify/composer-json-manipulator\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/composer-json-manipulator.git\",\n-                \"reference\": \"44346fecb95fd0f435ab43d6603995d1e0796353\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/composer-json-manipulator/zipball/44346fecb95fd0f435ab43d6603995d1e0796353\",\n-                \"reference\": \"44346fecb95fd0f435ab43d6603995d1e0796353\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"nette/utils\": \"^3.0\",\n-                \"php\": \">=7.2\",\n-                \"symfony/config\": \"^4.4|^5.1\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.1\",\n-                \"symfony/filesystem\": \"^4.4|^5.1\",\n-                \"symfony/http-kernel\": \"^4.4|^5.1\",\n-                \"symplify/package-builder\": \"^8.3.48\",\n-                \"symplify/smart-file-system\": \"^8.3.48\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"type\": \"symfony-bundle\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\ComposerJsonManipulator\\\\\": \"src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Package to load, merge and save composer.json file(s)\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symplify/composer-json-manipulator/tree/8.3.48\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://www.paypal.me/rectorphp\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/tomasvotruba\",\n-                    \"type\": \"github\"\n-                }\n-            ],\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n-        {\n-            \"name\": \"symplify/monorepo-builder\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/monorepo-builder.git\",\n-                \"reference\": \"e945d0f541c5202eed626c576522ebab6b10a3d3\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/monorepo-builder/zipball/e945d0f541c5202eed626c576522ebab6b10a3d3\",\n-                \"reference\": \"e945d0f541c5202eed626c576522ebab6b10a3d3\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"jean85/pretty-package-versions\": \"^1.2\",\n-                \"nette/utils\": \"^3.0\",\n-                \"phar-io/version\": \"^2.0.1|^3.0\",\n-                \"php\": \">=7.2\",\n-                \"symfony/console\": \"^4.4|^5.1\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.1\",\n-                \"symfony/finder\": \"^4.4|^5.1\",\n-                \"symfony/process\": \"^4.4|^5.1\",\n-                \"symplify/autowire-array-parameter\": \"^8.3.48\",\n-                \"symplify/composer-json-manipulator\": \"^8.3.48\",\n-                \"symplify/package-builder\": \"^8.3.48\",\n-                \"symplify/set-config-resolver\": \"^8.3.48\",\n-                \"symplify/smart-file-system\": \"^8.3.48\",\n-                \"symplify/symplify-kernel\": \"^8.3.48\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"bin\": [\n-                \"bin/monorepo-builder\"\n-            ],\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\MonorepoBuilder\\\\\": \"src\",\n-                    \"Symplify\\\\MonorepoBuilder\\\\Init\\\\\": \"packages/init/src\",\n-                    \"Symplify\\\\MonorepoBuilder\\\\Merge\\\\\": \"packages/merge/src\",\n-                    \"Symplify\\\\MonorepoBuilder\\\\Split\\\\\": \"packages/split/src\",\n-                    \"Symplify\\\\MonorepoBuilder\\\\Release\\\\\": \"packages/release/src\",\n-                    \"Symplify\\\\MonorepoBuilder\\\\Testing\\\\\": \"packages/testing/src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Not only Composer tools to build a Monorepo.\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symplify/monorepo-builder/tree/8.3.48\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://www.paypal.me/rectorphp\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/tomasvotruba\",\n-                    \"type\": \"github\"\n-                }\n-            ],\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n-        {\n-            \"name\": \"symplify/package-builder\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/package-builder.git\",\n-                \"reference\": \"d262d5c2043c669f145d3eabf7d8114ae64cf169\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/package-builder/zipball/d262d5c2043c669f145d3eabf7d8114ae64cf169\",\n-                \"reference\": \"d262d5c2043c669f145d3eabf7d8114ae64cf169\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"nette/finder\": \"^2.5\",\n-                \"nette/utils\": \"^3.0\",\n-                \"php\": \">=7.2\",\n-                \"symfony/config\": \"^4.4|^5.1\",\n-                \"symfony/console\": \"^4.4|^5.1\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.1\",\n-                \"symfony/finder\": \"^4.4|^5.1\",\n-                \"symfony/http-kernel\": \"^4.4|^5.1\",\n-                \"symfony/yaml\": \"^4.4|^5.1\",\n-                \"symplify/autowire-array-parameter\": \"^8.3.48\",\n-                \"symplify/symplify-kernel\": \"^8.3.48\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\PackageBuilder\\\\\": \"src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Dependency Injection, Console and Kernel toolkit for Symplify packages.\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symplify/package-builder/tree/8.3.48\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://www.paypal.me/rectorphp\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/tomasvotruba\",\n-                    \"type\": \"github\"\n-                }\n-            ],\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n-        {\n-            \"name\": \"symplify/set-config-resolver\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/set-config-resolver.git\",\n-                \"reference\": \"1333995e30b7acfa7c4378c5f85de1dd96226c93\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/set-config-resolver/zipball/1333995e30b7acfa7c4378c5f85de1dd96226c93\",\n-                \"reference\": \"1333995e30b7acfa7c4378c5f85de1dd96226c93\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"nette/utils\": \"^3.0\",\n-                \"php\": \">=7.2\",\n-                \"symfony/config\": \"^4.4|^5.1\",\n-                \"symfony/console\": \"^4.4|^5.1\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.1\",\n-                \"symfony/filesystem\": \"^4.4|^5.1\",\n-                \"symfony/finder\": \"^4.4|^5.1\",\n-                \"symfony/yaml\": \"^4.4|^5.1\",\n-                \"symplify/smart-file-system\": \"^8.3.48\",\n-                \"symplify/symplify-kernel\": \"^8.3.48\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\SetConfigResolver\\\\\": \"src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Resolve config and sets from configs and cli opptions for CLI applications\",\n-            \"support\": {\n-                \"issues\": \"https://github.com/symplify/set-config-resolver/issues\",\n-                \"source\": \"https://github.com/symplify/set-config-resolver/tree/8.3.48\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://www.paypal.me/rectorphp\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/tomasvotruba\",\n-                    \"type\": \"github\"\n-                }\n-            ],\n-            \"abandoned\": true,\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n-        {\n-            \"name\": \"symplify/smart-file-system\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/smart-file-system.git\",\n-                \"reference\": \"4146069c725b7c6e2f53924a151286f1e26c132f\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/smart-file-system/zipball/4146069c725b7c6e2f53924a151286f1e26c132f\",\n-                \"reference\": \"4146069c725b7c6e2f53924a151286f1e26c132f\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"nette/utils\": \"^3.0\",\n-                \"php\": \">=7.2\",\n-                \"symfony/filesystem\": \"^4.4|^5.1\",\n-                \"symfony/finder\": \"^4.4|^5.1\"\n-            },\n-            \"require-dev\": {\n-                \"nette/finder\": \"^2.5\",\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\SmartFileSystem\\\\\": \"src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Sanitized FileInfo with safe getRealPath() and other handy methods\",\n-            \"support\": {\n-                \"source\": \"https://github.com/symplify/smart-file-system/tree/8.3.48\"\n-            },\n-            \"funding\": [\n-                {\n-                    \"url\": \"https://www.paypal.me/rectorphp\",\n-                    \"type\": \"custom\"\n-                },\n-                {\n-                    \"url\": \"https://github.com/tomasvotruba\",\n-                    \"type\": \"github\"\n-                }\n-            ],\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n-        {\n-            \"name\": \"symplify/symplify-kernel\",\n-            \"version\": \"8.3.48\",\n-            \"source\": {\n-                \"type\": \"git\",\n-                \"url\": \"https://github.com/symplify/symplify-kernel.git\",\n-                \"reference\": \"c79dc6ce559b408c08e9fbc044f59cbb64961cf9\"\n-            },\n-            \"dist\": {\n-                \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/symplify/symplify-kernel/zipball/c79dc6ce559b408c08e9fbc044f59cbb64961cf9\",\n-                \"reference\": \"c79dc6ce559b408c08e9fbc044f59cbb64961cf9\",\n-                \"shasum\": \"\"\n-            },\n-            \"require\": {\n-                \"php\": \">=7.2\",\n-                \"symfony/console\": \"^4.4|^5.1\",\n-                \"symfony/dependency-injection\": \"^4.4|^5.1\",\n-                \"symfony/http-kernel\": \"^4.4|^5.1\",\n-                \"symplify/package-builder\": \"^8.3.48\",\n-                \"symplify/smart-file-system\": \"^8.3.48\"\n-            },\n-            \"require-dev\": {\n-                \"phpunit/phpunit\": \"^8.5|^9.0\"\n-            },\n-            \"type\": \"library\",\n-            \"extra\": {\n-                \"branch-alias\": {\n-                    \"dev-master\": \"8.4-dev\"\n-                }\n-            },\n-            \"autoload\": {\n-                \"psr-4\": {\n-                    \"Symplify\\\\SymplifyKernel\\\\\": \"src\"\n-                }\n-            },\n-            \"notification-url\": \"https://packagist.org/downloads/\",\n-            \"license\": [\n-                \"MIT\"\n-            ],\n-            \"description\": \"Internal Kernel for Symplify packages\",\n-            \"support\": {\n-                \"issues\": \"https://github.com/symplify/symplify-kernel/issues\",\n-                \"source\": \"https://github.com/symplify/symplify-kernel/tree/8.3.48\"\n-            },\n-            \"time\": \"2020-10-26T10:38:48+00:00\"\n-        },\n         {\n             \"name\": \"ticketswap/omnipay-przelewy24\",\n             \"version\": \"2.0\",\n@@ -14883,6 +13971,57 @@\n             ],\n             \"time\": \"2022-02-21T19:55:33+00:00\"\n         },\n+        {\n+            \"name\": \"phar-io/version\",\n+            \"version\": \"3.2.1\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/phar-io/version.git\",\n+                \"reference\": \"4f7fd7836c6f332bb2933569e566a0d6c4cbed74\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/phar-io/version/zipball/4f7fd7836c6f332bb2933569e566a0d6c4cbed74\",\n+                \"reference\": \"4f7fd7836c6f332bb2933569e566a0d6c4cbed74\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"php\": \"^7.2 || ^8.0\"\n+            },\n+            \"type\": \"library\",\n+            \"autoload\": {\n+                \"classmap\": [\n+                    \"src/\"\n+                ]\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"BSD-3-Clause\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"Arne Blankerts\",\n+                    \"email\": \"arne@blankerts.de\",\n+                    \"role\": \"Developer\"\n+                },\n+                {\n+                    \"name\": \"Sebastian Heuer\",\n+                    \"email\": \"sebastian@phpeople.de\",\n+                    \"role\": \"Developer\"\n+                },\n+                {\n+                    \"name\": \"Sebastian Bergmann\",\n+                    \"email\": \"sebastian@phpunit.de\",\n+                    \"role\": \"Developer\"\n+                }\n+            ],\n+            \"description\": \"Library for handling version information and constraints\",\n+            \"support\": {\n+                \"issues\": \"https://github.com/phar-io/version/issues\",\n+                \"source\": \"https://github.com/phar-io/version/tree/3.2.1\"\n+            },\n+            \"time\": \"2022-02-21T01:04:05+00:00\"\n+        },\n         {\n             \"name\": \"phpspec/prophecy\",\n             \"version\": \"dev-master\","
        },
        {
          "filename": "src/MicroweberPackages/Backup/Loggers/DefaultLogger.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -22,6 +22,11 @@ public static function clearLog()\n         file_put_contents($logFilePath, '');\n     }\n \n+    public static function getLog()\n+    {\n+        return file_get_contents(static::getLogFilepath());\n+    }\n+\n     public static function setLogInfo($log)\n     {\n "
        },
        {
          "filename": "src/MicroweberPackages/Import/DatabaseWriter.php",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -416,11 +416,9 @@ private function _finishUp($callFrom = '') {\n \n \t\tmw()->cache_manager->clear();\n \n-\n         $zipReader = new ZipReader();\n         $zipReader->clearCache();\n \n-\n         $this->logger->setLogInfo('Done!');\n \t}\n }"
        },
        {
          "filename": "src/MicroweberPackages/Import/Formats/ZipReader.php",
          "status": "modified",
          "additions": 38,
          "deletions": 3,
          "patch": "@@ -43,8 +43,39 @@ public function readData()\n \n             rmdir_recursive($backupLocation);\n \n-            $unzip = new Unzip();\n-            $unzip->extract($this->file, $backupLocation, true);\n+\n+           // $unzip = new Unzip();\n+          //  $unzip->extract($this->file, $backupLocation, true);\n+\n+            $allowPhpFilesUpload = config('microweber.allow_php_files_upload');\n+\n+            $zipArchive = new \\ZipArchive();\n+            $zipArchive->open($this->file);\n+            $selectedFilesForUnzip = [];\n+            for ($i = 0; $i < $zipArchive->numFiles; $i++) {\n+                $stat = $zipArchive->statIndex($i);\n+                $zipFileBasename = basename($stat['name']);\n+\n+                if ($allowPhpFilesUpload) {\n+                    $selectedFilesForUnzip[] = $zipFileBasename;\n+                    ImportLogger::setLogInfo('Unzipping queue '.$zipFileBasename.'...');\n+                } else {\n+                    $filesUtils = new \\MicroweberPackages\\Utils\\System\\Files();\n+                    $isDangerous = $filesUtils->is_dangerous_file($zipFileBasename);\n+                    if (!$isDangerous) {\n+                        $selectedFilesForUnzip[] = $zipFileBasename;\n+                        ImportLogger::setLogInfo('Unzipping queue '.$zipFileBasename.'...');\n+                    }\n+                }\n+            }\n+\n+            if (empty($selectedFilesForUnzip)) {\n+                ImportLogger::setLogInfo('The zip file has no files.');\n+                return;\n+            }\n+\n+            $zipArchive->extractTo($backupLocation, $selectedFilesForUnzip);\n+            $zipArchive->close();\n \n             ImportLogger::setLogInfo($backupLocation);\n         }\n@@ -67,7 +98,11 @@ public function readData()\n         }\n \n \t\tif ($backupLocation != false and is_dir($backupLocation)) {\n-\t\t\tImportLogger::setLogInfo('Media restored!');\n+\n+            if (is_dir($backupLocation . DS. 'userfiles' . DS.'media')) {\n+                ImportLogger::setLogInfo('Media restored!');\n+            }\n+\n \t\t\t$copy = $this->_cloneDirectory($backupLocation, userfiles_path());\n \t\t}\n "
        },
        {
          "filename": "src/MicroweberPackages/Import/tests/ReadersTest.php",
          "status": "added",
          "additions": 42,
          "deletions": 0,
          "patch": "@@ -0,0 +1,42 @@\n+<?php\n+namespace MicroweberPackages\\Import\\tests;\n+\n+use Illuminate\\Support\\Facades\\Config;\n+use MicroweberPackages\\Core\\tests\\TestCase;\n+use MicroweberPackages\\Import\\Formats\\ZipReader;\n+use MicroweberPackages\\Import\\Loggers\\ImportLogger;\n+\n+\n+/**\n+ * Run test\n+ * @author Bobi Microweber\n+ * @command php phpunit.phar --filter Import\n+ */\n+\n+class ReadersTest extends TestCase\n+{\n+\tpublic function testZipReader() {\n+\n+        ImportLogger::clearLog();\n+        $zip = new ZipReader(__DIR__ . DS. 'strange-file.zip');\n+        $zip->readData();\n+        $zip->clearCache();\n+        $log = ImportLogger::getLog();\n+\n+        $this->assertTrue((strpos($log, 'The zip file has no files.')!==false));\n+\n+\n+        ImportLogger::clearLog();\n+        Config::set('microweber.allow_php_files_upload', true);\n+\n+        $zip = new ZipReader(__DIR__ . DS. 'strange-file.zip');\n+        $zip->readData();\n+        $zip->clearCache();\n+\n+        $log = ImportLogger::getLog();\n+\n+        $this->assertTrue((strpos($log, 'queue strange-file.php')!==false));\n+        $this->assertTrue((strpos($log, 'no files to import')!==false));\n+\n+    }\n+}"
        },
        {
          "filename": "src/MicroweberPackages/Import/tests/strange-file.zip",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "userfiles/modules/admin/backup/backup_modal.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -102,6 +102,7 @@\n                 </div>\n             </div>\n \n+            <?php if (config('microweber.allow_php_files_upload')): ?>\n             <div class=\"card style-1 mb-3 card-collapse\">\n                 <div class=\"card-header no-border cursor-pointer\" data-toggle=\"collapse\" data-target=\"#include-modules\">\n                     <h6><i class=\"mdi mdi-view-grid-plus text-primary mr-2\"></i> <strong><?php _e(\"Include Modules\"); ?></strong></h6>\n@@ -153,8 +154,8 @@\n                     </div>\n                 </div>\n             </div>\n-\n-\n+            <?php endif; ?>\n+            \n             <label class=\"mw-ui-check\">\n                 <input type=\"checkbox\" class=\"js-include-media\" name=\"include_media\" value=\"1\">\n                 <span></span><span>Include media files</span>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 6,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d4e8c4a13967ac9856c3e1179d4185e59b8d9311",
            "date": "2024-11-26T15:08:46Z",
            "author_login": "peter-mw"
          },
          {
            "sha": "9a701a997a4041f040b00d989b19e446c34419e5",
            "date": "2024-06-26T12:33:18Z",
            "author_login": "Radanovn"
          },
          {
            "sha": "5851e060318fb8065a478df6b63b335b1d3a52c2",
            "date": "2024-06-26T11:34:21Z",
            "author_login": "Radanovn"
          },
          {
            "sha": "7c37d77e617d35cdefdcaf96c7a18a33a9758289",
            "date": "2024-06-26T11:14:53Z",
            "author_login": "Radanovn"
          },
          {
            "sha": "eff6fadcadd749e8f4295bec99bf173d2401f3ac",
            "date": "2024-06-26T11:11:53Z",
            "author_login": "Radanovn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.7,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-94",
    "description": "Abusing Backup/Restore feature to achieve Remote Code Execution in GitHub repository microweber/microweber prior to 1.2.12.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-03-11T18:15:29.137",
    "last_modified": "2024-11-21T06:39:40.377",
    "fix_date": "2022-03-11T09:49:04Z"
  },
  "references": [
    {
      "url": "https://github.com/microweber/microweber/commit/867bdda1b4660b0795ad7f87ab5abe9e44b2b318",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/e368be37-1cb4-4292-8d48-07132725f622",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/microweber/microweber/commit/867bdda1b4660b0795ad7f87ab5abe9e44b2b318",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/e368be37-1cb4-4292-8d48-07132725f622",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:01.989848",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "microweber",
    "owner": "microweber",
    "created_at": "2010-10-07T09:04:43Z",
    "updated_at": "2025-01-13T15:04:29Z",
    "pushed_at": "2025-01-14T13:26:48Z",
    "size": 1026007,
    "stars": 3170,
    "forks": 887,
    "open_issues": 360,
    "watchers": 3170,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 12566636,
      "PHP": 11976208,
      "JavaScript": 8696748,
      "CSS": 3597687,
      "SCSS": 2178754,
      "Blade": 1663671,
      "Less": 518400,
      "Hack": 476030,
      "MDX": 387317,
      "Vue": 344860,
      "Ruby": 12504,
      "OCaml": 4815,
      "Dockerfile": 1548,
      "CoffeeScript": 950,
      "Batchfile": 61,
      "Shell": 59,
      "Sass": 1
    },
    "commit_activity": {
      "total_commits_last_year": 1332,
      "avg_commits_per_week": 25.615384615384617,
      "days_active_last_year": 106
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:59:40.368111"
  }
}