{
  "cve_id": "CVE-2022-0935",
  "github_data": {
    "repository": "livehelperchat/livehelperchat",
    "fix_commit": "ce96791cb4c7420266b668fc234c211914259ba7",
    "related_commits": [
      "ce96791cb4c7420266b668fc234c211914259ba7",
      "ce96791cb4c7420266b668fc234c211914259ba7"
    ],
    "patch_url": "https://github.com/livehelperchat/livehelperchat/commit/ce96791cb4c7420266b668fc234c211914259ba7.patch",
    "fix_commit_details": {
      "sha": "ce96791cb4c7420266b668fc234c211914259ba7",
      "commit_date": "2022-04-06T10:07:00Z",
      "author": {
        "login": "remdex",
        "type": "User",
        "stats": {
          "total_commits": 8009,
          "average_weekly_commits": 12.652448657187994,
          "total_additions": 4588709,
          "total_deletions": 2955518,
          "weeks_active": 586
        }
      },
      "commit_message": {
        "title": "Migrate to static HTTP_HOST (#1754)",
        "length": 97,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 475,
        "additions": 262,
        "deletions": 213
      },
      "files": [
        {
          "filename": "lhc_web/cli/lib/install.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1267,9 +1267,9 @@ function step3() {\n                   PRIMARY KEY (`identifier`)\n                 ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n \n-            $randomHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n+            $randomHash = erLhcoreClassModelForgotPassword::randomPassword(80);\n             $randomHashLength = strlen($randomHash);\n-            $exportHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n+            $exportHash = erLhcoreClassModelForgotPassword::randomPassword(80);\n \n             if (extension_loaded('bcmath')){\n                 $geoRow = \"('geo_data','a:5:{i:0;b:0;s:21:\\\"geo_detection_enabled\\\";i:1;s:22:\\\"geo_service_identifier\\\";s:8:\\\"max_mind\\\";s:23:\\\"max_mind_detection_type\\\";s:7:\\\"country\\\";s:22:\\\"max_mind_city_location\\\";s:37:\\\"var/external/geoip/GeoLite2-City.mmdb\\\";}',0,'',1)\";"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhbrowseoffer/getstatus.tpl.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -54,7 +54,7 @@\n         var th = document.getElementsByTagName('head')[0];\r\n         var s = document.createElement('script');\r\n         s.setAttribute('type','text/javascript');\r\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('browseoffer/widgetclosed')?>/<?php echo $invite->hash?>');\r\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('browseoffer/widgetclosed')?>/<?php echo $invite->hash?>');\r\n         th.appendChild(s);\r\n         this.removeById('lhc_container_browseoffer');\r\n         this.removeById('lhc_browseoffer-bg');\r\n@@ -73,7 +73,7 @@\n \t\t\r\n    \t\t  <?php if ($invite->custom_iframe_url != '' || $invite->lhc_iframe_content == 1) : ?>\r\n    \t\t  this.iframe_html = '<iframe id=\"lhcbrowseoffer_iframe\" allowTransparency=\"true\" scrolling=\"no\" frameborder=\"0\" ' +\r\n-                       ' src=\"<?php if ($invite->custom_iframe_url != '') : ?><?php echo $invite->custom_iframe_url ?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('browseoffer/widget')?>/<?php echo $invite->hash?><?php endif;?>\"' +                    \r\n+                       ' src=\"<?php if ($invite->custom_iframe_url != '') : ?><?php echo $invite->custom_iframe_url ?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('browseoffer/widget')?>/<?php echo $invite->hash?><?php endif;?>\"' +\r\n                        ' style=\"width: 100%; height: <?php echo $size_height?>px;\"></iframe>';\r\n          <?php else : ?>\r\n          this.iframe_html = \"<div id=\\\"lhcbrowseoffer_content\\\">\"+<?php echo json_encode($invite->content)?>+\"</div>\";\r\n@@ -102,7 +102,7 @@\n          var th = document.getElementsByTagName('head')[0];\r\n          var s = document.createElement('script');\r\n          s.setAttribute('type','text/javascript');\r\n-         s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('browseoffer/addhit')?>/<?php echo $invite->hash?>');\r\n+         s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('browseoffer/addhit')?>/<?php echo $invite->hash?>');\r\n          th.appendChild(s);\r\n          \r\n          if (<?php echo $browseofferOptionsVariable;?>.openCallback) {\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhbrowseoffer/htmlcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -96,7 +96,7 @@ function generateEmbedCode(){\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n         'var referrer = (document.referrer) ? encodeURIComponent(document.referrer.substr(document.referrer.indexOf(\\'://\\')+1)) : \\'\\';'+\"\\n\"+\n         'var location  = (document.location) ? encodeURIComponent(window.location.href.substring(window.location.protocol.length)) : \\'\\';'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'browseoffer/getstatus'+size+id_size_height+topposition+id_timeout+id_show_overlay+id_identifier+id_canreopen+'?r=\\'+referrer+\\'&l=\\'+location;'+\"\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'browseoffer/getstatus'+size+id_size_height+topposition+id_timeout+id_show_overlay+id_identifier+id_canreopen+'?r=\\'+referrer+\\'&l=\\'+location;'+\"\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/chat_tabs/information_rows/id.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n <?php if (isset($orderInformation['id']['enabled']) && $orderInformation['id']['enabled'] == true) : ?>\r\n <div class=\"col-6 pb-1\">\r\n-    <span class=\"material-icons user-select-none\">vpn_key</span><span><?php echo $chat->id;?></span><button data-success=\"Copied\" class=\"ml-1 btn btn-xs btn-link text-muted py-1\" data-copy=\"<?php echo (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] ?><?php echo erLhcoreClassDesign::baseurl('front/default')?>/(cid)/<?php echo $chat->id?>/#!#chat-id-<?php echo $chat->id?>\" onclick=\"lhinst.copyContent($(this))\" type=\"button\"><i class=\"material-icons\">link</i>Copy link</button>\r\n+    <span class=\"material-icons user-select-none\">vpn_key</span><span><?php echo $chat->id;?></span><button data-success=\"Copied\" class=\"ml-1 btn btn-xs btn-link text-muted py-1\" data-copy=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('front/default')?>/(cid)/<?php echo $chat->id?>/#!#chat-id-<?php echo $chat->id?>\" onclick=\"lhinst.copyContent($(this))\" type=\"button\"><i class=\"material-icons\">link</i>Copy link</button>\r\n </div>\r\n <?php endif; ?>\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/chatcheckoperatormessage.tpl.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -11,15 +11,15 @@\n     setTimeout(function() {\n     <?php endif; ?>\n \n-        var invitationURL =  '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $tag !== false ? print '/(tag)/' . $tag : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>';\n+        var invitationURL =  '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $tag !== false ? print '/(tag)/' . $tag : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>';\n \n         <?php if (isset($visitor->invitation->design_data_array['mobile_html']) && $visitor->invitation->design_data_array['mobile_html'] != '') : ?>\n \n             <?php if (isset($visitor->invitation->design_data_array['mobile_style']) && $visitor->invitation->design_data_array['mobile_style'] != '') : ?>\n                 <?php\n                     $replaceStyleArray = array();\n                     for ($i = 1; $i < 5; $i++) {\n-                        $replaceStyleArray['{proactive_img_' . $i . '}'] =  erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value . '//' . $_SERVER['HTTP_HOST'] . $visitor->invitation->{'design_data_img_' . $i . '_url'};\n+                        $replaceStyleArray['{proactive_img_' . $i . '}'] = erLhcoreClassSystem::getHost() . $visitor->invitation->{'design_data_img_' . $i . '_url'};\n                     }\n                 ?>\n                 <?php\n@@ -55,7 +55,7 @@\n             <?php if ($visitor->invitation instanceof erLhAbstractModelProactiveChatInvitation && (($visitor->invitation_assigned == false && $visitor->invitation->delay > 0) || $visitor->invitation->delay_init > 0)) : ?>\n                 setTimeout(function() {\n             <?php endif; ?>\n-            var urlInvitation = '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $tag !== false ? print '/(tag)/' . $tag : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>';\n+            var urlInvitation = '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $tag !== false ? print '/(tag)/' . $tag : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>';\n             <?php if ($visitor->invitation instanceof erLhAbstractModelProactiveChatInvitation && isset($visitor->invitation->design_data_array['api_do_not_show']) && $visitor->invitation->design_data_array['api_do_not_show'] == 1) : ?>\n                 lh_inst.showBasicInvitation(urlInvitation);\n             <?php else : ?>"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getmessagesnippet/operator_profile.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n         <?php if ($user->has_photo) : ?>\n             <img width=\"20\" height=\"20\" src=\"<?php echo $user->photo_path?>\" alt=\"<?php echo htmlspecialchars($user->name_support)?>\" />\n         <?php else : ?>\n-            <img width=\"20\" height=\"20\" src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($user->avatar)?>\" alt=\"<?php echo htmlspecialchars($user->name_support)?>\" />\n+            <img width=\"20\" height=\"20\" src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($user->avatar)?>\" alt=\"<?php echo htmlspecialchars($user->name_support)?>\" />\n         <?php endif; ?>\n     <?php else : ?>\n         <i class=\"icon-assistant material-icons mr-0\"><?php if (isset($react) && $react === true) : ?>&#xf10d;<?php else : ?>account_box<?php endif; ?></i>"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus.tpl.php",
          "status": "modified",
          "additions": 18,
          "deletions": 18,
          "patch": "@@ -51,7 +51,7 @@\n \tis_full_height : <?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ? 'true' : 'false' ?>,\n \tonline_tracked : false,\n     urlopen : function(){\n-    \treturn \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/chat/startchat<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?>\"+this.survey_id;\n+    \treturn \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/chat/startchat<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?>\"+this.survey_id;\n     },\n \t<?php include(erLhcoreClassDesign::designtpl('lhchat/getstatus/custom_get_status_lh_inst_js.tpl.php')); ?>\n     hasSurvey : <?php echo $survey !== false ? 'true ': 'false'?>,\n@@ -266,7 +266,7 @@\n             var th = document.getElementsByTagName('head')[0];\n             var s = document.createElement('script');\n             s.setAttribute('type','text/javascript');\n-            s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/chatwidgetclosed'+this.getAppendCookieArguments()+'?ts='+Date.now());\n+            s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/chatwidgetclosed'+this.getAppendCookieArguments()+'?ts='+Date.now());\n             th.appendChild(s);\n             this.toggleStatusWidget(false);\n \n@@ -593,7 +593,7 @@\n \n     updateAttribute : function(attributes) {\n         var xhr = new XMLHttpRequest();\n-        xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/updateattribute'+this.getAppendCookieArguments(), true);\n+        xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/updateattribute'+this.getAppendCookieArguments(), true);\n      \txhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n      \txhr.send( \"data=\" + encodeURIComponent( this.JSON.stringify(attributes) ) );\n     },\n@@ -610,7 +610,7 @@\n             var s = document.createElement('script');\n             s.setAttribute('id','lhc_operator_message');\n             s.setAttribute('type','text/javascript');\n-            s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/chat/chatcheckoperatormessage<?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $identifier !== false ? print '/(identifier)/'.htmlspecialchars($identifier) : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?>/(vid)/'+vid + lh_inst.survey_id + '/(uactiv)/'+lh_inst.userActive+'/(wopen)/'+lh_inst.timeoutStatusWidgetOpen+dynamic+'?l='+locationCurrent+inst.tag+'&dt='+encodeURIComponent(document.title)+'&ts='+Date.now());\n+            s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/chat/chatcheckoperatormessage<?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $identifier !== false ? print '/(identifier)/'.htmlspecialchars($identifier) : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?>/(vid)/'+vid + lh_inst.survey_id + '/(uactiv)/'+lh_inst.userActive+'/(wopen)/'+lh_inst.timeoutStatusWidgetOpen+dynamic+'?l='+locationCurrent+inst.tag+'&dt='+encodeURIComponent(document.title)+'&ts='+Date.now());\n             th.appendChild(s);\n             lh_inst.startNewMessageCheck();\n         }, <?php echo (int)(erLhcoreClassModelChatConfig::fetch('sync_sound_settings')->data['check_for_operator_msg']*1000); ?> );*/ ?>\n@@ -652,7 +652,7 @@\n \n             s.setAttribute('id','lhc_operator_message');\n             s.setAttribute('type','text/javascript');\n-            s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/chatcheckoperatormessage<?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $identifier !== false ? print '/(identifier)/'.htmlspecialchars($identifier) : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?>/(tz)/' + tzOffset + this.survey_id + '/(count_page)/1/(vid)/'+vid+'/(uactiv)/'+lh_inst.userActive+'/(wopen)/'+lh_inst.timeoutStatusWidgetOpen+dynamic+'?l='+locationCurrent+this.tag+this.parseStorageArguments()+this.parseOptionsOnline()+this.parseOptions()+'&dt='+encodeURIComponent(document.title)+'&ts='+Date.now());\n+            s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/chatcheckoperatormessage<?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $identifier !== false ? print '/(identifier)/'.htmlspecialchars($identifier) : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?>/(tz)/' + tzOffset + this.survey_id + '/(count_page)/1/(vid)/'+vid+'/(uactiv)/'+lh_inst.userActive+'/(wopen)/'+lh_inst.timeoutStatusWidgetOpen+dynamic+'?l='+locationCurrent+this.tag+this.parseStorageArguments()+this.parseOptionsOnline()+this.parseOptions()+'&dt='+encodeURIComponent(document.title)+'&ts='+Date.now());\n             th.appendChild(s);\n         }\n     },\n@@ -665,13 +665,13 @@\n         var tzOffset = this.getTzOffset();\n         s.setAttribute('id','lhc_log_pageview');\n         s.setAttribute('type','text/javascript');\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/logpageview<?php $department !== false ? print '/(department)/'.$department : ''?><?php $identifier !== false ? print '/(identifier)/'.htmlspecialchars($identifier) : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>/(tz)/'+tzOffset+'/(vid)/' + vid + this.survey_id + '/(uactiv)/'+lh_inst.userActive+'/(wopen)/'+lh_inst.timeoutStatusWidgetOpen+'?l='+locationCurrent+this.parseStorageArguments()+this.parseOptionsOnline()+'&dt='+encodeURIComponent(document.title)+'&ts='+Date.now());\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/logpageview<?php $department !== false ? print '/(department)/'.$department : ''?><?php $identifier !== false ? print '/(identifier)/'.htmlspecialchars($identifier) : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>/(tz)/'+tzOffset+'/(vid)/' + vid + this.survey_id + '/(uactiv)/'+lh_inst.userActive+'/(wopen)/'+lh_inst.timeoutStatusWidgetOpen+'?l='+locationCurrent+this.parseStorageArguments()+this.parseOptionsOnline()+'&dt='+encodeURIComponent(document.title)+'&ts='+Date.now());\n         th.appendChild(s);\n     },\n \n     updateJSVars : function(vars){\n         var xhr = new XMLHttpRequest();\n-        xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/updatejsvars'+this.getAppendCookieArguments(), true);\n+        xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/updatejsvars'+this.getAppendCookieArguments(), true);\n         xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n         xhr.send( \"data=\" + encodeURIComponent( this.JSON.stringify(vars) ) );\n     },\n@@ -680,7 +680,7 @@\n         if (typeof <?php echo $chatOptionsVariable?>.events != 'undefined') {\n             if (<?php echo $chatOptionsVariable?>.events.length > 0) {\n                  var xhr = new XMLHttpRequest();\n-                 xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/logevent'+this.getAppendCookieArguments(), true);\n+                 xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/logevent'+this.getAppendCookieArguments(), true);\n              \t xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n              \t xhr.send( \"data=\" + encodeURIComponent( this.JSON.stringify(<?php echo $chatOptionsVariable?>.events) ) );\n              \t <?php echo $chatOptionsVariable?>.events = new Array();\n@@ -724,7 +724,7 @@\n             this.cookieDataPers['ex'] = Math.round(Date.now()/100000000)+10;\n             this.storePersistenCookie();\n             var xhr = new XMLHttpRequest();\n-            xhr.open( \"GET\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/extendcookie/'+this.cookieDataPers.vid, true);\n+            xhr.open( \"GET\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/extendcookie/'+this.cookieDataPers.vid, true);\n             xhr.send();\n         }\n     },\n@@ -746,7 +746,7 @@\n \t\t\t\tvar inst = this;\n \t\t\t\tsetTimeout(function(){\n \t\t\t\t\tvar xhr = new XMLHttpRequest();\n-\t\t\t        xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+inst.lang+'/chat/setnewvid', true);\n+\t\t\t        xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+inst.lang+'/chat/setnewvid', true);\n \t\t\t     \txhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n \t\t\t     \txhr.send( \"data=\" + encodeURIComponent( inst.JSON.stringify({'vid':old,'new':vid}) ) );\n \t\t\t\t},1000);\n@@ -809,7 +809,7 @@\n \t\t   \t\tvar th = document.getElementsByTagName('head')[0];\n \t\t        var s = document.createElement('script');\n \t\t        s.setAttribute('type','text/javascript');\n-\t\t        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('js/html2canvas.min.js');?>');\n+\t\t        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('js/html2canvas.min.js');?>');\n \t\t        th.appendChild(s);\n \t\t        s.onreadystatechange = s.onload = function(){\n \t\t        \tinst.makeScreenshot();\n@@ -819,7 +819,7 @@\n \t\t\t\t  \thtml2canvas(document.body, {\n \t\t\t\t\t\t  onrendered: function(canvas) {\n \t\t\t\t\t\t         var xhr = new XMLHttpRequest();\n-\t\t\t\t\t\t         xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/file/storescreenshot'+inst.getAppendCookieArguments(), true);\n+\t\t\t\t\t\t         xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/file/storescreenshot'+inst.getAppendCookieArguments(), true);\n \t\t\t\t\t\t\t     xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n \t\t\t\t\t\t\t     xhr.send( \"data=\" + encodeURIComponent( canvas.toDataURL() ) );\n \t\t\t\t\t\t  }\n@@ -843,7 +843,7 @@\n         var tzOffset = this.getTzOffset();\n         s.setAttribute('id','lhc_finish_shr');\n         s.setAttribute('type','text/javascript');\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/cobrowse/finishsession/(sharemode)/'+lh_inst.sharemode+lh_inst.getAppendCookieArguments());\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/cobrowse/finishsession/(sharemode)/'+lh_inst.sharemode+lh_inst.getAppendCookieArguments());\n         th.appendChild(s);\n         this.cobrowser = null;\n     },\n@@ -863,7 +863,7 @@\n \t\t\t   \t\tvar th = document.getElementsByTagName('head')[0];\n \t\t\t        var s = document.createElement('script');\n \t\t\t        s.setAttribute('type','text/javascript');\n-\t\t\t        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::designJS('js/cobrowse/compiled/cobrowse.visitor.min.js');?>');\n+\t\t\t        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::designJS('js/cobrowse/compiled/cobrowse.visitor.min.js');?>');\n \t\t\t        th.appendChild(s);\n \t\t\t        s.onreadystatechange = s.onload = function(){\n \t\t\t        \tinst.startCoBrowse(inst.sharehash,this.sharemode);\n@@ -969,7 +969,7 @@\n         var s = document.createElement('script');\n         s.setAttribute('id','lhc_check_status');\n         s.setAttribute('type','text/javascript');\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/chatcheckstatus<?php $department !== false ? print '/(department)/'.$department : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?php $disable_online_tracking === true ? print '/(dot)/true' : ''?><?php $hide_offline == 'true' ? print '/(hide_offline)/true' : ''?>/(status)/' + this.isOnline + this.survey_id + (this.cookieDataPers.vid ? '/(vid)/'+this.cookieDataPers.vid : '')+ hashAppend + hashResume + '/(uactiv)/'+this.userActive+'/(wopen)/'+this.timeoutStatusWidgetOpen + '/(uaction)/'+sender+'/(isproactive)/'+this.isProactivePending+'/?ts='+Date.now());\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/chatcheckstatus<?php $department !== false ? print '/(department)/'.$department : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?php $disable_online_tracking === true ? print '/(dot)/true' : ''?><?php $hide_offline == 'true' ? print '/(hide_offline)/true' : ''?>/(status)/' + this.isOnline + this.survey_id + (this.cookieDataPers.vid ? '/(vid)/'+this.cookieDataPers.vid : '')+ hashAppend + hashResume + '/(uactiv)/'+this.userActive+'/(wopen)/'+this.timeoutStatusWidgetOpen + '/(uaction)/'+sender+'/(isproactive)/'+this.isProactivePending+'/?ts='+Date.now());\n         th.appendChild(s);\n     },\n \n@@ -986,7 +986,7 @@\n \n     refreshCustomFields : function() {\n         var xhr = new XMLHttpRequest();\n-        xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/chat/refreshcustomfields'+this.getAppendCookieArguments() , true);\n+        xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/chat/refreshcustomfields'+this.getAppendCookieArguments() , true);\n \t    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n \t    xhr.send(this.parseOptions());\n     },\n@@ -1032,7 +1032,7 @@\n         var s = document.createElement('script');\n         s.setAttribute('type','text/javascript');\n         var optionsParts = options.split('_');\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/htmlsnippet/'+messageId+'/'+optionsParts[0]+\"/\"+optionsParts[1]+'<?php $department !== false ? print '/(department)/'.$department : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?php $disable_online_tracking === true ? print '/(dot)/true' : ''?><?php $hide_offline == 'true' ? print '/(hide_offline)/true' : ''?>/(status)/' + this.isOnline + this.survey_id + (this.cookieDataPers.vid ? '/(vid)/'+this.cookieDataPers.vid : '')+ hashAppend + hashResume + '/(uactiv)/'+this.userActive+'/(wopen)/'+this.timeoutStatusWidgetOpen + '/(isproactive)/'+this.isProactivePending+'/?ts='+Date.now());\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+this.lang+'/chat/htmlsnippet/'+messageId+'/'+optionsParts[0]+\"/\"+optionsParts[1]+'<?php $department !== false ? print '/(department)/'.$department : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?><?php $disable_online_tracking === true ? print '/(dot)/true' : ''?><?php $hide_offline == 'true' ? print '/(hide_offline)/true' : ''?>/(status)/' + this.isOnline + this.survey_id + (this.cookieDataPers.vid ? '/(vid)/'+this.cookieDataPers.vid : '')+ hashAppend + hashResume + '/(uactiv)/'+this.userActive+'/(wopen)/'+this.timeoutStatusWidgetOpen + '/(isproactive)/'+this.isProactivePending+'/?ts='+Date.now());\n         th.appendChild(s);\n     },\n \n@@ -1045,7 +1045,7 @@\n \n         // We allow to send events only from chat installation or page where script is embeded.\n         if (\n-            originDomain !== '<?php echo $_SERVER['HTTP_HOST']?>' &&\n+            originDomain !== '<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?>' &&\n             originDomain !== document.domain &&\n             action != 'lhc_sizing_chat_survey' &&\n             action != 'lh_survey_runed' &&"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/container.tpl.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -8,15 +8,15 @@\n ?>\n <?php if ($theme !== false && $theme->modern_look == 0) : ?>\n this.iframe_html = '<div id=\"<?php echo $chatCSSLayoutOptions['container_id']?>\" <?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ? 'style=\"height:100%\"' : '' ?>>' +\n-    '<?php if ($theme !== false && isset($theme->bot_configuration_array['custom_html_header'])) : ?><?php echo str_replace(array(\"\\n\",\"\\r\"), '',$theme->bot_configuration_array['custom_html_header'])?><?php endif?><div id=\"<?php echo $chatCSSPrefix?>_header\"><?php if ($theme !== false && isset($theme->bot_configuration_array['custom_html_header_body'])) : ?><?php echo str_replace(array(\"\\n\",\"\\r\"), '',$theme->bot_configuration_array['custom_html_header_body'])?><?php endif?><?php if ($theme === false || $theme->hide_close == 0) : ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"<?php echo $chatCSSPrefix?>_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a><?php endif;?><?php if (erLhcoreClassModelChatConfig::fetch('disable_popup_restore')->current_value == 0 && ($theme === false || $theme->hide_popup == 0)) : ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" id=\"<?php echo $chatCSSPrefix?>_remote_window\"><img src=\"<?php if ($theme !== false && $theme->popup_image_url != '') : ?><?php echo $theme->popup_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/application_double.png');?><?php endif;?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" /></a><?php endif; ?><a href=\"#\" id=\"<?php echo $chatCSSPrefix?>_min\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Minimize/Restore')?>\"></a><i title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','New messages')?>\" id=\"<?php echo $chatCSSPrefix?>-msg-number\"></i></div>' +\n+    '<?php if ($theme !== false && isset($theme->bot_configuration_array['custom_html_header'])) : ?><?php echo str_replace(array(\"\\n\",\"\\r\"), '',$theme->bot_configuration_array['custom_html_header'])?><?php endif?><div id=\"<?php echo $chatCSSPrefix?>_header\"><?php if ($theme !== false && isset($theme->bot_configuration_array['custom_html_header_body'])) : ?><?php echo str_replace(array(\"\\n\",\"\\r\"), '',$theme->bot_configuration_array['custom_html_header_body'])?><?php endif?><?php if ($theme === false || $theme->hide_close == 0) : ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"<?php echo $chatCSSPrefix?>_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a><?php endif;?><?php if (erLhcoreClassModelChatConfig::fetch('disable_popup_restore')->current_value == 0 && ($theme === false || $theme->hide_popup == 0)) : ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" id=\"<?php echo $chatCSSPrefix?>_remote_window\"><img src=\"<?php if ($theme !== false && $theme->popup_image_url != '') : ?><?php echo $theme->popup_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/application_double.png');?><?php endif;?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" /></a><?php endif; ?><a href=\"#\" id=\"<?php echo $chatCSSPrefix?>_min\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Minimize/Restore')?>\"></a><i title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','New messages')?>\" id=\"<?php echo $chatCSSPrefix?>-msg-number\"></i></div>' +\n     this.iframe_html + '</div>';\n-raw_css = \"#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min {overflow:hidden}#<?php echo $chatCSSPrefix?>_remote_window{padding-left:5px;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header{min-width:107px} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_iframe_container{display:none} .<?php echo $chatCSSPrefix?>-no-transition{ -webkit-transition: none !important; -moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed{visibility:hidden;position: fixed;left: -90000px!important;right: auto!important;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed .<?php echo $chatCSSPrefix?>-cf{display:none}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> * {line-height:100%;direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;line-height:100%;box-sizing: content-box;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> img {border:0;}\\n#<?php echo $chatCSSPrefix?>_header{position:relative;z-index:2147483640;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '17' ?>px;overflow:hidden;text-align:right;clear:both;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}#<?php echo $chatCSSPrefix?>-msg-number{float: left;color: #FFF;font-size: 12px;font-weight: bold;padding-left: 5px;line-height: 20px;} \\n#<?php echo $chatCSSPrefix?>_min{float:left;padding:2px;}#<?php echo $chatCSSPrefix?>_remote_window,#<?php echo $chatCSSPrefix?>_close{padding:2px;float:right;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_min:before{content:url(<?php if ($theme !== false && $theme->restore_image_url != '') : ?><?php echo $theme->restore_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/restore.png');?><?php endif;?>)}#<?php echo $chatCSSPrefix?>_min:before{content: url('<?php if ($theme !== false && $theme->minimize_image_url != '') : ?><?php echo $theme->minimize_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/min.png');?><?php endif;?>'); position: relative;left:0;top;0} #<?php echo $chatCSSPrefix?>_min{width:14px;height:14px;}\\n#<?php echo $chatCSSPrefix?>_close:hover,#<?php echo $chatCSSPrefix?>_min:hover,#<?php echo $chatCSSPrefix?>_remote_window:hover{opacity:0.4;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> {background-color:#FFF;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab;max-height: 100%;overflow: auto;\\nz-index:2147483640;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; }\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{position:relative;display:block;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe.<?php echo $chatCSSPrefix?>-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n@media only screen and (max-device-width : <?php ($theme !== false && $theme->widget_response_width > 0) ? print $theme->widget_response_width : print 992?>px) { .<?php echo $chatCSSPrefix?>-opened{position: fixed; overflow: hidden; right: 0px; left: 0px; top: 0px; bottom: 0px;} #<?php echo $chatCSSPrefix?>_header{height:30px;} #<?php echo $chatCSSPrefix?>_header a{padding:7px;}#<?php echo $chatCSSLayoutOptions['container_id']?>{position:fixed;left:0!important;right:0!important;bottom:0!important;top:0!important;border:0;border-radius:0}#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:0;height: calc(100% - 40px)}#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{width:100% !important;height: 100%!important} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header a{padding:2px;} #<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min{<?php echo $currentPosition['mobile_position']?>}}\";\n+raw_css = \"#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min {overflow:hidden}#<?php echo $chatCSSPrefix?>_remote_window{padding-left:5px;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header{min-width:107px} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_iframe_container{display:none} .<?php echo $chatCSSPrefix?>-no-transition{ -webkit-transition: none !important; -moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed{visibility:hidden;position: fixed;left: -90000px!important;right: auto!important;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed .<?php echo $chatCSSPrefix?>-cf{display:none}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> * {line-height:100%;direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;line-height:100%;box-sizing: content-box;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> img {border:0;}\\n#<?php echo $chatCSSPrefix?>_header{position:relative;z-index:2147483640;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '17' ?>px;overflow:hidden;text-align:right;clear:both;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}#<?php echo $chatCSSPrefix?>-msg-number{float: left;color: #FFF;font-size: 12px;font-weight: bold;padding-left: 5px;line-height: 20px;} \\n#<?php echo $chatCSSPrefix?>_min{float:left;padding:2px;}#<?php echo $chatCSSPrefix?>_remote_window,#<?php echo $chatCSSPrefix?>_close{padding:2px;float:right;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_min:before{content:url(<?php if ($theme !== false && $theme->restore_image_url != '') : ?><?php echo $theme->restore_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/restore.png');?><?php endif;?>)}#<?php echo $chatCSSPrefix?>_min:before{content: url('<?php if ($theme !== false && $theme->minimize_image_url != '') : ?><?php echo $theme->minimize_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/min.png');?><?php endif;?>'); position: relative;left:0;top;0} #<?php echo $chatCSSPrefix?>_min{width:14px;height:14px;}\\n#<?php echo $chatCSSPrefix?>_close:hover,#<?php echo $chatCSSPrefix?>_min:hover,#<?php echo $chatCSSPrefix?>_remote_window:hover{opacity:0.4;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> {background-color:#FFF;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab;max-height: 100%;overflow: auto;\\nz-index:2147483640;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; }\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{position:relative;display:block;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe.<?php echo $chatCSSPrefix?>-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n@media only screen and (max-device-width : <?php ($theme !== false && $theme->widget_response_width > 0) ? print $theme->widget_response_width : print 992?>px) { .<?php echo $chatCSSPrefix?>-opened{position: fixed; overflow: hidden; right: 0px; left: 0px; top: 0px; bottom: 0px;} #<?php echo $chatCSSPrefix?>_header{height:30px;} #<?php echo $chatCSSPrefix?>_header a{padding:7px;}#<?php echo $chatCSSLayoutOptions['container_id']?>{position:fixed;left:0!important;right:0!important;bottom:0!important;top:0!important;border:0;border-radius:0}#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:0;height: calc(100% - 40px)}#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{width:100% !important;height: 100%!important} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header a{padding:2px;} #<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min{<?php echo $currentPosition['mobile_position']?>}}\";\n <?php else : ?>\n this.iframe_html = '<div id=\"<?php echo $chatCSSLayoutOptions['container_id']?>\" <?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ? 'style=\"height:100%\"' : '' ?>>' +\n                               '<a class=\"status-icon ' +\n                               (this.isOnline == true ? 'online-status-icon' : 'offline-status-icon') +\n-                              '\" id=\"<?php echo $chatCSSPrefix?>_status-icon-restore\" href=\"#\" ><i title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','New messages')?>\" id=\"<?php echo $chatCSSPrefix?>-msg-number\"></i></a><div id=\"<?php echo $chatCSSPrefix?>_header\"><ul class=\"<?php echo $chatCSSPrefix?>-cf\"><li><a href=\"#\">&#9776;</a><ul class=\"<?php echo $chatCSSPrefix?>-cf\"><?php if ($theme === false || $theme->hide_close == 0) : ?><li><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"<?php echo $chatCSSPrefix?>_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a></li><?php endif;?><?php if (erLhcoreClassModelChatConfig::fetch('disable_popup_restore')->current_value == 0 && ($theme === false || $theme->hide_popup == 0)) : ?><li><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" id=\"<?php echo $chatCSSPrefix?>_remote_window\"><img src=\"<?php if ($theme !== false && $theme->popup_image_url != '') : ?><?php echo $theme->popup_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/application_double.png');?><?php endif;?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" /></a></li><?php endif; ?></ul></li></ul><a href=\"#\" id=\"<?php echo $chatCSSPrefix?>_min\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Minimize/Restore')?>\"></a></div>' +\n+                              '\" id=\"<?php echo $chatCSSPrefix?>_status-icon-restore\" href=\"#\" ><i title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','New messages')?>\" id=\"<?php echo $chatCSSPrefix?>-msg-number\"></i></a><div id=\"<?php echo $chatCSSPrefix?>_header\"><ul class=\"<?php echo $chatCSSPrefix?>-cf\"><li><a href=\"#\">&#9776;</a><ul class=\"<?php echo $chatCSSPrefix?>-cf\"><?php if ($theme === false || $theme->hide_close == 0) : ?><li><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"<?php echo $chatCSSPrefix?>_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a></li><?php endif;?><?php if (erLhcoreClassModelChatConfig::fetch('disable_popup_restore')->current_value == 0 && ($theme === false || $theme->hide_popup == 0)) : ?><li><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" id=\"<?php echo $chatCSSPrefix?>_remote_window\"><img src=\"<?php if ($theme !== false && $theme->popup_image_url != '') : ?><?php echo $theme->popup_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/application_double.png');?><?php endif;?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Open in a new window')?>\" /></a></li><?php endif; ?></ul></li></ul><a href=\"#\" id=\"<?php echo $chatCSSPrefix?>_min\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Minimize/Restore')?>\"></a></div>' +\n                               this.iframe_html + '</div>';\n \n-raw_css = \"#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min {overflow:hidden}#<?php echo $chatCSSLayoutOptions['container_id']?> .status-icon{display:none;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min .status-icon{display:inline-block;<?php echo $currentPosition['border_status_modern']?>;<?php echo $currentPosition['widget_radius_modern']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);-moz-box-shadow:<?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);text-decoration:none;height:41px;width:41px;font-weight:bold;color:<?php $theme !== false ? print '#'.$theme->text_color : print '#000' ?>;display:block;padding:10px;background:#<?php $theme !== false ? print $theme->onl_bcolor : print '0c8fc4' ?> url('<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/getstatus/online.svg');?><?php endif;?>') no-repeat center center}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min .status-icon.offline-status-icon{background:#888888 url('<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/getstatus/offline.svg');?><?php endif;?>') no-repeat center center}<?php include(erLhcoreClassDesign::designtpl('lhchat/getstatus/burger_menu_css.tpl.php')); ?> #<?php echo $chatCSSPrefix?>_remote_window{padding-left:5px;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header{min-width:107px} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_iframe_container{display:none} .<?php echo $chatCSSPrefix?>-no-transition{ -webkit-transition: none !important; -moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed{visibility:hidden;position: fixed;left: -90000px!important;right: auto!important;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed .<?php echo $chatCSSPrefix?>-cf{display:none}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> * {line-height:100%;direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;line-height:100%;box-sizing: content-box;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> img {border:0;max-width: none}\\n#<?php echo $chatCSSPrefix?>_header{position:relative;z-index:2147483640;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '17' ?>px;text-align:right;clear:both;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}#<?php echo $chatCSSPrefix?>-msg-number{float: left;color: #ffffff;font-size: 12px;font-weight: normal;line-height: 23px;position: absolute;background-color: red;border-radius: 37px;display: inline-block;padding-left: 8px;padding-right: 8px;margin-top: -5px;margin-left: -4px;} \\n#<?php echo $chatCSSPrefix?>_min{float:right;padding:2px;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_min:before{content:url(<?php if ($iconsStatuses['restore_image_url'] == false) : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php endif; if ($theme !== false && $theme->restore_image_url != '') : ?><?php echo $theme->restore_image_url;?><?php else : ?><?php echo erLhcoreClassDesign::design('images/icons/restore.png');?><?php endif;?>)}#<?php echo $chatCSSPrefix?>_min:before{content: url('<?php if ($theme !== false && $theme->minimize_image_url != '') : ?><?php echo $theme->minimize_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/min.png');?><?php endif;?>'); position: relative;left:0;top;0} #<?php echo $chatCSSPrefix?>_min{width:14px;height:14px;}\\n#<?php echo $chatCSSPrefix?>_min:hover{opacity:0.4;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> {background-color:#FFF;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab;max-height: 100%;\toverflow: auto;\\nz-index:2147483640;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; }\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{position:relative;display:block;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe.<?php echo $chatCSSPrefix?>-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n@media only screen and (max-device-width : <?php ($theme !== false && $theme->widget_response_width > 0) ? print $theme->widget_response_width : print 992?>px) {ul.<?php echo $chatCSSPrefix?>-cf li ul a{padding:8px 14px!important} ul.<?php echo $chatCSSPrefix?>-cf li:hover ul, ul.<?php echo $chatCSSPrefix?>-cf li ul {top: 30px;} .<?php echo $chatCSSPrefix?>-opened{position: fixed; overflow: hidden; right: 0px; left: 0px; top: 0px; bottom: 0px;} #<?php echo $chatCSSPrefix?>_header{height:30px;} #<?php echo $chatCSSPrefix?>_header a{padding:7px;}#<?php echo $chatCSSLayoutOptions['container_id']?>{position:fixed;left:0!important;right:0!important;bottom:0!important;top:0!important;border:0;border-radius:0}#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:0;height: calc(100% - 40px)}#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{width:100% !important;height: 100%!important}} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header{display:none;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header a{padding:2px;} #<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min .status-icon{<?php echo $currentPosition['border_status_modern']?>;<?php echo $currentPosition['widget_radius_modern']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);-moz-box-shadow:<?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);text-decoration:none;height:41px;width:41px;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min{<?php echo $currentPosition['mobile_position_modern']?>}\";\n+raw_css = \"#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min {overflow:hidden}#<?php echo $chatCSSLayoutOptions['container_id']?> .status-icon{display:none;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min .status-icon{display:inline-block;<?php echo $currentPosition['border_status_modern']?>;<?php echo $currentPosition['widget_radius_modern']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);-moz-box-shadow:<?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);text-decoration:none;height:41px;width:41px;font-weight:bold;color:<?php $theme !== false ? print '#'.$theme->text_color : print '#000' ?>;display:block;padding:10px;background:#<?php $theme !== false ? print $theme->onl_bcolor : print '0c8fc4' ?> url('<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/getstatus/online.svg');?><?php endif;?>') no-repeat center center}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min .status-icon.offline-status-icon{background:#888888 url('<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/getstatus/offline.svg');?><?php endif;?>') no-repeat center center}<?php include(erLhcoreClassDesign::designtpl('lhchat/getstatus/burger_menu_css.tpl.php')); ?> #<?php echo $chatCSSPrefix?>_remote_window{padding-left:5px;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header{min-width:107px} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_iframe_container{display:none} .<?php echo $chatCSSPrefix?>-no-transition{ -webkit-transition: none !important; -moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed{visibility:hidden;position: fixed;left: -90000px!important;right: auto!important;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-delayed .<?php echo $chatCSSPrefix?>-cf{display:none}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> * {line-height:100%;direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;line-height:100%;box-sizing: content-box;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> img {border:0;max-width: none}\\n#<?php echo $chatCSSPrefix?>_header{position:relative;z-index:2147483640;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '17' ?>px;text-align:right;clear:both;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}#<?php echo $chatCSSPrefix?>-msg-number{float: left;color: #ffffff;font-size: 12px;font-weight: normal;line-height: 23px;position: absolute;background-color: red;border-radius: 37px;display: inline-block;padding-left: 8px;padding-right: 8px;margin-top: -5px;margin-left: -4px;} \\n#<?php echo $chatCSSPrefix?>_min{float:right;padding:2px;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_min:before{content:url(<?php if ($iconsStatuses['restore_image_url'] == false) : ?><?php echo erLhcoreClassSystem::getHost()?><?php endif; if ($theme !== false && $theme->restore_image_url != '') : ?><?php echo $theme->restore_image_url;?><?php else : ?><?php echo erLhcoreClassDesign::design('images/icons/restore.png');?><?php endif;?>)}#<?php echo $chatCSSPrefix?>_min:before{content: url('<?php if ($theme !== false && $theme->minimize_image_url != '') : ?><?php echo $theme->minimize_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/min.png');?><?php endif;?>'); position: relative;left:0;top;0} #<?php echo $chatCSSPrefix?>_min{width:14px;height:14px;}\\n#<?php echo $chatCSSPrefix?>_min:hover{opacity:0.4;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> {background-color:#FFF;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab;max-height: 100%;\toverflow: auto;\\nz-index:2147483640;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; }\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{position:relative;display:block;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n#<?php echo $chatCSSLayoutOptions['container_id']?> iframe.<?php echo $chatCSSPrefix?>-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n@media only screen and (max-device-width : <?php ($theme !== false && $theme->widget_response_width > 0) ? print $theme->widget_response_width : print 992?>px) {ul.<?php echo $chatCSSPrefix?>-cf li ul a{padding:8px 14px!important} ul.<?php echo $chatCSSPrefix?>-cf li:hover ul, ul.<?php echo $chatCSSPrefix?>-cf li ul {top: 30px;} .<?php echo $chatCSSPrefix?>-opened{position: fixed; overflow: hidden; right: 0px; left: 0px; top: 0px; bottom: 0px;} #<?php echo $chatCSSPrefix?>_header{height:30px;} #<?php echo $chatCSSPrefix?>_header a{padding:7px;}#<?php echo $chatCSSLayoutOptions['container_id']?>{position:fixed;left:0!important;right:0!important;bottom:0!important;top:0!important;border:0;border-radius:0}#<?php echo $chatCSSLayoutOptions['container_id']?> #<?php echo $chatCSSPrefix?>_iframe_container{border:0;height: calc(100% - 40px)}#<?php echo $chatCSSLayoutOptions['container_id']?> iframe{width:100% !important;height: 100%!important}} .<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header{display:none;}.<?php echo $chatCSSPrefix?>-min #<?php echo $chatCSSPrefix?>_header a{padding:2px;} #<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min .status-icon{<?php echo $currentPosition['border_status_modern']?>;<?php echo $currentPosition['widget_radius_modern']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);-moz-box-shadow:<?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);text-decoration:none;height:41px;width:41px;}#<?php echo $chatCSSLayoutOptions['container_id']?>.<?php echo $chatCSSPrefix?>-min{<?php echo $currentPosition['mobile_position_modern']?>}\";\n <?php endif; ?>"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/dynamic_events.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -13,7 +13,7 @@\n         var from = e.relatedTarget || e.toElement;\n         if (!from || from.nodeName == \"HTML\") {                \n             lh_inst.stopCheckNewMessage();\n-            lh_inst.showStartWindow('<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?>/(inv)/<?php echo $invitation->id?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>',true);\n+            lh_inst.showStartWindow('<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?>/(inv)/<?php echo $invitation->id?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>',true);\n             lh_inst.removeEvent(document,\"mouseout\",lh_inst.outWindowCallback);\n         }\n     }\n@@ -36,7 +36,7 @@\n         clearTimeout(_that.iddleTimeoutActivity); \n         \n         lh_inst.stopCheckNewMessage();\n-        lh_inst.showStartWindow('<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?>/(inv)/<?php echo $invitation->id?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>',true);\n+        lh_inst.showStartWindow('<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/readoperatormessage')?>/(inv)/<?php echo $invitation->id?><?php $department !== false ? print '/(department)/'.$department : '' ?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?><?php $survey !== false ? print '/(survey)/'.$survey : ''?>/(vid)/<?php echo $vid;?><?php $visitor->invitation_assigned == true ? print '/(playsound)/true' : ''?>/(fullheight)/<?= $fullheight ? 'true' : 'false' ?>',true);\n  \n         ['mousemove','mousedown','click','scroll','keypress','load'].forEach(function(element) {\n             lh_inst.removeEvent(window,element,lh_inst.resetTimeoutIddle);   "
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/functions/part/show_survey.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,6 +2,6 @@\n     if (lh_inst.cookieData.hash && lh_inst.hasSurvey == true && lh_inst.surveyShown == false){\r\n         var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\r\n         this.surveyShown = true;\r\n-        document.getElementById('<?php echo $chatCSSPrefix?>_iframe').contentWindow.location.replace(\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/survey/fillwidget<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title));\r\n+        document.getElementById('<?php echo $chatCSSPrefix?>_iframe').contentWindow.location.replace(\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/survey/fillwidget<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title));\r\n     }\r\n },\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/functions/part/show_survey_page.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,6 +2,6 @@\n     if (this.cookieData.hash && this.hasSurvey == true && this.surveyShown == false){\n         var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n         this.surveyShown = true;\n-        document.getElementById('<?php echo $chatCSSPrefix?>_iframe_page').contentWindow.location.replace(\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/survey/fillwidget/(mode)/embed<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title));\n+        document.getElementById('<?php echo $chatCSSPrefix?>_iframe_page').contentWindow.location.replace(\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/survey/fillwidget/(mode)/embed<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php is_object($theme) ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title));\n     }\n },\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/functions/send_notification.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -76,7 +76,7 @@ function updateSubscriptionOnServer(subscription, subscribe) {\n         });\r\n \r\n         var xhr = new XMLHttpRequest();\r\n-        xhr.open( \"POST\", '<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+that.lang+'/notifications/subscribe<?php $theme !== false ? print '/(theme)/' . (is_object($theme) ? $theme->id : $theme) : ''?>' + (subscribe == true ? '/(action)/sub' : '/(action)/unsub') + that.getAppendCookieArguments(), true);\r\n+        xhr.open( \"POST\", '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+that.lang+'/notifications/subscribe<?php $theme !== false ? print '/(theme)/' . (is_object($theme) ? $theme->id : $theme) : ''?>' + (subscribe == true ? '/(action)/sub' : '/(action)/unsub') + that.getAppendCookieArguments(), true);\r\n         xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n         xhr.send( \"data=\" + encodeURIComponent( payload ) );\r\n     }\r\n@@ -142,6 +142,6 @@ function initializeUI() {\n readNotification : function(chat_id, hash) {\r\n     <?php $notificationsSettings = erLhcoreClassModelChatConfig::fetch('notifications_settings')->data_value;?>\r\n     <?php if (isset($notificationsSettings['enabled']) && $notificationsSettings['enabled'] == 1) : ?>\r\n-        this.showStartWindow(\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/notifications/read/<?php $theme !== false ? print '/(theme)/'.(is_object($theme) ? $theme->id : $theme) : ''?>/(id)/\"+chat_id+\"/(hashread)/\"+hash+\"/(mode)/widget\");\r\n+        this.showStartWindow(\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/notifications/read/<?php $theme !== false ? print '/(theme)/'.(is_object($theme) ? $theme->id : $theme) : ''?>/(id)/\"+chat_id+\"/(hashread)/\"+hash+\"/(mode)/widget\");\r\n     <?php endif; ?>\r\n },\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/functions/show_start_window.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -13,7 +13,7 @@\n         widgetHeightUnit = '%';\n     }\n \n-    this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/chat/chatwidget<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?><?php $bot_id !== null ? print '/(bot_id)/'.$bot_id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title);\n+    this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/chat/chatwidget<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?><?php $bot_id !== null ? print '/(bot_id)/'.$bot_id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title);\n \n     this.iframePreloaded = true;\n \n@@ -77,7 +77,7 @@\n             this.iframeCustomUrl = true;\n       } else {\n       \t\tthis.chatOpenedCallback(this.isOnline == false ? 'internal_offline' : 'internal');\t\n-            this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/chat/chatwidget<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $bot_id !== null ? print '/(bot_id)/'.$bot_id : ''?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title);\n+            this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>\"+this.lang+\"/chat/chatwidget<?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?= isset($currentPosition['full_height']) && $currentPosition['full_height'] ?  '/(fullheight)/true' : '/(fullheight)/false' ?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $bot_id !== null ? print '/(bot_id)/'.$bot_id : ''?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : '' ?>\"+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments()+'&dt='+encodeURIComponent(document.title);\n       };\n        \n       this.addClass(document.body,'<?php echo $chatCSSPrefix?>-opened');"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/functions/show_status_widget.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -17,7 +17,7 @@\n       \t    'offline_image_url' => ($theme !== false && $theme->offline_image_url !== false && strpos($theme->offline_image_url, 'http') !== false)\n       \t);          \t          \t\n       \t?>\n-    \tvar raw_css = \"#<?php echo $chatCSSPrefix?>_status_container.hide-status,#<?php echo $chatCSSPrefix?>_status_container.hide-status-delay{display:none!important;}#<?php echo $chatCSSPrefix?>_status_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0}\\n#<?php echo $chatCSSPrefix?>_status_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:<?php $theme !== false ? print '#'.$theme->text_color : print '#000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/user_green_chat.png');?><?php endif;?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#<?php echo $chatCSSPrefix?>_status_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#<?php echo $chatCSSPrefix?>_status_container #offline-icon{background-image:url('<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/user_gray_chat.png');?><?php endif;?>')}\\n#<?php echo $chatCSSPrefix?>_status_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;-moz-box-shadow:<?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);padding:5px 0px 0px 5px;width:190px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:2147483647;}@media only screen and (max-width : 640px) {#<?php echo $chatCSSPrefix?>_need_help_container{display:none;}#<?php echo $chatCSSPrefix?>_status_container .status-icon{padding:32px 15px 9px 31px;background-position:center center;}#<?php echo $chatCSSPrefix?>_status_container .<?php echo $chatCSSPrefix?>-text-status{display:none} #<?php echo $chatCSSPrefix?>_status_container{<?php echo $currentPosition['mobile_position_status']?>}}\\n\";\n+    \tvar raw_css = \"#<?php echo $chatCSSPrefix?>_status_container.hide-status,#<?php echo $chatCSSPrefix?>_status_container.hide-status-delay{display:none!important;}#<?php echo $chatCSSPrefix?>_status_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0}\\n#<?php echo $chatCSSPrefix?>_status_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:<?php $theme !== false ? print '#'.$theme->text_color : print '#000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/user_green_chat.png');?><?php endif;?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#<?php echo $chatCSSPrefix?>_status_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#<?php echo $chatCSSPrefix?>_status_container #offline-icon{background-image:url('<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/user_gray_chat.png');?><?php endif;?>')}\\n#<?php echo $chatCSSPrefix?>_status_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;-moz-box-shadow:<?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);padding:5px 0px 0px 5px;width:190px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:2147483647;}@media only screen and (max-width : 640px) {#<?php echo $chatCSSPrefix?>_need_help_container{display:none;}#<?php echo $chatCSSPrefix?>_status_container .status-icon{padding:32px 15px 9px 31px;background-position:center center;}#<?php echo $chatCSSPrefix?>_status_container .<?php echo $chatCSSPrefix?>-text-status{display:none} #<?php echo $chatCSSPrefix?>_status_container{<?php echo $currentPosition['mobile_position_status']?>}}\\n\";\n     \tthis.addCss(raw_css<?php ($theme !== false && $theme->custom_status_css_front !== '') ? print '+\\''.str_replace(array(\"\\n\",\"\\r\",\"'\"), array('','','\\\\\\''), $theme->custom_status_css_front).'\\'' : '' ?>);\n \t};\n     <?php else : ?>\n@@ -31,7 +31,7 @@\n             'offline_image_url' => ($theme !== false && $theme->offline_image_url !== false && strpos($theme->offline_image_url, 'http') !== false)\n         );\n         ?>\n-        var raw_css = \"#<?php echo $chatCSSPrefix?>_status_container.hide-status,#<?php echo $chatCSSPrefix?>_status_container.hide-status-delay{display:none!important;}#<?php echo $chatCSSPrefix?>_status_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0}#<?php echo $chatCSSPrefix?>_status_container .<?php echo $chatCSSPrefix?>-invitation-status{display:none;position:absolute;}#<?php echo $chatCSSPrefix?>_status_container.<?php echo $chatCSSPrefix?>_invitation-mode .<?php echo $chatCSSPrefix?>-invitation-status{width: 16px;height:16px;padding: 2px;border-radius: 10px;text-align: center;font-weight: bold;color: #FFF;background-color: red;display: inline-block;}\\n#<?php echo $chatCSSPrefix?>_status_container .status-icon{<?php echo $currentPosition['border_status_modern']?>;<?php echo $currentPosition['widget_radius_modern']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);-moz-box-shadow:<?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);text-decoration:none;height:41px;width:41px;font-weight:bold;color:<?php $theme !== false ? print '#'.$theme->text_color : print '#000' ?>;display:block;padding:10px;background:#<?php $theme !== false ? print $theme->onl_bcolor : print '0c8fc4' ?> url('<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/getstatus/online.svg');?><?php endif;?>') no-repeat center center}\\n#<?php echo $chatCSSPrefix?>_status_container:hover{<?php echo $currentPosition['widget_hover_modern']?>}\\n#<?php echo $chatCSSPrefix?>_status_container #offline-icon{background:#888888 url('<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/getstatus/offline.svg');?><?php endif;?>') no-repeat center}\\n#<?php echo $chatCSSPrefix?>_status_container{box-sizing: content-box;padding:5px 0px 0px 5px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position_modern']?>;z-index:2147483647;}@media only screen and (max-width : 640px) {#<?php echo $chatCSSPrefix?>_need_help_container{display:none;}#<?php echo $chatCSSPrefix?>_status_container .status-icon{background-position:center center;}#<?php echo $chatCSSPrefix?>_status_container .<?php echo $chatCSSPrefix?>-text-status{display:none} #<?php echo $chatCSSPrefix?>_status_container{<?php echo $currentPosition['mobile_position_status_modern']?>}}\\n\";\n+        var raw_css = \"#<?php echo $chatCSSPrefix?>_status_container.hide-status,#<?php echo $chatCSSPrefix?>_status_container.hide-status-delay{display:none!important;}#<?php echo $chatCSSPrefix?>_status_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site','dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0}#<?php echo $chatCSSPrefix?>_status_container .<?php echo $chatCSSPrefix?>-invitation-status{display:none;position:absolute;}#<?php echo $chatCSSPrefix?>_status_container.<?php echo $chatCSSPrefix?>_invitation-mode .<?php echo $chatCSSPrefix?>-invitation-status{width: 16px;height:16px;padding: 2px;border-radius: 10px;text-align: center;font-weight: bold;color: #FFF;background-color: red;display: inline-block;}\\n#<?php echo $chatCSSPrefix?>_status_container .status-icon{<?php echo $currentPosition['border_status_modern']?>;<?php echo $currentPosition['widget_radius_modern']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);-moz-box-shadow:<?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);box-shadow: <?php echo $currentPosition['shadow_modern']?> rgba(50, 50, 50, 0.5);text-decoration:none;height:41px;width:41px;font-weight:bold;color:<?php $theme !== false ? print '#'.$theme->text_color : print '#000' ?>;display:block;padding:10px;background:#<?php $theme !== false ? print $theme->onl_bcolor : print '0c8fc4' ?> url('<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/getstatus/online.svg');?><?php endif;?>') no-repeat center center}\\n#<?php echo $chatCSSPrefix?>_status_container:hover{<?php echo $currentPosition['widget_hover_modern']?>}\\n#<?php echo $chatCSSPrefix?>_status_container #offline-icon{background:#888888 url('<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/getstatus/offline.svg');?><?php endif;?>') no-repeat center}\\n#<?php echo $chatCSSPrefix?>_status_container{box-sizing: content-box;padding:5px 0px 0px 5px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position_modern']?>;z-index:2147483647;}@media only screen and (max-width : 640px) {#<?php echo $chatCSSPrefix?>_need_help_container{display:none;}#<?php echo $chatCSSPrefix?>_status_container .status-icon{background-position:center center;}#<?php echo $chatCSSPrefix?>_status_container .<?php echo $chatCSSPrefix?>-text-status{display:none} #<?php echo $chatCSSPrefix?>_status_container{<?php echo $currentPosition['mobile_position_status_modern']?>}}\\n\";\n         this.addCss(raw_css<?php ($theme !== false && $theme->custom_status_css_front !== '') ? print '+\\''.str_replace(array(\"\\n\",\"\\r\",\"'\"), array('','','\\\\\\''), $theme->custom_status_css_front).'\\'' : '' ?>);\n     };\n     <?php endif; ?>"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/getstatus_migrate.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -42,9 +42,9 @@\n <?php $lang = erLhcoreClassSystem::instance()->SiteAccess != 'site_admin' ?  erLhcoreClassSystem::instance()->SiteAccess . '/' : ''; ?>\n \n var LHC_API = LHC_API||{};\n-LHC_API.args = {'lang':'<?php echo $lang?>',mode:'<?php echo $mode?>'<?php (isset($position) && $position == 'api') ? print \",position:'api'\" : ''?>,lhc_base_url:'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('/')?>',domain: lhc_domain, wheight:<?php isset($wheight) ? print (int)$wheight : print 450?>, wwidth:<?php isset($wwidth) ? print (int)$wwidth : print 350?>,pheight:520,pwidth:500<?php if (is_array($depId) && !empty($depId)) : ?>,department:[<?php echo implode(',',$depId)?>]<?php endif;?><?php if ($leaveamessage == true) : ?>,leaveamessage:true<?php endif; ?><?php if ($disable_pro_active == true) : ?>,proactive:false<?php else : ?>,check_messages:true<?php endif;?><?php isset($uparams['theme']) & is_numeric($uparams['theme']) ? print ',theme:' . (int)$uparams['theme'] : ''?>};\n+LHC_API.args = {'lang':'<?php echo $lang?>',mode:'<?php echo $mode?>'<?php (isset($position) && $position == 'api') ? print \",position:'api'\" : ''?>,lhc_base_url:'<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('/')?>',domain: lhc_domain, wheight:<?php isset($wheight) ? print (int)$wheight : print 450?>, wwidth:<?php isset($wwidth) ? print (int)$wwidth : print 350?>,pheight:520,pwidth:500<?php if (is_array($depId) && !empty($depId)) : ?>,department:[<?php echo implode(',',$depId)?>]<?php endif;?><?php if ($leaveamessage == true) : ?>,leaveamessage:true<?php endif; ?><?php if ($disable_pro_active == true) : ?>,proactive:false<?php else : ?>,check_messages:true<?php endif;?><?php isset($uparams['theme']) & is_numeric($uparams['theme']) ? print ',theme:' . (int)$uparams['theme'] : ''?>};\n (function() {\n var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;\n-var date = new Date();po.src = '//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('js/widgetv2/index.js');?>?v1'+(\"\"+date.getFullYear() + date.getMonth() + date.getDate());\n+var date = new Date();po.src = '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('js/widgetv2/index.js');?>?v1'+(\"\"+date.getFullYear() + date.getMonth() + date.getDate());\n var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);\n })();"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/native_placement.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-document.getElementById('<?php echo $chatCSSPrefix?>_status_container').innerHTML = '<p class=\"<?php echo $chatCSSPrefix?>-status-native-'+(this.isOnline == true ? 'online' : 'offline')+'\"><a href=\"#\" onclick=\"return lh_inst.lh_openchatWindow()\">'+(this.isOnline == true ? '<img src=\"<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/user_green_chat.png');?><?php endif;?>\" alt=\"\" /><?php if ($theme !== false && $theme->online_text !== '') : print htmlspecialchars_decode($theme->online_text,ENT_QUOTES); else : ?><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Live help is online...')?><?php endif?>' : '<img src=\"<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/user_gray_chat.png');?><?php endif;?>\" alt=\"\" /><?php if ($theme !== false && $theme->offline_text != '') : print htmlspecialchars_decode($theme->offline_text,ENT_QUOTES); else : ?><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Live help is offline...')?><?php endif;?>')+'</a></p>';\r\n+document.getElementById('<?php echo $chatCSSPrefix?>_status_container').innerHTML = '<p class=\"<?php echo $chatCSSPrefix?>-status-native-'+(this.isOnline == true ? 'online' : 'offline')+'\"><a href=\"#\" onclick=\"return lh_inst.lh_openchatWindow()\">'+(this.isOnline == true ? '<img src=\"<?php if ($theme !== false && $theme->online_image_url !== false) : print $theme->online_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/user_green_chat.png');?><?php endif;?>\" alt=\"\" /><?php if ($theme !== false && $theme->online_text !== '') : print htmlspecialchars_decode($theme->online_text,ENT_QUOTES); else : ?><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Live help is online...')?><?php endif?>' : '<img src=\"<?php if ($theme !== false && $theme->offline_image_url !== false) : print $theme->offline_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/user_gray_chat.png');?><?php endif;?>\" alt=\"\" /><?php if ($theme !== false && $theme->offline_text != '') : print htmlspecialchars_decode($theme->offline_text,ENT_QUOTES); else : ?><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Live help is offline...')?><?php endif;?>')+'</a></p>';\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatus/we_here_substatus.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n var titleText = (typeof <?php echo $chatOptionsVariable;?>.opt.nh_title_text != 'undefined') ? <?php echo $chatOptionsVariable;?>.opt.nh_title_text : <?php if ($theme !== false && $theme->need_help_header !== '') : print json_encode($theme->need_help_header); else : ?><?php echo json_encode(htmlspecialchars_decode(erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Need help?'),ENT_QUOTES))?><?php endif;?>;\r\n var subTitleText = (typeof <?php echo $chatOptionsVariable;?>.opt.nh_sub_title_text != 'undefined') ? <?php echo $chatOptionsVariable;?>.opt.nh_sub_title_text : <?php if ($theme !== false && $theme->need_help_text !== '') : print json_encode($theme->need_help_text); else : ?><?php echo json_encode(htmlspecialchars_decode(erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Our staff are always ready to help'),ENT_QUOTES))?><?php endif;?>;\r\n <?php $iconsStatuses['need_help_image_url'] = ($theme !== false && $theme->need_help_image_url !== false && strpos($theme->need_help_image_url, 'http') !== false); ?>\r\n-var imageTooltip = (typeof <?php echo $chatOptionsVariable;?>.opt.nh_image != 'undefined') ? <?php echo $chatOptionsVariable;?>.opt.nh_image : '<?php if ($theme !== false && $theme->need_help_image_url !== false) : print $theme->need_help_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/operator.png');?><?php endif;?>';\r\n+var imageTooltip = (typeof <?php echo $chatOptionsVariable;?>.opt.nh_image != 'undefined') ? <?php echo $chatOptionsVariable;?>.opt.nh_image : '<?php if ($theme !== false && $theme->need_help_image_url !== false) : print $theme->need_help_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/operator.png');?><?php endif;?>';\r\n \r\n subStatus = '<div id=\"<?php echo $chatCSSPrefix?>_need_help_container\" style=\"<?php echo $currentPosition[$nh_hor_pos]?>\">'+\r\n '<span id=\"<?php echo $chatCSSPrefix?>_need_help_triangle\" style=\"<?php echo $currentPosition['nh_tr_pos']?>\"></span>'+\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/getstatusembed.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -34,7 +34,7 @@\n             var th = document.getElementsByTagName('head')[0];\n             var s = document.createElement('script');\n             s.setAttribute('type','text/javascript');\n-            s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/chatwidgetclosed')?>/(eclose)/t'+this.getAppendCookieArguments());\n+            s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/chatwidgetclosed')?>/(eclose)/t'+this.getAppendCookieArguments());\n             th.appendChild(s);\n             s.onreadystatechange = s.onload = function(){\n                 lh_inst_page.removeCookieAttr('hash');\n@@ -178,7 +178,7 @@\n         if ( url_to_open != undefined ) {\n             this.initial_iframe_url = url_to_open+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+'&dt='+encodeURIComponent(document.title)+this.parseStorageArguments();\n         } else {\n-            this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/chatwidget')?><?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $bot_id !== null ? print '/(bot_id)/'.$bot_id : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?>/(mode)/embed\" + (mobileFullHeight === false ? '/(mobile)/false' : '') + this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments();\n+            this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/chatwidget')?><?php $leaveamessage == true ? print '/(leaveamessage)/true' : ''?><?php $department !== false ? print '/(department)/'.$department : ''?><?php $theme !== false ? print '/(theme)/'.$theme : ''?><?php $operator !== false ? print '/(operator)/'.$operator : ''?><?php $priority !== false ? print '/(priority)/'.$priority : ''?><?php $bot_id !== null ? print '/(bot_id)/'.$bot_id : ''?><?php $uarguments !== false ? print '/(ua)/'.$uarguments : ''?>/(mode)/embed\" + (mobileFullHeight === false ? '/(mobile)/false' : '') + this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.parseOptions()+this.parseStorageArguments();\n         };\n \n         if (mobileFullHeight === true) {"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/lists/op_msg_row_nick.tpl.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -10,7 +10,7 @@\n             <?php if ($chat->bot->has_photo) : ?>\n             <img class=\"profile-msg-pic\" src=\"<?php echo $chat->bot->photo_path?>\" alt=\"\">\n             <?php else : ?>\n-            <img class=\"profile-msg-pic\" src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($chat->bot->avatar)?>\" alt=\"\" />\n+            <img class=\"profile-msg-pic\" src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($chat->bot->avatar)?>\" alt=\"\" />\n             <?php endif; ?>\n         </i>\n     <?php elseif ($msg['user_id'] > 0 && isset($theme) && $theme !== false && isset($theme->bot_configuration_array['bubble_style_profile']) && $theme->bot_configuration_array['bubble_style_profile'] == 1 &&\n@@ -20,15 +20,15 @@\n                 <?php if ($userMessage->has_photo) : ?>\n                     <img class=\"profile-msg-pic\" src=\"<?php echo $userMessage->photo_path?>\" alt=\"\">\n                 <?php else : ?>\n-                    <img class=\"profile-msg-pic\" src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($userMessage->avatar)?>\" alt=\"\" />\n+                    <img class=\"profile-msg-pic\" src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($userMessage->avatar)?>\" alt=\"\" />\n                 <?php endif; ?>\n             </i>\n     <?php elseif (isset($theme) && $theme !== false && isset($theme->bot_configuration_array['bubble_style_profile']) && $theme->bot_configuration_array['bubble_style_profile'] == 1 && $theme->operator_image_avatar !== false) : ?>\n         <i title=\"<?php echo htmlspecialchars($msg['name_support'])?>\" class=\"chat-operators mi-fs15 mr-0\">\n             <?php if ($theme->operator_image_url !== false) : ?>\n                 <img class=\"profile-msg-pic\" src=\"<?php echo $theme->operator_image_url?>\" alt=\"\">\n             <?php else : ?>\n-                <img class=\"profile-msg-pic\" src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($theme->bot_configuration_array['operator_avatar'])?>\" alt=\"\" />\n+                <img class=\"profile-msg-pic\" src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($theme->bot_configuration_array['operator_avatar'])?>\" alt=\"\" />\n             <?php endif; ?>\n         </i>\n     <?php else : ?>"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/part/operator_profile_name_support_img.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n <?php if ($user->has_photo) : ?>\n <img width=\"48\" height=\"48\" src=\"<?php echo $user->photo_path?>\" alt=\"<?php echo htmlspecialchars($user->name_support)?>\" />\n <?php else : ?>\n-<img width=\"48\" height=\"48\" src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($user->avatar)?>\" alt=\"<?php echo htmlspecialchars($user->name_support)?>\" />\n+<img width=\"48\" height=\"48\" src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($user->avatar)?>\" alt=\"<?php echo htmlspecialchars($user->name_support)?>\" />\n <?php endif; ?>"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/part/operator_profile_start_chat.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n         <?php if ($theme->operator_image_url !== false) : ?>\r\n      \t\t\t<img width=\"48\" height=\"48\" src=\"<?php echo $theme->operator_image_url?>\" alt=\"\" />\r\n         <?php else : ?>\r\n-                <img width=\"48\" height=\"48\" src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($theme->bot_configuration_array['operator_avatar'])?>\" alt=\"\" />\r\n+                <img width=\"48\" height=\"48\" src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar')?>/<?php echo htmlspecialchars($theme->bot_configuration_array['operator_avatar'])?>\" alt=\"\" />\r\n         <?php endif; ?>\r\n \r\n      \t<?php else : ?>\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/widget_brand/chatbox.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-<?php if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_chatbox_title\"><a title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" rel=\"noreferrer\" target=\"_blank\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file\n+<?php if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_chatbox_title\"><a title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" rel=\"noreferrer\" target=\"_blank\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/widget_brand/faq.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-<?php if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_faq_title\"><a title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" target=\"_blank\" rel=\"noreferrer\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file\n+<?php if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_faq_title\"><a title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" target=\"_blank\" rel=\"noreferrer\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/widget_brand/live_help.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,2 +1,2 @@\n <?php $iconsStatuses['copyright_image_url'] = ($theme !== false && $theme->copyright_image_url !== false && strpos($theme->copyright_image_url, 'http') !== false);          \t          \t\r\n-if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_title\"><a title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" target=\"_blank\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file\n+if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_title\"><a title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" target=\"_blank\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchat/widget_brand/questionary.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-<?php if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_questionary_title\"><a rel=\"noreferrer\" title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" target=\"_blank\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file\n+<?php if ($theme === false || $theme->show_copyright == 1) : ?><span id=\"lhc_questionary_title\"><a rel=\"noreferrer\" title=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print '' : print 'Powered by Live Helper Chat' ?>\" href=\"<?php $theme !== false && $theme->widget_copyright_url != '' ? print htmlspecialchars($theme->widget_copyright_url) : print 'http://livehelperchat.com' ?>\" target=\"_blank\"><img src=\"<?php if ($theme !== false && $theme->copyright_image_url !== false) : print $theme->copyright_image_url; else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/logo_grey.png');?><?php endif;?>\" alt=\"Live Helper Chat\" /></a></span><?php endif;?>\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchatbox/embed.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@\n \n \tshowVotingForm : function() {\n \t\t  var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chatbox/chatwidget')?>/(chat_height)/<?php echo $heightchatcontent;?><?php $theme !== false ? print '/(theme)/'.$theme : ''?>/(mode)/embed/(identifier)/\"+<?php echo $chatboxOptionsVariablePage;?>.identifier+'/(hashchatbox)/'+<?php echo $chatboxOptionsVariablePage;?>.hashchatbox+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.getAppendRequestArguments();\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chatbox/chatwidget')?>/(chat_height)/<?php echo $heightchatcontent;?><?php $theme !== false ? print '/(theme)/'.$theme : ''?>/(mode)/embed/(identifier)/\"+<?php echo $chatboxOptionsVariablePage;?>.identifier+'/(hashchatbox)/'+<?php echo $chatboxOptionsVariablePage;?>.hashchatbox+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.getAppendRequestArguments();\n \n    \t\t  this.iframe_html = '<iframe id=\"lhc_sizing_chatbox_page\" allowTransparency=\"true\" scrolling=\"no\" frameborder=\"0\" ' +\n                        ( this.initial_iframe_url != '' ? ' src=\"'    + this.initial_iframe_url + '\"' : '' ) +"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchatbox/embedcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -55,7 +55,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\nvar <?php echo $chatboxOptionsVariablePage?> = {hashchatbox:'empty',identifier:'default'};\\n\"+\n       '(function() {'+\"\\n\"+\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'chatbox/embed'+chat_height+id_theme+\"';\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'chatbox/embed'+chat_height+id_theme+\"';\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchatbox/getstatus.tpl.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -194,7 +194,7 @@\n     \tvar th = document.getElementsByTagName('head')[0];\n         var s = document.createElement('script');\n         s.setAttribute('type','text/javascript');\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chatbox/chatwidgetclosed')?>');\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chatbox/chatwidgetclosed')?>');\n         th.appendChild(s);\n         this.removeById('lhc_container_chatbox');\n         this.removeCookieAttr('pos');\n@@ -243,7 +243,7 @@\n    \t\t  this.removeById('lhc_container_chatbox');\n \t\t  var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n \t\t  \n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chatbox/chatwidget')?>/(chat_height)/<?php echo $heightchatcontent;?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?>/(identifier)/\"+<?php echo $chatboxOptionsVariable;?>.identifier+'/(hashchatbox)/'+<?php echo $chatboxOptionsVariable;?>.hashchatbox+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.getAppendRequestArguments();\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chatbox/chatwidget')?>/(chat_height)/<?php echo $heightchatcontent;?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?>/(identifier)/\"+<?php echo $chatboxOptionsVariable;?>.identifier+'/(hashchatbox)/'+<?php echo $chatboxOptionsVariable;?>.hashchatbox+this.getAppendCookieArguments()+'?URLReferer='+locationCurrent+this.getAppendRequestArguments();\n \n    \t\t  if (window.innerWidth < 1024) {\n           \t\twindow.open(this.initial_iframe_url,\"_blank\");\n@@ -259,10 +259,10 @@\n                        ' style=\"width: <?php echo $widthwidget?>px; height: <?php echo $heightwidget?>px;\"></iframe></div>';\n \n           this.iframe_html = '<div id=\"lhc_container_chatbox\">' +\n-                              '<div id=\"lhc_chatbox_header\"><?php include(erLhcoreClassDesign::designtpl('lhchat/widget_brand/chatbox.tpl.php')); ?><?php if ($show_content === false) : ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"lhc_chatbox_close\"><img src=\"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a><?php endif;?><?php if ($disable_min === false) : ?><a href=\"#\" id=\"lhc_chatbox_min\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Minimize/Restore')?>\"></a><?php endif;?></div><div id=\"lhc_iframe_container\">' +\n+                              '<div id=\"lhc_chatbox_header\"><?php include(erLhcoreClassDesign::designtpl('lhchat/widget_brand/chatbox.tpl.php')); ?><?php if ($show_content === false) : ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"lhc_chatbox_close\"><img src=\"<?php echo erLhcoreClassSystem::getHost()?><?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a><?php endif;?><?php if ($disable_min === false) : ?><a href=\"#\" id=\"lhc_chatbox_min\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Minimize/Restore')?>\"></a><?php endif;?></div><div id=\"lhc_iframe_container\">' +\n                               this.iframe_html + '</div></div>';\n \n-          raw_css = \".lhc-no-transition{ -webkit-transition: none !important; -moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}\\n.lhc-min{height:35px !important}\\n#lhc_container_chatbox * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial\\;font-size:12px\\;line-height:100%\\;box-sizing: content-box\\;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#lhc_container_chatbox img {border:0;}\\n#lhc_chatbox_title{float:left;}\\n#lhc_chatbox_header{position:relative;z-index:9990;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '15' ?>px;overflow:hidden;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;text-align:right;clear:both;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}\\n#lhc_chatbox_close,#lhc_chatbox_min{padding:2px;float:right;}.lhc-min #lhc_chatbox_min{background-image:url(<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php if ($theme !== false && $theme->restore_image_url != '') : ?><?php echo $theme->restore_image_url;?><?php else : ?><?php echo erLhcoreClassDesign::design('images/icons/restore.png');?><?php endif;?>)}#lhc_chatbox_min{width:14px;height:14px;background:url(<?php if ($theme !== false && $theme->minimize_image_url != '') : ?><?php echo $theme->minimize_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/min.png');?><?php endif;?>) no-repeat center center;}\\n\\n#lhc_chatbox_close:hover,#lhc_chatbox_min:hover{opacity:0.4}\\n#lhc_container_chatbox {overflow: hidden;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;background-color:#FFF\\;\\nz-index:9990;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab; }\\n#lhc_container_chatbox iframe{position:relative;display:block;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;}\\n#lhc_container_chatbox iframe.lhc-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n#lhc_container_chatbox #lhc_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n@media only screen and (max-width : 640px) {#lhc_container_chatbox{margin-bottom:5px;position:relative;right:0 !important;bottom:0 !important;top:0 !important}#lhc_container_chatbox iframe{width:100% !important}}\";\n+          raw_css = \".lhc-no-transition{ -webkit-transition: none !important; -moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}\\n.lhc-min{height:35px !important}\\n#lhc_container_chatbox * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial\\;font-size:12px\\;line-height:100%\\;box-sizing: content-box\\;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#lhc_container_chatbox img {border:0;}\\n#lhc_chatbox_title{float:left;}\\n#lhc_chatbox_header{position:relative;z-index:9990;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '15' ?>px;overflow:hidden;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;text-align:right;clear:both;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}\\n#lhc_chatbox_close,#lhc_chatbox_min{padding:2px;float:right;}.lhc-min #lhc_chatbox_min{background-image:url(<?php echo erLhcoreClassSystem::getHost()?><?php if ($theme !== false && $theme->restore_image_url != '') : ?><?php echo $theme->restore_image_url;?><?php else : ?><?php echo erLhcoreClassDesign::design('images/icons/restore.png');?><?php endif;?>)}#lhc_chatbox_min{width:14px;height:14px;background:url(<?php if ($theme !== false && $theme->minimize_image_url != '') : ?><?php echo $theme->minimize_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/min.png');?><?php endif;?>) no-repeat center center;}\\n\\n#lhc_chatbox_close:hover,#lhc_chatbox_min:hover{opacity:0.4}\\n#lhc_container_chatbox {overflow: hidden;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;background-color:#FFF\\;\\nz-index:9990;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab; }\\n#lhc_container_chatbox iframe{position:relative;display:block;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;}\\n#lhc_container_chatbox iframe.lhc-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n#lhc_container_chatbox #lhc_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n@media only screen and (max-width : 640px) {#lhc_container_chatbox{margin-bottom:5px;position:relative;right:0 !important;bottom:0 !important;top:0 !important}#lhc_container_chatbox iframe{width:100% !important}}\";\n \n           if (!this.cssWasAdded) {\n           \t\tthis.cssWasAdded = true;\n@@ -293,7 +293,7 @@\n    showStatusWidget : function() {\n    \t\t<?php if ($show_content === false) : ?>\n        var statusTEXT = '<a id=\"chatbox-icon\" class=\"status-icon\" href=\"#\" >'+<?php echo $chatboxOptionsVariable;?>.status_text+'</a>';\n-       var raw_css = \"#lhc_chatbox_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;line-height:100%;box-sizing: content-box;zoom:1;margin:0;padding:0}\\n#lhc_chatbox_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:#<?php $theme !== false ? print $theme->text_color : print '000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/emotion_amazing.png');?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#lhc_chatbox_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#lhc_chatbox_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;padding:5px 0px 3px 5px;width:190px;font-family:arial;font-size:12px;line-height:100%;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:9989;}\\n<?php if ($noresponse == false) : ?>@media only screen and (max-width : 640px) {#lhc_chatbox_container{position:relative;top:0;right:0;bottom:0;left:0;width:auto;border-radius:2px;box-shadow:none;border:1px solid #e3e3e3;margin-bottom:5px;}}\\n<?php endif;?>\";\n+       var raw_css = \"#lhc_chatbox_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;font-size:12px;line-height:100%;box-sizing: content-box;zoom:1;margin:0;padding:0}\\n#lhc_chatbox_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:#<?php $theme !== false ? print $theme->text_color : print '000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/emotion_amazing.png');?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#lhc_chatbox_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#lhc_chatbox_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;padding:5px 0px 3px 5px;width:190px;font-family:arial;font-size:12px;line-height:100%;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:9989;}\\n<?php if ($noresponse == false) : ?>@media only screen and (max-width : 640px) {#lhc_chatbox_container{position:relative;top:0;right:0;bottom:0;left:0;width:auto;border-radius:2px;box-shadow:none;border:1px solid #e3e3e3;margin-bottom:5px;}}\\n<?php endif;?>\";\n        this.addCss(raw_css<?php ($theme !== false && $theme->custom_status_css !== '') ? print '+\\''.str_replace(array(\"\\n\",\"\\r\"), '', $theme->custom_status_css).'\\'' : '' ?>);\n        var htmlStatus = '<div id=\"lhc_chatbox_container\">'+statusTEXT+'</div>';\n        var fragment = this.appendHTML(htmlStatus);"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhchatbox/htmlcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -126,7 +126,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\nvar <?php echo $chatboxOptionsVariable?> = {hashchatbox:'empty',identifier:'default',status_text:'\"+textStatus+\"'};\\n\"+\n       '(function() {'+\"\\n\"+\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'chatbox/getstatus'+id_position+top+id_disable_responsive+topposition+widthwidget+id_theme+heightwidget+chat_height+show_content+show_min+dis_min+\"';\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'chatbox/getstatus'+id_position+top+id_disable_responsive+topposition+widthwidget+id_theme+heightwidget+chat_height+show_content+show_min+dis_min+\"';\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhcobrowse/operatorinit.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-var lhcbrowserOpeator = new LHCCoBrowserOperator(window,document,{'mode':'chat','lhcbase':'<?php echo (erLhcoreClassSystem::$httpsMode == true ? 'https://' : 'http://').$_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('cobrowse/proxycss')?>','httpsmode':<?php echo erLhcoreClassSystem::$httpsMode == true ? 'true' : 'false'?>,'disableiframe':<?php echo erLhcoreClassModelChatConfig::fetch('disable_iframe_sharing')->current_value == 1 ? 'true' : 'false'?>,'disablejs':<?php echo erLhcoreClassModelChatConfig::fetch('disable_js_execution')->current_value == 1 ? 'true' : 'false'?>,options:{opcontrol:$('#status-icon-control'),opscroll:$('#sync-user-scroll'),opmouse:$('#show-operator-mouse'),scroll:$('#scroll-user-window')},'cpos':{w:<?php echo $browse->w?>,wh:<?php echo $browse->wh?>},'cursor':'<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/cursor.png')?>','nodejssettings':{'nodejssocket':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value)?>,'nodejshost':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value != '' ? erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value : $_SERVER['HTTP_HOST'])?>,'path':'<?php echo erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value?>','secure':<?php if ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1) : ?>true<?php else : ?>false<?php endif;?>},'nodejsenabled':<?php echo (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value?>,'chat_hash':'<?php echo $browse->chat->hash?>','chat_id':<?php echo $browse->chat_id?>, 'base':<?php echo json_encode($browse->url)?>, 'initialize' : <?php echo $browse->initialize != '' ? $browse->initialize : 'null'?>});\n\\ No newline at end of file\n+var lhcbrowserOpeator = new LHCCoBrowserOperator(window,document,{'mode':'chat','lhcbase':'<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('cobrowse/proxycss')?>','httpsmode':<?php echo erLhcoreClassSystem::$httpsMode == true ? 'true' : 'false'?>,'disableiframe':<?php echo erLhcoreClassModelChatConfig::fetch('disable_iframe_sharing')->current_value == 1 ? 'true' : 'false'?>,'disablejs':<?php echo erLhcoreClassModelChatConfig::fetch('disable_js_execution')->current_value == 1 ? 'true' : 'false'?>,options:{opcontrol:$('#status-icon-control'),opscroll:$('#sync-user-scroll'),opmouse:$('#show-operator-mouse'),scroll:$('#scroll-user-window')},'cpos':{w:<?php echo $browse->w?>,wh:<?php echo $browse->wh?>},'cursor':'<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/cursor.png')?>','nodejssettings':{'nodejssocket':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value)?>,'nodejshost':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value != '' ? erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value : str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost()))?>,'path':'<?php echo erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value?>','secure':<?php if ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1) : ?>true<?php else : ?>false<?php endif;?>},'nodejsenabled':<?php echo (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value?>,'chat_hash':'<?php echo $browse->chat->hash?>','chat_id':<?php echo $browse->chat_id?>, 'base':<?php echo json_encode($browse->url)?>, 'initialize' : <?php echo $browse->initialize != '' ? $browse->initialize : 'null'?>});\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhcobrowse/operatorinit_onlineuser.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-var lhcbrowserOpeator = new LHCCoBrowserOperator(window,document,{'mode':'onlineuser','lhcbase':'<?php echo (erLhcoreClassSystem::$httpsMode == true ? 'https://' : 'http://').$_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('cobrowse/proxycss')?>','httpsmode':<?php echo erLhcoreClassSystem::$httpsMode == true ? 'true' : 'false'?>,'disableiframe':<?php echo erLhcoreClassModelChatConfig::fetch('disable_iframe_sharing')->current_value == 1 ? 'true' : 'false'?>,'disablejs':<?php echo erLhcoreClassModelChatConfig::fetch('disable_js_execution')->current_value == 1 ? 'true' : 'false'?>,options:{opcontrol:$('#status-icon-control'),opscroll:$('#sync-user-scroll'),opmouse:$('#show-operator-mouse'),scroll:$('#scroll-user-window')},'cpos':{w:<?php echo $browse->w?>,wh:<?php echo $browse->wh?>},'cursor':'<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/cursor.png')?>','nodejssettings':{'nodejssocket':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value)?>,'nodejshost':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value)?>,'path':'<?php echo erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value?>','secure':<?php if ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1) : ?>true<?php else : ?>false<?php endif;?>},'nodejsenabled':<?php echo (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value?>,'online_user_hash':'<?php echo $browse->online_user->vid?>','online_user_id':<?php echo $browse->online_user_id?>, 'base':<?php echo json_encode($browse->url)?>, 'initialize' : <?php echo $browse->initialize != '' ? $browse->initialize : 'null'?>});\n\\ No newline at end of file\n+var lhcbrowserOpeator = new LHCCoBrowserOperator(window,document,{'mode':'onlineuser','lhcbase':'<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('cobrowse/proxycss')?>','httpsmode':<?php echo erLhcoreClassSystem::$httpsMode == true ? 'true' : 'false'?>,'disableiframe':<?php echo erLhcoreClassModelChatConfig::fetch('disable_iframe_sharing')->current_value == 1 ? 'true' : 'false'?>,'disablejs':<?php echo erLhcoreClassModelChatConfig::fetch('disable_js_execution')->current_value == 1 ? 'true' : 'false'?>,options:{opcontrol:$('#status-icon-control'),opscroll:$('#sync-user-scroll'),opmouse:$('#show-operator-mouse'),scroll:$('#scroll-user-window')},'cpos':{w:<?php echo $browse->w?>,wh:<?php echo $browse->wh?>},'cursor':'<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/cursor.png')?>','nodejssettings':{'nodejssocket':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value)?>,'nodejshost':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value)?>,'path':'<?php echo erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value?>','secure':<?php if ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1) : ?>true<?php else : ?>false<?php endif;?>},'nodejsenabled':<?php echo (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value?>,'online_user_hash':'<?php echo $browse->online_user->vid?>','online_user_id':<?php echo $browse->online_user_id?>, 'base':<?php echo json_encode($browse->url)?>, 'initialize' : <?php echo $browse->initialize != '' ? $browse->initialize : 'null'?>});\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhcobrowse/userinit.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,3 +1,3 @@\n if(typeof formsEnabled == \"undefined\") var formsEnabled = false;\r\n-this.cobrowser = new LHCCoBrowser({'formsenabled':formsEnabled,'chat_hash':this.sharehash,'nodejssettings':{'nodejssocket':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value)?>,'nodejshost':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value != '' ? erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value : $_SERVER['HTTP_HOST'])?>,'path':'<?php echo erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value?>','secure':<?php if ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1) : ?>true<?php else : ?>false<?php endif;?>},'nodejsenabled':<?php echo (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value?>,'trans':{'operator_watching':<?php echo json_encode(htmlspecialchars_decode(erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Screen shared, click to finish'),ENT_QUOTES))?>},'url':'<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/cobrowse/storenodemap/(sharemode)/'+inst.sharemode+inst.getAppendCookieArguments()+'/?url='+encodeURIComponent(location.href.match(/^(.*\\/)[^\\/]*$/)[1])});\r\n+this.cobrowser = new LHCCoBrowser({'formsenabled':formsEnabled,'chat_hash':this.sharehash,'nodejssettings':{'nodejssocket':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value)?>,'nodejshost':<?php echo json_encode(erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value != '' ? erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value : str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost()))?>,'path':'<?php echo erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value?>','secure':<?php if ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1) : ?>true<?php else : ?>false<?php endif;?>},'nodejsenabled':<?php echo (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value?>,'trans':{'operator_watching':<?php echo json_encode(htmlspecialchars_decode(erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Screen shared, click to finish'),ENT_QUOTES))?>},'url':'<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurlsite()?>'+lh_inst.lang+'/cobrowse/storenodemap/(sharemode)/'+inst.sharemode+inst.getAppendCookieArguments()+'/?url='+encodeURIComponent(location.href.match(/^(.*\\/)[^\\/]*$/)[1])});\r\n this.cobrowser.startMirroring();\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhexport/xml.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n <?php echo '<?xml version=\"1.0\" encoding=\"utf-8\"?>';?>\r\n <chat>\r\n <id><![CDATA[ <?php echo $chat->id?> ]]></id>\r\n-<url><![CDATA[http://<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('chat/single')?>/<?php echo $chat->id?>]]></url>\r\n+<url><![CDATA[<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('chat/single')?>/<?php echo $chat->id?>]]></url>\r\n <requested_by><![CDATA[ <?php echo htmlspecialchars($chat->email)?> ]]></requested_by>\r\n <created_at type=\"datetime\"><?php echo date('c',$chat->time)?></created_at>\r\n <page_url><![CDATA[ <?php echo htmlspecialchars($chat->referrer)?> ]]></page_url>\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhfaq/embed.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n \tvar self = this;\n \tthis.showVotingForm = function() {\n \t\t  var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('faq/faqwidget')?>/(mode)/embed<?php $theme !== false ? print '/(theme)/'.$theme : ''?>\"+'?URLReferer='+locationCurrent+'&URLModule='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.url)+'&identifier='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.identifier);\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('faq/faqwidget')?>/(mode)/embed<?php $theme !== false ? print '/(theme)/'.$theme : ''?>\"+'?URLReferer='+locationCurrent+'&URLModule='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.url)+'&identifier='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.identifier);\n    \t\t  this.iframe_html = '<iframe id=\"lhcfaq_iframe_embed\" allowTransparency=\"true\" scrolling=\"no\" class=\"loading\" frameborder=\"0\" ' +\n                        ( this.initial_iframe_url != '' ? ' src=\"'    + this.initial_iframe_url + '\"' : '' ) +\n                        ' width=\"100%\"' +"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhfaq/embedcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -49,7 +49,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\nvar <?php echo $faqOptionsVariable;?> = {url:'replace_me_with_dynamic_url',identifier:''};\\n\"+\n       '(function() {'+\"\\n\"+\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'faq/embed'+id_theme+\"';\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'faq/embed'+id_theme+\"';\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhfaq/getstatus.tpl.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -144,7 +144,7 @@\n    \t\t  this.removeById('lhc_container_faq');\n \n    \t\t  var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('faq/faqwidget')?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?>\"+'?URLReferer='+locationCurrent+'&URLModule='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.url)+'&identifier='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.identifier);\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('faq/faqwidget')?><?php $theme !== false ? print '/(theme)/'.$theme->id : ''?>\"+'?URLReferer='+locationCurrent+'&URLModule='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.url)+'&identifier='+encodeURIComponent(<?php echo $faqOptionsVariable;?>.identifier);\n \n    \t\t  if (window.innerWidth < 1024) {\n           \t\twindow.open(this.initial_iframe_url,\"_blank\");\n@@ -158,10 +158,10 @@\n                        ' style=\"width: 490px; height: 350px;\"></iframe>';\n \n           this.iframe_html = '<div id=\"lhc_container_faq\">' +\n-                              '<div id=\"lhc_faq_header\"><?php include(erLhcoreClassDesign::designtpl('lhchat/widget_brand/faq.tpl.php')); ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"lhc_faq_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a></div><div id=\"lhc_iframe_container\">' +\n+                              '<div id=\"lhc_faq_header\"><?php include(erLhcoreClassDesign::designtpl('lhchat/widget_brand/faq.tpl.php')); ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"lhc_faq_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a></div><div id=\"lhc_iframe_container\">' +\n                               this.iframe_html + '</div></div>';\n \n-          raw_css = \"#lhc_container_faq * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial\\;line-height:100%\\;font-size:12px\\;box-sizing: content-box\\;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#lhc_container_faq img {border:0;}\\n#lhc_faq_title{float:left;}\\n#lhc_faq_header{position:relative;z-index:9990;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '15' ?>px;overflow:hidden;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;text-align:right;clear:both;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}\\n#lhc_faq_close{padding:2px;float:right;}\\n#lhc_faq_close:hover{opacity:0.4;}\\n#lhc_container_faq {-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab; overflow: hidden;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;background-color:#FFF\\;width:490px;\\nz-index:9990;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; }\\n#lhc_container_faq iframe{position:relative;display:block;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;}\\n#lhc_container_faq iframe.lhc-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n#lhc_container_faq #lhc_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n@media only screen and (max-width : 640px) {#lhc_container_faq{margin-bottom:5px;position:relative;right:0;bottom:0;top:0;width:100%;}#lhc_container_faq iframe{width:100% !important}}\";\n+          raw_css = \"#lhc_container_faq * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial\\;line-height:100%\\;font-size:12px\\;box-sizing: content-box\\;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#lhc_container_faq img {border:0;}\\n#lhc_faq_title{float:left;}\\n#lhc_faq_header{position:relative;z-index:9990;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '15' ?>px;overflow:hidden;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;text-align:right;clear:both;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}\\n#lhc_faq_close{padding:2px;float:right;}\\n#lhc_faq_close:hover{opacity:0.4;}\\n#lhc_container_faq {-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab; overflow: hidden;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;background-color:#FFF\\;width:490px;\\nz-index:9990;\\n position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px; }\\n#lhc_container_faq iframe{position:relative;display:block;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;}\\n#lhc_container_faq iframe.lhc-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }\\n#lhc_container_faq #lhc_iframe_container{border:<?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}\\n@media only screen and (max-width : 640px) {#lhc_container_faq{margin-bottom:5px;position:relative;right:0;bottom:0;top:0;width:100%;}#lhc_container_faq iframe{width:100% !important}}\";\n \n           if (!this.cssWasAdded) {\n           \t\tthis.cssWasAdded = true;\n@@ -184,7 +184,7 @@\n \n     showStatusWidget : function() {\n        var statusTEXT = '<a id=\"faq-icon\" class=\"status-icon\" href=\"#\" >'+<?php echo $faqOptionsVariable;?>.status_text+'</a>';\n-       var raw_css = \"#lhc_faq_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;line-height:100%;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0;}\\n#lhc_faq_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:#<?php $theme !== false ? print $theme->text_color : print '000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/help.png');?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#lhc_faq_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#lhc_faq_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;padding:5px 0px 3px 5px;width:190px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:9989;}\\n<?php if ($noresponse == false) : ?>@media only screen and (max-width : 640px) {#lhc_faq_container{position:relative;top:0;right:0;bottom:0;left:0;width:auto;border-radius:2px;box-shadow:none;border:1px solid #e3e3e3;margin-bottom:5px;}}\\n<?php endif;?>\";\n+       var raw_css = \"#lhc_faq_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;line-height:100%;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0;}\\n#lhc_faq_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:#<?php $theme !== false ? print $theme->text_color : print '000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/help.png');?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#lhc_faq_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#lhc_faq_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;padding:5px 0px 3px 5px;width:190px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:9989;}\\n<?php if ($noresponse == false) : ?>@media only screen and (max-width : 640px) {#lhc_faq_container{position:relative;top:0;right:0;bottom:0;left:0;width:auto;border-radius:2px;box-shadow:none;border:1px solid #e3e3e3;margin-bottom:5px;}}\\n<?php endif;?>\";\n        this.addCss(raw_css<?php ($theme !== false && $theme->custom_status_css_front !== '') ? print '+\\''.str_replace(array(\"\\n\",\"\\r\"), '', $theme->custom_status_css_front).'\\'' : '' ?>);\n        var htmlStatus = '<div id=\"lhc_faq_container\">'+statusTEXT+'</div>';\n        var fragment = this.appendHTML(htmlStatus);"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhfaq/htmlcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -88,7 +88,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\nvar <?php echo $faqOptionsVariable;?> = {status_text:'\"+textStatus+\"',url:'replace_me_with_dynamic_url',identifier:''};\\n\"+\n       '(function() {'+\"\\n\"+\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'faq/getstatus'+id_position+top+topposition+id_theme+id_disable_responsive+\"';\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'faq/getstatus'+id_position+top+topposition+id_theme+id_disable_responsive+\"';\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhform/collected.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n \t\r\n \t<div class=\"input-group\">\r\n         <div class=\"input-group-prepend\"><span class=\"input-group-text\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('form/collected','URL');?></span></div>\r\n-      <input type=\"text\" class=\"form-control\" value=\"<?php echo erLhcoreClassXMP::getBaseHost(). $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('form/fill')?>/<?php echo $form->id?>\">\r\n+      <input type=\"text\" class=\"form-control\" value=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('form/fill')?>/<?php echo $form->id?>\">\r\n     </div>\r\n     \r\n \t</div>\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhform/embed.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n var lhc_FormEmbed = function() {\n \tvar self = this;\n \tthis.showVotingForm = function() {\n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('form/formwidget')?>/<?php echo $form_id,$identifier?>\";\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('form/formwidget')?>/<?php echo $form_id,$identifier?>\";\n    \t\t  this.iframe_html = '<iframe id=\"lhcform_iframe_embed\" allowTransparency=\"true\" scrolling=\"no\" class=\"loading\" frameborder=\"0\" ' +\n                        ( this.initial_iframe_url != '' ? ' src=\"'    + this.initial_iframe_url + '\"' : '' ) +\n                        ' width=\"100%\"' +"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhform/embedcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -54,7 +54,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\nvar <?php echo $formOptionsVariable?> = {};\\n\"+\r\n       '(function() {'+\"\\n\"+\r\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\r\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'form/embed/'+formid+identifier+\"';\\n\"+\r\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'form/embed/'+formid+identifier+\"';\\n\"+\r\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\r\n       '})();'+\"\\n\"+\r\n     '</scr'+'ipt>';\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhgenericbot/message/content/quick_replies.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n             <li class=\"list-inline-item\">\r\n                 <a rel=\"noreferrer\" <?php if (isset($item['content']['button_id']) && $item['content']['button_id'] != '') : ?>id=\"<?php echo htmlspecialchars($item['content']['button_id'])?>\"<?php endif;?> <?php if (isset($item['content']['payload_message']) && $item['content']['payload_message'] != '') : ?>data-payload=<?php echo json_encode($item['content']['payload_message'])?> data-id=\"<?php echo $messageId?>\" onclick='lhinst.buttonClicked(<?php echo json_encode($item['content']['payload_message'])?>,<?php echo $messageId?>,$(this))'<?php endif;?> class=\"btn btn-sm btn-outline-primary btn-bot\" target=\"_blank\" href=\"<?php echo htmlspecialchars($item['content']['payload'])?>\"><i class=\"material-icons\"><?php if (isset($react) && $react == true) : ?>&#xf106;<?php else : ?>open_in_new<?php endif; ?></i><?php echo htmlspecialchars($item['content']['name'])?></a>\r\n             </li>\r\n-            <?php elseif ($item['type'] == 'file') : $fileReply = erLhcoreClassModelChatFile::fetch($item['content']['payload']); if ($fileReply instanceof erLhcoreClassModelChatFile) : $fileLink = '//'. $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$fileReply->id}/{$fileReply->security_hash}\"; ?>\r\n+            <?php elseif ($item['type'] == 'file') : $fileReply = erLhcoreClassModelChatFile::fetch($item['content']['payload']); if ($fileReply instanceof erLhcoreClassModelChatFile) : $fileLink = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$fileReply->id}/{$fileReply->security_hash}\"; ?>\r\n             <li class=\"list-inline-item\">\r\n                 <a rel=\"noreferrer\" <?php if (isset($item['content']['button_id']) && $item['content']['button_id'] != '') : ?>id=\"<?php echo htmlspecialchars($item['content']['button_id'])?>\"<?php endif;?> <?php if (isset($item['content']['payload_message']) && $item['content']['payload_message'] != '') : ?>data-payload=<?php echo json_encode($item['content']['payload_message'])?> data-id=\"<?php echo $messageId?>\" onclick='lhinst.buttonClicked(<?php echo json_encode($item['content']['payload_message'])?>,<?php echo $messageId?>,$(this))'<?php endif;?> class=\"btn btn-sm btn-outline-primary btn-bot\" target=\"_blank\" href=\"<?php echo $fileLink?>\"><i class=\"material-icons\"><?php if (isset($react) && $react == true) : ?>&#xf10e;<?php else : ?>attach_file<?php endif; ?></i><?php echo htmlspecialchars($item['content']['name'])?></a>\r\n             </li>\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhnotifications/settings.tpl.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -44,18 +44,18 @@\n \r\n     <div class=\"form-group\">\r\n         <label><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('notifications/notifications','HTTP Host*')?></label>\r\n-        <input type=\"text\" class=\"form-control\" name=\"http_host\" value=\"<?php (isset($n_settings['http_host']) && !empty($n_settings['http_host'])) ? print htmlspecialchars($n_settings['http_host']) : print $_SERVER['HTTP_HOST']?>\">\r\n+        <input type=\"text\" class=\"form-control\" name=\"http_host\" value=\"<?php (isset($n_settings['http_host']) && !empty($n_settings['http_host'])) ? print htmlspecialchars($n_settings['http_host']) : print str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?>\">\r\n         <small><i>You must provide host for notifications images.</i></small>\r\n     </div>\r\n \r\n     <div class=\"form-group\">\r\n         <label><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('notifications/notifications','Default Icon')?></label>\r\n-        <input type=\"text\" class=\"form-control\" name=\"icon\" value=\"<?php if (isset($n_settings['icon'])) : ?><?php print htmlspecialchars($n_settings['icon']); else : ?>https://<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/logo.png');?><?php endif;?>\">\r\n+        <input type=\"text\" class=\"form-control\" name=\"icon\" value=\"<?php if (isset($n_settings['icon'])) : ?><?php print htmlspecialchars($n_settings['icon']); else : ?>https://<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::design('images/general/logo.png');?><?php endif;?>\">\r\n     </div>\r\n \r\n     <div class=\"form-group\">\r\n         <label><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('notifications/notifications','Badge Icon')?></label>\r\n-        <input type=\"text\" class=\"form-control\" name=\"badge\" value=\"<?php if (isset($n_settings['badge'])) : ?><?php print htmlspecialchars($n_settings['badge']); else : ?>https://<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/logo.png');?><?php endif;?>\">\r\n+        <input type=\"text\" class=\"form-control\" name=\"badge\" value=\"<?php if (isset($n_settings['badge'])) : ?><?php print htmlspecialchars($n_settings['badge']); else : ?>https://<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::design('images/general/logo.png');?><?php endif;?>\">\r\n         <p><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('notifications/notifications','Notification badges are only being used on mobile, at least at the time of writing. It is used to replace the browser icon that is shown by default.')?></p>\r\n     </div>\r\n \r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhquestionary/embed.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n \n \tthis.showVotingForm = function() {\n \t\t  var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('questionary/votingwidget')?>/(mode)/embed<?php $theme !== false ? print '/(theme)/'.$theme : ''?>\"+'?URLReferer='+locationCurrent;\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('questionary/votingwidget')?>/(mode)/embed<?php $theme !== false ? print '/(theme)/'.$theme : ''?>\"+'?URLReferer='+locationCurrent;\n \n    \t\t  this.iframe_html = '<iframe id=\"lhc_sizing_questionary_page\" allowTransparency=\"true\" scrolling=\"no\" frameborder=\"0\" ' +\n                        ( this.initial_iframe_url != '' ? ' src=\"'    + this.initial_iframe_url + '\"' : '' ) +"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhquestionary/embedcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -44,7 +44,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\n\"+\n       '(function() {'+\"\\n\"+\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'questionary/embed'+id_theme+'\\';'+\"\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'questionary/embed'+id_theme+'\\';'+\"\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhquestionary/getstatus.tpl.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -114,7 +114,7 @@\n         var th = document.getElementsByTagName('head')[0];\n         var s = document.createElement('script');\n         s.setAttribute('type','text/javascript');\n-        s.setAttribute('src','<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('questionary/votingwidgetclosed')?>');\n+        s.setAttribute('src','<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('questionary/votingwidgetclosed')?>');\n         th.appendChild(s);\n         this.removeById('lhc_container_questionary');\n         this.addCookieAttribute('was_opened',true);\n@@ -149,7 +149,7 @@\n \n    \t\t  this.removeById('lhc_container_questionary');\n \t      var locationCurrent = encodeURIComponent(window.location.href.substring(window.location.protocol.length));\n-   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('questionary/votingwidget')?>\"+'?URLReferer='+locationCurrent;\n+   \t\t  this.initial_iframe_url = \"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('questionary/votingwidget')?>\"+'?URLReferer='+locationCurrent;\n \t\t  \n \t\t  if (window.innerWidth < 1024) {\n           \t\twindow.open(this.initial_iframe_url,\"_blank\");\n@@ -163,10 +163,10 @@\n                        ' style=\"width: <?php echo $widthwidget?>px; height: <?php echo $heightwidget?>px;\"></iframe>';\n \n           this.iframe_html = '<div id=\"lhc_container_questionary\">' +\n-                              '<div id=\"lhc_questionary_header\"><?php include(erLhcoreClassDesign::designtpl('lhchat/widget_brand/questionary.tpl.php')); ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"lhc_questionary_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a></div><div id=\"lhc_iframe_container\">' +\n+                              '<div id=\"lhc_questionary_header\"><?php include(erLhcoreClassDesign::designtpl('lhchat/widget_brand/questionary.tpl.php')); ?><a href=\"#\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" id=\"lhc_questionary_close\"><img src=\"<?php if ($theme !== false && $theme->close_image_url != '') : ?><?php echo $theme->close_image_url;?><?php else : ?><?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/cancel.png');?><?php endif;?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" alt=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus','Close')?>\" /></a></div><div id=\"lhc_iframe_container\">' +\n                               this.iframe_html + '</div></div>';\n \n-          raw_css = \"#lhc_container_questionary * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial\\;line-height:100%\\;font-size:12px\\;box-sizing: content-box\\;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#lhc_container_questionary img {border:0;}\\n#lhc_questionary_title{float:left;}\\n#lhc_questionary_header{position:relative;z-index:9990;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '15' ?>px;overflow:hidden;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;text-align:right;clear:both;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}\\n#lhc_questionary_close{padding:2px;float:right;}\\n#lhc_questionary_close:hover{opacity:0.4;}\\n#lhc_container_questionary {overflow: hidden;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;background-color:#FFF;z-index:9990;position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab; }\\n#lhc_container_questionary iframe{position:relative;display:block;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;}\\n#lhc_container_questionary iframe.lhc-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }#lhc_container_questionary #lhc_iframe_container{border: <?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}@media only screen and (max-width : 640px) {#lhc_container_questionary{margin-bottom:5px;position:relative;right:0;bottom:0;top:0;}#lhc_container_questionary iframe{width:100% !important}}\";\n+          raw_css = \"#lhc_container_questionary * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial\\;line-height:100%\\;font-size:12px\\;box-sizing: content-box\\;-moz-box-sizing:content-box;padding:0;margin:0;}\\n#lhc_container_questionary img {border:0;}\\n#lhc_questionary_title{float:left;}\\n#lhc_questionary_header{position:relative;z-index:9990;height:<?php ($theme !== false && $theme->header_height > 0) ? print $theme->header_height : print '15' ?>px;overflow:hidden;background-color:#<?php $theme !== false ? print $theme->header_background : print '525252' ?>;text-align:right;clear:both;padding:<?php ($theme !== false && $theme->header_padding > 0) ? print $theme->header_padding : print '5' ?>px;}\\n#lhc_questionary_close{padding:2px;float:right;}\\n#lhc_questionary_close:hover{opacity:0.4;}\\n#lhc_container_questionary {overflow: hidden;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;background-color:#FFF;z-index:9990;position: fixed;<?php echo $currentPosition['position_body']?>;-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;-moz-user-select:none; -khtml-user-drag:element;cursor: move;cursor: -moz-grab;cursor: -webkit-grab; }\\n#lhc_container_questionary iframe{position:relative;display:block;transition-property: height;transition-duration: 0.4s;-webkit-transition: height 0.4s ease-in-out;transition: height 0.4s;}\\n#lhc_container_questionary iframe.lhc-loading{\\nbackground: #FFF url(<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/general/loading.gif');?>) no-repeat center center; }#lhc_container_questionary #lhc_iframe_container{border: <?php ($theme !== false && $theme->widget_border_width > 0) ? print $theme->widget_border_width : print '1' ?>px solid #<?php $theme !== false ? print $theme->widget_border_color : print 'cccccc' ?>;border-top: 0;border-bottom-left-radius: 5px;border-bottom-right-radius: 5px;overflow: hidden;}@media only screen and (max-width : 640px) {#lhc_container_questionary{margin-bottom:5px;position:relative;right:0;bottom:0;top:0;}#lhc_container_questionary iframe{width:100% !important}}\";\n \n           if (!this.cssWasAdded) {\n           \t\tthis.cssWasAdded = true;\n@@ -187,7 +187,7 @@\n \n     showStatusWidget : function() {\n        var statusTEXT = '<a id=\"questionary-icon\" class=\"status-icon\" href=\"#\" >'+<?php echo $questionaryOptionsVariable?>.status_text+'</a>';\n-       var raw_css = \"#lhc_questionary_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;line-height:100%;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0}\\n#lhc_questionary_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:#<?php $theme !== false ? print $theme->text_color : print '000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php echo erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value?>//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('images/icons/plant.png');?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#lhc_questionary_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#lhc_questionary_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;padding:5px 0px 3px 5px;width:190px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:9989;}\\n<?php if ($noresponse == false) : ?>@media only screen and (max-width : 640px) {#lhc_questionary_container{position:relative;top:0;right:0;bottom:0;left:0;width:auto;border-radius:2px;box-shadow:none;border:1px solid #e3e3e3;margin-bottom:5px;}}\\n<?php endif;?>\";\n+       var raw_css = \"#lhc_questionary_container * {direction:<?php (erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == 'ltr' || erConfigClassLhConfig::getInstance()->getOverrideValue('site', 'dir_language') == '') ? print 'ltr;text-align:left;' : print 'rtl;text-align:right;'; ?>;font-family:arial;line-height:100%;font-size:12px;box-sizing: content-box;zoom:1;margin:0;padding:0}\\n#lhc_questionary_container .status-icon{text-decoration:none;font-size:12px;font-weight:bold;color:#<?php $theme !== false ? print $theme->text_color : print '000' ?>;display:block;padding:<?php echo $currentPosition['padding_text']?>;background:url('<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('images/icons/plant.png');?>') no-repeat <?php echo $currentPosition['background_position']?> center}\\n#lhc_questionary_container:hover{<?php echo $currentPosition['widget_hover']?>}\\n#lhc_questionary_container{box-sizing: content-box;<?php echo $currentPosition['widget_radius']?>-webkit-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);-moz-box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);box-shadow: <?php echo $currentPosition['shadow']?> rgba(50, 50, 50, 0.17);<?php echo $currentPosition['border_widget']?>;padding:5px 0px 3px 5px;width:190px;font-family:arial;font-size:12px;transition: 1s;position:fixed;<?php echo $currentPosition['position']?>;background-color:#<?php $theme !== false ? print $theme->onl_bcolor : print 'f6f6f6' ?>;z-index:9989;}\\n<?php if ($noresponse == false) : ?>@media only screen and (max-width : 640px) {#lhc_questionary_container{position:relative;top:0;right:0;bottom:0;left:0;width:auto;border-radius:2px;box-shadow:none;border:1px solid #e3e3e3;margin-bottom:5px;}}\\n<?php endif;?>\";\n        this.addCss(raw_css<?php ($theme !== false && $theme->custom_status_css !== '') ? print '+\\''.str_replace(array(\"\\n\",\"\\r\"), '', $theme->custom_status_css).'\\'' : '' ?>);\n        var htmlStatus = '<div id=\"lhc_questionary_container\">'+statusTEXT+'</div>';\n        var fragment = this.appendHTML(htmlStatus);"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhquestionary/htmlcode.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -115,7 +115,7 @@ function generateEmbedCode(){\n     var script = '<script type=\"text/javascript\">'+\"\\nvar <?php echo $questionaryOptionsVariable?> = {status_text:'\"+textStatus+\"'};\\n\"+\n       '(function() {'+\"\\n\"+\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'questionary/getstatus'+id_position+id_disable_responsive+id_show_widget_on_open+top+topposition+widthwidget+id_theme+heightwidget+\"';\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'questionary/getstatus'+id_position+id_disable_responsive+id_show_widget_on_open+top+topposition+widthwidget+id_theme+heightwidget+\"';\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhsystem/embedcode.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -76,7 +76,7 @@\n \n \n <p class=\"explain\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/htmlcode','Copy the code from the text area to the page where you want your status to appear');?></p>\n-<textarea style=\"width: 100%; height: 180px; font-size: 12px;\" id=\"HMLTContent\"><?php echo htmlspecialchars('<script type=\"text/javascript\" src=\"//'.$_SERVER['HTTP_HOST'].erLhcoreClassDesign::baseurl('chat/getstatus').'\"></script>')?></textarea>\n+<textarea style=\"width: 100%; height: 180px; font-size: 12px;\" id=\"HMLTContent\"><?php echo htmlspecialchars('<script type=\"text/javascript\" src=\"' . erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/getstatus').'\"></script>')?></textarea>\n \n <script type=\"text/javascript\">\n var default_site_access = '<?php echo erConfigClassLhConfig::getInstance()->getSetting( 'site', 'default_site_access' ); ?>/';\n@@ -107,7 +107,7 @@ function generateEmbedCode() {\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n         'var referrer = (document.referrer) ? encodeURIComponent(document.referrer.substr(document.referrer.indexOf(\\'://\\')+1)) : \\'\\';'+\"\\n\"+\n         'var location  = (document.location) ? encodeURIComponent(window.location.href.substring(window.location.protocol.length)) : \\'\\';'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'chat/getstatusembed<?php isset($userArgument) ? print $userArgument : ''?>'+uaArguments+id_hide_then_offline+id_theme+id_operator+id_show_leave_form+id_department+'?r=\\'+referrer+\\'&l=\\'+location;'+\"\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccess+'chat/getstatusembed<?php isset($userArgument) ? print $userArgument : ''?>'+uaArguments+id_hide_then_offline+id_theme+id_operator+id_show_leave_form+id_department+'?r=\\'+referrer+\\'&l=\\'+location;'+\"\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhsystem/htmlcode.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -211,7 +211,7 @@\n \n \n <p class=\"explain\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/htmlcode','Copy the code from the text area to the page where you want your status to appear');?></p>\n-<textarea style=\"width: 100%; height: 200px; font-size: 11px;\" class=\"form-control\" id=\"HMLTContent\"><?php echo htmlspecialchars('<script type=\"text/javascript\" src=\"http://'.$_SERVER['HTTP_HOST'].erLhcoreClassDesign::baseurl('chat/getstatus').'\"></script>')?></textarea>\n+<textarea style=\"width: 100%; height: 200px; font-size: 11px;\" class=\"form-control\" id=\"HMLTContent\"><?php echo htmlspecialchars('<script type=\"text/javascript\" src=\"'. erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/getstatus') .'\"></script>')?></textarea>\n \n <script type=\"text/javascript\">\n \n@@ -287,7 +287,7 @@ function generateEmbedCode(){\n         'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.async = true;'+\"\\n\"+\n         'var referrer = (document.referrer) ? encodeURIComponent(document.referrer.substr(document.referrer.indexOf(\\'://\\')+1)) : \\'\\';'+\"\\n\"+\n         'var location  = (document.location) ? encodeURIComponent(window.location.href.substring(window.location.protocol.length)) : \\'\\';'+\"\\n\"+\n-        'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+(id_detect_language == false ? siteAccess : '\\'+_l+\\'')+'chat/getstatus<?php isset($userArgument) ? print $userArgument : ''?>'+uaArguments+id_internal_popup+id_position+id_ma+id_hide_then_offline+id_disable_online_tracking+id_check_operator_message+top+topposition+id_show_leave_form+id_department+id_operator+id_identifier+id_disable_pro_active_invitations+id_theme+id_product+id_survey+'?r=\\'+referrer+\\'&l=\\'+location;'+\"\\n\"+\n+        'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+(id_detect_language == false ? siteAccess : '\\'+_l+\\'')+'chat/getstatus<?php isset($userArgument) ? print $userArgument : ''?>'+uaArguments+id_internal_popup+id_position+id_ma+id_hide_then_offline+id_disable_online_tracking+id_check_operator_message+top+topposition+id_show_leave_form+id_department+id_operator+id_identifier+id_disable_pro_active_invitations+id_theme+id_product+id_survey+'?r=\\'+referrer+\\'&l=\\'+location;'+\"\\n\"+\n         'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n       '})();'+\"\\n\"+\n     '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhsystem/htmlcodebeta.tpl.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -271,7 +271,7 @@ function staticImageGeneration(){\n                     var operator = $('#id_operator').val() > 0 ? '/(operator)/'+$('#id_operator').val() : '';\n                     var theme = $('#ThemeID').val() != 0 ? '/(theme)/'+$('#ThemeID').val() : '';\n \n-                    var baseURL = '<?php echo erLhcoreClassXMP::getBaseHost()?><?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurl('restapi/onlineimage')?>' + department + operator + theme + '?' + onlineText + offlineText + width;\n+                    var baseURL = '<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurl('restapi/onlineimage')?>' + department + operator + theme + '?' + onlineText + offlineText + width;\n \n                     $('#static-image-url').attr('src', baseURL);\n                     $('#static-image-code').val('<a href=\"'+$('#static-url-generated').val()+'\">'+'<img src=\"' + baseURL + '\" alt=\"\" /></a>');\n@@ -396,15 +396,15 @@ function generateEmbedCode(){\n                 \"} else {_l = _l[0].toLowerCase() + _l[1].toLowerCase(); if ('<?php echo erConfigClassLhConfig::getInstance()->getSetting( 'site', 'default_site_access' )?>' == _l) {_l = ''} else {LHC_API.args.lang = _l + '/';}}\\n\";\n         }\n \n-        $('#static-url-generated').val($('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccessStatic +'chat/start'+id_survey_static+id_operator_static+id_fresh_status+id_department_static+id_theme_static+id_identifier_static);\n+        $('#static-url-generated').val($('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>'+siteAccessStatic +'chat/start'+id_survey_static+id_operator_static+id_fresh_status+id_department_static+id_theme_static+id_identifier_static);\n         staticImageGeneration();\n \n         var script = '<script>'+\n-            'var LHC_API = LHC_API||{};'+\"\\n\"+'LHC_API.args = {mode:\\''+id_widget_mode+'\\',lhc_base_url:\\'' + $('#HttpMode').val() + '//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect()?>\\',wheight:'+$('#id_widget_height').val()+',wwidth:'+$('#id_widget_width').val()+',pheight:'+$('#id_popup_height').val()+',pwidth:'+$('#id_popup_width').val()+id_operator+id_embed_domain+id_fresh+id_show_leave_form+id_department+id_theme+id_survey+id_widget_position+id_check_messages_operator+id_disable_pro_active_invitations+id_identifier+siteAccess+id_position_placement+'};\\n'+\n+            'var LHC_API = LHC_API||{};'+\"\\n\"+'LHC_API.args = {mode:\\''+id_widget_mode+'\\',lhc_base_url:\\'' + $('#HttpMode').val() + '//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurldirect()?>\\',wheight:'+$('#id_widget_height').val()+',wwidth:'+$('#id_widget_width').val()+',pheight:'+$('#id_popup_height').val()+',pwidth:'+$('#id_popup_width').val()+id_operator+id_embed_domain+id_fresh+id_show_leave_form+id_department+id_theme+id_survey+id_widget_position+id_check_messages_operator+id_disable_pro_active_invitations+id_identifier+siteAccess+id_position_placement+'};\\n'+\n             '(function() {'+\"\\n\"+langDetectScript+\n             'var po = document.createElement(\\'script\\'); po.type = \\'text/javascript\\'; po.setAttribute(\\'crossorigin\\',\\'anonymous\\'); po.async = true;'+\"\\n\"+\n             'var date = new Date();'+\n-            'po.src = \\''+$('#HttpMode').val()+'//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('js/widgetv2/index.js')?>?\\'+(\"\"+date.getFullYear() + date.getMonth() + date.getDate());'+\"\\n\"+\n+            'po.src = \\''+$('#HttpMode').val()+'//<?php echo str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::design('js/widgetv2/index.js')?>?\\'+(\"\"+date.getFullYear() + date.getMonth() + date.getDate());'+\"\\n\"+\n             'var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(po, s);'+\"\\n\"+\n             '})();'+\"\\n\"+\n             '</scr'+'ipt>';"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhsystem/update.tpl.php",
          "status": "modified",
          "additions": 37,
          "deletions": 1,
          "patch": "@@ -9,7 +9,43 @@\n \t\t<h5><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Your version')?> - <?php echo sprintf(\"%0.2f\", erLhcoreClassUpdate::LHC_RELEASE/100);?></h5>\r\n \t\t<h5><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Current version')?> - <span class=\"text-success\" id=\"recent-version\">...</span></h5>\r\n \r\n-        <p class=\"font-weight-bold\">More information</p>\r\n+        <p class=\"font-weight-bold\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Status/security checks')?></p>\r\n+        <ul>\r\n+            <li><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Strong secret hash')?> -\r\n+            <?php if (strlen(erConfigClassLhConfig::getInstance()->getSetting( 'site', 'secrethash' )) < 50) : ?>\r\n+                <span class=\"badge badge-danger\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Weak')?></span>\r\n+            <?php else : ?>\r\n+                <span class=\"badge badge-success\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Strong')?></span>\r\n+            <?php endif; ?>\r\n+                <a target=\"_blank\" href=\"https://doc.livehelperchat.com/docs/security#secret-hash\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','More information')?></a>\r\n+            </li>\r\n+            <li><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Strong export hash')?> -\r\n+            <?php if (strlen(erLhcoreClassModelChatConfig::fetch('export_hash')->current_value) < 50) : ?>\r\n+                <span class=\"badge badge-danger\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Weak')?></span>\r\n+            <?php else : ?>\r\n+                <span class=\"badge badge-success\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Strong')?></span>\r\n+            <?php endif; ?>\r\n+                <a target=\"_blank\" href=\"https://doc.livehelperchat.com/docs/security#export-hash\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','More information')?></a>\r\n+            </li>\r\n+            <li><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Trusted host')?> -\r\n+            <?php if (!is_array(erConfigClassLhConfig::getInstance()->getSetting( 'site', 'trusted_host_patterns', false )) || empty(erConfigClassLhConfig::getInstance()->getSetting( 'site', 'trusted_host_patterns', false ))) : ?>\r\n+                <span class=\"badge badge-danger\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','not set')?></span>\r\n+            <?php else : ?>\r\n+                <span class=\"badge badge-success\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','set')?></span>\r\n+            <?php endif; ?>\r\n+                <a target=\"_blank\" href=\"https://doc.livehelperchat.com/docs/security#trusted-hosts-and-site-address\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','More information')?></a>\r\n+            </li>\r\n+            <li><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','Site address')?> -\r\n+            <?php if (!erConfigClassLhConfig::getInstance()->getSetting( 'site', 'site_address', false )) : ?>\r\n+                <span class=\"badge badge-danger\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','not set')?></span>\r\n+            <?php else : ?>\r\n+                <span class=\"badge badge-success\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','set')?> - <?php echo htmlspecialchars(erConfigClassLhConfig::getInstance()->getSetting( 'site', 'site_address', false )); ?></span>\r\n+            <?php endif; ?>\r\n+                <a target=\"_blank\" href=\"https://doc.livehelperchat.com/docs/security#trusted-hosts-and-site-address\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','More information')?></a>\r\n+            </li>\r\n+        </ul>\r\n+\r\n+        <p class=\"font-weight-bold\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','More information')?></p>\r\n \r\n         <ul>\r\n             <li><a rel=\"noreferrer\" href=\"http://livehelperchat.com/news-5c.html\" target=\"_blank\"><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/update','News')?></a></li>\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhuser/autologinconfig.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -106,7 +106,7 @@ function hideTooltip() {\n                     <div class=\"col-12\">\r\n                         <div class=\"form-group\">\r\n                             <div class=\"input-group\">\r\n-                                <input type=\"text\" class=\"form-control\" readonly=\"readonly\" id=\"copy-url-<?php echo $i?>\" data-original-url=\"<?php echo erLhcoreClassSystem::$httpsMode == 'true' ? 'https://' : 'http://'?><?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::baseurldirect('/')?>\" value=\"\">\r\n+                                <input type=\"text\" class=\"form-control\" readonly=\"readonly\" id=\"copy-url-<?php echo $i?>\" data-original-url=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('/')?>\" value=\"\">\r\n                                 <div class=\"input-group-append\"><span class=\"input-group-text\"><a onclick=\"copyURL($(this))\" data-index=\"<?php echo $i?>\" data-original-title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('users/autologin','Copied!')?>\" title=\"<?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('users/autologin','Copy URL to clipboard')?>\"><i class=\"material-icons mr-0\">&#xE14D;</i></a></span></div>\r\n                             </div>\r\n                         </div>\r"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhwebhooks/form_incoming.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -20,7 +20,7 @@\n \n <div class=\"form-group\">\n     <label><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('chat/webhooks','URL to put in third party Rest API service');?></label>\n-    <input type=\"text\" ng-non-bindable class=\"form-control form-control-sm\" id=\"api-incoming-url\" data-base=\"<?php echo erLhcoreClassXMP::getBaseHost().(isset($_SERVER['HTTP_HOST']) ? $_SERVER['HTTP_HOST'] : '')?><?php echo erLhcoreClassDesign::baseurldirect('webhooks/incoming')?>/\" value=\"<?php echo erLhcoreClassXMP::getBaseHost().(isset($_SERVER['HTTP_HOST']) ? $_SERVER['HTTP_HOST'] : '')?><?php echo erLhcoreClassDesign::baseurldirect('webhooks/incoming')?>/<?php echo htmlspecialchars($item->identifier);?>\">\n+    <input type=\"text\" ng-non-bindable class=\"form-control form-control-sm\" id=\"api-incoming-url\" data-base=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('webhooks/incoming')?>/\" value=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::baseurldirect('webhooks/incoming')?>/<?php echo htmlspecialchars($item->identifier);?>\">\n </div>\n \n <div class=\"form-group\">"
        },
        {
          "filename": "lhc_web/design/defaulttheme/tpl/lhxmp/xmp.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -109,7 +109,7 @@\n \t\t        <label><input type=\"radio\" name=\"use_standard_xmp\" value=\"1\" <?php isset($xmp_data['use_standard_xmp']) && ($xmp_data['use_standard_xmp'] == '1') ? print 'checked=\"checked\"' : '' ?> /> <?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/xmpp','Use GTalk for messaging'); ?></label>\r\n \t\t\t\t<h4><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/xmpp','Information for your google app')?></h4>\t\r\n \t\t\t\t<label><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/xmpp','Redirect URL, this url you will have to enter in your google app configuration')?></label>\r\n-\t\t\t\t<input class=\"form-control\" type=\"text\" value=\"<?php echo htmlspecialchars(erLhcoreClassXMP::getBaseHost().$_SERVER['HTTP_HOST'])?><?php echo erLhcoreClassDesign::baseurl('xmp/configuration')?>/(gtalkoauth)/true\" />\r\n+\t\t\t\t<input class=\"form-control\" type=\"text\" value=\"<?php echo htmlspecialchars(erLhcoreClassSystem::getHost())?><?php echo erLhcoreClassDesign::baseurl('xmp/configuration')?>/(gtalkoauth)/true\" />\r\n \t\t\t\t\r\n \t\t\t\t\r\n \t\t\t\t<h4><?php echo erTranslationClassLhTranslation::getInstance()->getTranslation('system/xmpp','Enter your app information bellow')?></h4>\t\t\t\t\t\t\r"
        },
        {
          "filename": "lhc_web/lib/core/lhbbcode/lhbbcode.php",
          "status": "modified",
          "additions": 1,
          "deletions": 12,
          "patch": "@@ -795,18 +795,7 @@ public static function _make_youtube_block($matches) {\n    }\n \n    public static function getHost() {\n-\n-       if (isset($_SERVER['HTTP_HOST'])) {\n-           $site_address = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] ;\n-       } else if (class_exists('erLhcoreClassInstance')) {\n-           $site_address = 'https://' . erLhcoreClassInstance::$instanceChat->address . '.' . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'seller_domain');\n-       } else if (class_exists('erLhcoreClassExtensionLhcphpresque')) {\n-           $site_address = erLhcoreClassModule::getExtensionInstance('erLhcoreClassExtensionLhcphpresque')->settings['site_address'];\n-       } else {\n-           $site_address = '';\n-       }\n-\n-       return $site_address;\n+        return erLhcoreClassSystem::getHost();\n    }\n \n    public static function _make_upload_link($matches){"
        },
        {
          "filename": "lhc_web/lib/core/lhbbcode/lhbbcode_cleanup.php",
          "status": "modified",
          "additions": 1,
          "deletions": 12,
          "patch": "@@ -831,18 +831,7 @@ public static function _make_url_file($matches)\n     }\n \n     public static function getHost() {\n-\n-        if (isset($_SERVER['HTTP_HOST'])) {\n-            $site_address = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] ;\n-        } else if (class_exists('erLhcoreClassInstance')) {\n-            $site_address = 'https://' . erLhcoreClassInstance::$instanceChat->address . '.' . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'seller_domain');\n-        } else if (class_exists('erLhcoreClassExtensionLhcphpresque')) {\n-            $site_address = erLhcoreClassModule::getExtensionInstance('erLhcoreClassExtensionLhcphpresque')->settings['site_address'];\n-        } else {\n-            $site_address = '';\n-        }\n-\n-        return $site_address;\n+        return erLhcoreClassSystem::getHost();\n     }\n \n     public static function _make_url_survey($matches)"
        },
        {
          "filename": "lhc_web/lib/core/lhchat/lhchatcommand.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -56,7 +56,7 @@ public static function showModal($params) {\n         $URL = array_shift($paramsURL);\n \n         if (is_numeric($URL)) {\n-            $URL =  (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . (isset($_SERVER['HTTP_HOST']) ? $_SERVER['HTTP_HOST'] : '') . erLhcoreClassDesign::baseurldirect('form/formwidget') . '/' . $URL;\n+            $URL = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('form/formwidget') . '/' . $URL;\n         }\n \n         // Store as message to visitor"
        },
        {
          "filename": "lhc_web/lib/core/lhchat/lhchatexport.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -498,7 +498,7 @@ public static function chatListExportXLS($chats, $params = array()) {\n                 \t$from = null;\r\n                 }\r\n \r\n-                $url = erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('chat/single/'.$item->id));\r\n+                $url = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('chat/single/'.$item->id));\r\n \r\n                 $chat_actions = '';\r\n \r"
        },
        {
          "filename": "lhc_web/lib/core/lhchat/lhchatmail.php",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -115,7 +115,7 @@ public static function validateSendMail(erLhAbstractModelEmailTemplate & $sendMa\n \n         $cfgSite = erConfigClassLhConfig::getInstance();\n         $secretHash = $cfgSite->getSetting( 'site', 'secrethash' );\n-        $url = erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('chat/readchatmail') . '/' . $chat->id . '/' . sha1($secretHash . $chat->hash . $chat->id);\n+        $url = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('chat/readchatmail') . '/' . $chat->id . '/' . sha1($secretHash . $chat->hash . $chat->id);\n \n     \t$sendMail->content = str_replace(array('{user_chat_nick}','{messages_content}','{chat_id}','{survey}','{operator_name}','{chat_link}'), array($chat->nick, $tpl->fetch(), $chat->id, $surveyContent, $chat->plain_user_name, $url), $sendMail->content);\n     \t\n@@ -218,7 +218,7 @@ public static function sendMailFAQ($faq) {\n \n     \t$mail->Subject = $sendMail->subject;\n     \t\n-    \t$mail->Body = str_replace(array('{email}','{question}','{url_request}','{url_question}'), array($faq->email,$faq->question,erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('faq/view/'.$faq->id)),$faq->url), $sendMail->content);\n+    \t$mail->Body = str_replace(array('{email}','{question}','{url_request}','{url_question}'), array($faq->email,$faq->question,erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('faq/view/'.$faq->id)),$faq->url), $sendMail->content);\n     \t\n     \tif ($sendMail->recipient != '') { // Perhaps template has default recipient\n     \t\t$emailRecipient = explode(',',$sendMail->recipient);\n@@ -280,7 +280,7 @@ public static function sendMailRequest($inputData, erLhcoreClassModelChat $chat,\n     \t\n     \t$prefillchat = '-'; \n     \tif (isset($params['chatprefill']) && $params['chatprefill'] instanceof erLhcoreClassModelChat){\n-    \t\t$prefillchat = erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('chat/single/'.$params['chatprefill']->id));\n+    \t\t$prefillchat = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('chat/single/'.$params['chatprefill']->id));\n     \t}\n     \t\n     \t// Format user friendly additional data\n@@ -415,7 +415,7 @@ public static function sendMailUnacceptedChat(erLhcoreClassModelChat $chat, $tem\n     \t    \t\n     \tforeach ($emailRecipient as $receiver) {   \n     \t\t$veryfyEmail = \tsha1(sha1($receiver.$secretHash).$secretHash);\n-    \t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{user_name}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{country}','{city}'), array($surveyContent, ($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->user_name,$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,erLhcoreClassIPDetect::getIP(),(string)$chat->department, erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$chat->country_name,$chat->city), $sendMail->content);\n+    \t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{user_name}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{country}','{city}'), array($surveyContent, ($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->user_name,$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,erLhcoreClassIPDetect::getIP(),(string)$chat->department, erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$chat->country_name,$chat->city), $sendMail->content);\n     \t\t$mail->AddAddress( $receiver );\n     \t\t$mail->Send();\n     \t\t$mail->ClearAddresses();\n@@ -426,7 +426,7 @@ public static function sendMailUnacceptedChat(erLhcoreClassModelChat $chat, $tem\n     \t\tforeach ($recipientsBCC as $receiver) {\n     \t\t\t$receiver = trim($receiver);\n     \t\t\t$veryfyEmail = \tsha1(sha1($receiver.$secretHash).$secretHash);\n-    \t\t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{user_name}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{country}','{city}'), array($surveyContent, ($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->user_name,$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,erLhcoreClassIPDetect::getIP(),(string)$chat->department, erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$chat->country_name,$chat->city), $sendMail->content);\n+    \t\t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{user_name}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{country}','{city}'), array($surveyContent, ($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->user_name,$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,erLhcoreClassIPDetect::getIP(),(string)$chat->department, erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$chat->country_name,$chat->city), $sendMail->content);\n     \t\t\t$mail->AddAddress( $receiver );\n     \t\t\t$mail->Send();\n     \t\t\t$mail->ClearAddresses();    \t\t\t\n@@ -491,7 +491,7 @@ public static function informFormFilled($formCollected, $params = array()) {\n     \t\n     \t$mail->FromName = $sendMail->from_name;    \t\n     \t$mail->Subject = str_replace(array('{form_name}'),array($formCollected->form),$sendMail->subject);   \t     \t\n-    \t$mail->Body = str_replace(array('{identifier}','{form_name}','{content}','{ip}','{url_download}','{url_view}'), array($formCollected->identifier,(string)$formCollected->form, $formCollected->form_content, $formCollected->ip, erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/downloaditem/'.$formCollected->id)), erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/viewcollected/'.$formCollected->id))), $sendMail->content);\n+    \t$mail->Body = str_replace(array('{identifier}','{form_name}','{content}','{ip}','{url_download}','{url_view}'), array($formCollected->identifier,(string)$formCollected->form, $formCollected->form_content, $formCollected->ip, erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/downloaditem/'.$formCollected->id)), erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/viewcollected/'.$formCollected->id))), $sendMail->content);\n \n     \t$emailRecipient = array();\n     \tif ($formCollected->form->recipient != '') {\n@@ -655,7 +655,7 @@ public static function informChatClosed(erLhcoreClassModelChat $chat, $operator\n \n     \tforeach ($emailRecipient as $receiver) {   \n     \t\t$veryfyEmail = \tsha1(sha1($receiver.$secretHash).$secretHash);\n-    \t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{operator}','{country}','{city}'), array($surveyContent,($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,$chat->ip,(string)$chat->department,(isset($_SERVER['HTTP_HOST'])) ?  erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] : erLhcoreClassModelChatConfig::fetch('customer_site_url')->current_value . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$operator,$chat->country_name,$chat->city), $sendMail->content);\n+    \t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{operator}','{country}','{city}'), array($surveyContent,($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,$chat->ip,(string)$chat->department,erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$operator,$chat->country_name,$chat->city), $sendMail->content);\n     \t\t$mail->AddAddress( $receiver );    \t\t    \t\t\n     \t\t$mail->Send();\n     \t\t$mail->ClearAddresses();\n@@ -666,7 +666,7 @@ public static function informChatClosed(erLhcoreClassModelChat $chat, $operator\n     \t\tforeach ($recipientsBCC as $receiver) {    \t\t\t\n     \t\t\t$receiver = trim($receiver);\n     \t\t\t$veryfyEmail = \tsha1(sha1($receiver.$secretHash).$secretHash);\n-\t    \t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{operator}','{country}','{city}'), array($surveyContent,($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,$chat->ip,(string)$chat->department,(isset($_SERVER['HTTP_HOST'])) ?  erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] : erLhcoreClassModelChatConfig::fetch('customer_site_url')->current_value . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$operator,$chat->country_name,$chat->city), $sendMail->content);\n+\t    \t\t$mail->Body = str_replace(array('{survey}','{chat_duration}','{waited}','{created}','{user_left}','{chat_id}','{phone}','{name}','{email}','{message}','{additional_data}','{url_request}','{ip}','{department}','{url_accept}','{operator}','{country}','{city}'), array($surveyContent,($chat->chat_duration > 0 ? $chat->chat_duration_front : '-'), ($chat->wait_time > 0 ? $chat->wait_time_front : '-'), $chat->time_created_front, ($chat->user_closed_ts > 0 && $chat->user_status == 1 ? $chat->user_closed_ts_front : '-'),$chat->id,$chat->phone,$chat->nick,$chat->email,$messagesContent,$additional_data,$chat->referrer,$chat->ip,(string)$chat->department,erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$receiver,$operator,$chat->country_name,$chat->city), $sendMail->content);\n \t    \t\t$mail->AddAddress( $receiver );    \t\t    \t\t\n \t    \t\t$mail->Send();\n \t    \t\t$mail->ClearAddresses();    \t\t\t \n@@ -796,7 +796,7 @@ public static function informVisitorReturned($item) {\n                 $item->referrer,\n                 $item->ip,\n                 ($chat instanceof erLhcoreClassModelChat ? (string)$chat->department : '-'),\n-                (isset($_SERVER['HTTP_HOST']) ? erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . $appendURL : erLhcoreClassModelChatConfig::fetch('customer_site_url')->current_value . $appendURL),\n+                erLhcoreClassSystem::getHost() . $appendURL,\n                 $item->user_country_name,\n                 $item->city),\n                 $sendMail->content);\n@@ -843,7 +843,7 @@ public static function informVisitorReturned($item) {\n                     $item->referrer,\n                     $item->ip,\n                     ($chat instanceof erLhcoreClassModelChat ? (string)$chat->department : '-'),\n-                    (isset($_SERVER['HTTP_HOST']) ? erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . $appendURL : erLhcoreClassModelChatConfig::fetch('customer_site_url')->current_value . $appendURL),\n+                    erLhcoreClassSystem::getHost() . $appendURL,\n                     $item->user_country_name,\n                     $item->city),\n                     $sendMail->content);"
        },
        {
          "filename": "lhc_web/lib/core/lhcore/lhsys.php",
          "status": "modified",
          "additions": 48,
          "deletions": 1,
          "patch": "@@ -469,7 +469,54 @@ public static function setSiteAccessByLocale($locale) {\n     \t\t}    \t\t\n     \t}\n     }\n-    \n+\n+    public static function validHttpHost($host) {\n+        return substr_count($host, '.') <= 100\n+            && substr_count($host, ':') <= 100\n+            && preg_match('/^\\[?(?:[a-zA-Z0-9-:\\]_]+\\.?)+$/', $host)\n+            && self::isTrustedHost($host);\n+    }\n+\n+    // Borrowed from Drupal\n+    public static function isTrustedHost($host) {\n+        $trusted_host_patterns = erConfigClassLhConfig::getInstance()->getSetting( 'site', 'trusted_host_patterns', false);\n+        if (PHP_SAPI !== 'cli' && is_array($trusted_host_patterns) && !empty($trusted_host_patterns)) {\n+            foreach ($trusted_host_patterns as $pattern) {\n+                $pattern = sprintf('{%s}i', str_replace('}', '\\\\}', $pattern));\n+                if (preg_match($pattern, $host)) {\n+                    return true;\n+                }\n+            }\n+            return false;\n+        }\n+        return false;\n+    }\n+\n+    public static function getHost() {\n+\n+        static $site_address = null;\n+\n+        if ($site_address !== null) {\n+            return $site_address;\n+        }\n+\n+        if (isset($_SERVER['HTTP_HOST']) && self::validHttpHost($_SERVER['HTTP_HOST'])) {\n+            $site_address = (erLhcoreClassSystem::$httpsMode == true || erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value == 'https:' ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] ;\n+        } else if (class_exists('erLhcoreClassInstance')) {\n+            $site_address = 'https://' . erLhcoreClassInstance::$instanceChat->address . '.' . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'seller_domain');\n+        } else if (($site_address = erConfigClassLhConfig::getInstance()->getSetting( 'site', 'site_address', false)) && $site_address != '') {\n+            return $site_address;\n+        } else if (class_exists('erLhcoreClassExtensionLhcphpresque')) {\n+            $site_address = erLhcoreClassModule::getExtensionInstance('erLhcoreClassExtensionLhcphpresque')->settings['site_address'];\n+        } elseif (isset($_SERVER['HTTP_HOST']) && (!is_array(erConfigClassLhConfig::getInstance()->getSetting( 'site', 'trusted_host_patterns', false)) || empty(erConfigClassLhConfig::getInstance()->getSetting( 'site', 'trusted_host_patterns', false)))) {\n+            $site_address = (erLhcoreClassSystem::$httpsMode == true || erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value == 'https:' ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] ; // trust only if match array not set\n+        } else {\n+            $site_address = 'http://localhost'; // We could not determine any valid host\n+        }\n+\n+        return $site_address;\n+    }\n+\n     function wwwDir()\n     {\n         return (self::$prependDomain ? (self::$httpsMode == true ? 'https:' : '') . '//' . $_SERVER['HTTP_HOST'] : '') . $this->WWWDir;"
        },
        {
          "filename": "lhc_web/lib/core/lhcore/lhupdate.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -12,6 +12,7 @@ public static function doTablesUpdate($definition){\n         $errorMessages = array();\r\n \r\n \t\ttry {\r\n+            $db->query('SET GLOBAL innodb_strict_mode = 0;');\r\n             $db->query('SET GLOBAL innodb_file_per_table=1;');\r\n             $db->query('SET GLOBAL innodb_large_prefix=1;');\r\n         } catch (Exception $e) {\r"
        },
        {
          "filename": "lhc_web/lib/core/lhform/lhformrenderer.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -635,7 +635,7 @@ public static function renderInputTypeFile($params) {\n     \t} else {\r\n     \t\tif (isset(self::$collectedInfo[$params['name']]['value'])){\r\n     \t\t\t$valueContent = self::$collectedInfo[$params['name']]['value'];\r\n-    \t\t\t$downloadLink = \"<a href=\\\"http://\".$_SERVER['HTTP_HOST'].erLhcoreClassDesign::baseurl('form/download').'/'.self::$collectedObject->id.'/'.self::$collectedObject->hash.'/'.$params['name'].\"\\\">Download (\".htmlspecialchars($valueContent['name']).\")</a>\";\r\n+    \t\t\t$downloadLink = \"<a href=\\\"\".erLhcoreClassSystem::getHost().erLhcoreClassDesign::baseurl('form/download').'/'.self::$collectedObject->id.'/'.self::$collectedObject->hash.'/'.$params['name'].\"\\\">Download (\".htmlspecialchars($valueContent['name']).\")</a>\";\r\n     \t\t}\r\n     \t}\r\n     \t\r"
        },
        {
          "filename": "lhc_web/lib/core/lhgenericbot/actionTypes/lhgenericbotactionrestapi.php",
          "status": "modified",
          "additions": 3,
          "deletions": 30,
          "patch": "@@ -240,16 +240,7 @@ public static function makeRequest($host, $methodSettings, $paramsCustomer)\n                 $file = erLhcoreClassModelChatFile::fetch($fileID);\n                 if (is_object($file) && $hash == $file->security_hash) {\n \n-                    if (isset($_SERVER['HTTP_HOST'])) {\n-                        $url = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$file->id}/{$hash}\";\n-                    } else {\n-                        if (class_exists('erLhcoreClassInstance')) {\n-                            $site_address = 'https://' . erLhcoreClassInstance::$instanceChat->address . '.' . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'seller_domain');\n-                        } else {\n-                            $site_address = erLhcoreClassModule::getExtensionInstance('erLhcoreClassExtensionLhcphpresque')->settings['site_address'];\n-                        }\n-                        $url = $site_address . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$file->id}/{$hash}\";\n-                    }\n+                    $url = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$file->id}/{$hash}\";;\n \n                     $media[] = array(\n                         'id' => $file->id,\n@@ -361,31 +352,13 @@ public static function makeRequest($host, $methodSettings, $paramsCustomer)\n \n                 if ($mediaFile->remote_file !== true) {\n                     $file_body = 'data:'.$mediaFile->type.';base64,'.base64_encode(file_get_contents($mediaFile->file_path_server));\n-                    if (isset($_SERVER['HTTP_HOST'])) {\n-                        $file_url = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$mediaFile->id}/{$mediaFile->security_hash}\";\n-                    } else {\n-                        if (class_exists('erLhcoreClassInstance')) {\n-                            $site_address = 'https://' . erLhcoreClassInstance::$instanceChat->address . '.' . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'seller_domain');\n-                        } else {\n-                            $site_address = erLhcoreClassModule::getExtensionInstance('erLhcoreClassExtensionLhcphpresque')->settings['site_address'];\n-                        }\n-                        $file_url = $site_address . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$mediaFile->id}/{$mediaFile->security_hash}\";\n-                    }\n+                    $file_url = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$mediaFile->id}/{$mediaFile->security_hash}\";\n                 } else {\n                     $file_body = '';\n                     if (strpos($file->remote_url,'http://') !== false || strpos($file->remote_url,'https://') !== false) {\n                         $file_url = $file->remote_url;\n                     } else {\n-                        if (isset($_SERVER['HTTP_HOST'])) {\n-                            $file_url = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . $file->remote_url;\n-                        } else {\n-                            if (class_exists('erLhcoreClassInstance')) {\n-                                $site_address = 'https://' . erLhcoreClassInstance::$instanceChat->address . '.' . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'seller_domain');\n-                            } else {\n-                                $site_address = erLhcoreClassModule::getExtensionInstance('erLhcoreClassExtensionLhcphpresque')->settings['site_address'];\n-                            }\n-                            $file_url = $site_address . $file->remote_url;\n-                        }\n+                        $file_url = erLhcoreClassSystem::getHost() . $file->remote_url;;\n                     }\n                 }\n              }"
        },
        {
          "filename": "lhc_web/lib/core/lhrestapi/lhrestapivalidator.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -713,7 +713,7 @@ public static function validateChatList()\n \n         if (in_array('link',$prefillFields)) {\n             foreach ($chats as $index => $chat) {\n-                $chats[$index]->link = erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('chat/single/'.$chat->id));\n+                $chats[$index]->link = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('user/login').'/(r)/'.rawurlencode(base64_encode('chat/single/'.$chat->id));\n             }\n         }\n "
        },
        {
          "filename": "lhc_web/lib/core/lhxmp/lhxmp.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -247,14 +247,14 @@ public static function sendXMPMessage($chat, $params = array()) {\n \t\t\t\t\t\r\n \t\t\t\t\tforeach ($emailRecipient as $email) {\t\t\t\r\n \t\t\t\t\t\t$veryfyEmail = \tsha1(sha1($email.$secretHash).$secretHash);\r\n-\t\t\t\t\t\t$messagesParsed = str_replace(array('{messages}','{url_accept}','{chat_id}','{user_name}','{department}'), array($messagesContent,self::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$email,$chat->id,$chat->user_name,(string)$chat->department),$data[$templateMessage]);\r\n+\t\t\t\t\t\t$messagesParsed = str_replace(array('{messages}','{url_accept}','{chat_id}','{user_name}','{department}'), array($messagesContent,erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$email,$chat->id,$chat->user_name,(string)$chat->department),$data[$templateMessage]);\r\n \t\t\t\t\t\t$conn->message($email,$messagesParsed);\r\n \t\t\t\t\t}\r\n \t\t\t\t\t\r\n \t\t\t\t\tforeach ($groupRecipients as $email) {\r\n \t\t\t\t\t\tlist($emailGroup) = explode('/',$email);\r\n \t\t\t\t\t\t$veryfyEmail = \tsha1(sha1($emailGroup.$secretHash).$secretHash);\r\n-\t\t\t\t\t\t$messagesParsed = str_replace(array('{messages}','{url_accept}','{chat_id}','{user_name}','{department}'), array($messagesContent,self::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$emailGroup,$chat->id,$chat->user_name,(string)$chat->department),$data[$templateMessage]);\r\n+\t\t\t\t\t\t$messagesParsed = str_replace(array('{messages}','{url_accept}','{chat_id}','{user_name}','{department}'), array($messagesContent,erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$emailGroup,$chat->id,$chat->user_name,(string)$chat->department),$data[$templateMessage]);\r\n \t\t\t\t\t\t$conn->message($emailGroup,$messagesParsed,'groupchat');\t\t\t\t\t\t\r\n \t\t\t\t\t}\r\n \r\n@@ -320,7 +320,7 @@ public static function sendXMPMessage($chat, $params = array()) {\n \t\t\t\t\t\t\r\n \t\t\t\t\t\tforeach ($emailRecipient as $email) {\r\n \t\t\t\t\t\t\t$veryfyEmail = \tsha1(sha1($email.$secretHash).$secretHash);\r\n-\t\t\t\t\t\t\t$conn->message($email,str_replace(array('{messages}','{url_accept}','{chat_id}','{user_name}','{department}'), array($messagesContent,self::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$email, $chat->id,$chat->user_name,(string)$chat->department),$data[$templateMessage]));\r\n+\t\t\t\t\t\t\t$conn->message($email,str_replace(array('{messages}','{url_accept}','{chat_id}','{user_name}','{department}'), array($messagesContent,erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('chat/accept').'/'.erLhcoreClassModelChatAccept::generateAcceptLink($chat).'/'.$veryfyEmail.'/'.$email, $chat->id,$chat->user_name,(string)$chat->department),$data[$templateMessage]));\r\n \t\t\t\t\t\t}\r\n \r\n \t\t\t\t\t\t$conn->disconnect();\r"
        },
        {
          "filename": "lhc_web/lib/models/lhabstract/erlhabstractmodelformcollected.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -67,7 +67,7 @@ public function getFormattedContent()\n         $dataCollected = array();\r\n         foreach ($this->content_array as $nameAttr => $contentArray) {\r\n             if (isset($contentArray['definition']['type']) && $contentArray['definition']['type'] == 'file') {\r\n-                $dataCollected[] = $contentArray['definition']['name_literal'] . \" - \" . erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('user/login') . '/(r)/' . rawurlencode(base64_encode('form/download/' . $this->id . '/' . $nameAttr));\r\n+                $dataCollected[] = $contentArray['definition']['name_literal'] . \" - \" . erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('user/login') . '/(r)/' . rawurlencode(base64_encode('form/download/' . $this->id . '/' . $nameAttr));\r\n             } elseif (isset($contentArray['definition']['type']) && $contentArray['definition']['type'] == 'checkbox') {\r\n                 $dataCollected[] = $contentArray['definition']['name_literal'] . \" - \" . ($contentArray['value'] == 1 ? 'Y' : 'N');\r\n             } else {\r"
        },
        {
          "filename": "lhc_web/lib/models/lhabstract/erlhabstractmodelwidgettheme.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -260,7 +260,7 @@ public function __get($var)\n \r\n            case 'replace_array':\r\n \r\n-               $host = '//'.$_SERVER['HTTP_HOST'];\r\n+               $host = erLhcoreClassSystem::getHost();\r\n \r\n                $this->replace_array = array(\r\n                    'search' => array(\r\n@@ -309,7 +309,7 @@ public function __get($var)\n \t   \t       $attr = str_replace('_url', '', $var);\t   \t       \t   \t       \r\n \t   \t       $this->$var = false;\t   \t        \r\n \t   \t       if ($this->$attr != ''){\r\n-\t   \t           $this->$var =  ($this->{$attr.'_path'} != '' ? (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) . '/' . $this->{$attr.'_path'} . $this->$attr;\r\n+\t   \t           $this->$var =  ($this->{$attr.'_path'} != '' ? erLhcoreClassSystem::getHost() . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) . '/' . $this->{$attr.'_path'} . $this->$attr;\r\n \t   \t       }\t   \t        \r\n \t   \t       return $this->$var;\r\n \t   \t    break;\r\n@@ -327,7 +327,7 @@ public function __get($var)\n \t   \t        $attr = str_replace('_url_img', '', $var);\t   \t    \r\n \t   \t\t\t$this->$var = false;\t   \t\t\r\n \t   \t\t\tif($this->$attr != ''){\r\n-\t   \t\t\t\t$this->$var = '<img src=\"'.($this->{$attr.'_path'} != '' ? (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'.$this->{$attr.'_path'} . $this->$attr.'\"/>';\r\n+\t   \t\t\t\t$this->$var = '<img src=\"'.($this->{$attr.'_path'} != '' ? erLhcoreClassSystem::getHost() . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'.$this->{$attr.'_path'} . $this->$attr.'\"/>';\r\n \t   \t\t\t}\r\n \t   \t\t\treturn $this->$var;\r\n \t   \t\tbreak;\r"
        },
        {
          "filename": "lhc_web/lib/models/lhgenericbot/erlhcoreclassmodelgenericbotbot.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -89,7 +89,7 @@ public function __get($var) {\n                 break;\r\n \r\n             case 'photo_path':\r\n-                $this->photo_path = ($this->filepath != '' ? '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'. $this->filepath . $this->filename;\r\n+                $this->photo_path = ($this->filepath != '' ? erLhcoreClassSystem::getHost() . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'. $this->filepath . $this->filename;\r\n                 return $this->photo_path;\r\n                 break;\r\n \r"
        },
        {
          "filename": "lhc_web/lib/models/lhgenericbot/erlhcoreclassmodelgenericbottrgroup.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -50,7 +50,7 @@ public function __get($var) {\n                 break;\n \n             case 'photo_path':\n-                $this->photo_path = ($this->filepath != '' ? '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'. $this->filepath . $this->filename;\n+                $this->photo_path = ($this->filepath != '' ? erLhcoreClassSystem::getHost() . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'. $this->filepath . $this->filename;\n                 return $this->photo_path;\n                 break;\n "
        },
        {
          "filename": "lhc_web/lib/models/lhuser/erlhcoreclassmodeluser.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -120,7 +120,7 @@ public function __get($param)\n        \t    \treturn $this->filename != '' || $this->avatar != '';\n \n        \tcase 'photo_path':\n-       \t\t\t$this->photo_path = ($this->filepath != '' ? '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'. $this->filepath . $this->filename;\n+       \t\t\t$this->photo_path = ($this->filepath != '' ? erLhcoreClassSystem::getHost() . erLhcoreClassSystem::instance()->wwwDir() : erLhcoreClassSystem::instance()->wwwImagesDir() ) .'/'. $this->filepath . $this->filename;\n        \t\t\treturn $this->photo_path;\n \n        \tcase 'file_path_server':"
        },
        {
          "filename": "lhc_web/modules/lhcobrowse/proxycss.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -29,7 +29,7 @@\n }\r\n \r\n // Some basic validation\r\n-if (isset($url['host']) && $url['host'] != '' && strpos($_GET['css'], $_SERVER['HTTP_HOST']) === false) {\r\n+if (isset($url['host']) && $url['host'] != '' && strpos($_GET['css'], erLhcoreClassSystem::getHost()) === false) {\r\n \r\n     $urlCSS = parse_url($_GET['css']);\r\n \r"
        },
        {
          "filename": "lhc_web/modules/lhcron/test.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -6,4 +6,6 @@\n  *\r\n  * */\r\n \r\n+echo erLhcoreClassBBCode::getHost();\r\n+\r\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "lhc_web/modules/lhexport/getchat.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -6,6 +6,11 @@\n $hashSecret = erLhcoreClassModelChatConfig::fetch('export_hash')->current_value;\r\n \r\n try {\r\n+\r\n+    if (strlen($hashSecret) < 50) {\r\n+        throw new Exception('Export hash to short!');\r\n+    }\r\n+\r\n \tif ( sha1('getchat'.$hashSecret) == $hash ) {\r\n \r\n \t\t$chat = erLhcoreClassModelChat::fetch((string)$Params['user_parameters']['chat_id']);\r"
        },
        {
          "filename": "lhc_web/modules/lhexport/getcount.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -6,6 +6,11 @@\n $hashSecret = erLhcoreClassModelChatConfig::fetch('export_hash')->current_value;\r\n \r\n try {\r\n+    \r\n+    if (strlen($hashSecret) < 50) {\r\n+        throw new Exception('Export hash to short!');\r\n+    }\r\n+\r\n \tif ( sha1('getcount'.$hashSecret) == $hash ) {\r\n \r\n \t\t$filter = array();\r"
        },
        {
          "filename": "lhc_web/modules/lhexport/getlist.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -6,6 +6,11 @@\n $hashSecret = erLhcoreClassModelChatConfig::fetch('export_hash')->current_value;\r\n \r\n try {\r\n+    \r\n+    if (strlen($hashSecret) < 50) {\r\n+        throw new Exception('Export hash to short!');\r\n+    }\r\n+\r\n \tif ( sha1('getlist'.$hashSecret) == $hash ) {\r\n \r\n \t\t$filter = array();\r"
        },
        {
          "filename": "lhc_web/modules/lhform/downloadcollected.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -42,7 +42,7 @@\n \t$y = 0;\r\n \tforeach ($form->xls_columns_data as $data) {\t\t\t\t\t\r\n \t\tif (isset($item->content_array[$data['attr_name']]['definition']['type']) && $item->content_array[$data['attr_name']]['definition']['type'] == 'file') {\t\t\t\r\n-\t\t\t$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($y, $i, erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/download/'.$item->id.'/'.$data['attr_name'])));\r\n+\t\t\t$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($y, $i, erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/download/'.$item->id.'/'.$data['attr_name'])));\r\n \t\t} else {\r\n \t\t\tif (strpos($data['attr_name'], ',') === false){\r\n \t\t\t\t$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($y, $i, $item->content_array[$data['attr_name']]['value']);\r"
        },
        {
          "filename": "lhc_web/modules/lhform/downloaditem.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -46,7 +46,7 @@\n \t$y = 0;\r\n \tforeach ($form->xls_columns_data as $data) {\r\n \t\tif (isset($item->content_array[$data['attr_name']]['definition']['type']) && $item->content_array[$data['attr_name']]['definition']['type'] == 'file') {\r\n-\t\t\t$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($y, $i, erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/download/'.$item->id.'/'.$data['attr_name'])));\r\n+\t\t\t$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($y, $i, erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('user/login').'/(r)/'.rawurlencode(base64_encode('form/download/'.$item->id.'/'.$data['attr_name'])));\r\n \t\t} else {\r\n \t\t\tif (strpos($data['attr_name'], ',') === false){\r\n \t\t\t\t$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($y, $i, $item->content_array[$data['attr_name']]['value']);\r"
        },
        {
          "filename": "lhc_web/modules/lhinstall/install.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1438,9 +1438,9 @@\n                   PRIMARY KEY (`identifier`)\n                 ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n \n-                    $randomHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n+                    $randomHash = erLhcoreClassModelForgotPassword::randomPassword(80);\n                     $randomHashLength = strlen($randomHash);\n-                    $exportHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n+                    $exportHash = erLhcoreClassModelForgotPassword::randomPassword(80);\n \n                     if (extension_loaded('bcmath')){\n                         $geoRow = \"('geo_data','a:5:{i:0;b:0;s:21:\\\"geo_detection_enabled\\\";i:1;s:22:\\\"geo_service_identifier\\\";s:8:\\\"max_mind\\\";s:23:\\\"max_mind_detection_type\\\";s:7:\\\"country\\\";s:22:\\\"max_mind_city_location\\\";s:37:\\\"var/external/geoip/GeoLite2-City.mmdb\\\";}',0,'',1)\";"
        },
        {
          "filename": "lhc_web/modules/lhpermission/explorer.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -21,7 +21,7 @@\n                 $url = [];\n                 if (isset($function['url'])) {\n                     foreach ($function['url'] as $urlData) {\n-                        $url[] = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('/') . preg_replace('/^lh/', '', $urlData);\n+                        $url[] = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('/') . preg_replace('/^lh/', '', $urlData);\n                     }\n                 }\n                 fputcsv($fp, ["
        },
        {
          "filename": "lhc_web/modules/lhrestapi/fetchchatmessages.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -120,7 +120,7 @@\n                         $file = erLhcoreClassModelChatFile::fetch($fileID);\n                         if (is_object($file) && $hash == $file->security_hash) {\n \n-                            $url = (erLhcoreClassSystem::$httpsMode == true ? 'https:' : 'http:') . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$file->id}/{$hash}\";\n+                            $url = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('file/downloadfile') . \"/{$file->id}/{$hash}\";\n \n                             $media[] = array(\n                                 'id' => $file->id,"
        },
        {
          "filename": "lhc_web/modules/lhrestapi/generateautologin.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -57,7 +57,7 @@ function generateAutoLoginLink($params){\n \n         $hashValidation = sha1($params['secret_hash'].sha1($params['secret_hash'].implode(',', $dataRequest)));\n \n-        return $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect(\"user/autologin\") . \"/{$hashValidation}\".implode('', $dataRequestAppend);\n+        return erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect(\"user/autologin\") . \"/{$hashValidation}\".implode('', $dataRequestAppend);\n     }\n \n     $requestBody['secret_hash'] = $data['secret_hash'];"
        },
        {
          "filename": "lhc_web/modules/lhrestapi/loginbytoken.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -32,7 +32,7 @@\n                 header('Location: ' .erLhcoreClassDesign::baseurldirect('site_admin').'/'.ltrim($r, '/'));\n                 exit;\n             } else {\n-                echo json_encode(array('error' => false, 'msg' => 'Session started', 'url' => erLhcoreClassXMP::getBaseHost() . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurldirect('site_admin').'/'.ltrim($r,'/')));\n+                echo json_encode(array('error' => false, 'msg' => 'Session started', 'url' => erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurldirect('site_admin').'/'.ltrim($r,'/')));\n                 exit;\n             }\n         } else {"
        },
        {
          "filename": "lhc_web/modules/lhrestapi/swagger.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,7 @@\n \n echo str_replace(\n     array('{{base_path}}','{{ts}}','{{host}}','{{append_definitions}}','{{append_paths}}', '{{chats_parameters}}','{{append_elastic_definitions}}','{{append_elastic_mail_definitions}}'),\n-    array(erLhcoreClassDesign::baseurldirect(),time(),$_SERVER['HTTP_HOST'], $append_definitions, $append_paths, $chats_parameters,$elastic_definition,$elastic_mail)\n+    array(erLhcoreClassDesign::baseurldirect(),time(),str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost()), $append_definitions, $append_paths, $chats_parameters,$elastic_definition,$elastic_mail)\n     , $content);\n \n exit;"
        },
        {
          "filename": "lhc_web/modules/lhuser/forgotpassword.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -59,7 +59,7 @@\n \n \t\tif (($userID = erLhcoreClassModelUser::fetchUserByEmail($form->Email)) !== false) {\n \n-\t\t\t$host = $_SERVER['HTTP_HOST'];\n+\t\t\t$host = erLhcoreClassSystem::getHost();\n \n \t\t\t$adminEmail = erConfigClassLhConfig::getInstance()->getSetting( 'site', 'site_admin_email' );\n "
        },
        {
          "filename": "lhc_web/modules/lhwidgetrestapi/checkinvitation.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -127,7 +127,7 @@\n                 $replaceStyleArray = array();\n \n                 for ($i = 1; $i < 5; $i++) {\n-                    $replaceStyleArray['{proactive_img_' . $i . '}'] = erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value . '//' . $_SERVER['HTTP_HOST'] . $userInstance->invitation->{'design_data_img_' . $i . '_url'};\n+                    $replaceStyleArray['{proactive_img_' . $i . '}'] = erLhcoreClassSystem::getHost() . $userInstance->invitation->{'design_data_img_' . $i . '_url'};\n                 }\n \n                 $contentCSS = str_replace(array_keys($replaceStyleArray), array_values($replaceStyleArray), $userInstance->invitation->design_data_array['mobile_style']);"
        },
        {
          "filename": "lhc_web/modules/lhwidgetrestapi/screensharesettings.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -4,19 +4,19 @@\n $settings = array(\n     'nodejssettings' => array(\n         'nodejssocket' => erLhcoreClassModelChatConfig::fetch('sharing_nodejs_sllocation')->current_value,\n-        'nodejshost' => (erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value != '' ? erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value : $_SERVER['HTTP_HOST']),\n+        'nodejshost' => (erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value != '' ? erLhcoreClassModelChatConfig::fetch('sharing_nodejs_socket_host')->current_value : str_replace(['http://','https://'],'',erLhcoreClassSystem::getHost())),\n         'path' => erLhcoreClassModelChatConfig::fetch('sharing_nodejs_path')->current_value,\n         'secure' => ((int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_secure')->current_value == 1 ? true : false)\n     ),\n     'auto_share' => (int)erLhcoreClassModelChatConfig::fetch('sharing_auto_allow')->current_value,\n-    'cobrowser' => erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::designJS('js/cobrowse/compiled/cobrowse.visitor.min.js'),\n+    'cobrowser' => erLhcoreClassSystem::getHost() . erLhcoreClassDesign::designJS('js/cobrowse/compiled/cobrowse.visitor.min.js'),\n     'nodejsenabled' => (int)erLhcoreClassModelChatConfig::fetch('sharing_nodejs_enabled')->current_value,\n     'trans' => array(\n         'operator_watching' => erTranslationClassLhTranslation::getInstance()->getTranslation('chat/getstatus', 'Screen shared, click to finish'),\n         'start_share' => erTranslationClassLhTranslation::getInstance()->getTranslation('chat/screenshare','Start screen share session'),\n         'deny' => erTranslationClassLhTranslation::getInstance()->getTranslation('chat/screenshare','Deny screen share'),\n     ),\n-    'url' => erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurlsite() . '/cobrowse/storenodemap/(sharemode)/chat'\n+    'url' => erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurlsite() . '/cobrowse/storenodemap/(sharemode)/chat'\n );\n \n erLhcoreClassChatEventDispatcher::getInstance()->dispatch('widgetrestapi.screensharesettings', array('output' => & $settings));"
        },
        {
          "filename": "lhc_web/modules/lhwidgetrestapi/settings.php",
          "status": "modified",
          "additions": 5,
          "deletions": 11,
          "patch": "@@ -353,9 +353,9 @@\n \n         if ($theme->need_help_image_url === false) {\n             if ((isset($theme->bot_configuration_array['nh_avatar']) && $theme->bot_configuration_array['nh_avatar'] != '')) {\n-                $replaceVars['replace'][8] = erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value . '//' . $_SERVER['HTTP_HOST'] .erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar') . '/' . $theme->bot_configuration_array['nh_avatar'];\n+                $replaceVars['replace'][8] = erLhcoreClassSystem::getHost() .erLhcoreClassDesign::baseurldirect('widgetrestapi/avatar') . '/' . $theme->bot_configuration_array['nh_avatar'];\n             } else {\n-                $replaceVars['replace'][8] = erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value . '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::design('images/general/operator.png');\n+                $replaceVars['replace'][8] = erLhcoreClassSystem::getHost() . erLhcoreClassDesign::design('images/general/operator.png');\n             }\n         }\n \n@@ -372,7 +372,7 @@\n                 '{{need_help_body}}',\n             ),\n             'replace' => array(\n-                '//' . $_SERVER['HTTP_HOST'] . erLhcoreClassDesign::design('images/general/operator.png'),\n+                erLhcoreClassSystem::getHost() . erLhcoreClassDesign::design('images/general/operator.png'),\n                 $translationInstance->getTranslation('chat/getstatus', 'Need help?'),\n                 $translationInstance->getTranslation('chat/getstatus', 'Our staff are ready to help!')\n             )\n@@ -480,13 +480,7 @@\n     }\n }\n \n-$host = erLhcoreClassModelChatConfig::fetch('explicit_http_mode')->current_value;\n-\n-if ($host == '') {\n-    $host = erLhcoreClassBBCode::getHost();\n-} else {\n-    $host .= '//' . $_SERVER['HTTP_HOST'];\n-}\n+$host = erLhcoreClassSystem::getHost();\n \n $outputResponse['static'] = array(\n     'screenshot' =>  $host . erLhcoreClassDesign::design('js/html2canvas.min.js'). '?v=' . $outputResponse['v'],\n@@ -506,7 +500,7 @@\n );\n \n $outputResponse['chunks_location'] = $host . erLhcoreClassDesign::design('js/widgetv2');\n-$outputResponse['domain_lhc'] = $_SERVER['HTTP_HOST'];\n+$outputResponse['domain_lhc'] = str_replace(['http://','https://'],'',$host);\n \n erLhcoreClassChatEventDispatcher::getInstance()->dispatch('widgetrestapi.settings', array('output' => & $outputResponse));\n "
        },
        {
          "filename": "lhc_web/modules/lhwidgetrestapi/updatejs.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n <html>\n <head>\n-    <script src=\"//<?php echo $_SERVER['HTTP_HOST']?><?php echo erLhcoreClassDesign::design('js/widgetv2/index.js')?>?t=<?php echo time()?>\"></script>\n+    <script src=\"<?php echo erLhcoreClassSystem::getHost()?><?php echo erLhcoreClassDesign::design('js/widgetv2/index.js')?>?t=<?php echo time()?>\"></script>\n     <meta http-equiv=\"cache-control\" content=\"no-cache, must-revalidate, post-check=0, pre-check=0\" />\n     <meta http-equiv=\"cache-control\" content=\"max-age=0\" />\n     <meta http-equiv=\"expires\" content=\"0\" />"
        },
        {
          "filename": "lhc_web/modules/lhxmp/configuration.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -61,7 +61,7 @@\n \t$client->setClientSecret($data['gtalk_client_secret']);\r\n \t$client->setApprovalPrompt('force');\r\n \t$client->setAccessType('offline');\r\n-\t$client->setRedirectUri(erLhcoreClassXMP::getBaseHost().$_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('xmp/configuration').'/(gtalkoauth)/true');\r\n+\t$client->setRedirectUri(erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('xmp/configuration').'/(gtalkoauth)/true');\r\n \t\t\r\n \tif (isset($_GET['code'])) {\r\n \t\ttry {\t\t\t\r\n@@ -168,15 +168,15 @@\n \t\t$client->setClientSecret($data['gtalk_client_secret']);\r\n \t\t$client->setApprovalPrompt('force');\r\n \t\t$client->setAccessType('offline');\r\n-\t\t$client->setRedirectUri(erLhcoreClassXMP::getBaseHost().$_SERVER['HTTP_HOST'] . erLhcoreClassDesign::baseurl('xmp/configuration').'/(gtalkoauth)/true');\r\n+\t\t$client->setRedirectUri(erLhcoreClassSystem::getHost() . erLhcoreClassDesign::baseurl('xmp/configuration').'/(gtalkoauth)/true');\r\n \t\t\t\r\n \t\tif ( !$client->getAccessToken() ) {\r\n \t\t\theader('Location: '.$client->createAuthUrl());\r\n \t\t\texit;\r\n \t\t}\r\n \t}\r\n \t\r\n-\t$tpl->set('updated','done');\t\r\n+\t$tpl->set('updated','done');\r\n }\r\n \r\n \r"
        },
        {
          "filename": "lhc_web/settings/settings.ini.default.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -26,6 +26,9 @@\n                     'maps_api_key' => false,\n                     'default_group' => '',\n                     'default_user' => '',\n+                    'site_address' => '',\n+                    'trusted_host_patterns' => [\n+                    ],\n                     'extensions' =>\n                         array (\n                             // 0 => 'customstatus',"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 6,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 44,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "488b29713fc387169e9d0989cbd95f47f05f4cdd",
            "date": "2025-01-14T12:13:49Z",
            "author_login": "remdex"
          },
          {
            "sha": "86289ae7c52e436559a97e108091e7d91ac1573a",
            "date": "2025-01-14T07:23:15Z",
            "author_login": "remdex"
          },
          {
            "sha": "acfd9581dd8d802ee469c691d42872147a777853",
            "date": "2025-01-13T20:25:11Z",
            "author_login": "remdex"
          },
          {
            "sha": "44c91a9eb94688e3028d36840bb33c131e5cdbf1",
            "date": "2025-01-13T13:57:42Z",
            "author_login": "remdex"
          },
          {
            "sha": "2c644607165bb4b97d95dd25e0bc6048aa7ef02f",
            "date": "2025-01-13T12:59:13Z",
            "author_login": "remdex"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-840",
    "description": "Host Header injection in password Reset in GitHub repository livehelperchat/livehelperchat prior to 3.97.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-07T19:15:08.017",
    "last_modified": "2024-11-21T06:39:41.787",
    "fix_date": "2022-04-06T10:07:00Z"
  },
  "references": [
    {
      "url": "https://github.com/livehelperchat/livehelperchat/commit/ce96791cb4c7420266b668fc234c211914259ba7",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a7e40fdf-a333-4a50-8a53-d11b16ce3ec2",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/livehelperchat/livehelperchat/commit/ce96791cb4c7420266b668fc234c211914259ba7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a7e40fdf-a333-4a50-8a53-d11b16ce3ec2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.110137",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "livehelperchat",
    "owner": "livehelperchat",
    "created_at": "2012-12-08T14:58:36Z",
    "updated_at": "2025-01-14T12:13:59Z",
    "pushed_at": "2025-01-14T12:13:55Z",
    "size": 354129,
    "stars": 2002,
    "forks": 699,
    "open_issues": 135,
    "watchers": 2002,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 19845370,
      "JavaScript": 1906940,
      "Svelte": 230806,
      "CSS": 94511,
      "Hack": 9209,
      "Shell": 6965,
      "Dockerfile": 486,
      "HTML": 354,
      "Python": 202
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:20:27.327951"
  }
}