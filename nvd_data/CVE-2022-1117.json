{
  "cve_id": "CVE-2022-1117",
  "github_data": {
    "repository": "linux-application-whitelisting/fapolicyd",
    "fix_commit": "38a942613f93824c53164730b2b7a2f75b8cd263",
    "related_commits": [
      "38a942613f93824c53164730b2b7a2f75b8cd263",
      "38a942613f93824c53164730b2b7a2f75b8cd263"
    ],
    "patch_url": "https://github.com/linux-application-whitelisting/fapolicyd/commit/38a942613f93824c53164730b2b7a2f75b8cd263.patch",
    "fix_commit_details": {
      "sha": "38a942613f93824c53164730b2b7a2f75b8cd263",
      "commit_date": "2022-05-24T15:51:10Z",
      "author": {
        "login": "RH-steve-grubb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix for CVE-2022-1117",
        "length": 551,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
      },
      "files": [
        {
          "filename": "fapolicyd.spec",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -30,7 +30,15 @@ makes use of the kernel's fanotify interface to determine file access rights.\n # generate rules for python\n sed -i \"s/%python2_path%/`readlink -f %{__python2} | sed 's/\\//\\\\\\\\\\//g'`/g\" rules.d/*.rules\n sed -i \"s/%python3_path%/`readlink -f %{__python3} | sed 's/\\//\\\\\\\\\\//g'`/g\" rules.d/*.rules\n-sed -i \"s/%ld_so_path%/`find /usr/lib64/ -type f -name 'ld-2\\.*.so' | sed 's/\\//\\\\\\\\\\//g'`/g\" rules.d/*.rules\n+\n+# Detect run time linker directly from bash\n+interpret=`readelf -e /usr/bin/bash \\\n+\t\t| grep Requesting \\\n+\t\t| sed 's/.$//' \\\n+\t\t| rev | cut -d\" \" -f1 \\\n+\t\t| rev`\n+\n+sed -i \"s|%ld_so_path%|`realpath $interpret`|g\" rules.d/*.rules\n \n %build\n %configure \\"
        },
        {
          "filename": "m4/dyn_linker.m4",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -1,6 +1,10 @@\n AC_DEFUN([LD_SO_PATH],\n [\n-  xpath=`realpath /usr/lib64/ld-2.*.so`\n+  xpath1=`readelf -e /usr/bin/bash | grep Requesting | sed 's/.$//' | rev | cut -d\" \" -f1 | rev`\n+  xpath=`realpath $xpath1`\n+  if test ! -f \"$xpath\" ; then\n+    AC_MSG_ERROR([Cant find the dynamic linker])\n+  fi\n   echo \"dynamic linker is.....$xpath\"\n   AC_DEFINE_UNQUOTED(SYSTEM_LD_SO, [\"$xpath\"], [dynamic linker])\n ])"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f76484b541e3822021b3bd5abe18392f9169a58a",
            "date": "2024-08-18T08:01:45Z",
            "author_login": "skosachiov"
          },
          {
            "sha": "2e7b115872ce0be7494ddee375cae307ba355c83",
            "date": "2024-06-16T10:16:59Z",
            "author_login": "skosachiov"
          },
          {
            "sha": "3c0897ef103fd6f9f3d58bb3b1191a7228e75c90",
            "date": "2024-06-10T14:12:41Z",
            "author_login": "skosachiov"
          },
          {
            "sha": "c32b5baea4d371417c8259cce3a41d77d5cec1ad",
            "date": "2024-11-20T13:30:14Z",
            "author_login": "radosroka"
          },
          {
            "sha": "b97a123ac96821c95838e94b82c60146cc65a698",
            "date": "2024-11-20T10:57:36Z",
            "author_login": "radosroka"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-552",
    "description": "A vulnerability was found in fapolicyd. The vulnerability occurs due to an assumption on how glibc names the runtime linker, a build time regular expression may not correctly detect the runtime linker. The consequence is that the pattern detection for applications launched by the run time linker may fail to detect the pattern and allow execution.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-08-29T15:15:10.357",
    "last_modified": "2024-11-21T06:40:04.900",
    "fix_date": "2022-05-24T15:51:10Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/security/cve/CVE-2022-1117",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066904",
      "source": "secalert@redhat.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2068171",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/linux-application-whitelisting/fapolicyd/commit/38a942613f93824c53164730b2b7a2f75b8cd263",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2022-1117",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066904",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2068171",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/linux-application-whitelisting/fapolicyd/commit/38a942613f93824c53164730b2b7a2f75b8cd263",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.054359",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fapolicyd",
    "owner": "linux-application-whitelisting",
    "created_at": "2016-05-17T20:12:13Z",
    "updated_at": "2025-01-13T09:22:52Z",
    "pushed_at": "2024-11-21T16:21:28Z",
    "size": 1216,
    "stars": 208,
    "forks": 57,
    "open_issues": 46,
    "watchers": 208,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 364782,
      "M4": 6847,
      "Makefile": 6538,
      "Shell": 5660,
      "Python": 955
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:01:23.485095"
  }
}