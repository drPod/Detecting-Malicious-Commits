{
  "cve_id": "CVE-2022-1226",
  "github_data": {
    "repository": "phpipam/phpipam",
    "fix_commit": "50e36b9e4fff5eaa51dc6e42bc684748da378002",
    "related_commits": [
      "50e36b9e4fff5eaa51dc6e42bc684748da378002"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "50e36b9e4fff5eaa51dc6e42bc684748da378002",
      "commit_date": "2022-04-24T12:37:17Z",
      "author": {
        "login": "GaryAllan",
        "type": "User",
        "stats": {
          "total_commits": 877,
          "average_weekly_commits": 1.7435387673956262,
          "total_additions": 33025,
          "total_deletions": 58367,
          "weeks_active": 195
        }
      },
      "commit_message": {
        "title": "Bugfix: XSS (reflected) in import previews",
        "length": 89,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 5,
        "deletions": 7
      },
      "files": [
        {
          "filename": "app/admin/import-export/import-load-data.php",
          "status": "modified",
          "additions": 4,
          "deletions": 7,
          "patch": "@@ -65,7 +65,7 @@\n \tforeach ($cols as $val) {\n \t\t$col++;\n \t\t# map import columns to expected fields as per previous window\n-\t\t$fieldmap[$col] = $impfields[$val];\n+\t\t$fieldmap[$col] = escape_input(trim($impfields[$val]));\n \t\t$hcol = $col;\n \t}\n \n@@ -81,7 +81,7 @@\n \t\t\t\t$Result->show('danger', _(\"Extra column found on line \").$row._(\" in CSV file. CSV delimiter used in value field?\"), true);\n \t\t\t} else {\n \t\t\t\t# read each row into a dictionary with expected fields as keys\n-\t\t\t\t$record[$fieldmap[$col]] = trim($val);\n+\t\t\t\t$record[$fieldmap[$col]] = escape_input(trim($val));\n \t\t\t}\n \t\t}\n \t\t$data[] = $record;\n@@ -97,23 +97,20 @@\n \n \t# map import columns to expected fields as per previous window\n \tfor($col=1;$col<=$xls->colcount($sheet);$col++) {\n-\t\t$fieldmap[$col] = $impfields[$Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet))];\n+\t\t$fieldmap[$col] = $impfields[escape_input($Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet)))];\n \t\t$hcol = $col;\n \t}\n \n \t# read each remaining row into a dictionary with expected fields as keys\n \tfor($row=2;$row<=$xls->rowcount($sheet);$row++) {\n \t\t$record = array();\n \t\tfor($col=1;$col<=$xls->colcount($sheet);$col++) {\n-\t\t\t$record++;\n \t\t\tif ($col > $hcol) {\n \t\t\t\t\t$Result->show('danger', _(\"Extra column found on line \").$row._(\" in XLS file. Please check input file.\"), true);\n \t\t\t} else {\n-\t\t\t\t$record[$fieldmap[$col]] = trim($Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet)));\n+\t\t\t\t$record[$fieldmap[$col]] = escape_input(trim($Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet))));\n \t\t\t}\n \t\t}\n \t\t$data[] = $record;\n \t}\n }\n-\n-?>"
        },
        {
          "filename": "misc/CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -7,6 +7,7 @@\n     Security Fixes:\n     ----------------------------\n     + XXS (reflected) in ripe-arin-query;\n+    + XSS (reflected) in import previews;\n \n == 1.4.6\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "602d81226784fe8de1af96db98f594745f6b441d",
            "date": "2024-11-27T09:56:05Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "f04280ba16fa3901dcd98900a248adfc55f89e13",
            "date": "2024-11-27T09:57:12Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "3212ed239c11093c83bb10bac1f727682c562e17",
            "date": "2024-11-26T16:15:46Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "93cfa93424947a71d0a75ee128f49c90897243c4",
            "date": "2024-11-23T22:18:16Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "91acd5c61f546d29e3b2ae526768c80a065f6e15",
            "date": "2024-11-23T22:22:42Z",
            "author_login": "GaryAllan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A Cross-Site Scripting (XSS) vulnerability in phpipam/phpipam versions prior to 1.4.7 allows attackers to execute arbitrary JavaScript code in the browser of a victim. This vulnerability affects the import Data set feature via a spreadsheet file upload. The affected endpoints include import-vlan-preview.php, import-subnets-preview.php, import-vrf-preview.php, import-ipaddr-preview.php, import-devtype-preview.php, import-devices-preview.php, and import-l2dom-preview.php. The vulnerability can be exploited by uploading a specially crafted spreadsheet file containing malicious JavaScript payloads, which are then executed in the context of the victim's browser. This can lead to defacement of websites, execution of malicious JavaScript code, stealing of user cookies, and unauthorized access to user accounts.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-15T11:15:07.527",
    "last_modified": "2024-11-19T15:30:53.477",
    "fix_date": "2022-04-24T12:37:17Z"
  },
  "references": [
    {
      "url": "https://github.com/phpipam/phpipam/commit/50e36b9e4fff5eaa51dc6e42bc684748da378002",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/3fdcf653-fe26-4592-94a1-98ce664618ec",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.303625",
    "processing_status": "enhanced"
  }
}