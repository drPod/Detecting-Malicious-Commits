{
  "cve_id": "CVE-2022-1233",
  "github_data": {
    "repository": "medialize/uri.js",
    "fix_commit": "88805fd3da03bd7a5e60947adb49d182011f1277",
    "related_commits": [
      "88805fd3da03bd7a5e60947adb49d182011f1277",
      "88805fd3da03bd7a5e60947adb49d182011f1277"
    ],
    "patch_url": "https://github.com/medialize/uri.js/commit/88805fd3da03bd7a5e60947adb49d182011f1277.patch",
    "fix_commit_details": {
      "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
      "commit_date": "2022-04-03T08:51:52Z",
      "author": {
        "login": "rodneyrehm",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(parse): handle excessive slashes in scheme-relative URLs",
        "length": 97,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 104,
        "additions": 104,
        "deletions": 0
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -2,6 +2,10 @@\n \n The release notes tracked in this document are also made available on the [releases page](https://github.com/medialize/URI.js/releases)\n \n+### master ###\n+\n+* **SECURITY** fixing [`URI.parse()`](http://medialize.github.io/URI.js/docs.html#static-parse) handle excessive slashes in scheme-relative URLs - disclosed by [zeyu2001](https://github.com/zeyu2001) via https://huntr.dev/\n+\n ### 1.19.10 (March 5th 2022) ###\n \n * **SECURITY** fixing [`URI.parse()`](http://medialize.github.io/URI.js/docs.html#static-parse) handle excessive colons in protocol delimiter - disclosed by [huydoppa](https://github.com/huydoppa) via https://huntr.dev/"
        },
        {
          "filename": "src/URI.js",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -518,6 +518,8 @@\n \n     // slashes and backslashes have lost all meaning for the web protocols (https, http, wss, ws)\n     string = string.replace(/^(https?|ftp|wss?)?:+[/\\\\]*/i, '$1://');\n+    // slashes and backslashes have lost all meaning for scheme relative URLs\n+    string = string.replace(/^[/\\\\]{2,}/i, '//');\n \n     // extract protocol\n     if (string.substring(0, 2) === '//') {"
        },
        {
          "filename": "test/urls.js",
          "status": "modified",
          "additions": 98,
          "deletions": 0,
          "patch": "@@ -581,6 +581,55 @@ var urls = [{\n       idn: false,\n       punycode: false\n     }\n+  }, {\n+    name: 'ignoring scheme excessive slashes',\n+    url: ':/\\\\//user:pass@example.org:123/some/directory/file.html?query=string#fragment',\n+    _url: '//user:pass@example.org:123/some/directory/file.html?query=string#fragment',\n+    parts: {\n+      protocol: null,\n+      username: 'user',\n+      password: 'pass',\n+      hostname: 'example.org',\n+      port: '123',\n+      path: '/some/directory/file.html',\n+      query: 'query=string',\n+      fragment: 'fragment'\n+    },\n+    accessors: {\n+      protocol: '',\n+      username: 'user',\n+      password: 'pass',\n+      port: '123',\n+      path: '/some/directory/file.html',\n+      query: 'query=string',\n+      fragment: 'fragment',\n+      resource: '/some/directory/file.html?query=string#fragment',\n+      authority: 'user:pass@example.org:123',\n+      origin: 'user:pass@example.org:123',\n+      userinfo: 'user:pass',\n+      subdomain: '',\n+      domain: 'example.org',\n+      tld: 'org',\n+      directory: '/some/directory',\n+      filename: 'file.html',\n+      suffix: 'html',\n+      hash: '#fragment',\n+      search: '?query=string',\n+      host: 'example.org:123',\n+      hostname: 'example.org'\n+    },\n+    is: {\n+      urn: false,\n+      url: true,\n+      relative: false,\n+      name: true,\n+      sld: false,\n+      ip: false,\n+      ip4: false,\n+      ip6: false,\n+      idn: false,\n+      punycode: false\n+    }\n   }, {\n     name: 'scheme-relative URL',\n     url: '//www.example.org/',\n@@ -629,6 +678,55 @@ var urls = [{\n       idn: false,\n       punycode: false\n     }\n+  }, {\n+    name: 'scheme-relative URL excessive slashes',\n+    url: '//\\\\/www.example.org/',\n+    _url: '//www.example.org/',\n+    parts: {\n+      protocol: null,\n+      username: null,\n+      password: null,\n+      hostname: 'www.example.org',\n+      port: null,\n+      path: '/',\n+      query: null,\n+      fragment: null\n+    },\n+    accessors: {\n+      protocol: '',\n+      username: '',\n+      password: '',\n+      port: '',\n+      path: '/',\n+      query: '',\n+      fragment: '',\n+      resource: '/',\n+      authority: 'www.example.org',\n+      origin: 'www.example.org',\n+      userinfo: '',\n+      subdomain: 'www',\n+      domain: 'example.org',\n+      tld: 'org',\n+      directory: '/',\n+      filename: '',\n+      suffix: '',\n+      hash: '',\n+      search: '',\n+      host: 'www.example.org',\n+      hostname: 'www.example.org'\n+    },\n+    is: {\n+      urn: false,\n+      url: true,\n+      relative: false,\n+      name: true,\n+      sld: false,\n+      ip: false,\n+      ip4: false,\n+      ip6: false,\n+      idn: false,\n+      punycode: false\n+    }\n   }, {\n     name: 'missing authority',\n     url: 'food:///test/file.csv',"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28976cde5bb32a433ab78c4a32ef58f39d2cabf6",
            "date": "2022-04-03T09:31:17Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b655c1b972111ade9f181b02374305942e68e30a",
            "date": "2022-04-03T09:30:13Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
            "date": "2022-04-03T09:24:54Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
            "date": "2022-04-03T08:51:52Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "119e6abe4579f6a76b078586ec4d8fbce9da962c",
            "date": "2022-03-05T15:17:44Z",
            "author_login": "rodneyrehm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-115",
    "description": "URL Confusion When Scheme Not Supplied in GitHub repository medialize/uri.js prior to 1.19.11.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-04T20:15:10.457",
    "last_modified": "2024-11-21T06:40:18.637",
    "fix_date": "2022-04-03T08:51:52Z"
  },
  "references": [
    {
      "url": "https://github.com/medialize/uri.js/commit/88805fd3da03bd7a5e60947adb49d182011f1277",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/228d5548-1109-49f8-8aee-91038e88371c",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/uri.js/commit/88805fd3da03bd7a5e60947adb49d182011f1277",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/228d5548-1109-49f8-8aee-91038e88371c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.097821",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "URI.js",
    "owner": "medialize",
    "created_at": "2011-12-27T10:46:47Z",
    "updated_at": "2025-01-13T05:48:53Z",
    "pushed_at": "2023-08-27T10:51:22Z",
    "size": 3202,
    "stars": 6258,
    "forks": 476,
    "open_issues": 104,
    "watchers": 6258,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 377871,
      "HTML": 120393,
      "CSS": 9642,
      "PHP": 1226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:50:37.086232"
  }
}