{
  "cve_id": "CVE-2022-1243",
  "github_data": {
    "repository": "medialize/uri.js",
    "fix_commit": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
    "related_commits": [
      "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
      "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae"
    ],
    "patch_url": "https://github.com/medialize/uri.js/commit/b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae.patch",
    "fix_commit_details": {
      "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
      "commit_date": "2022-04-03T09:24:54Z",
      "author": {
        "login": "rodneyrehm",
        "type": "User",
        "stats": {
          "total_commits": 467,
          "average_weekly_commits": 0.6837481698389458,
          "total_additions": 32609,
          "total_deletions": 17144,
          "weeks_active": 99
        }
      },
      "commit_message": {
        "title": "fix(parse): handle CR,LF,TAB",
        "length": 65,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 54,
        "additions": 54,
        "deletions": 0
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -5,6 +5,7 @@ The release notes tracked in this document are also made available on the [relea\n ### master ###\n \n * **SECURITY** fixing [`URI.parse()`](http://medialize.github.io/URI.js/docs.html#static-parse) handle excessive slashes in scheme-relative URLs - disclosed by [zeyu2001](https://github.com/zeyu2001) via https://huntr.dev/\n+* **SECURITY** fixing [`URI.parse()`](http://medialize.github.io/URI.js/docs.html#static-parse) remove `\\r` (CR), `\\n`, (LF) `\\t` (TAB) - disclosed by [haxatron](https://github.com/haxatron) via https://huntr.dev/\n \n ### 1.19.10 (March 5th 2022) ###\n "
        },
        {
          "filename": "src/URI.js",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -240,6 +240,8 @@\n     parens: /(\\([^\\)]*\\)|\\[[^\\]]*\\]|\\{[^}]*\\}|<[^>]*>)/g,\n   };\n   URI.leading_whitespace_expression = /^[\\x00-\\x20\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]+/\n+  // https://infra.spec.whatwg.org/#ascii-tab-or-newline\n+  URI.ascii_tab_whitespace = /[\\u0009\\u000A\\u000D]+/g\n   // http://www.iana.org/assignments/uri-schemes.html\n   // http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers#Well-known_ports\n   URI.defaultPorts = {\n@@ -497,6 +499,8 @@\n     }\n \n     string = string.replace(URI.leading_whitespace_expression, '')\n+    // https://infra.spec.whatwg.org/#ascii-tab-or-newline\n+    string = string.replace(URI.ascii_tab_whitespace, '')\n \n     // [protocol\"://\"[username[\":\"password]\"@\"]hostname[\":\"port]\"/\"?][path][\"?\"querystring][\"#\"fragment]\n "
        },
        {
          "filename": "test/urls.js",
          "status": "modified",
          "additions": 49,
          "deletions": 0,
          "patch": "@@ -2718,6 +2718,55 @@ var urls = [{\n         idn: false,\n         punycode: false\n       }\n+    }, {\n+      name: 'ASCII tab or newline',\n+      url: 'ja\\r\\nva\\tscript:alert(1)',\n+      _url: 'javascript:alert(1)',\n+      parts: {\n+        protocol: 'javascript',\n+        username: null,\n+        password: null,\n+        hostname: null,\n+        port: null,\n+        path: 'alert(1)',\n+        query: null,\n+        fragment: null\n+      },\n+      accessors: {\n+        protocol: 'javascript',\n+        username: '',\n+        password: '',\n+        port: '',\n+        path: 'alert(1)',\n+        query: '',\n+        fragment: '',\n+        resource: 'alert(1)',\n+        authority: '',\n+        origin: '',\n+        userinfo: '',\n+        subdomain: '',\n+        domain: '',\n+        tld: '',\n+        directory: '',\n+        filename: '',\n+        suffix: '',\n+        hash: '',\n+        search: '',\n+        host: '',\n+        hostname: ''\n+      },\n+      is: {\n+        urn: true,\n+        url: false,\n+        relative: false,\n+        name: false,\n+        sld: false,\n+        ip: false,\n+        ip4: false,\n+        ip6: false,\n+        idn: false,\n+        punycode: false\n+      }\n     }, {\n       name: 'excessive colon in protocol delimiter',\n       url: 'http:://www.example.org:8080/hello:world',"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28976cde5bb32a433ab78c4a32ef58f39d2cabf6",
            "date": "2022-04-03T09:31:17Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b655c1b972111ade9f181b02374305942e68e30a",
            "date": "2022-04-03T09:30:13Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
            "date": "2022-04-03T09:24:54Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "88805fd3da03bd7a5e60947adb49d182011f1277",
            "date": "2022-04-03T08:51:52Z",
            "author_login": "rodneyrehm"
          },
          {
            "sha": "119e6abe4579f6a76b078586ec4d8fbce9da962c",
            "date": "2022-03-05T15:17:44Z",
            "author_login": "rodneyrehm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-20",
    "description": "CRHTLF can lead to invalid protocol extraction potentially leading to XSS in GitHub repository medialize/uri.js prior to 1.19.11.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-05T15:15:08.097",
    "last_modified": "2024-11-21T06:40:19.820",
    "fix_date": "2022-04-03T09:24:54Z"
  },
  "references": [
    {
      "url": "https://github.com/medialize/uri.js/commit/b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/8c5afc47-1553-4eba-a98e-024e4cc3dfb7",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/medialize/uri.js/commit/b0c9796aa1a95a85f40924fb18b1e5da3dc8ffae",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/8c5afc47-1553-4eba-a98e-024e4cc3dfb7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.100922",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "URI.js",
    "owner": "medialize",
    "created_at": "2011-12-27T10:46:47Z",
    "updated_at": "2025-01-13T05:48:53Z",
    "pushed_at": "2023-08-27T10:51:22Z",
    "size": 3202,
    "stars": 6258,
    "forks": 476,
    "open_issues": 104,
    "watchers": 6258,
    "has_security_policy": false,
    "default_branch": "gh-pages",
    "protected_branches": [],
    "languages": {
      "JavaScript": 377871,
      "HTML": 120393,
      "CSS": 9642,
      "PHP": 1226
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:50:37.086232"
  }
}