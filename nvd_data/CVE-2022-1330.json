{
  "cve_id": "CVE-2022-1330",
  "github_data": {
    "repository": "alvarotrigo/fullpage.js",
    "fix_commit": "e7a5db42711700c8a584e61b5e532a64039fe92b",
    "related_commits": [
      "e7a5db42711700c8a584e61b5e532a64039fe92b",
      "e7a5db42711700c8a584e61b5e532a64039fe92b"
    ],
    "patch_url": "https://github.com/alvarotrigo/fullpage.js/commit/e7a5db42711700c8a584e61b5e532a64039fe92b.patch",
    "fix_commit_details": {
      "sha": "e7a5db42711700c8a584e61b5e532a64039fe92b",
      "commit_date": "2022-04-12T20:14:07Z",
      "author": {
        "login": "alvarotrigo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #4360 from ranjit-git/ranjit-git-patch-1",
        "length": 79,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 8,
        "deletions": 8
      },
      "files": [
        {
          "filename": "dist/fullpage.extensions.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "dist/fullpage.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1829,7 +1829,7 @@\n \n       for (var i = 0; i < numSlides; i++) {\n         var slide = $(SLIDE_SEL, sectionElem)[i];\n-        appendTo(createElementFromHTML('<li><a href=\"#\"><span class=\"fp-sr-only\">' + getBulletLinkName(i, 'Slide', slide) + '</span><span></span></a></li>'), $('ul', nav)[0]);\n+        appendTo(createElementFromHTML('<li><a href=\"#\"><span class=\"fp-sr-only\">' + encodeURI(getBulletLinkName(i, 'Slide', slide)) + '</span><span></span></a></li>'), $('ul', nav)[0]);\n       } //centering it\n \n \n@@ -2354,7 +2354,7 @@\n           link = section.anchor;\n         }\n \n-        li += '<li><a href=\"#' + link + '\"><span class=\"fp-sr-only\">' + getBulletLinkName(section.index(), 'Section') + '</span><span></span></a>'; // Only add tooltip if needed (defined by user)\n+        li += '<li><a href=\"#' + encodeURI(link) + '\"><span class=\"fp-sr-only\">' + encodeURI(getBulletLinkName(section.index(), 'Section')) + '</span><span></span></a>'; // Only add tooltip if needed (defined by user)\n \n         var tooltip = getOptions().navigationTooltips[section.index()];\n "
        },
        {
          "filename": "dist/fullpage.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "src/js/nav/sections.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -64,7 +64,7 @@ export function addVerticalNavigation(){\n             link = section.anchor;\n         }\n \n-        li += '<li><a href=\"#' + link + '\"><span class=\"fp-sr-only\">' + getBulletLinkName(section.index(), 'Section') + '</span><span></span></a>';\n+        li += '<li><a href=\"#' + encodeURI(link) + '\"><span class=\"fp-sr-only\">' + encodeURI(getBulletLinkName(section.index(), 'Section')) + '</span><span></span></a>';\n \n         // Only add tooltip if needed (defined by user)\n         var tooltip = getOptions().navigationTooltips[section.index()];\n@@ -98,4 +98,4 @@ export function sectionBulletHandler(e){\n     EventEmitter.emit('scrollPage', {\n         destination: getState().sections[indexBullet]\n     });\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "src/js/nav/slides.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -57,12 +57,12 @@ export function addSlidesNavigation(section){\n \n     for(var i=0; i< numSlides; i++){\n         var slide = utils.$(SLIDE_SEL, sectionElem)[i];\n-        utils.appendTo(utils.createElementFromHTML('<li><a href=\"#\"><span class=\"fp-sr-only\">'+ getBulletLinkName(i, 'Slide', slide) +'</span><span></span></a></li>'), utils.$('ul', nav)[0] );\n+        utils.appendTo(utils.createElementFromHTML('<li><a href=\"#\"><span class=\"fp-sr-only\">'+ encodeURI(getBulletLinkName(i, 'Slide', slide)) +'</span><span></span></a></li>'), utils.$('ul', nav)[0] );\n     }\n \n     //centering it\n     utils.css(nav, {'margin-left': '-' + (nav.innerWidth/2) + 'px'});\n \n     var activeSlideIndex = section.activeSlide ? section.activeSlide.index() : 0;\n     utils.addClass(utils.$('a', utils.$('li', nav)[activeSlideIndex] ), ACTIVE);\n-}\n\\ No newline at end of file\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1f098309cbe397797d8a6bf391392b5ce681474d",
            "date": "2024-11-28T13:46:14Z",
            "author_login": "alvarotrigo"
          },
          {
            "sha": "1d503821878bcda298b0f58c982d1d09a95b9caa",
            "date": "2024-11-28T13:44:18Z",
            "author_login": "alvarotrigo"
          },
          {
            "sha": "0f03e7be625ad8843669991222777ab7c44af840",
            "date": "2024-11-28T13:42:34Z",
            "author_login": "alvarotrigo"
          },
          {
            "sha": "a66eeda027c959e81966d24242eb103e9fca4607",
            "date": "2024-11-28T13:12:11Z",
            "author_login": "alvarotrigo"
          },
          {
            "sha": "4f56b7937b9b725ab318c3f432d80d78868bed37",
            "date": "2024-11-19T12:05:47Z",
            "author_login": "alvarotrigo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "stored xss due to unsantized anchor url in GitHub repository alvarotrigo/fullpage.js prior to 4.0.4. stored xss .",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-12T21:15:07.707",
    "last_modified": "2024-11-21T06:40:30.180",
    "fix_date": "2022-04-12T20:14:07Z"
  },
  "references": [
    {
      "url": "https://github.com/alvarotrigo/fullpage.js/commit/e7a5db42711700c8a584e61b5e532a64039fe92b",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/08d2a6d0-772f-4b05-834e-86343f263c35",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alvarotrigo/fullpage.js/commit/e7a5db42711700c8a584e61b5e532a64039fe92b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/08d2a6d0-772f-4b05-834e-86343f263c35",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.377004",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fullPage.js",
    "owner": "alvarotrigo",
    "created_at": "2013-09-20T11:58:29Z",
    "updated_at": "2025-01-13T22:44:13Z",
    "pushed_at": "2024-12-09T01:05:54Z",
    "size": 17215,
    "stars": 35343,
    "forks": 7283,
    "open_issues": 157,
    "watchers": 35343,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 438564,
      "HTML": 20372,
      "CSS": 7691
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:03:15.806212"
  }
}