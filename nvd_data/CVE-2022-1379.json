{
  "cve_id": "CVE-2022-1379",
  "github_data": {
    "repository": "plantuml/plantuml",
    "fix_commit": "93e5964e5f35914f3f7b89de620c596795550083",
    "related_commits": [
      "93e5964e5f35914f3f7b89de620c596795550083",
      "93e5964e5f35914f3f7b89de620c596795550083"
    ],
    "patch_url": "https://github.com/plantuml/plantuml/commit/93e5964e5f35914f3f7b89de620c596795550083.patch",
    "fix_commit_details": {
      "sha": "93e5964e5f35914f3f7b89de620c596795550083",
      "commit_date": "2022-05-04T17:52:00Z",
      "author": {
        "login": "arnaudroques",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Import version 1.2022.5",
        "length": 23,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 926,
        "additions": 513,
        "deletions": 413
      },
      "files": [
        {
          "filename": "build.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -20,7 +20,7 @@\n \t<target name=\"compile\">\n \t\t<delete dir=\"build\" />\n \t\t<mkdir dir=\"build\" />\n-\t\t<javac target=\"1.7\" source=\"1.7\" srcdir=\"src\" destdir=\"build\" debug=\"on\" />\n+\t\t<javac target=\"1.8\" source=\"1.8\" srcdir=\"src\" destdir=\"build\" debug=\"on\" />\n \t\t<copy file=\"src/net/sourceforge/plantuml/version/logo.png\"\n \t\t\ttodir=\"build/net/sourceforge/plantuml/version\" />\n \t\t<copy file=\"src/net/sourceforge/plantuml/version/favicon.png\""
        },
        {
          "filename": "skin/plantuml.skin",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -423,7 +423,7 @@ timingDiagram {\n \t  FontSize 12\n \t  LineColor darkgreen\n \t  BackgroundColor: var(--grey-blue);\n-      LineThickness 2\n+      LineThickness 1.5\n \t}\n \trobust {\n \t  FontStyle plain"
        },
        {
          "filename": "skin/rose.skin",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -136,6 +136,14 @@ group {\n     BackGroundColor transparent\n }\n \n+componentDiagram {\n+  node, rectangle {\n+    LineColor black\n+    LineThickness 1.5\n+  }\n+}\n+\n+\n sequenceDiagram {\n   group {\n     LineColor black\n@@ -494,6 +502,7 @@ timingDiagram {\n \t  FontSize 12\n \t  LineColor darkgreen\n \t  BackgroundColor #c\n+      LineThickness 1.5\n \t}\n \trobust {\n \t  FontStyle plain"
        },
        {
          "filename": "src/net/sourceforge/plantuml/SkinParam.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -217,7 +217,7 @@ List<String> cleanForKey(String key) {\n \n \tList<String> cleanForKeySlow(String key) {\n \t\tkey = StringUtils.trin(StringUtils.goLowerCase(key));\n-\t\tkey = key.replaceAll(\"_|\\\\.|\\\\s\", \"\");\n+\t\tkey = key.replaceAll(\"_|\\\\.\", \"\");\n \t\t// key = replaceSmart(key, \"partition\", \"package\");\n \t\tkey = replaceSmart(key, \"sequenceparticipant\", \"participant\");\n \t\tkey = replaceSmart(key, \"sequenceactor\", \"actor\");"
        },
        {
          "filename": "src/net/sourceforge/plantuml/elk/CucaDiagramFileMakerElk.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -258,7 +258,7 @@ private void drawSingleCluster(UGraphic ug, IGroup group, ElkNode elkNode) {\n \t\t\tfinal Style style = Cluster.getDefaultStyleDefinition(umlDiagramType.getStyleName(), group.getUSymbol())\n \t\t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder());\n \t\t\tfinal double shadowing = style.value(PName.Shadowing).asDouble();\n-\t\t\tfinal UStroke stroke = Cluster.getStrokeInternal(group, skinParam, style);\n+\t\t\tfinal UStroke stroke = Cluster.getStrokeInternal(group, style);\n \n \t\t\tHColor backColor = getBackColor(umlDiagramType);\n \t\t\tbackColor = Cluster.getBackColor(backColor, skinParam, group.getStereotype(), umlDiagramType.getStyleName(),"
        },
        {
          "filename": "src/net/sourceforge/plantuml/security/SURL.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -110,7 +110,7 @@ public class SURL {\n \t/**\n \t * Regex to remove the UserInfo part from a URL.\n \t */\n-\tprivate static final Pattern PATTERN_USERINFO = Pattern.compile(\"(^https?://)([-_:0-9a-zA-Z]+@)([^@]*)\");\n+\tprivate static final Pattern PATTERN_USERINFO = Pattern.compile(\"(^https?://)([-_0-9a-zA-Z]+@)([^@]*)\");\n \n \tprivate static final ExecutorService EXE = Executors.newCachedThreadPool(new ThreadFactory() {\n \t\tpublic Thread newThread(Runnable r) {"
        },
        {
          "filename": "src/net/sourceforge/plantuml/style/CommandStyleMultilinesCSS.java",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -37,7 +37,6 @@\n \n import net.sourceforge.plantuml.SkinParam;\n import net.sourceforge.plantuml.TitledDiagram;\n-import net.sourceforge.plantuml.UseStyle;\n import net.sourceforge.plantuml.command.BlocLines;\n import net.sourceforge.plantuml.command.CommandExecutionResult;\n import net.sourceforge.plantuml.command.CommandMultilines2;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/style/Context.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -83,7 +83,7 @@ public Collection<StyleSignatureBasic> toSignatures() {\n \t\t\tfinal List<StyleSignatureBasic> tmp = new ArrayList<>();\n \t\t\tfor (StyleSignatureBasic ss : results)\n \t\t\t\tfor (String name : names)\n-\t\t\t\t\ttmp.add(ss.add(name));\n+\t\t\t\t\ttmp.add(ss.add(name.trim()));\n \t\t\tresults = tmp;\n \t\t}\n "
        },
        {
          "filename": "src/net/sourceforge/plantuml/style/FromSkinparamToStyle.java",
          "status": "modified",
          "additions": 22,
          "deletions": 2,
          "patch": "@@ -210,6 +210,14 @@ public String toString() {\n \t\taddMagic(SName.usecase);\n \t\taddMagic(SName.map);\n \t\taddMagic(SName.archimate);\n+\t\t\n+\t\t\n+//\t\taddConvert(\"nodeStereotypeFontSize\", PName.FontSize, SName.node, SName.stereotype);\n+//\t\taddConvert(\"sequenceStereotypeFontSize\", PName.FontSize, SName.stereotype);\n+//\t\taddConvert(\"sequenceStereotypeFontStyle\", PName.FontStyle, SName.stereotype);\n+//\t\taddConvert(\"sequenceStereotypeFontColor\", PName.FontColor, SName.stereotype);\n+//\t\taddConvert(\"sequenceStereotypeFontName\", PName.FontName, SName.stereotype);\n+\n \n \t}\n \n@@ -221,8 +229,14 @@ private static void addMagic(SName sname) {\n \t\taddConvert(cleanName + \"RoundCorner\", PName.RoundCorner, sname);\n \t\taddConvert(cleanName + \"DiagonalCorner\", PName.DiagonalCorner, sname);\n \t\taddConvert(cleanName + \"BorderStyle\", PName.LineStyle, sname);\n-\t\taddConvert(cleanName + \"StereotypeFontColor\", PName.FontColor, SName.stereotype, sname);\n \t\taddConFont(cleanName, sname);\n+\t\taddConvert(cleanName + \"Shadowing\", PName.Shadowing, sname);\n+\t\t\n+\t\taddConvert(cleanName + \"StereotypeFontSize\", PName.FontSize, SName.stereotype, sname);\n+\t\taddConvert(cleanName + \"StereotypeFontStyle\", PName.FontStyle, SName.stereotype, sname);\n+\t\taddConvert(cleanName + \"StereotypeFontColor\", PName.FontColor, SName.stereotype, sname);\n+\t\taddConvert(cleanName + \"StereotypeFontName\", PName.FontName, SName.stereotype, sname);\n+\n \t}\n \n \tprivate final List<Style> styles = new ArrayList<>();\n@@ -234,7 +248,7 @@ public FromSkinparamToStyle(String key) {\n \t\tif (key.contains(\"<<\")) {\n \t\t\tfinal StringTokenizer st = new StringTokenizer(key, \"<>\");\n \t\t\tthis.key = st.nextToken();\n-\t\t\tthis.stereo = st.hasMoreTokens() ? st.nextToken() : null;\n+\t\t\tthis.stereo = st.hasMoreTokens() ? st.nextToken().trim() : null;\n \t\t} else {\n \t\t\tthis.key = key;\n \t\t\tthis.stereo = null;\n@@ -243,6 +257,12 @@ public FromSkinparamToStyle(String key) {\n \t}\n \n \tpublic void convertNow(String value, final AutomaticCounter counter) {\n+\t\tif (key.endsWith(\"shadowing\")) {\n+\t\t\tif (value.equalsIgnoreCase(\"false\"))\n+\t\t\t\tvalue = \"0\";\n+\t\t\telse if (value.equalsIgnoreCase(\"true\"))\n+\t\t\t\tvalue = \"3\";\n+\t\t}\n \t\tif (value.equalsIgnoreCase(\"right:right\"))\n \t\t\tvalue = \"right\";\n \t\tif (value.equalsIgnoreCase(\"dotted\"))"
        },
        {
          "filename": "src/net/sourceforge/plantuml/style/StyleLoader.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -164,7 +164,7 @@ public static Collection<Style> getDeclaredStyles(BlocLines lines, AutomaticCoun\n \n \t\t\tfinal Matcher2 mKeyNames = keyName.matcher(trimmed);\n \t\t\tif (mKeyNames.find()) {\n-\t\t\t\tString names = mKeyNames.group(1).replace(\" \", \"\");\n+\t\t\t\tString names = mKeyNames.group(1);\n \t\t\t\tfinal boolean isRecurse = mKeyNames.group(2) != null;\n \t\t\t\tif (isRecurse)\n \t\t\t\t\tnames += \"*\";"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/Boundary.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,9 +35,8 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.SymbolContext;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/CircleInterface2.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,9 +35,8 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/Cluster.java",
          "status": "modified",
          "additions": 63,
          "deletions": 99,
          "patch": "@@ -74,11 +74,10 @@\n import net.sourceforge.plantuml.graphic.color.ColorType;\n import net.sourceforge.plantuml.graphic.color.Colors;\n import net.sourceforge.plantuml.posimo.Moveable;\n-import net.sourceforge.plantuml.skin.rose.Rose;\n-import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.svek.image.EntityImageState;\n import net.sourceforge.plantuml.ugraphic.UComment;\n@@ -308,48 +307,25 @@ static public StyleSignature getDefaultStyleDefinitionStateGroup(Stereotype ster\n \t\t\t\t.withTOBECHANGED(stereotype);\n \t}\n \n-\tpublic void drawU(UGraphic ug, UmlDiagramType umlDiagramType, ISkinParam skinParam2) {\n+\tpublic void drawU(UGraphic ug, UmlDiagramType umlDiagramType, ISkinParam skinParam2unused) {\n \t\tif (group.isHidden())\n \t\t\treturn;\n \n \t\tfinal String fullName = group.getCodeGetName();\n \t\tif (fullName.startsWith(\"##\") == false)\n \t\t\tug.draw(new UComment(\"cluster \" + fullName));\n \n+\t\tfinal USymbol uSymbol = group.getUSymbol() == null ? USymbols.PACKAGE : group.getUSymbol();\n+\t\tStyle style = getDefaultStyleDefinition(umlDiagramType.getStyleName(), uSymbol)\n+\t\t\t\t.withTOBECHANGED(group.getStereotype()).getMergedStyle(skinParam.getCurrentStyleBuilder());\n+\t\tfinal double shadowing = style.value(PName.Shadowing).asDouble();\n \t\tHColor borderColor;\n-\t\tStyle style = null;\n-\t\tfinal double rounded;\n-\t\tfinal double diagonalCorner;\n-\t\tfinal double shadowing;\n-\t\tif (UseStyle.useBetaStyle()) {\n-\t\t\tfinal USymbol uSymbol = group.getUSymbol() == null ? USymbols.PACKAGE : group.getUSymbol();\n-\t\t\tfinal StyleSignatureBasic tmp = getDefaultStyleDefinition(umlDiagramType.getStyleName(), uSymbol);\n-\t\t\tstyle = tmp.withTOBECHANGED(group.getStereotype()).getMergedStyle(skinParam.getCurrentStyleBuilder());\n-\t\t\tshadowing = style.value(PName.Shadowing).asDouble();\n-\t\t\tif (group.getColors().getColor(ColorType.LINE) != null)\n-\t\t\t\tborderColor = group.getColors().getColor(ColorType.LINE);\n-\t\t\telse\n-\t\t\t\tborderColor = style.value(PName.LineColor).asColor(skinParam2.getThemeStyle(),\n-\t\t\t\t\t\tskinParam2.getIHtmlColorSet());\n-\t\t\trounded = style.value(PName.RoundCorner).asDouble();\n-\t\t\tdiagonalCorner = style.value(PName.DiagonalCorner).asDouble();\n-\n-\t\t} else {\n-\t\t\tif (group.getUSymbol() == null)\n-\t\t\t\tshadowing = skinParam2.shadowing2(group.getStereotype(), USymbols.PACKAGE.getSkinParameter()) ? 3 : 0;\n-\t\t\telse\n-\t\t\t\tshadowing = skinParam2.shadowing2(group.getStereotype(), group.getUSymbol().getSkinParameter()) ? 3 : 0;\n-\n-\t\t\trounded = IEntityImage.CORNER;\n-\t\t\tif (umlDiagramType == UmlDiagramType.STATE)\n-\t\t\t\tborderColor = getColor(ColorParam.stateBorder, skinParam, group.getStereotype());\n-\t\t\telse if (umlDiagramType == UmlDiagramType.ACTIVITY)\n-\t\t\t\tborderColor = getColor(ColorParam.packageBorder, skinParam, group.getStereotype());\n-\t\t\telse\n-\t\t\t\tborderColor = getColor(ColorParam.packageBorder, skinParam, group.getStereotype());\n-\t\t\tdiagonalCorner = 0;\n-\n-\t\t}\n+\t\tif (group.getColors().getColor(ColorType.LINE) != null)\n+\t\t\tborderColor = group.getColors().getColor(ColorType.LINE);\n+\t\telse\n+\t\t\tborderColor = style.value(PName.LineColor).asColor(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n+\t\tfinal double rounded = style.value(PName.RoundCorner).asDouble();\n+\t\tfinal double diagonalCorner = style.value(PName.DiagonalCorner).asDouble();\n \n \t\tug.startGroup(Collections.singletonMap(UGroupType.ID, \"cluster_\" + fullName));\n \n@@ -368,49 +344,30 @@ else if (umlDiagramType == UmlDiagramType.ACTIVITY)\n \t\t\tfinal boolean isState = umlDiagramType == UmlDiagramType.STATE;\n \n \t\t\tif (isState && group.getUSymbol() == null) {\n-\t\t\t\tUStroke strokeForState = getDefaultStyleDefinition(SName.stateDiagram, null)\n-\t\t\t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder()).getStroke();\n-\t\t\t\tif (group.getColors().getSpecificLineStroke() != null)\n-\t\t\t\t\tstrokeForState = group.getColors().getSpecificLineStroke();\n-\n-\t\t\t\tif (group.getColors().getColor(ColorType.LINE) != null)\n-\t\t\t\t\tborderColor = group.getColors().getColor(ColorType.LINE);\n-\n-\t\t\t\tdrawUState(ug, borderColor, skinParam2, strokeForState, umlDiagramType, rounded, shadowing);\n+\t\t\t\tdrawUState(ug, umlDiagramType, rounded, shadowing);\n \t\t\t\treturn;\n \t\t\t}\n \t\t\tPackageStyle packageStyle = group.getPackageStyle();\n \t\t\tif (packageStyle == null)\n-\t\t\t\tpackageStyle = skinParam2.packageStyle();\n+\t\t\t\tpackageStyle = skinParam.packageStyle();\n \n \t\t\tif (border != null) {\n-\t\t\t\tfinal HColor tmp = skinParam2.getHtmlColor(border, group.getStereotype(), false);\n+\t\t\t\tfinal HColor tmp = skinParam.getHtmlColor(border, group.getStereotype(), false);\n \t\t\t\tif (tmp != null)\n \t\t\t\t\tborderColor = tmp;\n \t\t\t}\n \n-\t\t\tfinal UStroke stroke;\n-\t\t\tif (UseStyle.useBetaStyle())\n-\t\t\t\tstroke = getStrokeInternal(group, skinParam2, style);\n-\t\t\telse\n-\t\t\t\tstroke = getStrokeInternal(group, skinParam2, null);\n+\t\t\tfinal UStroke stroke = getStrokeInternal(group, style);\n \n \t\t\tHColor backColor = getBackColor(umlDiagramType, style);\n-\t\t\tbackColor = getBackColor(backColor, skinParam2, group.getStereotype(), umlDiagramType.getStyleName(),\n+\t\t\tbackColor = getBackColor(backColor, skinParam, group.getStereotype(), umlDiagramType.getStyleName(),\n \t\t\t\t\tgroup.getUSymbol());\n \t\t\tif (ztitle != null || zstereo != null) {\n-\t\t\t\tfinal double roundCorner;\n-\t\t\t\tif (UseStyle.useBetaStyle())\n-\t\t\t\t\troundCorner = rounded;\n-\t\t\t\telse\n-\t\t\t\t\troundCorner = group.getUSymbol() == null ? 0\n-\t\t\t\t\t\t\t: group.getUSymbol().getSkinParameter().getRoundCorner(skinParam, group.getStereotype());\n-\n \t\t\t\tfinal ClusterDecoration decoration = new ClusterDecoration(packageStyle, group.getUSymbol(), ztitle,\n \t\t\t\t\t\tzstereo, minX, minY, maxX, maxY, stroke);\n-\t\t\t\tdecoration.drawU(ug, backColor, borderColor, shadowing, roundCorner,\n-\t\t\t\t\t\tskinParam2.getHorizontalAlignment(AlignmentParam.packageTitleAlignment, null, false, null),\n-\t\t\t\t\t\tskinParam2.getStereotypeAlignment(), diagonalCorner);\n+\t\t\t\tdecoration.drawU(ug, backColor, borderColor, shadowing, rounded,\n+\t\t\t\t\t\tskinParam.getHorizontalAlignment(AlignmentParam.packageTitleAlignment, null, false, null),\n+\t\t\t\t\t\tskinParam.getStereotypeAlignment(), diagonalCorner);\n \t\t\t\treturn;\n \t\t\t}\n \t\t\tfinal URectangle rect = new URectangle(maxX - minX, maxY - minY);\n@@ -425,18 +382,12 @@ else if (umlDiagramType == UmlDiagramType.ACTIVITY)\n \t\t}\n \t}\n \n-\tstatic public UStroke getStrokeInternal(IGroup group, ISkinParam skinParam, Style style) {\n+\tstatic public UStroke getStrokeInternal(IGroup group, Style style) {\n \t\tfinal Colors colors = group.getColors();\n \t\tif (colors.getSpecificLineStroke() != null)\n \t\t\treturn colors.getSpecificLineStroke();\n \n-\t\tif (style != null)\n-\t\t\treturn style.getStroke();\n-\n-\t\tif (group.getUSymbol() != null && group.getUSymbol() != USymbols.PACKAGE)\n-\t\t\treturn group.getUSymbol().getSkinParameter().getStroke(skinParam, group.getStereotype());\n-\n-\t\treturn GeneralImageBuilder.getForcedStroke(group.getStereotype(), skinParam);\n+\t\treturn style.getStroke();\n \t}\n \n \tpublic void manageEntryExitPoint(StringBounder stringBounder) {\n@@ -477,12 +428,19 @@ private void drawSwinLinesState(UGraphic ug, HColor borderColor) {\n \n \t}\n \n-\tprivate HColor getColorLegacy(ISkinParam skinParam, ColorParam colorParam, Stereotype stereo) {\n-\t\treturn new Rose().getHtmlColor(skinParam, stereo, colorParam);\n+\t// GroupPngMakerState\n+\tprivate Style getStyleStateHeader() {\n+\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.stateDiagram, SName.state, SName.header)\n+\t\t\t\t.withTOBECHANGED(group.getStereotype()).getMergedStyle(skinParam.getCurrentStyleBuilder());\n \t}\n \n-\tprivate void drawUState(UGraphic ug, HColor borderColor, ISkinParam skinParam2, UStroke stroke,\n-\t\t\tUmlDiagramType umlDiagramType, double rounded, double shadowing) {\n+\tprivate Style getStyleState() {\n+\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.stateDiagram, SName.state)\n+\t\t\t\t.withTOBECHANGED(group.getStereotype()).getMergedStyle(skinParam.getCurrentStyleBuilder());\n+\t}\n+\t// GroupPngMakerState\n+\n+\tprivate void drawUState(UGraphic ug, UmlDiagramType umlDiagramType, double rounded, double shadowing) {\n \t\tfinal Dimension2D total = new Dimension2DDouble(maxX - minX, maxY - minY);\n \t\tfinal double suppY;\n \t\tif (ztitle == null)\n@@ -494,26 +452,33 @@ private void drawUState(UGraphic ug, HColor borderColor, ISkinParam skinParam2,\n \t\tfinal Style styleGroup = getDefaultStyleDefinitionStateGroup(group.getStereotype())\n \t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder());\n \n-\t\tHColor stateBack = getBackColor(umlDiagramType, styleGroup);\n-\t\tif (UseStyle.useBetaStyle() == false && stateBack == null)\n-\t\t\tstateBack = getColorLegacy(skinParam2, ColorParam.stateBackground, group.getStereotype());\n+\t\tHColor borderColor = group.getColors().getColor(ColorType.LINE);\n+\t\tif (borderColor == null)\n+\t\t\tborderColor = getStyleState().value(PName.LineColor).asColor(skinParam.getThemeStyle(),\n+\t\t\t\t\tskinParam.getIHtmlColorSet());\n \n-\t\tfinal HColor background;\n-\t\tif (UseStyle.useBetaStyle() == false)\n-\t\t\tbackground = getColorLegacy(skinParam2, ColorParam.background, null);\n-\t\telse\n-\t\t\tbackground = stateBack;\n+\t\tHColor backColor = group.getColors().getColor(ColorType.BACK);\n+\t\tif (backColor == null)\n+\t\t\tbackColor = getStyleState().value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(),\n+\t\t\t\t\tskinParam.getIHtmlColorSet());\n+\n+\t\tfinal HColor imgBackcolor = getBackColor(umlDiagramType, styleGroup);\n \n \t\t// final Style style = getStyle(FontParam.STATE_ATTRIBUTE, skinParam2);\n \n-\t\tfinal TextBlock attribute = GeneralImageBuilder.stateHeader(group, styleGroup, skinParam2);\n+\t\tfinal TextBlock attribute = GeneralImageBuilder.stateHeader(group, styleGroup, skinParam);\n \t\tfinal double attributeHeight = attribute.calculateDimension(ug.getStringBounder()).getHeight();\n \t\tif (total.getWidth() == 0) {\n \t\t\tSystem.err.println(\"Cluster::drawUState issue\");\n \t\t\treturn;\n \t\t}\n+\n+\t\tUStroke stroke = group.getColors().getSpecificLineStroke();\n+\t\tif (stroke == null)\n+\t\t\tstroke = getStyleState().getStroke();\n+\n \t\tfinal RoundedContainer r = new RoundedContainer(total, suppY,\n-\t\t\t\tattributeHeight + (attributeHeight > 0 ? IEntityImage.MARGIN : 0), borderColor, stateBack, background,\n+\t\t\t\tattributeHeight + (attributeHeight > 0 ? IEntityImage.MARGIN : 0), borderColor, backColor, imgBackcolor,\n \t\t\t\tstroke, rounded, shadowing);\n \t\tr.drawU(ug.apply(new UTranslate(minX, minY)));\n \n@@ -919,20 +884,19 @@ private final HColor getBackColor(UmlDiagramType umlDiagramType, Style style) {\n \n \t\tfinal Stereotype stereo = group.getStereotype();\n \n-\t\tif (UseStyle.useBetaStyle())\n-\t\t\treturn style.value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n-\n-\t\tfinal USymbol sym = group.getUSymbol() == null ? USymbols.PACKAGE : group.getUSymbol();\n-\t\tfinal ColorParam backparam = umlDiagramType == UmlDiagramType.ACTIVITY ? ColorParam.partitionBackground\n-\t\t\t\t: sym.getColorParamBack();\n-\t\tfinal HColor c1 = skinParam.getHtmlColor(backparam, stereo, false);\n-\t\tif (c1 != null)\n-\t\t\treturn c1;\n-\n-\t\tif (parentCluster == null)\n-\t\t\treturn null;\n-\n-\t\treturn parentCluster.getBackColor(umlDiagramType, style);\n+\t\treturn style.value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n+\n+//\t\tfinal USymbol sym = group.getUSymbol() == null ? USymbols.PACKAGE : group.getUSymbol();\n+//\t\tfinal ColorParam backparam = umlDiagramType == UmlDiagramType.ACTIVITY ? ColorParam.partitionBackground\n+//\t\t\t\t: sym.getColorParamBack();\n+//\t\tfinal HColor c1 = skinParam.getHtmlColor(backparam, stereo, false);\n+//\t\tif (c1 != null)\n+//\t\t\treturn c1;\n+//\n+//\t\tif (parentCluster == null)\n+//\t\t\treturn null;\n+//\n+//\t\treturn parentCluster.getBackColor(umlDiagramType, style);\n \t}\n \n \tpublic boolean isClusterOf(IEntity ent) {"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/ClusterPosition.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,10 +36,10 @@\n package net.sourceforge.plantuml.svek;\n \n import java.awt.geom.CubicCurve2D;\n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.posimo.BezierUtils;\n \n public class ClusterPosition {"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/ConcurrentStateImage.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,14 +35,14 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.ArrayList;\n import java.util.Collection;\n import java.util.List;\n \n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.skin.rose.Rose;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/Control.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,9 +35,8 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.SymbolContext;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/CucaDiagramFileMakerSvek2InternalImage.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,13 +35,13 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.List;\n \n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/DecorateEntityImage.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,10 +35,10 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.Objects;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.HorizontalAlignment;\n import net.sourceforge.plantuml.graphic.StringBounder;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/DecorateEntityImage3.java",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -36,7 +36,6 @@\n package net.sourceforge.plantuml.svek;\n \n import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/DirectionalTextBlock.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,9 +35,8 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Direction;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/EntityDomain.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,9 +35,8 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.SymbolContext;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/EntityImageDegenerated.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,11 +35,11 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Rectangle2D;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.InnerStrategy;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.ugraphic.MinMax;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/EntityImageProtected.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,10 +35,10 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Rectangle2D;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.dot.Neighborhood;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.InnerStrategy;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/GeneralImageBuilder.java",
          "status": "modified",
          "additions": 19,
          "deletions": 17,
          "patch": "@@ -102,10 +102,10 @@\n import net.sourceforge.plantuml.graphic.USymbolHexagon;\n import net.sourceforge.plantuml.graphic.USymbolInterface;\n import net.sourceforge.plantuml.graphic.USymbols;\n-import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.svek.image.EntityImageActivity;\n import net.sourceforge.plantuml.svek.image.EntityImageArcCircle;\n@@ -703,24 +703,26 @@ private TextBlock getTitleBlock(IGroup g) {\n \t\t\treturn TextBlockUtils.empty(0, 0);\n \n \t\tfinal ISkinParam skinParam = dotData.getSkinParam();\n-\t\tfinal FontConfiguration fontConfiguration;\n-\t\tif (UseStyle.useBetaStyle()) {\n-\t\t\tfinal SName sname = dotData.getUmlDiagramType().getStyleName();\n-\t\t\tfinal StyleSignatureBasic signature;\n-\t\t\tfinal USymbol uSymbol = g.getUSymbol();\n-\t\t\tif (uSymbol == USymbols.RECTANGLE)\n-\t\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, sname, uSymbol.getSName(), SName.title);\n-\t\t\telse\n-\t\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, sname, SName.title);\n \n-\t\t\tfinal Style style = signature //\n-\t\t\t\t\t.withTOBECHANGED(g.getStereotype()) //\n-\t\t\t\t\t.with(g.getStereostyles()) //\n-\t\t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder());\n+\t\tfinal SName sname = dotData.getUmlDiagramType().getStyleName();\n+\t\tfinal StyleSignatureBasic signature;\n+\t\tfinal USymbol uSymbol = g.getUSymbol();\n+\t\tif (g.getGroupType() == GroupType.STATE)\n+\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, SName.stateDiagram, SName.state,\n+\t\t\t\t\tSName.header);\n+\t\telse if (uSymbol == USymbols.RECTANGLE)\n+\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, sname, uSymbol.getSName(), SName.title);\n+\t\telse\n+\t\t\tsignature = StyleSignatureBasic.of(SName.root, SName.element, sname, SName.title);\n+\n+\t\tfinal Style style = signature //\n+\t\t\t\t.withTOBECHANGED(g.getStereotype()) //\n+\t\t\t\t.with(g.getStereostyles()) //\n+\t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder());\n+\n+\t\tfinal FontConfiguration fontConfiguration = style.getFontConfiguration(skinParam.getThemeStyle(),\n+\t\t\t\tskinParam.getIHtmlColorSet());\n \n-\t\t\tfontConfiguration = style.getFontConfiguration(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n-\t\t} else\n-\t\t\tfontConfiguration = g.getFontConfigurationForTitle(skinParam);\n \t\tfinal HorizontalAlignment alignment = HorizontalAlignment.CENTER;\n \t\treturn label.create(fontConfiguration, alignment, dotData.getSkinParam());\n \t}"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/GraphvizCrash.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,14 +36,14 @@\n package net.sourceforge.plantuml.svek;\n \n import java.awt.Color;\n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.image.BufferedImage;\n import java.util.ArrayList;\n import java.util.List;\n \n import net.sourceforge.plantuml.BackSlash;\n import net.sourceforge.plantuml.OptionPrint;\n import net.sourceforge.plantuml.StringUtils;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.CommandExecutionResult;\n import net.sourceforge.plantuml.cucadiagram.dot.GraphvizUtils;\n import net.sourceforge.plantuml.flashcode.FlashCodeFactory;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/GroupPngMakerState.java",
          "status": "modified",
          "additions": 13,
          "deletions": 47,
          "patch": "@@ -40,10 +40,7 @@\n import java.util.List;\n import java.util.Set;\n \n-import net.sourceforge.plantuml.ColorParam;\n-import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n-import net.sourceforge.plantuml.UseStyle;\n import net.sourceforge.plantuml.cucadiagram.CucaDiagram;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.EntityUtils;\n@@ -62,7 +59,6 @@\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.color.ColorType;\n-import net.sourceforge.plantuml.skin.rose.Rose;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n@@ -128,30 +124,18 @@ private Style getStyleStateHeader() {\n \t}\n \n \tprivate Style getStyleState() {\n-\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.stateDiagram, SName.state).withTOBECHANGED(group.getStereotype())\n-\t\t\t\t.getMergedStyle(diagram.getSkinParam().getCurrentStyleBuilder());\n+\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.stateDiagram, SName.state)\n+\t\t\t\t.withTOBECHANGED(group.getStereotype()).getMergedStyle(diagram.getSkinParam().getCurrentStyleBuilder());\n \t}\n \n \tpublic IEntityImage getImage() {\n \t\tfinal Display display = group.getDisplay();\n \t\tfinal ISkinParam skinParam = diagram.getSkinParam();\n \n-\t\tfinal FontConfiguration fontConfiguration;\n-\t\tfinal double rounded;\n-\t\tdouble shadowing = 0;\n-\n-\t\tif (UseStyle.useBetaStyle()) {\n-\t\t\trounded = getStyleState().value(PName.RoundCorner).asDouble();\n-\t\t\tshadowing = getStyleState().value(PName.Shadowing).asDouble();\n-\t\t\tfontConfiguration = getStyleStateHeader().getFontConfiguration(skinParam.getThemeStyle(),\n-\t\t\t\t\tskinParam.getIHtmlColorSet());\n-\t\t} else {\n-\t\t\trounded = IEntityImage.CORNER;\n-\t\t\tfontConfiguration = FontConfiguration.create(skinParam, FontParam.STATE, group.getStereotype());\n-\t\t\tif (skinParam.shadowing(group.getStereotype()))\n-\t\t\t\tshadowing = 3.0;\n-\t\t}\n-\n+\t\tfinal double rounded = getStyleState().value(PName.RoundCorner).asDouble();\n+\t\tfinal double shadowing = getStyleState().value(PName.Shadowing).asDouble();\n+\t\tfinal FontConfiguration fontConfiguration = getStyleStateHeader()\n+\t\t\t\t.getFontConfiguration(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n \t\tfinal TextBlock title = display.create(fontConfiguration, HorizontalAlignment.CENTER, diagram.getSkinParam());\n \n \t\tif (group.size() == 0 && group.getChildren().size() == 0)\n@@ -175,30 +159,18 @@ skinParam, new InnerGroupHierarchy(), diagram.getColorMapper(), diagram.getEntit\n \n \t\tHColor borderColor = group.getColors().getColor(ColorType.LINE);\n \t\tif (borderColor == null)\n-\t\t\tif (UseStyle.useBetaStyle())\n-\t\t\t\tborderColor = getStyleState().value(PName.LineColor).asColor(skinParam.getThemeStyle(),\n-\t\t\t\t\t\tskinParam.getIHtmlColorSet());\n-\t\t\telse\n-\t\t\t\tborderColor = getColor(ColorParam.stateBorder, group.getStereotype());\n+\t\t\tborderColor = getStyleState().value(PName.LineColor).asColor(skinParam.getThemeStyle(),\n+\t\t\t\t\tskinParam.getIHtmlColorSet());\n \n \t\tfinal Stereotype stereo = group.getStereotype();\n-\t\tfinal HColor tmp = group.getColors().getColor(ColorType.BACK);\n-\t\tfinal HColor backColor;\n-\t\tif (tmp == null)\n-\t\t\tif (UseStyle.useBetaStyle())\n-\t\t\t\tbackColor = getStyleState().value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(),\n-\t\t\t\t\t\tskinParam.getIHtmlColorSet());\n-\t\t\telse\n-\t\t\t\tbackColor = getColor(ColorParam.stateBackground, stereo);\n-\t\telse\n-\t\t\tbackColor = tmp;\n+\t\tHColor backColor = group.getColors().getColor(ColorType.BACK);\n+\t\tif (backColor == null)\n+\t\t\tbackColor = getStyleState().value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(),\n+\t\t\t\t\tskinParam.getIHtmlColorSet());\n \n \t\tUStroke stroke = group.getColors().getSpecificLineStroke();\n \t\tif (stroke == null)\n-\t\t\tif (UseStyle.useBetaStyle())\n-\t\t\t\tstroke = getStyleState().getStroke();\n-\t\t\telse\n-\t\t\t\tstroke = new UStroke(1.5);\n+\t\t\tstroke = getStyleState().getStroke();\n \n \t\tfinal TextBlock attribute = GeneralImageBuilder.stateHeader((IEntity) group, null, skinParam);\n \n@@ -236,10 +208,4 @@ private boolean containsOnlyConcurrentStates(DotData dotData) {\n \t\treturn true;\n \t}\n \n-\tprivate final Rose rose = new Rose();\n-\n-\tprivate HColor getColor(ColorParam colorParam, Stereotype stereo) {\n-\t\tfinal ISkinParam skinParam = diagram.getSkinParam();\n-\t\treturn rose.getHtmlColor(skinParam, stereo, colorParam);\n-\t}\n }"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/HeaderLayout.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,9 +35,8 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.TextBlockEmpty;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/InnerActivity.java",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -36,7 +36,6 @@\n package net.sourceforge.plantuml.svek;\n \n import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.ugraphic.UGraphic;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/InnerStateAutonom.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,10 +35,9 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.Url;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/PackageStyle.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,10 +36,10 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.EnumSet;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.USymbol;\n import net.sourceforge.plantuml.graphic.USymbols;\n import net.sourceforge.plantuml.ugraphic.UGraphic;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/RoundedContainer.java",
          "status": "modified",
          "additions": 21,
          "deletions": 19,
          "patch": "@@ -36,13 +36,15 @@\n package net.sourceforge.plantuml.svek;\n \n import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ugraphic.UGraphic;\n import net.sourceforge.plantuml.ugraphic.ULine;\n+import net.sourceforge.plantuml.ugraphic.UPath;\n import net.sourceforge.plantuml.ugraphic.URectangle;\n+import net.sourceforge.plantuml.ugraphic.UShape;\n import net.sourceforge.plantuml.ugraphic.UStroke;\n import net.sourceforge.plantuml.ugraphic.UTranslate;\n import net.sourceforge.plantuml.ugraphic.color.HColor;\n+import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n \n public final class RoundedContainer {\n \n@@ -58,9 +60,9 @@ public final class RoundedContainer {\n \n \tpublic RoundedContainer(Dimension2D dim, double titleHeight, double attributeHeight, HColor borderColor,\n \t\t\tHColor backColor, HColor imgBackcolor, UStroke stroke, double rounded, double shadowing) {\n-\t\tif (dim.getWidth() == 0) {\n+\t\tif (dim.getWidth() == 0)\n \t\t\tthrow new IllegalArgumentException();\n-\t\t}\n+\n \t\tthis.rounded = rounded;\n \t\tthis.dim = dim;\n \t\tthis.imgBackcolor = imgBackcolor;\n@@ -73,28 +75,28 @@ public RoundedContainer(Dimension2D dim, double titleHeight, double attributeHei\n \t}\n \n \tpublic void drawU(UGraphic ug) {\n-\t\tug = ug.apply(backColor.bg()).apply(borderColor);\n+\t\tug = ug.apply(backColor.bg()).apply(borderColor).apply(stroke);\n \t\tfinal URectangle rect = new URectangle(dim.getWidth(), dim.getHeight()).rounded(rounded);\n-\t\trect.setDeltaShadow(shadowing);\n-\t\tug.apply(stroke).draw(rect);\n-\n-\t\tfinal double yLine = titleHeight + attributeHeight;\n \n-\t\tug = ug.apply(imgBackcolor.bg());\n+\t\tif (shadowing > 0) {\n+\t\t\trect.setDeltaShadow(shadowing);\n+\t\t\tug.apply(HColorUtils.transparent().bg()).draw(rect);\n+\t\t\trect.setDeltaShadow(0);\n+\t\t\t\n+\t\t}\n+\t\tfinal double headerHeight = titleHeight + attributeHeight;\n \n-\t\tfinal double thickness = stroke.getThickness();\n+\t\tnew RoundedNorth(dim.getWidth(), headerHeight, backColor, rounded).drawU(ug);\n+\t\tnew RoundedSouth(dim.getWidth(), dim.getHeight() - headerHeight, imgBackcolor, rounded)\n+\t\t\t\t.drawU(ug.apply(UTranslate.dy(headerHeight)));\n \n-\t\tfinal URectangle inner = new URectangle(dim.getWidth() - 4 * thickness,\n-\t\t\t\tdim.getHeight() - titleHeight - 4 * thickness - attributeHeight).rounded(rounded);\n-\t\tug.apply(imgBackcolor).apply(new UTranslate(2 * thickness, yLine + 2 * thickness)).draw(inner);\n+\t\tug.apply(HColorUtils.transparent().bg()).draw(rect);\n \n-\t\tif (titleHeight > 0) {\n-\t\t\tug.apply(stroke).apply(UTranslate.dy(yLine)).draw(ULine.hline(dim.getWidth()));\n-\t\t}\n+\t\tif (headerHeight > 0)\n+\t\t\tug.apply(UTranslate.dy(headerHeight)).draw(ULine.hline(dim.getWidth()));\n \n-\t\tif (attributeHeight > 0) {\n-\t\t\tug.apply(stroke).apply(UTranslate.dy(yLine - attributeHeight)).draw(ULine.hline(dim.getWidth()));\n-\t\t}\n+\t\tif (attributeHeight > 0)\n+\t\t\tug.apply(UTranslate.dy(titleHeight)).draw(ULine.hline(dim.getWidth()));\n \n \t}\n }"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/RoundedNorth.java",
          "status": "added",
          "additions": 88,
          "deletions": 0,
          "patch": "@@ -0,0 +1,88 @@\n+/* ========================================================================\n+ * PlantUML : a free UML diagram generator\n+ * ========================================================================\n+ *\n+ * (C) Copyright 2009-2023, Arnaud Roques\n+ *\n+ * Project Info:  http://plantuml.com\n+ * \n+ * If you like this project or if you find it useful, you can support us at:\n+ * \n+ * http://plantuml.com/patreon (only 1$ per month!)\n+ * http://plantuml.com/paypal\n+ * \n+ * This file is part of PlantUML.\n+ *\n+ * PlantUML is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * PlantUML distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public\n+ * License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,\n+ * USA.\n+ *\n+ *\n+ * Original Author:  Arnaud Roques\n+ * \n+ *\n+ */\n+package net.sourceforge.plantuml.svek;\n+\n+import net.sourceforge.plantuml.graphic.UDrawable;\n+import net.sourceforge.plantuml.ugraphic.UGraphic;\n+import net.sourceforge.plantuml.ugraphic.UPath;\n+import net.sourceforge.plantuml.ugraphic.URectangle;\n+import net.sourceforge.plantuml.ugraphic.UShape;\n+import net.sourceforge.plantuml.ugraphic.UStroke;\n+import net.sourceforge.plantuml.ugraphic.color.HColor;\n+import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n+\n+public final class RoundedNorth implements UDrawable {\n+\n+\tprivate final double width;\n+\tprivate final double height;\n+\tprivate final HColor backColor;\n+\tprivate final double rounded;\n+\n+\tpublic RoundedNorth(double width, double height, HColor backColor, double rounded) {\n+\t\tif (width == 0)\n+\t\t\tthrow new IllegalArgumentException();\n+\t\tif (height == 0)\n+\t\t\tthrow new IllegalArgumentException();\n+\n+\t\tthis.width = width;\n+\t\tthis.height = height;\n+\t\tthis.rounded = rounded;\n+\t\tthis.backColor = backColor;\n+\t}\n+\n+\tpublic void drawU(UGraphic ug) {\n+\t\tif (HColorUtils.isTransparent(backColor))\n+\t\t\treturn;\n+\n+\t\tfinal UShape header;\n+\t\tif (rounded == 0) {\n+\t\t\theader = new URectangle(width, height);\n+\t\t} else {\n+\t\t\tfinal UPath path = new UPath();\n+\t\t\tpath.moveTo(rounded / 2, 0);\n+\t\t\tpath.lineTo(width - rounded / 2, 0);\n+\t\t\tpath.arcTo(rounded / 2, rounded / 2, 0, 0, 1, width, rounded / 2);\n+\t\t\tpath.lineTo(width, height);\n+\t\t\tpath.lineTo(0, height);\n+\t\t\tpath.lineTo(0, rounded / 2);\n+\t\t\tpath.arcTo(rounded / 2, rounded / 2, 0, 0, 1, rounded / 2, 0);\n+\t\t\tpath.closePath();\n+\t\t\theader = path;\n+\t\t}\n+\t\tug.apply(new UStroke()).apply(backColor).apply(backColor.bg()).draw(header);\n+\n+\t}\n+}"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/RoundedSouth.java",
          "status": "added",
          "additions": 88,
          "deletions": 0,
          "patch": "@@ -0,0 +1,88 @@\n+/* ========================================================================\n+ * PlantUML : a free UML diagram generator\n+ * ========================================================================\n+ *\n+ * (C) Copyright 2009-2023, Arnaud Roques\n+ *\n+ * Project Info:  http://plantuml.com\n+ * \n+ * If you like this project or if you find it useful, you can support us at:\n+ * \n+ * http://plantuml.com/patreon (only 1$ per month!)\n+ * http://plantuml.com/paypal\n+ * \n+ * This file is part of PlantUML.\n+ *\n+ * PlantUML is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU General Public License as published by\n+ * the Free Software Foundation, either version 3 of the License, or\n+ * (at your option) any later version.\n+ *\n+ * PlantUML distributed in the hope that it will be useful, but\n+ * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+ * or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public\n+ * License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public\n+ * License along with this library; if not, write to the Free Software\n+ * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,\n+ * USA.\n+ *\n+ *\n+ * Original Author:  Arnaud Roques\n+ * \n+ *\n+ */\n+package net.sourceforge.plantuml.svek;\n+\n+import net.sourceforge.plantuml.graphic.UDrawable;\n+import net.sourceforge.plantuml.ugraphic.UGraphic;\n+import net.sourceforge.plantuml.ugraphic.UPath;\n+import net.sourceforge.plantuml.ugraphic.URectangle;\n+import net.sourceforge.plantuml.ugraphic.UShape;\n+import net.sourceforge.plantuml.ugraphic.UStroke;\n+import net.sourceforge.plantuml.ugraphic.color.HColor;\n+import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n+\n+public final class RoundedSouth implements UDrawable {\n+\n+\tprivate final double width;\n+\tprivate final double height;\n+\tprivate final HColor backColor;\n+\tprivate final double rounded;\n+\n+\tpublic RoundedSouth(double width, double height, HColor backColor, double rounded) {\n+\t\tif (width == 0)\n+\t\t\tthrow new IllegalArgumentException();\n+\t\tif (height == 0)\n+\t\t\tthrow new IllegalArgumentException();\n+\n+\t\tthis.width = width;\n+\t\tthis.height = height;\n+\t\tthis.rounded = rounded;\n+\t\tthis.backColor = backColor;\n+\t}\n+\n+\tpublic void drawU(UGraphic ug) {\n+\t\tif (HColorUtils.isTransparent(backColor))\n+\t\t\treturn;\n+\n+\t\tfinal UShape header;\n+\t\tif (rounded == 0) {\n+\t\t\theader = new URectangle(width, height);\n+\t\t} else {\n+\t\t\tfinal UPath path = new UPath();\n+\t\t\tpath.moveTo(0, 0);\n+\t\t\tpath.lineTo(width, 0);\n+\t\t\tpath.lineTo(width, height - rounded / 2);\n+\t\t\tpath.arcTo(rounded / 2, rounded / 2, 0, 0, 1, width - rounded / 2, height);\n+\t\t\tpath.lineTo(rounded / 2, height);\n+\t\t\tpath.arcTo(rounded / 2, rounded / 2, 0, 0, 1, 0, height - rounded / 2);\n+\t\t\tpath.lineTo(0, 0);\n+\t\t\tpath.closePath();\n+\t\t\theader = path;\n+\t\t}\n+\t\tug.apply(new UStroke()).apply(backColor).apply(backColor.bg()).draw(header);\n+\n+\t}\n+}"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/SvekLine.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.ArrayList;\n import java.util.Collection;\n@@ -57,6 +56,7 @@\n import net.sourceforge.plantuml.StringUtils;\n import net.sourceforge.plantuml.UmlDiagramType;\n import net.sourceforge.plantuml.Url;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.EntityPort;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/SvekNode.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,13 +35,13 @@\n  */\n package net.sourceforge.plantuml.svek;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.List;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.Hideable;\n import net.sourceforge.plantuml.StringUtils;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.EntityPosition;\n import net.sourceforge.plantuml.cucadiagram.IGroup;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/SvekResult.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -49,11 +49,11 @@\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlockUtils;\n import net.sourceforge.plantuml.skin.rose.Rose;\n-import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n import net.sourceforge.plantuml.style.StyleBuilder;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.ugraphic.MinMax;\n import net.sourceforge.plantuml.ugraphic.UGraphic;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/AbstractEntityImageBorder.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -36,10 +36,9 @@\n \n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.EntityPosition;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.Rankdir;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageActivity.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -50,10 +50,10 @@\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.color.ColorType;\n-import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.svek.AbstractEntityImage;\n import net.sourceforge.plantuml.svek.Bibliotekon;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageArcCircle.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,12 +35,11 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.Guillemet;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageAssociation.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,13 +35,12 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.style.PName;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageAssociationPoint.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,10 +35,9 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.svek.AbstractEntityImage;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageBranch.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.EnumMap;\n import java.util.Map;\n \n@@ -44,6 +43,7 @@\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.style.PName;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageCircleEnd.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,13 +35,12 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.style.PName;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageCircleStart.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,13 +35,12 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.style.PName;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageClass.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Rectangle2D;\n import java.util.EnumMap;\n import java.util.Map;\n@@ -50,6 +49,7 @@\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.Url;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.creole.Stencil;\n import net.sourceforge.plantuml.cucadiagram.EntityPortion;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageClassHeader.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,14 +35,13 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.Guillemet;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.EntityPortion;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageEmptyPackage.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -61,10 +61,10 @@\n import net.sourceforge.plantuml.graphic.USymbols;\n import net.sourceforge.plantuml.graphic.color.ColorType;\n import net.sourceforge.plantuml.graphic.color.Colors;\n-import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.svek.AbstractEntityImage;\n import net.sourceforge.plantuml.svek.Cluster;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageGroup.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,10 +35,9 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.svek.AbstractEntityImage;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageJson.java",
          "status": "modified",
          "additions": 0,
          "deletions": 4,
          "patch": "@@ -35,9 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import java.util.EnumMap;\n-import java.util.Map;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.CornerParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n@@ -76,7 +73,6 @@\n import net.sourceforge.plantuml.ugraphic.Shadowable;\n import net.sourceforge.plantuml.ugraphic.UGraphic;\n import net.sourceforge.plantuml.ugraphic.UGraphicStencil;\n-import net.sourceforge.plantuml.ugraphic.UGroupType;\n import net.sourceforge.plantuml.ugraphic.ULayoutGroup;\n import net.sourceforge.plantuml.ugraphic.URectangle;\n import net.sourceforge.plantuml.ugraphic.UStroke;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageLollipopInterface.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.EnumMap;\n import java.util.Map;\n \n@@ -46,6 +45,7 @@\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.Url;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.LeafType;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageLollipopInterfaceEye1.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.List;\n \n@@ -45,6 +44,7 @@\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.Url;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.graphic.FontConfiguration;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageLollipopInterfaceEye2.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.Objects;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n@@ -44,6 +43,7 @@\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.Url;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.BodyFactory;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.EntityPortion;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageNote.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Line2D;\n import java.awt.geom.Point2D;\n import java.util.EnumMap;\n@@ -55,6 +54,7 @@\n import net.sourceforge.plantuml.UmlDiagramType;\n import net.sourceforge.plantuml.Url;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.creole.Stencil;\n import net.sourceforge.plantuml.cucadiagram.BodyFactory;\n import net.sourceforge.plantuml.cucadiagram.Display;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageNoteLink.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,10 +35,9 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImagePort.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,7 +36,6 @@\n \n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n \n import net.sourceforge.plantuml.ColorParam;\n@@ -45,6 +44,7 @@\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.EntityPosition;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.StringBounder;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImagePseudoState.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,14 +35,13 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageState.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,13 +35,13 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.Collections;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.creole.CreoleMode;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.IEntity;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageState2.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,12 +35,11 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.Url;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.BodyFactory;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageStateBorder.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,14 +35,14 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n \n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.EntityPosition;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.graphic.color.ColorType;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageStateCommon.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,15 +35,14 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.LineConfigurable;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.Url;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.creole.CreoleMode;\n import net.sourceforge.plantuml.cucadiagram.IEntity;\n import net.sourceforge.plantuml.cucadiagram.Stereotype;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageStateEmptyDescription.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,11 +35,10 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.IEntity;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.ugraphic.UGraphic;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageSynchroBar.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -35,13 +35,12 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ColorParam;\n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.SkinParamUtils;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.ILeaf;\n import net.sourceforge.plantuml.cucadiagram.Rankdir;\n import net.sourceforge.plantuml.graphic.StringBounder;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageTips.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.awt.geom.Rectangle2D;\n import java.util.Map;\n@@ -48,6 +47,7 @@\n import net.sourceforge.plantuml.LineBreakStrategy;\n import net.sourceforge.plantuml.UmlDiagramType;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.BodyFactory;\n import net.sourceforge.plantuml.cucadiagram.Display;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/EntityImageUseCase.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -64,10 +64,10 @@\n import net.sourceforge.plantuml.graphic.TextBlockUtils;\n import net.sourceforge.plantuml.graphic.color.ColorType;\n import net.sourceforge.plantuml.graphic.color.Colors;\n-import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.svek.AbstractEntityImage;\n import net.sourceforge.plantuml.svek.ShapeType;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/Footprint.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -37,11 +37,11 @@\n \n import static net.sourceforge.plantuml.utils.ObjectUtils.instanceOfAny;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.ArrayList;\n import java.util.List;\n \n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.UDrawable;\n import net.sourceforge.plantuml.ugraphic.UBackground;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svek/image/Opale.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -35,11 +35,11 @@\n  */\n package net.sourceforge.plantuml.svek.image;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.Direction;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/svg/SvgGraphics.java",
          "status": "modified",
          "additions": 9,
          "deletions": 5,
          "patch": "@@ -35,7 +35,6 @@\n  */\n package net.sourceforge.plantuml.svg;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.PathIterator;\n import java.awt.image.BufferedImage;\n import java.io.ByteArrayOutputStream;\n@@ -45,9 +44,7 @@\n import java.nio.charset.Charset;\n import java.util.ArrayList;\n import java.util.Arrays;\n-import java.util.Collection;\n import java.util.HashMap;\n-import java.util.LinkedHashSet;\n import java.util.List;\n import java.util.Locale;\n import java.util.Map;\n@@ -71,6 +68,7 @@\n import net.sourceforge.plantuml.FileUtils;\n import net.sourceforge.plantuml.Log;\n import net.sourceforge.plantuml.SignatureUtils;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.code.Base64Coder;\n import net.sourceforge.plantuml.security.SImageIO;\n import net.sourceforge.plantuml.security.SecurityUtils;\n@@ -895,8 +893,14 @@ public void svgImage(UImageSvg image, double x, double y) {\n \n \t\t\tString svg = manageScale(image);\n \n-\t\t\tfinal String svgHeader = \"<svg height=\\\"\" + (int) (image.getHeight() * scale) + \"\\\" width=\\\"\"\n-\t\t\t\t\t+ (int) (image.getWidth() * scale) + \"\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" >\";\n+\t\t\tfinal String svgHeader;\n+\t\t\tif (image.containsXlink())\n+\t\t\t\tsvgHeader = \"<svg height=\\\"\" + (int) (image.getHeight() * scale) + \"\\\" width=\\\"\"\n+\t\t\t\t\t\t+ (int) (image.getWidth() * scale)\n+\t\t\t\t\t\t+ \"\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" >\";\n+\t\t\telse\n+\t\t\t\tsvgHeader = \"<svg height=\\\"\" + (int) (image.getHeight() * scale) + \"\\\" width=\\\"\"\n+\t\t\t\t\t\t+ (int) (image.getWidth() * scale) + \"\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" >\";\n \n \t\t\tsvg = svgHeader + svg.substring(5);\n "
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/ChangeState.java",
          "status": "modified",
          "additions": 11,
          "deletions": 13,
          "patch": "@@ -54,9 +54,9 @@ public class ChangeState implements Comparable<ChangeState> {\n \tprivate final Colors colors;\n \n \tpublic ChangeState(TimeTick when, String comment, Colors colors, String... states) {\n-\t\tif (states.length == 0) {\n+\t\tif (states.length == 0)\n \t\t\tthrow new IllegalArgumentException();\n-\t\t}\n+\n \t\tthis.when = when;\n \t\tthis.states = states;\n \t\tthis.comment = comment;\n@@ -84,28 +84,26 @@ public String getComment() {\n \t}\n \n \tpublic final HColor getBackColor(ISkinParam skinParam, Style style) {\n-\t\tif (colors == null || colors.getColor(ColorType.BACK) == null) {\n-\t\t\tif (UseStyle.useBetaStyle() == false)\n-\t\t\t\treturn HColorUtils.COL_D7E0F2;\n-\n+\t\tif (colors == null || colors.getColor(ColorType.BACK) == null)\n \t\t\treturn style.value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n-\t\t}\n+\n \t\treturn colors.getColor(ColorType.BACK);\n \t}\n \n \tprivate final HColor getLineColor(ISkinParam skinParam, Style style) {\n-\t\tif (colors == null || colors.getColor(ColorType.LINE) == null) {\n-\t\t\tif (UseStyle.useBetaStyle() == false)\n-\t\t\t\treturn HColorUtils.COL_038048;\n-\n+\t\tif (colors == null || colors.getColor(ColorType.LINE) == null)\n \t\t\treturn style.value(PName.LineColor).asColor(skinParam.getThemeStyle(), skinParam.getIHtmlColorSet());\n-\t\t}\n+\n \t\treturn colors.getColor(ColorType.LINE);\n \t}\n \n+\tprivate UStroke getStroke(Style style) {\n+\t\treturn style.getStroke();\n+\t}\n+\n \tpublic SymbolContext getContext(ISkinParam skinParam, Style style) {\n \t\treturn new SymbolContext(getBackColor(skinParam, style), getLineColor(skinParam, style))\n-\t\t\t\t.withStroke(new UStroke(1.5));\n+\t\t\t\t.withStroke(getStroke(style));\n \t}\n \n \tpublic final boolean isBlank() {"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/Player.java",
          "status": "modified",
          "additions": 8,
          "deletions": 17,
          "patch": "@@ -34,11 +34,10 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n-import net.sourceforge.plantuml.UseStyle;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n+import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.graphic.FontConfiguration;\n import net.sourceforge.plantuml.graphic.HorizontalAlignment;\n import net.sourceforge.plantuml.graphic.StringBounder;\n@@ -49,10 +48,10 @@\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.ugraphic.UStroke;\n import net.sourceforge.plantuml.ugraphic.color.HColor;\n-import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n \n public abstract class Player implements TimeProjected {\n \n@@ -61,8 +60,10 @@ public abstract class Player implements TimeProjected {\n \tprivate final boolean compact;\n \tprivate final Display title;\n \tprotected int suggestedHeight;\n+\tprotected final Stereotype stereotype;\n \n-\tpublic Player(String title, ISkinParam skinParam, TimingRuler ruler, boolean compact) {\n+\tpublic Player(String title, ISkinParam skinParam, TimingRuler ruler, boolean compact, Stereotype stereotype) {\n+\t\tthis.stereotype = stereotype;\n \t\tthis.skinParam = skinParam;\n \t\tthis.compact = compact;\n \t\tthis.ruler = ruler;\n@@ -73,23 +74,15 @@ public boolean isCompact() {\n \t\treturn compact;\n \t}\n \n-\tprotected abstract StyleSignatureBasic getStyleSignature();\n-\n-\tprotected abstract SymbolContext getContextLegacy();\n-//\tprivate StyleSignature getStyleSignature() {\n-//\t\treturn StyleSignature.of(SName.root, SName.element, SName.timingDiagram);\n-//\t}\n+\tprotected abstract StyleSignature getStyleSignature();\n \n \tfinal protected Style getStyle() {\n \t\treturn getStyleSignature().getMergedStyle(skinParam.getCurrentStyleBuilder());\n-\n \t}\n \n \tfinal protected FontConfiguration getFontConfiguration() {\n-\t\tif (UseStyle.useBetaStyle() == false)\n-\t\t\treturn FontConfiguration.create(skinParam, FontParam.TIMING, null);\n-\t\treturn FontConfiguration.create(skinParam, StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram)\n-\t\t\t\t.getMergedStyle(skinParam.getCurrentStyleBuilder()));\n+\t\treturn FontConfiguration.create(skinParam, StyleSignatureBasic\n+\t\t\t\t.of(SName.root, SName.element, SName.timingDiagram).getMergedStyle(skinParam.getCurrentStyleBuilder()));\n \t}\n \n \tfinal protected UStroke getStroke() {\n@@ -98,8 +91,6 @@ final protected UStroke getStroke() {\n \t}\n \n \tfinal protected SymbolContext getContext() {\n-\t\tif (UseStyle.useBetaStyle() == false)\n-\t\t\treturn getContextLegacy();\n \n \t\tfinal Style style = getStyleSignature().getMergedStyle(skinParam.getCurrentStyleBuilder());\n \t\tfinal HColor lineColor = style.value(PName.LineColor).asColor(skinParam.getThemeStyle(),"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/PlayerAnalog.java",
          "status": "modified",
          "additions": 2,
          "deletions": 10,
          "patch": "@@ -34,7 +34,6 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.Map;\n import java.util.Map.Entry;\n@@ -43,12 +42,12 @@\n \n import net.sourceforge.plantuml.Dimension2DDouble;\n import net.sourceforge.plantuml.ISkinParam;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.HorizontalAlignment;\n import net.sourceforge.plantuml.graphic.StringBounder;\n-import net.sourceforge.plantuml.graphic.SymbolContext;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.UDrawable;\n import net.sourceforge.plantuml.graphic.color.Colors;\n@@ -57,9 +56,7 @@\n import net.sourceforge.plantuml.timingdiagram.graphic.IntricatedPoint;\n import net.sourceforge.plantuml.ugraphic.UGraphic;\n import net.sourceforge.plantuml.ugraphic.ULine;\n-import net.sourceforge.plantuml.ugraphic.UStroke;\n import net.sourceforge.plantuml.ugraphic.UTranslate;\n-import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n \n public class PlayerAnalog extends Player {\n \n@@ -71,7 +68,7 @@ public class PlayerAnalog extends Player {\n \tprivate Integer ticksEvery;\n \n \tpublic PlayerAnalog(String code, ISkinParam skinParam, TimingRuler ruler, boolean compact) {\n-\t\tsuper(code, skinParam, ruler, compact);\n+\t\tsuper(code, skinParam, ruler, compact, null);\n \t\tthis.suggestedHeight = 100;\n \t}\n \n@@ -100,11 +97,6 @@ public double getFullHeight(StringBounder stringBounder) {\n \t\treturn suggestedHeight;\n \t}\n \n-\t@Override\n-\tprotected SymbolContext getContextLegacy() {\n-\t\treturn new SymbolContext(HColorUtils.COL_D7E0F2, HColorUtils.COL_038048).withStroke(new UStroke(1.5));\n-\t}\n-\n \tpublic IntricatedPoint getTimeProjection(StringBounder stringBounder, TimeTick tick) {\n \t\tfinal double x = ruler.getPosInPixel(tick);\n \t\tfinal double value = getValueAt(tick);"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/PlayerBinary.java",
          "status": "modified",
          "additions": 7,
          "deletions": 28,
          "patch": "@@ -34,7 +34,6 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.ArrayList;\n import java.util.List;\n@@ -46,27 +45,24 @@\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n+import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.FontConfiguration;\n import net.sourceforge.plantuml.graphic.HorizontalAlignment;\n import net.sourceforge.plantuml.graphic.StringBounder;\n-import net.sourceforge.plantuml.graphic.SymbolContext;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.UDrawable;\n import net.sourceforge.plantuml.graphic.color.Colors;\n-import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;\n-import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.timingdiagram.graphic.IntricatedPoint;\n import net.sourceforge.plantuml.ugraphic.UGraphic;\n import net.sourceforge.plantuml.ugraphic.ULine;\n-import net.sourceforge.plantuml.ugraphic.UStroke;\n import net.sourceforge.plantuml.ugraphic.UTranslate;\n-import net.sourceforge.plantuml.ugraphic.color.HColor;\n-import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n \n public class PlayerBinary extends Player {\n \n@@ -76,11 +72,9 @@ public class PlayerBinary extends Player {\n \tprivate final List<TimeConstraint> constraints = new ArrayList<>();\n \tprivate final SortedMap<TimeTick, ChangeState> values = new TreeMap<>();\n \tprivate ChangeState initialState;\n-\tprivate final Style style;\n \n-\tpublic PlayerBinary(String code, ISkinParam skinParam, TimingRuler ruler, boolean compact) {\n-\t\tsuper(code, skinParam, ruler, compact);\n-\t\tthis.style = getStyleSignature().getMergedStyle(skinParam.getCurrentStyleBuilder());\n+\tpublic PlayerBinary(String code, ISkinParam skinParam, TimingRuler ruler, boolean compact, Stereotype stereotype) {\n+\t\tsuper(code, skinParam, ruler, compact, stereotype);\n \t\tthis.suggestedHeight = 30;\n \t}\n \n@@ -93,23 +87,8 @@ public double getFullHeight(StringBounder stringBounder) {\n \t}\n \n \t@Override\n-\tprotected StyleSignatureBasic getStyleSignature() {\n-\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.binary);\n-\t}\n-\n-\t@Override\n-\tprotected SymbolContext getContextLegacy() {\n-\n-\t\tif (UseStyle.useBetaStyle() == false)\n-\t\t\treturn new SymbolContext(HColorUtils.COL_D7E0F2, HColorUtils.COL_038048).withStroke(new UStroke(2));\n-\n-\t\tfinal HColor lineColor = style.value(PName.LineColor).asColor(skinParam.getThemeStyle(),\n-\t\t\t\tskinParam.getIHtmlColorSet());\n-\t\tfinal HColor backgroundColor = style.value(PName.BackGroundColor).asColor(skinParam.getThemeStyle(),\n-\t\t\t\tskinParam.getIHtmlColorSet());\n-\n-\t\treturn new SymbolContext(backgroundColor, lineColor).withStroke(getStroke());\n-\n+\tprotected StyleSignature getStyleSignature() {\n+\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.binary).withTOBECHANGED(stereotype);\n \t}\n \n \tpublic IntricatedPoint getTimeProjection(StringBounder stringBounder, TimeTick tick) {"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/PlayerClock.java",
          "status": "modified",
          "additions": 2,
          "deletions": 14,
          "patch": "@@ -34,32 +34,25 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.math.BigDecimal;\n \n-import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n-import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n-import net.sourceforge.plantuml.graphic.FontConfiguration;\n import net.sourceforge.plantuml.graphic.StringBounder;\n-import net.sourceforge.plantuml.graphic.SymbolContext;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.TextBlockUtils;\n import net.sourceforge.plantuml.graphic.UDrawable;\n import net.sourceforge.plantuml.graphic.color.Colors;\n import net.sourceforge.plantuml.style.SName;\n-import net.sourceforge.plantuml.style.Style;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.timingdiagram.graphic.IntricatedPoint;\n import net.sourceforge.plantuml.timingdiagram.graphic.PlayerFrame;\n import net.sourceforge.plantuml.ugraphic.UGraphic;\n import net.sourceforge.plantuml.ugraphic.ULine;\n-import net.sourceforge.plantuml.ugraphic.UStroke;\n import net.sourceforge.plantuml.ugraphic.UTranslate;\n-import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n \n public class PlayerClock extends Player {\n \n@@ -71,7 +64,7 @@ public class PlayerClock extends Player {\n \n \tpublic PlayerClock(String title, ISkinParam skinParam, TimingRuler ruler, int period, int pulse, int offset,\n \t\t\tboolean compact) {\n-\t\tsuper(title, skinParam, ruler, compact);\n+\t\tsuper(title, skinParam, ruler, compact, null);\n \t\tthis.displayTitle = title.length() > 0;\n \t\tthis.period = period;\n \t\tthis.pulse = pulse;\n@@ -93,11 +86,6 @@ private double getTitleHeight(StringBounder stringBounder) {\n \t\treturn 0;\n \t}\n \n-\t@Override\n-\tprotected SymbolContext getContextLegacy() {\n-\t\treturn new SymbolContext(HColorUtils.COL_D7E0F2, HColorUtils.COL_038048).withStroke(new UStroke(1.5));\n-\t}\n-\n \tprotected StyleSignatureBasic getStyleSignature() {\n \t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.clock);\n \t}"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/PlayerRobustConcise.java",
          "status": "modified",
          "additions": 9,
          "deletions": 13,
          "patch": "@@ -34,7 +34,6 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.util.ArrayList;\n import java.util.LinkedHashMap;\n import java.util.List;\n@@ -44,16 +43,18 @@\n \n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n+import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;\n import net.sourceforge.plantuml.graphic.StringBounder;\n-import net.sourceforge.plantuml.graphic.SymbolContext;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.graphic.UDrawable;\n import net.sourceforge.plantuml.graphic.color.Colors;\n import net.sourceforge.plantuml.style.SName;\n import net.sourceforge.plantuml.style.Style;\n+import net.sourceforge.plantuml.style.StyleSignature;\n import net.sourceforge.plantuml.style.StyleSignatureBasic;\n import net.sourceforge.plantuml.timingdiagram.graphic.Histogram;\n import net.sourceforge.plantuml.timingdiagram.graphic.IntricatedPoint;\n@@ -75,27 +76,22 @@ public final class PlayerRobustConcise extends Player {\n \tprivate PDrawing cached;\n \tprivate Colors initialColors;\n \n-\tpublic PlayerRobustConcise(TimingStyle type, String full, ISkinParam skinParam, TimingRuler ruler,\n-\t\t\tboolean compact) {\n-\t\tsuper(full, skinParam, ruler, compact);\n+\tpublic PlayerRobustConcise(TimingStyle type, String full, ISkinParam skinParam, TimingRuler ruler, boolean compact,\n+\t\t\tStereotype stereotype) {\n+\t\tsuper(full, skinParam, ruler, compact, stereotype);\n \t\tthis.type = type;\n \t\tthis.suggestedHeight = 0;\n \t}\n \n \t@Override\n-\tprotected StyleSignatureBasic getStyleSignature() {\n+\tprotected StyleSignature getStyleSignature() {\n \t\tif (type == TimingStyle.CONCISE)\n-\t\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.concise);\n+\t\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.concise).withTOBECHANGED(stereotype);\n \t\tif (type == TimingStyle.ROBUST)\n-\t\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.robust);\n+\t\t\treturn StyleSignatureBasic.of(SName.root, SName.element, SName.timingDiagram, SName.robust).withTOBECHANGED(stereotype);\n \t\tthrow new IllegalStateException();\n \t}\n \n-\t@Override\n-\tprotected SymbolContext getContextLegacy() {\n-\t\tthrow new UnsupportedOperationException();\n-\t}\n-\n \tprivate PDrawing buildPDrawing() {\n \t\tfinal Style style = getStyleSignature().getMergedStyle(skinParam.getCurrentStyleBuilder());\n \t\tif (type == TimingStyle.CONCISE)"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/TimeConstraint.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -34,13 +34,13 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.List;\n import java.util.Objects;\n \n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.graphic.FontConfiguration;\n import net.sourceforge.plantuml.graphic.HorizontalAlignment;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/TimingDiagram.java",
          "status": "modified",
          "additions": 8,
          "deletions": 5,
          "patch": "@@ -34,7 +34,6 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Rectangle2D;\n import java.io.IOException;\n import java.io.OutputStream;\n@@ -51,11 +50,13 @@\n import net.sourceforge.plantuml.UmlDiagramType;\n import net.sourceforge.plantuml.UseStyle;\n import net.sourceforge.plantuml.api.ThemeStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.CommandExecutionResult;\n import net.sourceforge.plantuml.core.DiagramDescription;\n import net.sourceforge.plantuml.core.ImageData;\n import net.sourceforge.plantuml.core.UmlSource;\n import net.sourceforge.plantuml.cucadiagram.Display;\n+import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.graphic.InnerStrategy;\n import net.sourceforge.plantuml.graphic.StringBounder;\n import net.sourceforge.plantuml.graphic.TextBlock;\n@@ -296,8 +297,10 @@ private UTranslate getUTranslateForPlayer(Player candidat, StringBounder stringB\n \t\tthrow new IllegalArgumentException();\n \t}\n \n-\tpublic CommandExecutionResult createRobustConcise(String code, String full, TimingStyle type, boolean compact) {\n-\t\tfinal Player player = new PlayerRobustConcise(type, full, getSkinParam(), ruler, compactByDefault || compact);\n+\tpublic CommandExecutionResult createRobustConcise(String code, String full, TimingStyle type, boolean compact,\n+\t\t\tStereotype stereotype) {\n+\t\tfinal Player player = new PlayerRobustConcise(type, full, getSkinParam(), ruler, compactByDefault || compact,\n+\t\t\t\tstereotype);\n \t\tplayers.put(code, player);\n \t\tlastPlayer = player;\n \t\treturn CommandExecutionResult.ok();\n@@ -320,8 +323,8 @@ public PlayerAnalog createAnalog(String code, String full, boolean compact) {\n \t\treturn player;\n \t}\n \n-\tpublic CommandExecutionResult createBinary(String code, String full, boolean compact) {\n-\t\tfinal Player player = new PlayerBinary(full, getSkinParam(), ruler, compactByDefault);\n+\tpublic CommandExecutionResult createBinary(String code, String full, boolean compact, Stereotype stereotype) {\n+\t\tfinal Player player = new PlayerBinary(full, getSkinParam(), ruler, compactByDefault, stereotype);\n \t\tplayers.put(code, player);\n \t\treturn CommandExecutionResult.ok();\n \t}"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/TimingRuler.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -34,7 +34,6 @@\n  */\n package net.sourceforge.plantuml.timingdiagram;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.math.BigDecimal;\n import java.util.Collection;\n import java.util.Comparator;\n@@ -46,6 +45,7 @@\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n import net.sourceforge.plantuml.api.ThemeStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.graphic.FontConfiguration;\n import net.sourceforge.plantuml.graphic.HorizontalAlignment;\n@@ -61,7 +61,6 @@\n import net.sourceforge.plantuml.ugraphic.UTranslate;\n import net.sourceforge.plantuml.ugraphic.color.HColor;\n import net.sourceforge.plantuml.ugraphic.color.HColorSet;\n-import net.sourceforge.plantuml.ugraphic.color.HColorSimple;\n import net.sourceforge.plantuml.ugraphic.color.HColorUtils;\n \n public class TimingRuler {"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/command/CommandBinary.java",
          "status": "modified",
          "additions": 16,
          "deletions": 2,
          "patch": "@@ -43,6 +43,7 @@\n import net.sourceforge.plantuml.command.regex.RegexLeaf;\n import net.sourceforge.plantuml.command.regex.RegexOptional;\n import net.sourceforge.plantuml.command.regex.RegexResult;\n+import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.timingdiagram.TimingDiagram;\n \n public class CommandBinary extends SingleLineCommand2<TimingDiagram> {\n@@ -60,18 +61,31 @@ private static IRegex getRegexConcat() {\n \t\t\t\tnew RegexLeaf(\"binary\"), //\n \t\t\t\tRegexLeaf.spaceOneOrMore(), //\n \t\t\t\tnew RegexLeaf(\"FULL\", \"[%g]([^%g]+)[%g]\"), //\n+\t\t\t\tRegexLeaf.spaceZeroOrMore(), //\n+\t\t\t\tnew RegexLeaf(\"STEREOTYPE\", \"(\\\\<\\\\<.*\\\\>\\\\>)?\"), //\n \t\t\t\tRegexLeaf.spaceOneOrMore(), //\n \t\t\t\tnew RegexLeaf(\"as\"), //\n \t\t\t\tRegexLeaf.spaceOneOrMore(), //\n-\t\t\t\tnew RegexLeaf(\"CODE\", \"([%pLN_.@]+)\"), RegexLeaf.end());\n+\t\t\t\tnew RegexLeaf(\"CODE\", \"([%pLN_.@]+)\"), //\n+\t\t\t\tRegexLeaf.spaceZeroOrMore(), //\n+\t\t\t\tnew RegexLeaf(\"STEREOTYPE2\", \"(\\\\<\\\\<.*\\\\>\\\\>)?\"), //\n+\t\t\t\tRegexLeaf.spaceZeroOrMore(), //\n+\t\t\t\tRegexLeaf.end());\n \t}\n \n \t@Override\n \tfinal protected CommandExecutionResult executeArg(TimingDiagram diagram, LineLocation location, RegexResult arg) {\n \t\tfinal String compact = arg.get(\"COMPACT\", 0);\n \t\tfinal String code = arg.get(\"CODE\", 0);\n \t\tfinal String full = arg.get(\"FULL\", 0);\n-\t\treturn diagram.createBinary(code, full, compact != null);\n+\n+\t\tStereotype stereotype = null;\n+\t\tif (arg.get(\"STEREOTYPE\", 0) != null)\n+\t\t\tstereotype = Stereotype.build(arg.get(\"STEREOTYPE\", 0));\n+\t\telse if (arg.get(\"STEREOTYPE2\", 0) != null)\n+\t\t\tstereotype = Stereotype.build(arg.get(\"STEREOTYPE2\", 0));\n+\n+\t\treturn diagram.createBinary(code, full, compact != null, stereotype);\n \t}\n \n }"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/command/CommandRobustConcise.java",
          "status": "modified",
          "additions": 15,
          "deletions": 3,
          "patch": "@@ -43,6 +43,7 @@\n import net.sourceforge.plantuml.command.regex.RegexLeaf;\n import net.sourceforge.plantuml.command.regex.RegexOptional;\n import net.sourceforge.plantuml.command.regex.RegexResult;\n+import net.sourceforge.plantuml.cucadiagram.Stereotype;\n import net.sourceforge.plantuml.timingdiagram.TimingDiagram;\n import net.sourceforge.plantuml.timingdiagram.TimingStyle;\n \n@@ -64,9 +65,14 @@ private static IRegex getRegexConcat() {\n \t\t\t\t\t\tnew RegexConcat( //\n \t\t\t\t\t\t\t\tnew RegexLeaf(\"FULL\", \"[%g]([^%g]+)[%g]\"), //\n \t\t\t\t\t\t\t\tRegexLeaf.spaceOneOrMore(), //\n+\t\t\t\t\t\t\t\tnew RegexLeaf(\"STEREOTYPE\", \"(\\\\<\\\\<.*\\\\>\\\\>)?\"), //\n+\t\t\t\t\t\t\t\tRegexLeaf.spaceZeroOrMore(), //\n \t\t\t\t\t\t\t\tnew RegexLeaf(\"as\"), //\n \t\t\t\t\t\t\t\tRegexLeaf.spaceOneOrMore())), //\n \t\t\t\tnew RegexLeaf(\"CODE\", \"([%pLN_.@]+)\"), //\n+\t\t\t\tRegexLeaf.spaceZeroOrMore(), //\n+\t\t\t\tnew RegexLeaf(\"STEREOTYPE2\", \"(\\\\<\\\\<.*\\\\>\\\\>)?\"), //\n+\t\t\t\tRegexLeaf.spaceZeroOrMore(), //\n \t\t\t\tRegexLeaf.end());\n \t}\n \n@@ -75,11 +81,17 @@ final protected CommandExecutionResult executeArg(TimingDiagram diagram, LineLoc\n \t\tfinal String compact = arg.get(\"COMPACT\", 0);\n \t\tfinal String code = arg.get(\"CODE\", 0);\n \t\tString full = arg.get(\"FULL\", 0);\n-\t\tif (full == null) {\n+\t\tif (full == null)\n \t\t\tfull = code;\n-\t\t}\n+\n+\t\tStereotype stereotype = null;\n+\t\tif (arg.get(\"STEREOTYPE\", 0) != null)\n+\t\t\tstereotype = Stereotype.build(arg.get(\"STEREOTYPE\", 0));\n+\t\telse if (arg.get(\"STEREOTYPE2\", 0) != null)\n+\t\t\tstereotype = Stereotype.build(arg.get(\"STEREOTYPE2\", 0));\n+\n \t\tfinal TimingStyle type = TimingStyle.valueOf(arg.get(\"TYPE\", 0).toUpperCase());\n-\t\treturn diagram.createRobustConcise(code, full, type, compact != null);\n+\t\treturn diagram.createRobustConcise(code, full, type, compact != null, stereotype);\n \t}\n \n }"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/graphic/PlayerFrame.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -34,10 +34,9 @@\n  */\n package net.sourceforge.plantuml.timingdiagram.graphic;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n-\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.graphic.TextBlock;\n import net.sourceforge.plantuml.style.PName;\n import net.sourceforge.plantuml.style.SName;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/graphic/Ribbon.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -34,7 +34,6 @@\n  */\n package net.sourceforge.plantuml.timingdiagram.graphic;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n import java.util.ArrayList;\n import java.util.List;\n@@ -43,6 +42,7 @@\n import net.sourceforge.plantuml.FontParam;\n import net.sourceforge.plantuml.ISkinParam;\n import net.sourceforge.plantuml.UseStyle;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.command.Position;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.graphic.AbstractTextBlock;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/timingdiagram/graphic/TimeArrow.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -34,10 +34,10 @@\n  */\n package net.sourceforge.plantuml.timingdiagram.graphic;\n \n-import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import java.awt.geom.Point2D;\n \n import net.sourceforge.plantuml.ISkinSimple;\n+import net.sourceforge.plantuml.awt.geom.Dimension2D;\n import net.sourceforge.plantuml.cucadiagram.Display;\n import net.sourceforge.plantuml.cucadiagram.WithLinkType;\n import net.sourceforge.plantuml.graphic.FontConfiguration;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/ugraphic/UImageSvg.java",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -55,6 +55,10 @@ public String getMD5Hex() {\n \t\treturn SignatureUtils.getMD5Hex(svg);\n \t}\n \n+\tpublic boolean containsXlink() {\n+\t\treturn svg.contains(\"xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\"\");\n+\t}\n+\n \tpublic String getSvg(boolean raw) {\n \t\tString result = svg;\n \t\tif (raw)"
        },
        {
          "filename": "src/net/sourceforge/plantuml/ugraphic/color/HColorUtils.java",
          "status": "modified",
          "additions": 16,
          "deletions": 16,
          "patch": "@@ -119,17 +119,17 @@ public class HColorUtils {\n \t}\n \n \tpublic static HColor noGradient(HColor color) {\n-\t\tif (color instanceof HColorGradient) {\n+\t\tif (color instanceof HColorGradient)\n \t\t\treturn ((HColorGradient) color).getColor1();\n-\t\t}\n+\n \t\treturn color;\n \t}\n \n \tpublic static UChange changeBack(UGraphic ug) {\n \t\tfinal HColor color = ug.getParam().getColor();\n-\t\tif (color == null) {\n+\t\tif (color == null)\n \t\t\treturn new HColorNone().bg();\n-\t\t}\n+\n \t\treturn color.bg();\n \t}\n \n@@ -140,28 +140,28 @@ public static HColor transparent() {\n \t}\n \n \tpublic static boolean isTransparent(HColor back) {\n-\t\tif (back == TRANSPARENT) {\n+\t\tif (back == TRANSPARENT)\n \t\t\treturn true;\n-\t\t}\n-\t\tif (back instanceof HColorBackground && ((HColorBackground) back).getBack() == TRANSPARENT) {\n+\n+\t\tif (back instanceof HColorBackground && ((HColorBackground) back).getBack() == TRANSPARENT)\n \t\t\treturn true;\n-\t\t}\n-\t\tif (back instanceof HColorSimple && ((HColorSimple) back).isTransparent()) {\n+\n+\t\tif (back instanceof HColorSimple && ((HColorSimple) back).isTransparent())\n \t\t\treturn true;\n-\t\t}\n+\n \t\treturn false;\n \t}\n \n \tpublic static HColor unlinear(HColor color1, HColor color2, int completion) {\n-\t\tif (completion == 0) {\n+\t\tif (completion == 0)\n \t\t\treturn color1;\n-\t\t}\n-\t\tif (completion == 100) {\n+\n+\t\tif (completion == 100)\n \t\t\treturn color2;\n-\t\t}\n-\t\tif (color1 instanceof HColorSimple && color2 instanceof HColorSimple) {\n+\n+\t\tif (color1 instanceof HColorSimple && color2 instanceof HColorSimple)\n \t\t\treturn HColorSimple.unlinear((HColorSimple) color1, (HColorSimple) color2, completion);\n-\t\t}\n+\n \t\treturn color1;\n \t}\n "
        },
        {
          "filename": "src/net/sourceforge/plantuml/ugraphic/hand/UPathHand.java",
          "status": "modified",
          "additions": 8,
          "deletions": 4,
          "patch": "@@ -75,11 +75,15 @@ public UPathHand(UPath source, Random rnd) {\n \t\t\t\tfinal double y = segment.getCoord()[1];\n \t\t\t\tfinal HandJiggle jiggle = new HandJiggle(last.getX(), last.getY(), defaultVariation, rnd);\n \t\t\t\tjiggle.lineTo(x, y);\n-\t\t\t\tfor (USegment seg2 : jiggle.toUPath()) {\n-\t\t\t\t\tif (seg2.getSegmentType() == USegmentType.SEG_LINETO) {\n+\t\t\t\tfor (USegment seg2 : jiggle.toUPath())\n+\t\t\t\t\tif (seg2.getSegmentType() == USegmentType.SEG_LINETO)\n \t\t\t\t\t\tresult.lineTo(seg2.getCoord()[0], seg2.getCoord()[1]);\n-\t\t\t\t\t}\n-\t\t\t\t}\n+\n+\t\t\t\tlast = new Point2D.Double(x, y);\n+\t\t\t} else if (type == USegmentType.SEG_ARCTO) {\n+\t\t\t\tfinal double x = segment.getCoord()[5];\n+\t\t\t\tfinal double y = segment.getCoord()[6];\n+\t\t\t\tresult.lineTo(x, y);\n \t\t\t\tlast = new Point2D.Double(x, y);\n \t\t\t} else {\n \t\t\t\tthis.path = source;"
        },
        {
          "filename": "src/net/sourceforge/plantuml/version/Version.java",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -44,7 +44,7 @@ public class Version {\n \tprivate static final int MAJOR_SEPARATOR = 1000000;\n \n \tpublic static int version() {\n-\t\treturn 1202204;\n+\t\treturn 1202205;\n \t}\n \n \tpublic static int versionPatched() {\n@@ -80,7 +80,7 @@ public static String versionString(int size) {\n \t}\n \n \tpublic static int beta() {\n-\t\tfinal int beta = 1;\n+\t\tfinal int beta = 0;\n \t\treturn beta;\n \t}\n \n@@ -93,7 +93,7 @@ public static String turningId() {\n \t}\n \n \tpublic static long compileTime() {\n-\t\treturn 1649510957985L;\n+\t\treturn 1651316152000L;\n \t}\n \n \tpublic static String compileTimeString() {"
        },
        {
          "filename": "stdlib/classy-abx.repx",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "stdlib/classy-c4-abx.repx",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "stdlib/classy-c4-dex.repx",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+;\n\\ No newline at end of file"
        },
        {
          "filename": "stdlib/classy-dex.repx",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+;\n\\ No newline at end of file"
        },
        {
          "filename": "stdlib/domainstory-abx.repx",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "stdlib/domainstory-dex.repx",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+;\n\\ No newline at end of file"
        },
        {
          "filename": "stdlib/home.repx",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -1,14 +1,17 @@\n-azure\n+archimate\n aws\n awslib\n+azure\n+c4\n+classy\n+classy-c4\n cloudinsight\n cloudogu\n-tupadr3\n+domainstory\n+elastic\n+kubernetes\n+logos\n material\n office\n-c4\n osa\n-kubernetes\n-logos\n-elastic\n-archimate\n\\ No newline at end of file\n+tupadr3"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 17,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ef3fbc0918f4fcc56a9813fccafaec31d05a4344",
            "date": "2025-01-14T11:53:18Z",
            "author_login": "arnaudroques"
          },
          {
            "sha": "9eaa2bbbf56f440492695d96379834e36a685dc0",
            "date": "2025-01-14T10:16:02Z",
            "author_login": "shunlibest"
          },
          {
            "sha": "d745338f51feb8e3e63fd7fad65810f69993a2f2",
            "date": "2025-01-13T16:06:32Z",
            "author_login": "arnaudroques"
          },
          {
            "sha": "15a63cdf59959fa0af97a072c757a97e2cc34612",
            "date": "2025-01-11T18:11:51Z",
            "author_login": "JanRoma"
          },
          {
            "sha": "523c24e72e5ba6b06c41f365083ed0c136d1ee6b",
            "date": "2025-01-11T15:55:45Z",
            "author_login": "arnaudroques"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-918",
    "description": "URL Restriction Bypass in GitHub repository plantuml/plantuml prior to V1.2022.5. An attacker can abuse this to bypass URL restrictions that are imposed by the different security profiles and achieve server side request forgery (SSRF). This allows accessing restricted internal resources/servers or sending requests to third party servers.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-14T10:15:07.927",
    "last_modified": "2024-11-21T06:40:36.590",
    "fix_date": "2022-05-04T17:52:00Z"
  },
  "references": [
    {
      "url": "https://github.com/plantuml/plantuml/commit/93e5964e5f35914f3f7b89de620c596795550083",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/0d737527-86e1-41d1-9d37-b2de36bc063a",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CHUE4G5CAJUD7L2QPJF6U4JYQTP7CNNL/",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J4DP36G2VBOZUNQIUZ5LVJKZIVO4SDAI/",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/plantuml/plantuml/commit/93e5964e5f35914f3f7b89de620c596795550083",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/0d737527-86e1-41d1-9d37-b2de36bc063a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/CHUE4G5CAJUD7L2QPJF6U4JYQTP7CNNL/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J4DP36G2VBOZUNQIUZ5LVJKZIVO4SDAI/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.119289",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "plantuml",
    "owner": "plantuml",
    "created_at": "2010-11-04T15:55:50Z",
    "updated_at": "2025-01-14T11:53:23Z",
    "pushed_at": "2025-01-14T11:53:19Z",
    "size": 276546,
    "stars": 10849,
    "forks": 988,
    "open_issues": 484,
    "watchers": 10849,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 14021875,
      "JavaScript": 8186,
      "HTML": 7397,
      "Shell": 5652,
      "Dockerfile": 1752,
      "CSS": 205
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:17:59.565359"
  }
}