{
  "cve_id": "CVE-2022-1453",
  "github_data": {
    "repository": "davidfcarr/rsvpmaker",
    "fix_commit": "bfb189f49af7ab0d34499a2da772e3266f72167d",
    "related_commits": [
      "bfb189f49af7ab0d34499a2da772e3266f72167d",
      "bfb189f49af7ab0d34499a2da772e3266f72167d"
    ],
    "patch_url": "https://github.com/davidfcarr/rsvpmaker/commit/bfb189f49af7ab0d34499a2da772e3266f72167d.patch",
    "fix_commit_details": {
      "sha": "bfb189f49af7ab0d34499a2da772e3266f72167d",
      "commit_date": "2022-04-25T13:11:49Z",
      "author": {
        "login": "davidfcarr",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixes for sql injection, card testing",
        "length": 37,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 77,
        "additions": 57,
        "deletions": 20
      },
      "files": [
        {
          "filename": "README.txt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,8 +7,8 @@ License: GPLv2\n License URI: http://www.gnu.org/licenses/gpl-2.0.html\n Requires PHP: 5.6\n Requires at least: 5.0\n-Tested up to: 5.9.2\n-Stable tag: 9.2.5\n+Tested up to: 5.9.3\n+Stable tag: 9.2.6\n \n Schedule events, send invitations, track RSVPs, and collect payment via PayPal or Stripe.\n "
        },
        {
          "filename": "rsvpmaker-admin.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -1027,6 +1027,10 @@ function handle_options()\n </select>    \n </div>\n \n+<h3><?php esc_html_e('Minimum Amount','rsvpmaker'); ?>:</h3>\n+<div><input type=\"text\" name=\"payment_option[payment_minimum]\" value=\"<?php if(isset($options[\"payment_minimum\"])) {echo esc_attr($options[\"payment_minimum\"]);} else echo '5.00';?>\" size=\"5\" /> <br /><em><?php _e('Prevents fraudulent uses such as $1 donations to test stolen cards','rsvpmaker'); ?></em>\n+</div>\n+\n <h3>PayPal (REST API)</h3>\n <p><?php esc_html_e('Keys may be obtained from','rsvpmaker'); ?> <a target=\"_blank\" href=\"https://developer.paypal.com/developer/applications\">developer.paypal.com/developer/applications/</a></p>\n <?php\n@@ -5121,6 +5125,9 @@ function rsvpmaker_submission ($atts) {\n \t{ title: 'Italic', format: 'italic' },\n ]},]},\n toolbar: 'bold italic link',\n+relative_urls: false,\n+remove_script_host : false,\n+document_base_url : \"'.site_url().'/\",\n });\t\n </script>\n <?php"
        },
        {
          "filename": "rsvpmaker-api-endpoints.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -385,7 +385,7 @@ public function get_items_permissions_check( $request ) {\n \n \tpublic function get_items( $request ) {\n \n-\t\t$sked = get_template_sked( $request['post_id'] );\n+\t\t$sked = get_template_sked( intval($request['post_id']) );\n \n \t\treturn new WP_REST_Response( $sked, 200 );\n "
        },
        {
          "filename": "rsvpmaker-email.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2790,7 +2790,7 @@ function rsvp_notifications_via_template ($rsvp,$rsvp_to,$rsvpdata) {\n $send_confirmation = get_post_meta($post->ID,'_rsvp_rsvpmaker_send_confirmation_email',true);\n $confirm_on_payment = get_post_meta($post->ID,'_rsvp_confirmation_after_payment',true);\n \n-if(($send_confirmation ||!is_numeric($send_confirmation)) && empty($confirm_on_payment) )//if it hasn't been set to 0, send it\n+if(($send_confirmation ||!is_numeric($send_confirmation)) && $rsvpdata['yesno'] && empty($confirm_on_payment) )//if it hasn't been set to 0, send it\n {\n $confirmation_subject = $templates['confirmation']['subject']; \n foreach($rsvpdata as $field => $value)"
        },
        {
          "filename": "rsvpmaker-group-email.php",
          "status": "modified",
          "additions": 30,
          "deletions": 8,
          "patch": "@@ -46,13 +46,14 @@ function rsvpmaker_relay_menu_pages() {\n \t\t'rsvpmaker_relay_manual_test',\n \t\t'rsvpmaker_relay_manual_test'\n \t);\n+\n \tadd_submenu_page(\n \t\t$parent_slug,\n \t\t__( 'Group Email Log', 'rsvpmaker' ),\n \t\t__( 'Group Email Log', 'rsvpmaker' ),\n \t\t'manage_options',\n-\t\t'rsvpmaker_relay_log',\n-\t\t'rsvpmaker_relay_log'\n+\t\t'rsvpmaker_relay_queue_monitor',\n+\t\t'rsvpmaker_relay_queue_monitor'\n \t);\n \n }\n@@ -935,11 +936,32 @@ function rsvpmaker_qemail ($mail, $recipients) {\n \t\trestore_current_blog();\n }\n \n-function rsvpmaker_relay_log() {\n+function rsvpmaker_relay_queue_monitor () {\n+\tdo_action('rsvpmaker_relay_queue_monitor');\n \tglobal $wpdb;\n-\t$sql = \"SELECT * from $wpdb->posts JOIN $wpdb->postmeta ON $wpdb->posts.ID = $wpdb->postmeta.post_id WHERE post_type='rsvpemail' AND meta_key LIKE 'rsvp%' ORDER BY ID DESC, meta_key LIMIT 0,500\";\n+\t$sql = \"SELECT ID, post_title, wpt_postmeta.meta_key, wpt_postmeta.meta_value FROM `wpt_posts` JOIN wpt_postmeta on wpt_posts.ID = wpt_postmeta.post_id WHERE post_type='rsvpemail' AND (post_status='draft' OR post_status='publish') AND meta_key='rsvprelay_to' ORDER BY ID DESC\";\n \t$results = $wpdb->get_results($sql);\n-\tforeach($results as $row) {\n-\t\tprintf('<p>%s<br><strong>%s</strong> %s</p>',$row->post_title,$row->meta_key,$row->meta_value);\n-\t}\t\n-}\n+\t$was = 0;\n+\techo '<h1>In Queue</h2>';\n+\tif(empty($results))\n+\t\techo '<p>none</p>';\n+\telse\n+\tforeach($results as $row)\n+\t{\n+\t\tif($row->ID != $was)\n+\t\t\tprintf('<h2>%s</h2>',$row->post_title);\n+\t\tprintf('<p>%s %s</p>',$row->meta_key, $row->meta_value);\n+\t\t$was = $row->ID;\n+\t}\n+\techo '<h1>Sent (200 Latest)</h2>';\n+\t$sql = \"SELECT ID, post_title, wpt_postmeta.meta_key, wpt_postmeta.meta_value FROM `wpt_posts` JOIN wpt_postmeta on wpt_posts.ID = wpt_postmeta.post_id WHERE post_type='rsvpemail' AND meta_key='rsvpmail_sent' ORDER BY ID DESC LIMIT 0, 200\";\n+\t$results = $wpdb->get_results($sql);\n+\t$was = 0;\n+\tforeach($results as $row)\n+\t{\n+\t\tif($row->ID != $was)\n+\t\t\tprintf('<h2>%s</h2>',$row->post_title);\n+\t\tprintf('<p>%s %s</p>',$row->meta_key, $row->meta_value);\n+\t\t$was = $row->ID;\n+\t}\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "rsvpmaker-plugabble.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2573,13 +2573,13 @@ function save_rsvp() {\n \t\t\t\t// $rsvpdata[\"rsvptitle\"] = $post->post_title;\n \n \t\t\t\t$rsvpdata['rsvpyesno'] = $answer;\n-\n+\t\t\t\t$rsvpdata['yesno'] = $yesno;\n \t\t\t\t$rsvpdata['rsvpdate'] = $date;\n \n \t\t\t\t$rsvp_options['rsvplink'] = get_rsvp_link( $post->ID );\n \n \t\t\t\t$rsvpdata['rsvpupdate'] = preg_replace( '/#rsvpnow\">[^<]+/', '#rsvpnow\">' . $rsvp_options['update_rsvp'], str_replace( '*|EMAIL|*', $rsvp['email'] . '&update=' . $rsvp_id, $rsvp_options['rsvplink'] ) );\n-\n+\t\t\t\t\n \t\t\t\trsvp_notifications_via_template( $rsvp, $rsvp_to, $rsvpdata );\n \n \t\t\t\t// rsvp_notifications ($rsvp,$rsvp_to,$subject,$cleanmessage,$rsvp_confirm);"
        },
        {
          "filename": "rsvpmaker-stripe.php",
          "status": "modified",
          "additions": 10,
          "deletions": 4,
          "patch": "@@ -43,7 +43,7 @@ function rsvpmaker_stripecharge( $atts ) {\n \t\treturn;\n \t}\n \n-\tglobal $current_user;\n+\tglobal $current_user, $rsvp_options;\n \n \t$vars['description'] = ( ! empty( $atts['description'] ) ) ? $atts['description'] : __( 'charge from', 'rsvpmaker' ) . ' ' . get_bloginfo( 'name' );\n \n@@ -101,6 +101,7 @@ function rsvpmaker_stripecharge( $atts ) {\n $rsvpmaker_stripe_form = '';\n \n function rsvpmaker_stripe_form( $vars, $show = false ) {\n+\tglobal $rsvp_options;\n \n \trsvpmaker_debug_log( $vars, 'rsvpmaker_stripe_form' );\n \n@@ -175,7 +176,7 @@ function rsvpmaker_stripe_form( $vars, $show = false ) {\n \telseif ( isset( $vars['paymentType'] ) && ( $vars['paymentType'] == 'donation' ) ) {\n \t\tif(isset($_GET['amount']))\n \t\t\t$vars['amount'] = sanitize_text_field($_GET['amount']); //needed when both Stripe and PayPal are active\n-\t\t$output = sprintf( '<form action=\"%s\" method=\"get\">%s (%s): <input type=\"text\" name=\"amount\" value=\"%s\"><br />%s<br /><textarea name=\"stripenote\" cols=\"80\" rows=\"2\"></textarea><br /><input type=\"hidden\" name=\"txid\" value=\"%s\"><button class=\"stripebutton\">%s</button>%s</form>', $url, __( 'Amount', 'rsvpmaker' ), esc_attr( strtoupper( $vars['currency'] ) ), esc_attr( $vars['amount'] ), __('Note','rsvpmaker'), esc_attr( $idempotency_key ), __( 'Pay with Card' ), rsvpmaker_nonce('return') );\n+\t\t$output = sprintf( '<form action=\"%s\" method=\"get\">%s (%s, %s %s): <input type=\"text\" name=\"amount\" value=\"%s\"><br />%s<br /><textarea name=\"stripenote\" cols=\"80\" rows=\"2\"></textarea><br /><input type=\"hidden\" name=\"txid\" value=\"%s\"><button class=\"stripebutton\">%s</button>%s</form>', $url, __( 'Amount', 'rsvpmaker' ), esc_attr( strtoupper( $vars['currency'] ) ), __('minimum','rsvpmaker'), $rsvp_options['payment_minimum'], esc_attr( $vars['amount'] ), __('Note','rsvpmaker'), esc_attr( $idempotency_key ), __( 'Pay with Card' ), rsvpmaker_nonce('return') );\n \t} else {\n \t\t$output = sprintf( '<form action=\"%s\" method=\"get\"><input type=\"hidden\" name=\"txid\" value=\"%s\"><button class=\"stripebutton\">%s</button>%s</form>', $url, esc_attr( $idempotency_key ), __( 'Pay with Card' ), rsvpmaker_nonce('return') );\n \t}\n@@ -248,6 +249,8 @@ function rsvpmaker_stripe_checkout() {\n \n \tglobal $post, $rsvp_options, $current_user;\n \n+\t$keys = get_rsvpmaker_stripe_keys();\n+\n \tif ( empty( $_GET['txid'] ) ) {\n \n \t\treturn;\n@@ -275,15 +278,18 @@ function rsvpmaker_stripe_checkout() {\n \n \t}\n \n+\tif($vars['amount'] < $rsvp_options['payment_minimum']) {\n+\t\tdo_action('rsvpmaker_possible_card_testing',$vars);\n+\t\treturn '<p>Transactions of less than '.$rsvp_options['payment_minimum'].' not accepted.</p>';\n+\t}\n+\n \tif(!empty($_GET['stripenote']))\n \t\t$vars['note'] = sanitize_text_field($_GET['stripenote']);\n \n \tupdate_option( $idempotency_key, $vars );\n \t\n \trequire_once 'stripe-php/init.php';\n \n-\t$keys = get_rsvpmaker_stripe_keys();\n-\n \tif ( ! empty( $vars['email'] ) ) {\n \n \t\t$email = sanitize_email( $vars['email'] );"
        },
        {
          "filename": "rsvpmaker.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -7,11 +7,11 @@\n Author URI: http://www.carrcommunications.com\n Text Domain: rsvpmaker\n Domain Path: /translations\n-Version: 9.2.5\n+Version: 9.2.6\n */\n \n function get_rsvpversion() {\n-\treturn '9.2.5';\n+\treturn '9.2.6';\n }\n global $wp_version;\n global $default_tz;\n@@ -111,6 +111,8 @@ function rsvp_options_defaults() {\n \n \t\t'currency_thousands'                => ',',\n \n+\t\t'payment_minimum'                   => '5.00',\n+\n \t\t'paypal_invoiceno'                  => 1,\n \n \t\t'stripe'                            => 0,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5582645abaaa1855ce7ff5646b88ded647cedc69",
            "date": "2024-10-13T20:00:49Z",
            "author_login": "davidfcarr"
          },
          {
            "sha": "26496aab3888250e49649480565a3859b0c49aaf",
            "date": "2024-10-12T19:44:50Z",
            "author_login": "davidfcarr"
          },
          {
            "sha": "01c005636a48b1d30143cf00925614c6e9a05a8a",
            "date": "2024-10-01T17:14:36Z",
            "author_login": "davidfcarr"
          },
          {
            "sha": "9fdf246407229ecbeeebbc5d33987cd2bb74edf9",
            "date": "2024-09-29T18:20:44Z",
            "author_login": "davidfcarr"
          },
          {
            "sha": "87a1b785a6d5f0c19c232b288f309b5906dbad0a",
            "date": "2024-09-27T14:15:53Z",
            "author_login": "davidfcarr"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "The RSVPMaker plugin for WordPress is vulnerable to unauthenticated SQL Injection due to missing SQL escaping and parameterization on user supplied data passed to a SQL query in the rsvpmaker-util.php file. This makes it possible for unauthenticated attackers to steal sensitive information from the database in versions up to and including 9.2.5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-10T20:15:08.533",
    "last_modified": "2024-11-21T06:40:45.293",
    "fix_date": "2022-04-25T13:11:49Z"
  },
  "references": [
    {
      "url": "https://github.com/davidfcarr/rsvpmaker/commit/bfb189f49af7ab0d34499a2da772e3266f72167d",
      "source": "security@wordfence.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2714389%40rsvpmaker&new=2714389%40rsvpmaker&sfp_email=&sfph_mail=",
      "source": "security@wordfence.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/6031edec-4274-4e42-9e3a-ce0c94958b17?source=cve",
      "source": "security@wordfence.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/vulnerability-advisories/#CVE-2022-1453",
      "source": "security@wordfence.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/davidfcarr/rsvpmaker/commit/bfb189f49af7ab0d34499a2da772e3266f72167d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2714389%40rsvpmaker&new=2714389%40rsvpmaker&sfp_email=&sfph_mail=",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/6031edec-4274-4e42-9e3a-ce0c94958b17?source=cve",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/vulnerability-advisories/#CVE-2022-1453",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.099776",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rsvpmaker",
    "owner": "davidfcarr",
    "created_at": "2017-05-20T22:58:02Z",
    "updated_at": "2024-10-13T20:00:56Z",
    "pushed_at": "2024-10-13T20:00:53Z",
    "size": 12160,
    "stars": 13,
    "forks": 6,
    "open_issues": 19,
    "watchers": 13,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 2530284,
      "JavaScript": 454416,
      "SCSS": 82500,
      "CSS": 3785,
      "Makefile": 589,
      "Shell": 212,
      "HTML": 118
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:36:45.887264"
  }
}