{
  "cve_id": "CVE-2022-1848",
  "github_data": {
    "repository": "erudika/para",
    "fix_commit": "fa677c629842df60099daa9c23bd802bc41b48d1",
    "related_commits": [
      "fa677c629842df60099daa9c23bd802bc41b48d1",
      "fa677c629842df60099daa9c23bd802bc41b48d1"
    ],
    "patch_url": "https://github.com/erudika/para/commit/fa677c629842df60099daa9c23bd802bc41b48d1.patch",
    "fix_commit_details": {
      "sha": "fa677c629842df60099daa9c23bd802bc41b48d1",
      "commit_date": "2022-05-23T14:51:21Z",
      "author": {
        "login": "albogdano",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixed password length issues",
        "length": 28,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 72,
        "additions": 68,
        "deletions": 4
      },
      "files": [
        {
          "filename": "para-core/src/main/java/com/erudika/para/core/User.java",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -32,7 +32,6 @@\n import java.util.HashMap;\n import java.util.List;\n import java.util.Objects;\n-import javax.validation.constraints.Max;\n import javax.validation.constraints.NotBlank;\n import org.apache.commons.lang3.StringUtils;\n import org.slf4j.Logger;\n@@ -80,7 +79,7 @@ public class User implements ParaObject {\n \t@Stored private String idpAccessToken;\n \t@Stored private String idpRefreshToken;\n \n-\tprivate transient @Max(MAX_PASSWORD_LENGTH) String password;\n+\tprivate transient String password;\n \n \t/**\n \t * No-args constructor."
        },
        {
          "filename": "para-core/src/main/java/com/erudika/para/core/validation/ValidationUtils.java",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -60,6 +60,7 @@\n import javax.validation.constraints.Pattern;\n import javax.validation.constraints.Size;\n import org.apache.commons.beanutils.PropertyUtils;\n+import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.lang3.math.NumberUtils;\n import org.hibernate.validator.constraints.URL;\n import org.slf4j.Logger;\n@@ -125,6 +126,9 @@ public static String[] validateObject(ParaObject content) {\n \t\t\t\tString prop = \"'\".concat(constraintViolation.getPropertyPath().toString()).concat(\"'\");\n \t\t\t\tlist.add(prop.concat(\" \").concat(constraintViolation.getMessage()));\n \t\t\t}\n+\t\t\tif (content instanceof User && StringUtils.length(((User) content).getPassword()) > User.MAX_PASSWORD_LENGTH) {\n+\t\t\t\tlist.add(Utils.formatMessage(\"{0} must not be longer than {1}.\", Config._PASSWORD, User.MAX_PASSWORD_LENGTH));\n+\t\t\t}\n \t\t} catch (Exception e) {\n \t\t\tlogger.error(null, e);\n \t\t}"
        },
        {
          "filename": "para-server/src/test/java/com/erudika/para/core/utils/ValidationUtilsTest.java",
          "status": "modified",
          "additions": 63,
          "deletions": 2,
          "patch": "@@ -17,13 +17,12 @@\n  */\n package com.erudika.para.core.utils;\n \n-import com.erudika.para.core.utils.Config;\n import com.erudika.para.core.App;\n import com.erudika.para.core.Sysprop;\n import com.erudika.para.core.Tag;\n import com.erudika.para.core.User;\n-import static com.erudika.para.core.validation.ValidationUtils.*;\n import static com.erudika.para.core.validation.Constraint.*;\n+import static com.erudika.para.core.validation.ValidationUtils.*;\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.Collections;\n@@ -228,6 +227,68 @@ public void testValidateObject() {\n \t\tassertTrue(validateObject(app, s1).length == 0);\n \t}\n \n+\t@Test\n+\tpublic void testPasswordConstraint() {\n+\t\tUser u = new User();\n+\t\tu.setName(\"test\");\n+\t\tu.setEmail(\"ab@cd.com\");\n+\t\tu.setIdentifier(\"ab@cd.com\");\n+\t\tassertTrue(validateObject(u).length == 0);\n+\t\tu.setPassword(\"T123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"78912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345670\"\n+\t\t\t\t+ \"89123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789\"\n+\t\t\t\t+ \"12345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912\"\n+\t\t\t\t+ \"34567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234\"\n+\t\t\t\t+ \"56789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"78912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678\"\n+\t\t\t\t+ \"91234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891\"\n+\t\t\t\t+ \"23456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123\"\n+\t\t\t\t+ \"45678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345\"\n+\t\t\t\t+ \"67891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567\"\n+\t\t\t\t+ \"89123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789\"\n+\t\t\t\t+ \"12345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912\"\n+\t\t\t\t+ \"34567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234\"\n+\t\t\t\t+ \"56789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"78912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678\"\n+\t\t\t\t+ \"91234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891\"\n+\t\t\t\t+ \"23456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123\"\n+\t\t\t\t+ \"45678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345\"\n+\t\t\t\t+ \"67891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567\"\n+\t\t\t\t+ \"89123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789\"\n+\t\t\t\t+ \"12345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912\"\n+\t\t\t\t+ \"34567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234\"\n+\t\t\t\t+ \"56789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"78912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678\"\n+\t\t\t\t+ \"91234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891\"\n+\t\t\t\t+ \"23456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123\"\n+\t\t\t\t+ \"45678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345\"\n+\t\t\t\t+ \"67891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567\"\n+\t\t\t\t+ \"89123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789\"\n+\t\t\t\t+ \"12345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912\"\n+\t\t\t\t+ \"34567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234\"\n+\t\t\t\t+ \"56789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"78912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678\"\n+\t\t\t\t+ \"91234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891\"\n+\t\t\t\t+ \"23456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123\"\n+\t\t\t\t+ \"45678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345\"\n+\t\t\t\t+ \"67891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567\"\n+\t\t\t\t+ \"89123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789\"\n+\t\t\t\t+ \"12345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912\"\n+\t\t\t\t+ \"34567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234\"\n+\t\t\t\t+ \"56789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"78912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678\"\n+\t\t\t\t+ \"91234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891\"\n+\t\t\t\t+ \"23456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123\"\n+\t\t\t\t+ \"45678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345\"\n+\t\t\t\t+ \"67891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567\"\n+\t\t\t\t+ \"89123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789\"\n+\t\t\t\t+ \"12345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912345678912\"\n+\t\t\t\t+ \"34567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234567891234\"\n+\t\t\t\t+ \"56789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456\"\n+\t\t\t\t+ \"789hellohellohellohello\");\n+\t\tassertFalse(validateObject(u).length == 0);\n+\t}\n+\n \t@Test\n \tpublic void testGetCoreValidationConstraints() {\n \t\tassertTrue(getCoreValidationConstraints().containsKey(\"app\"));"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2c91e9c941e631d8e08dfedc65bda8a3439701a2",
            "date": "2025-01-14T12:54:33Z",
            "author_login": "albogdano"
          },
          {
            "sha": "58a1b21eb9b4ef7d22682fa82ffae0cc77066e9c",
            "date": "2025-01-08T12:23:47Z",
            "author_login": "albogdano"
          },
          {
            "sha": "73a3fd640b8b4778c80733b45e419831757289a2",
            "date": "2024-11-27T12:03:35Z",
            "author_login": "albogdano"
          },
          {
            "sha": "4ecd4350dcac0980cec2d128a71b169e6834ab6f",
            "date": "2024-11-27T11:48:08Z",
            "author_login": "albogdano"
          },
          {
            "sha": "d913f6a4de426445b0bf7cf9b2be27221abb83c9",
            "date": "2024-11-27T11:41:52Z",
            "author_login": "albogdano"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-840",
    "description": "Business Logic Errors in GitHub repository erudika/para prior to 1.45.11.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-05-24T13:15:07.683",
    "last_modified": "2024-11-21T06:41:36.150",
    "fix_date": "2022-05-23T14:51:21Z"
  },
  "references": [
    {
      "url": "https://github.com/erudika/para/commit/fa677c629842df60099daa9c23bd802bc41b48d1",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/8dfe0877-e44b-4a1a-8eee-5c03c93ae90a",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/erudika/para/commit/fa677c629842df60099daa9c23bd802bc41b48d1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/8dfe0877-e44b-4a1a-8eee-5c03c93ae90a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.154035",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "para",
    "owner": "erudika",
    "created_at": "2014-03-09T22:31:26Z",
    "updated_at": "2025-01-14T12:54:39Z",
    "pushed_at": "2025-01-14T12:54:36Z",
    "size": 5990,
    "stars": 536,
    "forks": 145,
    "open_issues": 9,
    "watchers": 536,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 1520036,
      "Shell": 5562,
      "Dockerfile": 702
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T20:07:59.089520"
  }
}