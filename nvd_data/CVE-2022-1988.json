{
  "cve_id": "CVE-2022-1988",
  "github_data": {
    "repository": "neorazorx/facturascripts",
    "fix_commit": "93fc65ced3847a8e0837561e9fdfa0dbace2cfcb",
    "related_commits": [
      "93fc65ced3847a8e0837561e9fdfa0dbace2cfcb",
      "93fc65ced3847a8e0837561e9fdfa0dbace2cfcb"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "93fc65ced3847a8e0837561e9fdfa0dbace2cfcb",
      "commit_date": "2022-05-31T10:53:15Z",
      "author": {
        "login": "NeoRazorX",
        "type": "User",
        "stats": {
          "total_commits": 6095,
          "average_weekly_commits": 13.25,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 369
        }
      },
      "commit_message": {
        "title": "- A\u00f1adida comprobaci\u00f3n de html en descripci\u00f3n al test unitario del modelo cuenta.",
        "length": 173,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 58,
        "additions": 18,
        "deletions": 40
      },
      "files": [
        {
          "filename": "Core/Model/Cuenta.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -185,12 +185,13 @@ public static function tableName(): string\n     public function test(): bool\n     {\n         $this->codcuenta = trim($this->codcuenta);\n+        $this->descripcion = $this->toolBox()->utils()->noHtml($this->descripcion);\n+\n         if (empty($this->codcuenta) || false === is_numeric($this->codcuenta)) {\n             $this->toolBox()->i18nLog()->warning('invalid-number', ['%number%' => $this->codcuenta]);\n             return false;\n         }\n \n-        $this->descripcion = $this->toolBox()->utils()->noHtml($this->descripcion);\n         if (strlen($this->descripcion) < 1 || strlen($this->descripcion) > 255) {\n             $this->toolBox()->i18nLog()->warning('invalid-column-lenght', ['%column%' => 'descripcion', '%min%' => '1', '%max%' => '255']);\n             return false;"
        },
        {
          "filename": "Core/Translation/gl_ES.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -421,7 +421,7 @@\n     \"emails-sent\": \"Emails enviados\",\n     \"employees\": \"Empregados\",\n     \"empty\": \"Vac\u00edo\",\n-    \"empty-contact-data\": \"El contacto debe tener nombre o email o direcci\u00f3n\",\n+    \"empty-contact-data\": \"O contacto debe ter nome ou email ou direcci\u00f3n\",\n     \"enable\": \"Activar\",\n     \"enable-api\": \"Activar API\",\n     \"enable-updates-beta\": \"Activar actualizaci\u00f3ns beta\","
        },
        {
          "filename": "Test/Core/Model/CuentaTest.php",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -72,6 +72,21 @@ public function testCreateBadCode()\n         }\n     }\n \n+    public function testHtmlOnDescription()\n+    {\n+        $account = new Cuenta();\n+        $account->codcuenta = '9999';\n+        $account->codejercicio = $this->getRandomExercise()->codejercicio;\n+        $account->descripcion = '<b>Test</b>';\n+        $this->assertTrue($account->save(), 'can-not-create-account');\n+\n+        // comprobamos que el html se ha escapado\n+        $this->assertEquals('&lt;b&gt;Test&lt;/b&gt;', $account->descripcion);\n+\n+        // eliminamos\n+        $this->assertTrue($account->delete(), 'account-cant-delete');\n+    }\n+\n     public function testCreateClosed()\n     {\n         // cerramos un ejercicio"
        },
        {
          "filename": "Test/Core/Model/SubcuentaTest.php",
          "status": "removed",
          "additions": 0,
          "deletions": 38,
          "patch": "@@ -1,38 +0,0 @@\n-<?php\n-/**\n- * This file is part of FacturaScripts\n- * Copyright (C) 2017       Francesc Pineda Segarra <francesc.pineda.segarra@gmail.com>\n- * Copyright (C) 2017-2018  Carlos Garcia Gomez     <carlos@facturascripts.com>\n- *\n- * This program is free software: you can redistribute it and/or modify\n- * it under the terms of the GNU Lesser General Public License as\n- * published by the Free Software Foundation, either version 3 of the\n- * License, or (at your option) any later version.\n- *\n- * This program is distributed in the hope that it will be useful,\n- * but WITHOUT ANY WARRANTY; without even the implied warranty of\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n- * GNU Lesser General Public License for more details.\n- *\n- * You should have received a copy of the GNU Lesser General Public License\n- * along with this program. If not, see <http://www.gnu.org/licenses/>.\n- */\n-\n-namespace FacturaScripts\\Test\\Core\\Model;\n-\n-use FacturaScripts\\Core\\Model\\Subcuenta;\n-use FacturaScripts\\Test\\Core\\CustomTest;\n-\n-/**\n- * @covers \\Subcuenta\n- *\n- * @author Francesc Pineda Segarra <francesc.pineda.segarra@gmail.com>\n- */\n-final class SubcuentaTest extends CustomTest\n-{\n-\n-    protected function setUp(): void\n-    {\n-        $this->model = new Subcuenta();\n-    }\n-}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7514dcbf624a71edfdc8bff931086b884ae0b6d3",
            "date": "2025-01-21T11:58:07Z",
            "author_login": "NeoRazorX"
          },
          {
            "sha": "8ec4491dce210c6b5b5c46051be04783ac2bef0e",
            "date": "2024-12-12T13:05:59Z",
            "author_login": "NeoRazorX"
          },
          {
            "sha": "6a3ae46f2eeb3a788eeeb7ef28a76814eb5489e6",
            "date": "2024-12-12T13:00:46Z",
            "author_login": "daniel89fg"
          },
          {
            "sha": "cc41008acec11ae3fd377b4ccdad05eb94e80065",
            "date": "2024-12-05T16:15:38Z",
            "author_login": "NeoRazorX"
          },
          {
            "sha": "a828e984d522b22b4b0fe8c69ffa2f318e8213d2",
            "date": "2024-10-24T12:33:46Z",
            "author_login": "daniel89fg"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Generic in GitHub repository neorazorx/facturascripts prior to 2022.09.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-03T08:15:07.507",
    "last_modified": "2024-11-21T06:41:53.810",
    "fix_date": "2022-05-31T10:53:15Z"
  },
  "references": [
    {
      "url": "https://github.com/neorazorx/facturascripts/commit/93fc65ced3847a8e0837561e9fdfa0dbace2cfcb",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/7882a35a-b27e-4d7e-9fcc-e9e009d0b01c",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neorazorx/facturascripts/commit/93fc65ced3847a8e0837561e9fdfa0dbace2cfcb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/7882a35a-b27e-4d7e-9fcc-e9e009d0b01c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.227114",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "facturascripts",
    "owner": "neorazorx",
    "created_at": "2013-04-06T16:53:45Z",
    "updated_at": "2025-01-21T11:58:11Z",
    "pushed_at": "2025-01-21T11:58:08Z",
    "size": 52262,
    "stars": 388,
    "forks": 256,
    "open_issues": 73,
    "watchers": 388,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3748908,
      "Twig": 428466,
      "JavaScript": 45189,
      "CSS": 6072
    },
    "commit_activity": {
      "total_commits_last_year": 721,
      "avg_commits_per_week": 13.865384615384615,
      "days_active_last_year": 210
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-3.0"
    },
    "collected_at": "2025-01-26T07:59:23.380694"
  }
}