{
  "cve_id": "CVE-2022-2026",
  "github_data": {
    "repository": "kromitgmbh/titra",
    "fix_commit": "e606b674a2b7564407d89e38a341d72e22b14694",
    "related_commits": [
      "e606b674a2b7564407d89e38a341d72e22b14694",
      "e606b674a2b7564407d89e38a341d72e22b14694"
    ],
    "patch_url": "https://github.com/kromitgmbh/titra/commit/e606b674a2b7564407d89e38a341d72e22b14694.patch",
    "fix_commit_details": {
      "sha": "e606b674a2b7564407d89e38a341d72e22b14694",
      "commit_date": "2022-06-07T13:13:20Z",
      "author": {
        "login": "faburem",
        "type": "User",
        "stats": {
          "total_commits": 418,
          "average_weekly_commits": 0.990521327014218,
          "total_additions": 107023,
          "total_deletions": 85632,
          "weeks_active": 189
        }
      },
      "commit_message": {
        "title": "\ud83d\udd12 fixes three critical stored XSS vulnerabilities thanks @saharshtapi for reporting this",
        "length": 358,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 72,
        "additions": 44,
        "deletions": 28
      },
      "files": [
        {
          "filename": ".meteor/release",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-METEOR@2.7.2\n+METEOR@2.7.3"
        },
        {
          "filename": ".meteor/versions",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -89,7 +89,7 @@ templating-compiler@1.4.1\n templating-runtime@1.5.0\n templating-tools@1.2.2\n tracker@1.2.0\n-tunguska:reactive-aggregate@1.3.7\n+tunguska:reactive-aggregate@1.3.8\n ui@1.0.13\n underscore@1.0.10\n url@1.3.2"
        },
        {
          "filename": "imports/ui/components/allprojectschart.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -128,7 +128,7 @@ Template.allprojectschart.onRendered(() => {\n               colors: ['#009688', '#455A64', '#e4e4e4'],\n               height: 230,\n               data: {\n-                labels: templateInstance.topTasks.get().map((task) => task._id),\n+                labels: templateInstance.topTasks.get().map((task) => $('<span>').text(task._id).html()),\n                 datasets: [{\n                   values: templateInstance.topTasks.get().map((task) => task.count),\n                 }],"
        },
        {
          "filename": "imports/ui/components/dailytimetable.js",
          "status": "modified",
          "additions": 13,
          "deletions": 2,
          "patch": "@@ -11,6 +11,7 @@ import {\n   numberWithUserPrecision,\n   getUserSetting,\n   getUserTimeUnitVerbose,\n+  addToolTipToTableCell,\n } from '../../utils/frontend_helpers'\n import { i18nReady, t } from '../../utils/i18n.js'\n import { dailyTimecardMapper } from '../../utils/server_method_helpers'\n@@ -68,8 +69,18 @@ Template.dailytimetable.onRendered(() => {\n           width: 1,\n           compareValue: (cell, keyword) => [dayjs(cell, getGlobalSetting('dateformat')).toDate(), dayjs(keyword, getGlobalSetting('dateformat')).toDate()],\n         },\n-        { name: t('globals.project'), editable: false, width: 2 },\n-        { name: t('globals.resource'), editable: false, width: 2 },\n+        {\n+          name: t('globals.project'),\n+          editable: false,\n+          width: 2,\n+          format: addToolTipToTableCell,\n+        },\n+        {\n+          name: t('globals.resource'),\n+          editable: false,\n+          width: 2,\n+          format: addToolTipToTableCell,\n+        },\n         {\n           name: getUserTimeUnitVerbose(),\n           editable: false,"
        },
        {
          "filename": "imports/ui/components/detailtimetable.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,7 +36,7 @@ function detailedDataTableMapper(entry) {\n   const project = Projects.findOne({ _id: entry.projectId })\n   const mapping = [project ? project.name : '',\n     dayjs.utc(entry.date).format(getGlobalSetting('dateformat')),\n-    entry.task,\n+    entry.task.replace(/^=/, '='),\n     projectUsers.findOne() ? projectUsers.findOne().users.find((elem) => elem._id === entry.userId)?.profile?.name : '']\n   if (getGlobalSetting('showCustomFieldsInDetails')) {\n     if (CustomFields.find({ classname: 'time_entry' }).count() > 0) {"
        },
        {
          "filename": "imports/ui/components/periodtimetable.js",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -11,6 +11,7 @@ import {\n   numberWithUserPrecision,\n   getUserSetting,\n   getUserTimeUnitVerbose,\n+  addToolTipToTableCell,\n } from '../../utils/frontend_helpers.js'\n import { totalHoursForPeriodMapper } from '../../utils/server_method_helpers.js'\n \n@@ -61,8 +62,8 @@ Template.periodtimetable.onRendered(() => {\n             .map((key) => key[1]))\n       }\n       const columns = [\n-        { name: t('globals.project'), editable: false },\n-        { name: t('globals.resource'), editable: false },\n+        { name: t('globals.project'), editable: false, format: addToolTipToTableCell },\n+        { name: t('globals.resource'), editable: false, format: addToolTipToTableCell },\n         {\n           name: getUserTimeUnitVerbose(),\n           editable: false,"
        },
        {
          "filename": "imports/ui/components/projectAccessRights.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@ import { FlowRouter } from 'meteor/ostrio:flow-router-extra'\n import './projectAccessRights.html'\n import { t, i18nReady } from '../../utils/i18n.js'\n import {\n-  validateEmail, getGlobalSetting, showToast,\n+  validateEmail, getGlobalSetting, showToast, addToolTipToTableCell,\n } from '../../utils/frontend_helpers'\n import Projects from '../../api/projects/projects.js'\n \n@@ -28,6 +28,7 @@ Template.projectAccessRights.onRendered(() => {\n           name: t('globals.name'),\n           editable: false,\n           focusable: false,\n+          format: addToolTipToTableCell,\n         }, {\n           name: t('project.access_rights'),\n           editable: false,"
        },
        {
          "filename": "imports/ui/components/projectchart.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -200,7 +200,7 @@ Template.projectchart.onRendered(() => {\n                 colors: [Projects.findOne({ _id: templateInstance.data.projectId }).color || '#009688', '#66c0b8', '#e4e4e4'],\n                 height: 230,\n                 data: {\n-                  labels: templateInstance.topTasks.get().map((task) => task._id),\n+                  labels: templateInstance.topTasks.get().map((task) => $('<span>').text(task._id).html()),\n                   datasets: [{\n                     values: templateInstance.topTasks.get().map((task) => task.count),\n                   }],"
        },
        {
          "filename": "imports/ui/pages/dashboard.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -10,6 +10,7 @@ import {\n   getGlobalSetting,\n   timeInUserUnit,\n   getUserTimeUnitVerbose,\n+  addToolTipToTableCell,\n } from '../../utils/frontend_helpers'\n import './dashboard.html'\n import Timecards from '../../api/timecards/timecards'\n@@ -126,7 +127,7 @@ Template.dashboard.onRendered(() => {\n           const precision = getUserSetting('precision')\n           for (const timecard of Timecards.find({}, { sort: { date: 1 } }).fetch()) {\n             taskmap.set(\n-              timecard.task.replace(/(:\\S*:)/g, emojify),\n+              $('<span>').text(timecard.task.replace(/(:\\S*:)/g, emojify)).html(),\n               taskmap.get(timecard.task.replace(/(:\\S*:)/g, emojify))\n                 ? Number(Number(taskmap.get(timecard.task.replace(/(:\\S*:)/g, emojify))) + Number(timeInUnitHelper(timecard.hours)))\n                 : Number(timeInUnitHelper(timecard.hours)),"
        },
        {
          "filename": "imports/utils/frontend_helpers.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -18,7 +18,8 @@ function getUserSetting(field) {\n \n function addToolTipToTableCell(value) {\n   if (value) {\n-    return `<span class=\"js-tooltip\" data-bs-toggle=\"tooltip\" data-bs-placement=\"left\" title=\"${value}\">${value}</span>`\n+    const sanitizedValue = $('<div/>').text(value).html()\n+    return `<span class=\"js-tooltip\" data-bs-toggle=\"tooltip\" data-bs-placement=\"left\" title='${sanitizedValue}'>${sanitizedValue}</span>`\n   }\n   return ''\n }"
        },
        {
          "filename": "imports/utils/server_method_helpers.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -67,7 +67,8 @@ function totalHoursForPeriodMapper(entry) {\n   }\n   return {\n     projectId: Projects.findOne({ _id: entry._id.projectId }).name,\n-    userId: projectUsers.findOne().users.find((elem) => elem._id === entry._id.userId)?.profile?.name,\n+    userId: projectUsers\n+      .findOne().users.find((elem) => elem._id === entry._id.userId)?.profile?.name,\n     totalHours,\n   }\n }"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 12,
          "deletions": 12,
          "patch": "@@ -793,9 +793,9 @@\n       }\n     },\n     \"dayjs\": {\n-      \"version\": \"1.11.2\",\n-      \"resolved\": \"https://registry.npmjs.org/dayjs/-/dayjs-1.11.2.tgz\",\n-      \"integrity\": \"sha512-F4LXf1OeU9hrSYRPTTj/6FbO4HTjPKXvEIC1P2kcnFurViINCVk3ZV0xAS3XVx9MkMsXbbqlK6hjseaYbgKEHw==\"\n+      \"version\": \"1.11.3\",\n+      \"resolved\": \"https://registry.npmjs.org/dayjs/-/dayjs-1.11.3.tgz\",\n+      \"integrity\": \"sha512-xxwlswWOlGhzgQ4TKzASQkUhqERI3egRNqgV4ScR8wlANA/A9tZ7miXa44vTTKEq5l7vWoL5G57bG3zA+Kow0A==\"\n     },\n     \"dayjs-precise-range\": {\n       \"version\": \"1.0.1\",\n@@ -962,9 +962,9 @@\n       \"dev\": true\n     },\n     \"eslint\": {\n-      \"version\": \"8.16.0\",\n-      \"resolved\": \"https://registry.npmjs.org/eslint/-/eslint-8.16.0.tgz\",\n-      \"integrity\": \"sha512-MBndsoXY/PeVTDJeWsYj7kLZ5hQpJOfMYLsF6LicLHQWbRDG19lK5jOix4DPl8yY4SUFcE3txy86OzFLWT+yoA==\",\n+      \"version\": \"8.17.0\",\n+      \"resolved\": \"https://registry.npmjs.org/eslint/-/eslint-8.17.0.tgz\",\n+      \"integrity\": \"sha512-gq0m0BTJfci60Fz4nczYxNAlED+sMcihltndR8t9t1evnU/azx53x3t2UHXC/uRjcbvRw/XctpaNygSTcQD+Iw==\",\n       \"dev\": true,\n       \"requires\": {\n         \"@eslint/eslintrc\": \"^1.3.0\",\n@@ -1397,7 +1397,7 @@\n     \"fast-levenshtein\": {\n       \"version\": \"2.0.6\",\n       \"resolved\": \"https://registry.npmjs.org/fast-levenshtein/-/fast-levenshtein-2.0.6.tgz\",\n-      \"integrity\": \"sha1-PYpcZog6FqMMqGQ+hR8Zuqd5eRc=\",\n+      \"integrity\": \"sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==\",\n       \"dev\": true\n     },\n     \"file-entry-cache\": {\n@@ -1485,7 +1485,7 @@\n     \"functional-red-black-tree\": {\n       \"version\": \"1.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/functional-red-black-tree/-/functional-red-black-tree-1.0.1.tgz\",\n-      \"integrity\": \"sha1-GwqzvVU7Kg1jmdKcDj6gslIHgyc=\",\n+      \"integrity\": \"sha512-dsKNQNdj6xA3T+QlADDA7mOSlX0qiMINjn0cgr+eGHGsbSHzTabcIogz2+p/iqP1Xs6EP/sS2SbqH+brGTbq0g==\",\n       \"dev\": true\n     },\n     \"gauge\": {\n@@ -1657,7 +1657,7 @@\n     \"imurmurhash\": {\n       \"version\": \"0.1.4\",\n       \"resolved\": \"https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz\",\n-      \"integrity\": \"sha1-khi5srkoojixPcT7a21XbyMUU+o=\",\n+      \"integrity\": \"sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==\",\n       \"dev\": true\n     },\n     \"inflight\": {\n@@ -1830,7 +1830,7 @@\n     \"isexe\": {\n       \"version\": \"2.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz\",\n-      \"integrity\": \"sha1-6PvzdNxVb/iUehDcsFctYz8s+hA=\",\n+      \"integrity\": \"sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==\",\n       \"dev\": true\n     },\n     \"jalaali-js\": {\n@@ -1877,7 +1877,7 @@\n     \"json-stable-stringify-without-jsonify\": {\n       \"version\": \"1.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/json-stable-stringify-without-jsonify/-/json-stable-stringify-without-jsonify-1.0.1.tgz\",\n-      \"integrity\": \"sha1-nbe1lJatPzz+8wp1FC0tkwrXJlE=\",\n+      \"integrity\": \"sha512-Bdboy+l7tA3OGW6FjyFHWkP5LuByj1Tk33Ljyq0axyzdk9//JSi2u3fP1QSmd1KNwq6VOKYGlAu87CisVir6Pw==\",\n       \"dev\": true\n     },\n     \"json5\": {\n@@ -2829,7 +2829,7 @@\n     \"natural-compare\": {\n       \"version\": \"1.4.0\",\n       \"resolved\": \"https://registry.npmjs.org/natural-compare/-/natural-compare-1.4.0.tgz\",\n-      \"integrity\": \"sha1-Sr6/7tdUHywnrPspvbvRXI1bpPc=\",\n+      \"integrity\": \"sha512-OWND8ei3VtNC9h7V60qff3SVobHr996CTwgxubgyQYEpg290h9J0buyECNNJexkFm5sOajh5G116RYA1c8ZMSw==\",\n       \"dev\": true\n     },\n     \"node-addon-api\": {"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"titra\",\n-  \"version\": \"0.76.1\",\n+  \"version\": \"0.77.0\",\n   \"private\": true,\n   \"scripts\": {\n     \"start\": \"meteor run\"\n@@ -19,7 +19,7 @@\n     \"bootstrap\": \"^5.1.3\",\n     \"content-type\": \"^1.0.4\",\n     \"date-holidays\": \"^3.16.0\",\n-    \"dayjs\": \"^1.11.2\",\n+    \"dayjs\": \"^1.11.3\",\n     \"dayjs-precise-range\": \"^1.0.1\",\n     \"docker-names\": \"^1.2.1\",\n     \"file-saver\": \"^2.0.5\",\n@@ -46,7 +46,7 @@\n   \"devDependencies\": {\n     \"@babel/core\": \"^7.18.2\",\n     \"@babel/eslint-parser\": \"^7.18.2\",\n-    \"eslint\": \"^8.16.0\",\n+    \"eslint\": \"^8.17.0\",\n     \"eslint-config-airbnb-base\": \"^15.0.0\",\n     \"eslint-import-resolver-meteor\": \"^0.4.0\",\n     \"eslint-plugin-i18next\": \"^5.2.1\","
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "06466c4c5f7c8f8729a3885de38bd90d724601f5",
            "date": "2025-01-14T18:39:38Z",
            "author_login": "faburem"
          },
          {
            "sha": "b661b282ada44864b3987d6a5b115001232a298a",
            "date": "2025-01-14T18:27:25Z",
            "author_login": "faburem"
          },
          {
            "sha": "277720a93575dd43157705e12e628f2b0a658961",
            "date": "2025-01-10T09:24:18Z",
            "author_login": "faburem"
          },
          {
            "sha": "d80a2887d324cbae8831862d7419fc27b8fb16f7",
            "date": "2025-01-10T08:29:01Z",
            "author_login": "faburem"
          },
          {
            "sha": "a016d71d270ecf1f929a315ec4bc5ae642cfbb29",
            "date": "2024-12-18T16:19:42Z",
            "author_login": "faburem"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository kromitgmbh/titra prior to 0.77.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-09T17:15:09.497",
    "last_modified": "2024-11-21T07:00:11.750",
    "fix_date": "2022-06-07T13:13:20Z"
  },
  "references": [
    {
      "url": "https://github.com/kromitgmbh/titra/commit/e606b674a2b7564407d89e38a341d72e22b14694",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/dcfa6790-c609-4ed5-ba5e-8f31f98e5e11",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kromitgmbh/titra/commit/e606b674a2b7564407d89e38a341d72e22b14694",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/dcfa6790-c609-4ed5-ba5e-8f31f98e5e11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.424714",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "titra",
    "owner": "kromitgmbh",
    "created_at": "2016-12-19T10:55:48Z",
    "updated_at": "2025-01-10T09:24:21Z",
    "pushed_at": "2025-01-10T09:24:18Z",
    "size": 25998,
    "stars": 409,
    "forks": 56,
    "open_issues": 9,
    "watchers": 409,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 605317,
      "HTML": 158544,
      "SCSS": 39393,
      "Cap'n Proto": 11256,
      "Dockerfile": 1921,
      "Shell": 697
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T14:28:21.088757"
  }
}