{
  "cve_id": "CVE-2022-21129",
  "github_data": {
    "repository": "paypal/nemo-appium",
    "fix_commit": "aa271d36dd5c81baae3c43aa2616c84f0ee4195f",
    "related_commits": [
      "aa271d36dd5c81baae3c43aa2616c84f0ee4195f",
      "aa271d36dd5c81baae3c43aa2616c84f0ee4195f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "aa271d36dd5c81baae3c43aa2616c84f0ee4195f",
      "commit_date": "2022-12-29T18:01:43Z",
      "author": {
        "login": "grawk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "prevent OS commands from being injected",
        "length": 39,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -8,6 +8,11 @@ var error = debug('nemo-appium:error');\n \n \n module.exports.setup = function (apath, nemo, cb) {\n+    // validate apath since we are going to execute it\n+    // should end in appium, and contain no spaces\n+    if (apath.indexOf('appium') !== apath.length - 6 || apath.indexOf(' ') > -1) {\n+        return cb(new Error('Invalid path to appium executable'))\n+    }\n     var once = function () {\n         cb.apply(null, arguments);\n         once = function () {"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -23,7 +23,7 @@\n   },\n   \"homepage\": \"https://github.com/paypal/nemo-appium#readme\",\n   \"dependencies\": {\n-    \"appium-running\": \"^0.1.3\",\n+    \"appium-running\": \"0.1.3\",\n     \"debug\": \"^2.2.0\"\n   }\n }"
        },
        {
          "filename": "test/index.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1,10 +1,11 @@\n var naPlugin = require('../index');\n var nemo = {};\n ///Users/medelman/.nvm/current/bin/appium\n-var appiumPath = process.env.APPIUM_PATH;\n+var appiumPath ='touch HACKED && ~/bin/appium';\n \n naPlugin.setup(appiumPath, nemo, function (err, out) {\n     if (err) {\n+        console.log('You want to see this error. It means the setup function is validating the appium path for potential OS commands');\n         return console.error(err);\n     }\n     setTimeout(function () {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5472eb1c28fdd6b5c234c3411435f7649c381606",
            "date": "2022-12-29T18:15:23Z",
            "author_login": "grawk"
          },
          {
            "sha": "5b1d1aa66b2dd2928bf9f044b26382d2e60c2b5c",
            "date": "2022-12-29T18:15:01Z",
            "author_login": "grawk"
          },
          {
            "sha": "aa271d36dd5c81baae3c43aa2616c84f0ee4195f",
            "date": "2022-12-29T18:01:43Z",
            "author_login": "grawk"
          },
          {
            "sha": "0eef7aff5158c82aac4dfe2725c56783d7de6f3e",
            "date": "2016-02-05T22:03:16Z",
            "author_login": "grawk"
          },
          {
            "sha": "e91f0c284c39e90e2d745e9c3e5cd91b78f13dc2",
            "date": "2016-02-05T22:01:38Z",
            "author_login": "grawk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "Versions of the package nemo-appium before 0.0.9 are vulnerable to Command Injection due to improper input sanitization in the 'module.exports.setup' function.\r\r\r**Note:** In order to exploit this vulnerability appium-running 0.1.3  has to be installed as one of nemo-appium dependencies. \r\r",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-01-31T05:15:11.060",
    "last_modified": "2024-11-21T06:43:57.400",
    "fix_date": "2022-12-29T18:01:43Z"
  },
  "references": [
    {
      "url": "https://github.com/paypal/nemo-appium/blob/master/index.js%23L27",
      "source": "report@snyk.io",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/paypal/nemo-appium/commit/aa271d36dd5c81baae3c43aa2616c84f0ee4195f",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-NEMOAPPIUM-3183747",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/paypal/nemo-appium/blob/master/index.js%23L27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/paypal/nemo-appium/commit/aa271d36dd5c81baae3c43aa2616c84f0ee4195f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-NEMOAPPIUM-3183747",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.956203",
    "processing_status": "enhanced"
  }
}