{
  "cve_id": "CVE-2022-21504",
  "github_data": {
    "repository": "oracle/linux-uek",
    "fix_commit": "49c68f5f892d8c2be00e0a89ff2a035422c03b59",
    "related_commits": [
      "49c68f5f892d8c2be00e0a89ff2a035422c03b59",
      "49c68f5f892d8c2be00e0a89ff2a035422c03b59"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "49c68f5f892d8c2be00e0a89ff2a035422c03b59",
      "commit_date": "2019-12-11T21:10:35Z",
      "author": {
        "login": "axboe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fs: move filp_close() outside of __close_fd_get_file()",
        "length": 570,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 8,
        "deletions": 4
      },
      "files": [
        {
          "filename": "drivers/android/binder.c",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -2236,10 +2236,12 @@ static void binder_deferred_fd_close(int fd)\n \t\treturn;\n \tinit_task_work(&twcb->twork, binder_do_fd_close);\n \t__close_fd_get_file(fd, &twcb->file);\n-\tif (twcb->file)\n+\tif (twcb->file) {\n+\t\tfilp_close(twcb->file, current->files);\n \t\ttask_work_add(current, &twcb->twork, TWA_RESUME);\n-\telse\n+\t} else {\n \t\tkfree(twcb);\n+\t}\n }\n \n static void binder_transaction_buffer_release(struct binder_proc *proc,"
        },
        {
          "filename": "fs/file.c",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -650,7 +650,9 @@ int __close_fd(struct files_struct *files, unsigned fd)\n EXPORT_SYMBOL(__close_fd); /* for ksys_close() */\n \n /*\n- * variant of __close_fd that gets a ref on the file for later fput\n+ * variant of __close_fd that gets a ref on the file for later fput.\n+ * The caller must ensure that filp_close() called on the file, and then\n+ * an fput().\n  */\n int __close_fd_get_file(unsigned int fd, struct file **res)\n {\n@@ -670,7 +672,7 @@ int __close_fd_get_file(unsigned int fd, struct file **res)\n \tspin_unlock(&files->file_lock);\n \tget_file(file);\n \t*res = file;\n-\treturn filp_close(file, files);\n+\treturn 0;\n \n out_unlock:\n \tspin_unlock(&files->file_lock);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1249e31fbc0dfa19ca6d4c1826f8952cb1f6eeab",
            "date": "2025-01-24T17:01:30Z",
            "author_login": "oraclelinuxkernel"
          },
          {
            "sha": "01e70478df6165c80fe2b4aba33fb32945c90644",
            "date": "2025-01-17T17:02:10Z",
            "author_login": "oraclelinuxkernel"
          },
          {
            "sha": "afab18069a1a2a14f240d103b066febcea0ef5c0",
            "date": "2025-01-10T22:01:26Z",
            "author_login": "oraclelinuxkernel"
          },
          {
            "sha": "a0173434f0f41e6574841537e720c8b7c957f09c",
            "date": "2025-01-10T17:01:26Z",
            "author_login": "oraclelinuxkernel"
          },
          {
            "sha": "15ea33dcc3245bb5ad6d65d38328abc68ecb9f0e",
            "date": "2025-01-03T17:01:38Z",
            "author_login": "oraclelinuxkernel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-416",
    "description": "The code in UEK6 U3 was missing an appropiate file descriptor count to be missing. This resulted in a use count error that allowed a file descriptor to a socket to be closed and freed while it was still in use by another portion of the kernel. An attack with local access can operate on the socket, and cause a denial of service. CVSS 3.1 Base Score 5.5 (Availability impacts). CVSS Vector: (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H).",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-14T18:15:08.070",
    "last_modified": "2024-11-21T06:44:50.890",
    "fix_date": "2019-12-11T21:10:35Z"
  },
  "references": [
    {
      "url": "https://github.com/oracle/linux-uek/commit/49c68f5f892d8c2be00e0a89ff2a035422c03b59",
      "source": "secalert_us@oracle.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oracle/linux-uek/commit/49c68f5f892d8c2be00e0a89ff2a035422c03b59",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.442068",
    "processing_status": "enhanced"
  }
}