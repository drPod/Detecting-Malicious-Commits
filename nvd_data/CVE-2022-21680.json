{
  "cve_id": "CVE-2022-21680",
  "github_data": {
    "repository": "markedjs/marked",
    "fix_commit": "c4a3ccd344b6929afa8a1d50ac54a721e57012c0",
    "related_commits": [
      "c4a3ccd344b6929afa8a1d50ac54a721e57012c0",
      "c4a3ccd344b6929afa8a1d50ac54a721e57012c0"
    ],
    "patch_url": "https://github.com/markedjs/marked/commit/c4a3ccd344b6929afa8a1d50ac54a721e57012c0.patch",
    "fix_commit_details": {
      "sha": "c4a3ccd344b6929afa8a1d50ac54a721e57012c0",
      "commit_date": "2022-01-13T01:53:48Z",
      "author": {
        "login": "UziTech",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-rrrm-qjm4-v8hf",
        "length": 293,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 17,
        "deletions": 4
      },
      "files": [
        {
          "filename": "src/rules.js",
          "status": "modified",
          "additions": 9,
          "deletions": 4,
          "patch": "@@ -25,7 +25,7 @@ export const block = {\n     + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n     + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n     + ')',\n-  def: /^ {0,3}\\[(label)\\]: *\\n? *<?([^\\s>]+)>?(?:(?: +\\n? *| *\\n *)(title))? *(?:\\n+|$)/,\n+  def: /^ {0,3}\\[(label)\\]: *(?:\\n *)?<?([^\\s>]+)>?(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/,\n   table: noopTest,\n   lheading: /^([^\\n]+)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n   // regex template, placeholders will be replaced according to different paragraph\n@@ -34,7 +34,7 @@ export const block = {\n   text: /^[^\\n]+/\n };\n \n-block._label = /(?!\\s*\\])(?:\\\\[\\[\\]]|[^\\[\\]])+/;\n+block._label = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\n block._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\n block.def = edit(block.def)\n   .replace('label', block._label)\n@@ -162,8 +162,8 @@ export const inline = {\n     + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n     + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>', // CDATA section\n   link: /^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/,\n-  reflink: /^!?\\[(label)\\]\\[(?!\\s*\\])((?:\\\\[\\[\\]]?|[^\\[\\]\\\\])+)\\]/,\n-  nolink: /^!?\\[(?!\\s*\\])((?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]|[^\\[\\]])*)\\](?:\\[\\])?/,\n+  reflink: /^!?\\[(label)\\]\\[(ref)\\]/,\n+  nolink: /^!?\\[(ref)\\](?:\\[\\])?/,\n   reflinkSearch: 'reflink|nolink(?!\\\\()',\n   emStrong: {\n     lDelim: /^(?:\\*+(?:([punct_])|[^\\s*]))|^_+(?:([punct*])|([^\\s_]))/,\n@@ -230,6 +230,11 @@ inline.link = edit(inline.link)\n \n inline.reflink = edit(inline.reflink)\n   .replace('label', inline._label)\n+  .replace('ref', block._label)\n+  .getRegex();\n+\n+inline.nolink = edit(inline.nolink)\n+  .replace('ref', block._label)\n   .getRegex();\n \n inline.reflinkSearch = edit(inline.reflinkSearch, 'g')"
        },
        {
          "filename": "test/specs/redos/cubic_def.cjs",
          "status": "added",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -0,0 +1,4 @@\n+module.exports = {\n+  markdown: `[x]:${' '.repeat(1500)}x ${' '.repeat(1500)} x`,\n+  html: `<p>[x]:${' '.repeat(1500)}x ${' '.repeat(1500)} x</p>`,\n+};"
        },
        {
          "filename": "test/specs/redos/reflink_redos.html",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+<p>[[]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([]([</p>"
        },
        {
          "filename": "test/specs/redos/reflink_redos.md",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+[x]: x\n+\n+[\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](\\[\\](["
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9f2926c53f3e5849472064ad9954f0e2f1dffd11",
            "date": "2025-01-13T15:32:00Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "dba110830b503e5d09fe6d0c935ceeba5d45e435",
            "date": "2025-01-13T15:31:47Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "218d77a40a71ddaea8ce6a8a228bc12e043982b7",
            "date": "2025-01-13T15:31:32Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c71d35573745a34c56b8b85f3a93aeb2d771331f",
            "date": "2025-01-13T15:31:20Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "5624378bd3dcc44f71dd0568deffe7e85f6f12c9",
            "date": "2025-01-06T16:02:29Z",
            "author_login": "semantic-release-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Marked is a markdown parser and compiler. Prior to version 4.0.10, the regular expression `block.def` may cause catastrophic backtracking against some strings and lead to a regular expression denial of service (ReDoS). Anyone who runs untrusted markdown through a vulnerable version of marked and does not use a worker with a time limit may be affected. This issue is patched in version 4.0.10. As a workaround, avoid running untrusted markdown through marked or run marked on a worker thread and set a reasonable time limit to prevent draining resources.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-01-14T17:15:13.210",
    "last_modified": "2024-11-21T06:45:13.070",
    "fix_date": "2022-01-13T01:53:48Z"
  },
  "references": [
    {
      "url": "https://github.com/markedjs/marked/commit/c4a3ccd344b6929afa8a1d50ac54a721e57012c0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/markedjs/marked/releases/tag/v4.0.10",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/markedjs/marked/security/advisories/GHSA-rrrm-qjm4-v8hf",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AIXDMC3CSHYW3YWVSQOXAWLUYQHAO5UX/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/markedjs/marked/commit/c4a3ccd344b6929afa8a1d50ac54a721e57012c0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/markedjs/marked/releases/tag/v4.0.10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/markedjs/marked/security/advisories/GHSA-rrrm-qjm4-v8hf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AIXDMC3CSHYW3YWVSQOXAWLUYQHAO5UX/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.027635",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "marked",
    "owner": "markedjs",
    "created_at": "2011-07-24T13:15:51Z",
    "updated_at": "2025-01-14T22:48:37Z",
    "pushed_at": "2025-01-13T15:32:02Z",
    "size": 10010,
    "stars": 33611,
    "forks": 3398,
    "open_issues": 17,
    "watchers": 33611,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 110589,
      "TypeScript": 109883,
      "HTML": 93607
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T23:00:13.250195"
  }
}