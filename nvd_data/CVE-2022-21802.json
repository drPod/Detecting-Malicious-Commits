{
  "cve_id": "CVE-2022-21802",
  "github_data": {
    "repository": "artf/grapesjs",
    "fix_commit": "13e85d152d486b968265c4b8017e8901e7d89ff3",
    "related_commits": [
      "13e85d152d486b968265c4b8017e8901e7d89ff3",
      "13e85d152d486b968265c4b8017e8901e7d89ff3"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "13e85d152d486b968265c4b8017e8901e7d89ff3",
      "commit_date": "2022-06-27T14:32:49Z",
      "author": {
        "login": "artf",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Protect Selector Manager views from XSS. Closes #4411",
        "length": 53,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 58,
        "additions": 26,
        "deletions": 32
      },
      "files": [
        {
          "filename": "src/selector_manager/view/ClassTagView.ts",
          "status": "modified",
          "additions": 3,
          "deletions": 4,
          "patch": "@@ -1,5 +1,6 @@\n import { View } from '../../common';\n import State from '../model/State';\n+import html from '../../utils/html';\n \n const inputProp = 'contentEditable';\n \n@@ -8,12 +9,10 @@ export default class ClassTagView extends View<State> {\n     const { pfx, model, config } = this;\n     const label = model.get('label') || '';\n \n-    return `\n+    return html`\n       <span id=\"${pfx}checkbox\" class=\"${pfx}tag-status\" data-tag-status></span>\n       <span id=\"${pfx}tag-label\" data-tag-name>${label}</span>\n-      <span id=\"${pfx}close\" class=\"${pfx}tag-close\" data-tag-remove>\n-        ${config.iconTagRemove}\n-      </span>\n+      <span id=\"${pfx}close\" class=\"${pfx}tag-close\" data-tag-remove> $${config.iconTagRemove} </span>\n     `;\n   }\n "
        },
        {
          "filename": "src/selector_manager/view/ClassTagsView.ts",
          "status": "modified",
          "additions": 23,
          "deletions": 28,
          "patch": "@@ -11,36 +11,31 @@ import Selectors from '../model/Selectors';\n \n export default class ClassTagsView extends View<Selector> {\n   template({ labelInfo, labelHead, iconSync, iconAdd, pfx, ppfx }: any) {\n-    return `\n-    <div id=\"${pfx}up\" class=\"${pfx}header\">\n-      <div id=\"${pfx}label\" class=\"${pfx}header-label\">${labelHead}</div>\n-      <div id=\"${pfx}status-c\" class=\"${pfx}header-status\">\n-        <span id=\"${pfx}input-c\" data-states-c>\n-          <div class=\"${ppfx}field ${ppfx}select\">\n-            <span id=\"${ppfx}input-holder\">\n-              <select id=\"${pfx}states\" data-states></select>\n-            </span>\n-            <div class=\"${ppfx}sel-arrow\">\n-              <div class=\"${ppfx}d-s-arrow\"></div>\n+    return html` <div id=\"${pfx}up\" class=\"${pfx}header\">\n+        <div id=\"${pfx}label\" class=\"${pfx}header-label\">${labelHead}</div>\n+        <div id=\"${pfx}status-c\" class=\"${pfx}header-status\">\n+          <span id=\"${pfx}input-c\" data-states-c>\n+            <div class=\"${ppfx}field ${ppfx}select\">\n+              <span id=\"${ppfx}input-holder\">\n+                <select id=\"${pfx}states\" data-states></select>\n+              </span>\n+              <div class=\"${ppfx}sel-arrow\">\n+                <div class=\"${ppfx}d-s-arrow\"></div>\n+              </div>\n             </div>\n-          </div>\n-        </span>\n+          </span>\n+        </div>\n       </div>\n-    </div>\n-    <div id=\"${pfx}tags-field\" class=\"${ppfx}field\">\n-      <div id=\"${pfx}tags-c\" data-selectors></div>\n-      <input id=\"${pfx}new\" data-input/>\n-      <span id=\"${pfx}add-tag\" class=\"${pfx}tags-btn ${pfx}tags-btn__add\" data-add>\n-        ${iconAdd}\n-      </span>\n-      <span class=\"${pfx}tags-btn ${pfx}tags-btn__sync\" style=\"display: none\" data-sync-style>\n-        ${iconSync}\n-      </span>\n-    </div>\n-    <div class=\"${pfx}sels-info\">\n-      <div class=\"${pfx}label-sel\">${labelInfo}:</div>\n-      <div class=\"${pfx}sels\" data-selected></div>\n-    </div>`;\n+      <div id=\"${pfx}tags-field\" class=\"${ppfx}field\">\n+        <div id=\"${pfx}tags-c\" data-selectors></div>\n+        <input id=\"${pfx}new\" data-input />\n+        <span id=\"${pfx}add-tag\" class=\"${pfx}tags-btn ${pfx}tags-btn__add\" data-add> $${iconAdd} </span>\n+        <span class=\"${pfx}tags-btn ${pfx}tags-btn__sync\" style=\"display: none\" data-sync-style> $${iconSync} </span>\n+      </div>\n+      <div class=\"${pfx}sels-info\">\n+        <div class=\"${pfx}label-sel\">${labelInfo}:</div>\n+        <div class=\"${pfx}sels\" data-selected></div>\n+      </div>`;\n   }\n \n   events() {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f333ef4ecbbdbf9ddbdfac414d589247b5c899c8",
            "date": "2025-01-23T14:05:08Z",
            "author_login": "mohamedsalem401"
          },
          {
            "sha": "6599e89ac4a5402fc77c3ddea9398a88334f9594",
            "date": "2025-01-23T13:41:24Z",
            "author_login": "mohamedsalem401"
          },
          {
            "sha": "cd8e95fee332eb2e21505d2ce065fb8451d6ee35",
            "date": "2025-01-22T02:38:27Z",
            "author_login": "jiangmencity"
          },
          {
            "sha": "3eeec39ba417a58cb41c0f2942d417d831565e04",
            "date": "2025-01-15T07:59:19Z",
            "author_login": "artf"
          },
          {
            "sha": "9831c9dae5b93b6decc28bc0a8be75f79edc63d4",
            "date": "2025-01-03T15:12:41Z",
            "author_login": "artf"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "The package grapesjs before 0.19.5 are vulnerable to Cross-site Scripting (XSS) due to an improper sanitization of the class name in Selector Manager.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-07-25T14:15:10.817",
    "last_modified": "2024-11-21T06:45:27.903",
    "fix_date": "2022-06-27T14:32:49Z"
  },
  "references": [
    {
      "url": "https://github.com/artf/grapesjs/commit/13e85d152d486b968265c4b8017e8901e7d89ff3",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/artf/grapesjs/issues/4411%23issuecomment-1167202709",
      "source": "report@snyk.io",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/artf/grapesjs/releases/tag/v0.19.5",
      "source": "report@snyk.io",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-2936781",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-GRAPESJS-2935960",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/artf/grapesjs/commit/13e85d152d486b968265c4b8017e8901e7d89ff3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/artf/grapesjs/issues/4411%23issuecomment-1167202709",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/artf/grapesjs/releases/tag/v0.19.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JAVA-ORGWEBJARSNPM-2936781",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-GRAPESJS-2935960",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:11.516550",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "grapesjs",
    "owner": "artf",
    "created_at": "2016-01-22T00:23:19Z",
    "updated_at": "2025-01-26T08:08:16Z",
    "pushed_at": "2025-01-23T14:05:08Z",
    "size": 113840,
    "stars": 23199,
    "forks": 4169,
    "open_issues": 23,
    "watchers": 23199,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "TypeScript": 1988576,
      "JavaScript": 152072,
      "SCSS": 66836,
      "HTML": 5780
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:28:45.870477"
  }
}