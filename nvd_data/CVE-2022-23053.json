{
  "cve_id": "CVE-2022-23053",
  "github_data": {
    "repository": "nasa/openmct",
    "fix_commit": "abc93d0ec4b104dac1ea5f8a615d06e3ab78934a",
    "related_commits": [
      "abc93d0ec4b104dac1ea5f8a615d06e3ab78934a",
      "abc93d0ec4b104dac1ea5f8a615d06e3ab78934a"
    ],
    "patch_url": "https://github.com/nasa/openmct/commit/abc93d0ec4b104dac1ea5f8a615d06e3ab78934a.patch",
    "fix_commit_details": {
      "sha": "abc93d0ec4b104dac1ea5f8a615d06e3ab78934a",
      "commit_date": "2021-10-07T18:27:20Z",
      "author": {
        "login": "khalidadil",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add back urlDefined and remove null checks",
        "length": 42,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 33,
        "additions": 8,
        "deletions": 25
      },
      "files": [
        {
          "filename": "src/plugins/conditionWidget/components/ConditionWidget.vue",
          "status": "modified",
          "additions": 4,
          "deletions": 7,
          "patch": "@@ -42,14 +42,11 @@ export default {\n         };\n     },\n     computed: {\n+        urlDefined() {\n+            return this.internalDomainObject.url && this.internalDomainObject.url.length > 0;\n+        },\n         url() {\n-            const urlDefined = this.internalDomainObject.url && this.internalDomainObject.url.length > 0;\n-            let url = urlDefined ? this.internalDomainObject.url : null;\n-            if (url) {\n-                url = sanitizeUrl(url);\n-            }\n-\n-            return url;\n+            return this.urlDefined ? sanitizeUrl(this.internalDomainObject.url) : null;\n         }\n     },\n     mounted() {"
        },
        {
          "filename": "src/plugins/hyperlink/HyperlinkLayout.vue",
          "status": "modified",
          "additions": 1,
          "deletions": 6,
          "patch": "@@ -48,12 +48,7 @@ export default {\n             return true;\n         },\n         url() {\n-            let url = this.domainObject.url;\n-            if (url) {\n-                url = sanitizeUrl(url);\n-            }\n-\n-            return url;\n+            return sanitizeUrl(this.domainObject.url);\n         }\n     }\n };"
        },
        {
          "filename": "src/plugins/summaryWidget/src/SummaryWidget.js",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -116,9 +116,7 @@ define([\n      */\r\n     SummaryWidget.prototype.addHyperlink = function (url, openNewTab) {\r\n         if (url) {\r\n-            const sanitizeUrl = urlSanitizeLib.sanitizeUrl;\r\n-            url = sanitizeUrl(url);\r\n-            this.widgetButton.attr('href', url);\r\n+            this.widgetButton.attr('href', urlSanitizeLib.sanitizeUrl(url));\r\n         } else {\r\n             this.widgetButton.removeAttr('href');\r\n         }\r"
        },
        {
          "filename": "src/plugins/summaryWidget/src/views/SummaryWidgetView.js",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -39,9 +39,7 @@ define([\n \n         let url = this.domainObject.url;\n         if (url) {\n-            const sanitizeUrl = urlSanitizeLib.sanitizeUrl;\n-            url = sanitizeUrl(url);\n-            this.widget.setAttribute('href', url);\n+            this.widget.setAttribute('href', urlSanitizeLib.sanitizeUrl(url));\n         } else {\n             this.widget.removeAttribute('href');\n         }"
        },
        {
          "filename": "src/plugins/webPage/components/WebPage.vue",
          "status": "modified",
          "additions": 1,
          "deletions": 6,
          "patch": "@@ -16,12 +16,7 @@ export default {\n     },\n     computed: {\n         url() {\n-            let url = this.currentDomainObject.url;\n-            if (url) {\n-                url = sanitizeUrl(url);\n-            }\n-\n-            return url;\n+            return sanitizeUrl(this.currentDomainObject.url);\n         }\n     }\n };"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5be103ea723d5815c6dfa1d1a375bbc931d930ce",
            "date": "2024-12-09T20:34:07Z",
            "author_login": "jvigliotta"
          },
          {
            "sha": "d74e1b19b61d636aebf41e774e75dfb0558157c2",
            "date": "2024-12-06T22:38:27Z",
            "author_login": "shefalijoshi"
          },
          {
            "sha": "5bb6a18cd4bc72bd69270ca1487d82057fa8ec46",
            "date": "2024-12-06T22:13:08Z",
            "author_login": "jvigliotta"
          },
          {
            "sha": "14b947c101ab1babe5b09b7e6982f495c55b092f",
            "date": "2024-12-04T19:27:52Z",
            "author_login": "davetsay"
          },
          {
            "sha": "61b982ab99e340490082b4cc47d58aedd04c6281",
            "date": "2024-12-04T03:33:15Z",
            "author_login": "jvigliotta"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Openmct versions 1.3.0 to 1.7.7 are vulnerable against stored XSS via the \u201cCondition Widget\u201d element, that allows the injection of malicious JavaScript into the \u2018URL\u2019 field. This issue affects: nasa openmct 1.7.7 version and prior versions; 1.3.0 version and later versions.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-20T19:15:09.297",
    "last_modified": "2024-11-21T06:47:53.590",
    "fix_date": "2021-10-07T18:27:20Z"
  },
  "references": [
    {
      "url": "https://github.com/nasa/openmct/commit/abc93d0ec4b104dac1ea5f8a615d06e3ab78934a",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nasa/openmct/commit/abc93d0ec4b104dac1ea5f8a615d06e3ab78934a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.736405",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "openmct",
    "owner": "nasa",
    "created_at": "2015-06-02T18:40:28Z",
    "updated_at": "2025-01-14T00:16:15Z",
    "pushed_at": "2025-01-10T21:12:49Z",
    "size": 85324,
    "stars": 12123,
    "forks": 1269,
    "open_issues": 955,
    "watchers": 12123,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3586543,
      "Vue": 1643596,
      "SCSS": 482078,
      "HTML": 19952,
      "Shell": 11402
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:36:38.128858"
  }
}