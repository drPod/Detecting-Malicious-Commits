{
  "cve_id": "CVE-2022-23064",
  "github_data": {
    "repository": "snipe/snipe-it",
    "fix_commit": "0c4768fd2a11ac26a61814cef23a71061bfd8bcc",
    "related_commits": [
      "0c4768fd2a11ac26a61814cef23a71061bfd8bcc",
      "0c4768fd2a11ac26a61814cef23a71061bfd8bcc"
    ],
    "patch_url": "https://github.com/snipe/snipe-it/commit/0c4768fd2a11ac26a61814cef23a71061bfd8bcc.patch",
    "fix_commit_details": {
      "sha": "0c4768fd2a11ac26a61814cef23a71061bfd8bcc",
      "commit_date": "2022-01-18T23:31:30Z",
      "author": {
        "login": "uberbrady",
        "type": "User",
        "stats": {
          "total_commits": 435,
          "average_weekly_commits": 0.9436008676789588,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 170
        }
      },
      "commit_message": {
        "title": "Force UrlGenerator's Root URL to be the base of APP_URL unless overriden",
        "length": 81,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
      },
      "files": [
        {
          "filename": ".env.example",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -145,6 +145,7 @@ APP_LOG_MAX_FILES=10\n APP_LOCKED=false\n APP_CIPHER=AES-256-CBC\n APP_FORCE_TLS=false\n+APP_ALLOW_INSECURE_HOSTS=false\n GOOGLE_MAPS_API=\n LDAP_MEM_LIM=500M\n LDAP_TIME_LIM=600"
        },
        {
          "filename": "app/Providers/AppServiceProvider.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -43,6 +43,14 @@ public function boot(UrlGenerator $url)\n                 \\Log::warning(\"'APP_FORCE_TLS' is set to true, but 'APP_URL' does not start with 'https://'. Will not force TLS on connections.\");\n             }\n         }\n+\n+        // TODO - isn't it somehow 'gauche' to check the environment directly; shouldn't we be using config() somehow?\n+        if ( ! env('APP_ALLOW_INSECURE_HOSTS')) {  // unless you set APP_ALLOW_INSECURE_HOSTS, you should PROHIBIT forging domain parts of URL via Host: headers\n+            $url_parts = parse_url(config('app.url'));\n+            $root_url = $url_parts['scheme'].'://'.$url_parts['host'].( isset($url_parts['port']) ? ':'.$url_parts['port'] : '');\n+            \\URL::forceRootUrl($root_url);\n+        }\n+\n         Schema::defaultStringLength(191);\n         Asset::observe(AssetObserver::class);\n         Accessory::observe(AccessoryObserver::class);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ca11efd3ee47a3313fc3a586f2ca2c843a7dc045",
            "date": "2025-01-13T22:23:30Z",
            "author_login": "snipe"
          },
          {
            "sha": "4a6a94a50ebc4bc86f7000aa5cb70987e20b7c80",
            "date": "2025-01-13T22:23:13Z",
            "author_login": "snipe"
          },
          {
            "sha": "2d65b381559d1817ecf201099e80201c7ad22378",
            "date": "2025-01-13T21:00:04Z",
            "author_login": "snipe"
          },
          {
            "sha": "587449ef970b3e2523da5a33a24f681cf699d382",
            "date": "2025-01-13T17:35:58Z",
            "author_login": "snipe"
          },
          {
            "sha": "06ffac9d7d0677ea74ff043a225588cc6a5a2aa8",
            "date": "2025-01-13T17:33:13Z",
            "author_login": "snipe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-74",
    "description": "In Snipe-IT, versions v3.0-alpha to v5.3.7 are vulnerable to Host Header Injection. By sending a specially crafted host header in the reset password request, it is possible to send password reset links to users which once clicked lead to an attacker controlled server and thus leading to password reset token leak. This leads to account take over.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-02T13:15:08.170",
    "last_modified": "2024-11-21T06:47:54.833",
    "fix_date": "2022-01-18T23:31:30Z"
  },
  "references": [
    {
      "url": "https://github.com/snipe/snipe-it/commit/0c4768fd2a11ac26a61814cef23a71061bfd8bcc",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-23064",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/snipe/snipe-it/commit/0c4768fd2a11ac26a61814cef23a71061bfd8bcc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-23064",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.432310",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "snipe-it",
    "owner": "snipe",
    "created_at": "2013-11-12T22:25:47Z",
    "updated_at": "2025-01-14T04:38:00Z",
    "pushed_at": "2025-01-14T12:34:04Z",
    "size": 224867,
    "stars": 11511,
    "forks": 3256,
    "open_issues": 1797,
    "watchers": 11511,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 18130643,
      "JavaScript": 4627209,
      "Blade": 1576739,
      "CSS": 250828,
      "Less": 196359,
      "Shell": 43713,
      "Dockerfile": 4408,
      "Python": 522,
      "Jinja": 229,
      "Procfile": 57
    },
    "commit_activity": {
      "total_commits_last_year": 3771,
      "avg_commits_per_week": 72.51923076923077,
      "days_active_last_year": 253
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:15:50.526515"
  }
}