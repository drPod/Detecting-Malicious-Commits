{
  "cve_id": "CVE-2022-23065",
  "github_data": {
    "repository": "vendure-ecommerce/vendure",
    "fix_commit": "69a44869112c0a5b836e2ddd3969ea9b533f51f0",
    "related_commits": [
      "69a44869112c0a5b836e2ddd3969ea9b533f51f0",
      "69a44869112c0a5b836e2ddd3969ea9b533f51f0"
    ],
    "patch_url": "https://github.com/vendure-ecommerce/vendure/commit/69a44869112c0a5b836e2ddd3969ea9b533f51f0.patch",
    "fix_commit_details": {
      "sha": "69a44869112c0a5b836e2ddd3969ea9b533f51f0",
      "commit_date": "2022-04-14T19:20:23Z",
      "author": {
        "login": "michaelbromley",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(asset-server-plugin): Fix svg XSS vulnerability",
        "length": 285,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
      },
      "files": [
        {
          "filename": "packages/asset-server-plugin/src/plugin.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -212,6 +212,7 @@ export class AssetServerPlugin implements NestModule, OnApplicationBootstrap {\n                     mimeType = (await fromBuffer(file))?.mime || 'application/octet-stream';\n                 }\n                 res.contentType(mimeType);\n+                res.setHeader('content-security-policy', `default-src 'self'`);\n                 res.send(file);\n             } catch (e) {\n                 const err = new Error('File not found');\n@@ -251,6 +252,7 @@ export class AssetServerPlugin implements NestModule, OnApplicationBootstrap {\n                             Logger.debug(`Saved cached asset: ${cachedFileName}`, loggerCtx);\n                         }\n                         res.set('Content-Type', `image/${(await image.metadata()).format}`);\n+                        res.setHeader('content-security-policy', `default-src 'self'`);\n                         res.send(imageBuffer);\n                         return;\n                     } catch (e) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd6a9fd4a27fe5d422f3abc53bdbea1dc1a94994",
            "date": "2025-01-14T07:50:23Z",
            "author_login": "dlhck"
          },
          {
            "sha": "889dd72d1b3032e12017cdb24fd57d3113ff6a99",
            "date": "2025-01-10T20:50:38Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "4349ef8e1dcae341d932a3a6623431179db075ac",
            "date": "2025-01-09T09:27:28Z",
            "author_login": "HerclasNido"
          },
          {
            "sha": "9bb155bb551c44407d0363947e9967d6cb19a15f",
            "date": "2025-01-09T09:19:35Z",
            "author_login": "Winne4r"
          },
          {
            "sha": "779ebd23b57e75886bc0eab16825897a2347db0f",
            "date": "2025-01-09T09:16:10Z",
            "author_login": "oidt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "In Vendure versions 0.1.0-alpha.2 to 1.5.1 are affected by Stored XSS vulnerability, where an attacker having catalog permission can upload a SVG file that contains malicious JavaScript into the \u201cAssets\u201d tab. The uploaded file will affect administrators as well as regular users.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-02T13:15:08.247",
    "last_modified": "2024-11-21T06:47:54.950",
    "fix_date": "2022-04-14T19:20:23Z"
  },
  "references": [
    {
      "url": "https://github.com/vendure-ecommerce/vendure/commit/69a44869112c0a5b836e2ddd3969ea9b533f51f0",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-23065",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/vendure-ecommerce/vendure/commit/69a44869112c0a5b836e2ddd3969ea9b533f51f0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-23065",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.432442",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "vendure",
    "owner": "vendure-ecommerce",
    "created_at": "2018-06-11T14:29:20Z",
    "updated_at": "2025-01-14T12:10:58Z",
    "pushed_at": "2025-01-14T07:50:24Z",
    "size": 65565,
    "stars": 5914,
    "forks": 1052,
    "open_issues": 394,
    "watchers": 5914,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "major",
      "minor"
    ],
    "languages": {
      "TypeScript": 14135610,
      "HTML": 626937,
      "SCSS": 201498,
      "JavaScript": 42179,
      "Handlebars": 19494,
      "Shell": 1233
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:47:07.809476"
  }
}