{
  "cve_id": "CVE-2022-23067",
  "github_data": {
    "repository": "ToolJet/ToolJet",
    "fix_commit": "eacbfc4c9da089ff9cda9edf8a1156390ae8a101",
    "related_commits": [
      "eacbfc4c9da089ff9cda9edf8a1156390ae8a101",
      "eacbfc4c9da089ff9cda9edf8a1156390ae8a101"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "eacbfc4c9da089ff9cda9edf8a1156390ae8a101",
      "commit_date": "2022-03-03T14:46:35Z",
      "author": {
        "login": "akshaysasidrn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix token present in referrer header (#2413)",
        "length": 44,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 19,
        "deletions": 8
      },
      "files": [
        {
          "filename": "frontend/src/App/App.jsx",
          "status": "modified",
          "additions": 14,
          "deletions": 3,
          "patch": "@@ -1,12 +1,12 @@\n import React from 'react';\n-import { Router, Route } from 'react-router-dom';\n+import { Router, Route, Redirect } from 'react-router-dom';\n import { history } from '@/_helpers';\n import { authenticationService, tooljetService } from '@/_services';\n import { PrivateRoute } from '@/_components';\n import { HomePage } from '@/HomePage';\n import { LoginPage } from '@/LoginPage';\n import { SignupPage } from '@/SignupPage';\n-import { InvitationPage } from '@/InvitationPage';\n+import { ConfirmationPage } from '@/ConfirmationPage';\n import { Authorize } from '@/Oauth2';\n import { Authorize as Oauth } from '@/Oauth';\n import { Editor, Viewer } from '@/Editor';\n@@ -118,7 +118,18 @@ class App extends React.Component {\n             <Route path=\"/signup\" component={SignupPage} />\n             <Route path=\"/forgot-password\" component={ForgotPassword} />\n             <Route path=\"/reset-password\" component={ResetPassword} />\n-            <Route path=\"/invitations/:token\" component={InvitationPage} />\n+            <Route\n+              path=\"/invitations/:token\"\n+              render={(props) => (\n+                <Redirect\n+                  to={{\n+                    pathname: '/confirm',\n+                    state: { token: props.match.params.token, search: props.location.search },\n+                  }}\n+                />\n+              )}\n+            />\n+            <Route path=\"/confirm\" component={ConfirmationPage} />\n             <PrivateRoute\n               exact\n               path=\"/apps/:id\""
        },
        {
          "filename": "frontend/src/ConfirmationPage/ConfirmationPage.jsx",
          "status": "renamed",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -3,13 +3,13 @@ import { userService } from '@/_services';\n import { toast } from 'react-hot-toast';\n import queryString from 'query-string';\n \n-class InvitationPage extends React.Component {\n+class ConfirmationPage extends React.Component {\n   constructor(props) {\n     super(props);\n \n     this.state = {\n       isLoading: false,\n-      newSignup: queryString.parse(props.location.search).signup,\n+      newSignup: queryString.parse(props.location.state.search).signup,\n     };\n     this.formRef = React.createRef(null);\n   }\n@@ -26,7 +26,7 @@ class InvitationPage extends React.Component {\n   setPassword = (e) => {\n     e.preventDefault();\n \n-    const token = this.props.match.params.token;\n+    const token = this.props.location.state.token;\n     const { password, organization, role, newSignup, firstName, lastName, password_confirmation } = this.state;\n     this.setState({ isLoading: true });\n \n@@ -203,4 +203,4 @@ class InvitationPage extends React.Component {\n   }\n }\n \n-export { InvitationPage };\n+export { ConfirmationPage };"
        },
        {
          "filename": "frontend/src/ConfirmationPage/index.js",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+export * from './ConfirmationPage';"
        },
        {
          "filename": "frontend/src/InvitationPage/index.js",
          "status": "removed",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -1 +0,0 @@\n-export * from './InvitationPage';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d37505eadbadafa3907924ffc6e2d83bb9839c13",
            "date": "2025-01-24T10:12:17Z",
            "author_login": "RudraPratik30"
          },
          {
            "sha": "f35057164fdaadabb16fcbbab940d9502de7bbbd",
            "date": "2025-01-20T07:10:42Z",
            "author_login": "Anush008"
          },
          {
            "sha": "d2b0eca09192002236ccc31e9f169bf15763e282",
            "date": "2025-01-20T06:26:41Z",
            "author_login": "PriteshKiri"
          },
          {
            "sha": "85f47299179594f29ee314823d442cb72d90748c",
            "date": "2025-01-17T14:00:11Z",
            "author_login": "johnsoncherian"
          },
          {
            "sha": "081d18700ad1c5d3501f13b980fe62c1b1d9a192",
            "date": "2025-01-17T13:17:30Z",
            "author_login": "RudraPratik30"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-200",
    "description": "ToolJet versions v0.5.0 to v1.2.2 are vulnerable to token leakage via Referer header that leads to account takeover . If the user opens the invite link/signup link and then clicks on any external links within the page, it leaks the password set token/signup token in the referer header. Using these tokens the attacker can access the user\u2019s account.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-18T14:15:08.353",
    "last_modified": "2024-11-21T06:47:55.207",
    "fix_date": "2022-03-03T14:46:35Z"
  },
  "references": [
    {
      "url": "https://github.com/ToolJet/ToolJet/commit/eacbfc4c9da089ff9cda9edf8a1156390ae8a101",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-23067",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ToolJet/ToolJet/commit/eacbfc4c9da089ff9cda9edf8a1156390ae8a101",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2022-23067",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.130662",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ToolJet",
    "owner": "ToolJet",
    "created_at": "2021-03-30T08:51:34Z",
    "updated_at": "2025-01-26T05:45:56Z",
    "pushed_at": "2025-01-24T13:49:20Z",
    "size": 1428944,
    "stars": 33729,
    "forks": 4378,
    "open_issues": 1118,
    "watchers": 33729,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "JavaScript": 5181340,
      "TypeScript": 1934614,
      "SCSS": 835111,
      "HTML": 31625,
      "Shell": 25589,
      "EJS": 17681,
      "Dockerfile": 15959,
      "Handlebars": 11680,
      "MDX": 11289,
      "CSS": 3790,
      "HCL": 1872,
      "Procfile": 62,
      "Batchfile": 61
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T08:34:23.037399"
  }
}