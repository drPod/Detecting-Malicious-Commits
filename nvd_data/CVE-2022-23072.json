{
  "cve_id": "CVE-2022-23072",
  "github_data": {
    "repository": "TandoorRecipes/recipes",
    "fix_commit": "7b2117c0190d4f541ba4cc7ee4122f04738c4ac6",
    "related_commits": [
      "7b2117c0190d4f541ba4cc7ee4122f04738c4ac6",
      "7b2117c0190d4f541ba4cc7ee4122f04738c4ac6"
    ],
    "patch_url": "https://github.com/TandoorRecipes/recipes/commit/7b2117c0190d4f541ba4cc7ee4122f04738c4ac6.patch",
    "fix_commit_details": {
      "sha": "7b2117c0190d4f541ba4cc7ee4122f04738c4ac6",
      "commit_date": "2022-05-17T19:24:27Z",
      "author": {
        "login": "vabene1111",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "improved output sanitization of several views",
        "length": 45,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 67959,
        "additions": 56007,
        "deletions": 11952
      },
      "files": [
        {
          "filename": "vue/package-lock.json",
          "status": "added",
          "additions": 43534,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "vue/package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -30,6 +30,7 @@\n     \"vue-infinite-loading\": \"^2.4.5\",\n     \"vue-multiselect\": \"^2.1.6\",\n     \"vue-property-decorator\": \"^9.1.2\",\n+    \"vue-sanitize\": \"^0.2.2\",\n     \"vue-simple-calendar\": \"^5.0.1\",\n     \"vue-template-compiler\": \"^2.6.14\",\n     \"vue2-touch-events\": \"^3.2.2\",\n@@ -86,4 +87,4 @@\n     \"@vue/cli-plugin-pwa/workbox-webpack-plugin\": \"^5.1.3\",\n     \"coa\": \"2.0.2\"\n   }\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "vue/src/apps/ExportResponseView/ExportResponseView.vue",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -43,7 +43,7 @@\n             <div class=\"row\">\n                 <div class=\"col col-md-12\">\n                     <label for=\"id_textarea\">{{ $t(\"Information\") }}</label>\n-                    <textarea id=\"id_textarea\" ref=\"output_text\" class=\"form-control\" style=\"height: 50vh\" v-html=\"export_info.msg\" disabled></textarea>\n+                    <textarea id=\"id_textarea\" ref=\"output_text\" class=\"form-control\" style=\"height: 50vh\" v-html=\"$sanitize(export_info.msg)\" disabled></textarea>\n                 </div>\n             </div>\n             <br />\n@@ -65,7 +65,8 @@ import LoadingSpinner from \"@/components/LoadingSpinner\"\n import { ApiApiFactory } from \"@/utils/openapi/api.ts\"\n \n Vue.use(BootstrapVue)\n-\n+import VueSanitize from \"vue-sanitize\";\n+Vue.use(VueSanitize);\n export default {\n     name: \"ExportResponseView\",\n     mixins: [ResolveUrlMixin, ToastMixin],"
        },
        {
          "filename": "vue/src/apps/ImportResponseView/ImportResponseView.vue",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -143,7 +143,7 @@\n                                 <b-card>\n                                     <textarea id=\"id_textarea\" ref=\"output_text\" class=\"form-control\"\n                                               style=\"height: 50vh\"\n-                                              v-html=\"import_info.msg\"\n+                                              v-html=\"$sanitize(import_info.msg)\"\n                                               disabled></textarea>\n                                 </b-card>\n                             </b-collapse>\n@@ -168,7 +168,9 @@ import {ResolveUrlMixin, ToastMixin, RandomIconMixin} from \"@/utils/utils\";\n import LoadingSpinner from \"@/components/LoadingSpinner\";\n \n import {ApiApiFactory} from \"@/utils/openapi/api.ts\";\n+import VueSanitize from \"vue-sanitize\";\n \n+Vue.use(VueSanitize);\n Vue.use(BootstrapVue)\n \n export default {"
        },
        {
          "filename": "vue/src/components/Badges/OnHand.vue",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -1,11 +1,15 @@\n <template>\n     <span>\n-        <b-button v-if=\"!item.ignore_shopping\" class=\"btn text-decoration-none fas px-1 py-0 border-0\" variant=\"link\" v-b-popover.hover.html :title=\"Title\" :class=\"IconClass\" @click=\"toggleOnHand\" />\n+        <b-button v-if=\"!item.ignore_shopping\" class=\"btn text-decoration-none fas px-1 py-0 border-0\" variant=\"link\" v-b-popover.hover.html :title=\"$sanitize(Title)\" :class=\"IconClass\" @click=\"toggleOnHand\" />\n     </span>\n </template>\n \n <script>\n import { ApiMixin } from \"@/utils/utils\"\n+import Vue from \"vue\"\n+import VueSanitize from \"vue-sanitize\";\n+Vue.use(VueSanitize);\n+\n \n export default {\n     name: \"OnHandBadge\","
        },
        {
          "filename": "vue/src/components/Badges/Shopping.vue",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -4,7 +4,7 @@\n             <i\n                 class=\"fas\"\n                 v-b-popover.hover.html\n-                :title=\"[shopping ? $t('RemoveFoodFromShopping', { food: item.name }) : $t('AddFoodToShopping', { food: item.name })]\"\n+                :title=\"[shopping ? $t('RemoveFoodFromShopping', { food: $sanitize(item.name) }) : $t('AddFoodToShopping', { food: $sanitize(item.name) })]\"\n                 :class=\"[shopping ? 'text-success fa-shopping-cart' : 'text-muted fa-cart-plus']\"\n             />\n         </b-button>\n@@ -22,6 +22,9 @@\n \n <script>\n import { ApiMixin, StandardToasts } from \"@/utils/utils\"\n+import Vue from \"vue\"\n+import VueSanitize from \"vue-sanitize\";\n+Vue.use(VueSanitize);\n \n export default {\n     name: \"ShoppingBadge\","
        },
        {
          "filename": "vue/src/components/GenericHorizontalCard.vue",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -93,7 +93,7 @@\n                 \"\n             >\n                 <i class=\"fas fa-expand-arrows-alt fa-fw\"></i> <b>{{ $t(\"Move\") }}</b\n-                >: <span v-html=\"$t('move_confirmation', { child: source.name, parent: item.name })\"></span>\n+                >: <span v-html=\"$t('move_confirmation', { child: $sanitize(source.name), parent: $sanitize(item.name) })\"></span>\n             </b-list-group-item>\n             <b-list-group-item\n                 v-if=\"useMerge\"\n@@ -104,7 +104,7 @@\n                 \"\n             >\n                 <i class=\"fas fa-compress-arrows-alt fa-fw\"></i> <b>{{ $t(\"Merge\") }}</b\n-                >: <span v-html=\"$t('merge_confirmation', { source: source.name, target: item.name })\"></span>\n+                >: <span v-html=\"$t('merge_confirmation', { source: $sanitize(source.name), target: $sanitize(item.name) })\"></span>\n             </b-list-group-item>\n             <b-list-group-item\n                 v-if=\"useMerge\"\n@@ -115,7 +115,7 @@\n                 \"\n             >\n                 <i class=\"fas fa-robot fa-fw\"></i> <b>{{ $t(\"Merge\") }} & {{ $t(\"Automate\") }}</b\n-                >: <span v-html=\"$t('merge_confirmation', { source: source.name, target: item.name })\"></span> {{ $t(\"create_rule\") }}\n+                >: <span v-html=\"$t('merge_confirmation', { source: $sanitize(source.name), target: $sanitize(item.name) })\"></span> {{ $t(\"create_rule\") }}\n                 <b-badge v-b-tooltip.hover :title=\"$t('warning_feature_beta')\">BETA</b-badge>\n             </b-list-group-item>\n             <b-list-group-item action v-on:click=\"closeMenu()\">\n@@ -134,6 +134,9 @@ import RecipeCard from \"@/components/RecipeCard\"\n import { mixin as clickaway } from \"vue-clickaway\"\n import { createPopper } from \"@popperjs/core\"\n import {ApiMixin} from \"@/utils/utils\";\n+import Vue from \"vue\"\n+import VueSanitize from \"vue-sanitize\";\n+Vue.use(VueSanitize);\n \n export default {\n     name: \"GenericHorizontalCard\","
        },
        {
          "filename": "vue/src/components/IngredientComponent.vue",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -59,6 +59,10 @@ import { calculateAmount, ResolveUrlMixin, ApiMixin } from \"@/utils/utils\"\n import OnHandBadge from \"@/components/Badges/OnHand\"\n import ShoppingBadge from \"@/components/Badges/Shopping\"\n \n+import Vue from \"vue\"\n+import VueSanitize from \"vue-sanitize\";\n+Vue.use(VueSanitize);\n+\n export default {\n     name: \"IngredientComponent\",\n     components: { OnHandBadge, ShoppingBadge },\n@@ -124,7 +128,7 @@ export default {\n     },\n     methods: {\n         calculateAmount: function (x) {\n-            return calculateAmount(x, this.ingredient_factor)\n+            return this.$sanitize(calculateAmount(x, this.ingredient_factor))\n         },\n         // sends parent recipe ingredient to notify complete has been toggled\n         done: function () {"
        },
        {
          "filename": "vue/src/components/NutritionComponent.vue",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -55,6 +55,10 @@\n <script>\n \n import {calculateAmount, calculateEnergy, energyHeading} from \"@/utils/utils\";\n+import Vue from \"vue\"\n+import VueSanitize from \"vue-sanitize\";\n+Vue.use(VueSanitize);\n+\n \n export default {\n   name: 'NutritionComponent',\n@@ -64,13 +68,13 @@ export default {\n   },\n   methods: {\n     calculateAmount: function (x) {\n-      return calculateAmount(x, this.ingredient_factor)\n+      return this.$sanitize(calculateAmount(x, this.ingredient_factor))\n     },\n     calculateEnergy: function (x) {\n-      return calculateEnergy(x, this.ingredient_factor)\n+      return this.$sanitize(calculateEnergy(x, this.ingredient_factor))\n     },\n     energy: function (x) {\n-      return energyHeading()\n+      return this.$sanitize(energyHeading())\n     }\n   }\n }"
        },
        {
          "filename": "vue/yarn.lock",
          "status": "modified",
          "additions": 12438,
          "deletions": 11939,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f25de4b4ce3ac284a538ed132b4024a90c17b14f",
            "date": "2025-01-05T10:38:35Z",
            "author_login": "vabene1111"
          },
          {
            "sha": "6444680e067c11e5579656e57119a4e03a324322",
            "date": "2025-01-01T07:16:19Z",
            "author_login": "vabene1111"
          },
          {
            "sha": "c604369e867be22c811246dc35ff1451e830dfc9",
            "date": "2025-01-01T00:33:49Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "fd4236672e232a0f105828e22214bc1afedb2058",
            "date": "2024-12-29T12:46:17Z",
            "author_login": "vabene1111"
          },
          {
            "sha": "00148a29931c266db192b88580c3f70d35f9e8b1",
            "date": "2024-12-29T12:44:43Z",
            "author_login": "vabene1111"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "In Recipes, versions 1.0.5 through 1.2.5 are vulnerable to Stored Cross-Site Scripting (XSS), in \u201cAdd to Cart\u201d functionality. When a victim accesses the food list page, then adds a new Food with a malicious javascript payload in the \u2018Name\u2019 parameter and clicks on the Add to Shopping Cart icon, an XSS payload will trigger. A low privileged attacker will have the victim's API key and can lead to admin's account takeover.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2022-06-21T08:15:07.407",
    "last_modified": "2024-11-21T06:47:55.613",
    "fix_date": "2022-05-17T19:24:27Z"
  },
  "references": [
    {
      "url": "https://github.com/TandoorRecipes/recipes/commit/7b2117c0190d4f541ba4cc7ee4122f04738c4ac6",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.mend.io/vulnerability-database/CVE-2022-23072",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TandoorRecipes/recipes/commit/7b2117c0190d4f541ba4cc7ee4122f04738c4ac6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.mend.io/vulnerability-database/CVE-2022-23072",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.463933",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "recipes",
    "owner": "TandoorRecipes",
    "created_at": "2019-11-13T20:34:02Z",
    "updated_at": "2025-01-14T08:32:24Z",
    "pushed_at": "2025-01-13T16:56:58Z",
    "size": 63549,
    "stars": 5822,
    "forks": 606,
    "open_issues": 319,
    "watchers": 5822,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "HTML": 5670582,
      "Python": 1226241,
      "JavaScript": 858487,
      "TypeScript": 836415,
      "Vue": 759673,
      "CSS": 113784,
      "Shell": 3302,
      "Dockerfile": 2745,
      "C": 73
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:42:51.807571"
  }
}