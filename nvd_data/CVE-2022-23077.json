{
  "cve_id": "CVE-2022-23077",
  "github_data": {
    "repository": "HabitRPG/habitica",
    "fix_commit": "5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f",
    "related_commits": [
      "5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f",
      "5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f"
    ],
    "patch_url": "https://github.com/HabitRPG/habitica/commit/5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f.patch",
    "fix_commit_details": {
      "sha": "5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f",
      "commit_date": "2022-05-20T19:29:15Z",
      "author": {
        "login": "SabreCat",
        "type": "User",
        "stats": {
          "total_commits": 5848,
          "average_weekly_commits": 8.63810930576071,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 551
        }
      },
      "commit_message": {
        "title": "fix(login): catch double-slash exploit",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "website/client/src/components/auth/registerLoginReset.vue",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -757,8 +757,8 @@ export default {\n     }, 500),\n     sanitizeRedirect (redirect) {\n       if (!redirect) return '/';\n-      let sanitizedString = DOMPurify.sanitize(redirect);\n-      if (sanitizedString.slice(0, 1) !== '/') sanitizedString = `/${sanitizedString}`;\n+      let sanitizedString = DOMPurify.sanitize(redirect).replace(/\\\\|\\/\\/|\\./g, '');\n+      sanitizedString = `/${sanitizedString}`;\n       return sanitizedString;\n     },\n     async register () {"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "30f1820a49d32c5cd4771e80d83f0e9bcea66854",
            "date": "2025-01-09T15:02:14Z",
            "author_login": "SabreCat"
          },
          {
            "sha": "3bb6c391af987137ac6ae9e3ca2c61c0da361979",
            "date": "2025-01-09T13:46:54Z",
            "author_login": "weblate"
          },
          {
            "sha": "a0383c785a05fcf7973003b9f87a0be7e9f91b72",
            "date": "2025-01-08T21:18:06Z",
            "author_login": "SabreCat"
          },
          {
            "sha": "99790c05f4527c968a83683db1f399e07f8771de",
            "date": "2025-01-06T22:22:26Z",
            "author_login": "SabreCat"
          },
          {
            "sha": "fc5fec9bfea76174369fe0a59e84b69cb32b1667",
            "date": "2025-01-06T22:18:24Z",
            "author_login": "weblate"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "In habitica versions v4.119.0 through v4.232.2 are vulnerable to DOM XSS via the login page.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-22T12:15:07.997",
    "last_modified": "2024-11-21T06:47:55.983",
    "fix_date": "2022-05-20T19:29:15Z"
  },
  "references": [
    {
      "url": "https://github.com/HabitRPG/habitica/commit/5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.mend.io/vulnerability-database/CVE-2022-23077",
      "source": "vulnerabilitylab@mend.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/HabitRPG/habitica/commit/5bcfdbe066e8c899f3ecf3fdcdbacc2ecba7f02f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.mend.io/vulnerability-database/CVE-2022-23077",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.467918",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "habitica",
    "owner": "HabitRPG",
    "created_at": "2012-06-06T22:49:48Z",
    "updated_at": "2025-01-14T10:44:39Z",
    "pushed_at": "2025-01-13T21:44:42Z",
    "size": 1653155,
    "stars": 12374,
    "forks": 4150,
    "open_issues": 189,
    "watchers": 12374,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "release"
    ],
    "languages": {
      "JavaScript": 4580291,
      "CSS": 2107677,
      "Vue": 1892957,
      "SCSS": 55260,
      "CoffeeScript": 6978,
      "HTML": 3894,
      "Shell": 681,
      "Handlebars": 474,
      "Procfile": 46
    },
    "commit_activity": {
      "total_commits_last_year": 820,
      "avg_commits_per_week": 15.76923076923077,
      "days_active_last_year": 149
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:03:01.325019"
  }
}