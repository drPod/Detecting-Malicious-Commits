{
  "cve_id": "CVE-2022-23613",
  "github_data": {
    "repository": "neutrinolabs/xrdp",
    "fix_commit": "4def30ab8ea445cdc06832a44c3ec40a506a0ffa",
    "related_commits": [
      "4def30ab8ea445cdc06832a44c3ec40a506a0ffa",
      "4def30ab8ea445cdc06832a44c3ec40a506a0ffa"
    ],
    "patch_url": "https://github.com/neutrinolabs/xrdp/commit/4def30ab8ea445cdc06832a44c3ec40a506a0ffa.patch",
    "fix_commit_details": {
      "sha": "4def30ab8ea445cdc06832a44c3ec40a506a0ffa",
      "commit_date": "2022-02-07T06:18:15Z",
      "author": {
        "login": "metalefty",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-8h98-h426-xf32",
        "length": 92,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 5,
        "deletions": 3
      },
      "files": [
        {
          "filename": "sesman/sesman.c",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -276,16 +276,17 @@ sesman_close_all(void)\n static int\n sesman_data_in(struct trans *self)\n {\n+#define HEADER_SIZE 8\n     int version;\n     int size;\n \n     if (self->extra_flags == 0)\n     {\n         in_uint32_be(self->in_s, version);\n         in_uint32_be(self->in_s, size);\n-        if (size > self->in_s->size)\n+        if (size < HEADER_SIZE || size > self->in_s->size)\n         {\n-            LOG(LOG_LEVEL_ERROR, \"sesman_data_in: bad message size\");\n+            LOG(LOG_LEVEL_ERROR, \"sesman_data_in: bad message size %d\", size);\n             return 1;\n         }\n         self->header_size = size;\n@@ -302,11 +303,12 @@ sesman_data_in(struct trans *self)\n             return 1;\n         }\n         /* reset for next message */\n-        self->header_size = 8;\n+        self->header_size = HEADER_SIZE;\n         self->extra_flags = 0;\n         init_stream(self->in_s, 0); /* Reset input stream pointers */\n     }\n     return 0;\n+#undef HEADER_SIZE\n }\n \n /******************************************************************************/"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a0f1b65aee5343bc6d8a9520cefd96948a1b9102",
            "date": "2025-01-13T11:48:30Z",
            "author_login": "matt335672"
          },
          {
            "sha": "b04743066d1edc18eeb6d9984bc4a302e5a3eb85",
            "date": "2025-01-13T10:11:51Z",
            "author_login": "matt335672"
          },
          {
            "sha": "d98c883dfb57b3b05516b7adbd4ee237259fa7ee",
            "date": "2025-01-09T11:34:41Z",
            "author_login": "matt335672"
          },
          {
            "sha": "99b6aaff6ce12687da0d998a27f67d9b384eac53",
            "date": "2025-01-09T10:37:40Z",
            "author_login": "matt335672"
          },
          {
            "sha": "35179f0fc54dfae36fcb0eab92a16b67fe6402c0",
            "date": "2025-01-09T10:17:00Z",
            "author_login": "matt335672"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-191",
    "description": "xrdp is an open source remote desktop protocol (RDP) server. In affected versions an integer underflow leading to a heap overflow in the sesman server allows any unauthenticated attacker which is able to locally access a sesman server to execute code as root. This vulnerability has been patched in version 0.9.18.1 and above. Users are advised to upgrade. There are no known workarounds.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-07T22:15:08.650",
    "last_modified": "2024-11-21T06:48:56.043",
    "fix_date": "2022-02-07T06:18:15Z"
  },
  "references": [
    {
      "url": "https://github.com/neutrinolabs/xrdp/commit/4def30ab8ea445cdc06832a44c3ec40a506a0ffa",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/security/advisories/GHSA-8h98-h426-xf32",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/K5ONRGARKHGFU2CIEQ7E6M6VJZEM5XWW/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/U3XGFJNQMNXHBD3J7CBM4YURYEDXROWZ/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/commit/4def30ab8ea445cdc06832a44c3ec40a506a0ffa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/security/advisories/GHSA-8h98-h426-xf32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/K5ONRGARKHGFU2CIEQ7E6M6VJZEM5XWW/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/U3XGFJNQMNXHBD3J7CBM4YURYEDXROWZ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.145579",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xrdp",
    "owner": "neutrinolabs",
    "created_at": "2011-04-25T14:31:17Z",
    "updated_at": "2025-01-13T11:48:35Z",
    "pushed_at": "2025-01-13T11:48:30Z",
    "size": 16515,
    "stars": 5870,
    "forks": 1738,
    "open_issues": 268,
    "watchers": 5870,
    "has_security_policy": false,
    "default_branch": "devel",
    "protected_branches": [
      "devel"
    ],
    "languages": {
      "C": 4054760,
      "M4": 62000,
      "Shell": 47300,
      "C++": 41259,
      "Makefile": 29077,
      "ActionScript": 1532,
      "QMake": 821
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:37:05.964520"
  }
}