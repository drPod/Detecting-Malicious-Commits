{
  "cve_id": "CVE-2022-23624",
  "github_data": {
    "repository": "frouriojs/frourio-express",
    "fix_commit": "73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2",
    "related_commits": [
      "73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2",
      "73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2"
    ],
    "patch_url": "https://github.com/frouriojs/frourio-express/commit/73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2.patch",
    "fix_commit_details": {
      "sha": "73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2",
      "commit_date": "2022-02-04T08:58:54Z",
      "author": {
        "login": "LumaKernel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "feat(validation): use class-transformer to support validation of nested objects",
        "length": 143,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 241,
        "additions": 212,
        "deletions": 29
      },
      "files": [
        {
          "filename": "__test__/index.spec.ts",
          "status": "modified",
          "additions": 83,
          "deletions": 0,
          "patch": "@@ -204,6 +204,89 @@ test('POST: 400', async () => {\n   ).rejects.toHaveProperty('response.status', 400)\n })\n \n+test('POST: nested validation', async () => {\n+  const res1 = await client.users.post({\n+    body: {\n+      id: 123,\n+      name: 'foo',\n+      location: {\n+        country: 'JP',\n+        stateProvince: 'Tokyo'\n+      }\n+    }\n+  })\n+  expect(res1.status).toBe(204)\n+\n+  // Note that extraneous properties are allowed by default\n+  const res2 = await client.users.post({\n+    body: {\n+      id: 123,\n+      name: 'foo',\n+      location: {\n+        country: 'JP',\n+        stateProvince: 'Tokyo',\n+        extra1: {\n+          extra1a: 'bar',\n+          extra1b: 'baz'\n+        }\n+      },\n+      extra2: 'qux'\n+    } as any\n+  })\n+  expect(res2.status).toBe(204)\n+})\n+\n+test('POST: 400 (nested validation)', async () => {\n+  // id is not a number\n+  await expect(\n+    client.users.post({\n+      body: {\n+        id: '123',\n+        name: 'foo',\n+        location: {\n+          country: 'JP',\n+          stateProvince: 'Tokyo'\n+        }\n+      } as any\n+    })\n+  ).rejects.toHaveProperty('response.status', 400)\n+\n+  // location is missing\n+  await expect(\n+    client.users.post({\n+      body: { id: 123, name: 'foo' } as any\n+    })\n+  ).rejects.toHaveProperty('response.status', 400)\n+\n+  // country is not a valid 2-letter country code\n+  await expect(\n+    client.users.post({\n+      body: {\n+        id: 123,\n+        name: 'foo',\n+        location: {\n+          country: 'XX',\n+          stateProvince: 'Tokyo'\n+        }\n+      } as any\n+    })\n+  ).rejects.toHaveProperty('response.status', 400)\n+\n+  // stateProvince is not a string\n+  await expect(\n+    client.users.post({\n+      body: {\n+        id: 123,\n+        name: 'foo',\n+        location: {\n+          country: 'JP',\n+          stateProvince: 1234\n+        }\n+      } as any\n+    })\n+  ).rejects.toHaveProperty('response.status', 400)\n+})\n+\n test('controller dependency injection', async () => {\n   let val = 0\n   const id = '5'"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -97,6 +97,7 @@\n     \"@typescript-eslint/eslint-plugin\": \"^4.28.1\",\n     \"@typescript-eslint/parser\": \"^4.28.1\",\n     \"axios\": \"^0.21.1\",\n+    \"class-transformer\": \"^0.5.1\",\n     \"class-validator\": \"^0.13.1\",\n     \"eslint\": \"^7.30.0\",\n     \"eslint-config-prettier\": \"^8.3.0\",\n@@ -111,6 +112,7 @@\n     \"multer\": \"^1.4.2\",\n     \"node-fetch\": \"^2.6.1\",\n     \"prettier\": \"^2.3.2\",\n+    \"reflect-metadata\": \"^0.1.13\",\n     \"rimraf\": \"^3.0.2\",\n     \"standard-version\": \"^9.3.0\",\n     \"ts-jest\": \"^27.0.3\","
        },
        {
          "filename": "servers/all/$server.ts",
          "status": "modified",
          "additions": 13,
          "deletions": 7,
          "patch": "@@ -1,13 +1,17 @@\n /* eslint-disable */\n // prettier-ignore\n+import 'reflect-metadata'\n+// prettier-ignore\n+import { ClassTransformOptions, plainToInstance } from 'class-transformer'\n+// prettier-ignore\n+import { validateOrReject, ValidatorOptions } from 'class-validator'\n+// prettier-ignore\n import path from 'path'\n // prettier-ignore\n import express, { Express, RequestHandler, Request } from 'express'\n // prettier-ignore\n import multer, { Options } from 'multer'\n // prettier-ignore\n-import { validateOrReject, ValidatorOptions } from 'class-validator'\n-// prettier-ignore\n import fastJson, { Schema } from 'fast-json-stringify'\n // prettier-ignore\n import * as Validators from './validators'\n@@ -47,6 +51,7 @@ import type { LowerHttpMethod, AspidaMethods, HttpStatusOk, AspidaMethodParams }\n // prettier-ignore\n export type FrourioOptions = {\n   basePath?: string\n+  transformer?: ClassTransformOptions\n   validator?: ValidatorOptions\n   multer?: Options\n }\n@@ -305,6 +310,7 @@ const asyncMethodToHandlerWithSchema = (\n // prettier-ignore\n export default (app: Express, options: FrourioOptions = {}) => {\n   const basePath = options.basePath ?? ''\n+  const transformerOptions: ClassTransformOptions = { enableCircularCheck: true, ...options.transformer }\n   const validatorOptions: ValidatorOptions = { validationError: { target: false }, ...options.validator }\n   const hooks0 = hooksFn0(app)\n   const hooks1 = hooksFn1(app)\n@@ -332,7 +338,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     callParserIfExistsQuery(parseNumberTypeQueryParams([['requiredNum', false, false], ['optionalNum', true, false], ['optionalNumArr', true, true], ['emptyNum', true, false], ['requiredNumArr', false, true]])),\n     callParserIfExistsQuery(parseBooleanTypeQueryParams([['bool', false, false], ['optionalBool', true, false], ['boolArray', false, true], ['optionalBoolArray', true, true]])),\n     createValidateHandler(req => [\n-      Object.keys(req.query).length ? validateOrReject(Object.assign(new Validators.Query(), req.query), validatorOptions) : null\n+      Object.keys(req.query).length ? validateOrReject(plainToInstance(Validators.Query, req.query, transformerOptions), validatorOptions) : null\n     ]),\n     asyncMethodToHandlerWithSchema(controller0.get, responseSchema0.get)\n   ])\n@@ -346,8 +352,8 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     uploader,\n     formatMulterData([]),\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.Query(), req.query), validatorOptions),\n-      validateOrReject(Object.assign(new Validators.Body(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.Query, req.query, transformerOptions), validatorOptions),\n+      validateOrReject(plainToInstance(Validators.Body, req.body, transformerOptions), validatorOptions)\n     ]),\n     methodToHandler(controller0.post)\n   ])\n@@ -372,7 +378,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     uploader,\n     formatMulterData([['requiredArr', false], ['optionalArr', true], ['empty', true], ['vals', false], ['files', false]]),\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.MultiForm(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.MultiForm, req.body, transformerOptions), validatorOptions)\n     ]),\n     methodToHandler(controller3.post)\n   ])\n@@ -417,7 +423,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     hooks0.preParsing,\n     parseJSONBoby,\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.UserInfo(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.UserInfo, req.body, transformerOptions), validatorOptions)\n     ]),\n     ...ctrlHooks1.preHandler,\n     methodToHandler(controller7.post)"
        },
        {
          "filename": "servers/all/api/users/_userId@number/controller.ts",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -5,5 +5,15 @@ export type AdditionalRequest = {\n }\n \n export default defineController(() => ({\n-  get: ({ params }) => ({ status: 200, body: { id: params.userId, name: 'bbb' } })\n+  get: ({ params }) => ({\n+    status: 200,\n+    body: {\n+      id: params.userId,\n+      name: 'bbb',\n+      location: {\n+        country: 'JP',\n+        stateProvince: 'Tokyo'\n+      }\n+    }\n+  })\n }))"
        },
        {
          "filename": "servers/all/api/users/controller.ts",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -16,6 +16,18 @@ const hooks = defineHooks(() => ({\n export { hooks, AdditionalRequest }\n \n export default defineController(() => ({\n-  get: async () => ({ status: 200, body: [{ id: 1, name: 'aa' }] }),\n+  get: async () => ({\n+    status: 200,\n+    body: [\n+      {\n+        id: 1,\n+        name: 'aa',\n+        location: {\n+          country: 'JP',\n+          stateProvince: 'Tokyo'\n+        }\n+      }\n+    ]\n+  }),\n   post: () => ({ status: 204 })\n }))"
        },
        {
          "filename": "servers/all/validators/index.ts",
          "status": "modified",
          "additions": 20,
          "deletions": 1,
          "patch": "@@ -1,3 +1,4 @@\n+import { Type } from 'class-transformer'\n import {\n   IsNumberString,\n   IsBooleanString,\n@@ -8,7 +9,10 @@ import {\n   IsString,\n   Allow,\n   IsOptional,\n-  ArrayNotEmpty\n+  ArrayNotEmpty,\n+  IsISO31661Alpha2,\n+  ValidateNested,\n+  IsObject\n } from 'class-validator'\n import type { ReadStream } from 'fs'\n \n@@ -52,12 +56,27 @@ export class Body {\n   file: File | ReadStream\n }\n \n+export class UserInfoLocation {\n+  @IsISO31661Alpha2()\n+  country: string\n+\n+  @IsString()\n+  stateProvince: string\n+}\n+\n export class UserInfo {\n   @IsInt()\n   id: number\n \n   @MaxLength(20)\n   name: string\n+\n+  // @Type decorator is required to validate nested object properly\n+  // @IsObject decorator is required or class-validator will not throw an error when the property is missing\n+  @ValidateNested()\n+  @IsObject()\n+  @Type(() => UserInfoLocation)\n+  location: UserInfoLocation\n }\n \n export class MultiForm {"
        },
        {
          "filename": "servers/noMulter/$server.ts",
          "status": "modified",
          "additions": 11,
          "deletions": 5,
          "patch": "@@ -1,9 +1,13 @@\n /* eslint-disable */\n // prettier-ignore\n-import express, { Express, RequestHandler, Request } from 'express'\n+import 'reflect-metadata'\n+// prettier-ignore\n+import { ClassTransformOptions, plainToInstance } from 'class-transformer'\n // prettier-ignore\n import { validateOrReject, ValidatorOptions } from 'class-validator'\n // prettier-ignore\n+import express, { Express, RequestHandler, Request } from 'express'\n+// prettier-ignore\n import * as Validators from './validators'\n // prettier-ignore\n import hooksFn0 from './api/hooks'\n@@ -27,6 +31,7 @@ import type { LowerHttpMethod, AspidaMethods, HttpStatusOk, AspidaMethodParams }\n // prettier-ignore\n export type FrourioOptions = {\n   basePath?: string\n+  transformer?: ClassTransformOptions\n   validator?: ValidatorOptions\n }\n \n@@ -144,6 +149,7 @@ const asyncMethodToHandler = (\n // prettier-ignore\n export default (app: Express, options: FrourioOptions = {}) => {\n   const basePath = options.basePath ?? ''\n+  const transformerOptions: ClassTransformOptions = { enableCircularCheck: true, ...options.transformer }\n   const validatorOptions: ValidatorOptions = { validationError: { target: false }, ...options.validator }\n   const hooks0 = hooksFn0(app)\n   const hooks1 = hooksFn1(app)\n@@ -160,7 +166,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     hooks0.onRequest,\n     ctrlHooks0.onRequest,\n     createValidateHandler(req => [\n-      Object.keys(req.query).length ? validateOrReject(Object.assign(new Validators.Query(), req.query), validatorOptions) : null\n+      Object.keys(req.query).length ? validateOrReject(plainToInstance(Validators.Query, req.query, transformerOptions), validatorOptions) : null\n     ]),\n     asyncMethodToHandler(controller0.get)\n   ])\n@@ -170,8 +176,8 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     ctrlHooks0.onRequest,\n     parseJSONBoby,\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.Query(), req.query), validatorOptions),\n-      validateOrReject(Object.assign(new Validators.Body(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.Query, req.query, transformerOptions), validatorOptions),\n+      validateOrReject(plainToInstance(Validators.Body, req.body, transformerOptions), validatorOptions)\n     ]),\n     methodToHandler(controller0.post)\n   ])\n@@ -209,7 +215,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     hooks1.onRequest,\n     parseJSONBoby,\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.UserInfo(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.UserInfo, req.body, transformerOptions), validatorOptions)\n     ]),\n     ...ctrlHooks1.preHandler,\n     methodToHandler(controller4.post)"
        },
        {
          "filename": "servers/noTypedParams/$server.ts",
          "status": "modified",
          "additions": 13,
          "deletions": 7,
          "patch": "@@ -1,13 +1,17 @@\n /* eslint-disable */\n // prettier-ignore\n+import 'reflect-metadata'\n+// prettier-ignore\n+import { ClassTransformOptions, plainToInstance } from 'class-transformer'\n+// prettier-ignore\n+import { validateOrReject, ValidatorOptions } from 'class-validator'\n+// prettier-ignore\n import path from 'path'\n // prettier-ignore\n import express, { Express, RequestHandler, Request } from 'express'\n // prettier-ignore\n import multer, { Options } from 'multer'\n // prettier-ignore\n-import { validateOrReject, ValidatorOptions } from 'class-validator'\n-// prettier-ignore\n import * as Validators from './validators'\n // prettier-ignore\n import hooksFn0 from './api/hooks'\n@@ -33,6 +37,7 @@ import type { LowerHttpMethod, AspidaMethods, HttpStatusOk, AspidaMethodParams }\n // prettier-ignore\n export type FrourioOptions = {\n   basePath?: string\n+  transformer?: ClassTransformOptions\n   validator?: ValidatorOptions\n   multer?: Options\n }\n@@ -174,6 +179,7 @@ const asyncMethodToHandler = (\n // prettier-ignore\n export default (app: Express, options: FrourioOptions = {}) => {\n   const basePath = options.basePath ?? ''\n+  const transformerOptions: ClassTransformOptions = { enableCircularCheck: true, ...options.transformer }\n   const validatorOptions: ValidatorOptions = { validationError: { target: false }, ...options.validator }\n   const hooks0 = hooksFn0(app)\n   const hooks1 = hooksFn1(app)\n@@ -191,7 +197,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     hooks0.onRequest,\n     ctrlHooks0.onRequest,\n     createValidateHandler(req => [\n-      Object.keys(req.query).length ? validateOrReject(Object.assign(new Validators.Query(), req.query), validatorOptions) : null\n+      Object.keys(req.query).length ? validateOrReject(plainToInstance(Validators.Query, req.query, transformerOptions), validatorOptions) : null\n     ]),\n     asyncMethodToHandler(controller0.get)\n   ])\n@@ -202,8 +208,8 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     uploader,\n     formatMulterData([]),\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.Query(), req.query), validatorOptions),\n-      validateOrReject(Object.assign(new Validators.Body(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.Query, req.query, transformerOptions), validatorOptions),\n+      validateOrReject(plainToInstance(Validators.Body, req.body, transformerOptions), validatorOptions)\n     ]),\n     methodToHandler(controller0.post)\n   ])\n@@ -218,7 +224,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     uploader,\n     formatMulterData([['empty', false], ['vals', false], ['files', false]]),\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.MultiForm(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.MultiForm, req.body, transformerOptions), validatorOptions)\n     ]),\n     methodToHandler(controller2.post)\n   ])\n@@ -251,7 +257,7 @@ export default (app: Express, options: FrourioOptions = {}) => {\n     hooks1.onRequest,\n     parseJSONBoby,\n     createValidateHandler(req => [\n-      validateOrReject(Object.assign(new Validators.UserInfo(), req.body), validatorOptions)\n+      validateOrReject(plainToInstance(Validators.UserInfo, req.body, transformerOptions), validatorOptions)\n     ]),\n     ...ctrlHooks1.preHandler,\n     methodToHandler(controller5.post)"
        },
        {
          "filename": "src/buildServerFile.ts",
          "status": "modified",
          "additions": 13,
          "deletions": 5,
          "patch": "@@ -1,6 +1,7 @@\n import path from 'path'\n import { addPrettierIgnore } from './addPrettierIgnore'\n import createControllersText from './createControllersText'\n+import checkRequisites from './checkRequisites'\n \n const genHandlerText = (isAsync: boolean) => `\n const ${isAsync ? 'asyncM' : 'm'}ethodToHandler = (\n@@ -77,13 +78,19 @@ export default (input: string, project?: string) => {\n   const hasMethodToHandlerWithSchema = controllers.includes(' methodToHandlerWithSchema(')\n   const hasAsyncMethodToHandlerWithSchema = controllers.includes(' asyncMethodToHandlerWithSchema(')\n \n+  checkRequisites({ hasValidator })\n+\n   return {\n-    text: addPrettierIgnore(`/* eslint-disable */${hasMulter ? \"\\nimport path from 'path'\" : ''}\n+    text: addPrettierIgnore(`/* eslint-disable */${\n+      hasValidator\n+        ? \"\\nimport 'reflect-metadata'\" +\n+          \"\\nimport { ClassTransformOptions, plainToInstance } from 'class-transformer'\" +\n+          \"\\nimport { validateOrReject, ValidatorOptions } from 'class-validator'\"\n+        : ''\n+    }${hasMulter ? \"\\nimport path from 'path'\" : ''}\n import ${hasJSONBody ? 'express, ' : ''}{ Express, RequestHandler${\n       hasValidator ? ', Request' : ''\n     } } from 'express'${hasMulter ? \"\\nimport multer, { Options } from 'multer'\" : ''}${\n-      hasValidator ? \"\\nimport { validateOrReject, ValidatorOptions } from 'class-validator'\" : ''\n-    }${\n       hasMethodToHandlerWithSchema || hasAsyncMethodToHandlerWithSchema\n         ? \"\\nimport fastJson, { Schema } from 'fast-json-stringify'\"\n         : ''\n@@ -94,7 +101,7 @@ ${hasValidator ? `import * as Validators from './validators'\\n` : ''}${imports}$\n \n export type FrourioOptions = {\n   basePath?: string\n-${hasValidator ? '  validator?: ValidatorOptions\\n' : ''}${\n+${hasValidator ? '  transformer?: ClassTransformOptions\\n  validator?: ValidatorOptions\\n' : ''}${\n       hasMulter\n         ? `  multer?: Options\n }\n@@ -299,7 +306,8 @@ export default (app: Express, options: FrourioOptions = {}) => {\n   const basePath = options.basePath ?? ''\n ${\n   hasValidator\n-    ? '  const validatorOptions: ValidatorOptions = { validationError: { target: false }, ...options.validator }\\n'\n+    ? '  const transformerOptions: ClassTransformOptions = { enableCircularCheck: true, ...options.transformer }\\n' +\n+      '  const validatorOptions: ValidatorOptions = { validationError: { target: false }, ...options.validator }\\n'\n     : ''\n }${consts}${\n       hasMulter"
        },
        {
          "filename": "src/checkRequisites.ts",
          "status": "added",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -0,0 +1,21 @@\n+const shouldRequirePacakge = (name: string) => {\n+  try {\n+    require.resolve(name)\n+  } catch (e: unknown) {\n+    if (e instanceof Error && (e as any).code === 'MODULE_NOT_FOUND') {\n+      console.warn(\n+        `[WARN] Package \"${name}\" is necessary but not importable. Did you forget to install?`\n+      )\n+    } else {\n+      throw e\n+    }\n+  }\n+}\n+\n+export default ({ hasValidator }: { hasValidator: boolean }): void => {\n+  if (hasValidator) {\n+    shouldRequirePacakge('class-validator')\n+    shouldRequirePacakge('class-transformer')\n+    shouldRequirePacakge('reflect-metadata')\n+  }\n+}"
        },
        {
          "filename": "src/createControllersText.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -470,9 +470,9 @@ ${validateInfo\n     v.type\n       ? `      ${\n           v.hasQuestion ? `Object.keys(req.${v.name}).length ? ` : ''\n-        }validateOrReject(Object.assign(new Validators.${checker.typeToString(v.type)}(), req.${\n+        }validateOrReject(plainToInstance(Validators.${checker.typeToString(v.type)}, req.${\n           v.name\n-        }), validatorOptions)${v.hasQuestion ? ' : null' : ''}`\n+        }, transformerOptions), validatorOptions)${v.hasQuestion ? ' : null' : ''}`\n       : ''\n   )\n   .join(',\\n')}\\n    ])`"
        },
        {
          "filename": "yarn.lock",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -1682,6 +1682,11 @@ cjs-module-lexer@^1.0.0:\n   resolved \"https://registry.yarnpkg.com/cjs-module-lexer/-/cjs-module-lexer-1.2.1.tgz#2fd46d9906a126965aa541345c499aaa18e8cd73\"\n   integrity sha512-jVamGdJPDeuQilKhvVn1h3knuMOZzr8QDnpk+M9aMlCaMkTDd6fBWPhiDqFvFZ07pL0liqabAiuy8SY4jGHeaw==\n \n+class-transformer@^0.5.1:\n+  version \"0.5.1\"\n+  resolved \"https://registry.yarnpkg.com/class-transformer/-/class-transformer-0.5.1.tgz#24147d5dffd2a6cea930a3250a677addf96ab336\"\n+  integrity sha512-SQa1Ws6hUbfC98vKGxZH3KFY0Y1lm5Zm0SY8XX9zbK7FJCyVEac3ATW0RIpwzW+oOfmHE5PMPufDG9hCfoEOMw==\n+\n class-validator@^0.13.1:\n   version \"0.13.1\"\n   resolved \"https://registry.yarnpkg.com/class-validator/-/class-validator-0.13.1.tgz#381b2001ee6b9e05afd133671fbdf760da7dec67\"\n@@ -4931,6 +4936,11 @@ redent@^3.0.0:\n     indent-string \"^4.0.0\"\n     strip-indent \"^3.0.0\"\n \n+reflect-metadata@^0.1.13:\n+  version \"0.1.13\"\n+  resolved \"https://registry.yarnpkg.com/reflect-metadata/-/reflect-metadata-0.1.13.tgz#67ae3ca57c972a2aa1642b10fe363fe32d49dc08\"\n+  integrity sha512-Ts1Y/anZELhSsjMcU605fU9RE4Oi3p5ORujwbIKXfWa+0Zxs510Qrmrce5/Jowq3cHSZSJqBjypxmHarc+vEWg==\n+\n regexpp@^3.0.0, regexpp@^3.1.0:\n   version \"3.1.0\"\n   resolved \"https://registry.yarnpkg.com/regexpp/-/regexpp-3.1.0.tgz#206d0ad0a5648cffbdb8ae46438f3dc51c9f78e2\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 9,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa4c86008166f08c2ebe6852f90d030993e5977a",
            "date": "2024-11-14T12:52:41Z",
            "author_login": "solufa"
          },
          {
            "sha": "2337bfb5328d6edd1351cef339cae6a98800e11e",
            "date": "2024-11-14T12:44:51Z",
            "author_login": "solufa"
          },
          {
            "sha": "f59f489623382f7dcdebcefa0ce12055df0d6fa3",
            "date": "2024-11-14T12:40:02Z",
            "author_login": "solufa"
          },
          {
            "sha": "f69abeab22c9c577bbaafbb2e5e382b2e136f328",
            "date": "2024-11-14T12:31:48Z",
            "author_login": "solufa"
          },
          {
            "sha": "69677e06ad3476e96e985963e465ecf5ca277a4f",
            "date": "2024-11-14T12:10:53Z",
            "author_login": "solufa"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-20",
    "description": "Frourio-express is a minimal full stack framework, for TypeScript. Frourio-express users who uses frourio-express version prior to v0.26.0 and integration with class-validator through `validators/` folder are subject to a input validation vulnerability. Validators do not work properly for request bodies and queries in specific situations and some input is not validated at all. Users are advised to update frourio to v0.26.0 or later and to install `class-transformer` and `reflect-metadata`.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-02-07T23:15:07.840",
    "last_modified": "2024-11-21T06:48:57.593",
    "fix_date": "2022-02-04T08:58:54Z"
  },
  "references": [
    {
      "url": "https://github.com/frouriojs/frourio-express/commit/73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/frouriojs/frourio-express/security/advisories/GHSA-mmj4-777p-fpq9",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/frouriojs/frourio-express/commit/73ded5c6f9f1c126c0cb2d05c0505e9e4db142d2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/frouriojs/frourio-express/security/advisories/GHSA-mmj4-777p-fpq9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.145855",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "frourio-express",
    "owner": "frouriojs",
    "created_at": "2020-10-06T00:08:29Z",
    "updated_at": "2024-11-14T12:52:46Z",
    "pushed_at": "2024-11-14T12:53:29Z",
    "size": 1530,
    "stars": 3,
    "forks": 3,
    "open_issues": 0,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "develop",
      "main"
    ],
    "languages": {
      "TypeScript": 222741,
      "JavaScript": 1971,
      "Makefile": 160
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T20:42:21.166996"
  }
}