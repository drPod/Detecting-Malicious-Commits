{
  "cve_id": "CVE-2022-23635",
  "github_data": {
    "repository": "istio/istio",
    "fix_commit": "5f3b5ed958ae75156f8656fe7b3794f78e94db84",
    "related_commits": [
      "5f3b5ed958ae75156f8656fe7b3794f78e94db84",
      "5f3b5ed958ae75156f8656fe7b3794f78e94db84"
    ],
    "patch_url": "https://github.com/istio/istio/commit/5f3b5ed958ae75156f8656fe7b3794f78e94db84.patch",
    "fix_commit_details": {
      "sha": "5f3b5ed958ae75156f8656fe7b3794f78e94db84",
      "commit_date": "2022-02-18T17:05:01Z",
      "author": {
        "login": "jacob-delgado",
        "type": "User",
        "stats": {
          "total_commits": 127,
          "average_weekly_commits": 0.297423887587822,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 85
        }
      },
      "commit_message": {
        "title": "[release-1.13] Harden validation of untrusted inputs (#90) (#96)",
        "length": 188,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 35,
        "additions": 22,
        "deletions": 13
      },
      "files": [
        {
          "filename": "istio.deps",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -4,6 +4,6 @@\n     \"name\": \"PROXY_REPO_SHA\",\n     \"repoName\": \"proxy\",\n     \"file\": \"\",\n-    \"lastStableSHA\": \"9335502ad4a84f380d7d5e0f3ba35a088501ef02\"\n+    \"lastStableSHA\": \"a971bfa7fddce41c1795fe2ce279735131c08878\"\n   }\n ]"
        },
        {
          "filename": "pilot/pkg/model/context.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -348,7 +348,7 @@ func (l StringList) MarshalJSON() ([]byte, error) {\n }\n \n func (l *StringList) UnmarshalJSON(data []byte) error {\n-\tif len(data) == 0 || string(data) == `\"\"` {\n+\tif len(data) < 2 || string(data) == `\"\"` {\n \t\t*l = []string{}\n \t} else {\n \t\t*l = strings.Split(string(data[1:len(data)-1]), \",\")"
        },
        {
          "filename": "pilot/pkg/model/context_test.go",
          "status": "modified",
          "additions": 11,
          "deletions": 6,
          "patch": "@@ -145,13 +145,15 @@ func TestNodeMetadata(t *testing.T) {\n \n func TestStringList(t *testing.T) {\n \tcases := []struct {\n-\t\tin     string\n-\t\texpect model.StringList\n+\t\tin          string\n+\t\texpect      model.StringList\n+\t\tnoRoundTrip bool\n \t}{\n-\t\t{`\"a,b,c\"`, []string{\"a\", \"b\", \"c\"}},\n-\t\t{`\"a\"`, []string{\"a\"}},\n-\t\t{`\"\"`, []string{}},\n-\t\t{`\"123,@#$#,abcdef\"`, []string{\"123\", \"@#$#\", \"abcdef\"}},\n+\t\t{in: `\"a,b,c\"`, expect: []string{\"a\", \"b\", \"c\"}},\n+\t\t{in: `\"a\"`, expect: []string{\"a\"}},\n+\t\t{in: `\"\"`, expect: []string{}},\n+\t\t{in: `\"123,@#$#,abcdef\"`, expect: []string{\"123\", \"@#$#\", \"abcdef\"}},\n+\t\t{in: `1`, expect: []string{}, noRoundTrip: true},\n \t}\n \tfor _, tt := range cases {\n \t\tt.Run(tt.in, func(t *testing.T) {\n@@ -166,6 +168,9 @@ func TestStringList(t *testing.T) {\n \t\t\tif err != nil {\n \t\t\t\tt.Fatal(err)\n \t\t\t}\n+\t\t\tif tt.noRoundTrip {\n+\t\t\t\treturn\n+\t\t\t}\n \t\t\tif !reflect.DeepEqual(string(b), tt.in) {\n \t\t\t\tt.Fatalf(\"Expected %v, got %v\", tt.in, string(b))\n \t\t\t}"
        },
        {
          "filename": "pilot/pkg/networking/core/v1alpha3/cluster_builder_test.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3055,7 +3055,7 @@ func TestApplyDestinationRuleOSCACert(t *testing.T) {\n \t\t\t\tt.Errorf(\"Could not parse destination rule: %v\", err)\n \t\t\t}\n \t\t\tdr := &networking.DestinationRule{}\n-\t\t\terr = json.Unmarshal(byteArray, &dr)\n+\t\t\terr = json.Unmarshal(byteArray, dr)\n \t\t\tif err != nil {\n \t\t\t\tt.Errorf(\"Could not unmarshal destination rule: %v\", err)\n \t\t\t}"
        },
        {
          "filename": "security/pkg/server/ca/authenticate/oidc.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -92,7 +92,7 @@ func (j *JwtAuthenticator) authenticate(ctx context.Context, bearerToken string)\n \t\treturn nil, fmt.Errorf(\"failed to verify the JWT token (error %v)\", err)\n \t}\n \n-\tsa := &JwtPayload{}\n+\tsa := JwtPayload{}\n \t// \"aud\" for trust domain, \"sub\" has \"system:serviceaccount:$namespace:$serviceaccount\".\n \t// in future trust domain may use another field as a standard is defined.\n \tif err := idToken.Claims(&sa); err != nil {"
        },
        {
          "filename": "security/pkg/util/jwtutil.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -112,7 +112,7 @@ func ExtractJwtAud(jwt string) ([]string, bool) {\n \t\treturn nil, false\n \t}\n \n-\tstructuredPayload := &jwtPayload{}\n+\tstructuredPayload := jwtPayload{}\n \terr = json.Unmarshal(payloadBytes, &structuredPayload)\n \tif err != nil {\n \t\treturn nil, false"
        },
        {
          "filename": "security/pkg/util/jwtutil_test.go",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -133,7 +133,9 @@ func Test3p(t *testing.T) {\n \t\t\tt.Error(\"Expecting bound token, detected unbound \", s)\n \t\t}\n \t}\n-\tif !IsK8SUnbound(firstPartyJwt) {\n-\t\tt.Error(\"Expecting unbound, detected bound \", firstPartyJwt)\n+\tfor _, s := range []string{firstPartyJwt, \".bnVsbM.\"} {\n+\t\tif !IsK8SUnbound(s) {\n+\t\t\tt.Error(\"Expecting unbound, detected bound \", s)\n+\t\t}\n \t}\n }"
        },
        {
          "filename": "tests/fuzz/testdata/FuzzBNMUnmarshalJSON/4811475191988224",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+{\"INSTANCE_IPS\":1}"
        },
        {
          "filename": "tests/fuzz/testdata/FuzzJwtUtil/5085913745588224",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+.bnVsbM.\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 3,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 5,
        "unique_directories": 7,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "282e0b96dba4b987884607ab3ce68fddbf9eb5f4",
            "date": "2025-01-14T17:08:52Z",
            "author_login": "keithmattix"
          },
          {
            "sha": "9cbc0328c88c02dc2b85ef79a42dc78e4083194a",
            "date": "2025-01-14T16:18:51Z",
            "author_login": "istio-testing"
          },
          {
            "sha": "e33c2b9aa5d3fc9131d58af3d42b33b49d6dd9dc",
            "date": "2025-01-13T20:01:51Z",
            "author_login": "whitneygriffith"
          },
          {
            "sha": "0a41d8a13e093ec771a3420e043c8688aa8f354b",
            "date": "2025-01-13T17:27:57Z",
            "author_login": "sridhargaddam"
          },
          {
            "sha": "a1946248a9fe05bc3cefd172ef773e0647cd7a89",
            "date": "2025-01-13T17:27:50Z",
            "author_login": "ilrudie"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-287",
    "description": "Istio is an open platform to connect, manage, and secure microservices. In affected versions the Istio control plane, `istiod`, is vulnerable to a request processing error, allowing a malicious attacker that sends a specially crafted message which results in the control plane crashing. This endpoint is served over TLS port 15012, but does not require any authentication from the attacker. For simple installations, Istiod is typically only reachable from within the cluster, limiting the blast radius. However, for some deployments, especially [multicluster](https://istio.io/latest/docs/setup/install/multicluster/primary-remote/) topologies, this port is exposed over the public internet. There are no effective workarounds, beyond upgrading. Limiting network access to Istiod to the minimal set of clients can help lessen the scope of the vulnerability to some extent.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-22T22:15:07.620",
    "last_modified": "2024-11-21T06:48:59.143",
    "fix_date": "2022-02-18T17:05:01Z"
  },
  "references": [
    {
      "url": "https://github.com/istio/istio/commit/5f3b5ed958ae75156f8656fe7b3794f78e94db84",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-856q-xv3c-7f2f",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://istio.io/latest/news/security/istio-security-2022-003",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/commit/5f3b5ed958ae75156f8656fe7b3794f78e94db84",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/security/advisories/GHSA-856q-xv3c-7f2f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://istio.io/latest/news/security/istio-security-2022-003",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.739991",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "istio",
    "owner": "istio",
    "created_at": "2016-11-18T23:57:21Z",
    "updated_at": "2025-01-14T14:31:19Z",
    "pushed_at": "2025-01-13T20:01:51Z",
    "size": 275791,
    "stars": 36347,
    "forks": 7819,
    "open_issues": 499,
    "watchers": 36347,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.21.2-build-deps",
      "1.21.3-deps",
      "1.22-update-deps",
      "bookinfo-tidy",
      "craigbox-patch-1",
      "dependabot/go_modules/github.com/docker/docker-26.0.2incompatible",
      "dependabot/go_modules/google.golang.org/grpc-1.64.1",
      "dependabot/pip/samples/bookinfo/src/productpage/certifi-2024.7.4",
      "dependabot/pip/samples/bookinfo/src/productpage/requests-2.32.0",
      "dependabot/pip/samples/bookinfo/src/productpage/requests-2.32.2",
      "dependabot/pip/samples/bookinfo/src/productpage/urllib3-2.2.2",
      "dependabot/pip/samples/helloworld/src/certifi-2024.7.4",
      "dependabot/pip/samples/helloworld/src/urllib3-2.2.2",
      "experimental-ambient",
      "experimental-dual-stack",
      "howardjohn/exp-debug-test",
      "howardjohn-patch-1",
      "hzxuzhonghu-patch-1",
      "latest-golangci-lint",
      "master",
      "master-master-commonfiles-1b3e9286",
      "newBaseVersion1.19-2024-04-16T19-02-45",
      "newBaseVersion1.19-2024-04-26T19-02-46",
      "newBaseVersion1.19-2024-04-27T19-03-13",
      "newBaseVersion1.20-2024-04-19T19-02-18",
      "newBaseVersion1.21-2024-06-01T19-03-56",
      "newBaseVersion1.21-2024-09-04T19-00-43",
      "newBaseVersion1.23-2024-08-08T19-01-38",
      "newBaseVersionmaster-2024-05-08T22-56-43",
      "newBaseVersionmaster-2024-12-17T19-00-43"
    ],
    "languages": {
      "Go": 14412921,
      "Shell": 121344,
      "Makefile": 51223,
      "CSS": 47647,
      "Jsonnet": 32268,
      "HTML": 28430,
      "Python": 12110,
      "Smarty": 8813,
      "Dockerfile": 1273,
      "Java": 1080,
      "JavaScript": 13
    },
    "commit_activity": {
      "total_commits_last_year": 2316,
      "avg_commits_per_week": 44.53846153846154,
      "days_active_last_year": 331
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:40:10.524278"
  }
}