{
  "cve_id": "CVE-2022-23833",
  "github_data": {
    "repository": "django/django",
    "fix_commit": "c477b761804984c932704554ad35f78a2e230c6a",
    "related_commits": [
      "c477b761804984c932704554ad35f78a2e230c6a",
      "d16133568ef9c9b42cb7a08bdf9ff3feec2e5468",
      "f9c7d48fdd6f198a6494a9202f90242f176e4fc9",
      "c477b761804984c932704554ad35f78a2e230c6a",
      "d16133568ef9c9b42cb7a08bdf9ff3feec2e5468",
      "f9c7d48fdd6f198a6494a9202f90242f176e4fc9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c477b761804984c932704554ad35f78a2e230c6a",
      "commit_date": "2022-01-21T06:50:03Z",
      "author": {
        "login": "felixxm",
        "type": "User",
        "stats": {
          "total_commits": 1687,
          "average_weekly_commits": 1.65230166503428,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 409
        }
      },
      "commit_message": {
        "title": "[2.2.x] Fixed CVE-2022-23833 -- Fixed DoS possiblity in file uploads.",
        "length": 186,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 28,
        "deletions": 0
      },
      "files": [
        {
          "filename": "django/http/multipartparser.py",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -240,6 +240,8 @@ def parse(self):\n                                 remaining = len(stripped_chunk) % 4\n                                 while remaining != 0:\n                                     over_chunk = field_stream.read(4 - remaining)\n+                                    if not over_chunk:\n+                                        break\n                                     stripped_chunk += b\"\".join(over_chunk.split())\n                                     remaining = len(stripped_chunk) % 4\n "
        },
        {
          "filename": "docs/releases/2.2.27.txt",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -15,3 +15,9 @@ posing an XSS attack vector.\n In order to avoid this vulnerability, ``{% debug %}`` no longer outputs an\n information when the ``DEBUG`` setting is ``False``, and it ensures all context\n variables are correctly escaped when the ``DEBUG`` setting is ``True``.\n+\n+CVE-2022-23833: Denial-of-service possibility in file uploads\n+=============================================================\n+\n+Passing certain inputs to multipart forms could result in an infinite loop when\n+parsing files."
        },
        {
          "filename": "tests/file_uploads/tests.py",
          "status": "modified",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -142,6 +142,26 @@ def test_big_base64_upload(self):\n     def test_big_base64_newlines_upload(self):\n         self._test_base64_upload(\"Big data\" * 68000, encode=base64.encodebytes)\n \n+    def test_base64_invalid_upload(self):\n+        payload = client.FakePayload('\\r\\n'.join([\n+            '--' + client.BOUNDARY,\n+            'Content-Disposition: form-data; name=\"file\"; filename=\"test.txt\"',\n+            'Content-Type: application/octet-stream',\n+            'Content-Transfer-Encoding: base64',\n+            ''\n+        ]))\n+        payload.write(b'\\r\\n!\\r\\n')\n+        payload.write('--' + client.BOUNDARY + '--\\r\\n')\n+        r = {\n+            'CONTENT_LENGTH': len(payload),\n+            'CONTENT_TYPE': client.MULTIPART_CONTENT,\n+            'PATH_INFO': '/echo_content/',\n+            'REQUEST_METHOD': 'POST',\n+            'wsgi.input': payload,\n+        }\n+        response = self.client.request(**r)\n+        self.assertEqual(response.json()['file'], '')\n+\n     def test_unicode_file_name(self):\n         with sys_tempfile.TemporaryDirectory() as temp_dir:\n             # This file contains Chinese symbols and an accented char in the name."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "330d89d4fe7832355535580383523f1749a3ee45",
            "date": "2025-01-25T17:06:11Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "9cc3970eaaf603832c075618e61aea9ea430f719",
            "date": "2025-01-13T17:35:02Z",
            "author_login": "cliff688"
          },
          {
            "sha": "352d860b9107adbcde0f1fe5d0fce8e9090a51e4",
            "date": "2025-01-23T15:43:04Z",
            "author_login": "jacobtylerwalls"
          },
          {
            "sha": "f133285a9a7f3647fd55abc2e57b8a9a2c11ac94",
            "date": "2025-01-23T14:28:04Z",
            "author_login": "nessita"
          },
          {
            "sha": "2c47207b3c8412d16e61e388f176b47b41b40794",
            "date": "2024-12-20T22:26:22Z",
            "author_login": "claudep"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-835",
    "description": "An issue was discovered in MultiPartParser in Django 2.2 before 2.2.27, 3.2 before 3.2.12, and 4.0 before 4.0.2. Passing certain inputs to multipart forms could result in an infinite loop when parsing files.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-03T02:15:07.623",
    "last_modified": "2024-11-21T06:49:20.623",
    "fix_date": "2022-01-21T06:50:03Z"
  },
  "references": [
    {
      "url": "https://docs.djangoproject.com/en/4.0/releases/security/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/c477b761804984c932704554ad35f78a2e230c6a",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/d16133568ef9c9b42cb7a08bdf9ff3feec2e5468",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/f9c7d48fdd6f198a6494a9202f90242f176e4fc9",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://groups.google.com/forum/#%21forum/django-announce",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B4SQG2EAF4WCI2SLRL6XRDJ3RPK3ZRDV/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220221-0003/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5254",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.djangoproject.com/weblog/2022/feb/01/security-releases/",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://docs.djangoproject.com/en/4.0/releases/security/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/django/django/commit/c477b761804984c932704554ad35f78a2e230c6a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/d16133568ef9c9b42cb7a08bdf9ff3feec2e5468",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/django/django/commit/f9c7d48fdd6f198a6494a9202f90242f176e4fc9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://groups.google.com/forum/#%21forum/django-announce",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B4SQG2EAF4WCI2SLRL6XRDJ3RPK3ZRDV/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220221-0003/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5254",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.djangoproject.com/weblog/2022/feb/01/security-releases/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:57.104324",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "django",
    "owner": "django",
    "created_at": "2012-04-28T02:47:18Z",
    "updated_at": "2025-01-26T05:32:18Z",
    "pushed_at": "2025-01-25T17:07:46Z",
    "size": 265094,
    "stars": 82051,
    "forks": 32132,
    "open_issues": 307,
    "watchers": 82051,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "stable/0.90.x",
      "stable/0.91.x",
      "stable/0.95.x",
      "stable/0.96.x",
      "stable/1.0.x",
      "stable/1.1.x",
      "stable/1.2.x",
      "stable/1.3.x",
      "stable/1.4.x",
      "stable/1.5.x",
      "stable/1.6.x",
      "stable/1.7.x",
      "stable/1.8.x",
      "stable/1.9.x",
      "stable/1.10.x",
      "stable/1.11.x",
      "stable/2.0.x",
      "stable/2.1.x",
      "stable/2.2.x",
      "stable/3.0.x",
      "stable/3.1.x",
      "stable/3.2.x",
      "stable/4.0.x",
      "stable/4.1.x",
      "stable/4.2.x",
      "stable/5.0.x",
      "stable/5.1.x",
      "stable/5.2.x"
    ],
    "languages": {
      "Python": 17568436,
      "HTML": 250867,
      "JavaScript": 158876,
      "CSS": 92030,
      "Smarty": 392,
      "Procfile": 47
    },
    "commit_activity": {
      "total_commits_last_year": 967,
      "avg_commits_per_week": 18.596153846153847,
      "days_active_last_year": 295
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T08:02:15.044821"
  }
}