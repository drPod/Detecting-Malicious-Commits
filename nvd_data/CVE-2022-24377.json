{
  "cve_id": "CVE-2022-24377",
  "github_data": {
    "repository": "Soontao/cycle-import-check",
    "fix_commit": "1ca97b59df7e9c704471fcb4cf042ce76d7c9890",
    "related_commits": [
      "1ca97b59df7e9c704471fcb4cf042ce76d7c9890",
      "1ca97b59df7e9c704471fcb4cf042ce76d7c9890"
    ],
    "patch_url": "https://github.com/Soontao/cycle-import-check/commit/1ca97b59df7e9c704471fcb4cf042ce76d7c9890.patch",
    "fix_commit_details": {
      "sha": "1ca97b59df7e9c704471fcb4cf042ce76d7c9890",
      "commit_date": "2022-11-16T13:35:02Z",
      "author": {
        "login": "Soontao",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "chore: dep update",
        "length": 17,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 27,
        "additions": 5,
        "deletions": 22
      },
      "files": [
        {
          "filename": "src/file.ts",
          "status": "modified",
          "additions": 5,
          "deletions": 20,
          "patch": "@@ -1,22 +1,16 @@\n-import { Extension, ScanResult, ReportVO, PackageJson, FileImportDescription } from \"./type\";\n+import { concat, filter, isArray, isString, join as arrayJoin, keys, map } from \"@newdash/newdash\";\n+import { includes } from \"@newdash/newdash/includes\";\n+import { readFileSync } from \"fs\";\n import { sync } from \"glob\";\n-import { join as pathJoin, dirname, join, normalize, relative } from \"path\";\n-import { join as arrayJoin, map, isArray, isString, concat, filter, keys } from \"@newdash/newdash\";\n-import { includes } from \"@newdash/newdash/includes\"\n-import { readFileSync, writeFileSync, existsSync } from \"fs\";\n+import { dirname, join, join as pathJoin, normalize, relative } from \"path\";\n import { cwd } from \"process\";\n-import { tmpdir, platform } from \"os\";\n-import { exec } from \"child_process\";\n+import { Extension, FileImportDescription, PackageJson, ReportVO, ScanResult } from \"./type\";\n \n require.extensions[\".ts\"] = require.extensions[\".js\"]\n require.extensions[\".jsx\"] = require.extensions[\".js\"]\n require.extensions[\".tsx\"] = require.extensions[\".js\"]\n require.extensions[\".mjs\"] = require.extensions[\".js\"]\n \n-const extensions = [\n-  \"js\", \"jsx\", \"ts\", \"tsx\", \"mjs\"\n-]\n-\n const { resolve } = require\n \n export const allDependencies = (absPath: string) => {\n@@ -120,12 +114,3 @@ export const mapScanResultToReportVO = (result: ScanResult): ReportVO => {\n   return rt;\n }\n \n-export const writeFileToTmpDirAndOpenIt = (filename: string, content: string) => {\n-  const path = join(tmpdir(), filename);\n-  writeFileSync(path, content);\n-  if (platform() === \"win32\") {\n-    exec(`start ${path}`)\n-  } else {\n-    exec(`open ${path}`)\n-  }\n-}"
        },
        {
          "filename": "src/index.ts",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -2,7 +2,5 @@\n \n export { scanDirectoryWithResult } from \"./scanner\"\n \n-export { writeFileToTmpDirAndOpenIt } from \"./file\"\n-\n export { calculateCycleImport } from \"./graph\"\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1a0a6e978174d3a51a4d4db59b56440c9ddf7974",
            "date": "2025-01-13T22:27:59Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "5ae57237757ca14899ea32b8c4afe72af4bf47c4",
            "date": "2025-01-10T21:04:15Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "5b2a493e5aac7712ef733cd5f094dfc2c6ff90ce",
            "date": "2025-01-10T08:23:06Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "6ae3dac47b684145a6aec0b6d4797dcfe183a424",
            "date": "2025-01-08T20:42:07Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "765c66f803e64835718bb3b423d5df372c6261c5",
            "date": "2025-01-03T06:46:30Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "The package cycle-import-check before 1.3.2 are vulnerable to Command Injection via the writeFileToTmpDirAndOpenIt function due to improper user-input sanitization.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-14T05:15:11.283",
    "last_modified": "2024-11-21T06:50:17.727",
    "fix_date": "2022-11-16T13:35:02Z"
  },
  "references": [
    {
      "url": "https://github.com/Soontao/cycle-import-check/commit/1ca97b59df7e9c704471fcb4cf042ce76d7c9890",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-CYCLEIMPORTCHECK-3157955",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Soontao/cycle-import-check/commit/1ca97b59df7e9c704471fcb4cf042ce76d7c9890",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-CYCLEIMPORTCHECK-3157955",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.230153",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cycle-import-check",
    "owner": "Soontao",
    "created_at": "2018-06-14T06:35:49Z",
    "updated_at": "2025-01-13T22:28:03Z",
    "pushed_at": "2025-01-13T22:28:00Z",
    "size": 1575,
    "stars": 22,
    "forks": 6,
    "open_issues": 4,
    "watchers": 22,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 17555,
      "JavaScript": 4176
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:05:10.128928"
  }
}