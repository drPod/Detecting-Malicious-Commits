{
  "cve_id": "CVE-2022-24707",
  "github_data": {
    "repository": "anuko/timetracker",
    "fix_commit": "0e2d6563e2d969209c502a1eae4ddd8e87b73299",
    "related_commits": [
      "0e2d6563e2d969209c502a1eae4ddd8e87b73299",
      "0e2d6563e2d969209c502a1eae4ddd8e87b73299"
    ],
    "patch_url": "https://github.com/anuko/timetracker/commit/0e2d6563e2d969209c502a1eae4ddd8e87b73299.patch",
    "fix_commit_details": {
      "sha": "0e2d6563e2d969209c502a1eae4ddd8e87b73299",
      "commit_date": "2022-02-21T14:56:48Z",
      "author": {
        "login": "anuko",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Addressed an sql injection vulnerability in puncher.php.",
        "length": 56,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "initialize.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n // Disable displaying errors on screen.\n ini_set('display_errors', 'Off');\n \n-define(\"APP_VERSION\", \"1.20.0.5641\");\n+define(\"APP_VERSION\", \"1.20.0.5642\");\n define(\"APP_DIR\", dirname(__FILE__));\n define(\"LIBRARY_DIR\", APP_DIR.\"/WEB-INF/lib\");\n define(\"TEMPLATE_DIR\", APP_DIR.\"/WEB-INF/templates\");"
        },
        {
          "filename": "puncher.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -19,6 +19,13 @@\n   header('Location: feature_disabled.php');\n   exit();\n }\n+// If we are passed in a date, make sure it is in correct format.\n+// TODO: redo this temporary sql injection fix as we are not supposed to pass a date.\n+$date = $request->getParameter('date');\n+if ($date && !ttValidDbDateFormatDate($date)) {\n+  header('Location: access_denied.php');\n+  exit();\n+}\n if ($request->isPost()) {\n   // Validate that browser_today parameter is in correct format.\n   $browser_today = $request->getParameter('browser_today');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6711df7ae7c0c0034d6673365d26a0933faac5c",
            "date": "2023-12-28T18:07:21Z",
            "author_login": "anuko"
          },
          {
            "sha": "f92e6ce6d58669ea735767b55e18bcaa7a7935b8",
            "date": "2023-12-27T23:41:06Z",
            "author_login": "ram-fabian-heinrich"
          },
          {
            "sha": "2deafba72d62471a2b1e29f2d625a3dbb4702200",
            "date": "2023-11-11T16:42:19Z",
            "author_login": "anuko"
          },
          {
            "sha": "d123e4534038691c66c342008d464efbe8824a5d",
            "date": "2023-07-08T16:48:07Z",
            "author_login": "anuko"
          },
          {
            "sha": "3c21de2155eec74d2a16c4ccae867df6963388fc",
            "date": "2023-07-06T18:46:39Z",
            "author_login": "anuko"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-89",
    "description": "Anuko Time Tracker is an open source, web-based time tracking application written in PHP. UNION SQL injection and time-based blind injection vulnerabilities existed in Time Tracker Puncher plugin in versions of anuko timetracker prior to 1.20.0.5642. This was happening because the Puncher plugin was reusing code from other places and was relying on an unsanitized date parameter in POST requests. Because the parameter was not checked, it was possible to craft POST requests with malicious SQL for Time Tracker database. This issue has been resolved in in version 1.20.0.5642. Users unable to upgrade are advised to add their own checks to input.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-24T16:15:08.240",
    "last_modified": "2024-11-21T06:50:55.173",
    "fix_date": "2022-02-21T14:56:48Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/167060/Anuko-Time-Tracker-1.20.0.5640-SQL-Injection.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/0e2d6563e2d969209c502a1eae4ddd8e87b73299",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-wqx7-95fx-wjxj",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/167060/Anuko-Time-Tracker-1.20.0.5640-SQL-Injection.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/0e2d6563e2d969209c502a1eae4ddd8e87b73299",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-wqx7-95fx-wjxj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.751068",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "timetracker",
    "owner": "anuko",
    "created_at": "2016-02-28T19:01:14Z",
    "updated_at": "2024-12-10T00:27:13Z",
    "pushed_at": "2023-12-28T18:07:38Z",
    "size": 11493,
    "stars": 191,
    "forks": 124,
    "open_issues": 27,
    "watchers": 191,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 5951736,
      "Smarty": 314330,
      "JavaScript": 30090,
      "CSS": 16132,
      "Batchfile": 13672,
      "Shell": 2274
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:32:50.847474"
  }
}