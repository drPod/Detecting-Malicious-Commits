{
  "cve_id": "CVE-2022-24793",
  "github_data": {
    "repository": "pjsip/pjproject",
    "fix_commit": "9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a",
    "related_commits": [
      "9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a",
      "9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a",
      "commit_date": "2022-04-06T03:49:47Z",
      "author": {
        "login": "trengginas",
        "type": "User",
        "stats": {
          "total_commits": 458,
          "average_weekly_commits": 0.4557213930348259,
          "total_additions": 571682,
          "total_deletions": 325420,
          "weeks_active": 236
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-p6g5-v97c-w5q4",
        "length": 236,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 28,
        "additions": 18,
        "deletions": 10
      },
      "files": [
        {
          "filename": "pjlib-util/src/pjlib-util/dns.c",
          "status": "modified",
          "additions": 18,
          "deletions": 10,
          "patch": "@@ -159,8 +159,13 @@ static pj_status_t get_name_len(int rec_counter, const pj_uint8_t *pkt,\n \t} else {\n \t    unsigned label_len = *p;\n \n-\t    /* Check that label length is valid */\n-\t    if (pkt+label_len > max)\n+\t    /* Check that label length is valid.\n+\t     * Each label consists of an octet length (of size 1) followed\n+\t     * by the octet of the specified length (label_len). Then it\n+\t     * must be followed by either another label's octet length or\n+\t     * a zero length octet (that terminates the sequence).\n+\t     */\n+\t    if (p+1+label_len+1 > max)\n \t\treturn PJLIB_UTIL_EDNSINNAMEPTR;\n \n \t    p += (label_len + 1);\n@@ -170,9 +175,6 @@ static pj_status_t get_name_len(int rec_counter, const pj_uint8_t *pkt,\n \t\t++label_len;\n \t    \n \t    *name_len += label_len;\n-\n-\t    if (p >= max)\n-\t\treturn PJLIB_UTIL_EDNSINSIZE;\n \t}\n     }\n     ++p;\n@@ -222,8 +224,13 @@ static pj_status_t get_name(int rec_counter, const pj_uint8_t *pkt,\n \t} else {\n \t    unsigned label_len = *p;\n \n-\t    /* Check that label length is valid */\n-\t    if (pkt+label_len > max)\n+\t    /* Check that label length is valid.\n+\t     * Each label consists of an octet length (of size 1) followed\n+\t     * by the octet of the specified length (label_len). Then it\n+\t     * must be followed by either another label's octet length or\n+\t     * a zero length octet (that terminates the sequence).\n+\t     */\n+\t    if (p+1+label_len+1 > max)\n \t\treturn PJLIB_UTIL_EDNSINNAMEPTR;\n \n \t    pj_memcpy(name->ptr + name->slen, p+1, label_len);\n@@ -234,9 +241,6 @@ static pj_status_t get_name(int rec_counter, const pj_uint8_t *pkt,\n \t\t*(name->ptr + name->slen) = '.';\n \t\t++name->slen;\n \t    }\n-\n-\t    if (p >= max)\n-\t\treturn PJLIB_UTIL_EDNSINSIZE;\n \t}\n     }\n \n@@ -269,6 +273,10 @@ static pj_status_t parse_query(pj_dns_parsed_query *q, pj_pool_t *pool,\n \n     p = (start + name_part_len);\n \n+    /* Check the size can accomodate next few fields. */\n+    if (p + 4 > max)\n+    \treturn PJLIB_UTIL_EDNSINSIZE;\n+\n     /* Get the type */\n     pj_memcpy(&q->type, p, 2);\n     q->type = pj_ntohs(q->type);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a89917e5addc990252b4ebde7fbb3da89742b21f",
            "date": "2025-01-24T06:49:59Z",
            "author_login": "sauwming"
          },
          {
            "sha": "377a80cefe6647bccce3915840b4b238ba523be3",
            "date": "2025-01-24T06:48:31Z",
            "author_login": "nanangizz"
          },
          {
            "sha": "de3f2e1e64fca8ef48bda3774caeae6cabd306f0",
            "date": "2025-01-24T02:20:28Z",
            "author_login": "sauwming"
          },
          {
            "sha": "cdb129406a126335fc1008e386aef7b4a3342013",
            "date": "2025-01-23T03:01:27Z",
            "author_login": "sauwming"
          },
          {
            "sha": "0899186444ac5d0cff9a5198cb1d4c754a45aacf",
            "date": "2025-01-22T05:22:12Z",
            "author_login": "nanangizz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-120",
    "description": "PJSIP is a free and open source multimedia communication library written in C. A buffer overflow vulnerability in versions 2.12 and prior affects applications that use PJSIP DNS resolution. It doesn't affect PJSIP users who utilize an external resolver. This vulnerability is related to CVE-2023-27585. The difference is that this issue is in parsing the query record `parse_rr()`, while the issue in CVE-2023-27585 is in `parse_query()`. A patch is available in the `master` branch of the `pjsip/pjproject` GitHub repository. A workaround is to disable DNS resolution in PJSIP config (by setting `nameserver_count` to zero) or use an external resolver instead.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-06T14:15:08.087",
    "last_modified": "2024-11-21T06:51:06.550",
    "fix_date": "2022-04-06T03:49:47Z"
  },
  "references": [
    {
      "url": "https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pjsip/pjproject/security/advisories/GHSA-p6g5-v97c-w5q4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00047.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/11/msg00021.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/08/msg00038.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202210-37",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5285",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pjsip/pjproject/commit/9fae8f43accef8ea65d4a8ae9cdf297c46cfe29a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pjsip/pjproject/security/advisories/GHSA-p6g5-v97c-w5q4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00047.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/11/msg00021.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/08/msg00038.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202210-37",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5285",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.106802",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "pjproject",
    "owner": "pjsip",
    "created_at": "2016-01-24T05:00:33Z",
    "updated_at": "2025-01-24T06:50:04Z",
    "pushed_at": "2025-01-25T04:42:48Z",
    "size": 45463,
    "stars": 2170,
    "forks": 813,
    "open_issues": 15,
    "watchers": 2170,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 15271741,
      "C++": 1658626,
      "Python": 553465,
      "Shell": 395169,
      "Objective-C": 327121,
      "C#": 141563,
      "Makefile": 115036,
      "Java": 114622,
      "Mathematica": 86105,
      "SWIG": 41289,
      "Swift": 38034,
      "CSS": 21213,
      "Kotlin": 17696,
      "Rust": 4860,
      "Objective-C++": 3801,
      "HTML": 3320,
      "QMake": 3180,
      "Batchfile": 1805,
      "QML": 1121,
      "Pan": 288,
      "Prolog": 25
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:47:22.881148"
  }
}