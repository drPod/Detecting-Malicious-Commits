{
  "cve_id": "CVE-2022-24795",
  "github_data": {
    "repository": "brianmario/yajl-ruby",
    "fix_commit": "7168bd79b888900aa94523301126f968a93eb3a6",
    "related_commits": [
      "7168bd79b888900aa94523301126f968a93eb3a6",
      "7168bd79b888900aa94523301126f968a93eb3a6"
    ],
    "patch_url": "https://github.com/brianmario/yajl-ruby/commit/7168bd79b888900aa94523301126f968a93eb3a6.patch",
    "fix_commit_details": {
      "sha": "7168bd79b888900aa94523301126f968a93eb3a6",
      "commit_date": "2021-06-24T21:22:27Z",
      "author": {
        "login": "brianmario",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #204 from eileencodes/fix-c-warnings",
        "length": 71,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
      },
      "files": [
        {
          "filename": "ext/yajl/api/yajl_gen.h",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -63,7 +63,9 @@ extern \"C\" {\n         yajl_gen_invalid_number,\n         /** A print callback was passed in, so there is no internal\n          * buffer to get from */\n-        yajl_gen_no_buf\n+        yajl_gen_no_buf,\n+        /** Tried to decrement at depth 0 */\n+        yajl_depth_underflow\n     } yajl_gen_status;\n \n     /** an opaque handle to a generator */"
        },
        {
          "filename": "ext/yajl/yajl_gen.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -178,7 +178,7 @@ yajl_gen_free(yajl_gen g)\n     if (++(g->depth) >= YAJL_MAX_DEPTH) return yajl_max_depth_exceeded;\n \n #define DECREMENT_DEPTH \\\n-    if (--(g->depth) >= YAJL_MAX_DEPTH) return yajl_gen_error;\n+    if (--(g->depth) >= YAJL_MAX_DEPTH) return yajl_depth_underflow;\n \n #define APPENDED_ATOM \\\n     switch (g->state[g->depth]) {                   \\"
        },
        {
          "filename": "ext/yajl/yajl_lex.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -43,6 +43,7 @@ const char *yajl_tok_name(yajl_tok tok) {\n         case yajl_tok_bool: return \"bool\";\n         case yajl_tok_colon: return \"colon\";\n         case yajl_tok_comma: return \"comma\";\n+        case yajl_tok_comment: return \"comment\";\n         case yajl_tok_eof: return \"eof\";\n         case yajl_tok_error: return \"error\";\n         case yajl_tok_left_brace: return \"open_array\";"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "63760720e58d8cb818d59ae6c4f3d96760cd7854",
            "date": "2024-12-17T14:30:06Z",
            "author_login": "brianmario"
          },
          {
            "sha": "dcf11500a4e660874739ff01fe165968398cc4ba",
            "date": "2024-12-17T14:26:51Z",
            "author_login": "brianmario"
          },
          {
            "sha": "e8de283a6d64f0902740fd09e858fc3d7d803161",
            "date": "2022-05-25T19:03:28Z",
            "author_login": "HParker"
          },
          {
            "sha": "8971009a37436eb99ea65c4ac97fce867bd09e71",
            "date": "2022-05-18T19:33:17Z",
            "author_login": "mishina2228"
          },
          {
            "sha": "158f39f608c1d31013415368e4f9e8c85e05c36b",
            "date": "2022-05-18T19:30:11Z",
            "author_login": "jhawthorn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-122",
    "description": "yajl-ruby is a C binding to the YAJL JSON parsing and generation library. The 1.x branch and the 2.x branch of `yajl` contain an integer overflow which leads to subsequent heap memory corruption when dealing with large (~2GB) inputs. The reallocation logic at `yajl_buf.c#L64` may result in the `need` 32bit integer wrapping to 0 when `need` approaches a value of 0x80000000 (i.e. ~2GB of data), which results in a reallocation of buf->alloc into a small heap chunk. These integers are declared as `size_t` in the 2.x branch of `yajl`, which practically prevents the issue from triggering on 64bit platforms, however this does not preclude this issue triggering on 32bit builds on which `size_t` is a 32bit integer. Subsequent population of this under-allocated heap chunk is based on the original buffer size, leading to heap memory corruption. This vulnerability mostly impacts process availability. Maintainers believe exploitation for arbitrary code execution is unlikely. A patch is available and anticipated to be part of yajl-ruby version 1.4.2. As a workaround, avoid passing large inputs to YAJL.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-04-05T16:15:14.050",
    "last_modified": "2024-11-21T06:51:06.827",
    "fix_date": "2021-06-24T21:22:27Z"
  },
  "references": [
    {
      "url": "https://github.com/brianmario/yajl-ruby/blob/7168bd79b888900aa94523301126f968a93eb3a6/ext/yajl/yajl_buf.c#L64",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/brianmario/yajl-ruby/commit/7168bd79b888900aa94523301126f968a93eb3a6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/brianmario/yajl-ruby/security/advisories/GHSA-jj47-x69x-mxrm",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/07/msg00013.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/08/msg00003.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KLE3C4CECEJ4EUYI56KXI6OWACWXX7WN/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YO32YDJ74DADC7CMJNLSLBVWN5EXGF5J/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/brianmario/yajl-ruby/blob/7168bd79b888900aa94523301126f968a93eb3a6/ext/yajl/yajl_buf.c#L64",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/brianmario/yajl-ruby/commit/7168bd79b888900aa94523301126f968a93eb3a6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/brianmario/yajl-ruby/security/advisories/GHSA-jj47-x69x-mxrm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/07/msg00013.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/08/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KLE3C4CECEJ4EUYI56KXI6OWACWXX7WN/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YO32YDJ74DADC7CMJNLSLBVWN5EXGF5J/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.102804",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "yajl-ruby",
    "owner": "brianmario",
    "created_at": "2009-04-20T07:49:09Z",
    "updated_at": "2025-01-14T07:52:20Z",
    "pushed_at": "2024-12-17T14:30:06Z",
    "size": 3605,
    "stars": 1481,
    "forks": 171,
    "open_issues": 75,
    "watchers": 1481,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 172218,
      "Ruby": 93436,
      "Shell": 97
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:21:00.924848"
  }
}