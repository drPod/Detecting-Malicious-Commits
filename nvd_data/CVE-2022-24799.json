{
  "cve_id": "CVE-2022-24799",
  "github_data": {
    "repository": "wireapp/wire-webapp",
    "fix_commit": "d14455252a949dc83f36d45e2babbdd9328af2a4",
    "related_commits": [
      "d14455252a949dc83f36d45e2babbdd9328af2a4",
      "d14455252a949dc83f36d45e2babbdd9328af2a4"
    ],
    "patch_url": "https://github.com/wireapp/wire-webapp/commit/d14455252a949dc83f36d45e2babbdd9328af2a4.patch",
    "fix_commit_details": {
      "sha": "d14455252a949dc83f36d45e2babbdd9328af2a4",
      "commit_date": "2022-03-30T12:32:21Z",
      "author": {
        "login": "atomrc",
        "type": "User",
        "stats": {
          "total_commits": 1596,
          "average_weekly_commits": 3.5945945945945947,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 177
        }
      },
      "commit_message": {
        "title": "fix: Improve message rendering (#12748)",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/script/util/messageRenderer.ts",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -138,7 +138,7 @@ export const renderMessage = (message: string, selfId: QualifiedId | null, menti\n       if (containsMentions) {\n         // disable code highlighting if there is a mention in there\n         // highlighting will be wrong anyway because this is not valid code\n-        return code;\n+        return escape(code);\n       }\n       return hljs.highlightAuto(code).value;\n     },\n@@ -148,7 +148,7 @@ export const renderMessage = (message: string, selfId: QualifiedId | null, menti\n     const cleanString = (hashedString: string) =>\n       escape(\n         Object.entries(mentionTexts).reduce(\n-          (text, [mentionHash, mention]) => text.replace(mentionHash, mention.text),\n+          (text, [mentionHash, mention]) => text.replace(mentionHash, () => mention.text),\n           hashedString,\n         ),\n       );\n@@ -214,7 +214,7 @@ export const renderMessage = (message: string, selfId: QualifiedId | null, menti\n   const parsedText = Object.keys(mentionTexts).reduce((text, mentionHash) => {\n     const mentionMarkup = renderMention(mentionTexts[mentionHash]);\n \n-    return text.replace(mentionHash, mentionMarkup);\n+    return text.replace(mentionHash, () => mentionMarkup);\n   }, mentionlessText);\n   return parsedText;\n };"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "54c1432194d842adf054ae1ffedd9acb087e0ae0",
            "date": "2025-01-14T09:32:56Z",
            "author_login": "olafsulich"
          },
          {
            "sha": "de37c669b558186ffdb1d1adb1ed29ffe339b43b",
            "date": "2025-01-14T09:22:36Z",
            "author_login": "przemvs"
          },
          {
            "sha": "549fed0e77350bd1b2f50d62f1ff766d314beb29",
            "date": "2025-01-14T08:16:18Z",
            "author_login": "przemvs"
          },
          {
            "sha": "105b1e241ebf033812a641586cad3c923eb4c5cd",
            "date": "2025-01-13T16:22:50Z",
            "author_login": "waseemansar"
          },
          {
            "sha": "641bdf1881f9f563fd870b1600cee4535df4cc89",
            "date": "2025-01-13T14:04:30Z",
            "author_login": "thisisamir98"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-79",
    "description": "wire-webapp is the web application interface for the wire messaging service. Insufficient escaping in markdown \u201ccode highlighting\u201d in the wire-webapp resulted in the possibility of injecting and executing arbitrary HTML code and thus also JavaScript. If a user receives and views such a malicious message, arbitrary code is injected and executed in the context of the victim. This allows the attacker to fully control the user account. Wire-desktop clients that are connected to a vulnerable wire-webapp version are also vulnerable to this attack. The issue has been fixed in wire-webapp 2022-03-30-production.0 and is already deployed on all Wire managed services. On-premise instances of wire-webapp need to be updated to docker tag 2022-03-30-production.0-v0.29.2-0-d144552 or wire-server 2022-03-30 (chart/4.8.0), so that their applications are no longer affected. There are no known workarounds for this issue. ### Patches * The issue has been fixed in wire-webapp **2022-03-30-production.0** and is already deployed on all Wire managed services. * On-premise instances of wire-webapp need to be updated to docker tag **2022-03-30-production.0-v0.29.2-0-d144552** or wire-server **2022-03-30 (chart/4.8.0)**, so that their applications are no longer affected. ### Workarounds * No workarounds known ### For more information If you have any questions or comments about this advisory feel free to email us at [vulnerability-report@wire.com](mailto:vulnerability-report@wire.com) ### Credits We thank [Posix](https://twitter.com/po6ix) for reporting this vulnerability",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-20T18:15:10.937",
    "last_modified": "2024-11-21T06:51:07.400",
    "fix_date": "2022-03-30T12:32:21Z"
  },
  "references": [
    {
      "url": "https://github.com/wireapp/wire-webapp/commit/d14455252a949dc83f36d45e2babbdd9328af2a4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-webapp/releases/tag/2022-03-30-production.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-webapp/security/advisories/GHSA-5568-rfh8-vmhq",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-webapp/commit/d14455252a949dc83f36d45e2babbdd9328af2a4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-webapp/releases/tag/2022-03-30-production.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wireapp/wire-webapp/security/advisories/GHSA-5568-rfh8-vmhq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.396264",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wire-webapp",
    "owner": "wireapp",
    "created_at": "2016-07-21T15:34:05Z",
    "updated_at": "2025-01-14T09:33:00Z",
    "pushed_at": "2025-01-14T13:27:24Z",
    "size": 183984,
    "stars": 1149,
    "forks": 292,
    "open_issues": 68,
    "watchers": 1149,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [],
    "languages": {
      "JavaScript": 7174442,
      "TypeScript": 5670689,
      "Less": 308396,
      "Shell": 16243,
      "HTML": 13071,
      "EJS": 10888,
      "CSS": 4737,
      "GLSL": 1710,
      "Mustache": 815,
      "Dockerfile": 320,
      "Procfile": 23
    },
    "commit_activity": {
      "total_commits_last_year": 1930,
      "avg_commits_per_week": 37.11538461538461,
      "days_active_last_year": 284
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:55:00.209124"
  }
}