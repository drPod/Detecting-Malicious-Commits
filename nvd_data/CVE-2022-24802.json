{
  "cve_id": "CVE-2022-24802",
  "github_data": {
    "repository": "RebeccaStevens/deepmerge-ts",
    "fix_commit": "b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72",
    "related_commits": [
      "b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72",
      "d637db7e4fb2bfb113cb4bc1c85a125936d7081b",
      "b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72",
      "d637db7e4fb2bfb113cb4bc1c85a125936d7081b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72",
      "commit_date": "2022-03-31T08:01:53Z",
      "author": {
        "login": "RebeccaStevens",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #86 from RebeccaStevens/security/prototype-pollution",
        "length": 71,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 26,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/deepmerge.ts",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -438,7 +438,16 @@ function defaultMergeRecords<\n       continue;\n     }\n \n-    result[key] = propertyResult;\n+    if (key === \"__proto__\") {\n+      Object.defineProperty(result, key, {\n+        value: propertyResult,\n+        configurable: true,\n+        enumerable: true,\n+        writable: true,\n+      });\n+    } else {\n+      result[key] = propertyResult;\n+    }\n   }\n \n   /* eslint-enable functional/no-loop-statement, functional/no-conditional-statement */"
        },
        {
          "filename": "tests/deepmerge.test.ts",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -539,3 +539,19 @@ test(`merging objects with null prototype`, (t) => {\n \n   t.deepEqual(merged, expected);\n });\n+\n+test(\"prototype pollution\", (t) => {\n+  const payload = '{\"__proto__\":{\"a0\":true}}';\n+\n+  const x: any = JSON.parse(payload);\n+  const y: any = {};\n+\n+  const merged: any = deepmerge(x, y);\n+\n+  t.deepEqual(JSON.stringify(merged), payload);\n+\n+  t.not(({} as any).a0, true, \"Safe POJO\");\n+  t.not(x.a0, true, \"Safe x input\");\n+  t.not(y.a0, true, \"Safe y input\");\n+  t.not(merged.a0, true, \"Safe output\");\n+});"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "58556196c67ce47960856de1e8b15f83cfb71620",
            "date": "2025-01-23T02:10:39Z",
            "author_login": "semantic-release-bot"
          },
          {
            "sha": "6d85163aecce3981b3a2f5378cb17f471fa7566b",
            "date": "2025-01-23T02:09:33Z",
            "author_login": "RebeccaStevens"
          },
          {
            "sha": "98400c3ba6e9be7c8ee4530fc09c1c417bab6d50",
            "date": "2025-01-23T02:04:45Z",
            "author_login": "RebeccaStevens"
          },
          {
            "sha": "319462a385d482f573b9761404397d99b4bd1385",
            "date": "2024-11-28T05:53:25Z",
            "author_login": "RebeccaStevens"
          },
          {
            "sha": "d59f12de37b5c466a54b4d2c30a25e7967418d6f",
            "date": "2024-11-02T11:14:34Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-915",
    "description": "deepmerge-ts is a typescript library providing functionality to deep merging of javascript objects. deepmerge-ts is vulnerable to Prototype Pollution via file deepmerge.ts, function defaultMergeRecords(). This issue has been patched in version 4.0.2. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-04-01T00:15:08.763",
    "last_modified": "2024-11-21T06:51:07.880",
    "fix_date": "2022-03-31T08:01:53Z"
  },
  "references": [
    {
      "url": "https://github.com/RebeccaStevens/deepmerge-ts/commit/b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/RebeccaStevens/deepmerge-ts/commit/d637db7e4fb2bfb113cb4bc1c85a125936d7081b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/RebeccaStevens/deepmerge-ts/security/advisories/GHSA-r9w3-g83q-m6hq",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/RebeccaStevens/deepmerge-ts/commit/b39f1a93d9e1c3541bd2fe159fd696a16dbe1c72",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/RebeccaStevens/deepmerge-ts/commit/d637db7e4fb2bfb113cb4bc1c85a125936d7081b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/RebeccaStevens/deepmerge-ts/security/advisories/GHSA-r9w3-g83q-m6hq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.088624",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "deepmerge-ts",
    "owner": "RebeccaStevens",
    "created_at": "2021-08-23T01:26:46Z",
    "updated_at": "2025-01-23T02:10:43Z",
    "pushed_at": "2025-01-24T13:45:01Z",
    "size": 4072,
    "stars": 249,
    "forks": 10,
    "open_issues": 2,
    "watchers": 249,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 138741
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T08:30:09.945049"
  }
}