{
  "cve_id": "CVE-2022-24805",
  "github_data": {
    "repository": "net-snmp/net-snmp",
    "fix_commit": "67ebb43e9038b2dae6e74ae8838b36fcc10fc937",
    "related_commits": [
      "67ebb43e9038b2dae6e74ae8838b36fcc10fc937",
      "ce66eb97c17aa9a48bc079be7b65895266fa6775",
      "67ebb43e9038b2dae6e74ae8838b36fcc10fc937",
      "ce66eb97c17aa9a48bc079be7b65895266fa6775"
    ],
    "patch_url": "https://github.com/net-snmp/net-snmp/commit/67ebb43e9038b2dae6e74ae8838b36fcc10fc937.patch",
    "fix_commit_details": {
      "sha": "67ebb43e9038b2dae6e74ae8838b36fcc10fc937",
      "commit_date": "2021-06-30T21:00:28Z",
      "author": {
        "login": "fenner",
        "type": "User",
        "stats": {
          "total_commits": 231,
          "average_weekly_commits": 0.326271186440678,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 48
        }
      },
      "commit_message": {
        "title": "CHANGES: snmpd: fix bounds checking in NET-SNMP-AGENT-MIB, NET-SNMP-VACM-MIB, SNMP-VIEW-BASED-ACM-MIB, SNMP-USER-BASED-SM-MIB",
        "length": 213,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 23,
        "deletions": 4
      },
      "files": [
        {
          "filename": "agent/mibgroup/agent/nsLogging.c",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -147,6 +147,8 @@ handle_nsLoggingTable(netsnmp_mib_handler *handler,\n                 continue;\n             logh = (netsnmp_log_handler*)netsnmp_extract_iterator_context(request);\n             table_info  =                netsnmp_extract_table_info(request);\n+            if (!table_info || !table_info->indexes)\n+                continue;\n \n             switch (table_info->colnum) {\n             case NSLOGGING_TYPE:\n@@ -201,6 +203,8 @@ handle_nsLoggingTable(netsnmp_mib_handler *handler,\n             }\n             logh = (netsnmp_log_handler*)netsnmp_extract_iterator_context(request);\n             table_info  =                 netsnmp_extract_table_info(request);\n+            if (!table_info || !table_info->indexes)\n+                continue;\n \n             switch (table_info->colnum) {\n             case NSLOGGING_TYPE:\n@@ -394,6 +398,8 @@ handle_nsLoggingTable(netsnmp_mib_handler *handler,\n                 continue;\n             logh = (netsnmp_log_handler*)netsnmp_extract_iterator_context(request);\n             table_info  =                 netsnmp_extract_table_info(request);\n+            if (!table_info || !table_info->indexes)\n+                continue;\n \n             switch (table_info->colnum) {\n             case NSLOGGING_TYPE:"
        },
        {
          "filename": "agent/mibgroup/agent/nsVacmAccessTable.c",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -170,9 +170,13 @@ nsVacmAccessTable_handler(netsnmp_mib_handler *handler,\n             entry = (struct vacm_accessEntry *)\n                 netsnmp_extract_iterator_context(request);\n             table_info = netsnmp_extract_table_info(request);\n+            if (!table_info || !table_info->indexes)\n+                continue;\n \n             /* Extract the authType token from the list of indexes */\n             idx = table_info->indexes->next_variable->next_variable->next_variable->next_variable;\n+            if (idx->val_len >= sizeof(atype))\n+                continue;\n             memset(atype, 0, sizeof(atype));\n             memcpy(atype, (char *)idx->val.string, idx->val_len);\n             viewIdx = se_find_value_in_slist(VACM_VIEW_ENUM_NAME, atype);\n@@ -212,6 +216,8 @@ nsVacmAccessTable_handler(netsnmp_mib_handler *handler,\n             entry = (struct vacm_accessEntry *)\n                 netsnmp_extract_iterator_context(request);\n             table_info = netsnmp_extract_table_info(request);\n+            if (!table_info || !table_info->indexes)\n+                continue;\n             ret = SNMP_ERR_NOERROR;\n \n             switch (table_info->colnum) {\n@@ -247,6 +253,8 @@ nsVacmAccessTable_handler(netsnmp_mib_handler *handler,\n                  * Extract the authType token from the list of indexes\n                  */\n                 idx = table_info->indexes->next_variable->next_variable->next_variable->next_variable;\n+                if (idx->val_len >= sizeof(atype))\n+                    continue;\n                 memset(atype, 0, sizeof(atype));\n                 memcpy(atype, (char *)idx->val.string, idx->val_len);\n                 viewIdx = se_find_value_in_slist(VACM_VIEW_ENUM_NAME, atype);\n@@ -294,8 +302,10 @@ nsVacmAccessTable_handler(netsnmp_mib_handler *handler,\n                          idx = idx->next_variable;  model = *idx->val.integer;\n                          idx = idx->next_variable;  level = *idx->val.integer;\n                          entry = vacm_createAccessEntry( gName, cPrefix, model, level );\n-                         entry->storageType = ST_NONVOLATILE;\n-                         netsnmp_insert_iterator_context(request, (void*)entry);\n+                         if (entry) {\n+                             entry->storageType = ST_NONVOLATILE;\n+                             netsnmp_insert_iterator_context(request, (void*)entry);\n+                         }\n                     }\n                 }\n             }\n@@ -321,6 +331,8 @@ nsVacmAccessTable_handler(netsnmp_mib_handler *handler,\n \n             /* Extract the authType token from the list of indexes */\n             idx = table_info->indexes->next_variable->next_variable->next_variable->next_variable;\n+            if (idx->val_len >= sizeof(atype))\n+                continue;\n             memset(atype, 0, sizeof(atype));\n             memcpy(atype, (char *)idx->val.string, idx->val_len);\n             viewIdx = se_find_value_in_slist(VACM_VIEW_ENUM_NAME, atype);"
        },
        {
          "filename": "agent/mibgroup/mibII/vacm_vars.c",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -997,6 +997,9 @@ access_parse_oid(oid * oidIndex, size_t oidLen,\n         return 1;\n     }\n     groupNameL = oidIndex[0];\n+    if ((groupNameL + 1) > (int) oidLen) {\n+        return 1;\n+    }\n     contextPrefixL = oidIndex[groupNameL + 1];  /* the initial name length */\n     if ((int) oidLen != groupNameL + contextPrefixL + 4) {\n         return 1;"
        },
        {
          "filename": "agent/mibgroup/snmpv3/usmUser.c",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -1505,8 +1505,6 @@ write_usmUserStatus(int action,\n                 if (usmStatusCheck(uptr)) {\n                     uptr->userStatus = RS_ACTIVE;\n                 } else {\n-                    SNMP_FREE(engineID);\n-                    SNMP_FREE(newName);\n                     return SNMP_ERR_INCONSISTENTVALUE;\n                 }\n             } else if (long_ret == RS_CREATEANDWAIT) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1c6e66b3122b7fd878d17f40664adf831d1a2c7a",
            "date": "2024-12-18T05:40:40Z",
            "author_login": "orgads"
          },
          {
            "sha": "d17282ed842364d83be83d1a45ad95dd986cdb0a",
            "date": "2024-12-17T10:03:57Z",
            "author_login": "orgads"
          },
          {
            "sha": "59c0c1a2b8787fbfa0975549f41e64d31c5c2b60",
            "date": "2024-12-17T20:36:35Z",
            "author_login": "bvanassche"
          },
          {
            "sha": "75829eb857f2468001050fda26af843bcb9475db",
            "date": "2024-12-17T18:59:59Z",
            "author_login": "orgads"
          },
          {
            "sha": "46980afe4a4b5ce9820bd4419064d18e28fe215b",
            "date": "2024-12-11T15:56:25Z",
            "author_login": "bvanassche"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-120",
    "description": "net-snmp provides various tools relating to the Simple Network Management Protocol. Prior to version 5.9.2, a buffer overflow in the handling of the `INDEX` of             `NET-SNMP-VACM-MIB` can cause an out-of-bounds memory access. A user with read-only credentials can exploit the issue. Version 5.9.2 contains a patch. Users should use strong SNMPv3 credentials and avoid sharing the credentials. Those who must use SNMPv1 or SNMPv2c should use a complex community string and enhance the protection by restricting access to a given IP address range.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-16T20:15:07.600",
    "last_modified": "2024-11-21T06:51:08.307",
    "fix_date": "2021-06-30T21:00:28Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2103225",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2105238",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/net-snmp/net-snmp/commit/67ebb43e9038b2dae6e74ae8838b36fcc10fc937",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/net-snmp/net-snmp/commit/ce66eb97c17aa9a48bc079be7b65895266fa6775",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/08/msg00020.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FX75KKGMO5XMV6JMQZF6KOG3JPFNQBY7/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202210-29",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5209",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2103225",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2105238",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/net-snmp/net-snmp/commit/67ebb43e9038b2dae6e74ae8838b36fcc10fc937",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/net-snmp/net-snmp/commit/ce66eb97c17aa9a48bc079be7b65895266fa6775",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/08/msg00020.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FX75KKGMO5XMV6JMQZF6KOG3JPFNQBY7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202210-29",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5209",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.496282",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "net-snmp",
    "owner": "net-snmp",
    "created_at": "2018-04-09T19:19:27Z",
    "updated_at": "2025-01-13T17:42:11Z",
    "pushed_at": "2024-12-20T00:11:20Z",
    "size": 75523,
    "stars": 352,
    "forks": 224,
    "open_issues": 310,
    "watchers": 352,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 15335594,
      "Perl": 796786,
      "Shell": 669123,
      "M4": 216800,
      "Makefile": 96403,
      "XS": 64753,
      "Python": 32626,
      "Batchfile": 13387,
      "Mathematica": 7281,
      "OpenEdge ABL": 7281,
      "C++": 7003
    },
    "commit_activity": {
      "total_commits_last_year": 155,
      "avg_commits_per_week": 2.980769230769231,
      "days_active_last_year": 64
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:54:50.687765"
  }
}