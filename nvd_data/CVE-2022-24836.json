{
  "cve_id": "CVE-2022-24836",
  "github_data": {
    "repository": "sparklemotion/nokogiri",
    "fix_commit": "e444525ef1634b675cd1cf52d39f4320ef0aecfd",
    "related_commits": [
      "e444525ef1634b675cd1cf52d39f4320ef0aecfd",
      "e444525ef1634b675cd1cf52d39f4320ef0aecfd"
    ],
    "patch_url": "https://github.com/sparklemotion/nokogiri/commit/e444525ef1634b675cd1cf52d39f4320ef0aecfd.patch",
    "fix_commit_details": {
      "sha": "e444525ef1634b675cd1cf52d39f4320ef0aecfd",
      "commit_date": "2022-04-10T18:42:04Z",
      "author": {
        "login": "flavorjones",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(perf): HTML4::EncodingReader detection",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/nokogiri/html4/document.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -268,7 +268,7 @@ def start_element(name, attrs = [])\n         end\n \n         def self.detect_encoding(chunk)\n-          (m = chunk.match(/\\A(<\\?xml[ \\t\\r\\n]+[^>]*>)/)) &&\n+          (m = chunk.match(/\\A(<\\?xml[ \\t\\r\\n][^>]*>)/)) &&\n             (return Nokogiri.XML(m[1]).encoding)\n \n           if Nokogiri.jruby?"
        },
        {
          "filename": "test/html4/test_document_encoding.rb",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -155,6 +155,18 @@ def binopen(file)\n             end\n           end\n         end\n+\n+        it \"does not start backtracking during detection of XHTML encoding\" do\n+          # this test is a quick and dirty version\n+          # of the more complete perf test that is on main.\n+          n = 40_000\n+          redos_string = \"<?xml \" + (\" \" * n)\n+          redos_string.encode!(\"ASCII-8BIT\")\n+          start_time = Time.now\n+          Nokogiri::HTML4(redos_string)\n+          elapsed_time = Time.now - start_time\n+          assert_operator(elapsed_time, :<, 1)\n+        end\n       end\n     end\n   end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e3750182bc1a46572afd256ae53cc80802cf6759",
            "date": "2025-01-13T16:21:09Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "148dda460759453c1e595c6b6ef6d95f15264743",
            "date": "2025-01-10T15:10:51Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "adc292e5ca0da0db5bde29a241c5057b443593e8",
            "date": "2025-01-10T14:38:07Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "c5cd95a8b1f59e1318906c9f4b8980c48306908b",
            "date": "2025-01-06T19:44:15Z",
            "author_login": "flavorjones"
          },
          {
            "sha": "af5b1b0590e2f365763d1801a4a5106198b47a53",
            "date": "2025-01-06T16:47:04Z",
            "author_login": "flavorjones"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Nokogiri is an open source XML and HTML library for Ruby. Nokogiri `< v1.13.4` contains an inefficient regular expression that is susceptible to excessive backtracking when attempting to detect encoding in HTML documents. Users are advised to upgrade to Nokogiri `>= 1.13.4`. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-11T22:15:07.347",
    "last_modified": "2024-11-21T06:51:12.280",
    "fix_date": "2022-04-10T18:42:04Z"
  },
  "references": [
    {
      "url": "http://seclists.org/fulldisclosure/2022/Dec/23",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sparklemotion/nokogiri/commit/e444525ef1634b675cd1cf52d39f4320ef0aecfd",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-crjr-9rc5-ghw8",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00013.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/10/msg00018.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6DHCOWMA5PQTIQIMDENA7R2Y5BDYAIYM/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OUPLBUZVM4WPFSXBEP2JS3R6LMKRTLFC/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XMDCWRQXJQ3TFSETPCEFMQ6RR6ME5UA3/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-29",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT213532",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2022/Dec/23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sparklemotion/nokogiri/commit/e444525ef1634b675cd1cf52d39f4320ef0aecfd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-crjr-9rc5-ghw8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00013.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/10/msg00018.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/09/msg00010.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6DHCOWMA5PQTIQIMDENA7R2Y5BDYAIYM/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OUPLBUZVM4WPFSXBEP2JS3R6LMKRTLFC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XMDCWRQXJQ3TFSETPCEFMQ6RR6ME5UA3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-29",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT213532",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.371808",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "nokogiri",
    "owner": "sparklemotion",
    "created_at": "2008-07-14T15:34:32Z",
    "updated_at": "2025-01-13T16:21:33Z",
    "pushed_at": "2025-01-13T16:21:28Z",
    "size": 38122,
    "stars": 6162,
    "forks": 905,
    "open_issues": 88,
    "watchers": 6162,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v1.4.x",
      "v1.5.x",
      "v1.6.4.x",
      "v1.6.6.x"
    ],
    "languages": {
      "C": 1480966,
      "Ruby": 1281868,
      "Java": 657572,
      "C++": 273316,
      "HTML": 97438,
      "Ragel": 97111,
      "Shell": 7585,
      "Dockerfile": 6888,
      "Yacc": 6793,
      "Makefile": 5853,
      "REXX": 1965,
      "XSLT": 1868,
      "CSS": 422,
      "sed": 354
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:05:48.604878"
  }
}