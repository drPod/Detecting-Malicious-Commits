{
  "cve_id": "CVE-2022-24865",
  "github_data": {
    "repository": "humhub/humhub",
    "fix_commit": "eb83de20aaecc559ab77a44a6179646a99607e33",
    "related_commits": [
      "eb83de20aaecc559ab77a44a6179646a99607e33",
      "eb83de20aaecc559ab77a44a6179646a99607e33"
    ],
    "patch_url": "https://github.com/humhub/humhub/commit/eb83de20aaecc559ab77a44a6179646a99607e33.patch",
    "fix_commit_details": {
      "sha": "eb83de20aaecc559ab77a44a6179646a99607e33",
      "commit_date": "2022-04-19T15:57:30Z",
      "author": {
        "login": "yurabakhtin",
        "type": "User",
        "stats": {
          "total_commits": 791,
          "average_weekly_commits": 1.3852889667250439,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 194
        }
      },
      "commit_message": {
        "title": "Fix must change password (#5638)",
        "length": 218,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 8,
        "deletions": 12
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -9,6 +9,7 @@ HumHub Changelog\n - Fix #5517: Don't send \"Follows\" notification on request friendship\n - Fix #5563: Limit backup duration of RichText editor for 2 hours\n - Enh #5601: Backup RichText in sessionStorage\n+- Fix #5638: Removed return values from `codeCallback`\n - Fix #5634: Fix tests NonceCest\n - Fix #5644: Fix console command space/assign-all-members\n "
        },
        {
          "filename": "protected/humhub/components/behaviors/AccessControl.php",
          "status": "modified",
          "additions": 7,
          "deletions": 12,
          "patch": "@@ -11,9 +11,7 @@\n use humhub\\components\\access\\ControllerAccess;\n use Yii;\n use yii\\base\\ActionFilter;\n-use yii\\helpers\\Url;\n use yii\\web\\HttpException;\n-use yii\\web\\Response;\n \n /**\n  * Handles the AccessControl for a Controller.\n@@ -151,12 +149,13 @@ public function beforeAction($action)\n                 method_exists($this, $this->controllerAccess->codeCallback)) {\n                 // Call a specific function for current action filter,\n                 // may be used to filter a logged in user for some restriction e.g. \"must change password\"\n-                return call_user_func([$this, $this->controllerAccess->codeCallback]);\n+                call_user_func([$this, $this->controllerAccess->codeCallback]);\n             } else if ($this->controllerAccess->code == 401) {\n-                return $this->loginRequired();\n+                $this->loginRequired();\n             } else {\n                 $this->forbidden();\n             }\n+            return false;\n         }\n \n         return parent::beforeAction($action);\n@@ -217,31 +216,27 @@ protected function forbidden()\n     }\n \n     /**\n-     * @return bool forces user login\n+     * Force user to log in\n      */\n     protected function loginRequired()\n     {\n         Yii::$app->user->logout();\n         Yii::$app->user->loginRequired();\n-\n-        return false;\n     }\n \n     /**\n-     * @return Response Redirect user to force to change password\n+     * Force user to redirect to change password\n      * @since 1.8\n      */\n     protected function forceChangePassword()\n     {\n         if (!Yii::$app->user->isMustChangePasswordUrl()) {\n-            return Yii::$app->getResponse()->redirect(Url::toRoute(Yii::$app->user->mustChangePasswordRoute));\n+            Yii::$app->getResponse()->redirect([Yii::$app->user->mustChangePasswordRoute]);\n         }\n     }\n \n     /**\n      * Log out all non admin users when maintenance mode is active\n-     *\n-     * @return Response Redirect to home page\n      * @since 1.8\n      */\n     protected function checkMaintenanceMode()\n@@ -251,7 +246,7 @@ protected function checkMaintenanceMode()\n                 Yii::$app->user->logout();\n                 Yii::$app->getView()->warn(Yii::t('error', 'Maintenance mode activated: You have been automatically logged out and will no longer have access the platform until the maintenance has been completed.'));\n             }\n-            return Yii::$app->getResponse()->redirect(['/user/auth/login']);\n+            Yii::$app->getResponse()->redirect(['/user/auth/login']);\n         }\n     }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c238611a659890572b7dd0816c653b440f23552e",
            "date": "2025-01-13T17:57:11Z",
            "author_login": "luke-"
          },
          {
            "sha": "eecf111971696c562c3ec267b8bddcf6123f460d",
            "date": "2025-01-13T15:49:31Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "eca400bbae27560b4ebd7b416a2fd0eb168804be",
            "date": "2025-01-13T15:49:08Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "6163852d8a9f973c80be71457b0c0c6db7810244",
            "date": "2025-01-13T14:56:09Z",
            "author_login": "luke-"
          },
          {
            "sha": "376deed7431d75d16575bb19715ccea542fdab32",
            "date": "2025-01-13T14:49:26Z",
            "author_login": "luke-"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "HumHub is an Open Source Enterprise Social Network. In affected versions users who are forced to change their password by an administrator may retrieve other users' data. This issue has been resolved by commit `eb83de20`. It is recommended that the HumHub is upgraded to 1.11.0, 1.10.4 or 1.9.4. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-04-20T20:15:08.583",
    "last_modified": "2024-11-21T06:51:16.700",
    "fix_date": "2022-04-19T15:57:30Z"
  },
  "references": [
    {
      "url": "https://github.com/humhub/humhub/commit/eb83de20aaecc559ab77a44a6179646a99607e33",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/humhub/humhub/security/advisories/GHSA-2h35-f226-3f57",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/89d996a2-de30-4261-8e3f-98e54cb25f76/",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/humhub/humhub/commit/eb83de20aaecc559ab77a44a6179646a99607e33",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/humhub/humhub/security/advisories/GHSA-2h35-f226-3f57",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/89d996a2-de30-4261-8e3f-98e54cb25f76/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.397170",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "humhub",
    "owner": "humhub",
    "created_at": "2014-02-10T05:31:03Z",
    "updated_at": "2025-01-13T19:59:10Z",
    "pushed_at": "2025-01-14T13:43:22Z",
    "size": 130966,
    "stars": 6359,
    "forks": 1655,
    "open_issues": 737,
    "watchers": 6359,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "PHP": 13110954,
      "JavaScript": 538306,
      "CSS": 240453,
      "Less": 166067,
      "HTML": 7117,
      "Batchfile": 1030,
      "Hack": 461
    },
    "commit_activity": {
      "total_commits_last_year": 634,
      "avg_commits_per_week": 12.192307692307692,
      "days_active_last_year": 203
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:48:09.890758"
  }
}