{
  "cve_id": "CVE-2022-24884",
  "github_data": {
    "repository": "freifunk-gluon/ecdsautils",
    "fix_commit": "1d4b091abdf15ad7b2312535b5b95ad70f6dbd08",
    "related_commits": [
      "1d4b091abdf15ad7b2312535b5b95ad70f6dbd08",
      "39b6d0a77414fd41614953a0e185c4eefa2f88ad",
      "1d4b091abdf15ad7b2312535b5b95ad70f6dbd08",
      "39b6d0a77414fd41614953a0e185c4eefa2f88ad"
    ],
    "patch_url": "https://github.com/freifunk-gluon/ecdsautils/commit/1d4b091abdf15ad7b2312535b5b95ad70f6dbd08.patch",
    "fix_commit_details": {
      "sha": "1d4b091abdf15ad7b2312535b5b95ad70f6dbd08",
      "commit_date": "2022-04-20T20:04:07Z",
      "author": {
        "login": "neocturne",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "verify: fix signature verification (CVE-2022-24884)",
        "length": 423,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 10,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/lib/ecdsa.c",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -135,6 +135,12 @@ void ecdsa_sign_legacy(ecdsa_signature_t *signature, const ecc_int256_t *hash, c\n void ecdsa_verify_prepare_legacy(ecdsa_verify_context_t *ctx, const ecc_int256_t *hash, const ecdsa_signature_t *signature) {\n   ecc_int256_t w, u1, tmp;\n \n+  if (ecc_25519_gf_is_zero(&signature->s) || ecc_25519_gf_is_zero(&signature->r)) {\n+    // Signature is invalid, mark by setting ctx->r to an invalid value\n+    memset(&ctx->r, 0, sizeof(ctx->r));\n+    return;\n+  }\n+\n   ctx->r = signature->r;\n \n   ecc_25519_gf_recip(&w, &signature->s);\n@@ -149,6 +155,10 @@ bool ecdsa_verify_legacy(const ecdsa_verify_context_t *ctx, const ecc_25519_work\n   ecc_25519_work_t s2, work;\n   ecc_int256_t w, tmp;\n \n+  // Signature was detected as invalid in prepare step\n+  if (ecc_25519_gf_is_zero(&ctx->r))\n+    return false;\n+\n   ecc_25519_scalarmult(&s2, &ctx->u2, pubkey);\n   ecc_25519_add(&work, &ctx->s1, &s2);\n   ecc_25519_store_xy_legacy(&w, NULL, &work);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1b53b726f3dcc01e386060b7aba06bf69e1e0c41",
            "date": "2024-10-08T16:44:48Z",
            "author_login": "neocturne"
          },
          {
            "sha": "957fc91c75e889be13f1474961ee3dd41b8cacd5",
            "date": "2024-10-08T16:42:12Z",
            "author_login": "neocturne"
          },
          {
            "sha": "554e2585efd9a3a43e8a2206dcacb005cc388a8c",
            "date": "2024-09-21T14:15:23Z",
            "author_login": "neocturne"
          },
          {
            "sha": "8c17b073647f4546b401b55e7798980368a3c146",
            "date": "2024-09-21T14:09:49Z",
            "author_login": "neocturne"
          },
          {
            "sha": "39b6d0a77414fd41614953a0e185c4eefa2f88ad",
            "date": "2022-05-05T16:01:14Z",
            "author_login": "neocturne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 10.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-347",
    "description": "ecdsautils is a tiny collection of programs used for ECDSA (keygen, sign, verify). `ecdsa_verify_[prepare_]legacy()` does not check whether the signature values `r` and `s` are non-zero. A signature consisting only of zeroes is always considered valid, making it trivial to forge signatures. Requiring multiple signatures from different public keys does not mitigate the issue: `ecdsa_verify_list_legacy()` will accept an arbitrary number of such forged signatures. Both the `ecdsautil verify` CLI command and the libecdsautil library are affected. The issue has been fixed in ecdsautils 0.4.1. All older versions of ecdsautils (including versions before the split into a library and a CLI utility) are vulnerable.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-06T00:15:07.697",
    "last_modified": "2024-11-21T06:51:19.097",
    "fix_date": "2022-04-20T20:04:07Z"
  },
  "references": [
    {
      "url": "https://github.com/freifunk-gluon/ecdsautils/commit/1d4b091abdf15ad7b2312535b5b95ad70f6dbd08",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/freifunk-gluon/ecdsautils/commit/39b6d0a77414fd41614953a0e185c4eefa2f88ad",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/freifunk-gluon/ecdsautils/security/advisories/GHSA-qhcg-9ffp-78pw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00007.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4AKQH5WCBMJA3ODCSNERY6HVX4BX3ITG/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/G2JT57AAFIEL7JDO2ZBV25JKYME5NU54/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/L7UBR3M4U3LA46BHXYSH7EN5GDG44GK7/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5132",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/freifunk-gluon/ecdsautils/commit/1d4b091abdf15ad7b2312535b5b95ad70f6dbd08",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/freifunk-gluon/ecdsautils/commit/39b6d0a77414fd41614953a0e185c4eefa2f88ad",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/freifunk-gluon/ecdsautils/security/advisories/GHSA-qhcg-9ffp-78pw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/05/msg00007.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4AKQH5WCBMJA3ODCSNERY6HVX4BX3ITG/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/G2JT57AAFIEL7JDO2ZBV25JKYME5NU54/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/L7UBR3M4U3LA46BHXYSH7EN5GDG44GK7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2022/dsa-5132",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.085980",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ecdsautils",
    "owner": "freifunk-gluon",
    "created_at": "2018-12-13T20:37:54Z",
    "updated_at": "2024-11-29T05:51:25Z",
    "pushed_at": "2024-10-08T16:45:36Z",
    "size": 139,
    "stars": 12,
    "forks": 4,
    "open_issues": 0,
    "watchers": 12,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 59610,
      "CMake": 8186
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:53:57.648743"
  }
}