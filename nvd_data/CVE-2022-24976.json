{
  "cve_id": "CVE-2022-24976",
  "github_data": {
    "repository": "atheme/atheme",
    "fix_commit": "4e664c75d0b280a052eb8b5e81aa41944e593c52",
    "related_commits": [
      "4e664c75d0b280a052eb8b5e81aa41944e593c52",
      "4e664c75d0b280a052eb8b5e81aa41944e593c52"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "4e664c75d0b280a052eb8b5e81aa41944e593c52",
      "commit_date": "2021-10-17T13:13:22Z",
      "author": {
        "login": "edk0",
        "type": "User",
        "stats": {
          "total_commits": 12,
          "average_weekly_commits": 0.013029315960912053,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 8
        }
      },
      "commit_message": {
        "title": "saslserv/main: Track EID we're pending login to",
        "length": 839,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
      },
      "files": [
        {
          "filename": "include/atheme/sasl.h",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -62,6 +62,7 @@ struct sasl_session\n \tchar                            authzid[NICKLEN + 1];   // Authorization identity (user being logged in)\n \tchar                            authceid[IDLEN + 1];    // Entity ID for authcid\n \tchar                            authzeid[IDLEN + 1];    // Entity ID for authzid\n+\tchar                            pendingeid[IDLEN + 1];  // Entity ID for pending login (for pre-reg clients)\n \tchar                            uid[UIDLEN + 1];        // Network UID\n };\n "
        },
        {
          "filename": "modules/saslserv/main.c",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -385,15 +385,15 @@ sasl_handle_login(struct sasl_session *const restrict p, struct user *const u, s\n \t// Find the account if necessary\n \tif (! mu)\n \t{\n-\t\tif (! *p->authzeid)\n+\t\tif (! *p->pendingeid)\n \t\t{\n-\t\t\t(void) slog(LG_INFO, \"%s: session for '%s' without an authzeid (BUG)\",\n+\t\t\t(void) slog(LG_INFO, \"%s: session for '%s' without an pendingeid (BUG)\",\n \t\t\t                     MOWGLI_FUNC_NAME, u->nick);\n \t\t\t(void) notice(saslsvs->nick, u->nick, LOGIN_CANCELLED_STR);\n \t\t\treturn false;\n \t\t}\n \n-\t\tif (! (mu = myuser_find_uid(p->authzeid)))\n+\t\tif (! (mu = myuser_find_uid(p->pendingeid)))\n \t\t{\n \t\t\tif (*p->authzid)\n \t\t\t\t(void) notice(saslsvs->nick, u->nick, \"Account %s dropped; login cancelled\",\n@@ -638,6 +638,8 @@ sasl_process_packet(struct sasl_session *const restrict p, char *const restrict\n \t\t\t\treturn false;\n \t\t\t}\n \n+\t\t\t(void) mowgli_strlcpy(p->pendingeid, p->authzeid, sizeof p->pendingeid);\n+\n \t\t\t/* If the user is already on the network, attempt to log them in immediately.\n \t\t\t * Otherwise, we will log them in on introduction of user to network\n \t\t\t */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4d6dbd7c52995af7a60e1447166adf3d1e3333c8",
            "date": "2025-01-19T15:25:06Z",
            "author_login": "alyx"
          },
          {
            "sha": "269acaaa4888106cdb8392d453865fa793fec718",
            "date": "2025-01-17T20:13:13Z",
            "author_login": "SadieCat"
          },
          {
            "sha": "7af6627770fbe24d16a55dbe6f6d02aa41ecac84",
            "date": "2025-01-17T20:05:52Z",
            "author_login": "SadieCat"
          },
          {
            "sha": "11aa21b1da6066cb690c9573d9fa545c55275f1c",
            "date": "2025-01-14T15:04:56Z",
            "author_login": "SadieCat"
          },
          {
            "sha": "4b9e0966be9ce12ece6a60dc41387ec800ff1290",
            "date": "2025-01-02T13:26:27Z",
            "author_login": "SadieCat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-287",
    "description": "Atheme IRC Services before 7.2.12, when used in conjunction with InspIRCd, allows authentication bypass by ending an IRC handshake at a certain point during a challenge-response login sequence.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-02-14T12:15:27.680",
    "last_modified": "2024-11-21T06:51:29.377",
    "fix_date": "2021-10-17T13:13:22Z"
  },
  "references": [
    {
      "url": "https://github.com/atheme/atheme/commit/4e664c75d0b280a052eb8b5e81aa41944e593c52",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/atheme/atheme/compare/v7.2.11...v7.2.12",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2022/01/30/4",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/atheme/atheme/commit/4e664c75d0b280a052eb8b5e81aa41944e593c52",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/atheme/atheme/compare/v7.2.11...v7.2.12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2022/01/30/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.707440",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "atheme",
    "owner": "atheme",
    "created_at": "2011-07-27T05:05:08Z",
    "updated_at": "2025-01-21T05:21:35Z",
    "pushed_at": "2025-01-19T15:25:06Z",
    "size": 23418,
    "stars": 395,
    "forks": 174,
    "open_issues": 147,
    "watchers": 395,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release/7.0",
      "release/7.1",
      "release/7.2"
    ],
    "languages": {
      "C": 3246573,
      "PHP": 221001,
      "Perl": 200946,
      "M4": 142882,
      "Makefile": 56954,
      "Shell": 50112,
      "XS": 16941,
      "Rust": 7000,
      "Ruby": 671,
      "Python": 232
    },
    "commit_activity": {
      "total_commits_last_year": 46,
      "avg_commits_per_week": 0.8846153846153846,
      "days_active_last_year": 21
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:23:46.747582"
  }
}