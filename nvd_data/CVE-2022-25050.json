{
  "cve_id": "CVE-2022-25050",
  "github_data": {
    "repository": "merbanan/rtl_433",
    "fix_commit": "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
    "related_commits": [
      "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "commit_date": "2022-01-24T14:53:20Z",
      "author": {
        "login": "zuckschwerdt",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "minor: Fix overflow in Clipsal-CMR113 and Somfy-IOHC reported by aug5t7",
        "length": 71,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
      },
      "files": [
        {
          "filename": "src/devices/cmr113.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -42,8 +42,8 @@ Kudos to Jon Oxer for decoding this stream and putting it here:\n \n */\n \n-#define COMPARE_BITS 83\n-#define COMPARE_BYTES (COMPARE_BITS/8)\n+#define COMPARE_BITS  83\n+#define COMPARE_BYTES ((COMPARE_BITS + 7) / 8)\n \n static int cmr113_decode(r_device *decoder, bitbuffer_t *bitbuffer)\n {"
        },
        {
          "filename": "src/devices/somfy_iohc.c",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -100,11 +100,12 @@ static int somfy_iohc_decode(r_device *decoder, bitbuffer_t *bitbuffer)\n     if (bitbuffer->num_rows != 1)\n         return DECODE_ABORT_EARLY;\n \n-    int offset = bitbuffer_search(bitbuffer, 0, 0, preamble_pattern, 24) + 24;\n-    if (offset >= bitbuffer->bits_per_row[0] - 19 * 10)\n+    unsigned offset = bitbuffer_search(bitbuffer, 0, 0, preamble_pattern, 24) + 24;\n+    if (offset + 19 * 10 >= bitbuffer->bits_per_row[0])\n         return DECODE_ABORT_EARLY;\n \n-    int num_bits = bitbuffer->bits_per_row[0] - offset;\n+    unsigned num_bits = bitbuffer->bits_per_row[0] - offset;\n+    num_bits = MIN(num_bits, sizeof (b) * 8);\n \n     int len = extract_bytes_uart(bitbuffer->bb[0], offset, num_bits, b);\n     if (len < 19)\n@@ -120,7 +121,7 @@ static int somfy_iohc_decode(r_device *decoder, bitbuffer_t *bitbuffer)\n     // calculate and verify checksum\n     if (crc16lsb(b, len, 0x8408, 0x0000) != 0) // unreflected poly 0x1021\n         return DECODE_FAIL_MIC;\n-    bitrow_printf(b, len * 8, \"%s: offset %d, num_bits %d, len %d, msg_len %d\\n\", __func__, offset, num_bits, len, msg_len);\n+    bitrow_printf(b, len * 8, \"%s: offset %u, num_bits %u, len %d, msg_len %d\\n\", __func__, offset, num_bits, len, msg_len);\n \n     int msg_type = (b[0]);\n     int dst_id   = ((unsigned)b[4] << 24) | (b[3] << 16) | (b[2] << 8) | (b[1]); // assume Little-Endian"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "07e94eeb5fb8d1364bde6a0722abc0d0858f55c7",
            "date": "2025-01-25T21:29:21Z",
            "author_login": "meastman"
          },
          {
            "sha": "e215c2dcae130827d37d617b105fba5700ae0ef3",
            "date": "2025-01-25T10:30:05Z",
            "author_login": "madpilot"
          },
          {
            "sha": "5143625fa8e455172f97a92e96003cad2de70407",
            "date": "2025-01-20T21:41:22Z",
            "author_login": "zuckschwerdt"
          },
          {
            "sha": "9c2451873d72250e920e6be4dc38bbddc647b170",
            "date": "2025-01-17T21:20:07Z",
            "author_login": "killerbees19"
          },
          {
            "sha": "5e8f1d04419868b589c9535702cffa65a9bd6d63",
            "date": "2025-01-17T17:18:50Z",
            "author_login": "zuckschwerdt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-787",
    "description": "rtl_433 21.12 was discovered to contain a stack overflow in the function somfy_iohc_decode(). This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-03-02T00:15:08.250",
    "last_modified": "2024-11-21T06:51:35.533",
    "fix_date": "2022-01-24T14:53:20Z"
  },
  "references": [
    {
      "url": "https://github.com/merbanan/rtl_433/commit/2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/merbanan/rtl_433/issues/1960",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/6c9cd35f-a206-4fdf-b6d1-fcd50926c2d9/",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/merbanan/rtl_433/commit/2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/merbanan/rtl_433/issues/1960",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/6c9cd35f-a206-4fdf-b6d1-fcd50926c2d9/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.766618",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "rtl_433",
    "owner": "merbanan",
    "created_at": "2013-01-19T16:40:34Z",
    "updated_at": "2025-01-26T00:50:54Z",
    "pushed_at": "2025-01-25T21:29:21Z",
    "size": 9425,
    "stars": 6327,
    "forks": 1356,
    "open_issues": 230,
    "watchers": 6327,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 2927300,
      "C++": 204653,
      "CMake": 42842,
      "Python": 19575,
      "Shell": 7039
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:10:44.677949"
  }
}