{
  "cve_id": "CVE-2022-25051",
  "github_data": {
    "repository": "merbanan/rtl_433",
    "fix_commit": "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
    "related_commits": [
      "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8"
    ],
    "patch_url": "https://github.com/merbanan/rtl_433/commit/2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8.patch",
    "fix_commit_details": {
      "sha": "2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "commit_date": "2022-01-24T14:53:20Z",
      "author": {
        "login": "zuckschwerdt",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "minor: Fix overflow in Clipsal-CMR113 and Somfy-IOHC reported by aug5t7",
        "length": 71,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 7,
        "deletions": 6
      },
      "files": [
        {
          "filename": "src/devices/cmr113.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -42,8 +42,8 @@ Kudos to Jon Oxer for decoding this stream and putting it here:\n \n */\n \n-#define COMPARE_BITS 83\n-#define COMPARE_BYTES (COMPARE_BITS/8)\n+#define COMPARE_BITS  83\n+#define COMPARE_BYTES ((COMPARE_BITS + 7) / 8)\n \n static int cmr113_decode(r_device *decoder, bitbuffer_t *bitbuffer)\n {"
        },
        {
          "filename": "src/devices/somfy_iohc.c",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -100,11 +100,12 @@ static int somfy_iohc_decode(r_device *decoder, bitbuffer_t *bitbuffer)\n     if (bitbuffer->num_rows != 1)\n         return DECODE_ABORT_EARLY;\n \n-    int offset = bitbuffer_search(bitbuffer, 0, 0, preamble_pattern, 24) + 24;\n-    if (offset >= bitbuffer->bits_per_row[0] - 19 * 10)\n+    unsigned offset = bitbuffer_search(bitbuffer, 0, 0, preamble_pattern, 24) + 24;\n+    if (offset + 19 * 10 >= bitbuffer->bits_per_row[0])\n         return DECODE_ABORT_EARLY;\n \n-    int num_bits = bitbuffer->bits_per_row[0] - offset;\n+    unsigned num_bits = bitbuffer->bits_per_row[0] - offset;\n+    num_bits = MIN(num_bits, sizeof (b) * 8);\n \n     int len = extract_bytes_uart(bitbuffer->bb[0], offset, num_bits, b);\n     if (len < 19)\n@@ -120,7 +121,7 @@ static int somfy_iohc_decode(r_device *decoder, bitbuffer_t *bitbuffer)\n     // calculate and verify checksum\n     if (crc16lsb(b, len, 0x8408, 0x0000) != 0) // unreflected poly 0x1021\n         return DECODE_FAIL_MIC;\n-    bitrow_printf(b, len * 8, \"%s: offset %d, num_bits %d, len %d, msg_len %d\\n\", __func__, offset, num_bits, len, msg_len);\n+    bitrow_printf(b, len * 8, \"%s: offset %u, num_bits %u, len %d, msg_len %d\\n\", __func__, offset, num_bits, len, msg_len);\n \n     int msg_type = (b[0]);\n     int dst_id   = ((unsigned)b[4] << 24) | (b[3] << 16) | (b[2] << 8) | (b[1]); // assume Little-Endian"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f78fe658072a7be6d1c1613ec74d16b47c265654",
            "date": "2025-01-12T20:15:42Z",
            "author_login": "zuckschwerdt"
          },
          {
            "sha": "31ccc52a2c219f26ff7933467d4a396111875ee8",
            "date": "2025-01-11T21:52:05Z",
            "author_login": "zuckschwerdt"
          },
          {
            "sha": "d9249e24a5af22eb5fc36c8cced034305bb54b90",
            "date": "2025-01-07T17:04:59Z",
            "author_login": "zuckschwerdt"
          },
          {
            "sha": "af043b9089bbffe64e3c5785df5ef3bf53edf619",
            "date": "2025-01-06T10:37:15Z",
            "author_login": "zuckschwerdt"
          },
          {
            "sha": "7ca2fde18f357d338da4c987d737990564decadc",
            "date": "2025-01-05T21:28:03Z",
            "author_login": "zuckschwerdt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-193",
    "description": "An Off-by-one Error occurs in cmr113_decode of rtl_433 21.12 when decoding a crafted file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-03-02T00:15:08.293",
    "last_modified": "2024-11-21T06:51:35.663",
    "fix_date": "2022-01-24T14:53:20Z"
  },
  "references": [
    {
      "url": "https://github.com/merbanan/rtl_433/commit/2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/merbanan/rtl_433/issues/1960",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/78eee103-bd61-4b4f-b054-04ad996b39e7/",
      "source": "cve@mitre.org",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/merbanan/rtl_433/commit/2dad7b9fc67a1d0bfbe520fbd821678b8f8cc7a8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/merbanan/rtl_433/issues/1960",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/78eee103-bd61-4b4f-b054-04ad996b39e7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:02:59.766776",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rtl_433",
    "owner": "merbanan",
    "created_at": "2013-01-19T16:40:34Z",
    "updated_at": "2025-01-14T15:49:53Z",
    "pushed_at": "2025-01-12T20:15:48Z",
    "size": 9419,
    "stars": 6302,
    "forks": 1349,
    "open_issues": 226,
    "watchers": 6302,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 2926161,
      "C++": 204653,
      "CMake": 42842,
      "Python": 19575,
      "Shell": 7039
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T20:37:33.090130"
  }
}