{
  "cve_id": "CVE-2022-25845",
  "github_data": {
    "repository": "alibaba/fastjson",
    "fix_commit": "35db4adad70c32089542f23c272def1ad920a60d",
    "related_commits": [
      "35db4adad70c32089542f23c272def1ad920a60d",
      "8f3410f81cbd437f7c459f8868445d50ad301f15",
      "35db4adad70c32089542f23c272def1ad920a60d",
      "8f3410f81cbd437f7c459f8868445d50ad301f15"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "35db4adad70c32089542f23c272def1ad920a60d",
      "commit_date": "2022-05-02T06:16:19Z",
      "author": {
        "login": "wenshao",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "bug fix for autoType",
        "length": 20,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 44,
        "additions": 41,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/main/java/com/alibaba/fastjson/parser/ParserConfig.java",
          "status": "modified",
          "additions": 33,
          "deletions": 1,
          "patch": "@@ -208,8 +208,11 @@ public static ParserConfig getGlobalInstance() {\n     {\n         denyHashCodes = new long[]{\n                 0x80D0C70BCC2FEA02L,\n+                0x868385095A22725FL,\n                 0x86FC2BF9BEAF7AEFL,\n                 0x87F52A1B07EA33A6L,\n+                0x8872F29FD0B0B7A7L,\n+                0x8BAAEE8F9BF77FA7L,\n                 0x8EADD40CB2A94443L,\n                 0x8F75F9FA0DF03F80L,\n                 0x9172A53F157930AFL,\n@@ -222,6 +225,7 @@ public static ParserConfig getGlobalInstance() {\n                 0xAA3DAFFDB10C4937L,\n                 0xAAA9E6B7C1E1C6A7L,\n                 0xAAAA0826487A3737L,\n+                0xAB82562F53E6E48FL,\n                 0xAC6262F52C98AA39L,\n                 0xAD937A449831E8A0L,\n                 0xAE50DA1FAD60A096L,\n@@ -232,6 +236,7 @@ public static ParserConfig getGlobalInstance() {\n                 0xB98B6B5396932FE9L,\n                 0xBCDD9DC12766F0CEL,\n                 0xBCE0DEE34E726499L,\n+                0xBE4F13E96A6796D0L,\n                 0xBEBA72FB1CCBA426L,\n                 0xC00BE1DEBAF2808BL,\n                 0xC1086AFAE32E6258L,\n@@ -242,6 +247,7 @@ public static ParserConfig getGlobalInstance() {\n                 0xC8D49E5601E661A9L,\n                 0xC8F04B3A28909935L,\n                 0xC963695082FD728EL,\n+                0xCBF29CE484222325L,\n                 0xD1EFCDF4B3316D34L,\n                 0xD54B91CC77B239EDL,\n                 0xD59EE91F0B09EA01L,\n@@ -255,11 +261,14 @@ public static ParserConfig getGlobalInstance() {\n                 0xE1919804D5BF468FL,\n                 0xE2EB3AC7E56C467EL,\n                 0xE603D6A51FAD692BL,\n+                0xE704FD19052B2A34L,\n                 0xE9184BE55B1D962AL,\n                 0xE9F20BAD25F60807L,\n+                0xED13653CB45C4BEDL,\n                 0xF2983D099D29B477L,\n                 0xF3702A4A5490B8E8L,\n                 0xF474E44518F26736L,\n+                0xF4D93F4FB3E3D991L,\n                 0xF5D77DCF8E4D71E6L,\n                 0xF6C0340E73A36A69L,\n                 0xF7E96E74DFA58DBCL,\n@@ -276,10 +285,12 @@ public static ParserConfig getGlobalInstance() {\n                 0x55CFCA0F2281C07L,\n                 0xA555C74FE3A5155L,\n                 0xB6E292FA5955ADEL,\n+                0xBEF8514D0B79293L,\n                 0xEE6511B66FD5EF0L,\n                 0x100150A253996624L,\n                 0x10B2BDCA849D9B3EL,\n                 0x10DBC48446E0DAE5L,\n+                0x119B5B1F10210AFCL,\n                 0x144277B467723158L,\n                 0x14DB2E6FEAD04AF0L,\n                 0x154B6CB22D294CFAL,\n@@ -293,6 +304,7 @@ public static ParserConfig getGlobalInstance() {\n                 0x25E962F1C28F71A2L,\n                 0x275D0732B877AF29L,\n                 0x28AC82E44E933606L,\n+                0x2A71CE2CC40A710CL,\n                 0x2AD1CE3A112F015DL,\n                 0x2ADFEFBBFE29D931L,\n                 0x2B3A37467A344CDFL,\n@@ -304,17 +316,22 @@ public static ParserConfig getGlobalInstance() {\n                 0x332F0B5369A18310L,\n                 0x339A3E0B6BEEBEE9L,\n                 0x33C64B921F523F2FL,\n+                0x33E7F3E02571B153L,\n                 0x34A81EE78429FDF1L,\n+                0x37317698DCFCE894L,\n                 0x378307CB0111E878L,\n                 0x3826F4B2380C8B9BL,\n                 0x398F942E01920CF0L,\n                 0x3A31412DBB05C7FFL,\n+                0x3A7EE0635EB2BC33L,\n                 0x3ADBA40367F73264L,\n                 0x3B0B51ECBF6DB221L,\n+                0x3BF14094A524F0E2L,\n                 0x42D11A560FC9FBA9L,\n                 0x43320DC9D2AE0892L,\n                 0x440E89208F445FB9L,\n                 0x46C808A4B5841F57L,\n+                0x470FD3A18BB39414L,\n                 0x49312BDAFB0077D9L,\n                 0x4A3797B30328202CL,\n                 0x4BA3E254E758D70DL,\n@@ -323,8 +340,10 @@ public static ParserConfig getGlobalInstance() {\n                 0x4DA972745FEB30C1L,\n                 0x4EF08C90FF16C675L,\n                 0x4FD10DDC6D13821FL,\n+                0x521B4F573376DF4AL,\n                 0x527DB6B46CE3BCBCL,\n                 0x535E552D6F9700C1L,\n+                0x54855E265FE1DAD5L,\n                 0x5728504A6D454FFCL,\n                 0x599B5C1213A099ACL,\n                 0x5A5BD85C072E5EFEL,\n@@ -336,6 +355,7 @@ public static ParserConfig getGlobalInstance() {\n                 0x5F215622FB630753L,\n                 0x61C5BDD721385107L,\n                 0x62DB241274397C34L,\n+                0x636ECCA2A131B235L,\n                 0x63A220E60A17C7B9L,\n                 0x647AB0224E149EBEL,\n                 0x65F81B84C1D920CDL,\n@@ -349,9 +369,13 @@ public static ParserConfig getGlobalInstance() {\n                 0x74B50BB9260E31FFL,\n                 0x75CC60F5871D0FD3L,\n                 0x767A586A5107FEEFL,\n+                0x78E5935826671397L,\n+                0x793ADDDED7A967F5L,\n                 0x7AA7EE3627A19CF3L,\n+                0x7AFA070241B8CC4BL,\n                 0x7ED9311D28BF1A65L,\n-                0x7ED9481D28BF417AL\n+                0x7ED9481D28BF417AL,\n+                0x7EE6C477DA20BBE3L\n         };\n \n         long[] hashCodes = new long[AUTO_TYPE_ACCEPT_LIST.length];\n@@ -1445,6 +1469,10 @@ public Class<?> checkAutoType(String typeName, Class<?> expectClass, int feature\n             clazz = deserializers.findClass(typeName);\n         }\n \n+        if (expectClass == null && clazz != null && Throwable.class.isAssignableFrom(clazz) && !autoTypeSupport) {\n+            clazz = null;\n+        }\n+\n         if (clazz == null) {\n             clazz = typeMapping.get(typeName);\n         }\n@@ -1552,6 +1580,10 @@ public Class<?> checkAutoType(String typeName, Class<?> expectClass, int feature\n         }\n \n         if (!autoTypeSupport) {\n+            if (typeName.endsWith(\"Exception\")) {\n+                return null;\n+            }\n+\n             throw new JSONException(\"autoType is not support. \" + typeName);\n         }\n "
        },
        {
          "filename": "src/test/java/com/alibaba/json/bvt/bug/Bug_for_Exception.java",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -4,12 +4,18 @@\n \n import com.alibaba.fastjson.JSON;\n \n+import java.util.Map;\n+\n public class Bug_for_Exception extends TestCase {\n \tpublic void test_exception() throws Exception {\n \t\tRuntimeException ex = new RuntimeException(\"e1\");\n \t\tString text = JSON.toJSONString(ex);\n \t\tSystem.out.println(text);\n-\t\t\n-\t\tRuntimeException ex2 = (RuntimeException) JSON.parse(text);\n+\n+\n+\t\tObject obj = JSON.parse(text);\n+\t\tassertTrue(obj instanceof Map);\n+\n+\t\tRuntimeException ex2 = (RuntimeException) JSON.parseObject(text, Throwable.class);\n \t}\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c942c83443117b73af5ad278cc780270998ba3e1",
            "date": "2023-05-12T06:16:03Z",
            "author_login": "wenshao"
          },
          {
            "sha": "5bc4709b26df98b70ce62123e34300b0b5de8191",
            "date": "2023-04-16T01:54:14Z",
            "author_login": "wenshao"
          },
          {
            "sha": "2261016da2ab79f2ef92bd8cb6d7ef217383e4d7",
            "date": "2023-04-16T01:53:58Z",
            "author_login": "wenshao"
          },
          {
            "sha": "08dcc852d15aa361df23c17a2dcd46aebfd7cfb0",
            "date": "2023-03-19T12:57:40Z",
            "author_login": "wenshao"
          },
          {
            "sha": "436cae79bfb327f3641ac4c901e9411fc827b415",
            "date": "2023-01-28T15:51:05Z",
            "author_login": "wenshao"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-502",
    "description": "The package com.alibaba:fastjson before 1.2.83 are vulnerable to Deserialization of Untrusted Data by bypassing the default autoType shutdown restrictions, which is possible under certain conditions. Exploiting this vulnerability allows attacking remote servers. Workaround: If upgrading is not possible, you can enable [safeMode](https://github.com/alibaba/fastjson/wiki/fastjson_safemode).",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-06-10T20:15:08.117",
    "last_modified": "2024-11-21T06:53:06.320",
    "fix_date": "2022-05-02T06:16:19Z"
  },
  "references": [
    {
      "url": "https://github.com/alibaba/fastjson/commit/35db4adad70c32089542f23c272def1ad920a60d",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/commit/8f3410f81cbd437f7c459f8868445d50ad301f15",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/releases/tag/1.2.83",
      "source": "report@snyk.io",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/wiki/security_update_20220523",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-COMALIBABA-2859222",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.ddosi.org/fastjson-poc/",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/commit/35db4adad70c32089542f23c272def1ad920a60d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/commit/8f3410f81cbd437f7c459f8868445d50ad301f15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/releases/tag/1.2.83",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alibaba/fastjson/wiki/security_update_20220523",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-JAVA-COMALIBABA-2859222",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.ddosi.org/fastjson-poc/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpujul2022.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.429517",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "fastjson",
    "owner": "alibaba",
    "created_at": "2011-11-03T06:58:52Z",
    "updated_at": "2025-01-24T12:29:34Z",
    "pushed_at": "2024-07-16T07:35:37Z",
    "size": 15513,
    "stars": 25763,
    "forks": 6498,
    "open_issues": 2116,
    "watchers": 25763,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 7489145,
      "Kotlin": 5407,
      "JavaScript": 3661,
      "Shell": 414
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:42:00.778266"
  }
}