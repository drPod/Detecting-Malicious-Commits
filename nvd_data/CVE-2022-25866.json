{
  "cve_id": "CVE-2022-25866",
  "github_data": {
    "repository": "czproject/git-php",
    "fix_commit": "5e82d5479da5f16d37a915de4ec55e1ac78de733",
    "related_commits": [
      "5e82d5479da5f16d37a915de4ec55e1ac78de733",
      "5e82d5479da5f16d37a915de4ec55e1ac78de733"
    ],
    "patch_url": "https://github.com/czproject/git-php/commit/5e82d5479da5f16d37a915de4ec55e1ac78de733.patch",
    "fix_commit_details": {
      "sha": "5e82d5479da5f16d37a915de4ec55e1ac78de733",
      "commit_date": "2022-04-21T16:50:57Z",
      "author": {
        "login": "janpecha",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Uses --end-of-options after command options (for security reasons)",
        "length": 66,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 93,
        "additions": 48,
        "deletions": 45
      },
      "files": [
        {
          "filename": "src/Git.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -46,6 +46,7 @@ public function init($directory, array $params = NULL)\n \t\t\t\t$this->run($directory, [\n \t\t\t\t\t'init',\n \t\t\t\t\t$params,\n+\t\t\t\t\t'--end-of-options',\n \t\t\t\t\t$directory\n \t\t\t\t]);\n \n@@ -89,6 +90,7 @@ public function cloneRepository($url, $directory = NULL, array $params = NULL)\n \t\t\t\t$this->run($cwd, [\n \t\t\t\t\t'clone',\n \t\t\t\t\t$params,\n+\t\t\t\t\t'--end-of-options',\n \t\t\t\t\t$url,\n \t\t\t\t\t$directory\n \t\t\t\t]);\n@@ -120,6 +122,7 @@ public function isRemoteUrlReadable($url, array $refs = NULL)\n \t\t\t\t'--heads',\n \t\t\t\t'--quiet',\n \t\t\t\t'--exit-code',\n+\t\t\t\t'--end-of-options',\n \t\t\t\t$url,\n \t\t\t\t$refs,\n \t\t\t], ["
        },
        {
          "filename": "src/GitRepository.php",
          "status": "modified",
          "additions": 15,
          "deletions": 15,
          "patch": "@@ -52,7 +52,7 @@ public function getRepositoryPath()\n \t\t */\n \t\tpublic function createTag($name, $options = NULL)\n \t\t{\n-\t\t\t$this->run('tag', $options, $name);\n+\t\t\t$this->run('tag', $options, '--end-of-options', $name);\n \t\t\treturn $this;\n \t\t}\n \n@@ -86,7 +86,7 @@ public function renameTag($oldName, $newName)\n \t\t{\n \t\t\t// http://stackoverflow.com/a/1873932\n \t\t\t// create new as alias to old (`git tag NEW OLD`)\n-\t\t\t$this->run('tag', $newName, $oldName);\n+\t\t\t$this->run('tag', '--end-of-options', $newName, $oldName);\n \t\t\t// delete old (`git tag -d OLD`)\n \t\t\t$this->removeTag($oldName);\n \t\t\treturn $this;\n@@ -114,7 +114,7 @@ public function getTags()\n \t\t */\n \t\tpublic function merge($branch, $options = NULL)\n \t\t{\n-\t\t\t$this->run('merge', $options, $branch);\n+\t\t\t$this->run('merge', $options, '--end-of-options', $branch);\n \t\t\treturn $this;\n \t\t}\n \n@@ -131,7 +131,7 @@ public function merge($branch, $options = NULL)\n \t\tpublic function createBranch($name, $checkout = FALSE)\n \t\t{\n \t\t\t// git branch $name\n-\t\t\t$this->run('branch', $name);\n+\t\t\t$this->run('branch', '--end-of-options', $name);\n \n \t\t\tif ($checkout) {\n \t\t\t\t$this->checkout($name);\n@@ -234,7 +234,7 @@ public function getLocalBranches()\n \t\t */\n \t\tpublic function checkout($name)\n \t\t{\n-\t\t\t$this->run('checkout', $name);\n+\t\t\t$this->run('checkout', '--end-of-options', $name);\n \t\t\treturn $this;\n \t\t}\n \n@@ -253,7 +253,7 @@ public function removeFile($file)\n \t\t\t}\n \n \t\t\tforeach ($file as $item) {\n-\t\t\t\t$this->run('rm', $item, '-r');\n+\t\t\t\t$this->run('rm', '-r', '--end-of-options', $item);\n \t\t\t}\n \n \t\t\treturn $this;\n@@ -282,7 +282,7 @@ public function addFile($file)\n \t\t\t\t\tthrow new GitException(\"The path at '$item' does not represent a valid file.\");\n \t\t\t\t}\n \n-\t\t\t\t$this->run('add', $item);\n+\t\t\t\t$this->run('add', '--end-of-options', $item);\n \t\t\t}\n \n \t\t\treturn $this;\n@@ -319,7 +319,7 @@ public function renameFile($file, $to = NULL)\n \t\t\t}\n \n \t\t\tforeach ($file as $from => $to) {\n-\t\t\t\t$this->run('mv', $from, $to);\n+\t\t\t\t$this->run('mv', '--end-of-options', $from, $to);\n \t\t\t}\n \n \t\t\treturn $this;\n@@ -454,7 +454,7 @@ public function hasChanges()\n \t\t */\n \t\tpublic function pull($remote = NULL, array $params = NULL)\n \t\t{\n-\t\t\t$this->run('pull', $remote, $params);\n+\t\t\t$this->run('pull', $params, '--end-of-options', $remote);\n \t\t\treturn $this;\n \t\t}\n \n@@ -468,7 +468,7 @@ public function pull($remote = NULL, array $params = NULL)\n \t\t */\n \t\tpublic function push($remote = NULL, array $params = NULL)\n \t\t{\n-\t\t\t$this->run('push', $remote, $params);\n+\t\t\t$this->run('push', $params, '--end-of-options', $remote);\n \t\t\treturn $this;\n \t\t}\n \n@@ -482,7 +482,7 @@ public function push($remote = NULL, array $params = NULL)\n \t\t */\n \t\tpublic function fetch($remote = NULL, array $params = NULL)\n \t\t{\n-\t\t\t$this->run('fetch', $remote, $params);\n+\t\t\t$this->run('fetch', $params, '--end-of-options', $remote);\n \t\t\treturn $this;\n \t\t}\n \n@@ -497,7 +497,7 @@ public function fetch($remote = NULL, array $params = NULL)\n \t\t */\n \t\tpublic function addRemote($name, $url, array $params = NULL)\n \t\t{\n-\t\t\t$this->run('remote', 'add', $params, $name, $url);\n+\t\t\t$this->run('remote', 'add', $params, '--end-of-options', $name, $url);\n \t\t\treturn $this;\n \t\t}\n \n@@ -511,7 +511,7 @@ public function addRemote($name, $url, array $params = NULL)\n \t\t */\n \t\tpublic function renameRemote($oldName, $newName)\n \t\t{\n-\t\t\t$this->run('remote', 'rename', $oldName, $newName);\n+\t\t\t$this->run('remote', 'rename', '--end-of-options', $oldName, $newName);\n \t\t\treturn $this;\n \t\t}\n \n@@ -524,7 +524,7 @@ public function renameRemote($oldName, $newName)\n \t\t */\n \t\tpublic function removeRemote($name)\n \t\t{\n-\t\t\t$this->run('remote', 'remove', $name);\n+\t\t\t$this->run('remote', 'remove', '--end-of-options', $name);\n \t\t\treturn $this;\n \t\t}\n \n@@ -539,7 +539,7 @@ public function removeRemote($name)\n \t\t */\n \t\tpublic function setRemoteUrl($name, $url, array $params = NULL)\n \t\t{\n-\t\t\t$this->run('remote', 'set-url', $params, $name, $url);\n+\t\t\t$this->run('remote', 'set-url', $params, '--end-of-options', $name, $url);\n \t\t\treturn $this;\n \t\t}\n "
        },
        {
          "filename": "tests/GitPhp/GitRepository.branches.phpt",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -10,12 +10,12 @@ require __DIR__ . '/bootstrap.php';\n $runner = new AssertRunner(__DIR__);\n $git = new Git($runner);\n \n-$runner->assert(['branch', 'master']);\n-$runner->assert(['branch', 'develop']);\n-$runner->assert(['checkout', 'develop']);\n-$runner->assert(['merge', 'feature-1']);\n+$runner->assert(['branch', '--end-of-options', 'master']);\n+$runner->assert(['branch', '--end-of-options', 'develop']);\n+$runner->assert(['checkout', '--end-of-options', 'develop']);\n+$runner->assert(['merge', '--end-of-options', 'feature-1']);\n $runner->assert(['branch', '-d', 'feature-1']);\n-$runner->assert(['checkout', 'master']);\n+$runner->assert(['checkout', '--end-of-options', 'master']);\n \n $repo = $git->open(__DIR__);\n $repo->createBranch('master');"
        },
        {
          "filename": "tests/GitPhp/GitRepository.files.phpt",
          "status": "modified",
          "additions": 13,
          "deletions": 13,
          "patch": "@@ -14,11 +14,11 @@ $repo = $git->open(__DIR__ . '/fixtures');\n \n test(function () use ($repo, $runner) {\n \t$runner->resetAsserts();\n-\t$runner->assert(['add', 'file1.txt']);\n-\t$runner->assert(['add', 'file2.txt']);\n-\t$runner->assert(['add', 'file3.txt']);\n-\t$runner->assert(['add', 'file4.txt']);\n-\t$runner->assert(['add', 'file5.txt']);\n+\t$runner->assert(['add', '--end-of-options', 'file1.txt']);\n+\t$runner->assert(['add', '--end-of-options', 'file2.txt']);\n+\t$runner->assert(['add', '--end-of-options', 'file3.txt']);\n+\t$runner->assert(['add', '--end-of-options', 'file4.txt']);\n+\t$runner->assert(['add', '--end-of-options', 'file5.txt']);\n \n \t$repo->addFile('file1.txt');\n \t$repo->addFile([\n@@ -38,11 +38,11 @@ test(function () use ($repo) {\n \n test(function () use ($repo, $runner) {\n \t$runner->resetAsserts();\n-\t$runner->assert(['rm', 'file1.txt', '-r']);\n-\t$runner->assert(['rm', 'file2.txt', '-r']);\n-\t$runner->assert(['rm', 'file3.txt', '-r']);\n-\t$runner->assert(['rm', 'file4.txt', '-r']);\n-\t$runner->assert(['rm', 'file5.txt', '-r']);\n+\t$runner->assert(['rm', '-r', '--end-of-options', 'file1.txt']);\n+\t$runner->assert(['rm', '-r', '--end-of-options', 'file2.txt']);\n+\t$runner->assert(['rm', '-r', '--end-of-options', 'file3.txt']);\n+\t$runner->assert(['rm', '-r', '--end-of-options', 'file4.txt']);\n+\t$runner->assert(['rm', '-r', '--end-of-options', 'file5.txt']);\n \n \t$repo->removeFile('file1.txt');\n \t$repo->removeFile([\n@@ -55,9 +55,9 @@ test(function () use ($repo, $runner) {\n \n test(function () use ($repo, $runner) {\n \t$runner->resetAsserts();\n-\t$runner->assert(['mv', 'file1.txt', 'new1.txt']);\n-\t$runner->assert(['mv', 'file2.txt', 'new2.txt']);\n-\t$runner->assert(['mv', 'file3.txt', 'new3.txt']);\n+\t$runner->assert(['mv', '--end-of-options', 'file1.txt', 'new1.txt']);\n+\t$runner->assert(['mv', '--end-of-options', 'file2.txt', 'new2.txt']);\n+\t$runner->assert(['mv', '--end-of-options', 'file3.txt', 'new3.txt']);\n \n \t$repo->renameFile('file1.txt', 'new1.txt');\n \t$repo->renameFile(["
        },
        {
          "filename": "tests/GitPhp/GitRepository.remotes.phpt",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -10,17 +10,17 @@ require __DIR__ . '/bootstrap.php';\n $runner = new AssertRunner(__DIR__);\n $git = new Git($runner);\n \n-$runner->assert(['clone', '-q', 'git@github.com:czproject/git-php.git', __DIR__]);\n-$runner->assert(['remote', 'add', 'origin2', 'git@github.com:czproject/git-php.git']);\n-$runner->assert(['remote', 'add', 'remote', 'git@github.com:czproject/git-php.git']);\n+$runner->assert(['clone', '-q', '--end-of-options', 'git@github.com:czproject/git-php.git', __DIR__]);\n+$runner->assert(['remote', 'add', '--end-of-options', 'origin2', 'git@github.com:czproject/git-php.git']);\n+$runner->assert(['remote', 'add', '--end-of-options', 'remote', 'git@github.com:czproject/git-php.git']);\n $runner->assert(['remote', 'add', [\n \t'--mirror=push',\n-], 'only-push', 'test-url']);\n-$runner->assert(['remote', 'rename', 'remote', 'origin3']);\n+], '--end-of-options', 'only-push', 'test-url']);\n+$runner->assert(['remote', 'rename', '--end-of-options', 'remote', 'origin3']);\n $runner->assert(['remote', 'set-url', [\n \t'--push',\n-], 'origin3', 'test-url']);\n-$runner->assert(['remote', 'remove', 'origin2']);\n+], '--end-of-options', 'origin3', 'test-url']);\n+$runner->assert(['remote', 'remove', '--end-of-options', 'origin2']);\n \n $repo = $git->cloneRepository('git@github.com:czproject/git-php.git', __DIR__);\n $repo->addRemote('origin2', 'git@github.com:czproject/git-php.git');\n@@ -34,9 +34,9 @@ $repo->setRemoteUrl('origin3', 'test-url', [\n ]);\n $repo->removeRemote('origin2');\n \n-$runner->assert(['push', 'origin']);\n-$runner->assert(['fetch', 'origin']);\n-$runner->assert(['pull', 'origin']);\n+$runner->assert(['push', '--end-of-options', 'origin']);\n+$runner->assert(['fetch', '--end-of-options', 'origin']);\n+$runner->assert(['pull', '--end-of-options', 'origin']);\n $repo->push('origin');\n $repo->fetch('origin');\n $repo->pull('origin');"
        },
        {
          "filename": "tests/GitPhp/GitRepository.tags.phpt",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,8 +10,8 @@ require __DIR__ . '/bootstrap.php';\n $runner = new AssertRunner(__DIR__);\n $git = new Git($runner);\n \n-$runner->assert(['tag', 'v1.0.0']);\n-$runner->assert(['tag', 'v2.0.0', 'v1.0.0']);\n+$runner->assert(['tag', '--end-of-options', 'v1.0.0']);\n+$runner->assert(['tag', '--end-of-options', 'v2.0.0', 'v1.0.0']);\n $runner->assert(['tag', '-d', 'v1.0.0']);\n $runner->assert(['tag', '-d', 'v2.0.0']);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 4,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6ac190ea7711d90b8654739021e1c57c15d193ab",
            "date": "2024-08-18T16:02:29Z",
            "author_login": "janpecha"
          },
          {
            "sha": "f7fe85cc526c5f8e7ed809f7f9c68f2696940a8a",
            "date": "2024-08-05T13:26:21Z",
            "author_login": "janpecha"
          },
          {
            "sha": "a7eb77e93cafeacfc889a7d5656918b5c3245702",
            "date": "2024-08-05T13:25:46Z",
            "author_login": "janpecha"
          },
          {
            "sha": "41c63c2d93b32010992794096b210daa9d993153",
            "date": "2024-05-22T05:39:02Z",
            "author_login": "janpecha"
          },
          {
            "sha": "e257f2c3b43fe8fef19ddb5727b604416b423107",
            "date": "2023-07-12T09:14:30Z",
            "author_login": "janpecha"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-88",
    "description": "The package czproject/git-php before 4.0.3 are vulnerable to Command Injection via git argument injection. When calling the isRemoteUrlReadable($url, array $refs = NULL) function, both the url and refs parameters are passed to the git ls-remote subcommand in a way that additional flags can be set. The additional flags can be used to perform a command injection.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-04-25T17:15:36.637",
    "last_modified": "2024-11-21T06:53:08.347",
    "fix_date": "2022-04-21T16:50:57Z"
  },
  "references": [
    {
      "url": "https://github.com/czproject/git-php/commit/5e82d5479da5f16d37a915de4ec55e1ac78de733",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/czproject/git-php/releases/tag/v4.0.3",
      "source": "report@snyk.io",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-PHP-CZPROJECTGITPHP-2421349",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/czproject/git-php/commit/5e82d5479da5f16d37a915de4ec55e1ac78de733",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/czproject/git-php/releases/tag/v4.0.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://snyk.io/vuln/SNYK-PHP-CZPROJECTGITPHP-2421349",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.415764",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "git-php",
    "owner": "czproject",
    "created_at": "2013-04-19T17:08:14Z",
    "updated_at": "2025-01-03T15:21:09Z",
    "pushed_at": "2024-08-18T16:02:31Z",
    "size": 127,
    "stars": 511,
    "forks": 104,
    "open_issues": 18,
    "watchers": 511,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 57162,
      "Makefile": 432
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:40:39.570264"
  }
}