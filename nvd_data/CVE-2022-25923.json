{
  "cve_id": "CVE-2022-25923",
  "github_data": {
    "repository": "saeedseyfi/exec-local-bin",
    "fix_commit": "d425866375c85038133a6f79db2aac66c0a72624",
    "related_commits": [
      "d425866375c85038133a6f79db2aac66c0a72624",
      "d425866375c85038133a6f79db2aac66c0a72624"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "d425866375c85038133a6f79db2aac66c0a72624",
      "commit_date": "2023-01-04T16:43:01Z",
      "author": {
        "login": "saeedseyfi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixes(CVE-2022-25923): resolves command injection security issue",
        "length": 64,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 23,
        "deletions": 2
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 17,
          "deletions": 2,
          "patch": "@@ -1,8 +1,23 @@\n const exec = require('child_process').exec;\n+const fs = require('fs');\n+const path = require('path');\n \n module.exports = async function (bin, options) {\n-    return new Promise((resolve, reject) => {\n-        const cmd = `${process.cwd()}/node_modules/.bin/${bin}`;\n+    return new Promise(async (resolve, reject) => {\n+        const binDir = `${process.cwd()}/node_modules/.bin`;\n+        const cmd = path.join(binDir, bin);\n+\n+        if (!cmd.startsWith(binDir)) {\n+            reject(new Error(`${cmd} within the expected directory`));\n+            return;\n+        }\n+\n+        try {\n+            await fs.access(cmd, fs.constants.X_OK);\n+        } catch (err) {\n+            reject(new Error(`${cmd} is not accessible: ${err.message}`));\n+            return;\n+        }\n \n         console.log(`Running \\`${cmd}\\``);\n "
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -3,6 +3,12 @@\n   \"version\": \"1.1.1\",\n   \"description\": \"Helps you run local node binaries in node\",\n   \"main\": \"index.js\",\n+  \"files\": [\n+    \"index.js\"\n+  ],\n+  \"engines\": {\n+    \"node\": \"^8.0.0\"\n+  },\n   \"scripts\": {\n     \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n   },"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bb2155aee23cf7c65309819e6f42dd86eb8f63bb",
            "date": "2023-01-04T16:43:09Z",
            "author_login": "saeedseyfi"
          },
          {
            "sha": "d425866375c85038133a6f79db2aac66c0a72624",
            "date": "2023-01-04T16:43:01Z",
            "author_login": "saeedseyfi"
          },
          {
            "sha": "92db00bde9d6e2d83410849f898df12f075b73b0",
            "date": "2018-06-25T17:35:04Z",
            "author_login": "saeedseyfi"
          },
          {
            "sha": "0f543f432ed241d819f45f7aec868b0b7f4cb492",
            "date": "2018-06-25T17:33:52Z",
            "author_login": "saeedseyfi"
          },
          {
            "sha": "2e52ced54f77f128bc0bbc311d7d4fc58262ba98",
            "date": "2018-06-25T16:42:09Z",
            "author_login": "saeedseyfi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "Versions of the package exec-local-bin before 1.2.0 are vulnerable to Command Injection via the theProcess() functionality due to improper user-input sanitization.\r\r",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-01-06T05:15:11.537",
    "last_modified": "2024-11-21T06:53:13.970",
    "fix_date": "2023-01-04T16:43:01Z"
  },
  "references": [
    {
      "url": "https://github.com/saeedseyfi/exec-local-bin/blob/92db00bde9d6e2d83410849f898df12f075b73b0/index.js%23L9",
      "source": "report@snyk.io",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/saeedseyfi/exec-local-bin/commit/d425866375c85038133a6f79db2aac66c0a72624",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-EXECLOCALBIN-3157956",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saeedseyfi/exec-local-bin/blob/92db00bde9d6e2d83410849f898df12f075b73b0/index.js%23L9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/saeedseyfi/exec-local-bin/commit/d425866375c85038133a6f79db2aac66c0a72624",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-EXECLOCALBIN-3157956",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.518686",
    "processing_status": "enhanced"
  }
}