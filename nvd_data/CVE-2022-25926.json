{
  "cve_id": "CVE-2022-25926",
  "github_data": {
    "repository": "bruno-robert/window-control",
    "fix_commit": "075c854534a749d887655a906759f5a7eee95173",
    "related_commits": [
      "075c854534a749d887655a906759f5a7eee95173",
      "075c854534a749d887655a906759f5a7eee95173"
    ],
    "patch_url": "https://github.com/bruno-robert/window-control/commit/075c854534a749d887655a906759f5a7eee95173.patch",
    "fix_commit_details": {
      "sha": "075c854534a749d887655a906759f5a7eee95173",
      "commit_date": "2023-01-02T14:16:15Z",
      "author": {
        "login": "bruno-robert",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: add sanitisation to user input",
        "length": 35,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 66,
        "additions": 59,
        "deletions": 7
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 10,
          "deletions": 4,
          "patch": "@@ -15,6 +15,12 @@ const linuxGetWindowList = path.join(__dirname, 'linux', 'getWindowList.sh')\n const macGetWindowList = path.join(__dirname, 'mac', 'getWindowList.applescript')\n const winGetWindowList = path.join(__dirname, 'windows', 'listOpenWindows.bat')\n \n+const sanitiseUserInput = (input) => {\n+  let newInput = (' ' + input).slice(1)\n+  newInput = newInput.replaceAll(\"'\", \"\");\n+  return newInput\n+}\n+\n /**\n  * Focuses the first window of the process with the PID given\n  * @param {integer} id PID to use to find the application window\n@@ -63,7 +69,7 @@ const sendKeys = (id, keys, {resetFocus = false, pressEnterOnceDone = true} = {}\n     keys = keys.replace('\"', '\\\\\"')\n \n     if ( process.platform === 'darwin' ) {\n-      exec(`osascript \"${macFocusAndSendKeys}\" ${id} \"${keys}\" ${resetFocus} ${pressEnterOnceDone}`, (error, stdout, stderr) => {\n+      exec(`osascript \"${macFocusAndSendKeys}\" '${sanitiseUserInput(id)}' '${sanitiseUserInput(keys)}' ${resetFocus} ${pressEnterOnceDone}`, (error, stdout, stderr) => {\n         if (error) reject(error)\n         if (stderr) reject(stderr)\n         resolve(stdout)\n@@ -76,7 +82,7 @@ const sendKeys = (id, keys, {resetFocus = false, pressEnterOnceDone = true} = {}\n         keys = keys + '~'\n       }\n \n-      exec(`${winSendKeysToWindowName} \"${windowTitle}\" \"${keys}\"`, (error, stdout, stderr) => {\n+      exec(`${winSendKeysToWindowName} '${sanitiseUserInput(windowTitle)}' '${sanitiseUserInput(keys)}'`, (error, stdout, stderr) => {\n         if (error) reject(error)\n         if (stderr) reject(stderr)\n         resolve(stdout)\n@@ -86,7 +92,7 @@ const sendKeys = (id, keys, {resetFocus = false, pressEnterOnceDone = true} = {}\n       // TODO: add option to reset focus on linux\n       // TODO: add option to not press enter once keys have been sent\n       const windowID = id // although the function calls it pid, iin this case it's a windowID\n-      exec(`${sendTextToWindowWithId} ${windowID} \"${keys}\"`, (error, stdout, stderr) => {\n+      exec(`${sendTextToWindowWithId} '${sanitiseUserInput(windowID)}' '${sanitiseUserInput(keys)}'`, (error, stdout, stderr) => {\n         if (error) reject(error)\n         if (stderr) reject(stderr)\n         resolve(stdout)\n@@ -199,4 +205,4 @@ module.exports = {\n   focusWindow: focusWindow,\n   sendKeys: sendKeys,\n   getWindowList: getWindowList,\n-}\n\\ No newline at end of file\n+}"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 48,
          "deletions": 2,
          "patch": "@@ -1,8 +1,54 @@\n {\n   \"name\": \"window-control\",\n-  \"version\": \"1.4.4\",\n-  \"lockfileVersion\": 1,\n+  \"version\": \"1.4.5\",\n+  \"lockfileVersion\": 2,\n   \"requires\": true,\n+  \"packages\": {\n+    \"\": {\n+      \"name\": \"window-control\",\n+      \"version\": \"1.4.5\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"hazardous\": \"^0.3.0\",\n+        \"json5\": \"^2.1.1\"\n+      }\n+    },\n+    \"node_modules/callsite\": {\n+      \"version\": \"1.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/callsite/-/callsite-1.0.0.tgz\",\n+      \"integrity\": \"sha1-KAOY5dZkvXQDi28JBRU+borxvCA=\",\n+      \"engines\": {\n+        \"node\": \"*\"\n+      }\n+    },\n+    \"node_modules/hazardous\": {\n+      \"version\": \"0.3.0\",\n+      \"resolved\": \"https://registry.npmjs.org/hazardous/-/hazardous-0.3.0.tgz\",\n+      \"integrity\": \"sha512-VLSlBMoLTnfScKBJTycufZ2OHLO06eS3Q0mxNdHJ+egd1QLqeLitxDeGeUuoIgOqSPer+uqZCxiv43a1EVmwdg==\",\n+      \"dependencies\": {\n+        \"callsite\": \"^1.0.0\"\n+      }\n+    },\n+    \"node_modules/json5\": {\n+      \"version\": \"2.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/json5/-/json5-2.1.1.tgz\",\n+      \"integrity\": \"sha512-l+3HXD0GEI3huGq1njuqtzYK8OYJyXMkOLtQ53pjWh89tvWS2h6l+1zMkYWqlb57+SiQodKZyvMEFb2X+KrFhQ==\",\n+      \"dependencies\": {\n+        \"minimist\": \"^1.2.0\"\n+      },\n+      \"bin\": {\n+        \"json5\": \"lib/cli.js\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=6\"\n+      }\n+    },\n+    \"node_modules/minimist\": {\n+      \"version\": \"1.2.6\",\n+      \"resolved\": \"https://registry.npmjs.org/minimist/-/minimist-1.2.6.tgz\",\n+      \"integrity\": \"sha512-Jsjnk4bw3YJqYzbdyBiNsPWHPfO++UGG749Cxs6peCu5Xg4nrena6OVxOYxrQTqww0Jmwt+Ref8rggumkTLz9Q==\"\n+    }\n+  },\n   \"dependencies\": {\n     \"callsite\": {\n       \"version\": \"1.0.0\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"window-control\",\n-  \"version\": \"1.4.4\",\n+  \"version\": \"1.4.5\",\n   \"description\": \"Tools to manage window focus on mac, windows and linux\",\n   \"main\": \"index.js\",\n   \"scripts\": {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "075c854534a749d887655a906759f5a7eee95173",
            "date": "2023-01-02T14:16:15Z",
            "author_login": "bruno-robert"
          },
          {
            "sha": "3954822ef3f0307745cdbff21a965278dd0a357b",
            "date": "2022-04-12T08:27:23Z",
            "author_login": "bruno-robert"
          },
          {
            "sha": "63b544575b6f056ea853f19c44eb1dfe85df9392",
            "date": "2022-04-11T19:28:44Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "8f8003e5cc4a941efc16ab395d3ab418084fb74d",
            "date": "2019-11-09T22:08:52Z",
            "author_login": "bruno-robert"
          },
          {
            "sha": "d6c5944650e5bce44d9cd6ce104392bc599172d2",
            "date": "2019-11-09T17:50:50Z",
            "author_login": "bruno-robert"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "Versions of the package window-control before 1.4.5 are vulnerable to Command Injection via the sendKeys function, due to improper input sanitization.\r\r",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-01-04T18:15:09.027",
    "last_modified": "2024-11-21T06:53:14.110",
    "fix_date": "2023-01-02T14:16:15Z"
  },
  "references": [
    {
      "url": "https://github.com/bruno-robert/window-control/commit/075c854534a749d887655a906759f5a7eee95173",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bruno-robert/window-control/releases/tag/v1.4.5",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-WINDOWCONTROL-3186345",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bruno-robert/window-control/commit/075c854534a749d887655a906759f5a7eee95173",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bruno-robert/window-control/releases/tag/v1.4.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-WINDOWCONTROL-3186345",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.252584",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "window-control",
    "owner": "bruno-robert",
    "created_at": "2019-10-25T19:18:30Z",
    "updated_at": "2023-11-06T10:27:59Z",
    "pushed_at": "2023-01-02T14:48:42Z",
    "size": 40,
    "stars": 6,
    "forks": 2,
    "open_issues": 1,
    "watchers": 6,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 7664,
      "AppleScript": 2419,
      "Batchfile": 1933,
      "Shell": 238
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:22:50.289655"
  }
}