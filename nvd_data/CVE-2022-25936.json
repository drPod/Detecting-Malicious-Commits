{
  "cve_id": "CVE-2022-25936",
  "github_data": {
    "repository": "andrepolischuk/servst",
    "fix_commit": "f7cae5d2d7c64c86bc512e1e50614240396ef114",
    "related_commits": [
      "f7cae5d2d7c64c86bc512e1e50614240396ef114",
      "f7cae5d2d7c64c86bc512e1e50614240396ef114"
    ],
    "patch_url": "https://github.com/andrepolischuk/servst/commit/f7cae5d2d7c64c86bc512e1e50614240396ef114.patch",
    "fix_commit_details": {
      "sha": "f7cae5d2d7c64c86bc512e1e50614240396ef114",
      "commit_date": "2023-01-24T10:17:02Z",
      "author": {
        "login": "andrepolischuk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: fix limitation of a file path",
        "length": 82,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 57,
        "additions": 52,
        "deletions": 5
      },
      "files": [
        {
          "filename": "fixture/private/index.js",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "fixture/public-isprivate/index.js",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "fixture/public/index.js",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@ var mime = require('mime');\n \n module.exports = function(root) {\n   if (typeof root !== 'string') return;\n-  root = path.normalize(root);\n+  root = path.normalize(root + '/');\n \n   return function(req, res, fn) {\n     if (!/^(GET|HEAD)$/.test(req.method)) return fn();"
        },
        {
          "filename": "test.js",
          "status": "modified",
          "additions": 51,
          "deletions": 4,
          "patch": "@@ -3,7 +3,7 @@ var test = require('ava');\n var http = require('http');\n var request = require('supertest');\n var servst = require('./');\n-var statics = servst(__dirname);\n+var statics = servst(__dirname + '/fixture/public');\n \n var app = http.createServer(function (req, res) {\n   statics(req, res, function (err) {\n@@ -29,9 +29,32 @@ test.cb('return 200 for GET /', function (t) {\n     });\n });\n \n-test.cb('return 200 for GET /test.js', function (t) {\n+test.cb('return 200 for GET /index.js', function (t) {\n+  request(app)\n+    .get('/index.js')\n+    .expect(200)\n+    .expect('Content-Type', /javascript/)\n+    .end(function (err) {\n+      t.ifError(err);\n+      t.end();\n+    });\n+});\n+\n+test.cb('return 404 for GET /test.js', function (t) {\n   request(app)\n     .get('/test.js')\n+    .expect(404)\n+    .expect('Content-Type', /text/)\n+    .expect('Not found')\n+    .end(function (err) {\n+      t.ifError(err);\n+      t.end();\n+    });\n+});\n+\n+test.cb('return 200 for GET relative /public/index.js', function (t) {\n+  request(app)\n+    .get('/../public/index.js')\n     .expect(200)\n     .expect('Content-Type', /javascript/)\n     .end(function (err) {\n@@ -40,9 +63,33 @@ test.cb('return 200 for GET /test.js', function (t) {\n     });\n });\n \n-test.cb('return 404 GET /test2.js', function (t) {\n+test.cb('return 404 for GET relative /public/test.js', function (t) {\n+  request(app)\n+    .get('/../public/test.js')\n+    .expect(404)\n+    .expect('Content-Type', /text/)\n+    .expect('Not found')\n+    .end(function (err) {\n+      t.ifError(err);\n+      t.end();\n+    });\n+});\n+\n+test.cb('return 404 for GET relative /private/index.js', function (t) {\n+  request(app)\n+    .get('/../private/index.js')\n+    .expect(404)\n+    .expect('Content-Type', /text/)\n+    .expect('Not found')\n+    .end(function (err) {\n+      t.ifError(err);\n+      t.end();\n+    });\n+});\n+\n+test.cb('return 404 for GET relative /public-isprivate/index.js', function (t) {\n   request(app)\n-    .get('/test2.js')\n+    .get('/../public-isprivate/index.js')\n     .expect(404)\n     .expect('Content-Type', /text/)\n     .expect('Not found')"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3a9af0f05584bb95b3e2b7c169bc9e743915573c",
            "date": "2023-01-24T10:22:13Z",
            "author_login": "andrepolischuk"
          },
          {
            "sha": "f7cae5d2d7c64c86bc512e1e50614240396ef114",
            "date": "2023-01-24T10:17:02Z",
            "author_login": "andrepolischuk"
          },
          {
            "sha": "a1779b01a9e64395663f4a92f973e868a21844d2",
            "date": "2017-05-03T11:27:02Z",
            "author_login": "andrepolischuk"
          },
          {
            "sha": "89428a3e042df28a282cc52578249b5b576e03e8",
            "date": "2016-01-29T12:31:43Z",
            "author_login": "andrepolischuk"
          },
          {
            "sha": "96c1babade4e6ac6283cc9963c3f0626da5034d7",
            "date": "2016-01-29T12:31:23Z",
            "author_login": "andrepolischuk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Versions of the package servst before 2.0.3 are vulnerable to Directory Traversal due to improper sanitization of the filePath variable.\r\r",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-30T05:15:10.057",
    "last_modified": "2024-11-21T06:53:14.680",
    "fix_date": "2023-01-24T10:17:02Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/lirantal/691d02d607753d54856f9335f9a1692f",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/andrepolischuk/servst/commit/f7cae5d2d7c64c86bc512e1e50614240396ef114",
      "source": "report@snyk.io",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-SERVST-3244896",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gist.github.com/lirantal/691d02d607753d54856f9335f9a1692f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/andrepolischuk/servst/commit/f7cae5d2d7c64c86bc512e1e50614240396ef114",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-SERVST-3244896",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.953221",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "servst",
    "owner": "andrepolischuk",
    "created_at": "2014-12-09T14:00:05Z",
    "updated_at": "2023-01-24T10:22:43Z",
    "pushed_at": "2023-01-24T10:22:38Z",
    "size": 87,
    "stars": 1,
    "forks": 1,
    "open_issues": 0,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3308
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:38:54.604892"
  }
}