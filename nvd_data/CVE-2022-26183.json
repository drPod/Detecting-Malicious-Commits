{
  "cve_id": "CVE-2022-26183",
  "github_data": {
    "repository": "pnpm/pnpm",
    "fix_commit": "04b7f60861ddee8331e50d70e193d1e701abeefb",
    "related_commits": [
      "04b7f60861ddee8331e50d70e193d1e701abeefb",
      "04b7f60861ddee8331e50d70e193d1e701abeefb"
    ],
    "patch_url": "https://github.com/pnpm/pnpm/commit/04b7f60861ddee8331e50d70e193d1e701abeefb.patch",
    "fix_commit_details": {
      "sha": "04b7f60861ddee8331e50d70e193d1e701abeefb",
      "commit_date": "2021-09-15T20:49:05Z",
      "author": {
        "login": "zkochan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: prevent binary planting attacks on Windows",
        "length": 47,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 207,
        "additions": 125,
        "deletions": 82
      },
      "files": [
        {
          "filename": ".changeset/sweet-insects-carry.md",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+---\n+\"@pnpm/filter-workspace-packages\": patch\n+\"@pnpm/git-fetcher\": patch\n+\"@pnpm/git-resolver\": patch\n+\"@pnpm/plugin-commands-publishing\": patch\n+\"@pnpm/plugin-commands-script-runners\": patch\n+\"@pnpm/plugin-commands-setup\": patch\n+---\n+\n+Use safe-execa instead of execa to prevent binary planting attacks on Windows."
        },
        {
          "filename": "packages/beta/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n   },\n   \"devDependencies\": {\n     \"@zkochan/pkg\": \"0.0.0-2\",\n-    \"execa\": \"^5.0.0\"\n+    \"execa\": \"npm:safe-execa@^0.1.1\"\n   },\n   \"funding\": \"https://opencollective.com/pnpm\",\n   \"homepage\": \"https://github.com/pnpm/pnpm/blob/master/packages/beta#readme\","
        },
        {
          "filename": "packages/beta/scripts/build-artifacts.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-import execa from 'execa'\n+import * as execa from 'execa'\n import path from 'path'\n \n function build (target: string) {"
        },
        {
          "filename": "packages/filter-workspace-packages/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -31,7 +31,7 @@\n     \"@pnpm/error\": \"workspace:2.0.0\",\n     \"@pnpm/find-workspace-packages\": \"workspace:3.1.13\",\n     \"@pnpm/matcher\": \"workspace:2.0.0\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"find-up\": \"^5.0.0\",\n     \"is-subdir\": \"^1.1.1\",\n     \"micromatch\": \"^4.0.2\","
        },
        {
          "filename": "packages/git-fetcher/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -32,7 +32,7 @@\n     \"@pnpm/fetcher-base\": \"workspace:11.0.3\",\n     \"@pnpm/prepare-package\": \"workspace:1.0.3\",\n     \"@zkochan/rimraf\": \"^2.1.1\",\n-    \"execa\": \"^5.0.0\"\n+    \"execa\": \"npm:safe-execa@^0.1.1\"\n   },\n   \"devDependencies\": {\n     \"@pnpm/cafs\": \"workspace:3.0.7\","
        },
        {
          "filename": "packages/git-resolver/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -33,7 +33,7 @@\n   \"dependencies\": {\n     \"@pnpm/fetch\": \"workspace:4.1.1\",\n     \"@pnpm/resolver-base\": \"workspace:8.0.4\",\n-    \"graceful-git\": \"^3.0.2\",\n+    \"graceful-git\": \"^3.1.2\",\n     \"hosted-git-info\": \"npm:@zkochan/hosted-git-info@^4.0.2\",\n     \"semver\": \"^7.3.4\"\n   },"
        },
        {
          "filename": "packages/plugin-commands-env/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -50,7 +50,7 @@\n   \"devDependencies\": {\n     \"@pnpm/prepare\": \"workspace:0.0.26\",\n     \"@types/adm-zip\": \"^0.4.34\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"path-name\": \"^1.0.0\"\n   }\n }"
        },
        {
          "filename": "packages/plugin-commands-env/test/env.test.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@ import path from 'path'\n import PnpmError from '@pnpm/error'\n import { tempDir } from '@pnpm/prepare'\n import { env } from '@pnpm/plugin-commands-env'\n-import execa from 'execa'\n+import * as execa from 'execa'\n import PATH from 'path-name'\n \n test('install Node (and npm, npx) by exact version of Node.js', async () => {"
        },
        {
          "filename": "packages/plugin-commands-listing/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -37,7 +37,7 @@\n     \"@pnpm/plugin-commands-installation\": \"workspace:6.1.0\",\n     \"@pnpm/prepare\": \"workspace:0.0.26\",\n     \"@types/ramda\": \"0.27.39\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"strip-ansi\": \"^6.0.0\",\n     \"write-yaml-file\": \"^4.2.0\"\n   },"
        },
        {
          "filename": "packages/plugin-commands-publishing/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -43,7 +43,6 @@\n     \"@types/sinon\": \"^9.0.11\",\n     \"@types/tar\": \"^4.0.5\",\n     \"cross-spawn\": \"^7.0.3\",\n-    \"execa\": \"^5.0.0\",\n     \"is-ci\": \"^3.0.0\",\n     \"is-windows\": \"^1.0.2\",\n     \"load-json-file\": \"^6.2.0\",\n@@ -67,6 +66,7 @@\n     \"@pnpm/types\": \"workspace:7.4.0\",\n     \"@zkochan/rimraf\": \"^2.1.1\",\n     \"enquirer\": \"^2.3.6\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"fast-glob\": \"^3.2.4\",\n     \"npm-packlist\": \"^2.2.2\",\n     \"p-filter\": \"^2.1.0\","
        },
        {
          "filename": "packages/plugin-commands-rebuild/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -39,7 +39,7 @@\n     \"@types/ramda\": \"0.27.39\",\n     \"@types/semver\": \"^7.3.4\",\n     \"@types/sinon\": \"^9.0.11\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"path-exists\": \"^4.0.0\",\n     \"sinon\": \"^11.1.1\",\n     \"write-yaml-file\": \"^4.2.0\""
        },
        {
          "filename": "packages/plugin-commands-script-runners/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -37,7 +37,6 @@\n     \"@pnpm/prepare\": \"workspace:0.0.26\",\n     \"@types/ramda\": \"0.27.39\",\n     \"@zkochan/rimraf\": \"^2.1.1\",\n-    \"execa\": \"^5.0.0\",\n     \"is-windows\": \"^1.0.2\",\n     \"write-yaml-file\": \"^4.2.0\"\n   },\n@@ -52,6 +51,7 @@\n     \"@pnpm/sort-packages\": \"workspace:2.1.1\",\n     \"@pnpm/store-path\": \"^5.0.0\",\n     \"@pnpm/types\": \"workspace:7.4.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"p-limit\": \"^3.1.0\",\n     \"path-exists\": \"^4.0.0\",\n     \"path-name\": \"^1.0.0\","
        },
        {
          "filename": "packages/plugin-commands-script-runners/test/dlx.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@ import { prepareEmpty } from '@pnpm/prepare'\n test('dlx', async () => {\n   prepareEmpty()\n \n-  await dlx.handler({}, ['touch', 'foo'])\n+  await dlx.handler({}, ['shx', 'touch', 'foo'])\n \n   expect(fs.existsSync('foo')).toBeTruthy()\n })"
        },
        {
          "filename": "packages/plugin-commands-script-runners/test/runRecursive.ts",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -58,7 +58,7 @@ test('pnpm recursive run', async () => {\n   ])\n \n   const { allProjects, selectedProjectsGraph } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -130,7 +130,7 @@ test('pnpm recursive run reversed', async () => {\n   ])\n \n   const { allProjects, selectedProjectsGraph } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -182,7 +182,7 @@ test('pnpm recursive run concurrently', async () => {\n   ])\n \n   const { allProjects, selectedProjectsGraph } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -234,7 +234,7 @@ test('`pnpm recursive run` fails when run without filters and no package has the\n   ])\n \n   const { allProjects, selectedProjectsGraph } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -352,7 +352,7 @@ test('`pnpm recursive run` succeeds when run against a subset of packages and no\n   ])\n \n   const { allProjects } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -409,7 +409,7 @@ test('\"pnpm run --filter <pkg>\" without specifying the script name', async () =>\n   ])\n \n   const { allProjects } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -511,7 +511,7 @@ test('testing the bail config with \"pnpm recursive run\"', async () => {\n   ])\n \n   const { allProjects, selectedProjectsGraph } = await readProjects(process.cwd(), [])\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -592,7 +592,7 @@ test('pnpm recursive run with filtering', async () => {\n     [{ namePattern: 'project-1' }],\n     { workspaceDir: process.cwd() }\n   )\n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',\n@@ -629,7 +629,7 @@ test('`pnpm recursive run` should always trust the scripts', async () => {\n     },\n   ])\n \n-  await execa('pnpm', [\n+  await execa(pnpmBin, [\n     'install',\n     '-r',\n     '--registry',"
        },
        {
          "filename": "packages/plugin-commands-setup/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -30,7 +30,7 @@\n   \"homepage\": \"https://github.com/pnpm/pnpm/blob/master/packages/plugin-commands-setup#readme\",\n   \"dependencies\": {\n     \"@pnpm/cli-utils\": \"workspace:0.6.21\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"render-help\": \"^1.0.1\"\n   },\n   \"funding\": \"https://opencollective.com/pnpm\","
        },
        {
          "filename": "packages/plugin-commands-store/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -41,7 +41,7 @@\n     \"@types/sinon\": \"^9.0.11\",\n     \"@types/ssri\": \"^7.1.0\",\n     \"@zkochan/rimraf\": \"^2.1.1\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"load-json-file\": \"^6.2.0\",\n     \"path-exists\": \"^4.0.0\",\n     \"sinon\": \"^11.1.1\","
        },
        {
          "filename": "packages/pnpm/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -79,7 +79,7 @@\n     \"delay\": \"^5.0.0\",\n     \"dir-is-case-sensitive\": \"^2.0.0\",\n     \"esbuild\": \"^0.12.0\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"exists-link\": \"2.0.0\",\n     \"is-ci\": \"^3.0.0\",\n     \"is-windows\": \"^1.0.2\","
        },
        {
          "filename": "packages/prepare-package/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -29,7 +29,7 @@\n   \"dependencies\": {\n     \"@pnpm/read-package-json\": \"workspace:5.0.4\",\n     \"@zkochan/rimraf\": \"^2.1.1\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"preferred-pm\": \"^3.0.3\"\n   },\n   \"funding\": \"https://opencollective.com/pnpm\""
        },
        {
          "filename": "packages/supi/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -85,7 +85,7 @@\n     \"cross-spawn\": \"^7.0.3\",\n     \"deep-require-cwd\": \"1.0.0\",\n     \"dir-is-case-sensitive\": \"^2.0.0\",\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"exists-link\": \"2.0.0\",\n     \"is-ci\": \"^3.0.0\",\n     \"is-windows\": \"^1.0.2\","
        },
        {
          "filename": "pnpm-lock.yaml",
          "status": "modified",
          "additions": 87,
          "deletions": 54,
          "patch": "@@ -159,7 +159,7 @@ importers:\n       '@pnpm/macos-x64': workspace:0.0.6-6.15.0\n       '@pnpm/win-x64': workspace:0.0.6-6.15.0\n       '@zkochan/pkg': 0.0.0-2\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n     optionalDependencies:\n       '@pnpm/linux-x64': link:../artifacts/linux-x64\n       '@pnpm/macos-arm64': link:../artifacts/macos-arm64\n@@ -168,7 +168,7 @@ importers:\n     devDependencies:\n       '@pnpm/beta': 'link:'\n       '@zkochan/pkg': 0.0.0-2\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n \n   packages/build-modules:\n     specifiers:\n@@ -625,7 +625,7 @@ importers:\n       '@types/micromatch': ^4.0.1\n       '@types/ramda': 0.27.39\n       '@types/touch': ^3.1.1\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       find-up: ^5.0.0\n       is-ci: ^3.0.0\n       is-subdir: ^1.1.1\n@@ -639,7 +639,7 @@ importers:\n       '@pnpm/error': link:../error\n       '@pnpm/find-workspace-packages': link:../find-workspace-packages\n       '@pnpm/matcher': link:../matcher\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       find-up: 5.0.0\n       is-subdir: 1.2.0\n       micromatch: 4.0.4\n@@ -744,14 +744,14 @@ importers:\n       '@pnpm/prepare-package': workspace:1.0.3\n       '@pnpm/types': workspace:7.4.0\n       '@zkochan/rimraf': ^2.1.1\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       p-defer: ^3.0.0\n       tempy: ^1.0.0\n     dependencies:\n       '@pnpm/fetcher-base': link:../fetcher-base\n       '@pnpm/prepare-package': link:../prepare-package\n       '@zkochan/rimraf': 2.1.1\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n     devDependencies:\n       '@pnpm/cafs': link:../cafs\n       '@pnpm/git-fetcher': 'link:'\n@@ -768,14 +768,14 @@ importers:\n       '@types/hosted-git-info': ^3.0.1\n       '@types/is-windows': ^1.0.0\n       '@types/semver': ^7.3.4\n-      graceful-git: ^3.0.2\n+      graceful-git: ^3.1.2\n       hosted-git-info: npm:@zkochan/hosted-git-info@^4.0.2\n       is-windows: ^1.0.2\n       semver: ^7.3.4\n     dependencies:\n       '@pnpm/fetch': link:../fetch\n       '@pnpm/resolver-base': link:../resolver-base\n-      graceful-git: 3.0.2\n+      graceful-git: 3.1.2\n       hosted-git-info: /@zkochan/hosted-git-info/4.0.2\n       semver: 7.3.5\n     devDependencies:\n@@ -1788,7 +1788,7 @@ importers:\n       '@types/adm-zip': ^0.4.34\n       '@zkochan/cmd-shim': ^5.1.3\n       adm-zip: ^0.5.5\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       load-json-file: ^6.2.0\n       path-name: ^1.0.0\n       rename-overwrite: ^4.0.0\n@@ -1818,7 +1818,7 @@ importers:\n       '@pnpm/plugin-commands-env': 'link:'\n       '@pnpm/prepare': link:../../privatePackages/prepare\n       '@types/adm-zip': 0.4.34\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       path-name: 1.0.0\n \n   packages/plugin-commands-import:\n@@ -2002,7 +2002,7 @@ importers:\n       '@pnpm/prepare': workspace:0.0.26\n       '@pnpm/types': workspace:7.4.0\n       '@types/ramda': 0.27.39\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       ramda: ^0.27.1\n       render-help: ^1.0.1\n       strip-ansi: ^6.0.0\n@@ -2024,7 +2024,7 @@ importers:\n       '@pnpm/plugin-commands-listing': 'link:'\n       '@pnpm/prepare': link:../../privatePackages/prepare\n       '@types/ramda': 0.27.39\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       strip-ansi: 6.0.0\n       write-yaml-file: 4.2.0\n \n@@ -2120,7 +2120,7 @@ importers:\n       '@zkochan/rimraf': ^2.1.1\n       cross-spawn: ^7.0.3\n       enquirer: ^2.3.6\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       fast-glob: ^3.2.4\n       is-ci: ^3.0.0\n       is-windows: ^1.0.2\n@@ -2151,6 +2151,7 @@ importers:\n       '@pnpm/types': link:../types\n       '@zkochan/rimraf': 2.1.1\n       enquirer: 2.3.6\n+      execa: /safe-execa/0.1.1\n       fast-glob: 3.2.7\n       npm-packlist: 2.2.2\n       p-filter: 2.1.0\n@@ -2171,7 +2172,6 @@ importers:\n       '@types/sinon': 9.0.11\n       '@types/tar': 4.0.5\n       cross-spawn: 7.0.3\n-      execa: 5.1.1\n       is-ci: 3.0.0\n       is-windows: 1.0.2\n       load-json-file: 6.2.0\n@@ -2210,7 +2210,7 @@ importers:\n       '@zkochan/npm-package-arg': ^2.0.1\n       camelcase-keys: ^6.2.2\n       dependency-path: workspace:8.0.4\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       graph-sequencer: 2.0.0\n       load-json-file: ^6.2.0\n       mem: ^8.0.0\n@@ -2262,7 +2262,7 @@ importers:\n       '@types/ramda': 0.27.39\n       '@types/semver': 7.3.8\n       '@types/sinon': 9.0.11\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       path-exists: 4.0.0\n       sinon: 11.1.2\n       write-yaml-file: 4.2.0\n@@ -2285,7 +2285,7 @@ importers:\n       '@pnpm/types': workspace:7.4.0\n       '@types/ramda': 0.27.39\n       '@zkochan/rimraf': ^2.1.1\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       is-windows: ^1.0.2\n       p-limit: ^3.1.0\n       path-exists: ^4.0.0\n@@ -2305,6 +2305,7 @@ importers:\n       '@pnpm/sort-packages': link:../sort-packages\n       '@pnpm/store-path': 5.0.0\n       '@pnpm/types': link:../types\n+      execa: /safe-execa/0.1.1\n       p-limit: 3.1.0\n       path-exists: 4.0.0\n       path-name: 1.0.0\n@@ -2318,7 +2319,6 @@ importers:\n       '@pnpm/prepare': link:../../privatePackages/prepare\n       '@types/ramda': 0.27.39\n       '@zkochan/rimraf': 2.1.1\n-      execa: 5.1.1\n       is-windows: 1.0.2\n       write-yaml-file: 4.2.0\n \n@@ -2377,11 +2377,11 @@ importers:\n       '@pnpm/logger': ^4.0.0\n       '@pnpm/plugin-commands-setup': 'link:'\n       '@pnpm/prepare': workspace:0.0.26\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       render-help: ^1.0.1\n     dependencies:\n       '@pnpm/cli-utils': link:../cli-utils\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       render-help: 1.0.2\n     devDependencies:\n       '@pnpm/logger': 4.0.0\n@@ -2416,7 +2416,7 @@ importers:\n       archy: ^1.0.0\n       dependency-path: workspace:8.0.4\n       dint: ^5.1.0\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       load-json-file: ^6.2.0\n       p-filter: ^2.1.0\n       path-exists: ^4.0.0\n@@ -2456,7 +2456,7 @@ importers:\n       '@types/sinon': 9.0.11\n       '@types/ssri': 7.1.1\n       '@zkochan/rimraf': 2.1.1\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       load-json-file: 6.2.0\n       path-exists: 4.0.0\n       sinon: 11.1.2\n@@ -2525,7 +2525,7 @@ importers:\n       delay: ^5.0.0\n       dir-is-case-sensitive: ^2.0.0\n       esbuild: ^0.12.0\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       exists-link: 2.0.0\n       is-ci: ^3.0.0\n       is-windows: ^1.0.2\n@@ -2617,7 +2617,7 @@ importers:\n       delay: 5.0.0\n       dir-is-case-sensitive: 2.0.0\n       esbuild: 0.12.24\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       exists-link: 2.0.0\n       is-ci: 3.0.0\n       is-windows: 1.0.2\n@@ -2670,12 +2670,12 @@ importers:\n       '@pnpm/prepare-package': 'link:'\n       '@pnpm/read-package-json': workspace:5.0.4\n       '@zkochan/rimraf': ^2.1.1\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       preferred-pm: ^3.0.3\n     dependencies:\n       '@pnpm/read-package-json': link:../read-package-json\n       '@zkochan/rimraf': 2.1.1\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       preferred-pm: 3.0.3\n     devDependencies:\n       '@pnpm/prepare-package': 'link:'\n@@ -3046,7 +3046,7 @@ importers:\n       deep-require-cwd: 1.0.0\n       dependency-path: workspace:8.0.4\n       dir-is-case-sensitive: ^2.0.0\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       exists-link: 2.0.0\n       graph-sequencer: 2.0.0\n       is-ci: ^3.0.0\n@@ -3146,7 +3146,7 @@ importers:\n       cross-spawn: 7.0.3\n       deep-require-cwd: 1.0.0\n       dir-is-case-sensitive: 2.0.0\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       exists-link: 2.0.0\n       is-ci: 3.0.0\n       is-windows: 1.0.2\n@@ -3372,10 +3372,10 @@ importers:\n \n   utils/scripts:\n     specifiers:\n-      execa: ^5.0.0\n+      execa: npm:safe-execa@^0.1.1\n       make-empty-dir: ^2.0.0\n     dependencies:\n-      execa: 5.1.1\n+      execa: /safe-execa/0.1.1\n       make-empty-dir: 2.0.0\n \n   utils/tsconfig:\n@@ -4431,15 +4431,15 @@ packages:\n       load-json-file: 6.2.0\n     dev: true\n \n-  /@pnpm/cli-utils/0.6.17_@pnpm+logger@4.0.0:\n-    resolution: {integrity: sha512-4zsKAifcdt8rf66+GE6tpLwTwdPLU9TfeTxSbHSzqZwnFhCxUCN0FzuI+vv7RUOaxTS9D1wcTHIjtoqJCUbb4g==}\n+  /@pnpm/cli-utils/0.6.21_@pnpm+logger@4.0.0:\n+    resolution: {integrity: sha512-G0/YvHfNB+umbrEwJz6Pmd6GMxpm1xDsSeGaEu/aM/Ex31OzhiSZ8XOaIQiU160he/z3kGs9ySOPZDxhRJeLcQ==}\n     engines: {node: '>=12.17'}\n     peerDependencies:\n       '@pnpm/logger': ^4.0.0\n     dependencies:\n       '@pnpm/cli-meta': 2.0.0\n-      '@pnpm/config': 12.4.7\n-      '@pnpm/default-reporter': 8.1.12_@pnpm+logger@4.0.0\n+      '@pnpm/config': 12.5.0\n+      '@pnpm/default-reporter': 8.2.1_@pnpm+logger@4.0.0\n       '@pnpm/error': 2.0.0\n       '@pnpm/logger': 4.0.0\n       '@pnpm/manifest-utils': 2.0.4_@pnpm+logger@4.0.0\n@@ -4456,13 +4456,13 @@ packages:\n       chalk: 4.1.2\n     dev: false\n \n-  /@pnpm/config/12.4.7:\n-    resolution: {integrity: sha512-Y0yE/lYzJyNGdZFjmc1lzk/tECG+XRXi0CAVrroJIbwrCspmtuoLewSbujXj/49G2Eti0p520/OuWI9o/xbvgg==}\n+  /@pnpm/config/12.5.0:\n+    resolution: {integrity: sha512-xN+rCE0JkOu5rxgIGRUjpunJB1tn6SzINp7eLyat0v+slpuccweXIoPYKUt6QTDjJR2CRJHrWZ9lfG+zA8BYuQ==}\n     engines: {node: '>=12.17'}\n     dependencies:\n       '@pnpm/constants': 5.0.0\n       '@pnpm/error': 2.0.0\n-      '@pnpm/global-bin-dir': 2.0.0\n+      '@pnpm/global-bin-dir': 3.0.0\n       '@pnpm/types': 7.4.0\n       '@zkochan/npm-conf': 2.0.2\n       camelcase: 6.2.0\n@@ -4488,16 +4488,16 @@ packages:\n       '@pnpm/types': 7.4.0\n     dev: true\n \n-  /@pnpm/default-reporter/8.1.12_@pnpm+logger@4.0.0:\n-    resolution: {integrity: sha512-ZSgH5yyGKmRkJLfFHJ4ptxoNiUrLhEUxh9Ff67s978D97/DEWdg/DjwFx5TToCvPW9l7cT5Zo0nP+npbvmdQjQ==}\n+  /@pnpm/default-reporter/8.2.1_@pnpm+logger@4.0.0:\n+    resolution: {integrity: sha512-4yusyK4dGyk8kDJaVP1yCdsgSJnB7lS/9BSXLVh0iD2hrOwEMBKO6yBhEynuOVBYbGTcWxZ9BahnFMvrQGAS+w==}\n     engines: {node: '>=12.17'}\n     dependencies:\n-      '@pnpm/config': 12.4.7\n+      '@pnpm/config': 12.5.0\n       '@pnpm/core-loggers': 6.0.4_@pnpm+logger@4.0.0\n       '@pnpm/error': 2.0.0\n       '@pnpm/types': 7.4.0\n       ansi-diff: 1.1.1\n-      boxen: 5.0.1\n+      boxen: 5.1.1\n       chalk: 4.1.2\n       normalize-path: 3.0.0\n       pretty-bytes: 5.6.0\n@@ -4543,11 +4543,11 @@ packages:\n       find-up: 5.0.0\n     dev: true\n \n-  /@pnpm/find-workspace-packages/3.1.9_@pnpm+logger@4.0.0:\n-    resolution: {integrity: sha512-N2xJqnux0cFhyvWxxE0oO0b26xJa0GyfsZI0qBVjzUb9m5kpPPahmSqYIECQTWmEfhxQeqbvgyTsVfmUmLV99A==}\n+  /@pnpm/find-workspace-packages/3.1.13_@pnpm+logger@4.0.0:\n+    resolution: {integrity: sha512-WqqmNhlIv7utYie+gIAmho23bFPehKT08o2Jkg2n79Tz9rRCxXxyKqaPaUPObamClTgqDrZPEGVTxx7wbeOBpA==}\n     engines: {node: '>=12.17'}\n     dependencies:\n-      '@pnpm/cli-utils': 0.6.17_@pnpm+logger@4.0.0\n+      '@pnpm/cli-utils': 0.6.21_@pnpm+logger@4.0.0\n       '@pnpm/constants': 5.0.0\n       '@pnpm/types': 7.4.0\n       find-packages: 8.0.5\n@@ -4556,8 +4556,8 @@ packages:\n       - '@pnpm/logger'\n     dev: true\n \n-  /@pnpm/global-bin-dir/2.0.0:\n-    resolution: {integrity: sha512-TNV0RbtiNx/NfiB8iJfttySUwiadJx2kQb/yHbaCAXx3KGOKSgfA2mh+Lr4o40wIgOx7ROuoKZ0iVxYfq0jevA==}\n+  /@pnpm/global-bin-dir/3.0.0:\n+    resolution: {integrity: sha512-48Hw1JGftIO84o41Pm1+1kIulnFL0ca5VGPIQ+A1q1l3IVlxp2LnCX3424p+XIGG54US4pEQ7kMQaXhZBEBqbQ==}\n     engines: {node: '>=12.17'}\n     dependencies:\n       '@pnpm/error': 2.0.0\n@@ -4596,7 +4596,7 @@ packages:\n     hasBin: true\n     dependencies:\n       '@pnpm/find-workspace-dir': 3.0.1\n-      '@pnpm/find-workspace-packages': 3.1.9_@pnpm+logger@4.0.0\n+      '@pnpm/find-workspace-packages': 3.1.13_@pnpm+logger@4.0.0\n       '@pnpm/logger': 4.0.0\n       '@pnpm/types': 7.4.0\n       load-json-file: 6.2.0\n@@ -5435,6 +5435,13 @@ packages:\n       string-width: 4.2.2\n     dev: false\n \n+  /@zkochan/which/2.0.3:\n+    resolution: {integrity: sha512-C1ReN7vt2/2O0fyTsx5xnbQuxBrmG5NMSbcIkPKCCfCTJgpZBsuRYzFXHj3nVq8vTfK7vxHUmzfCpSHgO7j4rg==}\n+    engines: {node: '>= 8'}\n+    hasBin: true\n+    dependencies:\n+      isexe: 2.0.0\n+\n   /JSONStream/1.3.5:\n     resolution: {integrity: sha512-E+iruNOY8VV9s4JEbe1aNEm6MiszPRr/UfcHMz0TQh1BXSxHK+ASV1R6W4HpjBhSeS+54PIsAMCBmwD06LLsqQ==}\n     hasBin: true\n@@ -6267,6 +6274,21 @@ packages:\n       type-fest: 0.20.2\n       widest-line: 3.1.0\n       wrap-ansi: 7.0.0\n+    dev: false\n+\n+  /boxen/5.1.1:\n+    resolution: {integrity: sha512-JtIQYts08AFAYGF4eSh3pUt3NQkYV/e75pRtQmAVTLNWR/1L7Bsswxlgzgk8nmLEM+gFszsIlA9BgD3XnSqp3g==}\n+    engines: {node: '>=10'}\n+    dependencies:\n+      ansi-align: 3.0.0\n+      camelcase: 6.2.0\n+      chalk: 4.1.2\n+      cli-boxes: 2.2.1\n+      string-width: 4.2.2\n+      type-fest: 0.20.2\n+      widest-line: 3.1.0\n+      wrap-ansi: 7.0.0\n+    dev: true\n \n   /brace-expansion/1.1.11:\n     resolution: {integrity: sha512-iCuPHDFgrHX7H2vEI/5xpz07zSHB00TpugqhmYtVmMO6518mCuRMoOYFldEBl0g187ufozdaHgWKcYFb61qGiA==}\n@@ -8003,7 +8025,7 @@ packages:\n       merge-stream: 2.0.0\n       npm-run-path: 4.0.1\n       onetime: 5.1.2\n-      signal-exit: 3.0.3\n+      signal-exit: 3.0.4\n       strip-final-newline: 2.0.0\n \n   /exists-link/2.0.0:\n@@ -8755,12 +8777,12 @@ packages:\n   /graceful-fs/4.2.8:\n     resolution: {integrity: sha512-qkIilPUYcNhJpd33n0GBXTB1MMPp14TxEsEs0pTrsSVucApsYzW5V+Q8Qxhik6KU3evy+qkAAowTByymK0avdg==}\n \n-  /graceful-git/3.0.2:\n-    resolution: {integrity: sha512-fZ5zG+uT3zRqpRU7kXEUQkbRfIK66JRLfV528Glm703gr/qVfF0zppqC4ksuO1fLmlxBNAxLqQUfhF/vAriMtQ==}\n+  /graceful-git/3.1.2:\n+    resolution: {integrity: sha512-Xyh9Y43yA23/KQ16mpwO4zkzVGUAXyzuSVZQxw9ddQklssIYIY0el24VYfJBFhyCWGriZPRAB2nCgsDizqna9g==}\n     engines: {node: '>=10'}\n     dependencies:\n-      execa: 5.1.1\n       retry: 0.12.0\n+      safe-execa: 0.1.1\n     dev: false\n \n   /graceful-readlink/1.0.1:\n@@ -8799,7 +8821,7 @@ packages:\n       source-map: 0.6.1\n       wordwrap: 1.0.0\n     optionalDependencies:\n-      uglify-js: 3.14.1\n+      uglify-js: 3.14.2\n     dev: true\n \n   /har-schema/2.0.0:\n@@ -12922,6 +12944,14 @@ packages:\n   /safe-buffer/5.2.1:\n     resolution: {integrity: sha512-rp3So07KcdmmKbGvgaNxQSJr7bGVSVk5S9Eq1F+ppbRo70+YeaDxkw5Dd8NPN+GD6bjnYm2VuPuCXmpuYvmCXQ==}\n \n+  /safe-execa/0.1.1:\n+    resolution: {integrity: sha512-2KPID7iC4AMoJVozDPtcLGV+7LdpE0sR1hPkJUCaEnRsiYSZH2wgOFvxZ9UOtj1r8hNk8pVWn1tgmaEyyFZ4NA==}\n+    engines: {node: '>=12'}\n+    dependencies:\n+      '@zkochan/which': 2.0.3\n+      execa: 5.1.1\n+      path-name: 1.0.0\n+\n   /safe-regex/1.1.0:\n     resolution: {integrity: sha1-QKNmnzsHfR6UPURinhV91IAjvy4=}\n     dependencies:\n@@ -13105,6 +13135,9 @@ packages:\n   /signal-exit/3.0.3:\n     resolution: {integrity: sha512-VUJ49FC8U1OxwZLxIbTTrDvLnf/6TDgxZcK8wxR8zs13xpx7xbG60ndBlhNrFi2EMuFRoeDoJO7wthSLq42EjA==}\n \n+  /signal-exit/3.0.4:\n+    resolution: {integrity: sha512-rqYhcAnZ6d/vTPGghdrw7iumdcbXpsk1b8IG/rz+VWV51DM0p7XCtMoJ3qhPLIbp3tvyt3pKRbaaEMZYpHto8Q==}\n+\n   /signed-varint/2.0.1:\n     resolution: {integrity: sha1-UKmYnafJjCxh2tEZvJdHDvhSgSk=}\n     dependencies:\n@@ -14194,8 +14227,8 @@ packages:\n     hasBin: true\n     dev: true\n \n-  /uglify-js/3.14.1:\n-    resolution: {integrity: sha512-JhS3hmcVaXlp/xSo3PKY5R0JqKs5M3IV+exdLHW99qKvKivPO4Z8qbej6mte17SOPqAOVMjt/XGgWacnFSzM3g==}\n+  /uglify-js/3.14.2:\n+    resolution: {integrity: sha512-rtPMlmcO4agTUfz10CbgJ1k6UAoXM2gWb3GoMPPZB/+/Ackf8lNWk11K4rYi2D0apgoFRLtQOZhb+/iGNJq26A==}\n     engines: {node: '>=0.8.0'}\n     hasBin: true\n     requiresBuild: true"
        },
        {
          "filename": "utils/scripts/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n   \"version\": \"0.0.0\",\n   \"private\": true,\n   \"dependencies\": {\n-    \"execa\": \"^5.0.0\",\n+    \"execa\": \"npm:safe-execa@^0.1.1\",\n     \"make-empty-dir\": \"^2.0.0\"\n   }\n }"
        },
        {
          "filename": "utils/scripts/src/copy-artifacts.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n import fs from 'fs'\n-import execa from 'execa'\n+import * as execa from 'execa'\n import path from 'path'\n import makeEmptyDir from 'make-empty-dir'\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 15,
        "dependency_files": 15,
        "test_files": 3,
        "unique_directories": 21,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0bc7a3f7469c2d3038a605bb340e30d2b273e7a8",
            "date": "2025-01-14T00:04:10Z",
            "author_login": "KSXGitHub"
          },
          {
            "sha": "7a9473b2377c0a6da5992e82ae9cb283849844b1",
            "date": "2025-01-12T01:17:44Z",
            "author_login": "btea"
          },
          {
            "sha": "040e67b88d692a53824f7ca6458e92b373a1178b",
            "date": "2025-01-11T01:20:12Z",
            "author_login": "zkochan"
          },
          {
            "sha": "c96eb2b042b506dd57f14000157e86c0f1a84feb",
            "date": "2025-01-10T22:14:27Z",
            "author_login": "KSXGitHub"
          },
          {
            "sha": "4ca321903ca7aafb9407675d50b4cec325652b74",
            "date": "2025-01-10T12:24:05Z",
            "author_login": "zkochan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-426",
    "description": "PNPM v6.15.1 and below was discovered to contain an untrusted search path which causes the application to behave in unexpected ways when users execute PNPM commands in a directory containing malicious content. This vulnerability occurs when the application is ran on Windows OS.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-03-21T22:15:07.987",
    "last_modified": "2024-11-21T06:53:33.847",
    "fix_date": "2021-09-15T20:49:05Z"
  },
  "references": [
    {
      "url": "https://github.com/pnpm/pnpm/commit/04b7f60861ddee8331e50d70e193d1e701abeefb",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pnpm/pnpm/releases/tag/v6.15.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.sonarsource.com/blog/securing-developer-tools-package-managers/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pnpm/pnpm/commit/04b7f60861ddee8331e50d70e193d1e701abeefb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pnpm/pnpm/releases/tag/v6.15.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.sonarsource.com/blog/securing-developer-tools-package-managers/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.048981",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pnpm",
    "owner": "pnpm",
    "created_at": "2016-01-28T07:40:43Z",
    "updated_at": "2025-01-14T19:58:09Z",
    "pushed_at": "2025-01-14T16:15:34Z",
    "size": 177274,
    "stars": 30464,
    "forks": 1049,
    "open_issues": 1745,
    "watchers": 30464,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 4021871,
      "JavaScript": 21153,
      "Shell": 2229,
      "Batchfile": 689
    },
    "commit_activity": {
      "total_commits_last_year": 701,
      "avg_commits_per_week": 13.48076923076923,
      "days_active_last_year": 260
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T20:43:22.125058"
  }
}