{
  "cve_id": "CVE-2022-27168",
  "github_data": {
    "repository": "litecart/litecart",
    "fix_commit": "050fea86cc162f3da2f7824f586602125a0f6d63",
    "related_commits": [
      "050fea86cc162f3da2f7824f586602125a0f6d63",
      "050fea86cc162f3da2f7824f586602125a0f6d63"
    ],
    "patch_url": "https://github.com/litecart/litecart/commit/050fea86cc162f3da2f7824f586602125a0f6d63.patch",
    "fix_commit_details": {
      "sha": "050fea86cc162f3da2f7824f586602125a0f6d63",
      "commit_date": "2022-06-15T15:40:03Z",
      "author": {
        "login": "timint",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "* Escape HTML characters",
        "length": 24,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 42,
        "additions": 21,
        "deletions": 21
      },
      "files": [
        {
          "filename": "public_html/admin/catalog.app/edit_category.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -255,7 +255,7 @@\n                 <?php echo functions::form_draw_hidden_field('filters['.$key.'][id]', true); ?>\n                 <?php echo functions::form_draw_hidden_field('filters['.$key.'][attribute_group_id]', true); ?>\n                 <?php echo functions::form_draw_hidden_field('filters['.$key.'][attribute_group_name]', true); ?>\n-                <td class=\"grabable\"><?php echo $_POST['filters'][$key]['attribute_group_name']; ?></td>\n+                <td class=\"grabable\"><?php echo functions::escape_html($_POST['filters'][$key]['attribute_group_name']); ?></td>\n                 <td class=\"grabable\"><?php echo functions::form_draw_checkbox('filters['.$key.'][select_multiple]', '1', true); ?></td>\n                 <td class=\"text-end\">\n                   <a class=\"move-up\" href=\"#\" title=\"<?php echo language::translate('text_move_up', 'Move up'); ?>\"><?php echo functions::draw_fonticon('fa-arrow-circle-up fa-lg', 'style=\"color: #3399cc;\"'); ?></a>"
        },
        {
          "filename": "public_html/admin/catalog.app/edit_product.inc.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -433,9 +433,9 @@ functions::draw_lightbox();\n                 <?php echo functions::form_draw_hidden_field('attributes['.$key.'][value_id]', true); ?>\n                 <?php echo functions::form_draw_hidden_field('attributes['.$key.'][value_name]', true); ?>\n                 <?php echo functions::form_draw_hidden_field('attributes['.$key.'][custom_value]', true); ?>\n-                <td><?php echo $_POST['attributes'][$key]['group_name']; ?></td>\n-                <td><?php echo $_POST['attributes'][$key]['value_name']; ?></td>\n-                <td><?php echo $_POST['attributes'][$key]['custom_value']; ?></td>\n+                <td><?php echo functions::escape_html($_POST['attributes'][$key]['group_name']); ?></td>\n+                <td><?php echo functions::escape_html($_POST['attributes'][$key]['value_name']); ?></td>\n+                <td><?php echo functions::escape_html($_POST['attributes'][$key]['custom_value']); ?></td>\n                 <td class=\"text-end\"><a class=\"remove\" href=\"#\" title=\"<?php echo language::translate('title_remove', 'Remove'); ?>\"><?php echo functions::draw_fonticon('fa-times-circle fa-lg', 'style=\"color: #cc3333;\"'); ?></a></td>\n               </tr>\n               <?php } ?>\n@@ -747,7 +747,7 @@ functions::draw_lightbox();\n                 <tr>\n                   <td><?php echo functions::form_draw_hidden_field('options_stock['.$key.'][id]', true); ?><?php echo functions::form_draw_hidden_field('options_stock['.$key.'][combination]', true); ?>\n                     <?php echo functions::form_draw_hidden_field('options_stock['.$key.'][name]['. language::$selected['name'] .']', true); ?>\n-                    <?php echo $_POST['options_stock'][$key]['name'][language::$selected['code']]; ?></td>\n+                    <?php echo functions::escape_html($_POST['options_stock'][$key]['name'][language::$selected['code']]); ?></td>\n                   <td><?php echo functions::form_draw_text_field('options_stock['.$key.'][sku]', true); ?></td>\n                   <td>\n                     <div class=\"input-group\">"
        },
        {
          "filename": "public_html/admin/countries.app/edit_country.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -171,7 +171,7 @@\n         <tbody>\n           <?php if (!empty($_POST['zones'])) foreach (array_keys($_POST['zones']) as $key) { ?>\n           <tr>\n-            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][id]', true); ?><?php echo $_POST['zones'][$key]['id']; ?></td>\n+            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][id]', true); ?><?php echo functions::escape_html($_POST['zones'][$key]['id']); ?></td>\n             <td><?php echo functions::form_draw_text_field('zones['. $key .'][code]', true); ?></td>\n             <td><?php echo functions::form_draw_text_field('zones['. $key .'][name]', true); ?></td>\n             <td class=\"text-end\"><a class=\"remove\" href=\"#\" title=\"<?php echo language::translate('title_remove', 'Remove'); ?>\"><?php echo functions::draw_fonticon('fa-times-circle fa-lg', 'style=\"color: #cc3333;\"'); ?></a></td>"
        },
        {
          "filename": "public_html/admin/geo_zones.app/edit_geo_zone.inc.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -102,10 +102,10 @@\n         <tbody>\n           <?php if (!empty($_POST['zones'])) foreach (array_keys($_POST['zones']) as $key) { ?>\n           <tr>\n-            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][id]', true); ?><?php echo $_POST['zones'][$key]['id']; ?></td>\n-            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][country_code]', true); ?> <?php echo reference::country($_POST['zones'][$key]['country_code'])->name; ?></td>\n-            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][zone_code]', true); ?> <?php echo !empty($_POST['zones'][$key]['zone_code']) ? reference::country($_POST['zones'][$key]['country_code'])->zones[$_POST['zones'][$key]['zone_code']]['name'] : '-- '.language::translate('title_all_zones', 'All Zones') .' --'; ?></td>\n-            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][city]', true); ?> <?php echo !empty($_POST['zones'][$key]['city']) ? $_POST['zones'][$key]['city'] : '-- '.language::translate('title_all_cities', 'All Cities') .' --'; ?></td>\n+            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][id]', true); ?><?php echo functions::escape_html($_POST['zones'][$key]['id']); ?></td>\n+            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][country_code]', true); ?> <?php echo functions::escape_html(reference::country($_POST['zones'][$key]['country_code'])->name); ?></td>\n+            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][zone_code]', true); ?> <?php echo !empty($_POST['zones'][$key]['zone_code']) ? functions::escape_html(reference::country($_POST['zones'][$key]['country_code'])->zones[$_POST['zones'][$key]['zone_code']]['name']) : '-- '.language::translate('title_all_zones', 'All Zones') .' --'; ?></td>\n+            <td><?php echo functions::form_draw_hidden_field('zones['. $key .'][city]', true); ?> <?php echo !empty($_POST['zones'][$key]['city']) ? functions::escape_html($_POST['zones'][$key]['city']) : '-- '.language::translate('title_all_cities', 'All Cities') .' --'; ?></td>\n             <td class=\"text-end\"><a class=\"remove\" href=\"#\" title=\"<?php echo language::translate('title_remove', 'Remove'); ?>\"><?php echo functions::draw_fonticon('fa-times-circle fa-lg', 'style=\"color: #cc3333;\"'); ?></a></td>\n           </tr>\n           <?php } ?>"
        },
        {
          "filename": "public_html/admin/orders.app/edit_order.inc.php",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -569,7 +569,7 @@ functions::draw_lightbox();\n                 <?php echo functions::form_draw_hidden_field('comments['. $key .'][author]', true); ?>\n                 <?php echo functions::form_draw_hidden_field('comments['. $key .'][text]', true); ?>\n \n-                <div class=\"text\"><?php echo nl2br($_POST['comments'][$key]['text']); ?></div>\n+                <div class=\"text\"><?php echo nl2br(functions::escape_html($_POST['comments'][$key]['text'])); ?></div>\n \n                 <div class=\"date\"><?php echo language::strftime(language::$selected['format_datetime'], !empty($_POST['comments'][$key]['date_created']) ? strtotime($_POST['comments'][$key]['date_created']) : 0); ?></div>\n \n@@ -610,7 +610,7 @@ functions::draw_lightbox();\n               <?php if (!empty($_POST['items'])) foreach (array_keys($_POST['items']) as $key) { ?>\n               <tr class=\"item\">\n                 <td>\n-                  <?php echo !empty($_POST['items'][$key]['product_id']) ? '<a href=\"'. document::href_link(WS_DIR_ADMIN, ['app' => 'catalog', 'doc' => 'edit_product', 'product_id' => $_POST['items'][$key]['product_id']]) .'\" target=\"_blank\">'. $_POST['items'][$key]['name'] .'</a>' : $_POST['items'][$key]['name']; ?> <?php echo '<a class=\"float-end\" href=\"'. document::href_ilink('product', ['product_id' => $_POST['items'][$key]['product_id']]) .'\" target=\"_blank\">'. functions::draw_fonticon('fa-external-link') .'</a>'; ?>\n+                  <?php echo !empty($_POST['items'][$key]['product_id']) ? '<a href=\"'. document::href_link(WS_DIR_ADMIN, ['app' => 'catalog', 'doc' => 'edit_product', 'product_id' => $_POST['items'][$key]['product_id']]) .'\" target=\"_blank\">'. functions::escape_html($_POST['items'][$key]['name']) .'</a>' : functions::escape_html($_POST['items'][$key]['name']); ?> <?php echo '<a class=\"float-end\" href=\"'. document::href_ilink('product', ['product_id' => $_POST['items'][$key]['product_id']]) .'\" target=\"_blank\">'. functions::draw_fonticon('fa-external-link') .'</a>'; ?>\n                   <?php echo functions::form_draw_hidden_field('items['.$key.'][id]', true); ?>\n                   <?php echo functions::form_draw_hidden_field('items['.$key.'][product_id]', true); ?>\n                   <?php echo functions::form_draw_hidden_field('items['.$key.'][option_stock_combination]', true); ?>\n@@ -628,16 +628,16 @@ functions::draw_lightbox();\n       if (!empty($_POST['items'][$key]['options'])) {\n         foreach (array_keys($_POST['items'][$key]['options']) as $field) {\n           echo '<div>' . PHP_EOL\n-             . ' - '. $field .': ' . PHP_EOL;\n+             . ' - '. functions::escape_html($field) .': ' . PHP_EOL;\n           if (is_array($_POST['items'][$key]['options'][$field])) {\n             $use_comma = false;\n             foreach (array_keys($_POST['items'][$key]['options'][$field]) as $k) {\n-              echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']['.$k.']', true) . $_POST['items'][$key]['options'][$field][$k];\n+              echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']['.$k.']', true) . functions::escape_html($_POST['items'][$key]['options'][$field][$k]);\n               if ($use_comma) echo ', ';\n               $use_comma = true;\n             }\n           } else {\n-            echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']', true) . $_POST['items'][$key]['options'][$field];\n+            echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']', true) . functions::escape_html($_POST['items'][$key]['options'][$field]);\n           }\n           echo '</div>' . PHP_EOL;\n         }\n@@ -646,12 +646,12 @@ functions::draw_lightbox();\n       }\n ?>\n               </td>\n-              <td class=\"sku\"><?php echo $_POST['items'][$key]['sku']; ?></td>\n+              <td class=\"sku\"><?php echo functions::escape_html($_POST['items'][$key]['sku']); ?></td>\n               <td>\n-                <span class=\"weight\"><?php echo (float)$_POST['items'][$key]['weight']; ?></span> <span class=\"weight_class\"><?php echo $_POST['items'][$key]['weight_class']; ?></span>\n+                <span class=\"weight\"><?php echo (float)$_POST['items'][$key]['weight']; ?></span> <span class=\"weight_class\"><?php echo functions::escape_html($_POST['items'][$key]['weight_class']); ?></span>\n               </td>\n               <td>\n-                <span class=\"dim_x\"><?php echo (float)$_POST['items'][$key]['dim_x']; ?></span> x <span class=\"dim_y\"><?php echo (float)$_POST['items'][$key]['dim_y']; ?></span> x <span class=\"dim_z\"><?php echo (float)$_POST['items'][$key]['dim_z']; ?></span> <span class=\"dim_class\"><?php echo $_POST['items'][$key]['dim_class']; ?></span>\n+                <span class=\"dim_x\"><?php echo (float)$_POST['items'][$key]['dim_x']; ?></span> x <span class=\"dim_y\"><?php echo (float)$_POST['items'][$key]['dim_y']; ?></span> x <span class=\"dim_z\"><?php echo (float)$_POST['items'][$key]['dim_z']; ?></span> <span class=\"dim_class\"><?php echo functions::escape_html($_POST['items'][$key]['dim_class']); ?></span>\n               </td>\n               <td><?php echo functions::form_draw_decimal_field('items['. $key .'][quantity]', true, 2); ?></td>\n               <td><?php echo functions::form_draw_currency_field($_POST['currency_code'], 'items['. $key .'][price]', true); ?></td>"
        },
        {
          "filename": "public_html/admin/orders.app/orders.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -282,7 +282,7 @@\n             <td><?php echo functions::draw_fonticon($order['order_status_icon'].' fa-fw', 'style=\"color: '. $order['order_status_color'] .';\"'); ?></td>\n             <td><?php echo $order['id']; ?></td>\n             <td><?php echo (!empty($order['starred'])) ? functions::draw_fonticon('fa-star', 'style=\"color: #f2b01e;\"') : functions::draw_fonticon('fa-star-o', 'style=\"color: #ccc;\"'); ?></td>\n-            <td><a href=\"<?php echo document::href_link('', ['app' => 'orders', 'doc' => 'edit_order', 'order_id' => $order['id'], 'redirect_url' => $_SERVER['REQUEST_URI']]); ?>\"><?php echo $order['customer_company'] ? $order['customer_company'] : $order['customer_firstname'] .' '. $order['customer_lastname']; ?><?php echo empty($order['customer_id']) ? ' <em>('. language::translate('title_guest', 'Guest') .')</em>' : ''; ?></a> <span style=\"opacity: 0.5;\"><?php echo $order['customer_tax_id']; ?></span></td>\n+            <td><a href=\"<?php echo document::href_link('', ['app' => 'orders', 'doc' => 'edit_order', 'order_id' => $order['id'], 'redirect_url' => $_SERVER['REQUEST_URI']]); ?>\"><?php echo functions::escape_html($order['customer_company'] ? $order['customer_company'] : $order['customer_firstname'] .' '. $order['customer_lastname']); ?><?php echo empty($order['customer_id']) ? ' <em>('. language::translate('title_guest', 'Guest') .')</em>' : ''; ?></a> <span style=\"opacity: 0.5;\"><?php echo functions::escape_html($order['customer_tax_id']); ?></span></td>\n             <td><?php echo !empty($order['customer_country_code']) ? reference::country($order['customer_country_code'])->name : ''; ?></td>\n             <td><?php echo $order['payment_option_name']; ?></td>\n             <td class=\"text-end\"><?php echo currency::format($order['payment_due'], false, $order['currency_code'], $order['currency_value']); ?></td>"
        },
        {
          "filename": "public_html/admin/reports.app/most_shopping_customers.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -106,7 +106,7 @@\n       <tbody>\n         <?php foreach ($customers as $customer) { ?>\n         <tr>\n-          <td><?php echo !empty($customer['id']) ? '<a href=\"'. document::link(WS_DIR_ADMIN, ['app' => 'customers', 'doc' => 'edit_customer', 'customer_id' => $customer['id']]) .'\">'. $customer['name'] .'</a>' : $customer['name'] .' <em>('. language::translate('title_guest', 'Guest') .')</em>'; ?></td>\n+          <td><?php echo !empty($customer['id']) ? '<a href=\"'. document::link(WS_DIR_ADMIN, ['app' => 'customers', 'doc' => 'edit_customer', 'customer_id' => $customer['id']]) .'\">'. functions::escape_html($customer['name']) .'</a>' : functions::escape_html($customer['name']) .' <em>('. language::translate('title_guest', 'Guest') .')</em>'; ?></td>\n           <td><?php echo $customer['email']; ?></td>\n           <td style=\"text-align: end;\"><?php echo currency::format($customer['total_amount'], false, settings::get('store_currency_code')); ?></td>\n         </tr>"
        },
        {
          "filename": "public_html/includes/templates/default.catalog/pages/order.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -42,7 +42,7 @@\n   <div id=\"comments\" class=\"bubbles\">\n     <?php foreach ($comments as $comment) { ?>\n     <div class=\"bubble <?php echo $comment['type']; ?>\">\n-      <div class=\"text\"><?php echo nl2br($comment['text']); ?></div>\n+      <div class=\"text\"><?php echo nl2br(functions::escape_html($comment['text'])); ?></div>\n       <div class=\"date\"><?php echo language::strftime(language::$selected['format_datetime'], strtotime($comment['date_created'])); ?></div>\n     </div>\n     <?php } ?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "217905c3a046efe29ab8a3e4eef9f2e565cb107a",
            "date": "2025-01-05T09:37:33Z",
            "author_login": "timint"
          },
          {
            "sha": "43f6d03b9bd0ec3abf147f5389d2a2b71bcdc2ce",
            "date": "2025-01-05T09:36:53Z",
            "author_login": "timint"
          },
          {
            "sha": "713ce62d1ef39fc9cefc0e3c0d7ba35c7aedbe26",
            "date": "2025-01-05T09:30:25Z",
            "author_login": "timint"
          },
          {
            "sha": "648676c274617bcf30b29d57a2a0f035fa23dd9b",
            "date": "2025-01-05T08:36:59Z",
            "author_login": "timint"
          },
          {
            "sha": "3b6bd0a1bbe05ad2cde4732270bd34ec59f74c98",
            "date": "2024-12-25T02:49:29Z",
            "author_login": "timint"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site scripting vulnerability in LiteCart versions prior to 2.4.2 allows a remote attacker to inject an arbitrary script via unspecified vectors.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-07-11T01:15:07.820",
    "last_modified": "2024-11-21T06:55:20.107",
    "fix_date": "2022-06-15T15:40:03Z"
  },
  "references": [
    {
      "url": "https://github.com/litecart/litecart",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/litecart/litecart/commit/050fea86cc162f3da2f7824f586602125a0f6d63",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jvn.jp/en/jp/JVN32625020/index.html",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.litecart.net/en/",
      "source": "vultures@jpcert.or.jp",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/litecart/litecart",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/litecart/litecart/commit/050fea86cc162f3da2f7824f586602125a0f6d63",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jvn.jp/en/jp/JVN32625020/index.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.litecart.net/en/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:11.467347",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "litecart",
    "owner": "litecart",
    "created_at": "2016-06-16T10:46:17Z",
    "updated_at": "2025-01-09T13:53:54Z",
    "pushed_at": "2025-01-05T13:51:30Z",
    "size": 18707,
    "stars": 207,
    "forks": 79,
    "open_issues": 14,
    "watchers": 207,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [],
    "languages": {
      "PHP": 2194838,
      "Less": 121832,
      "CSS": 81454,
      "JavaScript": 80115,
      "SCSS": 14761,
      "Hack": 532,
      "Shell": 425
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:31:14.206246"
  }
}