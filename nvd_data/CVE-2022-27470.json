{
  "cve_id": "CVE-2022-27470",
  "github_data": {
    "repository": "libsdl-org/SDL_ttf",
    "fix_commit": "db1b41ab8bde6723c24b866e466cad78c2fa0448",
    "related_commits": [
      "db1b41ab8bde6723c24b866e466cad78c2fa0448",
      "db1b41ab8bde6723c24b866e466cad78c2fa0448"
    ],
    "patch_url": "https://github.com/libsdl-org/SDL_ttf/commit/db1b41ab8bde6723c24b866e466cad78c2fa0448.patch",
    "fix_commit_details": {
      "sha": "db1b41ab8bde6723c24b866e466cad78c2fa0448",
      "commit_date": "2022-03-19T19:40:28Z",
      "author": {
        "login": "1bsyl",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "More integer overflow (see bug #187)",
        "length": 163,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "SDL_ttf.c",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -1257,7 +1257,7 @@ static SDL_Surface* Create_Surface_Solid(int width, int height, SDL_Color fg, Ui\n      */\n     void *pixels, *ptr;\n     /* Worse case at the end of line pulling 'alignment' extra blank pixels */\n-    Sint64 pitch = width + alignment;\n+    Sint64 pitch = (Sint64)width + (Sint64)alignment;\n     pitch += alignment;\n     pitch &= ~alignment;\n     size = height * pitch + sizeof (void *) + alignment;\n@@ -1321,7 +1321,7 @@ static SDL_Surface* Create_Surface_Shaded(int width, int height, SDL_Color fg, S\n      */\n     void *pixels, *ptr;\n     /* Worse case at the end of line pulling 'alignment' extra blank pixels */\n-    Sint64 pitch = width + alignment;\n+    Sint64 pitch = (Sint64)width + (Sint64)alignment;\n     pitch += alignment;\n     pitch &= ~alignment;\n     size = height * pitch + sizeof (void *) + alignment;\n@@ -1418,7 +1418,7 @@ static SDL_Surface *Create_Surface_Blended(int width, int height, SDL_Color fg,\n         Sint64 size;\n         void *pixels, *ptr;\n         /* Worse case at the end of line pulling 'alignment' extra blank pixels */\n-        Sint64 pitch = (width + alignment) * 4;\n+        Sint64 pitch = ((Sint64)width + (Sint64)alignment) * 4;\n         pitch += alignment;\n         pitch &= ~alignment;\n         size = height * pitch + sizeof (void *) + alignment;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "baf2e577b109ac5547f5654550626256c27f2541",
            "date": "2025-01-11T15:56:40Z",
            "author_login": "sezero"
          },
          {
            "sha": "35f67d20ebfa0336021b1cd2e8dd4422294a7bd4",
            "date": "2025-01-09T17:56:44Z",
            "author_login": "slouken"
          },
          {
            "sha": "962a7c4ff37cc2b00064e8daad88e4fdcfb378c5",
            "date": "2025-01-08T18:04:52Z",
            "author_login": "smcv"
          },
          {
            "sha": "7a1942b7ceab9bac45f78cb999b0d911f06b2523",
            "date": "2025-01-08T17:25:59Z",
            "author_login": "smcv"
          },
          {
            "sha": "a343d6bd4ca87aa15b472e5738ebd8fde936bfdb",
            "date": "2025-01-08T17:21:56Z",
            "author_login": "smcv"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-787",
    "description": "SDL_ttf v2.0.18 and below was discovered to contain an arbitrary memory write via the function TTF_RenderText_Solid(). This vulnerability is triggered via a crafted TTF file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-04T03:15:07.627",
    "last_modified": "2024-11-21T06:55:47.183",
    "fix_date": "2022-03-19T19:40:28Z"
  },
  "references": [
    {
      "url": "https://github.com/libsdl-org/SDL_ttf/commit/db1b41ab8bde6723c24b866e466cad78c2fa0448",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libsdl-org/SDL_ttf/issues/187",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EAGMQMRQDTZFQW64JEW3O6HY3JYLAAHT/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RXI3MDPR24W5557G34YHWOP2MOK6BTGB/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XPYTEBBNHCDGPVFACC5RC5K2FZUCYTPZ/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/libsdl-org/SDL_ttf/commit/db1b41ab8bde6723c24b866e466cad78c2fa0448",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/libsdl-org/SDL_ttf/issues/187",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EAGMQMRQDTZFQW64JEW3O6HY3JYLAAHT/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RXI3MDPR24W5557G34YHWOP2MOK6BTGB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XPYTEBBNHCDGPVFACC5RC5K2FZUCYTPZ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:04.438956",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "SDL_ttf",
    "owner": "libsdl-org",
    "created_at": "2021-02-10T14:17:12Z",
    "updated_at": "2025-01-14T11:27:24Z",
    "pushed_at": "2025-01-11T16:19:35Z",
    "size": 108995,
    "stars": 437,
    "forks": 143,
    "open_issues": 9,
    "watchers": 437,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 389461,
      "Perl": 118857,
      "Python": 89563,
      "CMake": 85043,
      "Shell": 23722,
      "Makefile": 2637,
      "SmPL": 2073
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "zlib"
    },
    "collected_at": "2025-01-14T17:37:50.685916"
  }
}