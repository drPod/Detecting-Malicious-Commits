{
  "cve_id": "CVE-2022-27649",
  "github_data": {
    "repository": "containers/podman",
    "fix_commit": "aafa80918a245edcbdaceb1191d749570f1872d0",
    "related_commits": [
      "aafa80918a245edcbdaceb1191d749570f1872d0",
      "aafa80918a245edcbdaceb1191d749570f1872d0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "aafa80918a245edcbdaceb1191d749570f1872d0",
      "commit_date": "2022-02-28T08:48:52Z",
      "author": {
        "login": "giuseppe",
        "type": "User",
        "stats": {
          "total_commits": 1024,
          "average_weekly_commits": 2.7018469656992083,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 248
        }
      },
      "commit_message": {
        "title": "do not set the inheritable capabilities",
        "length": 246,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
      },
      "files": [
        {
          "filename": "libpod/oci_conmon_exec_linux.go",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -758,11 +758,14 @@ func prepareProcessExec(c *Container, options *ExecOptions, env []string, sessio\n \t} else {\n \t\tpspec.Capabilities.Bounding = ctrSpec.Process.Capabilities.Bounding\n \t}\n+\n+\t// Always unset the inheritable capabilities similarly to what the Linux kernel does\n+\t// They are used only when using capabilities with uid != 0.\n+\tpspec.Capabilities.Inheritable = []string{}\n+\n \tif execUser.Uid == 0 {\n \t\tpspec.Capabilities.Effective = pspec.Capabilities.Bounding\n-\t\tpspec.Capabilities.Inheritable = pspec.Capabilities.Bounding\n \t\tpspec.Capabilities.Permitted = pspec.Capabilities.Bounding\n-\t\tpspec.Capabilities.Ambient = pspec.Capabilities.Bounding\n \t} else {\n \t\tif user == c.config.User {\n \t\t\tpspec.Capabilities.Effective = ctrSpec.Process.Capabilities.Effective"
        },
        {
          "filename": "pkg/specgen/generate/security.go",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -146,14 +146,17 @@ func securityConfigureGenerator(s *specgen.SpecGenerator, g *generate.Generator,\n \n \tconfigSpec := g.Config\n \tconfigSpec.Process.Capabilities.Ambient = []string{}\n+\n+\t// Always unset the inheritable capabilities similarly to what the Linux kernel does\n+\t// They are used only when using capabilities with uid != 0.\n+\tconfigSpec.Process.Capabilities.Inheritable = []string{}\n \tconfigSpec.Process.Capabilities.Bounding = caplist\n \n \tuser := strings.Split(s.User, \":\")[0]\n \n \tif (user == \"\" && s.UserNS.NSMode != specgen.KeepID) || user == \"root\" || user == \"0\" {\n \t\tconfigSpec.Process.Capabilities.Effective = caplist\n \t\tconfigSpec.Process.Capabilities.Permitted = caplist\n-\t\tconfigSpec.Process.Capabilities.Inheritable = caplist\n \t} else {\n \t\tmergedCaps, err := capabilities.MergeCapabilities(nil, s.CapAdd, nil)\n \t\tif err != nil {\n@@ -175,12 +178,12 @@ func securityConfigureGenerator(s *specgen.SpecGenerator, g *generate.Generator,\n \t\t}\n \t\tconfigSpec.Process.Capabilities.Effective = userCaps\n \t\tconfigSpec.Process.Capabilities.Permitted = userCaps\n-\t\tconfigSpec.Process.Capabilities.Inheritable = userCaps\n \n \t\t// Ambient capabilities were added to Linux 4.3.  Set ambient\n \t\t// capabilities only when the kernel supports them.\n \t\tif supportAmbientCapabilities() {\n \t\t\tconfigSpec.Process.Capabilities.Ambient = userCaps\n+\t\t\tconfigSpec.Process.Capabilities.Inheritable = userCaps\n \t\t}\n \t}\n "
        },
        {
          "filename": "test/e2e/run_test.go",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -498,7 +498,7 @@ var _ = Describe(\"Podman run\", func() {\n \t\tsession = podmanTest.Podman([]string{\"run\", \"--rm\", \"--user\", \"root\", ALPINE, \"grep\", \"CapInh\", \"/proc/self/status\"})\n \t\tsession.WaitWithDefaultTimeout()\n \t\tExpect(session).Should(Exit(0))\n-\t\tExpect(session.OutputToString()).To(ContainSubstring(\"00000000a80425fb\"))\n+\t\tExpect(session.OutputToString()).To(ContainSubstring(\"0000000000000000\"))\n \n \t\tsession = podmanTest.Podman([]string{\"run\", \"--rm\", ALPINE, \"grep\", \"CapBnd\", \"/proc/self/status\"})\n \t\tsession.WaitWithDefaultTimeout()\n@@ -533,7 +533,7 @@ var _ = Describe(\"Podman run\", func() {\n \t\tsession = podmanTest.Podman([]string{\"run\", \"--user=0:0\", \"--cap-add=DAC_OVERRIDE\", \"--rm\", ALPINE, \"grep\", \"CapInh\", \"/proc/self/status\"})\n \t\tsession.WaitWithDefaultTimeout()\n \t\tExpect(session).Should(Exit(0))\n-\t\tExpect(session.OutputToString()).To(ContainSubstring(\"00000000a80425fb\"))\n+\t\tExpect(session.OutputToString()).To(ContainSubstring(\"0000000000000000\"))\n \n \t\tif os.Geteuid() > 0 {\n \t\t\tif os.Getenv(\"SKIP_USERNS\") != \"\" {\n@@ -550,7 +550,7 @@ var _ = Describe(\"Podman run\", func() {\n \t\t\tsession = podmanTest.Podman([]string{\"run\", \"--userns=keep-id\", \"--privileged\", \"--rm\", ALPINE, \"grep\", \"CapInh\", \"/proc/self/status\"})\n \t\t\tsession.WaitWithDefaultTimeout()\n \t\t\tExpect(session).Should(Exit(0))\n-\t\t\tExpect(session.OutputToString()).To(ContainSubstring(\"0000000000000000\"))\n+\t\t\tExpect(session.OutputToString()).To(ContainSubstring(\"0000000000000002\"))\n \n \t\t\tsession = podmanTest.Podman([]string{\"run\", \"--userns=keep-id\", \"--cap-add=DAC_OVERRIDE\", \"--rm\", ALPINE, \"grep\", \"CapInh\", \"/proc/self/status\"})\n \t\t\tsession.WaitWithDefaultTimeout()"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3b6c7665b9eb755254a3164f9f89353414baec41",
            "date": "2025-01-23T19:26:16Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "02dd3e123fdf02b47f02f21af551400656b87185",
            "date": "2025-01-23T16:21:24Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "da8db52fc379dcb8b88c58b2a2368f57b60efb8f",
            "date": "2025-01-23T15:45:35Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "f12bc49b9fef633323afd16abcad0f5924b3b546",
            "date": "2025-01-23T14:12:01Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "c8fc73e19ce20b22fa23007c9a6f5d886b6cbe13",
            "date": "2025-01-23T10:20:25Z",
            "author_login": "openshift-merge-bot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-276",
    "description": "A flaw was found in Podman, where containers were started incorrectly with non-empty default permissions. A vulnerability was found in Moby (Docker Engine), where containers were started incorrectly with non-empty inheritable Linux process capabilities. This flaw allows an attacker with access to programs with inheritable file capabilities to elevate those capabilities to the permitted set when execve(2) runs.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-04-04T20:15:10.890",
    "last_modified": "2024-11-21T06:56:05.923",
    "fix_date": "2022-02-28T08:48:52Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066568",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/podman/commit/aafa80918a245edcbdaceb1191d749570f1872d0",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/podman/security/advisories/GHSA-qvf8-p83w-v58j",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4KDETHL5XCT6RZN2BBNOCEXRZ2W3SFU3/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DLUJZV3HBP56ADXU6QH2V7RNYUPMVBXQ/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J5WPM42UR6XIBQNQPNQHM32X7S4LJTRX/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066568",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/podman/commit/aafa80918a245edcbdaceb1191d749570f1872d0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/podman/security/advisories/GHSA-qvf8-p83w-v58j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4KDETHL5XCT6RZN2BBNOCEXRZ2W3SFU3/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DLUJZV3HBP56ADXU6QH2V7RNYUPMVBXQ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J5WPM42UR6XIBQNQPNQHM32X7S4LJTRX/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.098027",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "podman",
    "owner": "containers",
    "created_at": "2017-11-01T15:01:27Z",
    "updated_at": "2025-01-26T07:16:22Z",
    "pushed_at": "2025-01-24T12:08:33Z",
    "size": 152411,
    "stars": 24823,
    "forks": 2488,
    "open_issues": 769,
    "watchers": 24823,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v1.0",
      "v1.4.1-crio114",
      "v1.4.2-stable",
      "v1.6",
      "v1.6.4-rhel",
      "v1.9",
      "v2.0",
      "v2.0.5-rhel",
      "v2.1",
      "v2.1.1-rhel",
      "v2.2",
      "v2.2.1-rhel",
      "v3.0",
      "v3.0.1-rhel",
      "v3.1",
      "v3.2",
      "v3.2.3-rhel"
    ],
    "languages": {
      "Go": 8229946,
      "Shell": 1394436,
      "Perl": 211314,
      "Python": 108839,
      "C": 54393,
      "PowerShell": 53809,
      "Makefile": 47235,
      "Dockerfile": 4348,
      "Ruby": 3511,
      "Awk": 570,
      "HTML": 404,
      "Batchfile": 222
    },
    "commit_activity": {
      "total_commits_last_year": 2842,
      "avg_commits_per_week": 54.65384615384615,
      "days_active_last_year": 298
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:11:41.839424"
  }
}