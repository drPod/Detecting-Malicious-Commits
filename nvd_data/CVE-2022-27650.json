{
  "cve_id": "CVE-2022-27650",
  "github_data": {
    "repository": "containers/crun",
    "fix_commit": "1aeeed2e4fdeffb4875c0d0b439915894594c8c6",
    "related_commits": [
      "1aeeed2e4fdeffb4875c0d0b439915894594c8c6",
      "1aeeed2e4fdeffb4875c0d0b439915894594c8c6"
    ],
    "patch_url": "https://github.com/containers/crun/commit/1aeeed2e4fdeffb4875c0d0b439915894594c8c6.patch",
    "fix_commit_details": {
      "sha": "1aeeed2e4fdeffb4875c0d0b439915894594c8c6",
      "commit_date": "2022-02-28T10:06:50Z",
      "author": {
        "login": "giuseppe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "exec: --cap do not set inheritable capabilities",
        "length": 127,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/exec.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -304,8 +304,8 @@ crun_command_exec (struct crun_global_arguments *global_args, int argc, char **a\n           capabilities->effective = exec_options.cap;\n           capabilities->effective_len = exec_options.cap_size;\n \n-          capabilities->inheritable = dup_array (exec_options.cap, exec_options.cap_size);\n-          capabilities->inheritable_len = exec_options.cap_size;\n+          capabilities->inheritable = NULL;\n+          capabilities->inheritable_len = 0;\n \n           capabilities->bounding = dup_array (exec_options.cap, exec_options.cap_size);\n           capabilities->bounding_len = exec_options.cap_size;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "283ffdf7dc0e92f61d78df362f08e42ba11efa7a",
            "date": "2025-01-13T11:00:15Z",
            "author_login": "giuseppe"
          },
          {
            "sha": "179686b7e5d57ebc93c25cf8f104d692bde4f4ed",
            "date": "2025-01-10T11:17:43Z",
            "author_login": "giuseppe"
          },
          {
            "sha": "b4df4136cb9bdb24d36a11a778769fcc01b132cb",
            "date": "2025-01-10T22:17:10Z",
            "author_login": "flouthoc"
          },
          {
            "sha": "68e8d9abacc4f4d02ba674bf289918b21819b753",
            "date": "2025-01-10T11:33:18Z",
            "author_login": "giuseppe"
          },
          {
            "sha": "6f010b5f6bd86d27e6a85eb0e933a8cca1ede71c",
            "date": "2025-01-08T09:01:42Z",
            "author_login": "giuseppe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-276",
    "description": "A flaw was found in crun where containers were incorrectly started with non-empty default permissions. A vulnerability was found in Moby (Docker Engine) where containers were started incorrectly with non-empty inheritable Linux process capabilities. This flaw allows an attacker with access to programs with inheritable file capabilities to elevate those capabilities to the permitted set when execve(2) runs.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-04-04T20:15:10.940",
    "last_modified": "2024-11-21T06:56:06.080",
    "fix_date": "2022-02-28T10:06:50Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066845",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/crun/commit/1aeeed2e4fdeffb4875c0d0b439915894594c8c6",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/crun/security/advisories/GHSA-wr4f-w546-m398",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HYIGABCZ7ZHAG2XCOGITTQRJU2ASWMFA/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066845",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/crun/commit/1aeeed2e4fdeffb4875c0d0b439915894594c8c6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/crun/security/advisories/GHSA-wr4f-w546-m398",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HYIGABCZ7ZHAG2XCOGITTQRJU2ASWMFA/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.098192",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "crun",
    "owner": "containers",
    "created_at": "2017-09-13T20:20:58Z",
    "updated_at": "2025-01-14T08:57:10Z",
    "pushed_at": "2025-01-13T11:00:17Z",
    "size": 5705,
    "stars": 3140,
    "forks": 324,
    "open_issues": 34,
    "watchers": 3140,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 1173739,
      "Python": 140354,
      "Makefile": 86991,
      "M4": 39972,
      "Shell": 29249,
      "Roff": 23182,
      "Rust": 10883,
      "Lua": 8741,
      "Dockerfile": 8043,
      "Nix": 4454
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:54:40.045401"
  }
}