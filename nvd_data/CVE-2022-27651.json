{
  "cve_id": "CVE-2022-27651",
  "github_data": {
    "repository": "containers/buildah",
    "fix_commit": "e7e55c988c05dd74005184ceb64f097a0cfe645b",
    "related_commits": [
      "e7e55c988c05dd74005184ceb64f097a0cfe645b",
      "e7e55c988c05dd74005184ceb64f097a0cfe645b"
    ],
    "patch_url": "https://github.com/containers/buildah/commit/e7e55c988c05dd74005184ceb64f097a0cfe645b.patch",
    "fix_commit_details": {
      "sha": "e7e55c988c05dd74005184ceb64f097a0cfe645b",
      "commit_date": "2022-02-28T09:38:48Z",
      "author": {
        "login": "giuseppe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "do not set the inheritable capabilities",
        "length": 246,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 1,
        "deletions": 7
      },
      "files": [
        {
          "filename": "chroot/run.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -897,7 +897,7 @@ func setCapabilities(spec *specs.Spec, keepCaps ...string) error {\n \tcapMap := map[capability.CapType][]string{\n \t\tcapability.BOUNDING:    spec.Process.Capabilities.Bounding,\n \t\tcapability.EFFECTIVE:   spec.Process.Capabilities.Effective,\n-\t\tcapability.INHERITABLE: spec.Process.Capabilities.Inheritable,\n+\t\tcapability.INHERITABLE: []string{},\n \t\tcapability.PERMITTED:   spec.Process.Capabilities.Permitted,\n \t\tcapability.AMBIENT:     spec.Process.Capabilities.Ambient,\n \t}"
        },
        {
          "filename": "run_linux.go",
          "status": "modified",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -1964,9 +1964,6 @@ func setupCapAdd(g *generate.Generator, caps ...string) error {\n \t\tif err := g.AddProcessCapabilityEffective(cap); err != nil {\n \t\t\treturn errors.Wrapf(err, \"error adding %q to the effective capability set\", cap)\n \t\t}\n-\t\tif err := g.AddProcessCapabilityInheritable(cap); err != nil {\n-\t\t\treturn errors.Wrapf(err, \"error adding %q to the inheritable capability set\", cap)\n-\t\t}\n \t\tif err := g.AddProcessCapabilityPermitted(cap); err != nil {\n \t\t\treturn errors.Wrapf(err, \"error adding %q to the permitted capability set\", cap)\n \t\t}\n@@ -1985,9 +1982,6 @@ func setupCapDrop(g *generate.Generator, caps ...string) error {\n \t\tif err := g.DropProcessCapabilityEffective(cap); err != nil {\n \t\t\treturn errors.Wrapf(err, \"error removing %q from the effective capability set\", cap)\n \t\t}\n-\t\tif err := g.DropProcessCapabilityInheritable(cap); err != nil {\n-\t\t\treturn errors.Wrapf(err, \"error removing %q from the inheritable capability set\", cap)\n-\t\t}\n \t\tif err := g.DropProcessCapabilityPermitted(cap); err != nil {\n \t\t\treturn errors.Wrapf(err, \"error removing %q from the permitted capability set\", cap)\n \t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "826d9036cf77319bbf292dc93d359adfd39751f2",
            "date": "2025-01-09T19:57:20Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "85bcd7e96841059b1b4fd49db8c74f05e13873a9",
            "date": "2025-01-08T11:55:44Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "65b634b7de0bfbb5c2658ba98556efea55d7a63e",
            "date": "2025-01-07T17:56:14Z",
            "author_login": "nalind"
          },
          {
            "sha": "471de48c63c7cd70fe1f41e19b18725a1d24ba82",
            "date": "2025-01-07T20:43:37Z",
            "author_login": "openshift-merge-bot[bot]"
          },
          {
            "sha": "676e58804475773cfa25e69833f8223332d12635",
            "date": "2025-01-07T20:07:53Z",
            "author_login": "openshift-merge-bot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-276",
    "description": "A flaw was found in buildah where containers were incorrectly started with non-empty default permissions. A bug was found in Moby (Docker Engine) where containers were incorrectly started with non-empty inheritable Linux process capabilities, enabling an attacker with access to programs with inheritable file capabilities to elevate those capabilities to the permitted set when execve(2) runs. This has the potential to impact confidentiality and integrity.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-04-04T20:15:10.990",
    "last_modified": "2024-11-21T06:56:06.213",
    "fix_date": "2022-02-28T09:38:48Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066840",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/buildah/commit/e7e55c988c05dd74005184ceb64f097a0cfe645b",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/buildah/security/advisories/GHSA-c3g4-w6cv-6v7h",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/25YI27MENCEPZTTGRVU6BQD5V53FNI52/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2VWH6X6HOFPO6HTESF42HIJZEPXSWVIO/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7NETC7I6RTMMBRJJQVJOJUPDK4W4PQSJ/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2066840",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/buildah/commit/e7e55c988c05dd74005184ceb64f097a0cfe645b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/containers/buildah/security/advisories/GHSA-c3g4-w6cv-6v7h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/25YI27MENCEPZTTGRVU6BQD5V53FNI52/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2VWH6X6HOFPO6HTESF42HIJZEPXSWVIO/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7NETC7I6RTMMBRJJQVJOJUPDK4W4PQSJ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:02.098344",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "buildah",
    "owner": "containers",
    "created_at": "2017-01-26T16:59:13Z",
    "updated_at": "2025-01-14T02:03:52Z",
    "pushed_at": "2025-01-13T22:05:13Z",
    "size": 64932,
    "stars": 7559,
    "forks": 788,
    "open_issues": 154,
    "watchers": 7559,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release-1.15",
      "release-1.16",
      "release-1.17",
      "release-1.18",
      "release-1.19",
      "release-1.20",
      "release-1.21",
      "release-1.22",
      "release-1.23",
      "release-1.24",
      "release-1.26",
      "release-1.27",
      "release-1.28",
      "release-1.29",
      "release-1.31",
      "release-1.32"
    ],
    "languages": {
      "Go": 1590529,
      "Shell": 691658,
      "Dockerfile": 15097,
      "Perl": 10721,
      "Makefile": 9496,
      "Nix": 5816,
      "Roff": 1045,
      "Awk": 512,
      "Assembly": 431
    },
    "commit_activity": {
      "total_commits_last_year": 378,
      "avg_commits_per_week": 7.269230769230769,
      "days_active_last_year": 178
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:56:06.530098"
  }
}