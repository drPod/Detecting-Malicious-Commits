{
  "cve_id": "CVE-2022-29162",
  "github_data": {
    "repository": "opencontainers/runc",
    "fix_commit": "d04de3a9b72d7a2455c1885fc75eb36d02cd17b5",
    "related_commits": [
      "d04de3a9b72d7a2455c1885fc75eb36d02cd17b5",
      "d04de3a9b72d7a2455c1885fc75eb36d02cd17b5"
    ],
    "patch_url": "https://github.com/opencontainers/runc/commit/d04de3a9b72d7a2455c1885fc75eb36d02cd17b5.patch",
    "fix_commit_details": {
      "sha": "d04de3a9b72d7a2455c1885fc75eb36d02cd17b5",
      "commit_date": "2022-05-11T22:15:42Z",
      "author": {
        "login": "cyphar",
        "type": "User",
        "stats": {
          "total_commits": 316,
          "average_weekly_commits": 0.5543859649122806,
          "total_additions": 157715,
          "total_deletions": 12850,
          "weeks_active": 142
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-f3fp-gc8g-vw66",
        "length": 86,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 40,
        "additions": 0,
        "deletions": 40
      },
      "files": [
        {
          "filename": "exec.go",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -227,7 +227,6 @@ func getProcess(context *cli.Context, bundle string) (*specs.Process, error) {\n \tif caps := context.StringSlice(\"cap\"); len(caps) > 0 {\n \t\tfor _, c := range caps {\n \t\t\tp.Capabilities.Bounding = append(p.Capabilities.Bounding, c)\n-\t\t\tp.Capabilities.Inheritable = append(p.Capabilities.Inheritable, c)\n \t\t\tp.Capabilities.Effective = append(p.Capabilities.Effective, c)\n \t\t\tp.Capabilities.Permitted = append(p.Capabilities.Permitted, c)\n \t\t\tp.Capabilities.Ambient = append(p.Capabilities.Ambient, c)"
        },
        {
          "filename": "libcontainer/README.md",
          "status": "modified",
          "additions": 0,
          "deletions": 16,
          "patch": "@@ -84,22 +84,6 @@ config := &configs.Config{\n \t\t\t\"CAP_KILL\",\n \t\t\t\"CAP_AUDIT_WRITE\",\n \t\t},\n-\t\tInheritable: []string{\n-\t\t\t\"CAP_CHOWN\",\n-\t\t\t\"CAP_DAC_OVERRIDE\",\n-\t\t\t\"CAP_FSETID\",\n-\t\t\t\"CAP_FOWNER\",\n-\t\t\t\"CAP_MKNOD\",\n-\t\t\t\"CAP_NET_RAW\",\n-\t\t\t\"CAP_SETGID\",\n-\t\t\t\"CAP_SETUID\",\n-\t\t\t\"CAP_SETFCAP\",\n-\t\t\t\"CAP_SETPCAP\",\n-\t\t\t\"CAP_NET_BIND_SERVICE\",\n-\t\t\t\"CAP_SYS_CHROOT\",\n-\t\t\t\"CAP_KILL\",\n-\t\t\t\"CAP_AUDIT_WRITE\",\n-\t\t},\n \t\tPermitted: []string{\n \t\t\t\"CAP_CHOWN\",\n \t\t\t\"CAP_DAC_OVERRIDE\","
        },
        {
          "filename": "libcontainer/integration/exec_test.go",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -364,7 +364,6 @@ func TestProcessCaps(t *testing.T) {\n \tpconfig.Capabilities.Bounding = append(config.Capabilities.Bounding, \"CAP_NET_ADMIN\")\n \tpconfig.Capabilities.Permitted = append(config.Capabilities.Permitted, \"CAP_NET_ADMIN\")\n \tpconfig.Capabilities.Effective = append(config.Capabilities.Effective, \"CAP_NET_ADMIN\")\n-\tpconfig.Capabilities.Inheritable = append(config.Capabilities.Inheritable, \"CAP_NET_ADMIN\")\n \terr = container.Run(&pconfig)\n \tok(t, err)\n \n@@ -1360,7 +1359,6 @@ func TestRootfsPropagationSharedMount(t *testing.T) {\n \tpconfig2.Capabilities.Bounding = append(config.Capabilities.Bounding, \"CAP_SYS_ADMIN\")\n \tpconfig2.Capabilities.Permitted = append(config.Capabilities.Permitted, \"CAP_SYS_ADMIN\")\n \tpconfig2.Capabilities.Effective = append(config.Capabilities.Effective, \"CAP_SYS_ADMIN\")\n-\tpconfig2.Capabilities.Inheritable = append(config.Capabilities.Inheritable, \"CAP_SYS_ADMIN\")\n \n \terr = container.Run(pconfig2)\n \t_ = stdinR2.Close()"
        },
        {
          "filename": "libcontainer/integration/template_test.go",
          "status": "modified",
          "additions": 0,
          "deletions": 16,
          "patch": "@@ -75,22 +75,6 @@ func newTemplateConfig(t *testing.T, p *tParam) *configs.Config {\n \t\t\t\t\"CAP_KILL\",\n \t\t\t\t\"CAP_AUDIT_WRITE\",\n \t\t\t},\n-\t\t\tInheritable: []string{\n-\t\t\t\t\"CAP_CHOWN\",\n-\t\t\t\t\"CAP_DAC_OVERRIDE\",\n-\t\t\t\t\"CAP_FSETID\",\n-\t\t\t\t\"CAP_FOWNER\",\n-\t\t\t\t\"CAP_MKNOD\",\n-\t\t\t\t\"CAP_NET_RAW\",\n-\t\t\t\t\"CAP_SETGID\",\n-\t\t\t\t\"CAP_SETUID\",\n-\t\t\t\t\"CAP_SETFCAP\",\n-\t\t\t\t\"CAP_SETPCAP\",\n-\t\t\t\t\"CAP_NET_BIND_SERVICE\",\n-\t\t\t\t\"CAP_SYS_CHROOT\",\n-\t\t\t\t\"CAP_KILL\",\n-\t\t\t\t\"CAP_AUDIT_WRITE\",\n-\t\t\t},\n \t\t\tAmbient: []string{\n \t\t\t\t\"CAP_CHOWN\",\n \t\t\t\t\"CAP_DAC_OVERRIDE\","
        },
        {
          "filename": "libcontainer/specconv/example.go",
          "status": "modified",
          "additions": 0,
          "deletions": 5,
          "patch": "@@ -41,11 +41,6 @@ func Example() *specs.Spec {\n \t\t\t\t\t\"CAP_KILL\",\n \t\t\t\t\t\"CAP_NET_BIND_SERVICE\",\n \t\t\t\t},\n-\t\t\t\tInheritable: []string{\n-\t\t\t\t\t\"CAP_AUDIT_WRITE\",\n-\t\t\t\t\t\"CAP_KILL\",\n-\t\t\t\t\t\"CAP_NET_BIND_SERVICE\",\n-\t\t\t\t},\n \t\t\t\tAmbient: []string{\n \t\t\t\t\t\"CAP_AUDIT_WRITE\",\n \t\t\t\t\t\"CAP_KILL\","
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "610aa88ab201f289c05c2e262912d0630f46eb35",
            "date": "2025-01-10T20:23:22Z",
            "author_login": "kolyshkin"
          },
          {
            "sha": "4120935737a51cbf23676977cc8bf0b6717702f1",
            "date": "2025-01-09T10:45:31Z",
            "author_login": "lifubang"
          },
          {
            "sha": "06f1e0765576dcf6d8c2ef5e56d309618310992c",
            "date": "2024-06-23T23:31:57Z",
            "author_login": "kolyshkin"
          },
          {
            "sha": "6171da60058fe58c6bd2f2a4ae8be381cfc12cce",
            "date": "2024-12-23T01:32:02Z",
            "author_login": "kolyshkin"
          },
          {
            "sha": "c49b89168140c70dc1badd17d5ed361788898fe9",
            "date": "2024-12-21T19:52:25Z",
            "author_login": "kolyshkin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-276",
    "description": "runc is a CLI tool for spawning and running containers on Linux according to the OCI specification. A bug was found in runc prior to version 1.1.2 where `runc exec --cap` created processes with non-empty inheritable Linux process capabilities, creating an atypical Linux environment and enabling programs with inheritable file capabilities to elevate those capabilities to the permitted set during execve(2). This bug did not affect the container security sandbox as the inheritable set never contained more capabilities than were included in the container's bounding set. This bug has been fixed in runc 1.1.2. This fix changes `runc exec --cap` behavior such that the additional capabilities granted to the process being executed (as specified via `--cap` arguments) do not include inheritable capabilities. In addition, `runc spec` is changed to not set any inheritable capabilities in the created example OCI spec (`config.json`) file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-17T21:15:08.320",
    "last_modified": "2024-11-21T06:58:36.893",
    "fix_date": "2022-05-11T22:15:42Z"
  },
  "references": [
    {
      "url": "https://github.com/opencontainers/runc/commit/d04de3a9b72d7a2455c1885fc75eb36d02cd17b5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opencontainers/runc/releases/tag/v1.1.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opencontainers/runc/security/advisories/GHSA-f3fp-gc8g-vw66",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/03/msg00023.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AVPZBV7ISA7QKRPTC7ZXWKMIQI2HZEBB/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/D77CKD3AXPMU4PMQIQI5Q74SI4JATNND/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/GPQU4YC4AAY54JDXGDQHJEYKSXXG5T2Y/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/opencontainers/runc/commit/d04de3a9b72d7a2455c1885fc75eb36d02cd17b5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opencontainers/runc/releases/tag/v1.1.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opencontainers/runc/security/advisories/GHSA-f3fp-gc8g-vw66",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/03/msg00023.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/AVPZBV7ISA7QKRPTC7ZXWKMIQI2HZEBB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/D77CKD3AXPMU4PMQIQI5Q74SI4JATNND/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/GPQU4YC4AAY54JDXGDQHJEYKSXXG5T2Y/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.127525",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "runc",
    "owner": "opencontainers",
    "created_at": "2015-06-05T23:30:45Z",
    "updated_at": "2025-01-14T11:33:23Z",
    "pushed_at": "2025-01-13T07:56:10Z",
    "size": 21572,
    "stars": 12051,
    "forks": 2130,
    "open_issues": 365,
    "watchers": 12051,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release-1.0",
      "release-1.1",
      "release-1.2"
    ],
    "languages": {
      "Go": 1253070,
      "Shell": 305324,
      "C": 45119,
      "Makefile": 7226,
      "Dockerfile": 2644,
      "Ruby": 2035
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:26:33.730029"
  }
}