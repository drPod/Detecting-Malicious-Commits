{
  "cve_id": "CVE-2022-29196",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "174c5096f303d5be7ed2ca2662b08371bff4ab88",
    "related_commits": [
      "174c5096f303d5be7ed2ca2662b08371bff4ab88",
      "174c5096f303d5be7ed2ca2662b08371bff4ab88"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "174c5096f303d5be7ed2ca2662b08371bff4ab88",
      "commit_date": "2022-04-29T22:15:39Z",
      "author": {
        "login": "cantonios",
        "type": "User",
        "stats": {
          "total_commits": 299,
          "average_weekly_commits": 0.6203319502074689,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "Fix failed check in Conv3DBackpropFilterV2.",
        "length": 212,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 30,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/conv_grad_ops_3d.cc",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -741,6 +741,10 @@ class Conv3DBackpropFilterOp : public OpKernel {\n     TensorShape filter_shape;\n     if (takes_shape_) {\n       const Tensor& filter_sizes = context->input(1);\n+      OP_REQUIRES(context, TensorShapeUtils::IsVector(filter_sizes.shape()),\n+                  errors::InvalidArgument(\n+                      \"filter_sizes shape must be rank 1 but is rank \",\n+                      filter_sizes.shape().dims()));\n       OP_REQUIRES_OK(context, TensorShapeUtils::MakeShape(\n                                   filter_sizes.vec<int32>(), &filter_shape));\n     } else {\n@@ -875,6 +879,10 @@ class Conv3DCustomBackpropFilterOp : public OpKernel {\n     TensorShape filter_shape;\n     if (takes_shape_) {\n       const Tensor& filter_sizes = context->input(1);\n+      OP_REQUIRES(context, TensorShapeUtils::IsVector(filter_sizes.shape()),\n+                  errors::InvalidArgument(\n+                      \"filter_sizes shape must be rank 1 but is rank \",\n+                      filter_sizes.shape().dims()));\n       OP_REQUIRES_OK(context, TensorShapeUtils::MakeShape(\n                                   filter_sizes.vec<int32>(), &filter_shape));\n     } else {\n@@ -1638,6 +1646,10 @@ class Conv3DBackpropFilterOp<GPUDevice, T> : public OpKernel {\n     TensorShape filter_shape;\n     if (takes_shape_) {\n       const Tensor& filter_sizes = context->input(1);\n+      OP_REQUIRES(context, TensorShapeUtils::IsVector(filter_sizes.shape()),\n+                  errors::InvalidArgument(\n+                      \"filter_sizes shape must be rank 1 but is rank \",\n+                      filter_sizes.shape().dims()));\n       OP_REQUIRES_OK(context, tensor::MakeShape(filter_sizes, &filter_shape));\n     } else {\n       filter_shape = context->input(1).shape();"
        },
        {
          "filename": "tensorflow/python/kernel_tests/nn_ops/conv3d_backprop_filter_v2_grad_test.py",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -18,6 +18,7 @@\n \n from tensorflow.python.framework import constant_op\n from tensorflow.python.framework import dtypes\n+from tensorflow.python.framework import errors\n from tensorflow.python.framework import test_util\n from tensorflow.python.ops import array_ops\n from tensorflow.python.ops import gradient_checker\n@@ -58,6 +59,23 @@ def testGradient(self):\n           err_tolerance = 1e-3\n           self.assertLess(err, err_tolerance)\n \n+  def testBadFilterShape(self):\n+    strides = [1, 1, 1, 1, 1]\n+    padding = \"VALID\"\n+    tin = constant_op.constant(\n+        .5053710941, shape=[2, 2, 2, 2, 1], dtype=dtypes.float32)\n+    filter_sizes = constant_op.constant(0, shape=[], dtype=dtypes.int32)\n+    out_backprop = constant_op.constant(\n+        .5053710941, shape=[2, 2, 2, 2, 1], dtype=dtypes.float32)\n+\n+    with self.assertRaisesRegex((ValueError, errors.InvalidArgumentError),\n+                                \"must be rank 1\"):\n+      nn_ops.conv3d_backprop_filter_v2(\n+          input=tin,\n+          filter_sizes=filter_sizes,\n+          out_backprop=out_backprop,\n+          strides=strides,\n+          padding=padding)\n \n if __name__ == \"__main__\":\n   test.main()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5c27f5f4dc39afdefbd93c2ef266a8c7ab534a98",
            "date": "2025-01-25T18:55:10Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "05df81c283627135b7651c9c7a8fa0035bff2206",
            "date": "2025-01-25T17:06:34Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "4075a7dd74ea543557d1824e16721598e1a6af8d",
            "date": "2025-01-25T17:06:30Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "4d08d96d6a0aea39c5bd90d9728dbcf59008993c",
            "date": "2025-01-25T17:04:34Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "1b58ec4dcd6e5752598dc57d4788119f8ea12e23",
            "date": "2025-01-25T11:39:06Z",
            "author_login": "tensorflower-gardener"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-20",
    "description": "TensorFlow is an open source platform for machine learning. Prior to versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4, the implementation of `tf.raw_ops.Conv3DBackpropFilterV2` does not fully validate the input arguments. This results in a `CHECK`-failure which can be used to trigger a denial of service attack. The code does not validate that the `filter_sizes` argument is a vector. Versions 2.9.0, 2.8.1, 2.7.2, and 2.6.4 contain a patch for this issue.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-20T22:16:40.687",
    "last_modified": "2024-11-21T06:58:41.363",
    "fix_date": "2022-04-29T22:15:39Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels/conv_grad_ops_3d.cc",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/174c5096f303d5be7ed2ca2662b08371bff4ab88",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.4",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.7.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.8.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.9.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-5v77-j66x-4c4g",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/f3b9bf4c3c0597563b289c0512e98d4ce81f886e/tensorflow/core/kernels/conv_grad_ops_3d.cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/174c5096f303d5be7ed2ca2662b08371bff4ab88",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.6.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.7.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.8.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/releases/tag/v2.9.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-5v77-j66x-4c4g",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.142135",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-26T06:52:14Z",
    "pushed_at": "2025-01-26T07:27:00Z",
    "size": 1126495,
    "stars": 187418,
    "forks": 74442,
    "open_issues": 6822,
    "watchers": 187418,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101327392,
      "Python": 45791326,
      "MLIR": 10764225,
      "HTML": 7662661,
      "Starlark": 7439181,
      "Go": 2171369,
      "C": 1294440,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 702245,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 38067,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15545,
      "avg_commits_per_week": 298.9423076923077,
      "days_active_last_year": 354
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:37:26.588757"
  }
}