{
  "cve_id": "CVE-2022-29215",
  "github_data": {
    "repository": "kaidomc-pm-pl/RegionProtect",
    "fix_commit": "0060d421358ab59acb6a168eab0d11c43d2d105d",
    "related_commits": [
      "0060d421358ab59acb6a168eab0d11c43d2d105d",
      "0060d421358ab59acb6a168eab0d11c43d2d105d"
    ],
    "patch_url": "https://github.com/kaidomc-pm-pl/RegionProtect/commit/0060d421358ab59acb6a168eab0d11c43d2d105d.patch",
    "fix_commit_details": {
      "sha": "0060d421358ab59acb6a168eab0d11c43d2d105d",
      "commit_date": "2022-05-11T06:02:03Z",
      "author": {
        "login": "NhanAZ",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Patch the hole",
        "length": 124,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/kaidoMC/RegionProtect/RegionProtect.php",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -122,6 +122,10 @@ private function getBasicForm(Player $sender): void {\n \t\t\tif ($result === null) {\n \t\t\t\treturn;\n \t\t\t}\n+\t\t\tif (!preg_match('/^[\\w]+$/', $result[2])) {\n+\t\t\t\t$sender->sendMessage(TextFormat::RED . \"Invalid region name! Only alphanumeric characters allowed.\");\n+\t\t\t\treturn;\n+\t\t\t}\n \t\t\tif ($result[2] != null and $result[3] != null) {\n \t\t\t\t$this->getVectorAdjust()->setLocation($sender, $result[2], $result[3], [$X1, $Y1, $Z1], [$X2, $Y2, $Z2]);\n \t\t\t} else {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "db48ce82c9826308b1d89f65e78bbbe785f04b90",
            "date": "2023-06-07T08:50:24Z",
            "author_login": "NhanAZ"
          },
          {
            "sha": "84c16a2eacb4db9319abdbfc9470bb83dee616b1",
            "date": "2023-06-05T16:23:50Z",
            "author_login": "NhanAZ"
          },
          {
            "sha": "9f34d05fa87b0f810a3e5449441d0eee54940792",
            "date": "2023-06-04T10:23:14Z",
            "author_login": "NhanAZ"
          },
          {
            "sha": "4145f44e47d7a1d2d8c8c13ef993305cc39003c6",
            "date": "2023-06-04T10:19:32Z",
            "author_login": "NhanAZ"
          },
          {
            "sha": "7e03a23bb452000632fd8508e9f1680ea6031693",
            "date": "2023-06-04T10:16:24Z",
            "author_login": "NhanAZ"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-88",
    "description": "RegionProtect is a plugin that allows users to manage certain events in certain regions of the world. Versions prior to 1.1.0 contain a YAML injection vulnerability that can cause an instant server crash if the passed arguments are not matched. Version 1.1.0 contains a patch for this issue. As a workaround, restrict operator permissions to untrusted people and avoid entering arguments likely to cause a crash.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-05-21T00:15:11.917",
    "last_modified": "2024-11-21T06:58:44.207",
    "fix_date": "2022-05-11T06:02:03Z"
  },
  "references": [
    {
      "url": "https://github.com/kaidomc-pm-pl/RegionProtect/commit/0060d421358ab59acb6a168eab0d11c43d2d105d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kaidomc-pm-pl/RegionProtect/security/advisories/GHSA-7gr2-w2r3-r9vf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kaidomc-pm-pl/RegionProtect/commit/0060d421358ab59acb6a168eab0d11c43d2d105d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kaidomc-pm-pl/RegionProtect/security/advisories/GHSA-7gr2-w2r3-r9vf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.146871",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "RegionProtect",
    "owner": "kaidomc-pm-pl",
    "created_at": "2021-12-18T18:36:36Z",
    "updated_at": "2023-06-04T09:32:54Z",
    "pushed_at": "2023-12-06T10:14:31Z",
    "size": 69,
    "stars": 1,
    "forks": 2,
    "open_issues": 3,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 21983
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T19:03:18.844358"
  }
}