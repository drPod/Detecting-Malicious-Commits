{
  "cve_id": "CVE-2022-29242",
  "github_data": {
    "repository": "gost-engine/engine",
    "fix_commit": "7df766124f87768b43b9e8947c5a01e17545772c",
    "related_commits": [
      "7df766124f87768b43b9e8947c5a01e17545772c",
      "b2b4d629f100eaee9f5942a106b1ccefe85b8808",
      "c6655a0b620a3e31f085cc906f8073fe81b2fad3",
      "7df766124f87768b43b9e8947c5a01e17545772c",
      "b2b4d629f100eaee9f5942a106b1ccefe85b8808",
      "c6655a0b620a3e31f085cc906f8073fe81b2fad3"
    ],
    "patch_url": "https://github.com/gost-engine/engine/commit/7df766124f87768b43b9e8947c5a01e17545772c.patch",
    "fix_commit_details": {
      "sha": "7df766124f87768b43b9e8947c5a01e17545772c",
      "commit_date": "2022-05-21T18:06:47Z",
      "author": {
        "login": "beldmit",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix buffer overrun in creating key transport blob according to RFC 9189, 4.2.4.2",
        "length": 106,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 21,
        "deletions": 1
      },
      "files": [
        {
          "filename": "gost_ec_keyx.c",
          "status": "modified",
          "additions": 21,
          "deletions": 1,
          "patch": "@@ -292,6 +292,8 @@ static int pkey_GOST_ECcp_encrypt(EVP_PKEY_CTX *pctx, unsigned char *out,\n     int key_is_ephemeral = 1;\n     gost_ctx cctx;\n     EVP_PKEY *sec_key = EVP_PKEY_CTX_get0_peerkey(pctx);\n+    int res_len = 0;\n+\n     if (data->shared_ukm_size) {\n         memcpy(ukm, data->shared_ukm, 8);\n     } else {\n@@ -373,8 +375,26 @@ static int pkey_GOST_ECcp_encrypt(EVP_PKEY_CTX *pctx, unsigned char *out,\n             goto err;\n         }\n     }\n-    if ((*out_len = i2d_GOST_KEY_TRANSPORT(gkt, out ? &out : NULL)) > 0)\n+    res_len = i2d_GOST_KEY_TRANSPORT(gkt, NULL);\n+    if (res_len <= 0) {\n+        GOSTerr(GOST_F_PKEY_GOST_ECCP_ENCRYPT, ERR_R_ASN1_LIB);\n+        goto err;\n+    }\n+\n+    if (out == NULL) {\n+        *out_len = res_len;\n         ret = 1;\n+    } else {\n+        if ((size_t)res_len > *out_len) {\n+            GOSTerr(GOST_F_PKEY_GOST_ECCP_ENCRYPT, GOST_R_INVALID_BUFFER_SIZE);\n+            goto err;\n+        }\n+        if ((*out_len = i2d_GOST_KEY_TRANSPORT(gkt, &out)) > 0)\n+            ret = 1;\n+        else\n+            GOSTerr(GOST_F_PKEY_GOST_ECCP_ENCRYPT, ERR_R_ASN1_LIB);\n+    }\n+\n     OPENSSL_cleanse(shared_key, sizeof(shared_key));\n     GOST_KEY_TRANSPORT_free(gkt);\n     return ret;"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ede3886cc5507c2ba000ab9b057f198da03e8766",
            "date": "2024-03-22T02:20:50Z",
            "author_login": "vt-alt"
          },
          {
            "sha": "27245fdabff573bb85d6aeb2e228a854170296ee",
            "date": "2024-03-22T02:12:53Z",
            "author_login": "vt-alt"
          },
          {
            "sha": "e0a500ab877ba72cb14026a24d462dd923b90ced",
            "date": "2023-11-17T15:36:18Z",
            "author_login": "beldmit"
          },
          {
            "sha": "2a8a5e0ecaa3e3d6f4ec722a49aa72476755c2b7",
            "date": "2023-07-28T09:51:36Z",
            "author_login": "beldmit"
          },
          {
            "sha": "af20283d945d0607c2245e7f5871ee09c9024bc0",
            "date": "2023-06-14T14:12:51Z",
            "author_login": "vt-alt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-120",
    "description": "GOST engine is a reference implementation of the Russian GOST crypto algorithms for OpenSSL. TLS clients using GOST engine when ciphersuite `TLS_GOSTR341112_256_WITH_KUZNYECHIK_CTR_OMAC` is agreed and the server uses 512 bit GOST secret keys are vulnerable to buffer overflow. GOST engine version 3.0.1 contains a patch for this issue. Disabling ciphersuite `TLS_GOSTR341112_256_WITH_KUZNYECHIK_CTR_OMAC` is a possible workaround.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-05-24T15:15:08.097",
    "last_modified": "2024-11-21T06:58:47.387",
    "fix_date": "2022-05-21T18:06:47Z"
  },
  "references": [
    {
      "url": "https://github.com/gost-engine/engine/commit/7df766124f87768b43b9e8947c5a01e17545772c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/commit/b2b4d629f100eaee9f5942a106b1ccefe85b8808",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/commit/c6655a0b620a3e31f085cc906f8073fe81b2fad3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/releases/tag/v3.0.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/security/advisories/GHSA-2rmw-8wpg-vgw5",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/commit/7df766124f87768b43b9e8947c5a01e17545772c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/commit/b2b4d629f100eaee9f5942a106b1ccefe85b8808",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/commit/c6655a0b620a3e31f085cc906f8073fe81b2fad3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/releases/tag/v3.0.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gost-engine/engine/security/advisories/GHSA-2rmw-8wpg-vgw5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:07.156698",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "engine",
    "owner": "gost-engine",
    "created_at": "2015-08-13T17:30:16Z",
    "updated_at": "2024-12-27T13:09:45Z",
    "pushed_at": "2024-07-30T15:25:22Z",
    "size": 3151,
    "stars": 382,
    "forks": 173,
    "open_issues": 58,
    "watchers": 382,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 7299729,
      "Tcl": 328664,
      "Perl": 52196,
      "CMake": 15526,
      "Batchfile": 13451,
      "Shell": 8388,
      "Roff": 4470,
      "Makefile": 41,
      "eC": 38
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:09:20.606490"
  }
}