{
  "cve_id": "CVE-2022-29450",
  "github_data": {
    "repository": "oliverschloebe/admin-management-xtended",
    "fix_commit": "f94732d222414f10ce015e95b5c7c9fba13a8a20",
    "related_commits": [
      "f94732d222414f10ce015e95b5c7c9fba13a8a20",
      "f94732d222414f10ce015e95b5c7c9fba13a8a20"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f94732d222414f10ce015e95b5c7c9fba13a8a20",
      "commit_date": "2022-06-18T11:41:32Z",
      "author": {
        "login": "oliverschloebe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "2.4.5 Release",
        "length": 151,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 143,
        "additions": 122,
        "deletions": 21
      },
      "files": [
        {
          "filename": "admin-management-xtended.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -1,7 +1,7 @@\n <?php\n /*\n Plugin Name: Admin Management Xtended\n-Version: 2.4.4\n+Version: 2.4.5\n Plugin URI: https://www.schloebe.de/wordpress/admin-management-xtended-plugin/\n Description: <strong>WordPress 4.3+ only.</strong> Extends admin functionalities by introducing: toggling post/page visibility inline, changing page order with drag'n'drop, inline category management, inline tag management, changing publication date inline, changing post slug inline, toggling comment status open/closed, hide draft posts, change media order, change media description inline, toggling link visibility, changing link categories\n Author: Oliver Schl&ouml;be\n@@ -10,7 +10,7 @@\n Domain Path: /languages\n \n \n-Copyright 2008-2021 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n+Copyright 2008-2022 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n \n This program is free software; you can redistribute it and/or modify\n it under the terms of the GNU General Public License as published by\n@@ -53,7 +53,7 @@ function ame_is_plugin_active( $plugin_filename ) {\n /**\n  * Define the plugin version\n  */\n-define(\"AME_VERSION\", \"2.4.4\");\n+define(\"AME_VERSION\", \"2.4.5\");\n \n /**\n  * Define the global var AMEISWP43, returning bool if WP 4.3 or higher is running"
        },
        {
          "filename": "css/styles.css",
          "status": "modified",
          "additions": 7,
          "deletions": 2,
          "patch": "@@ -1,7 +1,8 @@\n-.status-draft, .status-future, .cannotdrop {\n-\t-moz-opacity: 0.4;\n+.cannotdrop {\n+\topacity: 0.4;\n \tfilter:Alpha(opacity=40, finishopacity=40, style=1);\n }\n+\n .ondragrow {\n \tbackground: #328AB2;\n \tcolor: #fff;\n@@ -11,6 +12,10 @@\n \tcolor: #fff;\n }\n \n+#TB_ajaxContent {\n+\toverflow: hidden;\n+}\n+\n ul#categorychecklist {\n \tlist-style: none;\n \tpadding: 0;"
        },
        {
          "filename": "general-functions.php",
          "status": "modified",
          "additions": 78,
          "deletions": 10,
          "patch": "@@ -8,7 +8,7 @@\n  */\n \n /*\n- * Copyright 2008-2020 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n+ * Copyright 2008-2022 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n  *\n  * This program is free software; you can redistribute it and/or modify\n  * it under the terms of the GNU General Public License as published by\n@@ -71,6 +71,8 @@ function return_function($output) {\n  */\n function ame_ajax_save_mediadesc() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\n \t$postid = intval( $_POST['postid'] );\n \t$new_mediadesc = $_POST['new_mediadesc'];\n \t\n@@ -96,6 +98,8 @@ function ame_ajax_save_mediadesc() {\n  */\n function ame_ajax_set_commentstatus() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\n \t$postid = intval( $_POST['postid'] );\n \t$q_status = intval( $_POST['comment_status'] );\n \t\n@@ -127,6 +131,7 @@ function ame_ajax_set_commentstatus() {\n  */\n function ame_get_pageorder() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n \t\n \tif( !current_user_can( 'edit_pages' ) ) {\n \t\tdie();\n@@ -155,6 +160,8 @@ function ame_get_pageorder() {\n  */\n function ame_ajax_save_tags() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['postid'] );\n \t$ame_tags = $_POST['new_tags'];\n \t\n@@ -200,6 +207,8 @@ function ame_ajax_save_tags() {\n  */\n function ame_ajax_get_categories() {\n \tglobal $wpdb, $post;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$ame_id = intval( $_POST['postid'] );\n \t\n \tif( !current_user_can( 'edit_post', $ame_id ) ) {\n@@ -232,6 +241,8 @@ function ame_ajax_get_categories() {\n  */\n function ame_ajax_save_categories() {\n \tglobal $wpdb, $post;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['postid'] );\n \t$ame_cats = $_POST['ame_cats'];\n \t\n@@ -272,6 +283,8 @@ function ame_ajax_save_categories() {\n  */\n function ame_toggle_showinvisposts() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$status = intval( $_POST['status'] );\n \t\n \tupdate_option( \"ame_toggle_showinvisposts\", $status );\n@@ -300,6 +313,8 @@ function ame_ajax_toggle_imageset() {\n  */\n function ame_toggle_orderoptions() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$status = intval( $_POST['status'] );\n \t\n \tupdate_option( \"ame_show_orderoptions\", $status );\n@@ -314,6 +329,8 @@ function ame_toggle_orderoptions() {\n  */\n function ame_slug_edit() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['category_id'] );\n \tif( is_string( $_POST['posttype'] ) ) $posttype = $_POST['posttype'];\n \t\n@@ -342,6 +359,8 @@ function ame_slug_edit() {\n  */\n function ame_author_edit() {\n \tglobal $wpdb, $current_user;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['post_id'] );\n \t\n \tif( !current_user_can( 'edit_post', $postid ) ) {\n@@ -396,6 +415,8 @@ function ame_author_edit() {\n  */\n function ame_save_order() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['category_id'] );\n \t$neworderid = intval( $_POST['new_orderid'] );\n \t\n@@ -416,6 +437,8 @@ function ame_save_order() {\n  */\n function ame_save_slug() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['category_id'] );\n \t\n \tif( !current_user_can( 'edit_post', $postid ) ) {\n@@ -451,6 +474,8 @@ function ame_save_slug() {\n  */\n function ame_save_author() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['category_id'] );\n \t\n \tif( !current_user_can( 'edit_post', $postid ) ) {\n@@ -480,6 +505,8 @@ function ame_save_author() {\n  */\n function ame_save_title() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['category_id'] );\n \t$new_title = $_POST['new_title'];\n \t$new_title = apply_filters( 'the_title', $new_title );\n@@ -504,6 +531,8 @@ function ame_save_title() {\n  */\n function ame_set_date() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( substr( $_POST['category_id'], 10, 5 ) );\n \t\n \tif( !current_user_can( 'edit_post', $postid ) ) {\n@@ -542,6 +571,8 @@ function ame_set_date() {\n  */\n function ame_toggle_visibility() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['category_id'] );\n \t\n \tif( !current_user_can( 'edit_post', $postid ) ) {\n@@ -584,6 +615,8 @@ function ame_toggle_visibility() {\n  */\n function ame_toggle_sticky() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$postid = intval( $_POST['post_id'] );\n \t\n \tif( !current_user_can( 'edit_post', $postid ) ) {\n@@ -612,6 +645,8 @@ function ame_toggle_sticky() {\n  * @link http://plugins.trac.wordpress.org/browser/exclude-pages/trunk/exclude_pages.php#L162\n  */\n function ame_toggle_excludestatus() {\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \tif( !current_user_can( 'edit_pages' ) ) {\n \t\tdie();\n \t\treturn;\n@@ -955,9 +990,20 @@ function ame_enqueue_stuff_edit() {\n \t\t\twp_enqueue_script( 'ame_gui-modificators', AME_PLUGINFULLURL . \"js/gui-modificators.js\", array(\n \t\t\t\t'sack' \n \t\t\t), AME_VERSION );\n-\t\t\twp_enqueue_script( 'ame_miscscripts', AME_PLUGINFULLURL . \"js/functions.js\", array(\n-\t\t\t\t'sack' \n-\t\t\t), AME_VERSION );\n+\t\t\twp_register_script( \n+\t\t\t\t'ame_miscscripts',\n+\t\t\t\tAME_PLUGINFULLURL . \"js/functions.js\",\n+\t\t\t\tarray( 'jquery', 'sack' ),\n+\t\t\t\tAME_VERSION\n+\t\t\t);   \n+\t\t\twp_enqueue_script( 'ame_miscscripts' );    \n+\t\t\twp_localize_script( \n+\t\t\t\t'ame_miscscripts',\n+\t\t\t\t'ameAjaxSec',\n+\t\t\t\tarray(\n+\t\t\t\t\t'ajaxnonce'\t=> wp_create_nonce( 'ame_ajax_validation' )\n+\t\t\t\t) \n+\t\t\t);\n \t\t}\n \t\t\n \t\tadd_action( 'admin_head', 'ame_css_admin_header' );\n@@ -1000,9 +1046,20 @@ function ame_enqueue_stuff_linkmanager() {\n \t\t\twp_enqueue_script( 'ame_gui-modificators', AME_PLUGINFULLURL . \"js/gui-modificators.js\", array(\n \t\t\t\t'sack' \n \t\t\t), AME_VERSION );\n-\t\t\twp_enqueue_script( 'ame_miscscripts', AME_PLUGINFULLURL . \"js/functions.js\", array(\n-\t\t\t\t'sack' \n-\t\t\t), AME_VERSION );\n+\t\t\twp_register_script( \n+\t\t\t\t'ame_miscscripts',\n+\t\t\t\tAME_PLUGINFULLURL . \"js/functions.js\",\n+\t\t\t\tarray( 'jquery', 'sack' ),\n+\t\t\t\tAME_VERSION\n+\t\t\t);   \n+\t\t\twp_enqueue_script( 'ame_miscscripts' );    \n+\t\t\twp_localize_script( \n+\t\t\t\t'ame_miscscripts',\n+\t\t\t\t'ameAjaxSec',\n+\t\t\t\tarray(\n+\t\t\t\t\t'ajaxnonce'\t=> wp_create_nonce( 'ame_ajax_validation' )\n+\t\t\t\t) \n+\t\t\t);\n \t\t}\n \t\t\n \t\tadd_action( 'admin_print_scripts', 'ame_js_admin_header' );\n@@ -1015,9 +1072,20 @@ function ame_enqueue_stuff_upload() {\n \t\t\twp_enqueue_script( 'ame_gui-modificators', AME_PLUGINFULLURL . \"js/gui-modificators.js\", array(\n \t\t\t\t'sack' \n \t\t\t), AME_VERSION );\n-\t\t\twp_enqueue_script( 'ame_miscscripts', AME_PLUGINFULLURL . \"js/functions.js\", array(\n-\t\t\t\t'sack' \n-\t\t\t), AME_VERSION );\n+\t\t\twp_register_script( \n+\t\t\t\t'ame_miscscripts',\n+\t\t\t\tAME_PLUGINFULLURL . \"js/functions.js\",\n+\t\t\t\tarray( 'jquery', 'sack' ),\n+\t\t\t\tAME_VERSION\n+\t\t\t);   \n+\t\t\twp_enqueue_script( 'ame_miscscripts' );    \n+\t\t\twp_localize_script( \n+\t\t\t\t'ame_miscscripts',\n+\t\t\t\t'ameAjaxSec',\n+\t\t\t\tarray(\n+\t\t\t\t\t'ajaxnonce'\t=> wp_create_nonce( 'ame_ajax_validation' )\n+\t\t\t\t) \n+\t\t\t);\n \t\t}\n \t\t\n \t\tadd_action( 'admin_print_scripts', 'ame_js_admin_header' );"
        },
        {
          "filename": "js/functions.js",
          "status": "modified",
          "additions": 21,
          "deletions": 1,
          "patch": "@@ -25,6 +25,7 @@ function mediadescSpanFadeOut( postid, ame_mediadesc ) {\n \t\t\tame_sack.execute = 1;\n \t\t\tame_sack.method = 'POST';\n \t\t\tame_sack.setVar( \"action\", \"ame_ajax_save_mediadesc\" );\n+\t\t\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \t\t\tame_sack.setVar( \"postid\", postid );\n \t\t\tame_sack.setVar( \"new_mediadesc\", ame_mediadesc );\n \t\t\tame_sack.onError = function() { alert('Ajax error on saving media description'); };\n@@ -45,7 +46,6 @@ function ame_ajax_form_tags( postid, posttags ) {\n \t\tvar new_tags = jQuery('input#ame-new-tags' + postid).val();\n \t\ttagSpanFadeOut( postid, new_tags );\n \t});\n-\tame_setupSuggest( postid );\n }\n \n function tagSpanFadeOut( postid, ame_tags ) {\n@@ -56,6 +56,7 @@ function tagSpanFadeOut( postid, ame_tags ) {\n \t\t\tame_sack.execute = 1;\n \t\t\tame_sack.method = 'POST';\n \t\t\tame_sack.setVar( \"action\", \"ame_ajax_save_tags\" );\n+\t\t\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \t\t\tame_sack.setVar( \"postid\", postid );\n \t\t\tame_sack.setVar( \"new_tags\", ame_tags );\n \t\t\tame_sack.onError = function() { alert('Ajax error on saving tags'); };\n@@ -73,6 +74,7 @@ function catSpanFadeOut( postid, ame_cats ) {\n \t\t\tame_sack.execute = 1;\n \t\t\tame_sack.method = 'POST';\n \t\t\tame_sack.setVar( \"action\", \"ame_ajax_save_categories\" );\n+\t\t\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \t\t\tame_sack.setVar( \"postid\", postid );\n \t\t\tame_sack.setVar( \"ame_cats\", ame_cats );\n \t\t\tame_sack.onError = function() { alert('Ajax error on saving categories'); };\n@@ -89,6 +91,7 @@ function ame_ajax_get_categories( postid ) {\n \tame_sack.execute = 0;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_ajax_get_categories\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"postid\", postid );\n \tame_sack.onError = function() { alert('Ajax error on getting categories') };\n \tame_sack.onCompletion = function() {\n@@ -118,6 +121,7 @@ function linkcatSpanFadeOut( linkid, ame_linkcats ) {\n \t\t\tame_sack.execute = 1;\n \t\t\tame_sack.method = 'POST';\n \t\t\tame_sack.setVar( \"action\", \"ame_ajax_save_linkcategories\" );\n+\t\t\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \t\t\tame_sack.setVar( \"linkid\", linkid );\n \t\t\tame_sack.setVar( \"ame_linkcats\", ame_linkcats );\n \t\t\tame_sack.onError = function() { alert('Ajax error on saving link categories'); };\n@@ -143,6 +147,7 @@ function ame_ajax_set_commentstatus( postid, status, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_ajax_set_commentstatus\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"postid\", postid );\n \tame_sack.setVar( \"comment_status\", status );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -155,6 +160,7 @@ function ame_ajax_get_pageorder( pageordertable ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_get_pageorder\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"pageordertable2\", pageordertable );\n \tame_sack.onError = function() { alert('Ajax error on getting page order') };\n \tame_sack.runAJAX();\n@@ -165,6 +171,7 @@ function ame_ajax_toggle_imageset( setid ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_ajax_toggle_imageset\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"setid\", setid );\n \tame_sack.onError = function() { alert('Ajax error on toggling image set') };\n \tame_sack.runAJAX();\n@@ -176,6 +183,7 @@ function ame_ajax_toggle_showinvisposts( status ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_toggle_showinvisposts\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"status\", status );\n \tame_sack.onError = function() { alert('Ajax error on toggling post visibility') };\n \tame_sack.runAJAX();\n@@ -187,6 +195,7 @@ function ame_ajax_toggle_orderoptions( status ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_toggle_orderoptions\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"status\", status );\n \tame_sack.onError = function() { alert('Ajax error on toggling page order column') };\n \tame_sack.runAJAX();\n@@ -199,6 +208,7 @@ function ame_ajax_order_save( cat_id, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_save_order\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"category_id\", cat_id );\n \tame_sack.setVar( \"new_orderid\", neworderid );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -212,6 +222,7 @@ function ame_slug_edit( cat_id, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_slug_edit\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"col_no\", jQuery('.widefat thead tr th').length );\n \tame_sack.setVar( \"category_id\", cat_id );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -224,6 +235,7 @@ function ame_ajax_set_visibility( post_id, status, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_toggle_visibility\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"category_id\", post_id );\n \tame_sack.setVar( \"vis_status\", status );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -236,6 +248,7 @@ function ame_ajax_set_sticky( post_id, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_toggle_sticky\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"post_id\", post_id );\n \tame_sack.onError = function() { alert('Ajax error on toggling sticky') };\n \tame_sack.runAJAX();\n@@ -246,6 +259,7 @@ function ame_ajax_set_postdate( post_id, pickedDate, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_set_date\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"category_id\", post_id );\n \tame_sack.setVar( \"pickedDate\", pickedDate );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -270,6 +284,7 @@ function ame_ajax_title_save( cat_id, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_save_title\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"category_id\", cat_id );\n \tame_sack.setVar( \"new_title\", newtitle );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -287,6 +302,7 @@ function ame_ajax_slug_save( cat_id, typenumber ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_save_slug\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"category_id\", cat_id );\n \tame_sack.setVar( \"new_slug\", newslug );\n \tame_sack.setVar( \"typenumber\", typenumber );\n@@ -300,6 +316,7 @@ function ame_ajax_author_save( cat_id, typenumber ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_save_author\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"category_id\", cat_id );\n \tame_sack.setVar( \"newauthor\", newauthor );\n \tame_sack.setVar( \"typenumber\", typenumber );\n@@ -312,6 +329,7 @@ function ame_author_edit( post_id, posttype ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_author_edit\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"post_id\", post_id );\n \tame_sack.setVar( \"col_no\", jQuery('.widefat thead tr th').length );\n \tame_sack.setVar( \"posttype\", posttype );\n@@ -324,6 +342,7 @@ function ame_ajax_set_linkvisibility( link_id ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_toggle_linkvisibility\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"link_id\", link_id );\n \tame_sack.onError = function() { alert('Ajax error on toggling link visibility') };\n \tame_sack.runAJAX();\n@@ -339,6 +358,7 @@ function ame_ajax_set_excludestatus( page_id, status_id ) {\n \tame_sack.execute = 1;\n \tame_sack.method = 'POST';\n \tame_sack.setVar( \"action\", \"ame_toggle_excludestatus\" );\n+\tame_sack.setVar( \"security\", ameAjaxSec.ajaxnonce );\n \tame_sack.setVar( \"pageid\", page_id );\n \tame_sack.setVar( \"statusid\", status_id );\n \tame_sack.onError = function() { alert('Ajax error on toggling image set') };"
        },
        {
          "filename": "link-functions.php",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  */\n  \n /*\n-Copyright 2008-2015 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n+Copyright 2008-2022 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n \n This program is free software; you can redistribute it and/or modify\n it under the terms of the GNU General Public License as published by\n@@ -129,6 +129,8 @@ function ame_custom_column_link_categories( $ame_column_name, $ame_id ) {\n  */\n function ame_toggle_linkvisibility() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_validation', 'security' );\n+\t\n \t$posttype = 'link';\n \t$linkid = intval( $_POST['link_id'] );\n \t\n@@ -153,6 +155,8 @@ function ame_toggle_linkvisibility() {\n  */\n function ame_ajax_save_linkcategories() {\n \tglobal $wpdb;\n+\tcheck_ajax_referer( 'ame_ajax_save_linkcategories' );\n+\t\n \t$linkid = (int) $_POST['linkid'];\n \t$ame_linkcats = $_POST['ame_linkcats'];\n \t"
        },
        {
          "filename": "media-functions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  */\n  \n /*\n-Copyright 2008-2015 Oliver Schl\u00f6be (email : webmaster@schloebe.de)\n+Copyright 2008-2022 Oliver Schl\u00f6be (email : webmaster@schloebe.de)\n \n This program is free software; you can redistribute it and/or modify\n it under the terms of the GNU General Public License as published by"
        },
        {
          "filename": "page-functions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  */\n  \n /*\n-Copyright 2008-2020 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n+Copyright 2008-2022 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n \n This program is free software; you can redistribute it and/or modify\n it under the terms of the GNU General Public License as published by"
        },
        {
          "filename": "post-functions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  */\n  \n /*\n-Copyright 2008-2020 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n+Copyright 2008-2022 Oliver Schl\u00f6be (email : scripts@schloebe.de)\n \n This program is free software; you can redistribute it and/or modify\n it under the terms of the GNU General Public License as published by"
        },
        {
          "filename": "readme.txt",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@ Contributors: Alphawolf\n Donate link: https://www.schloebe.de/donate/\n Tags: admin, ajax, management, cms, post, pages, category, inline, media, revision, link, bookmark, drag-and-drop, drag drop, \n Requires at least: 4.3\n-Tested up to: 6.9.9999\n+Tested up to: 6.1\n Stable tag: trunk\n License: GPLv2 or later\n License URI: https://www.gnu.org/licenses/gpl-2.0.html\n@@ -104,6 +104,10 @@ Please visit [the official website](https://www.schloebe.de/wordpress/admin-mana\n \n == Changelog ==\n \n+= 2.4.5 =\n+* FIXED: WordPress 6.0 compatibility\n+* FIXED: CSRF vulnerabilities fixed (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29450)\n+\n = 2.4.4 =\n * FIXED: WordPress 5.5 compatibility\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0b6ad55d0df8a8e3120de23f55c451039ef22fc5",
            "date": "2024-10-20T18:01:06Z",
            "author_login": "oliverschloebe"
          },
          {
            "sha": "39dc6ce663bc6b0679b04661c208dbee8055c3d3",
            "date": "2024-06-12T17:43:27Z",
            "author_login": "oliverschloebe"
          },
          {
            "sha": "db3353de5b6766c0db14277107bbe0687763ca8e",
            "date": "2023-11-06T14:27:08Z",
            "author_login": "oliverschloebe"
          },
          {
            "sha": "be063bea0fba2d0620e9f141cc812156ea44fa97",
            "date": "2023-07-25T15:39:23Z",
            "author_login": "oliverschloebe"
          },
          {
            "sha": "6fae6ea0849376987364447a5c64c7ae807797c5",
            "date": "2023-03-19T14:01:02Z",
            "author_login": "oliverschloebe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L",
    "cwe_id": "CWE-352",
    "description": "Multiple Cross-Site Request Forgery (CSRF) vulnerabilities in Admin Management Xtended plugin <= 2.4.4 at WordPress.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-15T19:15:11.030",
    "last_modified": "2024-11-21T06:59:06.740",
    "fix_date": "2022-06-18T11:41:32Z"
  },
  "references": [
    {
      "url": "https://github.com/oliverschloebe/admin-management-xtended/commit/f94732d222414f10ce015e95b5c7c9fba13a8a20",
      "source": "audit@patchstack.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://patchstack.com/database/vulnerability/admin-management-xtended/wordpress-admin-management-xtended-plugin-2-4-4-multiple-cross-site-request-forgery-csrf-vulnerabilities?_s_id=cve",
      "source": "audit@patchstack.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oliverschloebe/admin-management-xtended/commit/f94732d222414f10ce015e95b5c7c9fba13a8a20",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://patchstack.com/database/vulnerability/admin-management-xtended/wordpress-admin-management-xtended-plugin-2-4-4-multiple-cross-site-request-forgery-csrf-vulnerabilities?_s_id=cve",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.446417",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "admin-management-xtended",
    "owner": "oliverschloebe",
    "created_at": "2013-08-03T19:23:34Z",
    "updated_at": "2024-10-20T18:01:17Z",
    "pushed_at": "2024-10-20T18:01:47Z",
    "size": 260,
    "stars": 1,
    "forks": 0,
    "open_issues": 2,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 85785,
      "JavaScript": 79315,
      "CSS": 3029
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:45:33.090462"
  }
}