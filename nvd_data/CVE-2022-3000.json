{
  "cve_id": "CVE-2022-3000",
  "github_data": {
    "repository": "yetiforcecompany/yetiforcecrm",
    "fix_commit": "eebc12601495ada38495076bec12841b2477516b",
    "related_commits": [
      "eebc12601495ada38495076bec12841b2477516b",
      "eebc12601495ada38495076bec12841b2477516b"
    ],
    "patch_url": "https://github.com/yetiforcecompany/yetiforcecrm/commit/eebc12601495ada38495076bec12841b2477516b.patch",
    "fix_commit_details": {
      "sha": "eebc12601495ada38495076bec12841b2477516b",
      "commit_date": "2022-08-26T06:05:27Z",
      "author": {
        "login": "rskrzypczak",
        "type": "User",
        "stats": {
          "total_commits": 4471,
          "average_weekly_commits": 8.467803030303031,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 412
        }
      },
      "commit_message": {
        "title": "Improved display of data in the modal field editing window",
        "length": 58,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 24,
        "additions": 12,
        "deletions": 12
      },
      "files": [
        {
          "filename": "config/version.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,7 +1,7 @@\n <?php\n \n return [\n-\t'appVersion' => '6.4.11',\n-\t'patchVersion' => '2022.08.25',\n+\t'appVersion' => '6.4.12',\n+\t'patchVersion' => '2022.08.26',\n \t'lib_roundcube' => '0.3.1',\n ];"
        },
        {
          "filename": "layouts/basic/modules/Settings/LayoutEditor/EditField.tpl",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -22,23 +22,23 @@\n \t\t\t\t<input type=\"hidden\" name=\"action\" value=\"Field\" />\n \t\t\t\t<input type=\"hidden\" name=\"mode\" value=\"save\" />\n \t\t\t\t<input type=\"hidden\" name=\"fieldid\" value=\"{$FIELD_MODEL->getId()}\" />\n-\t\t\t\t<input type=\"hidden\" name=\"sourceModule\" value=\"{$SELECTED_MODULE_NAME}\" />\n+\t\t\t\t<input type=\"hidden\" name=\"sourceModule\" value=\"{$SELECTED_MODULE_NAME|escape}\" />\n \t\t\t\t<div class=\"row mx-0 mb-2 py-2 border-bottom\">\n \t\t\t\t\t<div class=\"col-md-6\">\n \t\t\t\t\t\t<strong>{App\\Language::translate('LBL_LABEL_NAME', $QUALIFIED_MODULE)}: </strong>{$FIELD_LABEL_TRANSLATION}<br />\n \t\t\t\t\t\t<strong>{App\\Language::translate('LBL_FIELD_NAME', $QUALIFIED_MODULE)}: </strong>{$FIELD_MODEL->getFieldName()}\n \t\t\t\t\t</div>\n \t\t\t\t\t<div class=\"col-md-6\">\n \t\t\t\t\t\t<strong>{App\\Language::translate('LBL_FIELD_TYPE', $QUALIFIED_MODULE)}: </strong> {if isset($FIEL_TYPE_LABEL[$FIELD_MODEL->getUIType()])}{App\\Language::translate($FIEL_TYPE_LABEL[$FIELD_MODEL->getUIType()], $QUALIFIED_MODULE)}{/if} (UiType: {$FIELD_MODEL->getUIType()})<br />\n-\t\t\t\t\t\t<strong>{App\\Language::translate('LBL_LENGTH', $QUALIFIED_MODULE)}: </strong>{$FIELD_MODEL->get('maximumlength')}\n+\t\t\t\t\t\t<strong>{App\\Language::translate('LBL_LENGTH', $QUALIFIED_MODULE)}: </strong>{$FIELD_MODEL->get('maximumlength')|escape}\n \t\t\t\t\t</div>\n \t\t\t\t</div>\n \t\t\t\t<div class=\"row m-0\">\n \t\t\t\t\t<div class=\"col-md-6 px-1\">\n \t\t\t\t\t\t<div class=\"form-group\">\n \t\t\t\t\t\t\t<label for=\"fieldMask\"><strong>{App\\Language::translate('LBL_LABEL', $QUALIFIED_MODULE)}</strong></label>\n \t\t\t\t\t\t\t<div class=\"input-group\">\n-\t\t\t\t\t\t\t\t<input type=\"text\" name=\"label\" value=\"{$FIELD_MODEL->getFieldLabel()}\" class=\"form-control\"\n+\t\t\t\t\t\t\t\t<input type=\"text\" name=\"label\" value=\"{\\App\\Purifier::encodeHtml($FIELD_MODEL->getFieldLabel())}\" class=\"form-control\"\n \t\t\t\t\t\t\t\t\tid=\"label\" data-validation-engine=\"validate[maxSize[50]]\" />\n \t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t</div>\n@@ -55,7 +55,7 @@\n \t\t\t\t\t\t\t<input type=\"hidden\" name=\"presence\" value=\"1\" />\n \t\t\t\t\t\t\t<input type=\"checkbox\" name=\"presence\" id=\"presence\" {if $FIELD_MODEL->isActiveField()} checked {/if} {strip} {/strip}\n \t\t\t\t\t\t\t\t{if $FIELD_MODEL->isActiveOptionDisabled()} readonly=\"readonly\" class=\"optionDisabled\" {/if} {if $IS_MANDATORY} readonly=\"readonly\" {/if}\n-\t\t\t\t\t\t\t\tvalue=\"{$FIELD_MODEL->get('presence')}\" />\n+\t\t\t\t\t\t\t\tvalue=\"{$FIELD_MODEL->get('presence')|escape}\" />\n \t\t\t\t\t\t\t<label for=\"presence\">\n \t\t\t\t\t\t\t\t{App\\Language::translate('LBL_ACTIVE', $QUALIFIED_MODULE)}\n \t\t\t\t\t\t\t</label>\n@@ -90,7 +90,7 @@\n \t\t\t\t\t\t\t\t{assign var=HEADER_REL_FIELDS value=$FIELD_MODEL->getHeaderValue('rel_fields', [])}\n \t\t\t\t\t\t\t\t<select name=\"header_type\" class=\"js-header_type form-control select2\">\n \t\t\t\t\t\t\t\t\t{foreach key=LABEL item=VALUE from=$FIELD_MODEL->getUITypeModel()->getHeaderTypes()}\n-\t\t\t\t\t\t\t\t\t\t<option value=\"{$VALUE}\" {if $VALUE == $HEADER_FIELD_TYPE} selected {/if}>{App\\Language::translate($LABEL, $QUALIFIED_MODULE)}</option>\n+\t\t\t\t\t\t\t\t\t\t<option value=\"{\\App\\Purifier::encodeHtml($VALUE)}\" {if $VALUE == $HEADER_FIELD_TYPE} selected {/if}>{App\\Language::translate($LABEL, $QUALIFIED_MODULE)}</option>\n \t\t\t\t\t\t\t\t\t{/foreach}\n \t\t\t\t\t\t\t\t</select>\n \t\t\t\t\t\t\t\t{if $FIELD_MODEL->isReferenceField() && count($FIELD_MODEL->getReferenceList()) eq 1}\n@@ -101,9 +101,9 @@\n \t\t\t\t\t\t\t\t\t\t\t\t{foreach from=$REL_MODULE_MODEL->getFields() key=REL_FIELD_NAME item=REL_FIELD_MODEL}\n \t\t\t\t\t\t\t\t\t\t\t\t\t{if $REL_FIELD_MODEL->isViewableInDetailView()}\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t{assign var=ELEMENT_POSITION_IN_ARRAY value=array_search($REL_FIELD_NAME, $HEADER_REL_FIELDS)}\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"{$REL_FIELD_MODEL->getName()}\" data-field-name=\"{$REL_FIELD_NAME}\"\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"{$REL_FIELD_MODEL->getName()}\" data-field-name=\"{$REL_FIELD_NAME|escape}\"\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{if $ELEMENT_POSITION_IN_ARRAY !== false}\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-sort-index=\"{$ELEMENT_POSITION_IN_ARRAY}\" selected=\"selected\"\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-sort-index=\"{$ELEMENT_POSITION_IN_ARRAY|escape}\" selected=\"selected\"\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-js=\"data-sort-index|data-field-name\">\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{App\\Language::translate($REL_FIELD_MODEL->getFieldLabel(), $REL_FIELD_MODEL->getModuleName())}\n@@ -114,7 +114,7 @@\n \t\t\t\t\t\t\t\t\t\t</select>\n \t\t\t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t\t\t{/if}\n-\t\t\t\t\t\t\t\t<input name=\"header_class\" value=\"{if $HEADER_FIELD_VALUE}{$HEADER_FIELD_VALUE}{else}badge-info{/if}\" type=\"text\" class=\"hide\">\n+\t\t\t\t\t\t\t\t<input name=\"header_class\" value=\"{if $HEADER_FIELD_VALUE}{$HEADER_FIELD_VALUE|escape}{else}badge-info{/if}\" type=\"text\" class=\"hide\">\n \t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t</div>\n \t\t\t\t\t\t<div class=\"checkbox\">\n@@ -160,7 +160,7 @@\n \t\t\t\t\t\t\t\t<div class=\" input-group\">\n \t\t\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"fieldMask\" name=\"fieldMask\"\n \t\t\t\t\t\t\t\t\t\t{if $MAX_VALUE} data-validation-engine=\"validate[maxSize[{$MAX_VALUE}]]{/if}\"\n-\t\t\t\t\t\t\t\t\t\tvalue=\"{if isset($PARAMS['mask'])}{$PARAMS['mask']}{/if}\" />\n+\t\t\t\t\t\t\t\t\t\tvalue=\"{if isset($PARAMS['mask'])}{\\App\\Purifier::encodeHtml($PARAMS['mask'])}{/if}\" />\n \t\t\t\t\t\t\t\t\t<div class=\"input-group-append\">\n \t\t\t\t\t\t\t\t\t\t<span class=\"input-group-text js-popover-tooltip u-cursor-pointer\" data-js=\"popover\"\n \t\t\t\t\t\t\t\t\t\t\tdata-placement=\"top\"\n@@ -174,7 +174,7 @@\n \t\t\t\t\t\t<div class=\"form-group\">\n \t\t\t\t\t\t\t<label for=\"maxlengthtext\"><strong>{App\\Language::translate('LBL_MAX_LENGTH_TEXT', $QUALIFIED_MODULE)}</strong></label>\n \t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" id=\"maxlengthtext\" name=\"maxlengthtext\"\n-\t\t\t\t\t\t\t\tvalue=\"{$FIELD_MODEL->get('maxlengthtext')}\" />\n+\t\t\t\t\t\t\t\tvalue=\"{$FIELD_MODEL->get('maxlengthtext')|escape}\" />\n \t\t\t\t\t\t</div>\n \t\t\t\t\t\t<div class=\"form-group\">\n \t\t\t\t\t\t\t<label for=\"maxwidthcolumn\"><strong>{App\\Language::translate('LBL_MAX_WIDTH_COLUMN', $QUALIFIED_MODULE)}</strong></label>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "de296d83c1d36bf0d92303efa9706ded67549aa8",
            "date": "2024-09-13T11:37:49Z",
            "author_login": "rskrzypczak"
          },
          {
            "sha": "4b5e4244b8338c837a8132ff12686f29f222d89b",
            "date": "2024-01-02T08:25:56Z",
            "author_login": "mariuszkrzaczkowski"
          },
          {
            "sha": "f1904a62fc5cd4d5bb3031b19bb2d090bce49ca6",
            "date": "2023-11-27T04:46:42Z",
            "author_login": "rskrzypczak"
          },
          {
            "sha": "711d9fe4c1caddec2dfef52f8ed06ddcebfd2dff",
            "date": "2023-11-08T05:36:13Z",
            "author_login": "rskrzypczak"
          },
          {
            "sha": "4e7ad0fbee5409248285b22fce0ea754d365add4",
            "date": "2023-11-07T16:50:11Z",
            "author_login": "rskrzypczak"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository yetiforcecompany/yetiforcecrm prior to 6.4.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-20T07:15:12.480",
    "last_modified": "2024-11-21T07:18:36.963",
    "fix_date": "2022-08-26T06:05:27Z"
  },
  "references": [
    {
      "url": "https://github.com/yetiforcecompany/yetiforcecrm/commit/eebc12601495ada38495076bec12841b2477516b",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a060d3dd-6fdd-4958-82a9-364df1cb770c",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yetiforcecompany/yetiforcecrm/commit/eebc12601495ada38495076bec12841b2477516b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a060d3dd-6fdd-4958-82a9-364df1cb770c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.147598",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "YetiForceCRM",
    "owner": "yetiforcecompany",
    "created_at": "2014-12-15T22:55:47Z",
    "updated_at": "2025-01-14T02:56:49Z",
    "pushed_at": "2024-09-13T11:43:27Z",
    "size": 419522,
    "stars": 1745,
    "forks": 745,
    "open_issues": 83,
    "watchers": 1745,
    "has_security_policy": false,
    "default_branch": "developer",
    "protected_branches": [],
    "languages": {
      "PHP": 10752494,
      "Smarty": 2974130,
      "JavaScript": 2297348,
      "CSS": 632280,
      "SCSS": 191499,
      "Vue": 129717,
      "Less": 62688,
      "Stylus": 32572,
      "HTML": 7942,
      "Shell": 6065,
      "Dockerfile": 3767,
      "Batchfile": 1536
    },
    "commit_activity": {
      "total_commits_last_year": 1,
      "avg_commits_per_week": 0.019230769230769232,
      "days_active_last_year": 1
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:10:51.726622"
  }
}