{
  "cve_id": "CVE-2022-31026",
  "github_data": {
    "repository": "github/trilogy",
    "fix_commit": "6bed62789eaf119902b0fe247d2a91d56c31a962",
    "related_commits": [
      "6bed62789eaf119902b0fe247d2a91d56c31a962",
      "6bed62789eaf119902b0fe247d2a91d56c31a962"
    ],
    "patch_url": "https://github.com/github/trilogy/commit/6bed62789eaf119902b0fe247d2a91d56c31a962.patch",
    "fix_commit_details": {
      "sha": "6bed62789eaf119902b0fe247d2a91d56c31a962",
      "commit_date": "2022-06-06T20:12:42Z",
      "author": {
        "login": "jhawthorn",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-5g4r-2qhx-vqfm",
        "length": 81,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "contrib/ruby/Gemfile.lock",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n PATH\n   remote: .\n   specs:\n-    trilogy (2.1.0)\n+    trilogy (2.1.1)\n \n GEM\n   remote: https://rubygems.org/"
        },
        {
          "filename": "contrib/ruby/lib/trilogy/version.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,3 +1,3 @@\n class Trilogy\n-  VERSION = \"2.1.0\"\n+  VERSION = \"2.1.1\"\n end"
        },
        {
          "filename": "src/protocol.c",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -275,8 +275,10 @@ int trilogy_parse_handshake_packet(const uint8_t *buff, size_t len, trilogy_hand\n     if (out_packet->capabilities & TRILOGY_CAPABILITIES_SECURE_CONNECTION && auth_data_len > 8) {\n         uint8_t remaining_auth_data_len = auth_data_len - 8;\n \n-        if (remaining_auth_data_len > 13) {\n-            remaining_auth_data_len = 13;\n+        // The auth plugins we support all provide exactly 21 bytes of\n+        // auth_data. Reject any other values for auth_data_len.\n+        if (SCRAMBLE_LEN + 1 != auth_data_len) {\n+            return TRILOGY_PROTOCOL_VIOLATION;\n         }\n \n         CHECKED(trilogy_reader_copy_buffer(&reader, remaining_auth_data_len, out_packet->scramble + 8));"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b517fcf68e29a3e8b8647aaedd6c217c9e7a2c88",
            "date": "2024-12-19T21:17:44Z",
            "author_login": "jhawthorn"
          },
          {
            "sha": "3c0b7872dfa6e071b01a833b80fad683970f132d",
            "date": "2024-12-03T11:29:22Z",
            "author_login": "byroot"
          },
          {
            "sha": "19ac866f28e91fa449cb825b8fcd66747d5d6db8",
            "date": "2024-12-18T23:42:42Z",
            "author_login": "jhawthorn"
          },
          {
            "sha": "5d36347e492b6316b8e3aab27f85bf52c913b98d",
            "date": "2024-12-14T19:13:45Z",
            "author_login": "byroot"
          },
          {
            "sha": "857c167ef845fa7d9b4e670341670d11ce6bba22",
            "date": "2024-12-06T23:40:32Z",
            "author_login": "jhawthorn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-908",
    "description": "Trilogy is a client library for MySQL. When authenticating, a malicious server could return a specially crafted authentication packet, causing the client to read and return up to 12 bytes of data from an uninitialized variable in stack memory. Users of the trilogy gem should upgrade to version 2.1.1 This issue can be avoided by only connecting to trusted servers.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-06-09T13:15:08.457",
    "last_modified": "2024-11-21T07:03:44.403",
    "fix_date": "2022-06-06T20:12:42Z"
  },
  "references": [
    {
      "url": "https://github.com/github/trilogy/commit/6bed62789eaf119902b0fe247d2a91d56c31a962",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/trilogy/security/advisories/GHSA-5g4r-2qhx-vqfm",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/trilogy/commit/6bed62789eaf119902b0fe247d2a91d56c31a962",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/trilogy/security/advisories/GHSA-5g4r-2qhx-vqfm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.421057",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "trilogy",
    "owner": "github",
    "created_at": "2021-12-15T17:18:05Z",
    "updated_at": "2025-01-10T21:22:46Z",
    "pushed_at": "2024-12-19T21:17:45Z",
    "size": 535,
    "stars": 717,
    "forks": 72,
    "open_issues": 32,
    "watchers": 717,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 617262,
      "Ruby": 79168,
      "Shell": 5535,
      "Dockerfile": 1732,
      "Makefile": 1488
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:26:27.414809"
  }
}