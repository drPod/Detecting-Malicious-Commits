{
  "cve_id": "CVE-2022-31047",
  "github_data": {
    "repository": "TYPO3/typo3",
    "fix_commit": "c93ea692e7dfef03b7c50fe5437487545bee4d6a",
    "related_commits": [
      "c93ea692e7dfef03b7c50fe5437487545bee4d6a",
      "c93ea692e7dfef03b7c50fe5437487545bee4d6a"
    ],
    "patch_url": "https://github.com/TYPO3/typo3/commit/c93ea692e7dfef03b7c50fe5437487545bee4d6a.patch",
    "fix_commit_details": {
      "sha": "c93ea692e7dfef03b7c50fe5437487545bee4d6a",
      "commit_date": "2022-06-14T07:17:21Z",
      "author": {
        "login": "derhansen",
        "type": "User",
        "stats": {
          "total_commits": 381,
          "average_weekly_commits": 0.3426258992805755,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 155
        }
      },
      "commit_message": {
        "title": "[SECURITY] Do not log stacktrace in exception handlers",
        "length": 762,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
      },
      "files": [
        {
          "filename": "typo3/sysext/core/Classes/Error/AbstractExceptionHandler.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -40,6 +40,8 @@ abstract class AbstractExceptionHandler implements ExceptionHandlerInterface, Si\n     const CONTEXT_WEB = 'WEB';\n     const CONTEXT_CLI = 'CLI';\n \n+    protected bool $logExceptionStackTrace = false;\n+\n     private const IGNORED_EXCEPTION_CODES = [\n         1396795884, // Current host header value does not match the configured trusted hosts pattern\n         1581862822, // Failed HMAC validation due to modified __trustedProperties in extbase property mapping\n@@ -98,7 +100,7 @@ protected function writeLogEntries(\\Throwable $exception, string $mode): void\n                     'line' => $exception->getLine(),\n                     'message' => $exception->getMessage(),\n                     'request_url' => $requestUrl,\n-                    'exception' => $exception,\n+                    'exception' => $this->logExceptionStackTrace ? $exception : null,\n                 ]);\n             }\n         } catch (\\Exception $exception) {"
        },
        {
          "filename": "typo3/sysext/core/Classes/Error/DebugExceptionHandler.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -26,6 +26,8 @@\n  */\n class DebugExceptionHandler extends AbstractExceptionHandler\n {\n+    protected bool $logExceptionStackTrace = true;\n+\n     /**\n      * Constructs this exception handler - registers itself as the default exception handler.\n      */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "18d54b5c8fdf9c1363e80ed293076e7301f197c2",
            "date": "2025-01-14T09:47:45Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "79cfe3b6fa8e5efa614665439929f441df4c23c9",
            "date": "2024-12-04T11:32:49Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "d4b980a6f78234df24ecd47381f9a23006c6d843",
            "date": "2024-11-22T15:25:33Z",
            "author_login": "bmack"
          },
          {
            "sha": "ae53daa257bd2482f5441f6cd7606ec4108afb62",
            "date": "2025-01-14T08:47:02Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "435aa5676d2da4fc9ef353e8ab2f7eba9391a53a",
            "date": "2025-01-14T08:31:17Z",
            "author_login": "benjaminkott"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-532",
    "description": "TYPO3 is an open source web content management system. Prior to versions 7.6.57 ELTS, 8.7.47 ELTS, 9.5.34 ELTS, 10.4.29, and 11.5.11, system internal credentials or keys (e.g. database credentials) can be logged as plaintext in exception handlers, when logging the complete exception stack trace. TYPO3 versions 7.6.57 ELTS, 8.7.47 ELTS, 9.5.34 ELTS, 10.4.29, 11.5.11 contain a fix for the problem.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-06-14T21:15:16.050",
    "last_modified": "2024-11-21T07:03:46.937",
    "fix_date": "2022-06-14T07:17:21Z"
  },
  "references": [
    {
      "url": "https://github.com/TYPO3/typo3/commit/c93ea692e7dfef03b7c50fe5437487545bee4d6a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-fh99-4pgr-8j99",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-002",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/commit/c93ea692e7dfef03b7c50fe5437487545bee4d6a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-fh99-4pgr-8j99",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-002",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.443415",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "typo3",
    "owner": "TYPO3",
    "created_at": "2011-03-02T10:02:23Z",
    "updated_at": "2025-01-14T11:43:28Z",
    "pushed_at": "2025-01-14T12:27:55Z",
    "size": 598075,
    "stars": 1068,
    "forks": 674,
    "open_issues": 5,
    "watchers": 1068,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 34380148,
      "TypeScript": 2495477,
      "HTML": 1939183,
      "CSS": 573865,
      "SCSS": 460567,
      "JavaScript": 414810,
      "Shell": 94213,
      "XSLT": 6781,
      "Batchfile": 412
    },
    "commit_activity": {
      "total_commits_last_year": 2075,
      "avg_commits_per_week": 39.90384615384615,
      "days_active_last_year": 334
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:14:13.729873"
  }
}