{
  "cve_id": "CVE-2022-31135",
  "github_data": {
    "repository": "AttorneyOnline/akashi",
    "fix_commit": "5566cdfedddef1f219aee33477d9c9690bf2f78b",
    "related_commits": [
      "5566cdfedddef1f219aee33477d9c9690bf2f78b",
      "5566cdfedddef1f219aee33477d9c9690bf2f78b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5566cdfedddef1f219aee33477d9c9690bf2f78b",
      "commit_date": "2021-07-28T03:57:29Z",
      "author": {
        "login": "oldmud0",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix out of bounds crash on evidence",
        "length": 35,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "core/src/packets.cpp",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -378,7 +378,7 @@ void AOClient::pktRemoveEvidence(AreaData* area, int argc, QStringList argv, AOP\n         return;\n     bool is_int = false;\n     int idx = argv[0].toInt(&is_int);\n-    if (is_int && idx <= area->evidence().size() && idx >= 0) {\n+    if (is_int && idx < area->evidence().size() && idx >= 0) {\n         area->deleteEvidence(idx);\n     }\n     sendEvidenceList(area);\n@@ -391,7 +391,7 @@ void AOClient::pktEditEvidence(AreaData* area, int argc, QStringList argv, AOPac\n     bool is_int = false;\n     int idx = argv[0].toInt(&is_int);\n     AreaData::Evidence evi = {argv[1], argv[2], argv[3]};\n-    if (is_int && idx <= area->evidence().size() && idx >= 0) {\n+    if (is_int && idx < area->evidence().size() && idx >= 0) {\n         area->replaceEvidence(idx, evi);\n     }\n     sendEvidenceList(area);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3ddd53e121a89ea8f374084a16a33d577839f91e",
            "date": "2025-01-02T19:20:11Z",
            "author_login": "in1tiate"
          },
          {
            "sha": "ecc981ae534882d2a3244c9925dd36aad1cc0f43",
            "date": "2024-12-22T14:52:19Z",
            "author_login": "in1tiate"
          },
          {
            "sha": "2f1436a4fa6f80023f1f5c61742726c69cdfb6d2",
            "date": "2024-09-15T19:10:30Z",
            "author_login": "stonedDiscord"
          },
          {
            "sha": "68325e067a46b2008d54b6f06e7d1c1f0a961f43",
            "date": "2024-09-14T02:51:04Z",
            "author_login": "ScottBrenner"
          },
          {
            "sha": "ad028be80fa8808402a290907c2b38fdb367bbbf",
            "date": "2024-09-13T13:22:03Z",
            "author_login": "stonedDiscord"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-129",
    "description": "Akashi is an open source server implementation of the Attorney Online video game based on the Ace Attorney universe. Affected versions of Akashi are subject to a denial of service attack. An attacker can use a specially crafted evidence packet to make an illegal modification, causing a server crash. This can be used to mount a denial-of-service exploit. Users are advised to upgrade. There is no known workaround for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-07-07T18:15:09.637",
    "last_modified": "2024-11-21T07:03:58.283",
    "fix_date": "2021-07-28T03:57:29Z"
  },
  "references": [
    {
      "url": "https://github.com/AttorneyOnline/akashi/commit/5566cdfedddef1f219aee33477d9c9690bf2f78b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/AttorneyOnline/akashi/security/advisories/GHSA-vj86-vfmg-q68v",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/AttorneyOnline/akashi/commit/5566cdfedddef1f219aee33477d9c9690bf2f78b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/AttorneyOnline/akashi/security/advisories/GHSA-vj86-vfmg-q68v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:11.462960",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "akashi",
    "owner": "AttorneyOnline",
    "created_at": "2020-08-22T07:19:20Z",
    "updated_at": "2025-01-02T19:20:16Z",
    "pushed_at": "2025-01-23T09:15:45Z",
    "size": 4012,
    "stars": 4,
    "forks": 22,
    "open_issues": 32,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 574078,
      "QMake": 5736,
      "PowerShell": 4214,
      "C": 121
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T07:44:33.853002"
  }
}