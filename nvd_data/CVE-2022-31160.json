{
  "cve_id": "CVE-2022-31160",
  "github_data": {
    "repository": "jquery/jquery-ui",
    "fix_commit": "8cc5bae1caa1fcf96bf5862c5646c787020ba3f9",
    "related_commits": [
      "8cc5bae1caa1fcf96bf5862c5646c787020ba3f9",
      "8cc5bae1caa1fcf96bf5862c5646c787020ba3f9"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8cc5bae1caa1fcf96bf5862c5646c787020ba3f9",
      "commit_date": "2022-07-14T18:52:02Z",
      "author": {
        "login": "mgol",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Checkboxradio: Don't re-evaluate text labels as HTML",
        "length": 553,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 108,
        "additions": 100,
        "deletions": 8
      },
      "files": [
        {
          "filename": "tests/unit/checkboxradio/checkboxradio.html",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -64,6 +64,18 @@\n <label>\n \t<input type=\"checkbox\" id=\"label-with-no-for\"/>\n </label>\n+<label>\n+\t<input type=\"checkbox\" id=\"label-with-no-for-with-html\"/>\n+\t<strong>Hi</strong>, <em>I'm a label</em>\n+</label>\n+<label>\n+\t<input type=\"checkbox\" id=\"label-with-no-for-with-text\"/>\n+\tHi, I'm a label\n+</label>\n+<label>\n+\t<input type=\"checkbox\" id=\"label-with-no-for-with-html-like-text\"/>\n+\t&lt;em&gt;Hi, I'm a label&lt;/em&gt;\n+</label>\n \n <form id=\"form3\"></form>\n <input type=\"radio\" name=\"crazy-form\" id=\"crazy-form-1\" form=\"form3\" checked=\"checked\">"
        },
        {
          "filename": "tests/unit/checkboxradio/core.js",
          "status": "modified",
          "additions": 37,
          "deletions": 0,
          "patch": "@@ -131,4 +131,41 @@ QUnit.test( \"Calling checkboxradio on an input with no label throws an error\", f\n \t);\n } );\n \n+QUnit.test( \"Inheriting label from initial HTML\", function( assert ) {\n+\tvar tests = [\n+\t\t{\n+\t\t\tid: \"label-with-no-for-with-html\",\n+\t\t\texpectedLabel: \"<strong>Hi</strong>, <em>I'm a label</em>\"\n+\t\t},\n+\t\t{\n+\t\t\tid: \"label-with-no-for-with-text\",\n+\t\t\texpectedLabel: \"Hi, I'm a label\"\n+\t\t},\n+\t\t{\n+\t\t\tid: \"label-with-no-for-with-html-like-text\",\n+\t\t\texpectedLabel: \"&lt;em&gt;Hi, I'm a label&lt;/em&gt;\"\n+\t\t}\n+\t];\n+\n+\tassert.expect( tests.length );\n+\n+\ttests.forEach( function( testData ) {\n+\t\tvar id = testData.id;\n+\t\tvar expectedLabel = testData.expectedLabel;\n+\t\tvar inputElem = $( \"#\" + id );\n+\t\tvar labelElem = inputElem.parent();\n+\n+\t\tinputElem.checkboxradio( { icon: false } );\n+\n+\t\tvar labelWithoutInput = labelElem.clone();\n+\t\tlabelWithoutInput.find( \"input\" ).remove();\n+\n+\t\tassert.strictEqual(\n+\t\t\tlabelWithoutInput.html().trim(),\n+\t\t\texpectedLabel.trim(),\n+\t\t\t\"Label correct [\" + id + \"]\"\n+\t\t);\n+\t} );\n+} );\n+\n } );"
        },
        {
          "filename": "tests/unit/checkboxradio/methods.js",
          "status": "modified",
          "additions": 38,
          "deletions": 0,
          "patch": "@@ -96,4 +96,42 @@ QUnit.test( \"Input wrapped in a label preserved on refresh\", function( assert )\n \tassert.strictEqual( input.parent()[ 0 ], element[ 0 ], \"Input preserved\" );\n } );\n \n+QUnit.test( \"Initial text label not turned to HTML on refresh\", function( assert ) {\n+\tvar tests = [\n+\t\t{\n+\t\t\tid: \"label-with-no-for-with-html\",\n+\t\t\texpectedLabel: \"<strong>Hi</strong>, <em>I'm a label</em>\"\n+\t\t},\n+\t\t{\n+\t\t\tid: \"label-with-no-for-with-text\",\n+\t\t\texpectedLabel: \"Hi, I'm a label\"\n+\t\t},\n+\t\t{\n+\t\t\tid: \"label-with-no-for-with-html-like-text\",\n+\t\t\texpectedLabel: \"&lt;em&gt;Hi, I'm a label&lt;/em&gt;\"\n+\t\t}\n+\t];\n+\n+\tassert.expect( tests.length );\n+\n+\ttests.forEach( function( testData ) {\n+\t\tvar id = testData.id;\n+\t\tvar expectedLabel = testData.expectedLabel;\n+\t\tvar inputElem = $( \"#\" + id );\n+\t\tvar labelElem = inputElem.parent();\n+\n+\t\tinputElem.checkboxradio( { icon: false } );\n+\t\tinputElem.checkboxradio( \"refresh\" );\n+\n+\t\tvar labelWithoutInput = labelElem.clone();\n+\t\tlabelWithoutInput.find( \"input\" ).remove();\n+\n+\t\tassert.strictEqual(\n+\t\t\tlabelWithoutInput.html().trim(),\n+\t\t\texpectedLabel.trim(),\n+\t\t\t\"Label correct [\" + id + \"]\"\n+\t\t);\n+\t} );\n+} );\n+\n } );"
        },
        {
          "filename": "ui/widgets/checkboxradio.js",
          "status": "modified",
          "additions": 13,
          "deletions": 8,
          "patch": "@@ -50,8 +50,7 @@ $.widget( \"ui.checkboxradio\", [ $.ui.formResetMixin, {\n \t},\n \n \t_getCreateOptions: function() {\n-\t\tvar disabled, labels;\n-\t\tvar that = this;\n+\t\tvar disabled, labels, labelContents;\n \t\tvar options = this._super() || {};\n \n \t\t// We read the type here, because it makes more sense to throw a element type error first,\n@@ -71,12 +70,18 @@ $.widget( \"ui.checkboxradio\", [ $.ui.formResetMixin, {\n \n \t\t// We need to get the label text but this may also need to make sure it does not contain the\n \t\t// input itself.\n-\t\tthis.label.contents().not( this.element[ 0 ] ).each( function() {\n-\n-\t\t\t// The label contents could be text, html, or a mix. We concat each element to get a\n-\t\t\t// string representation of the label, without the input as part of it.\n-\t\t\tthat.originalLabel += this.nodeType === 3 ? $( this ).text() : this.outerHTML;\n-\t\t} );\n+\t\t// The label contents could be text, html, or a mix. We wrap all elements\n+\t\t// and read the wrapper's `innerHTML` to get a string representation of\n+\t\t// the label, without the input as part of it.\n+\t\tlabelContents = this.label.contents().not( this.element[ 0 ] );\n+\n+\t\tif ( labelContents.length ) {\n+\t\t\tthis.originalLabel += labelContents\n+\t\t\t\t.clone()\n+\t\t\t\t.wrapAll( \"<div></div>\" )\n+\t\t\t\t.parent()\n+\t\t\t\t.html();\n+\t\t}\n \n \t\t// Set the label option if we found label text\n \t\tif ( this.originalLabel ) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6857536606d5d0dd1b07ada519f845cdac5c96e",
            "date": "2025-01-14T10:15:49Z",
            "author_login": "timmywil"
          },
          {
            "sha": "44b0b0af50999a86c30fb9a48214bf5a333527af",
            "date": "2025-01-10T13:56:20Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "0be13b57cad253dbb5dc7fd3860239b4474d4b26",
            "date": "2024-12-18T15:14:42Z",
            "author_login": "timmywil"
          },
          {
            "sha": "7fb4cf1168f950dbdaf86ef0bb8cd0bfc654bbce",
            "date": "2024-12-06T14:53:50Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "f76bbcd512290621227babf1f72fc295ffdf2983",
            "date": "2024-11-03T12:28:54Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "jQuery UI is a curated set of user interface interactions, effects, widgets, and themes built on top of jQuery. Versions prior to 1.13.2 are potentially vulnerable to cross-site scripting. Initializing a checkboxradio widget on an input enclosed within a label makes that parent label contents considered as the input label. Calling `.checkboxradio( \"refresh\" )` on such a widget and the initial HTML contained encoded HTML entities will make them erroneously get decoded. This can lead to potentially executing JavaScript code. The bug has been patched in jQuery UI 1.13.2. To remediate the issue, someone who can change the initial HTML can wrap all the non-input contents of the `label` in a `span`.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-07-20T20:15:08.053",
    "last_modified": "2024-11-21T07:04:01.617",
    "fix_date": "2022-07-14T18:52:02Z"
  },
  "references": [
    {
      "url": "https://blog.jqueryui.com/2022/07/jquery-ui-1-13-2-released/",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jquery/jquery-ui/commit/8cc5bae1caa1fcf96bf5862c5646c787020ba3f9",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jquery/jquery-ui/security/advisories/GHSA-h6gj-6jjq-h8g9",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/12/msg00015.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6XBR3G3JR5ZIOJDO4224M3INXDS2VFDD/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J5LGNTICB5BRFAG3DHVVELS6H3CZSQMO/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QB2FJQXCNHO32VGVOC6DY6IPGVE4VDU6/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220909-0007/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.drupal.org/sa-contrib-2022-052",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blog.jqueryui.com/2022/07/jquery-ui-1-13-2-released/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jquery/jquery-ui/commit/8cc5bae1caa1fcf96bf5862c5646c787020ba3f9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jquery/jquery-ui/security/advisories/GHSA-h6gj-6jjq-h8g9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2022/12/msg00015.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6XBR3G3JR5ZIOJDO4224M3INXDS2VFDD/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/J5LGNTICB5BRFAG3DHVVELS6H3CZSQMO/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QB2FJQXCNHO32VGVOC6DY6IPGVE4VDU6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220909-0007/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.drupal.org/sa-contrib-2022-052",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:11.509057",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "jquery-ui",
    "owner": "jquery",
    "created_at": "2010-01-19T14:40:34Z",
    "updated_at": "2025-01-25T12:21:20Z",
    "pushed_at": "2025-01-14T10:15:50Z",
    "size": 30540,
    "stars": 11275,
    "forks": 5305,
    "open_issues": 128,
    "watchers": 11275,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1-8-stable",
      "1-9-stable",
      "1-10-stable",
      "1-11-stable",
      "1-12-stable",
      "1-13-stable",
      "main"
    ],
    "languages": {
      "JavaScript": 1468472,
      "HTML": 156807,
      "CSS": 41855
    },
    "commit_activity": {
      "total_commits_last_year": 75,
      "avg_commits_per_week": 1.4423076923076923,
      "days_active_last_year": 44
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:55:38.302149"
  }
}