{
  "cve_id": "CVE-2022-31191",
  "github_data": {
    "repository": "DSpace/DSpace",
    "fix_commit": "35030a23e48b5946f5853332c797e1c4adea7bb7",
    "related_commits": [
      "35030a23e48b5946f5853332c797e1c4adea7bb7",
      "6f75bb084ab1937d094208c55cd84340040bcbb5",
      "c89e493e517b424dea6175caba54e91d3847fc3a",
      "ebb83a75234d3de9be129464013e998dc929b68d",
      "35030a23e48b5946f5853332c797e1c4adea7bb7",
      "6f75bb084ab1937d094208c55cd84340040bcbb5",
      "c89e493e517b424dea6175caba54e91d3847fc3a",
      "ebb83a75234d3de9be129464013e998dc929b68d"
    ],
    "patch_url": "https://github.com/DSpace/DSpace/commit/35030a23e48b5946f5853332c797e1c4adea7bb7.patch",
    "fix_commit_details": {
      "sha": "35030a23e48b5946f5853332c797e1c4adea7bb7",
      "commit_date": "2020-04-08T01:19:14Z",
      "author": {
        "login": "kshepherd",
        "type": "User",
        "stats": {
          "total_commits": 311,
          "average_weekly_commits": 0.2622259696458685,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 103
        }
      },
      "commit_message": {
        "title": "[DS-4453] Fix XSS handling in JSPUI discovery autocomplete",
        "length": 58,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "dspace-jspui/src/main/webapp/search/discovery.jsp",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -147,7 +147,7 @@\n \t\t\t\t\t\t\t\t\ttmp_val = item.displayedValue;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\treturn {\n-\t\t\t\t\t\t\t\t\tlabel: item.displayedValue + \" (\" + item.count + \")\",\n+\t\t\t\t\t\t\t\t\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\n \t\t\t\t\t\t\t\t\tvalue: tmp_val\n \t\t\t\t\t\t\t\t};\n \t\t\t\t\t\t\t}))\t\t\t\n@@ -159,6 +159,11 @@\n \tfunction validateFilters() {\n \t\treturn document.getElementById(\"filterquery\").value.length > 0;\n \t}\n+\t// Generic HTML escape utility\n+\tvar escapeHtml = s => (s + '').replace(/[&<>\"']/g, m => ({\n+\t\t'&': '&amp;', '<': '&lt;', '>': '&gt;',\n+\t\t'\"': '&quot;', \"'\": '&#39;'\n+\t})[m]);\n </script>\t\t\n </c:set>\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b85380452ace549aff960629751d554ed15c4732",
            "date": "2025-01-13T20:57:54Z",
            "author_login": "tdonohue"
          },
          {
            "sha": "8ed2cdcff7bbefb14e6e48fbc2731f2c9da67e98",
            "date": "2024-10-08T11:42:07Z",
            "author_login": "floriangantner"
          },
          {
            "sha": "8e8979c4fb6e43965f6f3c4a80565243fdc91341",
            "date": "2025-01-10T19:54:26Z",
            "author_login": "tdonohue"
          },
          {
            "sha": "74c66bb869a67b26e98c2eca2f6aa4e719c77448",
            "date": "2025-01-10T17:36:22Z",
            "author_login": "tdonohue"
          },
          {
            "sha": "c0aa3439eaf516ca87caa2c3de95d4b326e75134",
            "date": "2025-01-10T17:21:27Z",
            "author_login": "tdonohue"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "DSpace open source software is a repository application which provides durable access to digital resources. dspace-jspui is a UI component for DSpace. The JSPUI spellcheck \"Did you mean\" HTML escapes the data-spell attribute in the link, but not the actual displayed text. Similarly, the JSPUI autocomplete HTML does not properly escape text passed to it. Both are vulnerable to XSS. This vulnerability only impacts the JSPUI. Users are advised to upgrade. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-08-01T21:15:13.280",
    "last_modified": "2024-11-21T07:04:05.460",
    "fix_date": "2020-04-08T01:19:14Z"
  },
  "references": [
    {
      "url": "https://github.com/DSpace/DSpace/commit/35030a23e48b5946f5853332c797e1c4adea7bb7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/6f75bb084ab1937d094208c55cd84340040bcbb5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/c89e493e517b424dea6175caba54e91d3847fc3a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/ebb83a75234d3de9be129464013e998dc929b68d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/security/advisories/GHSA-c558-5gfm-p2r8",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/35030a23e48b5946f5853332c797e1c4adea7bb7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/6f75bb084ab1937d094208c55cd84340040bcbb5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/c89e493e517b424dea6175caba54e91d3847fc3a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/commit/ebb83a75234d3de9be129464013e998dc929b68d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/DSpace/DSpace/security/advisories/GHSA-c558-5gfm-p2r8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:14.188814",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "DSpace",
    "owner": "DSpace",
    "created_at": "2012-03-16T21:44:52Z",
    "updated_at": "2025-01-13T20:58:00Z",
    "pushed_at": "2025-01-13T22:39:04Z",
    "size": 173075,
    "stars": 919,
    "forks": 1322,
    "open_issues": 754,
    "watchers": 919,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "dspace-1_4_x",
      "dspace-1_5_x",
      "dspace-1_6_x",
      "dspace-1_7_x",
      "dspace-1_8_x",
      "dspace-3_x",
      "dspace-4_x",
      "dspace-5_x",
      "dspace-6_x",
      "dspace-7_x",
      "dspace-8_x",
      "main"
    ],
    "languages": {
      "Java": 23696011,
      "XSLT": 450986,
      "HTML": 60715,
      "Rich Text Format": 47367,
      "Shell": 10219,
      "Dockerfile": 8697,
      "Perl": 8695,
      "JavaScript": 6281,
      "Batchfile": 4292,
      "FreeMarker": 2995,
      "CSS": 2772,
      "PLpgSQL": 1032,
      "TeX": 748
    },
    "commit_activity": {
      "total_commits_last_year": 1157,
      "avg_commits_per_week": 22.25,
      "days_active_last_year": 198
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T14:29:39.085028"
  }
}