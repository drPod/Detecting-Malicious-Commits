{
  "cve_id": "CVE-2022-32065",
  "github_data": {
    "repository": "yangzongzhuan/RuoYi",
    "fix_commit": "d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
    "related_commits": [
      "d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
      "d8b2a9a905fb750fa60e2400238cf4750a77c5e6"
    ],
    "patch_url": "https://github.com/yangzongzhuan/RuoYi/commit/d8b2a9a905fb750fa60e2400238cf4750a77c5e6.patch",
    "fix_commit_details": {
      "sha": "d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
      "commit_date": "2022-05-22T04:44:40Z",
      "author": {
        "login": "yangzongzhuan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "\u7528\u6237\u5934\u50cf\u4e0a\u4f20\u683c\u5f0f\u9650\u5236",
        "length": 10,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "ruoyi-admin/src/main/java/com/ruoyi/web/controller/system/SysProfileController.java",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -22,6 +22,7 @@\n import com.ruoyi.common.utils.ShiroUtils;\r\n import com.ruoyi.common.utils.StringUtils;\r\n import com.ruoyi.common.utils.file.FileUploadUtils;\r\n+import com.ruoyi.common.utils.file.MimeTypeUtils;\r\n import com.ruoyi.framework.shiro.service.SysPasswordService;\r\n import com.ruoyi.system.service.ISysUserService;\r\n \r\n@@ -168,7 +169,7 @@ public AjaxResult updateAvatar(@RequestParam(\"avatarfile\") MultipartFile file)\n         {\r\n             if (!file.isEmpty())\r\n             {\r\n-                String avatar = FileUploadUtils.upload(RuoYiConfig.getAvatarPath(), file);\r\n+                String avatar = FileUploadUtils.upload(RuoYiConfig.getAvatarPath(), file, MimeTypeUtils.IMAGE_EXTENSION);\r\n                 currentUser.setAvatar(avatar);\r\n                 if (userService.updateUserInfo(currentUser) > 0)\r\n                 {\r"
        },
        {
          "filename": "ruoyi-common/src/main/java/com/ruoyi/common/exception/file/InvalidExtensionException.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@ public class InvalidExtensionException extends FileUploadException\n \r\n     public InvalidExtensionException(String[] allowedExtension, String extension, String filename)\r\n     {\r\n-        super(\"filename : [\" + filename + \"], extension : [\" + extension + \"], allowed extension : [\" + Arrays.toString(allowedExtension) + \"]\");\r\n+        super(\"\u6587\u4ef6[\" + filename + \"]\u540e\u7f00[\" + extension + \"]\u4e0d\u6b63\u786e\uff0c\u8bf7\u4e0a\u4f20 [\" + Arrays.toString(allowedExtension) + \"]\u683c\u5f0f\u6587\u4ef6\");\r\n         this.allowedExtension = allowedExtension;\r\n         this.extension = extension;\r\n         this.filename = filename;\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a3b8727b94ab3627a7fccbd637cb06ff244f6659",
            "date": "2025-01-07T02:26:29Z",
            "author_login": "yangzongzhuan"
          },
          {
            "sha": "d98e2adb3791f998c883f613683a17039e97c8f7",
            "date": "2024-12-30T04:09:24Z",
            "author_login": "yangzongzhuan"
          },
          {
            "sha": "e9e07188956043bd19cf688f355b2e1841e04b74",
            "date": "2024-12-26T02:14:55Z",
            "author_login": "yangzongzhuan"
          },
          {
            "sha": "adf61988fe91129bb4b7c0fda322954f7d2b0bd0",
            "date": "2024-12-25T04:00:03Z",
            "author_login": "yangzongzhuan"
          },
          {
            "sha": "7c1cdcd73f1feee419744ece60ae99b5f80f448e",
            "date": "2024-12-24T15:59:56Z",
            "author_login": "yangzongzhuan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "An arbitrary file upload vulnerability in the background management module of RuoYi v4.7.3 and below allows attackers to execute arbitrary code via a crafted HTML file.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-07-13T15:15:10.707",
    "last_modified": "2024-11-21T07:05:44.110",
    "fix_date": "2022-05-22T04:44:40Z"
  },
  "references": [
    {
      "url": "https://gitee.com/y_project/RuoYi/commit/d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
      "source": "cve@mitre.org",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitee.com/y_project/RuoYi/issues/I57IME",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yangzongzhuan/RuoYi/commit/d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yangzongzhuan/RuoYi/issues/118",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitee.com/y_project/RuoYi/commit/d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gitee.com/y_project/RuoYi/issues/I57IME",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yangzongzhuan/RuoYi/commit/d8b2a9a905fb750fa60e2400238cf4750a77c5e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/yangzongzhuan/RuoYi/issues/118",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:11.485548",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "RuoYi",
    "owner": "yangzongzhuan",
    "created_at": "2019-10-17T02:51:07Z",
    "updated_at": "2025-01-14T15:03:15Z",
    "pushed_at": "2025-01-08T16:11:55Z",
    "size": 11519,
    "stars": 6646,
    "forks": 1947,
    "open_issues": 57,
    "watchers": 6646,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 1592200,
      "JavaScript": 1474986,
      "Java": 1071107,
      "CSS": 280213,
      "Batchfile": 2107,
      "Shell": 1681
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:44:12.444434"
  }
}