{
  "cve_id": "CVE-2022-32983",
  "github_data": {
    "repository": "CZ-NIC/knot-resolver",
    "fix_commit": "ccb9d9794db5eb757c33becf65cb1cf48ecfd968",
    "related_commits": [
      "ccb9d9794db5eb757c33becf65cb1cf48ecfd968",
      "ccb9d9794db5eb757c33becf65cb1cf48ecfd968"
    ],
    "patch_url": "https://github.com/CZ-NIC/knot-resolver/commit/ccb9d9794db5eb757c33becf65cb1cf48ecfd968.patch",
    "fix_commit_details": {
      "sha": "ccb9d9794db5eb757c33becf65cb1cf48ecfd968",
      "commit_date": "2021-12-14T17:33:16Z",
      "author": {
        "login": "vcunat",
        "type": "User",
        "stats": {
          "total_commits": 1706,
          "average_weekly_commits": 3.0905797101449277,
          "total_additions": 58199,
          "total_deletions": 41185,
          "weeks_active": 367
        }
      },
      "commit_message": {
        "title": "policy docs: warn about filters and forwarding",
        "length": 182,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 14,
        "deletions": 0
      },
      "files": [
        {
          "filename": "modules/policy/README.rst",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -407,6 +407,20 @@ Actions :func:`policy.FORWARD`, :func:`policy.TLS_FORWARD` and :func:`policy.STU\n    `0x20 randomization <https://tools.ietf.org/html/draft-vixie-dnsext-dns0x20-00>`_.\n    See example in `Replacing part of the DNS tree`_.\n \n+.. warning::\n+   Limiting forwarding actions by filters (e.g. :func:`policy.suffix`) may have unexpected consequences.\n+   Notably, forwarders can inject *any* records into your cache\n+   even if you \"restrict\" them to an insignificant DNS subtree --\n+   except in cases where DNSSEC validation applies, of course.\n+\n+   The behavior is probably best understood through the fact\n+   that filters and actions are completely decoupled.\n+   The forwarding actions have no clue about why they were executed,\n+   e.g. that the user wanted to restrict the forwarder only to some subtree.\n+   The action just selects some set of forwarders to process this whole request from the client,\n+   and during that processing it might need some other \"sub-queries\" (e.g. for validation).\n+   Some of those might not've passed the intended filter,\n+   but policy rule-set only applies once per client's request.\n \n .. _tls-forwarding:\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d6ed057ee2820d019a680cd38ecafc9474857856",
            "date": "2025-01-14T09:30:57Z",
            "author_login": "alesmrazek"
          },
          {
            "sha": "11951b134eecbae260672d81dbdc74a13a152d0b",
            "date": "2025-01-13T21:45:16Z",
            "author_login": "alesmrazek"
          },
          {
            "sha": "9824b224bf678e3f1d22dde051ff2facc035819b",
            "date": "2025-01-13T13:46:20Z",
            "author_login": "alesmrazek"
          },
          {
            "sha": "229303225f6aee6bbafed4b7787a5a35ebfa41c4",
            "date": "2025-01-09T12:58:44Z",
            "author_login": "alesmrazek"
          },
          {
            "sha": "75a22b097c55646724651038d219b716f7e3d838",
            "date": "2025-01-06T15:24:31Z",
            "author_login": "alesmrazek"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-290",
    "description": "Knot Resolver through 5.5.1 may allow DNS cache poisoning when there is an attempt to limit forwarding actions by filters.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-06-20T16:15:07.990",
    "last_modified": "2024-11-21T07:07:21.230",
    "fix_date": "2021-12-14T17:33:16Z"
  },
  "references": [
    {
      "url": "https://github.com/CZ-NIC/knot-resolver/commit/ccb9d9794db5eb757c33becf65cb1cf48ecfd968",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://knot-resolver.readthedocs.io/en/stable/modules-policy.html#forwarding",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/CZ-NIC/knot-resolver/commit/ccb9d9794db5eb757c33becf65cb1cf48ecfd968",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://knot-resolver.readthedocs.io/en/stable/modules-policy.html#forwarding",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:09.463447",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "knot-resolver",
    "owner": "CZ-NIC",
    "created_at": "2015-03-31T12:01:38Z",
    "updated_at": "2025-01-14T09:31:11Z",
    "pushed_at": "2025-01-14T11:07:34Z",
    "size": 34551,
    "stars": 368,
    "forks": 59,
    "open_issues": 18,
    "watchers": 368,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1522836,
      "Python": 471106,
      "Lua": 364453,
      "Jinja": 71012,
      "Shell": 55625,
      "Meson": 48638,
      "JavaScript": 19414,
      "CSS": 11666,
      "Go": 5207,
      "Nix": 4609,
      "Smarty": 2782,
      "Dockerfile": 2619,
      "Roff": 2567,
      "Makefile": 1331,
      "Emacs Lisp": 262
    },
    "commit_activity": {
      "total_commits_last_year": 578,
      "avg_commits_per_week": 11.115384615384615,
      "days_active_last_year": 191
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:54:59.805782"
  }
}