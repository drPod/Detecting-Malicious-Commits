{
  "cve_id": "CVE-2022-3348",
  "github_data": {
    "repository": "tooljet/tooljet",
    "fix_commit": "37bf6de75f161e03c2a81888810488b913863a46",
    "related_commits": [
      "37bf6de75f161e03c2a81888810488b913863a46",
      "37bf6de75f161e03c2a81888810488b913863a46"
    ],
    "patch_url": "https://github.com/tooljet/tooljet/commit/37bf6de75f161e03c2a81888810488b913863a46.patch",
    "fix_commit_details": {
      "sha": "37bf6de75f161e03c2a81888810488b913863a46",
      "commit_date": "2022-09-12T07:36:22Z",
      "author": {
        "login": "gondar00",
        "type": "User",
        "stats": {
          "total_commits": 201,
          "average_weekly_commits": 1.0100502512562815,
          "total_additions": 232311,
          "total_deletions": 150173,
          "weeks_active": 60
        }
      },
      "commit_message": {
        "title": "fix: hide user data from thread module",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 12,
        "deletions": 5
      },
      "files": [
        {
          "filename": "server/src/entities/thread.entity.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -29,7 +29,7 @@ export class Thread extends BaseEntity {\n   @Column({ default: false, name: 'is_resolved' })\n   isResolved: boolean;\n \n-  @ManyToOne(() => User, (user) => user.id, { eager: true })\n+  @ManyToOne(() => User, (user) => user.id)\n   @JoinColumn({ name: 'user_id' })\n   user: User;\n "
        },
        {
          "filename": "server/src/services/thread.service.ts",
          "status": "modified",
          "additions": 11,
          "deletions": 4,
          "patch": "@@ -4,6 +4,7 @@ import { Thread } from '../entities/thread.entity';\n import { Comment } from '../entities/comment.entity';\n import { CreateThreadDto, UpdateThreadDto } from '../dto/thread.dto';\n import { ThreadRepository } from '../repositories/thread.repository';\n+import { createQueryBuilder } from 'typeorm';\n \n @Injectable()\n export class ThreadService {\n@@ -17,13 +18,19 @@ export class ThreadService {\n   }\n \n   public async getThreads(appId: string, organizationId: string, appVersionsId: string): Promise<Thread[]> {\n-    return await this.threadRepository.find({\n-      where: {\n+    return await createQueryBuilder(Thread, 'thread')\n+      .innerJoin('thread.user', 'user')\n+      .addSelect(['user.id', 'user.firstName', 'user.lastName'])\n+      .andWhere('thread.appId = :appId', {\n         appId,\n+      })\n+      .andWhere('thread.organizationId = :organizationId', {\n         organizationId,\n+      })\n+      .andWhere('thread.appVersionsId = :appVersionsId', {\n         appVersionsId,\n-      },\n-    });\n+      })\n+      .getMany();\n   }\n \n   public async getOrganizationThreads(orgId: string): Promise<Thread[]> {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7e8573d12f791daa11130bbb28240faa50ed37f6",
            "date": "2025-01-10T06:58:10Z",
            "author_login": "johnsoncherian"
          },
          {
            "sha": "e8a9aaf07b45b8cc1a4c89c9ef1e1d9c12669189",
            "date": "2025-01-09T07:17:42Z",
            "author_login": "amanregu"
          },
          {
            "sha": "d7ae19b24f6926c1ee44185ff8e9bc52ff9ad678",
            "date": "2025-01-08T14:12:25Z",
            "author_login": "RudraPratik30"
          },
          {
            "sha": "222c25f93c557d417e2ea4c137402fdd79088cd5",
            "date": "2025-01-08T07:10:00Z",
            "author_login": "PriteshKiri"
          },
          {
            "sha": "d6c8b9c6ec63702382503cd64079b6f13d28df1d",
            "date": "2025-01-06T14:23:34Z",
            "author_login": "slancerk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "Just like in the previous report, an attacker could steal the account of different users. But in this case, it's a little bit more specific, because it is needed to be an editor in the same app as the victim.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-28T09:15:09.973",
    "last_modified": "2024-11-21T07:19:20.747",
    "fix_date": "2022-09-12T07:36:22Z"
  },
  "references": [
    {
      "url": "https://github.com/tooljet/tooljet/commit/37bf6de75f161e03c2a81888810488b913863a46",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/aae4aeb8-2612-4254-85e5-90675b082eac",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tooljet/tooljet/commit/37bf6de75f161e03c2a81888810488b913863a46",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/aae4aeb8-2612-4254-85e5-90675b082eac",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:41.294003",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ToolJet",
    "owner": "tooljet",
    "created_at": "2021-03-30T08:51:34Z",
    "updated_at": "2025-01-14T11:02:48Z",
    "pushed_at": "2025-01-13T13:44:06Z",
    "size": 1415933,
    "stars": 33669,
    "forks": 4363,
    "open_issues": 1082,
    "watchers": 33669,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "JavaScript": 5181340,
      "TypeScript": 1928640,
      "SCSS": 835109,
      "HTML": 31625,
      "Shell": 25589,
      "EJS": 17681,
      "Dockerfile": 15959,
      "Handlebars": 11680,
      "MDX": 11289,
      "CSS": 3790,
      "HCL": 1872,
      "Procfile": 62,
      "Batchfile": 61
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:26:36.929498"
  }
}