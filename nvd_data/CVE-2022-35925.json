{
  "cve_id": "CVE-2022-35925",
  "github_data": {
    "repository": "bookwyrm-social/bookwyrm",
    "fix_commit": "7bbe42fb30a79a26115524d18b697d895563c92f",
    "related_commits": [
      "7bbe42fb30a79a26115524d18b697d895563c92f",
      "7bbe42fb30a79a26115524d18b697d895563c92f"
    ],
    "patch_url": "https://github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f.patch",
    "fix_commit_details": {
      "sha": "7bbe42fb30a79a26115524d18b697d895563c92f",
      "commit_date": "2022-07-28T18:26:19Z",
      "author": {
        "login": "mouse-reeve",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #2230 from bookwyrm-social/nginx-rate-limit",
        "length": 105,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
      },
      "files": [
        {
          "filename": "nginx/development",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -7,6 +7,15 @@ upstream web {\n server {\n     listen 80;\n \n+    location ~ ^/(login|password-reset|resend-link) {\n+        limit_req zone=loginlimit;\n+\n+        proxy_pass http://web;\n+        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n+        proxy_set_header Host $host;\n+        proxy_redirect off;\n+    }\n+\n     location / {\n         proxy_pass http://web;\n         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"
        },
        {
          "filename": "nginx/production",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -41,6 +41,15 @@ server {\n #         root /var/www/certbot;\n #     }\n #\n+#     location ~ ^/(login|password-reset|resend-link) {\n+#         limit_req zone=loginlimit;\n+#\n+#         proxy_pass http://web;\n+#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n+#         proxy_set_header Host $host;\n+#         proxy_redirect off;\n+#     }\n+#\n #     location / {\n #         proxy_pass http://web;\n #         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;"
        },
        {
          "filename": "nginx/server_config",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1 +1,2 @@\n client_max_body_size 10m;\n+limit_req_zone $binary_remote_addr zone=loginlimit:10m rate=1r/s;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "03bab92ee6fe00ba27396a40bcf294c2ad219f7a",
            "date": "2025-01-11T02:21:17Z",
            "author_login": "mouse-reeve"
          },
          {
            "sha": "d9d614b3bce07267fe46b5314b5528b5179ddcac",
            "date": "2025-01-11T02:11:57Z",
            "author_login": "mouse-reeve"
          },
          {
            "sha": "609b7f58c832bc19550630449b2044221399e321",
            "date": "2025-01-11T02:01:48Z",
            "author_login": "mouse-reeve"
          },
          {
            "sha": "3916666897059f3e56b79742e8cab81d8b00515e",
            "date": "2024-12-07T00:15:01Z",
            "author_login": "mouse-reeve"
          },
          {
            "sha": "305ef9195b3e2e187f7de5394a1d302df314849e",
            "date": "2024-12-06T18:58:00Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-287",
    "description": "BookWyrm is a social network for tracking reading. Versions prior to 0.4.5 were found to lack rate limiting on authentication views which allows brute-force attacks. This issue has been patched in version 0.4.5. Admins with existing instances will need to update their `nginx.conf` file that was created when the instance was set up. Users are advised advised to upgrade. Users unable to upgrade may update their nginx.conf files with the changes manually.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-08-02T21:15:08.177",
    "last_modified": "2024-11-21T07:11:58.560",
    "fix_date": "2022-07-28T18:26:19Z"
  },
  "references": [
    {
      "url": "https://github.com/bookwyrm-social/bookwyrm/security/advisories/GHSA-jvp3-mqv8-5rjw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/ebee593d-3fd0-4985-bf5e-7e7927e08bf6/",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bookwyrm-social/bookwyrm/security/advisories/GHSA-jvp3-mqv8-5rjw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/ebee593d-3fd0-4985-bf5e-7e7927e08bf6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:14.192775",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bookwyrm",
    "owner": "bookwyrm-social",
    "created_at": "2020-01-27T03:51:54Z",
    "updated_at": "2025-01-14T15:02:17Z",
    "pushed_at": "2025-01-12T15:11:47Z",
    "size": 76297,
    "stars": 2324,
    "forks": 267,
    "open_issues": 457,
    "watchers": 2324,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 2427684,
      "HTML": 736375,
      "JavaScript": 53491,
      "SCSS": 37863,
      "Shell": 19201,
      "Dockerfile": 803,
      "CSS": 155
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:36:04.763876"
  }
}