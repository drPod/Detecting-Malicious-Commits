{
  "cve_id": "CVE-2022-35945",
  "github_data": {
    "repository": "glpi-project/glpi",
    "fix_commit": "2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a",
    "related_commits": [
      "2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a",
      "2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a"
    ],
    "patch_url": "https://github.com/glpi-project/glpi/commit/2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a.patch",
    "fix_commit_details": {
      "sha": "2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a",
      "commit_date": "2022-07-07T10:19:46Z",
      "author": {
        "login": "cedric-anne",
        "type": "User",
        "stats": {
          "total_commits": 2969,
          "average_weekly_commits": 2.716376944190302,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 324
        }
      },
      "commit_message": {
        "title": "Escape GLPI-Network registration information",
        "length": 44,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/GLPINetwork.php",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -33,6 +33,7 @@\n  * ---------------------------------------------------------------------\n  */\n \n+use Glpi\\Toolbox\\Sanitizer;\n use Glpi\\Toolbox\\VersionParser;\n \n class GLPINetwork extends CommonGLPI\n@@ -105,20 +106,20 @@ public static function showForConfig()\n                 echo \"<td>\";\n                 echo \"<div class=' \" . (($informations['is_valid'] && $informations['subscription']['is_running'] ?? false) ? 'ok' : 'red') . \"'> \";\n                 echo \"<i class='fa fa-info-circle'></i>\";\n-                echo $informations['validation_message'];\n+                echo Sanitizer::encodeHtmlSpecialChars($informations['validation_message']);\n                 echo \"</div>\";\n                 echo \"</td>\";\n                 echo \"</tr>\";\n             }\n \n             echo \"<tr class='tab_bg_2'>\";\n             echo \"<td>\" . __('Subscription') . \"</td>\";\n-            echo \"<td>\" . ($informations['subscription'] !== null ? $informations['subscription']['title'] : __('Unknown')) . \"</td>\";\n+            echo \"<td>\" . ($informations['subscription'] !== null ? Sanitizer::encodeHtmlSpecialChars($informations['subscription']['title']) : __('Unknown')) . \"</td>\";\n             echo \"</tr>\";\n \n             echo \"<tr class='tab_bg_2'>\";\n             echo \"<td>\" . __('Registered by') . \"</td>\";\n-            echo \"<td>\" . ($informations['owner'] !== null ? $informations['owner']['name'] : __('Unknown')) . \"</td>\";\n+            echo \"<td>\" . ($informations['owner'] !== null ? Sanitizer::encodeHtmlSpecialChars($informations['owner']['name']) : __('Unknown')) . \"</td>\";\n             echo \"</tr>\";\n         }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec0e2a11b56e8ef9d1d28f503a363e4ba64fd4ab",
            "date": "2025-01-14T16:55:01Z",
            "author_login": "ccailly"
          },
          {
            "sha": "50989595d9386f3eed353125d7a693ef1241b517",
            "date": "2025-01-14T15:16:58Z",
            "author_login": "cconard96"
          },
          {
            "sha": "515f37f98fdfc8fdc1eb2f090252b2f3af1fdfa4",
            "date": "2025-01-14T14:43:36Z",
            "author_login": "ccailly"
          },
          {
            "sha": "9869867f24c899d79e4675ad93131bbb2cba53a2",
            "date": "2025-01-14T14:39:56Z",
            "author_login": "ccailly"
          },
          {
            "sha": "4b9fbaea0bb355b49990ee51c690fed5e7302443",
            "date": "2025-01-14T13:22:29Z",
            "author_login": "SebSept"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "GLPI stands for Gestionnaire Libre de Parc Informatique and is a Free Asset and IT Management Software package, that provides ITIL Service Desk features, licenses tracking and software auditing. Information associated to registration key are not properly escaped in registration key configuration page. They can be used to steal a GLPI administrator cookie. Users are advised to upgrade to 10.0.3. There are no known workarounds for this issue. ### Workarounds Do not use a registration key created by an untrusted person.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-14T18:15:10.503",
    "last_modified": "2024-11-21T07:12:01.397",
    "fix_date": "2022-07-07T10:19:46Z"
  },
  "references": [
    {
      "url": "https://github.com/glpi-project/glpi/commit/2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/glpi-project/glpi/security/advisories/GHSA-jrgw-cx24-56x5",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/glpi-project/glpi/commit/2b8f9aa54ae4a4ec07bde0c8db739a292b8ec09a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/glpi-project/glpi/security/advisories/GHSA-jrgw-cx24-56x5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.114096",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "glpi",
    "owner": "glpi-project",
    "created_at": "2015-07-16T07:20:21Z",
    "updated_at": "2025-01-14T12:00:43Z",
    "pushed_at": "2025-01-14T12:00:37Z",
    "size": 864638,
    "stars": 4447,
    "forks": 1324,
    "open_issues": 223,
    "watchers": 4447,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.70/bugfixes",
      "0.71/bugfixes",
      "0.72/bugfixes",
      "0.78/bugfixes",
      "0.80/bugfixes",
      "0.83/bugfixes",
      "0.84/bugfixes",
      "0.85/bugfixes",
      "0.90/bugfixes",
      "9.1/bugfixes",
      "9.2/bugfixes",
      "9.3/bugfixes",
      "9.4/bugfixes",
      "9.5/bugfixes",
      "10.0/bugfixes",
      "main"
    ],
    "languages": {
      "PHP": 24867216,
      "Twig": 1834187,
      "JavaScript": 1339721,
      "SCSS": 362786,
      "Vue": 188168,
      "Shell": 24779,
      "Makefile": 2692,
      "CSS": 1716,
      "Dockerfile": 638
    },
    "commit_activity": {
      "total_commits_last_year": 1737,
      "avg_commits_per_week": 33.40384615384615,
      "days_active_last_year": 259
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:16:26.208966"
  }
}