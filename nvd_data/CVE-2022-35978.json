{
  "cve_id": "CVE-2022-35978",
  "github_data": {
    "repository": "minetest/minetest",
    "fix_commit": "da71e86633d0b27cd02d7aac9fdac625d141ca13",
    "related_commits": [
      "da71e86633d0b27cd02d7aac9fdac625d141ca13",
      "da71e86633d0b27cd02d7aac9fdac625d141ca13"
    ],
    "patch_url": "https://github.com/minetest/minetest/commit/da71e86633d0b27cd02d7aac9fdac625d141ca13.patch",
    "fix_commit_details": {
      "sha": "da71e86633d0b27cd02d7aac9fdac625d141ca13",
      "commit_date": "2022-05-25T17:07:49Z",
      "author": {
        "login": "sfan5",
        "type": "User",
        "stats": {
          "total_commits": 1147,
          "average_weekly_commits": 1.5520974289580514,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 316
        }
      },
      "commit_message": {
        "title": "Protect a few more settings from being set from mods",
        "length": 166,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 17,
        "deletions": 4
      },
      "files": [
        {
          "filename": "src/script/lua_api/l_settings.cpp",
          "status": "modified",
          "additions": 17,
          "deletions": 4,
          "patch": "@@ -27,9 +27,11 @@ with this program; if not, write to the Free Software Foundation, Inc.,\n #include \"log.h\"\n \n \n-/* This protects:\n- * 'secure.*' settings from being set\n- * some mapgen settings from being set\n+/* This protects the following from being set:\n+ * 'secure.*' settings\n+ * some security-relevant settings\n+ *   (better solution pending)\n+ * some mapgen settings\n  *   (not security-criticial, just to avoid messing up user configs)\n  */\n #define CHECK_SETTING_SECURITY(L, name) \\\n@@ -41,7 +43,7 @@ with this program; if not, write to the Free Software Foundation, Inc.,\n static inline int checkSettingSecurity(lua_State* L, const std::string &name)\n {\n \tif (ScriptApiSecurity::isSecure(L) && name.compare(0, 7, \"secure.\") == 0)\n-\t\tthrow LuaError(\"Attempt to set secure setting.\");\n+\t\tthrow LuaError(\"Attempted to set secure setting.\");\n \n \tbool is_mainmenu = false;\n #ifndef SERVER\n@@ -54,6 +56,17 @@ static inline int checkSettingSecurity(lua_State* L, const std::string &name)\n \t\treturn -1;\n \t}\n \n+\tconst char *disallowed[] = {\n+\t\t\"main_menu_script\", \"shader_path\", \"texture_path\", \"screenshot_path\",\n+\t\t\"serverlist_file\", \"serverlist_url\", \"map-dir\", \"contentdb_url\",\n+\t};\n+\tif (!is_mainmenu) {\n+\t\tfor (const char *name2 : disallowed) {\n+\t\t\tif (name == name2)\n+\t\t\t\tthrow LuaError(\"Attempted to set disallowed setting.\");\n+\t\t}\n+\t}\n+\n \treturn 0;\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7053348e31b21954180211e571dbacca1aa531d5",
            "date": "2025-01-14T19:26:29Z",
            "author_login": "cosin15"
          },
          {
            "sha": "2bfcd45b35d9e64cbbe54827c4d58d3b5082299a",
            "date": "2025-01-13T08:39:20Z",
            "author_login": "Desour"
          },
          {
            "sha": "636a734d78b6c0b8392eabda350131690b800682",
            "date": "2025-01-13T08:39:06Z",
            "author_login": "sfan5"
          },
          {
            "sha": "464cc925211cb2c5c90f951137328862e0d7f377",
            "date": "2025-01-12T15:20:05Z",
            "author_login": "cx384"
          },
          {
            "sha": "5aeaf20849f62609680763480998fb3219c18341",
            "date": "2024-12-31T15:27:10Z",
            "author_login": "cx384"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:H/A:L",
    "cwe_id": "CWE-693",
    "description": "Minetest is a free open-source voxel game engine with easy modding and game creation. In **single player**, a mod can set a global setting that controls the Lua script loaded to display the main menu. The script is then loaded as soon as the game session is exited. The Lua environment the menu runs in is not sandboxed and can directly interfere with the user's system. There are currently no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-08-15T19:15:08.890",
    "last_modified": "2024-11-21T07:12:05.913",
    "fix_date": "2022-05-25T17:07:49Z"
  },
  "references": [
    {
      "url": "https://dev.minetest.net/Changelog#5.5.0_.E2.86.92_5.6.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/minetest/minetest/commit/da71e86633d0b27cd02d7aac9fdac625d141ca13",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minetest/minetest/security/advisories/GHSA-663q-pcjw-27cc",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://dev.minetest.net/Changelog#5.5.0_.E2.86.92_5.6.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/minetest/minetest/commit/da71e86633d0b27cd02d7aac9fdac625d141ca13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/minetest/minetest/security/advisories/GHSA-663q-pcjw-27cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:14.219649",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "minetest",
    "owner": "minetest",
    "created_at": "2011-08-07T13:48:36Z",
    "updated_at": "2025-01-14T16:08:31Z",
    "pushed_at": "2025-01-13T08:39:20Z",
    "size": 115875,
    "stars": 11021,
    "forks": 2054,
    "open_issues": 1274,
    "watchers": 11021,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable-0.2",
      "stable-0.3",
      "stable-0.4",
      "stable-5"
    ],
    "languages": {
      "C++": 9501309,
      "Lua": 1036472,
      "C": 608911,
      "Java": 231307,
      "CMake": 102805,
      "GLSL": 86139,
      "Objective-C++": 50556,
      "Shell": 26575,
      "Python": 14386,
      "Objective-C": 7833,
      "Dockerfile": 2642,
      "Nix": 425,
      "HTML": 371
    },
    "commit_activity": {
      "total_commits_last_year": 1004,
      "avg_commits_per_week": 19.307692307692307,
      "days_active_last_year": 271
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:30:14.368143"
  }
}