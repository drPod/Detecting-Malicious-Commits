{
  "cve_id": "CVE-2022-35980",
  "github_data": {
    "repository": "opensearch-project/security",
    "fix_commit": "7eaaafec2939d7db23a02ffca9cc68e0343de246",
    "related_commits": [
      "7eaaafec2939d7db23a02ffca9cc68e0343de246",
      "7eaaafec2939d7db23a02ffca9cc68e0343de246"
    ],
    "patch_url": "https://github.com/opensearch-project/security/commit/7eaaafec2939d7db23a02ffca9cc68e0343de246.patch",
    "fix_commit_details": {
      "sha": "7eaaafec2939d7db23a02ffca9cc68e0343de246",
      "commit_date": "2022-08-09T21:09:36Z",
      "author": {
        "login": "cwperks",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update release notes for 2.2.0.0 release (#1984)",
        "length": 98,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 14,
        "deletions": 2
      },
      "files": [
        {
          "filename": "release-notes/opensearch-security.release-notes-2.2.0.0.md",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -2,13 +2,25 @@\n \n Compatible with OpenSearch 2.2.0\n \n-### Test Fix\n+### Enhancements\n \n-* Abstract waitForInit to minimize duplication and improve test reliability ([#1935](https://github.com/opensearch-project/security/pull/1935))\n+* Adds a basic sanity test to run against a remote cluster ([#1958](https://github.com/opensearch-project/security/pull/1958))\n * Create a manually started workflow for bulk run of integration tests ([#1937](https://github.com/opensearch-project/security/pull/1937))\n \n+### Bug Fixes\n+\n+* Use Collections.synchronizedSet and Collections.synchronizedMap for roles, securityRoles and attributes in User ([#1970](https://github.com/opensearch-project/security/pull/1970))\n+\n ### Maintenance\n \n * Update to Gradle 7.5 ([#1963](https://github.com/opensearch-project/security/pull/1963))\n * Increment version to 2.2.0.0 ([#1948](https://github.com/opensearch-project/security/pull/1948))\n * Force netty-transport-native-unix-common version ([#1945](https://github.com/opensearch-project/security/pull/1945))\n+* Add release notes for 2.2.0.0 release ([#1974](https://github.com/opensearch-project/security/pull/1974))\n+* Staging for version increment automation ([#1932](https://github.com/opensearch-project/security/pull/1932))\n+* Fix breaking API change introduced in Lucene 9.3.0 ([#1988](https://github.com/opensearch-project/security/pull/1988))\n+* Update indices resolution to be clearer ([#1999](https://github.com/opensearch-project/security/pull/1999))\n+\n+### Refactoring\n+\n+* Abstract waitForInit to minimize duplication and improve test reliability ([#1935](https://github.com/opensearch-project/security/pull/1935))"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3e62dc9b181eb6f4aa948c2dc12c2f2dd05dbed9",
            "date": "2025-01-13T13:15:20Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "16c93326253cb05bac8d66f8d1a054749253f167",
            "date": "2025-01-13T12:55:06Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "4cd55e94dfd33e59f7f148dc6082a606fef51cdd",
            "date": "2025-01-13T12:53:48Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "cfd8a497be60941681e5a27cbece4c8cb17627b5",
            "date": "2025-01-10T21:00:03Z",
            "author_login": "reta"
          },
          {
            "sha": "cd1dcbde45a6c2523505360f2fa15483b170e7f5",
            "date": "2025-01-06T17:55:03Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-612",
    "description": "OpenSearch Security is a plugin for OpenSearch that offers encryption, authentication and authorization. Versions 2.0.0.0 and 2.1.0.0 of the security plugin are affected by an information disclosure vulnerability. Requests to an OpenSearch cluster configured with advanced access control features document level security (DLS), field level security (FLS), and/or field masking will not be filtered when the query's search pattern matches an aliased index. OpenSearch Dashboards creates an alias to `.kibana` by default, so filters with the index pattern of `*` to restrict access to documents or fields will not be applied. This issue allows requests to access sensitive information when customer have acted to restrict access that specific information. OpenSearch 2.2.0, which is compatible with OpenSearch Security 2.2.0.0, contains the fix for this issue. There is no recommended work around.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-08-12T18:15:13.510",
    "last_modified": "2024-11-21T07:12:06.200",
    "fix_date": "2022-08-09T21:09:36Z"
  },
  "references": [
    {
      "url": "https://github.com/opensearch-project/security/commit/7eaaafec2939d7db23a02ffca9cc68e0343de246",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/security/pull/1999",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/security/security/advisories/GHSA-f4qr-f4xx-hjxw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/security/commit/7eaaafec2939d7db23a02ffca9cc68e0343de246",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/security/pull/1999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/security/security/advisories/GHSA-f4qr-f4xx-hjxw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:14.215982",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "security",
    "owner": "opensearch-project",
    "created_at": "2019-02-01T17:39:31Z",
    "updated_at": "2025-01-13T17:43:09Z",
    "pushed_at": "2025-01-13T21:33:56Z",
    "size": 92576,
    "stars": 202,
    "forks": 284,
    "open_issues": 266,
    "watchers": 202,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.x",
      "1.0",
      "1.1",
      "1.2",
      "1.3",
      "2.x",
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "2.4",
      "2.5",
      "2.6",
      "2.7",
      "2.8",
      "2.9",
      "2.10",
      "2.11",
      "2.12",
      "2.13",
      "2.14",
      "2.15",
      "2.16",
      "2.17",
      "2.18"
    ],
    "languages": {
      "Java": 7077652,
      "Shell": 10421,
      "JavaScript": 2878,
      "Batchfile": 2189
    },
    "commit_activity": {
      "total_commits_last_year": 338,
      "avg_commits_per_week": 6.5,
      "days_active_last_year": 152
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:16:15.967280"
  }
}