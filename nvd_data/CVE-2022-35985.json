{
  "cve_id": "CVE-2022-35985",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "bd90b3efab4ec958b228cd7cfe9125be1c0cf255",
    "related_commits": [
      "bd90b3efab4ec958b228cd7cfe9125be1c0cf255",
      "bd90b3efab4ec958b228cd7cfe9125be1c0cf255"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "bd90b3efab4ec958b228cd7cfe9125be1c0cf255",
      "commit_date": "2022-07-13T16:46:48Z",
      "author": {
        "login": "sagunb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix security vulnerability with LRNGradOp",
        "length": 71,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 40,
        "additions": 39,
        "deletions": 1
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/lrn_op.cc",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -668,7 +668,8 @@ class LRNGradOp : public OpKernel {\n         in_image.dim_size(0) == batch && in_image.dim_size(1) == rows &&\n             in_image.dim_size(2) == cols && in_image.dim_size(3) == depth &&\n             out_image.dim_size(0) == batch && out_image.dim_size(1) == rows &&\n-            out_image.dim_size(2) == cols && out_image.dim_size(3) == depth,\n+            out_image.dim_size(2) == cols && out_image.dim_size(3) == depth &&\n+            out_image.dims() == 4,\n         errors::InvalidArgument(\n             \"input_grads, input_image, and out_image should have the same \"\n             \"shape\"));"
        },
        {
          "filename": "tensorflow/python/kernel_tests/nn_ops/lrn_op_test.py",
          "status": "modified",
          "additions": 37,
          "deletions": 0,
          "patch": "@@ -20,11 +20,13 @@\n \n from tensorflow.python.framework import constant_op\n from tensorflow.python.framework import dtypes\n+from tensorflow.python.framework import errors_impl\n from tensorflow.python.framework import test_util\n from tensorflow.python.ops import array_ops\n from tensorflow.python.ops import gradient_checker\n from tensorflow.python.ops import gradients_impl\n from tensorflow.python.ops import nn\n+from tensorflow.python.ops import random_ops\n import tensorflow.python.ops.nn_grad  # pylint: disable=unused-import\n from tensorflow.python.platform import test\n \n@@ -111,6 +113,41 @@ def testGradientsZeroInput(self):\n     self.assertAllClose(r, expected)\n     self.assertShapeEqual(expected, grad)\n \n+  @test_util.run_in_graph_and_eager_modes\n+  def testIncompatibleInputAndOutputImageShapes(self):\n+    depth_radius = 1\n+    bias = 1.59018219\n+    alpha = 0.117728651\n+    beta = 0.404427052\n+    input_grads = random_ops.random_uniform(\n+        shape=[4, 4, 4, 4],\n+        minval=-10000,\n+        maxval=10000,\n+        dtype=dtypes.float32,\n+        seed=-2033)\n+    input_image = random_ops.random_uniform(\n+        shape=[4, 4, 4, 4],\n+        minval=-10000,\n+        maxval=10000,\n+        dtype=dtypes.float32,\n+        seed=-2033)\n+    invalid_output_image = random_ops.random_uniform(\n+        shape=[4, 4, 4, 4, 4, 4],\n+        minval=-10000,\n+        maxval=10000,\n+        dtype=dtypes.float32,\n+        seed=-2033)\n+    with self.assertRaises((ValueError, errors_impl.InvalidArgumentError)):\n+      self.evaluate(\n+          nn.lrn_grad(\n+              input_grads=input_grads,\n+              input_image=input_image,\n+              output_image=invalid_output_image,\n+              depth_radius=depth_radius,\n+              bias=bias,\n+              alpha=alpha,\n+              beta=beta))\n+\n   def _RunAndVerifyGradients(self, dtype):\n     with self.cached_session():\n       # random shape"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5c27f5f4dc39afdefbd93c2ef266a8c7ab534a98",
            "date": "2025-01-25T18:55:10Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "05df81c283627135b7651c9c7a8fa0035bff2206",
            "date": "2025-01-25T17:06:34Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "4075a7dd74ea543557d1824e16721598e1a6af8d",
            "date": "2025-01-25T17:06:30Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "4d08d96d6a0aea39c5bd90d9728dbcf59008993c",
            "date": "2025-01-25T17:04:34Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "1b58ec4dcd6e5752598dc57d4788119f8ea12e23",
            "date": "2025-01-25T11:39:06Z",
            "author_login": "tensorflower-gardener"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. If `LRNGrad` is given an `output_image` input tensor that is not 4-D, it results in a `CHECK` fail that can be used to trigger a denial of service attack. We have patched the issue in GitHub commit bd90b3efab4ec958b228cd7cfe9125be1c0cf255. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-16T22:15:11.427",
    "last_modified": "2024-11-21T07:12:06.953",
    "fix_date": "2022-07-13T16:46:48Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/bd90b3efab4ec958b228cd7cfe9125be1c0cf255",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9942-r22v-78cp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/bd90b3efab4ec958b228cd7cfe9125be1c0cf255",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9942-r22v-78cp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.130705",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-26T06:52:14Z",
    "pushed_at": "2025-01-26T07:27:00Z",
    "size": 1126495,
    "stars": 187418,
    "forks": 74442,
    "open_issues": 6822,
    "watchers": 187418,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101327392,
      "Python": 45791326,
      "MLIR": 10764225,
      "HTML": 7662661,
      "Starlark": 7439181,
      "Go": 2171369,
      "C": 1294440,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 702245,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 38067,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15545,
      "avg_commits_per_week": 298.9423076923077,
      "days_active_last_year": 354
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:37:26.588757"
  }
}