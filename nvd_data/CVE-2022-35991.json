{
  "cve_id": "CVE-2022-35991",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "bb03fdf4aae944ab2e4b35c7daa051068a8b7f61",
    "related_commits": [
      "bb03fdf4aae944ab2e4b35c7daa051068a8b7f61",
      "bb03fdf4aae944ab2e4b35c7daa051068a8b7f61"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/bb03fdf4aae944ab2e4b35c7daa051068a8b7f61.patch",
    "fix_commit_details": {
      "sha": "bb03fdf4aae944ab2e4b35c7daa051068a8b7f61",
      "commit_date": "2022-07-21T20:40:05Z",
      "author": {
        "login": "tensorflower-gardener",
        "type": "User",
        "stats": {
          "total_commits": 51278,
          "average_weekly_commits": 106.82916666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 450
        }
      },
      "commit_message": {
        "title": "Check for element_shape in TensorListScatter and TensorListScatterV2",
        "length": 98,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 29,
        "additions": 29,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/list_kernels.h",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -895,6 +895,11 @@ class TensorListScatter : public OpKernel {\n     OP_REQUIRES_OK(c, c->allocate_output(0, {}, &output_tensor, attr));\n     Tensor indices = c->input(1);\n     PartialTensorShape element_shape;\n+    OP_REQUIRES(\n+        c, !TensorShapeUtils::IsMatrixOrHigher(c->input(2).shape()),\n+        errors::InvalidArgument(\n+            \"TensorListScatter: element_shape must be at most rank 1 but has \",\n+            \"the shape of \", c->input(2).shape().DebugString()));\n     OP_REQUIRES_OK(c, TensorShapeFromTensor(c->input(2), &element_shape));\n     // TensorListScatterV2 passes the num_elements input, TensorListScatter does\n     // not."
        },
        {
          "filename": "tensorflow/python/kernel_tests/data_structures/list_ops_test.py",
          "status": "modified",
          "additions": 24,
          "deletions": 0,
          "patch": "@@ -481,6 +481,30 @@ def testScatterOutputListSizeWithNumElementsSpecified(self):\n     # TensorListScatter should return a list with size num_elements.\n     self.assertAllEqual(list_ops.tensor_list_length(l), 5)\n \n+  def testScatterFailsWhenElementShapeIsNotVector(self):\n+    c0 = constant_op.constant([1.0, 2.0])\n+    # In Eager mode, InvalidArgumentError is generated by the Compute function.\n+    # In graph mode, ValueError is generated by the shape function.\n+    with self.assertRaisesRegex(\n+        (errors.InvalidArgumentError, ValueError),\n+        \"must be at most rank 1\"):\n+      l = gen_list_ops.tensor_list_scatter(\n+          # Wrong element_shape. Should be at most rank 1.\n+          c0, [1, 3], element_shape=[[1]])\n+      self.evaluate(l)\n+\n+  def testScatterV2FailsWhenElementShapeIsNotVector(self):\n+    c0 = constant_op.constant([1.0, 2.0])\n+    # In Eager mode, InvalidArgumentError is generated by the Compute function.\n+    # In graph mode, ValueError is generated by the shape function.\n+    with self.assertRaisesRegex(\n+        (errors.InvalidArgumentError, ValueError),\n+        \"must be at most rank 1\"):\n+      l = gen_list_ops.tensor_list_scatter_v2(\n+          # Wrong element_shape. Should be at most rank 1.\n+          c0, [1, 3], element_shape=[[1]], num_elements=2)\n+      self.evaluate(l)\n+\n   def testScatterFailsWhenIndexLargerThanNumElements(self):\n     c0 = constant_op.constant([1.0, 2.0])\n     with self.assertRaisesRegex("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd41705e0ad7a123a9d01b8be2a3b34b3266493e",
            "date": "2025-01-14T13:33:52Z",
            "author_login": "loislo"
          },
          {
            "sha": "af5275c5731565cbf2a2c01ee418a8cf62388431",
            "date": "2025-01-14T12:48:20Z",
            "author_login": "akuegel"
          },
          {
            "sha": "ee156c15e5d1cd7d2bd85885e7fd2bf7e143c2c3",
            "date": "2025-01-14T12:46:22Z",
            "author_login": "pifon2a"
          },
          {
            "sha": "bd43a8255ce9e203b740bcdc09e8f79d3a26f887",
            "date": "2025-01-14T12:33:02Z",
            "author_login": "metaflow"
          },
          {
            "sha": "8003fb40987f176d35364da2af8fcdfab339349e",
            "date": "2025-01-14T11:27:47Z",
            "author_login": "vwbaker"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. When `TensorListScatter` and `TensorListScatterV2` receive an `element_shape` of a rank greater than one, they give a `CHECK` fail that can trigger a denial of service attack. We have patched the issue in GitHub commit bb03fdf4aae944ab2e4b35c7daa051068a8b7f61. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-16T23:15:10.100",
    "last_modified": "2024-11-21T07:12:07.883",
    "fix_date": "2022-07-21T20:40:05Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/bb03fdf4aae944ab2e4b35c7daa051068a8b7f61",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-vm7x-4qhj-rrcq",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/bb03fdf4aae944ab2e4b35c7daa051068a8b7f61",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-vm7x-4qhj-rrcq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.133404",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}