{
  "cve_id": "CVE-2022-35992",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "3db59a042a38f4338aa207922fa2f476e000a6ee",
    "related_commits": [
      "3db59a042a38f4338aa207922fa2f476e000a6ee",
      "3db59a042a38f4338aa207922fa2f476e000a6ee"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/3db59a042a38f4338aa207922fa2f476e000a6ee.patch",
    "fix_commit_details": {
      "sha": "3db59a042a38f4338aa207922fa2f476e000a6ee",
      "commit_date": "2022-07-21T21:14:59Z",
      "author": {
        "login": "tensorflower-gardener",
        "type": "User",
        "stats": {
          "total_commits": 51283,
          "average_weekly_commits": 106.83958333333334,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 450
        }
      },
      "commit_message": {
        "title": "Check for element_shape in TensorListFromTensor",
        "length": 77,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 16,
        "additions": 16,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/list_kernels.h",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -769,6 +769,11 @@ class TensorListFromTensor : public OpKernel {\n     attr.set_on_host(true);\n     OP_REQUIRES_OK(c, c->allocate_output(0, {}, &output_tensor, attr));\n     PartialTensorShape element_shape;\n+    OP_REQUIRES(\n+        c, !TensorShapeUtils::IsMatrixOrHigher(c->input(1).shape()),\n+        errors::InvalidArgument(\n+            \"TensorListFromTensor: element_shape must be at most rank 1 but \",\n+            \"has the shape of \", c->input(1).shape().DebugString()));\n     OP_REQUIRES_OK(c, TensorShapeFromTensor(c->input(1), &element_shape));\n     TensorList output_list;\n     const Tensor& t = c->input(0);"
        },
        {
          "filename": "tensorflow/python/kernel_tests/data_structures/list_ops_test.py",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -584,6 +584,17 @@ def testTensorListFromTensor(self):\n     self.assertAllEqual(e, 1.0)\n     self.assertAllEqual(list_ops.tensor_list_length(l), 0)\n \n+  def testTensorListFromTensorFailsWhenElementShapeIsNotVector(self):\n+    t = constant_op.constant([1.0, 2.0])\n+    # In Eager mode, InvalidArgumentError is generated by the Compute function.\n+    # In graph mode, ValueError is generated by the shape function.\n+    with self.assertRaisesRegex(\n+        (errors.InvalidArgumentError, ValueError),\n+        \"must be at most rank 1\"):\n+      # Wrong element_shape. Should be at most rank 1.\n+      l = list_ops.tensor_list_from_tensor(t, element_shape=[[1]])\n+      self.evaluate(l)\n+\n   @test_util.run_gpu_only\n   def testFromTensorGPU(self):\n     with context.device(\"gpu:0\"):"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d93cc4f4f767f0d4a72f2fafcc59005be939c019",
            "date": "2025-01-14T20:36:32Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "d4e4516cc7d11a68a81a82227f3a432f7ab350a0",
            "date": "2025-01-14T19:59:15Z",
            "author_login": "ddunl"
          },
          {
            "sha": "65367823d999b6a36a685617100a7bb6ce03add4",
            "date": "2025-01-14T19:58:00Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "36cbae5466dbf356d91cf56127b2ab2ccd5a8b1f",
            "date": "2025-01-14T19:54:19Z",
            "author_login": "penpornk"
          },
          {
            "sha": "0a99598a8f76735ac32b5466385b0f5af08a06bb",
            "date": "2025-01-14T19:45:23Z",
            "author_login": "wangpengmit"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. When `TensorListFromTensor` receives an `element_shape` of a rank greater than one, it gives a `CHECK` fail that can trigger a denial of service attack. We have patched the issue in GitHub commit 3db59a042a38f4338aa207922fa2f476e000a6ee. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-16T23:15:10.167",
    "last_modified": "2024-11-21T07:12:08.033",
    "fix_date": "2022-07-21T21:14:59Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/3db59a042a38f4338aa207922fa2f476e000a6ee",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9v8w-xmr4-wgxp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/3db59a042a38f4338aa207922fa2f476e000a6ee",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-9v8w-xmr4-wgxp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.133561",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}