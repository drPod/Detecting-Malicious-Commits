{
  "cve_id": "CVE-2022-35999",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "27a65a43cf763897fecfa5cdb5cc653fc5dd0346",
    "related_commits": [
      "27a65a43cf763897fecfa5cdb5cc653fc5dd0346",
      "27a65a43cf763897fecfa5cdb5cc653fc5dd0346"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/27a65a43cf763897fecfa5cdb5cc653fc5dd0346.patch",
    "fix_commit_details": {
      "sha": "27a65a43cf763897fecfa5cdb5cc653fc5dd0346",
      "commit_date": "2022-07-20T20:32:38Z",
      "author": {
        "login": "cantonios",
        "type": "User",
        "stats": {
          "total_commits": 299,
          "average_weekly_commits": 0.6229166666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "Fix GPU/CPU Conv2DBackpropInputOp check error.",
        "length": 370,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 36,
        "additions": 36,
        "deletions": 0
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/conv_grad_input_ops.h",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -37,6 +37,7 @@ limitations under the License.\n #include \"tensorflow/core/kernels/conv_2d.h\"\n #include \"tensorflow/core/kernels/conv_grad_ops.h\"\n #include \"tensorflow/core/kernels/conv_grad_shape_utils.h\"\n+#include \"tensorflow/core/kernels/fill_functor.h\"\n #ifdef TENSORFLOW_USE_LIBXSMM_CONVOLUTIONS\n #include \"tensorflow/core/kernels/xsmm_conv2d.h\"\n #endif\n@@ -436,6 +437,15 @@ class Conv2DBackpropInputOp : public OpKernel {\n       return;\n     }\n \n+    // If shapes are valid but `out_backprop` is empty, in_backprop should be\n+    // set to all zeros.  Otherwise, cudnn/dnnl fail with an empty input.\n+    if (out_backprop.NumElements() == 0) {\n+      functor::SetZeroFunctor<Device, T> set_zero;\n+      set_zero(context->eigen_device<Device>(),\n+               in_backprop->template flat<T>());\n+      return;\n+    }\n+\n     // For now we take the stride from the second and third dimensions only (we\n     // do not support striding on the batch or depth dimension).\n     const int stride_rows = GetTensorDim(strides_, data_format_, 'H');\n@@ -554,6 +564,15 @@ class Conv2DCustomBackpropInputOp : public OpKernel {\n       return;\n     }\n \n+    // If shapes are valid but `out_backprop` is empty, in_backprop should be\n+    // set to all zeros.  Otherwise, cudnn/dnnl fail with an empty input.\n+    if (out_backprop.NumElements() == 0) {\n+      functor::SetZeroFunctor<Device, T> set_zero;\n+      set_zero(context->eigen_device<Device>(),\n+               in_backprop->template flat<T>());\n+      return;\n+    }\n+\n // TODO(ezhulenev): Remove custom kernel and move XSMM support to\n // LaunchConv2DBackpropInputOp functor.\n #if defined TENSORFLOW_USE_LIBXSMM_CONVOLUTIONS && \\"
        },
        {
          "filename": "tensorflow/python/kernel_tests/nn_ops/conv_ops_test.py",
          "status": "modified",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -1103,6 +1103,23 @@ def testConv2DInputSizesContainsOnlySpatialDimensionsBackpropInput(self):\n           use_gpu=use_gpu,\n           err=1e-5)\n \n+  @test_util.run_in_graph_and_eager_modes\n+  @test_util.disable_xla(\"b/239598470\")\n+  def testConv2DBackpropInputDegenerateBackpropInput(self):\n+    input_sizes = [3, 1, 1, 2]\n+    expected_output = np.zeros(input_sizes).flatten()\n+    for (data_format, use_gpu) in GetTestConfigs():\n+      self._RunAndVerifyBackpropInput(\n+          input_sizes=input_sizes,\n+          filter_sizes=[1, 3, 2, 3],\n+          output_sizes=[3, 1, 0, 3],\n+          strides=[1, 2],\n+          padding=\"VALID\",\n+          expected=expected_output,\n+          data_format=data_format,\n+          use_gpu=use_gpu,\n+          err=1e-5)\n+\n   # Testing for backprops\n   def _RunAndVerifyBackpropFilter(self,\n                                   input_sizes,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e7f7cefc7d284c486f84596811d07bb5cd0890ca",
            "date": "2025-01-14T14:16:10Z",
            "author_login": "krasimirgg"
          },
          {
            "sha": "fd41705e0ad7a123a9d01b8be2a3b34b3266493e",
            "date": "2025-01-14T13:33:52Z",
            "author_login": "loislo"
          },
          {
            "sha": "af5275c5731565cbf2a2c01ee418a8cf62388431",
            "date": "2025-01-14T12:48:20Z",
            "author_login": "akuegel"
          },
          {
            "sha": "ee156c15e5d1cd7d2bd85885e7fd2bf7e143c2c3",
            "date": "2025-01-14T12:46:22Z",
            "author_login": "pifon2a"
          },
          {
            "sha": "bd43a8255ce9e203b740bcdc09e8f79d3a26f887",
            "date": "2025-01-14T12:33:02Z",
            "author_login": "metaflow"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. When `Conv2DBackpropInput` receives empty `out_backprop` inputs (e.g. `[3, 1, 0, 1]`), the current CPU/GPU kernels `CHECK` fail (one with dnnl, the other with cudnn). This can be used to trigger a denial of service attack. We have patched the issue in GitHub commit 27a65a43cf763897fecfa5cdb5cc653fc5dd0346. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-16T23:15:10.587",
    "last_modified": "2024-11-21T07:12:09.023",
    "fix_date": "2022-07-20T20:32:38Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/27a65a43cf763897fecfa5cdb5cc653fc5dd0346",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-37jf-mjv6-xfqw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/27a65a43cf763897fecfa5cdb5cc653fc5dd0346",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-37jf-mjv6-xfqw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.134530",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}