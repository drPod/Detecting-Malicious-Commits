{
  "cve_id": "CVE-2022-36001",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "da0d65cdc1270038e72157ba35bf74b85d9bda11",
    "related_commits": [
      "da0d65cdc1270038e72157ba35bf74b85d9bda11",
      "da0d65cdc1270038e72157ba35bf74b85d9bda11"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/da0d65cdc1270038e72157ba35bf74b85d9bda11.patch",
    "fix_commit_details": {
      "sha": "da0d65cdc1270038e72157ba35bf74b85d9bda11",
      "commit_date": "2022-07-19T05:41:06Z",
      "author": {
        "login": "cantonios",
        "type": "User",
        "stats": {
          "total_commits": 299,
          "average_weekly_commits": 0.6229166666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "Fix dtype bug in draw bounding boxes.",
        "length": 107,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 16,
        "deletions": 3
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/image/draw_bounding_box_op.cc",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -119,7 +119,7 @@ class DrawBoundingBoxesOp : public OpKernel {\n \n     for (int64_t b = 0; b < batch_size; ++b) {\n       const int64_t num_boxes = boxes.dim_size(1);\n-      const auto tboxes = boxes.tensor<T, 3>();\n+      const auto tboxes = boxes.tensor<float, 3>();\n       for (int64_t bb = 0; bb < num_boxes; ++bb) {\n         int64_t color_index = bb % color_table.size();\n         const int64_t min_box_row ="
        },
        {
          "filename": "tensorflow/python/kernel_tests/image_ops/draw_bounding_box_op_test.py",
          "status": "modified",
          "additions": 15,
          "deletions": 2,
          "patch": "@@ -50,11 +50,16 @@ def _fillBorder(self, image, color):\n     image[height - 1, 0:width, 0:depth] = color\n     return image\n \n-  def _testDrawBoundingBoxColorCycling(self, img, colors=None):\n+  def _testDrawBoundingBoxColorCycling(self,\n+                                       img,\n+                                       dtype=dtypes.float32,\n+                                       colors=None):\n     \"\"\"Tests if cycling works appropriately.\n \n     Args:\n       img: 3-D numpy image on which to draw.\n+      dtype: image dtype (float, half).\n+      colors: color table.\n     \"\"\"\n     color_table = colors\n     if colors is None:\n@@ -82,7 +87,7 @@ def _testDrawBoundingBoxColorCycling(self, img, colors=None):\n       bboxes = math_ops.cast(bboxes, dtypes.float32)\n       bboxes = array_ops.expand_dims(bboxes, 0)\n       image = ops.convert_to_tensor(image)\n-      image = image_ops_impl.convert_image_dtype(image, dtypes.float32)\n+      image = image_ops_impl.convert_image_dtype(image, dtype)\n       image = array_ops.expand_dims(image, 0)\n       image = image_ops.draw_bounding_boxes(image, bboxes, colors=colors)\n       with self.cached_session(use_gpu=False) as sess:\n@@ -118,6 +123,14 @@ def testDrawBoundingBoxRGBAColorCyclingWithColors(self):\n                          [0, 0, 0.5, 1]])\n     self._testDrawBoundingBoxColorCycling(image, colors=colors)\n \n+  def testDrawBoundingBoxHalf(self):\n+    \"\"\"Test if RGBA color cycling works correctly with provided colors.\"\"\"\n+    image = np.zeros([10, 10, 4], \"float32\")\n+    colors = np.asarray([[0.5, 0, 0.5, 1], [0.5, 0.5, 0, 1], [0.5, 0, 0, 1],\n+                         [0, 0, 0.5, 1]])\n+    self._testDrawBoundingBoxColorCycling(\n+        image, dtype=dtypes.half, colors=colors)\n+\n \n if __name__ == \"__main__\":\n   test.main()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d93cc4f4f767f0d4a72f2fafcc59005be939c019",
            "date": "2025-01-14T20:36:32Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "d4e4516cc7d11a68a81a82227f3a432f7ab350a0",
            "date": "2025-01-14T19:59:15Z",
            "author_login": "ddunl"
          },
          {
            "sha": "65367823d999b6a36a685617100a7bb6ce03add4",
            "date": "2025-01-14T19:58:00Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "36cbae5466dbf356d91cf56127b2ab2ccd5a8b1f",
            "date": "2025-01-14T19:54:19Z",
            "author_login": "penpornk"
          },
          {
            "sha": "0a99598a8f76735ac32b5466385b0f5af08a06bb",
            "date": "2025-01-14T19:45:23Z",
            "author_login": "wangpengmit"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. When `DrawBoundingBoxes` receives an input `boxes` that is not of dtype `float`, it gives a `CHECK` fail that can trigger a denial of service attack. We have patched the issue in GitHub commit da0d65cdc1270038e72157ba35bf74b85d9bda11. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-16T23:15:10.707",
    "last_modified": "2024-11-21T07:12:09.320",
    "fix_date": "2022-07-19T05:41:06Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/da0d65cdc1270038e72157ba35bf74b85d9bda11",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-jqm7-m5q7-3hm5",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/da0d65cdc1270038e72157ba35bf74b85d9bda11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-jqm7-m5q7-3hm5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.134820",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}