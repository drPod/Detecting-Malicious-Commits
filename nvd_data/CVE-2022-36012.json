{
  "cve_id": "CVE-2022-36012",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "ad069af92392efee1418c48ff561fd3070a03d7b",
    "related_commits": [
      "ad069af92392efee1418c48ff561fd3070a03d7b",
      "ad069af92392efee1418c48ff561fd3070a03d7b"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/ad069af92392efee1418c48ff561fd3070a03d7b.patch",
    "fix_commit_details": {
      "sha": "ad069af92392efee1418c48ff561fd3070a03d7b",
      "commit_date": "2022-05-20T11:04:05Z",
      "author": {
        "login": "tensorflower-gardener",
        "type": "User",
        "stats": {
          "total_commits": 51283,
          "average_weekly_commits": 106.83958333333334,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 450
        }
      },
      "commit_message": {
        "title": "[tfg][functiondef_import] Error on empty edge names",
        "length": 157,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 98,
        "additions": 95,
        "deletions": 3
      },
      "files": [
        {
          "filename": "tensorflow/core/ir/importexport/functiondef_import.cc",
          "status": "modified",
          "additions": 18,
          "deletions": 3,
          "patch": "@@ -33,13 +33,15 @@ limitations under the License.\n #include \"tensorflow/core/ir/ops.h\"\n #include \"tensorflow/core/platform/errors.h\"\n #include \"tensorflow/core/platform/status.h\"\n+#include \"tensorflow/core/platform/statusor.h\"\n \n using tensorflow::AttrValue;\n using tensorflow::FunctionDef;\n using tensorflow::NodeDef;\n using tensorflow::OpDef;\n using tensorflow::OpDef_AttrDef;\n using tensorflow::Status;\n+using tensorflow::StatusOr;\n using tensorflow::errors::InvalidArgument;\n using tensorflow::protobuf::RepeatedPtrField;\n \n@@ -166,9 +168,12 @@ Status ImportNodes(ValueMapManager value_manager,\n     if (node.op().empty()) return InvalidArgument(\"empty op type\");\n     OperationState state(unknown_loc, absl::StrCat(\"tfg.\", node.op()));\n     // Fetch the inputs, creating placeholder if an input hasn't been visited.\n-    for (const std::string& input : node.input())\n+    for (const std::string& input : node.input()) {\n+      if (input.empty())\n+        return InvalidArgument(\"Node '\", node.name(), \"' has an empty input\");\n       state.operands.push_back(\n           value_manager.GetValueOrCreatePlaceholder(input));\n+    }\n     // Retrieve the entry in the nodes_map for this node and infer the result\n     // count from what was inferred during the first traversal above.\n     state.types.push_back(placeholder_ty);\n@@ -461,21 +466,31 @@ Status ImportGenericFunction(\n                               Value());\n   for (const auto& ret_val : func.ret()) {\n     auto position = output_name_to_position.find(ret_val.first);\n-    if (position == output_name_to_position.end())\n+    if (position == output_name_to_position.end()) {\n       return InvalidArgument(\n           \"Can't import function, returned value references unknown output \"\n           \"argument \",\n           ret_val.first);\n+    }\n+    if (ret_val.second.empty()) {\n+      return InvalidArgument(\"Function '\", func.signature().name(),\n+                             \"' has empty result name\");\n+    }\n     ret_vals[position->second] =\n         value_manager.GetValueOrCreatePlaceholder(ret_val.second);\n   }\n   for (const auto& ret_val : func.control_ret()) {\n     auto position = control_output_to_position.find(ret_val.first);\n-    if (position == control_output_to_position.end())\n+    if (position == control_output_to_position.end()) {\n       return InvalidArgument(\n           \"Can't import function, returned value references unknown output \"\n           \"argument \",\n           ret_val.first);\n+    }\n+    if (ret_val.second.empty()) {\n+      return InvalidArgument(\"Function '\", func.signature().name(),\n+                             \"' has empty control result name\");\n+    }\n     Value result = value_manager.GetValueOrCreatePlaceholder(\n         (Twine(\"^\") + ret_val.second).str());\n     if (!result.getType().isa<ControlType>())"
        },
        {
          "filename": "tensorflow/core/ir/importexport/tests/graphdef_to_mlir/invalid_generic_func_with_empty_control_result.pbtxt",
          "status": "added",
          "additions": 26,
          "deletions": 0,
          "patch": "@@ -0,0 +1,26 @@\n+# RUN: not tfg-translate -graphdef-to-mlir %s 2>&1 | FileCheck %s\n+\n+# CHECK: Function 'foo' has empty control result name\n+\n+library {\n+  function {\n+    signature {\n+      name: \"foo\"\n+      control_output: \"output\"\n+    }\n+    node_def {\n+      name: \"y\"\n+      op: \"NoOp\"\n+      attr {\n+        key: \"T\"\n+        value {\n+          placeholder: \"T\"\n+        }\n+      }\n+    }\n+    control_ret {\n+      key: \"output\"\n+      value: \"\"\n+    }\n+  }\n+}"
        },
        {
          "filename": "tensorflow/core/ir/importexport/tests/graphdef_to_mlir/invalid_generic_func_with_empty_input.pbtxt",
          "status": "added",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -0,0 +1,22 @@\n+# RUN: not tfg-translate -graphdef-to-mlir %s 2>&1 | FileCheck %s\n+\n+# CHECK: Node 'y' has an empty input\n+\n+library {\n+  function {\n+    signature {\n+      name: \"foo\"\n+    }\n+    node_def {\n+      name: \"y\"\n+      input: \"\"\n+      op: \"Identity\"\n+      attr {\n+        key: \"T\"\n+        value {\n+          placeholder: \"T\"\n+        }\n+      }\n+    }\n+  }\n+}"
        },
        {
          "filename": "tensorflow/core/ir/importexport/tests/graphdef_to_mlir/invalid_generic_func_with_empty_result.pbtxt",
          "status": "added",
          "additions": 29,
          "deletions": 0,
          "patch": "@@ -0,0 +1,29 @@\n+# RUN: not tfg-translate -graphdef-to-mlir %s 2>&1 | FileCheck %s\n+\n+# CHECK: Function 'foo' has empty result name\n+\n+library {\n+  function {\n+    signature {\n+      name: \"foo\"\n+      output_arg {\n+        name: \"output\"\n+        type: DT_INT32\n+      }\n+    }\n+    node_def {\n+      name: \"y\"\n+      op: \"NoOp\"\n+      attr {\n+        key: \"T\"\n+        value {\n+          placeholder: \"T\"\n+        }\n+      }\n+    }\n+    ret {\n+      key: \"output\"\n+      value: \"\"\n+    }\n+  }\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "65367823d999b6a36a685617100a7bb6ce03add4",
            "date": "2025-01-14T19:58:00Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "36cbae5466dbf356d91cf56127b2ab2ccd5a8b1f",
            "date": "2025-01-14T19:54:19Z",
            "author_login": "penpornk"
          },
          {
            "sha": "0a99598a8f76735ac32b5466385b0f5af08a06bb",
            "date": "2025-01-14T19:45:23Z",
            "author_login": "wangpengmit"
          },
          {
            "sha": "df078d626d561e6ae8f34d4702cbead44a3cbf82",
            "date": "2025-01-14T19:36:18Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "2a6c919b732bc36a8aa444c03c455a5ba7376ad5",
            "date": "2025-01-14T19:00:47Z",
            "author_login": "sdasgup3"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-617",
    "description": "TensorFlow is an open source platform for machine learning. When `mlir::tfg::ConvertGenericFunctionToFunctionDef` is given empty function attributes, it crashes. We have patched the issue in GitHub commit ad069af92392efee1418c48ff561fd3070a03d7b. The fix will be included in TensorFlow 2.10.0. We will also cherrypick this commit on TensorFlow 2.9.1, TensorFlow 2.8.1, and TensorFlow 2.7.2, as these are also affected and still in supported range. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-16T23:15:11.070",
    "last_modified": "2024-11-21T07:12:10.863",
    "fix_date": "2022-05-20T11:04:05Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/ir/importexport/functiondef_import.cc",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/ad069af92392efee1418c48ff561fd3070a03d7b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-jvhc-5hhr-w3v5",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/ir/importexport/functiondef_import.cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/ad069af92392efee1418c48ff561fd3070a03d7b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-jvhc-5hhr-w3v5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.135712",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}