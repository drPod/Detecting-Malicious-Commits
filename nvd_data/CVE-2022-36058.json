{
  "cve_id": "CVE-2022-36058",
  "github_data": {
    "repository": "ElrondNetwork/elrond-go",
    "fix_commit": "cb487fd7be2a2077638eb34ae771a73630c870c7",
    "related_commits": [
      "cb487fd7be2a2077638eb34ae771a73630c870c7",
      "cb487fd7be2a2077638eb34ae771a73630c870c7"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "cb487fd7be2a2077638eb34ae771a73630c870c7",
      "commit_date": "2022-07-06T19:17:27Z",
      "author": {
        "login": "iulianpascalau",
        "type": "User",
        "stats": {
          "total_commits": 5713,
          "average_weekly_commits": 16.902366863905325,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 287
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-qf7j-25g9-r63f",
        "length": 69,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 55,
        "additions": 53,
        "deletions": 2
      },
      "files": [
        {
          "filename": "go.mod",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@ require (\n \tgithub.com/ElrondNetwork/elrond-go-core v1.1.15\n \tgithub.com/ElrondNetwork/elrond-go-crypto v1.0.1\n \tgithub.com/ElrondNetwork/elrond-go-logger v1.0.7\n-\tgithub.com/ElrondNetwork/elrond-vm-common v1.3.6\n+\tgithub.com/ElrondNetwork/elrond-vm-common v1.3.10\n \tgithub.com/ElrondNetwork/go-libp2p-pubsub v0.6.1-rc1\n \tgithub.com/beevik/ntp v0.3.0\n \tgithub.com/btcsuite/btcd v0.22.0-beta"
        },
        {
          "filename": "go.sum",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -73,8 +73,9 @@ github.com/ElrondNetwork/elrond-go-logger v1.0.7/go.mod h1:cBfgx0ST/CJx8jrxJSC5a\n github.com/ElrondNetwork/elrond-vm-common v1.1.0/go.mod h1:w3i6f8uiuRkE68Ie/gebRcLgTuHqvruJSYrFyZWuLrE=\n github.com/ElrondNetwork/elrond-vm-common v1.2.9/go.mod h1:B/Y8WiqHyDd7xsjNYsaYbVMp1jQgQ+z4jTJkFvj/EWI=\n github.com/ElrondNetwork/elrond-vm-common v1.3.4/go.mod h1:B/Y8WiqHyDd7xsjNYsaYbVMp1jQgQ+z4jTJkFvj/EWI=\n-github.com/ElrondNetwork/elrond-vm-common v1.3.6 h1:4wr26EVIMAu7pJ197EkAqa1NYoVYiAJ3Z11UcQyc+cg=\n github.com/ElrondNetwork/elrond-vm-common v1.3.6/go.mod h1:seROQuR7RJCoCS7mgRXVAlvjztltY1c+UroAgWr/USE=\n+github.com/ElrondNetwork/elrond-vm-common v1.3.10 h1:s7jLzKw6V5bCDx6nImD0c+FQNZvod0RqXLAkl65fcCQ=\n+github.com/ElrondNetwork/elrond-vm-common v1.3.10/go.mod h1:seROQuR7RJCoCS7mgRXVAlvjztltY1c+UroAgWr/USE=\n github.com/ElrondNetwork/go-libp2p-pubsub v0.6.1-rc1 h1:Nu/uwYQg/QbfoQ0uD6GahYTwgtAkAwtzsB0HVfSP58I=\n github.com/ElrondNetwork/go-libp2p-pubsub v0.6.1-rc1/go.mod h1:pJfaShe+i5aWZx8NhSkQjvOYQYLoqPztmFUlKjToOzM=\n github.com/ElrondNetwork/protobuf v1.3.2 h1:qoCSYiO+8GtXBEZWEjw0WPcZfM3g7QuuJrwpN+y6Mvg="
        },
        {
          "filename": "integrationTests/vm/txsFee/asyncESDT_test.go",
          "status": "modified",
          "additions": 50,
          "deletions": 0,
          "patch": "@@ -397,3 +397,53 @@ func TestAsyncMultiTransferOnCallAndOnCallback(t *testing.T) {\n \tutils.CheckESDTNFTBalance(t, testContext, forwarderAddr, sftTokenID, 2, halfBalance)\n \tutils.CheckESDTNFTBalance(t, testContext, forwarderAddr, sftTokenID, 3, halfBalance)\n }\n+\n+func TestSendNFTToContractWith0Function(t *testing.T) {\n+\ttestContext, err := vm.CreatePreparedTxProcessorWithVMs(config.EnableEpochs{})\n+\trequire.Nil(t, err)\n+\tdefer testContext.Close()\n+\n+\townerAddr := []byte(\"12345678901234567890123456789010\")\n+\tsftTokenID := []byte(\"SFT-123456\")\n+\tsftNonce := uint64(1)\n+\tsftBalance := big.NewInt(1000)\n+\n+\tutils.CreateAccountWithESDTBalance(t, testContext.Accounts, ownerAddr, big.NewInt(1000000000), sftTokenID, sftNonce, sftBalance)\n+\tutils.CheckESDTNFTBalance(t, testContext, ownerAddr, sftTokenID, sftNonce, sftBalance)\n+\n+\tgasPrice := uint64(10)\n+\townerAccount, _ := testContext.Accounts.LoadAccount(ownerAddr)\n+\tdeployGasLimit := uint64(1000000)\n+\ttxGasLimit := uint64(1000000)\n+\n+\tvaultAddr := utils.DoDeploySecond(t,\n+\t\ttestContext,\n+\t\t\"../esdt/testdata/vault-managed-api.wasm\",\n+\t\townerAccount,\n+\t\tgasPrice,\n+\t\tdeployGasLimit,\n+\t\tnil,\n+\t\tbig.NewInt(0),\n+\t)\n+\n+\t// send the tokens to vault\n+\townerAccount, _ = testContext.Accounts.LoadAccount(ownerAddr)\n+\ttx := utils.CreateESDTNFTTransferTx(\n+\t\townerAccount.GetNonce(),\n+\t\townerAddr,\n+\t\tvaultAddr,\n+\t\tsftTokenID,\n+\t\tsftNonce,\n+\t\tsftBalance,\n+\t\tgasPrice,\n+\t\ttxGasLimit,\n+\t\t\"\",\n+\t)\n+\ttx.Data = append(tx.Data, []byte(\"@\")...)\n+\tretCode, err := testContext.TxProcessor.ProcessTransaction(tx)\n+\trequire.Equal(t, vmcommon.Ok, retCode)\n+\trequire.Nil(t, err)\n+\n+\t_, err = testContext.Accounts.Commit()\n+\trequire.Nil(t, err)\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "54bce4bb3ac2cb0d38aa265c9a9fd05b8680bedd",
            "date": "2024-12-09T15:16:51Z",
            "author_login": "sstanculeanu"
          },
          {
            "sha": "861b336a4fb9061d43e0806f2e2444f9b87dc365",
            "date": "2024-12-05T11:30:51Z",
            "author_login": "sstanculeanu"
          },
          {
            "sha": "e1b7df8259c19e17b03cb00babd7dac102ffd609",
            "date": "2024-12-05T10:48:30Z",
            "author_login": "sstanculeanu"
          },
          {
            "sha": "e65a3d42addd57c5e4264489f3b8e5c30bb3c902",
            "date": "2024-12-05T10:47:00Z",
            "author_login": "sstanculeanu"
          },
          {
            "sha": "1bccd60e6a584f1746cc1a0e8fd9c456a098b196",
            "date": "2024-12-05T10:28:09Z",
            "author_login": "sstanculeanu"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-20",
    "description": "Elrond go is the go implementation for the Elrond Network protocol. In versions prior to 1.3.34, anyone who uses elrond-go to process blocks (historical or actual) could encounter a `MultiESDTNFTTransfer` transaction like this: `MultiESDTNFTTransfer` with a missing function name. Basic functionality like p2p messaging, storage, API requests and such are unaffected. Version 1.3.34 contains a fix for this issue. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-06T20:15:08.947",
    "last_modified": "2024-11-21T07:12:17.260",
    "fix_date": "2022-07-06T19:17:27Z"
  },
  "references": [
    {
      "url": "https://github.com/ElrondNetwork/elrond-go/blob/8e402fa6d7e91e779980122d3798b2bf50892945/integrationTests/vm/txsFee/asyncESDT_test.go#L402",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ElrondNetwork/elrond-go/commit/cb487fd7be2a2077638eb34ae771a73630c870c7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ElrondNetwork/elrond-go/security/advisories/GHSA-qf7j-25g9-r63f",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ElrondNetwork/elrond-go/blob/8e402fa6d7e91e779980122d3798b2bf50892945/integrationTests/vm/txsFee/asyncESDT_test.go#L402",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ElrondNetwork/elrond-go/commit/cb487fd7be2a2077638eb34ae771a73630c870c7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ElrondNetwork/elrond-go/security/advisories/GHSA-qf7j-25g9-r63f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.083192",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mx-chain-go",
    "owner": "ElrondNetwork",
    "created_at": "2018-08-17T09:42:40Z",
    "updated_at": "2024-12-26T15:51:21Z",
    "pushed_at": "2025-01-23T16:34:27Z",
    "size": 355403,
    "stars": 935,
    "forks": 204,
    "open_issues": 115,
    "watchers": 935,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Go": 19946001,
      "Shell": 82189,
      "Makefile": 3207,
      "Dockerfile": 3107
    },
    "commit_activity": {
      "total_commits_last_year": 1550,
      "avg_commits_per_week": 29.807692307692307,
      "days_active_last_year": 195
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:13:18.059461"
  }
}