{
  "cve_id": "CVE-2022-36087",
  "github_data": {
    "repository": "oauthlib/oauthlib",
    "fix_commit": "2e40b412c844ecc4673c3fa3f72181f228bdbacd",
    "related_commits": [
      "2e40b412c844ecc4673c3fa3f72181f228bdbacd",
      "2e40b412c844ecc4673c3fa3f72181f228bdbacd"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2e40b412c844ecc4673c3fa3f72181f228bdbacd",
      "commit_date": "2022-09-09T19:48:14Z",
      "author": {
        "login": "JonathanHuot",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-3pgj-pg6c-r5p7",
        "length": 82,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 59,
        "additions": 55,
        "deletions": 4
      },
      "files": [
        {
          "filename": "oauthlib/uri_validate.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -66,7 +66,7 @@\n )\n \n #   IPv6address\n-IPv6address = r\"([A-Fa-f0-9:]+:+)+[A-Fa-f0-9]+\"\n+IPv6address = r\"([A-Fa-f0-9:]+[:$])[A-Fa-f0-9]{1,4}\"\n \n #   IPvFuture     = \"v\" 1*HEXDIG \".\" 1*( unreserved / sub-delims / \":\" )\n IPvFuture = r\"v %(HEXDIG)s+ \\. (?: %(unreserved)s | %(sub_delims)s | : )+\" % locals()"
        },
        {
          "filename": "tests/test_uri_validate.py",
          "status": "modified",
          "additions": 54,
          "deletions": 3,
          "patch": "@@ -1,4 +1,4 @@\n-import oauthlib\n+import unittest\n from oauthlib.uri_validate import is_absolute_uri\n \n from tests.unittest import TestCase\n@@ -7,7 +7,6 @@\n class UriValidateTest(TestCase):\n \n     def test_is_absolute_uri(self):\n-\n         self.assertIsNotNone(is_absolute_uri('schema://example.com/path'))\n         self.assertIsNotNone(is_absolute_uri('https://example.com/path'))\n         self.assertIsNotNone(is_absolute_uri('https://example.com'))\n@@ -17,17 +16,69 @@ def test_is_absolute_uri(self):\n         self.assertIsNotNone(is_absolute_uri('http://example.com'))\n         self.assertIsNotNone(is_absolute_uri('http://example.com/path'))\n         self.assertIsNotNone(is_absolute_uri('http://example.com:80/path'))\n-        self.assertIsNotNone(is_absolute_uri('com.example.bundle.id:/'))\n+\n+    def test_query(self):\n+        self.assertIsNotNone(is_absolute_uri('http://example.com:80/path?foo'))\n+        self.assertIsNotNone(is_absolute_uri('http://example.com:80/path?foo=bar'))\n+        self.assertIsNotNone(is_absolute_uri('http://example.com:80/path?foo=bar&fruit=banana'))\n+\n+    def test_fragment_forbidden(self):\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path#foo'))\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path#foo=bar'))\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path#foo=bar&fruit=banana'))\n+\n+    def test_combined_forbidden(self):\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path?foo#bar'))\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path?foo&bar#fruit'))\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path?foo=1&bar#fruit=banana'))\n+        self.assertIsNone(is_absolute_uri('http://example.com:80/path?foo=1&bar=2#fruit=banana&bar=foo'))\n+\n+    def test_custom_scheme(self):\n+        self.assertIsNotNone(is_absolute_uri('com.example.bundle.id://'))\n+\n+    def test_ipv6_bracket(self):\n         self.assertIsNotNone(is_absolute_uri('http://[::1]:38432/path'))\n         self.assertIsNotNone(is_absolute_uri('http://[::1]/path'))\n         self.assertIsNotNone(is_absolute_uri('http://[fd01:0001::1]/path'))\n         self.assertIsNotNone(is_absolute_uri('http://[fd01:1::1]/path'))\n         self.assertIsNotNone(is_absolute_uri('http://[0123:4567:89ab:cdef:0123:4567:89ab:cdef]/path'))\n+        self.assertIsNotNone(is_absolute_uri('http://[0123:4567:89ab:cdef:0123:4567:89ab:cdef]:8080/path'))\n+\n+    @unittest.skip(\"ipv6 edge-cases not supported\")\n+    def test_ipv6_edge_cases(self):\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8::'))\n+        self.assertIsNotNone(is_absolute_uri('http://::1234:5678'))\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8::1234:5678'))\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8:3333:4444:5555:6666:7777:8888'))\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8:3333:4444:CCCC:DDDD:EEEE:FFFF'))\n+        self.assertIsNotNone(is_absolute_uri('http://0123:4567:89ab:cdef:0123:4567:89ab:cdef/path'))\n+        self.assertIsNotNone(is_absolute_uri('http://::'))\n+        self.assertIsNotNone(is_absolute_uri('http://2001:0db8:0001:0000:0000:0ab9:C0A8:0102'))\n+\n+    @unittest.skip(\"ipv6 dual ipv4 not supported\")\n+    def test_ipv6_dual(self):\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8:3333:4444:5555:6666:1.2.3.4'))\n+        self.assertIsNotNone(is_absolute_uri('http://::11.22.33.44'))\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8::123.123.123.123'))\n+        self.assertIsNotNone(is_absolute_uri('http://::1234:5678:91.123.4.56'))\n+        self.assertIsNotNone(is_absolute_uri('http://::1234:5678:1.2.3.4'))\n+        self.assertIsNotNone(is_absolute_uri('http://2001:db8::1234:5678:5.6.7.8'))\n+\n+    def test_ipv4(self):\n         self.assertIsNotNone(is_absolute_uri('http://127.0.0.1:38432/'))\n         self.assertIsNotNone(is_absolute_uri('http://127.0.0.1:38432/'))\n         self.assertIsNotNone(is_absolute_uri('http://127.1:38432/'))\n \n+    def test_failures(self):\n         self.assertIsNone(is_absolute_uri('http://example.com:notaport/path'))\n         self.assertIsNone(is_absolute_uri('wrong'))\n         self.assertIsNone(is_absolute_uri('http://[:1]:38432/path'))\n         self.assertIsNone(is_absolute_uri('http://[abcd:efgh::1]/'))\n+\n+    def test_recursive_regex(self):\n+        from datetime import datetime\n+        t0 = datetime.now()\n+        is_absolute_uri('http://[::::::::::::::::::::::::::]/path')\n+        t1 = datetime.now()\n+        spent = t1 - t0\n+        self.assertGreater(0.1, spent.total_seconds(), \"possible recursive loop detected\")"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "028c563eb6af65426df45ba4bbfc771974e9594e",
            "date": "2024-12-08T07:28:28Z",
            "author_login": "duzumaki"
          },
          {
            "sha": "1fd5253630c03e3f12719dd8c13d43111f66a8d2",
            "date": "2024-10-21T09:56:47Z",
            "author_login": "jaap3"
          },
          {
            "sha": "bf75322aad61785501405308f3c4cd020983d17d",
            "date": "2024-10-17T18:59:03Z",
            "author_login": "duzumaki"
          },
          {
            "sha": "e1d9525f9a29cbc076bce9d48134ee09209957e2",
            "date": "2024-10-13T09:57:42Z",
            "author_login": "hugovk"
          },
          {
            "sha": "b84647e43a10b546b10294f2941dbf5142e9dda0",
            "date": "2024-10-03T09:03:58Z",
            "author_login": "duzumaki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-20",
    "description": "OAuthLib is an implementation of the OAuth request-signing logic for Python 3.6+. In OAuthLib versions 3.1.1 until 3.2.1, an attacker providing malicious redirect uri can cause denial of service. An attacker can also leverage usage of `uri_validate` functions depending where it is used. OAuthLib applications using OAuth2.0 provider support or use directly `uri_validate` are affected by this issue. Version 3.2.1 contains a patch. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-09T21:15:08.477",
    "last_modified": "2024-11-21T07:12:21.413",
    "fix_date": "2022-09-09T19:48:14Z"
  },
  "references": [
    {
      "url": "https://github.com/oauthlib/oauthlib/blob/2b8a44855a51ad5a5b0c348a08c2564a2e197ea2/oauthlib/uri_validate.py",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/blob/d4bafd9f1d0eba3766e933b1ac598cbbf37b8914/oauthlib/oauth2/rfc6749/grant_types/base.py#L232",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/commit/2e40b412c844ecc4673c3fa3f72181f228bdbacd",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/releases/tag/v3.2.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/security/advisories/GHSA-3pgj-pg6c-r5p7",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LXOPIA6M57CFQPUT6HHSNXCTV6QA3UDI/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NBCQJR3ZF7FVNTJYRVPVSQEQRAYZIUHU/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QRYLYHE5HWF6R2CRLJFUK4PILR47WXOE/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/X2CQZM5CKOUM4GW2GTAPQEQFPITQ6F7S/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/blob/2b8a44855a51ad5a5b0c348a08c2564a2e197ea2/oauthlib/uri_validate.py",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/blob/d4bafd9f1d0eba3766e933b1ac598cbbf37b8914/oauthlib/oauth2/rfc6749/grant_types/base.py#L232",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/commit/2e40b412c844ecc4673c3fa3f72181f228bdbacd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/releases/tag/v3.2.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/oauthlib/oauthlib/security/advisories/GHSA-3pgj-pg6c-r5p7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LXOPIA6M57CFQPUT6HHSNXCTV6QA3UDI/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NBCQJR3ZF7FVNTJYRVPVSQEQRAYZIUHU/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QRYLYHE5HWF6R2CRLJFUK4PILR47WXOE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/X2CQZM5CKOUM4GW2GTAPQEQFPITQ6F7S/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.101421",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "oauthlib",
    "owner": "oauthlib",
    "created_at": "2011-11-19T23:08:51Z",
    "updated_at": "2025-01-24T05:44:39Z",
    "pushed_at": "2024-12-08T07:28:29Z",
    "size": 3080,
    "stars": 2841,
    "forks": 487,
    "open_issues": 92,
    "watchers": 2841,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 901243,
      "Makefile": 2930
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-26T07:45:21.151530"
  }
}