{
  "cve_id": "CVE-2022-36088",
  "github_data": {
    "repository": "gocd/gocd",
    "fix_commit": "96add9605096ab50c5cd4c229be1d503aff506a6",
    "related_commits": [
      "96add9605096ab50c5cd4c229be1d503aff506a6",
      "96add9605096ab50c5cd4c229be1d503aff506a6"
    ],
    "patch_url": "https://github.com/gocd/gocd/commit/96add9605096ab50c5cd4c229be1d503aff506a6.patch",
    "fix_commit_details": {
      "sha": "96add9605096ab50c5cd4c229be1d503aff506a6",
      "commit_date": "2022-05-17T11:06:29Z",
      "author": {
        "login": "chadlwilson",
        "type": "User",
        "stats": {
          "total_commits": 5215,
          "average_weekly_commits": 8.991379310344827,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 185
        }
      },
      "commit_message": {
        "title": "Add NSIS AccessControl plugin to set permissions on install dir",
        "length": 181,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 17,
        "deletions": 0
      },
      "files": [
        {
          "filename": "installers/windows/go-base.nsi",
          "status": "modified",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -152,6 +152,21 @@ Function \".onInit\"\n   ${LogSet} off\n FunctionEnd\n \n+Function \"SetupDirectoryPermissions\"\n+    ${LogText} \"Setting directory permissions...\"\n+\n+\t; Disable inheritance. This breaks the inheritance chain and turns inherited permissions into explicit ones.\n+\tAccessControl::DisableFileInheritance $INSTDIR\n+\t; Make Administrators the owner\n+\tAccessControl::SetFileOwner $INSTDIR \"(S-1-5-32-544)\"\n+\t; Clear all explicit permissions on the file, leaving Administrators with full access\n+\tAccessControl::ClearOnFile  $INSTDIR \"(S-1-5-32-544)\" \"FullAccess\"\n+\t; Give SYSTEM full access.\n+\tAccessControl::SetOnFile    $INSTDIR \"(S-1-5-18)\"     \"FullAccess\"\n+\t; Give Everyone only access to read, list dir, and execute.\n+\tAccessControl::SetOnFile    $INSTDIR \"(S-1-1-0)\"      \"GenericRead + GenericExecute + ListDirectory + ReadAttributes\"\n+FunctionEnd\n+\n ; This section (being the first one, not because it's called Install) will be executed after the `.onInit` callback\n Section \"Install\"\n   SectionIn RO\n@@ -160,6 +175,8 @@ Section \"Install\"\n   SetOutPath $INSTDIR\n   ${LogSet} on\n \n+  Call SetupDirectoryPermissions\n+\n   ${If} $IsUpgrading == \"true\"\n     ${LogText} \"Performing an upgrade\"\n     Call BeforeUpgrade"
        },
        {
          "filename": "installers/windows/nsis-plugins/AccessControl.dll",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "745b8846335e2d352bd17223122b3585ba63bc18",
            "date": "2025-01-14T11:10:03Z",
            "author_login": "chadlwilson"
          },
          {
            "sha": "7e0e0c87401d8ce8d76c651194e9165523416037",
            "date": "2025-01-14T11:09:46Z",
            "author_login": "chadlwilson"
          },
          {
            "sha": "99aa6ecc886d9c30f79601e30c06224112da3045",
            "date": "2025-01-14T11:09:29Z",
            "author_login": "chadlwilson"
          },
          {
            "sha": "6e87477e6527985cddd634b48bd3505be1079d4d",
            "date": "2025-01-14T11:09:11Z",
            "author_login": "chadlwilson"
          },
          {
            "sha": "90fccf4ddc5b1641b3fcaadd6eaeff34501aefb6",
            "date": "2025-01-14T10:44:32Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.0,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-269",
    "description": "GoCD is a continuous delivery server. Windows installations via either the server or agent installers for GoCD prior to 22.2.0 do not adequately restrict permissions when installing outside of the default location. This could allow a malicious user with local access to the server GoCD Server or Agent are installed on to modify executables or components of the installation. This does not affect zip file-based installs, installations to other platforms, or installations inside `Program Files` or `Program Files (x86)`. This issue is fixed in GoCD 22.2.0 installers. As a workaround, if the server or agent is installed outside of `Program Files (x86)`, verify the the permission of the Server or Agent installation directory to ensure the `Everyone` user group does not have `Full Control`, `Modify` or `Write` permissions.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-07T23:15:14.170",
    "last_modified": "2024-11-21T07:12:21.570",
    "fix_date": "2022-05-17T11:06:29Z"
  },
  "references": [
    {
      "url": "https://github.com/gocd/gocd/commit/96add9605096ab50c5cd4c229be1d503aff506a6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gocd/gocd/releases/tag/22.2.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gocd/gocd/security/advisories/GHSA-gpv4-xqhc-5vcj",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.gocd.org/releases/#22-2-0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gocd/gocd/commit/96add9605096ab50c5cd4c229be1d503aff506a6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gocd/gocd/releases/tag/22.2.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gocd/gocd/security/advisories/GHSA-gpv4-xqhc-5vcj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.gocd.org/releases/#22-2-0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.089924",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gocd",
    "owner": "gocd",
    "created_at": "2013-12-13T05:26:16Z",
    "updated_at": "2025-01-14T12:47:48Z",
    "pushed_at": "2025-01-14T11:10:10Z",
    "size": 393992,
    "stars": 7159,
    "forks": 972,
    "open_issues": 82,
    "watchers": 7159,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Java": 20251061,
      "TypeScript": 4424594,
      "Groovy": 2080119,
      "JavaScript": 753678,
      "SCSS": 564746,
      "Ruby": 364252,
      "HTML": 253777,
      "XSLT": 202698,
      "NSIS": 24216,
      "Shell": 15469,
      "FreeMarker": 13061,
      "EJS": 1626,
      "CSS": 1575,
      "Batchfile": 474
    },
    "commit_activity": {
      "total_commits_last_year": 1743,
      "avg_commits_per_week": 33.51923076923077,
      "days_active_last_year": 299
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:11:02.445502"
  }
}