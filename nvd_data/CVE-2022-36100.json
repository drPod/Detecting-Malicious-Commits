{
  "cve_id": "CVE-2022-36100",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "604868033ebd191cf2d1e94db336f0c4d9096427",
    "related_commits": [
      "604868033ebd191cf2d1e94db336f0c4d9096427",
      "604868033ebd191cf2d1e94db336f0c4d9096427"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/604868033ebd191cf2d1e94db336f0c4d9096427.patch",
    "fix_commit_details": {
      "sha": "604868033ebd191cf2d1e94db336f0c4d9096427",
      "commit_date": "2022-05-20T16:02:47Z",
      "author": {
        "login": "michitux",
        "type": "User",
        "stats": {
          "total_commits": 378,
          "average_weekly_commits": 0.39622641509433965,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 108
        }
      },
      "commit_message": {
        "title": "XWIKI-19747: Escape tag names",
        "length": 66,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 9,
        "deletions": 8
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-tag/xwiki-platform-tag-ui/src/main/resources/Main/Tags.xml",
          "status": "modified",
          "additions": 9,
          "deletions": 8,
          "patch": "@@ -51,14 +51,15 @@ $xwiki.ssx.use('Main.Tags')##\n ##\n #set ($do = \"$!{request.get('do')}\")\n #set ($tag = \"$!{request.get('tag')}\")\n+#set ($wikiEscapedTag = $services.rendering.escape($tag, 'xwiki/2.1'))\n #set ($urlEscapedTag = $escapetool.url($tag))\n #set ($htmlEscapedTag = $escapetool.xml($tag))\n ##\n ## Macro displayTagAppTitle. Display level1 title of this app.\n ##\n #macro (displayTagAppTitle $urlEscapedTag $htmlEscapedTag $displayButtons)\n   (% class=\"xapp\" %)\n-  = (% class=\"highlight tag\" %)${tag}##\n+  = (% class=\"highlight tag\" %)${wikiEscapedTag}##\n       #if ($xwiki.hasAdminRights() &amp;&amp; $displayButtons) ##\n         [[$services.localization.render('xe.tag.rename.link')&gt;&gt;||queryString=\"do=prepareRename&amp;tag=${urlEscapedTag}\" class=\"button rename\" rel=\"nofollow\"]] [[$services.localization.render('xe.tag.delete.link')&gt;&gt;||queryString=\"do=prepareDelete&amp;tag=${urlEscapedTag}\" class=\"button delete\" rel=\"nofollow\"]]##\n       #end\n@@ -74,14 +75,14 @@ $xwiki.ssx.use('Main.Tags')##\n   ##\n   #displayTagAppTitle($urlEscapedTag $htmlEscapedTag true)\n   #if (\"$!{request.get('renamedTag')}\" != '')\n-    {{info}}$services.localization.render('xe.tag.rename.success', [\"//${request.get('renamedTag')}//\"]){{/info}}\n+    {{info}}$services.localization.render('xe.tag.rename.success', [\"//${services.rendering.escape(${request.get('renamedTag')}, 'xwiki/2.1')}//\"]){{/info}}\n \n   #end\n   #set ($list = $xwiki.tag.getDocumentsWithTag($tag))\n   {{container layoutStyle=\"columns\"}}\n     (((\n       (% class=\"xapp\" %)\n-      === $services.localization.render('xe.tag.alldocs', [\"//${tag}//\"]) ===\n+      === $services.localization.render('xe.tag.alldocs', [\"//${wikiEscapedTag}//\"]) ===\n \n       #if ($list.size()&gt; 0)\n         {{html}}#displayDocumentList($list false $blacklistedSpaces){{/html}}\n@@ -91,8 +92,8 @@ $xwiki.ssx.use('Main.Tags')##\n     )))\n     (((\n       (% class=\"xapp\" %)\n-      === $services.localization.render('xe.tag.activity', [\"//${tag}//\"]) ===\n-      {{notifications useUserPreferences=\"false\" displayOwnEvents=\"true\" tags=\"$tag\" displayRSSLink=\"true\" /}}\n+      === $services.localization.render('xe.tag.activity', [\"//${wikiEscapedTag}//\"]) ===\n+      {{notifications useUserPreferences=\"false\" displayOwnEvents=\"true\" tags=\"$wikiEscapedTag\" displayRSSLink=\"true\" /}}\n     )))\n   {{/container}}\n #elseif ($do == 'prepareRename')\n@@ -123,7 +124,7 @@ $xwiki.ssx.use('Main.Tags')##\n    #set ($urlEscapedRenameTo = $escapetool.url($renameTo))\n    $response.sendRedirect($doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedRenameTo}&amp;renamedTag=${urlEscapedTag}\"))\n   #else\n-    {{error}}$services.localization.render('xe.tag.rename.failure', [\"//${tag}//\", \"//${renameTo}//\"]){{/error}}\n+    {{error}}$services.localization.render('xe.tag.rename.failure', [\"//${wikiEscapedTag}//\", \"//${services.rendering.escape($renameTo, 'xwiki/2.1')}//\"]){{/error}}\n   #end\n #elseif ($do == 'prepareDelete')\n   ##\n@@ -148,15 +149,15 @@ $xwiki.ssx.use('Main.Tags')##\n   #if ($success == true || $success == 'OK')\n     $response.sendRedirect($doc.getURL('view', \"deletedTag=${urlEscapedTag}\"))\n   #else\n-    {{error}}$services.localization.render('xe.tag.delete.failure', [\"//${tag}//\"]){{/error}}\n+    {{error}}$services.localization.render('xe.tag.delete.failure', [\"//${wikiEscapedTag}//\"]){{/error}}\n   #end\n #else\n   ##\n   ## View all tags (Tag Cloud)\n   ##\n   #set ($title = 'All Tags')\n   #if (\"$!{request.get('deletedTag')}\" != '')\n-    {{info}}$services.localization.render('xe.tag.delete.success', [\"//${request.get('deletedTag')}//\"]){{/info}}\n+    {{info}}$services.localization.render('xe.tag.delete.success', [\"//${services.rendering.escape($request.get('deletedTag'), 'xwiki/2.1')}//\"]){{/info}}\n \n   #end\n   {{tagcloud/}}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-94",
    "description": "XWiki Platform Applications Tag and XWiki Platform Tag UI are tag applications for XWiki, a generic wiki platform. Starting with version 1.7 in XWiki Platform Applications Tag and prior to 13.10.6 and 14.4 in XWiki Platform Tag UI, the tags document `Main.Tags` in XWiki didn't sanitize user inputs properly. This allowed users with view rights on the document (default in a public wiki or for authenticated users on private wikis) to execute arbitrary Groovy, Python and Velocity code with programming rights. This also allowed bypassing all rights checks and thus both modification and disclosure of all content stored in the XWiki installation. The vulnerability could be used to impact the availability of the wiki. On XWiki versions before 13.10.4 and 14.2, this can be combined with CVE-2022-36092, meaning that no rights are required to perform the attack. The vulnerability has been patched in versions 13.10.6 and 14.4. As a workaround, the patch that fixes the issue can be manually applied to the document `Main.Tags` or the updated version of that document can be imported from version 14.4 of xwiki-platform-tag-ui using the import feature in the administration UI on XWiki 10.9 and later.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-08T21:15:08.237",
    "last_modified": "2024-11-21T07:12:23.300",
    "fix_date": "2022-05-20T16:02:47Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/604868033ebd191cf2d1e94db336f0c4d9096427",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2g5c-228j-p52x",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19747",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/604868033ebd191cf2d1e94db336f0c4d9096427",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2g5c-228j-p52x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19747",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.094900",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}