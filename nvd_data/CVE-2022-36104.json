{
  "cve_id": "CVE-2022-36104",
  "github_data": {
    "repository": "TYPO3/typo3",
    "fix_commit": "179dd7cd78947081d573fee2050e197faa556f13",
    "related_commits": [
      "179dd7cd78947081d573fee2050e197faa556f13",
      "179dd7cd78947081d573fee2050e197faa556f13"
    ],
    "patch_url": "https://github.com/TYPO3/typo3/commit/179dd7cd78947081d573fee2050e197faa556f13.patch",
    "fix_commit_details": {
      "sha": "179dd7cd78947081d573fee2050e197faa556f13",
      "commit_date": "2022-09-13T08:07:58Z",
      "author": {
        "login": "ohader",
        "type": "User",
        "stats": {
          "total_commits": 1840,
          "average_weekly_commits": 1.6546762589928057,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 513
        }
      },
      "commit_message": {
        "title": "[SECURITY] Mitigate denial-of-service scenarios in page error handler",
        "length": 590,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
      },
      "files": [
        {
          "filename": "typo3/sysext/core/Classes/Error/PageErrorHandler/PageContentErrorHandler.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -95,6 +95,13 @@ public function handlePageError(ServerRequestInterface $request, string $message\n             $urlParams['pageuid'] = (int)($urlParams['pageuid'] ?? 0);\n             $resolvedUrl = $this->resolveUrl($request, $urlParams);\n \n+            // avoid denial-of-service amplification scenario\n+            if ($resolvedUrl === (string)$request->getUri()) {\n+                return new HtmlResponse(\n+                    'The error page could not be resolved, as the error page itself is not accessible',\n+                    $this->statusCode\n+                );\n+            }\n             if ($this->useSubrequest) {\n                 // Create a subrequest and do not take any special query parameters into account\n                 $subRequest = $request->withQueryParams([])->withUri(new Uri($resolvedUrl))->withMethod('GET');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e0e4278e933010f7216c1b4e4e4308b9a3bc586e",
            "date": "2023-07-29T09:52:22Z",
            "author_login": "alexanderschnitzler"
          },
          {
            "sha": "b060907dde19ddc54234906d5a5e6708fdb26e8a",
            "date": "2025-01-14T11:09:26Z",
            "author_login": "PyGuy2"
          },
          {
            "sha": "03027a9cb4c558284289da7007c225aa42a72619",
            "date": "2024-07-04T09:57:38Z",
            "author_login": "mbrodala"
          },
          {
            "sha": "705b5bf51516821047b47ff0d4a1d643f35ed594",
            "date": "2025-01-13T11:53:46Z",
            "author_login": "lolli42"
          },
          {
            "sha": "c2460f9507bcb11bbe22765f50501f0177c9eb23",
            "date": "2024-08-28T09:13:49Z",
            "author_login": "wouter90"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-770",
    "description": "TYPO3 is an open source PHP based web content management system released under the GNU GPL. In affected versions requesting invalid or non-existing resources via HTTP triggers the page error handler which again could retrieve content to be shown as an error message from another page. This leads to a scenario in which the application is calling itself recursively - amplifying the impact of the initial attack until the limits of the web server are exceeded. Users are advised to update to TYPO3 version 11.5.16 to resolve this issue. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-09-13T18:15:14.703",
    "last_modified": "2024-11-21T07:12:23.873",
    "fix_date": "2022-09-13T08:07:58Z"
  },
  "references": [
    {
      "url": "https://github.com/TYPO3/typo3/commit/179dd7cd78947081d573fee2050e197faa556f13",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-fffr-7x4x-f98q",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-006",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/commit/179dd7cd78947081d573fee2050e197faa556f13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-fffr-7x4x-f98q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-006",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.108294",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "typo3",
    "owner": "TYPO3",
    "created_at": "2011-03-02T10:02:23Z",
    "updated_at": "2025-01-14T11:43:28Z",
    "pushed_at": "2025-01-14T12:27:55Z",
    "size": 598075,
    "stars": 1068,
    "forks": 674,
    "open_issues": 5,
    "watchers": 1068,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 34380148,
      "TypeScript": 2495477,
      "HTML": 1939183,
      "CSS": 573865,
      "SCSS": 460567,
      "JavaScript": 414810,
      "Shell": 94213,
      "XSLT": 6781,
      "Batchfile": 412
    },
    "commit_activity": {
      "total_commits_last_year": 2075,
      "avg_commits_per_week": 39.90384615384615,
      "days_active_last_year": 334
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:14:13.729873"
  }
}