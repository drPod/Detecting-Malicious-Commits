{
  "cve_id": "CVE-2022-36106",
  "github_data": {
    "repository": "TYPO3/typo3",
    "fix_commit": "56af2bd3a432156c30af9be71c9d6f7ef3a6159a",
    "related_commits": [
      "56af2bd3a432156c30af9be71c9d6f7ef3a6159a",
      "56af2bd3a432156c30af9be71c9d6f7ef3a6159a"
    ],
    "patch_url": "https://github.com/TYPO3/typo3/commit/56af2bd3a432156c30af9be71c9d6f7ef3a6159a.patch",
    "fix_commit_details": {
      "sha": "56af2bd3a432156c30af9be71c9d6f7ef3a6159a",
      "commit_date": "2022-09-13T08:08:49Z",
      "author": {
        "login": "derhansen",
        "type": "User",
        "stats": {
          "total_commits": 381,
          "average_weekly_commits": 0.3426258992805755,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 155
        }
      },
      "commit_message": {
        "title": "[SECURITY] Respect expiration time of password reset token",
        "length": 789,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "typo3/sysext/backend/Classes/Authentication/PasswordReset.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -278,6 +278,11 @@ public function isValidResetTokenFromRequest(ServerRequestInterface $request): b\n      */\n     protected function findValidUserForToken(string $token, string $identity, int $expirationTimestamp): ?array\n     {\n+        // Early return if token expired\n+        if ($expirationTimestamp < time()) {\n+            return null;\n+        }\n+\n         $user = null;\n         // Find the token in the database\n         $queryBuilder = $this->getPreparedQueryBuilder();"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c2460f9507bcb11bbe22765f50501f0177c9eb23",
            "date": "2024-08-28T09:13:49Z",
            "author_login": "wouter90"
          },
          {
            "sha": "1bd1923ef7fb3290e9e8303a2a30bc34c1dc83f6",
            "date": "2025-01-14T13:29:37Z",
            "author_login": "lolli42"
          },
          {
            "sha": "18d54b5c8fdf9c1363e80ed293076e7301f197c2",
            "date": "2025-01-14T09:47:45Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "79cfe3b6fa8e5efa614665439929f441df4c23c9",
            "date": "2024-12-04T11:32:49Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "d4b980a6f78234df24ecd47381f9a23006c6d843",
            "date": "2024-11-22T15:25:33Z",
            "author_login": "bmack"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-287",
    "description": "TYPO3 is an open source PHP based web content management system released under the GNU GPL. It has been discovered that the expiration time of a password reset link for TYPO3 backend users has never been evaluated. As a result, a password reset link could be used to perform a password reset even if the default expiry time of two hours has been exceeded. Update to TYPO3 version 10.4.32 or 11.5.16 that fix the problem. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-13T18:15:15.130",
    "last_modified": "2024-11-21T07:12:24.150",
    "fix_date": "2022-09-13T08:08:49Z"
  },
  "references": [
    {
      "url": "https://github.com/TYPO3/typo3/commit/56af2bd3a432156c30af9be71c9d6f7ef3a6159a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-5959-4x58-r8c2",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-008",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/commit/56af2bd3a432156c30af9be71c9d6f7ef3a6159a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-5959-4x58-r8c2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-008",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.108602",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "typo3",
    "owner": "TYPO3",
    "created_at": "2011-03-02T10:02:23Z",
    "updated_at": "2025-01-14T11:43:28Z",
    "pushed_at": "2025-01-14T12:27:55Z",
    "size": 598075,
    "stars": 1068,
    "forks": 674,
    "open_issues": 5,
    "watchers": 1068,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 34380148,
      "TypeScript": 2495477,
      "HTML": 1939183,
      "CSS": 573865,
      "SCSS": 460567,
      "JavaScript": 414810,
      "Shell": 94213,
      "XSLT": 6781,
      "Batchfile": 412
    },
    "commit_activity": {
      "total_commits_last_year": 2075,
      "avg_commits_per_week": 39.90384615384615,
      "days_active_last_year": 334
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:14:13.729873"
  }
}