{
  "cve_id": "CVE-2022-36108",
  "github_data": {
    "repository": "TYPO3/typo3",
    "fix_commit": "6863f73818c36b0b88c677ba533765c8074907b4",
    "related_commits": [
      "6863f73818c36b0b88c677ba533765c8074907b4",
      "6863f73818c36b0b88c677ba533765c8074907b4"
    ],
    "patch_url": "https://github.com/TYPO3/typo3/commit/6863f73818c36b0b88c677ba533765c8074907b4.patch",
    "fix_commit_details": {
      "sha": "6863f73818c36b0b88c677ba533765c8074907b4",
      "commit_date": "2022-09-13T08:09:57Z",
      "author": {
        "login": "ohader",
        "type": "User",
        "stats": {
          "total_commits": 1840,
          "average_weekly_commits": 1.6546762589928057,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 513
        }
      },
      "commit_message": {
        "title": "[SECURITY] Encode child node variables in f:asset.css view helper",
        "length": 619,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 76,
        "additions": 75,
        "deletions": 1
      },
      "files": [
        {
          "filename": "typo3/sysext/fluid/Classes/ViewHelpers/Asset/CssViewHelper.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -51,7 +51,7 @@ final class CssViewHelper extends AbstractTagBasedViewHelper\n      *\n      * @var bool\n      */\n-    protected $escapeChildren = false;\n+    protected $escapeChildren = true;\n \n     protected AssetCollector $assetCollector;\n "
        },
        {
          "filename": "typo3/sysext/fluid/Tests/Functional/ViewHelpers/Asset/CssViewHelperTest.php",
          "status": "modified",
          "additions": 74,
          "deletions": 0,
          "patch": "@@ -18,6 +18,8 @@\n namespace TYPO3\\CMS\\Fluid\\Tests\\Functional\\ViewHelpers\\Asset;\n \n use TYPO3\\CMS\\Core\\Page\\AssetCollector;\n+use TYPO3\\CMS\\Core\\Utility\\GeneralUtility;\n+use TYPO3\\CMS\\Fluid\\View\\StandaloneView;\n use TYPO3\\CMS\\Fluid\\ViewHelpers\\Asset\\CssViewHelper;\n use TYPO3\\TestingFramework\\Core\\Functional\\FunctionalTestCase;\n \n@@ -79,4 +81,76 @@ public function booleanAttributesAreProperlyConverted(): void\n         self::assertSame($collectedJavaScripts['test']['source'], 'my.css');\n         self::assertSame($collectedJavaScripts['test']['attributes'], ['disabled' => 'disabled']);\n     }\n+\n+    public static function childNodeRenderingIsCorrectDataProvider(): array\n+    {\n+        return [\n+            // Double quotes\n+            'variable with double quotes is encoded' => [\n+                '</style>/* \" ', // variable value\n+                'body { color: #{color}; }', // inner template source\n+                'body { color: #&lt;/style&gt;/* &quot; ; }', // expectation\n+            ],\n+            'variable with double quotes is encoded in single quotes' => [\n+                '</style>/* \" ', // variable value\n+                'body { color: \\'#{color}\\'; }', // inner template source\n+                'body { color: \\'#&lt;/style&gt;/* &quot; \\'; }', // expectation\n+            ],\n+            'variable with double quotes is encoded in double quotes' => [\n+                '</style>/* \" ', // variable value\n+                'body { color: \"#{color}\"; }', // inner template source\n+                'body { color: \"#&lt;/style&gt;/* &quot; \"; }', // expectation\n+            ],\n+            // Single quotes\n+            'variable with single quotes is encoded' => [\n+                '</style>/* \\' ', // variable value\n+                'body { color: #{color}; }', // inner template source\n+                'body { color: #&lt;/style&gt;/* &#039; ; }', // expectation\n+            ],\n+            'variable with single quotes is encoded in single quotes' => [\n+                '</style>/* \\' ', // variable value\n+                'body { color: \\'#{color}\\'; }', // inner template source\n+                'body { color: \\'#&lt;/style&gt;/* &#039; \\'; }', // expectation\n+            ],\n+            'variable with single quotes is encoded in double quotes' => [\n+                '</style>/* \\' ', // variable value\n+                'body { color: \"#{color}\"; }', // inner template source\n+                'body { color: \"#&lt;/style&gt;/* &#039; \"; }', // expectation\n+            ],\n+            // Raw instruction\n+            'raw instruction is passed' => [\n+                '</style>/* \" ',\n+                'body { color: #{color -> f:format.raw()}; }',\n+                'body { color: #</style>/* \" ; }',\n+            ],\n+            'raw instruction is passed in sigle quotes' => [\n+                '</style>/* \" ',\n+                'body { color: \\'#{color -> f:format.raw()}\\'; }',\n+                'body { color: \\'#</style>/* \" \\'; }',\n+            ],\n+            'raw instruction is passed in double quotes' => [\n+                '</style>/* \" ',\n+                'body { color: \"#{color -> f:format.raw()}\"; }',\n+                'body { color: \"#</style>/* \" \"; }',\n+            ],\n+        ];\n+    }\n+\n+    /**\n+     * @test\n+     * @dataProvider childNodeRenderingIsCorrectDataProvider\n+     */\n+    public function childNodeRenderingIsCorrect(string $value, string $source, string $expectation): void\n+    {\n+        $assetCollector = new AssetCollector();\n+        GeneralUtility::setSingletonInstance(AssetCollector::class, $assetCollector);\n+\n+        $view = new StandaloneView();\n+        $view->setTemplateSource(sprintf('<f:asset.css identifier=\"test\">%s</f:asset.css>', $source));\n+        $view->assign('color', $value);\n+        $view->render();\n+        GeneralUtility::removeSingletonInstance(AssetCollector::class, $assetCollector);\n+\n+        self::assertSame($expectation, $assetCollector->getInlineStyleSheets()['test']['source']);\n+    }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1bd1923ef7fb3290e9e8303a2a30bc34c1dc83f6",
            "date": "2025-01-14T13:29:37Z",
            "author_login": "lolli42"
          },
          {
            "sha": "18d54b5c8fdf9c1363e80ed293076e7301f197c2",
            "date": "2025-01-14T09:47:45Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "79cfe3b6fa8e5efa614665439929f441df4c23c9",
            "date": "2024-12-04T11:32:49Z",
            "author_login": "benjaminkott"
          },
          {
            "sha": "d4b980a6f78234df24ecd47381f9a23006c6d843",
            "date": "2024-11-22T15:25:33Z",
            "author_login": "bmack"
          },
          {
            "sha": "ae53daa257bd2482f5441f6cd7606ec4108afb62",
            "date": "2025-01-14T08:47:02Z",
            "author_login": "benjaminkott"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "TYPO3 is an open source PHP based web content management system released under the GNU GPL. It has been discovered that the `f:asset.css` view helper is vulnerable to cross-site scripting when user input is passed as variables to the CSS. Update to TYPO3 version 10.4.32 or 11.5.16 that fix the problem. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-13T18:15:15.313",
    "last_modified": "2024-11-21T07:12:24.423",
    "fix_date": "2022-09-13T08:09:57Z"
  },
  "references": [
    {
      "url": "https://github.com/TYPO3/typo3/commit/6863f73818c36b0b88c677ba533765c8074907b4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-fv2m-9249-qx85",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-010",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/commit/6863f73818c36b0b88c677ba533765c8074907b4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-fv2m-9249-qx85",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2022-010",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.108892",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "typo3",
    "owner": "TYPO3",
    "created_at": "2011-03-02T10:02:23Z",
    "updated_at": "2025-01-14T11:43:28Z",
    "pushed_at": "2025-01-14T12:27:55Z",
    "size": 598075,
    "stars": 1068,
    "forks": 674,
    "open_issues": 5,
    "watchers": 1068,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 34380148,
      "TypeScript": 2495477,
      "HTML": 1939183,
      "CSS": 573865,
      "SCSS": 460567,
      "JavaScript": 414810,
      "Shell": 94213,
      "XSLT": 6781,
      "Batchfile": 412
    },
    "commit_activity": {
      "total_commits_last_year": 2075,
      "avg_commits_per_week": 39.90384615384615,
      "days_active_last_year": 334
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:14:13.729873"
  }
}