{
  "cve_id": "CVE-2022-3704",
  "github_data": {
    "repository": "rails/rails",
    "fix_commit": "be177e4566747b73ff63fd5f529fab564e475ed4",
    "related_commits": [
      "be177e4566747b73ff63fd5f529fab564e475ed4",
      "be177e4566747b73ff63fd5f529fab564e475ed4"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "be177e4566747b73ff63fd5f529fab564e475ed4",
      "commit_date": "2022-10-18T19:42:44Z",
      "author": {
        "login": "codergeek121",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix #46244 Remove innerHTML usage to avoid self-XSS",
        "length": 51,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 17,
        "deletions": 8
      },
      "files": [
        {
          "filename": "actionpack/lib/action_dispatch/middleware/templates/routes/_table.html.erb",
          "status": "modified",
          "additions": 17,
          "deletions": 8,
          "patch": "@@ -102,9 +102,9 @@\n   // Enables path search functionality\n   function setupMatchPaths() {\n     // Check if there are any matched results in a section\n-    function checkNoMatch(section, noMatchText) {\n+    function checkNoMatch(section, trElement) {\n       if (section.children.length <= 1) {\n-        section.innerHTML += noMatchText;\n+        section.appendChild(trElement);\n       }\n     }\n \n@@ -145,21 +145,30 @@\n       }\n     }\n \n+    function buildTr(string) {\n+      var tr = document.createElement('tr');\n+      var th = document.createElement('th');\n+      th.setAttribute('colspan', 4);\n+      tr.appendChild(th);\n+      th.innerText = string;\n+      return tr;\n+    }\n+\n     // On key press perform a search for matching paths\n     delayedKeyup(searchElem, function() {\n       var path = sanitizePath(searchElem.value),\n-          defaultExactMatch = '<tr><th colspan=\"4\">Paths Matching (' + path +'):</th></tr>',\n-          defaultFuzzyMatch = '<tr><th colspan=\"4\">Paths Containing (' + path +'):</th></tr>',\n-          noExactMatch      = '<tr><th colspan=\"4\">No Exact Matches Found</th></tr>',\n-          noFuzzyMatch      = '<tr><th colspan=\"4\">No Fuzzy Matches Found</th></tr>';\n+          defaultExactMatch = buildTr('Paths Matching (' + path + '):'),\n+          defaultFuzzyMatch = buildTr('Paths Containing (' + path +'):'),\n+          noExactMatch      = buildTr('No Exact Matches Found'),\n+          noFuzzyMatch      = buildTr('No Fuzzy Matches Found');\n \n       if (!path)\n         return searchElem.onblur();\n \n       getJSON('/rails/info/routes?path=' + path, function(matches){\n         // Clear out results section\n-        exactSection.innerHTML = defaultExactMatch;\n-        fuzzySection.innerHTML = defaultFuzzyMatch;\n+        exactSection.replaceChildren(defaultExactMatch);\n+        fuzzySection.replaceChildren(defaultFuzzyMatch);\n \n         // Display exact matches and fuzzy matches\n         pathElements.forEach(function(elem) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f1e610ec20532a1fdce6d3ce94d8d610bca48d89",
            "date": "2025-01-25T13:40:22Z",
            "author_login": "byroot"
          },
          {
            "sha": "7629dd1a5353ca1ad01dd1e4f2e0a301ba7ba4a6",
            "date": "2025-01-25T09:05:19Z",
            "author_login": "joshuay03"
          },
          {
            "sha": "2ca006fb7fe881c225c000d9ab11e2a3554b70fa",
            "date": "2025-01-24T21:19:22Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "cd171d69fa03e0a09133089eca672831d447d02a",
            "date": "2025-01-24T20:48:43Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "dc522a3e6933e014c691e06c5d866d6351d6640d",
            "date": "2025-01-24T15:03:22Z",
            "author_login": "Edouard-chin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability classified as problematic has been found in Ruby on Rails. This affects an unknown part of the file actionpack/lib/action_dispatch/middleware/templates/routes/_table.html.erb. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. The real existence of this vulnerability is still doubted at the moment. The name of the patch is be177e4566747b73ff63fd5f529fab564e475ed4. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-212319. NOTE: Maintainer declares that there isn\u2019t a valid attack vector. The issue was wrongly reported as a security vulnerability by a non-member of the Rails team.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-10-26T20:15:10.730",
    "last_modified": "2024-11-21T07:20:04.373",
    "fix_date": "2022-10-18T19:42:44Z"
  },
  "references": [
    {
      "url": "https://github.com/rails/rails/commit/be177e4566747b73ff63fd5f529fab564e475ed4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rails/rails/issues/46244",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212319",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rails/rails/commit/be177e4566747b73ff63fd5f529fab564e475ed4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rails/rails/issues/46244",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212319",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.959910",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "rails",
    "owner": "rails",
    "created_at": "2008-04-11T02:19:47Z",
    "updated_at": "2025-01-26T05:34:47Z",
    "pushed_at": "2025-01-25T13:40:23Z",
    "size": 261808,
    "stars": 56353,
    "forks": 21756,
    "open_issues": 1262,
    "watchers": 56353,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0-5-stable",
      "0-6-stable",
      "0-7-stable",
      "0-8-stable",
      "1-2-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "2-3-stable",
      "3-0-stable",
      "3-1-stable",
      "3-2-stable",
      "4-0-stable",
      "4-1-stable",
      "4-2-stable",
      "5-0-stable",
      "5-1-stable",
      "5-2-stable",
      "6-0-stable",
      "6-1-stable",
      "7-0-stable",
      "7-1-stable",
      "7-2-stable"
    ],
    "languages": {
      "Ruby": 17142031,
      "JavaScript": 228210,
      "HTML": 196993,
      "SCSS": 50596,
      "CSS": 47127,
      "Dockerfile": 2019,
      "Shell": 708
    },
    "commit_activity": {
      "total_commits_last_year": 3977,
      "avg_commits_per_week": 76.48076923076923,
      "days_active_last_year": 350
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:40:39.021267"
  }
}