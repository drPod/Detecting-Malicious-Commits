{
  "cve_id": "CVE-2022-3708",
  "github_data": {
    "repository": "GoogleForCreators/web-stories-wp",
    "fix_commit": "3ad2099f95155d658624ffac2e34ce0da739e34b",
    "related_commits": [
      "3ad2099f95155d658624ffac2e34ce0da739e34b",
      "3ad2099f95155d658624ffac2e34ce0da739e34b"
    ],
    "patch_url": "https://github.com/GoogleForCreators/web-stories-wp/commit/3ad2099f95155d658624ffac2e34ce0da739e34b.patch",
    "fix_commit_details": {
      "sha": "3ad2099f95155d658624ffac2e34ce0da739e34b",
      "commit_date": "2022-09-02T15:09:39Z",
      "author": {
        "login": "swissspidy",
        "type": "User",
        "stats": {
          "total_commits": 4987,
          "average_weekly_commits": 10.240246406570842,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 270
        }
      },
      "commit_message": {
        "title": "Improve URL checks in hotlinking controller",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 18,
        "deletions": 3
      },
      "files": [
        {
          "filename": "includes/REST_API/Hotlinking_Controller.php",
          "status": "modified",
          "additions": 15,
          "deletions": 3,
          "patch": "@@ -672,9 +672,21 @@ private function validate_url( string $url ) {\n \t\t\t}\n \n \t\t\t$parts = array_map( 'intval', explode( '.', $ip ) );\n-\t\t\tif ( 127 === $parts[0] || 10 === $parts[0] || 0 === $parts[0]\n-\t\t\t\t|| ( 172 === $parts[0] && 16 <= $parts[1] && 31 >= $parts[1] )\n-\t\t\t\t|| ( 192 === $parts[0] && 168 === $parts[1] )\n+\t\t\tif (\n+\t\t\t\t0 === $parts[0] // 0.0.0.0/8.\n+\t\t\t\t||\n+\t\t\t\t127 === $parts[0] // 127.0.0.0/8.\n+\t\t\t\t||\n+\t\t\t\t10 === $parts[0] // 10.0.0.0/8.\n+\t\t\t\t||\n+\t\t\t\t( 172 === $parts[0] && 16 <= $parts[1] && 31 >= $parts[1] ) // 172.16.0.0/12.\n+\t\t\t\t||\n+\t\t\t\t( 192 === $parts[0] && 168 === $parts[1] ) // 192.168.0.0/16.\n+\t\t\t\t||\n+\t\t\t\t( 169 === $parts[0] && 254 === $parts[1] ) // 169.254.0.0/16.\n+\t\t\t\t||\n+\t\t\t\t// phpcs:ignore Squiz.PHP.CommentedOutCode.Found\n+\t\t\t\t( 100 === $parts[0] && 64 <= $parts[1] && 127 >= $parts[1] ) // Private: 100.64.0.0/10.\n \t\t\t) {\n \t\t\t\t// If host appears local, reject.\n \t\t\t\treturn false;"
        },
        {
          "filename": "tests/phpunit/integration/tests/REST_API/Hotlinking_Controller.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -573,6 +573,9 @@ public function data_validate_url_should_not_validate(): array {\n \t\t\t'an external request when not allowed'         => [\n \t\t\t\t'url' => 'http://192.168.0.1/caniload.php',\n \t\t\t],\n+\t\t\t'a request with disallowed link-local ip'      => [\n+\t\t\t\t'url' => 'http://169.254.0.0/caniload.php',\n+\t\t\t],\n \t\t\t'a port not considered safe by default'        => [\n \t\t\t\t'url' => 'https://example.com:81/caniload.php',\n \t\t\t],"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "49308fd38a362578bae06a6b4f671e2b0c70a5d5",
            "date": "2025-01-10T12:28:34Z",
            "author_login": "swissspidy"
          },
          {
            "sha": "b4b5028e3ac2ebacb528cf9cf2071aa1f01e8057",
            "date": "2025-01-09T22:02:34Z",
            "author_login": "swissspidy"
          },
          {
            "sha": "47cd5b0897380d6f5d5553cd372871b3f50abdb3",
            "date": "2025-01-09T20:19:00Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "73c70e6e785878bc1d6199999e93d5c849888fe9",
            "date": "2025-01-09T20:18:38Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e41dce8f30e09925b7e8c693d17ab87d5cdf62b9",
            "date": "2025-01-09T16:27:53Z",
            "author_login": "swissspidy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-918",
    "description": "The Web Stories plugin for WordPress is vulnerable to Server-Side Request Forgery in versions up to, and including 1.24.0 due to insufficient validation of URLs supplied via the 'url' parameter found via the /v1/hotlink/proxy REST API Endpoint. This makes it possible for authenticated users to make web requests to arbitrary locations originating from the web application and can be used to query and modify information from internal services.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-10-28T19:15:10.140",
    "last_modified": "2024-11-21T07:20:05.003",
    "fix_date": "2022-09-02T15:09:39Z"
  },
  "references": [
    {
      "url": "https://github.com/GoogleForCreators/web-stories-wp/commit/3ad2099f95155d658624ffac2e34ce0da739e34b",
      "source": "security@wordfence.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/GoogleForCreators/web-stories-wp/compare/v1.24.0...v1.25.0",
      "source": "security@wordfence.com",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://wordpress.org/plugins/web-stories",
      "source": "security@wordfence.com",
      "tags": [
        "Product",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/7817a840-325a-4709-8374-84bb32d98d0e?source=cve",
      "source": "security@wordfence.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/vulnerability-advisories-continued/#CVE-2022-3708",
      "source": "security@wordfence.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/GoogleForCreators/web-stories-wp/commit/3ad2099f95155d658624ffac2e34ce0da739e34b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/GoogleForCreators/web-stories-wp/compare/v1.24.0...v1.25.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://wordpress.org/plugins/web-stories",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product",
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/7817a840-325a-4709-8374-84bb32d98d0e?source=cve",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/vulnerability-advisories-continued/#CVE-2022-3708",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.968642",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "web-stories-wp",
    "owner": "GoogleForCreators",
    "created_at": "2020-01-21T20:30:33Z",
    "updated_at": "2025-01-11T05:02:38Z",
    "pushed_at": "2025-01-10T13:01:12Z",
    "size": 2166811,
    "stars": 767,
    "forks": 179,
    "open_issues": 9,
    "watchers": 767,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "gh-pages",
      "main",
      "release/1.0.0",
      "release/1.1.0-2020-10-28",
      "release/1.1.1",
      "release/1.2",
      "release/1.2.1",
      "release/1.3.0",
      "release/1.4.0",
      "release/1.5.0",
      "release/1.6.0",
      "release/1.7.0",
      "release/1.8.0",
      "release/1.9.0",
      "release/1.10.0",
      "release/1.11.0",
      "release/1.12.0",
      "release/1.13.0",
      "release/1.14.0",
      "release/1.15.0",
      "release/1.16.0",
      "release/1.17.0",
      "release/1.18.0"
    ],
    "languages": {
      "JavaScript": 7603405,
      "TypeScript": 5849685,
      "PHP": 1869645,
      "HTML": 85665,
      "CSS": 49357,
      "Shell": 29383
    },
    "commit_activity": {
      "total_commits_last_year": 596,
      "avg_commits_per_week": 11.461538461538462,
      "days_active_last_year": 84
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:48:31.568548"
  }
}