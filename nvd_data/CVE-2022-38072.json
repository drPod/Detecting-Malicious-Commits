{
  "cve_id": "CVE-2022-38072",
  "github_data": {
    "repository": "admesh/admesh",
    "fix_commit": "5fab257268a0ee6f832c18d72af89810a29fbd5f",
    "related_commits": [
      "5fab257268a0ee6f832c18d72af89810a29fbd5f",
      "5fab257268a0ee6f832c18d72af89810a29fbd5f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5fab257268a0ee6f832c18d72af89810a29fbd5f",
      "commit_date": "2022-11-18T22:04:28Z",
      "author": {
        "login": "gladk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Check the neighbor_index in stl_check_normal_vector",
        "length": 64,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/normals.c",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -142,7 +142,8 @@ stl_fix_normal_directions(stl_file *stl) {\n         }\n       }\n       /* If this edge of the facet is connected: */\n-      if(stl->neighbors_start[facet_num].neighbor[j] != -1) {\n+      if(stl->neighbors_start[facet_num].neighbor[j] != -1 &&\n+         stl->neighbors_start[facet_num].neighbor[j] < stl->stats.number_of_facets*sizeof(char)) {\n         /* If we haven't fixed this facet yet, add it to the list: */\n         if(norm_sw[stl->neighbors_start[facet_num].neighbor[j]] != 1) {\n           /* Add node to beginning of list. */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d77590614cc4da46a142207b5d9fc5cfdc937032",
            "date": "2022-11-21T12:33:06Z",
            "author_login": "hroncok"
          },
          {
            "sha": "d66fde8b25e74593e6285dda3b605b555568a5ec",
            "date": "2022-11-21T12:30:45Z",
            "author_login": "hroncok"
          },
          {
            "sha": "5fab257268a0ee6f832c18d72af89810a29fbd5f",
            "date": "2022-11-18T22:04:28Z",
            "author_login": "gladk"
          },
          {
            "sha": "767a105f1f361abe082662435ab90d8bea984a0f",
            "date": "2022-06-24T15:15:06Z",
            "author_login": "andreondra"
          },
          {
            "sha": "e84d8353f1347e1f26f0a95770d92ba14e6ede38",
            "date": "2022-04-25T10:04:46Z",
            "author_login": "andreondra"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
    "cwe_id": "CWE-118",
    "description": "An improper array index validation vulnerability exists in the stl_fix_normal_directions functionality of ADMesh Master Commit 767a105 and v0.98.4. A specially-crafted stl file can lead to a heap buffer overflow. An attacker can provide a malicious file to trigger this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-03T16:15:07.343",
    "last_modified": "2024-11-21T07:15:43.317",
    "fix_date": "2022-11-18T22:04:28Z"
  },
  "references": [
    {
      "url": "https://github.com/admesh/admesh/commit/5fab257268a0ee6f832c18d72af89810a29fbd5f",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://talosintelligence.com/vulnerability_reports/TALOS-2022-1594",
      "source": "talos-cna@cisco.com",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/admesh/admesh/commit/5fab257268a0ee6f832c18d72af89810a29fbd5f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://talosintelligence.com/vulnerability_reports/TALOS-2022-1594",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.talosintelligence.com/vulnerability_reports/TALOS-2022-1594",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.036062",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "admesh",
    "owner": "admesh",
    "created_at": "2013-10-20T09:01:33Z",
    "updated_at": "2025-01-03T09:33:48Z",
    "pushed_at": "2022-12-16T11:11:52Z",
    "size": 1826,
    "stars": 221,
    "forks": 77,
    "open_issues": 22,
    "watchers": 221,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 126180,
      "CMake": 9897,
      "Roff": 6044,
      "Shell": 377
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:11:27.429322"
  }
}