{
  "cve_id": "CVE-2022-3827",
  "github_data": {
    "repository": "centreon/centreon",
    "fix_commit": "293b10628f7d9f83c6c82c78cf637cbe9b907369",
    "related_commits": [
      "293b10628f7d9f83c6c82c78cf637cbe9b907369",
      "293b10628f7d9f83c6c82c78cf637cbe9b907369"
    ],
    "patch_url": "https://github.com/centreon/centreon/commit/293b10628f7d9f83c6c82c78cf637cbe9b907369.patch",
    "fix_commit_details": {
      "sha": "293b10628f7d9f83c6c82c78cf637cbe9b907369",
      "commit_date": "2022-09-26T15:20:55Z",
      "author": {
        "login": "hyahiaoui-ext",
        "type": "User",
        "stats": {
          "total_commits": 34,
          "average_weekly_commits": 0.03516028955532575,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 24
        }
      },
      "commit_message": {
        "title": "FIX: SQLi in contact groups form (#11869)",
        "length": 41,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "www/include/configuration/configObject/contactgroup/formContactGroup.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -64,12 +64,14 @@\n     /*\n      * Get host Group information\n      */\n-    $DBRESULT = $pearDB->query(\"SELECT * FROM `contactgroup` WHERE `cg_id` = '\" . $cg_id . \"' LIMIT 1\");\n+    $statement = $pearDB->prepare(\"SELECT * FROM `contactgroup` WHERE `cg_id` = :cg_id LIMIT 1\");\n+    $statement->bindValue(':cg_id', (int) $cg_id, \\PDO::PARAM_INT);\n+    $statement->execute();\n \n     /*\n      * Set base value\n      */\n-    $cg = array_map(\"myDecode\", $DBRESULT->fetchRow());\n+    $cg = array_map(\"myDecode\", $statement->fetch(\\PDO::FETCH_ASSOC));\n }\n \n $attrsText = array(\"size\" => \"30\");"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6041851eb8b8f9bf586618f9de9e3f23cfee7e4c",
            "date": "2025-01-14T14:16:27Z",
            "author_login": "kduret"
          },
          {
            "sha": "518e31f1f2749e61b72d1f26aed82f37d675a57a",
            "date": "2025-01-14T14:02:24Z",
            "author_login": "adr-mo"
          },
          {
            "sha": "02a93a796db7263ef554f1dee1f55f1e6e1d5a9a",
            "date": "2025-01-13T17:18:37Z",
            "author_login": "selfakiri"
          },
          {
            "sha": "2224f6423ee522a4e81719e12c70f7cb8563f480",
            "date": "2025-01-13T13:44:35Z",
            "author_login": "Noha-ElAbrouki"
          },
          {
            "sha": "70ab68fc8be574a61ba02778a807a7942b47cbf9",
            "date": "2025-01-13T10:22:16Z",
            "author_login": "kduret"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-707",
    "description": "A vulnerability was found in centreon. It has been declared as critical. This vulnerability affects unknown code of the file formContactGroup.php of the component Contact Groups Form. The manipulation of the argument cg_id leads to sql injection. The attack can be initiated remotely. The name of the patch is 293b10628f7d9f83c6c82c78cf637cbe9b907369. It is recommended to apply a patch to fix this issue. VDB-212794 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-02T13:15:18.937",
    "last_modified": "2024-11-21T07:20:19.007",
    "fix_date": "2022-09-26T15:20:55Z"
  },
  "references": [
    {
      "url": "https://github.com/centreon/centreon/commit/293b10628f7d9f83c6c82c78cf637cbe9b907369",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/centreon/centreon/pull/11869",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212794",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/centreon/centreon/commit/293b10628f7d9f83c6c82c78cf637cbe9b907369",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/centreon/centreon/pull/11869",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212794",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.982494",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "centreon",
    "owner": "centreon",
    "created_at": "2022-05-25T08:21:12Z",
    "updated_at": "2025-01-13T17:18:42Z",
    "pushed_at": "2025-01-14T13:20:00Z",
    "size": 635046,
    "stars": 108,
    "forks": 41,
    "open_issues": 209,
    "watchers": 108,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "22.04.x",
      "22.10.x",
      "23.04.x",
      "23.10.x",
      "24.04.x",
      "24.10.x"
    ],
    "languages": {
      "PHP": 22266098,
      "TypeScript": 5869839,
      "JavaScript": 889717,
      "Shell": 423983,
      "CSS": 212783,
      "Gherkin": 211415,
      "Perl": 174900,
      "XSLT": 124723,
      "HTML": 122838,
      "Smarty": 46951,
      "Python": 32748,
      "Makefile": 22579,
      "Lua": 21249,
      "MDX": 3220,
      "NewLisp": 621
    },
    "commit_activity": {
      "total_commits_last_year": 1688,
      "avg_commits_per_week": 32.46153846153846,
      "days_active_last_year": 231
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:22:24.210755"
  }
}