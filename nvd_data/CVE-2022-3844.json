{
  "cve_id": "CVE-2022-3844",
  "github_data": {
    "repository": "webmin/webmin",
    "fix_commit": "d3d33af3c0c3fd3a889c84e287a038b7a457d811",
    "related_commits": [
      "d3d33af3c0c3fd3a889c84e287a038b7a457d811",
      "d3d33af3c0c3fd3a889c84e287a038b7a457d811"
    ],
    "patch_url": "https://github.com/webmin/webmin/commit/d3d33af3c0c3fd3a889c84e287a038b7a457d811.patch",
    "fix_commit_details": {
      "sha": "d3d33af3c0c3fd3a889c84e287a038b7a457d811",
      "commit_date": "2022-10-30T22:55:21Z",
      "author": {
        "login": "jcameron",
        "type": "User",
        "stats": {
          "total_commits": 14386,
          "average_weekly_commits": 15.502155172413794,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 916
        }
      },
      "commit_message": {
        "title": "Clean up code and prevent HTML attacks on untrusted inputs",
        "length": 58,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 30,
        "additions": 12,
        "deletions": 18
      },
      "files": [
        {
          "filename": "xterm/index.cgi",
          "status": "modified",
          "additions": 12,
          "deletions": 18,
          "patch": "@@ -171,32 +171,26 @@ $miniserv{'websockets_'.$wspath} = \"host=127.0.0.1 port=$port wspath=/ user=$rem\n &unlock_file(&get_miniserv_config_file());\n &reload_miniserv();\n \n-# Launch the shell server on that port\n-&foreign_require(\"cron\");\n-my $shellserver_cmd = \"$module_config_directory/shellserver.pl\";\n-if (!-r $shellserver_cmd) {\n-\t&cron::create_wrapper($shellserver_cmd, $module_name, \"shellserver.pl\");\n-\t}\n+# Check permissions for user to run as\n my $user = $access{'user'};\n if ($user eq \"*\") {\n \t$user = $remote_user;\n \t}\n \n # Switch to given user\n-if ($user eq \"root\") {\n-\tmy $username = $in{'user'};\n-\tif ($username) {\n-\tmy @uinfo = getpwnam($username);\n-\t\tif (@uinfo) {\n-\t\t\t$user = $username;\n-\t\t\t}\n-\t\telse {\n-\t\t\t&error(&text('index_euser', $username));\n-\t\t\t}\n-\t\t}\n+if ($user eq \"root\" && $in{'user'}) {\n+\tdefined(getpwnam($in{'user'})) ||\n+\t\t&error(&text('index_euser', &html_escape($in{'user'})));\n+\t$user = $in{'user'};\n \t}\n \n-defined(getpwnam($user)) || &error(&text('index_euser', $user));\n+# Launch the shell server on the allocated port\n+&foreign_require(\"cron\");\n+my $shellserver_cmd = \"$module_config_directory/shellserver.pl\";\n+if (!-r $shellserver_cmd) {\n+\t&cron::create_wrapper($shellserver_cmd, $module_name, \"shellserver.pl\");\n+\t}\n+defined(getpwnam($user)) || &error(&text('index_euser', &html_escape($user)));\n my $tmpdir = &tempname_dir();\n $ENV{'SESSION_ID'} = $main::session_id;\n &system_logged(\"$shellserver_cmd $port $user >$tmpdir/ws-$port.out 2>&1 </dev/null\");"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9d48afe5628402fd82844cf674d10cb7bd3f769e",
            "date": "2025-01-14T17:15:35Z",
            "author_login": "iliajie"
          },
          {
            "sha": "edccfc45332b4ca7f25b8d647190398b963088b5",
            "date": "2025-01-14T16:35:16Z",
            "author_login": "jcameron"
          },
          {
            "sha": "4d70ada0517fe3c647bf87013f8951eac01ddc7a",
            "date": "2025-01-14T16:35:11Z",
            "author_login": "jcameron"
          },
          {
            "sha": "c0f69446b31f4d9df3728a20d8b71bb86e113818",
            "date": "2025-01-14T13:23:22Z",
            "author_login": "iliajie"
          },
          {
            "sha": "aab912dccfb17c88bb6185a957d1ad69fb648364",
            "date": "2025-01-14T01:14:21Z",
            "author_login": "iliajie"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-80",
    "description": "A vulnerability, which was classified as problematic, was found in Webmin 2.001. Affected is an unknown function of the file xterm/index.cgi. The manipulation leads to basic cross site scripting. It is possible to launch the attack remotely. Upgrading to version 2.003 is able to address this issue. The patch is identified as d3d33af3c0c3fd3a889c84e287a038b7a457d811. It is recommended to upgrade the affected component. VDB-212862 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-02T20:15:11.023",
    "last_modified": "2024-11-21T07:20:21.160",
    "fix_date": "2022-10-30T22:55:21Z"
  },
  "references": [
    {
      "url": "https://github.com/webmin/webmin/commit/d3d33af3c0c3fd3a889c84e287a038b7a457d811",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmin/webmin/releases/tag/2.003",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.212862",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212862",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/webmin/webmin/commit/d3d33af3c0c3fd3a889c84e287a038b7a457d811",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmin/webmin/releases/tag/2.003",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.212862",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212862",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.987049",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "webmin",
    "owner": "webmin",
    "created_at": "2009-07-20T22:03:42Z",
    "updated_at": "2025-01-14T10:35:33Z",
    "pushed_at": "2025-01-14T01:14:28Z",
    "size": 129043,
    "stars": 4539,
    "forks": 659,
    "open_issues": 516,
    "watchers": 4539,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 26069526,
      "Perl": 13006075,
      "Raku": 588115,
      "JavaScript": 345178,
      "Java": 212834,
      "CSS": 128080,
      "Prolog": 82675,
      "NewLisp": 82461,
      "Shell": 77820,
      "Python": 76600,
      "Ruby": 55550,
      "C#": 55225,
      "Roff": 33343,
      "MAXScript": 29070,
      "Makefile": 22007,
      "PHP": 18896,
      "SystemVerilog": 17056,
      "C": 15136,
      "Emacs Lisp": 14067,
      "Erlang": 5863,
      "Batchfile": 3160,
      "Smalltalk": 145
    },
    "commit_activity": {
      "total_commits_last_year": 964,
      "avg_commits_per_week": 18.53846153846154,
      "days_active_last_year": 225
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:21:38.927248"
  }
}