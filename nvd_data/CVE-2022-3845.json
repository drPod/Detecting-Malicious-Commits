{
  "cve_id": "CVE-2022-3845",
  "github_data": {
    "repository": "phpipam/phpipam",
    "fix_commit": "22c797c3583001211fe7d31bccd3f1d4aeeb3bbc",
    "related_commits": [
      "22c797c3583001211fe7d31bccd3f1d4aeeb3bbc",
      "22c797c3583001211fe7d31bccd3f1d4aeeb3bbc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "22c797c3583001211fe7d31bccd3f1d4aeeb3bbc",
      "commit_date": "2022-04-24T12:37:17Z",
      "author": {
        "login": "GaryAllan",
        "type": "User",
        "stats": {
          "total_commits": 877,
          "average_weekly_commits": 1.7435387673956262,
          "total_additions": 33025,
          "total_deletions": 58367,
          "weeks_active": 195
        }
      },
      "commit_message": {
        "title": "Bugfix: XSS (reflected) in import previews",
        "length": 89,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 5,
        "deletions": 7
      },
      "files": [
        {
          "filename": "app/admin/import-export/import-load-data.php",
          "status": "modified",
          "additions": 4,
          "deletions": 7,
          "patch": "@@ -65,7 +65,7 @@\n \tforeach ($cols as $val) {\n \t\t$col++;\n \t\t# map import columns to expected fields as per previous window\n-\t\t$fieldmap[$col] = $impfields[$val];\n+\t\t$fieldmap[$col] = escape_input(trim($impfields[$val]));\n \t\t$hcol = $col;\n \t}\n \n@@ -81,7 +81,7 @@\n \t\t\t\t$Result->show('danger', _(\"Extra column found on line \").$row._(\" in CSV file. CSV delimiter used in value field?\"), true);\n \t\t\t} else {\n \t\t\t\t# read each row into a dictionary with expected fields as keys\n-\t\t\t\t$record[$fieldmap[$col]] = trim($val);\n+\t\t\t\t$record[$fieldmap[$col]] = escape_input(trim($val));\n \t\t\t}\n \t\t}\n \t\t$data[] = $record;\n@@ -97,23 +97,20 @@\n \n \t# map import columns to expected fields as per previous window\n \tfor($col=1;$col<=$xls->colcount($sheet);$col++) {\n-\t\t$fieldmap[$col] = $impfields[$Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet))];\n+\t\t$fieldmap[$col] = $impfields[escape_input($Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet)))];\n \t\t$hcol = $col;\n \t}\n \n \t# read each remaining row into a dictionary with expected fields as keys\n \tfor($row=2;$row<=$xls->rowcount($sheet);$row++) {\n \t\t$record = array();\n \t\tfor($col=1;$col<=$xls->colcount($sheet);$col++) {\n-\t\t\t$record++;\n \t\t\tif ($col > $hcol) {\n \t\t\t\t\t$Result->show('danger', _(\"Extra column found on line \").$row._(\" in XLS file. Please check input file.\"), true);\n \t\t\t} else {\n-\t\t\t\t$record[$fieldmap[$col]] = trim($Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet)));\n+\t\t\t\t$record[$fieldmap[$col]] = escape_input(trim($Tools->convert_encoding_to_UTF8($xls->val($row,$col,$sheet))));\n \t\t\t}\n \t\t}\n \t\t$data[] = $record;\n \t}\n }\n-\n-?>"
        },
        {
          "filename": "misc/CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -92,6 +92,7 @@\n     + XSS (reflected) in 'find subnets';\n     + Incorrect privilege assignments (#3506);\n     + XXS (reflected) in ripe-arin-query;\n+    + XSS (reflected) in import previews;\n \n     Translations:\n     ----------------------------"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "602d81226784fe8de1af96db98f594745f6b441d",
            "date": "2024-11-27T09:56:05Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "f04280ba16fa3901dcd98900a248adfc55f89e13",
            "date": "2024-11-27T09:57:12Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "3212ed239c11093c83bb10bac1f727682c562e17",
            "date": "2024-11-26T16:15:46Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "93cfa93424947a71d0a75ee128f49c90897243c4",
            "date": "2024-11-23T22:18:16Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "91acd5c61f546d29e3b2ae526768c80a065f6e15",
            "date": "2024-11-23T22:22:42Z",
            "author_login": "GaryAllan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability has been found in phpipam and classified as problematic. Affected by this vulnerability is an unknown functionality of the file app/admin/import-export/import-load-data.php of the component Import Preview Handler. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.5.0 is able to address this issue. The name of the patch is 22c797c3583001211fe7d31bccd3f1d4aeeb3bbc. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-212863.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-02T20:15:11.537",
    "last_modified": "2024-11-21T07:20:21.310",
    "fix_date": "2022-04-24T12:37:17Z"
  },
  "references": [
    {
      "url": "https://github.com/phpipam/phpipam/commit/22c797c3583001211fe7d31bccd3f1d4aeeb3bbc",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/phpipam/phpipam/releases/tag/v1.5.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212863",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/phpipam/phpipam/commit/22c797c3583001211fe7d31bccd3f1d4aeeb3bbc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/phpipam/phpipam/releases/tag/v1.5.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.212863",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.987210",
    "processing_status": "enhanced"
  }
}