{
  "cve_id": "CVE-2022-39200",
  "github_data": {
    "repository": "matrix-org/dendrite",
    "fix_commit": "2792d0490f3771488bad346981b8c26479a872c3",
    "related_commits": [
      "2792d0490f3771488bad346981b8c26479a872c3",
      "2792d0490f3771488bad346981b8c26479a872c3"
    ],
    "patch_url": "https://github.com/matrix-org/dendrite/commit/2792d0490f3771488bad346981b8c26479a872c3.patch",
    "fix_commit_details": {
      "sha": "2792d0490f3771488bad346981b8c26479a872c3",
      "commit_date": "2022-09-12T11:30:41Z",
      "author": {
        "login": "neilalexander",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix missing signature check on the `/get_missing_events` response",
        "length": 65,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "roomserver/internal/input/input_missing.go",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -553,11 +553,14 @@ func (t *missingStateReq) getMissingEvents(ctx context.Context, e *gomatrixserve\n \n \t// Make sure events from the missingResp are using the cache - missing events\n \t// will be added and duplicates will be removed.\n-\tlogger.Debugf(\"get_missing_events returned %d events\", len(missingResp.Events))\n \tmissingEvents := make([]*gomatrixserverlib.Event, 0, len(missingResp.Events))\n \tfor _, ev := range missingResp.Events.UntrustedEvents(roomVersion) {\n+\t\tif err = ev.VerifyEventSignatures(ctx, t.keys); err != nil {\n+\t\t\tcontinue\n+\t\t}\n \t\tmissingEvents = append(missingEvents, t.cacheAndReturn(ev))\n \t}\n+\tlogger.Debugf(\"get_missing_events returned %d events (%d passed signature checks)\", len(missingResp.Events), len(missingEvents))\n \n \t// topologically sort and sanity check that we are making forward progress\n \tnewEvents = gomatrixserverlib.ReverseTopologicalOrdering(missingEvents, gomatrixserverlib.TopologicalOrderByPrevEvents)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "084181332b5c364e2442d3c98522ad8848bc4d36",
            "date": "2024-11-25T10:04:10Z",
            "author_login": "S7evinK"
          },
          {
            "sha": "79b87c7a08045a5b5c676b97cedd49250bff2237",
            "date": "2024-11-14T12:42:51Z",
            "author_login": "S7evinK"
          },
          {
            "sha": "488009ca905be78c0cbd5364e879d61232b32868",
            "date": "2024-11-14T08:24:36Z",
            "author_login": "S7evinK"
          },
          {
            "sha": "95d93b32e348a8d1217e0c1207190aeba8e326b5",
            "date": "2024-11-04T14:34:08Z",
            "author_login": "S7evinK"
          },
          {
            "sha": "4cc68ef922dc174f6053b2bf949bb2269a95d842",
            "date": "2024-10-30T14:04:29Z",
            "author_login": "S7evinK"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-347",
    "description": "Dendrite is a Matrix homeserver written in Go. In affected versions events retrieved from a remote homeserver using the `/get_missing_events` path did not have their signatures verified correctly. This could potentially allow a remote homeserver to provide invalid/modified events to Dendrite via this endpoint. Note that this does not apply to events retrieved through other endpoints (e.g. `/event`, `/state`) as they have been correctly verified. Homeservers that have federation disabled are not vulnerable. The problem has been fixed in Dendrite 0.9.8. Users are advised to upgrade. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-12T20:15:12.960",
    "last_modified": "2024-11-21T07:17:46.433",
    "fix_date": "2022-09-12T11:30:41Z"
  },
  "references": [
    {
      "url": "https://github.com/matrix-org/dendrite/commit/2792d0490f3771488bad346981b8c26479a872c3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/matrix-org/dendrite/security/advisories/GHSA-pfw4-xjgm-267c",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/matrix-org/dendrite/commit/2792d0490f3771488bad346981b8c26479a872c3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/matrix-org/dendrite/security/advisories/GHSA-pfw4-xjgm-267c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.104361",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dendrite",
    "owner": "matrix-org",
    "created_at": "2017-01-20T18:22:16Z",
    "updated_at": "2025-01-13T20:11:43Z",
    "pushed_at": "2024-11-25T10:18:03Z",
    "size": 46666,
    "stars": 5724,
    "forks": 678,
    "open_issues": 229,
    "watchers": 5724,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 4856446,
      "Dockerfile": 12359,
      "Shell": 10589,
      "JavaScript": 10077,
      "Python": 9860,
      "Smarty": 2270,
      "HTML": 1703,
      "CSS": 1224
    },
    "commit_activity": {
      "total_commits_last_year": 72,
      "avg_commits_per_week": 1.3846153846153846,
      "days_active_last_year": 38
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:15:29.965902"
  }
}