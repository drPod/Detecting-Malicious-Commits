{
  "cve_id": "CVE-2022-39208",
  "github_data": {
    "repository": "theonedev/onedev",
    "fix_commit": "8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
    "related_commits": [
      "8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
      "8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822"
    ],
    "patch_url": "https://github.com/theonedev/onedev/commit/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822.patch",
    "fix_commit_details": {
      "sha": "8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
      "commit_date": "2022-05-30T12:58:18Z",
      "author": {
        "login": "robinshine",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix security vulnerability issue regarding site/* access",
        "length": 56,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 122,
        "additions": 78,
        "deletions": 44
      },
      "files": [
        {
          "filename": "pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@\n \t\t<version>1.0.5</version>\n \t</parent>\n \t<artifactId>server</artifactId>\n-\t<version>7.2.9</version>\n+\t<version>7.3.0</version>\n \t<packaging>pom</packaging>\n \t<build>\n \t\t<finalName>${project.groupId}.${project.artifactId}-${project.version}</finalName>"
        },
        {
          "filename": "server-core/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<build>\n \t\t<plugins>"
        },
        {
          "filename": "server-core/src/main/java/io/onedev/server/maintenance/Upgrade.java",
          "status": "modified",
          "additions": 35,
          "deletions": 4,
          "patch": "@@ -487,17 +487,48 @@ protected void updateProgramFiles(File upgradeDir) {\n \t\t\tFileUtils.deleteFile(new File(upgradeDir, \"boot/system.classpath\"));\r\n \t\t\r\n \t\tcleanAndCopy(Bootstrap.getLibDir(), new File(upgradeDir, \"lib\"));\r\n-\t\t\r\n-\t\tfor (File file: new File(Bootstrap.getSiteDir(), \"avatars\").listFiles()) {\r\n+\r\n+\t\tFileUtils.createDir(new File(upgradeDir, \"site/assets\"));\r\n+\t\tif (new File(upgradeDir, \"site/robots.txt\").exists()) {\r\n+\t\t\ttry {\r\n+\t\t\t\tFileUtils.copyFile(\r\n+\t\t\t\t\t\tnew File(upgradeDir, \"site/robots.txt\"), \r\n+\t\t\t\t\t\tnew File(upgradeDir, \"site/assets/robots.txt\"));\r\n+\t\t\t\tFileUtils.deleteFile(new File(upgradeDir, \"site/robots.txt\"));\r\n+\t\t\t} catch (IOException e) {\r\n+\t\t\t\tthrow new RuntimeException(e);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\tif (new File(upgradeDir, \"site/logo.png\").exists()) {\r\n+\t\t\ttry {\r\n+\t\t\t\tFileUtils.copyFile(\r\n+\t\t\t\t\t\tnew File(upgradeDir, \"site/logo.png\"), \r\n+\t\t\t\t\t\tnew File(upgradeDir, \"site/assets/logo.png\"));\r\n+\t\t\t\tFileUtils.deleteFile(new File(upgradeDir, \"site/logo.png\"));\r\n+\t\t\t} catch (IOException e) {\r\n+\t\t\t\tthrow new RuntimeException(e);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\tif (new File(upgradeDir, \"site/avatars\").exists()) {\r\n+\t\t\ttry {\r\n+\t\t\t\tFileUtils.copyDirectory(\r\n+\t\t\t\t\t\tnew File(upgradeDir, \"site/avatars\"), \r\n+\t\t\t\t\t\tnew File(upgradeDir, \"site/assets/avatars\"));\r\n+\t\t\t\tFileUtils.deleteDir(new File(upgradeDir, \"site/avatars\"));\r\n+\t\t\t} catch (IOException e) {\r\n+\t\t\t\tthrow new RuntimeException(e);\r\n+\t\t\t}\r\n+\t\t}\r\n+\t\tfor (File file: new File(Bootstrap.getSiteDir(), \"assets/avatars\").listFiles()) {\r\n \t\t\tif (file.isFile()) {\r\n \t\t\t\ttry {\r\n-\t\t\t\t\tFileUtils.copyFileToDirectory(file, new File(upgradeDir, \"site/avatars\"));\r\n+\t\t\t\t\tFileUtils.copyFileToDirectory(file, new File(upgradeDir, \"site/assets/avatars\"));\r\n \t\t\t\t} catch (IOException e) {\r\n \t\t\t\t\tthrow new RuntimeException(e);\r\n \t\t\t\t}\r\n \t\t\t}\r\n \t\t}\r\n-\t\tFile uploadedDir = new File(upgradeDir, \"site/avatars/uploaded\");\r\n+\t\tFile uploadedDir = new File(upgradeDir, \"site/assets/avatars/uploaded\");\r\n \t\tFile userUploadsDir = new File(uploadedDir, \"users\"); \r\n \t\tif (uploadedDir.exists() && !userUploadsDir.exists()) {\r\n \t\t\tFileUtils.createDir(userUploadsDir);\r"
        },
        {
          "filename": "server-core/src/main/java/io/onedev/server/web/avatar/DefaultAvatarManager.java",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -93,7 +93,7 @@ private String generateAvatar(String primaryName, String secondaryName) {\n \t\tif (StringUtils.isBlank(secondaryName))\n \t\t\tsecondaryName = primaryName;\n \t\t\n-\t\tFile avatarFile = new File(Bootstrap.getSiteDir(), \"avatars/generated/\" + encoded + \".png\");\n+\t\tFile avatarFile = new File(Bootstrap.getSiteDir(), \"assets/avatars/generated/\" + encoded + \".png\");\n \t\tif (!avatarFile.exists()) {\n \t\t\tLock avatarLock = LockUtils.getLock(\"generated-avatar:\" + encoded);\n \t\t\tavatarLock.lock();\n@@ -129,7 +129,7 @@ private String getLetter(String name) {\n \t\n \t@Override\n \tpublic File getUploaded(User user) {\n-\t\treturn new File(Bootstrap.getSiteDir(), \"avatars/uploaded/users/\" + user.getId() + \".jpg\");\n+\t\treturn new File(Bootstrap.getSiteDir(), \"assets/avatars/uploaded/users/\" + user.getId() + \".jpg\");\n \t}\n \n \t@Sessional\n@@ -170,7 +170,7 @@ public void useAvatar(Project project, String avatarData) {\n \n \t@Override\n \tpublic File getUploaded(Long projectId) {\n-\t\treturn new File(Bootstrap.getSiteDir(), \"avatars/uploaded/projects/\" + projectId + \".jpg\");\n+\t\treturn new File(Bootstrap.getSiteDir(), \"assets/avatars/uploaded/projects/\" + projectId + \".jpg\");\n \t}\n \n \t@Override"
        },
        {
          "filename": "server-core/src/main/java/io/onedev/server/web/component/brandlogo/BrandLogoPanel.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@ public BrandLogoPanel(String id) {\n \t}\n \n \tprivate File getCustomLogoFile() {\n-\t\treturn new File(Bootstrap.getSiteDir(), \"logo.png\");\n+\t\treturn new File(Bootstrap.getSiteDir(), \"assets/logo.png\");\n \t}\n \t\n \t@Override"
        },
        {
          "filename": "server-core/src/main/java/io/onedev/server/web/page/admin/brandingsetting/BrandingSettingPage.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -33,7 +33,7 @@ public BrandingSettingPage(PageParameters params) {\n \t}\n \t\n \tprivate File getLogoFile() {\n-\t\treturn new File(Bootstrap.getSiteDir(), \"logo.png\");\n+\t\treturn new File(Bootstrap.getSiteDir(), \"assets/logo.png\");\n \t}\n \n \t@Override"
        },
        {
          "filename": "server-plugin/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-archetype/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<build>\n \t\t<resources>"
        },
        {
          "filename": "server-plugin/server-plugin-authenticator-ldap/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.authenticator.ldap.LdapModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-buildspec-gradle/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\r\n \t\t<groupId>io.onedev</groupId>\r\n \t\t<artifactId>server-plugin</artifactId>\r\n-\t\t<version>7.2.9</version>\r\n+\t\t<version>7.3.0</version>\r\n \t</parent>\r\n \t<properties>\r\n \t\t<moduleClass>io.onedev.server.plugin.buildspec.gradle.GradleModule</moduleClass>\r"
        },
        {
          "filename": "server-plugin/server-plugin-buildspec-maven/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.buildspec.maven.MavenModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-buildspec-node/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.buildspec.node.NodePluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-executor-kubernetes/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.executor.kubernetes.KubernetesModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-executor-remotedocker/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-executor-remoteshell/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-executor-serverdocker/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.executor.serverdocker.ServerDockerModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-executor-servershell/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.executor.servershell.ServerShellModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-import-bitbucketcloud/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.imports.bitbucketcloud.BitbucketPluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-import-gitea/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.imports.gitea.GiteaPluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-import-github/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.imports.github.GitHubPluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-import-gitlab/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.imports.gitlab.GitLabPluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-import-jiracloud/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.imports.jiracloud.JiraPluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-import-youtrack/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.imports.youtrack.YouTrackPluginModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-report-checkstyle/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-clover/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-coverage/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.report.coverage.CoverageReportModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-report-cpd/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-jacoco/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-jest/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-junit/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-markdown/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.report.markdown.MarkdownReportModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-report-pmd/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-problem/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.report.problem.ProblemReportModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-report-spotbugs/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-plugin/server-plugin-report-unittest/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<properties>\n \t\t<moduleClass>io.onedev.server.plugin.report.unittest.UnitTestReportModule</moduleClass>"
        },
        {
          "filename": "server-plugin/server-plugin-sso-discord/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -5,7 +5,7 @@\n \t<parent>\r\n \t\t<groupId>io.onedev</groupId>\r\n \t\t<artifactId>server-plugin</artifactId>\r\n-\t\t<version>7.2.9</version>\r\n+\t\t<version>7.3.0</version>\r\n \t</parent>\r\n \t<properties>\r\n \t\t<moduleClass>io.onedev.server.plugin.sso.discord.DiscordModule</moduleClass>\r"
        },
        {
          "filename": "server-plugin/server-plugin-sso-openid/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server-plugin</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-product/pom.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n \t<parent>\n \t\t<groupId>io.onedev</groupId>\n \t\t<artifactId>server</artifactId>\n-\t\t<version>7.2.9</version>\n+\t\t<version>7.3.0</version>\n \t</parent>\n \t<dependencies>\n \t\t<dependency>"
        },
        {
          "filename": "server-product/src/main/java/io/onedev/server/product/ProductServletConfigurator.java",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -1,5 +1,6 @@\n package io.onedev.server.product;\n \n+import java.io.File;\n import java.util.EnumSet;\n \n import javax.inject.Inject;\n@@ -119,8 +120,10 @@ public void sessionDestroyed(HttpSessionEvent se) {\n \t\t * Configure a servlet to serve contents under site folder. Site folder can be used \n \t\t * to hold site specific web assets.   \n \t\t */\n-\t\tServletHolder fileServletHolder = new ServletHolder(new FileAssetServlet(Bootstrap.getSiteDir()));\n+\t\tFile assetsDir = new File(Bootstrap.getSiteDir(), \"assets\");\n+\t\tServletHolder fileServletHolder = new ServletHolder(new FileAssetServlet(assetsDir));\n \t\tcontext.addServlet(fileServletHolder, \"/site/*\");\n+\t\t\n \t\tcontext.addServlet(fileServletHolder, \"/robots.txt\");\n \t\t\n \t\tcontext.addServlet(new ServletHolder(jerseyServlet), \"/api/*\");\t"
        },
        {
          "filename": "server-product/system/site/assets/avatars/onedev.png",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "server-product/system/site/assets/avatars/project.png",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "server-product/system/site/assets/avatars/user.png",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "server-product/system/site/assets/robots.txt",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 41,
        "max_directory_depth": 11
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "10e2c31d03935064a014dfb1464fa7bc146be9e0",
            "date": "2025-01-11T23:54:45Z",
            "author_login": "robinshine"
          },
          {
            "sha": "715386eb735489c08616f9e1c3dc56f58a5457c3",
            "date": "2025-01-11T01:12:03Z",
            "author_login": "robinshine"
          },
          {
            "sha": "be37d8fc32b9c3c4d7b11d3af8051be8911ee390",
            "date": "2025-01-09T14:35:55Z",
            "author_login": "robinshine"
          },
          {
            "sha": "f61d99124dd571668a8836354672903717ced5ca",
            "date": "2025-01-06T03:25:54Z",
            "author_login": "sususweet"
          },
          {
            "sha": "4c37f0dd4e0336e64f22fa04929d67188ee70bd4",
            "date": "2025-01-06T02:48:57Z",
            "author_login": "sususweet"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-552",
    "description": "Onedev is an open source, self-hosted Git Server with CI/CD and Kanban. All files in the /opt/onedev/sites/ directory are exposed and can be read by unauthenticated users. This directory contains all projects, including their bare git repos and build artifacts. This file disclosure vulnerability can be used by unauthenticated attackers to leak all project files of any project. Since project IDs are incremental, an attacker could iterate through them and leak all project data. This issue has been resolved in version 7.3.0 and users are advised to upgrade. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-13T19:15:13.283",
    "last_modified": "2024-11-21T07:17:47.353",
    "fix_date": "2022-05-30T12:58:18Z"
  },
  "references": [
    {
      "url": "https://blog.sonarsource.com/onedev-remote-code-execution/",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/theonedev/onedev/commit/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/theonedev/onedev/security/advisories/GHSA-h427-rv56-c9h2",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blog.sonarsource.com/onedev-remote-code-execution/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/theonedev/onedev/commit/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/theonedev/onedev/security/advisories/GHSA-h427-rv56-c9h2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.110014",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "onedev",
    "owner": "theonedev",
    "created_at": "2018-11-06T02:57:01Z",
    "updated_at": "2025-01-14T10:30:38Z",
    "pushed_at": "2025-01-11T23:54:59Z",
    "size": 226316,
    "stars": 13579,
    "forks": 872,
    "open_issues": 0,
    "watchers": 13579,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Java": 11067283,
      "JavaScript": 730260,
      "HTML": 381307,
      "CSS": 180682,
      "Shell": 116784,
      "ANTLR": 46591,
      "Smarty": 17174,
      "Python": 5761,
      "Mustache": 3983,
      "Dockerfile": 125
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:48:17.966345"
  }
}