{
  "cve_id": "CVE-2022-39209",
  "github_data": {
    "repository": "github/cmark-gfm",
    "fix_commit": "9d57d8a23142b316282bdfc954cb0ecda40a8655",
    "related_commits": [
      "9d57d8a23142b316282bdfc954cb0ecda40a8655",
      "9d57d8a23142b316282bdfc954cb0ecda40a8655"
    ],
    "patch_url": "https://github.com/github/cmark-gfm/commit/9d57d8a23142b316282bdfc954cb0ecda40a8655.patch",
    "fix_commit_details": {
      "sha": "9d57d8a23142b316282bdfc954cb0ecda40a8655",
      "commit_date": "2022-09-14T20:56:39Z",
      "author": {
        "login": "anticomputer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-cgh3-p57x-9q7q",
        "length": 57,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 38,
        "additions": 33,
        "deletions": 5
      },
      "files": [
        {
          "filename": "CMakeLists.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -4,7 +4,7 @@ project(cmark-gfm)\n set(PROJECT_VERSION_MAJOR 0)\n set(PROJECT_VERSION_MINOR 29)\n set(PROJECT_VERSION_PATCH 0)\n-set(PROJECT_VERSION_GFM 5)\n+set(PROJECT_VERSION_GFM 6)\n set(PROJECT_VERSION ${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}.${PROJECT_VERSION_PATCH}.gfm.${PROJECT_VERSION_GFM})\n \n include(\"FindAsan.cmake\")"
        },
        {
          "filename": "changelog.txt",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1,3 +1,6 @@\n+[0.29.0.gfm.6]\n+  * Fixed polynomial time complexity DoS vulnerability in autolink extension\n+  \n [0.29.0.gfm.5]\n   * Added xmpp: and mailto: support to the autolink extension\n "
        },
        {
          "filename": "src/inlines.c",
          "status": "modified",
          "additions": 29,
          "deletions": 4,
          "patch": "@@ -41,6 +41,8 @@ typedef struct bracket {\n   bool image;\n   bool active;\n   bool bracket_after;\n+  bool in_bracket_image0;\n+  bool in_bracket_image1;\n } bracket;\n \n typedef struct subject{\n@@ -516,6 +518,8 @@ static void push_bracket(subject *subj, bool image, cmark_node *inl_text) {\n   bracket *b = (bracket *)subj->mem->calloc(1, sizeof(bracket));\n   if (subj->last_bracket != NULL) {\n     subj->last_bracket->bracket_after = true;\n+    b->in_bracket_image0 = subj->last_bracket->in_bracket_image0;\n+    b->in_bracket_image1 = subj->last_bracket->in_bracket_image1;\n   }\n   b->image = image;\n   b->active = true;\n@@ -524,6 +528,11 @@ static void push_bracket(subject *subj, bool image, cmark_node *inl_text) {\n   b->previous_delimiter = subj->last_delim;\n   b->position = subj->pos;\n   b->bracket_after = false;\n+  if (image) {\n+    b->in_bracket_image1 = true;\n+  } else {\n+    b->in_bracket_image0 = true;\n+  }\n   subj->last_bracket = b;\n }\n \n@@ -1254,6 +1263,17 @@ static cmark_node *handle_close_bracket(cmark_parser *parser, subject *subj) {\n       }\n       opener = opener->previous;\n     }\n+    bool in_bracket_image1 = false;\n+    if (opener) {\n+      in_bracket_image1 = opener->in_bracket_image1;\n+    }\n+    bracket *opener2 = subj->last_bracket;\n+    while (opener2 != opener) {\n+      if (opener2->image) {\n+        opener2->in_bracket_image1 = in_bracket_image1;\n+      }\n+      opener2 = opener2->previous;\n+    }\n   }\n \n   return NULL;\n@@ -1662,10 +1682,15 @@ cmark_chunk *cmark_inline_parser_get_chunk(cmark_inline_parser *parser) {\n }\n \n int cmark_inline_parser_in_bracket(cmark_inline_parser *parser, int image) {\n-  for (bracket *b = parser->last_bracket; b; b = b->previous)\n-    if (b->active && b->image == (image != 0))\n-      return 1;\n-  return 0;\n+  bracket *b = parser->last_bracket;\n+  if (!b) {\n+    return 0;\n+  }\n+  if (image != 0) {\n+    return b->in_bracket_image1;\n+  } else {\n+    return b->in_bracket_image0;\n+  }\n }\n \n void cmark_node_unput(cmark_node *node, int n) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "587a12bb54d95ac37241377e6ddc93ea0e45439b",
            "date": "2023-07-21T15:19:43Z",
            "author_login": "anticomputer"
          },
          {
            "sha": "808bcfbac333d7e82d528d69aaaa33e184921eea",
            "date": "2023-07-20T16:19:53Z",
            "author_login": "anticomputer"
          },
          {
            "sha": "63dd7b72e0b785a967cb2f760e22e4e5e45bcd4b",
            "date": "2023-07-20T16:15:27Z",
            "author_login": "anticomputer"
          },
          {
            "sha": "c123e68e81725d59f30d5a9bee719125538a6c77",
            "date": "2023-07-20T16:14:55Z",
            "author_login": "anticomputer"
          },
          {
            "sha": "049a6e389c8fe2cd75f9b2217411520d85b368d9",
            "date": "2023-07-20T16:14:28Z",
            "author_login": "anticomputer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "cmark-gfm is GitHub's fork of cmark, a CommonMark parsing and rendering library and program in C. In versions prior to 0.29.0.gfm.6 a polynomial time complexity issue in cmark-gfm's autolink extension may lead to unbounded resource exhaustion and subsequent denial of service. Users may verify the patch by running `python3 -c 'print(\"![l\"* 100000 + \"\\n\")' | ./cmark-gfm -e autolink`, which will resource exhaust on unpatched cmark-gfm but render correctly on patched cmark-gfm. This vulnerability has been patched in 0.29.0.gfm.6. Users are advised to upgrade. Users unable to upgrade should disable the use of the autolink extension.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-15T18:15:12.260",
    "last_modified": "2024-11-21T07:17:47.487",
    "fix_date": "2022-09-14T20:56:39Z"
  },
  "references": [
    {
      "url": "https://en.wikipedia.org/wiki/Time_complexity",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/cmark-gfm/commit/9d57d8a23142b316282bdfc954cb0ecda40a8655",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/cmark-gfm/security/advisories/GHSA-cgh3-p57x-9q7q",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JIUCZN3PEKUCT2JQYQTYOVIJG2KSD6G7/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JMGP65NANDVKPDMXMKYO2ZV2H2HZJY4P/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UEAAAI4OULDYQ2TA3HOXH54PC3DCBFZS/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://en.wikipedia.org/wiki/Time_complexity",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/cmark-gfm/commit/9d57d8a23142b316282bdfc954cb0ecda40a8655",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/github/cmark-gfm/security/advisories/GHSA-cgh3-p57x-9q7q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JIUCZN3PEKUCT2JQYQTYOVIJG2KSD6G7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JMGP65NANDVKPDMXMKYO2ZV2H2HZJY4P/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/UEAAAI4OULDYQ2TA3HOXH54PC3DCBFZS/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.119861",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cmark-gfm",
    "owner": "github",
    "created_at": "2016-12-01T01:48:24Z",
    "updated_at": "2025-01-14T11:42:47Z",
    "pushed_at": "2024-08-19T05:13:47Z",
    "size": 6144,
    "stars": 919,
    "forks": 176,
    "open_issues": 121,
    "watchers": 919,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 768727,
      "C++": 201370,
      "Python": 50409,
      "CMake": 22945,
      "XSLT": 11938,
      "Racket": 8625,
      "Makefile": 7169,
      "Shell": 899,
      "Dockerfile": 820,
      "Perl": 525,
      "Ruby": 316,
      "Batchfile": 294,
      "JavaScript": 102
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:04:16.445615"
  }
}