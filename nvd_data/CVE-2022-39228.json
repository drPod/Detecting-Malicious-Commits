{
  "cve_id": "CVE-2022-39228",
  "github_data": {
    "repository": "vantage6/vantage6",
    "fix_commit": "ab4381c35d24add06f75d5a8a284321f7a340bd2",
    "related_commits": [
      "ab4381c35d24add06f75d5a8a284321f7a340bd2",
      "ab4381c35d24add06f75d5a8a284321f7a340bd2"
    ],
    "patch_url": "https://github.com/vantage6/vantage6/commit/ab4381c35d24add06f75d5a8a284321f7a340bd2.patch",
    "fix_commit_details": {
      "sha": "ab4381c35d24add06f75d5a8a284321f7a340bd2",
      "commit_date": "2023-02-28T10:45:37Z",
      "author": {
        "login": "frankcorneliusmartin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-36gx-9q6h-g429",
        "length": 114,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 529,
        "additions": 372,
        "deletions": 157
      },
      "files": [
        {
          "filename": "vantage6-server/vantage6/server/mail_service.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -20,7 +20,7 @@ def send_async_email(self, app, msg):\n         with app.app_context():\n             try:\n                 self.mail.send(msg)\n-            except ConnectionRefusedError as e:\n+            except Exception as e:\n                 log.error(\"Mailserver error!\")\n                 log.debug(e)\n "
        },
        {
          "filename": "vantage6-server/vantage6/server/model/user.py",
          "status": "modified",
          "additions": 1,
          "deletions": 5,
          "patch": "@@ -130,11 +130,7 @@ def is_blocked(self, max_failed_attempts: int,\n         if has_max_attempts and td_last_login < td_max_blocked:\n             minutes_remaining = \\\n                 (td_max_blocked - td_last_login).seconds // 60 + 1\n-            return True, (\n-                f\"Your account is blocked for the next {minutes_remaining} \"\n-                \"minutes due to failed login attempts. Please wait or \"\n-                \"reactivate your account via email.\"\n-            )\n+            return True, minutes_remaining\n         else:\n             return False, None\n "
        },
        {
          "filename": "vantage6-server/vantage6/server/resource/token.py",
          "status": "modified",
          "additions": 59,
          "deletions": 4,
          "patch": "@@ -2,13 +2,12 @@\n \"\"\"\n Resources below '/<api_base>/token'\n \"\"\"\n-from __future__ import print_function, unicode_literals\n-\n import logging\n+import datetime as dt\n import pyotp\n \n from typing import Union\n-from flask import request, g\n+from flask import request, g, render_template\n from flask_jwt_extended import (\n     jwt_required,\n     create_access_token,\n@@ -166,6 +165,62 @@ def post(self):\n         log.info(f\"Succesfull login from {username}\")\n         return ret, HTTPStatus.OK, {'jwt-token': token}\n \n+    def user_login(self, username: str, password: str) -> Union[dict, db.User]:\n+        \"\"\"Returns user a message in case of failed login attempt.\"\"\"\n+        log.info(f\"Trying to login '{username}'\")\n+        failed_login_msg = \"Failed to login\"\n+        if db.User.username_exists(username):\n+            user = db.User.get_by_username(username)\n+            pw_policy = self.config.get('password_policy', {})\n+            max_failed_attempts = pw_policy.get('max_failed_attempts', 5)\n+            inactivation_time = pw_policy.get('inactivation_minutes', 15)\n+\n+            is_blocked, min_rem = user.is_blocked(max_failed_attempts,\n+                                                  inactivation_time)\n+            if is_blocked:\n+                self.notify_user_blocked(user, max_failed_attempts, min_rem)\n+                return {\"msg\": failed_login_msg}, HTTPStatus.UNAUTHORIZED\n+            elif user.check_password(password):\n+                user.failed_login_attempts = 0\n+                user.save()\n+                return user, HTTPStatus.OK\n+            else:\n+                # update the number of failed login attempts\n+                user.failed_login_attempts = 1 \\\n+                    if (\n+                        not user.failed_login_attempts or\n+                        user.failed_login_attempts >= max_failed_attempts\n+                    ) else user.failed_login_attempts + 1\n+                user.last_login_attempt = dt.datetime.now()\n+                user.save()\n+\n+        return {\"msg\": failed_login_msg}, HTTPStatus.UNAUTHORIZED\n+\n+    def notify_user_blocked(self, user: db.User, max_n_attempts: int,\n+                            min_rem: int) -> None:\n+        \"\"\"Sends an email to the user when his or her account is locked\"\"\"\n+        if not user.email:\n+            log.warning(f'User {user.username} is locked, but does not have'\n+                        'an email registered. So no message has been sent.')\n+\n+        log.info(f'User {user.username} is locked')\n+\n+        template_vars = {'firstname': user.firstname,\n+                         'number_of_allowed_attempts': max_n_attempts,\n+                         'ip': request.access_route[-1],\n+                         'time': dt.datetime.now(dt.timezone.utc),\n+                         'time_remaining': min_rem}\n+\n+        self.mail.send_email(\n+            \"Your account has been temporary suspended\",\n+            sender=\"support@vantage6.ai\",\n+            recipients=[user.email],\n+            text_body=render_template(\"mail/blocked_account.txt\",\n+                                      **template_vars),\n+            html_body=render_template(\"mail/blocked_account.html\",\n+                                      **template_vars)\n+        )\n+\n     @staticmethod\n     def validate_2fa_token(user: User, mfa_code: Union[int, str]) -> bool:\n         \"\"\"\n@@ -197,7 +252,7 @@ def post(self):\n         ---\n         description: >-\n           Allows node to sign in using a unique API key. If the login is\n-          successful this returns a dictionairy with access and refresh tokens\n+          successful this returns a dictionary with access and refresh tokens\n           for the node as well as a node_url and a refresh_url.\n \n         requestBody:"
        },
        {
          "filename": "vantage6-server/vantage6/server/templates/mail/blocked_account.html",
          "status": "added",
          "additions": 157,
          "deletions": 0,
          "patch": "@@ -0,0 +1,157 @@\n+<!--\n+\tHTML Email Starter Kit\n+\tDocumentation: https://github.com/timothylong/html-email-starter-kit\n+-->\n+<!DOCTYPE html>\n+<html>\n+    <head>\n+        <meta charset=\"UTF-8\">\n+        <meta name=\"viewport\" content=\"width=device-width\" initial-scale=\"1\">\n+        <!--[if !mso]>\n+            <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n+        <![endif]-->\n+        <meta name=\"x-apple-disable-message-reformatting\">\n+        <title></title>\n+        <!--[if mso]>\n+            <style>\n+                * { font-family: sans-serif !important; }\n+            </style>\n+        <![endif]-->\n+        <!--[if !mso]><!-->\n+            <!-- Insert font reference, e.g. <link href=\"https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700\" rel=\"stylesheet\"> -->\n+        <!--<![endif]-->\n+        <style>\n+            *,\n+            *:after,\n+            *:before {\n+                -webkit-box-sizing: border-box;\n+                -moz-box-sizing: border-box;\n+                box-sizing: border-box;\n+            }\n+            * {\n+                -ms-text-size-adjust: 100%;\n+                -webkit-text-size-adjust: 100%;\n+            }\n+            html,\n+            body,\n+            .document {\n+                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n+                font-size: 1.05em;\n+                width: 100% !important;\n+                height: 100% !important;\n+                margin: 0;\n+                padding: 0;\n+            }\n+            body {\n+                -webkit-font-smoothing: antialiased;\n+                -moz-osx-font-smoothing: grayscale;\n+                text-rendering: optimizeLegibility;\n+            }\n+            div[style*=\"margin: 16px 0\"] {\n+                margin: 0 !important;\n+            }\n+            table,\n+            td {\n+                mso-table-lspace: 0pt;\n+                mso-table-rspace: 0pt;\n+            }\n+            table {\n+                border-spacing: 0;\n+                border-collapse: collapse;\n+                table-layout: fixed;\n+                margin: 0 auto;\n+            }\n+            img {\n+                -ms-interpolation-mode: bicubic;\n+                max-width: 100%;\n+                border: 0;\n+            }\n+            *[x-apple-data-detectors] {\n+                color: inherit !important;\n+                text-decoration: none !important;\n+            }\n+            .x-gmail-data-detectors,\n+            .x-gmail-data-detectors *,\n+            .aBn {\n+                border-bottom: 0 !important;\n+                cursor: default !important;\n+            }\n+            .btn {\n+                -webkit-transition: all 200ms ease;\n+                transition: all 200ms ease;\n+            }\n+            .btn:hover {\n+                background-color: dodgerblue;\n+            }\n+            @media screen and (max-width: 750px) {\n+                .container {\n+                    width: 100%;\n+                    margin: auto;\n+                }\n+                .stack {\n+                    display: block;\n+                    width: 100%;\n+                    max-width: 100%;\n+                }\n+            }\n+        </style>\n+    </head>\n+    <body>\n+        <div style=\"display: none; max-height: 0px; overflow: hidden;\">\n+            <!-- Preheader message here -->\n+        </div>\n+        <div style=\"display: none; max-height: 0px; overflow: hidden;\">&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;</div>\n+        <table style=\"background-color: #fff;\" role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" class=\"document\">\n+            <tr>\n+                <td valign=\"top\">\n+                    <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"750\" class=\"container\">\n+                        <tr>\n+                            <td>\n+                                <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"100%\">\n+                                    <tr>\n+                                        <td width=250></td>\n+                                        <td style=\"padding:20px;\">\n+                                            <img src=\"https://raw.githubusercontent.com/IKNL/guidelines/master/resources/logos/vantage6.png\" width=250>\n+                                        </td>\n+                                        <td width=250></td>\n+                                    </tr>\n+                                    <tr style=\"background-color:#f9f9f9;\" width=\"100%\">\n+                                        <td colspan=3 style=\"padding:40px; color:#0f497b;\">\n+\n+                                            Dear <strong>{{firstname}}</strong>,\n+\n+                                            <p>\n+                                                After {{number_of_allowed_attempts}} failed login attempts your user account has been blocked.<br/>\n+                                                <ul>\n+                                                    <li>Source IP: {{ip}}</li>\n+                                                    <li>Last attempt at: {{time}} (UTC)</li>\n+                                                </ul>\n+                                            </p>\n+                                            <p>\n+                                                Your account will be unlocked in {{time_remaining}} minutes. Please wait or reactivate your account via email.\n+                                            </p>\n+                                            <p>Sincerely, <br/>vantage6 Support Team</p>\n+                                        </td>\n+                                    </tr>\n+                                </table>\n+                            </td>\n+                        </tr>\n+                    </table>\n+                    <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"750\" class=\"container\">\n+                        <tr style=\"font-size: .6em;\">\n+                            <td style=\"padding-top:20px; padding-bottom: 20px;\">\n+                                <a style=\"color:#0f497b; font-weight: bold;\" href=\"https://vantage6.ai\">vantage6.ai</a>\n+                            </td>\n+                            <td style=\"padding-top:20px; padding-bottom: 20px;text-align: center;\">\n+                                <a style=\"color:#0f497b; font-weight: bold;\" href=\"https://discord.gg/yAyFf6Y\">Join our Discord channel</a>\n+                            </td >\n+                            <td style=\"padding-top:20px; padding-bottom: 20px;text-align: right;\">\n+                                <a style=\"color:#0f497b; font-weight: bold;\" href=\"mailto:support@vantage6.ai\">support@vantage6.ai</a>\n+                            </td>\n+                        </tr>\n+                    </table>\n+                </td>\n+            </tr>\n+        </table>\n+    </body>\n+</html>\n\\ No newline at end of file"
        },
        {
          "filename": "vantage6-server/vantage6/server/templates/mail/blocked_account.txt",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+Dear {{firstname}},\n+\n+After {{number_of_allowed_attempts}} failed login attempts your user account has been blocked.\n+\n+Source IP: {{ip}}\n+Last attempt at: {{time}} (UTC)\n+\n+Your account will be unlocked in {{time_remaining}} minutes. Please wait or reactivate your account via email.\n+\n+Sincerely, vantage6 Support Team\n\\ No newline at end of file"
        },
        {
          "filename": "vantage6-server/vantage6/server/templates/mail/reset_token.html",
          "status": "modified",
          "additions": 144,
          "deletions": 147,
          "patch": "@@ -4,155 +4,152 @@\n -->\n <!DOCTYPE html>\n <html>\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width\" initial-scale=\"1\">\n-    <!--[if !mso]>\n-        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n-    <![endif]-->\n-    <meta name=\"x-apple-disable-message-reformatting\">\n-    <title></title>\n-    <!--[if mso]>\n+    <head>\n+        <meta charset=\"UTF-8\">\n+        <meta name=\"viewport\" content=\"width=device-width\" initial-scale=\"1\">\n+        <!--[if !mso]>\n+            <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n+        <![endif]-->\n+        <meta name=\"x-apple-disable-message-reformatting\">\n+        <title></title>\n+        <!--[if mso]>\n+            <style>\n+                * { font-family: sans-serif !important; }\n+            </style>\n+        <![endif]-->\n+        <!--[if !mso]><!-->\n+            <!-- Insert font reference, e.g. <link href=\"https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700\" rel=\"stylesheet\"> -->\n+        <!--<![endif]-->\n         <style>\n-            * { font-family: sans-serif !important; }\n-        </style>\n-    <![endif]-->\n-    <!--[if !mso]><!-->\n-        <!-- Insert font reference, e.g. <link href=\"https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700\" rel=\"stylesheet\"> -->\n-    <!--<![endif]-->\n-    <style>\n-        *,\n-        *:after,\n-        *:before {\n-            -webkit-box-sizing: border-box;\n-            -moz-box-sizing: border-box;\n-            box-sizing: border-box;\n-        }\n-        * {\n-            -ms-text-size-adjust: 100%;\n-            -webkit-text-size-adjust: 100%;\n-        }\n-        html,\n-        body,\n-        .document {\n-            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n-            font-size: 1.05em;\n-            width: 100% !important;\n-            height: 100% !important;\n-            margin: 0;\n-            padding: 0;\n-        }\n-        body {\n-            -webkit-font-smoothing: antialiased;\n-            -moz-osx-font-smoothing: grayscale;\n-            text-rendering: optimizeLegibility;\n-        }\n-        div[style*=\"margin: 16px 0\"] {\n-            margin: 0 !important;\n-        }\n-        table,\n-        td {\n-            mso-table-lspace: 0pt;\n-            mso-table-rspace: 0pt;\n-        }\n-        table {\n-            border-spacing: 0;\n-            border-collapse: collapse;\n-            table-layout: fixed;\n-            margin: 0 auto;\n-        }\n-        img {\n-            -ms-interpolation-mode: bicubic;\n-            max-width: 100%;\n-            border: 0;\n-        }\n-        *[x-apple-data-detectors] {\n-            color: inherit !important;\n-            text-decoration: none !important;\n-        }\n-        .x-gmail-data-detectors,\n-        .x-gmail-data-detectors *,\n-        .aBn {\n-            border-bottom: 0 !important;\n-            cursor: default !important;\n-        }\n-        .btn {\n-            -webkit-transition: all 200ms ease;\n-            transition: all 200ms ease;\n-        }\n-        .btn:hover {\n-            background-color: dodgerblue;\n-        }\n-        @media screen and (max-width: 750px) {\n-            .container {\n-                width: 100%;\n-                margin: auto;\n+            *,\n+            *:after,\n+            *:before {\n+                -webkit-box-sizing: border-box;\n+                -moz-box-sizing: border-box;\n+                box-sizing: border-box;\n+            }\n+            * {\n+                -ms-text-size-adjust: 100%;\n+                -webkit-text-size-adjust: 100%;\n+            }\n+            html,\n+            body,\n+            .document {\n+                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n+                font-size: 1.05em;\n+                width: 100% !important;\n+                height: 100% !important;\n+                margin: 0;\n+                padding: 0;\n+            }\n+            body {\n+                -webkit-font-smoothing: antialiased;\n+                -moz-osx-font-smoothing: grayscale;\n+                text-rendering: optimizeLegibility;\n+            }\n+            div[style*=\"margin: 16px 0\"] {\n+                margin: 0 !important;\n+            }\n+            table,\n+            td {\n+                mso-table-lspace: 0pt;\n+                mso-table-rspace: 0pt;\n+            }\n+            table {\n+                border-spacing: 0;\n+                border-collapse: collapse;\n+                table-layout: fixed;\n+                margin: 0 auto;\n             }\n-            .stack {\n-                display: block;\n-                width: 100%;\n+            img {\n+                -ms-interpolation-mode: bicubic;\n                 max-width: 100%;\n+                border: 0;\n             }\n-        }\n-        /* #11B5E9; light blue\n-        #0f497b; Dark blue\n-        #f9f9f9; White\n-        #f9ac23; Orange\n-        #aabfce; Light grey? */\n-    </style>\n-</head>\n-<body>\n-    <div style=\"display: none; max-height: 0px; overflow: hidden;\">\n-        <!-- Preheader message here -->\n-    </div>\n-    <div style=\"display: none; max-height: 0px; overflow: hidden;\">&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;</div>\n-    <table style=\"background-color: #fff;\" role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" class=\"document\">\n-        <tr>\n-            <td valign=\"top\">\n-                <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"750\" class=\"container\">\n-                    <tr>\n-                        <td>\n-                            <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"100%\">\n-                                <tr>\n-                                    <td width=250></td>\n-                                    <td style=\"padding:20px;\">\n-                                        <img src=\"https://raw.githubusercontent.com/IKNL/guidelines/master/resources/logos/vantage6.png\" width=250>\n-                                    </td>\n-                                    <td width=250></td>\n-                                </tr>\n-                                <tr style=\"background-color:#f9f9f9;\" width=\"100%\">\n-                                    <td colspan=3 style=\"padding:40px; color:#0f497b;\">\n-\n-                                        Dear <strong>{{firstname}}</strong>,\n-\n-                                        <p>To reset your {{reset_type}} use the following token:</p>\n-                                        <p style=\"font-family: 'Courier New', Courier, monospace; font-size: 12px; overflow-wrap:break-word;padding:10px; color: white; background-color: #0f497b;\">\n-                                            {{token}}\n-                                        </p>\n-                                        <p>If you have not requested a {{reset_type}} reset, {{what_to_do}}.</p>\n-                                        <p>Sincerely, <br/>vantage6 Support Team</p>\n-                                    </td>\n-                                </tr>\n-                            </table>\n-                        </td>\n-                    </tr>\n-                </table>\n-                <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"750\" class=\"container\">\n-                    <tr style=\"font-size: .6em;\">\n-                        <td style=\"padding-top:20px; padding-bottom: 20px;\">\n-                            <a style=\"color:#0f497b; font-weight: bold;\" href=\"https://vantage6.ai\">vantage6.ai</a>\n-                        </td>\n-                        <td style=\"padding-top:20px; padding-bottom: 20px;text-align: center;\">\n-                            <a style=\"color:#0f497b; font-weight: bold;\" href=\"https://discord.gg/yAyFf6Y\">Join our Discord channel</a>\n-                        </td >\n-                        <td style=\"padding-top:20px; padding-bottom: 20px;text-align: right;\">\n-                            <a style=\"color:#0f497b; font-weight: bold;\" href=\"mailto:{{support_email}}\">{{support_email}}</a>\n-                        </td>\n-                    </tr>\n-\n-                </table>\n-            </td>\n-        </tr>\n-    </table>\n-</body>\n+            *[x-apple-data-detectors] {\n+                color: inherit !important;\n+                text-decoration: none !important;\n+            }\n+            .x-gmail-data-detectors,\n+            .x-gmail-data-detectors *,\n+            .aBn {\n+                border-bottom: 0 !important;\n+                cursor: default !important;\n+            }\n+            .btn {\n+                -webkit-transition: all 200ms ease;\n+                transition: all 200ms ease;\n+            }\n+            .btn:hover {\n+                background-color: dodgerblue;\n+            }\n+            @media screen and (max-width: 750px) {\n+                .container {\n+                    width: 100%;\n+                    margin: auto;\n+                }\n+                .stack {\n+                    display: block;\n+                    width: 100%;\n+                    max-width: 100%;\n+                }\n+            }\n+            /* #11B5E9; light blue\n+            #0f497b; Dark blue\n+            #f9f9f9; White\n+            #f9ac23; Orange\n+            #aabfce; Light grey? */\n+        </style>\n+    </head>\n+    <body>\n+        <div style=\"display: none; max-height: 0px; overflow: hidden;\">\n+            <!-- Preheader message here -->\n+        </div>\n+        <div style=\"display: none; max-height: 0px; overflow: hidden;\">&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;&zwnj;&nbsp;</div>\n+        <table style=\"background-color: #fff;\" role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" class=\"document\">\n+            <tr>\n+                <td valign=\"top\">\n+                    <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"750\" class=\"container\">\n+                        <tr>\n+                            <td>\n+                                <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"100%\">\n+                                    <tr>\n+                                        <td width=250></td>\n+                                        <td style=\"padding:20px;\">\n+                                            <img src=\"https://raw.githubusercontent.com/IKNL/guidelines/master/resources/logos/vantage6.png\" width=250>\n+                                        </td>\n+                                        <td width=250></td>\n+                                    </tr>\n+                                    <tr style=\"background-color:#f9f9f9;\" width=\"100%\">\n+                                        <td colspan=3 style=\"padding:40px; color:#0f497b;\">\n+                                            Dear <strong>{{firstname}}</strong>,\n+                                            <p>To reset your {{reset_type}} use the following token:</p>\n+                                            <p style=\"font-family: 'Courier New', Courier, monospace; font-size: 12px; overflow-wrap:break-word;padding:10px; color: white; background-color: #0f497b;\">\n+                                                {{token}}\n+                                            </p>\n+                                            <p>If you have not requested a {{reset_type}} reset, {{what_to_do}}.</p>\n+                                            <p>Sincerely, <br/>vantage6 Support Team</p>\n+                                        </td>\n+                                    </tr>\n+                                </table>\n+                            </td>\n+                        </tr>\n+                    </table>\n+                    <table role=\"presentation\" aria-hidden=\"true\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" align=\"center\" width=\"750\" class=\"container\">\n+                        <tr style=\"font-size: .6em;\">\n+                            <td style=\"padding-top:20px; padding-bottom: 20px;\">\n+                                <a style=\"color:#0f497b; font-weight: bold;\" href=\"https://vantage6.ai\">vantage6.ai</a>\n+                            </td>\n+                            <td style=\"padding-top:20px; padding-bottom: 20px;text-align: center;\">\n+                                <a style=\"color:#0f497b; font-weight: bold;\" href=\"https://discord.gg/yAyFf6Y\">Join our Discord channel</a>\n+                            </td >\n+                            <td style=\"padding-top:20px; padding-bottom: 20px;text-align: right;\">\n+                                <a style=\"color:#0f497b; font-weight: bold;\" href=\"mailto:{{support_email}}\">{{support_email}}</a>\n+                            </td>\n+                        </tr>\n+                    </table>\n+                </td>\n+            </tr>\n+        </table>\n+    </body>\n </html>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7e08264dea67e84b35594893953001e8ea147d90",
            "date": "2025-01-09T16:31:08Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "c30ae94a7a4e5fda8eee9a937b26ff46c029109d",
            "date": "2024-12-13T09:10:55Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "7467646f458f773d0ee6aae6803682e1752a13f7",
            "date": "2024-12-13T08:54:45Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "4100ab5536ed2a5c675d6593cbebd8d98b4e5e14",
            "date": "2024-12-13T08:30:46Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "943a486a2e61185642fa75a0f55d24b776048838",
            "date": "2024-12-13T08:21:53Z",
            "author_login": "invalid-email-address"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-203",
    "description": "vantage6 is a privacy preserving federated learning infrastructure for secure insight exchange. vantage6 does not inform the user of wrong username/password combination if the username actually exists. This is an attempt to prevent bots from obtaining usernames. However, if a wrong password is entered a number of times, the user account is blocked temporarily. This issue has been fixed in version 3.8.0.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-01T17:15:10.980",
    "last_modified": "2024-11-21T07:17:49.883",
    "fix_date": "2023-02-28T10:45:37Z"
  },
  "references": [
    {
      "url": "https://github.com/vantage6/vantage6/commit/ab4381c35d24add06f75d5a8a284321f7a340bd2",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/issues/59",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/pull/281",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-36gx-9q6h-g429",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/commit/ab4381c35d24add06f75d5a8a284321f7a340bd2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/issues/59",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/pull/281",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-36gx-9q6h-g429",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.790750",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "vantage6",
    "owner": "vantage6",
    "created_at": "2022-05-16T12:09:26Z",
    "updated_at": "2025-01-09T16:31:14Z",
    "pushed_at": "2025-01-14T13:14:06Z",
    "size": 44880,
    "stars": 31,
    "forks": 11,
    "open_issues": 248,
    "watchers": 31,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 1919355,
      "TypeScript": 526976,
      "HTML": 209327,
      "SCSS": 20209,
      "Makefile": 12871,
      "Dockerfile": 9054,
      "Jinja": 5974,
      "Shell": 4282,
      "JavaScript": 802
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:50:50.846103"
  }
}