{
  "cve_id": "CVE-2022-39268",
  "github_data": {
    "repository": "orchest/orchest",
    "fix_commit": "c2587a963cca742c4a2503bce4cfb4161bf64c2d",
    "related_commits": [
      "c2587a963cca742c4a2503bce4cfb4161bf64c2d",
      "c2587a963cca742c4a2503bce4cfb4161bf64c2d"
    ],
    "patch_url": "https://github.com/orchest/orchest/commit/c2587a963cca742c4a2503bce4cfb4161bf64c2d.patch",
    "fix_commit_details": {
      "sha": "c2587a963cca742c4a2503bce4cfb4161bf64c2d",
      "commit_date": "2022-09-30T13:24:32Z",
      "author": {
        "login": "fruttasecca",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Set auth cookies to SameSite=Lax",
        "length": 32,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 5,
        "deletions": 4
      },
      "files": [
        {
          "filename": "services/auth-server/app/app/views.py",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -114,8 +114,8 @@ def index() -> Tuple[Literal[\"\"], Literal[200]] | Tuple[Literal[\"\"], Literal[401\n     @app.route(\"/login/clear\", methods=[\"GET\"])\n     def logout() -> Response | None:\n         resp = redirect_response(\"/\")\n-        resp.set_cookie(\"auth_token\", \"\")\n-        resp.set_cookie(\"auth_username\", \"\")\n+        resp.set_cookie(\"auth_token\", \"\", samesite=\"Lax\")\n+        resp.set_cookie(\"auth_username\", samesite=\"Lax\")\n         return resp\n \n     def redirect_response(url: str, redirect_type: str = \"server\") -> Response:\n@@ -182,8 +182,9 @@ def handle_login(\n                     db.session.commit()\n \n                     resp = redirect_response(redirect_url, redirect_type)\n-                    resp.set_cookie(\"auth_token\", token.token)\n-                    resp.set_cookie(\"auth_username\", username)\n+                    # samesite=\"Lax\" to avoid CSRF attacks.\n+                    resp.set_cookie(\"auth_token\", token.token, samesite=\"Lax\")\n+                    resp.set_cookie(\"auth_username\", username, samesite=\"Lax\")\n \n                     return resp\n "
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "560103a5c7dbdf615a2e0df435076f0ee78b6a1d",
            "date": "2023-06-06T09:48:26Z",
            "author_login": "ricklamers"
          },
          {
            "sha": "3748b8f7fbbe1f805c67b4c4129c7f4dfdbf04ca",
            "date": "2023-06-06T08:44:32Z",
            "author_login": "ricklamers"
          },
          {
            "sha": "c7ea72e89e587fc296d651db0216dd88bc25e830",
            "date": "2023-06-06T08:44:22Z",
            "author_login": "ricklamers"
          },
          {
            "sha": "c814679813c900a8e8d8314ed55921ec4820b782",
            "date": "2023-06-06T08:43:55Z",
            "author_login": "ricklamers"
          },
          {
            "sha": "414dcc9cd778299799a26e75c7784ff8ead6bc2b",
            "date": "2023-06-06T08:43:26Z",
            "author_login": "ricklamers"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-352",
    "description": "### Impact In a CSRF attack, an innocent end user is tricked by an attacker into submitting a web request that they did not intend. This may cause actions to be performed on the website that can include inadvertent client or server data leakage, change of session state, or manipulation of an end user's account. ### Patch Upgrade to v2022.09.10 to patch this vulnerability. ### Workarounds Rebuild and redeploy the Orchest `auth-server` with this commit: https://github.com/orchest/orchest/commit/c2587a963cca742c4a2503bce4cfb4161bf64c2d ### References https://en.wikipedia.org/wiki/Cross-site_request_forgery https://cwe.mitre.org/data/definitions/352.html ### For more information If you have any questions or comments about this advisory: * Open an issue in https://github.com/orchest/orchest * Email us at rick@orchest.io",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-30T21:15:09.543",
    "last_modified": "2024-11-21T07:17:55.243",
    "fix_date": "2022-09-30T13:24:32Z"
  },
  "references": [
    {
      "url": "https://github.com/orchest/orchest/commit/c2587a963cca742c4a2503bce4cfb4161bf64c2d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/pull/1324",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/releases/tag/v2022.09.10",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/security/advisories/GHSA-q44f-8jpw-qv4j",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/commit/c2587a963cca742c4a2503bce4cfb4161bf64c2d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/pull/1324",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/releases/tag/v2022.09.10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/orchest/orchest/security/advisories/GHSA-q44f-8jpw-qv4j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:41.306985",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "orchest",
    "owner": "orchest",
    "created_at": "2020-05-21T17:33:05Z",
    "updated_at": "2025-01-13T15:09:00Z",
    "pushed_at": "2023-06-06T09:48:26Z",
    "size": 28488,
    "stars": 4099,
    "forks": 260,
    "open_issues": 129,
    "watchers": 4099,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "dev",
      "master"
    ],
    "languages": {
      "TypeScript": 1598203,
      "Python": 1596977,
      "Go": 218635,
      "Shell": 57623,
      "SCSS": 31092,
      "Dockerfile": 26608,
      "Jupyter Notebook": 15951,
      "JavaScript": 8013,
      "Smarty": 3340,
      "Makefile": 1529,
      "Mako": 1482,
      "HTML": 1099
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T19:15:18.127673"
  }
}