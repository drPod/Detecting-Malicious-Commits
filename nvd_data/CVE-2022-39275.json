{
  "cve_id": "CVE-2022-39275",
  "github_data": {
    "repository": "saleor/saleor",
    "fix_commit": "96e04c092ddcac17b14f2e31554aa02d9006d0ce",
    "related_commits": [
      "96e04c092ddcac17b14f2e31554aa02d9006d0ce",
      "96e04c092ddcac17b14f2e31554aa02d9006d0ce"
    ],
    "patch_url": "https://github.com/saleor/saleor/commit/96e04c092ddcac17b14f2e31554aa02d9006d0ce.patch",
    "fix_commit_details": {
      "sha": "96e04c092ddcac17b14f2e31554aa02d9006d0ce",
      "commit_date": "2022-10-03T12:04:47Z",
      "author": {
        "login": "NyanKiyoshi",
        "type": "User",
        "stats": {
          "total_commits": 203,
          "average_weekly_commits": 0.3258426966292135,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 84
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-xhq8-8c5v-w8ff",
        "length": 288,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "saleor/graphql/account/mutations/account.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -388,7 +388,7 @@ class Meta:\n \n     @classmethod\n     def perform_mutation(cls, _root, info, **data):\n-        address = cls.get_node_or_error(info, data.get(\"id\"), Address)\n+        address = cls.get_node_or_error(info, data.get(\"id\"), only_type=Address)\n         user = info.context.user\n \n         if not user.addresses.filter(pk=address.pk).exists():"
        },
        {
          "filename": "saleor/graphql/account/mutations/base.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -369,7 +369,7 @@ def perform_mutation(cls, _root, info, **data):\n             raise PermissionDenied()\n \n         node_id = data.get(\"id\")\n-        instance = cls.get_node_or_error(info, node_id, Address)\n+        instance = cls.get_node_or_error(info, node_id, only_type=Address)\n         if instance:\n             cls.clean_instance(info, instance)\n "
        },
        {
          "filename": "saleor/graphql/menu/mutations.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -514,7 +514,7 @@ class Meta:\n     def perform_mutation(cls, _root, info, navigation_type, menu=None):\n         site = load_site(info.context)\n         if menu is not None:\n-            menu = cls.get_node_or_error(info, menu, field=\"menu\")\n+            menu = cls.get_node_or_error(info, menu, field=\"menu\", only_type=Menu)\n \n         if navigation_type == NavigationType.MAIN:\n             site.settings.top_menu = menu"
        },
        {
          "filename": "saleor/graphql/product/bulk_mutations/products.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -547,7 +547,7 @@ def create_variant_stocks(cls, variant, cleaned_input):\n     @classmethod\n     @traced_atomic_transaction()\n     def perform_mutation(cls, _root, info, **data):\n-        product = cls.get_node_or_error(info, data[\"product_id\"], models.Product)\n+        product = cls.get_node_or_error(info, data[\"product_id\"], only_type=\"Product\")\n         errors = defaultdict(list)\n \n         cleaned_inputs = cls.clean_variants(info, data[\"variants\"], product, errors)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "486877e53e05c27b4691647d1e0e7cc0f47e91bf",
            "date": "2025-01-14T09:18:31Z",
            "author_login": "patrys"
          },
          {
            "sha": "23b8d28989445f33ed35363156a8b675eb610472",
            "date": "2025-01-13T12:06:01Z",
            "author_login": "patrys"
          },
          {
            "sha": "789e33510a4225f20a0ccc9634ff7b49bb9ca912",
            "date": "2025-01-13T14:36:25Z",
            "author_login": "korycins"
          },
          {
            "sha": "83efad25c0813b7b3fe2741781a263e22ff84e1a",
            "date": "2025-01-13T08:42:38Z",
            "author_login": "szczecha"
          },
          {
            "sha": "5f8b1cc4db2d54295193eb92d7b862164ce197ce",
            "date": "2025-01-10T13:13:49Z",
            "author_login": "korycins"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-863",
    "description": "Saleor is a headless, GraphQL commerce platform. In affected versions some GraphQL mutations were not properly checking the ID type input which allowed to access database objects that the authenticated user may not be allowed to access. This vulnerability can be used to expose the following information: Estimating database row counts from tables with a sequential primary key or Exposing staff user and customer email addresses and full name through the `assignNavigation()` mutation. This issue has been patched in main and backported to multiple releases (3.7.17, 3.6.18, 3.5.23, 3.4.24, 3.3.26, 3.2.14, 3.1.24). Users are advised to upgrade. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-10-06T18:16:17.087",
    "last_modified": "2024-11-21T07:17:56.167",
    "fix_date": "2022-10-03T12:04:47Z"
  },
  "references": [
    {
      "url": "https://github.com/saleor/saleor/commit/96e04c092ddcac17b14f2e31554aa02d9006d0ce",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saleor/saleor/security/advisories/GHSA-xhq8-8c5v-w8ff",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saleor/saleor/commit/96e04c092ddcac17b14f2e31554aa02d9006d0ce",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/saleor/saleor/security/advisories/GHSA-xhq8-8c5v-w8ff",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:41.312023",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "saleor",
    "owner": "saleor",
    "created_at": "2013-02-12T16:46:39Z",
    "updated_at": "2025-01-14T09:18:44Z",
    "pushed_at": "2025-01-14T13:41:59Z",
    "size": 264902,
    "stars": 20990,
    "forks": 5549,
    "open_issues": 341,
    "watchers": 20990,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "3.20"
    ],
    "languages": {
      "Python": 22045293,
      "HTML": 249642,
      "Dockerfile": 2521,
      "Shell": 439,
      "Makefile": 121
    },
    "commit_activity": {
      "total_commits_last_year": 715,
      "avg_commits_per_week": 13.75,
      "days_active_last_year": 208
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:42:28.369369"
  }
}