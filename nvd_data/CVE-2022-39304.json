{
  "cve_id": "CVE-2022-39304",
  "github_data": {
    "repository": "bradleyfalzon/ghinstallation",
    "fix_commit": "d24f14f8be70d94129d76026e8b0f4f9170c8c3e",
    "related_commits": [
      "d24f14f8be70d94129d76026e8b0f4f9170c8c3e",
      "d24f14f8be70d94129d76026e8b0f4f9170c8c3e"
    ],
    "patch_url": "https://github.com/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e.patch",
    "fix_commit_details": {
      "sha": "d24f14f8be70d94129d76026e8b0f4f9170c8c3e",
      "commit_date": "2021-03-08T18:28:58Z",
      "author": {
        "login": "andygrunwald",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add StatusCode to error message if refreshToken() fails due to an suspended app (#44)",
        "length": 166,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "transport.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -170,7 +170,7 @@ func (t *Transport) refreshToken(ctx context.Context) error {\n \tdefer resp.Body.Close()\n \n \tif resp.StatusCode/100 != 2 {\n-\t\treturn fmt.Errorf(\"request %+v received non 2xx response status %q with body %+v and TLS %+v\", resp.Request, resp.Body, resp.Request, resp.TLS)\n+\t\treturn fmt.Errorf(\"received non 2xx response status %q when fetching %v\", resp.Status, req.URL)\n \t}\n \n \treturn json.NewDecoder(resp.Body).Decode(&t.token)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f178ac52e7e866ed2c7c0d99da257b850d9c48eb",
            "date": "2025-01-01T17:18:48Z",
            "author_login": "chenrui333"
          },
          {
            "sha": "87c5aa0b1b80b288ac5db9103511ff82b198a56d",
            "date": "2025-01-07T18:33:09Z",
            "author_login": "chenrui333"
          },
          {
            "sha": "989f32e8c34e227bf32e445a8dbd4b03f7f16260",
            "date": "2025-01-03T05:28:30Z",
            "author_login": "chenrui333"
          },
          {
            "sha": "df52b44e5bff414ac3fd72185fcc33778b9f5a15",
            "date": "2025-01-03T05:14:54Z",
            "author_login": "chenrui333"
          },
          {
            "sha": "e9ad86aee655f509a297a5d0c22f95df62d76797",
            "date": "2024-12-16T16:38:29Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.0,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:L",
    "cwe_id": "CWE-209",
    "description": "ghinstallation provides transport, which implements http.RoundTripper to provide authentication as an installation for GitHub Apps. In ghinstallation version 1, when the request to refresh an installation token failed, the HTTP request and response would be returned for debugging. The request contained the bearer JWT for the App, and was returned back to clients. This token is short lived (10 minute maximum). This issue has been patched and is available in version 2.0.0.\n",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-20T20:15:10.043",
    "last_modified": "2024-11-21T07:17:59.710",
    "fix_date": "2021-03-08T18:28:58Z"
  },
  "references": [
    {
      "url": "https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-an-installation",
      "source": "security-advisories@github.com",
      "tags": [
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bradleyfalzon/ghinstallation/blob/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go#L172-L174",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bradleyfalzon/ghinstallation/security/advisories/GHSA-h4q8-96p6-jcgr",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://docs.github.com/en/developers/apps/building-github-apps/authenticating-with-github-apps#authenticating-as-an-installation",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bradleyfalzon/ghinstallation/blob/24e56b3fb7669f209134a01eff731d7e2ef72a5c/transport.go#L172-L174",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bradleyfalzon/ghinstallation/commit/d24f14f8be70d94129d76026e8b0f4f9170c8c3e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bradleyfalzon/ghinstallation/security/advisories/GHSA-h4q8-96p6-jcgr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.190486",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ghinstallation",
    "owner": "bradleyfalzon",
    "created_at": "2016-10-26T11:24:09Z",
    "updated_at": "2025-01-14T05:58:07Z",
    "pushed_at": "2025-01-11T02:35:27Z",
    "size": 112,
    "stars": 320,
    "forks": 101,
    "open_issues": 14,
    "watchers": 320,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Go": 31666
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T19:16:16.206625"
  }
}