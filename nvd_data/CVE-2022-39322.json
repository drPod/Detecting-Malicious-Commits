{
  "cve_id": "CVE-2022-39322",
  "github_data": {
    "repository": "keystonejs/keystone",
    "fix_commit": "65c6ee3deef23605fc72b80230908696a7a65e7c",
    "related_commits": [
      "65c6ee3deef23605fc72b80230908696a7a65e7c",
      "65c6ee3deef23605fc72b80230908696a7a65e7c"
    ],
    "patch_url": "https://github.com/keystonejs/keystone/commit/65c6ee3deef23605fc72b80230908696a7a65e7c.patch",
    "fix_commit_details": {
      "sha": "65c6ee3deef23605fc72b80230908696a7a65e7c",
      "commit_date": "2022-10-17T21:42:44Z",
      "author": {
        "login": "marekryb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix multiselect field type not propagating common config options (#8007)",
        "length": 206,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": ".changeset/two-ghosts-jog.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+'@keystone-6/core': patch\n+---\n+\n+Fixes the multiselect field type not using the provided `label`, `access`, `graphql`, `isFilterable` or `isOrderable` configuration options"
        },
        {
          "filename": "packages/core/src/fields/types/multiselect/index.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -52,7 +52,6 @@ const MIN_INT = -2147483648;\n \n export const multiselect =\n   <ListTypeInfo extends BaseListTypeInfo>({\n-    ui,\n     defaultValue = [],\n     ...config\n   }: MultiselectFieldConfig<ListTypeInfo>): FieldTypeFunc<ListTypeInfo> =>\n@@ -107,7 +106,7 @@ export const multiselect =\n     return jsonFieldTypePolyfilledForSQLite(\n       meta.provider,\n       {\n-        ui,\n+        ...config,\n         hooks: {\n           ...config.hooks,\n           async validateInput(args) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f610d86f410d52990c4711ef10eca6a0097a6391",
            "date": "2025-01-13T23:57:39Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "b080ac958f09b66024031434ca0b75bb3b4b86c5",
            "date": "2025-01-12T22:12:00Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "a554a85a588b958dc571680a4232df768629e375",
            "date": "2025-01-06T03:05:15Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "747a497c5d4718d494c36e80937f01b6f733c781",
            "date": "2024-12-30T23:19:17Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "56372cb1279dc5c8e7c125e82e23c6ff61250fff",
            "date": "2024-12-30T07:20:26Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-285",
    "description": "@keystone-6/core is a core package for Keystone 6, a content management system for Node.js. Starting with version 2.2.0 and prior to version 2.3.1, users who expected their `multiselect` fields to use the field-level access control - if configured - are vulnerable to their field-level access control not being used. List-level access control is not affected. Field-level access control for fields other than `multiselect` are not affected. Version 2.3.1 contains a fix for this issue. As a workaround, stop using the `multiselect` field.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-10-25T17:15:56.020",
    "last_modified": "2024-11-21T07:18:02.117",
    "fix_date": "2022-10-17T21:42:44Z"
  },
  "references": [
    {
      "url": "https://github.com/keystonejs/keystone/commit/65c6ee3deef23605fc72b80230908696a7a65e7c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/keystonejs/keystone/security/advisories/GHSA-6mhr-52mv-6v6f",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/keystonejs/keystone/commit/65c6ee3deef23605fc72b80230908696a7a65e7c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/keystonejs/keystone/security/advisories/GHSA-6mhr-52mv-6v6f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.953305",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "keystone",
    "owner": "keystonejs",
    "created_at": "2018-04-05T10:48:37Z",
    "updated_at": "2025-01-13T23:57:44Z",
    "pushed_at": "2025-01-13T23:57:40Z",
    "size": 377252,
    "stars": 9361,
    "forks": 1172,
    "open_issues": 144,
    "watchers": 9361,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 2696347,
      "JavaScript": 25563,
      "HTML": 5172
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:19:52.767266"
  }
}