{
  "cve_id": "CVE-2022-39325",
  "github_data": {
    "repository": "baserproject/basercms",
    "fix_commit": "b6f8a54e90dee51317eddf517b776fe8b4cd3ef6",
    "related_commits": [
      "b6f8a54e90dee51317eddf517b776fe8b4cd3ef6",
      "b6f8a54e90dee51317eddf517b776fe8b4cd3ef6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b6f8a54e90dee51317eddf517b776fe8b4cd3ef6",
      "commit_date": "2022-11-24T07:07:00Z",
      "author": {
        "login": "gondoh",
        "type": "User",
        "stats": {
          "total_commits": 286,
          "average_weekly_commits": 0.4218289085545723,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 108
        }
      },
      "commit_message": {
        "title": "Merge remote-tracking branch 'basercms-ghsa-395x-wv32-44v5/advisory-fix-1' into dev-4",
        "length": 85,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 10,
        "deletions": 10
      },
      "files": [
        {
          "filename": "app/webroot/theme/admin-third/Elements/admin/dblogs/index_row.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@ class=\"bca-table-listup__tbody-td\"\n \t\t<?= Hash::get($row, 'Dblog.id') ?>\n \t</td>\n \t<td class=\"bca-table-listup__tbody-td\">\n-\t\t<?= Hash::get($row, 'Dblog.name') ?>\n+\t\t<?= h(Hash::get($row, 'Dblog.name')) ?>\n \t</td>\n \t<td class=\"bca-table-listup__tbody-td\">\n \t\t<?php if ($row['Dblog']['user_id']): ?>"
        },
        {
          "filename": "app/webroot/theme/admin-third/Elements/admin/favorite_menu_row.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -21,7 +21,7 @@\n \t<?php $this->BcBaser->link(\n \t\t'<span class=\"bca-nav-favorite-list-item-label\">' . h($favorite['Favorite']['name']) . '</span>',\n \t\t$favorite['Favorite']['url'],\n-\t\t['title' => Router::url($favorite['Favorite']['url'], true)]\n+\t\t['title' => h(Router::url($favorite['Favorite']['url'], true))]\n \t) ?>\n \t<?php echo $this->BcForm->input('Favorite.id.' . $favorite['Favorite']['id'], ['type' => 'hidden', 'value' => $favorite['Favorite']['id'], 'class' => 'favorite-id']) ?>\n \t<?php echo $this->BcForm->input('Favorite.name.' . $favorite['Favorite']['id'], ['type' => 'hidden', 'value' => $favorite['Favorite']['name'], 'class' => 'favorite-name']) ?>"
        },
        {
          "filename": "app/webroot/theme/admin-third/Elements/admin/permissions/index_row.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -39,7 +39,7 @@\n \t<td class=\"bca-table-listup__tbody-td\">\n \t\t<?php $this->BcBaser->link($data['Permission']['name'], ['action' => 'edit', $this->request->params['pass'][0], $data['Permission']['id']], ['escape' => true]) ?>\n \t\t<br>\n-\t\t<?php echo $data['Permission']['url']; ?>\n+\t\t<?php echo h($data['Permission']['url']); ?>\n \t</td>\n \t<td class=\"bca-table-listup__tbody-td\"><?php echo $this->BcText->arrayValue($data['Permission']['auth'], [0 => '\u00d7', 1 => '\u3007']) ?></td>\n \t<?php echo $this->BcListTable->dispatchShowRow($data) ?>"
        },
        {
          "filename": "app/webroot/theme/admin-third/Permissions/admin/form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -30,7 +30,7 @@\n \t\t\t<th class=\"col-head bca-form-table__label\"><?php echo $this->BcForm->label('Permission.user_group_id', __d('baser', '\u30e6\u30fc\u30b6\u30fc\u30b0\u30eb\u30fc\u30d7')) ?></th>\n \t\t\t<td class=\"col-input bca-form-table__input\">\n \t\t\t\t<?php $userGroups = $this->BcForm->getControlSource('user_group_id') ?>\n-\t\t\t\t<?php echo $userGroups[$this->BcForm->value('Permission.user_group_id')] ?>\n+\t\t\t\t<?php echo h($userGroups[$this->BcForm->value('Permission.user_group_id')]) ?>\n \t\t\t\t<?php echo $this->BcForm->input('Permission.user_group_id', ['type' => 'hidden']) ?>\n \t\t\t</td>\n \t\t</tr>"
        },
        {
          "filename": "app/webroot/theme/admin-third/Users/admin/form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -100,7 +100,7 @@ class=\"helptext\"><?php echo __d('baser', '\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u3066\u3044\n \t\t\t\t\t<div id=\"helptextUserGroupId\"\n \t\t\t\t\t\t class=\"helptext\"><?php echo sprintf(__d('baser', '\u30e6\u30fc\u30b6\u30fc\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u30b3\u30f3\u30c6\u30f3\u30c4\u3078\u306e\u30a2\u30af\u30bb\u30b9\u5236\u9650\u3092\u304b\u3051\u308b\u5834\u5408\u306a\u3069\u306b\u306f%s\u3088\u308a\u65b0\u3057\u3044\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u3057\u30a2\u30af\u30bb\u30b9\u5236\u9650\u306e\u8a2d\u5b9a\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002'), $this->BcBaser->getLink(__d('baser', '\u30e6\u30fc\u30b6\u30fc\u30b0\u30eb\u30fc\u30d7\u7ba1\u7406'), ['controller' => 'user_groups', 'action' => 'index'])) ?></div>\n \t\t\t\t<?php else: ?>\n-\t\t\t\t\t<?php echo $this->BcText->arrayValue($this->request->data['User']['user_group_id'], $userGroups) ?>\n+\t\t\t\t\t<?php echo h($this->BcText->arrayValue($this->request->data['User']['user_group_id'], $userGroups)) ?>\n \t\t\t\t\t<?php echo $this->BcForm->input('User.user_group_id', ['type' => 'hidden']) ?>\n \t\t\t\t<?php endif ?>\n \t\t\t</td>"
        },
        {
          "filename": "lib/Baser/View/Elements/admin/dblogs/index_row.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@ class=\"bca-table-listup__tbody-td\"\n \t\t<?= Hash::get($row, 'Dblog.id') ?>\n \t</td>\n \t<td class=\"bca-table-listup__tbody-td\">\n-\t\t<?= Hash::get($row, 'Dblog.name') ?>\n+\t\t<?= h(Hash::get($row, 'Dblog.name')) ?>\n \t</td>\n \t<td class=\"bca-table-listup__tbody-td\">\n \t\t<?php if ($row['Dblog']['user_id']): ?>"
        },
        {
          "filename": "lib/Baser/View/Elements/admin/favorite_menu_row.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n \n <li id=\"FavoriteRow<?php echo h($favorite['Favorite']['name']) ?>\">\n \t<?php $favorite['Favorite']['url'] = preg_replace('/^\\/admin\\//', '/' . BcUtil::getAdminPrefix() . '/', $favorite['Favorite']['url']) ?>\n-\t<?php $this->BcBaser->link(h($favorite['Favorite']['name']), $favorite['Favorite']['url'], ['title' => Router::url($favorite['Favorite']['url'], true)]) ?>\n+\t<?php $this->BcBaser->link(h($favorite['Favorite']['name']), $favorite['Favorite']['url'], ['title' => h(Router::url($favorite['Favorite']['url']), true)]) ?>\n \t<?php echo $this->BcForm->input('Favorite.id.' . $favorite['Favorite']['id'], ['type' => 'hidden', 'value' => $favorite['Favorite']['id'], 'class' => 'favorite-id']) ?>\n \t<?php echo $this->BcForm->input('Favorite.name.' . $favorite['Favorite']['id'], ['type' => 'hidden', 'value' => $favorite['Favorite']['name'], 'class' => 'favorite-name']) ?>\n \t<?php echo $this->BcForm->input('Favorite.url.' . $favorite['Favorite']['id'], ['type' => 'hidden', 'value' => $favorite['Favorite']['url'], 'class' => 'favorite-url']) ?>"
        },
        {
          "filename": "lib/Baser/View/Elements/admin/permissions/index_row.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -43,7 +43,7 @@ class=\"sort-handle\"><?php $this->BcBaser->img('admin/sort.png', ['alt' => __d('b\n \t<td style=\"width:55%\">\n \t\t<?php $this->BcBaser->link($data['Permission']['name'], ['action' => 'edit', $this->request->params['pass'][0], $data['Permission']['id']], ['escape' => true]); ?>\n \t\t<br/>\n-\t\t<?php echo $data['Permission']['url']; ?>\n+\t\t<?php echo h($data['Permission']['url']); ?>\n \t</td>\n \t<td style=\"width:10%\"\n \t\tclass=\"align-center\"><?php echo $this->BcText->arrayValue($data['Permission']['auth'], [0 => '\u00d7', 1 => '\u25cb']) ?></td>"
        },
        {
          "filename": "lib/Baser/View/Permissions/admin/form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -30,7 +30,7 @@\n \t\t\t<th class=\"col-head\"><?php echo $this->BcForm->label('Permission.user_group_id', __d('baser', '\u30e6\u30fc\u30b6\u30fc\u30b0\u30eb\u30fc\u30d7')) ?></th>\n \t\t\t<td class=\"col-input\">\n \t\t\t\t<?php $userGroups = $this->BcForm->getControlSource('user_group_id') ?>\n-\t\t\t\t<?php echo $userGroups[$this->BcForm->value('Permission.user_group_id')] ?>\n+\t\t\t\t<?php echo h($userGroups[$this->BcForm->value('Permission.user_group_id')]) ?>\n \t\t\t\t<?php echo $this->BcForm->input('Permission.user_group_id', ['type' => 'hidden']) ?>\n \t\t\t</td>\n \t\t</tr>"
        },
        {
          "filename": "lib/Baser/View/Users/admin/form.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -99,7 +99,7 @@ class=\"helptext\"><?php echo __d('baser', '\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u3066\u3044\n \t\t\t\t\t<div id=\"helptextUserGroupId\"\n \t\t\t\t\t\t class=\"helptext\"> <?php echo sprintf(__d('baser', '\u30e6\u30fc\u30b6\u30fc\u30b0\u30eb\u30fc\u30d7\u3054\u3068\u306b\u30b3\u30f3\u30c6\u30f3\u30c4\u3078\u306e\u30a2\u30af\u30bb\u30b9\u5236\u9650\u3092\u304b\u3051\u308b\u5834\u5408\u306a\u3069\u306b\u306f%s\u3088\u308a\u65b0\u3057\u3044\u30b0\u30eb\u30fc\u30d7\u3092\u8ffd\u52a0\u3057\u30a2\u30af\u30bb\u30b9\u5236\u9650\u306e\u8a2d\u5b9a\u3092\u304a\u3053\u306a\u3044\u307e\u3059\u3002'), $this->BcBaser->getLink(__d('baser', '\u30e6\u30fc\u30b6\u30fc\u30b0\u30eb\u30fc\u30d7\u7ba1\u7406'), ['controller' => 'user_groups', 'action' => 'index'])) ?></div>\n \t\t\t\t<?php else: ?>\n-\t\t\t\t\t<?php echo $this->BcText->arrayValue($this->request->data['User']['user_group_id'], $userGroups) ?>\n+\t\t\t\t\t<?php echo h($this->BcText->arrayValue($this->request->data['User']['user_group_id'], $userGroups)) ?>\n \t\t\t\t\t<?php echo $this->BcForm->input('User.user_group_id', ['type' => 'hidden']) ?>\n \t\t\t\t<?php endif ?>\n \t\t\t</td>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 10,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4639019bcac88bbef2acefc74ee45fe17a453429",
            "date": "2025-01-23T06:42:11Z",
            "author_login": "momofff"
          },
          {
            "sha": "3ca87fbd2100851756133fc486a94bb2f5301642",
            "date": "2025-01-23T06:29:03Z",
            "author_login": "momofff"
          },
          {
            "sha": "4d855801d1065b3b75189194a76b806200466dae",
            "date": "2025-01-23T06:16:13Z",
            "author_login": "momofff"
          },
          {
            "sha": "6a85e7b486fce4d26990b461727689e5486feb35",
            "date": "2025-01-23T06:05:33Z",
            "author_login": "seto1"
          },
          {
            "sha": "b867cb1da3c13ea9bdda67aac5eec4c79842ef51",
            "date": "2025-01-23T06:03:56Z",
            "author_login": "seto1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "BaserCMS is a content management system with a japanese language focus. In affected versions there is a cross-site scripting vulnerability on the management system of baserCMS. This is a vulnerability that needs to be addressed when the management system is used by an unspecified number of users. Users of baserCMS are advised to upgrade as soon as possible. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-25T20:15:10.680",
    "last_modified": "2024-11-21T07:18:02.503",
    "fix_date": "2022-11-24T07:07:00Z"
  },
  "references": [
    {
      "url": "https://basercms.net/security/JVN_53682526",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/commit/b6f8a54e90dee51317eddf517b776fe8b4cd3ef6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/security/advisories/GHSA-395x-wv32-44v5",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://basercms.net/security/JVN_53682526",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/commit/b6f8a54e90dee51317eddf517b776fe8b4cd3ef6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/baserproject/basercms/security/advisories/GHSA-395x-wv32-44v5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.169035",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "basercms",
    "owner": "baserproject",
    "created_at": "2012-02-12T06:13:53Z",
    "updated_at": "2025-01-23T06:43:01Z",
    "pushed_at": "2025-01-23T06:42:58Z",
    "size": 100922,
    "stars": 174,
    "forks": 131,
    "open_issues": 276,
    "watchers": 174,
    "has_security_policy": false,
    "default_branch": "5.1.x",
    "protected_branches": [
      "5.1.x"
    ],
    "languages": {
      "PHP": 8898382,
      "CSS": 1244410,
      "JavaScript": 342744,
      "SCSS": 236685,
      "HTML": 150870,
      "Vue": 16205,
      "Shell": 6070,
      "Batchfile": 835
    },
    "commit_activity": {
      "total_commits_last_year": 1850,
      "avg_commits_per_week": 35.57692307692308,
      "days_active_last_year": 215
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:53:59.160625"
  }
}