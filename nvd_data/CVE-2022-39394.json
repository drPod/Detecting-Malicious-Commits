{
  "cve_id": "CVE-2022-39394",
  "github_data": {
    "repository": "bytecodealliance/wasmtime",
    "fix_commit": "087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36",
    "related_commits": [
      "087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36",
      "087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36"
    ],
    "patch_url": "https://github.com/bytecodealliance/wasmtime/commit/087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36.patch",
    "fix_commit_details": {
      "sha": "087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36",
      "commit_date": "2022-11-10T17:35:14Z",
      "author": {
        "login": "alexcrichton",
        "type": "User",
        "stats": {
          "total_commits": 2087,
          "average_weekly_commits": 4.546840958605665,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 258
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-h84q-m8rr-3v9q",
        "length": 161,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "crates/c-api/src/trap.rs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -92,7 +92,7 @@ pub extern \"C\" fn wasm_trap_trace(raw: &wasm_trap_t, out: &mut wasm_frame_vec_t)\n }\n \n #[no_mangle]\n-pub extern \"C\" fn wasmtime_trap_code(raw: &wasm_trap_t, code: &mut i32) -> bool {\n+pub extern \"C\" fn wasmtime_trap_code(raw: &wasm_trap_t, code: &mut u8) -> bool {\n     match raw.trap.trap_code() {\n         Some(c) => {\n             *code = match c {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e4fd50d1e27f3ba3d4757b85547d55f585d446f9",
            "date": "2025-01-14T01:28:53Z",
            "author_login": "alexcrichton"
          },
          {
            "sha": "8659e11c4ad12512defd6213de0a9d73f8ae6732",
            "date": "2025-01-14T00:47:04Z",
            "author_login": "fitzgen"
          },
          {
            "sha": "84f381fa1bc5c00438108d16fb14657a2c76a182",
            "date": "2025-01-13T22:31:43Z",
            "author_login": "saulecabrera"
          },
          {
            "sha": "a6a08570216d5c42b1c1fc9699fe5b9ae214f27e",
            "date": "2025-01-13T21:05:07Z",
            "author_login": "alexcrichton"
          },
          {
            "sha": "48f8a9d382ba6d8e23fe96f19b3f273c38d5c6ec",
            "date": "2025-01-13T20:26:42Z",
            "author_login": "eagr"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-787",
    "description": "Wasmtime is a standalone runtime for WebAssembly. Prior to version 2.0.2, there is a bug in Wasmtime's C API implementation where the definition of the `wasmtime_trap_code` does not match its declared signature in the `wasmtime/trap.h` header file. This discrepancy causes the function implementation to perform a 4-byte write into a 1-byte buffer provided by the caller. This can lead to three zero bytes being written beyond the 1-byte location provided by the caller. This bug has been patched and users should upgrade to Wasmtime 2.0.2. This bug can be worked around by providing a 4-byte buffer casted to a 1-byte buffer when calling `wasmtime_trap_code`. Users of the `wasmtime` crate are not affected by this issue, only users of the C API function `wasmtime_trap_code` are affected.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-11-10T20:15:11.850",
    "last_modified": "2024-11-21T07:18:12.087",
    "fix_date": "2022-11-10T17:35:14Z"
  },
  "references": [
    {
      "url": "https://github.com/bytecodealliance/wasmtime/commit/087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-h84q-m8rr-3v9q",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/commit/087d9d7becf7422b3f872a3bcd5d97bb7ce7ff36",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-h84q-m8rr-3v9q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:01.007559",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wasmtime",
    "owner": "bytecodealliance",
    "created_at": "2017-08-29T14:01:55Z",
    "updated_at": "2025-01-14T09:40:55Z",
    "pushed_at": "2025-01-14T01:52:50Z",
    "size": 111616,
    "stars": 15702,
    "forks": 1345,
    "open_issues": 787,
    "watchers": 15702,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release-0.32.0",
      "release-0.33.0",
      "release-0.34.0",
      "release-0.35.0",
      "release-0.36.0",
      "release-0.37.0",
      "release-0.38.0",
      "release-0.39.0",
      "release-0.40.0",
      "release-1.0.0",
      "release-2.0.0",
      "release-3.0.0",
      "release-4.0.0",
      "release-5.0.0",
      "release-6.0.0",
      "release-7.0.0",
      "release-8.0.0",
      "release-9.0.0"
    ],
    "languages": {
      "Rust": 19224087,
      "WebAssembly": 6773216,
      "Common Lisp": 1793054,
      "C": 257019,
      "JavaScript": 24116,
      "Shell": 23820,
      "C++": 21050,
      "CMake": 7205,
      "OCaml": 6903,
      "Assembly": 4165,
      "Dockerfile": 2564,
      "Makefile": 1432,
      "CSS": 303
    },
    "commit_activity": {
      "total_commits_last_year": 1586,
      "avg_commits_per_week": 30.5,
      "days_active_last_year": 278
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:32:42.127815"
  }
}