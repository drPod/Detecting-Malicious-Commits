{
  "cve_id": "CVE-2022-39398",
  "github_data": {
    "repository": "InfotelGLPI/tasklists",
    "fix_commit": "4a1b30f3d9fa764695f98ce011c8542772530d47",
    "related_commits": [
      "4a1b30f3d9fa764695f98ce011c8542772530d47",
      "4a1b30f3d9fa764695f98ce011c8542772530d47"
    ],
    "patch_url": "https://github.com/InfotelGLPI/tasklists/commit/4a1b30f3d9fa764695f98ce011c8542772530d47.patch",
    "fix_commit_details": {
      "sha": "4a1b30f3d9fa764695f98ce011c8542772530d47",
      "commit_date": "2022-11-08T12:59:40Z",
      "author": {
        "login": "tsmr",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix XSS payload (add script into content)",
        "length": 54,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
      },
      "files": [
        {
          "filename": "inc/task.class.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -332,9 +332,14 @@ function cleanDBonPurge() {\n     */\n    function prepareInputForAdd($input) {\n \n+\n       if (isset($input['due_date']) && empty($input['due_date'])) {\n          $input['due_date'] = 'NULL';\n       }\n+       if (isset($input['content'])) {\n+        $input['content'] = Glpi\\RichText\\RichText::getSafeHtml($input['content'], true);\n+       }\n+\n       if (isset($input[\"id\"]) && ($input[\"id\"] > 0)) {\n          $input[\"_oldID\"] = $input[\"id\"];\n       }"
        },
        {
          "filename": "inc/tasktype.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -269,7 +269,7 @@ static function getKanbanColumns($ID, $column_field = null, $column_ids = [], $g\n                $content      .= \"</div>\";\n                $rich_content = \"\";\n                if ($data['content'] != null) {\n-                  $rich_content = Glpi\\RichText\\RichText::getTextFromHtml($data['content'], false, true);\n+                  $rich_content = Glpi\\RichText\\RichText::getTextFromHtml($data['content'], false, true, true);\n                }\n                $content .= Html::resume_text($rich_content, 100);\n                $content .= \"</div>\";"
        },
        {
          "filename": "setup.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -27,7 +27,7 @@\n  --------------------------------------------------------------------------\n  */\n \n-define('PLUGIN_TASKLISTS_VERSION', '2.0.2');\n+define('PLUGIN_TASKLISTS_VERSION', '2.0.3');\n \n if (!defined(\"PLUGIN_TASKLISTS_DIR\")) {\n    define(\"PLUGIN_TASKLISTS_DIR\", Plugin::getPhpDir(\"tasklists\"));"
        },
        {
          "filename": "tasklists.xml",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -25,6 +25,11 @@\n         <author>Infotel</author>\n     </authors>\n     <versions>\n+        <version>\n+            <num>2.0.3</num>\n+            <compatibility>~10.0</compatibility>\n+            <download_url>https://github.com/InfotelGLPI/tasklists/releases/download/2.0.3/glpi-tasklists-2.0.3.tar.bz2</download_url>\n+        </version>\n         <version>\n             <num>2.0.2</num>\n             <compatibility>~10.0</compatibility>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0b1819ec59afb9fdfa21ff6af9e4cae034ed60a0",
            "date": "2024-12-30T13:55:52Z",
            "author_login": "tsmr"
          },
          {
            "sha": "463709ae322c18b4d36b5aa1b09691d27dbdfe3b",
            "date": "2024-12-30T13:55:03Z",
            "author_login": "tsmr"
          },
          {
            "sha": "bb12916e95f821a94e827ff8b5524d7eb77ea89a",
            "date": "2024-12-30T13:54:46Z",
            "author_login": "tsmr"
          },
          {
            "sha": "290d257ccbdf884d0a2f579440242a520bf9f32e",
            "date": "2024-12-30T13:50:26Z",
            "author_login": "transifex-integration[bot]"
          },
          {
            "sha": "5bf9504f651c4eb36a908845fe35df30f4572eb2",
            "date": "2024-12-30T13:50:20Z",
            "author_login": "transifex-integration[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "tasklists is a tasklists plugin for GLPI (Kanban). Versions prior to 2.0.3 are vulnerable to Cross-site Scripting. Cross-site Scripting (XSS) - Create XSS in task content (when add it). This issue is patched in version 2.0.3. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-10T01:15:12.333",
    "last_modified": "2024-11-21T07:18:12.633",
    "fix_date": "2022-11-08T12:59:40Z"
  },
  "references": [
    {
      "url": "https://github.com/InfotelGLPI/tasklists/commit/4a1b30f3d9fa764695f98ce011c8542772530d47",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/InfotelGLPI/tasklists/security/advisories/GHSA-3qv3-8393-777q",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/InfotelGLPI/tasklists/commit/4a1b30f3d9fa764695f98ce011c8542772530d47",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/InfotelGLPI/tasklists/security/advisories/GHSA-3qv3-8393-777q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:01.006212",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tasklists",
    "owner": "InfotelGLPI",
    "created_at": "2016-01-08T12:40:14Z",
    "updated_at": "2024-12-30T13:55:56Z",
    "pushed_at": "2024-12-30T13:55:53Z",
    "size": 860,
    "stars": 24,
    "forks": 10,
    "open_issues": 14,
    "watchers": 24,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 256755,
      "JavaScript": 128761,
      "CSS": 27427,
      "Twig": 2717,
      "Perl": 1337,
      "Shell": 488
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:05:21.244484"
  }
}