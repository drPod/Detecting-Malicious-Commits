{
  "cve_id": "CVE-2022-3966",
  "github_data": {
    "repository": "ultimatemember/ultimatemember",
    "fix_commit": "e1bc94c1100f02a129721ba4be5fbc44c3d78ec4",
    "related_commits": [
      "e1bc94c1100f02a129721ba4be5fbc44c3d78ec4",
      "e1bc94c1100f02a129721ba4be5fbc44c3d78ec4"
    ],
    "patch_url": "https://github.com/ultimatemember/ultimatemember/commit/e1bc94c1100f02a129721ba4be5fbc44c3d78ec4.patch",
    "fix_commit_details": {
      "sha": "e1bc94c1100f02a129721ba4be5fbc44c3d78ec4",
      "commit_date": "2022-09-27T12:13:35Z",
      "author": {
        "login": "nikitasinelnikov",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "- fixed Directory Traversal vulnerability. Using realpath for that;",
        "length": 67,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "includes/core/class-shortcodes.php",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -276,17 +276,19 @@ function load_template( $tpl ) {\n \t\t\t\textract( $args );\n \t\t\t}\n \n-\t\t\t// Avoid Directory Traversal vulnerability.\n-\t\t\t$tpl = trim( $tpl, \"./\\\\\" );\n-\n \t\t\t$file = um_path . \"templates/{$tpl}.php\";\n \t\t\t$theme_file = get_stylesheet_directory() . \"/ultimate-member/templates/{$tpl}.php\";\n \t\t\tif ( file_exists( $theme_file ) ) {\n \t\t\t\t$file = $theme_file;\n \t\t\t}\n \n \t\t\tif ( file_exists( $file ) ) {\n-\t\t\t\tinclude $file;\n+\t\t\t\t// Avoid Directory Traversal vulnerability by the checking the realpath.\n+\t\t\t\t// Templates can be situated only in the get_stylesheet_directory() or plugindir templates.\n+\t\t\t\t$real_file = realpath( $file );\n+\t\t\t\tif ( 0 === strpos( $real_file, um_path . \"templates\" . DIRECTORY_SEPARATOR ) || 0 === strpos( $real_file, get_stylesheet_directory() . DIRECTORY_SEPARATOR . 'ultimate-member' . DIRECTORY_SEPARATOR . 'templates' . DIRECTORY_SEPARATOR ) ) {\n+\t\t\t\t\tinclude $file;\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0d490d7d3a01173de0f93c5ce30640ebcc6a4899",
            "date": "2025-01-14T13:51:46Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "c1171d51b228acc1b033c943b57aeee951465bc2",
            "date": "2025-01-14T13:51:21Z",
            "author_login": "nikitasinelnikov"
          },
          {
            "sha": "2cc28857572ec01465dd7d4c8248414f501f18a3",
            "date": "2025-01-14T13:42:27Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "e72b5bdf7542603dfc73062cc74ed8e3b8ea786b",
            "date": "2025-01-14T13:42:05Z",
            "author_login": "nikitasinelnikov"
          },
          {
            "sha": "980de8a8009b65a8f3666c7928c17308213d3de5",
            "date": "2025-01-14T13:40:11Z",
            "author_login": "nikitasinelnikov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "A vulnerability, which was classified as critical, has been found in Ultimate Member Plugin up to 2.5.0. This issue affects the function load_template of the file includes/core/class-shortcodes.php of the component Template Handler. The manipulation of the argument tpl leads to pathname traversal. The attack may be initiated remotely. Upgrading to version 2.5.1 is able to address this issue. The name of the patch is e1bc94c1100f02a129721ba4be5fbc44c3d78ec4. It is recommended to upgrade the affected component. The identifier VDB-213545 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-13T08:15:15.607",
    "last_modified": "2024-11-21T07:20:38.060",
    "fix_date": "2022-09-27T12:13:35Z"
  },
  "references": [
    {
      "url": "https://github.com/ultimatemember/ultimatemember/commit/e1bc94c1100f02a129721ba4be5fbc44c3d78ec4",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ultimatemember/ultimatemember/releases/tag/2.5.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.213545",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ultimatemember/ultimatemember/commit/e1bc94c1100f02a129721ba4be5fbc44c3d78ec4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ultimatemember/ultimatemember/releases/tag/2.5.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.213545",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:01.011688",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ultimatemember",
    "owner": "ultimatemember",
    "created_at": "2014-12-15T21:01:15Z",
    "updated_at": "2025-01-14T13:51:51Z",
    "pushed_at": "2025-01-14T13:55:29Z",
    "size": 96670,
    "stars": 250,
    "forks": 185,
    "open_issues": 226,
    "watchers": 250,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 2612829,
      "CSS": 584477,
      "JavaScript": 573541,
      "Sass": 81556,
      "Shell": 1231
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:07:45.735123"
  }
}