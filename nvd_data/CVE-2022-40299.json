{
  "cve_id": "CVE-2022-40299",
  "github_data": {
    "repository": "Singular/Singular",
    "fix_commit": "5f28fbf066626fa9c4a8f0e6408c0bb362fb386c",
    "related_commits": [
      "5f28fbf066626fa9c4a8f0e6408c0bb362fb386c",
      "5f28fbf066626fa9c4a8f0e6408c0bb362fb386c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5f28fbf066626fa9c4a8f0e6408c0bb362fb386c",
      "commit_date": "2022-05-24T09:02:32Z",
      "author": {
        "login": "hannes14",
        "type": "User",
        "stats": {
          "total_commits": 13984,
          "average_weekly_commits": 8.907006369426751,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1263
        }
      },
      "commit_message": {
        "title": "use mkstemp for sdb",
        "length": 19,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 19,
        "additions": 9,
        "deletions": 10
      },
      "files": [
        {
          "filename": "Singular/sdb.cc",
          "status": "modified",
          "additions": 9,
          "deletions": 10,
          "patch": "@@ -108,10 +108,9 @@ BOOLEAN sdb_set_breakpoint(const char *pp, int given_lineno)\n \n void sdb_edit(procinfo *pi)\n {\n-  char * filename = omStrDup(\"/tmp/sd000000\");\n-  sprintf(filename+7,\"%d\",getpid());\n-  FILE *fp=fopen(filename,\"w\");\n-  if (fp==NULL)\n+  char * filename = omStrDup(\"/tmp/sdXXXXXX\");\n+  int f=mkstemp(filename);\n+  if (f==-1)\n   {\n     Print(\"cannot open %s\\n\",filename);\n     omFree(filename);\n@@ -120,8 +119,8 @@ void sdb_edit(procinfo *pi)\n   if (pi->language!= LANG_SINGULAR)\n   {\n     Print(\"cannot edit type %d\\n\",pi->language);\n-    fclose(fp);\n-    fp=NULL;\n+    close(f);\n+    f=NULL;\n   }\n   else\n   {\n@@ -138,15 +137,15 @@ void sdb_edit(procinfo *pi)\n       if (pi->data.s.body==NULL)\n       {\n         PrintS(\"cannot get the procedure body\\n\");\n-        fclose(fp);\n+        close(f);\n         si_unlink(filename);\n         omFree(filename);\n         return;\n       }\n     }\n \n-    fwrite(pi->data.s.body,1,strlen(pi->data.s.body),fp);\n-    fclose(fp);\n+    write(f,pi->data.s.body,strlen(pi->data.s.body));\n+    close(f);\n \n     int pid=fork();\n     if (pid!=0)\n@@ -173,7 +172,7 @@ void sdb_edit(procinfo *pi)\n       PrintS(\"cannot fork\\n\");\n     }\n \n-    fp=fopen(filename,\"r\");\n+    FILE* fp=fopen(filename,\"r\");\n     if (fp==NULL)\n     {\n       Print(\"cannot read from %s\\n\",filename);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9ef276812c797530d569a8b4e60f0caa23dc0443",
            "date": "2025-01-24T14:58:42Z",
            "author_login": "hannes14"
          },
          {
            "sha": "afc980a8416f33e89ecac50f6f46e438e6f7e11c",
            "date": "2025-01-24T14:44:34Z",
            "author_login": "hannes14"
          },
          {
            "sha": "ec4eb771deb6f9c5e55f838520327f6ec58993b1",
            "date": "2025-01-24T14:36:49Z",
            "author_login": "hannes14"
          },
          {
            "sha": "995b24f33cfa9bc45ffe0c91f3af552cc9adc52f",
            "date": "2025-01-21T14:16:34Z",
            "author_login": "hannes14"
          },
          {
            "sha": "4a6773d2f186695e01d6fd2f132e47d79f190855",
            "date": "2025-01-21T11:16:22Z",
            "author_login": "hannes14"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-330",
    "description": "In Singular before 4.3.1, a predictable /tmp pathname is used (e.g., by sdb.cc), which allows local users to gain the privileges of other users via a procedure in a file under /tmp. NOTE: this CVE Record is about sdb.cc and similar files in the Singular interface that have predictable /tmp pathnames; this CVE Record is not about the lack of a safe temporary-file creation capability in the Singular language.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-09-09T01:15:07.853",
    "last_modified": "2024-11-21T07:21:13.403",
    "fix_date": "2022-05-24T09:02:32Z"
  },
  "references": [
    {
      "url": "http://michael.orlitzky.com/cves/cve-2022-40299.xhtml",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Singular/Singular/commit/5f28fbf066626fa9c4a8f0e6408c0bb362fb386c",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Singular/Singular/issues/1137",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://michael.orlitzky.com/cves/cve-2022-40299.xhtml",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Singular/Singular/commit/5f28fbf066626fa9c4a8f0e6408c0bb362fb386c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Singular/Singular/issues/1137",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:39.096103",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "Singular",
    "owner": "Singular",
    "created_at": "2011-06-28T19:06:45Z",
    "updated_at": "2025-01-24T15:30:31Z",
    "pushed_at": "2025-01-24T15:30:27Z",
    "size": 188462,
    "stars": 268,
    "forks": 120,
    "open_issues": 69,
    "watchers": 268,
    "has_security_policy": false,
    "default_branch": "spielwiese",
    "protected_branches": [],
    "languages": {
      "C++": 11403098,
      "Scilab": 10882744,
      "C": 2102895,
      "Emacs Lisp": 539559,
      "Java": 429036,
      "M4": 184403,
      "HTML": 161387,
      "Shell": 131374,
      "Tcl": 115038,
      "Python": 90233,
      "Makefile": 73688,
      "Perl": 51666,
      "Yacc": 43176,
      "LLVM": 42959,
      "CSS": 25304,
      "TeX": 18657,
      "Roff": 13440,
      "Vim Script": 4156,
      "SystemVerilog": 1913,
      "GDB": 750,
      "Boogie": 12
    },
    "commit_activity": {
      "total_commits_last_year": 517,
      "avg_commits_per_week": 9.942307692307692,
      "days_active_last_year": 167
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:36:30.419385"
  }
}