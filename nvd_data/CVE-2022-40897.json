{
  "cve_id": "CVE-2022-40897",
  "github_data": {
    "repository": "pypa/setuptools",
    "fix_commit": "43a9c9bfa6aa626ec2a22540bea28d2ca77964be",
    "related_commits": [
      "43a9c9bfa6aa626ec2a22540bea28d2ca77964be",
      "43a9c9bfa6aa626ec2a22540bea28d2ca77964be"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "43a9c9bfa6aa626ec2a22540bea28d2ca77964be",
      "commit_date": "2022-11-04T17:47:53Z",
      "author": {
        "login": "jaraco",
        "type": "User",
        "stats": {
          "total_commits": 6828,
          "average_weekly_commits": 5.005865102639296,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 489
        }
      },
      "commit_message": {
        "title": "Limit the amount of whitespace to search/backtrack. Fixes #3659.",
        "length": 64,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 1,
        "deletions": 2
      },
      "files": [
        {
          "filename": "setuptools/package_index.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -217,7 +217,7 @@ def wrapper(*args, **kwargs):\n     return wrapper\n \n \n-REL = re.compile(r\"\"\"<([^>]*\\srel\\s*=\\s*['\"]?([^'\">]+)[^>]*)>\"\"\", re.I)\n+REL = re.compile(r\"\"\"<([^>]*\\srel\\s{0,10}=\\s{0,10}['\"]?([^'\" >]+)[^>]*)>\"\"\", re.I)\n \"\"\"\n Regex for an HTML tag with 'rel=\"val\"' attributes.\n \"\"\""
        },
        {
          "filename": "setuptools/tests/test_packageindex.py",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -307,7 +307,6 @@ def test_percent_in_password(self, temp_home):\n         assert cred.password == 'pity%'\n \n \n-@pytest.mark.xfail(reason=\"#3659\")\n @pytest.mark.timeout(1)\n def test_REL_DoS():\n     \"\"\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a443f7647ba35ef3f5c05513a23766cf4d4130bf",
            "date": "2025-01-20T16:48:34Z",
            "author_login": "abravalheri"
          },
          {
            "sha": "d92a59556223bb1a9a86fb94b10d59a8c018b0f7",
            "date": "2025-01-20T15:49:17Z",
            "author_login": "ngoldbaum"
          },
          {
            "sha": "3bde6efc7e0ad2da92e27bce76aa41805f7240ab",
            "date": "2025-01-20T15:49:11Z",
            "author_login": "ngoldbaum"
          },
          {
            "sha": "f049c9a5423248b0e1230c4a1cf1cb1b133d7ce5",
            "date": "2025-01-19T15:26:31Z",
            "author_login": "ngoldbaum"
          },
          {
            "sha": "8db1f5e67c18d5ba99750fe9be7a02778ed81bca",
            "date": "2025-01-17T19:15:06Z",
            "author_login": "ngoldbaum"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1333",
    "description": "Python Packaging Authority (PyPA) setuptools before 65.5.1 allows remote attackers to cause a denial of service via HTML in a crafted package or custom PackageIndex page. There is a Regular Expression Denial of Service (ReDoS) in package_index.py.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-23T00:15:13.987",
    "last_modified": "2024-11-21T07:22:13.787",
    "fix_date": "2022-11-04T17:47:53Z"
  },
  "references": [
    {
      "url": "https://github.com/pypa/setuptools/blob/fe8a98e696241487ba6ac9f91faa38ade939ec5d/setuptools/package_index.py#L200",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pypa/setuptools/commit/43a9c9bfa6aa626ec2a22540bea28d2ca77964be",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pypa/setuptools/compare/v65.5.0...v65.5.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ADES3NLOE5QJKBLGNZNI2RGVOSQXA37R/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YNA2BAH2ACBZ4TVJZKFLCR7L23BG5C3H/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://pyup.io/posts/pyup-discovers-redos-vulnerabilities-in-top-python-packages/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Technical Description",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://pyup.io/vulnerabilities/CVE-2022-40897/52495/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230214-0001/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240621-0006/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/pypa/setuptools/blob/fe8a98e696241487ba6ac9f91faa38ade939ec5d/setuptools/package_index.py#L200",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pypa/setuptools/commit/43a9c9bfa6aa626ec2a22540bea28d2ca77964be",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pypa/setuptools/compare/v65.5.0...v65.5.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ADES3NLOE5QJKBLGNZNI2RGVOSQXA37R/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YNA2BAH2ACBZ4TVJZKFLCR7L23BG5C3H/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://pyup.io/posts/pyup-discovers-redos-vulnerabilities-in-top-python-packages/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Technical Description",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://pyup.io/vulnerabilities/CVE-2022-40897/52495/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230214-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240621-0006/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.201667",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "setuptools",
    "owner": "pypa",
    "created_at": "2016-03-29T14:02:33Z",
    "updated_at": "2025-01-25T17:46:41Z",
    "pushed_at": "2025-01-20T16:48:34Z",
    "size": 46973,
    "stars": 2581,
    "forks": 1238,
    "open_issues": 640,
    "watchers": 2581,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 3830997,
      "C": 36473,
      "HTML": 266,
      "CMake": 209
    },
    "commit_activity": {
      "total_commits_last_year": 1520,
      "avg_commits_per_week": 29.23076923076923,
      "days_active_last_year": 196
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:41:55.039057"
  }
}