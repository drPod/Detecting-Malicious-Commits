{
  "cve_id": "CVE-2022-4111",
  "github_data": {
    "repository": "tooljet/tooljet",
    "fix_commit": "01cd3f0464747973ec329e9fb1ea12743d3235cc",
    "related_commits": [
      "01cd3f0464747973ec329e9fb1ea12743d3235cc",
      "01cd3f0464747973ec329e9fb1ea12743d3235cc"
    ],
    "patch_url": "https://github.com/tooljet/tooljet/commit/01cd3f0464747973ec329e9fb1ea12743d3235cc.patch",
    "fix_commit_details": {
      "sha": "01cd3f0464747973ec329e9fb1ea12743d3235cc",
      "commit_date": "2022-09-23T06:04:43Z",
      "author": {
        "login": "gondar00",
        "type": "User",
        "stats": {
          "total_commits": 201,
          "average_weekly_commits": 1.0100502512562815,
          "total_additions": 232311,
          "total_deletions": 150173,
          "weeks_active": 60
        }
      },
      "commit_message": {
        "title": "fix: add max file size validator for user avatar",
        "length": 48,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 16,
        "deletions": 1
      },
      "files": [
        {
          "filename": "server/src/controllers/users.controller.ts",
          "status": "modified",
          "additions": 16,
          "deletions": 1,
          "patch": "@@ -1,4 +1,13 @@\n-import { Body, Controller, Post, Patch, UseGuards, UseInterceptors, UploadedFile } from '@nestjs/common';\n+import {\n+  Body,\n+  Controller,\n+  Post,\n+  Patch,\n+  UseGuards,\n+  UseInterceptors,\n+  UploadedFile,\n+  BadRequestException,\n+} from '@nestjs/common';\n import { Express } from 'express';\n import { FileInterceptor } from '@nestjs/platform-express';\n import { JwtAuthGuard } from 'src/modules/auth/jwt-auth.guard';\n@@ -7,6 +16,8 @@ import { UsersService } from 'src/services/users.service';\n import { User } from 'src/decorators/user.decorator';\n import { UpdateUserDto } from '@dto/user.dto';\n \n+const MAX_AVATAR_FILE_SIZE = 1024 * 1024 * 2; // 2MB\n+\n @Controller('users')\n export class UsersController {\n   constructor(private usersService: UsersService) {}\n@@ -27,6 +38,10 @@ export class UsersController {\n   @UseGuards(JwtAuthGuard)\n   @UseInterceptors(FileInterceptor('file'))\n   async addAvatar(@User() user, @UploadedFile() file: Express.Multer.File) {\n+    // TODO: use ParseFilePipe to validate file size from nestjs v9\n+    if (file.size > MAX_AVATAR_FILE_SIZE) {\n+      throw new BadRequestException('File size is greater than 2MB');\n+    }\n     return this.usersService.addAvatar(user.id, file.buffer, file.originalname);\n   }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7e8573d12f791daa11130bbb28240faa50ed37f6",
            "date": "2025-01-10T06:58:10Z",
            "author_login": "johnsoncherian"
          },
          {
            "sha": "e8a9aaf07b45b8cc1a4c89c9ef1e1d9c12669189",
            "date": "2025-01-09T07:17:42Z",
            "author_login": "amanregu"
          },
          {
            "sha": "d7ae19b24f6926c1ee44185ff8e9bc52ff9ad678",
            "date": "2025-01-08T14:12:25Z",
            "author_login": "RudraPratik30"
          },
          {
            "sha": "222c25f93c557d417e2ea4c137402fdd79088cd5",
            "date": "2025-01-08T07:10:00Z",
            "author_login": "PriteshKiri"
          },
          {
            "sha": "d6c8b9c6ec63702382503cd64079b6f13d28df1d",
            "date": "2025-01-06T14:23:34Z",
            "author_login": "slancerk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-1284",
    "description": "Unrestricted file size limit can lead to DoS in tooljet/tooljet <1.27 by allowing a logged in attacker to upload profile pictures over 2MB.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-22T03:15:14.207",
    "last_modified": "2024-11-21T07:34:36.150",
    "fix_date": "2022-09-23T06:04:43Z"
  },
  "references": [
    {
      "url": "https://github.com/tooljet/tooljet/commit/01cd3f0464747973ec329e9fb1ea12743d3235cc",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/5596d072-66d2-4361-8cac-101c9c781c3d",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tooljet/tooljet/commit/01cd3f0464747973ec329e9fb1ea12743d3235cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/5596d072-66d2-4361-8cac-101c9c781c3d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.147522",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ToolJet",
    "owner": "tooljet",
    "created_at": "2021-03-30T08:51:34Z",
    "updated_at": "2025-01-14T11:02:48Z",
    "pushed_at": "2025-01-13T13:44:06Z",
    "size": 1415933,
    "stars": 33669,
    "forks": 4363,
    "open_issues": 1082,
    "watchers": 33669,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [],
    "languages": {
      "JavaScript": 5181340,
      "TypeScript": 1928640,
      "SCSS": 835109,
      "HTML": 31625,
      "Shell": 25589,
      "EJS": 17681,
      "Dockerfile": 15959,
      "Handlebars": 11680,
      "MDX": 11289,
      "CSS": 3790,
      "HCL": 1872,
      "Procfile": 62,
      "Batchfile": 61
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:26:36.929498"
  }
}