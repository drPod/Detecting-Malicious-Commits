{
  "cve_id": "CVE-2022-41547",
  "github_data": {
    "repository": "MobSF/Mobile-Security-Framework-MobSF",
    "fix_commit": "b9cdd1f52bdf127cf33bb1be369e374a2855f8e6",
    "related_commits": [
      "b9cdd1f52bdf127cf33bb1be369e374a2855f8e6",
      "b9cdd1f52bdf127cf33bb1be369e374a2855f8e6"
    ],
    "patch_url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/b9cdd1f52bdf127cf33bb1be369e374a2855f8e6.patch",
    "fix_commit_details": {
      "sha": "b9cdd1f52bdf127cf33bb1be369e374a2855f8e6",
      "commit_date": "2016-05-26T13:47:30Z",
      "author": {
        "login": "ajinabraham",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security: Fix for LFI found by thongngo",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 68,
        "additions": 46,
        "deletions": 22
      },
      "files": [
        {
          "filename": "APITester/views.py",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -48,7 +48,7 @@ def APIFuzzer(request):\n     try:\n         if request.method == 'GET':\n             MD5=request.GET['md5']\n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 URLS = getListOfURLS(MD5,False)\n                 if (len(URLS)) == 0:\n@@ -71,7 +71,7 @@ def APIFuzzer(request):\n                 return HttpResponseRedirect('/error/')\n         elif request.method ==\"POST\":\n             MD5=request.POST['md5']\n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 SCOPE_URLS = [] #All DOMAINS that needs to be tested\n                 SCOPE_TESTS = [] #All TESTS that needs to be executed\n@@ -128,7 +128,7 @@ def StartScan(request):\n     try:\n         if request.method ==\"POST\":\n             MD5=request.POST['md5']\n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 #Scan Mode\n                 SCAN_MODE=request.POST['scanmode']"
        },
        {
          "filename": "DynamicAnalyzer/views.py",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -38,7 +38,7 @@ def DynamicAnalyzer(request):\n             if re.findall(\";|\\$\\(|\\|\\||&&\",PKG) or re.findall(\";|\\$\\(|\\|\\||&&\",LNCH):\n                 print \"[ATTACK] Possible RCE\"\n                 return HttpResponseRedirect('/error/') \n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 # Delete ScreenCast Cache\n                 SCREEN_FILE=os.path.join(settings.SCREEN_DIR, 'screen.png')\n@@ -82,7 +82,7 @@ def GetEnv(request):\n             if re.findall(\";|\\$\\(|\\|\\||&&\",PKG) or re.findall(\";|\\$\\(|\\|\\||&&\",LNCH):\n                 print \"[ATTACK] Possible RCE\"\n                 return HttpResponseRedirect('/error/') \n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 DIR=settings.BASE_DIR\n                 APP_DIR=os.path.join(settings.UPLD_DIR, MD5+'/') #APP DIRECTORY\n@@ -113,7 +113,7 @@ def TakeScreenShot(request):\n     try:\n         if request.method == 'POST':\n             MD5=request.POST['md5']\n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 data = {}\n                 r=random.randint(1, 1000000)\n@@ -263,7 +263,7 @@ def FinalTest(request):\n             if re.findall(\";|\\$\\(|\\|\\||&&\",PACKAGE):\n                 print \"[ATTACK] Possible RCE\"\n                 return HttpResponseRedirect('/error/') \n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 #Stop ScreenCast Client if it is running\n                 tcp_server_mode = \"off\"\n@@ -307,7 +307,7 @@ def DumpData(request):\n             data = {}\n             PACKAGE=request.POST['pkg']\n             MD5=request.POST['md5']\n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 if re.findall(\";|\\$\\(|\\|\\||&&\",PACKAGE):\n                     print \"[ATTACK] Possible RCE\"\n@@ -353,7 +353,7 @@ def ExportedActivityTester(request):\n     try:\n         MD5=request.POST['md5']\n         PKG=request.POST['pkg']\n-        m=re.match('[0-9a-f]{32}',MD5)\n+        m=re.match('^[0-9a-f]{32}$',MD5)\n         if m:\n             if re.findall(\";|\\$\\(|\\|\\||&&\",PKG):\n                 print \"[ATTACK] Possible RCE\"\n@@ -410,7 +410,7 @@ def ActivityTester(request):\n     try:\n         MD5=request.POST['md5']\n         PKG=request.POST['pkg']\n-        m=re.match('[0-9a-f]{32}',MD5)\n+        m=re.match('^[0-9a-f]{32}$',MD5)\n         if m:\n             if re.findall(\";|\\$\\(|\\|\\||&&\",PKG):\n                 print \"[ATTACK] Possible RCE\"\n@@ -473,7 +473,7 @@ def Report(request):\n             if re.findall(\";|\\$\\(|\\|\\||&&\",PKG):\n                 print \"[ATTACK] Possible RCE\"\n                 return HttpResponseRedirect('/error/') \n-            m=re.match('[0-9a-f]{32}',MD5)\n+            m=re.match('^[0-9a-f]{32}$',MD5)\n             if m:\n                 DIR=settings.BASE_DIR\n                 APP_DIR=os.path.join(settings.UPLD_DIR, MD5+'/') #APP DIRECTORY\n@@ -891,7 +891,7 @@ def View(request):\n         fil=''\n         rtyp=''\n         dat=''\n-        m=re.match('[0-9a-f]{32}',request.GET['md5'])\n+        m=re.match('^[0-9a-f]{32}$',request.GET['md5'])\n         if m:\n             fil=request.GET['file']\n             MD5=request.GET['md5']"
        },
        {
          "filename": "MalwareAnalyzer/malwaredb/malwaredomainlist",
          "status": "modified",
          "additions": 25,
          "deletions": 1,
          "patch": "@@ -3038,4 +3038,28 @@\n \"2016/05/12_08:01\",\"oceanviewfootmassage.com/js/BKTbCv.html\",\"192.254.225.146\",\"-\",\"Compromised site, leads to Locky\",\"Registrar Abuse Contact abuse@1and1.com\",\"46606\",\"0\",\"US\",\r\n \"2016/05/12_08:36\",\"www.airsonett.se\",\"193.44.13.93\",\"193-44-13-93.net.tnm.se.\",\"pseudo darkleech on compromised site leads to Angler EK\",\"-\",\"3301\",\"0\",\"SE\",\r\n \"2016/05/12_09:49\",\"chashmawala.com/mn3yhds\",\"142.4.1.197\",\"142-4-1-197.unifiedlayer.com.\",\"Locky ransomware\",\"-\",\"46606\",\"0\",\"US\",\r\n-\"2016/05/12_10:40\",\"lojasrana.com:7080/ujh3jmd\",\"186.202.183.138\",\"pleskcl0243.hospedagemdesites.ws.\"\n\\ No newline at end of file\n+\"2016/05/12_10:40\",\"lojasrana.com:7080/ujh3jmd\",\"186.202.183.138\",\"pleskcl0243.hospedagemdesites.ws.\",\"Locky ransomware\",\"-\",\"27715\",\"0\",\"BR\",\r\n+\"2016/05/12_10:40\",\"scrubs.dresscool.co/zcv3hhs\",\"107.180.25.1\",\"ip-107-180-25-1.ip.secureserver.net.\",\"Locky ransomware\",\"dresscool.co@domainsbyproxy.com\",\"26496\",\"0\",\"US\",\r\n+\"2016/05/12_12:39\",\"www.jobbainorge.nu/\",\"195.74.38.95\",\"cl-11.atm.binero.net.\",\"pseudo darkleech on compromised site leads to Angler EK\",\"-\",\"41528\",\"0\",\"SE\",\r\n+\"2016/05/12_12:39\",\"microencapsulation.readmyweather.com/satire/pairing/58798892_pkfpfGESM\",\"69.162.126.172\",\"172-126-162-69.static.reverse.lstn.net.\",\"Angler EK\",\"Registrar Abuse Contact support@domainbox.com\",\"46475\",\"0\",\"US\",\r\n+\"2016/05/12_14:22\",\"www.autoappassionati.it/\",\"109.233.126.14\",\"cpanel01.infinitynet.it.\",\"pseudo darkleech on compromised site leads to Angler EK\",\"-\",\"48815\",\"0\",\"IT\",\r\n+\"2016/05/12_14:23\",\"tannpastnevicher.themakershop.co.uk/mj/o/3557/\",\"69.162.126.172\",\"172-126-162-69.static.reverse.lstn.net.\",\"Angler EK\",\"Colyton Industrial Designs ltd / -\",\"46475\",\"0\",\"US\",\r\n+\"2016/05/13_13:23\",\"www.imageprecision.com/\",\"188.121.41.53\",\"n1nw8shg125.shr.prod.ams1.secureserver.net.\",\"pseudo darkleech on compromised site leads to Angler EK\",\"-\",\"26496\",\"0\",\"NL\",\r\n+\"2016/05/13_13:23\",\"arbeiderspartij.be-spry.co.uk/NTQBuUVxO/gXyyX/IobVvqD-pRXCfMd/\",\"85.25.41.91\",\"static-ip-85-25-41-91.inaddr.ip-pool.com.\",\"Angler EK\",\"H R Searle / -\",\"8972\",\"0\",\"DE\",\r\n+\"2016/05/15_15:23\",\"meuble-ligansadaequabat.thepinkskip.co.uk/hoteliers/6719/66/01/511758321.html\",\"188.165.167.255\",\"-\",\"Angler EK\",\"Brian Barr / -\",\"16276\",\"0\",\"FR\",\r\n+\"2016/05/16_10:40\",\"sign.cdrn70.xyz/hfziso4.html\",\"93.190.140.154\",\"-\",\"gateway to Angler EK\",\"-\",\"49981\",\"0\",\"NL\",\r\n+\"2016/05/16_11:15\",\"inclination.cdrn70.xyz/brhsc4.html\",\"93.190.140.219\",\"s10.sheermail.com.\",\"gateway to Angler EK\",\"-\",\"49981\",\"0\",\"NL\",\r\n+\"2016/05/16_11:51\",\"no-id.eu/987t5t7g\",\"83.137.194.81\",\"server6.hosting2go.nl.\",\"trojan\",\"NOT DISCLOSED! / -\",\"34233\",\"0\",\"NL\",\r\n+\"2016/05/16_11:55\",\"press.centraljoias.com/brhsc4.html\",\"93.190.140.219\",\"s10.sheermail.com.\",\"gateway to Angler EK\",\"Registrant flavio.dygo@gmail.com\",\"49981\",\"0\",\"NL\",\r\n+\"2016/05/16_12:00\",\"gutter.celebway.net/brhsc4.html\",\"93.190.140.219\",\"s10.sheermail.com.\",\"gateway to Angler EK\",\"Registrar Abuse Contact abuse@bizcn.com\",\"49981\",\"0\",\"NL\",\r\n+\"2016/05/16_12:35\",\"charge.cenzorate-expertize.ro/brhsc4.html\",\"93.190.140.219\",\"s10.sheermail.com.\",\"gateway to Angler EK\",\"-\",\"49981\",\"0\",\"NL\",\r\n+\"2016/05/16_12:40\",\"excitable.charmedmultimedia.eu/brhsc4.html\",\"93.190.140.219\",\"s10.sheermail.com.\",\"gateway to Angler EK\",\"NOT DISCLOSED! / -\",\"49981\",\"0\",\"NL\",\r\n+\"2016/05/16_18:05\",\"sunlite.com.au/j76jn5nbv\",\"27.124.119.225\",\"server-69-r12.ipv4.au.syrahost.com.\",\"Locky ransomware\",\"Wayne Hughes / Visit whois.ausregistry.com.au for Web based WhoIs\",\"38719\",\"0\",\"AU\",\r\n+\"2016/05/17_07:17\",\"uwzorg.info/k76gf34g4g\",\"89.105.197.30\",\"mail.teurlings.biz.\",\"Locky ransomware\",\"MAM Teurlings / webmaster@teurlings.biz\",\"24875\",\"0\",\"NL\",\r\n+\"2016/05/17_09:54\",\"actinomorphous.excelwood.co.uk/euNsbCci/FAUk/Olvp/82749/SAitPlttYB-35817144-hgs.png\",\"37.130.229.104\",\"uk.server.\",\"Angler EK\",\"Decora Blind Systems / -\",\"13213\",\"0\",\"GB\",\r\n+\"2016/05/17_10:32\",\"www.gptecno.it/\",\"178.255.186.250\",\"www010.avanzati.it.\",\"pseudo darkleech on compromised site leads to Angler EK\",\"-\",\"42425\",\"0\",\"IT\",\r\n+\"2016/05/17_10:32\",\"armstrongcreekgeleedpotig.imber.me.uk/VDBGs/ftPRd/ZXyG-lBfzftj/\",\"37.130.229.104\",\"uk.server.\",\"Angler EK\",\"Nominet UK / -\",\"13213\",\"0\",\"GB\",\r\n+\"2016/05/17_13:34\",\"passagegoldtravel.com/678y8h\",\"23.229.182.198\",\"ip-23-229-182-198.ip.secureserver.net.\",\"Locky ransomware\",\"-\",\"26496\",\"0\",\"US\",\r\n+\"2016/05/18_07:28\",\"spreadware.com/09jhg54g\",\"162.244.95.27\",\"-\",\"Locky ransomware\",\"Registrar Abuse Contact abuse@namesilo.com\",\"53667\",\"0\",\"US\",\r\n+\"2016/05/18_15:05\",\"www.cafecalluna.nl/\",\"193.239.186.142\",\"sweb02.plinq.nl.\",\"pseudo darkleech on compromised site leads to Angler EK\",\"-\",\"35224\",\"0\",\"NL\",\r\n+\"2016/05/18_15:05\",\"brunowtrahoque-miagola.unishadeverticalsystem.com/1331481-positivity-misdiagnosis-refrigerants-slim-twinkles-array.png\",\"63.143.54.198\",\"198-54-143-63.static.reverse.lstn.\n\\ No newline at end of file"
        },
        {
          "filename": "StaticAnalyzer/views.py",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -34,7 +34,7 @@ def PDF(request):\n     try:\n         MD5=request.GET['md5']\n         TYP=request.GET['type']\n-        m=re.match('[0-9a-f]{32}',MD5)\n+        m=re.match('^[0-9a-f]{32}$',MD5)\n         if m:\n             if (TYP=='APK' or TYP=='ANDZIP'):\n                 DB=StaticAnalyzerAndroid.objects.filter(MD5=MD5)\n@@ -159,7 +159,7 @@ def PDF(request):\n         pass\n def Java(request):\n     try:\n-        m=re.match('[0-9a-f]{32}',request.GET['md5'])\n+        m=re.match('^[0-9a-f]{32}$',request.GET['md5'])\n         typ=request.GET['type']\n         if m:\n             MD5=request.GET['md5']\n@@ -198,7 +198,7 @@ def Java(request):\n         return HttpResponseRedirect('/error/')\n def Smali(request):\n     try:\n-        m=re.match('[0-9a-f]{32}',request.GET['md5'])\n+        m=re.match('^[0-9a-f]{32}$',request.GET['md5'])\n         if m:\n             MD5=request.GET['md5']\n             SRC=os.path.join(settings.UPLD_DIR, MD5+'/smali_source/')\n@@ -224,7 +224,7 @@ def Smali(request):\n         return HttpResponseRedirect('/error/')\n def Find(request):\n     try:\n-        m=re.match('[0-9a-f]{32}',request.POST['md5'])\n+        m=re.match('^[0-9a-f]{32}$',request.POST['md5'])\n         if m:\n             MD5=request.POST['md5']\n             q=request.POST['q']\n@@ -265,7 +265,7 @@ def Find(request):\n def ViewSource(request):\n     try:\n         fil=''\n-        m=re.match('[0-9a-f]{32}',request.GET['md5'])\n+        m=re.match('^[0-9a-f]{32}$',request.GET['md5'])\n         if m and (request.GET['file'].endswith('.java') or request.GET['file'].endswith('.smali')):\n             fil=request.GET['file']\n             MD5=request.GET['md5']\n@@ -304,7 +304,7 @@ def ManifestView(request):\n         MD5=request.GET['md5']  #MD5\n         TYP=request.GET['type'] #APK or SOURCE\n         BIN=request.GET['bin']\n-        m=re.match('[0-9a-f]{32}',MD5)\n+        m=re.match('^[0-9a-f]{32}$',MD5)\n         if m and (TYP=='eclipse' or TYP=='studio' or TYP=='apk') and (BIN=='1' or BIN=='0'):\n             APP_DIR=os.path.join(settings.UPLD_DIR, MD5+'/') #APP DIRECTORY\n             TOOLS_DIR=os.path.join(DIR, 'StaticAnalyzer/tools/')  #TOOLS DIR\n@@ -326,7 +326,7 @@ def StaticAnalyzer(request):\n     try:\n         #Input validation\n         TYP=request.GET['type']\n-        m=re.match('[0-9a-f]{32}',request.GET['checksum'])\n+        m=re.match('^[0-9a-f]{32}$',request.GET['checksum'])\n         if ((m) and (request.GET['name'].lower().endswith('.apk') or request.GET['name'].lower().endswith('.zip')) and ((TYP=='zip') or (TYP=='apk'))):\n             DIR=settings.BASE_DIR        #BASE DIR\n             APP_NAME=request.GET['name'] #APP ORGINAL NAME\n@@ -1754,7 +1754,7 @@ def StaticAnalyzer_iOS(request):\n         print \"[INFO] iOS Static Analysis Started\"\n         TYP=request.GET['type']\n         RESCAN= str(request.GET.get('rescan', 0))\n-        m=re.match('[0-9a-f]{32}',request.GET['checksum'])\n+        m=re.match('^[0-9a-f]{32}$',request.GET['checksum'])\n         if ((m) and (request.GET['name'].lower().endswith('.ipa') or request.GET['name'].lower().endswith('.zip')) and ((TYP=='ipa') or (TYP=='ios'))):\n             DIR=settings.BASE_DIR        #BASE DIR\n             APP_NAME=request.GET['name'] #APP ORGINAL NAME\n@@ -1963,7 +1963,7 @@ def ViewFile(request):\n         typ=request.GET['type']\n         MD5=request.GET['md5']\n         mode=request.GET['mode']\n-        m=re.match('[0-9a-f]{32}',MD5)\n+        m=re.match('^[0-9a-f]{32}$',MD5)\n         ext=fil.split('.')[-1]\n         f=re.search(\"plist|db|sqlitedb|sqlite|txt|m\",ext)\n         if m and f and re.findall('xml|db|txt|m',typ) and re.findall('ios|ipa',mode):"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "79b2d28c3b45dd176b0e63bd3deef2608960339a",
            "date": "2024-12-19T02:35:11Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "180de6b6110c9deba5284ae65ffaa46b660516ad",
            "date": "2024-12-18T01:56:54Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "17332e88c0f6c264c689af4eeedd515327c2713c",
            "date": "2024-12-18T01:56:25Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "fbf567446bfe818b179aed074ec5f2c4de3915d3",
            "date": "2024-12-18T01:03:03Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "3223736d93b2c7e4b55e739e135f5d728d0b66dd",
            "date": "2024-12-12T02:08:06Z",
            "author_login": "ajinabraham"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": null,
    "description": "Mobile Security Framework (MobSF) v0.9.2 and below was discovered to contain a local file inclusion (LFI) vulnerability in the StaticAnalyzer/views.py script. This vulnerability allows attackers to read arbitrary files via a crafted HTTP request.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-10-18T15:15:10.340",
    "last_modified": "2024-11-21T07:23:22.430",
    "fix_date": "2016-05-26T13:47:30Z"
  },
  "references": [
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/b9cdd1f52bdf127cf33bb1be369e374a2855f8e6#diff-69d2e38f6bba208c333da6a09a83ca65056fcb60f4e10d23f67c01bcc1ffb58c",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/pull/166",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/b9cdd1f52bdf127cf33bb1be369e374a2855f8e6#diff-69d2e38f6bba208c333da6a09a83ca65056fcb60f4e10d23f67c01bcc1ffb58c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/pull/166",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:03:41.353667",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Mobile-Security-Framework-MobSF",
    "owner": "MobSF",
    "created_at": "2015-01-31T04:36:01Z",
    "updated_at": "2025-01-14T12:25:42Z",
    "pushed_at": "2024-12-19T02:35:13Z",
    "size": 1525379,
    "stars": 17868,
    "forks": 3277,
    "open_issues": 13,
    "watchers": 17868,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 1582153,
      "Python": 1354876,
      "HTML": 1073775,
      "CSS": 148866,
      "Shell": 11552,
      "Batchfile": 4318,
      "PowerShell": 3089,
      "Dockerfile": 2892
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:25:15.645730"
  }
}