{
  "cve_id": "CVE-2022-41887",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c",
    "related_commits": [
      "c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c",
      "c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c.patch",
    "fix_commit_details": {
      "sha": "c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c",
      "commit_date": "2022-10-06T16:40:55Z",
      "author": {
        "login": "cantonios",
        "type": "User",
        "stats": {
          "total_commits": 299,
          "average_weekly_commits": 0.6229166666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "Fix cwise dimension overflow issue again.",
        "length": 396,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 10,
        "deletions": 8
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/cwise_ops_common.h",
          "status": "modified",
          "additions": 10,
          "deletions": 8,
          "patch": "@@ -450,13 +450,15 @@ struct BinaryFunctor<CPUDevice, Functor, 2, false> {\n     Assign(d, out, in.unaryExpr(Unary(scalar.data())));\n   }\n \n-  inline Eigen::IndexList<int, Eigen::type2index<1>> NByOne(int n) {\n-    Eigen::IndexList<int, Eigen::type2index<1>> ret;\n+  inline Eigen::IndexList<Eigen::DenseIndex, Eigen::type2index<1>> NByOne(\n+      Eigen::DenseIndex n) {\n+    Eigen::IndexList<Eigen::DenseIndex, Eigen::type2index<1>> ret;\n     ret.set(0, n);\n     return ret;\n   }\n-  inline Eigen::IndexList<Eigen::type2index<1>, int> OneByM(int m) {\n-    Eigen::IndexList<Eigen::type2index<1>, int> ret;\n+  inline Eigen::IndexList<Eigen::type2index<1>, Eigen::DenseIndex> OneByM(\n+      Eigen::DenseIndex m) {\n+    Eigen::IndexList<Eigen::type2index<1>, Eigen::DenseIndex> ret;\n     ret.set(1, m);\n     return ret;\n   }\n@@ -487,10 +489,10 @@ struct BinaryFunctor<CPUDevice, Functor, 2, false> {\n       // use_broadcast_optimization<T> are compile-time constant, gcc\n       // does a decent job avoiding generating code when conditions\n       // are not met.\n-      const int a = in0.dimension(0);  // in0 is shape [a, b]\n-      const int b = in0.dimension(1);\n-      const int c = in1.dimension(0);  // in1 is shape [c, d]\n-      const int d = in1.dimension(1);\n+      const Eigen::DenseIndex a = in0.dimension(0);  // in0 is shape [a, b]\n+      const Eigen::DenseIndex b = in0.dimension(1);\n+      const Eigen::DenseIndex c = in1.dimension(0);  // in1 is shape [c, d]\n+      const Eigen::DenseIndex d = in1.dimension(1);\n       if ((a == 1) && (d == 1)) {\n         auto lhs = in0.reshape(OneByM(b)).broadcast(NByOne(c));\n         auto rhs = in1.reshape(NByOne(c)).broadcast(OneByM(b));"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8f888e57d9fab1d2e4127fdeaabc3f8976471065",
            "date": "2025-01-14T15:28:59Z",
            "author_login": "ddunl"
          },
          {
            "sha": "4e74930bd620da4ea2bb691359aaa9b2dc6b0605",
            "date": "2025-01-14T15:28:20Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "251362e6c6746aaf6bffcfe514e79c6cc65336d7",
            "date": "2025-01-14T15:24:59Z",
            "author_login": "loislo"
          },
          {
            "sha": "eaa68cb298188196e413abfb1606c38f785dfed4",
            "date": "2025-01-14T15:15:19Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "c141307fbd02349cf4d83f9a73bdba73fcba9b87",
            "date": "2025-01-14T14:26:56Z",
            "author_login": "mooskagh"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-131",
    "description": "TensorFlow is an open source platform for machine learning. `tf.keras.losses.poisson` receives a `y_pred` and `y_true` that are passed through `functor::mul` in `BinaryOp`. If the resulting dimensions overflow an `int32`, TensorFlow will crash due to a size mismatch during broadcast assignment. We have patched the issue in GitHub commit c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c. The fix will be included in TensorFlow 2.11. We will also cherrypick this commit on TensorFlow 2.10.1 and 2.9.3, as these are also affected and still in supported range. However, we will not cherrypick this commit into TensorFlow 2.8.x, as it depends on Eigen behavior that changed between 2.8 and 2.9.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-11-18T22:15:14.817",
    "last_modified": "2024-11-21T07:23:59.770",
    "fix_date": "2022-10-06T16:40:55Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/cwise_ops_common.h",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/losses.py",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8fvv-46hw-vpg3",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/cwise_ops_common.h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/keras/losses.py",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/c5b30379ba87cbe774b08ac50c1f6d36df4ebb7c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-8fvv-46hw-vpg3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.135739",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}