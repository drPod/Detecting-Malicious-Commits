{
  "cve_id": "CVE-2022-41888",
  "github_data": {
    "repository": "tensorflow/tensorflow",
    "fix_commit": "cf35502463a88ca7185a99daa7031df60b3c1c98",
    "related_commits": [
      "cf35502463a88ca7185a99daa7031df60b3c1c98",
      "cf35502463a88ca7185a99daa7031df60b3c1c98"
    ],
    "patch_url": "https://github.com/tensorflow/tensorflow/commit/cf35502463a88ca7185a99daa7031df60b3c1c98.patch",
    "fix_commit_details": {
      "sha": "cf35502463a88ca7185a99daa7031df60b3c1c98",
      "commit_date": "2022-10-07T22:30:19Z",
      "author": {
        "login": "cantonios",
        "type": "User",
        "stats": {
          "total_commits": 299,
          "average_weekly_commits": 0.6229166666666667,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "Add rank checks to GenerateBoundingBoxProposals.",
        "length": 78,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 37,
        "additions": 36,
        "deletions": 1
      },
      "files": [
        {
          "filename": "tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -312,6 +312,22 @@ class GenerateBoundingBoxProposals : public tensorflow::OpKernel {\n     const auto bbox_deltas = context->input(1);\n     const auto image_info = context->input(2);\n     const auto anchors = context->input(3);\n+\n+    OP_REQUIRES(context, scores.dims() == 4,\n+                errors::InvalidArgument(\"`scores` must be rank 4 but is rank \",\n+                                        scores.dims()));\n+    OP_REQUIRES(\n+        context, bbox_deltas.dims() == 4,\n+        errors::InvalidArgument(\"`bbox_deltas` must be rank 4 but is rank \",\n+                                bbox_deltas.dims()));\n+    OP_REQUIRES(\n+        context, image_info.dims() == 2,\n+        errors::InvalidArgument(\"`image_info` must be rank 2 but is rank \",\n+                                image_info.dims()));\n+    OP_REQUIRES(context, anchors.dims() == 3,\n+                errors::InvalidArgument(\"`anchors` must be rank 3 but is rank \",\n+                                        anchors.dims()));\n+\n     const auto num_images = scores.dim_size(0);\n     const auto num_anchors = scores.dim_size(3);\n     const auto height = scores.dim_size(1);"
        },
        {
          "filename": "tensorflow/python/kernel_tests/image_ops/BUILD",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -96,7 +96,7 @@ tf_py_test(\n     ],\n )\n \n-tf_py_test(\n+cuda_py_test(\n     name = \"draw_bounding_box_op_test\",\n     size = \"small\",\n     srcs = [\"draw_bounding_box_op_test.py\"],"
        },
        {
          "filename": "tensorflow/python/kernel_tests/image_ops/draw_bounding_box_op_test.py",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -16,8 +16,11 @@\n \n import numpy as np\n \n+from tensorflow.python.framework import constant_op\n from tensorflow.python.framework import dtypes\n+from tensorflow.python.framework import errors\n from tensorflow.python.framework import ops\n+from tensorflow.python.framework import test_util\n from tensorflow.python.ops import array_ops\n from tensorflow.python.ops import image_ops\n from tensorflow.python.ops import image_ops_impl\n@@ -131,6 +134,22 @@ def testDrawBoundingBoxHalf(self):\n     self._testDrawBoundingBoxColorCycling(\n         image, dtype=dtypes.half, colors=colors)\n \n+  # generate_bound_box_proposals is only available on GPU.\n+  @test_util.run_gpu_only()\n+  def testGenerateBoundingBoxProposals(self):\n+    # Op only exists on GPU.\n+    with self.cached_session(use_gpu=True):\n+      with self.assertRaisesRegex((ValueError, errors.InvalidArgumentError),\n+                                  \"must be rank 4\"):\n+        scores = constant_op.constant(\n+            value=[[[[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]]]])\n+        self.evaluate(\n+            image_ops.generate_bounding_box_proposals(\n+                scores=scores,\n+                bbox_deltas=[],\n+                image_info=[],\n+                anchors=[],\n+                pre_nms_topn=1))\n \n if __name__ == \"__main__\":\n   test.main()"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "359517872b9281259b49f7186a9de6382598d7ee",
            "date": "2025-01-14T22:18:13Z",
            "author_login": "tensorflower-gardener"
          },
          {
            "sha": "d93cc4f4f767f0d4a72f2fafcc59005be939c019",
            "date": "2025-01-14T20:36:32Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "d4e4516cc7d11a68a81a82227f3a432f7ab350a0",
            "date": "2025-01-14T19:59:15Z",
            "author_login": "ddunl"
          },
          {
            "sha": "65367823d999b6a36a685617100a7bb6ce03add4",
            "date": "2025-01-14T19:58:00Z",
            "author_login": "sdasgup3"
          },
          {
            "sha": "36cbae5466dbf356d91cf56127b2ab2ccd5a8b1f",
            "date": "2025-01-14T19:54:19Z",
            "author_login": "penpornk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-20",
    "description": "TensorFlow is an open source platform for machine learning. When running on GPU, `tf.image.generate_bounding_box_proposals` receives a `scores` input that must be of rank 4 but is not checked. We have patched the issue in GitHub commit cf35502463a88ca7185a99daa7031df60b3c1c98. The fix will be included in TensorFlow 2.11. We will also cherrypick this commit on TensorFlow 2.10.1, 2.9.3, and TensorFlow 2.8.4, as these are also affected and still in supported range.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-11-18T22:15:15.203",
    "last_modified": "2024-11-21T07:23:59.910",
    "fix_date": "2022-10-07T22:30:19Z"
  },
  "references": [
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/cf35502463a88ca7185a99daa7031df60b3c1c98",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-6x99-gv2v-q76v",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/blob/master/tensorflow/core/kernels/image/generate_box_proposals_op.cu.cc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/commit/cf35502463a88ca7185a99daa7031df60b3c1c98",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tensorflow/tensorflow/security/advisories/GHSA-6x99-gv2v-q76v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.135903",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tensorflow",
    "owner": "tensorflow",
    "created_at": "2015-11-07T01:19:20Z",
    "updated_at": "2025-01-14T12:53:26Z",
    "pushed_at": "2025-01-14T12:53:14Z",
    "size": 1120707,
    "stars": 187254,
    "forks": 74432,
    "open_issues": 6569,
    "watchers": 187254,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C++": 101199988,
      "Python": 45779571,
      "MLIR": 10763008,
      "HTML": 7662661,
      "Starlark": 7430486,
      "Go": 2171370,
      "C": 1288066,
      "Java": 1178817,
      "Jupyter Notebook": 805736,
      "Shell": 701425,
      "Objective-C++": 279654,
      "Objective-C": 169202,
      "CMake": 148610,
      "Smarty": 121630,
      "Swift": 81659,
      "Dockerfile": 37903,
      "C#": 13585,
      "Batchfile": 12126,
      "Ruby": 8898,
      "Perl": 7536,
      "Roff": 5034,
      "Cython": 3899,
      "Makefile": 2845,
      "CSS": 2761,
      "Vim Snippet": 58
    },
    "commit_activity": {
      "total_commits_last_year": 15729,
      "avg_commits_per_week": 302.4807692307692,
      "days_active_last_year": 357
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:54:01.412891"
  }
}