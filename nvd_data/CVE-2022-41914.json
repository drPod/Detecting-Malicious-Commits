{
  "cve_id": "CVE-2022-41914",
  "github_data": {
    "repository": "zulip/zulip",
    "fix_commit": "59edbfa4113d140d3e20126bc65f4d67b2a8ffe5",
    "related_commits": [
      "59edbfa4113d140d3e20126bc65f4d67b2a8ffe5",
      "59edbfa4113d140d3e20126bc65f4d67b2a8ffe5"
    ],
    "patch_url": "https://github.com/zulip/zulip/commit/59edbfa4113d140d3e20126bc65f4d67b2a8ffe5.patch",
    "fix_commit_details": {
      "sha": "59edbfa4113d140d3e20126bc65f4d67b2a8ffe5",
      "commit_date": "2022-11-10T01:03:04Z",
      "author": {
        "login": "andersk",
        "type": "User",
        "stats": {
          "total_commits": 4721,
          "average_weekly_commits": 7.296754250386399,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 309
        }
      },
      "commit_message": {
        "title": "scim: Check SCIM tokens using constant-time comparison.",
        "length": 105,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
      },
      "files": [
        {
          "filename": "zerver/middleware.py",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -25,6 +25,7 @@\n from django.shortcuts import render\n from django.utils import translation\n from django.utils.cache import patch_vary_headers\n+from django.utils.crypto import constant_time_compare\n from django.utils.deprecation import MiddlewareMixin\n from django.utils.log import log_response\n from django.utils.translation import gettext as _\n@@ -704,7 +705,10 @@ def validate_scim_bearer_token(request: HttpRequest) -> Optional[SCIMClient]:\n     assert valid_bearer_token\n     assert scim_client_name\n \n-    if request.headers.get(\"Authorization\") != f\"Bearer {valid_bearer_token}\":\n+    authorization = request.headers.get(\"Authorization\")\n+    if authorization is None or not constant_time_compare(\n+        authorization, f\"Bearer {valid_bearer_token}\"\n+    ):\n         return None\n \n     request_notes = RequestNotes.get_notes(request)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a6ac4ed6bf7a529b3b1e26128ad60aebc48eeca3",
            "date": "2025-01-13T16:37:44Z",
            "author_login": "prakhar1144"
          },
          {
            "sha": "25941c1d19283d29d8fa321e399c95f9a80d0c2c",
            "date": "2025-01-13T10:12:42Z",
            "author_login": "prakhar1144"
          },
          {
            "sha": "79da2e38c57c92c65a035feab88ead289efd4784",
            "date": "2025-01-13T07:15:09Z",
            "author_login": "prakhar1144"
          },
          {
            "sha": "6252e3b3cfcf0c377fa7678020a35c872e02b2cc",
            "date": "2025-01-13T06:30:39Z",
            "author_login": "prakhar1144"
          },
          {
            "sha": "fdd0a5ba2c19576c477d8fa6d4f1c0fd7f777d2a",
            "date": "2025-01-14T07:25:53Z",
            "author_login": "prakhar1144"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "Zulip is an open-source team collaboration tool. For organizations with System for Cross-domain Identity Management(SCIM) account management enabled, Zulip Server 5.0 through 5.6 checked the SCIM bearer token using a comparator that did not run in constant time. Therefore, it might theoretically be possible for an attacker to infer the value of the token by performing a sophisticated timing analysis on a large number of failing requests. If successful, this would allow the attacker to impersonate the SCIM client for its abilities to read and update user accounts in the Zulip organization. Organizations where SCIM account management has not been enabled are not affected.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-11-16T20:15:10.580",
    "last_modified": "2024-11-21T07:24:03.447",
    "fix_date": "2022-11-10T01:03:04Z"
  },
  "references": [
    {
      "url": "https://github.com/zulip/zulip/commit/59edbfa4113d140d3e20126bc65f4d67b2a8ffe5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/security/advisories/GHSA-q5gx-377v-w76f",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/commit/59edbfa4113d140d3e20126bc65f4d67b2a8ffe5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/security/advisories/GHSA-q5gx-377v-w76f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:01.024623",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "zulip",
    "owner": "zulip",
    "created_at": "2015-09-25T16:37:25Z",
    "updated_at": "2025-01-14T13:31:30Z",
    "pushed_at": "2025-01-14T02:34:21Z",
    "size": 495185,
    "stars": 21946,
    "forks": 8107,
    "open_issues": 2487,
    "watchers": 21946,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.4.x",
      "1.5.x",
      "1.8.x",
      "1.9.x",
      "2.0.x",
      "2.1.x",
      "3.x",
      "3.1-with-bmemcached",
      "4.x",
      "4.0-rc1-branch",
      "5.x",
      "5.x-user-sharding",
      "5.0-rc1-branch",
      "5.0-rc2-branch",
      "6.x",
      "6.0-beta1-branch",
      "6.0-rc1-branch",
      "7.x",
      "7.0-beta1-branch",
      "7.0-beta2-branch",
      "8.x",
      "9.x",
      "buddy-list-prep",
      "chat.zulip.org",
      "dockertest",
      "main",
      "s3-compatible-uploads",
      "zulip-cloud-current"
    ],
    "languages": {
      "Python": 14193798,
      "TypeScript": 4055572,
      "JavaScript": 2278673,
      "HTML": 957053,
      "CSS": 942085,
      "Handlebars": 597145,
      "Shell": 161466,
      "Puppet": 137563,
      "Perl": 10353,
      "Dockerfile": 4219,
      "Ruby": 3794,
      "Emacs Lisp": 157
    },
    "commit_activity": {
      "total_commits_last_year": 6397,
      "avg_commits_per_week": 123.01923076923077,
      "days_active_last_year": 356
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:44:17.890508"
  }
}