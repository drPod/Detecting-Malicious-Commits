{
  "cve_id": "CVE-2022-41935",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "1450b6e3c69ac7df25e5a2571186d1f43402facd",
    "related_commits": [
      "1450b6e3c69ac7df25e5a2571186d1f43402facd",
      "1450b6e3c69ac7df25e5a2571186d1f43402facd"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd.patch",
    "fix_commit_details": {
      "sha": "1450b6e3c69ac7df25e5a2571186d1f43402facd",
      "commit_date": "2022-07-12T10:04:02Z",
      "author": {
        "login": "manuelleduc",
        "type": "User",
        "stats": {
          "total_commits": 953,
          "average_weekly_commits": 0.9989517819706499,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 179
        }
      },
      "commit_message": {
        "title": "XWIKI-19999: Livetable sources filtering improvement",
        "length": 52,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 37,
        "additions": 36,
        "deletions": 1
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-livetable/xwiki-platform-livetable-ui/src/main/resources/XWiki/LiveTableResultsMacros.xml",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -336,7 +336,12 @@\n   #set ($query = $query.setLimit($limit).setOffset($offset).bindValues($sqlParams))\n   #set($items = $query.execute())\n   #set($discard = $map.put('totalrows', $query.count()))\n-  #set($discard = $map.put('returnedrows', $mathtool.min($items.size(), $limit)))\n+  #if ($limit > 0)\n+    #set($discard = $map.put('returnedrows', $mathtool.min($items.size(), $limit)))\n+  #else\n+    ## When the limit is 0, it's equivalent to no limit at all and the actual number of returned results can be used.\n+    #set($discard = $map.put('returnedrows', $items.size()))\n+  #end\n   #set($discard = $map.put('offset', $mathtool.add($offset, 1)))\n   #set($rows = [])\n   #foreach($item in $items)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-livetable/xwiki-platform-livetable-ui/src/test/java/org/xwiki/livetable/LiveTableResultsTest.java",
          "status": "modified",
          "additions": 30,
          "deletions": 0,
          "patch": "@@ -47,6 +47,7 @@\n import com.xpn.xwiki.objects.classes.StaticListClass;\n import com.xpn.xwiki.plugin.tag.TagPluginApi;\n \n+import static java.util.Collections.emptyList;\n import static org.junit.jupiter.api.Assertions.assertEquals;\n import static org.junit.jupiter.api.Assertions.assertFalse;\n import static org.junit.jupiter.api.Assertions.assertTrue;\n@@ -470,6 +471,35 @@ void removeObfuscatedResultsWhenTotalrowsLowerThanLimit() throws Exception\n         assertEquals(\"XWiki.Viewable\", viewable.get(\"doc_fullName\"));\n     }\n \n+    @Test\n+    void removeObfuscatedResultsWhenLimitIs0() throws Exception\n+    {\n+        when(this.queryService.hql(anyString())).thenReturn(this.query);\n+        when(this.query.setLimit(anyInt())).thenReturn(this.query);\n+        when(this.query.setOffset(anyInt())).thenReturn(this.query);\n+        when(this.query.bindValues(any(Map.class))).thenReturn(this.query);\n+        when(this.query.count()).thenReturn(1L);\n+        when(this.query.execute()).thenReturn(Arrays.asList(\"XWiki.NotViewable\"));\n+\n+        when(this.oldcore.getMockContextualAuthorizationManager()\n+            .hasAccess(same(Right.VIEW), eq(new DocumentReference(\"xwiki\", \"XWiki\", \"NotViewable\")))).thenReturn(false);\n+\n+        this.request.put(\"limit\", \"0\");\n+        this.request.put(\"classname\", \"\");\n+        this.request.put(\"collist\", \"doc.title,doc.location,doc.content\");\n+        this.request.put(\"doc.title\", \"Sandbo\");\n+        this.request.put(\"doc.location\", \"Sandbox.TestPage3\");\n+        this.request.put(\"doc.content\", \"dummy\");\n+        this.request.put(\"limit\", \"0\");\n+\n+        renderPage();\n+\n+        assertEquals(0, getTotalRowCount());\n+        assertEquals(0, getRowCount());\n+        assertEquals(1, getOffset());\n+        assertEquals(emptyList(), getRows());\n+    }\n+\n     //\n     // Helper methods\n     //"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Users without the right to view documents can deduce their existence by repeated Livetable queries. The issue has been patched in XWiki 14.6RC1, 13.10.8, and 14.4.3, the response is not properly cleaned up of obfuscated entries. As a workaround, The patch for the document `XWiki.LiveTableResultsMacros` can be manually applied or a XAR archive of a patched version can be imported, on versions 12.10.11, 13.9-rc-1, and 13.4.4. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-23T20:15:10.177",
    "last_modified": "2024-11-21T07:24:06.347",
    "fix_date": "2022-07-12T10:04:02Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19999",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.161123",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}