{
  "cve_id": "CVE-2022-41937",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "fb49b4f289ee28e45cfada8e97e320cd3ed27113",
    "related_commits": [
      "fb49b4f289ee28e45cfada8e97e320cd3ed27113",
      "fb49b4f289ee28e45cfada8e97e320cd3ed27113"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/fb49b4f289ee28e45cfada8e97e320cd3ed27113.patch",
    "fix_commit_details": {
      "sha": "fb49b4f289ee28e45cfada8e97e320cd3ed27113",
      "commit_date": "2022-06-30T15:49:37Z",
      "author": {
        "login": "tmortagne",
        "type": "User",
        "stats": {
          "total_commits": 12783,
          "average_weekly_commits": 13.39937106918239,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 847
        }
      },
      "commit_message": {
        "title": "XWIKI-19758: Better control in Filter application",
        "length": 49,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 16,
        "deletions": 5
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-filter/xwiki-platform-filter-ui/src/main/resources/Filter/WebHome.xml",
          "status": "modified",
          "additions": 16,
          "deletions": 5,
          "patch": "@@ -20,7 +20,7 @@\n  * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n -->\n \n-<xwikidoc version=\"1.3\" reference=\"Filter.WebHome\" locale=\"\">\n+<xwikidoc version=\"1.5\" reference=\"Filter.WebHome\" locale=\"\">\n   <web>Filter</web>\n   <name>WebHome</name>\n   <language/>\n@@ -36,9 +36,7 @@\n   <minorEdit>false</minorEdit>\n   <syntaxId>xwiki/2.1</syntaxId>\n   <hidden>true</hidden>\n-  <content>{{warning}}Filter module is still young and experimental and while exporting should be safe enough, importing can be more risky for the current instance.{{/warning}}\n-\n-{{include reference=\"FilterStreamDescriptorForm\"/}}\n+  <content>{{include reference=\"FilterStreamDescriptorForm\"/}}\n \n {{velocity output=\"true\"}}\n #set($input = $request.input)\n@@ -77,6 +75,7 @@\n \n {{velocity}}\n #if ($request.convert)\n+  #if ($services.security.authorization.hasAccess('programming', $context.userReference, $doc.documentReference))\n   #if ($targetStandardOutput)\n     $response.setContentType('application/octet-stream')\n     $response.setHeader('Content-Disposition', 'attachment; filename=target');\n@@ -107,6 +106,9 @@\n       #end\n     #end\n   #end\n+  #else\n+    {{error}}You are not allowed to start a conversion.{{/error}}\n+  #end\n #end\n {{/velocity}}\n \n@@ -167,7 +169,11 @@\n   &lt;/fieldset&gt;\n \n   &lt;p&gt;\n-  &lt;input class=\"button\" type=\"submit\" name=\"convert\" value=\"Convert\"/&gt;\n+    #if ($services.security.authorization.hasAccess('programming', $context.userReference, $doc.documentReference))\n+      &lt;input class=\"button\" type=\"submit\" name=\"convert\" value=\"Convert\"/&gt;\n+    #else\n+      &lt;input class=\"button\" type=\"submit\" name=\"convert\" value=\"Convert\" disabled title=\"You are not allowed to start a conversion.\"/&gt;\n+    #end\n   &lt;/p&gt;\n &lt;/div&gt;\n &lt;/form&gt;\n@@ -189,8 +195,11 @@\n       <validationScript/>\n       <cache>\n         <cache>0</cache>\n+        <defaultValue>long</defaultValue>\n         <disabled>0</disabled>\n         <displayType>select</displayType>\n+        <freeText>forbidden</freeText>\n+        <largeStorage>0</largeStorage>\n         <multiSelect>0</multiSelect>\n         <name>cache</name>\n         <number>5</number>\n@@ -238,6 +247,8 @@\n         <cache>0</cache>\n         <disabled>0</disabled>\n         <displayType>select</displayType>\n+        <freeText>forbidden</freeText>\n+        <largeStorage>0</largeStorage>\n         <multiSelect>0</multiSelect>\n         <name>use</name>\n         <number>3</number>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-862",
    "description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The application allows anyone with view access to modify any page of the wiki by importing a crafted XAR package. The problem has been patched in XWiki 14.6RC1, 14.6 and 13.10.8. As a workaround, setting the right of the page Filter.WebHome and making sure only the main wiki administrators can view the application installed on main wiki or edit the page and apply the changed described in commit fb49b4f.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-22T01:15:36.727",
    "last_modified": "2024-11-21T07:24:06.613",
    "fix_date": "2022-06-30T15:49:37Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/fb49b4f289ee28e45cfada8e97e320cd3ed27113",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q6jp-gcww-8v2j",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19758",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/fb49b4f289ee28e45cfada8e97e320cd3ed27113",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q6jp-gcww-8v2j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19758",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.146794",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}