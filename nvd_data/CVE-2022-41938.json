{
  "cve_id": "CVE-2022-41938",
  "github_data": {
    "repository": "flarum/framework",
    "fix_commit": "690de9ce0ffe7ac4d45b73e303f44340c3433138",
    "related_commits": [
      "690de9ce0ffe7ac4d45b73e303f44340c3433138",
      "690de9ce0ffe7ac4d45b73e303f44340c3433138"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "690de9ce0ffe7ac4d45b73e303f44340c3433138",
      "commit_date": "2022-11-18T21:09:22Z",
      "author": {
        "login": "SychO9",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: evaluated page title content (#3684)",
        "length": 281,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 12,
        "deletions": 6
      },
      "files": [
        {
          "filename": "framework/core/js/src/common/Application.tsx",
          "status": "modified",
          "additions": 11,
          "deletions": 5,
          "patch": "@@ -410,16 +410,22 @@ export default class Application {\n       pageNumber: 1,\n     };\n \n-    const title =\n+    let title =\n       onHomepage || !this.title\n         ? extractText(app.translator.trans('core.lib.meta_titles.without_page_title', params))\n         : extractText(app.translator.trans('core.lib.meta_titles.with_page_title', params));\n \n-    const tempEl = document.createElement('div');\n-    tempEl.innerHTML = title;\n-    const decodedTitle = tempEl.innerText;\n+    title = count + title;\n \n-    document.title = count + decodedTitle;\n+    // We pass the title through a DOMParser to allow HTML entities\n+    // to be rendered correctly, while still preventing XSS attacks\n+    // from user input by using a script-disabled environment.\n+    // https://github.com/flarum/framework/issues/3514\n+    // https://github.com/flarum/framework/pull/3684\n+    const parser = new DOMParser();\n+    const safeTitle = parser.parseFromString(title, 'text/html').body.innerHTML;\n+\n+    document.title = safeTitle;\n   }\n \n   protected transformRequestOptions<ResponseType>(flarumOptions: FlarumRequestOptions<ResponseType>): InternalFlarumRequestOptions<ResponseType> {"
        },
        {
          "filename": "framework/core/views/frontend/app.blade.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n       @if ($language) lang=\"{{ $language }}\" @endif>\n     <head>\n         <meta charset=\"utf-8\">\n-        <title>{!! $title !!}</title>\n+        <title>{{ $title }}</title>\n \n         {!! $head !!}\n     </head>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "670aa2e236fab681f32082d2e9b91a4c64c30532",
            "date": "2025-01-17T08:49:10Z",
            "author_login": "flarum-bot"
          },
          {
            "sha": "ac6133a768ef94c8ea8827569a5dfaf11f437a33",
            "date": "2025-01-17T08:44:27Z",
            "author_login": "SychO9"
          },
          {
            "sha": "48ec73f86e2a2ec102330d5d3fb99685b5404516",
            "date": "2025-01-12T12:06:04Z",
            "author_login": "flarum-bot"
          },
          {
            "sha": "00426c85e38efc91554af33644b088e72b3b3c1b",
            "date": "2025-01-12T12:02:07Z",
            "author_login": "SychO9"
          },
          {
            "sha": "33121ed1cc260bf967f0b8c4d10ab5099410bac0",
            "date": "2025-01-11T09:09:46Z",
            "author_login": "SychO9"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-79",
    "description": "Flarum is an open source discussion platform. Flarum's page title system allowed for page titles to be converted into HTML DOM nodes when pages were rendered. The change was made after `v1.5` and was not noticed. This allowed an attacker to inject malicious HTML markup using a discussion title input, either by creating a new discussion or renaming one. The XSS attack occurs after a visitor opens the relevant discussion page. All communities running Flarum from `v1.5.0` to `v1.6.1` are impacted. The vulnerability has been fixed and published as flarum/core `v1.6.2`. All communities running Flarum from `v1.5.0` to `v1.6.1` have to upgrade as soon as possible to v1.6.2. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-19T01:15:10.383",
    "last_modified": "2024-11-21T07:24:06.737",
    "fix_date": "2022-11-18T21:09:22Z"
  },
  "references": [
    {
      "url": "https://discuss.flarum.org/d/27558",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/flarum/framework/commit/690de9ce0ffe7ac4d45b73e303f44340c3433138",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flarum/framework/security/advisories/GHSA-7x4w-j98p-854x",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://discuss.flarum.org/d/27558",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/flarum/framework/commit/690de9ce0ffe7ac4d45b73e303f44340c3433138",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flarum/framework/security/advisories/GHSA-7x4w-j98p-854x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.139045",
    "processing_status": "enhanced"
  }
}