{
  "cve_id": "CVE-2022-41940",
  "github_data": {
    "repository": "socketio/engine.io",
    "fix_commit": "425e833ab13373edf1dd5a0706f07100db14e3c6",
    "related_commits": [
      "425e833ab13373edf1dd5a0706f07100db14e3c6",
      "83c4071af871fc188298d7d591e95670bf9f9085",
      "425e833ab13373edf1dd5a0706f07100db14e3c6",
      "83c4071af871fc188298d7d591e95670bf9f9085"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "425e833ab13373edf1dd5a0706f07100db14e3c6",
      "commit_date": "2022-11-17T15:48:55Z",
      "author": {
        "login": "jonathanneve",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: catch errors when destroying invalid upgrades (#658)",
        "length": 362,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/server.ts",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -678,6 +678,9 @@ export class Server extends BaseServer {\n           setTimeout(function() {\n             // @ts-ignore\n             if (socket.writable && socket.bytesWritten <= 0) {\n+              socket.on(\"error\", e => {\n+                debug(\"error while destroying upgrade: %s\", e.message);\n+              });\n               return socket.end();\n             }\n           }, destroyUpgradeTimeout);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3105a907b734d2e1b0b8dcfa431c5649c8317476",
            "date": "2024-07-09T09:47:02Z",
            "author_login": "darrachequesne"
          },
          {
            "sha": "791aa58f4c0a003335a945fdd704cb910bd35970",
            "date": "2024-06-21T12:32:55Z",
            "author_login": "darrachequesne"
          },
          {
            "sha": "6d8a0bea49a0bbc96875393fa2857aa6a0d63319",
            "date": "2024-06-21T11:43:01Z",
            "author_login": "darrachequesne"
          },
          {
            "sha": "c310b7b6b66236f312f017583a67f81389fa5d72",
            "date": "2024-06-21T11:13:36Z",
            "author_login": "darrachequesne"
          },
          {
            "sha": "362bc78191c607e6b7c7f2b2e7e7ddb2fe53101c",
            "date": "2024-06-21T09:47:41Z",
            "author_login": "darrachequesne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:H",
    "cwe_id": "CWE-248",
    "description": "Engine.IO is the implementation of transport-based cross-browser/cross-device bi-directional communication layer for Socket.IO. A specially crafted HTTP request can trigger an uncaught exception on the Engine.IO server, thus killing the Node.js process. This impacts all the users of the engine.io package, including those who uses depending packages like socket.io. There is no known workaround except upgrading to a safe version. There are patches for this issue released in versions 3.6.1 and 6.2.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-11-22T01:15:37.847",
    "last_modified": "2024-11-21T07:24:06.980",
    "fix_date": "2022-11-17T15:48:55Z"
  },
  "references": [
    {
      "url": "https://github.com/socketio/engine.io/commit/425e833ab13373edf1dd5a0706f07100db14e3c6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/socketio/engine.io/commit/83c4071af871fc188298d7d591e95670bf9f9085",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/socketio/engine.io/security/advisories/GHSA-r7qp-cfhv-p84w",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/socketio/engine.io/commit/425e833ab13373edf1dd5a0706f07100db14e3c6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/socketio/engine.io/commit/83c4071af871fc188298d7d591e95670bf9f9085",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/socketio/engine.io/security/advisories/GHSA-r7qp-cfhv-p84w",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.146946",
    "processing_status": "enhanced"
  }
}