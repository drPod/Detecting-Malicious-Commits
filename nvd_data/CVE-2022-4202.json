{
  "cve_id": "CVE-2022-4202",
  "github_data": {
    "repository": "gpac/gpac",
    "fix_commit": "b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908",
    "related_commits": [
      "b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908",
      "b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908"
    ],
    "patch_url": "https://github.com/gpac/gpac/commit/b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908.patch",
    "fix_commit_details": {
      "sha": "b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908",
      "commit_date": "2022-12-12T08:35:12Z",
      "author": {
        "login": "jeanlf",
        "type": "User",
        "stats": {
          "total_commits": 11740,
          "average_weekly_commits": 11.521099116781159,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 832
        }
      },
      "commit_message": {
        "title": "fixed #2333",
        "length": 11,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 20,
        "deletions": 9
      },
      "files": [
        {
          "filename": "src/laser/lsr_dec.c",
          "status": "modified",
          "additions": 20,
          "deletions": 9,
          "patch": "@@ -300,11 +300,21 @@ static void lsr_read_extension(GF_LASeRCodec *lsr, const char *name)\n \n static void lsr_read_extend_class(GF_LASeRCodec *lsr, char **out_data, u32 *out_len, const char *name)\n {\n-\tu32 len;\n+\tu32 len, blen;\n \tGF_LSR_READ_INT(lsr, len, lsr->info->cfg.extensionIDBits, \"reserved\");\n \tlen = lsr_read_vluimsbf5(lsr, \"len\");\n-//\twhile (len) gf_bs_read_int(lsr->bs, 1);\n-\tgf_bs_read_long_int(lsr->bs, len);\n+\twhile (len && !gf_bs_is_align(lsr->bs)) {\n+\t\tgf_bs_read_int(lsr->bs, len);\n+\t\tlen--;\n+\t}\n+\tblen = len / 8;\n+\tgf_bs_skip_bytes(lsr->bs, blen);\n+\tlen -= blen*8;\n+\n+\twhile (len) {\n+\t\tgf_bs_read_int(lsr->bs, 1);\n+\t\tlen--;\n+\t}\n \tif (out_data) *out_data = NULL;\n \tif (out_len) *out_len = 0;\n }\n@@ -839,10 +849,11 @@ static void lsr_read_id(GF_LASeRCodec *lsr, GF_Node *n)\n static Fixed lsr_translate_coords(GF_LASeRCodec *lsr, u32 val, u32 nb_bits)\n {\n \tif (!nb_bits) return 0;\n-\t\n+\tif (nb_bits>=32) return 0;\n+\n #ifdef GPAC_FIXED_POINT\n \tif (val >> (nb_bits-1) ) {\n-\t\ts32 neg = (s32) val - (1<<nb_bits);\n+\t\ts64 neg = (s64) val - (0x00000001UL << nb_bits);\n \t\tif (neg < -FIX_ONE / 2)\n \t\t\treturn 2 * gf_divfix(INT2FIX(neg/2), lsr->res_factor);\n \t\treturn gf_divfix(INT2FIX(neg), lsr->res_factor);\n@@ -853,18 +864,18 @@ static Fixed lsr_translate_coords(GF_LASeRCodec *lsr, u32 val, u32 nb_bits)\n \t}\n #else\n \tif (val >> (nb_bits-1) ) {\n-\t\ts32 neg = (s32) val - (1<<nb_bits);\n-\t\treturn gf_divfix(INT2FIX(neg), lsr->res_factor);\n+\t\ts64 neg = (s64) val - (0x00000001UL << nb_bits);\n+\t\treturn ((Fixed)neg) / lsr->res_factor;\n \t} else {\n-\t\treturn gf_divfix(INT2FIX(val), lsr->res_factor);\n+\t\treturn ((Fixed)val) / lsr->res_factor;\n \t}\n #endif\n }\n \n static Fixed lsr_translate_scale(GF_LASeRCodec *lsr, u32 val)\n {\n \tif (val >> (lsr->coord_bits-1) ) {\n-\t\ts32 v = val - (1<<lsr->coord_bits);\n+\t\ts64 v = val - (0x00000001UL << lsr->coord_bits);\n \t\treturn INT2FIX(v) / 256 ;\n \t} else {\n \t\treturn INT2FIX(val) / 256;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e075efa1bd0984e0e87f6752f1e5b991ba3a7cf7",
            "date": "2025-01-14T15:00:34Z",
            "author_login": "aureliendavid"
          },
          {
            "sha": "7af1bfcdc25dd74e158437abd13858281ae1bea0",
            "date": "2025-01-14T12:33:00Z",
            "author_login": "aureliendavid"
          },
          {
            "sha": "08572e41a7eae3d7e4329bf88a455ba6cb209936",
            "date": "2025-01-14T12:18:43Z",
            "author_login": "aureliendavid"
          },
          {
            "sha": "5f2c53efbc58ecfb01885c73b9507413efde6c81",
            "date": "2025-01-14T11:46:01Z",
            "author_login": "aureliendavid"
          },
          {
            "sha": "f2082beb80c470f4eaf2bb0421b56e8adcde303a",
            "date": "2025-01-14T11:45:02Z",
            "author_login": "aureliendavid"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-189",
    "description": "A vulnerability, which was classified as problematic, was found in GPAC 2.1-DEV-rev490-g68064e101-master. Affected is the function lsr_translate_coords of the file laser/lsr_dec.c. The manipulation leads to integer overflow. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The name of the patch is b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908. It is recommended to apply a patch to fix this issue. VDB-214518 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-29T09:15:09.460",
    "last_modified": "2024-11-21T07:34:46.350",
    "fix_date": "2022-12-12T08:35:12Z"
  },
  "references": [
    {
      "url": "https://drive.google.com/file/d/1HVWa6IpAbvsMS5rx091RfjUB4GfXrMLE/view",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gpac/gpac/commit/b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gpac/gpac/issues/2333",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.214518",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5411",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://drive.google.com/file/d/1HVWa6IpAbvsMS5rx091RfjUB4GfXrMLE/view",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gpac/gpac/commit/b3d821c4ae9ba62b3a194d9dcb5e99f17bd56908",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gpac/gpac/issues/2333",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.214518",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5411",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.174978",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gpac",
    "owner": "gpac",
    "created_at": "2014-05-03T11:29:57Z",
    "updated_at": "2025-01-14T12:51:06Z",
    "pushed_at": "2025-01-14T12:51:01Z",
    "size": 148655,
    "stars": 2857,
    "forks": 539,
    "open_issues": 84,
    "watchers": 2857,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 29230795,
      "JavaScript": 1164507,
      "C++": 591365,
      "Roff": 570792,
      "Python": 185337,
      "Makefile": 105620,
      "HTML": 100652,
      "Java": 92437,
      "GLSL": 90260,
      "Objective-C": 24884,
      "Shell": 21810,
      "NSIS": 17560,
      "Rez": 13704,
      "CSS": 4998,
      "Batchfile": 4898,
      "Dockerfile": 3216,
      "Nix": 1229
    },
    "commit_activity": {
      "total_commits_last_year": 1273,
      "avg_commits_per_week": 24.48076923076923,
      "days_active_last_year": 239
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:56:58.367536"
  }
}