{
  "cve_id": "CVE-2022-43995",
  "github_data": {
    "repository": "sudo-project/sudo",
    "fix_commit": "bd209b9f16fcd1270c13db27ae3329c677d48050",
    "related_commits": [
      "bd209b9f16fcd1270c13db27ae3329c677d48050",
      "bd209b9f16fcd1270c13db27ae3329c677d48050"
    ],
    "patch_url": "https://github.com/sudo-project/sudo/commit/bd209b9f16fcd1270c13db27ae3329c677d48050.patch",
    "fix_commit_details": {
      "sha": "bd209b9f16fcd1270c13db27ae3329c677d48050",
      "commit_date": "2022-10-28T13:29:55Z",
      "author": {
        "login": "millert",
        "type": "User",
        "stats": {
          "total_commits": 12675,
          "average_weekly_commits": 7.608043217286915,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1196
        }
      },
      "commit_message": {
        "title": "Fix CVE-2022-43995, potential heap overflow for passwords < 8 characters.",
        "length": 279,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 5,
        "deletions": 6
      },
      "files": [
        {
          "filename": "plugins/sudoers/auth/passwd.c",
          "status": "modified",
          "additions": 5,
          "deletions": 6,
          "patch": "@@ -63,7 +63,7 @@ sudo_passwd_init(struct passwd *pw, sudo_auth *auth)\n int\n sudo_passwd_verify(struct passwd *pw, char *pass, sudo_auth *auth, struct sudo_conv_callback *callback)\n {\n-    char sav, *epass;\n+    char des_pass[9], *epass;\n     char *pw_epasswd = auth->data;\n     size_t pw_len;\n     int matched = 0;\n@@ -75,20 +75,19 @@ sudo_passwd_verify(struct passwd *pw, char *pass, sudo_auth *auth, struct sudo_c\n \n     /*\n      * Truncate to 8 chars if standard DES since not all crypt()'s do this.\n-     * If this turns out not to be safe we will have to use OS #ifdef's (sigh).\n      */\n-    sav = pass[8];\n     pw_len = strlen(pw_epasswd);\n-    if (pw_len == DESLEN || HAS_AGEINFO(pw_epasswd, pw_len))\n-\tpass[8] = '\\0';\n+    if (pw_len == DESLEN || HAS_AGEINFO(pw_epasswd, pw_len)) {\n+\tstrlcpy(des_pass, pass, sizeof(des_pass));\n+\tpass = des_pass;\n+    }\n \n     /*\n      * Normal UN*X password check.\n      * HP-UX may add aging info (separated by a ',') at the end so\n      * only compare the first DESLEN characters in that case.\n      */\n     epass = (char *) crypt(pass, pw_epasswd);\n-    pass[8] = sav;\n     if (epass != NULL) {\n \tif (HAS_AGEINFO(pw_epasswd, pw_len) && strlen(epass) == DESLEN)\n \t    matched = !strncmp(pw_epasswd, epass, DESLEN);"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "01b1410d615e3b83851290a9134fcd409003abd0",
            "date": "2025-01-05T21:11:18Z",
            "author_login": "millert"
          },
          {
            "sha": "7c121ff8340c6fa551ba4997dde9d450cf74e40c",
            "date": "2024-12-23T03:31:29Z",
            "author_login": "ivy864"
          },
          {
            "sha": "103af8cb27aa6e61899caca7a20879c58b15f3a4",
            "date": "2025-01-04T16:47:15Z",
            "author_login": "millert"
          },
          {
            "sha": "46831d6ef2c9853a4eaa540d5ee8088a605ac8e0",
            "date": "2025-01-04T15:20:59Z",
            "author_login": "millert"
          },
          {
            "sha": "b52ef1fbbb90df16da3676aeb8f3df90f291fcd8",
            "date": "2025-01-04T14:45:07Z",
            "author_login": "millert"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
    "cwe_id": "CWE-125",
    "description": "Sudo 1.8.0 through 1.9.12, with the crypt() password backend, contains a plugins/sudoers/auth/passwd.c array-out-of-bounds error that can result in a heap-based buffer over-read. This can be triggered by arbitrary local users with access to Sudo by entering a password of seven characters or fewer. The impact could vary depending on the system libraries, compiler, and processor architecture.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-02T14:15:16.187",
    "last_modified": "2024-11-21T07:27:29.393",
    "fix_date": "2022-10-28T13:29:55Z"
  },
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2139911",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sudo-project/sudo/commit/bd209b9f16fcd1270c13db27ae3329c677d48050",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://news.ycombinator.com/item?id=33465707",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202211-08",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.sudo.ws/security/advisories/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2139911",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/sudo-project/sudo/commit/bd209b9f16fcd1270c13db27ae3329c677d48050",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://news.ycombinator.com/item?id=33465707",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202211-08",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.sudo.ws/security/advisories/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:00.985403",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sudo",
    "owner": "sudo-project",
    "created_at": "2016-05-03T13:41:24Z",
    "updated_at": "2025-01-14T12:51:41Z",
    "pushed_at": "2025-01-11T21:38:41Z",
    "size": 215573,
    "stars": 1218,
    "forks": 226,
    "open_issues": 27,
    "watchers": 1218,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 5677215,
      "Shell": 678768,
      "Makefile": 615304,
      "Roff": 420421,
      "M4": 243119,
      "Yacc": 75763,
      "Perl": 53461,
      "Lex": 38443,
      "Pascal": 28666,
      "Python": 27031,
      "C++": 7720,
      "Puppet": 5732,
      "Dockerfile": 3343
    },
    "commit_activity": {
      "total_commits_last_year": 140,
      "avg_commits_per_week": 2.6923076923076925,
      "days_active_last_year": 80
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:06:44.047272"
  }
}