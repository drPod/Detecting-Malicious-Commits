{
  "cve_id": "CVE-2022-4444",
  "github_data": {
    "repository": "ipti/br.tag",
    "fix_commit": "7e311be22d3a0a1b53e61cb987ba13d681d85f06",
    "related_commits": [
      "7e311be22d3a0a1b53e61cb987ba13d681d85f06",
      "7e311be22d3a0a1b53e61cb987ba13d681d85f06"
    ],
    "patch_url": "https://github.com/ipti/br.tag/commit/7e311be22d3a0a1b53e61cb987ba13d681d85f06.patch",
    "fix_commit_details": {
      "sha": "7e311be22d3a0a1b53e61cb987ba13d681d85f06",
      "commit_date": "2022-08-28T21:47:00Z",
      "author": {
        "login": "paulones",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Resolvido issues do XSS",
        "length": 23,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 526,
        "additions": 281,
        "deletions": 245
      },
      "files": [
        {
          "filename": "app/controllers/ClassesController.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -301,14 +301,14 @@ function actionGetDisciplines()\n                         left join instructor_identification ii on t.instructor_fk = ii.id \n                         where ii.users_fk = \" . Yii::app()->user->loginInfos->id . \" and t.classroom_id_fk = \" . $crid . \" order by d.name\")->queryAll();\n         foreach ($disciplines as $discipline) {\n-            echo CHtml::tag('option', array('value' => $discipline['id']), CHtml::encode($disciplinesLabels[$discipline['id']]), true);\n+            echo htmlspecialchars(CHtml::tag('option', array('value' => $discipline['id']), CHtml::encode($disciplinesLabels[$discipline['id']]), true));\n         }\n     } else {\n         echo CHtml::tag('option', array('value' => \"\"), CHtml::encode('Selecione a disciplina'), true);\n         $classr = Yii::app()->db->createCommand(\"select distinct discipline_fk from schedule join edcenso_discipline on edcenso_discipline.id = schedule.discipline_fk where classroom_fk = \" . $crid . \" order by edcenso_discipline.name\")->queryAll();\n         foreach ($classr as $i => $discipline) {\n             if (isset($discipline['discipline_fk'])) {\n-                echo CHtml::tag('option', array('value' => $discipline['discipline_fk']), CHtml::encode($disciplinesLabels[$discipline['discipline_fk']]), true);\n+                echo htmlspecialchars(CHtml::tag('option', array('value' => $discipline['discipline_fk']), CHtml::encode($disciplinesLabels[$discipline['discipline_fk']]), true));\n             }\n         }\n     }"
        },
        {
          "filename": "app/modules/calendar/resources/common/js/calendar.js",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -27,7 +27,7 @@ $(document).on(\"click\", \".create-calendar\", function () {\n         }).success(function (data) {\n             data = JSON.parse(data);\n             if (!data.valid) {\n-                form.find(\".alert\").html(data.error).show();\n+                form.find(\".alert\").html(DOMPurify.sanitize(data.error)).show();\n                 $(\"#myNewCalendar .centered-loading-gif\").hide();\n                 $(\"#myNewCalendar .modal-body\").css(\"opacity\", 1).css(\"pointer-events\", \"auto\");\n                 $(\"#myNewCalendar button\").removeAttr(\"disabled\");\n@@ -68,7 +68,7 @@ $(document).on(\"click\", \".edit-calendar-title-button\", function () {\n                 $(\".calendar-container[data-id=\" + $(\"#edit-calendar-title-modal\").find(\"#Calendar_id\").val() + \"]\").closest(\".accordion-group\").find(\".accordion-title\").text($(\"#edit-calendar-title-modal\").find(\"#Calendar_title\").val());\n                 $(\"#edit-calendar-title-modal\").modal(\"hide\");\n             } else {\n-                $(\"#edit-calendar-title-modal\").find(\".alert\").html(data.error).show();\n+                $(\"#edit-calendar-title-modal\").find(\".alert\").html(DOMPurify.sanitize(data.error)).show();\n             }\n         }).complete(function () {\n             $(\"#edit-calendar-title-modal\").find(\".modal-body\").css(\"opacity\", 1).css(\"pointer-events\", \"auto\");\n@@ -106,7 +106,7 @@ $(document).on(\"click\", \".remove-calendar-button\", function () {\n                 : $(\".no-calendars-alert\").show();\n             $(\"#removeCalendar\").modal(\"hide\");\n         } else {\n-            $(\"#removeCalendar\").find(\".alert\").html(data.error).show();\n+            $(\"#removeCalendar\").find(\".alert\").html(DOMPurify.sanitize(data.error)).show();\n         }\n     }).complete(function () {\n         $(\"#removeCalendar .centered-loading-gif\").hide();\n@@ -137,7 +137,7 @@ $(document).on(\"click\", \".remove-event-button\", function () {\n             eventDays.find(\".calendar-icon\").remove();\n             $(\"#myChangeEvent\").modal(\"hide\");\n         } else {\n-            $(\"#myChangeEvent\").find(\".alert\").html(data.error).show();\n+            $(\"#myChangeEvent\").find(\".alert\").html(DOMPurify.sanitize(data.error)).show();\n         }\n     }).complete(function () {\n         $(\"#myChangeEvent .centered-loading-gif\").hide();\n@@ -238,12 +238,12 @@ $(document).on(\"click\", \".save-event\", function (e) {\n                     date.attr(\"data-id\", data.eventId).attr(\"data-toggle\", \"tooltip\").attr(\"data-placement\", \"top\").attr(\"data-original-title\", data.eventName);\n                     date.parent().addClass(\"calendar-\" + data.color);\n                     date.children(\".calendar-icon\").remove();\n-                    date.prepend(\"<i class='calendar-icon fa \" + data.icon + \"'></i>\");\n+                    date.prepend(\"<i class='calendar-icon fa \" + DOMPurify.sanitize(data.icon) + \"'></i>\");\n                     $(\"#myChangeEvent\").modal(\"hide\");\n                 });\n                 $('[data-toggle=\"tooltip\"]').tooltip({container: \"body\"});\n             } else {\n-                form.find(\".alert\").html(data.error).show();\n+                form.find(\".alert\").html(DOMPurify.sanitize(data.error)).show();\n             }\n         }).complete(function () {\n             $(\"#myChangeEvent .centered-loading-gif\").hide();\n@@ -320,7 +320,7 @@ $(document).on(\"click\", \".change-calendar-status-button\", function () {\n             $(icon).tooltip({container: \"body\"});\n             $(\"#changeCalendarStatus\").modal(\"hide\");\n         } else {\n-            $(\"#changeCalendarStatus\").find(\".alert\").html(data.error).show();\n+            $(\"#changeCalendarStatus\").find(\".alert\").html(DOMPurify.sanitize(data.error)).show();\n         }\n     }).complete(function () {\n         $(\"#changeCalendarStatus .centered-loading-gif\").hide();"
        },
        {
          "filename": "app/modules/quiz/resources/common/js/quiz.js",
          "status": "modified",
          "additions": 20,
          "deletions": 11,
          "patch": "@@ -1,4 +1,4 @@\n-$('#save_button').click(function() { \n+$('#save_button').click(function() {\n     $('#quiz-form').submit();\n });\n \n@@ -9,10 +9,10 @@ $('#delete_button').click(function() {\n         var action = 'index.php?' + (url.indexOf(\"update\") == -1 ? url.replace('create','delete') : url.replace('update','delete'));\n         $('#quiz-form').attr('action', action);\n         $('#quiz-form').submit();\n-    } \n+    }\n });\n \n-$('#save_group_button').click(function() { \n+$('#save_group_button').click(function() {\n     $('#group-form').submit();\n });\n \n@@ -23,10 +23,10 @@ $('#delete_group_button').click(function() {\n         var action = 'index.php?' + (url.indexOf(\"update\") == -1 ? url.replace('create','delete') : url.replace('update','delete'));\n         $('#group-form').attr('action', action);\n         $('#group-form').submit();\n-    } \n+    }\n });\n \n-$('#save_question_group_button').click(function() { \n+$('#save_question_group_button').click(function() {\n     $('#questiongroup-form').submit();\n });\n \n@@ -37,11 +37,11 @@ $('#delete_question_group_button').click(function() {\n         var action = 'index.php?' + (url.indexOf(\"update\") == -1 ? url.replace('create','delete') : url.replace('update','delete'));\n         $('#questiongroup-form').attr('action', action);\n         $('#questiongroup-form').submit();\n-    } \n+    }\n });\n \n \n-$('#save_question_button').click(function() { \n+$('#save_question_button').click(function() {\n     $('#question-form').submit();\n });\n \n@@ -52,10 +52,10 @@ $('#delete_question_button').click(function() {\n         var action = 'index.php?' + (url.indexOf(\"update\") == -1 ? url.replace('create','delete') : url.replace('update','delete'));\n         $('#question-form').attr('action', action);\n         $('#question-form').submit();\n-    } \n+    }\n });\n \n-$('#save_answer_button').click(function() { \n+$('#save_answer_button').click(function() {\n     $('#answer-form').submit();\n });\n \n@@ -80,6 +80,9 @@ var Option = function(){\n                     contentType: \"application/json; charset=utf-8\"\n                   })\n                 .done(function(data){\n+                    data = JSON.stringify(data);\n+                    data = DOMPurify.sanitize(data);\n+                    data = JSON.parse(data);\n                     if(typeof data.errorCode != 'undefined' && data.errorCode == '0'){\n                         var element = $('<tr></tr>')\n                             .attr({'option-id': data.id, 'option-description': data.description, 'option-answer': data.answer, 'option-complement': data.complement})\n@@ -109,6 +112,9 @@ var Option = function(){\n                     contentType: \"application/json; charset=utf-8\"\n                   })\n                 .done(function(data){\n+                    data = JSON.stringify(data);\n+                    data = DOMPurify.sanitize(data);\n+                    data = JSON.parse(data);\n                     if(typeof data.errorCode != 'undefined' && data.errorCode == '0'){\n                        var elementActive = container.find('tr[option-id=\"'+data.id+'\"]');\n                         var element = $('<tr></tr>')\n@@ -235,12 +241,12 @@ var Option = function(){\n             else if(type == 'radio'){\n                 var partialUid = uid.substring(0,(uid.length -1));\n                 var elementChecked = $('input[id^=\"'+partialUid+'\"]:checked');\n-                \n+\n                 if(isChecked){\n                     $('div[id^=\"'+partialUid+'\"]').each(function(){\n                         $(this).hide();\n                     });\n-    \n+\n                     $('input[id^=\"'+partialUid+'\"]').each(function(){\n                         if($(this).attr('type') == 'text')\n                             $(this).prop('disabled',true);\n@@ -286,6 +292,9 @@ var QuizQuestion = function(){\n                     contentType: \"application/json; charset=utf-8\"\n                   })\n                 .done(function(data){\n+                    data = JSON.stringify(data);\n+                    data = DOMPurify.sanitize(data);\n+                    data = JSON.parse(data);\n                     if(typeof data.errorCode != 'undefined' && data.errorCode == '0'){\n                         var element = $('<tr></tr>')\n                             .attr({'key': data.quizId + '' + data.questionId, 'quiz-id': data.quizId, 'question-id': data.questionId, 'question-description': data.description})"
        },
        {
          "filename": "app/modules/timesheet/resources/common/js/timesheet.js",
          "status": "modified",
          "additions": 23,
          "deletions": 23,
          "patch": "@@ -439,29 +439,29 @@ $(document).on(\"click\", \".workloads-activator\", function () {\n     }\n });\n \n-$(document).on(\"click\", \".schedule-selected .instructor-name\", function () {\n-    var instructorId = $(this).attr(\"instructor_id\");\n-    var disciplineId = $(this)\n-        .parent()\n-        .find(\".discipline-name\")\n-        .attr(\"discipline_id\");\n-    var scheduleId = $(this)\n-        .parent()\n-        .attr(\"schedule\");\n-\n-    $.ajax({\n-        url: getInstructorsUrl,\n-        type: \"POST\",\n-        data: {\n-            discipline: disciplineId\n-        }\n-    }).success(function (result) {\n-        $(\"#change-instructor-schedule\").val(scheduleId);\n-        $(\"#change-instructor-id\").html(result);\n-        $(\"#change-instructor-id\").val(instructorId).select2();\n-        $(\"#change-instructor-modal\").modal();\n-    });\n-});\n+// $(document).on(\"click\", \".schedule-selected .instructor-name\", function () {\n+//     var instructorId = $(this).attr(\"instructor_id\");\n+//     var disciplineId = $(this)\n+//         .parent()\n+//         .find(\".discipline-name\")\n+//         .attr(\"discipline_id\");\n+//     var scheduleId = $(this)\n+//         .parent()\n+//         .attr(\"schedule\");\n+//\n+//     $.ajax({\n+//         url: getInstructorsUrl,\n+//         type: \"POST\",\n+//         data: {\n+//             discipline: disciplineId\n+//         }\n+//     }).success(function (result) {\n+//         $(\"#change-instructor-schedule\").val(scheduleId);\n+//         $(\"#change-instructor-id\").html(result);\n+//         $(\"#change-instructor-id\").val(instructorId).select2();\n+//         $(\"#change-instructor-modal\").modal();\n+//     });\n+// });\n $(document).on(\"click\", \"#change-instructor-button\", function () {\n     $.ajax({\n         url: changeInstructorUrl,"
        },
        {
          "filename": "js/classes/class-contents/_initialization.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -76,7 +76,7 @@ $(\"#classroom\").on(\"change\", function () {\n                     if (response == \"\") {\n                         $(\"#disciplines\").html(\"<option value='-1'></option>\").trigger(\"change.select2\").show();\n                     } else {\n-                        $(\"#disciplines\").html(response).trigger(\"change.select2\").show();\n+                        $(\"#disciplines\").html(decodeHtml(response)).trigger(\"change.select2\").show();\n                     }\n                     $(\".disciplines-container\").show();\n                 },"
        },
        {
          "filename": "js/classes/frequency/_initialization.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -89,7 +89,7 @@ $(\"#classroom\").on(\"change\", function () {\n                     if (response === \"\") {\n                         $(\"#disciplines\").html(\"<option value='-1'></option>\").trigger(\"change.select2\").show();\n                     } else {\n-                        $(\"#disciplines\").html(response).trigger(\"change.select2\").show();\n+                        $(\"#disciplines\").html(decodeHtml(response)).trigger(\"change.select2\").show();\n                     }\n                     $(\".disciplines-container\").show();\n                 },"
        },
        {
          "filename": "themes/default/views/reports/index.php",
          "status": "modified",
          "additions": 227,
          "deletions": 200,
          "patch": "@@ -11,268 +11,295 @@\n );\n ?>\n \n-<div class=\"row-fluid\">\n-    <div class=\"span12\">\n-        <h3 class=\"heading-mosaic\"><?php echo Yii::t('default', 'Reports'); ?></h3>  \n-    </div>\n-</div>\n-\n-<div class=\"innerLR home\">\n     <div class=\"row-fluid\">\n-        <?php if (Yii::app()->user->hasFlash('success')): ?>\n-            <div class=\"alert alert-success\">\n-                <?php echo Yii::app()->user->getFlash('success') ?>\n-            </div>\n-            <br/>\n-        <?php endif ?>\n         <div class=\"span12\">\n+            <h3 class=\"heading-mosaic\"><?php echo Yii::t('default', 'Reports'); ?></h3>\n+        </div>\n+    </div>\n+\n+    <div class=\"innerLR home\">\n+        <div class=\"row-fluid\">\n+            <?php if (Yii::app()->user->hasFlash('success')): ?>\n+                <div class=\"alert alert-success\">\n+                    <?php echo Yii::app()->user->getFlash('success') ?>\n+                </div>\n+                <br/>\n+            <?php endif ?>\n+            <div class=\"span12\">\n                 <div class=\"span2\">\n                     <a href=\"#\" data-toggle=\"modal\" data-target=\"#reportFamilyBag\" class=\"widget-stats\" target=\"_blank\">\n-                    <!-- <a  href=\"<?php //echo Yii::app()->createUrl('reports/BFReport')?>\" class=\"widget-stats\"> -->\n+                        <!-- <a  href=\"<?php //echo Yii::app()->createUrl('reports/BFReport')?>\" class=\"widget-stats\"> -->\n                         <div><i class=\"fa-percent fa fa-4x\"></i></div>\n                         <span class=\"report-title\">Frequ\u00eancia para o Bolsa Fam\u00edlia</span>\n                         <div class=\"clearfix\"></div>\n                     </a>\n                 </div>\n                 <div class=\"span2\">\n-                    <a href=\"<?php echo Yii::app()->createUrl('reports/NumberStudentsPerClassroomReport')?>\" class=\"widget-stats\" target=\"_blank\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/NumberStudentsPerClassroomReport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n                         <div><i class=\"fa fa-sort-numeric-asc fa-4x\"></i></div>\n                         <span class=\"report-title\">N\u00famero de Alunos por Turma</span>\n                         <div class=\"clearfix\"></div>\n                     </a>\n                 </div>\n                 <div class=\"span2\">\n-                    <a href=\"<?php echo Yii::app()->createUrl('reports/InstructorsPerClassroomReport')?>\" class=\"widget-stats\" target=\"_blank\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/InstructorsPerClassroomReport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n                         <div><i class=\"fa fa-graduation-cap fa-4x\"></i></div>\n                         <span class=\"report-title\">Professores por Turma</span>\n                         <div class=\"clearfix\"></div>\n                     </a>\n                 </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentsbetween5and14yearsoldreport',array('id'=>Yii::app()->user->school))?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-heartbeat fa-4x\"></i></div>\n-                    <span class=\"report-title\">Alunos com Idade entre 5 e 14 Anos (SUS)</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/enrollmentcomparativeanalysisreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-exchange fa-4x\"></i></div>\n-                    <span class=\"report-title\">An\u00e1lise Comparativa de Matr\u00edculas</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/schoolprofessionalnumberbyclassroomreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><span class=\"glyphicons signal\"><i></i></span></div>\n-                    <span class=\"report-title\">N\u00famero de Profissionais por turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentsbetween5and14yearsoldreport', array('id' => Yii::app()->user->school)) ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-heartbeat fa-4x\"></i></div>\n+                        <span class=\"report-title\">Alunos com Idade entre 5 e 14 Anos (SUS)</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/enrollmentcomparativeanalysisreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-exchange fa-4x\"></i></div>\n+                        <span class=\"report-title\">An\u00e1lise Comparativa de Matr\u00edculas</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/schoolprofessionalnumberbyclassroomreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><span class=\"glyphicons signal\"><i></i></span></div>\n+                        <span class=\"report-title\">N\u00famero de Profissionais por turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n             </div>\n-        </div>\n-        <div class=\"span12\" style=\"margin: 10px 0 0 0\">\n+            <div class=\"span12\" style=\"margin: 10px 0 0 0\">\n \n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/educationalassistantperclassroomreport',array('id'=>Yii::app()->user->school))?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-handshake-o fa-4x\"></i></div>\n-                    <span class=\"report-title\">Auxiliar/Assistente Educacional por Turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/disciplineandinstructorrelationreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-podcast fa-4x\"></i></div>\n-                    <span class=\"report-title\">Rela\u00e7\u00e3o Disciplina/Docente</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/complementaractivityassistantbyclassroomreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-dot-circle-o fa-4x\"></i></div>\n-                    <span class=\"report-title\">Monitores de Atividade Complementar por Turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/classroomwithoutinstructorrelationreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-ban fa-4x\"></i></div>\n-                    <span class=\"report-title\">Rela\u00e7\u00e3o Turmas sem Instrutor</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentinstructornumbersrelationreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-users fa-4x\"></i></div>\n-                    <span class=\"report-title\">N\u00famero de Alunos e Professores por Turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentsbyclassroomreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-address-book fa-4x\"></i></div>\n-                    <span class=\"report-title\">Rela\u00e7\u00e3o de alunos por turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-        </div>\n-        <div class=\"span12\" style=\"margin: 10px 0 0 0\">\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentsinalphabeticalorderrelationreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-sort-alpha-asc fa-4x\"></i></div>\n-                    <span class=\"report-title\">Rela\u00e7ao de Alunos em ordem Alfab\u00e9tica</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentswithdisabilitiesrelationreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-wheelchair fa-4x\"></i></div>\n-                    <span class=\"report-title\">Rela\u00e7\u00e3o Acessibilidade</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentsusingschooltransportationrelationreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-bus fa-4x\"></i></div>\n-                    <span class=\"report-title\">Rela\u00e7\u00e3o Transporte Escolar</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/incompatiblestudentagebyclassroomreport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-street-view fa-4x\"></i></div>\n-                    <span class=\"report-title\">Alunos com Idade Incompat\u00edvel por Turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n-            </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/bfrstudentReport')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><span class=\"glyphicons justify\"><i></i></span></div>\n-                    <span class=\"report-title\">Alunos participantes Bolsa Familia</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/educationalassistantperclassroomreport', array('id' => Yii::app()->user->school)) ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-handshake-o fa-4x\"></i></div>\n+                        <span class=\"report-title\">Auxiliar/Assistente Educacional por Turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/disciplineandinstructorrelationreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-podcast fa-4x\"></i></div>\n+                        <span class=\"report-title\">Rela\u00e7\u00e3o Disciplina/Docente</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/complementaractivityassistantbyclassroomreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-dot-circle-o fa-4x\"></i></div>\n+                        <span class=\"report-title\">Monitores de Atividade Complementar por Turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/classroomwithoutinstructorrelationreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-ban fa-4x\"></i></div>\n+                        <span class=\"report-title\">Rela\u00e7\u00e3o Turmas sem Instrutor</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentinstructornumbersrelationreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-users fa-4x\"></i></div>\n+                        <span class=\"report-title\">N\u00famero de Alunos e Professores por Turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentsbyclassroomreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-address-book fa-4x\"></i></div>\n+                        <span class=\"report-title\">Rela\u00e7\u00e3o de alunos por turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n             </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentpendingdocument')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><i class=\"fa fa-list-ol fa-4x\"></i></div>\n-                    <span class=\"report-title\">Alunos com Documentos Pendentes</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n+            <div class=\"span12\" style=\"margin: 10px 0 0 0\">\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentsinalphabeticalorderrelationreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-sort-alpha-asc fa-4x\"></i></div>\n+                        <span class=\"report-title\">Rela\u00e7ao de Alunos em ordem Alfab\u00e9tica</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentswithdisabilitiesrelationreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-wheelchair fa-4x\"></i></div>\n+                        <span class=\"report-title\">Rela\u00e7\u00e3o Acessibilidade</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentsusingschooltransportationrelationreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-bus fa-4x\"></i></div>\n+                        <span class=\"report-title\">Rela\u00e7\u00e3o Transporte Escolar</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/incompatiblestudentagebyclassroomreport') ?>\"\n+                       class=\"widget-stats\" target=\"_blank\">\n+                        <div><i class=\"fa fa-street-view fa-4x\"></i></div>\n+                        <span class=\"report-title\">Alunos com Idade Incompat\u00edvel por Turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/bfrstudentReport') ?>\" class=\"widget-stats\"\n+                       target=\"_blank\">\n+                        <div><span class=\"glyphicons justify\"><i></i></span></div>\n+                        <span class=\"report-title\">Alunos participantes Bolsa Familia</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentpendingdocument') ?>\" class=\"widget-stats\"\n+                       target=\"_blank\">\n+                        <div><i class=\"fa fa-list-ol fa-4x\"></i></div>\n+                        <span class=\"report-title\">Alunos com Documentos Pendentes</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n             </div>\n-        </div>\n-        <div class=\"span12\" style=\"margin: 10px 0 0 0\">\n-            <div class=\"span2\">\n-                <a href=\"#\" data-toggle=\"modal\" data-target=\"#report\" class=\"widget-stats\" target=\"_blank\">\n-                    <div><span class=\"glyphicons signal\"><i></i></span></div>\n-                    <span class=\"report-title\">Alunos por turma</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n+            <div class=\"span12\" style=\"margin: 10px 0 0 0\">\n+                <div class=\"span2\">\n+                    <a href=\"#\" data-toggle=\"modal\" data-target=\"#report\" class=\"widget-stats\" target=\"_blank\">\n+                        <div><span class=\"glyphicons signal\"><i></i></span></div>\n+                        <span class=\"report-title\">Alunos por turma</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n+                <div class=\"span2\">\n+                    <a href=\"<?php echo Yii::app()->createUrl('reports/studentspecialfood') ?>\" class=\"widget-stats\"\n+                       target=\"_blank\">\n+                        <span class=\"glyphicons fast_food\"><i></i></span>\n+                        <span class=\"txt\">Alunos - Card\u00e1pios Especiais</span>\n+                        <div class=\"clearfix\"></div>\n+                    </a>\n+                </div>\n             </div>\n-            <div class=\"span2\">\n-                <a href=\"<?php echo Yii::app()->createUrl('reports/studentspecialfood')?>\" class=\"widget-stats\" target=\"_blank\">\n-                    <span class=\"glyphicons fast_food\"><i></i></span>\n-                    <span class=\"txt\">Alunos - Card\u00e1pios Especiais</span>\n-                    <div class=\"clearfix\"></div>\n-                </a>\n+            <div class=\"modal fade\" id=\"report\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"New Calendar\">\n+                <div class=\"modal-dialog\" role=\"document\">\n+                    <div class=\"modal-content\">\n+                        <div class=\"modal-header\">\n+                            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span\n+                                        aria-hidden=\"true\">\u00d7</span></button>\n+                            <h4 class=\"modal-title\" id=\"myModalLabel\">Escolha a Turma</h4>\n+                        </div>\n+                        <form class=\"form-vertical\" id=\"createCalendar\" action=\"/br.tag/?r=calendar\" method=\"post\">\n+                            <div class=\"modal-body\">\n+                                <div class=\"row-fluid\">\n+                                    <div class=\" span12\" style=\"margin: 10px 0 10px 0;\">\n+                                        <div class=\"span4\">\n+                                            <?php echo CHtml::label(yii::t('default', 'Classroom'), 'classroom', array('class' => 'control-label')); ?>\n+                                        </div>\n+                                        <div class=\"span8\">\n+                                            <?php\n+                                            echo CHtml::dropDownList('classroom', '', CHtml::listData(Classroom::model()->findAll(array('condition' => 'school_inep_fk=' . Yii::app()->user->school . ' && school_year = ' . Yii::app()->user->year, 'order' => 'name')), 'id', 'name'), array(\n+                                                'key' => 'id',\n+                                                'class' => 'select-search-on',\n+                                                'prompt' => 'Selecione a turma',\n+                                                'ajax' => array(\n+                                                    'type' => 'POST',\n+                                                    'url' => CController::createUrl('classes/getDisciplines'),\n+                                                    'success' => 'function(data){\n+                                                        $(\"#disciplines\").html(decodeHtml(data));\n+                                                    }'\n+                                                )));\n+                                            ?>\n+                                        </div>\n+                                    </div>\n+                                </div>\n+\n+                                <div class=\"modal-footer\" style=\"background-color:#FFF;\">\n+                                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancelar</button>\n+                                    <a class=\"btn btn-primary\"\n+                                       url=\"<?php echo Yii::app()->createUrl('reports/studentbyclassroomreport'); ?>\"\n+                                       type=\"button\" value=\"Gerar\" id=\"buildReport\"> Gerar </a>\n+                                </div>\n+                        </form>\n+                    </div>\n+                </div>\n             </div>\n         </div>\n-        <div class=\"modal fade\" id=\"report\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"New Calendar\">\n-            <div class=\"modal-dialog\" role=\"document\">\n-                <div class=\"modal-content\">\n-                    <div class=\"modal-header\">\n-                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">\u00d7</span></button>\n-                        <h4 class=\"modal-title\" id=\"myModalLabel\">Escolha a Turma</h4>\n-                    </div>\n-                    <form class=\"form-vertical\" id=\"createCalendar\" action=\"/br.tag/?r=calendar\" method=\"post\">            \n+    </div>\n+\n+    <div class=\"modal fade\" id=\"reportFamilyBag\" tabindex=\"-1\" role=\"dialog\">\n+        <div class=\"modal-dialog\" role=\"documentBag\">\n+            <div class=\"modal-content\">\n+                <div class=\"modal-header\">\n+                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span\n+                                aria-hidden=\"true\">\u00d7</span></button>\n+                    <h4 class=\"modal-title\">Frequ\u00eancia Bolsa Fam\u00edlia - Escolha a Turma</h4>\n+                </div>\n+                <form class=\"form-vertical\" action=\"/br.tag/?r=calendar\" method=\"post\">\n                     <div class=\"modal-body\">\n                         <div class=\"row-fluid\">\n                             <div class=\" span12\" style=\"margin: 10px 0 10px 0;\">\n                                 <div class=\"span4\">\n                                     <?php echo CHtml::label(yii::t('default', 'Classroom'), 'classroom', array('class' => 'control-label')); ?>\n                                 </div>\n                                 <div class=\"span8\">\n-                                     <?php\n-                                        echo CHtml::dropDownList('classroom', '', CHtml::listData(Classroom::model()->findAll(array('condition'=>'school_inep_fk=' . Yii::app()->user->school . ' && school_year = ' . Yii::app()->user->year,'order' => 'name')), 'id', 'name'), array(\n-                                            'key' => 'id',\n-                                            'class' => 'select-search-on',\n-                                            'prompt' => 'Selecione a turma',\n-                                            'ajax' => array(\n-                                                'type' => 'POST',\n-                                                'url' => CController::createUrl('classes/getDisciplines'),\n-                                                'update' => '#disciplines',\n-                                        )));\n-                                    ?>\n-                                </div>\n-                            </div>\n-                        </div>\n-\n-                        <div class=\"modal-footer\" style=\"background-color:#FFF;\">\n-                            <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancelar</button>\n-                            <a class=\"btn btn-primary\" url=\"<?php echo Yii::app()->createUrl('reports/studentbyclassroomreport'); ?>\" type=\"button\" value=\"Gerar\" id=\"buildReport\"> Gerar </a>         \n-                        </div>\n-                    </form>        \n-                </div>\n-            </div>\n-        </div>\n-    </div>\n-</div>\n-\n-<div class=\"modal fade\" id=\"reportFamilyBag\" tabindex=\"-1\" role=\"dialog\">\n-    <div class=\"modal-dialog\" role=\"documentBag\">\n-        <div class=\"modal-content\">\n-            <div class=\"modal-header\">\n-                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">\u00d7</span></button>\n-                <h4 class=\"modal-title\">Frequ\u00eancia Bolsa Fam\u00edlia - Escolha a Turma</h4>\n-            </div>\n-            <form class=\"form-vertical\" action=\"/br.tag/?r=calendar\" method=\"post\">            \n-                <div class=\"modal-body\">\n-                    <div class=\"row-fluid\">\n-                        <div class=\" span12\" style=\"margin: 10px 0 10px 0;\">\n-                            <div class=\"span4\">\n-                                <?php echo CHtml::label(yii::t('default', 'Classroom'), 'classroom', array('class' => 'control-label')); ?>\n-                            </div>\n-                            <div class=\"span8\">\n-                                <?php\n-                                    echo CHtml::dropDownList('classroom2', '', CHtml::listData(Classroom::model()->findAll(array('condition'=>'school_inep_fk=' . Yii::app()->user->school . ' && school_year = ' . Yii::app()->user->year,'order' => 'name')), 'id', 'name'), array(\n+                                    <?php\n+                                    echo CHtml::dropDownList('classroom2', '', CHtml::listData(Classroom::model()->findAll(array('condition' => 'school_inep_fk=' . Yii::app()->user->school . ' && school_year = ' . Yii::app()->user->year, 'order' => 'name')), 'id', 'name'), array(\n                                         'key' => 'id',\n                                         'class' => 'select-search-on',\n                                         'prompt' => 'Todas as turmas',\n                                         'ajax' => array(\n                                             'type' => 'POST',\n                                             'url' => CController::createUrl('classes/getDisciplines'),\n-                                            'update' => '#disciplines',\n-                                    )));\n-                                ?>\n+                                            'success' => 'function(data){\n+                                                $(\"#disciplines\").html(decodeHtml(data));\n+                                            }'\n+                                        )));\n+                                    ?>\n+                                </div>\n                             </div>\n                         </div>\n                     </div>\n-                </div>\n \n-                <div class=\"modal-footer\" style=\"background-color:#FFF;\">\n-                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancelar</button>\n-                    <a class=\"btn btn-primary\" url=\"<?php echo Yii::app()->createUrl('reports/BFReport'); ?>\" type=\"button\" value=\"Gerar\" id=\"buildReportBF\"> Gerar </a>         \n-                </div>\n-            </form>        \n+                    <div class=\"modal-footer\" style=\"background-color:#FFF;\">\n+                        <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Cancelar</button>\n+                        <a class=\"btn btn-primary\" url=\"<?php echo Yii::app()->createUrl('reports/BFReport'); ?>\"\n+                           type=\"button\" value=\"Gerar\" id=\"buildReportBF\"> Gerar </a>\n+                    </div>\n+                </form>\n+            </div>\n         </div>\n     </div>\n-</div>\n \n <?php\n \n $cs = Yii::app()->getClientScript();\n-$cs->registerScript('buildReport',\"  \n+$cs->registerScript('buildReport', \"  \n     $('#buildReport').live('click', function(event) {\n         var url = $(this).attr('url');\n         var id = $('#classroom').val();\n         $(this).attr('url', url + '&id='+ id);\n     });\n     registerAndOpenTab('#buildReport');\", CClientScript::POS_END);\n \n-$cs->registerScript('buildReportBF',\"  \n+$cs->registerScript('buildReportBF', \"  \n     $('#buildReportBF').live('click', function(event) {\n         var url = $(this).attr('url');\n         var id = $('#classroom2').val();\n         $(this).attr('url', url + '&id='+ id);\n     });\n     registerAndOpenTab('#buildReportBF');\", CClientScript::POS_END);\n \n- ?>\n\\ No newline at end of file\n+?>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 7,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0a27dbdcda48d3cc8661ca3876abbb6061f1f969",
            "date": "2025-01-13T14:21:27Z",
            "author_login": "igorgoncalves"
          },
          {
            "sha": "b215ee1d409b46ac088a1ead65cd0cdd5b5aaa0b",
            "date": "2025-01-04T15:06:12Z",
            "author_login": "igorgoncalves"
          },
          {
            "sha": "d9947ddaf11ad274d4570ba251c80da43767dd6f",
            "date": "2025-01-04T14:52:15Z",
            "author_login": "igorgoncalves"
          },
          {
            "sha": "98a68a8305cccf08f125541c0a9b258d32175b4d",
            "date": "2025-01-03T19:51:08Z",
            "author_login": "igorgoncalves"
          },
          {
            "sha": "33cba5d34c7695c7160781b53dda6edba103f4d4",
            "date": "2025-01-03T19:32:19Z",
            "author_login": "igorgoncalves"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability was found in ipti br.tag. It has been declared as problematic. Affected by this vulnerability is an unknown functionality. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 2.13.0 is able to address this issue. The name of the patch is 7e311be22d3a0a1b53e61cb987ba13d681d85f06. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-215431.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-13T09:15:09.120",
    "last_modified": "2024-11-21T07:35:16.493",
    "fix_date": "2022-08-28T21:47:00Z"
  },
  "references": [
    {
      "url": "https://github.com/ipti/br.tag/commit/7e311be22d3a0a1b53e61cb987ba13d681d85f06",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ipti/br.tag/pull/131",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215431",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ipti/br.tag/commit/7e311be22d3a0a1b53e61cb987ba13d681d85f06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ipti/br.tag/pull/131",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215431",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.225875",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "br.tag",
    "owner": "ipti",
    "created_at": "2013-11-26T13:11:02Z",
    "updated_at": "2025-01-13T14:21:50Z",
    "pushed_at": "2025-01-14T15:49:55Z",
    "size": 76007,
    "stars": 19,
    "forks": 4,
    "open_issues": 23,
    "watchers": 19,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "3.1.1"
    ],
    "languages": {
      "PHP": 8061686,
      "JavaScript": 4524495,
      "CSS": 676427,
      "Less": 194418,
      "HTML": 148132,
      "SCSS": 65359,
      "Hack": 13150,
      "Roff": 13056,
      "Dockerfile": 1472,
      "Batchfile": 380
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T17:09:10.052376"
  }
}