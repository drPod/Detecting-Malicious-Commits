{
  "cve_id": "CVE-2022-4456",
  "github_data": {
    "repository": "falling-fruit/falling-fruit",
    "fix_commit": "15adb8e1ea1f1c3e3d152fc266071f621ef0c621",
    "related_commits": [
      "15adb8e1ea1f1c3e3d152fc266071f621ef0c621",
      "15adb8e1ea1f1c3e3d152fc266071f621ef0c621"
    ],
    "patch_url": "https://github.com/falling-fruit/falling-fruit/commit/15adb8e1ea1f1c3e3d152fc266071f621ef0c621.patch",
    "fix_commit_details": {
      "sha": "15adb8e1ea1f1c3e3d152fc266071f621ef0c621",
      "commit_date": "2022-03-07T23:09:07Z",
      "author": {
        "login": "ezwelty",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge branch 'fix-xss-vulnerabilities'",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 8,
        "deletions": 8
      },
      "files": [
        {
          "filename": "app/views/changes/index.html.erb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -27,7 +27,7 @@ last_days_ago = nil\n     last_days_ago = c[\"days_ago\"]\n   end\n   %>\n-  <%= raw header %>\n+  <%= header.html_safe %>\n   <% unless c[\"location_id\"].nil? %>\n     <%= link_to location_path(c[\"location_id\"]) do %>\n       <span><%= types.nil? ? translate(\"glossary.unknown\") : types %></span>"
        },
        {
          "filename": "app/views/imports/show.html.erb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -26,12 +26,12 @@\n   <span style=\"font-size:100%;\">\n   <!-- Comments -->\n   <% unless @import.comments.blank? %>\n-    <%= raw @import.comments.gsub(\"\\n\",\"<br>\") %><br /><br />\n+    <%= ERB::Util.html_escape(@import.comments).gsub(\"\\n\", \"<br/>\").html_safe %><br /><br />\n   <% end %>\n \n   <!-- License -->\n   <% unless @import.license.blank? %>\n-    <%= raw @import.license.gsub(\"\\n\",\"<br>\") %>\n+    <%= ERB::Util.html_escape(@import.license).gsub(\"\\n\", \"<br/>\").html_safe %>\n   <% else %>\n     <i><%= translate(\"pages.datasets.no_license\").html_safe %></i>\n   <% end %>"
        },
        {
          "filename": "app/views/layouts/application.html.erb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -74,7 +74,7 @@\n   <% end %>\n   <script type=\"text/javascript\">\n     host = \"<%= host %>\";\n-    cats = <%= raw @categories %>;\n+    cats = <%= @categories.map{|c| ERB::Util.html_escape(c)}.to_json.html_safe %>;\n     // load I18n\n     I18n.defaultLocale = \"<%= I18n.default_locale %>\";\n     I18n.locale = \"<%= I18n.locale %>\";"
        },
        {
          "filename": "app/views/pages/datasets.html.erb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -42,11 +42,11 @@ Import.order(\"id\").reverse.each do |import|\n     <td style=\"display:none;\">\n       <!-- Comments -->\n       <% unless import.comments.blank? %>\n-        <%= raw import.comments.gsub(\"\\n\",\"<br/>\") %><br /><br />\n+        <%= ERB::Util.html_escape(import.comments).gsub(\"\\n\", \"<br/>\").html_safe %><br /><br />\n       <% end %>\n       <!-- License -->\n       <% unless import.license.blank? %>\n-        <%= raw import.license.gsub(\"\\n\",\"<br/>\") %>\n+        <%= ERB::Util.html_escape(import.license).gsub(\"\\n\", \"<br/>\").html_safe %>\n       <% else %>\n         <i><%= translate(\"pages.datasets.no_license\").html_safe %></i>\n       <% end %>"
        },
        {
          "filename": "app/views/types/grow.html.erb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -17,7 +17,7 @@\n <td style=\"text-align:right\"><%= type.id %></td>\n <td>\n  <% unless type.wikipedia_url.blank? %>\n-  <a href=\"<%= raw type.wikipedia_url %>\" target=\"_blank\"><%= h type.en_name %></a>\n+  <a href=\"<%= type.wikipedia_url %>\" target=\"_blank\"><%= h type.en_name %></a>\n  <% else %>\n   <%= type.en_name %>\n  <% end %>"
        },
        {
          "filename": "app/views/types/index.html.erb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -34,7 +34,7 @@\n       <td><%= mask_to_array(type.category_mask,Type::Categories).join(\", \") %></td>\n       <td style=\"text-align:center;\">\n       <% unless type.wikipedia_url.blank? %>\n-        <a href=\"<%= raw type.wikipedia_url %>\" target=\"_blank\">W</a>\n+        <a href=\"<%= type.wikipedia_url %>\" target=\"_blank\">W</a>\n       <% end %>\n       </td>\n       <td><%= link_to 'Edit', edit_type_path(type) %></td>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d7226484186053b9eafb13c7ae3f2cc820fcea4e",
            "date": "2024-12-18T17:57:40Z",
            "author_login": "ezwelty"
          },
          {
            "sha": "3b561199e7e07ccbdb4bae992ac32d7362ca25f7",
            "date": "2024-12-13T20:35:15Z",
            "author_login": "ezwelty"
          },
          {
            "sha": "2af28916d72131ad1c4d9a3a03381fdcd4d6bc9f",
            "date": "2024-12-13T20:33:55Z",
            "author_login": "ezwelty"
          },
          {
            "sha": "1f634471df952b32dd0418b40c1c6f250549a777",
            "date": "2024-12-13T20:33:31Z",
            "author_login": "ezwelty"
          },
          {
            "sha": "6847f67fba86fdffc0997d38ed89af5a3fe100d4",
            "date": "2024-12-11T20:30:10Z",
            "author_login": "ezwelty"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability has been found in falling-fruit and classified as problematic. This vulnerability affects unknown code. The manipulation leads to cross site scripting. The attack can be initiated remotely. The name of the patch is 15adb8e1ea1f1c3e3d152fc266071f621ef0c621. It is recommended to apply a patch to fix this issue. VDB-215446 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-13T18:15:10.967",
    "last_modified": "2024-11-21T07:35:18.057",
    "fix_date": "2022-03-07T23:09:07Z"
  },
  "references": [
    {
      "url": "https://github.com/falling-fruit/falling-fruit/commit/15adb8e1ea1f1c3e3d152fc266071f621ef0c621",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215446",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/falling-fruit/falling-fruit/commit/15adb8e1ea1f1c3e3d152fc266071f621ef0c621",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215446",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.228680",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "falling-fruit",
    "owner": "falling-fruit",
    "created_at": "2013-04-11T03:35:23Z",
    "updated_at": "2024-12-18T17:57:53Z",
    "pushed_at": "2024-12-18T17:57:49Z",
    "size": 88627,
    "stars": 79,
    "forks": 23,
    "open_issues": 10,
    "watchers": 79,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "HTML": 409911,
      "JavaScript": 249766,
      "Ruby": 231357,
      "CoffeeScript": 51519,
      "PLpgSQL": 36661,
      "SCSS": 30240,
      "R": 4338,
      "Shell": 3496,
      "Python": 2191,
      "Makefile": 572
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T19:26:29.006064"
  }
}