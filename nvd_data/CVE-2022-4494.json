{
  "cve_id": "CVE-2022-4494",
  "github_data": {
    "repository": "bspkrs/MCPMappingViewer",
    "fix_commit": "6e602746c96b4756c271d080dae7d22ad804a1bd",
    "related_commits": [
      "6e602746c96b4756c271d080dae7d22ad804a1bd",
      "6e602746c96b4756c271d080dae7d22ad804a1bd"
    ],
    "patch_url": "https://github.com/bspkrs/MCPMappingViewer/commit/6e602746c96b4756c271d080dae7d22ad804a1bd.patch",
    "fix_commit_details": {
      "sha": "6e602746c96b4756c271d080dae7d22ad804a1bd",
      "commit_date": "2022-09-23T03:45:37Z",
      "author": {
        "login": "JLLeitschuh",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "vuln-fix: Zip Slip Vulnerability",
        "length": 1435,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/main/java/bspkrs/mmv/RemoteZipHandler.java",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -220,6 +220,9 @@ public static void extractZip(File zipFile, File destDir) throws IOException\n             {\n                 String fileName = ze.getName();\n                 File newFile = new File(destDir, fileName);\n+                if (!newFile.toPath().normalize().startsWith(destDir.toPath().normalize())) {\n+                    throw new IOException(\"Bad zip entry\");\n+                }\n                 if (ze.isDirectory())\n                 {\n                     if (newFile.exists())"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "756b6bd16fcc7bb1eb60fd9b78796cd9aee4277f",
            "date": "2022-09-23T14:21:14Z",
            "author_login": "bspkrs"
          },
          {
            "sha": "6e602746c96b4756c271d080dae7d22ad804a1bd",
            "date": "2022-09-23T03:45:37Z",
            "author_login": "JLLeitschuh"
          },
          {
            "sha": "cc754ad6e8502fa02c35de0fffad83c1a1956a03",
            "date": "2022-02-11T20:03:32Z",
            "author_login": "bspkrs"
          },
          {
            "sha": "197de65027426c70e1388df244a3ef7e41eceaa7",
            "date": "2021-11-18T21:34:22Z",
            "author_login": "bspkrs"
          },
          {
            "sha": "4f2bb23fb51ed02b7adcb6c3746b2a6e63ee064f",
            "date": "2021-11-18T21:32:23Z",
            "author_login": "bspkrs"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-22",
    "description": "A vulnerability, which was classified as critical, has been found in bspkrs MCPMappingViewer. Affected by this issue is the function extractZip of the file src/main/java/bspkrs/mmv/RemoteZipHandler.java of the component ZIP File Handler. The manipulation leads to path traversal. The attack may be launched remotely. The name of the patch is 6e602746c96b4756c271d080dae7d22ad804a1bd. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-215804.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-14T12:15:09.983",
    "last_modified": "2024-11-21T07:35:22.483",
    "fix_date": "2022-09-23T03:45:37Z"
  },
  "references": [
    {
      "url": "https://github.com/bspkrs/MCPMappingViewer/commit/6e602746c96b4756c271d080dae7d22ad804a1bd",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215804",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bspkrs/MCPMappingViewer/commit/6e602746c96b4756c271d080dae7d22ad804a1bd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215804",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.231148",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "MCPMappingViewer",
    "owner": "bspkrs",
    "created_at": "2013-06-12T19:46:19Z",
    "updated_at": "2025-01-12T00:51:15Z",
    "pushed_at": "2022-09-23T14:21:14Z",
    "size": 734,
    "stars": 232,
    "forks": 50,
    "open_issues": 9,
    "watchers": 232,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 176956
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:57:37.568919"
  }
}