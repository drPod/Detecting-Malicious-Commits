{
  "cve_id": "CVE-2022-45129",
  "github_data": {
    "repository": "payara/Payara",
    "fix_commit": "cccdfddeda71c78ae7b3179db5429e1bb8a56b2e",
    "related_commits": [
      "cccdfddeda71c78ae7b3179db5429e1bb8a56b2e",
      "cccdfddeda71c78ae7b3179db5429e1bb8a56b2e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "cccdfddeda71c78ae7b3179db5429e1bb8a56b2e",
      "commit_date": "2022-10-24T15:26:02Z",
      "author": {
        "login": "Pandrex247",
        "type": "User",
        "stats": {
          "total_commits": 2776,
          "average_weekly_commits": 5.065693430656935,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 410
        }
      },
      "commit_message": {
        "title": "Merge pull request #5989 from luiseufrasio/FISH-6603",
        "length": 131,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 16,
        "deletions": 4
      },
      "files": [
        {
          "filename": "appserver/web/web-core/src/main/java/org/apache/catalina/core/StandardContextValve.java",
          "status": "modified",
          "additions": 11,
          "deletions": 4,
          "patch": "@@ -68,6 +68,7 @@\n import javax.servlet.http.HttpServletResponse;\n import java.io.IOException;\n import java.util.Locale;\n+import java.util.regex.Pattern;\n \n import org.glassfish.grizzly.utils.Charsets;\n \n@@ -97,6 +98,11 @@ final class StandardContextValve\n \n     private StandardContext context = null;\n \n+    private static final Pattern PATTERN_META_INF = Pattern.compile(\"[.]{2}[/]?.*[/](META-INF[/].*|META-INF$)\",\n+            Pattern.CASE_INSENSITIVE);\n+\n+    private static final Pattern PATTERN_WEB_INF = Pattern.compile(\"[.]{2}[/]?.*[/](WEB-INF[/].*|WEB-INF$)\",\n+            Pattern.CASE_INSENSITIVE);\n \n     // ------------------------------------------------------------- Properties\n \n@@ -294,12 +300,13 @@ protected String normalize(String path) {\n         if (rv.indexOf(\"./\") == 0) {\n             rv = rv.replaceFirst(\"./\", \"/\");\n         }\n-        // has /WEB-INF or /META-INF\n-        final String RV = rv.toUpperCase();\n-        int index = RV.indexOf(\"/WEB-INF/\");\n-        if (index != -1 || RV.endsWith(\"/WEB-INF\")) {\n+        // has ../*/WEB-INF/* or ../*/META-INF/*\n+        if (PATTERN_WEB_INF.matcher(rv).find()) {\n             return \"/WEB-INF\";\n         }\n+        if (PATTERN_META_INF.matcher(rv).find()) {\n+            return \"/META-INF\";\n+        }\n \n         // Normalize the slashes and add leading slash if necessary\n         if (rv.indexOf('\\\\') >= 0) {"
        },
        {
          "filename": "appserver/web/web-core/src/test/java/org/apache/catalina/core/StandardContextValveTest.java",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -97,6 +97,7 @@ public void normalizeURLTest() {\n         String path2 = \"/app/./some/./something/./my.jsp\";\n         String path3 = \"./my.jsp\";\n         String path4 = \"../app/WEB-INF/web.xml\";\n+        String path5 = \"../app/META-INF/MANIFEST.MF\";\n \n         String result = standardContextValve.normalize(path1);\n \n@@ -113,6 +114,10 @@ public void normalizeURLTest() {\n         result = standardContextValve.normalize(path4);\n \n         assertEquals(\"/WEB-INF\", result);\n+\n+        result = standardContextValve.normalize(path5);\n+\n+        assertEquals(\"/META-INF\", result);\n     }\n \n     protected void verifyThatResourceIsNotFound(int pipelineResult, int times, HttpRequest httpRequest, HttpResponse httpResponse,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7804c66f5599cb2760dd04ec915067ca88ef6b79",
            "date": "2025-01-24T14:46:39Z",
            "author_login": "luiseufrasio"
          },
          {
            "sha": "2fbf611e8311db64ee7424cb8172b2d8dc141f23",
            "date": "2025-01-24T13:52:16Z",
            "author_login": "luiseufrasio"
          },
          {
            "sha": "d817094d600260e2d1026679065b362b1984baeb",
            "date": "2025-01-24T13:04:03Z",
            "author_login": "luiseufrasio"
          },
          {
            "sha": "82d9783b26afc9227f27dd5efd9c445f9f81f673",
            "date": "2025-01-24T13:00:36Z",
            "author_login": "luiseufrasio"
          },
          {
            "sha": "41b52f2a7b942e484e76e6ea48017529c1368d9a",
            "date": "2025-01-17T18:26:06Z",
            "author_login": "luiseufrasio"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-552",
    "description": "Payara before 2022-11-04, when deployed to the root context, allows attackers to visit META-INF and WEB-INF, a different vulnerability than CVE-2022-37422. This affects Payara Platform Community before 4.1.2.191.38, 5.x before 5.2022.4, and 6.x before 6.2022.1, and Payara Platform Enterprise before 5.45.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-11-10T06:15:13.813",
    "last_modified": "2024-11-21T07:28:48.863",
    "fix_date": "2022-10-24T15:26:02Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/169864/Payara-Platform-Path-Traversal.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2022/Nov/11",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blog.payara.fish/whats-new-in-the-november-2022-payara-platform-release",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.payara.fish/community/docs/6.2022.1/Release%20Notes/Release%20Notes%206.2022.1.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.payara.fish/community/docs/Release%20Notes/Release%20Notes%205.2022.4.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.payara.fish/enterprise/docs/Release%20Notes/Release%20Notes%205.45.0.html",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/payara/Payara/commit/cccdfddeda71c78ae7b3179db5429e1bb8a56b2e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/169864/Payara-Platform-Path-Traversal.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2022/Nov/11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blog.payara.fish/whats-new-in-the-november-2022-payara-platform-release",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.payara.fish/community/docs/6.2022.1/Release%20Notes/Release%20Notes%206.2022.1.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.payara.fish/community/docs/Release%20Notes/Release%20Notes%205.2022.4.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.payara.fish/enterprise/docs/Release%20Notes/Release%20Notes%205.45.0.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/payara/Payara/commit/cccdfddeda71c78ae7b3179db5429e1bb8a56b2e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:01.006351",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "Payara",
    "owner": "payara",
    "created_at": "2014-09-11T18:32:40Z",
    "updated_at": "2025-01-25T12:19:29Z",
    "pushed_at": "2025-01-24T14:46:40Z",
    "size": 175512,
    "stars": 891,
    "forks": 305,
    "open_issues": 122,
    "watchers": 891,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "FISH-5959",
      "FISH-6599",
      "FISH-7278-MicroProfile-6.1",
      "FISH-7960-Fix-Deploy-Core",
      "FISH-7985-Notification-Filtering",
      "FISH-7997-Update-docker-jdk",
      "FISH-8262_FISH-8263_FISH-8264-upgrade-docker-jdk",
      "FISH-8310-3rd-party-build-improvement",
      "FISH-8377-enable-dependabot-payaya6",
      "FISH-8497-add-dependabot-conditions",
      "FISH-10055",
      "FISH-10274-Revert-Parsson-Upgrade",
      "Payara4",
      "Payara6",
      "Payara7",
      "Payara-6.2023.10-Release",
      "Payara-6.2023.11-Release",
      "Payara-6.2023.12-Release",
      "Payara-6.2024.1-Release",
      "Payara-6.2024.2-Release",
      "Payara-6.2024.3-Release",
      "Payara-6.2024.4-Release",
      "Payara-6.2024.5-Release",
      "Payara-6.2024.6-Release",
      "Payara-6.2024.7-Release",
      "Payara-6.2024.8-Release",
      "Payara-6.2024.9-Release",
      "Payara-6.2024.10-Release"
    ],
    "languages": {
      "Java": 65017922,
      "HTML": 6910655,
      "Roff": 1193643,
      "CSS": 798762,
      "GAP": 350375,
      "Python": 297335,
      "C++": 146436,
      "JavaScript": 146338,
      "Shell": 94319,
      "Batchfile": 64575,
      "NASL": 62380,
      "Ruby": 40961,
      "Dockerfile": 18346,
      "C#": 8335,
      "PLSQL": 8069,
      "PHP": 5224,
      "C": 4855,
      "BitBake": 4623,
      "Pawn": 3448,
      "Groovy": 2756,
      "FreeMarker": 1614
    },
    "commit_activity": {
      "total_commits_last_year": 1061,
      "avg_commits_per_week": 20.403846153846153,
      "days_active_last_year": 201
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:34:01.826416"
  }
}