{
  "cve_id": "CVE-2022-4514",
  "github_data": {
    "repository": "OpencachingDeutschland/oc-server3",
    "fix_commit": "4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f",
    "related_commits": [
      "4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f",
      "4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f"
    ],
    "patch_url": "https://github.com/OpencachingDeutschland/oc-server3/commit/4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f.patch",
    "fix_commit_details": {
      "sha": "4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f",
      "commit_date": "2022-12-12T13:33:38Z",
      "author": {
        "login": "teiling88",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #902 from sdennler/fix/open-bug-bounty-issues-2",
        "length": 118,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "htdocs/editcache.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -123,7 +123,7 @@ function getWaypoints($cacheId)\n         $cache_record = sql_fetch_array($cache_rs);\n         sql_free_result($cache_rs);\n \n-        if ($cache_record !== false) {\n+        if (is_array($cache_record)) {\n             if ($cache_record['user_id'] == $usr['userid'] || $login->listingAdmin()) {\n                 $tplname = 'editcache';\n                 tpl_acceptsAndPurifiesHtmlInput();"
        },
        {
          "filename": "htdocs/lang/de/ocstyle/varset.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -49,7 +49,7 @@\n \n foreach($_REQUEST as $varname => $varvalue) {\n     if (in_array($varname, $allowed)) {\n-        $target .= $varname . '=' . $varvalue . '&';\n+        $target .= $varname . '=' . htmlspecialchars($varvalue) . '&';\n     }\n }\n if (mb_substr($target, - 1) == '?' || mb_substr($target, - 1) == '&') {"
        },
        {
          "filename": "htdocs/lib/clicompatbase.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -506,7 +506,7 @@ function sql_warn($warnmessage): void\n /**\n  * @deprecated use DBAL Conenction instead. See adminreports.php for an example implementation\n  * @param resource $rs\n- * @return array\n+ * @return array|false|null\n  */\n function sql_fetch_array($rs)\n {"
        },
        {
          "filename": "htdocs/lib2/db.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -567,7 +567,7 @@ function sql_value_internal($bQuerySlave, $sql, $default)\n /**\n  * @deprecated use DBAL Conenction instead. See adminreports.php for an example implementation\n  * @param $rs\n- * @return array\n+ * @return array|false|null\n  */\n function sql_fetch_array($rs)\n {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dc165f942cc48cb317604357852b6b603f1f8840",
            "date": "2024-01-17T16:37:50Z",
            "author_login": "teiling88"
          },
          {
            "sha": "e786ef2bb2aac026bf1497f8ac4ecb0f385df03d",
            "date": "2024-01-17T16:37:18Z",
            "author_login": "teiling88"
          },
          {
            "sha": "66fe24f61a73de45c50fd87c19addcf76dfcfcaa",
            "date": "2024-01-03T20:29:12Z",
            "author_login": "sdennler"
          },
          {
            "sha": "1b194e3cfa873a107daeda12269fb7ab88e4cc37",
            "date": "2024-01-03T20:15:26Z",
            "author_login": "fraggle-DE"
          },
          {
            "sha": "df8e89767f68cc4ad0e42d9560cb0397f45ce4b6",
            "date": "2023-11-28T20:04:08Z",
            "author_login": "teiling88"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability, which was classified as problematic, was found in Opencaching Deutschland oc-server3. Affected is an unknown function of the file htdocs/lang/de/ocstyle/varset.inc.php. The manipulation of the argument varvalue leads to cross site scripting. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The name of the patch is 4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f. It is recommended to apply a patch to fix this issue. VDB-215886 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-15T20:15:10.133",
    "last_modified": "2024-11-21T07:35:24.900",
    "fix_date": "2022-12-12T13:33:38Z"
  },
  "references": [
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/commit/4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/pull/902",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215886",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/commit/4bdd6a0e7b7760cea03b91812cbb80d7b16e3b5f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/pull/902",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215886",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.167991",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "oc-server3",
    "owner": "OpencachingDeutschland",
    "created_at": "2012-05-09T17:24:36Z",
    "updated_at": "2024-11-04T22:46:53Z",
    "pushed_at": "2024-01-17T18:16:20Z",
    "size": 66308,
    "stars": 42,
    "forks": 46,
    "open_issues": 4,
    "watchers": 42,
    "has_security_policy": false,
    "default_branch": "development",
    "protected_branches": [
      "development",
      "next",
      "stable"
    ],
    "languages": {
      "PHP": 4005313,
      "JavaScript": 2953384,
      "CSS": 962468,
      "Smarty": 891660,
      "HTML": 474313,
      "Twig": 172736,
      "Shell": 24787,
      "SCSS": 9537,
      "Dockerfile": 1848
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:11:43.090603"
  }
}