{
  "cve_id": "CVE-2022-4558",
  "github_data": {
    "repository": "Alinto/sogo",
    "fix_commit": "1e0f5f00890f751e84d67be4f139dd7f00faa5f3",
    "related_commits": [
      "1e0f5f00890f751e84d67be4f139dd7f00faa5f3",
      "1e0f5f00890f751e84d67be4f139dd7f00faa5f3"
    ],
    "patch_url": "https://github.com/Alinto/sogo/commit/1e0f5f00890f751e84d67be4f139dd7f00faa5f3.patch",
    "fix_commit_details": {
      "sha": "1e0f5f00890f751e84d67be4f139dd7f00faa5f3",
      "commit_date": "2022-11-22T09:09:41Z",
      "author": {
        "login": "WoodySlum",
        "type": "User",
        "stats": {
          "total_commits": 420,
          "average_weekly_commits": 0.4325437693099897,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 106
        }
      },
      "commit_message": {
        "title": "fix(security): Security fix for WSTG-INPV-02. Add XSS protection on folders and mail title / content",
        "length": 100,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 82,
        "additions": 49,
        "deletions": 33
      },
      "files": [
        {
          "filename": "SoObjects/SOGo/NSString+Utilities.m",
          "status": "modified",
          "additions": 49,
          "deletions": 33,
          "patch": "@@ -898,35 +898,49 @@ - (NSString *) decryptWithKey: (NSString *) theKey\n  */\n - (NSString *) stringWithoutHTMLInjection: (BOOL)stripHTMLCode\n {\n-  NSString *result, *text;\n-  NSScanner *theScanner;\n-  NSError *error;\n-\n-  text = nil;\n-  error = nil;\n-  result = [NSString stringWithString: self];\n-\n-  if (stripHTMLCode) {\n-    // Author : https://www.codercrunch.com/question/1251681838/how-remove-html-tags-string-ios\n-    theScanner = [NSScanner scannerWithString: result];\n-    while ([theScanner isAtEnd] == NO) {\n-      // find start of tag\n-      [theScanner scanUpToString: @\"<\" intoString: NULL];\n-      // find end of tag\n-      [theScanner scanUpToString: @\">\" intoString: &text];\n-      // replace the found tag with a space\n-      //(you can filter multi-spaces out later if you wish)\n-      result = [result stringByReplacingOccurrencesOfString:\n-              [NSString stringWithFormat: @\"%@>\", text]\n-              withString: @\" \"];\n-    } \n-  } else {\n-    // Clean XSS\n-    // Examples of injection : https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-locator-polygot\n-\n-    // NSRegularExpression is not implemented in old GNUStep versions (ubuntu trusty)\n-    if (NSClassFromString(@\"NSRegularExpression\")) {\n-      NSRegularExpression *regex = nil;\n+  // NSRegularExpression is not implemented in old GNUStep versions (ubuntu trusty)\n+  if (NSClassFromString(@\"NSRegularExpression\")) {\n+    NSString *result, *text;\n+    NSScanner *theScanner;\n+    NSError *error;\n+    NSUInteger numberOfMatches;\n+    NSRegularExpression *regex;\n+\n+    text = nil;\n+    error = nil;\n+    result = [NSString stringWithString: self];\n+    regex = nil;\n+\n+    if (stripHTMLCode) {\n+      // Author : https://www.codercrunch.com/question/1251681838/how-remove-html-tags-string-ios\n+      theScanner = [NSScanner scannerWithString: result];\n+      while ([theScanner isAtEnd] == NO) {\n+        // find start of tag\n+        [theScanner scanUpToString: @\"<\" intoString: NULL];\n+        // find end of tag\n+        [theScanner scanUpToString: @\">\" intoString: &text];\n+        \n+        // Check that text is not <xxx@xx.net\n+        regex = [NSRegularExpression regularExpressionWithPattern:@\"^<[a-zA-Z.\\\\-_]+@[a-zA-Z.\\\\-_]+.[a-zA-Z]+$\"\n+                                    options: NSRegularExpressionCaseInsensitive error:&error];\n+        numberOfMatches = 0;\n+        \n+        if (text && !error) {\n+          numberOfMatches = [regex numberOfMatchesInString: text \n+                                                      options:0 \n+                                                      range:NSMakeRange(0, [text length])];\n+          if (0 == numberOfMatches) {\n+            // replace the found tag with a space\n+            //(you can filter multi-spaces out later if you wish)\n+            result = [result stringByReplacingOccurrencesOfString:\n+                    [NSString stringWithFormat: @\"%@>\", text]\n+                    withString: @\" \"];\n+          }\n+        }\n+      } \n+    } else {\n+      // Clean XSS\n+      // Examples of injection : https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-locator-polygot\n \n       // Remove javascript:\n       regex = [NSRegularExpression regularExpressionWithPattern:@\"j[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*a[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*v[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*a[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*s[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*c[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*r[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*i[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*p[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*t[\\\\s\\\\u200B&#x09;&#x0A;&#x0D;\\\\\\\\0]*:\"\n@@ -967,10 +981,12 @@ - (NSString *) stringWithoutHTMLInjection: (BOOL)stripHTMLCode\n       regex = [NSRegularExpression regularExpressionWithPattern:@\"onmouseover=\" \n                                   options: NSRegularExpressionCaseInsensitive error:&error];\n       result = [regex stringByReplacingMatchesInString:result options:0 range:NSMakeRange(0, [result length]) withTemplate:@\"onmouseo***=\"];\n-    }\n-  }  \n-  \n-  return result;\n+    }  \n+    \n+    return result;\n+  } else {\n+    return self;\n+  }\n }\n \n @end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9941e2a04b9807dbc0a7f3dc0b4e07210a8e55f4",
            "date": "2025-01-07T17:39:02Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "b40d777a86104d08dbd8168b8e12c198a3d4321a",
            "date": "2024-12-23T14:35:14Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "70f72eb92f0f14501758a5660391aa43862e98e7",
            "date": "2024-12-23T10:18:28Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "0a828a739e10299605eaff72ffaf90a1908b54e8",
            "date": "2024-12-18T09:39:27Z",
            "author_login": "WoodySlum"
          },
          {
            "sha": "395a01ed5204c6c138e7d855370dd8acf902e6b4",
            "date": "2024-12-17T17:27:53Z",
            "author_login": "WoodySlum"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability was found in Alinto SOGo up to 5.7.1. It has been classified as problematic. This affects an unknown part of the file SoObjects/SOGo/NSString+Utilities.m of the component Folder/Mail Handler. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 5.8.0 is able to address this issue. The name of the patch is 1e0f5f00890f751e84d67be4f139dd7f00faa5f3. It is recommended to upgrade the affected component. The identifier VDB-215961 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-16T17:15:08.873",
    "last_modified": "2024-11-21T07:35:29.273",
    "fix_date": "2022-11-22T09:09:41Z"
  },
  "references": [
    {
      "url": "https://github.com/Alinto/sogo/commit/1e0f5f00890f751e84d67be4f139dd7f00faa5f3",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Alinto/sogo/releases/tag/SOGo-5.8.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215961",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Alinto/sogo/commit/1e0f5f00890f751e84d67be4f139dd7f00faa5f3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Alinto/sogo/releases/tag/SOGo-5.8.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.215961",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.172326",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sogo",
    "owner": "Alinto",
    "created_at": "2012-09-18T12:19:38Z",
    "updated_at": "2025-01-14T18:06:21Z",
    "pushed_at": "2025-01-14T10:12:13Z",
    "size": 179571,
    "stars": 1852,
    "forks": 278,
    "open_issues": 26,
    "watchers": 1852,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Objective-C": 5166699,
      "JavaScript": 1139785,
      "SCSS": 172305,
      "C": 115950,
      "Rich Text Format": 76362,
      "HTML": 75145,
      "Shell": 72483,
      "Java": 50238,
      "Makefile": 47449,
      "Perl": 32089,
      "Python": 31012,
      "CSS": 11864,
      "PHP": 3047,
      "PLSQL": 1055,
      "Mathematica": 986
    },
    "commit_activity": {
      "total_commits_last_year": 311,
      "avg_commits_per_week": 5.980769230769231,
      "days_active_last_year": 124
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T18:37:58.445766"
  }
}