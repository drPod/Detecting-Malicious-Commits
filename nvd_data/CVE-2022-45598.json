{
  "cve_id": "CVE-2022-45598",
  "github_data": {
    "repository": "laurent22/joplin",
    "fix_commit": "a2de167b95debad83a0f0c7925a88c0198db812e",
    "related_commits": [
      "a2de167b95debad83a0f0c7925a88c0198db812e",
      "a2de167b95debad83a0f0c7925a88c0198db812e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a2de167b95debad83a0f0c7925a88c0198db812e",
      "commit_date": "2022-11-14T17:16:59Z",
      "author": {
        "login": "laurent22",
        "type": "User",
        "stats": {
          "total_commits": 7930,
          "average_weekly_commits": 18.31408775981524,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 393
        }
      },
      "commit_message": {
        "title": "All: Security: Fix XSS when a specially crafted string is passed to the renderer",
        "length": 80,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
      },
      "files": [
        {
          "filename": "packages/app-cli/tests/md_to_html/sanitize_12.html",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+<div class=\"joplin-editable\"><pre class=\"joplin-source\" data-joplin-language=\"&quot;&gt;&lt;svg/onload=top.eval(atob(&quot;cmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWMoJ29wZW4gLW4gL1N5c3RlbS9BcHBsaWNhdGlvbnMvQ2FsY3VsYXRvci5hcHAvQ29udGVudHMvTWFjT1MvQ2FsY3VsYXRvcicp&quot;))&gt;\" data-joplin-source-open=\"```&quot;&gt;&lt;svg/onload=top.eval(atob(&quot;cmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWMoJ29wZW4gLW4gL1N5c3RlbS9BcHBsaWNhdGlvbnMvQ2FsY3VsYXRvci5hcHAvQ29udGVudHMvTWFjT1MvQ2FsY3VsYXRvcicp&quot;))&gt;&#10;\" data-joplin-source-close=\"&#10;```\">ts</pre><pre class=\"hljs\"><code><span class=\"hljs-attribute\">ts</span></code></pre></div>"
        },
        {
          "filename": "packages/app-cli/tests/md_to_html/sanitize_12.md",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+```\"><svg/onload=top.eval(atob(\"cmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWMoJ29wZW4gLW4gL1N5c3RlbS9BcHBsaWNhdGlvbnMvQ2FsY3VsYXRvci5hcHAvQ29udGVudHMvTWFjT1MvQ2FsY3VsYXRvcicp\"))>\n+ts\n+```"
        },
        {
          "filename": "packages/renderer/MdToHtml.ts",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -8,6 +8,8 @@ import { RenderResult, RenderResultPluginAsset } from './MarkupToHtml';\n import { Options as NoteStyleOptions } from './noteStyle';\n import hljs from './highlight';\n \n+const Entities = require('html-entities').AllHtmlEntities;\n+const htmlentities = new Entities().encode;\n const MarkdownIt = require('markdown-it');\n const md5 = require('md5');\n \n@@ -482,7 +484,7 @@ export default class MdToHtml {\n \t\t\t\t// The strings includes the last \\n that is part of the fence,\n \t\t\t\t// so we remove it because we need the exact code in the source block\n \t\t\t\tconst trimmedStr = this.removeLastNewLine(str);\n-\t\t\t\tconst sourceBlockHtml = `<pre class=\"joplin-source\" data-joplin-language=\"${lang}\" data-joplin-source-open=\"\\`\\`\\`${lang}&#10;\" data-joplin-source-close=\"&#10;\\`\\`\\`\">${markdownIt.utils.escapeHtml(trimmedStr)}</pre>`;\n+\t\t\t\tconst sourceBlockHtml = `<pre class=\"joplin-source\" data-joplin-language=\"${htmlentities(lang)}\" data-joplin-source-open=\"\\`\\`\\`${htmlentities(lang)}&#10;\" data-joplin-source-close=\"&#10;\\`\\`\\`\">${markdownIt.utils.escapeHtml(trimmedStr)}</pre>`;\n \n \t\t\t\tif (this.shouldSkipHighlighting(trimmedStr, lang)) {\n \t\t\t\t\toutputCodeHtml = markdownIt.utils.escapeHtml(trimmedStr);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5a3d57e39ad36223687f4dac9abd40d8ebefb6ed",
            "date": "2025-01-26T02:30:00Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "e22ccd6edf370336f0619d2ba5697394173971f9",
            "date": "2025-01-24T00:49:56Z",
            "author_login": "joplinbot"
          },
          {
            "sha": "8aec0ae44599669073c80240388916e0caf1de36",
            "date": "2025-01-23T23:55:20Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "24a2f5452ca056833cc9ce3869543a9558955788",
            "date": "2025-01-23T23:42:51Z",
            "author_login": "personalizedrefrigerator"
          },
          {
            "sha": "d6f1ca4ba4ec31338a4feb58c35575d17727aabf",
            "date": "2025-01-23T22:57:15Z",
            "author_login": "personalizedrefrigerator"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross Site Scripting vulnerability in Joplin Desktop App before v2.9.17 allows attacker to execute arbitrary code via improper santization.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-31T16:15:09.053",
    "last_modified": "2024-11-21T07:29:28.403",
    "fix_date": "2022-11-14T17:16:59Z"
  },
  "references": [
    {
      "url": "https://github.com/laurent22/joplin/commit/a2de167b95debad83a0f0c7925a88c0198db812e",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/laurent22/joplin/releases/tag/v2.9.17",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/laurent22/joplin/commit/a2de167b95debad83a0f0c7925a88c0198db812e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/laurent22/joplin/releases/tag/v2.9.17",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.957429",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "joplin",
    "owner": "laurent22",
    "created_at": "2017-01-16T21:49:41Z",
    "updated_at": "2025-01-26T07:47:53Z",
    "pushed_at": "2025-01-26T02:30:02Z",
    "size": 510130,
    "stars": 47387,
    "forks": 5148,
    "open_issues": 462,
    "watchers": 47387,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "TypeScript": 8596447,
      "JavaScript": 2399494,
      "Rust": 424402,
      "HTML": 236849,
      "CSS": 134921,
      "Java": 126765,
      "Mustache": 74783,
      "Objective-C": 47291,
      "Handlebars": 31635,
      "Shell": 29681,
      "SCSS": 26798,
      "Kotlin": 17183,
      "Ruby": 4892,
      "Objective-C++": 3082,
      "MDX": 1722,
      "Starlark": 1318,
      "C": 419,
      "Swift": 370,
      "Batchfile": 138
    },
    "commit_activity": {
      "total_commits_last_year": 1635,
      "avg_commits_per_week": 31.442307692307693,
      "days_active_last_year": 281
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:18:03.069448"
  }
}