{
  "cve_id": "CVE-2022-4587",
  "github_data": {
    "repository": "OpencachingDeutschland/oc-server3",
    "fix_commit": "3296ebd61e7fe49e93b5755d5d7766d6e94a7667",
    "related_commits": [
      "3296ebd61e7fe49e93b5755d5d7766d6e94a7667",
      "3296ebd61e7fe49e93b5755d5d7766d6e94a7667"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3296ebd61e7fe49e93b5755d5d7766d6e94a7667",
      "commit_date": "2022-09-04T17:29:35Z",
      "author": {
        "login": "sdennler",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix XSS on login page (OBB-1146814)",
        "length": 35,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "htdocs/templates2/ocstyle/login.tpl",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -2,6 +2,7 @@\n * You can find the license in the docs directory\n ***************************************************************************}\n {* OCSTYLE *}\n+<h1>login.tpl</h1>\n <div class=\"content2-pagetitle\">\n     <img src=\"resource2/{$opt.template.style}/images/misc/32x32-profile.png\" style=\"margin-right: 10px;\" width=\"32\" height=\"32\" alt=\"\" />\n     {t}Login{/t}\n@@ -41,7 +42,7 @@\n     <table class=\"table\">\n         <tr>\n             <td>{t}Username:{/t}</td>\n-            <td><input name=\"email\" maxlength=\"80\" type=\"text\" value=\"{$username}\" class=\"input200\" /></td>\n+            <td><input name=\"email\" maxlength=\"80\" type=\"text\" value=\"{$username|escape}\" class=\"input200\" /></td>\n         </tr>\n         <tr>\n             <td>{t}Password:{/t}</td>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1540b56f4dfa05495454f96757ef5ddf30cf31bd",
            "date": "2025-01-21T23:47:54Z",
            "author_login": "MacGyver-NRW"
          },
          {
            "sha": "ffa83f8e7d168866db30536f0db105216384122f",
            "date": "2025-01-21T23:47:09Z",
            "author_login": "MacGyver-NRW"
          },
          {
            "sha": "dc165f942cc48cb317604357852b6b603f1f8840",
            "date": "2024-01-17T16:37:50Z",
            "author_login": "teiling88"
          },
          {
            "sha": "e786ef2bb2aac026bf1497f8ac4ecb0f385df03d",
            "date": "2024-01-17T16:37:18Z",
            "author_login": "teiling88"
          },
          {
            "sha": "66fe24f61a73de45c50fd87c19addcf76dfcfcaa",
            "date": "2024-01-03T20:29:12Z",
            "author_login": "sdennler"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability, which was classified as problematic, has been found in Opencaching Deutschland oc-server3. This issue affects some unknown processing of the file htdocs/templates2/ocstyle/login.tpl of the component Login Page. The manipulation of the argument username leads to cross site scripting. The attack may be initiated remotely. The name of the patch is 3296ebd61e7fe49e93b5755d5d7766d6e94a7667. It is recommended to apply a patch to fix this issue. The identifier VDB-216173 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-17T13:15:09.730",
    "last_modified": "2024-11-21T07:35:32.837",
    "fix_date": "2022-09-04T17:29:35Z"
  },
  "references": [
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/commit/3296ebd61e7fe49e93b5755d5d7766d6e94a7667",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/pull/893",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216173",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/commit/3296ebd61e7fe49e93b5755d5d7766d6e94a7667",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/OpencachingDeutschland/oc-server3/pull/893",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216173",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.176155",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "oc-server3",
    "owner": "OpencachingDeutschland",
    "created_at": "2012-05-09T17:24:36Z",
    "updated_at": "2025-01-21T23:47:58Z",
    "pushed_at": "2025-01-21T23:47:54Z",
    "size": 66324,
    "stars": 42,
    "forks": 46,
    "open_issues": 4,
    "watchers": 42,
    "has_security_policy": false,
    "default_branch": "development",
    "protected_branches": [
      "development",
      "next",
      "stable"
    ],
    "languages": {
      "PHP": 4005313,
      "JavaScript": 2953384,
      "CSS": 962468,
      "Smarty": 891662,
      "HTML": 474313,
      "Twig": 172736,
      "Shell": 24787,
      "SCSS": 9537,
      "Dockerfile": 1848
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:59:21.413335"
  }
}