{
  "cve_id": "CVE-2022-4604",
  "github_data": {
    "repository": "khromov/wp-english-wp-admin",
    "fix_commit": "ad4ba171c974c65c3456e7c6228f59f40783b33d",
    "related_commits": [
      "ad4ba171c974c65c3456e7c6228f59f40783b33d",
      "ad4ba171c974c65c3456e7c6228f59f40783b33d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "ad4ba171c974c65c3456e7c6228f59f40783b33d",
      "commit_date": "2022-02-23T22:28:03Z",
      "author": {
        "login": "khromov",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix vulnerability",
        "length": 17,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 15,
        "deletions": 6
      },
      "files": [
        {
          "filename": "english-wp-admin.php",
          "status": "modified",
          "additions": 10,
          "deletions": 5,
          "patch": "@@ -3,7 +3,7 @@\n Plugin Name: English WordPress Admin\n Plugin URI: http://wordpress.org/plugins/english-wp-admin\n Description: Lets users change their administration language to English\n-Version: 1.5.1\n+Version: 1.5.2\n Author: khromov\n Author URI: http://snippets.khromov.se\n GitHub Plugin URI: khromov/wp-english-wp-admin\n@@ -89,15 +89,17 @@ function register_endpoints()\n \t{\n \t\t//We're in admin\n \t\tif(is_admin()) {\n-\t\t\t//Is the GET variable set?\n-\t\t\tif(isset($_GET['admin_custom_language_toggle'])) {\n+\t\t\t\n+\t\t\t//Is the GET variables required set?\n+\t\t\tif(isset($_GET['admin_custom_language_toggle']) && isset($_GET['nonce'])) {\n+\n \t\t\t\t//Cast variable\n \t\t\t\t$cookie_value = intval($_GET['admin_custom_language_toggle']);\n \n \t\t\t\t//Set cookie\n \t\t\t\t$cookie_value === 1 ? $this->set_cookie(1) : $this->set_cookie(0);\n \n-\t\t\t\tif(isset($_GET['admin_custom_language_return_url'])) {\n+\t\t\t\tif(isset($_GET['admin_custom_language_return_url']) && wp_verify_nonce( $_GET['nonce'], 'english_wordpress_admin_redirect')) {\n \t\t\t\t\twp_redirect(urldecode($_GET['admin_custom_language_return_url']));\n \t\t\t\t}\n \t\t\t\telse {\n@@ -254,12 +256,15 @@ function admin_bar($wp_admin_bar)\n \t{\n \t\t//We're in admin and this is not a WPML install\n \t\tif(is_admin() && apply_filters('english_wordpress_admin_show_admin_bar', true) === true) {\n+\t\t\t\n \t\t\t//Sets up the toggle link\n+\t\t\t$toggle_nonce = wp_create_nonce('english_wordpress_admin_redirect');\n+\n \t\t\tif($this->in_url_whitelist()) {\n \t\t\t\t$toggle_href =  plugin_dir_url( __FILE__ ) . 'readme.txt';\n \t\t\t}\n \t\t\telse {\n-\t\t\t\t$toggle_href = admin_url('?admin_custom_language_toggle=' . ($this->english_admin_enabled() ? '0' : '1') . '&admin_custom_language_return_url=' . urlencode((is_ssl() ? 'https' : 'http') . '://' . $_SERVER[\"HTTP_HOST\"] . $_SERVER[\"REQUEST_URI\"]));\n+\t\t\t\t$toggle_href = admin_url('?admin_custom_language_toggle=' . ($this->english_admin_enabled() ? '0' : '1') . '&nonce=' . $toggle_nonce . '&admin_custom_language_return_url=' . urlencode((is_ssl() ? 'https' : 'http') . '://' . $_SERVER[\"HTTP_HOST\"] . $_SERVER[\"REQUEST_URI\"]));\n \t\t\t}\n \n \t\t\t//Create toggle title"
        },
        {
          "filename": "readme.txt",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@ Contributors: khromov\n Tags: english, wpml, multilanguage\n Requires at least: 3.5\n Tested up to: 5.3\n-Stable tag: 1.5.1\n+Stable tag: 1.5.2\n License: GPL2\n \n Lets users change their administration language to English\n@@ -100,6 +100,10 @@ You can leave feature requests in the plugin support forum.\n \n == Changelog ==\n \n+= 1.5.2 =\n+\n+* Fix for unauthenticated open redirect vulnerability\n+\n = 1.5.1 =\n \n * Fix for PHP 5.2"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4b80cd0f638fc4ce27e94341dead179871efbbeb",
            "date": "2022-02-23T22:42:26Z",
            "author_login": "khromov"
          },
          {
            "sha": "7287500045f2610cd8268956fdd25d836aae924c",
            "date": "2022-02-23T22:39:49Z",
            "author_login": "khromov"
          },
          {
            "sha": "3bea336dbc6cdd2acfb664ac937de52f56fd3e1c",
            "date": "2022-02-23T22:30:55Z",
            "author_login": "khromov"
          },
          {
            "sha": "ddb9a90d7d3599e7aed3ff59fa8855dffe222e39",
            "date": "2022-02-23T22:28:47Z",
            "author_login": "khromov"
          },
          {
            "sha": "ad4ba171c974c65c3456e7c6228f59f40783b33d",
            "date": "2022-02-23T22:28:03Z",
            "author_login": "khromov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-352",
    "description": "A vulnerability classified as problematic was found in wp-english-wp-admin Plugin up to 1.5.1. Affected by this vulnerability is the function register_endpoints of the file english-wp-admin.php. The manipulation leads to cross-site request forgery. The attack can be launched remotely. Upgrading to version 1.5.2 is able to address this issue. The name of the patch is ad4ba171c974c65c3456e7c6228f59f40783b33d. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216199.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-18T11:15:11.170",
    "last_modified": "2024-11-21T07:35:34.920",
    "fix_date": "2022-02-23T22:28:03Z"
  },
  "references": [
    {
      "url": "https://github.com/khromov/wp-english-wp-admin/commit/ad4ba171c974c65c3456e7c6228f59f40783b33d",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/khromov/wp-english-wp-admin/releases/tag/1.5.2",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216199",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/khromov/wp-english-wp-admin/commit/ad4ba171c974c65c3456e7c6228f59f40783b33d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/khromov/wp-english-wp-admin/releases/tag/1.5.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216199",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.179805",
    "processing_status": "enhanced"
  }
}