{
  "cve_id": "CVE-2022-4606",
  "github_data": {
    "repository": "flatpressblog/flatpress",
    "fix_commit": "c30d52b28483e1e512d0d81758d4c149f02b4068",
    "related_commits": [
      "c30d52b28483e1e512d0d81758d4c149f02b4068",
      "c30d52b28483e1e512d0d81758d4c149f02b4068"
    ],
    "patch_url": "https://github.com/flatpressblog/flatpress/commit/c30d52b28483e1e512d0d81758d4c149f02b4068.patch",
    "fix_commit_details": {
      "sha": "c30d52b28483e1e512d0d81758d4c149f02b4068",
      "commit_date": "2022-10-08T11:43:33Z",
      "author": {
        "login": "azett",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge branch 'master' of https://github.com/flatpressblog/flatpress into issue94_smartyupdate",
        "length": 175,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 1158,
        "additions": 848,
        "deletions": 310
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 27,
          "deletions": 14,
          "patch": "@@ -7,29 +7,42 @@\n - [README](https://github.com/flatpressblog/flatpress/blob/master/README.md): added \"help and support\" section\n \n ## Plugins\n-- Gallery captions plugin added (see [#108](https://github.com/flatpressblog/flatpress/issues/108))\n-- PhotoSwipe plugin added (see [#109](https://github.com/flatpressblog/flatpress/issues/109))\n+- Gallery captions plugin added ([#108](https://github.com/flatpressblog/flatpress/issues/108))\n+- PhotoSwipe plugin added ([#109](https://github.com/flatpressblog/flatpress/issues/109))\n - jQuery plugin: Updated jQuery (3.5.1 => 3.6) and jQueryUI (1.12.1 => 1.13.1)\n - Media Manager plugin shows 50 items per page, not 10\n+- LastComments plugin will not even attempt to delete or rebuild LastComments caches if LastComments plugin is not available ([#43](https://github.com/flatpressblog/flatpress/issues/43))\n+- Comment Center config page threw errors ([#90](https://github.com/flatpressblog/flatpress/issues/90))\n \n ## Themes\n-- Leggero theme: Fixed searchbox glitch in FlatMaas revisited style (see [#97](https://github.com/flatpressblog/flatpress/issues/97))\n-- Leggero theme: Fixed missing bullets in preview (see [#98](https://github.com/flatpressblog/flatpress/issues/98))\n-- Leggero theme: CSS of the Leggero style had some glitches on mobile devices\n-- Leggero theme: Invalid HTML output fixed (see [#106](https://github.com/flatpressblog/flatpress/issues/106))\n-- Leggero theme: Removed unneccessary external font resource (see [#112](https://github.com/flatpressblog/flatpress/issues/112))\n-\n-## Bugfixes\n-- Comment Center config page threw errors (see [#90](https://github.com/flatpressblog/flatpress/issues/90))\n+- Leggero\n+  - Fixed searchbox glitch in FlatMaas revisited style ([#97](https://github.com/flatpressblog/flatpress/issues/97))\n+  - Fixed missing bullets in preview ([#98](https://github.com/flatpressblog/flatpress/issues/98))\n+  - CSS of the Leggero style had some glitches on mobile devices\n+  - Invalid HTML output fixed ([#106](https://github.com/flatpressblog/flatpress/issues/106), [#156](https://github.com/flatpressblog/flatpress/issues/156))\n+  - Removed unneccessary external font resource ([#112](https://github.com/flatpressblog/flatpress/issues/112))\n+  - \"Add comment\" link has its own line ([#135](https://github.com/flatpressblog/flatpress/issues/135))\n+  - Removed legacy/invalid CSS ([#133](https://github.com/flatpressblog/flatpress/issues/133), [#134](https://github.com/flatpressblog/flatpress/issues/134))\n+  - Fixed description of Leggero and Leggero v2 styles ([#137](https://github.com/flatpressblog/flatpress/issues/137))\n+  - Obsolete bullet points removed ([#136](https://github.com/flatpressblog/flatpress/issues/136))\n+  - Updated preview image ([#139](https://github.com/flatpressblog/flatpress/issues/139))\n+\n+## Internationalization\n - Fixed glitches in Spanish an Portuguese language files\n+- Fixed wrong pt-br country code ([#100](https://github.com/flatpressblog/flatpress/issues/100))\n+- Search page: Month names displayed in configured frontend language ([#132](https://github.com/flatpressblog/flatpress/issues/132))\n+- German translation for Comment Center plugin added ([#148](https://github.com/flatpressblog/flatpress/issues/148))\n+\n+## Other bugfixes\n - Plugin management page: Removed empty warning messages box\n-- Fixed wrong pt-br country code (see [#100](https://github.com/flatpressblog/flatpress/issues/100))\n-- Fixed error at prev link on first / next link on last entry (see [#95](https://github.com/flatpressblog/flatpress/issues/95))\n-- LastComments plugin will not even attempt to delete or rebuild LastComments caches if LastComments plugin is not available (see [#43](https://github.com/flatpressblog/flatpress/issues/43))\n+- Fixed error at prev link on first / next link on last entry ([#95](https://github.com/flatpressblog/flatpress/issues/95))\n+- Logout redirects to home page again ([#119](https://github.com/flatpressblog/flatpress/issues/119))\n+- Fixed disappearing non-Latin characters in page title ([#49](https://github.com/flatpressblog/flatpress/issues/49) and [#91](https://github.com/flatpressblog/flatpress/issues/91))\n \n ## Security\n-- Fixed security issue reported by huntr.dev: Session cookie missed the \"secure\" flag\n+- Possible XSS prevented: Session cookie missed the \"secure\" and \"httponly\" flags\n - Possible path traversal in Media Manager plugin prevented\n+- Uploaded files wheren't checked properly ([#152](https://github.com/flatpressblog/flatpress/issues/152))\n \n # 2021-06-19: [FlatPress 1.2.1](https://github.com/flatpressblog/flatpress/releases/tag/1.2.1)\n ## Bugfixes"
        },
        {
          "filename": "CONTRIBUTORS.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -37,3 +37,4 @@ FlatPress utilizes the following free frameworks and libraries. Thanks to their\n \n ## Other contributions\n - [Julian Rademacher](https://moortaube.de/) generously donated his Twitter account [@FlatPress](https://twitter.com/FlatPress). Also thanks for your useful pull requests!\n+- [Fraenkiman](https://github.com/Fraenkiman) tests FlatPress to its very core and creates a metric ton of very helpful [issues](https://github.com/flatpressblog/flatpress/issues)."
        },
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 2,
          "deletions": 6,
          "patch": "@@ -1,16 +1,16 @@\n [![Home page](https://img.shields.io/badge/Home%20page-\ud83c\udfe0-555?style=plastic)](https://www.flatpress.org \"Home page\")\n [![Support forum](https://img.shields.io/badge/Support%20forum-\ud83d\udcac-555?style=plastic)](https://forum.flatpress.org \"Support forum\")\n [![Wiki](https://img.shields.io/badge/Wiki-\ud83d\udcd6-555?style=plastic)](https://wiki.flatpress.org \"Wiki\")\n-[![Mastodon](https://img.shields.io/badge/Mastodon-\ud83d\udc18-555?style=plastic)](https://fosstodon.org/@flatpress \"FlatPress@Mastodon\")\n-[![Twitter](https://img.shields.io/badge/Twitter-\ud83d\udc26-555?style=plastic)](https://twitter.com/FlatPress \"FlatPress@Twitter\")\n [![Change log](https://img.shields.io/badge/Change%20log-\ud83d\udcdc-555?style=plastic)](./CHANGELOG.md \"Change log\")\n [![Security policy](https://img.shields.io/badge/Security%20policy-\u26a1-555?style=plastic)](./SECURITY.md \"Security policy\")\n [![Contributors](https://img.shields.io/badge/Contributors-\ud83d\ude0e-555?style=plastic)](./CONTRIBUTORS.md \"Contributors\")\n+[![Wiki](https://img.shields.io/badge/Donate-\ud83d\udc9b-555?style=plastic&logo=paypal)](https://www.flatpress.org/donate \"Send us a little Thank You\")\n \n [![Releases](https://img.shields.io/github/release/flatpressblog/flatpress.svg?label=Latest%20release&style=plastic)](https://github.com/flatpressblog/flatpress/releases \"See all releases\")\n [![License](https://img.shields.io/github/license/flatpressblog/flatpress.svg?style=plastic)](./LICENSE.md \"License\")\n [![Open issues](https://img.shields.io/github/issues-raw/flatpressblog/flatpress?style=plastic)](https://github.com/flatpressblog/flatpress/issues \"See open issues\")\n [![Last commit](https://img.shields.io/github/last-commit/flatpressblog/flatpress?style=plastic)](https://github.com/flatpressblog/flatpress/commits/ \"Last commit\")\n+<a href=\"https://fosstodon.org/users/flatpress/remote_follow\" title=\"Follow on Mastodon\"><img alt=\"Mastodon Follow\" src=\"https://img.shields.io/mastodon/follow/326815?domain=https%3A%2F%2Ffosstodon.org&style=social\" alt=\"Follow on Mastodon\"></a> <a href=\"https://twitter.com/intent/follow?screen_name=flatpress\" title=\"Follow on Twitter\"><img src=\"https://img.shields.io/twitter/follow/flatpress.svg?style=social&logo=twitter\" alt=\"Follow on Twitter\"></a>\n \n # Welcome to FlatPress!\n FlatPress is a lightweight, easy-to-set-up blogging engine. Plain and simple, just PHP. No database needed!\n@@ -41,7 +41,3 @@ FlatPress runs on any web server (e.g. Apache or IIS) with PHP 7.1 or higher. Si\n \n ## Credits\n There are many people who contributed to FlatPress over the years. [See them here.](./CONTRIBUTORS.md)\n-\n-\n-<a href=\"https://fosstodon.org/users/flatpress/remote_follow\" title=\"Follow on Mastodon\"><img alt=\"Mastodon Follow\" src=\"https://img.shields.io/mastodon/follow/326815?domain=https%3A%2F%2Ffosstodon.org&style=social\" alt=\"Follow on Mastodon\"></a><br>\n-<a href=\"https://twitter.com/intent/follow?screen_name=flatpress\" title=\"Follow on Twitter\"><img src=\"https://img.shields.io/twitter/follow/flatpress.svg?style=social&logo=twitter\" alt=\"Follow on Twitter\"></a>"
        },
        {
          "filename": "admin/panels/uploader/admin.uploader.php",
          "status": "modified",
          "additions": 111,
          "deletions": 108,
          "patch": "@@ -102,133 +102,136 @@ function onupload() {\n \n \t\tforeach ($_FILES [\"upload\"] [\"error\"] as $key => $error) {\n \n-\t\t\tif ($error == UPLOAD_ERR_OK) {\n-\t\t\t\t$tmp_name = $_FILES [\"upload\"] [\"tmp_name\"] [$key];\n-\t\t\t\t$name = $_FILES [\"upload\"] [\"name\"] [$key];\n+\t\t\t// Upload went wrong -> jump to the next file\n+\t\t\tif ($error != UPLOAD_ERR_OK) {\n+\t\t\t\tcontinue;\n+\t\t\t}\n+\n+\t\t\t$tmp_name = $_FILES [\"upload\"] [\"tmp_name\"] [$key];\n+\t\t\t$name = $_FILES [\"upload\"] [\"name\"] [$key];\n+\n+\t\t\t$dir = ATTACHS_DIR;\n+\n+\t\t\t/*\n+\t\t\t * second check extension list\n+\t\t\t * https://stackoverflow.com/questions/4166762/php-image-upload-security-check-list\n+\t\t\t *\n+\t\t\t * 2019-11-24 - laborix\n+\t\t\t */\n+\n+\t\t\t$uploadfilename = strtolower($name);\n \n-\t\t\t\t$dir = ATTACHS_DIR;\n+\t\t\t$isForbidden = false;\n+\t\t\t$deeptest = array();\n+\t\t\t$extcount = 0;\n+\t\t\t$deeptest = explode('.', $uploadfilename);\n+\t\t\t$extcount = count($deeptest);\n \n+\t\t\tif ($extcount == 1) {\n \t\t\t\t/*\n-\t\t\t\t * second check extension list\n-\t\t\t\t * https://stackoverflow.com/questions/4166762/php-image-upload-security-check-list\n+\t\t\t\t * none extension like .jpg or something else\n \t\t\t\t *\n-\t\t\t\t * 2019-11-24 - laborix\n+\t\t\t\t * possible filename = simple-file-without-extension - linux like ok\n \t\t\t\t */\n-\n-\t\t\t\t$uploadfilename = strtolower($tmp_name);\n-\n \t\t\t\t$isForbidden = false;\n-\t\t\t\t$deeptest = array();\n-\t\t\t\t$extcount = 0;\n-\t\t\t\t$deeptest = explode('.', $uploadfilename);\n-\t\t\t\t$extcount = count($deeptest);\n-\n-\t\t\t\tif ($extcount == 1) {\n-\t\t\t\t\t/*\n-\t\t\t\t\t * none extension like .jpg or something else\n-\t\t\t\t\t *\n-\t\t\t\t\t * possible filename = simple-file-without-extension - linux like ok\n-\t\t\t\t\t */\n-\t\t\t\t\t$isForbidden = false;\n-\t\t\t\t} elseif ($extcount == 2) {\n-\t\t\t\t\t/*\n-\t\t\t\t\t * Only one possible extension\n-\t\t\t\t\t *\n-\t\t\t\t\t * possible filename = 1.jpg\n-\t\t\t\t\t * possible filename = admin.uploader.php\n-\t\t\t\t\t * possible filename = .htaccess\n-\t\t\t\t\t * and so on...\n-\t\t\t\t\t */\n-\t\t\t\t\t$check_ext1 = \"\";\n-\t\t\t\t\t$check_ext1 = trim($deeptest [1], \"\\x00..\\x1F\");\n-\t\t\t\t\tif (in_array($check_ext1, $blacklist_extensions)) {\n-\t\t\t\t\t\t$isForbidden = true;\n-\t\t\t\t\t} else {\n-\t\t\t\t\t\t$isForbidden = false;\n-\t\t\t\t\t}\n-\t\t\t\t} elseif ($extcount > 2) {\n-\t\t\t\t\t/*\n-\t\t\t\t\t * Chekc only the last two possible extensions\n-\t\t\t\t\t *\n-\t\t\t\t\t * Hint: OWASP - Unrestricted File Upload\n-\t\t\t\t\t *\n-\t\t\t\t\t * In Apache, a php file might be executed using the\n-\t\t\t\t\t * double extension technique such as \"file.php.jpg\"\n-\t\t\t\t\t * when \".jpg\" is allowed.\n-\t\t\t\t\t *\n-\t\t\t\t\t * possible filename = 1.PhP.jpg\n-\t\t\t\t\t * possible filename = admin.uploader.php.JPg\n-\t\t\t\t\t * and so on...\n-\t\t\t\t\t */\n-\t\t\t\t\t$check_ext1 = \"\";\n-\t\t\t\t\t$check_ext2 = \"\";\n-\t\t\t\t\t$check_ext1 = trim($deeptest [$extcount - 1], \"\\x00..\\x1F\");\n-\t\t\t\t\tif (in_array($check_ext1, $blacklist_extensions)) {\n-\t\t\t\t\t\t$isForbidden = true;\n-\t\t\t\t\t} else {\n-\t\t\t\t\t\t$isForbidden = false;\n-\t\t\t\t\t}\n-\t\t\t\t\t/* Test only if first extension check are not in the blacklist */\n-\t\t\t\t\tif (!$isForbidden) {\n-\t\t\t\t\t\t$check_ext2 = trim($deeptest [$extcount - 2], \"\\x00..\\x1F\");\n-\t\t\t\t\t\tif (in_array($check_ext2, $blacklist_extensions)) {\n-\t\t\t\t\t\t\t$isForbidden = true;\n-\t\t\t\t\t\t} else {\n-\t\t\t\t\t\t\t$isForbidden = false;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n-\t\t\t\t}\n+\t\t\t} elseif ($extcount == 2) {\n \t\t\t\t/*\n-\t\t\t\t * If one blacklisted extension found then\n-\t\t\t\t * return with -1 = An error occurred while trying to upload.\n+\t\t\t\t * Only one possible extension\n+\t\t\t\t *\n+\t\t\t\t * possible filename = 1.jpg\n+\t\t\t\t * possible filename = admin.uploader.php\n+\t\t\t\t * possible filename = .htaccess\n+\t\t\t\t * and so on...\n \t\t\t\t */\n-\t\t\t\tif ($isForbidden) {\n-\t\t\t\t\t$this->smarty->assign('success', $success ? 1 : -1);\n-\t\t\t\t\tsess_add('admin_uploader_files', $uploaded_files);\n-\t\t\t\t\treturn -1;\n+\t\t\t\t$check_ext1 = \"\";\n+\t\t\t\t$check_ext1 = trim($deeptest [1], \"\\x00..\\x1F\");\n+\t\t\t\tif (in_array($check_ext1, $blacklist_extensions)) {\n+\t\t\t\t\t$isForbidden = true;\n+\t\t\t\t} else {\n+\t\t\t\t\t$isForbidden = false;\n \t\t\t\t}\n-\n+\t\t\t} elseif ($extcount > 2) {\n \t\t\t\t/*\n-\t\t\t\t * third check extension\n-\t\t\t\t * if someone upload a .php file as .gif, .jpg or .txt\n-\t\t\t\t * if someone upload a .html file as .gif, .jpg or .txt\n+\t\t\t\t * Chekc only the last two possible extensions\n+\t\t\t\t *\n+\t\t\t\t * Hint: OWASP - Unrestricted File Upload\n+\t\t\t\t *\n+\t\t\t\t * In Apache, a php file might be executed using the\n+\t\t\t\t * double extension technique such as \"file.php.jpg\"\n+\t\t\t\t * when \".jpg\" is allowed.\n \t\t\t\t *\n-\t\t\t\t * 2019-11-24 - laborix\n+\t\t\t\t * possible filename = 1.PhP.jpg\n+\t\t\t\t * possible filename = admin.uploader.php.JPg\n+\t\t\t\t * and so on...\n \t\t\t\t */\n-\n-\t\t\t\tif (version_compare(PHP_VERSION, '5.3.0') < 0)\n-\t\t\t\t\treturn -1;\n-\t\t\t\tif (!function_exists('finfo_open'))\n-\t\t\t\t\treturn -1;\n-\n-\t\t\t\t$finfo = finfo_open(FILEINFO_MIME_TYPE);\n-\t\t\t\t$mime = finfo_file($finfo, $tmp_name);\n-\t\t\t\tfinfo_close($finfo);\n-\n-\t\t\t\tif (($mime == \"text/x-php\") || ($mime == \"text/html\")) {\n-\t\t\t\t\t$this->smarty->assign('success', $success ? 1 : -1);\n-\t\t\t\t\tsess_add('admin_uploader_files', $uploaded_files);\n-\t\t\t\t\treturn -1;\n+\t\t\t\t$check_ext1 = \"\";\n+\t\t\t\t$check_ext2 = \"\";\n+\t\t\t\t$check_ext1 = trim($deeptest [$extcount - 1], \"\\x00..\\x1F\");\n+\t\t\t\tif (in_array($check_ext1, $blacklist_extensions)) {\n+\t\t\t\t\t$isForbidden = true;\n+\t\t\t\t} else {\n+\t\t\t\t\t$isForbidden = false;\n \t\t\t\t}\n+\t\t\t\t/* Test only if first extension check are not in the blacklist */\n+\t\t\t\tif (!$isForbidden) {\n+\t\t\t\t\t$check_ext2 = trim($deeptest [$extcount - 2], \"\\x00..\\x1F\");\n+\t\t\t\t\tif (in_array($check_ext2, $blacklist_extensions)) {\n+\t\t\t\t\t\t$isForbidden = true;\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\t$isForbidden = false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t}\n+\t\t\t/*\n+\t\t\t * If one blacklisted extension found then\n+\t\t\t * return with -1 = An error occurred while trying to upload.\n+\t\t\t */\n+\t\t\tif ($isForbidden) {\n+\t\t\t\t$this->smarty->assign('success', $success ? 1 : -1);\n+\t\t\t\tsess_add('admin_uploader_files', $uploaded_files);\n+\t\t\t\treturn -1;\n+\t\t\t}\n \n-\t\t\t\t$ext = strtolower(strrchr($name, '.'));\n+\t\t\t/*\n+\t\t\t * third check extension\n+\t\t\t * if someone upload a .php file as .gif, .jpg or .txt\n+\t\t\t * if someone upload a .html file as .gif, .jpg or .txt\n+\t\t\t *\n+\t\t\t * 2019-11-24 - laborix\n+\t\t\t */\n+\n+\t\t\tif (version_compare(PHP_VERSION, '5.3.0') < 0)\n+\t\t\t\treturn -1;\n+\t\t\tif (!function_exists('finfo_open'))\n+\t\t\t\treturn -1;\n+\n+\t\t\t$finfo = finfo_open(FILEINFO_MIME_TYPE);\n+\t\t\t$mime = finfo_file($finfo, $tmp_name);\n+\t\t\tfinfo_close($finfo);\n+\n+\t\t\tif (($mime == \"text/x-php\") || ($mime == \"text/html\")) {\n+\t\t\t\t$this->smarty->assign('success', $success ? 1 : -1);\n+\t\t\t\tsess_add('admin_uploader_files', $uploaded_files);\n+\t\t\t\treturn -1;\n+\t\t\t}\n \n-\t\t\t\tif (in_array($ext, $imgs)) {\n-\t\t\t\t\t$dir = IMAGES_DIR;\n-\t\t\t\t}\n+\t\t\t$ext = strtolower(strrchr($name, '.'));\n+\n+\t\t\tif (in_array($ext, $imgs)) {\n+\t\t\t\t$dir = IMAGES_DIR;\n+\t\t\t}\n \n-\t\t\t\t$name = sanitize_title(substr($name, 0, -strlen($ext))) . $ext;\n+\t\t\t$name = sanitize_title(substr($name, 0, -strlen($ext))) . $ext;\n \n-\t\t\t\t$target = \"$dir/$name\";\n-\t\t\t\t@umask(022);\n-\t\t\t\t$success = move_uploaded_file($tmp_name, $target);\n-\t\t\t\t@chmod($target, 0766);\n+\t\t\t$target = \"$dir/$name\";\n+\t\t\t@umask(022);\n+\t\t\t$success = move_uploaded_file($tmp_name, $target);\n+\t\t\t@chmod($target, 0766);\n \n-\t\t\t\t$uploaded_files [] = $name;\n+\t\t\t$uploaded_files [] = $name;\n \n-\t\t\t\t// one failure will make $success == false :)\n-\t\t\t\t$success &= $success;\n-\t\t\t}\n+\t\t\t// one failure will make $success == false :)\n+\t\t\t$success &= $success;\n \t\t}\n \n \t\tif ($uploaded_files) {"
        },
        {
          "filename": "admin/res/admin.css",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -167,7 +167,7 @@ input.maxsize { width: 99% }\n #main ul.msgs, ul.msgs {\n \tmargin-top: 1em;\n \tmargin-left: 0em;\n-\tpadding: 1em 2em\n+\tpadding: 1em 2em;\n }\n \n .errors {"
        },
        {
          "filename": "defaults.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -121,6 +121,7 @@\n $serverport = \"false\";\n // Unterst\u00fctzung f\u00fcr Apache und IIS\n ini_set('session.cookie_secure', 1);\n+ini_set('session.cookie_httponly', 1);\n if (isset($_SERVER ['HTTPS']) && ($_SERVER ['HTTPS'] == '1' || strtolower($_SERVER ['HTTPS']) == 'on')) {\n \t$serverport = \"https://\";\n } else {"
        },
        {
          "filename": "fp-includes/core/core.cookie.php",
          "status": "modified",
          "additions": 10,
          "deletions": 8,
          "patch": "@@ -23,6 +23,8 @@ function cookie_setup() {\n \t\tdefine('COOKIE_DOMAIN', false);\n \tif (!defined('COOKIE_SECURE'))\n \t\tdefine('COOKIE_SECURE', true);\n+\tif (!defined('COOKIE_HTTPONLY'))\n+\t\tdefine('COOKIE_HTTPONLY', true);\n }\n \n if (!function_exists('wp_get_cookie_login')) :\n@@ -62,20 +64,20 @@ function cookie_set($username, $password, $already_md5 = false, $home = '', $sit\n \telse\n \t\t$expire = 0;\n \n-\tsetcookie(USER_COOKIE, $username, $expire, $cookiepath, COOKIE_DOMAIN, COOKIE_SECURE);\n-\tsetcookie(PASS_COOKIE, $password, $expire, $cookiepath, COOKIE_DOMAIN, COOKIE_SECURE);\n+\tsetcookie(USER_COOKIE, $username, $expire, $cookiepath, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\tsetcookie(PASS_COOKIE, $password, $expire, $cookiepath, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n \n \tif ($cookiepath != $sitecookiepath) {\n-\t\tsetcookie(USER_COOKIE, $username, $expire, $sitecookiepath, COOKIE_DOMAIN, COOKIE_SECURE);\n-\t\tsetcookie(PASS_COOKIE, $password, $expire, $sitecookiepath, COOKIE_DOMAIN, COOKIE_SECURE);\n+\t\tsetcookie(USER_COOKIE, $username, $expire, $sitecookiepath, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie(PASS_COOKIE, $password, $expire, $sitecookiepath, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n \t}\n }\n \n function cookie_clear() {\n-\tsetcookie(USER_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n-\tsetcookie(PASS_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n-\tsetcookie(USER_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n-\tsetcookie(PASS_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n+\tsetcookie(USER_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\tsetcookie(PASS_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\tsetcookie(USER_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\tsetcookie(PASS_COOKIE, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n }\n \n if (!function_exists('wp_login')) :"
        },
        {
          "filename": "fp-includes/core/core.session.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -5,7 +5,7 @@ function sess_setup() {\n \t\tsession_save_path(SESSION_PATH);\n \n \tsession_name(SESS_COOKIE);\n-\tsetcookie(SESS_COOKIE, '', 0, '', COOKIE_DOMAIN, COOKIE_SECURE);\n+\tsetcookie(SESS_COOKIE, '', 0, '', COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n \n \tsession_start();\n }\n@@ -32,7 +32,7 @@ function sess_get($key) {\n function sess_close() {\n \tunset($_SESSION);\n \tif (isset($_COOKIE [session_name()])) {\n-\t\tsetcookie(session_name(), '', time() - 42000, '/', COOKIE_SECURE);\n+\t\tsetcookie(session_name(), '', time() - 42000, '/', COOKIE_SECURE, COOKIE_HTTPONLY);\n \t\tsession_set_cookie_params(-42000);\n \t}\n \tsession_destroy();"
        },
        {
          "filename": "fp-includes/core/core.users.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -64,8 +64,8 @@ function user_login($userid, $pwd, $params = null) {\n \tif ($loggedin) {\n \t\t// session_regenerate_id();\n \t\t$expire = time() + 31536000;\n-\t\tsetcookie(USER_COOKIE, $userid, $expire, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n-\t\tsetcookie(PASS_COOKIE, $user ['password'], $expire, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n+\t\tsetcookie(USER_COOKIE, $userid, $expire, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie(PASS_COOKIE, $user ['password'], $expire, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n \t}\n \n \treturn $loggedin;\n@@ -76,8 +76,8 @@ function user_logout() {\n \n \tif (user_loggedin()) {\n \n-\t\tsetcookie(USER_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n-\t\tsetcookie(PASS_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE);\n+\t\tsetcookie(USER_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie(PASS_COOKIE, ' ', time() - 31536000, COOKIEPATH, COOKIE_DOMAIN, COOKIE_SECURE, COOKIE_HTTPONLY);\n \t}\n \n \t$loggedin = false;"
        },
        {
          "filename": "fp-includes/core/core.wp-formatting.php",
          "status": "modified",
          "additions": 6,
          "deletions": 10,
          "patch": "@@ -487,25 +487,21 @@ function sanitize_title($title, $fallback_title = '') {\n \n function sanitize_title_with_dashes($title) {\n \t$title = strip_tags($title);\n-\n-\tif (seems_utf8($title)) {\n-\t\tif (function_exists('mb_strtolower')) {\n-\t\t\t$title = mb_strtolower($title, 'UTF-8');\n-\t\t}\n-\t\t$title = utf8_uri_encode($title);\n-\t}\n-\n \t// Preserve escaped octets.\n \t$title = preg_replace('|%([a-fA-F0-9][a-fA-F0-9])|', '---$1---', $title);\n \t// Remove percent signs that are not part of an octet.\n \t$title = str_replace('%', '', $title);\n \t// Restore octets.\n \t$title = preg_replace('|---([a-fA-F0-9][a-fA-F0-9])---|', '%$1', $title);\n-\t// and finally: Kill octets\n-\t$title = preg_replace('|%([a-fA-F0-9][a-fA-F0-9])|', '', $title);\n \n \t// remove accents\n \t$title = remove_accents($title);\n+\tif (seems_utf8($title)) {\n+\t\tif (function_exists('mb_strtolower')) {\n+\t\t\t$title = mb_strtolower($title, 'UTF-8');\n+\t\t}\n+\t\t$title = utf8_uri_encode($title);\n+\t}\n \n \t// title is in lower case always\n \t$title = strtolower($title);"
        },
        {
          "filename": "fp-includes/core/core.wp-pluggable-funcs.php",
          "status": "modified",
          "additions": 11,
          "deletions": 11,
          "patch": "@@ -6,7 +6,7 @@\n  */\n function _get_nextprev_link($nextprev) {\n \tglobal $fpdb;\n-\t$q = & $fpdb->getQuery();\n+\t$q = &$fpdb->getQuery();\n \n \tlist ($caption, $id) = call_user_func(array(\n \t\t&$q,\n@@ -42,7 +42,7 @@ function _get_nextprev_link($nextprev) {\n \n \tfunction get_nextpage_link() {\n \t\tglobal $fpdb;\n-\t\t$q = & $fpdb->getQuery();\n+\t\t$q = &$fpdb->getQuery();\n \n \t\t$a = _get_nextprev_link('NextPage');\n \n@@ -59,7 +59,7 @@ function get_nextpage_link() {\n \n \tfunction get_prevpage_link() {\n \t\tglobal $fpdb;\n-\t\t$q = & $fpdb->getQuery();\n+\t\t$q = &$fpdb->getQuery();\n \n \t\t$a = _get_nextprev_link('PrevPage');\n \n@@ -292,23 +292,23 @@ function wp_setcookie($username, $password, $already_md5 = false, $home = '', $s\n \t\t\t$cookiehash = md5($siteurl);\n \t\t}\n \n-\t\tsetcookie('wordpressuser_' . $cookiehash, $username, time() + 31536000, $cookiepath, COOKIE_SECURE);\n-\t\tsetcookie('wordpresspass_' . $cookiehash, $password, time() + 31536000, $cookiepath, COOKIE_SECURE);\n+\t\tsetcookie('wordpressuser_' . $cookiehash, $username, time() + 31536000, $cookiepath, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie('wordpresspass_' . $cookiehash, $password, time() + 31536000, $cookiepath, COOKIE_SECURE, COOKIE_HTTPONLY);\n \n \t\tif ($cookiepath != $sitecookiepath) {\n-\t\t\tsetcookie('wordpressuser_' . $cookiehash, $username, time() + 31536000, $sitecookiepath, COOKIE_SECURE);\n-\t\t\tsetcookie('wordpresspass_' . $cookiehash, $password, time() + 31536000, $sitecookiepath, COOKIE_SECURE);\n+\t\t\tsetcookie('wordpressuser_' . $cookiehash, $username, time() + 31536000, $sitecookiepath, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\t\tsetcookie('wordpresspass_' . $cookiehash, $password, time() + 31536000, $sitecookiepath, COOKIE_SECURE, COOKIE_HTTPONLY);\n \t\t}\n \t}\n endif;\n \n if (!function_exists('wp_clearcookie')) :\n \n \tfunction wp_clearcookie() {\n-\t\tsetcookie('wordpressuser_' . COOKIEHASH, ' ', time() - 31536000, COOKIEPATH, COOKIE_SECURE);\n-\t\tsetcookie('wordpresspass_' . COOKIEHASH, ' ', time() - 31536000, COOKIEPATH, COOKIE_SECURE);\n-\t\tsetcookie('wordpressuser_' . COOKIEHASH, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_SECURE);\n-\t\tsetcookie('wordpresspass_' . COOKIEHASH, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_SECURE);\n+\t\tsetcookie('wordpressuser_' . COOKIEHASH, ' ', time() - 31536000, COOKIEPATH, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie('wordpresspass_' . COOKIEHASH, ' ', time() - 31536000, COOKIEPATH, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie('wordpressuser_' . COOKIEHASH, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_SECURE, COOKIE_HTTPONLY);\n+\t\tsetcookie('wordpresspass_' . COOKIEHASH, ' ', time() - 31536000, SITECOOKIEPATH, COOKIE_SECURE, COOKIE_HTTPONLY);\n \t}\n endif;\n "
        },
        {
          "filename": "fp-includes/smarty/plugins/function.html_select_date.php",
          "status": "added",
          "additions": 373,
          "deletions": 0,
          "patch": "@@ -0,0 +1,373 @@\n+<?php\n+\n+/**\n+ * Smarty plugin\n+ *\n+ * @package Smarty\n+ * @subpackage plugins\n+ */\n+\n+/**\n+ * Smarty {html_select_date} plugin\n+ *\n+ * Type: function<br>\n+ * Name: html_select_date<br>\n+ * Purpose: Prints the dropdowns for date selection.\n+ *\n+ * ChangeLog:<br>\n+ * - 1.0 initial release\n+ * - 1.1 added support for +/- N syntax for begin\n+ * and end year values. (Monte)\n+ * - 1.2 added support for yyyy-mm-dd syntax for\n+ * time value. (Jan Rosier)\n+ * - 1.3 added support for choosing format for\n+ * month values (Gary Loescher)\n+ * - 1.3.1 added support for choosing format for\n+ * day values (Marcus Bointon)\n+ * - 1.3.2 support negative timestamps, force year\n+ * dropdown to include given date unless explicitly set (Monte)\n+ * - 1.3.4 fix behaviour of 0000-00-00 00:00:00 dates to match that\n+ * of 0000-00-00 dates (cybot, boots)\n+ *\n+ * @link http://smarty.php.net/manual/en/language.function.html.select.date.php {html_select_date}\n+ *       (Smarty online manual)\n+ * @version 1.3.4\n+ * @author Andrei Zmievski\n+ * @author Monte Ohrt <monte at ohrt dot com>\n+ * @param\n+ *        \tarray\n+ * @param\n+ *        \tSmarty\n+ * @return string\n+ */\n+function smarty_function_html_select_date($params, &$smarty) {\n+\trequire_once $smarty->_get_plugin_filepath('shared', 'escape_special_chars');\n+\trequire_once $smarty->_get_plugin_filepath('shared', 'make_timestamp');\n+\trequire_once $smarty->_get_plugin_filepath('function', 'html_options');\n+\t/* Default values. */\n+\t$prefix = \"Date_\";\n+\t$start_year = strftime(\"%Y\");\n+\t$end_year = $start_year;\n+\t$display_days = true;\n+\t$display_months = true;\n+\t$display_years = true;\n+\t$month_format = \"%B\";\n+\t/* Write months as numbers by default GL */\n+\t$month_value_format = \"%m\";\n+\t$day_format = \"%02d\";\n+\t/* Write day values using this format MB */\n+\t$day_value_format = \"%d\";\n+\t$year_as_text = false;\n+\t/* Display years in reverse order? Ie. 2000,1999,.... */\n+\t$reverse_years = false;\n+\t/*\n+\t * Should the select boxes be part of an array when returned from PHP?\n+\t * e.g. setting it to \"birthday\", would create \"birthday[Day]\",\n+\t * \"birthday[Month]\" & \"birthday[Year]\". Can be combined with prefix\n+\t */\n+\t$field_array = null;\n+\t/*\n+\t * <select size>'s of the different <select> tags.\n+\t * If not set, uses default dropdown.\n+\t */\n+\t$day_size = null;\n+\t$month_size = null;\n+\t$year_size = null;\n+\t/*\n+\t * Unparsed attributes common to *ALL* the <select>/<input> tags.\n+\t * An example might be in the template: all_extra ='class =\"foo\"'.\n+\t */\n+\t$all_extra = null;\n+\t/* Separate attributes for the tags. */\n+\t$day_extra = null;\n+\t$month_extra = null;\n+\t$year_extra = null;\n+\t/*\n+\t * Order in which to display the fields.\n+\t * \"D\" -> day, \"M\" -> month, \"Y\" -> year.\n+\t */\n+\t$field_order = 'MDY';\n+\t/* String printed between the different fields. */\n+\t$field_separator = \"\\n\";\n+\t$time = time();\n+\t$all_empty = null;\n+\t$day_empty = null;\n+\t$month_empty = null;\n+\t$year_empty = null;\n+\t$extra_attrs = '';\n+\n+\tforeach ($params as $_key => $_value) {\n+\t\tswitch ($_key) {\n+\t\t\tcase 'prefix':\n+\t\t\tcase 'time':\n+\t\t\tcase 'start_year':\n+\t\t\tcase 'end_year':\n+\t\t\tcase 'month_format':\n+\t\t\tcase 'day_format':\n+\t\t\tcase 'day_value_format':\n+\t\t\tcase 'field_array':\n+\t\t\tcase 'day_size':\n+\t\t\tcase 'month_size':\n+\t\t\tcase 'year_size':\n+\t\t\tcase 'all_extra':\n+\t\t\tcase 'day_extra':\n+\t\t\tcase 'month_extra':\n+\t\t\tcase 'year_extra':\n+\t\t\tcase 'field_order':\n+\t\t\tcase 'field_separator':\n+\t\t\tcase 'month_value_format':\n+\t\t\tcase 'month_empty':\n+\t\t\tcase 'day_empty':\n+\t\t\tcase 'year_empty':\n+\t\t\t\t$$_key = (string) $_value;\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'all_empty':\n+\t\t\t\t$$_key = (string) $_value;\n+\t\t\t\t$day_empty = $month_empty = $year_empty = $all_empty;\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'display_days':\n+\t\t\tcase 'display_months':\n+\t\t\tcase 'display_years':\n+\t\t\tcase 'year_as_text':\n+\t\t\tcase 'reverse_years':\n+\t\t\t\t$$_key = (bool) $_value;\n+\t\t\t\tbreak;\n+\n+\t\t\tdefault:\n+\t\t\t\tif (!is_array($_value)) {\n+\t\t\t\t\t$extra_attrs .= ' ' . $_key . '=\"' . smarty_function_escape_special_chars($_value) . '\"';\n+\t\t\t\t} else {\n+\t\t\t\t\t$smarty->trigger_error(\"html_select_date: extra attribute '$_key' cannot be an array\", E_USER_NOTICE);\n+\t\t\t\t}\n+\t\t\t\tbreak;\n+\t\t}\n+\t}\n+\n+\tif (preg_match('!^-\\d+$!', $time)) {\n+\t\t// negative timestamp, use date()\n+\t\t$time = date('Y-m-d', $time);\n+\t}\n+\t// If $time is not in format yyyy-mm-dd\n+\tif (preg_match('/^(\\d{0,4}-\\d{0,2}-\\d{0,2})/', $time, $found)) {\n+\t\t$time = $found [1];\n+\t} else {\n+\t\t// use smarty_make_timestamp to get an unix timestamp and\n+\t\t// strftime to make yyyy-mm-dd\n+\t\t$time = strftime('%Y-%m-%d', smarty_make_timestamp($time));\n+\t}\n+\t// Now split this in pieces, which later can be used to set the select\n+\t$time = explode(\"-\", $time);\n+\n+\t// make syntax \"+N\" or \"-N\" work with start_year and end_year\n+\tif (preg_match('!^(\\+|\\-)\\s*(\\d+)$!', $end_year, $match)) {\n+\t\tif ($match [1] == '+') {\n+\t\t\t$end_year = strftime('%Y') + $match [2];\n+\t\t} else {\n+\t\t\t$end_year = strftime('%Y') - $match [2];\n+\t\t}\n+\t}\n+\tif (preg_match('!^(\\+|\\-)\\s*(\\d+)$!', $start_year, $match)) {\n+\t\tif ($match [1] == '+') {\n+\t\t\t$start_year = strftime('%Y') + $match [2];\n+\t\t} else {\n+\t\t\t$start_year = strftime('%Y') - $match [2];\n+\t\t}\n+\t}\n+\tif (strlen($time [0]) > 0) {\n+\t\tif ($start_year > $time [0] && !isset($params ['start_year'])) {\n+\t\t\t// force start year to include given date if not explicitly set\n+\t\t\t$start_year = $time [0];\n+\t\t}\n+\t\tif ($end_year < $time [0] && !isset($params ['end_year'])) {\n+\t\t\t// force end year to include given date if not explicitly set\n+\t\t\t$end_year = $time [0];\n+\t\t}\n+\t}\n+\n+\t$field_order = strtoupper($field_order);\n+\n+\t$html_result = $month_result = $day_result = $year_result = \"\";\n+\n+\t$field_separator_count = -1;\n+\tif ($display_months) {\n+\t\t$field_separator_count++;\n+\t\t$month_names = array();\n+\t\t$month_values = array();\n+\t\tif (isset($month_empty)) {\n+\t\t\t$month_names [''] = $month_empty;\n+\t\t\t$month_values [''] = '';\n+\t\t}\n+\t\t// Using the month_names from the FlatPress language files\n+\t\tglobal $lang;\n+\t\t$replace_month_names = array();\n+\t\t$replace_month_names [0] = '-';\n+\t\t$replace_month_value_format = array(\n+\t\t\t\"00\",\n+\t\t\t\"01\",\n+\t\t\t\"02\",\n+\t\t\t\"03\",\n+\t\t\t\"04\",\n+\t\t\t\"05\",\n+\t\t\t\"06\",\n+\t\t\t\"07\",\n+\t\t\t\"08\",\n+\t\t\t\"09\",\n+\t\t\t\"10\",\n+\t\t\t\"11\",\n+\t\t\t\"12\"\n+\t\t);\n+\t\t$fp_lang_months = array();\n+\t\t$fp_lang_months = $lang ['date'] ['month'];\n+\t\t$fplm = 0;\n+\t\tfor($lm = 1; $lm <= 12; $lm++) {\n+\t\t\t$replace_month_names [$lm] = $fp_lang_months [$fplm];\n+\t\t\t$fplm++;\n+\t\t}\n+\t\tfor($i = 1; $i <= 12; $i++) {\n+\t\t\t$month_names [$i] = $replace_month_names [$i];\n+\t\t\t$month_values [$i] = $replace_month_value_format [$i];\n+\t\t}\n+\t\t// /FlatPress change\n+\n+\t\t$month_result .= '<select name=';\n+\t\tif (null !== $field_array) {\n+\t\t\t$month_result .= '\"' . $field_array . '[' . $prefix . 'Month]\"';\n+\t\t} else {\n+\t\t\t$month_result .= '\"' . $prefix . 'Month\"';\n+\t\t}\n+\t\tif (null !== $month_size) {\n+\t\t\t$month_result .= ' size=\"' . $month_size . '\"';\n+\t\t}\n+\t\tif (null !== $month_extra) {\n+\t\t\t$month_result .= ' ' . $month_extra;\n+\t\t}\n+\t\tif (null !== $all_extra) {\n+\t\t\t$month_result .= ' ' . $all_extra;\n+\t\t}\n+\t\t$month_result .= $extra_attrs . '>' . \"\\n\";\n+\n+\t\t$month_result .= smarty_function_html_options(array(\n+\t\t\t'output' => $month_names,\n+\t\t\t'values' => $month_values,\n+\t\t\t'selected' => (int) $time [1] ? strftime($month_value_format, mktime(0, 0, 0, (int) $time [1], 1, 2000)) : '',\n+\t\t\t'print_result' => false\n+\t\t), $smarty);\n+\t\t$month_result .= '</select>';\n+\t}\n+\n+\tif ($display_days) {\n+\t\t$field_separator_count++;\n+\t\t$days = array();\n+\t\tif (isset($day_empty)) {\n+\t\t\t$days [''] = $day_empty;\n+\t\t\t$day_values [''] = '';\n+\t\t}\n+\t\tfor($i = 1; $i <= 31; $i++) {\n+\t\t\t$days [] = sprintf($day_format, $i);\n+\t\t\t$day_values [] = sprintf($day_value_format, $i);\n+\t\t}\n+\n+\t\t$day_result .= '<select name=';\n+\t\tif (null !== $field_array) {\n+\t\t\t$day_result .= '\"' . $field_array . '[' . $prefix . 'Day]\"';\n+\t\t} else {\n+\t\t\t$day_result .= '\"' . $prefix . 'Day\"';\n+\t\t}\n+\t\tif (null !== $day_size) {\n+\t\t\t$day_result .= ' size=\"' . $day_size . '\"';\n+\t\t}\n+\t\tif (null !== $all_extra) {\n+\t\t\t$day_result .= ' ' . $all_extra;\n+\t\t}\n+\t\tif (null !== $day_extra) {\n+\t\t\t$day_result .= ' ' . $day_extra;\n+\t\t}\n+\t\t$day_result .= $extra_attrs . '>' . \"\\n\";\n+\t\t$day_result .= smarty_function_html_options(array(\n+\t\t\t'output' => $days,\n+\t\t\t'values' => $day_values,\n+\t\t\t'selected' => $time [2],\n+\t\t\t'print_result' => false\n+\t\t), $smarty);\n+\t\t$day_result .= '</select>';\n+\t}\n+\n+\tif ($display_years) {\n+\t\t$field_separator_count++;\n+\t\tif (null !== $field_array) {\n+\t\t\t$year_name = $field_array . '[' . $prefix . 'Year]';\n+\t\t} else {\n+\t\t\t$year_name = $prefix . 'Year';\n+\t\t}\n+\t\tif ($year_as_text) {\n+\t\t\t$year_result .= '<input type=\"text\" name=\"' . $year_name . '\" value=\"' . $time [0] . '\" size=\"4\" maxlength=\"4\"';\n+\t\t\tif (null !== $all_extra) {\n+\t\t\t\t$year_result .= ' ' . $all_extra;\n+\t\t\t}\n+\t\t\tif (null !== $year_extra) {\n+\t\t\t\t$year_result .= ' ' . $year_extra;\n+\t\t\t}\n+\t\t\t$year_result .= ' />';\n+\t\t} else {\n+\t\t\t$years = range((int) $start_year, (int) $end_year);\n+\t\t\tif ($reverse_years) {\n+\t\t\t\trsort($years, SORT_NUMERIC);\n+\t\t\t} else {\n+\t\t\t\tsort($years, SORT_NUMERIC);\n+\t\t\t}\n+\t\t\t$yearvals = $years;\n+\t\t\tif (isset($year_empty)) {\n+\t\t\t\tarray_unshift($years, $year_empty);\n+\t\t\t\tarray_unshift($yearvals, '');\n+\t\t\t}\n+\t\t\t$year_result .= '<select name=\"' . $year_name . '\"';\n+\t\t\tif (null !== $year_size) {\n+\t\t\t\t$year_result .= ' size=\"' . $year_size . '\"';\n+\t\t\t}\n+\t\t\tif (null !== $all_extra) {\n+\t\t\t\t$year_result .= ' ' . $all_extra;\n+\t\t\t}\n+\t\t\tif (null !== $year_extra) {\n+\t\t\t\t$year_result .= ' ' . $year_extra;\n+\t\t\t}\n+\t\t\t$year_result .= $extra_attrs . '>' . \"\\n\";\n+\t\t\t$year_result .= smarty_function_html_options(array(\n+\t\t\t\t'output' => $years,\n+\t\t\t\t'values' => $yearvals,\n+\t\t\t\t'selected' => $time [0],\n+\t\t\t\t'print_result' => false\n+\t\t\t), $smarty);\n+\t\t\t$year_result .= '</select>';\n+\t\t}\n+\t}\n+\n+\t// Loop thru the field_order field\n+\tfor($i = 0; $i <= 2; $i++) {\n+\t\t$c = substr($field_order, $i, 1);\n+\t\tswitch ($c) {\n+\t\t\tcase 'D':\n+\t\t\t\t$html_result .= $day_result;\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'M':\n+\t\t\t\t$html_result .= $month_result;\n+\t\t\t\tbreak;\n+\n+\t\t\tcase 'Y':\n+\t\t\t\t$html_result .= $year_result;\n+\t\t\t\tbreak;\n+\t\t}\n+\t\t// Add the field seperator\n+\t\tif ($i < $field_separator_count) {\n+\t\t\t$html_result .= $field_separator;\n+\t\t}\n+\t}\n+\n+\treturn $html_result;\n+}\n+\n+/* vim: set expandtab: */\n+\n+?>"
        },
        {
          "filename": "fp-interface/lang/nl-nl/lang.admin.config.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -3,17 +3,17 @@\n \t$lang['admin']['config']['default'] = \n \tarray(\n \t\t'head'\t\t=> 'Opties',\n-\t\t'descr'\t\t=> 'Aanpassen en configureren jouw FlatPress\n+\t\t'descr'\t\t=> 'Aanpassen en configureren van de FlatPress\n \t\t\t\t\tinstallatie.',\n \t\t'submit'\t\t=> 'Bewaar aanpassingen',\n \t\t\n \t\t'sysfset'\t\t=> 'Algemene systeeminformatie',\n \t\t'syswarning'\t=> '<big>Warschuwing!</big> Deze informatie is van cruciaal belang en moet correct zijn,\n-\tanders FlatPress zal (waarschijnlijk) weigeren om goed te werken.',\n+\tanders zal FlatPress  (waarschijnlijk) weigeren om goed te werken.',\n \t\t'blog_root'\t\t=> '<strong>Absoluut pad naar flatpress</strong>. Opmerking: \n \tover het algemeen hoeft u dit niet te bewerken, wees hoe dan ook voorzichtig, want we kunnen niet\n \tcontroleren of het correct is of niet.',\n-\t\t'www'\t\t=>'<strong>Blog root</strong>. URL naar je blog, compleet met \n+\t\t'www'\t\t=>'<strong>Blog root</strong>. URL naar de blog, compleet met \n \tsubdirectories. <br />\n \tVB: https://www.mydomain.com/flatpress/ (voorwaard slash is nodig)',\n \t\t\n@@ -24,10 +24,10 @@\n \t\t'blogsubtitle'\t\t=> 'Blog subtitel',\n \t\t'blogfooter'\t\t=> 'Blog voettekst',\n \t\t'blogauthor'\t\t=> 'Blog auteur',\n-\t\t'startpage'\t\t=> 'De home page van deze web site is',\n+\t\t'startpage'\t\t=> 'De home page van deze website is',\n \t\t'stdstartpage'\t\t=> 'mijn blog (default)',\n \t\t'blogurl'\t\t\t=> 'Blog URL',\n-\t\t'blogemail'\t\t\t=> 'Blog email',\n+\t\t'blogemail'\t\t\t=> 'Blog e-mail',\n \t\t'notifications'\t\t=> 'Notificaties',\n \t\t'mailnotify'\t\t=> 'E-mailmelding inschakelen voor opmerkingen',\n \t\t'blogmaxentries'\t=> 'Aantal berichten per pagina',"
        },
        {
          "filename": "fp-interface/lang/nl-nl/lang.admin.static.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n \t$lang['admin']['static']['list'] = array(\n \t\n \t\t'head'\t\t=> 'Statische paginas',\n-\t\t'descr'\t\t=> 'Selecteer een pagina om te bewerken of <a href=\"admin.php?p=static&amp;action=write\">voeg nieuw toe</a>.',\n+\t\t'descr'\t\t=> 'Selecteer een pagina om te bewerken of <a href=\"admin.php?p=static&amp;action=write\">voeg een nieuwe toe</a>.',\n \t\n \t\t'sel'\t\t=> 'Selecteer', // checkbox\n \t\t'date'\t\t=> 'Datum',"
        },
        {
          "filename": "fp-interface/lang/nl-nl/lang.admin.widgets.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -19,19 +19,19 @@\n \t\t\t\t\t\tthema dat u kiest.</p>\n \n \t\t\t\t\t\t<p>FlatPress komt met verschillende widgets: zo zijn er widgets om je met inloggen te helpen, om \n-\t\t\t\t\t\tdeen zoek box te tonen, etc.</p>\n+\t\t\t\t\t\teen zoekbox te tonen, etc.</p>\n \t\t\t\t\t\t\n-\t\t\t\t\t\t<p>Elke Widget is gedefineert door een <a class=\"hint\" '.\n+\t\t\t\t\t\t<p>Elke Widget is gedefineerd door een <a class=\"hint\" '.\n \t\t\t\t\t\t'href=\"https://wiki.flatpress.org/res:plugins\" title=\"Wat is een Widget?\">plugin</a>.',\n \t\t\t\t\t\t\n \t\t'availwdgs'\t=> 'Beschikbare Widgets',\n-\t\t'trashcan'\t=> 'Sleep het hier om te verwijderen',\n+\t\t'trashcan'\t=> 'Sleep het hierheen om te verwijderen',\n \t\t\n \t\t'themewdgs' => 'Widgetsets voor dit thema',\n-\t\t'themewdgsdescr' => 'Het thema wat je nu hebt geslekteerd heeft de volgende widgetsets',\n+\t\t'themewdgsdescr' => 'Het thema wat je nu hebt geselekteerd heeft de volgende widgetsets',\n \t\t'oldwdgs'\t=> '\\\\\\andere widgetsets',\n-\t\t'oldwdgsdescr' =>'De volgende widgetsets lijkt niet behoren tot elke andere van de '.\n-\t\t\t\t\t\t'widgetsets als boven getoond. Dit kan herinneringen zijn van andere thema.',\n+\t\t'oldwdgsdescr' =>'De volgende widgetsets lijken niet te behoren tot elke  van de andere '.\n+\t\t\t\t\t\t'widgetsets als boven getoond. Dit kan een overblijfsel zijn van een ander thema.',\n \t\t\n \t\t'submit'\t=> 'Bewaar veranderingen',\n "
        },
        {
          "filename": "fp-interface/lang/nl-nl/lang.comments.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n \n \"%fromname%\" %frommail% heeft een commentaar geplaatst op de volgende post met als titel \"%entrytitle%\".\n \n-Dit het commentaar link naar je blog:\n+Dit de commentaar link naar je blog:\n %commentlink%\n \n Hier is het commentaar dat net is geplaatst:"
        },
        {
          "filename": "fp-interface/lang/nl-nl/lang.contact.php",
          "status": "modified",
          "additions": 11,
          "deletions": 9,
          "patch": "@@ -1,14 +1,16 @@\n <?php\n \n \t$lang['contact'] = array(\n-\t\t'head'\t\t=> 'Contact mij',\n-\t\t'descr'\t\t=> 'Vuk het formulier hieronder in om een feedback te sturen. Vul je email als je een antwoord wilt.',\n-\t\t'fieldset1'\t=> 'Gebruiker gegevens',\n+\t\t'head'\t\t=> 'Neem contact op',\n+\t\t'descr'\t\t=> 'Vul het formulier hieronder in. \n+\t\tOm een antwoord te krijgen is een e-mail adres nodig.\n+\t\t(*) verplicht in te vullen velden',\n+\t\t'fieldset1'\t=> 'Gegevens gebruiker',\n \t\t'name'\t\t=> 'Naam (*)',\n \t\t'email'\t\t=> 'Email:',\n \t\t'www'\t\t=> 'Web:',\n-\t\t'cookie'\t=> 'Herinner mij',\n-\t\t'fieldset2'\t=> 'Jouw bericht',\n+\t\t'cookie'\t=> 'Stuur herinnering',\n+\t\t'fieldset2'\t=> 'Bericht',\n \t\t'comment'\t=> 'Bericht (*):',\n \t\t'fieldset3'\t=> 'Stuur',\n \t\t'submit'\t=> 'Stuur',\n@@ -17,10 +19,10 @@\n \t);\n \t\n \t$lang['contact']['error'] = array(\n-\t\t'name'\t\t=> 'Je moet een naam invullen',\n-\t\t'email'\t\t=> 'Je moet een geldig email invullen',\n-\t\t'www'\t\t=> 'Je moet een geldig URL invullen',\n-\t\t'content'\t=> 'Je moet een bericht invullen',\n+\t\t'name'\t\t=> 'Er dient een naam ingevuld te worden',\n+\t\t'email'\t\t=> 'Geen geldig e-mail adres',\n+\t\t'www'\t\t=> 'Geen geldige URL ',\n+\t\t'content'\t=> 'Het bericht mag niet blanko zijn',\n \t);\n \t\n \t$lang['contact']['msgs'] = array("
        },
        {
          "filename": "fp-interface/lang/nl-nl/lang.default.php",
          "status": "modified",
          "additions": 38,
          "deletions": 38,
          "patch": "@@ -129,56 +129,56 @@\n \n $lang ['date'] ['month'] = array(\n \n-\t'Januari',\n-\t'Februari',\n-\t'Maart',\n-\t'April',\n-\t'Mei',\n-\t'Juni',\n-\t'July',\n-\t'Augustus',\n-\t'September',\n-\t'October',\n-\t'November',\n-\t'December'\n+\t'januari',\n+\t'februari',\n+\t'maart',\n+\t'april',\n+\t'mei',\n+\t'juni',\n+\t'juli',\n+\t'augustus',\n+\t'september',\n+\t'oktober',\n+\t'november',\n+\t'december'\n );\n \n $lang ['date'] ['month_abbr'] = array(\n \n-\t'Jan',\n-\t'Feb',\n-\t'Mrt',\n-\t'Apr',\n-\t'Mei',\n-\t'Jun',\n-\t'Jul',\n-\t'Aug',\n-\t'Sep',\n-\t'Oct',\n-\t'Nov',\n-\t'Dec'\n+\t'jan',\n+\t'feb',\n+\t'mrt',\n+\t'apr',\n+\t'mei',\n+\t'jun',\n+\t'jul',\n+\t'aug',\n+\t'sep',\n+\t'okt',\n+\t'nov',\n+\t'dec'\n );\n \n $lang ['date'] ['weekday'] = array(\n \n-\t'Zondag',\n-\t'Maandag',\n-\t'Dinsdag',\n-\t'Woensdag',\n-\t'Donderdag',\n-\t'Vrijdag',\n-\t'Zaterdag'\n+\t'zondag',\n+\t'maandag',\n+\t'dinsdag',\n+\t'woensdag',\n+\t'donderdag',\n+\t'vrijdag',\n+\t'zaterdag'\n );\n \n $lang ['date'] ['weekday_abbr'] = array(\n \n-\t'Zo',\n-\t'Ma',\n-\t'Di',\n-\t'Wo',\n-\t'Do',\n-\t'Vr',\n-\t'Za'\n+\t'zo',\n+\t'ma',\n+\t'di',\n+\t'wo',\n+\t'do',\n+\t'vr',\n+\t'za'\n );\n \n ?>"
        },
        {
          "filename": "fp-interface/sharedtpls/comment-form.tpl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n {if !$entry_commslock}\n-<h4>{$lang.comments.head}</h4>\n+<h4 id=\"addcomment\">{$lang.comments.head}</h4>\n <p>{$lang.comments.descr}</p>\n \t\n "
        },
        {
          "filename": "fp-interface/sharedtpls/comments.tpl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n {if !$entry_commslock}\n-<h4>{$lang.comments.head}</h4>\n+<h4 id=\"addcomment\">{$lang.comments.head}</h4>\n <p>{$lang.comments.descr}</p>\n \t\n "
        },
        {
          "filename": "fp-interface/sharedtpls/search.tpl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@\n \t</fieldset>\n \t\n \t<fieldset><legend>{$lang.search.fset2}</legend>\n-\t<p>{html_select_date start_year=2000 end_year=$smarty.now|date_format:\"%Y\" field_separator=\" - \" field_order=\"DMY\" time=\"0000-00-00\" all_empty=\"--\"}</p>\n+\t<p>{html_select_date reverse_years=\"true\" start_year=2000 end_year=$smarty.now|date_format:\"%Y\" field_separator=\" - \" field_order=\"DMY\" time=\"0000-00-00\" all_empty=\"--\"}</p>\n \t<p>{$lang.search.datedescr}</p>\n \t</fieldset>\n \t"
        },
        {
          "filename": "fp-interface/themes/leggero/flatmaas-rev/res/common.css",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -435,4 +435,9 @@ div#widget-searchbox li {\n \tmargin:0px;\n \tpadding:0px;\n }\n+form#search ul { \n+\tlist-style-type: none;\n+}\n+form#search ul li:before {\n+ content: none\t\n }\n\\ No newline at end of file"
        },
        {
          "filename": "fp-interface/themes/leggero/leggero-v2/res/common.css",
          "status": "modified",
          "additions": 5,
          "deletions": 49,
          "patch": "@@ -210,7 +210,6 @@ h4 { font-size: 1.2em; }\n \t#main h4 { margin: 2em 0 0 0}\n \n \t#main {\n-\t\tfloat: center;\n \t\twidth: 90%;\n \t\tfont-size: 100%;\n \t\tpadding: 15px;\n@@ -220,54 +219,6 @@ h4 { font-size: 1.2em; }\n \t}\n }\n \n-/* ===== INTERNET EXPLORER ===== */\n-@media \\0screen\\,screen\\9{\n-\n-\tbody { margin: 10px 0 10px 0 }\n-\n-\t/* ===== BODY CONTAINER ===== */\n-\t#body-container {\n-\t\ttext-align: left;\n-\t\tmax-width: 1000px;\n-\t\twidth: 100%;\n-\t\tmargin: 0 auto 0 auto;\n-\t\tpadding: 5px;\n-\t\tbackground:none;\n-\t\tbackground-color:rgba(0,0,0,0.75);\n-\t\t-ms-filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#BF000000,endColorstr=#BF000000);\n-\t\tfilter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#BF000000,endColorstr=#BF000000);\n-\t\tzoom:1;\n-\t\tborder-radius: 3px;\n-\t}\n-\n-\t/* ===== MAIN ===== */\n-\t#main h4 { margin: 2em 0 0 0}\n-\n-\t#main {\n-\t\tfloat:left;\n-\t\tposition: relative;\n-\t\twidth: 65%;\n-\t\tfont-size: 100%;\n-\t\tpadding: 25px;\n-\t\tmargin: 20px;\n-\t\tbackground:none;\n-\t\tbackground-color:rgba(255,255,255,0.9);\n-\t\t-ms-filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#E6FFFFFF,endColorstr=#E6FFFFFF);\n-\t\tfilter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#E6FFFFFF,endColorstr=#E6FFFFFF);\n-\t\tzoom:1;\n-\t\tborder-radius: 3px;\n-\t}\n-\n-\t#head {\n-\t\tbackground:none;\n-\t\tbackground-color:rgba(184,60,46,0.7);\n-\t\t-ms-filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#B3b83c2e,endColorstr=#B3b83c2e);\n-\t\tfilter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#B3b83c2e,endColorstr=#B3b83c2e);\n-\t\tzoom:1;\n-\t}\n-\n-}\n-\n #main p { line-height: 1.4em; margin-top: 1em; }\n \n #main img { margin: .5em }\n@@ -283,6 +234,8 @@ h4 { font-size: 1.2em; }\n \tpadding: 0 1.6em 0 1.6em\n }\n \n+h4#addcomment {clear:both;}\n+\n \t#commentform fieldset p { margin: 0 0 .5em 0 }\n \t\n \t#comments li {\n@@ -350,6 +303,9 @@ h4 { font-size: 1.2em; }\n \t\tmargin-bottom: 3em\n \t}\n \n+\tform#search ul { \n+\t\tlist-style-type: none;\n+\t}\n \n /* ===== FOOTER ===== */\n #footer {"
        },
        {
          "filename": "fp-interface/themes/leggero/leggero-v2/res/globals.css",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -16,7 +16,8 @@ Module: globals.css\n /* ===== NOTIFICATION ===== */\n #main ul.msgs, ul.msgs {\n \tmargin: 0;\n-\tpadding: 1em 2em\n+\tpadding: 1em 2em;\n+\tlist-style-type: none;\n }\n \n .errors {"
        },
        {
          "filename": "fp-interface/themes/leggero/leggero-v2/style.conf.php",
          "status": "modified",
          "additions": 19,
          "deletions": 20,
          "patch": "@@ -1,22 +1,21 @@\n <?php\n-/*  \n-Style Name: Leggero V2\n-Style URI: http://www.flatpress.org/\n-Description: A modern version of the default FlatPress theme.\n-Version: 0.705\n-Author: NoWhereMan, Drudo and Marc Thibeault\n-Author URI: http://www.flatpress.org/\n-*/\n-\t\n-\t$style['name'] = 'leggero-v2';\n-\t$style['author'] = 'NoWhereMan';\n-\t$style['www'] = 'http://www.flatpress.org/';\n-\t\n-\t$style['version'] = 0.705;\n-\t\t\n-\t$style['style_def'] = 'style.css';\n-\t$style['style_admin'] = 'admin.css';\n-\t$style['style_print'] = 'print.css';\n-\t$style['style'] = 'default';\n-\t\n+/*\n+ * Style Name: Leggero V2\n+ * Style URI: http://www.flatpress.org/\n+ * Description: The default FlatPress theme which brings a breath of fresh mint air. Responsive and a great start for own themes!\n+ * Version: 0.705\n+ * Author: NoWhereMan, Drudo and Marc Thibeault\n+ * Author URI: http://www.flatpress.org/\n+ */\n+$style ['name'] = 'leggero-v2';\n+$style ['author'] = 'NoWhereMan';\n+$style ['www'] = 'http://www.flatpress.org/';\n+\n+$style ['version'] = 0.705;\n+\n+$style ['style_def'] = 'style.css';\n+$style ['style_admin'] = 'admin.css';\n+$style ['style_print'] = 'print.css';\n+$style ['style'] = 'default';\n+\n ?>"
        },
        {
          "filename": "fp-interface/themes/leggero/leggero/res/common.css",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -327,6 +327,10 @@ h4 { font-size: 1.2em; }\n \t\tmargin-bottom: 5em\n \t}\n \n+\tform#search ul { \n+\t\tlist-style-type: none;\n+\t}\n+\n \n /* ===== FOOTER ===== */\n #footer {"
        },
        {
          "filename": "fp-interface/themes/leggero/leggero/res/globals.css",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -20,7 +20,8 @@ Module: globals.css\n /* ===== NOTIFICATION ===== */\n #main ul.msgs, ul.msgs {\n \tmargin: 0;\n-\tpadding: 1em 2em\n+\tpadding: 1em 2em;\n+\tlist-style-type: none;\n }\n \n .errors {"
        },
        {
          "filename": "fp-interface/themes/leggero/leggero/style.conf.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n /*\n  * Style Name: Leggero\n  * Style URI: http://www.flatpress.org/\n- * Description: The default FlatPress theme which brings a breath of fresh mint air. Responsive and a great start for own themes!\n+ * Description: A responsive and more flat version of the default FlatPress theme.\n  * Version: 1.2\n  * Author: NoWhereMan and Drudo, optimised by Laborix\n  * Author URI: https://www.flatpress.org/"
        },
        {
          "filename": "fp-interface/themes/leggero/preview.png",
          "status": "modified",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "fp-plugins/calendar/plugin.calendar.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -31,8 +31,9 @@ function generate_calendar($year, $month, $days = array(), $day_name_length = 3,\n \t// Begin calendar. Uses a real <caption>. See http://diveintomark.org/archives/2002/07/03\n \n \t// PHP7 compatibility: Since $pn is never passed, we do not need to create \"previous\" and \"next\" elements.\n-\t$p = '';\n-\t$n = '';\n+\n+\t$p = '<span class=\"calendar-prev\"><a href=\"' . get_month_link($year, $month - 1) . '\">&laquo;</a></span>&nbsp;';\n+\t$n = '&nbsp;<span class=\"calendar-next\"><a href=\"' . get_month_link($year, $month + 1) . '\">&raquo;</a></span>';\n \t// Commented out to prevent deprecated each() function from being executed.\n \t// @list($p, $pl) = each($pn); @list($n, $nl) = each($pn); #previous and next links, if applicable\n \t// if($p) $p = '<span class=\"calendar-prev\">'.($pl ? '<a href=\"'.($pl).'\">'.$p.'</a>' : $p).'</span>&nbsp;';"
        },
        {
          "filename": "fp-plugins/commentcenter/lang/lang.de-de.php",
          "status": "added",
          "additions": 182,
          "deletions": 0,
          "patch": "@@ -0,0 +1,182 @@\n+<?php\n+$lang ['admin'] ['entry'] ['submenu'] ['commentcenter'] = 'Comment Center';\n+$lang ['admin'] ['entry'] ['commentcenter'] = array(\n+\t// Header of the panel\n+\t'title' => 'Comment Center',\n+\t'desc1' => 'Dieses Panel erm\u00f6glicht es Ihnen, die Kommentare in Ihrem Blog zu verwalten.',\n+\t'desc2' => 'Hier k\u00f6nnen Sie mehrere Dinge tun:',\n+\n+\t// Links\n+\t'lpolicies' => 'Verwaltung der Richtlinien',\n+\t'lapprove' => 'Blockierte Kommentare anzeigen',\n+\t'lmanage' => 'Kommentare verwalten',\n+\t'lconfig' => 'Konfigurieren des Plugins',\n+\n+\t// Policies\n+\t'policies' => 'Richtlinien',\n+\t'desc_pol' => 'Hier k\u00f6nnen Sie die Richtlinien f\u00fcr Kommentare bearbeiten.',\n+\t'select' => 'Ausw\u00e4hlen',\n+\t'criteria' => 'Kriterien',\n+\t'behavoir' => 'Verhalten',\n+\t'options' => 'Einstellungen',\n+\t'entry' => 'Eintrag',\n+\t'entries' => 'Eintr\u00e4ge',\n+\t'categories' => 'Kategorien',\n+\t'nopolicies' => 'Es gibt keine Richtlinien',\n+\t'all_entries' => 'Alle Eintr\u00e4ge',\n+\t'fol_entries' => 'Die Richtlinie gilt f\u00fcr die folgenden Eintr\u00e4ge:',\n+\t'fol_cats' => 'Die Richtlinie gilt f\u00fcr Eintr\u00e4ge in den folgenden Kategorien:',\n+\t'older' => 'Die Richtlinie gilt f\u00fcr Eintr\u00e4ge, die \u00e4lter als %d Tag (e) sind.',\n+\t'allow' => 'Kommentare erlauben',\n+\t'block' => 'Kommentare verbieten',\n+\t'approvation' => 'Kommentare m\u00fcssen genehmigt werden',\n+\t'up' => 'Nach oben',\n+\t'down' => 'Nach unten',\n+\t'edit' => 'Bearbeiten',\n+\t'delete' => 'L\u00f6schen',\n+\t'newpol' => 'Eine neue Richtlinie hinzuf\u00fcgen',\n+\t'del_selected' => 'Ausgew\u00e4hlte Richtlinie (n) l\u00f6schen',\n+\t'select_all' => 'Alle ausw\u00e4hlen',\n+\t'deselect_all' => 'Keine ausw\u00e4hlen',\n+\n+\t// Configuration page\n+\t'configure' => 'Konfigurieren des Plugins',\n+\t'desc_conf' => 'Hier k\u00f6nnen Sie die Optionen des Plugins \u00e4ndern.',\n+\t'log_all' => 'Blockierte Kommentare protokollieren',\n+\t'log_all_long' => 'Aktivieren Sie diese Option, wenn Sie auch blockierte Kommentare protokollieren m\u00f6chten.',\n+\t'email_alert' => 'Benachrichtigung per E-Mail',\n+\t'email_alert_long' => 'Wenn Sie einen Kommentar zum Genehmigen pr\u00fcfen sollen, k\u00f6nnen Sie ' . '\u00fcber E-Mail informiert werden.',\n+\t'akismet' => 'Akismet',\n+\t'akismet_use' => 'Kommentar-Pr\u00fcfung mit Akismet',\n+\t'akismet_key' => 'Akismet-Schl\u00fcssel',\n+\t'akismet_key_long' => 'Der Akismet-Dienst stellt Ihnen einen Schl\u00fcssel zur Verf\u00fcgung. F\u00fcgen Sie diesen hier ein.',\n+\t'akismet_url' => 'Blog-URL f\u00fcr Akismet',\n+\t'akismet_url_long' => 'F\u00fcr den kostenlosen Service von Akismet sollten Sie nur eine Domain verwenden. ' . 'Sie k\u00f6nnen dieses Feld leer lassen. Es wird dann <code>%s</code> verwendet.',\n+\t'save_conf' => 'Einstellungen speichern',\n+\n+\t// Edit policy page\n+\t'apply_to' => 'Anwenden auf',\n+\t'editpol' => 'Bearbeiten einer Richtlinie',\n+\t'createpol' => 'Erstellen einer Richtlinie',\n+\t'some_entries' => 'Bestimmte Eintr\u00e4ge',\n+\t'properties' => 'Eintrag mit bestimmten Eigenschaften',\n+\t'se_desc' => 'Wenn Sie die Option %s ausgew\u00e4hlt haben, f\u00fcgen Sie bitte Eintr\u00e4ge ein, die Sie auf diese Richtlinie anwenden m\u00f6chten.',\n+\t'se_fill' => 'Bitte f\u00fcllen Sie die Felder mit der ID der Eintr\u00e4ge aus (<code>entryYYMMDD-HHMMSS</code>).',\n+\t'po_title' => 'Eigenschaften',\n+\t'po_desc' => 'Wenn Sie die Option %s ausgew\u00e4hlt haben, f\u00fcllen Sie bitte die Eigenschaften aus.',\n+\t'po_comp' => 'Die Felder sind nicht obligatorisch, aber Sie m\u00fcssen mindestens eines ausf\u00fcllen oder die Richtlinie ' . 'wird auf alle Eintr\u00e4ge gelten.',\n+\t'po_time' => 'Zeiteinstellungen',\n+\t'po_older' => 'Auf Eintr\u00e4ge anwenden, die \u00e4lter sind als ',\n+\t'days' => 'Tage.',\n+\t'save_policy' => 'Richtlinie speichern',\n+\n+\t// Delete policies page\n+\t'del_policies' => 'Richtlinien l\u00f6schen',\n+\t'del_descs' => 'Sie werden diese Richtlinie l\u00f6schen: ',\n+\t'del_descm' => 'Sie werden diese Richtlinien l\u00f6schen: ',\n+\t'sure' => 'Sind Sie sicher?',\n+\t'del_subs' => 'Ja, bitte l\u00f6schen',\n+\t'del_subm' => 'Ja, bitte l\u00f6schen Sie sie',\n+\t'del_cancel' => 'Nein, zur\u00fcck zu den Einstellungen.',\n+\n+\t// Approve comments page\n+\t'app_title' => 'Genehmigen Sie den Kommentar',\n+\t'app_desc' => 'Hier k\u00f6nnen Sie Kommentare genehmigen.',\n+\t'app_date' => 'Datum',\n+\t'app_content' => 'Kommentar',\n+\t'app_author' => 'Verfasser',\n+\t'app_email' => 'Email',\n+\t'app_ip' => 'IP',\n+\t'app_actions' => 'Ma\u00dfnahmen',\n+\t'app_publish' => 'Ver\u00f6ffentlichung',\n+\t'app_delete' => 'L\u00f6schen',\n+\t'app_nocomms' => 'Es gibt keinen Kommentar.',\n+\t'app_pselected' => 'Ausgew\u00e4hlte Kommentare ver\u00f6ffentlichen',\n+\t'app_dselected' => 'Ausgew\u00e4hlte Kommentare entfernen',\n+\t'app_other' => 'Sonstige Bemerkungen',\n+\t'app_akismet' => 'Als Spam erkannt',\n+\t'app_spamdesc' => 'Diese Kommentare wurden von Akismet blockiert.',\n+\t'app_hamsubmit' => 'Beim Ver\u00f6ffentlichen auch gleich als Ham an Akismet melden.',\n+\t'app_pubnotham' => 'Ver\u00f6ffentlichen, aber nicht an Akismet \u00fcbertragen',\n+\n+\t// Delete comments page\n+\t'delc_title' => 'Kommentare l\u00f6schen',\n+\t'delc_descs' => 'Sie werden diesen Kommentar l\u00f6schen: ',\n+\t'delc_descm' => 'Sie werden diese Kommentare l\u00f6schen: ',\n+\n+\t// Manage comments page\n+\t'man_searcht' => 'Einen Eintrag suchen',\n+\t'man_searchd' => 'F\u00fcgen Sie die ID des Eintrags ein, dessen Kommentare Sie verwalten m\u00f6chten.',\n+\t'man_search' => 'Suche',\n+\t'man_commfor' => 'Bemerkungen f\u00fcr %s',\n+\t'man_spam' => 'Als Spam an Akismet melden',\n+\n+\t// The simple edit\n+\t'simple_pre' => 'Die Kommentare zu diesem Eintrag ',\n+\t'simple_1' => 'werden erlaubt.',\n+\t'simple_0' => 'ben\u00f6tigen Ihre Zustimmung.',\n+\t'simple_-1' => 'werden geblockt.',\n+\t'simple_manage' => 'Verwalten Sie die Kommentare zu diesem Eintrag.',\n+\t'simple_edit' => 'Richtlinien bearbeiten',\n+\n+\t// Akismet warnings\n+\t'akismet_errors' => array(\n+\t\t-1 => 'Der Akismet-Schl\u00fcssel ist leer. Bitte geben Sie diesen ein.',\n+\t\t-2 => 'Wir konnten die Akismet-Server nicht erreichen.',\n+\t\t-3 => 'Die Reaktion von Akismet schlug fehl.',\n+\t\t-4 => 'Der Akismet-Schl\u00fcssel ist ung\u00fcltig.'\n+\t),\n+\n+\t// Messages\n+\t'msgs' => array(\n+\t\t1 => 'Konfiguration gespeichert.',\n+\t\t-1 => 'Beim Speichern der Konfiguration ist ein Fehler aufgetreten.',\n+\n+\t\t2 => 'Richtlinie gespeichert.',\n+\t\t-2 => 'Beim Speichern der Richtlinie ist ein Fehler aufgetreten (vielleicht sind Ihre Einstellungen falsch).',\n+\n+\t\t3 => 'Richtlinie verschoben.',\n+\t\t-3 => 'Beim Versuch, die Richtlinie zu verschieben, ist ein Fehler aufgetreten (oder sie kann nicht verschoben werden).',\n+\n+\t\t4 => 'Richtlinie (n) entfernt.',\n+\t\t-4 => 'Beim Versuch, die Richtlinie (n) zu entfernen, ist ein Fehler aufgetreten (oder Sie haben keine Richtlinie ausgew\u00e4hlt).',\n+\n+\t\t5 => 'Kommentar (e) ver\u00f6ffentlicht.',\n+\t\t-5 => 'Beim Versuch, die Kommentare zu ver\u00f6ffentlichen, ist ein Fehler aufgetreten.',\n+\n+\t\t6 => 'Kommentar (e) entfernt.',\n+\t\t-6 => 'Beim Versuch, die Kommentare zu entfernen, ist ein Fehler aufgetreten (oder Sie haben keinen Kommentar ausgew\u00e4hlt).',\n+\n+\t\t7 => 'Kommentar eingereicht.',\n+\t\t-7 => 'Beim Absenden des Kommentars ist ein Fehler aufgetreten.'\n+\t),\n+\n+\t// Errors\n+\t'errors' => array(\n+\t\t'pol_nonex' => 'Die Richtlinie, die Sie bearbeiten m\u00f6chten, existiert nicht.',\n+\t\t'entry_nf' => 'Der gew\u00e4hlte Eintrag existiert nicht.'\n+\t)\n+);\n+$lang ['plugin'] ['commentcenter'] = array(\n+\t'akismet_error' => 'Sorry, wir stossen auf technische Schwierigkeiten.',\n+\t'lock' => 'Dieser Eintrag kann leider nicht kommentiert werden.',\n+\t'approvation' => 'Der Kommentar wurde gespeichert, aber der Administrator muss ihn freischalten, bevor er angezeigt wird.',\n+\n+\t// Mail for comments\n+\t'mail_subj' => 'Neuer Kommentar zu genehmigen %s'\n+);\n+\n+$lang ['plugin'] ['commentcenter'] ['mail_text'] = 'Hallo %toname%,\n+\n+\"%fromname%\" %frommail% hat einen Kommentar zu dem Eintrag geschrieben mit dem Titel \"%entrytitle%\"\n+Aber dieser braucht deine Zustimmung, bevor dieser ver\u00f6ffentlicht wird.\n+\n+Folgendes wurde als Kommentar geschrieben:\n+__________________________________________\n+%content%\n+__________________________________________\n+\n+Automatisch generiert von\n+%blogtitle%\n+\n+';"
        },
        {
          "filename": "login.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -13,7 +13,7 @@ function login_validate() {\n \t$pass = trim(@$_POST ['pass']);\n \n \t$error = array();\n-\t$lerr = & $lang ['login'] ['error'];\n+\t$lerr = &$lang ['login'] ['error'];\n \n \tif (!$user) {\n \t\t$error ['user'] = $lerr ['user'];\n@@ -44,7 +44,8 @@ function main() {\n \t\t\tuser_logout();\n \n \t\t\tfunction myredirect() {\n-\t\t\t\t// login_redirect('.');\n+\t\t\t\t// logout redirects to home page\n+\t\t\t\tlogin_redirect('.');\n \t\t\t}\n \n \t\t\tadd_filter('wp_head', 'myredirect');\n@@ -53,6 +54,7 @@ function myredirect() {\n \t\t} elseif (user_loggedin()) {\n \n \t\t\tfunction myredirect() {\n+\t\t\t\t// login redirects to Admin Area\n \t\t\t\tlogin_redirect('admin.php');\n \t\t\t}\n "
        },
        {
          "filename": "setup/index.php",
          "status": "modified",
          "additions": 3,
          "deletions": 4,
          "patch": "@@ -1,10 +1,9 @@\n <?php\n-//require_once('../init.php');\n-//utils_redirect('../admin.php');\n-\n+// require_once('../init.php');\n+// utils_redirect('../admin.php');\n ?>\n \n-<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n+<!DOCTYPE html>\n <html xmlns=\"http://www.w3.org/1999/xhtml\">\n <head>\n \t<title>FlatPress</title>"
        },
        {
          "filename": "setup/tpls/header.tpl.php",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -1,5 +1,4 @@\n-<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\n-   \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n+<!DOCTYPE html>\n <html xmlns=\"http://www.w3.org/1999/xhtml\">\n <head><title>Flatpress installer</title>\n \t\t<link href=\"setup/res/setup.css\" type=\"text/css\" rel=\"stylesheet\" /></head>\n@@ -11,4 +10,6 @@\n \t\t<div id=\"main\">\n \t\t\n \t\n-<form class=\"storycontent\" method=\"post\" action=\"<?php echo BLOG_BASEURL ?>setup.php\"> \n\\ No newline at end of file\n+<form class=\"storycontent\" method=\"post\" action=\"<?php\n+\n+echo BLOG_BASEURL?>setup.php\"> \n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 17,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f200970261993130d581f447cfcb3aa20fa11e64",
            "date": "2025-01-13T17:34:18Z",
            "author_login": "azett"
          },
          {
            "sha": "73b4cd5bb38d78b5db79ea65702725d3b51ac3bb",
            "date": "2025-01-13T01:06:44Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "447cf24a4d06d4b34679c7af6046c7f06e67b168",
            "date": "2025-01-13T00:21:04Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "e16c81caef23f89818633d0404db6241eb76537a",
            "date": "2025-01-13T00:19:55Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "6193e7df40faf9e6d9b711985789de304a021e93",
            "date": "2025-01-12T14:34:52Z",
            "author_login": "azett"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-98",
    "description": "PHP Remote File Inclusion in GitHub repository flatpressblog/flatpress prior to 1.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-18T13:15:09.963",
    "last_modified": "2024-11-21T07:35:35.153",
    "fix_date": "2022-10-08T11:43:33Z"
  },
  "references": [
    {
      "url": "https://github.com/flatpressblog/flatpress/commit/c30d52b28483e1e512d0d81758d4c149f02b4068",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/3dab0466-c35d-4163-b3c7-a8666e2f7d95",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flatpressblog/flatpress/commit/c30d52b28483e1e512d0d81758d4c149f02b4068",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/3dab0466-c35d-4163-b3c7-a8666e2f7d95",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.179947",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "flatpress",
    "owner": "flatpressblog",
    "created_at": "2013-09-16T07:49:11Z",
    "updated_at": "2025-01-13T17:34:22Z",
    "pushed_at": "2025-01-13T17:34:18Z",
    "size": 10704,
    "stars": 188,
    "forks": 57,
    "open_issues": 29,
    "watchers": 188,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3133798,
      "JavaScript": 142691,
      "Smarty": 118053,
      "CSS": 99012,
      "Yacc": 40745,
      "HTML": 32532,
      "Shell": 964
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:55:36.605095"
  }
}