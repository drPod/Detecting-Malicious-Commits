{
  "cve_id": "CVE-2022-46164",
  "github_data": {
    "repository": "NodeBB/NodeBB",
    "fix_commit": "48d143921753914da45926cca6370a92ed0c46b8",
    "related_commits": [
      "48d143921753914da45926cca6370a92ed0c46b8",
      "48d143921753914da45926cca6370a92ed0c46b8"
    ],
    "patch_url": "https://github.com/NodeBB/NodeBB/commit/48d143921753914da45926cca6370a92ed0c46b8.patch",
    "fix_commit_details": {
      "sha": "48d143921753914da45926cca6370a92ed0c46b8",
      "commit_date": "2022-11-28T00:32:35Z",
      "author": {
        "login": "barisusakli",
        "type": "User",
        "stats": {
          "total_commits": 12173,
          "average_weekly_commits": 19.858075040783035,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 600
        }
      },
      "commit_message": {
        "title": "fix: prototype vulnerability in socket.io onMessage",
        "length": 51,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/socket.io/index.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -13,7 +13,7 @@ const logger = require('../logger');\n const plugins = require('../plugins');\n const ratelimit = require('../middleware/ratelimit');\n \n-const Namespaces = {};\n+const Namespaces = Object.create(null);\n \n const Sockets = module.exports;\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5120d11721211405ca7035b450c745747a3b6ad2",
            "date": "2025-01-14T19:45:44Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "c6eaea309e7b49bb5aa288f647efd366786f8462",
            "date": "2025-01-14T15:16:10Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "e89b7ec88762a05e90745d6c89323dc740e0e096",
            "date": "2025-01-13T16:59:42Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "45eabbf5ba2100201fe887a9d6fc81d88379d414",
            "date": "2025-01-08T22:21:05Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "98e5d1b5c2bd33fc4340dc175d1a31c53ab22a83",
            "date": "2025-01-08T17:54:04Z",
            "author_login": "nodebb-misty"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L",
    "cwe_id": "CWE-665",
    "description": "NodeBB is an open source Node.js based forum software. Due to a plain object with a prototype being used in socket.io message handling a specially crafted payload can be used to impersonate other users and takeover accounts. This vulnerability has been patched in version 2.6.1. Users are advised to upgrade. Users unable to upgrade may cherry-pick commit `48d143921753914da45926cca6370a92ed0c46b8` into their codebase to patch the exploit.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-05T21:15:10.443",
    "last_modified": "2024-11-21T07:30:14.353",
    "fix_date": "2022-11-28T00:32:35Z"
  },
  "references": [
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/48d143921753914da45926cca6370a92ed0c46b8",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-rf3g-v8p5-p675",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/48d143921753914da45926cca6370a92ed0c46b8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/security/advisories/GHSA-rf3g-v8p5-p675",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:21.203083",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "NodeBB",
    "owner": "NodeBB",
    "created_at": "2013-04-22T16:49:40Z",
    "updated_at": "2025-01-14T17:22:47Z",
    "pushed_at": "2025-01-14T16:53:56Z",
    "size": 94074,
    "stars": 14301,
    "forks": 2808,
    "open_issues": 183,
    "watchers": 14301,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "JavaScript": 3635990,
      "Smarty": 492390,
      "SCSS": 35767,
      "HTML": 6457,
      "Shell": 5633,
      "Dockerfile": 4860,
      "CSS": 3261,
      "Batchfile": 42
    },
    "commit_activity": {
      "total_commits_last_year": 1255,
      "avg_commits_per_week": 24.134615384615383,
      "days_active_last_year": 279
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T18:31:47.568922"
  }
}