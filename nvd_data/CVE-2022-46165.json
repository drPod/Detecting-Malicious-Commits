{
  "cve_id": "CVE-2022-46165",
  "github_data": {
    "repository": "syncthing/syncthing",
    "fix_commit": "73c52eafb6566435dffd979c3c49562b6d5a4238",
    "related_commits": [
      "73c52eafb6566435dffd979c3c49562b6d5a4238",
      "73c52eafb6566435dffd979c3c49562b6d5a4238"
    ],
    "patch_url": "https://github.com/syncthing/syncthing/commit/73c52eafb6566435dffd979c3c49562b6d5a4238.patch",
    "fix_commit_details": {
      "sha": "73c52eafb6566435dffd979c3c49562b6d5a4238",
      "commit_date": "2023-06-05T11:16:02Z",
      "author": {
        "login": "calmh",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "gui: Avoid code generating HTML (#8923)",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 108,
        "additions": 41,
        "deletions": 67
      },
      "files": [
        {
          "filename": "gui/default/assets/css/overrides.css",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -185,7 +185,7 @@ td input[type=\"checkbox\"] {\n }\n \n /* Wrap long file paths to prevent text overflow. See issue #6268. */\n-.file-path {\n+.word-break-all {\n     word-break: break-all;\n }\n "
        },
        {
          "filename": "gui/default/index.html",
          "status": "modified",
          "additions": 17,
          "deletions": 5,
          "patch": "@@ -288,7 +288,7 @@ <h3 class=\"panel-title\">\n             <div class=\"panel-body\">\n               <p ng-repeat=\"err in errorList()\">\n                 <small>{{err.when | date:\"yyyy-MM-dd HH:mm:ss\"}}:</small>\n-                <span ng-bind-html=\"friendlyDevices(err.message) | linky: '_blank'\"></span>\n+                <span ng-bind=\"friendlyDevices(err.message)\"></span>\n               </p>\n             </div>\n             <div class=\"panel-footer\">\n@@ -553,8 +553,14 @@ <h4 class=\"panel-title\">\n                       </tr>\n                       <tr>\n                         <th><span class=\"fas fa-fw fa-share-alt\"></span>&nbsp;<span translate>Shared With</span></th>\n-                        <td class=\"text-right\">\n-                          <span tooltip data-original-title=\"{{sharesFolder(folder)}} {{folderHasUnacceptedDevices(folder) ? '<br/>(<sup>1</sup>' + ('The remote device has not accepted sharing this folder.' | translate) + ')' : ''}} {{folderHasPausedDevices(folder) ? '<br/>(<sup>2</sup>' + ('The remote device has paused this folder.' | translate) + ')' : ''}}\" ng-bind-html=\"sharesFolder(folder)\"></span>\n+                        <td class=\"text-right no-overflow-ellipse word-break-all\">\n+                          <span ng-repeat=\"device in folder.devices\">\n+                            <span ng-if=\"device.deviceID != myID\" ng-switch=\"completion[device.deviceID][folder.id].remoteState\">\n+                              <span ng-switch-when=\"notSharing\" data-original-title=\"{{'The remote device has not accepted sharing this folder.' | translate}}\" tooltip>{{deviceName(devices[device.deviceID])}}<sup>1</sup><span ng-if=\"!$last\">,</span></span>\n+                              <span ng-switch-when=\"paused\" data-original-title=\"{{'The remote device has paused this folder.' | translate}}\" tooltip>{{deviceName(devices[device.deviceID])}}<sup>2</sup><span ng-if=\"!$last\">,</span></span>\n+                              <span ng-switch-default>{{deviceName(devices[device.deviceID])}}<span ng-if=\"!$last\">,</span></span>\n+                            </span>\n+                          </span>\n                         </td>\n                       </tr>\n                       <tr ng-if=\"folderStats[folder.id].lastScan\">\n@@ -883,8 +889,14 @@ <h4 class=\"panel-title\">\n                       </tr>\n                       <tr ng-if=\"deviceFolders(deviceCfg).length > 0\">\n                         <th><span class=\"fas fa-fw fa-folder\"></span>&nbsp;<span translate>Folders</span></th>\n-                        <td class=\"text-right\">\n-                          <span tooltip data-original-title=\"{{sharedFolders(deviceCfg)}} {{deviceHasUnacceptedFolders(deviceCfg) ? '<br/>(<sup>1</sup>' + ('The remote device has not accepted sharing this folder.' | translate) + ')' : '' }} {{deviceHasPausedFolders(deviceCfg) ? '<br/>(<sup>2</sup>' + ('The remote device has paused this folder.' | translate) + ')' : '' }}\" ng-bind-html=\"sharedFolders(deviceCfg)\"></span>\n+                        <td class=\"text-right no-overflow-ellipse word-break-all\">\n+                          <span ng-repeat=\"folderID in deviceFolders(deviceCfg)\">\n+                            <span ng-switch=\"completion[deviceCfg.deviceID][folderID].remoteState\">\n+                              <span ng-switch-when=\"notSharing\" data-original-title=\"{{'The remote device has not accepted sharing this folder.' | translate}}\" tooltip>{{folderLabel(folderID)}}<sup>1</sup><span ng-if=\"!$last\">,</span></span>\n+                              <span ng-switch-when=\"paused\" data-original-title=\"{{'The remote device has paused this folder.' | translate}}\" tooltip>{{folderLabel(folderID)}}<sup>2</sup><span ng-if=\"!$last\">,</span></span>\n+                              <span ng-switch-default>{{folderLabel(folderID)}}<span ng-if=\"!$last\">,</span></span>\n+                            </span>\n+                          </span>\n                         </td>\n                       </tr>\n                       <tr ng-if=\"deviceCfg.remoteGUIPort > 0\">"
        },
        {
          "filename": "gui/default/syncthing/core/aboutModalView.html",
          "status": "modified",
          "additions": 10,
          "deletions": 10,
          "patch": "@@ -86,37 +86,37 @@ <h4 class=\"text-center\" translate>The Syncthing Authors</h4>\n           <tbody>\n             <tr>\n               <th translate>User Home</th>\n-              <td><code class=\"file-path\">{{ about.paths['baseDir-userHome'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['baseDir-userHome'] }}</code></td>\n             </tr>\n             <tr>\n               <th><strong translate>Configuration Directory</strong></th>\n-              <td><code class=\"file-path\"><strong>{{ about.paths['baseDir-config'] }}</strong></code></td>\n+              <td><code class=\"word-break-all\"><strong>{{ about.paths['baseDir-config'] }}</strong></code></td>\n             </tr>\n             <tr>\n               <th translate>Configuration File</th>\n-              <td><code class=\"file-path\">{{ about.paths['config'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['config'] }}</code></td>\n             </tr>\n             <tr>\n               <th translate>Device Certificate</th>\n-              <td><code class=\"file-path\">{{ about.paths['certFile'] }}</code>\n-                <br /><code class=\"file-path\">{{ about.paths['keyFile'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['certFile'] }}</code>\n+                <br /><code class=\"word-break-all\">{{ about.paths['keyFile'] }}</code></td>\n             </tr>\n             <tr>\n               <th translate>GUI / API HTTPS Certificate</th>\n-              <td><code class=\"file-path\">{{ about.paths['httpsCertFile'] }}</code>\n-                <br /><code class=\"file-path\">{{ about.paths['httpsKeyFile'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['httpsCertFile'] }}</code>\n+                <br /><code class=\"word-break-all\">{{ about.paths['httpsKeyFile'] }}</code></td>\n             </tr>\n             <tr>\n               <th translate>Database Location</th>\n-              <td><code class=\"file-path\">{{ about.paths['database'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['database'] }}</code></td>\n             </tr>\n             <tr>\n               <th translate>Log File</th>\n-              <td><code class=\"file-path\">{{ about.paths['logFile'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['logFile'] }}</code></td>\n             </tr>\n             <tr>\n               <th translate>GUI Override Directory</th>\n-              <td><code class=\"file-path\">{{ about.paths['guiAssets'] }}</code></td>\n+              <td><code class=\"word-break-all\">{{ about.paths['guiAssets'] }}</code></td>\n             </tr>\n           </tbody>\n         </table>"
        },
        {
          "filename": "gui/default/syncthing/core/editShareTemplate.html",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -1,7 +1,13 @@\n <div class=\"col-md-6 checkbox\">\n   <label for=\"sharedwith-{{id}}\">\n     <input id=\"sharedwith-{{id}}\" ng-model=\"selected[id]\" type=\"checkbox\" />\n-    <span tooltip data-original-title=\"{{id}}\" ng-bind-html=\"label\"></span>\n+    <span tooltip data-original-title=\"{{id}}\">\n+      <span ng-switch=\"remoteState\">\n+        <span ng-switch-when=\"notSharing\">{{label}}<sup>1</sup></span>\n+        <span ng-switch-when=\"paused\">{{label}}<sup>2</sup></span>\n+        <span ng-switch-default>{{label}}</span>\n+      </span>\n+    </span>\n   </label>\n </div>\n <div class=\"col-md-6\">"
        },
        {
          "filename": "gui/default/syncthing/core/syncthingController.js",
          "status": "modified",
          "additions": 1,
          "deletions": 45,
          "patch": "@@ -2452,30 +2452,6 @@ angular.module('syncthing.core')\n                          + '&device=' + encodeURIComponent(deviceID));\n         };\n \n-        $scope.deviceNameMarkRemoteState = function (deviceID, folderID) {\n-            var name = $scope.deviceName($scope.devices[deviceID]);\n-            // Add footnote if sharing was not accepted on the remote device\n-            if (deviceID in $scope.completion && folderID in $scope.completion[deviceID]) {\n-                if ($scope.completion[deviceID][folderID].remoteState == 'notSharing') {\n-                    name += '<sup>1</sup>';\n-                } else if ($scope.completion[deviceID][folderID].remoteState == 'paused') {\n-                    name += '<sup>2</sup>';\n-                }\n-            }\n-            return name;\n-        };\n-\n-        $scope.sharesFolder = function (folderCfg) {\n-            var names = [];\n-            folderCfg.devices.forEach(function (device) {\n-                if (device.deviceID !== $scope.myID) {\n-                    names.push($scope.deviceNameMarkRemoteState(device.deviceID, folderCfg.id));\n-                }\n-            });\n-            names.sort();\n-            return names.join(\", \");\n-        };\n-\n         $scope.folderHasUnacceptedDevices = function (folderCfg) {\n             for (var deviceID in $scope.completion) {\n                 if (deviceID in $scope.devices\n@@ -2519,27 +2495,6 @@ angular.module('syncthing.core')\n             return label && label.length > 0 ? label : folderID;\n         };\n \n-        $scope.folderLabelMarkRemoteState = function (folderID, deviceID) {\n-            var label = $scope.folderLabel(folderID);\n-            // Add footnote if sharing was not accepted on the remote device\n-            if (deviceID in $scope.completion && folderID in $scope.completion[deviceID]) {\n-                if ($scope.completion[deviceID][folderID].remoteState == 'notSharing') {\n-                    label += '<sup>1</sup>';\n-                } else if ($scope.completion[deviceID][folderID].remoteState == 'paused') {\n-                    label += '<sup>2</sup>';\n-                }\n-            }\n-            return label;\n-        };\n-\n-        $scope.sharedFolders = function (deviceCfg) {\n-            var labels = [];\n-            $scope.deviceFolders(deviceCfg).forEach(function (folderID) {\n-                labels.push($scope.folderLabelMarkRemoteState(folderID, deviceCfg.deviceID));\n-            });\n-            return labels.join(', ');\n-        };\n-\n         $scope.deviceHasUnacceptedFolders = function (deviceCfg) {\n             if (!(deviceCfg.deviceID in $scope.completion)) {\n                 return false;\n@@ -3429,6 +3384,7 @@ angular.module('syncthing.core')\n                 id: '@',\n                 label: '@',\n                 folderType: '@',\n+                remoteState: '@',\n                 untrusted: '=',\n             },\n             link: function (scope, elem, attrs) {"
        },
        {
          "filename": "gui/default/syncthing/device/editDeviceModalView.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -92,7 +92,7 @@\n                   <a href=\"#\" ng-click=\"selectAllSharedFolders(false)\" translate>Deselect All</a></small>\n               </p>\n               <div class=\"form-group\" ng-repeat=\"folder in currentSharing.shared\">\n-                <share-template selected=\"currentSharing.selected\" encryption-passwords=\"currentSharing.encryptionPasswords\" id=\"{{folder.id}}\" label=\"{{folderLabelMarkRemoteState(folder.id, currentDevice.deviceID)}}\" folder-type=\"{{folder.type}}\" untrusted=\"currentDevice.untrusted\" />\n+                <share-template selected=\"currentSharing.selected\" encryption-passwords=\"currentSharing.encryptionPasswords\" id=\"{{folder.id}}\" label=\"{{folderLabel(folder.id)}}\" folder-type=\"{{folder.type}}\" untrusted=\"currentDevice.untrusted\" remote-state=\"{{completion[currentDevice.deviceID][folder.id].remoteState}}\" />\n               </div>\n               <p class=\"help-block\" ng-if=\"deviceHasUnacceptedFolders(currentDevice)\">\n                 <sup>1</sup> <span translate>The remote device has not accepted sharing this folder.</span>"
        },
        {
          "filename": "gui/default/syncthing/device/globalChangesModalView.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -28,7 +28,7 @@\n               <span ng-switch-default>{{changeEvent.data.type}}</span>\n             </td>\n             <td class=\"no-overflow-ellipse\">{{folderLabel(changeEvent.data.folder)}}</td>\n-            <td class=\"file-path no-overflow-ellipse\">{{changeEvent.data.path}}</td>\n+            <td class=\"word-break-all no-overflow-ellipse\">{{changeEvent.data.path}}</td>\n             <td class=\"no-overflow-ellipse\">{{changeEvent.time | date:\"yyyy-MM-dd HH:mm:ss\"}}</td>\n           </tr>\n         </tbody>"
        },
        {
          "filename": "gui/default/syncthing/folder/editFolderModalView.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -56,7 +56,7 @@\n                 <a href=\"#\" ng-click=\"selectAllSharedDevices(false)\" translate>Deselect All</a></small>\n             </p>\n             <div class=\"form-group\" ng-repeat=\"device in currentSharing.shared\">\n-              <share-template selected=\"currentSharing.selected\" encryption-passwords=\"currentSharing.encryptionPasswords\" id=\"{{device.deviceID}}\" label=\"{{deviceNameMarkRemoteState(device.deviceID, currentFolder.id)}}\" folder-type=\"{{currentFolder.type}}\" untrusted=\"device.untrusted || pendingIsRemoteEncrypted(currentFolder.id, device.deviceID)\" />\n+              <share-template selected=\"currentSharing.selected\" encryption-passwords=\"currentSharing.encryptionPasswords\" id=\"{{device.deviceID}}\" label=\"{{deviceName(device)}}\" folder-type=\"{{currentFolder.type}}\" untrusted=\"device.untrusted || pendingIsRemoteEncrypted(currentFolder.id, device.deviceID)\" remote-state=\"{{completion[device.deviceID][currentFolder.id].remoteState}}\" />\n             </div>\n             <p class=\"help-block\" ng-if=\"folderHasUnacceptedDevices(currentFolder)\">\n               <sup>1</sup> <span translate>The remote device has not accepted sharing this folder.</span>"
        },
        {
          "filename": "gui/default/syncthing/transfer/localChangedFilesModalView.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -15,7 +15,7 @@\n         </tr>\n       </thead>\n       <tr dir-paginate=\"file in localChanged.files | itemsPerPage: localChanged.perpage\" current-page=\"localChanged.page\" total-items=\"model[localChangedFolder].receiveOnlyTotalItems\" pagination-id=\"localChanged\">\n-        <td class=\"file-path\">{{file.name}}</td>\n+        <td class=\"word-break-all\">{{file.name}}</td>\n         <td><span ng-hide=\"file.type == 'DIRECTORY'\">{{file.size | binary}}B</span></td>\n       </tr>\n     </table>"
        },
        {
          "filename": "gui/default/syncthing/transfer/remoteNeededFilesModalView.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -22,7 +22,7 @@ <h4 class=\"panel-title\">\n                 </tr>\n               </thead>\n               <tr dir-paginate=\"file in remoteNeed[folder].files | itemsPerPage: remoteNeed[folder].perpage\" current-page=\"remoteNeed[folder].page\" total-items=\"completion[remoteNeedDevice.deviceID][folder].needItems\" pagination-id=\"'remoteNeed-' + folder\">\n-                <td class=\"file-path\">{{file.name}}</td>\n+                <td class=\"word-break-all\">{{file.name}}</td>\n                 <td><span ng-hide=\"file.type == 'DIRECTORY'\">{{file.size | binary}}B</span></td>\n                 <td>{{file.modified | date:\"yyyy-MM-dd HH:mm:ss\"}}</td>\n                 <td ng-if=\"file.modifiedBy\">{{friendlyNameFromShort(file.modifiedBy)}}</td>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1fbd396ffa3fedf1217947963df8a4634c721b4c",
            "date": "2025-01-13T17:35:55Z",
            "author_login": "calmh"
          },
          {
            "sha": "2834bad85e669b5779f47b7a8bb2d0a351afa65a",
            "date": "2025-01-13T03:47:27Z",
            "author_login": "st-release"
          },
          {
            "sha": "516f3e29e8cc7091ea6271715308caea0fcc0778",
            "date": "2025-01-11T16:38:29Z",
            "author_login": "calmh"
          },
          {
            "sha": "ab20c16982b1fa4cc2d84c3f88db054d9b21793b",
            "date": "2025-01-09T20:47:10Z",
            "author_login": "calmh"
          },
          {
            "sha": "0c1df81ee963dec850c57c0aef7f353a473260c1",
            "date": "2025-01-09T18:42:18Z",
            "author_login": "calmh"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Syncthing is an open source, continuous file synchronization program. In versions prior to 1.23.5 a compromised instance with shared folders could sync malicious files which contain arbitrary HTML and JavaScript in the name. If the owner of another device looks over the shared folder settings and moves the mouse over the latest sync, a script could be executed to change settings for shared folders or add devices automatically. Additionally adding a new device with a malicious name could embed HTML or JavaScript inside parts of the page. As a result the webUI may be subject to a stored cross site scripting attack. This issue has been addressed in version 1.23.5. Users are advised to upgrade. Users unable to upgrade should avoid sharing folders with untrusted users.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-06T18:15:10.100",
    "last_modified": "2024-11-21T07:30:14.470",
    "fix_date": "2023-06-05T11:16:02Z"
  },
  "references": [
    {
      "url": "https://github.com/syncthing/syncthing/commit/73c52eafb6566435dffd979c3c49562b6d5a4238",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/syncthing/syncthing/security/advisories/GHSA-9rp6-23gf-4c3h",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IRYGBFJPVBW6PPTETNIBWQJE4HJSA5PJ/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XEBWSQVGHSTR4ZO7LVVEMPEGMV2DS5XR/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/syncthing/syncthing/commit/73c52eafb6566435dffd979c3c49562b6d5a4238",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/syncthing/syncthing/security/advisories/GHSA-9rp6-23gf-4c3h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IRYGBFJPVBW6PPTETNIBWQJE4HJSA5PJ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XEBWSQVGHSTR4ZO7LVVEMPEGMV2DS5XR/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.310807",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "syncthing",
    "owner": "syncthing",
    "created_at": "2013-11-26T09:48:21Z",
    "updated_at": "2025-01-14T13:02:20Z",
    "pushed_at": "2025-01-14T01:29:04Z",
    "size": 122283,
    "stars": 66822,
    "forks": 4361,
    "open_issues": 397,
    "watchers": 66822,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "infrastructure",
      "main",
      "release-buildmetadata",
      "release-ezapt",
      "release-multicon",
      "release-multiquic",
      "release-next",
      "release-nightly",
      "release-test-discosrv-db",
      "release-test-jb-indexnos",
      "release-test-lzma2",
      "release-test-prometheus",
      "release-test-push",
      "release-test-replicationwrites",
      "release-test-tokensfail",
      "release-v1.26.1"
    ],
    "languages": {
      "Go": 2966478,
      "HTML": 243779,
      "JavaScript": 193311,
      "TypeScript": 94547,
      "Shell": 61862,
      "CSS": 25578,
      "SCSS": 8041,
      "Dockerfile": 1746,
      "Ruby": 723,
      "PowerShell": 264,
      "Batchfile": 124
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mpl-2.0"
    },
    "collected_at": "2025-01-14T13:59:15.725682"
  }
}