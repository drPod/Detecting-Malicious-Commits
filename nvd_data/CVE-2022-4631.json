{
  "cve_id": "CVE-2022-4631",
  "github_data": {
    "repository": "lesterchan/wp-ban",
    "fix_commit": "22b925449c84faa9b7496abe4f8f5661cb5eb3bf",
    "related_commits": [
      "22b925449c84faa9b7496abe4f8f5661cb5eb3bf",
      "22b925449c84faa9b7496abe4f8f5661cb5eb3bf"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "22b925449c84faa9b7496abe4f8f5661cb5eb3bf",
      "commit_date": "2022-12-04T11:23:41Z",
      "author": {
        "login": "lesterchan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed XSS",
        "length": 9,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 200,
        "additions": 98,
        "deletions": 102
      },
      "files": [
        {
          "filename": ".travis.yml",
          "status": "removed",
          "additions": 0,
          "deletions": 13,
          "patch": "@@ -1,13 +0,0 @@\n-language: php\n-php:\n-  - \"7.3\"\n-  - \"7.2\"\n-  - \"7.1\"\n-  - \"7.0\"\n-  - \"5.6\"\n-\n-script:\n-  - find . \\( -name '*.php' \\) -exec php -lf {} \\;\n-\n-notifications:\n-  email: false"
        },
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -3,17 +3,14 @@ Contributors: GamerZ\n Donate link: https://lesterchan.net/site/donation/  \n Tags: banned, ban, deny, denied, permission, ip, hostname, host, spam, bots, bot, exclude, referrer, url, referral, range  \n Requires at least: 4.3   \n-Tested up to: 5.9  \n-Stable tag: 1.69  \n+Tested up to: 6.1  \n+Stable tag: 1.69.1  \n \n Ban users by IP, IP Range, host name, user agent and referrer url from visiting your WordPress's blog.\n \n ## Description\n It will display a custom ban message when the banned IP, IP range, host name or referrer url that tries to visit you blog. You can also exclude certain IPs from being banned. There will be statistics recorded on how many times they attempt to visit your blog. It allows wildcard matching too.\n \n-### Build Status\n-[![Build Status](https://travis-ci.org/lesterchan/wp-ban.svg?branch=master)](https://travis-ci.org/lesterchan/wp-ban)\n-\n ### Development\n * [https://github.com/lesterchan/wp-ban](https://github.com/lesterchan/wp-ban \"https://github.com/lesterchan/wp-ban\")\n \n@@ -27,6 +24,9 @@ It will display a custom ban message when the banned IP, IP range, host name or\n * I spent most of my free time creating, updating, maintaining and supporting these plugins, if you really love my plugins and could spare me a couple of bucks, I will really appreciate it. If not feel free to use it without any obligations.\n \n ## Changelog\n+### Version 1.69.1\n+* NEW: Fixed XSS\n+\n ### Version 1.69\n * NEW: Bump WordPress 4.7\n * FIXED: Notices"
        },
        {
          "filename": "ban-options.php",
          "status": "modified",
          "additions": 60,
          "deletions": 51,
          "patch": "@@ -9,6 +9,15 @@\n $base_page = 'admin.php?page='.$base_name;\n $admin_login = trim($current_user->user_login);\n \n+# Allow HTML\n+$allowed_tags = wp_kses_allowed_html( 'post' );\n+$allowed_tags['html'] = true;\n+$allowed_tags['head'] = true;\n+$allowed_tags['meta'] = array(\n+    'charset' => true,\n+);\n+$allowed_tags['body'] = true;\n+\n ### Form Processing\n // Update Options\n if( ! empty( $_POST['Submit'] ) ) {\n@@ -24,101 +33,101 @@\n     $banned_referers_post       = ! empty( $_POST['banned_referers'] )          ? explode( \"\\n\", trim($_POST['banned_referers'] ) ) : array();\n     $banned_user_agents_post    = ! empty( $_POST['banned_user_agents'] )       ? explode( \"\\n\", trim($_POST['banned_user_agents'] ) ) : array();\n     $banned_exclude_ips_post    = ! empty( $_POST['banned_exclude_ips'] )       ? explode( \"\\n\", trim( $_POST['banned_exclude_ips'] ) ) : array();\n-    $banned_message             = ! empty( $_POST['banned_template_message'] )  ? trim( $_POST['banned_template_message'] ) : '';\n+    $banned_message             = ! empty( $_POST['banned_template_message'] )  ? wp_kses( trim( $_POST['banned_template_message'] ), $allowed_tags ) : '';\n \n     $banned_ips = array();\n-    if(!empty($banned_ips_post)) {\n-        foreach($banned_ips_post as $banned_ip) {\n-            if($admin_login == 'admin' && ($banned_ip == ban_get_ip() || is_admin_ip($banned_ip))) {\n-                $text .= '<p style=\"color: blue;\">'.sprintf(__('This IP \\'%s\\' Belongs To The Admin And Will Not Be Added To Ban List', 'wp-ban'),$banned_ip).'</p>';\n+    if ( ! empty( $banned_ips_post ) ) {\n+        foreach ( $banned_ips_post as $banned_ip ) {\n+            if( $admin_login === 'admin' && ( $banned_ip === ban_get_ip() || is_admin_ip( $banned_ip ) ) ) {\n+                $text .= '<p style=\"color: blue;\">' . sprintf( __( 'This IP \\'%s\\' Belongs To The Admin And Will Not Be Added To Ban List', 'wp-ban' ), $banned_ip ) . '</p>';\n             } else {\n-                $banned_ips[] = trim($banned_ip);\n+                $banned_ips[] = esc_html( trim( $banned_ip ) );\n             }\n         }\n     }\n \n     $banned_ips_range = array();\n-    if( ! empty( $banned_ips_range_post ) ) {\n+    if ( ! empty( $banned_ips_range_post ) ) {\n         foreach( $banned_ips_range_post as $banned_ip_range ) {\n             $range = explode( '-', $banned_ip_range );\n-            if( sizeof( $range ) === 2 ) {\n+            if ( sizeof( $range ) === 2 ) {\n                 $range_start = trim( $range[0] );\n                 $range_end = trim( $range[1] );\n-                if( $admin_login === 'admin' && ( check_ip_within_range( ban_get_ip(), $range_start, $range_end ) ) ) {\n-                    $text .= '<p style=\"color: blue;\">'.sprintf( __( 'The Admin\\'s IP \\'%s\\' Fall Within This Range (%s - %s) And Will Not Be Added To Ban List', 'wp-ban' ), ban_get_ip(), $range_start, $range_end ).'</p>';\n+                if ( $admin_login === 'admin' && ( check_ip_within_range( ban_get_ip(), $range_start, $range_end ) ) ) {\n+                    $text .= '<p style=\"color: blue;\">' . sprintf( __( 'The Admin\\'s IP \\'%s\\' Fall Within This Range (%s - %s) And Will Not Be Added To Ban List', 'wp-ban' ), ban_get_ip(), $range_start, $range_end ) . '</p>';\n                 } else {\n-                    $banned_ips_range[] = trim( $banned_ip_range );\n+                    $banned_ips_range[] = esc_html( trim( $banned_ip_range ) );\n                 }\n             }\n         }\n     }\n \n     $banned_hosts = array();\n-    if(!empty($banned_hosts_post)) {\n-        foreach($banned_hosts_post as $banned_host) {\n-            if($admin_login == 'admin' && ($banned_host == @gethostbyaddr(ban_get_ip()) || is_admin_hostname($banned_host))) {\n-                $text .= '<p style=\"color: blue;\">'.sprintf(__('This Hostname \\'%s\\' Belongs To The Admin And Will Not Be Added To Ban List', 'wp-ban'), $banned_host).'</p>';\n+    if ( ! empty( $banned_hosts_post ) ) {\n+        foreach ( $banned_hosts_post as $banned_host ) {\n+            if ( $admin_login === 'admin' && ( $banned_host === @gethostbyaddr( ban_get_ip() ) || is_admin_hostname( $banned_host ) ) ) {\n+                $text .= '<p style=\"color: blue;\">' . sprintf( __( 'This Hostname \\'%s\\' Belongs To The Admin And Will Not Be Added To Ban List', 'wp-ban' ), $banned_host ) . '</p>';\n             } else {\n-                $banned_hosts[] = trim($banned_host);\n+                $banned_hosts[] = esc_html( trim( $banned_host ) );\n             }\n         }\n     }\n \n     $banned_referers = array();\n-    if(!empty($banned_referers_post)) {\n-        foreach($banned_referers_post as $banned_referer) {\n-            if(is_admin_referer($banned_referer)) {\n-                $text .= '<p style=\"color: blue;\">'.sprintf(__('This Referer \\'%s\\' Belongs To This Site And Will Not Be Added To Ban List', 'wp-ban'), $banned_referer).'</p>';\n+    if ( ! empty( $banned_referers_post ) ) {\n+        foreach ( $banned_referers_post as $banned_referer ) {\n+            if ( is_admin_referer( $banned_referer ) ) {\n+                $text .= '<p style=\"color: blue;\">' . sprintf( __( 'This Referer \\'%s\\' Belongs To This Site And Will Not Be Added To Ban List', 'wp-ban' ), $banned_referer ) . '</p>';\n             } else {\n-                $banned_referers[] = trim($banned_referer);\n+                $banned_referers[] = esc_html( trim( $banned_referer ) );\n             }\n         }\n     }\n \n     $banned_user_agents = array();\n-    if(!empty($banned_user_agents_post)) {\n-        foreach($banned_user_agents_post as $banned_user_agent) {\n-            if(is_admin_user_agent($banned_user_agent)) {\n-                $text .= '<p style=\"color: blue;\">'.sprintf(__('This User Agent \\'%s\\' Is Used By The Current Admin And Will Not Be Added To Ban List', 'wp-ban'), $banned_user_agent).'</p>';\n+    if ( ! empty( $banned_user_agents_post ) ) {\n+        foreach ( $banned_user_agents_post as $banned_user_agent ) {\n+            if ( is_admin_user_agent( $banned_user_agent ) ) {\n+                $text .= '<p style=\"color: blue;\">' . sprintf( __( 'This User Agent \\'%s\\' Is Used By The Current Admin And Will Not Be Added To Ban List', 'wp-ban' ), $banned_user_agent ) . '</p>';\n             } else {\n-                $banned_user_agents[] = trim($banned_user_agent);\n+                $banned_user_agents[] = esc_html( trim( $banned_user_agent ) );\n             }\n         }\n     }\n \n     $banned_exclude_ips = array();\n-    if(!empty($banned_exclude_ips_post)) {\n-        foreach($banned_exclude_ips_post as $banned_exclude_ip) {\n-            $banned_exclude_ips[] = trim($banned_exclude_ip);\n+    if ( ! empty( $banned_exclude_ips_post ) ) {\n+        foreach ( $banned_exclude_ips_post as $banned_exclude_ip ) {\n+            $banned_exclude_ips[] = esc_html( trim( $banned_exclude_ip ) );\n         }\n     }\n     $update_ban_queries = array();\n     $update_ban_queries[] = update_option( 'banned_options', $banned_options );\n-    $update_ban_queries[] = update_option('banned_ips', $banned_ips);\n-    $update_ban_queries[] = update_option('banned_ips_range', $banned_ips_range);\n-    $update_ban_queries[] = update_option('banned_hosts', $banned_hosts);\n-    $update_ban_queries[] = update_option('banned_referers', $banned_referers);\n-    $update_ban_queries[] = update_option('banned_user_agents', $banned_user_agents);\n-    $update_ban_queries[] = update_option('banned_exclude_ips', $banned_exclude_ips);\n-    $update_ban_queries[] = update_option('banned_message', $banned_message);\n+    $update_ban_queries[] = update_option( 'banned_ips', $banned_ips );\n+    $update_ban_queries[] = update_option( 'banned_ips_range', $banned_ips_range );\n+    $update_ban_queries[] = update_option( 'banned_hosts', $banned_hosts );\n+    $update_ban_queries[] = update_option( 'banned_referers', $banned_referers );\n+    $update_ban_queries[] = update_option( 'banned_user_agents', $banned_user_agents );\n+    $update_ban_queries[] = update_option( 'banned_exclude_ips', $banned_exclude_ips );\n+    $update_ban_queries[] = update_option( 'banned_message', $banned_message );\n     $update_ban_text = array();\n     $update_ban_text[] = __( 'Banned Options', 'wp-ban' );\n-    $update_ban_text[] = __('Banned IPs', 'wp-ban');\n-    $update_ban_text[] = __('Banned IP Range', 'wp-ban');\n-    $update_ban_text[] = __('Banned Host Names', 'wp-ban');\n-    $update_ban_text[] = __('Banned Referers', 'wp-ban');\n-    $update_ban_text[] = __('Banned User Agents', 'wp-ban');\n-    $update_ban_text[] = __('Banned Excluded IPs', 'wp-ban');\n-    $update_ban_text[] = __('Banned Message', 'wp-ban');\n-    $i=0;\n-    foreach($update_ban_queries as $update_ban_query) {\n-        if($update_ban_query) {\n-            $text .= '<p style=\"color: green;\">'.$update_ban_text[$i].' '.__('Updated', 'wp-ban').'</p>';\n+    $update_ban_text[] = __( 'Banned IPs', 'wp-ban');\n+    $update_ban_text[] = __( 'Banned IP Range', 'wp-ban');\n+    $update_ban_text[] = __( 'Banned Host Names', 'wp-ban');\n+    $update_ban_text[] = __( 'Banned Referers', 'wp-ban');\n+    $update_ban_text[] = __( 'Banned User Agents', 'wp-ban');\n+    $update_ban_text[] = __( 'Banned Excluded IPs', 'wp-ban');\n+    $update_ban_text[] = __( 'Banned Message', 'wp-ban');\n+    $i = 0;\n+    foreach ( $update_ban_queries as $update_ban_query ) {\n+        if ( $update_ban_query ) {\n+            $text .= '<p style=\"color: green;\">' . $update_ban_text[$i] . ' ' . __( 'Updated', 'wp-ban' ) . '</p>';\n         }\n         $i++;\n     }\n-    if(empty($text)) {\n-        $text = '<p style=\"color: red;\">'.__('No Ban Option Updated', 'wp-ban').'</p>';\n+    if ( empty( $text ) ) {\n+        $text = '<p style=\"color: red;\">' . __( 'No Ban Option Updated', 'wp-ban' ) . '</p>';\n     }\n }\n if( ! empty( $_POST['do'] ) ) {\n@@ -202,7 +211,7 @@ function banned_default_templates(template) {\n         var default_template;\n         switch(template) {\n             case \"message\":\n-                default_template = \"<!DOCTYPE html>\\n<html>\\n<head>\\n<meta charset=\\\"utf-8\\\">\\n<title>%SITE_NAME% - %SITE_URL%</title>\\n</head>\\n<body>\\n<div id=\\\"wp-ban-container\\\">\\n<p style=\\\"text-align: center; font-weight: bold;\\\"><?php _e('You Are Banned.', 'wp-ban'); ?></p>\\n</div>\\n</body>\\n</html>\";\n+                default_template = \"<html>\\n<head>\\n<meta charset=\\\"utf-8\\\">\\n<title>%SITE_NAME% - %SITE_URL%</title>\\n</head>\\n<body>\\n<div id=\\\"wp-ban-container\\\">\\n<p style=\\\"text-align: center; font-weight: bold;\\\"><?php _e('You Are Banned.', 'wp-ban'); ?></p>\\n</div>\\n</body>\\n</html>\";\n                 break;\n         }\n         jQuery(\"#banned_template_\" + template).val(default_template);\n@@ -276,7 +285,7 @@ function toggle_checkbox() {\n             <td><strong><?php echo get_option('home'); ?></strong></td>\n         </tr>\n         <tr>\n-            <td valign=\"top\" colspan=\"2\" align=\"center\">\n+            <td valign=\"top\" colspan=\"2\" style=\"text-align: center;\">\n                 <?php _e('Please <strong>DO NOT</strong> ban yourself.', 'wp-ban'); ?>\n             </td>\n         </tr>"
        },
        {
          "filename": "wp-ban.php",
          "status": "modified",
          "additions": 33,
          "deletions": 33,
          "patch": "@@ -3,15 +3,15 @@\n Plugin Name: WP-Ban\n Plugin URI: https://lesterchan.net/portfolio/programming/php/\n Description: Ban users by IP, IP Range, host name, user agent and referer url from visiting your WordPress's blog. It will display a custom ban message when the banned IP, IP range, host name, user agent or referer url tries to visit you blog. You can also exclude certain IPs from being banned. There will be statistics recordered on how many times they attemp to visit your blog. It allows wildcard matching too.\n-Version: 1.69\n+Version: 1.69.1\n Author: Lester 'GaMerZ' Chan\n Author URI: https://lesterchan.net\n Text Domain: wp-ban\n */\n \n \n /*\n-\tCopyright 2016  Lester Chan  (email : lesterchan@gmail.com)\n+\tCopyright 2022  Lester Chan  (email : lesterchan@gmail.com)\n \n \tThis program is free software; you can redistribute it and/or modify\n \tit under the terms of the GNU General Public License as published by\n@@ -91,12 +91,12 @@ function preview_banned_message() {\n function print_banned_message() {\n \t$banned_ip = ban_get_ip();\n \t$banned_stats = get_option( 'banned_stats' );\n-\tif( isset( $banned_stats['count'] ) ) {\n+\tif ( isset( $banned_stats['count'] ) ) {\n \t\t$banned_stats['count'] += 1;\n \t} else {\n \t\t$banned_stats['count'] = 1;\n \t}\n-\tif( isset( $banned_stats['users'][$banned_ip] ) ) {\n+\tif ( isset( $banned_stats['users'][$banned_ip] ) ) {\n \t\t$banned_stats['users'][$banned_ip] += 1;\n \t} else {\n \t\t$banned_stats['users'][$banned_ip] = 1;\n@@ -121,6 +121,7 @@ function print_banned_message() {\n \t\t),\n \t\tstripslashes( get_option( 'banned_message' ) )\n \t);\n+\techo '<!DOCTYPE html>' . \"\\n\";\n \techo $banned_message;\n \texit();\n }\n@@ -156,60 +157,60 @@ function process_ban_ip_range($banned_ips_range) {\n \n \n ### Function: Banned\n-add_action('init', 'banned');\n+add_action( 'init', 'banned' );\n function banned() {\n \t$ip = ban_get_ip();\n-\tif($ip == 'unknown') {\n+\tif ( $ip === 'unknown' ) {\n \t\treturn;\n \t}\n-\t$banned_ips = get_option('banned_ips');\n-\tif(is_array($banned_ips))\n-\t\t$banned_ips = array_filter($banned_ips);\n+\t$banned_ips = get_option( 'banned_ips' );\n+\tif ( is_array( $banned_ips ) )\n+\t\t$banned_ips = array_filter( $banned_ips );\n \n-\t$banned_ips_range = get_option('banned_ips_range');\n-\tif(is_array($banned_ips_range))\n-\t\t$banned_ips_range = array_filter($banned_ips_range);\n+\t$banned_ips_range = get_option( 'banned_ips_range' );\n+\tif ( is_array( $banned_ips_range ) )\n+\t\t$banned_ips_range = array_filter( $banned_ips_range );\n \n-\t$banned_hosts = get_option('banned_hosts');\n-\tif(is_array($banned_hosts))\n-\t\t$banned_hosts = array_filter($banned_hosts);\n+\t$banned_hosts = get_option( 'banned_hosts' );\n+\tif ( is_array( $banned_hosts ) )\n+\t\t$banned_hosts = array_filter( $banned_hosts );\n \n-\t$banned_referers = get_option('banned_referers');\n-\tif(is_array($banned_referers))\n-\t\t$banned_referers = array_filter($banned_referers);\n+\t$banned_referers = get_option( 'banned_referers' );\n+\tif ( is_array( $banned_referers ) )\n+\t\t$banned_referers = array_filter( $banned_referers );\n \n-\t$banned_user_agents = get_option('banned_user_agents');\n-\tif(is_array($banned_user_agents))\n-\t\t$banned_user_agents = array_filter($banned_user_agents);\n+\t$banned_user_agents = get_option( 'banned_user_agents' );\n+\tif ( is_array( $banned_user_agents ) )\n+\t\t$banned_user_agents = array_filter( $banned_user_agents );\n \n \t$banned_exclude_ips = get_option('banned_exclude_ips');\n-\tif(is_array($banned_exclude_ips))\n-\t\t$banned_exclude_ips = array_filter($banned_exclude_ips);\n+\tif ( is_array( $banned_exclude_ips ) )\n+\t\t$banned_exclude_ips = array_filter( $banned_exclude_ips );\n \n \t$is_excluded = false;\n-\tif(!empty($banned_exclude_ips)) {\n-\t\tforeach($banned_exclude_ips as $banned_exclude_ip) {\n-\t\t\tif($ip == $banned_exclude_ip) {\n+\tif ( ! empty( $banned_exclude_ips ) ) {\n+\t\tforeach( $banned_exclude_ips as $banned_exclude_ip ) {\n+\t\t\tif ( $ip === $banned_exclude_ip ) {\n \t\t\t\t$is_excluded = true;\n \t\t\t\tbreak;\n \t\t\t}\n \t\t}\n \t}\n \n-\tif( ! $is_excluded ) {\n+\tif ( ! $is_excluded ) {\n \t\tif( ! empty( $banned_ips ) ) {\n \t\t\tprocess_ban( $banned_ips, $ip );\n \t\t}\n-\t\tif( ! empty( $banned_ips_range ) ) {\n+\t\tif ( ! empty( $banned_ips_range ) ) {\n \t\t\tprocess_ban_ip_range( $banned_ips_range );\n \t\t}\n-\t\tif( ! empty( $banned_hosts ) ) {\n+\t\tif ( ! empty( $banned_hosts ) ) {\n \t\t\tprocess_ban( $banned_hosts, @gethostbyaddr( $ip ) );\n \t\t}\n-\t\tif( ! empty( $banned_referers ) && ! empty( $_SERVER['HTTP_REFERER'] ) ) {\n+\t\tif ( ! empty( $banned_referers ) && ! empty( $_SERVER['HTTP_REFERER'] ) ) {\n \t\t\tprocess_ban( $banned_referers, $_SERVER['HTTP_REFERER'] );\n \t\t}\n-\t\tif( ! empty( $banned_user_agents ) && ! empty( $_SERVER['HTTP_USER_AGENT'] ) ) {\n+\t\tif ( ! empty( $banned_user_agents ) && ! empty( $_SERVER['HTTP_USER_AGENT'] ) ) {\n \t\t\tprocess_ban( $banned_user_agents, $_SERVER['HTTP_USER_AGENT'] );\n \t\t}\n \t}\n@@ -299,8 +300,7 @@ function ban_activate() {\n \tadd_option('banned_ips', array());\n \tadd_option('banned_hosts',array());\n \tadd_option('banned_stats', array('users' => array(), 'count' => 0));\n-\tadd_option('banned_message', '<!DOCTYPE html>'.\"\\n\".\n-\t'<html>'.\"\\n\".\n+\tadd_option('banned_message', '<html>'.\"\\n\".\n \t'<head>'.\"\\n\".\n \t'<meta charset=\"utf-8\">'.\"\\n\".\n \t'<title>%SITE_NAME% - %SITE_URL%</title>'.\"\\n\"."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28aa1e4a0fe3106d70570104de7b5148c86fcb59",
            "date": "2023-08-09T03:01:11Z",
            "author_login": "lesterchan"
          },
          {
            "sha": "f02555928abd39cce2a8a05f9873e2ead5e220af",
            "date": "2023-04-27T01:38:46Z",
            "author_login": "lesterchan"
          },
          {
            "sha": "22b925449c84faa9b7496abe4f8f5661cb5eb3bf",
            "date": "2022-12-04T11:23:41Z",
            "author_login": "lesterchan"
          },
          {
            "sha": "3922e5c7310deca55c95a0bff8e3143e2b13d2fe",
            "date": "2022-10-13T01:27:11Z",
            "author_login": "lesterchan"
          },
          {
            "sha": "f3c1ba9df56f151b3460776d39cd2935b9f59b4f",
            "date": "2022-10-13T00:20:48Z",
            "author_login": "alexclassroom"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability, which was classified as problematic, was found in WP-Ban. Affected is an unknown function of the file ban-options.php. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. The name of the patch is 22b925449c84faa9b7496abe4f8f5661cb5eb3bf. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-216480.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-21T19:15:15.083",
    "last_modified": "2024-11-21T07:35:37.970",
    "fix_date": "2022-12-04T11:23:41Z"
  },
  "references": [
    {
      "url": "https://github.com/lesterchan/wp-ban/commit/22b925449c84faa9b7496abe4f8f5661cb5eb3bf",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216480",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/lesterchan/wp-ban/commit/22b925449c84faa9b7496abe4f8f5661cb5eb3bf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216480",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.195054",
    "processing_status": "enhanced"
  }
}