{
  "cve_id": "CVE-2022-4637",
  "github_data": {
    "repository": "tkrebs/ep3-bs",
    "fix_commit": "ef49e709c8adecc3a83cdc6164a67162991d2213",
    "related_commits": [
      "ef49e709c8adecc3a83cdc6164a67162991d2213",
      "ef49e709c8adecc3a83cdc6164a67162991d2213"
    ],
    "patch_url": "https://github.com/tkrebs/ep3-bs/commit/ef49e709c8adecc3a83cdc6164a67162991d2213.patch",
    "fix_commit_details": {
      "sha": "ef49e709c8adecc3a83cdc6164a67162991d2213",
      "commit_date": "2022-10-07T00:49:47Z",
      "author": {
        "login": "tkrebs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix potential XSS vulnerability, fixes #564",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 12,
        "deletions": 12
      },
      "files": [
        {
          "filename": "module/Backend/src/Backend/View/Helper/User/UserFormat.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -28,7 +28,7 @@ public function __invoke(User $user, $search = null)\n             $user->need('uid'));\r\n \r\n         $html .= sprintf('<td>%s</td>',\r\n-            $user->need('alias'));\r\n+            $view->escapeHtml($user->need('alias')));\r\n \r\n         $html .= sprintf('<td>%s</td>',\r\n             $view->t($user->getStatus()));\r\n@@ -76,4 +76,4 @@ public function __invoke(User $user, $search = null)\n         return $html;\r\n     }\r\n \r\n-}\n\\ No newline at end of file\n+}\r"
        },
        {
          "filename": "module/Backend/view/backend/booking/edit-choice.phtml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -19,11 +19,11 @@ $this->setup(array(\n                     <span class=\"symbolic symbolic-booking\">\r\n                         <b><?= $this->timeRange($reservation->get('time_start'), $reservation->get('time_end'), '%s to %s') ?></b>\r\n \r\n-                        <?= $this->t('from') ?> <?= $reservation->getExtra('booking')->getExtra('user')->get('alias') ?>\r\n+                        <?= $this->t('from') ?> <?= $this->escapeHtml($reservation->getExtra('booking')->getExtra('user')->get('alias')) ?>\r\n                     </span>\r\n                 </a>\r\n             </p>\r\n \r\n         <?php endforeach; ?>\r\n     </div>\r\n-</div>\n\\ No newline at end of file\n+</div>\r"
        },
        {
          "filename": "module/Backend/view/backend/booking/players.phtml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -18,7 +18,7 @@ $this->setup(array(\n     printf('<p>%s <a href=\"%s\">%s</a></p>',\r\n         $this->translate('Booked by'),\r\n         $this->url('backend/user/edit', ['uid' => $this->user->need('uid')]),\r\n-        $this->user->need('alias'));\r\n+        $this->escapeHtml($this->user->need('alias')));\r\n \r\n     echo '<div class=\"separator separator-line\"></div>';\r\n \r\n@@ -63,7 +63,7 @@ $this->setup(array(\n                 $this->translate('User matched by'),\r\n                 $this->translate(ucfirst($userMatch)),\r\n                 $this->url('backend/user/edit', ['uid' => $user->need('uid')]),\r\n-                $user->need('alias'));\r\n+                $this->escapeHtml($user->need('alias')));\r\n         } else {\r\n             echo '<td></td>';\r\n         }\r"
        },
        {
          "filename": "module/Calendar/src/Calendar/View/Helper/Cell/Render/FreeForPrivileged.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -25,7 +25,7 @@ public function __invoke(array $reservations, array $cellLinkParams, Square $squ\n             $cellLabel = $booking->needExtra('user')->need('alias');\r\n             $cellGroup = ' cc-group-' . $booking->need('bid');\r\n \r\n-            return $view->calendarCellLink($cellLabel, $view->url('backend/booking/edit', [], $cellLinkParams), 'cc-free cc-free-partially' . $cellGroup);\r\n+            return $view->calendarCellLink($view->escapeHtml($cellLabel), $view->url('backend/booking/edit', [], $cellLinkParams), 'cc-free cc-free-partially' . $cellGroup);\r\n         } else {\r\n \t        $labelFree = $square->getMeta('label.free', 'Still free');\r\n \r"
        },
        {
          "filename": "module/Calendar/src/Calendar/View/Helper/Cell/Render/OccupiedForPrivileged.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -39,7 +39,7 @@ public function __invoke(array $reservations, array $cellLinkParams)\n \r\n             switch ($booking->need('status')) {\r\n                 case 'single':\r\n-                    return $view->calendarCellLink($cellLabel, $view->url('backend/booking/edit', [], $cellLinkParams), 'cc-single' . $cellGroup, null, $cellStyle);\r\n+                    return $view->calendarCellLink($view->escapeHtml($cellLabel), $view->url('backend/booking/edit', [], $cellLinkParams), 'cc-single' . $cellGroup, null, $cellStyle);\r\n                 case 'subscription':\r\n                     return $view->calendarCellLink($cellLabel, $view->url('backend/booking/edit', [], $cellLinkParams), 'cc-multiple' . $cellGroup, null, $cellStyle);\r\n             }\r"
        },
        {
          "filename": "module/Calendar/src/Calendar/View/Helper/Cell/Render/OccupiedForVisitors.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -36,13 +36,13 @@ public function __invoke(array $reservations, array $cellLinkParams, Square $squ\n                         $cellLabel = $this->view->t('Occupied');\r\n                     }\r\n \r\n-                    return $view->calendarCellLink($cellLabel, $view->url('square', [], $cellLinkParams), 'cc-single' . $cellGroup);\r\n+                    return $view->calendarCellLink($view->escapeHtml($cellLabel), $view->url('square', [], $cellLinkParams), 'cc-single' . $cellGroup);\r\n                 case 'subscription':\r\n                     if (! $cellLabel) {\r\n                         $cellLabel = $this->view->t('Subscription');\r\n                     }\r\n \r\n-                    return $view->calendarCellLink($cellLabel, $view->url('square', [], $cellLinkParams), 'cc-multiple' . $cellGroup);\r\n+                    return $view->calendarCellLink($view->escapeHtml($cellLabel), $view->url('square', [], $cellLinkParams), 'cc-multiple' . $cellGroup);\r\n             }\r\n         }\r\n     }\r"
        },
        {
          "filename": "module/Frontend/view/frontend/index/userpanel.online.phtml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n     <tr>\r\n         <td class=\"responsive-pass-4\" style=\"padding-right: 12px; border-right: solid 1px #CCC;\">\r\n             <div id=\"userpanel-status\" class=\"no-wrap\">\r\n-                <?= sprintf($this->t('Online as %s'), $this->user->need('alias')) ?>\r\n+                <?= sprintf($this->t('Online as %s'), $this->escapeHtml($this->user->need('alias'))) ?>\r\n             </div>\r\n         </td>\r\n \r\n@@ -36,4 +36,4 @@\n             <a href=\"<?= $this->url('service/help') ?>\" class=\"default-button\" data-tooltip=\"<?= sprintf($this->t('Get additional %shelp and information%s'), '<b>', '</b>') ?>\"><b>?</b></a>\r\n         </td>\r\n     </tr>\r\n-</table>\n\\ No newline at end of file\n+</table>\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d07019d5636a29108627c464d1c48d0aa2985c33",
            "date": "2022-11-08T12:10:00Z",
            "author_login": "tkrebs"
          },
          {
            "sha": "252851b0613ae886685dfe0807f5d7af66bef785",
            "date": "2022-10-07T01:02:04Z",
            "author_login": "tkrebs"
          },
          {
            "sha": "f67f3f7374d4d73692332df09ca62cb517cc85f1",
            "date": "2022-10-07T00:55:55Z",
            "author_login": "tkrebs"
          },
          {
            "sha": "ef49e709c8adecc3a83cdc6164a67162991d2213",
            "date": "2022-10-07T00:49:47Z",
            "author_login": "tkrebs"
          },
          {
            "sha": "0f19ee3b2af337b0353efeff786ee6cfbeba2ce2",
            "date": "2022-10-07T00:37:17Z",
            "author_login": "tkrebs"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic has been found in ep3-bs up to 1.7.x. This affects an unknown part. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.8.0 is able to address this issue. The name of the patch is ef49e709c8adecc3a83cdc6164a67162991d2213. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216495.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-21T22:15:08.480",
    "last_modified": "2024-11-21T07:35:38.627",
    "fix_date": "2022-10-07T00:49:47Z"
  },
  "references": [
    {
      "url": "https://github.com/tkrebs/ep3-bs/commit/ef49e709c8adecc3a83cdc6164a67162991d2213",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tkrebs/ep3-bs/issues/564",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tkrebs/ep3-bs/releases/tag/1.8.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216495",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tkrebs/ep3-bs/commit/ef49e709c8adecc3a83cdc6164a67162991d2213",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tkrebs/ep3-bs/issues/564",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tkrebs/ep3-bs/releases/tag/1.8.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216495",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.195823",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ep3-bs",
    "owner": "tkrebs",
    "created_at": "2014-05-29T13:43:09Z",
    "updated_at": "2024-12-26T07:10:49Z",
    "pushed_at": "2022-11-08T12:22:57Z",
    "size": 4481,
    "stars": 187,
    "forks": 109,
    "open_issues": 241,
    "watchers": 187,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 6901188,
      "HTML": 187210,
      "JavaScript": 81432,
      "CSS": 28879
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:51:14.688058"
  }
}