{
  "cve_id": "CVE-2022-4638",
  "github_data": {
    "repository": "collective/collective.contact.widget",
    "fix_commit": "5da36305ca7ed433782be8901c47387406fcda12",
    "related_commits": [
      "5da36305ca7ed433782be8901c47387406fcda12",
      "5da36305ca7ed433782be8901c47387406fcda12"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5da36305ca7ed433782be8901c47387406fcda12",
      "commit_date": "2022-05-31T21:16:59Z",
      "author": {
        "login": "sgeulette",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Escaped term-contact viewlet title special chars to avoid xss",
        "length": 61,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 54,
        "additions": 28,
        "deletions": 26
      },
      "files": [
        {
          "filename": "CHANGES.rst",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -4,8 +4,10 @@ Changelog\n 1.13 (unreleased)\n -----------------\n \n-- Nothing changed yet.\n-\n+- Escaped contact title special characters in `term-contact` viewlet to avoid\n+  script insertion (xss). This viewlet stores an hidden field used in a\n+  dynamically js generation.\n+  [sgeulette]\n \n 1.12 (2020-10-07)\n -----------------"
        },
        {
          "filename": "src/collective/contact/widget/widgets.py",
          "status": "modified",
          "additions": 24,
          "deletions": 24,
          "patch": "@@ -1,29 +1,38 @@\n-import json\n-\n+from cgi import escape\n+from collective.contact.widget import _\n+from collective.contact.widget.interfaces import IContactAutocompleteMultiSelectionWidget\n+from collective.contact.widget.interfaces import IContactAutocompleteSelectionWidget\n+from collective.contact.widget.interfaces import IContactAutocompleteWidget\n+from collective.contact.widget.interfaces import IContactContent\n+from collective.contact.widget.interfaces import IContactWidgetSettings\n+from five import grok\n+from plone.app.layout.viewlets.interfaces import IBelowContent\n+from plone.app.layout.viewlets.interfaces import IHtmlHeadLinks\n+from plone.formwidget.autocomplete.widget import AutocompleteMultiSelectionWidget\n+from plone.formwidget.autocomplete.widget import AutocompleteSearch as BaseAutocompleteSearch\n+from plone.formwidget.autocomplete.widget import AutocompleteSelectionWidget\n+from Products.CMFPlone.utils import base_hasattr\n+from Products.CMFPlone.utils import safe_unicode\n from z3c.form.interfaces import IFieldWidget\n-import z3c.form.interfaces\n from z3c.form.widget import FieldWidget\n+from zope.browserpage.viewpagetemplatefile import ViewPageTemplateFile\n from zope.component import getUtility\n from zope.component.interfaces import ComponentLookupError\n from zope.i18n import translate\n-from zope.interface import implementer, implements, Interface\n-from zope.browserpage.viewpagetemplatefile import ViewPageTemplateFile\n+from zope.interface import implementer\n+from zope.interface import implements\n+from zope.interface import Interface\n from zope.schema.interfaces import IContextSourceBinder\n from zope.schema.interfaces import IVocabulary\n from zope.schema.interfaces import IVocabularyFactory\n-from five import grok\n \n-from Products.CMFPlone.utils import base_hasattr, safe_unicode\n-from plone.app.layout.viewlets.interfaces import IBelowContent\n-from plone.app.layout.viewlets.interfaces import IHtmlHeadLinks\n-from plone.formwidget.autocomplete.widget import (\n-    AutocompleteMultiSelectionWidget,\n-    AutocompleteSelectionWidget)\n-from plone.formwidget.autocomplete.widget import AutocompleteSearch as BaseAutocompleteSearch\n+import json\n+import z3c.form.interfaces\n+\n \n try:\n-    from plone.formwidget.masterselect.widget import MasterSelect as BaseMasterSelect\n     from plone.formwidget.masterselect.interfaces import IMasterSelectWidget\n+    from plone.formwidget.masterselect.widget import MasterSelect as BaseMasterSelect\n     class MasterSelect(BaseMasterSelect):\n         grok.implements(IMasterSelectWidget)\n         def getSlaves(self):\n@@ -33,15 +42,6 @@ def getSlaves(self):\n     class MasterSelect(object):\n         pass\n \n-from collective.contact.widget import _\n-from collective.contact.widget.interfaces import (\n-    IContactAutocompleteWidget,\n-    IContactAutocompleteSelectionWidget,\n-    IContactAutocompleteMultiSelectionWidget,\n-    IContactContent,\n-    IContactWidgetSettings,\n-)\n-\n \n class PatchLoadInsideOverlay(grok.Viewlet):\n     grok.context(Interface)\n@@ -70,7 +70,7 @@ def title(self):\n         else:\n             title = self.context.Title()\n         title = title and safe_unicode(title) or u\"\"\n-        return title\n+        return escape(title, quote=True)\n \n     @property\n     def portal_type(self):"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "72204e65b50ce18a9de31267c82765218f204953",
            "date": "2022-06-21T06:23:59Z",
            "author_login": "sgeulette"
          },
          {
            "sha": "34b02acc20aa5c0e6961c65d8159ca977465fc5d",
            "date": "2022-06-21T06:23:46Z",
            "author_login": "sgeulette"
          },
          {
            "sha": "2bda67c39e402fa88837f2124120a7e67b8d48c0",
            "date": "2022-06-07T10:41:38Z",
            "author_login": "gbastien"
          },
          {
            "sha": "edbc259f90255bc5cdc59f84174fc852167585fb",
            "date": "2022-06-01T14:19:35Z",
            "author_login": "sgeulette"
          },
          {
            "sha": "c7ea1feef8dda50d8732a00af1d9c1f1567bde85",
            "date": "2022-06-01T09:07:49Z",
            "author_login": "sgeulette"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability classified as problematic was found in collective.contact.widget up to 1.12. This vulnerability affects the function title of the file src/collective/contact/widget/widgets.py. The manipulation leads to cross site scripting. The attack can be initiated remotely. The name of the patch is 5da36305ca7ed433782be8901c47387406fcda12. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216496.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-21T22:15:08.570",
    "last_modified": "2024-11-21T07:35:38.760",
    "fix_date": "2022-05-31T21:16:59Z"
  },
  "references": [
    {
      "url": "https://github.com/collective/collective.contact.widget/commit/5da36305ca7ed433782be8901c47387406fcda12",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216496",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/collective/collective.contact.widget/commit/5da36305ca7ed433782be8901c47387406fcda12",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216496",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.195992",
    "processing_status": "enhanced"
  }
}