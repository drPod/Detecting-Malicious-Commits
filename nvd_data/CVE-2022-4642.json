{
  "cve_id": "CVE-2022-4642",
  "github_data": {
    "repository": "Tatoeba/tatoeba2",
    "fix_commit": "91110777fc8ddf1b4a2cf4e66e67db69b9700361",
    "related_commits": [
      "91110777fc8ddf1b4a2cf4e66e67db69b9700361",
      "91110777fc8ddf1b4a2cf4e66e67db69b9700361"
    ],
    "patch_url": "https://github.com/Tatoeba/tatoeba2/commit/91110777fc8ddf1b4a2cf4e66e67db69b9700361.patch",
    "fix_commit_details": {
      "sha": "91110777fc8ddf1b4a2cf4e66e67db69b9700361",
      "commit_date": "2022-10-29T19:35:50Z",
      "author": {
        "login": "Yorwba",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Sanitize private message title",
        "length": 76,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/Template/Email/html/new_private_message.ctp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@\n echo $this->Html->tag(\"p\", \"You have received a private message from <strong>$sender</strong>.\");\n \n echo $this->Html->div(null,\n-    \"<strong>Title:</strong> $title\",\n+    \"<strong>Title:</strong> \".h($title),\n     array('style' => 'background:#666666;color:#ffffff;padding:10px;')\n );\n "
        },
        {
          "filename": "src/Template/PrivateMessages/folder.ctp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -138,7 +138,7 @@ $this->set('title_for_layout', $this->Pages->formatTitle(\n                 <md-list-item class=\"md-2-line <?= $unread ?>\" href=\"<?= $url ?>\">\n                     <?= $this->Members->image($user, array('class' => 'md-avatar')); ?>\n                     <div class=\"md-list-item-text\" layout=\"column\">\n-                        <h3><?= $this->safeForAngular($messageTitle) ?></h3>\n+                        <h3><?= h($this->safeForAngular($messageTitle)) ?></h3>\n                         <p>\n                         <?php\n                         echo $label;"
        },
        {
          "filename": "src/Template/PrivateMessages/show.ctp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -54,7 +54,7 @@ $this->set('title_for_layout', $this->Pages->formatTitle(\n         <md-toolbar class=\"md-hue-1\">\n             <div class=\"md-toolbar-tools\">\n                 <h2 flex>\n-                    <?= $this->safeForAngular($message->title) ?>\n+                    <?= h($this->safeForAngular($message->title)) ?>\n                 </h2>\n             </div>\n         </md-toolbar>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3206771918964c1c9cd4095fd03ac0baf00b6fbb",
            "date": "2024-11-14T10:08:23Z",
            "author_login": "jiru"
          },
          {
            "sha": "cd0d845ec2f9ed79dd57d00e0c42d71eabdea09a",
            "date": "2024-11-08T06:42:39Z",
            "author_login": "jiru"
          },
          {
            "sha": "641c0fd6e9d6b4dcfcdc72963ad14dfa1748d9ee",
            "date": "2024-09-24T07:53:05Z",
            "author_login": "jiru"
          },
          {
            "sha": "97a4ecc575b3b32ba01a94f1ab79504dbb82ecc4",
            "date": "2024-09-24T07:20:27Z",
            "author_login": "jiru"
          },
          {
            "sha": "0faabe67a5d962a9174a3931b0ffffb59880b459",
            "date": "2024-09-09T11:50:46Z",
            "author_login": "jiru"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-707",
    "description": "A vulnerability was found in tatoeba2. It has been classified as problematic. This affects an unknown part of the component Profile Name Handler. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. Upgrading to version prod_2022-10-30 is able to address this issue. The name of the patch is 91110777fc8ddf1b4a2cf4e66e67db69b9700361. It is recommended to upgrade the affected component. The identifier VDB-216501 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-21T22:15:08.907",
    "last_modified": "2024-11-21T07:35:39.313",
    "fix_date": "2022-10-29T19:35:50Z"
  },
  "references": [
    {
      "url": "https://github.com/Tatoeba/tatoeba2/commit/91110777fc8ddf1b4a2cf4e66e67db69b9700361",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Tatoeba/tatoeba2/issues/3002",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Tatoeba/tatoeba2/releases/tag/prod_2022-10-30",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216501",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Tatoeba/tatoeba2/commit/91110777fc8ddf1b4a2cf4e66e67db69b9700361",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Tatoeba/tatoeba2/issues/3002",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Tatoeba/tatoeba2/releases/tag/prod_2022-10-30",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216501",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.196562",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tatoeba2",
    "owner": "Tatoeba",
    "created_at": "2014-02-17T11:25:16Z",
    "updated_at": "2025-01-14T01:53:47Z",
    "pushed_at": "2024-11-28T13:26:42Z",
    "size": 193518,
    "stars": 736,
    "forks": 132,
    "open_issues": 471,
    "watchers": 736,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "PHP": 2573216,
      "HTML": 257547,
      "JavaScript": 171260,
      "CSS": 134302,
      "Shell": 11512,
      "Python": 4730,
      "Batchfile": 862
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T19:11:24.285582"
  }
}