{
  "cve_id": "CVE-2022-4725",
  "github_data": {
    "repository": "aws-amplify/aws-sdk-android",
    "fix_commit": "c3e6d69422e1f0c80fe53f2d757b8df97619af2b",
    "related_commits": [
      "c3e6d69422e1f0c80fe53f2d757b8df97619af2b",
      "c3e6d69422e1f0c80fe53f2d757b8df97619af2b"
    ],
    "patch_url": "https://github.com/aws-amplify/aws-sdk-android/commit/c3e6d69422e1f0c80fe53f2d757b8df97619af2b.patch",
    "fix_commit_details": {
      "sha": "c3e6d69422e1f0c80fe53f2d757b8df97619af2b",
      "commit_date": "2022-12-05T07:56:38Z",
      "author": {
        "login": "banji180",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(core): added fix for xml parser (#3100)",
        "length": 182,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 23,
        "deletions": 4
      },
      "files": [
        {
          "filename": "aws-android-sdk-core/src/main/java/com/amazonaws/regions/RegionMetadataParser.java",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -109,9 +109,10 @@ private static List<Region> internalParse(\n         Document document;\n         try {\n \n-            DocumentBuilderFactory factory =\n-                    DocumentBuilderFactory.newInstance();\n-\n+            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+            factory.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n+            factory.setXIncludeAware(false);\n+            factory.setExpandEntityReferences(false);\n             DocumentBuilder documentBuilder = factory.newDocumentBuilder();\n             document = documentBuilder.parse(input);\n "
        },
        {
          "filename": "aws-android-sdk-core/src/main/java/com/amazonaws/util/XpathUtils.java",
          "status": "modified",
          "additions": 19,
          "deletions": 1,
          "patch": "@@ -45,7 +45,25 @@ public class XpathUtils {\n     /** Shared logger */\n     private static Log log = LogFactory.getLog(XpathUtils.class);\n \n-    private static DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+    private static DocumentBuilderFactory factory = getDocumentBuilderFactory();\n+\n+\n+    /**\n+     * Creates new documentbuilderfactory object\n+     * @return DocumentBuilderFactory.\n+     */\n+    private static DocumentBuilderFactory getDocumentBuilderFactory() {\n+        try {\n+            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n+            dbf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n+            dbf.setXIncludeAware(false); // Default false for java 8. Disable XML Inclusions leading to SSRF - https://portswigger.net/web-security/xxe/lab-xinclude-attack\n+            dbf.setExpandEntityReferences(false);\n+            return dbf;\n+        }\n+        catch (ParserConfigurationException exception){\n+            return null;\n+        }\n+    }\n \n     /**\n      * InputStream to Document."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1aedcb18b067794c7d1dbfb606278c5146b39934",
            "date": "2025-01-14T17:47:20Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "b1475e1850a3d99129cde3eff452e91b4852e972",
            "date": "2025-01-14T17:07:05Z",
            "author_login": "tylerjroach"
          },
          {
            "sha": "f81d941931d5b1c6bc9c88bcf103f949dec80381",
            "date": "2025-01-08T18:33:19Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "19171e1d5169f2e71a7c51947b59b3486655f096",
            "date": "2025-01-08T18:03:51Z",
            "author_login": "tylerjroach"
          },
          {
            "sha": "225234b3f75a26ce50613ee2f7b46e0508000f28",
            "date": "2024-11-21T16:18:54Z",
            "author_login": "github-actions[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-918",
    "description": "A vulnerability was found in AWS SDK 2.59.0. It has been rated as critical. This issue affects the function XpathUtils of the file aws-android-sdk-core/src/main/java/com/amazonaws/util/XpathUtils.java of the component XML Parser. The manipulation leads to server-side request forgery. Upgrading to version 2.59.1 is able to address this issue. The name of the patch is c3e6d69422e1f0c80fe53f2d757b8df97619af2b. It is recommended to upgrade the affected component. The identifier VDB-216737 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-27T15:15:12.130",
    "last_modified": "2024-11-21T07:35:49.017",
    "fix_date": "2022-12-05T07:56:38Z"
  },
  "references": [
    {
      "url": "https://github.com/aws-amplify/aws-sdk-android/commit/c3e6d69422e1f0c80fe53f2d757b8df97619af2b",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aws-amplify/aws-sdk-android/pull/3100",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aws-amplify/aws-sdk-android/releases/tag/release_v2.59.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216737",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aws-amplify/aws-sdk-android/commit/c3e6d69422e1f0c80fe53f2d757b8df97619af2b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aws-amplify/aws-sdk-android/pull/3100",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aws-amplify/aws-sdk-android/releases/tag/release_v2.59.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216737",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.218710",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "aws-sdk-android",
    "owner": "aws-amplify",
    "created_at": "2014-07-09T00:44:24Z",
    "updated_at": "2025-01-14T17:47:26Z",
    "pushed_at": "2025-01-14T17:47:22Z",
    "size": 268902,
    "stars": 1035,
    "forks": 549,
    "open_issues": 101,
    "watchers": 1035,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "develop",
      "gh-pages",
      "main"
    ],
    "languages": {
      "Java": 101902917,
      "Shell": 8822,
      "HTML": 5714,
      "Scilab": 2260,
      "Ruby": 1227,
      "PLSQL": 933
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:59:43.247975"
  }
}