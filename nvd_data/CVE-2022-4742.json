{
  "cve_id": "CVE-2022-4742",
  "github_data": {
    "repository": "manuelstofer/json-pointer",
    "fix_commit": "859c9984b6c407fc2d5a0a7e47c7274daa681941",
    "related_commits": [
      "859c9984b6c407fc2d5a0a7e47c7274daa681941",
      "859c9984b6c407fc2d5a0a7e47c7274daa681941"
    ],
    "patch_url": "https://github.com/manuelstofer/json-pointer/commit/859c9984b6c407fc2d5a0a7e47c7274daa681941.patch",
    "fix_commit_details": {
      "sha": "859c9984b6c407fc2d5a0a7e47c7274daa681941",
      "commit_date": "2022-02-17T14:51:53Z",
      "author": {
        "login": "manuelstofer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #36 from hhomar/fix-prototype-pollution",
        "length": 122,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 12,
        "deletions": 0
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -75,6 +75,9 @@ api.set = function set (obj, pointer, value) {\n \n     for (var i = 0; i < refTokens.length - 1; ++i) {\n         var tok = refTokens[i];\n+        if (typeof tok !== 'string' && typeof tok !== 'number') {\n+          tok = String(tok)\n+        }\n         if (tok === \"__proto__\" || tok === \"constructor\" || tok === \"prototype\") {\n             continue\n         }"
        },
        {
          "filename": "test/test.js",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -446,6 +446,15 @@ describe('convenience api wrapper', function() {\n         expect(obj2.polluted).to.be.undefined();\n     });\n \n+    it('should not set __proto__ (array)', function () {\n+        var obj = {}, objPointer = pointer(obj);\n+        expect(obj.polluted).to.be.undefined();\n+        objPointer.set([['__proto__'], 'polluted'], true);\n+        expect(obj.polluted).to.be.undefined();\n+        var obj2 = {};\n+        expect(obj2.polluted).to.be.undefined();\n+    });\n+\n     it('should not set prototype', function () {\n         var obj = {}, objPointer = pointer(obj);\n         expect(obj.polluted).to.be.undefined();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "931b0f9c7178ca09778087b4b0ac7e4f505620c2",
            "date": "2022-02-17T14:56:11Z",
            "author_login": "manuelstofer"
          },
          {
            "sha": "859c9984b6c407fc2d5a0a7e47c7274daa681941",
            "date": "2022-02-17T14:51:53Z",
            "author_login": "manuelstofer"
          },
          {
            "sha": "47dae1d369a25bd9bdcdbc963b8699b89a882c81",
            "date": "2021-11-11T12:32:31Z",
            "author_login": "hhomar"
          },
          {
            "sha": "9b5ea8e3b20f9e3065860cf3b018b47708e8794d",
            "date": "2020-09-24T14:09:08Z",
            "author_login": "manuelstofer"
          },
          {
            "sha": "1dbd1ed6bef76f359dcf44d5b0e849d4881540b2",
            "date": "2020-09-24T14:04:14Z",
            "author_login": "manuelstofer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-1321",
    "description": "A vulnerability, which was classified as critical, has been found in json-pointer up to 0.6.1. Affected by this issue is the function set of the file index.js. The manipulation leads to improperly controlled modification of object prototype attributes ('prototype pollution'). The attack may be launched remotely. Upgrading to version 0.6.2 is able to address this issue. The patch is identified as 859c9984b6c407fc2d5a0a7e47c7274daa681941. It is recommended to upgrade the affected component. VDB-216794 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-26T08:15:09.587",
    "last_modified": "2024-11-21T07:35:51.240",
    "fix_date": "2022-02-17T14:51:53Z"
  },
  "references": [
    {
      "url": "https://github.com/manuelstofer/json-pointer/commit/859c9984b6c407fc2d5a0a7e47c7274daa681941",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/manuelstofer/json-pointer/pull/36",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216794",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216794",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/manuelstofer/json-pointer/commit/859c9984b6c407fc2d5a0a7e47c7274daa681941",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/manuelstofer/json-pointer/pull/36",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216794",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216794",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.211682",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "json-pointer",
    "owner": "manuelstofer",
    "created_at": "2013-04-07T13:45:43Z",
    "updated_at": "2024-12-05T02:58:51Z",
    "pushed_at": "2023-12-20T22:03:47Z",
    "size": 171,
    "stars": 179,
    "forks": 42,
    "open_issues": 14,
    "watchers": 179,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 21986,
      "HTML": 657,
      "Makefile": 278
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:17:12.931679"
  }
}