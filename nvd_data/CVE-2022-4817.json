{
  "cve_id": "CVE-2022-4817",
  "github_data": {
    "repository": "centic9/jgit-cookbook",
    "fix_commit": "b8cb29b43dc704708d598c60ac1881db7cf8e9c3",
    "related_commits": [
      "b8cb29b43dc704708d598c60ac1881db7cf8e9c3",
      "b8cb29b43dc704708d598c60ac1881db7cf8e9c3"
    ],
    "patch_url": "https://github.com/centic9/jgit-cookbook/commit/b8cb29b43dc704708d598c60ac1881db7cf8e9c3.patch",
    "fix_commit_details": {
      "sha": "b8cb29b43dc704708d598c60ac1881db7cf8e9c3",
      "commit_date": "2022-08-09T06:17:52Z",
      "author": {
        "login": "centic9",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #86 from BulkSecurityGeneratorProjectV2/fix/JLL/temporary_directory_hijacking_or_temporary_directory_information_disclosure",
        "length": 228,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 2,
        "deletions": 8
      },
      "files": [
        {
          "filename": "src/main/java/org/dstadler/jgit/porcelain/CleanUntrackedFiles.java",
          "status": "modified",
          "additions": 2,
          "deletions": 8,
          "patch": "@@ -18,6 +18,7 @@\n \n import java.io.File;\n import java.io.IOException;\n+import java.nio.file.Files;\n import java.util.Set;\n \n import org.apache.commons.io.FileUtils;\n@@ -27,7 +28,6 @@\n import org.eclipse.jgit.lib.Repository;\n \n \n-\n /**\n  * Simple snippet which shows how to list all Tags\n  *\n@@ -43,13 +43,7 @@ public static void main(String[] args) throws IOException, GitAPIException {\n             System.out.println(\"Repository at \" + repository.getWorkTree());\n \n             File untrackedFile = File.createTempFile(\"untracked\", \".txt\", repository.getWorkTree());\n-            File untrackedDir = File.createTempFile(\"untrackedDir\", \"\", repository.getWorkTree());\n-            if(!untrackedDir.delete()) {\n-                throw new IOException(\"Could not delete file \" + untrackedDir);\n-            }\n-            if(!untrackedDir.mkdirs()) {\n-                throw new IOException(\"Could not create directory \" + untrackedDir);\n-            }\n+            File untrackedDir = Files.createTempDirectory(repository.getWorkTree().toPath(), \"untrackedDir\").toFile();\n \n             System.out.println(\"Untracked exists: \" + untrackedFile.exists() + \" Dir: \" + untrackedDir.exists() + \"/\" + untrackedDir.isDirectory());\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "291a5802f82d4b7aad1722dcb6f15d4c46e44d49",
            "date": "2024-12-20T07:54:37Z",
            "author_login": "centic9"
          },
          {
            "sha": "18ac927543b78705b1f4482702d59e8ff4b51b4e",
            "date": "2024-12-16T16:24:42Z",
            "author_login": "centic9"
          },
          {
            "sha": "3ddc6fc3e1b7af7428c162c6e13c28d0646fe23d",
            "date": "2024-12-16T13:13:58Z",
            "author_login": "centic9"
          },
          {
            "sha": "fdf7796acdd3bedd002e4fada8c6bd436e8c3e79",
            "date": "2024-12-16T13:13:34Z",
            "author_login": "centic9"
          },
          {
            "sha": "bd9b92a43b5cb38b8363c033b0b31861374bd737",
            "date": "2024-12-15T20:58:20Z",
            "author_login": "centic9"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-377",
    "description": "A vulnerability was found in centic9 jgit-cookbook. It has been declared as problematic. This vulnerability affects unknown code. The manipulation leads to insecure temporary file. The attack can be initiated remotely. The name of the patch is b8cb29b43dc704708d598c60ac1881db7cf8e9c3. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216988.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2022-12-28T19:15:09.370",
    "last_modified": "2024-11-21T07:36:00.190",
    "fix_date": "2022-08-09T06:17:52Z"
  },
  "references": [
    {
      "url": "https://github.com/centic9/jgit-cookbook/commit/b8cb29b43dc704708d598c60ac1881db7cf8e9c3",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/centic9/jgit-cookbook/pull/86",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216988",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216988",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/centic9/jgit-cookbook/commit/b8cb29b43dc704708d598c60ac1881db7cf8e9c3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/centic9/jgit-cookbook/pull/86",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216988",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216988",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.231939",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jgit-cookbook",
    "owner": "centic9",
    "created_at": "2013-05-27T07:28:23Z",
    "updated_at": "2025-01-09T09:12:50Z",
    "pushed_at": "2024-12-20T07:54:39Z",
    "size": 1088,
    "stars": 1770,
    "forks": 506,
    "open_issues": 2,
    "watchers": 1770,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 216983
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T22:08:38.767094"
  }
}