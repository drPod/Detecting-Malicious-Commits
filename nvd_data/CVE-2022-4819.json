{
  "cve_id": "CVE-2022-4819",
  "github_data": {
    "repository": "kohler/hotcrp",
    "fix_commit": "d4ffdb0ef806453c54ddca7fdda3e5c60356285c",
    "related_commits": [
      "d4ffdb0ef806453c54ddca7fdda3e5c60356285c",
      "d4ffdb0ef806453c54ddca7fdda3e5c60356285c"
    ],
    "patch_url": "https://github.com/kohler/hotcrp/commit/d4ffdb0ef806453c54ddca7fdda3e5c60356285c.patch",
    "fix_commit_details": {
      "sha": "d4ffdb0ef806453c54ddca7fdda3e5c60356285c",
      "commit_date": "2022-12-24T02:57:00Z",
      "author": {
        "login": "kohler",
        "type": "User",
        "stats": {
          "total_commits": 16313,
          "average_weekly_commits": 16.83488132094943,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 846
        }
      },
      "commit_message": {
        "title": "Fix XSS (exploitable only by chairs) reported by Xiangyu Gao.",
        "length": 61,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
      },
      "files": [
        {
          "filename": "src/api/api_decision.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@ static function run(Contact $user, Qrequest $qreq, PaperInfo $prow) {\n             $prow->load_decision();\n         }\n         $dec = $prow->viewable_decision($user);\n-        $jr = new JsonResult([\"ok\" => true, \"value\" => $dec->id, \"result\" => htmlspecialchars($dec->name)]);\n+        $jr = new JsonResult([\"ok\" => true, \"value\" => $dec->id, \"result\" => $dec->name_as(5)]);\n         if ($user->can_set_decision($prow)) {\n             $jr->content[\"editable\"] = true;\n         }"
        },
        {
          "filename": "src/assigners/a_decision.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -109,7 +109,7 @@ static function make(AssignmentItem $item, AssignmentState $state) {\n     static function decision_html(Conf $conf, $decid) {\n         $dec = $conf->decision_set()->get($decid);\n         $class = $dec->status_class();\n-        $name_h = htmlspecialchars($dec->id === 0 ? \"No decision\" : $dec->name);\n+        $name_h = $dec->id === 0 ? \"No decision\" : $dec->name_as(5);\n         return \"<span class=\\\"pstat {$class}\\\">{$name_h}</span>\";\n     }\n     function unparse_display(AssignmentSet $aset) {"
        },
        {
          "filename": "src/decisioninfo.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -52,6 +52,12 @@ static function make_placeholder($id) {\n         return $dec;\n     }\n \n+    /** @param 0|5 $format\n+     * @return string */\n+    function name_as($format) {\n+        return $format === 5 ? htmlspecialchars($this->name) : $this->name;\n+    }\n+\n     /** @return string */\n     function status_class() {\n         return self::$class_name[$this->category] ?? \"dec-maybe\";"
        },
        {
          "filename": "src/help/h_keywords.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -198,7 +198,7 @@ static function print(HelpRenderer $hth) {\n                 if (strpos($qdname, \" \") !== false) {\n                     $qdname = \"\\\"{$qdname}\\\"\";\n                 }\n-                echo $hth->search_trow(\"dec:{$qdname}\", \"decision is \u201c\" . htmlspecialchars($dec->name) . \"\u201d (partial matches OK)\");\n+                echo $hth->search_trow(\"dec:{$qdname}\", \"decision is \u201c\" . $dec->name_as(5) . \"\u201d (partial matches OK)\");\n                 break;\n             }\n         }"
        },
        {
          "filename": "src/listactions/la_decide.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@ function allow(Contact $user, Qrequest $qreq) {\n     static function render(PaperList $pl, Qrequest $qreq) {\n         $opts = [];\n         foreach ($pl->conf->decision_set() as $dec) {\n-            $opts[$dec->id] = $dec->name;\n+            $opts[$dec->id] = $dec->name_as(5);\n         }\n         return [\"Set to &nbsp;\"\n                 . Ht::select(\"decision\", $opts, \"\", [\"class\" => \"want-focus js-submit-action-info-decide\"])"
        },
        {
          "filename": "src/mailrecipients.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -147,7 +147,7 @@ function set_recipients($type) {\n             foreach ($this->conf->decision_set() as $dec) {\n                 if ($dec->id !== 0) {\n                     $hide = ($this->_dcounts[$dec->id] ?? 0) === 0;\n-                    $this->defsel(\"dec:{$dec->name}\", \"Contact authors of \" . htmlspecialchars($dec->name) . \" papers\", $hide ? self::F_HIDE : 0);\n+                    $this->defsel(\"dec:{$dec->name}\", \"Contact authors of \" . $dec->name_as(5) . \" papers\", $hide ? self::F_HIDE : 0);\n                 }\n             }\n             $this->defsel(\"dec:yes\", \"Contact authors of accept-class papers\", $this->_has_dt[2] ? 0 : self::F_HIDE);"
        },
        {
          "filename": "src/papertable.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1547,13 +1547,13 @@ function papstripOutcomeSelector() {\n         }\n         $opts = [];\n         foreach ($this->conf->decision_set() as $dec) {\n-            $opts[$dec->id] = $dec->name;\n+            $opts[$dec->id] = $dec->name_as(5);\n         }\n         echo Ht::select(\"decision\", $opts,\n                         (string) $this->prow->outcome,\n                         [\"class\" => \"w-99 want-focus\", \"id\" => $id]),\n             '</form><p class=\"fn odname js-psedit-result\">',\n-            htmlspecialchars($this->prow->decision()->name),\n+            $this->prow->decision()->name_as(5),\n             \"</p></div>\\n\";\n     }\n "
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "21d9d5126dd111e774e6fef081223c07e92207b9",
            "date": "2025-01-13T15:52:51Z",
            "author_login": "kohler"
          },
          {
            "sha": "0588724e8ff498e5df04ff5fd3fc9e6ca3650bf0",
            "date": "2025-01-13T14:46:01Z",
            "author_login": "kohler"
          },
          {
            "sha": "4117d9a72c492c19a5d5492cf62e8d005feb331e",
            "date": "2025-01-11T18:59:36Z",
            "author_login": "kohler"
          },
          {
            "sha": "086b7d6c1902b9737aaf5d665be511ae2ec770cd",
            "date": "2025-01-11T18:54:05Z",
            "author_login": "kohler"
          },
          {
            "sha": "ad08581d8500ec7bdd0fab56107042adc543d764",
            "date": "2025-01-10T20:47:08Z",
            "author_login": "kohler"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in HotCRP. It has been rated as problematic. Affected by this issue is some unknown functionality. The manipulation leads to cross site scripting. The attack may be launched remotely. The name of the patch is d4ffdb0ef806453c54ddca7fdda3e5c60356285c. It is recommended to apply a patch to fix this issue. VDB-216998 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-28T21:15:10.603",
    "last_modified": "2024-11-21T07:36:00.457",
    "fix_date": "2022-12-24T02:57:00Z"
  },
  "references": [
    {
      "url": "https://github.com/kohler/hotcrp/commit/d4ffdb0ef806453c54ddca7fdda3e5c60356285c",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216998",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216998",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kohler/hotcrp/commit/d4ffdb0ef806453c54ddca7fdda3e5c60356285c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216998",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216998",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.232417",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "hotcrp",
    "owner": "kohler",
    "created_at": "2012-12-29T15:58:51Z",
    "updated_at": "2025-01-13T15:52:58Z",
    "pushed_at": "2025-01-13T15:52:54Z",
    "size": 59870,
    "stars": 342,
    "forks": 117,
    "open_issues": 76,
    "watchers": 342,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 6419670,
      "JavaScript": 694814,
      "CSS": 112120,
      "Perl": 61512,
      "Shell": 47680,
      "C++": 12182,
      "C": 656,
      "Vim Script": 282
    },
    "commit_activity": {
      "total_commits_last_year": 671,
      "avg_commits_per_week": 12.903846153846153,
      "days_active_last_year": 182
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:02:45.890789"
  }
}