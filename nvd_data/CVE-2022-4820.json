{
  "cve_id": "CVE-2022-4820",
  "github_data": {
    "repository": "flatpressblog/flatpress",
    "fix_commit": "229752b51025e678370298284d42f8ebb231f67f",
    "related_commits": [
      "229752b51025e678370298284d42f8ebb231f67f",
      "229752b51025e678370298284d42f8ebb231f67f"
    ],
    "patch_url": "https://github.com/flatpressblog/flatpress/commit/229752b51025e678370298284d42f8ebb231f67f.patch",
    "fix_commit_details": {
      "sha": "229752b51025e678370298284d42f8ebb231f67f",
      "commit_date": "2022-12-25T19:32:55Z",
      "author": {
        "login": "azett",
        "type": "User",
        "stats": {
          "total_commits": 433,
          "average_weekly_commits": 0.48164627363737483,
          "total_additions": 409744,
          "total_deletions": 313519,
          "weeks_active": 96
        }
      },
      "commit_message": {
        "title": "fixes #180, possible XSS in entry list",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "admin/panels/entry/admin.entry.list.php",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -39,15 +39,17 @@ function main() {\n \t\t// parameters for the list\n \t\t// start offset and count (now defaults to 8...)\n \n+\t\t$this->smarty->assign('formtarget', strip_tags($_SERVER ['PHP_SELF']));\n \t\t$this->smarty->assign('categories_all', entry_categories_get('defs'));\n \t\t$this->smarty->assign('saved_flags', entry_flags_get());\n \n \t\t$defcount = 8; // <-- no magic numbers! todo: add config option?\n \n \t\tglobal $fpdb;\n \n-\t\tif (!empty($_REQUEST ['entry']))\n+\t\tif (!empty($_REQUEST ['entry'])) {\n \t\t\tutils_redirect('admin.php?p=entry&action=write&entry=' . $_REQUEST ['entry']);\n+\t\t}\n \n \t\tisset($_REQUEST ['m']) ? $params ['m'] = $_REQUEST ['m'] : null;\n \t\tisset($_REQUEST ['y']) ? $params ['y'] = $_REQUEST ['y'] : null;"
        },
        {
          "filename": "admin/panels/entry/admin.entry.list.tpl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -25,7 +25,7 @@\n \n <p>{$panelstrings.descr}</p>\n \n-<form method=\"get\" action=\"{$smarty.server.PHP_SELF}?p=entry\">\n+<form method=\"get\" action=\"{$formtarget}?p=entry\">\n <p> <input type=\"hidden\" name=\"p\" value=\"entry\" /> </p>\n <fieldset><legend>{$panelstrings.filter}</legend>\n \t<select name=\"category\" class=\"alignleft\">"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f200970261993130d581f447cfcb3aa20fa11e64",
            "date": "2025-01-13T17:34:18Z",
            "author_login": "azett"
          },
          {
            "sha": "73b4cd5bb38d78b5db79ea65702725d3b51ac3bb",
            "date": "2025-01-13T01:06:44Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "447cf24a4d06d4b34679c7af6046c7f06e67b168",
            "date": "2025-01-13T00:21:04Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "e16c81caef23f89818633d0404db6241eb76537a",
            "date": "2025-01-13T00:19:55Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "6193e7df40faf9e6d9b711985789de304a021e93",
            "date": "2025-01-12T14:34:52Z",
            "author_login": "azett"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability classified as problematic has been found in FlatPress. This affects an unknown part of the file admin/panels/entry/admin.entry.list.php of the component Admin Area. The manipulation leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 229752b51025e678370298284d42f8ebb231f67f. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216999.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2022-12-28T21:15:10.703",
    "last_modified": "2024-11-21T07:36:00.600",
    "fix_date": "2022-12-25T19:32:55Z"
  },
  "references": [
    {
      "url": "https://github.com/flatpressblog/flatpress/commit/229752b51025e678370298284d42f8ebb231f67f",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flatpressblog/flatpress/issues/180",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216999",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216999",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flatpressblog/flatpress/commit/229752b51025e678370298284d42f8ebb231f67f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flatpressblog/flatpress/issues/180",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.216999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.216999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.232566",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "flatpress",
    "owner": "flatpressblog",
    "created_at": "2013-09-16T07:49:11Z",
    "updated_at": "2025-01-13T17:34:22Z",
    "pushed_at": "2025-01-13T17:34:18Z",
    "size": 10704,
    "stars": 188,
    "forks": 57,
    "open_issues": 29,
    "watchers": 188,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3133798,
      "JavaScript": 142691,
      "Smarty": 118053,
      "CSS": 99012,
      "Yacc": 40745,
      "HTML": 32532,
      "Shell": 964
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:55:36.605095"
  }
}