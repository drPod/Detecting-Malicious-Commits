{
  "cve_id": "CVE-2022-48623",
  "github_data": {
    "repository": "rurban/Cpanel-JSON-XS",
    "fix_commit": "41f32396eee9395a40f9ed80145c37622560de9b",
    "related_commits": [
      "41f32396eee9395a40f9ed80145c37622560de9b",
      "41f32396eee9395a40f9ed80145c37622560de9b"
    ],
    "patch_url": "https://github.com/rurban/Cpanel-JSON-XS/commit/41f32396eee9395a40f9ed80145c37622560de9b.patch",
    "fix_commit_details": {
      "sha": "41f32396eee9395a40f9ed80145c37622560de9b",
      "commit_date": "2023-02-21T08:01:13Z",
      "author": {
        "login": "rurban",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix decode out-of-bounds",
        "length": 91,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 21,
        "deletions": 6
      },
      "files": [
        {
          "filename": "XS.xs",
          "status": "modified",
          "additions": 21,
          "deletions": 6,
          "patch": "@@ -2724,6 +2724,8 @@ decode_comment (dec_t *dec)\n INLINE void\n decode_ws (dec_t *dec)\n {\n+  if (dec->cur >= dec->end)\n+    return;\n   for (;;)\n     {\n       char ch = *dec->cur;\n@@ -2750,7 +2752,7 @@ decode_ws (dec_t *dec)\n \n #define ERR(reason) SB dec->err = reason; goto fail; SE\n \n-#define EXPECT_CH(ch) SB \\\n+#define EXPECT_CH(ch) SB        \\\n   if (*dec->cur != ch)\t\t\\\n     ERR (# ch \" expected\");\t\\\n   ++dec->cur;\t\t\t\\\n@@ -3923,7 +3925,8 @@ decode_hv (pTHX_ dec_t *dec, SV *typesv)\n                       }\n                     } // else overwrite it below\n                   }\n-                  decode_ws (dec); EXPECT_CH (':');\n+                  decode_ws (dec);\n+                  EXPECT_CH (':');\n                   decode_ws (dec);\n \n                   if (typesv)\n@@ -3995,7 +3998,10 @@ decode_hv (pTHX_ dec_t *dec, SV *typesv)\n                   }\n \n                   dec->cur = p + 1;\n-                  decode_ws (dec); if (*p != ':') EXPECT_CH (':');\n+                  if (dec->cur >= dec->end)\n+                    EXPECT_CH (':');\n+                  decode_ws (dec);\n+                  if (*p != ':') EXPECT_CH (':');\n                   decode_ws (dec);\n \n                   if (typesv)\n@@ -4026,6 +4032,10 @@ decode_hv (pTHX_ dec_t *dec, SV *typesv)\n                   break;\n                 }\n               ++p;\n+              if (p > dec->end) {\n+                dec->cur = p;\n+                EXPECT_CH (':');\n+              }\n             }\n         }\n \n@@ -4485,11 +4495,16 @@ decode_json (pTHX_ SV *string, JSON *json, STRLEN *offset_return, SV *typesv)\n   if (!sv)\n     {\n       SV *uni = sv_newmortal ();\n-\n+      COP cop = *PL_curcop;\n+      if (dec.cur >= dec.end) // overshoot\n+        {\n+          croak (\"%s, at character offset %d\",\n+                 dec.err,\n+                 (int)ptr_to_index (aTHX_ string, dec.cur - SvPVX(string)));\n+        }\n #if PERL_VERSION >= 8\n       /* horrible hack to silence warning inside pv_uni_display */\n       /* TODO: Can be omitted with newer perls */\n-      COP cop = *PL_curcop;\n       cop.cop_warnings = pWARN_NONE;\n       ENTER;\n       SAVEVPTR (PL_curcop);\n@@ -4500,7 +4515,7 @@ decode_json (pTHX_ SV *string, JSON *json, STRLEN *offset_return, SV *typesv)\n       croak (\"%s, at character offset %d (before \\\"%s\\\")\",\n              dec.err,\n              (int)ptr_to_index (aTHX_ string, dec.cur - SvPVX(string)),\n-             dec.cur != dec.end ? SvPV_nolen (uni) : \"(end of string)\");\n+             dec.cur < dec.end ? SvPV_nolen (uni) : \"(end of string)\");\n     }\n \n   if (!(dec.json.flags & F_ALLOW_NONREF) && json_nonref(aTHX_ sv)) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3868bab0a7e493f8e397ed10ab79fcb4c83cc2b9",
            "date": "2024-12-12T21:03:38Z",
            "author_login": "rurban"
          },
          {
            "sha": "6631d65123562a67701fc6254192fb0542b4deb8",
            "date": "2024-12-12T20:53:07Z",
            "author_login": "rurban"
          },
          {
            "sha": "3c397972e0902c470bbd9c30a9af0b9eaf11a7a2",
            "date": "2024-09-29T09:28:33Z",
            "author_login": "sisyphus"
          },
          {
            "sha": "97603917f07732add2faf22d743c81dc0a40f53a",
            "date": "2024-09-24T05:48:21Z",
            "author_login": "G4Vi"
          },
          {
            "sha": "146af141ad89853ae2f80cbb6ae11b5493ebb8ff",
            "date": "2024-09-23T04:43:36Z",
            "author_login": "G4Vi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H",
    "cwe_id": "CWE-125",
    "description": "The Cpanel::JSON::XS package before 4.33 for Perl performs out-of-bounds accesses in a way that allows attackers to obtain sensitive information or cause a denial of service.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-13T05:15:08.530",
    "last_modified": "2024-11-21T07:33:37.723",
    "fix_date": "2023-02-21T08:01:13Z"
  },
  "references": [
    {
      "url": "https://github.com/briandfoy/cpan-security-advisory/blob/9374f98bef51e1ae887f293234050551c079776f/cpansa/CPANSA-Cpanel-JSON-XS.yml#L25-L36",
      "source": "cve@mitre.org",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/rurban/Cpanel-JSON-XS/commit/41f32396eee9395a40f9ed80145c37622560de9b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rurban/Cpanel-JSON-XS/issues/208",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://metacpan.org/release/RURBAN/Cpanel-JSON-XS-4.33/changes",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/briandfoy/cpan-security-advisory/blob/9374f98bef51e1ae887f293234050551c079776f/cpansa/CPANSA-Cpanel-JSON-XS.yml#L25-L36",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/rurban/Cpanel-JSON-XS/commit/41f32396eee9395a40f9ed80145c37622560de9b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rurban/Cpanel-JSON-XS/issues/208",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://metacpan.org/release/RURBAN/Cpanel-JSON-XS-4.33/changes",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.116335",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Cpanel-JSON-XS",
    "owner": "rurban",
    "created_at": "2012-06-27T21:55:25Z",
    "updated_at": "2024-12-12T21:17:35Z",
    "pushed_at": "2024-12-12T21:17:36Z",
    "size": 2487,
    "stars": 39,
    "forks": 46,
    "open_issues": 18,
    "watchers": 39,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Perl": 258153,
      "C": 200203,
      "XS": 177186,
      "Raku": 3614,
      "Batchfile": 1374
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:53:06.209199"
  }
}