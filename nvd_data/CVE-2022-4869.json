{
  "cve_id": "CVE-2022-4869",
  "github_data": {
    "repository": "evolution-events/Artaxerxes",
    "fix_commit": "022111407d34815c16c6eada2de69ca34084dc0d",
    "related_commits": [
      "022111407d34815c16c6eada2de69ca34084dc0d",
      "022111407d34815c16c6eada2de69ca34084dc0d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "022111407d34815c16c6eada2de69ca34084dc0d",
      "commit_date": "2022-08-12T12:53:54Z",
      "author": {
        "login": "matthijskooijman",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "HideSensitiveMiddleware: Hide passwords on middleware errors",
        "length": 654,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 24,
        "additions": 24,
        "deletions": 0
      },
      "files": [
        {
          "filename": "arta/common/middleware.py",
          "status": "added",
          "additions": 20,
          "deletions": 0,
          "patch": "@@ -0,0 +1,20 @@\n+from django.utils.deprecation import MiddlewareMixin\n+\n+\n+class HideSensitiveMiddleware(MiddlewareMixin):\n+    \"\"\"\n+    Hide sensitive post variables.\n+\n+    Django has a mechanism to hide these on a per-view basis, but this makes sure that the variables listed here are\n+    hidden even on errors in middleware (i.e. before the view is ran).\n+\n+    In part, this is a workaround around https://code.djangoproject.com/ticket/33090, but even with that fixed, this\n+    middleware adds a bit extra security for exceptions that are triggered before the view is even known.\n+\n+    Note that this value is overwritten once a view that has its own sensitive_post_variables specified is ran, but\n+    that should be ok, the view should then know better.\n+    \"\"\"\n+\n+    def __call__(self, request):\n+        request.sensitive_post_parameters = ['password']\n+        return super().__call__(request)"
        },
        {
          "filename": "arta/settings/production.py",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -98,3 +98,7 @@\n # TODO: A day is probably too long already, in Django (the upcoming) 3.1 this can be\n # specified in seconds instead.\n PASSWORD_RESET_TIMEOUT_DAYS = 1\n+\n+# Add extra protection for passwords, partially to work around https://code.djangoproject.com/ticket/33090 but also to\n+# add even a bit more protection. Must be first to maximise coverage.\n+MIDDLEWARE.append(0, 'arta.common.middleware.HideSensitiveMiddleware')"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "93655b0bbc24c1776a1461a7e8edf39db91f882a",
            "date": "2024-02-13T11:14:45Z",
            "author_login": "matthijskooijman"
          },
          {
            "sha": "da8d3c0214df554b1adf2c6a429ff75b2f2e1fbe",
            "date": "2023-08-24T10:16:28Z",
            "author_login": "matthijskooijman"
          },
          {
            "sha": "231f8994c372cd0320436e878557a6257d93c9fa",
            "date": "2023-08-24T08:23:49Z",
            "author_login": "matthijskooijman"
          },
          {
            "sha": "7f4b3d688b416c0e2a44d517ba2806e079ed7c7e",
            "date": "2023-08-24T08:16:27Z",
            "author_login": "matthijskooijman"
          },
          {
            "sha": "aefecc9d4f52c874e10e9b6e5d3b14ca9ef19adc",
            "date": "2023-08-24T08:14:25Z",
            "author_login": "matthijskooijman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "A vulnerability was found in Evolution Events Artaxerxes. It has been declared as problematic. This vulnerability affects unknown code of the file arta/common/middleware.py of the component POST Parameter Handler. The manipulation of the argument password leads to information disclosure. The attack can be initiated remotely. The patch is identified as 022111407d34815c16c6eada2de69ca34084dc0d. It is recommended to apply a patch to fix this issue. VDB-217438 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-05T09:15:08.753",
    "last_modified": "2024-11-21T07:36:06.390",
    "fix_date": "2022-08-12T12:53:54Z"
  },
  "references": [
    {
      "url": "https://github.com/evolution-events/Artaxerxes/commit/022111407d34815c16c6eada2de69ca34084dc0d",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217438",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217438",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/evolution-events/Artaxerxes/commit/022111407d34815c16c6eada2de69ca34084dc0d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217438",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217438",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.511064",
    "processing_status": "enhanced"
  }
}