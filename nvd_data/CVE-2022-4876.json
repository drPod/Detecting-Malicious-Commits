{
  "cve_id": "CVE-2022-4876",
  "github_data": {
    "repository": "kaltura/mwEmbed",
    "fix_commit": "13b8812ebc8c9fa034eed91ab35ba8423a528c0b",
    "related_commits": [
      "13b8812ebc8c9fa034eed91ab35ba8423a528c0b",
      "13b8812ebc8c9fa034eed91ab35ba8423a528c0b"
    ],
    "patch_url": "https://github.com/kaltura/mwEmbed/commit/13b8812ebc8c9fa034eed91ab35ba8423a528c0b.patch",
    "fix_commit_details": {
      "sha": "13b8812ebc8c9fa034eed91ab35ba8423a528c0b",
      "commit_date": "2022-05-29T12:52:44Z",
      "author": {
        "login": "yairans",
        "type": "User",
        "stats": {
          "total_commits": 442,
          "average_weekly_commits": 0.577023498694517,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 122
        }
      },
      "commit_message": {
        "title": "fix(FEC-12267): Fix XSS Vulnerability in mwEmbed - enforce valid domain format (#4266)",
        "length": 288,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "includes/DefaultSettings.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -10,8 +10,12 @@\n {\n     // support multiple hosts (comma separated) in HTTP_X_FORWARDED_HOST\n     $xForwardedHosts = explode(',', $_SERVER['HTTP_X_FORWARDED_HOST']);\n-    $_SERVER[\"HTTP_HOST\"] = $xForwardedHosts[0];\n-    $_SERVER[\"SERVER_NAME\"] = $xForwardedHosts[0];\n+    $VALID_HOSTNAME_PATTERN = \"/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\\\-]*[a-zA-Z0-9])\\\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\\\-]*[A-Za-z0-9])$/\";\n+    if (preg_match($VALID_HOSTNAME_PATTERN, $xForwardedHosts[0]) === 1)\n+    {\n+        $_SERVER[\"HTTP_HOST\"] = $xForwardedHosts[0];\n+        $_SERVER[\"SERVER_NAME\"] = $xForwardedHosts[0];\n+    }\n }\n \n // The default cache directory"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "edfa709f5d8ace7310115a7ddea40c892f29ef91",
            "date": "2023-01-03T15:52:39Z",
            "author_login": "giladna"
          },
          {
            "sha": "eb156aad9823d7f4626123381b1bf9c68054ed04",
            "date": "2023-01-03T15:43:37Z",
            "author_login": "giladna"
          },
          {
            "sha": "f6fd8e159bcecd9d29f3e73b578d39a967acadff",
            "date": "2022-10-02T10:53:59Z",
            "author_login": "lianbenjamin"
          },
          {
            "sha": "21ef6e3b087dc14557465519f8cb65a2a88faeb3",
            "date": "2022-09-20T07:34:51Z",
            "author_login": "lianbenjamin"
          },
          {
            "sha": "2796fe91a6d1cc9cbb95fc5fe6e3e3661e5db772",
            "date": "2022-09-20T07:22:53Z",
            "author_login": "Tzipi-kaltura"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in Kaltura mwEmbed up to 2.96.rc1 and classified as problematic. This issue affects some unknown processing of the file includes/DefaultSettings.php. The manipulation of the argument HTTP_X_FORWARDED_HOST leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 2.96.rc2 is able to address this issue. The patch is named 13b8812ebc8c9fa034eed91ab35ba8423a528c0b. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-217427.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-04T23:15:20.037",
    "last_modified": "2024-11-21T07:36:07.227",
    "fix_date": "2022-05-29T12:52:44Z"
  },
  "references": [
    {
      "url": "https://github.com/kaltura/mwEmbed/commit/13b8812ebc8c9fa034eed91ab35ba8423a528c0b",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/pull/4266",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/releases/tag/v2.96.rc2",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217427",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217427",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/commit/13b8812ebc8c9fa034eed91ab35ba8423a528c0b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/pull/4266",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/releases/tag/v2.96.rc2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217427",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217427",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:23.254154",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mwEmbed",
    "owner": "kaltura",
    "created_at": "2012-02-08T15:44:27Z",
    "updated_at": "2025-01-14T13:22:47Z",
    "pushed_at": "2024-06-18T13:50:14Z",
    "size": 159971,
    "stars": 209,
    "forks": 135,
    "open_issues": 103,
    "watchers": 209,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 5118267,
      "PHP": 1599651,
      "HTML": 1217322,
      "CSS": 468121,
      "Shell": 2686
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T21:52:09.407361"
  }
}