{
  "cve_id": "CVE-2022-4880",
  "github_data": {
    "repository": "stakira/OpenUtau",
    "fix_commit": "849a0a6912aac8b1c28cc32aa1132a3140caff4a",
    "related_commits": [
      "849a0a6912aac8b1c28cc32aa1132a3140caff4a",
      "849a0a6912aac8b1c28cc32aa1132a3140caff4a"
    ],
    "patch_url": "https://github.com/stakira/OpenUtau/commit/849a0a6912aac8b1c28cc32aa1132a3140caff4a.patch",
    "fix_commit_details": {
      "sha": "849a0a6912aac8b1c28cc32aa1132a3140caff4a",
      "commit_date": "2022-11-14T04:02:20Z",
      "author": {
        "login": "stakira",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #544 from oxygen-dioxide/zipslip",
        "length": 96,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 14,
        "deletions": 11
      },
      "files": [
        {
          "filename": "OpenUtau.Core/Classic/VoicebankInstaller.cs",
          "status": "modified",
          "additions": 14,
          "deletions": 11,
          "patch": "@@ -43,18 +43,21 @@ public void LoadArchive(string path) {\n                 int count = 0;\n                 bool hasCharacterYaml = archive.Entries.Any(e => e.Key.EndsWith(kCharacterYaml));\n                 foreach (var entry in archive.Entries) {\n-                    var filePath = Path.Combine(basePath, entry.Key);\n-                    Directory.CreateDirectory(Path.GetDirectoryName(filePath));\n-                    if (!entry.IsDirectory && entry.Key != kInstallTxt) {\n-                        entry.WriteToFile(Path.Combine(basePath, entry.Key), extractionOptions);\n-                        if (!hasCharacterYaml && filePath.EndsWith(kCharacterTxt)) {\n-                            var config = new VoicebankConfig() {\n-                                TextFileEncoding = textEncoding.WebName,\n-                            };\n-                            using (var stream = File.Open(filePath.Replace(\".txt\", \".yaml\"), FileMode.Create)) {\n-                                config.Save(stream);\n+                    if (!(entry.Key.Contains(\"..\")))//detect zipSlip attack\n+                    {\n+                        var filePath = Path.Combine(basePath, entry.Key);\n+                        Directory.CreateDirectory(Path.GetDirectoryName(filePath));\n+                        if (!entry.IsDirectory && entry.Key != kInstallTxt) {\n+                            entry.WriteToFile(Path.Combine(basePath, entry.Key), extractionOptions);\n+                            if (!hasCharacterYaml && filePath.EndsWith(kCharacterTxt)) {\n+                                var config = new VoicebankConfig() {\n+                                    TextFileEncoding = textEncoding.WebName,\n+                                };\n+                                using (var stream = File.Open(filePath.Replace(\".txt\", \".yaml\"), FileMode.Create)) {\n+                                    config.Save(stream);\n+                                }\n                             }\n-                        }\n+                        } \n                     }\n                     progress.Invoke(100.0 * ++count / total, entry.Key);\n                 }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0f7f78a7c8b3c201ead10f4171f34115a69d9b56",
            "date": "2024-12-20T09:05:59Z",
            "author_login": "stakira"
          },
          {
            "sha": "7c77ccda906dbf096f53bd4b7b877bed2a04c1bc",
            "date": "2024-12-20T09:01:12Z",
            "author_login": "stakira"
          },
          {
            "sha": "07ddbb6bbfa1607427442c17c90c320766556f8f",
            "date": "2024-12-20T07:23:41Z",
            "author_login": "stakira"
          },
          {
            "sha": "0034e8da4205a1295d93d0199dac524b8cd6bb80",
            "date": "2024-12-20T07:20:09Z",
            "author_login": "stakira"
          },
          {
            "sha": "cb721cb97da42e66baf0b493de8645957952156a",
            "date": "2024-12-20T07:14:26Z",
            "author_login": "stakira"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-22",
    "description": "A vulnerability was found in stakira OpenUtau. It has been classified as critical. This affects the function VoicebankInstaller of the file OpenUtau.Core/Classic/VoicebankInstaller.cs of the component ZIP Archive Handler. The manipulation leads to path traversal. Upgrading to version 0.0.991 is able to address this issue. The identifier of the patch is 849a0a6912aac8b1c28cc32aa1132a3140caff4a. It is recommended to upgrade the affected component. The identifier VDB-217617 was assigned to this vulnerability.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-07T13:15:09.700",
    "last_modified": "2024-11-21T07:36:07.800",
    "fix_date": "2022-11-14T04:02:20Z"
  },
  "references": [
    {
      "url": "https://github.com/stakira/OpenUtau/commit/849a0a6912aac8b1c28cc32aa1132a3140caff4a",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/stakira/OpenUtau/pull/544",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/stakira/OpenUtau/releases/tag/build%2F0.0.991",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217617",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217617",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/stakira/OpenUtau/commit/849a0a6912aac8b1c28cc32aa1132a3140caff4a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/stakira/OpenUtau/pull/544",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/stakira/OpenUtau/releases/tag/build%2F0.0.991",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217617",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217617",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.526393",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "OpenUtau",
    "owner": "stakira",
    "created_at": "2014-11-27T06:55:34Z",
    "updated_at": "2025-01-14T12:45:19Z",
    "pushed_at": "2024-12-20T09:05:59Z",
    "size": 80455,
    "stars": 2234,
    "forks": 308,
    "open_issues": 51,
    "watchers": 2234,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C#": 5184330,
      "C++": 92892,
      "Python": 26608,
      "Starlark": 11378,
      "C": 5257,
      "NSIS": 4032,
      "Shell": 1069,
      "Batchfile": 386
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:49:17.965511"
  }
}