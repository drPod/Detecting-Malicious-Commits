{
  "cve_id": "CVE-2022-4881",
  "github_data": {
    "repository": "CapsAdmin/pac3",
    "fix_commit": "8fc9e12dfa21d757be6eb4194c763e848b299ac0",
    "related_commits": [
      "8fc9e12dfa21d757be6eb4194c763e848b299ac0",
      "8fc9e12dfa21d757be6eb4194c763e848b299ac0"
    ],
    "patch_url": "https://github.com/CapsAdmin/pac3/commit/8fc9e12dfa21d757be6eb4194c763e848b299ac0.patch",
    "fix_commit_details": {
      "sha": "8fc9e12dfa21d757be6eb4194c763e848b299ac0",
      "commit_date": "2022-07-13T04:54:10Z",
      "author": {
        "login": "brandonsturgeon",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix an HTML injection exploit (#1210)",
        "length": 88,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "lua/pac3/core/shared/http.lua",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -63,6 +63,7 @@ end\n \n function pac.FixUrl(url)\n \turl = url:Trim()\n+\turl = url:gsub(\"[\\\"'<>\\n\\\\]+\", \"\")\n \n \tif url:find(\"dropbox\", 1, true) then\n \t\turl = url:gsub([[^http%://dl%.dropboxusercontent%.com/]], [[https://dl.dropboxusercontent.com/]])"
        },
        {
          "filename": "lua/pac3/libraries/urltex.lua",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -114,7 +114,7 @@ function urltex.StartDownload(url, data)\n \tend\n \n \turl = pac.FixUrl(url)\n-\tlocal size = data.size or urltex.TextureSize\n+\tlocal size = tonumber(data.size or urltex.TextureSize)\n \tlocal id = \"urltex_download_\" .. url\n \tlocal pnl\n \tlocal frames_passed = 0\n@@ -267,4 +267,4 @@ function urltex.StartDownload(url, data)\n \tcreateDownloadPanel()\n end\n \n-return urltex\n\\ No newline at end of file\n+return urltex"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "db32df1ec161992e4ca687b38f46705ca2f01ff0",
            "date": "2025-01-03T01:38:07Z",
            "author_login": "Advers"
          },
          {
            "sha": "48743b7bd75c274cdc25c963387b98fa65ae0015",
            "date": "2024-06-05T00:20:04Z",
            "author_login": "pingu7867"
          },
          {
            "sha": "c1c8e0b6d0406be984479ca73da7c58cbb0f3b3f",
            "date": "2023-12-19T23:57:54Z",
            "author_login": "wrefgtzweve"
          },
          {
            "sha": "116adbcdff6ded1399e422f742f6d8a0ee6e8887",
            "date": "2023-12-27T08:53:12Z",
            "author_login": "CapsAdmin"
          },
          {
            "sha": "50435393d725a49e951868393527a609d90aeebf",
            "date": "2023-12-26T06:17:29Z",
            "author_login": "wrefgtzweve"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in CapsAdmin PAC3. It has been rated as problematic. Affected by this issue is some unknown functionality of the file lua/pac3/core/shared/http.lua. The manipulation of the argument url leads to cross site scripting. The attack may be launched remotely. The patch is identified as 8fc9e12dfa21d757be6eb4194c763e848b299ac0. It is recommended to apply a patch to fix this issue. VDB-217646 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-08T13:15:10.047",
    "last_modified": "2024-11-21T07:36:07.937",
    "fix_date": "2022-07-13T04:54:10Z"
  },
  "references": [
    {
      "url": "https://github.com/CapsAdmin/pac3/commit/8fc9e12dfa21d757be6eb4194c763e848b299ac0",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/CapsAdmin/pac3/pull/1210",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217646",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217646",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/CapsAdmin/pac3/commit/8fc9e12dfa21d757be6eb4194c763e848b299ac0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/CapsAdmin/pac3/pull/1210",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217646",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217646",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.531266",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pac3",
    "owner": "CapsAdmin",
    "created_at": "2013-05-22T14:00:08Z",
    "updated_at": "2025-01-03T01:38:12Z",
    "pushed_at": "2025-01-13T01:15:14Z",
    "size": 13631,
    "stars": 206,
    "forks": 93,
    "open_issues": 155,
    "watchers": 206,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Lua": 1552933,
      "Shell": 573,
      "Batchfile": 211
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T22:29:58.689181"
  }
}