{
  "cve_id": "CVE-2022-4882",
  "github_data": {
    "repository": "kaltura/mwEmbed",
    "fix_commit": "4f11b6f6610acd6d89de5f8be47cf7c610643845",
    "related_commits": [
      "4f11b6f6610acd6d89de5f8be47cf7c610643845",
      "4f11b6f6610acd6d89de5f8be47cf7c610643845"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "4f11b6f6610acd6d89de5f8be47cf7c610643845",
      "commit_date": "2022-01-03T07:59:59Z",
      "author": {
        "login": "lianbenjamin",
        "type": "User",
        "stats": {
          "total_commits": 34,
          "average_weekly_commits": 0.044270833333333336,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 20
        }
      },
      "commit_message": {
        "title": "fix(FEC-11791): share url has cross-site scripting vulnerability (#4255)",
        "length": 311,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "modules/KalturaSupport/components/share/share.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -616,7 +616,8 @@\n \t\t\t\t\tres = document.URL;\n \t\t\t\t}\n \t\t\t}\n-\t\t\treturn res;\n+\t\t\tvar sanitized = kWidget.sanitize(decodeURIComponent(res));\n+\t\t\treturn encodeURIComponent(sanitized);\n \t\t}\n \t\t// -------------- finish setup player url according to the socialShareURL flashvar ------- //\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "edfa709f5d8ace7310115a7ddea40c892f29ef91",
            "date": "2023-01-03T15:52:39Z",
            "author_login": "giladna"
          },
          {
            "sha": "eb156aad9823d7f4626123381b1bf9c68054ed04",
            "date": "2023-01-03T15:43:37Z",
            "author_login": "giladna"
          },
          {
            "sha": "f6fd8e159bcecd9d29f3e73b578d39a967acadff",
            "date": "2022-10-02T10:53:59Z",
            "author_login": "lianbenjamin"
          },
          {
            "sha": "21ef6e3b087dc14557465519f8cb65a2a88faeb3",
            "date": "2022-09-20T07:34:51Z",
            "author_login": "lianbenjamin"
          },
          {
            "sha": "2796fe91a6d1cc9cbb95fc5fe6e3e3661e5db772",
            "date": "2022-09-20T07:22:53Z",
            "author_login": "Tzipi-kaltura"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in kaltura mwEmbed up to 2.91. It has been rated as problematic. Affected by this issue is some unknown functionality of the file modules/KalturaSupport/components/share/share.js of the component Share Plugin. The manipulation of the argument res leads to cross site scripting. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 2.92.rc1 is able to address this issue. The name of the patch is 4f11b6f6610acd6d89de5f8be47cf7c610643845. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-217664.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-01-09T09:15:10.140",
    "last_modified": "2024-11-21T07:36:08.070",
    "fix_date": "2022-01-03T07:59:59Z"
  },
  "references": [
    {
      "url": "https://github.com/kaltura/mwEmbed/commit/4f11b6f6610acd6d89de5f8be47cf7c610643845",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/pull/4255",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/releases/tag/v2.92.rc1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217664",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217664",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/commit/4f11b6f6610acd6d89de5f8be47cf7c610643845",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/pull/4255",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kaltura/mwEmbed/releases/tag/v2.92.rc1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.217664",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.217664",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.533061",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mwEmbed",
    "owner": "kaltura",
    "created_at": "2012-02-08T15:44:27Z",
    "updated_at": "2025-01-14T13:22:47Z",
    "pushed_at": "2024-06-18T13:50:14Z",
    "size": 159971,
    "stars": 209,
    "forks": 135,
    "open_issues": 103,
    "watchers": 209,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 5118267,
      "PHP": 1599651,
      "HTML": 1217322,
      "CSS": 468121,
      "Shell": 2686
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T08:27:46.889994"
  }
}