{
  "cve_id": "CVE-2022-4905",
  "github_data": {
    "repository": "udx/wp-stateless",
    "fix_commit": "6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a",
    "related_commits": [
      "6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a",
      "6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a"
    ],
    "patch_url": "https://github.com/udx/wp-stateless/commit/6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a.patch",
    "fix_commit_details": {
      "sha": "6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a",
      "commit_date": "2022-05-06T08:26:36Z",
      "author": {
        "login": "planv",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "vulnerability fix",
        "length": 17,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
      },
      "files": [
        {
          "filename": "lib/classes/class-settings.php",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -515,11 +515,14 @@ public function setup_wizard_interface() {\n       public function save_media_settings(){\n         if(isset($_POST['action']) && $_POST['action'] == 'stateless_settings' && wp_verify_nonce( $_POST['_smnonce'], 'wp-stateless-settings' )){\n \n-          $settings = apply_filters('stateless::settings::save', sanitize_text_field($_POST['sm']));\n+          $settings = apply_filters('stateless::settings::save', $_POST['sm']);\n           $root_dir_value = false;\n \n           foreach ( $settings as $name => $value ) {\n-\n+            /**\n+             * Sanitize POST data\n+             */\n+            $value = sanitize_text_field($value);\n             /**\n              * root_dir settings\n              */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "12c47f6a09048af27e31a2d40bdcffd08f5080c7",
            "date": "2024-10-22T15:22:27Z",
            "author_login": "balexey88"
          },
          {
            "sha": "d118dd53c85ecf907406f455f283a52d3b744b67",
            "date": "2024-10-22T12:01:14Z",
            "author_login": "balexey88"
          },
          {
            "sha": "bc5c8f4db8488b11f59676ffec0bba982f52e4f5",
            "date": "2024-10-22T11:58:38Z",
            "author_login": "balexey88"
          },
          {
            "sha": "9bb6eb94ee1fc10f17c1c6f715e492059106dd94",
            "date": "2024-10-18T01:16:10Z",
            "author_login": "balexey88"
          },
          {
            "sha": "1fda32337400d932461ca7bf0047638a87b7360b",
            "date": "2024-10-17T21:08:37Z",
            "author_login": "balexey88"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in UDX Stateless Media Plugin 3.1.1 on WordPress. It has been declared as problematic. This vulnerability affects the function setup_wizard_interface of the file lib/classes/class-settings.php. The manipulation of the argument settings leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 3.2.0 is able to address this issue. The patch is identified as 6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a. It is recommended to upgrade the affected component. VDB-220750 is the identifier assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-13T21:15:13.710",
    "last_modified": "2024-11-21T07:36:13.077",
    "fix_date": "2022-05-06T08:26:36Z"
  },
  "references": [
    {
      "url": "https://github.com/udx/wp-stateless/commit/6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/udx/wp-stateless/pull/630",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/udx/wp-stateless/releases/tag/3.2.0",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220750",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220750",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/udx/wp-stateless/commit/6aee7ae0b0beeb2232ce6e1c82aa7e2041ae151a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/udx/wp-stateless/pull/630",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/udx/wp-stateless/releases/tag/3.2.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.220750",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.220750",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.021159",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wp-stateless",
    "owner": "udx",
    "created_at": "2015-04-19T06:24:12Z",
    "updated_at": "2025-01-04T05:22:33Z",
    "pushed_at": "2024-12-23T09:23:08Z",
    "size": 25032,
    "stars": 263,
    "forks": 63,
    "open_issues": 67,
    "watchers": 263,
    "has_security_policy": false,
    "default_branch": "latest",
    "protected_branches": [
      "latest",
      "v1.0",
      "v2.0",
      "v2.1",
      "v2.2",
      "v2.3",
      "v3.0",
      "v4.0"
    ],
    "languages": {
      "PHP": 759432,
      "JavaScript": 40341,
      "CSS": 18332
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:06:11.009315"
  }
}