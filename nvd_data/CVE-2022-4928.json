{
  "cve_id": "CVE-2022-4928",
  "github_data": {
    "repository": "icplayer/icplayer",
    "fix_commit": "2223628e6db1df73f6d633d2c0422d995990f0a3",
    "related_commits": [
      "2223628e6db1df73f6d633d2c0422d995990f0a3",
      "2223628e6db1df73f6d633d2c0422d995990f0a3"
    ],
    "patch_url": "https://github.com/icplayer/icplayer/commit/2223628e6db1df73f6d633d2c0422d995990f0a3.patch",
    "fix_commit_details": {
      "sha": "2223628e6db1df73f6d633d2c0422d995990f0a3",
      "commit_date": "2022-12-20T10:57:27Z",
      "author": {
        "login": "msawoniuk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Secure Text Selection addon against xss attacks, re #8593 (#881)",
        "length": 437,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 11,
        "deletions": 7
      },
      "files": [
        {
          "filename": "addons/Text_Selection/src/presenter.js",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -1558,8 +1558,10 @@ function AddonText_Selection_create() {\n     };\n \n     presenter.getWordsTextVoices = function($element) {\n-        var $clone = $element.clone();\n-        $clone.find('.selectable').each(function(){\n+        var sanitizedHTML = window.xssUtils.sanitize($element[0].outerHTML);\n+        var $sanitizedElement = $(sanitizedHTML);\n+\n+        $($sanitizedElement).find('.selectable').each(function(){\n             var $this = $(this);\n \n             if ($this.hasClass('selected')) {\n@@ -1574,7 +1576,7 @@ function AddonText_Selection_create() {\n             }\n         });\n \n-        var textArray = presenter.getTextFromElementWithAltTexts($clone).split(SPLIT);\n+        var textArray = presenter.getTextFromElementWithAltTexts($sanitizedElement).split(SPLIT);\n \n         var textVoices = [];\n \n@@ -1595,10 +1597,12 @@ function AddonText_Selection_create() {\n     };\n \n     presenter.getPhrasesTextVoices = function($element) {\n-        var $clone = $element.clone();\n+        var sanitizedHTML = window.xssUtils.sanitize($element[0].outerHTML);\n+        var $sanitizedElement = $(sanitizedHTML);\n \n-        $clone.find('.selectable').each(function(index){\n+        $sanitizedElement.find('.selectable').each(function(index){\n             var $this = $(this);\n+\n             $this.html(SPLIT + PHRASE + ' ' + (index+1) + SPLIT + $this.html() + SPLIT + PHRASE_END + SPLIT );\n \n             if ($this.hasClass('selected')) {\n@@ -1613,7 +1617,7 @@ function AddonText_Selection_create() {\n             }\n         });\n \n-        var textArray = presenter.getTextFromElementWithAltTexts($clone).split(SPLIT);\n+        var textArray = presenter.getTextFromElementWithAltTexts($sanitizedElement).split(SPLIT);\n \n         var textVoices = [];\n \n@@ -1647,7 +1651,6 @@ function AddonText_Selection_create() {\n     }\n \n     presenter.getSectionsTextVoices = function($element) {\n-\n         var $clone = $element.clone();\n \n         $clone.find('.selectable').each(function(){"
        },
        {
          "filename": "changelog.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -9,6 +9,7 @@\n 2022-11-25 Removed pause while reading syntax about time for TTS\n 2022-11-25 Fixed TTS reading an extra comma when alt text with dot is present at the end of a list element  \n 2022-11-25 Fixed no break in tts at the end of a line of text.\n+2022-11-22 Secured Text Selection addon against xss attacks\n 2022-11-14 Fixed support for only one audio type in slideshow addon\n 2022-11-10 Added grid size and rulers position separation\n 2022-11-07 Added worksWithAll property to eKeyboard"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e99e7b85265e7c2241e6e6ae87d6c1c2740e410c",
            "date": "2025-01-10T11:53:15Z",
            "author_login": "msawoniuk"
          },
          {
            "sha": "40b2c9aeecf7cae0a86e5eec948a3326a32fe509",
            "date": "2025-01-07T12:09:43Z",
            "author_login": "wkarasSolwit"
          },
          {
            "sha": "f4a02df9ea13ba2de202eb99c27d6c71d363bd16",
            "date": "2024-12-20T11:22:42Z",
            "author_login": "maciej-zawlocki-solwit"
          },
          {
            "sha": "35c80cb76ca04b2b6c2474f4f8b0b268a962e7f4",
            "date": "2024-12-20T11:21:57Z",
            "author_login": "wkarasSolwit"
          },
          {
            "sha": "38397cb05e85a8e23b24464730f7efadedb241a9",
            "date": "2024-12-20T11:20:45Z",
            "author_login": "wkarasSolwit"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in icplayer up to 0.819. It has been declared as problematic. Affected by this vulnerability is the function AddonText_Selection_create of the file addons/Text_Selection/src/presenter.js. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 0.820 is able to address this issue. The identifier of the patch is 2223628e6db1df73f6d633d2c0422d995990f0a3. It is recommended to upgrade the affected component. The identifier VDB-222289 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-06T01:15:09.993",
    "last_modified": "2024-11-21T07:36:16.280",
    "fix_date": "2022-12-20T10:57:27Z"
  },
  "references": [
    {
      "url": "https://github.com/icplayer/icplayer/commit/2223628e6db1df73f6d633d2c0422d995990f0a3",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/icplayer/icplayer/pull/881",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/icplayer/icplayer/releases/tag/v0.820",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.222289",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.222289",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/icplayer/icplayer/commit/2223628e6db1df73f6d633d2c0422d995990f0a3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/icplayer/icplayer/pull/881",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/icplayer/icplayer/releases/tag/v0.820",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.222289",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.222289",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.806801",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "icplayer",
    "owner": "icplayer",
    "created_at": "2013-02-25T08:53:47Z",
    "updated_at": "2025-01-10T11:53:20Z",
    "pushed_at": "2025-01-14T07:34:28Z",
    "size": 123087,
    "stars": 40,
    "forks": 25,
    "open_issues": 54,
    "watchers": 40,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 12717686,
      "Java": 2490932,
      "CSS": 215471,
      "HTML": 60876,
      "Python": 1000
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:25:23.170070"
  }
}