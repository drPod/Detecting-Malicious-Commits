{
  "cve_id": "CVE-2023-0313",
  "github_data": {
    "repository": "thorsten/phpmyfaq",
    "fix_commit": "1123c0872314fa68d7d0d8136939f62270fb4b7b",
    "related_commits": [
      "1123c0872314fa68d7d0d8136939f62270fb4b7b",
      "1123c0872314fa68d7d0d8136939f62270fb4b7b"
    ],
    "patch_url": "https://github.com/thorsten/phpmyfaq/commit/1123c0872314fa68d7d0d8136939f62270fb4b7b.patch",
    "fix_commit_details": {
      "sha": "1123c0872314fa68d7d0d8136939f62270fb4b7b",
      "commit_date": "2022-12-15T20:11:57Z",
      "author": {
        "login": "thorsten",
        "type": "User",
        "stats": {
          "total_commits": 7352,
          "average_weekly_commits": 9.19,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 647
        }
      },
      "commit_message": {
        "title": "fix: added missing conversion to HTML entities",
        "length": 46,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 200,
        "additions": 108,
        "deletions": 92
      },
      "files": [
        {
          "filename": "phpmyfaq/admin/category.main.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -79,8 +79,8 @@\n                 $categoryLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);\n                 $categoryData = [\n                     'lang' => $categoryLang,\n-                    'name' => Filter::filterInput(INPUT_POST, 'name', FILTER_UNSAFE_RAW),\n-                    'description' => Filter::filterInput(INPUT_POST, 'description', FILTER_UNSAFE_RAW),\n+                    'name' => Filter::filterInput(INPUT_POST, 'name', FILTER_SANITIZE_SPECIAL_CHARS),\n+                    'description' => Filter::filterInput(INPUT_POST, 'description', FILTER_SANITIZE_SPECIAL_CHARS),\n                     'user_id' => Filter::filterInput(INPUT_POST, 'user_id', FILTER_VALIDATE_INT),\n                     'group_id' => Filter::filterInput(INPUT_POST, 'group_id', FILTER_VALIDATE_INT),\n                     'active' => Filter::filterInput(INPUT_POST, 'active', FILTER_VALIDATE_INT),"
        },
        {
          "filename": "phpmyfaq/admin/news.php",
          "status": "modified",
          "additions": 37,
          "deletions": 23,
          "patch": "@@ -7,21 +7,21 @@\n  * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n  * obtain one at http://mozilla.org/MPL/2.0/.\n  *\n- * @package phpMyFAQ\n- * @author Thorsten Rinne <thorsten@phpmyfaq.de>\n- * @author Matteo Scaramuccia <matteo@phpmyfaq.de>\n+ * @package   phpMyFAQ\n+ * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n+ * @author    Matteo Scaramuccia <matteo@phpmyfaq.de>\n  * @copyright 2003-2022 phpMyFAQ Team\n- * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n- * @link https://www.phpmyfaq.de\n- * @since 2003-02-23\n+ * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n+ * @link      https://www.phpmyfaq.de\n+ * @since     2003-02-23\n  */\n \n use phpMyFAQ\\Comments;\n use phpMyFAQ\\Date;\n use phpMyFAQ\\Entity\\CommentType;\n use phpMyFAQ\\Filter;\n use phpMyFAQ\\Helper\\LanguageHelper;\n-use phpMyFAQ\\News;\n+use phpMyFAQ\\News;use phpMyFAQ\\Strings;\n \n if (!defined('IS_VALID_PHPMYFAQ')) {\n     http_response_code(400);\n@@ -66,15 +66,19 @@\n                     </div>\n \n                     <div class=\"form-group row\">\n-                        <label class=\"col-3 col-form-label\" for=\"authorName\"><?= $PMF_LANG['ad_news_author_name'] ?></label>\n+                        <label class=\"col-3 col-form-label\" for=\"authorName\">\n+                        <?= $PMF_LANG['ad_news_author_name'] ?>\n+                        </label>\n                         <div class=\"col-9\">\n                             <input class=\"form-control\" type=\"text\" name=\"authorName\" id=\"authorName\"\n                                    value=\"<?= $user->getUserData('display_name') ?>\">\n                         </div>\n                     </div>\n \n                     <div class=\"form-group row\">\n-                        <label class=\"col-3 col-form-label\" for=\"authorEmail\"><?= $PMF_LANG['ad_news_author_email'] ?></label>\n+                        <label class=\"col-3 col-form-label\" for=\"authorEmail\">\n+                        <?= $PMF_LANG['ad_news_author_email'] ?>\n+                        </label>\n                         <div class=\"col-9\">\n                             <input class=\"form-control\" type=\"email\" name=\"authorEmail\" id=\"authorEmail\"\n                                    value=\"<?= $user->getUserData('email') ?>\">\n@@ -94,7 +98,9 @@\n                     </div>\n \n                     <div class=\"form-group row\">\n-                        <label class=\"col-3 col-form-label\" for=\"comment\"><?= $PMF_LANG['ad_news_allowComments'] ?></label>\n+                        <label class=\"col-3 col-form-label\" for=\"comment\">\n+                        <?= $PMF_LANG['ad_news_allowComments'] ?>\n+                        </label>\n                         <div class=\"col-9 checkbox\">\n                             <label>\n                                 <input type=\"checkbox\" name=\"comment\" id=\"comment\" value=\"y\">\n@@ -106,12 +112,15 @@\n                     <div class=\"form-group row\">\n                         <label class=\"col-3 col-form-label\" for=\"link\"><?= $PMF_LANG['ad_news_link_url'] ?></label>\n                         <div class=\"col-9\">\n-                            <input class=\"form-control\" type=\"text\" name=\"link\" id=\"link\" placeholder=\"http://www.example.com/\">\n+                            <input class=\"form-control\" type=\"text\" name=\"link\" id=\"link\"\n+                            placeholder=\"http://www.example.com/\">\n                         </div>\n                     </div>\n \n                     <div class=\"form-group row\">\n-                        <label class=\"col-3 col-form-label\" for=\"linkTitle\"><?= $PMF_LANG['ad_news_link_title'] ?></label>\n+                        <label class=\"col-3 col-form-label\" for=\"linkTitle\">\n+                        <?= $PMF_LANG['ad_news_link_title'] ?>\n+                        </label>\n                         <div class=\"col-9\">\n                             <input type=\"text\" name=\"linkTitle\" id=\"linkTitle\" class=\"form-control\">\n                         </div>\n@@ -207,7 +216,7 @@\n         foreach ($newsHeader as $newsItem) {\n             ?>\n                     <tr>\n-                        <td><?= $newsItem['header'] ?></td>\n+                        <td><?= Strings::htmlentities($newsItem['header']) ?></td>\n                         <td><?= $date->format($newsItem['date']) ?></td>\n                         <td>\n                             <a class=\"btn btn-primary\" href=\"?action=edit-news&amp;id=<?= $newsItem['id'] ?>\">\n@@ -254,7 +263,7 @@\n                         <label class=\"col-3 col-form-label\" for=\"newsheader\"><?= $PMF_LANG['ad_news_header'] ?></label>\n                         <div class=\"col-9\">\n                             <input type=\"text\" name=\"newsheader\" id=\"newsheader\" class=\"form-control\"\n-                                   value=\"<?= $newsData['header'] ?? '' ?>\">\n+                                   value=\"<?= Strings::htmlentities($newsData['header']) ?? '' ?>\">\n                         </div>\n                     </div>\n \n@@ -270,16 +279,20 @@\n                     </div>\n \n                     <div class=\"form-group row\">\n-                        <label class=\"col-3 col-form-label\" for=\"authorName\"><?= $PMF_LANG['ad_news_author_name'] ?></label>\n+                        <label class=\"col-3 col-form-label\" for=\"authorName\">\n+                        <?= $PMF_LANG['ad_news_author_name'] ?>\n+                        </label>\n                         <div class=\"col-9\">\n-                            <input type=\"text\" name=\"authorName\" value=\"<?= $newsData['authorName'] ?>\" class=\"form-control\">\n+                            <input type=\"text\" name=\"authorName\" class=\"form-control\"\n+                                value=\"<?= Strings::htmlentities($newsData['authorName']) ?>\">\n                         </div>\n                     </div>\n \n                     <div class=\"form-group row\">\n                         <label class=\"col-3 col-form-label\" for=\"authorEmail\"><?= $PMF_LANG['ad_news_author_email'] ?></label>\n                         <div class=\"col-9\">\n-                            <input type=\"email\" name=\"authorEmail\" value=\"<?= $newsData['authorEmail'] ?>\" class=\"form-control\">\n+                            <input type=\"email\" name=\"authorEmail\" class=\"form-control\"\n+                                value=\"<?= Strings::htmlentities($newsData['authorEmail']) ?>\">\n                         </div>\n                     </div>\n \n@@ -315,15 +328,16 @@\n                     <div class=\"form-group row\">\n                         <label class=\"col-3 col-form-label\" for=\"link\"><?= $PMF_LANG['ad_news_link_url'] ?></label>\n                         <div class=\"col-9\">\n-                            <input type=\"text\" id=\"link\" name=\"link\" value=\"<?= $newsData['link'] ?>\" class=\"form-control\">\n+                            <input type=\"text\" id=\"link\" name=\"link\"\n+                            value=\"<?= Strings::htmlentities($newsData['link']) ?>\" class=\"form-control\">\n                         </div>\n                     </div>\n \n                     <div class=\"form-group row\">\n                         <label class=\"col-3 col-form-label\" for=\"linkTitle\"><?= $PMF_LANG['ad_news_link_title'] ?></label>\n                         <div class=\"col-9\">\n-                            <input type=\"text\" id=\"linkTitle\" name=\"linkTitle\" value=\"<?= $newsData['linkTitle'] ?>\"\n-                            class=\"form-control\">\n+                            <input type=\"text\" id=\"linkTitle\" name=\"linkTitle\"\n+                            value=\"<?= Strings::htmlentities($newsData['linkTitle']) ?>\" class=\"form-control\">\n                         </div>\n                     </div>\n \n@@ -429,14 +443,14 @@ class=\"form-control\">\n     <?php\n     $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);\n     $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);\n-    $header = Filter::filterInput(INPUT_POST, 'newsheader', FILTER_UNSAFE_RAW);\n+    $header = Filter::filterInput(INPUT_POST, 'newsheader', FILTER_SANITIZE_SPECIAL_CHARS);\n     $content = Filter::filterInput(INPUT_POST, 'news', FILTER_SANITIZE_SPECIAL_CHARS);\n     $author = Filter::filterInput(INPUT_POST, 'authorName', FILTER_UNSAFE_RAW);\n     $email = Filter::filterInput(INPUT_POST, 'authorEmail', FILTER_VALIDATE_EMAIL);\n     $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);\n     $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);\n-    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_UNSAFE_RAW);\n-    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_UNSAFE_RAW);\n+    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_SANITIZE_SPECIAL_CHARS);\n+    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_SANITIZE_SPECIAL_CHARS);\n     $newsLang = Filter::filterInput(INPUT_POST, 'langTo', FILTER_UNSAFE_RAW);\n     $target = Filter::filterInput(INPUT_POST, 'target', FILTER_UNSAFE_RAW);\n "
        },
        {
          "filename": "phpmyfaq/faq.php",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -7,13 +7,13 @@\n  * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n  * obtain one at http://mozilla.org/MPL/2.0/.\n  *\n- * @package phpMyFAQ\n- * @author Thorsten Rinne <thorsten@phpmyfaq.de>\n- * @author Lars Tiedemann <larstiedemann@yahoo.de>\n+ * @package   phpMyFAQ\n+ * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n+ * @author    Lars Tiedemann <larstiedemann@yahoo.de>\n  * @copyright 2002-2022 phpMyFAQ Team\n- * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n- * @link https://www.phpmyfaq.de\n- * @since 2002-08-27\n+ * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n+ * @link      https://www.phpmyfaq.de\n+ * @since     2002-08-27\n  */\n \n use phpMyFAQ\\Attachment\\AttachmentException;\n@@ -338,7 +338,7 @@\n         'baseHref' => $faqSystem->getSystemUri($faqConfig),\n         'solutionId' => $faq->faqRecord['solution_id'],\n         'solutionIdLink' => Link::getSystemRelativeUri() . '?solution_id=' . $faq->faqRecord['solution_id'],\n-        'question' => $question,\n+        'question' => Strings::htmlentities($question),\n         'answer' => $answer,\n         'faqDate' => $date->format($faq->faqRecord['date']),\n         'faqAuthor' => $author,"
        },
        {
          "filename": "phpmyfaq/index.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -539,7 +539,7 @@\n     'metaTitle' => Strings::htmlspecialchars(str_replace('\"', '', $faqConfig->getTitle() . $title)),\n     'metaDescription' => Strings::htmlspecialchars($metaDescription ?? ''),\n     'metaKeywords' => Strings::htmlspecialchars($keywords),\n-    'metaPublisher' => $faqConfig->get('main.metaPublisher'),\n+    'metaPublisher' => Strings::htmlspecialchars($faqConfig->get('main.metaPublisher')),\n     'metaLanguage' => $PMF_LANG['metaLanguage'],\n     'metaRobots' => $faqSeo->getMetaRobots($action),\n     'phpmyfaqversion' => $faqConfig->getVersion(),"
        },
        {
          "filename": "phpmyfaq/news.php",
          "status": "modified",
          "additions": 12,
          "deletions": 11,
          "patch": "@@ -8,13 +8,13 @@\n  * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n  * obtain one at http://mozilla.org/MPL/2.0/.\n  *\n- * @package phpMyFAQ\n- * @author Thorsten Rinne <thorsten@phpmyfaq.de>\n- * @author Matteo Scaramuccia <matteo@scaramuccia.com>\n+ * @package   phpMyFAQ\n+ * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n+ * @author    Matteo Scaramuccia <matteo@scaramuccia.com>\n  * @copyright 2006-2022 phpMyFAQ Team\n- * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n- * @link https://www.phpmyfaq.de\n- * @since 2006-07-23\n+ * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n+ * @link      https://www.phpmyfaq.de\n+ * @since     2006-07-23\n  */\n \n use phpMyFAQ\\Captcha;\n@@ -25,6 +25,7 @@\n use phpMyFAQ\\Glossary;\n use phpMyFAQ\\Helper\\CaptchaHelper;\n use phpMyFAQ\\News;\n+use phpMyFAQ\\Strings;\n use phpMyFAQ\\User\\CurrentUser;\n \n if (!defined('IS_VALID_PHPMYFAQ')) {\n@@ -74,9 +75,9 @@\n     $newsContent .= sprintf(\n         '</p><p>%s<a href=\"%s\" target=\"%s\">%s</a>',\n         $PMF_LANG['msgInfo'],\n-        $news['link'],\n+        Strings::htmlentities($news['link']),\n         $news['target'],\n-        $news['linkTitle']\n+        Strings::htmlentities($news['linkTitle'])\n     );\n }\n \n@@ -121,11 +122,11 @@\n     'mainPageContent',\n     [\n         'writeNewsHeader' => $newsMainHeader,\n-        'writeHeader' => $newsHeader,\n-        'mainPageContent' => $newsContent,\n+        'writeHeader' => Strings::htmlentities($newsHeader),\n+        'mainPageContent' => Strings::htmlentities($newsContent),\n         'writeDateMsg' => $newsDate,\n         'msgAboutThisNews' => $PMF_LANG['msgAboutThisNews'],\n-        'writeAuthor' => ($news['active'] && (!$expired)) ? $PMF_LANG['msgAuthor'] . ': ' . $news['authorName'] : '',\n+        'writeAuthor' => ($news['active'] && (!$expired)) ? $PMF_LANG['msgAuthor'] . ': ' . Strings::htmlentities($news['authorName']) : '',\n         'editThisEntry' => $editThisEntry,\n         'writeCommentMsg' => $commentMessage,\n         'msgWriteComment' => $PMF_LANG['newsWriteComment'],"
        },
        {
          "filename": "phpmyfaq/src/Bootstrap.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -25,7 +25,7 @@\n // Debug mode:\n // - false debug mode disabled\n // - true  debug mode enabled\n-const DEBUG = false;\n+const DEBUG = true;\n if (DEBUG) {\n     ini_set('display_errors', '1');\n     ini_set('display_startup_errors', '1');"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Category.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -787,13 +787,13 @@ public function addCategoryLink(\n \n         $oLink = new Link($url, $this->config);\n         $oLink->id = 'category_' . $categoryId;\n-        $oLink->itemTitle = $categoryName;\n-        $oLink->text = $categoryName;\n+        $oLink->itemTitle = Strings::htmlentities($categoryName);\n+        $oLink->text = Strings::htmlentities($categoryName);\n \n         if ($hasChildren) {\n             $oLink->text .= sprintf(\n                 '<i aria-hidden=\"true\" class=\"fa fa-caret-right\" title=\"%s\"></i>',\n-                $categoryName\n+                Strings::htmlentities($categoryName)\n             );\n         }\n \n@@ -890,8 +890,8 @@ public function getPath(\n                 );\n                 $oLink = new Link($url, $this->config);\n                 $oLink->text = sprintf('<span>%s</span>', $category);\n-                $oLink->itemTitle = $category;\n-                $oLink->tooltip = $description[$key];\n+                $oLink->itemTitle = Strings::htmlentities($category);\n+                $oLink->tooltip = Strings::htmlentities($description[$key]);\n                 if (0 === $key) {\n                     $oLink->setRelation('index');\n                 }"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Database/DatabaseHelper.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -31,7 +31,7 @@ class DatabaseHelper\n     /**\n      * @var Configuration\n      */\n-    private $config;\n+    private Configuration $config;\n \n     /**\n      * Constructor."
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Helper/CategoryHelper.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -241,9 +241,9 @@ public function renderCategoryDropDown(): string\n                     $parent\n                 );\n                 $oLink = new Link($url, $this->config);\n-                $oLink->itemTitle = $categoryName;\n-                $oLink->text = $categoryName;\n-                $oLink->tooltip = $description;\n+                $oLink->itemTitle = Strings::htmlentities($categoryName);\n+                $oLink->text = Strings::htmlentities($categoryName);\n+                $oLink->tooltip = !is_null($description) ?? Strings::htmlentities($description);\n \n                 $output .= $oLink->toHtmlAnchor();\n                 $open = $level;\n@@ -274,7 +274,7 @@ public function renderMainCategories(): string\n                 $categories .= sprintf(\n                     '<li><a href=\"?action=show&cat=%d\">%s</a></li>',\n                     $cat['id'],\n-                    $cat['name']\n+                    Strings::htmlentities($cat['name'])\n                 );\n             }\n         }\n@@ -323,7 +323,7 @@ public function renderOptions($categoryId): string\n             }\n \n             $categories .= '>';\n-            $categories .= $indent . $cat['name'] . \"</option>\\n\";\n+            $categories .= $indent . Strings::htmlentities($cat['name']) . \"</option>\\n\";\n             ++$i;\n         }\n \n@@ -355,7 +355,7 @@ public function renderStartPageCategories(array $categories): string\n                 '<a href=\"' . Strings::htmlentities($category['url']) . '\">' .\n                 Strings::htmlentities($category['name']) . '</a>' .\n                 '</h4>' .\n-                '<p class=\"card-text\">' . $category['description'] . '</p>' .\n+                '<p class=\"card-text\">' . Strings::htmlentities($category['description']) . '</p>' .\n                 '</div>' .\n                 '</div>';\n             if ($key % 2 === 0) {\n@@ -504,9 +504,9 @@ public function renderCategoryTree(): string\n                 $parent\n             );\n             $oLink = new Link($url, $this->config);\n-            $oLink->itemTitle = $categoryName;\n-            $oLink->text = $categoryName;\n-            $oLink->tooltip = $description;\n+            $oLink->itemTitle = Strings::htmlentities($categoryName);\n+            $oLink->text = Strings::htmlentities($categoryName);\n+            $oLink->tooltip = !is_null($description) ?? Strings::htmlentities($description);\n \n             $output .= $oLink->toHtmlAnchor() . $numFaqs;\n             $open = $level;"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -163,12 +163,12 @@ public function renderAnswerPreview(string $answer, int $numWords): string\n      * Creates an overview with all categories with their FAQs.\n      *\n      * @param Category $category\n-     * @param Faq $faq\n-     * @param string $language\n+     * @param Faq      $faq\n+     * @param string   $language\n      * @return string\n      * @throws Exception\n      */\n-    public function createOverview(Category $category, Faq $faq, $language = ''): string\n+    public function createOverview(Category $category, Faq $faq, string $language = ''): string\n     {\n         global $PMF_LANG;\n \n@@ -209,8 +209,8 @@ public function createOverview(Category $category, Faq $faq, $language = ''): st\n      * Creates a list of links with available languages to edit a FAQ\n      * in the admin backend.\n      *\n-     * @param  $faqId\n-     * @param  $faqLang\n+     * @param int    $faqId\n+     * @param string $faqLang\n      * @return string\n      */\n     public function createFaqTranslationLinkList(int $faqId, string $faqLang): string"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Helper/QuestionHelper.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -31,13 +31,13 @@\n class QuestionHelper\n {\n     /** @var Configuration */\n-    private $config;\n+    private Configuration $config;\n \n     /** @var Category */\n-    private $category;\n+    private Category $category;\n \n     /** @var array */\n-    private $translation;\n+    private array $translation;\n \n     /**\n      * QuestionHelper constructor."
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Helper/TagsHelper.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -7,8 +7,7 @@\n  * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n  * obtain one at http://mozilla.org/MPL/2.0/.\n  *\n- * @package    phpMyFAQ\\Helper\n- * @subpackage TagsHelper\n+ * @package    phpMyFAQ\n  * @author     Thorsten Rinne <thorsten@phpmyfaq.de>\n  * @copyright  2013-2022 phpMyFAQ Team\n  * @license    http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n@@ -20,6 +19,7 @@\n \n use phpMyFAQ\\Filter;\n use phpMyFAQ\\Helper;\n+use phpMyFAQ\\Strings;\n \n /**\n  * Class TagsHelper\n@@ -32,7 +32,7 @@ class TagsHelper extends Helper\n      *\n      * @var array\n      */\n-    private $taggingIds;\n+    private array $taggingIds;\n \n     /**\n      * Renders the tag list.\n@@ -61,7 +61,7 @@ public function renderTagList(array $tags): string\n      */\n     public function renderSearchTag(int $tagId, string $tagName): string\n     {\n-        $taggingIds = str_replace($tagId, '', $this->getTaggingIds());\n+        $taggingIds = str_replace((string) $tagId, '', $this->getTaggingIds());\n         $taggingIds = str_replace(' ', '', $taggingIds);\n         $taggingIds = str_replace(',,', ',', $taggingIds);\n         $taggingIds = trim(implode(',', $taggingIds), ',');\n@@ -70,11 +70,11 @@ public function renderSearchTag(int $tagId, string $tagName): string\n             '<a class=\"btn btn-primary m-1\" href=\"?action=search&amp;tagging_id=%s\">%s ' .\n             '<i aria-hidden=\"true\" class=\"fa fa-minus-square\"></i></a> ',\n             $taggingIds,\n-            $tagName\n+            Strings::htmlentities($tagName)\n         ) : sprintf(\n             '<a class=\"btn btn-primary m-1\" href=\"?action=search&amp;search=\">%s ' .\n             '<i aria-hidden=\"true\" class=\"fa fa-minus-square\"></i></a> ',\n-            $tagName\n+            Strings::htmlentities($tagName)\n         );\n     }\n \n@@ -83,7 +83,7 @@ public function renderSearchTag(int $tagId, string $tagName): string\n      *\n      * @return array\n      */\n-    public function getTaggingIds()\n+    public function getTaggingIds(): array\n     {\n         return $this->taggingIds;\n     }\n@@ -93,7 +93,7 @@ public function getTaggingIds()\n      *\n      * @param array $taggingIds The tag IDs as array\n      */\n-    public function setTaggingIds(array $taggingIds)\n+    public function setTaggingIds(array $taggingIds): void\n     {\n         $this->taggingIds = array_filter($taggingIds, function ($tagId) {\n             return Filter::filterVar($tagId, FILTER_VALIDATE_INT);\n@@ -117,7 +117,7 @@ public function renderRelatedTag(int $tagId, string $tagName, int $relevance): s\n             '<span class=\"badge badge-dark\">%d</span></a>',\n             implode(',', $this->getTaggingIds()) . ',' . $tagId,\n             '<i aria-hidden=\"true\" class=\"fa fa-plus-square\"></i> ',\n-            $tagName,\n+            Strings::htmlentities($tagName),\n             $relevance\n         );\n     }"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/News.php",
          "status": "modified",
          "additions": 13,
          "deletions": 13,
          "patch": "@@ -59,7 +59,7 @@ public function __construct(Configuration $config)\n      * @return string\n      * @throws Exception\n      */\n-    public function getNews($showArchive = false, $active = true): string\n+    public function getNews(bool $showArchive = false, bool $active = true): string\n     {\n         $output = '';\n         $news = $this->getLatestData($showArchive, $active);\n@@ -75,15 +75,15 @@ public function getNews($showArchive = false, $active = true): string\n             $oLink = new Link($url, $this->config);\n \n             if (isset($item['header'])) {\n-                $oLink->itemTitle = $item['header'];\n+                $oLink->itemTitle = Strings::htmlentities($item['header']);\n             }\n \n             $output .= sprintf(\n                 '<h6%s><a id=\"news_%d\" href=\"%s\">%s <i aria-hidden=\"true\" class=\"fa fa-caret-right\"></i></a></h6>',\n                 ' class=\"pmf-news-heading\"',\n                 $item['id'],\n                 $oLink->toString(),\n-                $item['header']\n+                Strings::htmlentities($item['header'])\n             );\n \n             $output .= sprintf('%s', $item['content']);\n@@ -303,16 +303,16 @@ public function addNewsEntry(array $data): bool\n             $this->config->getDb()->nextId(Database::getTablePrefix() . 'faqnews', 'id'),\n             $data['date'],\n             $data['lang'],\n-            $data['header'],\n-            $data['content'],\n-            $data['authorName'],\n+            $this->config->getDb()->escape($data['header']),\n+            $this->config->getDb()->escape($data['content']),\n+            $this->config->getDb()->escape($data['authorName']),\n             $data['authorEmail'],\n             $data['dateStart'],\n             $data['dateEnd'],\n             $data['active'],\n             $data['comment'],\n-            $data['link'],\n-            $data['linkTitle'],\n+            $this->config->getDb()->escape($data['link']),\n+            $this->config->getDb()->escape($data['linkTitle']),\n             $data['target']\n         );\n \n@@ -355,16 +355,16 @@ public function updateNewsEntry(int $id, array $data): bool\n             Database::getTablePrefix(),\n             $data['date'],\n             $data['lang'],\n-            $data['header'],\n-            $data['content'],\n-            $data['authorName'],\n+            $this->config->getDb()->escape($data['header']),\n+            $this->config->getDb()->escape($data['content']),\n+            $this->config->getDb()->escape($data['authorName']),\n             $data['authorEmail'],\n             $data['dateStart'],\n             $data['dateEnd'],\n             $data['active'],\n             $data['comment'],\n-            $data['link'],\n-            $data['linkTitle'],\n+            $this->config->getDb()->escape($data['link']),\n+            $this->config->getDb()->escape($data['linkTitle']),\n             $data['target'],\n             $id\n         );"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Utils.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -232,15 +232,15 @@ public static function debug(string $string): string\n     {\n         // sometimes Zend Optimizer causes segfaults with debug_backtrace()\n         if (extension_loaded('Zend Optimizer')) {\n-            $ret = '<code>' . $string . \"</code><br>\\n\";\n+            $ret = '<code>' . Strings::htmlentities($string) . \"</code><br>\\n\";\n         } else {\n             $debug = debug_backtrace();\n             $ret = '';\n             if (isset($debug[2]['class'])) {\n                 $ret = $debug[2]['file'] . ':<br>';\n                 $ret .= $debug[2]['class'] . $debug[1]['type'];\n                 $ret .= $debug[2]['function'] . '() in line ' . $debug[2]['line'];\n-                $ret .= ': <code>' . $string . \"</code><br>\\n\";\n+                $ret .= ': <code>' . Strings::htmlentities($string) . \"</code><br>\\n\";\n             }\n         }\n "
        },
        {
          "filename": "phpmyfaq/startpage.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -36,6 +36,7 @@\n } else {\n     $writeNewsHeader = ' ' . $PMF_LANG['msgNews'];\n     $showAllNews = sprintf('<a href=\"?%snewsid=0\">%s</a>', $sids, $PMF_LANG['newsShowArchive']);\n+    $archived = false;\n }\n \n $startPageCategories = $category->getHomeCategories();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0bde62632e8a6501702a5e0dc76b821b0e193cd1",
            "date": "2025-01-14T14:57:50Z",
            "author_login": "modelrailroader"
          },
          {
            "sha": "69ccf3a0310a91e580ba3fbae763cf6fc4e70e8c",
            "date": "2025-01-14T04:44:45Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "0aff5a567446adbf5d024e0d8b2b132666f91464",
            "date": "2025-01-13T20:29:34Z",
            "author_login": "modelrailroader"
          },
          {
            "sha": "0ee934f2713e59ed829afa56b95697670cdcfad7",
            "date": "2025-01-13T19:58:07Z",
            "author_login": "modelrailroader"
          },
          {
            "sha": "471ebc8577558da4bcdbf45f7b18ab75e33f9a37",
            "date": "2025-01-13T19:57:09Z",
            "author_login": "modelrailroader"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.10.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-15T22:15:10.970",
    "last_modified": "2024-11-21T07:36:57.170",
    "fix_date": "2022-12-15T20:11:57Z"
  },
  "references": [
    {
      "url": "https://github.com/thorsten/phpmyfaq/commit/1123c0872314fa68d7d0d8136939f62270fb4b7b",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/bc27e84b-1f91-4e1b-a78c-944edeba8256",
      "source": "security@huntr.dev",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/thorsten/phpmyfaq/commit/1123c0872314fa68d7d0d8136939f62270fb4b7b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/bc27e84b-1f91-4e1b-a78c-944edeba8256",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.560426",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "phpMyFAQ",
    "owner": "thorsten",
    "created_at": "2009-08-04T19:26:15Z",
    "updated_at": "2025-01-14T04:55:59Z",
    "pushed_at": "2025-01-14T04:56:02Z",
    "size": 56435,
    "stars": 589,
    "forks": 255,
    "open_issues": 19,
    "watchers": 589,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 9489706,
      "Twig": 348463,
      "JavaScript": 322766,
      "SCSS": 19741,
      "Shell": 9475,
      "Dockerfile": 2594,
      "CSS": 1125,
      "HTML": 205
    },
    "commit_activity": {
      "total_commits_last_year": 1338,
      "avg_commits_per_week": 25.73076923076923,
      "days_active_last_year": 282
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mpl-2.0"
    },
    "collected_at": "2025-01-14T13:07:11.405854"
  }
}