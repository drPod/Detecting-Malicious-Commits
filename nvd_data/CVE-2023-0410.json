{
  "cve_id": "CVE-2023-0410",
  "github_data": {
    "repository": "builderio/qwik",
    "fix_commit": "4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a",
    "related_commits": [
      "4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a",
      "4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a"
    ],
    "patch_url": "https://github.com/builderio/qwik/commit/4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a.patch",
    "fix_commit_details": {
      "sha": "4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a",
      "commit_date": "2022-12-19T20:21:56Z",
      "author": {
        "login": "adamdbradley",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: cleanse ssr attribute name and class value (#2475)",
        "length": 120,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 43,
        "additions": 42,
        "deletions": 1
      },
      "files": [
        {
          "filename": "packages/qwik/src/core/render/ssr/render-ssr.ts",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -544,6 +544,10 @@ const renderNode = (\n           classStr = attrValue;\n         } else if (attrName === 'value' && tagName === 'textarea') {\n           htmlStr = escapeHtml(attrValue);\n+        } else if (isSSRUnsafeAttr(attrName)) {\n+          if (qDev) {\n+            logError('Attribute value is unsafe for SSR');\n+          }\n         } else {\n           openingElement +=\n             ' ' + (value === '' ? attrName : attrName + '=\"' + escapeAttr(attrValue) + '\"');\n@@ -631,7 +635,7 @@ This goes against the HTML spec: https://html.spec.whatwg.org/multipage/dom.html\n     }\n \n     if (classStr) {\n-      openingElement += ' class=\"' + classStr + '\"';\n+      openingElement += ' class=\"' + escapeAttr(classStr) + '\"';\n     }\n \n     if (listeners.length > 0) {\n@@ -1073,6 +1077,12 @@ const escapeAttr = (s: string) => {\n   });\n };\n \n+// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n+const unsafeAttrCharRE = /[>/=\"'\\u0009\\u000a\\u000c\\u0020]/; // eslint-disable-line no-control-regex\n+export const isSSRUnsafeAttr = (name: string): boolean => {\n+  return unsafeAttrCharRE.test(name);\n+};\n+\n const listenersNeedId = (listeners: Listener[]) => {\n   return listeners.some((l) => l[1].$captureRef$ && l[1].$captureRef$.length > 0);\n };"
        },
        {
          "filename": "packages/qwik/src/core/render/ssr/render-ssr.unit.tsx",
          "status": "modified",
          "additions": 31,
          "deletions": 0,
          "patch": "@@ -1262,6 +1262,37 @@ renderSSRSuite('null component', async () => {\n     `<html q:container=\"paused\" q:version=\"dev\" q:render=\"ssr-dev\"><!--qv q:id=0 q:key=sX:--><!--/qv--></html>`\n   );\n });\n+\n+renderSSRSuite('cleanse attribute name', async () => {\n+  const o = {\n+    '\"><script>alert(\"\u0ca0~\u0ca0\")</script>': 'xss',\n+  };\n+  await testSSR(\n+    <body {...o}></body>,\n+    '<html q:container=\"paused\" q:version=\"dev\" q:render=\"ssr-dev\"><body></body></html>'\n+  );\n+});\n+\n+renderSSRSuite('cleanse class attribute', async () => {\n+  const o = {\n+    class: '\"><script>alert(\"\u0ca0~\u0ca0\")</script>',\n+  };\n+  await testSSR(\n+    <body {...o}></body>,\n+    '<html q:container=\"paused\" q:version=\"dev\" q:render=\"ssr-dev\"><body class=\"&quot;><script>alert(&quot;\u0ca0~\u0ca0&quot;)</script>\"></body></html>'\n+  );\n+});\n+\n+renderSSRSuite('class emoji valid', async () => {\n+  const o = {\n+    class: 'package\ud83d\udce6',\n+  };\n+  await testSSR(\n+    <body {...o}></body>,\n+    '<html q:container=\"paused\" q:version=\"dev\" q:render=\"ssr-dev\"><body class=\"package\ud83d\udce6\"></body></html>'\n+  );\n+});\n+\n // TODO\n // Merge props on host\n // - host events"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "55d3bfca398c454a2a6bcaf0af8d760f3f70fd33",
            "date": "2025-01-14T19:56:26Z",
            "author_login": "shairez"
          },
          {
            "sha": "3342d586f70ebf08161d1aa119c49186bc25a93c",
            "date": "2025-01-14T16:28:42Z",
            "author_login": "seleb"
          },
          {
            "sha": "b6dbf79165a03c7b9935397ff9fdb81f78cee349",
            "date": "2025-01-13T20:22:51Z",
            "author_login": "shairez"
          },
          {
            "sha": "20fa9bd96c2b3728f68e303ef7106c6e536dda6e",
            "date": "2025-01-13T17:47:18Z",
            "author_login": "Varixo"
          },
          {
            "sha": "6f5cac3b96c6c6b359fd7de8bd8b9ec88a67ec89",
            "date": "2025-01-11T11:11:39Z",
            "author_login": "wmertens"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Generic in GitHub repository builderio/qwik prior to 0.1.0-beta5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-20T01:15:10.863",
    "last_modified": "2024-11-21T07:37:07.783",
    "fix_date": "2022-12-19T20:21:56Z"
  },
  "references": [
    {
      "url": "https://github.com/builderio/qwik/commit/4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/2da583f0-7f66-4ba7-9bed-8e7229aa578e",
      "source": "security@huntr.dev",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/builderio/qwik/commit/4b2f89dbbd2bc0a2c92eae1a49bdd186e589151a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/2da583f0-7f66-4ba7-9bed-8e7229aa578e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:04:43.578133",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qwik",
    "owner": "builderio",
    "created_at": "2021-05-19T15:33:32Z",
    "updated_at": "2025-01-14T20:54:32Z",
    "pushed_at": "2025-01-14T19:56:28Z",
    "size": 49526,
    "stars": 21039,
    "forks": 1322,
    "open_issues": 282,
    "watchers": 21039,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "build/v2",
      "main",
      "upcoming"
    ],
    "languages": {
      "TypeScript": 3354182,
      "MDX": 1127423,
      "JavaScript": 843160,
      "Rust": 253194,
      "CSS": 119814,
      "HTML": 27276,
      "Nix": 2469,
      "Dockerfile": 1339,
      "Makefile": 1279,
      "Shell": 60
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T22:47:11.889510"
  }
}