{
  "cve_id": "CVE-2023-0549",
  "github_data": {
    "repository": "YAFNET/YAFNET",
    "fix_commit": "2237a9d552e258a43570bb478a92a5505e7c8797",
    "related_commits": [
      "2237a9d552e258a43570bb478a92a5505e7c8797",
      "2237a9d552e258a43570bb478a92a5505e7c8797"
    ],
    "patch_url": "https://github.com/YAFNET/YAFNET/commit/2237a9d552e258a43570bb478a92a5505e7c8797.patch",
    "fix_commit_details": {
      "sha": "2237a9d552e258a43570bb478a92a5505e7c8797",
      "commit_date": "2023-01-22T07:02:58Z",
      "author": {
        "login": "w8tcha",
        "type": "User",
        "stats": {
          "total_commits": 4447,
          "average_weekly_commits": 5.913563829787234,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 536
        }
      },
      "commit_message": {
        "title": "[FIXED GHSA-4hwx-678w-9cp5] XSS in pms",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 11,
        "deletions": 8
      },
      "files": [
        {
          "filename": "yafsrc/YetAnotherForum.NET/Pages/PostPrivateMessage.ascx.cs",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -305,7 +305,7 @@ protected void Page_Load([NotNull] object sender, [NotNull] EventArgs e)\n             }\n \n             // handle subject\n-            var subject = this.ReplyMessage.Subject;\n+            var subject = HtmlHelper.StripHtml(this.ReplyMessage.Subject);\n             if (!subject.StartsWith(\"Re: \"))\n             {\n                 subject = $\"Re: {subject}\";\n@@ -566,7 +566,7 @@ protected void Save_Click([NotNull] object sender, [NotNull] EventArgs e)\n             this.GetRepository<PMessage>().SendMessage(\n                 this.PageBoardContext.PageUserID,\n                 0,\n-                this.PmSubjectTextBox.Text,\n+                HtmlHelper.StripHtml(this.PmSubjectTextBox.Text),\n                 body,\n                 messageFlags.BitValue,\n                 replyTo);\n@@ -664,7 +664,7 @@ protected void Save_Click([NotNull] object sender, [NotNull] EventArgs e)\n                 userId =>\n \n                     {\n-                        var body = this.editor.Text;\n+                        var body = HtmlHelper.StripHtml(BBCodeHelper.EncodeCodeBlocks(this.editor.Text));\n \n                         var messageFlags = new MessageFlags\n                                                {\n@@ -675,7 +675,7 @@ protected void Save_Click([NotNull] object sender, [NotNull] EventArgs e)\n                         this.GetRepository<PMessage>().SendMessage(\n                             this.PageBoardContext.PageUserID,\n                             userId,\n-                            this.PmSubjectTextBox.Text,\n+                            HtmlHelper.StripHtml(this.PmSubjectTextBox.Text),\n                             body,\n                             messageFlags.BitValue,\n                             replyTo);\n@@ -687,7 +687,7 @@ protected void Save_Click([NotNull] object sender, [NotNull] EventArgs e)\n                         {\n                             this.Get<ISendNotification>().ToPrivateMessageRecipient(\n                                 userId,\n-                                this.PmSubjectTextBox.Text.Trim());\n+                                HtmlHelper.StripHtml(this.PmSubjectTextBox.Text.Trim()));\n                         }\n                     });\n "
        },
        {
          "filename": "yafsrc/YetAnotherForum.NET/Pages/PrivateMessage.ascx",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -3,6 +3,7 @@\n <%@ Import Namespace=\"YAF.Types.Flags\" %>\n <%@ Import Namespace=\"YAF.Types.Objects.Model\" %>\n <%@ Import Namespace=\"YAF.Types.Interfaces.Services\" %>\n+<%@ Import Namespace=\"YAF.Core.Helpers\" %>\n \n <YAF:PageLinks runat=\"server\" ID=\"PageLinks\" />\n \n@@ -71,7 +72,7 @@\n                             <div class=\"col mt-3\">\n                                 <YAF:MessagePost ID=\"Message\" runat=\"server\"\n                                                  MessageFlags=\"<%# new MessageFlags((Container.DataItem as PagedPm).Flags) %>\"\n-                                                 Message=\"<%# (Container.DataItem as PagedPm).Body%>\"\n+                                                 Message=\"<%# HtmlHelper.StripHtml((Container.DataItem as PagedPm).Body)%>\"\n                                                  MessageID=\"<%# (Container.DataItem as PagedPm).UserPMessageID %>\" />\n                             </div>\n                         </div>"
        },
        {
          "filename": "yafsrc/YetAnotherForum.NET/Pages/PrivateMessage.ascx.cs",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -145,8 +145,10 @@ private void BindData()\n                 this.PageBoardContext.PageLinks.AddLink(this.GetText(\"INBOX\"), this.Get<LinkBuilder>().GetLink(ForumPages.MyMessages));\n             }\n \n-            this.PageBoardContext.PageLinks.AddLink(message.Subject);\n-            this.MessageTitle.Text = message.Subject;\n+            var subject = HtmlHelper.StripHtml(message.Subject);\n+\n+            this.PageBoardContext.PageLinks.AddLink(subject);\n+            this.MessageTitle.Text = subject;\n \n             this.Inbox.DataSource = messages;\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7fab63a45f0563f5b3ee7ecc5fbff3424258a0de",
            "date": "2025-01-11T12:29:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "b381b9446322312a970c1f06d9382c4ea3409d9d",
            "date": "2025-01-11T12:28:38Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "62ef6485c5674caf2ec65ac79daf653c32a3987c",
            "date": "2025-01-10T12:47:03Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e6d79e6c5abc4d32d8bd3703b23d0a2175533c87",
            "date": "2025-01-10T04:41:37Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "01f93a81ec8b70071059e98c961408347eab8ba4",
            "date": "2025-01-02T07:09:27Z",
            "author_login": "w8tcha"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability, which was classified as problematic, has been found in YAFNET up to 3.1.10. This issue affects some unknown processing of the file /forum/PostPrivateMessage of the component Private Message Handler. The manipulation of the argument subject/message leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 3.1.11 is able to address this issue. The identifier of the patch is 2237a9d552e258a43570bb478a92a5505e7c8797. It is recommended to upgrade the affected component. The identifier VDB-219665 was assigned to this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-01-27T19:15:10.457",
    "last_modified": "2024-11-21T07:37:23.113",
    "fix_date": "2023-01-22T07:02:58Z"
  },
  "references": [
    {
      "url": "https://drive.google.com/drive/folders/1ct6Tp_cnsYO8L_JSvlBCf_Ae7KW3JAcD?usp=sharing",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/YAFNET/YAFNET/commit/2237a9d552e258a43570bb478a92a5505e7c8797",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/YAFNET/YAFNET/releases/tag/v3.1.11",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/YAFNET/YAFNET/security/advisories/GHSA-4hwx-678w-9cp5",
      "source": "cna@vuldb.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.219665",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.219665",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://drive.google.com/drive/folders/1ct6Tp_cnsYO8L_JSvlBCf_Ae7KW3JAcD?usp=sharing",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/YAFNET/YAFNET/commit/2237a9d552e258a43570bb478a92a5505e7c8797",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/YAFNET/YAFNET/releases/tag/v3.1.11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/YAFNET/YAFNET/security/advisories/GHSA-4hwx-678w-9cp5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.219665",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.219665",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.946280",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "YAFNET",
    "owner": "YAFNET",
    "created_at": "2013-08-15T01:52:32Z",
    "updated_at": "2025-01-14T13:40:39Z",
    "pushed_at": "2025-01-13T04:49:09Z",
    "size": 672652,
    "stars": 519,
    "forks": 212,
    "open_issues": 8,
    "watchers": 519,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C#": 10550680,
      "HTML": 2848567,
      "JavaScript": 2340582,
      "CSS": 1620550,
      "SCSS": 557044,
      "TSQL": 35822,
      "Dockerfile": 2129,
      "Batchfile": 92
    },
    "commit_activity": {
      "total_commits_last_year": 663,
      "avg_commits_per_week": 12.75,
      "days_active_last_year": 197
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:42:35.331273"
  }
}