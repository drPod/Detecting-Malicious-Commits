{
  "cve_id": "CVE-2023-0609",
  "github_data": {
    "repository": "wallabag/wallabag",
    "fix_commit": "0f7460dbab9e29f4f7d2944aca20210f828b6abb",
    "related_commits": [
      "0f7460dbab9e29f4f7d2944aca20210f828b6abb",
      "0f7460dbab9e29f4f7d2944aca20210f828b6abb"
    ],
    "patch_url": "https://github.com/wallabag/wallabag/commit/0f7460dbab9e29f4f7d2944aca20210f828b6abb.patch",
    "fix_commit_details": {
      "sha": "0f7460dbab9e29f4f7d2944aca20210f828b6abb",
      "commit_date": "2023-02-01T08:30:43Z",
      "author": {
        "login": "j0k3r",
        "type": "User",
        "stats": {
          "total_commits": 3349,
          "average_weekly_commits": 5.436688311688312,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 378
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-qwx8-mxxx-mg96",
        "length": 103,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 27,
        "deletions": 4
      },
      "files": [
        {
          "filename": "src/Wallabag/CoreBundle/Controller/ExportController.php",
          "status": "modified",
          "additions": 14,
          "deletions": 3,
          "patch": "@@ -6,7 +6,6 @@\n use Symfony\\Component\\HttpFoundation\\Request;\n use Symfony\\Component\\HttpKernel\\Exception\\NotFoundHttpException;\n use Symfony\\Component\\Routing\\Annotation\\Route;\n-use Wallabag\\CoreBundle\\Entity\\Entry;\n \n /**\n  * The try/catch can be removed once all formats will be implemented.\n@@ -26,9 +25,21 @@ class ExportController extends Controller\n      *\n      * @return \\Symfony\\Component\\HttpFoundation\\Response\n      */\n-    public function downloadEntryAction(Entry $entry, $format)\n+    public function downloadEntryAction(Request $request, $format)\n     {\n-        try {\n+         try {\n+            $entry = $this->get('wallabag_core.entry_repository')\n+                ->find((int) $request->query->get('id'));\n+\n+            /**\n+             * We duplicate EntryController::checkUserAction here as a quick fix for an improper authorization vulnerability\n+             *\n+             * This should be eventually rewritten\n+            */\n+            if (null === $entry || null === $this->getUser() || $this->getUser()->getId() !== $entry->getUser()->getId()) {\n+                throw new NotFoundHttpException();\n+            }\n+\n             return $this->get('wallabag_core.helper.entries_export')\n                 ->setEntries($entry)\n                 ->updateTitle('entry')"
        },
        {
          "filename": "tests/Wallabag/CoreBundle/Controller/ExportControllerTest.php",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -57,7 +57,7 @@ public function testUnsupportedFormatExport()\n         $this->assertSame(404, $client->getResponse()->getStatusCode());\n     }\n \n-    public function testBadEntryId()\n+    public function testNonExistingEntryId()\n     {\n         $this->logInAs('admin');\n         $client = $this->getClient();\n@@ -67,6 +67,18 @@ public function testBadEntryId()\n         $this->assertSame(404, $client->getResponse()->getStatusCode());\n     }\n \n+    public function testForbiddenEntryId()\n+    {\n+        $this->logInAs('admin');\n+        $client = $this->getClient();\n+\n+        // Entry with id 3 is owned by the user bob\n+        // See EntryFixtures\n+        $client->request('GET', '/export/3.mobi');\n+\n+        $this->assertSame(404, $client->getResponse()->getStatusCode());\n+    }\n+\n     public function testEpubExport()\n     {\n         $this->logInAs('admin');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "63d6647d164f418c2dc2572707380a9e3da84aad",
            "date": "2025-01-14T05:41:36Z",
            "author_login": "j0k3r"
          },
          {
            "sha": "1da052b5286e379b60d3f4c248b1be993af2fe1a",
            "date": "2025-01-14T05:41:13Z",
            "author_login": "j0k3r"
          },
          {
            "sha": "6c70a12fd4cb6b2980c6b1cf69eedb96b9cf8f6a",
            "date": "2025-01-14T03:07:57Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "4d3bce3aca068e440b11477efc27b7846383076f",
            "date": "2025-01-14T03:07:19Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "34e79483780fea0232ab69d91096ee84630caf13",
            "date": "2025-01-13T04:54:12Z",
            "author_login": "j0k3r"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-285",
    "description": "Improper Authorization in GitHub repository wallabag/wallabag prior to 2.5.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-01T12:15:09.150",
    "last_modified": "2024-11-21T07:37:28.813",
    "fix_date": "2023-02-01T08:30:43Z"
  },
  "references": [
    {
      "url": "https://github.com/wallabag/wallabag/commit/0f7460dbab9e29f4f7d2944aca20210f828b6abb",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/3adef66f-fc86-4e6d-a540-2ffa59342ff0",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wallabag/wallabag/commit/0f7460dbab9e29f4f7d2944aca20210f828b6abb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/3adef66f-fc86-4e6d-a540-2ffa59342ff0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.962844",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wallabag",
    "owner": "wallabag",
    "created_at": "2013-04-03T12:21:14Z",
    "updated_at": "2025-01-14T07:24:12Z",
    "pushed_at": "2025-01-14T05:41:37Z",
    "size": 132325,
    "stars": 10808,
    "forks": 784,
    "open_issues": 663,
    "watchers": 10808,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "2.6",
      "master"
    ],
    "languages": {
      "PHP": 1560787,
      "Twig": 233625,
      "SCSS": 34476,
      "JavaScript": 31079,
      "Shell": 4565,
      "Dockerfile": 3360,
      "Makefile": 1807
    },
    "commit_activity": {
      "total_commits_last_year": 1006,
      "avg_commits_per_week": 19.346153846153847,
      "days_active_last_year": 208
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:07:34.527195"
  }
}