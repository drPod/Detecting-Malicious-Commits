{
  "cve_id": "CVE-2023-0677",
  "github_data": {
    "repository": "phpipam/phpipam",
    "fix_commit": "8fbf87e19a6098972abc7521554db5757c3edd89",
    "related_commits": [
      "8fbf87e19a6098972abc7521554db5757c3edd89",
      "8fbf87e19a6098972abc7521554db5757c3edd89"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8fbf87e19a6098972abc7521554db5757c3edd89",
      "commit_date": "2023-02-03T21:37:09Z",
      "author": {
        "login": "GaryAllan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bugfix: XSS (reflected) by invalid email address response",
        "length": 82,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "app/subnets/addresses/mail-notify-check.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -21,7 +21,7 @@\n # verify each recipient\n foreach (explode(\",\", $_POST['recipients']) as $rec) {\n \tif(!filter_var(trim($rec), FILTER_VALIDATE_EMAIL)) {\n-\t\t$Result->show(\"danger\", _(\"Invalid email address\").\" - \".$rec, true);\n+\t\t$Result->show(\"danger\", _(\"Invalid email address\").\" - \".escape_input($rec), true);\n \t}\n }\n # strip html tags"
        },
        {
          "filename": "app/tools/temp-shares/edit-result.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -27,7 +27,7 @@\n # verify each recipient\n if(strlen($_POST['email'])>0) {\n \tforeach (explode(\",\", $_POST['email']) as $rec) {\n-\t\tif(!filter_var(trim($rec), FILTER_VALIDATE_EMAIL)) \t\t\t{ $Result->show(\"danger\", _(\"Invalid email address\").\" - \".$rec, true); }\n+\t\tif(!filter_var(trim($rec), FILTER_VALIDATE_EMAIL)) \t\t\t{ $Result->show(\"danger\", _(\"Invalid email address\").\" - \".escape_input($rec), true); }\n \t}\n }\n "
        },
        {
          "filename": "misc/CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -3,6 +3,7 @@\n     Security Fixes:\n     ----------------------------\n     + XSS (reflected) in 'bw-calulator-result.php';\n+    + XSS (reflected) by invalid email address response;\n     + Restrict find_full_subnets.php to CLI;\n \n == 1.5.0"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "602d81226784fe8de1af96db98f594745f6b441d",
            "date": "2024-11-27T09:56:05Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "f04280ba16fa3901dcd98900a248adfc55f89e13",
            "date": "2024-11-27T09:57:12Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "3212ed239c11093c83bb10bac1f727682c562e17",
            "date": "2024-11-26T16:15:46Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "93cfa93424947a71d0a75ee128f49c90897243c4",
            "date": "2024-11-23T22:18:16Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "91acd5c61f546d29e3b2ae526768c80a065f6e15",
            "date": "2024-11-23T22:22:42Z",
            "author_login": "GaryAllan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Reflected in GitHub repository phpipam/phpipam prior to v1.5.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-04T13:15:12.633",
    "last_modified": "2024-11-21T07:37:36.633",
    "fix_date": "2023-02-03T21:37:09Z"
  },
  "references": [
    {
      "url": "https://github.com/phpipam/phpipam/commit/8fbf87e19a6098972abc7521554db5757c3edd89",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/d280ae81-a1c9-4a50-9aa4-f98f1f9fd2c0",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/phpipam/phpipam/commit/8fbf87e19a6098972abc7521554db5757c3edd89",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/d280ae81-a1c9-4a50-9aa4-f98f1f9fd2c0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.987079",
    "processing_status": "enhanced"
  }
}