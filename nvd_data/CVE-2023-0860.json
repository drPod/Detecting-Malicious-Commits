{
  "cve_id": "CVE-2023-0860",
  "github_data": {
    "repository": "modoboa/modoboa-installer",
    "fix_commit": "63d92b73f3da6971ae4e13d033d625773ac91085",
    "related_commits": [
      "63d92b73f3da6971ae4e13d033d625773ac91085",
      "63d92b73f3da6971ae4e13d033d625773ac91085"
    ],
    "patch_url": "https://github.com/modoboa/modoboa-installer/commit/63d92b73f3da6971ae4e13d033d625773ac91085.patch",
    "fix_commit_details": {
      "sha": "63d92b73f3da6971ae4e13d033d625773ac91085",
      "commit_date": "2023-01-31T08:09:51Z",
      "author": {
        "login": "tonioo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #474 from modoboa/security/fail2ban",
        "length": 76,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 61,
        "additions": 61,
        "deletions": 0
      },
      "files": [
        {
          "filename": "modoboa_installer/config_dict_template.py",
          "status": "modified",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -118,6 +118,31 @@ def is_email(user_input):\n             }\n         ]\n     },\n+    {\n+        \"name\": \"fail2ban\",\n+        \"values\": [\n+            {\n+                \"option\": \"enabled\",\n+                \"default\": \"true\",\n+            },\n+            {\n+                \"option\": \"config_dir\",\n+                \"default\": \"/etc/fail2ban\"\n+            },\n+            {\n+                \"option\": \"max_retry\",\n+                \"default\": \"20\"\n+            },\n+            {\n+                \"option\": \"ban_time\",\n+                \"default\": \"3600\"\n+            },\n+            {\n+                \"option\": \"find_time\",\n+                \"default\": \"30\"\n+            },\n+        ]\n+    },\n     {\n         \"name\": \"modoboa\",\n         \"values\": ["
        },
        {
          "filename": "modoboa_installer/scripts/fail2ban.py",
          "status": "added",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -0,0 +1,17 @@\n+\"\"\"fail2ban related functions.\"\"\"\n+\n+from . import base\n+\n+\n+class Fail2ban(base.Installer):\n+    \"\"\"Fail2ban installer.\"\"\"\n+\n+    appname = \"fail2ban\"\n+    packages = {\n+        \"deb\": [\"fail2ban\"],\n+        \"rpm\": [\"fail2ban\"]\n+    }\n+    config_files = [\n+        \"jail.d/modoboa.conf\",\n+        \"filter.d/modoboa-auth.conf\",\n+    ]"
        },
        {
          "filename": "modoboa_installer/scripts/files/fail2ban/filter.d/modoboa-auth.conf.tpl",
          "status": "added",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -0,0 +1,9 @@\n+# Fail2Ban filter Modoboa authentication\n+\n+[INCLUDES]\n+\n+before = common.conf\n+\n+[Definition]\n+\n+failregex = modoboa\\.auth: WARNING Failed connection attempt from \\'<HOST>\\' as user \\'.*?\\'$"
        },
        {
          "filename": "modoboa_installer/scripts/files/fail2ban/jail.d/modoboa.conf.tpl",
          "status": "added",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -0,0 +1,9 @@\n+[modoboa]\n+enabled = true\n+port = http,https\n+protocol = tcp\n+filter = modoboa-auth\n+maxretry = %max_retry\n+bantime = %ban_time\n+findtime = %find_time\n+logpath = /var/log/auth.log"
        },
        {
          "filename": "run.py",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -22,6 +22,7 @@\n \n PRIMARY_APPS = [\n     \"amavis\",\n+    \"fail2ban\",\n     \"modoboa\",\n     \"automx\",\n     \"radicale\","
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "50f632ee9abad2026ad771377700987668f529cd",
            "date": "2024-10-19T07:48:12Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "20b6ede21173441284efe533627e95ba91bfeb53",
            "date": "2024-10-19T07:47:42Z",
            "author_login": "tonioo"
          },
          {
            "sha": "97c81a8eaf2a77cbba2e5474f546b7b08cc5964a",
            "date": "2024-10-19T07:46:49Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "a35780fe4f65d90866470d774cab138a7444b0cf",
            "date": "2024-10-19T07:45:49Z",
            "author_login": "tonioo"
          },
          {
            "sha": "feba5ca406f75897f78d56088ca8f40cfe8351cf",
            "date": "2024-10-19T07:45:17Z",
            "author_login": "tonioo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-307",
    "description": "Improper Restriction of Excessive Authentication Attempts in GitHub repository modoboa/modoboa-installer prior to 2.0.4.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-16T10:15:11.530",
    "last_modified": "2024-11-21T07:37:59.290",
    "fix_date": "2023-01-31T08:09:51Z"
  },
  "references": [
    {
      "url": "https://github.com/modoboa/modoboa-installer/commit/63d92b73f3da6971ae4e13d033d625773ac91085",
      "source": "security@huntr.dev",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/64f3ab93-1357-4468-8ff4-52bbcec18cca",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/modoboa/modoboa-installer/commit/63d92b73f3da6971ae4e13d033d625773ac91085",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/64f3ab93-1357-4468-8ff4-52bbcec18cca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.063810",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "modoboa-installer",
    "owner": "modoboa",
    "created_at": "2015-10-14T07:51:05Z",
    "updated_at": "2025-01-14T16:52:41Z",
    "pushed_at": "2025-01-13T14:28:47Z",
    "size": 641,
    "stars": 270,
    "forks": 141,
    "open_issues": 49,
    "watchers": 270,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 150123,
      "Smarty": 109747,
      "PLpgSQL": 968,
      "Shell": 351
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T21:02:43.724464"
  }
}