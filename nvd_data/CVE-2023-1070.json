{
  "cve_id": "CVE-2023-1070",
  "github_data": {
    "repository": "nilsteampassnet/teampass",
    "fix_commit": "0af3574caba27a61b16dc25c94fa51ae12d2d967",
    "related_commits": [
      "0af3574caba27a61b16dc25c94fa51ae12d2d967",
      "0af3574caba27a61b16dc25c94fa51ae12d2d967"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "0af3574caba27a61b16dc25c94fa51ae12d2d967",
      "commit_date": "2023-02-14T07:01:35Z",
      "author": {
        "login": "nilsteampassnet",
        "type": "User",
        "stats": {
          "total_commits": 2012,
          "average_weekly_commits": 2.9415204678362574,
          "total_additions": 5301385,
          "total_deletions": 4813706,
          "weeks_active": 411
        }
      },
      "commit_message": {
        "title": "3.0.0.23",
        "length": 77,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 669,
        "additions": 451,
        "deletions": 218
      },
      "files": [
        {
          "filename": "api/Model/ItemModel.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -77,7 +77,7 @@ public function getItems(string $sqlExtra, int $limit, string $userPrivateKey, i\n                 if (empty($path) === true) {\n                     $path = htmlspecialchars(stripslashes(htmlspecialchars_decode($elem->title, ENT_QUOTES)), ENT_QUOTES);\n                 } else {\n-                    $path .= '>' . htmlspecialchars(stripslashes(htmlspecialchars_decode($elem->title, ENT_QUOTES)), ENT_QUOTES);\n+                    $path .= '/' . htmlspecialchars(stripslashes(htmlspecialchars_decode($elem->title, ENT_QUOTES)), ENT_QUOTES);\n                 }\n             }\n "
        },
        {
          "filename": "includes/config/include.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -12,12 +12,12 @@\n  * @copyright 2009-2022 Nils Laumaill\u00e9\n  * @license   https://spdx.org/licenses/GPL-3.0-only.html#licenseText GPL-3.0\n  *\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  *\n  * @see      http://www.teampass.net\n  */\n define('TP_VERSION', '3.0.0');\n-define('TP_VERSION_FULL', TP_VERSION.'.22');\n+define('TP_VERSION_FULL', TP_VERSION.'.23');\n define('TP_TOOL_NAME', 'Teampass');\n define('TP_ONE_DAY_SECONDS', 86400);\n define('TP_ONE_WEEK_SECONDS', 604800);"
        },
        {
          "filename": "includes/core/load.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      load.js.php\n  * ---\n  *"
        },
        {
          "filename": "includes/core/login.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      login.js.php\n  * ---\n  *"
        },
        {
          "filename": "includes/core/login.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      login.php\n  * ---\n  *"
        },
        {
          "filename": "includes/core/logout.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      logout.php\n  * ---\n  *"
        },
        {
          "filename": "includes/core/otv.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      otv.php\n  * ---\n  *"
        },
        {
          "filename": "includes/language/arabic.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      arabic.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/bulgarian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      bulgarian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/catalan.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      catalan.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/chinese.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      chinese.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/czech.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      czech.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/dutch.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      dutch.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/english.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      english.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -517,7 +517,7 @@\n     'api_whitelist_ips' => 'API IPs Whitelist',\n     'api_whitelist_ips_tip' => 'If no API client IP addresses are explicitly listed here, then any IP address is authorized.',\n     'email_share_item_subject' => 'A password item was shared with you',\n-    'email_share_item_mail' => 'Hello,<br><br>This is a generated email from Teampass passwords manager.<br><br>#tp_user# has shared with you the password item #tp_item#.<br><br><a href=\\'#tp_link#\\'>Click this link</a> to access the item.<br><br><br>Greetings',\n+    'email_share_item_mail' => 'Hello,<br><br>This is a generated email from Teampass passwords manager.<br><br>#tp_user# has shared with you the password item #tp_item#.<br><br><a href=\"#tp_link#\">Click this link</a> to access the item.<br><br><br>Greetings',\n     'index_maintenance_mode_admin' => 'Maintenance mode is enabled. Users cannot sign in.',\n     '2fa_authentication_selector' => 'Select a 2 factor authentication method',\n     'upload_empty_file' => 'Upload empty file',"
        },
        {
          "filename": "includes/language/estonian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      estonian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/french.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      french.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/german.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      german.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/greek.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      greek.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/hungarian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      hungarian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/italian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      italian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/japanese.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      japanese.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/norwegian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      norwegian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/polish.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      polish.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/portuguese.php",
          "status": "modified",
          "additions": 25,
          "deletions": 25,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      portuguese.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -65,14 +65,14 @@\n     'settings_ldap_hosts_tip' => 'The hosts option is an array of IP addresses or host names located on your network that serve an LDAP directory (seprated by a comma). You insert as many servers or as little as you would like depending on your forest (with the minimum of one of course).',\n     'base_distiguished_name' => 'Base DN',\n     'settings_ldap_bdn_tip' => 'The root distinguished name (DN) to use when running queries against the directory server. Examples: o=example,c=com ; cn=users,dc=ad,dc=example,dc=com',\n-    'username' => 'Username',\n+    'username' => 'Utilizador',\n     'settings_ldap_username_tip' => 'The distinguished name of the user that the application will use when connecting to the directory server. Examples: cn=administrator,cn=users,dc=ad,dc=example,dc=com ; cn=user,dc=domain,dc=name',\n-    'settings_ldap_password_tip' => 'The password of the user specified above.',\n+    'settings_ldap_password_tip' => 'A palavra-passe do utilizador especificado acima.',\n     'settings_ldap_port_tip' => 'Default non secure LDAP port: 389, default secure LDAP port: 636',\n-    'undefined' => 'Undefined',\n-    'error_cannot_open_file' => 'File cannot be opened',\n+    'undefined' => 'Indefinido',\n+    'error_cannot_open_file' => 'O ficheiro n\u00e3o pode ser aberto',\n     'provide_current_psk_and_click_launch' => 'When ready, click button Launch',\n-    'start' => 'Start',\n+    'start' => 'Iniciar',\n     'data_inconsistency' => 'Data inconsistency found. Please reload the page!',\n     'one_time_code_expected' => 'One-Time-Code expected',\n     'data_are_missing' => 'Expected data are missing',\n@@ -83,13 +83,13 @@\n     'ldap_user_password_is_used_for_authentication' => 'User password in LDAP is used for authentication',\n     'local_user_password_is_used_for_authentication' => 'User password in Teampass is used for authentication',\n     'provide_your_current_password' => 'Provide your current password',\n-    'current_password' => 'Current password',\n-    'password_is_not_correct' => 'This password is not correct',\n+    'current_password' => 'Palavra-passe atual',\n+    'password_is_not_correct' => 'Esta palavra-passe n\u00e3o \u00e9 a correta',\n     'ldap_password_change_warning' => 'Your login password has changed since last connection. It is requested to re-encrypt all the keys using this new password. For this operation, please fill in the next field with your previous ldap password. The operation can take several minutes.',\n-    'personal_items' => 'Personal items',\n+    'personal_items' => 'Itens pessoais',\n     'logout_on_going' => 'You will now be logout. Use your new password for being connected from now.',\n     'fill_in_fields_and_hit_launch' => 'Provide expected data and hit Launch button',\n-    'please_select_a_folder' => 'Please select a folder',\n+    'please_select_a_folder' => 'Por favor seleccione uma pasta',\n     'user_must_have_login_and_email' => 'User must have a login and an email',\n     'user_has_this_role_in_teampass' => 'O utilizador tem esta fun\u00e7\u00e3o no Teampass',\n     'select_role_to_create' => 'Seleccione fun\u00e7\u00e3o a criar',\n@@ -101,14 +101,14 @@\n     'remove_install_folder' => 'Install folder has to be removed',\n     'list_users' => 'List users',\n     'ldap_synchronization' => 'LDAP synchronization',\n-    'in_progress' => 'In progress',\n+    'in_progress' => 'Em progresso',\n     'clipboard_password_life_duration' => 'Delay before the clipboard is cleared (in seconds)',\n     'clipboard_password_life_duration_tip' => 'Permits to define a delay in seconds before which the password copied in clipboard will be cleared from the browser clipboard. Set to 0 to disable.',\n     'clipboard_will_be_cleared' => 'Password is now in clipboard. It will soon be cleared...',\n     'file_folder_not_accessible' => 'Files folder is not accessible',\n     'error_missing_id' => 'An error occurred. Missing ID ... ?',\n     'error_folder_not_allowed' => 'Selected folder is not allowed',\n-    'all_fields_mandatory' => 'All fields are mandatory',\n+    'all_fields_mandatory' => 'Todos os campos s\u00e3o obrigat\u00f3rios',\n     'history_insert_entry' => 'Insert in History',\n     'clear_form' => 'Clear form',\n     'info_about_history_insertion' => 'Caution - This feature permits you to insert manually an event in the item history log. Once added it will not be possible to remove it. Also notice that your account id will be associated to this new entry.',\n@@ -126,14 +126,14 @@\n     'password_overview_delay_tip' => 'This setting permits to define the number of seconds the clear password will be displayed to the user.',\n     'select_date_showing_items_expiration' => 'List the expired items at date',\n     'renewal_page_info' => 'This page permits to identify the items currently expired or expiring in next period.',\n-    'filename' => 'Filename',\n-    'exported_to_file' => 'Exported to file',\n-    'operation_progress' => 'Operation is in progress',\n-    'exporting_items' => 'Exporting items',\n-    'select_folders_to_export' => 'Select folders to export',\n-    'export_format_type' => 'Select the export format type',\n-    'export_items' => 'Export items',\n-    'loading_item' => 'Loading item',\n+    'filename' => 'Nome do ficheiro',\n+    'exported_to_file' => 'Exportado para ficheiro',\n+    'operation_progress' => 'A opera\u00e7\u00e3o est\u00e1 em progresso',\n+    'exporting_items' => 'A exportar itens',\n+    'select_folders_to_export' => 'Seleccione pastas para exportar',\n+    'export_format_type' => 'Seleccione o formato de exporta\u00e7\u00e3o',\n+    'export_items' => 'Exportar itens',\n+    'loading_item' => 'A carregar item',\n     'otv_message' => 'You can share this item with someone without a Teampass account. One-Time-View permits your guest to access basic fields of this item only once without being authenticated in Teampass. Please notice that this link is valid for a period of ##otv_expiration_period##  days. Copy and share the link below.',\n     'no_sharekey_found' => 'No key found for this file and your account',\n     'otv_link' => 'One-time-view link',\n@@ -499,7 +499,7 @@\n     'server_time' => 'Server time',\n     'settings_tree_counters' => 'Show more counters in folder tree',\n     'settings_tree_counters_tip' => 'Enabling shows three numbers next to each folder: number of items in base folder; number of items including subfolders; number of subfolders. Enabling this feature may slow loading of the folder tree pane.',\n-    'admin_action_check_pf' => 'Criar pastas pessoas para todos os utilizadores que n\u00e3o t\u00eam',\n+    'admin_action_check_pf' => 'Criar pastas pessoas para todos os utilizadores que n\u00e3o as t\u00eam',\n     'enable_personal_folder_feature_tip' => 'Personal folders are a private location for individual user passwords. Password items are encrypted by a user\\'s salt key (more secure) or by their password (easier). Enabling this feature does not create the actual folders for existing users - you must also run the create personal folders task.',\n     'administrators_only' => 'Administrators only',\n     'managers_of' => 'Gestores da fun\u00e7\u00e3o',\n@@ -724,7 +724,7 @@\n     'level' => 'Nivel',\n     'login' => 'Login (se necess\u00e1rio)',\n     'mask_pw' => 'Oculta/Mostra a senha',\n-    'max_last_items' => 'Maximo de \u00faltimos itens visto por um usu\u00e1rios (Padr\u00e3o \u00e9 10)',\n+    'max_last_items' => 'Tamanho da lista dos \u00faltimos itens vistos (padr\u00e3o \u00e9 10)',\n     'minutes' => 'minutos',\n     'name' => 'Nome',\n     'nb_false_login_attempts' => 'N\u00famero de tentativas de login sem sucesso para bloquear a conta (0 \u00e9 desativado)',\n@@ -737,14 +737,14 @@\n     'not_allowed_to_see_pw' => 'Voc\u00ea n\u00e3o esta autorizado a ver este item!',\n     'not_allowed_to_see_pw_is_expired' => 'Este item esta expirado',\n     'not_defined' => 'N\u00e3o definido',\n-    'number_of_used_pw' => 'N\u00famero de novas senhas que o usu\u00e1rio precisa ingressar antes de usar uma senha antiga',\n+    'number_of_used_pw' => 'N\u00famero de palavras-passe antigas guardadas para evitar reutiliza\u00e7\u00e3o (0 para desativar)',\n     'pages' => 'Paginas',\n     'pdf_download' => 'Dowload do arquivo',\n     'personal_salt_key' => 'Sua senha pessoal \\'SALT KEY\\'',\n     'pw' => 'Senha',\n     'pw_generate' => 'Gera',\n     'pw_is_expired_-_update_it' => 'Este item expirou! Precisa alterar a senha.',\n-    'pw_life_duration' => 'Vida \u00fatil da senha de um usu\u00e1rio para expirar (em dia, 0 para desativar)',\n+    'pw_life_duration' => 'Palavras-passe de sess\u00e3o expiram ao fim de xx dias (0 para desativar)',\n     'readme_open' => 'Abrir o arquivo README completo',\n     'read_only_account' => 'Somente Leitura',\n     'restore' => 'Recuperar',\n@@ -767,7 +767,7 @@\n     'settings_ldap_ssl' => 'Usar SSL (LDAPS)',\n     'settings_ldap_tls' => 'Use LDAP a traves de TLS',\n     'settings_log_accessed' => 'Ativa registros de quem acessou aos itens',\n-    'settings_log_connections' => 'Guarda todos os in\u00edcios de sess\u00e3o',\n+    'settings_log_connections' => 'Guarda registo de todos os in\u00edcios de sess\u00e3o',\n     'settings_maintenance_mode' => 'Coloca TeamPass em modo de manuten\u00e7\u00e3o',\n     'settings_manager_edit' => 'Os Gerenciadores podem editar e apagar itens que est\u00e3o autorizados a ver',\n     'settings_printing' => 'Habilita a op\u00e7\u00e3o de imprimir arquivos PDF',"
        },
        {
          "filename": "includes/language/portuguese_br.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      portuguese_br.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/romanian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      romanian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/russian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      russian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/spanish.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      spanish.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -447,7 +447,7 @@\n     'api_whitelist_ips' => 'Lista blanca de IPs de la API',\n     'api_whitelist_ips_tip' => 'Si no hay direcciones IP de clientes de la API enumeradas expl\u00edcitamente aqu\u00ed, cualquier direcci\u00f3n IP est\u00e1 autorizada.',\n     'email_share_item_subject' => '[TeamPass] Un elemento ha sido compartido con usted',\n-    'email_share_item_mail' => 'Hola,&lt;br&gt;&lt;br&gt;&lt;u&gt;#tp_user#&lt;/u&gt; ha compartido con usted el elemento &lt;b&gt;#tp_item#&lt;/b&gt;&lt;br&gt;Pulse &lt;a href=\\'#tp_link#\\'&gt;aqu\u00ed&lt;/a&gt; para acceder.&lt;br&gt;&lt;br&gt;Saludos.',\n+    'email_share_item_mail' => 'Hola,&lt;br&gt;&lt;br&gt;&lt;u&gt;#tp_user#&lt;/u&gt; ha compartido con usted el elemento &lt;b&gt;#tp_item#&lt;/b&gt;&lt;br&gt;Pulse &lt;a href=\"#tp_link#\"&gt;aqu\u00ed&lt;/a&gt; para acceder.&lt;br&gt;&lt;br&gt;Saludos.',\n     'index_maintenance_mode_admin' => 'Modo de mantenimiento activado. En este momento los usuarios no pueden acceder a TeamPass.',\n     '2fa_authentication_selector' => 'Select a 2 factor authenticator method',\n     'upload_empty_file' => 'Upload empty file',"
        },
        {
          "filename": "includes/language/swedish.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      swedish.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -447,7 +447,7 @@\n     'api_whitelist_ips' => 'API IPs Whitelist',\n     'api_whitelist_ips_tip' => 'If no API client IP addresses are explicitly listed here, then any IP address is authorized.',\n     'email_share_item_subject' => 'A password item was shared with you',\n-    'email_share_item_mail' => 'Hello,<br><br>This is a generated email from Teampass passwords manager.<br><br>#tp_user# has shared with you the password item #tp_item#.<br><br><a href=\\'#tp_link#\\'>Click this link</a> to access the item.<br><br><br>Greetings',\n+    'email_share_item_mail' => 'Hello,<br><br>This is a generated email from Teampass passwords manager.<br><br>#tp_user# has shared with you the password item #tp_item#.<br><br><a href=\"#tp_link#\">Click this link</a> to access the item.<br><br><br>Greetings',\n     'index_maintenance_mode_admin' => 'Maintenance mode is enabled. Users cannot sign in.',\n     '2fa_authentication_selector' => 'Select a 2 factor authentication method',\n     'upload_empty_file' => 'Upload empty file',"
        },
        {
          "filename": "includes/language/turkish.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      turkish.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/ukrainian.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      ukrainian.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "includes/language/vietnamese.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      vietnamese.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "index.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      index.php\n  * ---\n  *"
        },
        {
          "filename": "install/install.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      install.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -287,7 +287,7 @@\n \t\t\t\t\t\t<label>Absolute path to SaltKey</label>\n \t\t\t\t\t\t<input type=\"text\" class=\"form-control\" name=\"sk_path\" id=\"sk_path\" class=\"ui-widget\" value=\"\"><span id=\"res4_check2\"></span>\n \t\t\t\t\t\t<small class=\"form-text text-muted\">\n-\t\t\t\t\t\t\tThe SaltKey is stored in a file called teampass-seckey.txt. For security reasons, this file should be stored in a folder outside the WWW folder of your server (example: /var/teampass/). This key will be used to encrypt data when sharing information with users without any Teampass account. If this field remains empty, this file will be stored in folder <path to Teampass>/includes/.\n+\t\t\t\t\t\t\tThe SaltKey is stored in a file called teampass-seckey.txt and hashed for security purpose. For security reasons, this file should be stored in a folder outside the WWW folder of your server (example: /var/teampass/). This key will be used to encrypt data when sharing information with users without any Teampass account. If this field remains empty, this file will be stored in folder <path to Teampass>/includes/.\n \t\t\t\t\t\t</small>\n \t\t\t\t\t</div>\n \t\t"
        },
        {
          "filename": "install/install.queries.php",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      install.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -1350,7 +1350,8 @@ function encryptFollowingDefuse($message, $ascii_key)\n                 if ($task === 'settings.php') {\n                     // first is to create teampass-seckey.txt\n                     // 0- check if exists\n-                    $filename_seckey = $securePath . '/teampass-seckey.txt';\n+                    define('SECUREFILE', generateRandomKey(25));\n+                    $filename_seckey = $securePath . '/' . SECUREFILE;\n \n                     if (file_exists($filename_seckey)) {\n                         if (!copy($filename_seckey, $filename_seckey . '.' . date('Y_m_d', mktime(0, 0, 0, (int) date('m'), (int) date('d'), (int) date('y'))))) {\n@@ -1424,6 +1425,7 @@ function encryptFollowingDefuse($message, $ascii_key)\n     MYSQLI_OPT_CONNECT_TIMEOUT => 10\n ));\n define(\"SECUREPATH\", \"' . $securePath . '\");\n+define(\"SECUREFILE\", \"' . SECUREFILE. '\");\n \n if (isset($_SESSION[\\'settings\\'][\\'timezone\\']) === true) {\n     date_default_timezone_set($_SESSION[\\'settings\\'][\\'timezone\\']);"
        },
        {
          "filename": "install/migrate_users_to_v3.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      migrate_users_to_v3.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/tp.functions.php",
          "status": "modified",
          "additions": 88,
          "deletions": 1,
          "patch": "@@ -1,5 +1,91 @@\n <?php\n \n+// new SECUREFILE - 3.0.0.23\n+function handleSecurefileConstant()\n+{\n+    if (defined('SECUREFILE') === false) {\n+        define('SECUREFILE', generateRandomKey(25));\n+        \n+        // manage the file itself by renaming it\n+        if (rename(SECUREPATH.'/teampass-seckey.txt', SECUREPATH.'/'.SECUREFILE) === false) {\n+            echo '[{\n+                \"error\" : \"File `'.SECUREPATH.'/teampass-seckey.txt` could not be renamed. Please do it by yourself and click on button Launch.\",\n+                \"index\" : \"\"\n+            }]';\n+            exit;\n+        }\n+\n+        // Ensure DB is read as UTF8\n+        if (defined('DB_ENCODING') === false) {\n+            define('DB_ENCODING', \"utf8\");\n+        }\n+\n+        // Now create new file\n+        $file_handled = fopen('../includes/config/settings.php', 'w');\n+        \n+        $settingsTxt = '<?php\n+// DATABASE connexion parameters\n+define(\"DB_HOST\", \"' . DB_HOST . '\");\n+define(\"DB_USER\", \"' . DB_USER . '\");\n+define(\"DB_PASSWD\", \"' . DB_PASSWD . '\");\n+define(\"DB_NAME\", \"' . DB_NAME . '\");\n+define(\"DB_PREFIX\", \"' . DB_PREFIX . '\");\n+define(\"DB_PORT\", \"' . DB_PORT . '\");\n+define(\"DB_ENCODING\", \"' . DB_ENCODING . '\");\n+define(\"DB_SSL\", array(\n+    \"key\" => \"'.DB_SSL['key'].'\",\n+    \"cert\" => \"'.DB_SSL['cert'].'\",\n+    \"ca_cert\" => \"\"'.DB_SSL['ca_cert'].',\n+    \"ca_path\" => \"'.DB_SSL['ca_path'].'\",\n+    \"cipher\" => \"'.DB_SSL['cipher'].'\"\n+));\n+define(\"DB_CONNECT_OPTIONS\", array(\n+    MYSQLI_OPT_CONNECT_TIMEOUT => 10\n+));\n+define(\"SECUREPATH\", \"' . str_replace('\\\\', '\\\\\\\\', SECUREPATH) . '\");\n+define(\"SECUREFILE\", \"' . SECUREFILE. '\");';\n+\n+        if (defined('IKEY') === true) $settingsTxt .= '\n+define(\"IKEY\", \"' . IKEY . '\");';\n+        else $settingsTxt .= '\n+define(\"IKEY\", \"\");';\n+        if (defined('SKEY') === true) $settingsTxt .= '\n+define(\"SKEY\", \"' . SKEY . '\");';\n+        else $settingsTxt .= '\n+define(\"SKEY\", \"\");';\n+        if (defined('HOST') === true) $settingsTxt .= '\n+define(\"HOST\", \"' . HOST . '\");';\n+        else $settingsTxt .= '\n+define(\"HOST\", \"\");';\n+\n+\n+        $settingsTxt .= '\n+\n+if (isset($_SESSION[\\'settings\\'][\\'timezone\\']) === true) {\n+    date_default_timezone_set($_SESSION[\\'settings\\'][\\'timezone\\']);\n+}\n+';\n+\n+        $fileCreation = fwrite(\n+            $file_handled,\n+            utf8_encode($settingsTxt)\n+        );\n+\n+        fclose($file_handled);\n+        sleep(3);\n+        if ($fileCreation === false) {\n+            return [\n+                'error' => true,\n+                'message' => 'Setting.php file could not be created in /includes/config/ folder. Please check the path and the rights.',\n+            ];\n+        }\n+\n+        return [\n+            'error' => false,\n+            'message' => ''\n+        ];\n+    }\n+}\n \n /**\n  * Undocumented function\n@@ -37,7 +123,8 @@ function defuseCryption($message, $ascii_key, $type)\n     // init\n     $err = '';\n     if (empty($ascii_key) === true) {\n-        $ascii_key = file_get_contents(SECUREPATH.'/teampass-seckey.txt');\n+        // new check - 3.0.0.23\n+        $ascii_key = file_get_contents(SECUREPATH.'/'.SECUREFILE);\n     }\n     \n     // convert KEY"
        },
        {
          "filename": "install/upgrade.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/upgrade_ajax.php",
          "status": "modified",
          "additions": 3,
          "deletions": 12,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_ajax.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -175,6 +175,7 @@\n     MYSQLI_OPT_CONNECT_TIMEOUT => 10\n ));\n define(\"SECUREPATH\", \"' . str_replace('\\\\', '\\\\\\\\', SECUREPATH) . '\");';\n+define(\"SECUREFILE\", \"' . SECUREFILE. '\");\n \n \t\tif (defined('IKEY') === true) $settingsTxt .= '\n define(\"IKEY\", \"' . IKEY . '\");';\n@@ -221,6 +222,7 @@\n \t}\n }\n \n+\n // Test DB connexion\n $pass = defuse_return_decrypted(DB_PASSWD);\n $server = DB_HOST;\n@@ -852,17 +854,6 @@\n \n             // Manage saltkey.txt file\n             if (empty($post_sk_path) === false || defined('SECUREPATH') === true) {\n-                /*\n-                $filename = (empty($post_sk_path) === false ? $post_sk_path : SECUREPATH).'/teampass-seckey.txt';\n-                if (file_exists($filename)) {\n-                    $newfile = str_replace('teampass-seckey.txt', time());\n-                    rename($filename, $newfile);\n-                    unlink($filename);\n-                    echo '$(\"#step5_saltkeyFile\").html(\"<i class=\\\"fa-solid fa-circle-check fa-lg text-success ml-2 mr-2\\\"></i><span class=\\\"text-info font-italic\\\">You can remove file '.$newfile.'</span>\");';\n-                } else {\n-                    echo '$(\"#step5_saltkeyFile\").html(\"<i class=\\\"fa-solid fa-circle-check fa-lg text-success ml-2 mr-2\\\"></i><span class=\\\"text-info font-italic\\\">Nothing done</span>\");';\n-                }\n-                */\n                 array_push(\n                     $returnStatus, \n                     array("
        },
        {
          "filename": "install/upgrade_run_3.0.0.php",
          "status": "modified",
          "additions": 12,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -35,6 +35,15 @@\n require_once 'tp.functions.php';\n require_once 'libs/aesctr.php';\n require_once '../includes/config/tp.config.php';\n+\n+// 3.0.0.23\n+$ret = handleSecurefileConstant();\n+if ($ret['error'] === true) {\n+    echo '[{\"finish\":\"1\", \"msg\":\"\", \"error\":\"'.$ret['message'].'\"}]';\n+    exit();\n+}\n+\n+// Get the encrypted password\n define('DB_PASSWD_CLEAR', defuse_return_decrypted(DB_PASSWD));\n \n //Build tree\n@@ -76,6 +85,8 @@\n }\n \n \n+\n+\n // Load libraries\n require_once '../includes/libraries/protect/SuperGlobal/SuperGlobal.php';\n $superGlobal = new protect\\SuperGlobal\\SuperGlobal();"
        },
        {
          "filename": "install/upgrade_run_3.0.0_fields.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0_fields.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/upgrade_run_3.0.0_files.php",
          "status": "modified",
          "additions": 2,
          "deletions": 13,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0_files.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -149,19 +149,8 @@\n         // Is this file encrypted?\n         // Force all files to be encrypted\n         if ($file_info['status'] === 'encrypted') {\n-            // load PhpEncryption library\n-            /*include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'Crypto.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'Encoding.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'DerivedKeys.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'Key.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'KeyOrPassword.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'File.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'RuntimeTests.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'KeyProtectedByPassword.php';\n-            include_once $SETTINGS['cpassman_dir'].'/includes/libraries/Encryption/Encryption/'.'Core.php';*/\n-\n             // get KEY\n-            $ascii_key = file_get_contents(SECUREPATH.'/teampass-seckey.txt');\n+            $ascii_key = file_get_contents(SECUREPATH.'/'.SECUREFILE);\n \n             // Now decrypt the file\n             $err = '';"
        },
        {
          "filename": "install/upgrade_run_3.0.0_logs.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0_logs.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/upgrade_run_3.0.0_passwords.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0_passwords.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/upgrade_run_3.0.0_suggestions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0_suggestions.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/upgrade_run_3.0.0_users.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_run_3.0.0_users.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "install/upgrade_scripts_manager.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -7,7 +7,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upgrade_scripts_manager.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "pages/2fa.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      2fa.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/2fa.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      2fa.php\n  * ---\n  *"
        },
        {
          "filename": "pages/actions.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      actions.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/actions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      actions.php\n  * ---\n  *"
        },
        {
          "filename": "pages/admin.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      admin.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/admin.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      admin.php\n  * ---\n  *"
        },
        {
          "filename": "pages/api.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      api.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/api.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      api.php\n  * ---\n  *"
        },
        {
          "filename": "pages/backups.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      backups.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/backups.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      backups.php\n  * ---\n  *"
        },
        {
          "filename": "pages/emails.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      emails.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/emails.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      emails.php\n  * ---\n  *"
        },
        {
          "filename": "pages/export.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      export.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/export.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      export.php\n  * ---\n  *"
        },
        {
          "filename": "pages/favorites.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      favorites.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/favourites.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      favourites.php\n  * ---\n  *"
        },
        {
          "filename": "pages/fields.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      fields.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/fields.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      fields.php\n  * ---\n  *"
        },
        {
          "filename": "pages/folders.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      folders.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/folders.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      folders.php\n  * ---\n  *"
        },
        {
          "filename": "pages/import.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      import.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/import.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      import.php\n  * ---\n  *"
        },
        {
          "filename": "pages/items.js.php",
          "status": "modified",
          "additions": 52,
          "deletions": 9,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      items.js.php\n  * ---\n  *\n@@ -4116,6 +4116,35 @@ function(teampassApplication) {\n     }\n \n \n+    function checkAccess(itemId, treeId, userId)\n+    {\n+        var data = {\n+            'itemId': parseInt(itemId),\n+            'treeId': parseInt(treeId),\n+            'userId': parseInt(userId),\n+        };\n+\n+        //Send query\n+        $.post(\n+            'sources/items.queries.php', {\n+                type: 'check_current_access_rights',\n+                data: prepareExchangedData(JSON.stringify(data), 'encode', '<?php echo $_SESSION['key']; ?>'),\n+                key: '<?php echo $_SESSION['key']; ?>'\n+            },\n+            function(data) {\n+                //decrypt data\n+                data = decodeQueryReturn(data, '<?php echo $_SESSION['key']; ?>', 'items.queries.php', 'show_details_item');\n+                requestRunning = true;\n+                if (debugJavascript === true) {\n+                    console.log(\"DEBUG: checkAccess\");\n+                    console.log(data);\n+                }\n+\n+\n+                return false;\n+            }\n+        );\n+    }\n \n \n     /**\n@@ -4124,14 +4153,6 @@ function(teampassApplication) {\n     function Details(itemDefinition, actionType, hotlink = false) {\n         if (debugJavascript === true) console.info('EXPECTED ACTION on ' + itemDefinition + ' is ' + actionType + ' -- ')\n \n-        // Store current view\n-        savePreviousView();\n-        \n-        if (debugJavascript === true) console.log(\"Request is running: \" + requestRunning)\n-\n-        // Store status query running\n-        requestRunning = true;\n-\n         // Init\n         if (hotlink === false) {\n             var itemId = parseInt($(itemDefinition).data('item-id')) || '';\n@@ -4155,6 +4176,28 @@ function Details(itemDefinition, actionType, hotlink = false) {\n             var itemRights = parseInt($(itemDefinition).data('item-rights')) || 10;\n         }\n \n+        // check if user still has access\n+        if (checkAccess(itemId, itemTreeId, <?php echo $_SESSION['user_id']; ?>) === false) {\n+            toastr.remove();\n+            toastr.warning(\n+                '<?php echo langHdl('no_item_to_display'); ?>',\n+                '', {\n+                    timeOut: 5000,\n+                    progressBar: true\n+                }\n+            );\n+\n+            // Finished\n+            return false;\n+        }\n+\n+        // Store current view\n+        savePreviousView();\n+        \n+        if (debugJavascript === true) console.log(\"Request is running: \" + requestRunning)\n+\n+        // Store status query running\n+        requestRunning = true;\n         userDidAChange = false;\n \n         // Select tab#1"
        },
        {
          "filename": "pages/items.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      items.php\n  * ---\n  *"
        },
        {
          "filename": "pages/kb.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      kb.php\n  * ---\n  *"
        },
        {
          "filename": "pages/ldap.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      ldap.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/ldap.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      ldap.php\n  * ---\n  *"
        },
        {
          "filename": "pages/offline.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      offline.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/offline.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      offline.php\n  * ---\n  *"
        },
        {
          "filename": "pages/options.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      options.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/options.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      options.php\n  * ---\n  *"
        },
        {
          "filename": "pages/profile.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      profile.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/profile.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      profile.php\n  * ---\n  *"
        },
        {
          "filename": "pages/roles.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      roles.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/roles.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      roles.php\n  * ---\n  *"
        },
        {
          "filename": "pages/search.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n   * ---\n   *\n   * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n   *\n   * @file      search.js.php\n   * ---"
        },
        {
          "filename": "pages/search.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      search.php\n  * ---\n  *"
        },
        {
          "filename": "pages/special.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      special.php\n  * ---\n  *"
        },
        {
          "filename": "pages/statistics.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      statistics.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/statistics.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      statistics.php\n  * ---\n  *"
        },
        {
          "filename": "pages/suggestion.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      suggestion.php\n  * ---\n  *"
        },
        {
          "filename": "pages/tasks.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      tasks.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/tasks.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      tasks.php\n  * ---\n  *"
        },
        {
          "filename": "pages/uploads.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      uploads.js.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "pages/uploads.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      uploads.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "pages/users.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      users.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/users.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      users.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.database.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.database.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.database.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.database.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.deletion.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.deletion.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.deletion.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.deletion.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.logs.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.logs.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.logs.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.logs.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.renewal.js.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.renewal.js.php\n  * ---\n  *"
        },
        {
          "filename": "pages/utilities.renewal.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.renewal.php\n  * ---\n  *"
        },
        {
          "filename": "sources/admin.queries.php",
          "status": "modified",
          "additions": 14,
          "deletions": 14,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      admin.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -1048,7 +1048,7 @@\n         // Check KEY\n         if ($post_key !== $_SESSION['key']) {\n             echo prepareExchangedData(\n-    $SETTINGS['cpassman_dir'],\n+                $SETTINGS['cpassman_dir'],\n                 array(\n                     'error' => true,\n                     'message' => langHdl('key_is_not_correct'),\n@@ -1060,7 +1060,7 @@\n         // Is admin?\n         if ($_SESSION['is_admin'] === true) {\n             echo prepareExchangedData(\n-    $SETTINGS['cpassman_dir'],\n+                $SETTINGS['cpassman_dir'],\n                 array(\n                     'error' => true,\n                     'message' => langHdl('error_not_allowed_to'),\n@@ -1074,22 +1074,22 @@\n         require_once 'main.functions.php';\n \n         // store old sk\n-        $_SESSION['reencrypt_old_salt'] = file_get_contents(SECUREPATH . '/teampass-seckey.txt');\n+        $_SESSION['reencrypt_old_salt'] = file_get_contents(SECUREPATH.'/'.SECUREFILE);\n \n         // generate new saltkey\n-        $old_sk_filename = SECUREPATH . '/teampass-seckey.txt.' . date('Y_m_d', mktime(0, 0, 0, (int) date('m'), (int) date('d'), (int) date('y'))) . '.' . time();\n+        $old_sk_filename = SECUREPATH.'/'.SECUREFILE . date('Y_m_d', mktime(0, 0, 0, (int) date('m'), (int) date('d'), (int) date('y'))) . '.' . time();\n         copy(\n-            SECUREPATH . '/teampass-seckey.txt',\n+            SECUREPATH.'/'.SECUREFILE,\n             $old_sk_filename\n         );\n         $new_key = defuse_generate_key();\n         file_put_contents(\n-            SECUREPATH . '/teampass-seckey.txt',\n+            SECUREPATH.'/'.SECUREFILE,\n             $new_key\n         );\n \n         // store new sk\n-        $_SESSION['reencrypt_new_salt'] = file_get_contents(SECUREPATH . '/teampass-seckey.txt');\n+        $_SESSION['reencrypt_new_salt'] = file_get_contents(SECUREPATH.'/'.SECUREFILE);\n \n         //put tool in maintenance.\n         DB::update(\n@@ -1592,7 +1592,7 @@\n \n         // Send back\n         echo prepareExchangedData(\n-    $SETTINGS['cpassman_dir'],\n+            $SETTINGS['cpassman_dir'],\n             array(\n                 'error' => false,\n                 'message' => '',\n@@ -1609,7 +1609,7 @@\n         // Check KEY\n         if ($post_key !== $_SESSION['key']) {\n             echo prepareExchangedData(\n-    $SETTINGS['cpassman_dir'],\n+                $SETTINGS['cpassman_dir'],\n                 array(\n                     'error' => true,\n                     'message' => langHdl('key_is_not_correct'),\n@@ -1621,7 +1621,7 @@\n         // Is admin?\n         if ($_SESSION['is_admin'] === true) {\n             echo prepareExchangedData(\n-    $SETTINGS['cpassman_dir'],\n+                $SETTINGS['cpassman_dir'],\n                 array(\n                     'error' => true,\n                     'message' => langHdl('error_not_allowed_to'),\n@@ -1660,10 +1660,10 @@\n \n         // restore saltkey file\n         if (file_exists($previous_saltkey_filename)) {\n-            unlink(SECUREPATH . '/teampass-seckey.txt');\n+            unlink(SECUREPATH.'/'.SECUREFILE);\n             rename(\n                 $previous_saltkey_filename,\n-                SECUREPATH . '/teampass-seckey.txt'\n+                SECUREPATH.'/'.SECUREFILE\n             );\n         }\n \n@@ -1672,7 +1672,7 @@\n \n         // Send back\n         echo prepareExchangedData(\n-    $SETTINGS['cpassman_dir'],\n+            $SETTINGS['cpassman_dir'],\n             array(\n                 'error' => false,\n                 'message' => '',"
        },
        {
          "filename": "sources/aes.functions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      aes.functions.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/background.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      users.background.php\n  * ---\n  *"
        },
        {
          "filename": "sources/backups.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      backups.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/checks.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      checks.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/core.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      core.php\n  * ---\n  *"
        },
        {
          "filename": "sources/downloadFile.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      downloadFile.php\n  * ---\n  *"
        },
        {
          "filename": "sources/expired.datatables.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      expired.datatables.php\n  * ---\n  *"
        },
        {
          "filename": "sources/export.queries.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      export.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -251,7 +251,7 @@\n                                     'email' => $record['email'] !== 'none' ? (is_null($record['email']) === false ? cleanStringForExport($record['email']) : '') : '',\n                                     'kbs' => implode(' | ', $arr_kbs),\n                                     'tags' => implode(' ', $arr_tags),\n-                                    'folder' => implode(' > ', $arr_trees),\n+                                    'folder' => implode('/', $arr_trees),\n                                 );\n                                 ++$i;\n "
        },
        {
          "filename": "sources/favourites.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      favourites.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/fields.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      fields.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/find.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      find.queries.php\n  * ---\n  *"
        },
        {
          "filename": "sources/folders.datatable.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      folders.datatable.php\n  * ---\n  *"
        },
        {
          "filename": "sources/folders.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      folders.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/identify.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      identify.php\n  * ---\n  *"
        },
        {
          "filename": "sources/import.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      import.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/items.logs.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      items.logs.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/items.queries.php",
          "status": "modified",
          "additions": 68,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      items.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -6005,6 +6005,7 @@\n                 break;\n             }\n             $arr_data = [];\n+            $arr_folders = [];\n \n             // decrypt and retreive data in JSON format\n             $dataReceived = prepareExchangedData(\n@@ -6125,6 +6126,7 @@\n                         $arr_data['folders'][$inc]['disabled'] = $disabled;\n                         $arr_data['folders'][$inc]['parent_id'] = (int) $folder->parent_id;\n                         $arr_data['folders'][$inc]['perso'] = (int) $folder->personal_folder;\n+                        //array_push($arr_folders, (int) $folder->id);\n \n                         // Is this folder an active folders? (where user can do something)\n                         $is_visible_active = 0;\n@@ -6140,6 +6142,7 @@\n                     }\n                 }\n             }\n+            /*\n             if (isset($arr_data['folders']) === true) {\n                 // save to cache_tree\n                 cacheTreeUserHandler(\n@@ -6148,7 +6151,16 @@\n                     $SETTINGS,\n                     'visible_folders',\n                 );\n+\n+                // save to cache_tree\n+                cacheTreeUserHandler(\n+                    (int) $_SESSION['user_id'],\n+                    json_encode($arr_folders),\n+                    $SETTINGS,\n+                    'folders',\n+                );\n             }\n+            */\n \n             // send data\n             echo (string) prepareExchangedData(\n@@ -6788,6 +6800,61 @@\n                 'encode'\n             );\n \n+            break;\n+\n+        /*\n+        * CASE\n+        * check_current_access_rights\n+        */\n+        case 'check_current_access_rights':\n+            // Check KEY\n+            if ($inputData['key'] !== $_SESSION['key']) {\n+                echo (string) prepareExchangedData(\n+                    $SETTINGS['cpassman_dir'],\n+                    array(\n+                        'error' => 'key_not_conform',\n+                        'message' => langHdl('key_is_not_correct'),\n+                    ),\n+                    'encode'\n+                );\n+                break;\n+            }\n+            // decrypt and retrieve data in JSON format\n+            $dataReceived = prepareExchangedData(\n+                $SETTINGS['cpassman_dir'],\n+                $inputData['data'],\n+                'decode'\n+            );\n+\n+            // prepare variables\n+            $inputData['userId'] = (int) filter_var($dataReceived['userId'], FILTER_SANITIZE_NUMBER_INT);\n+            $inputData['itemId'] = (int) filter_var($dataReceived['itemId'], FILTER_SANITIZE_NUMBER_INT);\n+            $inputData['treeId'] = (int) filter_var($dataReceived['treeId'], FILTER_SANITIZE_NUMBER_INT);\n+\n+            $data = DB::queryFirstRow(\n+                'SELECT visible_folders\n+                FROM ' . prefixTable('cache_tree') . ' WHERE user_id = %i',\n+                $inputData['userId']\n+            );\n+            // Check if tree ID is in visible folders.\n+            if (null !== $data['visible_folders']) {\n+                $arr = json_decode($data['visible_folders'], true);\n+                $ids = array_column($arr, 'id');\n+            }\n+\n+\n+            $data = array(\n+                'error' => false,\n+                'access' => isset($inputData['treeId']) === true && in_array($inputData['treeId'], $ids) === true ? true : false,\n+            );\n+\n+            // send data\n+            echo (string) prepareExchangedData(\n+                $SETTINGS['cpassman_dir'],\n+                $data,\n+                'encode'\n+            );\n+\n             break;\n     }\n }"
        },
        {
          "filename": "sources/ldap.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      ldap.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/logs.datatables.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      logs.datatables.php\n  * ---\n  *"
        },
        {
          "filename": "sources/main.functions.php",
          "status": "modified",
          "additions": 7,
          "deletions": 7,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      main.functions.php\n  * ---\n  *\n@@ -125,7 +125,7 @@ function bCrypt(\n  */\n function cryption(string $message, string $ascii_key, string $type, ?array $SETTINGS = []): array\n {\n-    $ascii_key = empty($ascii_key) === true ? file_get_contents(SECUREPATH . '/teampass-seckey.txt') : $ascii_key;\n+    $ascii_key = empty($ascii_key) === true ? file_get_contents(SECUREPATH.'/'.SECUREFILE) : $ascii_key;\n     $err = false;\n     \n     $path = __DIR__.'/../includes/libraries/Encryption/Encryption/';\n@@ -637,7 +637,7 @@ function identUser(\n     foreach ($rows as $record) {\n         //if (isset($record['id_tree'])) {\n             $foldersLimited[$record['id_tree']][$inc] = $record['item_id'];\n-            array_push($foldersLimitedFull, $record['item_id']);\n+            array_push($foldersLimitedFull, $record['id_tree']);\n             ++$inc;\n         //}\n     }\n@@ -651,7 +651,7 @@ function identUser(\n         $noAccessPersonalFolders,\n         $foldersLimitedFull,\n         $allowedFoldersByRoles,\n-        $restrictedFoldersForItems,\n+        array_keys($restrictedFoldersForItems),\n         $readOnlyFolders,\n         $noAccessFolders,\n         isset($SETTINGS['enable_pf_feature']) === true ? $SETTINGS['enable_pf_feature'] : 0,\n@@ -1293,7 +1293,7 @@ function prepareSendingEmail(\n                     'receivers' => $email,\n                     'body' => $body,\n                     'receiver_name' => $receiverName,\n-                ]),\n+                ], JSON_HEX_QUOT | JSON_HEX_TAG),\n                 'updated_at' => '',\n                 'finished_at' => '',\n                 'output' => '',\n@@ -1433,7 +1433,7 @@ function buildEmail(\n     foreach (array_filter(explode(',', $email)) as $dest) {\n         $mail->addAddress($dest);\n     }\n-\n+    \n     // Prepare HTML\n     $text_html = emailBody($textMail);\n     $mail->WordWrap = 80;\n@@ -2301,7 +2301,7 @@ function prepareFileWithDefuse(\n     $target_file = $antiXss->xss_clean($target_file);\n     if (empty($password) === true || is_null($password) === true) {\n         // get KEY to define password\n-        $ascii_key = file_get_contents(SECUREPATH . '/teampass-seckey.txt');\n+        $ascii_key = file_get_contents(SECUREPATH.'/'.SECUREFILE);\n         $password = \\Defuse\\Crypto\\Key::loadFromAsciiSafeString($ascii_key);\n     }\n "
        },
        {
          "filename": "sources/main.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      main.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/roles.queries.php",
          "status": "modified",
          "additions": 35,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      roles.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -251,6 +251,40 @@\n                 }\n             }\n \n+            /*\n+            // update folders rights for users in cache_tree\n+            // Requested for real-time changes\n+            $rows = DB::query(\n+                'SELECT increment_id, folders\n+                FROM ' . prefixTable('cache_tree'),\n+            );\n+\n+            foreach($rows as $row) {\n+                if ($row['folders'] === '' || $post_selectedFolders === null) {\n+                    continue;\n+                }\n+                // get visible folders\n+                $arr = json_decode($row['folders'], true);\n+                \n+                foreach($arr as $folder) {\n+                    if (in_array($folder, $post_selectedFolders) === true) {\n+                        unset($arr[$folder]);\n+                    }\n+                }\n+                print_r($arr);\n+\n+                // update\n+                /*DB::update(\n+                    prefixTable('cache_tree'),\n+                    array(\n+                        'folders' => json_encode($arr),\n+                    ),\n+                    'increment_id = %i',\n+                    $row['increment_id']\n+                );*/\n+            }\n+            */\n+\n             echo prepareExchangedData(\n                 $SETTINGS['cpassman_dir'],\n                 array("
        },
        {
          "filename": "sources/scheduler.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      scheduler.php\n  * ---\n  *"
        },
        {
          "filename": "sources/tree.php",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      tree.php\n  *\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)\n@@ -251,8 +251,17 @@ function showFolderToUser(\n     array $listRestrictedFoldersForItemsKeys\n ): bool\n {\n-    $big_array = array_diff(array_unique(array_merge($session_groupes_visibles, $listFoldersLimitedKeys, $listRestrictedFoldersForItemsKeys), SORT_NUMERIC), $session_forbiden_pfs);\n-    //print_r($session_groupes_visibles);\n+    $big_array = array_diff(\n+        array_unique(\n+            array_merge(\n+                $session_groupes_visibles, \n+                $listFoldersLimitedKeys, \n+                $listRestrictedFoldersForItemsKeys\n+            ), \n+            SORT_NUMERIC\n+        ), \n+        $session_forbiden_pfs\n+    );\n     if ($nodeId === 0 || in_array($nodeId, $big_array) === true) {\n         return true;\n     }"
        },
        {
          "filename": "sources/upload.attachments.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upload.attachments.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/upload.files.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      upload.files.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/user.logs.datatables.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      user.logs.datatables.php\n  * ---\n  *"
        },
        {
          "filename": "sources/users.datatable.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n  * ---\n  *\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      users.datatable.php\n  * ---\n  *"
        },
        {
          "filename": "sources/users.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      users.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/utilities.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utilities.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        },
        {
          "filename": "sources/utils.queries.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n  *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n  * ---\n  * @project   Teampass\n- * @version   3.0.0.22\n+ * @version   3.0.0.23\n  * @file      utils.queries.php\n  * ---\n  * @author    Nils Laumaill\u00e9 (nils@teampass.net)"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 8,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aacdf6a3f2daf9b52a826d4b3d8a39873e2e2062",
            "date": "2025-01-13T17:24:23Z",
            "author_login": "nilsteampassnet"
          },
          {
            "sha": "eb95bc3e37f6e1f19fce98aa4c44c251f2084cd7",
            "date": "2025-01-13T17:20:31Z",
            "author_login": "nilsteampassnet"
          },
          {
            "sha": "9969d0ef636e28c1afcdb047aac2d2a5387b62b5",
            "date": "2025-01-12T17:29:37Z",
            "author_login": "nilsteampassnet"
          },
          {
            "sha": "4963736272bc4b281586f8ad4dcee70015d595b1",
            "date": "2025-01-12T17:22:24Z",
            "author_login": "nilsteampassnet"
          },
          {
            "sha": "b5a997952a43e4760c9eaceedfd9a7ba4a5683d2",
            "date": "2025-01-10T16:06:22Z",
            "author_login": "nilsteampassnet"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:H",
    "cwe_id": "CWE-73",
    "description": "External Control of File Name or Path in GitHub repository nilsteampassnet/teampass prior to 3.0.0.22.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-27T16:15:12.697",
    "last_modified": "2024-11-21T07:38:24.080",
    "fix_date": "2023-02-14T07:01:35Z"
  },
  "references": [
    {
      "url": "https://github.com/nilsteampassnet/teampass/commit/0af3574caba27a61b16dc25c94fa51ae12d2d967",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/318bfdc4-7782-4979-956f-9ba2cc44889c",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nilsteampassnet/teampass/commit/0af3574caba27a61b16dc25c94fa51ae12d2d967",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/318bfdc4-7782-4979-956f-9ba2cc44889c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.780526",
    "processing_status": "enhanced"
  }
}