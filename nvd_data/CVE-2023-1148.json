{
  "cve_id": "CVE-2023-1148",
  "github_data": {
    "repository": "flatpressblog/flatpress",
    "fix_commit": "3a32aad0dec5df24c6576d7567d4f2eadbfc75de",
    "related_commits": [
      "3a32aad0dec5df24c6576d7567d4f2eadbfc75de",
      "3a32aad0dec5df24c6576d7567d4f2eadbfc75de"
    ],
    "patch_url": "https://github.com/flatpressblog/flatpress/commit/3a32aad0dec5df24c6576d7567d4f2eadbfc75de.patch",
    "fix_commit_details": {
      "sha": "3a32aad0dec5df24c6576d7567d4f2eadbfc75de",
      "commit_date": "2022-12-29T20:21:16Z",
      "author": {
        "login": "azett",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fixes #183",
        "length": 10,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 274,
        "additions": 166,
        "deletions": 108
      },
      "files": [
        {
          "filename": "admin/panels/config/admin.config.php",
          "status": "modified",
          "additions": 166,
          "deletions": 108,
          "patch": "@@ -1,115 +1,173 @@\n <?php\n \n-\tclass admin_config extends AdminPanel {\n-\t\tvar $panelname = 'config';\n-\t}\n- \t\n-\tclass admin_config_default extends AdminPanelActionValidated {\n-\t\t\n-\t\tvar $validators = array(\n-\t\t\t// not needed anymore !\n-\t\t\t// array('blog_root', 'blog_root', 'notEmpty', false, false, 'trim'),\n-\t\t\tarray('www', 'www', 'notEmpty', false, false, 'trim'),\n-\t\t\t// ...\n-\t\t\tarray('title', 'title', 'notEmpty', false, false, 'trim'),\n-\t\t\t//array('subtitle', 'subtitle', 'notEmpty', false, false, 'trim'),\n-\t\t\t//array('blogfooter', 'blogfooter', 'notEmpty', false, false, 'trim'),\n-\t\t\tarray('email', 'email', 'isEmail', false, false, 'trim'),\n-\t\t\tarray('maxentries', 'maxentries', 'isInt', false, false, 'trim'),\n-\t\t\t\n-\t\t\tarray('timeoffset', 'timeoffset', 'isNumber', false, false, 'trim'),\n-\t\t\tarray('timeformat', 'timeformat', 'notEmpty', false, false, 'trim'),\n-\t\t\tarray('dateformat', 'dateformat', 'notEmpty', false, false, 'trim'),\n-\t\t\tarray('dateformatshort', 'dateformatshort', 'notEmpty', false, false, 'trim'),\n-\t\t\t\n-\t\t\tarray('lang', 'lang', 'notEmpty', false, false, 'trim'),\n-\t\t\tarray('charset', 'charset', 'notEmpty', false, false, 'trim'),\n-\t\t\t\n-\t\t\t\n-\t\t);\n-\t\t\n-\t\t var $events = array('save');\n-\t\t\n-\t\n-\t\tfunction setup() {\n-\t\t\t$this->smarty->assign('themes', theme_list());\n-\t\t\t$this->smarty->assign('lang_list', lang_list());\n-\t\t\t\n-\t\t\t$static_list = array();\n-\t\t\t\n-\t\t\tforeach(static_getlist() as $id) {\n-\t\t\t\t$static_list[$id] = static_parse($id);\n-\t\t\t}\n-\t\t\t\n-\t\t\t$this->smarty->assign('static_list', $static_list);\n-\t\t\t\n+class admin_config extends AdminPanel {\n+\n+\tvar $panelname = 'config';\n+\n+}\n+\n+class admin_config_default extends AdminPanelActionValidated {\n+\n+\tvar $validators = array(\n+\t\t// not needed anymore !\n+\t\t// array('blog_root', 'blog_root', 'notEmpty', false, false, 'trim'),\n+\t\tarray(\n+\t\t\t'www',\n+\t\t\t'www',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\t// ...\n+\t\tarray(\n+\t\t\t'title',\n+\t\t\t'title',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\t// array('subtitle', 'subtitle', 'notEmpty', false, false, 'trim'),\n+\t\t// array('blogfooter', 'blogfooter', 'notEmpty', false, false, 'trim'),\n+\t\tarray(\n+\t\t\t'email',\n+\t\t\t'email',\n+\t\t\t'isEmail',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\tarray(\n+\t\t\t'maxentries',\n+\t\t\t'maxentries',\n+\t\t\t'isInt',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\n+\t\tarray(\n+\t\t\t'timeoffset',\n+\t\t\t'timeoffset',\n+\t\t\t'isNumber',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\tarray(\n+\t\t\t'timeformat',\n+\t\t\t'timeformat',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\tarray(\n+\t\t\t'dateformat',\n+\t\t\t'dateformat',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\tarray(\n+\t\t\t'dateformatshort',\n+\t\t\t'dateformatshort',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\n+\t\tarray(\n+\t\t\t'lang',\n+\t\t\t'lang',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t),\n+\t\tarray(\n+\t\t\t'charset',\n+\t\t\t'charset',\n+\t\t\t'notEmpty',\n+\t\t\tfalse,\n+\t\t\tfalse,\n+\t\t\t'trim'\n+\t\t)\n+\t);\n+\n+\tvar $events = array(\n+\t\t'save'\n+\t);\n+\n+\tfunction setup() {\n+\t\t$this->smarty->assign('themes', theme_list());\n+\t\t$this->smarty->assign('lang_list', lang_list());\n+\n+\t\t$static_list = array();\n+\n+\t\tforeach (static_getlist() as $id) {\n+\t\t\t$static_list [$id] = static_parse($id);\n \t\t}\n-\t\t\n-\t\t\n-\t\tfunction onsave() {\n-\t\t\n-\t\t\tglobal $fp_config;\n-\t\t\t$l = explode(',',$_POST['lang']);\n-\t\t\t$fp_config['general'] = array(\n-\t\t\t//'BLOG_ROOT'\t=> $_POST['blog_root'],\n-\t\t\t\t'www'\t=> $_POST['www'],\n-\t\t\t\t'title' => html_entity_decode(stripslashes($_POST['title'])),\n-\t\t\t\t'subtitle' => html_entity_decode(stripslashes($_POST['subtitle'])),\n-\t\t\t\t'footer' => html_entity_decode(stripslashes($_POST['blogfooter'])),\n-\t\t\t\t'author' => $_POST['author'],\n-\t\t\t\t'email' => $_POST['email'],\n-\t\t\t\t'startpage' => ($_POST['startpage'] == ':NULL:')? null : $_POST['startpage'],\n-\t\t\t\t'maxentries' => $_POST['maxentries'],\n-\t\t\t\t// 'voting' => $_POST['voting'],\n-\t\t\t\t'notify' => isset($_POST['notify']),\n+\n+\t\t$this->smarty->assign('static_list', $static_list);\n+\t}\n+\n+\tfunction onsave() {\n+\t\tglobal $fp_config;\n+\t\t$l = explode(',', $_POST ['lang']);\n+\t\t$fp_config ['general'] = array(\n+\t\t\t// 'BLOG_ROOT' => $_POST['blog_root'],\n+\t\t\t'www' => $_POST ['www'],\n+\t\t\t'title' => wp_specialchars(stripslashes($_POST ['title'])),\n+\t\t\t'subtitle' => wp_specialchars(stripslashes($_POST ['subtitle'])),\n+\t\t\t'footer' => wp_specialchars(stripslashes($_POST ['blogfooter'])),\n+\t\t\t'author' => $_POST ['author'],\n+\t\t\t'email' => $_POST ['email'],\n+\t\t\t'startpage' => ($_POST ['startpage'] == ':NULL:') ? null : $_POST ['startpage'],\n+\t\t\t'maxentries' => $_POST ['maxentries'],\n+\t\t\t// 'voting' => $_POST['voting'],\n+\t\t\t'notify' => isset($_POST ['notify']),\n \t\t\t\t/* preserve the following */\n-\t\t\t\t'theme'\t=> $fp_config['general']['theme'],\n-\t\t\t\t'style'\t=> @$fp_config['general']['style'],\n-\t\t\t\t'blogid' => $fp_config['general']['blogid'],\n-\t\t\t\t'charset'=> 'utf-8',\n-\t\n-\t\t\t);\n-\t\t\t\n-\t\t\t$fp_config['locale'] = array(\n-\t\t\t\t'timeoffset' => $_POST['timeoffset'],\n-\t\t\t\t'timeformat' => $_POST['timeformat'],\n-\t\t\t\t'dateformat' => $_POST['dateformat'],\n-\t\t\t\t'dateformatshort' => $_POST['dateformatshort'],\n-\t\t\t\t'charset'\t => $_POST['charset'],\n-\t\t\t\t'lang'\t\t => $_POST['lang']\n-\t\t\t);\n-\t\t\t\n-\n-\t\t\t// 'LANG'\t=> $l[0],\n-\t\t\t// 'CHARSET'=> $l[1],\n-\t\n-\t\t\t\n-\t\t\t\t\n-\n-\t\t\t\n-\t\t\t$success = config_save()? 1: -1;\n-\t\t\t\n-\t\t\t$this->smarty->assign('success', $success);\n-\t\t\t\n-\t\t\treturn 1;\n-\t\t\t\n-\t\t}\n-\t\t\n-\t\tfunction onerror() {\n-\t\t\t$this->main();\n-\t\t\treturn 0;\t\n-\t\t}\n-\t\t\n-\t\tfunction cleartplcache() {\n-\t\t\t\t// if theme was switched, clear tpl cache\n-\t\t\t\n-\t\t\t\t$tpl = new tpl_deleter();\n-\t\t\t\t\n-\t\t\t\t$tpl->getList();\n-\t\t\t\t\n-\t\t\t\t\n-\t\t}\n+\t\t\t\t'theme' => $fp_config ['general'] ['theme'],\n+\t\t\t'style' => @$fp_config ['general'] ['style'],\n+\t\t\t'blogid' => $fp_config ['general'] ['blogid'],\n+\t\t\t'charset' => 'utf-8'\n+\t\t);\n+\n+\t\t$fp_config ['locale'] = array(\n+\t\t\t'timeoffset' => $_POST ['timeoffset'],\n+\t\t\t'timeformat' => $_POST ['timeformat'],\n+\t\t\t'dateformat' => $_POST ['dateformat'],\n+\t\t\t'dateformatshort' => $_POST ['dateformatshort'],\n+\t\t\t'charset' => $_POST ['charset'],\n+\t\t\t'lang' => $_POST ['lang']\n+\t\t);\n+\n+\t\t// 'LANG' => $l[0],\n+\t\t// 'CHARSET'=> $l[1],\n+\n+\t\t$success = config_save() ? 1 : -1;\n+\n+\t\t$this->smarty->assign('success', $success);\n \n+\t\treturn 1;\n \t}\n-\t\n+\n+\tfunction onerror() {\n+\t\t$this->main();\n+\t\treturn 0;\n+\t}\n+\n+\tfunction cleartplcache() {\n+\t\t// if theme was switched, clear tpl cache\n+\t\t$tpl = new tpl_deleter();\n+\n+\t\t$tpl->getList();\n+\t}\n+\n+}\n+\n ?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f200970261993130d581f447cfcb3aa20fa11e64",
            "date": "2025-01-13T17:34:18Z",
            "author_login": "azett"
          },
          {
            "sha": "73b4cd5bb38d78b5db79ea65702725d3b51ac3bb",
            "date": "2025-01-13T01:06:44Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "447cf24a4d06d4b34679c7af6046c7f06e67b168",
            "date": "2025-01-13T00:21:04Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "e16c81caef23f89818633d0404db6241eb76537a",
            "date": "2025-01-13T00:19:55Z",
            "author_login": "Fraenkiman"
          },
          {
            "sha": "6193e7df40faf9e6d9b711985789de304a021e93",
            "date": "2025-01-12T14:34:52Z",
            "author_login": "azett"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository flatpressblog/flatpress prior to 1.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-02T03:15:09.910",
    "last_modified": "2024-11-21T07:38:33.160",
    "fix_date": "2022-12-29T20:21:16Z"
  },
  "references": [
    {
      "url": "https://github.com/flatpressblog/flatpress/commit/3a32aad0dec5df24c6576d7567d4f2eadbfc75de",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/f0cc2c4b-fdf9-483b-9a83-4e0dfeb4dac7",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flatpressblog/flatpress/commit/3a32aad0dec5df24c6576d7567d4f2eadbfc75de",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/f0cc2c4b-fdf9-483b-9a83-4e0dfeb4dac7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.793766",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "flatpress",
    "owner": "flatpressblog",
    "created_at": "2013-09-16T07:49:11Z",
    "updated_at": "2025-01-13T17:34:22Z",
    "pushed_at": "2025-01-13T17:34:18Z",
    "size": 10704,
    "stars": 188,
    "forks": 57,
    "open_issues": 29,
    "watchers": 188,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 3133798,
      "JavaScript": 142691,
      "Smarty": 118053,
      "CSS": 99012,
      "Yacc": 40745,
      "HTML": 32532,
      "Shell": 964
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:55:36.605095"
  }
}