{
  "cve_id": "CVE-2023-1212",
  "github_data": {
    "repository": "phpipam/phpipam",
    "fix_commit": "78e0470100a6cb143fe9af2e336dce80e4620960",
    "related_commits": [
      "78e0470100a6cb143fe9af2e336dce80e4620960",
      "78e0470100a6cb143fe9af2e336dce80e4620960"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "78e0470100a6cb143fe9af2e336dce80e4620960",
      "commit_date": "2023-03-06T21:08:01Z",
      "author": {
        "login": "GaryAllan",
        "type": "User",
        "stats": {
          "total_commits": 877,
          "average_weekly_commits": 1.7435387673956262,
          "total_additions": 33025,
          "total_deletions": 58367,
          "weeks_active": 195
        }
      },
      "commit_message": {
        "title": "Bugfix: XSS (stored) in user widget settings",
        "length": 76,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 21,
        "additions": 11,
        "deletions": 10
      },
      "files": [
        {
          "filename": "app/dashboard/index.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -118,8 +118,8 @@\n $m=0;\t\t\t\t\t\t\t//to calculate chunk index\n \n foreach($uwidgets as $uk=>$uv) {\n-\t//get fetails\n-\t$wdet = (array) $widgets[$uv];\n+\t//get details\n+\t$wdet = isset($widgets[$uv]) ? (array) $widgets[$uv] : ['wsize' => 6];\n \tif(is_blank($wdet['wsize']))\t{ $wsize = 6; }\n \telse\t\t\t\t\t\t\t{ $wsize = $wdet['wsize']; }\n \n@@ -148,18 +148,18 @@\n \tforeach($uwidgetschunk as $w) {\n \t\t# print itams in a row\n \t\tforeach($w as $c) {\n-\n \t\t\t/* print items */\n-\t\t\t$wdet = (array) $widgets[$c];\n \t\t\tif(array_key_exists($c, $widgets)) {\n+\t\t\t\t$wdet = (array) $widgets[$c];\n+\n \t\t\t\t//reset size if not set\n \t\t\t\tif(is_blank($wdet['wsize']))\t{ $wdet['wsize'] = 6; }\n \n-\t\t\t\tprint \"\t<div class='col-xs-12 col-sm-12 col-md-12 col-lg-$wdet[wsize] widget-dash' id='w-$wdet[wfile]'>\";\n+\t\t\t\tprint \"\t<div class='col-xs-12 col-sm-12 col-md-12 col-lg-\".escape_input($wdet['wsize']).\" widget-dash' id='w-\".escape_input($wdet['wfile']).\"'>\";\n \t\t\t\tprint \"\t<div class='inner'><i class='fa fa-times remove-widget icon-action fa-gray pull-right'></i>\";\n \t\t\t\t// href?\n-\t\t\t\tif($wdet['whref']==\"yes\")\t{ print \"<a href='\".create_link(\"widgets\",$wdet['wfile']).\"'> <h4>\"._($wdet['wtitle']).\"<i class='fa fa-external-link fa-gray pull-right'></i></h4></a>\"; }\n-\t\t\t\telse\t\t\t\t\t\t{ print \"<h4>\"._($wdet['wtitle']).\"</h4>\"; }\n+\t\t\t\tif($wdet['whref']==\"yes\")\t{ print \"<a href='\".create_link(\"widgets\",$wdet['wfile']).\"'> <h4>\"._(escape_input($wdet['wtitle'])).\"<i class='fa fa-external-link fa-gray pull-right'></i></h4></a>\"; }\n+\t\t\t\telse\t\t\t\t\t\t{ print \"<h4>\"._(escape_input($wdet['wtitle'])).\"</h4>\"; }\n \t\t\t\tprint \"\t\t<div class='hContent'>\";\n \t\t\t\tprint \"\t\t\t<div style='text-align:center;padding-top:50px;'><strong>\"._('Loading widget').\"</strong><br><i class='fa fa-spinner fa-spin'></i></div>\";\n \t\t\t\tprint \"\t\t</div>\";\n@@ -169,9 +169,9 @@\n \t\t\t}\n \t\t\t# invalid widget\n \t\t\telse {\n-\t\t\t\tprint \"\t<div class='col-xs-12 col-sm-12 col-md-12 col-lg-6' id='w-$c'>\";\n+\t\t\t\tprint \"\t<div class='col-xs-12 col-sm-12 col-md-12 col-lg-6' id='w-\".escape_input($c).\"'>\";\n \t\t\t\tprint \"\t<div class='inner'>\";\n-\t\t\t\tprint \"\t\t<blockquote style='margin-top:20px;margin-left:20px;'><p>Invalid widget $c</p></blockquote>\";\n+\t\t\t\tprint \"\t\t<blockquote style='margin-top:20px;margin-left:20px;'><p>Invalid widget \".escape_input($c).\"</p></blockquote>\";\n \t\t\t\tprint \"\t</div>\";\n \t\t\t\tprint \"\t</div>\";\n \t\t\t}"
        },
        {
          "filename": "functions/classes/class.Common.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -674,7 +674,7 @@ public function noxss_html($html) {\n \t\t\tif ($dom->loadHTML(\"<html>\".$html.\"</html>\", LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD | LIBXML_NOBLANKS | LIBXML_NOWARNING | LIBXML_NOERROR) === false)\n \t\t\t\treturn \"\";\n \n-\t\t\t$banned_elements = ['script', 'iframe', 'embed'];\n+\t\t\t$banned_elements = ['script', 'iframe', 'embed', 'object'];\n \t\t\t$remove_elements = [];\n \n \t\t\t$elements = $dom->getElementsByTagName('*');"
        },
        {
          "filename": "misc/CHANGELOG",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -12,6 +12,7 @@\n     + XSS (reflected) in 'bw-calulator-result.php';\n     + XSS (reflected) by invalid email address response;\n     + XSS (reflected) by /app/tools/subnet-masks/popup.php (#3738);\n+    + XSS (stored) in user widget settings;\n     + XSS and LDAP injection in ad-search-result.php;\n     + XSS and LDAP injection in ad-search-group-result.php;\n     + Restrict find_full_subnets.php to CLI;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "602d81226784fe8de1af96db98f594745f6b441d",
            "date": "2024-11-27T09:56:05Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "f04280ba16fa3901dcd98900a248adfc55f89e13",
            "date": "2024-11-27T09:57:12Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "3212ed239c11093c83bb10bac1f727682c562e17",
            "date": "2024-11-26T16:15:46Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "93cfa93424947a71d0a75ee128f49c90897243c4",
            "date": "2024-11-23T22:18:16Z",
            "author_login": "GaryAllan"
          },
          {
            "sha": "91acd5c61f546d29e3b2ae526768c80a065f6e15",
            "date": "2024-11-23T22:22:42Z",
            "author_login": "GaryAllan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository phpipam/phpipam prior to v1.5.2.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-07T00:15:09.300",
    "last_modified": "2024-11-21T07:38:40.797",
    "fix_date": "2023-03-06T21:08:01Z"
  },
  "references": [
    {
      "url": "https://github.com/phpipam/phpipam/commit/78e0470100a6cb143fe9af2e336dce80e4620960",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/3d5199d6-9bb2-4f7b-bd81-bded704da499",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/phpipam/phpipam/commit/78e0470100a6cb143fe9af2e336dce80e4620960",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/3d5199d6-9bb2-4f7b-bd81-bded704da499",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.813974",
    "processing_status": "enhanced"
  }
}