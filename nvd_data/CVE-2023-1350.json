{
  "cve_id": "CVE-2023-1350",
  "github_data": {
    "repository": "lwindolf/liferea",
    "fix_commit": "8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59",
    "related_commits": [
      "8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59",
      "8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59"
    ],
    "patch_url": "https://github.com/lwindolf/liferea/commit/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59.patch",
    "fix_commit_details": {
      "sha": "8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59",
      "commit_date": "2023-03-05T23:25:00Z",
      "author": {
        "login": "ittner",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix RCE vulnerability on feed enrichment",
        "length": 1600,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 32,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/subscription.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -282,6 +282,7 @@ subscription_update (subscriptionPtr subscription, guint flags)\n \t\t\tsubscription->updateState,\n \t\t\tsubscription->updateOptions\n \t\t);\n+\t\tupdate_request_allow_commands (request, TRUE);\n \n \t\tif (subscription_get_filter (subscription))\n \t\t\trequest->filtercmd = g_strdup (subscription_get_filter (subscription));"
        },
        {
          "filename": "src/update.c",
          "status": "modified",
          "additions": 15,
          "deletions": 2,
          "patch": "@@ -234,6 +234,13 @@ update_request_set_auth_value (UpdateRequest *request, const gchar* authValue)\n \trequest->authValue = g_strdup (authValue);\n }\n \n+void\n+update_request_allow_commands (UpdateRequest *request, gboolean allowCommands)\n+{\n+\trequest->allowCommands = allowCommands;\n+}\n+\n+\n /* update result object */\n \n updateResultPtr\n@@ -672,8 +679,14 @@ update_job_run (updateJobPtr job)\n \n \t/* everything starting with '|' is a local command */\n \tif (*(job->request->source) == '|') {\n-\t\tdebug1 (DEBUG_UPDATE, \"Recognized local command: %s\", job->request->source);\n-\t\tupdate_exec_cmd (job);\n+\t\tif (job->request->allowCommands) {\n+\t\t\tdebug1 (DEBUG_UPDATE, \"Recognized local command: %s\", job->request->source);\n+\t\t\tupdate_exec_cmd (job);\n+\t\t} else {\n+\t\t\tdebug1 (DEBUG_UPDATE, \"Refusing to run local command from unexpected source: %s\", job->request->source);\n+\t\t\tjob->result->httpstatus = 403;  /* Forbidden. */\n+\t\t\tupdate_process_finished_job (job);\n+\t\t}\n \t\treturn;\n \t}\n "
        },
        {
          "filename": "src/update.h",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -103,6 +103,7 @@ struct _UpdateRequest {\n \tupdateOptionsPtr options;\t/**< Update options for the request */\n \tgchar\t\t*filtercmd;\t/**< Command will filter output of URL */\n \tupdateStatePtr\tupdateState;\t/**< Update state of the requested object (etags, last modified...) */\n+\tgboolean\tallowCommands;\t/**< Allow this requests to run commands */\n };\n \n /** structure to store results of the processing of an update request */\n@@ -228,6 +229,21 @@ void update_request_set_source (UpdateRequest *request, const gchar* source);\n  */\n void update_request_set_auth_value (UpdateRequest *request, const gchar* authValue);\n \n+/**\n+ * Allows *this* request to run local commands.\n+ *\n+ * At first it may look this flag should be in updateOptions, but we can\n+ * take a safer path: feed commands are restricted to a few use cases while\n+ * options are propagated to downstream requests (feed enrichment, comments,\n+ * etc.), so it is a good idea to prevent these from running commands in the\n+ * local system via tricky URLs without needing to validate these options\n+ * everywhere (which is error-prone).\n+ *\n+ * @param request      the update request\n+ * @param can_run      TRUE if the request can run commands, FALSE otherwise.\n+ */\n+void update_request_allow_commands (UpdateRequest *request, gboolean allowCommands);\n+\n /**\n  * Creates a new update result for the given update request.\n  *"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "921bbdb553fb1d3f47cf5eca05f26e14b88ec6ca",
            "date": "2025-01-13T16:47:28Z",
            "author_login": "lwindolf"
          },
          {
            "sha": "a18db9cf3083090f2a16626d2ba32159c17ffe30",
            "date": "2025-01-06T23:08:40Z",
            "author_login": "lwindolf"
          },
          {
            "sha": "9026fe82192230b0089d79b27e847dc4ce985d49",
            "date": "2025-01-05T15:38:30Z",
            "author_login": "lwindolf"
          },
          {
            "sha": "113feff79156406234a6194a09cb06662574faad",
            "date": "2025-01-05T15:36:10Z",
            "author_login": "lwindolf"
          },
          {
            "sha": "16fb4f7cc5aa24dd84e6a0f638c62e41931c2b51",
            "date": "2025-01-05T15:33:23Z",
            "author_login": "lwindolf"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-78",
    "description": "A vulnerability was found in liferea. It has been rated as critical. Affected by this issue is the function update_job_run of the file src/update.c of the component Feed Enrichment. The manipulation of the argument source with the input |date &gt;/tmp/bad-item-link.txt leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The name of the patch is 8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-222848.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-11T09:15:10.197",
    "last_modified": "2024-11-21T07:39:00.393",
    "fix_date": "2023-03-05T23:25:00Z"
  },
  "references": [
    {
      "url": "https://github.com/lwindolf/liferea/commit/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.222848",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.222848",
      "source": "cna@vuldb.com",
      "tags": [
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/lwindolf/liferea/commit/8d8b5b963fa64c7a2122d1bbfbb0bed46e813e59",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.222848",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.222848",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.832518",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "liferea",
    "owner": "lwindolf",
    "created_at": "2013-11-01T20:45:51Z",
    "updated_at": "2025-01-13T16:47:37Z",
    "pushed_at": "2025-01-13T16:47:32Z",
    "size": 28845,
    "stars": 832,
    "forks": 129,
    "open_issues": 101,
    "watchers": 832,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1410087,
      "JavaScript": 95263,
      "Python": 63618,
      "Makefile": 17409,
      "CSS": 10000,
      "M4": 2920,
      "Shell": 2130,
      "XSLT": 2008
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T21:40:39.728876"
  }
}