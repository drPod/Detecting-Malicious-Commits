{
  "cve_id": "CVE-2023-1367",
  "github_data": {
    "repository": "alextselegidis/easyappointments",
    "fix_commit": "453c6e130229718680c91bef450db643a0f263e4",
    "related_commits": [
      "453c6e130229718680c91bef450db643a0f263e4",
      "453c6e130229718680c91bef450db643a0f263e4"
    ],
    "patch_url": "https://github.com/alextselegidis/easyappointments/commit/453c6e130229718680c91bef450db643a0f263e4.patch",
    "fix_commit_details": {
      "sha": "453c6e130229718680c91bef450db643a0f263e4",
      "commit_date": "2023-03-13T07:18:39Z",
      "author": {
        "login": "alextselegidis",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Apply the new escape helper function to the view files",
        "length": 54,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 76,
        "additions": 39,
        "deletions": 37
      },
      "files": [
        {
          "filename": "application/views/components/appointments_modal.php",
          "status": "modified",
          "additions": 7,
          "deletions": 5,
          "patch": "@@ -43,6 +43,7 @@\n                                         // Group services by category, only if there is at least one service\n                                         // with a parent category.\n                                         $has_category = FALSE;\n+                                        \n                                         foreach ($available_services as $service)\n                                         {\n                                             if ( ! empty($service['category_id']))\n@@ -72,6 +73,7 @@\n                                             // We need the uncategorized services at the end of the list, so we will use\n                                             // another iteration only for the uncategorized services.\n                                             $grouped_services['uncategorized'] = [];\n+                                            \n                                             foreach ($available_services as $service)\n                                             {\n                                                 if ($service['category_id'] == NULL)\n@@ -83,7 +85,7 @@\n                                             foreach ($grouped_services as $key => $group)\n                                             {\n                                                 $group_label = $key !== 'uncategorized'\n-                                                    ? $group[0]['category_name']\n+                                                    ? e($group[0]['category_name'])\n                                                     : 'Uncategorized';\n \n                                                 if (count($group) > 0)\n@@ -93,7 +95,7 @@\n                                                     foreach ($group as $service)\n                                                     {\n                                                         echo '<option value=\"' . $service['id'] . '\">'\n-                                                            . $service['name'] . '</option>';\n+                                                            . e($service['name']) . '</option>';\n                                                     }\n \n                                                     echo '</optgroup>';\n@@ -105,7 +107,7 @@\n                                             foreach ($available_services as $service)\n                                             {\n                                                 echo '<option value=\"' . $service['id'] . '\">'\n-                                                    . $service['name'] . '</option>';\n+                                                    . e($service['name']) . '</option>';\n                                             }\n                                         }\n                                         ?>\n@@ -137,8 +139,8 @@\n                                     </label>\n                                     <select id=\"appointment-status\" class=\"form-control\">\n                                         <?php foreach ($appointment_status_options as $appointment_status_option): ?>\n-                                            <option value=\"<?= $appointment_status_option ?>\">\n-                                                <?= $appointment_status_option ?>\n+                                            <option value=\"<?= e($appointment_status_option) ?>\">\n+                                                <?= e($appointment_status_option) ?>\n                                             </option>\n                                         <?php endforeach ?>\n                                     </select>"
        },
        {
          "filename": "application/views/components/backend_footer.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -44,7 +44,7 @@\n \n     <div class=\"ms-lg-auto\">\n         <strong id=\"footer-user-display-name\">\n-            <?= lang('hello') . ', ' . $user_display_name ?>!\n+            <?= lang('hello') . ', ' . e($user_display_name) ?>!\n         </strong>\n     </div>\n </div>"
        },
        {
          "filename": "application/views/components/google_analytics_script.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,7 +10,7 @@\n             (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n             m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n         })(window,document,\"script\",\"//www.google-analytics.com/analytics.js\",\"ga\");\n-        ga(\"create\", \"<?= $google_analytics_code ?>\", \"auto\");\n+        ga(\"create\", \"<?= e($google_analytics_code) ?>\", \"auto\");\n         ga(\"send\", \"pageview\");\n     </script>\n <?php endif ?>\n@@ -21,7 +21,7 @@\n         window.dataLayer = window.dataLayer || [];\n         function gtag(){dataLayer.push(arguments);}\n         gtag(\"js\", new Date());\n-        gtag(\"config\", \"<?= $google_analytics_code ?>\");\n+        gtag(\"config\", \"<?= e($google_analytics_code) ?>\");\n     </script>\n <?php endif ?>\n "
        },
        {
          "filename": "application/views/components/matomo_analytics_script.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -13,7 +13,7 @@\n         _paq.push(['trackPageView']);\n         _paq.push(['enableLinkTracking']);\n         (function () {\n-            var u = \"<?= $matomo_analytics_url ?>\";\n+            var u = \"<?= e($matomo_analytics_url) ?>\";\n             _paq.push(['setTrackerUrl', u + 'matomo.php']);\n             _paq.push(['setSiteId', '1']);\n             var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];\n@@ -24,7 +24,7 @@\n     </script>\n \n     <noscript>\n-        <p><img src=\"<?= $matomo_analytics_url ?>matomo.php?idsite=1&amp;rec=1\" style=\"border:0;\" alt=\"\"/></p>\n+        <p><img src=\"<?= e($matomo_analytics_url) ?>matomo.php?idsite=1&amp;rec=1\" style=\"border:0;\" alt=\"\"/></p>\n     </noscript>\n \n <?php endif ?>"
        },
        {
          "filename": "application/views/emails/account_recovery_email.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,7 +16,7 @@\n <div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n     <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n         <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n-            <?= $settings['company_name'] ?>\n+            <?= e($settings['company_name']) ?>\n         </strong>\n     </div>\n \n@@ -37,7 +37,7 @@\n         </a>\n         |\n         <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n-            <?= $settings['company_name'] ?>\n+            <?= e($settings['company_name']) ?>\n         </a>\n     </div>\n </div>"
        },
        {
          "filename": "application/views/emails/appointment_deleted_email.php",
          "status": "modified",
          "additions": 12,
          "deletions": 12,
          "patch": "@@ -21,7 +21,7 @@\n <div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n     <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n         <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n-            <?= $settings['company_name'] ?>\n+            <?= e($settings['company_name']) ?>\n         </strong>\n     </div>\n \n@@ -44,15 +44,15 @@\n                     <?= lang('service') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $service['name'] ?>\n+                    <?= e($service['name']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('provider') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>\n+                    <?= e($provider['first_name'] . ' ' . $provider['last_name']) ?>\n                 </td>\n             </tr>\n             <tr>\n@@ -87,7 +87,7 @@\n                         <?= lang('location') ?>\n                     </td>\n                     <td style=\"padding: 3px;\">\n-                        <?= $appointment['location'] ?>\n+                        <?= e($appointment['location']) ?>\n                     </td>\n                 </tr>\n             <?php endif ?>\n@@ -98,7 +98,7 @@\n                         <?= lang('notes') ?>\n                     </td>\n                     <td style=\"padding: 3px;\">\n-                        <?= $appointment['notes'] ?>\n+                        <?= e($appointment['notes']) ?>\n                     </td>\n                 </tr>\n             <?php endif ?>\n@@ -114,31 +114,31 @@\n                     <?= lang('name') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>\n+                    <?= e($customer['first_name'] . ' ' . $customer['last_name']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('email') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['email'] ?>\n+                    <?= e($customer['email']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('phone_number') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['phone_number'] ?>\n+                    <?= e($customer['phone_number']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('address') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['address'] ?>\n+                    <?= e($customer['address']) ?>\n                 </td>\n             </tr>\n         </table>\n@@ -148,7 +148,7 @@\n         </h2>\n         \n         <p>\n-            <?= $reason ?>\n+            <?= e($reason) ?>\n         </p>\n     </div>\n \n@@ -159,8 +159,8 @@\n             Easy!Appointments\n         </a>\n         |\n-        <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n-            <?= $settings['company_name'] ?>\n+        <a href=\"<?= e($settings['company_link']) ?>\" style=\"text-decoration: none;\">\n+            <?= e($settings['company_name']) ?>\n         </a>\n     </div>\n </div>"
        },
        {
          "filename": "application/views/emails/appointment_saved_email.php",
          "status": "modified",
          "additions": 13,
          "deletions": 13,
          "patch": "@@ -25,7 +25,7 @@\n <div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n     <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n         <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n-            <?= $settings['company_name'] ?>\n+            <?= e($settings['company_name']) ?>\n         </strong>\n     </div>\n \n@@ -48,15 +48,15 @@\n                     <?= lang('service') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $service['name'] ?>\n+                    <?= e($service['name']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('provider') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>\n+                    <?= e($provider['first_name'] . ' ' . $provider['last_name']) ?>\n                 </td>\n             </tr>\n             <tr>\n@@ -91,7 +91,7 @@\n                         <?= lang('location') ?>\n                     </td>\n                     <td style=\"padding: 3px;\">\n-                        <?= $appointment['location'] ?>\n+                        <?= e($appointment['location']) ?>\n                     </td>\n                 </tr>\n             <?php endif ?>\n@@ -102,7 +102,7 @@\n                         <?= lang('notes') ?>\n                     </td>\n                     <td style=\"padding: 3px;\">\n-                        <?= $appointment['notes'] ?>\n+                        <?= e($appointment['notes']) ?>\n                     </td>\n                 </tr>\n             <?php endif ?>\n@@ -118,31 +118,31 @@\n                     <?= lang('name') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>\n+                    <?= e($customer['first_name'] . ' ' . $customer['last_name']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('email') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['email'] ?>\n+                    <?= e($customer['email']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('phone_number') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['phone_number'] ?>\n+                    <?= e($customer['phone_number']) ?>\n                 </td>\n             </tr>\n             <tr>\n                 <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                     <?= lang('address') ?>\n                 </td>\n                 <td style=\"padding: 3px;\">\n-                    <?= $customer['address'] ?>\n+                    <?= e($customer['address']) ?>\n                 </td>\n             </tr>\n         </table>\n@@ -151,8 +151,8 @@\n             <?= lang('appointment_link_title') ?>\n         </h2>\n \n-        <a href=\"<?= $appointment_link ?>\" style=\"width: 600px;\">\n-            <?= $appointment_link ?>\n+        <a href=\"<?= e($appointment_link) ?>\" style=\"width: 600px;\">\n+            <?= e($appointment_link) ?>\n         </a>\n     </div>\n \n@@ -163,8 +163,8 @@\n             Easy!Appointments\n         </a>\n         |\n-        <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n-            <?= $settings['company_name'] ?>\n+        <a href=\"<?= e($settings['company_link']) ?>\" style=\"text-decoration: none;\">\n+            <?= e($settings['company_name']) ?>\n         </a>\n     </div>\n </div>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "272300359409ae5624eb95e2c751b930a10f2d1a",
            "date": "2024-11-05T12:29:04Z",
            "author_login": "alextselegidis"
          },
          {
            "sha": "b6fbaf418c423bf2bffa0e982bbf5030798ed5ab",
            "date": "2024-08-28T23:48:27Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e45fcf30b579a9a2a03bbbb35efb96556f1ad426",
            "date": "2024-07-07T11:53:43Z",
            "author_login": "alextselegidis"
          },
          {
            "sha": "f4964193e151f3bffaac85d6a7cd22d8f9dc73ba",
            "date": "2024-07-07T11:47:58Z",
            "author_login": "alextselegidis"
          },
          {
            "sha": "5cda141356751af24287b73eab337435415b585e",
            "date": "2024-07-07T11:07:17Z",
            "author_login": "alextselegidis"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-94",
    "description": "Code Injection in GitHub repository alextselegidis/easyappointments prior to 1.5.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-13T09:15:10.717",
    "last_modified": "2024-11-21T07:39:02.640",
    "fix_date": "2023-03-13T07:18:39Z"
  },
  "references": [
    {
      "url": "https://github.com/alextselegidis/easyappointments/commit/453c6e130229718680c91bef450db643a0f263e4",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/16bc74e2-1825-451f-bff7-bfdc1ea75cc2",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/alextselegidis/easyappointments/commit/453c6e130229718680c91bef450db643a0f263e4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/16bc74e2-1825-451f-bff7-bfdc1ea75cc2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.835370",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "easyappointments",
    "owner": "alextselegidis",
    "created_at": "2014-11-26T20:51:50Z",
    "updated_at": "2025-01-14T13:58:49Z",
    "pushed_at": "2025-01-10T18:26:21Z",
    "size": 39407,
    "stars": 3429,
    "forks": 1302,
    "open_issues": 144,
    "watchers": 3429,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 5282409,
      "JavaScript": 609400,
      "SCSS": 118171,
      "HTML": 10492,
      "Dockerfile": 1424,
      "Shell": 414
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:13:37.249955"
  }
}