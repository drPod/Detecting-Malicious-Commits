{
  "cve_id": "CVE-2023-1538",
  "github_data": {
    "repository": "answerdev/answer",
    "fix_commit": "813ad0b9894673b1bdd489a2e9ab60a44fe990af",
    "related_commits": [
      "813ad0b9894673b1bdd489a2e9ab60a44fe990af",
      "813ad0b9894673b1bdd489a2e9ab60a44fe990af"
    ],
    "patch_url": "https://github.com/answerdev/answer/commit/813ad0b9894673b1bdd489a2e9ab60a44fe990af.patch",
    "fix_commit_details": {
      "sha": "813ad0b9894673b1bdd489a2e9ab60a44fe990af",
      "commit_date": "2023-02-24T08:30:21Z",
      "author": {
        "login": "aichy126",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "update VerifyCaptcha",
        "length": 20,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 15,
        "deletions": 0
      },
      "files": [
        {
          "filename": "internal/repo/captcha/captcha.go",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri\n \t}\n \treturn captcha, nil\n }\n+\n+func (cr *captchaRepo) DelCaptcha(ctx context.Context, key string) (err error) {\n+\terr = cr.data.Cache.Del(ctx, key)\n+\tif err != nil {\n+\t\tlog.Debug(err)\n+\t}\n+\treturn nil\n+}"
        },
        {
          "filename": "internal/service/action/captcha_service.go",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -16,6 +16,7 @@ import (\n type CaptchaRepo interface {\n \tSetCaptcha(ctx context.Context, key, captcha string) (err error)\n \tGetCaptcha(ctx context.Context, key string) (captcha string, err error)\n+\tDelCaptcha(ctx context.Context, key string) (err error)\n \tSetActionType(ctx context.Context, ip, actionType string, amount int) (err error)\n \tGetActionType(ctx context.Context, ip, actionType string) (amount int, err error)\n \tDelActionType(ctx context.Context, ip, actionType string) (err error)\n@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase\n func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {\n \trealCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)\n \tif err != nil {\n+\t\tlog.Error(\"VerifyCaptcha GetCaptcha Error\", err.Error())\n+\t\treturn false, nil\n+\t}\n+\terr = cs.captchaRepo.DelCaptcha(ctx, key)\n+\tif err != nil {\n+\t\tlog.Error(\"VerifyCaptcha DelCaptcha Error\", err.Error())\n \t\treturn false, nil\n \t}\n \treturn strings.TrimSpace(captcha) == realCaptcha, nil"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5886c1ec53087520ac02cbdaf9811a0cfebc829e",
            "date": "2025-01-13T03:44:57Z",
            "author_login": "LinkinStars"
          },
          {
            "sha": "bbb2e66233730ed7dd9c8e3de138369ba341d8cb",
            "date": "2025-01-13T03:19:25Z",
            "author_login": "LinkinStars"
          },
          {
            "sha": "0618947350917ecd58a5797365058da17bf8169a",
            "date": "2025-01-07T02:37:14Z",
            "author_login": "LinkinStars"
          },
          {
            "sha": "f7731bc675930f9cb9fa7a6f6346c102246b2c4d",
            "date": "2024-12-09T09:31:10Z",
            "author_login": "LinkinStars"
          },
          {
            "sha": "6ae189010b8e87d303465dbdb91e164954826373",
            "date": "2024-12-09T06:40:43Z",
            "author_login": "LinkinStars"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-208",
    "description": "Observable Timing Discrepancy in GitHub repository answerdev/answer prior to 1.0.6.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-21T05:15:09.813",
    "last_modified": "2024-11-21T07:39:23.953",
    "fix_date": "2023-02-24T08:30:21Z"
  },
  "references": [
    {
      "url": "https://github.com/answerdev/answer/commit/813ad0b9894673b1bdd489a2e9ab60a44fe990af",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/ac0271eb-660f-4966-8b57-4bc660a9a1a0",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/answerdev/answer/commit/813ad0b9894673b1bdd489a2e9ab60a44fe990af",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/ac0271eb-660f-4966-8b57-4bc660a9a1a0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:08.986844",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "answer",
    "owner": "answerdev",
    "created_at": "2022-09-29T05:16:19Z",
    "updated_at": "2025-01-14T13:14:48Z",
    "pushed_at": "2025-01-14T02:13:53Z",
    "size": 13085,
    "stars": 13559,
    "forks": 1070,
    "open_issues": 90,
    "watchers": 13559,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 1939709,
      "TypeScript": 1249527,
      "HTML": 56622,
      "SCSS": 41263,
      "JavaScript": 16504,
      "Shell": 4175,
      "Smarty": 2499,
      "Dockerfile": 2223,
      "CSS": 1876,
      "Makefile": 1586
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:52:07.729674"
  }
}