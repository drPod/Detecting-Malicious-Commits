{
  "cve_id": "CVE-2023-22738",
  "github_data": {
    "repository": "vantage6/vantage6",
    "fix_commit": "798aca1de142a4eca175ef51112e2235642f4f24",
    "related_commits": [
      "798aca1de142a4eca175ef51112e2235642f4f24",
      "798aca1de142a4eca175ef51112e2235642f4f24"
    ],
    "patch_url": "https://github.com/vantage6/vantage6/commit/798aca1de142a4eca175ef51112e2235642f4f24.patch",
    "fix_commit_details": {
      "sha": "798aca1de142a4eca175ef51112e2235642f4f24",
      "commit_date": "2023-02-28T10:40:47Z",
      "author": {
        "login": "frankcorneliusmartin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-vvjv-97j8-94xh",
        "length": 104,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 22,
        "additions": 0,
        "deletions": 22
      },
      "files": [
        {
          "filename": "vantage6-server/vantage6/server/resource/user.py",
          "status": "modified",
          "additions": 0,
          "deletions": 22,
          "patch": "@@ -497,9 +497,6 @@ def patch(self, id):\n                     items:\n                       type: integer\n                     description: Extra rules for the user on top of the roles\n-                  organization_id:\n-                    type: integer\n-                    description: Organization id of the user\n \n         parameters:\n           - in: path\n@@ -543,7 +540,6 @@ def patch(self, id):\n         parser.add_argument(\"firstname\", type=str, required=False)\n         parser.add_argument(\"lastname\", type=str, required=False)\n         parser.add_argument(\"email\", type=str, required=False)\n-        parser.add_argument(\"organization_id\", type=int, required=False)\n         data = parser.parse_args()\n \n         # check if user defined a password, which is deprecated\n@@ -665,24 +661,6 @@ def patch(self, id):\n \n             user.rules = rules\n \n-        if data[\"organization_id\"] and \\\n-                data[\"organization_id\"] != g.user.organization_id:\n-            if not self.r.e_glo.can():\n-                return {'msg': 'You lack the permission to do that!'}, \\\n-                    HTTPStatus.UNAUTHORIZED\n-            else:\n-                # check that newly assigned organization exists\n-                org = db.Organization.get(data['organization_id'])\n-                if not org:\n-                    return {'msg': 'Organization does not exist.'}, \\\n-                        HTTPStatus.NOT_FOUND\n-                else:\n-                    log.warn(\n-                        f'Running as root and assigning (new) '\n-                        f'organization_id={data[\"organization_id\"]}'\n-                    )\n-                    user.organization_id = data[\"organization_id\"]\n-\n         try:\n             user.save()\n         except sqlalchemy.exc.IntegrityError as e:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7e08264dea67e84b35594893953001e8ea147d90",
            "date": "2025-01-09T16:31:08Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "c30ae94a7a4e5fda8eee9a937b26ff46c029109d",
            "date": "2024-12-13T09:10:55Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "7467646f458f773d0ee6aae6803682e1752a13f7",
            "date": "2024-12-13T08:54:45Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "4100ab5536ed2a5c675d6593cbebd8d98b4e5e14",
            "date": "2024-12-13T08:30:46Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "943a486a2e61185642fa75a0f55d24b776048838",
            "date": "2024-12-13T08:21:53Z",
            "author_login": "invalid-email-address"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:N",
    "cwe_id": "CWE-281",
    "description": "vantage6 is a privacy preserving federated learning infrastructure for secure insight exchange. Assigning existing users to a different organizations is currently possible. It may lead to unintended access: if a user from organization A is accidentally assigned to organization B, they will retain their permissions and therefore might be able to access stuff they should not be allowed to access. This issue is patched in version 3.8.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-01T21:15:10.397",
    "last_modified": "2024-11-21T07:45:19.733",
    "fix_date": "2023-02-28T10:40:47Z"
  },
  "references": [
    {
      "url": "https://github.com/vantage6/vantage6/commit/798aca1de142a4eca175ef51112e2235642f4f24",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-vvjv-97j8-94xh",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/commit/798aca1de142a4eca175ef51112e2235642f4f24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-vvjv-97j8-94xh",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.792763",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "vantage6",
    "owner": "vantage6",
    "created_at": "2022-05-16T12:09:26Z",
    "updated_at": "2025-01-09T16:31:14Z",
    "pushed_at": "2025-01-14T13:14:06Z",
    "size": 44880,
    "stars": 31,
    "forks": 11,
    "open_issues": 248,
    "watchers": 31,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 1919355,
      "TypeScript": 526976,
      "HTML": 209327,
      "SCSS": 20209,
      "Makefile": 12871,
      "Dockerfile": 9054,
      "Jinja": 5974,
      "Shell": 4282,
      "JavaScript": 802
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:50:50.846103"
  }
}