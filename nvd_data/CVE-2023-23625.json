{
  "cve_id": "CVE-2023-23625",
  "github_data": {
    "repository": "ipfs/go-unixfs",
    "fix_commit": "467d139a640ecee4f2e74643dafcc58bb3b54175",
    "related_commits": [
      "467d139a640ecee4f2e74643dafcc58bb3b54175",
      "467d139a640ecee4f2e74643dafcc58bb3b54175"
    ],
    "patch_url": "https://github.com/ipfs/go-unixfs/commit/467d139a640ecee4f2e74643dafcc58bb3b54175.patch",
    "fix_commit_details": {
      "sha": "467d139a640ecee4f2e74643dafcc58bb3b54175",
      "commit_date": "2023-02-09T18:58:47Z",
      "author": {
        "login": "Jorropo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-q264-w97q-q778",
        "length": 102,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 38,
        "additions": 27,
        "deletions": 11
      },
      "files": [
        {
          "filename": "go.mod",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@ module github.com/ipfs/go-unixfs\n require (\n \tgithub.com/alecthomas/units v0.0.0-20210927113745-59d0afb8317a\n \tgithub.com/gogo/protobuf v1.3.2\n-\tgithub.com/ipfs/go-bitfield v1.0.0\n+\tgithub.com/ipfs/go-bitfield v1.1.0\n \tgithub.com/ipfs/go-block-format v0.0.3\n \tgithub.com/ipfs/go-blockservice v0.2.1\n \tgithub.com/ipfs/go-cid v0.3.2"
        },
        {
          "filename": "go.sum",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -244,8 +244,8 @@ github.com/inconshreveable/mousetrap v1.0.0/go.mod h1:PxqpIevigyE2G7u3NXJIT2ANyt\n github.com/influxdata/influxdb1-client v0.0.0-20191209144304-8bf82d3c094d/go.mod h1:qj24IKcXYK6Iy9ceXlo3Tc+vtHo9lIhSX5JddghvEPo=\n github.com/ipfs/bbloom v0.0.4 h1:Gi+8EGJ2y5qiD5FbsbpX/TMNcJw8gSqr7eyjHa4Fhvs=\n github.com/ipfs/bbloom v0.0.4/go.mod h1:cS9YprKXpoZ9lT0n/Mw/a6/aFV6DTjTLYHeA+gyqMG0=\n-github.com/ipfs/go-bitfield v1.0.0 h1:y/XHm2GEmD9wKngheWNNCNL0pzrWXZwCdQGv1ikXknQ=\n-github.com/ipfs/go-bitfield v1.0.0/go.mod h1:N/UiujQy+K+ceU1EF5EkVd1TNqevLrCQMIcAEPrdtus=\n+github.com/ipfs/go-bitfield v1.1.0 h1:fh7FIo8bSwaJEh6DdTWbCeZ1eqOaOkKFI74SCnsWbGA=\n+github.com/ipfs/go-bitfield v1.1.0/go.mod h1:paqf1wjq/D2BBmzfTVFlJQ9IlFOZpg422HL0HqsGWHU=\n github.com/ipfs/go-bitswap v0.5.1 h1:721YAEDBnLIrvcIMkCHCdqp34hA8jwL9yKMkyJpSpco=\n github.com/ipfs/go-bitswap v0.5.1/go.mod h1:P+ckC87ri1xFLvk74NlXdP0Kj9RmWAh4+H78sC6Qopo=\n github.com/ipfs/go-block-format v0.0.2/go.mod h1:AWR46JfpcObNfg3ok2JHDUfdiHRgWhJgCQF+KIgOPJY="
        },
        {
          "filename": "hamt/hamt.go",
          "status": "modified",
          "additions": 18,
          "deletions": 4,
          "patch": "@@ -106,12 +106,16 @@ func makeShard(ds ipld.DAGService, size int, key string, val *ipld.Link) (*Shard\n \tif err != nil {\n \t\treturn nil, err\n \t}\n+\tchilder, err := newChilder(ds, size)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n \tmaxpadding := fmt.Sprintf(\"%X\", size-1)\n \ts := &Shard{\n \t\ttableSizeLg2: lg2s,\n \t\tprefixPadStr: fmt.Sprintf(\"%%0%dX\", len(maxpadding)),\n \t\tmaxpadlen:    len(maxpadding),\n-\t\tchilder:      newChilder(ds, size),\n+\t\tchilder:      childer,\n \t\ttableSize:    size,\n \t\tdserv:        ds,\n \n@@ -765,11 +769,21 @@ type childer struct {\n \tchildren []*Shard\n }\n \n-func newChilder(ds ipld.DAGService, size int) *childer {\n+const maximumHamtWidth = 1 << 10 // FIXME: Spec this and decide of a correct value\n+\n+func newChilder(ds ipld.DAGService, size int) (*childer, error) {\n+\tif size > maximumHamtWidth {\n+\t\treturn nil, fmt.Errorf(\"hamt witdh (%d) exceed maximum allowed (%d)\", size, maximumHamtWidth)\n+\t}\n+\tbf, err := bitfield.NewBitfield(size)\n+\tif err != nil {\n+\t\treturn nil, err\n+\t}\n+\n \treturn &childer{\n \t\tdserv:    ds,\n-\t\tbitfield: bitfield.NewBitfield(size),\n-\t}\n+\t\tbitfield: bf,\n+\t}, nil\n }\n \n func (s *childer) makeChilder(data []byte, links []*ipld.Link) *childer {"
        },
        {
          "filename": "hamt/hamt_test.go",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -737,8 +737,10 @@ func BenchmarkHAMTSet(b *testing.B) {\n }\n \n func TestHamtBadSize(t *testing.T) {\n-\t_, err := NewShard(nil, 7)\n-\tif err == nil {\n-\t\tt.Fatal(\"should have failed to construct hamt with bad size\")\n+\tfor _, size := range [...]int{-8, 7, 2, 1337, 1024 + 8, -3} {\n+\t\t_, err := NewShard(nil, size)\n+\t\tif err == nil {\n+\t\t\tt.Error(\"should have failed to construct hamt with bad size: %d\", size)\n+\t\t}\n \t}\n }"
        },
        {
          "filename": "version.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,3 +1,3 @@\n {\n-  \"version\": \"v0.4.2\"\n+  \"version\": \"v0.4.3\"\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a7243ebfc36eaa89d79a39d3cef3fa1e60f7e49e",
            "date": "2023-06-14T11:14:19Z",
            "author_login": "web-flow"
          },
          {
            "sha": "b923427fd1b76514ce4d4b05f1abef657abedd1b",
            "date": "2023-05-25T15:08:12Z",
            "author_login": "hacdias"
          },
          {
            "sha": "d4f5b7f9dd8563271e9facf6b8bd246df2f79512",
            "date": "2023-05-25T15:08:04Z",
            "author_login": "hacdias"
          },
          {
            "sha": "f0430462e74c3b57370e6abdf82dca23e74b3fd2",
            "date": "2023-05-18T08:42:37Z",
            "author_login": "hacdias"
          },
          {
            "sha": "cfde108f174fbeba8f496efbd1dc9d7fecb41f9a",
            "date": "2023-05-11T17:53:09Z",
            "author_login": "guseggert"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "go-unixfs is an implementation of a unix-like filesystem on top of an ipld merkledag. Trying to read malformed HAMT sharded directories can cause panics and virtual memory leaks. If you are reading untrusted user input, an attacker can then trigger a panic. This is caused by bogus `fanout` parameter in the HAMT directory nodes. Users are advised to upgrade to version 0.4.3 to resolve this issue. Users unable to upgrade should not feed untrusted user data to the decoding functions.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-02-09T21:15:11.327",
    "last_modified": "2024-11-21T07:46:33.710",
    "fix_date": "2023-02-09T18:58:47Z"
  },
  "references": [
    {
      "url": "https://github.com/ipfs/go-unixfs/commit/467d139a640ecee4f2e74643dafcc58bb3b54175",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipfs/go-unixfs/security/advisories/GHSA-q264-w97q-q778",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ipfs/go-unixfs/commit/467d139a640ecee4f2e74643dafcc58bb3b54175",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipfs/go-unixfs/security/advisories/GHSA-q264-w97q-q778",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.009273",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "go-unixfs",
    "owner": "ipfs",
    "created_at": "2018-07-30T21:11:27Z",
    "updated_at": "2024-11-04T23:59:50Z",
    "pushed_at": "2023-06-14T11:14:19Z",
    "size": 26877,
    "stars": 106,
    "forks": 53,
    "open_issues": 4,
    "watchers": 106,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Go": 228727,
      "Makefile": 171
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:52:54.449831"
  }
}