{
  "cve_id": "CVE-2023-23939",
  "github_data": {
    "repository": "Azure/setup-kubectl",
    "fix_commit": "d449d75495d2b9d1463555bb00ca3dca77a42ab6",
    "related_commits": [
      "d449d75495d2b9d1463555bb00ca3dca77a42ab6",
      "d449d75495d2b9d1463555bb00ca3dca77a42ab6"
    ],
    "patch_url": "https://github.com/Azure/setup-kubectl/commit/d449d75495d2b9d1463555bb00ca3dca77a42ab6.patch",
    "fix_commit_details": {
      "sha": "d449d75495d2b9d1463555bb00ca3dca77a42ab6",
      "commit_date": "2022-05-27T21:36:08Z",
      "author": {
        "login": "OliverMKing",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "lower permissions for chmod (#51)",
        "length": 33,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/run.test.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -106,7 +106,7 @@ describe('Testing all functions in run file.', () => {\n         expect(toolCache.downloadTool).toBeCalled();\n         expect(toolCache.cacheFile).toBeCalled();\n         expect(os.type).toBeCalled();\n-        expect(fs.chmodSync).toBeCalledWith(path.join('pathToCachedTool', 'kubectl.exe'), '777');\n+        expect(fs.chmodSync).toBeCalledWith(path.join('pathToCachedTool', 'kubectl.exe'), '775');\n     });\n \n     test('downloadKubectl() - throw DownloadKubectlFailed error when unable to download kubectl', async () => {\n@@ -144,7 +144,7 @@ describe('Testing all functions in run file.', () => {\n         expect(await run.downloadKubectl('v1.15.0')).toBe(path.join('pathToCachedTool', 'kubectl.exe'));\n         expect(toolCache.find).toBeCalledWith('kubectl', 'v1.15.0');\n         expect(os.type).toBeCalled();\n-        expect(fs.chmodSync).toBeCalledWith(path.join('pathToCachedTool', 'kubectl.exe'), '777');\n+        expect(fs.chmodSync).toBeCalledWith(path.join('pathToCachedTool', 'kubectl.exe'), '775');\n         expect(toolCache.downloadTool).not.toBeCalled();\n     });\n "
        },
        {
          "filename": "src/run.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -57,7 +57,7 @@ export async function downloadKubectl(version: string): Promise<string> {\n     }\r\n \r\n     const kubectlPath = path.join(cachedToolpath, kubectlToolName + getExecutableExtension());\r\n-    fs.chmodSync(kubectlPath, '777');\r\n+    fs.chmodSync(kubectlPath, '775');\r\n     return kubectlPath;\r\n }\r\n \r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2d66d6bef6ec2b958194a359ad7555214fea90f8",
            "date": "2024-12-18T20:24:40Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3b0a9a4ae303e9b3638c15f5f1285b4676232f3d",
            "date": "2024-11-06T20:09:30Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "66e812b74cd9eeedffb03626dda7426d9acac82f",
            "date": "2024-10-23T19:30:23Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "fc19d5430f1d277d4b90c61bdeab270c6e658017",
            "date": "2024-10-23T19:24:24Z",
            "author_login": "jaiveerk"
          },
          {
            "sha": "5f6d890454bcf80c0896aa54e9d1eafd4a470781",
            "date": "2024-09-11T19:33:10Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.9,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-732",
    "description": "Azure/setup-kubectl is a GitHub Action for installing Kubectl. This vulnerability only impacts versions before version 3. An insecure temporary creation of a file allows other actors on the Actions runner to replace the Kubectl binary created by this action because it is world writable. This Kubectl tool installer runs `fs.chmodSync(kubectlPath, 777)` to set permissions on the Kubectl binary, however, this allows any local user to replace the Kubectl binary. This allows privilege escalation to the user that can also run kubectl, most likely root. This attack is only possible if an attacker somehow breached the GitHub actions runner or if a user is utilizing an Action that maliciously executes this attack. This has been fixed and released in all versions `v3` and later. 775 permissions are used instead. Users are advised to upgrade. There are no known workarounds for this issue.\n",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-03-06T19:15:10.297",
    "last_modified": "2024-11-21T07:47:08.613",
    "fix_date": "2022-05-27T21:36:08Z"
  },
  "references": [
    {
      "url": "https://github.com/Azure/setup-kubectl/commit/d449d75495d2b9d1463555bb00ca3dca77a42ab6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Azure/setup-kubectl/security/advisories/GHSA-p756-rfxh-x63h",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Azure/setup-kubectl/commit/d449d75495d2b9d1463555bb00ca3dca77a42ab6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Azure/setup-kubectl/security/advisories/GHSA-p756-rfxh-x63h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.811099",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "setup-kubectl",
    "owner": "Azure",
    "created_at": "2019-09-04T10:28:20Z",
    "updated_at": "2024-12-25T20:04:52Z",
    "pushed_at": "2025-01-13T10:41:15Z",
    "size": 21778,
    "stars": 134,
    "forks": 50,
    "open_issues": 6,
    "watchers": 134,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "releases/v1",
      "releases/v2",
      "releases/v3",
      "releases/v4.0.0"
    ],
    "languages": {
      "TypeScript": 12161,
      "Python": 1957,
      "JavaScript": 353
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:20:14.925710"
  }
}