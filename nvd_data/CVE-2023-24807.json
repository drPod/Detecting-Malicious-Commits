{
  "cve_id": "CVE-2023-24807",
  "github_data": {
    "repository": "nodejs/undici",
    "fix_commit": "f2324e549943f0b0937b09fb1c0c16cc7c93abdf",
    "related_commits": [
      "f2324e549943f0b0937b09fb1c0c16cc7c93abdf",
      "f2324e549943f0b0937b09fb1c0c16cc7c93abdf"
    ],
    "patch_url": "https://github.com/nodejs/undici/commit/f2324e549943f0b0937b09fb1c0c16cc7c93abdf.patch",
    "fix_commit_details": {
      "sha": "f2324e549943f0b0937b09fb1c0c16cc7c93abdf",
      "commit_date": "2023-02-13T11:23:21Z",
      "author": {
        "login": "Trott",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-r6ch-mqf9-qc9w",
        "length": 153,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 24,
        "additions": 19,
        "deletions": 5
      },
      "files": [
        {
          "filename": "lib/fetch/headers.js",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -24,10 +24,12 @@ function headerValueNormalize (potentialValue) {\n   //  To normalize a byte sequence potentialValue, remove\n   //  any leading and trailing HTTP whitespace bytes from\n   //  potentialValue.\n-  return potentialValue.replace(\n-    /^[\\r\\n\\t ]+|[\\r\\n\\t ]+$/g,\n-    ''\n-  )\n+\n+  // Trimming the end with `.replace()` and a RegExp is typically subject to\n+  // ReDoS. This is safer and faster.\n+  let i = potentialValue.length\n+  while (/[\\r\\n\\t ]/.test(potentialValue.charAt(--i)));\n+  return potentialValue.slice(0, i + 1).replace(/^[\\r\\n\\t ]+/, '')\n }\n \n function fill (headers, object) {"
        },
        {
          "filename": "test/fetch/headers.js",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -666,6 +666,18 @@ tap.test('invalid headers', (t) => {\n   t.end()\n })\n \n+tap.test('headers that might cause a ReDoS', (t) => {\n+  t.doesNotThrow(() => {\n+    // This test will time out if the ReDoS attack is successful.\n+    const headers = new Headers()\n+    const attack = 'a' + '\\t'.repeat(500_000) + '\\ta'\n+    headers.append('fhqwhgads', attack)\n+  })\n+\n+  t.end()\n+})\n+\n+\n tap.test('Headers.prototype.getSetCookie', (t) => {\n   t.test('Mutating the returned list does not affect the set-cookie list', (t) => {\n     const h = new Headers([\n@@ -682,4 +694,4 @@ tap.test('Headers.prototype.getSetCookie', (t) => {\n   })\n \n   t.end()\n-})\n+})\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e3928edfc3c121e170ee6068f36e4c878ee09b14",
            "date": "2025-01-14T08:03:33Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c4ee20f8d0f565f91621ad20088b44e39372fcd0",
            "date": "2025-01-14T07:55:21Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "fd01347b6e2dc2163033dc8db33a61c0d6157d80",
            "date": "2025-01-14T07:40:50Z",
            "author_login": "luddd3"
          },
          {
            "sha": "45eaed232577e9b66d2f0a596eb018c79e098541",
            "date": "2025-01-10T08:47:52Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "251da10da915b70bf576777ca0734bba8eb38f96",
            "date": "2025-01-09T15:02:48Z",
            "author_login": "github-actions[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-20",
    "description": "Undici is an HTTP/1.1 client for Node.js. Prior to version 5.19.1, the `Headers.set()` and `Headers.append()` methods are vulnerable to Regular Expression Denial of Service (ReDoS) attacks when untrusted values are passed into the functions. This is due to the inefficient regular expression used to normalize the values in the `headerValueNormalize()` utility function. This vulnerability was patched in v5.19.1. No known workarounds are available.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-16T18:15:12.340",
    "last_modified": "2024-11-21T07:48:26.040",
    "fix_date": "2023-02-13T11:23:21Z"
  },
  "references": [
    {
      "url": "https://github.com/nodejs/undici/commit/f2324e549943f0b0937b09fb1c0c16cc7c93abdf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nodejs/undici/releases/tag/v5.19.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/bugs?report_id=1784449",
      "source": "security-advisories@github.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nodejs/undici/commit/f2324e549943f0b0937b09fb1c0c16cc7c93abdf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nodejs/undici/releases/tag/v5.19.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/nodejs/undici/security/advisories/GHSA-r6ch-mqf9-qc9w",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/bugs?report_id=1784449",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230324-0010/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.066864",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "undici",
    "owner": "nodejs",
    "created_at": "2018-05-11T22:07:48Z",
    "updated_at": "2025-01-14T10:47:28Z",
    "pushed_at": "2025-01-14T08:03:41Z",
    "size": 11610,
    "stars": 6484,
    "forks": 572,
    "open_issues": 235,
    "watchers": 6484,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "JavaScript": 2463022,
      "TypeScript": 82943,
      "Shell": 170
    },
    "commit_activity": {
      "total_commits_last_year": 793,
      "avg_commits_per_week": 15.25,
      "days_active_last_year": 256
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:08:47.167142"
  }
}