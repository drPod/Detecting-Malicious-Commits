{
  "cve_id": "CVE-2023-24816",
  "github_data": {
    "repository": "ipython/ipython",
    "fix_commit": "385d69325319a5972ee9b5983638e3617f21cb1f",
    "related_commits": [
      "385d69325319a5972ee9b5983638e3617f21cb1f",
      "385d69325319a5972ee9b5983638e3617f21cb1f"
    ],
    "patch_url": "https://github.com/ipython/ipython/commit/385d69325319a5972ee9b5983638e3617f21cb1f.patch",
    "fix_commit_details": {
      "sha": "385d69325319a5972ee9b5983638e3617f21cb1f",
      "commit_date": "2023-02-10T09:21:06Z",
      "author": {
        "login": "Carreau",
        "type": "User",
        "stats": {
          "total_commits": 4718,
          "average_weekly_commits": 5.343148357870895,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 533
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-29gw-9793-fvw7",
        "length": 63,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 21,
        "deletions": 25
      },
      "files": [
        {
          "filename": "IPython/__init__.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -63,7 +63,7 @@\n version_info = release.version_info\n # list of CVEs that should have been patched in this release.\n # this is informational and should not be relied upon.\n-__patched_cves__ = {\"CVE-2022-21699\"}\n+__patched_cves__ = {\"CVE-2022-21699\", \"CVE-2023-24816\"}\n \n \n def embed_kernel(module=None, local_ns=None, **kwargs):"
        },
        {
          "filename": "IPython/utils/terminal.py",
          "status": "modified",
          "additions": 8,
          "deletions": 24,
          "patch": "@@ -91,30 +91,14 @@ def _restore_term_title_xterm():\n         _set_term_title = _set_term_title_xterm\n         _restore_term_title = _restore_term_title_xterm\n elif sys.platform == 'win32':\n-    try:\n-        import ctypes\n-\n-        SetConsoleTitleW = ctypes.windll.kernel32.SetConsoleTitleW\n-        SetConsoleTitleW.argtypes = [ctypes.c_wchar_p]\n-    \n-        def _set_term_title(title):\n-            \"\"\"Set terminal title using ctypes to access the Win32 APIs.\"\"\"\n-            SetConsoleTitleW(title)\n-    except ImportError:\n-        def _set_term_title(title):\n-            \"\"\"Set terminal title using the 'title' command.\"\"\"\n-            global ignore_termtitle\n-\n-            try:\n-                # Cannot be on network share when issuing system commands\n-                curr = os.getcwd()\n-                os.chdir(\"C:\")\n-                ret = os.system(\"title \" + title)\n-            finally:\n-                os.chdir(curr)\n-            if ret:\n-                # non-zero return code signals error, don't try again\n-                ignore_termtitle = True\n+    import ctypes\n+\n+    SetConsoleTitleW = ctypes.windll.kernel32.SetConsoleTitleW\n+    SetConsoleTitleW.argtypes = [ctypes.c_wchar_p]\n+\n+    def _set_term_title(title):\n+        \"\"\"Set terminal title using ctypes to access the Win32 APIs.\"\"\"\n+        SetConsoleTitleW(title)\n \n \n def set_term_title(title):"
        },
        {
          "filename": "docs/source/whatsnew/version8.rst",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -2,6 +2,18 @@\n  8.x Series\n ============\n \n+\n+IPython 8.9.1\n+-------------\n+\n+Out of schedule release of IPython with minor fixes to patch a potential CVE-2023-24816.\n+This is a really low severity CVE that you most likely are not affected by unless:\n+\n+ - You are on windows.\n+ - You have a custom build of Python without ``_ctypes``\n+ - You cd or start IPython or Jupyter in untrusted directory which names may be valid shell commands.\n+\n+\n .. _version 8.9.0:\n \n IPython 8.9.0"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5e59ea92ba81245815b9f3323b0a26c4ff9a24ac",
            "date": "2025-01-14T15:34:52Z",
            "author_login": "Carreau"
          },
          {
            "sha": "a5803b0f886057a64771f0e758a30a36deb49c91",
            "date": "2025-01-14T13:39:46Z",
            "author_login": "Carreau"
          },
          {
            "sha": "a89d00bb63ec3b5d116292c856a344fe0fb0af0d",
            "date": "2025-01-14T08:23:57Z",
            "author_login": "Carreau"
          },
          {
            "sha": "82e21335f46651939aafe5ee3bea11207eb618b8",
            "date": "2025-01-13T17:30:42Z",
            "author_login": "Carreau"
          },
          {
            "sha": "364e544a76c590ff161d9fffacf35533db478324",
            "date": "2025-01-11T20:58:33Z",
            "author_login": "Carreau"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-20",
    "description": "IPython (Interactive Python) is a command shell for interactive computing in multiple programming languages, originally developed for the Python programming language. Versions prior to 8.1.0 are subject to a command injection vulnerability with very specific prerequisites. This vulnerability requires that the function `IPython.utils.terminal.set_term_title` be called on Windows in a Python environment where ctypes is not available. The dependency on `ctypes` in `IPython.utils._process_win32` prevents the vulnerable code from ever being reached in the ipython binary. However, as a library that could be used by another tool `set_term_title` could be called and hence introduce a vulnerability. Should an attacker get untrusted input to an instance of this function they would be able to inject shell commands as current process and limited to the scope of the current process. Users of ipython as a library are advised to upgrade. Users unable to upgrade should ensure that any calls to the `IPython.utils.terminal.set_term_title` function are done with trusted or filtered input.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-02-10T20:15:53.817",
    "last_modified": "2024-11-21T07:48:27.127",
    "fix_date": "2023-02-10T09:21:06Z"
  },
  "references": [
    {
      "url": "https://github.com/ipython/ipython/blob/3f0bf05f072a91b2a3042d23ce250e5e906183fd/IPython/utils/terminal.py#L103-L117",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/blob/56e6925dfa50e2c7f4a6471547b8176275db7c25/IPython/utils/_process_win32.py#L20",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/commit/385d69325319a5972ee9b5983638e3617f21cb1f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/security/advisories/GHSA-29gw-9793-fvw7",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/blob/3f0bf05f072a91b2a3042d23ce250e5e906183fd/IPython/utils/terminal.py#L103-L117",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/blob/56e6925dfa50e2c7f4a6471547b8176275db7c25/IPython/utils/_process_win32.py#L20",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/commit/385d69325319a5972ee9b5983638e3617f21cb1f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ipython/ipython/security/advisories/GHSA-29gw-9793-fvw7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.014971",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ipython",
    "owner": "ipython",
    "created_at": "2010-05-10T04:46:06Z",
    "updated_at": "2025-01-14T15:35:00Z",
    "pushed_at": "2025-01-14T15:34:52Z",
    "size": 79173,
    "stars": 16342,
    "forks": 4448,
    "open_issues": 1561,
    "watchers": 16342,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "7.x",
      "main"
    ],
    "languages": {
      "Python": 2467835,
      "Shell": 11771,
      "Makefile": 4675,
      "Batchfile": 425
    },
    "commit_activity": {
      "total_commits_last_year": 447,
      "avg_commits_per_week": 8.596153846153847,
      "days_active_last_year": 136
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:58:28.288375"
  }
}