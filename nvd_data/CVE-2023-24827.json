{
  "cve_id": "CVE-2023-24827",
  "github_data": {
    "repository": "anchore/syft",
    "fix_commit": "9995950c70e849f9921919faffbfcf46401f71f3",
    "related_commits": [
      "9995950c70e849f9921919faffbfcf46401f71f3",
      "9995950c70e849f9921919faffbfcf46401f71f3"
    ],
    "patch_url": "https://github.com/anchore/syft/commit/9995950c70e849f9921919faffbfcf46401f71f3.patch",
    "fix_commit_details": {
      "sha": "9995950c70e849f9921919faffbfcf46401f71f3",
      "commit_date": "2023-02-03T18:06:14Z",
      "author": {
        "login": "spiffcs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: update config struct to not decode password/key (#1538)",
        "length": 329,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 17,
        "deletions": 2
      },
      "files": [
        {
          "filename": "internal/config/attest.go",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -3,8 +3,9 @@ package config\n import \"github.com/spf13/viper\"\n \n type attest struct {\n-\tKey      string `yaml:\"key\" json:\"key\" mapstructure:\"key\"`\n-\tPassword string `yaml:\"password\" json:\"password\" mapstructure:\"password\"`\n+\t// IMPORTANT: do not show the attestation key/password in any YAML/JSON output (sensitive information)\n+\tKey      string `yaml:\"-\" json:\"-\" mapstructure:\"key\"`\n+\tPassword string `yaml:\"-\" json:\"-\" mapstructure:\"password\"`\n }\n \n func (cfg attest) loadDefaultValues(v *viper.Viper) {"
        },
        {
          "filename": "test/cli/packages_cmd_test.go",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -229,6 +229,20 @@ func TestPackagesCmdFlags(t *testing.T) {\n \t\t\t\tassertSuccessfulReturnCode,\n \t\t\t},\n \t\t},\n+\t\t{\n+\t\t\tname: \"password and key not in config output\",\n+\t\t\targs: []string{\"packages\", \"-vvv\", \"-o\", \"json\", coverageImage},\n+\t\t\tenv: map[string]string{\n+\t\t\t\t\"SYFT_ATTEST_PASSWORD\": \"secret_password\",\n+\t\t\t\t\"SYFT_ATTEST_KEY\":      \"secret_key_path\",\n+\t\t\t},\n+\t\t\tassertions: []traitAssertion{\n+\t\t\t\tassertNotInOutput(\"secret_password\"),\n+\t\t\t\tassertNotInOutput(\"secret_key_path\"),\n+\t\t\t\tassertPackageCount(34),\n+\t\t\t\tassertSuccessfulReturnCode,\n+\t\t\t},\n+\t\t},\n \t}\n \n \tfor _, test := range tests {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b4e7b64d5ce04b6636b46ffe4b900936a51a4ddd",
            "date": "2025-01-08T17:51:48Z",
            "author_login": "anchore-actions-token-generator[bot]"
          },
          {
            "sha": "b3fc7b3b0ad1b7af4f72f70048844bbfb0720d11",
            "date": "2025-01-07T16:30:26Z",
            "author_login": "anchore-actions-token-generator[bot]"
          },
          {
            "sha": "df36303df060c5f75805eca38398d5d8101d7b41",
            "date": "2025-01-07T16:29:58Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a2a56dd3e95e11ae74c58c668bd2d0099c5982e1",
            "date": "2025-01-06T16:47:55Z",
            "author_login": "kzantow"
          },
          {
            "sha": "2a8c8ac832c1316475691bf021a4831e244deadf",
            "date": "2025-01-06T16:15:36Z",
            "author_login": "anchore-actions-token-generator[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "syft is a a CLI tool and Go library for generating a Software Bill of Materials (SBOM) from container images and filesystems. A password disclosure flaw was found in Syft versions v0.69.0 and v0.69.1. This flaw leaks the password stored in the SYFT_ATTEST_PASSWORD environment variable. The `SYFT_ATTEST_PASSWORD` environment variable is for the `syft attest` command to generate attested SBOMs for the given container image. This environment variable is used to decrypt the private key (provided with `syft attest --key <path-to-key-file>`)  during the signing process while generating an SBOM attestation. This vulnerability affects users running syft that have the `SYFT_ATTEST_PASSWORD` environment variable set with credentials (regardless of if the attest command is being used or not). Users that do not have the environment variable `SYFT_ATTEST_PASSWORD` set are not affected by this issue. The credentials are leaked in two ways: in the syft logs when `-vv` or `-vvv` are used in the syft command (which is any log level >= `DEBUG`) and in the attestation or SBOM only when the `syft-json` format is used. Note that as of v0.69.0 any generated attestations by the `syft attest` command are uploaded to the OCI registry (if you have write access to that registry) in the same way `cosign attach` is done. This means that any attestations generated for the affected versions of syft when the `SYFT_ATTEST_PASSWORD` environment variable was set would leak credentials in the attestation payload uploaded to the OCI registry. This issue has been patched in commit `9995950c70` and has been released as v0.70.0. There are no workarounds for this vulnerability. Users are advised to upgrade.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-07T01:15:09.660",
    "last_modified": "2024-11-21T07:48:28.527",
    "fix_date": "2023-02-03T18:06:14Z"
  },
  "references": [
    {
      "url": "https://github.com/anchore/syft/commit/9995950c70e849f9921919faffbfcf46401f71f3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/anchore/syft/security/advisories/GHSA-jp7v-3587-2956",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/anchore/syft/commit/9995950c70e849f9921919faffbfcf46401f71f3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/anchore/syft/security/advisories/GHSA-jp7v-3587-2956",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:03.997750",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "syft",
    "owner": "anchore",
    "created_at": "2020-05-07T18:19:29Z",
    "updated_at": "2025-01-14T04:42:27Z",
    "pushed_at": "2025-01-13T14:01:52Z",
    "size": 21051,
    "stars": 6480,
    "forks": 594,
    "open_issues": 442,
    "watchers": 6480,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Go": 3760987,
      "Lua": 82633,
      "Shell": 62175,
      "Python": 40259,
      "Makefile": 35276,
      "Dockerfile": 22803,
      "Elixir": 9158,
      "Ruby": 9083,
      "Java": 6170,
      "Erlang": 5108,
      "C": 4597,
      "PHP": 1637,
      "C++": 1017,
      "Prolog": 764,
      "Roff": 360,
      "Rust": 281,
      "HTML": 132,
      "Vim Script": 89,
      "Perl": 5
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:22:08.603128"
  }
}