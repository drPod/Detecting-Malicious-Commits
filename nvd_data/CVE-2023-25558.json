{
  "cve_id": "CVE-2023-25558",
  "github_data": {
    "repository": "datahub-project/datahub",
    "fix_commit": "2a182f484677d056730d6b4e9f0143e67368359f",
    "related_commits": [
      "2a182f484677d056730d6b4e9f0143e67368359f",
      "2a182f484677d056730d6b4e9f0143e67368359f"
    ],
    "patch_url": "https://github.com/datahub-project/datahub/commit/2a182f484677d056730d6b4e9f0143e67368359f.patch",
    "fix_commit_details": {
      "sha": "2a182f484677d056730d6b4e9f0143e67368359f",
      "commit_date": "2022-12-22T02:11:11Z",
      "author": {
        "login": "david-leifker",
        "type": "User",
        "stats": {
          "total_commits": 770,
          "average_weekly_commits": 1.6075156576200418,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 107
        }
      },
      "commit_message": {
        "title": "fix(pac4j-oidc): add verifier parameter (#6835)",
        "length": 90,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "datahub-frontend/app/auth/sso/oidc/custom/CustomOidcAuthenticator.java",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -15,6 +15,7 @@\n import com.nimbusds.oauth2.sdk.http.HTTPRequest;\n import com.nimbusds.oauth2.sdk.http.HTTPResponse;\n import com.nimbusds.oauth2.sdk.id.ClientID;\n+import com.nimbusds.oauth2.sdk.pkce.CodeVerifier;\n import com.nimbusds.openid.connect.sdk.OIDCTokenResponse;\n import com.nimbusds.openid.connect.sdk.OIDCTokenResponseParser;\n import com.nimbusds.openid.connect.sdk.token.OIDCTokens;\n@@ -144,8 +145,10 @@ public void validate(final OidcCredentials credentials, final WebContext context\n     if (code != null) {\n       try {\n         final String computedCallbackUrl = client.computeFinalCallbackUrl(context);\n+        CodeVerifier verifier = (CodeVerifier) configuration.getValueRetriever()\n+                .retrieve(client.getCodeVerifierSessionAttributeName(), client, context).orElse(null);\n         // Token request\n-        final TokenRequest request = createTokenRequest(new AuthorizationCodeGrant(code, new URI(computedCallbackUrl)));\n+        final TokenRequest request = createTokenRequest(new AuthorizationCodeGrant(code, new URI(computedCallbackUrl), verifier));\n         HTTPRequest tokenHttpRequest = request.toHTTPRequest();\n         tokenHttpRequest.setConnectTimeout(configuration.getConnectTimeout());\n         tokenHttpRequest.setReadTimeout(configuration.getReadTimeout());"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4633fbfeca963aa7f2fdb49c879446170882c865",
            "date": "2025-01-14T19:09:08Z",
            "author_login": "ryota-cloud"
          },
          {
            "sha": "ebbadf65ad836e550af52566d7036a791ceafbfa",
            "date": "2025-01-14T09:50:14Z",
            "author_login": "asikowitz"
          },
          {
            "sha": "e1532a7f516c80906b74c53a89d3fd895c7dcf1d",
            "date": "2025-01-14T05:41:51Z",
            "author_login": "hsheth2"
          },
          {
            "sha": "ddd0d21bf9e2a084dea3dfc6f4e000a322c56e7b",
            "date": "2025-01-13T22:57:10Z",
            "author_login": "yoonhyejin"
          },
          {
            "sha": "e34b2e453c5ba0d4d13f0a6bbc993acbff2576aa",
            "date": "2025-01-13T20:56:25Z",
            "author_login": "hsheth2"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-502",
    "description": "DataHub is an open-source metadata platform. When the DataHub frontend is configured to authenticate via SSO, it will leverage the pac4j library. The processing of the `id_token` is done in an unsafe manner which is not properly accounted for by the DataHub frontend. Specifically, if any of the id_token claims value start with the {#sb64} prefix, pac4j considers the value to be a serialized Java object and will deserialize it. This issue may lead to Remote Code Execution (RCE) in the worst case. Although a `RestrictedObjectInputStream` is in place, that puts some restriction on what classes can be deserialized, it still allows a broad range of java packages and potentially exploitable with different gadget chains. Users are advised to upgrade. There are no known workarounds. This vulnerability was discovered and reported by the GitHub Security lab and is tracked as GHSL-2022-086.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-02-11T01:23:26.437",
    "last_modified": "2024-11-21T07:49:43.660",
    "fix_date": "2022-12-22T02:11:11Z"
  },
  "references": [
    {
      "url": "https://github.com/datahub-project/datahub/commit/2a182f484677d056730d6b4e9f0143e67368359f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/datahub-project/datahub/security/advisories/GHSA-hrwp-2q5c-86wv",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/datahub-project/datahub/commit/2a182f484677d056730d6b4e9f0143e67368359f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/datahub-project/datahub/security/advisories/GHSA-hrwp-2q5c-86wv",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.015419",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "datahub",
    "owner": "datahub-project",
    "created_at": "2015-11-18T05:47:40Z",
    "updated_at": "2025-01-14T10:20:05Z",
    "pushed_at": "2025-01-14T10:12:56Z",
    "size": 7102989,
    "stars": 10140,
    "forks": 3005,
    "open_issues": 343,
    "watchers": 10140,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 12156696,
      "Python": 9309146,
      "TypeScript": 4411513,
      "JavaScript": 471827,
      "SCSS": 168908,
      "Shell": 76802,
      "Mustache": 70180,
      "Dockerfile": 34205,
      "LookML": 24889,
      "Less": 21221,
      "MDX": 13023,
      "CSS": 8379,
      "HTML": 4768,
      "TSQL": 3635,
      "PLpgSQL": 3359,
      "Scala": 2310,
      "Makefile": 1222
    },
    "commit_activity": {
      "total_commits_last_year": 3235,
      "avg_commits_per_week": 62.21153846153846,
      "days_active_last_year": 308
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:54:10.052936"
  }
}