{
  "cve_id": "CVE-2023-25652",
  "github_data": {
    "repository": "git/git",
    "fix_commit": "18e2b1cfc80990719275d7b08e6e50f3e8cbc902",
    "related_commits": [
      "18e2b1cfc80990719275d7b08e6e50f3e8cbc902",
      "668f2d53613ac8fd373926ebe219f2c29112d93e",
      "18e2b1cfc80990719275d7b08e6e50f3e8cbc902",
      "668f2d53613ac8fd373926ebe219f2c29112d93e"
    ],
    "patch_url": "https://github.com/git/git/commit/18e2b1cfc80990719275d7b08e6e50f3e8cbc902.patch",
    "fix_commit_details": {
      "sha": "18e2b1cfc80990719275d7b08e6e50f3e8cbc902",
      "commit_date": "2023-03-02T23:13:30Z",
      "author": {
        "login": "gitster",
        "type": "User",
        "stats": {
          "total_commits": 22453,
          "average_weekly_commits": 21.77788554801164,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 884
        }
      },
      "commit_message": {
        "title": "Merge branch 'js/apply-overwrite-rej-symlink-if-exists' into maint-2.30",
        "length": 344,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 29,
        "additions": 27,
        "deletions": 2
      },
      "files": [
        {
          "filename": "apply.c",
          "status": "modified",
          "additions": 12,
          "deletions": 2,
          "patch": "@@ -4558,7 +4558,7 @@ static int write_out_one_reject(struct apply_state *state, struct patch *patch)\n \tFILE *rej;\n \tchar namebuf[PATH_MAX];\n \tstruct fragment *frag;\n-\tint cnt = 0;\n+\tint fd, cnt = 0;\n \tstruct strbuf sb = STRBUF_INIT;\n \n \tfor (cnt = 0, frag = patch->fragments; frag; frag = frag->next) {\n@@ -4598,7 +4598,17 @@ static int write_out_one_reject(struct apply_state *state, struct patch *patch)\n \tmemcpy(namebuf, patch->new_name, cnt);\n \tmemcpy(namebuf + cnt, \".rej\", 5);\n \n-\trej = fopen(namebuf, \"w\");\n+\tfd = open(namebuf, O_CREAT | O_EXCL | O_WRONLY, 0666);\n+\tif (fd < 0) {\n+\t\tif (errno != EEXIST)\n+\t\t\treturn error_errno(_(\"cannot open %s\"), namebuf);\n+\t\tif (unlink(namebuf))\n+\t\t\treturn error_errno(_(\"cannot unlink '%s'\"), namebuf);\n+\t\tfd = open(namebuf, O_CREAT | O_EXCL | O_WRONLY, 0666);\n+\t\tif (fd < 0)\n+\t\t\treturn error_errno(_(\"cannot open %s\"), namebuf);\n+\t}\n+\trej = fdopen(fd, \"w\");\n \tif (!rej)\n \t\treturn error_errno(_(\"cannot open %s\"), namebuf);\n "
        },
        {
          "filename": "t/t4115-apply-symlink.sh",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -125,4 +125,19 @@ test_expect_success SYMLINKS 'symlink escape when deleting file' '\n \ttest_path_is_file .git/delete-me\n '\n \n+test_expect_success SYMLINKS '--reject removes .rej symlink if it exists' '\n+\ttest_when_finished \"git reset --hard && git clean -dfx\" &&\n+\n+\ttest_commit file &&\n+\techo modified >file.t &&\n+\tgit diff -- file.t >patch &&\n+\techo modified-again >file.t &&\n+\n+\tln -s foo file.t.rej &&\n+\ttest_must_fail git apply patch --reject 2>err &&\n+\ttest_i18ngrep \"Rejected hunk\" err &&\n+\ttest_path_is_missing foo &&\n+\ttest_path_is_file file.t.rej\n+'\n+\n test_done"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "757161efcca150a9a96b312d9e780a071e601a03",
            "date": "2025-01-13T21:02:01Z",
            "author_login": "gitster"
          },
          {
            "sha": "46afc2ba91a3c7fa8f1591c0a6a1b7c4ad0d2a07",
            "date": "2025-01-13T21:00:48Z",
            "author_login": "gitster"
          },
          {
            "sha": "f93ff170b93a1782659637824b25923245ac9dd1",
            "date": "2025-01-13T20:57:19Z",
            "author_login": "gitster"
          },
          {
            "sha": "65faad6d841c29d4545e9cf3676d75f4e6e4872c",
            "date": "2025-01-13T20:55:26Z",
            "author_login": "gitster"
          },
          {
            "sha": "fbe8d3079d4a96aeb4e4529cc93cc0043b759a05",
            "date": "2025-01-10T17:20:20Z",
            "author_login": "gitster"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "Git is a revision control system. Prior to versions 2.30.9, 2.31.8, 2.32.7, 2.33.8, 2.34.8, 2.35.8, 2.36.6, 2.37.7, 2.38.5, 2.39.3, and 2.40.1, by feeding specially crafted input to `git apply --reject`, a path outside the working tree can be overwritten with partially controlled contents (corresponding to the rejected hunk(s) from the given patch). A fix is available in versions 2.30.9, 2.31.8, 2.32.7, 2.33.8, 2.34.8, 2.35.8, 2.36.6, 2.37.7, 2.38.5, 2.39.3, and 2.40.1. As a workaround, avoid using `git apply` with `--reject` when applying patches from an untrusted source. Use `git apply --stat` to inspect a patch before applying; avoid applying one that create a conflict where a link corresponding to the `*.rej` file exists.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-25T20:15:09.933",
    "last_modified": "2024-11-21T07:49:52.417",
    "fix_date": "2023-03-02T23:13:30Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/04/25/2",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/git/git/commit/18e2b1cfc80990719275d7b08e6e50f3e8cbc902",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/git/git/commit/668f2d53613ac8fd373926ebe219f2c29112d93e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/git/git/security/advisories/GHSA-2hvf-7c8p-28fx",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00018.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BSXOGVVBJLYX26IAYX6PJSYQB36BREWH/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PI7FZ4NNR5S5J5K6AMVQBH2JFP6NE4L7/",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RKOXOAZ42HLXHXTW6JZI4L5DAIYDTYCU/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YFZWGQKB6MM5MNF2DLFTD7KS2KWPICKL/",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202312-15",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/04/25/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/git/git/commit/18e2b1cfc80990719275d7b08e6e50f3e8cbc902",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/git/git/commit/668f2d53613ac8fd373926ebe219f2c29112d93e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/git/git/security/advisories/GHSA-2hvf-7c8p-28fx",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00018.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BSXOGVVBJLYX26IAYX6PJSYQB36BREWH/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PI7FZ4NNR5S5J5K6AMVQBH2JFP6NE4L7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RKOXOAZ42HLXHXTW6JZI4L5DAIYDTYCU/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YFZWGQKB6MM5MNF2DLFTD7KS2KWPICKL/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202312-15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.837882",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "git",
    "owner": "git",
    "created_at": "2008-07-23T14:21:26Z",
    "updated_at": "2025-01-14T14:01:56Z",
    "pushed_at": "2025-01-13T19:45:30Z",
    "size": 271691,
    "stars": 53164,
    "forks": 25796,
    "open_issues": 201,
    "watchers": 53164,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 11381600,
      "Shell": 8590199,
      "Perl": 1166701,
      "Tcl": 852369,
      "Python": 183463,
      "Makefile": 168746,
      "Meson": 106388,
      "JavaScript": 49713,
      "CMake": 46584,
      "M4": 38265,
      "Roff": 26859,
      "C++": 26403,
      "SmPL": 15676,
      "Go": 15064,
      "CSS": 10664,
      "Batchfile": 9822,
      "Emacs Lisp": 660,
      "PowerShell": 478,
      "ReScript": 92
    },
    "commit_activity": {
      "total_commits_last_year": 3693,
      "avg_commits_per_week": 71.01923076923077,
      "days_active_last_year": 312
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:39:36.932072"
  }
}