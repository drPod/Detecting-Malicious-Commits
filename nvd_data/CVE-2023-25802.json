{
  "cve_id": "CVE-2023-25802",
  "github_data": {
    "repository": "hap-wi/roxy-wi",
    "fix_commit": "0054f25da7cf8c7480452f48e39308b5e392dc67",
    "related_commits": [
      "0054f25da7cf8c7480452f48e39308b5e392dc67",
      "0054f25da7cf8c7480452f48e39308b5e392dc67"
    ],
    "patch_url": "https://github.com/hap-wi/roxy-wi/commit/0054f25da7cf8c7480452f48e39308b5e392dc67.patch",
    "fix_commit_details": {
      "sha": "0054f25da7cf8c7480452f48e39308b5e392dc67",
      "commit_date": "2023-02-22T07:36:20Z",
      "author": {
        "login": "Aidaho12",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "v6.3.6.0",
        "length": 56,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 81,
        "additions": 53,
        "deletions": 28
      },
      "files": [
        {
          "filename": "app/modules/roxywi/logs.py",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -78,6 +78,8 @@ def show_roxy_log(\n \n \tlog_file = checkAjaxInput(log_file) if log_file is not None else log_file\n \n+\tif '..' in log_file: return 'error: nice try'\n+\n \tif service in ('nginx', 'haproxy', 'apache', 'keepalived'):\n \t\tsyslog_server_enable = sql.get_setting('syslog_server_enable')\n \t\tif syslog_server_enable is None or syslog_server_enable == 0:"
        },
        {
          "filename": "app/modules/server/ssh.py",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -51,16 +51,16 @@ def ssh_connect(server_ip):\n def create_ssh_cred() -> None:\n \tfrom jinja2 import Environment, FileSystemLoader\n \n-\tuser_group = roxywi_common.get_user_group()\n \tname = common.checkAjaxInput(form.getvalue('new_ssh'))\n-\tname = f'{name}_{user_group}'\n \tenable = common.checkAjaxInput(form.getvalue('ssh_enable'))\n \tgroup = common.checkAjaxInput(form.getvalue('new_group'))\n+\tgroup_name = sql.get_group_name_by_id(group)\n \tusername = common.checkAjaxInput(form.getvalue('ssh_user'))\n \tpassword = common.checkAjaxInput(form.getvalue('ssh_pass'))\n \tpage = common.checkAjaxInput(form.getvalue('page'))\n \tpage = page.split(\"#\")[0]\n \tlang = roxywi_common.get_user_lang()\n+\tname = f'{name}_{group_name}'\n \n \tif username is None or name is None:\n \t\tprint(error_mess)\n@@ -91,6 +91,10 @@ def create_ssh_cread_api(name: str, enable: str, group: str, username: str, pass\n \n \n def upload_ssh_key(name: str, user_group: str, key: str) -> bool:\n+\tif '..' in name:\n+\t\tprint('error: nice try')\n+\t\treturn False\n+\n \ttry:\n \t\tkey = paramiko.pkey.load_private_key(key)\n \texcept Exception as e:"
        },
        {
          "filename": "app/scripts/ansible/roles/haproxy/tasks/logs.yml",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -11,4 +11,5 @@\n     src: /var/www/haproxy-wi/app/scripts/ansible/roles/haproxy/templates/logrotate.conf.j2\n     dest: /etc/logrotate.d/haproxy.conf\n     force: no\n+  when: (ansible_facts['os_family'] == \"RedHat\" or ansible_facts['os_family'] == 'CentOS')\n   ignore_errors: yes\n\\ No newline at end of file"
        },
        {
          "filename": "app/templates/ajax/new_ssh.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -15,7 +15,7 @@\n \t\t\t<td>\n \t\t\t\t<select id=\"sshgroup-{{ssh.id}}\" name=\"sshgroup-{{ssh.id}}\">\n \t\t\t\t\t{% for group in groups %}\n-\t\t\t\t\t\t{% if ssh.5 == group.group_id %}\n+\t\t\t\t\t\t{% if ssh.groups == group.group_id %}\n \t\t\t\t\t\t\t<option value=\"{{ group.group_id }}\" selected>{{ group.name }}</option>\n \t\t\t\t\t\t{% else %}\n \t\t\t\t\t\t\t<option value=\"{{ group.group_id }}\">{{ group.name }}</option>"
        },
        {
          "filename": "app/templates/base.html",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -6,15 +6,17 @@\n \t\t<meta http-equiv=\"Cache-Control\" content=\"no-cache, no-store, must-revalidate\" />\n \t\t<meta http-equiv=\"Pragma\" content=\"no-cache\" />\n \t\t<meta http-equiv=\"Expires\" content=\"0\" />\n-\t\t<meta id=\"translate\" style=\"display: none;\" data-delete=\"{{lang.words.delete|title()}}\" data-cancel=\"{{lang.words.cancel|title()}}\"  data-add=\"{{lang.words.add|title()}}\" \\\n+\t\t<meta id=\"translate\" style=\"display: none;\" data-delete=\"{{lang.words.delete|title()}}\" data-cancel=\"{{lang.words.cancel|title()}}\" data-add=\"{{lang.words.add|title()}}\"\n \t\t\t  data-superAdmin_pass=\"{{lang.phrases.superAdmin_pass}}\" data-superAdmin_services=\"{{lang.phrases.superAdmin_services}}\" data-change=\"{{lang.words.change|title()}}\"\n \t\t\t  data-change2=\"{{lang.words.change2|title()}}\" data-password=\"{{lang.words.password}}\" data-groups=\"{{lang.words.groups}}\" data-save=\"{{lang.words.save|title()}}\"\n \t\t\t  data-manage=\"{{lang.words.manage|title()}}\" data-services3=\"{{lang.words.services3}}\" data-logout=\"{{lang.words.logout|title()}}\"\n \t\t\t  data-something_wrong=\"{{lang.words.something_wrong}}\" data-check_logs=\"{{lang.words.check_logs}}\" data-wait_mess=\"{{lang.phrases.wait_mess}}\"\n \t\t\t  data-just_save=\"{{lang.words.just|title()}} {{lang.words.save}}\" data-upload_and_restart=\"{{lang.phrases.upload_and_restart|title()}}\"\n \t\t\t  data-are_you_sure=\"{{lang.phrases.are_you_sure}}\" data-upload_and_reload=\"{{lang.phrases.upload_and_reload|title()}}\" data-select_server=\"{{lang.errors.select_server}}\"\n \t\t\t  data-empty_name=\"{{lang.errors.empty_name}}\" data-edit=\"{{lang.words.edit|title()}}\" data-close=\"{{lang.words.close|title()}}\" data-server_info=\"{{lang.phrases.server_info}}\"\n-\t\t\t  data-generated_config=\"{{lang.words.generated|title()}} {{lang.words.config}}\" />\n+\t\t\t  data-generated_config=\"{{lang.words.generated|title()}} {{lang.words.config}}\" data-restart=\"{{lang.words.restart|title()}}\" data-start=\"{{lang.words.start|title()}}\"\n+\t\t\t  data-stop=\"{{lang.words.stop|title()}}\" data-reload=\"{{lang.words.reload|title()}}\" data-user_groups=\"{{lang.phrases.user_groups}}\" data-settings=\"{{lang.words.settings|title()}}\"\n+\t\t\t  data-for=\"{{lang.words.for}}\" />\n \t\t{% if title == 'Login page' %}\n \t\t<meta name=\"viewport\" content=\"width=device-width, user-scalable=1\">\n \t\t{% endif %}"
        },
        {
          "filename": "app/templates/hapservers.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -419,7 +419,7 @@\n \t{% endfor %}\n {% endif %}\n <div id=\"dialog-confirm\" style=\"display: none;\">\n-  <p><span class=\"ui-icon ui-icon-alert\" style=\"float:left; margin:3px 12px 20px 0;\"></span>Are you sure?</p>\n+  <p><span class=\"ui-icon ui-icon-alert\" style=\"float:left; margin:3px 12px 20px 0;\"></span>{{lang.phrases.are_you_sure}}</p>\n </div>\n <div id=\"dialog-settings-service\" style=\"display: none;\"></div>\n <script>"
        },
        {
          "filename": "app/templates/include/admin_add_user.html",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -1,30 +1,30 @@\n {% from 'include/input_macros.html' import input, checkbox %}\n <tr>\n \t<td class=\"padding20\">\n-\t\tNew user\n+\t\t{{lang.words.name|title()}}\n \t\t<span class=\"need-field\">*</span>\n \t</td>\n \t<td>\n \t\t{{ input('new-username') }}\n \t\t\t{% if ldap_enable == 1 %}\n-\t\t\t\t<a href=\"#\" title=\"Search user in AD\" id=\"search_ldap_user\">Search user in AD</a>\n+\t\t\t\t<a href=\"#\" title=\"{{lang.phrases.search_id_ad}}\" id=\"search_ldap_user\">{{lang.phrases.search_in_ad}}</a>\n \t\t\t{% endif %}\n \t</td>\n </tr>\n <tr>\n \t<td class=\"padding20\">\n-\t\tPassword\n+\t\t{{lang.words.password|title()}}\n \t\t<span class=\"need-field\">*</span>\n \t</td>\n \t<td>{{ input('new-password', type='password') }}</td>\n </tr>\n <tr>\n-\t<td class=\"padding20\">Active</td>\n+\t<td class=\"padding20\">{{lang.words.active|title()}}</td>\n \t<td>{{ checkbox('activeuser', checked='checked') }}</td>\n </tr>\n <tr>\n \t<td class=\"padding20\">\n-\t\tEmail\n+\t\t{{lang.words.email|title()}}\n \t\t<span class=\"need-field\">*</span>\n \t</td>\n \t<td>{{ input('new-email', type='email') }}</td>"
        },
        {
          "filename": "app/templates/include/admin_ssh.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -31,7 +31,7 @@\n         <td>\n             <select id=\"sshgroup-{{ssh.id}}\" name=\"sshgroup-{{ssh.id}}\">\n                 {% for group in groups %}\n-                {% if ssh.5 == group.group_id %}\n+                {% if ssh.groups == group.group_id %}\n                 <option value=\"{{ group.group_id }}\" selected>{{ group.name }}</option>\n                 {% else %}\n                 <option value=\"{{ group.group_id }}\">{{ group.name }}</option>"
        },
        {
          "filename": "app/templates/languages/en.html",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -292,6 +292,7 @@\n     \"port_check\": \"port check\",\n     \"possible_service_name\": \"Possible service name\",\n     \"server_info\": \"Server info\",\n+    \"user_groups\": \"User groups\",\n     }\n %}\n {% set roles = {\n@@ -541,6 +542,7 @@\n     \"desc\": \"description\",\n     \"login\": \"login\",\n     \"role\": \"role\",\n+    \"roles\": \"roles\",\n     \"subs\": \"subscription\",\n     \"show_all\": \"show all\",\n     \"plan\": \"plan\","
        },
        {
          "filename": "app/templates/languages/ru.html",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -294,6 +294,7 @@\n     \"port_check\": \"\u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u043e\u0440\u0442\u0430\",\n     \"possible_service_name\": \"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u043b\u0443\u0436\u0431\u044b\",\n     \"server_info\": \"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0441\u0435\u0440\u0432\u0435\u0440\u0435\",\n+    \"user_groups\": \"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b\",\n     }\n %}\n {% set roles = {\n@@ -545,6 +546,7 @@\n     \"desc\": \"\u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435\",\n     \"login\": \"\u043b\u043e\u0433\u0438\u043d\",\n     \"role\": \"\u0440\u043e\u043b\u044c\",\n+    \"roles\": \"\u0440\u043e\u043b\u0438\",\n     \"subs\": \"\u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430\",\n     \"show_all\": \"\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435\",\n     \"plan\": \"\u043f\u043b\u0430\u043d\","
        },
        {
          "filename": "inc/overview.js",
          "status": "modified",
          "additions": 28,
          "deletions": 16,
          "patch": "@@ -409,19 +409,22 @@ $( function() {\n \t});\n });\n function confirmAjaxAction(action, service, id) {\n+\tvar cancel_word = $('#translate').attr('data-cancel');\n+\tvar action_word = $('#translate').attr('data-'+action);\n \t$( \"#dialog-confirm\" ).dialog({\n \t\tresizable: false,\n \t\theight: \"auto\",\n \t\twidth: 400,\n \t\tmodal: true,\n-\t\ttitle: \"Are you sure you want to \"+ action + \" \" + id + \"?\",\n-\t\tbuttons: {\n-\t\t\t\"Sure\": function() {\n-\t\t\t\t$( this ).dialog( \"close\" );\n-\t\t\t\tif(service == \"haproxy\") {\n+\t\ttitle: action_word + \" \" + id + \"?\",\n+\t\tbuttons: [{\n+\t\t\ttext: action_word,\n+\t\t\tclick: function () {\n+\t\t\t\t$(this).dialog(\"close\");\n+\t\t\t\tif (service == \"haproxy\") {\n \t\t\t\t\tajaxActionServers(action, id);\n-\t\t\t\t\tif(action == \"restart\" || action == \"reload\") {\n-\t\t\t\t\t\tif(localStorage.getItem('restart')) {\n+\t\t\t\t\tif (action == \"restart\" || action == \"reload\") {\n+\t\t\t\t\t\tif (localStorage.getItem('restart')) {\n \t\t\t\t\t\t\tlocalStorage.removeItem('restart');\n \t\t\t\t\t\t\t$(\"#apply\").css('display', 'none');\n \t\t\t\t\t\t}\n@@ -437,11 +440,13 @@ function confirmAjaxAction(action, service, id) {\n \t\t\t\t} else if (service == \"waf_nginx\") {\n \t\t\t\t\tajaxActionWafNginxServers(action, id)\n \t\t\t\t}\n-\t\t\t},\n-\t\t\tCancel: function() {\n+\t\t\t}\n+\t\t}, {\n+\t\t\ttext: cancel_word,\n+\t\t\tclick: function() {\n \t\t\t\t$( this ).dialog( \"close\" );\n \t\t\t}\n-\t\t}\n+\t\t}]\n \t});\n }\n function updateHapWIServer(id, service_name) {\n@@ -628,6 +633,10 @@ function showSubOverview() {\n \t} );\n }\n function serverSettings(id, name) {\n+\tvar cancel_word = $('#translate').attr('data-cancel');\n+\tvar save_word = $('#translate').attr('data-save');\n+\tvar settings_word = $('#translate').attr('data-settings');\n+\tvar for_word = $('#translate').attr('data-for');\n \tvar service = $('#service').val();\n \t$.ajax({\n \t\turl: \"options.py\",\n@@ -649,16 +658,19 @@ function serverSettings(id, name) {\n \t\t\t\t\theight: \"auto\",\n \t\t\t\t\twidth: 400,\n \t\t\t\t\tmodal: true,\n-\t\t\t\t\ttitle: \"Settings for \" + name,\n-\t\t\t\t\tbuttons: {\n-\t\t\t\t\t\t\"Save\": function () {\n+\t\t\t\t\ttitle: settings_word + \" \"+for_word+\" \" + name,\n+\t\t\t\t\tbuttons: [{\n+\t\t\t\t\t\ttext: save_word,\n+\t\t\t\t\t\tclick: function () {\n \t\t\t\t\t\t\t$(this).dialog(\"close\");\n \t\t\t\t\t\t\tserverSettingsSave(id, name, service, $(this));\n-\t\t\t\t\t\t},\n-\t\t\t\t\t\tCancel: function () {\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}, {\n+\t\t\t\t\t\ttext: cancel_word,\n+\t\t\t\t\t\tclick: function () {\n \t\t\t\t\t\t\t$(this).dialog(\"close\");\n \t\t\t\t\t\t}\n-\t\t\t\t\t}\n+\t\t\t\t\t}]\n \t\t\t\t});\n \t\t\t}\n \t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 8,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e53a7445c7ce745ce79b0eb575e090ec988deea7",
            "date": "2025-01-04T07:49:28Z",
            "author_login": "Aidaho12"
          },
          {
            "sha": "f3c7cf97f2981efed91f98d7bb73cc3614e9ca1e",
            "date": "2025-01-02T12:00:30Z",
            "author_login": "Aidaho12"
          },
          {
            "sha": "c8b1822e8ae63d577cb529bfb12fd4057b69d1d5",
            "date": "2024-12-28T08:09:20Z",
            "author_login": "Aidaho12"
          },
          {
            "sha": "8ec6d0a0d353f20eb37788b64db6132f3d1bb365",
            "date": "2024-12-26T19:54:48Z",
            "author_login": "Aidaho12"
          },
          {
            "sha": "6ba2567bdd2116097150178b7720b67170614161",
            "date": "2024-12-26T11:04:53Z",
            "author_login": "Aidaho12"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Roxy-WI is a Web interface for managing Haproxy, Nginx, Apache, and Keepalived servers. Versions prior to 6.3.6.0 don't correctly neutralize `dir/../filename` sequences, such as `/etc/nginx/../passwd`, allowing an actor to gain information about a server. Version 6.3.6.0 has a patch for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-13T20:15:14.967",
    "last_modified": "2024-11-21T07:50:13.853",
    "fix_date": "2023-02-22T07:36:20Z"
  },
  "references": [
    {
      "url": "https://github.com/hap-wi/roxy-wi/commit/0054f25da7cf8c7480452f48e39308b5e392dc67",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/hap-wi/roxy-wi/security/advisories/GHSA-qcmp-q5h3-784m",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/hap-wi/roxy-wi/commit/0054f25da7cf8c7480452f48e39308b5e392dc67",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/hap-wi/roxy-wi/security/advisories/GHSA-qcmp-q5h3-784m",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.837653",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "roxy-wi",
    "owner": "hap-wi",
    "created_at": "2018-01-15T05:58:01Z",
    "updated_at": "2025-01-13T06:59:27Z",
    "pushed_at": "2025-01-04T07:49:32Z",
    "size": 44327,
    "stars": 1563,
    "forks": 255,
    "open_issues": 6,
    "watchers": 1563,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 885470,
      "HTML": 754027,
      "JavaScript": 388825,
      "CSS": 70598,
      "Jinja": 52960,
      "Shell": 7056
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:57:11.087124"
  }
}