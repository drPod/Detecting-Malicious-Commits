{
  "cve_id": "CVE-2023-25807",
  "github_data": {
    "repository": "dataease/dataease",
    "fix_commit": "cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49",
    "related_commits": [
      "cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49",
      "cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49"
    ],
    "patch_url": "https://github.com/dataease/dataease/commit/cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49.patch",
    "fix_commit_details": {
      "sha": "cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49",
      "commit_date": "2023-02-21T06:00:47Z",
      "author": {
        "login": "ziyujiahao",
        "type": "User",
        "stats": {
          "total_commits": 4557,
          "average_weekly_commits": 5.910505836575876,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 186
        }
      },
      "commit_message": {
        "title": "Merge pull request #4596 from dataease/pr@dev@refactor_xss-attack",
        "length": 93,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 16,
        "deletions": 7
      },
      "files": [
        {
          "filename": "frontend/package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -88,7 +88,8 @@\n     \"vuedraggable\": \"^2.24.3\",\n     \"vuex\": \"3.1.0\",\n     \"webpack\": \"^4.46.0\",\n-    \"xlsx\": \"^0.17.0\"\n+    \"xlsx\": \"^0.17.0\",\n+    \"xss\": \"^1.0.14\"\n   },\n   \"devDependencies\": {\n     \"@babel/core\": \"^7.4.0-0\","
        },
        {
          "filename": "frontend/src/components/canvas/customComponent/DeRichText.vue",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -37,6 +37,7 @@ import 'tinymce/plugins/nonbreaking'\n import 'tinymce/plugins/pagebreak'\n import { mapState } from 'vuex'\n import Vue from 'vue'\n+import xssCheck from 'xss'\n \n export default {\n   name: 'DeRichText',\n@@ -77,7 +78,7 @@ export default {\n       canEdit: false,\n       // \u521d\u59cb\u5316\u914d\u7f6e\n       tinymceId: 'tinymce-' + this.element.id,\n-      myValue: this.propValue,\n+      myValue: xssCheck(this.propValue),\n       init: {\n         selector: '#tinymce-' + this.element.id,\n         toolbar_items_size: 'small',"
        },
        {
          "filename": "frontend/src/components/canvas/customComponent/DeRichTextView.vue",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -38,6 +38,7 @@ import 'tinymce/plugins/pagebreak'\n import { mapState } from 'vuex'\n import bus from '@/utils/bus'\n import { uuid } from 'vue-uuid'\n+import xssCheck from 'xss'\n \n export default {\n   name: 'DeRichTextView',\n@@ -152,7 +153,7 @@ export default {\n     viewInit() {\n       bus.$on('fieldSelect-' + this.element.propValue.viewId, this.fieldSelect)\n       tinymce.init({})\n-      this.myValue = this.assignment(this.element.propValue.textValue)\n+      this.myValue = xssCheck(this.assignment(this.element.propValue.textValue))\n       bus.$on('initCurFields-' + this.element.id, this.initCurFieldsChange)\n       this.$nextTick(() => {\n         this.initReady = true"
        },
        {
          "filename": "frontend/src/components/canvas/customComponent/VText.vue",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -18,7 +18,7 @@\n       @mousedown=\"handleMousedown\"\n       @blur=\"handleBlur\"\n       @input=\"handleInput\"\n-      v-html=\"element.propValue\"\n+      v-html=\"$xss(element.propValue)\"\n     />\n     <div\n       v-if=\"!canEdit\"\n@@ -28,7 +28,7 @@\n       @mousedown=\"handleMousedown\"\n       @blur=\"handleBlur\"\n       @input=\"handleInput\"\n-      v-html=\"element.propValue\"\n+      v-html=\"$xss(element.propValue)\"\n     />\n   </div>\n   <div\n@@ -37,7 +37,7 @@\n   >\n     <div\n       :style=\"{ verticalAlign: element.style.verticalAlign }\"\n-      v-html=\"textInfo\"\n+      v-html=\"$xss(textInfo)\"\n     />\n   </div>\n </template>\n@@ -80,7 +80,7 @@ export default {\n     },\n     textInfo() {\n       if (this.element && this.element.hyperlinks && this.element.hyperlinks.enable) {\n-        return \"<a title='\" + this.element.hyperlinks.content + \"' target='\" + this.element.hyperlinks.openMode + \"' href='\" + this.element.hyperlinks.content + \"'>\" + this.element.propValue + '</a>'\n+        return '<a title=\\'' + this.element.hyperlinks.content + '\\' target=\\'' + this.element.hyperlinks.openMode + '\\' href=\\'' + this.element.hyperlinks.content + '\\'>' + this.element.propValue + '</a>'\n       } else {\n         return this.element.propValue\n       }"
        },
        {
          "filename": "frontend/src/main.js",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -43,6 +43,12 @@ import 'video.js/dist/video-js.css'\n // \u63a7\u5236\u6807\u7b7e\u5bbd\u9ad8\u6210\u6bd4\u4f8b\u7684\u6307\u4ee4\n import proportion from 'vue-proportion-directive'\n \n+import xss from 'xss'\n+// \u5b9a\u4e49\u5168\u5c40XSS\u89e3\u51b3\u65b9\u6cd5\n+Object.defineProperty(Vue.prototype, '$xss', {\n+  value: xss\n+})\n+\n Vue.config.productionTip = false\n Vue.use(VueClipboard)\n Vue.use(widgets)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3d7dcc9e7523ab298dc57ba412989f659794c3e4",
            "date": "2025-01-14T10:19:36Z",
            "author_login": "dataeaseShu"
          },
          {
            "sha": "e6c5f45bb7e044fedbe2aa03daf01f3c330e73f5",
            "date": "2025-01-14T09:55:57Z",
            "author_login": "ulleo"
          },
          {
            "sha": "8a25535ecafdbca3d1d966ebffbee228a495d2cd",
            "date": "2025-01-14T09:50:53Z",
            "author_login": "dataeaseShu"
          },
          {
            "sha": "bb7be5c912c59408fcbc4c675d9db42e20d9e355",
            "date": "2025-01-14T09:50:29Z",
            "author_login": "dataeaseShu"
          },
          {
            "sha": "60b0f9c124f9d2fe13e2457f38dff16e7b4525b4",
            "date": "2025-01-14T09:18:10Z",
            "author_login": "ulleo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "DataEase is an open source data visualization and analysis tool. When saving a dashboard on the DataEase platform saved data can be modified and store malicious code. This vulnerability can lead to the execution of malicious code stored by the attacker on the server side when the user accesses the dashboard. The vulnerability has been fixed in version 1.18.3.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-28T16:15:09.353",
    "last_modified": "2024-11-21T07:50:14.440",
    "fix_date": "2023-02-21T06:00:47Z"
  },
  "references": [
    {
      "url": "https://github.com/dataease/dataease/commit/cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/dataease/dataease/security/advisories/GHSA-xj3h-3wmw-j5vf",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/dataease/dataease/commit/cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/dataease/dataease/security/advisories/GHSA-xj3h-3wmw-j5vf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.784431",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dataease",
    "owner": "dataease",
    "created_at": "2021-02-02T04:10:21Z",
    "updated_at": "2025-01-14T14:38:02Z",
    "pushed_at": "2025-01-14T11:00:19Z",
    "size": 298499,
    "stars": 18879,
    "forks": 3405,
    "open_issues": 388,
    "watchers": 18879,
    "has_security_policy": false,
    "default_branch": "dev-v2",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "Java": 15120013,
      "Vue": 3999652,
      "Shell": 26817,
      "Lua": 22086,
      "Less": 12316,
      "Dockerfile": 952
    },
    "commit_activity": {
      "total_commits_last_year": 7385,
      "avg_commits_per_week": 142.01923076923077,
      "days_active_last_year": 278
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:09:59.807295"
  }
}