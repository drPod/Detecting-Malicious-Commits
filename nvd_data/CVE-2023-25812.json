{
  "cve_id": "CVE-2023-25812",
  "github_data": {
    "repository": "minio/minio",
    "fix_commit": "a7188bc9d0f0a5ae05aaf1b8126bcd3cb3fdc485",
    "related_commits": [
      "a7188bc9d0f0a5ae05aaf1b8126bcd3cb3fdc485",
      "a7188bc9d0f0a5ae05aaf1b8126bcd3cb3fdc485"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a7188bc9d0f0a5ae05aaf1b8126bcd3cb3fdc485",
      "commit_date": "2023-02-17T02:23:34Z",
      "author": {
        "login": "vadmeste",
        "type": "User",
        "stats": {
          "total_commits": 898,
          "average_weekly_commits": 1.6753731343283582,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 345
        }
      },
      "commit_message": {
        "title": "fix: evaluate BypassGov policy action in deletion correctly (#16635)",
        "length": 68,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 2,
        "deletions": 5
      },
      "files": [
        {
          "filename": "cmd/bucket-object-lock.go",
          "status": "modified",
          "additions": 2,
          "deletions": 5,
          "patch": "@@ -156,11 +156,8 @@ func enforceRetentionBypassForDelete(ctx context.Context, r *http.Request, bucke\n \t\t\t\treturn ErrNone\n \t\t\t}\n \t\t\t// https://docs.aws.amazon.com/AmazonS3/latest/dev/object-lock-overview.html#object-lock-retention-modes\n-\t\t\t// If you try to delete objects protected by governance mode and have s3:BypassGovernanceRetention\n-\t\t\t// or s3:GetBucketObjectLockConfiguration permissions, the operation will succeed.\n-\t\t\tgovBypassPerms1 := checkRequestAuthType(ctx, r, policy.BypassGovernanceRetentionAction, bucket, object.ObjectName)\n-\t\t\tgovBypassPerms2 := checkRequestAuthType(ctx, r, policy.GetBucketObjectLockConfigurationAction, bucket, object.ObjectName)\n-\t\t\tif govBypassPerms1 != ErrNone && govBypassPerms2 != ErrNone {\n+\t\t\t// If you try to delete objects protected by governance mode and have s3:BypassGovernanceRetention, the operation will succeed.\n+\t\t\tif checkRequestAuthType(ctx, r, policy.BypassGovernanceRetentionAction, bucket, object.ObjectName) != ErrNone {\n \t\t\t\treturn ErrAccessDenied\n \t\t\t}\n \t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c5d19ecebb67952ea69bae6a5495f394b42896c3",
            "date": "2025-01-24T19:27:43Z",
            "author_login": "harshavardhana"
          },
          {
            "sha": "ed29a525b398aa57e9ff419806796e61b44873d7",
            "date": "2025-01-21T10:10:10Z",
            "author_login": "harshavardhana"
          },
          {
            "sha": "020c46cd3c2841fa2bc0608de1f83d2d43d5c485",
            "date": "2025-01-21T09:44:32Z",
            "author_login": "minio-trusted"
          },
          {
            "sha": "827004cd6d3da8f49a5320c94ae74ae128156ed6",
            "date": "2025-01-20T14:49:07Z",
            "author_login": "klauspost"
          },
          {
            "sha": "779ec8f0d423ee8114ef752628f4208c69c78445",
            "date": "2025-01-19T23:13:17Z",
            "author_login": "harshavardhana"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
    "cwe_id": "CWE-281",
    "description": "Minio is a Multi-Cloud Object Storage framework. Affected versions do not correctly honor a `Deny` policy on ByPassGoverance. Ideally, minio should return \"Access Denied\" to all users attempting to DELETE a versionId  with the special header `X-Amz-Bypass-Governance-Retention: true`.  However, this was not honored instead the request will be honored and an object under governance would be incorrectly deleted.  All users are advised to upgrade. There are no known workarounds for this issue.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-21T21:15:11.507",
    "last_modified": "2024-11-21T07:50:14.950",
    "fix_date": "2023-02-17T02:23:34Z"
  },
  "references": [
    {
      "url": "https://github.com/minio/minio/commit/a7188bc9d0f0a5ae05aaf1b8126bcd3cb3fdc485",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/minio/minio/pull/16635",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/minio/minio/security/advisories/GHSA-c8fc-mjj8-fc63",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/minio/minio/commit/a7188bc9d0f0a5ae05aaf1b8126bcd3cb3fdc485",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/minio/minio/pull/16635",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/minio/minio/security/advisories/GHSA-c8fc-mjj8-fc63",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:04.091054",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "minio",
    "owner": "minio",
    "created_at": "2015-01-14T19:23:58Z",
    "updated_at": "2025-01-26T06:11:32Z",
    "pushed_at": "2025-01-24T19:27:43Z",
    "size": 132274,
    "stars": 49715,
    "forks": 5636,
    "open_issues": 35,
    "watchers": 49715,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release"
    ],
    "languages": {
      "Go": 8678603,
      "Shell": 71969,
      "Makefile": 11634,
      "Mustache": 6628,
      "Smarty": 872,
      "Dockerfile": 229
    },
    "commit_activity": {
      "total_commits_last_year": 893,
      "avg_commits_per_week": 17.173076923076923,
      "days_active_last_year": 266
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T08:11:02.719445"
  }
}