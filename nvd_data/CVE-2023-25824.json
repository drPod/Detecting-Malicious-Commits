{
  "cve_id": "CVE-2023-25824",
  "github_data": {
    "repository": "airtower-luna/mod_gnutls",
    "fix_commit": "d7eec4e598158ab6a98bf505354e84352f9715ec",
    "related_commits": [
      "d7eec4e598158ab6a98bf505354e84352f9715ec",
      "d7eec4e598158ab6a98bf505354e84352f9715ec"
    ],
    "patch_url": "https://github.com/airtower-luna/mod_gnutls/commit/d7eec4e598158ab6a98bf505354e84352f9715ec.patch",
    "fix_commit_details": {
      "sha": "d7eec4e598158ab6a98bf505354e84352f9715ec",
      "commit_date": "2023-02-23T10:55:53Z",
      "author": {
        "login": "airtower-luna",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix loop in blocking read on transport timeout",
        "length": 648,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 7,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/gnutls_io.c",
          "status": "modified",
          "additions": 7,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n  *  Copyright 2004-2005 Paul Querna\n  *  Copyright 2008 Nikos Mavrogiannopoulos\n  *  Copyright 2011 Dash Shendy\n- *  Copyright 2015-2020 Fiona Klute\n+ *  Copyright 2015-2022 Fiona Klute\n  *\n  *  Licensed under the Apache License, Version 2.0 (the \"License\");\n  *  you may not use this file except in compliance with the License.\n@@ -277,6 +277,11 @@ static apr_status_t gnutls_io_input_read(mgs_handle_t * ctxt,\n                         gnutls_alert_get_name(rc));\n                 ctxt->input_rc = APR_EGENERAL;\n                 break;\n+            } else if (rc == GNUTLS_E_PULL_ERROR\n+                       && APR_STATUS_IS_TIMEUP(ctxt->input_rc)) {\n+                ap_log_cerror(\n+                    APLOG_MARK, APLOG_TRACE2, ctxt->input_rc, ctxt->c,\n+                    \"%s: transport read timed out\", __func__);\n             } else {\n                 /* Some Other Error. Report it. Die. */\n                 if (gnutls_error_is_fatal(rc)) {\n@@ -1003,7 +1008,7 @@ ssize_t mgs_transport_read(gnutls_transport_ptr_t ptr,\n             && APR_BRIGADE_EMPTY(ctxt->input_bb))\n         {\n             ctxt->input_rc = rc;\n-            gnutls_transport_set_errno(ctxt->session, EAGAIN);\n+            gnutls_transport_set_errno(ctxt->session, ETIMEDOUT);\n             return -1;\n         }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1a4498f41c62e3a97e037278bfd8cd548c6e4dcc",
            "date": "2024-03-12T21:47:39Z",
            "author_login": "airtower-luna"
          },
          {
            "sha": "4fa250553f9e77d105225d4356e6ed2c01e8eae0",
            "date": "2024-03-12T21:35:33Z",
            "author_login": "airtower-luna"
          },
          {
            "sha": "562bdb00c60cb26719c37adc62d14dbc32007f65",
            "date": "2024-03-12T21:23:51Z",
            "author_login": "airtower-luna"
          },
          {
            "sha": "b045d9bad82872f7510d73921d7f2f9660fff254",
            "date": "2024-03-12T21:16:12Z",
            "author_login": "airtower-luna"
          },
          {
            "sha": "fce559c27e318f36a7d485ce09c51d95ca60e9ff",
            "date": "2024-03-12T00:35:03Z",
            "author_login": "airtower-luna"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-835",
    "description": "Mod_gnutls is a TLS module for Apache HTTPD based on GnuTLS. Versions from 0.9.0 to 0.12.0 (including) did not properly fail blocking read operations on TLS connections when the transport hit timeouts. Instead it entered an endless loop retrying the read operation, consuming CPU resources. This could be exploited for denial of service attacks. If trace level logging was enabled, it would also produce an excessive amount of log output during the loop, consuming disk space. The problem has been fixed in commit d7eec4e598158ab6a98bf505354e84352f9715ec, please update to version 0.12.1. There are no workarounds, users who cannot update should apply the errno fix detailed in the security advisory. \n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-02-23T22:15:11.670",
    "last_modified": "2024-11-21T07:50:16.437",
    "fix_date": "2023-02-23T10:55:53Z"
  },
  "references": [
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=942737#25",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Mailing List",
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/airtower-luna/mod_gnutls/commit/d7eec4e598158ab6a98bf505354e84352f9715ec",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/airtower-luna/mod_gnutls/security/advisories/GHSA-6cfv-fvgm-7pc8",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=942737#25",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Mailing List",
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/airtower-luna/mod_gnutls/commit/d7eec4e598158ab6a98bf505354e84352f9715ec",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/airtower-luna/mod_gnutls/security/advisories/GHSA-6cfv-fvgm-7pc8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.766484",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mod_gnutls",
    "owner": "airtower-luna",
    "created_at": "2015-01-13T16:12:31Z",
    "updated_at": "2024-09-29T01:34:40Z",
    "pushed_at": "2024-10-18T20:36:59Z",
    "size": 2714,
    "stars": 14,
    "forks": 7,
    "open_issues": 3,
    "watchers": 14,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 294542,
      "Python": 92866,
      "M4": 43891,
      "Makefile": 22013,
      "Shell": 3173,
      "Emacs Lisp": 125
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T18:41:43.089033"
  }
}