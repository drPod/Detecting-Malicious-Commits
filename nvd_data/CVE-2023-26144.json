{
  "cve_id": "CVE-2023-26144",
  "github_data": {
    "repository": "graphql/graphql-js",
    "fix_commit": "f94b511386c7e47bd0380dcd56553dc063320226",
    "related_commits": [
      "f94b511386c7e47bd0380dcd56553dc063320226",
      "f94b511386c7e47bd0380dcd56553dc063320226"
    ],
    "patch_url": "https://github.com/graphql/graphql-js/commit/f94b511386c7e47bd0380dcd56553dc063320226.patch",
    "fix_commit_details": {
      "sha": "f94b511386c7e47bd0380dcd56553dc063320226",
      "commit_date": "2023-09-05T18:29:40Z",
      "author": {
        "login": "AaronMoat",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "OverlappingFieldsCanBeMergedRule: Fix performance degradation (#3958)",
        "length": 265,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 82,
        "additions": 66,
        "deletions": 16
      },
      "files": [
        {
          "filename": "benchmark/repeated-fields-benchmark.js",
          "status": "added",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -0,0 +1,13 @@\n+import { graphqlSync } from 'graphql/graphql.js';\n+import { buildSchema } from 'graphql/utilities/buildASTSchema.js';\n+\n+const schema = buildSchema('type Query { hello: String! }');\n+const source = `{ ${'hello '.repeat(250)}}`;\n+\n+export const benchmark = {\n+  name: 'Many repeated fields',\n+  count: 5,\n+  measure() {\n+    graphqlSync({ schema, source });\n+  },\n+};"
        },
        {
          "filename": "src/validation/__tests__/OverlappingFieldsCanBeMergedRule-test.ts",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -179,6 +179,24 @@ describe('Validate: Overlapping fields can be merged', () => {\n     ]);\n   });\n \n+  it('different stream directive extra argument', () => {\n+    expectErrors(`\n+      fragment conflictingArgs on Dog {\n+        name @stream(label: \"streamLabel\", initialCount: 1)\n+        name @stream(label: \"streamLabel\", initialCount: 1, extraArg: true)\n+      }\n+    `).toDeepEqual([\n+      {\n+        message:\n+          'Fields \"name\" conflict because they have differing stream directives. Use different aliases on the fields to fetch both if this was intentional.',\n+        locations: [\n+          { line: 3, column: 9 },\n+          { line: 4, column: 9 },\n+        ],\n+      },\n+    ]);\n+  });\n+\n   it('mix of stream and no stream', () => {\n     expectErrors(`\n       fragment conflictingArgs on Dog {"
        },
        {
          "filename": "src/validation/rules/OverlappingFieldsCanBeMergedRule.ts",
          "status": "modified",
          "additions": 35,
          "deletions": 16,
          "patch": "@@ -7,8 +7,8 @@ import type {\n   DirectiveNode,\n   FieldNode,\n   FragmentDefinitionNode,\n-  ObjectValueNode,\n   SelectionSetNode,\n+  ValueNode,\n } from '../../language/ast.js';\n import { Kind } from '../../language/kinds.js';\n import { print } from '../../language/printer.js';\n@@ -592,7 +592,7 @@ function findConflict(\n     }\n \n     // Two field calls must have the same arguments.\n-    if (stringifyArguments(node1) !== stringifyArguments(node2)) {\n+    if (!sameArguments(node1, node2)) {\n       return [\n         [responseName, 'they have differing arguments'],\n         [node1],\n@@ -649,19 +649,38 @@ function findConflict(\n   }\n }\n \n-function stringifyArguments(fieldNode: FieldNode | DirectiveNode): string {\n-  // FIXME https://github.com/graphql/graphql-js/issues/2203\n-  const args = /* c8 ignore next */ fieldNode.arguments ?? [];\n-\n-  const inputObjectWithArgs: ObjectValueNode = {\n-    kind: Kind.OBJECT,\n-    fields: args.map((argNode) => ({\n-      kind: Kind.OBJECT_FIELD,\n-      name: argNode.name,\n-      value: argNode.value,\n-    })),\n-  };\n-  return print(sortValueNode(inputObjectWithArgs));\n+function sameArguments(\n+  node1: FieldNode | DirectiveNode,\n+  node2: FieldNode | DirectiveNode,\n+): boolean {\n+  const args1 = node1.arguments;\n+  const args2 = node2.arguments;\n+\n+  if (args1 === undefined || args1.length === 0) {\n+    return args2 === undefined || args2.length === 0;\n+  }\n+  if (args2 === undefined || args2.length === 0) {\n+    return false;\n+  }\n+\n+  if (args1.length !== args2.length) {\n+    return false;\n+  }\n+\n+  const values2 = new Map(args2.map(({ name, value }) => [name.value, value]));\n+  return args1.every((arg1) => {\n+    const value1 = arg1.value;\n+    const value2 = values2.get(arg1.name.value);\n+    if (value2 === undefined) {\n+      return false;\n+    }\n+\n+    return stringifyValue(value1) === stringifyValue(value2);\n+  });\n+}\n+\n+function stringifyValue(value: ValueNode): string | null {\n+  return print(sortValueNode(value));\n }\n \n function getStreamDirective(\n@@ -681,7 +700,7 @@ function sameStreams(\n     return true;\n   } else if (stream1 && stream2) {\n     // check if both fields have equivalent streams\n-    return stringifyArguments(stream1) === stringifyArguments(stream2);\n+    return sameArguments(stream1, stream2);\n   }\n   // fields have a mix of stream and no stream\n   return false;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "48afd37a48d37f6d3342b959e8cb34e1ecbfeffb",
            "date": "2024-12-15T10:31:08Z",
            "author_login": "JoviDeCroock"
          },
          {
            "sha": "c079ae3cf8bf5bc0f255bde1ce2fbd424436cffb",
            "date": "2024-11-18T09:18:33Z",
            "author_login": "JoviDeCroock"
          },
          {
            "sha": "273fc8446154e4e6ebf7fcf7e3eff5ff60dd9ec1",
            "date": "2024-11-08T15:33:54Z",
            "author_login": "JoviDeCroock"
          },
          {
            "sha": "4ef0428602fe2e16fd075e1e3e51b1feca9aad38",
            "date": "2024-11-08T10:26:49Z",
            "author_login": "JoviDeCroock"
          },
          {
            "sha": "10cc0aca8e7055ad4fd685d620f42196b20ed3c9",
            "date": "2024-11-08T10:26:34Z",
            "author_login": "JoviDeCroock"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-400",
    "description": "Versions of the package graphql from 16.3.0 and before 16.8.1 are vulnerable to Denial of Service (DoS) due to insufficient checks in the OverlappingFieldsCanBeMergedRule.ts file when parsing large queries. This vulnerability allows an attacker to degrade system performance.\r\r**Note:** It was not proven that this vulnerability can crash the process.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-20T05:15:39.923",
    "last_modified": "2024-11-21T07:50:52.170",
    "fix_date": "2023-09-05T18:29:40Z"
  },
  "references": [
    {
      "url": "https://github.com/graphql/graphql-js/commit/f94b511386c7e47bd0380dcd56553dc063320226",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/issues/3955",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/pull/3972",
      "source": "report@snyk.io",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/releases/tag/v16.8.1",
      "source": "report@snyk.io",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-GRAPHQL-5905181",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/commit/f94b511386c7e47bd0380dcd56553dc063320226",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/issues/3955",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/pull/3972",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-js/releases/tag/v16.8.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-GRAPHQL-5905181",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:08.427001",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "graphql-js",
    "owner": "graphql",
    "created_at": "2015-06-30T12:16:50Z",
    "updated_at": "2025-01-14T17:49:34Z",
    "pushed_at": "2025-01-14T21:07:25Z",
    "size": 26866,
    "stars": 20120,
    "forks": 2034,
    "open_issues": 150,
    "watchers": 20120,
    "has_security_policy": false,
    "default_branch": "16.x.x",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 1821385,
      "MDX": 90494,
      "JavaScript": 48302,
      "CSS": 8316,
      "Shell": 1424
    },
    "commit_activity": {
      "total_commits_last_year": 31,
      "avg_commits_per_week": 0.5961538461538461,
      "days_active_last_year": 18
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T21:25:03.255638"
  }
}