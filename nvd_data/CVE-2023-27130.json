{
  "cve_id": "CVE-2023-27130",
  "github_data": {
    "repository": "typecho/typecho",
    "fix_commit": "f9ede542c9052ba22a6096d8412e2f02d9de872b",
    "related_commits": [
      "f9ede542c9052ba22a6096d8412e2f02d9de872b",
      "f9ede542c9052ba22a6096d8412e2f02d9de872b"
    ],
    "patch_url": "https://github.com/typecho/typecho/commit/f9ede542c9052ba22a6096d8412e2f02d9de872b.patch",
    "fix_commit_details": {
      "sha": "f9ede542c9052ba22a6096d8412e2f02d9de872b",
      "commit_date": "2023-02-21T09:43:20Z",
      "author": {
        "login": "joyqi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix #1535",
        "length": 9,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
      },
      "files": [
        {
          "filename": "var/Widget/Archive.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -646,7 +646,7 @@ public function execute()\n \n         /** \u5904\u7406\u641c\u7d22\u7ed3\u679c\u8df3\u8f6c */\n         if (isset($this->request->s)) {\n-            $filterKeywords = $this->request->filter('search')->s;\n+            $filterKeywords = $this->request->filter('search')->get('s');\n \n             /** \u8df3\u8f6c\u5230\u641c\u7d22\u9875 */\n             if (null != $filterKeywords) {"
        },
        {
          "filename": "var/Widget/Menu.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -127,10 +127,10 @@ public function execute()\n         $panelTable = unserialize($this->options->panelTable);\n         $extendingParentMenu = empty($panelTable['parent']) ? [] : $panelTable['parent'];\n         $extendingChildMenu = empty($panelTable['child']) ? [] : $panelTable['child'];\n-        $currentUrl = $this->request->makeUriByRequest();\n+        $currentUrl = $this->request->getRequestUrl();\n         $adminUrl = $this->options->adminUrl;\n         $menu = [];\n-        $defaultChildeNode = [null, null, null, 'administrator', false, null];\n+        $defaultChildNode = [null, null, null, 'administrator', false, null];\n \n         $currentUrlParts = parse_url($currentUrl);\n         $currentUrlParams = [];\n@@ -158,7 +158,7 @@ public function execute()\n \n             foreach ($childNodes[$key] as $inKey => $childNode) {\n                 // magic merge\n-                $childNode += $defaultChildeNode;\n+                $childNode += $defaultChildNode;\n                 [$name, $title, $url, $access] = $childNode;\n \n                 $hidden = $childNode[4] ?? false;\n@@ -255,7 +255,7 @@ public function execute()\n         }\n \n         $this->menu = $menu;\n-        $this->currentUrl = $currentUrl;\n+        $this->currentUrl = Common::safeUrl($currentUrl);\n     }\n \n     /**"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8ff55f5266cda4e94705f7dfdc125f5678a115bb",
            "date": "2025-01-14T13:56:48Z",
            "author_login": "sy-records"
          },
          {
            "sha": "8035b22347b0f8d908f14b0766200b1bad3d5bdb",
            "date": "2025-01-13T08:48:46Z",
            "author_login": "joyqi"
          },
          {
            "sha": "b989f24c5b612794e74fd35aaa61fee1e422fdd1",
            "date": "2025-01-11T09:51:29Z",
            "author_login": "joyqi"
          },
          {
            "sha": "23724c4193fe133cbc3ea3d2950cc376c09b70cc",
            "date": "2025-01-10T06:53:47Z",
            "author_login": "joyqi"
          },
          {
            "sha": "6ddf1c1a23b000a45e1f0ba29247a09fec78aced",
            "date": "2025-01-07T11:42:15Z",
            "author_login": "joyqi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross Site Scripting vulnerability found in Typecho v.1.2.0 allows a remote attacker to execute arbitrary code via an arbitrarily supplied URL parameter.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-16T15:15:10.453",
    "last_modified": "2024-11-21T07:52:22.387",
    "fix_date": "2023-02-21T09:43:20Z"
  },
  "references": [
    {
      "url": "https://github.com/typecho/typecho/commit/f9ede542c9052ba22a6096d8412e2f02d9de872b",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/typecho/typecho/issues/1535",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/typecho/typecho/commit/f9ede542c9052ba22a6096d8412e2f02d9de872b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/typecho/typecho/issues/1535",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.850923",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "typecho",
    "owner": "typecho",
    "created_at": "2013-07-17T05:08:35Z",
    "updated_at": "2025-01-14T13:56:54Z",
    "pushed_at": "2025-01-14T13:56:52Z",
    "size": 10415,
    "stars": 11595,
    "forks": 2056,
    "open_issues": 316,
    "watchers": 11595,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 1315010,
      "JavaScript": 319468,
      "SCSS": 49167,
      "CSS": 17332,
      "Dockerfile": 3676,
      "Makefile": 2054
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T16:45:42.365571"
  }
}