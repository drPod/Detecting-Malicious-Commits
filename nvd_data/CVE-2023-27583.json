{
  "cve_id": "CVE-2023-27583",
  "github_data": {
    "repository": "px-org/PanIndex",
    "fix_commit": "f7ec0c5739af055ad3a825a20294a5c01ada3302",
    "related_commits": [
      "f7ec0c5739af055ad3a825a20294a5c01ada3302",
      "f7ec0c5739af055ad3a825a20294a5c01ada3302"
    ],
    "patch_url": "https://github.com/px-org/PanIndex/commit/f7ec0c5739af055ad3a825a20294a5c01ada3302.patch",
    "fix_commit_details": {
      "sha": "f7ec0c5739af055ad3a825a20294a5c01ada3302",
      "commit_date": "2023-03-13T02:13:05Z",
      "author": {
        "login": "libsgh",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": ":bug:Fix login security issues",
        "length": 30,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "control/middleware/jwt.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -20,7 +20,7 @@ const (\n func JWTMiddlewar() (*jwt.GinJWTMiddleware, error) {\n \tauthMiddleware, err := jwt.New(&jwt.GinJWTMiddleware{\n \t\tRealm:       \"PanIndex Zone\",\n-\t\tKey:         []byte(\"PanIndex\"),\n+\t\tKey:         []byte(module.GloablConfig.JwtSignKey),\n \t\tTimeout:     (time.Duration(LoginTimeOut)) * time.Hour,\n \t\tMaxRefresh:  (time.Duration(LoginTimeOut)) * time.Hour,\n \t\tIdentityKey: identityKey,"
        },
        {
          "filename": "dao/db.go",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -73,6 +73,7 @@ var InitConfigItems = []module.ConfigItem{\n \t{\"dav_user\", \"webdav\", \"dav\"},\n \t{\"dav_password\", \"1234\", \"dav\"},\n \t{\"proxy\", \"\", \"common\"},\n+\t{\"jwt_sign_key\", uuid.NewV4().String(), \"common\"},\n }\n \n type Db interface {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "eecc1340d3de9f8587bfd12649f93b86eeb79287",
            "date": "2023-11-21T08:43:44Z",
            "author_login": "libsgh"
          },
          {
            "sha": "4906fc6c48821596c60a6327e4607bf342446b06",
            "date": "2023-08-08T03:53:53Z",
            "author_login": "libsgh"
          },
          {
            "sha": "9a3bd51b5e796e47bd63fc04b64dbcafc0ce29e9",
            "date": "2023-08-08T03:37:56Z",
            "author_login": "libsgh"
          },
          {
            "sha": "3196cb41c4b30ccae2f9b335cba08eb31fe342c1",
            "date": "2023-07-01T10:48:18Z",
            "author_login": "libsgh"
          },
          {
            "sha": "82d3f7a4e707ac9e6439606d7e64b9aeb8fab4cd",
            "date": "2023-05-15T05:16:59Z",
            "author_login": "libsgh"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-321",
    "description": "PanIndex is a network disk directory index. In Panindex prior to version 3.1.3,  a hard-coded JWT key `PanIndex` is used. An attacker can use the hard-coded JWT key to sign JWT token and perform any actions as a user with admin privileges. Version 3.1.3 has a patch for the issue. As a workaround, one may change the JWT key in the source code before compiling the project.\n  \n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-13T21:15:14.130",
    "last_modified": "2024-11-21T07:53:11.873",
    "fix_date": "2023-03-13T02:13:05Z"
  },
  "references": [
    {
      "url": "https://github.com/px-org/PanIndex/commit/f7ec0c5739af055ad3a825a20294a5c01ada3302",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/px-org/PanIndex/releases/tag/v3.1.3",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/px-org/PanIndex/security/advisories/GHSA-82wq-gmw8-g87v",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/px-org/PanIndex/commit/f7ec0c5739af055ad3a825a20294a5c01ada3302",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/px-org/PanIndex/releases/tag/v3.1.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/px-org/PanIndex/security/advisories/GHSA-82wq-gmw8-g87v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.838170",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PanIndex",
    "owner": "px-org",
    "created_at": "2020-08-19T08:37:36Z",
    "updated_at": "2025-01-03T04:36:11Z",
    "pushed_at": "2023-12-28T03:17:56Z",
    "size": 12602,
    "stars": 1361,
    "forks": 265,
    "open_issues": 23,
    "watchers": 1361,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 1895530,
      "Dockerfile": 531
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T19:39:59.647309"
  }
}