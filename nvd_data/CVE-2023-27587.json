{
  "cve_id": "CVE-2023-27587",
  "github_data": {
    "repository": "rozbb/readtomyshoe",
    "fix_commit": "8533b01c818939a0fa919c7244d8dbf5daf032af",
    "related_commits": [
      "8533b01c818939a0fa919c7244d8dbf5daf032af",
      "8533b01c818939a0fa919c7244d8dbf5daf032af"
    ],
    "patch_url": "https://github.com/rozbb/readtomyshoe/commit/8533b01c818939a0fa919c7244d8dbf5daf032af.patch",
    "fix_commit_details": {
      "sha": "8533b01c818939a0fa919c7244d8dbf5daf032af",
      "commit_date": "2023-03-13T18:13:23Z",
      "author": {
        "login": "rozbb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed leakage of GCP API key through TTS error message",
        "length": 54,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
      },
      "files": [
        {
          "filename": "server/src/tts.rs",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -85,6 +85,14 @@ pub(crate) fn get_api_key() -> Result<String, AnyError> {\n     })\n }\n \n+/// Redacts the API key out of the TTS error message\n+fn redact_error(mut e: reqwest::Error) -> reqwest::Error {\n+    // The API key is specified by `?key=...`. Overwriting the query section of the URL will make\n+    // this go away\n+    e.url_mut().map(|u| u.set_query(Some(\"key=REDACTED\")));\n+    e\n+}\n+\n /// Speaks text string of length at most MAX_CHARS_PER_REQUEST. Returns an error if length exceeds,\n /// or an error occurs in the Google Cloud API call.\n pub(crate) async fn tts_single(api_key: &str, req: &TtsRequest) -> Result<Bytes, AnyError> {\n@@ -106,6 +114,7 @@ pub(crate) async fn tts_single(api_key: &str, req: &TtsRequest) -> Result<Bytes,\n         .await\n         .with_context(|| \"Couldn't make TTS request\")?\n         .error_for_status()\n+        .map_err(redact_error)\n         .with_context(|| \"TTS request failed\")?;\n \n     // The resulting JSON response has our MP3 data"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5ad66be1edeb0094259c846ff2a003884d8e2c8a",
            "date": "2025-01-05T04:34:54Z",
            "author_login": "rozbb"
          },
          {
            "sha": "fcfc2a4e0b92ac569a46a689aa63cbe856381502",
            "date": "2025-01-05T02:40:53Z",
            "author_login": "rozbb"
          },
          {
            "sha": "77e641c433cb9e1036e17eedaa9ea7a7facbabeb",
            "date": "2024-06-07T15:20:13Z",
            "author_login": "rozbb"
          },
          {
            "sha": "d7c6801c3a29fe84cddc451e3787068d3d97bf3f",
            "date": "2023-08-20T05:35:01Z",
            "author_login": "rozbb"
          },
          {
            "sha": "bfd17303e0bc07937dfc1161aa558af814b7b946",
            "date": "2023-08-20T05:28:00Z",
            "author_login": "rozbb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-209",
    "description": "ReadtoMyShoe, a web app that lets users upload articles and listen to them later, generates an error message containing sensitive information prior to commit 8533b01. If an error occurs when adding an article, the website shows the user an error message. If the error originates from the Google Cloud TTS request, then it will include the full URL of the request. The request URL contains the Google Cloud API key. This has been patched in commit 8533b01. Upgrading should be accompanied by deleting the current GCP API key and issuing a new one. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-13T22:15:12.483",
    "last_modified": "2024-11-21T07:53:12.450",
    "fix_date": "2023-03-13T18:13:23Z"
  },
  "references": [
    {
      "url": "https://github.com/rozbb/readtomyshoe/commit/8533b01c818939a0fa919c7244d8dbf5daf032af",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rozbb/readtomyshoe/security/advisories/GHSA-23g5-r34j-mr8g",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/rozbb/readtomyshoe/commit/8533b01c818939a0fa919c7244d8dbf5daf032af",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rozbb/readtomyshoe/security/advisories/GHSA-23g5-r34j-mr8g",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.838609",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "readtomyshoe",
    "owner": "rozbb",
    "created_at": "2022-06-06T00:44:39Z",
    "updated_at": "2025-01-05T04:37:38Z",
    "pushed_at": "2025-01-05T04:37:34Z",
    "size": 1380,
    "stars": 27,
    "forks": 2,
    "open_issues": 32,
    "watchers": 27,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Rust": 217410,
      "Python": 6901,
      "CSS": 3259,
      "Dockerfile": 2185,
      "JavaScript": 2176,
      "Shell": 1969,
      "HTML": 1064
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T22:54:02.936388"
  }
}