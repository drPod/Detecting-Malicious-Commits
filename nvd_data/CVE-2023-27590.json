{
  "cve_id": "CVE-2023-27590",
  "github_data": {
    "repository": "rizinorg/rizin",
    "fix_commit": "d6196703d89c84467b600ba2692534579dc25ed4",
    "related_commits": [
      "d6196703d89c84467b600ba2692534579dc25ed4",
      "d6196703d89c84467b600ba2692534579dc25ed4"
    ],
    "patch_url": "https://github.com/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4.patch",
    "fix_commit_details": {
      "sha": "d6196703d89c84467b600ba2692534579dc25ed4",
      "commit_date": "2023-03-13T17:53:58Z",
      "author": {
        "login": "ret2libc",
        "type": "User",
        "stats": {
          "total_commits": 1274,
          "average_weekly_commits": 1.9509954058192955,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 256
        }
      },
      "commit_message": {
        "title": "Fix conversion from GDB register profile to rizin profile",
        "length": 57,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 35,
        "additions": 26,
        "deletions": 9
      },
      "files": [
        {
          "filename": "librz/debug/p/debug_gdb.c",
          "status": "modified",
          "additions": 10,
          "deletions": 3,
          "patch": "@@ -15,6 +15,13 @@ typedef struct {\n #define UNSUPPORTED 0\n #define SUPPORTED   1\n \n+#define PROC_NAME_SZ   1024\n+#define PROC_REGION_SZ 100\n+// PROC_REGION_SZ - 2 (used for `0x`). Due to how RZ_STR_DEF works this can't be\n+// computed.\n+#define PROC_REGION_LEFT_SZ 98\n+#define PROC_PERM_SZ        5\n+\n typedef struct rz_debug_gdb_ctx_t {\n \tRzIOGdb **origrziogdb;\n \tlibgdbr_t *desc;\n@@ -189,7 +196,7 @@ static RzList /*<RzDebugMap *>*/ *rz_debug_gdb_map_get(RzDebug *dbg) { // TODO\n \tint unk = 0, perm, i;\n \tchar *ptr, *pos_1;\n \tsize_t line_len;\n-\tchar name[1024], region1[100], region2[100], perms[5];\n+\tchar name[PROC_NAME_SZ + 1], region1[PROC_REGION_SZ + 1], region2[PROC_REGION_SZ + 1], perms[PROC_PERM_SZ + 1];\n \tRzDebugMap *map = NULL;\n \tregion1[0] = region2[0] = '0';\n \tregion1[1] = region2[1] = 'x';\n@@ -213,8 +220,8 @@ static RzList /*<RzDebugMap *>*/ *rz_debug_gdb_map_get(RzDebug *dbg) { // TODO\n \t\t}\n \t\t// We assume Linux target, for now, so -\n \t\t// 7ffff7dda000-7ffff7dfd000 r-xp 00000000 08:05 265428 /usr/lib/ld-2.25.so\n-\t\tret = sscanf(ptr, \"%s %s %\" PFMT64x \" %*s %*s %[^\\n]\", &region1[2],\n-\t\t\tperms, &offset, name);\n+\t\tret = sscanf(ptr, \"%\" RZ_STR_DEF(PROC_REGION_LEFT_SZ) \"s %\" RZ_STR_DEF(PROC_PERM_SZ) \"s %\" PFMT64x \" %*s %*s %\" RZ_STR_DEF(PROC_NAME_SZ) \"[^\\n]\",\n+\t\t\t&region1[2], perms, &offset, name);\n \t\tif (ret == 3) {\n \t\t\tname[0] = '\\0';\n \t\t} else if (ret != 4) {"
        },
        {
          "filename": "librz/debug/p/debug_io.c",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -4,6 +4,9 @@\n #include <rz_io.h>\n #include <rz_debug.h>\n \n+#define IO_MAPS_PERM_SZ 32\n+#define IO_MAPS_NAME_SZ 512\n+\n static int __io_step(RzDebug *dbg) {\n \tfree(dbg->iob.system(dbg->iob.io, \"ds\"));\n \treturn true;\n@@ -23,8 +26,8 @@ static RzList /*<RzDebugMap *>*/ *__io_maps(RzDebug *dbg) {\n \t}\n \tchar *ostr = str;\n \tut64 map_start, map_end;\n-\tchar perm[32];\n-\tchar name[512];\n+\tchar perm[IO_MAPS_PERM_SZ + 1];\n+\tchar name[IO_MAPS_NAME_SZ + 1];\n \tfor (;;) {\n \t\tchar *nl = strchr(str, '\\n');\n \t\tif (nl) {\n@@ -48,7 +51,7 @@ static RzList /*<RzDebugMap *>*/ *__io_maps(RzDebug *dbg) {\n \t\t\tif (_s_) {\n \t\t\t\tmemmove(_s_, _s_ + 2, strlen(_s_));\n \t\t\t}\n-\t\t\tsscanf(str, \"0x%\" PFMT64x \" - 0x%\" PFMT64x \" %s %s\",\n+\t\t\tsscanf(str, \"0x%\" PFMT64x \" - 0x%\" PFMT64x \" %\" RZ_STR_DEF(IO_MAPS_PERM_SZ) \"s %\" RZ_STR_DEF(IO_MAPS_NAME_SZ) \"s\",\n \t\t\t\t&map_start, &map_end, perm, name);\n \t\t\tif (map_end != 0LL) {\n \t\t\t\tRzDebugMap *map = rz_debug_map_new(name, map_start, map_end, rz_str_rwx(perm), 0);"
        },
        {
          "filename": "librz/include/rz_types_base.h",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -214,4 +214,7 @@ typedef struct _utX {\n \t\treturn m ? *m = n, m : m; \\\n \t}\n \n+#define RZ_STR_DEF(s) RZ_STR(s)\n+#define RZ_STR(s)     #s\n+\n #endif // RZ_TYPES_BASE_H"
        },
        {
          "filename": "librz/reg/profile.c",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -10,6 +10,10 @@\n #include <rz_lib.h>\n #include <string.h>\n \n+#define GDB_NAME_SZ   16\n+#define GDB_TYPE_SZ   16\n+#define GDB_GROUPS_SZ 128\n+\n static void rz_reg_profile_def_free(RzRegProfileDef *def) {\n \tif (!def) {\n \t\treturn;\n@@ -511,7 +515,7 @@ static char *gdb_to_rz_profile(const char *gdb) {\n \t\treturn NULL;\n \t}\n \tchar *ptr1, *gptr, *gptr1;\n-\tchar name[16], groups[128], type[16];\n+\tchar name[GDB_NAME_SZ + 1], groups[GDB_GROUPS_SZ + 1], type[GDB_TYPE_SZ + 1];\n \tconst int all = 1, gpr = 2, save = 4, restore = 8, float_ = 16,\n \t\t  sse = 32, vector = 64, system = 128, mmx = 256;\n \tint number, rel, offset, size, type_bits, ret;\n@@ -542,8 +546,8 @@ static char *gdb_to_rz_profile(const char *gdb) {\n \t\t\trz_strbuf_free(sb);\n \t\t\treturn false;\n \t\t}\n-\t\tret = sscanf(ptr, \" %s %d %d %d %d %s %s\", name, &number, &rel,\n-\t\t\t&offset, &size, type, groups);\n+\t\tret = sscanf(ptr, \" %\" RZ_STR_DEF(GDB_NAME_SZ) \"s %d %d %d %d %\" RZ_STR_DEF(GDB_TYPE_SZ) \"s %\" RZ_STR_DEF(GDB_GROUPS_SZ) \"s\",\n+\t\t\tname, &number, &rel, &offset, &size, type, groups);\n \t\t// Groups is optional, others not\n \t\tif (ret < 6) {\n \t\t\tif (*ptr != '*') {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "79814e46b635640a43e416593b3553f8a7a75174",
            "date": "2025-01-13T14:22:23Z",
            "author_login": "kazarmy"
          },
          {
            "sha": "124a2b13862a6e0d92ab202bf452724a297699ba",
            "date": "2025-01-12T21:57:00Z",
            "author_login": "kazarmy"
          },
          {
            "sha": "09525b3d2a3b57df3e3fc6d210883b17f8117763",
            "date": "2025-01-12T12:32:00Z",
            "author_login": "kazarmy"
          },
          {
            "sha": "ae0aa42125552d2f233c114338b0b817cee53f40",
            "date": "2025-01-11T13:09:59Z",
            "author_login": "kazarmy"
          },
          {
            "sha": "708e30dc2e1c2f73b62d57b51a6155f8add70a7c",
            "date": "2025-01-09T16:09:05Z",
            "author_login": "Rot127"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-120",
    "description": "Rizin is a UNIX-like reverse engineering framework and command-line toolset. In version 0.5.1 and prior, converting a GDB registers profile file into a Rizin register profile can result in a stack-based buffer overflow when the `name`, `type`, or `groups` fields have longer values than expected. Users opening untrusted GDB registers files (e.g. with the `drpg` or `arpg` commands) are affected by this flaw. Commit d6196703d89c84467b600ba2692534579dc25ed4 contains a patch for this issue. As a workaround, review the GDB register profiles before loading them with `drpg`/`arpg` commands.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-14T21:15:10.763",
    "last_modified": "2024-11-21T07:53:12.823",
    "fix_date": "2023-03-13T17:53:58Z"
  },
  "references": [
    {
      "url": "https://github.com/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c#L514",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c#L545",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/pull/3422",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/security/advisories/GHSA-rqcp-m8m2-jcqf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c#L514",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/blob/3a7d5116244beb678ad9950bb9dd27d28ed2691f/librz/reg/profile.c#L545",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/pull/3422",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rizinorg/rizin/security/advisories/GHSA-rqcp-m8m2-jcqf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WW3JXI4TIJIR7PGFP74SN7GQYHW2F46Y/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:06.841842",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rizin",
    "owner": "rizinorg",
    "created_at": "2020-09-30T09:15:56Z",
    "updated_at": "2025-01-13T14:22:29Z",
    "pushed_at": "2025-01-13T17:45:02Z",
    "size": 152997,
    "stars": 2766,
    "forks": 373,
    "open_issues": 461,
    "watchers": 2766,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "C": 30788662,
      "C++": 381011,
      "Meson": 197580,
      "Python": 66911,
      "Roff": 41775,
      "JavaScript": 15280,
      "Shell": 6013,
      "CMake": 5683,
      "Pawn": 5193,
      "Perl": 4737,
      "Rust": 3262,
      "Dockerfile": 2896,
      "Assembly": 1148,
      "R": 539,
      "Gnuplot": 431
    },
    "commit_activity": {
      "total_commits_last_year": 561,
      "avg_commits_per_week": 10.788461538461538,
      "days_active_last_year": 216
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-3.0"
    },
    "collected_at": "2025-01-14T13:02:45.407116"
  }
}