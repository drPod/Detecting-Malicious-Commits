{
  "cve_id": "CVE-2023-2798",
  "github_data": {
    "repository": "HtmlUnit/htmlunit",
    "fix_commit": "940dc7fd",
    "related_commits": [
      "940dc7fd",
      "940dc7fd"
    ],
    "patch_url": "https://github.com/HtmlUnit/htmlunit/commit/940dc7fd.patch",
    "fix_commit_details": {
      "sha": "940dc7fd",
      "commit_date": "2023-01-19T15:41:37Z",
      "author": {
        "login": "rbri",
        "type": "User",
        "stats": {
          "total_commits": 10846,
          "average_weekly_commits": 9.28595890410959,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 710
        }
      },
      "commit_message": {
        "title": "remove recursion to make the fuzzer happy",
        "length": 41,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 14,
        "deletions": 12
      },
      "files": [
        {
          "filename": "src/main/java/com/gargoylesoftware/htmlunit/html/DomNode.java",
          "status": "modified",
          "additions": 14,
          "deletions": 12,
          "patch": "@@ -1453,18 +1453,19 @@ private DomNode getNextElementUpwards(final DomNode startingNode) {\n             if (startingNode == DomNode.this) {\n                 return null;\n             }\n-            final DomNode parent = startingNode.getParentNode();\n-            if (parent == null || parent == DomNode.this) {\n-                return null;\n-            }\n-            DomNode next = parent.getNextSibling();\n-            while (next != null && !isAccepted(next)) {\n-                next = next.getNextSibling();\n-            }\n-            if (next == null) {\n-                return getNextElementUpwards(parent);\n+\n+            DomNode parent = startingNode.getParentNode();\n+            while (parent != null && parent != DomNode.this) {\n+                DomNode next = parent.getNextSibling();\n+                while (next != null && !isAccepted(next)) {\n+                    next = next.getNextSibling();\n+                }\n+                if (next != null) {\n+                    return next;\n+                }\n+                parent = parent.getParentNode();\n             }\n-            return next;\n+            return null;\n         }\n \n         private DomNode getFirstChildElement(final DomNode parent) {\n@@ -1763,7 +1764,8 @@ public void removeCharacterDataChangeListener(final CharacterDataChangeListener\n     protected void fireCharacterDataChanged(final CharacterDataChangeEvent event) {\n         DomNode toInform = this;\n         while (toInform != null) {\n-            final List<CharacterDataChangeListener> listeners = safeGetCharacterDataListeners();\n+\n+            final List<CharacterDataChangeListener> listeners = toInform.safeGetCharacterDataListeners();\n             if (listeners != null) {\n                 for (final CharacterDataChangeListener listener : listeners) {\n                     listener.characterDataChanged(event);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88dba24ff93aedf496bed1a813f9483b612b0502",
            "date": "2025-01-13T09:25:28Z",
            "author_login": "rbri"
          },
          {
            "sha": "3ce9948dac9e31697e2f8cd215bdc183e53f79b5",
            "date": "2024-12-28T12:39:43Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e214a21d2a6dc971b3cc8c1948dd06d366b21fe5",
            "date": "2025-01-12T17:12:52Z",
            "author_login": "rbri"
          },
          {
            "sha": "f33c7c39ab9eb6a605990458fc3e1e83f5bb350c",
            "date": "2025-01-12T12:40:27Z",
            "author_login": "rbri"
          },
          {
            "sha": "54e0b8fa109c856ce625b32f73ad83e6185e6e1f",
            "date": "2025-01-12T12:40:13Z",
            "author_login": "rbri"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Those using HtmlUnit to browse untrusted webpages may be vulnerable to Denial of service attacks (DoS). If HtmlUnit is running on user supplied web pages, an attacker may supply content that causes HtmlUnit to crash by a stack overflow. This effect may support a denial of service attack.This issue affects htmlunit before 2.70.0.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-25T14:15:10.320",
    "last_modified": "2024-11-21T07:59:18.673",
    "fix_date": "2023-01-19T15:41:37Z"
  },
  "references": [
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=54613",
      "source": "cve-coordination@google.com",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://github.com/HtmlUnit/htmlunit/commit/940dc7fd",
      "source": "cve-coordination@google.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=54613",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://github.com/HtmlUnit/htmlunit/commit/940dc7fd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.249709",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "htmlunit",
    "owner": "HtmlUnit",
    "created_at": "2018-09-02T08:59:44Z",
    "updated_at": "2025-01-14T13:51:07Z",
    "pushed_at": "2025-01-14T13:51:03Z",
    "size": 179386,
    "stars": 887,
    "forks": 172,
    "open_issues": 147,
    "watchers": 887,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 27951873,
      "JavaScript": 21740308,
      "Java": 21597117,
      "CSS": 760213,
      "PHP": 111737,
      "TypeScript": 21160,
      "Ruby": 13701,
      "Python": 4699,
      "Visual Basic .NET": 1726,
      "Shell": 1062,
      "Hack": 873,
      "Batchfile": 431,
      "Roff": 228,
      "Makefile": 154,
      "ASP.NET": 93
    },
    "commit_activity": {
      "total_commits_last_year": 1211,
      "avg_commits_per_week": 23.28846153846154,
      "days_active_last_year": 221
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:28:12.926637"
  }
}