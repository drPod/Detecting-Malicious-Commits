{
  "cve_id": "CVE-2023-28120",
  "github_data": {
    "repository": "rails/rails",
    "fix_commit": "3cf23c3f891e2e81c977ea4ab83b62bc2a444b70",
    "related_commits": [
      "3cf23c3f891e2e81c977ea4ab83b62bc2a444b70"
    ],
    "patch_url": "https://github.com/rails/rails/commit/3cf23c3f891e2e81c977ea4ab83b62bc2a444b70.patch",
    "fix_commit_details": {
      "sha": "3cf23c3f891e2e81c977ea4ab83b62bc2a444b70",
      "commit_date": "2023-01-04T20:25:37Z",
      "author": {
        "login": "amatsuda",
        "type": "User",
        "stats": {
          "total_commits": 1055,
          "average_weekly_commits": 1.002851711026616,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 199
        }
      },
      "commit_message": {
        "title": "Implement SafeBuffer#bytesplice",
        "length": 31,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 34,
        "deletions": 0
      },
      "files": [
        {
          "filename": "activesupport/lib/active_support/core_ext/string/output_safety.rb",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -216,6 +216,10 @@ def concat(value)\n     end\n     alias << concat\n \n+    def bytesplice(*args, value)\n+      super(*args, implicit_html_escape_interpolated_argument(value))\n+    end\n+\n     def insert(index, value)\n       super(index, html_escape_interpolated_argument(value))\n     end"
        },
        {
          "filename": "activesupport/test/core_ext/string_ext_test.rb",
          "status": "modified",
          "additions": 30,
          "deletions": 0,
          "patch": "@@ -987,6 +987,36 @@ def to_s\n     assert_predicate string, :html_safe?\n   end\n \n+  if \"\".respond_to?(:bytesplice)\n+    test \"Bytesplicing safe into safe yields safe\" do\n+      string = \"hello\".html_safe\n+      string.bytesplice(0, 0, \"<b>\".html_safe)\n+\n+      assert_equal \"<b>hello\", string\n+      assert_predicate string, :html_safe?\n+\n+      string = \"hello\".html_safe\n+      string.bytesplice(0..1, \"<b>\".html_safe)\n+\n+      assert_equal \"<b>llo\", string\n+      assert_predicate string, :html_safe?\n+    end\n+\n+    test \"Bytesplicing unsafe into safe yields escaped safe\" do\n+      string = \"hello\".html_safe\n+      string.bytesplice(1, 0, \"<b>\")\n+\n+      assert_equal \"h&lt;b&gt;ello\", string\n+      assert_predicate string, :html_safe?\n+\n+      string = \"hello\".html_safe\n+      string.bytesplice(1..2, \"<b>\")\n+\n+      assert_equal \"h&lt;b&gt;lo\", string\n+      assert_predicate string, :html_safe?\n+    end\n+  end\n+\n   test \"emits normal string yaml\" do\n     assert_equal \"foo\".to_yaml, \"foo\".html_safe.to_yaml(foo: 1)\n   end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "116a5e4309a189f9111c85334c418856b81cd91a",
            "date": "2025-01-14T17:51:07Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "9b7bb7bdea55a6a30bc833e031101a672d4a2593",
            "date": "2025-01-14T17:45:10Z",
            "author_login": "fatkodima"
          },
          {
            "sha": "72d1704546e7d135950f24edb6c29bb2253aa6f8",
            "date": "2025-01-14T17:34:01Z",
            "author_login": "skipkayhil"
          },
          {
            "sha": "be42d45578d9f002cd3e6cd60ba0466392ae5d4a",
            "date": "2025-01-13T23:18:15Z",
            "author_login": "skipkayhil"
          },
          {
            "sha": "52ed99642e3c59160cc30919a370535e0d5a8082",
            "date": "2025-01-14T16:17:53Z",
            "author_login": "borama"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "There is a vulnerability in ActiveSupport if the new bytesplice method is called on a SafeBuffer with untrusted user input.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2025-01-09T01:15:07.637",
    "last_modified": "2025-01-09T22:15:26.470",
    "fix_date": "2023-01-04T20:25:37Z"
  },
  "references": [
    {
      "url": "https://discuss.rubyonrails.org/t/cve-2023-28120-possible-xss-security-vulnerability-in-safebuffer-bytesplice/82469",
      "source": "support@hackerone.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails/commit/3cf23c3f891e2e81c977ea4ab83b62bc2a444b70",
      "source": "support@hackerone.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UPV6PVCX4VDJHLFFT42EXBBSGAWZICOW/",
      "source": "support@hackerone.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZE5W4MH6IE4DV7GELDK6ISCSTFLHKSYO/",
      "source": "support@hackerone.com",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240202-0006/",
      "source": "support@hackerone.com",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5389",
      "source": "support@hackerone.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:58.233608",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rails",
    "owner": "rails",
    "created_at": "2008-04-11T02:19:47Z",
    "updated_at": "2025-01-14T12:51:57Z",
    "pushed_at": "2025-01-14T12:53:28Z",
    "size": 261740,
    "stars": 56313,
    "forks": 21746,
    "open_issues": 1251,
    "watchers": 56313,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0-5-stable",
      "0-6-stable",
      "0-7-stable",
      "0-8-stable",
      "1-2-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "2-3-stable",
      "3-0-stable",
      "3-1-stable",
      "3-2-stable",
      "4-0-stable",
      "4-1-stable",
      "4-2-stable",
      "5-0-stable",
      "5-1-stable",
      "5-2-stable",
      "6-0-stable",
      "6-1-stable",
      "7-0-stable",
      "7-1-stable",
      "7-2-stable"
    ],
    "languages": {
      "Ruby": 17127894,
      "JavaScript": 228210,
      "HTML": 196993,
      "SCSS": 50596,
      "CSS": 47127,
      "Dockerfile": 2019,
      "Shell": 668
    },
    "commit_activity": {
      "total_commits_last_year": 3989,
      "avg_commits_per_week": 76.71153846153847,
      "days_active_last_year": 351
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T12:56:52.447177"
  }
}