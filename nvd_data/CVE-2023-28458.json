{
  "cve_id": "CVE-2023-28458",
  "github_data": {
    "repository": "pretalx/pretalx",
    "fix_commit": "60722c43cf975f319e94102e6bff320723776890",
    "related_commits": [
      "60722c43cf975f319e94102e6bff320723776890",
      "60722c43cf975f319e94102e6bff320723776890"
    ],
    "patch_url": "https://github.com/pretalx/pretalx/commit/60722c43cf975f319e94102e6bff320723776890.patch",
    "fix_commit_details": {
      "sha": "60722c43cf975f319e94102e6bff320723776890",
      "commit_date": "2023-03-07T12:04:03Z",
      "author": {
        "login": "rixx",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix path traversal in static HTML export",
        "length": 341,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/pretalx/agenda/management/commands/export_schedule_html.py",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -115,7 +115,9 @@ def dump_content(destination, path, getter):\n     if path.endswith(\"/\"):\n         path = path + \"index.html\"\n \n-    path = Path(destination) / path.lstrip(\"/\")\n+    path = (Path(destination) / path.lstrip(\"/\")).resolve()\n+    if not Path(destination) in path.parents:\n+        raise CommandError(\"Path traversal detected, aborting.\")\n     path.parent.mkdir(parents=True, exist_ok=True)\n \n     with open(path, \"wb\") as f:\n@@ -131,6 +133,14 @@ def get_mediastatic_content(url):\n     else:\n         raise FileNotFoundError()\n \n+    # Prevent directory traversal, make sure the path is inside the media or static root\n+    local_path = local_path.resolve(strict=True)\n+    if not any(\n+        path in local_path.parents\n+        for path in (settings.MEDIA_ROOT, settings.STATIC_ROOT)\n+    ):\n+        raise FileNotFoundError()\n+\n     with open(local_path, \"rb\") as f:\n         return f.read()\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6965dff4115684c0c47f36c82f148d3d4d95cd64",
            "date": "2025-01-14T16:42:39Z",
            "author_login": "rixx"
          },
          {
            "sha": "24f1c68e6ec6589c39f032623d205859fde64533",
            "date": "2025-01-14T16:33:14Z",
            "author_login": "rixx"
          },
          {
            "sha": "1fdb55dc7f720175e2bd27ed34d6f0ad7852fafe",
            "date": "2025-01-14T16:27:51Z",
            "author_login": "rixx"
          },
          {
            "sha": "880ef031af78b65674a235359291cb19b5908a8e",
            "date": "2025-01-14T16:07:09Z",
            "author_login": "rixx"
          },
          {
            "sha": "3b6b6372ddc08fd565837cd54bb319f864cbd58d",
            "date": "2025-01-14T16:06:54Z",
            "author_login": "rixx"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-22",
    "description": "pretalx 2.3.1 before 2.3.2 allows path traversal in HTML export (a non-default feature). Organizers can trigger the overwriting (with the standard pretalx 404 page content) of an arbitrary file.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-20T21:15:08.770",
    "last_modified": "2024-11-21T07:55:07.423",
    "fix_date": "2023-03-07T12:04:03Z"
  },
  "references": [
    {
      "url": "https://github.com/pretalx/pretalx/commit/60722c43cf975f319e94102e6bff320723776890",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pretalx/pretalx/releases/tag/v2.3.2",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://pretalx.com/p/news/security-release-232/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.sonarsource.com/blog/pretalx-vulnerabilities-how-to-get-accepted-at-every-conference/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pretalx/pretalx/commit/60722c43cf975f319e94102e6bff320723776890",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pretalx/pretalx/releases/tag/v2.3.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://pretalx.com/p/news/security-release-232/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.sonarsource.com/blog/pretalx-vulnerabilities-how-to-get-accepted-at-every-conference/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.818294",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pretalx",
    "owner": "pretalx",
    "created_at": "2017-02-24T20:46:51Z",
    "updated_at": "2025-01-14T16:43:01Z",
    "pushed_at": "2025-01-14T16:42:57Z",
    "size": 50809,
    "stars": 757,
    "forks": 211,
    "open_issues": 87,
    "watchers": 757,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 1895702,
      "HTML": 491993,
      "CSS": 154515,
      "JavaScript": 123894,
      "SCSS": 84094,
      "Vue": 47467,
      "Shell": 1544,
      "Stylus": 173
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T17:11:56.605074"
  }
}