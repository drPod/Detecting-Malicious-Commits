{
  "cve_id": "CVE-2023-28627",
  "github_data": {
    "repository": "pymedusa/Medusa",
    "fix_commit": "66d4be8f0872bd5ddcdc5c5a58cb014d22834a45",
    "related_commits": [
      "66d4be8f0872bd5ddcdc5c5a58cb014d22834a45",
      "66d4be8f0872bd5ddcdc5c5a58cb014d22834a45"
    ],
    "patch_url": "https://github.com/pymedusa/Medusa/commit/66d4be8f0872bd5ddcdc5c5a58cb014d22834a45.patch",
    "fix_commit_details": {
      "sha": "66d4be8f0872bd5ddcdc5c5a58cb014d22834a45",
      "commit_date": "2023-02-22T10:23:45Z",
      "author": {
        "login": "medariox",
        "type": "User",
        "stats": {
          "total_commits": 1807,
          "average_weekly_commits": 3.2210338680926918,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 300
        }
      },
      "commit_message": {
        "title": "Ensure that git_path is a valid file (#11138)",
        "length": 115,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 7,
        "deletions": 5
      },
      "files": [
        {
          "filename": "medusa/updater/github_updater.py",
          "status": "modified",
          "additions": 7,
          "deletions": 5,
          "patch": "@@ -3,6 +3,7 @@\n from __future__ import unicode_literals\n \n import logging\n+import os\n import platform\n import re\n import subprocess\n@@ -72,11 +73,7 @@ def commits_ahead(self):\n \n     def _find_working_git(self):\n         test_cmd = 'version'\n-\n-        if app.GIT_PATH:\n-            main_git = '\"' + app.GIT_PATH + '\"'\n-        else:\n-            main_git = 'git'\n+        main_git = app.GIT_PATH or 'git'\n \n         log.debug(u'Checking if we can use git commands: {0} {1}', main_git, test_cmd)\n         _, _, exit_status = self._run_git(main_git, test_cmd)\n@@ -126,6 +123,11 @@ def _run_git(self, git_path, args):\n                 exit_status = 1\n                 return output, err, exit_status\n \n+        if git_path != 'git' and not os.path.isfile(git_path):\n+            log.warning(u\"Invalid git specified, can't use git commands\")\n+            exit_status = 1\n+            return output, err, exit_status\n+\n         # If we have a valid git remove the git warning\n         # String will be updated as soon we check github\n         app.NEWEST_VERSION_STRING = None"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d99638720355ef047857735876ec37adcb6a94a5",
            "date": "2024-12-13T12:21:58Z",
            "author_login": "medariox"
          },
          {
            "sha": "0a24b7c36251097d204c43e7645d475e02c22d98",
            "date": "2024-12-13T12:15:55Z",
            "author_login": "medariox"
          },
          {
            "sha": "7ada61cdbb9ed11321d12a38c21bf878cd730092",
            "date": "2024-12-13T12:10:11Z",
            "author_login": "medariox"
          },
          {
            "sha": "5af8c69ba7a8c6d591d191fa2cb757a74610bd29",
            "date": "2024-12-13T12:08:49Z",
            "author_login": "medariox"
          },
          {
            "sha": "9224599a7b7504f778191bb3cba3d635ccf1c3a5",
            "date": "2024-12-13T12:05:49Z",
            "author_login": "medariox"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-78",
    "description": "pymedusa is an automatic video library manager for TV Shows. In versions prior 1.0.12 an attacker with access to the web interface can update the git executable path in /config/general/ > advanced settings with arbitrary OS commands. An attacker may exploit this vulnerability to take execute arbitrary OS commands as the user running the pymedusa program. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-03-27T21:15:12.310",
    "last_modified": "2024-11-21T07:55:41.670",
    "fix_date": "2023-02-22T10:23:45Z"
  },
  "references": [
    {
      "url": "https://github.com/pymedusa/Medusa/commit/66d4be8f0872bd5ddcdc5c5a58cb014d22834a45",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pymedusa/Medusa/security/advisories/GHSA-6589-x6f5-cgg9",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/pymedusa/Medusa/commit/66d4be8f0872bd5ddcdc5c5a58cb014d22834a45",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pymedusa/Medusa/security/advisories/GHSA-6589-x6f5-cgg9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.016507",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Medusa",
    "owner": "pymedusa",
    "created_at": "2016-02-23T06:02:11Z",
    "updated_at": "2025-01-14T13:43:59Z",
    "pushed_at": "2025-01-14T12:30:48Z",
    "size": 223267,
    "stars": 1827,
    "forks": 275,
    "open_issues": 460,
    "watchers": 1827,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "Python": 3633983,
      "JavaScript": 1313697,
      "Vue": 1194800,
      "CSS": 146101,
      "Mako": 36222,
      "Shell": 16518,
      "SCSS": 13224,
      "Dockerfile": 1514,
      "HTML": 223
    },
    "commit_activity": {
      "total_commits_last_year": 62,
      "avg_commits_per_week": 1.1923076923076923,
      "days_active_last_year": 13
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:11:16.530384"
  }
}