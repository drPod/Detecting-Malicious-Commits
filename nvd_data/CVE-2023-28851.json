{
  "cve_id": "CVE-2023-28851",
  "github_data": {
    "repository": "bigfork/silverstripe-form-capture",
    "fix_commit": "5b3aa39dd1eef042f173167b0fa4d3f717971772",
    "related_commits": [
      "5b3aa39dd1eef042f173167b0fa4d3f717971772",
      "5b3aa39dd1eef042f173167b0fa4d3f717971772"
    ],
    "patch_url": "https://github.com/bigfork/silverstripe-form-capture/commit/5b3aa39dd1eef042f173167b0fa4d3f717971772.patch",
    "fix_commit_details": {
      "sha": "5b3aa39dd1eef042f173167b0fa4d3f717971772",
      "commit_date": "2023-03-31T16:14:35Z",
      "author": {
        "login": "kinglozzer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix improper escaping of details fields in GridField view",
        "length": 57,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/Model/CapturedFormSubmission.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -134,7 +134,7 @@ public function Details(): DBHTMLText\n                 continue;\n             }\n \n-\t\t\t$htmlEnt = '<strong>'. $field->Title .'</strong>: '. $field->Value;\n+\t\t\t$htmlEnt = '<strong>'. $field->Title .'</strong>: '. $field->dbObject('Value')->forTemplate();\n \t\t\t$toAdd[] = $htmlEnt;\n \t\t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d90ed1255d2bd073319d6f92e69f9bc5aa01d19d",
            "date": "2023-08-02T13:22:59Z",
            "author_login": "kinglozzer"
          },
          {
            "sha": "fc36f8024a35678f1da593adabfb11492ca7617a",
            "date": "2023-08-02T13:22:35Z",
            "author_login": "kinglozzer"
          },
          {
            "sha": "4f1139623a09180728b31d804f36f257ef4dbc09",
            "date": "2023-07-28T11:37:02Z",
            "author_login": "k-coidan"
          },
          {
            "sha": "9ef3bcb13f2de298e894ac2768575f53bed74715",
            "date": "2023-05-17T14:38:27Z",
            "author_login": "k-coidan"
          },
          {
            "sha": "5b3aa39dd1eef042f173167b0fa4d3f717971772",
            "date": "2023-03-31T16:14:35Z",
            "author_login": "kinglozzer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Silverstripe Form Capture provides a method to capture simple silverstripe forms and an admin interface for users. Starting in version 0.2.0 and prior to versions 1.0.2, 1.1.0, 2.2.5, and 3.1.1, improper escaping when presenting stored form submissions allowed for an attacker to perform a Cross-Site Scripting attack. The vulnerability was initially patched in version 1.0.2, and version 1.1.0 includes this patch. The bug was then accidentally re-introduced during a merge error, and has been re-patched in versions 2.2.5 and 3.1.1. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-03T18:15:07.927",
    "last_modified": "2024-11-21T07:56:09.457",
    "fix_date": "2023-03-31T16:14:35Z"
  },
  "references": [
    {
      "url": "https://github.com/bigfork/silverstripe-form-capture/commit/5b3aa39dd1eef042f173167b0fa4d3f717971772",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/bigfork/silverstripe-form-capture/security/advisories/GHSA-38h6-gmr2-j4wx",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/bigfork/silverstripe-form-capture/commit/5b3aa39dd1eef042f173167b0fa4d3f717971772",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/bigfork/silverstripe-form-capture/security/advisories/GHSA-38h6-gmr2-j4wx",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.036952",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "silverstripe-form-capture",
    "owner": "bigfork",
    "created_at": "2017-05-07T22:04:58Z",
    "updated_at": "2022-10-20T14:59:22Z",
    "pushed_at": "2023-08-02T13:23:12Z",
    "size": 88,
    "stars": 1,
    "forks": 3,
    "open_issues": 1,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 24588
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T16:46:07.723409"
  }
}