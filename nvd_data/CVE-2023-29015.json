{
  "cve_id": "CVE-2023-29015",
  "github_data": {
    "repository": "intranda/goobi-viewer-core",
    "fix_commit": "f0ccde2d469efd9597c3062d00177a63341f2256",
    "related_commits": [
      "f0ccde2d469efd9597c3062d00177a63341f2256",
      "f0ccde2d469efd9597c3062d00177a63341f2256"
    ],
    "patch_url": "https://github.com/intranda/goobi-viewer-core/commit/f0ccde2d469efd9597c3062d00177a63341f2256.patch",
    "fix_commit_details": {
      "sha": "f0ccde2d469efd9597c3062d00177a63341f2256",
      "commit_date": "2023-03-24T16:15:00Z",
      "author": {
        "login": "Keelhaul",
        "type": "User",
        "stats": {
          "total_commits": 5995,
          "average_weekly_commits": 15.100755667506297,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 353
        }
      },
      "commit_message": {
        "title": "escape comment text; fixes #24585",
        "length": 33,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
      },
      "files": [
        {
          "filename": "goobi-viewer-core/src/main/resources/META-INF/resources/resources/includes/user/userComments.xhtml",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -51,7 +51,9 @@\n \n \t\t\t\t\t\t<!-- COMMENT METADATA -->\n \t\t\t\t\t\t<div class=\"user-comments__comment-metadata\">\n-\t\t\t\t\t\t\t<span class=\"user-comments__comment-metadata-creator\">#{comment.creator.displayNameEscaped}</span>\n+\t\t\t\t\t\t\t<span class=\"user-comments__comment-metadata-creator\">\n+\t\t\t\t\t\t\t    #{comment.creator.displayNameEscaped}\n+\t\t\t\t\t\t\t</span>\n \t\t\t\t\t\t\t<span class=\"user-comments__comment-metadata-date\">#{navigationHelper.getLocalDate(comment.dateCreated)}</span>\n \t\t\t\t\t\t</div>\n \n@@ -77,7 +79,8 @@\n \n \t\t\t\t\t\t\t\t<!-- COMMENT TEXT -->\n \t\t\t\t\t\t\t\t<div class=\"user-comments__comment-content-text in\">\n-\t\t\t\t\t\t\t\t\t#{comment.displayText}</div>\n+\t\t\t\t\t\t\t\t\t<h:outputText value=\"#{comment.displayText}\" escape=\"true\" />\n+\t\t\t\t\t\t\t\t</div>\n \n \t\t\t\t\t\t\t\t\t<!-- EDIT COMMENT -->\n \t\t\t\t\t\t\t\t\t<ui:fragment"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a88b73a76a10ae12aac1403dfa2304c741f086f4",
            "date": "2024-12-21T09:41:47Z",
            "author_login": "janvonde"
          },
          {
            "sha": "e1c9bab2d1e5734c533beac85733317af69e5745",
            "date": "2024-12-20T18:16:08Z",
            "author_login": "janvonde"
          },
          {
            "sha": "ef9140a9ce362b0feca105e29eb0fb5c0cc329e2",
            "date": "2024-12-20T16:51:45Z",
            "author_login": "Keelhaul"
          },
          {
            "sha": "b3a20c466480fc67105f60e31e591bfce69b2e15",
            "date": "2024-12-20T16:08:36Z",
            "author_login": "Keelhaul"
          },
          {
            "sha": "0ccbb39db2ada4b29445bd7f003562889bf1581e",
            "date": "2024-12-20T15:43:28Z",
            "author_login": "Keelhaul"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "The Goobi viewer is a web application that allows digitised material to be displayed in a web browser. A cross-site scripting vulnerability has been identified in the user comment feature of Goobi viewer core prior to version 23.03. An attacker could create a specially crafted comment, resulting in the execution of malicious script code in the user's browser when displaying the comment. The vulnerability has been fixed in version 23.03.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-06T20:15:08.613",
    "last_modified": "2024-11-21T07:56:23.910",
    "fix_date": "2023-03-24T16:15:00Z"
  },
  "references": [
    {
      "url": "https://github.com/intranda/goobi-viewer-core/commit/f0ccde2d469efd9597c3062d00177a63341f2256",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/intranda/goobi-viewer-core/security/advisories/GHSA-622w-995c-3c3h",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/intranda/goobi-viewer-core/commit/f0ccde2d469efd9597c3062d00177a63341f2256",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/intranda/goobi-viewer-core/security/advisories/GHSA-622w-995c-3c3h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:09.060120",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "goobi-viewer-core",
    "owner": "intranda",
    "created_at": "2017-06-16T08:47:48Z",
    "updated_at": "2024-12-21T09:42:23Z",
    "pushed_at": "2025-01-14T14:20:19Z",
    "size": 548133,
    "stars": 21,
    "forks": 14,
    "open_issues": 10,
    "watchers": 21,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 10294005,
      "JavaScript": 8013313,
      "HTML": 2431310,
      "Less": 661289,
      "CSS": 356544,
      "XSLT": 186258
    },
    "commit_activity": {
      "total_commits_last_year": 1322,
      "avg_commits_per_week": 25.423076923076923,
      "days_active_last_year": 232
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T18:28:15.409335"
  }
}