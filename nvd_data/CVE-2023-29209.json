{
  "cve_id": "CVE-2023-29209",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "94392490884635c028199275db059a4f471e57bc",
    "related_commits": [
      "94392490884635c028199275db059a4f471e57bc",
      "94392490884635c028199275db059a4f471e57bc"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/94392490884635c028199275db059a4f471e57bc.patch",
    "fix_commit_details": {
      "sha": "94392490884635c028199275db059a4f471e57bc",
      "commit_date": "2022-10-26T10:05:40Z",
      "author": {
        "login": "michitux",
        "type": "User",
        "stats": {
          "total_commits": 378,
          "average_weekly_commits": 0.39622641509433965,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 108
        }
      },
      "commit_message": {
        "title": "XWIKI-20258: Improve escaping in the Legacy ActivityMacro",
        "length": 57,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 11,
        "deletions": 2
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-legacy/xwiki-platform-legacy-notifications/xwiki-platform-legacy-notification-activitymacro/src/main/resources/XWiki/Notifications/Code/Legacy/ActivityMacro.xml",
          "status": "modified",
          "additions": 11,
          "deletions": 2,
          "patch": "@@ -251,10 +251,19 @@\n     <property>\n       <code>{{velocity}}\n #set ($wikis = '')\n-#if ($services.wiki.currentWikiId != $services.wiki.mainWikiId)\n+#if (\"$!xcontext.macro.params.wikis\" != '')\n+  #set ($wikis = $xcontext.macro.params.wikis)\n+#elseif ($services.wiki.currentWikiId != $services.wiki.mainWikiId)\n   #set ($wikis = $services.wiki.currentWikiId)\n #end\n-{{notifications useUserPreferences=\"false\" displayOwnEvents=\"true\" count=\"$xcontext.macro.params.entries\" #if(\"$!xcontext.macro.params.wikis\" != '')wikis=\"$xcontext.macro.params.wikis\"#{else}wikis=\"$wikis\"#end #if(\"$!xcontext.macro.params.spaces\" != '')spaces=\"$xcontext.macro.params.spaces\"#end #if(\"$!xcontext.macro.params.authors\" != '')users=\"$xcontext.macro.params.authors\"#end #if(\"$!xcontext.macro.params.tags\" != '')tags=\"$xcontext.macro.params.tags\"#end #if(\"$!xcontext.macro.params.minor\" != '')displayMinorEvents=\"$xcontext.macro.params.minor\"#end #if(\"$!xcontext.macro.params.rss\" != '')displayRSSLink=\"$xcontext.macro.params.rss\"#end /}}\n+{{notifications useUserPreferences=\"false\" displayOwnEvents=\"true\"\n+        count=\"$services.rendering.escape($xcontext.macro.params.entries, 'xwiki/2.1')\"\n+        wikis=\"$services.rendering.escape($wikis, 'xwiki/2.1')\"\n+        #if(\"$!xcontext.macro.params.spaces\" != '')spaces=\"$services.rendering.escape($xcontext.macro.params.spaces, 'xwiki/2.1')\"#end\n+        #if(\"$!xcontext.macro.params.authors\" != '')users=\"$services.rendering.escape($xcontext.macro.params.authors, 'xwiki/2.1')\"#end\n+        #if(\"$!xcontext.macro.params.tags\" != '')tags=\"$services.rendering.escape($xcontext.macro.params.tags, 'xwiki/2.1')\"#end\n+        #if(\"$!xcontext.macro.params.minor\" != '')displayMinorEvents=\"$services.rendering.escape($xcontext.macro.params.minor, 'xwiki/2.1')\"#end\n+        #if(\"$!xcontext.macro.params.rss\" != '')displayRSSLink=\"$services.rendering.escape($xcontext.macro.params.rss, 'xwiki/2.1')\"#end /}}\n {{/velocity}}</code>\n     </property>\n     <property>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 11
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-95",
    "description": "XWiki Commons are technical libraries common to several other top level XWiki projects. Any user with view rights on commonly accessible documents including the legacy notification activity macro can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of the macro parameters of the legacy notification activity macro. This macro is installed by default in XWiki. The vulnerability can be exploited via every wiki page that is editable including the user's profile, but also with just view rights using the HTMLConverter that is part of the CKEditor integration which is bundled with XWiki. The vulnerability has been patched in XWiki 13.10.11, 14.4.7 and 14.10.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-15T17:15:07.043",
    "last_modified": "2024-11-21T07:56:43.173",
    "fix_date": "2022-10-26T10:05:40Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/94392490884635c028199275db059a4f471e57bc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9pc2-x9qf-7j2q",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20258",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/94392490884635c028199275db059a4f471e57bc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9pc2-x9qf-7j2q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20258",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.792112",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}