{
  "cve_id": "CVE-2023-29211",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "ba4c76265b0b8a5e2218be400d18f08393fe1428",
    "related_commits": [
      "ba4c76265b0b8a5e2218be400d18f08393fe1428",
      "ba4c76265b0b8a5e2218be400d18f08393fe1428"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/ba4c76265b0b8a5e2218be400d18f08393fe1428.patch",
    "fix_commit_details": {
      "sha": "ba4c76265b0b8a5e2218be400d18f08393fe1428",
      "commit_date": "2022-10-27T12:15:04Z",
      "author": {
        "login": "manuelleduc",
        "type": "User",
        "stats": {
          "total_commits": 953,
          "average_weekly_commits": 0.9989517819706499,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 179
        }
      },
      "commit_message": {
        "title": "XWIKI-20297: Improved DeleteWiki error message escaping",
        "length": 259,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 280,
        "additions": 164,
        "deletions": 116
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-attachment/xwiki-platform-attachment-ui/src/test/java/org/xwiki/attachment/AttachmentSelectorPageTest.java",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -61,6 +61,7 @@\n import org.xwiki.test.page.HTML50ComponentList;\n import org.xwiki.test.page.IconSetup;\n import org.xwiki.test.page.PageTest;\n+import org.xwiki.test.page.TestNoScriptMacro;\n import org.xwiki.test.page.XWikiSyntax21ComponentList;\n import org.xwiki.xml.internal.html.filter.ControlCharactersFilter;\n "
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-theme/xwiki-platform-flamingo-theme-ui/src/test/java/org/xwiki/flamingo/TestNoScriptMacro.java",
          "status": "removed",
          "additions": 0,
          "deletions": 72,
          "patch": "@@ -1,72 +0,0 @@\n-/*\n- * See the NOTICE file distributed with this work for additional\n- * information regarding copyright ownership.\n- *\n- * This is free software; you can redistribute it and/or modify it\n- * under the terms of the GNU Lesser General Public License as\n- * published by the Free Software Foundation; either version 2.1 of\n- * the License, or (at your option) any later version.\n- *\n- * This software is distributed in the hope that it will be useful,\n- * but WITHOUT ANY WARRANTY; without even the implied warranty of\n- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n- * Lesser General Public License for more details.\n- *\n- * You should have received a copy of the GNU Lesser General Public\n- * License along with this software; if not, write to the Free\n- * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n- * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n- */\n-package org.xwiki.flamingo;\n-\n-import java.util.List;\n-\n-import javax.inject.Inject;\n-import javax.inject.Named;\n-import javax.inject.Singleton;\n-\n-import org.slf4j.Logger;\n-import org.xwiki.component.annotation.Component;\n-import org.xwiki.rendering.block.Block;\n-import org.xwiki.rendering.macro.AbstractMacro;\n-import org.xwiki.rendering.transformation.MacroTransformationContext;\n-\n-import static java.util.Collections.emptyList;\n-\n-/**\n- * This script prints an error log when it is interpreted, making the test fail.\n- *\n- * @version $Id$\n- * @since 13.10.10\n- * @since 14.4.6\n- * @since 14.9RC1\n- */\n-@Component\n-@Named(\"noscript\")\n-@Singleton\n-public class TestNoScriptMacro extends AbstractMacro<Object>\n-{\n-    @Inject\n-    private Logger logger;\n-\n-    /**\n-     * Default constructor.\n-     */\n-    public TestNoScriptMacro()\n-    {\n-        super(\"NoScript\", \"No Script!\");\n-    }\n-\n-    @Override\n-    public boolean supportsInlineMode()\n-    {\n-        return true;\n-    }\n-\n-    @Override\n-    public List<Block> execute(Object parameters, String content, MacroTransformationContext context)\n-    {\n-        this.logger.error(\"SHOULD NOT BE CALLED\");\n-        return emptyList();\n-    }\n-}"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-theme/xwiki-platform-flamingo-theme-ui/src/test/java/org/xwiki/flamingo/WebHomeSheetPageTest.java",
          "status": "modified",
          "additions": 2,
          "deletions": 22,
          "patch": "@@ -19,30 +19,21 @@\n  */\n package org.xwiki.flamingo;\n \n-import java.util.Locale;\n-\n import org.jsoup.nodes.Document;\n import org.junit.jupiter.api.Test;\n-import org.xwiki.localization.Translation;\n-import org.xwiki.localization.TranslationBundle;\n-import org.xwiki.localization.TranslationBundleContext;\n import org.xwiki.localization.macro.internal.TranslationMacro;\n import org.xwiki.model.reference.DocumentReference;\n import org.xwiki.rendering.RenderingScriptServiceComponentList;\n-import org.xwiki.rendering.block.WordBlock;\n import org.xwiki.rendering.internal.configuration.DefaultExtendedRenderingConfiguration;\n import org.xwiki.rendering.internal.configuration.RenderingConfigClassDocumentConfigurationSource;\n import org.xwiki.rendering.internal.macro.message.ErrorMessageMacro;\n import org.xwiki.test.annotation.ComponentList;\n import org.xwiki.test.page.HTML50ComponentList;\n import org.xwiki.test.page.PageTest;\n+import org.xwiki.test.page.TestNoScriptMacro;\n import org.xwiki.test.page.XWikiSyntax21ComponentList;\n \n import static org.junit.jupiter.api.Assertions.assertEquals;\n-import static org.mockito.ArgumentMatchers.eq;\n-import static org.mockito.Mockito.any;\n-import static org.mockito.Mockito.mock;\n-import static org.mockito.Mockito.when;\n \n /**\n  * Test of the {@code FlamingoThemesCode.WebHomeSheet} page.\n@@ -71,20 +62,9 @@ void createAction() throws Exception\n         this.request.put(\"form_token\", \"1\");\n         this.request.put(\"action\", \"create\");\n \n-        TranslationBundleContext translationBundleContext = this.componentManager\n-            .getInstance(TranslationBundleContext.class);\n-        TranslationBundle translationBundle = mock(TranslationBundle.class);\n-        Translation translation = mock(Translation.class);\n-        when(translation.getLocale()).thenReturn(Locale.ENGLISH);\n-        when(translation.render(any(), any())).thenAnswer(invocationOnMock -> new WordBlock(\n-            \"platform.flamingo.themes.home.create.csrf \" + invocationOnMock.getArgument(1)));\n-        when(translationBundle.getTranslation(eq(\"platform.flamingo.themes.home.create.csrf\"), any()))\n-            .thenReturn(translation);\n-        translationBundleContext.addBundle(translationBundle);\n-\n         Document document = this.renderHTMLPage(new DocumentReference(\"xwiki\", \"FlamingoThemesCode\", \"WebHomeSheet\"));\n \n-        assertEquals(\"platform.flamingo.themes.home.create.csrf some content\\\"/}}{{noscript/}}\",\n+        assertEquals(\"platform.flamingo.themes.home.create.csrf [some content\\\"/}}{{noscript/}}]\",\n             document.select(\".box.errormessage\").text());\n     }\n }"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-help/xwiki-platform-help-ui/src/test/java/org/xwiki/help/XWikiSyntaxMacrosListPageTest.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -144,7 +144,7 @@ void renderTable() throws Exception\n         assertEquals(\"help.macroList.description\", includeMacroRowTds.get(3).text());\n         assertEquals(\"help.macroList.visibility\", includeMacroRowTds.get(4).text());\n         assertWikiMacro(trs.get(1), \"mymacro\", \"/xwiki/bin/view/XWiki/MyMacro\", \"My Macro\",\n-            Set.of(\"Category1\", \"Category2\"), \"My Macro Description\", \"WIKI\");\n+            Set.of(\"Category1\", \"Category2\"), \"My Macro Description\", \"XWiki.WikiMacroClass_visibility_WIKI\");\n         assertJavaMacro(trs.get(2), \"velocity\", \"Velocity\", \"Development\", \"Executes a Velocity script.\",\n             \"XWiki.WikiMacroClass_visibility_Global\");\n         assertJavaMacro(trs.get(3), \"translation\", \"Translation\", \"Content\","
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-test/xwiki-platform-test-page/src/main/java/org/xwiki/test/page/LocalizationSetup.java",
          "status": "modified",
          "additions": 68,
          "deletions": 11,
          "patch": "@@ -19,14 +19,21 @@\n  */\n package org.xwiki.test.page;\n \n+import java.util.Arrays;\n import java.util.Collection;\n+import java.util.Locale;\n import java.util.stream.Collectors;\n \n-import org.mockito.stubbing.Answer;\n+import org.mockito.invocation.InvocationOnMock;\n+import org.xwiki.localization.Translation;\n+import org.xwiki.localization.TranslationBundle;\n+import org.xwiki.localization.TranslationBundleContext;\n import org.xwiki.localization.script.LocalizationScriptService;\n+import org.xwiki.rendering.block.WordBlock;\n import org.xwiki.script.service.ScriptService;\n import org.xwiki.test.TestComponentManager;\n \n+import static org.mockito.ArgumentMatchers.any;\n import static org.mockito.ArgumentMatchers.anyCollection;\n import static org.mockito.ArgumentMatchers.anyString;\n import static org.mockito.Mockito.mock;\n@@ -51,7 +58,6 @@ private LocalizationSetup()\n      * <p>\n      * For instance, calling {@code $services.localization.render('my.key')} returns {@code \"my.key\"}, and calling\n      * {@code $services.localization.render('my.key2', 'a', 1)} returns {@code \"my.key2 [a, 1]\"}.\n-     * \n      *\n      * @param tcm the stubbed Component Manager for the test\n      * @throws Exception when a setup error occurs\n@@ -60,26 +66,77 @@ public static void setUp(TestComponentManager tcm) throws Exception\n     {\n         LocalizationScriptService lss = mock(LocalizationScriptService.class);\n         tcm.registerComponent(ScriptService.class, \"localization\", lss);\n-        \n+\n         // The translations are mocked by returning the translation, suffixed with the list of the String.valueOf\n         // values of the translation parameters if they exist.\n         // We mock the translations instead of using their actual values because they are subject to change from\n         // Weblate, possibly making the build fail unexpectedly.\n-        when(lss.render(anyString())).thenAnswer(\n-            (Answer<String>) invocationOnMock -> {\n+        when(lss.render(anyString())).thenAnswer(invocationOnMock -> {\n                 // Return the translation key as the value\n-                return invocationOnMock.getArgument(0);\n+                return renderString(invocationOnMock.getArgument(0), new Object[] {});\n             }\n         );\n-        when(lss.render(anyString(), anyCollection())).thenAnswer((Answer<String>) invocationOnMock -> {\n+        when(lss.render(anyString(), anyCollection())).thenAnswer(invocationOnMock -> {\n             // Displays the comma-separated list of parameters between squared brackets after the translation key as\n             // the value, so that they can be verified in tests.\n             // For instance: my.key [paramA, paramB]\n-            Object key = invocationOnMock.getArgument(0);\n             Collection<?> parameters = invocationOnMock.getArgument(1);\n-            return parameters.stream()\n-                .map(String::valueOf)\n-                .collect(Collectors.joining(\", \", key + \" [\", \"]\"));\n+            return renderString(invocationOnMock.getArgument(0), parameters.toArray());\n         });\n+\n+        TranslationBundleContext translationBundleContext = tcm.getInstance(TranslationBundleContext.class);\n+        TranslationBundle translationBundle = mock(TranslationBundle.class);\n+        when(translationBundle.getTranslation(any(), any()))\n+            .thenAnswer(invocationOnMockTranslation -> {\n+                Translation translation = mock(Translation.class);\n+                when(translation.getLocale()).thenReturn(Locale.ENGLISH);\n+                String translationKey = invocationOnMockTranslation.getArgument(0);\n+                when(translation.getKey()).thenReturn(translationKey);\n+                when(translation.render(any())).thenAnswer(invocationOnMockRender -> {\n+                    Object[] parameters = getVarArgs(invocationOnMockRender, 0);\n+                    return renderBlock(translationKey, parameters);\n+                });\n+                when(translation.render(any(), any())).thenAnswer(invocationOnMockRender -> {\n+                    Object[] parameters = getVarArgs(invocationOnMockRender, 1);\n+                    return renderBlock(translationKey, parameters);\n+                });\n+                return translation;\n+            });\n+        translationBundleContext.addBundle(translationBundle);\n+    }\n+\n+    private static WordBlock renderBlock(String translationKey, Object[] parameters)\n+    {\n+        return new WordBlock(renderString(translationKey, parameters));\n+    }\n+\n+    private static String renderString(String translationKey, Object[] parameters)\n+    {\n+        String word;\n+        if (parameters.length == 0) {\n+            word = translationKey;\n+        } else {\n+            String parametersString = Arrays.stream(parameters)\n+                .map(String::valueOf)\n+                .collect(Collectors.joining(\", \", \"[\", \"]\"));\n+            word = String.format(\"%s %s\", translationKey, parametersString);\n+        }\n+        return word;\n+    }\n+\n+    private static Object[] getVarArgs(InvocationOnMock invocationOnMockRender, int i)\n+    {\n+        Object[] parameters;\n+        if (invocationOnMockRender.getArguments().length > i) {\n+            Object argument = invocationOnMockRender.getArgument(i);\n+            if (argument instanceof String) {\n+                parameters = new Object[] { argument };\n+            } else {\n+                parameters = (Object[]) argument;\n+            }\n+        } else {\n+            parameters = new Object[] {};\n+        }\n+        return parameters;\n     }\n }"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-test/xwiki-platform-test-page/src/main/java/org/xwiki/test/page/TestNoScriptMacro.java",
          "status": "renamed",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -17,7 +17,7 @@\n  * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n  * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n  */\n-package org.xwiki.attachment;\n+package org.xwiki.test.page;\n \n import java.util.List;\n \n@@ -34,12 +34,12 @@\n import static java.util.Collections.emptyList;\n \n /**\n- * This script prints an error log when it is interpreted, making the test fail.\n+ * This macro prints an error log when it is executed, making the page test fail.\n  *\n  * @version $Id$\n- * @since 14.5\n- * @since 14.4.2\n- * @since 13.10.7\n+ * @since 13.10.11\n+ * @since 14.4.7\n+ * @since 14.10RC1\n  */\n @Component\n @Named(\"noscript\")"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-test/xwiki-platform-test-page/src/main/resources/META-INF/components.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1 +1,2 @@\n org.xwiki.test.page.StubRenderingConfiguration\n+org.xwiki.test.page.TestNoScriptMacro"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-templates/src/test/java/org/xwiki/web/DisplayPageTest.java",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -59,14 +59,14 @@ class DisplayPageTest extends PageTest\n \n     private static final String FIELD_PRETTY_NAME = \"Test Field\";\n \n-    private static final String DEFAULT_LABEL = \"defaultValue\";\n+    private static final String DEFAULT_LABEL = \"space.page_testField_\";\n \n     private static final String VALUE_1 = \"value1\";\n \n     private static final String DEFAULT_SELECT =\n         \"<select id='space.page_0_testField' name='space.page_0_testField' size='1'>\"\n-        + \"<option selected='selected' value='' label='defaultValue'>defaultValue</option>\"\n-        + \"<option value='value1' label='value1'>value1</option></select>\"\n+        + \"<option selected='selected' value='' label='space.page_testField_'>space.page_testField_</option>\"\n+        + \"<option value='value1' label='space.page_testField_value1'>space.page_testField_value1</option></select>\"\n         + \"<input name='space.page_0_testField' type='hidden' value=''/>\";\n \n     private TemplateManager templateManager;"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-wiki/xwiki-platform-wiki-ui/xwiki-platform-wiki-ui-mainwiki/pom.xml",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -129,6 +129,13 @@\n       <version>${project.version}</version>\n       <type>xar</type>\n     </dependency>\n+    <!-- Runtime dependencies. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n+      <version>${project.version}</version>\n+      <scope>runtime</scope>\n+    </dependency>\n     <!-- Needed to display wiki activity in the user profile \"Wiki\" tab -->\n     <dependency>\n       <groupId>org.xwiki.platform</groupId>\n@@ -164,6 +171,13 @@\n       <type>test-jar</type>\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n+      <version>${project.version}</version>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n   <build>\n     <plugins>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-wiki/xwiki-platform-wiki-ui/xwiki-platform-wiki-ui-mainwiki/src/main/resources/WikiManager/DeleteWiki.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -60,7 +60,8 @@\n   ##\n   #if (!$wiki)\n     #if (!$services.wiki.lastError)\n-      {{error}}{{translation key=\"platform.wiki.error.wikidoesnotexist\" parameters=\"$wikiId\"/}}{{/error}}\n+      #set ($escapedWikiId = $services.rendering.escape($escapetool.java($wikiId), 'xwiki/2.1'))\n+      {{error}}{{translation key=\"platform.wiki.error.wikidoesnotexist\" parameters=\"~\"${escapedWikiId}~\"\"/}}{{/error}}\n     #else\n       #printException($services.wiki.lastError)\n     #end"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-wiki/xwiki-platform-wiki-ui/xwiki-platform-wiki-ui-mainwiki/src/test/java/org/xwiki/wiki/DeleteWikiPageTest.java",
          "status": "added",
          "additions": 66,
          "deletions": 0,
          "patch": "@@ -0,0 +1,66 @@\n+/*\n+ * See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU Lesser General Public License as\n+ * published by the Free Software Foundation; either version 2.1 of\n+ * the License, or (at your option) any later version.\n+ *\n+ * This software is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this software; if not, write to the Free\n+ * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n+ * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n+ */\n+package org.xwiki.wiki;\n+\n+import org.jsoup.nodes.Document;\n+import org.junit.jupiter.api.Test;\n+import org.xwiki.localization.macro.internal.TranslationMacro;\n+import org.xwiki.model.reference.DocumentReference;\n+import org.xwiki.rendering.RenderingScriptServiceComponentList;\n+import org.xwiki.rendering.internal.configuration.DefaultExtendedRenderingConfiguration;\n+import org.xwiki.rendering.internal.configuration.RenderingConfigClassDocumentConfigurationSource;\n+import org.xwiki.rendering.internal.macro.message.ErrorMessageMacro;\n+import org.xwiki.test.annotation.ComponentList;\n+import org.xwiki.test.page.HTML50ComponentList;\n+import org.xwiki.test.page.PageTest;\n+import org.xwiki.test.page.TestNoScriptMacro;\n+import org.xwiki.test.page.XWikiSyntax21ComponentList;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+\n+/**\n+ * Test of the {@code WikiManager.DeleteWiki} page.\n+ *\n+ * @version $Id$\n+ * @since 13.10.11\n+ * @since 14.4.7\n+ * @since 14.10RC1\n+ */\n+@HTML50ComponentList\n+@XWikiSyntax21ComponentList\n+@RenderingScriptServiceComponentList\n+@ComponentList({\n+    ErrorMessageMacro.class,\n+    TranslationMacro.class,\n+    TestNoScriptMacro.class,\n+    DefaultExtendedRenderingConfiguration.class,\n+    RenderingConfigClassDocumentConfigurationSource.class\n+})\n+class DeleteWikiPageTest extends PageTest\n+{\n+    @Test\n+    void unknownWikiId() throws Exception\n+    {\n+        this.request.put(\"wikiId\", \"\\\" /}}{{noscript/}}\");\n+        Document document = renderHTMLPage(new DocumentReference(\"xwiki\", \"WikiManager\", \"DeleteWiki\"));\n+        assertEquals(\"platform.wiki.error.wikidoesnotexist [\\\" /}}{{noscript/}}]\",\n+            document.select(\".box.errormessage\").text());\n+    }\n+}"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-wiki/xwiki-platform-wiki-ui/xwiki-platform-wiki-ui-mainwiki/src/test/java/org/xwiki/wiki/WikiManagerPageTest.java",
          "status": "renamed",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -58,7 +58,7 @@\n @ComponentList({\n     ControlCharactersFilter.class,\n })\n-class WikiManagerTest extends PageTest\n+class WikiManagerPageTest extends PageTest\n {\n     /**\n      * Verify the resolved configuration of the Live Data macro (stored in the {@code data-config} attribute of the"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 10,
        "unique_directories": 9,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-95",
    "description": "XWiki Commons are technical libraries common to several other top level XWiki projects. Any user with view rights `WikiManager.DeleteWiki` can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of the `wikiId` url parameter. The problem has been patched on XWiki  13.10.11, 14.4.7, and 14.10.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-16T07:15:52.873",
    "last_modified": "2024-11-21T07:56:43.390",
    "fix_date": "2022-10-27T12:15:04Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/ba4c76265b0b8a5e2218be400d18f08393fe1428#diff-64f39f5f2cc8c6560a44e21a5cfd509ef00e8a2157cd9847c9940a2e08ea43d1R63-R64",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-w7v9-fc49-4qg4",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20297",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/ba4c76265b0b8a5e2218be400d18f08393fe1428#diff-64f39f5f2cc8c6560a44e21a5cfd509ef00e8a2157cd9847c9940a2e08ea43d1R63-R64",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-w7v9-fc49-4qg4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20297",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.798033",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}