{
  "cve_id": "CVE-2023-29514",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "7bf7094f8ffac095f5d66809af7554c9cc44de09",
    "related_commits": [
      "7bf7094f8ffac095f5d66809af7554c9cc44de09",
      "7bf7094f8ffac095f5d66809af7554c9cc44de09"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/7bf7094f8ffac095f5d66809af7554c9cc44de09.patch",
    "fix_commit_details": {
      "sha": "7bf7094f8ffac095f5d66809af7554c9cc44de09",
      "commit_date": "2022-11-25T16:13:37Z",
      "author": {
        "login": "michitux",
        "type": "User",
        "stats": {
          "total_commits": 378,
          "average_weekly_commits": 0.39622641509433965,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 108
        }
      },
      "commit_message": {
        "title": "XWIKI-20268: Improve escaping in AdminTemplatesSheet",
        "length": 52,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 25,
        "deletions": 1
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-administration/xwiki-platform-administration-test/xwiki-platform-administration-test-docker/src/test/it/org/xwiki/administration/test/ui/PageTemplatesIT.java",
          "status": "modified",
          "additions": 24,
          "deletions": 0,
          "patch": "@@ -25,6 +25,7 @@\n import org.junit.jupiter.api.BeforeEach;\n import org.junit.jupiter.api.Order;\n import org.junit.jupiter.api.Test;\n+import org.openqa.selenium.WebElement;\n import org.xwiki.administration.test.po.TemplateProviderInlinePage;\n import org.xwiki.administration.test.po.TemplatesAdministrationSectionPage;\n import org.xwiki.model.reference.DocumentReference;\n@@ -358,6 +359,29 @@ void createPageFromForbiddenTemplate(TestUtils setup, TestReference testReferenc\n         assertEquals(\"Some content in that page\", viewPage.getContent());\n     }\n \n+    /**\n+     * The goal of this test is to check that the template provider's title is correctly escaped.\n+     */\n+    @Test\n+    @Order(5)\n+    void templateProviderTitleEscaping(TestUtils setup, TestReference testReference) throws Exception\n+    {\n+        cleanUp(setup, testReference);\n+\n+        // Create a template\n+        String templateContent = \"Templates are fun\";\n+        String providerName = \"{{html}}<span>HTML</span>{{/html}}\";\n+        LocalDocumentReference templateProviderReference = new LocalDocumentReference(providerName,\n+            testReference.getLocalDocumentReference().getParent());\n+        createTemplateAndTemplateProvider(setup, templateProviderReference, templateContent,\n+            \"Funny templates\", true);\n+\n+        TemplatesAdministrationSectionPage adminPage = TemplatesAdministrationSectionPage.gotoPage();\n+        List<WebElement> links = adminPage.getExistingTemplatesLinks();\n+        assertFalse(links.stream().anyMatch(element -> element.getText().equals(\"HTML\")));\n+        assertTrue(links.stream().anyMatch(element -> providerName.equals(element.getText())));\n+    }\n+\n     /**\n      * Helper function to Create both a Template and a Template Provider for the tests in this class.\n      */"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-administration/xwiki-platform-administration-ui/src/main/resources/XWiki/AdminTemplatesSheet.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -112,7 +112,7 @@\n   == {{translation key=\"admin.templates.providerslist\"/}} ==\n \n     #foreach($providerFullname in $availableProviders)\n-      * [[$services.rendering.escape($xwiki.getDocument($providerFullname).plainTitle, $xwiki.currentContentSyntaxId)&gt;&gt;$providerFullname]]\n+      * [[$services.rendering.escape($services.rendering.escape($xwiki.getDocument($providerFullname).plainTitle, $xwiki.currentContentSyntaxId), $xwiki.currentContentSyntaxId)&gt;&gt;$services.rendering.escape($providerFullname, $xwiki.currentContentSyntaxId)]]\n     #end\n   )))\n #end"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 12
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-74",
    "description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any user with edit rights on any document (e.g., their own user profile) can execute code with programming rights, leading to remote code execution. This vulnerability has been patched in XWiki 13.10.11, 14.4.8, 14.10.1 and 15.0 RC1. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-19T00:15:08.280",
    "last_modified": "2024-11-21T07:57:12.657",
    "fix_date": "2022-11-25T16:13:37Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/7bf7094f8ffac095f5d66809af7554c9cc44de09",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9j36-3cp4-rh4j",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20268",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/7bf7094f8ffac095f5d66809af7554c9cc44de09",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9j36-3cp4-rh4j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20268",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.810588",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}