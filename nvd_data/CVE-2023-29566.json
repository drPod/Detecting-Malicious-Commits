{
  "cve_id": "CVE-2023-29566",
  "github_data": {
    "repository": "rona-dinihari/dawnsparks-node-tesseract",
    "fix_commit": "81d1664f0b9fe521534acfae1d5b9c40127b36c1",
    "related_commits": [
      "81d1664f0b9fe521534acfae1d5b9c40127b36c1",
      "81d1664f0b9fe521534acfae1d5b9c40127b36c1"
    ],
    "patch_url": "https://github.com/rona-dinihari/dawnsparks-node-tesseract/commit/81d1664f0b9fe521534acfae1d5b9c40127b36c1.patch",
    "fix_commit_details": {
      "sha": "81d1664f0b9fe521534acfae1d5b9c40127b36c1",
      "commit_date": "2023-03-06T17:43:56Z",
      "author": {
        "login": "rona-dinihari",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "exec() to execFile()",
        "length": 20,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 66,
        "additions": 36,
        "deletions": 30
      },
      "files": [
        {
          "filename": "lib/tesseract.js",
          "status": "modified",
          "additions": 16,
          "deletions": 14,
          "patch": "@@ -4,12 +4,12 @@\n  * Module dependencies.\n  */\n var utils = require('./utils');\n-var exec = require('child_process').exec;\n+var execFile = require('child_process').execFile;\n var fs = require('fs');\n var tmpdir = require('os').tmpdir(); // let the os take care of removing zombie tmp files\n var uuid = require('uuid');\n var path = require('path');\n-var { glob, } = require(\"glob\");\n+var { globSync, } = require(\"glob\");\n \n var Tesseract = {\n \n@@ -51,7 +51,7 @@ var Tesseract = {\n       callback(Error('Invalid image path'));\n       return;\n     }\n-    \n+\n     var defaultOptions = utils.merge({}, Tesseract.options);\n     options = utils.merge(defaultOptions, options);\n \n@@ -65,23 +65,23 @@ var Tesseract = {\n     var command = [options.binary, image, output];\n \n     if (options.l !== null) {\n-      command.push('-l ' + options.l);\n+      command.push('-l')\n+      command.push(options.l);\n     }\n \n     if (options.psm !== null) {\n-      command.push('--psm ' + options.psm);\n+      command.push('--psm')\n+      command.push(options.psm);\n     }\n \n     if (options.config !== null) {\n       command.push(options.config);\n     }\n \n-    command = command.join(' ');\n-\n     var opts = options.env || {};\n \n     // Run the tesseract command\n-    exec(command, opts, function(err, stdout, stderr) {\n+    execFile(command[0], command.slice(1), opts, function(err, stdout, stderr) {\n       if (err) {\n         // Something went wrong executing the assembled command\n         callback(err, null);\n@@ -98,11 +98,9 @@ var Tesseract = {\n       }\n \n       // Find one of the three possible extension\n-      glob(output + '.+(html|hocr|txt)', function(err, files){\n-        if (err) {\n-          callback(err, null);\n-          return;\n-        }\n+      try {\n+        const files = globSync(output + '.{html,hocr,txt}');\n+        const readFiles = function(files) {\n         fs.readFile(files[0], Tesseract.outputEncoding, function(err, data) {\n           if (err) {\n             callback(err, null);\n@@ -116,7 +114,11 @@ var Tesseract = {\n \n           callback(null, data, extra);\n         });\n-      })\n+        };\n+        readFiles(files);\n+      } catch (err) {\n+        callback(err, null);\n+      }\n     }); // end exec\n \n   }"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -1,12 +1,12 @@\n {\n-  \"name\": \"dawnsparks-tesseract\",\n-  \"version\": \"0.4.0\",\n+  \"name\": \"dawnsparks-node-tesseract\",\n+  \"version\": \"0.4.1\",\n   \"lockfileVersion\": 3,\n   \"requires\": true,\n   \"packages\": {\n     \"\": {\n-      \"name\": \"dawnsparks-tesseract\",\n-      \"version\": \"0.4.0\",\n+      \"name\": \"dawnsparks-node-tesseract\",\n+      \"version\": \"0.4.1\",\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"glob\": \"^9.0.1\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,12 +1,12 @@\n {\n   \"name\": \"dawnsparks-node-tesseract\",\n-  \"version\": \"0.4.0\",\n+  \"version\": \"0.4.1\",\n   \"author\": \"Rona Dini Hari <hari.ronadini@gmail.com>\",\n   \"description\": \"A fork of a simple wrapper for the Tesseract OCR package\",\n   \"main\": \"index.js\",\n   \"repository\": {\n     \"type\": \"git\",\n-    \"url\": \"https://rona_dinihari@bitbucket.org/dawnsparks/dawnsparks-node-tesseract.git\"\n+    \"url\": \"https://github.com/rona-dinihari/dawnsparks-node-tesseract.git\"\n   },\n   \"keywords\": [\n     \"tesseract\","
        },
        {
          "filename": "test/tesseract.js",
          "status": "modified",
          "additions": 14,
          "deletions": 10,
          "patch": "@@ -9,28 +9,32 @@ const fs = require('fs');\n describe('process', function(){\n   it('should return the string \"node-tesseract\"', function(done){\n \n-    var testImage = \"\\\"\" + __dirname + '/test.png' + \"\\\"\";\n+    var testImage = path.join(__dirname, 'test with spaces.png');\n \n     tesseract.process(testImage, function(err, text) {\n-      text.trim().should.equal('node-tesseract');\n-      done();\n+      if (err) {\n+        done(err);\n+      } else {\n+        text.trim().should.equal('node-tesseract');\n+        done();\n+      }\n     });\n-\n-    done();\n   })\n })\n \n describe('orientation', function(){\n   it('returns orientation equal to 0 using psm 1', function(done){\n \n-    var testImage = \"\\\"\" + __dirname + '/test.png' + \"\\\"\";\n+    var testImage = path.join(__dirname, 'test with spaces.png');\n \n     tesseract.process(testImage, { psm: 1 }, function(err, text, extra) {\n-      extra.orientation.should.equal(0);\n-      done();\n+      if (err) {\n+        done(err);\n+      } else {\n+        extra.orientation.should.equal(0);\n+        done();\n+      }\n     });\n-\n-    done();\n   })\n })\n "
        },
        {
          "filename": "test/test with spaces.png",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2f72d3ab96048b5b0b180fdd2e0749246d39fc2d",
            "date": "2024-10-19T01:57:41Z",
            "author_login": "rona-dinihari"
          },
          {
            "sha": "2c67623bf60b19e8011299b1986232d10379f90d",
            "date": "2024-10-19T01:56:10Z",
            "author_login": "snyk-bot"
          },
          {
            "sha": "fc584d512c68816a2b4050a594975e284a2ffc06",
            "date": "2024-08-30T14:12:45Z",
            "author_login": "rona-dinihari"
          },
          {
            "sha": "14d8299dc6aa748511c06ea3fc0e751c3a2fef7b",
            "date": "2024-08-30T14:09:49Z",
            "author_login": "rona-dinihari"
          },
          {
            "sha": "bcc0808c3e56736dada800b49383a2738e2c0d3c",
            "date": "2024-08-30T13:54:02Z",
            "author_login": "rona-dinihari"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-77",
    "description": "huedawn-tesseract 0.3.3 and dawnsparks-node-tesseract 0.4.0 to 0.4.1 was discovered to contain a remote code execution (RCE) vulnerability via the child_process function.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-24T18:15:09.550",
    "last_modified": "2024-11-21T07:57:17.310",
    "fix_date": "2023-03-06T17:43:56Z"
  },
  "references": [
    {
      "url": "https://github.com/omnitaint/Vulnerability-Reports/blob/ec3645003c7f8996459b5b24c722474adc2d599f/reports/dawnsparks-node-tesseract/report.md",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rona-dinihari/dawnsparks-node-tesseract",
      "source": "cve@mitre.org",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/rona-dinihari/dawnsparks-node-tesseract/commit/81d1664f0b9fe521534acfae1d5b9c40127b36c1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/dawnsparks-node-tesseract",
      "source": "cve@mitre.org",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/omnitaint/Vulnerability-Reports/blob/ec3645003c7f8996459b5b24c722474adc2d599f/reports/dawnsparks-node-tesseract/report.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rona-dinihari/dawnsparks-node-tesseract",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/rona-dinihari/dawnsparks-node-tesseract/commit/81d1664f0b9fe521534acfae1d5b9c40127b36c1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.npmjs.com/package/dawnsparks-node-tesseract",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.829890",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "node-tesseract",
    "owner": "rona-dinihari",
    "created_at": "2023-03-01T07:26:24Z",
    "updated_at": "2024-10-19T01:57:45Z",
    "pushed_at": "2024-12-06T02:40:25Z",
    "size": 195,
    "stars": 1,
    "forks": 1,
    "open_issues": 5,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "JavaScript": 6357
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T20:50:53.651701"
  }
}