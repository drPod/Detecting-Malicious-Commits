{
  "cve_id": "CVE-2023-2999",
  "github_data": {
    "repository": "thorsten/phpmyfaq",
    "fix_commit": "937913948cab382a38f681e0bd29c152e2f383cd",
    "related_commits": [
      "937913948cab382a38f681e0bd29c152e2f383cd",
      "937913948cab382a38f681e0bd29c152e2f383cd"
    ],
    "patch_url": "https://github.com/thorsten/phpmyfaq/commit/937913948cab382a38f681e0bd29c152e2f383cd.patch",
    "fix_commit_details": {
      "sha": "937913948cab382a38f681e0bd29c152e2f383cd",
      "commit_date": "2023-05-03T14:53:01Z",
      "author": {
        "login": "thorsten",
        "type": "User",
        "stats": {
          "total_commits": 7352,
          "average_weekly_commits": 9.19,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 647
        }
      },
      "commit_message": {
        "title": "fix: added HtmlSanitizer",
        "length": 24,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 208,
        "additions": 205,
        "deletions": 3
      },
      "files": [
        {
          "filename": "composer.json",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -32,7 +32,8 @@\n     \"ext-json\": \"*\",\n     \"ext-xml\": \"*\",\n     \"ext-zip\": \"*\",\n-    \"ext-xmlwriter\": \"*\"\n+    \"ext-xmlwriter\": \"*\",\n+    \"tgalopin/html-sanitizer\": \"^1.5\"\n   },\n   \"require-dev\": {\n     \"phpunit/phpunit\": \"9.*\","
        },
        {
          "filename": "composer.lock",
          "status": "modified",
          "additions": 187,
          "deletions": 1,
          "patch": "@@ -4,7 +4,7 @@\n         \"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies\",\n         \"This file is @generated automatically\"\n     ],\n-    \"content-hash\": \"0411bf4e5e79e9aceafffbde9cbbe148\",\n+    \"content-hash\": \"9b3bd5e2f7bec855a914710dc2959459\",\n     \"packages\": [\n         {\n             \"name\": \"abraham/twitteroauth\",\n@@ -610,6 +610,143 @@\n             },\n             \"time\": \"2022-12-07T11:28:53+00:00\"\n         },\n+        {\n+            \"name\": \"league/uri-parser\",\n+            \"version\": \"1.4.1\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/thephpleague/uri-parser.git\",\n+                \"reference\": \"671548427e4c932352d9b9279fdfa345bf63fa00\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/thephpleague/uri-parser/zipball/671548427e4c932352d9b9279fdfa345bf63fa00\",\n+                \"reference\": \"671548427e4c932352d9b9279fdfa345bf63fa00\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"php\": \">=7.0.0\"\n+            },\n+            \"require-dev\": {\n+                \"friendsofphp/php-cs-fixer\": \"^2.0\",\n+                \"phpstan/phpstan\": \"^0.9.2\",\n+                \"phpstan/phpstan-phpunit\": \"^0.9.4\",\n+                \"phpstan/phpstan-strict-rules\": \"^0.9.0\",\n+                \"phpunit/phpunit\": \"^6.0\"\n+            },\n+            \"suggest\": {\n+                \"ext-intl\": \"Allow parsing RFC3987 compliant hosts\",\n+                \"league/uri-schemes\": \"Allow validating and normalizing URI parsing results\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-master\": \"1.x-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"files\": [\n+                    \"src/functions_include.php\"\n+                ],\n+                \"psr-4\": {\n+                    \"League\\\\Uri\\\\\": \"src\"\n+                }\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"MIT\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"Ignace Nyamagana Butera\",\n+                    \"email\": \"nyamsprod@gmail.com\",\n+                    \"homepage\": \"https://nyamsprod.com\"\n+                }\n+            ],\n+            \"description\": \"userland URI parser RFC 3986 compliant\",\n+            \"homepage\": \"https://github.com/thephpleague/uri-parser\",\n+            \"keywords\": [\n+                \"parse_url\",\n+                \"parser\",\n+                \"rfc3986\",\n+                \"rfc3987\",\n+                \"uri\",\n+                \"url\"\n+            ],\n+            \"support\": {\n+                \"issues\": \"https://github.com/thephpleague/uri-parser/issues\",\n+                \"source\": \"https://github.com/thephpleague/uri-parser/tree/master\"\n+            },\n+            \"abandoned\": true,\n+            \"time\": \"2018-11-22T07:55:51+00:00\"\n+        },\n+        {\n+            \"name\": \"masterminds/html5\",\n+            \"version\": \"2.8.0\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/Masterminds/html5-php.git\",\n+                \"reference\": \"3c5d5a56d56f48a1ca08a0670f0f80c1dad368f3\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/Masterminds/html5-php/zipball/3c5d5a56d56f48a1ca08a0670f0f80c1dad368f3\",\n+                \"reference\": \"3c5d5a56d56f48a1ca08a0670f0f80c1dad368f3\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"ext-dom\": \"*\",\n+                \"php\": \">=5.3.0\"\n+            },\n+            \"require-dev\": {\n+                \"phpunit/phpunit\": \"^4.8.35 || ^5.7.21 || ^6 || ^7 || ^8\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-master\": \"2.7-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"psr-4\": {\n+                    \"Masterminds\\\\\": \"src\"\n+                }\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"MIT\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"Matt Butcher\",\n+                    \"email\": \"technosophos@gmail.com\"\n+                },\n+                {\n+                    \"name\": \"Matt Farina\",\n+                    \"email\": \"matt@mattfarina.com\"\n+                },\n+                {\n+                    \"name\": \"Asmir Mustafic\",\n+                    \"email\": \"goetas@gmail.com\"\n+                }\n+            ],\n+            \"description\": \"An HTML5 parser and serializer.\",\n+            \"homepage\": \"http://masterminds.github.io/html5-php\",\n+            \"keywords\": [\n+                \"HTML5\",\n+                \"dom\",\n+                \"html\",\n+                \"parser\",\n+                \"querypath\",\n+                \"serializer\",\n+                \"xml\"\n+            ],\n+            \"support\": {\n+                \"issues\": \"https://github.com/Masterminds/html5-php/issues\",\n+                \"source\": \"https://github.com/Masterminds/html5-php/tree/2.8.0\"\n+            },\n+            \"time\": \"2023-04-26T07:27:39+00:00\"\n+        },\n         {\n             \"name\": \"monolog/monolog\",\n             \"version\": \"2.9.1\",\n@@ -1684,6 +1821,55 @@\n                 }\n             ],\n             \"time\": \"2022-12-17T10:28:59+00:00\"\n+        },\n+        {\n+            \"name\": \"tgalopin/html-sanitizer\",\n+            \"version\": \"1.5.0\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/tgalopin/html-sanitizer.git\",\n+                \"reference\": \"5d02dcb6f2ea4f505731eac440798caa1b3b0913\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/tgalopin/html-sanitizer/zipball/5d02dcb6f2ea4f505731eac440798caa1b3b0913\",\n+                \"reference\": \"5d02dcb6f2ea4f505731eac440798caa1b3b0913\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"ext-dom\": \"*\",\n+                \"league/uri-parser\": \"^1.4.1\",\n+                \"masterminds/html5\": \"^2.4\",\n+                \"php\": \">=7.1\",\n+                \"psr/log\": \"^1.0|^2.0|^3.0\"\n+            },\n+            \"require-dev\": {\n+                \"phpunit/phpunit\": \"^7.4\",\n+                \"symfony/var-dumper\": \"^4.1\"\n+            },\n+            \"type\": \"library\",\n+            \"autoload\": {\n+                \"psr-4\": {\n+                    \"HtmlSanitizer\\\\\": \"src\"\n+                }\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"MIT\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"Titouan Galopin\",\n+                    \"email\": \"galopintitouan@gmail.com\"\n+                }\n+            ],\n+            \"description\": \"Sanitize untrustworthy HTML user input\",\n+            \"support\": {\n+                \"issues\": \"https://github.com/tgalopin/html-sanitizer/issues\",\n+                \"source\": \"https://github.com/tgalopin/html-sanitizer/tree/1.5.0\"\n+            },\n+            \"abandoned\": \"symfony/html-sanitizer\",\n+            \"time\": \"2021-09-14T08:27:50+00:00\"\n         }\n     ],\n     \"packages-dev\": ["
        },
        {
          "filename": "phpmyfaq/faq.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -340,7 +340,7 @@\n         'solutionId' => $faq->faqRecord['solution_id'],\n         'solutionIdLink' => Link::getSystemRelativeUri() . '?solution_id=' . $faq->faqRecord['solution_id'],\n         'question' => $question,\n-        'answer' => $answer,\n+        'answer' => $faqHelper->cleanUpContent($answer),\n         'faqDate' => $date->format($faq->faqRecord['date']),\n         'faqAuthor' => Strings::htmlentities($author),\n         'editThisEntry' => $editThisEntry,"
        },
        {
          "filename": "phpmyfaq/src/phpMyFAQ/Helper/FaqHelper.php",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -18,6 +18,7 @@\n namespace phpMyFAQ\\Helper;\n \n use Exception;\n+use HtmlSanitizer\\Sanitizer;\n use ParsedownExtra;\n use phpMyFAQ\\Category;\n use phpMyFAQ\\Configuration;\n@@ -236,4 +237,18 @@ public function createFaqTranslationLinkList(int $faqId, string $faqLang): strin\n \n         return $output;\n     }\n+\n+\n+    /**\n+     * Remove <script> tags, we don't need them\n+     *\n+     * @param string $content\n+     * @return string\n+     */\n+    public function cleanUpContent(string $content): string\n+    {\n+        $htmlSanitizer = Sanitizer::create(['extensions' => ['basic']]);\n+\n+        return $htmlSanitizer->sanitize($content);\n+    }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "69ccf3a0310a91e580ba3fbae763cf6fc4e70e8c",
            "date": "2025-01-14T04:44:45Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "0aff5a567446adbf5d024e0d8b2b132666f91464",
            "date": "2025-01-13T20:29:34Z",
            "author_login": "modelrailroader"
          },
          {
            "sha": "0ee934f2713e59ed829afa56b95697670cdcfad7",
            "date": "2025-01-13T19:58:07Z",
            "author_login": "modelrailroader"
          },
          {
            "sha": "471ebc8577558da4bcdbf45f7b18ab75e33f9a37",
            "date": "2025-01-13T19:57:09Z",
            "author_login": "modelrailroader"
          },
          {
            "sha": "a91eeb3bad2264155afa2d71f57af6f74c43042a",
            "date": "2025-01-13T18:23:14Z",
            "author_login": "thorsten"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.14.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-31T01:15:43.163",
    "last_modified": "2024-11-21T07:59:43.583",
    "fix_date": "2023-05-03T14:53:01Z"
  },
  "references": [
    {
      "url": "https://github.com/thorsten/phpmyfaq/commit/937913948cab382a38f681e0bd29c152e2f383cd",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/4d89c7cc-fb4c-4b64-9b67-f0189f70a620",
      "source": "security@huntr.dev",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://github.com/thorsten/phpmyfaq/commit/937913948cab382a38f681e0bd29c152e2f383cd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/4d89c7cc-fb4c-4b64-9b67-f0189f70a620",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.280521",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "phpMyFAQ",
    "owner": "thorsten",
    "created_at": "2009-08-04T19:26:15Z",
    "updated_at": "2025-01-14T04:55:59Z",
    "pushed_at": "2025-01-14T04:56:02Z",
    "size": 56435,
    "stars": 589,
    "forks": 255,
    "open_issues": 19,
    "watchers": 589,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 9489706,
      "Twig": 348463,
      "JavaScript": 322766,
      "SCSS": 19741,
      "Shell": 9475,
      "Dockerfile": 2594,
      "CSS": 1125,
      "HTML": 205
    },
    "commit_activity": {
      "total_commits_last_year": 1338,
      "avg_commits_per_week": 25.73076923076923,
      "days_active_last_year": 282
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mpl-2.0"
    },
    "collected_at": "2025-01-14T13:07:11.405854"
  }
}