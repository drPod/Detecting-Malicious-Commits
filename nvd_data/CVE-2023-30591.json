{
  "cve_id": "CVE-2023-30591",
  "github_data": {
    "repository": "NodeBB/NodeBB",
    "fix_commit": "37b48b82a4bc7680c6e4c42647209010cb239c2c",
    "related_commits": [
      "37b48b82a4bc7680c6e4c42647209010cb239c2c",
      "4d2d76897a02e7068ab74c81d17a2febfae8bfb9",
      "830f142b7aea2e597294a84d52c05aab3a3539ca",
      "37b48b82a4bc7680c6e4c42647209010cb239c2c",
      "4d2d76897a02e7068ab74c81d17a2febfae8bfb9",
      "830f142b7aea2e597294a84d52c05aab3a3539ca"
    ],
    "patch_url": "https://github.com/NodeBB/NodeBB/commit/37b48b82a4bc7680c6e4c42647209010cb239c2c.patch",
    "fix_commit_details": {
      "sha": "37b48b82a4bc7680c6e4c42647209010cb239c2c",
      "commit_date": "2023-03-27T14:38:53Z",
      "author": {
        "login": "barisusakli",
        "type": "User",
        "stats": {
          "total_commits": 12172,
          "average_weekly_commits": 19.856443719412724,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 600
        }
      },
      "commit_message": {
        "title": "fix: don't crash if event name is not a string",
        "length": 46,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 15,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/socket.io/index.js",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -120,7 +120,12 @@ async function onMessage(socket, payload) {\n \t\treturn winston.warn('[socket.io] Empty method name');\n \t}\n \n-\tconst parts = eventName.toString().split('.');\n+\tif (typeof eventName !== 'string') {\n+\t\tconst escapedName = validator.escape(String(eventName));\n+\t\treturn callback({ message: `[[error:invalid-event, ${escapedName}]]` });\n+\t}\n+\n+\tconst parts = eventName.split('.');\n \tconst namespace = parts[0];\n \tconst methodToCall = parts.reduce((prev, cur) => {\n \t\tif (prev !== null && prev[cur] && (!prev.hasOwnProperty || prev.hasOwnProperty(cur))) {"
        },
        {
          "filename": "test/socket.io.js",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -107,6 +107,15 @@ describe('socket.io', () => {\n \t\t});\n \t});\n \n+\tit('should return error for invalid eventName type', (done) => {\n+\t\tconst eventName = ['topics.loadMoreTags'];\n+\t\tio.emit(eventName, function (err) {\n+\t\t\tconst eventAsString = String(eventName);\n+\t\t\tassert.strictEqual(err.message, `[[error:invalid-event, ${eventAsString}]]`);\n+\t\t\tdone();\n+\t\t});\n+\t});\n+\n \tit('should get installed themes', (done) => {\n \t\tconst themes = ['nodebb-theme-lavender', 'nodebb-theme-persona', 'nodebb-theme-vanilla'];\n \t\tio.emit('admin.themes.getInstalled', (err, data) => {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c6eaea309e7b49bb5aa288f647efd366786f8462",
            "date": "2025-01-14T15:16:10Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "e89b7ec88762a05e90745d6c89323dc740e0e096",
            "date": "2025-01-13T16:59:42Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "45eabbf5ba2100201fe887a9d6fc81d88379d414",
            "date": "2025-01-08T22:21:05Z",
            "author_login": "barisusakli"
          },
          {
            "sha": "98e5d1b5c2bd33fc4340dc175d1a31c53ab22a83",
            "date": "2025-01-08T17:54:04Z",
            "author_login": "nodebb-misty"
          },
          {
            "sha": "4aeafb672f4e693b8b69ef401fa5f4259965bc4e",
            "date": "2025-01-08T17:54:04Z",
            "author_login": "nodebb-misty"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-241",
    "description": "Denial-of-service in NodeBB <= v2.8.10 allows unauthenticated attackers to trigger a crash, when invoking `eventName.startsWith()` or `eventName.toString()`, while processing Socket.IO messages via crafted Socket.IO messages containing array or object type for the event name respectively.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-29T06:15:09.870",
    "last_modified": "2024-11-21T08:00:28.840",
    "fix_date": "2023-03-27T14:38:53Z"
  },
  "references": [
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/37b48b82a4bc7680c6e4c42647209010cb239c2c",
      "source": "info@starlabs.sg",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/4d2d76897a02e7068ab74c81d17a2febfae8bfb9",
      "source": "info@starlabs.sg",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/830f142b7aea2e597294a84d52c05aab3a3539ca",
      "source": "info@starlabs.sg",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://starlabs.sg/advisories/23/23-30591/",
      "source": "info@starlabs.sg",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/37b48b82a4bc7680c6e4c42647209010cb239c2c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/4d2d76897a02e7068ab74c81d17a2febfae8bfb9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/NodeBB/NodeBB/commit/830f142b7aea2e597294a84d52c05aab3a3539ca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://starlabs.sg/advisories/23/23-30591/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.552264",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "NodeBB",
    "owner": "NodeBB",
    "created_at": "2013-04-22T16:49:40Z",
    "updated_at": "2025-01-14T17:22:47Z",
    "pushed_at": "2025-01-14T16:53:56Z",
    "size": 94074,
    "stars": 14301,
    "forks": 2808,
    "open_issues": 183,
    "watchers": 14301,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "JavaScript": 3635990,
      "Smarty": 492390,
      "SCSS": 35767,
      "HTML": 6457,
      "Shell": 5633,
      "Dockerfile": 4860,
      "CSS": 3261,
      "Batchfile": 42
    },
    "commit_activity": {
      "total_commits_last_year": 1255,
      "avg_commits_per_week": 24.134615384615383,
      "days_active_last_year": 279
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T18:31:47.568922"
  }
}