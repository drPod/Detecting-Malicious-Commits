{
  "cve_id": "CVE-2023-30626",
  "github_data": {
    "repository": "jellyfin/jellyfin",
    "fix_commit": "82ad2633fdfb1c37a158057c7935f83e1129eda7",
    "related_commits": [
      "82ad2633fdfb1c37a158057c7935f83e1129eda7",
      "82ad2633fdfb1c37a158057c7935f83e1129eda7"
    ],
    "patch_url": "https://github.com/jellyfin/jellyfin/commit/82ad2633fdfb1c37a158057c7935f83e1129eda7.patch",
    "fix_commit_details": {
      "sha": "82ad2633fdfb1c37a158057c7935f83e1129eda7",
      "commit_date": "2023-04-23T14:59:32Z",
      "author": {
        "login": "joshuaboniface",
        "type": "User",
        "stats": {
          "total_commits": 1057,
          "average_weekly_commits": 1.696629213483146,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 156
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-9p5f-5x8v-x65m",
        "length": 100,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "MediaBrowser.Controller/ClientEvent/ClientEventLogger.cs",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -23,6 +23,11 @@ public async Task<string> WriteDocumentAsync(string clientName, string clientVer\n         {\n             var fileName = $\"upload_{clientName}_{clientVersion}_{DateTime.UtcNow:yyyyMMddHHmmss}_{Guid.NewGuid():N}.log\";\n             var logFilePath = Path.Combine(_applicationPaths.LogDirectoryPath, fileName);\n+            if (!Path.GetFullPath(logFilePath).StartsWith(_applicationPaths.LogDirectoryPath, StringComparison.Ordinal))\n+            {\n+                throw new ArgumentException(\"Path resolved to filename not in log directory\");\n+            }\n+\n             await using var fileStream = new FileStream(logFilePath, FileMode.CreateNew, FileAccess.Write, FileShare.None);\n             await fileContents.CopyToAsync(fileStream).ConfigureAwait(false);\n             return fileName;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "85e0cad5f3a58668e0dca02b6cb501d2cdcf4a06",
            "date": "2025-01-13T10:07:44Z",
            "author_login": "Bond-009"
          },
          {
            "sha": "0409849cc7dc01b68376a45354e9922dd58fae5b",
            "date": "2025-01-12T04:22:57Z",
            "author_login": "marudosurdo"
          },
          {
            "sha": "4c1a47bc5311c0d15c3ffd42b0c0080a5ae77536",
            "date": "2025-01-11T20:26:51Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "fb5da641f418f5e696d3d021fa3638bde456e981",
            "date": "2025-01-11T16:37:28Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "fd3057b54957a8980acf90ade54d38341e6d695d",
            "date": "2025-01-11T16:37:13Z",
            "author_login": "nielsvanvelzen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-22",
    "description": "Jellyfin is a free-software media system. Versions starting with 10.8.0 and prior to 10.8.10 and prior have a directory traversal vulnerability inside the `ClientLogController`, specifically `/ClientLog/Document`. When combined with a cross-site scripting vulnerability (CVE-2023-30627), this can result in file write and arbitrary code execution. Version 10.8.10 has a patch for this issue. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-24T21:15:09.687",
    "last_modified": "2024-11-21T08:00:32.410",
    "fix_date": "2023-04-23T14:59:32Z"
  },
  "references": [
    {
      "url": "https://github.com/jellyfin/jellyfin-web/security/advisories/GHSA-89hp-h43h-r5pq",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/blob/22d880662283980dec994cd7d35fe269613bfce3/Jellyfin.Api/Controllers/ClientLogController.cs#L44",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/commit/82ad2633fdfb1c37a158057c7935f83e1129eda7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/pull/5918",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/releases/tag/v10.8.10",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/security/advisories/GHSA-9p5f-5x8v-x65m",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin-web/security/advisories/GHSA-89hp-h43h-r5pq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/blob/22d880662283980dec994cd7d35fe269613bfce3/Jellyfin.Api/Controllers/ClientLogController.cs#L44",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/commit/82ad2633fdfb1c37a158057c7935f83e1129eda7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/pull/5918",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/releases/tag/v10.8.10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/security/advisories/GHSA-9p5f-5x8v-x65m",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.831228",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jellyfin",
    "owner": "jellyfin",
    "created_at": "2018-12-09T06:36:45Z",
    "updated_at": "2025-01-14T17:21:41Z",
    "pushed_at": "2025-01-14T14:01:31Z",
    "size": 65488,
    "stars": 36462,
    "forks": 3298,
    "open_issues": 607,
    "watchers": 36462,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release-10.1.0",
      "release-10.2.z",
      "release-10.3.z",
      "release-10.4.z",
      "release-10.5.z",
      "release-10.6.z",
      "release-10.7.z",
      "release-10.8.z",
      "release-10.9.z",
      "release-10.10.z"
    ],
    "languages": {
      "C#": 8009710,
      "HTML": 20081,
      "Shell": 3658,
      "CSS": 329
    },
    "commit_activity": {
      "total_commits_last_year": 1480,
      "avg_commits_per_week": 28.46153846153846,
      "days_active_last_year": 314
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T17:23:28.929778"
  }
}