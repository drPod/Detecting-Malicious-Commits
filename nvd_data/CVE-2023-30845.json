{
  "cve_id": "CVE-2023-30845",
  "github_data": {
    "repository": "GoogleCloudPlatform/esp-v2",
    "fix_commit": "0bcdfc024ce96b34db4e1b4f2211b509d9be93cd",
    "related_commits": [
      "0bcdfc024ce96b34db4e1b4f2211b509d9be93cd",
      "e95670146f5e96bb5565b0a9c1e153886b3e04ce",
      "e98061ee4527a564506ba4e814c0ecf324dc2c6f",
      "0bcdfc024ce96b34db4e1b4f2211b509d9be93cd",
      "e95670146f5e96bb5565b0a9c1e153886b3e04ce",
      "e98061ee4527a564506ba4e814c0ecf324dc2c6f"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "0bcdfc024ce96b34db4e1b4f2211b509d9be93cd",
      "commit_date": "2023-03-28T19:30:48Z",
      "author": {
        "login": "shuoyang2016",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Changelog for v2.43.0",
        "length": 21,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -1,3 +1,9 @@\n+# Release 2.43.0 28-03-2023\n+\n+- move x-http-method-override to beginning of filter chain (#801)\n+- Reduce default jwt_cache_size to 1000 (#798)\n+- improve parsing and handling of ServiceControlUrl (#800)\n+\n # Release 2.42.0 27-02-2023\n \n - Add flag --disable_jwt_audience_service_name_check (#779)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fc94e05471c09bb8cd38f07b59318329f5025f61",
            "date": "2024-11-15T00:33:13Z",
            "author_login": "paulhong01"
          },
          {
            "sha": "efba4ea2e8ee22e33e951790fd78e9b72102907f",
            "date": "2024-11-14T21:20:44Z",
            "author_login": "paulhong01"
          },
          {
            "sha": "a73952ce157c7c6a1808d2c7ebcac8baa6ca90a9",
            "date": "2024-11-13T17:20:05Z",
            "author_login": "gopkarthik"
          },
          {
            "sha": "469de56a070f50300618dfcfeb590ab8055f5c38",
            "date": "2024-09-19T19:06:33Z",
            "author_login": "shuoyang2016"
          },
          {
            "sha": "da93f2a408dca7b998b92df367e8f1df4fa31ed1",
            "date": "2024-07-31T09:09:36Z",
            "author_login": "numanelahi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N",
    "cwe_id": "CWE-287",
    "description": "ESPv2 is a service proxy that provides API management capabilities using Google Service Infrastructure. ESPv2 2.20.0 through 2.42.0 contains an authentication bypass vulnerability. API clients can craft a malicious `X-HTTP-Method-Override` header value to bypass JWT authentication in specific cases.\n\nESPv2 allows malicious requests to bypass authentication if both the conditions are true: The requested HTTP method is **not** in the API service definition (OpenAPI spec or gRPC `google.api.http` proto annotations, and the specified `X-HTTP-Method-Override` is a valid HTTP method in the API service definition. ESPv2 will forward the request to your backend without checking the JWT. Attackers can craft requests with a malicious `X-HTTP-Method-Override` value that allows them to bypass specifying JWTs. Restricting API access with API keys works as intended and is not affected by this vulnerability.\n\nUpgrade deployments to release v2.43.0 or higher to receive a patch. This release ensures that JWT authentication occurs, even when the caller specifies `x-http-method-override`. `x-http-method-override` is still supported by v2.43.0+. API clients can continue sending this header to ESPv2.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-26T21:15:09.277",
    "last_modified": "2024-11-21T08:00:57.553",
    "fix_date": "2023-03-28T19:30:48Z"
  },
  "references": [
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/commit/0bcdfc024ce96b34db4e1b4f2211b509d9be93cd",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/commit/e95670146f5e96bb5565b0a9c1e153886b3e04ce",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/commit/e98061ee4527a564506ba4e814c0ecf324dc2c6f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/security/advisories/GHSA-6qmp-9p95-fc5f",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/commit/0bcdfc024ce96b34db4e1b4f2211b509d9be93cd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/commit/e95670146f5e96bb5565b0a9c1e153886b3e04ce",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/commit/e98061ee4527a564506ba4e814c0ecf324dc2c6f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/GoogleCloudPlatform/esp-v2/security/advisories/GHSA-6qmp-9p95-fc5f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.843575",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "esp-v2",
    "owner": "GoogleCloudPlatform",
    "created_at": "2019-12-04T22:38:31Z",
    "updated_at": "2025-01-04T11:27:07Z",
    "pushed_at": "2024-11-15T00:49:56Z",
    "size": 9353,
    "stars": 275,
    "forks": 170,
    "open_issues": 80,
    "watchers": 275,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Go": 1948029,
      "C++": 733093,
      "Python": 204448,
      "Shell": 151260,
      "Starlark": 56902,
      "Makefile": 15937,
      "JavaScript": 12263,
      "Lua": 2759,
      "Dockerfile": 2691
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:28:54.831663"
  }
}