{
  "cve_id": "CVE-2023-3085",
  "github_data": {
    "repository": "x-wrt/luci",
    "fix_commit": "24d7da2416b9ab246825c33c213fe939a89b369c",
    "related_commits": [
      "24d7da2416b9ab246825c33c213fe939a89b369c",
      "24d7da2416b9ab246825c33c213fe939a89b369c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "24d7da2416b9ab246825c33c213fe939a89b369c",
      "commit_date": "2023-03-10T14:12:22Z",
      "author": {
        "login": "jow-",
        "type": "User",
        "stats": {
          "total_commits": 5823,
          "average_weekly_commits": 6.594563986409966,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 601
        }
      },
      "commit_message": {
        "title": "luci-base: dispatcher.uc: prevent XSS through 404 error template",
        "length": 279,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "modules/luci-base/ucode/dispatcher.uc",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -845,7 +845,7 @@ function run_action(request_path, lang, tree, resolved, action) {\n \t\t\t         \"Install luci-mod-admin-full and retry. \" +\n \t\t\t         \"If the module is already installed, try removing the /tmp/luci-indexcache file.\");\n \t\telse\n-\t\t\terror404(`No page is registered at '/${join(\"/\", resolved.ctx.request_path)}'.\\n` +\n+\t\t\terror404(`No page is registered at '/${entityencode(join(\"/\", resolved.ctx.request_path))}'.\\n` +\n \t\t\t         \"If this url belongs to an extension, make sure it is properly installed.\\n\" +\n \t\t\t         \"If the extension was recently installed, try removing the /tmp/luci-indexcache file.\");\n \t\tbreak;"
        },
        {
          "filename": "modules/luci-base/ucode/template/header.ut",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,7 +10,7 @@\n <script type=\"text/javascript\" src=\"{{ resource }}/promis.min.js\"></script>\n <script type=\"text/javascript\" src=\"{{ resource }}/luci.js\"></script>\n <script type=\"text/javascript\">\n-\tL = new LuCI({{ {\n+\tL = new LuCI({{ replace(`${ {\n \t\tmedia          : media,\n \t\tresource       : resource,\n \t\tscriptname     : http.getenv(\"SCRIPT_NAME\"),\n@@ -28,5 +28,5 @@\n \t\tapply_timeout  : max(+config.apply.timeout  ||   5,  1),\n \t\tapply_display  : max(+config.apply.display  || 1.5,  1),\n \t\trollback_token : rollback_token\n-\t} }});\n+\t} }`, '/', '\\\\/') }});\n </script>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6221ac7e497d15809d8f8e4b806050097797d8f",
            "date": "2024-11-13T12:04:45Z",
            "author_login": "ptpt52"
          },
          {
            "sha": "6e412a86c107db6ab221e0e6c9ca69db56a004dc",
            "date": "2024-08-10T05:17:57Z",
            "author_login": "ptpt52"
          },
          {
            "sha": "301e033f6e1b723227b75c6673ccb21b502a7782",
            "date": "2024-08-09T13:32:39Z",
            "author_login": "ptpt52"
          },
          {
            "sha": "fc2f37b93eb69797452d43685dcde06030fed994",
            "date": "2024-07-23T05:51:30Z",
            "author_login": "ptpt52"
          },
          {
            "sha": "347f24a5f8733ee685b6f75e509f362f3a0517a0",
            "date": "2023-12-18T01:06:43Z",
            "author_login": "ptpt52"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability, which was classified as problematic, has been found in X-WRT luci up to 22.10_b202303061504. This issue affects the function run_action of the file modules/luci-base/ucode/dispatcher.uc of the component 404 Error Template Handler. The manipulation of the argument request_path leads to cross site scripting. The attack may be initiated remotely. Upgrading to version 22.10_b202303121313 is able to address this issue. The patch is named 24d7da2416b9ab246825c33c213fe939a89b369c. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-230663.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-03T11:15:21.443",
    "last_modified": "2024-11-21T08:16:24.700",
    "fix_date": "2023-03-10T14:12:22Z"
  },
  "references": [
    {
      "url": "https://github.com/x-wrt/luci/commit/24d7da2416b9ab246825c33c213fe939a89b369c",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/x-wrt/luci/releases/tag/22.10_b202303121313",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.230663",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.230663",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/x-wrt/luci/commit/24d7da2416b9ab246825c33c213fe939a89b369c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/x-wrt/luci/releases/tag/22.10_b202303121313",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.230663",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://vuldb.com/?id.230663",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.300834",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "luci",
    "owner": "x-wrt",
    "created_at": "2017-03-03T07:02:09Z",
    "updated_at": "2025-01-26T03:04:26Z",
    "pushed_at": "2025-01-26T03:04:01Z",
    "size": 221695,
    "stars": 14,
    "forks": 22,
    "open_issues": 0,
    "watchers": 14,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3689861,
      "C": 1710331,
      "Lua": 1165282,
      "HTML": 628516,
      "Shell": 608092,
      "CSS": 231265,
      "Makefile": 161963,
      "UnrealScript": 81599,
      "Perl": 58132,
      "Java": 49574,
      "C#": 42820,
      "Visual Basic .NET": 33030,
      "Yacc": 17409,
      "Lex": 7173,
      "CMake": 1240,
      "Python": 1165,
      "Ruby": 107
    },
    "commit_activity": {
      "total_commits_last_year": 2262,
      "avg_commits_per_week": 43.5,
      "days_active_last_year": 268
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:23:25.744711"
  }
}