{
  "cve_id": "CVE-2023-31123",
  "github_data": {
    "repository": "effectindex/tripreporter",
    "fix_commit": "bd80ba833b9023d39ca22e29874296c8729dd53b",
    "related_commits": [
      "bd80ba833b9023d39ca22e29874296c8729dd53b",
      "bd80ba833b9023d39ca22e29874296c8729dd53b"
    ],
    "patch_url": "https://github.com/effectindex/tripreporter/commit/bd80ba833b9023d39ca22e29874296c8729dd53b.patch",
    "fix_commit_details": {
      "sha": "bd80ba833b9023d39ca22e29874296c8729dd53b",
      "commit_date": "2023-04-30T12:04:47Z",
      "author": {
        "login": "5HT2",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "api: (account) Fix improper password verification",
        "length": 49,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "api/account.go",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -84,7 +84,7 @@ func AccountPostLogin(w http.ResponseWriter, r *http.Request) {\n \t\treturn\n \t}\n \n-\taccount, err = a1.ValidatePassword(account.Password, \"Password\")\n+\taccount, err = a1.VerifyPassword(account.Password)\n \tif err != nil {\n \t\tctx.HandleStatus(w, r, \"Invalid username or password!\", http.StatusForbidden)\n \t\treturn"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "35391c5a491d44c7711ee91597ed4025b2ce269f",
            "date": "2023-05-04T14:36:13Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "84dd412ff444036686de27fe7e0049ffed24b26e",
            "date": "2023-05-04T14:35:25Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e9d813d2152df9697b23423c1df9274db98d5497",
            "date": "2023-05-04T14:34:27Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "73d00571f1139b073e2f9d4eea910ac81eb5b710",
            "date": "2023-05-04T14:33:10Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "9c7df96216f76ba478f5d04302aeab22d8cd9530",
            "date": "2023-05-04T14:31:56Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-287",
    "description": "`effectindex/tripreporter` is a community-powered, universal platform for submitting and analyzing trip reports. Prior to commit bd80ba833b9023d39ca22e29874296c8729dd53b, any user with an account on an instance of `effectindex/tripreporter`, e.g. `subjective.report`, may be affected by an improper password verification vulnerability. The vulnerability allows any user with a password matching the password requirements to log in as any user. This allows access to accounts / data loss of the user. This issue is patched in commit bd80ba833b9023d39ca22e29874296c8729dd53b. No action necessary for users of `subjective.report`, and anyone running their own instance should update to this commit or newer as soon as possible. As a workaround, someone running their own instance may apply the patch manually.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-08T21:15:11.263",
    "last_modified": "2024-11-21T08:01:26.327",
    "fix_date": "2023-04-30T12:04:47Z"
  },
  "references": [
    {
      "url": "https://github.com/effectindex/tripreporter/commit/bd80ba833b9023d39ca22e29874296c8729dd53b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/effectindex/tripreporter/security/advisories/GHSA-356r-rwp8-h6m6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/effectindex/tripreporter/commit/bd80ba833b9023d39ca22e29874296c8729dd53b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/effectindex/tripreporter/security/advisories/GHSA-356r-rwp8-h6m6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:32.939272",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tripreporter",
    "owner": "effectindex",
    "created_at": "2022-08-11T16:59:15Z",
    "updated_at": "2024-11-12T02:36:49Z",
    "pushed_at": "2023-07-31T07:06:51Z",
    "size": 5682,
    "stars": 10,
    "forks": 3,
    "open_issues": 46,
    "watchers": 10,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Go": 125644,
      "Vue": 66558,
      "JavaScript": 20295,
      "CSS": 15088,
      "Makefile": 1693,
      "HTML": 967,
      "Dockerfile": 609
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:50:36.447758"
  }
}