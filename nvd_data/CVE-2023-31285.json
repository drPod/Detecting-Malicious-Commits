{
  "cve_id": "CVE-2023-31285",
  "github_data": {
    "repository": "serenity-is/Serenity",
    "fix_commit": "11b9d267f840513d04b4f4d4876de7823a6e48d2",
    "related_commits": [
      "11b9d267f840513d04b4f4d4876de7823a6e48d2",
      "11b9d267f840513d04b4f4d4876de7823a6e48d2"
    ],
    "patch_url": "https://github.com/serenity-is/Serenity/commit/11b9d267f840513d04b4f4d4876de7823a6e48d2.patch",
    "fix_commit_details": {
      "sha": "11b9d267f840513d04b4f4d4876de7823a6e48d2",
      "commit_date": "2023-04-06T14:14:51Z",
      "author": {
        "login": "volkanceylan",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": ":up: 6.7.0",
        "length": 10,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 18,
        "additions": 17,
        "deletions": 1
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -1,3 +1,19 @@\n+## 6.7.0 (2023-04-06)\n+\n+Features:\n+\n+  - **[WARNING!]** This release focuses on addressing potential security issues that were recently discovered by Fabian Densborn from SEC Consult. Serene/StartSharp users must either create a new project from the 6.7.0+ template or manually apply the relevant changes from this commit to their existing applications after updating Serenity packages to 6.7.0+: https://github.com/serenity-is/serene/commit/6dce8162f4382badd429a9f0f1470acb64e8c4fd\n+    \n+  - Serenity.is would like to express gratitude to Fabian Densborn for his discovery, analysis, and coordination, as well as the SEC Consult Vulnerability Lab (https://www.sec-consult.com) for responsibly reporting the identified issues and collaborating with us as we addressed them.\n+    \n+  - Added the option to use ClamAV (https://www.clamav.net/) as an antivirus scanner for temporary uploads. To enable it, add `services.ConfigureSection<Serenity.Extensions.ClamAVSettings>(Configuration);` and `services.AddSingleton<IUploadAVScanner, Serenity.Extensions.ClamAVUploadScanner>();` to your Startup.cs after upgrading to Serenity/Serenity.Extensions 6.7.0+. Consult ClamAV documentation on how to install it on your platform. This feature will be enabled by default once these changes have been made in Startup.cs. If you want to disable it for development purposes, set ClamAV:Enabled to false in your appsettings.Development.json (not recommended for production!).\n+    \n+  - Added extensionless and `.htm`/`.html` to the upload file extensions blacklist by default. An attacker can include malicious scripts in such an HTML file, send an administrative user a link to that file via email, and if the administrative user is already logged in to the site while clicking the link, the script can call services, perform actions, etc. on behalf of the user as the cookies are sent by the browser.\n+    \n+  - Ensured that the Forgot password page does not reveal information to identify whether a user with the entered email exists.\n+    \n+  - Ensured that reset password tokens can only be used once. They already expired in 3 hours, but if an attacker could see the link within that time frame (e.g., by eavesdropping), they could use it to change the password again.\n+\n ## 6.6.6 (2023-04-04)\n \n Bugfixes:"
        },
        {
          "filename": "build/Package.Build.props",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n <Project>\r\n   <PropertyGroup>\r\n-    <Version>6.6.6</Version>\r\n+    <Version>6.7.0</Version>\r\n   </PropertyGroup>\r\n </Project>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0bee9b79630bca0bf0d97a0037eb2663769b5a47",
            "date": "2025-01-11T09:33:17Z",
            "author_login": "volkanceylan"
          },
          {
            "sha": "ee0fe8195d12a325da741b84c99bbbdaba7c219b",
            "date": "2025-01-09T19:30:15Z",
            "author_login": "as-enet"
          },
          {
            "sha": "d68b2c6ac57acf939b8e6d82b04c93fdae2f5aa7",
            "date": "2025-01-05T11:08:46Z",
            "author_login": "volkanceylan"
          },
          {
            "sha": "72ee725bc57f6719ecad52be5d7b8d29f8857899",
            "date": "2025-01-04T17:05:10Z",
            "author_login": "volkanceylan"
          },
          {
            "sha": "a0ad83c33f56ca440e9b86fb85f0de6670acce99",
            "date": "2025-01-03T17:10:08Z",
            "author_login": "volkanceylan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "An XSS issue was discovered in Serenity Serene (and StartSharp) before 6.7.0. When users upload temporary files, some specific file endings are not allowed, but it is possible to upload .html or .htm files containing an XSS payload. The resulting link can be sent to an administrator user.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-04-27T03:15:10.107",
    "last_modified": "2024-11-21T08:01:43.623",
    "fix_date": "2023-04-06T14:14:51Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/172648/Serenity-StartSharp-Software-File-Upload-XSS-User-Enumeration-Reusable-Tokens.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2023/May/14",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/serenity-is/Serenity/commit/11b9d267f840513d04b4f4d4876de7823a6e48d2",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/172648/Serenity-StartSharp-Software-File-Upload-XSS-User-Enumeration-Reusable-Tokens.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://seclists.org/fulldisclosure/2023/May/14",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/serenity-is/Serenity/commit/11b9d267f840513d04b4f4d4876de7823a6e48d2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:11.844386",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Serenity",
    "owner": "serenity-is",
    "created_at": "2014-01-31T09:35:59Z",
    "updated_at": "2025-01-11T09:33:28Z",
    "pushed_at": "2025-01-11T09:33:24Z",
    "size": 133738,
    "stars": 2617,
    "forks": 806,
    "open_issues": 0,
    "watchers": 2617,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "actions-update",
      "add-authentication-scheme-option-to-dynamic-scripts",
      "add-auto-register-for-local-texts",
      "add-has-password",
      "add-json-return-type-to-dynamic-scripts-v2",
      "add-mysql-text-mappings",
      "add-return-type-to-dynamic-scripts",
      "aspnetcore22",
      "async-handlers",
      "auto-install-pnpm",
      "category-collapse-issue",
      "change-update-button-text",
      "cke-editor-fixes",
      "common-theme-height-fix",
      "corelib-base-split",
      "corelib-formatter-tests",
      "criteria-builder",
      "default-sql-connection-private-properties",
      "editor-tests",
      "entitygrid-routing-fix",
      "file-download-formatter-icon-fix",
      "fix-LinkingSetRelationBehavior"
    ],
    "languages": {
      "C#": 5487622,
      "TypeScript": 2110278,
      "JavaScript": 808777,
      "CSS": 236321,
      "HTML": 76999,
      "Batchfile": 4472,
      "Dockerfile": 487
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:35:57.170764"
  }
}