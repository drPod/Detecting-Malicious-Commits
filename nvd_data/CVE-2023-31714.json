{
  "cve_id": "CVE-2023-31714",
  "github_data": {
    "repository": "waqaskanju/Chitor-CMS",
    "fix_commit": "69d34420ad382c91b0c285432418c1b0810128c1",
    "related_commits": [
      "69d34420ad382c91b0c285432418c1b0810128c1",
      "69d34420ad382c91b0c285432418c1b0810128c1"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "69d34420ad382c91b0c285432418c1b0810128c1",
      "commit_date": "2023-04-16T18:57:21Z",
      "author": {
        "login": "waqaskanju",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "add real_escape_string function to sandbox validate file",
        "length": 56,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 50,
        "additions": 32,
        "deletions": 18
      },
      "files": [
        {
          "filename": "edit_school.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -17,7 +17,7 @@\n require_once 'sand_box.php';\n $link=$LINK;\n \n-if ($SCHOOL_CHANGES==\"0\") {\n+if ($SCHOOL_CHANGES!=1) {\n     echo '<div class=\"bg-danger text-center\"> Not allowed!! </div>';\n     exit;\n }"
        },
        {
          "filename": "edit_school_class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -19,7 +19,7 @@\n $selected_class=$CLASS_NAME;\n $selected_school=$SCHOOL_NAME;\n \n-if ($SCHOOL_CHANGES==\"0\") {\n+if ($SCHOOL_CHANGES!=1) {\n     echo '<div class=\"bg-danger text-center\"> Not allowed!! </div>';\n     exit;\n }"
        },
        {
          "filename": "functions.php",
          "status": "modified",
          "additions": 0,
          "deletions": 14,
          "patch": "@@ -188,20 +188,6 @@ function redirection($sec,$url)\n     header(\"refresh:$sec; url=$url\");\n }\n \n-/**\n- * Validate Form Input;\n- *\n- * @param string $data Name of the class.\n- *\n- * @return string return clean data.\n- */\n-function Validate_input($data)\n-{\n-    $data = trim($data);\n-    $data = stripslashes($data);\n-    $data = htmlspecialchars($data);\n-    return $data;\n-}\n \n /**\n  * Show Alert Message"
        },
        {
          "filename": "new_code_test.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -16,4 +16,13 @@\n \n require_once 'sand_box.php';\n $link=$LINK;\n+\n+\n+\n+echo $query = 'SELECT Name,Class FROM students_info WHERE Name=? AND Class=?';\n+$result = mysqli_execute_query($link, $query, ['Abdullah','5th']);\n+foreach ($result as $row) {\n+    printf($row[\"Name\"]. $row['Class']);\n+    echo \"<br>\";\n+}\n ?>"
        },
        {
          "filename": "sand_box.php",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -904,6 +904,25 @@ function Exam_footer($class,$fail,$pass,$total)\n     </div>\n     \";\n }\n+\n+\n+/**\n+ * Validate Form Input;\n+ *\n+ * @param string $data Name of the class.\n+ *\n+ * @return string return clean data.\n+ */\n+function Validate_input($data)\n+{\n+    \n+    global $link;\n+    $data = trim($data);\n+    $data = stripslashes($data);\n+    $data = htmlspecialchars($data);\n+    mysqli_real_escape_string($link, $data);\n+    return $data;\n+}\n ?>\n \n "
        },
        {
          "filename": "scripts/check_roll_no.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -14,7 +14,7 @@\n  **/\n session_start();\n require_once '../db_connection.php';\n-require_once '../functions.php';\n+require_once '../sand_box.php';\n $link=$LINK;\n \n "
        },
        {
          "filename": "scripts/update_subject_marks.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -41,7 +41,7 @@\n }\n $q=\"UPDATE marks SET $subject = $marks WHERE Roll_No=$roll_no\";\n // Do this if lock=off, that means lock=0\n-// Singel Marks changes=allow means 1.\n+// Single Marks changes=allow means 1.\n if ($SINGLE_MARKS_CHANGES==1 && $update_Status==0) {\n     $exe=mysqli_query($link, $q) or die('error'.mysqli_error($link));\n     if ($exe) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a7a304a238f0dae8278ac7137e1d37a3194a5be7",
            "date": "2025-01-20T11:56:23Z",
            "author_login": "waqaskanju"
          },
          {
            "sha": "877f6c9d91d1f7ebc8c6d9c1dd2442ac43c5b6a4",
            "date": "2025-01-20T11:45:23Z",
            "author_login": "waqaskanju"
          },
          {
            "sha": "2f26b49981bf3eae258e0674d627bb1a0baea6fd",
            "date": "2025-01-16T08:18:09Z",
            "author_login": "waqaskanju"
          },
          {
            "sha": "bfb4160d9c77fac3eb941585b1826ad92974c4d8",
            "date": "2025-01-12T13:40:33Z",
            "author_login": "waqaskanju"
          },
          {
            "sha": "06c5124abfcca8b013e394625fd937a10e4fc601",
            "date": "2025-01-12T13:38:29Z",
            "author_login": "waqaskanju"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "Chitor-CMS before v1.1.2 was discovered to contain multiple SQL injection vulnerabilities.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-30T22:15:08.013",
    "last_modified": "2024-11-21T08:02:11.647",
    "fix_date": "2023-04-16T18:57:21Z"
  },
  "references": [
    {
      "url": "https://github.com/msd0pe-1/chitor-sqli",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/waqaskanju/Chitor-CMS/commit/69d34420ad382c91b0c285432418c1b0810128c1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/waqaskanju/Chitor-CMS/releases/tag/Chitor-cms",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/51383",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/msd0pe-1/chitor-sqli",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/waqaskanju/Chitor-CMS/commit/69d34420ad382c91b0c285432418c1b0810128c1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/waqaskanju/Chitor-CMS/releases/tag/Chitor-cms",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.exploit-db.com/exploits/51383",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.489607",
    "processing_status": "enhanced"
  }
}