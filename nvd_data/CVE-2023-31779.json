{
  "cve_id": "CVE-2023-31779",
  "github_data": {
    "repository": "wekan/wekan",
    "fix_commit": "47ac33d6c234359c31d9b5eae49ed3e793907279",
    "related_commits": [
      "47ac33d6c234359c31d9b5eae49ed3e793907279",
      "47ac33d6c234359c31d9b5eae49ed3e793907279"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "47ac33d6c234359c31d9b5eae49ed3e793907279",
      "commit_date": "2023-04-17T22:30:54Z",
      "author": {
        "login": "xet7",
        "type": "User",
        "stats": {
          "total_commits": 8472,
          "average_weekly_commits": 16.677165354330707,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 408
        }
      },
      "commit_message": {
        "title": "Security fix to ReactionBleed in WeKan. It is XSS in feature \"Reaction to comment\".",
        "length": 163,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
      },
      "files": [
        {
          "filename": "models/cardCommentReactions.js",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -1,5 +1,14 @@\n const commentReactionSchema = new SimpleSchema({\n-  reactionCodepoint: { type: String, optional: false },\n+  reactionCodepoint: {\n+    type: String,\n+    optional: false,\n+    max: 9, // max length of reaction code\n+    custom() {\n+      if (!this.value.match(/^&#\\d{4,6};$/)) { // regex for only valid reactions\n+        return \"incorrectReactionCode\";\n+      }\n+    },\n+  },\n   userIds: { type: [String], defaultValue: [] }\n });\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1bdbfe86bb35c613380ed839aae810e9d3e296a7",
            "date": "2025-01-21T20:44:23Z",
            "author_login": "xet7"
          },
          {
            "sha": "397b9f439eca486eed3c6a3257562053335e5c17",
            "date": "2025-01-21T20:44:12Z",
            "author_login": "xet7"
          },
          {
            "sha": "261e0aee0f4688b91187021d3019d4512347a000",
            "date": "2025-01-20T20:02:15Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a6d9bde658bc97991a9ecff66eca573b1d263184",
            "date": "2025-01-20T20:02:13Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "8d0a07e1a8a401740906c345bf43f8d66b22557d",
            "date": "2025-01-19T21:06:23Z",
            "author_login": "xet7"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Wekan v6.84 and earlier is vulnerable to Cross Site Scripting (XSS). An attacker with user privilege on kanban board can insert JavaScript code in in \"Reaction to comment\" feature.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-22T13:15:09.913",
    "last_modified": "2024-11-21T08:02:15.617",
    "fix_date": "2023-04-17T22:30:54Z"
  },
  "references": [
    {
      "url": "https://github.com/wekan/wekan/blob/master/CHANGELOG.md",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/wekan/wekan/commit/47ac33d6c234359c31d9b5eae49ed3e793907279",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/wekan/wekan/blob/master/CHANGELOG.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/wekan/wekan/commit/47ac33d6c234359c31d9b5eae49ed3e793907279",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:32.988739",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "wekan",
    "owner": "wekan",
    "created_at": "2014-01-21T01:26:28Z",
    "updated_at": "2025-01-25T21:34:24Z",
    "pushed_at": "2025-01-21T20:44:31Z",
    "size": 69611,
    "stars": 19749,
    "forks": 2853,
    "open_issues": 654,
    "watchers": 19749,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 2502301,
      "HTML": 938287,
      "CSS": 548881,
      "Pug": 281872,
      "Shell": 190550,
      "Python": 69853,
      "Batchfile": 30040,
      "Dockerfile": 16324,
      "Cap'n Proto": 9446,
      "PHP": 6255
    },
    "commit_activity": {
      "total_commits_last_year": 807,
      "avg_commits_per_week": 15.51923076923077,
      "days_active_last_year": 160
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:31:42.741476"
  }
}