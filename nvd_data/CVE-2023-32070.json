{
  "cve_id": "CVE-2023-32070",
  "github_data": {
    "repository": "xwiki/xwiki-rendering",
    "fix_commit": "c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1",
    "related_commits": [
      "c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1",
      "c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-rendering/commit/c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1.patch",
    "fix_commit_details": {
      "sha": "c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1",
      "commit_date": "2022-04-29T08:33:38Z",
      "author": {
        "login": "michitux",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "XRENDERING-663: Restrict allowed attributes in HTML rendering",
        "length": 266,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 447,
        "additions": 330,
        "deletions": 117
      },
      "files": [
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/escape/escape15.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -20,16 +20,16 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><span class=\"wikiexternallink\"><a param=\"value\" href=\"refe||rence\">lab&gt;&gt;el~</a></span></p>\n+<p><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"refe||rence\">lab&gt;&gt;el~</a></span></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|url|-|refe||rence--><span class=\"wikiexternallink\"><a param=\"value\" href=\"refe||rence\">lab&gt;&gt;el~</a></span><!--stopwikilink--></p>\n+<p><!--startwikilink:false|-|url|-|refe||rence--><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"refe||rence\">lab&gt;&gt;el~</a></span><!--stopwikilink--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n [[lab~>~>el~~~~>>refe~|~|rence||param=\"value\"]]\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|url|-|refe||rence--><span class=\"wikiexternallink\"><a param=\"value\" href=\"refe||rence\">lab&gt;&gt;el~</a></span><!--stopwikilink--></p>\n\\ No newline at end of file\n+<p><!--startwikilink:false|-|url|-|refe||rence--><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"refe||rence\">lab&gt;&gt;el~</a></span><!--stopwikilink--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/group/group9.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -29,7 +29,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<div param=\"value\"><p>some text</p></div><div param=\"value\"><p>some text</p></div>\n+<div data-xwiki-translated-attribute-param=\"value\"><p>some text</p></div><div data-xwiki-translated-attribute-param=\"value\"><p>some text</p></div>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -45,4 +45,4 @@ some text\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<div param=\"value\"><p>some text</p></div><div param=\"value\"><p>some text</p></div>\n\\ No newline at end of file\n+<div data-xwiki-translated-attribute-param=\"value\"><p>some text</p></div><div data-xwiki-translated-attribute-param=\"value\"><p>some text</p></div>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/horizontalline/horizontalline5.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -12,7 +12,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<hr param=\"value\"/>\n+<hr data-xwiki-translated-attribute-param=\"value\"/>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -21,4 +21,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<html><hr param=\"value\"/></html>\n\\ No newline at end of file\n+<html><hr data-xwiki-translated-attribute-param=\"value\"/></html>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/italic/italic8.test",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><em><span a=\"b\">something</span></em></p>\n+<p><em><span data-xwiki-translated-attribute-a=\"b\">something</span></em></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/list/definitionlist7.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -21,7 +21,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<dl param=\"value\"><dt>title</dt><dd>definition</dd></dl>\n+<dl data-xwiki-translated-attribute-param=\"value\"><dt>title</dt><dd>definition</dd></dl>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -31,7 +31,7 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<dl param=\"value\"><dt>title</dt><dd>definition</dd></dl>\n+<dl data-xwiki-translated-attribute-param=\"value\"><dt>title</dt><dd>definition</dd></dl>\n .#-----------------------------------------------------\n .expect|plain/1.0\n .#-----------------------------------------------------"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/list/list13.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -42,7 +42,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<ul param=\"value\"><li>item 1<ul param2=\"value2\"><li>item 1.1<ul><li>item 1.1.1</li></ul></li></ul></li></ul>\n+<ul data-xwiki-translated-attribute-param=\"value\"><li>item 1<ul data-xwiki-translated-attribute-param2=\"value2\"><li>item 1.1<ul><li>item 1.1.1</li></ul></li></ul></li></ul>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -54,4 +54,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<ul param=\"value\"><li>item 1<ul param2=\"value2\"><li>item 1.1<ul><li>item 1.1.1</li></ul></li></ul></li></ul>\n\\ No newline at end of file\n+<ul data-xwiki-translated-attribute-param=\"value\"><li>item 1<ul data-xwiki-translated-attribute-param2=\"value2\"><li>item 1.1<ul><li>item 1.1.1</li></ul></li></ul></li></ul>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/list/list8.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<ul param1=\"value1\" param2=\"value2\"><li>item</li></ul>\n+<ul data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\"><li>item</li></ul>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -25,4 +25,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<html><ul param1=\"value1\" param2=\"value2\"><li>item</li></ul></html>\n\\ No newline at end of file\n+<html><ul data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\"><li>item</li></ul></html>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/macros/macro10.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -44,12 +44,12 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<span param=\"value\">formatmacro2</span><p><span a=\"b\"><span param=\"value\">formatmacro3</span> text</span></p><p><span a=\"b\">text</span><span param=\"value\">formatmacro4</span></p>\n+<span data-xwiki-translated-attribute-param=\"value\">formatmacro2</span><p><span data-xwiki-translated-attribute-a=\"b\"><span data-xwiki-translated-attribute-param=\"value\">formatmacro3</span> text</span></p><p><span data-xwiki-translated-attribute-a=\"b\">text</span><span data-xwiki-translated-attribute-param=\"value\">formatmacro4</span></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<!--startmacro:testformatmacro|-|--><span param=\"value\">formatmacro2</span><!--stopmacro--><p><span a=\"b\"><!--startmacro:testformatmacro|-|--><span param=\"value\">formatmacro3</span><!--stopmacro--> text</span></p><p><span a=\"b\">text</span><!--startmacro:testformatmacro|-|--><span param=\"value\">formatmacro4</span><!--stopmacro--></p>\n+<!--startmacro:testformatmacro|-|--><span data-xwiki-translated-attribute-param=\"value\">formatmacro2</span><!--stopmacro--><p><span data-xwiki-translated-attribute-a=\"b\"><!--startmacro:testformatmacro|-|--><span data-xwiki-translated-attribute-param=\"value\">formatmacro3</span><!--stopmacro--> text</span></p><p><span data-xwiki-translated-attribute-a=\"b\">text</span><!--startmacro:testformatmacro|-|--><span data-xwiki-translated-attribute-param=\"value\">formatmacro4</span><!--stopmacro--></p>\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<!--startmacro:testformatmacro|-|--><span param=\"value\">formatmacro2</span><!--stopmacro--><p><span a=\"b\"><!--startmacro:testformatmacro|-|--><span param=\"value\">formatmacro3</span><!--stopmacro--> text</span></p><p><span a=\"b\">text</span><!--startmacro:testformatmacro|-|--><span param=\"value\">formatmacro4</span><!--stopmacro--></p>\n\\ No newline at end of file\n+<!--startmacro:testformatmacro|-|--><span data-xwiki-translated-attribute-param=\"value\">formatmacro2</span><!--stopmacro--><p><span data-xwiki-translated-attribute-a=\"b\"><!--startmacro:testformatmacro|-|--><span data-xwiki-translated-attribute-param=\"value\">formatmacro3</span><!--stopmacro--> text</span></p><p><span data-xwiki-translated-attribute-a=\"b\">text</span><!--startmacro:testformatmacro|-|--><span data-xwiki-translated-attribute-param=\"value\">formatmacro4</span><!--stopmacro--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/paragraph/paragraph6.test",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -105,7 +105,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p param1=\"value1\" param2=\"value2\"><span param3=\"value3\">hello</span> world</p><p><span param4=\"valueA\">hello&nbsp;</span><span param4=\"valueB\">world</span></p><p><strong><span param5=\"value4\">hello</span></strong><span param5=\"value4\">&nbsp;world</span></p><p><span param6=\"valueA\">hello&nbsp;</span><span param7=\"valueB\">world</span></p><p>before<span param=\"value\">x</span><strong>y</strong>after</p><p>12<strong>34<span param=\"value\">56</span>78</strong>90</p><p><span param=\"value\">1<em>2</em></span><em>3</em></p><p><strong><span param1=\"value1\">1</span></strong><strong><span param2=\"value2\">2</span></strong></p>\n+<p data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\"><span data-xwiki-translated-attribute-param3=\"value3\">hello</span> world</p><p><span data-xwiki-translated-attribute-param4=\"valueA\">hello&nbsp;</span><span data-xwiki-translated-attribute-param4=\"valueB\">world</span></p><p><strong><span data-xwiki-translated-attribute-param5=\"value4\">hello</span></strong><span data-xwiki-translated-attribute-param5=\"value4\">&nbsp;world</span></p><p><span data-xwiki-translated-attribute-param6=\"valueA\">hello&nbsp;</span><span data-xwiki-translated-attribute-param7=\"valueB\">world</span></p><p>before<span data-xwiki-translated-attribute-param=\"value\">x</span><strong>y</strong>after</p><p>12<strong>34<span data-xwiki-translated-attribute-param=\"value\">56</span>78</strong>90</p><p><span data-xwiki-translated-attribute-param=\"value\">1<em>2</em></span><em>3</em></p><p><strong><span data-xwiki-translated-attribute-param1=\"value1\">1</span></strong><strong><span data-xwiki-translated-attribute-param2=\"value2\">2</span></strong></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/quote/quote3.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<blockquote param1=\"value1\" param2=\"value2\"><p>line</p></blockquote>\n+<blockquote data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\"><p>line</p></blockquote>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -25,4 +25,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<blockquote param1=\"value1\" param2=\"value2\"><p>line</p></blockquote>\n\\ No newline at end of file\n+<blockquote data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\"><p>line</p></blockquote>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/section/section6.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -17,7 +17,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<h1 id=\"Hheader\" class=\"wikigeneratedid\" param=\"value\"><span>header</span></h1>\n+<h1 id=\"Hheader\" class=\"wikigeneratedid\" data-xwiki-translated-attribute-param=\"value\"><span>header</span></h1>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -26,4 +26,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<html><h1 id=\"Hheader\" class=\"wikigeneratedid\" param=\"value\"><span>header</span></h1></html>\n\\ No newline at end of file\n+<html><h1 id=\"Hheader\" class=\"wikigeneratedid\" data-xwiki-translated-attribute-param=\"value\"><span>header</span></h1></html>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/strikedout/strikedout4.test",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><del><span a=\"b\">something</span></del></p>\n+<p><del><span data-xwiki-translated-attribute-a=\"b\">something</span></del></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/subscript/subscript2.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n .input|xhtml/1.0\n .# Verify that SUB tag parameters are recognized.\n .#-----------------------------------------------------\n-<html><p><sub a=\"b\">something</sub></p></html>\n+<html><p><sub data-xwiki-translated-attribute-a=\"b\">something</sub></p></html>\n .#-----------------------------------------------------\n .expect|event/1.0\n .#-----------------------------------------------------\n@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><sub><span a=\"b\">something</span></sub></p>\n+<p><sub><span data-xwiki-translated-attribute-a=\"b\">something</span></sub></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/superscript/superscript2.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n .input|xhtml/1.0\n .# Verify that SUP tag parameters are recognized.\n .#-----------------------------------------------------\n-<html><p><sup a=\"b\">something</sup></p></html>\n+<html><p><sup data-xwiki-translated-attribute-a=\"b\">something</sup></p></html>\n .#-----------------------------------------------------\n .expect|event/1.0\n .#-----------------------------------------------------\n@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><sup><span a=\"b\">something</span></sup></p>\n+<p><sup><span data-xwiki-translated-attribute-a=\"b\">something</span></sup></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/table/table3.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -43,7 +43,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<table a=\"b\"><tr c=\"d\"><th e=\"f\" scope=\"col\"><span g=\"h\">cell1</span></th><td i=\"j\"><span k=\"l\">cell2</span></td></tr></table><table a=\"b\"><tr c=\"d\"><th e=\"f\" scope=\"col\"><span g=\"h\">cell1</span></th><td i=\"j\"><span k=\"l\">cell2</span></td></tr></table>\n+<table data-xwiki-translated-attribute-a=\"b\"><tr data-xwiki-translated-attribute-c=\"d\"><th data-xwiki-translated-attribute-e=\"f\" scope=\"col\"><span data-xwiki-translated-attribute-g=\"h\">cell1</span></th><td data-xwiki-translated-attribute-i=\"j\"><span k=\"l\">cell2</span></td></tr></table><table data-xwiki-translated-attribute-a=\"b\"><tr data-xwiki-translated-attribute-c=\"d\"><th data-xwiki-translated-attribute-e=\"f\" scope=\"col\"><span data-xwiki-translated-attribute-g=\"h\">cell1</span></th><td data-xwiki-translated-attribute-i=\"j\"><span k=\"l\">cell2</span></td></tr></table>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -55,4 +55,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<table a=\"b\"><tr c=\"d\"><th e=\"f\" scope=\"col\"><span g=\"h\">cell1</span></th><td i=\"j\"><span k=\"l\">cell2</span></td></tr></table><table a=\"b\"><tr c=\"d\"><th e=\"f\" scope=\"col\"><span g=\"h\">cell1</span></th><td i=\"j\"><span k=\"l\">cell2</span></td></tr></table>\n\\ No newline at end of file\n+<table data-xwiki-translated-attribute-a=\"b\"><tr data-xwiki-translated-attribute-c=\"d\"><th data-xwiki-translated-attribute-e=\"f\" scope=\"col\"><span data-xwiki-translated-attribute-g=\"h\">cell1</span></th><td data-xwiki-translated-attribute-i=\"j\"><span k=\"l\">cell2</span></td></tr></table><table data-xwiki-translated-attribute-a=\"b\"><tr data-xwiki-translated-attribute-c=\"d\"><th data-xwiki-translated-attribute-e=\"f\" scope=\"col\"><span data-xwiki-translated-attribute-g=\"h\">cell1</span></th><td data-xwiki-translated-attribute-i=\"j\"><span k=\"l\">cell2</span></td></tr></table>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/verbatim/verbatim6.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -12,7 +12,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<pre param=\"value\">abc</pre>\n+<pre data-xwiki-translated-attribute-param=\"value\">abc</pre>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -21,4 +21,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<html><pre param=\"value\">abc</pre></html>\n+<html><pre data-xwiki-translated-attribute-param=\"value\">abc</pre></html>"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/simple/verbatim/verbatim7.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,7 +16,7 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p param=\"value\"><span param2=\"value2\"><tt class=\"wikimodel-verbatim\">abc</tt></span></p>\n+<p data-xwiki-translated-attribute-param=\"value\"><span data-xwiki-translated-attribute-param2=\"value2\"><tt class=\"wikimodel-verbatim\">abc</tt></span></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -25,4 +25,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p param=\"value\"><span param2=\"value2\"><tt class=\"wikimodel-verbatim\">abc</tt></span></p>\n\\ No newline at end of file\n+<p data-xwiki-translated-attribute-param=\"value\"><span data-xwiki-translated-attribute-param2=\"value2\"><tt class=\"wikimodel-verbatim\">abc</tt></span></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/image/image1.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -16,11 +16,11 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><img src=\"imageurl\" param1=\"value1\" param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><br/><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/></p>\n+<p><img src=\"imageurl\" data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><br/><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startimage:false|-|attach|-|my.png--><img src=\"imageurl\" param1=\"value1\" param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><!--stopimage--><br/><!--startimage:false|-|attach|-|Space.ExistingPage@my.png--><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n+<p><!--startimage:false|-|attach|-|my.png--><img src=\"imageurl\" data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><!--stopimage--><br/><!--startimage:false|-|attach|-|Space.ExistingPage@my.png--><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -29,4 +29,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startimage:false|-|attach|-|my.png--><img src=\"imageurl\" param1=\"value1\" param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><!--stopimage--><br/><!--startimage:false|-|attach|-|Space.ExistingPage@my.png--><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n\\ No newline at end of file\n+<p><!--startimage:false|-|attach|-|my.png--><img src=\"imageurl\" data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><!--stopimage--><br/><!--startimage:false|-|attach|-|Space.ExistingPage@my.png--><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/image/image12.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -65,8 +65,8 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<img src=\"imageurl\" param1=\"value1\" param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><div class=\"figcaption\"><p>Image <strong>Caption</strong></p></div><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><div class=\"figcaption\"><p>Caption</p><ul><li>With</li><li>nested</li><li>list <span class=\"wikiexternallink\"><a href=\"https://xwiki.org\">and link</a></span> and [[fake link]].</li></ul></div>\n+<img src=\"imageurl\" data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><div class=\"figcaption\"><p>Image <strong>Caption</strong></p></div><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><div class=\"figcaption\"><p>Caption</p><ul><li>With</li><li>nested</li><li>list <span class=\"wikiexternallink\"><a href=\"https://xwiki.org\">and link</a></span> and [[fake link]].</li></ul></div>\n .#-----------------------------------------------------\n .expect|html/5.0\n .#-----------------------------------------------------\n-<figure class=\"image\"><img src=\"imageurl\" param1=\"value1\" param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><figcaption><p>Image <strong>Caption</strong></p></figcaption></figure><figure class=\"image\"><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><figcaption><p>Caption</p><ul><li>With</li><li>nested</li><li>list <span class=\"wikiexternallink\"><a href=\"https://xwiki.org\">and link</a></span> and [[fake link]].</li></ul></figcaption></figure>\n\\ No newline at end of file\n+<figure class=\"image\"><img src=\"imageurl\" data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"Imy.png\" class=\"wikigeneratedid\" alt=\"my.png\"/><figcaption><p>Image <strong>Caption</strong></p></figcaption></figure><figure class=\"image\"><img src=\"imageurl\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><figcaption><p>Caption</p><ul><li>With</li><li>nested</li><li>list <span class=\"wikiexternallink\"><a href=\"https://xwiki.org\">and link</a></span> and [[fake link]].</li></ul></figcaption></figure>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/image/image8.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -15,16 +15,16 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><img src=\"imageurl\" param2=\"value2\" id=\"ISpace.ExistingPage40my.png3Fparam13Dvalue1\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png?param1=value1\"/></p>\n+<p><img src=\"imageurl\" data-xwiki-translated-attribute-param2=\"value2\" id=\"ISpace.ExistingPage40my.png3Fparam13Dvalue1\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png?param1=value1\"/></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png?param1=value1--><img src=\"imageurl\" param2=\"value2\" id=\"ISpace.ExistingPage40my.png3Fparam13Dvalue1\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png?param1=value1\"/><!--stopimage--></p>\n+<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png?param1=value1--><img src=\"imageurl\" data-xwiki-translated-attribute-param2=\"value2\" id=\"ISpace.ExistingPage40my.png3Fparam13Dvalue1\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png?param1=value1\"/><!--stopimage--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n [[image:Space.ExistingPage@my.png?param1=value1||param2=\"value2\"]]\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png?param1=value1--><img src=\"imageurl\" param2=\"value2\" id=\"ISpace.ExistingPage40my.png3Fparam13Dvalue1\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png?param1=value1\"/><!--stopimage--></p>\n\\ No newline at end of file\n+<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png?param1=value1--><img src=\"imageurl\" data-xwiki-translated-attribute-param2=\"value2\" id=\"ISpace.ExistingPage40my.png3Fparam13Dvalue1\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png?param1=value1\"/><!--stopimage--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/image/image9.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -15,16 +15,16 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><img src=\"imageurl?param1=value1\" param2=\"value2\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/></p>\n+<p><img src=\"imageurl?param1=value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png|-|queryString=\"param1=value1\"--><img src=\"imageurl?param1=value1\" param2=\"value2\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n+<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png|-|queryString=\"param1=value1\"--><img src=\"imageurl?param1=value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.1\n .#-----------------------------------------------------\n [[image:Space.ExistingPage@my.png||queryString=\"param1=value1\" param2=\"value2\"]]\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png|-|queryString=\"param1=value1\"--><img src=\"imageurl?param1=value1\" param2=\"value2\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n\\ No newline at end of file\n+<p><!--startimage:false|-|attach|-|Space.ExistingPage@my.png|-|queryString=\"param1=value1\"--><img src=\"imageurl?param1=value1\" data-xwiki-translated-attribute-param2=\"value2\" id=\"ISpace.ExistingPage40my.png\" class=\"wikigeneratedid\" alt=\"Space.ExistingPage@my.png\"/><!--stopimage--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/link/links14.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -16,16 +16,16 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><span class=\"wikiexternallink\"><a param=\"value\" href=\"http://xwiki.org\"><img src=\"imageurl\" height=\"100\" width=\"100\" id=\"Iattach.png\" class=\"wikigeneratedid\" alt=\"attach.png\"/></a></span></p>\n+<p><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"http://xwiki.org\"><img src=\"imageurl\" height=\"100\" width=\"100\" id=\"Iattach.png\" class=\"wikigeneratedid\" alt=\"attach.png\"/></a></span></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|url|-|http://xwiki.org--><span class=\"wikiexternallink\"><a param=\"value\" href=\"http://xwiki.org\"><!--startimage:false|-|attach|-|attach.png--><img src=\"imageurl\" height=\"100\" width=\"100\" id=\"Iattach.png\" class=\"wikigeneratedid\" alt=\"attach.png\"/><!--stopimage--></a></span><!--stopwikilink--></p>\n+<p><!--startwikilink:false|-|url|-|http://xwiki.org--><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"http://xwiki.org\"><!--startimage:false|-|attach|-|attach.png--><img src=\"imageurl\" height=\"100\" width=\"100\" id=\"Iattach.png\" class=\"wikigeneratedid\" alt=\"attach.png\"/><!--stopimage--></a></span><!--stopwikilink--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n [[~[~[image:attach.png~|~|height=\"100\" width=\"100\"~]~]>>http://xwiki.org||param=\"value\"]]\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|url|-|http://xwiki.org--><span class=\"wikiexternallink\"><a param=\"value\" href=\"http://xwiki.org\"><!--startimage:false|-|attach|-|attach.png--><img src=\"imageurl\" height=\"100\" width=\"100\" id=\"Iattach.png\" class=\"wikigeneratedid\" alt=\"attach.png\"/><!--stopimage--></a></span><!--stopwikilink--></p>\n\\ No newline at end of file\n+<p><!--startwikilink:false|-|url|-|http://xwiki.org--><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"http://xwiki.org\"><!--startimage:false|-|attach|-|attach.png--><img src=\"imageurl\" height=\"100\" width=\"100\" id=\"Iattach.png\" class=\"wikigeneratedid\" alt=\"attach.png\"/><!--stopimage--></a></span><!--stopwikilink--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/link/links15.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -18,11 +18,11 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><span class=\"wikiattachmentlink\"><a param1=\"value1\" param2=\"value2\" href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">my.png</span></a></span><br/><span class=\"wikiattachmentlink\"><a href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage@my.png</span></a></span></p>\n+<p><span class=\"wikiattachmentlink\"><a data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">my.png</span></a></span><br/><span class=\"wikiattachmentlink\"><a href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage@my.png</span></a></span></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:true|-|attach|-|my.png--><span class=\"wikiattachmentlink\"><a param1=\"value1\" param2=\"value2\" href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">my.png</span></a></span><!--stopwikilink--><br/><!--startwikilink:true|-|attach|-|Space.ExistingPage@my.png--><span class=\"wikiattachmentlink\"><a href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage@my.png</span></a></span><!--stopwikilink--></p>\n+<p><!--startwikilink:true|-|attach|-|my.png--><span class=\"wikiattachmentlink\"><a data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">my.png</span></a></span><!--stopwikilink--><br/><!--startwikilink:true|-|attach|-|Space.ExistingPage@my.png--><span class=\"wikiattachmentlink\"><a href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage@my.png</span></a></span><!--stopwikilink--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -31,4 +31,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:true|-|attach|-|my.png--><span class=\"wikiattachmentlink\"><a param1=\"value1\" param2=\"value2\" href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">my.png</span></a></span><!--stopwikilink--><br/><!--startwikilink:true|-|attach|-|Space.ExistingPage@my.png--><span class=\"wikiattachmentlink\"><a href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage@my.png</span></a></span><!--stopwikilink--></p>\n\\ No newline at end of file\n+<p><!--startwikilink:true|-|attach|-|my.png--><span class=\"wikiattachmentlink\"><a data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">my.png</span></a></span><!--stopwikilink--><br/><!--startwikilink:true|-|attach|-|Space.ExistingPage@my.png--><span class=\"wikiattachmentlink\"><a href=\"attachmenturl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage@my.png</span></a></span><!--stopwikilink--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/link/links19.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -4,7 +4,7 @@\n .# that the XHTML Renderer uses. Note that for now the HREF value is considered containing\n .# XWiki link syntax.\n .#----------------------------------------------------------------------------------------------\n-<p><a href=\"http://reference\" param1=\"value1\">http://reference</a></p>\n+<p><a href=\"http://reference\" data-xwiki-translated-attribute-param1=\"value1\">http://reference</a></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -29,4 +29,4 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><span class=\"wikiexternallink\"><a param1=\"value1\" href=\"http://reference\">http://reference</a></span></p>\n\\ No newline at end of file\n+<p><span class=\"wikiexternallink\"><a data-xwiki-translated-attribute-param1=\"value1\" href=\"http://reference\">http://reference</a></span></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/link/links2.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -21,11 +21,11 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><span class=\"wikilink\"><a param2=\"value2\" href=\"viewurl?param1=value1#anchor\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span></p>\n+<p><span class=\"wikilink\"><a data-xwiki-translated-attribute-param2=\"value2\" href=\"viewurl?param1=value1#anchor\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|doc|-|Space.ExistingPage|-|queryString=\"param1=value1\" anchor=\"anchor\"--><span class=\"wikilink\"><a param2=\"value2\" href=\"viewurl?param1=value1#anchor\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--></p>\n+<p><!--startwikilink:false|-|doc|-|Space.ExistingPage|-|queryString=\"param1=value1\" anchor=\"anchor\"--><span class=\"wikilink\"><a data-xwiki-translated-attribute-param2=\"value2\" href=\"viewurl?param1=value1#anchor\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -37,4 +37,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|doc|-|Space.ExistingPage|-|queryString=\"param1=value1\" anchor=\"anchor\"--><span class=\"wikilink\"><a param2=\"value2\" href=\"viewurl?param1=value1#anchor\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--></p>\n\\ No newline at end of file\n+<p><!--startwikilink:false|-|doc|-|Space.ExistingPage|-|queryString=\"param1=value1\" anchor=\"anchor\"--><span class=\"wikilink\"><a data-xwiki-translated-attribute-param2=\"value2\" href=\"viewurl?param1=value1#anchor\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-integration-tests/src/test/resources/wiki/link/links8.test",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -19,11 +19,11 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><span class=\"wikilink\"><a param1=\"value1\" param2=\"value2\" href=\"viewurl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><br/><span class=\"wikicreatelink\"><a param=\"value\" href=\"editurl\">label</a></span></p>\n+<p><span class=\"wikilink\"><a data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" href=\"viewurl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><br/><span class=\"wikicreatelink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"editurl\">label</a></span></p>\n .#-----------------------------------------------------\n .expect|annotatedxhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|doc|-|Space.ExistingPage--><span class=\"wikilink\"><a param1=\"value1\" param2=\"value2\" href=\"viewurl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--><br/><!--startwikilink:false|-|doc|-|Space.UnknownPage--><span class=\"wikicreatelink\"><a param=\"value\" href=\"editurl\">label</a></span><!--stopwikilink--></p>\n+<p><!--startwikilink:false|-|doc|-|Space.ExistingPage--><span class=\"wikilink\"><a data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" href=\"viewurl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--><br/><!--startwikilink:false|-|doc|-|Space.UnknownPage--><span class=\"wikicreatelink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"editurl\">label</a></span><!--stopwikilink--></p>\n .#-----------------------------------------------------\n .expect|xwiki/2.0\n .#-----------------------------------------------------\n@@ -32,4 +32,4 @@ endDocument\n .#-----------------------------------------------------\n .input|xhtml/1.0\n .#-----------------------------------------------------\n-<p><!--startwikilink:false|-|doc|-|Space.ExistingPage--><span class=\"wikilink\"><a param1=\"value1\" param2=\"value2\" href=\"viewurl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--><br/><!--startwikilink:false|-|doc|-|Space.UnknownPage--><span class=\"wikicreatelink\"><a param=\"value\" href=\"editurl\">label</a></span><!--stopwikilink--></p>\n\\ No newline at end of file\n+<p><!--startwikilink:false|-|doc|-|Space.ExistingPage--><span class=\"wikilink\"><a data-xwiki-translated-attribute-param1=\"value1\" data-xwiki-translated-attribute-param2=\"value2\" href=\"viewurl\"><span class=\"wikigeneratedlinkcontent\">Space.ExistingPage</span></a></span><!--stopwikilink--><br/><!--startwikilink:false|-|doc|-|Space.UnknownPage--><span class=\"wikicreatelink\"><a data-xwiki-translated-attribute-param=\"value\" href=\"editurl\">label</a></span><!--stopwikilink--></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-macros/xwiki-rendering-macro-html/src/main/java/org/xwiki/rendering/internal/macro/html/HTMLMacroXHTMLRenderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -29,6 +29,7 @@\n import org.xwiki.rendering.internal.renderer.xhtml.image.XHTMLImageRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Renderer that generates XHTML from a XDOM resulting from the parsing of text containing HTML mixed with wiki syntax.\n@@ -57,9 +58,13 @@ public class HTMLMacroXHTMLRenderer extends AbstractHTMLMacroRenderer\n     @Inject\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     protected AbstractChainingPrintRenderer getSyntaxRenderer()\n     {\n-        return new XHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, getListenerChain());\n+        return new XHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, this.htmlElementSanitizer,\n+            getListenerChain());\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-macros/xwiki-rendering-macro-html/src/main/java/org/xwiki/rendering/internal/macro/html/renderers/annotatedhtml5/HTMLMacroAnnotatedHTML5Renderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -30,6 +30,7 @@\n import org.xwiki.rendering.internal.renderer.xhtml.image.XHTMLImageRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Renderer that generates Annotated HTML5 from a XDOM resulting from the parsing of text containing HTML mixed with\n@@ -59,9 +60,13 @@ public class HTMLMacroAnnotatedHTML5Renderer extends AbstractHTMLMacroRenderer\n     @Inject\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     protected AbstractChainingPrintRenderer getSyntaxRenderer()\n     {\n-        return new AnnotatedHTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, getListenerChain());\n+        return new AnnotatedHTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, this.htmlElementSanitizer,\n+            getListenerChain());\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-macros/xwiki-rendering-macro-html/src/main/java/org/xwiki/rendering/internal/macro/html/renderers/annotatedxhtml/HTMLMacroAnnotatedXHTMLRenderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -30,6 +30,7 @@\n import org.xwiki.rendering.internal.renderer.xhtml.image.XHTMLImageRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Renderer that generates Annotated XHTML from a XDOM resulting from the parsing of text containing HTML mixed with\n@@ -61,9 +62,13 @@ public class HTMLMacroAnnotatedXHTMLRenderer extends AbstractHTMLMacroRenderer\n     @Named(\"annotated\")\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     protected AbstractChainingPrintRenderer getSyntaxRenderer()\n     {\n-        return new AnnotatedXHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, getListenerChain());\n+        return new AnnotatedXHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, this.htmlElementSanitizer,\n+            getListenerChain());\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-macros/xwiki-rendering-macro-html/src/main/java/org/xwiki/rendering/internal/macro/html/renderers/html5/HTMLMacroHTML5Renderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -30,6 +30,7 @@\n import org.xwiki.rendering.internal.renderer.xhtml.image.XHTMLImageRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Renderer that generates HTML5 from a XDOM resulting from the parsing of text containing HTML mixed with\n@@ -59,9 +60,13 @@ public class HTMLMacroHTML5Renderer extends AbstractHTMLMacroRenderer\n     @Inject\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     protected AbstractChainingPrintRenderer getSyntaxRenderer()\n     {\n-        return new HTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, getListenerChain());\n+        return new HTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, this.htmlElementSanitizer,\n+            getListenerChain());\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-annotatedhtml5/src/main/java/org/xwiki/rendering/internal/renderer/html5/AnnotatedHTML5ChainingRenderer.java",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -28,6 +28,7 @@\n import org.xwiki.rendering.listener.MetaData;\n import org.xwiki.rendering.listener.chaining.BlockStateChainingListener;\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Convert listener events to annotated HTML5. See {@link AnnotatedHTML5Renderer} for more details on what Annotated\n@@ -55,12 +56,13 @@ public class AnnotatedHTML5ChainingRenderer extends HTML5ChainingRenderer\n      * @param imageRenderer the object to render image events into XHTML. This is done so that it's pluggable because\n      *            image rendering depends on how the underlying system wants to handle it. For example for XWiki we\n      *            check if the image exists as a document attachments, we get its URL, etc.\n+     * @param htmlElementSanitizer the HTML element sanitizer to use\n      * @param listenerChain the chain of listener filters used to compute various states\n      */\n     public AnnotatedHTML5ChainingRenderer(XHTMLLinkRenderer linkRenderer,\n-            XHTMLImageRenderer imageRenderer, ListenerChain listenerChain)\n+            XHTMLImageRenderer imageRenderer, HTMLElementSanitizer htmlElementSanitizer, ListenerChain listenerChain)\n     {\n-        super(linkRenderer, imageRenderer, listenerChain);\n+        super(linkRenderer, imageRenderer, htmlElementSanitizer, listenerChain);\n \n         this.macroRenderer = new XHTMLMacroRenderer();\n "
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-annotatedhtml5/src/main/java/org/xwiki/rendering/internal/renderer/html5/AnnotatedHTML5Renderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -34,6 +34,7 @@\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n import org.xwiki.rendering.listener.chaining.MetaDataStateChainingListener;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Generates Annotated HTML5 (ie HTML5 containing metadata information, for example macro definition or\n@@ -67,6 +68,9 @@ public class AnnotatedHTML5Renderer extends AbstractChainingPrintRenderer implem\n     @Named(\"annotated\")\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     public void initialize() throws InitializationException\n     {\n@@ -79,6 +83,7 @@ public void initialize() throws InitializationException\n         chain.addListener(new BlockStateChainingListener(chain));\n         chain.addListener(new EmptyBlockChainingListener(chain));\n         chain.addListener(new MetaDataStateChainingListener(chain));\n-        chain.addListener(new AnnotatedHTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, chain));\n+        chain.addListener(new AnnotatedHTML5ChainingRenderer(this.linkRenderer, this.imageRenderer,\n+            this.htmlElementSanitizer, chain));\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-annotatedhtml5/src/test/resources/annotatedhtml50/simple/monospace/monospace2.out.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-<p><span a=\"b\" class=\"monospace\">monospace</span></p>\n\\ No newline at end of file\n+<p><span data-xwiki-translated-attribute-a=\"b\" class=\"monospace\">monospace</span></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-annotatedxhtml/src/main/java/org/xwiki/rendering/internal/renderer/xhtml/AnnotatedXHTMLChainingRenderer.java",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -25,6 +25,7 @@\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n import org.xwiki.rendering.listener.MetaData;\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Convert listener events to annotated XHTML. See {@link AnnotatedXHTMLChainingRenderer} for more details on\n@@ -52,12 +53,13 @@ public class AnnotatedXHTMLChainingRenderer extends XHTMLChainingRenderer\n      * @param imageRenderer the object to render image events into XHTML. This is done so that it's pluggable because\n      *            image rendering depends on how the underlying system wants to handle it. For example for XWiki we\n      *            check if the image exists as a document attachments, we get its URL, etc.\n+     * @param htmlElementSanitizer the sanitizer to use for sanitizing HTML elements and attributes\n      * @param listenerChain the chain of listener filters used to compute various states\n      */\n     public AnnotatedXHTMLChainingRenderer(XHTMLLinkRenderer linkRenderer,\n-        XHTMLImageRenderer imageRenderer, ListenerChain listenerChain)\n+        XHTMLImageRenderer imageRenderer, HTMLElementSanitizer htmlElementSanitizer, ListenerChain listenerChain)\n     {\n-        super(linkRenderer, imageRenderer, listenerChain);\n+        super(linkRenderer, imageRenderer, htmlElementSanitizer, listenerChain);\n \n         this.macroRenderer = new XHTMLMacroRenderer();\n "
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-annotatedxhtml/src/main/java/org/xwiki/rendering/internal/renderer/xhtml/AnnotatedXHTMLRenderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -34,6 +34,7 @@\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n import org.xwiki.rendering.listener.chaining.MetaDataStateChainingListener;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Generates Annotated XHTML (ie XHTML containing metadata information, for example macro definition or\n@@ -67,6 +68,9 @@ public class AnnotatedXHTMLRenderer extends AbstractChainingPrintRenderer implem\n     @Named(\"annotated\")\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     public void initialize() throws InitializationException\n     {\n@@ -79,6 +83,7 @@ public void initialize() throws InitializationException\n         chain.addListener(new BlockStateChainingListener(chain));\n         chain.addListener(new EmptyBlockChainingListener(chain));\n         chain.addListener(new MetaDataStateChainingListener(chain));\n-        chain.addListener(new AnnotatedXHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, chain));\n+        chain.addListener(new AnnotatedXHTMLChainingRenderer(this.linkRenderer, this.imageRenderer,\n+            this.htmlElementSanitizer, chain));\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-html5/src/main/java/org/xwiki/rendering/internal/renderer/html5/HTML5ChainingRenderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -20,13 +20,15 @@\n package org.xwiki.rendering.internal.renderer.html5;\n \n import java.util.HashMap;\n+import java.util.LinkedHashMap;\n import java.util.Map;\n \n import org.xwiki.rendering.internal.renderer.xhtml.XHTMLChainingRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.image.XHTMLImageRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n import org.xwiki.rendering.listener.Format;\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Convert listener events to HTML5.\n@@ -53,22 +55,22 @@ public class HTML5ChainingRenderer extends XHTMLChainingRenderer\n      * @param imageRenderer the object to render image events into XHTML. This is done so that it's pluggable because\n      * image rendering depends on how the underlying system wants to handle it. For example for XWiki we check if the\n      * image exists as a document attachments, we get its URL, etc.\n+     * @param htmlElementSanitizer the sanitizer to use for sanitizing HTML elements and attributes\n      * @param listenerChain the chain of listener filters used to compute various states\n      */\n     public HTML5ChainingRenderer(XHTMLLinkRenderer linkRenderer,\n-            XHTMLImageRenderer imageRenderer,\n+            XHTMLImageRenderer imageRenderer, HTMLElementSanitizer htmlElementSanitizer,\n             ListenerChain listenerChain)\n     {\n-        super(linkRenderer, imageRenderer, listenerChain);\n+        super(linkRenderer, imageRenderer, htmlElementSanitizer, listenerChain);\n     }\n \n     @Override\n     public void beginFormat(Format format, Map<String, String> parameters)\n     {\n         // Right now, the only difference with the super class is about the \"monospace\" format\n         if (format == Format.MONOSPACE) {\n-            Map<String, String> attributes = new HashMap<>();\n-            attributes.putAll(parameters);\n+            Map<String, String> attributes = new LinkedHashMap<>(parameters);\n             String cssClass = \"monospace\";\n             // The element may already have a class\n             if (attributes.containsKey(PROP_CLASS)) {"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-html5/src/main/java/org/xwiki/rendering/internal/renderer/html5/HTML5Renderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -34,6 +34,7 @@\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n import org.xwiki.rendering.listener.chaining.MetaDataStateChainingListener;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Generates HTML5 from a {@link org.xwiki.rendering.block.XDOM} object being traversed.\n@@ -62,6 +63,9 @@ public class HTML5Renderer extends AbstractChainingPrintRenderer implements Init\n     @Inject\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     public void initialize() throws InitializationException\n     {\n@@ -74,7 +78,8 @@ public void initialize() throws InitializationException\n         chain.addListener(new BlockStateChainingListener(chain));\n         chain.addListener(new EmptyBlockChainingListener(chain));\n         chain.addListener(new MetaDataStateChainingListener(chain));\n-        chain.addListener(new HTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, chain));\n+        chain.addListener(new HTML5ChainingRenderer(this.linkRenderer, this.imageRenderer, this.htmlElementSanitizer,\n+            chain));\n     }\n }\n "
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-html5/src/test/java/org/xwiki/rendering/internal/html5/HTML5ChainingRendererTest.java",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -24,9 +24,9 @@\n \n import org.junit.Before;\n import org.junit.Test;\n+import org.xwiki.rendering.internal.renderer.html5.HTML5ChainingRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.image.XHTMLImageRenderer;\n import org.xwiki.rendering.internal.renderer.xhtml.link.XHTMLLinkRenderer;\n-import org.xwiki.rendering.internal.renderer.html5.HTML5ChainingRenderer;\n import org.xwiki.rendering.listener.Format;\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n import org.xwiki.rendering.renderer.printer.DefaultWikiPrinter;\n@@ -58,7 +58,7 @@ public void setUp() throws Exception\n         linkRenderer = mock(XHTMLLinkRenderer.class);\n         imageRenderer = mock(XHTMLImageRenderer.class);\n         listenerChain = new ListenerChain();\n-        chainingRenderer = new HTML5ChainingRenderer(linkRenderer, imageRenderer, listenerChain);\n+        chainingRenderer = new HTML5ChainingRenderer(linkRenderer, imageRenderer, null, listenerChain);\n         printer = new DefaultWikiPrinter();\n         chainingRenderer.setPrinter(printer);\n     }"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/main/java/org/xwiki/rendering/internal/parser/xhtml/wikimodel/XHTMLXWikiGeneratorListener.java",
          "status": "modified",
          "additions": 47,
          "deletions": 1,
          "patch": "@@ -19,10 +19,12 @@\n  */\n package org.xwiki.rendering.internal.parser.xhtml.wikimodel;\n \n+import java.util.LinkedHashMap;\n import java.util.Map;\n import java.util.regex.Matcher;\n import java.util.regex.Pattern;\n \n+import org.apache.commons.lang3.tuple.ImmutablePair;\n import org.apache.commons.lang3.tuple.Pair;\n import org.xwiki.rendering.internal.parser.wikimodel.DefaultXWikiGeneratorListener;\n import org.xwiki.rendering.listener.Listener;\n@@ -32,6 +34,7 @@\n import org.xwiki.rendering.parser.ResourceReferenceParser;\n import org.xwiki.rendering.parser.StreamParser;\n import org.xwiki.rendering.renderer.PrintRendererFactory;\n+import org.xwiki.rendering.renderer.printer.XHTMLWikiPrinter;\n import org.xwiki.rendering.syntax.Syntax;\n import org.xwiki.rendering.util.IdGenerator;\n import org.xwiki.rendering.wikimodel.WikiFormat;\n@@ -204,7 +207,7 @@ private static WikiParameters cleanParametersFromMetadata(WikiParameters paramet\n         for (WikiParameter parameter : parameters) {\n             boolean acceptParameter = !(parameter.getKey().startsWith(METADATA_ATTRIBUTE_PREFIX)\n                 || (\n-                    parameter.getKey().equals(CLASS_ATTRIBUTE) && parameter.getValue().equals(METADATA_CONTAINER_CLASS)\n+                parameter.getKey().equals(CLASS_ATTRIBUTE) && parameter.getValue().equals(METADATA_CONTAINER_CLASS)\n             ));\n             if (acceptParameter) {\n                 wikiParameters = wikiParameters.addParameter(parameter.getKey(), parameter.getValue());\n@@ -288,4 +291,47 @@ public void endFormat(WikiFormat format)\n             super.endFormat(format);\n         }\n     }\n+\n+    @Override\n+    protected Map<String, String> convertParameters(WikiParameters params)\n+    {\n+        return maybeRemoveAttributePrefix(super.convertParameters(params));\n+    }\n+\n+    @Override\n+    protected Pair<Map<String, String>, Map<String, String>> convertAndSeparateParameters(WikiParameters params)\n+    {\n+        Pair<Map<String, String>, Map<String, String>> result = super.convertAndSeparateParameters(params);\n+        Map<String, String> genericParameters = result.getRight();\n+\n+        if (!genericParameters.isEmpty()) {\n+            genericParameters = maybeRemoveAttributePrefix(genericParameters);\n+        }\n+\n+        return new ImmutablePair<>(result.getLeft(), genericParameters);\n+    }\n+\n+    private Map<String, String> maybeRemoveAttributePrefix(Map<String, String> attributes)\n+    {\n+        Map<String, String> result;\n+\n+        if (!attributes.isEmpty()) {\n+            result = new LinkedHashMap<>();\n+\n+            for (Map.Entry<String, String> entry : attributes.entrySet()) {\n+                String newKey;\n+                if (entry.getKey().startsWith(XHTMLWikiPrinter.TRANSLATED_ATTRIBUTE_PREFIX)) {\n+                    newKey = entry.getKey().substring(XHTMLWikiPrinter.TRANSLATED_ATTRIBUTE_PREFIX.length());\n+                } else {\n+                    newKey = entry.getKey();\n+                }\n+\n+                result.put(newKey, entry.getValue());\n+            }\n+        } else {\n+            result = attributes;\n+        }\n+\n+        return result;\n+    }\n }"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/main/java/org/xwiki/rendering/internal/renderer/xhtml/XHTMLChainingRenderer.java",
          "status": "modified",
          "additions": 18,
          "deletions": 8,
          "patch": "@@ -41,6 +41,7 @@\n import org.xwiki.rendering.syntax.Syntax;\n import org.xwiki.rendering.syntax.SyntaxType;\n import org.xwiki.xml.html.HTMLConstants;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Convert listener events to XHTML.\n@@ -65,24 +66,28 @@ public class XHTMLChainingRenderer extends AbstractChainingPrintRenderer\n \n     private XHTMLImageRenderer imageRenderer;\n \n+    private final HTMLElementSanitizer htmlElementSanitizer;\n+\n     private XHTMLWikiPrinter xhtmlWikiPrinter;\n \n     /**\n-     * @param linkRenderer the object to render link events into XHTML. This is done so that it's pluggable because link\n-     *            rendering depends on how the underlying system wants to handle it. For example for XWiki we check if\n-     *            the document exists, we get the document URL, etc.\n-     * @param imageRenderer the object to render image events into XHTML. This is done so that it's pluggable because\n-     *            image rendering depends on how the underlying system wants to handle it. For example for XWiki we\n-     *            check if the image exists as a document attachments, we get its URL, etc.\n+     * @param linkRenderer the object to render link events into XHTML. This is done so that it's pluggable because\n+     *     link rendering depends on how the underlying system wants to handle it. For example for XWiki we check if the\n+     *     document exists, we get the document URL, etc.\n+     * @param imageRenderer the object to render image events into XHTML. This is done so that it's pluggable\n+     *     because image rendering depends on how the underlying system wants to handle it. For example for XWiki we\n+     *     check if the image exists as a document attachments, we get its URL, etc.\n+     * @param htmlElementSanitizer the sanitizer for XHTML elements\n      * @param listenerChain the chain of listener filters used to compute various states\n      */\n     public XHTMLChainingRenderer(XHTMLLinkRenderer linkRenderer, XHTMLImageRenderer imageRenderer,\n-        ListenerChain listenerChain)\n+        HTMLElementSanitizer htmlElementSanitizer, ListenerChain listenerChain)\n     {\n         setListenerChain(listenerChain);\n \n         this.linkRenderer = linkRenderer;\n         this.imageRenderer = imageRenderer;\n+        this.htmlElementSanitizer = htmlElementSanitizer;\n     }\n \n     // State\n@@ -121,11 +126,16 @@ protected void popPrinter()\n     protected XHTMLWikiPrinter getXHTMLWikiPrinter()\n     {\n         if (this.xhtmlWikiPrinter == null) {\n-            this.xhtmlWikiPrinter = new XHTMLWikiPrinter(getPrinter());\n+            this.xhtmlWikiPrinter = new XHTMLWikiPrinter(getPrinter(), getHtmlElementSanitizer());\n         }\n         return this.xhtmlWikiPrinter;\n     }\n \n+    protected HTMLElementSanitizer getHtmlElementSanitizer()\n+    {\n+        return this.htmlElementSanitizer;\n+    }\n+\n     // Events\n \n     @Override"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/main/java/org/xwiki/rendering/internal/renderer/xhtml/XHTMLRenderer.java",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -34,6 +34,7 @@\n import org.xwiki.rendering.listener.chaining.ListenerChain;\n import org.xwiki.rendering.listener.chaining.MetaDataStateChainingListener;\n import org.xwiki.rendering.renderer.AbstractChainingPrintRenderer;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Generates XHTML from a {@link org.xwiki.rendering.block.XDOM} object being traversed.\n@@ -62,6 +63,9 @@ public class XHTMLRenderer extends AbstractChainingPrintRenderer implements Init\n     @Inject\n     private XHTMLImageRenderer imageRenderer;\n \n+    @Inject\n+    private HTMLElementSanitizer htmlElementSanitizer;\n+\n     @Override\n     public void initialize() throws InitializationException\n     {\n@@ -74,6 +78,7 @@ public void initialize() throws InitializationException\n         chain.addListener(new BlockStateChainingListener(chain));\n         chain.addListener(new EmptyBlockChainingListener(chain));\n         chain.addListener(new MetaDataStateChainingListener(chain));\n-        chain.addListener(new XHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, chain));\n+        chain.addListener(new XHTMLChainingRenderer(this.linkRenderer, this.imageRenderer, this.htmlElementSanitizer,\n+            chain));\n     }\n }"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/test/java/org/xwiki/rendering/internal/renderer/xhtml/XHTMLChainingRendererTest.java",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -44,7 +44,7 @@ class XHTMLChainingRendererTest\n     @Test\n     void outputFigureCaptionEvents()\n     {\n-        XHTMLChainingRenderer renderer = new XHTMLChainingRenderer(null, null, new ListenerChain());\n+        XHTMLChainingRenderer renderer = new XHTMLChainingRenderer(null, null, null, new ListenerChain());\n         WikiPrinter wikiPrinter = new DefaultWikiPrinter();\n         renderer.setPrinter(wikiPrinter);\n         renderer.beginFigureCaption(Collections.emptyMap());\n@@ -57,7 +57,7 @@ void outputFigureCaptionEvents()\n     @Test\n     void onRawText()\n     {\n-        XHTMLChainingRenderer renderer = new XHTMLChainingRenderer(null, null, new ListenerChain());\n+        XHTMLChainingRenderer renderer = new XHTMLChainingRenderer(null, null, null, new ListenerChain());\n         WikiPrinter wikiPrinter = new DefaultWikiPrinter();\n         renderer.setPrinter(wikiPrinter);\n         renderer.onRawText(\"xhtml/1.0\", Syntax.XHTML_1_0);"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/test/resources/xhtml10/simple/monospace/monospace2.inout.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-<p><tt><span a=\"b\">monospace</span></tt></p>\n\\ No newline at end of file\n+<p><tt><span data-xwiki-translated-attribute-a=\"b\">monospace</span></tt></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/test/resources/xhtml10/specific/bold/bold4.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n .input|xhtml/1.0\n .# Verify that STRONG tag parameters are recognized.\n .#-----------------------------------------------------\n-<p><strong a=\"b\" data-xwiki-parameter=\"value\">something</strong></p>\n+<p><strong data-xwiki-translated-attribute-a=\"b\" data-xwiki-parameter=\"value\">something</strong></p>\n .#-----------------------------------------------------\n .expect|event/1.0\n .#-----------------------------------------------------\n@@ -16,4 +16,4 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p><strong><span a=\"b\" data-xwiki-parameter=\"value\">something</span></strong></p>\n\\ No newline at end of file\n+<p><strong><span data-xwiki-translated-attribute-a=\"b\" data-xwiki-parameter=\"value\">something</span></strong></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/test/resources/xhtml10/specific/encoding/encoding1.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -3,7 +3,7 @@\n .# Verify that HTML entities can be parsed by the XHTML parser and are encoded properly\n .# Note that &nbsp; is transformed into a space.\n .#-------------------------------------------------------------------------------------\n-<p>&nbsp;&tilde;&euro;</p><p param1=\"val&#252;e\">&#160;&#732;&#8364;</p>\n+<p>&nbsp;&tilde;&euro;</p><p data-xwiki-translated-attribute-param1=\"val&#252;e\">&#160;&#732;&#8364;</p>\n .#-----------------------------------------------------\n .expect|event/1.0\n .#-----------------------------------------------------\n@@ -20,4 +20,4 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<p>&nbsp;\u02dc\u20ac</p><p param1=\"val\u00fce\">&nbsp;\u02dc\u20ac</p>\n\\ No newline at end of file\n+<p>&nbsp;\u02dc\u20ac</p><p data-xwiki-translated-attribute-param1=\"val\u00fce\">&nbsp;\u02dc\u20ac</p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml/src/test/resources/xhtml10/specific/group/group1.test",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n .input|xhtml/1.0\n .# Verify that div tag parameters, also starting with data-xwiki-, are recognized.\n .#-----------------------------------------------------\n-<div a=\"b\" data-xwiki-parameter=\"value\">something</div>\n+<div data-xwiki-translated-attribute-a=\"b\" data-xwiki-parameter=\"value\">something</div>\n .#-----------------------------------------------------\n .expect|event/1.0\n .#-----------------------------------------------------\n@@ -16,4 +16,4 @@ endDocument\n .#-----------------------------------------------------\n .expect|xhtml/1.0\n .#-----------------------------------------------------\n-<div a=\"b\" data-xwiki-parameter=\"value\"><p>something</p></div>\n\\ No newline at end of file\n+<div data-xwiki-translated-attribute-a=\"b\" data-xwiki-parameter=\"value\"><p>something</p></div>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-syntaxes/xwiki-rendering-syntax-xhtml5/src/test/resources/xhtml5/simple/monospace/monospace2.inout.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-<p><span a=\"b\" class=\"monospace\">monospace</span></p>\n\\ No newline at end of file\n+<p><span data-xwiki-translated-attribute-a=\"b\" class=\"monospace\">monospace</span></p>\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-rendering-xml/src/main/java/org/xwiki/rendering/renderer/printer/XHTMLWikiPrinter.java",
          "status": "modified",
          "additions": 132,
          "deletions": 21,
          "patch": "@@ -19,10 +19,15 @@\n  */\n package org.xwiki.rendering.renderer.printer;\n \n+import java.util.Arrays;\n+import java.util.LinkedHashMap;\n import java.util.Map;\n \n import org.apache.commons.lang3.StringUtils;\n import org.xml.sax.Attributes;\n+import org.xml.sax.helpers.AttributesImpl;\n+import org.xwiki.stability.Unstable;\n+import org.xwiki.xml.html.HTMLElementSanitizer;\n \n /**\n  * Base toolkit class for all XHTML-based renderers. This printer handles whitespaces so that it prints \"&nbsp;\" when\n@@ -34,6 +39,21 @@\n  */\n public class XHTMLWikiPrinter extends XMLWikiPrinter\n {\n+    /**\n+     * Prefix that is used for invalid/disallowed attributes.\n+     *\n+     * @since 14.6RC1\n+     */\n+    @Unstable\n+    public static final String TRANSLATED_ATTRIBUTE_PREFIX = \"data-xwiki-translated-attribute-\";\n+\n+    /**\n+     * The sanitizer used to restrict allowed elements and attributes, can be null (no restrictions).\n+     *\n+     * @since 14.6RC1\n+     */\n+    protected final HTMLElementSanitizer htmlElementSanitizer;\n+\n     private int spaceCount;\n \n     private boolean isInCData;\n@@ -50,15 +70,25 @@ public class XHTMLWikiPrinter extends XMLWikiPrinter\n      * @param printer the object to which to write the XHTML output to\n      */\n     public XHTMLWikiPrinter(WikiPrinter printer)\n+    {\n+        this(printer, null);\n+    }\n+\n+    /**\n+     * @param printer the object to which to write the XHTML output to\n+     * @param htmlElementSanitizer the sanitizer to use for sanitizing elements and attributes\n+     */\n+    public XHTMLWikiPrinter(WikiPrinter printer, HTMLElementSanitizer htmlElementSanitizer)\n     {\n         super(printer);\n+        this.htmlElementSanitizer = htmlElementSanitizer;\n     }\n \n     /**\n-     * Use it to specify that the current element to print is standalone.\n-     * This value might be used to know if the first space should be printed with a simple space or a {@code &nbsp;}\n-     * entity. Note that the standalone value is automatically reset after first printing of a space, or when a text\n-     * is printed.\n+     * Use it to specify that the current element to print is standalone. This value might be used to know if the first\n+     * space should be printed with a simple space or a {@code &nbsp;} entity. Note that the standalone value is\n+     * automatically reset after first printing of a space, or when a text is printed.\n+     *\n      * @since 12.2\n      */\n     public void setStandalone()\n@@ -78,58 +108,74 @@ public void printXML(String str)\n     @Override\n     public void printXMLElement(String name)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLElement(name);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLElement(name);\n+        }\n     }\n \n     @Override\n     public void printXMLElement(String name, String[][] attributes)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLElement(name, attributes);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLElement(name, cleanAttributes(name, attributes));\n+        }\n     }\n \n     @Override\n     public void printXMLElement(String name, Map<String, String> attributes)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLElement(name, attributes);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLElement(name, cleanAttributes(name, attributes));\n+        }\n     }\n \n     @Override\n     public void printXMLStartElement(String name)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLStartElement(name);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLStartElement(name);\n+        }\n     }\n \n     @Override\n     public void printXMLStartElement(String name, String[][] attributes)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLStartElement(name, attributes);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLStartElement(name, cleanAttributes(name, attributes));\n+        }\n     }\n \n     @Override\n     public void printXMLStartElement(String name, Map<String, String> attributes)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLStartElement(name, attributes);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLStartElement(name, cleanAttributes(name, attributes));\n+        }\n     }\n \n     @Override\n     public void printXMLStartElement(String name, Attributes attributes)\n     {\n-        handleSpaceWhenStartElement();\n-        super.printXMLStartElement(name, attributes);\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenStartElement();\n+            super.printXMLStartElement(name, cleanAttributes(name, attributes));\n+        }\n     }\n \n     @Override\n     public void printXMLEndElement(String name)\n     {\n-        handleSpaceWhenEndlement();\n-        super.printXMLEndElement(name);\n-        this.elementEnded = true;\n+        if (this.htmlElementSanitizer == null || this.htmlElementSanitizer.isElementAllowed(name)) {\n+            handleSpaceWhenEndlement();\n+            super.printXMLEndElement(name);\n+            this.elementEnded = true;\n+        }\n     }\n \n     @Override\n@@ -185,6 +231,71 @@ private void handleSpaceWhenInText()\n         }\n     }\n \n+    private Map<String, String> cleanAttributes(String elementName, Map<String, String> attributes)\n+    {\n+        Map<String, String> cleanAttributes;\n+\n+        if (this.htmlElementSanitizer == null || attributes == null) {\n+            cleanAttributes = attributes;\n+        } else {\n+            cleanAttributes = new LinkedHashMap<>();\n+            for (Map.Entry<String, String> e : attributes.entrySet()) {\n+                if (this.htmlElementSanitizer.isAttributeAllowed(elementName, e.getKey(), e.getValue())) {\n+                    cleanAttributes.put(e.getKey(), e.getValue());\n+                } else {\n+                    cleanAttributes.put(TRANSLATED_ATTRIBUTE_PREFIX + e.getKey(), e.getValue());\n+                }\n+            }\n+        }\n+\n+        return cleanAttributes;\n+    }\n+\n+    private String[][] cleanAttributes(String elementName, String[][] attributes)\n+    {\n+        String[][] allowedAttributes;\n+        if (this.htmlElementSanitizer == null || attributes == null) {\n+            allowedAttributes = attributes;\n+        } else {\n+            allowedAttributes = Arrays.stream(attributes)\n+                .map(entry -> {\n+                    if (this.htmlElementSanitizer.isAttributeAllowed(elementName, entry[0], entry[1])) {\n+                        return entry;\n+                    } else {\n+                        return new String[] { TRANSLATED_ATTRIBUTE_PREFIX + entry[0], entry[1] };\n+                    }\n+                })\n+                .toArray(String[][]::new);\n+        }\n+\n+        return allowedAttributes;\n+    }\n+\n+    private Attributes cleanAttributes(String elementName, Attributes attributes)\n+    {\n+        Attributes allowedAttribute;\n+\n+        if (this.htmlElementSanitizer == null || attributes == null) {\n+            allowedAttribute = attributes;\n+        } else {\n+            allowedAttribute = new AttributesImpl();\n+\n+            for (int i = 0; i < attributes.getLength(); ++i) {\n+                if (this.htmlElementSanitizer.isAttributeAllowed(elementName, attributes.getQName(i),\n+                    attributes.getValue(i)))\n+                {\n+                    ((AttributesImpl) allowedAttribute).addAttribute(null, null, attributes.getQName(i),\n+                        null, attributes.getValue(i));\n+                } else {\n+                    ((AttributesImpl) allowedAttribute).addAttribute(null, null,\n+                        TRANSLATED_ATTRIBUTE_PREFIX + attributes.getQName(i), null, attributes.getValue(i));\n+                }\n+            }\n+        }\n+\n+        return allowedAttribute;\n+    }\n+\n     private void handleSpaceWhenStartElement()\n     {\n         // Use case: <tag1>something <tag2>..."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 34,
        "unique_directories": 34,
        "max_directory_depth": 13
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "92d286fe9c6aefd715d03921c2988433504118cd",
            "date": "2025-01-10T12:59:46Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "891a0a0c7b3af8eb17ef5331ab3431f7c7ca7a5e",
            "date": "2025-01-09T14:50:47Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "40c52310238ed3385e15abdffde6a8fe7789e338",
            "date": "2024-12-13T09:53:28Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "1becaee2355b2947804fbf7c36e977a0c99f5b64",
            "date": "2024-12-13T08:10:46Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "7acc35338dc3f6739080ffe56a25c1a282f081e9",
            "date": "2024-12-12T17:34:45Z",
            "author_login": "renovate-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-83",
    "description": "XWiki Platform is a generic wiki platform. Prior to version 14.6-rc-1, HTML rendering didn't check for dangerous attributes/attribute values. This allowed cross-site scripting (XSS) attacks via attributes and link URLs, e.g., supported in XWiki syntax. This has been patched in XWiki 14.6-rc-1. There are no known workarounds apart from upgrading to a fixed version.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-10T18:15:10.003",
    "last_modified": "2024-11-21T08:02:39.167",
    "fix_date": "2022-04-29T08:33:38Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-rendering/commit/c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-rendering/security/advisories/GHSA-6gf5-c898-7rxp",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XRENDERING-663",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-rendering/commit/c40e2f5f9482ec6c3e71dbf1fff5ba8a5e44cdc1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-rendering/security/advisories/GHSA-6gf5-c898-7rxp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XRENDERING-663",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:32.952501",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-rendering",
    "owner": "xwiki",
    "created_at": "2011-02-24T10:25:20Z",
    "updated_at": "2025-01-10T12:59:50Z",
    "pushed_at": "2025-01-10T13:00:48Z",
    "size": 15023,
    "stars": 72,
    "forks": 80,
    "open_issues": 7,
    "watchers": 72,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "stable-14.10.x",
      "stable-15.10.x",
      "stable-16.4.x",
      "stable-16.10.x"
    ],
    "languages": {
      "Java": 3229064,
      "AspectJ": 12229,
      "Groovy": 1367
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T17:53:36.375300"
  }
}