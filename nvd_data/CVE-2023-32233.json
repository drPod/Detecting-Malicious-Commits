{
  "cve_id": "CVE-2023-32233",
  "github_data": {
    "repository": "torvalds/linux",
    "fix_commit": "c1592a89942e9678f7d9c8030efa777c0d57edab",
    "related_commits": [
      "c1592a89942e9678f7d9c8030efa777c0d57edab",
      "c1592a89942e9678f7d9c8030efa777c0d57edab"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c1592a89942e9678f7d9c8030efa777c0d57edab",
      "commit_date": "2023-05-02T08:25:24Z",
      "author": {
        "login": "ummakynes",
        "type": "User",
        "stats": {
          "total_commits": 1479,
          "average_weekly_commits": 1.2418136020151134,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 483
        }
      },
      "commit_message": {
        "title": "netfilter: nf_tables: deactivate anonymous set from preparation phase",
        "length": 1336,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 16,
        "deletions": 3
      },
      "files": [
        {
          "filename": "include/net/netfilter/nf_tables.h",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -619,6 +619,7 @@ struct nft_set_binding {\n };\n \n enum nft_trans_phase;\n+void nf_tables_activate_set(const struct nft_ctx *ctx, struct nft_set *set);\n void nf_tables_deactivate_set(const struct nft_ctx *ctx, struct nft_set *set,\n \t\t\t      struct nft_set_binding *binding,\n \t\t\t      enum nft_trans_phase phase);"
        },
        {
          "filename": "net/netfilter/nf_tables_api.c",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -5127,12 +5127,24 @@ static void nf_tables_unbind_set(const struct nft_ctx *ctx, struct nft_set *set,\n \t}\n }\n \n+void nf_tables_activate_set(const struct nft_ctx *ctx, struct nft_set *set)\n+{\n+\tif (nft_set_is_anonymous(set))\n+\t\tnft_clear(ctx->net, set);\n+\n+\tset->use++;\n+}\n+EXPORT_SYMBOL_GPL(nf_tables_activate_set);\n+\n void nf_tables_deactivate_set(const struct nft_ctx *ctx, struct nft_set *set,\n \t\t\t      struct nft_set_binding *binding,\n \t\t\t      enum nft_trans_phase phase)\n {\n \tswitch (phase) {\n \tcase NFT_TRANS_PREPARE:\n+\t\tif (nft_set_is_anonymous(set))\n+\t\t\tnft_deactivate_next(ctx->net, set);\n+\n \t\tset->use--;\n \t\treturn;\n \tcase NFT_TRANS_ABORT:"
        },
        {
          "filename": "net/netfilter/nft_dynset.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -342,7 +342,7 @@ static void nft_dynset_activate(const struct nft_ctx *ctx,\n {\n \tstruct nft_dynset *priv = nft_expr_priv(expr);\n \n-\tpriv->set->use++;\n+\tnf_tables_activate_set(ctx, priv->set);\n }\n \n static void nft_dynset_destroy(const struct nft_ctx *ctx,"
        },
        {
          "filename": "net/netfilter/nft_lookup.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -167,7 +167,7 @@ static void nft_lookup_activate(const struct nft_ctx *ctx,\n {\n \tstruct nft_lookup *priv = nft_expr_priv(expr);\n \n-\tpriv->set->use++;\n+\tnf_tables_activate_set(ctx, priv->set);\n }\n \n static void nft_lookup_destroy(const struct nft_ctx *ctx,"
        },
        {
          "filename": "net/netfilter/nft_objref.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -185,7 +185,7 @@ static void nft_objref_map_activate(const struct nft_ctx *ctx,\n {\n \tstruct nft_objref_map *priv = nft_expr_priv(expr);\n \n-\tpriv->set->use++;\n+\tnf_tables_activate_set(ctx, priv->set);\n }\n \n static void nft_objref_map_destroy(const struct nft_ctx *ctx,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa22f4da2a46b484a257d167c67a2adc1b7aaf68",
            "date": "2025-01-26T00:23:38Z",
            "author_login": "torvalds"
          },
          {
            "sha": "eda061cccd146fcbe71051bb4aa5a8672b71216e",
            "date": "2025-01-26T00:19:10Z",
            "author_login": "torvalds"
          },
          {
            "sha": "08de7f9d4d39fd9aa5e747a13acc891214fa2d5f",
            "date": "2025-01-26T00:12:07Z",
            "author_login": "torvalds"
          },
          {
            "sha": "647d69605c70368d54fc012fce8a43e8e5955b04",
            "date": "2025-01-26T00:03:40Z",
            "author_login": "torvalds"
          },
          {
            "sha": "184a0997fb77f4a9527fc867fcd16806776c27ce",
            "date": "2025-01-25T23:59:46Z",
            "author_login": "torvalds"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-416",
    "description": "In the Linux kernel through 6.3.1, a use-after-free in Netfilter nf_tables when processing batch requests can be abused to perform arbitrary read and write operations on kernel memory. Unprivileged local users can obtain root privileges. This occurs because anonymous sets are mishandled.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-08T20:15:20.267",
    "last_modified": "2024-11-21T08:02:57.280",
    "fix_date": "2023-05-02T08:25:24Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/173087/Kernel-Live-Patch-Security-Notice-LSN-0095-1.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/05/15/5",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2196105",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=c1592a89942e9678f7d9c8030efa777c0d57edab",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/c1592a89942e9678f7d9c8030efa777c0d57edab",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/06/msg00008.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/07/msg00030.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://news.ycombinator.com/item?id=35879660",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230616-0002/",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5402",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2023/05/08/4",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/173087/Kernel-Live-Patch-Security-Notice-LSN-0095-1.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/05/15/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2196105",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=c1592a89942e9678f7d9c8030efa777c0d57edab",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/torvalds/linux/commit/c1592a89942e9678f7d9c8030efa777c0d57edab",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/06/msg00008.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/07/msg00030.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://news.ycombinator.com/item?id=35879660",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230616-0002/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5402",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.openwall.com/lists/oss-security/2023/05/08/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:32.938743",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "linux",
    "owner": "torvalds",
    "created_at": "2011-09-04T22:48:12Z",
    "updated_at": "2025-01-14T12:39:03Z",
    "pushed_at": "2025-01-13T17:27:04Z",
    "size": 5361369,
    "stars": 185823,
    "forks": 54743,
    "open_issues": 437,
    "watchers": 185823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 1326937103,
      "Assembly": 9568292,
      "Shell": 5072004,
      "Python": 2974128,
      "Makefile": 2713905,
      "Perl": 1253637,
      "Rust": 807711,
      "Roff": 202277,
      "C++": 173382,
      "SmPL": 165946,
      "Yacc": 127472,
      "Lex": 71321,
      "Awk": 69539,
      "Jinja": 30138,
      "UnrealScript": 16848,
      "Gherkin": 10172,
      "M4": 3329,
      "MATLAB": 2482,
      "sed": 2433,
      "Clojure": 2411,
      "XS": 1239,
      "RPC": 962
    },
    "commit_activity": {
      "total_commits_last_year": 46007,
      "avg_commits_per_week": 884.75,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:59.486675"
  }
}