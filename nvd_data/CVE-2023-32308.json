{
  "cve_id": "CVE-2023-32308",
  "github_data": {
    "repository": "anuko/timetracker",
    "fix_commit": "8a7367d7f77ea697c090f5ca4e19669181cc7bcf",
    "related_commits": [
      "8a7367d7f77ea697c090f5ca4e19669181cc7bcf",
      "8a7367d7f77ea697c090f5ca4e19669181cc7bcf"
    ],
    "patch_url": "https://github.com/anuko/timetracker/commit/8a7367d7f77ea697c090f5ca4e19669181cc7bcf.patch",
    "fix_commit_details": {
      "sha": "8a7367d7f77ea697c090f5ca4e19669181cc7bcf",
      "commit_date": "2023-05-05T14:43:41Z",
      "author": {
        "login": "anuko",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Addressed an sql vulnerability in invoices.php for bogus post parameters for sorting.",
        "length": 85,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "initialize.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -21,7 +21,7 @@\n     die(\"mysqli_report function is not available.\"); // No point to continue as mysqli will not work.\n }\n \n-define(\"APP_VERSION\", \"1.22.11.5780\");\n+define(\"APP_VERSION\", \"1.22.11.5781\");\n define(\"APP_DIR\", dirname(__FILE__));\n define(\"LIBRARY_DIR\", APP_DIR.\"/WEB-INF/lib\");\n define(\"TEMPLATE_DIR\", APP_DIR.\"/WEB-INF/templates\");"
        },
        {
          "filename": "invoices.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -76,7 +76,7 @@\n   if (!ttInvoiceHelper::validSortOrder($sort_order_2)) $err->add($i18n->get('error.field'),  $i18n->get('label.sort'));\n   if ($sort_option_1 == $sort_option_2) $err->add($i18n->get('error.field'),  $i18n->get('label.sort'));\n \n-  if($request->getParameter('sorting_changed')) {\n+  if($err->no() && $request->getParameter('sorting_changed')) {\n     // User changed sorting. Get invoices sorted accordingly.\n     $sort_options = array('sort_option_1'=>$sort_option_1,\n       'sort_order_1'=>$sort_order_1,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b6711df7ae7c0c0034d6673365d26a0933faac5c",
            "date": "2023-12-28T18:07:21Z",
            "author_login": "anuko"
          },
          {
            "sha": "f92e6ce6d58669ea735767b55e18bcaa7a7935b8",
            "date": "2023-12-27T23:41:06Z",
            "author_login": "ram-fabian-heinrich"
          },
          {
            "sha": "2deafba72d62471a2b1e29f2d625a3dbb4702200",
            "date": "2023-11-11T16:42:19Z",
            "author_login": "anuko"
          },
          {
            "sha": "d123e4534038691c66c342008d464efbe8824a5d",
            "date": "2023-07-08T16:48:07Z",
            "author_login": "anuko"
          },
          {
            "sha": "3c21de2155eec74d2a16c4ccae867df6963388fc",
            "date": "2023-07-06T18:46:39Z",
            "author_login": "anuko"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:L",
    "cwe_id": "CWE-89",
    "description": "anuko timetracker is an open source time tracking system. Boolean-based blind SQL injection vulnerability existed in Time Tracker invoices.php in versions prior to 1.22.11.5781. This was happening because of a coding error after validating parameters in POST requests. There was no check for errors before adjusting invoice sorting order. Because of this, it was possible to craft a POST request with malicious SQL for Time Tracker database. This issue has been fixed in version 1.22.11.5781. Users are advised to upgrade. Users unable to upgrade may insert an additional check for errors in a condition before calling `ttGroupHelper::getActiveInvoices()` in invoices.php.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-15T21:15:09.530",
    "last_modified": "2024-11-21T08:03:04.847",
    "fix_date": "2023-05-05T14:43:41Z"
  },
  "references": [
    {
      "url": "https://github.com/anuko/timetracker/commit/8a7367d7f77ea697c090f5ca4e19669181cc7bcf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-9g2c-7c7g-p58r",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/commit/8a7367d7f77ea697c090f5ca4e19669181cc7bcf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/anuko/timetracker/security/advisories/GHSA-9g2c-7c7g-p58r",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:32.972545",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "timetracker",
    "owner": "anuko",
    "created_at": "2016-02-28T19:01:14Z",
    "updated_at": "2024-12-10T00:27:13Z",
    "pushed_at": "2023-12-28T18:07:38Z",
    "size": 11493,
    "stars": 191,
    "forks": 124,
    "open_issues": 27,
    "watchers": 191,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 5951736,
      "Smarty": 314330,
      "JavaScript": 30090,
      "CSS": 16132,
      "Batchfile": 13672,
      "Shell": 2274
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:32:50.847474"
  }
}