{
  "cve_id": "CVE-2023-32685",
  "github_data": {
    "repository": "kanboard/kanboard",
    "fix_commit": "26b6eebb78d4306e48b836a58f7c386251aa2bc7",
    "related_commits": [
      "26b6eebb78d4306e48b836a58f7c386251aa2bc7",
      "c9c187206700030c43493b80fd599b4d096cb713",
      "26b6eebb78d4306e48b836a58f7c386251aa2bc7",
      "c9c187206700030c43493b80fd599b4d096cb713"
    ],
    "patch_url": "https://github.com/kanboard/kanboard/commit/26b6eebb78d4306e48b836a58f7c386251aa2bc7.patch",
    "fix_commit_details": {
      "sha": "26b6eebb78d4306e48b836a58f7c386251aa2bc7",
      "commit_date": "2023-05-17T02:51:41Z",
      "author": {
        "login": "fguillot",
        "type": "User",
        "stats": {
          "total_commits": 2700,
          "average_weekly_commits": 4.70383275261324,
          "total_additions": 870938,
          "total_deletions": 651416,
          "weeks_active": 306
        }
      },
      "commit_message": {
        "title": "Avoid potential clipboard based cross-site scripting",
        "length": 52,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "assets/js/app.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -165,7 +165,7 @@ container.add(KB.dom('select').attr('aria-label',getAriaLabelValue()).change(onC\n return container.build()}\n this.render=function(){componentElement=buildComponentElement();containerElement.appendChild(componentElement)}});KB.component('screenshot',function(containerElement){var pasteCatcher=null;var inputElement=null;function onFileLoaded(e){createImage(e.target.result)}\n function onPaste(e){if(e.clipboardData&&e.clipboardData.items){var items=e.clipboardData.items;if(items){for(var i=0;i<items.length;i++){if(items[i].type.indexOf(\"image\")!==-1){var blob=items[i].getAsFile();var reader=new FileReader();reader.onload=onFileLoaded;reader.readAsDataURL(blob)}}}}else{setTimeout(checkInput,100)}}\n-function initialize(){destroy();if(!window.Clipboard){pasteCatcher=document.createElement('div');pasteCatcher.id='screenshot-pastezone';pasteCatcher.contentEditable=!0;pasteCatcher.style.opacity=0;pasteCatcher.style.position='fixed';pasteCatcher.style.top=0;pasteCatcher.style.right=0;pasteCatcher.style.width=0;document.body.insertBefore(pasteCatcher,document.body.firstChild);pasteCatcher.focus();document.addEventListener('click',setFocus);document.getElementById('screenshot-zone').addEventListener('click',setFocus)}\n+function initialize(){destroy();if(!window.Clipboard){pasteCatcher=document.createElement('template');pasteCatcher.id='screenshot-pastezone';pasteCatcher.contentEditable=!0;pasteCatcher.style.opacity=0;pasteCatcher.style.position='fixed';pasteCatcher.style.top=0;pasteCatcher.style.right=0;pasteCatcher.style.width=0;document.body.insertBefore(pasteCatcher,document.body.firstChild);pasteCatcher.focus();document.addEventListener('click',setFocus);document.getElementById('screenshot-zone').addEventListener('click',setFocus)}\n window.addEventListener('paste',onPaste,!1)}\n function destroy(){if(KB.exists('#screenshot-pastezone')){KB.find('#screenshot-pastezone').remove()}\n document.removeEventListener('click',setFocus);pasteCatcher=null}"
        },
        {
          "filename": "assets/js/components/screenshot.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,7 +36,7 @@ KB.component('screenshot', function (containerElement) {\n \n         if (! window.Clipboard) {\n             // Insert the content editable at the top to avoid scrolling down in the board view\n-            pasteCatcher = document.createElement('div');\n+            pasteCatcher = document.createElement('template');\n             pasteCatcher.id = 'screenshot-pastezone';\n             pasteCatcher.contentEditable = true;\n             pasteCatcher.style.opacity = 0;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d65a57ac658570dd0bbd6f60393937b0b90bea8d",
            "date": "2025-01-12T00:47:10Z",
            "author_login": "lourdas"
          },
          {
            "sha": "2a97f35f900fbcc33ffce54b12ec54fec3bb4cda",
            "date": "2024-12-20T20:17:14Z",
            "author_login": "fguillot"
          },
          {
            "sha": "e49e6968a587594ed62af193f639313293104e6a",
            "date": "2024-12-18T21:30:14Z",
            "author_login": "fguillot"
          },
          {
            "sha": "acf2be83765663b10fc1d6403aa2dba359275e08",
            "date": "2024-12-18T03:58:47Z",
            "author_login": "fguillot"
          },
          {
            "sha": "4d438cd2785942fa0dc4c408774f6749dfe2c8a6",
            "date": "2024-12-18T03:49:04Z",
            "author_login": "fguillot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Kanboard is project management software that focuses on the Kanban methodology. Due to improper handling of elements under the `contentEditable` element, maliciously crafted clipboard content can inject arbitrary HTML tags into the DOM. A low-privileged attacker with permission to attach a document on a vulnerable Kanboard instance can trick the victim into pasting malicious screenshot data and achieve cross-site scripting if CSP is improperly configured. This issue has been patched in version 1.2.29.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-05-30T05:15:11.770",
    "last_modified": "2024-11-21T08:03:50.883",
    "fix_date": "2023-05-17T02:51:41Z"
  },
  "references": [
    {
      "url": "https://github.com/kanboard/kanboard/commit/26b6eebb78d4306e48b836a58f7c386251aa2bc7",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/commit/c9c187206700030c43493b80fd599b4d096cb713",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-hjmw-gm82-r4gv",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/commit/26b6eebb78d4306e48b836a58f7c386251aa2bc7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/commit/c9c187206700030c43493b80fd599b4d096cb713",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-hjmw-gm82-r4gv",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.268666",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "kanboard",
    "owner": "kanboard",
    "created_at": "2014-01-25T19:58:30Z",
    "updated_at": "2025-01-14T13:08:14Z",
    "pushed_at": "2025-01-12T00:47:10Z",
    "size": 92688,
    "stars": 8610,
    "forks": 1826,
    "open_issues": 158,
    "watchers": 8610,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 8473579,
      "JavaScript": 128907,
      "CSS": 67936,
      "Dockerfile": 2671,
      "Makefile": 2660,
      "Shell": 1368
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:20:14.048868"
  }
}