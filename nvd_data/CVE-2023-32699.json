{
  "cve_id": "CVE-2023-32699",
  "github_data": {
    "repository": "metersphere/metersphere",
    "fix_commit": "c59e381d368990214813085a1a4877c5ef865411",
    "related_commits": [
      "c59e381d368990214813085a1a4877c5ef865411",
      "c59e381d368990214813085a1a4877c5ef865411"
    ],
    "patch_url": "https://github.com/metersphere/metersphere/commit/c59e381d368990214813085a1a4877c5ef865411.patch",
    "fix_commit_details": {
      "sha": "c59e381d368990214813085a1a4877c5ef865411",
      "commit_date": "2023-05-16T11:08:13Z",
      "author": {
        "login": "fit2-zhao",
        "type": "User",
        "stats": {
          "total_commits": 2615,
          "average_weekly_commits": 10.096525096525097,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 208
        }
      },
      "commit_message": {
        "title": "refactor(\u7cfb\u7edf\u8bbe\u7f6e): \u767b\u5f55\u8ba4\u8bc1\u4fe1\u606f\u957f\u5ea6\u9a8c\u8bc1",
        "length": 78,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 13,
        "deletions": 0
      },
      "files": [
        {
          "filename": "framework/gateway/src/main/java/io/metersphere/gateway/service/UserLoginService.java",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -22,6 +22,7 @@\n import org.springframework.web.server.WebSession;\n \n import jakarta.annotation.Resource;\n+\n import java.util.*;\n import java.util.stream.Collectors;\n \n@@ -354,6 +355,12 @@ public boolean checkUserPassword(String userId, String password) {\n         if (StringUtils.isBlank(password)) {\n             MSException.throwException(Translator.get(\"password_is_null\"));\n         }\n+        if (userId.length() > 64) {\n+            MSException.throwException(Translator.get(\"user_id_length_too_long\"));\n+        }\n+        if (password.length() > 30) {\n+            MSException.throwException(Translator.get(\"password_length_too_long\"));\n+        }\n         UserExample example = new UserExample();\n         example.createCriteria().andIdEqualTo(userId).andPasswordEqualTo(CodingUtil.md5(password));\n         return userMapper.countByExample(example) > 0;"
        },
        {
          "filename": "framework/sdk-parent/sdk/src/main/resources/i18n/commons_en_US.properties",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -20,6 +20,8 @@ user_id_is_null=User ID cannot be null\n user_name_is_null=User name cannot be null\n user_email_is_null=User email cannot be null\n password_is_null=Password cannot be null\n+password_length_too_long=Password length cannot exceed 30 characters\n+user_id_length_too_long=User ID length cannot exceed 64 characters\n user_id_already_exists=User ID already exists\n password_modification_failed=The old password is wrong. Please re-enter it\n cannot_delete_current_user=Cannot delete the user currently logged in"
        },
        {
          "filename": "framework/sdk-parent/sdk/src/main/resources/i18n/commons_zh_CN.properties",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -18,6 +18,8 @@ user_id_is_null=\u7528\u6237ID\u4e0d\u80fd\u4e3a\u7a7a\n user_name_is_null=\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\n user_email_is_null=\u7528\u6237\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\n password_is_null=\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\n+password_length_too_long=\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc730\u4e2a\u5b57\u7b26\n+user_id_length_too_long=\u7528\u6237\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc764\u4e2a\u5b57\u7b26\n user_id_already_exists=\u7528\u6237id\u5df2\u5b58\u5728\n password_modification_failed=\u65e7\u5bc6\u7801\u8f93\u5165\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\n cannot_delete_current_user=\u65e0\u6cd5\u5220\u9664\u5f53\u524d\u767b\u5f55\u7528\u6237"
        },
        {
          "filename": "framework/sdk-parent/sdk/src/main/resources/i18n/commons_zh_TW.properties",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -18,6 +18,8 @@ user_id_is_null=\u7528\u6236ID\u4e0d\u80fd\u70ba\u7a7a\n user_name_is_null=\u7528\u6236\u540d\u4e0d\u80fd\u70ba\u7a7a\n user_email_is_null=\u7528\u6236\u90f5\u7bb1\u4e0d\u80fd\u70ba\u7a7a\n password_is_null=\u5bc6\u78bc\u4e0d\u80fd\u70ba\u7a7a\n+password_length_too_long=\u5bc6\u78bc\u9577\u5ea6\u4e0d\u80fd\u8d85\u904e30\u500b\u5b57\u7b26\n+user_id_length_too_long=\u7528\u6236\u540d\u79f0\u9577\u5ea6\u4e0d\u80fd\u8d85\u904e64\u500b\u5b57\u7b26\n user_id_already_exists=\u7528\u6236id\u5df2\u5b58\u5728\n password_modification_failed=\u820a\u5bc6\u78bc\u8f38\u5165\u932f\u8aa4\uff0c\u8acb\u91cd\u65b0\u8f38\u5165\n cannot_delete_current_user=\u7121\u6cd5\u522a\u9664\u7576\u524d\u767b\u9304\u7528\u6236"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "653f522d0e219c624af3ef3ecaa9ae6565b9e599",
            "date": "2025-01-14T09:32:51Z",
            "author_login": "1myuan"
          },
          {
            "sha": "fc5888fa67df817aaf48d742c5e3b55f4f134243",
            "date": "2025-01-14T09:09:07Z",
            "author_login": "fit2cloudwxx"
          },
          {
            "sha": "a3743df4fc81b8386543872c2d9b8f48bff811f0",
            "date": "2025-01-14T08:22:03Z",
            "author_login": "1myuan"
          },
          {
            "sha": "ab8123aad19bb7b8afb29ad399c02d03385c81d9",
            "date": "2025-01-14T07:33:50Z",
            "author_login": "ba1q1"
          },
          {
            "sha": "30baab90bf337463b6b2beb9c6f21aacf8fac878",
            "date": "2025-01-14T07:15:37Z",
            "author_login": "AgAngle"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-770",
    "description": "MeterSphere is an open source continuous testing platform. Version 2.9.1 and prior are vulnerable to denial of service. \u200bThe `checkUserPassword` method is used to check whether the password provided by the user matches the password saved in the database, and the `CodingUtil.md5` method is used to encrypt the original password with MD5 to ensure that the password will not be saved in plain text when it is stored. If a user submits a very long password when logging in, the system will be forced to execute the long password MD5 encryption process, causing the server CPU and memory to be exhausted, thereby causing a denial of service attack on the server. This issue is fixed in version 2.10.0-lts with a maximum password length.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-30T19:15:10.103",
    "last_modified": "2024-11-21T08:03:52.693",
    "fix_date": "2023-05-16T11:08:13Z"
  },
  "references": [
    {
      "url": "https://github.com/metersphere/metersphere/commit/c59e381d368990214813085a1a4877c5ef865411",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/metersphere/metersphere/security/advisories/GHSA-qffq-8gf8-mhq7",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/metersphere/metersphere/commit/c59e381d368990214813085a1a4877c5ef865411",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/metersphere/metersphere/security/advisories/GHSA-qffq-8gf8-mhq7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.274123",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "metersphere",
    "owner": "metersphere",
    "created_at": "2020-02-03T02:06:12Z",
    "updated_at": "2025-01-14T10:03:08Z",
    "pushed_at": "2025-01-14T10:23:16Z",
    "size": 420461,
    "stars": 11802,
    "forks": 2623,
    "open_issues": 28,
    "watchers": 11802,
    "has_security_policy": false,
    "default_branch": "v3.x",
    "protected_branches": [
      "v1.0",
      "v1.1",
      "v1.2",
      "v1.3",
      "v1.4",
      "v1.5",
      "v1.6",
      "v1.7",
      "v1.8",
      "v1.9",
      "v1.10",
      "v1.11",
      "v1.12",
      "v1.13",
      "v1.14",
      "v1.15",
      "v1.16",
      "v1.17",
      "v1.18",
      "v1.19",
      "v1.20",
      "v2.0",
      "v2.1",
      "v2.2",
      "v2.3",
      "v2.4",
      "v2.5",
      "v2.6",
      "v2.7"
    ],
    "languages": {
      "Java": 14777352,
      "Vue": 5726299,
      "TypeScript": 1960656,
      "MAXScript": 77425,
      "Less": 39452,
      "JavaScript": 34573,
      "CSS": 23345,
      "Dockerfile": 993,
      "HTML": 538,
      "Shell": 181
    },
    "commit_activity": {
      "total_commits_last_year": 4873,
      "avg_commits_per_week": 93.71153846153847,
      "days_active_last_year": 273
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:44:08.370799"
  }
}