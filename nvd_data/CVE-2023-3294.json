{
  "cve_id": "CVE-2023-3294",
  "github_data": {
    "repository": "saleor/react-storefront",
    "fix_commit": "c29aab226f07ca980cc19787dcef101e11b83ef7",
    "related_commits": [
      "c29aab226f07ca980cc19787dcef101e11b83ef7",
      "c29aab226f07ca980cc19787dcef101e11b83ef7"
    ],
    "patch_url": "https://github.com/saleor/react-storefront/commit/c29aab226f07ca980cc19787dcef101e11b83ef7.patch",
    "fix_commit_details": {
      "sha": "c29aab226f07ca980cc19787dcef101e11b83ef7",
      "commit_date": "2023-06-16T10:05:07Z",
      "author": {
        "login": "typeofweb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-wq85-q492-8vxv",
        "length": 79,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 7,
        "deletions": 4
      },
      "files": [
        {
          "filename": "apps/storefront/components/AccountLayout/AccountLayout.tsx",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -23,8 +23,10 @@ export function AccountLayout({ children }: AccountLayoutProps) {\n     );\n   }\n \n-  if (!authenticated && typeof window !== \"undefined\") {\n-    void router.push(paths.account.login.$url({ query: { next: router?.pathname } }));\n+  if (!authenticated) {\n+    if (router.isReady && typeof window !== \"undefined\") {\n+      void router.replace(paths.account.login.$url({ query: { next: router?.asPath } }));\n+    }\n     return null;\n   }\n "
        },
        {
          "filename": "apps/storefront/pages/[channel]/[locale]/account/login.tsx",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -40,8 +40,6 @@ function LoginPage() {\n   } = useForm<LoginFormData>({ defaultValues });\n \n   const routerQueryNext = router.query.next?.toString() || \"\";\n-  const isExternalUrl = /^\\w+:\\/\\//.test(routerQueryNext);\n-  const redirectURL = !routerQueryNext || isExternalUrl ? paths.$url() : routerQueryNext;\n \n   const handleLogin = handleSubmitForm(async (formData: LoginFormData) => {\n     const { data } = await signIn({\n@@ -54,6 +52,9 @@ function LoginPage() {\n       return;\n     }\n \n+    const redirectURL =\n+      (routerQueryNext && new URL(routerQueryNext, window.location.toString()).pathname) ||\n+      paths.$url();\n     void router.push(redirectURL);\n   });\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c8a65375711860a4429c8430803d7046faeec078",
            "date": "2024-10-04T11:08:40Z",
            "author_login": "zulalnb"
          },
          {
            "sha": "6d112b94d0194a8d6d21bbe8a9c84a1c661c2dd4",
            "date": "2024-09-30T07:29:27Z",
            "author_login": "krzysztofzuraw"
          },
          {
            "sha": "78f9a5fc1b5ae2d8e991112bb39ee440d3bf5bff",
            "date": "2024-09-30T07:21:46Z",
            "author_login": "krzysztofzuraw"
          },
          {
            "sha": "e7978afa7624dd4d42b508ad5de13d1f190060ac",
            "date": "2024-08-27T12:58:04Z",
            "author_login": "timuric"
          },
          {
            "sha": "8f9b012b540acbbcd7e1ee053568afeb034fb67b",
            "date": "2024-07-23T06:10:31Z",
            "author_login": "timuric"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - DOM in GitHub repository saleor/react-storefront prior to c29aab226f07ca980cc19787dcef101e11b83ef7.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-16T12:15:09.393",
    "last_modified": "2024-11-21T08:16:56.977",
    "fix_date": "2023-06-16T10:05:07Z"
  },
  "references": [
    {
      "url": "https://github.com/saleor/react-storefront/commit/c29aab226f07ca980cc19787dcef101e11b83ef7",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/9d308ebb-4289-411f-ac22-990383d98932",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/saleor/react-storefront/commit/c29aab226f07ca980cc19787dcef101e11b83ef7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/9d308ebb-4289-411f-ac22-990383d98932",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.371649",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "storefront",
    "owner": "saleor",
    "created_at": "2021-08-20T15:47:51Z",
    "updated_at": "2025-01-14T06:47:01Z",
    "pushed_at": "2025-01-14T14:18:07Z",
    "size": 22540,
    "stars": 1096,
    "forks": 632,
    "open_issues": 48,
    "watchers": 1096,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "canary",
      "main_old",
      "main"
    ],
    "languages": {
      "TypeScript": 1197525,
      "Dockerfile": 2252,
      "JavaScript": 805,
      "CSS": 423,
      "Shell": 64
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:31:31.804280"
  }
}