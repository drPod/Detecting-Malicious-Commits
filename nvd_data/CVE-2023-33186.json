{
  "cve_id": "CVE-2023-33186",
  "github_data": {
    "repository": "zulip/zulip",
    "fix_commit": "03cfb3d9fe61c975d133121ec31a7357f0c9e18f",
    "related_commits": [
      "03cfb3d9fe61c975d133121ec31a7357f0c9e18f",
      "3ca131743b00f42bad8edbac4ef92656d954c629",
      "03cfb3d9fe61c975d133121ec31a7357f0c9e18f",
      "3ca131743b00f42bad8edbac4ef92656d954c629"
    ],
    "patch_url": "https://github.com/zulip/zulip/commit/03cfb3d9fe61c975d133121ec31a7357f0c9e18f.patch",
    "fix_commit_details": {
      "sha": "03cfb3d9fe61c975d133121ec31a7357f0c9e18f",
      "commit_date": "2023-05-01T19:25:17Z",
      "author": {
        "login": "Ddharmani3",
        "type": "User",
        "stats": {
          "total_commits": 92,
          "average_weekly_commits": 0.14219474497681608,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 22
        }
      },
      "commit_message": {
        "title": "tooltips: Add `S` hotkey hint to `narrow-to` tippy tooltips.",
        "length": 572,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 16,
        "deletions": 3
      },
      "files": [
        {
          "filename": "web/src/tippyjs.js",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -185,6 +185,16 @@ export function initialize() {\n         },\n     });\n \n+    delegate(\"body\", {\n+        target: \".tippy-narrow-tooltip\",\n+        delay: LONG_HOVER_DELAY,\n+        appendTo: () => document.body,\n+        onCreate(instance) {\n+            const content = instance.props.content + $(\"#narrow-hotkey-tooltip-template\").html();\n+            instance.setContent(parse_html(content));\n+        },\n+    });\n+\n     delegate(\"body\", {\n         target: \".toggle-subscription-tooltip\",\n         delay: EXTRA_LONG_HOVER_DELAY,"
        },
        {
          "filename": "web/templates/recipient_row.hbs",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -2,7 +2,7 @@\n <div class=\"message_header message_header_stream right_part\" data-stream-id=\"{{stream_id}}\">\n     <div class=\"message-header-contents\" style=\"background: {{recipient_bar_color}};\">\n         {{! stream link }}\n-        <a class=\"message_label_clickable narrows_by_recipient stream_label tippy-zulip-delayed-tooltip\"\n+        <a class=\"message_label_clickable narrows_by_recipient stream_label tippy-narrow-tooltip\"\n           href=\"{{stream_url}}\"\n           data-tippy-content=\"{{t 'Narrow to stream \"{display_recipient}\"' }}\">\n             <span class=\"stream-privacy-modified-color-{{stream_id}} stream-privacy filter-icon\"  style=\"color: {{stream_privacy_icon_color}}\">\n@@ -20,7 +20,7 @@\n         {{! topic stuff }}\n         <span class=\"stream_topic\">\n             {{! topic link }}\n-            <a class=\"message_label_clickable narrows_by_topic tippy-zulip-delayed-tooltip\"\n+            <a class=\"message_label_clickable narrows_by_topic tippy-narrow-tooltip\"\n               href=\"{{topic_url}}\"\n               data-tippy-content=\"{{t 'Narrow to stream \"{display_recipient}\", topic \"{topic}\"' }}\">\n                 {{#if use_match_properties}}\n@@ -80,7 +80,7 @@\n {{else}}\n <div class=\"message_header message_header_private_message\">\n     <div class=\"message-header-contents\">\n-        <a class=\"message_label_clickable narrows_by_recipient stream_label tippy-zulip-delayed-tooltip\"\n+        <a class=\"message_label_clickable narrows_by_recipient stream_label tippy-narrow-tooltip\"\n           href=\"{{pm_with_url}}\"\n           data-tippy-content=\"{{t 'Narrow to your direct messages with {display_reply_to}' }}\">\n         <span class=\"private_message_header_icon\"><i class=\"zulip-icon zulip-icon-user\"></i></span>"
        },
        {
          "filename": "web/templates/tooltip_templates.hbs",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -2,3 +2,6 @@\n     {{t 'View user card' }}\n     {{tooltip_hotkey_hints \"U\"}}\n </template>\n+<template id=\"narrow-hotkey-tooltip-template\">\n+    {{tooltip_hotkey_hints \"S\"}}\n+</template>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "99ea0255da6d835e98f12adb7100af0f6d9ccb85",
            "date": "2025-01-09T06:57:21Z",
            "author_login": "mateuszmandera"
          },
          {
            "sha": "4196859cd65d373537a0a6092ffe8dc2a6b09ada",
            "date": "2025-01-09T05:56:09Z",
            "author_login": "mateuszmandera"
          },
          {
            "sha": "67887324ed74f9196aff2c26c40f5937ff811819",
            "date": "2024-11-19T21:51:08Z",
            "author_login": "mateuszmandera"
          },
          {
            "sha": "8b09190bcd129ea5e46509343049e595b92f06d9",
            "date": "2025-01-13T13:33:06Z",
            "author_login": "amanagr"
          },
          {
            "sha": "a05cbfa0c9e41e2fa2930b28653076279ae7bda0",
            "date": "2025-01-13T13:24:09Z",
            "author_login": "amanagr"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "Zulip is an open-source team collaboration tool with unique topic-based threading that combines the best of email and chat to make remote work productive and delightful. The main development branch of Zulip Server from May 2, 2023 and later, including beta versions 7.0-beta1 and 7.0-beta2, is vulnerable to a cross-site scripting vulnerability in tooltips on the message feed. An attacker who can send messages could maliciously craft a topic for the message, such that a victim who hovers the tooltip for that topic in their message feed triggers execution of JavaScript code controlled by the attacker.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-05-30T06:16:36.237",
    "last_modified": "2024-11-21T08:05:04.660",
    "fix_date": "2023-05-01T19:25:17Z"
  },
  "references": [
    {
      "url": "https://github.com/zulip/zulip/commit/03cfb3d9fe61c975d133121ec31a7357f0c9e18f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/zulip/zulip/commit/3ca131743b00f42bad8edbac4ef92656d954c629",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/pull/25370",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/security/advisories/GHSA-4r83-8f94-hrph",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/commit/03cfb3d9fe61c975d133121ec31a7357f0c9e18f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/zulip/zulip/commit/3ca131743b00f42bad8edbac4ef92656d954c629",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/pull/25370",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/security/advisories/GHSA-4r83-8f94-hrph",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.269503",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "zulip",
    "owner": "zulip",
    "created_at": "2015-09-25T16:37:25Z",
    "updated_at": "2025-01-14T13:31:30Z",
    "pushed_at": "2025-01-14T02:34:21Z",
    "size": 495185,
    "stars": 21946,
    "forks": 8107,
    "open_issues": 2487,
    "watchers": 21946,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.4.x",
      "1.5.x",
      "1.8.x",
      "1.9.x",
      "2.0.x",
      "2.1.x",
      "3.x",
      "3.1-with-bmemcached",
      "4.x",
      "4.0-rc1-branch",
      "5.x",
      "5.x-user-sharding",
      "5.0-rc1-branch",
      "5.0-rc2-branch",
      "6.x",
      "6.0-beta1-branch",
      "6.0-rc1-branch",
      "7.x",
      "7.0-beta1-branch",
      "7.0-beta2-branch",
      "8.x",
      "9.x",
      "buddy-list-prep",
      "chat.zulip.org",
      "dockertest",
      "main",
      "s3-compatible-uploads",
      "zulip-cloud-current"
    ],
    "languages": {
      "Python": 14193798,
      "TypeScript": 4055572,
      "JavaScript": 2278673,
      "HTML": 957053,
      "CSS": 942085,
      "Handlebars": 597145,
      "Shell": 161466,
      "Puppet": 137563,
      "Perl": 10353,
      "Dockerfile": 4219,
      "Ruby": 3794,
      "Emacs Lisp": 157
    },
    "commit_activity": {
      "total_commits_last_year": 6397,
      "avg_commits_per_week": 123.01923076923077,
      "days_active_last_year": 356
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:44:17.890508"
  }
}