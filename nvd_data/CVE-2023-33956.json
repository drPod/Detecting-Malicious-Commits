{
  "cve_id": "CVE-2023-33956",
  "github_data": {
    "repository": "kanboard/kanboard",
    "fix_commit": "437b141fa2267df36976814e704517f30d2424bd",
    "related_commits": [
      "437b141fa2267df36976814e704517f30d2424bd",
      "437b141fa2267df36976814e704517f30d2424bd"
    ],
    "patch_url": "https://github.com/kanboard/kanboard/commit/437b141fa2267df36976814e704517f30d2424bd.patch",
    "fix_commit_details": {
      "sha": "437b141fa2267df36976814e704517f30d2424bd",
      "commit_date": "2023-05-25T03:36:34Z",
      "author": {
        "login": "fguillot",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix Parameter based Indirect Object Referencing leading to private file exposure",
        "length": 80,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "app/Controller/BaseController.php",
          "status": "modified",
          "additions": 6,
          "deletions": 2,
          "patch": "@@ -89,10 +89,10 @@ protected function getTask()\n      * @access protected\n      * @return array\n      * @throws PageNotFoundException\n-     * @throws AccessForbiddenException\n      */\n     protected function getFile()\n     {\n+        $project_id = $this->request->getIntegerParam('project_id');\n         $task_id = $this->request->getIntegerParam('task_id');\n         $file_id = $this->request->getIntegerParam('file_id');\n         $model = 'projectFileModel';\n@@ -108,7 +108,11 @@ protected function getFile()\n         }\n \n         if (isset($file['task_id']) && $file['task_id'] != $task_id) {\n-            throw new AccessForbiddenException();\n+            throw new PageNotFoundException();\n+        }\n+\n+        if (isset($file['project_id']) && $file['project_id'] != $project_id) {\n+            throw new PageNotFoundException();\n         }\n \n         $file['model'] = $model;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d65a57ac658570dd0bbd6f60393937b0b90bea8d",
            "date": "2025-01-12T00:47:10Z",
            "author_login": "lourdas"
          },
          {
            "sha": "2a97f35f900fbcc33ffce54b12ec54fec3bb4cda",
            "date": "2024-12-20T20:17:14Z",
            "author_login": "fguillot"
          },
          {
            "sha": "e49e6968a587594ed62af193f639313293104e6a",
            "date": "2024-12-18T21:30:14Z",
            "author_login": "fguillot"
          },
          {
            "sha": "acf2be83765663b10fc1d6403aa2dba359275e08",
            "date": "2024-12-18T03:58:47Z",
            "author_login": "fguillot"
          },
          {
            "sha": "4d438cd2785942fa0dc4c408774f6749dfe2c8a6",
            "date": "2024-12-18T03:49:04Z",
            "author_login": "fguillot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "Kanboard is open source project management software that focuses on the Kanban methodology. Versions prior to 1.2.30 are subject to an Insecure direct object reference (IDOR) vulnerability present in the application's URL parameter. This vulnerability enables any user to read files uploaded by any other user, regardless of their privileges or restrictions. By Changing the file_id any user can render all the files where MimeType is image uploaded under **/files** directory regard less of uploaded by any user. This vulnerability poses a significant impact and severity to the application's security. By manipulating the URL parameter, an attacker can access sensitive files that should only be available to authorized users. This includes confidential documents or any other type of file stored within the application. The ability to read these files can lead to various detrimental consequences, such as unauthorized disclosure of sensitive information, privacy breaches, intellectual property theft, or exposure of trade secrets. Additionally, it could result in legal and regulatory implications, reputation damage, financial losses, and potential compromise of user trust. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-05T20:15:09.460",
    "last_modified": "2024-11-21T08:06:17.300",
    "fix_date": "2023-05-25T03:36:34Z"
  },
  "references": [
    {
      "url": "https://github.com/kanboard/kanboard/commit/437b141fa2267df36976814e704517f30d2424bd",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-r36m-44gg-wxg2",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/commit/437b141fa2267df36976814e704517f30d2424bd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-r36m-44gg-wxg2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.305351",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "kanboard",
    "owner": "kanboard",
    "created_at": "2014-01-25T19:58:30Z",
    "updated_at": "2025-01-14T13:08:14Z",
    "pushed_at": "2025-01-12T00:47:10Z",
    "size": 92688,
    "stars": 8610,
    "forks": 1826,
    "open_issues": 158,
    "watchers": 8610,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 8473579,
      "JavaScript": 128907,
      "CSS": 67936,
      "Dockerfile": 2671,
      "Makefile": 2660,
      "Shell": 1368
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:20:14.048868"
  }
}