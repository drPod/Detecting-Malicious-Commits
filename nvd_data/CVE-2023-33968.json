{
  "cve_id": "CVE-2023-33968",
  "github_data": {
    "repository": "kanboard/kanboard",
    "fix_commit": "c20be8f5fa26e54005a90c645e80b11481a65053",
    "related_commits": [
      "c20be8f5fa26e54005a90c645e80b11481a65053",
      "c20be8f5fa26e54005a90c645e80b11481a65053"
    ],
    "patch_url": "https://github.com/kanboard/kanboard/commit/c20be8f5fa26e54005a90c645e80b11481a65053.patch",
    "fix_commit_details": {
      "sha": "c20be8f5fa26e54005a90c645e80b11481a65053",
      "commit_date": "2023-05-30T01:12:24Z",
      "author": {
        "login": "fguillot",
        "type": "User",
        "stats": {
          "total_commits": 2700,
          "average_weekly_commits": 4.70383275261324,
          "total_additions": 870938,
          "total_deletions": 651416,
          "weeks_active": 306
        }
      },
      "commit_message": {
        "title": "Add missing project permission check for Move/Duplicate task to another project",
        "length": 79,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 21,
        "deletions": 5
      },
      "files": [
        {
          "filename": "app/Controller/TaskDuplicationController.php",
          "status": "modified",
          "additions": 21,
          "deletions": 5,
          "patch": "@@ -2,6 +2,8 @@\n \n namespace Kanboard\\Controller;\n \n+use Kanboard\\Core\\Controller\\AccessForbiddenException;\n+\n /**\n  * Task Duplication controller\n  *\n@@ -50,14 +52,20 @@ public function move()\n             $values = $this->request->getValues();\n             list($valid, ) = $this->taskValidator->validateProjectModification($values);\n \n-            if ($valid && $this->taskProjectMoveModel->moveToProject($task['id'],\n+            if ($valid) {\n+                if (! $this->projectPermissionModel->isUserAllowed($values['project_id'], $this->userSession->getId())) {\n+                    throw new AccessForbiddenException();\n+                }\n+\n+                if ($this->taskProjectMoveModel->moveToProject($task['id'],\n                                                                 $values['project_id'],\n                                                                 $values['swimlane_id'],\n                                                                 $values['column_id'],\n                                                                 $values['category_id'],\n                                                                 $values['owner_id'])) {\n-                $this->flash->success(t('Task updated successfully.'));\n-                return $this->response->redirect($this->helper->url->to('TaskViewController', 'show', array('task_id' => $task['id'])));\n+                    $this->flash->success(t('Task updated successfully.'));\n+                    return $this->response->redirect($this->helper->url->to('TaskViewController', 'show', array('task_id' => $task['id'])));\n+                }\n             }\n \n             $this->flash->failure(t('Unable to update your task.'));\n@@ -80,9 +88,17 @@ public function copy()\n             list($valid, ) = $this->taskValidator->validateProjectModification($values);\n \n             if ($valid) {\n+                if (! $this->projectPermissionModel->isUserAllowed($values['project_id'], $this->userSession->getId())) {\n+                    throw new AccessForbiddenException();\n+                }\n+\n                 $task_id = $this->taskProjectDuplicationModel->duplicateToProject(\n-                    $task['id'], $values['project_id'], $values['swimlane_id'],\n-                    $values['column_id'], $values['category_id'], $values['owner_id']\n+                    $task['id'],\n+                    $values['project_id'],\n+                    $values['swimlane_id'],\n+                    $values['column_id'],\n+                    $values['category_id'],\n+                    $values['owner_id']\n                 );\n \n                 if ($task_id > 0) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d65a57ac658570dd0bbd6f60393937b0b90bea8d",
            "date": "2025-01-12T00:47:10Z",
            "author_login": "lourdas"
          },
          {
            "sha": "2a97f35f900fbcc33ffce54b12ec54fec3bb4cda",
            "date": "2024-12-20T20:17:14Z",
            "author_login": "fguillot"
          },
          {
            "sha": "e49e6968a587594ed62af193f639313293104e6a",
            "date": "2024-12-18T21:30:14Z",
            "author_login": "fguillot"
          },
          {
            "sha": "acf2be83765663b10fc1d6403aa2dba359275e08",
            "date": "2024-12-18T03:58:47Z",
            "author_login": "fguillot"
          },
          {
            "sha": "4d438cd2785942fa0dc4c408774f6749dfe2c8a6",
            "date": "2024-12-18T03:49:04Z",
            "author_login": "fguillot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-862",
    "description": "Kanboard is open source project management software that focuses on the Kanban methodology. Versions prior to 1.2.30 are subject to a missing access control vulnerability that allows a user with low privileges to create or transfer tasks to any project within the software, even if they have not been invited or the project is personal. The vulnerable features are `Duplicate to project` and `Move to project`, which both utilize the `checkDestinationProjectValues()` function to check his values. This issue has been addressed in version 1.2.30. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-05T20:15:09.750",
    "last_modified": "2024-11-21T08:06:18.903",
    "fix_date": "2023-05-30T01:12:24Z"
  },
  "references": [
    {
      "url": "https://github.com/kanboard/kanboard/commit/c20be8f5fa26e54005a90c645e80b11481a65053",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-gf8r-4p6m-v8vr",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/commit/c20be8f5fa26e54005a90c645e80b11481a65053",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-gf8r-4p6m-v8vr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:05:59.305491",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "kanboard",
    "owner": "kanboard",
    "created_at": "2014-01-25T19:58:30Z",
    "updated_at": "2025-01-14T13:08:14Z",
    "pushed_at": "2025-01-12T00:47:10Z",
    "size": 92688,
    "stars": 8610,
    "forks": 1826,
    "open_issues": 158,
    "watchers": 8610,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 8473579,
      "JavaScript": 128907,
      "CSS": 67936,
      "Dockerfile": 2671,
      "Makefile": 2660,
      "Shell": 1368
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:20:14.048868"
  }
}