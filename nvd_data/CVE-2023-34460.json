{
  "cve_id": "CVE-2023-34460",
  "github_data": {
    "repository": "tauri-apps/tauri",
    "fix_commit": "066c09a6ea06f42f550d090715e06beb65cd5564",
    "related_commits": [
      "066c09a6ea06f42f550d090715e06beb65cd5564",
      "066c09a6ea06f42f550d090715e06beb65cd5564"
    ],
    "patch_url": "https://github.com/tauri-apps/tauri/commit/066c09a6ea06f42f550d090715e06beb65cd5564.patch",
    "fix_commit_details": {
      "sha": "066c09a6ea06f42f550d090715e06beb65cd5564",
      "commit_date": "2023-06-17T12:17:36Z",
      "author": {
        "login": "amrbashir",
        "type": "User",
        "stats": {
          "total_commits": 643,
          "average_weekly_commits": 2.2249134948096887,
          "total_additions": 308074,
          "total_deletions": 320831,
          "weeks_active": 135
        }
      },
      "commit_message": {
        "title": "fix(core): fix `require_literal_leading_dot` flipped behavior (#7227)",
        "length": 69,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 20,
        "additions": 13,
        "deletions": 7
      },
      "files": [
        {
          "filename": ".changes/config.json",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -7,6 +7,7 @@\n     \"bug\": \"Bug Fixes\",\n     \"pref\": \"Performance Improvements\",\n     \"changes\": \"What's Changed\",\n+    \"sec\": \"Security fixes\",\n     \"deps\": \"Dependencies\"\n   },\n   \"defaultChangeTag\": \"changes\","
        },
        {
          "filename": ".changes/core-leading-dot.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+'tauri': 'patch:sec'\n+---\n+\n+Fix regression in `1.4` where the default behavior of the file system scope was changed to allow reading hidden files and directories by default."
        },
        {
          "filename": "core/tauri-config-schema/schema.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2102,7 +2102,7 @@\n               }\n             },\n             \"requireLiteralLeadingDot\": {\n-              \"description\": \"Whether or not paths that contain components that start with a `.` will require that `.` appears literally in the pattern; `*`, `?`, `**`, or `[...]` will not match. This is useful because such files are conventionally considered hidden on Unix systems and it might be desirable to skip them when listing files.\\n\\nDefaults to `false` on Unix systems and `true` on Windows\",\n+              \"description\": \"Whether or not paths that contain components that start with a `.` will require that `.` appears literally in the pattern; `*`, `?`, `**`, or `[...]` will not match. This is useful because such files are conventionally considered hidden on Unix systems and it might be desirable to skip them when listing files.\\n\\nDefaults to `true` on Unix systems and `false` on Windows\",\n               \"type\": [\n                 \"boolean\",\n                 \"null\""
        },
        {
          "filename": "core/tauri-utils/src/config.rs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1329,7 +1329,7 @@ pub enum FsAllowlistScope {\n     /// conventionally considered hidden on Unix systems and it might be\n     /// desirable to skip them when listing files.\n     ///\n-    /// Defaults to `false` on Unix systems and `true` on Windows\n+    /// Defaults to `true` on Unix systems and `false` on Windows\n     // dotfiles are not supposed to be exposed by default on unix\n     #[serde(alias = \"require-literal-leading-dot\")]\n     require_literal_leading_dot: Option<bool>,"
        },
        {
          "filename": "core/tauri/src/scope/fs.rs",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -114,9 +114,9 @@ impl Scope {\n       } => *require,\n       // dotfiles are not supposed to be exposed by default on unix\n       #[cfg(unix)]\n-      _ => false,\n-      #[cfg(windows)]\n       _ => true,\n+      #[cfg(windows)]\n+      _ => false,\n     };\n \n     Ok(Self {\n@@ -287,9 +287,9 @@ mod tests {\n         require_literal_separator: true,\n         // dotfiles are not supposed to be exposed by default on unix\n         #[cfg(unix)]\n-        require_literal_leading_dot: false,\n-        #[cfg(windows)]\n         require_literal_leading_dot: true,\n+        #[cfg(windows)]\n+        require_literal_leading_dot: false,\n         ..Default::default()\n       },\n     }"
        },
        {
          "filename": "tooling/cli/schema.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2102,7 +2102,7 @@\n               }\n             },\n             \"requireLiteralLeadingDot\": {\n-              \"description\": \"Whether or not paths that contain components that start with a `.` will require that `.` appears literally in the pattern; `*`, `?`, `**`, or `[...]` will not match. This is useful because such files are conventionally considered hidden on Unix systems and it might be desirable to skip them when listing files.\\n\\nDefaults to `false` on Unix systems and `true` on Windows\",\n+              \"description\": \"Whether or not paths that contain components that start with a `.` will require that `.` appears literally in the pattern; `*`, `?`, `**`, or `[...]` will not match. This is useful because such files are conventionally considered hidden on Unix systems and it might be desirable to skip them when listing files.\\n\\nDefaults to `true` on Unix systems and `false` on Windows\",\n               \"type\": [\n                 \"boolean\",\n                 \"null\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 4,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4c3f04773534c0b33ea81bcff6dd7719ef265662",
            "date": "2025-01-13T12:08:29Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "61e69db9e48f6a652ed3ecb05567c648c6e788d0",
            "date": "2025-01-13T11:23:17Z",
            "author_login": "FabianLars"
          },
          {
            "sha": "75d56e8364fb203387bb5a5235f316dd7dfa6acd",
            "date": "2025-01-13T02:03:36Z",
            "author_login": "oscartbeaumont"
          },
          {
            "sha": "a8aca701515a1059b1cdf3abf37e487b21b9bd11",
            "date": "2025-01-11T17:13:55Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "cad5504455ffa53e297cebff473c113b1afa5d29",
            "date": "2025-01-11T16:28:54Z",
            "author_login": "FabianLars"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-285",
    "description": "Tauri is a framework for building binaries for all major desktop platforms. The 1.4.0 release includes a regression on the Filesystem scope check for dotfiles on Unix. Previously dotfiles were not implicitly allowed by the glob wildcard scopes (eg. `$HOME/*`), but a regression was introduced when a configuration option for this behavior was implemented. Only Tauri applications using wildcard scopes in the `fs` endpoint are affected. The regression has been patched on version 1.4.1.\n\n",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-23T20:15:09.147",
    "last_modified": "2024-11-21T08:07:18.050",
    "fix_date": "2023-06-17T12:17:36Z"
  },
  "references": [
    {
      "url": "https://github.com/tauri-apps/tauri/commit/066c09a6ea06f42f550d090715e06beb65cd5564",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/pull/6969#discussion_r1232018347",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/pull/7227",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/security/advisories/GHSA-wmff-grcw-jcfm",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/commit/066c09a6ea06f42f550d090715e06beb65cd5564",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/pull/6969#discussion_r1232018347",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/pull/7227",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tauri-apps/tauri/security/advisories/GHSA-wmff-grcw-jcfm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:01.860984",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tauri",
    "owner": "tauri-apps",
    "created_at": "2019-07-13T09:09:37Z",
    "updated_at": "2025-01-14T15:28:32Z",
    "pushed_at": "2025-01-14T16:01:17Z",
    "size": 93444,
    "stars": 88352,
    "forks": 2688,
    "open_issues": 943,
    "watchers": 88352,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "1.x",
      "1.0",
      "1.1",
      "1.2",
      "1.3",
      "1.6",
      "dev",
      "next"
    ],
    "languages": {
      "Rust": 2431452,
      "TypeScript": 209615,
      "NSIS": 104592,
      "Kotlin": 63116,
      "JavaScript": 49640,
      "Shell": 43350,
      "Swift": 22030,
      "Dockerfile": 2143,
      "HTML": 2143,
      "PowerShell": 1951,
      "AppleScript": 1828,
      "Svelte": 1727,
      "CSS": 1654,
      "Standard ML": 1348,
      "Ruby": 839,
      "Objective-C": 414,
      "Objective-C++": 100,
      "C++": 82
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:04:01.084221"
  }
}