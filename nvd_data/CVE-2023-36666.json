{
  "cve_id": "CVE-2023-36666",
  "github_data": {
    "repository": "inex/IXP-Manager",
    "fix_commit": "fddbc38adb477c9cd46a462655ffed96d3d42229",
    "related_commits": [
      "fddbc38adb477c9cd46a462655ffed96d3d42229",
      "fddbc38adb477c9cd46a462655ffed96d3d42229"
    ],
    "patch_url": "https://github.com/inex/IXP-Manager/commit/fddbc38adb477c9cd46a462655ffed96d3d42229.patch",
    "fix_commit_details": {
      "sha": "fddbc38adb477c9cd46a462655ffed96d3d42229",
      "commit_date": "2023-06-20T07:49:45Z",
      "author": {
        "login": "barryo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[BF] Fix a number of XSS issues",
        "length": 110,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 26,
        "additions": 13,
        "deletions": 13
      },
      "files": [
        {
          "filename": "resources/views/console-server-connection/list-preamble.foil.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n <?php if( isset($t->data[ 'params'][ \"cs\" ]) ): ?>\n     <div>\n         <h2>\n-            Ports for Console Server: <?= $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] ?><br><br>\n+            Ports for Console Server: <?= $t->ee( $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] ) ?><br><br>\n         </h2>\n     </div>\n <?php endif;?>\n\\ No newline at end of file"
        },
        {
          "filename": "resources/views/console-server-connection/page-header-preamble.foil.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -2,7 +2,7 @@\n     <div class=\"btn-group btn-group-sm\" role=\"group\">\n         <div class=\"btn-group btn-group-sm\">\n             <button type=\"button\" class=\"btn btn-white dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n-                <?= isset( $t->data[ 'params'][ \"cs\" ] ) ? $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] : \"All Console Server Ports\" ?> <span class=\"caret\"></span>\n+                <?= isset( $t->data[ 'params'][ \"cs\" ] ) ? $t->ee( $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] ) : \"All Console Server Ports\" ?> <span class=\"caret\"></span>\n             </button>\n \n             <div class=\"dropdown-menu dropdown-menu-right scrollable-dropdown\">\n@@ -11,7 +11,7 @@\n                 </a>\n                 <div class=\"dropdown-divider\"></div>\n                 <?php foreach( $t->data[ 'params'][ \"css\" ] as $css ): ?>\n-                    <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"cs\" ] ) && $t->data[ 'params'][ \"cs\" ] === $css[ 'id' ] ? 'active' : '' ?>\" href=\"<?= route( \"console-server-connection@listPort\", [ \"cs\" => $css[ 'id' ] ] ) ?>\"><?= $css[ 'name' ] ?></a>\n+                    <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"cs\" ] ) && $t->data[ 'params'][ \"cs\" ] === $css[ 'id' ] ? 'active' : '' ?>\" href=\"<?= route( \"console-server-connection@listPort\", [ \"cs\" => $css[ 'id' ] ] ) ?>\"><?= $t->ee( $css[ 'name' ] ) ?></a>\n                 <?php endforeach; ?>\n             </div>\n         </div>"
        },
        {
          "filename": "resources/views/contact/edit-form.foil.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -81,7 +81,7 @@\n                                         <div class=\"form-check form-check-inline\">\n                                             <input id='role_<?= $role[ 'id' ] ?>' type='checkbox' name='roles[]' <?= in_array( $role[ 'id' ], $checkedRoles, false ) ? 'checked' : '' ?> value='<?= $role[ 'id' ] ?>'>\n                                             <label for=\"role_<?= $role[ 'id' ] ?>\" class=\"form-check-label\">\n-                                                <?= $role[ 'name' ] ?>\n+                                                <?= $t->ee( $role[ 'name' ] ) ?>\n                                             </label>\n                                         </div>\n                                     </div>"
        },
        {
          "filename": "resources/views/contact/page-header-preamble.foil.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -8,7 +8,7 @@\n \n         <?php if( config('contact_group.types.ROLE') ): ?>\n             <button type=\"button\" class=\"btn btn-white dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n-                <?= isset( $t->data[ 'params'][ \"role\" ] ) ? $t->data[ 'params'][ \"roles\" ][ $t->data[ 'params'][ \"role\" ] ][ 'name']  : \"All Roles\" ?>\n+                <?= isset( $t->data[ 'params'][ \"role\" ] ) ? $t->ee( $t->data[ 'params'][ \"roles\" ][ $t->data[ 'params'][ \"role\" ] ][ 'name'] ) : \"All Roles\" ?>\n             </button>\n             <ul class=\"dropdown-menu dropdown-menu-right\">\n                 <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"role\" ]) ?: \"active\" ?>\" href=\"<?= route( $t->feParams->route_prefix . \"@list\" ) ?>\">\n@@ -19,7 +19,7 @@\n \n                 <?php foreach( $t->data[ 'params'][ \"roles\" ] as $index => $role ): ?>\n                     <a class=\"dropdown-item <?= isset($t->data[ 'params'][ \"role\" ]) && (int)$t->data[ 'params'][ \"role\" ] === $role[ 'id'] ? 'active' : '' ?>\" href=\"<?= route( $t->feParams->route_prefix . \"@list\" ) ?>?role=<?= $role[ 'id' ] ?>\">\n-                        <?= $role[ 'name' ] ?>\n+                        <?= $t->ee( $role[ 'name' ] ) ?>\n                     </a>\n                 <?php endforeach; ?>\n             </ul>"
        },
        {
          "filename": "resources/views/customer/overview.foil.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -156,7 +156,7 @@\n                     <?php if( $c->tags ): ?>\n                         <?php foreach( $c->tags as $tag ): ?>\n                             <span class=\"badge badge-secondary\">\n-                                <?= $tag->display_as ?>\n+                                <?= $t->ee( $tag->display_as ) ?>\n                             </span>\n                         <?php endforeach; ?>\n "
        },
        {
          "filename": "resources/views/customer/tag/cust.foil.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -31,11 +31,11 @@\n                                     <div class=\"form-check form-check-inline\">\n                                         <input id='tag_<?= $tag->id ?>' type='checkbox' name='tags[]' <?= $t->c->tags->contains( 'id', $tag->id ) ? 'checked' : ''  ?> value='<?= $tag->id ?>'>\n                                         <label for=\"tag_<?= $tag->id ?>\" class=\"form-check-label\">\n-                                            <?= $tag->display_as . \" (\" . $tag->tag . \")\" ?>\n+                                            <?= $t->ee( $tag->display_as ) . \" (\" . $t->ee( $tag->tag ) . \")\" ?>\n                                         </label>\n                                     </div>\n                                   <small class=\"form-text text-muted former-help-text\">\n-                                      <?= $tag->description ?>\n+                                      <?= $t->ee( $tag->description ) ?>\n                                   </small>\n                                 </div>\n                             </div>"
        },
        {
          "filename": "resources/views/log/view.foil.php",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -113,20 +113,20 @@\n                                             <tr>\n                                                 <td>\n                                                     <b>\n-                                                        <?= $key ?>\n+                                                        <?= $t->ee( $key ) ?>\n                                                     </b>\n                                                 </td>\n                                                 <?php if( $new ): ?>\n                                                     <td class=\"<?= isset( $changed[ $key ] ) ? 'tw-bg-gray-500': '' ?> \">\n-                                                        <?= $new[ $key ] ?>\n+                                                        <?= $t->ee( $new[ $key ] ) ?>\n                                                     </td>\n                                                 <?php endif; ?>\n                                                 <?php if( $old ): ?>\n                                                     <td>\n                                                         <?php if( !is_array( $old[ $key ] ) ): ?>\n-                                                            <?= $old[ $key ] ?>\n+                                                            <?= $t->ee( $old[ $key ] ) ?>\n                                                         <?php else: ?>\n-                                                            <?= json_encode($old[ $key ], JSON_THROW_ON_ERROR) ?>\n+                                                            <?= json_encode($old[ $key ], JSON_HEX_QUOT|JSON_HEX_TAG|JSON_HEX_AMP|JSON_HEX_APOS|JSON_THROW_ON_ERROR) ?>\n                                                         <?php endif; ?>\n                                                     </td>\n                                                 <?php endif; ?>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dd4d44afc3a5b1964ef1655e39cf2446f3e9f0a5",
            "date": "2025-01-09T20:21:54Z",
            "author_login": "barryo"
          },
          {
            "sha": "33e50945043ca2bd5d5cb0c8ab8561570fd98a8d",
            "date": "2025-01-07T15:11:04Z",
            "author_login": "nickhilliard"
          },
          {
            "sha": "5c969658b206cf5e4da37477bf19ddfd7087b085",
            "date": "2024-11-02T12:07:25Z",
            "author_login": "barryo"
          },
          {
            "sha": "9bdce995cfa092bad63a225364b0de4b9c0a73e5",
            "date": "2024-11-02T12:06:38Z",
            "author_login": "barryo"
          },
          {
            "sha": "f63b8cd7881aaeddd46bbf172c62dda4142581c8",
            "date": "2024-11-02T12:06:26Z",
            "author_login": "barryo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "INEX IXP-Manager before 6.3.1 allows XSS. list-preamble.foil.php, page-header-preamble.foil.php, edit-form.foil.php, page-header-preamble.foil.php, overview.foil.php, cust.foil.php, and view.foil.php may be affected.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-06-25T22:15:21.527",
    "last_modified": "2024-11-21T08:10:16.697",
    "fix_date": "2023-06-20T07:49:45Z"
  },
  "references": [
    {
      "url": "https://github.com/inex/IXP-Manager/commit/fddbc38adb477c9cd46a462655ffed96d3d42229",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inex/IXP-Manager/compare/v6.3.0...v6.3.1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inex/IXP-Manager/commit/fddbc38adb477c9cd46a462655ffed96d3d42229",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/inex/IXP-Manager/compare/v6.3.0...v6.3.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:01.864109",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "IXP-Manager",
    "owner": "inex",
    "created_at": "2011-05-24T15:36:58Z",
    "updated_at": "2025-01-09T20:21:57Z",
    "pushed_at": "2025-01-09T20:21:54Z",
    "size": 51919,
    "stars": 384,
    "forks": 165,
    "open_issues": 63,
    "watchers": 384,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release-v2",
      "release-v3",
      "release-v4",
      "release-v5",
      "release-v6",
      "release-v7"
    ],
    "languages": {
      "PHP": 6421792,
      "Shell": 214847,
      "Perl": 53128,
      "Blade": 51974,
      "JavaScript": 41120,
      "Hack": 34556,
      "CSS": 12126,
      "SCSS": 9671,
      "Dockerfile": 5782,
      "Ruby": 3123,
      "Vue": 565
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:14:38.446995"
  }
}