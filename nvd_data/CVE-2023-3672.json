{
  "cve_id": "CVE-2023-3672",
  "github_data": {
    "repository": "plaidweb/webmention.js",
    "fix_commit": "3551b66b3e40da37fee89ecf72930c5efdc53011",
    "related_commits": [
      "3551b66b3e40da37fee89ecf72930c5efdc53011",
      "3551b66b3e40da37fee89ecf72930c5efdc53011"
    ],
    "patch_url": "https://github.com/plaidweb/webmention.js/commit/3551b66b3e40da37fee89ecf72930c5efdc53011.patch",
    "fix_commit_details": {
      "sha": "3551b66b3e40da37fee89ecf72930c5efdc53011",
      "commit_date": "2023-07-13T18:46:32Z",
      "author": {
        "login": "fluffy-critter",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "XSS mitigation",
        "length": 279,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 9,
        "deletions": 7
      },
      "files": [
        {
          "filename": "static/webmention.js",
          "status": "modified",
          "additions": 7,
          "deletions": 5,
          "patch": "@@ -188,10 +188,12 @@ A more detailed example:\n    * @returns {string}\n    */\n   function entities(text) {\n-    return text.replace(/&/g, \"&amp;\")\n-      .replace(/</g, \"&lt;\")\n-      .replace(/>/g, \"&gt;\")\n-      .replace(/\"/g, \"&quot;\");\n+    return text.replace(/[&<>\"]/g, (tag) => ({\n+      '&': '&amp;',\n+      '<': '&lt;',\n+      '>': '&gt;',\n+      '\"': '&quot;',\n+    }[tag] || tag));\n   }\n \n   /**\n@@ -327,7 +329,7 @@ A more detailed example:\n         let linktext = `(${t(\"mention\")})`;\n         if (c.name) {\n           linkclass = \"name\";\n-          linktext = c.name;\n+          linktext = entities(c.name);\n         } else if (c.content && c.content.text) {\n           linkclass = \"text\";\n           linktext = extractComment(c);"
        },
        {
          "filename": "static/webmention.min.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,3 +1,3 @@\n // @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt\n-!function(){\"use strict\";window.i18next=window.i18next||{t:function(n){return n}};const n=window.i18next.t.bind(window.i18next);function e(n,e){return document.currentScript.getAttribute(\"data-\"+n)||e}const t=e(\"page-url\",window.location.href.replace(/#.*$/,\"\")),o=e(\"add-urls\",void 0),r=e(\"id\",\"webmentions\"),s=e(\"wordcount\"),i=e(\"max-webmentions\",30),l=e(\"prevent-spoofing\")?\"wm-source\":\"url\",a=e(\"sort-by\",\"published\"),c=e(\"sort-dir\",\"up\"),u=e(\"comments-are-reactions\",!1),p={\"in-reply-to\":n(\"replied\"),\"like-of\":n(\"liked\"),\"repost-of\":n(\"reposted\"),\"bookmark-of\":n(\"bookmarked\"),\"mention-of\":n(\"mentioned\"),rsvp:n(\"RSVPed\"),\"follow-of\":n(\"followed\")},f={\"in-reply-to\":\"\ud83d\udcac\",\"like-of\":\"\u2764\ufe0f\",\"repost-of\":\"\ud83d\udd04\",\"bookmark-of\":\"\u2b50\ufe0f\",\"mention-of\":\"\ud83d\udcac\",rsvp:\"\ud83d\udcc5\",\"follow-of\":\"\ud83d\udc1c\"},m={yes:\"\u2705\",no:\"\u274c\",interested:\"\ud83d\udca1\",maybe:\"\ud83d\udcad\"};function d(n){return n.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")}function w(e,t){const o=d(e.author?.name||e.url.split(\"/\")[2]);let r=p[e[\"wm-property\"]]||n(\"reacted\");!t&&e.content&&e.content.text&&(r+=\": \"+x(e));let s=\"\";s=e.author&&e.author.photo?`\\n        <img\\n          src=\"${d(e.author.photo)}\"\\n          loading=\"lazy\"\\n          decoding=\"async\"\\n          alt=\"${o}\"\\n        >\\n      `:`\\n        <img\\n          class=\"missing\"\\n          src=\"data:image/webp;base64,UklGRkoCAABXRUJQVlA4TD4CAAAvP8APAIV0WduUOLr/m/iqY6SokDJSMD5xYX23SQizRsVdZmIj/f6goYUbiOj/BED7MOPReuBNT3vBesSzIex+SeqMFFkjebFmzH3S7POxDSJ1yaCbCmMnS2R46cRMPyQLw4GBK4esdK60pYwsZakecUCl5zsHv/5cPH08nx9/7i6rEEVCg2hR8VSd30PxMZpVoJZQO6Dixgg6X5oKFCmlVHIDmmMFShWumAXgCuyqVN8hHff/k+9fj8+ei7BVjpxBmZCUJv+6DhWGZwWvs+UoLHFCKsPYpfJtIcEXBTopEEsKwedZUv4ku1FZErKULLyQwFGgnmTs2vBD5qu44xwnG9uyjgrFOd+KRVlXyQfwQlauydaU6AVI7OjKXLUEqNtxJBmQegNDZgV7lxxqYMOMrDyC1NdAGbdiH9Ij0skjG+oTyfO0lmjdgvoH8iIgreuBMRYLSH+R3sAztXgL+XfS7E2bmfo6gnS0TrpnzHT7kL+skj7PgHuBwv/zpN8LDLQg7zfJZLBubMKnyeh6ZGyfDEfc2LYpnlUtG7JqsSHq1WoASbUS4KVaLwB8be5mfsGMDwBcm5VxbuxWxx3nkFanB6lYqsqSkOGkKicoDvXsneR7BkKU7DtaEuT7+pxBGVwx+9gVyqf2pVA9sC2CsmjZ1RJqEJHS4Tj/pCcS0JoyBYOsB91Xjh3OFfQPQhvCAYyeLJlaOoFp0XNNuD0BC8exr8uPx7D1JWkwFdZIXmD3MOPReuDNzHjBesSzIbQD\"\\n          alt=\"${o}$\"\\n        >\\n      `;let i=\"\";return e.rsvp&&m[e.rsvp]&&(i=`<sub>${m[e.rsvp]}</sub>`),`\\n      <a\\n        class=\"reaction\"\\n        rel=\"nofollow ugc\"\\n        title=\"${o} ${r}\"\\n        href=\"${e[l]}\"\\n      >\\n        ${s}\\n        ${f[e[\"wm-property\"]]||\"\ud83d\udca5\"}\\n        ${i}\\n      </a>\\n    `}function h(n){return n.substr(n.indexOf(\"//\"))}function g(n){const e=[],t={};return n.forEach((function(n){const o=h(n.url);t[o]||(e.push(n),t[o]=!0)})),e}function x(n){let e=d(n.content.text);if(s){let n=e.replace(/\\s+/g,\" \").split(\" \",s+1);n.length>s&&(n[s-1]+=\"&hellip;\",n=n.slice(0,s),e=n.join(\" \"))}return e}window.addEventListener(\"load\",(async function(){const e=document.getElementById(r);if(!e)return;const s=[h(t)];o&&o.split(\"|\").forEach((function(n){s.push(h(n))}));let p=`https://webmention.io/api/mentions.jf2?per-page=${i}&sort-by=${a}&sort-dir=${c}`;s.forEach((function(n){p+=`&target[]=${encodeURIComponent(\"http:\"+n)}&target[]=${encodeURIComponent(\"https:\"+n)}`}));let f={};try{const n=await window.fetch(p);n.status>=200&&n.status<300?f=await n.json():(console.error(\"Could not parse response\"),new Error(n.statusText))}catch(n){console.error(\"Request failed\",n)}let m=[];const $=[];u&&(m=$);const y={\"in-reply-to\":m,\"like-of\":$,\"repost-of\":$,\"bookmark-of\":$,\"follow-of\":$,\"mention-of\":m,rsvp:m};f.children.forEach((function(n){const e=y[n[\"wm-property\"]];e&&e.push(n)}));let b=\"\";m.length>0&&m!==$&&(b=function(e){return`\\n      <h2>${n(\"Responses\")}</h2>\\n      <ul class=\"comments\">${e.map((e=>{const t=w(e,!0);let o=d(e.url.split(\"/\")[2]);e.author&&e.author.name&&(o=d(e.author.name));const r=`<a class=\"source\" rel=\"nofollow ugc\" href=\"${e[l]}\">${o}</a>`;let s=\"name\",i=`(${n(\"mention\")})`;return e.name?(s=\"name\",i=e.name):e.content&&e.content.text&&(s=\"text\",i=x(e)),`<li>${t} ${r} <span class=\"${s}\">${i}</span></li>`})).join(\"\")}</ul>\\n    `}(g(m)));let k=\"\";var B;$.length>0&&(B=g($),k=`\\n      <h2>${n(\"Reactions\")}</h2>\\n      <ul class=\"reacts\">${B.map((n=>w(n))).join(\"\")}</ul>\\n    `),e.innerHTML=`${b}${k}`}))}();\n+!function(){\"use strict\";window.i18next=window.i18next||{t:function(n){return n}};const n=window.i18next.t.bind(window.i18next);function t(n,t){return document.currentScript.getAttribute(\"data-\"+n)||t}const e=t(\"page-url\",window.location.href.replace(/#.*$/,\"\")),o=t(\"add-urls\",void 0),r=t(\"id\",\"webmentions\"),s=t(\"wordcount\"),i=t(\"max-webmentions\",30),l=t(\"prevent-spoofing\")?\"wm-source\":\"url\",a=t(\"sort-by\",\"published\"),c=t(\"sort-dir\",\"up\"),u=t(\"comments-are-reactions\",!1),p={\"in-reply-to\":n(\"replied\"),\"like-of\":n(\"liked\"),\"repost-of\":n(\"reposted\"),\"bookmark-of\":n(\"bookmarked\"),\"mention-of\":n(\"mentioned\"),rsvp:n(\"RSVPed\"),\"follow-of\":n(\"followed\")},f={\"in-reply-to\":\"\ud83d\udcac\",\"like-of\":\"\u2764\ufe0f\",\"repost-of\":\"\ud83d\udd04\",\"bookmark-of\":\"\u2b50\ufe0f\",\"mention-of\":\"\ud83d\udcac\",rsvp:\"\ud83d\udcc5\",\"follow-of\":\"\ud83d\udc1c\"},m={yes:\"\u2705\",no:\"\u274c\",interested:\"\ud83d\udca1\",maybe:\"\ud83d\udcad\"};function d(n){return n.replace(/[&<>\"]/g,(n=>({\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\"}[n]||n)))}function w(t,e){const o=d(t.author?.name||t.url.split(\"/\")[2]);let r=p[t[\"wm-property\"]]||n(\"reacted\");!e&&t.content&&t.content.text&&(r+=\": \"+x(t));let s=\"\";s=t.author&&t.author.photo?`\\n        <img\\n          src=\"${d(t.author.photo)}\"\\n          loading=\"lazy\"\\n          decoding=\"async\"\\n          alt=\"${o}\"\\n        >\\n      `:`\\n        <img\\n          class=\"missing\"\\n          src=\"data:image/webp;base64,UklGRkoCAABXRUJQVlA4TD4CAAAvP8APAIV0WduUOLr/m/iqY6SokDJSMD5xYX23SQizRsVdZmIj/f6goYUbiOj/BED7MOPReuBNT3vBesSzIex+SeqMFFkjebFmzH3S7POxDSJ1yaCbCmMnS2R46cRMPyQLw4GBK4esdK60pYwsZakecUCl5zsHv/5cPH08nx9/7i6rEEVCg2hR8VSd30PxMZpVoJZQO6Dixgg6X5oKFCmlVHIDmmMFShWumAXgCuyqVN8hHff/k+9fj8+ei7BVjpxBmZCUJv+6DhWGZwWvs+UoLHFCKsPYpfJtIcEXBTopEEsKwedZUv4ku1FZErKULLyQwFGgnmTs2vBD5qu44xwnG9uyjgrFOd+KRVlXyQfwQlauydaU6AVI7OjKXLUEqNtxJBmQegNDZgV7lxxqYMOMrDyC1NdAGbdiH9Ij0skjG+oTyfO0lmjdgvoH8iIgreuBMRYLSH+R3sAztXgL+XfS7E2bmfo6gnS0TrpnzHT7kL+skj7PgHuBwv/zpN8LDLQg7zfJZLBubMKnyeh6ZGyfDEfc2LYpnlUtG7JqsSHq1WoASbUS4KVaLwB8be5mfsGMDwBcm5VxbuxWxx3nkFanB6lYqsqSkOGkKicoDvXsneR7BkKU7DtaEuT7+pxBGVwx+9gVyqf2pVA9sC2CsmjZ1RJqEJHS4Tj/pCcS0JoyBYOsB91Xjh3OFfQPQhvCAYyeLJlaOoFp0XNNuD0BC8exr8uPx7D1JWkwFdZIXmD3MOPReuDNzHjBesSzIbQD\"\\n          alt=\"${o}$\"\\n        >\\n      `;let i=\"\";return t.rsvp&&m[t.rsvp]&&(i=`<sub>${m[t.rsvp]}</sub>`),`\\n      <a\\n        class=\"reaction\"\\n        rel=\"nofollow ugc\"\\n        title=\"${o} ${r}\"\\n        href=\"${t[l]}\"\\n      >\\n        ${s}\\n        ${f[t[\"wm-property\"]]||\"\ud83d\udca5\"}\\n        ${i}\\n      </a>\\n    `}function h(n){return n.substr(n.indexOf(\"//\"))}function g(n){const t=[],e={};return n.forEach((function(n){const o=h(n.url);e[o]||(t.push(n),e[o]=!0)})),t}function x(n){let t=d(n.content.text);if(s){let n=t.replace(/\\s+/g,\" \").split(\" \",s+1);n.length>s&&(n[s-1]+=\"&hellip;\",n=n.slice(0,s),t=n.join(\" \"))}return t}window.addEventListener(\"load\",(async function(){const t=document.getElementById(r);if(!t)return;const s=[h(e)];o&&o.split(\"|\").forEach((function(n){s.push(h(n))}));let p=`https://webmention.io/api/mentions.jf2?per-page=${i}&sort-by=${a}&sort-dir=${c}`;s.forEach((function(n){p+=`&target[]=${encodeURIComponent(\"http:\"+n)}&target[]=${encodeURIComponent(\"https:\"+n)}`}));let f={};try{const n=await window.fetch(p);n.status>=200&&n.status<300?f=await n.json():(console.error(\"Could not parse response\"),new Error(n.statusText))}catch(n){console.error(\"Request failed\",n)}let m=[];const $=[];u&&(m=$);const y={\"in-reply-to\":m,\"like-of\":$,\"repost-of\":$,\"bookmark-of\":$,\"follow-of\":$,\"mention-of\":m,rsvp:m};f.children.forEach((function(n){const t=y[n[\"wm-property\"]];t&&t.push(n)}));let b=\"\";m.length>0&&m!==$&&(b=function(t){return`\\n      <h2>${n(\"Responses\")}</h2>\\n      <ul class=\"comments\">${t.map((t=>{const e=w(t,!0);let o=d(t.url.split(\"/\")[2]);t.author&&t.author.name&&(o=d(t.author.name));const r=`<a class=\"source\" rel=\"nofollow ugc\" href=\"${t[l]}\">${o}</a>`;let s=\"name\",i=`(${n(\"mention\")})`;return t.name?(s=\"name\",i=d(t.name)):t.content&&t.content.text&&(s=\"text\",i=x(t)),`<li>${e} ${r} <span class=\"${s}\">${i}</span></li>`})).join(\"\")}</ul>\\n    `}(g(m)));let k=\"\";var B;$.length>0&&(B=g($),k=`\\n      <h2>${n(\"Reactions\")}</h2>\\n      <ul class=\"reacts\">${B.map((n=>w(n))).join(\"\")}</ul>\\n    `),t.innerHTML=`${b}${k}`}))}();\n // @license-end\n\\ No newline at end of file"
        },
        {
          "filename": "tests/xss-test.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n <meta charset=\"utf-8\">\n <title>XSS test</title>\n <link rel=\"stylesheet\" href=\"../static/webmention.css\">\n-<script src=\"../static/webmention.js\" data-page-url=\"https://beesbuzz.biz/blog/chatter/4201-Just-testing-something-on-webmention-io\" async></script>\n+<script src=\"../static/webmention.js\" data-page-url=\"https://warez.beesbuzz.biz/static/webmention-xss-test.html\" async></script>\n </head>\n <body>\n     <div id=\"webmentions\">hello</div>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1a29caac103cf45ecd850b0b4f62a6f01381d1aa",
            "date": "2024-01-27T20:32:05Z",
            "author_login": "fluffy-critter"
          },
          {
            "sha": "ae2baf886fcc6a699f15a8b4314a02f9f15c8aa5",
            "date": "2023-07-13T19:05:12Z",
            "author_login": "fluffy-critter"
          },
          {
            "sha": "11e9a78462216d5298ebc86b3777a15b81285618",
            "date": "2023-07-13T18:52:02Z",
            "author_login": "fluffy-critter"
          },
          {
            "sha": "3551b66b3e40da37fee89ecf72930c5efdc53011",
            "date": "2023-07-13T18:46:32Z",
            "author_login": "fluffy-critter"
          },
          {
            "sha": "94ef4cc5d82656297427878ecf354555333bbaa5",
            "date": "2023-07-12T18:32:25Z",
            "author_login": "fluffy-critter"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - DOM in GitHub repository plaidweb/webmention.js prior to 0.5.5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-14T10:15:08.920",
    "last_modified": "2024-11-21T08:17:48.310",
    "fix_date": "2023-07-13T18:46:32Z"
  },
  "references": [
    {
      "url": "https://github.com/plaidweb/webmention.js/commit/3551b66b3e40da37fee89ecf72930c5efdc53011",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/75cfb7ad-a75f-45ff-8688-32a9c55179aa",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/plaidweb/webmention.js/commit/3551b66b3e40da37fee89ecf72930c5efdc53011",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/75cfb7ad-a75f-45ff-8688-32a9c55179aa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.242583",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "webmention.js",
    "owner": "plaidweb",
    "created_at": "2019-07-09T22:42:47Z",
    "updated_at": "2024-12-31T18:33:25Z",
    "pushed_at": "2024-01-27T20:32:05Z",
    "size": 110,
    "stars": 119,
    "forks": 17,
    "open_issues": 8,
    "watchers": 119,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 13286,
      "HTML": 1439,
      "CSS": 1231
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T20:55:53.165566"
  }
}