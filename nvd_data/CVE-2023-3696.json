{
  "cve_id": "CVE-2023-3696",
  "github_data": {
    "repository": "automattic/mongoose",
    "fix_commit": "305ce4ff789261df7e3f6e72363d0703e025f80d",
    "related_commits": [
      "305ce4ff789261df7e3f6e72363d0703e025f80d",
      "305ce4ff789261df7e3f6e72363d0703e025f80d"
    ],
    "patch_url": "https://github.com/automattic/mongoose/commit/305ce4ff789261df7e3f6e72363d0703e025f80d.patch",
    "fix_commit_details": {
      "sha": "305ce4ff789261df7e3f6e72363d0703e025f80d",
      "commit_date": "2023-07-09T00:10:42Z",
      "author": {
        "login": "vkarpov15",
        "type": "User",
        "stats": {
          "total_commits": 27427,
          "average_weekly_commits": 35.52720207253886,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 557
        }
      },
      "commit_message": {
        "title": "fix: avoid prototype pollution on init",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 22,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/document.js",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -740,6 +740,10 @@ function init(self, obj, doc, opts, prefix) {\n \n   function _init(index) {\n     i = keys[index];\n+    // avoid prototype pollution\n+    if (i === '__proto__' || i === 'constructor') {\n+      return;\n+    }\n     path = prefix + i;\n     schemaType = docSchema.path(path);\n "
        },
        {
          "filename": "test/document.test.js",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -12278,6 +12278,24 @@ describe('document', function() {\n     assert.equal(fromDb.obj.subArr.length, 1);\n     assert.equal(fromDb.obj.subArr[0].str, 'subArr.test1');\n   });\n+\n+  it('avoids prototype pollution on init', async function() {\n+    const Example = db.model('Example', new Schema({ hello: String }));\n+\n+    const example = await new Example({ hello: 'world!' }).save();\n+    await Example.findByIdAndUpdate(example._id, {\n+      $rename: {\n+        hello: '__proto__.polluted'\n+      }\n+    });\n+\n+    // this is what causes the pollution\n+    await Example.find();\n+\n+    const test = {};\n+    assert.strictEqual(test.polluted, undefined);\n+    assert.strictEqual(Object.prototype.polluted, undefined);\n+  });\n });\n \n describe('Check if instance function that is supplied in schema option is availabe', function() {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5af0a109fcf206eb765c02e0fffe54a78ab95174",
            "date": "2025-01-13T22:38:49Z",
            "author_login": "vkarpov15"
          },
          {
            "sha": "a42d8f5e3b8a6c2abd7d32c15b0cc5edac928d4e",
            "date": "2025-01-13T22:32:17Z",
            "author_login": "vkarpov15"
          },
          {
            "sha": "73e81abe3ec012f8255d3ca9978594075378faf4",
            "date": "2025-01-13T22:21:35Z",
            "author_login": "vkarpov15"
          },
          {
            "sha": "4fe9a904e3c2184ce6d01d9c3c8f3b239616f155",
            "date": "2025-01-13T22:16:29Z",
            "author_login": "vkarpov15"
          },
          {
            "sha": "e59e342e5d01bfeee31c5d5c796745315ecf0fa9",
            "date": "2025-01-13T22:11:13Z",
            "author_login": "vkarpov15"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-1321",
    "description": "Prototype Pollution in GitHub repository automattic/mongoose prior to 7.3.4.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-17T01:15:08.850",
    "last_modified": "2024-11-21T08:17:51.880",
    "fix_date": "2023-07-09T00:10:42Z"
  },
  "references": [
    {
      "url": "https://github.com/automattic/mongoose/commit/305ce4ff789261df7e3f6e72363d0703e025f80d",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/1eef5a72-f6ab-4f61-b31d-fc66f5b4b467",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/automattic/mongoose/commit/305ce4ff789261df7e3f6e72363d0703e025f80d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/1eef5a72-f6ab-4f61-b31d-fc66f5b4b467",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.247225",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mongoose",
    "owner": "automattic",
    "created_at": "2010-04-06T21:39:05Z",
    "updated_at": "2025-01-14T10:43:22Z",
    "pushed_at": "2025-01-13T22:41:56Z",
    "size": 135443,
    "stars": 27030,
    "forks": 3854,
    "open_issues": 227,
    "watchers": 27030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 4251126,
      "TypeScript": 230530,
      "Pug": 6147,
      "HTML": 122
    },
    "commit_activity": {
      "total_commits_last_year": 3065,
      "avg_commits_per_week": 58.94230769230769,
      "days_active_last_year": 262
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:19:59.729025"
  }
}