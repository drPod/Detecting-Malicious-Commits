{
  "cve_id": "CVE-2023-37266",
  "github_data": {
    "repository": "IceWhaleTech/CasaOS",
    "fix_commit": "705bf1facbffd2ca40b159b0303132b6fdf657ad",
    "related_commits": [
      "705bf1facbffd2ca40b159b0303132b6fdf657ad",
      "705bf1facbffd2ca40b159b0303132b6fdf657ad"
    ],
    "patch_url": "https://github.com/IceWhaleTech/CasaOS/commit/705bf1facbffd2ca40b159b0303132b6fdf657ad.patch",
    "fix_commit_details": {
      "sha": "705bf1facbffd2ca40b159b0303132b6fdf657ad",
      "commit_date": "2023-04-26T08:00:43Z",
      "author": {
        "login": "LinkLeong",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update jwt (#1025)",
        "length": 18,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 70,
        "additions": 41,
        "deletions": 29
      },
      "files": [
        {
          "filename": "go.mod",
          "status": "modified",
          "additions": 8,
          "deletions": 8,
          "patch": "@@ -4,7 +4,7 @@ go 1.20\n \n require (\n \tgithub.com/Curtis-Milo/nat-type-identifier-go v0.0.0-20220215191915-18d42168c63d\n-\tgithub.com/IceWhaleTech/CasaOS-Common v0.4.3\n+\tgithub.com/IceWhaleTech/CasaOS-Common v0.4.4-alpha4\n \tgithub.com/coreos/go-systemd v0.0.0-20191104093116-d3cd4ed1dbcf\n \tgithub.com/deckarep/golang-set/v2 v2.3.0\n \tgithub.com/deepmap/oapi-codegen v1.12.4\n@@ -41,10 +41,10 @@ require (\n \tgithub.com/tidwall/gjson v1.14.4\n \tgo.uber.org/goleak v1.2.1\n \tgo.uber.org/zap v1.24.0\n-\tgolang.org/x/crypto v0.7.0\n+\tgolang.org/x/crypto v0.8.0\n \tgolang.org/x/oauth2 v0.6.0\n \tgolang.org/x/sync v0.1.0\n-\tgolang.org/x/sys v0.6.0\n+\tgolang.org/x/sys v0.7.0\n \tgorm.io/gorm v1.24.6\n \tgotest.tools v2.2.0+incompatible\n )\n@@ -87,12 +87,12 @@ require (\n \tgithub.com/jinzhu/inflection v1.0.0 // indirect\n \tgithub.com/jinzhu/now v1.1.5 // indirect\n \tgithub.com/josharian/intern v1.0.0 // indirect\n-\tgithub.com/klauspost/compress v1.16.3 // indirect\n+\tgithub.com/klauspost/compress v1.16.5 // indirect\n \tgithub.com/klauspost/cpuid/v2 v2.2.4 // indirect\n \tgithub.com/klauspost/pgzip v1.2.5 // indirect\n \tgithub.com/kr/pretty v0.3.1 // indirect\n \tgithub.com/labstack/gommon v0.4.0 // indirect\n-\tgithub.com/leodido/go-urn v1.2.2 // indirect\n+\tgithub.com/leodido/go-urn v1.2.3 // indirect\n \tgithub.com/lufia/plan9stats v0.0.0-20230110061619-bbe2e5e100de // indirect\n \tgithub.com/mailru/easyjson v0.7.7 // indirect\n \tgithub.com/mattn/go-colorable v0.1.13 // indirect\n@@ -119,12 +119,12 @@ require (\n \tgithub.com/xi2/xz v0.0.0-20171230120015-48954b6210f8 // indirect\n \tgithub.com/yusufpapurcu/wmi v1.2.2 // indirect\n \tgo.uber.org/atomic v1.10.0 // indirect\n-\tgo.uber.org/multierr v1.10.0 // indirect\n+\tgo.uber.org/multierr v1.11.0 // indirect\n \tgolang.org/x/arch v0.3.0 // indirect\n \tgolang.org/x/exp v0.0.0-20220303212507-bbda1eaf7a17 // indirect\n \tgolang.org/x/image v0.6.0 // indirect\n-\tgolang.org/x/net v0.8.0 // indirect\n-\tgolang.org/x/text v0.8.0 // indirect\n+\tgolang.org/x/net v0.9.0 // indirect\n+\tgolang.org/x/text v0.9.0 // indirect\n \tgolang.org/x/time v0.3.0 // indirect\n \tgoogle.golang.org/appengine v1.6.7 // indirect\n \tgoogle.golang.org/protobuf v1.30.0 // indirect"
        },
        {
          "filename": "go.sum",
          "status": "modified",
          "additions": 17,
          "deletions": 16,
          "patch": "@@ -1,7 +1,7 @@\n github.com/Curtis-Milo/nat-type-identifier-go v0.0.0-20220215191915-18d42168c63d h1:62lEBImTxZ83pgzywgDNIrPPuQ+j4ep9QjqrWBn1hrU=\n github.com/Curtis-Milo/nat-type-identifier-go v0.0.0-20220215191915-18d42168c63d/go.mod h1:lW9x+yEjqKdPbE3+cf2fGPJXCw/hChX3Omi9QHTLFsQ=\n-github.com/IceWhaleTech/CasaOS-Common v0.4.3 h1:sYsWYhP5EyksH6D0BDv8secIRGAKUZZDTIKqACdFZQ4=\n-github.com/IceWhaleTech/CasaOS-Common v0.4.3/go.mod h1:zLzM1RhoBRDdW7DFlEoPq18OhbJYsvc8yFodW0bm/QI=\n+github.com/IceWhaleTech/CasaOS-Common v0.4.4-alpha4 h1:KIMQL8fumAczZEsd7uC7n2NUzBYUC4DntRc8usSxGq8=\n+github.com/IceWhaleTech/CasaOS-Common v0.4.4-alpha4/go.mod h1:2IuYyy5qW1BE6jqC6M+tOU+WtUec1K565rLATBJ9p/0=\n github.com/RaveNoX/go-jsoncommentstrip v1.0.0/go.mod h1:78ihd09MekBnJnxpICcwzCMzGrKSKYe4AqU6PDYYpjk=\n github.com/andybalholm/brotli v1.0.1/go.mod h1:loMXtMfwqflxFJPmdbJO0a3KNoPuLBgiu3qAvBg8x/Y=\n github.com/andybalholm/brotli v1.0.5 h1:8uQZIdzKmjc/iuPu7O2ioW48L81FgatrcpfFmiq/cCs=\n@@ -169,8 +169,8 @@ github.com/json-iterator/go v1.1.12/go.mod h1:e30LSqwooZae/UwlEbR2852Gd8hjQvJoHm\n github.com/juju/gnuflag v0.0.0-20171113085948-2ce1bb71843d/go.mod h1:2PavIy+JPciBPrBUjwbNvtwB6RQlve+hkpll6QSNmOE=\n github.com/klauspost/compress v1.4.1/go.mod h1:RyIbtBH6LamlWaDj8nUwkbUhJ87Yi3uG0guNDohfE1A=\n github.com/klauspost/compress v1.11.4/go.mod h1:aoV0uJVorq1K+umq18yTdKaF57EivdYsUV+/s2qKfXs=\n-github.com/klauspost/compress v1.16.3 h1:XuJt9zzcnaz6a16/OU53ZjWp/v7/42WcR5t2a0PcNQY=\n-github.com/klauspost/compress v1.16.3/go.mod h1:ntbaceVETuRiXiv4DpjP66DpAtAGkEQskQzEyD//IeE=\n+github.com/klauspost/compress v1.16.5 h1:IFV2oUNUzZaz+XyusxpLzpzS8Pt5rh0Z16For/djlyI=\n+github.com/klauspost/compress v1.16.5/go.mod h1:ntbaceVETuRiXiv4DpjP66DpAtAGkEQskQzEyD//IeE=\n github.com/klauspost/cpuid v1.2.0/go.mod h1:Pj4uuM528wm8OyEC2QMXAi2YiTZ96dNQPGgoMS4s3ek=\n github.com/klauspost/cpuid/v2 v2.0.9/go.mod h1:FInQzS24/EEf25PyTYn52gqo7WaD8xa0213Md/qVLRg=\n github.com/klauspost/cpuid/v2 v2.2.4 h1:acbojRNwl3o09bUq+yDCtZFc1aiwaAAxtcn8YkZXnvk=\n@@ -191,8 +191,8 @@ github.com/labstack/echo/v4 v4.10.2/go.mod h1:OEyqf2//K1DFdE57vw2DRgWY0M7s65IVQO\n github.com/labstack/gommon v0.4.0 h1:y7cvthEAEbU0yHOf4axH8ZG2NH8knB9iNSoTO8dyIk8=\n github.com/labstack/gommon v0.4.0/go.mod h1:uW6kP17uPlLJsD3ijUYn3/M5bAxtlZhMI6m3MFxTMTM=\n github.com/leodido/go-urn v1.2.1/go.mod h1:zt4jvISO2HfUBqxjfIshjdMTYS56ZS/qv49ictyFfxY=\n-github.com/leodido/go-urn v1.2.2 h1:7z68G0FCGvDk646jz1AelTYNYWrTNm0bEcFAo147wt4=\n-github.com/leodido/go-urn v1.2.2/go.mod h1:kUaIbLZWttglzwNuG0pgsh5vuV6u2YcGBYz1hIPjtOQ=\n+github.com/leodido/go-urn v1.2.3 h1:6BE2vPT0lqoz3fmOesHZiaiFh7889ssCo2GMvLCfiuA=\n+github.com/leodido/go-urn v1.2.3/go.mod h1:7ZrI8mTSeBSHl/UaRyKQW1qZeMgak41ANeCNaVckg+4=\n github.com/lufia/plan9stats v0.0.0-20211012122336-39d0f177ccd0/go.mod h1:zJYVVT2jmtg6P3p1VtQj7WsuWi/y4VnjVBn7F8KPB3I=\n github.com/lufia/plan9stats v0.0.0-20230110061619-bbe2e5e100de h1:V53FWzU6KAZVi1tPp5UIsMoUWJ2/PNwYIDXnu7QuBCE=\n github.com/lufia/plan9stats v0.0.0-20230110061619-bbe2e5e100de/go.mod h1:JKx41uQRwqlTZabZc+kILPrO/3jlKnQ2Z8b7YiVw5cE=\n@@ -254,7 +254,6 @@ github.com/rogpeppe/go-internal v1.6.1/go.mod h1:xXDCJY+GAPziupqXw64V24skbSoqbTE\n github.com/rogpeppe/go-internal v1.8.0/go.mod h1:WmiCO8CzOY8rg0OYDC4/i/2WRWAB6poM+XZ2dLUbcbE=\n github.com/rogpeppe/go-internal v1.9.0 h1:73kH8U+JUqXU8lRuOHeVHaa/SZPifC7BkcraZVejAe8=\n github.com/rogpeppe/go-internal v1.9.0/go.mod h1:WtVeX8xhTBvf0smdhujwtBcq4Qrzq/fJaraNFVN+nFs=\n-github.com/rwtodd/Go.Sed v0.0.0-20210816025313-55464686f9ef/go.mod h1:8AEUvGVi2uQ5b24BIhcr0GCcpd/RNAFWaN2CJFrWIIQ=\n github.com/samber/lo v1.38.1 h1:j2XEAqXKb09Am4ebOg31SpvzUTTs6EN3VfgeLUhPdXM=\n github.com/samber/lo v1.38.1/go.mod h1:+m/ZKRl6ClXCE2Lgf3MsQlWfh4bn1bz6CXEOxnEXnEA=\n github.com/satori/go.uuid v1.2.0 h1:0uYX9dsZ2yD7q2RtLRtPSdGDWzjeM3TbMJP9utgA0ww=\n@@ -312,8 +311,8 @@ go.uber.org/atomic v1.10.0 h1:9qC72Qh0+3MqyJbAn8YU5xVq1frD8bn3JtD2oXtafVQ=\n go.uber.org/atomic v1.10.0/go.mod h1:LUxbIzbOniOlMKjJjyPfpl4v+PKK2cNJn91OQbhoJI0=\n go.uber.org/goleak v1.2.1 h1:NBol2c7O1ZokfZ0LEU9K6Whx/KnwvepVetCUhtKja4A=\n go.uber.org/goleak v1.2.1/go.mod h1:qlT2yGI9QafXHhZZLxlSuNsMw3FFLxBr+tBRlmO1xH4=\n-go.uber.org/multierr v1.10.0 h1:S0h4aNzvfcFsC3dRF1jLoaov7oRaKqRGC/pUEJ2yvPQ=\n-go.uber.org/multierr v1.10.0/go.mod h1:20+QtiLqy0Nd6FdQB9TLXag12DsQkrbs3htMFfDN80Y=\n+go.uber.org/multierr v1.11.0 h1:blXXJkSxSSfBVBlC76pxqeO+LN3aDfLQo+309xJstO0=\n+go.uber.org/multierr v1.11.0/go.mod h1:20+QtiLqy0Nd6FdQB9TLXag12DsQkrbs3htMFfDN80Y=\n go.uber.org/zap v1.24.0 h1:FiJd5l1UOLj0wCgbSE0rwwXHzEdAZS6hiiSnxJN/D60=\n go.uber.org/zap v1.24.0/go.mod h1:2kMP+WWQ8aoFoedH3T2sq6iJ2yDWpHbP0f6MQbS9Gkg=\n golang.org/x/arch v0.0.0-20210923205945-b76863e36670/go.mod h1:5om86z9Hs0C8fWVUuoMHwpExlXzs5Tkyp9hOrfG7pp8=\n@@ -324,8 +323,8 @@ golang.org/x/crypto v0.0.0-20191011191535-87dc89f01550/go.mod h1:yigFU9vqHzYiE8U\n golang.org/x/crypto v0.0.0-20200728195943-123391ffb6de/go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=\n golang.org/x/crypto v0.0.0-20210711020723-a769d52b0f97/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc=\n golang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc=\n-golang.org/x/crypto v0.7.0 h1:AvwMYaRytfdeVt3u6mLaxYtErKYjxA2OXjJ1HHq6t3A=\n-golang.org/x/crypto v0.7.0/go.mod h1:pYwdfH91IfpZVANVyUOhSIPZaFoJGxTFbZhFTx+dXZU=\n+golang.org/x/crypto v0.8.0 h1:pd9TJtTueMTVQXzk8E2XESSMQDj/U7OUu0PqJqPXQjQ=\n+golang.org/x/crypto v0.8.0/go.mod h1:mRqEX+O9/h5TFCrQhkgjo2yKi0yYA+9ecGkdQoHrywE=\n golang.org/x/exp v0.0.0-20220303212507-bbda1eaf7a17 h1:3MTrJm4PyNL9NBqvYDSj3DHl46qQakyfqfWo4jgfaEM=\n golang.org/x/exp v0.0.0-20220303212507-bbda1eaf7a17/go.mod h1:lgLbSvA5ygNOMpwM/9anMpWVlVJ7Z+cHWq/eFuinpGE=\n golang.org/x/image v0.0.0-20191009234506-e7c1f5e7dbb8/go.mod h1:FeLwcggjj3mMvU+oOTbSwawSJRM1uh48EjtB4UJZlP0=\n@@ -348,8 +347,8 @@ golang.org/x/net v0.0.0-20211029224645-99673261e6eb/go.mod h1:9nx3DQGgdP8bBQD5qx\n golang.org/x/net v0.0.0-20220722155237-a158d28d115b/go.mod h1:XRhObCWvk6IyKnWLug+ECip1KBveYUHfp+8e9klMJ9c=\n golang.org/x/net v0.0.0-20221002022538-bcab6841153b/go.mod h1:YDH+HFinaLZZlnHAfSS6ZXJJ9M9t4Dl22yv3iI2vPwk=\n golang.org/x/net v0.6.0/go.mod h1:2Tu9+aMcznHK/AK1HMvgo6xiTLG5rD5rZLDS+rp2Bjs=\n-golang.org/x/net v0.8.0 h1:Zrh2ngAOFYneWTAIAPethzeaQLuHwhuBkuV6ZiRnUaQ=\n-golang.org/x/net v0.8.0/go.mod h1:QVkue5JL9kW//ek3r6jTKnTFis1tRmNAW2P1shuFdJc=\n+golang.org/x/net v0.9.0 h1:aWJ/m6xSmxWBx+V0XRHTlrYrPG56jKsLdTFmsSsCzOM=\n+golang.org/x/net v0.9.0/go.mod h1:d48xBJpPfHeWQsugry2m+kC02ZBRGRgulfHnEXEuWns=\n golang.org/x/oauth2 v0.0.0-20180821212333-d2e6202438be/go.mod h1:N/0e6XlmueqKjAGxoOufVs8QHGRruUQn6yWY3a++T0U=\n golang.org/x/oauth2 v0.6.0 h1:Lh8GPgSKBfWSwFvtuWOfeI3aAAnbXTSutYxJiOJFgIw=\n golang.org/x/oauth2 v0.6.0/go.mod h1:ycmewcwgD4Rpr3eZJLSB4Kyyljb3qDh40vJ8STE5HKw=\n@@ -382,20 +381,22 @@ golang.org/x/sys v0.0.0-20220811171246-fbc7d0a398ab/go.mod h1:oPkhp1MJrh7nUepCBc\n golang.org/x/sys v0.0.0-20220928140112-f11e5e49a4ec/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\n golang.org/x/sys v0.2.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\n golang.org/x/sys v0.5.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\n-golang.org/x/sys v0.6.0 h1:MVltZSvRTcU2ljQOhs94SXPftV6DCNnZViHeQps87pQ=\n golang.org/x/sys v0.6.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\n+golang.org/x/sys v0.7.0 h1:3jlCCIQZPdOYu1h8BkNvLz8Kgwtae2cagcG/VamtZRU=\n+golang.org/x/sys v0.7.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\n golang.org/x/term v0.0.0-20201126162022-7de9c90e9dd1/go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=\n golang.org/x/term v0.0.0-20210927222741-03fcf44c2211/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8=\n golang.org/x/term v0.5.0/go.mod h1:jMB1sMXY+tzblOD4FWmEbocvup2/aLOaQEp7JmGp78k=\n-golang.org/x/term v0.6.0 h1:clScbb1cHjoCkyRbWwBEUZ5H/tIFu5TAXIqaZD0Gcjw=\n+golang.org/x/term v0.7.0 h1:BEvjmm5fURWqcfbSKTdpkDXYBrUS1c0m8agp14W48vQ=\n golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\n golang.org/x/text v0.3.2/go.mod h1:bEr9sfX3Q8Zfm5fL9x+3itogRgK3+ptLWKqgva+5dAk=\n golang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\n golang.org/x/text v0.3.6/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\n golang.org/x/text v0.3.7/go.mod h1:u+2+/6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ=\n golang.org/x/text v0.7.0/go.mod h1:mrYo+phRRbMaCq/xk9113O4dZlRixOauAjOtrjsXDZ8=\n-golang.org/x/text v0.8.0 h1:57P1ETyNKtuIjB4SRd15iJxuhj8Gc416Y78H3qgMh68=\n golang.org/x/text v0.8.0/go.mod h1:e1OnstbJyHTd6l/uOt8jFFHp6TRDWZR/bV3emEE/zU8=\n+golang.org/x/text v0.9.0 h1:2sjJmO8cDvYveuX97RDLsxlyUxLl+GHoLxBiRdHllBE=\n+golang.org/x/text v0.9.0/go.mod h1:e1OnstbJyHTd6l/uOt8jFFHp6TRDWZR/bV3emEE/zU8=\n golang.org/x/time v0.3.0 h1:rg5rLMjNzMS1RkNLzCG38eapWhnYLFYXDXj2gOlr8j4=\n golang.org/x/time v0.3.0/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=\n golang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ="
        },
        {
          "filename": "route/v1.go",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -1,8 +1,10 @@\n package route\n \n import (\n+\t\"crypto/ecdsa\"\n \t\"os\"\n \n+\t\"github.com/IceWhaleTech/CasaOS-Common/external\"\n \t\"github.com/IceWhaleTech/CasaOS-Common/middleware\"\n \t\"github.com/IceWhaleTech/CasaOS-Common/utils/jwt\"\n \t\"github.com/IceWhaleTech/CasaOS/pkg/config\"\n@@ -39,7 +41,11 @@ func InitV1Router() *gin.Engine {\n \tr.GET(\"/v1/recover/:type\", v1.GetRecoverStorage)\n \tv1Group := r.Group(\"/v1\")\n \n-\tv1Group.Use(jwt.ExceptLocalhost())\n+\tv1Group.Use(jwt.JWT(\n+\t\tfunc() (*ecdsa.PublicKey, error) {\n+\t\t\treturn external.GetPublicKey(config.CommonInfo.RuntimePath)\n+\t\t},\n+\t))\n \t{\n \n \t\tv1SysGroup := v1Group.Group(\"/sys\")"
        },
        {
          "filename": "route/v2.go",
          "status": "modified",
          "additions": 9,
          "deletions": 4,
          "patch": "@@ -1,6 +1,7 @@\n package route\n \n import (\n+\t\"crypto/ecdsa\"\n \t\"log\"\n \t\"net/http\"\n \t\"net/url\"\n@@ -10,9 +11,10 @@ import (\n \t\"strings\"\n \n \t\"github.com/IceWhaleTech/CasaOS/codegen\"\n+\t\"github.com/IceWhaleTech/CasaOS/pkg/config\"\n \t\"github.com/IceWhaleTech/CasaOS/pkg/utils/file\"\n \n-\t\"github.com/IceWhaleTech/CasaOS-Common/utils/common_err\"\n+\t\"github.com/IceWhaleTech/CasaOS-Common/external\"\n \t\"github.com/IceWhaleTech/CasaOS-Common/utils/jwt\"\n \tv2Route \"github.com/IceWhaleTech/CasaOS/route/v2\"\n \t\"github.com/deepmap/oapi-codegen/pkg/middleware\"\n@@ -74,11 +76,14 @@ func InitV2Router() http.Handler {\n \t\t\t// return true\n \t\t},\n \t\tParseTokenFunc: func(token string, c echo.Context) (interface{}, error) {\n-\t\t\tclaims, code := jwt.Validate(token) // TODO - needs JWT validation\n-\t\t\tif code != common_err.SUCCESS {\n+\t\t\t// claims, code := jwt.Validate(token) // TODO - needs JWT validation\n+\t\t\t// if code != common_err.SUCCESS {\n+\t\t\t// \treturn nil, echo.ErrUnauthorized\n+\t\t\t// }\n+\t\t\tvalid, claims, err := jwt.Validate(token, func() (*ecdsa.PublicKey, error) { return external.GetPublicKey(config.CommonInfo.RuntimePath) })\n+\t\t\tif err != nil || !valid {\n \t\t\t\treturn nil, echo.ErrUnauthorized\n \t\t\t}\n-\n \t\t\tc.Request().Header.Set(\"user_id\", strconv.Itoa(claims.ID))\n \n \t\t\treturn claims, nil"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ba285cb8bddb85fbd93060b3a8b944f35dd7a7ad",
            "date": "2024-12-19T03:14:15Z",
            "author_login": "Ns2Kracy"
          },
          {
            "sha": "63f01489a8e41adafae6b1bd0576b2cd242cb6d7",
            "date": "2024-12-17T07:54:54Z",
            "author_login": "Ns2Kracy"
          },
          {
            "sha": "6bbb0802aa8b55e8c133cfe04fb0a32ac5e9130b",
            "date": "2024-12-17T07:53:04Z",
            "author_login": "Ns2Kracy"
          },
          {
            "sha": "c26cf4dbecd7c33b5ace6952d42b9622d6237345",
            "date": "2024-12-17T07:23:15Z",
            "author_login": "Ns2Kracy"
          },
          {
            "sha": "958a4833857b173ebcb7a98831e2f0017d6ccbfe",
            "date": "2024-12-10T09:42:46Z",
            "author_login": "Ns2Kracy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-287",
    "description": "CasaOS is an open-source Personal Cloud system. Unauthenticated attackers can craft arbitrary JWTs and access features that usually require authentication and execute arbitrary commands as `root` on CasaOS instances. This problem was addressed by improving the validation of JWTs in commit `705bf1f`. This patch is part of CasaOS 0.4.4. Users should upgrade to CasaOS 0.4.4. If they can't, they should temporarily restrict access to CasaOS to untrusted users, for instance by not exposing it publicly.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-17T21:15:09.733",
    "last_modified": "2024-12-12T21:15:07.550",
    "fix_date": "2023-04-26T08:00:43Z"
  },
  "references": [
    {
      "url": "https://github.com/IceWhaleTech/CasaOS/commit/705bf1facbffd2ca40b159b0303132b6fdf657ad",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/IceWhaleTech/CasaOS/security/advisories/GHSA-m5q5-8mfw-p2hr",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.sonarsource.com/blog/security-vulnerabilities-in-casaos",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/IceWhaleTech/CasaOS/commit/705bf1facbffd2ca40b159b0303132b6fdf657ad",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/IceWhaleTech/CasaOS/security/advisories/GHSA-m5q5-8mfw-p2hr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.249902",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "CasaOS",
    "owner": "IceWhaleTech",
    "created_at": "2021-09-26T02:33:09Z",
    "updated_at": "2025-01-14T14:55:12Z",
    "pushed_at": "2024-12-19T03:15:47Z",
    "size": 182627,
    "stars": 28003,
    "forks": 1517,
    "open_issues": 577,
    "watchers": 28003,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 333962,
      "Shell": 34677,
      "HTML": 628,
      "Makefile": 269
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:07:03.167954"
  }
}