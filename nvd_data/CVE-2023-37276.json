{
  "cve_id": "CVE-2023-37276",
  "github_data": {
    "repository": "aio-libs/aiohttp",
    "fix_commit": "9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
    "related_commits": [
      "9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
      "9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40"
    ],
    "patch_url": "https://github.com/aio-libs/aiohttp/commit/9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40.patch",
    "fix_commit_details": {
      "sha": "9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
      "commit_date": "2023-07-18T19:45:53Z",
      "author": {
        "login": "Dreamsorcerer",
        "type": "User",
        "stats": {
          "total_commits": 756,
          "average_weekly_commits": 1.2813559322033898,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 119
        }
      },
      "commit_message": {
        "title": "Fix bump llhttp to v8.1.1 (#7367) (#7377)",
        "length": 111,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 28,
        "deletions": 2
      },
      "files": [
        {
          "filename": ".gitmodules",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n [submodule \"vendor/llhttp\"]\n     path = vendor/llhttp\n     url = https://github.com/nodejs/llhttp.git\n-    branch = v8.1.1\n+    branch = v8.x"
        },
        {
          "filename": "docs/contributing.rst",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -110,6 +110,8 @@ Install pre-commit hooks:\n \n Congratulations, you are ready to run the test suite!\n \n+.. include:: ../vendor/README.rst\n+\n \n Run autoformatter\n -----------------"
        },
        {
          "filename": "tests/test_http_parser.py",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -685,6 +685,7 @@ def test_http_response_parser_bad(response) -> None:\n         response.feed_data(b\"HTT/1\\r\\n\\r\\n\")\n \n \n+@pytest.mark.skipif(not NO_EXTENSIONS, reason=\"Behaviour has changed in C parser\")\n def test_http_response_parser_code_under_100(response) -> None:\n     msg = response.feed_data(b\"HTTP/1.1 99 test\\r\\n\\r\\n\")[0][0][0]\n     assert msg.code == 99"
        },
        {
          "filename": "vendor/README.rst",
          "status": "added",
          "additions": 23,
          "deletions": 0,
          "patch": "@@ -0,0 +1,23 @@\n+LLHTTP\n+------\n+\n+When building aiohttp from source, there is a pure Python parser used by default.\n+For better performance, you may want to build the higher performance C parser.\n+\n+To build this ``llhttp`` parser, first get/update the submodules (to update to a\n+newer release, add ``--remote`` and check the branch in ``.gitmodules``)::\n+\n+    git submodule update --init --recursive\n+\n+Then build ``llhttp``::\n+\n+    cd vendor/llhttp/\n+    npm install\n+    make\n+\n+Then build our parser::\n+\n+    cd -\n+    make cythonize\n+\n+Then you can build or install it with ``python -m build`` or ``pip install -e .``"
        },
        {
          "filename": "vendor/llhttp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Subproject commit 69d6db2008508489d19267a0dcab30602b16fc5b\n+Subproject commit 7e18596bae8f63692ded9d3250d5d984fe90dcfb"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9482755b40ce69814eea6f65bfbd4c12d1878174",
            "date": "2025-01-10T10:46:29Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "76f4309a6cbfc12d918c65b5bffdcf0d4bb691c6",
            "date": "2025-01-10T10:39:38Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c5c204f8b661bb1c9d183e17b37013ee222b2cbd",
            "date": "2025-01-10T10:37:48Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a91dc8f78e97f9be30e13c39e457e8e2a2651702",
            "date": "2025-01-08T10:27:45Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "237d46722a0e56363c4a07dcf31e73fe4c2ea392",
            "date": "2025-01-07T11:14:58Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-444",
    "description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. aiohttp v3.8.4 and earlier are bundled with llhttp v6.0.6. Vulnerable code is used by aiohttp for its HTTP request parser when available which is the default case when installing from a wheel. This vulnerability only affects users of aiohttp as an HTTP server (ie `aiohttp.Application`), you are not affected by this vulnerability if you are using aiohttp as an HTTP client library (ie `aiohttp.ClientSession`). Sending a crafted HTTP request will cause the server to misinterpret one of the HTTP header values leading to HTTP request smuggling. This issue has been addressed in version 3.8.5. Users are advised to upgrade. Users unable to upgrade can reinstall aiohttp using `AIOHTTP_NO_EXTENSIONS=1` as an environment variable to disable the llhttp HTTP request parser implementation. The pure Python implementation isn't vulnerable.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-19T20:15:10.603",
    "last_modified": "2024-11-21T08:11:22.570",
    "fix_date": "2023-07-18T19:45:53Z"
  },
  "references": [
    {
      "url": "https://github.com/aio-libs/aiohttp/blob/v3.8.4/.gitmodules",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/commit/9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-45c4-8wx5-qw6w",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/2001873",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/blob/v3.8.4/.gitmodules",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/commit/9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-45c4-8wx5-qw6w",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/2001873",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.256487",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "aiohttp",
    "owner": "aio-libs",
    "created_at": "2013-10-01T23:04:01Z",
    "updated_at": "2025-01-14T07:45:00Z",
    "pushed_at": "2025-01-13T11:21:32Z",
    "size": 31707,
    "stars": 15317,
    "forks": 2050,
    "open_issues": 250,
    "watchers": 15317,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "3.8",
      "3.9",
      "3.10",
      "3.11",
      "3.12",
      "master"
    ],
    "languages": {
      "Python": 2241563,
      "Cython": 41302,
      "Makefile": 5839,
      "Gherkin": 1248,
      "Dockerfile": 298,
      "C": 170,
      "Shell": 148
    },
    "commit_activity": {
      "total_commits_last_year": 2401,
      "avg_commits_per_week": 46.17307692307692,
      "days_active_last_year": 226
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:12:57.567310"
  }
}