{
  "cve_id": "CVE-2023-37474",
  "github_data": {
    "repository": "9001/copyparty",
    "fix_commit": "043e3c7dd683113e2b1c15cacb9c8e68f76513ff",
    "related_commits": [
      "043e3c7dd683113e2b1c15cacb9c8e68f76513ff",
      "043e3c7dd683113e2b1c15cacb9c8e68f76513ff"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "043e3c7dd683113e2b1c15cacb9c8e68f76513ff",
      "commit_date": "2023-07-14T15:55:49Z",
      "author": {
        "login": "9001",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix traversal vulnerability GHSA-pxfv-7rr3-2qjg:",
        "length": 141,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
      },
      "files": [
        {
          "filename": "copyparty/httpcli.py",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -42,6 +42,7 @@\n     Pebkac,\n     UnrecvEOF,\n     alltrace,\n+    absreal,\n     atomic_move,\n     exclude_dotfiles,\n     fsenc,\n@@ -779,7 +780,14 @@ def handle_get(self) -> bool:\n                 self.reply(b\"\", 301, headers=h)\n                 return True\n \n-            static_path = os.path.join(self.E.mod, \"web/\", self.vpath[5:])\n+            path_base = os.path.join(self.E.mod, \"web\")\n+            static_path = absreal(os.path.join(path_base, self.vpath[5:]))\n+            if not static_path.startswith(path_base):\n+                t = \"attempted path traversal [{}] => [{}]\"\n+                self.log(t.format(self.vpath, static_path), 1)\n+                self.tx_404()\n+                return False\n+\n             return self.tx_file(static_path)\n \n         if \"cf_challenge\" in self.uparam:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8e8e4ff1321f8c6bc5a943d104c4317cc2ccccf4",
            "date": "2025-01-25T18:45:50Z",
            "author_login": "9001"
          },
          {
            "sha": "1dace72092632c6ab0e36b84777a38c1da22581a",
            "date": "2025-01-25T18:09:52Z",
            "author_login": "9001"
          },
          {
            "sha": "3a5c1d9fafd7515e2dd3735bbdca2511e99efb5e",
            "date": "2025-01-25T17:49:03Z",
            "author_login": "9001"
          },
          {
            "sha": "f38c754301e50973fc3b345fba94594906c6c9a4",
            "date": "2025-01-25T17:02:41Z",
            "author_login": "9001"
          },
          {
            "sha": "fff38f484dd529d7bce09f434414ac302ff62add",
            "date": "2025-01-25T14:27:34Z",
            "author_login": "9001"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Copyparty is a portable file server. Versions prior to 1.8.2 are subject to a path traversal vulnerability detected in the `.cpr` subfolder. The Path Traversal attack technique allows an attacker access to files, directories, and commands that reside outside the web document root directory. This issue has been addressed in commit `043e3c7d` which has been included in release 1.8.2. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-14T20:15:09.083",
    "last_modified": "2024-11-21T08:11:47.207",
    "fix_date": "2023-07-14T15:55:49Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/173822/Copyparty-1.8.2-Directory-Traversal.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/9001/copyparty/commit/043e3c7dd683113e2b1c15cacb9c8e68f76513ff",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/9001/copyparty/security/advisories/GHSA-pxfv-7rr3-2qjg",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/173822/Copyparty-1.8.2-Directory-Traversal.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/9001/copyparty/commit/043e3c7dd683113e2b1c15cacb9c8e68f76513ff",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/9001/copyparty/security/advisories/GHSA-pxfv-7rr3-2qjg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.243463",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "copyparty",
    "owner": "9001",
    "created_at": "2019-05-26T15:28:33Z",
    "updated_at": "2025-01-26T05:15:09Z",
    "pushed_at": "2025-01-25T18:46:14Z",
    "size": 7643,
    "stars": 978,
    "forks": 55,
    "open_issues": 6,
    "watchers": 978,
    "has_security_policy": false,
    "default_branch": "hovudstraum",
    "protected_branches": [],
    "languages": {
      "Python": 1527527,
      "JavaScript": 632337,
      "Shell": 88692,
      "CSS": 87221,
      "HTML": 42522,
      "Nix": 11685,
      "Dockerfile": 7462,
      "Makefile": 3454,
      "PowerShell": 3102,
      "LiveScript": 3069,
      "Batchfile": 2151
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:21:20.365187"
  }
}