{
  "cve_id": "CVE-2023-37476",
  "github_data": {
    "repository": "OpenRefine/OpenRefine",
    "fix_commit": "e9c1e65d58b47aec8cd676bd5c07d97b002f205e",
    "related_commits": [
      "e9c1e65d58b47aec8cd676bd5c07d97b002f205e",
      "e9c1e65d58b47aec8cd676bd5c07d97b002f205e"
    ],
    "patch_url": "https://github.com/OpenRefine/OpenRefine/commit/e9c1e65d58b47aec8cd676bd5c07d97b002f205e.patch",
    "fix_commit_details": {
      "sha": "e9c1e65d58b47aec8cd676bd5c07d97b002f205e",
      "commit_date": "2023-07-17T06:28:52Z",
      "author": {
        "login": "wetneb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-m88m-crr9-jvqq",
        "length": 133,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 18,
        "additions": 18,
        "deletions": 0
      },
      "files": [
        {
          "filename": "main/src/com/google/refine/io/FileProjectManager.java",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -169,6 +169,9 @@ protected void untar(File destDir, InputStream inputStream) throws IOException {\n \n         while ((tarEntry = tin.getNextTarEntry()) != null) {\n             File destEntry = new File(destDir, tarEntry.getName());\n+            if (!destEntry.toPath().normalize().startsWith(destDir.toPath().normalize())) {\n+                throw new IllegalArgumentException(\"Zip archives with files escaping their root directory are not allowed.\");\n+            }\n             File parent = destEntry.getParentFile();\n \n             if (!parent.exists()) {"
        },
        {
          "filename": "main/tests/data/zip-slip.tar",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "main/tests/server/src/com/google/refine/io/FileProjectManagerTests.java",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -150,4 +150,19 @@ public void metaFileUpdateTest() throws GetProjectIDException, InterruptedExcept\n         assertEquals(timeBeforeB, timeAfterB);\n         assertNotEquals(timeBeforeA, timeAfterA);\n     }\n+\n+    @Test\n+    public void testUntarZipSlip() throws IOException {\n+        FileProjectManager manager = new FileProjectManagerStub(workspaceDir);\n+\n+        File tempDir = TestUtils.createTempDirectory(\"openrefine-project-import-zip-slip-test\");\n+        try {\n+            File subDir = new File(tempDir, \"dest\");\n+            InputStream stream = FileProjectManagerTests.class.getClassLoader().getResourceAsStream(\"zip-slip.tar\");\n+\n+            assertThrows(IllegalArgumentException.class, () -> manager.untar(subDir, stream));\n+        } finally {\n+            tempDir.delete();\n+        }\n+    }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9353d6df6b9c0554d3581a53fda972cae54370fc",
            "date": "2025-01-14T12:38:27Z",
            "author_login": "weblate"
          },
          {
            "sha": "1d48fb60530f9d7ac6c2d633a7774d70f0c18298",
            "date": "2025-01-14T07:09:22Z",
            "author_login": "thadguidry"
          },
          {
            "sha": "f353f9865a1356681bb2321f4e0bcf1e65585d43",
            "date": "2025-01-13T20:34:43Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e40d26a824272da40c0804cff25dde34e517b74f",
            "date": "2025-01-13T20:34:09Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a86836eed3f4d9e5e8e163aa40b25469ee170e43",
            "date": "2025-01-13T20:33:00Z",
            "author_login": "weblate"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-22",
    "description": " OpenRefine is a free, open source tool for data processing. A carefully crafted malicious OpenRefine project tar file can be used to trigger arbitrary code execution in the context of the OpenRefine process if a user can be convinced to import it. The vulnerability exists in all versions of OpenRefine up to and including 3.7.3. Users should update to OpenRefine 3.7.4 as soon as possible. Users unable to upgrade should only import OpenRefine projects from trusted sources.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-17T22:15:09.450",
    "last_modified": "2024-11-21T08:11:47.503",
    "fix_date": "2023-07-17T06:28:52Z"
  },
  "references": [
    {
      "url": "https://github.com/OpenRefine/OpenRefine/commit/e9c1e65d58b47aec8cd676bd5c07d97b002f205e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenRefine/OpenRefine/security/advisories/GHSA-m88m-crr9-jvqq",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/OpenRefine/OpenRefine/commit/e9c1e65d58b47aec8cd676bd5c07d97b002f205e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenRefine/OpenRefine/security/advisories/GHSA-m88m-crr9-jvqq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.250359",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "OpenRefine",
    "owner": "OpenRefine",
    "created_at": "2012-10-15T02:22:48Z",
    "updated_at": "2025-01-14T12:38:35Z",
    "pushed_at": "2025-01-14T12:38:30Z",
    "size": 404937,
    "stars": 11031,
    "forks": 1998,
    "open_issues": 659,
    "watchers": 11031,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Java": 5624322,
      "JavaScript": 1796106,
      "HTML": 680637,
      "CSS": 155170,
      "Shell": 24785,
      "Batchfile": 9507,
      "Python": 4899,
      "Inno Setup": 4432,
      "mIRC Script": 762,
      "Less": 139
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:30:34.126653"
  }
}