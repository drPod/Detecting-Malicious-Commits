{
  "cve_id": "CVE-2023-37901",
  "github_data": {
    "repository": "indico/indico",
    "fix_commit": "2ee636d318653fb1ab193803dafbfe3e371d4130",
    "related_commits": [
      "2ee636d318653fb1ab193803dafbfe3e371d4130",
      "2ee636d318653fb1ab193803dafbfe3e371d4130"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2ee636d318653fb1ab193803dafbfe3e371d4130",
      "commit_date": "2023-07-18T20:47:26Z",
      "author": {
        "login": "ThiefMaster",
        "type": "User",
        "stats": {
          "total_commits": 10456,
          "average_weekly_commits": 12.845208845208845,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 590
        }
      },
      "commit_message": {
        "title": "Fix XSS in confirmation prompts",
        "length": 133,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 28,
        "deletions": 18
      },
      "files": [
        {
          "filename": "CHANGES.rst",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -7,6 +7,17 @@ Version 3.2.6\n \n *Unreleased*\n \n+Security fixes\n+^^^^^^^^^^^^^^\n+\n+- Fix an XSS vulnerability in various confirmation prompts commonly used when deleting\n+  things. Exploitation requires someone with at least submission privileges (such as a\n+  speaker) and then rely on someone else to attempt to delete this content. However,\n+  considering that event organizers may indeed delete suspicious-looking content when\n+  encountering it, there is a non-negligible risk of such an attack to succeed. Because\n+  of this it is strongly recommended to upgrade as soon as possible (:pr:`5862`,\n+  :cve:`CVE-2023-37901`)\n+\n Internationalization\n ^^^^^^^^^^^^^^^^^^^^\n "
        },
        {
          "filename": "indico/modules/attachments/templates/_attachments.html",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -54,7 +54,7 @@\n                    data-title=\"{% trans name=attachment.title %}Remove {{ name }}?{% endtrans %}\"\n                    title=\"{% trans %}Remove{% endtrans %}\"\n                    data-confirm=\"{% trans name=attachment.title -%}\n-                       Are you sure you want to remove &quot;{{ name }}&quot;?<br>\n+                       Are you sure you want to remove &quot;{{ name }}&quot;?\n                        This will remove the attachment permanently.\n                        {%- endtrans %}\">\n                 </a>\n@@ -94,7 +94,7 @@\n                    data-title=\"{% trans name=folder.title %}Remove {{ name }}?{% endtrans %}\"\n                    title=\"{% trans %}Remove{% endtrans %}\"\n                    data-confirm=\"{% trans name=folder.title -%}\n-                       Are you sure you want to remove &quot;{{ name }}&quot;?<br>\n+                       Are you sure you want to remove &quot;{{ name }}&quot;?\n                        This will remove the folder and its contents permanently.\n                    {%- endtrans %}\">\n                 </a>"
        },
        {
          "filename": "indico/modules/categories/templates/management/base.html",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -2,7 +2,9 @@\n \n {% macro delete_category_button(category, classes=\"i-button\") %}\n     {% set confirmation_message -%}\n-        {% trans category=category.title %}Do you really want to delete the category \"{{ category }}\"?{% endtrans %}\n+        {% trans category=category.title %}\n+            Do you really want to delete the category &quot;{{ category }}&quot;?\n+        {% endtrans %}\n     {%- endset %}\n     {% if category.is_empty %}\n         {% set tooltip -%}\n@@ -16,7 +18,7 @@\n     {% endif %}\n     <a class=\"{{ classes }} icon-remove js-delete-category\"\n        title=\"{{ tooltip|forceescape }}\"\n-       data-confirm=\"{{ confirmation_message|forceescape }}\"\n+       data-confirm=\"{{ confirmation_message }}\"\n        data-title=\"{% trans %}Delete category{% endtrans %}\"\n        data-href=\"{{ url_for('categories.delete', category) }}\"\n        data-method=\"POST\"></a>"
        },
        {
          "filename": "indico/modules/events/abstracts/templates/reviewing/public.html",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -19,12 +19,10 @@ <h3 class=\"f-self-stretch js-mathjax\">\n                         {% set message %}\n                             {% trans %}Do you really want to withdraw this abstract?{% endtrans %}\n                             {% if abstract.contribution %}\n-                                <br>\n                                 {%- trans -%}\n                                     Withdrawing this abstract will permanently delete its corresponding contribution.\n                                 {%- endtrans -%}\n                             {% elif not can_manage %}\n-                                <br>\n                                 {% trans %}This operation is irreversible.{% endtrans %}\n                             {% endif %}\n                         {% endset %}"
        },
        {
          "filename": "indico/modules/events/layout/templates/_menu.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -37,7 +37,7 @@\n                          title=\"{% trans %}Remove the menu entry{% endtrans %}\"\n                          data-confirm=\"\n                             {%- if not entry.is_separator -%}\n-                                {%- trans name='&quot;%s&quot;'|format(entry.localized_title) -%}\n+                                {%- trans name='\"%s\"'|format(entry.localized_title) -%}\n                                     Are you sure you want to remove {{ name }}?\n                                 {%- endtrans -%}\n                             {% else %}"
        },
        {
          "filename": "indico/modules/events/management/templates/_action_menu.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {% macro _change_type_confirmation(type) %}\n     {% trans -%}\n-        Changing the event type to <strong>{{ type }}</strong> will change the look of the event page\n+        Changing the event type to {{ type }} will change the look of the event page\n         and may disable some features not available for the new event type.\n     {%- endtrans %}\n {% endmacro %}"
        },
        {
          "filename": "indico/modules/events/static/templates/static_sites.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@\n                         data-method=\"post\"\n                         data-href=\"{{ url_for('static_site.build', event) }}\"\n                         data-title=\"{% trans %}Build an offline copy{% endtrans %}\"\n-                        data-confirm=\"{% trans %}Are you sure you want to build an offline copy of this event?<br>Beware that it is a heavy operation, especially for large events, and it might take some time to finish.{% endtrans %}\">\n+                        data-confirm=\"{% trans %}Are you sure you want to build an offline copy of this event? Beware that it is a heavy operation, especially for large events, and it might take some time to finish.{% endtrans %}\">\n                     {%- trans %}Build offline copy{% endtrans -%}\n                 </button>\n             </div>"
        },
        {
          "filename": "indico/modules/events/surveys/templates/management/survey.html",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -194,8 +194,10 @@ <h2>\n             {% set data_confirm %}\n                 {% trans %}Are you sure you want to remove this submission?{% endtrans %}\n                 {% if submission.is_anonymous %}\n-                    <br><br>\n-                    {% trans %}Note: Authenticated users will not be able to submit an anonymous survey again even if you delete their submission.{% endtrans %}\n+                    {% trans %}\n+                        Note: Authenticated users will not be able to submit an anonymous survey again\n+                        even if you delete their submission.\n+                    {% endtrans %}\n                 {% endif %}\n             {% endset %}\n             <a href=\"#\" class=\"icon-remove right js-delete-submission hide-if-locked\""
        },
        {
          "filename": "indico/modules/oauth/templates/user_apps.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -36,7 +36,7 @@\n                             <button class=\"ui negative small button\"\n                                     data-href=\"{{ url_for('.user_app_revoke', auth.application) }}\"\n                                     data-method=\"POST\"\n-                                    data-confirm=\"{% trans app_name=auth.application.name %}{{ app_name }} will no longer have access to your Indico data.<br>\n+                                    data-confirm=\"{% trans app_name=auth.application.name %}{{ app_name }} will no longer have access to your Indico data.\n                                     Are you sure you want to revoke its access?{% endtrans %}\">\n                                 {%- trans %}Revoke{% endtrans -%}\n                             </button>"
        },
        {
          "filename": "indico/modules/oauth/templates/user_tokens.html",
          "status": "modified",
          "additions": 0,
          "deletions": 3,
          "patch": "@@ -109,13 +109,10 @@\n                                             You cannot undo this action.\n                                             {% endtrans %}\n                                             {% if not can_manage %}\n-                                                <br><br>\n-                                                <strong>\n                                                 {% trans %}\n                                                 Warning: You will not be able to create a new API token since only Indico\n                                                 admins can create API tokens.\n                                                 {% endtrans %}\n-                                                </strong>\n                                             {% endif %}\n                                             \">\n                                         <i aria-hidden=\"true\" class=\"trash icon\"></i>"
        },
        {
          "filename": "indico/modules/users/templates/personal_data.html",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,7 +14,7 @@\n                                 <button class=\"ui negative small button\"\n                                         data-href=\"{{ url_for('.user_block') }}\"\n                                         data-method=\"PUT\"\n-                                        data-confirm=\"{% trans %}This user will no longer have access to Indico.<br>\n+                                        data-confirm=\"{% trans %}This user will no longer have access to Indico.\n                                         Are you sure you want to revoke their access?{% endtrans %}\"\n                                         data-reload-after\n                                         {% if user == session.user %}disabled{% endif %}>\n@@ -25,7 +25,7 @@\n                             <button class=\"ui small button\"\n                                     data-href=\"{{ url_for('.user_block') }}\"\n                                     data-method=\"DELETE\"\n-                                    data-confirm=\"{% trans %}This user will regain access to Indico.<br>\n+                                    data-confirm=\"{% trans %}This user will regain access to Indico.\n                                     Are you sure you want to restore their access?{% endtrans %}\"\n                                     data-reload-after>\n                                 {% trans %}Unblock User{% endtrans %}"
        },
        {
          "filename": "indico/web/client/js/jquery/utils/misc.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@ import Palette from '../../utils/palette';\n (function(global) {\n   global.confirmPrompt = function confirmPrompt(message, title) {\n     var dfd = $.Deferred();\n-    message = $('<div>', {width: 400, html: message});\n+    message = $('<div>', {width: 400, text: message});\n     new ConfirmPopup(title || $T('Please confirm'), message, function(confirmed) {\n       if (confirmed) {\n         dfd.resolve();"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 11,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "97696abb9f89ff12b17e8bca6524d59699055aa0",
            "date": "2025-01-23T16:44:20Z",
            "author_login": "ThiefMaster"
          },
          {
            "sha": "2a9aca4ba0298bc0c8548af1a2db6e6188779479",
            "date": "2025-01-23T14:14:34Z",
            "author_login": "ThiefMaster"
          },
          {
            "sha": "78692f2ec44f48cda523e0559f12e56eb182bfc9",
            "date": "2025-01-22T19:46:33Z",
            "author_login": "tomasr8"
          },
          {
            "sha": "58b6efe9c535499b9812b70cc06f8850e00b4a51",
            "date": "2025-01-22T15:59:46Z",
            "author_login": "ThiefMaster"
          },
          {
            "sha": "cf0e1eeb332b771614755c940f70c128710e0cac",
            "date": "2025-01-22T10:29:58Z",
            "author_login": "federez-tba"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Indico is an open source a general-purpose, web based event management tool. There is a Cross-Site-Scripting vulnerability in confirmation prompts commonly used when deleting content from Indico. Exploitation requires someone with at least submission privileges (such as a speaker) and then someone else to attempt to delete this content. Considering that event organizers may want to delete suspicious-looking content when spotting it, there is a non-negligible risk of such an attack to succeed. The risk of this could be further increased when combined with some some social engineering pointing the victim towards this content. Users need to update to Indico 3.2.6 as soon as possible. See the docs for instructions on how to update. Users who cannot upgrade should only let trustworthy users manage categories, create events or upload materials (\"submission\" privileges on a contribution/event). This should already be the case in a properly-configured setup when it comes to category/event management. Note that a conference doing a Call for Abstracts actively invites external speakers (who the organizers may not know and thus cannot fully trust) to submit content, hence the need to update to a a fixed version ASAP in particular when using such workflows.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-21T19:15:10.360",
    "last_modified": "2024-11-21T08:12:25.760",
    "fix_date": "2023-07-18T20:47:26Z"
  },
  "references": [
    {
      "url": "https://docs.getindico.io/en/stable/installation/upgrade/",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/indico/indico/commit/2ee636d318653fb1ab193803dafbfe3e371d4130",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/indico/indico/releases/tag/v3.2.6",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/indico/indico/security/advisories/GHSA-fmqq-25x9-c6hm",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://docs.getindico.io/en/stable/installation/upgrade/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/indico/indico/commit/2ee636d318653fb1ab193803dafbfe3e371d4130",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/indico/indico/releases/tag/v3.2.6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/indico/indico/security/advisories/GHSA-fmqq-25x9-c6hm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.262614",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "indico",
    "owner": "indico",
    "created_at": "2011-07-27T13:56:30Z",
    "updated_at": "2025-01-14T14:26:04Z",
    "pushed_at": "2025-01-14T14:25:58Z",
    "size": 265334,
    "stars": 1808,
    "forks": 441,
    "open_issues": 781,
    "watchers": 1808,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "3.2.x",
      "a11y",
      "master"
    ],
    "languages": {
      "Python": 6261977,
      "JavaScript": 2779326,
      "HTML": 1492271,
      "SCSS": 560074,
      "CSS": 41984,
      "TeX": 23659,
      "TypeScript": 13929,
      "Shell": 2728,
      "Mako": 1527,
      "XSLT": 1504
    },
    "commit_activity": {
      "total_commits_last_year": 618,
      "avg_commits_per_week": 11.884615384615385,
      "days_active_last_year": 203
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:40:04.608688"
  }
}