{
  "cve_id": "CVE-2023-38403",
  "github_data": {
    "repository": "esnet/iperf",
    "fix_commit": "0ef151550d96cc4460f98832df84b4a1e87c65e9",
    "related_commits": [
      "0ef151550d96cc4460f98832df84b4a1e87c65e9",
      "0ef151550d96cc4460f98832df84b4a1e87c65e9"
    ],
    "patch_url": "https://github.com/esnet/iperf/commit/0ef151550d96cc4460f98832df84b4a1e87c65e9.patch",
    "fix_commit_details": {
      "sha": "0ef151550d96cc4460f98832df84b4a1e87c65e9",
      "commit_date": "2023-07-07T18:35:02Z",
      "author": {
        "login": "bmah888",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix memory allocation hazard (#1542). (#1543)",
        "length": 86,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/iperf_api.c",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -2670,6 +2670,7 @@ static cJSON *\n JSON_read(int fd)\n {\n     uint32_t hsize, nsize;\n+    size_t strsize;\n     char *str;\n     cJSON *json = NULL;\n     int rc;\n@@ -2682,7 +2683,9 @@ JSON_read(int fd)\n     if (Nread(fd, (char*) &nsize, sizeof(nsize), Ptcp) >= 0) {\n \thsize = ntohl(nsize);\n \t/* Allocate a buffer to hold the JSON */\n-\tstr = (char *) calloc(sizeof(char), hsize+1);\t/* +1 for trailing null */\n+\tstrsize = hsize + 1;              /* +1 for trailing NULL */\n+\tif (strsize) {\n+\tstr = (char *) calloc(sizeof(char), strsize);\n \tif (str != NULL) {\n \t    rc = Nread(fd, str, hsize, Ptcp);\n \t    if (rc >= 0) {\n@@ -2701,6 +2704,10 @@ JSON_read(int fd)\n \t    }\n \t}\n \tfree(str);\n+\t}\n+\telse {\n+\t    printf(\"WARNING:  Data length overflow\\n\");\n+\t}\n     }\n     return json;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "352ef1bdfc2df1c7e3455b5652d810d52ffb190d",
            "date": "2025-01-10T21:52:54Z",
            "author_login": "bmah888"
          },
          {
            "sha": "85d454c27ca172e391bde73c91c93153d6960bbf",
            "date": "2024-12-17T18:43:27Z",
            "author_login": "bmah888"
          },
          {
            "sha": "0f7366ca2ef598c9953cfa914be5e8771af3885b",
            "date": "2024-12-17T18:42:55Z",
            "author_login": "bmah888"
          },
          {
            "sha": "e4cb673170a395c12d83ad74b247659b2e70e257",
            "date": "2024-12-16T22:15:25Z",
            "author_login": "bmah888"
          },
          {
            "sha": "1e80c4fcbef6904e89c4dbb088c06ca1f87672f0",
            "date": "2024-12-14T18:01:00Z",
            "author_login": "hwti"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-190",
    "description": "iperf3 before 3.14 allows peers to cause an integer overflow and heap corruption via a crafted length field.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-07-17T21:15:09.800",
    "last_modified": "2024-11-21T08:13:29.647",
    "fix_date": "2023-07-07T18:35:02Z"
  },
  "references": [
    {
      "url": "http://seclists.org/fulldisclosure/2023/Oct/24",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2023/Oct/26",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.debian.org/1040830",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/130.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://downloads.es.net/pub/iperf/esnet-secadv-2023-0001.txt.asc",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/esnet/iperf/commit/0ef151550d96cc4460f98832df84b4a1e87c65e9",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/esnet/iperf/issues/1542",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/07/msg00025.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BV6EBWWF4PEQKROEVXGYSTIT2MGBTLU7/",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/M25Z5FHTO3XWMGP37JHJ7IIIHSGCLKEV/",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230818-0016/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT213984",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT213985",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2023/Oct/24",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2023/Oct/26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugs.debian.org/1040830",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/130.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://downloads.es.net/pub/iperf/esnet-secadv-2023-0001.txt.asc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/esnet/iperf/commit/0ef151550d96cc4460f98832df84b4a1e87c65e9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/esnet/iperf/issues/1542",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/07/msg00025.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BV6EBWWF4PEQKROEVXGYSTIT2MGBTLU7/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/M25Z5FHTO3XWMGP37JHJ7IIIHSGCLKEV/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20230818-0016/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT213984",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.apple.com/kb/HT213985",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.250110",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "iperf",
    "owner": "esnet",
    "created_at": "2014-02-25T18:42:52Z",
    "updated_at": "2025-01-14T16:04:03Z",
    "pushed_at": "2025-01-10T21:52:54Z",
    "size": 13715,
    "stars": 7148,
    "forks": 1294,
    "open_issues": 216,
    "watchers": 7148,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 625910,
      "Shell": 405552,
      "Makefile": 138792,
      "M4": 39335,
      "Roff": 23989,
      "Python": 3787,
      "Gnuplot": 997,
      "Dockerfile": 570
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T18:15:53.326521"
  }
}