{
  "cve_id": "CVE-2023-39520",
  "github_data": {
    "repository": "cryptomator/cryptomator",
    "fix_commit": "727c32ad50c3901a6144a11cf984a3b7ebcf8b2b",
    "related_commits": [
      "727c32ad50c3901a6144a11cf984a3b7ebcf8b2b",
      "727c32ad50c3901a6144a11cf984a3b7ebcf8b2b"
    ],
    "patch_url": "https://github.com/cryptomator/cryptomator/commit/727c32ad50c3901a6144a11cf984a3b7ebcf8b2b.patch",
    "fix_commit_details": {
      "sha": "727c32ad50c3901a6144a11cf984a3b7ebcf8b2b",
      "commit_date": "2023-08-07T08:14:45Z",
      "author": {
        "login": "tobihagemann",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-62gx-54j7-mjh3",
        "length": 117,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "dist/win/contrib/patchWebDAV.bat",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,5 +3,5 @@\n ::REPLACE ME\n \n cd %~dp0\n-powershell -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -Command .\\patchWebDAV.ps1^\n+powershell -NoLogo -NoProfile -NonInteractive -ExecutionPolicy Unrestricted -Command .\\patchWebDAV.ps1^\n  -LoopbackAlias %LOOPBACK_ALIAS%\n\\ No newline at end of file"
        },
        {
          "filename": "dist/win/contrib/version170-migrate-settings.bat",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,4 +2,4 @@\n :: see comments in file ./version170-migrate-settings.ps1\n \n cd %~dp0\n-powershell -NoLogo -NonInteractive -ExecutionPolicy Unrestricted -Command .\\version170-migrate-settings.ps1\n\\ No newline at end of file\n+powershell -NoLogo -NoProfile -NonInteractive -ExecutionPolicy Unrestricted -Command .\\version170-migrate-settings.ps1\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b88b9c8f9229219249d2801b76b1813eb44828e5",
            "date": "2025-01-13T12:25:55Z",
            "author_login": "mindmonk"
          },
          {
            "sha": "2b8cd36b7b4d131ba08da4095a2d2b5304276f6e",
            "date": "2025-01-12T14:27:30Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3d23deb74490c1655e3aa9499601437ecad17348",
            "date": "2025-01-12T13:42:04Z",
            "author_login": "mindmonk"
          },
          {
            "sha": "de3b2715c7449e3e355d2a65c9b750d435ecbce4",
            "date": "2025-01-10T14:17:24Z",
            "author_login": "mindmonk"
          },
          {
            "sha": "f3d8bd359d4943b8746db3e0d476f526a59911db",
            "date": "2025-01-10T14:05:07Z",
            "author_login": "mindmonk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-269",
    "description": "Cryptomator encrypts data being stored on cloud infrastructure. The MSI installer provided on the homepage for Cryptomator version 1.9.2 allows local privilege escalation for low privileged users, via the `repair` function. The problem occurs as the repair function of the MSI is spawning an SYSTEM Powershell without the `-NoProfile` parameter. Therefore the profile of the user starting the repair will be loaded. Version 1.9.3 contains a fix for this issue. Adding a `-NoProfile` to the powershell is a possible workaround.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-07T20:15:09.987",
    "last_modified": "2024-11-21T08:15:35.470",
    "fix_date": "2023-08-07T08:14:45Z"
  },
  "references": [
    {
      "url": "https://github.com/cryptomator/cryptomator/commit/727c32ad50c3901a6144a11cf984a3b7ebcf8b2b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/releases/download/1.9.2/Cryptomator-1.9.2-x64.msi",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/releases/tag/1.9.3",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/security/advisories/GHSA-62gx-54j7-mjh3",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/commit/727c32ad50c3901a6144a11cf984a3b7ebcf8b2b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/releases/download/1.9.2/Cryptomator-1.9.2-x64.msi",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/releases/tag/1.9.3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/cryptomator/cryptomator/security/advisories/GHSA-62gx-54j7-mjh3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.307066",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cryptomator",
    "owner": "cryptomator",
    "created_at": "2014-02-02T00:43:47Z",
    "updated_at": "2025-01-14T13:30:56Z",
    "pushed_at": "2025-01-13T14:31:56Z",
    "size": 24687,
    "stars": 12124,
    "forks": 1048,
    "open_issues": 275,
    "watchers": 12124,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "main"
    ],
    "languages": {
      "Java": 922855,
      "CSS": 54946,
      "FreeMarker": 1482
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:15:58.366525"
  }
}