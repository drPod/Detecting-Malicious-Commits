{
  "cve_id": "CVE-2023-39976",
  "github_data": {
    "repository": "ClusterLabs/libqb",
    "fix_commit": "1bbaa929b77113532785c408dd1b41cd0521ffc8",
    "related_commits": [
      "1bbaa929b77113532785c408dd1b41cd0521ffc8",
      "1bbaa929b77113532785c408dd1b41cd0521ffc8"
    ],
    "patch_url": "https://github.com/ClusterLabs/libqb/commit/1bbaa929b77113532785c408dd1b41cd0521ffc8.patch",
    "fix_commit_details": {
      "sha": "1bbaa929b77113532785c408dd1b41cd0521ffc8",
      "commit_date": "2023-07-20T06:19:01Z",
      "author": {
        "login": "chrissie-c",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "log: fix potential overflow with long log messages (#490)",
        "length": 562,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "lib/log_blackbox.c",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -110,8 +110,8 @@ _blackbox_vlogger(int32_t target,\n \tchunk += sizeof(uint32_t);\n \n \t/* log message */\n-\tmsg_len = qb_vsnprintf_serialize(chunk, max_size, cs->format, ap);\n-\tif (msg_len >= max_size) {\n+\tmsg_len = qb_vsnprintf_serialize(chunk, t->max_line_length, cs->format, ap);\n+\tif (msg_len >= t->max_line_length) {\n \t    chunk = msg_len_pt + sizeof(uint32_t); /* Reset */\n \n \t    /* Leave this at QB_LOG_MAX_LEN so as not to overflow the blackbox */"
        },
        {
          "filename": "tests/check_log.c",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -832,8 +832,10 @@ START_TEST(test_log_long_msg)\n \t\tqb_log(LOG_INFO, \"Message %d %d - %s\", lpc, lpc%600, buffer);\n \t}\n \n-        qb_log_blackbox_write_to_file(\"blackbox.dump\");\n-        qb_log_blackbox_print_from_file(\"blackbox.dump\");\n+        rc = qb_log_blackbox_write_to_file(\"blackbox.dump\");\n+\tck_assert_int_gt(rc, 0);\n+        rc = qb_log_blackbox_print_from_file(\"blackbox.dump\");\n+\tck_assert_int_le(rc, 0);\n \tunlink(\"blackbox.dump\");\n \tqb_log_fini();\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4e7ebfac9a92a05236459fddb3a8e24ab0688317",
            "date": "2024-08-28T14:34:04Z",
            "author_login": "viraptor"
          },
          {
            "sha": "40542f314ebe7312fa995677ed5c967150dd5d6a",
            "date": "2024-05-18T15:12:47Z",
            "author_login": "wferi"
          },
          {
            "sha": "1070cbc17cbfb415f0bd695f58cdaa4d60c8596c",
            "date": "2024-01-31T09:44:16Z",
            "author_login": "kgaillot"
          },
          {
            "sha": "c7528139dc8a6999fea65d94f7b8fbb424a6bd06",
            "date": "2023-11-20T12:15:21Z",
            "author_login": "chrissie-c"
          },
          {
            "sha": "a3201f55faeea3d8a21a0e2d4961bc3d0f9df1fd",
            "date": "2023-11-15T10:46:21Z",
            "author_login": "chrissie-c"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-120",
    "description": "log_blackbox.c in libqb before 2.0.8 allows a buffer overflow via long log messages because the header size is not considered.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-08T06:15:46.590",
    "last_modified": "2024-11-21T08:16:09.810",
    "fix_date": "2023-07-20T06:19:01Z"
  },
  "references": [
    {
      "url": "https://github.com/ClusterLabs/libqb/commit/1bbaa929b77113532785c408dd1b41cd0521ffc8",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ClusterLabs/libqb/compare/v2.0.7...v2.0.8",
      "source": "cve@mitre.org",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/ClusterLabs/libqb/pull/490",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KECNF7LFBPE57XSBT6EM7ACVMIBP63WH/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/ClusterLabs/libqb/commit/1bbaa929b77113532785c408dd1b41cd0521ffc8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ClusterLabs/libqb/compare/v2.0.7...v2.0.8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/ClusterLabs/libqb/pull/490",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KECNF7LFBPE57XSBT6EM7ACVMIBP63WH/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:04.308792",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libqb",
    "owner": "ClusterLabs",
    "created_at": "2011-03-23T05:07:09Z",
    "updated_at": "2025-01-09T02:09:27Z",
    "pushed_at": "2024-08-28T14:34:04Z",
    "size": 7652,
    "stars": 168,
    "forks": 97,
    "open_issues": 32,
    "watchers": 168,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 752275,
      "M4": 62964,
      "Shell": 25266,
      "Makefile": 22972,
      "Roff": 2563,
      "Python": 2351
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T20:29:58.204726"
  }
}