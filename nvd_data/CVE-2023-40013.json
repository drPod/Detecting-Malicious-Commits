{
  "cve_id": "CVE-2023-40013",
  "github_data": {
    "repository": "shubhamjain/svg-loader",
    "fix_commit": "d3562fc08497aec5f33eb82017fa1417b3319e2c",
    "related_commits": [
      "d3562fc08497aec5f33eb82017fa1417b3319e2c",
      "d3562fc08497aec5f33eb82017fa1417b3319e2c"
    ],
    "patch_url": "https://github.com/shubhamjain/svg-loader/commit/d3562fc08497aec5f33eb82017fa1417b3319e2c.patch",
    "fix_commit_details": {
      "sha": "d3562fc08497aec5f33eb82017fa1417b3319e2c",
      "commit_date": "2023-08-12T04:26:16Z",
      "author": {
        "login": "shubhamjain",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-xc2r-jf2x-gjr8",
        "length": 66,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 24,
        "deletions": 4
      },
      "files": [
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@\n         \"url\": \"https://github.com/shubhamjain/svg-loader.git\"\n     },\n     \"main\": \"dist/svg-loader.min.js\",\n-    \"version\": \"1.6.8\",\n+    \"version\": \"1.6.9\",\n     \"scripts\": {\n         \"postinstall\": \"npm-run-all build:*\",\n         \"build:js\": \"cross-env NODE_ENV=production webpack build\","
        },
        {
          "filename": "svg-loader.js",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -62,6 +62,12 @@ const getAllEventNames = () => {\n         }\n     }\n \n+    // SVG <animate> events\n+    DOM_EVENTS.push('onbegin', 'onend', 'onrepeat');\n+\n+    // Some non-standard events, just in case the browser is handling them\n+    DOM_EVENTS.push('onfocusin', 'onfocusout', 'onbounce', 'onfinish', 'onshow');\n+\n     return DOM_EVENTS;\n };\n \n@@ -128,7 +134,7 @@ const renderBody = (elem, options, body) => {\n             }\n \n             // Remove \"javascript:...\" unless specifically enabled\n-            if ([\"href\", \"xlink:href\"].includes(name) && value.startsWith(\"javascript\") && !enableJs) {\n+            if ([\"href\", \"xlink:href\", \"values\"].includes(name) && value.startsWith(\"javascript\") && !enableJs) {\n                 attributesToRemove.push(name);\n             }\n         }\n@@ -391,4 +397,4 @@ globalThis.SVGLoader.destroyCache = async () => {\n             localStorage.removeItem(key);\n         }\n     });\n-}\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "test/icons/svg-xss-2.svg",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+<svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n+  <animate onbegin=alert(1) attributeName=x dur=1s>\n+</svg>\n\\ No newline at end of file"
        },
        {
          "filename": "test/icons/svg-xss.svg",
          "status": "added",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -0,0 +1,3 @@\n+    <svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\">\n+        <animate xlink:href=#xss attributeName=href values=javascript:alert(1) /><a id=xss><text x=20 y=20>XSS</text></a></svg>\n+    </svg>\n\\ No newline at end of file"
        },
        {
          "filename": "test/index.html",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -1,6 +1,5 @@\n <html>\n     <head>\n-        <link rel=\"stylesheet\" href=\"/main.css\">\n         <style>\n             body {\n                 padding-bottom: 80px;\n@@ -61,6 +60,15 @@ <h1>\n     <div>This is a more complicated SVG with JS, only map with overlay message should be shown</div>\n     <svg data-src=\"./USStates.svg\"></svg>\n \n+    <div class=\"heading\">Icon with XSS</div>\n+    <div>Tricky XSS that needs to be filtered out. On clicking \"X\" nothing should happen </div>\n+    <svg data-src=\"/icons/svg-xss.svg\"></svg>\n+\n+    <div class=\"heading\">Icon with XSS 2</div>\n+    <div>Alert should not come</div>\n+    <svg data-src=\"/icons/svg-xss-2.svg\"></svg>\n+\n+\n     <div class=\"heading\">Icon with JS (enabled)</div>\n     <div>On hover alert should be thrown</div>\n     <svg data-src=\"/icons/cog-with-script.svg\" data-js=\"enabled\"></svg>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 3,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b7920683cb718cb4b5fcfa82cda51fd1344257c3",
            "date": "2024-02-29T17:36:55Z",
            "author_login": "shubhamjain"
          },
          {
            "sha": "527f6ae6509b1e03be294731d13f509a0cfa82fe",
            "date": "2024-02-29T17:23:56Z",
            "author_login": "shubhamjain"
          },
          {
            "sha": "ce8c23dc10df3157c8ba8959bedae1c0cd07f691",
            "date": "2024-02-29T17:23:16Z",
            "author_login": "shubhamjain"
          },
          {
            "sha": "b645e184e136549422ddf2dd710ed74a8ae9a55d",
            "date": "2023-12-18T15:06:03Z",
            "author_login": "MonkeyDo"
          },
          {
            "sha": "85d2a28c9ca0e099aba1b33c570c6cc9997739b0",
            "date": "2023-12-18T14:18:27Z",
            "author_login": "MonkeyDo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L",
    "cwe_id": "CWE-79",
    "description": "SVG Loader is a javascript library that fetches SVGs using XMLHttpRequests and injects the SVG code in the tag's place. According to the docs, svg-loader will strip all JS code before injecting the SVG file for security reasons but the input sanitization logic is not sufficient and can be trivially bypassed. This allows an attacker to craft a malicious SVG which can result in Cross-site Scripting (XSS). When trying to sanitize the svg the lib removes event attributes such as `onmouseover`, `onclick` but the list of events is not exhaustive.  Any website which uses external-svg-loader and allows its users to provide svg src, upload svg files would be susceptible to stored XSS attack. This issue has been addressed in commit `d3562fc08` which is included in releases from 1.6.9. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-08-14T21:15:13.523",
    "last_modified": "2024-11-21T08:18:30.950",
    "fix_date": "2023-08-12T04:26:16Z"
  },
  "references": [
    {
      "url": "https://github.com/shubhamjain/svg-loader/blob/main/svg-loader.js#L125-L128",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/commit/d3562fc08497aec5f33eb82017fa1417b3319e2c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/security/advisories/GHSA-xc2r-jf2x-gjr8",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/tree/main#2-enable-javascript",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/blob/main/svg-loader.js#L125-L128",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/commit/d3562fc08497aec5f33eb82017fa1417b3319e2c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/security/advisories/GHSA-xc2r-jf2x-gjr8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/shubhamjain/svg-loader/tree/main#2-enable-javascript",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.430371",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "svg-loader",
    "owner": "shubhamjain",
    "created_at": "2020-11-20T15:47:31Z",
    "updated_at": "2025-01-07T08:24:58Z",
    "pushed_at": "2024-07-13T21:28:02Z",
    "size": 291,
    "stars": 199,
    "forks": 23,
    "open_issues": 4,
    "watchers": 199,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 15673,
      "HTML": 5484,
      "Shell": 83
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T20:29:49.409870"
  }
}