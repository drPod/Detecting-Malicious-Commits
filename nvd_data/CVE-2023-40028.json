{
  "cve_id": "CVE-2023-40028",
  "github_data": {
    "repository": "TryGhost/Ghost",
    "fix_commit": "690fbf3f7302ff3f77159c0795928bdd20f41205",
    "related_commits": [
      "690fbf3f7302ff3f77159c0795928bdd20f41205",
      "690fbf3f7302ff3f77159c0795928bdd20f41205"
    ],
    "patch_url": "https://github.com/TryGhost/Ghost/commit/690fbf3f7302ff3f77159c0795928bdd20f41205.patch",
    "fix_commit_details": {
      "sha": "690fbf3f7302ff3f77159c0795928bdd20f41205",
      "commit_date": "2023-08-15T10:59:45Z",
      "author": {
        "login": "SimonBackx",
        "type": "User",
        "stats": {
          "total_commits": 1242,
          "average_weekly_commits": 2.0294117647058822,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 90
        }
      },
      "commit_message": {
        "title": "\ud83d\udd12 Fixed arbitrary file read via symlinks in content import",
        "length": 230,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 20,
        "deletions": 10
      },
      "files": [
        {
          "filename": "ghost/core/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -160,7 +160,7 @@\n     \"@tryghost/verification-trigger\": \"0.0.0\",\n     \"@tryghost/version\": \"0.1.22\",\n     \"@tryghost/webmentions\": \"0.0.0\",\n-    \"@tryghost/zip\": \"1.1.34\",\n+    \"@tryghost/zip\": \"1.1.37\",\n     \"amperize\": \"0.6.1\",\n     \"analytics-node\": \"6.2.0\",\n     \"bluebird\": \"3.7.2\","
        },
        {
          "filename": "ghost/core/test/regression/api/admin/db.test.js",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -377,6 +377,15 @@ describe('DB API', function () {\n         yearlyPrice.get('stripe_price_id').should.equal('price_d04baebb73');\n         yearlyPrice.get('stripe_product_id').should.equal('prod_d2c1708c21');\n     });\n+\n+    it('Can not import a ZIP-file with symlinks', async function () {\n+        await request.post(localUtils.API.getApiQuery('db/'))\n+            .set('Origin', config.get('url'))\n+            .set('Accept', 'application/json')\n+            .expect('Content-Type', /json/)\n+            .attach('importfile', path.join(__dirname, '/../../../utils/fixtures/import/symlinks.zip'))\n+            .expect(415);\n+    });\n });\n \n // The following tests will create a new clean database for every test"
        },
        {
          "filename": "ghost/core/test/utils/fixtures/import/symlinks.zip",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "yarn.lock",
          "status": "modified",
          "additions": 10,
          "deletions": 9,
          "patch": "@@ -7173,15 +7173,6 @@\n   dependencies:\n     p-wait-for \"3.2.0\"\n \n-\"@tryghost/zip@1.1.34\":\n-  version \"1.1.34\"\n-  resolved \"https://registry.yarnpkg.com/@tryghost/zip/-/zip-1.1.34.tgz#c8ab1ac3bb5bc780f29c63723d3933f345f0ec65\"\n-  integrity sha512-tfv1Lcd46/W0AkbBj/ttZLCdqI1LQppvkVQ7l5+gSx2ZOHqnZmkoKwMOB0J/LxEEC1TzhqrW0Vzx+ZYtoPACzA==\n-  dependencies:\n-    archiver \"^5.0.0\"\n-    extract-zip \"^2.0.1\"\n-    fs-extra \"^10.0.0\"\n-\n \"@tryghost/zip@1.1.35\":\n   version \"1.1.35\"\n   resolved \"https://registry.yarnpkg.com/@tryghost/zip/-/zip-1.1.35.tgz#654239d0b48f2baac5679cec2930937b825c2f84\"\n@@ -7191,6 +7182,16 @@\n     extract-zip \"^2.0.1\"\n     fs-extra \"^10.0.0\"\n \n+\"@tryghost/zip@1.1.37\":\n+  version \"1.1.37\"\n+  resolved \"https://registry.yarnpkg.com/@tryghost/zip/-/zip-1.1.37.tgz#55ca424a42615d0e53aa12b2b108e7f20ac36b42\"\n+  integrity sha512-L+MKGsbIgHgEeoiq6lLpirNflp8CX89xDSwBRucHR/T+QLwVgnof+aiTTuaTrrF+pOWetBDTvB/gN5t94+k6hA==\n+  dependencies:\n+    \"@tryghost/errors\" \"^1.2.26\"\n+    archiver \"^5.0.0\"\n+    extract-zip \"^2.0.1\"\n+    fs-extra \"^11.0.0\"\n+\n \"@trysound/sax@0.2.0\":\n   version \"0.2.0\"\n   resolved \"https://registry.yarnpkg.com/@trysound/sax/-/sax-0.2.0.tgz#cccaab758af56761eb7bf37af6f03f326dd798ad\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6ca066c8c35dc158a5446b21a32f5c2ae08135a1",
            "date": "2025-01-14T13:10:44Z",
            "author_login": "peterzimon"
          },
          {
            "sha": "8055c3db559b141caedb216fea44221503f155e0",
            "date": "2025-01-14T08:12:48Z",
            "author_login": "ronaldlangeveld"
          },
          {
            "sha": "819f510867fbde579462f84069a79ecaeed5933c",
            "date": "2025-01-14T06:37:11Z",
            "author_login": "ronaldlangeveld"
          },
          {
            "sha": "8db228fa6e9b1194d6d1dcbbdfb6286bf53aff1f",
            "date": "2025-01-14T06:20:47Z",
            "author_login": "ronaldlangeveld"
          },
          {
            "sha": "978609506a6a6ff4cde5e285dc2de535bb7ef9af",
            "date": "2025-01-13T23:00:13Z",
            "author_login": "9larsons"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Ghost is an open source content management system. Versions prior to 5.59.1 are subject to a vulnerability which allows authenticated users to upload files that are symlinks. This can be exploited to perform an arbitrary file read of any file on the host operating system. Site administrators can check for exploitation of this issue by looking for unknown symlinks within Ghost's `content/` folder. Version 5.59.1 contains a fix for this issue. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-15T18:15:10.547",
    "last_modified": "2024-11-21T08:18:33.280",
    "fix_date": "2023-08-15T10:59:45Z"
  },
  "references": [
    {
      "url": "https://github.com/TryGhost/Ghost/commit/690fbf3f7302ff3f77159c0795928bdd20f41205",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/TryGhost/Ghost/security/advisories/GHSA-9c9v-w225-v5rg",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TryGhost/Ghost/commit/690fbf3f7302ff3f77159c0795928bdd20f41205",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/TryGhost/Ghost/security/advisories/GHSA-9c9v-w225-v5rg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.433796",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Ghost",
    "owner": "TryGhost",
    "created_at": "2013-05-04T11:09:13Z",
    "updated_at": "2025-01-14T13:10:58Z",
    "pushed_at": "2025-01-14T13:10:47Z",
    "size": 335202,
    "stars": 48030,
    "forks": 10479,
    "open_issues": 174,
    "watchers": 48030,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 12857878,
      "TypeScript": 2780626,
      "CSS": 1155238,
      "Handlebars": 1014055,
      "HTML": 191211,
      "MDX": 21623,
      "Shell": 9512,
      "XSLT": 6522,
      "Dockerfile": 1898
    },
    "commit_activity": {
      "total_commits_last_year": 2519,
      "avg_commits_per_week": 48.44230769230769,
      "days_active_last_year": 269
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:45:20.286257"
  }
}