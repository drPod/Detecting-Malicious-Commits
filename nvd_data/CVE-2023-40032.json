{
  "cve_id": "CVE-2023-40032",
  "github_data": {
    "repository": "libvips/libvips",
    "fix_commit": "e091d65835966ef56d53a4105a7362cafdb1582b",
    "related_commits": [
      "e091d65835966ef56d53a4105a7362cafdb1582b",
      "e091d65835966ef56d53a4105a7362cafdb1582b"
    ],
    "patch_url": "https://github.com/libvips/libvips/commit/e091d65835966ef56d53a4105a7362cafdb1582b.patch",
    "fix_commit_details": {
      "sha": "e091d65835966ef56d53a4105a7362cafdb1582b",
      "commit_date": "2023-08-13T13:48:54Z",
      "author": {
        "login": "kleisauke",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "svgload: fix null-pointer dereference (#3604)",
        "length": 193,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 22,
        "additions": 19,
        "deletions": 3
      },
      "files": [
        {
          "filename": "ChangeLog",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -1,3 +1,7 @@\n+TBD 8.14.4\n+\n+- fix null-pointer dereference during svgload [kleisauke]\n+\n 20/7/23 8.14.3\n \n - fix ICC handling of greyscale images with a incompatible profile [kleisauke]"
        },
        {
          "filename": "libvips/foreign/svgload.c",
          "status": "modified",
          "additions": 15,
          "deletions": 3,
          "patch": "@@ -145,7 +145,7 @@ vips_foreign_load_svg_zfree( void *opaque, void *ptr )\n /* Find a utf-8 substring within the first len_bytes (not characters). \n  *\n  *   - case-insensitive\n- *   - needle must be zero-terminated, but hackstack need not be\n+ *   - needle must be zero-terminated, but haystack need not be\n  *   - haystack can be null-terminated\n  *   - if haystack is shorter than len bytes, that'll end the search \n  *   - if we hit invalid utf-8, we return NULL\n@@ -191,11 +191,14 @@ vips_utf8_strcasestr( const char *haystack_start, const char *needle_start,\n \t\t\t\tb == (gunichar) -2 )\n                                 return( NULL );\n \n-                        /* End of haystack. There can't be a complete needle\n-                         * anywhere.\n+                        /* Disallow codepoint U+0000 as it's a nul byte.\n+                         * This is redundant with GLib >= 2.63.0, see:\n+                         * https://gitlab.gnome.org/GNOME/glib/-/merge_requests/967\n                          */\n+#if !GLIB_CHECK_VERSION( 2, 63, 0 )\n                         if( a == (gunichar) 0 )\n                                 return( NULL );\n+#endif\n \n                         /* Mismatch.\n                          */\n@@ -205,6 +208,15 @@ vips_utf8_strcasestr( const char *haystack_start, const char *needle_start,\n                         haystack_char = \n \t\t\t\tg_utf8_find_next_char( haystack_char, \n \t\t\t\t\thaystack_start + len_bytes );\n+\n+                        /* End of haystack. There can't be a complete needle\n+                         * anywhere.\n+                         */\n+                        if( haystack_char == NULL )\n+                                return( NULL );\n+\n+                        /* needle_char will never be NULL.\n+                         */\n                         needle_char = \n \t\t\t\tg_utf8_find_next_char( needle_char, NULL );\n                 }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa6db7679d04df777fe39e4823bbf6a432c1fcc3",
            "date": "2025-01-13T12:11:09Z",
            "author_login": "jcupitt"
          },
          {
            "sha": "c440ddc638c8769d995c6e2fea6ae6e6d1ad829c",
            "date": "2025-01-13T11:41:51Z",
            "author_login": "jcupitt"
          },
          {
            "sha": "dbe46d13db44a0e2baa703cd560d3f5661ab5c01",
            "date": "2025-01-13T11:41:21Z",
            "author_login": "lovell"
          },
          {
            "sha": "4689cda680c2b59bf8dca0b856fb58087196f60a",
            "date": "2025-01-11T16:23:00Z",
            "author_login": "jcupitt"
          },
          {
            "sha": "b54cba45fad29398097857b5971eae349b93a19b",
            "date": "2025-01-11T15:43:16Z",
            "author_login": "lovell"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-476",
    "description": "libvips is a demand-driven, horizontally threaded image processing library. A specially crafted SVG input can cause libvips versions 8.14.3 or earlier to segfault when attempting to parse a malformed UTF-8 character. Users should upgrade to libvips version 8.14.4 (or later) when processing untrusted input.\n",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-11T19:15:43.603",
    "last_modified": "2024-11-21T08:18:33.757",
    "fix_date": "2023-08-13T13:48:54Z"
  },
  "references": [
    {
      "url": "https://github.com/libvips/libvips/commit/e091d65835966ef56d53a4105a7362cafdb1582b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libvips/libvips/pull/3604",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libvips/libvips/security/advisories/GHSA-33qp-9pq7-9584",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YU2FFC47X2XDEGEHEWAGLU5L3R6FEYD2/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/libvips/libvips/commit/e091d65835966ef56d53a4105a7362cafdb1582b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libvips/libvips/pull/3604",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/libvips/libvips/security/advisories/GHSA-33qp-9pq7-9584",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/YU2FFC47X2XDEGEHEWAGLU5L3R6FEYD2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:08.400242",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libvips",
    "owner": "libvips",
    "created_at": "2011-01-25T13:15:00Z",
    "updated_at": "2025-01-14T06:42:43Z",
    "pushed_at": "2025-01-13T12:11:39Z",
    "size": 107886,
    "stars": 9949,
    "forks": 685,
    "open_issues": 80,
    "watchers": 9949,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 5632820,
      "C++": 587638,
      "Python": 215518,
      "Meson": 65605,
      "Shell": 27002
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T14:59:33.012571"
  }
}