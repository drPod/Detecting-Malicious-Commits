{
  "cve_id": "CVE-2023-40035",
  "github_data": {
    "repository": "craftcms/cms",
    "fix_commit": "0bd33861abdc60c93209cff03eeee54504d3d3b5",
    "related_commits": [
      "0bd33861abdc60c93209cff03eeee54504d3d3b5",
      "0bd33861abdc60c93209cff03eeee54504d3d3b5"
    ],
    "patch_url": "https://github.com/craftcms/cms/commit/0bd33861abdc60c93209cff03eeee54504d3d3b5.patch",
    "fix_commit_details": {
      "sha": "0bd33861abdc60c93209cff03eeee54504d3d3b5",
      "commit_date": "2023-06-27T23:49:40Z",
      "author": {
        "login": "angrybrad",
        "type": "User",
        "stats": {
          "total_commits": 8628,
          "average_weekly_commits": 11.950138504155124,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 494
        }
      },
      "commit_message": {
        "title": "Fixed a potential RCE vulnerability",
        "length": 35,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -1,5 +1,9 @@\n # Release Notes for Craft CMS 3.x\n \n+## Unreleased\n+\n+- Fixed an RCE vulnerability.\n+\n ## 3.8.14 - 2023-06-13\n \n - The `_includes/forms/date` and `_includes/forms/time` templates now accept a `timeZone` variable."
        },
        {
          "filename": "src/helpers/FileHelper.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -44,6 +44,9 @@ class FileHelper extends \\yii\\helpers\\FileHelper\n      */\n     public static function normalizePath($path, $ds = DIRECTORY_SEPARATOR)\n     {\n+        // Remove any file protocol wrappers\n+        $path = StringHelper::removeLeft($path, 'file://');\n+\n         // Is this a UNC network share path?\n         $isUnc = (strpos($path, '//') === 0 || strpos($path, '\\\\\\\\') === 0);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2461d9d2fe461c57d038675083470b5b7f7fff15",
            "date": "2025-01-13T19:29:56Z",
            "author_login": "brandonkelly"
          },
          {
            "sha": "28fca2b5b66c55e489e784c2f5fef2d4b179dce2",
            "date": "2025-01-13T19:27:35Z",
            "author_login": "brandonkelly"
          },
          {
            "sha": "80f5b0643c35111a22f63dcea4838c0ecbe2c666",
            "date": "2025-01-13T19:27:00Z",
            "author_login": "brandonkelly"
          },
          {
            "sha": "0dccb7d72bec5ca84b5a2994e8ff4f7454e5541b",
            "date": "2025-01-11T03:22:11Z",
            "author_login": "brandonkelly"
          },
          {
            "sha": "da08dc0686f4b19c6fc1ae82ce4635e7e3fe4ff2",
            "date": "2025-01-11T03:21:30Z",
            "author_login": "brandonkelly"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-74",
    "description": "Craft is a CMS for creating custom digital experiences on the web and beyond. Bypassing the validatePath function can lead to potential remote code execution. This vulnerability can lead to malicious control of vulnerable systems and data exfiltrations. Although the vulnerability is exploitable only in the authenticated users, configuration with ALLOW_ADMIN_CHANGES=true, there is still a potential security threat (Remote Code Execution). This issue has been patched in version 4.4.15 and version 3.8.15.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-23T21:15:08.300",
    "last_modified": "2024-11-21T08:18:34.113",
    "fix_date": "2023-06-27T23:49:40Z"
  },
  "references": [
    {
      "url": "https://github.com/craftcms/cms/commit/0bd33861abdc60c93209cff03eeee54504d3d3b5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/releases/tag/3.8.15",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/releases/tag/4.4.15",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/security/advisories/GHSA-44wr-rmwq-3phw",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/commit/0bd33861abdc60c93209cff03eeee54504d3d3b5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/releases/tag/3.8.15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/releases/tag/4.4.15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/craftcms/cms/security/advisories/GHSA-44wr-rmwq-3phw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.465445",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cms",
    "owner": "craftcms",
    "created_at": "2017-01-27T21:52:45Z",
    "updated_at": "2025-01-14T04:17:39Z",
    "pushed_at": "2025-01-14T14:42:16Z",
    "size": 724660,
    "stars": 3304,
    "forks": 638,
    "open_issues": 462,
    "watchers": 3304,
    "has_security_policy": false,
    "default_branch": "5.x",
    "protected_branches": [
      "3.x",
      "4.x",
      "5.x"
    ],
    "languages": {
      "PHP": 9942975,
      "JavaScript": 1780122,
      "Twig": 525694,
      "SCSS": 336616,
      "Vue": 258380,
      "TypeScript": 26958,
      "Smarty": 2123,
      "HTML": 623,
      "PLpgSQL": 477,
      "Shell": 174,
      "CSS": 16
    },
    "commit_activity": {
      "total_commits_last_year": 8094,
      "avg_commits_per_week": 155.65384615384616,
      "days_active_last_year": 319
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:59:01.089030"
  }
}