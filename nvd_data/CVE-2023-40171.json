{
  "cve_id": "CVE-2023-40171",
  "github_data": {
    "repository": "Netflix/dispatch",
    "fix_commit": "b1942a4319f0de820d86b84a58ebc85398b97c70",
    "related_commits": [
      "b1942a4319f0de820d86b84a58ebc85398b97c70",
      "b1942a4319f0de820d86b84a58ebc85398b97c70"
    ],
    "patch_url": "https://github.com/Netflix/dispatch/commit/b1942a4319f0de820d86b84a58ebc85398b97c70.patch",
    "fix_commit_details": {
      "sha": "b1942a4319f0de820d86b84a58ebc85398b97c70",
      "commit_date": "2023-08-16T17:41:42Z",
      "author": {
        "login": "kevgliss",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Removes error message for malformed JWT tokens",
        "length": 46,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/dispatch/plugins/dispatch_core/plugin.py",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -72,9 +72,10 @@ def get_current_user(self, request: Request, **kwargs):\n \n         try:\n             data = jwt.decode(token, DISPATCH_JWT_SECRET)\n-        except (JWKError, JWTError) as e:\n+        except (JWKError, JWTError):\n             raise HTTPException(\n-                status_code=HTTP_401_UNAUTHORIZED, detail=[{\"msg\": str(e)}]\n+                status_code=HTTP_401_UNAUTHORIZED,\n+                detail=[{\"msg\": \"Could not validate credentials\"}],\n             ) from None\n         return data[\"email\"]\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "264e6b26a26837344bb6917c6ece538e5ae75de5",
            "date": "2025-01-10T19:22:44Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "9bd9e8824390f55dcad6f12c4b86f06a646393cd",
            "date": "2025-01-10T19:22:36Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "d8d96751b9b4735f70e99078795ca4e30820b5ca",
            "date": "2025-01-10T19:22:28Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "f01b6290d7d174d40746c9dc003e426bbae28289",
            "date": "2025-01-10T19:22:20Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "64747afde85dd580fea03d90eac48e84bbd7e50b",
            "date": "2025-01-10T19:22:13Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-209",
    "description": "Dispatch is an open source security incident management tool. The server response includes the JWT Secret Key used for signing JWT tokens in error message when the `Dispatch Plugin - Basic Authentication Provider` plugin encounters an error when attempting to decode a JWT token. Any Dispatch users who own their instance and rely on the `Dispatch Plugin - Basic Authentication Provider` plugin for authentication may be impacted, allowing for any account to be taken over within their own instance. This could be done by using the secret to sign attacker crafted JWTs. If you think that you may be impacted, we strongly suggest you to rotate the secret stored in the `DISPATCH_JWT_SECRET` envvar in the `.env` file. This issue has been addressed in commit `b1942a4319` which has been included in the `20230817` release. users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-17T22:15:10.087",
    "last_modified": "2024-11-21T08:18:55.310",
    "fix_date": "2023-08-16T17:41:42Z"
  },
  "references": [
    {
      "url": "https://github.com/Netflix/dispatch/commit/b1942a4319f0de820d86b84a58ebc85398b97c70",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/pull/3695",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/releases/tag/latest",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/security/advisories/GHSA-fv3x-67q3-6pg7",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/commit/b1942a4319f0de820d86b84a58ebc85398b97c70",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/pull/3695",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/releases/tag/latest",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/Netflix/dispatch/security/advisories/GHSA-fv3x-67q3-6pg7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.441490",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dispatch",
    "owner": "Netflix",
    "created_at": "2020-02-10T17:21:28Z",
    "updated_at": "2025-01-14T10:59:39Z",
    "pushed_at": "2025-01-14T12:48:08Z",
    "size": 98170,
    "stars": 5271,
    "forks": 525,
    "open_issues": 11,
    "watchers": 5271,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 2413341,
      "Vue": 1356383,
      "JavaScript": 778339,
      "TypeScript": 49638,
      "PLpgSQL": 14001,
      "Dockerfile": 5702,
      "SCSS": 3588,
      "CSS": 2223,
      "Lua": 1677,
      "Mako": 988,
      "Shell": 777,
      "HTML": 765,
      "Sass": 355
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T21:09:31.164862"
  }
}