{
  "cve_id": "CVE-2023-40174",
  "github_data": {
    "repository": "fobybus/social-media-skeleton",
    "fix_commit": "99738b2cc5efb6a5739161c931daa43f99431e5a",
    "related_commits": [
      "99738b2cc5efb6a5739161c931daa43f99431e5a",
      "99738b2cc5efb6a5739161c931daa43f99431e5a"
    ],
    "patch_url": "https://github.com/fobybus/social-media-skeleton/commit/99738b2cc5efb6a5739161c931daa43f99431e5a.patch",
    "fix_commit_details": {
      "sha": "99738b2cc5efb6a5739161c931daa43f99431e5a",
      "commit_date": "2023-08-17T18:27:24Z",
      "author": {
        "login": "fobybus",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "added session expiration",
        "length": 24,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 72,
        "additions": 70,
        "deletions": 2
      },
      "files": [
        {
          "filename": "admin/atask/add.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -9,6 +9,13 @@\n    exit();\n }\n \n+ //is expired \n+ if(sexpired())\n+ {\n+    header(\"location:logout.php\");\n+    exit();\n+ }\n+\n if($_SERVER['REQUEST_METHOD'] == 'POST')\n {\n   $uemail=htmlspecialchars($_POST[\"email\"], ENT_QUOTES, 'UTF-8');"
        },
        {
          "filename": "admin/atask/setting.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -8,6 +8,14 @@\n \theader(\"location:../adminlogin.html\");\n    exit();\n }\n+\n+ //is expired \n+ if(sexpired())\n+ {\n+    header(\"location:logout.php\");\n+    exit();\n+ }\n+ \n //connect to the database first!!!!\n require('../../tasks/condb.php');\n if($_SERVER['REQUEST_METHOD'] == 'POST')"
        },
        {
          "filename": "admin/home.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,12 +1,21 @@\n <!-- drop in and out of the PHP context -->\n <?php  \n include(\"atask/getinfo.php\");\n+include(\"../tasks/passw.php\");\n session_start();\n  if(!isset($_SESSION[\"aid\"]))\n  {\n \t header(\"location:adminlogin.html\");\n \t\n  }\n+\n+ //is expired \n+if(sexpired())\n+{\n+   header(\"location:atask/logout.php\");\n+   exit();\n+}\n+\n ?> \n \n <html lang=\"en-us\">"
        },
        {
          "filename": "admin/login.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -31,6 +31,7 @@\n     $_SESSION[\"aid\"]=$id;\n     $_SESSION[\"password\"]=$pass;\n     $_SESSION[\"salt\"]=$salt;\n+    $_SESSION[\"exp_time\"]=time()+(10);\n    header(\"location:home.php\");\n   } else {\n     echo \"<p style='color:red;text-align:center;font-size:20px;'> incorrect password   </p>\";"
        },
        {
          "filename": "admin/mg.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,10 +1,19 @@\n <?php\n session_start();\n+include(\"../tasks/passw.php\");\n if(!isset($_SESSION[\"aid\"]))\n {\n \theader(\"location:adminlogin.html\");\n    exit();\n }\n+\n+ //is expired \n+ if(sexpired())\n+ {\n+    header(\"location:atask/logout.php\");\n+    exit();\n+ }\n+\n ?>\n <html lang=\"en-us\">\n "
        },
        {
          "filename": "login.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -1,4 +1,4 @@\n-<?php\n+<?php   \n session_start();\n if(isset($_SESSION[\"id\"]))\n {\n@@ -39,7 +39,7 @@\n   $upass=hashPass($upass,$salt);\n   if($upass==$pas)\n   {\n-      //session start\n+      //session start \n   $_SESSION['email']=$email;\n   $_SESSION[\"id\"]=$id;\n   $_SESSION[\"fname\"]=$fname;\n@@ -51,6 +51,7 @@\n   $_SESSION[\"edu\"]=$edu;\n   $_SESSION[\"joined\"]=$joined;\n   $_SESSION[\"salt\"]=$salt;\n+  $_SESSION[\"exp_time\"]=time()+(10);\n   ////////////////////////////\n   //update last seen\n   ////////////////////////////"
        },
        {
          "filename": "tasks/passw.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -14,4 +14,13 @@ function hashPass($plain,$salt)\n     return hash(\"sha256\",$password);\n }\n \n+//check se exp \n+function sexpired()\n+{\n+  if(isset($_SESSION[\"exp_time\"]) && $_SESSION[\"exp_time\"]<time())\n+   return true; \n+   else \n+   return false;\n+}\n+\n ?>\n\\ No newline at end of file"
        },
        {
          "filename": "user/home.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,11 +1,20 @@\n <!-- drop in and out of the PHP context -->\n <?php  \n session_start();\n+require(\"../tasks/passw.php\");\n if(!isset($_SESSION[\"id\"]))\n {\n \theader(\"location:../login.html\");\n \texit();\n }\n+\n+//is expired \n+if(sexpired())\n+{\n+   header(\"location:logout.php\");\n+   exit();\n+}\n+\n ?> \n \n <html lang=\"en-us\">"
        },
        {
          "filename": "user/profile.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,11 +1,20 @@\n <!-- drop in and out of the PHP context -->\n <?php  \n session_start();\n+require(\"../tasks/passw.php\");\n if(!isset($_SESSION[\"id\"]))\n {\n \theader(\"location:../login.html\");\n \tdie();\n }\n+\n+//is expired \n+if(sexpired())\n+{\n+   header(\"location:logout.php\");\n+   exit();\n+}\n+\n ?> \n \n <html lang=\"en-us\">"
        },
        {
          "filename": "user/setting.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -8,6 +8,12 @@\n   exit();\n }\n \n+//is expired \n+if(sexpired())\n+{\n+   header(\"location:logout.php\");\n+   exit();\n+}\n \n \n if (isset($_POST[\"ch-info\"])) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8c632f9c16cc00da15a5e9d40b2a7edccf182a61",
            "date": "2023-08-30T00:59:08Z",
            "author_login": "fobybus"
          },
          {
            "sha": "9c65622017b5cfaf6edbbac467746b134ee3a665",
            "date": "2023-08-23T13:18:38Z",
            "author_login": "fobybus"
          },
          {
            "sha": "70c630e9e75763a63d76747a0a1a111ab5698cad",
            "date": "2023-08-17T23:23:23Z",
            "author_login": "fobybus"
          },
          {
            "sha": "cceaebbe17af0e24fb5b30d893ac3795d7d31018",
            "date": "2023-08-17T23:21:44Z",
            "author_login": "fobybus"
          },
          {
            "sha": "ea5d199c05fa2a0c1fafbfca44734676d2d9d851",
            "date": "2023-08-17T18:54:44Z",
            "author_login": "fobybus"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-613",
    "description": "Social media skeleton is an uncompleted/framework social media project implemented using a php, css ,javascript and html. Insufficient session expiration is a web application security vulnerability that occurs when a web application does not properly manage the lifecycle of a user's session. Social media skeleton releases prior to 1.0.5 did not properly limit manage user session lifecycles. This issue has been addressed in version 1.0.5 and users are advised to upgrade. There are no known workarounds for this vulnerability.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-08-18T22:15:11.423",
    "last_modified": "2024-11-21T08:18:55.737",
    "fix_date": "2023-08-17T18:27:24Z"
  },
  "references": [
    {
      "url": "https://github.com/fobybus/social-media-skeleton/commit/99738b2cc5efb6a5739161c931daa43f99431e5a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fobybus/social-media-skeleton/security/advisories/GHSA-cr5c-ggwq-g4hq",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/fobybus/social-media-skeleton/commit/99738b2cc5efb6a5739161c931daa43f99431e5a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fobybus/social-media-skeleton/security/advisories/GHSA-cr5c-ggwq-g4hq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.445963",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "social-media-skeleton",
    "owner": "fobybus",
    "created_at": "2023-07-30T15:32:24Z",
    "updated_at": "2023-08-01T06:44:40Z",
    "pushed_at": "2023-08-30T00:59:08Z",
    "size": 1369,
    "stars": 0,
    "forks": 5,
    "open_issues": 0,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 30867,
      "CSS": 11021,
      "HTML": 9601,
      "JavaScript": 925
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:01:25.086575"
  }
}