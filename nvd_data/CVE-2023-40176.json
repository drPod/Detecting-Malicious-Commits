{
  "cve_id": "CVE-2023-40176",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "d11ca5d781f8a42a85bc98eb82306c1431e764d4",
    "related_commits": [
      "d11ca5d781f8a42a85bc98eb82306c1431e764d4",
      "d11ca5d781f8a42a85bc98eb82306c1431e764d4"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/d11ca5d781f8a42a85bc98eb82306c1431e764d4.patch",
    "fix_commit_details": {
      "sha": "d11ca5d781f8a42a85bc98eb82306c1431e764d4",
      "commit_date": "2023-02-08T08:05:32Z",
      "author": {
        "login": "mflorea",
        "type": "User",
        "stats": {
          "total_commits": 5187,
          "average_weekly_commits": 5.437106918238993,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 692
        }
      },
      "commit_message": {
        "title": "XWIKI-20276: Improve escaping in the timezone displayer",
        "length": 55,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 473,
        "additions": 373,
        "deletions": 100
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-administration/xwiki-platform-administration-ui/src/main/resources/XWiki/TemplateProviderMacros.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -47,9 +47,7 @@\n   #else\n     #set ($output = $doc.display($property))\n   #end\n-  #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-  #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-  $output\n+  #unwrapXPropertyDisplay($output)\n #end\n \n #macro (displayPathsPropertyValue $property)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-annotation/xwiki-platform-annotation-ui/src/main/resources/AnnotationCode/Macros.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -364,9 +364,7 @@\n     ## the annotated document (i.e. isolated), not the current document.\n     #set ($output = $annotatedDocument.display($annotationProperty.name, 'view', $annotationObject))\n     ## Remove the HTML macro wrapping because the output is later injected in another HTML macro with wiki=false.\n-    #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-    #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-    $output\n+    #unwrapXPropertyDisplay($output)\n   #end\n #end\n {{/velocity}}</content>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-ckeditor/xwiki-platform-ckeditor-ui/src/main/resources/CKEditor/VelocityMacros.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -241,10 +241,7 @@\n #end\n \n #macro (displayCKEditorConfigPropertyValue $configDoc $propName $action)\n-  #set ($output = $configDoc.display($propName, $action))\n-  #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-  #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-  $output\n+  #unwrapXPropertyDisplay($configDoc.display($propName, $action))\n #end\n \n #macro (displayCKEditorConfig $configDoc $action)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-export/xwiki-platform-export-pdf/xwiki-platform-export-pdf-ui/src/main/resources/XWiki/PDFExport/ConfigurationSheet.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -78,10 +78,7 @@\n #end\n \n #macro (displayPDFExportConfigPropertyValue $configProperty $displayMode)\n-  #set ($output = $doc.display($configProperty.name, $displayMode))\n-  #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-  #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-  $!output\n+  #unwrapXPropertyDisplay($doc.display($configProperty.name, $displayMode))\n #end\n \n #macro (viewPDFExportConfig)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-export/xwiki-platform-export-pdf/xwiki-platform-export-pdf-ui/src/main/resources/XWiki/PDFExport/Sheet.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -105,10 +105,7 @@\n #end\n \n #macro (renderPDFElement $pdfTemplateObj $element)\n-  #set ($output = $tdoc.display($element, $pdfTemplateObj))\n-  #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-  #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-  $!output\n+  #unwrapXPropertyDisplay($tdoc.display($element, $pdfTemplateObj))\n #end\n \n #macro (renderPDFContent)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-livetable/xwiki-platform-livetable-ui/src/main/resources/XWiki/LiveTableResultsMacros.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -502,7 +502,7 @@\n     #else\n       #set($fieldValue = \"$!fieldProperty.getValue()\")\n     #end\n-    #set($fieldDisplayValue = \"$!itemDoc.display($colname, 'view')\")\n+    #set($fieldDisplayValue = \"#unwrapXPropertyDisplay($itemDoc.display($colname, 'view'))\")\n     #if($fieldDisplayValue == '')\n       #set($fieldDisplayValue = $services.localization.render(\"${request.transprefix}emptyvalue\"))\n     #end\n@@ -514,7 +514,7 @@\n         #set($fieldUrl = '')\n       #end\n     #end\n-    #set($discard = $row.put($colname, $fieldDisplayValue.replaceFirst($regextool.quote('{{html clean=\"false\" wiki=\"false\"}}'), '').replaceAll(\"$regextool.quote('{{/html}}')$\", '')))\n+    #set($discard = $row.put($colname, $fieldDisplayValue))\n     #set($discard = $row.put(\"${colname}_value\", $fieldValue))\n     #set($discard = $row.put(\"${colname}_url\", $fieldUrl))\n     ## Reset to the default class"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-panels/xwiki-platform-panels-ui/src/main/resources/Panels/PanelWizard.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -79,10 +79,7 @@\n \n {{velocity output=\"false\"}}\n #macro (displayConfigPropertyValue $propName $action)\n-  #set ($output = $doc.display($propName, $action))\n-  #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-  #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-  $output\n+  #unwrapXPropertyDisplay($doc.display($propName, $action))\n #end\n \n #macro (displayPageLayoutSection)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-search/xwiki-platform-search-ui/src/main/resources/XWiki/SearchSuggestConfigSheet.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -40,10 +40,7 @@\n \n {{velocity output=\"false\"}}\n #macro (displayObjectPropertyValue $propertyName $mode)\n-  #set ($output = $doc.display($propertyName, $mode))\n-  #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n-  #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n-  $output\n+  #unwrapXPropertyDisplay($doc.display($propertyName, $mode))\n #end\n \n #macro (displaySearchSuggestSource $source)"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-uiextension/xwiki-platform-uiextension-api/pom.xml",
          "status": "modified",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -111,4 +111,25 @@\n       <scope>test</scope>\n     </dependency>\n   </dependencies>\n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-jar-plugin</artifactId>\n+        <executions>\n+          <execution>\n+            <id>test-jar</id>\n+            <goals>\n+              <goal>test-jar</goal>\n+            </goals>\n+            <configuration>\n+              <includes>\n+                <include>**/UIExtensionScriptServiceComponentList.class</include>\n+              </includes>\n+            </configuration>\n+          </execution>\n+        </executions>\n+      </plugin>\n+    </plugins>\n+  </build>\n </project>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-uiextension/xwiki-platform-uiextension-api/src/test/java/org/xwiki/uiextension/script/UIExtensionScriptServiceComponentList.java",
          "status": "added",
          "additions": 81,
          "deletions": 0,
          "patch": "@@ -0,0 +1,81 @@\n+/*\n+ * See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU Lesser General Public License as\n+ * published by the Free Software Foundation; either version 2.1 of\n+ * the License, or (at your option) any later version.\n+ *\n+ * This software is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this software; if not, write to the Free\n+ * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n+ * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n+ */\n+package org.xwiki.uiextension.script;\n+\n+import java.lang.annotation.Documented;\n+import java.lang.annotation.Inherited;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.Target;\n+\n+import org.xwiki.component.wiki.internal.DefaultWikiComponentManager;\n+import org.xwiki.component.wiki.internal.DefaultWikiComponentManagerContext;\n+import org.xwiki.component.wiki.internal.WikiComponentManagerEventListenerHelper;\n+import org.xwiki.component.wiki.internal.bridge.DefaultContentParser;\n+import org.xwiki.component.wiki.internal.bridge.DefaultWikiObjectComponentManagerEventListener;\n+import org.xwiki.component.wiki.internal.bridge.WikiObjectComponentManagerEventListenerProxy;\n+import org.xwiki.rendering.async.internal.block.DefaultBlockAsyncRenderer;\n+import org.xwiki.test.annotation.ComponentList;\n+import org.xwiki.uiextension.internal.DefaultUIExtensionManager;\n+import org.xwiki.uiextension.internal.WikiUIExtensionComponentBuilder;\n+import org.xwiki.uiextension.internal.filter.ExcludeFilter;\n+import org.xwiki.uiextension.internal.filter.SelectFilter;\n+import org.xwiki.uiextension.internal.filter.SortByCustomOrderFilter;\n+import org.xwiki.uiextension.internal.filter.SortByIdFilter;\n+import org.xwiki.uiextension.internal.filter.SortByParameterFilter;\n+\n+import static java.lang.annotation.ElementType.ANNOTATION_TYPE;\n+import static java.lang.annotation.ElementType.METHOD;\n+import static java.lang.annotation.ElementType.TYPE;\n+import static java.lang.annotation.RetentionPolicy.RUNTIME;\n+\n+/**\n+ * Pack of default component implementations that are needed for {@link UIExtensionScriptService}.\n+ *\n+ * @version $Id$\n+ * @since 14.10.5\n+ * @since 15.1RC1\n+ */\n+@Documented\n+@Retention(RUNTIME)\n+@Target({TYPE, METHOD, ANNOTATION_TYPE})\n+@ComponentList({\n+    UIExtensionScriptService.class,\n+    DefaultUIExtensionManager.class,\n+    WikiUIExtensionComponentBuilder.class,\n+    // Filters\n+    ExcludeFilter.class,\n+    SelectFilter.class,\n+    SortByCustomOrderFilter.class,\n+    SortByIdFilter.class,\n+    SortByParameterFilter.class,\n+    // Needed for registering the UI extensions defined in wiki pages.\n+    DefaultWikiObjectComponentManagerEventListener.class,\n+    WikiObjectComponentManagerEventListenerProxy.class,\n+    WikiComponentManagerEventListenerHelper.class,\n+    DefaultWikiComponentManager.class,\n+    DefaultWikiComponentManagerContext.class,\n+    // Needed for rendering the UI extensions.\n+    DefaultContentParser.class,\n+    DefaultBlockAsyncRenderer.class\n+})\n+@Inherited\n+public @interface UIExtensionScriptServiceComponentList\n+{\n+}"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-user/xwiki-platform-user-directory/xwiki-platform-user-directory-ui/src/main/resources/XWiki/UserDirectoryMacros.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -276,8 +276,7 @@\n #macro (displayProperty $propertyName $object $action)\n   #set ($propertyClass = $object.xWikiClass.get($propertyName))\n   #set ($isCheckbox = $propertyClass.getValue('displayFormType') == 'checkbox')\n-  #set ($fieldDisplay = $stringtool.removeEnd($stringtool.removeStart($object.display($propertyName, $action),\n-    '{{html clean=\"false\" wiki=\"false\"}}'), '{{/html}}'))\n+  #set ($fieldDisplay = \"#unwrapXPropertyDisplay($object.display($propertyName, $action))\")\n   &lt;dt&gt;\n     &lt;label #if ($action == 'edit' &amp;&amp; !$isCheckbox)\n         for=\"$escapetool.xml(\"${object.xWikiClass.name}_${object.number}_$propertyName\")\"#end&gt;"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-user/xwiki-platform-user-profile/xwiki-platform-user-profile-ui/pom.xml",
          "status": "modified",
          "additions": 37,
          "deletions": 0,
          "patch": "@@ -118,5 +118,42 @@\n       <version>${project.version}</version>\n       <scope>runtime</scope>\n     </dependency>\n+    <!-- Test dependencies. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-test-page</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-web-templates</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <!-- Provides the component list for UIExtensionScriptService. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-uiextension-api</artifactId>\n+      <version>${project.version}</version>\n+      <classifier>tests</classifier>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <!-- Provides the component list for RenderingScriptService. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n+      <version>${project.version}</version>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-configuration-default</artifactId>\n+      <version>${project.version}</version>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n </project>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-user/xwiki-platform-user-profile/xwiki-platform-user-profile-ui/src/main/resources/XWiki/XWikiUserPreferencesSheet.xml",
          "status": "modified",
          "additions": 57,
          "deletions": 57,
          "patch": "@@ -20,7 +20,7 @@\n  * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n -->\n \n-<xwikidoc version=\"1.3\" reference=\"XWiki.XWikiUserPreferencesSheet\" locale=\"\">\n+<xwikidoc version=\"1.5\" reference=\"XWiki.XWikiUserPreferencesSheet\" locale=\"\">\n   <web>XWiki</web>\n   <name>XWikiUserPreferencesSheet</name>\n   <language/>\n@@ -73,11 +73,11 @@\n         <number>4</number>\n         <prettyName>Context elements</prettyName>\n         <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n+        <separator>, </separator>\n         <separators>|, </separators>\n         <size>5</size>\n         <unmodifiable>0</unmodifiable>\n-        <values>doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.parameters=Request parameters|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n+        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n         <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n       </async_context>\n       <async_enabled>\n@@ -97,6 +97,7 @@\n         <name>content</name>\n         <number>1</number>\n         <prettyName>Executed Content</prettyName>\n+        <restricted>0</restricted>\n         <rows>25</rows>\n         <size>120</size>\n         <unmodifiable>0</unmodifiable>\n@@ -127,6 +128,7 @@\n         <name>parameters</name>\n         <number>7</number>\n         <prettyName>Extension Parameters</prettyName>\n+        <restricted>0</restricted>\n         <rows>10</rows>\n         <size>40</size>\n         <unmodifiable>0</unmodifiable>\n@@ -173,72 +175,68 @@\n ###############################\n ##        CONTROLLER\n ###############################\n-#if(!$obj)\n-  {{info}}$services.localization.render('xe.admin.users.applyonusers'){{/info}}##\n+#if (!$obj)\n+  {{info}}{{translation key=\"xe.admin.users.applyonusers\" /}}{{/info}}\n #else\n   #displayFields()\n #end\n ###############################\n ##  DISPLAY FIELD OPTION LABEL\n ###############################\n-#macro(displayFieldOptionLabel $option)\n-  #if ($services.localization.render($option.label) != $option.label)\n-    $services.localization.render($option.label)\n+#macro (displayFieldOptionLabel $option)\n+  #if ($services.localization.get($option.label))\n+    $escapetool.xml($services.localization.render($option.label))\n   #else\n-    $option.value\n+    $escapetool.xml($option.value)\n   #end\n #end\n ###############################\n ##   DISPLAY SELECT FIELD\n ###############################\n-#macro(displaySelectField $fieldName $default)\n+#macro (displaySelectField $fieldName $defaultValue)\n   #set ($value = $doc.getValue($fieldName, $obj))\n   #set ($prop = $xclass.get($fieldName))\n   #set ($options = [])\n   #if ($prop.classType == 'Boolean')\n     #set ($discard = $options.add({'value': 1, 'label': 'yes'}))\n     #set ($discard = $options.add({'value': 0, 'label': 'no'}))\n   #elseif ($prop.classType == 'Timezone')\n-    #foreach($tz in $xwiki.jodatime.serverTimezone.availableIDs)\n-      #set ($discard = $options.add({'value': $tz, 'label': $tz}))\n-    #end\n-    ## If the default value is empty (nothing has been set by the administrator), the fallback is the timezone of the \n-    ## server. But we won't display the \"System Default\" option, which is technical (it supposes the user knows there \n-    ## is a server with its own timezone, etc...)\n-    #if (\"$!default\" == '')\n-      #set ($default = $xwiki.jodatime.serverTimezone)\n+    #foreach ($timeZoneId in $xwiki.jodatime.serverTimezone.availableIDs)\n+      #set ($discard = $options.add({'value': $timeZoneId, 'label': $timeZoneId}))\n     #end\n   #else\n-    #foreach($v in $prop.listValues)\n+    #foreach ($v in $prop.listValues)\n       #set ($discard = $options.add({'value': $v, 'label': \"XWiki.XWikiUsers_${fieldName}_${v}\"}))\n     #end\n   #end\n+  #set ($defaultValueHint = \"($escapetool.xml($services.localization.render('userprofile.default')))\")\n   #if ($isEdit)\n-    &lt;select name=\"XWiki.XWikiUsers_0_${fieldName}\" id=\"XWiki.XWikiUsers_0_${fieldName}\" size=\"1\"&gt;\n-      #if ($default)\n+    #set ($escapedId = $escapetool.xml(\"XWiki.XWikiUsers_0_${fieldName}\"))\n+    &lt;select name=\"$escapedId\" id=\"$escapedId\" size=\"1\"&gt;\n+      #if ($defaultValue)\n         &lt;option value=\"\"&gt;---&lt;/option&gt;\n       #end\n       #foreach ($option in $options)\n         ## Some properties actually have \"---\" as a possible value, so we don't display it because we have\n         ## already displayed it above.\n         #if ($option.value != '---')\n-          &lt;option value=\"$option.value\" #if($value == $option.value)selected=\"selected\"#end&gt;\n+          &lt;option value=\"$escapetool.xml($option.value)\"#if ($value == $option.value) selected#end&gt;\n             #displayFieldOptionLabel($option)\n-            #if ($default == $option.value)\n-              ($services.localization.render('userprofile.default'))\n+            #if ($defaultValue == $option.value)\n+              $defaultValueHint\n             #end\n           &lt;/option&gt;\n         #end\n       #end\n     &lt;/select&gt;\n   #else\n     #if (\"$!value\" != '')\n-      $doc.display($fieldName)\n+      #unwrapXPropertyDisplay($doc.display($fieldName))\n     #else\n       #foreach ($option in $options)\n-        #if (\"$!default\" == \"$!option.value\")\n+        #if (\"$!defaultValue\" == \"$!option.value\")\n           #displayFieldOptionLabel($option)\n-          &lt;small&gt;($services.localization.render('userprofile.default'))&lt;/small&gt;\n+          &lt;small&gt;$defaultValueHint&lt;/small&gt;\n         #end\n       #end\n     #end\n@@ -247,57 +245,56 @@\n ###############################\n ##      DISPLAY FIELD\n ###############################\n-#macro(displayField $fieldName $label $default)\n+#macro (displayField $fieldName $label $defaultValue)\n   #set ($hintKey = \"XWiki.XWikiUsers_${fieldName}.hint\")\n   &lt;dt&gt;\n-    &lt;label&gt;$services.localization.render($label)&lt;/label&gt;\n+    &lt;label&gt;$!escapetool.xml($services.localization.render($label))&lt;/label&gt;\n     #if ($services.localization.get($hintKey))\n-      &lt;span class=\"xHint\"&gt;$services.localization.render($hintKey)&lt;/span&gt;\n+      &lt;span class=\"xHint\"&gt;$!escapetool.xml($services.localization.render($hintKey))&lt;/span&gt;\n     #end\n   &lt;/dt&gt;\n-  &lt;dd&gt;\n+  &lt;dd data-user-property=\"$!escapetool.xml($fieldName)\"&gt;\n     #if ($fieldName == 'timezone' &amp;&amp; !$xwiki.jodatime)\n-      #if ($isEdit)\n-        &lt;input id=\"XWiki.XWikiUsers_0_${fieldName}\" name=\"XWiki.XWikiUsers_0_${fieldName}\" type=\"text\" value=\"$!escapetool.xml($obj.getValue($fieldName))\"/&gt;\n-      #else\n-        #if (\"$!obj.getValue('timezone')\" == '' &amp;&amp; \"$!xwiki.getXWikiPreference('timezone')\" != '')\n-          $xwiki.getXWikiPreference('timezone') &lt;small&gt;($services.localization.render('userprofile.default'))&lt;/small&gt;\n-        #else\n-          $doc.display('timezone')\n-        #end\n-      #end\n+      #unwrapXPropertyDisplay($doc.display('timezone'))\n     #else\n-      #displaySelectField($fieldName, $default)\n+      #displaySelectField($fieldName, $defaultValue)\n     #end\n   &lt;/dd&gt;\n #end\n ###############################\n ##      DISPLAY FIELDS\n ###############################\n-#macro(displayFields)\n-{{html}}\n-  &lt;div class=\"#if($xcontext.action == 'view')half #{else}full #{end}column xform\"&gt;\n+#macro (displayFields)\n+{{html clean=\"false\"}}\n+  &lt;div class=\"#if ($xcontext.action == 'view')half #{else}full #{end}column xform\"&gt;\n     &lt;div class=\"userPreferences\"&gt;\n-      #if($xcontext.action == 'view' &amp;&amp; $hasEdit)\n+      #if ($xcontext.action == 'view' &amp;&amp; $hasEdit)\n         &lt;div class=\"editProfileCategory\"&gt;\n-          &lt;a title=\"$escapetool.xml($services.localization.render('platform.core.profile.category.preferences.edit'))\"\n+          &lt;a title=\"$!escapetool.xml($services.localization.render('platform.core.profile.category.preferences.edit'))\"\n               href=\"$doc.getURL('edit', 'category=preferences')\" class=\"btn btn-xs\"&gt;\n             &lt;span class=\"action-icon\"&gt;$services.icon.renderHTML('pencil')&lt;/span&gt;\n-            &lt;span class='sr-only'&gt;$escapetool.xml($services.localization.render('platform.core.profile.category.preferences.edit'))&lt;/span&gt;\n+            &lt;span class='sr-only'&gt;$!escapetool.xml($services.localization.render(\n+              'platform.core.profile.category.preferences.edit'))&lt;/span&gt;\n           &lt;/a&gt;\n         &lt;/div&gt;\n       #end\n-      &lt;h1&gt;$services.localization.render('platform.core.profile.section.displayPreferences')&lt;/h1&gt;\n+      &lt;h1&gt;$escapetool.xml($services.localization.render('platform.core.profile.section.displayPreferences'))&lt;/h1&gt;\n       &lt;dl&gt;\n         #displayField('displayHiddenDocuments', 'platform.core.profile.displayHiddenDocuments', '0')\n         #displayField('accessibility'         , 'platform.core.profile.enableAccessibility'   , '0')\n       &lt;/dl&gt;\n-      &lt;h1&gt;$services.localization.render('platform.core.profile.section.localizationPreferences')&lt;/h1&gt;\n+      &lt;h1&gt;$escapetool.xml($services.localization.render('platform.core.profile.section.localizationPreferences'))&lt;/h1&gt;\n       &lt;dl&gt;\n         #set ($defaultValue = $xwiki.getXWikiPreference('timezone'))\n+        ## If the default value is empty (nothing has been set by the administrator), the fallback is the timezone of\n+        ## the server. But we won't display the \"System Default\" option, which is technical (it supposes the user knows\n+        ## there is a server with its own timezone, etc.).\n+        #if (\"$!defaultValue\" == '')\n+          #set ($defaultValue = $xwiki.jodatime.serverTimezone)\n+        #end\n         #displayField('timezone'              , 'platform.core.profile.timezone'              , $defaultValue)\n       &lt;/dl&gt;\n-      &lt;h1&gt;$services.localization.render('platform.core.profile.section.editorPreferences')&lt;/h1&gt;\n+      &lt;h1&gt;$escapetool.xml($services.localization.render('platform.core.profile.section.editorPreferences'))&lt;/h1&gt;\n       &lt;dl&gt;\n         #set ($defaultValue = $xwiki.getXWikiPreference('editor'))\n         #if (\"$!defaultValue\" == '')\n@@ -306,7 +303,7 @@\n         #displayField('editor'                , 'platform.core.profile.editor'                , $defaultValue)\n         #displayField('usertype'              , 'platform.core.profile.userType'              , 'Simple')\n       &lt;/dl&gt;\n-      &lt;h1&gt;$services.localization.render('platform.core.profile.section.extensionPreferences')&lt;/h1&gt;\n+      &lt;h1&gt;$escapetool.xml($services.localization.render('platform.core.profile.section.extensionPreferences'))&lt;/h1&gt;\n       &lt;dl&gt;\n         #set ($defaultValue = $xwiki.getXWikiPreference('extensionConflictSetup'))\n         #if (\"$!defaultValue\" == '')\n@@ -316,17 +313,20 @@\n       &lt;/dl&gt;\n     &lt;/div&gt;\n   &lt;/div&gt;\n-  #set($isMyProfile = ($xwiki.getDocument($xcontext.user).prefixedFullName == $doc.prefixedFullName))\n-  #if(($isMyProfile || $hasAdmin) &amp;&amp; ($xcontext.action == 'view') &amp;&amp; !$doc.getObject('XWiki.LDAPProfileClass'))\n+  #set ($isMyProfile = $xwiki.getDocument($xcontext.user).prefixedFullName == $doc.prefixedFullName)\n+  #if (($isMyProfile || $hasAdmin) &amp;&amp; $xcontext.action == 'view' &amp;&amp; !$doc.getObject('XWiki.LDAPProfileClass'))\n     &lt;div class=\"half column\"&gt;\n       &lt;div class=\"passwordManagement\"&gt;\n-        &lt;h1&gt;$services.localization.render('platform.core.profile.section.security')&lt;/h1&gt;\n-        &lt;span class=\"buttonwrapper\"&gt;&lt;a id=\"changePassword\" href=\"$doc.getURL('view', 'xpage=passwd')\"&gt;$services.localization.render('platform.core.profile.changePassword')&lt;/a&gt;&lt;/span&gt;\n+        &lt;h1&gt;$escapetool.xml($services.localization.render('platform.core.profile.section.security'))&lt;/h1&gt;\n+        &lt;span class=\"buttonwrapper\"&gt;\n+          &lt;a id=\"changePassword\" href=\"$doc.getURL('view', 'xpage=passwd')\"&gt;$escapetool.xml(\n+            $services.localization.render('platform.core.profile.changePassword'))&lt;/a&gt;\n+        &lt;/span&gt;\n       &lt;/div&gt;\n     &lt;/div&gt;\n   #end\n   &lt;div class=\"clearfloats\"&gt;&amp;nbsp;&lt;/div&gt;\n-{{/html}}##\n+{{/html}}\n #end\n {{/velocity}}</content>\n     </property>\n@@ -340,7 +340,7 @@\n       <parameters>id=preferences\n icon=wrench\n # isActive: The user is seeing her own profile or the user is an admin.\n-isActive=#if(($services.model.resolveDocument($xcontext.user) == $doc.documentReference) || $hasAdmin)true#{else}false#end\n+isActive=#if ($xcontext.userReference == $doc.documentReference || $hasAdmin)true#{else}false#end\n priority=20</parameters>\n     </property>\n     <property>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-user/xwiki-platform-user-profile/xwiki-platform-user-profile-ui/src/test/java/org/xwiki/user/profile/UserProfilePageTest.java",
          "status": "added",
          "additions": 134,
          "deletions": 0,
          "patch": "@@ -0,0 +1,134 @@\n+/*\n+ * See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU Lesser General Public License as\n+ * published by the Free Software Foundation; either version 2.1 of\n+ * the License, or (at your option) any later version.\n+ *\n+ * This software is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this software; if not, write to the Free\n+ * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n+ * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n+ */\n+package org.xwiki.user.profile;\n+\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+import org.jsoup.Jsoup;\n+import org.jsoup.nodes.Document;\n+import org.jsoup.nodes.Element;\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.xwiki.bridge.event.DocumentCreatedEvent;\n+import org.xwiki.component.manager.ComponentManager;\n+import org.xwiki.component.wiki.internal.bridge.DefaultWikiObjectComponentManagerEventListener;\n+import org.xwiki.model.reference.DocumentReference;\n+import org.xwiki.observation.EventListener;\n+import org.xwiki.rendering.RenderingScriptServiceComponentList;\n+import org.xwiki.rendering.internal.configuration.DefaultRenderingConfigurationComponentList;\n+import org.xwiki.security.authorization.AuthorizationManager;\n+import org.xwiki.test.annotation.ComponentList;\n+import org.xwiki.test.page.HTML50ComponentList;\n+import org.xwiki.test.page.PageTest;\n+import org.xwiki.test.page.XWikiSyntax20ComponentList;\n+import org.xwiki.uiextension.script.UIExtensionScriptServiceComponentList;\n+\n+import com.xpn.xwiki.doc.XWikiDocument;\n+import com.xpn.xwiki.internal.mandatory.XWikiUsersDocumentInitializer;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.ArgumentMatchers.eq;\n+import static org.mockito.Mockito.when;\n+\n+/**\n+ * Page test of {@code XWiki.XWikiUserSheet} that is used to display the user profile.\n+ * \n+ * @version $Id$\n+ * @since 14.10.5\n+ * @since 15.1RC1\n+ */\n+@HTML50ComponentList\n+@XWikiSyntax20ComponentList\n+@RenderingScriptServiceComponentList\n+@DefaultRenderingConfigurationComponentList\n+@UIExtensionScriptServiceComponentList\n+@ComponentList({XWikiUsersDocumentInitializer.class})\n+class UserProfilePageTest extends PageTest\n+{\n+    private static final DocumentReference USER_SHEET = new DocumentReference(\"xwiki\", \"XWiki\", \"XWikiUserSheet\");\n+\n+    private static final DocumentReference USER_PREFERENCES_SHEET =\n+        new DocumentReference(\"xwiki\", \"XWiki\", \"XWikiUserPreferencesSheet\");\n+\n+    private static final DocumentReference ADMIN_REFERENCE = new DocumentReference(\"xwiki\", \"XWiki\", \"Admin\");\n+\n+    private static final DocumentReference ALICE_REFERENCE = new DocumentReference(\"xwiki\", \"XWiki\", \"alice\");\n+\n+    @BeforeEach\n+    void setUp() throws Exception\n+    {\n+        // Initialize the XWiki.XWikiUsers class (required in order to be able to display user properties).\n+        this.xwiki.initializeMandatoryDocuments(this.context);\n+\n+        AuthorizationManager authorizationManager =\n+            this.componentManager.registerMockComponent(AuthorizationManager.class);\n+        when(authorizationManager.hasAccess(any(), eq(ADMIN_REFERENCE), any())).thenReturn(true);\n+\n+        // Register the user profile UI extensions at wiki level (requires administration rights).\n+        this.componentManager.registerComponent(ComponentManager.class, \"wiki\", this.componentManager);\n+        this.context.setUserReference(ADMIN_REFERENCE);\n+        registerUIX(USER_PREFERENCES_SHEET);\n+    }\n+\n+    @Test\n+    void timeZoneDisplay() throws Exception\n+    {\n+        Map<String, Object> userProperties = new HashMap<>();\n+        userProperties.put(\"timezone\", \"Europe/<em>Bucharest</em>\");\n+        createUser(userProperties);\n+\n+        Document dom = renderSheet(USER_SHEET);\n+        Element timeZone = dom.selectFirst(\".userPreferences dd[data-user-property='timezone']\");\n+        assertEquals(userProperties.get(\"timezone\"), timeZone.text());\n+    }\n+\n+    private void registerUIX(DocumentReference documentReference) throws Exception\n+    {\n+        XWikiDocument document = loadPage(documentReference);\n+\n+        // The event listeners are not registered by default. We trigger it manually so that the UIX is registered and\n+        // can be found and rendered.\n+        this.componentManager\n+            .<EventListener>getInstance(EventListener.class,\n+                DefaultWikiObjectComponentManagerEventListener.EVENT_LISTENER_NAME)\n+            .onEvent(new DocumentCreatedEvent(), document, null);\n+    }\n+\n+    private XWikiDocument createUser(Map<String, Object> userProperties) throws Exception\n+    {\n+        this.xwiki.createUser(ALICE_REFERENCE.getName(), userProperties, this.context);\n+        XWikiDocument userDocument = this.xwiki.getDocument(ALICE_REFERENCE, this.context);\n+\n+        // Setup the script context as if we are logged in with the created user on its user profile.\n+        this.context.setDoc(userDocument);\n+        this.context.setUserReference(ALICE_REFERENCE);\n+\n+        return userDocument;\n+    }\n+\n+    private Document renderSheet(DocumentReference sheetReference) throws Exception\n+    {\n+        XWikiDocument sheet = loadPage(sheetReference);\n+\n+        return Jsoup.parse(sheet.getRenderedContent(this.context));\n+    }\n+}"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-templates/src/main/resources/templates/displayer_timezone.vm",
          "status": "modified",
          "additions": 17,
          "deletions": 11,
          "patch": "@@ -17,22 +17,28 @@\n ## Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n ## 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n ## ---------------------------------------------------------------------------\n-#if ($type == 'edit' || $type == 'search')\n-  #if($xwiki.jodatime)\n-    <select id='$prefix$name' name='$prefix$name'>\n-      <option value=\"\" #if($value == $tz)selected=\"selected\"#end>$services.localization.render('XWiki.XWikiPreferences_timezone_default')</option>\n-      #foreach($tz in $xwiki.jodatime.getServerTimezone().getAvailableIDs())\n-        <option value=\"$tz\" #if($value == $tz)selected=\"selected\"#end>$tz</option>\n+#if ($type == 'edit' || $type == 'search' || $type == 'hidden')\n+  #set ($escapedId = $escapetool.xml(\"${prefix}${name}\"))\n+  #if ($xwiki.jodatime && $type != 'hidden')\n+    <select id=\"$!escapedId\" name=\"$!escapedId\">\n+      <option value=\"\">$!escapetool.xml($services.localization.render(\n+        'XWiki.XWikiPreferences_timezone_default'))</option>\n+      #foreach ($timeZoneId in $xwiki.jodatime.getServerTimezone().getAvailableIDs())\n+        <option value=\"$!escapetool.xml($timeZoneId)\"#if ($value == $timeZoneId) selected#end\n+          >$!escapetool.xml($timeZoneId)</option>\n       #end\n     </select>\n   #else\n-    <input id='$prefix$name' name='$prefix$name' type=\"text\" value=\"$!value\"/>\n+    #set ($inputType = \"#if ($type == 'hidden')hidden#{else}text#end\")\n+    <input id=\"$!escapedId\" name=\"$!escapedId\" type=\"$!escapetool.xml($inputType)\" value=\"$!escapetool.xml($value)\" />\n   #end\n #elseif ($type == 'view' || $type == 'rendered')\n-$!value\n-#elseif ($type == 'hidden')\n-  #set ($id = $escapetool.xml(\"${prefix}${name}\"))\n-  <input type=\"hidden\" id=\"$!id\" name=\"$!id\" value=\"$!escapetool.xml($value)\" />\n+## $defaultValue may be set before calling the displayer.\n+#if (\"$!value\" == '' && \"$!defaultValue\" != '')\n+$!escapetool.xml($defaultValue) <small>($escapetool.xml($services.localization.render('userprofile.default')))</small>\n+#else\n+$!escapetool.xml($value)\n+#end\n #else\n   ## In order for the custom displayer to be taken into account, the result of its evaluation with an unknown display\n   ## mode must not be empty. Let's output something."
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-templates/src/main/resources/templates/macros.vm",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -3017,4 +3017,18 @@ Recursive title display detected!##\n #else\n #setVariable(\"$resultValue\" '')\n #end\n+#end\n+\n+#**\n+ * The output of the api.Document#display(...) methods is wrapped in an HTML (wiki syntax) rendering macro if it contains\n+ * HTML special characters or if it tries to close the outer HTML macro. This can be annoying when the output is going to\n+ * be insered in another HTML macro with wiki syntax disabled, or if the output is meant to be included in a JSON and\n+ * thus used on the client-side where we can't render the wiki syntax. For these use cases we need to get rid of the HTML\n+ * macro wrapping.\n+ *\n+ * @since 14.10.5\n+ * @since 15.1RC1\n+ *#\n+#macro (unwrapXPropertyDisplay $displayOutput)\n+$!stringtool.removeEnd($stringtool.removeStart($displayOutput, '{{html clean=\"false\" wiki=\"false\"}}'), '{{/html}}')##\n #end\n\\ No newline at end of file"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-wiki/xwiki-platform-wiki-ui/xwiki-platform-wiki-ui-mainwiki/src/main/resources/WikiManager/WikisLiveTableResultsMacros.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -415,7 +415,7 @@\n       #set($propType = \"$!propClass.get($colname).type\")\n     #end\n     #set($fieldValue = \"$!itemDoc.getValue($colname)\")\n-    #set($fieldDisplayValue = \"$!itemDoc.display($colname, 'view')\")\n+    #set($fieldDisplayValue = \"#unwrapXPropertyDisplay($itemDoc.display($colname, 'view'))\")\n     #if($fieldDisplayValue == '')\n       #set($fieldDisplayValue = $services.localization.render(\"${request.transprefix}emptyvalue\"))\n     #end\n@@ -427,7 +427,7 @@\n         #set($fieldUrl = '')\n       #end\n     #end\n-    #set($discard = $row.put($colname, $fieldDisplayValue.replaceFirst($regextool.quote('{{html clean=\"false\" wiki=\"false\"}}'), '').replaceAll(\"$regextool.quote('{{/html}}')$\", '')))\n+    #set($discard = $row.put($colname, $fieldDisplayValue))\n     #set($discard = $row.put(\"${colname}_value\", $fieldValue))\n     ######## WIKI UI MAINWIKI CUSTOMIZATION #########\n     #if($colname == 'wikiprettyname')"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 15,
        "max_directory_depth": 11
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-79",
    "description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any registered user can exploit a stored XSS through their user profile by setting the payload as the value of the time zone user preference. Even though the time zone is selected from a drop down (no free text value) it can still be set from JavaScript (using the browser developer tools) or by calling the save URL on the user profile with the right query string. Once the time zone is set it is displayed without escaping which means the payload gets executed for any user that visits the malicious user profile, allowing the attacker to steal information and even gain more access rights (escalation to programming rights). This issue is present since version 4.1M2 when the time zone user preference was introduced. The issue has been fixed in XWiki 14.10.5 and 15.1RC1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-23T20:15:08.927",
    "last_modified": "2024-11-21T08:18:56.023",
    "fix_date": "2023-02-08T08:05:32Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/d11ca5d781f8a42a85bc98eb82306c1431e764d4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h8cm-3v5f-rgp6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-7847",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/d11ca5d781f8a42a85bc98eb82306c1431e764d4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-h8cm-3v5f-rgp6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-7847",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.465288",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}