{
  "cve_id": "CVE-2023-40178",
  "github_data": {
    "repository": "node-saml/node-saml",
    "fix_commit": "045e3b9c54211fdb95f96edf363679845b195cec",
    "related_commits": [
      "045e3b9c54211fdb95f96edf363679845b195cec",
      "045e3b9c54211fdb95f96edf363679845b195cec"
    ],
    "patch_url": "https://github.com/node-saml/node-saml/commit/045e3b9c54211fdb95f96edf363679845b195cec.patch",
    "fix_commit_details": {
      "sha": "045e3b9c54211fdb95f96edf363679845b195cec",
      "commit_date": "2023-08-18T18:07:34Z",
      "author": {
        "login": "jindazhao01",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-vx8m-6fhw-pccw",
        "length": 177,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 19,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/saml.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1265,6 +1265,7 @@ class SAML {\n     dom: Document,\n   ): Promise<{ profile: Profile; loggedOut: boolean }> {\n     const request = doc.LogoutRequest;\n+    this.verifyLogoutRequest(doc);\n     if (request) {\n       const profile = {} as Profile;\n       if (request.$.ID) {"
        },
        {
          "filename": "test/static/logout_request_with_bad_expiration.xml",
          "status": "added",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -0,0 +1,6 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<saml2p:LogoutRequest xmlns:saml2p=\"urn:oasis:names:tc:SAML:2.0:protocol\" Destination=\"http://idp.example.com/SingleLogoutService.php\" ID=\"pfxd4d369e8-9ea1-780c-aff8-a1d11a9862a1\" IssueInstant=\"2013-08-17T22:17:51.000Z\" NotOnOrAfter=\"2022-08-17T22:17:51.000Z\" Version=\"2.0\">\n+    <saml2:Issuer xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">http://sp.example.com/demo1/metadata.php</saml2:Issuer>\n+<saml2:NameID xmlns:saml2=\"urn:oasis:names:tc:SAML:2.0:assertion\">test@email.com</saml2:NameID>\n+    <saml2p:SessionIndex>_P230330115104244DUB9FUDV49NSOB5</saml2p:SessionIndex>\n+<Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/><SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/><Reference URI=\"#pfxd4d369e8-9ea1-780c-aff8-a1d11a9862a1\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/><DigestValue>26LYQJFuGaMg9xdZLo+6J118KHU=</DigestValue></Reference></SignedInfo><SignatureValue>OTzlyaL0HDLLC9xLgwctQhHB5hthWjmnVho6g7p8e5m84c4J+/08GLaC8/Iz/cqXcoxU32PZr3MLnPAqEY2RwfCIldhMyXmRdVRi4DkiXmOmhw+tzgbXo6kGe+28rTSnXJ7L97NkX48T83bsfGZ+LAdEHe9ZQUL+vWZYXwn7xVagiTJ1YjfUO44UVdTelAJ9kQKQcIjW7A6WafyYqC7dqahvGsgYJ4o4grBkaP+PxfJ5vwuTW0qkjLH7wcLRfpJDeCiWwdNr9W6TgV8C8qJ0fDtl5xfYvSPmbDViXA89TQhu9uCu7tJQpjCeCv1hAO7igj2TbP87QNTyOhseNKpzKA==</SignatureValue><KeyInfo><X509Data/></KeyInfo></Signature></saml2p:LogoutRequest>\n\\ No newline at end of file"
        },
        {
          "filename": "test/tests.spec.ts",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -2847,6 +2847,18 @@ describe(\"node-saml /\", function () {\n       });\n     });\n \n+    it(\"errors if expired\", async () => {\n+      const body = {\n+        SAMLRequest: fs.readFileSync(\n+          __dirname + \"/static/logout_request_with_bad_expiration.xml\",\n+          \"base64\",\n+        ),\n+      };\n+      await assert.rejects(samlObj.validatePostRequestAsync(body), {\n+        message: \"SAML assertion expired: clocks skewed too much\",\n+      });\n+    });\n+\n     it(\"returns profile for valid signature\", async () => {\n       const body = {\n         SAMLRequest: fs.readFileSync("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0d3d3fae7328ca6a7aaaf36dfe030b8f1baf7da4",
            "date": "2024-06-30T12:44:30Z",
            "author_login": "KiwiKilian"
          },
          {
            "sha": "c0219879456dfc00d624578737b5582515edf9cd",
            "date": "2024-04-10T16:37:29Z",
            "author_login": "markstos"
          },
          {
            "sha": "4c3b6a0061cd7350d8dd340a7023d8f6d82e6ebd",
            "date": "2024-04-09T22:34:15Z",
            "author_login": "cjbarth"
          },
          {
            "sha": "72a39dcf46a93a8679123db78b22ff82d6dd4096",
            "date": "2024-02-27T03:46:28Z",
            "author_login": "cjbarth"
          },
          {
            "sha": "37ee11ec4b0f3a31813d93bb5d358556f12b76e2",
            "date": "2024-02-15T04:09:48Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-347",
    "description": "Node-SAML is a SAML library not dependent on any frameworks that runs in Node. The lack of checking of current timestamp allows a LogoutRequest XML to be reused multiple times even when the current time is past the NotOnOrAfter. This could impact the user where they would be logged out from an expired LogoutRequest. In bigger contexts, if LogoutRequests are sent out in mass to different SPs, this could impact many users on a large scale. This issue was patched in version 4.0.5.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-23T21:15:08.877",
    "last_modified": "2024-11-21T08:18:56.333",
    "fix_date": "2023-08-18T18:07:34Z"
  },
  "references": [
    {
      "url": "https://github.com/node-saml/node-saml/commit/045e3b9c54211fdb95f96edf363679845b195cec",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/node-saml/node-saml/releases/tag/v4.0.5",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/node-saml/node-saml/security/advisories/GHSA-vx8m-6fhw-pccw",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/node-saml/node-saml/commit/045e3b9c54211fdb95f96edf363679845b195cec",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/node-saml/node-saml/releases/tag/v4.0.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/node-saml/node-saml/security/advisories/GHSA-vx8m-6fhw-pccw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.465815",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "node-saml",
    "owner": "node-saml",
    "created_at": "2021-05-13T16:32:42Z",
    "updated_at": "2024-12-17T21:54:20Z",
    "pushed_at": "2024-06-30T12:44:30Z",
    "size": 2739,
    "stars": 102,
    "forks": 64,
    "open_issues": 20,
    "watchers": 102,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "TypeScript": 449575,
      "JavaScript": 2649
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:12:42.124925"
  }
}