{
  "cve_id": "CVE-2023-40184",
  "github_data": {
    "repository": "neutrinolabs/xrdp",
    "fix_commit": "a111a0fdfe2421ef600e40708b5f0168594cfb23",
    "related_commits": [
      "a111a0fdfe2421ef600e40708b5f0168594cfb23",
      "a111a0fdfe2421ef600e40708b5f0168594cfb23"
    ],
    "patch_url": "https://github.com/neutrinolabs/xrdp/commit/a111a0fdfe2421ef600e40708b5f0168594cfb23.patch",
    "fix_commit_details": {
      "sha": "a111a0fdfe2421ef600e40708b5f0168594cfb23",
      "commit_date": "2023-08-24T01:14:48Z",
      "author": {
        "login": "metalefty",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-f489-557v-47jq",
        "length": 78,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 55,
        "additions": 50,
        "deletions": 5
      },
      "files": [
        {
          "filename": "sesman/libsesman/verify_user_pam.c",
          "status": "modified",
          "additions": 22,
          "deletions": 2,
          "patch": "@@ -397,8 +397,8 @@ auth_uds(const char *user, enum scp_login_status *errorcode)\n /******************************************************************************/\n \n /* returns error */\n-int\n-auth_start_session(struct auth_info *auth_info, int display_num)\n+static int\n+auth_start_session_private(struct auth_info *auth_info, int display_num)\n {\n     int error;\n     char display[256];\n@@ -436,6 +436,26 @@ auth_start_session(struct auth_info *auth_info, int display_num)\n     return 0;\n }\n \n+/******************************************************************************/\n+/**\n+ * Main routine to start a session\n+ *\n+ * Calls the private routine and logs an additional error if the private\n+ * routine fails\n+ */\n+int\n+auth_start_session(struct auth_info *auth_info, int display_num)\n+{\n+    int result = auth_start_session_private(auth_info, display_num);\n+    if (result != 0)\n+    {\n+        LOG(LOG_LEVEL_ERROR,\n+            \"Can't start PAM session. See PAM logging for more info\");\n+    }\n+\n+    return result;\n+}\n+\n /******************************************************************************/\n /* returns error */\n static int"
        },
        {
          "filename": "sesman/libsesman/verify_user_pam_userpass.c",
          "status": "modified",
          "additions": 22,
          "deletions": 2,
          "patch": "@@ -207,8 +207,8 @@ auth_uds(const char *user, enum scp_login_status *errorcode)\n /******************************************************************************/\n \n /* returns error */\n-int\n-auth_start_session(struct auth_info *auth_info, int display_num)\n+static int\n+auth_start_session_private(struct auth_info *auth_info, int display_num)\n {\n     int error;\n     char display[256];\n@@ -246,6 +246,26 @@ auth_start_session(struct auth_info *auth_info, int display_num)\n     return 0;\n }\n \n+/******************************************************************************/\n+/**\n+ * Main routine to start a session\n+ *\n+ * Calls the private routine and logs an additional error if the private\n+ * routine fails\n+ */\n+int\n+auth_start_session(struct auth_info *auth_info, int display_num)\n+{\n+    int result = auth_start_session_private(auth_info, display_num);\n+    if (result != 0)\n+    {\n+        LOG(LOG_LEVEL_ERROR,\n+            \"Can't start PAM session. See PAM logging for more info\");\n+    }\n+\n+    return result;\n+}\n+\n /******************************************************************************/\n /* returns error */\n static int"
        },
        {
          "filename": "sesman/sesexec/session.c",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -568,7 +568,12 @@ session_start_wrapped(struct login_info *login_info,\n     int window_manager_pid;\n     enum scp_screate_status status = E_SCP_SCREATE_GENERAL_ERROR;\n \n-    auth_start_session(login_info->auth_info, s->display);\n+    if (auth_start_session(login_info->auth_info, s->display) != 0)\n+    {\n+        // Errors are logged by the auth module, as they are\n+        // specific to that module\n+        return E_SCP_SCREATE_GENERAL_ERROR;\n+    }\n #ifdef USE_BSD_SETLOGIN\n     /**\n      * Create a new session and process group since the 4.4BSD"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a0f1b65aee5343bc6d8a9520cefd96948a1b9102",
            "date": "2025-01-13T11:48:30Z",
            "author_login": "matt335672"
          },
          {
            "sha": "b04743066d1edc18eeb6d9984bc4a302e5a3eb85",
            "date": "2025-01-13T10:11:51Z",
            "author_login": "matt335672"
          },
          {
            "sha": "d98c883dfb57b3b05516b7adbd4ee237259fa7ee",
            "date": "2025-01-09T11:34:41Z",
            "author_login": "matt335672"
          },
          {
            "sha": "99b6aaff6ce12687da0d998a27f67d9b384eac53",
            "date": "2025-01-09T10:37:40Z",
            "author_login": "matt335672"
          },
          {
            "sha": "35179f0fc54dfae36fcb0eab92a16b67fe6402c0",
            "date": "2025-01-09T10:17:00Z",
            "author_login": "matt335672"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-755",
    "description": " xrdp is an open source remote desktop protocol (RDP) server. In versions prior to 0.9.23 improper handling of session establishment errors allows bypassing OS-level session restrictions. The `auth_start_session` function can return non-zero (1) value on, e.g., PAM error which may result in in session restrictions such as max concurrent sessions per user by PAM (ex ./etc/security/limits.conf) to be bypassed. Users (administrators) don't use restrictions by PAM are not affected. This issue has been addressed in release version 0.9.23. Users are advised to upgrade. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-08-30T18:15:09.690",
    "last_modified": "2024-11-21T08:18:57.260",
    "fix_date": "2023-08-24T01:14:48Z"
  },
  "references": [
    {
      "url": "https://github.com/neutrinolabs/xrdp/blame/9bbb2ec68f390504c32f2062847aa3d821a0089a/sesman/sesexec/session.c#L571C5-L571C19",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/commit/a111a0fdfe2421ef600e40708b5f0168594cfb23",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/security/advisories/GHSA-f489-557v-47jq",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SOT237TIHTHPX5YNIWLVNINOEYC7WMG2/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/U5IXMQODV3OIJ7DRQBUQV7PUKNT7SH36/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/URO3FKTFBPNKFARAQBEJLI4MH6YS35P5/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/blame/9bbb2ec68f390504c32f2062847aa3d821a0089a/sesman/sesexec/session.c#L571C5-L571C19",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/commit/a111a0fdfe2421ef600e40708b5f0168594cfb23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/neutrinolabs/xrdp/security/advisories/GHSA-f489-557v-47jq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SOT237TIHTHPX5YNIWLVNINOEYC7WMG2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/U5IXMQODV3OIJ7DRQBUQV7PUKNT7SH36/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/URO3FKTFBPNKFARAQBEJLI4MH6YS35P5/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.488998",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xrdp",
    "owner": "neutrinolabs",
    "created_at": "2011-04-25T14:31:17Z",
    "updated_at": "2025-01-13T11:48:35Z",
    "pushed_at": "2025-01-13T11:48:30Z",
    "size": 16515,
    "stars": 5870,
    "forks": 1738,
    "open_issues": 268,
    "watchers": 5870,
    "has_security_policy": false,
    "default_branch": "devel",
    "protected_branches": [
      "devel"
    ],
    "languages": {
      "C": 4054760,
      "M4": 62000,
      "Shell": 47300,
      "C++": 41259,
      "Makefile": 29077,
      "ActionScript": 1532,
      "QMake": 821
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:37:05.964520"
  }
}