{
  "cve_id": "CVE-2023-40586",
  "github_data": {
    "repository": "corazawaf/coraza",
    "fix_commit": "a5239ba3ce839e14d9b4f9486e1b4a403dcade8c",
    "related_commits": [
      "a5239ba3ce839e14d9b4f9486e1b4a403dcade8c",
      "a5239ba3ce839e14d9b4f9486e1b4a403dcade8c"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a5239ba3ce839e14d9b4f9486e1b4a403dcade8c",
      "commit_date": "2023-06-25T16:16:26Z",
      "author": {
        "login": "jptosso",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-c2pj-v37r-2p6h",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 20,
        "additions": 18,
        "deletions": 2
      },
      "files": [
        {
          "filename": "internal/bodyprocessors/multipart.go",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -7,7 +7,6 @@ import (\n \t\"errors\"\n \t\"fmt\"\n \t\"io\"\n-\t\"log\"\n \t\"mime\"\n \t\"mime/multipart\"\n \t\"os\"\n@@ -25,7 +24,7 @@ func (mbp *multipartBodyProcessor) ProcessRequest(reader io.Reader, v plugintype\n \tstoragePath := options.StoragePath\n \tmediaType, params, err := mime.ParseMediaType(mimeType)\n \tif err != nil {\n-\t\tlog.Fatalf(\"failed to parse media type: %s\", err.Error())\n+\t\treturn err\n \t}\n \tif !strings.HasPrefix(mediaType, \"multipart/\") {\n \t\treturn errors.New(\"not a multipart body\")"
        },
        {
          "filename": "internal/bodyprocessors/multipart_test.go",
          "status": "modified",
          "additions": 17,
          "deletions": 0,
          "patch": "@@ -77,3 +77,20 @@ Content-Type: text/html\n \t\t}\n \t}\n }\n+\n+func TestInvalidMultipartCT(t *testing.T) {\n+\tpayload := strings.TrimSpace(`\n+-----------------------------9051914041544843365972754266\n+Content-Disposition: form-data; name=\"text\"\n+\n+text default\n+-----------------------------9051914041544843365972754266\n+`)\n+\tmp := multipartProcessor(t)\n+\tv := corazawaf.NewTransactionVariables()\n+\tif err := mp.ProcessRequest(strings.NewReader(payload), v, plugintypes.BodyProcessorOptions{\n+\t\tMime: \"multipart/form-data; boundary=---------------------------9051914041544843365972754266; a=1; a=2\",\n+\t}); err == nil {\n+\t\tt.Error(\"multipart processor should fail for invalid content-type\")\n+\t}\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "791bd91e72b23c58c69ecd6d1c86b75dd3ab28ad",
            "date": "2025-01-26T01:48:27Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "7c6d46419cff2c350f2e15723609a0a534e6f4cf",
            "date": "2025-01-25T00:44:40Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "761cd64a81c2bf607ada81cf06f2175492d3218a",
            "date": "2025-01-24T17:00:19Z",
            "author_login": "tty2"
          },
          {
            "sha": "077bde8d53ddcad8670ba9ca22e8c845febaa59f",
            "date": "2025-01-24T16:44:55Z",
            "author_login": "M4tteoP"
          },
          {
            "sha": "ff568b8b4990a828ccfc9207a62f9ecef39e0578",
            "date": "2025-01-24T01:14:41Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "OWASP Coraza WAF is a golang modsecurity compatible web application firewall library. Due to the misuse of `log.Fatalf`, the application using coraza crashed after receiving crafted requests from attackers. The application will immediately crash after receiving a malicious request that triggers an error in `mime.ParseMediaType`. This issue was patched in version 3.0.1.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-25T21:15:09.197",
    "last_modified": "2024-11-21T08:19:46.147",
    "fix_date": "2023-06-25T16:16:26Z"
  },
  "references": [
    {
      "url": "https://github.com/corazawaf/coraza/commit/a5239ba3ce839e14d9b4f9486e1b4a403dcade8c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/corazawaf/coraza/commit/a5239ba3ce839e14d9b4f9486e1b4a403dcade8c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.475685",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "coraza",
    "owner": "corazawaf",
    "created_at": "2020-05-27T17:06:51Z",
    "updated_at": "2025-01-26T01:48:32Z",
    "pushed_at": "2025-01-26T01:48:28Z",
    "size": 30795,
    "stars": 2398,
    "forks": 237,
    "open_issues": 82,
    "watchers": 2398,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Go": 1080660
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:25:58.450771"
  }
}