{
  "cve_id": "CVE-2023-41885",
  "github_data": {
    "repository": "piccolo-orm/piccolo",
    "fix_commit": "edcfe3568382922ba3e3b65896e6e7272f972261",
    "related_commits": [
      "edcfe3568382922ba3e3b65896e6e7272f972261",
      "edcfe3568382922ba3e3b65896e6e7272f972261"
    ],
    "patch_url": "https://github.com/piccolo-orm/piccolo/commit/edcfe3568382922ba3e3b65896e6e7272f972261.patch",
    "fix_commit_details": {
      "sha": "edcfe3568382922ba3e3b65896e6e7272f972261",
      "commit_date": "2023-09-11T19:41:25Z",
      "author": {
        "login": "dantownsend",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-h7cm-mrvq-wcfr",
        "length": 91,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "piccolo/apps/user/tables.py",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -212,7 +212,10 @@ async def login(cls, username: str, password: str) -> t.Optional[int]:\n             .run()\n         )\n         if not response:\n-            # No match found\n+            # No match found. We still call hash_password\n+            # here to mitigate the ability to enumerate\n+            # users via response timings\n+            cls.hash_password(password)\n             return None\n \n         stored_password = response[\"password\"]"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "965c5b3ef2311a0ecb39a09341d5a6ebabc25b5d",
            "date": "2025-01-07T20:02:15Z",
            "author_login": "dantownsend"
          },
          {
            "sha": "7373a8490c84e3c1577d987a34dbc376474c2c30",
            "date": "2024-11-07T05:04:51Z",
            "author_login": "daveflr"
          },
          {
            "sha": "448a818e3e7420e6f052b6e79473bbeee0b3e76f",
            "date": "2024-10-23T22:07:42Z",
            "author_login": "dantownsend"
          },
          {
            "sha": "db57d6e4f952ddd6e50d9fb10728ded4f4cdd4b3",
            "date": "2024-10-23T21:41:18Z",
            "author_login": "dantownsend"
          },
          {
            "sha": "85ead5a055639aff4e9247baff173c6455145106",
            "date": "2024-10-23T20:40:19Z",
            "author_login": "dantownsend"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-204",
    "description": "Piccolo is an ORM and query builder which supports asyncio. In versions 0.120.0 and prior, the implementation of `BaseUser.login` leaks enough information to a malicious user such that they would be able to successfully generate a list of valid users on the platform. As Piccolo on its own does not also enforce strong passwords, these lists of valid accounts are likely to be used in a password spray attack with the outcome being attempted takeover of user accounts on the platform. The impact of this vulnerability is minor as it requires chaining with other attack vectors in order to gain more then simply a list of valid users on the underlying platform. The likelihood of this vulnerability is possible as it requires minimal skills to pull off, especially given the underlying login functionality for Piccolo based sites is open source. This issue has been patched in version 0.121.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-12T21:15:08.163",
    "last_modified": "2024-11-21T08:21:51.097",
    "fix_date": "2023-09-11T19:41:25Z"
  },
  "references": [
    {
      "url": "https://github.com/piccolo-orm/piccolo/commit/edcfe3568382922ba3e3b65896e6e7272f972261",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-h7cm-mrvq-wcfr",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/piccolo-orm/piccolo/commit/edcfe3568382922ba3e3b65896e6e7272f972261",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/piccolo-orm/piccolo/security/advisories/GHSA-h7cm-mrvq-wcfr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:08.404128",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "piccolo",
    "owner": "piccolo-orm",
    "created_at": "2018-10-27T20:53:26Z",
    "updated_at": "2025-01-14T12:25:23Z",
    "pushed_at": "2025-01-07T20:02:15Z",
    "size": 4418,
    "stars": 1512,
    "forks": 90,
    "open_issues": 153,
    "watchers": 1512,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 1413885,
      "Jinja": 23624,
      "Shell": 3194,
      "CSS": 1056
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:41:44.365052"
  }
}