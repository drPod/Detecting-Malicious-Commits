{
  "cve_id": "CVE-2023-4221",
  "github_data": {
    "repository": "chamilo/chamilo-lms",
    "fix_commit": "841a07396fed0ef27c5db13a1b700eac02754fc7",
    "related_commits": [
      "841a07396fed0ef27c5db13a1b700eac02754fc7",
      "ed72914608d2a07ee2eb587c1a654480d08201db",
      "841a07396fed0ef27c5db13a1b700eac02754fc7",
      "ed72914608d2a07ee2eb587c1a654480d08201db"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "841a07396fed0ef27c5db13a1b700eac02754fc7",
      "commit_date": "2023-09-21T13:06:17Z",
      "author": {
        "login": "ywarnier",
        "type": "User",
        "stats": {
          "total_commits": 9140,
          "average_weekly_commits": 9.580712788259959,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 606
        }
      },
      "commit_message": {
        "title": "Security: Avoid wrapping commands in double quotes as escapeshellarg() does not escape them from args",
        "length": 101,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 9,
        "deletions": 12
      },
      "files": [
        {
          "filename": "main/lp/openoffice_presentation.class.php",
          "status": "modified",
          "additions": 3,
          "deletions": 4,
          "patch": "@@ -253,11 +253,10 @@ public function add_command_parameters()\n             $this->slide_height = (int) $h;\n         }\n \n-        return ' -w '.$this->slide_width.' -h '.$this->slide_height.' -d oogie \"'\n+        return ' -w '.$this->slide_width.' -h '.$this->slide_height.' -d oogie '\n             .Security::sanitizeExecParam($this->base_work_dir.'/'.$this->file_path)\n-            .'\"  \"'\n-            .Security::sanitizeExecParam($this->base_work_dir.$this->created_dir.'.html')\n-            .'\"';\n+            .'  '\n+            .Security::sanitizeExecParam($this->base_work_dir.$this->created_dir.'.html');\n     }\n \n     public function set_slide_size($width, $height)"
        },
        {
          "filename": "main/lp/openoffice_text.class.php",
          "status": "modified",
          "additions": 3,
          "deletions": 4,
          "patch": "@@ -331,11 +331,10 @@ public function dealPerPage($header, $body)\n      */\n     public function add_command_parameters()\n     {\n-        return ' -d woogie \"'\n+        return ' -d woogie '\n             .Security::sanitizeExecParam($this->base_work_dir.'/'.$this->file_path)\n-            .'\"  \"'\n-            .Security::sanitizeExecParam($this->base_work_dir.$this->created_dir.'/'.$this->file_name.'.html')\n-            .'\"';\n+            .'  '\n+            .Security::sanitizeExecParam($this->base_work_dir.$this->created_dir.'/'.$this->file_name.'.html');\n     }\n \n     /**"
        },
        {
          "filename": "main/lp/openoffice_text_document.class.php",
          "status": "modified",
          "additions": 3,
          "deletions": 4,
          "patch": "@@ -333,11 +333,10 @@ public function dealPerPage($header, $body)\n      */\n     public function add_command_parameters()\n     {\n-        return ' -d woogie \"'\n+        return ' -d woogie '\n             .Security::sanitizeExecParam($this->base_work_dir.'/'.$this->file_path)\n-            .'\"  \"'\n-            .Security::sanitizeExecParam($this->base_work_dir.$this->created_dir.'/'.$this->file_name.'.html')\n-            .'\"';\n+            .'  '\n+            .Security::sanitizeExecParam($this->base_work_dir.$this->created_dir.'/'.$this->file_name.'.html');\n     }\n \n     /**"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3cd611664be3b4163c2034a466dac6a1cdefca57",
            "date": "2025-01-23T21:53:20Z",
            "author_login": "AngelFQC"
          },
          {
            "sha": "706a656eb542ba1ceb5aabb72054b97ea86716be",
            "date": "2025-01-23T21:52:49Z",
            "author_login": "AngelFQC"
          },
          {
            "sha": "1c5d209d7cc523866aa8e8471d509c6f2194d846",
            "date": "2025-01-23T19:44:35Z",
            "author_login": "ywarnier"
          },
          {
            "sha": "24ebed69f35318c34c91b3c3ade7dfe801038636",
            "date": "2025-01-23T14:28:58Z",
            "author_login": "ywarnier"
          },
          {
            "sha": "5d84393c3842709da4cfb289bd4a8934b5c15740",
            "date": "2025-01-23T14:08:56Z",
            "author_login": "AngelFQC"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "Command injection in `main/lp/openoffice_presentation.class.php` in Chamilo LMS <= v1.11.24 allows users permitted to upload Learning Paths to obtain remote code execution via improper neutralisation of special characters.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-28T08:15:07.910",
    "last_modified": "2024-11-21T08:34:39.177",
    "fix_date": "2023-09-21T13:06:17Z"
  },
  "references": [
    {
      "url": "https://github.com/chamilo/chamilo-lms/commit/841a07396fed0ef27c5db13a1b700eac02754fc7",
      "source": "info@starlabs.sg",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/chamilo/chamilo-lms/commit/ed72914608d2a07ee2eb587c1a654480d08201db",
      "source": "info@starlabs.sg",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://starlabs.sg/advisories/23/23-4221",
      "source": "info@starlabs.sg",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.chamilo.org/projects/chamilo-18/wiki/security_issues#Issue-128-2023-09-04-Critical-impact-Moderate-risk-Authenticated-users-may-gain-unauthenticated-RCE-CVE-2023-4221CVE-2023-4222",
      "source": "info@starlabs.sg",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/chamilo/chamilo-lms/commit/841a07396fed0ef27c5db13a1b700eac02754fc7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/chamilo/chamilo-lms/commit/ed72914608d2a07ee2eb587c1a654480d08201db",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://starlabs.sg/advisories/23/23-4221",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://support.chamilo.org/projects/chamilo-18/wiki/security_issues#Issue-128-2023-09-04-Critical-impact-Moderate-risk-Authenticated-users-may-gain-unauthenticated-RCE-CVE-2023-4221CVE-2023-4222",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.291388",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "chamilo-lms",
    "owner": "chamilo",
    "created_at": "2013-03-29T17:31:19Z",
    "updated_at": "2025-01-25T21:55:15Z",
    "pushed_at": "2025-01-24T19:10:51Z",
    "size": 1041455,
    "stars": 823,
    "forks": 490,
    "open_issues": 611,
    "watchers": 823,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 23593361,
      "JavaScript": 5402567,
      "Twig": 920567,
      "Vue": 772303,
      "Java": 354427,
      "CSS": 323413,
      "Smarty": 242707,
      "SCSS": 160405,
      "Gherkin": 121146,
      "HTML": 28008,
      "Shell": 1913,
      "TypeScript": 156
    },
    "commit_activity": {
      "total_commits_last_year": 2301,
      "avg_commits_per_week": 44.25,
      "days_active_last_year": 290
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T07:34:03.529740"
  }
}