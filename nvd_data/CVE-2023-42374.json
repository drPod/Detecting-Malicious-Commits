{
  "cve_id": "CVE-2023-42374",
  "github_data": {
    "repository": "MystenLabs/sui",
    "fix_commit": "42d4ad103a21d23fecd7c0271453da41604e71e9",
    "related_commits": [
      "42d4ad103a21d23fecd7c0271453da41604e71e9",
      "42d4ad103a21d23fecd7c0271453da41604e71e9"
    ],
    "patch_url": "https://github.com/MystenLabs/sui/commit/42d4ad103a21d23fecd7c0271453da41604e71e9.patch",
    "fix_commit_details": {
      "sha": "42d4ad103a21d23fecd7c0271453da41604e71e9",
      "commit_date": "2023-07-31T18:08:45Z",
      "author": {
        "login": "aschran",
        "type": "User",
        "stats": {
          "total_commits": 363,
          "average_weekly_commits": 1.4462151394422311,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 95
        }
      },
      "commit_message": {
        "title": "Reduce anemo message limit to 1G (#13231)",
        "length": 41,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 7,
        "deletions": 7
      },
      "files": [
        {
          "filename": "crates/mysten-network/src/codec.rs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -166,7 +166,7 @@ pub mod anemo {\n \n         fn decode(&mut self, buf: bytes::Bytes) -> Result<Self::Item, Self::Error> {\n             let compressed_size = buf.len();\n-            let mut snappy_decoder = snap::read::FrameDecoder::new(buf.reader());\n+            let mut snappy_decoder = snap::read::FrameDecoder::new(buf.reader()).take(1 << 30);\n             let mut bytes = Vec::with_capacity(compressed_size);\n             snappy_decoder.read_to_end(&mut bytes)?;\n             bcs::from_bytes(bytes.as_slice())"
        },
        {
          "filename": "crates/sui-node/src/lib.rs",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -797,9 +797,9 @@ impl SuiNode {\n                 .into_inner();\n \n             let mut anemo_config = config.p2p_config.anemo_config.clone().unwrap_or_default();\n-            // Set the max_frame_size to be 2 GB to work around the issue of there being too many\n+            // Set the max_frame_size to be 1 GB to work around the issue of there being too many\n             // staking events in the epoch change txn.\n-            anemo_config.max_frame_size = Some(2 << 30);\n+            anemo_config.max_frame_size = Some(1 << 30);\n \n             // Set a higher default value for socket send/receive buffers if not already\n             // configured."
        },
        {
          "filename": "narwhal/primary/src/primary.rs",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -318,9 +318,9 @@ impl Primary {\n             quic_config.keep_alive_interval_ms = Some(5_000);\n             let mut config = anemo::Config::default();\n             config.quic = Some(quic_config);\n-            // Set the max_frame_size to be 2 GB to work around the issue of there being too many\n+            // Set the max_frame_size to be 1 GB to work around the issue of there being too many\n             // delegation events in the epoch change txn.\n-            config.max_frame_size = Some(2 << 30);\n+            config.max_frame_size = Some(1 << 30);\n             // Set a default timeout of 300s for all RPC requests\n             config.inbound_request_timeout_ms = Some(300_000);\n             config.outbound_request_timeout_ms = Some(300_000);"
        },
        {
          "filename": "narwhal/worker/src/worker.rs",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -242,9 +242,9 @@ impl Worker {\n             quic_config.keep_alive_interval_ms = Some(5_000);\n             let mut config = anemo::Config::default();\n             config.quic = Some(quic_config);\n-            // Set the max_frame_size to be 2 GB to work around the issue of there being too many\n+            // Set the max_frame_size to be 1 GB to work around the issue of there being too many\n             // delegation events in the epoch change txn.\n-            config.max_frame_size = Some(2 << 30);\n+            config.max_frame_size = Some(1 << 30);\n             // Set a default timeout of 300s for all RPC requests\n             config.inbound_request_timeout_ms = Some(300_000);\n             config.outbound_request_timeout_ms = Some(300_000);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2c0cea6aecae6ba3210287ab77b7d8d05fc2f817",
            "date": "2025-01-14T17:01:11Z",
            "author_login": "andll"
          },
          {
            "sha": "abde857436dac8e02529e9a05a76d0c4fae92295",
            "date": "2025-01-14T03:00:21Z",
            "author_login": "techdebt-99"
          },
          {
            "sha": "5c2826c6eaca11390254d22c2de4e001f49eb01f",
            "date": "2025-01-13T20:47:54Z",
            "author_login": "bmwill"
          },
          {
            "sha": "d80449bf0f51ee5e0959b7bb192123d1daecc46b",
            "date": "2025-01-13T16:41:56Z",
            "author_login": "lxfind"
          },
          {
            "sha": "4e985491cf128a8ddb37a98c3953a1d66745c842",
            "date": "2025-01-13T15:40:54Z",
            "author_login": "arun-koshy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-94",
    "description": "An issue in mystenlabs Sui Blockchain before v.1.6.3 allow a remote attacker to execute arbitrary code and cause a denial of service via a crafted compressed script to the Sui node component.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-13T01:15:07.913",
    "last_modified": "2024-11-21T08:22:29.200",
    "fix_date": "2023-07-31T18:08:45Z"
  },
  "references": [
    {
      "url": "https://beosin.com/resources/%22memory-bomb%22-vulnerability-causes-sui-node-to-crash?lang=en-US",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MystenLabs/sui/commit/42d4ad103a21d23fecd7c0271453da41604e71e9",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://medium.com/%40Beosin_com/memory-bomb-vulnerability-causes-sui-node-to-crash-7e8e3ef5057c",
      "source": "cve@mitre.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://beosin.com/resources/%22memory-bomb%22-vulnerability-causes-sui-node-to-crash?lang=en-US",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/MystenLabs/sui/commit/42d4ad103a21d23fecd7c0271453da41604e71e9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://medium.com/%40Beosin_com/memory-bomb-vulnerability-causes-sui-node-to-crash-7e8e3ef5057c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.115559",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sui",
    "owner": "MystenLabs",
    "created_at": "2021-11-09T03:17:36Z",
    "updated_at": "2025-01-14T17:01:23Z",
    "pushed_at": "2025-01-14T17:18:10Z",
    "size": 353939,
    "stars": 6429,
    "forks": 11274,
    "open_issues": 739,
    "watchers": 6429,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Rust": 30715682,
      "Move": 6870068,
      "TypeScript": 1855706,
      "Solidity": 240075,
      "Shell": 95667,
      "Python": 90643,
      "JavaScript": 61831,
      "SCSS": 28635,
      "Dockerfile": 24621,
      "PLpgSQL": 6597,
      "Boogie": 4258,
      "Smarty": 3564,
      "CSS": 2472,
      "HTML": 1548
    },
    "commit_activity": {
      "total_commits_last_year": 5978,
      "avg_commits_per_week": 114.96153846153847,
      "days_active_last_year": 343
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T17:20:53.487220"
  }
}