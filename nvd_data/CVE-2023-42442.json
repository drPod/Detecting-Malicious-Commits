{
  "cve_id": "CVE-2023-42442",
  "github_data": {
    "repository": "jumpserver/jumpserver",
    "fix_commit": "0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a",
    "related_commits": [
      "0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a",
      "0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a"
    ],
    "patch_url": "https://github.com/jumpserver/jumpserver/commit/0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a.patch",
    "fix_commit_details": {
      "sha": "0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a",
      "commit_date": "2023-09-11T03:13:34Z",
      "author": {
        "login": "ibuler",
        "type": "User",
        "stats": {
          "total_commits": 5124,
          "average_weekly_commits": 9.2994555353902,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 447
        }
      },
      "commit_message": {
        "title": "fix: \u4fee\u590d private storage permission",
        "length": 34,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 10,
        "deletions": 7
      },
      "files": [
        {
          "filename": "apps/common/permissions.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n from orgs.utils import tmp_to_root_org\n \n \n-class IsValidUser(permissions.IsAuthenticated, permissions.BasePermission):\n+class IsValidUser(permissions.IsAuthenticated):\n     \"\"\"Allows access to valid user, is active and not expired\"\"\"\n \n     def has_permission(self, request, view):"
        },
        {
          "filename": "apps/jumpserver/rewriting/storage/permissions.py",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -16,6 +16,8 @@ def allow_access(private_file):\n     path_base = path_list[1] if len(path_list) > 1 else None\n     path_perm = path_perms_map.get(path_base, None)\n \n+    if \"..\" in request_path:\n+        return False\n     if not path_perm:\n         return False\n     if path_perm == '*' or request.user.has_perms([path_perm]):"
        },
        {
          "filename": "apps/terminal/permissions.py",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -1,13 +1,15 @@\n from rest_framework import permissions\n+\n from common.utils import get_logger\n \n logger = get_logger(__file__)\n \n-\n __all__ = ['IsSessionAssignee']\n \n \n-class IsSessionAssignee(permissions.BasePermission):\n+class IsSessionAssignee(permissions.IsAuthenticated):\n+    def has_permission(self, request, view):\n+        return False\n \n     def has_object_permission(self, request, view, obj):\n         try:"
        },
        {
          "filename": "apps/tickets/permissions/ticket.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,12 +1,12 @@\n from rest_framework import permissions\n \n \n-class IsAssignee(permissions.BasePermission):\n+class IsAssignee(permissions.IsAuthenticated):\n     def has_object_permission(self, request, view, obj):\n         return obj.has_current_assignee(request.user)\n \n \n-class IsApplicant(permissions.BasePermission):\n+class IsApplicant(permissions.IsAuthenticated):\n \n     def has_object_permission(self, request, view, obj):\n         return obj.applicant == request.user"
        },
        {
          "filename": "apps/users/permissions.py",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -1,6 +1,5 @@\n from rest_framework import permissions\n \n-from rbac.builtin import BuiltinRole\n from .utils import is_auth_password_time_valid\n \n \n@@ -11,7 +10,7 @@ def has_permission(self, request, view):\n             and is_auth_password_time_valid(request.session)\n \n \n-class UserObjectPermission(permissions.BasePermission):\n+class UserObjectPermission(permissions.IsAuthenticated):\n \n     def has_object_permission(self, request, view, obj):\n         if view.action not in ['update', 'partial_update', 'destroy']:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "543dde57ab80968403a51c0c365a67649f1f86eb",
            "date": "2024-11-19T06:21:49Z",
            "author_login": "w940853815"
          },
          {
            "sha": "c088437fe587ff7a95bd75311d5f131a107a8b5c",
            "date": "2025-01-14T10:11:48Z",
            "author_login": "w940853815"
          },
          {
            "sha": "e721ec147c34c923b9854c6b223be3db974d9015",
            "date": "2025-01-14T09:27:23Z",
            "author_login": "feng626"
          },
          {
            "sha": "5d18d6dee082c8d89b4dac90a8409c129f3ef3bf",
            "date": "2025-01-14T08:38:17Z",
            "author_login": "w940853815"
          },
          {
            "sha": "ecfd338428994024487cb79316d353d5099c908b",
            "date": "2025-01-14T06:58:46Z",
            "author_login": "feng626"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H",
    "cwe_id": "CWE-287",
    "description": "JumpServer is an open source bastion host and a professional operation and maintenance security audit system. Starting in version 3.0.0 and prior to versions 3.5.5 and 3.6.4, session replays can download without authentication. Session replays stored in S3, OSS, or other cloud storage are not affected. The api `/api/v1/terminal/sessions/` permission control is broken and can be accessed anonymously. SessionViewSet permission classes set to `[RBACPermission | IsSessionAssignee]`, relation is or, so any permission matched will be allowed. Versions 3.5.5 and 3.6.4 have a fix. After upgrading, visit the api `$HOST/api/v1/terminal/sessions/?limit=1`. The expected http response code is 401 (`not_authenticated`).\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-15T21:15:11.867",
    "last_modified": "2024-11-21T08:22:32.233",
    "fix_date": "2023-09-11T03:13:34Z"
  },
  "references": [
    {
      "url": "https://github.com/jumpserver/jumpserver/blob/v3.6.1/apps/terminal/api/session/session.py#L91",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/commit/0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-633x-3f4f-v9rw",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/blob/v3.6.1/apps/terminal/api/session/session.py#L91",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/commit/0a58bba59cd275bab8e0ae58bf4b359fbc5eb74a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-633x-3f4f-v9rw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:08.417583",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jumpserver",
    "owner": "jumpserver",
    "created_at": "2014-07-04T03:54:59Z",
    "updated_at": "2025-01-14T13:42:12Z",
    "pushed_at": "2025-01-14T10:28:34Z",
    "size": 90188,
    "stars": 25919,
    "forks": 5385,
    "open_issues": 58,
    "watchers": 25919,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev",
      "dev-fce",
      "master",
      "v1.5",
      "v2.0",
      "v2.1",
      "v2.2",
      "v2.3",
      "v2.4",
      "v2.5",
      "v2.6",
      "v2.7",
      "v2.8",
      "v2.9",
      "v2.10",
      "v2.11",
      "v2.12",
      "v2.13",
      "v2.14",
      "v2.15",
      "v2.16",
      "v2.17",
      "v2.18",
      "v2.19"
    ],
    "languages": {
      "Python": 3934412,
      "CSS": 405078,
      "Less": 20864,
      "Shell": 8544,
      "Dockerfile": 2123
    },
    "commit_activity": {
      "total_commits_last_year": 1389,
      "avg_commits_per_week": 26.71153846153846,
      "days_active_last_year": 229
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:10:35.165836"
  }
}