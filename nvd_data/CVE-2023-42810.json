{
  "cve_id": "CVE-2023-42810",
  "github_data": {
    "repository": "sebhildebrandt/systeminformation",
    "fix_commit": "7972565812ccb2a610a22911c54c3446f4171392",
    "related_commits": [
      "7972565812ccb2a610a22911c54c3446f4171392",
      "7972565812ccb2a610a22911c54c3446f4171392"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "7972565812ccb2a610a22911c54c3446f4171392",
      "commit_date": "2023-09-19T15:39:39Z",
      "author": {
        "login": "sebhildebrandt",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "wifi sanitizing ssid names",
        "length": 26,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 39,
        "additions": 35,
        "deletions": 4
      },
      "files": [
        {
          "filename": "docs/history.html",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -57,6 +57,11 @@ <h3>Full version history</h3>\n                     </tr>\n                   </thead>\n                   <tbody>\n+                    <tr>\n+                      <th scope=\"row\">5.21.7</th>\n+                      <td>2023-09-19</td>\n+                      <td><span class=\"code\">wifiConnections()</span> <span class=\"code\">wifiNetworks()</span>fixed security issue (linux)</td>\n+                    </tr>\n                     <tr>\n                       <th scope=\"row\">5.21.6</th>\n                       <td>2023-09-18</td>"
        },
        {
          "filename": "docs/index.html",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -166,11 +166,11 @@\n <body>\n   <header class=\"bg-image-full\">\n     <div class=\"top-container\">\n-      <a href=\"security.html\" class=\"recommendation\">Security advisory:<br>Update to v5.6.13</a>\n+      <a href=\"security.html\" class=\"recommendation\">Security advisory:<br>Update to v5.21.7</a>\n       <img class=\"logo\" src=\"assets/logo.png\" alt=\"logo\">\n       <div class=\"title\">systeminformation</div>\n       <div class=\"subtitle\"><span id=\"typed\"></span>&nbsp;</div>\n-      <div class=\"version\">New Version: <span id=\"version\">5.21.6</span></div>\n+      <div class=\"version\">New Version: <span id=\"version\">5.21.7</span></div>\n       <button class=\"btn btn-light\" onclick=\"location.href='https://github.com/sebhildebrandt/systeminformation'\">View on Github <i class=\" fab fa-github\"></i></button>\n     </div>\n     <div class=\"down\">"
        },
        {
          "filename": "docs/security.html",
          "status": "modified",
          "additions": 19,
          "deletions": 1,
          "patch": "@@ -49,6 +49,24 @@ <h2>Passing User Paramters to Systeminformation</h2>\n                 <p class=\"warning\">This can lead to serious impact on your servers!</p>\n                 <p>We highly recommend to always upgrade to the latest version of our package. We maintain security updates for version 5 AND also version 4. For version 4 you can install latest version by placing <span class=\"code\">\"systeminformation\": \"^4\"</span> in your package.json (dependencies) and run <span class=\"code\">npm install</span></p>\n \n+                <h2>SSID Command Injection Vulnerability</h2>\n+                <p><span class=\"bold\">Affected versions:</span>\n+                  &lt; 5.21.07 and &lt; 4.34.22<br>\n+                  <span class=\"bold\">Date:</span> 2023-09-19<br>\n+                  <span class=\"bold\">CVE indentifier</span> -\n+                </p>\n+\n+                <h4>Impact</h4>\n+                <p>We had an issue that there was a possibility to perform a potential command injection possibility by crafting detected SSIDs in <span class=\"code\">wifiConnections()</span>, <span class=\"code\">wifiNetworks()</span>.</p>\n+\n+                <h4>Patch</h4>\n+                <p>Problem was fixed with parameter checking. Please upgrade to version >= 5.7.21 (or >= 4.34.22 if you are using version 4).</p>\n+\n+                <h4>Workaround</h4>\n+                <p>If you cannot upgrade, be sure to check or sanitize parameter strings that are passed to <span class=\"code\">wifiConnections()</span>, <span class=\"code\">wifiNetworks()</span> (string only)</p>\n+                <hr>\n+                <br>\n+\n                 <h2>Command Injection Vulnerability</h2>\n                 <p><span class=\"bold\">Affected versions:</span>\n                   &lt; 5.6.13 and &lt; 4.34.21<br>\n@@ -255,4 +273,4 @@ <h4>Workaround</h4>\n   </script>\n </body>\n \n-</html>\n\\ No newline at end of file\n+</html>"
        },
        {
          "filename": "lib/wifi.js",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -549,7 +549,15 @@ function wifiConnections(callback) {\n           const wpaDetails = wpaConnectionLinux(ifaceSanitized);\n           const ssid = nmiDetails.ssid || wpaDetails.ssid;\n           const network = networkList.filter(nw => nw.ssid === ssid);\n-          const nmiConnection = nmiConnectionLinux(ssid);\n+          let ssidSanitized = '';\n+          const t = util.isPrototypePolluted() ? '---' : util.sanitizeShellString(ssid, true);\n+          for (let i = 0; i <= util.mathMin(t.length, 2000); i++) {\n+            if (t[i] !== undefined) {\n+              ssidSanitized = ssidSanitized + t[i];\n+            }\n+          }\n+\n+          const nmiConnection = nmiConnectionLinux(ssidSanitized);\n           const channel = network && network.length && network[0].channel ? network[0].channel : (wpaDetails.channel ? wpaDetails.channel : null);\n           const bssid = network && network.length && network[0].bssid ? network[0].bssid : (wpaDetails.bssid ? wpaDetails.bssid : null);\n           if (ssid && bssid) {"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "67052ae38ae6598cc899ad07b7a96e85865c6d9c",
            "date": "2025-01-15T06:43:34Z",
            "author_login": "sebhildebrandt"
          },
          {
            "sha": "cdb346f38504c8495269e5816136338011ceeadb",
            "date": "2025-01-13T10:45:11Z",
            "author_login": "sebhildebrandt"
          },
          {
            "sha": "c76402ed1beb862a1fa0f651c21c6b6913a4fc56",
            "date": "2025-01-12T17:33:25Z",
            "author_login": "sebhildebrandt"
          },
          {
            "sha": "d1dbdcae971652b0bd7ab41bc80abb584c855467",
            "date": "2025-01-12T17:27:19Z",
            "author_login": "sebhildebrandt"
          },
          {
            "sha": "22f6046197ebf309a6278b041e302dc2d97c96b5",
            "date": "2025-01-12T13:13:54Z",
            "author_login": "sebhildebrandt"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-77",
    "description": "systeminformation is a System Information Library for Node.JS. Versions 5.0.0 through 5.21.6 have a SSID Command Injection Vulnerability. The problem was fixed with a parameter check in version 5.21.7. As a workaround, check or sanitize parameter strings that are passed to `wifiConnections()`, `wifiNetworks()` (string only).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-21T18:15:12.327",
    "last_modified": "2024-11-21T08:23:15.543",
    "fix_date": "2023-09-19T15:39:39Z"
  },
  "references": [
    {
      "url": "https://github.com/sebhildebrandt/systeminformation/commit/7972565812ccb2a610a22911c54c3446f4171392",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-gx6r-qc2v-3p3v",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://systeminformation.io/security.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/sebhildebrandt/systeminformation/commit/7972565812ccb2a610a22911c54c3446f4171392",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/sebhildebrandt/systeminformation/security/advisories/GHSA-gx6r-qc2v-3p3v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://systeminformation.io/security.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:08.437774",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "systeminformation",
    "owner": "sebhildebrandt",
    "created_at": "2014-03-12T18:16:59Z",
    "updated_at": "2025-01-23T19:00:18Z",
    "pushed_at": "2025-01-15T06:43:40Z",
    "size": 5916,
    "stars": 2801,
    "forks": 319,
    "open_issues": 116,
    "watchers": 2801,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 670633
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:41:59.017416"
  }
}