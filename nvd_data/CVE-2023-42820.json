{
  "cve_id": "CVE-2023-42820",
  "github_data": {
    "repository": "jumpserver/jumpserver",
    "fix_commit": "42337f0d00b2a8d45ef063eb5b7deeef81597da5",
    "related_commits": [
      "42337f0d00b2a8d45ef063eb5b7deeef81597da5",
      "42337f0d00b2a8d45ef063eb5b7deeef81597da5"
    ],
    "patch_url": "https://github.com/jumpserver/jumpserver/commit/42337f0d00b2a8d45ef063eb5b7deeef81597da5.patch",
    "fix_commit_details": {
      "sha": "42337f0d00b2a8d45ef063eb5b7deeef81597da5",
      "commit_date": "2023-09-19T10:17:38Z",
      "author": {
        "login": "ibuler",
        "type": "User",
        "stats": {
          "total_commits": 5124,
          "average_weekly_commits": 9.2994555353902,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 447
        }
      },
      "commit_message": {
        "title": "perf: \u4fee\u590d\u968f\u673a error",
        "length": 16,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 11,
        "deletions": 15
      },
      "files": [
        {
          "filename": "apps/common/utils/random.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,10 +1,9 @@\n # -*- coding: utf-8 -*-\n #\n-import struct\n import random\n import socket\n import string\n-\n+import struct\n \n string_punctuation = '!#$%&()*+,-.:;<=>?@[]^_~'\n \n@@ -19,6 +18,7 @@ def random_ip():\n \n \n def random_string(length: int, lower=True, upper=True, digit=True, special_char=False):\n+    random.seed()\n     args_names = ['lower', 'upper', 'digit', 'special_char']\n     args_values = [lower, upper, digit, special_char]\n     args_string = [string.ascii_lowercase, string.ascii_uppercase, string.digits, string_punctuation]"
        },
        {
          "filename": "apps/users/models/user.py",
          "status": "modified",
          "additions": 9,
          "deletions": 13,
          "patch": "@@ -1,30 +1,27 @@\n #!/usr/bin/env python\n # -*- coding: utf-8 -*-\n #\n-import uuid\n import base64\n-import string\n-import random\n import datetime\n+import uuid\n from typing import Callable\n \n-from django.db import models\n from django.conf import settings\n-from django.utils import timezone\n-from django.core.cache import cache\n-from django.contrib.auth.models import AbstractUser\n from django.contrib.auth.hashers import check_password\n-from django.utils.translation import ugettext_lazy as _\n+from django.contrib.auth.models import AbstractUser\n+from django.core.cache import cache\n+from django.db import models\n from django.shortcuts import reverse\n+from django.utils import timezone\n from django.utils.module_loading import import_string\n+from django.utils.translation import ugettext_lazy as _\n \n-from orgs.utils import current_org\n-from orgs.models import Organization\n-from rbac.const import Scope\n from common.db import fields, models as jms_models\n from common.utils import (\n     date_expired_default, get_logger, lazyproperty, random_string, bulk_create_with_signal\n )\n+from orgs.utils import current_org\n+from rbac.const import Scope\n from ..signals import post_user_change_password, post_user_leave_org, pre_user_leave_org\n \n __all__ = ['User', 'UserPasswordHistory']\n@@ -518,8 +515,7 @@ def access_key(self):\n         return self.access_keys.first()\n \n     def generate_reset_token(self):\n-        letter = string.ascii_letters + string.digits\n-        token = ''.join([random.choice(letter) for _ in range(50)])\n+        token = random_string(50)\n         self.set_cache(token)\n         return token\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "543dde57ab80968403a51c0c365a67649f1f86eb",
            "date": "2024-11-19T06:21:49Z",
            "author_login": "w940853815"
          },
          {
            "sha": "c088437fe587ff7a95bd75311d5f131a107a8b5c",
            "date": "2025-01-14T10:11:48Z",
            "author_login": "w940853815"
          },
          {
            "sha": "e721ec147c34c923b9854c6b223be3db974d9015",
            "date": "2025-01-14T09:27:23Z",
            "author_login": "feng626"
          },
          {
            "sha": "5d18d6dee082c8d89b4dac90a8409c129f3ef3bf",
            "date": "2025-01-14T08:38:17Z",
            "author_login": "w940853815"
          },
          {
            "sha": "ecfd338428994024487cb79316d353d5099c908b",
            "date": "2025-01-14T06:58:46Z",
            "author_login": "feng626"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:L",
    "cwe_id": "CWE-200",
    "description": "JumpServer is an open source bastion host. This vulnerability is due to exposing the random number seed to the API, potentially allowing the randomly generated verification codes to be replayed, which could lead to password resets. If MFA is enabled users are not affect. Users not using local authentication are also not affected. Users are advised to upgrade to either version 2.28.19 or to 3.6.5. There are no known workarounds or this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-09-27T15:19:33.227",
    "last_modified": "2024-11-21T08:23:17.097",
    "fix_date": "2023-09-19T10:17:38Z"
  },
  "references": [
    {
      "url": "https://github.com/jumpserver/jumpserver/commit/42337f0d00b2a8d45ef063eb5b7deeef81597da5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-7prv-g565-82qp",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/commit/42337f0d00b2a8d45ef063eb5b7deeef81597da5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-7prv-g565-82qp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.490882",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jumpserver",
    "owner": "jumpserver",
    "created_at": "2014-07-04T03:54:59Z",
    "updated_at": "2025-01-14T13:42:12Z",
    "pushed_at": "2025-01-14T10:28:34Z",
    "size": 90188,
    "stars": 25919,
    "forks": 5385,
    "open_issues": 58,
    "watchers": 25919,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev",
      "dev-fce",
      "master",
      "v1.5",
      "v2.0",
      "v2.1",
      "v2.2",
      "v2.3",
      "v2.4",
      "v2.5",
      "v2.6",
      "v2.7",
      "v2.8",
      "v2.9",
      "v2.10",
      "v2.11",
      "v2.12",
      "v2.13",
      "v2.14",
      "v2.15",
      "v2.16",
      "v2.17",
      "v2.18",
      "v2.19"
    ],
    "languages": {
      "Python": 3934412,
      "CSS": 405078,
      "Less": 20864,
      "Shell": 8544,
      "Dockerfile": 2123
    },
    "commit_activity": {
      "total_commits_last_year": 1389,
      "avg_commits_per_week": 26.71153846153846,
      "days_active_last_year": 229
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:10:35.165836"
  }
}