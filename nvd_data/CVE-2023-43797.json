{
  "cve_id": "CVE-2023-43797",
  "github_data": {
    "repository": "bigbluebutton/bigbluebutton",
    "fix_commit": "304bc851a00558f99a908880f4ac44234a074c9d",
    "related_commits": [
      "304bc851a00558f99a908880f4ac44234a074c9d",
      "304bc851a00558f99a908880f4ac44234a074c9d"
    ],
    "patch_url": "https://github.com/bigbluebutton/bigbluebutton/commit/304bc851a00558f99a908880f4ac44234a074c9d.patch",
    "fix_commit_details": {
      "sha": "304bc851a00558f99a908880f4ac44234a074c9d",
      "commit_date": "2023-07-26T19:28:20Z",
      "author": {
        "login": "antobinary",
        "type": "User",
        "stats": {
          "total_commits": 7825,
          "average_weekly_commits": 9.03579676674365,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 510
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-v6wg-q866-h73x",
        "length": 96,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 64,
        "additions": 33,
        "deletions": 31
      },
      "files": [
        {
          "filename": "bigbluebutton-html5/imports/api/common/server/helpers.js",
          "status": "modified",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -1,9 +1,34 @@\n import Users from '/imports/api/users';\n import Logger from '/imports/startup/server/logger';\n+import RegexWebUrl from '/imports/utils/regex-weburl';\n \n const MSG_DIRECT_TYPE = 'DIRECT';\n const NODE_USER = 'nodeJSapp';\n \n+const HTML_SAFE_MAP = {\n+  '<': '&lt;',\n+  '>': '&gt;',\n+  '\"': '&quot;',\n+  \"'\": '&#39;',\n+};\n+\n+export const parseMessage = (message) => {\n+  let parsedMessage = message || '';\n+  parsedMessage = parsedMessage.trim();\n+\n+  // Replace <br/> with \\n\\r\n+  parsedMessage = parsedMessage.replace(/<br\\s*[\\\\/]?>/gi, '\\n\\r');\n+\n+  // Sanitize. See: http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\n+  parsedMessage = parsedMessage.replace(/[<>'\"]/g, (c) => HTML_SAFE_MAP[c]);\n+\n+  // Replace flash links to flash valid ones\n+  parsedMessage = parsedMessage.replace(RegexWebUrl, \"<a href='event:$&'><u>$&</u></a>\");\n+\n+  return parsedMessage;\n+};\n+\n+\n export const spokeTimeoutHandles = {};\n export const clearSpokeTimeout = (meetingId, userId) => {\n   if (spokeTimeoutHandles[`${meetingId}-${userId}`]) {"
        },
        {
          "filename": "bigbluebutton-html5/imports/api/group-chat-msg/server/methods/sendGroupChatMsg.js",
          "status": "modified",
          "additions": 2,
          "deletions": 25,
          "patch": "@@ -1,32 +1,9 @@\n import { Meteor } from 'meteor/meteor';\n import { check } from 'meteor/check';\n import RedisPubSub from '/imports/startup/server/redis';\n-import RegexWebUrl from '/imports/utils/regex-weburl';\n-import { extractCredentials } from '/imports/api/common/server/helpers';\n-import Logger from '/imports/startup/server/logger';\n-\n-const HTML_SAFE_MAP = {\n-  '<': '&lt;',\n-  '>': '&gt;',\n-  '\"': '&quot;',\n-  \"'\": '&#39;',\n-};\n-\n-const parseMessage = (message) => {\n-  let parsedMessage = message || '';\n-  parsedMessage = parsedMessage.trim();\n-\n-  // Replace <br/> with \\n\\r\n-  parsedMessage = parsedMessage.replace(/<br\\s*[\\\\/]?>/gi, '\\n\\r');\n \n-  // Sanitize. See: http://shebang.brandonmintern.com/foolproof-html-escaping-in-javascript/\n-  parsedMessage = parsedMessage.replace(/[<>'\"]/g, (c) => HTML_SAFE_MAP[c]);\n-\n-  // Replace flash links to flash valid ones\n-  parsedMessage = parsedMessage.replace(RegexWebUrl, \"<a href='event:$&'><u>$&</u></a>\");\n-\n-  return parsedMessage;\n-};\n+import { extractCredentials, parseMessage } from '/imports/api/common/server/helpers';\n+import Logger from '/imports/startup/server/logger';\n \n export default function sendGroupChatMsg(chatId, message) {\n   const REDIS_CONFIG = Meteor.settings.private.redis;"
        },
        {
          "filename": "bigbluebutton-html5/imports/api/group-chat-msg/server/modifiers/addBulkGroupChatMsgs.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,7 +2,7 @@ import { GroupChatMsg } from '/imports/api/group-chat-msg';\n import GroupChat from '/imports/api/group-chat';\n import Logger from '/imports/startup/server/logger';\n import flat from 'flat';\n-import { parseMessage } from './addGroupChatMsg';\n+import { parseMessage } from '/imports/api/common/server/helpers';\n \n export default async function addBulkGroupChatMsgs(msgs) {\n   if (!msgs.length) return;"
        },
        {
          "filename": "bigbluebutton-html5/imports/api/guest-users/server/methods/setGuestLobbyMessage.js",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -2,7 +2,7 @@ import { Meteor } from 'meteor/meteor';\n import { check } from 'meteor/check';\n import RedisPubSub from '/imports/startup/server/redis';\n import Logger from '/imports/startup/server/logger';\n-import { extractCredentials } from '/imports/api/common/server/helpers';\n+import { extractCredentials, parseMessage } from '/imports/api/common/server/helpers';\n \n const REDIS_CONFIG = Meteor.settings.private.redis;\n const CHANNEL = REDIS_CONFIG.channels.toAkkaApps;\n@@ -16,8 +16,7 @@ export default function setGuestLobbyMessage(message) {\n \n     check(meetingId, String);\n     check(requesterUserId, String);\n-\n-    const payload = { message };\n+    const payload = { message: parseMessage(message) };\n \n     Logger.info(`User=${requesterUserId} set guest lobby message to ${message}`);\n "
        },
        {
          "filename": "bigbluebutton-html5/imports/api/guest-users/server/methods/setPrivateGuestLobbyMessage.js",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -2,7 +2,8 @@ import { Meteor } from 'meteor/meteor';\n import { check } from 'meteor/check';\n import RedisPubSub from '/imports/startup/server/redis';\n import Logger from '/imports/startup/server/logger';\n-import { extractCredentials } from '/imports/api/common/server/helpers';\n+import { extractCredentials, parseMessage } from '/imports/api/common/server/helpers';\n+\n \n const REDIS_CONFIG = Meteor.settings.private.redis;\n const CHANNEL = REDIS_CONFIG.channels.toAkkaApps;\n@@ -17,7 +18,7 @@ export default function setPrivateGuestLobbyMessage(message, guestId) {\n   check(meetingId, String);\n   check(requesterUserId, String);\n \n-  const payload = { guestId, message };\n+  const payload = { guestId, message: parseMessage(message) };\n \n   Logger.info(`User=${requesterUserId} sent a private guest lobby message to guest user=${guestId}`);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "519c6ba2105936b834c44bacbf4181b1261f7fb9",
            "date": "2025-01-14T12:12:28Z",
            "author_login": "ramonlsouza"
          },
          {
            "sha": "7c7a3522a64e164be9361d193c555b06db998247",
            "date": "2025-01-13T20:38:48Z",
            "author_login": "KDSBrowne"
          },
          {
            "sha": "bef768f2711e56b3b829b353ee3faa7e79ecffdd",
            "date": "2025-01-13T20:37:33Z",
            "author_login": "antonbsa"
          },
          {
            "sha": "2f630e315aa9a65e456f85af04b9fa2ca8f74b14",
            "date": "2025-01-13T20:27:03Z",
            "author_login": "antobinary"
          },
          {
            "sha": "31135393d44673652accdf7e536608b251987371",
            "date": "2025-01-13T20:26:22Z",
            "author_login": "GuiLeme"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "BigBlueButton is an open-source virtual classroom. Prior to versions 2.6.11 and 2.7.0-beta.3, Guest Lobby was vulnerable to cross-site scripting when users wait to enter the meeting due to inserting unsanitized messages to the element using unsafe innerHTML. Text sanitizing was added for lobby messages starting in versions 2.6.11 and 2.7.0-beta.3. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-30T23:15:08.317",
    "last_modified": "2024-11-21T08:24:48.270",
    "fix_date": "2023-07-26T19:28:20Z"
  },
  "references": [
    {
      "url": "https://github.com/bigbluebutton/bigbluebutton/commit/304bc851a00558f99a908880f4ac44234a074c9d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bigbluebutton/bigbluebutton/pull/18392",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bigbluebutton/bigbluebutton/security/advisories/GHSA-v6wg-q866-h73x",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bigbluebutton/bigbluebutton/commit/304bc851a00558f99a908880f4ac44234a074c9d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bigbluebutton/bigbluebutton/pull/18392",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/bigbluebutton/bigbluebutton/security/advisories/GHSA-v6wg-q866-h73x",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.966589",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bigbluebutton",
    "owner": "bigbluebutton",
    "created_at": "2010-05-25T01:42:41Z",
    "updated_at": "2025-01-14T12:12:39Z",
    "pushed_at": "2025-01-14T12:12:29Z",
    "size": 893040,
    "stars": 8626,
    "forks": 5969,
    "open_issues": 743,
    "watchers": 8626,
    "has_security_policy": false,
    "default_branch": "v3.0.x-release",
    "protected_branches": [],
    "languages": {
      "JavaScript": 4126026,
      "Scala": 1661584,
      "TypeScript": 1609907,
      "Java": 1170092,
      "Ruby": 394574,
      "Shell": 281919,
      "Groovy": 165624,
      "CSS": 162616,
      "Go": 113680,
      "PLpgSQL": 96927,
      "Python": 75857,
      "HTML": 26837,
      "Batchfile": 2375,
      "Gherkin": 925,
      "Dockerfile": 59,
      "PostScript": 36
    },
    "commit_activity": {
      "total_commits_last_year": 3379,
      "avg_commits_per_week": 64.98076923076923,
      "days_active_last_year": 265
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-3.0"
    },
    "collected_at": "2025-01-14T12:54:33.084574"
  }
}