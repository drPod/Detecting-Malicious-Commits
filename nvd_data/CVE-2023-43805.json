{
  "cve_id": "CVE-2023-43805",
  "github_data": {
    "repository": "nexryai/nexkey",
    "fix_commit": "d89575c521fd4492f5e2ba5a221c5e8f1382081d",
    "related_commits": [
      "d89575c521fd4492f5e2ba5a221c5e8f1382081d",
      "d89575c521fd4492f5e2ba5a221c5e8f1382081d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "d89575c521fd4492f5e2ba5a221c5e8f1382081d",
      "commit_date": "2023-09-08T09:04:42Z",
      "author": {
        "login": "atsu1125",
        "type": "User",
        "stats": {
          "total_commits": 214,
          "average_weekly_commits": 0.5059101654846335,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 25
        }
      },
      "commit_message": {
        "title": "BullBoard\u306e\u8a8d\u8a3c\u3092\u30d0\u30a4\u30d1\u30b9\u3057\u3066\u3057\u307e\u308f\u306a\u3044\u3088\u3046\u306b",
        "length": 27,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
      },
      "files": [
        {
          "filename": "packages/backend/src/server/web/index.ts",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -44,7 +44,9 @@ const bullBoardPath = '/queue';\n \n // Authenticate\n app.use(async (ctx, next) => {\n-\tif (ctx.path === bullBoardPath || ctx.path.startsWith(bullBoardPath + '/')) {\n+\t// %71ueue\u3068\u304b\u3067\u30ea\u30af\u30a8\u30b9\u30c8\u3055\u308c\u305f\u3089\u56f0\u308b\u305f\u3081\n+\tconst url = decodeURI(ctx.path);\n+\tif (url === bullBoardPath || url.startsWith(bullBoardPath + '/')) {\n \t\tconst token = ctx.cookies.get('token');\n \t\tif (token == null) {\n \t\t\tctx.status = 401;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "34bb22727b23cf03057838edc7b84d7eb7c7842e",
            "date": "2025-01-22T00:11:47Z",
            "author_login": "nexryai"
          },
          {
            "sha": "ce1f2ad246f9f338f6376a327ccd526cf9d77791",
            "date": "2025-01-22T00:07:55Z",
            "author_login": "nexryai"
          },
          {
            "sha": "e87c6178741b53cab53b5cf9860371741df70238",
            "date": "2025-01-21T23:55:06Z",
            "author_login": "nexryai"
          },
          {
            "sha": "070ce3a1954291639326b161971d1f03f3f667da",
            "date": "2025-01-21T23:43:27Z",
            "author_login": "nexryai"
          },
          {
            "sha": "866f10b99a92c8bb56ba621da5ad5770e54f6f26",
            "date": "2025-01-21T23:38:25Z",
            "author_login": "nexryai"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-287",
    "description": "Nexkey is a fork of Misskey, an open source, decentralized social media platform. Prior to version 12.121.9, incomplete URL validation can allow users to bypass authentication for access to the job queue dashboard. Version 12.121.9 contains a fix for this issue. As a workaround, it may be possible to avoid this by blocking access using tools such as Cloudflare's WAF.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-04T21:15:10.203",
    "last_modified": "2024-11-21T08:24:49.337",
    "fix_date": "2023-09-08T09:04:42Z"
  },
  "references": [
    {
      "url": "https://github.com/misskey-dev/misskey/security/advisories/GHSA-9fj2-gjcf-cqqc",
      "source": "security-advisories@github.com",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/nexryai/nexkey/commit/d89575c521fd4492f5e2ba5a221c5e8f1382081d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nexryai/nexkey/security/advisories/GHSA-g8w5-568f-ffwf",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/misskey-dev/misskey/security/advisories/GHSA-9fj2-gjcf-cqqc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/nexryai/nexkey/commit/d89575c521fd4492f5e2ba5a221c5e8f1382081d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nexryai/nexkey/security/advisories/GHSA-g8w5-568f-ffwf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.574895",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "concorde",
    "owner": "nexryai",
    "created_at": "2023-07-28T03:29:58Z",
    "updated_at": "2025-01-22T00:11:58Z",
    "pushed_at": "2025-01-24T03:15:57Z",
    "size": 107511,
    "stars": 22,
    "forks": 1,
    "open_issues": 21,
    "watchers": 22,
    "has_security_policy": false,
    "default_branch": "nightly",
    "protected_branches": [
      "nightly"
    ],
    "languages": {
      "TypeScript": 1828577,
      "Vue": 1158312,
      "JavaScript": 313065,
      "Pug": 12473,
      "SCSS": 8440,
      "CSS": 1940,
      "Dockerfile": 1628
    },
    "commit_activity": {
      "total_commits_last_year": 1367,
      "avg_commits_per_week": 26.28846153846154,
      "days_active_last_year": 217
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-26T07:42:23.090501"
  }
}