{
  "cve_id": "CVE-2023-44393",
  "github_data": {
    "repository": "Piwigo/Piwigo",
    "fix_commit": "cc99c0f1e967c5f1722a0cce30ff42374a7bbc23",
    "related_commits": [
      "cc99c0f1e967c5f1722a0cce30ff42374a7bbc23",
      "cc99c0f1e967c5f1722a0cce30ff42374a7bbc23"
    ],
    "patch_url": "https://github.com/Piwigo/Piwigo/commit/cc99c0f1e967c5f1722a0cce30ff42374a7bbc23.patch",
    "fix_commit_details": {
      "sha": "cc99c0f1e967c5f1722a0cce30ff42374a7bbc23",
      "commit_date": "2023-10-06T13:13:04Z",
      "author": {
        "login": "plegall",
        "type": "User",
        "stats": {
          "total_commits": 2218,
          "average_weekly_commits": 1.9576345984112975,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 558
        }
      },
      "commit_message": {
        "title": "fixes GHSA-qg85-957m-7vgg providing plugin_id in URL is useless since Piwigo 12",
        "length": 79,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
      },
      "files": [
        {
          "filename": "admin/plugins_new.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -47,11 +47,11 @@\n   switch ($_GET['installstatus'])\n   {\n     case 'ok':\n-      $activate_url = get_root_url().'admin.php?page=plugins'\n-        . '&amp;plugin=' . $_GET['plugin_id']\n-        . '&amp;pwg_token=' . get_pwg_token()\n-        . '&amp;action=activate'\n-        . '&amp;filter=deactivated';\n+      // since Piwigo 12, you need to be on the page of installed plugins to active a plugin with\n+      // a JS action, no need to provide plugin_id in URL, just link to the page of installed\n+      // plugins, filtered on deactivated plugins. The webmaster will have to find its newly\n+      // installed plugin and click on the activation switch.\n+      $activate_url = get_root_url().'admin.php?page=plugins&amp;filter=deactivated';\n \n       $page['infos'][] = l10n('Plugin has been successfully copied');\n       $page['infos'][] = '<a href=\"'. $activate_url . '\">' . l10n('Activate it now') . '</a>';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28a676b2d9e83319a4ad33deb0eda610a0674aab",
            "date": "2025-01-10T09:59:56Z",
            "author_login": "plegall"
          },
          {
            "sha": "64064b59741f5522c8d9e2cf392c90ffd43313c7",
            "date": "2025-01-09T09:33:09Z",
            "author_login": "LintyDev"
          },
          {
            "sha": "0cce9ef09d2d4012e580d507e6b363bc2ec044ea",
            "date": "2025-01-08T15:38:07Z",
            "author_login": "HWFord"
          },
          {
            "sha": "94148e0323230b74e2f2deb4e5753f6488c3fea7",
            "date": "2025-01-08T12:56:20Z",
            "author_login": "winstoy"
          },
          {
            "sha": "5b7fffe78684903e2599421f6e504062e57a4da7",
            "date": "2025-01-08T10:33:27Z",
            "author_login": "HWFord"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Piwigo is an open source photo gallery application. Prior to version 14.0.0beta4, a reflected cross-site scripting (XSS) vulnerability is in the` /admin.php?page=plugins&tab=new&installstatus=ok&plugin_id=[here]` page. This vulnerability can be exploited by an attacker to inject malicious HTML and JS code into the HTML page, which could then be executed by admin users when they visit the URL with the payload. The vulnerability is caused by the insecure injection of the `plugin_id` value from the URL into the HTML page. An attacker can exploit this vulnerability by crafting a malicious URL that contains a specially crafted `plugin_id` value. When a victim who is logged in as an administrator visits this URL, the malicious code will be injected into the HTML page and executed. This vulnerability can be exploited by any attacker who has access to a malicious URL. However, only users who are logged in as administrators are affected. This is because the vulnerability is only present on the `/admin.php?page=plugins&tab=new&installstatus=ok&plugin_id=[here]` page, which is only accessible to administrators. Version 14.0.0.beta4 contains a patch for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-09T15:15:10.057",
    "last_modified": "2024-11-21T08:25:48.623",
    "fix_date": "2023-10-06T13:13:04Z"
  },
  "references": [
    {
      "url": "https://github.com/Piwigo/Piwigo/commit/cc99c0f1e967c5f1722a0cce30ff42374a7bbc23",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Piwigo/Piwigo/security/advisories/GHSA-qg85-957m-7vgg",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Piwigo/Piwigo/commit/cc99c0f1e967c5f1722a0cce30ff42374a7bbc23",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Piwigo/Piwigo/security/advisories/GHSA-qg85-957m-7vgg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.583542",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Piwigo",
    "owner": "Piwigo",
    "created_at": "2015-07-25T11:32:24Z",
    "updated_at": "2025-01-14T04:03:21Z",
    "pushed_at": "2025-01-13T14:23:21Z",
    "size": 75667,
    "stars": 3333,
    "forks": 449,
    "open_issues": 707,
    "watchers": 3333,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 11006322,
      "HTML": 1488753,
      "JavaScript": 1039903,
      "Smarty": 656950,
      "CSS": 398303,
      "Yacc": 40453,
      "Perl": 27807,
      "Less": 5561,
      "Shell": 3901,
      "SCSS": 2818,
      "PureBasic": 2731
    },
    "commit_activity": {
      "total_commits_last_year": 249,
      "avg_commits_per_week": 4.788461538461538,
      "days_active_last_year": 118
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:37:56.448058"
  }
}