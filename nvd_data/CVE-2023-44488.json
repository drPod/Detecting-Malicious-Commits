{
  "cve_id": "CVE-2023-44488",
  "github_data": {
    "repository": "webmproject/libvpx",
    "fix_commit": "263682c9a29395055f3b3afe2d97be1828a6223f",
    "related_commits": [
      "263682c9a29395055f3b3afe2d97be1828a6223f",
      "df9fd9d5b7325060b2b921558a1eb20ca7880937",
      "263682c9a29395055f3b3afe2d97be1828a6223f",
      "df9fd9d5b7325060b2b921558a1eb20ca7880937"
    ],
    "patch_url": "https://github.com/webmproject/libvpx/commit/263682c9a29395055f3b3afe2d97be1828a6223f.patch",
    "fix_commit_details": {
      "sha": "263682c9a29395055f3b3afe2d97be1828a6223f",
      "commit_date": "2022-06-30T17:48:56Z",
      "author": {
        "login": "jeromejj",
        "type": "User",
        "stats": {
          "total_commits": 444,
          "average_weekly_commits": 0.5788787483702738,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 116
        }
      },
      "commit_message": {
        "title": "Fix bug with smaller width bigger size",
        "length": 157,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 51,
        "additions": 34,
        "deletions": 17
      },
      "files": [
        {
          "filename": "test/resize_test.cc",
          "status": "modified",
          "additions": 3,
          "deletions": 8,
          "patch": "@@ -102,11 +102,8 @@ void ScaleForFrameNumber(unsigned int frame, unsigned int initial_w,\n     if (frame < 30) {\n       return;\n     }\n-    if (frame < 100) {\n-      *w = initial_w * 7 / 10;\n-      *h = initial_h * 16 / 10;\n-      return;\n-    }\n+    *w = initial_w * 7 / 10;\n+    *h = initial_h * 16 / 10;\n     return;\n   }\n   if (frame < 10) {\n@@ -559,9 +556,7 @@ TEST_P(ResizeRealtimeTest, TestExternalResizeWorks) {\n   }\n }\n \n-// TODO(https://crbug.com/webm/1642): This causes a segfault in\n-// init_encode_frame_mb_context().\n-TEST_P(ResizeRealtimeTest, DISABLED_TestExternalResizeSmallerWidthBiggerSize) {\n+TEST_P(ResizeRealtimeTest, TestExternalResizeSmallerWidthBiggerSize) {\n   ResizingVideoSource video;\n   video.flag_codec_ = true;\n   video.smaller_width_larger_size_ = true;"
        },
        {
          "filename": "vp9/common/vp9_alloccommon.c",
          "status": "modified",
          "additions": 6,
          "deletions": 7,
          "patch": "@@ -135,13 +135,6 @@ int vp9_alloc_context_buffers(VP9_COMMON *cm, int width, int height) {\n     cm->free_mi(cm);\n     if (cm->alloc_mi(cm, new_mi_size)) goto fail;\n   }\n-\n-  if (cm->seg_map_alloc_size < cm->mi_rows * cm->mi_cols) {\n-    // Create the segmentation map structure and set to 0.\n-    free_seg_map(cm);\n-    if (alloc_seg_map(cm, cm->mi_rows * cm->mi_cols)) goto fail;\n-  }\n-\n   if (cm->above_context_alloc_cols < cm->mi_cols) {\n     vpx_free(cm->above_context);\n     cm->above_context = (ENTROPY_CONTEXT *)vpx_calloc(\n@@ -156,6 +149,12 @@ int vp9_alloc_context_buffers(VP9_COMMON *cm, int width, int height) {\n     cm->above_context_alloc_cols = cm->mi_cols;\n   }\n \n+  if (cm->seg_map_alloc_size < cm->mi_rows * cm->mi_cols) {\n+    // Create the segmentation map structure and set to 0.\n+    free_seg_map(cm);\n+    if (alloc_seg_map(cm, cm->mi_rows * cm->mi_cols)) goto fail;\n+  }\n+\n   if (vp9_alloc_loop_filter(cm)) goto fail;\n \n   return 0;"
        },
        {
          "filename": "vp9/encoder/vp9_encoder.c",
          "status": "modified",
          "additions": 25,
          "deletions": 2,
          "patch": "@@ -2047,6 +2047,17 @@ static void alloc_copy_partition_data(VP9_COMP *cpi) {\n   }\n }\n \n+static void free_copy_partition_data(VP9_COMP *cpi) {\n+  vpx_free(cpi->prev_partition);\n+  cpi->prev_partition = NULL;\n+  vpx_free(cpi->prev_segment_id);\n+  cpi->prev_segment_id = NULL;\n+  vpx_free(cpi->prev_variance_low);\n+  cpi->prev_variance_low = NULL;\n+  vpx_free(cpi->copied_frame_cnt);\n+  cpi->copied_frame_cnt = NULL;\n+}\n+\n void vp9_change_config(struct VP9_COMP *cpi, const VP9EncoderConfig *oxcf) {\n   VP9_COMMON *const cm = &cpi->common;\n   RATE_CONTROL *const rc = &cpi->rc;\n@@ -2126,6 +2137,8 @@ void vp9_change_config(struct VP9_COMP *cpi, const VP9EncoderConfig *oxcf) {\n     new_mi_size = cm->mi_stride * calc_mi_size(cm->mi_rows);\n     if (cm->mi_alloc_size < new_mi_size) {\n       vp9_free_context_buffers(cm);\n+      vp9_free_pc_tree(&cpi->td);\n+      vpx_free(cpi->mbmi_ext_base);\n       alloc_compressor_data(cpi);\n       realloc_segmentation_maps(cpi);\n       cpi->initial_width = cpi->initial_height = 0;\n@@ -2144,8 +2157,18 @@ void vp9_change_config(struct VP9_COMP *cpi, const VP9EncoderConfig *oxcf) {\n     update_frame_size(cpi);\n \n   if (last_w != cpi->oxcf.width || last_h != cpi->oxcf.height) {\n-    memset(cpi->consec_zero_mv, 0,\n-           cm->mi_rows * cm->mi_cols * sizeof(*cpi->consec_zero_mv));\n+    vpx_free(cpi->consec_zero_mv);\n+    CHECK_MEM_ERROR(\n+        &cm->error, cpi->consec_zero_mv,\n+        vpx_calloc(cm->mi_rows * cm->mi_cols, sizeof(*cpi->consec_zero_mv)));\n+\n+    vpx_free(cpi->skin_map);\n+    CHECK_MEM_ERROR(\n+        &cm->error, cpi->skin_map,\n+        vpx_calloc(cm->mi_rows * cm->mi_cols, sizeof(cpi->skin_map[0])));\n+\n+    free_copy_partition_data(cpi);\n+    alloc_copy_partition_data(cpi);\n     if (cpi->oxcf.aq_mode == CYCLIC_REFRESH_AQ)\n       vp9_cyclic_refresh_reset_resize(cpi);\n     rc->rc_1_frame = 0;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "95c4bf08ff52529d6e16b21b001af201717f0ed1",
            "date": "2025-01-14T02:53:59Z",
            "author_login": "wantehchang"
          },
          {
            "sha": "94a8a2175e740ee387f465305530b8508e821054",
            "date": "2025-01-14T00:54:21Z",
            "author_login": "wantehchang"
          },
          {
            "sha": "d699ef4835987afeacb5d3bd99b44b7981278e2d",
            "date": "2025-01-13T21:15:04Z",
            "author_login": "jzern"
          },
          {
            "sha": "f0e4bff711a7071c1aa677de38251d064cf030e2",
            "date": "2025-01-10T19:04:46Z",
            "author_login": "jeromejj"
          },
          {
            "sha": "7a65480684b1b28bb9defae164bf0dc78b32653e",
            "date": "2025-01-09T18:20:24Z",
            "author_login": "jzern"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-755",
    "description": "VP9 in libvpx before 1.13.1 mishandles widths, leading to a crash related to encoding.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-30T20:15:10.200",
    "last_modified": "2024-11-21T08:25:59.403",
    "fix_date": "2022-06-30T17:48:56Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/09/30/4",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2241806",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/commit/263682c9a29395055f3b3afe2d97be1828a6223f",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/commit/df9fd9d5b7325060b2b921558a1eb20ca7880937",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/compare/v1.13.0...v1.13.1",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/releases/tag/v1.13.1",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00001.html",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TE7F54W5O5RS4ZMAAC7YK3CZWQXIDSKB/",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202310-04",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5518",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/09/30/4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2241806",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/commit/263682c9a29395055f3b3afe2d97be1828a6223f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/commit/df9fd9d5b7325060b2b921558a1eb20ca7880937",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/compare/v1.13.0...v1.13.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/webmproject/libvpx/releases/tag/v1.13.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00001.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TE7F54W5O5RS4ZMAAC7YK3CZWQXIDSKB/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202310-04",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5518",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.562745",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libvpx",
    "owner": "webmproject",
    "created_at": "2014-08-13T19:03:21Z",
    "updated_at": "2025-01-14T04:00:45Z",
    "pushed_at": "2025-01-14T04:00:41Z",
    "size": 72175,
    "stars": 907,
    "forks": 343,
    "open_issues": 2,
    "watchers": 907,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 12838403,
      "C++": 1662532,
      "Assembly": 930605,
      "Makefile": 212452,
      "Shell": 183901,
      "Perl": 172373,
      "Python": 64929,
      "Processing": 26539
    },
    "commit_activity": {
      "total_commits_last_year": 330,
      "avg_commits_per_week": 6.346153846153846,
      "days_active_last_year": 151
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T20:48:11.965963"
  }
}