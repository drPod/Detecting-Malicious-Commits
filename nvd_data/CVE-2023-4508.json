{
  "cve_id": "CVE-2023-4508",
  "github_data": {
    "repository": "gerbv/gerbv",
    "fix_commit": "5517e22250e935dc7f86f64ad414aeae3dbcb36a",
    "related_commits": [
      "5517e22250e935dc7f86f64ad414aeae3dbcb36a",
      "5517e22250e935dc7f86f64ad414aeae3dbcb36a"
    ],
    "patch_url": "https://github.com/gerbv/gerbv/commit/5517e22250e935dc7f86f64ad414aeae3dbcb36a.patch",
    "fix_commit_details": {
      "sha": "5517e22250e935dc7f86f64ad414aeae3dbcb36a",
      "commit_date": "2023-07-13T17:11:48Z",
      "author": {
        "login": "eyal0",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: Out-of-bounds memory access of filename.",
        "length": 345,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 23,
        "deletions": 6
      },
      "files": [
        {
          "filename": "src/gerb_file.c",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -131,6 +131,9 @@ gerb_fopen(char const * filename)\n \n #endif\n \n+    dprintf(\"     Setting filename\\n\");\n+    fd->filename = g_strdup(filename);\n+\n     dprintf(\"<--- Leaving gerb_fopen\\n\");\n     return fd;\n } /* gerb_fopen */\n@@ -238,6 +241,8 @@ void\n gerb_fclose(gerb_file_t *fd)\n {\n     if (fd) {\n+        g_free(fd->filename);\n+\n #ifdef HAVE_SYS_MMAN_H\n \tif (munmap(fd->data, fd->datalen) < 0)\n \t    GERB_FATAL_ERROR(\"munmap: %s\", strerror(errno));"
        },
        {
          "filename": "src/gerber.c",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1476,7 +1476,7 @@ parse_rs274x(gint levelOfRecursion, gerb_file_t *fd, gerbv_image_t *image,\n \t\t\t\t\"include file recursion which is not allowed \"\n \t\t\t\t\"by the RS-274X spec\"));\n \t\t}\n-\t\t\n+\t\tg_free (includeFilename);\n \t    }\n \t}\n \tbreak;"
        },
        {
          "filename": "src/gerbv.c",
          "status": "modified",
          "additions": 0,
          "deletions": 4,
          "patch": "@@ -507,9 +507,6 @@ gerbv_open_image(gerbv_project_t *gerbvProject, gchar const* filename, int idx,\n \treturn -1;\n     }\n \n-    /* Store filename info fd for further use */\n-    fd->filename = g_strdup(filename);\n-    \n     dprintf(\"In open_image, successfully opened file.  Now check its type....\\n\");\n     /* Here's where we decide what file type we have */\n     /* Note: if the file has some invalid characters in it but still appears to\n@@ -578,7 +575,6 @@ gerbv_open_image(gerbv_project_t *gerbvProject, gchar const* filename, int idx,\n \tparsed_image = NULL;\n     }\n     \n-    g_free(fd->filename);\n     gerb_fclose(fd);\n     if (parsed_image == NULL) {\n \treturn -1;"
        },
        {
          "filename": "test/golden/parse_aperture_strtok.png",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "test/inputs/parse_aperture_strtok.1.poc",
          "status": "added",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -0,0 +1,11 @@\n+%FSLAX25Y25*%\n+%MOIN*%\n+\n+%ADD20C,BBBB*%\n+\n+%IFparse_aperture_strtok.2.poc*%\n+\n+D21*\n+X400000Y400000D03*\n+\n+M02*"
        },
        {
          "filename": "test/inputs/parse_aperture_strtok.2.poc",
          "status": "added",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -0,0 +1,2 @@\n+M09*\n+"
        },
        {
          "filename": "test/run_valgrind_tests.sh",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -2,4 +2,5 @@\n ./run_tests.sh --valgrind \\\n                example_cslk \\\n                out-of-bounds-drill-tool \\\n-               example_am_test\n+               example_am_test \\\n+               parse_aperture_strtok"
        },
        {
          "filename": "test/tests.list",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -182,6 +182,8 @@ test-circular-interpolation-zero-error  |  test-circular-interpolation-zero-erro\n test-merge-a+b_temporary | test-merge-a.gbx test-merge-b.gbx | ! --export=rs274x --output=inputs/test-merge-a+b_temporary.gbx\n test-merge-a+b | test-merge-a+b_temporary.gbx\n \n+parse_aperture_strtok | parse_aperture_strtok.1.poc\n+\n # ---------------------------------------------\n # Excellon drill tests\n # ---------------------------------------------"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 5,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "93f1b5b0c4fc74ba25dcbcd20154bed825c77126",
            "date": "2024-08-13T08:44:13Z",
            "author_login": "spe-ciellt"
          },
          {
            "sha": "e39eb6f3085170e9255704fc6aeb0ff3eddf4a08",
            "date": "2024-08-12T20:45:34Z",
            "author_login": "PingPongun"
          },
          {
            "sha": "ccf6a3cb705fa1fe4cee00858307723dc78df1d5",
            "date": "2023-09-01T18:40:02Z",
            "author_login": "henrygab"
          },
          {
            "sha": "99ddf1f43f6c47e2bd27d3ed5ca7eba17ff318ad",
            "date": "2023-09-01T18:02:27Z",
            "author_login": "henrygab"
          },
          {
            "sha": "d5283c4e8ce816a023f1ca8a141aee93016c77b0",
            "date": "2023-08-26T21:54:28Z",
            "author_login": "henrygab"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-824",
    "description": "A user able to control file input to Gerbv, between versions 2.4.0 and 2.10.0, can cause a crash and cause denial-of-service with a specially crafted Gerber RS-274X file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-08-24T23:15:09.380",
    "last_modified": "2024-11-21T08:35:19.117",
    "fix_date": "2023-07-13T17:11:48Z"
  },
  "references": [
    {
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4508",
      "source": "security@ubuntu.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gerbv/gerbv/commit/5517e22250e935dc7f86f64ad414aeae3dbcb36a",
      "source": "security@ubuntu.com",
      "tags": []
    },
    {
      "url": "https://github.com/gerbv/gerbv/issues/191",
      "source": "security@ubuntu.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4508",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/gerbv/gerbv/commit/5517e22250e935dc7f86f64ad414aeae3dbcb36a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/gerbv/gerbv/issues/191",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:06.470921",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gerbv",
    "owner": "gerbv",
    "created_at": "2021-08-25T11:59:53Z",
    "updated_at": "2025-01-06T05:49:48Z",
    "pushed_at": "2024-08-13T08:44:13Z",
    "size": 21087,
    "stars": 139,
    "forks": 41,
    "open_issues": 78,
    "watchers": 139,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C": 1272425,
      "Perl": 104406,
      "Shell": 54822,
      "Scheme": 46271,
      "M4": 40408,
      "Makefile": 27964,
      "GAP": 16526,
      "C++": 11065,
      "G-code": 5798,
      "Python": 4583,
      "NSIS": 2082,
      "SMT": 1523
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T18:33:22.926144"
  }
}