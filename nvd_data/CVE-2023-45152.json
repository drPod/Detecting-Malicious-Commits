{
  "cve_id": "CVE-2023-45152",
  "github_data": {
    "repository": "engelsystem/engelsystem",
    "fix_commit": "ee7d30b33935ea001705f438fec8ffd05734f295",
    "related_commits": [
      "ee7d30b33935ea001705f438fec8ffd05734f295",
      "ee7d30b33935ea001705f438fec8ffd05734f295"
    ],
    "patch_url": "https://github.com/engelsystem/engelsystem/commit/ee7d30b33935ea001705f438fec8ffd05734f295.patch",
    "fix_commit_details": {
      "sha": "ee7d30b33935ea001705f438fec8ffd05734f295",
      "commit_date": "2023-09-17T11:25:11Z",
      "author": {
        "login": "MyIgel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Schedule import: Show error message on schedule parsing errors",
        "length": 62,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 18,
        "additions": 14,
        "deletions": 4
      },
      "files": [
        {
          "filename": "src/Helpers/Schedule/XmlParser.php",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -15,8 +15,7 @@ class XmlParser\n \n     public function load(string $xml): bool\n     {\n-        $scheduleXML = simplexml_load_string($xml);\n-\n+        $scheduleXML = simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOWARNING | LIBXML_NOERROR);\n         if (!$scheduleXML) {\n             return false;\n         }"
        },
        {
          "filename": "tests/Unit/Helpers/Schedule/Assets/schedule-invalid.html",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+<!DOCTYPE html>\n+<html lang=\"\">\n+<head>\n+    <title>I'm HTML!</title>\n+</head>\n+<body>\n+This is not a schedule<br>\n+and thus must be ignored.\n+</body>\n+</html>"
        },
        {
          "filename": "tests/Unit/Helpers/Schedule/XmlParserTest.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -23,12 +23,13 @@ class XmlParserTest extends TestCase\n      */\n     public function testLoad(): void\n     {\n-        libxml_use_internal_errors(true);\n-\n         $parser = new XmlParser();\n \n         // Invalid XML\n         $this->assertFalse($parser->load('foo'));\n+        // Invalid schedule\n+        $this->assertFalse($parser->load(file_get_contents(__DIR__ . '/Assets/schedule-invalid.html')));\n+\n         // Minimal import\n         $this->assertTrue($parser->load(file_get_contents(__DIR__ . '/Assets/schedule-minimal.xml')));\n         // Basic import"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd3c1f373149cdfbde169926f92fb7a7c0688c76",
            "date": "2024-12-29T17:53:54Z",
            "author_login": "xuwhite"
          },
          {
            "sha": "ea0bab3c6315351130c7f54a53da0b71f34ad2c4",
            "date": "2024-12-27T13:50:37Z",
            "author_login": "MyIgel"
          },
          {
            "sha": "e8e9a6b4f5eef89faf9dfe45de23b6f3bcdb4c68",
            "date": "2024-12-28T15:27:36Z",
            "author_login": "MyIgel"
          },
          {
            "sha": "2a12e1b9868f48525ee8e1e00f8b25bac047ba72",
            "date": "2024-12-26T15:16:41Z",
            "author_login": "MyIgel"
          },
          {
            "sha": "d5c55dbef01f0f4f7f623120a6e3c31a00636a43",
            "date": "2024-12-26T14:05:26Z",
            "author_login": "MyIgel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.0,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-918",
    "description": "Engelsystem is a shift planning system for chaos events. A Blind SSRF in the \"Import schedule\" functionality makes it possible to perform a port scan against the local environment. This vulnerability has been fixed in commit ee7d30b33. If a patch cannot be deployed, operators should ensure that no HTTP(s) services listen on localhost and/or systems only reachable from the host running the engelsystem software. If such services are necessary, they should utilize additional authentication.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-17T00:15:11.140",
    "last_modified": "2024-11-21T08:26:27.290",
    "fix_date": "2023-09-17T11:25:11Z"
  },
  "references": [
    {
      "url": "https://github.com/engelsystem/engelsystem/commit/ee7d30b33935ea001705f438fec8ffd05734f295",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/engelsystem/engelsystem/security/advisories/GHSA-jj9g-75wf-6ppf",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/engelsystem/engelsystem/commit/ee7d30b33935ea001705f438fec8ffd05734f295",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/engelsystem/engelsystem/security/advisories/GHSA-jj9g-75wf-6ppf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.609701",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "engelsystem",
    "owner": "engelsystem",
    "created_at": "2012-04-11T17:36:00Z",
    "updated_at": "2025-01-12T14:14:56Z",
    "pushed_at": "2025-01-08T21:37:05Z",
    "size": 20920,
    "stars": 454,
    "forks": 242,
    "open_issues": 215,
    "watchers": 454,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 2098832,
      "Twig": 204709,
      "SCSS": 81104,
      "JavaScript": 22404,
      "HTML": 6510,
      "Shell": 3629,
      "Dockerfile": 3423
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T18:19:37.653608"
  }
}