{
  "cve_id": "CVE-2023-4535",
  "github_data": {
    "repository": "OpenSC/OpenSC",
    "fix_commit": "f1993dc4e0b33050b8f72a3558ee88b24c4063b2",
    "related_commits": [
      "f1993dc4e0b33050b8f72a3558ee88b24c4063b2",
      "f1993dc4e0b33050b8f72a3558ee88b24c4063b2"
    ],
    "patch_url": "https://github.com/OpenSC/OpenSC/commit/f1993dc4e0b33050b8f72a3558ee88b24c4063b2.patch",
    "fix_commit_details": {
      "sha": "f1993dc4e0b33050b8f72a3558ee88b24c4063b2",
      "commit_date": "2023-06-27T07:50:42Z",
      "author": {
        "login": "popovec",
        "type": "User",
        "stats": {
          "total_commits": 71,
          "average_weekly_commits": 0.09985935302390998,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 39
        }
      },
      "commit_message": {
        "title": "myeid: fixed CID 380538  Out-of-bounds read (OVERRUN)",
        "length": 93,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "src/libopensc/card-myeid.c",
          "status": "modified",
          "additions": 6,
          "deletions": 4,
          "patch": "@@ -1986,18 +1986,20 @@ myeid_enc_dec_sym(struct sc_card *card, const u8 *data, size_t datalen,\n \t\t\t\tsc_log(ctx, \"Found padding byte %02x\", pad_byte);\n \t\t\t\tif (pad_byte == 0 || pad_byte > block_size)\n \t\t\t\t\tLOG_FUNC_RETURN(ctx, SC_ERROR_WRONG_PADDING);\n-\t\t\t\tsdata = priv->sym_plain_buffer + block_size - pad_byte;\n+\t\t\t\tsdata = priv->sym_plain_buffer + block_size;\n \t\t\t\tfor (i = 0; i < pad_byte; i++)\n-\t\t\t\t\tif (sdata[i] != pad_byte)\n+\t\t\t\t\tif (*(--sdata) != pad_byte)\n \t\t\t\t\t\tLOG_FUNC_RETURN(ctx, SC_ERROR_WRONG_PADDING);\n \t\t\t\treturn_len = block_size - pad_byte;\n \t\t\t}\n-\t\t\t*outlen = return_len;\n \t\t\t/* application can request buffer size or actual buffer size is too small */\n-\t\t\tif (out == NULL)\n+\t\t\tif (out == NULL) {\n+\t\t\t\t*outlen = return_len;\n \t\t\t\tLOG_FUNC_RETURN(ctx, SC_SUCCESS);\n+\t\t\t}\n \t\t\tif (return_len > *outlen)\n \t\t\t\tLOG_FUNC_RETURN(ctx, SC_ERROR_BUFFER_TOO_SMALL);\n+\t\t\t*outlen = return_len;\n \t\t\tmemcpy(out, priv->sym_plain_buffer, return_len);\n \t\t\tsc_log(ctx, \"C_DecryptFinal %zu bytes\", *outlen);\n \t\t\treturn SC_SUCCESS;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2d77452e6760c50a7d2bab722b8e06137fee79ce",
            "date": "2025-01-09T14:15:58Z",
            "author_login": "xhanulik"
          },
          {
            "sha": "50e1009ce8c82a5948105273ef531dc3828d3255",
            "date": "2025-01-09T14:12:25Z",
            "author_login": "xhanulik"
          },
          {
            "sha": "59e2638a79fe28745461a6a6e673c978d6e198f3",
            "date": "2025-01-09T14:11:44Z",
            "author_login": "xhanulik"
          },
          {
            "sha": "8c1a26023c0da489577f253d596ce0a488252faa",
            "date": "2024-12-17T09:44:08Z",
            "author_login": "Jakuje"
          },
          {
            "sha": "4c24dfbba4bbe2777b4675636fd89d745784823c",
            "date": "2025-01-06T21:36:10Z",
            "author_login": "tpetazzoni"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.5,
    "cvss_vector": "CVSS:3.1/AV:P/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-125",
    "description": "An out-of-bounds read vulnerability was found in OpenSC packages within the MyEID driver when handling symmetric key encryption. Exploiting this flaw requires an attacker to have physical access to the computer and a specially crafted USB device or smart card. This flaw allows the attacker to manipulate APDU responses and potentially gain unauthorized access to sensitive data, compromising the system's security.",
    "attack_vector": "PHYSICAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-11-06T17:15:12.083",
    "last_modified": "2024-11-21T08:35:21.943",
    "fix_date": "2023-06-27T07:50:42Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHSA-2023:7879",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2023-4535",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2240914",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/commit/f1993dc4e0b33050b8f72a3558ee88b24c4063b2",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/issues/2792#issuecomment-1674806651",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/releases/tag/0.24.0-rc1",
      "source": "secalert@redhat.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/wiki/OpenSC-security-advisories",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2023:7879",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2023-4535",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2240914",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/commit/f1993dc4e0b33050b8f72a3558ee88b24c4063b2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/issues/2792#issuecomment-1674806651",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/releases/tag/0.24.0-rc1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/OpenSC/OpenSC/wiki/OpenSC-security-advisories",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3CPQOMCDWFRBMEFR5VK4N5MMXXU42ODE/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GLYEFIBBA37TK3UNMZN5NOJ7IWCIXLQP/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.990164",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "OpenSC",
    "owner": "OpenSC",
    "created_at": "2011-07-05T09:45:08Z",
    "updated_at": "2025-01-13T13:10:21Z",
    "pushed_at": "2025-01-13T13:55:00Z",
    "size": 22961,
    "stars": 2633,
    "forks": 751,
    "open_issues": 133,
    "watchers": 2633,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 7104257,
      "M4": 95841,
      "Shell": 94340,
      "Makefile": 59947,
      "C++": 26987,
      "Objective-C": 17726,
      "Roff": 13853,
      "Dockerfile": 4471,
      "Lex": 2042,
      "AppleScript": 530,
      "BitBake": 273
    },
    "commit_activity": {
      "total_commits_last_year": 306,
      "avg_commits_per_week": 5.884615384615385,
      "days_active_last_year": 130
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T13:02:30.052371"
  }
}