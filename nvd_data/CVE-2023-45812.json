{
  "cve_id": "CVE-2023-45812",
  "github_data": {
    "repository": "apollographql/router",
    "fix_commit": null,
    "related_commits": [],
    "patch_url": null
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-754",
    "description": "The Apollo Router is a configurable, high-performance graph router written in Rust to run a federated supergraph that uses Apollo Federation. Affected versions are subject to a Denial-of-Service (DoS) type vulnerability which causes the Router to panic and terminate when a multi-part response is sent. When users send queries to the router that uses the `@defer` or Subscriptions, the Router will panic. To be vulnerable, users of Router must have a coprocessor with `coprocessor.supergraph.response` configured in their `router.yaml` and also to support either `@defer` or Subscriptions. Apollo Router version 1.33.0 has a fix for this vulnerability which was introduced in PR #4014. Users are advised to upgrade. Users unable to upgrade should avoid using the coprocessor supergraph response or disable defer and subscriptions support and continue to use the coprocessor supergraph response.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-18T22:15:09.403",
    "last_modified": "2024-11-21T08:27:24.350",
    "fix_date": null
  },
  "references": [
    {
      "url": "https://github.com/apollographql/router/pull/4014",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/apollographql/router/security/advisories/GHSA-r344-xw3p-2frj",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/apollographql/router/pull/4014",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/apollographql/router/security/advisories/GHSA-r344-xw3p-2frj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.906138",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "router",
    "owner": "apollographql",
    "created_at": "2021-11-04T13:05:56Z",
    "updated_at": "2025-01-14T14:27:12Z",
    "pushed_at": "2025-01-14T14:32:18Z",
    "size": 44306,
    "stars": 831,
    "forks": 275,
    "open_issues": 508,
    "watchers": 831,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "1.2.2",
      "1.2.3",
      "1.2.3456",
      "1.12.0",
      "1.23.0-alpha.0",
      "1.24.0-alpha.0",
      "1.24.0-alpha.1",
      "1.25.0-alpha.0",
      "1.25.0-alpha.1",
      "1.25.0-alpha.2",
      "1.27.0-alpha.1",
      "1.28.0-alpha.0",
      "1.30.0-alpha.1",
      "1.32.1-alpha.1",
      "1.33.2-alpha.0",
      "1.34.0-alpha.0",
      "1.43.3",
      "1.45.1",
      "1.46.0-rc.0",
      "1.52.2",
      "1.55.1",
      "1.58.1+telemetry-fix",
      "1.123.456"
    ],
    "languages": {
      "Rust": 8602740,
      "TLA": 23302,
      "Shell": 13702,
      "TypeScript": 7544,
      "HTML": 4831,
      "Smarty": 3754,
      "Dockerfile": 3307,
      "Handlebars": 1847,
      "RenderScript": 1
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:36:29.734203"
  }
}