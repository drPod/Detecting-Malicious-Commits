{
  "cve_id": "CVE-2023-45826",
  "github_data": {
    "repository": "Leantime/leantime",
    "fix_commit": "be75f1e0f311d11c00a0bdc7079a62eef3594bf0",
    "related_commits": [
      "be75f1e0f311d11c00a0bdc7079a62eef3594bf0",
      "be75f1e0f311d11c00a0bdc7079a62eef3594bf0"
    ],
    "patch_url": "https://github.com/Leantime/leantime/commit/be75f1e0f311d11c00a0bdc7079a62eef3594bf0.patch",
    "fix_commit_details": {
      "sha": "be75f1e0f311d11c00a0bdc7079a62eef3594bf0",
      "commit_date": "2023-09-25T18:38:45Z",
      "author": {
        "login": "marcelfolaron",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #1906 from Leantime/bugFixes",
        "length": 58,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 1091,
        "additions": 551,
        "deletions": 540
      },
      "files": [
        {
          "filename": ".idea/dataSources.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,11 +1,11 @@\n <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n <project version=\"4\">\n   <component name=\"DataSourceManagerImpl\" format=\"xml\" multifile-model=\"true\">\n-    <data-source source=\"LOCAL\" name=\"@localhost\" uuid=\"f200fc91-feb5-4e3c-8889-4b23c990407e\">\n+    <data-source source=\"LOCAL\" name=\"leantime-24-subfolder@localhost\" uuid=\"f200fc91-feb5-4e3c-8889-4b23c990407e\">\n       <driver-ref>mysql.8</driver-ref>\n       <synchronize>true</synchronize>\n       <jdbc-driver>com.mysql.cj.jdbc.Driver</jdbc-driver>\n-      <jdbc-url>jdbc:mysql://localhost:3306</jdbc-url>\n+      <jdbc-url>jdbc:mysql://localhost:3306/leantime-24-subfolder</jdbc-url>\n       <working-dir>$ProjectFileDir$</working-dir>\n     </data-source>\n   </component>"
        },
        {
          "filename": ".idea/symfony2.xml",
          "status": "added",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -0,0 +1,6 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<project version=\"4\">\n+  <component name=\"Symfony2PluginSettings\">\n+    <option name=\"dismissEnableNotification\" value=\"true\" />\n+  </component>\n+</project>\n\\ No newline at end of file"
        },
        {
          "filename": "app/Core/AppSettings.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -10,9 +10,9 @@\n  */\n class AppSettings\n {\n-    public $appVersion = \"2.4-beta-3\";\n+    public $appVersion = \"2.4-beta-4\";\n \n-    public $dbVersion = \"2.1.21\";\n+    public $dbVersion = \"2.1.22\";\n \n     protected Environment $config;\n "
        },
        {
          "filename": "app/Core/Bootloader.php",
          "status": "modified",
          "additions": 12,
          "deletions": 6,
          "patch": "@@ -137,19 +137,17 @@ public function boot(): void\n         }\n \n         if (! defined('CURRENT_URL')) {\n-            define('CURRENT_URL', !empty($config->appUrl)\n-            ? $config->appUrl . $request->getPathInfo()\n-            : $request->getFullUrl());\n+            define('CURRENT_URL', BASE_URL . $request->getRequestUri());\n         }\n \n         $this->loadHeaders();\n \n         $this->checkIfInstalled();\n \n-        $this->checkIfUpdated();\n-\n         Events::discover_listeners();\n \n+        $this->checkIfUpdated();\n+\n         /**\n          * The beginning of the application\n          *\n@@ -188,10 +186,13 @@ public function getApplication(): Application\n         $this->bindRequest();\n \n         // Setup Configuration\n-        $this->app->singleton(Environment::class, Environment::class);\n+        //$this->app->singleton(Environment::class, Environment::class);\n+        $this->app->singleton(Environment::class, fn ($app) => $_SESSION['configclass'] ??= new Environment($app->make(DefaultConfig::class)));\n         $this->app->alias(Environment::class, \\Illuminate\\Contracts\\Config\\Repository::class);\n         $this->app->alias(Environment::class, alias: \"config\");\n \n+\n+\n         // specify singletons/instances\n         $this->app->singleton(Db::class, Db::class);\n         $this->app->singleton(Frontcontroller::class, Frontcontroller::class);\n@@ -351,6 +352,8 @@ private function handleRequest(): void\n         $frontController = $this->app->make(Frontcontroller::class);\n         $incomingRequest = $this->app->make(IncomingRequest::class);\n \n+        $this->publicActions = self::dispatch_filter(\"publicActions\", $this->publicActions, ['bootloader' => $this]);\n+\n         // handle public request\n         if (in_array($frontController::getCurrentRoute(), $this->publicActions)) {\n             $frontController::dispatch();\n@@ -359,6 +362,9 @@ private function handleRequest(): void\n \n         // handle API request\n         if ($incomingRequest instanceof ApiRequest) {\n+\n+            self::dispatch_event(\"before_api_request\", ['application' => $this]);\n+\n             $apiKey = $incomingRequest->getAPIKey();\n             $apiUser = $this->app->make(ApiService::class)->getAPIKeyUser($apiKey);\n "
        },
        {
          "filename": "app/Core/DefaultConfig.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -268,7 +268,10 @@ class DefaultConfig\n         \"email\":\"mail\",\n         \"firstname\":\"displayname\",\n         \"lastname\":\"\",\n-        \"phonenumber\":\"\"\n+        \"phone\":\"\",\n+        \"jobTitle\":\"title\",\n+        \"jobLevel\":\"level\",\n+        \"department\":\"department\"\n         }';\n     //For AD use\n     /*"
        },
        {
          "filename": "app/Core/Environment.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -144,7 +144,7 @@ class Environment implements ArrayAccess, ConfigContract\n     /**\n      * @var string S3 End Point\n      */\n-    public string $s3EndPoint;\n+    public ?string $s3EndPoint;\n \n     /**\n      * @var string S3 Key\n@@ -503,7 +503,7 @@ public function __construct(DefaultConfig $defaultConfiguration)\n         }\n \n         /* Plugins */\n-        $this->plugins = $this->getString('LEAN_PLUGINS', '');\n+        $this->plugins = $this->environmentHelper(\"LEAN_PLUGINS\", $defaultConfiguration->plugins ?? '', \"string\");\n     }\n \n     /**"
        },
        {
          "filename": "app/Core/Events.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -177,7 +177,7 @@ public static function discover_listeners(): void\n         $pluginPath = APP_ROOT . \"/app/Plugins/\";\n \n         $enabledPlugins = [];\n-        if ($_SESSION['isInstalled'] === true && $_SESSION['isUpdated'] === true) {\n+        if ($_SESSION['isInstalled'] === true) {\n             $pluginService = app()->make(\\Leantime\\Domain\\Plugins\\Services\\Plugins::class);\n             $enabledPlugins = $pluginService->getEnabledPlugins();\n         }"
        },
        {
          "filename": "app/Core/Fileupload.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -348,6 +348,7 @@ public function displayImageFile($imageName, $fullPath = '')\n         );\n \n         if ($this->config->useS3 == true && $fullPath == '') {\n+\n             $s3Client = new S3Client([\n                 'version'     => 'latest',\n                 'region'      => $this->config->s3Region,\n@@ -394,6 +395,10 @@ public function displayImageFile($imageName, $fullPath = '')\n                 if ($ext == 'jpg' || $ext == 'jpeg' || $ext == 'gif' || $ext == 'png') {\n                     header('Content-type: ' . $mimes[$ext]);\n                     header('Content-disposition: inline; filename=\"' . $imageName . '\";');\n+                    header('Pragma: public');\n+                    header('Cache-Control: max-age=900');\n+                    header('Expires: ' . gmdate('D, d M Y H:i:s \\G\\M\\T', time() + 900));\n+\n \n                     readfile($fullPath);\n                 }"
        },
        {
          "filename": "app/Core/Frontcontroller.php",
          "status": "modified",
          "additions": 9,
          "deletions": 21,
          "patch": "@@ -60,7 +60,7 @@ public function __construct(IncomingRequest $incomingRequest)\n      * @param  integer $httpResponseCode\n      * @return void\n      */\n-    public static function dispatch($action = '', $httpResponseCode = 200): void\n+    public static function dispatch(string $action = '', int $httpResponseCode = 200): void\n     {\n         self::$fullAction = empty($action) ? self::getCurrentRoute() : $action;\n \n@@ -69,11 +69,7 @@ public static function dispatch($action = '', $httpResponseCode = 200): void\n         }\n \n         //execute action\n-        try {\n-            self::executeAction(self::$fullAction, array(), $httpResponseCode);\n-        } catch (Exception $e) {\n-            echo $e->getMessage();\n-        }\n+        self::executeAction(self::$fullAction, array(), $httpResponseCode);\n     }\n \n     /**\n@@ -96,25 +92,17 @@ private static function executeAction($completeName, $params = array()): void\n         $incomingRequest = app()->make(IncomingRequest::class);\n         $controllerType = $incomingRequest instanceof HtmxRequest ? 'Hxcontrollers' : 'Controllers';\n \n-        // Execute The Route\n-        try {\n-            //Setting default response code to 200, can be changed in controller\n-            self::setResponseCode(200);\n-\n-            $classname = \"$namespace\\\\$controllerNs\\\\$moduleName\\\\$controllerType\\\\$actionName\";\n+        //Setting default response code to 200, can be changed in controller\n+        self::setResponseCode(200);\n \n-            if (! class_exists($classname)) {\n-                self::redirect(BASE_URL . \"/errors/error404\", 404);\n-            }\n+        $classname = \"$namespace\\\\$controllerNs\\\\$moduleName\\\\$controllerType\\\\$actionName\";\n \n-            app()->make($classname);\n-        } catch (Exception $e) {\n-            error_log($e, 0);\n-            self::redirect(BASE_URL . \"/errors/error500\", 500);\n-\n-            return;\n+        if (! class_exists($classname)) {\n+            self::redirect(BASE_URL . \"/errors/error404\", 404);\n         }\n \n+        app()->make($classname);\n+\n         self::$lastAction = $completeName;\n     }\n "
        },
        {
          "filename": "app/Core/Mailer.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -91,7 +91,7 @@ class Mailer\n      * @access public\n      * @return void\n      */\n-    public function __construct(\\Leantime\\Core\\Environment $config, language $language)\n+    public function __construct(\\Leantime\\Core\\Environment $config, Language $language)\n     {\n         if ($config->email != '') {\n             $this->emailDomain = $config->email;"
        },
        {
          "filename": "app/Core/Template.php",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -307,6 +307,16 @@ public function setupDirectives()\n             'endspaceless',\n             fn ($args) => \"<?php echo preg_replace('/>\\\\s+</', '><', ob_get_clean()); ?>\",\n         );\n+\n+        $this->bladeCompiler->directive(\n+            'formatDate',\n+            fn ($args) => \"<?php echo \\$tpl->getFormattedDateString($args); ?>\",\n+        );\n+\n+        $this->bladeCompiler->directive(\n+            'formatTime',\n+            fn ($args) => \"<?php echo \\$tpl->getFormattedTimeString($args); ?>\",\n+        );\n     }\n \n     /**"
        },
        {
          "filename": "app/Domain/Api/Controllers/ApiKey.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -25,6 +25,9 @@ public function init(\n             UserRepository $userRepo,\n             ClientRepository $clientsRepo\n         ) {\n+\n+            self::dispatch_event('api_key_init', $this);\n+\n             $this->projectsRepo = $projectsRepo;\n             $this->userRepo = $userRepo;\n             $this->clientsRepo = $clientsRepo;"
        },
        {
          "filename": "app/Domain/Api/Controllers/NewApiKey.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -28,6 +28,9 @@ public function init(\n             UserService $userService,\n             ApiService $APIService\n         ) {\n+\n+            self::dispatch_event('api_key_init', $this);\n+\n             $this->userRepo = $userRepo;\n             $this->projectsRepo = $projectsRepo;\n             $this->userService = $userService;"
        },
        {
          "filename": "app/Domain/Auth/Controllers/LoginInfo.php",
          "status": "removed",
          "additions": 0,
          "deletions": 89,
          "patch": "@@ -1,89 +0,0 @@\n-<?php\n-\n-namespace Leantime\\Domain\\Auth\\Controllers {\n-\n-    use Leantime\\Core\\Frontcontroller as FrontcontrollerCore;\n-    use Leantime\\Core\\Controller;\n-    use Leantime\\Domain\\Users\\Repositories\\Users as UserRepository;\n-    use Leantime\\Domain\\Users\\Services\\Users as UserService;\n-    use Leantime\\Domain\\Auth\\Services\\Auth as AuthService;\n-    class LoginInfo extends Controller\n-    {\n-        private UserRepository $userRepo;\n-        private UserService $userService;\n-\n-        private AuthService $authService;\n-\n-        public function init(\n-            UserRepository $userRepo,\n-            UserService $userService,\n-            AuthService $authService\n-        ) {\n-            $this->userRepo = $userRepo;\n-            $this->userService = $userService;\n-            $this->authService = $authService;\n-        }\n-\n-        public function run()\n-        {\n-            $user = false;\n-            if (isset($_SESSION['userdata'])) {\n-                $user = $this->userService->getUser($_SESSION['userdata']['id']);\n-            }\n-\n-            if ($user === false) {\n-                $this->authService->logout();\n-                FrontcontrollerCore::redirect(BASE_URL . \"/auth/login\");\n-            }\n-\n-            $profilePicture = $this->userService->getProfilePicture($_SESSION['userdata']['id']);\n-\n-            $availableModals = array(\n-                \"tickets/showAll\" => \"backlog\",\n-                \"dashboard/show\" => \"dashboard\",\n-                \"dashboard/home\" => \"dashboard\",\n-                \"leancanvas/showCanvas\" => \"fullLeanCanvas\",\n-                \"leancanvas/simpleCanvas\" => \"simpleLeanCanvas\",\n-                \"ideas/showBoards\" => \"ideaBoard\",\n-                \"ideas/advancedBoards\" => \"advancedBoards\",\n-                \"tickets/roadmap\" => \"roadmap\",\n-                \"retroscanvas/showBoards\" => \"retroscanvas\",\n-                \"tickets/showKanban\" => \"kanban\",\n-                \"timesheets/showMy\" => \"mytimesheets\",\n-                \"projects/newProject\" => \"newProject\",\n-                \"projects/showProject\" => \"projectSuccess\",\n-                \"projects/showAll\" => \"showProjects\",\n-                \"clients/showAll\" => \"showClients\",\n-            );\n-\n-            $url = CURRENT_URL;\n-\n-            $requestParams = explode(BASE_URL, $url);\n-            $urlParts = explode('/', $requestParams[1]);\n-            $modal = \"\";\n-\n-            if (count($urlParts) > 2) {\n-                $urlKey =  $urlParts[1] . \"/\" . $urlParts[2];\n-\n-                if (isset($availableModals[$urlKey])) {\n-                    $modal = $availableModals[$urlKey];\n-                } else {\n-                    $modal = \"notfound\";\n-                }\n-            } else {\n-                $modal = \"dashboard\";\n-            }\n-\n-            $this->tpl->assign(\"modal\", $modal);\n-\n-\n-            $this->tpl->assign(\"profilePicture\", $profilePicture);\n-            $this->tpl->assign(\"userName\", $user[\"firstname\"]);\n-            $this->tpl->assign(\"userId\", $user[\"id\"]);\n-            $this->tpl->assign(\"userEmail\", $user[\"username\"]);\n-            $this->tpl->assign(\"profileId\", $user[\"profileId\"]);\n-\n-            $this->tpl->displayPartial(\"auth.loginInfo\");\n-        }\n-    }\n-}"
        },
        {
          "filename": "app/Domain/Auth/Services/Auth.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -323,6 +323,7 @@ public function setUserSession($user, $isLdap = false)\n                         'twoFASecret' => $this->twoFASecret,\n                         'isLdap' => $isLdap,\n                         'createdOn' => $user['createdOn'] ?? '',\n+                        'modified' => $user['modified'] ?? date(\"Y-m-d H:i:s\"),\n             ]);\n \n             $this->updateUserSessionDB($this->userId, $this->session);"
        },
        {
          "filename": "app/Domain/Auth/Templates/loginInfo.tpl.php",
          "status": "removed",
          "additions": 0,
          "deletions": 54,
          "patch": "@@ -1,54 +0,0 @@\n-<?php\n-    defined('RESTRICTED') or die('Restricted access');\n-foreach ($__data as $var => $val) {\n-    $$var = $val; // necessary for blade refactor\n-}\n-?>\n-\n-<?php $tpl->dispatchTplEvent('beforeUserinfoMenuOpen'); ?>\n-<div class=\"userinfo\">\n-    <?php $tpl->dispatchTplEvent('afterUserinfoMenuOpen'); ?>\n-    <a href='<?=BASE_URL ?>/users/editOwn/' class=\"dropdown-toggle profileHandler\" data-toggle=\"dropdown\">\n-        <img src=\"<?=BASE_URL ?>/api/users?profileImage=<?php echo $tpl->get('userId'); ?>\" class=\"profilePicture\"/>\n-        <i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i>\n-    </a>\n-    <ul class=\"dropdown-menu\">\n-        <?php $tpl->dispatchTplEvent('afterUserinfoDropdownMenuOpen'); ?>\n-        <li>\n-            <a href='<?=BASE_URL ?>/users/editOwn/'>\n-                <?=$tpl->__(\"menu.my_profile\")?>\n-            </a>\n-        </li>\n-\n-        <li class=\"nav-header border\"><?=$tpl->__(\"menu.help_support\")?></li>\n-        <li>\n-            <a href='javascript:void(0);'\n-               onclick=\"leantime.helperController.showHelperModal('<?php echo $tpl->get('modal'); ?>', 300, 500);\">\n-                <?=$tpl->__(\"menu.what_is_this_page\")?>\n-            </a>\n-        </li>\n-        <li>\n-            <a href='https://docs.leantime.io' target=\"_blank\">\n-                <?=$tpl->__(\"menu.knowledge_base\")?>\n-            </a>\n-        </li>\n-        <li>\n-            <a href='https://community.leantime.io' target=\"_blank\">\n-                <?=$tpl->__(\"menu.community\")?>\n-            </a>\n-        </li>\n-        <li>\n-            <a href='https://leantime.io/contact-us' target=\"_blank\">\n-                <?=$tpl->__(\"menu.contact_us\")?>\n-            </a>\n-        </li>\n-        <li class=\"border\">\n-            <a href='<?=BASE_URL ?>/auth/logout'>\n-                <?=$tpl->__(\"menu.sign_out\")?>\n-            </a>\n-        </li>\n-        <?php $tpl->dispatchTplEvent('beforeUserinfoDropdownMenuClose'); ?>\n-    </ul>\n-    <?php $tpl->dispatchTplEvent('beforeUserinfoMenuClose'); ?>\n-</div>\n-<?php $tpl->dispatchTplEvent('afterUserinfoMenuClose'); ?>"
        },
        {
          "filename": "app/Domain/Auth/Templates/partials/loginInfo.blade.php",
          "status": "added",
          "additions": 48,
          "deletions": 0,
          "patch": "@@ -0,0 +1,48 @@\n+@dispatchEvent('beforeUserinfoMenuOpen')\n+\n+<div class=\"userinfo\">\n+    @dispatchEvent('afterUserinfoMenuOpen')\n+    <a href='{{ BASE_URL }}/users/editOwn/' class=\"dropdown-toggle profileHandler\" data-toggle=\"dropdown\">\n+        <img src=\"{{ BASE_URL }}/api/users?profileImage={{ $user['id'] }}&v={{ strtotime($user['modified'] ?? '0') }}\" class=\"profilePicture\"/>\n+        <i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i>\n+    </a>\n+    <ul class=\"dropdown-menu\">\n+        @dispatchEvent('afterUserinfoDropdownMenuOpen')\n+        <li>\n+            <a href='{{ BASE_URL }}/users/editOwn/'>\n+                {!! __(\"menu.my_profile\") !!}\n+            </a>\n+        </li>\n+\n+        <li class=\"nav-header border\">{!! __(\"menu.help_support\") !!}</li>\n+        <li>\n+            <a href='javascript:void(0);'\n+               onclick=\"leantime.helperController.showHelperModal('{{ $modal }}', 300, 500);\">\n+                {!! __(\"menu.what_is_this_page\") !!}\n+            </a>\n+        </li>\n+        <li>\n+            <a href='https://leantime.io/knowledge-base' target=\"_blank\">\n+                {!! __(\"menu.knowledge_base\") !!}\n+            </a>\n+        </li>\n+        <li>\n+            <a href='https://discord.gg/4zMzJtAq9z' target=\"_blank\">\n+                {!! __(\"menu.community\") !!}\n+            </a>\n+        </li>\n+        <li>\n+            <a href='https://leantime.io/contact-us' target=\"_blank\">\n+                {!! __(\"menu.contact_us\") !!}\n+            </a>\n+        </li>\n+        <li class=\"border\">\n+            <a href='{{ BASE_URL }}/auth/logout'>\n+                {!! __(\"menu.sign_out\") !!}\n+            </a>\n+        </li>\n+        @dispatchEvent('beforeUserinfoDropdownMenuClose')\n+    </ul>\n+   @dispatchEvent('beforeUserinfoMenuClose')\n+</div>\n+@dispatchEvent('afterUserinfoMenuClose')"
        },
        {
          "filename": "app/Domain/Canvas/Templates/element.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -148,7 +148,7 @@ class=\"delete\"\n                                          $tpl->escape($user['lastname'])\n                                      ) . \"' data-value='\" . $row['id'] . \"_\" . $user['id'] . \"_\" .\n                                      $user['profileId'] . \"' id='userStatusChange\" . $row['id'] . $user['id'] . \"' ><img src='\" .\n-                                     BASE_URL . \"/api/users?profileImage=\" . $user['id'] . \"' width='25' \" .\n+                                     BASE_URL . \"/api/users?profileImage=\" . $user['id'] . \"&v=\" . $user['modified'] . \"' width='25' \" .\n                                      \"style='vertical-align: middle; margin-right:5px;'/>\" .\n                                      sprintf(\n                                          $tpl->__(\"text.full_name\"),"
        },
        {
          "filename": "app/Domain/Clients/Templates/showClient.tpl.php",
          "status": "modified",
          "additions": 21,
          "deletions": 21,
          "patch": "@@ -40,81 +40,81 @@\n                             <h4 class=\"widgettitle title-light\"><span class=\"fa fa-leaf\"></span> <?php echo $tpl->__('subtitle.details'); ?></h4>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.client_id') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.client_id') ?></label>\n+                                <div class=\"\">\n                                     <input type=\"text\" name=\"id\" id=\"id\" value=\"<?php $tpl->e($values['id']); ?>\" readonly />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.name') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.name') ?></label>\n+                                <div class=\"\">\n                                     <input type=\"text\" name=\"name\" id=\"name\" value=\"<?php $tpl->e($values['name']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.email') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.email') ?></label>\n+                                <div class=\"\">\n                                     <input type=\"text\" name=\"email\" id=\"email\" value=\"<?php $tpl->e($values['email']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.url') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.url') ?></label>\n+                                <div class=\"\">\n                                     <input\n                                             type=\"text\" name=\"internet\" id=\"internet\"\n                                             value=\"<?php $tpl->e($values['internet']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.street') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.street') ?></label>\n+                                <div class=\"\">\n                                     <input\n                                             type=\"text\" name=\"street\" id=\"street\"\n                                             value=\"<?php $tpl->e($values['street']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.zip') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.zip') ?></label>\n+                                <div class=\"\">\n                                     <input type=\"text\"\n                                     name=\"zip\" id=\"zip\" value=\"<?php $tpl->e($values['zip']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.city') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.city') ?></label>\n+                                <div class=\"\">\n                                     <input type=\"text\"\n                                            name=\"city\" id=\"city\" value=\"<?php $tpl->e($values['city']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.state') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.state') ?></label>\n+                                <div class=\"\">\n                                     <input\n                                             type=\"text\" name=\"state\" id=\"state\"\n                                             value=\"<?php $tpl->e($values['state']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.country') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.country') ?></label>\n+                                <div class=\"\">\n                                     <input\n                                             type=\"text\" name=\"country\" id=\"country\"\n                                             value=\"<?php $tpl->e($values['country']); ?>\" />\n                                 </div>\n                             </div>\n \n                             <div class=\"form-group\">\n-                                <label class=\"span4 control-label\"><?php echo $tpl->__('label.phone') ?></label>\n-                                <div class=\"span6\">\n+                                <label class=\" control-label\"><?php echo $tpl->__('label.phone') ?></label>\n+                                <div class=\"\">\n                                     <input\n                                             type=\"text\" name=\"phone\" id=\"phone\"\n                                             value=\"<?php $tpl->e($values['phone']); ?>\" />\n@@ -125,7 +125,7 @@\n \n                         <div class=\"col-md-6\">\n                             <h4 class=\"widgettitle title-light\"><span class=\"fa fa-users\"></span> <?php echo $tpl->__('subtitles.users_assigned_to_this_client') ?></h4>\n-\n+                            <a href=\"#/users/newUser?preSelectedClient=<?=$values['id'] ?>\" class=\"btn btn-primary\"><i class='fa fa-plus'></i> <?=$tpl->__('buttons.add_user') ?> </a>\n                             <table class='table table-bordered'>\n                                 <colgroup>\n                                     <col class=\"con1\" />"
        },
        {
          "filename": "app/Domain/Comments/Js/commentsController.js",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -20,6 +20,7 @@ leantime.commentsController = (function () {\n \n     var toggleCommentBoxes = function (id) {\n \n+\n         if (id == 0) {\n             jQuery('#mainToggler').hide();\n         } else {"
        },
        {
          "filename": "app/Domain/Comments/Repositories/Comments.php",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -33,7 +33,8 @@ public function getComments($module, $moduleId, $parent = 0, $orderByState = \"0\"\n                     comment.status,\n \t\t\t\t\tuser.firstname,\n \t\t\t\t\tuser.lastname,\n-\t\t\t\t\tuser.profileId\n+\t\t\t\t\tuser.profileId,\n+\t\t\t\t\tuser.modified AS userModified\n \t\t\t\tFROM zp_comment as comment\n \t\t\t\t\tINNER JOIN zp_user as user ON comment.userId = user.id\n \t\t\t\tWHERE moduleId = :moduleId AND module = :module AND commentParent = :parent\n@@ -95,8 +96,16 @@ public function getReplies($id)\n         {\n \n             $sql = \"SELECT\n-\t\t\t\t\tcomment.id, comment.text, comment.date, comment.moduleId, comment.userId, comment.commentParent,\n-\t\t\t\t\tuser.firstname, user.lastname, user.profileId\n+\t\t\t\t\tcomment.id,\n+\t\t\t\t\tcomment.text,\n+\t\t\t\t\tcomment.date,\n+\t\t\t\t\tcomment.moduleId,\n+\t\t\t\t\tcomment.userId,\n+\t\t\t\t\tcomment.commentParent,\n+\t\t\t\t\tuser.firstname,\n+\t\t\t\t\tuser.lastname,\n+\t\t\t\t\tuser.profileId,\n+\t\t\t\t\tuser.modified AS userModified\n \t\t\t\tFROM zp_comment as comment\n \t\t\t\tINNER JOIN zp_user as user ON comment.userId = user.id\n \t\t\t\tWHERE commentParent = :id\";"
        },
        {
          "filename": "app/Domain/Comments/Templates/components/input.blade.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n <div class=\"commentBox tw-hidden\" id=\"comment{!! $commentId !!}\">\n     <div class=\"commentImage\">\n-        <x-Users::profile-image :userId=\"$userId\" />\n+        <x-users::profile-image :user=\"$user\" />\n     </div>\n     <div class=\"commentReply\">\n         <input"
        },
        {
          "filename": "app/Domain/Comments/Templates/components/reply.blade.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n <div id=\"#{{ $comment['id'] }}\">\n     <div class=\"commentImage\">\n-        <x-Users::profile-image :userId=\"$comment['userId']\" />\n+        <x-Users::profile-image :user=\"array('id'=> $comment['userId'], 'modified' => $comment['userModified'])\" />\n     </div>\n     <div class=\"commentMain\">\n         <div class=\"commentContent\">"
        },
        {
          "filename": "app/Domain/Comments/Templates/showAll.tpl.php",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -26,7 +26,6 @@ class=\"fa fa-plus-square\"></span> <?php echo $tpl->__('links.add_new_comment') ?\n     </a>\n \n     <div id=\"comment0\" class=\"commentBox\">\n-        <!--<img src=\"<?= BASE_URL ?>/api/users?profileImage=currentUser\" style=\"float:left; width:50px; margin-right:10px; padding:2px;\"/>-->\n         <textarea rows=\"5\" cols=\"50\" class=\"tinymceSimple\"\n                   name=\"text\"></textarea><br/>\n         <input type=\"submit\" value=\"<?php echo $tpl->__('buttons.save') ?>\"\n@@ -42,7 +41,7 @@ class=\"fa fa-plus-square\"></span> <?php echo $tpl->__('links.add_new_comment') ?\n         <div>\n             <?php foreach ($tpl->get('comments') as $row) : ?>\n                 <div style=\"display:block; padding:10px; margin-top:10px; border-bottom:1px solid #f0f0f0;\">\n-                    <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $row['userId'] ?>\"\n+                    <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $row['userId'] ?>&v=<?=strtotime($row['userModified']) ?>\"\n                          style=\"float:left; width:50px; margin-right:10px; padding:2px;\"/>\n                     <div class=\"right\"><?php printf(\n                         $tpl->__('text.written_on'),\n@@ -81,7 +80,7 @@ class=\"commentBox\">\n                 <?php if ($comments->getReplies($row['id'])) : ?>\n                     <?php foreach ($comments->getReplies($row['id']) as $comment) : ?>\n                         <div style=\"display:block; padding:10px; padding-left: 60px; border-bottom:1px solid #f0f0f0;\">\n-                            <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $comment['userId'] ?>\"\n+                            <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $comment['userId'] ?>&v=<?= $comment['userModified'] ?>\"\n                                  style=\"float:left; width:50px; margin-right:10px; padding:2px;\"/>\n                             <div>\n                                 <div class=\"right\">"
        },
        {
          "filename": "app/Domain/Comments/Templates/submodules/generalComment.sub.php",
          "status": "modified",
          "additions": 26,
          "deletions": 25,
          "patch": "@@ -4,6 +4,7 @@\n }\n $comments = app()->make(Leantime\\Domain\\Comments\\Repositories\\Comments::class);\n $formUrl = CURRENT_URL;\n+$formHash = md5($formUrl);\n \n //Controller may not redirect. Make sure delComment is only added once\n if (strpos($formUrl, '?delComment=') !== false) {\n@@ -14,40 +15,40 @@\n }\n ?>\n \n-<form method=\"post\" accept-charset=\"utf-8\" action=\"<?php echo $formUrl ?>\" id=\"commentForm\" class=\"formModal\">\n+<form method=\"post\" accept-charset=\"utf-8\" action=\"<?php echo $formUrl ?>\" id=\"commentForm-<?=$formHash ?>\" class=\"formModal\">\n \n     <?php if ($login::userIsAtLeast($roles::$commenter)) { ?>\n-        <div class=\"\" id=\"mainToggler\">\n+        <div class=\"mainToggler-<?=$formHash ?>\" id=\"\">\n             <div class=\"commentImage\">\n-                <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$_SESSION['userdata']['id']?>\" />\n+                <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$_SESSION['userdata']['id'] ?>&v=<?= strtotime($_SESSION['userdata']['modified']?? '0') ?>\" />\n             </div>\n             <div class=\"commentReply\" style=\"border:1px solid var(--main-border-color); padding:15px; border-radius:var(--box-radius); margin-bottom:10px;\">\n-                <a href=\"javascript:void(0);\" onclick=\"toggleCommentBoxes(0)\">\n+                <a href=\"javascript:void(0);\" onclick=\"toggleCommentBoxes(0, '<?=$formHash?>')\">\n                     <?php echo $tpl->__('links.add_new_comment') ?>\n                 </a>\n             </div>\n         </div>\n \n-        <div id=\"comment0\" class=\"commentBox\" style=\"display:none;\">\n+        <div id=\"comment-<?=$formHash ?>-0\" class=\"commentBox-<?=$formHash ?>\" style=\"display:none;\">\n             <div class=\"commentImage\">\n-                <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$_SESSION['userdata']['id']?>\" />\n+                <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$_SESSION['userdata']['id']?>&v=<?= strtotime($_SESSION['userdata']['modified']?? '0') ?>\" />\n             </div>\n             <div class=\"commentReply\">\n                 <textarea rows=\"5\" cols=\"50\" class=\"tinymceSimple\" name=\"text\"></textarea>\n                 <input type=\"submit\" value=\"<?php echo $tpl->__('buttons.save') ?>\" name=\"comment\" class=\"btn btn-primary btn-success\" style=\"margin-left: 0px;\"/>\n             </div>\n             <input type=\"hidden\" name=\"comment\" value=\"1\"/>\n-            <input type=\"hidden\" name=\"father\" id=\"father\" value=\"0\"/>\n+            <input type=\"hidden\" name=\"father\" id=\"father-<?=$formHash ?>\" value=\"0\"/>\n             <br/>\n         </div>\n     <?php } ?>\n \n-    <div id=\"comments\">\n+    <div id=\"comments-<?=$formHash ?>\">\n         <div>\n             <?php foreach ($tpl->get('comments') as $row) : ?>\n                 <div class=\"clearall\">\n                     <div class=\"commentImage\">\n-                        <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $row['userId'] ?>\"/>\n+                        <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $row['userId'] ?>&v=<?= strtotime($row['userModified'] ?? '0') ?>\"/>\n                     </div>\n                     <div class=\"commentMain\">\n                         <div class=\"commentContent\">\n@@ -65,7 +66,7 @@\n \n                                             <ul class=\"dropdown-menu\">\n                                                 <?php if (($row['userId'] == $_SESSION['userdata']['id']) || $login::userIsAtLeast($roles::$manager)) { ?>\n-                                                    <li><a href=\"<?php echo $deleteUrlBase . $row['id'] ?>\" class=\"deleteComment\">\n+                                                    <li><a href=\"<?php echo $deleteUrlBase . $row['id'] ?>\" class=\"deleteComment formModal\">\n                                                         <span class=\"fa fa-trash\"></span> <?php echo $tpl->__('links.delete') ?>\n                                                     </a></li>\n                                                 <?php } ?>\n@@ -78,7 +79,7 @@\n                                     <?php } ?>\n                             </div>\n                             <span class=\"name\"><?php printf($tpl->__('text.full_name'), $tpl->escape($row['firstname']), $tpl->escape($row['lastname'])); ?></span>\n-                            <div class=\"text mce-content-body\" id=\"commentText-<?=$row['id']?>\">\n+                            <div class=\"text mce-content-body\" id=\"commentText-<?=$formHash ?>-<?=$row['id']?>\">\n                                 <?php echo $tpl->escapeMinimal($row['text']); ?>\n                             </div>\n \n@@ -88,7 +89,7 @@\n                         <div class=\"commentLinks\">\n                             <?php if ($login::userIsAtLeast($roles::$commenter)) { ?>\n                                 <a href=\"javascript:void(0);\"\n-                                   onclick=\"toggleCommentBoxes(<?php echo $row['id']; ?>)\">\n+                                   onclick=\"toggleCommentBoxes(<?php echo $row['id']; ?>, '<?=$formHash ?>')\">\n                                     <span class=\"fa fa-reply\"></span> <?php echo $tpl->__('links.reply') ?>\n                                 </a>\n                             <?php } ?>\n@@ -99,7 +100,7 @@\n                                 <?php foreach ($comments->getReplies($row['id']) as $comment) : ?>\n                                     <div>\n                                         <div class=\"commentImage\">\n-                                            <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $comment['userId'] ?>\"/>\n+                                            <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $comment['userId'] ?>&v=<?=strtotime($comment['userModified'] ?? '0') ?>\"/>\n                                         </div>\n                                         <div class=\"commentMain\">\n                                             <div class=\"commentContent\">\n@@ -117,12 +118,12 @@\n                                             <div class=\"commentLinks\">\n                                                 <?php if ($login::userIsAtLeast($roles::$commenter)) { ?>\n                                                     <a href=\"javascript:void(0);\"\n-                                                       onclick=\"toggleCommentBoxes(<?php echo $row['id']; ?>)\">\n+                                                       onclick=\"toggleCommentBoxes(<?php echo $row['id']; ?>, '<?=$formHash ?>')\">\n                                                         <span class=\"fa fa-reply\"></span> <?php echo $tpl->__('links.reply') ?>\n                                                     </a>\n                                                     <?php if ($comment['userId'] == $_SESSION['userdata']['id']) { ?>\n                                                         <a href=\"<?php echo $deleteUrlBase . $comment['id'] ?>\"\n-                                                           class=\"deleteComment\">\n+                                                           class=\"deleteComment formModal\">\n                                                             <span class=\"fa fa-trash\"></span> <?php echo $tpl->__('links.delete') ?>\n                                                         </a>\n                                                     <?php } ?>\n@@ -133,9 +134,9 @@ class=\"deleteComment\">\n                                     </div>\n                                 <?php endforeach; ?>\n                             <?php endif; ?>\n-                            <div style=\"display:none;\" id=\"comment<?php echo $row['id']; ?>\" class=\"commentBox\">\n+                            <div style=\"display:none;\" id=\"comment-<?=$formHash?>-<?php echo $row['id']; ?>\" class=\"commentBox\">\n                                 <div class=\"commentImage\">\n-                                    <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $_SESSION['userdata']['id'] ?>\"/>\n+                                    <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?= $_SESSION['userdata']['id'] ?>&v=<?= strtotime($_SESSION['userdata']['modified']?? '0') ?>\"/>\n                                 </div>\n                                 <div class=\"commentReply\">\n                                     <input type=\"submit\" value=\"<?php echo $tpl->__('links.reply') ?>\" name=\"comment\" class=\"btn btn-primary\"/>\n@@ -161,23 +162,23 @@ class=\"deleteComment\">\n \n     leantime.editorController.initSimpleEditor();\n \n-    function toggleCommentBoxes(id) {\n+    function toggleCommentBoxes(id, formHash) {\n \n         <?php if ($login::userIsAtLeast($roles::$commenter)) { ?>\n             if (id == 0) {\n-                jQuery('#mainToggler').hide();\n+                jQuery('.mainToggler-'+formHash).hide();\n             } else {\n-                jQuery('#mainToggler').show();\n+                jQuery('.mainToggler-'+formHash).show();\n             }\n-            jQuery('.commentBox textarea').remove();\n+            jQuery('.commentBox-'+formHash+' textarea').remove();\n \n-            jQuery('.commentBox').hide();\n+            jQuery('.commentBox-'+formHash+'').hide();\n \n-            jQuery('#comment' + id + ' .commentReply').prepend('<textarea rows=\"5\" cols=\"75\" name=\"text\" class=\"tinymceSimple\"></textarea>');\n+            jQuery('#comment-'+formHash+'-' + id + ' .commentReply').prepend('<textarea rows=\"5\" cols=\"75\" name=\"text\" class=\"tinymceSimple\"></textarea>');\n             leantime.editorController.initSimpleEditor();\n \n-            jQuery('#comment' + id + '').show();\n-            jQuery('#father').val(id);\n+            jQuery('#comment-'+formHash+'-' + id + '').show();\n+            jQuery('#father-'+formHash).val(id);\n \n         <?php } ?>\n     }"
        },
        {
          "filename": "app/Domain/Dashboard/Templates/home.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -342,7 +342,7 @@\n                                                 <div class=\"col-md-8\">\n                                                     <a href=\"<?=BASE_URL?>/dashboard/show?projectId=<?=$project['id']?>\">\n                                                         <span class=\"projectAvatar\">\n-                                                            <img src=\"<?=BASE_URL?>/api/projects?projectAvatar=<?=$project['id']?>\" />\n+                                                            <img src=\"<?=BASE_URL?>/api/projects?projectAvatar=<?=$project['id']?>&v=<?=strtotime($project['modified'] ?? '0') ?>\" />\n                                                         </span>\n                                                         <small><?php $tpl->e($project['clientName'])?></small><br />\n                                                         <strong><?php $tpl->e($project['name'])?></strong>"
        },
        {
          "filename": "app/Domain/Dashboard/Templates/show.blade.php",
          "status": "modified",
          "additions": 3,
          "deletions": 69,
          "patch": "@@ -83,7 +83,7 @@ class=\"btn pull-right margin-right {{ $isFavorite ? 'isFavorite' : ''}} tw-mr-[5\n                             <div class=\"ticketBox fixed priority-border-{!! $row['priority'] !!}\" data-val=\"{!! $row['id'] !!}\">\n                                 <div class=\"row\">\n                                     <div class=\"col-md-12 timerContainer tw-py-[5px] tw-px-[15px]\" id=\"timerContainer-{!! $row['id'] !!}\">\n-                                        <a href=\"{{ BASE_URL }}/#/tickets/showTicket/{!! $row['dependingTicketId'] > 0 ? $row['dependingTicketId'] : $row['id'] !!}\">\n+                                        <a href=\"#/tickets/showTicket/{!! $row['dependingTicketId'] > 0 ? $row['dependingTicketId'] : $row['id'] !!}\">\n                                             {!! $row['dependingTicketId'] > 0 ? $row['parentHeadline'] : sprintf(\"<strong>%s</strong>\", $row['headline']) !!}\n                                         </a>\n \n@@ -214,13 +214,7 @@ class=\"{!! $label['class'] !!}\"\n             </div>\n \n             <div class=\"maincontentinner\">\n-                @if ($login::userIsAtLeast($roles::$manager))\n-                    <div class=\"pull-right\">\n-                        <a class=\"titleInsertLink\" href=\"{{ BASE_URL }}/projects/showProject/{!! $project['id'] !!}#team\">\n-                            <i class=\"fa fa-users\"></i> {{ __('links.manage_team') }}\n-                        </a>\n-                    </div>\n-                @endif\n+                @dispatchEvent('teamBoxBeginning', ['project' => $project])\n \n                 <h5 class=\"subtitle\">{{ __('tabs.team') }}</h5>\n \n@@ -387,7 +381,7 @@ class=\"tw-leading-[50px]\"\n                                                     <x-comments::reply :comment=\"$comment\" :iteration=\"$loop->iteration\" />\n                                                 @endforeach\n                                             @endif\n-                                            <x-comments::input :commentId=\"$row['id']\" :userId=\"$_SESSION['userdata']['id']\" />\n+                                            <x-comments::input :commentId=\"$row['id']\" :user=\"$_SESSION['userdata']\" />\n                                         </div>\n                                     </div>\n                                 </div>\n@@ -520,66 +514,6 @@ class=\"progress-bar progress-bar-success\"\n             }\n         });\n \n-        /** Deprecated by HTMX\n-        jQuery('.progressWrapper .dropdown-menu li input').change(function (e) {\n-            if (jQuery(this).parent().hasClass('done')) {\n-                jQuery(this).parent().removeClass('done');\n-            } else {\n-                jQuery(this).parent().addClass('done');\n-            }\n-\n-            jQuery.ajax({\n-                type : 'PATCH',\n-                url  : leantime.appUrl + '/api/projects',\n-                data : {\n-                    patchProjectProgress : \"true\",\n-                    values   : jQuery(\"form#progressForm\").serialize()\n-                }\n-            });\n-\n-            var stepCount = 1;\n-            var totalSteps = jQuery(\".progressWrapper .step\").length;\n-            var stepsComplete = 1;\n-            var foundCurrent = false;\n-            jQuery(\".progressWrapper .step\").each(function(){\n-\n-                var tasksComplete = true;\n-                jQuery(this).find(\"ul li\").each(function() {\n-                    var inputChecked = jQuery(this).find(\"input\").attr(\"checked\");\n-                    if (typeof inputChecked === typeof undefined || inputChecked === false) {\n-                        tasksComplete = false;\n-                    }\n-                });\n-\n-                if (tasksComplete) {\n-                    jQuery(this).addClass(\"complete\");\n-                    stepsComplete++;\n-                    jQuery(this).removeClass(\"current\");\n-                    if(jQuery(this).find(\".title .fa-check\").length == 0) {\n-                        jQuery(this).find(\".title\").prepend('<i class=\"fa fa-check\"></i>');\n-                    }\n-                } else {\n-                    //Only do that for the first one that is incomplete\n-                    if (foundCurrent === false) {\n-                        jQuery(this).removeClass(\"complete\");\n-                        jQuery(this).addClass(\"current\");\n-                        foundCurrent = true;\n-                    }\n-\n-                    if (jQuery(this).find(\".title .fa-check\").length == 1) {\n-                        jQuery(this).find(\".title .fa-check\").remove();\n-                    }\n-                }\n-\n-                stepCount++;\n-            });\n-\n-            var halfSteps =  1/totalSteps/2 *100;\n-            var percentComplete = stepsComplete / totalSteps * 100 - halfSteps;\n-            jQuery(\".projectSteps .progress .progress-bar\").css(\"width\", percentComplete+\"%\");\n-        });\n-        **/\n-\n         jQuery(document).on('click', '.progressWrapper .dropdown-menu', function (e) {\n             e.stopPropagation();\n         });"
        },
        {
          "filename": "app/Domain/Files/Repositories/Files.php",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -170,7 +170,7 @@ public function getFilesByModule($module = '', $moduleId = null, $userId = 0)\n             }\n \n             if ($userId && $userId > 0) {\n-                $sql .= \" AND userId=\" . $userId;\n+                $sql .= \" AND userId= :userId\";\n             }\n \n             $stmn = $this->db->database->prepare($sql);\n@@ -182,6 +182,11 @@ public function getFilesByModule($module = '', $moduleId = null, $userId = 0)\n                 $stmn->bindValue(':moduleId', $moduleId, PDO::PARAM_INT);\n             }\n \n+            if ($userId && $userId > 0) {\n+                $stmn->bindValue(':userId', $userId, PDO::PARAM_INT);\n+\n+            }\n+\n             $stmn->execute();\n             $values = $stmn->fetchAll();\n             $stmn->closeCursor();"
        },
        {
          "filename": "app/Domain/Help/Controllers/FirstLogin.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -96,7 +96,7 @@ public function post($params)\n                                 $userId = $userService->createUserInvite($values);\n                                 $projectsRepo->editUserProjectRelations($userId, array($_SESSION['currentProject']));\n \n-                                $this->tpl->setNotification(\"notification.user_invited_successfully\", 'success');\n+                                $this->tpl->setNotification(\"notification.user_invited_successfully\", 'success', 'user_invited_' . $i);\n                             }\n                         }\n                     }"
        },
        {
          "filename": "app/Domain/Help/Templates/firstLoginDialog.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -113,7 +113,7 @@\n \n     function skipOnboarding() {\n \n-        jQuery(\"form.step1 #projectName\").val('<?=$_SESSION[\"currentProjectName\"] ?>');\n+        jQuery(\"form.step1 #projectName\").val('<?=$_SESSION[\"currentProjectName\"] ?? '' ?>');\n         jQuery(\"form.step1\").submit();\n         jQuery.nmTop().close();\n "
        },
        {
          "filename": "app/Domain/Ideas/Repositories/Ideas.php",
          "status": "modified",
          "additions": 0,
          "deletions": 4,
          "patch": "@@ -53,10 +53,6 @@ public function __construct(DbCore $db, LanguageCore $language)\n \n         public function getCanvasLabels()\n         {\n-\n-            //Todo: Remove!\n-            unset($_SESSION[\"projectsettings\"][\"idealabels\"]);\n-\n             if (isset($_SESSION[\"projectsettings\"][\"idealabels\"])) {\n                 return $_SESSION[\"projectsettings\"][\"idealabels\"];\n             } else {"
        },
        {
          "filename": "app/Domain/Install/Controllers/Update.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -41,7 +41,8 @@ public function get($params)\n                 FrontcontrollerCore::redirect(BASE_URL . \"/auth/login\");\n             }\n \n-            $this->tpl->display(\"install.update\", \"entry\");\n+            $updatePage = self::dispatch_filter('customUpdatePage', 'install.update');\n+            $this->tpl->display($updatePage, \"entry\");\n         }\n \n         public function post($params)"
        },
        {
          "filename": "app/Domain/Install/Repositories/Install.php",
          "status": "modified",
          "additions": 36,
          "deletions": 2,
          "patch": "@@ -89,6 +89,7 @@ class Install\n             20118,\n             20120,\n             20121,\n+            20122,\n         );\n \n         /**\n@@ -618,6 +619,7 @@ private function sqlPrep()\n                   `jobTitle` VARCHAR(200) NULL,\n                   `jobLevel` VARCHAR(50) NULL,\n                   `department` VARCHAR(200) NULL,\n+                  `modified` DATETIME DEFAULT NULL,\n                   PRIMARY KEY (`id`),\n                   UNIQUE KEY `username` (`username`)\n                 ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n@@ -729,12 +731,12 @@ private function sqlPrep()\n                     `authors`)\n                     VALUES\n                     (\n-                    'leantime/motivationalquotes',\n+                    'leantime/MotivationalQuotes',\n                     1,\n                     'Displays a random quote on the welcome page',\n                     '0.1',\n                     '2023-07-20 00:00:00',\n-                    'motivationalQuotes',\n+                    'MotivationalQuotes',\n                     'https://leantime.io',\n                     '[{\\\"name\\\":\\\"Leantime\\\",\\\"email\\\":\\\"support@leantime.io\\\"}]');\n \n@@ -1593,6 +1595,38 @@ public function update_sql_20121(): bool|array\n                 return true;\n             }\n         }\n+\n+        public function update_sql_20122(): bool|array\n+        {\n+\n+            $errors = array();\n+\n+            $sql = [\n+                \"ALTER TABLE `zp_settings`\n+                    CHANGE COLUMN `value` `value` MEDIUMTEXT NULL DEFAULT NULL ;\",\n+                \"ALTER TABLE `zp_canvas_items`\n+                    CHANGE COLUMN `description` `description` MEDIUMTEXT NULL DEFAULT NULL ,\n+                    CHANGE COLUMN `data` `data` MEDIUMTEXT NULL DEFAULT NULL;\",\n+                \"ALTER TABLE `zp_user`\n+                    ADD COLUMN `modified` DATETIME NULL DEFAULT NULL;\"\n+\n+            ];\n+\n+            foreach ($sql as $statement) {\n+                try {\n+                    $stmn = $this->database->prepare($statement);\n+                    $stmn->execute();\n+                } catch (PDOException $e) {\n+                    array_push($errors, $statement . \" Failed:\" . $e->getMessage());\n+                }\n+            }\n+\n+            if (count($errors) > 0) {\n+                return $errors;\n+            } else {\n+                return true;\n+            }\n+        }\n     }\n \n }"
        },
        {
          "filename": "app/Domain/Ldap/Services/Ldap.php",
          "status": "modified",
          "additions": 8,
          "deletions": 6,
          "patch": "@@ -20,7 +20,10 @@ class Ldap\n         \"email\" => \"mail\",\n         \"firstname\" => \"displayname\",\n         \"lastname\" => '',\n-        \"phonenumber\" => 'telephonenumber',\n+        \"phone\" => 'telephonenumber',\n+        \"jobTitle\" => \"title\",\n+        \"jobLevel\" => \"level\",\n+        \"department\" => \"department\"\n     );\n     private $ldapLtGroupAssignments = array();\n     private $settingsRepo;\n@@ -185,8 +188,7 @@ public function getSingleUser($username)\n \n         $filter = \"(\" . $this->ldapKeys->username . \"=\" . $this->extractLdapFromUsername($username) . \")\";\n \n-        $attr = array($this->ldapKeys->groups, $this->ldapKeys->firstname, $this->ldapKeys->lastname, $this->ldapKeys->email, $this->ldapKeys->phone, $this->ldapKeys->jobTitle, $this->ldapKeys->jobLevel, $this->ldapKeys->department);\n-//        $attr = array($this->ldapKeys->groups, $this->ldapKeys->firstname, $this->ldapKeys->lastname, $this->ldapKeys->email, $this->ldapKeys->phonenumber);\n+        $attr = array($this->ldapKeys->groups, $this->ldapKeys->firstname, $this->ldapKeys->lastname, $this->ldapKeys->email, $this->ldapKeys->phone);\n \n         $result = ldap_search($this->ldapConnection, $this->ldapDn, $filter, $attr) or exit(\"Unable to search LDAP server\");\n         $entries = ldap_get_entries($this->ldapConnection, $result);\n@@ -215,7 +217,7 @@ public function getSingleUser($username)\n         //Find Firstname & Lastname\n         $firstname = isset($entries[0][$this->ldapKeys->firstname]) ? $entries[0][$this->ldapKeys->firstname][0] : '';\n         $lastname = isset($entries[0][$this->ldapKeys->lastname]) ? $entries[0][$this->ldapKeys->lastname][0] : '';\n-        $phonenumber = isset($entries[0][$this->ldapKeys->phone]) ? $entries[0][$this->ldapKeys->phone][0] : '';\n+        $phone = isset($entries[0][$this->ldapKeys->phone]) ? $entries[0][$this->ldapKeys->phone][0] : '';\n         $uname = isset($entries[0][$this->ldapKeys->email]) ? $entries[0][$this->ldapKeys->email][0] : '';\n         $jobTitle = isset($entries[0][$this->ldapKeys->jobTitle]) ? $entries[0][$this->ldapKeys->jobTitle][0] : '';\n         $jobLevel = isset($entries[0][$this->ldapKeys->jobLevel]) ? $entries[0][$this->ldapKeys->jobLevel][0] : '';\n@@ -227,7 +229,7 @@ public function getSingleUser($username)\n             error_log(\"LEANTIME: >>>Attributes Begin>>>>>>\\n\");\n             error_log(\"LEANTIME: fn $firstname\", 0);\n             error_log(\"LEANTIME: sn $lastname\", 0);\n-            error_log(\"LEANTIME: phone $phonenumber\", 0);\n+            error_log(\"LEANTIME: phone $phone\", 0);\n             error_log(\"LEANTIME: role $role\", 0);\n             error_log(\"LEANTIME: username $uname \", 0);\n             error_log(\"LEANTIME: jobTitle $jobTitle \", 0);\n@@ -241,7 +243,7 @@ public function getSingleUser($username)\n             \"firstname\" => $firstname,\n             \"lastname\" => $lastname,\n             \"role\" => $role,\n-            \"phone\" => $phonenumber,\n+            \"phone\" => $phone,\n             \"jobTitle\" => $jobTitle,\n             \"jobLevel\" => $jobLevel,\n             \"department\" => $department,"
        },
        {
          "filename": "app/Domain/Menu/Composers/Menu.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -69,6 +69,7 @@ public function with()\n             $recentProjects  = $projectVars['recentProjects'];\n             $favoriteProjects = $projectVars['favoriteProjects'];\n             $clients = $projectVars['clients'];\n+            $currentProject = $projectVars['currentProject'];\n \n         }\n \n@@ -90,7 +91,7 @@ public function with()\n             'allAvailableProjectsHierarchy' => $allAvailableProjectsHierarchy,\n             'projectHierarchy' => $allAssignedprojectsHierarchy,\n             'recentProjects' => $recentProjects,\n-            'currentProject' => $_SESSION['currentProject'] ?? null,\n+            'currentProject' => $currentProject,\n             'menuStructure' => $this->menuRepo->getMenuStructure($menuType) ?? [],\n             'settingsLink' => [\n                 'label' => __('menu.project_settings'),\n@@ -104,7 +105,7 @@ public function with()\n             'favoriteProjects' => $favoriteProjects,\n             'projectSelectGroupOptions' => $projectSelectGroupOptions,\n             'projectSelectFilter' => $projectSelectFilter,\n-            'clients' => $clients,\n+            'clients' => $clients\n         ];\n     }\n }"
        },
        {
          "filename": "app/Domain/Menu/Services/Menu.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -108,6 +108,7 @@ public function getUserProjectList(int $userId): array\n \n \n         $projectType = \"project\";\n+        $project = [];\n         if (isset($_SESSION['currentProject'])) {\n             $project = $this->projectService->getProject($_SESSION['currentProject']);\n \n@@ -142,6 +143,7 @@ public function getUserProjectList(int $userId): array\n             \"projectType\" => $projectType,\n             \"favoriteProjects\" => $favoriteProjects,\n             \"clients\" => $clients,\n+            \"currentProject\" => $project,\n \n         ];\n     }"
        },
        {
          "filename": "app/Domain/Menu/Templates/headMenu.blade.php",
          "status": "modified",
          "additions": 21,
          "deletions": 50,
          "patch": "@@ -24,8 +24,18 @@ class=\"active\"\n             @if ($activePath == 'projects.showMy')\n                 class=\"active\"\n             @endif\n-            data-tippy-content=\"{{ __('popover.my_portfolio') }}\"\n-        >{!! __(\"menu.my_portfolio\") !!}</a>\n+            data-tippy-content=\"{{ __('popover.my_projects') }}\"\n+        >{!! __(\"menu.my_projects\") !!}</a>\n+    </li>\n+\n+    <li>\n+        <a\n+            href='{{ BASE_URL }}/timesheets/showMy'\n+            @if ($activePath == 'timesheets.showMy')\n+                class=\"active\"\n+            @endif\n+            data-tippy-content=\"{{ __('popover.my_timesheets') }}\"\n+        >{!! __(\"menu.my_timesheets\") !!}</a>\n     </li>\n \n     </li>\n@@ -83,8 +93,8 @@ class='new'\n                                 <span class=\"notificationProfileImage\">\n                                     <img src=\"{{ BASE_URL }}/api/users?profileImage={{ $notif['authorId'] }}\"/>\n                                 </span>\n-                                <span class=\"notificationTitle\">{{ $notif['message'] }}</span>\n-                                <span class=\"notificationDate\">@formatDate($notif['datetime'])</span>\n+                                <span class=\"notificationTitle\">{!! $notif['message'] !!}</span>\n+                                <span class=\"notificationDate\"> @formatDate( $notif['datetime'] ) </span>\n                             </a>\n                         </li>\n                     @endforeach\n@@ -111,8 +121,11 @@ class='new'\n                                 <span class=\"notificationProfileImage\">\n                                     <img src=\"{{ BASE_URL }}/api/users?profileImage={{ $notif['authorId'] }}\"/>\n                                 </span>\n-                                <span class=\"notificationTitle\">{{ $notif['message'] }}</span>\n-                                <span class=\"notificationDate\">@formatDate($notif['datetime']) @formatTime($notif['datetime'])</span>\n+                                <span class=\"notificationTitle\">{!! $notif['message'] !!}</span>\n+                                <span class=\"notificationDate\">\n+                                    @formatDate($notif['datetime'])\n+                                    @formatTime($notif['datetime'])\n+                                </span>\n                             </a>\n                         </li>\n                     @endforeach\n@@ -123,7 +136,7 @@ class='new'\n \n     </li>\n \n-    @if ($login::userIsAtLeast(Roles::$manager))\n+    @if ($login::userIsAtLeast(\"manager\"))\n \n         <li class=\"appsDropdown\">\n \n@@ -198,50 +211,8 @@ class=\"active\"\n     <li>\n         <div class=\"userloggedinfo\">\n \n-            @dispatchEvent('beforeUserinfoMenuOpen')\n-\n-            <div class=\"userinfo\">\n-\n-                @dispatchEvent('afterUserinfoMenuOpen')\n-\n-                <a\n-                    href=\"{{ BASE_URL }}/users/editOwn\"\n-                    class=\"dropdown-toggle profileHandler\"\n-                    data-toggle=\"dropdown\"\n-                >\n-                    <img src=\"{{ BASE_URL }}/api/users?profileImage={{ $user['id'] }}\" class=\"profilePicture\"/>\n-                    <i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i>\n-                </a>\n-\n-                <ul class=\"dropdown-menu\">\n+            @include(\"auth::partials.loginInfo\")\n \n-                    @dispatchEvent('afterUserinfoMenuOpen')\n-\n-                    <li><a href=\"{{ BASE_URL }}/users/editOwn/\">\n-                            {!! __('menu.my_profile') !!}\n-                        </a></li>\n-\n-                    <li class=\"nav-header border\">{{ __('menu.help_support') }}</li>\n-\n-                    <li><a\n-                            href=\"javascript:void(0);\"\n-                            onclick=\"leantime.helperController.showHelperModal('{{ __($modal) }}', 300, 500)\"\n-                        >{!! __('menu.what_is_this_page') !!}</a></li>\n-\n-                    <li><a href=\"https://docs.leantime.io\" target=\"_blank\">{!! __('menu.knowledge_base') !!}</a></li>\n-\n-                    <li><a href=\"https://community.leantime.io\" target=\"_blank\">{!! __('menu.community') !!}</a></li>\n-\n-                    <li><a href=\"https://leantime.io/contact-us\" target=\"_blank\">{!! __('menu.contact_us') !!}</a></li>\n-\n-                    <li class=\"border\"><a href=\"{{ BASE_URL }}/auth/logout\">{!! __('menu.sign_out') !!}</a></li>\n-\n-                    @dispatchEvent('beforeUserinfoDropdownMenuClose')\n-                </ul>\n-\n-                @dispatchEvent('beforeUserinfoMenuClose')\n-\n-            </div>\n         </div>\n \n         @dispatchEvent('afterUser')"
        },
        {
          "filename": "app/Domain/Menu/Templates/menu.blade.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -29,10 +29,10 @@ class=\"dropdown-toggle bigProjectSelector\"\n                         @if(isset($projectTypeAvatars[$currentProjectType]) && $projectTypeAvatars[$currentProjectType] != \"avatar\")\n                             <span class=\"{{ $projectTypeAvatars[$currentProjectType] }}\"></span>\n                         @else\n-                            <img src=\"{{ BASE_URL }}/api/projects?projectAvatar={{ $_SESSION['currentProject'] }}\"/>\n+                            <img src=\"{{ BASE_URL }}/api/projects?projectAvatar={{ $currentProject['id'] }}&v={{ strtotime($currentProject['modified'] ?? '0') }}\"/>\n                         @endif\n                     </span>\n-                    {{ $_SESSION['currentProjectName'] }}&nbsp;<i class=\"fa fa-angle-right\"></i>\n+                    {{ $currentProject['name'] }}&nbsp;<i class=\"fa fa-angle-right\"></i>\n                 </a>\n                 @include('menu::partials.projectSelector', [])\n             </li>"
        },
        {
          "filename": "app/Domain/Menu/Templates/partials/projectLink.blade.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@\n         @if(isset($projectTypeAvatars[$project[\"type\"]]) && $projectTypeAvatars[$project[\"type\"]] != \"avatar\")\n             <span class=\"{{ $projectTypeAvatars[$project[\"type\"]] }}\"></span>\n         @else\n-            <img src='{{ BASE_URL }}/api/projects?projectAvatar={{ $project[\"id\"] }}' />\n+            <img src='{{ BASE_URL }}/api/projects?projectAvatar={{ $project[\"id\"] }}&v={{  strtotime($project['modified'] ?? '0') }}' />\n         @endif\n     </span>\n     <span class='projectName'>"
        },
        {
          "filename": "app/Domain/Menu/Templates/partials/projectSelector.blade.php",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -65,6 +65,15 @@\n             </ul>\n         </div>\n     </div>\n+    @if ($login::userIsAtLeast(\"manager\"))\n+        <div class=\"projectSelectorFooter\">\n+            <ul class=\"selectorList projectList\">\n+                @dispatchEvent('beforeProjectCreateLink')\n+                <li><a href=\"{{ BASE_URL }}/projects/newProject\">{!! __('menu.create_project') !!}</a></li>\n+                @dispatchEvent('afterProjectCreateLink')\n+            </ul>\n+        </div>\n+    @endif\n </div>\n \n <script>"
        },
        {
          "filename": "app/Domain/Oidc/Services/Oidc.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -34,10 +34,11 @@ class Oidc\n     private string $fieldEmail = '';\n     private string $fieldFirstName = '';\n     private string $fieldLastName = '';\n+    private Language $language;\n \n     public function __construct(\n-        environment $config,\n-        language $language,\n+        Environment $config,\n+        Language $language,\n         AuthService $authService,\n         UserRepository $userRepo\n     ) {"
        },
        {
          "filename": "app/Domain/Plugins/Services/Plugins.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -10,7 +10,7 @@\n     class Plugins\n     {\n         private PluginRepository $pluginRepository;\n-        private string $pluginDirectory =  ROOT . \"/../app/plugins/\";\n+        private string $pluginDirectory =  ROOT . \"/../app/Plugins/\";\n         private EnvironmentCore $config;\n \n \n@@ -191,9 +191,9 @@ public function getPluginClassName(PluginModel $plugin)\n         {\n             return app()->getNamespace()\n                 . 'Plugins\\\\'\n-                . htmlspecialchars($plugin->foldername)\n+                . htmlspecialchars(ucfirst($plugin->foldername))\n                 . '\\\\Services\\\\'\n-                . htmlspecialchars($plugin->foldername);\n+                . htmlspecialchars(ucfirst($plugin->foldername));\n         }\n     }\n }"
        },
        {
          "filename": "app/Domain/Projects/Repositories/Projects.php",
          "status": "modified",
          "additions": 49,
          "deletions": 20,
          "patch": "@@ -79,6 +79,8 @@ public function getAll($showClosedProjects = false)\n \t\t\t\t\tproject.dollarBudget,\n \t\t\t\t\tproject.state,\n                     project.menuType,\n+                    project.type,\n+                    project.modified,\n \t\t\t\t\tSUM(case when ticket.type <> 'milestone' AND ticket.type <> 'subtask' then 1 else 0 end) as numberOfTickets,\n \t\t\t\t\tclient.name AS clientName,\n \t\t\t\t\tclient.id AS clientId\n@@ -125,6 +127,7 @@ public function getUsersAssignedToProject($id): array|bool\n \t\t\t\t\tzp_user.notifications,\n \t\t\t\t\tzp_user.profileId,\n                     zp_user.status,\n+                    zp_user.modified,\n                     zp_relationuserproject.projectRole\n \t\t\t\tFROM zp_relationuserproject\n \t\t\t\tLEFT JOIN zp_user ON zp_relationuserproject.userId = zp_user.id\n@@ -149,13 +152,15 @@ public function getUserProjects(int $userId, string $projectStatus = \"all\", int\n             $query = \"SELECT\n \t\t\t\t\tproject.id,\n \t\t\t\t\tproject.name,\n+\t\t\t\t\tproject.details,\n \t\t\t\t\tproject.clientId,\n \t\t\t\t\tproject.state,\n \t\t\t\t\tproject.hourBudget,\n \t\t\t\t\tproject.dollarBudget,\n \t\t\t\t    project.menuType,\n \t\t\t\t    project.type,\n \t\t\t\t    project.parent,\n+\t\t\t\t    project.modified,\n \t\t\t\t\tSUM(case when ticket.type <> 'milestone' then 1 else 0 end) as numberOfTickets,\n \t\t\t\t\tclient.name AS clientName,\n \t\t\t\t\tclient.id AS clientId,\n@@ -256,6 +261,7 @@ public function getProjectsUserHasAccessTo($userId, $status = \"all\", $clientId =\n \t\t\t\t\tproject.dollarBudget,\n \t\t\t\t    project.menuType,\n \t\t\t\t    project.type,\n+\t\t\t\t    project.modified,\n \t\t\t\t\tSUM(case when ticket.type <> 'milestone' then 1 else 0 end) as numberOfTickets,\n \t\t\t\t\tclient.name AS clientName,\n \t\t\t\t\tclient.id AS clientId,\n@@ -349,6 +355,7 @@ public function getClientProjects($clientId)\n \t\t\t\t\tproject.dollarBudget,\n \t\t\t\t\tproject.state,\n \t\t\t\t    project.menuType,\n+\t\t\t\t    project.modified,\n \t\t\t\t\tSUM(case when ticket.type <> 'milestone' AND ticket.type <> 'subtask' then 1 else 0 end) as numberOfTickets,\n \t\t\t\t\tclient.name AS clientName,\n \t\t\t\t\tclient.id AS clientId\n@@ -421,6 +428,7 @@ public function getProject($id): array|bool\n \t\t\t\t    zp_projects.cover,\n \t\t\t\t    zp_projects.type,\n \t\t\t\t    zp_projects.parent,\n+\t\t\t\t    zp_projects.modified,\n \t\t\t\t\tzp_clients.name AS clientName,\n \t\t\t\t\t zp_projects.start,\n \t\t\t\t\t  zp_projects.end,\n@@ -577,21 +585,25 @@ public function addProject($values): int|bool\n                            `type`,\n                            `parent`,\n                            `start`,\n-                           `end`\n-\n-\t\t\t) VALUES (\n-\t\t\t\t:name,\n-\t\t\t\t:details,\n-\t\t\t\t:clientId,\n-\t\t\t\t:hourBudget,\n-\t\t\t\t:dollarBudget,\n-\t\t\t    :psettings,\n-                :menuType,\n-\t\t\t    :type,\n-\t\t\t    :parent,\n-\t\t\t          :start,\n-\t\t\t          :end\n-\t\t\t)\";\n+                           `end`,\n+                           `created`,\n+                           `modified`\n+\n+                        ) VALUES (\n+                            :name,\n+                            :details,\n+                            :clientId,\n+                            :hourBudget,\n+                            :dollarBudget,\n+                            :psettings,\n+                            :menuType,\n+                            :type,\n+                            :parent,\n+                            :start,\n+                            :end,\n+                            :created,\n+                            :modified\n+                        )\";\n \n             $stmn = $this->db->database->prepare($query);\n \n@@ -604,6 +616,8 @@ public function addProject($values): int|bool\n             $stmn->bindValue('menuType', $values['menuType'], PDO::PARAM_STR);\n             $stmn->bindValue('type', $values['type'] ?? 'project', PDO::PARAM_STR);\n             $stmn->bindValue('parent', $values['parent'] ?? null, PDO::PARAM_STR);\n+            $stmn->bindValue('created', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n+            $stmn->bindValue('modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             $startDate = null;\n             if (isset($values['start']) && $values['start'] !== false && $values['start'] != '') {\n@@ -660,7 +674,8 @@ public function editProject(array $values, $id)\n \t\t\t\ttype = :type,\n \t\t\t\tparent = :parent,\n \t\t\t\tstart = :start,\n-\t\t\t\tend = :end\n+\t\t\t\tend = :end,\n+\t\t\t\tmodified = :modified\n \t\t\t\tWHERE id = :id\n \n \t\t\t\tLIMIT 1\";\n@@ -678,6 +693,7 @@ public function editProject(array $values, $id)\n             $stmn->bindValue('type', $values['type'] ?? 'project', PDO::PARAM_STR);\n             $stmn->bindValue('id', $id, PDO::PARAM_STR);\n             $stmn->bindValue('parent', $values['parent'] ?? null, PDO::PARAM_STR);\n+            $stmn->bindValue('modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             $startDate = null;\n             if (isset($values['start']) && $values['start'] !== false && $values['start'] != '') {\n@@ -888,7 +904,8 @@ public function isUserMemberOfProject($userId, $projectId)\n             $query = \"SELECT\n \t\t\t\tzp_relationuserproject.userId,\n \t\t\t\tzp_relationuserproject.projectId,\n-\t\t\t\tzp_projects.name\n+\t\t\t\tzp_projects.name,\n+                zp_projects.modified\n \t\t\tFROM zp_relationuserproject JOIN zp_projects\n \t\t\t\tON zp_relationuserproject.projectId = zp_projects.id\n \t\t\tWHERE userId = :userId AND zp_relationuserproject.projectId = :projectId LIMIT 1\";\n@@ -916,15 +933,18 @@ public function getProjectUserRelation($id)\n \t\t\t\tzp_relationuserproject.projectId,\n \t\t\t\tzp_relationuserproject.projectRole,\n \t\t\t\tzp_projects.name,\n+\t\t\t\tzp_projects.modified,\n \t\t\t\tzp_user.username,\n \t\t\t\tIF(zp_user.firstname <> '', zp_user.firstname, zp_user.username) AS firstname,\n \t\t\t\tzp_user.lastname,\n+\t\t\t\tzp_user.id,\n \t\t\t\tzp_user.jobTitle,\n \t\t\t\tzp_user.jobLevel,\n \t\t\t\tzp_user.department,\n \t\t\t\tzp_user.profileId,\n \t\t\t\tzp_user.role,\n-\t\t\t\tzp_user.status\n+\t\t\t\tzp_user.status,\n+                zp_user.modified\n \t\t\tFROM zp_relationuserproject\n \t\t\t    LEFT JOIN zp_projects ON zp_relationuserproject.projectId = zp_projects.id\n \t\t\t    LEFT JOIN zp_user ON zp_relationuserproject.userId = zp_user.id\n@@ -1070,10 +1090,13 @@ public function patch($id, $params)\n                 $sql .= \"\" . DbCore::sanitizeToColumnString($key) . \"=:\" . DbCore::sanitizeToColumnString($key) . \", \";\n             }\n \n-            $sql .= \"id=:id WHERE id=:id LIMIT 1\";\n+            $sql .= \"modified=:modified \";\n+\n+            $sql .= \" WHERE id=:id LIMIT 1\";\n \n             $stmn = $this->db->database->prepare($sql);\n             $stmn->bindValue(':id', $id, PDO::PARAM_STR);\n+            $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             foreach ($params as $key => $value) {\n                 $stmn->bindValue(':' . DbCore::sanitizeToColumnString($key), $value, PDO::PARAM_STR);\n@@ -1109,11 +1132,17 @@ public function setPicture($_FILE, $id)\n             $lastId = $files->upload($_FILE, 'project', $id, true, 300, 300);\n \n             if (isset($lastId['fileId'])) {\n-                $sql = 'UPDATE `zp_projects` SET avatar = :fileId WHERE id = :userId';\n+                $sql = 'UPDATE\n+                            `zp_projects`\n+                        SET\n+                            avatar = :fileId,\n+                            modified = :modified\n+                        WHERE id = :userId';\n \n                 $stmn = $this->db->database->prepare($sql);\n                 $stmn->bindValue(':fileId', $lastId['fileId'], PDO::PARAM_INT);\n                 $stmn->bindValue(':userId', $id, PDO::PARAM_INT);\n+                $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n                 $stmn->execute();\n                 $stmn->closeCursor();"
        },
        {
          "filename": "app/Domain/Projects/Services/Projects.php",
          "status": "modified",
          "additions": 22,
          "deletions": 17,
          "patch": "@@ -310,25 +310,29 @@ public function getProjectsAssignedToUser($userId, $projectStatus = \"open\", $cli\n             $projects = $this->projectRepository->getUserProjects($userId, $projectStatus, $clientId);\n \n             if ($projects) {\n+\n+                foreach ($projects as &$project) {\n+                    $project['team'] = $this->projectRepository->getUsersAssignedToProject($project['id']);\n+                }\n+\n                 return $projects;\n             } else {\n                 return false;\n             }\n         }\n \n-        public function findMyChildren($currentParentId, array $projects) {\n+        public function findMyChildren($currentParentId, array $projects)\n+        {\n \n             $branch = [];\n \n             foreach ($projects as $project) {\n                 if ($project['parent'] == $currentParentId) {\n-\n                     $children = $this->findMyChildren($project['id'], $projects);\n-                    if($children) {\n+                    if ($children) {\n                         $project['children'] = $children;\n                     }\n                     $branch[] = $project;\n-\n                 }\n             }\n             return $branch;\n@@ -341,7 +345,8 @@ public function findMyChildren($currentParentId, array $projects) {\n          * @param array $projects\n          * @return array\n          */\n-        public function cleanParentRelationship(array $projects): array {\n+        public function cleanParentRelationship(array $projects): array\n+        {\n \n             $parents = [];\n             foreach ($projects as $project) {\n@@ -350,10 +355,9 @@ public function cleanParentRelationship(array $projects): array {\n \n             $cleanList = [];\n             foreach ($projects as $project) {\n-\n                 if (isset($parents[$project['parent']])) {\n                     $cleanList[] = $project;\n-                }else {\n+                } else {\n                     $project['parent'] = 0;\n                     $cleanList[] = $project;\n                 }\n@@ -371,7 +375,8 @@ public function getProjectHierarchyAssignedToUser($userId, $projectStatus = \"ope\n                 userId: $userId,\n                 projectStatus: $projectStatus,\n                 clientId: $clientId,\n-                accessStatus: \"assigned\");\n+                accessStatus: \"assigned\"\n+            );\n             $projects = self::dispatch_filter('afterLoadingProjects', $projects);\n \n \n@@ -382,8 +387,8 @@ public function getProjectHierarchyAssignedToUser($userId, $projectStatus = \"ope\n \n             //Get favorite projects\n             $favorites = [];\n-            foreach($projects as $project) {\n-                if(isset($project[\"isFavorite\"]) && $project[\"isFavorite\"] == 1) {\n+            foreach ($projects as $project) {\n+                if (isset($project[\"isFavorite\"]) && $project[\"isFavorite\"] == 1) {\n                     $favorites[] = $project;\n                 }\n             }\n@@ -392,9 +397,8 @@ public function getProjectHierarchyAssignedToUser($userId, $projectStatus = \"ope\n             return [\n                 \"allAssignedProjects\" => $projects,\n                 \"allAssignedProjectsHierarchy\" => $projectHierarchy,\n-                \"favoriteProjects\" => $favorites\n+                \"favoriteProjects\" => $favorites,\n             ];\n-\n         }\n \n         public function getProjectHierarchyAvailableToUser($userId, $projectStatus = \"open\", $clientId = null)\n@@ -405,7 +409,8 @@ public function getProjectHierarchyAvailableToUser($userId, $projectStatus = \"op\n                 userId: $userId,\n                 projectStatus: $projectStatus,\n                 clientId: $clientId,\n-                accessStatus: \"all\");\n+                accessStatus: \"all\"\n+            );\n             $projects = self::dispatch_filter('afterLoadingProjects', $projects);\n \n \n@@ -419,19 +424,19 @@ public function getProjectHierarchyAvailableToUser($userId, $projectStatus = \"op\n             return [\n                 \"allAvailableProjects\" => $projects,\n                 \"allAvailableProjectsHierarchy\" => $projectHierarchy,\n-                \"clients\" => $clients\n+                \"clients\" => $clients,\n             ];\n-\n         }\n \n-        public function getClientsFromProjectList(array $projects): array {\n+        public function getClientsFromProjectList(array $projects): array\n+        {\n \n             $clients = [];\n             foreach ($projects as $project) {\n                 if (!array_key_exists($project[\"clientId\"], $clients)) {\n                     $clients[$project[\"clientId\"]] = array(\n                         \"name\" => $project['clientName'],\n-                        \"id\" => $project[\"clientId\"]\n+                        \"id\" => $project[\"clientId\"],\n                     );\n                 }\n             }"
        },
        {
          "filename": "app/Domain/Projects/Templates/newProject.tpl.php",
          "status": "modified",
          "additions": 0,
          "deletions": 4,
          "patch": "@@ -10,10 +10,6 @@\n \n <div class=\"pageheader\">\n \n-    <div class=\"pull-right padding-top\">\n-        <a href=\"<?=BASE_URL ?>/projects/showAll\" class=\"backBtn\"><i class=\"far fa-arrow-alt-circle-left\"></i> <?php echo $tpl->__('links.go_back') ?></a>\n-    </div>\n-\n     <div class=\"pageicon\"><span class=\"fa fa-suitcase\"></span></div>\n     <div class=\"pagetitle\">\n         <h5><?php echo $tpl->__('label.administration') ?></h5>"
        },
        {
          "filename": "app/Domain/Projects/Templates/showMy.tpl.php",
          "status": "modified",
          "additions": 53,
          "deletions": 45,
          "patch": "@@ -17,26 +17,6 @@\n \n         <?php echo $tpl->displayNotification(); ?>\n \n-        <div class=\"row\">\n-            <div class=\"col-md-4\">\n-\n-            </div>\n-            <div class=\"col-md-4\">\n-\n-            </div>\n-            <div class=\"col-md-4\">\n-                <div class=\"pull-right\">\n-                    <div class=\"btn-group viewDropDown\">\n-                        <button class=\"btn dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" data-tippy-content=\"<?=$tpl->__(\"popover.view\") ?>\"><i class=\" fas fa-columns\"></i></button>\n-                        <ul class=\"dropdown-menu\">\n-                            <li><a href=\"<?=BASE_URL ?>/tickets/roadmapAll\"><?=$tpl->__(\"menu.milestone_gantt\") ?></a></li>\n-                            <li class=\"active\"><a href=\"<?=BASE_URL ?>/projects/showMy\"><?=$tpl->__(\"menu.card_view\") ?></a></li>\n-                            <li><a href=\"<?=BASE_URL ?>/tickets/showAllMilestonesOverview\"><?=$tpl->__(\"menu.table_view\") ?></a></li>\n-                        </ul>\n-                    </div>\n-                </div>\n-            </div>\n-        </div>\n         <div class=\"row\">\n             <div class=\"col-md-12\">\n \n@@ -65,16 +45,20 @@\n                         <div class=\"row \" id=\"projectProgressContainer\">\n                             <div class=\"col-md-12\">\n                                 <div class=\"row\" style=\"padding-bottom:10px;\">\n-                                    <div class=\"col-md-8\">\n-                                    <div class=\"projectAvatar\">\n-                                        <img src=\"<?=BASE_URL?>/api/projects?projectAvatar=<?=$project['id'] ?>\"/>\n-                                    </div>\n-                                    <small><?php $tpl->e($project['clientName'])?></small>\n-                                    <h4>\n-                                        <a href=\"<?=BASE_URL?>/dashboard/show?projectId=<?=$project['id']?>\"><?php $tpl->e($project['name'])?></a>\n-                                    </h4>\n+                                    <div class=\"col-md-9\">\n+                                        <div class=\"projectAvatar\">\n+                                            <img src=\"<?=BASE_URL?>/api/projects?projectAvatar=<?=$project['id'] ?>&v=<?=strtotime($project['modified'] ?? '0') ?>\"/>\n+                                        </div>\n+                                        <small><?php $tpl->e($project['clientName'])?></small>\n+                                        <h4>\n+                                            <a href=\"<?=BASE_URL?>/dashboard/show?projectId=<?=$project['id']?>\"\n+                                               <?php if(strlen($project['details'])>0){ ?>\n+                                            data-tippy-content=\"<?=$tpl->e(substr(strip_tags($project['details']), 0, 80)) ?>\"\n+                                               <?php } ?>\n+                                            ><?php $tpl->e($project['name'])?></a>\n+                                        </h4>\n                                     </div>\n-                                    <div class=\"col-md-4\" style=\"text-align:right\">\n+                                    <div class=\"col-md-3\" style=\"text-align:right\">\n                                         <?php if ($project['status'] !== null && $project['status'] != '') {?>\n                                             <span class=\"label label-<?php $tpl->e($project['status'])?>\"><?=$tpl->__(\"label.project_status_\" . $project['status']) ?></span><br />\n \n@@ -83,22 +67,7 @@\n                                         <?php } ?>\n                                     </div>\n                                 </div>\n-\n-                                <div class=\"row\">\n-\n-                                    <div class=\"col-md-7\">\n-                                        <?=$tpl->__(\"subtitles.project_progress\") ?>\n-                                    </div>\n-                                    <div class=\"col-md-5\" style=\"text-align:right\">\n-                                        <?=sprintf($tpl->__(\"text.percent_complete\"), round($project['progress']['percent']))?>\n-                                    </div>\n-                                </div>\n-                                <div class=\"progress\">\n-                                    <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"<?=round($project['progress']['percent']); ?>\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: <?=round($project['progress']['percent']); ?>%\">\n-                                        <span class=\"sr-only\"><?=round($project['progress']['percent']); ?>% Complete</span>\n-                                    </div>\n-                                </div>\n-                                <br />\n+                                <div class=\"clearall\"></div><br />\n \n                                 <?php if ($project['lastUpdate'] !== false) {?>\n                                     <div class=\"lastStatus\">\n@@ -120,12 +89,51 @@\n                                     <div class=\"clearall\"></div>\n                                     <br />\n                                 <?php } ?>\n+\n+                                <div class=\"row\">\n+                                    <div class=\"col-md-7\">\n+                                        <?=$tpl->__(\"subtitles.project_progress\") ?>\n+                                    </div>\n+                                    <div class=\"col-md-5\" style=\"text-align:right\">\n+                                        <?=sprintf($tpl->__(\"text.percent_complete\"), round($project['progress']['percent']))?>\n+                                    </div>\n+                                </div>\n+                                <div class=\"progress\">\n+                                    <div class=\"progress-bar progress-bar-success\" role=\"progressbar\" aria-valuenow=\"<?=round($project['progress']['percent']); ?>\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: <?=round($project['progress']['percent']); ?>%\">\n+                                        <span class=\"sr-only\"><?=round($project['progress']['percent']); ?>% Complete</span>\n+                                    </div>\n+                                </div>\n+                                <br />\n+\n+\n                             </div>\n                         </div>\n+\n+                        <div class=\"row\">\n+                            <div class=\"col-md-12\">\n+\n+\n+                                <div class=\"team\">\n+                                    <?php foreach($project['team'] as $member) { ?>\n+                                        <div class=\"commentImage\" style=\"margin-right:-10px;\">\n+                                            <img\n+                                                style=\"\"\n+                                                src=\"<?=BASE_URL ?>/api/users?profileImage=<?=$member['id']?>&v=<?=strtotime($member['modified'])?>\" data-tippy-content=\"<?=$member['firstname'].' '.$member['lastname'] ?>\" />\n+                                        </div>\n+                                    <?php } ?>\n+                                </div>\n+                                <div class=\"clearall\"></div>\n+                            </div>\n+                        </div>\n+\n+\n+\n+                        <?php /*\n                         <div class=\"center\">\n                             <a class=\"showMoreLink\" href=\"javascript:void(0);\"  onclick=\"jQuery('#moreInfo-<?=$project['id']?>').toggle('fast')\"><?=$tpl->__(\"links.read_more\") ?></a>\n \n                         </div>\n+ */ ?>\n                         <div id=\"moreInfo-<?=$project['id']?>\" style=\"display:none;\">\n                             <div class=\"row  padding-md\">\n                                 <div class=\"col-md-12\">"
        },
        {
          "filename": "app/Domain/Projects/Templates/showProject.tpl.php",
          "status": "modified",
          "additions": 12,
          "deletions": 9,
          "patch": "@@ -22,15 +22,18 @@\n \n         <?php echo $tpl->displayNotification() ?>\n \n-        <div class=\"row\">\n-            <div class=\"col-md-12\">\n-                <div class=\"pull-right\">\n-                    <a href=\"<?=BASE_URL?>/projects/duplicateProject/<?=$project['id']?>\" class=\"duplicateProjectModal btn btn-default\"><?=$tpl->__(\"links.duplicate_project\") ?></a>\n+        <div class=\"inlineDropDownContainer\" style=\"float:right; z-index:50; padding-top:10px;\">\n \n-                </div>\n-            </div>\n-        </div>\n+            <a href=\"javascript:void(0);\" class=\"dropdown-toggle ticketDropDown\" data-toggle=\"dropdown\">\n+                <i class=\"fa fa-ellipsis-v\" aria-hidden=\"true\"></i>\n+            </a>\n+            <ul class=\"dropdown-menu\">\n+                <li class=\"nav-header\">Project</li>\n+                <li><a href=\"<?=BASE_URL?>/projects/duplicateProject/<?=$project['id']?>\" class=\"duplicateProjectModal\"><?=$tpl->__(\"links.duplicate_project\") ?></a></li>\n+                <li><a href=\"<?=BASE_URL?>/projects/delProject/<?=$project['id']?>\" class=\"delete\"><i class=\"fa fa-trash\"></i> <?php echo $tpl->__('buttons.delete'); ?></a></li>\n \n+            </ul>\n+        </div>\n         <div class=\"tabbedwidget tab-primary projectTabs\">\n \n             <ul>\n@@ -76,7 +79,7 @@\n                                                 checked=\"checked\"\n                                                 />\n                                             <div class=\"commentImage\">\n-                                                <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$userId ?>\"/>\n+                                                <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$userId ?>&v=<?=strtotime($assignedUser['modified']) ?>\"/>\n                                             </div>\n                                             <label for=\"user-<?php echo $userId ?>\" ><?php printf($tpl->__('text.full_name'), $tpl->escape($assignedUser['firstname']), $tpl->escape($assignedUser['lastname'])); ?>\n                                                 <?php if ($assignedUser['jobTitle'] != '') { ?>\n@@ -142,7 +145,7 @@\n                                                 <input type='checkbox' name='editorId[]' id=\"user-<?php echo $row['id'] ?>\" value='<?php echo $row['id'] ?>' />\n \n                                                 <div class=\"commentImage\">\n-                                                    <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$row['id'] ?>\"/>\n+                                                    <img src=\"<?= BASE_URL ?>/api/users?profileImage=<?=$row['id'] ?>&v=<?=strtotime($row['modified']) ?>\"/>\n                                                 </div>\n                                                 <label for=\"user-<?php echo $row['id'] ?>\" ><?php printf($tpl->__('text.full_name'), $tpl->escape($row['firstname']), $tpl->escape($row['lastname'])); ?></label>\n                                                 <?php if ($roles::getRoles()[$row['role']] == $roles::$admin || $roles::getRoles()[$row['role']] == $roles::$owner) { ?>"
        },
        {
          "filename": "app/Domain/Projects/Templates/submodules/projectDetails.sub.php",
          "status": "modified",
          "additions": 2,
          "deletions": 6,
          "patch": "@@ -32,11 +32,7 @@\n             </div>\n             <div class=\"row padding-top\">\n                 <div class=\"col-md-12\">\n-                    <?php if ($project['id'] != '') : ?>\n-                        <div class=\"pull-right padding-top\">\n-                            <a href=\"<?=BASE_URL?>/projects/delProject/<?php echo $project['id']?>\" class=\"delete\"><i class=\"fa fa-trash\"></i> <?php echo $tpl->__('buttons.delete'); ?></a>\n-                        </div>\n-                    <?php endif; ?>\n+\n                     <input type=\"submit\" name=\"save\" id=\"save\" class=\"button\" value=\"<?php echo $tpl->__('buttons.save'); ?>\" class=\"button\" />\n                 </div>\n \n@@ -74,7 +70,7 @@\n                     <h4 class=\"widgettitle title-light\"><span\n                             class=\"fa fa-picture-o\"></span><?php echo $tpl->__('label.project_avatar'); ?></h4>\n \n-                    <img src='<?=BASE_URL?>/api/projects?projectAvatar=<?=$project['id']; ?>'  class='profileImg' alt='Profile Picture' id=\"previousImage\"/>\n+                    <img src='<?=BASE_URL?>/api/projects?projectAvatar=<?=$project['id']; ?>&v=<?=strtotime($project['modified'] ?? '0') ?>'  class='profileImg' alt='Profile Picture' id=\"previousImage\"/>\n                     <div id=\"projectAvatar\">\n                     </div>\n "
        },
        {
          "filename": "app/Domain/Tickets/Js/ticketsController.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -50,7 +50,7 @@ leantime.ticketsController = (function () {\n \n \n     var toggleFilterBar = function () {\n-        jQuery(\".filterBar\").toggle(\"fast\");\n+        jQuery(\".filterBar\").toggle();\n \n     };\n "
        },
        {
          "filename": "app/Domain/Tickets/Services/Tickets.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -190,7 +190,7 @@ public function prepareTicketSearchArray(array $searchParams)\n                 \"milestone\" => \"\",\n                 \"orderBy\" => \"sortIndex\",\n                 \"orderDirection\" => \"DESC\",\n-                \"groupBy\" => \"status\",\n+                \"groupBy\" => \"\",\n                 \"priority\" => \"\",\n                 \"currentUser\" => $_SESSION['userdata'][\"id\"] ?? '',\n                 \"currentClient\" => $_SESSION['userdata'][\"clientId\"] ?? '',"
        },
        {
          "filename": "app/Domain/Tickets/Templates/submodules/portfolioHeader.sub.php",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -12,12 +12,11 @@\n <div class=\"pageheader\">\n     <?php $tpl->dispatchTplEvent('afterPageHeaderOpen'); ?>\n     <div class=\"pageicon\">\n-        <span class=\"fa fa-fw fa-thumb-tack\"></span>\n+        <span class=\"fa fa fa-briefcase\"></span>\n     </div>\n     <div class=\"pagetitle\">\n \n-\n-        <h1><?php echo $tpl->__(\"headlines.my_portfolio\"); ?>\n+        <h1><?php echo $tpl->__(\"headlines.my_projects\"); ?>\n \n             <?php if (count($clients) > 0) {?>\n                 //"
        },
        {
          "filename": "app/Domain/Users/Controllers/NewUser.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -116,6 +116,13 @@ public function run()\n                     }\n                 }\n \n+                $preSelectedClient = '';\n+                if (isset($_GET['preSelectedClient'])) {\n+                    $preSelectedClient = (int)$_GET['preSelectedClient'];\n+                }\n+\n+\n+                $this->tpl->assign('preSelectedClient', $preSelectedClient);\n                 $this->tpl->assign('clients', $clients->getAll());\n                 $this->tpl->assign('allProjects', $this->projectsRepo->getAll());\n                 $this->tpl->assign('roles', Roles::getRoles());"
        },
        {
          "filename": "app/Domain/Users/Repositories/Users.php",
          "status": "modified",
          "additions": 32,
          "deletions": 12,
          "patch": "@@ -214,7 +214,8 @@ public function getEmployees()\n             zp_user.lastname,\n             zp_user.jobTitle,\n             zp_user.jobLevel,\n-            zp_user.department\n+            zp_user.department,\n+            zp_user.modified\n          FROM zp_user\n             ORDER BY lastname\";\n \n@@ -249,7 +250,8 @@ public function getAll($activeOnly = false)\n                       zp_clients.name AS clientName,\n                       jobTitle,\n                       jobLevel,\n-                      department\n+                      department,\n+                      modified\n                     FROM `zp_user`\n                     LEFT JOIN zp_clients ON zp_clients.id = zp_user.clientId\n                     WHERE !(source <=> 'api')\";\n@@ -284,7 +286,8 @@ public function getAllBySource($source)\n                       createdOn,\n                       jobTitle,\n                       jobLevel,\n-                      department\n+                      department,\n+                      modified\n                     FROM `zp_user`\n                     WHERE source <=> :source\n                     ORDER BY lastname\";\n@@ -320,7 +323,8 @@ public function getAllClientUsers($clientId)\n                         zp_clients.name AS clientName,\n                         jobTitle,\n                         jobLevel,\n-                        department\n+                        department,\n+                        modified\n                     FROM `zp_user`\n                     LEFT JOIN zp_clients ON zp_clients.id = zp_user.clientId\n                     WHERE clientId = :clientId\n@@ -384,7 +388,8 @@ public function editUser(array $values, $id)\n                 jobLevel = :jobLevel,\n                 department = :department,\n                 \" . $chgPW . \"\n-                clientId = :clientId\n+                clientId = :clientId,\n+                modified = :modified\n              WHERE id = :id LIMIT 1\";\n \n             $stmn = $this->db->database->prepare($query);\n@@ -400,6 +405,7 @@ public function editUser(array $values, $id)\n             $stmn->bindValue(':jobTitle', $values['jobTitle'] ?? '', PDO::PARAM_STR);\n             $stmn->bindValue(':jobLevel', $values['jobLevel'] ?? '', PDO::PARAM_STR);\n             $stmn->bindValue(':department', $values['department'] ?? '', PDO::PARAM_STR);\n+            $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             $stmn->bindValue(':id', $id, PDO::PARAM_STR);\n \n@@ -472,7 +478,8 @@ public function editOwn($values, $id)\n                 username = :username,\n                 \" . $chgPW . \"\n                 phone = :phone,\n-                notifications = :notifications\n+                notifications = :notifications,\n+                modified = :modified\n                 WHERE id = :id LIMIT 1\";\n \n             $stmn = $this->db->database->prepare($query);\n@@ -481,6 +488,7 @@ public function editOwn($values, $id)\n             $stmn->bindValue(':username', $values['user'], PDO::PARAM_STR);\n             $stmn->bindValue(':phone', $values['phone'], PDO::PARAM_STR);\n             $stmn->bindValue(':notifications', $values['notifications'], PDO::PARAM_STR);\n+            $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             $stmn->bindValue(':id', $id, PDO::PARAM_STR);\n \n@@ -516,7 +524,8 @@ public function addUser(array $values): false|string\n                             createdOn,\n                             jobTitle,\n                             jobLevel,\n-                            department\n+                            department,\n+                            modified\n                         ) VALUES (\n                             :firstname,\n                             :lastname,\n@@ -529,10 +538,11 @@ public function addUser(array $values): false|string\n                             :source,\n                             :pwReset,\n                             :status,\n-                            NOW(),\n+                            :createdOn,\n                             :jobTitle,\n                             :jobLevel,\n-                            :department\n+                            :department,\n+                            :modified\n                         )\";\n \n             $stmn = $this->db->database->prepare($query);\n@@ -549,6 +559,8 @@ public function addUser(array $values): false|string\n             $stmn->bindValue(':jobTitle', $values['jobTitle'] ?? '', PDO::PARAM_STR);\n             $stmn->bindValue(':jobLevel', $values['jobLevel'] ?? '', PDO::PARAM_STR);\n             $stmn->bindValue(':department', $values['department'] ?? '', PDO::PARAM_STR);\n+            $stmn->bindValue(':createdOn', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n+            $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             if (isset($values['source'])) {\n                 $stmn->bindValue(':source', $values['source'], PDO::PARAM_STR);\n@@ -616,11 +628,17 @@ public function setPicture($_FILE, $id)\n             $lastId = $files->upload($_FILE, 'user', $id, true, 200, 200);\n \n             if (isset($lastId['fileId'])) {\n-                $sql = 'UPDATE `zp_user` SET profileId = :fileId WHERE id = :userId';\n+                $sql = 'UPDATE\n+                            `zp_user`\n+                        SET\n+                            profileId = :fileId,\n+                            modified = :modified\n+                        WHERE id = :userId';\n \n                 $stmn = $this->db->database->prepare($sql);\n                 $stmn->bindValue(':fileId', $lastId['fileId'], PDO::PARAM_INT);\n                 $stmn->bindValue(':userId', $id, PDO::PARAM_INT);\n+                $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n                 $stmn->execute();\n                 $stmn->closeCursor();\n@@ -698,11 +716,13 @@ public function patchUser($id, $params)\n                 $sql .= DbCore::sanitizeToColumnString($key) . \"=:\" . DbCore::sanitizeToColumnString($key) . \", \";\n             }\n \n-            $sql .= \" id=:id WHERE id=:id2 LIMIT 1\";\n+            $sql .= \" modified =:modified \";\n+\n+            $sql .= \" WHERE id=:id LIMIT 1\";\n \n             $stmn = $this->db->database->prepare($sql);\n             $stmn->bindValue(':id', $id, PDO::PARAM_STR);\n-            $stmn->bindValue(':id2', $id, PDO::PARAM_STR);\n+            $stmn->bindValue(':modified', date(\"Y-m-d H:i:s\"), PDO::PARAM_STR);\n \n             foreach ($params as $key => $value) {\n                 $cleanKey = DbCore::sanitizeToColumnString($key);"
        },
        {
          "filename": "app/Domain/Users/Templates/components/profile-box.blade.php",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -1,9 +1,13 @@\n+@props([\n+    'user' => null\n+])\n+\n <div class=\"profileBox\">\n     <div class=\"commentImage\">\n-        @if (isset($user['id']) || isset($user->id))\n-            <x-users::profile-image :userId=\"$user['id'] ?? $user->id\" />\n+        @if (isset($user['userId']) || isset($user->userId))\n+            <x-users::profile-image :user=\"$user\" />\n         @else\n-            <i class=\"fa fa-user-plus\"></i>\n+            <i class=\"fa fa-user\"></i>\n         @endif\n     </div>\n     <div class=\"userName\">"
        },
        {
          "filename": "app/Domain/Users/Templates/components/profile-image.blade.php",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -1,3 +1,7 @@\n+@props([\n+    'user' => null\n+])\n+\n <img {{ $attributes->merge([\n-    'src' => BASE_URL . '/api/users?profileImage=' . $userId,\n+    'src' => BASE_URL . '/api/users?profileImage=' . $user['id'] .'&v='.strtotime($user['modified'] ?? '0'),\n ]) }} />"
        },
        {
          "filename": "app/Domain/Users/Templates/editOwn.tpl.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -236,7 +236,7 @@\n         </div>\n         <div class=\"col-md-4\">\n             <div class=\"maincontentinner center\">\n-                <img src='<?=BASE_URL?>/api/users?profileImage=<?=$user['id']; ?>'  class='profileImg' alt='Profile Picture' id=\"previousImage\"/>\n+                <img src='<?=BASE_URL?>/api/users?profileImage=<?=$user['id']; ?>?v=<?=strtotime($user['modified'] ?? \"0\") ?>'  class='profileImg' alt='Profile Picture' id=\"previousImage\"/>\n                 <div id=\"profileImg\">\n                 </div>\n "
        },
        {
          "filename": "app/Domain/Users/Templates/editUser.tpl.php",
          "status": "modified",
          "additions": 9,
          "deletions": 2,
          "patch": "@@ -151,12 +151,19 @@\n                             <div id='accordion_\" . $i . \"' class='simpleAccordionContainer'>\";\n                                 $currentClient = $row['clientName'];\n                             } ?>\n-                            <div class=\"item\">\n+                            <div class=\"item\" style=\"padding:10px 0px;\">\n                                 <input type=\"checkbox\" name=\"projects[]\" id='project_<?php echo $row['id'] ?>' value=\"<?php echo $row['id'] ?>\"\n                                     <?php if (is_array($projects) === true && in_array($row['id'], $projects) === true) {\n                                         echo \"checked='checked';\";\n                                     } ?>\n-                                /><label for=\"project_<?php echo $row['id'] ?>\"><?php $tpl->e($row['name']); ?></label>\n+                                />\n+                                <span class=\"projectAvatar\" style=\"width:30px; float:left; margin-right:10px;\">\n+                                    <img src='<?=BASE_URL ?>/api/projects?projectAvatar=<?=$row[\"id\"] ?>&v=<?=strtotime($row['modified'] ?? '0') ?>' />\n+                                </span>\n+\n+                                <label for=\"project_<?php echo $row['id'] ?>\" style=\"margin-top:-11px\">\n+                                    <small><?php $tpl->e($row['type']); ?></small><br />\n+                                    <?php $tpl->e($row['name']); ?></label>\n                                 <div class=\"clearall\"></div>\n                             </div>\n                             <?php $i++; ?>"
        },
        {
          "filename": "app/Domain/Users/Templates/newUser.tpl.php",
          "status": "modified",
          "additions": 11,
          "deletions": 3,
          "patch": "@@ -104,7 +104,8 @@\n                     <option value=\"0\" selected=\"selected\"><?php echo $tpl->__('label.no_clients') ?></option>\n                 <?php } ?>\n                 <?php foreach ($tpl->get('clients') as $client) : ?>\n-                    <option value=\"<?php echo $client['id'] ?>\" <?php if ($client['id'] == $values['clientId']) :\n+                    <option value=\"<?php echo $client['id'] ?>\"\n+                            <?php if ($client['id'] == $values['clientId'] || $tpl->get('preSelectedClient') == $client['id'] ) :\n                         ?>selected=\"selected\"<?php\n                                    endif; ?>><?php $tpl->e($client['name']) ?></option>\n                 <?php endforeach; ?>\n@@ -162,12 +163,19 @@\n                             <div id='accordion_\" . $i . \"' class='simpleAccordionContainer'>\";\n                             $currentClient = $row['clientName'];\n                         } ?>\n-                            <div class=\"item\">\n+                            <div class=\"item\" style=\"padding:10px 0px;\">\n                                 <input type=\"checkbox\" name=\"projects[]\" id='project_<?php echo $row['id'] ?>' value=\"<?php echo $row['id'] ?>\"\n                                 <?php if (is_array($projects) === true && in_array($row['id'], $projects) === true) {\n                                     echo \"checked='checked';\";\n                                 } ?>\n-                                /><label for=\"project_<?php echo $row['id'] ?>\"><?php $tpl->e($row['name']); ?></label>\n+                                />\n+                                <span class=\"projectAvatar\" style=\"width:30px; float:left; margin-right:10px;\">\n+                                    <img src='<?=BASE_URL ?>/api/projects?projectAvatar=<?=$row[\"id\"] ?>&v=<?=strtotime($row['modified'] ?? '0') ?>' />\n+                                </span>\n+\n+                                <label for=\"project_<?php echo $row['id'] ?>\" style=\"margin-top:-11px\">\n+                                    <small><?php $tpl->e($row['type']); ?></small><br />\n+                                    <?php $tpl->e($row['name']); ?></label>\n                                 <div class=\"clearall\"></div>\n                             </div>\n                         <?php $i++; ?>"
        },
        {
          "filename": "app/Language/en-US.ini",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -2175,3 +2175,7 @@ menu.files_tooltip = \"Files\"\n headline.browse_files_headline = \"Upload files, take a video or screen recording right from here\"\n menu.dataroom = \"<span style='font-size:var(--font-size-xl)'>\ud83d\udcce</span> Data Room\"\n text.you_have_not_favorited_any_projects = \"You have not favorited any projects yet\"\n+\n+menu.my_projects = \"<span class='head-icon fa fa-briefcase'></span><span class='headmenu-label'>My Projects</span>\"\n+popover.my_projects = \"My Projects\"\n+headlines.my_projects = \"My Projects\""
        },
        {
          "filename": "app/Plugins/MotivationalQuotes/composer.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n {\n-    \"name\": \"leantime/motivationalquotes\",\n+    \"name\": \"leantime/MotivationalQuotes\",\n     \"description\": \"Displays a random quote on the welcome page\",\n     \"version\": \"0.1\",\n     \"screenshot\": \"/images/screenshot.png\","
        },
        {
          "filename": "app/Plugins/MotivationalQuotes/register.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -8,7 +8,8 @@\n \n \\Leantime\\Core\\Events::add_event_listener(\n     //Register event listener\n-    \"core.template.tpl.dashboard.home.afterWelcomeMessage\",\n+    \"leantime.core.template.tpl.dashboard.home.afterWelcomeMessage\",\n+\n     //Create function for the event\n     function ($payload) {\n         // code here"
        },
        {
          "filename": "config/configuration.sample.php",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -79,7 +79,10 @@ class Config\n         \"email\":\"mail\",\n         \"firstname\":\"displayname\",\n         \"lastname\":\"\",\n-        \"phonenumber\":\"\"\n+        \"phone\":\"\",\n+        \"jobTitle\":\"title\",\n+        \"jobLevel\":\"level\",\n+        \"department\":\"department\"\n         }';\n     //For AD use\n     /*"
        },
        {
          "filename": "config/sample.env",
          "status": "modified",
          "additions": 9,
          "deletions": 2,
          "patch": "@@ -78,7 +78,11 @@ LEAN_LDAP_KEYS=\"{\n         \\\"email\\\":\\\"mail\\\",\n         \\\"firstname\\\":\\\"displayname\\\",\n         \\\"lastname\\\":\\\"\\\",\n-        \\\"phonenumber\\\":\\\"telephoneNumber\\\"\n+        \\\"phone\\\":\\\"telephoneNumber\\\",\n+        \\\"jobTitle\\\":\\\"title\\\"\n+        \\\"jobLevel\\\":\\\"level\\\"\n+        \\\"department\\\":\\\"department\\\"\n+\n }\"\n \n # For AD use these default attributes\n@@ -88,7 +92,10 @@ LEAN_LDAP_KEYS=\"{\n #        \\\"email\\\":\\\"mail\\\",\n #        \\\"firstname\\\":\\\"givenName\\\",\n #        \\\"lastname\\\":\\\"sn\\\",\n-#        \\\"phonenumber\\\":\\\"telephoneNumber\\\"\n+#        \\\"phone\\\":\\\"telephoneNumber\\\",\n+#        \\\"jobTitle\\\":\\\"title\\\"\n+#        \\\"jobLevel\\\":\\\"level\\\"\n+#        \\\"department\\\":\\\"department\\\"\n #      }\"\n \n LEAN_LDAP_DEFAULT_ROLE_KEY = 20;                   # Default Leantime Role on creation. (set to editor)"
        },
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 4,
          "deletions": 15,
          "patch": "@@ -12,7 +12,7 @@\n         \"@assuradeurengilde/fontawesome-iconpicker\": \"^3.2.3\",\n         \"@fortawesome/fontawesome-free\": \"^6.4.2\",\n         \"@popperjs/core\": \"^2.11.8\",\n-        \"chart.js\": \"^4.4.0\",\n+        \"chart.js\": \"^3.6.0\",\n         \"chartjs-adapter-moment\": \"^1.0.1\",\n         \"chosen-js\": \"^1.8.7\",\n         \"composer\": \"^4.1.0\",\n@@ -2193,11 +2193,6 @@\n         \"@jridgewell/sourcemap-codec\": \"^1.4.14\"\n       }\n     },\n-    \"node_modules/@kurkle/color\": {\n-      \"version\": \"0.3.2\",\n-      \"resolved\": \"https://registry.npmjs.org/@kurkle/color/-/color-0.3.2.tgz\",\n-      \"integrity\": \"sha512-fuscdXJ9G1qb7W8VdHi+IwRqij3lBkosAm4ydQtEmbY58OzHXqQhvlxqEkoz0yssNVn38bcpRWgA9PP+OGoisw==\"\n-    },\n     \"node_modules/@leichtgewicht/ip-codec\": {\n       \"version\": \"2.0.4\",\n       \"resolved\": \"https://registry.npmjs.org/@leichtgewicht/ip-codec/-/ip-codec-2.0.4.tgz\",\n@@ -4525,15 +4520,9 @@\n       }\n     },\n     \"node_modules/chart.js\": {\n-      \"version\": \"4.4.0\",\n-      \"resolved\": \"https://registry.npmjs.org/chart.js/-/chart.js-4.4.0.tgz\",\n-      \"integrity\": \"sha512-vQEj6d+z0dcsKLlQvbKIMYFHd3t8W/7L2vfJIbYcfyPcRx92CsHqECpueN8qVGNlKyDcr5wBrYAYKnfu/9Q1hQ==\",\n-      \"dependencies\": {\n-        \"@kurkle/color\": \"^0.3.0\"\n-      },\n-      \"engines\": {\n-        \"pnpm\": \">=7\"\n-      }\n+      \"version\": \"3.9.1\",\n+      \"resolved\": \"https://registry.npmjs.org/chart.js/-/chart.js-3.9.1.tgz\",\n+      \"integrity\": \"sha512-Ro2JbLmvg83gXF5F4sniaQ+lTbSv18E+TIf2cOeiH1Iqd2PGFOtem+DUufMZsCJwFE7ywPOpfXFBwRTGq7dh6w==\"\n     },\n     \"node_modules/chartjs-adapter-moment\": {\n       \"version\": \"1.0.1\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,12 +1,12 @@\n {\n   \"name\": \"leantime\",\n-  \"version\": \"2.4-beta-3\",\n+  \"version\": \"2.4-beta-4\",\n   \"description\": \"Open source innovation management system\",\n   \"dependencies\": {\n     \"@assuradeurengilde/fontawesome-iconpicker\": \"^3.2.3\",\n     \"@fortawesome/fontawesome-free\": \"^6.4.2\",\n     \"@popperjs/core\": \"^2.11.8\",\n-    \"chart.js\": \"^4.4.0\",\n+    \"chart.js\": \"^3.6.0\",\n     \"chartjs-adapter-moment\": \"^1.0.1\",\n     \"chosen-js\": \"^1.8.7\",\n     \"composer\": \"^4.1.0\","
        },
        {
          "filename": "public/assets/css/components/nav.css",
          "status": "modified",
          "additions": 30,
          "deletions": 5,
          "patch": "@@ -78,12 +78,16 @@\n     padding:0px 15px;\n }\n \n+.projectListFilter .fa {\n+    vertical-align: middle;\n+}\n+\n .leftmenu .project-selector  .projectListFilter select{\n     border-color:var(--secondary-background);\n     box-shadow:none;\n     max-width: 135px;\n     margin-top: 6px;\n-    margin-bottom: 8px;\n+    margin-bottom: 6px;\n     margin-right: 10px;\n     padding-left: 0px;\n }\n@@ -646,6 +650,15 @@\n .leftpanel .leftmenu .nav-tabs .projectselector {\n }\n \n+.leftpanel .leftmenu .nav-tabs .projectselector .projectSelectorFooter {\n+    border-top:1px solid var(--main-border-color);\n+}\n+\n+.leftpanel .leftmenu .nav-tabs .projectselector .projectSelectorFooter li a {\n+    display: block;\n+    padding-left: 15px;\n+}\n+\n .leftpanel .leftmenu .nav-tabs .projectselector  li a{\n     color:var(--primary-font-color);\n     font-size: var(--base-font-size);\n@@ -690,7 +703,7 @@\n \n .leftpanel .leftmenu .nav-tabs .projectselector .scrollingTab {\n     padding:0;\n-    height:calc(100vh - 200px);\n+    height:calc(100vh - 310px);\n     overflow:auto;\n }\n \n@@ -929,10 +942,14 @@\n     left:auto;\n }\n \n+#notificationsDropdown .scroll-wrapper {\n+    height:calc(100vh - 100px);\n+}\n+\n .notificationDropdown .dropdown-menu {\n-    right: -10px;\n+    right: -15px;\n     left: auto;\n-    min-width:300px;\n+    min-width:375px;\n }\n \n .notificationDropdown .dropdown-menu:after {\n@@ -972,7 +989,12 @@\n \n .notificationDropdown .dropdown-menu li:hover {\n     cursor:pointer;\n-    background:var(--dropdown-link-hover-bg);\n+    background:var(--main-menu-link-hover-bg);\n+}\n+\n+.notificationDropdown .dropdown-menu li a:hover {\n+    cursor:pointer;\n+    background:var(--main-menu-link-hover-bg);\n }\n \n .notificationDropdown .dropdown-menu li .notificationProfileImage img {\n@@ -993,6 +1015,7 @@\n .notificationDropdown .dropdown-menu li .notificationDate {\n     font-size:var(--font-size-s);\n     font-style: italic;\n+    color:var(--primary-font-color);\n }\n \n .notificationDropdown .notifcationTabs.active{\n@@ -1145,6 +1168,8 @@\n \n \n \n+\n+\n /* Left Nav expanded + + + + + + + + + + + + + + + + + */\n \n .mainwrapper.menuopen .barmenu {}"
        },
        {
          "filename": "public/assets/css/components/style.default.css",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -3695,13 +3695,15 @@ body .widgettitle .editHeadline:hover {\n     margin-top:0px;\n     float:left;\n     margin-right:10px;\n+\n }\n \n .commentImage img {\n     border-radius:50%;\n     width:38px;\n     height:38px;\n     border:1px solid var(--main-border-color);\n+    background:var(--secondary-background);\n }\n .commentLinks {\n \n@@ -3894,7 +3896,7 @@ a.titleInsertLink:hover {\n \n .scrollableItemList {\n     width:100%;\n-    height:50%;\n+    height:80%;\n     max-height:500px;\n     overflow:auto;\n     padding:10px;"
        },
        {
          "filename": "public/assets/js/app/core/editors.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -96,7 +96,7 @@ leantime.editorController = (function () {\n                     };\n \n                     jQuery.nmManual(\n-                        leantime.appUrl + '/files/showAll&modalPopUp=true',\n+                        leantime.appUrl + '/files/showAll?modalPopUp=true',\n                         {\n                             stack: true,\n                             callbacks: shortOptions,\n@@ -252,7 +252,7 @@ leantime.editorController = (function () {\n                     };\n \n                     jQuery.nmManual(\n-                        leantime.appUrl + '/files/showAll&modalPopUp=true',\n+                        leantime.appUrl + '/files/showAll?modalPopUp=true',\n                         {\n                             stack: true,\n                             callbacks: shortOptions,"
        },
        {
          "filename": "public/download.php",
          "status": "modified",
          "additions": 0,
          "deletions": 2,
          "patch": "@@ -27,8 +27,6 @@\n     header('Expires: '. gmdate('D, d M Y H:i:s \\G\\M\\T', time() + 86400));\n     header('Content-Type: image/jpeg');\n \n-\n-\n     ob_end_clean();\n     clearstatcache();\n     readfile(__DIR__.'/dist/images/leantime-no-access.jpg');"
        },
        {
          "filename": "public/theme/default/language/en-US.ini",
          "status": "renamed",
          "additions": 0,
          "deletions": 0,
          "patch": null
        }
      ],
      "file_patterns": {
        "security_files": 6,
        "config_files": 9,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 47,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d5e37debabece8779060ebd0ed6bf771bd240b4e",
            "date": "2024-12-18T20:17:52Z",
            "author_login": "marcelfolaron"
          },
          {
            "sha": "c0738ecd860f5226e0937a12bce4261ecddd4322",
            "date": "2024-12-18T20:15:17Z",
            "author_login": "marcelfolaron"
          },
          {
            "sha": "037177b1bbae60842c7068a2d1ce5151bae842ba",
            "date": "2024-12-16T19:46:05Z",
            "author_login": "marcelfolaron"
          },
          {
            "sha": "c049c4dbf7258f2076d0f1d35bdf84690f435425",
            "date": "2024-12-16T19:39:45Z",
            "author_login": "marcelfolaron"
          },
          {
            "sha": "4b47ec3c5bad0a653a3b16365e343dbf0caca81f",
            "date": "2024-12-10T01:27:04Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-89",
    "description": "Leantime is an open source project management system. A 'userId' variable in `app/domain/files/repositories/class.files.php` is not parameterized. An authenticated attacker can send a carefully crafted POST request to `/api/jsonrpc` to exploit an SQL injection vulnerability. Confidentiality is impacted as it allows for dumping information from the database. This issue has been addressed in version 2.4-beta-4. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-19T19:15:16.133",
    "last_modified": "2024-11-21T08:27:26.227",
    "fix_date": "2023-09-25T18:38:45Z"
  },
  "references": [
    {
      "url": "https://github.com/Leantime/leantime/commit/be75f1e0f311d11c00a0bdc7079a62eef3594bf0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Leantime/leantime/security/advisories/GHSA-559g-3h98-g3fj",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Leantime/leantime/commit/be75f1e0f311d11c00a0bdc7079a62eef3594bf0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Leantime/leantime/security/advisories/GHSA-559g-3h98-g3fj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.908667",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "leantime",
    "owner": "Leantime",
    "created_at": "2015-01-23T17:52:06Z",
    "updated_at": "2025-01-14T11:41:53Z",
    "pushed_at": "2025-01-14T12:55:12Z",
    "size": 194915,
    "stars": 4952,
    "forks": 614,
    "open_issues": 240,
    "watchers": 4952,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "4.0-dev",
      "master"
    ],
    "languages": {
      "PHP": 3146736,
      "JavaScript": 1843394,
      "CSS": 1581904,
      "Blade": 330881,
      "Twig": 17546,
      "HTML": 8258,
      "Makefile": 5780,
      "Less": 2624,
      "Smarty": 1792
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T14:16:46.768597"
  }
}