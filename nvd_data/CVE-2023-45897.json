{
  "cve_id": "CVE-2023-45897",
  "github_data": {
    "repository": "exfatprogs/exfatprogs",
    "fix_commit": "22d0e43e8d24119cbfc6efafabb0dec6517a86c4",
    "related_commits": [
      "22d0e43e8d24119cbfc6efafabb0dec6517a86c4",
      "4abc55e976573991e6a1117bb2b3711e59da07ae",
      "ec78688e5fb5a70e13df82b4c0da1e6228d3ccdf",
      "22d0e43e8d24119cbfc6efafabb0dec6517a86c4",
      "4abc55e976573991e6a1117bb2b3711e59da07ae",
      "ec78688e5fb5a70e13df82b4c0da1e6228d3ccdf"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "22d0e43e8d24119cbfc6efafabb0dec6517a86c4",
      "commit_date": "2023-08-10T06:10:05Z",
      "author": {
        "login": "YuezhangMo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fsck: fix out-of-bounds memory access",
        "length": 369,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "fsck/fsck.c",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -811,7 +811,7 @@ static int handle_dot_dotdot_filename(struct exfat_de_iter *iter,\n \t\tchar *rename = NULL;\n \t\t__u16 hash;\n \t\tstruct exfat_dentry *stream_de;\n-\t\tint name_len, ret;\n+\t\tint ret;\n \n \t\tswitch (num) {\n \t\tcase 1:\n@@ -840,11 +840,11 @@ static int handle_dot_dotdot_filename(struct exfat_de_iter *iter,\n \t\tif (ret < 0)\n \t\t\treturn ret;\n \n+\t\tret >>= 1;\n \t\tmemcpy(dentry->name_unicode, utf16_name, ENTRY_NAME_MAX * 2);\n-\t\tname_len = exfat_utf16_len(utf16_name, ENTRY_NAME_MAX * 2);\n-\t\thash = exfat_calc_name_hash(iter->exfat, utf16_name, (int)name_len);\n+\t\thash = exfat_calc_name_hash(iter->exfat, utf16_name, ret);\n \t\texfat_de_iter_get_dirty(iter, 1, &stream_de);\n-\t\tstream_de->stream_name_len = (__u8)name_len;\n+\t\tstream_de->stream_name_len = (__u8)ret;\n \t\tstream_de->stream_name_hash = cpu_to_le16(hash);\n \t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "cf1f513bbdcd73d0cf412efbb6ce35b47509b861",
            "date": "2024-11-20T07:23:38Z",
            "author_login": "hclee"
          },
          {
            "sha": "3fd43bb6744d33f7a1f05a3071ae2892a59f6198",
            "date": "2024-11-19T08:16:26Z",
            "author_login": "hclee"
          },
          {
            "sha": "fc4339be940fd120487cb131e06aec8158274f64",
            "date": "2024-11-04T08:28:24Z",
            "author_login": "YuezhangMo"
          },
          {
            "sha": "20610b5562d1cfd93ea05571b0a978c5b498b0c6",
            "date": "2024-10-31T09:35:02Z",
            "author_login": "luziferius"
          },
          {
            "sha": "4e01a2fc1f6b04ed0bf0849cf33f277cfb2920bd",
            "date": "2024-11-02T18:27:46Z",
            "author_login": "RomainNaour"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-125",
    "description": "exfatprogs before 1.2.2 allows out-of-bounds memory access, such as in read_file_dentry_set.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-28T21:15:07.577",
    "last_modified": "2024-11-21T08:27:34.957",
    "fix_date": "2023-08-10T06:10:05Z"
  },
  "references": [
    {
      "url": "https://dfir.ru/2023/11/01/cve-2023-45897-a-vulnerability-in-the-linux-exfat-userspace-tools/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/commit/22d0e43e8d24119cbfc6efafabb0dec6517a86c4",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/commit/4abc55e976573991e6a1117bb2b3711e59da07ae",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/commit/ec78688e5fb5a70e13df82b4c0da1e6228d3ccdf",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/releases/tag/1.2.2",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://dfir.ru/2023/11/01/cve-2023-45897-a-vulnerability-in-the-linux-exfat-userspace-tools/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/commit/22d0e43e8d24119cbfc6efafabb0dec6517a86c4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/commit/4abc55e976573991e6a1117bb2b3711e59da07ae",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/commit/ec78688e5fb5a70e13df82b4c0da1e6228d3ccdf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/exfatprogs/exfatprogs/releases/tag/1.2.2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/09/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.961608",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "exfatprogs",
    "owner": "exfatprogs",
    "created_at": "2020-01-19T12:29:10Z",
    "updated_at": "2025-01-22T01:40:11Z",
    "pushed_at": "2025-01-21T23:54:14Z",
    "size": 756,
    "stars": 212,
    "forks": 55,
    "open_issues": 7,
    "watchers": 212,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 234216,
      "Roff": 10394,
      "Shell": 2606,
      "Makefile": 1899,
      "M4": 714
    },
    "commit_activity": {
      "total_commits_last_year": 25,
      "avg_commits_per_week": 0.4807692307692308,
      "days_active_last_year": 18
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T07:52:40.047100"
  }
}