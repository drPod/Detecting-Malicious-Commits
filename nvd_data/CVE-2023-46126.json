{
  "cve_id": "CVE-2023-46126",
  "github_data": {
    "repository": "ethyca/fides",
    "fix_commit": "3231d19699f9c895c986f6a967a64d882769c506",
    "related_commits": [
      "3231d19699f9c895c986f6a967a64d882769c506",
      "3231d19699f9c895c986f6a967a64d882769c506"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3231d19699f9c895c986f6a967a64d882769c506",
      "commit_date": "2023-10-22T23:07:23Z",
      "author": {
        "login": "ThomasLaPiana",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-fgjj-5jmr-gh83",
        "length": 475,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 136,
        "additions": 94,
        "deletions": 42
      },
      "files": [
        {
          "filename": "src/fides/api/schemas/privacy_experience.py",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -3,7 +3,7 @@\n from datetime import datetime\n from typing import Any, Dict, List, Optional\n \n-from pydantic import Extra, Field, root_validator, validator\n+from pydantic import Extra, Field, HttpUrl, root_validator, validator\n \n from fides.api.models.privacy_experience import BannerEnabled, ComponentType\n from fides.api.models.privacy_notice import PrivacyNoticeRegion\n@@ -43,8 +43,8 @@ class ExperienceConfigSchema(FidesSchema):\n     privacy_policy_link_label: Optional[str] = Field(\n         description=\"Overlay and Privacy Center 'Privacy policy link label'\"\n     )\n-    privacy_policy_url: Optional[str] = Field(\n-        description=\"Overlay and Privacy Center 'Privacy policy URl'\"\n+    privacy_policy_url: Optional[HttpUrl] = Field(\n+        default=None, description=\"Overlay and Privacy Center 'Privacy policy URL\"\n     )\n     privacy_preferences_link_label: Optional[str] = Field(\n         description=\"Overlay 'Privacy preferences link label'\""
        },
        {
          "filename": "tests/fixtures/application_fixtures.py",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -2302,7 +2302,7 @@ def privacy_preference_history(\n             \"request_origin\": \"privacy_center\",\n             \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n             \"user_geography\": \"us_ca\",\n-            \"url_recorded\": \"example.com/privacy_center\",\n+            \"url_recorded\": \"https://example.com/privacy_center\",\n             \"served_notice_history_id\": served_notice_history.id,\n         },\n         check_name=False,\n@@ -2651,7 +2651,7 @@ def experience_config_overlay(db: Session) -> Generator:\n             \"disabled\": False,\n             \"privacy_preferences_link_label\": \"Manage preferences\",\n             \"privacy_policy_link_label\": \"View our company&#x27;s privacy policy\",\n-            \"privacy_policy_url\": \"example.com/privacy\",\n+            \"privacy_policy_url\": \"https://example.com/privacy\",\n             \"reject_button_label\": \"Reject all\",\n             \"save_button_label\": \"Save\",\n             \"title\": \"Manage your consent\",\n@@ -2677,7 +2677,7 @@ def experience_config_tcf_overlay(db: Session) -> Generator:\n             \"disabled\": False,\n             \"privacy_preferences_link_label\": \"Manage preferences\",\n             \"privacy_policy_link_label\": \"View our company&#x27;s privacy policy\",\n-            \"privacy_policy_url\": \"example.com/privacy\",\n+            \"privacy_policy_url\": \"https://example.com/privacy\",\n             \"reject_button_label\": \"Reject all\",\n             \"save_button_label\": \"Save\",\n             \"title\": \"Manage your consent\","
        },
        {
          "filename": "tests/ops/api/v1/endpoints/test_privacy_experience_config_endpoints.py",
          "status": "modified",
          "additions": 48,
          "deletions": 13,
          "patch": "@@ -317,7 +317,7 @@ def overlay_experience_request_body(self) -> dict:\n             \"disabled\": False,\n             \"privacy_preferences_link_label\": \"Manage preferences\",\n             \"privacy_policy_link_label\": \"View our privacy policy\",\n-            \"privacy_policy_url\": \"example.com/privacy\",\n+            \"privacy_policy_url\": \"http://example.com/privacy\",\n             \"reject_button_label\": \"Reject all\",\n             \"regions\": [],\n             \"save_button_label\": \"Save\",\n@@ -455,7 +455,7 @@ def test_create_another_default_experience_config(\n                 \"description\": \"We take your privacy seriously\",\n                 \"is_default\": True,\n                 \"privacy_policy_link_label\": \"Manage your privacy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"reject_button_label\": \"No\",\n                 \"save_button_label\": \"Save\",\n                 \"title\": \"Manage your privacy\",\n@@ -469,6 +469,39 @@ def test_create_another_default_experience_config(\n             == \"Cannot set as the default. Only one default privacy_center config can be in the system.\"\n         )\n \n+    @pytest.mark.parametrize(\n+        \"invalid_url\",\n+        [\n+            \"thisisnotaurl\",\n+            \"javascript:alert('XSS: domain scope: '+document.domain)\",\n+        ],\n+    )\n+    def test_create_experience_config_with_invalid_policy_url(\n+        self, api_client: TestClient, url, generate_auth_header, db, invalid_url\n+    ) -> None:\n+        \"\"\"\n+        Verify that an invalid Privacy Policy URL returns a 422.\n+        \"\"\"\n+        auth_header = generate_auth_header(\n+            scopes=[scopes.PRIVACY_EXPERIENCE_CREATE, scopes.PRIVACY_EXPERIENCE_UPDATE]\n+        )\n+        response = api_client.post(\n+            url,\n+            json={\n+                \"accept_button_label\": \"Yes\",\n+                \"banner_enabled\": \"always_disabled\",\n+                \"component\": \"privacy_center\",\n+                \"description\": \"We take your company's privacy seriously\",\n+                \"privacy_policy_link_label\": \"Manage your privacy\",\n+                \"privacy_policy_url\": invalid_url,\n+                \"reject_button_label\": \"No\",\n+                \"save_button_label\": \"Save\",\n+                \"title\": \"Manage your privacy\",\n+            },\n+            headers=auth_header,\n+        )\n+        assert response.status_code == 422\n+\n     def test_create_experience_config_with_no_regions(\n         self, api_client: TestClient, url, generate_auth_header, db\n     ) -> None:\n@@ -487,7 +520,7 @@ def test_create_experience_config_with_no_regions(\n                 \"component\": \"privacy_center\",\n                 \"description\": \"We take your company's privacy seriously\",\n                 \"privacy_policy_link_label\": \"Manage your privacy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"reject_button_label\": \"No\",\n                 \"save_button_label\": \"Save\",\n                 \"title\": \"Manage your privacy\",\n@@ -503,7 +536,7 @@ def test_create_experience_config_with_no_regions(\n             resp[\"description\"] == \"We take your company's privacy seriously\"\n         )  # Returned in the response, unescaped, for display\n         assert resp[\"privacy_policy_link_label\"] == \"Manage your privacy\"\n-        assert resp[\"privacy_policy_url\"] == \"example.com/privacy\"\n+        assert resp[\"privacy_policy_url\"] == \"http://example.com/privacy\"\n         assert resp[\"regions\"] == []\n         assert resp[\"reject_button_label\"] == \"No\"\n         assert resp[\"save_button_label\"] == \"Save\"\n@@ -551,7 +584,7 @@ def test_create_experience_config_with_empty_regions(\n                 \"component\": \"privacy_center\",\n                 \"description\": \"We take your privacy seriously\",\n                 \"privacy_policy_link_label\": \"Manage your privacy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"regions\": [],\n                 \"reject_button_label\": \"No\",\n                 \"save_button_label\": \"Save\",\n@@ -566,7 +599,7 @@ def test_create_experience_config_with_empty_regions(\n         assert resp[\"component\"] == \"privacy_center\"\n         assert resp[\"description\"] == \"We take your privacy seriously\"\n         assert resp[\"privacy_policy_link_label\"] == \"Manage your privacy\"\n-        assert resp[\"privacy_policy_url\"] == \"example.com/privacy\"\n+        assert resp[\"privacy_policy_url\"] == \"http://example.com/privacy\"\n         assert resp[\"regions\"] == []\n         assert resp[\"reject_button_label\"] == \"No\"\n         assert resp[\"save_button_label\"] == \"Save\"\n@@ -624,7 +657,7 @@ def test_create_experience_config_no_existing_experiences(\n                 \"description\": \"We care about your privacy. Opt in and opt out of the data use cases below.\",\n                 \"privacy_preferences_link_label\": \"Control your privacy\",\n                 \"privacy_policy_link_label\": \"Control your privacy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"regions\": [\"us_ny\"],\n                 \"reject_button_label\": \"Reject all\",\n                 \"save_button_label\": \"Save\",\n@@ -645,7 +678,7 @@ def test_create_experience_config_no_existing_experiences(\n         )\n         assert resp[\"privacy_preferences_link_label\"] == \"Control your privacy\"\n         assert resp[\"privacy_policy_link_label\"] == \"Control your privacy\"\n-        assert resp[\"privacy_policy_url\"] == \"example.com/privacy\"\n+        assert resp[\"privacy_policy_url\"] == \"http://example.com/privacy\"\n         assert resp[\"regions\"] == [\"us_ny\"]\n         assert resp[\"reject_button_label\"] == \"Reject all\"\n         assert resp[\"save_button_label\"] == \"Save\"\n@@ -667,7 +700,7 @@ def test_create_experience_config_no_existing_experiences(\n             experience_config.privacy_preferences_link_label == \"Control your privacy\"\n         )\n         assert experience_config.privacy_policy_link_label == \"Control your privacy\"\n-        assert experience_config.privacy_policy_url == \"example.com/privacy\"\n+        assert experience_config.privacy_policy_url == \"http://example.com/privacy\"\n         assert experience_config.regions == [PrivacyNoticeRegion.us_ny]\n         assert experience_config.reject_button_label == \"Reject all\"\n         assert experience_config.save_button_label == \"Save\"\n@@ -700,7 +733,9 @@ def test_create_experience_config_no_existing_experiences(\n             experience_config_history.privacy_policy_link_label\n             == \"Control your privacy\"\n         )\n-        assert experience_config_history.privacy_policy_url == \"example.com/privacy\"\n+        assert (\n+            experience_config_history.privacy_policy_url == \"http://example.com/privacy\"\n+        )\n         assert experience_config_history.reject_button_label == \"Reject all\"\n         assert experience_config_history.save_button_label == \"Save\"\n         assert experience_config_history.title == \"Control your privacy\"\n@@ -758,7 +793,7 @@ def test_create_experience_config_existing_experiences(\n                 \"description\": \"We care about your privacy. Opt in and opt out of the data use cases below.\",\n                 \"privacy_preferences_link_label\": \"Control your privacy\",\n                 \"privacy_policy_link_label\": \"Control your privacy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"regions\": [\"us_tx\"],\n                 \"reject_button_label\": \"Reject all\",\n                 \"save_button_label\": \"Save\",\n@@ -779,7 +814,7 @@ def test_create_experience_config_existing_experiences(\n         )\n         assert resp[\"privacy_preferences_link_label\"] == \"Control your privacy\"\n         assert resp[\"privacy_policy_link_label\"] == \"Control your privacy\"\n-        assert resp[\"privacy_policy_url\"] == \"example.com/privacy\"\n+        assert resp[\"privacy_policy_url\"] == \"http://example.com/privacy\"\n         assert resp[\"regions\"] == [\"us_tx\"]\n         assert resp[\"reject_button_label\"] == \"Reject all\"\n         assert resp[\"save_button_label\"] == \"Save\"\n@@ -957,7 +992,7 @@ def overlay_experience_config(self, db) -> PrivacyExperienceConfig:\n                 \"disabled\": False,\n                 \"privacy_preferences_link_label\": \"Manage preferences\",\n                 \"privacy_policy_link_label\": \"View our privacy policy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"reject_button_label\": \"Reject all\",\n                 \"save_button_label\": \"Save\",\n                 \"title\": \"Control your privacy\","
        },
        {
          "filename": "tests/ops/api/v1/endpoints/test_privacy_preference_endpoints.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2073,7 +2073,7 @@ def test_get_historical_preferences(\n         assert response_body[\"user_geography\"] == \"us_ca\"\n         assert response_body[\"relevant_systems\"] == [system.fides_key]\n         assert response_body[\"affected_system_status\"] == {system.fides_key: \"complete\"}\n-        assert response_body[\"url_recorded\"] == \"example.com/privacy_center\"\n+        assert response_body[\"url_recorded\"] == \"https://example.com/privacy_center\"\n         assert (\n             response_body[\"user_agent\"]\n             == \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\""
        },
        {
          "filename": "tests/ops/models/test_privacy_experience.py",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -47,7 +47,7 @@ def test_create_privacy_experience_config(self, db):\n                 \"description\": \"We care about your privacy. Opt in and opt out of the data use cases below.\",\n                 \"privacy_preferences_link_label\": \"Manage preferences\",\n                 \"privacy_policy_link_label\": \"View our privacy policy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"reject_button_label\": \"Reject all\",\n                 \"save_button_label\": \"Save\",\n                 \"title\": \"Control your privacy\",\n@@ -66,7 +66,7 @@ def test_create_privacy_experience_config(self, db):\n         assert config.is_default is False\n         assert config.privacy_preferences_link_label == \"Manage preferences\"\n         assert config.privacy_policy_link_label == \"View our privacy policy\"\n-        assert config.privacy_policy_url == \"example.com/privacy\"\n+        assert config.privacy_policy_url == \"http://example.com/privacy\"\n         assert config.reject_button_label == \"Reject all\"\n         assert config.save_button_label == \"Save\"\n         assert config.title == \"Control your privacy\"\n@@ -91,7 +91,7 @@ def test_create_privacy_experience_config(self, db):\n         assert history.is_default is False\n         assert history.privacy_preferences_link_label == \"Manage preferences\"\n         assert history.privacy_policy_link_label == \"View our privacy policy\"\n-        assert history.privacy_policy_url == \"example.com/privacy\"\n+        assert history.privacy_policy_url == \"http://example.com/privacy\"\n         assert history.reject_button_label == \"Reject all\"\n         assert history.save_button_label == \"Save\"\n         assert history.title == \"Control your privacy\"\n@@ -112,7 +112,7 @@ def test_update_privacy_experience_config(self, db):\n                 \"description\": \"We care about your privacy. Opt in and opt out of the data use cases below.\",\n                 \"privacy_preferences_link_label\": \"Manage preferences\",\n                 \"privacy_policy_link_label\": \"View our privacy policy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"reject_button_label\": \"Reject all\",\n                 \"save_button_label\": \"Save\",\n                 \"title\": \"Control your privacy\",\n@@ -473,7 +473,7 @@ def test_get_should_show_banner(self, db):\n                 \"description\": \"We care about your privacy. Opt in and opt out of the data use cases below.\",\n                 \"privacy_preferences_link_label\": \"Manage preferences\",\n                 \"privacy_policy_link_label\": \"View our privacy policy\",\n-                \"privacy_policy_url\": \"example.com/privacy\",\n+                \"privacy_policy_url\": \"http://example.com/privacy\",\n                 \"reject_button_label\": \"Reject all\",\n                 \"save_button_label\": \"Save\",\n                 \"title\": \"Control your privacy\","
        },
        {
          "filename": "tests/ops/models/test_privacy_preference.py",
          "status": "modified",
          "additions": 17,
          "deletions": 11,
          "patch": "@@ -136,7 +136,7 @@ def test_create_privacy_preference_for_notice(\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"https://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -194,7 +194,10 @@ def test_create_privacy_preference_for_notice(\n             == \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\"\n         )\n         assert preference_history_record.user_geography == \"us_ca\"\n-        assert preference_history_record.url_recorded == \"example.com/privacy_center\"\n+        assert (\n+            preference_history_record.url_recorded\n+            == \"http://example.com/privacy_center\"\n+        )\n \n         # Assert PrivacyRequest.privacy_preferences relationship\n         assert privacy_request.privacy_preferences == []\n@@ -237,7 +240,7 @@ def test_create_privacy_preference_for_notice(\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -662,7 +665,7 @@ def test_create_history_and_upsert_current_preferences(\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -758,7 +761,7 @@ def test_consolidate_current_privacy_preferences(self, db, privacy_notice):\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -818,7 +821,7 @@ def test_consolidate_current_privacy_preferences(self, db, privacy_notice):\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -860,7 +863,7 @@ def test_consolidate_current_privacy_preferences(self, db, privacy_notice):\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -1076,7 +1079,7 @@ def test_update_current_privacy_preferences_fides_id_only(\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -1110,7 +1113,7 @@ def test_update_current_privacy_preferences_fides_id_only(\n                 \"secondary_user_ids\": {\"ga_client_id\": \"test\"},\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_ca\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n             },\n             check_name=False,\n         )\n@@ -1867,7 +1870,7 @@ def test_create_served_notice_history_for_notice(\n                 \"request_origin\": \"privacy_center\",\n                 \"user_agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\",\n                 \"user_geography\": \"us_co\",\n-                \"url_recorded\": \"example.com/privacy_center\",\n+                \"url_recorded\": \"http://example.com/privacy_center\",\n                 \"acknowledge_mode\": False,\n                 \"serving_component\": ServingComponent.privacy_center,\n                 \"privacy_experience_id\": privacy_experience_privacy_center.id,\n@@ -1914,7 +1917,10 @@ def test_create_served_notice_history_for_notice(\n             == \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/324.42 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/425.24\"\n         )\n         assert served_notice_history_record.user_geography == \"us_co\"\n-        assert served_notice_history_record.url_recorded == \"example.com/privacy_center\"\n+        assert (\n+            served_notice_history_record.url_recorded\n+            == \"http://example.com/privacy_center\"\n+        )\n \n         # Assert ServedNoticeHistory record upserted\n         last_served_notice = served_notice_history_record.last_served_record"
        },
        {
          "filename": "tests/ops/util/test_consent_util.py",
          "status": "modified",
          "additions": 17,
          "deletions": 6,
          "patch": "@@ -1,3 +1,4 @@\n+\"\"\"Test consent utils\"\"\"\n from __future__ import annotations\n \n from html import unescape\n@@ -1051,7 +1052,7 @@ def default_overlay_config_data(self, db):\n             \"id\": \"test_id\",\n             \"privacy_preferences_link_label\": \"D\",\n             \"privacy_policy_link_label\": \"E's label\",\n-            \"privacy_policy_url\": \"F\",\n+            \"privacy_policy_url\": \"https://example.com/privacy_policy\",\n             \"reject_button_label\": \"G\",\n             \"save_button_label\": \"H\",\n             \"title\": \"I\",\n@@ -1075,7 +1076,9 @@ def test_create_default_experience_config(self, db, default_overlay_config_data)\n         assert (\n             experience_config.privacy_policy_link_label == \"E&#x27;s label\"\n         )  # Escaped\n-        assert experience_config.privacy_policy_url == \"F\"\n+        assert (\n+            experience_config.privacy_policy_url == \"https://example.com/privacy_policy\"\n+        )\n         assert experience_config.regions == []\n         assert experience_config.reject_button_label == \"G\"\n         assert experience_config.save_button_label == \"H\"\n@@ -1101,7 +1104,7 @@ def test_create_default_experience_config(self, db, default_overlay_config_data)\n         assert history.id != \"test_id\"\n         assert history.privacy_preferences_link_label == \"D\"\n         assert history.privacy_policy_link_label == \"E&#x27;s label\"\n-        assert history.privacy_policy_url == \"F\"\n+        assert history.privacy_policy_url == \"https://example.com/privacy_policy\"\n         assert history.reject_button_label == \"G\"\n         assert history.save_button_label == \"H\"\n         assert history.title == \"I\"\n@@ -1141,7 +1144,9 @@ def test_default_experience_config_data_has_changed(\n         )\n         assert experience_config is not None\n \n-        default_overlay_config_data[\"privacy_policy_url\"] = \"example.com/privacy_policy\"\n+        default_overlay_config_data[\n+            \"privacy_policy_url\"\n+        ] = \"https://test_example.com/privacy_policy\"\n \n         resp = create_default_experience_config(db, default_overlay_config_data)\n         assert resp is None\n@@ -1150,15 +1155,21 @@ def test_default_experience_config_data_has_changed(\n \n         # Data has changed but we didn't update existing config\n         assert experience_config.version == 1.0\n-        assert experience_config.privacy_policy_url != \"example.com/privacy_policy\"\n+        assert (\n+            experience_config.privacy_policy_url\n+            != \"https://test_example.com/privacy_policy\"\n+        )\n         assert experience_config.histories.count() == 1\n \n         assert experience_config.experience_config_history_id is not None\n         assert experience_config.experience_config_history_id != \"test_id\"\n         history = experience_config.histories[0]\n \n         assert history.version == 1.0\n-        assert experience_config.privacy_policy_url != \"example.com/privacy_policy\"\n+        assert (\n+            experience_config.privacy_policy_url\n+            != \"https://test_example.com/privacy_policy\"\n+        )\n \n         history.delete(db)\n         experience_config.delete(db)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 6,
        "unique_directories": 5,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a51da8fc111d2b2dad6dcd48e455f6a6804e1c54",
            "date": "2025-01-23T01:06:09Z",
            "author_login": "JadeCara"
          },
          {
            "sha": "1174c2c31153f92fc6b07b955b62a2d1832b240e",
            "date": "2025-01-22T22:03:02Z",
            "author_login": "lucanovera"
          },
          {
            "sha": "abbb24e8d40e82c6cbe331693c85efc8ff43aa59",
            "date": "2025-01-22T19:28:53Z",
            "author_login": "thingscouldbeworse"
          },
          {
            "sha": "bbba31d7fe61655665653fea2b88b635adea102c",
            "date": "2025-01-21T20:16:26Z",
            "author_login": "adamsachs"
          },
          {
            "sha": "7043171c4d6f3564c93e39b48abf9f53f6af0dbe",
            "date": "2025-01-20T21:07:10Z",
            "author_login": "Vagoasdf"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "Fides is an open-source privacy engineering platform for managing the fulfillment of data privacy requests in runtime environments, helping enforce privacy regulations in code. The Fides web application allows users to edit consent and privacy notices such as cookie banners. The vulnerability makes it possible to craft a payload in the privacy policy URL which triggers JavaScript execution when the privacy notice is served by an integrated website. The domain scope of the executed JavaScript is that of the integrated website. Exploitation is limited to Admin UI users with the contributor role or higher. The vulnerability has been patched in Fides version `2.22.1`. ",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-10-25T18:17:36.537",
    "last_modified": "2024-11-21T08:27:56.063",
    "fix_date": "2023-10-22T23:07:23Z"
  },
  "references": [
    {
      "url": "https://github.com/ethyca/fides/commit/3231d19699f9c895c986f6a967a64d882769c506",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/releases/tag/2.22.1",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/security/advisories/GHSA-fgjj-5jmr-gh83",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/commit/3231d19699f9c895c986f6a967a64d882769c506",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/releases/tag/2.22.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/security/advisories/GHSA-fgjj-5jmr-gh83",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.940231",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "fides",
    "owner": "ethyca",
    "created_at": "2021-02-04T22:42:33Z",
    "updated_at": "2025-01-24T10:02:27Z",
    "pushed_at": "2025-01-24T16:30:49Z",
    "size": 111165,
    "stars": 385,
    "forks": 74,
    "open_issues": 278,
    "watchers": 385,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 7135477,
      "TypeScript": 4467849,
      "CSS": 38461,
      "JavaScript": 32908,
      "HTML": 32388,
      "SCSS": 15015,
      "Dockerfile": 4511,
      "Jinja": 3618,
      "Mako": 494
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:40:51.642007"
  }
}