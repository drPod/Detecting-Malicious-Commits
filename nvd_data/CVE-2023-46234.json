{
  "cve_id": "CVE-2023-46234",
  "github_data": {
    "repository": "browserify/browserify-sign",
    "fix_commit": "85994cd6348b50f2fd1b73c54e20881416f44a30",
    "related_commits": [
      "85994cd6348b50f2fd1b73c54e20881416f44a30",
      "85994cd6348b50f2fd1b73c54e20881416f44a30"
    ],
    "patch_url": "https://github.com/browserify/browserify-sign/commit/85994cd6348b50f2fd1b73c54e20881416f44a30.patch",
    "fix_commit_details": {
      "sha": "85994cd6348b50f2fd1b73c54e20881416f44a30",
      "commit_date": "2023-10-21T05:08:48Z",
      "author": {
        "login": "roadicing",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[Fix] properly check the upper bound for DSA signatures",
        "length": 154,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 33,
        "deletions": 1
      },
      "files": [
        {
          "filename": "browser/verify.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -80,7 +80,7 @@ function dsaVerify(sig, hash, pub) {\n \n function checkValue(b, q) {\n   if (b.cmpn(0) <= 0) { throw new Error('invalid sig'); }\n-  if (b.cmp(q) >= q) { throw new Error('invalid sig'); }\n+  if (b.cmp(q) >= 0) { throw new Error('invalid sig'); }\n }\n \n module.exports = verify;"
        },
        {
          "filename": "test/index.js",
          "status": "modified",
          "additions": 32,
          "deletions": 0,
          "patch": "@@ -5,6 +5,9 @@ var asn1 = require('parse-asn1/asn1');\n var test = require('tape').test;\n var nCrypto = require('crypto');\n var semver = require('semver');\n+var BN = require('bn.js');\n+var parseKeys = require('parse-asn1');\n+\n var bCrypto = require('../browser');\n var fixtures = require('./fixtures');\n \n@@ -154,6 +157,35 @@ fixtures.valid.ec.forEach(function (f) {\n       t.end();\n     });\n   }\n+\n+  var s = parseKeys(pub).data.q;\n+  test(\n+    f.message + ' against a fake signature',\n+    { skip: !s || '(this test only applies to DSA signatures and not EC signatures, this is ' + f.scheme + ')' },\n+    function (t) {\n+      var messageBase64 = Buffer.from(f.message, 'base64');\n+\n+      // forge a fake signature\n+      var r = new BN('1');\n+\n+      try {\n+        var fakeSig = asn1.signature.encode({ r: r, s: s }, 'der');\n+      } catch (e) {\n+        t.ifError(e);\n+        t.end();\n+        return;\n+      }\n+\n+      var bVer = bCrypto.createVerify(f.scheme);\n+      t['throws'](\n+        function () { bVer.update(messageBase64).verify(pub, fakeSig); },\n+        Error,\n+        'fake signature is invalid'\n+      );\n+\n+      t.end();\n+    }\n+  );\n });\n \n fixtures.valid.kvectors.forEach(function (f) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bf2c3ec8fa046a52420ccd322186cc477d82165c",
            "date": "2024-03-05T17:35:35Z",
            "author_login": "ljharb"
          },
          {
            "sha": "9247adfd261ededfec1c036c9d8f36c4e9f87c0e",
            "date": "2024-03-05T17:03:05Z",
            "author_login": "ljharb"
          },
          {
            "sha": "f427270ac11dc6be29f87d7afb046c16376a5a9c",
            "date": "2024-03-05T08:03:48Z",
            "author_login": "ljharb"
          },
          {
            "sha": "87f3a35a587b377da2c1987af8d41c57b5afe0a5",
            "date": "2024-03-05T08:03:33Z",
            "author_login": "ljharb"
          },
          {
            "sha": "fb261cea57f92b3d98bc4d8bc6228c43a5de2e91",
            "date": "2024-03-05T06:55:36Z",
            "author_login": "ljharb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-347",
    "description": "browserify-sign is a package to duplicate the functionality of node's crypto public key functions, much of this is based on Fedor Indutny's work on indutny/tls.js. An upper bound check issue in `dsaVerify` function allows an attacker to construct signatures that can be successfully verified by any public key, thus leading to a signature forgery attack. All places in this project that involve DSA verification of user-input signatures will be affected by this vulnerability. This issue has been patched in version 4.2.2.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-26T15:15:09.087",
    "last_modified": "2024-11-21T08:28:08.000",
    "fix_date": "2023-10-21T05:08:48Z"
  },
  "references": [
    {
      "url": "https://github.com/browserify/browserify-sign/commit/85994cd6348b50f2fd1b73c54e20881416f44a30",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/browserify/browserify-sign/security/advisories/GHSA-x9w5-v3q2-3rhw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00040.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3HUE6ZR5SL73KHL7XUPAOEL6SB7HUDT2/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6PVVPNSAGSDS63HQ74PJ7MZ3MU5IYNVZ/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5539",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/browserify/browserify-sign/commit/85994cd6348b50f2fd1b73c54e20881416f44a30",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/browserify/browserify-sign/security/advisories/GHSA-x9w5-v3q2-3rhw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00040.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3HUE6ZR5SL73KHL7XUPAOEL6SB7HUDT2/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/6PVVPNSAGSDS63HQ74PJ7MZ3MU5IYNVZ/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.debian.org/security/2023/dsa-5539",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.954765",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "browserify-sign",
    "owner": "browserify",
    "created_at": "2014-11-14T21:45:42Z",
    "updated_at": "2024-11-04T18:47:22Z",
    "pushed_at": "2024-12-21T10:15:30Z",
    "size": 245,
    "stars": 45,
    "forks": 62,
    "open_issues": 5,
    "watchers": 45,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "JavaScript": 15908
    },
    "commit_activity": {
      "total_commits_last_year": 9,
      "avg_commits_per_week": 0.17307692307692307,
      "days_active_last_year": 2
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "isc"
    },
    "collected_at": "2025-01-14T21:11:42.446638"
  }
}