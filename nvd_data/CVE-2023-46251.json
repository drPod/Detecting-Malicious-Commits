{
  "cve_id": "CVE-2023-46251",
  "github_data": {
    "repository": "mybb/mybb",
    "fix_commit": "6dcaf0b4db6254f1833fe8dae295d9ddc2219276",
    "related_commits": [
      "6dcaf0b4db6254f1833fe8dae295d9ddc2219276",
      "6dcaf0b4db6254f1833fe8dae295d9ddc2219276"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "6dcaf0b4db6254f1833fe8dae295d9ddc2219276",
      "commit_date": "2023-11-04T17:33:47Z",
      "author": {
        "login": "dvz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix Visual editor size code persistent XSS",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 26,
        "deletions": 5
      },
      "files": [
        {
          "filename": "admin/modules/user/users.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -943,7 +943,7 @@\n \n \t<link rel=\"stylesheet\" href=\"../jscripts/sceditor/themes/mybb.css\" type=\"text/css\" media=\"all\" />\n \t<script type=\"text/javascript\" src=\"../jscripts/sceditor/jquery.sceditor.bbcode.min.js?ver=1832\"></script>\n-\t<script type=\"text/javascript\" src=\"../jscripts/bbcodes_sceditor.js?ver=1832\"></script>\n+\t<script type=\"text/javascript\" src=\"../jscripts/bbcodes_sceditor.js?ver=1837\"></script>\n \t<script type=\"text/javascript\" src=\"../jscripts/sceditor/plugins/undo.js?ver=1832\"></script>\n EOF;\n \t$page->output_header($lang->edit_user);"
        },
        {
          "filename": "install/resources/mybb_theme.xml",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -1,5 +1,5 @@\n <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-<theme name=\"MyBB Master Style\" version=\"1834\">\n+<theme name=\"MyBB Master Style\" version=\"1837\">\n \t<properties>\n \t\t<templateset><![CDATA[1]]></templateset>\n \t\t<imgdir><![CDATA[images]]></imgdir>\n@@ -14159,9 +14159,9 @@ if(use_xmlhttprequest == \"1\")\n <td class=\"trow1\" width=\"20%\"><strong>{$lang->username}</strong></td>\n <td class=\"trow1\">{$mybb->user['username']} <span class=\"smalltext\">[<strong><a href=\"member.php?action=logout&amp;logoutkey={$mybb->user['logoutkey']}\">{$lang->change_user}</a></strong>]</span></td>\n </tr>]]></template>\n-\t\t<template name=\"codebuttons\" version=\"1832\"><![CDATA[<link rel=\"stylesheet\" href=\"{$mybb->asset_url}/jscripts/sceditor/themes/{$theme['editortheme']}\" type=\"text/css\" media=\"all\" />\n+\t\t<template name=\"codebuttons\" version=\"1837\"><![CDATA[<link rel=\"stylesheet\" href=\"{$mybb->asset_url}/jscripts/sceditor/themes/{$theme['editortheme']}\" type=\"text/css\" media=\"all\" />\n <script type=\"text/javascript\" src=\"{$mybb->asset_url}/jscripts/sceditor/jquery.sceditor.bbcode.min.js?ver=1832\"></script>\n-<script type=\"text/javascript\" src=\"{$mybb->asset_url}/jscripts/bbcodes_sceditor.js?ver=1832\"></script>\n+<script type=\"text/javascript\" src=\"{$mybb->asset_url}/jscripts/bbcodes_sceditor.js?ver=1837\"></script>\n <script type=\"text/javascript\" src=\"{$mybb->asset_url}/jscripts/sceditor/plugins/undo.js?ver=1832\"></script>\n <script type=\"text/javascript\">\n var partialmode = {$mybb->settings['partialmode']},"
        },
        {
          "filename": "install/resources/upgrade58.php",
          "status": "added",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -0,0 +1,21 @@\n+<?php\n+/**\n+ * MyBB 1.8\n+ * Copyright 2014 MyBB Group, All Rights Reserved\n+ *\n+ * Website: http://www.mybb.com\n+ * License: http://www.mybb.com/about/license\n+ *\n+ */\n+\n+/**\n+ * Upgrade Script: 1.8.34, 1.8.35 or 1.8.36\n+ */\n+\n+$upgrade_detail = array(\n+    \"revert_all_templates\" => 0,\n+    \"revert_all_themes\" => 0,\n+    \"revert_all_settings\" => 0\n+);\n+\n+/* Nothing to do for 1.8.34, 1.8.35 or 1.8.36 */"
        },
        {
          "filename": "jscripts/bbcodes_sceditor.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -181,7 +181,7 @@ $(function ($) {\n \t\t\t\tunits = \"\",\n \t\t\t\tparsed = parseInt(attrs.defaultattr, 10);\n \t\t\tif (!isNaN(parsed)) {\n-\t\t\t\tsize = attrs.defaultattr;\n+\t\t\t\tsize = parsed;\n \t\t\t\tif (size < 1) {\n \t\t\t\t\tsize = 1;\n \t\t\t\t} else if (size > 50) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "16437f8e607508be35f8dd6c49daaba8dbfc6ca3",
            "date": "2024-12-23T04:50:58Z",
            "author_login": "Sama34"
          },
          {
            "sha": "7d69ba59c2f6cdadde455a53c9c1ff654901ed75",
            "date": "2024-10-21T12:32:15Z",
            "author_login": "Mai-Lapyst"
          },
          {
            "sha": "270b8d48f057a9877b87950a74400daf98d3b92b",
            "date": "2024-10-07T20:21:08Z",
            "author_login": "Eldenroot"
          },
          {
            "sha": "a234d39231d0695102f36fe074003c6cd154864f",
            "date": "2024-08-07T22:59:18Z",
            "author_login": "Sama34"
          },
          {
            "sha": "0a2128d503c39e85e00b7208a40ec41d6dd31e86",
            "date": "2024-07-24T00:27:03Z",
            "author_login": "kikelkik"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-79",
    "description": " MyBB is a free and open source forum software. Custom MyCode (BBCode) for the visual editor (_SCEditor_) doesn't escape input properly when rendering HTML, resulting in a DOM-based XSS vulnerability. This weakness can be exploited by pointing a victim to a page where the visual editor is active (e.g. as a post or Private Message) and operates on a maliciously crafted MyCode message. This may occur on pages where message content is pre-filled using a GET/POST parameter, or on reply pages where a previously saved malicious message is quoted. The impact is be mitigated when: 1. the visual editor is disabled globally (_Admin CP \u2192 Configuration \u2192 Settings \u2192 Clickable Smilies and BB Code: [Clickable MyCode Editor](https://github.com/mybb/mybb/blob/mybb_1836/install/resources/settings.xml#L2087-L2094)_ is set to _Off_), or 2. the visual editor is disabled for individual user accounts (_User CP \u2192 Your Profile \u2192 Edit Options_: _Show the MyCode formatting options on the posting pages_ checkbox is not checked). MyBB 1.8.37 resolves this issue with the commit `6dcaf0b4d`. Users are advised to upgrade. Users unable to upgrade may mitigate the impact without upgrading MyBB by changing the following setting (_Admin CP \u2192 Configuration \u2192 Settings_):\n- _Clickable Smilies and BB Code \u2192 [Clickable MyCode Editor](https://github.com/mybb/mybb/blob/mybb_1836/install/resources/settings.xml#L2087-L2094)_: _Off_. Similarly, individual MyBB forum users are able to disable the visual editor by diabling the account option (_User CP \u2192 Your Profile \u2192 Edit Options_) _Show the MyCode formatting options on the posting pages_.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-11-06T18:15:08.547",
    "last_modified": "2024-11-21T08:28:10.273",
    "fix_date": "2023-11-04T17:33:47Z"
  },
  "references": [
    {
      "url": "https://github.com/mybb/mybb/commit/6dcaf0b4db6254f1833fe8dae295d9ddc2219276",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mybb/mybb/security/advisories/GHSA-wj33-q7vj-9fr8",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://mybb.com/versions/1.8.37/",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/mybb/mybb/commit/6dcaf0b4db6254f1833fe8dae295d9ddc2219276",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mybb/mybb/security/advisories/GHSA-wj33-q7vj-9fr8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://mybb.com/versions/1.8.37/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.990644",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "mybb",
    "owner": "mybb",
    "created_at": "2012-06-13T10:34:46Z",
    "updated_at": "2025-01-15T16:04:48Z",
    "pushed_at": "2025-01-18T19:01:58Z",
    "size": 42007,
    "stars": 1103,
    "forks": 410,
    "open_issues": 324,
    "watchers": 1103,
    "has_security_policy": false,
    "default_branch": "feature",
    "protected_branches": [],
    "languages": {
      "PHP": 5603696,
      "JavaScript": 144087,
      "CSS": 68455,
      "HTML": 14057
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-3.0"
    },
    "collected_at": "2025-01-26T07:34:11.209074"
  }
}