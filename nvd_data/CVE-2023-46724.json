{
  "cve_id": "CVE-2023-46724",
  "github_data": {
    "repository": "squid-cache/squid",
    "fix_commit": "b70f864940225dfe69f9f653f948e787f99c3810",
    "related_commits": [
      "b70f864940225dfe69f9f653f948e787f99c3810",
      "b70f864940225dfe69f9f653f948e787f99c3810"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b70f864940225dfe69f9f653f948e787f99c3810",
      "commit_date": "2023-10-18T04:14:31Z",
      "author": {
        "login": "sp-andwei",
        "type": "User",
        "stats": {
          "total_commits": 3,
          "average_weekly_commits": 0.0033975084937712344,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 3
        }
      },
      "commit_message": {
        "title": "Fix validation of certificates with CN=* (#1523)",
        "length": 216,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/anyp/Uri.cc",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -175,6 +175,10 @@ urlInitialize(void)\n     assert(0 == matchDomainName(\"*.foo.com\", \".foo.com\", mdnHonorWildcards));\n     assert(0 != matchDomainName(\"*.foo.com\", \"foo.com\", mdnHonorWildcards));\n \n+    assert(0 != matchDomainName(\"foo.com\", \"\"));\n+    assert(0 != matchDomainName(\"foo.com\", \"\", mdnHonorWildcards));\n+    assert(0 != matchDomainName(\"foo.com\", \"\", mdnRejectSubsubDomains));\n+\n     /* more cases? */\n }\n \n@@ -828,6 +832,8 @@ matchDomainName(const char *h, const char *d, MatchDomainNameFlags flags)\n         return -1;\n \n     dl = strlen(d);\n+    if (dl == 0)\n+        return 1;\n \n     /*\n      * Start at the ends of the two strings and work towards the"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "53ed1a918f0d75ccef6fa0b7d988225ec8b2015e",
            "date": "2025-01-21T13:19:47Z",
            "author_login": "eduard-bagdasaryan"
          },
          {
            "sha": "d2437a2f9a0d133d31701b2fe03b6fa8029e5f5a",
            "date": "2025-01-17T17:08:18Z",
            "author_login": "huaraz"
          },
          {
            "sha": "83c501d1bae3eb56b013870bf8c4cce2826a87c0",
            "date": "2025-01-15T07:49:13Z",
            "author_login": "kinkie"
          },
          {
            "sha": "8c77c4b24bea35013ec3818a1260f94133d39e94",
            "date": "2025-01-14T19:22:36Z",
            "author_login": "rousskov"
          },
          {
            "sha": "a14169990e66a0622165ea3f16712b58621e48f3",
            "date": "2025-01-13T19:53:36Z",
            "author_login": "eduard-bagdasaryan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
    "cwe_id": "CWE-125",
    "description": " Squid is a caching proxy for the Web. Due to an Improper Validation of Specified Index bug, Squid versions 3.3.0.1 through 5.9 and 6.0 prior to 6.4 compiled using `--with-openssl` are vulnerable to a Denial of Service attack against SSL Certificate validation. This problem allows a remote server to perform Denial of Service against Squid Proxy by initiating a TLS Handshake with a specially crafted SSL Certificate in a server certificate chain. This attack is limited to HTTPS and SSL-Bump. This bug is fixed in Squid version 6.4. In addition, patches addressing this problem for the stable releases can be found in Squid's patch archives. Those who you use a prepackaged version of Squid should refer to the package vendor for availability information on updated packages.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-01T20:15:08.800",
    "last_modified": "2024-11-21T08:29:09.497",
    "fix_date": "2023-10-18T04:14:31Z"
  },
  "references": [
    {
      "url": "http://www.squid-cache.org/Versions/v5/SQUID-2023_4.patch",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.squid-cache.org/Versions/v6/SQUID-2023_4.patch",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/commit/b70f864940225dfe69f9f653f948e787f99c3810",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/security/advisories/GHSA-73m6-jm96-c6r3",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A5QASTMCUSUEW3UOMKHZJB3FTONWSRXS/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MEV66D3PAAY6K7TWDT3WZBLCPLASFJDC/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20231208-0001/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "http://www.squid-cache.org/Versions/v5/SQUID-2023_4.patch",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "http://www.squid-cache.org/Versions/v6/SQUID-2023_4.patch",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/commit/b70f864940225dfe69f9f653f948e787f99c3810",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/security/advisories/GHSA-73m6-jm96-c6r3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A5QASTMCUSUEW3UOMKHZJB3FTONWSRXS/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MEV66D3PAAY6K7TWDT3WZBLCPLASFJDC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20231208-0001/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.978642",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "squid",
    "owner": "squid-cache",
    "created_at": "2014-09-27T00:59:40Z",
    "updated_at": "2025-01-26T03:42:46Z",
    "pushed_at": "2025-01-22T16:05:14Z",
    "size": 177735,
    "stars": 2316,
    "forks": 532,
    "open_issues": 125,
    "watchers": 2316,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "SQUID_NT_3_0",
      "cbdatahistory",
      "master",
      "mswin",
      "v3.0",
      "v3.1",
      "v3.2",
      "v3.3",
      "v3.4",
      "v3.5",
      "v4",
      "v5",
      "v6"
    ],
    "languages": {
      "C++": 7975840,
      "C": 710305,
      "M4": 224515,
      "Makefile": 142513,
      "Perl": 119339,
      "Shell": 98209,
      "Roff": 70681,
      "Awk": 7112,
      "HTML": 2381,
      "CSS": 1791,
      "sed": 311
    },
    "commit_activity": {
      "total_commits_last_year": 219,
      "avg_commits_per_week": 4.211538461538462,
      "days_active_last_year": 149
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:02:33.571465"
  }
}