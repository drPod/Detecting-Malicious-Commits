{
  "cve_id": "CVE-2023-47100",
  "github_data": {
    "repository": "Perl/perl5",
    "fix_commit": "12c313ce49b36160a7ca2e9b07ad5bd92ee4a010",
    "related_commits": [
      "12c313ce49b36160a7ca2e9b07ad5bd92ee4a010",
      "7047915eef37fccd93e7cd985c29fe6be54650b6",
      "ff1f9f59360afeebd6f75ca1502f5c3ebf077da3",
      "12c313ce49b36160a7ca2e9b07ad5bd92ee4a010",
      "7047915eef37fccd93e7cd985c29fe6be54650b6",
      "ff1f9f59360afeebd6f75ca1502f5c3ebf077da3"
    ],
    "patch_url": "https://github.com/Perl/perl5/commit/12c313ce49b36160a7ca2e9b07ad5bd92ee4a010.patch",
    "fix_commit_details": {
      "sha": "12c313ce49b36160a7ca2e9b07ad5bd92ee4a010",
      "commit_date": "2023-09-09T17:59:09Z",
      "author": {
        "login": "khwilliamson",
        "type": "User",
        "stats": {
          "total_commits": 7842,
          "average_weekly_commits": 5.338325391422736,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 528
        }
      },
      "commit_message": {
        "title": "Fix read/write past buffer end: perl-security#140",
        "length": 2088,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 19,
        "deletions": 6
      },
      "files": [
        {
          "filename": "regcomp.c",
          "status": "modified",
          "additions": 11,
          "deletions": 6,
          "patch": "@@ -23879,7 +23879,7 @@ S_parse_uniprop_string(pTHX_\n      * compile perl to know about them) */\n     bool is_nv_type = FALSE;\n \n-    unsigned int i, j = 0;\n+    unsigned int i = 0, i_zero = 0, j = 0;\n     int equals_pos = -1;    /* Where the '=' is found, or negative if none */\n     int slash_pos  = -1;    /* Where the '/' is found, or negative if none */\n     int table_index = 0;    /* The entry number for this property in the table\n@@ -24013,9 +24013,13 @@ S_parse_uniprop_string(pTHX_\n      * all of them are considered to be for that package.  For the purposes of\n      * parsing the rest of the property, strip it off */\n     if (non_pkg_begin == STRLENs(\"utf8::\") && memBEGINPs(name, name_len, \"utf8::\")) {\n-        lookup_name +=  STRLENs(\"utf8::\");\n-        j -=  STRLENs(\"utf8::\");\n-        equals_pos -=  STRLENs(\"utf8::\");\n+        lookup_name += STRLENs(\"utf8::\");\n+        j           -= STRLENs(\"utf8::\");\n+        equals_pos  -= STRLENs(\"utf8::\");\n+        i_zero       = STRLENs(\"utf8::\");   /* When resetting 'i' to reparse\n+                                               from the beginning, it has to be\n+                                               set past what we're stripping\n+                                               off */\n         stripped_utf8_pkg = TRUE;\n     }\n \n@@ -24420,7 +24424,8 @@ S_parse_uniprop_string(pTHX_\n \n             /* We set the inputs back to 0 and the code below will reparse,\n              * using strict */\n-            i = j = 0;\n+            i = i_zero;\n+            j = 0;\n         }\n     }\n \n@@ -24441,7 +24446,7 @@ S_parse_uniprop_string(pTHX_\n          * separates two digits */\n         if (cur == '_') {\n             if (    stricter\n-                && (     i == 0 || (int) i == equals_pos || i == name_len- 1\n+                && (   i == i_zero || (int) i == equals_pos || i == name_len- 1\n                     || ! isDIGIT_A(name[i-1]) || ! isDIGIT_A(name[i+1])))\n             {\n                 lookup_name[j++] = '_';"
        },
        {
          "filename": "t/re/pat_advanced.t",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -2688,6 +2688,14 @@ EOF_DEBUG_OUT\n                       {}, \"Related to Github Issue #19350, forward \\\\g{x} pattern segv under use re Debug => 'PARSE'\");\n     }\n \n+    {   # perl-security#140, read/write past buffer end\n+        fresh_perl_like('qr/\\p{utf8::perl x}/',\n+                        qr/Illegal user-defined property name \"utf8::perl x\" in regex/,\n+                        {}, \"perl-security#140\");\n+        fresh_perl_is('qr/\\p{utf8::_perl_surrogate}/', \"\",\n+                        {}, \"perl-security#140\");\n+    }\n+\n \n     # !!! NOTE that tests that aren't at all likely to crash perl should go\n     # a ways above, above these last ones.  There's a comment there that, like"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "61978476912ee303cc78e7bf09602a4b38f3d75e",
            "date": "2024-12-12T22:09:05Z",
            "author_login": "richardleach"
          },
          {
            "sha": "a3a7684e4cf709f359f6dc550a9712044d24cfec",
            "date": "2024-12-05T15:19:41Z",
            "author_login": "richardleach"
          },
          {
            "sha": "cdbed2a40eb1292d5be2fd59c091cf78f6a4be69",
            "date": "2024-11-19T23:02:37Z",
            "author_login": "richardleach"
          },
          {
            "sha": "c107bb0b9c05a0ad0390ca4d42f0eaf567047bcd",
            "date": "2024-12-05T14:39:43Z",
            "author_login": "richardleach"
          },
          {
            "sha": "8282950bdf10676d19a19579594e95ab114da3d9",
            "date": "2025-01-13T18:47:15Z",
            "author_login": "khwilliamson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-755",
    "description": "In Perl before 5.38.2, S_parse_uniprop_string in regcomp.c can write to unallocated space because a property name associated with a \\p{...} regular expression construct is mishandled. The earliest affected version is 5.30.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-12-02T23:15:07.187",
    "last_modified": "2024-11-21T08:29:46.307",
    "fix_date": "2023-09-09T17:59:09Z"
  },
  "references": [
    {
      "url": "https://github.com/Perl/perl5/commit/12c313ce49b36160a7ca2e9b07ad5bd92ee4a010",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Perl/perl5/commit/7047915eef37fccd93e7cd985c29fe6be54650b6",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Perl/perl5/commit/ff1f9f59360afeebd6f75ca1502f5c3ebf077da3",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Perl/perl5/commit/12c313ce49b36160a7ca2e9b07ad5bd92ee4a010",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Perl/perl5/commit/7047915eef37fccd93e7cd985c29fe6be54650b6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Perl/perl5/commit/ff1f9f59360afeebd6f75ca1502f5c3ebf077da3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.306274",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "perl5",
    "owner": "Perl",
    "created_at": "2013-02-13T17:10:40Z",
    "updated_at": "2025-01-13T22:11:22Z",
    "pushed_at": "2025-01-13T22:11:17Z",
    "size": 348929,
    "stars": 2012,
    "forks": 560,
    "open_issues": 2322,
    "watchers": 2012,
    "has_security_policy": false,
    "default_branch": "blead",
    "protected_branches": [
      "blead"
    ],
    "languages": {
      "Perl": 28195339,
      "C": 11677742,
      "Shell": 1417210,
      "XS": 1235700,
      "DIGITAL Command Language": 232265,
      "C++": 201213,
      "Makefile": 136990,
      "Yacc": 54550,
      "PHP": 46851,
      "Roff": 26054,
      "Prolog": 24640,
      "Batchfile": 2696,
      "TeX": 1708,
      "DTrace": 491,
      "Emacs Lisp": 312
    },
    "commit_activity": {
      "total_commits_last_year": 1602,
      "avg_commits_per_week": 30.807692307692307,
      "days_active_last_year": 288
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:46:34.612146"
  }
}