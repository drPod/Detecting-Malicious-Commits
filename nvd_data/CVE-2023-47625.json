{
  "cve_id": "CVE-2023-47625",
  "github_data": {
    "repository": "PX4/PX4-Autopilot",
    "fix_commit": "d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa",
    "related_commits": [
      "d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa",
      "d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa"
    ],
    "patch_url": "https://github.com/PX4/PX4-Autopilot/commit/d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa.patch",
    "fix_commit_details": {
      "sha": "d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa",
      "commit_date": "2023-09-28T05:44:11Z",
      "author": {
        "login": "bkueng",
        "type": "User",
        "stats": {
          "total_commits": 2743,
          "average_weekly_commits": 4.213517665130568,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 357
        }
      },
      "commit_message": {
        "title": "fix crsf_rc: prevent potential buffer overflow for unknown packets",
        "length": 393,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/drivers/rc/crsf_rc/CrsfParser.cpp",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -293,9 +293,9 @@ bool CrsfParser_TryParseCrsfPacket(CrsfPacket_t *const new_packet, CrsfParserSta\n \t\t\t} else {\n \t\t\t\t// We don't know what this packet is, so we'll let the parser continue\n \t\t\t\t// just so that we can dequeue it in one shot\n-\t\t\t\tworking_segment_size = packet_size + PACKET_SIZE_TYPE_SIZE;\n+\t\t\t\tworking_segment_size = packet_size - PACKET_SIZE_TYPE_SIZE;\n \n-\t\t\t\tif (working_segment_size > CRSF_MAX_PACKET_LEN) {\n+\t\t\t\tif (working_index + working_segment_size + CRC_SIZE > CRSF_MAX_PACKET_LEN) {\n \t\t\t\t\tparser_statistics->invalid_unknown_packet_sizes++;\n \t\t\t\t\tparser_state = PARSER_STATE_HEADER;\n \t\t\t\t\tworking_segment_size = HEADER_SIZE;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bc92008885f82966578ec2484af6e0e8eae0d756",
            "date": "2024-12-17T20:02:51Z",
            "author_login": "MaEtUgR"
          },
          {
            "sha": "b584f8381c5ce7b004ba442c454d92339565214d",
            "date": "2024-12-17T19:54:20Z",
            "author_login": "MaEtUgR"
          },
          {
            "sha": "5e2848312d2a074bb6936be97b72712a237f58af",
            "date": "2024-12-17T18:28:20Z",
            "author_login": "MaEtUgR"
          },
          {
            "sha": "2506bd3b5dea49042fafe9aca4f16d23437a02c0",
            "date": "2024-12-16T17:39:15Z",
            "author_login": "MaEtUgR"
          },
          {
            "sha": "1c4325db6d299eb11454bcbbfdfa043ff4d188b8",
            "date": "2024-12-16T15:30:43Z",
            "author_login": "MaEtUgR"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.9,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-120",
    "description": "PX4 autopilot is a flight control solution for drones. In affected versions a global buffer overflow vulnerability exists in the CrsfParser_TryParseCrsfPacket function in /src/drivers/rc/crsf_rc/CrsfParser.cpp:298 due to the invalid size check. A malicious user may create an RC packet remotely and that packet goes into the device where the _rcs_buf reads. The global buffer overflow vulnerability will be triggered and the drone can behave unexpectedly. This issue has been addressed in version 1.14.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-11-13T21:15:08.513",
    "last_modified": "2024-11-21T08:30:33.243",
    "fix_date": "2023-09-28T05:44:11Z"
  },
  "references": [
    {
      "url": "https://github.com/PX4/PX4-Autopilot/commit/d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/PX4/PX4-Autopilot/security/advisories/GHSA-qpw7-65ww-wj82",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/PX4/PX4-Autopilot/commit/d1fcd39a44e6312582c6ab02b0d5ee2599fb55aa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/PX4/PX4-Autopilot/security/advisories/GHSA-qpw7-65ww-wj82",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.252572",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "PX4-Autopilot",
    "owner": "PX4",
    "created_at": "2012-08-04T21:19:36Z",
    "updated_at": "2025-01-14T11:52:52Z",
    "pushed_at": "2025-01-14T13:55:35Z",
    "size": 250595,
    "stars": 8772,
    "forks": 13635,
    "open_issues": 1979,
    "watchers": 8772,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "beta"
    ],
    "languages": {
      "C++": 19396080,
      "C": 15259793,
      "CMake": 1669279,
      "Python": 1396154,
      "Shell": 430627,
      "EmberScript": 40951,
      "Makefile": 29111,
      "HTML": 18185,
      "Jupyter Notebook": 16723,
      "Perl": 11401,
      "MATLAB": 9927,
      "Jinja": 4806,
      "Nix": 1437,
      "Dockerfile": 1081,
      "GDB": 41
    },
    "commit_activity": {
      "total_commits_last_year": 1447,
      "avg_commits_per_week": 27.826923076923077,
      "days_active_last_year": 267
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T13:55:51.647565"
  }
}