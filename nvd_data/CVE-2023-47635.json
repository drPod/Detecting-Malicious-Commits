{
  "cve_id": "CVE-2023-47635",
  "github_data": {
    "repository": "decidim/decidim",
    "fix_commit": "5542227be66e3b6d7530f5b536069bce09376660",
    "related_commits": [
      "5542227be66e3b6d7530f5b536069bce09376660",
      "57a4b467787448307b5d9b01ce6e2c8502e121ac",
      "5542227be66e3b6d7530f5b536069bce09376660",
      "57a4b467787448307b5d9b01ce6e2c8502e121ac"
    ],
    "patch_url": "https://github.com/decidim/decidim/commit/5542227be66e3b6d7530f5b536069bce09376660.patch",
    "fix_commit_details": {
      "sha": "5542227be66e3b6d7530f5b536069bce09376660",
      "commit_date": "2020-06-19T15:52:02Z",
      "author": {
        "login": "verarojman",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Load script on autocomplete change",
        "length": 34,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 35,
        "additions": 25,
        "deletions": 10
      },
      "files": [
        {
          "filename": "decidim-admin/app/assets/javascripts/decidim/admin/bundle.js",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": null
        },
        {
          "filename": "decidim-admin/app/frontend/components/autocomplete.component.tsx",
          "status": "modified",
          "additions": 14,
          "deletions": 4,
          "patch": "@@ -118,18 +118,28 @@ export class Autocomplete extends React.Component<AutocompleteProps, Autocomplet\n     this.setState({ selectedOption });\n \n     if (this.props.changeURL) {\n-\n-alert(`requesting get for changeURL ${this.props.changeURL}`)\n-\n       axios.get(this.props.changeURL, {\n         headers: {\n-          Accept: \"application/json\"\n+          Accept: \"text/javascript\"\n         },\n         withCredentials: true,\n         params: {\n           id: selectedOption.value\n         }\n       })\n+      .then((response) => {\n+        let script = document.createElement(\"script\");\n+        script.type = \"text/javascript\";\n+        script.innerHTML = response.data;\n+        document.getElementsByTagName(\"head\")[0].appendChild(script);\n+      })\n+      .catch((error: any) => {\n+        if (axios.isCancel(error)) {\n+          console.log(\"Request canceled\", error.message);\n+        } else {\n+          console.log(error)\n+        }\n+      });\n     }\n   }\n "
        },
        {
          "filename": "decidim-templates/app/controllers/decidim/templates/admin/questionnaire_templates_controller.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -8,6 +8,8 @@ module Admin\n       class QuestionnaireTemplatesController < Decidim::Templates::Admin::ApplicationController\n         include Decidim::TranslatableAttributes\n         \n+        skip_before_action :verify_authenticity_token, only: :preview\n+        \n         helper_method :template\n \n         def index"
        },
        {
          "filename": "decidim-templates/app/views/decidim/templates/admin/questionnaire_templates/preview.js.erb",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -1 +1,4 @@\n-alert(\"preview!\")\n\\ No newline at end of file\n+/* eslint-disable no-var, prefer-template */\n+(function () {\n+  \n+}());"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e9e49808aeb85493fce228c057010abac45a10f2",
            "date": "2025-01-14T13:00:27Z",
            "author_login": "alecslupu"
          },
          {
            "sha": "9fd1b9ec44d5070586bc55357d58f05cbf785ec2",
            "date": "2025-01-14T11:45:18Z",
            "author_login": "BarbaraOliveira13"
          },
          {
            "sha": "740a3b792c3a4240699addbde8950d31b08d7a4d",
            "date": "2025-01-14T11:37:47Z",
            "author_login": "alecslupu"
          },
          {
            "sha": "08a53bae27886d7ff3d7b404d918dad8c2dca0a5",
            "date": "2025-01-14T10:14:01Z",
            "author_login": "alecslupu"
          },
          {
            "sha": "18869cf7834369c08d165358207466ed09406f20",
            "date": "2025-01-14T09:15:39Z",
            "author_login": "andreslucena"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-918",
    "description": "Decidim is a participatory democracy framework. Starting in version 0.23.0 and prior to versions 0.27.5 and 0.28.0, the CSRF authenticity token check is disabled for the questionnaire templates preview. The issue does not imply a serious security thread as you need to have access also to the session cookie in order to see this resource. This URL does not allow modifying the resource but it may allow attackers to gain access to information which was not meant to be public. The issue is fixed in version 0.27.5 and 0.28.0. As a workaround, disable the templates functionality or remove all available templates.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-20T18:15:50.147",
    "last_modified": "2024-12-16T21:28:47.970",
    "fix_date": "2020-06-19T15:52:02Z"
  },
  "references": [
    {
      "url": "https://github.com/decidim/decidim/blob/3187bdfd40ea1c57c2c12512b09a7fec0b2bed08/decidim-templates/app/controllers/decidim/templates/admin/questionnaire_templates_controller.rb#L11",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/5542227be66e3b6d7530f5b536069bce09376660",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/57a4b467787448307b5d9b01ce6e2c8502e121ac",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/pull/11743",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/pull/6247",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.27.5",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.28.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/security/advisories/GHSA-f3qm-vfc3-jg6v",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/blob/3187bdfd40ea1c57c2c12512b09a7fec0b2bed08/decidim-templates/app/controllers/decidim/templates/admin/questionnaire_templates_controller.rb#L11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/5542227be66e3b6d7530f5b536069bce09376660",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/57a4b467787448307b5d9b01ce6e2c8502e121ac",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/pull/11743",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/pull/6247",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.27.5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.28.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/security/advisories/GHSA-f3qm-vfc3-jg6v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.137290",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "decidim",
    "owner": "decidim",
    "created_at": "2016-08-17T14:27:06Z",
    "updated_at": "2025-01-14T13:00:32Z",
    "pushed_at": "2025-01-14T13:01:17Z",
    "size": 264752,
    "stars": 1494,
    "forks": 408,
    "open_issues": 412,
    "watchers": 1494,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "Ruby": 12848603,
      "HTML": 1662161,
      "JavaScript": 763759,
      "SCSS": 258282,
      "Dockerfile": 205,
      "Shell": 49
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:07:09.324253"
  }
}