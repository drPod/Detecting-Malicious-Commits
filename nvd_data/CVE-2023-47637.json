{
  "cve_id": "CVE-2023-47637",
  "github_data": {
    "repository": "pimcore/pimcore",
    "fix_commit": "d164d99c90f098d0ccd6b72929c48b727e2953a0",
    "related_commits": [
      "d164d99c90f098d0ccd6b72929c48b727e2953a0",
      "d164d99c90f098d0ccd6b72929c48b727e2953a0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "d164d99c90f098d0ccd6b72929c48b727e2953a0",
      "commit_date": "2023-11-07T08:27:56Z",
      "author": {
        "login": "robertSt7",
        "type": "User",
        "stats": {
          "total_commits": 256,
          "average_weekly_commits": 0.5069306930693069,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 82
        }
      },
      "commit_message": {
        "title": "Fix: escape filter values",
        "length": 25,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "models/DataObject/ClassDefinition/Data/Multiselect.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -302,8 +302,8 @@ public function getFilterConditionExt(mixed $value, string $operator, array $par\n             }\n \n             $value = $operator === '='\n-                ? \"'%,\".$value.\",%'\"\n-                : \"'%,%\".$value.\"%,%'\";\n+                ? $db->quote(\"%,\". $value . \",%\")\n+                : $db->quote(\"%,%\" .Helper::escapeLike($value). \"%,%\");\n \n             return $key.' LIKE '.$value.' ';\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8069dbf289a883420d0d044bbc625b70bfe6ab69",
            "date": "2025-01-24T08:43:32Z",
            "author_login": "herbertroth"
          },
          {
            "sha": "ca25fd2d12528a83dc3e84b3391e109d5401ba1f",
            "date": "2025-01-24T08:28:47Z",
            "author_login": "herbertroth"
          },
          {
            "sha": "d67add7f7a776c41749baecb4e7b17a0a7cef4bb",
            "date": "2025-01-22T09:34:54Z",
            "author_login": "bluvulture"
          },
          {
            "sha": "8462b49987cdcdba6e6cba997956561db46e0b3c",
            "date": "2025-01-22T08:21:33Z",
            "author_login": "bluvulture"
          },
          {
            "sha": "3c6946c51fa457835af5b9ecd6a6c07006b287a8",
            "date": "2025-01-21T15:14:51Z",
            "author_login": "alexz707"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "Pimcore is an Open Source Data & Experience Management Platform. In affected versions the `/admin/object/grid-proxy` endpoint calls `getFilterCondition()` on fields of classes to be filtered for, passing input from the request, and later executes the returned SQL.  One implementation of `getFilterCondition()` is in `Multiselect`, which does not normalize/escape/validate the passed value. Any backend user with very basic permissions can execute arbitrary SQL statements and thus alter any data or escalate their privileges to at least admin level. This vulnerability has been addressed in version 11.1.1. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-15T20:15:08.013",
    "last_modified": "2024-11-21T08:30:34.847",
    "fix_date": "2023-11-07T08:27:56Z"
  },
  "references": [
    {
      "url": "https://github.com/pimcore/admin-ui-classic-bundle/blob/bba7c7419cb1f06d5fd98781eab4d6995e4e5dca/src/Helper/GridHelperService.php#L311",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/commit/d164d99c90f098d0ccd6b72929c48b727e2953a0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/security/advisories/GHSA-72hh-xf79-429p",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/pimcore/admin-ui-classic-bundle/blob/bba7c7419cb1f06d5fd98781eab4d6995e4e5dca/src/Helper/GridHelperService.php#L311",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/commit/d164d99c90f098d0ccd6b72929c48b727e2953a0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pimcore/pimcore/security/advisories/GHSA-72hh-xf79-429p",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.262389",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "pimcore",
    "owner": "pimcore",
    "created_at": "2011-11-01T09:16:14Z",
    "updated_at": "2025-01-24T13:32:34Z",
    "pushed_at": "2025-01-24T11:49:46Z",
    "size": 524713,
    "stars": 3468,
    "forks": 1456,
    "open_issues": 492,
    "watchers": 3468,
    "has_security_policy": false,
    "default_branch": "12.x",
    "protected_branches": [
      "11.5",
      "12.x"
    ],
    "languages": {
      "PHP": 6723770,
      "JavaScript": 330727,
      "Twig": 9213,
      "CSS": 2342,
      "HTML": 687,
      "Shell": 538
    },
    "commit_activity": {
      "total_commits_last_year": 610,
      "avg_commits_per_week": 11.73076923076923,
      "days_active_last_year": 182
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:37:53.640257"
  }
}