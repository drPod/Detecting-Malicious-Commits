{
  "cve_id": "CVE-2023-48218",
  "github_data": {
    "repository": "strapi-community/strapi-plugin-protected-populate",
    "fix_commit": "05441066d64e09dd55937d9f089962e9ebe2fb39",
    "related_commits": [
      "05441066d64e09dd55937d9f089962e9ebe2fb39",
      "05441066d64e09dd55937d9f089962e9ebe2fb39"
    ],
    "patch_url": "https://github.com/strapi-community/strapi-plugin-protected-populate/commit/05441066d64e09dd55937d9f089962e9ebe2fb39.patch",
    "fix_commit_details": {
      "sha": "05441066d64e09dd55937d9f089962e9ebe2fb39",
      "commit_date": "2023-11-13T19:53:11Z",
      "author": {
        "login": "Boegie19",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix fields always populating ID",
        "length": 31,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 6,
        "deletions": 5
      },
      "files": [
        {
          "filename": "server/middlewares/helpers/protect-route.js",
          "status": "modified",
          "additions": 6,
          "deletions": 5,
          "patch": "@@ -23,12 +23,12 @@ const protectPopulate = (populate, info) => {\n   //fields\n   if (typeof info.on === 'undefined') {\n     if (typeof info.fields === 'undefined') {\n-      populate.fields = [];\n+      populate.fields = ['id'];\n     } else if (typeof populate.fields === 'undefined') {\n       //Don't have to check main mainBoolean since if it is true fields is also \"undefined\"\n-      populate.fields = info.fields;\n+      populate.fields = ['id', ...info.fields];\n     } else if (Array.isArray(populate.fields)) {\n-      let fields = [];\n+      let fields = ['id'];\n       populate.fields.forEach((value) => {\n         if (info.fields.includes(value)) {\n           fields.push(value);\n@@ -37,7 +37,7 @@ const protectPopulate = (populate, info) => {\n       populate.fields = fields;\n     } else {\n       //Unexpected input handle it if it was empty\n-      populate.fields = info.fields;\n+      populate.fields = ['id', ...info.fields];\n     }\n   }\n   //Deal with array input for populate\n@@ -105,6 +105,7 @@ const protectPopulate = (populate, info) => {\n       populate = AllowedList;\n     }\n   } else {\n+    //DZ\n     //populate\n     if (typeof info.populate === 'undefined') {\n       populate.populate = {};\n@@ -164,7 +165,7 @@ const protectFilters = (filters, info) => {\n \n const protectRoute = (query, info) => {\n   const savePopulate = protectPopulate(query, info);\n-  query.populate = savePopulate.populate;\n+  query.populate = savePopulate.populate || savePopulate.on;\n   query.fields = savePopulate.fields;\n   query.filters = protectFilters(query.filters, info);\n   return query;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "625b9fc40759c588f02d10267f702886afaf2c05",
            "date": "2024-12-22T13:40:41Z",
            "author_login": "Boegie19"
          },
          {
            "sha": "f56c7f0c7a3062b448d17e7147f331899c7fb115",
            "date": "2024-12-22T13:39:35Z",
            "author_login": "Boegie19"
          },
          {
            "sha": "c87b1c61adc3f42256f13a259c59455dc732dacc",
            "date": "2024-12-22T13:37:33Z",
            "author_login": "Boegie19"
          },
          {
            "sha": "0d1bcb8773e624b2ef7bdf091d61b04ae0789541",
            "date": "2024-12-19T17:30:46Z",
            "author_login": "Boegie19"
          },
          {
            "sha": "75c8ec67bd152320b2625c4c7108bc2162076a23",
            "date": "2024-12-19T17:30:10Z",
            "author_login": "Boegie19"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-863",
    "description": "The Strapi Protected Populate Plugin protects `get` endpoints from revealing too much information. Prior to version 1.3.4, users were able to bypass the field level security. Users who tried to populate something that they didn't have access to could populate those fields anyway. This issue has been patched in version 1.3.4. There are no known workarounds.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-20T17:15:13.543",
    "last_modified": "2024-11-21T08:31:13.880",
    "fix_date": "2023-11-13T19:53:11Z"
  },
  "references": [
    {
      "url": "https://github.com/strapi-community/strapi-plugin-protected-populate/commit/05441066d64e09dd55937d9f089962e9ebe2fb39",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/strapi-community/strapi-plugin-protected-populate/releases/tag/v1.3.4",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/strapi-community/strapi-plugin-protected-populate/security/advisories/GHSA-6h67-934r-82g7",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/strapi-community/strapi-plugin-protected-populate/commit/05441066d64e09dd55937d9f089962e9ebe2fb39",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/strapi-community/strapi-plugin-protected-populate/releases/tag/v1.3.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/strapi-community/strapi-plugin-protected-populate/security/advisories/GHSA-6h67-934r-82g7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.272624",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "strapi-plugin-protected-populate",
    "owner": "strapi-community",
    "created_at": "2022-12-27T17:54:12Z",
    "updated_at": "2024-12-22T13:40:45Z",
    "pushed_at": "2024-12-22T13:41:32Z",
    "size": 9583,
    "stars": 20,
    "forks": 5,
    "open_issues": 3,
    "watchers": 20,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "JavaScript": 62778,
      "TypeScript": 7480
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:42:07.966346"
  }
}