{
  "cve_id": "CVE-2023-48224",
  "github_data": {
    "repository": "ethyca/fides",
    "fix_commit": "685bae61c203d29ed189f4b066a5223a9bb774c6",
    "related_commits": [
      "685bae61c203d29ed189f4b066a5223a9bb774c6",
      "685bae61c203d29ed189f4b066a5223a9bb774c6"
    ],
    "patch_url": "https://github.com/ethyca/fides/commit/685bae61c203d29ed189f4b066a5223a9bb774c6.patch",
    "fix_commit_details": {
      "sha": "685bae61c203d29ed189f4b066a5223a9bb774c6",
      "commit_date": "2023-11-14T16:12:02Z",
      "author": {
        "login": "adamsachs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-82vr-5769-6358",
        "length": 144,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -51,6 +51,9 @@ The types of changes are:\n - User preferences from cookie should always override experience preferences [#4405](https://github.com/ethyca/fides/pull/4405)\n - Allow fides_consent cookie to be set from a subdirectory [#4426](https://github.com/ethyca/fides/pull/4426)\n \n+### Security\n+-- Use a more cryptographically secure random function for security code generation\n+\n ## [2.23.3](https://github.com/ethyca/fides/compare/2.23.2...2.23.3)\n \n ### Fixed"
        },
        {
          "filename": "src/fides/api/service/privacy_request/request_runner_service.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,4 +1,4 @@\n-import random\n+import secrets\n from datetime import datetime, timedelta\n from typing import Any, Dict, List, Optional, Set, Tuple\n \n@@ -627,7 +627,7 @@ def generate_id_verification_code() -> str:\n     \"\"\"\n     Generate one-time identity verification code\n     \"\"\"\n-    return str(random.choice(range(100000, 999999)))\n+    return str(secrets.choice(range(100000, 999999)))\n \n \n def _retrieve_child_results(  # pylint: disable=R0911"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "de209feb31ce2619c9db608d41fa5d58877589cd",
            "date": "2025-01-13T18:02:13Z",
            "author_login": "galvana"
          },
          {
            "sha": "83cb612e4bc7f1fe424cab8a0a54c024331dfe53",
            "date": "2025-01-13T17:08:18Z",
            "author_login": "daveqnet"
          },
          {
            "sha": "7ea4ad58d49dfcd525344fdf1de86078797febf5",
            "date": "2025-01-13T16:05:18Z",
            "author_login": "jpople"
          },
          {
            "sha": "73188c53f9479cd6dbd4f3637a4fc03faec9d3cf",
            "date": "2025-01-13T15:06:42Z",
            "author_login": "lucanovera"
          },
          {
            "sha": "5557f79305b7be60ad6294b8960a011dc97e9e12",
            "date": "2025-01-13T14:27:10Z",
            "author_login": "lucanovera"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H",
    "cwe_id": "CWE-338",
    "description": "Fides is an open-source privacy engineering platform for managing the fulfillment of data privacy requests in a runtime environment, and the enforcement of privacy regulations in code. The Fides Privacy Center allows data subject users to submit privacy and consent requests to data controller users of the Fides web application. Privacy requests allow data subjects to submit a request to access all person data held by the data controller, or delete/erase it.  Consent request allows data subject users to modify their privacy preferences for how the data controller uses their personal data e.g. data sales and sharing consent opt-in/opt-out. If `subject_identity_verification_required` in the `[execution]` section of `fides.toml` or the env var `FIDES__EXECUTION__SUBJECT_IDENTITY_VERIFICATION_REQUIRED` is set to `True` on the fides webserver backend, data subjects are sent a one-time code to their email address or phone number, depending on messaging configuration, and the one-time code must be entered in the Privacy Center UI by the data subject before the privacy or consent request is submitted. It was identified that the one-time code values for these requests were generated by the python `random` module, a cryptographically weak pseduo-random number generator (PNRG). If an attacker generates several hundred consecutive one-time codes, this vulnerability allows the attacker to predict all future one-time code values during the lifetime of the backend python process. There is no security impact on data access requests as the personal data download package is not shared in the Privacy Center itself. However, this vulnerability allows an attacker to (i) submit a verified data erasure request, resulting in deletion of data for the targeted user and (ii) submit a verified consent request, modifying a user's privacy preferences. The vulnerability has been patched in Fides version `2.24.0`. Users are advised to upgrade to this version or later to secure their systems against this threat. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-15T21:15:08.100",
    "last_modified": "2024-11-21T08:31:14.697",
    "fix_date": "2023-11-14T16:12:02Z"
  },
  "references": [
    {
      "url": "https://github.com/ethyca/fides/commit/685bae61c203d29ed189f4b066a5223a9bb774c6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/security/advisories/GHSA-82vr-5769-6358",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://peps.python.org/pep-0506/",
      "source": "security-advisories@github.com",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/commit/685bae61c203d29ed189f4b066a5223a9bb774c6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ethyca/fides/security/advisories/GHSA-82vr-5769-6358",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://peps.python.org/pep-0506/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Technical Description"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.262533",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fides",
    "owner": "ethyca",
    "created_at": "2021-02-04T22:42:33Z",
    "updated_at": "2025-01-13T18:02:18Z",
    "pushed_at": "2025-01-14T12:04:15Z",
    "size": 110359,
    "stars": 382,
    "forks": 73,
    "open_issues": 272,
    "watchers": 382,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 7114450,
      "TypeScript": 4436776,
      "CSS": 38216,
      "JavaScript": 32908,
      "HTML": 32388,
      "SCSS": 14657,
      "Dockerfile": 4511,
      "Jinja": 3618,
      "Mako": 494
    },
    "commit_activity": {
      "total_commits_last_year": 771,
      "avg_commits_per_week": 14.826923076923077,
      "days_active_last_year": 222
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:29:56.287100"
  }
}