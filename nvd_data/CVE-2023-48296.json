{
  "cve_id": "CVE-2023-48296",
  "github_data": {
    "repository": "oroinc/orocommerce",
    "fix_commit": "41c526498012d44cd88852c63697f1ef53b61db8",
    "related_commits": [
      "41c526498012d44cd88852c63697f1ef53b61db8",
      "41c526498012d44cd88852c63697f1ef53b61db8"
    ],
    "patch_url": "https://github.com/oroinc/orocommerce/commit/41c526498012d44cd88852c63697f1ef53b61db8.patch",
    "fix_commit_details": {
      "sha": "41c526498012d44cd88852c63697f1ef53b61db8",
      "commit_date": "2023-12-06T13:43:19Z",
      "author": {
        "login": "dsyrvachov",
        "type": "User",
        "stats": {
          "total_commits": 66,
          "average_weekly_commits": 0.12595419847328243,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 46
        }
      },
      "commit_message": {
        "title": "BB-22832: Multifile attribute is shown on product visibility page in back-office - 5.1 (#36428)",
        "length": 95,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 479,
        "additions": 452,
        "deletions": 27
      },
      "files": [
        {
          "filename": "src/Oro/Bundle/ProductBundle/EventListener/AttributeFormViewListener.php",
          "status": "modified",
          "additions": 1,
          "deletions": 10,
          "patch": "@@ -2,7 +2,6 @@\n \n namespace Oro\\Bundle\\ProductBundle\\EventListener;\n \n-use Oro\\Bundle\\AttachmentBundle\\Helper\\FieldConfigHelper;\n use Oro\\Bundle\\CMSBundle\\DBAL\\Types\\WYSIWYGType;\n use Oro\\Bundle\\EntityConfigBundle\\Attribute\\Entity\\AttributeGroup;\n use Oro\\Bundle\\EntityConfigBundle\\Entity\\FieldConfigModel;\n@@ -198,14 +197,6 @@ protected function renderAttributeViewData(Environment $twig, $entity, FieldConf\n \n     protected function isSeparateGroup(?string $type): bool\n     {\n-        return in_array(\n-            (string)$type,\n-            [\n-                WYSIWYGType::TYPE,\n-                FieldConfigHelper::MULTI_FILE_TYPE,\n-                FieldConfigHelper::MULTI_IMAGE_TYPE\n-            ],\n-            true\n-        );\n+        return in_array((string)$type, [WYSIWYGType::TYPE], true);\n     }\n }"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/EventListener/ProductMultiFileBlockListener.php",
          "status": "added",
          "additions": 25,
          "deletions": 0,
          "patch": "@@ -0,0 +1,25 @@\n+<?php\n+\n+namespace Oro\\Bundle\\ProductBundle\\EventListener;\n+\n+use Oro\\Bundle\\UIBundle\\Event\\BeforeFormRenderEvent;\n+\n+/**\n+ * Stops adding additional fields or attributes to forms if they are on the specified pages\n+ */\n+class ProductMultiFileBlockListener\n+{\n+    private array $pages = [];\n+\n+    public function setPages(array $pages): void\n+    {\n+        $this->pages = $pages;\n+    }\n+\n+    public function onBeforeFormRender(BeforeFormRenderEvent $event): void\n+    {\n+        if (in_array($event->getPageId(), $this->pages)) {\n+            $event->stopPropagation();\n+        }\n+    }\n+}"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/Resources/config/services.yml",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1098,6 +1098,15 @@ services:\n             - { name: kernel.event_listener, event: oro_ui.scroll_data.before.product-create-step-two, method: onEdit, priority: -255 }\n             - { name: kernel.event_listener, event: oro_ui.scroll_data.before.product-view, method: onViewList, priority: -255 }\n \n+    oro_product.event_listener.product_multi_file_block_listener:\n+        class: Oro\\Bundle\\ProductBundle\\EventListener\\ProductMultiFileBlockListener\n+        arguments:\n+            - '@oro_entity_config.provider.entity'\n+        calls:\n+            - [setPages, [['product-visibility-edit', 'product-create-step-one']]]\n+        tags:\n+            - { name: kernel.event_listener, event: entity_form.render.before, method: onBeforeFormRender, priority: -250 }\n+\n     oro_product.provider.product_variant_availability_provider:\n         class: 'Oro\\Bundle\\ProductBundle\\Provider\\ProductVariantAvailabilityProvider'\n         arguments:"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/Tests/Behat/Features/other/check_that_tabs_for_multiple_file_and_multiple_images_fields_are_displayed_correctly_on_product_pages.feature",
          "status": "added",
          "additions": 348,
          "deletions": 0,
          "patch": "@@ -0,0 +1,348 @@\n+@regression\n+@ticket-BB-22832\n+\n+Feature: Check that tabs for multiple file and multiple images fields are displayed correctly on product pages\n+  As an administrator, I want to make sure that:\n+  - entity fields are not displayed on the first step of product creation page and not on the product\n+    visibility page.\n+  - entity entity fields are displayed on product second step creation page, product edit page, product view page.\n+  - product attributes fields are not displayed on the first step of product creation page, second step of product\n+    creation page, product edit page, product view page, product visibility page if attributes not added to family.\n+  - product attributes fields are not displayed on the first step of product creation page, product visibility\n+    page if attributes added to family.\n+  - product attributes are displayed on product second step creation page, product edit page, product view page\n+    if attributes added to family.\n+\n+  Scenario: Authenticate\n+    Given I login as administrator\n+    And go to Products / Product Attributes\n+\n+  Scenario Outline: Create Multiple Files attributes\n+    Given I click \"Create Attribute\"\n+    When I fill form with:\n+      | Field name | <Name>         |\n+      | Type       | Multiple Files |\n+    And click \"Continue\"\n+    And fill form with:\n+      | Label             | <Name>    |\n+      | Stored Externally | No        |\n+      | File Size (MB)    | 10        |\n+      | Use DAM           | <Use DAM> |\n+      | File Applications | [default] |\n+    And save and close form\n+    Then I should see \"Attribute was successfully saved\" flash message\n+    Examples:\n+      | Name                         | Use DAM |\n+      | multiple_files_attribute     | No      |\n+      | multiple_files_dam_attribute | Yes     |\n+\n+  Scenario Outline: Create Multiple Images attribute\n+    Given I click \"Create Attribute\"\n+    When I fill form with:\n+      | Field name | <Name>          |\n+      | Type       | Multiple Images |\n+    And click \"Continue\"\n+    And fill form with:\n+      | Label             | <Name>    |\n+      | Stored Externally | No        |\n+      | File Size (MB)    | 10        |\n+      | Thumbnail Width   | 1024      |\n+      | Thumbnail Height  | 1024      |\n+      | Use DAM           | <Use DAM> |\n+      | File Applications | [default] |\n+    And save and close form\n+    Then I should see \"Attribute was successfully saved\" flash message\n+    Examples:\n+      | Name                          | Use DAM |\n+      | multiple_images_attribute     | No      |\n+      | multiple_images_dam_attribute | Yes     |\n+\n+  Scenario: Create fields\n+    Given I go to System/ Entities/ Entity Management\n+    And I filter \"Name\" as is equal to \"Product\"\n+    And I click view Product in grid\n+\n+  Scenario Outline: Create Multiple Files fields\n+    Given I click \"Create field\"\n+    When I fill form with:\n+      | Field name   | <Name>         |\n+      | Storage type | Table column   |\n+      | Type         | Multiple Files |\n+    And click \"Continue\"\n+    And fill form with:\n+      | Label             | <Name>    |\n+      | Stored Externally | No        |\n+      | File Size (MB)    | 10        |\n+      | Use DAM           | <Use DAM> |\n+      | File Applications | [default] |\n+    And save and close form\n+    Then I should see \"Field saved\" flash message\n+    Examples:\n+      | Name                     | Use DAM |\n+      | multiple_files_field     | No      |\n+      | multiple_files_dam_field | Yes     |\n+\n+  Scenario Outline: Create Multiple Images fields\n+    Given I click \"Create field\"\n+    When I fill form with:\n+      | Field name | <Name>          |\n+      | Type       | Multiple Images |\n+    And click \"Continue\"\n+    And fill form with:\n+      | Label             | <Name>    |\n+      | Stored Externally | No        |\n+      | File Size (MB)    | 10        |\n+      | Thumbnail Width   | 1024      |\n+      | Thumbnail Height  | 1024      |\n+      | Use DAM           | <Use DAM> |\n+      | File Applications | [default] |\n+    And save and close form\n+    Then I should see \"Field saved\" flash message\n+    Examples:\n+      | Name                      | Use DAM |\n+      | multiple_images_field     | No      |\n+      | multiple_images_dam_field | Yes     |\n+\n+  Scenario: Update schema\n+    Given I click update schema\n+    Then I should see Schema updated flash message\n+\n+  Scenario: Check for fields and missing attributes on product creation pages\n+    Given I go to Products/ Products\n+    When I click \"Create Product\"\n+    Then I should see \"General\"\n+    # At the first step of creating a product, we should not see additional fields and attributes.\n+    # Check product attribute on first product create page.\n+    And should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on first product create page.\n+    And should not see \"multiple_files_field\"\n+    And should not see \"multiple_files_dam_field\"\n+    And should not see \"multiple_images_field\"\n+    And should not see \"multiple_images_dam_field\"\n+    When I fill \"ProductForm Step One\" with:\n+      | Type           | Simple  |\n+      | Product Family | Default |\n+    And click \"Continue\"\n+    # Attributes is not displayed because they are not added to the product family.\n+    # Check product attribute on second product create page.\n+    Then I should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on second product create page\n+    And should see \"multiple_files_field\"\n+    And should see \"multiple_files_dam_field\"\n+    And should see \"multiple_images_field\"\n+    And should see \"multiple_images_dam_field\"\n+    When I fill \"ProductForm\" with:\n+      | Sku  | ORO_PRODUCT_1 |\n+      | Name | ORO_PRODUCT_1 |\n+    And save and close form\n+    Then I should see \"Product has been saved\" flash message\n+\n+  Scenario: Check for fields and missing attributes on product edit page\n+    Given I click \"Edit\"\n+    # Check product attribute on product edit page\n+    Then I should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on product edit page\n+    And should see \"multiple_files_field\"\n+    And should see \"multiple_files_dam_field\"\n+    And should see \"multiple_images_field\"\n+    And should see \"multiple_images_dam_field\"\n+    When I save and close form\n+    Then I should see \"Product has been saved\" flash message\n+\n+  Scenario: Check for fields and missing attributes on product view page\n+    # Check product attribute on product view page\n+    Given I should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on product view page\n+    And should see \"multiple_files_field\"\n+    And should see \"multiple_files_dam_field\"\n+    And should see \"multiple_images_field\"\n+    And should see \"multiple_images_dam_field\"\n+\n+  Scenario: Check for fields and missing attributes on product visibility page\n+    Given I click \"More actions\"\n+    When I click \"Manage Visibility\"\n+    # Check product attribute on product visibility page\n+    Then I should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on product visibility page\n+    And should not see \"multiple_files_field\"\n+    And should not see \"multiple_files_dam_field\"\n+    And should not see \"multiple_images_field\"\n+    And should not see \"multiple_images_dam_field\"\n+\n+  Scenario: Update product family with new attributes\n+    When I go to Products/ Product Families\n+    And I click \"Edit\" on row \"default_family\" in grid\n+    And click \"Add\"\n+    And fill \"Attributes Group Form\" with:\n+      | Attribute Groups Label0      | Multiple Fields Attributes                                                                                         |\n+      | Attribute Groups Visible0    | true                                                                                                               |\n+      | Attribute Groups Attributes0 | [multiple_files_attribute, multiple_files_dam_attribute, multiple_images_attribute, multiple_images_dam_attribute] |\n+    And save and close form\n+    Then I should see \"Successfully updated\" flash message\n+\n+  Scenario: Check for fields and attributes on product creation pages\n+    Given I go to Products/ Products\n+    When I click \"Create Product\"\n+    # Check product attribute on first product create page\n+    Then I should not see \"Multiple Fields Attributes\"\n+    And should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on first product create page\n+    And should not see \"multiple_files_field\"\n+    And should not see \"multiple_files_dam_field\"\n+    And should not see \"multiple_images_field\"\n+    And should not see \"multiple_images_dam_field\"\n+    And fill \"ProductForm Step One\" with:\n+      | Type           | Simple  |\n+      | Product Family | Default |\n+    When I click \"Continue\"\n+    # Check product attribute on second product create page\n+    Then I should see \"Multiple Fields Attributes\"\n+    # Check if the attributes are displayed (attributes fields do not have names except for family tab)\n+    And should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on second product create page\n+    And should see \"multiple_files_field\"\n+    And should see \"multiple_files_dam_field\"\n+    And should see \"multiple_images_field\"\n+    And should see \"multiple_images_dam_field\"\n+    When I fill \"ProductForm\" with:\n+      | Sku  | ORO_PRODUCT_2 |\n+      | Name | ORO_PRODUCT_2 |\n+    And save and close form\n+    Then I should see \"Product has been saved\" flash message\n+\n+  Scenario: Check for fields and attributes on product edit page\n+    Given I click \"Edit\"\n+    # Check product attribute on product edit page\n+    Then I should see \"Multiple Fields Attributes\"\n+    # Check if the attributes are displayed (attributes fields do not have names except for family tab)\n+    And should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on product edit page\n+    And should see \"multiple_files_field\"\n+    And should see \"multiple_files_dam_field\"\n+    And should see \"multiple_images_field\"\n+    And should see \"multiple_images_dam_field\"\n+    When I save and close form\n+    Then I should see \"Product has been saved\" flash message\n+\n+  Scenario: Check for fields and attributes on product view page\n+    # Check product attribute on product view page\n+    Given I should see \"Multiple Fields Attributes\"\n+    # Check if the attributes are displayed (attributes fields do not have names except for family tab)\n+    And should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on product view page\n+    And should see \"multiple_files_field\"\n+    And should see \"multiple_files_dam_field\"\n+    And should see \"multiple_images_field\"\n+    And should see \"multiple_images_dam_field\"\n+\n+  Scenario: Check for fields and attributes on product visibility page\n+    Given I click \"More actions\"\n+    When I click \"Manage Visibility\"\n+    # Check product attribute on product visibility page\n+    Then I should not see \"Multiple Fields Attributes\"\n+    And should not see \"multiple_files_attribute\"\n+    And should not see \"multiple_files_dam_attribute\"\n+    And should not see \"multiple_images_attribute\"\n+    And should not see \"multiple_images_dam_attribute\"\n+    # Check extend field on product visibility page\n+    And should not see \"multiple_files_field\"\n+    And should not see \"multiple_files_dam_field\"\n+    And should not see \"multiple_images_field\"\n+    And should not see \"multiple_images_dam_field\"\n+\n+  Scenario: Create product and check fields and attributes\n+    Given I go to Products/ Products\n+    When I click \"Create Product\"\n+    And fill \"ProductForm Step One\" with:\n+      | Type           | Simple  |\n+      | Product Family | Default |\n+    And click \"Continue\"\n+    And fill \"ProductForm\" with:\n+      | Sku                       | ORO_PRODUCT_30 |\n+      | Name                      | ORO_PRODUCT_30 |\n+      | Multiple Files Attribute  | example.pdf    |\n+      | Multiple Images Attribute | 300x300.png    |\n+      | Multiple Files Field      | example2.pdf   |\n+      | Multiple Images Field     | blue-dot.jpg   |\n+\n+    And click \"Multiple Files DAM Attribute\"\n+    And fill \"Digital Asset Dialog Form\" with:\n+      | File  | example.pdf                  |\n+      | Title | Multiple Files DAM Attribute |\n+    And click \"Upload\"\n+    And click on example.pdf in grid\n+\n+    And click \"Multiple Images DAM Attribute\"\n+    And fill \"Digital Asset Dialog Form\" with:\n+      | File  | 300x300.png                   |\n+      | Title | Multiple Images DAM Attribute |\n+    And click \"Upload\"\n+    And click on 300x300.png in grid\n+\n+    And click \"Multiple Files DAM Field\"\n+    And fill \"Digital Asset Dialog Form\" with:\n+      | File  | example2.pdf             |\n+      | Title | Multiple Files DAM Field |\n+    And click \"Upload\"\n+    And click on example2.pdf in grid\n+\n+    And click \"Multiple Images DAM Field\"\n+    And fill \"Digital Asset Dialog Form\" with:\n+      | File  | blue-dot.jpg              |\n+      | Title | Multiple Images DAM Field |\n+    And click \"Upload\"\n+    And click on blue-dot.jpg in grid\n+\n+    And save and close form\n+    Then I should see \"Product has been saved\" flash message\n+    And should see following \"Multiple Files Attribute Grid\" grid:\n+      | File Name   |\n+      | example.pdf |\n+    And should see following \"Multiple Images Attribute Grid\" grid:\n+      | Name        |\n+      | 300x300.png |\n+    And should see following \"Multiple Files Field Grid\" grid:\n+      | File Name    |\n+      | example2.pdf |\n+    And should see following \"Multiple Images Field Grid\" grid:\n+      | Name         |\n+      | blue-dot.jpg |\n+    And should see following \"Multiple Files DAM Attribute Grid\" grid:\n+      | File Name   |\n+      | example.pdf |\n+    And should see following \"Multiple Images DAM Attribute Grid\" grid:\n+      | Name        |\n+      | 300x300.png |\n+    And should see following \"Multiple Files DAM Field Grid\" grid:\n+      | File Name    |\n+      | example2.pdf |\n+    And should see following \"Multiple Images DAM Field Grid\" grid:\n+      | Name         |\n+      | blue-dot.jpg |"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/Tests/Behat/Features/product-attributes/product_attributes_order.feature",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -87,7 +87,7 @@ Feature: Product attributes order\n     And I save and close form\n     Then I should see \"Product has been saved\" flash message\n     And I should see \"Drawing Backoffice Field\" goes after \"Document Backoffice Field\"\n-    And I should see \"MultipleImages Field\" goes after \"MultipleFiles Field\"\n+    And I should see \"MultipleImages Backoffice Field\" goes after \"MultipleFiles Backoffice Field\"\n \n   Scenario: Check attributes order on store front\n     Given I proceed as the Buyer\n@@ -114,7 +114,7 @@ Feature: Product attributes order\n     And I should see \"MultipleFiles Field\" goes after \"MultipleImages Field\"\n     When I save and close form\n     Then I should see \"Document Backoffice Field\" goes after \"Drawing Backoffice Field\"\n-    And I should see \"MultipleFiles Field\" goes after \"MultipleImages Field\"\n+    And I should see \"MultipleFiles Backoffice Field\" goes after \"MultipleImages Backoffice Field\"\n \n   Scenario: Check attributes order on store front\n     Given I proceed as the Buyer"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/Tests/Behat/behat.yml",
          "status": "modified",
          "additions": 12,
          "deletions": 2,
          "patch": "@@ -1531,12 +1531,22 @@ oro_behat_extension:\n     MultipleFiles Field:\n       selector:\n         type: xpath\n-        locator: '//h4[contains(., \"MultipleFiles\")]/parent::*'\n+        locator: '//div[contains(@id,\"MultipleFiles\") and contains(@class,\"file-collection\")]/parent::*'\n+\n+    MultipleFiles Backoffice Field:\n+      selector:\n+        type: xpath\n+        locator: '//div[contains(@id,\"grid-MultipleFiles\")]/parent::*'\n \n     MultipleImages Field:\n       selector:\n         type: xpath\n-        locator: '//h4[contains(., \"MultipleImages\")]/parent::*'\n+        locator: '//div[contains(@id,\"MultipleImages\") and contains(@class,\"file-collection\")]/parent::*'\n+\n+    MultipleImages Backoffice Field:\n+      selector:\n+        type: xpath\n+        locator: '//div[contains(@id,\"grid-MultipleImages\")]/parent::*'\n \n     Drawing Storefront Field:\n       selector:"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/Tests/Unit/EventListener/AttributeFormViewListenerTest.php",
          "status": "modified",
          "additions": 10,
          "deletions": 13,
          "patch": "@@ -143,7 +143,8 @@ public function viewListDataProvider(): array\n                 'fieldName' => 'someField',\n                 'data' => [\n                     'view' => ['is_displayable' => true],\n-                    'form' => ['is_enabled' => true]\n+                    'form' => ['is_enabled' => true],\n+                    'attribute' => ['is_attribute' => true],\n                 ]\n             ]\n         );\n@@ -502,8 +503,8 @@ public function viewListDataProvider(): array\n                                 ],\n                             ],\n                         ],\n-                        'multiFileField' => [\n-                            'title' => 'translated multiFile field label',\n+                        'group1' => [\n+                            'title' => 'Group1Title',\n                             'useSubBlockDivider' => true,\n                             'subblocks' => [\n                                 [\n@@ -512,7 +513,6 @@ public function viewListDataProvider(): array\n                                     ],\n                                 ],\n                             ],\n-                            'priority' => 501,\n                         ],\n                     ],\n                 ],\n@@ -572,8 +572,8 @@ public function viewListDataProvider(): array\n                                 ],\n                             ],\n                         ],\n-                        'multiImageField' => [\n-                            'title' => 'translated multiImage field label',\n+                        'group1' => [\n+                            'title' => 'Group1Title',\n                             'useSubBlockDivider' => true,\n                             'subblocks' => [\n                                 [\n@@ -582,7 +582,6 @@ public function viewListDataProvider(): array\n                                     ],\n                                 ],\n                             ],\n-                            'priority' => 501,\n                         ],\n                     ],\n                 ],\n@@ -932,8 +931,8 @@ public function editDataProvider(): array\n                                 ],\n                             ],\n                         ],\n-                        'multiFileField' => [\n-                            'title' => 'translated multiFile field label',\n+                        'group1' => [\n+                            'title' => 'Group1Title',\n                             'useSubBlockDivider' => true,\n                             'subblocks' => [\n                                 [\n@@ -942,7 +941,6 @@ public function editDataProvider(): array\n                                     ],\n                                 ],\n                             ],\n-                            'priority' => 501,\n                         ],\n                     ],\n                 ],\n@@ -1003,8 +1001,8 @@ public function editDataProvider(): array\n                                 ],\n                             ],\n                         ],\n-                        'multiImageField' => [\n-                            'title' => 'translated multiImage field label',\n+                        'group1' => [\n+                            'title' => 'Group1Title',\n                             'useSubBlockDivider' => true,\n                             'subblocks' => [\n                                 [\n@@ -1013,7 +1011,6 @@ public function editDataProvider(): array\n                                     ],\n                                 ],\n                             ],\n-                            'priority' => 501,\n                         ],\n                     ],\n                 ],"
        },
        {
          "filename": "src/Oro/Bundle/ProductBundle/Tests/Unit/EventListener/ProductMultiFileBlockListenerTest.php",
          "status": "added",
          "additions": 45,
          "deletions": 0,
          "patch": "@@ -0,0 +1,45 @@\n+<?php\n+\n+namespace Oro\\Bundle\\ProductBundle\\Tests\\Unit\\EventListener;\n+\n+use Oro\\Bundle\\ProductBundle\\EventListener\\ProductMultiFileBlockListener;\n+use Oro\\Bundle\\UIBundle\\Event\\BeforeFormRenderEvent;\n+use Symfony\\Component\\Form\\FormView;\n+use Twig\\Environment;\n+\n+class ProductMultiFileBlockListenerTest extends \\PHPUnit\\Framework\\TestCase\n+{\n+    /** @var ProductMultiFileBlockListener */\n+    private $productMultiFileBlockListener;\n+\n+    protected function setUp(): void\n+    {\n+        $this->productMultiFileBlockListener = new ProductMultiFileBlockListener();\n+    }\n+\n+    /**\n+     * @dataProvider dataProvider\n+     */\n+    public function testOnBeforeFormRender(string $pageId, bool $expected): void\n+    {\n+        $event = new BeforeFormRenderEvent(\n+            $this->createMock(FormView::class),\n+            [],\n+            $this->createMock(Environment::class),\n+            null,\n+        );\n+        $event->setPageId('valid-page-id');\n+\n+        $this->productMultiFileBlockListener->setPages([$pageId]);\n+        $this->productMultiFileBlockListener->onBeforeFormRender($event);\n+        self::assertEquals($event->isPropagationStopped(), $expected);\n+    }\n+\n+    public function dataProvider(): array\n+    {\n+        return [\n+            ['pageId' => 'non-valid-page-id', 'expected' => false],\n+            ['pageId' => 'valid-page-id', 'expected' => true],\n+        ];\n+    }\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 5,
        "unique_directories": 6,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bd19c98ac404c7bf42209235aaf04cf8adeeffcb",
            "date": "2025-01-13T08:45:01Z",
            "author_login": "den-v"
          },
          {
            "sha": "cf287ea51dbca8320f6c30694341f18d50c227df",
            "date": "2025-01-10T16:18:54Z",
            "author_login": "kotliarmikhail"
          },
          {
            "sha": "54e011eec9a991d2a9c13035c0dac5ab7ae8a1c3",
            "date": "2025-01-10T16:16:38Z",
            "author_login": "ValeriyYustunyk"
          },
          {
            "sha": "d5f8a647bacd364faac8ea59207d4dc2f3499536",
            "date": "2025-01-09T11:47:49Z",
            "author_login": "timofiyprisyazhnyuk"
          },
          {
            "sha": "6c3bab45d8ccc7b797cdd447a06acdacf30e475c",
            "date": "2025-01-07T01:01:35Z",
            "author_login": "vsoroka"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "OroPlatform is a PHP Business Application Platform (BAP).  Navigation history, most viewed and favorite navigation items are returned to storefront user in JSON navigation response if ID of storefront user matches ID of back-office user. This vulnerability is fixed in 5.1.4.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-25T19:15:57.300",
    "last_modified": "2024-11-21T08:31:25.800",
    "fix_date": "2023-12-06T13:43:19Z"
  },
  "references": [
    {
      "url": "https://github.com/oroinc/orocommerce/commit/41c526498012d44cd88852c63697f1ef53b61db8",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/oroinc/orocommerce/security/advisories/GHSA-v7px-46v9-5qwp",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/oroinc/orocommerce/commit/41c526498012d44cd88852c63697f1ef53b61db8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/oroinc/orocommerce/security/advisories/GHSA-v7px-46v9-5qwp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.898299",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "orocommerce",
    "owner": "oroinc",
    "created_at": "2015-07-23T23:29:10Z",
    "updated_at": "2025-01-13T22:51:55Z",
    "pushed_at": "2025-01-13T22:51:52Z",
    "size": 232815,
    "stars": 195,
    "forks": 85,
    "open_issues": 59,
    "watchers": 195,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 34833897,
      "Gherkin": 3659320,
      "JavaScript": 1978023,
      "Twig": 1303064,
      "SCSS": 539632,
      "HTML": 186201,
      "CSS": 22143,
      "Shell": 380
    },
    "commit_activity": {
      "total_commits_last_year": 808,
      "avg_commits_per_week": 15.538461538461538,
      "days_active_last_year": 240
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T18:00:35.731072"
  }
}