{
  "cve_id": "CVE-2023-48299",
  "github_data": {
    "repository": "pytorch/serve",
    "fix_commit": "bfb3d42396727614aef625143b4381e64142f9bb",
    "related_commits": [
      "bfb3d42396727614aef625143b4381e64142f9bb",
      "bfb3d42396727614aef625143b4381e64142f9bb"
    ],
    "patch_url": "https://github.com/pytorch/serve/commit/bfb3d42396727614aef625143b4381e64142f9bb.patch",
    "fix_commit_details": {
      "sha": "bfb3d42396727614aef625143b4381e64142f9bb",
      "commit_date": "2023-09-29T23:46:40Z",
      "author": {
        "login": "msaroufim",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix zip slip error (#2634)",
        "length": 26,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 17,
        "deletions": 2
      },
      "files": [
        {
          "filename": "frontend/archive/src/main/java/org/pytorch/serve/archive/utils/ZipUtils.java",
          "status": "modified",
          "additions": 17,
          "deletions": 2,
          "patch": "@@ -28,8 +28,15 @@ public static void unzip(InputStream is, File dest) throws IOException {\n         try (ZipInputStream zis = new ZipInputStream(is)) {\n             ZipEntry entry;\n             while ((entry = zis.getNextEntry()) != null) {\n-                String name = entry.getName();\n-                File file = new File(dest, name);\n+                File file = new File(dest, entry.getName());\n+                File canonicalDestDir = dest.getCanonicalFile();\n+                File canonicalFile = file.getCanonicalFile();\n+\n+                // Check for Zip Slip vulnerability\n+                if (!canonicalFile.getPath().startsWith(canonicalDestDir.getPath())) {\n+                    throw new IOException(\"Detected Zip Slip vulnerability: \" + entry.getName());\n+                }\n+\n                 if (entry.isDirectory()) {\n                     FileUtils.forceMkdir(file);\n                 } else {\n@@ -108,6 +115,14 @@ public static void decompressTarGzipFile(InputStream is, File dest) throws IOExc\n             while ((entry = tis.getNextEntry()) != null) {\n                 String name = entry.getName().substring(entry.getName().indexOf('/') + 1);\n                 File file = new File(dest, name);\n+                File canonicalDestDir = dest.getCanonicalFile();\n+                File canonicalFile = file.getCanonicalFile();\n+\n+                // Check for Zip Slip vulnerability\n+                if (!canonicalFile.getPath().startsWith(canonicalDestDir.getPath())) {\n+                    throw new IOException(\"Detected Zip Slip vulnerability: \" + entry.getName());\n+                }\n+\n                 if (entry.isDirectory()) {\n                     FileUtils.forceMkdir(file);\n                 } else {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1a3b18bfb50750a44d136b3bfc849720a01bf92c",
            "date": "2024-12-20T19:13:34Z",
            "author_login": "jakki-amd"
          },
          {
            "sha": "9bcbd22262f44ee28d1b9b1a77be790e91b56dcd",
            "date": "2024-12-19T19:40:44Z",
            "author_login": "jakki-amd"
          },
          {
            "sha": "0985386d5a9bc9dd4fe0feaa7af186e2e5b3a84b",
            "date": "2024-12-05T20:24:11Z",
            "author_login": "ravi9"
          },
          {
            "sha": "31824434aa2acd3ff8261bd18cf6f1d925b8e22a",
            "date": "2024-11-25T17:41:34Z",
            "author_login": "ravi9"
          },
          {
            "sha": "55c2f6b995d55d001d2970bc6c345880fd99c663",
            "date": "2024-11-23T23:21:46Z",
            "author_login": "ravi9"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-22",
    "description": "TorchServe is a tool for serving and scaling PyTorch models in production. Starting in version 0.1.0 and prior to version 0.9.0, using the model/workflow management API, there is a chance of uploading potentially harmful archives that contain files that are extracted to any location on the filesystem that is within the process permissions. Leveraging this issue could aid third-party actors in hiding harmful code in open-source/public models, which can be downloaded from the internet, and take advantage of machines running Torchserve. The ZipSlip issue in TorchServe has been fixed by validating the paths of files contained within a zip archive before extracting them. TorchServe release 0.9.0 includes fixes to address the ZipSlip vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-21T21:15:09.077",
    "last_modified": "2024-11-21T08:31:26.243",
    "fix_date": "2023-09-29T23:46:40Z"
  },
  "references": [
    {
      "url": "https://github.com/pytorch/serve/commit/bfb3d42396727614aef625143b4381e64142f9bb",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/pull/2634",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/releases/tag/v0.9.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/security/advisories/GHSA-m2mj-pr4f-h9jp",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/commit/bfb3d42396727614aef625143b4381e64142f9bb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/pull/2634",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/releases/tag/v0.9.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/pytorch/serve/security/advisories/GHSA-m2mj-pr4f-h9jp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.277892",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "serve",
    "owner": "pytorch",
    "created_at": "2019-10-03T03:17:43Z",
    "updated_at": "2025-01-14T09:46:34Z",
    "pushed_at": "2025-01-01T14:29:12Z",
    "size": 124932,
    "stars": 4265,
    "forks": 867,
    "open_issues": 427,
    "watchers": 4265,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 1124419,
      "Python": 1017170,
      "C++": 149117,
      "Shell": 55226,
      "Jupyter Notebook": 42148,
      "Dockerfile": 11768,
      "CMake": 10030,
      "Mustache": 1583
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:53:39.969349"
  }
}