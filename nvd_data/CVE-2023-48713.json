{
  "cve_id": "CVE-2023-48713",
  "github_data": {
    "repository": "knative/serving",
    "fix_commit": "012ee2509231b80b7842139bfabc30516d3026ca",
    "related_commits": [
      "012ee2509231b80b7842139bfabc30516d3026ca",
      "101f814112b9ca0767f457e7e616b46205551cf1",
      "fff40ef7bac9be8380ec3d1c70fc15b57093382a",
      "012ee2509231b80b7842139bfabc30516d3026ca",
      "101f814112b9ca0767f457e7e616b46205551cf1",
      "fff40ef7bac9be8380ec3d1c70fc15b57093382a"
    ],
    "patch_url": "https://github.com/knative/serving/commit/012ee2509231b80b7842139bfabc30516d3026ca.patch",
    "fix_commit_details": {
      "sha": "012ee2509231b80b7842139bfabc30516d3026ca",
      "commit_date": "2023-10-19T05:29:02Z",
      "author": {
        "login": "knative-prow-robot",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bound buffer for reading stats (#14542)",
        "length": 98,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 18,
        "deletions": 1
      },
      "files": [
        {
          "filename": "pkg/autoscaler/metrics/http_scrape_client.go",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -82,7 +82,9 @@ func statFromProto(body io.Reader) (Stat, error) {\n \tb := pool.Get().(*bytes.Buffer)\n \tb.Reset()\n \tdefer pool.Put(b)\n-\t_, err := b.ReadFrom(body)\n+\t// 6 8-byte fields (+2 bytes marshalling), one hostname, 20 bytes extra space\n+\tr := io.LimitedReader{R: body, N: 6*10 + 256 + 20}\n+\t_, err := b.ReadFrom(&r)\n \tif err != nil {\n \t\treturn emptyStat, fmt.Errorf(\"reading body failed: %w\", err)\n \t}"
        },
        {
          "filename": "pkg/autoscaler/metrics/http_scrape_client_test.go",
          "status": "modified",
          "additions": 15,
          "deletions": 0,
          "patch": "@@ -95,6 +95,21 @@ func TestHTTPScrapeClientScrapeProtoErrorCases(t *testing.T) {\n \t\tresponseCode: http.StatusOK,\n \t\tresponseType: \"text/html\",\n \t\texpectedErr:  errUnsupportedMetricType.Error(),\n+\t}, {\n+\t\tname:         \"LongStat\",\n+\t\tresponseCode: http.StatusOK,\n+\t\tresponseType: \"application/protobuf\",\n+\t\tstat: Stat{\n+\t\t\t// We don't expect PodName to be 600 characters long\n+\t\t\tPodName:                          strings.Repeat(\"a123456789\", 60),\n+\t\t\tAverageConcurrentRequests:        1.1,\n+\t\t\tAverageProxiedConcurrentRequests: 1.1,\n+\t\t\tRequestCount:                     33.2,\n+\t\t\tProxiedRequestCount:              33.2,\n+\t\t\tProcessUptime:                    12345.678,\n+\t\t\tTimestamp:                        1697431278,\n+\t\t},\n+\t\texpectedErr: \"unmarshalling failed: unexpected EOF\",\n \t}}\n \n \tfor _, test := range testCases {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "19b9a095dbf47019c6e26040fb7996780845ae0c",
            "date": "2025-01-14T13:48:01Z",
            "author_login": "dprotaso"
          },
          {
            "sha": "db2721f48a666a4f8afd22c3b39ab2c4e475a939",
            "date": "2025-01-14T12:20:01Z",
            "author_login": "knative-automation"
          },
          {
            "sha": "243e1eaf99c398c4cedcc10dc2fde4369efa2321",
            "date": "2025-01-14T02:45:01Z",
            "author_login": "knative-automation"
          },
          {
            "sha": "dd48437f3dfa8fa68abb69b16796c61e78a5e48f",
            "date": "2025-01-13T21:33:00Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3e6d275e2bc402e7f6bea0a2d0744bb4c9679c75",
            "date": "2025-01-13T16:30:01Z",
            "author_login": "knative-automation"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Knative Serving builds on Kubernetes to support deploying and serving of applications and functions as serverless containers. An attacker who controls a pod to a degree where they can control the responses from the /metrics endpoint can cause Denial-of-Service of the autoscaler from an unbound memory allocation bug. This is a DoS vulnerability, where a non-privileged Knative user can cause a DoS for the cluster. This issue has been patched in version 0.39.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-28T04:15:07.820",
    "last_modified": "2024-11-21T08:32:18.947",
    "fix_date": "2023-10-19T05:29:02Z"
  },
  "references": [
    {
      "url": "https://github.com/knative/serving/commit/012ee2509231b80b7842139bfabc30516d3026ca",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/knative/serving/commit/101f814112b9ca0767f457e7e616b46205551cf1",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/knative/serving/commit/fff40ef7bac9be8380ec3d1c70fc15b57093382a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/knative/serving/security/advisories/GHSA-qmvj-4qr9-v547",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/knative/serving/commit/012ee2509231b80b7842139bfabc30516d3026ca",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/knative/serving/commit/101f814112b9ca0767f457e7e616b46205551cf1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/knative/serving/commit/fff40ef7bac9be8380ec3d1c70fc15b57093382a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/knative/serving/security/advisories/GHSA-qmvj-4qr9-v547",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.290429",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "serving",
    "owner": "knative",
    "created_at": "2018-01-24T22:07:44Z",
    "updated_at": "2025-01-14T13:58:03Z",
    "pushed_at": "2025-01-14T14:21:01Z",
    "size": 99644,
    "stars": 5618,
    "forks": 1167,
    "open_issues": 208,
    "watchers": 5618,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release-0.1",
      "release-0.2",
      "release-0.3",
      "release-0.4",
      "release-0.5",
      "release-0.6",
      "release-0.7",
      "release-0.8",
      "release-0.9",
      "release-0.10",
      "release-0.11",
      "release-0.12",
      "release-0.13",
      "release-0.14",
      "release-0.15",
      "release-0.16",
      "release-0.17",
      "release-0.18",
      "release-0.19",
      "release-0.20",
      "release-0.21",
      "release-0.22",
      "release-0.23",
      "release-0.24",
      "release-0.25",
      "release-0.26",
      "release-1.0",
      "release-1.1",
      "release-1.2"
    ],
    "languages": {
      "Go": 4270150,
      "Shell": 81625
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:39:54.046057"
  }
}