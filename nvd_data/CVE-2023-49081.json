{
  "cve_id": "CVE-2023-49081",
  "github_data": {
    "repository": "aio-libs/aiohttp",
    "fix_commit": "1e86b777e61cf4eefc7d92fa57fa19dcc676013b",
    "related_commits": [
      "1e86b777e61cf4eefc7d92fa57fa19dcc676013b",
      "1e86b777e61cf4eefc7d92fa57fa19dcc676013b"
    ],
    "patch_url": "https://github.com/aio-libs/aiohttp/commit/1e86b777e61cf4eefc7d92fa57fa19dcc676013b.patch",
    "fix_commit_details": {
      "sha": "1e86b777e61cf4eefc7d92fa57fa19dcc676013b",
      "commit_date": "2023-11-13T22:13:06Z",
      "author": {
        "login": "Dreamsorcerer",
        "type": "User",
        "stats": {
          "total_commits": 756,
          "average_weekly_commits": 1.2813559322033898,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 119
        }
      },
      "commit_message": {
        "title": "Disallow arbitrary sequence types in version (#7835)",
        "length": 143,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 25,
        "additions": 20,
        "deletions": 5
      },
      "files": [
        {
          "filename": "CHANGES/7835.bugfix",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+Fixed arbitrary sequence types being allowed to inject headers via version parameter -- by :user:`Dreamsorcerer`"
        },
        {
          "filename": "aiohttp/client_reqrep.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -644,8 +644,8 @@ async def send(self, conn: \"Connection\") -> \"ClientResponse\":\n             self.headers[hdrs.CONNECTION] = connection\n \n         # status + headers\n-        status_line = \"{0} {1} HTTP/{2[0]}.{2[1]}\".format(\n-            self.method, path, self.version\n+        status_line = \"{0} {1} HTTP/{v.major}.{v.minor}\".format(\n+            self.method, path, v=self.version\n         )\n         await writer.write_headers(status_line, self.headers)\n "
        },
        {
          "filename": "tests/test_client_request.py",
          "status": "modified",
          "additions": 17,
          "deletions": 3,
          "patch": "@@ -20,6 +20,7 @@\n     Fingerprint,\n     _gen_default_accept_encoding,\n )\n+from aiohttp.http import HttpVersion\n from aiohttp.test_utils import make_mocked_coro\n \n \n@@ -590,18 +591,18 @@ async def test_connection_header(loop: Any, conn: Any) -> None:\n     req.headers.clear()\n \n     req.keep_alive.return_value = True\n-    req.version = (1, 1)\n+    req.version = HttpVersion(1, 1)\n     req.headers.clear()\n     await req.send(conn)\n     assert req.headers.get(\"CONNECTION\") is None\n \n-    req.version = (1, 0)\n+    req.version = HttpVersion(1, 0)\n     req.headers.clear()\n     await req.send(conn)\n     assert req.headers.get(\"CONNECTION\") == \"keep-alive\"\n \n     req.keep_alive.return_value = False\n-    req.version = (1, 1)\n+    req.version = HttpVersion(1, 1)\n     req.headers.clear()\n     await req.send(conn)\n     assert req.headers.get(\"CONNECTION\") == \"close\"\n@@ -1112,6 +1113,19 @@ async def gen():\n     resp.close()\n \n \n+async def test_bad_version(loop: Any, conn: Any) -> None:\n+    req = ClientRequest(\n+        \"GET\",\n+        URL(\"http://python.org\"),\n+        loop=loop,\n+        headers={\"Connection\": \"Close\"},\n+        version=(\"1\", \"1\\r\\nInjected-Header: not allowed\"),\n+    )\n+\n+    with pytest.raises(AttributeError):\n+        await req.send(conn)\n+\n+\n async def test_custom_response_class(loop: Any, conn: Any) -> None:\n     class CustomResponse(ClientResponse):\n         def read(self, decode=False):"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9482755b40ce69814eea6f65bfbd4c12d1878174",
            "date": "2025-01-10T10:46:29Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "76f4309a6cbfc12d918c65b5bffdcf0d4bb691c6",
            "date": "2025-01-10T10:39:38Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c5c204f8b661bb1c9d183e17b37013ee222b2cbd",
            "date": "2025-01-10T10:37:48Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a91dc8f78e97f9be30e13c39e457e8e2a2651702",
            "date": "2025-01-08T10:27:45Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "237d46722a0e56363c4a07dcf31e73fe4c2ea392",
            "date": "2025-01-07T11:14:58Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-20",
    "description": "aiohttp is an asynchronous HTTP client/server framework for asyncio and Python. Improper validation made it possible for an attacker to modify the HTTP request (e.g. to insert a new header) or create a new HTTP request if the attacker controls the HTTP version. The vulnerability only occurs if the attacker can control the HTTP version of the request. This issue has been patched in version 3.9.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-30T07:15:08.723",
    "last_modified": "2024-11-21T08:32:46.897",
    "fix_date": "2023-11-13T22:13:06Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/jnovikov/184afb593d9c2114d77f508e0ccd508e",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/commit/1e86b777e61cf4eefc7d92fa57fa19dcc676013b",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/pull/7835/files",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-q3qx-c6g2-7pw2",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://gist.github.com/jnovikov/184afb593d9c2114d77f508e0ccd508e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/commit/1e86b777e61cf4eefc7d92fa57fa19dcc676013b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/pull/7835/files",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-q3qx-c6g2-7pw2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.298746",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "aiohttp",
    "owner": "aio-libs",
    "created_at": "2013-10-01T23:04:01Z",
    "updated_at": "2025-01-14T07:45:00Z",
    "pushed_at": "2025-01-13T11:21:32Z",
    "size": 31707,
    "stars": 15317,
    "forks": 2050,
    "open_issues": 250,
    "watchers": 15317,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "3.8",
      "3.9",
      "3.10",
      "3.11",
      "3.12",
      "master"
    ],
    "languages": {
      "Python": 2241563,
      "Cython": 41302,
      "Makefile": 5839,
      "Gherkin": 1248,
      "Dockerfile": 298,
      "C": 170,
      "Shell": 148
    },
    "commit_activity": {
      "total_commits_last_year": 2401,
      "avg_commits_per_week": 46.17307692307692,
      "days_active_last_year": 226
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:12:57.567310"
  }
}