{
  "cve_id": "CVE-2023-49083",
  "github_data": {
    "repository": "pyca/cryptography",
    "fix_commit": "f09c261ca10a31fe41b1262306db7f8f1da0e48a",
    "related_commits": [
      "f09c261ca10a31fe41b1262306db7f8f1da0e48a",
      "f09c261ca10a31fe41b1262306db7f8f1da0e48a"
    ],
    "patch_url": "https://github.com/pyca/cryptography/commit/f09c261ca10a31fe41b1262306db7f8f1da0e48a.patch",
    "fix_commit_details": {
      "sha": "f09c261ca10a31fe41b1262306db7f8f1da0e48a",
      "commit_date": "2023-11-27T19:35:35Z",
      "author": {
        "login": "alex",
        "type": "User",
        "stats": {
          "total_commits": 4529,
          "average_weekly_commits": 7.573578595317726,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 507
        }
      },
      "commit_message": {
        "title": "41.0.6 release (#9927)",
        "length": 313,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 26,
        "deletions": 5
      },
      "files": [
        {
          "filename": "CHANGELOG.rst",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,6 +1,15 @@\n Changelog\n =========\n \n+.. _v41-0-6:\n+\n+41.0.6 - 2023-11-27\n+~~~~~~~~~~~~~~~~~~~\n+\n+* Fixed a null-pointer-dereference and segfault that could occur when loading\n+  certificates from a PKCS#7 bundle.  Credit to **pkuzco** for reporting the\n+  issue. **CVE-2023-49083**\n+\n .. _v41-0-5:\n \n 41.0.5 - 2023-10-24"
        },
        {
          "filename": "docs/spelling_wordlist.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -38,6 +38,7 @@ decrypted\n decrypting\n deprecations\n DER\n+dereference\n deserialize\n deserialized\n Deserialization"
        },
        {
          "filename": "pyproject.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@ build-backend = \"setuptools.build_meta\"\n \n [project]\n name = \"cryptography\"\n-version = \"41.0.5\"\n+version = \"41.0.6\"\n authors = [\n     {name = \"The Python Cryptographic Authority and individual contributors\", email = \"cryptography-dev@python.org\"}\n ]"
        },
        {
          "filename": "src/cryptography/__about__.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n     \"__copyright__\",\n ]\n \n-__version__ = \"41.0.5\"\n+__version__ = \"41.0.6\"\n \n \n __author__ = \"The Python Cryptographic Authority and individual contributors\""
        },
        {
          "filename": "src/cryptography/hazmat/backends/openssl/backend.py",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -1890,9 +1890,12 @@ def _load_pkcs7_certificates(self, p7) -> typing.List[x509.Certificate]:\n                 _Reasons.UNSUPPORTED_SERIALIZATION,\n             )\n \n+        certs: list[x509.Certificate] = []\n+        if p7.d.sign == self._ffi.NULL:\n+            return certs\n+\n         sk_x509 = p7.d.sign.cert\n         num = self._lib.sk_X509_num(sk_x509)\n-        certs = []\n         for i in range(num):\n             x509 = self._lib.sk_X509_value(sk_x509, i)\n             self.openssl_assert(x509 != self._ffi.NULL)"
        },
        {
          "filename": "src/rust/src/lib.rs",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -3,6 +3,8 @@\n // for complete details.\n \n #![deny(rust_2018_idioms)]\n+// Work-around for https://github.com/PyO3/pyo3/issues/3561\n+#![allow(unknown_lints, clippy::unnecessary_fallible_conversions)]\n \n mod asn1;\n mod backend;"
        },
        {
          "filename": "tests/hazmat/primitives/test_pkcs7.py",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -89,6 +89,12 @@ def test_load_pkcs7_unsupported_type(self, backend):\n                 mode=\"rb\",\n             )\n \n+    def test_load_pkcs7_empty_certificates(self, backend):\n+        der = b\"\\x30\\x0B\\x06\\x09\\x2A\\x86\\x48\\x86\\xF7\\x0D\\x01\\x07\\x02\"\n+\n+        certificates = pkcs7.load_der_pkcs7_certificates(der)\n+        assert certificates == []\n+\n \n # We have no public verification API and won't be adding one until we get\n # some requirements from users so this function exists to give us basic"
        },
        {
          "filename": "vectors/cryptography_vectors/__about__.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,4 +6,4 @@\n     \"__version__\",\n ]\n \n-__version__ = \"41.0.5\"\n+__version__ = \"41.0.6\""
        },
        {
          "filename": "vectors/pyproject.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -4,7 +4,7 @@ build-backend = \"setuptools.build_meta\"\n \n [project]\n name = \"cryptography_vectors\"\n-version = \"41.0.5\"\n+version = \"41.0.6\"\n authors = [\n     {name = \"The Python Cryptographic Authority and individual contributors\", email = \"cryptography-dev@python.org\"}\n ]"
        }
      ],
      "file_patterns": {
        "security_files": 3,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 8,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b74d321d16c0927d5c705104644ad0addd762e5a",
            "date": "2025-01-14T00:39:01Z",
            "author_login": "pyca-boringbot[bot]"
          },
          {
            "sha": "b15591e93af508bf3fa9af51e94d65a46fe72d82",
            "date": "2025-01-14T00:36:50Z",
            "author_login": "pyca-boringbot[bot]"
          },
          {
            "sha": "78d354711b20e6e6cb23ca5879cae7030d46673a",
            "date": "2025-01-13T14:44:59Z",
            "author_login": "alex"
          },
          {
            "sha": "b17c77b5d730df63238a30a456a7d18cb50cc1af",
            "date": "2025-01-13T12:49:21Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "cf8ec124724c557bd55735fc72035c53030b7481",
            "date": "2025-01-13T12:48:54Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-476",
    "description": "cryptography is a package designed to expose cryptographic primitives and recipes to Python developers. Calling `load_pem_pkcs7_certificates` or `load_der_pkcs7_certificates` could lead to a NULL-pointer dereference and segfault. Exploitation of this vulnerability poses a serious risk of Denial of Service (DoS) for any application attempting to deserialize a PKCS7 blob/certificate. The consequences extend to potential disruptions in system availability and stability. This vulnerability has been patched in version 41.0.6.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-11-29T19:15:07.967",
    "last_modified": "2024-11-21T08:32:47.163",
    "fix_date": "2023-11-27T19:35:35Z"
  },
  "references": [
    {
      "url": "https://github.com/pyca/cryptography/commit/f09c261ca10a31fe41b1262306db7f8f1da0e48a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pyca/cryptography/pull/9926",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pyca/cryptography/security/advisories/GHSA-jfhm-5ghh-2f97",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QMNTYMUGFJSDBYBU22FUYBHFRZODRKXV/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/pyca/cryptography/commit/f09c261ca10a31fe41b1262306db7f8f1da0e48a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pyca/cryptography/pull/9926",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pyca/cryptography/security/advisories/GHSA-jfhm-5ghh-2f97",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QMNTYMUGFJSDBYBU22FUYBHFRZODRKXV/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.295651",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cryptography",
    "owner": "pyca",
    "created_at": "2013-08-07T02:23:38Z",
    "updated_at": "2025-01-14T00:39:06Z",
    "pushed_at": "2025-01-14T00:39:02Z",
    "size": 57765,
    "stars": 6794,
    "forks": 1553,
    "open_issues": 51,
    "watchers": 6794,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.2.x",
      "0.5.x",
      "0.6.x",
      "0.7.x",
      "0.8.x",
      "0.9.x",
      "1.0.x",
      "1.1.x",
      "1.2.x",
      "1.3.x",
      "1.5.x",
      "1.7.x",
      "1.8.x",
      "2.0.x",
      "2.1.x",
      "2.2.x",
      "2.3.x",
      "2.4.x",
      "2.9.x",
      "3.1.x",
      "3.2.x",
      "3.3.x",
      "3.4.x",
      "36.0.x",
      "37.0.x",
      "38.0.x",
      "39.0.x",
      "40.0.x",
      "41.0.x",
      "42.0.x"
    ],
    "languages": {
      "Python": 2248082,
      "Rust": 816136,
      "Shell": 1558
    },
    "commit_activity": {
      "total_commits_last_year": 1726,
      "avg_commits_per_week": 33.19230769230769,
      "days_active_last_year": 341
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:53:50.605682"
  }
}