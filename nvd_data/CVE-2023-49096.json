{
  "cve_id": "CVE-2023-49096",
  "github_data": {
    "repository": "jellyfin/jellyfin",
    "fix_commit": "a656799dc879d16d21bf2ce7ad412ebd5d45394a",
    "related_commits": [
      "a656799dc879d16d21bf2ce7ad412ebd5d45394a",
      "a656799dc879d16d21bf2ce7ad412ebd5d45394a"
    ],
    "patch_url": "https://github.com/jellyfin/jellyfin/commit/a656799dc879d16d21bf2ce7ad412ebd5d45394a.patch",
    "fix_commit_details": {
      "sha": "a656799dc879d16d21bf2ce7ad412ebd5d45394a",
      "commit_date": "2023-11-29T03:20:32Z",
      "author": {
        "login": "joshuaboniface",
        "type": "User",
        "stats": {
          "total_commits": 1057,
          "average_weekly_commits": 1.696629213483146,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 156
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-866x-wj5j-2vf4",
        "length": 73,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 117,
        "additions": 66,
        "deletions": 51
      },
      "files": [
        {
          "filename": "Jellyfin.Api/Controllers/AudioController.cs",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -91,18 +91,18 @@ public AudioController(AudioHelper audioHelper)\n         [ProducesAudioFile]\n         public async Task<ActionResult> GetAudioStream(\n             [FromRoute, Required] Guid itemId,\n-            [FromQuery] string? container,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? container,\n             [FromQuery] bool? @static,\n             [FromQuery] string? @params,\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -132,8 +132,8 @@ public async Task<ActionResult> GetAudioStream(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -262,12 +262,12 @@ public async Task<ActionResult> GetAudioStreamByContainer(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -297,8 +297,8 @@ public async Task<ActionResult> GetAudioStreamByContainer(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,"
        },
        {
          "filename": "Jellyfin.Api/Controllers/DynamicHlsController.cs",
          "status": "modified",
          "additions": 29,
          "deletions": 29,
          "patch": "@@ -174,18 +174,18 @@ public DynamicHlsController(\n         [ProducesPlaylistFile]\n         public async Task<ActionResult> GetLiveHlsStream(\n             [FromRoute, Required] Guid itemId,\n-            [FromQuery] string? container,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? container,\n             [FromQuery] bool? @static,\n             [FromQuery] string? @params,\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -215,8 +215,8 @@ public async Task<ActionResult> GetLiveHlsStream(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -426,12 +426,12 @@ public async Task<ActionResult> GetMasterHlsVideoPlaylist(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery, Required] string mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -463,8 +463,8 @@ public async Task<ActionResult> GetMasterHlsVideoPlaylist(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -596,12 +596,12 @@ public async Task<ActionResult> GetMasterHlsAudioPlaylist(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery, Required] string mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -632,8 +632,8 @@ public async Task<ActionResult> GetMasterHlsAudioPlaylist(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -762,12 +762,12 @@ public async Task<ActionResult> GetVariantHlsVideoPlaylist(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -799,8 +799,8 @@ public async Task<ActionResult> GetVariantHlsVideoPlaylist(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -930,12 +930,12 @@ public async Task<ActionResult> GetVariantHlsAudioPlaylist(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -966,8 +966,8 @@ public async Task<ActionResult> GetVariantHlsAudioPlaylist(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -1107,12 +1107,12 @@ public async Task<ActionResult> GetHlsVideoSegment(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -1144,8 +1144,8 @@ public async Task<ActionResult> GetHlsVideoSegment(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -1288,12 +1288,12 @@ public async Task<ActionResult> GetHlsAudioSegment(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -1324,8 +1324,8 @@ public async Task<ActionResult> GetHlsAudioSegment(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,"
        },
        {
          "filename": "Jellyfin.Api/Controllers/UniversalAudioController.cs",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -102,13 +102,13 @@ public async Task<ActionResult> GetUniversalAudioStream(\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n             [FromQuery] Guid? userId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] int? maxAudioChannels,\n             [FromQuery] int? transcodingAudioChannels,\n             [FromQuery] int? maxStreamingBitrate,\n             [FromQuery] int? audioBitRate,\n             [FromQuery] long? startTimeTicks,\n-            [FromQuery] string? transcodingContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? transcodingContainer,\n             [FromQuery] string? transcodingProtocol,\n             [FromQuery] int? maxAudioSampleRate,\n             [FromQuery] int? maxAudioBitDepth,"
        },
        {
          "filename": "Jellyfin.Api/Controllers/VideosController.cs",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -318,18 +318,18 @@ public async Task<ActionResult> MergeVersions([FromQuery, Required, ModelBinder(\n         [ProducesVideoFile]\n         public async Task<ActionResult> GetVideoStream(\n             [FromRoute, Required] Guid itemId,\n-            [FromQuery] string? container,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? container,\n             [FromQuery] bool? @static,\n             [FromQuery] string? @params,\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -361,8 +361,8 @@ public async Task<ActionResult> GetVideoStream(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,\n@@ -578,12 +578,12 @@ public Task<ActionResult> GetVideoStreamByContainer(\n             [FromQuery] string? tag,\n             [FromQuery] string? deviceProfileId,\n             [FromQuery] string? playSessionId,\n-            [FromQuery] string? segmentContainer,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? segmentContainer,\n             [FromQuery] int? segmentLength,\n             [FromQuery] int? minSegments,\n             [FromQuery] string? mediaSourceId,\n             [FromQuery] string? deviceId,\n-            [FromQuery] string? audioCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? audioCodec,\n             [FromQuery] bool? enableAutoStreamCopy,\n             [FromQuery] bool? allowVideoStreamCopy,\n             [FromQuery] bool? allowAudioStreamCopy,\n@@ -615,8 +615,8 @@ public Task<ActionResult> GetVideoStreamByContainer(\n             [FromQuery] int? cpuCoreLimit,\n             [FromQuery] string? liveStreamId,\n             [FromQuery] bool? enableMpegtsM2TsMode,\n-            [FromQuery] string? videoCodec,\n-            [FromQuery] string? subtitleCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? videoCodec,\n+            [FromQuery][RegularExpression(EncodingHelper.ValidationRegex)] string? subtitleCodec,\n             [FromQuery] string? transcodeReasons,\n             [FromQuery] int? audioStreamIndex,\n             [FromQuery] int? videoStreamIndex,"
        },
        {
          "filename": "MediaBrowser.Controller/MediaEncoding/EncodingHelper.cs",
          "status": "modified",
          "additions": 17,
          "deletions": 2,
          "patch": "@@ -25,6 +25,11 @@ namespace MediaBrowser.Controller.MediaEncoding\n {\n     public class EncodingHelper\n     {\n+        /// <summary>\n+        /// The codec validation regex.\n+        /// </summary>\n+        public const string ValidationRegex = @\"^[a-zA-Z0-9\\-\\._,|]{0,40}$\";\n+\n         private const string QsvAlias = \"qs\";\n         private const string VaapiAlias = \"va\";\n         private const string D3d11vaAlias = \"dx11\";\n@@ -36,6 +41,8 @@ public class EncodingHelper\n         private readonly ISubtitleEncoder _subtitleEncoder;\n         private readonly IConfiguration _config;\n \n+        private static readonly Regex _validationRegex = new(ValidationRegex, RegexOptions.Compiled);\n+\n         // i915 hang was fixed by linux 6.2 (3f882f2)\n         private readonly Version _minKerneli915Hang = new Version(5, 18);\n         private readonly Version _maxKerneli915Hang = new Version(6, 1, 3);\n@@ -253,7 +260,10 @@ public string GetVideoEncoder(EncodingJobInfo state, EncodingOptions encodingOpt\n                     return \"libtheora\";\n                 }\n \n-                return codec.ToLowerInvariant();\n+                if (_validationRegex.IsMatch(codec))\n+                {\n+                    return codec.ToLowerInvariant();\n+                }\n             }\n \n             return \"copy\";\n@@ -276,7 +286,7 @@ public string GetUserAgentParam(EncodingJobInfo state)\n \n         public static string GetInputFormat(string container)\n         {\n-            if (string.IsNullOrEmpty(container))\n+            if (string.IsNullOrEmpty(container) || !_validationRegex.IsMatch(container))\n             {\n                 return null;\n             }\n@@ -523,6 +533,11 @@ public string GetAudioEncoder(EncodingJobInfo state)\n         {\n             var codec = state.OutputAudioCodec;\n \n+            if (!_validationRegex.IsMatch(codec))\n+            {\n+                codec = \"aac\";\n+            }\n+\n             if (string.Equals(codec, \"aac\", StringComparison.OrdinalIgnoreCase))\n             {\n                 // Use libfdk_aac for better audio quality if using custom build of FFmpeg which has fdk_aac support"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "85e0cad5f3a58668e0dca02b6cb501d2cdcf4a06",
            "date": "2025-01-13T10:07:44Z",
            "author_login": "Bond-009"
          },
          {
            "sha": "0409849cc7dc01b68376a45354e9922dd58fae5b",
            "date": "2025-01-12T04:22:57Z",
            "author_login": "marudosurdo"
          },
          {
            "sha": "4c1a47bc5311c0d15c3ffd42b0c0080a5ae77536",
            "date": "2025-01-11T20:26:51Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "fb5da641f418f5e696d3d021fa3638bde456e981",
            "date": "2025-01-11T16:37:28Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "fd3057b54957a8980acf90ade54d38341e6d695d",
            "date": "2025-01-11T16:37:13Z",
            "author_login": "nielsvanvelzen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L",
    "cwe_id": "CWE-88",
    "description": "Jellyfin is a Free Software Media System for managing and streaming media. In affected versions there is an argument injection in the VideosController, specifically the `/Videos/<itemId>/stream` and `/Videos/<itemId>/stream.<container>` endpoints which are present in the current Jellyfin version. Additional endpoints in the AudioController might also be vulnerable, as they differ only slightly in execution. Those endpoints are reachable by an unauthenticated user. In order to exploit this vulnerability an unauthenticated attacker has to guess an itemId, which is a completely random GUID. It\u2019s a very unlikely case even for a large media database with lots of items. Without an additional information leak, this vulnerability shouldn\u2019t be directly exploitable, even if the instance is reachable from the Internet. There are a lot of query parameters that get accepted by the method. At least two of those, videoCodec and audioCodec are vulnerable to the argument injection. The values can be traced through a lot of code and might be changed in the process. However, the fallback is to always use them as-is, which means we can inject our own arguments. Those arguments land in the command line of FFmpeg. Because UseShellExecute is always set to false, we can\u2019t simply terminate the FFmpeg command and execute our own. It should only be possible to add additional arguments to FFmpeg, which is powerful enough as it stands. There is probably a way of overwriting an arbitrary file with malicious content. This vulnerability has been addressed in version 10.8.13. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-12-06T20:15:07.287",
    "last_modified": "2024-11-21T08:32:48.887",
    "fix_date": "2023-11-29T03:20:32Z"
  },
  "references": [
    {
      "url": "https://cwe.mitre.org/data/definitions/88.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://en.wikipedia.org/wiki/Pass_the_hash",
      "source": "security-advisories@github.com",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://ffmpeg.org/ffmpeg-filters.html#drawtext-1",
      "source": "security-advisories@github.com",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/commit/a656799dc879d16d21bf2ce7ad412ebd5d45394a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/issues/5415",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/security/advisories/GHSA-866x-wj5j-2vf4",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/88.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://en.wikipedia.org/wiki/Pass_the_hash",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://ffmpeg.org/ffmpeg-filters.html#drawtext-1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/commit/a656799dc879d16d21bf2ce7ad412ebd5d45394a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/issues/5415",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/jellyfin/jellyfin/security/advisories/GHSA-866x-wj5j-2vf4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:41.537133",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jellyfin",
    "owner": "jellyfin",
    "created_at": "2018-12-09T06:36:45Z",
    "updated_at": "2025-01-14T17:21:41Z",
    "pushed_at": "2025-01-14T14:01:31Z",
    "size": 65488,
    "stars": 36462,
    "forks": 3298,
    "open_issues": 607,
    "watchers": 36462,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "release-10.1.0",
      "release-10.2.z",
      "release-10.3.z",
      "release-10.4.z",
      "release-10.5.z",
      "release-10.6.z",
      "release-10.7.z",
      "release-10.8.z",
      "release-10.9.z",
      "release-10.10.z"
    ],
    "languages": {
      "C#": 8009710,
      "HTML": 20081,
      "Shell": 3658,
      "CSS": 329
    },
    "commit_activity": {
      "total_commits_last_year": 1480,
      "avg_commits_per_week": 28.46153846153846,
      "days_active_last_year": 314
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T17:23:28.929778"
  }
}