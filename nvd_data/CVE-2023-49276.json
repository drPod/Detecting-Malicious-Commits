{
  "cve_id": "CVE-2023-49276",
  "github_data": {
    "repository": "louislam/uptime-kuma",
    "fix_commit": "f28dccf4e11f041564293e4f407e69ab9ee2277f",
    "related_commits": [
      "f28dccf4e11f041564293e4f407e69ab9ee2277f",
      "f28dccf4e11f041564293e4f407e69ab9ee2277f"
    ],
    "patch_url": "https://github.com/louislam/uptime-kuma/commit/f28dccf4e11f041564293e4f407e69ab9ee2277f.patch",
    "fix_commit_details": {
      "sha": "f28dccf4e11f041564293e4f407e69ab9ee2277f",
      "commit_date": "2023-11-24T09:18:01Z",
      "author": {
        "login": "louislam",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-v4v2-8h88-65qj",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 29,
        "additions": 20,
        "deletions": 9
      },
      "files": [
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 10,
          "deletions": 4,
          "patch": "@@ -33,6 +33,7 @@\n                 \"express-static-gzip\": \"~2.1.7\",\n                 \"form-data\": \"~4.0.0\",\n                 \"gamedig\": \"~4.1.0\",\n+                \"html-escaper\": \"^3.0.3\",\n                 \"http-graceful-shutdown\": \"~3.1.7\",\n                 \"http-proxy-agent\": \"~5.0.0\",\n                 \"https-proxy-agent\": \"~5.0.1\",\n@@ -10747,10 +10748,9 @@\n             \"dev\": true\n         },\n         \"node_modules/html-escaper\": {\n-            \"version\": \"2.0.2\",\n-            \"resolved\": \"https://registry.npmjs.org/html-escaper/-/html-escaper-2.0.2.tgz\",\n-            \"integrity\": \"sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==\",\n-            \"dev\": true\n+            \"version\": \"3.0.3\",\n+            \"resolved\": \"https://registry.npmjs.org/html-escaper/-/html-escaper-3.0.3.tgz\",\n+            \"integrity\": \"sha512-RuMffC89BOWQoY0WKGpIhn5gX3iI54O6nRA0yC124NYVtzjmFWBIiFd8M0x+ZdX0P9R4lADg1mgP8C7PxGOWuQ==\"\n         },\n         \"node_modules/html-tags\": {\n             \"version\": \"3.3.1\",\n@@ -11558,6 +11558,12 @@\n                 \"node\": \">=8\"\n             }\n         },\n+        \"node_modules/istanbul-reports/node_modules/html-escaper\": {\n+            \"version\": \"2.0.2\",\n+            \"resolved\": \"https://registry.npmjs.org/html-escaper/-/html-escaper-2.0.2.tgz\",\n+            \"integrity\": \"sha512-H2iMtd0I4Mt5eYiapRdIDjp+XzelXQ0tFE4JS7YFwFevXXMmOp9myNrUvCg0D6ws8iqkRPBfKHgbwig1SmlLfg==\",\n+            \"dev\": true\n+        },\n         \"node_modules/jackspeak\": {\n             \"version\": \"2.3.6\",\n             \"resolved\": \"https://registry.npmjs.org/jackspeak/-/jackspeak-2.3.6.tgz\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -100,6 +100,7 @@\n         \"express-static-gzip\": \"~2.1.7\",\n         \"form-data\": \"~4.0.0\",\n         \"gamedig\": \"~4.1.0\",\n+        \"html-escaper\": \"^3.0.3\",\n         \"http-graceful-shutdown\": \"~3.1.7\",\n         \"http-proxy-agent\": \"~5.0.0\",\n         \"https-proxy-agent\": \"~5.0.1\","
        },
        {
          "filename": "server/google-analytics.js",
          "status": "modified",
          "additions": 9,
          "deletions": 5,
          "patch": "@@ -1,4 +1,5 @@\n const jsesc = require(\"jsesc\");\n+const { escape } = require(\"html-escaper\");\n \n /**\n  * Returns a string that represents the javascript that is required to insert the Google Analytics scripts\n@@ -7,15 +8,18 @@ const jsesc = require(\"jsesc\");\n  * @returns {string}\n  */\n function getGoogleAnalyticsScript(tagId) {\n-    let escapedTagId = jsesc(tagId, { isScriptContext: true });\n+    let escapedTagIdJS = jsesc(tagId, { isScriptContext: true });\n \n-    if (escapedTagId) {\n-        escapedTagId = escapedTagId.trim();\n+    if (escapedTagIdJS) {\n+        escapedTagIdJS = escapedTagIdJS.trim();\n     }\n \n+    // Escape the tag ID for use in an HTML attribute.\n+    let escapedTagIdHTMLAttribute = escape(tagId);\n+\n     return `\n-        <script async src=\"https://www.googletagmanager.com/gtag/js?id=${escapedTagId}\"></script>\n-        <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date());gtag('config', '${escapedTagId}'); </script>\n+        <script async src=\"https://www.googletagmanager.com/gtag/js?id=${escapedTagIdHTMLAttribute}\"></script>\n+        <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date());gtag('config', '${escapedTagIdJS}'); </script>\n     `;\n }\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "be2faf64ce8973d49d6c4b29dacdedbffc57855e",
            "date": "2024-12-22T05:46:13Z",
            "author_login": "louislam"
          },
          {
            "sha": "0b76e1940105117ed59c42105f4c8211ff4823d5",
            "date": "2024-12-22T05:45:19Z",
            "author_login": "louislam"
          },
          {
            "sha": "97cbaac5d94b5107c3b7da6ad4fca7cc7f2c8859",
            "date": "2024-12-21T11:26:36Z",
            "author_login": "Ionys320"
          },
          {
            "sha": "fd55659c2b209bc6780151f7c8c18378bffb8c44",
            "date": "2024-12-20T08:47:00Z",
            "author_login": "louislam"
          },
          {
            "sha": "20da4d29ab9c7325050f158f8af6ad1eed353002",
            "date": "2024-12-20T08:42:59Z",
            "author_login": "louislam"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Uptime Kuma is an open source self-hosted monitoring tool. In affected versions the Google Analytics element in vulnerable to Attribute Injection leading to Cross-Site-Scripting (XSS). Since the custom status interface can set an independent Google Analytics ID and the template has not been sanitized, there is an attribute injection vulnerability here, which can lead to XSS attacks. This vulnerability has been addressed in commit `f28dccf4e` which is included in release version 1.23.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-12-01T22:15:10.563",
    "last_modified": "2024-11-21T08:33:10.040",
    "fix_date": "2023-11-24T09:18:01Z"
  },
  "references": [
    {
      "url": "https://github.com/louislam/uptime-kuma/commit/f28dccf4e11f041564293e4f407e69ab9ee2277f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/louislam/uptime-kuma/security/advisories/GHSA-v4v2-8h88-65qj",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/louislam/uptime-kuma/commit/f28dccf4e11f041564293e4f407e69ab9ee2277f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/louislam/uptime-kuma/security/advisories/GHSA-v4v2-8h88-65qj",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.305075",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "uptime-kuma",
    "owner": "louislam",
    "created_at": "2021-07-03T01:02:42Z",
    "updated_at": "2025-01-14T13:35:01Z",
    "pushed_at": "2025-01-02T14:43:40Z",
    "size": 27366,
    "stars": 62522,
    "forks": 5572,
    "open_issues": 773,
    "watchers": 62522,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.23.X",
      "1.23.X-npm-update",
      "1.23.X-to-2",
      "2.0-last-part",
      "2.0.X",
      "2.1.X",
      "ansible-unofficial",
      "api-via-socketio-client",
      "async-fs",
      "check-lang-json",
      "convert-backend-test",
      "custom-head",
      "escaped-debug",
      "extracted-grpc-monitor",
      "fix-2.0.0-docs-update",
      "fix-check-migrate",
      "fix-data-type",
      "fix-knex",
      "fix-push-examples",
      "fix-weblate-conflict",
      "improve-heartbeat-msg",
      "master",
      "nfs-warning",
      "node22",
      "npm-publish",
      "queue",
      "release",
      "revert-4376-progress-bar-redesign",
      "revert-4704-dynamic_prometheus_labels",
      "testcontainers"
    ],
    "languages": {
      "JavaScript": 905295,
      "Vue": 681744,
      "TypeScript": 22221,
      "SCSS": 15534,
      "Dockerfile": 4408,
      "Go": 2699,
      "Shell": 2058,
      "HTML": 1102,
      "Java": 908,
      "C#": 557,
      "PowerShell": 387,
      "PHP": 322,
      "Python": 216
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:41:21.643142"
  }
}