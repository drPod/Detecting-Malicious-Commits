{
  "cve_id": "CVE-2023-4928",
  "github_data": {
    "repository": "instantsoft/icms2",
    "fix_commit": "3a6b148fa2c943ee7647e0cd14bf68e026b15548",
    "related_commits": [
      "3a6b148fa2c943ee7647e0cd14bf68e026b15548",
      "3a6b148fa2c943ee7647e0cd14bf68e026b15548"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3a6b148fa2c943ee7647e0cd14bf68e026b15548",
      "commit_date": "2023-09-12T15:12:27Z",
      "author": {
        "login": "fuzegit",
        "type": "User",
        "stats": {
          "total_commits": 858,
          "average_weekly_commits": 1.719438877755511,
          "total_additions": 469194,
          "total_deletions": 330759,
          "weeks_active": 256
        }
      },
      "commit_message": {
        "title": "Fix SQL Injection in datagrid advanced filter",
        "length": 45,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 186,
        "additions": 108,
        "deletions": 78
      },
      "files": [
        {
          "filename": "system/config/version.ini",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2,4 +2,4 @@\n major = 2\n minor = 16\n build = 1\n-date = 20230613\n\\ No newline at end of file\n+date = 20230912\n\\ No newline at end of file"
        },
        {
          "filename": "system/controllers/admin/frontend.php",
          "status": "modified",
          "additions": 12,
          "deletions": 4,
          "patch": "@@ -707,11 +707,19 @@ public function getControllersFilesEvents() {\n \n         foreach ($controllers as $controller_name) {\n \n-            $ctrl_file = $this->cms_config->root_path . 'system/controllers/'.$controller_name.'/frontend.php';\n-            if(!is_readable($ctrl_file)){ continue; }\n+            if (!cmsController::enabled($controller_name)) {\n+                continue;\n+            }\n+\n+            $ctrl_file = $this->cms_config->root_path . 'system/controllers/' . $controller_name . '/frontend.php';\n+            if (!is_readable($ctrl_file)) {\n+                continue;\n+            }\n \n             $hooks = cmsCore::getFilesList('system/controllers/' . $controller_name . '/hooks', '*.php', true, true);\n-            if (!$hooks) { continue; }\n+            if (!$hooks) {\n+                continue;\n+            }\n \n             $controller_object = cmsCore::getController($controller_name);\n \n@@ -724,7 +732,7 @@ public function getControllersFilesEvents() {\n                 // \u041d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0445\u0443\u043a\u0438 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445,\n                 // \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0445\u0443\u043a\u0438 \u0434\u043b\u044f CRON \u0438\u043b\u0438 \u0438\u043d\u044b\u0435, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0432\u044b\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e\n                 // \u0421\u0432\u043e\u0439\u0441\u0442\u0432\u043e $disallow_event_db_register \u0432 \u043a\u043b\u0430\u0441\u0441\u0435 \u0445\u0443\u043a\u0430 \u0440\u0435\u0433\u0443\u043b\u0438\u0440\u0443\u0435\u0442 \u044d\u0442\u043e \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435\n-                if(empty($hook_object->disallow_event_db_register)){\n+                if (empty($hook_object->disallow_event_db_register)) {\n \n                     $events[$controller_name][$index] = $event_name;\n "
        },
        {
          "filename": "system/controllers/moderation/backend/actions/logs.php",
          "status": "modified",
          "additions": 39,
          "deletions": 53,
          "patch": "@@ -2,51 +2,50 @@\n \n class actionModerationLogs extends cmsAction {\n \n-    public function run($target_controller = null, $target_subject = null, $target_id = null, $moderator_id = null){\n+    public function run($target_controller = null, $target_subject = null, $target_id = null, $moderator_id = null) {\n \n         cmsCore::loadAllControllersLanguages();\n \n         $grid = $this->loadDataGrid('logs');\n \n-        $url           = href_to($this->root_url, 'logs');\n-        $sub_url       = array();\n-        $url_query     = array();\n-        $additional_h1 = array();\n+        $url             = href_to($this->root_url, 'logs');\n+        $sub_url         = [];\n+        $url_query       = [];\n+        $additional_h1   = [];\n         $subj_controller = null;\n \n-        $action = $this->request->get('action', -1);\n+        $action         = $this->request->get('action', -1);\n         $only_to_delete = $this->request->get('only_to_delete', 0);\n-        if($action > -1){\n+\n+        if ($action > -1) {\n \n             $this->model->filterEqual('action', $action);\n \n-            if($only_to_delete){\n+            if ($only_to_delete) {\n \n                 $this->model->filterNotNull('date_expired');\n \n                 $url_query['only_to_delete'] = $only_to_delete;\n-\n             }\n \n-            $additional_h1[] = string_lang('LANG_MODERATION_ACTION_'.$action);\n+            $additional_h1[] = string_lang('LANG_MODERATION_ACTION_' . $action);\n \n             $url_query['action'] = $action;\n-\n         }\n \n-        if(!empty($target_controller)){\n+        if (!empty($target_controller)) {\n \n             $subj_controller = cmsCore::getController($target_controller);\n \n             $this->model->filterEqual('target_controller', $target_controller);\n \n             $sub_url[] = $target_controller;\n \n-            if(!empty($target_subject)){\n+            if (!empty($target_subject)) {\n \n                 $ctype = $subj_controller->getContentTypeForModeration($target_subject);\n \n-                if($ctype){\n+                if ($ctype) {\n                     $target_subject = $ctype['name'];\n                 } else {\n                     return cmsCore::error404();\n@@ -56,45 +55,42 @@ public function run($target_controller = null, $target_subject = null, $target_i\n \n                 $sub_url[] = $target_subject;\n \n-                if($ctype){\n+                if ($ctype) {\n                     $additional_h1[] = $ctype['title'];\n                 }\n \n-                if(!empty($target_id)){\n+                if (!empty($target_id)) {\n \n                     $this->model->filterEqual('target_id', $target_id);\n \n                     $sub_url[] = $target_id;\n \n                     $this->model->lockFilters();\n \n-                        $item = $this->model->getItem('moderators_logs', function ($item, $model){\n-                            $item['data'] = cmsModel::yamlToArray($item['data']);\n-                            return $item;\n-                        });\n+                    $item = $this->model->getItem('moderators_logs', function ($item, $model) {\n+                        $item['data'] = cmsModel::yamlToArray($item['data']);\n+                        return $item;\n+                    });\n \n-                        if($item){\n-                            $additional_h1[] = $item['data']['title'];\n-                        }\n+                    if ($item) {\n+                        $additional_h1[] = $item['data']['title'];\n+                    }\n \n                     $this->model->unlockFilters();\n-\n                 }\n-\n             }\n-\n         }\n \n-        if(!empty($moderator_id)){\n+        if (!empty($moderator_id)) {\n \n             $this->model->filterEqual('moderator_id', $moderator_id);\n \n-            if(count($sub_url) == 3){\n+            if (count($sub_url) == 3) {\n                 $sub_url[] = $moderator_id;\n-            } elseif(count($sub_url) == 2){\n+            } elseif (count($sub_url) == 2) {\n                 $sub_url[] = 0;\n                 $sub_url[] = $moderator_id;\n-            } elseif(count($sub_url) == 1){\n+            } elseif (count($sub_url) == 1) {\n                 $sub_url[] = 0;\n                 $sub_url[] = 0;\n                 $sub_url[] = $moderator_id;\n@@ -107,67 +103,57 @@ public function run($target_controller = null, $target_subject = null, $target_i\n \n             $user = cmsCore::getModel('users')->getuser($moderator_id);\n \n-            if($user){\n+            if ($user) {\n                 $additional_h1[] = $user['nickname'];\n             }\n-\n         }\n \n         if ($this->request->isAjax()) {\n \n-            $filter     = array();\n+            $filter     = [];\n             $filter_str = $this->request->get('filter', '');\n \n-            if ($filter_str){\n+            if ($filter_str) {\n                 parse_str($filter_str, $filter);\n-                $this->model->applyGridFilter($grid, $filter);\n+                $grid->applyGridFilter($this->model, $filter, 'moderators_logs');\n             }\n \n             $total = $this->model->getCount('moderators_logs');\n-            $perpage = isset($filter['perpage']) ? $filter['perpage'] : admin::perpage;\n-            $pages = ceil($total / $perpage);\n \n             $this->model->joinUserLeft('moderator_id');\n \n-            $data = $this->model->get('moderators_logs', function ($item, $model) use($subj_controller){\n+            $data = $this->model->get('moderators_logs', function ($item, $model) use ($subj_controller) {\n \n                 $item['data'] = cmsModel::yamlToArray($item['data']);\n \n-                $item['controller_title'] = string_lang($item['target_controller'].'_CONTROLLER');\n+                $item['controller_title'] = string_lang($item['target_controller'] . '_CONTROLLER');\n \n                 $item['subject_title'] = $item['controller_title'];\n \n-                if($subj_controller !== null){\n+                if ($subj_controller !== null) {\n \n                     $ctype = $subj_controller->getContentTypeForModeration($item['target_subject']);\n \n                     $item['subject_title'] = $ctype['title'];\n-\n                 }\n \n                 return $item;\n+            }) ?: [];\n \n-            });\n-\n-            $this->cms_template->renderGridRowsJSON($grid, $data, $total, $pages);\n-\n-            $this->halt();\n-\n+            return $this->cms_template->renderJSON($grid->makeGridRows($data, $total));\n         }\n \n-        if($additional_h1){\n+        if ($additional_h1) {\n             $this->cms_template->setPageH1($additional_h1);\n         }\n \n         $this->model->resetFilters();\n \n-\t\treturn $this->cms_template->render('backend/logs', array(\n+        return $this->cms_template->render('backend/logs', [\n             'grid'      => $grid,\n             'sub_url'   => $sub_url,\n             'url_query' => $url_query,\n-            'url'       => $url.($sub_url ? '/'.implode('/', $sub_url) : '').(($action > -1) ? '?'.http_build_query($url_query) : '')\n-        ));\n-\n+            'url'       => $url . ($sub_url ? '/' . implode('/', $sub_url) : '') . (($action > -1) ? '?' . http_build_query($url_query) : '')\n+        ]);\n     }\n-\n }"
        },
        {
          "filename": "system/core/grid.php",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -239,7 +239,7 @@ private function load() {\n \n         foreach ($grid as $key => $data) {\n \n-            $this->grid[$key] = array_merge(($this->grid[$key] ?? []), $data);\n+            $this->grid[$key] = is_array($data) ? array_merge(($this->grid[$key] ?? []), $data) : $data;\n         }\n \n         // \u0424\u0438\u043b\u044c\u0442\u0440 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e\n@@ -429,9 +429,10 @@ public function addToFilter($filter) {\n      *\n      * @param cmsModel $model \u041e\u0431\u044a\u0435\u043a\u0442 \u043c\u043e\u0434\u0435\u043b\u0438, \u0433\u0434\u0435 \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u043c \u0437\u0430\u043f\u0438\u0441\u0438\n      * @param array $filter \u041c\u0430\u0441\u0441\u0438\u0432 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438\n+     * @param array $table_name \u0422\u0430\u0431\u043b\u0438\u0446\u0430, \u0433\u0434\u0435 \u0438\u0449\u0435\u043c \u043f\u043e\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\n      * @return cmsModel\n      */\n-    public function applyGridFilter(cmsModel $model, $filter) {\n+    public function applyGridFilter(cmsModel $model, $filter, $table_name) {\n \n         // \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443\n         if (!empty($filter['order_by']) && !empty($filter['order_to'])) {\n@@ -539,9 +540,14 @@ public function applyGridFilter(cmsModel $model, $filter) {\n         // \u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0444\u0438\u043b\u044c\u0442\u0440\n         if (!empty($filter['advanced_filter']) && is_string($filter['advanced_filter'])) {\n \n+            $dataset_filters = [];\n+\n             parse_str($filter['advanced_filter'], $dataset_filters);\n \n-            $model->applyDatasetFilters($dataset_filters);\n+            if (!$model->applyDatasetFilters($dataset_filters, true, [], $table_name)) {\n+\n+                $this->grid['filter']['advanced_filter'] = '';\n+            }\n         }\n \n         return $model;"
        },
        {
          "filename": "system/core/model.php",
          "status": "modified",
          "additions": 44,
          "deletions": 14,
          "patch": "@@ -1196,37 +1196,59 @@ public function filterOnlineUsers() {\n         return $this->filterNotNull('online.user_id')->filterTimestampYounger('online.date_created', cmsUser::USER_ONLINE_INTERVAL, 'SECOND');\n     }\n \n-    public function applyDatasetFilters($dataset, $ignore_sorting = false, $allowed_fields = []) {\n+    /**\n+     * \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442 \u043d\u0430\u0431\u043e\u0440 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432 \u0438\u0437 \u043c\u0430\u0441\u0441\u0438\u0432\u0430\n+     *\n+     * @param array $dataset \u041c\u0430\u0441\u0441\u0438\u0432 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432/\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0438\n+     * @param boolean $only_filters \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0444\u0438\u043b\u044c\u0442\u0440\u044b\n+     * @param array $allowed_fields \u0420\u0430\u0437\u0440\u0435\u0448\u0451\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u0434\u043b\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438\n+     * @param string $table_name \u0418\u043c\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u044b: \u0435\u0441\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e, \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u044e\u0442\u0441\u044f \u043d\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u044c \u0432 \u043d\u0435\u0439\n+     * @return boolean true, \u0435\u0441\u043b\u0438 \u0447\u0442\u043e-\u043b\u0438\u0431\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043b\u043e\u0441\u044c, false, \u0435\u0441\u043b\u0438 \u043d\u0438\u0447\u0435\u0433\u043e\n+     */\n+    public function applyDatasetFilters($dataset, $only_filters = false, $allowed_fields = [], $table_name = '') {\n \n-        if (!empty($dataset['filters'])) {\n+        $success = false;\n+\n+        if (!empty($dataset['filters']) && is_array($dataset['filters'])) {\n \n             foreach ($dataset['filters'] as $filter) {\n \n+                // \u041d\u0435\u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f\n+                if (\n+                    empty($filter['field']) || !is_string($filter['field']) ||\n+                    empty($filter['condition'] || !is_string($filter['condition'])) ||\n+                    !array_key_exists('value', $filter) || (!is_string($filter['value']) && $filter['condition'] !== 'in')\n+                    ) {\n+                    continue;\n+                }\n+\n+                // \u0415\u0441\u0442\u044c \u043b\u0438 \u0442\u0430\u043a\u043e\u0435 \u043f\u043e\u043b\u0435 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435\n+                if ($table_name && !$this->db->isFieldExists($table_name, $filter['field'])) {\n+                    continue;\n+                }\n+\n                 // \u0415\u0441\u043b\u0438 \u0437\u0430\u0434\u0430\u043d\u044b \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044f, \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c\n                 // \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f\n                 if ($allowed_fields && !in_array($filter['field'], $allowed_fields, true)) {\n                     continue;\n                 }\n \n-                if (isset($filter['callback']) && is_callable($filter['callback'])) {\n+                // \u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u0435\u0440\u0435\u0434\u0430\u0451\u0442\u0441\u044f, \u043a\u043e\u0433\u0434\u0430 field \u0432 $dataset \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u043b\u044e\u0431\u044b\u0435\n+                if (!$table_name && isset($filter['callback']) && is_callable($filter['callback'])) {\n                     $filter['callback']($this, $dataset);\n                     continue;\n                 }\n \n-                if (!isset($filter['value'])) {\n-                    continue;\n-                }\n                 if (($filter['value'] === '') && !in_array($filter['condition'], ['nn', 'ni'])) {\n                     continue;\n                 }\n-                if (empty($filter['condition'])) {\n-                    continue;\n-                }\n \n                 if ($filter['value'] !== '' && !is_array($filter['value'])) {\n                     $filter['value'] = string_replace_user_properties($filter['value']);\n                 }\n \n+                $success = true;\n+\n                 switch ($filter['condition']) {\n \n                     // \u043e\u0431\u0449\u0438\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f\n@@ -1272,15 +1294,21 @@ public function applyDatasetFilters($dataset, $ignore_sorting = false, $allowed_\n             }\n         }\n \n-        if (!empty($dataset['sorting']) && !$ignore_sorting) {\n+        if (!empty($dataset['sorting']) && !$only_filters) {\n+\n+            $success = true;\n+\n             $this->orderByList($dataset['sorting']);\n         }\n \n-        if (!empty($dataset['index'])) {\n+        if (!empty($dataset['index']) && !$only_filters) {\n+\n+            $success = true;\n+\n             $this->forceIndex($dataset['index'], 2);\n         }\n \n-        return true;\n+        return $success;\n     }\n \n     /**\n@@ -2251,14 +2279,16 @@ public function reorderByList($table_name, $list, $additional_fields = [], $fiel\n     /**\n      * \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442 \u043a \u043c\u043e\u0434\u0435\u043b\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u044b, \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430\n      * \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0441\u043e \u0441\u043f\u0438\u0441\u043a\u043e\u043c \u0437\u0430\u043f\u0438\u0441\u0435\u0439\n+     * \u041c\u0435\u0442\u043e\u0434 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u0438, \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0435\u0433\u043e\n      *\n      * @param cmsGrid $grid \u041e\u0431\u044a\u0435\u043a\u0442 \u0433\u0440\u0438\u0434\u0430\n      * @param array $filter\n+     * @param string $table_name\n      * @return $this\n      */\n-    public function applyGridFilter(cmsGrid $grid, $filter) {\n+    public function applyGridFilter(cmsGrid $grid, $filter, $table_name = '') {\n \n-        $grid->applyGridFilter($this, $filter);\n+        $grid->applyGridFilter($this, $filter, $table_name);\n \n         return $this;\n     }"
        },
        {
          "filename": "system/traits/controllers/actions/listgrid.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -337,7 +337,7 @@ public function getListItems($ignore_field = false){\n                     $filter = call_user_func_array($this->filter_callback, [$filter]);\n                 }\n \n-                $this->grid->applyGridFilter($this->model, $filter);\n+                $this->grid->applyGridFilter($this->model, $filter, $this->table_name);\n             }\n         }\n "
        },
        {
          "filename": "update/current/manifest.en.ini",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@ type = \"system\"\n major = \"2\"\n minor = \"16\"\n build = \"1\"\n-date  = \"20230613\"\n+date  = \"20230912\"\n \n [depends]\n core = \"2.16.0\""
        },
        {
          "filename": "update/current/manifest.ru.ini",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@ type = \"system\"\n major = \"2\"\n minor = \"16\"\n build = \"1\"\n-date  = \"20230613\"\n+date  = \"20230912\"\n \n [depends]\n core = \"2.16.0\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 3,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3d29dc5254c4359b4e2472b72b56300fd1d786a6",
            "date": "2025-01-11T13:13:10Z",
            "author_login": "fuzegit"
          },
          {
            "sha": "6bbd3018ab5299661143770da0c8389c2f04072e",
            "date": "2025-01-08T21:35:13Z",
            "author_login": "fuzegit"
          },
          {
            "sha": "a2cbfb0325fa0697a084da5360a0d3b09caa9944",
            "date": "2025-01-08T21:34:30Z",
            "author_login": "fuzegit"
          },
          {
            "sha": "9cb2c6e20d57878c6216b57317c94b713322b51b",
            "date": "2025-01-06T20:33:51Z",
            "author_login": "madromas"
          },
          {
            "sha": "b2dc0530ad5138bfc640c639fd6521937631c398",
            "date": "2025-01-06T15:17:23Z",
            "author_login": "madromas"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": " SQL Injection in GitHub repository instantsoft/icms2 prior to 2.16.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-09-13T01:15:07.893",
    "last_modified": "2024-11-21T08:36:17.110",
    "fix_date": "2023-09-12T15:12:27Z"
  },
  "references": [
    {
      "url": "https://github.com/instantsoft/icms2/commit/3a6b148fa2c943ee7647e0cd14bf68e026b15548",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/cb72cc17-5a0d-4392-9a5f-a13aa773de9e",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/instantsoft/icms2/commit/3a6b148fa2c943ee7647e0cd14bf68e026b15548",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/cb72cc17-5a0d-4392-9a5f-a13aa773de9e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:08.404568",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "icms2",
    "owner": "instantsoft",
    "created_at": "2015-07-13T05:37:31Z",
    "updated_at": "2025-01-15T11:21:45Z",
    "pushed_at": "2025-01-11T17:01:14Z",
    "size": 34631,
    "stars": 296,
    "forks": 121,
    "open_issues": 152,
    "watchers": 296,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 7286180,
      "JavaScript": 888369,
      "SCSS": 349558,
      "CSS": 327977,
      "HTML": 1587
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:00:18.422176"
  }
}