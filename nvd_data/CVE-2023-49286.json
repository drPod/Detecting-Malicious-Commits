{
  "cve_id": "CVE-2023-49286",
  "github_data": {
    "repository": "squid-cache/squid",
    "fix_commit": "6014c6648a2a54a4ecb7f952ea1163e0798f9264",
    "related_commits": [
      "6014c6648a2a54a4ecb7f952ea1163e0798f9264",
      "6014c6648a2a54a4ecb7f952ea1163e0798f9264"
    ],
    "patch_url": "https://github.com/squid-cache/squid/commit/6014c6648a2a54a4ecb7f952ea1163e0798f9264.patch",
    "fix_commit_details": {
      "sha": "6014c6648a2a54a4ecb7f952ea1163e0798f9264",
      "commit_date": "2023-10-27T21:27:20Z",
      "author": {
        "login": "rousskov",
        "type": "User",
        "stats": {
          "total_commits": 1582,
          "average_weekly_commits": 1.7956867196367763,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 434
        }
      },
      "commit_message": {
        "title": "Exit without asserting when helper process startup fails (#1543)",
        "length": 571,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 32,
        "additions": 26,
        "deletions": 6
      },
      "files": [
        {
          "filename": "src/ipc.cc",
          "status": "modified",
          "additions": 26,
          "deletions": 6,
          "patch": "@@ -22,6 +22,11 @@\n \n #include <chrono>\n #include <thread>\n+#include <cstdlib>\n+\n+#if HAVE_UNISTD_H\n+#include <unistd.h>\n+#endif\n \n static const char *hello_string = \"hi there\\n\";\n #ifndef HELLO_BUF_SZ\n@@ -362,24 +367,39 @@ ipcCreate(int type, const char *prog, const char *const args[], const char *name\n     }\n \n     PutEnvironment();\n+\n+    // A dup(2) wrapper that reports and exits the process on errors. The\n+    // exiting logic is only suitable for this child process context.\n+    const auto dupOrExit = [prog,name](const int oldFd) {\n+        const auto newFd = dup(oldFd);\n+        if (newFd < 0) {\n+            const auto savedErrno = errno;\n+            debugs(54, DBG_CRITICAL, \"ERROR: Helper process initialization failure: \" << name <<\n+                   Debug::Extra << \"helper (CHILD) PID: \" << getpid() <<\n+                   Debug::Extra << \"helper program name: \" << prog <<\n+                   Debug::Extra << \"dup(2) system call error for FD \" << oldFd << \": \" << xstrerr(savedErrno));\n+            _exit(EXIT_FAILURE);\n+        }\n+        return newFd;\n+    };\n+\n     /*\n      * This double-dup stuff avoids problems when one of\n      *  crfd, cwfd, or debug_log are in the rage 0-2.\n      */\n \n     do {\n         /* First make sure 0-2 is occupied by something. Gets cleaned up later */\n-        x = dup(crfd);\n-        assert(x > -1);\n-    } while (x < 3 && x > -1);\n+        x = dupOrExit(crfd);\n+    } while (x < 3);\n \n     close(x);\n \n-    t1 = dup(crfd);\n+    t1 = dupOrExit(crfd);\n \n-    t2 = dup(cwfd);\n+    t2 = dupOrExit(cwfd);\n \n-    t3 = dup(fileno(debug_log));\n+    t3 = dupOrExit(fileno(debug_log));\n \n     assert(t1 > 2 && t2 > 2 && t3 > 2);\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a14169990e66a0622165ea3f16712b58621e48f3",
            "date": "2025-01-13T19:53:36Z",
            "author_login": "eduard-bagdasaryan"
          },
          {
            "sha": "5fa48bb562bb1d6c9d7e19f94063dce373d9595c",
            "date": "2025-01-09T14:58:13Z",
            "author_login": "kinkie"
          },
          {
            "sha": "fb51e4612855774e0d97f374c0f0c485eb40ef38",
            "date": "2025-01-07T23:20:48Z",
            "author_login": "kinkie"
          },
          {
            "sha": "b56774dd09224b6aa8513e24cdb7634be297a88e",
            "date": "2024-12-31T23:18:39Z",
            "author_login": "kinkie"
          },
          {
            "sha": "32218e04a5b647ebccaf36703b0087e438e62c3c",
            "date": "2024-12-31T21:59:05Z",
            "author_login": "rousskov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
    "cwe_id": "CWE-253",
    "description": "Squid is a caching proxy for the Web supporting HTTP, HTTPS, FTP, and more. Due to an Incorrect Check of Function Return Value bug Squid is vulnerable to a Denial of Service attack against its Helper process management. This bug is fixed by Squid version 6.5. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-12-04T23:15:27.243",
    "last_modified": "2024-11-21T08:33:11.347",
    "fix_date": "2023-10-27T21:27:20Z"
  },
  "references": [
    {
      "url": "http://www.squid-cache.org/Versions/v6/SQUID-2023_8.patch",
      "source": "security-advisories@github.com",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/commit/6014c6648a2a54a4ecb7f952ea1163e0798f9264",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/security/advisories/GHSA-xggx-9329-3c27",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/01/msg00003.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A5QASTMCUSUEW3UOMKHZJB3FTONWSRXS/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MEV66D3PAAY6K7TWDT3WZBLCPLASFJDC/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240119-0004/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "http://www.squid-cache.org/Versions/v6/SQUID-2023_8.patch",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/commit/6014c6648a2a54a4ecb7f952ea1163e0798f9264",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/squid-cache/squid/security/advisories/GHSA-xggx-9329-3c27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/01/msg00003.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A5QASTMCUSUEW3UOMKHZJB3FTONWSRXS/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MEV66D3PAAY6K7TWDT3WZBLCPLASFJDC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240119-0004/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:41.529382",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "squid",
    "owner": "squid-cache",
    "created_at": "2014-09-27T00:59:40Z",
    "updated_at": "2025-01-14T10:13:37Z",
    "pushed_at": "2025-01-13T21:33:47Z",
    "size": 177668,
    "stars": 2292,
    "forks": 530,
    "open_issues": 125,
    "watchers": 2292,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "SQUID_NT_3_0",
      "cbdatahistory",
      "master",
      "mswin",
      "v3.0",
      "v3.1",
      "v3.2",
      "v3.3",
      "v3.4",
      "v3.5",
      "v4",
      "v5",
      "v6"
    ],
    "languages": {
      "C++": 7975562,
      "C": 710305,
      "M4": 224515,
      "Makefile": 142513,
      "Perl": 119339,
      "Shell": 98209,
      "Roff": 70681,
      "Awk": 7112,
      "HTML": 2381,
      "CSS": 1791,
      "sed": 311
    },
    "commit_activity": {
      "total_commits_last_year": 231,
      "avg_commits_per_week": 4.4423076923076925,
      "days_active_last_year": 154
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:03:21.725351"
  }
}