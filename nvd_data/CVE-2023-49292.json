{
  "cve_id": "CVE-2023-49292",
  "github_data": {
    "repository": "ecies/go",
    "fix_commit": "c6e775163866d6ea5233eb8ec8530a9122101ebd",
    "related_commits": [
      "c6e775163866d6ea5233eb8ec8530a9122101ebd",
      "c6e775163866d6ea5233eb8ec8530a9122101ebd"
    ],
    "patch_url": "https://github.com/ecies/go/commit/c6e775163866d6ea5233eb8ec8530a9122101ebd.patch",
    "fix_commit_details": {
      "sha": "c6e775163866d6ea5233eb8ec8530a9122101ebd",
      "commit_date": "2023-12-04T20:29:05Z",
      "author": {
        "login": "savely-krasovsky",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: additional security checks added",
        "length": 37,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
      },
      "files": [
        {
          "filename": "privatekey.go",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -77,6 +77,10 @@ func (k *PrivateKey) Encapsulate(pub *PublicKey) ([]byte, error) {\n \t\treturn nil, fmt.Errorf(\"public key is empty\")\n \t}\n \n+\tif !k.Curve.IsOnCurve(pub.X, pub.Y) {\n+\t\treturn nil, fmt.Errorf(\"invalid public key\")\n+\t}\n+\n \tvar secret bytes.Buffer\n \tsecret.Write(k.PublicKey.Bytes(false))\n \n@@ -98,6 +102,10 @@ func (k *PrivateKey) ECDH(pub *PublicKey) ([]byte, error) {\n \t\treturn nil, fmt.Errorf(\"public key is empty\")\n \t}\n \n+\tif !k.Curve.IsOnCurve(pub.X, pub.Y) {\n+\t\treturn nil, fmt.Errorf(\"invalid public key\")\n+\t}\n+\n \t// Shared secret generation\n \tsx, sy := pub.Curve.ScalarMult(pub.X, pub.Y, k.D.Bytes())\n "
        },
        {
          "filename": "publickey.go",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -137,8 +137,12 @@ func (k *PublicKey) Hex(compressed bool) string {\n // Decapsulate decapsulates key by using Key Encapsulation Mechanism and returns symmetric key;\n // can be safely used as encryption key\n func (k *PublicKey) Decapsulate(priv *PrivateKey) ([]byte, error) {\n+\tif !k.Curve.IsOnCurve(k.X, k.Y) {\n+\t\treturn nil, fmt.Errorf(\"invalid public key\")\n+\t}\n+\n \tif priv == nil {\n-\t\treturn nil, fmt.Errorf(\"public key is empty\")\n+\t\treturn nil, fmt.Errorf(\"private key is empty\")\n \t}\n \n \tvar secret bytes.Buffer"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a2072b41c2aae788a740b4bc884fe399480494c5",
            "date": "2024-12-12T02:29:30Z",
            "author_login": "savely-krasovsky"
          },
          {
            "sha": "962d5737a5438508711785c087ca59491d9cd7a0",
            "date": "2024-12-12T02:08:50Z",
            "author_login": "savely-krasovsky"
          },
          {
            "sha": "db24b7e4c7f7789b9f2c0370a77f410dc2813c9d",
            "date": "2024-12-12T02:07:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "243fbcf416b092d8f3706cd88941a7e5e6ebb4b5",
            "date": "2024-12-12T01:54:15Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c5a7a555b82005b9e4ded4253f4f059363acd035",
            "date": "2024-04-17T21:14:10Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-200",
    "description": "ecies is an Elliptic Curve Integrated Encryption Scheme for secp256k1 in Golang. If funcations Encapsulate(), Decapsulate() and ECDH() could be called by an attacker, they could recover any private key that interacts with it. This vulnerability was patched in 2.0.8. Users are advised to upgrade.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2023-12-05T00:15:09.627",
    "last_modified": "2024-11-21T08:33:12.163",
    "fix_date": "2023-12-04T20:29:05Z"
  },
  "references": [
    {
      "url": "https://github.com/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/README.md",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/ecies/go/commit/c6e775163866d6ea5233eb8ec8530a9122101ebd",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ecies/go/releases/tag/v2.0.8",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/ecies/go/security/advisories/GHSA-8j98-cjfr-qx3h",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ashutosh1206/Crypton/blob/master/Diffie-Hellman-Key-Exchange/Attack-Invalid-Curve-Point/README.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://github.com/ecies/go/commit/c6e775163866d6ea5233eb8ec8530a9122101ebd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ecies/go/releases/tag/v2.0.8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/ecies/go/security/advisories/GHSA-8j98-cjfr-qx3h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:41.530527",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "go",
    "owner": "ecies",
    "created_at": "2019-08-06T18:50:12Z",
    "updated_at": "2024-12-19T16:29:02Z",
    "pushed_at": "2025-01-06T19:45:03Z",
    "size": 699,
    "stars": 108,
    "forks": 23,
    "open_issues": 3,
    "watchers": 108,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Go": 17287
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:18:09.490094"
  }
}