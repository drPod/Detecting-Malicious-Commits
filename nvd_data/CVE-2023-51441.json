{
  "cve_id": "CVE-2023-51441",
  "github_data": {
    "repository": "apache/axis-axis1-java",
    "fix_commit": "685c309febc64aa393b2d64a05f90e7eb9f73e06",
    "related_commits": [
      "685c309febc64aa393b2d64a05f90e7eb9f73e06",
      "685c309febc64aa393b2d64a05f90e7eb9f73e06"
    ],
    "patch_url": "https://github.com/apache/axis-axis1-java/commit/685c309febc64aa393b2d64a05f90e7eb9f73e06.patch",
    "fix_commit_details": {
      "sha": "685c309febc64aa393b2d64a05f90e7eb9f73e06",
      "commit_date": "2023-12-18T02:00:56Z",
      "author": {
        "login": "alphatheory-rlazarski",
        "type": "User",
        "stats": {
          "total_commits": 1,
          "average_weekly_commits": 0.0007980845969672786,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 1
        }
      },
      "commit_message": {
        "title": "Filter out more unsupported protocols in the client class ServiceFactory",
        "length": 72,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 7,
        "deletions": 1
      },
      "files": [
        {
          "filename": "axis-rt-core/src/main/java/org/apache/axis/client/ServiceFactory.java",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -17,9 +17,11 @@\n package org.apache.axis.client;\n \n import org.apache.axis.EngineConfiguration;\n+import org.apache.axis.components.logger.LogFactory;\n import org.apache.axis.configuration.EngineConfigurationFactoryFinder;\n import org.apache.axis.utils.ClassUtils;\n import org.apache.axis.utils.Messages;\n+import org.apache.commons.logging.Log;\n \n import javax.naming.Context;\n import javax.naming.InitialContext;\n@@ -47,6 +49,9 @@\n public class ServiceFactory extends javax.xml.rpc.ServiceFactory\n         implements ObjectFactory\n {\n+    protected static Log log =\n+        LogFactory.getLog(ServiceFactory.class.getName());\n+\n     // Constants for RefAddrs in the Reference.\n     public static final String SERVICE_CLASSNAME  = \"service classname\";\n     public static final String WSDL_LOCATION      = \"WSDL location\";\n@@ -107,7 +112,8 @@ public static Service getService(Map environment)\n         if (context != null) {\n             String name = (String)environment.get(\"jndiName\");\n \n-\t    if(name!=null && (name.toUpperCase().indexOf(\"LDAP\")!=-1 || name.toUpperCase().indexOf(\"RMI\")!=-1 || name.toUpperCase().indexOf(\"JMS\")!=-1 || name.toUpperCase().indexOf(\"JMX\")!=-1) || name.toUpperCase().indexOf(\"JRMP\")!=-1 || name.toUpperCase().indexOf(\"JAVA\")!=-1 || name.toUpperCase().indexOf(\"DNS\")!=-1)  {\n+\t    if(name!=null && (name.toUpperCase().indexOf(\"LDAP\")!=-1 || name.toUpperCase().indexOf(\"RMI\")!=-1 || name.toUpperCase().indexOf(\"JMS\")!=-1 || name.toUpperCase().indexOf(\"JMX\")!=-1) || name.toUpperCase().indexOf(\"JRMP\")!=-1 || name.toUpperCase().indexOf(\"JAVA\")!=-1 || name.toUpperCase().indexOf(\"DNS\")!=-1 || name.toUpperCase().indexOf(\"IIOP\")!=-1 || name.toUpperCase().indexOf(\"CORBANAME\")!=-1) {\n+                log.warn(\"returning null, jndiName received by ServiceFactory.getService() is not supported by this method: \" + name);\n \t        return null;\n             }\n             if (name == null) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "685c309febc64aa393b2d64a05f90e7eb9f73e06",
            "date": "2023-12-18T02:00:56Z",
            "author_login": "alphatheory-rlazarski"
          },
          {
            "sha": "e84c60c1f0764b01577d62c9e6453457d523ee77",
            "date": "2023-09-20T19:31:34Z",
            "author_login": "robertlazarski"
          },
          {
            "sha": "22c25b730f8fc10780117167fd11d1153126b04d",
            "date": "2023-08-13T20:46:19Z",
            "author_login": "veithen"
          },
          {
            "sha": "dbee40de9651ee4f0db8e67c151d626e40984bc5",
            "date": "2023-08-13T20:26:46Z",
            "author_login": "veithen"
          },
          {
            "sha": "994b7b17fdbf00d5c9845671be0f1978b61f5d7b",
            "date": "2023-08-13T20:11:45Z",
            "author_login": "veithen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-918",
    "description": "** UNSUPPORTED WHEN ASSIGNED ** Improper Input Validation vulnerability in Apache Axis allowed users with access to the admin service to perform possible SSRF\nThis issue affects Apache Axis: through 1.3.\n\nAs Axis 1 has been EOL we recommend you migrate to a different SOAP engine, such as Apache Axis 2/Java. Alternatively you could use a build of Axis with the patch from  https://github.com/apache/axis-axis1-java/commit/685c309febc64aa393b2d64a05f90e7eb9f73e06  applied. The Apache Axis project does not expect to create an Axis 1.x release \nfixing this problem, though contributors that would like to work towards\n this are welcome.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-06T12:15:42.997",
    "last_modified": "2024-11-21T08:38:07.500",
    "fix_date": "2023-12-18T02:00:56Z"
  },
  "references": [
    {
      "url": "https://github.com/apache/axis-axis1-java/commit/685c309febc64aa393b2d64a05f90e7eb9f73e06",
      "source": "security@apache.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/8nrm5thop8f82pglx4o0jg8wmvy6d9yd",
      "source": "security@apache.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/apache/axis-axis1-java/commit/685c309febc64aa393b2d64a05f90e7eb9f73e06",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/8nrm5thop8f82pglx4o0jg8wmvy6d9yd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.139359",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "axis-axis1-java",
    "owner": "apache",
    "created_at": "2020-03-20T01:57:50Z",
    "updated_at": "2024-11-01T11:51:25Z",
    "pushed_at": "2023-12-18T02:04:57Z",
    "size": 38696,
    "stars": 12,
    "forks": 25,
    "open_issues": 2,
    "watchers": 12,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 7870594,
      "HTML": 160595,
      "XSLT": 49718,
      "Shell": 4402,
      "C#": 2362,
      "Batchfile": 2071
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T20:54:31.810973"
  }
}