{
  "cve_id": "CVE-2023-51443",
  "github_data": {
    "repository": "signalwire/freeswitch",
    "fix_commit": "86cbda90b84ba186e508fbc7bfae469270a97d11",
    "related_commits": [
      "86cbda90b84ba186e508fbc7bfae469270a97d11",
      "86cbda90b84ba186e508fbc7bfae469270a97d11"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "86cbda90b84ba186e508fbc7bfae469270a97d11",
      "commit_date": "2023-12-22T14:57:34Z",
      "author": {
        "login": "andywolk",
        "type": "User",
        "stats": {
          "total_commits": 1441,
          "average_weekly_commits": 1.4352589641434264,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 293
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-39gv-hq72-j6m6",
        "length": 140,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 14,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/switch_rtp.c",
          "status": "modified",
          "additions": 14,
          "deletions": 1,
          "patch": "@@ -3374,7 +3374,20 @@ static int do_dtls(switch_rtp_t *rtp_session, switch_dtls_t *dtls)\n \t\treturn 0;\n \t}\n \n-\tif (is_ice && !rtp_session->ice.cand_responsive) {\n+\tif (is_ice && !(rtp_session->ice.type & ICE_LITE) && !rtp_session->ice.cand_responsive) {\n+\t\tswitch_log_printf(SWITCH_CHANNEL_SESSION_LOG(rtp_session->session), SWITCH_LOG_DEBUG6, \"Got DTLS packet but candidate is not responsive\\n\");\n+\n+\t\treturn 0;\n+\t}\n+\n+\tif (is_ice && !switch_cmp_addr(rtp_session->from_addr, rtp_session->ice.addr, SWITCH_TRUE)) {\n+\t\tchar tmp_buf1[80] = \"\";\n+\t\tchar tmp_buf2[80] = \"\";\n+\t\tconst char *host_from = switch_get_addr(tmp_buf1, sizeof(tmp_buf1), rtp_session->from_addr);\n+\t\tconst char *host_ice_cur_addr = switch_get_addr(tmp_buf2, sizeof(tmp_buf2), rtp_session->ice.addr);\n+\n+\t\tswitch_log_printf(SWITCH_CHANNEL_SESSION_LOG(rtp_session->session), SWITCH_LOG_DEBUG5, \"Got DTLS packet from [%s] whilst current ICE negotiated address is [%s]. Ignored.\\n\", host_from, host_ice_cur_addr);\n+\n \t\treturn 0;\n \t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3f1e4bf90a14dc1fd46814d4bba87b89a2a69d30",
            "date": "2025-01-25T13:17:25Z",
            "author_login": "andywolk"
          },
          {
            "sha": "433bb901d9c0201ca4ba72fc7dc5ec4dbdf9e350",
            "date": "2025-01-24T18:34:22Z",
            "author_login": "s3rj1k"
          },
          {
            "sha": "22954336ed906c980b831926641deeb5a4ef05fc",
            "date": "2025-01-24T14:24:00Z",
            "author_login": "andywolk"
          },
          {
            "sha": "edc534f1b7a9beb8d4024065c7cab2585a51d099",
            "date": "2025-01-16T19:37:20Z",
            "author_login": "s3rj1k"
          },
          {
            "sha": "102e4c07ea8cd8ac502e3676a2cdbea50acfbeac",
            "date": "2025-01-23T15:57:44Z",
            "author_login": "andywolk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-703",
    "description": "FreeSWITCH is a Software Defined Telecom Stack enabling the digital transformation from proprietary telecom switches to a software implementation that runs on any commodity hardware. Prior to version 1.10.11, when handling DTLS-SRTP for media setup, FreeSWITCH is susceptible to Denial of Service due to a race condition in the hello handshake phase of the DTLS protocol. This attack can be done continuously, thus denying new DTLS-SRTP encrypted calls during the attack. If an attacker manages to send a ClientHello DTLS message with an invalid CipherSuite (such as `TLS_NULL_WITH_NULL_NULL`) to the port on the FreeSWITCH server that is expecting packets from the caller, a DTLS error is generated. This results in the media session being torn down, which is followed by teardown at signaling (SIP) level too. Abuse of this vulnerability may lead to a massive Denial of Service on vulnerable FreeSWITCH servers for calls that rely on DTLS-SRTP. To address this vulnerability, upgrade FreeSWITCH to 1.10.11 which includes the security fix. The solution implemented is to drop all packets from addresses that have not been validated by an ICE check.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-12-27T17:15:08.093",
    "last_modified": "2024-11-21T08:38:07.743",
    "fix_date": "2023-12-22T14:57:34Z"
  },
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/176393/FreeSWITCH-Denial-Of-Service.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/signalwire/freeswitch/commit/86cbda90b84ba186e508fbc7bfae469270a97d11",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/signalwire/freeswitch/security/advisories/GHSA-39gv-hq72-j6m6",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://packetstormsecurity.com/files/176393/FreeSWITCH-Denial-Of-Service.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://github.com/signalwire/freeswitch/commit/86cbda90b84ba186e508fbc7bfae469270a97d11",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/signalwire/freeswitch/security/advisories/GHSA-39gv-hq72-j6m6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.104720",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "freeswitch",
    "owner": "signalwire",
    "created_at": "2018-10-24T15:30:09Z",
    "updated_at": "2025-01-25T15:14:51Z",
    "pushed_at": "2025-01-25T23:24:31Z",
    "size": 135665,
    "stars": 3769,
    "forks": 1475,
    "open_issues": 1038,
    "watchers": 3769,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C": 31592605,
      "C++": 11029843,
      "C#": 2842627,
      "JavaScript": 2322162,
      "Assembly": 974047,
      "Makefile": 517363,
      "Shell": 453327,
      "Python": 421889,
      "Perl": 409021,
      "ActionScript": 398179,
      "M4": 375253,
      "HTML": 176934,
      "Inno Setup": 105557,
      "Java": 92708,
      "Emacs Lisp": 52150,
      "CMake": 45612,
      "Limbo": 33051,
      "Lua": 27789,
      "Processing": 26297,
      "Batchfile": 26118,
      "CSS": 25926,
      "SWIG": 22401,
      "PHP": 18949,
      "BitBake": 16981,
      "Raku": 14158,
      "Meson": 13733,
      "Erlang": 12244,
      "Dockerfile": 11241,
      "Awk": 10011,
      "Smarty": 9425,
      "F#": 6108,
      "Pascal": 5512,
      "Roff": 5090,
      "Ruby": 3377,
      "GDB": 2805,
      "XSLT": 1957,
      "QMake": 1774,
      "Tcl": 1085,
      "QuickBASIC": 188
    },
    "commit_activity": {
      "total_commits_last_year": 208,
      "avg_commits_per_week": 4.0,
      "days_active_last_year": 88
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:57:39.181304"
  }
}