{
  "cve_id": "CVE-2023-52082",
  "github_data": {
    "repository": "LycheeOrg/Lychee",
    "fix_commit": "33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4",
    "related_commits": [
      "33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4",
      "33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4"
    ],
    "patch_url": "https://github.com/LycheeOrg/Lychee/commit/33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4.patch",
    "fix_commit_details": {
      "sha": "33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4",
      "commit_date": "2023-12-28T15:15:36Z",
      "author": {
        "login": "ildyria",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix Injection + v5.0.2 (#2123)",
        "length": 30,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 34,
        "additions": 30,
        "deletions": 4
      },
      "files": [
        {
          "filename": "app/Providers/AppServiceProvider.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -223,7 +223,7 @@ private function logSQL(QueryExecuted $query): void\n \n \t\t$sql_with_bindings = Str::replaceArray('?', $bindings, $query->sql);\n \n-\t\t$explain = DB::select('EXPLAIN ' . $sql_with_bindings);\n+\t\t$explain = DB::select('EXPLAIN ' . $query->sql, $query->bindings);\n \t\t$renderer = new ArrayToTextTable();\n \t\t$renderer->setIgnoredKeys(['possible_keys', 'key_len', 'ref']);\n "
        },
        {
          "filename": "database/migrations/2023_12_28_144906_bump_version050002.php",
          "status": "added",
          "additions": 26,
          "deletions": 0,
          "patch": "@@ -0,0 +1,26 @@\n+<?php\n+\n+use Illuminate\\Database\\Migrations\\Migration;\n+use Illuminate\\Support\\Facades\\DB;\n+\n+return new class() extends Migration {\n+\t/**\n+\t * Run the migrations.\n+\t *\n+\t * @return void\n+\t */\n+\tpublic function up(): void\n+\t{\n+\t\tDB::table('configs')->where('key', 'version')->update(['value' => '050002']);\n+\t}\n+\n+\t/**\n+\t * Reverse the migrations.\n+\t *\n+\t * @return void\n+\t */\n+\tpublic function down(): void\n+\t{\n+\t\tDB::table('configs')->where('key', 'version')->update(['value' => '050001']);\n+\t}\n+};"
        },
        {
          "filename": "resources/views/livewire/forms/album/share-with.blade.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -96,10 +96,10 @@ class=\"bg-neutral-800 text-sm rounded-full w-56 px-2 pl-8 py-1 focus:outline-non\n                                 @foreach ($this->userList as $result)\n                                     <li class=\"border-b border-neutral-700 cursor-pointer transition-all ease-in-out duration-300\n \t\t\t\t\t\t\thover:bg-gradient-to-b hover:from-primary-500 hover:to-primary-600 hover:text-text-main-0\"\n-                                        wire:click=\"select('{{ $result['id'] }}','{{ $result['username'] }}')\">\n+                                        wire:click=\"select('{{ $result['id'] }}',@js($result['username']))\">\n                                         <a class=\"px-1 py-1 flex items-center\"\n                                             @if ($loop->last) @keydown.tab=\"isSearchUserOpen = false\" @endif>\n-                                            <span class=\"ml-4 text-left\">{{ $result['username'] }}</span>\n+                                            <span class=\"ml-4 text-left\">{{ ($result['username']) }}</span>\n                                         </a>\n                                     </li>\n                                 @endforeach"
        },
        {
          "filename": "version.md",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-5.0.1\n\\ No newline at end of file\n+5.0.2\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c8966723bc6fc1719f01f276f603b827007021db",
            "date": "2025-01-14T16:54:40Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "c043f965951bdd9277f89db743396a752a8e507d",
            "date": "2025-01-14T16:27:41Z",
            "author_login": "ildyria"
          },
          {
            "sha": "dd51fe5f6d966b61d7ccb17643c1395d0326eff4",
            "date": "2025-01-14T15:52:14Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "743a3ef515d36e8c17ee101d5e2d8de4488de3ed",
            "date": "2025-01-14T13:57:32Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "2f9a832310df23660e5c2976590f3d56ac3d70ec",
            "date": "2025-01-14T13:25:38Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "Lychee is a free photo-management tool.  Prior to 5.0.2, Lychee is vulnerable to an SQL injection on any binding when using mysql/mariadb. This injection is only active for users with the `.env` settings set to DB_LOG_SQL=true and DB_LOG_SQL_EXPLAIN=true. The defaults settings of Lychee are safe.  The patch is provided on version 5.0.2.  To work around this issue, disable SQL EXPLAIN logging.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-12-28T16:16:02.290",
    "last_modified": "2024-11-21T08:39:08.010",
    "fix_date": "2023-12-28T15:15:36Z"
  },
  "references": [
    {
      "url": "https://github.com/LycheeOrg/Lychee/commit/33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/LycheeOrg/Lychee/security/advisories/GHSA-rjwv-5j3m-p5x4",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/LycheeOrg/Lychee/commit/33354a2ce7cf700cc4ee537b7b8b94dfc1e84ad4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/LycheeOrg/Lychee/security/advisories/GHSA-rjwv-5j3m-p5x4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.110119",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Lychee",
    "owner": "LycheeOrg",
    "created_at": "2018-08-08T07:19:08Z",
    "updated_at": "2025-01-14T16:54:45Z",
    "pushed_at": "2025-01-14T16:54:42Z",
    "size": 158506,
    "stars": 3510,
    "forks": 316,
    "open_issues": 112,
    "watchers": 3510,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "alpha",
      "master"
    ],
    "languages": {
      "PHP": 4002768,
      "Vue": 407721,
      "TypeScript": 278768,
      "Blade": 94365,
      "HTML": 69138,
      "Makefile": 4788,
      "Shell": 4205
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:22:20.766952"
  }
}