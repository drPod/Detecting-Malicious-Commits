{
  "cve_id": "CVE-2023-5498",
  "github_data": {
    "repository": "chiefonboarding/chiefonboarding",
    "fix_commit": "7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7",
    "related_commits": [
      "7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7",
      "7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7"
    ],
    "patch_url": "https://github.com/chiefonboarding/chiefonboarding/commit/7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7.patch",
    "fix_commit_details": {
      "sha": "7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7",
      "commit_date": "2023-10-02T21:31:06Z",
      "author": {
        "login": "GDay",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix missing csrf token on admin task done view (#367)",
        "length": 53,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 36,
        "additions": 19,
        "deletions": 17
      },
      "files": [
        {
          "filename": "back/admin/admin_tasks/templates/admin_tasks_detail.html",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -2,13 +2,16 @@\n {% load i18n %}\n {% load crispy_forms_tags %}\n {% block actions %}\n-<a type=\"submit\" href=\"{% url 'admin_tasks:completed' object.id %}\" class=\"btn btn-primary\">\n-  {% if object.completed %}\n-    {% translate \"Reopen\" %}\n-  {% else %}\n-    {% translate \"Complete\" %}\n-  {% endif %}\n-</a>\n+<form method=\"post\" action=\"{% url 'admin_tasks:completed' object.id %}\">\n+  {% csrf_token %}\n+  <button type=\"submit\" class=\"btn btn-primary\">\n+    {% if object.completed %}\n+      {% translate \"Reopen\" %}\n+    {% else %}\n+      {% translate \"Complete\" %}\n+    {% endif %}\n+  </button>\n+</form>\n {% endblock %}\n \n {% block content %}"
        },
        {
          "filename": "back/admin/admin_tasks/tests.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -292,7 +292,7 @@ def test_complete_admin_task(client, admin_factory, admin_task_factory):\n     assert \"Complete\" in response.content.decode()\n     assert complete_url in response.content.decode()\n \n-    response = client.get(complete_url, follow=True)\n+    response = client.post(complete_url, follow=True)\n     task1.refresh_from_db()\n     task2.refresh_from_db()\n "
        },
        {
          "filename": "back/admin/admin_tasks/views.py",
          "status": "modified",
          "additions": 8,
          "deletions": 9,
          "patch": "@@ -1,9 +1,10 @@\n from django.contrib.messages.views import SuccessMessageMixin\n from django.http import Http404\n-from django.shortcuts import get_object_or_404\n+from django.shortcuts import get_object_or_404, redirect\n from django.urls import reverse, reverse_lazy\n from django.utils.translation import gettext as _\n-from django.views.generic.base import RedirectView\n+\n+from django.views.generic.detail import BaseDetailView\n from django.views.generic.edit import CreateView, UpdateView\n from django.views.generic.list import ListView\n \n@@ -45,16 +46,14 @@ def get_context_data(self, **kwargs):\n         return context\n \n \n-class AdminTaskToggleDoneView(LoginRequiredMixin, ManagerPermMixin, RedirectView):\n-    permanent = False\n-    pattern_name = \"admin_tasks:detail\"\n+class AdminTaskToggleDoneView(LoginRequiredMixin, ManagerPermMixin, BaseDetailView):\n+    model = AdminTask\n \n-    def get(self, request, *args, **kwargs):\n-        task_id = self.kwargs.get(\"pk\", -1)\n-        admin_task = get_object_or_404(AdminTask, id=task_id)\n+    def post(self, request, *args, **kwargs):\n+        admin_task = self.get_object()\n         admin_task.completed = not admin_task.completed\n         admin_task.save()\n-        return super().get(request, *args, **kwargs)\n+        return redirect(\"admin_tasks:detail\", pk=admin_task.id)\n \n \n class AdminTasksCreateView("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ba36f7f0c45dd48feb238df513d7968a9f107739",
            "date": "2024-12-08T01:01:47Z",
            "author_login": "GDay"
          },
          {
            "sha": "e79965948211b8e74fccc71bb20fcd8f7df10d4e",
            "date": "2024-11-18T23:29:39Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a8e47defdbdb8c3a6353a5a407ea88fe874155f7",
            "date": "2024-11-03T00:55:49Z",
            "author_login": "GDay"
          },
          {
            "sha": "06278980a993869b3c92c012724e54a59311ce34",
            "date": "2024-11-03T00:52:50Z",
            "author_login": "GDay"
          },
          {
            "sha": "929bf7ecd471ce24c88e0800c1f91b3d82c10973",
            "date": "2024-09-09T19:26:54Z",
            "author_login": "GDay"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-352",
    "description": "Cross-Site Request Forgery (CSRF) in GitHub repository chiefonboarding/chiefonboarding prior to v2.0.47.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-10T10:15:10.177",
    "last_modified": "2024-11-21T08:41:53.987",
    "fix_date": "2023-10-02T21:31:06Z"
  },
  "references": [
    {
      "url": "https://github.com/chiefonboarding/chiefonboarding/commit/7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/ec367b1d-5ec4-4ab2-881a-caf82e4877d9",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/chiefonboarding/chiefonboarding/commit/7de93f5fcc21e8f16fa0a64d38461c1b48ff3ee7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/ec367b1d-5ec4-4ab2-881a-caf82e4877d9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.586547",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ChiefOnboarding",
    "owner": "chiefonboarding",
    "created_at": "2020-07-13T14:56:55Z",
    "updated_at": "2025-01-06T23:46:38Z",
    "pushed_at": "2024-12-08T01:01:50Z",
    "size": 12240,
    "stars": 708,
    "forks": 130,
    "open_issues": 51,
    "watchers": 708,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 1658595,
      "JavaScript": 637112,
      "CSS": 337766,
      "HTML": 325594,
      "Dockerfile": 454,
      "Procfile": 157
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T18:30:07.087675"
  }
}