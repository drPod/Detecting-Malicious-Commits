{
  "cve_id": "CVE-2023-5511",
  "github_data": {
    "repository": "snipe/snipe-it",
    "fix_commit": "6d55d782806c9660e9e65dc5250faacb5d0033ed",
    "related_commits": [
      "6d55d782806c9660e9e65dc5250faacb5d0033ed",
      "6d55d782806c9660e9e65dc5250faacb5d0033ed"
    ],
    "patch_url": "https://github.com/snipe/snipe-it/commit/6d55d782806c9660e9e65dc5250faacb5d0033ed.patch",
    "fix_commit_details": {
      "sha": "6d55d782806c9660e9e65dc5250faacb5d0033ed",
      "commit_date": "2023-10-09T15:13:41Z",
      "author": {
        "login": "snipe",
        "type": "User",
        "stats": {
          "total_commits": 11824,
          "average_weekly_commits": 25.648590021691973,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 415
        }
      },
      "commit_message": {
        "title": "Set resend acceptance to POST",
        "length": 69,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 36,
        "additions": 29,
        "deletions": 7
      },
      "files": [
        {
          "filename": "app/Http/Controllers/ReportsController.php",
          "status": "modified",
          "additions": 13,
          "deletions": 3,
          "patch": "@@ -1043,27 +1043,37 @@ public function getAssetAcceptanceReport($deleted = false)\n      * @throws \\Illuminate\\Auth\\Access\\AuthorizationException\n      * @version v1.0\n      */\n-    public function sentAssetAcceptanceReminder($acceptanceId = null)\n+    public function sentAssetAcceptanceReminder(Request $request)\n     {\n         $this->authorize('reports.view');\n \n-        if (!$acceptance = CheckoutAcceptance::pending()->find($acceptanceId)) {\n+        if (!$acceptance = CheckoutAcceptance::pending()->find($request->input('acceptance_id'))) {\n+            \\Log::debug('No pending acceptances');\n             // Redirect to the unaccepted assets report page with error\n             return redirect()->route('reports/unaccepted_assets')->with('error', trans('general.bad_data'));\n         }\n+\n         $assetItem = $acceptance->checkoutable;\n \n+        \\Log::debug(print_r($assetItem, true));\n+\n         if (is_null($acceptance->created_at)){\n+            \\Log::debug('No acceptance created_at');\n             return redirect()->route('reports/unaccepted_assets')->with('error', trans('general.bad_data'));\n         } else {\n             $logItem_res = $assetItem->checkouts()->where('created_at', '=', $acceptance->created_at)->get();\n+\n+            \\Log::debug('Acceptance created at: '.$acceptance->created_at);\n+            \\Log::debug(print_r($logItem_res, true));\n+\n             if ($logItem_res->isEmpty()){\n+                \\Log::debug('Acceptance date mismatch');\n                 return redirect()->route('reports/unaccepted_assets')->with('error', trans('general.bad_data'));\n             }\n             $logItem = $logItem_res[0];\n         }\n \n-        if(!$assetItem->assignedTo->locale){\n+        if (!$assetItem->assignedTo->locale){\n             Notification::locale(Setting::getSettings()->locale)->send(\n                 $assetItem->assignedTo,\n                 new CheckoutAssetNotification($assetItem, $assetItem->assignedTo, $logItem->user, $acceptance, $logItem->note)"
        },
        {
          "filename": "resources/views/reports/unaccepted_assets.blade.php",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -77,11 +77,23 @@ class=\"table table-striped snipe-table\"\n                     <td>{!! $item['assetItem']->present()->nameUrl() !!}</td>\n                     <td>{{ $item['assetItem']->asset_tag }}</td>\n                     <td @if($item['acceptance']->assignedTo === null || $item['acceptance']->assignedTo->trashed()) style=\"text-decoration: line-through\" @endif>{!! ($item['acceptance']->assignedTo) ? $item['acceptance']->assignedTo->present()->nameUrl() : trans('admin/reports/general.deleted_user') !!}</td>\n-                    <td>\n+                    <td class=\"white-space: nowrap;\">\n+                        <nobr>\n                         @if(!$item['acceptance']->trashed())\n-                            @if ($item['acceptance']->assignedTo)<a href=\"{{ route('reports/unaccepted_assets_sent_reminder', ['acceptanceId' => $item['acceptance']->id]) }}\" class=\"btn btn-sm bg-purple\" data-tooltip=\"true\">{{ trans('admin/reports/general.send_reminder') }}</a>@endif\n+                           <form method=\"post\" class=\"white-space: nowrap;\" action=\"{{ route('reports/unaccepted_assets_sent_reminder') }}\">\n+                            @if ($item['acceptance']->assignedTo)\n+                                @csrf\n+                               <input type=\"hidden\" name=\"acceptance_id\" value=\"{{ $item['acceptance']->id }}\">\n+                                <button class=\"btn btn-sm btn-warning\" data-tooltip=\"true\" data-title=\"{{ trans('admin/reports/general.send_reminder') }}\">\n+                                    <i class=\"fa fa-repeat\" aria-hidden=\"true\"></i>\n+                                </button>\n+\n+                            @endif\n                             <a href=\"{{ route('reports/unaccepted_assets_delete', ['acceptanceId' => $item['acceptance']->id]) }}\" class=\"btn btn-sm btn-danger delete-asset\" data-tooltip=\"true\" data-toggle=\"modal\" data-content=\"{{ trans('general.delete_confirm', ['item' =>trans('admin/reports/general.acceptance_request')]) }}\" data-title=\"{{  trans('general.delete') }}\" onClick=\"return false;\"><i class=\"fa fa-trash\"></i></a>\n+                           </form>\n                         @endif\n+\n+                        </nobr>\n                     </td>\n                   </tr>\n                   @endif"
        },
        {
          "filename": "routes/web.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -368,8 +368,8 @@\n         'reports/unaccepted_assets/{deleted?}',\n         [ReportsController::class, 'getAssetAcceptanceReport']\n     )->name('reports/unaccepted_assets');\n-    Route::get(\n-        'reports/unaccepted_assets/{acceptanceId}/sent_reminder',\n+    Route::post(\n+        'reports/unaccepted_assets/sent_reminder',\n         [ReportsController::class, 'sentAssetAcceptanceReminder']\n     )->name('reports/unaccepted_assets_sent_reminder');\n     Route::delete("
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ca11efd3ee47a3313fc3a586f2ca2c843a7dc045",
            "date": "2025-01-13T22:23:30Z",
            "author_login": "snipe"
          },
          {
            "sha": "4a6a94a50ebc4bc86f7000aa5cb70987e20b7c80",
            "date": "2025-01-13T22:23:13Z",
            "author_login": "snipe"
          },
          {
            "sha": "2d65b381559d1817ecf201099e80201c7ad22378",
            "date": "2025-01-13T21:00:04Z",
            "author_login": "snipe"
          },
          {
            "sha": "587449ef970b3e2523da5a33a24f681cf699d382",
            "date": "2025-01-13T17:35:58Z",
            "author_login": "snipe"
          },
          {
            "sha": "06ffac9d7d0677ea74ff043a225588cc6a5a2aa8",
            "date": "2025-01-13T17:33:13Z",
            "author_login": "snipe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-352",
    "description": "Cross-Site Request Forgery (CSRF) in GitHub repository snipe/snipe-it prior to v.6.2.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-11T01:15:08.887",
    "last_modified": "2024-11-21T08:41:54.863",
    "fix_date": "2023-10-09T15:13:41Z"
  },
  "references": [
    {
      "url": "https://github.com/snipe/snipe-it/commit/6d55d782806c9660e9e65dc5250faacb5d0033ed",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/43206801-9862-48da-b379-e55e341d78bf",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/snipe/snipe-it/commit/6d55d782806c9660e9e65dc5250faacb5d0033ed",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/43206801-9862-48da-b379-e55e341d78bf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.591321",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "snipe-it",
    "owner": "snipe",
    "created_at": "2013-11-12T22:25:47Z",
    "updated_at": "2025-01-14T04:38:00Z",
    "pushed_at": "2025-01-14T12:34:04Z",
    "size": 224867,
    "stars": 11511,
    "forks": 3256,
    "open_issues": 1797,
    "watchers": 11511,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 18130643,
      "JavaScript": 4627209,
      "Blade": 1576739,
      "CSS": 250828,
      "Less": 196359,
      "Shell": 43713,
      "Dockerfile": 4408,
      "Python": 522,
      "Jinja": 229,
      "Procfile": 57
    },
    "commit_activity": {
      "total_commits_last_year": 3771,
      "avg_commits_per_week": 72.51923076923077,
      "days_active_last_year": 253
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:15:50.526515"
  }
}