{
  "cve_id": "CVE-2023-5556",
  "github_data": {
    "repository": "structurizr/onpremises",
    "fix_commit": "6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18",
    "related_commits": [
      "6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18",
      "6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18"
    ],
    "patch_url": "https://github.com/structurizr/onpremises/commit/6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18.patch",
    "fix_commit_details": {
      "sha": "6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18",
      "commit_date": "2023-10-06T07:04:32Z",
      "author": {
        "login": "simonbrowndotje",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "XSS prevention.",
        "length": 15,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 34,
        "additions": 17,
        "deletions": 17
      },
      "files": [
        {
          "filename": "structurizr-onpremises/src/main/webapp/WEB-INF/views/workspace-summary.jsp",
          "status": "modified",
          "additions": 17,
          "deletions": 17,
          "patch": "@@ -41,7 +41,7 @@\n \r\n             <c:if test=\"${not empty param.version}\">\r\n             <div class=\"navigationItem\">\r\n-                <span class=\"label label-version\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-xs icon-white\" /> ${workspace.internalVersion}</span>\r\n+                <span class=\"label label-version\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-xs icon-white\" /> <c:out value=\"${workspace.internalVersion}\" /></span>\r\n             </div>\r\n             </c:if>\r\n \r\n@@ -73,30 +73,30 @@\n             \r\n             <c:if test=\"${fn:startsWith(urlPrefix, '/workspace') && structurizrConfiguration.dslEditorEnabled}\">\r\n             <div class=\"navigationItem dslEditorNavigation\">\r\n-                <a href=\"${urlPrefix}/dsl${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-sm\" /> DSL editor</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/dsl<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-sm\" /> DSL editor</a>\r\n             </div>\r\n             </c:if>\r\n \r\n             <div id=\"diagramsLink\" class=\"navigationItem hidden\">\r\n-            <a href=\"${urlPrefix}/diagrams${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/bounding-box.svg\" class=\"icon-sm\" /> Diagrams</a>\r\n+            <a href=\"<c:out value=\"${urlPrefix}\" />/diagrams<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/bounding-box.svg\" class=\"icon-sm\" /> Diagrams</a>\r\n             </div>\r\n \r\n             <div id=\"documentationLink\"  class=\"navigationItem hidden\">\r\n-                <a href=\"${urlPrefix}/documentation${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/book.svg\" class=\"icon-sm\" /> Documentation</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/documentation<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/book.svg\" class=\"icon-sm\" /> Documentation</a>\r\n             </div>\r\n             <div id=\"decisionsLink\" class=\"navigationItem hidden\">\r\n-                <a href=\"${urlPrefix}/decisions${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/journal-text.svg\" class=\"icon-sm\" /> Decisions</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/decisions<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/journal-text.svg\" class=\"icon-sm\" /> Decisions</a>\r\n             </div>\r\n             <div id=\"exploreLink\" class=\"navigationItem hidden\">\r\n-                <a href=\"${urlPrefix}/explore${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/diagram-3.svg\" class=\"icon-sm\" /> Explore</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/explore<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/diagram-3.svg\" class=\"icon-sm\" /> Explore</a>\r\n             </div>\r\n \r\n             <div id=\"themeLink\" class=\"navigationItem hidden\">\r\n-                <a href=\"${urlPrefix}/theme${urlSuffix}\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/palette.svg\" class=\"icon-sm\" /> Theme</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/theme<c:out value=\"${urlSuffix}\" />\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/palette.svg\" class=\"icon-sm\" /> Theme</a>\r\n             </div>\r\n \r\n             <div id=\"imagesLink\" class=\"navigationItem hidden\">\r\n-                <a href=\"${urlPrefix}/images\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-png.svg\" class=\"icon-sm\" /> Published images</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/images\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-png.svg\" class=\"icon-sm\" /> Published images</a>\r\n             </div>\r\n \r\n             <div id=\"exportJsonLinkNavItem\" class=\"navigationItem\">\r\n@@ -117,7 +117,7 @@\n             <div class=\"navigationItemSeparator\"></div>\r\n             <c:if test=\"${fn:startsWith(urlPrefix, '/workspace')}\">\r\n             <div class=\"navigationItem\">\r\n-                <a href=\"${urlPrefix}/settings\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-sm\" /> Settings</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/settings\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-sm\" /> Settings</a>\r\n             </div>\r\n \r\n             <c:if test=\"${workspace.editable eq true and workspace.locked eq true}\">\r\n@@ -127,7 +127,7 @@\n             </c:if>\r\n \r\n             <div class=\"navigationItem\">\r\n-                <a href=\"${urlPrefix}/users\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/people.svg\" class=\"icon-sm\" /> Users</a>\r\n+                <a href=\"<c:out value=\"${urlPrefix}\" />/users\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/people.svg\" class=\"icon-sm\" /> Users</a>\r\n             </div>\r\n             </c:if>\r\n         </div>\r\n@@ -158,7 +158,7 @@\n \r\n                 <c:if test=\"${fn:startsWith(urlPrefix, '/workspace') && not empty versions}\">\r\n                 <div class=\"centered\" style=\"margin-top: 20px\">\r\n-                    <form class=\"form-inline\" style=\"display: inline-block\" method=\"get\" action=\"${urlPrefix}\">\r\n+                    <form class=\"form-inline\" style=\"display: inline-block\" method=\"get\" action=\"<c:out value=\"${urlPrefix}\" />\">\r\n                         <select id=\"workspaceVersion\" name=\"version\" class=\"form-control\">\r\n                             <c:forEach var=\"version\" items=\"${versions}\">\r\n                                 <option value=\"${version.versionId}\"><fmt:formatDate value=\"${version.lastModifiedDate}\" pattern=\"EEE dd MMM yyyy HH:mm:ss z\" timeZone=\"${user.timeZone}\" /></option>\r\n@@ -167,7 +167,7 @@\n                         <input type=\"submit\" class=\"btn btn-default\" value=\"Load version\" style=\"height: 35.5px\"/>\r\n                     </form>\r\n                     <c:if test=\"${not empty param.version && workspace.editable && not workspace.locked}\">\r\n-                        <button id=\"revertButton\" class=\"btn btn-default small\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-btn\" /> Revert to ${workspace.internalVersion}</button>\r\n+                        <button id=\"revertButton\" class=\"btn btn-default small\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-btn\" /> Revert to <c:out value=\"${workspace.internalVersion}\" /></button>\r\n                     </c:if>\r\n                 </div>\r\n                 </c:if>\r\n@@ -186,7 +186,7 @@\n                         <div class=\"col-sm-4 centered\">\r\n                             <div style=\"padding: 10px; margin: 10px\">\r\n                                 <div style=\"margin-top: 5px; font-size: 20px\">\r\n-                                    <a href=\"${urlPrefix}/dsl\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-lg\"/> DSL editor</a>\r\n+                                    <a href=\"<c:out value=\"${urlPrefix}\" />/dsl\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-lg\"/> DSL editor</a>\r\n                                 </div>\r\n                                 <div class=\"small\">\r\n                                     Open the online DSL editor, and create your workspace using the Structurizr DSL.\r\n@@ -206,7 +206,7 @@\n                         <div class=\"col-sm-4 centered\">\r\n                             <div style=\"padding: 10px; margin: 10px\">\r\n                                 <div style=\"margin-top: 5px; font-size: 20px\">\r\n-                                    <a href=\"${urlPrefix}/settings#api\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-lg\" /> Settings</a>\r\n+                                    <a href=\"<c:out value=\"${urlPrefix}\" />/settings#api\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-lg\" /> Settings</a>\r\n                                 </div>\r\n                                 <div class=\"small\">\r\n                                     Use the workspace settings page to find your API key/secret, for uploading your workspace with the Structurizr CLI or code-based libraries.\r\n@@ -236,7 +236,7 @@\n     $('#unlockWorkspaceLink').click(function(event) { unlockWorkspace(event); });\r\n \r\n     <c:if test=\"${not empty param.version}\">\r\n-    $('#workspaceVersion').val(\"${workspace.internalVersion}\");\r\n+    $('#workspaceVersion').val(\"<c:out value=\"${workspace.internalVersion}\" />\");\r\n     </c:if>\r\n \r\n     function addOnClickHandler(domId, handler) {\r\n@@ -300,7 +300,7 @@\n             var html = '';\r\n \r\n             views.forEach(function(view) {\r\n-                var url = '${urlPrefix}/diagrams${urlSuffix}#' + structurizr.util.escapeHtml(view.key);\r\n+                var url = '<c:out value=\"${urlPrefix}\" />/diagrams<c:out value=\"${urlSuffix}\" />#' + structurizr.util.escapeHtml(view.key);\r\n                 var title = structurizr.util.escapeHtml(structurizr.ui.getTitleForView(view));\r\n \r\n                 if (count <= maxNumberOfViews) {\r\n@@ -329,7 +329,7 @@\n             });\r\n \r\n             if (views.length > maxNumberOfViews) {\r\n-                html += '<div class=\"small\"><a href=\"${urlPrefix}/diagrams${urlSuffix}\">More diagrams...</a></div>';\r\n+                html += '<div class=\"small\"><a href=\"<c:out value=\"${urlPrefix}\" />/diagrams<c:out value=\"${urlSuffix}\" />\">More diagrams...</a></div>';\r\n             }\r\n \r\n             diagramsDiv.addClass('centered');\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c9d40e8854ba65dfb07414433cabd1dcc4d9072a",
            "date": "2025-01-08T13:54:56Z",
            "author_login": "simonbrowndotje"
          },
          {
            "sha": "cd0ebfec086a8ab3f937ec020f2e6e3fb780dcff",
            "date": "2025-01-08T13:52:58Z",
            "author_login": "simonbrowndotje"
          },
          {
            "sha": "ec871e60b797ea1fadb8e98c0e08fdf393f4f8a7",
            "date": "2025-01-08T13:52:26Z",
            "author_login": "simonbrowndotje"
          },
          {
            "sha": "c11ff7c3986529839ba4cf9c6fd9efa3b9045f1c",
            "date": "2024-12-15T10:46:13Z",
            "author_login": "simonbrowndotje"
          },
          {
            "sha": "41384ae07fc9b4a1462c6f87b39025105ecd0795",
            "date": "2024-12-15T10:34:52Z",
            "author_login": "simonbrowndotje"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Reflected in GitHub repository structurizr/onpremises prior to 3194.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-12T11:15:23.873",
    "last_modified": "2024-11-21T08:42:00.480",
    "fix_date": "2023-10-06T07:04:32Z"
  },
  "references": [
    {
      "url": "https://github.com/structurizr/onpremises/commit/6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a3ee0f98-6898-41ae-b1bd-242a03a73d1b",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/structurizr/onpremises/commit/6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/a3ee0f98-6898-41ae-b1bd-242a03a73d1b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.594042",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "onpremises",
    "owner": "structurizr",
    "created_at": "2022-09-04T09:31:24Z",
    "updated_at": "2025-01-09T13:59:59Z",
    "pushed_at": "2025-01-08T13:54:58Z",
    "size": 3744,
    "stars": 160,
    "forks": 62,
    "open_issues": 12,
    "watchers": 160,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Java": 905693,
      "Shell": 2356,
      "Dockerfile": 441
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:03:28.450310"
  }
}