{
  "cve_id": "CVE-2023-5564",
  "github_data": {
    "repository": "froxlor/froxlor",
    "fix_commit": "e8ed43056c1665522a586e3485da67f2bdf073aa",
    "related_commits": [
      "e8ed43056c1665522a586e3485da67f2bdf073aa",
      "e8ed43056c1665522a586e3485da67f2bdf073aa"
    ],
    "patch_url": "https://github.com/froxlor/froxlor/commit/e8ed43056c1665522a586e3485da67f2bdf073aa.patch",
    "fix_commit_details": {
      "sha": "e8ed43056c1665522a586e3485da67f2bdf073aa",
      "commit_date": "2023-10-02T13:40:50Z",
      "author": {
        "login": "d00p",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "enable markdown syntax in custom_notes field",
        "length": 96,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 550,
        "additions": 511,
        "deletions": 39
      },
      "files": [
        {
          "filename": "composer.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -53,10 +53,10 @@\n \t\t\"froxlor/idna-convert-legacy\": \"^2.1\",\n \t\t\"voku/anti-xss\": \"^4.1\",\n \t\t\"twig/twig\": \"^3.3\",\n-\t\t\"erusev/parsedown\": \"^1.7\",\n \t\t\"symfony/console\": \"^5.4\",\n \t\t\"pear/net_dns2\": \"^1.5\",\n-\t\t\"amnuts/opcache-gui\": \"^3.4\"\n+\t\t\"amnuts/opcache-gui\": \"^3.4\",\n+\t\t\"league/commonmark\": \"^2.4\"\n     },\n \t\"require-dev\": {\n \t\t\"phpunit/phpunit\": \"^9\","
        },
        {
          "filename": "composer.lock",
          "status": "modified",
          "additions": 433,
          "deletions": 22,
          "patch": "@@ -4,7 +4,7 @@\n         \"Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies\",\n         \"This file is @generated automatically\"\n     ],\n-    \"content-hash\": \"1f9acc318c920b38ee8141e74298655a\",\n+    \"content-hash\": \"cf7a156f58ab3f86204a4b4d263621e2\",\n     \"packages\": [\n         {\n             \"name\": \"amnuts/opcache-gui\",\n@@ -69,30 +69,38 @@\n             \"time\": \"2023-08-25T18:02:59+00:00\"\n         },\n         {\n-            \"name\": \"erusev/parsedown\",\n-            \"version\": \"1.7.4\",\n+            \"name\": \"dflydev/dot-access-data\",\n+            \"version\": \"v3.0.2\",\n             \"source\": {\n                 \"type\": \"git\",\n-                \"url\": \"https://github.com/erusev/parsedown.git\",\n-                \"reference\": \"cb17b6477dfff935958ba01325f2e8a2bfa6dab3\"\n+                \"url\": \"https://github.com/dflydev/dflydev-dot-access-data.git\",\n+                \"reference\": \"f41715465d65213d644d3141a6a93081be5d3549\"\n             },\n             \"dist\": {\n                 \"type\": \"zip\",\n-                \"url\": \"https://api.github.com/repos/erusev/parsedown/zipball/cb17b6477dfff935958ba01325f2e8a2bfa6dab3\",\n-                \"reference\": \"cb17b6477dfff935958ba01325f2e8a2bfa6dab3\",\n+                \"url\": \"https://api.github.com/repos/dflydev/dflydev-dot-access-data/zipball/f41715465d65213d644d3141a6a93081be5d3549\",\n+                \"reference\": \"f41715465d65213d644d3141a6a93081be5d3549\",\n                 \"shasum\": \"\"\n             },\n             \"require\": {\n-                \"ext-mbstring\": \"*\",\n-                \"php\": \">=5.3.0\"\n+                \"php\": \"^7.1 || ^8.0\"\n             },\n             \"require-dev\": {\n-                \"phpunit/phpunit\": \"^4.8.35\"\n+                \"phpstan/phpstan\": \"^0.12.42\",\n+                \"phpunit/phpunit\": \"^7.5 || ^8.5 || ^9.3\",\n+                \"scrutinizer/ocular\": \"1.6.0\",\n+                \"squizlabs/php_codesniffer\": \"^3.5\",\n+                \"vimeo/psalm\": \"^4.0.0\"\n             },\n             \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-main\": \"3.x-dev\"\n+                }\n+            },\n             \"autoload\": {\n-                \"psr-0\": {\n-                    \"Parsedown\": \"\"\n+                \"psr-4\": {\n+                    \"Dflydev\\\\DotAccessData\\\\\": \"src/\"\n                 }\n             },\n             \"notification-url\": \"https://packagist.org/downloads/\",\n@@ -101,22 +109,39 @@\n             ],\n             \"authors\": [\n                 {\n-                    \"name\": \"Emanuil Rusev\",\n-                    \"email\": \"hello@erusev.com\",\n-                    \"homepage\": \"http://erusev.com\"\n+                    \"name\": \"Dragonfly Development Inc.\",\n+                    \"email\": \"info@dflydev.com\",\n+                    \"homepage\": \"http://dflydev.com\"\n+                },\n+                {\n+                    \"name\": \"Beau Simensen\",\n+                    \"email\": \"beau@dflydev.com\",\n+                    \"homepage\": \"http://beausimensen.com\"\n+                },\n+                {\n+                    \"name\": \"Carlos Frutos\",\n+                    \"email\": \"carlos@kiwing.it\",\n+                    \"homepage\": \"https://github.com/cfrutos\"\n+                },\n+                {\n+                    \"name\": \"Colin O'Dell\",\n+                    \"email\": \"colinodell@gmail.com\",\n+                    \"homepage\": \"https://www.colinodell.com\"\n                 }\n             ],\n-            \"description\": \"Parser for Markdown.\",\n-            \"homepage\": \"http://parsedown.org\",\n+            \"description\": \"Given a deep data structure, access data by dot notation.\",\n+            \"homepage\": \"https://github.com/dflydev/dflydev-dot-access-data\",\n             \"keywords\": [\n-                \"markdown\",\n-                \"parser\"\n+                \"access\",\n+                \"data\",\n+                \"dot\",\n+                \"notation\"\n             ],\n             \"support\": {\n-                \"issues\": \"https://github.com/erusev/parsedown/issues\",\n-                \"source\": \"https://github.com/erusev/parsedown/tree/1.7.x\"\n+                \"issues\": \"https://github.com/dflydev/dflydev-dot-access-data/issues\",\n+                \"source\": \"https://github.com/dflydev/dflydev-dot-access-data/tree/v3.0.2\"\n             },\n-            \"time\": \"2019-12-30T22:54:17+00:00\"\n+            \"time\": \"2022-10-27T11:44:00+00:00\"\n         },\n         {\n             \"name\": \"froxlor/idna-convert-legacy\",\n@@ -174,6 +199,194 @@\n             },\n             \"time\": \"2019-12-31T12:16:30+00:00\"\n         },\n+        {\n+            \"name\": \"league/commonmark\",\n+            \"version\": \"2.4.1\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/thephpleague/commonmark.git\",\n+                \"reference\": \"3669d6d5f7a47a93c08ddff335e6d945481a1dd5\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/thephpleague/commonmark/zipball/3669d6d5f7a47a93c08ddff335e6d945481a1dd5\",\n+                \"reference\": \"3669d6d5f7a47a93c08ddff335e6d945481a1dd5\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"ext-mbstring\": \"*\",\n+                \"league/config\": \"^1.1.1\",\n+                \"php\": \"^7.4 || ^8.0\",\n+                \"psr/event-dispatcher\": \"^1.0\",\n+                \"symfony/deprecation-contracts\": \"^2.1 || ^3.0\",\n+                \"symfony/polyfill-php80\": \"^1.16\"\n+            },\n+            \"require-dev\": {\n+                \"cebe/markdown\": \"^1.0\",\n+                \"commonmark/cmark\": \"0.30.0\",\n+                \"commonmark/commonmark.js\": \"0.30.0\",\n+                \"composer/package-versions-deprecated\": \"^1.8\",\n+                \"embed/embed\": \"^4.4\",\n+                \"erusev/parsedown\": \"^1.0\",\n+                \"ext-json\": \"*\",\n+                \"github/gfm\": \"0.29.0\",\n+                \"michelf/php-markdown\": \"^1.4 || ^2.0\",\n+                \"nyholm/psr7\": \"^1.5\",\n+                \"phpstan/phpstan\": \"^1.8.2\",\n+                \"phpunit/phpunit\": \"^9.5.21\",\n+                \"scrutinizer/ocular\": \"^1.8.1\",\n+                \"symfony/finder\": \"^5.3 | ^6.0\",\n+                \"symfony/yaml\": \"^2.3 | ^3.0 | ^4.0 | ^5.0 | ^6.0\",\n+                \"unleashedtech/php-coding-standard\": \"^3.1.1\",\n+                \"vimeo/psalm\": \"^4.24.0 || ^5.0.0\"\n+            },\n+            \"suggest\": {\n+                \"symfony/yaml\": \"v2.3+ required if using the Front Matter extension\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-main\": \"2.5-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"psr-4\": {\n+                    \"League\\\\CommonMark\\\\\": \"src\"\n+                }\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"BSD-3-Clause\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"Colin O'Dell\",\n+                    \"email\": \"colinodell@gmail.com\",\n+                    \"homepage\": \"https://www.colinodell.com\",\n+                    \"role\": \"Lead Developer\"\n+                }\n+            ],\n+            \"description\": \"Highly-extensible PHP Markdown parser which fully supports the CommonMark spec and GitHub-Flavored Markdown (GFM)\",\n+            \"homepage\": \"https://commonmark.thephpleague.com\",\n+            \"keywords\": [\n+                \"commonmark\",\n+                \"flavored\",\n+                \"gfm\",\n+                \"github\",\n+                \"github-flavored\",\n+                \"markdown\",\n+                \"md\",\n+                \"parser\"\n+            ],\n+            \"support\": {\n+                \"docs\": \"https://commonmark.thephpleague.com/\",\n+                \"forum\": \"https://github.com/thephpleague/commonmark/discussions\",\n+                \"issues\": \"https://github.com/thephpleague/commonmark/issues\",\n+                \"rss\": \"https://github.com/thephpleague/commonmark/releases.atom\",\n+                \"source\": \"https://github.com/thephpleague/commonmark\"\n+            },\n+            \"funding\": [\n+                {\n+                    \"url\": \"https://www.colinodell.com/sponsor\",\n+                    \"type\": \"custom\"\n+                },\n+                {\n+                    \"url\": \"https://www.paypal.me/colinpodell/10.00\",\n+                    \"type\": \"custom\"\n+                },\n+                {\n+                    \"url\": \"https://github.com/colinodell\",\n+                    \"type\": \"github\"\n+                },\n+                {\n+                    \"url\": \"https://tidelift.com/funding/github/packagist/league/commonmark\",\n+                    \"type\": \"tidelift\"\n+                }\n+            ],\n+            \"time\": \"2023-08-30T16:55:00+00:00\"\n+        },\n+        {\n+            \"name\": \"league/config\",\n+            \"version\": \"v1.2.0\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/thephpleague/config.git\",\n+                \"reference\": \"754b3604fb2984c71f4af4a9cbe7b57f346ec1f3\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/thephpleague/config/zipball/754b3604fb2984c71f4af4a9cbe7b57f346ec1f3\",\n+                \"reference\": \"754b3604fb2984c71f4af4a9cbe7b57f346ec1f3\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"dflydev/dot-access-data\": \"^3.0.1\",\n+                \"nette/schema\": \"^1.2\",\n+                \"php\": \"^7.4 || ^8.0\"\n+            },\n+            \"require-dev\": {\n+                \"phpstan/phpstan\": \"^1.8.2\",\n+                \"phpunit/phpunit\": \"^9.5.5\",\n+                \"scrutinizer/ocular\": \"^1.8.1\",\n+                \"unleashedtech/php-coding-standard\": \"^3.1\",\n+                \"vimeo/psalm\": \"^4.7.3\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-main\": \"1.2-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"psr-4\": {\n+                    \"League\\\\Config\\\\\": \"src\"\n+                }\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"BSD-3-Clause\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"Colin O'Dell\",\n+                    \"email\": \"colinodell@gmail.com\",\n+                    \"homepage\": \"https://www.colinodell.com\",\n+                    \"role\": \"Lead Developer\"\n+                }\n+            ],\n+            \"description\": \"Define configuration arrays with strict schemas and access values with dot notation\",\n+            \"homepage\": \"https://config.thephpleague.com\",\n+            \"keywords\": [\n+                \"array\",\n+                \"config\",\n+                \"configuration\",\n+                \"dot\",\n+                \"dot-access\",\n+                \"nested\",\n+                \"schema\"\n+            ],\n+            \"support\": {\n+                \"docs\": \"https://config.thephpleague.com/\",\n+                \"issues\": \"https://github.com/thephpleague/config/issues\",\n+                \"rss\": \"https://github.com/thephpleague/config/releases.atom\",\n+                \"source\": \"https://github.com/thephpleague/config\"\n+            },\n+            \"funding\": [\n+                {\n+                    \"url\": \"https://www.colinodell.com/sponsor\",\n+                    \"type\": \"custom\"\n+                },\n+                {\n+                    \"url\": \"https://www.paypal.me/colinpodell/10.00\",\n+                    \"type\": \"custom\"\n+                },\n+                {\n+                    \"url\": \"https://github.com/colinodell\",\n+                    \"type\": \"github\"\n+                }\n+            ],\n+            \"time\": \"2022-12-11T20:36:23+00:00\"\n+        },\n         {\n             \"name\": \"monolog/monolog\",\n             \"version\": \"1.27.1\",\n@@ -260,6 +473,154 @@\n             ],\n             \"time\": \"2022-06-09T08:53:42+00:00\"\n         },\n+        {\n+            \"name\": \"nette/schema\",\n+            \"version\": \"v1.2.4\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/nette/schema.git\",\n+                \"reference\": \"c9ff517a53903b3d4e29ec547fb20feecb05b8ab\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/nette/schema/zipball/c9ff517a53903b3d4e29ec547fb20feecb05b8ab\",\n+                \"reference\": \"c9ff517a53903b3d4e29ec547fb20feecb05b8ab\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"nette/utils\": \"^2.5.7 || ^3.1.5 ||  ^4.0\",\n+                \"php\": \"7.1 - 8.3\"\n+            },\n+            \"require-dev\": {\n+                \"nette/tester\": \"^2.3 || ^2.4\",\n+                \"phpstan/phpstan-nette\": \"^1.0\",\n+                \"tracy/tracy\": \"^2.7\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-master\": \"1.2-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"classmap\": [\n+                    \"src/\"\n+                ]\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"BSD-3-Clause\",\n+                \"GPL-2.0-only\",\n+                \"GPL-3.0-only\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"David Grudl\",\n+                    \"homepage\": \"https://davidgrudl.com\"\n+                },\n+                {\n+                    \"name\": \"Nette Community\",\n+                    \"homepage\": \"https://nette.org/contributors\"\n+                }\n+            ],\n+            \"description\": \"\ud83d\udcd0 Nette Schema: validating data structures against a given Schema.\",\n+            \"homepage\": \"https://nette.org\",\n+            \"keywords\": [\n+                \"config\",\n+                \"nette\"\n+            ],\n+            \"support\": {\n+                \"issues\": \"https://github.com/nette/schema/issues\",\n+                \"source\": \"https://github.com/nette/schema/tree/v1.2.4\"\n+            },\n+            \"time\": \"2023-08-05T18:56:25+00:00\"\n+        },\n+        {\n+            \"name\": \"nette/utils\",\n+            \"version\": \"v3.2.10\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/nette/utils.git\",\n+                \"reference\": \"a4175c62652f2300c8017fb7e640f9ccb11648d2\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/nette/utils/zipball/a4175c62652f2300c8017fb7e640f9ccb11648d2\",\n+                \"reference\": \"a4175c62652f2300c8017fb7e640f9ccb11648d2\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"php\": \">=7.2 <8.4\"\n+            },\n+            \"conflict\": {\n+                \"nette/di\": \"<3.0.6\"\n+            },\n+            \"require-dev\": {\n+                \"jetbrains/phpstorm-attributes\": \"dev-master\",\n+                \"nette/tester\": \"~2.0\",\n+                \"phpstan/phpstan\": \"^1.0\",\n+                \"tracy/tracy\": \"^2.3\"\n+            },\n+            \"suggest\": {\n+                \"ext-gd\": \"to use Image\",\n+                \"ext-iconv\": \"to use Strings::webalize(), toAscii(), chr() and reverse()\",\n+                \"ext-intl\": \"to use Strings::webalize(), toAscii(), normalize() and compare()\",\n+                \"ext-json\": \"to use Nette\\\\Utils\\\\Json\",\n+                \"ext-mbstring\": \"to use Strings::lower() etc...\",\n+                \"ext-tokenizer\": \"to use Nette\\\\Utils\\\\Reflection::getUseStatements()\",\n+                \"ext-xml\": \"to use Strings::length() etc. when mbstring is not available\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-master\": \"3.2-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"classmap\": [\n+                    \"src/\"\n+                ]\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"BSD-3-Clause\",\n+                \"GPL-2.0-only\",\n+                \"GPL-3.0-only\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"David Grudl\",\n+                    \"homepage\": \"https://davidgrudl.com\"\n+                },\n+                {\n+                    \"name\": \"Nette Community\",\n+                    \"homepage\": \"https://nette.org/contributors\"\n+                }\n+            ],\n+            \"description\": \"\ud83d\udee0  Nette Utils: lightweight utilities for string & array manipulation, image handling, safe JSON encoding/decoding, validation, slug or strong password generating etc.\",\n+            \"homepage\": \"https://nette.org\",\n+            \"keywords\": [\n+                \"array\",\n+                \"core\",\n+                \"datetime\",\n+                \"images\",\n+                \"json\",\n+                \"nette\",\n+                \"paginator\",\n+                \"password\",\n+                \"slugify\",\n+                \"string\",\n+                \"unicode\",\n+                \"utf-8\",\n+                \"utility\",\n+                \"validation\"\n+            ],\n+            \"support\": {\n+                \"issues\": \"https://github.com/nette/utils/issues\",\n+                \"source\": \"https://github.com/nette/utils/tree/v3.2.10\"\n+            },\n+            \"time\": \"2023-07-30T15:38:18+00:00\"\n+        },\n         {\n             \"name\": \"pear/net_dns2\",\n             \"version\": \"v1.5.3\",\n@@ -439,6 +800,56 @@\n             },\n             \"time\": \"2021-11-05T16:50:12+00:00\"\n         },\n+        {\n+            \"name\": \"psr/event-dispatcher\",\n+            \"version\": \"1.0.0\",\n+            \"source\": {\n+                \"type\": \"git\",\n+                \"url\": \"https://github.com/php-fig/event-dispatcher.git\",\n+                \"reference\": \"dbefd12671e8a14ec7f180cab83036ed26714bb0\"\n+            },\n+            \"dist\": {\n+                \"type\": \"zip\",\n+                \"url\": \"https://api.github.com/repos/php-fig/event-dispatcher/zipball/dbefd12671e8a14ec7f180cab83036ed26714bb0\",\n+                \"reference\": \"dbefd12671e8a14ec7f180cab83036ed26714bb0\",\n+                \"shasum\": \"\"\n+            },\n+            \"require\": {\n+                \"php\": \">=7.2.0\"\n+            },\n+            \"type\": \"library\",\n+            \"extra\": {\n+                \"branch-alias\": {\n+                    \"dev-master\": \"1.0.x-dev\"\n+                }\n+            },\n+            \"autoload\": {\n+                \"psr-4\": {\n+                    \"Psr\\\\EventDispatcher\\\\\": \"src/\"\n+                }\n+            },\n+            \"notification-url\": \"https://packagist.org/downloads/\",\n+            \"license\": [\n+                \"MIT\"\n+            ],\n+            \"authors\": [\n+                {\n+                    \"name\": \"PHP-FIG\",\n+                    \"homepage\": \"http://www.php-fig.org/\"\n+                }\n+            ],\n+            \"description\": \"Standard interfaces for event handling.\",\n+            \"keywords\": [\n+                \"events\",\n+                \"psr\",\n+                \"psr-14\"\n+            ],\n+            \"support\": {\n+                \"issues\": \"https://github.com/php-fig/event-dispatcher/issues\",\n+                \"source\": \"https://github.com/php-fig/event-dispatcher/tree/1.0.0\"\n+            },\n+            \"time\": \"2019-01-08T18:20:26+00:00\"\n+        },\n         {\n             \"name\": \"psr/log\",\n             \"version\": \"1.1.4\","
        },
        {
          "filename": "lib/Froxlor/System/Markdown.php",
          "status": "added",
          "additions": 58,
          "deletions": 0,
          "patch": "@@ -0,0 +1,58 @@\n+<?php\n+\n+/**\n+ * This file is part of the Froxlor project.\n+ * Copyright (c) 2010 the Froxlor Team (see authors).\n+ *\n+ * This program is free software; you can redistribute it and/or\n+ * modify it under the terms of the GNU General Public License\n+ * as published by the Free Software Foundation; either version 2\n+ * of the License, or (at your option) any later version.\n+ *\n+ * This program is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n+ * GNU General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU General Public License\n+ * along with this program; if not, you can also view it online at\n+ * https://files.froxlor.org/misc/COPYING.txt\n+ *\n+ * @copyright  the authors\n+ * @author     Froxlor team <team@froxlor.org>\n+ * @license    https://files.froxlor.org/misc/COPYING.txt GPLv2\n+ */\n+\n+namespace Froxlor\\System;\n+\n+use League\\CommonMark\\Exception\\CommonMarkException;\n+use League\\CommonMark\\GithubFlavoredMarkdownConverter;\n+\n+class Markdown\n+{\n+\n+\tprivate static $converter = null;\n+\n+\tpublic static function converter(): ?GithubFlavoredMarkdownConverter\n+\t{\n+\t\tif (is_null(self::$converter)) {\n+\t\t\tself::$converter = new GithubFlavoredMarkdownConverter([\n+\t\t\t\t'html_input' => 'strip',\n+\t\t\t\t'allow_unsafe_links' => false,\n+\t\t\t]);\n+\t\t}\n+\t\treturn self::$converter;\n+\t}\n+\n+\tpublic static function cleanCustomNotes(string $note = \"\"): string\n+\t{\n+\t\tif (!empty($note)) {\n+\t\t\ttry {\n+\t\t\t\t$note = self::converter()->convert($note)->getContent();\n+\t\t\t} catch (CommonMarkException $e) {\n+\t\t\t\t$note = \"\";\n+\t\t\t}\n+\t\t}\n+\t\treturn $note;\n+\t}\n+}"
        },
        {
          "filename": "lib/Froxlor/UI/Callbacks/Customer.php",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -26,17 +26,19 @@\n namespace Froxlor\\UI\\Callbacks;\n \n use Froxlor\\Settings;\n+use Froxlor\\System\\Markdown;\n \n class Customer\n {\n-\tpublic static function isLocked(array $attributes)\n+\tpublic static function isLocked(array $attributes): bool\n \t{\n \t\treturn $attributes['fields']['loginfail_count'] >= Settings::Get('login.maxloginattempts')\n \t\t\t&& $attributes['fields']['lastlogin_fail'] > (time() - Settings::Get('login.deactivatetime'));\n \t}\n \n-\tpublic static function hasNote(array $attributes)\n+\tpublic static function hasNote(array $attributes): bool\n \t{\n-\t\treturn !empty($attributes['fields']['custom_notes']);\n+\t\t$cleanNote = Markdown::cleanCustomNotes($attributes['fields']['custom_notes'] ?? \"\");\n+\t\treturn !empty($cleanNote);\n \t}\n }"
        },
        {
          "filename": "lib/Froxlor/UI/Callbacks/Text.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -29,6 +29,7 @@\n use Froxlor\\Database\\Database;\n use Froxlor\\Froxlor;\n use Froxlor\\PhpHelper;\n+use Froxlor\\System\\Markdown;\n use Froxlor\\UI\\Panel\\UI;\n use Froxlor\\User;\n use PDO;\n@@ -93,7 +94,7 @@ public static function customerNoteDetailModal(array $attributes): array\n \t\t\t'entry' => $attributes['fields']['id'],\n \t\t\t'id' => 'cnModal' . $attributes['fields']['id'],\n \t\t\t'title' => lng('usersettings.custom_notes.title') . ': ' . ($attributes['fields']['loginname'] ?? $attributes['fields']['adminname']),\n-\t\t\t'body' => nl2br($note)\n+\t\t\t'body' => nl2br(Markdown::cleanCustomNotes($note))\n \t\t];\n \t}\n "
        },
        {
          "filename": "lib/Froxlor/UI/Panel/FroxlorTwig.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -29,6 +29,7 @@\n \n use Froxlor\\Idna\\IdnaWrapper;\n use Froxlor\\Settings;\n+use Froxlor\\System\\Markdown;\n use Parsedown;\n use Twig\\Extension\\AbstractExtension;\n use Twig\\TwigFilter;\n@@ -53,9 +54,9 @@ public function getFilters()\n \t\t\t\t$this,\n \t\t\t\t'idnDecodeFilter'\n \t\t\t]),\n-\t\t\tnew TwigFilter('parsedown', [\n+\t\t\tnew TwigFilter('markdown', [\n \t\t\t\t$this,\n-\t\t\t\t'callParsedown'\n+\t\t\t\t'callMarkdown'\n \t\t\t])\n \t\t];\n \t}\n@@ -148,10 +149,9 @@ public function getLink($linkopts)\n \t\treturn UI::getLinker()->getLink($linkopts);\n \t}\n \n-\tpublic function callParsedown($string)\n+\tpublic function callMarkdown($string): string\n \t{\n-\t\t$pd = new Parsedown();\n-\t\treturn $pd->line($string);\n+\t\treturn Markdown::cleanCustomNotes($string ?? \"\");\n \t}\n \n \t/**"
        },
        {
          "filename": "lng/de.lng.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2213,7 +2213,7 @@\n \t'usersettings' => [\n \t\t'custom_notes' => [\n \t\t\t'title' => 'Eigene Notizen',\n-\t\t\t'description' => 'Hier k\u00f6nnen Notizen je nach Lust und Laune eingetragen werden. Diese werden in der Administrator/Kunden-\u00dcbersicht bei dem jeweiligen Benutzer angezeigt.',\n+\t\t\t'description' => 'Hier k\u00f6nnen Notizen je nach Lust und Laune eingetragen werden. Diese werden in der Administrator/Kunden-\u00dcbersicht bei dem jeweiligen Benutzer angezeigt.<br>Markdown ist unterst\u00fctzt, HTML wird entfernt.',\n \t\t\t'show' => 'Zeige die Notizen auf dem Dashboard des Benutzers',\n \t\t],\n \t\t'api_allowed' => ["
        },
        {
          "filename": "lng/en.lng.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -2346,7 +2346,7 @@\n \t'usersettings' => [\n \t\t'custom_notes' => [\n \t\t\t'title' => 'Custom notes',\n-\t\t\t'description' => 'Feel free to put any notes you want/need in here. They will show up in the admin/customer overview for the corresponding user.',\n+\t\t\t'description' => 'Feel free to put any notes you want/need in here. They will show up in the admin/customer overview for the corresponding user.<br>Markdown is supported, HTML will be removed.',\n \t\t\t'show' => 'Show your notes on the dashboard of the user',\n \t\t],\n \t\t'api_allowed' => ["
        },
        {
          "filename": "templates/Froxlor/user/index.html.twig",
          "status": "modified",
          "additions": 4,
          "deletions": 4,
          "patch": "@@ -136,12 +136,12 @@\n \t\t\t\t\t</ul>\n \t\t\t\t</div>\n \n-\t\t\t\t{% if userinfo.custom_notes is not empty and userinfo.custom_notes_show == 1 %}\n+\t\t\t\t{% if userinfo.custom_notes|markdown is not empty and userinfo.custom_notes_show == 1 %}\n \t\t\t\t\t<div class=\"card mb-3\">\n \t\t\t\t\t\t<ul class=\"list-group list-group-flush\">\n \t\t\t\t\t\t\t<li class=\"list-group-item list-group-item-info d-flex justify-content-between align-items-start\">\n \t\t\t\t\t\t\t\t<div class=\"ms-2 me-auto\">\n-\t\t\t\t\t\t\t\t\t{{ userinfo.custom_notes|nl2br|raw }}\n+\t\t\t\t\t\t\t\t\t{{ userinfo.custom_notes|markdown|raw }}\n \t\t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t\t</li>\n \t\t\t\t\t\t</ul>\n@@ -263,10 +263,10 @@\n \t\t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t\t</li>\n \t\t\t\t\t\t{% endif %}\n-\t\t\t\t\t\t{% if userinfo.custom_notes is not empty and userinfo.custom_notes_show == 1 %}\n+\t\t\t\t\t\t{% if userinfo.custom_notes|markdown is not empty and userinfo.custom_notes_show == 1 %}\n \t\t\t\t\t\t\t<li class=\"list-group-item list-group-item-info d-flex justify-content-between align-items-start\">\n \t\t\t\t\t\t\t\t<div class=\"ms-2 me-auto\">\n-\t\t\t\t\t\t\t\t\t{{ userinfo.custom_notes|nl2br|raw }}\n+\t\t\t\t\t\t\t\t\t{{ userinfo.custom_notes|markdown|raw }}\n \t\t\t\t\t\t\t\t</div>\n \t\t\t\t\t\t\t</li>\n \t\t\t\t\t\t{% endif %}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec42003367df64c5645a9d5ee5bcd95c75a82b6c",
            "date": "2025-01-12T15:53:05Z",
            "author_login": "d00p"
          },
          {
            "sha": "fde43f80600f1035e1e3d2297411b666d805549a",
            "date": "2025-01-12T09:27:44Z",
            "author_login": "d00p"
          },
          {
            "sha": "a43d53d54034805e3e404702a01312fa0c40b623",
            "date": "2025-01-12T09:27:02Z",
            "author_login": "d00p"
          },
          {
            "sha": "3638dc08ea4fe55ce0d2458cdcb436cfb5697ed3",
            "date": "2024-12-24T08:34:59Z",
            "author_login": "d00p"
          },
          {
            "sha": "c2d166c86666f4c50c1402c1b3a2986ddabeee90",
            "date": "2024-12-19T07:59:00Z",
            "author_login": "d00p"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross-site Scripting (XSS) - Stored in GitHub repository froxlor/froxlor prior to 2.1.0-dev1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-10-13T01:15:56.093",
    "last_modified": "2024-11-21T08:42:01.573",
    "fix_date": "2023-10-02T13:40:50Z"
  },
  "references": [
    {
      "url": "https://github.com/froxlor/froxlor/commit/e8ed43056c1665522a586e3485da67f2bdf073aa",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/9254d8f3-a847-4ae8-8477-d2ce027cff5c",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/froxlor/froxlor/commit/e8ed43056c1665522a586e3485da67f2bdf073aa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.dev/bounties/9254d8f3-a847-4ae8-8477-d2ce027cff5c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:10.596563",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Froxlor",
    "owner": "froxlor",
    "created_at": "2012-03-06T15:14:46Z",
    "updated_at": "2025-01-12T15:57:15Z",
    "pushed_at": "2025-01-12T15:57:10Z",
    "size": 28867,
    "stars": 1651,
    "forks": 457,
    "open_issues": 35,
    "watchers": 1651,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "extras",
      "main"
    ],
    "languages": {
      "PHP": 3752037,
      "Twig": 153143,
      "HTML": 28494,
      "SCSS": 8015,
      "JavaScript": 942
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:34:15.893221"
  }
}