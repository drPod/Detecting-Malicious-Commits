{
  "cve_id": "CVE-2023-5897",
  "github_data": {
    "repository": "pkp/customLocale",
    "fix_commit": "407ba30f12f78efe79122591c1d85709c10b6831",
    "related_commits": [
      "407ba30f12f78efe79122591c1d85709c10b6831",
      "407ba30f12f78efe79122591c1d85709c10b6831"
    ],
    "patch_url": "https://github.com/pkp/customLocale/commit/407ba30f12f78efe79122591c1d85709c10b6831.patch",
    "fix_commit_details": {
      "sha": "407ba30f12f78efe79122591c1d85709c10b6831",
      "commit_date": "2023-10-03T19:35:38Z",
      "author": {
        "login": "asmecher",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "https://github.com/pkp/customLocale/issues/27 Add CSRF checking",
        "length": 63,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "controllers/grid/CustomLocaleGridHandler.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -74,6 +74,8 @@ public function updateLocale(array $args, PKPRequest $request): JSONMessage\n     {\n         ['locale' => $locale, 'changes' => $changes] = $args;\n \n+\tif (!$request->checkCSRF()) return new JSONMessage(false);\n+\n         if (!count($changes)) {\n             $this->setupTemplate($request);\n             // Create and present the edit form"
        },
        {
          "filename": "templates/localeFile.tpl",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -7,6 +7,7 @@\n  *}\n \n <form class=\"pkp_form\" id=\"localeFilesForm\" method=\"post\" action=\"{url router=$smarty.const.ROUTE_COMPONENT component=\"plugins.generic.customLocale.controllers.grid.CustomLocaleGridHandler\" op=\"updateLocale\" locale=$locale key=$name anchor=\"localeContents\"}\">\n+\t{csrf}\n \t<link rel=\"stylesheet\" href=\"{$baseUrl}/plugins/generic/customLocale/css/customLocale.css\" type=\"text/css\" />\n \t<div id=\"customLocales\">\n \t\t{* TABLE *}\n@@ -185,4 +186,4 @@\n \t\tcustomLocalesApp.data.localeKeysMaster = {$referenceLocaleContents|json_encode};\n \t\tnew pkp.Vue(customLocalesApp);\n \t</script>\n-</form>\n\\ No newline at end of file\n+</form>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "730bfb5a5c965dc657f14c7c012c05116aeca302",
            "date": "2023-10-03T19:47:56Z",
            "author_login": "asmecher"
          },
          {
            "sha": "e2d8734191ea9dcd1a65d8035ed0533edb03123d",
            "date": "2024-12-11T13:33:21Z",
            "author_login": "bozana"
          },
          {
            "sha": "7c15c0a782cb5802894fdd803bbe8e77bd497de5",
            "date": "2024-12-10T13:53:02Z",
            "author_login": "bozana"
          },
          {
            "sha": "9017e59d59ce97737c2848dbda49308f1f8f47c9",
            "date": "2024-12-03T14:30:12Z",
            "author_login": "bozana"
          },
          {
            "sha": "fea0f2d5b968d82d02f1c5a741b29242a4871c99",
            "date": "2024-11-19T11:27:14Z",
            "author_login": "bozana"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-352",
    "description": "Cross-Site Request Forgery (CSRF) in GitHub repository pkp/customLocale prior to 1.2.0-1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-01T01:15:07.937",
    "last_modified": "2024-11-21T08:42:43.710",
    "fix_date": "2023-10-03T19:35:38Z"
  },
  "references": [
    {
      "url": "https://github.com/pkp/customLocale/commit/407ba30f12f78efe79122591c1d85709c10b6831",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/7c215b8e-63f6-4146-b8e3-8482c731876f",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pkp/customLocale/commit/407ba30f12f78efe79122591c1d85709c10b6831",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/7c215b8e-63f6-4146-b8e3-8482c731876f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:36.976648",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "customLocale",
    "owner": "pkp",
    "created_at": "2016-11-28T22:12:28Z",
    "updated_at": "2024-12-18T19:25:57Z",
    "pushed_at": "2024-12-18T19:25:53Z",
    "size": 262,
    "stars": 0,
    "forks": 19,
    "open_issues": 5,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 26843,
      "Smarty": 6991,
      "JavaScript": 6192,
      "CSS": 647
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:01:29.811735"
  }
}