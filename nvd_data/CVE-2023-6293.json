{
  "cve_id": "CVE-2023-6293",
  "github_data": {
    "repository": "robinbuschmann/sequelize-typescript",
    "fix_commit": "5ce8afdd1671b08c774ce106b000605ba8fccf78",
    "related_commits": [
      "5ce8afdd1671b08c774ce106b000605ba8fccf78",
      "5ce8afdd1671b08c774ce106b000605ba8fccf78"
    ],
    "patch_url": "https://github.com/robinbuschmann/sequelize-typescript/commit/5ce8afdd1671b08c774ce106b000605ba8fccf78.patch",
    "fix_commit_details": {
      "sha": "5ce8afdd1671b08c774ce106b000605ba8fccf78",
      "commit_date": "2023-11-24T19:36:06Z",
      "author": {
        "login": "WikiRik",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: deny modifying the object prototype (#1698)",
        "length": 48,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 13,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/shared/object.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -14,7 +14,10 @@ export function deepAssign<T, S>(target: T, source: S): T & S;\n export function deepAssign<S>(target: {}, source: S): S;\n export function deepAssign(target: any, ...sources: any[]): any {\n   sources.forEach((source) => {\n-    Object.getOwnPropertyNames(source).forEach((key) => assign(key, target, source));\n+    Object.getOwnPropertyNames(source).forEach(\n+      (key) =>\n+        !['__proto__', 'constructor', 'prototype'].includes(key) && assign(key, target, source)\n+    );\n     /* istanbul ignore next */\n     if (Object.getOwnPropertySymbols) {\n       Object.getOwnPropertySymbols(source).forEach((key) => assign(key, target, source));"
        },
        {
          "filename": "test/specs/utils/object.spec.ts",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -1,5 +1,6 @@\n import { expect } from 'chai';\n import { deepAssign } from '../../../src/shared/object';\n+import { addScopeOptions } from '../../../src/scopes/scope-service';\n \n describe('utils', () => {\n   describe('object', () => {\n@@ -109,6 +110,14 @@ describe('utils', () => {\n         expect(copy.test).to.have.property('protoFn').that.is.a('function');\n       });\n \n+      it('ignore prototype property', () => {\n+        const BAD_JSON = JSON.parse('{\"__proto__\":{\"polluted\":true}}');\n+        const empty_scope = {};\n+\n+        addScopeOptions(empty_scope, BAD_JSON);\n+        expect(empty_scope).not.to.have.property('polluted');\n+      });\n+\n       if (Object.getOwnPropertySymbols) {\n         it('should copy symbol based objects', () => {\n           const symbol = Symbol('test');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8ded61aa26e192b455c682377d45cef0582e11e2",
            "date": "2023-11-24T19:58:21Z",
            "author_login": "WikiRik"
          },
          {
            "sha": "32e4824966b6230877bcd1f6c69f896a1e2bd9d7",
            "date": "2023-11-24T19:46:10Z",
            "author_login": "WikiRik"
          },
          {
            "sha": "92c3f492163560ab84f68367d2a1e6d3245d2160",
            "date": "2023-11-24T19:41:28Z",
            "author_login": "WikiRik"
          },
          {
            "sha": "5ce8afdd1671b08c774ce106b000605ba8fccf78",
            "date": "2023-11-24T19:36:06Z",
            "author_login": "WikiRik"
          },
          {
            "sha": "837a3cc7b1ef111d4597eb58aa5b7a9b91b665b6",
            "date": "2023-04-08T08:41:37Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H",
    "cwe_id": "CWE-1321",
    "description": "Prototype Pollution in GitHub repository robinbuschmann/sequelize-typescript prior to 2.1.6.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2023-11-24T20:15:07.293",
    "last_modified": "2024-11-21T08:43:32.913",
    "fix_date": "2023-11-24T19:36:06Z"
  },
  "references": [
    {
      "url": "https://github.com/robinbuschmann/sequelize-typescript/commit/5ce8afdd1671b08c774ce106b000605ba8fccf78",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/36a7ecbf-4d3d-462e-86a3-cda7b1ec64e2",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/robinbuschmann/sequelize-typescript/commit/5ce8afdd1671b08c774ce106b000605ba8fccf78",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/36a7ecbf-4d3d-462e-86a3-cda7b1ec64e2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:39.284755",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sequelize-typescript",
    "owner": "robinbuschmann",
    "created_at": "2016-01-27T11:25:52Z",
    "updated_at": "2025-01-09T22:28:52Z",
    "pushed_at": "2024-04-20T03:54:41Z",
    "size": 7207,
    "stars": 2800,
    "forks": 285,
    "open_issues": 256,
    "watchers": 2800,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "TypeScript": 455130,
      "JavaScript": 930,
      "Shell": 153
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0.0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:54:40.768276"
  }
}