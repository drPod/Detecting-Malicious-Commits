{
  "cve_id": "CVE-2023-6395",
  "github_data": {
    "repository": "xsuchy/templated-dictionary",
    "fix_commit": "0740bd0ca8d487301881541028977d120f8b8933",
    "related_commits": [
      "0740bd0ca8d487301881541028977d120f8b8933",
      "bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69",
      "0740bd0ca8d487301881541028977d120f8b8933",
      "bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69"
    ],
    "patch_url": "https://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933.patch",
    "fix_commit_details": {
      "sha": "0740bd0ca8d487301881541028977d120f8b8933",
      "commit_date": "2023-12-11T08:28:17Z",
      "author": {
        "login": "praiskup",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Make the TemplatedDictionary objects picklable",
        "length": 1041,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 2,
        "deletions": 3
      },
      "files": [
        {
          "filename": "templated_dictionary/__init__.py",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -4,6 +4,7 @@\n from collections.abc import MutableMapping\n from jinja2 import sandbox\n \n+SANDBOX = sandbox.SandboxedEnvironment(keep_trailing_newline=True)\n \n # pylint: disable=no-member,unsupported-assignment-operation\n class TemplatedDictionary(MutableMapping):\n@@ -19,8 +20,6 @@ def __init__(self, *args, alias_spec=None, **kwargs):\n         '''\n         self.__dict__.update(*args, **kwargs)\n \n-        self.sandbox = sandbox.SandboxedEnvironment(keep_trailing_newline=True)\n-\n         self._aliases = {}\n         if alias_spec:\n             for aliased_to, aliases in alias_spec.items():\n@@ -82,7 +81,7 @@ def __render_string(self, value):\n         orig = last = value\n         max_recursion = self.__dict__.get('jinja_max_recursion', 5)\n         for _ in range(max_recursion):\n-            value = _to_native(self.sandbox.from_string(value).render(self.__dict__, func=lambda:None))\n+            value = _to_native(SANDBOX.from_string(value).render(self.__dict__, func=lambda:None))\n             if value == last:\n                 return value\n             last = value"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d31c9136c81a4db13fa8a4f52cfcda27d54bb374",
            "date": "2024-09-17T05:13:34Z",
            "author_login": "praiskup"
          },
          {
            "sha": "67e6c6a2b347dc806b3945b9bbe4154371dcefe0",
            "date": "2024-09-10T10:03:29Z",
            "author_login": "praiskup"
          },
          {
            "sha": "856ac7f7572bb48145acd0668e504901832d0cae",
            "date": "2024-09-10T09:59:28Z",
            "author_login": "praiskup"
          },
          {
            "sha": "20a390ec0160c1c571371d0eb4919de28a2bc863",
            "date": "2024-09-10T09:45:33Z",
            "author_login": "praiskup"
          },
          {
            "sha": "8bf2431a0ec198b9db73441963d8ebe5db3e4024",
            "date": "2024-01-16T13:48:02Z",
            "author_login": "praiskup"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.7,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-20",
    "description": "The Mock software contains a vulnerability wherein an attacker could potentially exploit privilege escalation, enabling the execution of arbitrary code with root user privileges. This weakness stems from the absence of proper sandboxing during the expansion and execution of Jinja2 templates, which may be included in certain configuration parameters. While the Mock documentation advises treating users added to the mock group as privileged, certain build systems invoking mock on behalf of users might inadvertently permit less privileged users to define configuration tags. These tags could then be passed as parameters to mock during execution, potentially leading to the utilization of Jinja2 templates for remote privilege escalation and the execution of arbitrary code as the root user on the build server.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-16T15:15:08.657",
    "last_modified": "2024-11-21T08:43:46.537",
    "fix_date": "2023-12-11T08:28:17Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/01/16/1",
      "source": "secalert@redhat.com",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/01/16/3",
      "source": "secalert@redhat.com",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2023-6395",
      "source": "secalert@redhat.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252206",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xsuchy/templated-dictionary/commit/bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69",
      "source": "secalert@redhat.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/62SP2BJC2AFLFJJAEHPGZ3ZINTBTI7AN/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NBFYREAJH4T7GXXQZ4GJEREN4Q3AHS3K/",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/01/16/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/01/16/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2023-6395",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2252206",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xsuchy/templated-dictionary/commit/0740bd0ca8d487301881541028977d120f8b8933",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xsuchy/templated-dictionary/commit/bcd90f0dafa365575c4b101e6f5d98c4ef4e4b69",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/62SP2BJC2AFLFJJAEHPGZ3ZINTBTI7AN/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NBFYREAJH4T7GXXQZ4GJEREN4Q3AHS3K/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.181116",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "templated-dictionary",
    "owner": "xsuchy",
    "created_at": "2020-11-18T16:40:35Z",
    "updated_at": "2024-09-17T05:18:01Z",
    "pushed_at": "2024-09-17T05:18:01Z",
    "size": 52,
    "stars": 5,
    "forks": 2,
    "open_issues": 2,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 4811
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T14:13:32.765036"
  }
}