{
  "cve_id": "CVE-2023-6980",
  "github_data": {
    "repository": "wp-sms/wp-sms",
    "fix_commit": "0f36e2f521ade8ddfb3e04786defe074370afb50",
    "related_commits": [
      "0f36e2f521ade8ddfb3e04786defe074370afb50",
      "0f36e2f521ade8ddfb3e04786defe074370afb50"
    ],
    "patch_url": "https://github.com/wp-sms/wp-sms/commit/0f36e2f521ade8ddfb3e04786defe074370afb50.patch",
    "fix_commit_details": {
      "sha": "0f36e2f521ade8ddfb3e04786defe074370afb50",
      "commit_date": "2023-12-23T13:28:59Z",
      "author": {
        "login": "ighorbani",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add nonce to delete subscriber action",
        "length": 37,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
      },
      "files": [
        {
          "filename": "includes/admin/subscribers/class-wpsms-subscribers-table.php",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -68,12 +68,13 @@ public function column_name($item)\n         /**\n          * Sanitize the input\n          */\n-        $page = sanitize_text_field($_REQUEST['page']);\n+        $page  = sanitize_text_field($_REQUEST['page']);\n+        $nonce = wp_create_nonce('wp_sms_subscriber');\n \n         //Build row actions\n         $actions = array(\n             'edit'   => sprintf('<a href=\"#\" onclick=\"wp_sms_edit_subscriber(%s)\">' . __('Edit', 'wp-sms') . '</a>', $item['ID']),\n-            'delete' => sprintf('<a href=\"?page=%s&action=%s&ID=%s\">' . __('Delete', 'wp-sms') . '</a>', $page, 'delete', $item['ID']),\n+            'delete' => sprintf('<a href=\"%s\">' . __('Delete', 'wp-sms') . '</a>', add_query_arg(array('page' => $page, 'action' => 'delete', 'ID' => $item['ID'], '_wpnonce' => $nonce), '')),\n         );\n \n         //Return the title contents\n@@ -192,6 +193,11 @@ public function process_bulk_action()\n \n         // Single delete action\n         if ('delete' == $current_action) {\n+            if (!wp_verify_nonce($_REQUEST['_wpnonce'], 'wp_sms_subscriber')) {\n+                \\WP_SMS\\Helper::flashNotice(__('Nonce check failed', 'wp-sms'), 'error', $this->adminUrl);\n+                exit;\n+            }\n+\n             $get_id = sanitize_text_field($_GET['ID']);\n             $this->db->delete($this->tb_prefix . \"sms_subscribes\", ['ID' => intval($get_id)], ['%d']);\n             $this->data  = $this->get_data();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ea1eda5ee625e91e88074ddbd59b2d3237411ea7",
            "date": "2024-12-23T09:11:52Z",
            "author_login": "mostafasoufi"
          },
          {
            "sha": "28d2753ed3d51bbf0f3f90143043efdbf356f538",
            "date": "2024-12-23T09:11:18Z",
            "author_login": "mostafasoufi"
          },
          {
            "sha": "7b717947b118fdb6e3cd26bdfc0bc1bbcb75b3fe",
            "date": "2024-12-23T06:37:39Z",
            "author_login": "mostafasoufi"
          },
          {
            "sha": "b81e5cc3d7d0b6c9c8d106f5eeae110a9fcc357f",
            "date": "2024-12-22T06:28:18Z",
            "author_login": "amirfallahii"
          },
          {
            "sha": "3f126ba64cef0f52a7816b9e03bae73a67b074b6",
            "date": "2024-12-19T04:23:56Z",
            "author_login": "mostafasoufi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "The WP SMS \u2013 Messaging & SMS Notification for WordPress, WooCommerce, GravityForms, etc plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 6.5. This is due to missing or incorrect nonce validation on the 'delete' action of the wp-sms-subscribers page. This makes it possible for unauthenticated attackers to delete subscribers via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-03T06:15:47.500",
    "last_modified": "2024-12-17T18:23:18.433",
    "fix_date": "2023-12-23T13:28:59Z"
  },
  "references": [
    {
      "url": "https://github.com/wp-sms/wp-sms/commit/0f36e2f521ade8ddfb3e04786defe074370afb50",
      "source": "security@wordfence.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3015006%40wp-sms&new=3015006%40wp-sms&sfp_email=&sfph_mail=",
      "source": "security@wordfence.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/94ad6b51-ff8d-48d5-9a70-1781d13990a5?source=cve",
      "source": "security@wordfence.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wp-sms/wp-sms/commit/0f36e2f521ade8ddfb3e04786defe074370afb50",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3015006%40wp-sms&new=3015006%40wp-sms&sfp_email=&sfph_mail=",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/94ad6b51-ff8d-48d5-9a70-1781d13990a5?source=cve",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.128192",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wp-sms",
    "owner": "wp-sms",
    "created_at": "2015-09-21T16:56:47Z",
    "updated_at": "2024-12-23T09:12:06Z",
    "pushed_at": "2025-01-11T21:42:45Z",
    "size": 36356,
    "stars": 91,
    "forks": 74,
    "open_issues": 8,
    "watchers": 91,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 2083185,
      "JavaScript": 240927,
      "SCSS": 203394,
      "CSS": 30343
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:17:15.808721"
  }
}