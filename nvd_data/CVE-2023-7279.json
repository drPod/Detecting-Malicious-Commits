{
  "cve_id": "CVE-2023-7279",
  "github_data": {
    "repository": "sse-secure-systems/connaisseur",
    "fix_commit": "524b73ff7306707f6d3a4d1e86401479bca91b02",
    "related_commits": [
      "524b73ff7306707f6d3a4d1e86401479bca91b02"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "524b73ff7306707f6d3a4d1e86401479bca91b02",
      "commit_date": "2023-11-22T09:39:36Z",
      "author": {
        "login": "Starkteetje",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "sec: Prevent ReDoS during delegation validation",
        "length": 682,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 54,
        "additions": 53,
        "deletions": 1
      },
      "files": [
        {
          "filename": "connaisseur/res/targets_schema.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -75,7 +75,7 @@\n                                     },\n                                     \"name\": {\n                                         \"type\": \"string\",\n-                                        \"pattern\": \"^targets/([a-z\\\\d][a-z\\\\d_-]*)+$\"\n+                                        \"pattern\": \"^targets/[a-z\\\\d][a-z\\\\d_-]*$\"\n                                     },\n                                     \"paths\": {\n                                         \"type\": \"array\","
        },
        {
          "filename": "docs/SECURITY.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -12,6 +12,7 @@ We stick to semantic versioning, so unless the major version changes, updating C\n | - | - | - | - |\n | initContainers not validated | <span>&#8804;</span> 1.3.0 | 1.3.1 | Prior to version 1.3.1 Connaisseur did not validate initContainers which allowed deploying unverified images to the cluster. |\n | Ephemeral containers not validated | <span>&#8804;</span> 3.1.1 | 3.2.0 | Prior to version 3.2.0 Connaisseur did not validate ephemeral containers (introduced in k8s 1.25) which allowed deploying unverified images to the cluster. |\n+| Regex Denial of Service for Notary delegations | <span>&#8804;</span> 3.3.0 | 3.3.1 | Prior to version 3.3.1 Connaisseur did input validation on the names of delegations in an unsafe manner: An adversary with the ability to alter Notary responses, in particular an evil Notary server, could have provided Connaisseur with an invalid delegation name that would lead to catastrophic backtracking during a regex matching. Only users of type `notaryv1` validators are affected as Connaisseur will only perform this kind of input validation in the context of a Notary validation. If you mistrust the Docker Notary server, the default configuration is vulnerable as it contains a `notaryv1` validator with the root keys of both Connaisseur and the library of official Docker images. |\n \n ## Reporting a vulnerability\n "
        },
        {
          "filename": "tests/data/trust_data/redos_targets.json",
          "status": "added",
          "additions": 45,
          "deletions": 0,
          "patch": "@@ -0,0 +1,45 @@\n+{\n+    \"signed\": {\n+        \"_type\": \"Targets\",\n+        \"delegations\": {\n+            \"keys\": {\n+                \"6984a67934a29955b3f969835c58ee0dd09158f5bec43726d319515b56b0a878\": {\n+                    \"keytype\": \"ecdsa\",\n+                    \"keyval\": {\n+                        \"private\": null,\n+                        \"public\": \"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEEchQNiJJt4PTaEeAzaztL+TQZqTa0iM0YSf+w0LjSElobVsYgnqIbCWe6pGX3UvcCngNw7N4uGkdVNVMS2Tslg==\"\n+                    }\n+                },\n+                \"70aa109003a93131c63499c70dcfc8db3ba33ca81bdd1abcd52c067a8acc0492\": {\n+                    \"keytype\": \"ecdsa\",\n+                    \"keyval\": {\n+                        \"private\": null,\n+                        \"public\": \"MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEM0xl8F5nwIV3IAru1Pf85WCo4cfTOQ91jhxVaQ3xHMeW430q7R4H/tJmAXUZBe+nOTX8pgtmrLpT+Hu/H7pUhw==\"\n+                    }\n+                }\n+            },\n+            \"roles\": [\n+                {\n+                    \"keyids\": [\n+                        \"70aa109003a93131c63499c70dcfc8db3ba33ca81bdd1abcd52c067a8acc0492\"\n+                    ],\n+                    \"name\": \"targets/abababababababababababababababababababababababababababababab*\",\n+                    \"paths\": [\n+                        \"\"\n+                    ],\n+                    \"threshold\": 1\n+                }\n+            ]\n+        },\n+        \"expires\": \"2023-01-12T16:55:17.056146761+01:00\",\n+        \"targets\": {},\n+        \"version\": 3\n+    },\n+    \"signatures\": [\n+        {\n+            \"keyid\": \"7c62922e6be165f1ea08252f77410152b9e4ec0d7bf4e69c1cc43f0e6c73da20\",\n+            \"method\": \"ecdsa\",\n+            \"sig\": \"ayUgIwW4LmtW+kuzHuyU7lkn8awoXlymBcXeO8j++JSAUpU3BSuFsBe7yx3SOOsxh57u+vWkCOzPdLEYVyQrqg==\"\n+        }\n+    ]\n+}"
        },
        {
          "filename": "tests/validators/notaryv1/test_trust_data.py",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -247,6 +247,12 @@\n         (fix.get_td(\"sample7_targets\"), \"targets\", \"TargetsData\", fix.no_exc()),\n         (fix.get_td(\"sample7_snapshot\"), \"snapshot\", \"SnapshotData\", fix.no_exc()),\n         (fix.get_td(\"missing_path\"), \"targets\", \"TargetsData\", fix.no_exc()),\n+        (\n+            fix.get_td(\"redos_targets\"),\n+            \"targets\",\n+            \"TargetsData\",\n+            pytest.raises(exc.InvalidTrustDataFormatError),\n+        ),\n     ],\n )\n def test_trust_data_init(m_trust_data, data: dict, role: str, class_: str, exception):"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "794403850993b445a15557f534b3966fdca8131b",
            "date": "2025-01-17T11:00:22Z",
            "author_login": "phbelitz"
          },
          {
            "sha": "9b1b972e134206d923d7952942ae1bd063b8fedb",
            "date": "2025-01-17T10:39:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "1f553852db756b9222861837795a5eefb3c1aae1",
            "date": "2025-01-17T10:25:08Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "22c1c5d49e4c1f67734d03fdc95ece3ff698cc13",
            "date": "2025-01-17T09:40:14Z",
            "author_login": "phbelitz"
          },
          {
            "sha": "515f2eca3dd8485709663705839dfb0c0756b048",
            "date": "2024-12-19T11:11:37Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.6,
    "cvss_vector": "CVSS:3.1/AV:A/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-1333",
    "description": "A vulnerability has been found in Secure Systems Engineering Connaisseur up to 3.3.0 and classified as problematic. This vulnerability affects unknown code of the file connaisseur/res/targets_schema.json of the component Delegation Name Handler. The manipulation leads to inefficient regular expression complexity. The complexity of an attack is rather high. The exploitation appears to be difficult. Upgrading to version 3.3.1 is able to address this issue. The name of the patch is 524b73ff7306707f6d3a4d1e86401479bca91b02. It is recommended to upgrade the affected component.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-09-02T18:15:21.393",
    "last_modified": "2024-11-01T14:43:56.227",
    "fix_date": "2023-11-22T09:39:36Z"
  },
  "references": [
    {
      "url": "https://github.com/sse-secure-systems/connaisseur/commit/524b73ff7306707f6d3a4d1e86401479bca91b02",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/sse-secure-systems/connaisseur/pull/1407",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/sse-secure-systems/connaisseur/releases/tag/v3.3.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.276268",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.276268",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.421102",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "connaisseur",
    "owner": "sse-secure-systems",
    "created_at": "2020-08-06T14:09:13Z",
    "updated_at": "2025-01-21T22:47:27Z",
    "pushed_at": "2025-01-24T16:07:40Z",
    "size": 31416,
    "stars": 445,
    "forks": 62,
    "open_issues": 36,
    "watchers": 445,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop",
      "master"
    ],
    "languages": {
      "Go": 345481,
      "Shell": 36578,
      "Python": 13554,
      "Smarty": 11710,
      "Makefile": 1907,
      "Dockerfile": 803
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:30:07.763341"
  }
}