{
  "cve_id": "CVE-2024-0435",
  "github_data": {
    "repository": "mintplex-labs/anything-llm",
    "fix_commit": "a4ace56a401ffc8ce0082d7444159dfd5dc28834",
    "related_commits": [
      "a4ace56a401ffc8ce0082d7444159dfd5dc28834",
      "a4ace56a401ffc8ce0082d7444159dfd5dc28834"
    ],
    "patch_url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834.patch",
    "fix_commit_details": {
      "sha": "a4ace56a401ffc8ce0082d7444159dfd5dc28834",
      "commit_date": "2024-01-11T17:57:59Z",
      "author": {
        "login": "timothycarambat",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Patch minor XSS opportunity where user can self-XSS themselves.  (#574)",
        "length": 202,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
      },
      "files": [
        {
          "filename": "frontend/package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -16,6 +16,7 @@\n     \"@microsoft/fetch-event-source\": \"^2.0.1\",\n     \"@phosphor-icons/react\": \"^2.0.13\",\n     \"buffer\": \"^6.0.3\",\n+    \"dompurify\": \"^3.0.8\",\n     \"he\": \"^1.2.0\",\n     \"highlight.js\": \"^11.9.0\",\n     \"lodash.debounce\": \"^4.0.8\","
        },
        {
          "filename": "frontend/src/components/WorkspaceChat/ChatContainer/ChatHistory/HistoricalMessage/index.jsx",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -6,6 +6,8 @@ import { userFromStorage } from \"@/utils/request\";\n import Citations from \"../Citation\";\n import { AI_BACKGROUND_COLOR, USER_BACKGROUND_COLOR } from \"@/utils/constants\";\n import { v4 } from \"uuid\";\n+import createDOMPurify from \"dompurify\";\n+const DOMPurify = createDOMPurify(window);\n \n const HistoricalMessage = forwardRef(\n   (\n@@ -45,7 +47,9 @@ const HistoricalMessage = forwardRef(\n             ) : (\n               <span\n                 className={`whitespace-pre-line text-white font-normal text-sm md:text-sm flex flex-col gap-y-1 mt-2`}\n-                dangerouslySetInnerHTML={{ __html: renderMarkdown(message) }}\n+                dangerouslySetInnerHTML={{\n+                  __html: DOMPurify.sanitize(renderMarkdown(message)),\n+                }}\n               />\n             )}\n           </div>"
        },
        {
          "filename": "frontend/yarn.lock",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -1021,6 +1021,11 @@ doctrine@^3.0.0:\n   dependencies:\n     esutils \"^2.0.2\"\n \n+dompurify@^3.0.8:\n+  version \"3.0.8\"\n+  resolved \"https://registry.yarnpkg.com/dompurify/-/dompurify-3.0.8.tgz#e0021ab1b09184bc8af7e35c7dd9063f43a8a437\"\n+  integrity sha512-b7uwreMYL2eZhrSCRC4ahLTeZcPZxSmYfmcQGXGkXiZSNW1X85v+SDM5KsWcpivIiUBH47Ji7NtyUdpLeF5JZQ==\n+\n electron-to-chromium@^1.4.535:\n   version \"1.4.576\"\n   resolved \"https://registry.yarnpkg.com/electron-to-chromium/-/electron-to-chromium-1.4.576.tgz#0c6940fdc0d60f7e34bd742b29d8fa847c9294d1\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4d5d8d4dec0e62662c8ec46537038353f45e0e66",
            "date": "2025-01-14T16:20:57Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "21af81085aeb049750942ac5f3b84775cb461693",
            "date": "2025-01-13T21:12:03Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "665e8e5bfe431ad93bed6736d0b450592617d042",
            "date": "2025-01-09T23:39:56Z",
            "author_login": "shatfield4"
          },
          {
            "sha": "865f7eea296e544b2eb1ab8c1f322208eaf5eb05",
            "date": "2025-01-09T21:32:54Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "be886f7d61296a30d5b8a095ca8329f58a0c5a0a",
            "date": "2025-01-09T01:21:30Z",
            "author_login": "root-reindeer-flotilla"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "User can send a chat that contains an XSS opportunity that will then run when the chat is sent and on subsequent page loads.\n\nGiven the minimum requirement for a user to send a chat is to be given access to a workspace via an admin the risk is low. Additionally, the location in which the XSS renders is only limited to the user who submits the XSS. \n\nUltimately, this attack is limited to the user attacking themselves. There is no anonymous chat submission unless the user does not take the minimum steps required to protect their instance.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-02-26T16:27:50.087",
    "last_modified": "2024-11-21T08:46:35.133",
    "fix_date": "2024-01-11T17:57:59Z"
  },
  "references": [
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/53308220-8b2e-492f-b248-0985b7c2db61",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/53308220-8b2e-492f-b248-0985b7c2db61",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.157571",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "anything-llm",
    "owner": "mintplex-labs",
    "created_at": "2023-06-04T02:29:14Z",
    "updated_at": "2025-01-14T13:49:57Z",
    "pushed_at": "2025-01-13T21:12:06Z",
    "size": 42916,
    "stars": 30237,
    "forks": 3030,
    "open_issues": 206,
    "watchers": 30237,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3056909,
      "CSS": 73785,
      "Dockerfile": 9030,
      "HTML": 3904,
      "Shell": 1382,
      "HCL": 1211
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:04:33.088245"
  }
}