{
  "cve_id": "CVE-2024-0551",
  "github_data": {
    "repository": "mintplex-labs/anything-llm",
    "fix_commit": "7aaa4b38e7112a6cd879c1238310c56b1844c6d8",
    "related_commits": [
      "7aaa4b38e7112a6cd879c1238310c56b1844c6d8",
      "7aaa4b38e7112a6cd879c1238310c56b1844c6d8"
    ],
    "patch_url": "https://github.com/mintplex-labs/anything-llm/commit/7aaa4b38e7112a6cd879c1238310c56b1844c6d8.patch",
    "fix_commit_details": {
      "sha": "7aaa4b38e7112a6cd879c1238310c56b1844c6d8",
      "commit_date": "2024-01-15T01:10:49Z",
      "author": {
        "login": "timothycarambat",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "add flex role to export endpoint",
        "length": 32,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 20,
        "additions": 12,
        "deletions": 8
      },
      "files": [
        {
          "filename": "server/endpoints/system.js",
          "status": "modified",
          "additions": 12,
          "deletions": 8,
          "patch": "@@ -389,15 +389,19 @@ function systemEndpoints(app) {\n     }\n   });\n \n-  app.get(\"/system/data-export\", [validatedRequest], async (_, response) => {\n-    try {\n-      const { filename, error } = await exportData();\n-      response.status(200).json({ filename, error });\n-    } catch (e) {\n-      console.log(e.message, e);\n-      response.sendStatus(500).end();\n+  app.get(\n+    \"/system/data-export\",\n+    [validatedRequest, flexUserRoleValid],\n+    async (_, response) => {\n+      try {\n+        const { filename, error } = await exportData();\n+        response.status(200).json({ filename, error });\n+      } catch (e) {\n+        console.log(e.message, e);\n+        response.sendStatus(500).end();\n+      }\n     }\n-  });\n+  );\n \n   app.get(\"/system/data-exports/:filename\", (request, response) => {\n     const exportLocation = __dirname + \"/../storage/exports/\";"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "21af81085aeb049750942ac5f3b84775cb461693",
            "date": "2025-01-13T21:12:03Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "665e8e5bfe431ad93bed6736d0b450592617d042",
            "date": "2025-01-09T23:39:56Z",
            "author_login": "shatfield4"
          },
          {
            "sha": "865f7eea296e544b2eb1ab8c1f322208eaf5eb05",
            "date": "2025-01-09T21:32:54Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "be886f7d61296a30d5b8a095ca8329f58a0c5a0a",
            "date": "2025-01-09T01:21:30Z",
            "author_login": "root-reindeer-flotilla"
          },
          {
            "sha": "487db896c1ce1442e02f7098ad6974ee60b76073",
            "date": "2025-01-07T23:53:34Z",
            "author_login": "timothycarambat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-284",
    "description": "Enable exports of the database and associated exported information of the system via the default user role. The attacked would have to have been granted access to the system prior to the attack.\n\nIt is worth noting that the deterministic nature of the export name is lower risk as the UI for exporting would start the download at the same time, which once downloaded - deletes the export from the system.\n\nThe endpoint for exporting should simply be patched to a higher privilege level.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-02-27T14:15:27.130",
    "last_modified": "2024-11-21T08:46:51.247",
    "fix_date": "2024-01-15T01:10:49Z"
  },
  "references": [
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/7aaa4b38e7112a6cd879c1238310c56b1844c6d8",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/f114c787-ab5f-4f83-afa5-c000435efb78",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/7aaa4b38e7112a6cd879c1238310c56b1844c6d8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/f114c787-ab5f-4f83-afa5-c000435efb78",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.166133",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "anything-llm",
    "owner": "mintplex-labs",
    "created_at": "2023-06-04T02:29:14Z",
    "updated_at": "2025-01-14T13:49:57Z",
    "pushed_at": "2025-01-13T21:12:06Z",
    "size": 42916,
    "stars": 30237,
    "forks": 3030,
    "open_issues": 206,
    "watchers": 30237,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3056909,
      "CSS": 73785,
      "Dockerfile": 9030,
      "HTML": 3904,
      "Shell": 1382,
      "HCL": 1211
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:04:33.088245"
  }
}