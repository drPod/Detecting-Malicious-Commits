{
  "cve_id": "CVE-2024-1109",
  "github_data": {
    "repository": "podlove/podlove-publisher",
    "fix_commit": "0ac83d1955aa964a358833b1b5ce790fff45b3f4",
    "related_commits": [
      "0ac83d1955aa964a358833b1b5ce790fff45b3f4",
      "0ac83d1955aa964a358833b1b5ce790fff45b3f4"
    ],
    "patch_url": "https://github.com/podlove/podlove-publisher/commit/0ac83d1955aa964a358833b1b5ce790fff45b3f4.patch",
    "fix_commit_details": {
      "sha": "0ac83d1955aa964a358833b1b5ce790fff45b3f4",
      "commit_date": "2024-02-04T20:15:41Z",
      "author": {
        "login": "eteubert",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: add missing capability check and nonce validation to exporter functions",
        "length": 76,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 50,
        "additions": 37,
        "deletions": 13
      },
      "files": [
        {
          "filename": "lib/modules/import_export/export/podcast_exporter.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -30,6 +30,14 @@ public static function init()\n         }\n \n         if (isset($_GET['podlove_export']) && $_GET['podlove_export']) {\n+            if (!current_user_can('administrator')) {\n+                return;\n+            }\n+\n+            if (!wp_verify_nonce($_REQUEST['_podlove_nonce'], 'podlove_export')) {\n+                return;\n+            }\n+\n             $exporter = new \\Podlove\\Modules\\ImportExport\\Export\\PodcastExporter();\n             $exporter->download();\n             exit;"
        },
        {
          "filename": "lib/modules/import_export/export/tracking_exporter.php",
          "status": "modified",
          "additions": 17,
          "deletions": 1,
          "patch": "@@ -19,6 +19,14 @@ public static function init_download()\n         }\n \n         if (isset($_GET['podlove_export_tracking']) && $_GET['podlove_export_tracking']) {\n+            if (!current_user_can('administrator')) {\n+                exit;\n+            }\n+\n+            if (!wp_verify_nonce($_REQUEST['_podlove_nonce'], 'podlove_export_tracking_download')) {\n+                exit;\n+            }\n+\n             delete_transient('podlove_tracking_export_finished');\n \n             header('Content-Type: application/octet-stream');\n@@ -43,9 +51,17 @@ public static function export_tracking()\n     {\n         global $wpdb;\n \n+        if (!current_user_can('administrator')) {\n+            exit;\n+        }\n+\n+        if (!wp_verify_nonce($_REQUEST['_podlove_nonce'], 'podlove_export_tracking')) {\n+            exit;\n+        }\n+\n         // only one export at a time\n         if (get_option('podlove_tracking_export_all') !== false) {\n-            return;\n+            exit;\n         }\n \n         update_option('podlove_tracking_export_all', $wpdb->get_var('SELECT COUNT(*) FROM '.\\Podlove\\Model\\DownloadIntent::table_name()));"
        },
        {
          "filename": "lib/modules/import_export/import_export.php",
          "status": "modified",
          "additions": 11,
          "deletions": 12,
          "patch": "@@ -123,7 +123,7 @@ public function tools_podcast_export()\n \t\t\t<li><?php echo __('In your new WordPress instance, import that file.', 'podlove-podcasting-plugin-for-wordpress'); ?></li>\n \t\t</ol>\n \n-\t\t<a href=\"?podlove_export=1\" class=\"button\"><?php echo __('Export Podcast Data', 'podlove-podcasting-plugin-for-wordpress'); ?></a>\n+\t\t<a href=\"?podlove_export=1&_podlove_nonce=<?php echo wp_create_nonce('podlove_export'); ?>\" class=\"button\"><?php echo __('Export Podcast Data', 'podlove-podcasting-plugin-for-wordpress'); ?></a>\n \t\t<?php\n     }\n \n@@ -168,12 +168,12 @@ public function tools_tracking_export()\n \t\t\t\t\t\t\t$(\"#podlove_tracking_export_status_wrapper\").show();\n \n \t\t\t\t\t\t\ttimeoutID = window.setTimeout(podlove_check_export_status, 1000);\n-\t\t\t\t\t\t} \n+\t\t\t\t\t\t}\n \n \t\t\t\t\t\tif (result.finished) {\n \t\t\t\t\t\t\t$(\"#podlove_tracking_export\").attr('disabled', false);\n \t\t\t\t\t\t\t$(\"#podlove_tracking_export_status_wrapper\").hide();\n-\t\t\t\t\t\t\twindow.location = window.location + \"&podlove_export_tracking=1\";\n+\t\t\t\t\t\t\twindow.location = window.location + \"&podlove_export_tracking=1&_podlove_nonce=<?php echo wp_create_nonce('podlove_export_tracking_download'); ?>\";\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n \t\t\t\t});\n@@ -187,20 +187,19 @@ public function tools_tracking_export()\n \n \t\t\t\t$.ajax({\n \t\t\t\t\turl: ajaxurl,\n-\t\t\t\t\tdata: {action: 'podlove-export-tracking'},\n-\t\t\t\t\tdataType: 'json',\n-\t\t\t\t\tsuccess: function(result) {\n+\t\t\t\t\tdata: {action: 'podlove-export-tracking', _podlove_nonce: '<?php echo wp_create_nonce('podlove_export_tracking'); ?>'},\n+\t\t\t\t\tdataType: 'json'\n+\t\t\t\t}).done(function(result) {\n \t\t\t\t\t\tconsole.log(\"tracking export finished\");\n-\t\t\t\t\t}\n+\t\t\t\t    window.setTimeout(podlove_check_export_status, 2000);\n \t\t\t\t});\n \n-\t\t\t\twindow.setTimeout(podlove_check_export_status, 2000);\n \t\t\t});\n \n \t\t\t// start immediately, in case the user refreshes the page\n \t\t\tpodlove_check_export_status();\n \t\t}(jQuery));\n-\t\t</script>\t\t\n+\t\t</script>\n \t\t<?php\n     }\n \n@@ -213,10 +212,10 @@ public function tools_podcast_import()\n \n \t\t<form method=\"POST\" enctype=\"multipart/form-data\">\n \t\t\t(<span><?php echo self::get_maximum_upload_size_text(); ?></span>)\n-\t\t\t<input type=\"file\" name=\"podlove_import\"/> \n+\t\t\t<input type=\"file\" name=\"podlove_import\"/>\n \t\t\t<input type=\"submit\" value=\"<?php echo __('Import Podcast Data', 'podlove-podcasting-plugin-for-wordpress'); ?>\" class=\"button\" />\n \t\t\t<?php wp_nonce_field('podlove_import', '_podlove_nonce'); ?>\n-\t\t</form>\t\t\n+\t\t</form>\n \t\t<?php\n     }\n \n@@ -228,7 +227,7 @@ public function tools_tracking_import()\n \t\t\t<input type=\"file\" name=\"podlove_import_tracking\"/>\n \t\t\t<input type=\"submit\" value=\"<?php echo __('Import Tracking Data', 'podlove-podcasting-plugin-for-wordpress'); ?>\" class=\"button\" />\n \t\t\t<?php wp_nonce_field('podlove_import_tracking', '_podlove_nonce'); ?>\n-\t\t</form>\t\t\n+\t\t</form>\n \t\t<?php\n     }\n "
        },
        {
          "filename": "readme.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -112,6 +112,7 @@ This product includes GeoLite2 data created by MaxMind, available from http://ww\n \n - fix SSRF vulnerability in Slacknotes module\n - add missing capability check and nonce validation to importer functions\n+- add missing capability check and nonce validation to exporter functions\n \n = 4.0.11 =\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "337662deda0c635b843d0260c475a30d634f5bc0",
            "date": "2025-01-05T05:19:12Z",
            "author_login": "eteubert"
          },
          {
            "sha": "b8634a979a197c51f708d4c41c4a1ddd5ee4f932",
            "date": "2025-01-01T06:29:41Z",
            "author_login": "eteubert"
          },
          {
            "sha": "21fad9b506e22263ab73b7c8fd1134bd679c1d58",
            "date": "2025-01-01T06:09:02Z",
            "author_login": "eteubert"
          },
          {
            "sha": "0dd3773a4d3e3f8b231f4090d609c263eb4e708c",
            "date": "2025-01-01T06:07:37Z",
            "author_login": "eteubert"
          },
          {
            "sha": "86a93092b0d54b2edb399a3116ea5ab38064332c",
            "date": "2024-12-29T22:04:40Z",
            "author_login": "dnkbln"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-862",
    "description": "The Podlove Podcast Publisher plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the init_download() and init() functions in all versions up to, and including, 4.0.11. This makes it possible for unauthenticated attackers to export the plugin's tracking data and podcast information.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-07T11:15:08.683",
    "last_modified": "2024-11-21T08:49:48.980",
    "fix_date": "2024-02-04T20:15:41Z"
  },
  "references": [
    {
      "url": "https://github.com/podlove/podlove-publisher/commit/0ac83d1955aa964a358833b1b5ce790fff45b3f4",
      "source": "security@wordfence.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3032008%40podlove-podcasting-plugin-for-wordpress&new=3032008%40podlove-podcasting-plugin-for-wordpress&sfp_email=&sfph_mail=",
      "source": "security@wordfence.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/a7b25b66-e9d1-448d-8367-cce4c0dec635?source=cve",
      "source": "security@wordfence.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/podlove/podlove-publisher/commit/0ac83d1955aa964a358833b1b5ce790fff45b3f4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3032008%40podlove-podcasting-plugin-for-wordpress&new=3032008%40podlove-podcasting-plugin-for-wordpress&sfp_email=&sfph_mail=",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/a7b25b66-e9d1-448d-8367-cce4c0dec635?source=cve",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.594574",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "podlove-publisher",
    "owner": "podlove",
    "created_at": "2013-02-19T21:21:57Z",
    "updated_at": "2025-01-10T02:37:39Z",
    "pushed_at": "2025-01-05T05:19:24Z",
    "size": 31932,
    "stars": 300,
    "forks": 84,
    "open_issues": 171,
    "watchers": 300,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "beta",
      "master"
    ],
    "languages": {
      "PHP": 1763626,
      "JavaScript": 639629,
      "Vue": 267206,
      "TypeScript": 147892,
      "CSS": 54317,
      "Twig": 28510,
      "Shell": 8103,
      "Makefile": 3335,
      "HTML": 3185,
      "Ruby": 749,
      "Dockerfile": 467
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:28:11.966932"
  }
}