{
  "cve_id": "CVE-2024-11193",
  "github_data": {
    "repository": "yugabyte/yugabyte-db",
    "fix_commit": "0bf6e5a3e9c0718a28e654483596615d0798b208",
    "related_commits": [
      "0bf6e5a3e9c0718a28e654483596615d0798b208"
    ],
    "patch_url": "https://github.com/yugabyte/yugabyte-db/commit/0bf6e5a3e9c0718a28e654483596615d0798b208.patch",
    "fix_commit_details": {
      "sha": "0bf6e5a3e9c0718a28e654483596615d0798b208",
      "commit_date": "2024-08-22T15:53:06Z",
      "author": {
        "login": "asharma-yb",
        "type": "User",
        "stats": {
          "total_commits": 188,
          "average_weekly_commits": 0.22143698468786807,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 88
        }
      },
      "commit_message": {
        "title": "[BACKPORT 2024.1][PLAT-13707] redact ysql_hba_conf_csv value from logs",
        "length": 527,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 50,
        "additions": 41,
        "deletions": 9
      },
      "files": [
        {
          "filename": "managed/src/main/java/com/yugabyte/yw/commissioner/TaskExecutor.java",
          "status": "modified",
          "additions": 12,
          "deletions": 5,
          "patch": "@@ -1017,9 +1017,9 @@ synchronized void updateTaskDetailsOnError(TaskInfo.State state, Throwable t) {\n           \"Task state must be one of \" + TaskInfo.ERROR_STATES);\n       taskInfo.refresh();\n       ObjectNode taskDetails = taskInfo.getDetails().deepCopy();\n-      // Method maskConfig does not modify the input as it makes a deep-copy.\n-      String maskedTaskDetails = CommonUtils.maskConfig(taskDetails).toString();\n       String errorString;\n+      // Method getRedactedParams does not modify the input as it makes a deep-copy.\n+      String redactedTaskParams = taskInfo.getRedactedParams().toString();\n       if (state == TaskInfo.State.Aborted && isShutdown.get()) {\n         errorString = \"Platform shutdown\";\n       } else {\n@@ -1032,14 +1032,14 @@ synchronized void updateTaskDetailsOnError(TaskInfo.State state, Throwable t) {\n         errorString =\n             String.format(\n                 \"Failed to execute task %s, hit error:\\n\\n %s.\",\n-                StringUtils.abbreviate(maskedTaskDetails, 500),\n+                StringUtils.abbreviate(redactedTaskParams, 500),\n                 StringUtils.abbreviateMiddle(cause.getMessage(), \"...\", 3000));\n       }\n       log.error(\n           \"Failed to execute task type {} UUID {} details {}, hit error.\",\n           taskInfo.getTaskType(),\n           taskInfo.getTaskUUID(),\n-          maskedTaskDetails,\n+          redactedTaskParams,\n           t);\n \n       if (log.isDebugEnabled()) {\n@@ -1330,7 +1330,14 @@ public void run() {\n             throw e;\n           }\n \n-          log.warn(\"Task {} attempt {} has failed\", getTask(), currentAttempt);\n+          String redactedParams =\n+              RedactingService.filterSecretFields(getTask().getTaskDetails(), RedactionTarget.LOGS)\n+                  .toString();\n+          log.warn(\n+              \"Task {} with params {} attempt {} has failed\",\n+              getTask().getName(),\n+              redactedParams,\n+              currentAttempt);\n           if (!getTask().onFailure(getTaskInfo(), e)) {\n             throw e;\n           }"
        },
        {
          "filename": "managed/src/main/java/com/yugabyte/yw/commissioner/tasks/upgrade/GFlagsUpgrade.java",
          "status": "modified",
          "additions": 28,
          "deletions": 4,
          "patch": "@@ -4,12 +4,15 @@\n \n import static play.mvc.Http.Status.BAD_REQUEST;\n \n+import com.fasterxml.jackson.databind.ObjectMapper;\n import com.yugabyte.yw.commissioner.BaseTaskDependencies;\n import com.yugabyte.yw.commissioner.ITask.Abortable;\n import com.yugabyte.yw.commissioner.ITask.Retryable;\n import com.yugabyte.yw.commissioner.UpgradeTaskBase;\n import com.yugabyte.yw.commissioner.UserTaskDetails.SubTaskGroupType;\n import com.yugabyte.yw.common.PlatformServiceException;\n+import com.yugabyte.yw.common.RedactingService;\n+import com.yugabyte.yw.common.RedactingService.RedactionTarget;\n import com.yugabyte.yw.common.XClusterUniverseService;\n import com.yugabyte.yw.common.config.UniverseConfKeys;\n import com.yugabyte.yw.common.gflags.GFlagsUtil;\n@@ -162,16 +165,37 @@ protected MastersAndTservers calculateNodesToBeRestarted() {\n           GFlagsUtil.getBaseGFlags(ServerType.MASTER, newCluster, newClusters.values());\n       Map<String, String> tserverGflags =\n           GFlagsUtil.getBaseGFlags(ServerType.TSERVER, newCluster, newClusters.values());\n+      ObjectMapper mapper = new ObjectMapper();\n+      String redactedMasterNewFlags =\n+          RedactingService.filterSecretFields(\n+                  mapper.valueToTree(masterGflags), RedactionTarget.LOGS)\n+              .toString();\n+      String redactedMasterOldFlags =\n+          RedactingService.filterSecretFields(\n+                  mapper.valueToTree(\n+                      GFlagsUtil.getBaseGFlags(ServerType.MASTER, curCluster, curClusters)),\n+                  RedactionTarget.LOGS)\n+              .toString();\n       log.debug(\n           \"Cluster {} master: new flags {} old flags {}\",\n           curCluster.clusterType,\n-          masterGflags,\n-          GFlagsUtil.getBaseGFlags(ServerType.MASTER, curCluster, curClusters));\n+          redactedMasterNewFlags,\n+          redactedMasterOldFlags);\n+      String redactedTsNewFlags =\n+          RedactingService.filterSecretFields(\n+                  mapper.valueToTree(tserverGflags), RedactionTarget.LOGS)\n+              .toString();\n+      String redactedTsOldFlags =\n+          RedactingService.filterSecretFields(\n+                  mapper.valueToTree(\n+                      GFlagsUtil.getBaseGFlags(ServerType.TSERVER, curCluster, curClusters)),\n+                  RedactionTarget.LOGS)\n+              .toString();\n       log.debug(\n           \"Cluster {} tserver: new flags {} old flags {}\",\n           curCluster.clusterType,\n-          tserverGflags,\n-          GFlagsUtil.getBaseGFlags(ServerType.TSERVER, curCluster, curClusters));\n+          redactedTsNewFlags,\n+          redactedTsOldFlags);\n \n       boolean changedByMasterFlags =\n           curCluster.clusterType == UniverseDefinitionTaskParams.ClusterType.PRIMARY"
        },
        {
          "filename": "managed/src/main/java/com/yugabyte/yw/common/RedactingService.java",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -92,6 +92,7 @@ public class RedactingService {\n           // LDAP - DB Universe Sync\n           .add(\"$..dbuserPassword\")\n           .add(\"$..ldapBindPassword\")\n+          .add(\"$..ysql_hba_conf_csv\")\n           .build();\n \n   // List of json paths to any secret fields we want to redact."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8dfc9a551eab32fa0374fc6140322dd75b1ce2c4",
            "date": "2025-01-14T21:06:59Z",
            "author_login": "timothy-e"
          },
          {
            "sha": "6218febcd13bf2a820cc0f9f48f32d59d753f0f0",
            "date": "2025-01-14T20:19:33Z",
            "author_login": "timothy-e"
          },
          {
            "sha": "ded9b1c3380089c9b330862ac274939d4f187e65",
            "date": "2025-01-14T18:26:02Z",
            "author_login": "timothy-e"
          },
          {
            "sha": "a5efcb9b27fb577e32b7ed0ad7c13dc3d1045417",
            "date": "2025-01-14T18:24:54Z",
            "author_login": "timothy-e"
          },
          {
            "sha": "2febce65186a83b35c532a90303c4994d5108ae3",
            "date": "2025-01-13T19:26:45Z",
            "author_login": "Sahith02"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-532",
    "description": "An information disclosure vulnerability exists in Yugabyte Anywhere, where the LDAP bind password is logged in plaintext within application logs. This flaw results in the unintentional exposure of sensitive information in Yugabyte Anywhere logs, potentially allowing unauthorized users with access to these logs to view the LDAP bind password.\u00a0An attacker with log access could exploit this vulnerability to gain unauthorized access to the LDAP server, leading to potential exposure or compromise of LDAP-managed resources\nThis issue affects YugabyteDB Anywhere: from 2.20.0.0 before 2.20.7.0, from 2.23.0.0 before 2.23.1.0, from 2024.1.0.0 before 2024.1.3.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-13T21:15:08.730",
    "last_modified": "2024-11-15T14:00:09.720",
    "fix_date": "2024-08-22T15:53:06Z"
  },
  "references": [
    {
      "url": "https://github.com/yugabyte/yugabyte-db/commit/0bf6e5a3e9c0718a28e654483596615d0798b208",
      "source": "security@yugabyte.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.293322",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "yugabyte-db",
    "owner": "yugabyte",
    "created_at": "2017-10-05T21:56:00Z",
    "updated_at": "2025-01-14T11:02:52Z",
    "pushed_at": "2025-01-14T13:08:33Z",
    "size": 785267,
    "stars": 9154,
    "forks": 1096,
    "open_issues": 6564,
    "watchers": 9154,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "2.14-PLAT-9385",
      "2.14",
      "2.14.0",
      "2.14.0.0-b94-and-session-id-to-transaction-id-linkage",
      "2.14.0.0-b94-session-id-to-transaction-id-linkage",
      "2.14.0.0-b94-with-session-id-to-transaction-id-linkage",
      "2.14.2",
      "2.14.3",
      "2.14.5",
      "2.14.6",
      "2.14.9",
      "2.14.10",
      "2.14.10.2",
      "2.14.11",
      "2.14.13",
      "2.16",
      "2.16.0",
      "2.16.0.5001",
      "2.16.0.5002",
      "2.16.1",
      "2.16.2",
      "2.16.3",
      "2.16.5",
      "2.16.5.7018",
      "2.16.6",
      "2.16.7",
      "2.16.8",
      "2.18",
      "2.18.0",
      "2.18.0.1000"
    ],
    "languages": {
      "C": 49017240,
      "C++": 40553135,
      "Java": 24628925,
      "PLpgSQL": 18030832,
      "TypeScript": 6033835,
      "Python": 3151385,
      "Go": 2421482,
      "Perl": 2002906,
      "JavaScript": 1945698,
      "Shell": 1036617,
      "Yacc": 956295,
      "Makefile": 419246,
      "CMake": 362029,
      "SCSS": 327855,
      "Mermaid": 276977,
      "Lex": 254480,
      "Jupyter Notebook": 192984,
      "M4": 192961,
      "Ruby": 175500,
      "Scala": 84823,
      "XSLT": 71494,
      "PLSQL": 71391,
      "Jinja": 64070,
      "HTML": 42134,
      "Mustache": 20922,
      "Dockerfile": 18213,
      "Batchfile": 15477,
      "CSS": 11501,
      "XS": 7034,
      "PHP": 5378,
      "Emacs Lisp": 4164,
      "DTrace": 3451,
      "Assembly": 3266,
      "Roff": 1895,
      "sed": 1253,
      "Meson": 1240,
      "Smarty": 138,
      "TeX": 26
    },
    "commit_activity": {
      "total_commits_last_year": 7506,
      "avg_commits_per_week": 144.34615384615384,
      "days_active_last_year": 341
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:35:15.967707"
  }
}