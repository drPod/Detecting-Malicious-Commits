{
  "cve_id": "CVE-2024-11319",
  "github_data": {
    "repository": "django-cms/django-cms",
    "fix_commit": "241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3",
    "related_commits": [
      "241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3"
    ],
    "patch_url": "https://github.com/django-cms/django-cms/commit/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3.patch",
    "fix_commit_details": {
      "sha": "241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3",
      "commit_date": "2024-11-12T07:03:23Z",
      "author": {
        "login": "fsbraun",
        "type": "User",
        "stats": {
          "total_commits": 264,
          "average_weekly_commits": 0.32,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 80
        }
      },
      "commit_message": {
        "title": "fix: XSS vulnerability for page title (#8075)",
        "length": 179,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 10,
        "deletions": 9
      },
      "files": [
        {
          "filename": "cms/api.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -136,7 +136,7 @@ def create_page(title, template, language, menu_title=None, slug=None,\n                 xframe_options=constants.X_FRAME_OPTIONS_INHERIT):\n     \"\"\"\n     Creates a :class:`cms.models.Page` instance and returns it. Also\n-    creates a :class:`cms.models.Title` instance for the specified\n+    creates a :class:`cms.models.PageContent` instance for the specified\n     language.\n \n     .. warning::"
        },
        {
          "filename": "cms/templatetags/cms_tags.py",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -441,9 +441,7 @@ def get_value(self, context, name, page_lookup):\n         if page and name in self.valid_attributes:\n             func = getattr(page, \"get_%s\" % name)\n             ret_val = func(language=lang, fallback=True)\n-            if name == 'page_title':\n-                 ret_val = strip_tags(ret_val)\n-            elif not isinstance(ret_val, datetime):\n+            if not isinstance(ret_val, datetime):\n                 ret_val = escape(ret_val)\n             return ret_val\n         return ''"
        },
        {
          "filename": "cms/tests/test_templatetags.py",
          "status": "modified",
          "additions": 8,
          "deletions": 5,
          "patch": "@@ -11,11 +11,10 @@\n from django.test import RequestFactory\n from django.test.utils import override_settings\n from django.utils.encoding import force_str\n-from django.utils.html import strip_tags\n+from django.utils.html import escape\n from django.utils.timezone import now\n from django.utils.translation import override as force_language\n from djangocms_text_ckeditor.cms_plugins import TextPlugin\n-from djangocms_text_ckeditor.models import Text\n from sekizai.context import SekizaiContext\n \n import cms\n@@ -139,6 +138,7 @@ def test_unicode_placeholder_name_fails_fast(self):\n     def test_page_attribute_tag_escapes_content(self):\n         script = '<script>alert(\"XSS\");</script>'\n         ampersand = 'Q&A page'\n+        partial = '\"><img src=x onerror=alert(1) \"'\n \n         class FakePage:\n             def __init__(self, title):\n@@ -159,11 +159,14 @@ def __init__(self, page):\n         template = '{% load cms_tags %}{% page_attribute page_title %}'\n         output_script = self.render_template_obj(template, {}, request_script)\n         output_ampersand = self.render_template_obj(template, {}, request_ampersand)\n+        output_partial = self.render_template_obj(template, {}, FakeRequest(FakePage(partial)))\n \n         self.assertNotEqual(script, output_script)\n-        self.assertEqual(ampersand, output_ampersand)\n-        self.assertEqual(strip_tags(script), output_script)\n-        self.assertEqual(strip_tags(ampersand), output_ampersand)\n+        self.assertNotEqual(ampersand, output_ampersand)\n+        self.assertNotEqual(partial, output_partial)\n+        self.assertEqual(escape(script), output_script)\n+        self.assertEqual(escape(ampersand), output_ampersand)\n+        self.assertEqual(escape(partial), output_partial)\n \n     def test_json_encoder(self):\n         self.assertEqual(json_filter(True), 'true')"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec268c7b2d265b4a8d06a2a9027f41bbe54c27be",
            "date": "2025-01-07T06:49:24Z",
            "author_login": "fsbraun"
          },
          {
            "sha": "4361f0a7553dbd0c3d0aefc72def00fa0531dbb5",
            "date": "2024-12-13T13:13:22Z",
            "author_login": "fsbraun"
          },
          {
            "sha": "840a909991d5cd94eb8353cf7305612d1dec99c1",
            "date": "2024-12-13T07:32:56Z",
            "author_login": "fsbraun"
          },
          {
            "sha": "f2c367ddc7b1f5a761084be062aa353b35b65a78",
            "date": "2024-12-13T06:33:40Z",
            "author_login": "fsbraun"
          },
          {
            "sha": "3f8fcb5fb63b154ed38377c84908e00ec9535f4e",
            "date": "2024-12-09T16:43:55Z",
            "author_login": "fsbraun"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Improper Neutralization of Input During Web Page Generation (XSS or 'Cross-site Scripting') vulnerability in django CMS Association django-cms allows Cross-Site Scripting (XSS).This issue affects django-cms: 3.11.7, 3.11.8, 4.1.2, 4.1.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-18T12:15:17.853",
    "last_modified": "2024-11-21T08:49:31.873",
    "fix_date": "2024-11-12T07:03:23Z"
  },
  "references": [
    {
      "url": "https://github.com/django-cms/django-cms/commit/241d1cbe47a68f5d271ce4d27ad5e32e2c360ec3",
      "source": "iletisim@usom.gov.tr",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://iltosec.com/blog/post/django-cms-413-stored-xss-vulnerability-exploiting-the-page-title-field/",
      "source": "iletisim@usom.gov.tr",
      "tags": [
        "Exploit"
      ]
    },
    {
      "url": "https://www.django-cms.org/en/blog/2024/11/13/django-cms-security-update/",
      "source": "iletisim@usom.gov.tr",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.usom.gov.tr/bildirim/tr-24-1859",
      "source": "iletisim@usom.gov.tr",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.260086",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "django-cms",
    "owner": "django-cms",
    "created_at": "2009-03-05T10:14:18Z",
    "updated_at": "2025-01-13T22:39:12Z",
    "pushed_at": "2025-01-10T10:06:33Z",
    "size": 108391,
    "stars": 10296,
    "forks": 3127,
    "open_issues": 131,
    "watchers": 10296,
    "has_security_policy": false,
    "default_branch": "develop-4",
    "protected_branches": [
      "develop",
      "develop-4",
      "release/build",
      "release/0.10.x",
      "release/2.1.x",
      "release/2.2.x",
      "release/2.3.x",
      "release/2.4.x",
      "release/3.0.x",
      "release/3.1.x",
      "release/3.2.x",
      "release/3.3.x",
      "release/3.4.x",
      "release/3.5.x",
      "release/3.6.x",
      "release/3.7.x",
      "release/3.8.x",
      "release/3.9.x",
      "release/3.10.x",
      "release/3.11.x",
      "release/4.0.x",
      "release/4.0.0.x",
      "release/4.0.1.x",
      "release/4.1.x"
    ],
    "languages": {
      "Python": 2478484,
      "JavaScript": 1235198,
      "HTML": 209703,
      "SCSS": 154613,
      "Shell": 21712
    },
    "commit_activity": {
      "total_commits_last_year": 227,
      "avg_commits_per_week": 4.365384615384615,
      "days_active_last_year": 108
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T14:07:30.607480"
  }
}