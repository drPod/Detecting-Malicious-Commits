{
  "cve_id": "CVE-2024-12894",
  "github_data": {
    "repository": "TreasureHuntGame/TreasureHunt",
    "fix_commit": "8bcc649abc35b7734951be084bb522a532faac4e",
    "related_commits": [
      "8bcc649abc35b7734951be084bb522a532faac4e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8bcc649abc35b7734951be084bb522a532faac4e",
      "commit_date": "2024-05-10T18:24:42Z",
      "author": {
        "login": "JotaEspig",
        "type": "User",
        "stats": {
          "total_commits": 40,
          "average_weekly_commits": 0.10840108401084012,
          "total_additions": 953,
          "total_deletions": 235,
          "weeks_active": 16
        }
      },
      "commit_message": {
        "title": "fix(acesso.php e checkflag.php): SQL Injection",
        "length": 46,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "TreasureHunt/acesso.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -4,7 +4,7 @@\n require_once 'conexao.php';\r\n \r\n // filtrar input do id de usu\u00e1rio\r\n-$usuario = filter_input(INPUT_POST, 'usuario');\r\n+$usuario = filter_input(INPUT_POST, 'usuario', FILTER_SANITIZE_NUMBER_INT);\r\n // \"montar\" comando sql, prepar\u00e1-lo, inserir vari\u00e1veis e executar\r\n //$sql = \"SELECT * FROM Usuario where id='$usuario'\";\r\n $sql = \"SELECT * FROM Usuario where id=:usuario\";\r\n@@ -52,4 +52,4 @@\n }\r\n else { // se o primeiro select n\u00e3o retornou us\u00e1rio \u00e9 porque o id est\u00e1 incorreto\r\n \theader('Location:index.php?message=user_error');\r\n-}\n\\ No newline at end of file\n+}\r"
        },
        {
          "filename": "TreasureHunt/checkflag.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -16,7 +16,7 @@ function console_log($data) {\n \techo '</script>';\r\n }\r\n \r\n-$problema = filter_input(INPUT_POST, 'problema');\r\n+$problema = filter_input(INPUT_POST, 'problema', FILTER_SANITIZE_NUMBER_INT);\r\n $flagPura = filter_input(INPUT_POST, 'flag');\r\n $flagSemEspaco = preg_replace('/\\s/', '', $flagPura);\r\n $flagSemEspaco = str_replace('\\t', '', $flagSemEspaco);\r\n@@ -136,4 +136,4 @@ function atualiza($resposta, $usuario, $problema) {\n ?>\r\n <script>\r\n \twindow.setTimeout(\"location.href='home.php';\");\r\n-</script>\n\\ No newline at end of file\n+</script>\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6750b27ce441a1a978a1e3103b134349a23aa7d3",
            "date": "2024-12-07T02:23:06Z",
            "author_login": "TreasureHuntGame"
          },
          {
            "sha": "f692e78faec9da6bd4ef33400bb2923726490442",
            "date": "2024-12-07T02:21:03Z",
            "author_login": "TreasureHuntGame"
          },
          {
            "sha": "528bf44fe97bcf03525675950ccbb732a48975d4",
            "date": "2024-12-02T04:59:12Z",
            "author_login": "TreasureHuntGame"
          },
          {
            "sha": "d0262b3f9d7c67879c7a9c37a4fe69e19b514b1d",
            "date": "2024-12-02T04:58:51Z",
            "author_login": "TreasureHuntGame"
          },
          {
            "sha": "faafc13e1d5657be358567ba9f3c4eec5132b0c6",
            "date": "2024-12-02T04:58:30Z",
            "author_login": "TreasureHuntGame"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-74",
    "description": "A vulnerability, which was classified as critical, was found in TreasureHuntGame TreasureHunt up to 963e0e0. Affected is an unknown function of the file TreasureHunt/acesso.php. The manipulation of the argument usuario leads to sql injection. It is possible to launch the attack remotely. This product is using a rolling release to provide continious delivery. Therefore, no version details for affected nor updated releases are available. The name of the patch is 8bcc649abc35b7734951be084bb522a532faac4e. It is recommended to apply a patch to fix this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-12-22T12:15:16.203",
    "last_modified": "2025-01-10T21:12:49.420",
    "fix_date": "2024-05-10T18:24:42Z"
  },
  "references": [
    {
      "url": "https://github.com/TreasureHuntGame/TreasureHunt/commit/8bcc649abc35b7734951be084bb522a532faac4e",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.289164",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.289164",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:52.901988",
    "processing_status": "enhanced"
  }
}