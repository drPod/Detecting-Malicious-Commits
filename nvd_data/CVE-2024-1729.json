{
  "cve_id": "CVE-2024-1729",
  "github_data": {
    "repository": "gradio-app/gradio",
    "fix_commit": "e329f1fd38935213fe0e73962e8cbd5d3af6e87b",
    "related_commits": [
      "e329f1fd38935213fe0e73962e8cbd5d3af6e87b",
      "e329f1fd38935213fe0e73962e8cbd5d3af6e87b"
    ],
    "patch_url": "https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b.patch",
    "fix_commit_details": {
      "sha": "e329f1fd38935213fe0e73962e8cbd5d3af6e87b",
      "commit_date": "2024-02-15T20:59:08Z",
      "author": {
        "login": "abidlabs",
        "type": "User",
        "stats": {
          "total_commits": 1635,
          "average_weekly_commits": 4.9395770392749245,
          "total_additions": 1452697,
          "total_deletions": 2127253,
          "weeks_active": 151
        }
      },
      "commit_message": {
        "title": "Prevent timing attacks to guess Gradio passwords (#7440)",
        "length": 210,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 26,
        "deletions": 3
      },
      "files": [
        {
          "filename": ".changeset/fine-pets-switch.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+\"gradio\": patch\n+---\n+\n+feat:Prevent timing attacks to guess Gradio passwords"
        },
        {
          "filename": "gradio/route_utils.py",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -1,6 +1,7 @@\n from __future__ import annotations\n \n import hashlib\n+import hmac\n import json\n import shutil\n from collections import deque\n@@ -569,8 +570,12 @@ def update_root_in_config(config: dict, root: str) -> dict:\n     root url has changed, all of the urls in the config that correspond to component\n     file urls are updated to use the new root url.\n     \"\"\"\n-    previous_root = config.get(\"root\", None)\n+    previous_root = config.get(\"root\")\n     if previous_root is None or previous_root != root:\n         config[\"root\"] = root\n         config = processing_utils.add_root_url(config, root, previous_root)\n     return config\n+\n+\n+def compare_passwords_securely(input_password: str, correct_password: str) -> bool:\n+    return hmac.compare_digest(input_password.encode(), correct_password.encode())"
        },
        {
          "filename": "gradio/routes.py",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -63,6 +63,7 @@\n     GradioUploadFile,\n     MultiPartException,\n     Request,\n+    compare_passwords_securely,\n     move_uploaded_files_to_cache,\n )\n from gradio.state_holder import StateHolder\n@@ -271,7 +272,7 @@ def login(form_data: OAuth2PasswordRequestForm = Depends()):\n             if (\n                 not callable(app.auth)\n                 and username in app.auth\n-                and app.auth[username] == password\n+                and compare_passwords_securely(password, app.auth[username])  # type: ignore\n             ) or (callable(app.auth) and app.auth.__call__(username, password)):\n                 token = secrets.token_urlsafe(16)\n                 app.tokens[token] = username"
        },
        {
          "filename": "test/test_routes.py",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -25,7 +25,11 @@\n     routes,\n     wasm_utils,\n )\n-from gradio.route_utils import FnIndexInferError, get_root_url\n+from gradio.route_utils import (\n+    FnIndexInferError,\n+    compare_passwords_securely,\n+    get_root_url,\n+)\n \n \n @pytest.fixture()\n@@ -921,3 +925,11 @@ def test_component_server_endpoints(connect):\n def test_get_root_url(request_url, route_path, root_path, expected_root_url):\n     request = Request({\"path\": request_url, \"type\": \"http\", \"headers\": {}})\n     assert get_root_url(request, route_path, root_path) == expected_root_url\n+\n+\n+def test_compare_passwords_securely():\n+    password1 = \"password\"\n+    password2 = \"p\u00e4ssword\"\n+    assert compare_passwords_securely(password1, password1)\n+    assert not compare_passwords_securely(password1, password2)\n+    assert compare_passwords_securely(password2, password2)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a91cb9c42c02b70273b4cd55ab18148a7436fe57",
            "date": "2025-01-13T19:14:27Z",
            "author_login": "amanchauhan11"
          },
          {
            "sha": "7fa9b6fc97b90a4c0d07cbf066b810247fc84724",
            "date": "2025-01-10T20:39:10Z",
            "author_login": "gradio-pr-bot"
          },
          {
            "sha": "e742dcccb376692c9ddd5a6c251080e7c5936574",
            "date": "2025-01-10T19:46:57Z",
            "author_login": "aliabid94"
          },
          {
            "sha": "decb5944552e951525c283e069e116c1ff6b6807",
            "date": "2025-01-10T18:28:16Z",
            "author_login": "abidlabs"
          },
          {
            "sha": "343503d62eabab7af1a8a524d16a8e076a75dd67",
            "date": "2025-01-10T18:14:58Z",
            "author_login": "abidlabs"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-367",
    "description": "A timing attack vulnerability exists in the gradio-app/gradio repository, specifically within the login function in routes.py. The vulnerability arises from the use of a direct comparison operation (`app.auth[username] == password`) to validate user credentials, which can be exploited to guess passwords based on response times. Successful exploitation of this vulnerability could allow an attacker to bypass authentication mechanisms and gain unauthorized access.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-03-29T05:15:45.477",
    "last_modified": "2024-11-21T08:51:10.860",
    "fix_date": "2024-02-15T20:59:08Z"
  },
  "references": [
    {
      "url": "https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/f6a10a8d-f538-4cb7-9bb2-85d9f5708124",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/f6a10a8d-f538-4cb7-9bb2-85d9f5708124",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.927295",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gradio",
    "owner": "gradio-app",
    "created_at": "2018-12-19T08:24:04Z",
    "updated_at": "2025-01-14T14:42:12Z",
    "pushed_at": "2025-01-14T12:42:39Z",
    "size": 280474,
    "stars": 35207,
    "forks": 2655,
    "open_issues": 470,
    "watchers": 35207,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 3114195,
      "Svelte": 1181173,
      "TypeScript": 956766,
      "JavaScript": 60749,
      "CSS": 51082,
      "Jupyter Notebook": 32113,
      "HTML": 22988,
      "Batchfile": 6463,
      "Shell": 6049,
      "MDX": 1670
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:07:33.405924"
  }
}