{
  "cve_id": "CVE-2024-21488",
  "github_data": {
    "repository": "tomas/network",
    "fix_commit": "5599ed6d6ff1571a5ccadea775430c131f381de7",
    "related_commits": [
      "5599ed6d6ff1571a5ccadea775430c131f381de7",
      "6ec8713580938ab4666df2f2d0f3399891ed2ad7",
      "72c523265940fe279eb0050d441522628f8988e5",
      "5599ed6d6ff1571a5ccadea775430c131f381de7",
      "6ec8713580938ab4666df2f2d0f3399891ed2ad7",
      "72c523265940fe279eb0050d441522628f8988e5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5599ed6d6ff1571a5ccadea775430c131f381de7",
      "commit_date": "2024-01-24T01:30:44Z",
      "author": {
        "login": "tomas",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Validate nic name under linux",
        "length": 29,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 14,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/linux.js",
          "status": "modified",
          "additions": 14,
          "deletions": 1,
          "patch": "@@ -13,12 +13,21 @@ function trim_exec(cmd, cb) {\n   })\n }\n \n+function ensure_valid_nic(str) {\n+  if (str.match(/[^\\w]/))\n+    throw new Error(\"Invalid nic name given: \" + str);\n+}\n+\n // If no wifi, then there is no error but cbed get's a null in second param.\n exports.get_active_network_interface_name = function(cb) {\n   var cmd = \"netstat -rn | grep UG | awk '{print $NF}'\";\n-  exec(cmd, function(err, stdout) {\n+  exec(cmd, function(err, stdout, stderr) {\n     if (err) return cb(err);\n \n+    if (stderr.toString().match('not found')) {\n+      return cb(new Error('Command failed: ' + stderr.toString().trim()))\n+    }\n+\n     var raw = stdout.toString().trim().split('\\n');\n     if (raw.length === 0 || raw === [''])\n       return cb(new Error('No active network interface found.'));\n@@ -28,21 +37,25 @@ exports.get_active_network_interface_name = function(cb) {\n };\n \n exports.interface_type_for = function(nic_name, cb) {\n+  ensure_valid_nic(nic_name);\n   exec('cat /proc/net/wireless | grep ' + nic_name, function(err, out) {\n     return cb(null, err ? 'Wired' : 'Wireless')\n   })\n };\n \n exports.mac_address_for = function(nic_name, cb) {\n+  ensure_valid_nic(nic_name);\n   var cmd = 'cat /sys/class/net/' + nic_name + '/address';\n   trim_exec(cmd, cb);\n };\n \n exports.gateway_ip_for = function(nic_name, cb) {\n+  ensure_valid_nic(nic_name);\n   trim_exec(\"ip r | grep \" + nic_name + \" | grep default | cut -d ' ' -f 3 | head -n1\", cb);\n };\n \n exports.netmask_for = function(nic_name, cb) {\n+  ensure_valid_nic(nic_name);\n   var cmd = \"ifconfig \" + nic_name + \" 2> /dev/null | egrep 'netmask|Mask:' | awk '{print $4}' | sed 's/Mask://'\";\n   trim_exec(cmd, cb);\n };"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "72c523265940fe279eb0050d441522628f8988e5",
            "date": "2024-01-24T01:32:25Z",
            "author_login": "tomas"
          },
          {
            "sha": "6ec8713580938ab4666df2f2d0f3399891ed2ad7",
            "date": "2024-01-24T01:32:17Z",
            "author_login": "tomas"
          },
          {
            "sha": "5599ed6d6ff1571a5ccadea775430c131f381de7",
            "date": "2024-01-24T01:30:44Z",
            "author_login": "tomas"
          },
          {
            "sha": "4a19ccd252174bc042bcb9b4ef78e6d1d321c042",
            "date": "2021-12-31T23:24:56Z",
            "author_login": "tomas"
          },
          {
            "sha": "bec46a7915e9019ea2b64e1b692b5b6a7ca6d775",
            "date": "2021-12-31T23:24:51Z",
            "author_login": "tomas"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-77",
    "description": "Versions of the package network before 0.7.0 are vulnerable to Arbitrary Command Injection due to use of the child_process exec function without input sanitization. If (attacker-controlled) user input is given to the mac_address_for function of the package, it is possible for the attacker to execute arbitrary commands on the operating system that this package is being run on.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-30T05:15:09.277",
    "last_modified": "2024-11-21T08:54:32.133",
    "fix_date": "2024-01-24T01:30:44Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/icemonster/282ab98fb68fc22aac7c576538f6369c",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tomas/network/commit/5599ed6d6ff1571a5ccadea775430c131f381de7",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tomas/network/commit/6ec8713580938ab4666df2f2d0f3399891ed2ad7",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tomas/network/commit/72c523265940fe279eb0050d441522628f8988e5",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-NETWORK-6184371",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://gist.github.com/icemonster/282ab98fb68fc22aac7c576538f6369c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tomas/network/commit/5599ed6d6ff1571a5ccadea775430c131f381de7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tomas/network/commit/6ec8713580938ab4666df2f2d0f3399891ed2ad7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/tomas/network/commit/72c523265940fe279eb0050d441522628f8988e5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-NETWORK-6184371",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.545866",
    "processing_status": "enhanced"
  }
}