{
  "cve_id": "CVE-2024-21502",
  "github_data": {
    "repository": "AntonKueltz/fastecdsa",
    "fix_commit": "57fc5689c95d649dab7ef60cc99ac64589f01e36",
    "related_commits": [
      "57fc5689c95d649dab7ef60cc99ac64589f01e36",
      "57fc5689c95d649dab7ef60cc99ac64589f01e36"
    ],
    "patch_url": "https://github.com/AntonKueltz/fastecdsa/commit/57fc5689c95d649dab7ef60cc99ac64589f01e36.patch",
    "fix_commit_details": {
      "sha": "57fc5689c95d649dab7ef60cc99ac64589f01e36",
      "commit_date": "2024-02-22T19:26:28Z",
      "author": {
        "login": "AntonKueltz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix memory corruption issue",
        "length": 319,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
      },
      "files": [
        {
          "filename": "pyproject.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -19,6 +19,7 @@ classifiers = [\n     \"Programming Language :: Python :: 3.9\",\n     \"Programming Language :: Python :: 3.10\",\n     \"Programming Language :: Python :: 3.11\",\n+    \"Programming Language :: Python :: 3.12\",\n     \"Operating System :: MacOS :: MacOS X\",\n     \"Operating System :: POSIX :: Linux\"\n ]"
        },
        {
          "filename": "src/curveMath.c",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -215,6 +215,7 @@ static PyObject * curvemath_mul(PyObject *self, PyObject *args) {\n     }\n \n     PointZZ_p result;\n+    mpz_inits(result.x, result.y, NULL);\n     mpz_t scalar;\n     mpz_init_set_str(scalar, d, 10);\n     CurveZZ_p * curve = buildCurveZZ_p(p, a, b, q, gx, gy, 10);;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2fa1177f1a14573d097601255d6d97aabbecce97",
            "date": "2025-01-01T16:49:28Z",
            "author_login": "AntonKueltz"
          },
          {
            "sha": "2bb92300c3070a631236f3bbf657ef48387fd628",
            "date": "2025-01-01T16:29:12Z",
            "author_login": "AntonKueltz"
          },
          {
            "sha": "6c522e297379ad7919b2efdb2eaaf55c9b8d5d72",
            "date": "2025-01-01T16:29:12Z",
            "author_login": "AntonKueltz"
          },
          {
            "sha": "f2d77b9c84471cd2d60779f0d37fe0e7c3db9e39",
            "date": "2025-01-01T16:13:15Z",
            "author_login": "AntonKueltz"
          },
          {
            "sha": "8385ada2178e61b29f67a1d068f39a231e9a4075",
            "date": "2024-12-31T14:57:22Z",
            "author_login": "AntonKueltz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-457",
    "description": "Versions of the package fastecdsa before 2.3.2 are vulnerable to Use of Uninitialized Variable on the stack, via the curvemath_mul function in src/curveMath.c, due to being used and interpreted as user-defined type. Depending on the variable's actual value it could be arbitrary free(), arbitrary realloc(), null pointer dereference and other. Since the stack can be controlled by the attacker, the vulnerability could be used to corrupt allocator structure, leading to possible heap exploitation. The attacker could cause denial of service by exploiting this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-24T05:15:44.643",
    "last_modified": "2024-11-21T08:54:34.130",
    "fix_date": "2024-02-22T19:26:28Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/keltecc/49da037072276f21b005a8337c15db26",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://github.com/AntonKueltz/fastecdsa/blob/v2.3.1/src/curveMath.c%23L210",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://github.com/AntonKueltz/fastecdsa/commit/57fc5689c95d649dab7ef60cc99ac64589f01e36",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-PYTHON-FASTECDSA-6262045",
      "source": "report@snyk.io",
      "tags": []
    },
    {
      "url": "https://gist.github.com/keltecc/49da037072276f21b005a8337c15db26",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/AntonKueltz/fastecdsa/blob/v2.3.1/src/curveMath.c%23L210",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/AntonKueltz/fastecdsa/commit/57fc5689c95d649dab7ef60cc99ac64589f01e36",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-PYTHON-FASTECDSA-6262045",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.157163",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fastecdsa",
    "owner": "AntonKueltz",
    "created_at": "2016-03-24T19:28:53Z",
    "updated_at": "2025-01-01T16:49:36Z",
    "pushed_at": "2025-01-01T16:49:33Z",
    "size": 1552,
    "stars": 272,
    "forks": 79,
    "open_issues": 5,
    "watchers": 272,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 114843,
      "C": 15603
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "unlicense"
    },
    "collected_at": "2025-01-14T22:25:34.203446"
  }
}