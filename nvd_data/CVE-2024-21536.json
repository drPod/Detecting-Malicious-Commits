{
  "cve_id": "CVE-2024-21536",
  "github_data": {
    "repository": "chimurai/http-proxy-middleware",
    "fix_commit": "0b4274e8cc9e9a2c5a06f35fbf456ccfcebc55a5",
    "related_commits": [
      "0b4274e8cc9e9a2c5a06f35fbf456ccfcebc55a5",
      "788b21e4aff38332d6319557d4a5b1b13b1f9a22"
    ],
    "patch_url": "https://github.com/chimurai/http-proxy-middleware/commit/0b4274e8cc9e9a2c5a06f35fbf456ccfcebc55a5.patch",
    "fix_commit_details": {
      "sha": "0b4274e8cc9e9a2c5a06f35fbf456ccfcebc55a5",
      "commit_date": "2024-10-06T16:58:31Z",
      "author": {
        "login": "chimurai",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(filter): handle errors",
        "length": 26,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 40,
        "additions": 37,
        "deletions": 3
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -3,6 +3,7 @@\n ## [v2.0.7](https://github.com/chimurai/http-proxy-middleware/releases/tag/v2.0.7)\n \n - ci(github actions): add publish.yml\n+- fix(filter): handle errors\n \n ## [v2.0.6](https://github.com/chimurai/http-proxy-middleware/releases/tag/v2.0.6)\n "
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"http-proxy-middleware\",\n-  \"version\": \"2.0.7-beta.0\",\n+  \"version\": \"2.0.7-beta.1\",\n   \"description\": \"The one-liner node.js proxy middleware for connect, express and browser-sync\",\n   \"main\": \"dist/index.js\",\n   \"types\": \"dist/index.d.ts\","
        },
        {
          "filename": "src/http-proxy-middleware.ts",
          "status": "modified",
          "additions": 7,
          "deletions": 2,
          "patch": "@@ -109,8 +109,13 @@ export class HttpProxyMiddleware {\n    * @return {Boolean}\n    */\n   private shouldProxy = (context, req: Request): boolean => {\n-    const path = req.originalUrl || req.url;\n-    return contextMatcher.match(context, path, req);\n+    try {\n+      const path = req.originalUrl || req.url;\n+      return contextMatcher.match(context, path, req);\n+    } catch (error) {\n+      this.logger.error(error);\n+      return false;\n+    }\n   };\n \n   /**"
        },
        {
          "filename": "test/e2e/http-proxy-middleware.spec.ts",
          "status": "modified",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -153,6 +153,34 @@ describe('E2E http-proxy-middleware', () => {\n         const response = await agent.get(`/api/b/c/d`).expect(404);\n         expect(response.status).toBe(404);\n       });\n+\n+      it('should not proxy when filter throws Error', async () => {\n+        const myError = new Error('MY_ERROR');\n+        const filter = (path, req) => {\n+          throw myError;\n+        };\n+\n+        const logger = {\n+          log: jest.fn(),\n+          info: jest.fn(),\n+          warn: jest.fn(),\n+          error: jest.fn(),\n+        };\n+\n+        agent = request(\n+          createApp(\n+            createProxyMiddleware(filter, {\n+              target: `http://localhost:${mockTargetServer.port}`,\n+              logProvider: () => logger,\n+            })\n+          )\n+        );\n+\n+        await mockTargetServer.get('/api/b/c/d').thenReply(200, 'HELLO WEB');\n+        const response = await agent.get(`/api/b/c/d`).expect(404);\n+        expect(response.status).toBe(404);\n+        expect(logger.error).toHaveBeenCalledWith(expect.objectContaining(myError));\n+      });\n     });\n \n     describe('multi path', () => {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1ee26edc1103e96e22b1d38b3de118bc21bfc57e",
            "date": "2024-12-11T19:02:30Z",
            "author_login": "chimurai"
          },
          {
            "sha": "cd78bfc04b0cb81a3e54634ca9aa59dd603dceec",
            "date": "2024-11-29T16:32:07Z",
            "author_login": "chimurai"
          },
          {
            "sha": "77f320e4dca8247167471393dcbce2b1e333b7cf",
            "date": "2024-10-18T20:18:56Z",
            "author_login": "chimurai"
          },
          {
            "sha": "6335316565b32d5626e81b4e9a26ab46c9febcbc",
            "date": "2024-10-18T20:09:54Z",
            "author_login": "chimurai"
          },
          {
            "sha": "3d6134b7265871cecf116c71bc39b0014d23b49c",
            "date": "2024-10-07T19:21:47Z",
            "author_login": "17hz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Versions of the package http-proxy-middleware before 2.0.7, from 3.0.0 and before 3.0.3 are vulnerable to Denial of Service (DoS) due to an UnhandledPromiseRejection error thrown by micromatch. An attacker could kill the Node.js process and crash the server by making requests to certain paths.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-19T05:15:13.097",
    "last_modified": "2024-11-01T18:03:15.897",
    "fix_date": "2024-10-06T16:58:31Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/mhassan1/28be67266d82a53708ed59ce5dc3c94a",
      "source": "report@snyk.io",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/chimurai/http-proxy-middleware/commit/0b4274e8cc9e9a2c5a06f35fbf456ccfcebc55a5",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/chimurai/http-proxy-middleware/commit/788b21e4aff38332d6319557d4a5b1b13b1f9a22",
      "source": "report@snyk.io",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://security.snyk.io/vuln/SNYK-JS-HTTPPROXYMIDDLEWARE-8229906",
      "source": "report@snyk.io",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:27.060889",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "http-proxy-middleware",
    "owner": "chimurai",
    "created_at": "2015-03-14T15:45:55Z",
    "updated_at": "2025-01-14T08:25:31Z",
    "pushed_at": "2024-12-11T19:02:32Z",
    "size": 3484,
    "stars": 10837,
    "forks": 858,
    "open_issues": 109,
    "watchers": 10837,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "TypeScript": 126136,
      "JavaScript": 1509
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:38:50.130451"
  }
}