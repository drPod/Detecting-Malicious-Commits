{
  "cve_id": "CVE-2024-21653",
  "github_data": {
    "repository": "vantage6/vantage6",
    "fix_commit": "3fcc6e6a8bd1142fd7a558d8fdd2b246e55c8841",
    "related_commits": [
      "3fcc6e6a8bd1142fd7a558d8fdd2b246e55c8841",
      "3fcc6e6a8bd1142fd7a558d8fdd2b246e55c8841"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3fcc6e6a8bd1142fd7a558d8fdd2b246e55c8841",
      "commit_date": "2024-01-18T08:34:47Z",
      "author": {
        "login": "bartvanb",
        "type": "User",
        "stats": {
          "total_commits": 2429,
          "average_weekly_commits": 5.924390243902439,
          "total_additions": 375151,
          "total_deletions": 328650,
          "weeks_active": 161
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-2wgc-48g2-cj5w",
        "length": 106,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 35,
        "additions": 7,
        "deletions": 28
      },
      "files": [
        {
          "filename": "docker/node-and-server.Dockerfile",
          "status": "modified",
          "additions": 7,
          "deletions": 12,
          "patch": "@@ -12,20 +12,15 @@ FROM harbor2.vantage6.ai/infrastructure/infrastructure-base:${BASE}\n LABEL version=${TAG}\n LABEL maintainer=\"Frank Martin <f.martin@iknl.nl>\"\n \n-# Enable SSH access in Azure App service\n+# Update and upgrade\n RUN apt update -y\n RUN apt upgrade -y\n \n-RUN apt install openssh-server sudo -y\n-RUN useradd -rm -d /home/ubuntu -s /bin/bash -g root -G sudo -u 1000 test\n-RUN  echo 'root:Docker!' | chpasswd\n-\n-COPY sshd_config /etc/ssh/\n-RUN mkdir /run/sshd\n-\n-# Fix DB issue\n-RUN apt install python-psycopg2 -y\n-RUN pip install psycopg2-binary\n+# TODO 2024-01-09 check if this custom install is still needed. It was used to\n+# fix problems with the sqlalchemy dependency psycopg2 at some point.\n+# # Fix DB issue\n+# RUN apt install python-psycopg2 -y\n+# RUN pip install psycopg2-binary\n \n # copy source\n COPY . /vantage6\n@@ -59,5 +54,5 @@ RUN chmod +x /vantage6/vantage6-server/server.sh\n \n # expose the proxy server port\n ARG port=80\n-EXPOSE ${port} 2222\n+EXPOSE ${port}\n ENV PROXY_SERVER_PORT ${port}"
        },
        {
          "filename": "sshd_config",
          "status": "removed",
          "additions": 0,
          "deletions": 16,
          "patch": "@@ -1,16 +0,0 @@\n-# This is ssh server systemwide configuration file.\n-#\n-# /etc/sshd_config\n-\n-Port \t\t\t        2222\n-ListenAddress \t\t    0.0.0.0\n-LoginGraceTime \t\t    180\n-X11Forwarding \t\t    yes\n-Ciphers aes128-cbc,3des-cbc,aes256-cbc,aes128-ctr,aes192-ctr,aes256-ctr\n-MACs hmac-sha1,hmac-sha1-96\n-StrictModes \t\t    yes\n-SyslogFacility \t\t    DAEMON\n-PasswordAuthentication \tyes\n-PermitEmptyPasswords \tno\n-PermitRootLogin \t    yes\n-Subsystem sftp internal-sftp\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e90dd7fa784689c97e78c30076c229eec734415a",
            "date": "2025-01-23T11:30:32Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "f96b6e504e638e7419650febca732926ac9b93e3",
            "date": "2025-01-23T09:54:43Z",
            "author_login": "invalid-email-address"
          },
          {
            "sha": "61400bd168937a9ab022ace3ef43a157d4415e8c",
            "date": "2025-01-23T09:53:39Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "62886a99067f435ddc89c19593f953959e53778d",
            "date": "2025-01-23T09:48:32Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "a309942134c3ff0484d644c0500865165e80babd",
            "date": "2025-01-23T09:48:07Z",
            "author_login": "bartvanb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-284",
    "description": "The vantage6 technology enables to manage and deploy privacy enhancing technologies like Federated Learning (FL) and Multi-Party Computation (MPC).  Nodes and servers get a ssh config by default that permits root login with password authentication. In a proper deployment, the SSH service is not exposed so there is no risk, but not all deployments are ideal. The default should therefore be less permissive.  The vulnerability can be mitigated by removing the ssh part from the docker file and rebuilding the docker image.  Version 4.2.0 patches the vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-30T16:15:47.863",
    "last_modified": "2024-11-21T08:54:48.557",
    "fix_date": "2024-01-18T08:34:47Z"
  },
  "references": [
    {
      "url": "https://github.com/vantage6/vantage6/commit/3fcc6e6a8bd1142fd7a558d8fdd2b246e55c8841",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-2wgc-48g2-cj5w",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/commit/3fcc6e6a8bd1142fd7a558d8fdd2b246e55c8841",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-2wgc-48g2-cj5w",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.549148",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "vantage6",
    "owner": "vantage6",
    "created_at": "2022-05-16T12:09:26Z",
    "updated_at": "2025-01-23T11:30:39Z",
    "pushed_at": "2025-01-24T16:21:27Z",
    "size": 45202,
    "stars": 31,
    "forks": 11,
    "open_issues": 261,
    "watchers": 31,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 1970531,
      "TypeScript": 558978,
      "HTML": 221946,
      "SCSS": 24699,
      "Makefile": 13102,
      "Dockerfile": 9054,
      "Jinja": 5974,
      "Shell": 4282,
      "JavaScript": 802
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:39:52.788262"
  }
}