{
  "cve_id": "CVE-2024-21666",
  "github_data": {
    "repository": "pimcore/customer-data-framework",
    "fix_commit": "c33c0048390ef0cf98b801d46a81d0762243baa6",
    "related_commits": [
      "c33c0048390ef0cf98b801d46a81d0762243baa6",
      "c33c0048390ef0cf98b801d46a81d0762243baa6"
    ],
    "patch_url": "https://github.com/pimcore/customer-data-framework/commit/c33c0048390ef0cf98b801d46a81d0762243baa6.patch",
    "fix_commit_details": {
      "sha": "c33c0048390ef0cf98b801d46a81d0762243baa6",
      "commit_date": "2024-01-08T11:39:34Z",
      "author": {
        "login": "robertSt7",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix: improper access (#523)",
        "length": 27,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/Controller/Admin/DuplicatesController.php",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -23,6 +23,7 @@\n use Symfony\\Component\\HttpFoundation\\JsonResponse;\n use Symfony\\Component\\HttpFoundation\\Request;\n use Symfony\\Component\\HttpFoundation\\Response;\n+use Symfony\\Component\\HttpKernel\\Event\\ControllerEvent;\n use Symfony\\Component\\Routing\\Annotation\\Route;\n \n /**\n@@ -35,6 +36,12 @@ public function init()\n         AbstractObject::setHideUnpublished(true);\n     }\n \n+    public function onKernelControllerEvent(ControllerEvent $event): void\n+    {\n+        parent::onKernelControllerEvent($event);\n+        $this->checkPermission('plugin_cmf_perm_customerview');\n+    }\n+\n     /**\n      * @Route(\"/list\")\n      *"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4ec3748325cf42cab8df2a8ff4d8653338eddb1a",
            "date": "2024-11-28T09:20:36Z",
            "author_login": "kingjia90"
          },
          {
            "sha": "441639320548e4febd9eb947a3d42ecf1722b947",
            "date": "2024-09-23T15:31:51Z",
            "author_login": "jdreesen"
          },
          {
            "sha": "d6e2b9c02cdc02efba4b646f9d09c121d86b329b",
            "date": "2024-09-23T15:02:15Z",
            "author_login": "markus-moser"
          },
          {
            "sha": "410038f9f9c4d81582a8fa1931996bac59f4b046",
            "date": "2024-08-07T10:20:44Z",
            "author_login": "markus-moser"
          },
          {
            "sha": "02a704143a5e00af80607f0a4cd73883132262b3",
            "date": "2024-07-04T12:44:29Z",
            "author_login": "jdreesen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-284",
    "description": "The Customer Management Framework (CMF) for Pimcore adds functionality for customer data management, segmentation, personalization and marketing automation. An authenticated and unauthorized user can access the list of potential duplicate users and see their data. Permissions are enforced when reaching the `/admin/customermanagementframework/duplicates/list` endpoint allowing an authenticated user without the permissions to access the endpoint and query the data available there. Unauthorized user(s) can access PII data from customers. This vulnerability has been patched in version 4.0.6.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-11T01:15:45.623",
    "last_modified": "2024-11-21T08:54:49.703",
    "fix_date": "2024-01-08T11:39:34Z"
  },
  "references": [
    {
      "url": "https://github.com/pimcore/customer-data-framework/blob/b4af625ef327c58d05ef7cdf145fa749d2d4195e/src/Controller/Admin/DuplicatesController.php#L43",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/pimcore/customer-data-framework/commit/c33c0048390ef0cf98b801d46a81d0762243baa6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pimcore/customer-data-framework/security/advisories/GHSA-c38c-c8mh-vq68",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/pimcore/customer-data-framework/blob/b4af625ef327c58d05ef7cdf145fa749d2d4195e/src/Controller/Admin/DuplicatesController.php#L43",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/pimcore/customer-data-framework/commit/c33c0048390ef0cf98b801d46a81d0762243baa6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/pimcore/customer-data-framework/security/advisories/GHSA-c38c-c8mh-vq68",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.158292",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "customer-data-framework",
    "owner": "pimcore",
    "created_at": "2017-06-09T10:05:51Z",
    "updated_at": "2024-11-28T09:20:41Z",
    "pushed_at": "2025-01-14T11:16:22Z",
    "size": 8053,
    "stars": 81,
    "forks": 94,
    "open_issues": 20,
    "watchers": 81,
    "has_security_policy": false,
    "default_branch": "4.x",
    "protected_branches": [
      "3.4",
      "4.x",
      "4.0",
      "4.2"
    ],
    "languages": {
      "PHP": 1198301,
      "JavaScript": 1022766,
      "CSS": 452617,
      "Twig": 54140,
      "SCSS": 5216,
      "Shell": 532
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:31:01.813041"
  }
}