{
  "cve_id": "CVE-2024-21668",
  "github_data": {
    "repository": "mrousavy/react-native-mmkv",
    "fix_commit": "a8995ccb7184281f7d168bad3e9987c9bd05f00d",
    "related_commits": [
      "a8995ccb7184281f7d168bad3e9987c9bd05f00d",
      "a8995ccb7184281f7d168bad3e9987c9bd05f00d"
    ],
    "patch_url": "https://github.com/mrousavy/react-native-mmkv/commit/a8995ccb7184281f7d168bad3e9987c9bd05f00d.patch",
    "fix_commit_details": {
      "sha": "a8995ccb7184281f7d168bad3e9987c9bd05f00d",
      "commit_date": "2023-09-30T11:11:25Z",
      "author": {
        "login": "mrousavy",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: Don't leak encryption key in logs",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "android/src/main/cpp/MmkvHostObject.cpp",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -15,9 +15,10 @@\n \n MmkvHostObject::MmkvHostObject(const std::string& instanceId, std::string path,\n                                std::string cryptKey) {\n+  bool hasEncryptionKey = cryptKey.size() > 0;\n   __android_log_print(ANDROID_LOG_INFO, \"RNMMKV\",\n-                      \"Creating MMKV instance \\\"%s\\\"... (Path: %s, Encryption-Key: %s)\",\n-                      instanceId.c_str(), path.c_str(), cryptKey.c_str());\n+                      \"Creating MMKV instance \\\"%s\\\"... (Path: %s, Encrypted: %b)\",\n+                      instanceId.c_str(), path.c_str(), hasEncryptionKey);\n   std::string* pathPtr = path.size() > 0 ? &path : nullptr;\n   std::string* cryptKeyPtr = cryptKey.size() > 0 ? &cryptKey : nullptr;\n   instance = MMKV::mmkvWithID(instanceId, mmkv::DEFAULT_MMAP_SIZE, MMKV_SINGLE_PROCESS, cryptKeyPtr,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "cca2617fa507c62624a1e46424616a1013234983",
            "date": "2024-12-17T14:39:49Z",
            "author_login": "mrousavy"
          },
          {
            "sha": "02a00aeeb1931deba457ad87e4b9adf7cd1c1d21",
            "date": "2024-11-19T19:20:43Z",
            "author_login": "amutsch"
          },
          {
            "sha": "2be0a6084acfecbb38870a55425b248a711e3a30",
            "date": "2024-10-22T09:18:46Z",
            "author_login": "mrousavy"
          },
          {
            "sha": "bf4512b193abfea7a33de71c39699d7e5d1a83d9",
            "date": "2024-10-22T09:17:19Z",
            "author_login": "mrousavy"
          },
          {
            "sha": "4f96988e6738f22d9cad0ff45fff58aacc12ace1",
            "date": "2024-10-22T09:13:48Z",
            "author_login": "mrousavy"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-532",
    "description": "react-native-mmkv is a library that allows easy use of MMKV inside React Native applications. Before version 2.11.0, the react-native-mmkv logged the optional encryption key for the MMKV database into the Android system log. The key can be obtained by anyone with access to the Android Debugging Bridge (ADB) if it is enabled in the phone settings. This bug is not present on iOS devices. By logging the encryption secret to the system logs, attackers can trivially recover the secret by enabling ADB and undermining an app's thread model. This issue has been patched in version 2.11.0.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-09T19:15:12.330",
    "last_modified": "2024-11-21T08:54:49.963",
    "fix_date": "2023-09-30T11:11:25Z"
  },
  "references": [
    {
      "url": "https://github.com/mrousavy/react-native-mmkv/commit/a8995ccb7184281f7d168bad3e9987c9bd05f00d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mrousavy/react-native-mmkv/releases/tag/v2.11.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/mrousavy/react-native-mmkv/security/advisories/GHSA-4jh3-6jhv-2mgp",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/mrousavy/react-native-mmkv/commit/a8995ccb7184281f7d168bad3e9987c9bd05f00d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mrousavy/react-native-mmkv/releases/tag/v2.11.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/mrousavy/react-native-mmkv/security/advisories/GHSA-4jh3-6jhv-2mgp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:06:44.152797",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "react-native-mmkv",
    "owner": "mrousavy",
    "created_at": "2021-02-24T07:33:00Z",
    "updated_at": "2025-01-14T13:06:39Z",
    "pushed_at": "2024-12-17T14:39:52Z",
    "size": 35826,
    "stars": 6477,
    "forks": 264,
    "open_issues": 38,
    "watchers": 6477,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C++": 81923,
      "TypeScript": 40284,
      "Objective-C++": 3653,
      "JavaScript": 3052,
      "Ruby": 2921,
      "Kotlin": 2460,
      "Objective-C": 2197,
      "Java": 2110,
      "CMake": 870,
      "Shell": 413,
      "Swift": 56
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:09:59.005800"
  }
}