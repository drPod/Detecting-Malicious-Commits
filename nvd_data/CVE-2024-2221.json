{
  "cve_id": "CVE-2024-2221",
  "github_data": {
    "repository": "qdrant/qdrant",
    "fix_commit": "e6411907f0ecf3c2f8ba44ab704b9e4597d9705d",
    "related_commits": [
      "e6411907f0ecf3c2f8ba44ab704b9e4597d9705d",
      "e6411907f0ecf3c2f8ba44ab704b9e4597d9705d"
    ],
    "patch_url": "https://github.com/qdrant/qdrant/commit/e6411907f0ecf3c2f8ba44ab704b9e4597d9705d.patch",
    "fix_commit_details": {
      "sha": "e6411907f0ecf3c2f8ba44ab704b9e4597d9705d",
      "commit_date": "2024-03-06T09:38:44Z",
      "author": {
        "login": "timvisee",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Bump version to 1.8.0 (#3779)",
        "length": 29,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 10948,
        "additions": 10940,
        "deletions": 8
      },
      "files": [
        {
          "filename": "Cargo.lock",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -469,7 +469,7 @@ checksum = \"5ad32ce52e4161730f7098c077cd2ed6229b5804ccf99e5366be1ab72a98b4e1\"\n \n [[package]]\n name = \"api\"\n-version = \"1.7.4\"\n+version = \"1.8.0\"\n dependencies = [\n  \"chrono\",\n  \"common\",\n@@ -3939,7 +3939,7 @@ dependencies = [\n \n [[package]]\n name = \"qdrant\"\n-version = \"1.7.4\"\n+version = \"1.8.0\"\n dependencies = [\n  \"actix-cors\",\n  \"actix-files\","
        },
        {
          "filename": "Cargo.toml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,6 +1,6 @@\n [package]\n name = \"qdrant\"\n-version = \"1.7.4\"\n+version = \"1.8.0\"\n authors = [\n     \"Andrey Vasnetsov <andrey@vasnetsov.com>\",\n     \"Qdrant Team <info@qdrant.tech>\",\n@@ -179,4 +179,4 @@ opt-level = 3\n \n [patch.crates-io]\n # Temporary patch until <https://github.com/hyperium/tonic/pull/1401> is merged\n-tonic = { git = 'https://github.com/qdrant/tonic', branch = \"v0.9.2-patched\" }\n\\ No newline at end of file\n+tonic = { git = 'https://github.com/qdrant/tonic', branch = \"v0.9.2-patched\" }"
        },
        {
          "filename": "docs/redoc/default_version.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-const defaultApiVersion = 'v1.7.x';\n+const defaultApiVersion = 'v1.8.x';"
        },
        {
          "filename": "docs/redoc/index.html",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -39,6 +39,7 @@\n         </button>\n         <div class=\"dropdown-menu dropdown-menu-right\">\n             <a href=\"?v=master\" class=\"dropdown-item\" type=\"button\">master</a>\n+            <a href=\"?v=v1.8.x\" class=\"dropdown-item\" type=\"button\">v1.8.x</a>\n             <a href=\"?v=v1.7.x\" class=\"dropdown-item\" type=\"button\">v1.7.x</a>\n             <a href=\"?v=v1.6.x\" class=\"dropdown-item\" type=\"button\">v1.6.x</a>\n             <a href=\"?v=v1.5.x\" class=\"dropdown-item\" type=\"button\">v1.5.x</a>"
        },
        {
          "filename": "docs/redoc/v1.8.x/openapi.json",
          "status": "added",
          "additions": 10931,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "lib/api/Cargo.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n [package]\n name = \"api\"\n-version = \"1.7.4\"\n+version = \"1.8.0\"\n authors = [\n     \"Andrey Vasnetsov <andrey@vasnetsov.com>\",\n     \"Qdrant Team <info@qdrant.tech>\","
        },
        {
          "filename": "lib/common/common/src/defaults.rs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -6,7 +6,7 @@ use semver::Version;\n use crate::cpu;\n \n /// Current Qdrant version\n-pub const QDRANT_VERSION: Version = Version::new(1, 7, 4);\n+pub const QDRANT_VERSION: Version = Version::new(1, 8, 0);\n \n /// Default timeout for consensus meta operations.\n pub const CONSENSUS_META_OP_WAIT: Duration = Duration::from_secs(10);"
        },
        {
          "filename": "tools/missed_cherry_picks.sh",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -8,7 +8,7 @@\n set -euo pipefail\n \n # Ignore all commits upto and including this commit hash on dev\n-IGNORE_UPTO=fac083f71571c7c437fc3c0a7b56555bda9d9a86\n+IGNORE_UPTO=02aef54b2769c8287722e9fddb372fb273e9050d\n \n # Fetch latest branch info from remote\n git fetch -q origin master"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 2,
        "test_files": 0,
        "unique_directories": 6,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e545b6964b328b1ab1964c4656d077e4f7680034",
            "date": "2025-01-08T14:43:27Z",
            "author_login": "timvisee"
          },
          {
            "sha": "7ea41c794da98cb4bd9e457445d27f840659e013",
            "date": "2025-01-08T13:32:23Z",
            "author_login": "IvanPleshkov"
          },
          {
            "sha": "d841d7dbe60831083dafb07e93c79278fcd365a1",
            "date": "2025-01-08T12:51:15Z",
            "author_login": "IvanPleshkov"
          },
          {
            "sha": "157ef24cb2ad5714e13ef95dd60f327b8ef269de",
            "date": "2025-01-08T09:58:47Z",
            "author_login": "IvanPleshkov"
          },
          {
            "sha": "472f8e0a7167c49a2ec18064b757f0fbb8bfbd67",
            "date": "2025-01-07T20:45:09Z",
            "author_login": "generall"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-434",
    "description": "qdrant/qdrant is vulnerable to a path traversal and arbitrary file upload vulnerability via the `/collections/{COLLECTION}/snapshots/upload` endpoint, specifically through the `snapshot` parameter. This vulnerability allows attackers to upload and overwrite any file on the filesystem, leading to potential remote code execution. This issue affects the integrity and availability of the system, enabling unauthorized access and potentially causing the server to malfunction.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-04-10T17:15:54.633",
    "last_modified": "2024-11-21T09:09:17.320",
    "fix_date": "2024-03-06T09:38:44Z"
  },
  "references": [
    {
      "url": "https://github.com/qdrant/qdrant/commit/e6411907f0ecf3c2f8ba44ab704b9e4597d9705d",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/6be8d4e3-67e6-4660-a8db-04215a1cff3e",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/qdrant/qdrant/commit/e6411907f0ecf3c2f8ba44ab704b9e4597d9705d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/6be8d4e3-67e6-4660-a8db-04215a1cff3e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.466174",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qdrant",
    "owner": "qdrant",
    "created_at": "2020-05-30T21:37:01Z",
    "updated_at": "2025-01-14T14:17:13Z",
    "pushed_at": "2025-01-14T14:15:51Z",
    "size": 27075,
    "stars": 21340,
    "forks": 1464,
    "open_issues": 358,
    "watchers": 21340,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Rust": 7514996,
      "Python": 911220,
      "Shell": 91875,
      "C": 16974,
      "Dockerfile": 7599,
      "Nix": 5997,
      "JavaScript": 1502,
      "Mermaid": 970
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:26:34.529008"
  }
}