{
  "cve_id": "CVE-2024-22411",
  "github_data": {
    "repository": "avo-hq/avo",
    "fix_commit": "51bb80b181cd8e31744bdc4e7f9b501c81172347",
    "related_commits": [
      "51bb80b181cd8e31744bdc4e7f9b501c81172347",
      "fc92a05a8556b1787c8694643286a1afa6a71258",
      "51bb80b181cd8e31744bdc4e7f9b501c81172347",
      "fc92a05a8556b1787c8694643286a1afa6a71258"
    ],
    "patch_url": "https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347.patch",
    "fix_commit_details": {
      "sha": "51bb80b181cd8e31744bdc4e7f9b501c81172347",
      "commit_date": "2024-01-12T12:47:25Z",
      "author": {
        "login": "adrianthedev",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "security: sanitize key_value field content (#2357)",
        "length": 50,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "app/javascript/js/controllers/fields/key_value_controller.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -1,4 +1,5 @@\n /* eslint-disable max-len */\n+import * as DOMPurify from 'dompurify'\n import { Controller } from '@hotwired/stimulus'\n import { castBoolean } from '../../helpers/cast_boolean'\n \n@@ -80,7 +81,7 @@ export default class extends Controller {\n     let index = 0\n     this.fieldValue.forEach((row) => {\n       const [key, value] = row\n-      result += this.interpolatedRow(key, value, index)\n+      result += this.interpolatedRow(DOMPurify.sanitize(key), DOMPurify.sanitize(value), index)\n       index++\n     })\n     this.rowsTarget.innerHTML = result"
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -34,6 +34,7 @@\n     \"codemirror\": \"5.59.1\",\n     \"core-js\": \"^3.35.0\",\n     \"css-loader\": \"^6.9.0\",\n+    \"dompurify\": \"^3.0.8\",\n     \"easymde\": \"^2.18.0\",\n     \"el-transition\": \"^0.0.7\",\n     \"esbuild\": \"^0.14.54\","
        },
        {
          "filename": "yarn.lock",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -2090,6 +2090,11 @@ doctrine@^3.0.0:\n   dependencies:\n     esutils \"^2.0.2\"\n \n+dompurify@^3.0.8:\n+  version \"3.0.8\"\n+  resolved \"https://registry.yarnpkg.com/dompurify/-/dompurify-3.0.8.tgz#e0021ab1b09184bc8af7e35c7dd9063f43a8a437\"\n+  integrity sha512-b7uwreMYL2eZhrSCRC4ahLTeZcPZxSmYfmcQGXGkXiZSNW1X85v+SDM5KsWcpivIiUBH47Ji7NtyUdpLeF5JZQ==\n+\n easymde@^2.18.0:\n   version \"2.18.0\"\n   resolved \"https://registry.yarnpkg.com/easymde/-/easymde-2.18.0.tgz#ff1397d07329b1a7b9187d2d0c20766fa16b3b1b\""
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0ba043882853c3a28b49638796a7a01f50e7281a",
            "date": "2025-01-10T15:24:49Z",
            "author_login": "Paul-Bob"
          },
          {
            "sha": "526dbafd804bdbf0a634e9ad9a380325603c3409",
            "date": "2025-01-10T11:06:33Z",
            "author_login": "depfu[bot]"
          },
          {
            "sha": "44e141895471c0744865d7e7a32e58b06825048f",
            "date": "2025-01-09T13:49:25Z",
            "author_login": "depfu[bot]"
          },
          {
            "sha": "f70b5d2b1450421625db9726e6ee9e35bfb8141c",
            "date": "2025-01-09T11:58:33Z",
            "author_login": "adrianthedev"
          },
          {
            "sha": "ca1d2c6e7de54f9f98c97fd617042d524efe295c",
            "date": "2025-01-09T08:43:34Z",
            "author_login": "Paul-Bob"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "Avo is a framework to create admin panels for Ruby on Rails apps. In Avo 3 pre12, any HTML inside text that is passed to `error` or `succeed` in an `Avo::BaseAction` subclass will be rendered directly without sanitization in the toast/notification that appears in the UI on Action completion. A malicious user could exploit this vulnerability to trigger a cross site scripting attack on an unsuspecting user. This issue has been addressed in the 3.3.0 and 2.47.0 releases of Avo. Users are advised to upgrade.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-16T22:15:46.420",
    "last_modified": "2024-11-21T08:56:13.933",
    "fix_date": "2024-01-12T12:47:25Z"
  },
  "references": [
    {
      "url": "https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/commit/fc92a05a8556b1787c8694643286a1afa6a71258",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/releases/tag/v2.47.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/releases/tag/v3.3.0",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/security/advisories/GHSA-g8vp-2v5p-9qfh",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/commit/fc92a05a8556b1787c8694643286a1afa6a71258",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/releases/tag/v2.47.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/releases/tag/v3.3.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/avo-hq/avo/security/advisories/GHSA-g8vp-2v5p-9qfh",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.497000",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "avo",
    "owner": "avo-hq",
    "created_at": "2020-04-26T09:31:53Z",
    "updated_at": "2025-01-12T12:50:50Z",
    "pushed_at": "2025-01-14T14:34:00Z",
    "size": 16641,
    "stars": 1561,
    "forks": 264,
    "open_issues": 251,
    "watchers": 1561,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Ruby": 1103479,
      "HTML": 178368,
      "JavaScript": 118792,
      "CSS": 20926,
      "Shell": 2309,
      "Dockerfile": 1704,
      "Vue": 257,
      "Procfile": 139
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:30:19.248401"
  }
}