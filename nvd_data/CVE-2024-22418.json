{
  "cve_id": "CVE-2024-22418",
  "github_data": {
    "repository": "Intermesh/groupoffice",
    "fix_commit": "2a52a5d42d080db6738d70eba30294bcd94ebd09",
    "related_commits": [
      "2a52a5d42d080db6738d70eba30294bcd94ebd09",
      "2a52a5d42d080db6738d70eba30294bcd94ebd09"
    ],
    "patch_url": "https://github.com/Intermesh/groupoffice/commit/2a52a5d42d080db6738d70eba30294bcd94ebd09.patch",
    "fix_commit_details": {
      "sha": "2a52a5d42d080db6738d70eba30294bcd94ebd09",
      "commit_date": "2024-01-11T09:22:02Z",
      "author": {
        "login": "mschering",
        "type": "User",
        "stats": {
          "total_commits": 12336,
          "average_weekly_commits": 34.362116991643454,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 334
        }
      },
      "commit_message": {
        "title": "Files: Fixed Stored XSS Vulnerability via Malicious File Names in Upload Feature",
        "length": 80,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "www/modules/files/controller/FileController.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -189,7 +189,7 @@ private function isAnimatedGif($filename) {\n \t\n \tprotected function afterDisplay(&$response, &$model, &$params) {\n \n-\t\t$response['data']['path'] = $model->path;\n+\t\t$response['data']['path'] = htmlspecialchars($model->path);\n \t\t$response['data']['size'] = $model->fsFile->size();\n \t\t$response['data']['extension'] = strtolower($model->fsFile->extension());\n \t\t$response['data']['type'] = \\GO::t($response['data']['extension'], 'base', 'filetypes');"
        },
        {
          "filename": "www/modules/files/controller/FolderController.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -754,7 +754,7 @@ protected function actionList($params) {\n \t\t\t$folder->checkFsSync();\n \n \t\t//useful information for the view.\n-\t\t$response['path'] = $folder->path;\n+\t\t$response['path'] = htmlentities($folder->path);\n \n \t\t//Show this page in thumbnails or list\n \t\t$folderPreference = \\GO\\Files\\Model\\FolderPreference::model()->findByPk(array('user_id'=>\\GO::user()->id,'folder_id'=>$folder->id));\n@@ -984,7 +984,7 @@ private function _searchFiles($params) {\n         \n \tpublic function formatListRecord($record, $model) {\n \n-\t\t$record['path'] = $model->path;\n+\t\t$record['path'] = htmlspecialchars($model->path);\n \n \t\tif ($model instanceof Folder) {\n \t\t\t$record['type_id'] = 'd:' . $model->id;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5916425b7e7d24b38aaf5f362ffe977a0ea94c7c",
            "date": "2025-01-14T15:31:22Z",
            "author_login": "mschering"
          },
          {
            "sha": "517250a440bb6d02737f2c93bcb77a7be3e1d911",
            "date": "2025-01-14T15:30:11Z",
            "author_login": "mschering"
          },
          {
            "sha": "55f00cc89172c03ff71c4740eac05c552d6469d6",
            "date": "2025-01-14T15:29:51Z",
            "author_login": "mschering"
          },
          {
            "sha": "0592efe7aeaf0b684a8b2686851279c28ec9a9d4",
            "date": "2025-01-13T12:09:40Z",
            "author_login": "mschering"
          },
          {
            "sha": "aced0649b610cf45fef9b8e6455750856866a216",
            "date": "2025-01-13T12:08:23Z",
            "author_login": "mschering"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "Group-Office is an enterprise CRM and groupware tool. Affected versions are subject to a vulnerability which is present in the file upload mechanism of Group Office. It allows an attacker to execute arbitrary JavaScript code by embedding it within a file's name. For instance, using a filename such as \u201c><img src=x onerror=prompt('XSS')>.jpg\u201d triggers the vulnerability. When this file is uploaded, the JavaScript code within the filename is executed. This issue has been addressed in version 6.8.29. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-18T21:15:09.323",
    "last_modified": "2024-11-21T08:56:14.857",
    "fix_date": "2024-01-11T09:22:02Z"
  },
  "references": [
    {
      "url": "https://github.com/Intermesh/groupoffice/commit/2a52a5d42d080db6738d70eba30294bcd94ebd09",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Intermesh/groupoffice/security/advisories/GHSA-p7w9-h6c3-wqpp",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Intermesh/groupoffice/commit/2a52a5d42d080db6738d70eba30294bcd94ebd09",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Intermesh/groupoffice/security/advisories/GHSA-p7w9-h6c3-wqpp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.504450",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "groupoffice",
    "owner": "Intermesh",
    "created_at": "2018-03-08T14:50:33Z",
    "updated_at": "2025-01-14T15:31:28Z",
    "pushed_at": "2025-01-14T15:40:38Z",
    "size": 118410,
    "stars": 202,
    "forks": 47,
    "open_issues": 106,
    "watchers": 202,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 9522845,
      "JavaScript": 5759362,
      "SCSS": 215542,
      "CSS": 87670,
      "Perl": 12650,
      "TypeScript": 9959,
      "HTML": 9326,
      "Shell": 6686,
      "Smarty": 6349,
      "Hack": 125,
      "Makefile": 30
    },
    "commit_activity": {
      "total_commits_last_year": 1332,
      "avg_commits_per_week": 25.615384615384617,
      "days_active_last_year": 167
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:35:49.266468"
  }
}