{
  "cve_id": "CVE-2024-23331",
  "github_data": {
    "repository": "vitejs/vite",
    "fix_commit": "91641c4da0a011d4c5352e88fc68389d4e1289a5",
    "related_commits": [
      "91641c4da0a011d4c5352e88fc68389d4e1289a5",
      "91641c4da0a011d4c5352e88fc68389d4e1289a5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "91641c4da0a011d4c5352e88fc68389d4e1289a5",
      "commit_date": "2024-01-19T13:02:51Z",
      "author": {
        "login": "patak-dev",
        "type": "User",
        "stats": {
          "total_commits": 1048,
          "average_weekly_commits": 4.208835341365462,
          "total_additions": 61007,
          "total_deletions": 51646,
          "weeks_active": 175
        }
      },
      "commit_message": {
        "title": "fix: fs deny for case insensitive systems (#15653)",
        "length": 50,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 37,
        "additions": 33,
        "deletions": 4
      },
      "files": [
        {
          "filename": "packages/vite/src/node/server/index.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -617,7 +617,10 @@ export async function _createServer(\n     _importGlobMap: new Map(),\n     _forceOptimizeOnRestart: false,\n     _pendingRequests: new Map(),\n-    _fsDenyGlob: picomatch(config.server.fs.deny, { matchBase: true }),\n+    _fsDenyGlob: picomatch(config.server.fs.deny, {\n+      matchBase: true,\n+      nocase: true,\n+    }),\n     _shortcutsOptions: undefined,\n   }\n "
        },
        {
          "filename": "playground/fs-serve/__tests__/base/fs-serve-base.spec.ts",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -92,7 +92,13 @@ describe.runIf(isServe)('main', () => {\n   })\n \n   test('denied', async () => {\n-    expect(await page.textContent('.unsafe-dotenv')).toBe('404')\n+    expect(await page.textContent('.unsafe-dotenv')).toBe('403')\n+  })\n+\n+  test('denied EnV casing', async () => {\n+    // It is 403 in case insensitive system, 404 in others\n+    const code = await page.textContent('.unsafe-dotEnV-casing')\n+    expect(code === '403' || code === '404').toBeTruthy()\n   })\n })\n "
        },
        {
          "filename": "playground/fs-serve/__tests__/fs-serve.spec.ts",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -92,7 +92,13 @@ describe.runIf(isServe)('main', () => {\n   })\n \n   test('denied', async () => {\n-    expect(await page.textContent('.unsafe-dotenv')).toBe('404')\n+    expect(await page.textContent('.unsafe-dotenv')).toBe('403')\n+  })\n+\n+  test('denied EnV casing', async () => {\n+    // It is 403 in case insensitive system, 404 in others\n+    const code = await page.textContent('.unsafe-dotEnV-casing')\n+    expect(code === '403' || code === '404').toBeTruthy()\n   })\n })\n "
        },
        {
          "filename": "playground/fs-serve/root/src/index.html",
          "status": "modified",
          "additions": 15,
          "deletions": 1,
          "patch": "@@ -45,6 +45,7 @@ <h2>Nested Entry</h2>\n \n <h2>Denied</h2>\n <pre class=\"unsafe-dotenv\"></pre>\n+<pre class=\"unsafe-dotEnV-casing\"></pre>\n \n <script type=\"module\">\n   import '../../entry'\n@@ -236,14 +237,27 @@ <h2>Denied</h2>\n     })\n \n   // .env, denied by default\n-  fetch(joinUrlSegments(base, joinUrlSegments('/@fs/', ROOT) + '/root/.env'))\n+  fetch(\n+    joinUrlSegments(base, joinUrlSegments('/@fs/', ROOT) + '/root/src/.env'),\n+  )\n     .then((r) => {\n       text('.unsafe-dotenv', r.status)\n     })\n     .catch((e) => {\n       console.error(e)\n     })\n \n+  // .env, for case insensitive file systems\n+  fetch(\n+    joinUrlSegments(base, joinUrlSegments('/@fs/', ROOT) + '/root/src/.EnV'),\n+  )\n+    .then((r) => {\n+      text('.unsafe-dotEnV-casing', r.status)\n+    })\n+    .catch((e) => {\n+      console.error(e)\n+    })\n+\n   function text(sel, text) {\n     document.querySelector(sel).textContent = text\n   }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 4,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a4245b03159a438c827c949f6c5e8ebb7d03fd0a",
            "date": "2025-01-24T13:44:43Z",
            "author_login": "patak-dev"
          },
          {
            "sha": "fbbc6da186d72b7c2ad1efce22d42d302f673516",
            "date": "2025-01-24T13:41:55Z",
            "author_login": "dario-piotrowicz"
          },
          {
            "sha": "30194fa1e41dda6470aa20f2bb34655c4bfd9cd1",
            "date": "2025-01-24T03:32:27Z",
            "author_login": "sapphi-red"
          },
          {
            "sha": "1992f681fc7662780f2f2fa4fdb0865a8a54deff",
            "date": "2025-01-24T03:15:37Z",
            "author_login": "patak-dev"
          },
          {
            "sha": "eb22a74d29813d30be48d4413d785eedb0064b2c",
            "date": "2025-01-24T02:54:39Z",
            "author_login": "sapphi-red"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-178",
    "description": "Vite is a frontend tooling framework for javascript. The Vite dev server option `server.fs.deny` can be bypassed on case-insensitive file systems using case-augmented versions of filenames. Notably this affects servers hosted on Windows. This bypass is similar to CVE-2023-34092 -- with surface area reduced to hosts having case-insensitive filesystems. Since `picomatch` defaults to case-sensitive glob matching, but the file server doesn't discriminate; a blacklist bypass is possible. By requesting raw filesystem paths using augmented casing, the matcher derived from `config.server.fs.deny` fails to block access to sensitive files. This issue has been addressed in vite@5.0.12, vite@4.5.2, vite@3.2.8, and vite@2.9.17. Users are advised to upgrade. Users unable to upgrade should restrict access to dev servers.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-19T20:15:14.070",
    "last_modified": "2024-11-21T08:57:31.573",
    "fix_date": "2024-01-19T13:02:51Z"
  },
  "references": [
    {
      "url": "https://github.com/vitejs/vite/commit/91641c4da0a011d4c5352e88fc68389d4e1289a5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vitejs/vite/security/advisories/GHSA-c24v-8rfc-w8vw",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://vitejs.dev/config/server-options.html#server-fs-deny",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/vitejs/vite/commit/91641c4da0a011d4c5352e88fc68389d4e1289a5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/vitejs/vite/security/advisories/GHSA-c24v-8rfc-w8vw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://vitejs.dev/config/server-options.html#server-fs-deny",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.510464",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "vite",
    "owner": "vitejs",
    "created_at": "2020-04-21T05:03:57Z",
    "updated_at": "2025-01-26T06:24:53Z",
    "pushed_at": "2025-01-24T15:55:21Z",
    "size": 44408,
    "stars": 70214,
    "forks": 6373,
    "open_issues": 624,
    "watchers": 70214,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v1",
      "v2"
    ],
    "languages": {
      "TypeScript": 1973703,
      "JavaScript": 230250,
      "HTML": 118828,
      "CSS": 30279,
      "Vue": 3535,
      "AppleScript": 2691,
      "Svelte": 2510,
      "SCSS": 1894,
      "Less": 970,
      "Stylus": 531,
      "SugarSS": 274,
      "Shell": 244,
      "Pug": 165,
      "Sass": 140,
      "Astro": 114
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:09:41.272306"
  }
}