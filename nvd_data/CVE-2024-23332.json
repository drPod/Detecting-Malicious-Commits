{
  "cve_id": "CVE-2024-23332",
  "github_data": {
    "repository": "notaryproject/specifications",
    "fix_commit": "cdabdd1042de2999c685fa5d422a785ded9c983a",
    "related_commits": [
      "cdabdd1042de2999c685fa5d422a785ded9c983a",
      "cdabdd1042de2999c685fa5d422a785ded9c983a"
    ],
    "patch_url": "https://github.com/notaryproject/specifications/commit/cdabdd1042de2999c685fa5d422a785ded9c983a.patch",
    "fix_commit_details": {
      "sha": "cdabdd1042de2999c685fa5d422a785ded9c983a",
      "commit_date": "2023-11-23T03:39:58Z",
      "author": {
        "login": "priteshbandi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update threat model to include rollback attack (#285)",
        "length": 156,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 1,
        "additions": 1,
        "deletions": 0
      },
      "files": [
        {
          "filename": "threatmodels/notation-threatmodel.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -87,3 +87,4 @@ The certificates trusted by the verifier are stored in Notation trust store in t\n | Malicious signature faking to be signed by a signing authority | Tampering      | Mitigated | High   | Notation     | Unlike notary.x509 signing scheme, trusted timestamps are not checked against RFC#3161 TSA servers for notary.x509.signingAuthority signing scheme. An attacker can use this and bypass trusted timestamp checks by crafting a signature that uses notary.x509 keys but with signingAuthority as the signing scheme. | To prevent this threat, notary.x509.signingAuthority signing scheme requires trusted roots to be present in a trust store type called signingAuthority as opposed to CA trust store type for notary.x509 signing scheme |\n | Inaccessible OCSP Responder                                    | Denial of Service      | Not Mitigated | High     | OCSP Responder  | OCSP Responder is not able to service incoming requests or perform up to spec, thus users are unable to validate certificate revocation status | It cannot be mitigated, since revocation status should be retrieved from OCSP responder, which requires network access. Notation verification should fail if revocation check is configured as `enforced` and OCSP responder is inaccessible. Users can configure trust policy to log or skip revocation check if OCSP responder is not reliable. |\n | Compromised Notation dependencies                              | Tampering              | Mitigated | High     | Notation       | The dependencies that built into Notation binary was compromised, this may lead to arbitrary code being executed | Notation keeps dependencies up-to-date and adds new dependency after careful consideration and only if it's absolutely required. Always use static build instead of dynamic linking |\n+| Rollback Attack                              | Tampering              | Mitigated | High     | Notation       | Attacker can exploit a compromised repository to return outdated vulnerable artifacts | Signer can employ short signature expiration periods (and periodically re-sign artifacts) or revoke outdated vulnerable artifacts |\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c482ea645f6b04e2313d34dc8efe256cbfad9771",
            "date": "2025-01-08T16:39:34Z",
            "author_login": "JeyJeyGao"
          },
          {
            "sha": "8cf800c60b7315a43f0adbcae463d848a353b412",
            "date": "2025-01-07T00:47:18Z",
            "author_login": "Two-Hearts"
          },
          {
            "sha": "9c81dc773508dedc5a81c02c8d805de04f65050b",
            "date": "2024-11-07T07:14:52Z",
            "author_login": "JeyJeyGao"
          },
          {
            "sha": "a3d3d4f2b957f6492c986ae7f1482713ac4511d8",
            "date": "2024-09-11T05:58:21Z",
            "author_login": "yizha1"
          },
          {
            "sha": "00abcea0ad35bb80c74cb82890834440bf8f218d",
            "date": "2024-08-02T04:37:39Z",
            "author_login": "yizha1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:N/I:L/A:L",
    "cwe_id": "CWE-672",
    "description": "The Notary Project is a set of specifications and tools intended to provide a cross-industry standard for securing software supply chains by using authentic container images and other OCI artifacts. An external actor with control of a compromised container registry can provide outdated versions of OCI artifacts, such as Images. This could lead artifact consumers with relaxed trust policies (such as `permissive` instead of `strict`) to potentially use artifacts with signatures that are no longer valid, making them susceptible to any exploits those artifacts may contain. In Notary Project, an artifact publisher can control the validity period of artifact by specifying signature expiry during the signing process. Using shorter signature validity periods along with processes to periodically resign artifacts, allows artifact producers to ensure that their consumers will only receive up-to-date artifacts. Artifact consumers should correspondingly use a `strict` or equivalent trust policy that enforces signature expiry. Together these steps enable use of up-to-date artifacts and safeguard against rollback attack in the event of registry compromise. The Notary Project offers various signature validation options such as `permissive`, `audit` and `skip` to support various scenarios. These scenarios includes 1) situations demanding urgent workload deployment, necessitating the bypassing of expired or revoked signatures; 2) auditing of artifacts lacking signatures without interrupting workload; and 3) skipping of verification for specific images that might have undergone validation through alternative mechanisms. Additionally, the Notary Project supports revocation to ensure the signature freshness. Artifact publishers can sign with short-lived certificates and revoke older certificates when necessary. This revocation serves as a signal to inform artifact consumers that the corresponding unexpired artifact is no longer approved by the publisher. This enables the artifact publisher to control the validity of the signature independently of their ability to manage artifacts in a compromised registry.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-01-19T23:15:07.930",
    "last_modified": "2024-11-21T08:57:31.710",
    "fix_date": "2023-11-23T03:39:58Z"
  },
  "references": [
    {
      "url": "https://github.com/notaryproject/specifications/commit/cdabdd1042de2999c685fa5d422a785ded9c983a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/notaryproject/specifications/security/advisories/GHSA-57wx-m636-g3g8",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/notaryproject/specifications/commit/cdabdd1042de2999c685fa5d422a785ded9c983a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/notaryproject/specifications/security/advisories/GHSA-57wx-m636-g3g8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.513118",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "specifications",
    "owner": "notaryproject",
    "created_at": "2020-01-13T17:30:45Z",
    "updated_at": "2025-01-08T16:39:39Z",
    "pushed_at": "2025-01-08T16:39:34Z",
    "size": 2334,
    "stars": 160,
    "forks": 44,
    "open_issues": 16,
    "watchers": 160,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {},
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:58:02.691284"
  }
}