{
  "cve_id": "CVE-2024-23341",
  "github_data": {
    "repository": "i3thuan5/TuiTse-TsuSin",
    "fix_commit": "9d21d99d7cfcd7c42aade251fab98ec102e730ea",
    "related_commits": [
      "9d21d99d7cfcd7c42aade251fab98ec102e730ea",
      "9d21d99d7cfcd7c42aade251fab98ec102e730ea"
    ],
    "patch_url": "https://github.com/i3thuan5/TuiTse-TsuSin/commit/9d21d99d7cfcd7c42aade251fab98ec102e730ea.patch",
    "fix_commit_details": {
      "sha": "9d21d99d7cfcd7c42aade251fab98ec102e730ea",
      "commit_date": "2024-01-16T01:45:16Z",
      "author": {
        "login": "a8568730",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #22 from i3thuan5/siu-tua-kuaho",
        "length": 59,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 56,
        "additions": 40,
        "deletions": 16
      },
      "files": [
        {
          "filename": "test/test_tuitse_tsinghap.py",
          "status": "added",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -0,0 +1,14 @@\n+from django.test.testcases import TestCase\n+\n+from tuitse import kiamtsa\n+from tuitse.html import tuitse_html\n+\n+\n+class TuaLiongTuiTse(TestCase):\n+\n+    def test_tuitse(self):\n+        tsusin = kiamtsa(\n+            '\u505a\u4ee3\u8a8c\u611b\u50cf\u8d70{<\u83ef><\u99ac\u62c9\u677e>\uff0c\u6c93\u6c93\u4ed4\u4f86\u3002',\n+            'ts\u00f2 t\u0101i-ts\u00ec \u00e0i tshi\u016bnn ts\u00e1u <\u83ef><\u99ac\u62c9\u677e> k\u0101ng-khu\u00e1n, ta\u030duh-ta\u030duh-\u00e1 l\u00e2i.',\n+        )\n+        tuitse_html(tsusin)"
        },
        {
          "filename": "tuitse/html.py",
          "status": "modified",
          "additions": 26,
          "deletions": 16,
          "patch": "@@ -5,7 +5,9 @@\n \n def tuitse_html(kiamtsa_tinliat):\n     html = ''\n-    htmlsu = ''\n+    tshamsoo = []\n+    su_html = ''\n+    su_tshamsoo = []\n     kam_ting_tsit_hing_si_lomaji = False\n     kam_ting_tsit_im_si_lomaji = False\n     for ji in kiamtsa_tinliat:\n@@ -31,10 +33,11 @@ def tuitse_html(kiamtsa_tinliat):\n \n         if ji[2] == THAU_JI:\n             # Th\u00f2o s\u00fb \u00ea html\n-            if htmlsu:\n-                html += \"<ruby>{}</ruby>\".format(htmlsu)\n+            if su_html:\n+                html += \"<ruby>{}</ruby>\".format(su_html)\n+                tshamsoo += su_tshamsoo\n             # Html t\u00eeng-l\u00e2i\n-            htmlsu = _sng_ji_html(ji)\n+            su_html, su_tshamsoo = _sng_ji_html(ji)\n             continue\n \n         if ji[2] == LIAN_JI:\n@@ -45,26 +48,33 @@ def tuitse_html(kiamtsa_tinliat):\n             raise RuntimeError('\u4e00\u5b9a\u611b\u8a2d\u5b9a\u982d\u5b57\u3001\u9023\u5b57\u3001a\u030dh-s\u012b\u8f15\u8072')\n \n         if kam_im_ai_lian:\n-            htmlsu += \"<rb>{}</rb>\".format(tiauhu)\n+            su_html += \"<rb>{}</rb>\"\n+            su_tshamsoo.append(tiauhu)\n         else:\n-            htmlsu += \"<rb>&nbsp;</rb>\"\n+            su_html += \"<rb>&nbsp;</rb>\"\n \n         if kam_hing_ai_lian:\n-            htmlsu += \"<rt>{}</rt>\".format(tiauhu)\n+            su_html += \"<rt>{}</rt>\"\n+            su_tshamsoo.append(tiauhu)\n         else:\n-            htmlsu += \"<rt></rt>\"\n+            su_html += \"<rt></rt>\"\n \n-        htmlsu += _sng_ji_html(ji)\n+        sng_html, sng_tshamsoo = _sng_ji_html(ji)\n+        su_html += sng_html\n+        su_tshamsoo += sng_tshamsoo\n     # Th\u00f2o bu\u00e9 s\u00fb \u00ea html\n-    html += \"<ruby>{}</ruby>\".format(htmlsu)\n-    return format_html(html)\n+    html += \"<ruby>{}</ruby>\".format(su_html)\n+    tshamsoo += su_tshamsoo\n+    return format_html(html, *tshamsoo)\n \n \n def _sng_ji_html(ji):\n     if ji[3]:\n-        return \"<rb>{}</rb><rt>{}</rt>\".format(ji[1], ji[0])\n+        return \"<rb>{}</rb><rt>{}</rt>\", [ji[1], ji[0]]\n     if ji[1]:\n-        return \"<rb class='fail'>{}</rb><rt class='fail'>{}</rt>\".format(\n-            ji[1], ji[0])\n-    return \"<rb class='fail'>&nbsp;&nbsp;</rb><rt class='fail'>{}</rt>\".format(\n-        ji[0])\n+        return \"<rb class='fail'>{}</rb><rt class='fail'>{}</rt>\", [\n+            ji[1], ji[0]\n+        ]\n+    return \"<rb class='fail'>&nbsp;&nbsp;</rb><rt class='fail'>{}</rt>\", [\n+        ji[0]\n+    ]"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8770fd3f25789628caf1e4d3d3242c0e7b9ee90f",
            "date": "2024-01-19T00:44:14Z",
            "author_login": "a8568730"
          },
          {
            "sha": "d2db3483529b0a9273bcb05ac880eb927b8e1a29",
            "date": "2024-01-19T00:40:37Z",
            "author_login": "sih4sing5hong5"
          },
          {
            "sha": "54242991b44d4a4a15520f368e48b4ed585c4344",
            "date": "2024-01-19T00:33:25Z",
            "author_login": "a8568730"
          },
          {
            "sha": "44ddacb2c160d6a881676ca9d3ebf3737be685a7",
            "date": "2024-01-19T00:29:57Z",
            "author_login": "sih4sing5hong5"
          },
          {
            "sha": "db7847e97195e0262f929fa3ec79549e6b9147e6",
            "date": "2024-01-17T07:19:30Z",
            "author_login": "a8568730"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "TuiTse-TsuSin is a package for organizing the comparative corpus of Taiwanese Chinese characters and Roman characters, and extracting sentences of the Taiwanese Chinese characters and the Roman characters. Prior to version 1.3.2, when using `tuitse_html` without quoting the input, there is a html injection vulnerability. Version 1.3.2 contains a patch for the issue. As a workaround, sanitize Taigi input with HTML quotation.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-23T18:15:19.250",
    "last_modified": "2024-11-21T08:57:32.787",
    "fix_date": "2024-01-16T01:45:16Z"
  },
  "references": [
    {
      "url": "https://github.com/i3thuan5/TuiTse-TsuSin/commit/9d21d99d7cfcd7c42aade251fab98ec102e730ea",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/i3thuan5/TuiTse-TsuSin/pull/22",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/i3thuan5/TuiTse-TsuSin/security/advisories/GHSA-m4m5-j36m-8x72",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/i3thuan5/TuiTse-TsuSin/commit/9d21d99d7cfcd7c42aade251fab98ec102e730ea",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/i3thuan5/TuiTse-TsuSin/pull/22",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/i3thuan5/TuiTse-TsuSin/security/advisories/GHSA-m4m5-j36m-8x72",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.521995",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "TuiTse-TsuSin",
    "owner": "i3thuan5",
    "created_at": "2020-01-04T06:04:53Z",
    "updated_at": "2023-01-07T01:37:58Z",
    "pushed_at": "2024-01-22T06:29:57Z",
    "size": 116,
    "stars": 0,
    "forks": 0,
    "open_issues": 3,
    "watchers": 0,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 37956
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:39:48.925149"
  }
}