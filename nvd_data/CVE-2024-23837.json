{
  "cve_id": "CVE-2024-23837",
  "github_data": {
    "repository": "OISF/libhtp",
    "fix_commit": "20ac301d801cdf01b3f021cca08a22a87f477c4a",
    "related_commits": [
      "20ac301d801cdf01b3f021cca08a22a87f477c4a",
      "20ac301d801cdf01b3f021cca08a22a87f477c4a"
    ],
    "patch_url": "https://github.com/OISF/libhtp/commit/20ac301d801cdf01b3f021cca08a22a87f477c4a.patch",
    "fix_commit_details": {
      "sha": "20ac301d801cdf01b3f021cca08a22a87f477c4a",
      "commit_date": "2023-11-08T08:42:50Z",
      "author": {
        "login": "catenacyber",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "headers: limit the size of folded headers",
        "length": 155,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 19,
        "deletions": 8
      },
      "files": [
        {
          "filename": "htp/htp_private.h",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -262,5 +262,8 @@ size_t strlcpy(char *dst, const char *src, size_t size);\n }\n #endif\n \n+// as CURL_MAX_HTTP_HEADER\n+#define HTP_MAX_HEADER_FOLDED 102400\n+\n #endif\t/* _HTP_PRIVATE_H */\n "
        },
        {
          "filename": "htp/htp_request.c",
          "status": "modified",
          "additions": 8,
          "deletions": 4,
          "patch": "@@ -714,10 +714,14 @@ htp_status_t htp_connp_REQ_HEADERS(htp_connp_t *connp) {\n                     connp->in_header = bstr_dup_mem(data + trim, len - trim);\n                     if (connp->in_header == NULL) return HTP_ERROR;\n                 } else {\n-                    // Add to the existing header.                    \n-                    bstr *new_in_header = bstr_add_mem(connp->in_header, data, len);\n-                    if (new_in_header == NULL) return HTP_ERROR;\n-                    connp->in_header = new_in_header;\n+                    // Add to the existing header.\n+                    if (bstr_len(connp->in_header) < HTP_MAX_HEADER_FOLDED) {\n+                        bstr *new_in_header = bstr_add_mem(connp->in_header, data, len);\n+                        if (new_in_header == NULL) return HTP_ERROR;\n+                        connp->in_header = new_in_header;\n+                    } else {\n+                        htp_log(connp, HTP_LOG_MARK, HTP_LOG_WARNING, 0, \"Request field length exceeds folded maximum\");\n+                    }\n                 }\n             }\n "
        },
        {
          "filename": "htp/htp_response.c",
          "status": "modified",
          "additions": 8,
          "deletions": 4,
          "patch": "@@ -978,10 +978,14 @@ htp_status_t htp_connp_RES_HEADERS(htp_connp_t *connp) {\n                             return HTP_ERROR;\n                     } else {\n                         // Add to the existing header.\n-                        bstr *new_out_header = bstr_add_mem(connp->out_header, data, len);\n-                        if (new_out_header == NULL)\n-                            return HTP_ERROR;\n-                        connp->out_header = new_out_header;\n+                        if (bstr_len(connp->out_header) < HTP_MAX_HEADER_FOLDED) {\n+                            bstr *new_out_header = bstr_add_mem(connp->out_header, data, len);\n+                            if (new_out_header == NULL)\n+                                return HTP_ERROR;\n+                            connp->out_header = new_out_header;\n+                        } else {\n+                            htp_log(connp, HTP_LOG_MARK, HTP_LOG_WARNING, 0, \"Response field length exceeds folded maximum\");\n+                        }\n                     }\n                 }\n             }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "46b43fd75382d0aad3edfd13048cfef2906f6459",
            "date": "2024-12-18T09:22:42Z",
            "author_login": "victorjulien"
          },
          {
            "sha": "b28eadc5fa6c51fec6079b106824a11b461fc4ee",
            "date": "2024-09-30T12:38:27Z",
            "author_login": "inashivb"
          },
          {
            "sha": "0d550de551b91d5e57ba23e2b1e2c6430fad6818",
            "date": "2024-08-12T12:06:40Z",
            "author_login": "catenacyber"
          },
          {
            "sha": "09d8110ffd984fb7b469e0ab96ecea22581aa3f8",
            "date": "2024-08-12T06:42:04Z",
            "author_login": "inashivb"
          },
          {
            "sha": "ce25f9ebc17590356ca79851c0bd7d7fd287da53",
            "date": "2024-08-13T06:00:19Z",
            "author_login": "inashivb"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-770",
    "description": "LibHTP is a security-aware parser for the HTTP protocol. Crafted traffic can cause excessive processing time of HTTP headers, leading to denial of service. This issue is addressed in 0.5.46.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-26T16:27:57.897",
    "last_modified": "2024-11-21T08:58:31.960",
    "fix_date": "2023-11-08T08:42:50Z"
  },
  "references": [
    {
      "url": "https://github.com/OISF/libhtp/commit/20ac301d801cdf01b3f021cca08a22a87f477c4a",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/OISF/libhtp/security/advisories/GHSA-f9wf-rrjj-qx8m",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://redmine.openinfosecfoundation.org/issues/6444",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/OISF/libhtp/commit/20ac301d801cdf01b3f021cca08a22a87f477c4a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/OISF/libhtp/security/advisories/GHSA-f9wf-rrjj-qx8m",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GOCOBFUTIFHOP2PZOH4ENRFXRBHIRKK4/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZXJIT7R53ZXROO3I256RFUWTIW4ECK6P/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://redmine.openinfosecfoundation.org/issues/6444",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.160104",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "libhtp",
    "owner": "OISF",
    "created_at": "2011-02-05T01:07:35Z",
    "updated_at": "2025-01-06T11:05:07Z",
    "pushed_at": "2024-12-20T06:59:25Z",
    "size": 10639,
    "stars": 293,
    "forks": 116,
    "open_issues": 10,
    "watchers": 293,
    "has_security_policy": false,
    "default_branch": "0.5.x",
    "protected_branches": [
      "0.5.x"
    ],
    "languages": {
      "C++": 1380964,
      "C": 936234,
      "M4": 60739,
      "Raku": 25485,
      "Ruby": 10480,
      "PHP": 7792,
      "Makefile": 4407,
      "Shell": 712,
      "Python": 506,
      "Perl": 280
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T17:27:06.047085"
  }
}