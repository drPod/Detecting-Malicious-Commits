{
  "cve_id": "CVE-2024-23840",
  "github_data": {
    "repository": "goreleaser/goreleaser",
    "fix_commit": "d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0",
    "related_commits": [
      "d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0",
      "d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0"
    ],
    "patch_url": "https://github.com/goreleaser/goreleaser/commit/d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0.patch",
    "fix_commit_details": {
      "sha": "d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0",
      "commit_date": "2024-01-29T23:53:46Z",
      "author": {
        "login": "caarlos0",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-h3q2-8whx-c29h",
        "length": 199,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 1,
        "deletions": 4
      },
      "files": [
        {
          "filename": "internal/exec/exec.go",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -86,7 +86,6 @@ func executePublisher(ctx *context.Context, publisher config.Publisher) error {\n \n func executeCommand(c *command, artifact *artifact.Artifact) error {\n \tlog.WithField(\"args\", c.Args).\n-\t\tWithField(\"env\", c.Env).\n \t\tWithField(\"artifact\", artifact.Name).\n \t\tDebug(\"executing command\")\n "
        },
        {
          "filename": "internal/pipe/sbom/sbom.go",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -201,8 +201,7 @@ func catalogArtifact(ctx *context.Context, cfg config.SBOM, a *artifact.Artifact\n \tcmd.Env = append(cmd.Env, envs...)\n \tcmd.Dir = ctx.Config.Dist\n \n-\tlog.WithField(\"env\", cmd.Env).\n-\t\tWithField(\"dir\", cmd.Dir).\n+\tlog.WithField(\"dir\", cmd.Dir).\n \t\tWithField(\"cmd\", cmd.Args).\n \t\tDebug(\"running\")\n "
        },
        {
          "filename": "internal/shell/shell.go",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -18,7 +18,6 @@ import (\n func Run(ctx *context.Context, dir string, command, env []string, output bool) error {\n \tlog := log.\n \t\tWithField(\"cmd\", command).\n-\t\tWithField(\"env\", env).\n \t\tWithField(\"dir\", dir)\n \n \t/* #nosec */"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8258df58bdd4a15f95f0be478eac1f1b00e134c6",
            "date": "2025-01-14T13:22:40Z",
            "author_login": "caarlos0"
          },
          {
            "sha": "bdc2b759e9f106d32a57164b62ffe0e7521938a5",
            "date": "2025-01-14T13:21:54Z",
            "author_login": "caarlos0"
          },
          {
            "sha": "76043f207cd68df00d1893c92f5d4482aac320b4",
            "date": "2025-01-14T01:21:28Z",
            "author_login": "caarlos0"
          },
          {
            "sha": "42c0b0f5598cb763a2d654f358d2b04e96598f57",
            "date": "2025-01-14T01:13:25Z",
            "author_login": "caarlos0"
          },
          {
            "sha": "5b3afc4935c4efedbd905cf66a2378769ebc914a",
            "date": "2025-01-13T23:46:40Z",
            "author_login": "caarlos0"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-532",
    "description": "GoReleaser builds Go binaries for several platforms, creates a GitHub release and then pushes a Homebrew formula to a tap repository. `goreleaser release --debug` log shows secret values used in the in the custom publisher. This vulnerability is fixed in 1.24.0.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-01-30T17:15:11.810",
    "last_modified": "2024-11-21T08:58:32.393",
    "fix_date": "2024-01-29T23:53:46Z"
  },
  "references": [
    {
      "url": "https://github.com/goreleaser/goreleaser/commit/d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/goreleaser/goreleaser/security/advisories/GHSA-h3q2-8whx-c29h",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/goreleaser/goreleaser/commit/d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/goreleaser/goreleaser/security/advisories/GHSA-h3q2-8whx-c29h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.550432",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "goreleaser",
    "owner": "goreleaser",
    "created_at": "2016-12-21T17:13:39Z",
    "updated_at": "2025-01-14T13:22:48Z",
    "pushed_at": "2025-01-14T13:22:45Z",
    "size": 22192,
    "stars": 14106,
    "forks": 957,
    "open_issues": 25,
    "watchers": 14106,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 1790296,
      "HTML": 10912,
      "Nix": 5147,
      "Shell": 4592,
      "Ruby": 4439,
      "Python": 2770,
      "Dockerfile": 679
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:52:38.291387"
  }
}