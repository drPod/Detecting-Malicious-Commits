{
  "cve_id": "CVE-2024-24043",
  "github_data": {
    "repository": "Speedy11CZ/mcrpx",
    "fix_commit": "02ca6d1fd851567560046766ac9d04d20db35b8e",
    "related_commits": [
      "02ca6d1fd851567560046766ac9d04d20db35b8e",
      "02ca6d1fd851567560046766ac9d04d20db35b8e"
    ],
    "patch_url": "https://github.com/Speedy11CZ/mcrpx/commit/02ca6d1fd851567560046766ac9d04d20db35b8e.patch",
    "fix_commit_details": {
      "sha": "02ca6d1fd851567560046766ac9d04d20db35b8e",
      "commit_date": "2024-01-15T09:06:53Z",
      "author": {
        "login": "Speedy11CZ",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Hotfix for path traversal vulnerability",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
      },
      "files": [
        {
          "filename": "common/src/main/java/cz/speedy11/mcrpx/common/util/ZipUtil.java",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -99,6 +99,11 @@ public static void extractZip(File file, File destDirectory, ExtractTaskListener\n             int elementCount = 0;\n             while (zipEntries.hasMoreElements()) {\n                 ZipEntry zipEntry = zipEntries.nextElement();\n+                if (zipEntry.getName().contains(\"..\")) {\n+                    listener.onMessage(\"Skipping \" + zipEntry.getName() + \": Invalid path\");\n+                    continue;\n+                }\n+\n                 try {\n                     listener.onMessage(\"Extracting \" + zipEntry.getName());\n                     try (InputStream entryInputStream = zipFile.getInputStream(zipEntry)) {\n@@ -141,6 +146,11 @@ public static void extractMinecraft(File file, File destDirectory, ExtractTaskLi\n             int elementCount = 0;\n             while (jarEntries.hasMoreElements()) {\n                 JarEntry jarEntry = jarEntries.nextElement();\n+                if (jarEntry.getName().contains(\"..\")) {\n+                    listener.onMessage(\"Skipping \" + jarEntry.getName() + \": Invalid path\");\n+                    continue;\n+                }\n+\n                 if (jarEntry.getName().startsWith(\"assets/\") && !jarEntry.isDirectory()) {\n                     listener.onMessage(\"Extracting \" + jarEntry.getName());\n                     try (InputStream entryInputStream = jarFile.getInputStream(jarEntry)) {"
        },
        {
          "filename": "gradle.properties",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,6 +1,6 @@\n # Project properties\n-projectDescription=Core library for plugins used by ketchup plugins, developed by Rajce.pro.\n-projectVersion=1.4.0\n+projectDescription=MCRPX is a tool to extract files from Minecraft: Java Edition resource packs into selected directory. It can also bypass corrupted resource packs, used by servers to protect their resource packs.\n+projectVersion=1.4.1\n # Gradle properties\n org.gradle.daemon=true\n org.gradle.configureondemand=true"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "02ca6d1fd851567560046766ac9d04d20db35b8e",
            "date": "2024-01-15T09:06:53Z",
            "author_login": "Speedy11CZ"
          },
          {
            "sha": "020a6ad9444a39ccfc2e62afdce1bd21d439c85b",
            "date": "2023-10-18T10:19:27Z",
            "author_login": "Speedy11CZ"
          },
          {
            "sha": "2eae0ca02d726ac613a3040c155d431bd5815625",
            "date": "2023-09-21T23:15:12Z",
            "author_login": "Speedy11CZ"
          },
          {
            "sha": "5274f3b83e1bf8086ca681a68c8c499450173120",
            "date": "2023-09-21T23:07:46Z",
            "author_login": "Speedy11CZ"
          },
          {
            "sha": "bab2ce6e9e1047b0bf17e25ece65adc3e1831f07",
            "date": "2023-02-22T17:16:21Z",
            "author_login": "Speedy11CZ"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "Directory Traversal vulnerability in Speedy11CZ MCRPX v.1.4.0 and before allows a local attacker to execute arbitrary code via a crafted file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-19T07:15:09.517",
    "last_modified": "2024-11-21T08:58:52.403",
    "fix_date": "2024-01-15T09:06:53Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/apple502j/193358682885fe1a6708309ce934e4ed",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Speedy11CZ/mcrpx/commit/02ca6d1fd851567560046766ac9d04d20db35b8e",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Speedy11CZ/mcrpx/releases/tag/v1.4.1",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://gist.github.com/apple502j/193358682885fe1a6708309ce934e4ed",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Speedy11CZ/mcrpx/commit/02ca6d1fd851567560046766ac9d04d20db35b8e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Speedy11CZ/mcrpx/releases/tag/v1.4.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.517810",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mcrpx",
    "owner": "Speedy11CZ",
    "created_at": "2022-09-16T18:41:03Z",
    "updated_at": "2025-01-03T17:13:55Z",
    "pushed_at": "2024-01-15T09:08:41Z",
    "size": 109,
    "stars": 80,
    "forks": 2,
    "open_issues": 3,
    "watchers": 80,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Java": 47625
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:25:37.006340"
  }
}