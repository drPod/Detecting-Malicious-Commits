{
  "cve_id": "CVE-2024-24474",
  "github_data": {
    "repository": "qemu/qemu",
    "fix_commit": "77668e4b9bca03a856c27ba899a2513ddf52bb52",
    "related_commits": [
      "77668e4b9bca03a856c27ba899a2513ddf52bb52",
      "77668e4b9bca03a856c27ba899a2513ddf52bb52"
    ],
    "patch_url": "https://github.com/qemu/qemu/commit/77668e4b9bca03a856c27ba899a2513ddf52bb52.patch",
    "fix_commit_details": {
      "sha": "77668e4b9bca03a856c27ba899a2513ddf52bb52",
      "commit_date": "2023-09-13T20:44:09Z",
      "author": {
        "login": "mcayland",
        "type": "User",
        "stats": {
          "total_commits": 1115,
          "average_weekly_commits": 1.3385354141656662,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 182
        }
      },
      "commit_message": {
        "title": "esp: restrict non-DMA transfer length to that of available data",
        "length": 911,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "hw/scsi/esp.c",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -759,7 +759,8 @@ static void esp_do_nodma(ESPState *s)\n     }\n \n     if (to_device) {\n-        len = MIN(fifo8_num_used(&s->fifo), ESP_FIFO_SZ);\n+        len = MIN(s->async_len, ESP_FIFO_SZ);\n+        len = MIN(len, fifo8_num_used(&s->fifo));\n         esp_fifo_pop_buf(&s->fifo, s->async_buf, len);\n         s->async_buf += len;\n         s->async_len -= len;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e8aa7fdcddfc8589bdc7c973a052e76e8f999455",
            "date": "2025-01-13T14:43:48Z",
            "author_login": "stefanhaRH"
          },
          {
            "sha": "435d260e7ec5ff9c79e3e62f1d66ec82d2d691ae",
            "date": "2025-01-13T12:35:35Z",
            "author_login": "pbo-linaro"
          },
          {
            "sha": "132f8ec799cea261ad6b60ac8ae86f17cc98b9a1",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pbo-linaro"
          },
          {
            "sha": "39d70016d9abe15967f7051741dd5621c659b1f4",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pm215"
          },
          {
            "sha": "86a00f2046f5f5b613bdf18d6c972b495a907c37",
            "date": "2025-01-13T12:35:34Z",
            "author_login": "pbo-linaro"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-120",
    "description": "QEMU before 8.2.0 has an integer underflow, and resultant buffer overflow, via a TI command when an expected non-DMA transfer length is less than the length of the available FIFO data. This occurs in esp_do_nodma in hw/scsi/esp.c because of an underflow of async_len.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-20T18:15:52.463",
    "last_modified": "2024-11-21T08:59:18.777",
    "fix_date": "2023-09-13T20:44:09Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/1047524396/5ce07b9d387095c276b1cd234ae5615e",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/qemu/qemu/commit/77668e4b9bca03a856c27ba899a2513ddf52bb52",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://gitlab.com/qemu-project/qemu/-/issues/1810",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240510-0012/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://gist.github.com/1047524396/5ce07b9d387095c276b1cd234ae5615e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/qemu/qemu/commit/77668e4b9bca03a856c27ba899a2513ddf52bb52",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://gitlab.com/qemu-project/qemu/-/issues/1810",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240510-0012/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.138097",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "qemu",
    "owner": "qemu",
    "created_at": "2012-08-11T21:48:37Z",
    "updated_at": "2025-01-14T15:30:43Z",
    "pushed_at": "2025-01-13T16:01:34Z",
    "size": 597325,
    "stars": 10728,
    "forks": 5703,
    "open_issues": 0,
    "watchers": 10728,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C": 72752071,
      "C++": 10865548,
      "Python": 3771166,
      "Shell": 1394621,
      "Assembly": 661208,
      "Meson": 485678,
      "Haxe": 351509,
      "Perl": 223220,
      "Rust": 153760,
      "Objective-C": 153251,
      "Makefile": 107378,
      "Pawn": 50592,
      "SmPL": 33510,
      "Yacc": 29612,
      "Lex": 23760,
      "NSIS": 6939,
      "DenizenScript": 2931,
      "Dockerfile": 1012,
      "GLSL": 585,
      "GDB": 326,
      "Vim Script": 220,
      "Emacs Lisp": 75
    },
    "commit_activity": {
      "total_commits_last_year": 6588,
      "avg_commits_per_week": 126.6923076923077,
      "days_active_last_year": 335
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:49:13.645950"
  }
}