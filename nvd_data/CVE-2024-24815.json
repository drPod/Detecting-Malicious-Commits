{
  "cve_id": "CVE-2024-24815",
  "github_data": {
    "repository": "ckeditor/ckeditor4",
    "fix_commit": "8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb",
    "related_commits": [
      "8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb",
      "8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb",
      "commit_date": "2024-01-16T12:47:10Z",
      "author": {
        "login": "jacekbogdanski",
        "type": "User",
        "stats": {
          "total_commits": 1559,
          "average_weekly_commits": 2.153314917127072,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 191
        }
      },
      "commit_message": {
        "title": "Merge commit",
        "length": 12,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 774,
        "additions": 662,
        "deletions": 112
      },
      "files": [
        {
          "filename": "core/htmlparser.js",
          "status": "modified",
          "additions": 20,
          "deletions": 15,
          "patch": "@@ -121,10 +121,7 @@ CKEDITOR.htmlParser = function() {\n \t\t\t\tif ( tagIndex > nextIndex ) {\n \t\t\t\t\tvar text = html.substring( nextIndex, tagIndex );\n \n-\t\t\t\t\tif ( cdata )\n-\t\t\t\t\t\tcdata.push( text );\n-\t\t\t\t\telse\n-\t\t\t\t\t\tthis.onText( text );\n+\t\t\t\t\tthis.onText( text );\n \t\t\t\t}\n \n \t\t\t\tnextIndex = this._.htmlPartsRegex.lastIndex;\n@@ -142,7 +139,7 @@ CKEDITOR.htmlParser = function() {\n \n \t\t\t\t\tif ( cdata && CKEDITOR.dtd.$cdata[ tagName ] ) {\n \t\t\t\t\t\t// Send the CDATA data.\n-\t\t\t\t\t\tthis.onCDATA( cdata.join( '' ) );\n+\t\t\t\t\t\tthis.onCDATA( cdata );\n \t\t\t\t\t\tcdata = null;\n \t\t\t\t\t}\n \n@@ -152,20 +149,15 @@ CKEDITOR.htmlParser = function() {\n \t\t\t\t\t}\n \t\t\t\t}\n \n-\t\t\t\t// If CDATA is enabled, just save the raw match.\n-\t\t\t\tif ( cdata ) {\n-\t\t\t\t\tcdata.push( parts[ 0 ] );\n-\t\t\t\t\tcontinue;\n-\t\t\t\t}\n-\n \t\t\t\t// Opening tag\n \t\t\t\tif ( ( tagName = parts[ 3 ] ) ) {\n \t\t\t\t\ttagName = tagName.toLowerCase();\n \n \t\t\t\t\t// There are some tag names that can break things, so let's\n \t\t\t\t\t// simply ignore them when parsing. (https://dev.ckeditor.com/ticket/5224)\n-\t\t\t\t\tif ( /=\"/.test( tagName ) )\n+\t\t\t\t\tif ( /=\"/.test( tagName ) ) {\n \t\t\t\t\t\tcontinue;\n+\t\t\t\t\t}\n \n \t\t\t\t\tvar attribs = {},\n \t\t\t\t\t\tattribMatch,\n@@ -186,9 +178,22 @@ CKEDITOR.htmlParser = function() {\n \n \t\t\t\t\tthis.onTagOpen( tagName, attribs, selfClosing );\n \n-\t\t\t\t\t// Open CDATA mode when finding the appropriate tags.\n-\t\t\t\t\tif ( !cdata && CKEDITOR.dtd.$cdata[ tagName ] )\n-\t\t\t\t\t\tcdata = [];\n+\t\t\t\t\t// CDATA\n+\t\t\t\t\tif ( CKEDITOR.dtd.$cdata[ tagName ] ) {\n+\t\t\t\t\t\tvar closingTagRegex = new RegExp( '<\\/' + tagName + '>', 'i' ),\n+\t\t\t\t\t\t\thtmlPart = html.substring( nextIndex ),\n+\t\t\t\t\t\t\tclosingTagIndex = htmlPart.search( closingTagRegex );\n+\n+\t\t\t\t\t\t// If closing tag was not found, treat all remaining text as CDATA.\n+\t\t\t\t\t\tif ( closingTagIndex === -1 ) {\n+\t\t\t\t\t\t\tclosingTagIndex = htmlPart.length;\n+\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\tcdata = htmlPart.substring( 0, closingTagIndex );\n+\n+\t\t\t\t\t\tthis._.htmlPartsRegex.lastIndex = nextIndex + cdata.length;\n+\t\t\t\t\t\tnextIndex = this._.htmlPartsRegex.lastIndex;\n+\t\t\t\t\t}\n \n \t\t\t\t\tcontinue;\n \t\t\t\t}"
        },
        {
          "filename": "plugins/autogrow/samples/autogrow.html",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -64,6 +64,28 @@ <h1 class=\"samples\">\n \t\t\t<script>\n \n \t\t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\t\tplugins: [\n+\t\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t\t'clipboard',\n+\t\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t\t'undo',\n+\t\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t\t'format',\n+\t\t\t\t\t\t'font',\n+\t\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t\t'removeformat',\n+\t\t\t\t\t\t'link',\n+\t\t\t\t\t\t'list',\n+\t\t\t\t\t\t'justify',\n+\t\t\t\t\t\t'blockquote',\n+\t\t\t\t\t\t'table',\n+\t\t\t\t\t\t'tabletools',\n+\t\t\t\t\t\t'image'\n+\t\t\t\t\t],\n \t\t\t\t\textraPlugins: 'autogrow',\n \t\t\t\t\tremovePlugins: 'resize'\n \t\t\t\t});"
        },
        {
          "filename": "plugins/devtools/samples/devtools.html",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -64,6 +64,28 @@ <h1 class=\"samples\">\n \t\t\t\t// Replace the <textarea id=\"editor\"> with an CKEditor\n \t\t\t\t// instance, using default configurations.\n \t\t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\t\tplugins: [\n+\t\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t\t'clipboard',\n+\t\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t\t'undo',\n+\t\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t\t'format',\n+\t\t\t\t\t\t'font',\n+\t\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t\t'removeformat',\n+\t\t\t\t\t\t'link',\n+\t\t\t\t\t\t'list',\n+\t\t\t\t\t\t'justify',\n+\t\t\t\t\t\t'blockquote',\n+\t\t\t\t\t\t'table',\n+\t\t\t\t\t\t'tabletools',\n+\t\t\t\t\t\t'image'\n+\t\t\t\t\t],\n \t\t\t\t\textraPlugins: 'devtools'\n \t\t\t\t});\n "
        },
        {
          "filename": "plugins/divarea/samples/divarea.html",
          "status": "modified",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -43,6 +43,27 @@ <h1 class=\"samples\">\n \t\t\t// Replace the <textarea id=\"editor\"> with an CKEditor\n \t\t\t// instance, using default configurations.\n \t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t'format',\n+\t\t\t\t\t'font',\n+\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t'removeformat',\n+\t\t\t\t\t'link',\n+\t\t\t\t\t'list',\n+\t\t\t\t\t'justify',\n+\t\t\t\t\t'blockquote',\n+\t\t\t\t\t'table',\n+\t\t\t\t\t'tabletools',\n+\t\t\t\t\t'image'\n+\t\t\t\t],\n \t\t\t\textraPlugins: 'divarea'\n \t\t\t});\n "
        },
        {
          "filename": "plugins/docprops/samples/docprops.html",
          "status": "modified",
          "additions": 15,
          "deletions": 10,
          "patch": "@@ -34,18 +34,13 @@ <h1 class=\"samples\">\n <pre class=\"samples\">\n CKEDITOR.replace( '<em>textarea_id</em>', {\n \t<strong>fullPage: true</strong>,\n-\t<strong>extraPlugins: 'docprops'</strong>,\n-\t<strong>allowedContent: true</strong>\n-});\n+\t<strong>extraPlugins: 'docprops'</strong>\n+} );\n </pre>\n \t\t<p>\n \t\t\tNote that <code><em>textarea_id</em></code> in the code above is the <code>id</code> attribute of\n \t\t\tthe <code>&lt;textarea&gt;</code> element to be replaced.\n \t\t</p>\n-\t\t<p>\n-\t\t\tThe <code><em>allowedContent</em></code> in the code above is set to <code>true</code> to disable content filtering.\n-\t\t\tSetting this option is not obligatory, but in full page mode there is a strong chance that one may want be able to freely enter any HTML content in source mode without any limitations.\n-\t\t</p>\n \t</div>\n \t<form action=\"../../../samples/sample_posteddata.php\" method=\"post\">\n \t\t<label for=\"editor1\">\n@@ -59,9 +54,19 @@ <h1 class=\"samples\">\n \n \t\t\tCKEDITOR.replace( 'editor1', {\n \t\t\t\tfullPage: true,\n-\t\t\t\textraPlugins: 'docprops',\n-\t\t\t\tallowedContent: true\n-\t\t\t});\n+\t\t\t\textraPlugins: 'docprops, wysiwygarea',\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} );\n \n \t\t</script>\n \t\t<p>"
        },
        {
          "filename": "plugins/enterkey/samples/enterkey.html",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -24,6 +24,28 @@\n \n \t\t\t// Create the editor again, with the appropriate settings.\n \t\t\teditor = CKEDITOR.replace( 'editor1', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t'format',\n+\t\t\t\t\t'font',\n+\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t'removeformat',\n+\t\t\t\t\t'link',\n+\t\t\t\t\t'list',\n+\t\t\t\t\t'justify',\n+\t\t\t\t\t'blockquote',\n+\t\t\t\t\t'table',\n+\t\t\t\t\t'tabletools',\n+\t\t\t\t\t'image'\n+\t\t\t\t],\n \t\t\t\textraPlugins: 'enterkey',\n \t\t\t\tenterMode: Number( document.getElementById( 'xEnter' ).value ),\n \t\t\t\tshiftEnterMode: Number( document.getElementById( 'xShiftEnter' ).value )"
        },
        {
          "filename": "plugins/htmlwriter/samples/outputhtml.html",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -147,7 +147,9 @@ <h1 class=\"samples\">\n \t\t\t\t\ton: {\n \t\t\t\t\t\tpluginsLoaded: configureTransformations,\n \t\t\t\t\t\tloaded: configureHtmlWriter\n-\t\t\t\t\t}\n+\t\t\t\t\t},\n+\n+\t\t\t\t\tremovePlugins: 'preview, print'\n \t\t\t\t});\n \n \t\t\t\t/*"
        },
        {
          "filename": "plugins/image2/samples/image2.html",
          "status": "modified",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -49,6 +49,27 @@ <h1 class=\"samples\">\n \t<script>\n \n \t\tCKEDITOR.replace( 'editor1', {\n+\t\t\tplugins: [\n+\t\t\t\t'wysiwygarea',\n+\t\t\t\t'sourcearea',\n+\t\t\t\t'clipboard',\n+\t\t\t\t'basicstyles',\n+\t\t\t\t'pastefromword',\n+\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t'pastefromgdocs',\n+\t\t\t\t'undo',\n+\t\t\t\t'stylescombo',\n+\t\t\t\t'format',\n+\t\t\t\t'font',\n+\t\t\t\t'colorbutton',\n+\t\t\t\t'removeformat',\n+\t\t\t\t'link',\n+\t\t\t\t'list',\n+\t\t\t\t'justify',\n+\t\t\t\t'blockquote',\n+\t\t\t\t'table',\n+\t\t\t\t'tabletools'\n+\t\t\t],\n \t\t\textraPlugins: 'image2',\n \t\t\theight: 450\n \t\t} );"
        },
        {
          "filename": "plugins/magicline/samples/magicline.html",
          "status": "modified",
          "additions": 48,
          "deletions": 4,
          "patch": "@@ -106,9 +106,31 @@ <h1 class=\"samples\">\n \t\t\t// window.onload event handler.\n \n \t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t'format',\n+\t\t\t\t\t'font',\n+\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t'removeformat',\n+\t\t\t\t\t'link',\n+\t\t\t\t\t'list',\n+\t\t\t\t\t'justify',\n+\t\t\t\t\t'blockquote',\n+\t\t\t\t\t'table',\n+\t\t\t\t\t'tabletools',\n+\t\t\t\t\t'image',\n+\t\t\t\t\t'horizontalrule'\n+\t\t\t\t],\n \t\t\t\textraPlugins: 'magicline',\t// Ensure that magicline plugin, which is required for this sample, is loaded.\n-\t\t\t\tallowedContent: true\t\t// Switch off the ACF, so very complex content created to\n-\t\t\t\t\t\t\t\t\t\t\t// show magicline's power isn't filtered.\n+\t\t\t\textraAllowedContent: 'div{*}'\n \t\t\t} );\n \n \t\t</script>\n@@ -188,10 +210,32 @@ <h1 class=\"samples\">\n \t\t\t// window.onload event handler.\n \n \t\t\tCKEDITOR.replace( 'editor2', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t'format',\n+\t\t\t\t\t'font',\n+\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t'removeformat',\n+\t\t\t\t\t'link',\n+\t\t\t\t\t'list',\n+\t\t\t\t\t'justify',\n+\t\t\t\t\t'blockquote',\n+\t\t\t\t\t'table',\n+\t\t\t\t\t'tabletools',\n+\t\t\t\t\t'image',\n+\t\t\t\t\t'horizontalrule'\n+\t\t\t\t],\n \t\t\t\textraPlugins: 'magicline',\t// Ensure that magicline plugin, which is required for this sample, is loaded.\n \t\t\t\tmagicline_color: 'blue',\t// Blue line\n-\t\t\t\tallowedContent: true\t\t// Switch off the ACF, so very complex content created to\n-\t\t\t\t\t\t\t\t\t\t\t// show magicline's power isn't filtered.\n+\t\t\t\textraAllowedContent: 'div{*}'\n \t\t\t});\n \n \t\t</script>"
        },
        {
          "filename": "plugins/mathjax/samples/mathjax.html",
          "status": "modified",
          "additions": 41,
          "deletions": 0,
          "patch": "@@ -25,6 +25,47 @@ <h1 class=\"samples\">\n \t<div class=\"warning deprecated\">\n \t\tThis sample is not maintained anymore. Check out its <a href=\"https://ckeditor.com/docs/ckeditor4/latest/examples/mathjax.html\">brand new version in CKEditor Examples</a>.\n \t</div>\n+\t<form action=\"../../../samples/sample_posteddata.php\" method=\"post\">\n+\t\t<div class=\"description\">\n+\t\t\t<p>\n+\t\t\t\tThis editor allows displaying mathematical formulas, enabled by the <strong>Mathjax</strong> plugin.\n+\t\t\t</p>\n+<pre class=\"samples\">\n+CKEDITOR.replace( '<em>textarea_id</em>', {\n+\textraPlugins: 'mathjax',\n+\tmathJaxLib: '<em>&lt;URL to the MathJax library&gt;</em>'\n+} );</pre>\n+\t\t</div>\n+\t\t<div id=\"editor1\">\n+\t\t\t<p>The following equations are represented in the HTML source code as LaTeX expressions.</p>\n+\t\t\t<h1>The Cauchy-Schwarz Inequality</h1>\n+\t\t\t<p><span class=\"math-tex\">\\( \\left( \\sum_{k=1}^n a_k b_k \\right)^2 \\leq \\left( \\sum_{k=1}^n a_k^2 \\right) \\left( \\sum_{k=1}^n b_k^2 \\right) \\)</span></p>\n+\t\t\t<h1>The probability of getting <span class=\"math-tex\">\\(k\\)</span> heads when flipping <span class=\"math-tex\">\\(n\\)</span> coins is</h1>\n+\t\t\t<p><span class=\"math-tex\">\\(P(E) = {n \\choose k} p^k (1-p)^{ n-k} \\)</span></p>\n+\t\t\t<p>Finally, while displaying equations is useful for demonstration purposes, the ability to mix math and text in a paragraph is also important. This expression <span class=\"math-tex\">\\(\\sqrt{3x-1}+(1+x)^2\\)</span> is an example of an inline equation. As you see, MathJax equations can be used this way as well, without disturbing the spacing between the lines.</p>\n+\t\t</div>\n+\t\t<script>\n+\n+\t\t\t// This call can be placed at any point after the\n+\t\t\t// <textarea>, or inside a <head><script> in a\n+\t\t\t// window.onload event handler.\n+\n+\t\t\t// Replace the <textarea id=\"editor\"> with an CKEditor\n+\t\t\t// instance, using default configurations.\n+\t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'format'\n+\t\t\t\t],\n+\t\t\t\textraPlugins: 'mathjax',\n+\t\t\t\tmathJaxLib: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML'\n+\t\t\t} );\n+\n+\t\t</script>\n \t<div id=\"footer\">\n \t\t<hr>\n \t\t<p>"
        },
        {
          "filename": "plugins/placeholder/samples/placeholder.html",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -53,6 +53,28 @@ <h1 class=\"samples\">\n \t\t\t<script>\n \n \t\t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\t\tplugins: [\n+\t\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t\t'clipboard',\n+\t\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t\t'undo',\n+\t\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t\t'format',\n+\t\t\t\t\t\t'font',\n+\t\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t\t'removeformat',\n+\t\t\t\t\t\t'link',\n+\t\t\t\t\t\t'list',\n+\t\t\t\t\t\t'justify',\n+\t\t\t\t\t\t'blockquote',\n+\t\t\t\t\t\t'table',\n+\t\t\t\t\t\t'tabletools',\n+\t\t\t\t\t\t'image'\n+\t\t\t\t\t],\n \t\t\t\t\textraPlugins: 'placeholder'\n \t\t\t\t});\n "
        },
        {
          "filename": "plugins/sharedspace/samples/sharedspace.html",
          "status": "modified",
          "additions": 88,
          "deletions": 0,
          "patch": "@@ -68,6 +68,28 @@ <h3>\n \t\tCKEDITOR.disableAutoInline = true;\n \n \t\tCKEDITOR.inline( 'inline1', {\n+\t\t\tplugins: [\n+\t\t\t\t'wysiwygarea',\n+\t\t\t\t'sourcearea',\n+\t\t\t\t'clipboard',\n+\t\t\t\t'basicstyles',\n+\t\t\t\t'pastefromword',\n+\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t'pastefromgdocs',\n+\t\t\t\t'undo',\n+\t\t\t\t'stylescombo',\n+\t\t\t\t'format',\n+\t\t\t\t'font',\n+\t\t\t\t'colorbutton',\n+\t\t\t\t'removeformat',\n+\t\t\t\t'link',\n+\t\t\t\t'list',\n+\t\t\t\t'justify',\n+\t\t\t\t'blockquote',\n+\t\t\t\t'table',\n+\t\t\t\t'tabletools',\n+\t\t\t\t'image'\n+\t\t\t],\n \t\t\textraPlugins: 'sharedspace',\n \t\t\tremovePlugins: 'floatingspace,resize',\n \t\t\tsharedSpaces: {\n@@ -77,6 +99,28 @@ <h3>\n \t\t});\n \n \t\tCKEDITOR.inline( 'inline2', {\n+\t\t\tplugins: [\n+\t\t\t\t'wysiwygarea',\n+\t\t\t\t'sourcearea',\n+\t\t\t\t'clipboard',\n+\t\t\t\t'basicstyles',\n+\t\t\t\t'pastefromword',\n+\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t'pastefromgdocs',\n+\t\t\t\t'undo',\n+\t\t\t\t'stylescombo',\n+\t\t\t\t'format',\n+\t\t\t\t'font',\n+\t\t\t\t'colorbutton',\n+\t\t\t\t'removeformat',\n+\t\t\t\t'link',\n+\t\t\t\t'list',\n+\t\t\t\t'justify',\n+\t\t\t\t'blockquote',\n+\t\t\t\t'table',\n+\t\t\t\t'tabletools',\n+\t\t\t\t'image'\n+\t\t\t],\n \t\t\textraPlugins: 'sharedspace',\n \t\t\tremovePlugins: 'floatingspace,resize',\n \t\t\tsharedSpaces: {\n@@ -86,6 +130,28 @@ <h3>\n \t\t});\n \n \t\tCKEDITOR.appendTo( 'framed1', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t'format',\n+\t\t\t\t\t'font',\n+\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t'removeformat',\n+\t\t\t\t\t'link',\n+\t\t\t\t\t'list',\n+\t\t\t\t\t'justify',\n+\t\t\t\t\t'blockquote',\n+\t\t\t\t\t'table',\n+\t\t\t\t\t'tabletools',\n+\t\t\t\t\t'image'\n+\t\t\t\t],\n \t\t\t\textraPlugins: 'sharedspace',\n \t\t\t\tremovePlugins: 'maximize,resize',\n \t\t\t\tsharedSpaces: {\n@@ -97,6 +163,28 @@ <h3>\n \t\t);\n \n \t\tCKEDITOR.appendTo( 'framed2', {\n+\t\t\t\tplugins: [\n+\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t'clipboard',\n+\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t'undo',\n+\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t'format',\n+\t\t\t\t\t'font',\n+\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t'removeformat',\n+\t\t\t\t\t'link',\n+\t\t\t\t\t'list',\n+\t\t\t\t\t'justify',\n+\t\t\t\t\t'blockquote',\n+\t\t\t\t\t'table',\n+\t\t\t\t\t'tabletools',\n+\t\t\t\t\t'image'\n+\t\t\t\t],\n \t\t\t\textraPlugins: 'sharedspace',\n \t\t\t\tremovePlugins: 'maximize,resize',\n \t\t\t\tsharedSpaces: {"
        },
        {
          "filename": "plugins/stylesheetparser/samples/stylesheetparser.html",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -57,6 +57,28 @@ <h1 class=\"samples\">\n \t\t\t\t// Replace the <textarea id=\"editor\"> with an CKEditor\n \t\t\t\t// instance, using default configurations.\n \t\t\t\tCKEDITOR.replace( 'editor1' , {\n+\t\t\t\t\tplugins: [\n+\t\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t\t'clipboard',\n+\t\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t\t'undo',\n+\t\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t\t'format',\n+\t\t\t\t\t\t'font',\n+\t\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t\t'removeformat',\n+\t\t\t\t\t\t'link',\n+\t\t\t\t\t\t'list',\n+\t\t\t\t\t\t'justify',\n+\t\t\t\t\t\t'blockquote',\n+\t\t\t\t\t\t'table',\n+\t\t\t\t\t\t'tabletools',\n+\t\t\t\t\t\t'image'\n+\t\t\t\t\t],\n \t\t\t\t\textraPlugins: 'stylesheetparser',\n \n \t\t\t\t\t// Stylesheet for the contents."
        },
        {
          "filename": "plugins/tableresize/samples/tableresize.html",
          "status": "modified",
          "additions": 22,
          "deletions": 0,
          "patch": "@@ -85,6 +85,28 @@ <h1 class=\"samples\">\n \t\t\t\t// Replace the <textarea id=\"editor\"> with an CKEditor\n \t\t\t\t// instance, using default configurations.\n \t\t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\t\tplugins: [\n+\t\t\t\t\t\t'wysiwygarea',\n+\t\t\t\t\t\t'sourcearea',\n+\t\t\t\t\t\t'clipboard',\n+\t\t\t\t\t\t'basicstyles',\n+\t\t\t\t\t\t'pastefromword',\n+\t\t\t\t\t\t'pastefromlibreoffice',\n+\t\t\t\t\t\t'pastefromgdocs',\n+\t\t\t\t\t\t'undo',\n+\t\t\t\t\t\t'stylescombo',\n+\t\t\t\t\t\t'format',\n+\t\t\t\t\t\t'font',\n+\t\t\t\t\t\t'colorbutton',\n+\t\t\t\t\t\t'removeformat',\n+\t\t\t\t\t\t'link',\n+\t\t\t\t\t\t'list',\n+\t\t\t\t\t\t'justify',\n+\t\t\t\t\t\t'blockquote',\n+\t\t\t\t\t\t'table',\n+\t\t\t\t\t\t'tabletools',\n+\t\t\t\t\t\t'image'\n+\t\t\t\t\t],\n \t\t\t\t\textraPlugins: 'tableresize'\n \t\t\t\t});\n "
        },
        {
          "filename": "plugins/toolbar/samples/toolbar.html",
          "status": "modified",
          "additions": 26,
          "deletions": 2,
          "patch": "@@ -140,13 +140,37 @@ <h2 class=\"samples\">Full toolbar configuration</h2>\n \t\tCKEDITOR.dom.element.createFromHtml( preOutput ).replace( pre );\n \t} );\n \n-\tCKEDITOR.replace( 'editorCurrent', { height: 100 } );\n+\tCKEDITOR.replace( 'editorCurrent', {\n+\t\theight: 100,\n+\t\ton: {\n+\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t}\n+\t\t}\n+\t} );\n \tCKEDITOR.replace( 'editorFull', {\n \t\t// Reset toolbar settings, so full toolbar will be generated automatically.\n \t\ttoolbar: null,\n \t\ttoolbarGroups: null,\n \t\tremoveButtons: null,\n-\t\theight: 100\n+\t\theight: 100,\n+\t\ton: {\n+\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t}\n+\t\t}\n \t} );\n \n \tfunction dumpToolbarConfiguration( editor, printGroups ) {"
        },
        {
          "filename": "plugins/wysiwygarea/samples/fullpage.html",
          "status": "modified",
          "additions": 14,
          "deletions": 9,
          "patch": "@@ -33,18 +33,13 @@ <h1 class=\"samples\">\n \t\t</p>\n <pre class=\"samples\">\n CKEDITOR.replace( '<em>textarea_id</em>', {\n-\t<strong>fullPage: true</strong>,\n-\t<strong>allowedContent: true</strong>\n+\t<strong>fullPage: true</strong>\n });\n </pre>\n \t\t<p>\n \t\t\tNote that <code><em>textarea_id</em></code> in the code above is the <code>id</code> attribute of\n \t\t\tthe <code>&lt;textarea&gt;</code> element to be replaced.\n \t\t</p>\n-\t\t<p>\n-\t\t\tThe <code><em>allowedContent</em></code> in the code above is set to <code>true</code> to disable content filtering.\n-\t\t\tSetting this option is not obligatory, but in full page mode there is a strong chance that one may want be able to freely enter any HTML content in source mode without any limitations.\n-\t\t</p>\n \t</div>\n \t<form action=\"../../../samples/sample_posteddata.php\" method=\"post\">\n \t\t<label for=\"editor1\">\n@@ -58,9 +53,19 @@ <h1 class=\"samples\">\n \n \t\t\tCKEDITOR.replace( 'editor1', {\n \t\t\t\tfullPage: true,\n-\t\t\t\tallowedContent: true,\n-\t\t\t\textraPlugins: 'wysiwygarea'\n-\t\t\t});\n+\t\t\t\textraPlugins: 'wysiwygarea',\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} );\n \n \t\t</script>\n \t\t<p>"
        },
        {
          "filename": "samples/js/sample.js",
          "status": "modified",
          "additions": 26,
          "deletions": 2,
          "patch": "@@ -30,10 +30,34 @@ var initSample = ( function() {\n \n \t\t// Depending on the wysiwygarea plugin availability initialize classic or inline editor.\n \t\tif ( wysiwygareaAvailable ) {\n-\t\t\tCKEDITOR.replace( 'editor' );\n+\t\t\tCKEDITOR.replace( 'editor', {\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} );\n \t\t} else {\n \t\t\teditorElement.setAttribute( 'contenteditable', 'true' );\n-\t\t\tCKEDITOR.inline( 'editor' );\n+\t\t\tCKEDITOR.inline( 'editor', {\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} );\n \n \t\t\t// TODO we can consider displaying some info box that\n \t\t\t// without wysiwygarea the classic editor may not work."
        },
        {
          "filename": "samples/old/ajax.html",
          "status": "modified",
          "additions": 15,
          "deletions": 4,
          "patch": "@@ -19,7 +19,19 @@\n \t\t\t\treturn;\n \n \t\t\t// Create a new editor inside the <div id=\"editor\">, setting its value to html\n-\t\t\tvar config = {};\n+\t\t\tvar config = {\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t};\n \t\t\teditor = CKEDITOR.appendTo( 'editor', config, html );\n \t\t}\n \n@@ -29,7 +41,7 @@\n \n \t\t\t// Retrieve the editor contents. In an Ajax application, this data would be\n \t\t\t// sent to the server or used in any other way.\n-\t\t\tdocument.getElementById( 'editorcontents' ).innerHTML = html = editor.getData();\n+\t\t\tdocument.getElementById( 'editorcontents' ).value = html = editor.getData();\n \t\t\tdocument.getElementById( 'contents' ).style.display = '';\n \n \t\t\t// Destroy the editor.\n@@ -69,8 +81,7 @@ <h1 class=\"samples\">\n \t\t\tEdited Contents:\n \t\t</p>\n \t\t<!-- This div will be used to display the editor contents. -->\n-\t\t<div id=\"editorcontents\">\n-\t\t</div>\n+\t\t<textarea id=\"editorcontents\" style=\"width: 100%;min-height: 2em;\"></textarea>\n \t</div>\n \t<div id=\"footer\">\n \t\t<hr>"
        },
        {
          "filename": "samples/old/api.html",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -166,6 +166,16 @@ <h1 class=\"samples\">\n \t\t\t\t\t\t\tdoc.getById( 'exec-bold' ).hide();\n \t\t\t\t\t\tif ( !ed.getCommand( 'link' ) )\n \t\t\t\t\t\t\tdoc.getById( 'exec-link' ).hide();\n+\t\t\t\t\t},\n+\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t});"
        },
        {
          "filename": "samples/old/appendto.html",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -39,7 +39,19 @@ <h1 class=\"samples\">\n \t\t\t// Append a CKEditor instance using the default configuration and the\n \t\t\t// provided content to the <div> element of ID \"section1\".\n \t\t\tCKEDITOR.appendTo( 'section1',\n-\t\t\t\tnull,\n+\t\t\t\t{\n+\t\t\t\t\ton: {\n+\t\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\t\t\t\t},\n \t\t\t\t'<p>This is some <strong>sample text</strong>. You are using <a href=\"https://ckeditor.com/\">CKEditor</a>.</p>'\n \t\t\t);\n "
        },
        {
          "filename": "samples/old/datafiltering.html",
          "status": "modified",
          "additions": 19,
          "deletions": 49,
          "patch": "@@ -13,6 +13,18 @@\n \t<script>\n \t\t// Remove advanced tabs for all editors.\n \t\tCKEDITOR.config.removeDialogTabs = 'image:advanced;link:advanced;creatediv:advanced;editdiv:advanced';\n+\n+\t\tCKEDITOR.on( 'instanceCreated', function( evt ) {\n+\t\t\tevt.editor.on( 'contentPreview',function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t} );\n+\t\t} );\n \t</script>\n </head>\n <body>\n@@ -119,6 +131,13 @@ <h3>How to configure or disable ACF?</h3>\n \t<strong>allowedContent: true</strong>\n } );\n </pre>\n+\t\t<p>\n+\t\t\tPlease not that disabling filtering is not recommended\n+\t\t\tas <strong>it can result in XSS vulnerabilities</strong>.\n+\t\t\tIt is recommended to <a\n+\t\t\thref=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#use-acf-in-default-automatic-mode\">\n+\t\t\trely on the automatic configuration</a>.\n+\t\t</p>\n \n \t\t<h2>Beyond data flow: Features activation</h2>\n \t\t<p>\n@@ -446,55 +465,6 @@ <h1 id=\"editor5\" contenteditable=\"true\">\n \t\t</script>\n \t</div>\n \n-\t<br>\n-\n-\t<div>\n-\t\t<label for=\"editor7\">\n-\t\t\tEditor 7:\n-\t\t</label>\n-\t\t<div class=\"description\">\n-\t\t\t<p>\n-\t\t\t\tThis editor is using a custom configuration for <abbr title=\"Advanced Content Filter\">ACF</abbr>.\n-\t\t\t\tIt's using the <a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_disallowed_content.html\" rel=\"noopener noreferrer\" target=\"_blank\">\n-\t\t\t\tDisallowed Content</a> property of the filter to eliminate all <code>a</code> and <code>img</code> tags,\n-\t\t\t\twhile allowing all other tags.\n-\t\t\t</p>\n-<pre class=\"samples\">\n-CKEDITOR.replace( 'editor7', {\n-\tallowedContent: {\n-\t\t// Allow all content.\n-\t\t$1: {\n-\t\t\telements: CKEDITOR.dtd,\n-\t\t\tattributes: true,\n-\t\t\tstyles: true,\n-\t\t\tclasses: true\n-\t\t}\n-\t},\n-\tdisallowedContent: 'img a'\n-} );\n-</pre>\n-\t\t</div>\n-\t\t<textarea cols=\"80\" id=\"editor7\" name=\"editor7\" rows=\"10\">\n-\t\t\t&lt;h1&gt;&lt;img alt=&quot;Saturn V carrying Apollo 11&quot; class=&quot;right&quot; src=&quot;assets/sample.jpg&quot;/&gt; Apollo 11&lt;/h1&gt; &lt;p&gt;&lt;b&gt;Apollo 11&lt;/b&gt; was the spaceflight that landed the first humans, Americans &lt;a href=&quot;http://en.wikipedia.org/wiki/Neil_Armstrong&quot; title=&quot;Neil Armstrong&quot;&gt;Neil Armstrong&lt;/a&gt; and &lt;a href=&quot;http://en.wikipedia.org/wiki/Buzz_Aldrin&quot; title=&quot;Buzz Aldrin&quot;&gt;Buzz Aldrin&lt;/a&gt;, on the Moon on July 20, 1969, at 20:18 UTC. Armstrong became the first to step onto the lunar surface 6 hours later on July 21 at 02:56 UTC.&lt;/p&gt; &lt;p&gt;Armstrong spent about &lt;s&gt;three and a half&lt;/s&gt; two and a half hours outside the spacecraft, Aldrin slightly less; and together they collected 47.5 pounds (21.5&amp;nbsp;kg) of lunar material for return to Earth. A third member of the mission, &lt;a href=&quot;http://en.wikipedia.org/wiki/Michael_Collins_(astronaut)&quot; title=&quot;Michael Collins (astronaut)&quot;&gt;Michael Collins&lt;/a&gt;, piloted the &lt;a href=&quot;http://en.wikipedia.org/wiki/Apollo_Command/Service_Module&quot; title=&quot;Apollo Command/Service Module&quot;&gt;command&lt;/a&gt; spacecraft alone in lunar orbit until Armstrong and Aldrin returned to it for the trip back to Earth.&lt;/p&gt; &lt;h2&gt;Broadcasting and &lt;em&gt;quotes&lt;/em&gt; &lt;a id=&quot;quotes&quot; name=&quot;quotes&quot;&gt;&lt;/a&gt;&lt;/h2&gt; &lt;p&gt;Broadcast on live TV to a world-wide audience, Armstrong stepped onto the lunar surface and described the event as:&lt;/p&gt; &lt;blockquote&gt;&lt;p&gt;One small step for [a] man, one giant leap for mankind.&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Apollo 11 effectively ended the &lt;a href=&quot;http://en.wikipedia.org/wiki/Space_Race&quot; title=&quot;Space Race&quot;&gt;Space Race&lt;/a&gt; and fulfilled a national goal proposed in 1961 by the late U.S. President &lt;a href=&quot;http://en.wikipedia.org/wiki/John_F._Kennedy&quot; title=&quot;John F. Kennedy&quot;&gt;John F. Kennedy&lt;/a&gt; in a speech before the United States Congress:&lt;/p&gt; &lt;blockquote&gt;&lt;p&gt;[...] before this decade is out, of landing a man on the Moon and returning him safely to the Earth.&lt;/p&gt;&lt;/blockquote&gt; &lt;h2&gt;Technical details &lt;a id=&quot;tech-details&quot; name=&quot;tech-details&quot;&gt;&lt;/a&gt;&lt;/h2&gt; &lt;table align=&quot;right&quot; border=&quot;1&quot; bordercolor=&quot;#ccc&quot; cellpadding=&quot;5&quot; cellspacing=&quot;0&quot; style=&quot;border-collapse:collapse;margin:10px 0 10px 15px;&quot;&gt; &lt;caption&gt;&lt;strong&gt;Mission crew&lt;/strong&gt;&lt;/caption&gt; &lt;thead&gt; &lt;tr&gt; &lt;th scope=&quot;col&quot;&gt;Position&lt;/th&gt; &lt;th scope=&quot;col&quot;&gt;Astronaut&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td&gt;Commander&lt;/td&gt; &lt;td&gt;Neil A. Armstrong&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Command Module Pilot&lt;/td&gt; &lt;td&gt;Michael Collins&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Lunar Module Pilot&lt;/td&gt; &lt;td&gt;Edwin &amp;quot;Buzz&amp;quot; E. Aldrin, Jr.&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;p&gt;Launched by a &lt;strong&gt;Saturn V&lt;/strong&gt; rocket from &lt;a href=&quot;http://en.wikipedia.org/wiki/Kennedy_Space_Center&quot; title=&quot;Kennedy Space Center&quot;&gt;Kennedy Space Center&lt;/a&gt; in Merritt Island, Florida on July 16, Apollo 11 was the fifth manned mission of &lt;a href=&quot;http://en.wikipedia.org/wiki/NASA&quot; title=&quot;NASA&quot;&gt;NASA&lt;/a&gt;&amp;#39;s Apollo program. The Apollo spacecraft had three parts:&lt;/p&gt; &lt;ol&gt; &lt;li&gt;&lt;strong&gt;Command Module&lt;/strong&gt; with a cabin for the three astronauts which was the only part which landed back on Earth&lt;/li&gt; &lt;li&gt;&lt;strong&gt;Service Module&lt;/strong&gt; which supported the Command Module with propulsion, electrical power, oxygen and water&lt;/li&gt; &lt;li&gt;&lt;strong&gt;Lunar Module&lt;/strong&gt; for landing on the Moon.&lt;/li&gt; &lt;/ol&gt; &lt;p&gt;After being sent to the Moon by the Saturn V&amp;#39;s upper stage, the astronauts separated the spacecraft from it and travelled for three days until they entered into lunar orbit. Armstrong and Aldrin then moved into the Lunar Module and landed in the &lt;a href=&quot;http://en.wikipedia.org/wiki/Mare_Tranquillitatis&quot; title=&quot;Mare Tranquillitatis&quot;&gt;Sea of Tranquility&lt;/a&gt;. They stayed a total of about 21 and a half hours on the lunar surface. After lifting off in the upper part of the Lunar Module and rejoining Collins in the Command Module, they returned to Earth and landed in the &lt;a href=&quot;http://en.wikipedia.org/wiki/Pacific_Ocean&quot; title=&quot;Pacific Ocean&quot;&gt;Pacific Ocean&lt;/a&gt; on July 24.&lt;/p&gt; &lt;hr/&gt; &lt;p style=&quot;text-align: right;&quot;&gt;&lt;small&gt;Source: &lt;a href=&quot;http://en.wikipedia.org/wiki/Apollo_11&quot;&gt;Wikipedia.org&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;\n-\t\t</textarea>\n-\t\t<script>\n-\n-\t\t\tCKEDITOR.replace( 'editor7', {\n-\t\t\t\tallowedContent: {\n-\t\t\t\t\t// allow all content\n-\t\t\t\t\t$1: {\n-\t\t\t\t\t\telements: CKEDITOR.dtd,\n-\t\t\t\t\t\tattributes: true,\n-\t\t\t\t\t\tstyles: true,\n-\t\t\t\t\t\tclasses: true\n-\t\t\t\t\t}\n-\t\t\t\t},\n-\t\t\t\tdisallowedContent: 'img a'\n-\t\t\t} );\n-\n-\t\t</script>\n-\t</div>\n-\n \t<div id=\"footer\">\n \t\t<hr>\n \t\t<p>"
        },
        {
          "filename": "samples/old/divreplace.html",
          "status": "modified",
          "additions": 12,
          "deletions": 1,
          "patch": "@@ -26,7 +26,6 @@\n \n \t</style>\n \t<script>\n-\n \t\t// Uncomment the following code to test the \"Timeout Loading Method\".\n \t\t// CKEDITOR.loadFullCoreTimeout = 5;\n \n@@ -66,6 +65,18 @@\n \t\t\teditor = CKEDITOR.replace( div );\n \t\t}\n \n+\n+\t\tCKEDITOR.on( 'instanceCreated', function( evt ) {\n+\t\t\tevt.editor.on( 'contentPreview', function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t} );\n+\t\t} );\n \t</script>\n </head>\n <body>"
        },
        {
          "filename": "samples/old/inlineall.html",
          "status": "modified",
          "additions": 11,
          "deletions": 1,
          "patch": "@@ -21,6 +21,16 @@\n \t\t\tvar editor = event.editor,\n \t\t\t\telement = editor.element;\n \n+\t\t\teditor.on( 'contentPreview', function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t} );\n+\n \t\t\t// Customize editors for headers and tag list.\n \t\t\t// These editors don't need features like smileys, templates, iframes etc.\n \t\t\tif ( element.is( 'h1', 'h2', 'h3' ) || element.getAttribute( 'id' ) == 'taglist' ) {\n@@ -44,7 +54,7 @@\n \t\t\t\t\t];\n \t\t\t\t});\n \t\t\t}\n-\t\t});\n+\t\t} );\n \n \t</script>\n \t<link href=\"sample.css\" rel=\"stylesheet\">"
        },
        {
          "filename": "samples/old/inlinebycode.html",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -108,7 +108,19 @@ <h2>Technical details <a id=\"tech-details\" name=\"tech-details\"></a></h2>\n \t\t// We need to turn off the automatic editor creation first.\n \t\tCKEDITOR.disableAutoInline = true;\n \n-\t\tvar editor = CKEDITOR.inline( 'editable' );\n+\t\tvar editor = CKEDITOR.inline( 'editable', {\n+\t\t\ton: {\n+\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t'</div>';\n+\t\t\t\t}\n+\t\t\t}\n+\t\t} );\n \t</script>\n \t<div id=\"footer\">\n \t\t<hr>"
        },
        {
          "filename": "samples/old/inlinetextarea.html",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -97,7 +97,19 @@ <h2>This is a sample form with some fields</h2>\n \t</form>\n \n \t<script>\n-\t\tCKEDITOR.inline( 'article-body' );\n+\t\tCKEDITOR.inline( 'article-body', {\n+\t\t\ton: {\n+\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t'</div>';\n+\t\t\t\t}\n+\t\t\t}\n+\t\t} );\n \t</script>\n \t<div id=\"footer\">\n \t\t<hr>"
        },
        {
          "filename": "samples/old/jquery.html",
          "status": "modified",
          "additions": 26,
          "deletions": 2,
          "patch": "@@ -26,8 +26,32 @@\n \t\tCKEDITOR.disableAutoInline = true;\n \n \t\t$( document ).ready( function() {\n-\t\t\t$( '#editor1' ).ckeditor(); // Use CKEDITOR.replace() if element is <textarea>.\n-\t\t\t$( '#editable' ).ckeditor(); // Use CKEDITOR.inline().\n+\t\t\t$( '#editor1' ).ckeditor( {\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} ); // Use CKEDITOR.replace() if element is <textarea>.\n+\t\t\t$( '#editable' ).ckeditor( {\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} ); // Use CKEDITOR.inline().\n \t\t} );\n \n \t\tfunction setValue() {"
        },
        {
          "filename": "samples/old/readonly.html",
          "status": "modified",
          "additions": 12,
          "deletions": 2,
          "patch": "@@ -26,8 +26,18 @@\n \t\t\teditor.on( 'readOnly', function() {\n \t\t\t\tdocument.getElementById( 'readOnlyOn' ).style.display = this.readOnly ? 'none' : '';\n \t\t\t\tdocument.getElementById( 'readOnlyOff' ).style.display = this.readOnly ? '' : 'none';\n-\t\t\t});\n-\t\t});\n+\t\t\t} );\n+\n+\t\t\teditor.on( 'contentPreview', function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t} );\n+\t\t} );\n \n \t\tfunction toggleReadOnly( isReadOnly ) {\n \t\t\t// Change the read-only state of the editor."
        },
        {
          "filename": "samples/old/replacebyclass.html",
          "status": "modified",
          "additions": 13,
          "deletions": 0,
          "patch": "@@ -8,6 +8,19 @@\n \t<meta charset=\"utf-8\">\n \t<title>Replace Textareas by Class Name &mdash; CKEditor Sample</title>\n \t<script src=\"../../ckeditor.js\"></script>\n+\t<script>\n+\t\tCKEDITOR.on( 'instanceCreated', function( evt ) {\n+\t\t\tevt.editor.on( 'contentPreview',function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t} );\n+\t\t} );\n+\t</script>\n \t<link rel=\"stylesheet\" href=\"sample.css\">\n \t<meta name=\"description\" content=\"Try the latest sample of CKEditor 4 and learn more about customizing your WYSIWYG editor with endless possibilities.\">\n </head>"
        },
        {
          "filename": "samples/old/replacebycode.html",
          "status": "modified",
          "additions": 13,
          "deletions": 1,
          "patch": "@@ -39,7 +39,19 @@ <h1 class=\"samples\">\n \t\t\t// Replace the <textarea id=\"editor\"> with an CKEditor\n \t\t\t// instance, using default configurations.\n \n-\t\t\tCKEDITOR.replace( 'editor1' );\n+\t\t\tCKEDITOR.replace( 'editor1', {\n+\t\t\t\ton: {\n+\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\t\t\t} );\n \n \t\t</script>\n \t\t<p>"
        },
        {
          "filename": "samples/old/tabindex.html",
          "status": "modified",
          "additions": 13,
          "deletions": 3,
          "patch": "@@ -29,15 +29,25 @@\n \t\t\t// Apply focus class name.\n \t\t\teditor.on( 'focus', function() {\n \t\t\t\teditor.container.addClass( 'cke_focused' );\n-\t\t\t});\n+\t\t\t} );\n \t\t\teditor.on( 'blur', function() {\n \t\t\t\teditor.container.removeClass( 'cke_focused' );\n-\t\t\t});\n+\t\t\t} );\n \n \t\t\t// Put startup focus on the first editor in tab order.\n \t\t\tif ( editor.tabIndex == 1 )\n \t\t\t\teditor.focus();\n-\t\t});\n+\n+\t\t\teditor.on( 'contentPreview', function( evt ) {\n+\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t'</div>';\n+\t\t\t} );\n+\t\t} );\n \n \t</script>\n </head>"
        },
        {
          "filename": "samples/old/uilanguages.html",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -98,9 +98,18 @@ <h1 class=\"samples\">\n \t\t\t\t\t\t\t\tvar languages = document.getElementById( 'languages' );\n \t\t\t\t\t\t\t\tlanguages.value = this.langCode;\n \t\t\t\t\t\t\t\tlanguages.disabled = false;\n+\t\t\t\t\t\t\t},\n+\t\t\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t\t\t'</div>';\n \t\t\t\t\t\t\t}\n \t\t\t\t\t\t}\n-\t\t\t\t\t});\n+\t\t\t\t\t} );\n \t\t\t\t}\n \n \t\t\t\t// At page startup, load the default language:"
        },
        {
          "filename": "samples/old/xhtmlstyle.html",
          "status": "modified",
          "additions": 14,
          "deletions": 2,
          "patch": "@@ -212,8 +212,20 @@ <h1 class=\"samples\">\n \n \t\t\t\t\t\t{ name: 'Cited Work', element: 'cite' },\n \t\t\t\t\t\t{ name: 'Inline Quotation', element: 'q' }\n-\t\t\t\t\t]\n-\t\t\t\t});\n+\t\t\t\t\t],\n+\n+\t\t\t\t\ton: {\n+\t\t\t\t\t\tcontentPreview: function( evt ) {\n+\t\t\t\t\t\t\tevt.data.dataValue = '<div style=\"padding: 1.5em;border: 3px #f00 solid\">' +\n+\t\t\t\t\t\t\t\t\t'<h1>Content Preview was blocked</h1>' +\n+\t\t\t\t\t\t\t\t\t'<p>To ensure the highest security, the content preview in samples was blocked.</p>' +\n+\t\t\t\t\t\t\t\t\t'<p>Please refer to our ' +\n+\t\t\t\t\t\t\t\t\t\t'<a href=\"https://ckeditor.com/docs/ckeditor4/latest/guide/dev_best_practices.html#validate-preview-content\">' +\n+\t\t\t\t\t\t\t\t\t\t'best practices on security</a> to learn more how to properly configure and secure the content preview.</p>' +\n+\t\t\t\t\t\t\t\t'</div>';\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\t\t\t\t} );\n \n \t\t\t</script>\n \t\t</p>"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 18,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "82796d03d0ebbe34d48f3b65c6dde27107812a51",
            "date": "2024-08-21T07:39:31Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "c40e7a3193309108d5ef90b7dac92066cfd52aa0",
            "date": "2024-08-21T07:12:23Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "aa9e5e1780101aebff48de0427d8c6547d71dab1",
            "date": "2024-08-21T07:11:35Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "3215349022971fb8dddaf46f183152e0ce5d4d99",
            "date": "2024-08-21T07:05:13Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "ac2d36d1acd9447fa3fdcc871bccef95e632d6f9",
            "date": "2024-08-20T09:39:22Z",
            "author_login": "jacekbogdanski"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "CKEditor4 is an open source what-you-see-is-what-you-get HTML editor. A cross-site scripting vulnerability has been discovered in the core HTML parsing module in versions of CKEditor4 prior to 4.24.0-lts. It may affect all editor instances that enabled full-page editing mode or enabled CDATA elements in Advanced Content Filtering configuration (defaults to `script` and `style` elements). The vulnerability allows attackers to inject malformed HTML content bypassing Advanced Content Filtering mechanism, which could result in executing JavaScript code. An attacker could abuse faulty CDATA content detection and use it to prepare an intentional attack on the editor. A fix is available in version 4.24.0-lts.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-07T16:15:47.753",
    "last_modified": "2024-11-21T08:59:46.343",
    "fix_date": "2024-01-16T12:47:10Z"
  },
  "references": [
    {
      "url": "https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_dtd.html#property-S-cdata",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor4/latest/features/fullpage.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor4/latest/guide/dev_advanced_content_filter.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/ckeditor/ckeditor4/commit/8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-fq6h-4g8v-qqvm",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.drupal.org/sa-contrib-2024-009",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_dtd.html#property-S-cdata",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor4/latest/features/fullpage.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor4/latest/guide/dev_advanced_content_filter.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/ckeditor/ckeditor4/commit/8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-fq6h-4g8v-qqvm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.drupal.org/sa-contrib-2024-009",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:05.596676",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "ckeditor4",
    "owner": "ckeditor",
    "created_at": "2012-08-20T14:21:13Z",
    "updated_at": "2025-01-24T14:28:12Z",
    "pushed_at": "2025-01-24T13:13:35Z",
    "size": 140854,
    "stars": 5794,
    "forks": 2477,
    "open_issues": 1185,
    "watchers": 5794,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Rich Text Format": 179759729,
      "HTML": 25244344,
      "JavaScript": 11653753,
      "CSS": 291415,
      "Shell": 9678,
      "Python": 2436
    },
    "commit_activity": {
      "total_commits_last_year": 42,
      "avg_commits_per_week": 0.8076923076923077,
      "days_active_last_year": 15
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:12:34.905229"
  }
}