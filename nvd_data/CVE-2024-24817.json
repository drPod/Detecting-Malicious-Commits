{
  "cve_id": "CVE-2024-24817",
  "github_data": {
    "repository": "discourse/discourse-calendar",
    "fix_commit": "84ef46a38cf02748ecacad16c5d9c6fec12dc8da",
    "related_commits": [
      "84ef46a38cf02748ecacad16c5d9c6fec12dc8da",
      "84ef46a38cf02748ecacad16c5d9c6fec12dc8da"
    ],
    "patch_url": "https://github.com/discourse/discourse-calendar/commit/84ef46a38cf02748ecacad16c5d9c6fec12dc8da.patch",
    "fix_commit_details": {
      "sha": "84ef46a38cf02748ecacad16c5d9c6fec12dc8da",
      "commit_date": "2024-02-22T03:32:47Z",
      "author": {
        "login": "nattsw",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "SECURITY: Hide invitees from users who are not allowed to see the event post (#544)",
        "length": 83,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 28,
        "deletions": 1
      },
      "files": [
        {
          "filename": "app/controllers/discourse_post_event/invitees_controller.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -4,6 +4,7 @@ module DiscoursePostEvent\n   class InviteesController < DiscoursePostEventController\n     def index\n       event = Event.find(params[:post_id])\n+      guardian.ensure_can_see!(event.post)\n \n       event_invitees = event.invitees\n "
        },
        {
          "filename": "plugin.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -3,7 +3,7 @@\n # name: discourse-calendar\n # about: Adds the ability to create a dynamic calendar with events in a topic.\n # meta_topic_id: 97376\n-# version: 0.3\n+# version: 0.4\n # author: Daniel Waterworth, Joffrey Jaffeux\n # url: https://github.com/discourse/discourse-calendar\n "
        },
        {
          "filename": "spec/requests/invitees_controller_spec.rb",
          "status": "modified",
          "additions": 26,
          "deletions": 0,
          "patch": "@@ -15,6 +15,32 @@ module DiscoursePostEvent\n     let(:post_1) { Fabricate(:post, user: user, topic: topic_1) }\n \n     describe \"#index\" do\n+      context \"for a post in a private category\" do\n+        let(:outside_user) { Fabricate(:user) }\n+        let(:in_group_user) { Fabricate(:user) }\n+        let(:group) { Fabricate(:group, users: [in_group_user]) }\n+        let(:private_category) { Fabricate(:private_category, group:) }\n+        let(:topic_1) { Fabricate(:topic, user: user, category: private_category) }\n+        let(:post_1) { Fabricate(:post, user: user, topic: topic_1) }\n+        let(:post_event_1) { Fabricate(:event, post: post_1) }\n+\n+        it \"forbids non group user from seeing the list of invitees\" do\n+          sign_in(outside_user)\n+\n+          get \"/discourse-post-event/events/#{post_event_1.id}/invitees.json\"\n+\n+          expect(response.status).to eq(403)\n+        end\n+\n+        it \"allows group user to see the list of invitees\" do\n+          sign_in(in_group_user)\n+\n+          get \"/discourse-post-event/events/#{post_event_1.id}/invitees.json\"\n+\n+          expect(response.status).to eq(200)\n+        end\n+      end\n+\n       context \"when params are included\" do\n         let(:invitee1) { Fabricate(:user, username: \"Francis\", name: \"Francis\") }\n         let(:invitee2) { Fabricate(:user, username: \"Francisco\", name: \"Francisco\") }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "76d8b9a6022b5353f7849e4d329db6df52f56546",
            "date": "2025-01-08T17:31:45Z",
            "author_login": "renato"
          },
          {
            "sha": "3c833c99e32aab9ac708d92617b6b740681ab5ba",
            "date": "2025-01-08T11:23:24Z",
            "author_login": "renato"
          },
          {
            "sha": "764fd67b5ef92f356e977e4c61b27150b138b9c5",
            "date": "2025-01-06T09:00:32Z",
            "author_login": "tgxworld"
          },
          {
            "sha": "2a1bc44f961f014d9975bffa5a7444e49b382bda",
            "date": "2025-01-03T13:01:54Z",
            "author_login": "discourse-translator-bot"
          },
          {
            "sha": "73502dd180022de1c4a46ab5a846b6bd53c8205b",
            "date": "2025-01-03T07:42:41Z",
            "author_login": "arpitjalan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "Discourse Calendar adds the ability to create a dynamic calendar in the first post of a topic on the open-source discussion platform Discourse. Prior to version 0.4, event invitees created in topics in private categories or PMs (private messages) can be retrieved by anyone, even if they're not logged in. This problem is resolved in version 0.4 of the discourse-calendar plugin. While no known workaround is available, putting the site behind `login_required` will disallow this endpoint to be used by anonymous users, but logged in users can still get the list of invitees in the private topics.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-22T18:15:48.587",
    "last_modified": "2024-11-21T08:59:46.640",
    "fix_date": "2024-02-22T03:32:47Z"
  },
  "references": [
    {
      "url": "https://github.com/discourse/discourse-calendar/commit/84ef46a38cf02748ecacad16c5d9c6fec12dc8da",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/discourse/discourse-calendar/security/advisories/GHSA-wwq5-g5cp-c69f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/discourse/discourse-calendar/commit/84ef46a38cf02748ecacad16c5d9c6fec12dc8da",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/discourse/discourse-calendar/security/advisories/GHSA-wwq5-g5cp-c69f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.150562",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "discourse-calendar",
    "owner": "discourse",
    "created_at": "2018-09-17T14:48:07Z",
    "updated_at": "2025-01-08T17:31:49Z",
    "pushed_at": "2025-01-08T17:31:47Z",
    "size": 2949,
    "stars": 64,
    "forks": 54,
    "open_issues": 6,
    "watchers": 64,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Ruby": 339295,
      "JavaScript": 219324,
      "SCSS": 29785,
      "Handlebars": 16271
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:26:54.925307"
  }
}