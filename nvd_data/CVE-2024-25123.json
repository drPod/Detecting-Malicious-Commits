{
  "cve_id": "CVE-2024-25123",
  "github_data": {
    "repository": "Open-MSS/MSS",
    "fix_commit": "f23033729ee930b97f8bdbd07df0174311c9b658",
    "related_commits": [
      "f23033729ee930b97f8bdbd07df0174311c9b658",
      "f23033729ee930b97f8bdbd07df0174311c9b658"
    ],
    "patch_url": "https://github.com/Open-MSS/MSS/commit/f23033729ee930b97f8bdbd07df0174311c9b658.patch",
    "fix_commit_details": {
      "sha": "f23033729ee930b97f8bdbd07df0174311c9b658",
      "commit_date": "2024-02-08T15:00:40Z",
      "author": {
        "login": "matrss",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-pf2h-qjcr-qvq2",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "mslib/index.py",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -29,6 +29,7 @@\n import os\n import codecs\n import mslib\n+import werkzeug\n \n from flask import render_template\n from flask import send_from_directory, send_file, url_for\n@@ -161,11 +162,15 @@ def plots():\n     @APP.route(\"/mss/code/<path:filename>\")\n     def code(filename):\n         download = request.args.get(\"download\", False)\n-        _file = os.path.join(STATIC_LOCATION, 'code', filename)\n+        _file = werkzeug.security.safe_join(STATIC_LOCATION, \"code\", filename)\n+        if _file is None:\n+            abort(404)\n         content = get_content(_file)\n         if not download:\n             return render_template(\"/content.html\", act=\"code\", content=content)\n         else:\n+            if not os.path.isfile(_file):\n+                abort(404)\n             with open(_file) as f:\n                 text = f.read()\n             return Response(\"\".join([s.replace(\"\\t\", \"\", 1) for s in text.split(\"```python\")[-1]"
        },
        {
          "filename": "mslib/mscolab/server.py",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -34,6 +34,8 @@\n import os\n import socketio\n import sqlalchemy.exc\n+import werkzeug\n+\n from itsdangerous import URLSafeTimedSerializer, BadSignature\n from flask import g, jsonify, request, render_template, flash\n from flask import send_from_directory, abort, url_for\n@@ -378,7 +380,7 @@ def uploads(name=None, filename=None):\n         abort(404)\n     if filename is None:\n         abort(404)\n-    return send_from_directory(fs.path.join(base_path, name), filename)\n+    return send_from_directory(base_path, werkzeug.security.safe_join(\"\", name, filename))\n \n \n # 413: Payload Too Large"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f434dd686a8724dfe59871b831c679aec2c2388a",
            "date": "2025-01-14T15:51:34Z",
            "author_login": "ReimarBauer"
          },
          {
            "sha": "22145d9a6c533ad55f7b983a719777b94ca0db93",
            "date": "2025-01-13T07:30:01Z",
            "author_login": "TheMightyRaider"
          },
          {
            "sha": "885c40359c7c12e0eaeae361bf8750917b45b052",
            "date": "2025-01-10T14:27:03Z",
            "author_login": "ReimarBauer"
          },
          {
            "sha": "ce4ea66376ce8fbf35cc55573fec990c7febcea8",
            "date": "2024-12-19T08:33:02Z",
            "author_login": "ReimarBauer"
          },
          {
            "sha": "b2d2089d73ab79f055256d51731ea23563764973",
            "date": "2024-12-18T18:36:41Z",
            "author_login": "ReimarBauer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-22",
    "description": "MSS (Mission Support System) is an open source package designed for planning atmospheric research flights. In file: `index.py`, there is a method that is vulnerable to path manipulation attack. By modifying file paths, an attacker can acquire sensitive information from different resources. The `filename` variable is joined with other variables to form a file path in `_file`. However, `filename` is a route parameter that can capture path type values i.e. values including slashes (\\). So it is possible for an attacker to manipulate the file being read by assigning a value containing ../ to `filename` and so the attacker may be able to gain access to other files on the host filesystem. This issue has been addressed in MSS version 8.3.3. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-15T22:15:48.060",
    "last_modified": "2025-01-09T14:30:38.743",
    "fix_date": "2024-02-08T15:00:40Z"
  },
  "references": [
    {
      "url": "https://github.com/Open-MSS/MSS/commit/f23033729ee930b97f8bdbd07df0174311c9b658",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Open-MSS/MSS/security/advisories/GHSA-pf2h-qjcr-qvq2",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Open-MSS/MSS/commit/f23033729ee930b97f8bdbd07df0174311c9b658",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Open-MSS/MSS/security/advisories/GHSA-pf2h-qjcr-qvq2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.128514",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "MSS",
    "owner": "Open-MSS",
    "created_at": "2020-12-03T21:52:50Z",
    "updated_at": "2025-01-14T15:51:38Z",
    "pushed_at": "2025-01-14T15:51:34Z",
    "size": 12156,
    "stars": 66,
    "forks": 95,
    "open_issues": 170,
    "watchers": 66,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "Python": 4417138,
      "HTML": 19596,
      "Shell": 8349,
      "Mako": 2365,
      "Batchfile": 335
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T17:09:31.485840"
  }
}