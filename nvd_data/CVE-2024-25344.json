{
  "cve_id": "CVE-2024-25344",
  "github_data": {
    "repository": "itflow-org/itflow",
    "fix_commit": "432488eca3998c5be6b6b9e8f8ba01f54bc12378",
    "related_commits": [
      "432488eca3998c5be6b6b9e8f8ba01f54bc12378",
      "8068cb6081e4760860a634c1066b2c64d0ee2d46",
      "432488eca3998c5be6b6b9e8f8ba01f54bc12378",
      "8068cb6081e4760860a634c1066b2c64d0ee2d46"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "432488eca3998c5be6b6b9e8f8ba01f54bc12378",
      "commit_date": "2023-11-25T16:36:05Z",
      "author": {
        "login": "wrongecho",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Require CSRF token to edit Stripe settings - thanks to @stehled",
        "length": 63,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "post/setting.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -331,6 +331,7 @@\n \n if (isset($_POST['edit_online_payment_settings'])) {\n \n+    validateCSRFToken($_POST['csrf_token']);\n     validateAdminRole();\n \n     $config_stripe_enable = intval($_POST['config_stripe_enable']);"
        },
        {
          "filename": "settings_online_payment.php",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -11,6 +11,7 @@\n         </div>\n         <div class=\"card-body\">\n             <form action=\"post.php\" method=\"post\" autocomplete=\"off\">\n+                <input type=\"hidden\" name=\"csrf_token\" value=\"<?php echo $_SESSION['csrf_token'] ?>\">\n \n                 <div class=\"form-group\">\n                     <div class=\"custom-control custom-switch\">\n@@ -53,9 +54,9 @@\n                                 $sql_accounts = mysqli_query($mysqli, \"SELECT * FROM accounts LEFT JOIN account_types ON account_types.account_type_id = accounts.account_type WHERE account_type_parent = 1 AND account_archived_at IS NULL ORDER BY account_name ASC\");\n                                 while ($row = mysqli_fetch_array($sql_accounts)) {\n                                     $account_id = intval($row['account_id']);\n-                                    $account_name = nullable_htmlentities($row['account_name']); \n+                                    $account_name = nullable_htmlentities($row['account_name']);\n                                     ?>\n-                                        \n+\n                                     <option value=\"<?php echo $account_id ?>\" <?php if ($account_id == $config_stripe_account) { echo \"selected\"; } ?>><?php echo $account_name ?></option>\n                                 <?php\n                                 }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e8c3cabde74cf6321c16986af59774a8ea82aac4",
            "date": "2025-01-25T17:48:43Z",
            "author_login": "johnnyq"
          },
          {
            "sha": "33f80cb6b5d3e432f71df7da6c95ac474ef5394e",
            "date": "2025-01-25T17:42:11Z",
            "author_login": "johnnyq"
          },
          {
            "sha": "bf382f3aeb2e80a3085752c95854a5022a740f46",
            "date": "2025-01-25T17:35:19Z",
            "author_login": "johnnyq"
          },
          {
            "sha": "f4c4fe655b2a87a4ffb181cea70d3f8a1bc50054",
            "date": "2025-01-25T17:06:45Z",
            "author_login": "johnnyq"
          },
          {
            "sha": "6473a84fb20a46dcf94f0b819cb0cd0178b30b1c",
            "date": "2025-01-25T16:47:58Z",
            "author_login": "johnnyq"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cross Site Scripting vulnerability in ITFlow.org before commit v.432488eca3998c5be6b6b9e8f8ba01f54bc12378 allows a remtoe attacker to execute arbitrary code and obtain sensitive information via the settings.php, settings+company.php, settings_defaults.php,settings_integrations.php, settings_invoice.php, settings_localization.php, settings_mail.php components.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-26T16:27:58.897",
    "last_modified": "2024-11-21T09:00:39.500",
    "fix_date": "2023-11-25T16:36:05Z"
  },
  "references": [
    {
      "url": "https://github.com/itflow-org/itflow/commit/432488eca3998c5be6b6b9e8f8ba01f54bc12378",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/itflow-org/itflow/commit/8068cb6081e4760860a634c1066b2c64d0ee2d46",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://itflow.org/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://packetstormsecurity.com/files/177224/ITFlow-Cross-Site-Request-Forgery.html",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/itflow-org/itflow/commit/432488eca3998c5be6b6b9e8f8ba01f54bc12378",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/itflow-org/itflow/commit/8068cb6081e4760860a634c1066b2c64d0ee2d46",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://itflow.org/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://packetstormsecurity.com/files/177224/ITFlow-Cross-Site-Request-Forgery.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.161060",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "itflow",
    "owner": "itflow-org",
    "created_at": "2019-03-13T17:47:57Z",
    "updated_at": "2025-01-26T03:29:38Z",
    "pushed_at": "2025-01-26T02:47:34Z",
    "size": 106641,
    "stars": 626,
    "forks": 160,
    "open_issues": 41,
    "watchers": 626,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 7716599,
      "JavaScript": 1598510,
      "Hack": 30762,
      "CSS": 25652,
      "HTML": 45
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:18:22.014296"
  }
}