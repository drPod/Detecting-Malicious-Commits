{
  "cve_id": "CVE-2024-25629",
  "github_data": {
    "repository": "c-ares/c-ares",
    "fix_commit": "a804c04ddc8245fc8adf0e92368709639125e183",
    "related_commits": [
      "a804c04ddc8245fc8adf0e92368709639125e183",
      "a804c04ddc8245fc8adf0e92368709639125e183"
    ],
    "patch_url": "https://github.com/c-ares/c-ares/commit/a804c04ddc8245fc8adf0e92368709639125e183.patch",
    "fix_commit_details": {
      "sha": "a804c04ddc8245fc8adf0e92368709639125e183",
      "commit_date": "2024-02-22T21:23:33Z",
      "author": {
        "login": "bradh352",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-mg26-v6qh-x48q",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 8,
        "additions": 8,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/lib/ares__read_line.c",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -59,6 +59,14 @@ ares_status_t ares__read_line(FILE *fp, char **buf, size_t *bufsize)\n       return (offset != 0) ? 0 : (ferror(fp)) ? ARES_EFILE : ARES_EOF;\n     }\n     len = offset + ares_strlen(*buf + offset);\n+\n+    /* Probably means there was an embedded NULL as the first character in\n+     * the line, throw away line */\n+    if (len == 0) {\n+      offset = 0;\n+      continue;\n+    }\n+\n     if ((*buf)[len - 1] == '\\n') {\n       (*buf)[len - 1] = 0;\n       break;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9a0d4aed6568f721c0fff0fb18ddb99ba5a5596e",
            "date": "2025-01-14T00:05:03Z",
            "author_login": "bradh352"
          },
          {
            "sha": "0518d404ec8e1be2c4ac2c04698ae96bde2f8b1a",
            "date": "2025-01-09T18:30:03Z",
            "author_login": "bradh352"
          },
          {
            "sha": "5d7abd1f8c0626445026712082e7e4b7835263a4",
            "date": "2025-01-09T00:51:06Z",
            "author_login": "bradh352"
          },
          {
            "sha": "eeea1991b04d19615e8f6fc3e2673c7704456f09",
            "date": "2025-01-08T16:43:30Z",
            "author_login": "bradh352"
          },
          {
            "sha": "0e4271d1b71a1cbcb89e24b1d138321599e3bfb1",
            "date": "2025-01-03T17:55:54Z",
            "author_login": "bradh352"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-127",
    "description": "c-ares is a C library for asynchronous DNS requests. `ares__read_line()` is used to parse local configuration files such as `/etc/resolv.conf`, `/etc/nsswitch.conf`, the `HOSTALIASES` file, and if using a c-ares version prior to 1.27.0, the `/etc/hosts` file. If any of these configuration files has an embedded `NULL` character as the first character in a new line, it can lead to attempting to read memory prior to the start of the given buffer which may result in a crash. This issue is fixed in c-ares 1.27.0. No known workarounds exist.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-23T15:15:09.237",
    "last_modified": "2024-11-21T09:01:06.910",
    "fix_date": "2024-02-22T21:23:33Z"
  },
  "references": [
    {
      "url": "https://github.com/c-ares/c-ares/commit/a804c04ddc8245fc8adf0e92368709639125e183",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/c-ares/c-ares/security/advisories/GHSA-mg26-v6qh-x48q",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2P76QYINQNPEHUTEEDOUYIRZ2X6UVZ5K/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CSCMTSPDIE2UHU34TIXQQHZ6JTE3Y3VF/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GX37LFPFQ3T6FFMMFYQTEGIQXXN7F27U/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/c-ares/c-ares/commit/a804c04ddc8245fc8adf0e92368709639125e183",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/c-ares/c-ares/security/advisories/GHSA-mg26-v6qh-x48q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2P76QYINQNPEHUTEEDOUYIRZ2X6UVZ5K/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CSCMTSPDIE2UHU34TIXQQHZ6JTE3Y3VF/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GX37LFPFQ3T6FFMMFYQTEGIQXXN7F27U/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:28.153708",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "c-ares",
    "owner": "c-ares",
    "created_at": "2010-03-20T19:30:23Z",
    "updated_at": "2025-01-14T00:05:08Z",
    "pushed_at": "2025-01-14T00:05:03Z",
    "size": 9689,
    "stars": 1902,
    "forks": 611,
    "open_issues": 22,
    "watchers": 1902,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C": 1442509,
      "M4": 132084,
      "CMake": 80114,
      "Makefile": 9553,
      "Shell": 5433,
      "Batchfile": 646
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:01:15.405976"
  }
}