{
  "cve_id": "CVE-2024-27092",
  "github_data": {
    "repository": "hoppscotch/hoppscotch",
    "fix_commit": "6827e97ec583b2534cdc1c2f33fa44973a0c2bf5",
    "related_commits": [
      "6827e97ec583b2534cdc1c2f33fa44973a0c2bf5",
      "6827e97ec583b2534cdc1c2f33fa44973a0c2bf5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "6827e97ec583b2534cdc1c2f33fa44973a0c2bf5",
      "commit_date": "2024-02-22T19:35:20Z",
      "author": {
        "login": "AndrewBastin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "refactor: possible links in email templates do not highlight (#3851)",
        "length": 68,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 132,
        "additions": 72,
        "deletions": 60
      },
      "files": [
        {
          "filename": "packages/hoppscotch-backend/src/mailer/mailer.service.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -25,7 +25,7 @@ export class MailerService {\n   ): string {\n     switch (mailDesc.template) {\n       case 'team-invitation':\n-        return `${mailDesc.variables.invitee} invited you to join ${mailDesc.variables.invite_team_name} in Hoppscotch`;\n+        return `A user has invited you to join a team workspace in Hoppscotch`;\n \n       case 'user-invitation':\n         return 'Sign in to Hoppscotch';"
        },
        {
          "filename": "packages/hoppscotch-backend/src/mailer/templates/team-invitation.hbs",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -27,6 +27,12 @@\n       color: #3869D4;\n     }\n \n+    a.nohighlight {\n+      color: inherit !important;\n+      text-decoration: none !important;\n+      cursor: default !important;\n+    }\n+\n     a img {\n       border: none;\n     }\n@@ -458,7 +464,7 @@\n                     <td class=\"content-cell\">\n                       <div class=\"f-fallback\">\n <h1>Hi there,</h1>\n-<p>{{invitee}} with {{invite_team_name}} has invited you to use Hoppscotch to collaborate with them. Click the button below to set up your account and get started:</p>\n+<p><a class=\"nohighlight\" name=\"invitee\" href=\"#\">{{invitee}}</a> with <a class=\"nohighlight\" name=\"invite_team_name\" href=\"#\">{{invite_team_name}}</a> has invited you to use Hoppscotch to collaborate with them. Click the button below to set up your account and get started:</p>\n <!-- Action -->\n <table class=\"body-action\" align=\"center\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\n   <tr>\n@@ -484,7 +490,7 @@\n   Welcome aboard, <br />\n   Your friends at Hoppscotch\n </p>\n-<p><strong>P.S.</strong> If you don't associate with {{invitee}} or {{invite_team_name}}, just ignore this email.</p>\n+<p><strong>P.S.</strong> If you don't associate with <a class=\"nohighlight\" name=\"invitee\" href=\"#\">{{invitee}}</a> or <a class=\"nohighlight\" name=\"invite_team_name\" href=\"#\">{{invite_team_name}}</a>, just ignore this email.</p>\n <!-- Sub copy -->\n <table class=\"body-sub\">\n   <tr>"
        },
        {
          "filename": "packages/hoppscotch-backend/src/mailer/templates/user-invitation.hbs",
          "status": "modified",
          "additions": 63,
          "deletions": 57,
          "patch": "@@ -14,27 +14,33 @@\n   -->\n     <style type=\"text/css\" rel=\"stylesheet\" media=\"all\">\n     /* Base ------------------------------ */\n-    \n+\n     @import url(\"https://fonts.googleapis.com/css?family=Nunito+Sans:400,700&display=swap\");\n     body {\n       width: 100% !important;\n       height: 100%;\n       margin: 0;\n       -webkit-text-size-adjust: none;\n     }\n-    \n+\n     a {\n       color: #3869D4;\n     }\n-    \n+\n+    a.nohighlight {\n+      color: inherit !important;\n+      text-decoration: none !important;\n+      cursor: default !important;\n+    }\n+\n     a img {\n       border: none;\n     }\n-    \n+\n     td {\n       word-break: break-word;\n     }\n-    \n+\n     .preheader {\n       display: none !important;\n       visibility: hidden;\n@@ -47,42 +53,42 @@\n       overflow: hidden;\n     }\n     /* Type ------------------------------ */\n-    \n+\n     body,\n     td,\n     th {\n       font-family: \"Nunito Sans\", Helvetica, Arial, sans-serif;\n     }\n-    \n+\n     h1 {\n       margin-top: 0;\n       color: #333333;\n       font-size: 22px;\n       font-weight: bold;\n       text-align: left;\n     }\n-    \n+\n     h2 {\n       margin-top: 0;\n       color: #333333;\n       font-size: 16px;\n       font-weight: bold;\n       text-align: left;\n     }\n-    \n+\n     h3 {\n       margin-top: 0;\n       color: #333333;\n       font-size: 14px;\n       font-weight: bold;\n       text-align: left;\n     }\n-    \n+\n     td,\n     th {\n       font-size: 16px;\n     }\n-    \n+\n     p,\n     ul,\n     ol,\n@@ -91,25 +97,25 @@\n       font-size: 16px;\n       line-height: 1.625;\n     }\n-    \n+\n     p.sub {\n       font-size: 13px;\n     }\n     /* Utilities ------------------------------ */\n-    \n+\n     .align-right {\n       text-align: right;\n     }\n-    \n+\n     .align-left {\n       text-align: left;\n     }\n-    \n+\n     .align-center {\n       text-align: center;\n     }\n     /* Buttons ------------------------------ */\n-    \n+\n     .button {\n       background-color: #3869D4;\n       border-top: 10px solid #3869D4;\n@@ -124,45 +130,45 @@\n       -webkit-text-size-adjust: none;\n       box-sizing: border-box;\n     }\n-    \n+\n     .button--green {\n       background-color: #22BC66;\n       border-top: 10px solid #22BC66;\n       border-right: 18px solid #22BC66;\n       border-bottom: 10px solid #22BC66;\n       border-left: 18px solid #22BC66;\n     }\n-    \n+\n     .button--red {\n       background-color: #FF6136;\n       border-top: 10px solid #FF6136;\n       border-right: 18px solid #FF6136;\n       border-bottom: 10px solid #FF6136;\n       border-left: 18px solid #FF6136;\n     }\n-    \n+\n     @media only screen and (max-width: 500px) {\n       .button {\n         width: 100% !important;\n         text-align: center !important;\n       }\n     }\n     /* Attribute list ------------------------------ */\n-    \n+\n     .attributes {\n       margin: 0 0 21px;\n     }\n-    \n+\n     .attributes_content {\n       background-color: #F4F4F7;\n       padding: 16px;\n     }\n-    \n+\n     .attributes_item {\n       padding: 0;\n     }\n     /* Related Items ------------------------------ */\n-    \n+\n     .related {\n       width: 100%;\n       margin: 0;\n@@ -171,31 +177,31 @@\n       -premailer-cellpadding: 0;\n       -premailer-cellspacing: 0;\n     }\n-    \n+\n     .related_item {\n       padding: 10px 0;\n       color: #CBCCCF;\n       font-size: 15px;\n       line-height: 18px;\n     }\n-    \n+\n     .related_item-title {\n       display: block;\n       margin: .5em 0 0;\n     }\n-    \n+\n     .related_item-thumb {\n       display: block;\n       padding-bottom: 10px;\n     }\n-    \n+\n     .related_heading {\n       border-top: 1px solid #CBCCCF;\n       text-align: center;\n       padding: 25px 0 10px;\n     }\n     /* Discount Code ------------------------------ */\n-    \n+\n     .discount {\n       width: 100%;\n       margin: 0;\n@@ -206,33 +212,33 @@\n       background-color: #F4F4F7;\n       border: 2px dashed #CBCCCF;\n     }\n-    \n+\n     .discount_heading {\n       text-align: center;\n     }\n-    \n+\n     .discount_body {\n       text-align: center;\n       font-size: 15px;\n     }\n     /* Social Icons ------------------------------ */\n-    \n+\n     .social {\n       width: auto;\n     }\n-    \n+\n     .social td {\n       padding: 0;\n       width: auto;\n     }\n-    \n+\n     .social_icon {\n       height: 20px;\n       margin: 0 8px 10px 8px;\n       padding: 0;\n     }\n     /* Data table ------------------------------ */\n-    \n+\n     .purchase {\n       width: 100%;\n       margin: 0;\n@@ -241,7 +247,7 @@\n       -premailer-cellpadding: 0;\n       -premailer-cellspacing: 0;\n     }\n-    \n+\n     .purchase_content {\n       width: 100%;\n       margin: 0;\n@@ -250,50 +256,50 @@\n       -premailer-cellpadding: 0;\n       -premailer-cellspacing: 0;\n     }\n-    \n+\n     .purchase_item {\n       padding: 10px 0;\n       color: #51545E;\n       font-size: 15px;\n       line-height: 18px;\n     }\n-    \n+\n     .purchase_heading {\n       padding-bottom: 8px;\n       border-bottom: 1px solid #EAEAEC;\n     }\n-    \n+\n     .purchase_heading p {\n       margin: 0;\n       color: #85878E;\n       font-size: 12px;\n     }\n-    \n+\n     .purchase_footer {\n       padding-top: 15px;\n       border-top: 1px solid #EAEAEC;\n     }\n-    \n+\n     .purchase_total {\n       margin: 0;\n       text-align: right;\n       font-weight: bold;\n       color: #333333;\n     }\n-    \n+\n     .purchase_total--label {\n       padding: 0 15px 0 0;\n     }\n-    \n+\n     body {\n       background-color: #F2F4F6;\n       color: #51545E;\n     }\n-    \n+\n     p {\n       color: #51545E;\n     }\n-    \n+\n     .email-wrapper {\n       width: 100%;\n       margin: 0;\n@@ -303,7 +309,7 @@\n       -premailer-cellspacing: 0;\n       background-color: #F2F4F6;\n     }\n-    \n+\n     .email-content {\n       width: 100%;\n       margin: 0;\n@@ -313,16 +319,16 @@\n       -premailer-cellspacing: 0;\n     }\n     /* Masthead ----------------------- */\n-    \n+\n     .email-masthead {\n       padding: 25px 0;\n       text-align: center;\n     }\n-    \n+\n     .email-masthead_logo {\n       width: 94px;\n     }\n-    \n+\n     .email-masthead_name {\n       font-size: 16px;\n       font-weight: bold;\n@@ -331,7 +337,7 @@\n       text-shadow: 0 1px 0 white;\n     }\n     /* Body ------------------------------ */\n-    \n+\n     .email-body {\n       width: 100%;\n       margin: 0;\n@@ -340,7 +346,7 @@\n       -premailer-cellpadding: 0;\n       -premailer-cellspacing: 0;\n     }\n-    \n+\n     .email-body_inner {\n       width: 570px;\n       margin: 0 auto;\n@@ -350,7 +356,7 @@\n       -premailer-cellspacing: 0;\n       background-color: #FFFFFF;\n     }\n-    \n+\n     .email-footer {\n       width: 570px;\n       margin: 0 auto;\n@@ -360,11 +366,11 @@\n       -premailer-cellspacing: 0;\n       text-align: center;\n     }\n-    \n+\n     .email-footer p {\n       color: #A8AAAF;\n     }\n-    \n+\n     .body-action {\n       width: 100%;\n       margin: 30px auto;\n@@ -374,25 +380,25 @@\n       -premailer-cellspacing: 0;\n       text-align: center;\n     }\n-    \n+\n     .body-sub {\n       margin-top: 25px;\n       padding-top: 25px;\n       border-top: 1px solid #EAEAEC;\n     }\n-    \n+\n     .content-cell {\n       padding: 45px;\n     }\n     /*Media Queries ------------------------------ */\n-    \n+\n     @media only screen and (max-width: 600px) {\n       .email-body_inner,\n       .email-footer {\n         width: 100% !important;\n       }\n     }\n-    \n+\n     @media (prefers-color-scheme: dark) {\n       body,\n       .email-body,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b48c982ea69ec086aaa00684261edf262d856ecc",
            "date": "2025-01-15T13:15:18Z",
            "author_login": "jamesgeorge007"
          },
          {
            "sha": "8b70d7f419217d97c232a3b4826428577e6b2268",
            "date": "2025-01-15T13:13:05Z",
            "author_login": "amk-dev"
          },
          {
            "sha": "a16402e94d9bb1e753296210b9c337e92cc666d0",
            "date": "2024-12-23T08:08:49Z",
            "author_login": "amk-dev"
          },
          {
            "sha": "553f4d7a8fcd1453547fa6392b23a96de29959f4",
            "date": "2024-12-23T06:48:06Z",
            "author_login": "amk-dev"
          },
          {
            "sha": "c578b79f39bd43f1d2e835bc09ea3fc72afb24d2",
            "date": "2024-12-20T15:09:12Z",
            "author_login": "Govind-S-B"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-20",
    "description": "Hoppscotch is an API development ecosystem.  Due to lack of validation for fields like Label (Edit Team) - TeamName, bad actors can send emails with Spoofed Content as Hoppscotch. Part of payload (external link) is presented in clickable form - easier to achieve own goals by malicious actors.  This issue is fixed in 2023.12.6.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-29T01:44:19.610",
    "last_modified": "2024-11-21T09:03:50.500",
    "fix_date": "2024-02-22T19:35:20Z"
  },
  "references": [
    {
      "url": "https://github.com/hoppscotch/hoppscotch/blob/main/packages/hoppscotch-backend/src/team-invitation/team-invitation.service.ts#L153",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/hoppscotch/hoppscotch/commit/6827e97ec583b2534cdc1c2f33fa44973a0c2bf5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/hoppscotch/hoppscotch/security/advisories/GHSA-8r6h-8r68-q3pp",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/hoppscotch/hoppscotch/blob/main/packages/hoppscotch-backend/src/team-invitation/team-invitation.service.ts#L153",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/hoppscotch/hoppscotch/commit/6827e97ec583b2534cdc1c2f33fa44973a0c2bf5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/hoppscotch/hoppscotch/security/advisories/GHSA-8r6h-8r68-q3pp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.445208",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "hoppscotch",
    "owner": "hoppscotch",
    "created_at": "2019-08-21T13:15:24Z",
    "updated_at": "2025-01-26T07:49:06Z",
    "pushed_at": "2025-01-24T22:21:04Z",
    "size": 87042,
    "stars": 66640,
    "forks": 4637,
    "open_issues": 545,
    "watchers": 66640,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 2782249,
      "Vue": 1590973,
      "JavaScript": 100461,
      "Rust": 99470,
      "SCSS": 36220,
      "Handlebars": 24416,
      "Dockerfile": 7039,
      "Nix": 6157,
      "HTML": 2452,
      "Shell": 941,
      "CSS": 59
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:11:02.447974"
  }
}