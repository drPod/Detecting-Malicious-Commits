{
  "cve_id": "CVE-2024-27097",
  "github_data": {
    "repository": "ckan/ckan",
    "fix_commit": "81b56c55e5e3651d7fcf9642cd5a489a9b62212c",
    "related_commits": [
      "81b56c55e5e3651d7fcf9642cd5a489a9b62212c",
      "81b56c55e5e3651d7fcf9642cd5a489a9b62212c"
    ],
    "patch_url": "https://github.com/ckan/ckan/commit/81b56c55e5e3651d7fcf9642cd5a489a9b62212c.patch",
    "fix_commit_details": {
      "sha": "81b56c55e5e3651d7fcf9642cd5a489a9b62212c",
      "commit_date": "2024-03-13T12:01:28Z",
      "author": {
        "login": "amercader",
        "type": "User",
        "stats": {
          "total_commits": 3832,
          "average_weekly_commits": 4.076595744680851,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 532
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-8g38-3m6v-232j",
        "length": 76,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 18,
        "additions": 14,
        "deletions": 4
      },
      "files": [
        {
          "filename": "ckan/common.py",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -306,6 +306,15 @@ def aslist(obj: Any, sep: Optional[str] = None, strip: bool = True) -> Any:\n         return [obj]\n \n \n+def repr_untrusted(danger: Any):\n+    \"\"\"\n+    repr-format danger and truncate e.g. for logging untrusted input\n+    \"\"\"\n+    r = repr(danger)\n+    rtrunc = r[:200]\n+    return rtrunc + '\u2026' if r != rtrunc else r\n+\n+\n local = Local()\n \n # This a proxy to the bounded config object"
        },
        {
          "filename": "ckan/views/user.py",
          "status": "modified",
          "additions": 5,
          "deletions": 4,
          "patch": "@@ -25,7 +25,8 @@\n import ckan.plugins as plugins\n from ckan import authz\n from ckan.common import (\n-    _, config, g, request, current_user, login_user, logout_user, session\n+    _, config, g, request, current_user, login_user, logout_user, session,\n+    repr_untrusted\n )\n from ckan.types import Context, Schema, Response\n from ckan.lib import signals\n@@ -675,7 +676,7 @@ def post(self) -> Response:\n         if id in (None, u''):\n             h.flash_error(_(u'Email is required'))\n             return h.redirect_to(u'user.request_reset')\n-        log.info(u'Password reset requested for user \"{}\"'.format(id))\n+        log.info('Password reset requested for user %s', repr_untrusted(id))\n \n         context: Context = {\n             'user': current_user.name,\n@@ -716,8 +717,8 @@ def post(self) -> Response:\n                 pass\n \n         if not user_objs:\n-            log.info(u'User requested reset link for unknown user: {}'\n-                     .format(id))\n+            log.info('User requested reset link for unknown user: %s',\n+                     repr_untrusted(id))\n \n         for user_obj in user_objs:\n             log.info(u'Emailing reset link to user: {}'"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dbf7b7388b521b9d6c84d6b9ac3e276b0ba800b0",
            "date": "2025-01-14T14:21:12Z",
            "author_login": "wardi"
          },
          {
            "sha": "b3318f4cf8266789c6f6c66c147e0863a18999e8",
            "date": "2025-01-14T12:48:24Z",
            "author_login": "Zharktas"
          },
          {
            "sha": "de8c1ecb68ed6f746ca4b95cc133f3078d6c5f5a",
            "date": "2025-01-14T12:36:43Z",
            "author_login": "amercader"
          },
          {
            "sha": "6b02cb5d44b0bb88f430508bee1070e46ffea473",
            "date": "2025-01-14T11:46:50Z",
            "author_login": "Zharktas"
          },
          {
            "sha": "24fbf14092547b5a28091e9920bfd9d415e73edf",
            "date": "2025-01-14T11:36:11Z",
            "author_login": "Zharktas"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-532",
    "description": "A user endpoint didn't perform filtering on an incoming parameter, which was added directly to the application log. This could lead to an attacker injecting false log entries or corrupt the log file format. This has been fixed in the CKAN versions 2.9.11 and 2.10.4. Users are advised to upgrade. Users unable to upgrade should override the `/user/reset` endpoint to filter the `id` parameter in order to exclude newlines.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-13T21:15:58.993",
    "last_modified": "2024-11-21T09:03:51.193",
    "fix_date": "2024-03-13T12:01:28Z"
  },
  "references": [
    {
      "url": "https://github.com/ckan/ckan/commit/81b56c55e5e3651d7fcf9642cd5a489a9b62212c",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ckan/ckan/security/advisories/GHSA-8g38-3m6v-232j",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ckan/ckan/commit/81b56c55e5e3651d7fcf9642cd5a489a9b62212c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ckan/ckan/security/advisories/GHSA-8g38-3m6v-232j",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.492676",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ckan",
    "owner": "ckan",
    "created_at": "2011-11-10T18:42:17Z",
    "updated_at": "2025-01-14T12:36:48Z",
    "pushed_at": "2025-01-14T12:50:06Z",
    "size": 217197,
    "stars": 4529,
    "forks": 2003,
    "open_issues": 756,
    "watchers": 4529,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 4151360,
      "CSS": 1322183,
      "HTML": 752447,
      "JavaScript": 600231,
      "SCSS": 281824,
      "Shell": 7827,
      "PLpgSQL": 4227,
      "Mako": 4140,
      "Gherkin": 3242,
      "Dockerfile": 1045,
      "Smarty": 516
    },
    "commit_activity": {
      "total_commits_last_year": 882,
      "avg_commits_per_week": 16.96153846153846,
      "days_active_last_year": 211
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:17:14.608738"
  }
}