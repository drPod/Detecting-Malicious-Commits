{
  "cve_id": "CVE-2024-27287",
  "github_data": {
    "repository": "esphome/esphome",
    "fix_commit": "37d2b3c7977a4ccbec59726ca7549cb776661455",
    "related_commits": [
      "37d2b3c7977a4ccbec59726ca7549cb776661455",
      "37d2b3c7977a4ccbec59726ca7549cb776661455"
    ],
    "patch_url": "https://github.com/esphome/esphome/commit/37d2b3c7977a4ccbec59726ca7549cb776661455.patch",
    "fix_commit_details": {
      "sha": "37d2b3c7977a4ccbec59726ca7549cb776661455",
      "commit_date": "2024-03-05T19:09:45Z",
      "author": {
        "login": "jesserockz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-9p43-hj5j-96h5",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 1,
        "additions": 1,
        "deletions": 0
      },
      "files": [
        {
          "filename": "esphome/dashboard/web_server.py",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -820,6 +820,7 @@ async def get(self, configuration: str | None = None) -> None:\n             None, self._read_file, filename, configuration\n         )\n         if content is not None:\n+            self.set_header(\"Content-Type\", \"application/yaml\")\n             self.write(content)\n \n     def _read_file(self, filename: str, configuration: str) -> bytes | None:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bdb1094b477baad40cfcf9d9bc86665c14069a55",
            "date": "2025-01-14T03:20:52Z",
            "author_login": "kroimon"
          },
          {
            "sha": "6262fb8fcf9538d161d94512a857755c839eb48d",
            "date": "2025-01-13T21:32:54Z",
            "author_login": "clydebarrow"
          },
          {
            "sha": "f319472066a45c11f4d71e96b39a201f07e7f0dd",
            "date": "2025-01-13T04:35:29Z",
            "author_login": "heythisisnate"
          },
          {
            "sha": "b4a2b50ee092abd0eabbbce6db0c8da1d825464e",
            "date": "2025-01-13T04:34:07Z",
            "author_login": "Hadatko"
          },
          {
            "sha": "30bb806f26853e00c053f1fc69751a61f105b8ee",
            "date": "2025-01-13T04:31:01Z",
            "author_login": "szupi-ipuzs"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "ESPHome is a system to control your ESP8266/ESP32 for Home Automation systems. Starting in version 2023.12.9 and prior to version 2024.2.2, editing the configuration file API in dashboard component of ESPHome version 2023.12.9 (command line installation and Home Assistant add-on) serves unsanitized data with `Content-Type: text/html; charset=UTF-8`, allowing a remote authenticated user to inject arbitrary web script and exfiltrate session cookies via Cross-Site scripting. It is possible for a malicious authenticated user to inject arbitrary Javascript in configuration files using a POST request to the /edit endpoint, the configuration parameter allows to specify the file to write. To trigger the XSS vulnerability, the victim must visit the page` /edit?configuration=[xss file]`. Abusing this vulnerability a malicious actor could perform operations on the dashboard on the behalf of a logged user, access sensitive information, create, edit and delete configuration files and flash firmware on managed boards.\nIn addition to this, cookies are not correctly secured, allowing the exfiltration of session cookie values. Version 2024.2.2 contains a patch for this issue.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-06T19:15:07.723",
    "last_modified": "2024-11-21T09:04:15.180",
    "fix_date": "2024-03-05T19:09:45Z"
  },
  "references": [
    {
      "url": "https://github.com/esphome/esphome/commit/37d2b3c7977a4ccbec59726ca7549cb776661455",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/esphome/esphome/security/advisories/GHSA-9p43-hj5j-96h5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/esphome/esphome/commit/37d2b3c7977a4ccbec59726ca7549cb776661455",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/esphome/esphome/security/advisories/GHSA-9p43-hj5j-96h5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.467541",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "esphome",
    "owner": "esphome",
    "created_at": "2018-04-06T23:23:25Z",
    "updated_at": "2025-01-14T03:20:57Z",
    "pushed_at": "2025-01-14T03:20:52Z",
    "size": 29201,
    "stars": 8805,
    "forks": 3843,
    "open_issues": 380,
    "watchers": 8805,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "beta",
      "dev"
    ],
    "languages": {
      "C++": 9142487,
      "Python": 3859824,
      "C": 17547,
      "Shell": 10543,
      "Dockerfile": 8576,
      "Groovy": 1190,
      "Batchfile": 756
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:36:32.445911"
  }
}