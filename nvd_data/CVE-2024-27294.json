{
  "cve_id": "CVE-2024-27294",
  "github_data": {
    "repository": "danielparks/puppet-golang",
    "fix_commit": "1d0865b24071cb1c00d2fd8cb755d444e6e8f888",
    "related_commits": [
      "1d0865b24071cb1c00d2fd8cb755d444e6e8f888",
      "870724a7fef50208515da7bbfa9dfd5d6950e7f5",
      "1d0865b24071cb1c00d2fd8cb755d444e6e8f888",
      "870724a7fef50208515da7bbfa9dfd5d6950e7f5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "1d0865b24071cb1c00d2fd8cb755d444e6e8f888",
      "commit_date": "2024-02-22T01:27:58Z",
      "author": {
        "login": "danielparks",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Security: ignore file ownership when extracting Go",
        "length": 572,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 34,
        "additions": 33,
        "deletions": 1
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 32,
          "deletions": 0,
          "patch": "@@ -4,6 +4,38 @@ All notable changes to this project will be documented in this file.\n \n ## main branch\n \n+### Security fix\n+\n+Certain Go tarballs (see below) had files owned by non-root users:\n+\n+    \u276f curl -SsL https://go.dev/dl/go1.20.14.darwin-amd64.tar.gz | tar -tzvf - | head -3\n+    drwxr-xr-x  0 0      0           0 Feb  2 10:19 go/\n+    -rw-r--r--  0 gopher wheel    1339 Feb  2 10:09 go/CONTRIBUTING.md\n+    -rw-r--r--  0 gopher wheel    1479 Feb  2 10:09 go/LICENSE\n+\n+In this case, the non-root user in question mapped to the first user created on\n+the macOS system (UID 501).\n+\n+When running as root, previous versions of dp-golang would preserve file\n+ownership when extracting the tarball, even if `owner` was set to something\n+else. **This meant that files, such as the `go` binary, ended up being writable\n+by a non-root user.**\n+\n+This version of dp-golang enables [`tar`]\u2019s `--no-same-owner` and\n+`--no-same-permissions` flags, which cause files to be extracted as the user\n+running Puppet, or as the user/group specified in the Puppet code.\n+\n+GitHub security advisory: [GHSA-8h8m-h98f-vv84]\n+\n+#### Affected Go tarballs\n+\n+  * Go for macOS version 1.4.3 through 1.21rc3, inclusive.\n+  * go1.4-bootstrap-20170518.tar.gz\n+  * go1.4-bootstrap-20170531.tar.gz\n+\n+[`tar`]: https://www.man7.org/linux/man-pages/man1/tar.1.html\n+[GHSA-8h8m-h98f-vv84]: https://github.com/danielparks/puppet-golang/security/advisories/GHSA-8h8m-h98f-vv84\n+\n ## Release 1.2.6\n \n * Synced with [PDK][]."
        },
        {
          "filename": "manifests/from_tarball.pp",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -109,7 +109,7 @@\n       ensure        => present,\n       extract       => true,\n       extract_path  => $go_dir,\n-      extract_flags => '--strip-components 1 -xf',\n+      extract_flags => '--strip-components 1 --no-same-owner --no-same-permissions -xf',\n       user          => $owner,\n       group         => $group,\n       source        => $source,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e90ca49e0f143848d6ddec39f9cfe97d6efe33cd",
            "date": "2024-12-01T20:57:46Z",
            "author_login": "danielparks"
          },
          {
            "sha": "f2fa69df437d8fdcb353d81301036f347a5b2833",
            "date": "2024-12-01T20:33:05Z",
            "author_login": "danielparks"
          },
          {
            "sha": "ecb8f05cebf75f36b9d268d7ab814378da7f4ed3",
            "date": "2024-12-01T20:32:29Z",
            "author_login": "danielparks"
          },
          {
            "sha": "b5ef3311d3887ea3c3e26b8fb41d1787d60a3020",
            "date": "2024-12-01T08:16:44Z",
            "author_login": "danielparks"
          },
          {
            "sha": "6c342460f08bb8685322e00b09e0e34221c50acc",
            "date": "2024-09-04T04:13:23Z",
            "author_login": "danielparks"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:H",
    "cwe_id": "CWE-732",
    "description": "dp-golang is a Puppet module for Go installations.  Prior to 1.2.7, dp-golang could install files \u2014 including the compiler binary \u2014 with the wrong ownership when Puppet was run as root and the installed package was On macOS: Go version 1.4.3 through 1.21rc3, inclusive, go1.4-bootstrap-20170518.tar.gz, or go1.4-bootstrap-20170531.tar.gz. The user and group specified in Puppet code were ignored for files within the archive. dp-puppet version 1.2.7 will recreate installations if the owner or group of any file or directory within that installation does not match the requested owner or group",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-02-29T23:15:08.250",
    "last_modified": "2024-11-21T09:04:15.950",
    "fix_date": "2024-02-22T01:27:58Z"
  },
  "references": [
    {
      "url": "https://github.com/danielparks/puppet-golang/commit/1d0865b24071cb1c00d2fd8cb755d444e6e8f888",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/danielparks/puppet-golang/commit/870724a7fef50208515da7bbfa9dfd5d6950e7f5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/danielparks/puppet-golang/security/advisories/GHSA-8h8m-h98f-vv84",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/danielparks/puppet-golang/commit/1d0865b24071cb1c00d2fd8cb755d444e6e8f888",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/danielparks/puppet-golang/commit/870724a7fef50208515da7bbfa9dfd5d6950e7f5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/danielparks/puppet-golang/security/advisories/GHSA-8h8m-h98f-vv84",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.447822",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "puppet-golang",
    "owner": "danielparks",
    "created_at": "2018-09-13T05:47:50Z",
    "updated_at": "2024-12-01T20:57:50Z",
    "pushed_at": "2024-12-01T20:57:52Z",
    "size": 258,
    "stars": 3,
    "forks": 0,
    "open_issues": 1,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Ruby": 45602,
      "Puppet": 14094,
      "Shell": 3699,
      "Dockerfile": 234
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:08:36.640818"
  }
}