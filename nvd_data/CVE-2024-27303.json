{
  "cve_id": "CVE-2024-27303",
  "github_data": {
    "repository": "electron-userland/electron-builder",
    "fix_commit": "8f4acff3c2d45c1cb07779bb3fe79644408ee387",
    "related_commits": [
      "8f4acff3c2d45c1cb07779bb3fe79644408ee387",
      "8f4acff3c2d45c1cb07779bb3fe79644408ee387"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8f4acff3c2d45c1cb07779bb3fe79644408ee387",
      "commit_date": "2024-02-20T03:02:24Z",
      "author": {
        "login": "mmaietta",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: execute `%SYSTEMROOT%` cmd.exe directly during NSIS installer (#8059)",
        "length": 74,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
      },
      "files": [
        {
          "filename": ".changeset/large-trainers-enjoy.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+\"app-builder-lib\": patch\n+---\n+\n+fix: execute %SYSTEMROOT% cmd.exe directly during NSIS installer"
        },
        {
          "filename": "packages/app-builder-lib/templates/nsis/include/allowOnlyOneInstallerInstance.nsh",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -42,7 +42,7 @@\n     ${nsProcess::FindProcess} \"${_FILE}\" ${_ERR}\n   !else\n     # find process owned by current user\n-    nsExec::Exec `cmd /c tasklist /FI \"USERNAME eq %USERNAME%\" /FI \"IMAGENAME eq ${_FILE}\" /FO csv | %SYSTEMROOT%\\System32\\find.exe \"${_FILE}\"`\n+    nsExec::Exec `%SYSTEMROOT%\\System32\\cmd.exe /c tasklist /FI \"USERNAME eq %USERNAME%\" /FI \"IMAGENAME eq ${_FILE}\" /FO csv | %SYSTEMROOT%\\System32\\find.exe \"${_FILE}\"`\n     Pop ${_ERR}\n   !endif\n !macroend\n@@ -73,7 +73,7 @@\n       !ifdef INSTALL_MODE_PER_ALL_USERS\n         nsExec::Exec `taskkill /im \"${APP_EXECUTABLE_FILENAME}\" /fi \"PID ne $pid\"`\n       !else\n-        nsExec::Exec `cmd /c taskkill /im \"${APP_EXECUTABLE_FILENAME}\" /fi \"PID ne $pid\" /fi \"USERNAME eq %USERNAME%\"`\n+        nsExec::Exec `%SYSTEMROOT%\\System32\\cmd.exe /c taskkill /im \"${APP_EXECUTABLE_FILENAME}\" /fi \"PID ne $pid\" /fi \"USERNAME eq %USERNAME%\"`\n       !endif\n       # to ensure that files are not \"in-use\"\n       Sleep 300\n@@ -91,7 +91,7 @@\n           !ifdef INSTALL_MODE_PER_ALL_USERS\n             nsExec::Exec `taskkill /f /im \"${APP_EXECUTABLE_FILENAME}\" /fi \"PID ne $pid\"`\n           !else\n-            nsExec::Exec `cmd /c taskkill /f /im \"${APP_EXECUTABLE_FILENAME}\" /fi \"PID ne $pid\" /fi \"USERNAME eq %USERNAME%\"`\n+            nsExec::Exec `%SYSTEMROOT%\\System32\\cmd.exe /c taskkill /f /im \"${APP_EXECUTABLE_FILENAME}\" /fi \"PID ne $pid\" /fi \"USERNAME eq %USERNAME%\"`\n           !endif\n           !insertmacro FIND_PROCESS \"${APP_EXECUTABLE_FILENAME}\" $R0\n           ${If} $R0 == 0"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6a7a635f4819ac7a4af56b6c64f9d163d676c029",
            "date": "2025-01-25T15:38:13Z",
            "author_login": "mmaietta"
          },
          {
            "sha": "86a2f180d99664b5e51f321d02526436de7eba2e",
            "date": "2025-01-25T06:10:00Z",
            "author_login": "github-actions[bot]"
          },
          {
            "sha": "c6d6b6e57be2c042dc586ae13f1af38a8a19af41",
            "date": "2025-01-25T04:12:53Z",
            "author_login": "mmaietta"
          },
          {
            "sha": "4a68fd2d3d529b0f854877a5415f9ccad00b61fd",
            "date": "2025-01-25T04:01:39Z",
            "author_login": "erijo"
          },
          {
            "sha": "d954c40b1534bc189a14e619ae285b9c97a9e076",
            "date": "2025-01-25T00:51:13Z",
            "author_login": "mmaietta"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-426",
    "description": "electron-builder is a solution to package and build a ready for distribution Electron, Proton Native app for macOS, Windows and Linux. A vulnerability that only affects eletron-builder prior to 24.13.2 in Windows, the NSIS installer makes a system call to open cmd.exe via NSExec in the `.nsh` installer script. NSExec by default searches the current directory of where the installer is located before searching `PATH`. This means that if an attacker can place a malicious executable file named cmd.exe in the same folder as the installer, the installer will run the malicious file. Version 24.13.2 fixes this issue. No known workaround exists. The code executes at the installer-level before the app is present on the system, so there's no way to check if it exists in a current installer.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-06T19:15:08.553",
    "last_modified": "2024-11-21T09:04:17.120",
    "fix_date": "2024-02-20T03:02:24Z"
  },
  "references": [
    {
      "url": "https://github.com/electron-userland/electron-builder/commit/8f4acff3c2d45c1cb07779bb3fe79644408ee387",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/electron-userland/electron-builder/pull/8059",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/electron-userland/electron-builder/security/advisories/GHSA-r4pf-3v7r-hh55",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/electron-userland/electron-builder/commit/8f4acff3c2d45c1cb07779bb3fe79644408ee387",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/electron-userland/electron-builder/pull/8059",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/electron-userland/electron-builder/security/advisories/GHSA-r4pf-3v7r-hh55",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.468074",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "electron-builder",
    "owner": "electron-userland",
    "created_at": "2015-05-21T07:45:02Z",
    "updated_at": "2025-01-26T05:26:18Z",
    "pushed_at": "2025-01-25T22:43:37Z",
    "size": 138615,
    "stars": 13813,
    "forks": 1749,
    "open_issues": 366,
    "watchers": 13813,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "TypeScript": 1245358,
      "NSIS": 92823,
      "JavaScript": 22344,
      "Shell": 6745,
      "Dockerfile": 4965,
      "Smarty": 369,
      "CSS": 264
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:01:26.434516"
  }
}