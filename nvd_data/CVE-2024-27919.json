{
  "cve_id": "CVE-2024-27919",
  "github_data": {
    "repository": "envoyproxy/envoy",
    "fix_commit": "57a02565532c18eb9df972a3e8974be3ae59f2d5",
    "related_commits": [
      "57a02565532c18eb9df972a3e8974be3ae59f2d5",
      "57a02565532c18eb9df972a3e8974be3ae59f2d5"
    ],
    "patch_url": "https://github.com/envoyproxy/envoy/commit/57a02565532c18eb9df972a3e8974be3ae59f2d5.patch",
    "fix_commit_details": {
      "sha": "57a02565532c18eb9df972a3e8974be3ae59f2d5",
      "commit_date": "2024-03-07T10:29:48Z",
      "author": {
        "login": "RyanTheOptimist",
        "type": "User",
        "stats": {
          "total_commits": 247,
          "average_weekly_commits": 0.5600907029478458,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 109
        }
      },
      "commit_message": {
        "title": "http2: Switch the value of envoy.reloadable_features.http2_use_oghttp2 to false (#32751)",
        "length": 331,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 9,
        "deletions": 1
      },
      "files": [
        {
          "filename": "changelogs/current.yaml",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -2,6 +2,11 @@ date: Pending\n \n behavior_changes:\n # *Changes that are expected to cause an incompatibility if applicable; deployment changes are likely required*\n+- area: http2\n+  change: |\n+    Changes the default value of ``envoy.reloadable_features.http2_use_oghttp2`` to ``false``. This changes the codec used for HTTP/2\n+    requests and responses. A number of users have reported issues with oghttp2 including issue 32611 and issue 32401 This behavior\n+    can be reverted by setting the feature to ``true``.\n \n minor_behavior_changes:\n # *Changes that may cause incompatibilities for some users, but should not for most*"
        },
        {
          "filename": "source/common/runtime/runtime_features.cc",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -56,7 +56,6 @@ RUNTIME_GUARD(envoy_reloadable_features_http1_connection_close_header_in_redirec\n RUNTIME_GUARD(envoy_reloadable_features_http1_use_balsa_parser);\n RUNTIME_GUARD(envoy_reloadable_features_http2_decode_metadata_with_quiche);\n RUNTIME_GUARD(envoy_reloadable_features_http2_discard_host_header);\n-RUNTIME_GUARD(envoy_reloadable_features_http2_use_oghttp2);\n RUNTIME_GUARD(envoy_reloadable_features_http2_validate_authority_with_quiche);\n RUNTIME_GUARD(envoy_reloadable_features_http_allow_partial_urls_in_referer);\n RUNTIME_GUARD(envoy_reloadable_features_http_filter_avoid_reentrant_local_reply);\n@@ -100,6 +99,10 @@ RUNTIME_GUARD(envoy_restart_features_send_goaway_for_premature_rst_streams);\n RUNTIME_GUARD(envoy_restart_features_udp_read_normalize_addresses);\n \n // Begin false flags. These should come with a TODO to flip true.\n+\n+// TODO(birenroy) Flip this to true after resolving issues.\n+// Ignore the automated \"remove this flag\" issue: we should keep this for 1 year.\n+FALSE_RUNTIME_GUARD(envoy_reloadable_features_http2_use_oghttp2);\n // Sentinel and test flag.\n FALSE_RUNTIME_GUARD(envoy_reloadable_features_test_feature_false);\n // TODO(paul-r-gall) Make this enabled by default after additional soak time."
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c93cf7af47f7e24c83b563d3b956074333bc4bf7",
            "date": "2025-01-14T17:23:07Z",
            "author_login": "phlax"
          },
          {
            "sha": "078dae3549912e632c3776a5e9a4679226093276",
            "date": "2025-01-14T14:27:08Z",
            "author_login": "agrawroh"
          },
          {
            "sha": "7b20933ee263eb9aeaceee6bc309b80b997cbbb2",
            "date": "2025-01-14T14:13:49Z",
            "author_login": "phlax"
          },
          {
            "sha": "03cb8d59f80a2a75d9e1289c909e5979a79ace91",
            "date": "2025-01-13T06:31:54Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3487b225f48717dd5a2babb5f921df4353633cee",
            "date": "2025-01-13T06:10:11Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-390",
    "description": "Envoy is a cloud-native, open-source edge and service proxy. In versions 1.29.0 and 1.29.1, theEnvoy HTTP/2 protocol stack is vulnerable to the flood of CONTINUATION frames. Envoy's HTTP/2 codec does not reset a request when header map limits have been exceeded. This allows an attacker to send an sequence of CONTINUATION frames without the END_HEADERS bit set causing unlimited memory consumption. This can lead to denial of service through memory exhaustion. Users should upgrade to versions 1.29.2 to mitigate the effects of the CONTINUATION flood. Note that this vulnerability is a regression in Envoy version 1.29.0 and 1.29.1 only. As a workaround, downgrade to version 1.28.1 or earlier or disable HTTP/2 protocol for downstream connections.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-04T15:15:38.207",
    "last_modified": "2024-11-21T09:05:25.420",
    "fix_date": "2024-03-07T10:29:48Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/03/16",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/05/3",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/envoyproxy/envoy/commit/57a02565532c18eb9df972a3e8974be3ae59f2d5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-gghf-vfxp-799r",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/03/16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/05/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/envoyproxy/envoy/commit/57a02565532c18eb9df972a3e8974be3ae59f2d5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-gghf-vfxp-799r",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.423490",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "envoy",
    "owner": "envoyproxy",
    "created_at": "2016-08-08T15:07:24Z",
    "updated_at": "2025-01-14T12:22:22Z",
    "pushed_at": "2025-01-14T05:36:17Z",
    "size": 240648,
    "stars": 25321,
    "forks": 4848,
    "open_issues": 1639,
    "watchers": 25321,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C++": 48293036,
      "Starlark": 3105942,
      "Java": 1320095,
      "Python": 605206,
      "Assembly": 327095,
      "Kotlin": 309606,
      "Swift": 250537,
      "Shell": 229801,
      "Go": 183281,
      "Rust": 107190,
      "JavaScript": 66339,
      "C": 61597,
      "Objective-C++": 55490,
      "Objective-C": 48840,
      "Jinja": 47798,
      "Smarty": 3528,
      "CSS": 2927,
      "HTML": 1522,
      "Emacs Lisp": 966,
      "Dockerfile": 960,
      "Thrift": 748,
      "PureBasic": 472,
      "Batchfile": 439,
      "Makefile": 303
    },
    "commit_activity": {
      "total_commits_last_year": 3286,
      "avg_commits_per_week": 63.19230769230769,
      "days_active_last_year": 303
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T12:55:59.245540"
  }
}