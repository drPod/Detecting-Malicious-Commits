{
  "cve_id": "CVE-2024-28103",
  "github_data": {
    "repository": "rails/rails",
    "fix_commit": "35858f1d9d57f6c4050a8d9ab754bd5d088b4523",
    "related_commits": [
      "35858f1d9d57f6c4050a8d9ab754bd5d088b4523",
      "35858f1d9d57f6c4050a8d9ab754bd5d088b4523"
    ],
    "patch_url": "https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523.patch",
    "fix_commit_details": {
      "sha": "35858f1d9d57f6c4050a8d9ab754bd5d088b4523",
      "commit_date": "2024-02-27T15:03:50Z",
      "author": {
        "login": "fresh-eggs",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "include the HTTP Permissions-Policy on non-HTML Content-Types",
        "length": 403,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 2,
        "deletions": 9
      },
      "files": [
        {
          "filename": "actionpack/lib/action_dispatch/http/permissions_policy.rb",
          "status": "modified",
          "additions": 0,
          "deletions": 7,
          "patch": "@@ -37,7 +37,6 @@ def initialize(app)\n       def call(env)\n         _, headers, _ = response = @app.call(env)\n \n-        return response unless html_response?(headers)\n         return response if policy_present?(headers)\n \n         request = ActionDispatch::Request.new(env)\n@@ -54,12 +53,6 @@ def call(env)\n       end\n \n       private\n-        def html_response?(headers)\n-          if content_type = headers[Rack::CONTENT_TYPE]\n-            content_type.include?(\"html\")\n-          end\n-        end\n-\n         def policy_present?(headers)\n           headers[ActionDispatch::Constants::FEATURE_POLICY]\n         end"
        },
        {
          "filename": "actionpack/test/dispatch/permissions_policy_test.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -69,12 +69,12 @@ def call(env)\n     assert_equal \"gyroscope 'self'\", response.headers[ActionDispatch::Constants::FEATURE_POLICY]\n   end\n \n-  test \"non-html requests will not set a policy\" do\n+  test \"non-html requests will set a policy\" do\n     @app = build_app(->(env) { [200, { Rack::CONTENT_TYPE => \"application/json\" }, []] })\n \n     get \"/index\"\n \n-    assert_nil response.headers[ActionDispatch::Constants::FEATURE_POLICY]\n+    assert_equal \"gyroscope 'self'\", response.headers[ActionDispatch::Constants::FEATURE_POLICY]\n   end\n \n   test \"existing policies will not be overwritten\" do"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "20a0e51589536f26969ed799bdb866f31e7c746e",
            "date": "2025-01-14T19:10:01Z",
            "author_login": "gmcgibbon"
          },
          {
            "sha": "116a5e4309a189f9111c85334c418856b81cd91a",
            "date": "2025-01-14T17:51:07Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "9b7bb7bdea55a6a30bc833e031101a672d4a2593",
            "date": "2025-01-14T17:45:10Z",
            "author_login": "fatkodima"
          },
          {
            "sha": "72d1704546e7d135950f24edb6c29bb2253aa6f8",
            "date": "2025-01-14T17:34:01Z",
            "author_login": "skipkayhil"
          },
          {
            "sha": "be42d45578d9f002cd3e6cd60ba0466392ae5d4a",
            "date": "2025-01-13T23:18:15Z",
            "author_login": "skipkayhil"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-20",
    "description": "Action Pack is a framework for handling and responding to web requests. Since 6.1.0, the application configurable Permissions-Policy is only served on responses with an HTML related Content-Type. This vulnerability is fixed in  6.1.7.8, 7.0.8.2, and 7.1.3.3.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-04T20:15:10.237",
    "last_modified": "2024-12-06T14:15:20.130",
    "fix_date": "2024-02-27T15:03:50Z"
  },
  "references": [
    {
      "url": "https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20241206-0002/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.337608",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "rails",
    "owner": "rails",
    "created_at": "2008-04-11T02:19:47Z",
    "updated_at": "2025-01-14T12:51:57Z",
    "pushed_at": "2025-01-14T12:53:28Z",
    "size": 261740,
    "stars": 56313,
    "forks": 21746,
    "open_issues": 1251,
    "watchers": 56313,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0-5-stable",
      "0-6-stable",
      "0-7-stable",
      "0-8-stable",
      "1-2-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "2-3-stable",
      "3-0-stable",
      "3-1-stable",
      "3-2-stable",
      "4-0-stable",
      "4-1-stable",
      "4-2-stable",
      "5-0-stable",
      "5-1-stable",
      "5-2-stable",
      "6-0-stable",
      "6-1-stable",
      "7-0-stable",
      "7-1-stable",
      "7-2-stable"
    ],
    "languages": {
      "Ruby": 17127894,
      "JavaScript": 228210,
      "HTML": 196993,
      "SCSS": 50596,
      "CSS": 47127,
      "Dockerfile": 2019,
      "Shell": 668
    },
    "commit_activity": {
      "total_commits_last_year": 3989,
      "avg_commits_per_week": 76.71153846153847,
      "days_active_last_year": 351
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T12:56:52.447177"
  }
}