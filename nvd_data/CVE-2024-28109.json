{
  "cve_id": "CVE-2024-28109",
  "github_data": {
    "repository": "veraPDF/veraPDF-library",
    "fix_commit": "614ffa477a2cf0819e4b0df1ab133610e0da25fb",
    "related_commits": [
      "614ffa477a2cf0819e4b0df1ab133610e0da25fb",
      "9386ecbe1a1d1fb9e886d19df28851ed07890d9f",
      "d5314cbdf4e058e0716f80dbdad2dbd8d96e6bfe",
      "614ffa477a2cf0819e4b0df1ab133610e0da25fb",
      "9386ecbe1a1d1fb9e886d19df28851ed07890d9f",
      "d5314cbdf4e058e0716f80dbdad2dbd8d96e6bfe"
    ],
    "patch_url": "https://github.com/veraPDF/veraPDF-library/commit/614ffa477a2cf0819e4b0df1ab133610e0da25fb.patch",
    "fix_commit_details": {
      "sha": "614ffa477a2cf0819e4b0df1ab133610e0da25fb",
      "commit_date": "2024-03-12T09:34:37Z",
      "author": {
        "login": "MaximPlusov",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Set secure parameter for xslt transformation",
        "length": 44,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 54,
        "additions": 48,
        "deletions": 6
      },
      "files": [
        {
          "filename": "core/src/main/java/org/verapdf/policy/PolicyChecker.java",
          "status": "modified",
          "additions": 16,
          "deletions": 4,
          "patch": "@@ -20,15 +20,15 @@\n import org.verapdf.core.VeraPDFException;\n import org.verapdf.core.utils.FileUtils;\n \n-import javax.xml.transform.Templates;\n-import javax.xml.transform.Transformer;\n-import javax.xml.transform.TransformerException;\n-import javax.xml.transform.TransformerFactory;\n+import javax.xml.XMLConstants;\n+import javax.xml.transform.*;\n import javax.xml.transform.stream.StreamResult;\n import javax.xml.transform.stream.StreamSource;\n import java.io.*;\n import java.util.Arrays;\n import java.util.List;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n \n /**\n  * The veraPDF policy checker which is simply an abstraction that makes applying\n@@ -39,6 +39,9 @@\n  * @version 0.1 Created 12 Dec 2016:17:51:12\n  */\n public final class PolicyChecker {\n+\n+\tprivate static final Logger LOGGER = Logger.getLogger(PolicyChecker.class.getCanonicalName());\n+\n \tprivate static final TransformerFactory factory = TransformerFactory.newInstance();\n \tpublic static final String SCHEMA_EXT = \"sch\"; //$NON-NLS-1$\n \tpublic static final String XSL_EXT = \"xsl\"; //$NON-NLS-1$\n@@ -60,6 +63,15 @@ public final class PolicyChecker {\n \tprivate static final String mergeXsl = resourcePath + \"MergeMrrPolicy\" + '.' + XSL_EXT; //$NON-NLS-1$\n \tprivate static final Templates cachedMergeXsl = SchematronPipeline.createCachedTransform(mergeXsl);\n \n+\tstatic {\n+\t\ttry {\n+\t\t\tfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n+\t\t\tfactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"file\");\n+\t\t} catch (TransformerConfigurationException ignored) {\n+\t\t\tLOGGER.log(Level.WARNING, \"Unable to secure xsl transformer\");\n+\t\t}\n+\t}\n+\n \tprivate PolicyChecker() {\n \n \t}"
        },
        {
          "filename": "core/src/main/java/org/verapdf/policy/SchematronPipeline.java",
          "status": "modified",
          "additions": 16,
          "deletions": 2,
          "patch": "@@ -17,6 +17,7 @@\n  */\n package org.verapdf.policy;\n \n+import javax.xml.XMLConstants;\n import javax.xml.transform.*;\n import javax.xml.transform.stream.StreamResult;\n import javax.xml.transform.stream.StreamSource;\n@@ -31,8 +32,7 @@\n  */\n \n final class SchematronPipeline {\n-\tprivate static final Logger LOGGER = Logger\n-\t\t\t.getLogger(SchematronPipeline.class.getName());\n+\tprivate static final Logger LOGGER = Logger.getLogger(SchematronPipeline.class.getName());\n \n \tstatic final ClassLoader cl = SchematronPipeline.class.getClassLoader();\n \tprivate static final TransformerFactory factory = getTransformerFactory();\n@@ -45,6 +45,15 @@ final class SchematronPipeline {\n \tprivate static final Templates cachedExpXsl = createCachedTransform(isoExpXsl);\n \tprivate static final Templates cachedIsoSvrlXsl = createCachedTransform(isoSvrlXsl);\n \n+\tstatic {\n+\t\ttry {\n+\t\t\tfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n+\t\t\tfactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"file\");\n+\t\t} catch (TransformerConfigurationException ignored) {\n+\t\t\tLOGGER.log(Level.WARNING, \"Unable to secure xsl transformer\");\n+\t\t}\n+\t}\n+\n \tprivate SchematronPipeline() {\n \t}\n \n@@ -85,6 +94,11 @@ private static File createTempFileResult(final Transformer transformer, final St\n \n \tprivate static TransformerFactory getTransformerFactory() {\n \t\tTransformerFactory fact = TransformerFactory.newInstance();\n+\t\ttry {\n+\t\t\tfact.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n+\t\t\tfact.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"file\");\n+\t\t} catch (TransformerConfigurationException ignored) {\n+\t\t}\n \t\tfact.setURIResolver(new ClasspathResourceURIResolver());\n \t\treturn fact;\n \t}"
        },
        {
          "filename": "core/src/main/java/org/verapdf/report/XsltTransformer.java",
          "status": "modified",
          "additions": 16,
          "deletions": 0,
          "patch": "@@ -23,8 +23,12 @@\n import java.io.InputStream;\n import java.io.PrintWriter;\n import java.util.Map;\n+import java.util.logging.Level;\n+import java.util.logging.Logger;\n \n+import javax.xml.XMLConstants;\n import javax.xml.transform.Transformer;\n+import javax.xml.transform.TransformerConfigurationException;\n import javax.xml.transform.TransformerException;\n import javax.xml.transform.TransformerFactory;\n import javax.xml.transform.stream.StreamResult;\n@@ -34,8 +38,20 @@\n  * @author Maksim Bezrukov\n  */\n public final class XsltTransformer {\n+\n+\tprivate static final Logger LOGGER = Logger.getLogger(XsltTransformer.class.getCanonicalName());\n+\n \tprivate static final TransformerFactory factory = TransformerFactory.newInstance();\n \n+\tstatic {\n+\t\ttry {\n+\t\t\tfactory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n+\t\t\tfactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"file\");\n+\t\t} catch (TransformerConfigurationException ignored) {\n+\t\t\tLOGGER.log(Level.WARNING, \"Unable to secure xslt transformer\");\n+\t\t}\n+\t}\n+\t\n \tprivate XsltTransformer() {\n \t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6b0c8d49bac27e7680a43fc9177bbe5f2d681eb7",
            "date": "2025-01-13T09:31:55Z",
            "author_login": null
          },
          {
            "sha": "6d08807d06af50efcc7665ede0ca9c981dc2dcc2",
            "date": "2025-01-04T22:12:32Z",
            "author_login": "MaximPlusov"
          },
          {
            "sha": "69513642cd0c1bcbf17f4a6e325d56c6d33d48c5",
            "date": "2024-12-04T11:26:49Z",
            "author_login": "MaximPlusov"
          },
          {
            "sha": "58289be196925b8a9b111dc0ed13fcd9805ec65b",
            "date": "2024-11-08T09:09:43Z",
            "author_login": null
          },
          {
            "sha": "37da4eca4d5d280f1f3c48aa9bc2c3002d447155",
            "date": "2024-11-04T11:16:42Z",
            "author_login": "MaximPlusov"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
    "cwe_id": "CWE-91",
    "description": "veraPDF-library is a PDF/A validation library. Executing policy checks using custom schematron files invokes an XSL transformation that could lead to a remote code execution (RCE) vulnerability. This vulnerability is fixed in 1.24.2.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-28T14:15:13.863",
    "last_modified": "2024-11-21T09:05:50.020",
    "fix_date": "2024-03-12T09:34:37Z"
  },
  "references": [
    {
      "url": "https://github.com/veraPDF/veraPDF-library/commit/614ffa477a2cf0819e4b0df1ab133610e0da25fb",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/commit/9386ecbe1a1d1fb9e886d19df28851ed07890d9f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/commit/d5314cbdf4e058e0716f80dbdad2dbd8d96e6bfe",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/issues/1415",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/security/advisories/GHSA-qxqf-2mfx-x8jw",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/commit/614ffa477a2cf0819e4b0df1ab133610e0da25fb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/commit/9386ecbe1a1d1fb9e886d19df28851ed07890d9f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/commit/d5314cbdf4e058e0716f80dbdad2dbd8d96e6bfe",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/issues/1415",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/veraPDF/veraPDF-library/security/advisories/GHSA-qxqf-2mfx-x8jw",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.921401",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "veraPDF-library",
    "owner": "veraPDF",
    "created_at": "2015-04-22T10:23:22Z",
    "updated_at": "2025-01-13T09:32:00Z",
    "pushed_at": "2025-01-13T09:36:11Z",
    "size": 33750,
    "stars": 280,
    "forks": 47,
    "open_issues": 34,
    "watchers": 280,
    "has_security_policy": false,
    "default_branch": "integration",
    "protected_branches": [
      "arlington",
      "integration",
      "jakarta",
      "jakarta-master",
      "master"
    ],
    "languages": {
      "Java": 2027374,
      "XSLT": 266691,
      "HTML": 3883
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:15:17.171909"
  }
}