{
  "cve_id": "CVE-2024-28110",
  "github_data": {
    "repository": "cloudevents/sdk-go",
    "fix_commit": "de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851",
    "related_commits": [
      "de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851",
      "de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851",
      "commit_date": "2024-03-06T14:02:25Z",
      "author": {
        "login": "duglin",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-5pf6-2qwx-pxm2",
        "length": 90,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "v2/protocol/http/protocol.go",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -102,7 +102,10 @@ func New(opts ...Option) (*Protocol, error) {\n \t}\n \n \tif p.Client == nil {\n-\t\tp.Client = http.DefaultClient\n+\t\t// This is how http.DefaultClient is initialized. We do not just use\n+\t\t// that because when WithRoundTripper is used, it will change the client's\n+\t\t// transport, which would cause that transport to be used process-wide.\n+\t\tp.Client = &http.Client{}\n \t}\n \n \tif p.roundTripper != nil {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "46808b5c6b60e8f9275a010d685dcb3bab95b9a1",
            "date": "2025-01-21T19:22:10Z",
            "author_login": "embano1"
          },
          {
            "sha": "69568d2f6ff8c0ff4d8890568ac96dbe2c391d44",
            "date": "2025-01-21T13:16:02Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a1fb808c89012524113a9690f04bfc591b0877c2",
            "date": "2025-01-17T14:40:10Z",
            "author_login": "duglin"
          },
          {
            "sha": "b6d364044e1852cf017b22549bc10d18edc149c0",
            "date": "2025-01-17T13:27:07Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "7e6729c161a14a2a0c29b607c92b7cf525313136",
            "date": "2025-01-11T15:18:58Z",
            "author_login": "embano1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-522",
    "description": "Go SDK for CloudEvents is the official CloudEvents SDK to integrate applications with CloudEvents. Prior to version 2.15.2, using cloudevents.WithRoundTripper to create a cloudevents.Client with an authenticated http.RoundTripper causes the go-sdk to leak credentials to arbitrary endpoints. When the transport is populated with an authenticated transport, then http.DefaultClient is modified with the authenticated transport and will start to send Authorization tokens to any endpoint it is used to contact. Version 2.15.2 patches this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-06T22:15:57.550",
    "last_modified": "2024-11-21T09:05:50.160",
    "fix_date": "2024-03-06T14:02:25Z"
  },
  "references": [
    {
      "url": "https://github.com/cloudevents/sdk-go/blob/67e389964131d55d65cd14b4eb32d57a47312695/v2/protocol/http/protocol.go#L104-L110",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/cloudevents/sdk-go/commit/de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/cloudevents/sdk-go/security/advisories/GHSA-5pf6-2qwx-pxm2",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/cloudevents/sdk-go/blob/67e389964131d55d65cd14b4eb32d57a47312695/v2/protocol/http/protocol.go#L104-L110",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/cloudevents/sdk-go/commit/de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/cloudevents/sdk-go/security/advisories/GHSA-5pf6-2qwx-pxm2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.469165",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "sdk-go",
    "owner": "cloudevents",
    "created_at": "2018-06-25T18:31:51Z",
    "updated_at": "2025-01-23T08:54:52Z",
    "pushed_at": "2025-01-21T19:22:11Z",
    "size": 4313,
    "stars": 853,
    "forks": 227,
    "open_issues": 125,
    "watchers": 853,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Go": 1203985,
      "Shell": 10820,
      "Gnuplot": 9243,
      "ANTLR": 3967
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:29:52.081211"
  }
}