{
  "cve_id": "CVE-2024-28176",
  "github_data": {
    "repository": "panva/jose",
    "fix_commit": "02a65794f7873cdaf12e81e80ad076fcdc4a9314",
    "related_commits": [
      "02a65794f7873cdaf12e81e80ad076fcdc4a9314",
      "1b91d88d2f8233f3477a5f4579aa5f8057b2ee8b",
      "02a65794f7873cdaf12e81e80ad076fcdc4a9314",
      "1b91d88d2f8233f3477a5f4579aa5f8057b2ee8b"
    ],
    "patch_url": "https://github.com/panva/jose/commit/02a65794f7873cdaf12e81e80ad076fcdc4a9314.patch",
    "fix_commit_details": {
      "sha": "02a65794f7873cdaf12e81e80ad076fcdc4a9314",
      "commit_date": "2024-03-07T11:02:29Z",
      "author": {
        "login": "panva",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: add a maxOutputLength option to zlib inflate",
        "length": 49,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 30,
        "additions": 28,
        "deletions": 2
      },
      "files": [
        {
          "filename": "docs/README.md",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -1494,6 +1494,8 @@ operation.\n     Count) Header Parameter value. The PBKDF2 iteration count defines the algorithm's computational\n     expense.\n     **Default:** '10000'\n+  - `inflateRawSyncLimit`: `number` Limits compressed JWE plaintext output size.\n+    **Default:** '250000'\n   - `complete`: `<boolean>` When true returns an object with the parsed headers, verified\n     AAD, the content encryption key, the key that was used to unwrap or derive the content\n     encryption key, and cleartext instead of only the cleartext."
        },
        {
          "filename": "lib/jwe/decrypt.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -52,7 +52,7 @@ const validateAlgorithms = (algorithms, option) => {\n /*\n  * @public\n  */\n-const jweDecrypt = (skipValidateHeaders, serialization, jwe, key, { crit = [], complete = false, keyManagementAlgorithms, contentEncryptionAlgorithms, maxPBES2Count = 10000 } = {}) => {\n+const jweDecrypt = (skipValidateHeaders, serialization, jwe, key, { crit = [], complete = false, keyManagementAlgorithms, contentEncryptionAlgorithms, maxPBES2Count = 10000, inflateRawSyncLimit = 250000 } = {}) => {\n   key = getKey(key, true)\n \n   keyManagementAlgorithms = validateAlgorithms(keyManagementAlgorithms, 'keyManagementAlgorithms')\n@@ -189,7 +189,7 @@ const jweDecrypt = (skipValidateHeaders, serialization, jwe, key, { crit = [], c\n     let cleartext = decrypt(enc, cek, base64url.decodeToBuffer(ciphertext), { iv, tag, aad: adata })\n \n     if (opts.zip) {\n-      cleartext = inflateRawSync(cleartext)\n+      cleartext = inflateRawSync(cleartext, { maxOutputLength: inflateRawSyncLimit })\n     }\n \n     if (complete) {"
        },
        {
          "filename": "test/jwe/sanity.test.js",
          "status": "modified",
          "additions": 23,
          "deletions": 0,
          "patch": "@@ -1,4 +1,5 @@\n const test = require('ava')\n+const crypto = require('crypto')\n \n const base64url = require('../../lib/help/base64url')\n const { JWKS, JWK: { generateSync }, JWE, errors } = require('../..')\n@@ -616,3 +617,25 @@ if (!('electron' in process.versions)) {\n     }, { instanceOf: errors.JWEInvalid, message: 'JOSE Header \"p2c\" (PBES2 Count) out is of acceptable bounds' })\n   })\n }\n+\n+test('Compressed JWE output length limit', t => {\n+  const k = generateSync('oct', 256)\n+  {\n+    const jwe = JWE.encrypt(crypto.randomBytes(250000), k, { alg: 'dir', enc: 'A128CBC-HS256', zip: 'DEF' })\n+    t.notThrows(() => {\n+      JWE.decrypt(jwe, k)\n+    })\n+  }\n+  {\n+    const jwe = JWE.encrypt(crypto.randomBytes(250000 + 1), k, { alg: 'dir', enc: 'A128CBC-HS256', zip: 'DEF' })\n+    t.throws(() => {\n+      JWE.decrypt(jwe, k)\n+    })\n+  }\n+  {\n+    const jwe = JWE.encrypt(crypto.randomBytes(1001), k, { alg: 'dir', enc: 'A128CBC-HS256', zip: 'DEF' })\n+    t.throws(() => {\n+      JWE.decrypt(jwe, k, { inflateRawSyncLimit: 1000 })\n+    })\n+  }\n+})"
        },
        {
          "filename": "types/index.d.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -402,6 +402,7 @@ export namespace JWE {\n     contentEncryptionAlgorithms?: string[];\n     keyManagementAlgorithms?: string[];\n     maxPBES2Count?: number;\n+    inflateRawSyncLimit?: number;\n   }\n \n   interface completeDecrypt {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "08be0340ea04eef260bfc206a7962011d1f9ba14",
            "date": "2024-12-02T16:20:01Z",
            "author_login": "panva"
          },
          {
            "sha": "0d9f5f15a9b4f7966e09e192d93841a4eec387b3",
            "date": "2024-12-02T22:18:48Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "1e8b430b08a18a18883a69e7991832c9c602ca1a",
            "date": "2024-11-25T11:27:55Z",
            "author_login": "panva"
          },
          {
            "sha": "a05fa5403791ecb795e9d23eae04d47315796497",
            "date": "2024-11-12T09:30:12Z",
            "author_login": "panva"
          },
          {
            "sha": "626d96592984bbee67ead9cd4425c568b50243f8",
            "date": "2024-11-11T20:26:07Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "jose is JavaScript module for JSON Object Signing and Encryption, providing support for JSON Web Tokens (JWT), JSON Web Signature (JWS), JSON Web Encryption (JWE), JSON Web Key (JWK), JSON Web Key Set (JWKS), and more. A vulnerability has \n been identified in the JSON Web Encryption (JWE) decryption interfaces, specifically related to the support for decompressing plaintext after its decryption. Under certain conditions it is possible to have the user's environment consume unreasonable amount of CPU time or memory during JWE Decryption operations. This issue has been patched in versions 2.0.7 and 4.15.5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-09T01:15:07.147",
    "last_modified": "2024-11-21T09:05:57.947",
    "fix_date": "2024-03-07T11:02:29Z"
  },
  "references": [
    {
      "url": "https://github.com/panva/jose/commit/02a65794f7873cdaf12e81e80ad076fcdc4a9314",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/panva/jose/commit/1b91d88d2f8233f3477a5f4579aa5f8057b2ee8b",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/panva/jose/security/advisories/GHSA-hhhv-q57g-882q",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/I6MMWFBOXJA6ZCXNVPDFJ4XMK5PVG5RG/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KXKGNCRU7OTM5AHC7YIYBNOWI742PRMY/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UG5FSEYJ3GP27FZXC5YAAMMEC5XWKJHG/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UJO2U5ACZVACNQXJ5EBRFLFW6DP5BROY/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XJDO5VSIAOGT2WP63AXAAWNRSVJCNCRH/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/panva/jose/commit/02a65794f7873cdaf12e81e80ad076fcdc4a9314",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/panva/jose/commit/1b91d88d2f8233f3477a5f4579aa5f8057b2ee8b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/panva/jose/security/advisories/GHSA-hhhv-q57g-882q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/I6MMWFBOXJA6ZCXNVPDFJ4XMK5PVG5RG/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KXKGNCRU7OTM5AHC7YIYBNOWI742PRMY/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UG5FSEYJ3GP27FZXC5YAAMMEC5XWKJHG/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UJO2U5ACZVACNQXJ5EBRFLFW6DP5BROY/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XJDO5VSIAOGT2WP63AXAAWNRSVJCNCRH/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.475755",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "jose",
    "owner": "panva",
    "created_at": "2018-11-06T08:46:01Z",
    "updated_at": "2025-01-14T07:32:48Z",
    "pushed_at": "2024-12-18T07:45:15Z",
    "size": 13753,
    "stars": 5942,
    "forks": 322,
    "open_issues": 0,
    "watchers": 5942,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v1.x",
      "v2.x",
      "v3.x",
      "v4.x",
      "v5.x"
    ],
    "languages": {
      "TypeScript": 344157,
      "JavaScript": 203852,
      "Shell": 3730
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:09:13.499249"
  }
}