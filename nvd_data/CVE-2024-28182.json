{
  "cve_id": "CVE-2024-28182",
  "github_data": {
    "repository": "nghttp2/nghttp2",
    "fix_commit": "00201ecd8f982da3b67d4f6868af72a1b03b14e0",
    "related_commits": [
      "00201ecd8f982da3b67d4f6868af72a1b03b14e0",
      "d71a4668c6bead55805d18810d633fbb98315af9",
      "00201ecd8f982da3b67d4f6868af72a1b03b14e0",
      "d71a4668c6bead55805d18810d633fbb98315af9"
    ],
    "patch_url": "https://github.com/nghttp2/nghttp2/commit/00201ecd8f982da3b67d4f6868af72a1b03b14e0.patch",
    "fix_commit_details": {
      "sha": "00201ecd8f982da3b67d4f6868af72a1b03b14e0",
      "commit_date": "2024-03-09T07:26:42Z",
      "author": {
        "login": "tatsuhiro-t",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Limit CONTINUATION frames following an incoming HEADER frame",
        "length": 60,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 26,
        "additions": 25,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/includes/nghttp2/nghttp2.h",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -466,7 +466,12 @@ typedef enum {\n    * exhaustion on server side to send these frames forever and does\n    * not read network.\n    */\n-  NGHTTP2_ERR_FLOODED = -904\n+  NGHTTP2_ERR_FLOODED = -904,\n+  /**\n+   * When a local endpoint receives too many CONTINUATION frames\n+   * following a HEADER frame.\n+   */\n+  NGHTTP2_ERR_TOO_MANY_CONTINUATIONS = -905,\n } nghttp2_error;\n \n /**"
        },
        {
          "filename": "lib/nghttp2_helper.c",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -336,6 +336,8 @@ const char *nghttp2_strerror(int error_code) {\n            \"closed\";\n   case NGHTTP2_ERR_TOO_MANY_SETTINGS:\n     return \"SETTINGS frame contained more than the maximum allowed entries\";\n+  case NGHTTP2_ERR_TOO_MANY_CONTINUATIONS:\n+    return \"Too many CONTINUATION frames following a HEADER frame\";\n   default:\n     return \"Unknown error code\";\n   }"
        },
        {
          "filename": "lib/nghttp2_session.c",
          "status": "modified",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -497,6 +497,7 @@ static int session_new(nghttp2_session **session_ptr,\n   (*session_ptr)->max_send_header_block_length = NGHTTP2_MAX_HEADERSLEN;\n   (*session_ptr)->max_outbound_ack = NGHTTP2_DEFAULT_MAX_OBQ_FLOOD_ITEM;\n   (*session_ptr)->max_settings = NGHTTP2_DEFAULT_MAX_SETTINGS;\n+  (*session_ptr)->max_continuations = NGHTTP2_DEFAULT_MAX_CONTINUATIONS;\n \n   if (option) {\n     if ((option->opt_set_mask & NGHTTP2_OPT_NO_AUTO_WINDOW_UPDATE) &&\n@@ -6826,6 +6827,8 @@ nghttp2_ssize nghttp2_session_mem_recv2(nghttp2_session *session,\n           }\n         }\n         session_inbound_frame_reset(session);\n+\n+        session->num_continuations = 0;\n       }\n       break;\n     }\n@@ -6947,6 +6950,10 @@ nghttp2_ssize nghttp2_session_mem_recv2(nghttp2_session *session,\n       }\n #endif /* DEBUGBUILD */\n \n+      if (++session->num_continuations > session->max_continuations) {\n+        return NGHTTP2_ERR_TOO_MANY_CONTINUATIONS;\n+      }\n+\n       readlen = inbound_frame_buf_read(iframe, in, last);\n       in += readlen;\n "
        },
        {
          "filename": "lib/nghttp2_session.h",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -110,6 +110,10 @@ typedef struct {\n #define NGHTTP2_DEFAULT_STREAM_RESET_BURST 1000\n #define NGHTTP2_DEFAULT_STREAM_RESET_RATE 33\n \n+/* The default max number of CONTINUATION frames following an incoming\n+   HEADER frame. */\n+#define NGHTTP2_DEFAULT_MAX_CONTINUATIONS 8\n+\n /* Internal state when receiving incoming frame */\n typedef enum {\n   /* Receiving frame header */\n@@ -290,6 +294,12 @@ struct nghttp2_session {\n   size_t max_send_header_block_length;\n   /* The maximum number of settings accepted per SETTINGS frame. */\n   size_t max_settings;\n+  /* The maximum number of CONTINUATION frames following an incoming\n+     HEADER frame. */\n+  size_t max_continuations;\n+  /* The number of CONTINUATION frames following an incoming HEADER\n+     frame.  This variable is reset when END_HEADERS flag is seen. */\n+  size_t num_continuations;\n   /* Next Stream ID. Made unsigned int to detect >= (1 << 31). */\n   uint32_t next_stream_id;\n   /* The last stream ID this session initiated.  For client session,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f88c09857dc8819c3a849a67a5e1d8e10503b49f",
            "date": "2025-01-14T09:16:54Z",
            "author_login": "tatsuhiro-t"
          },
          {
            "sha": "3cb06f116d662843cc4fbd82ffd251cd90842532",
            "date": "2025-01-13T14:56:50Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e53096123c961357302442fb1e0ac14cf7bc7e03",
            "date": "2025-01-12T09:24:40Z",
            "author_login": "tatsuhiro-t"
          },
          {
            "sha": "48cdba3553b294a470651f040d4c9dfff9fdea74",
            "date": "2025-01-12T08:51:21Z",
            "author_login": "tatsuhiro-t"
          },
          {
            "sha": "71498767046147f87bb3a5b01d5e4ff35dfba4c3",
            "date": "2025-01-12T08:47:25Z",
            "author_login": "tatsuhiro-t"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-770",
    "description": "nghttp2 is an implementation of the Hypertext Transfer Protocol version 2 in C. The nghttp2 library prior to version 1.61.0 keeps reading the unbounded number of HTTP/2 CONTINUATION frames even after a stream is reset to keep HPACK context in sync.  This causes excessive CPU usage to decode HPACK stream. nghttp2 v1.61.0 mitigates this vulnerability by limiting the number of CONTINUATION frames it accepts per stream. There is no workaround for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-04T15:15:38.427",
    "last_modified": "2024-11-21T09:05:58.537",
    "fix_date": "2024-03-09T07:26:42Z"
  },
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/03/16",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/nghttp2/nghttp2/commit/00201ecd8f982da3b67d4f6868af72a1b03b14e0",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/nghttp2/nghttp2/commit/d71a4668c6bead55805d18810d633fbb98315af9",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/nghttp2/nghttp2/security/advisories/GHSA-x6x3-gv8h-m57q",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/04/msg00026.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AGOME6ZXJG7664IPQNVE3DL67E3YP3HY/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/J6ZMXUGB66VAXDW5J6QSTHM5ET25FGSA/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXJO2EASHM2OQQLGVDY5ZSO7UVDVHTDK/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/04/03/16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/nghttp2/nghttp2/commit/00201ecd8f982da3b67d4f6868af72a1b03b14e0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/nghttp2/nghttp2/commit/d71a4668c6bead55805d18810d633fbb98315af9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/nghttp2/nghttp2/security/advisories/GHSA-x6x3-gv8h-m57q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/04/msg00026.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.debian.org/debian-lts-announce/2024/09/msg00041.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AGOME6ZXJG7664IPQNVE3DL67E3YP3HY/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/J6ZMXUGB66VAXDW5J6QSTHM5ET25FGSA/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PXJO2EASHM2OQQLGVDY5ZSO7UVDVHTDK/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.423868",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "nghttp2",
    "owner": "nghttp2",
    "created_at": "2013-07-16T15:12:33Z",
    "updated_at": "2025-01-14T12:37:12Z",
    "pushed_at": "2025-01-14T09:17:00Z",
    "size": 38249,
    "stars": 4686,
    "forks": 880,
    "open_issues": 395,
    "watchers": 4686,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C++": 2286176,
      "C": 1682086,
      "Go": 180283,
      "Python": 90018,
      "M4": 74621,
      "CMake": 66979,
      "Makefile": 23852,
      "Shell": 9762,
      "Dockerfile": 6966,
      "Ruby": 559
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:27:20.285893"
  }
}