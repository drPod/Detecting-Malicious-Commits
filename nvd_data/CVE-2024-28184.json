{
  "cve_id": "CVE-2024-28184",
  "github_data": {
    "repository": "Kozea/WeasyPrint",
    "fix_commit": "734ee8e2dc84ff3090682f3abff056d0907c8598",
    "related_commits": [
      "734ee8e2dc84ff3090682f3abff056d0907c8598",
      "734ee8e2dc84ff3090682f3abff056d0907c8598"
    ],
    "patch_url": "https://github.com/Kozea/WeasyPrint/commit/734ee8e2dc84ff3090682f3abff056d0907c8598.patch",
    "fix_commit_details": {
      "sha": "734ee8e2dc84ff3090682f3abff056d0907c8598",
      "commit_date": "2024-03-07T21:51:34Z",
      "author": {
        "login": "liZe",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Use document\u2019s url_fetcher for attachments",
        "length": 130,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
      },
      "files": [
        {
          "filename": "weasyprint/html.py",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -281,7 +281,9 @@ def get_html_metadata(html):\n             if url is None:\n                 LOGGER.error('Missing href in <link rel=\"attachment\">')\n             else:\n-                attachment = Attachment(url=url, description=attachment_title)\n+                attachment = Attachment(\n+                    url=url, description=attachment_title,\n+                    url_fetcher=html.url_fetcher)\n                 attachments.append(attachment)\n     return {\n         'title': title,"
        },
        {
          "filename": "weasyprint/pdf/__init__.py",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -249,7 +249,8 @@ def generate_pdf(document, target, zoom, **options):\n     if options['attachments']:\n         for attachment in options['attachments']:\n             if not isinstance(attachment, Attachment):\n-                attachment = Attachment(attachment)\n+                attachment = Attachment(\n+                    attachment, url_fetcher=document.url_fetcher)\n             attachments.append(attachment)\n     pdf_attachments = []\n     for attachment in attachments:"
        },
        {
          "filename": "weasyprint/pdf/anchors.py",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -252,8 +252,10 @@ def add_annotations(links, matrix, document, pdf, page, annot_files, compress):\n             # TODO: Use the title attribute as description. The comment\n             # above about multiple regions won't always be correct, because\n             # two links might have the same href, but different titles.\n+            attachment = Attachment(\n+                url=annot_target, url_fetcher=document.url_fetcher)\n             annot_files[annot_target] = write_pdf_attachment(\n-                pdf, Attachment(annot_target), compress)\n+                pdf, attachment, compress)\n         annot_file = annot_files[annot_target]\n         if annot_file is None:\n             continue"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "46a2f3af73bce6d073fc049217adfbeb3812c9f1",
            "date": "2025-01-14T12:00:10Z",
            "author_login": "liZe"
          },
          {
            "sha": "366afdfe555e98394358d81ecb4f1dcc3f499a85",
            "date": "2025-01-14T11:48:13Z",
            "author_login": "noamkush"
          },
          {
            "sha": "ccbfac5bb040a4be69037391858d10f558adebd3",
            "date": "2025-01-09T14:59:15Z",
            "author_login": "liZe"
          },
          {
            "sha": "5f7c4e6ae1ec9c65d978ea61333512fc62425c4b",
            "date": "2025-01-09T14:58:20Z",
            "author_login": "liZe"
          },
          {
            "sha": "61c044f8827ea6e83b2e75a8178bee5a68e68808",
            "date": "2025-01-09T14:58:01Z",
            "author_login": "liZe"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L",
    "cwe_id": "CWE-829",
    "description": "WeasyPrint helps web developers to create PDF documents. Since version 61.0, there's a vulnerability which allows attaching content of arbitrary files and URLs to a generated PDF document, even if `url_fetcher` is configured to prevent access to files and URLs. This vulnerability has been patched in version 61.2.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-09T01:15:07.573",
    "last_modified": "2024-11-21T09:05:58.833",
    "fix_date": "2024-03-07T21:51:34Z"
  },
  "references": [
    {
      "url": "https://github.com/Kozea/WeasyPrint/commit/734ee8e2dc84ff3090682f3abff056d0907c8598",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/Kozea/WeasyPrint/security/advisories/GHSA-35jj-wx47-4w8r",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZLQZMOEDY72TS43HDXOBVID2VYCTWIH6/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/Kozea/WeasyPrint/commit/734ee8e2dc84ff3090682f3abff056d0907c8598",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Kozea/WeasyPrint/security/advisories/GHSA-35jj-wx47-4w8r",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZLQZMOEDY72TS43HDXOBVID2VYCTWIH6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.476255",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "WeasyPrint",
    "owner": "Kozea",
    "created_at": "2011-08-09T14:14:24Z",
    "updated_at": "2025-01-14T12:00:15Z",
    "pushed_at": "2025-01-14T16:17:40Z",
    "size": 34627,
    "stars": 7367,
    "forks": 696,
    "open_issues": 176,
    "watchers": 7367,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 2257428,
      "CSS": 41366,
      "HTML": 18932
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T23:02:21.251888"
  }
}