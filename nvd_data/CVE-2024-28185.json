{
  "cve_id": "CVE-2024-28185",
  "github_data": {
    "repository": "judge0/judge0",
    "fix_commit": "846d5839026161bb299b7a35fd3b2afb107992fc",
    "related_commits": [
      "846d5839026161bb299b7a35fd3b2afb107992fc",
      "846d5839026161bb299b7a35fd3b2afb107992fc"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "846d5839026161bb299b7a35fd3b2afb107992fc",
      "commit_date": "2024-03-06T12:37:11Z",
      "author": {
        "login": "hermanzdosilovic",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Use user judge0",
        "length": 15,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 18,
        "additions": 6,
        "deletions": 12
      },
      "files": [
        {
          "filename": "Dockerfile",
          "status": "modified",
          "additions": 6,
          "deletions": 12,
          "patch": "@@ -38,22 +38,16 @@ COPY . .\n ENTRYPOINT [\"/api/docker-entrypoint.sh\"]\n CMD [\"/api/scripts/server\"]\n \n+RUN useradd -u 1000 -m -r judge0 && \\\n+    echo \"judge0 ALL=(ALL) NOPASSWD: ALL\" > /etc/sudoers && \\\n+    chown -R judge0: /api\n+\n+USER judge0\n+\n ENV JUDGE0_VERSION \"1.13.0\"\n LABEL version=$JUDGE0_VERSION\n \n \n FROM production AS development\n \n-ARG DEV_USER=judge0\n-ARG DEV_USER_ID=1000\n-\n-RUN apt-get update && \\\n-    apt-get install -y --no-install-recommends \\\n-        tmux \\\n-        vim && \\\n-    useradd -u $DEV_USER_ID -m -r $DEV_USER && \\\n-    echo \"$DEV_USER ALL=(ALL) NOPASSWD: ALL\" > /etc/sudoers\n-\n-USER $DEV_USER\n-\n CMD [\"sleep\", \"infinity\"]"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8cf60e5c86cf2cfdebc1ceba547470c8bc50037e",
            "date": "2025-01-20T14:00:25Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "b2fde0c743e826d26960fe3227e2989beea6d556",
            "date": "2025-01-19T20:00:07Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "cf2611762d378d8c609e4162e8a2a2b82f436c37",
            "date": "2025-01-19T17:09:07Z",
            "author_login": "RustyDev24"
          },
          {
            "sha": "5b036187b656fba9e58811706959d683bde75bdb",
            "date": "2025-01-17T12:31:23Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "1b2def59fcd7ecd3e42d5d69bcbe61f88362d65c",
            "date": "2025-01-17T12:07:56Z",
            "author_login": "hermanzdosilovic"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 10.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-59",
    "description": "Judge0 is an open-source online code execution system. The application does not account for symlinks placed inside the sandbox directory, which can be leveraged by an attacker to write to arbitrary files and gain code execution outside of the sandbox. When executing a submission, Judge0 writes a `run_script` to the sandbox directory. The security issue is that an attacker can create a symbolic link (symlink) at the path `run_script` before this code is executed, resulting in the `f.write` writing to an arbitrary file on the unsandboxed system. An attacker can leverage this vulnerability to overwrite scripts on the system and gain code execution outside of the sandbox.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-18T15:15:29.283",
    "last_modified": "2024-11-21T09:05:58.963",
    "fix_date": "2024-03-06T12:37:11Z"
  },
  "references": [
    {
      "url": "https://github.com/judge0/judge0/blob/v1.13.0/app/jobs/isolate_job.rb#L197-L201",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/commit/846d5839026161bb299b7a35fd3b2afb107992fc",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/security/advisories/GHSA-h9g2-45c8-89cf",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/blob/v1.13.0/app/jobs/isolate_job.rb#L197-L201",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/commit/846d5839026161bb299b7a35fd3b2afb107992fc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/security/advisories/GHSA-h9g2-45c8-89cf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:06.993450",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "judge0",
    "owner": "judge0",
    "created_at": "2017-01-27T19:47:35Z",
    "updated_at": "2025-01-25T19:34:17Z",
    "pushed_at": "2025-01-20T14:00:25Z",
    "size": 9848,
    "stars": 2869,
    "forks": 510,
    "open_issues": 149,
    "watchers": 2869,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 209119,
      "Ruby": 98847,
      "Shell": 8035,
      "Dockerfile": 1179
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T07:46:43.106610"
  }
}