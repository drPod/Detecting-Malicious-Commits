{
  "cve_id": "CVE-2024-28187",
  "github_data": {
    "repository": "inunosinsi/soycms",
    "fix_commit": "9b0e452f628df28dec69cd72b6b55db21066cbf8",
    "related_commits": [
      "9b0e452f628df28dec69cd72b6b55db21066cbf8",
      "9b0e452f628df28dec69cd72b6b55db21066cbf8"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "9b0e452f628df28dec69cd72b6b55db21066cbf8",
      "commit_date": "2024-02-28T00:56:12Z",
      "author": {
        "login": "inunosinsi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[Fix]OS Command Injection via file upload. https://github.com/inunosinsi/soycms/issues/21",
        "length": 89,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "cms/common/action/site/Entry/SearchAction.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -58,10 +58,11 @@ private function searchEntries(string $freewordText, array $label, array $cdate,\n \t\t\tforeach(array(\"title\",\"content\",\"more\") as $column){\r\n \t\t\t\t$freeword = array();\r\n \t\t\t\tforeach($keywords as $keyword){\r\n+\t\t\t\t\t$keyword = trim($keyword);\r\n \r\n \t\t\t\t\t$bind_key = ':freeword'.$keywordCounts;\r\n \r\n-\t\t\t\t\tif($keyword[0] == \"-\"){\r\n+\t\t\t\t\tif(strlen($keyword) >= 1 && $keyword[0] == \"-\"){\r\n \t\t\t\t\t\t$keyword = substr($keyword,1);\r\n \t\t\t\t\t\t$freeword[] = 'Entry.'.$column.\" not like \".$bind_key.\"\";\r\n \t\t\t\t\t}else{\r"
        },
        {
          "filename": "cms/common/action/site/Entry/UploadFileAction.class.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -163,8 +163,8 @@ function execute($resp, $form, $req) {\n \t\t\t\t\tswitch($ext){\r\n \t\t\t\t\t\tcase \"jpeg\":\r\n \t\t\t\t\t\t\texec(\"jpegoptim -V\", $out);\r\n-\t\t\t\t\t\t\tif(isset($out) && count($out)){\r\n-\t\t\t\t\t\t\t\texec(\"jpegoptim --strip-all \" . $filepath);\r\n+\t\t\t\t\t\t\tif(is_array($out) && count($out)){\r\n+\t\t\t\t\t\t\t\texec(\"jpegoptim --strip-all \" . escapeshellarg($filepath));\r\n \t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\tbreak;\r\n \t\t\t\t\t}\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0acdbe7a4f8a8b0e9eab338df84c0552d3be7a3f",
            "date": "2024-09-24T03:42:46Z",
            "author_login": "inunosinsi"
          },
          {
            "sha": "6d034654fdd15b4656316fbec9079ae95cb5f30f",
            "date": "2024-09-24T03:41:21Z",
            "author_login": "inunosinsi"
          },
          {
            "sha": "e66414c9de0d7cbdcbeaa1fa87397c9f56f40919",
            "date": "2024-09-24T03:40:08Z",
            "author_login": "inunosinsi"
          },
          {
            "sha": "e55b22ce8b81dbbb3ef328ccde0e97082c6bde2a",
            "date": "2024-09-24T03:39:42Z",
            "author_login": "inunosinsi"
          },
          {
            "sha": "bcb78354112fd518637fa1d3b18ed866d2f58012",
            "date": "2024-09-24T03:38:45Z",
            "author_login": "inunosinsi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "SOY CMS is an open source CMS (content management system) that allows you to build blogs and online shops. SOY CMS versions prior to 3.14.2 are vulnerable to an OS Command Injection vulnerability within the file upload feature when accessed by an administrator. The vulnerability enables the execution of arbitrary OS commands through specially crafted file names containing a semicolon, affecting the jpegoptim functionality. This vulnerability has been patched in version 3.14.2. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-11T20:15:07.180",
    "last_modified": "2024-11-21T09:05:59.240",
    "fix_date": "2024-02-28T00:56:12Z"
  },
  "references": [
    {
      "url": "https://github.com/inunosinsi/soycms/commit/9b0e452f628df28dec69cd72b6b55db21066cbf8",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/inunosinsi/soycms/security/advisories/GHSA-qg3q-hfgc-5jmm",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/inunosinsi/soycms/commit/9b0e452f628df28dec69cd72b6b55db21066cbf8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/inunosinsi/soycms/security/advisories/GHSA-qg3q-hfgc-5jmm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.480171",
    "processing_status": "enhanced"
  }
}