{
  "cve_id": "CVE-2024-28189",
  "github_data": {
    "repository": "judge0/judge0",
    "fix_commit": "f3b8547b3b67863e4ea0ded3adcb963add56addd",
    "related_commits": [
      "f3b8547b3b67863e4ea0ded3adcb963add56addd",
      "f3b8547b3b67863e4ea0ded3adcb963add56addd"
    ],
    "patch_url": "https://github.com/judge0/judge0/commit/f3b8547b3b67863e4ea0ded3adcb963add56addd.patch",
    "fix_commit_details": {
      "sha": "f3b8547b3b67863e4ea0ded3adcb963add56addd",
      "commit_date": "2024-03-08T09:10:36Z",
      "author": {
        "login": "hermanzdosilovic",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Just remove files without chown",
        "length": 31,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "app/jobs/isolate_job.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -168,7 +168,7 @@ def compile\n     files_to_remove = [compile_output_file]\n     files_to_remove << compile_script unless submission.is_project\n     files_to_remove.each do |f|\n-      `sudo chown $(whoami): #{f} && sudo rm -rf #{f}`\n+      `sudo rm -rf #{f}`\n     end\n \n     return :success if process_status.success?\n@@ -229,7 +229,7 @@ def run\n \n     `#{command}`\n \n-    `sudo chown $(whoami): #{run_script} && rm #{run_script}` unless submission.is_project\n+    `sudo rm #{run_script}` unless submission.is_project\n   end\n \n   def verify"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "142bf763a1221d63200a2d1b0c43bc4cafe173eb",
            "date": "2025-01-02T21:18:57Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "a29d609ad117e3d493c1c15732d926dc22bb2047",
            "date": "2024-12-19T10:17:51Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "f5fccc7b2c6308b5917c20b6b8f8dec5a6394a7e",
            "date": "2024-12-16T09:33:41Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "abbd3accf7a8e810c1d9da0e4cb9c4fff6b4801a",
            "date": "2024-11-30T21:09:52Z",
            "author_login": "hermanzdosilovic"
          },
          {
            "sha": "078c2045f6e2d88f58b745216082c2b51c6fd090",
            "date": "2024-11-25T19:43:12Z",
            "author_login": "hermanzdosilovic"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 10.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-59",
    "description": "Judge0 is an open-source online code execution system. The application uses the UNIX chown command on an untrusted file within the sandbox. An attacker can abuse this by creating a symbolic link (symlink) to a file outside the sandbox, allowing the attacker to run chown on arbitrary files outside of the sandbox. This vulnerability is not impactful on it's own, but it can be used to bypass the patch for CVE-2024-28185 and obtain a complete sandbox escape. This vulnerability is fixed in 1.13.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-18T15:15:29.480",
    "last_modified": "2024-11-21T09:05:59.537",
    "fix_date": "2024-03-08T09:10:36Z"
  },
  "references": [
    {
      "url": "https://github.com/judge0/judge0/blob/v1.13.0/app/jobs/isolate_job.rb#L232",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/commit/f3b8547b3b67863e4ea0ded3adcb963add56addd",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/security/advisories/GHSA-3xpw-36v7-2cmg",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/security/advisories/GHSA-h9g2-45c8-89cf",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/blob/v1.13.0/app/jobs/isolate_job.rb#L232",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/commit/f3b8547b3b67863e4ea0ded3adcb963add56addd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/security/advisories/GHSA-3xpw-36v7-2cmg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/judge0/judge0/security/advisories/GHSA-h9g2-45c8-89cf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:06.993631",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "judge0",
    "owner": "judge0",
    "created_at": "2017-01-27T19:47:35Z",
    "updated_at": "2025-01-14T09:59:49Z",
    "pushed_at": "2025-01-02T21:18:57Z",
    "size": 9796,
    "stars": 2847,
    "forks": 506,
    "open_issues": 150,
    "watchers": 2847,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 209119,
      "Ruby": 98847,
      "Shell": 8035,
      "Dockerfile": 1179
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:23:35.486807"
  }
}