{
  "cve_id": "CVE-2024-28198",
  "github_data": {
    "repository": "OpenOLAT/OpenOLAT",
    "fix_commit": "23e6212e9412c3b099436159b8c8935321c91872",
    "related_commits": [
      "23e6212e9412c3b099436159b8c8935321c91872",
      "23e6212e9412c3b099436159b8c8935321c91872"
    ],
    "patch_url": "https://github.com/OpenOLAT/OpenOLAT/commit/23e6212e9412c3b099436159b8c8935321c91872.patch",
    "fix_commit_details": {
      "sha": "23e6212e9412c3b099436159b8c8935321c91872",
      "commit_date": "2024-01-24T09:17:18Z",
      "author": {
        "login": "uhensler",
        "type": "User",
        "stats": {
          "total_commits": 3359,
          "average_weekly_commits": 4.639502762430939,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 306
        }
      },
      "commit_message": {
        "title": "OO-7553: Extract XML from SVG with secure settings",
        "length": 50,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/main/java/org/olat/core/commons/services/doceditor/drawio/manager/DrawioServiceImpl.java",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -53,6 +53,7 @@\n import org.olat.core.util.vfs.VFSManager;\n import org.olat.core.util.vfs.lock.LockInfo;\n import org.olat.core.util.vfs.lock.LockResult;\n+import org.olat.core.util.xml.XMLFactories;\n import org.olat.restapi.security.RestSecurityHelper;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Service;\n@@ -139,7 +140,7 @@ public String getXmlContent(VFSLeaf vfsLeaf) {\n \t\tString suffix = FileUtils.getFileSuffix(vfsLeaf.getName());\n \t\tif (\"svg\".equalsIgnoreCase(suffix)) {\n \t\t\ttry {\n-\t\t\t\tDocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+\t\t\t\tDocumentBuilderFactory factory = XMLFactories.newDocumentBuilderFactory();\n \t\t\t\tDocumentBuilder builder = factory.newDocumentBuilder();\n \t\t\t\tDocument document = builder.parse(vfsLeaf.getInputStream());\n \t\t\t\tString xpathExpression = \"//svg/@content\";"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 11
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5f24e6e5de024d5f8c11f4dccd13ccbda09ad2b2",
            "date": "2025-01-14T16:27:39Z",
            "author_login": "pfranger"
          },
          {
            "sha": "31b054c9eab6c2b5a6afb7d8cc00f9e46615532a",
            "date": "2025-01-14T15:41:46Z",
            "author_login": "lainsr"
          },
          {
            "sha": "b2e005103995dd59fa2ce2a1901aa2d77836e4ae",
            "date": "2025-01-14T13:17:02Z",
            "author_login": "uhensler"
          },
          {
            "sha": "3f3c1389a49011e2782a3357ebc2004b8c2a1420",
            "date": "2025-01-14T10:11:52Z",
            "author_login": "lainsr"
          },
          {
            "sha": "775b4903a88c33e9653c290fc454516ade61427b",
            "date": "2025-01-14T08:37:27Z",
            "author_login": "lainsr"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-611",
    "description": "OpenOlat is an open source web-based e-learning platform for teaching, learning, assessment and communication. By manually manipulating http requests when using the draw.io integration it is possible to read arbitrary files as the configured system user and SSRF. The problem is fixed in version 18.1.6 and 18.2.2. It is advised to upgrade to the latest version of 18.1.x or 18.2.x. Users unable to upgrade may work around this issue by disabling the Draw.io module or the entire REST API which will secure the system.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-03-11T20:15:07.643",
    "last_modified": "2024-11-21T09:06:00.677",
    "fix_date": "2024-01-24T09:17:18Z"
  },
  "references": [
    {
      "url": "https://github.com/OpenOLAT/OpenOLAT/commit/23e6212e9412c3b099436159b8c8935321c91872",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/OpenOLAT/OpenOLAT/security/advisories/GHSA-pqvm-h9mg-434c",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://track.frentix.com/issue/OO-7553/XXE-injection-in-draw.io-endpoint",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/OpenOLAT/OpenOLAT/commit/23e6212e9412c3b099436159b8c8935321c91872",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/OpenOLAT/OpenOLAT/security/advisories/GHSA-pqvm-h9mg-434c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://track.frentix.com/issue/OO-7553/XXE-injection-in-draw.io-endpoint",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.480435",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "OpenOLAT",
    "owner": "OpenOLAT",
    "created_at": "2018-03-29T09:46:34Z",
    "updated_at": "2025-01-14T16:35:50Z",
    "pushed_at": "2025-01-14T16:35:47Z",
    "size": 565836,
    "stars": 344,
    "forks": 146,
    "open_issues": 4,
    "watchers": 344,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 78961935,
      "JavaScript": 11391629,
      "Fluent": 1728501,
      "HTML": 1658723,
      "SCSS": 1099866,
      "CSS": 209153,
      "XSLT": 99335,
      "Shell": 6334
    },
    "commit_activity": {
      "total_commits_last_year": 2984,
      "avg_commits_per_week": 57.38461538461539,
      "days_active_last_year": 249
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:51:50.608255"
  }
}