{
  "cve_id": "CVE-2024-28253",
  "github_data": {
    "repository": "open-metadata/OpenMetadata",
    "fix_commit": null,
    "related_commits": [],
    "patch_url": null
  },
  "vulnerability_details": {
    "cvss_score": 9.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L",
    "cwe_id": "CWE-94",
    "description": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. `CompiledRule::validateExpression` is also called from `PolicyRepository.prepare`. `prepare()` is called from `EntityRepository.prepareInternal()` which, in turn, gets called from `EntityResource.createOrUpdate()`. Note that even though there is an authorization check (`authorizer.authorize()`), it gets called after `prepareInternal()` gets called and therefore after the SpEL expression has been evaluated. In order to reach this method, an attacker can send a PUT request to `/api/v1/policies` which gets handled by `PolicyResource.createOrUpdate()`. This vulnerability was discovered with the help of CodeQL's Expression language injection (Spring) query and is also tracked as `GHSL-2023-252`. This issue may lead to Remote Code Execution and has been addressed in version 1.3.1. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-15T20:15:09.807",
    "last_modified": "2024-11-21T09:06:06.263",
    "fix_date": null
  },
  "references": [
    {
      "url": "https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/EntityRepository.java#L693",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/EntityResource.java#L219",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/policies/PolicyResource.java#L365",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/PolicyRepository.java#L113",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-7vf4-x5m2-r6gr",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/EntityRepository.java#L693",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/EntityResource.java#L219",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/policies/PolicyResource.java#L365",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/PolicyRepository.java#L113",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-7vf4-x5m2-r6gr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:38.501254",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "OpenMetadata",
    "owner": "open-metadata",
    "created_at": "2021-08-01T21:17:17Z",
    "updated_at": "2025-01-26T04:56:40Z",
    "pushed_at": "2025-01-26T04:56:34Z",
    "size": 1821639,
    "stars": 5961,
    "forks": 1117,
    "open_issues": 528,
    "watchers": 5961,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.3.0",
      "0.4.0",
      "0.5.0",
      "0.6.0",
      "0.7.0",
      "0.8.0",
      "0.9.0",
      "0.10.0",
      "0.11.0",
      "0.12.0",
      "0.13.0"
    ],
    "languages": {
      "TypeScript": 14634287,
      "Java": 8061379,
      "Python": 7049343,
      "Less": 406113,
      "CSS": 100698,
      "JavaScript": 52535,
      "Shell": 30843,
      "PLpgSQL": 26903,
      "HTML": 25311,
      "Makefile": 16698,
      "Dockerfile": 12776,
      "ANTLR": 3908,
      "LookML": 1580,
      "Jinja": 285
    },
    "commit_activity": {
      "total_commits_last_year": 3418,
      "avg_commits_per_week": 65.73076923076923,
      "days_active_last_year": 316
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T07:48:44.582885"
  }
}