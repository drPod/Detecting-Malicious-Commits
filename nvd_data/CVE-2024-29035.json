{
  "cve_id": "CVE-2024-29035",
  "github_data": {
    "repository": "umbraco/Umbraco-CMS",
    "fix_commit": "6b8067815c02ae43161966a8075a3585e1bc4de0",
    "related_commits": [
      "6b8067815c02ae43161966a8075a3585e1bc4de0",
      "6b8067815c02ae43161966a8075a3585e1bc4de0"
    ],
    "patch_url": "https://github.com/umbraco/Umbraco-CMS/commit/6b8067815c02ae43161966a8075a3585e1bc4de0.patch",
    "fix_commit_details": {
      "sha": "6b8067815c02ae43161966a8075a3585e1bc4de0",
      "commit_date": "2024-02-06T08:53:17Z",
      "author": {
        "login": "Zeegaan",
        "type": "User",
        "stats": {
          "total_commits": 827,
          "average_weekly_commits": 1.1391184573002755,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 148
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-74p6-39f2-23v3",
        "length": 140,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 34,
        "additions": 29,
        "deletions": 5
      },
      "files": [
        {
          "filename": "src/Umbraco.Core/EmbeddedResources/Lang/da.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -1015,6 +1015,8 @@\n     <key alias=\"createHeader\">Opret header</key>\n     <key alias=\"deliveries\">Leverancer</key>\n     <key alias=\"noHeaders\">Der er ikke tilf\u00f8jet nogen webhook headers</key>\n+    <key alias=\"toggleDebug\">Skift til debug mode for mere information.</key>\n+    <key alias=\"statusNotOk\">Ikke OK status kode.</key>\n   </area>\n   <area alias=\"language\">\n     <key alias=\"cultureCode\">Culture Code</key>"
        },
        {
          "filename": "src/Umbraco.Core/EmbeddedResources/Lang/en_us.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -2032,6 +2032,8 @@ To manage your website, simply open the Umbraco backoffice and start adding cont\n     <key alias=\"types\">Types</key>\n     <key alias=\"webhookKey\">Webhook key</key>\n     <key alias=\"retryCount\">Retry count</key>\n+    <key alias=\"toggleDebug\">Toggle debug mode for more information.</key>\n+    <key alias=\"statusNotOk\">Not OK status code</key>\n   </area>\n   <area alias=\"languages\">\n     <key alias=\"addLanguage\">Add language</key>"
        },
        {
          "filename": "src/Umbraco.Web.BackOffice/Mapping/WebhookMapDefinition.cs",
          "status": "modified",
          "additions": 25,
          "deletions": 5,
          "patch": "@@ -1,12 +1,23 @@\n-\ufeffusing Umbraco.Cms.Core.Mapping;\n+\ufeffusing Umbraco.Cms.Core.Hosting;\n+using Umbraco.Cms.Core.Mapping;\n using Umbraco.Cms.Core.Models;\n+using Umbraco.Cms.Core.Services;\n using Umbraco.Cms.Core.Webhooks;\n using Umbraco.Cms.Web.Common.Models;\n \n namespace Umbraco.Cms.Web.BackOffice.Mapping;\n \n public class WebhookMapDefinition : IMapDefinition\n {\n+    private readonly IHostingEnvironment _hostingEnvironment;\n+    private readonly ILocalizedTextService _localizedTextService;\n+\n+    public WebhookMapDefinition(IHostingEnvironment hostingEnvironment, ILocalizedTextService localizedTextService)\n+    {\n+        _hostingEnvironment = hostingEnvironment;\n+        _localizedTextService = localizedTextService;\n+    }\n+\n     public void DefineMaps(IUmbracoMapper mapper)\n     {\n         mapper.Define<WebhookViewModel, IWebhook>((_, _) => new Webhook(string.Empty), Map);\n@@ -40,13 +51,22 @@ private void Map(WebhookLog source, WebhookLogViewModel target, MapperContext co\n         target.EventAlias = source.EventAlias;\n         target.Key = source.Key;\n         target.RequestBody = source.RequestBody ?? string.Empty;\n-        target.ResponseBody = source.ResponseBody;\n         target.RetryCount = source.RetryCount;\n-        target.StatusCode = source.StatusCode;\n         target.Url = source.Url;\n         target.RequestHeaders = source.RequestHeaders;\n-        target.ResponseHeaders = source.ResponseHeaders;\n         target.WebhookKey = source.WebhookKey;\n-        target.ExceptionOccured = source.ExceptionOccured;\n+\n+        if (_hostingEnvironment.IsDebugMode)\n+        {\n+            target.ExceptionOccured = source.ExceptionOccured;\n+            target.ResponseBody = source.ResponseBody;\n+            target.ResponseHeaders = source.ResponseHeaders;\n+            target.StatusCode = source.StatusCode;\n+        }\n+        else\n+        {\n+            target.ResponseBody = _localizedTextService.Localize(\"webhooks\", \"toggleDebug\", Thread.CurrentThread.CurrentUICulture);\n+            target.StatusCode = source.StatusCode is \"OK (200)\" ? source.StatusCode : _localizedTextService.Localize(\"webhooks\", \"statusNotOk\", Thread.CurrentThread.CurrentUICulture);\n+        }\n     }\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd9c1a0e9c9a1d851e8ec75bc866e3e9a38a56e7",
            "date": "2025-01-14T12:32:09Z",
            "author_login": "justin-nevitech"
          },
          {
            "sha": "c4021e27e5f01a9a4311393a275082cbd3d9fa8a",
            "date": "2025-01-14T00:32:43Z",
            "author_login": "nul800sebastiaan"
          },
          {
            "sha": "ba58c6323c3944b371e9357ccc4019c396b7a44e",
            "date": "2025-01-07T08:25:41Z",
            "author_login": "nul800sebastiaan"
          },
          {
            "sha": "09575599ad540e9678af3bbca0af6286ee82f9f6",
            "date": "2025-01-03T16:59:50Z",
            "author_login": "jbreuer"
          },
          {
            "sha": "aaa44a20cb682d44c5ebd3870675e2354a03423f",
            "date": "2025-01-03T11:12:05Z",
            "author_login": "nul800sebastiaan"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N",
    "cwe_id": "CWE-918",
    "description": "Umbraco is an ASP.NET CMS. Failing webhooks logs are available when solution is not in debug mode. Those logs can contain information that is critical. This vulnerability is fixed in 13.1.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-17T15:15:07.037",
    "last_modified": "2024-11-21T09:07:25.233",
    "fix_date": "2024-02-06T08:53:17Z"
  },
  "references": [
    {
      "url": "https://github.com/umbraco/Umbraco-CMS/commit/6b8067815c02ae43161966a8075a3585e1bc4de0",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-74p6-39f2-23v3",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/umbraco/Umbraco-CMS/commit/6b8067815c02ae43161966a8075a3585e1bc4de0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/umbraco/Umbraco-CMS/security/advisories/GHSA-74p6-39f2-23v3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:06.985227",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Umbraco-CMS",
    "owner": "umbraco",
    "created_at": "2013-06-10T13:50:46Z",
    "updated_at": "2025-01-14T12:32:15Z",
    "pushed_at": "2025-01-14T12:59:08Z",
    "size": 411751,
    "stars": 4657,
    "forks": 2730,
    "open_issues": 640,
    "watchers": 4657,
    "has_security_policy": false,
    "default_branch": "contrib",
    "protected_branches": [
      "contrib",
      "dev-v7-package-migrations",
      "dev-v8-umb-code-snippet",
      "main",
      "main-v6",
      "main-v7"
    ],
    "languages": {
      "C#": 18947686,
      "TypeScript": 10715670,
      "JavaScript": 98223,
      "HTML": 62911,
      "CSS": 19833,
      "MDX": 12163,
      "Dockerfile": 2714,
      "Shell": 1652,
      "TSQL": 159
    },
    "commit_activity": {
      "total_commits_last_year": 2931,
      "avg_commits_per_week": 56.36538461538461,
      "days_active_last_year": 245
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T12:59:29.013002"
  }
}