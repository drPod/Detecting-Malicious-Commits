{
  "cve_id": "CVE-2024-29189",
  "github_data": {
    "repository": "ansys/pyansys-geometry",
    "fix_commit": "902071701c4f3a8258cbaa46c28dc0a65442d1bc",
    "related_commits": [
      "902071701c4f3a8258cbaa46c28dc0a65442d1bc",
      "f82346b9432b06532e84f3278125f5879b4e9f3f",
      "902071701c4f3a8258cbaa46c28dc0a65442d1bc",
      "f82346b9432b06532e84f3278125f5879b4e9f3f"
    ],
    "patch_url": "https://github.com/ansys/pyansys-geometry/commit/902071701c4f3a8258cbaa46c28dc0a65442d1bc.patch",
    "fix_commit_details": {
      "sha": "902071701c4f3a8258cbaa46c28dc0a65442d1bc",
      "commit_date": "2024-03-22T07:32:20Z",
      "author": {
        "login": "RobPasMue",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "feat: accept bandit advisories in-line for subprocess (#1077)",
        "length": 124,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 13,
        "additions": 9,
        "deletions": 4
      },
      "files": [
        {
          "filename": "doc/changelog.d/1077.added.md",
          "status": "added",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -0,0 +1 @@\n+feat: accept bandit advisories in-line for subprocess\n\\ No newline at end of file"
        },
        {
          "filename": "src/ansys/geometry/core/connection/product_instance.py",
          "status": "modified",
          "additions": 8,
          "deletions": 4,
          "patch": "@@ -23,7 +23,10 @@\n import os\n import signal\n import socket\n-import subprocess\n+\n+# Subprocess is needed to start the backend. But\n+# the input is controlled by the library. Excluding bandit check.\n+import subprocess  # nosec B404\n \n from ansys.tools.path import get_available_ansys_installations, get_latest_ansys_installation\n from beartype.typing import TYPE_CHECKING, Dict, List\n@@ -302,7 +305,7 @@ def prepare_and_start_backend(\n     LOG.debug(f\"Args: {args}\")\n     LOG.debug(f\"Environment variables: {env_copy}\")\n \n-    instance = ProductInstance(_start_program(args, env_copy).pid)\n+    instance = ProductInstance(__start_program(args, env_copy).pid)\n \n     # Verify that the backend is ready to accept connections\n     # before returning the Modeler instance.\n@@ -403,7 +406,7 @@ def _manifest_path_provider(\n         raise RuntimeError(msg)\n \n \n-def _start_program(args: List[str], local_env: Dict[str, str]) -> subprocess.Popen:\n+def __start_program(args: List[str], local_env: Dict[str, str]) -> subprocess.Popen:\n     \"\"\"\n     Start the program where the path is the first item of the ``args`` array argument.\n \n@@ -420,7 +423,8 @@ def _start_program(args: List[str], local_env: Dict[str, str]) -> subprocess.Pop\n     subprocess.Popen\n         The subprocess object.\n     \"\"\"\n-    return subprocess.Popen(\n+    # private method and controlled input by library - excluding bandit check.\n+    return subprocess.Popen(  # nosec B603\n         args,\n         stdin=subprocess.DEVNULL,\n         stdout=subprocess.DEVNULL,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1481c36f01f6fbd6ba37dca701c53212a3679dd7",
            "date": "2025-01-14T12:04:14Z",
            "author_login": "RobPasMue"
          },
          {
            "sha": "5a555e558e2a4c10dd277858a3f174444002ae82",
            "date": "2025-01-14T07:51:39Z",
            "author_login": "pre-commit-ci[bot]"
          },
          {
            "sha": "f08c24e3681f2770c71612bbe96871e4a1948953",
            "date": "2025-01-14T02:27:25Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "4405b4a75aa1ab521bda10f44e3e3bae70983a07",
            "date": "2025-01-13T23:28:26Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "62cf15ece3ba13c7b3c809837745f0caae66bf39",
            "date": "2025-01-13T20:10:23Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "PyAnsys Geometry is a Python client library for the Ansys Geometry service and other CAD Ansys products. On file src/ansys/geometry/core/connection/product_instance.py, upon calling this method _start_program directly, users could exploit its usage to perform malicious operations on the current machine where the script is ran. This vulnerability is fixed in 0.3.3 and 0.4.12.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-03-26T03:15:13.150",
    "last_modified": "2024-11-21T09:07:45.657",
    "fix_date": "2024-03-22T07:32:20Z"
  },
  "references": [
    {
      "url": "https://bandit.readthedocs.io/en/1.7.8/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/blob/52cba1737a8a7812e5430099f715fa2160ec007b/src/ansys/geometry/core/connection/product_instance.py#L403-L428",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/commit/902071701c4f3a8258cbaa46c28dc0a65442d1bc",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/commit/f82346b9432b06532e84f3278125f5879b4e9f3f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/pull/1076",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/pull/1077",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/security/advisories/GHSA-38jr-29fh-w9vm",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://bandit.readthedocs.io/en/1.7.8/plugins/b602_subprocess_popen_with_shell_equals_true.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/blob/52cba1737a8a7812e5430099f715fa2160ec007b/src/ansys/geometry/core/connection/product_instance.py#L403-L428",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/commit/902071701c4f3a8258cbaa46c28dc0a65442d1bc",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/commit/f82346b9432b06532e84f3278125f5879b4e9f3f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/pull/1076",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/pull/1077",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ansys/pyansys-geometry/security/advisories/GHSA-38jr-29fh-w9vm",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.901263",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "pyansys-geometry",
    "owner": "ansys",
    "created_at": "2022-08-30T06:45:39Z",
    "updated_at": "2025-01-14T12:04:19Z",
    "pushed_at": "2025-01-14T13:18:36Z",
    "size": 306935,
    "stars": 48,
    "forks": 15,
    "open_issues": 56,
    "watchers": 48,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "blitz",
      "dependabot/pip/grpc-deps-7a1ac16faf",
      "feat/debug-mode-run-discovery-script",
      "feat/driving-dimensions",
      "feat/enable_import_tests_for_core_service",
      "feat/enable_prepare_repair_coreservice",
      "feat/extrude-and-offset-faces",
      "feat/named-selections-plot",
      "feat/repair-prepare-tools-linux",
      "feat/separate-pieces",
      "feat/split_edges",
      "fix/adapt_tessellate_tests_to_new_core_service",
      "fix/extra-edges-test-failing",
      "fix/temp-body-created-on-intersect",
      "main",
      "release/0.1",
      "release/0.2",
      "release/0.3",
      "release/0.4",
      "release/0.5",
      "release/0.6",
      "release/0.7"
    ],
    "languages": {
      "Python": 1282155,
      "Dockerfile": 4615
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:59:08.529070"
  }
}