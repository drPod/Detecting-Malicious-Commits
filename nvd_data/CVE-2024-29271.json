{
  "cve_id": "CVE-2024-29271",
  "github_data": {
    "repository": "givanz/VvvebJs",
    "fix_commit": "c0c0545b44b23acc288ef907fb498ce15b9b576e",
    "related_commits": [
      "c0c0545b44b23acc288ef907fb498ce15b9b576e",
      "c0c0545b44b23acc288ef907fb498ce15b9b576e"
    ],
    "patch_url": "https://github.com/givanz/VvvebJs/commit/c0c0545b44b23acc288ef907fb498ce15b9b576e.patch",
    "fix_commit_details": {
      "sha": "c0c0545b44b23acc288ef907fb498ce15b9b576e",
      "commit_date": "2024-03-11T15:11:25Z",
      "author": {
        "login": "givanz",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed XSS vulnerability in save.php https://github.com/givanz/VvvebJs/issues/342 reported by https://github.com/Hebing123 updated Bootstrap to 5.3.3",
        "length": 148,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 102,
        "additions": 60,
        "deletions": 42
      },
      "files": [
        {
          "filename": "demo/landing",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Subproject commit 84cc79bdc4b0ebf22b4db01f410c6cda18b85f7a\n+Subproject commit 86e57c06eb6732dd0feb7cf590e87b6140ea4804"
        },
        {
          "filename": "js/bootstrap.min.js",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": null
        },
        {
          "filename": "save.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -89,7 +89,7 @@ function validOembedUrl($url) {\n }\n \n if (isset($_GET['action'])) {\n-\t$action = $_GET['action'];\n+\t$action = htmlspecialchars(strip_tags($_GET['action']));\n }\n \n if ($action) {"
        },
        {
          "filename": "scss/bootstrap/_accordion.scss",
          "status": "modified",
          "additions": 11,
          "deletions": 11,
          "patch": "@@ -20,7 +20,6 @@\n   --#{$prefix}accordion-btn-icon-transform: #{$accordion-icon-transform};\n   --#{$prefix}accordion-btn-icon-transition: #{$accordion-icon-transition};\n   --#{$prefix}accordion-btn-active-icon: #{escape-svg($accordion-button-active-icon)};\n-  --#{$prefix}accordion-btn-focus-border-color: #{$accordion-button-focus-border-color};\n   --#{$prefix}accordion-btn-focus-box-shadow: #{$accordion-button-focus-box-shadow};\n   --#{$prefix}accordion-body-padding-x: #{$accordion-body-padding-x};\n   --#{$prefix}accordion-body-padding-y: #{$accordion-body-padding-y};\n@@ -74,7 +73,6 @@\n \n   &:focus {\n     z-index: 3;\n-    border-color: var(--#{$prefix}accordion-btn-focus-border-color);\n     outline: 0;\n     box-shadow: var(--#{$prefix}accordion-btn-focus-box-shadow);\n   }\n@@ -92,7 +90,7 @@\n   &:first-of-type {\n     @include border-top-radius(var(--#{$prefix}accordion-border-radius));\n \n-    .accordion-button {\n+    > .accordion-header .accordion-button {\n       @include border-top-radius(var(--#{$prefix}accordion-inner-border-radius));\n     }\n   }\n@@ -105,13 +103,13 @@\n   &:last-of-type {\n     @include border-bottom-radius(var(--#{$prefix}accordion-border-radius));\n \n-    .accordion-button {\n+    > .accordion-header .accordion-button {\n       &.collapsed {\n         @include border-bottom-radius(var(--#{$prefix}accordion-inner-border-radius));\n       }\n     }\n \n-    .accordion-collapse {\n+    > .accordion-collapse {\n       @include border-bottom-radius(var(--#{$prefix}accordion-border-radius));\n     }\n   }\n@@ -127,24 +125,26 @@\n // Remove borders and border-radius to keep accordion items edge-to-edge.\n \n .accordion-flush {\n-  .accordion-collapse {\n-    border-width: 0;\n-  }\n-\n-  .accordion-item {\n+  > .accordion-item {\n     border-right: 0;\n     border-left: 0;\n     @include border-radius(0);\n \n     &:first-child { border-top: 0; }\n     &:last-child { border-bottom: 0; }\n \n-    .accordion-button {\n+    // stylelint-disable selector-max-class\n+    > .accordion-header .accordion-button {\n       &,\n       &.collapsed {\n         @include border-radius(0);\n       }\n     }\n+    // stylelint-enable selector-max-class\n+\n+    > .accordion-collapse {\n+      @include border-radius(0);\n+    }\n   }\n }\n "
        },
        {
          "filename": "scss/bootstrap/_buttons.scss",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -100,6 +100,15 @@\n     }\n   }\n \n+  .btn-check:checked:focus-visible + & {\n+    // Avoid using mixin so we can pass custom focus shadow properly\n+    @if $enable-shadows {\n+      box-shadow: var(--#{$prefix}btn-active-shadow), var(--#{$prefix}btn-focus-box-shadow);\n+    } @else {\n+      box-shadow: var(--#{$prefix}btn-focus-box-shadow);\n+    }\n+  }\n+\n   &:disabled,\n   &.disabled,\n   fieldset:disabled & {"
        },
        {
          "filename": "scss/bootstrap/_carousel.scss",
          "status": "modified",
          "additions": 2,
          "deletions": 10,
          "patch": "@@ -132,19 +132,11 @@\n   background-size: 100% 100%;\n }\n \n-/* rtl:options: {\n-  \"autoRename\": true,\n-  \"stringMap\":[ {\n-    \"name\"    : \"prev-next\",\n-    \"search\"  : \"prev\",\n-    \"replace\" : \"next\"\n-  } ]\n-} */\n .carousel-control-prev-icon {\n-  background-image: escape-svg($carousel-control-prev-icon-bg);\n+  background-image: escape-svg($carousel-control-prev-icon-bg) #{\"/*rtl:\" + escape-svg($carousel-control-next-icon-bg) + \"*/\"};\n }\n .carousel-control-next-icon {\n-  background-image: escape-svg($carousel-control-next-icon-bg);\n+  background-image: escape-svg($carousel-control-next-icon-bg) #{\"/*rtl:\" + escape-svg($carousel-control-prev-icon-bg) + \"*/\"};\n }\n \n // Optional indicator pips/controls"
        },
        {
          "filename": "scss/bootstrap/_modal.scss",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -126,7 +126,6 @@\n   display: flex;\n   flex-shrink: 0;\n   align-items: center;\n-  justify-content: space-between; // Put modal header elements (title and dismiss) on opposite ends\n   padding: var(--#{$prefix}modal-header-padding);\n   border-bottom: var(--#{$prefix}modal-header-border-width) solid var(--#{$prefix}modal-header-border-color);\n   @include border-top-radius(var(--#{$prefix}modal-inner-border-radius));"
        },
        {
          "filename": "scss/bootstrap/_offcanvas.scss",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -123,14 +123,11 @@\n .offcanvas-header {\n   display: flex;\n   align-items: center;\n-  justify-content: space-between;\n   padding: var(--#{$prefix}offcanvas-padding-y) var(--#{$prefix}offcanvas-padding-x);\n \n   .btn-close {\n     padding: calc(var(--#{$prefix}offcanvas-padding-y) * .5) calc(var(--#{$prefix}offcanvas-padding-x) * .5);\n-    margin-top: calc(-.5 * var(--#{$prefix}offcanvas-padding-y));\n-    margin-right: calc(-.5 * var(--#{$prefix}offcanvas-padding-x));\n-    margin-bottom: calc(-.5 * var(--#{$prefix}offcanvas-padding-y));\n+    margin: calc(-.5 * var(--#{$prefix}offcanvas-padding-y)) calc(-.5 * var(--#{$prefix}offcanvas-padding-x)) calc(-.5 * var(--#{$prefix}offcanvas-padding-y)) auto;\n   }\n }\n "
        },
        {
          "filename": "scss/bootstrap/_tables.scss",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -79,7 +79,7 @@\n //\n // When borders are added on all sides of the cells, the corners can render odd when\n // these borders do not have the same color or if they are semi-transparent.\n-// Therefor we add top and border bottoms to the `tr`s and left and right borders\n+// Therefore we add top and border bottoms to the `tr`s and left and right borders\n // to the `td`s or `th`s\n \n .table-bordered {"
        },
        {
          "filename": "scss/bootstrap/_variables.scss",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -1383,7 +1383,9 @@ $accordion-transition:                    $btn-transition, border-radius .15s ea\n $accordion-button-active-bg:              var(--#{$prefix}primary-bg-subtle) !default;\n $accordion-button-active-color:           var(--#{$prefix}primary-text-emphasis) !default;\n \n-$accordion-button-focus-border-color:     $input-focus-border-color !default;\n+// fusv-disable\n+$accordion-button-focus-border-color:     $input-focus-border-color !default; // Deprecated in v5.3.3\n+// fusv-enable\n $accordion-button-focus-box-shadow:       $btn-focus-box-shadow !default;\n \n $accordion-icon-width:                    1.25rem !default;\n@@ -1392,8 +1394,8 @@ $accordion-icon-active-color:             $primary-text-emphasis !default;\n $accordion-icon-transition:               transform .2s ease-in-out !default;\n $accordion-icon-transform:                rotate(-180deg) !default;\n \n-$accordion-button-icon:         url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='#{$accordion-icon-color}'><path fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/></svg>\") !default;\n-$accordion-button-active-icon:  url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='#{$accordion-icon-active-color}'><path fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/></svg>\") !default;\n+$accordion-button-icon:         url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='#{$accordion-icon-color}' stroke-linecap='round' stroke-linejoin='round'><path d='M2 5L8 11L14 5'/></svg>\") !default;\n+$accordion-button-active-icon:  url(\"data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='#{$accordion-icon-active-color}' stroke-linecap='round' stroke-linejoin='round'><path d='M2 5L8 11L14 5'/></svg>\") !default;\n // scss-docs-end accordion-variables\n \n // Tooltips\n@@ -1745,3 +1747,5 @@ $kbd-bg:                            var(--#{$prefix}body-color) !default;\n $nested-kbd-font-weight:            null !default; // Deprecated in v5.2.0, removing in v6\n \n $pre-color:                         null !default;\n+\n+@import \"variables-dark\"; // TODO: can be removed safely in v6, only here to avoid breaking changes in v5.3"
        },
        {
          "filename": "scss/bootstrap/forms/_form-check.scss",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -131,7 +131,7 @@\n     margin-left: $form-switch-padding-start * -1;\n     background-image: var(--#{$prefix}form-switch-bg);\n     background-position: left center;\n-    @include border-radius($form-switch-border-radius);\n+    @include border-radius($form-switch-border-radius, 0);\n     @include transition($form-switch-transition);\n \n     &:focus {"
        },
        {
          "filename": "scss/bootstrap/mixins/_banner.scss",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,7 +1,7 @@\n @mixin bsBanner($file) {\n   /*!\n-   * Bootstrap #{$file} v5.3.2 (https://getbootstrap.com/)\n-   * Copyright 2011-2023 The Bootstrap Authors\n+   * Bootstrap #{$file} v5.3.3 (https://getbootstrap.com/)\n+   * Copyright 2011-2024 The Bootstrap Authors\n    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n    */\n }"
        },
        {
          "filename": "scss/bootstrap/mixins/_forms.scss",
          "status": "modified",
          "additions": 12,
          "deletions": 2,
          "patch": "@@ -69,7 +69,12 @@\n \n       &:focus {\n         border-color: $border-color;\n-        box-shadow: $focus-box-shadow;\n+        @if $enable-shadows {\n+          @include box-shadow($input-box-shadow, $focus-box-shadow);\n+        } @else {\n+          // Avoid using mixin so we can pass custom focus shadow properly\n+          box-shadow: $focus-box-shadow;\n+        }\n       }\n     }\n   }\n@@ -100,7 +105,12 @@\n \n       &:focus {\n         border-color: $border-color;\n-        box-shadow: $focus-box-shadow;\n+        @if $enable-shadows {\n+          @include box-shadow($form-select-box-shadow, $focus-box-shadow);\n+        } @else {\n+          // Avoid using mixin so we can pass custom focus shadow properly\n+          box-shadow: $focus-box-shadow;\n+        }\n       }\n     }\n   }"
        },
        {
          "filename": "scss/bootstrap/mixins/_grid.scss",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -138,7 +138,7 @@\n           }\n         }\n \n-        // Start with `1` because `0` is and invalid value.\n+        // Start with `1` because `0` is an invalid value.\n         // Ends with `$columns - 1` because offsetting by the width of an entire row isn't possible.\n         @for $i from 1 through ($columns - 1) {\n           .g-start#{$infix}-#{$i} {"
        },
        {
          "filename": "scss/bootstrap/tests/mixins/_auto-import-of-variables-dark.test.scss",
          "status": "added",
          "additions": 7,
          "deletions": 0,
          "patch": "@@ -0,0 +1,7 @@\n+// TODO: this file can be removed safely in v6 when `@import \"variables-dark\"` will be removed at the end of _variables.scss\n+\n+@import \"../../functions\";\n+@import \"../../variables\";\n+// Voluntarily not importing _variables-dark.scss\n+@import \"../../maps\";\n+@import \"../../mixins\";"
        },
        {
          "filename": "scss/bootstrap/tests/mixins/_utilities.test.scss",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -258,7 +258,7 @@ $enable-important-utilities: false;\n           .desaturated-color-blue {\n             --bs-color-opacity: 1;\n             // Sass compilation will put a leading zero so we want to keep that one\n-            // stylelint-disable-next-line stylistic/number-leading-zero\n+            // stylelint-disable-next-line @stylistic/number-leading-zero\n             --bs-color-saturation: 0.25;\n             color: hsla(192deg, var(--bs-color-saturation), 0, var(--bs-color-opacity));\n           }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 7,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "409ede1a720b1d0cd2939f625d0065645db163dc",
            "date": "2024-10-15T22:59:33Z",
            "author_login": "givanz"
          },
          {
            "sha": "1a7e4a7367032ad15acddd33df2e27bff190966c",
            "date": "2024-09-23T09:00:26Z",
            "author_login": "givanz"
          },
          {
            "sha": "838b1555e273a7f9b7303192b7421f5427ef9515",
            "date": "2024-09-23T08:43:58Z",
            "author_login": "eduardokraus"
          },
          {
            "sha": "33e89aefa5e4507d307a702af5c4a66271c95311",
            "date": "2024-09-10T11:07:29Z",
            "author_login": "givanz"
          },
          {
            "sha": "1e8b5c59d213698199fe55aec974bb1da3cff5cd",
            "date": "2024-09-03T11:14:28Z",
            "author_login": "givanz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Reflected Cross-Site Scripting (XSS) vulnerability in VvvebJs before version 1.7.7, allows remote attackers to execute arbitrary code and obtain sensitive information via the action parameter in save.php.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-22T04:15:11.573",
    "last_modified": "2024-11-21T09:07:53.797",
    "fix_date": "2024-03-11T15:11:25Z"
  },
  "references": [
    {
      "url": "https://github.com/givanz/VvvebJs/commit/c0c0545b44b23acc288ef907fb498ce15b9b576e",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/givanz/VvvebJs/issues/342",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/givanz/VvvebJs/commit/c0c0545b44b23acc288ef907fb498ce15b9b576e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/givanz/VvvebJs/issues/342",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.889373",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "VvvebJs",
    "owner": "givanz",
    "created_at": "2017-10-11T15:39:02Z",
    "updated_at": "2025-01-14T10:27:10Z",
    "pushed_at": "2024-10-15T22:59:10Z",
    "size": 22727,
    "stars": 7431,
    "forks": 1671,
    "open_issues": 254,
    "watchers": 7431,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 1368852
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:59:03.488079"
  }
}