{
  "cve_id": "CVE-2024-29881",
  "github_data": {
    "repository": "tinymce/tinymce",
    "fix_commit": "bcdea2ad14e3c2cea40743fb48c63bba067ae6d1",
    "related_commits": [
      "bcdea2ad14e3c2cea40743fb48c63bba067ae6d1",
      "bcdea2ad14e3c2cea40743fb48c63bba067ae6d1"
    ],
    "patch_url": "https://github.com/tinymce/tinymce/commit/bcdea2ad14e3c2cea40743fb48c63bba067ae6d1.patch",
    "fix_commit_details": {
      "sha": "bcdea2ad14e3c2cea40743fb48c63bba067ae6d1",
      "commit_date": "2023-11-21T02:17:05Z",
      "author": {
        "login": "mkzhx",
        "type": "User",
        "stats": {
          "total_commits": 109,
          "average_weekly_commits": 0.11237113402061856,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 38
        }
      },
      "commit_message": {
        "title": "TINY-10348 & TINY-10349: Add sandbox_iframes and convert_unsafe_embeds options (#9172)",
        "length": 432,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 543,
        "additions": 483,
        "deletions": 60
      },
      "files": [
        {
          "filename": "modules/tinymce/CHANGELOG.md",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -14,6 +14,8 @@ and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0\n - Added new `StylesheetLoader.unloadRawCss` API that can be used to unload CSS that was loaded into a style element. #TINY-10352\n - Added `force_hex_color` editor option. Option `'always'` converts all RGB & RGBA colours to hex, `'rgb_only'` will only convert RGB and *not* RGBA colours to hex, `'off'` won't convert any colours to hex. #TINY-9819\n - Added `default_font_stack` editor option that makes it possible to define what is considered a system font stack. #TINY-10290\n+- New `sandbox_iframes` option that controls whether iframe elements will be added a `sandbox=\"\"` attribute to mitigate malicious intent. #TINY-10348\n+- New `convert_unsafe_embeds` option that controls whether `<object>` and `<embed>` elements will be converted to more restrictive alternatives, namely `<img>` for image MIME types, `<video>` for video MIME types, `<audio>` audio MIME types, or `<iframe>` for other or unspecified MIME types. #TINY-10349\n \n \n ### Improved"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/api/OptionTypes.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -86,6 +86,7 @@ interface BaseEditorOptions {\n   contextmenu?: string | string[] | false;\n   contextmenu_never_use_native?: boolean;\n   convert_fonts_to_spans?: boolean;\n+  convert_unsafe_embeds?: boolean;\n   convert_urls?: boolean;\n   custom_colors?: boolean;\n   custom_elements?: string;\n@@ -197,6 +198,7 @@ interface BaseEditorOptions {\n   resize?: boolean | 'both';\n   resize_img_proportional?: boolean;\n   root_name?: string;\n+  sandbox_iframes?: boolean;\n   schema?: SchemaType;\n   selector?: string;\n   setup?: SetupCallback;\n@@ -289,6 +291,7 @@ export interface EditorOptions extends NormalizedEditorOptions {\n   color_default_foreground: string;\n   content_css: string[];\n   contextmenu: string[];\n+  convert_unsafe_embeds: boolean;\n   custom_colors: boolean;\n   default_font_stack: string[];\n   document_base_url: string;\n@@ -336,6 +339,7 @@ export interface EditorOptions extends NormalizedEditorOptions {\n   promotion: boolean;\n   readonly: boolean;\n   removed_menuitems: string;\n+  sandbox_iframes: boolean;\n   toolbar: boolean | string | string[] | Array<ToolbarGroup>;\n   toolbar_groups: Record<string, Toolbar.GroupToolbarButtonSpec>;\n   toolbar_location: ToolbarLocation;"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/api/Options.ts",
          "status": "modified",
          "additions": 20,
          "deletions": 19,
          "patch": "@@ -836,6 +836,16 @@ const register = (editor: Editor): void => {\n     default: 'off',\n   });\n \n+  registerOption('sandbox_iframes', {\n+    processor: 'boolean',\n+    default: false\n+  });\n+\n+  registerOption('convert_unsafe_embeds', {\n+    processor: 'boolean',\n+    default: false\n+  });\n+\n   // These options must be registered later in the init sequence due to their default values\n   editor.on('ScriptsLoaded', () => {\n     registerOption('directionality', {\n@@ -944,28 +954,17 @@ const shouldPreserveCData = option('preserve_cdata');\n const shouldHighlightOnFocus = option('highlight_on_focus');\n const shouldSanitizeXss = option('xss_sanitization');\n const shouldUseDocumentWrite = option('init_content_sync');\n-\n-const hasTextPatternsLookup = (editor: Editor): boolean =>\n-  editor.options.isSet('text_patterns_lookup');\n-\n-const getFontStyleValues = (editor: Editor): string[] =>\n-  Tools.explode(editor.options.get('font_size_style_values'));\n-\n-const getFontSizeClasses = (editor: Editor): string[] =>\n-  Tools.explode(editor.options.get('font_size_classes'));\n-\n-const isEncodingXml = (editor: Editor): boolean =>\n-  editor.options.get('encoding') === 'xml';\n-\n-const getAllowedImageFileTypes = (editor: Editor): string[] =>\n-  Tools.explode(editor.options.get('images_file_types'));\n-\n+const hasTextPatternsLookup = (editor: Editor): boolean => editor.options.isSet('text_patterns_lookup');\n+const getFontStyleValues = (editor: Editor): string[] => Tools.explode(editor.options.get('font_size_style_values'));\n+const getFontSizeClasses = (editor: Editor): string[] => Tools.explode(editor.options.get('font_size_classes'));\n+const isEncodingXml = (editor: Editor): boolean => editor.options.get('encoding') === 'xml';\n+const getAllowedImageFileTypes = (editor: Editor): string[] => Tools.explode(editor.options.get('images_file_types'));\n const hasTableTabNavigation = option('table_tab_navigation');\n-\n const getDetailsInitialState = option('details_initial_state');\n const getDetailsSerializedState = option('details_serialized_state');\n-\n const shouldForceHexColor = option('force_hex_color');\n+const shouldSandboxIframes = option('sandbox_iframes');\n+const shouldConvertUnsafeEmbeds = option('convert_unsafe_embeds');\n \n export {\n   register,\n@@ -1071,5 +1070,7 @@ export {\n   getDetailsInitialState,\n   getDetailsSerializedState,\n   shouldUseDocumentWrite,\n-  shouldForceHexColor\n+  shouldForceHexColor,\n+  shouldSandboxIframes,\n+  shouldConvertUnsafeEmbeds\n };"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/api/html/DomParser.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -57,6 +57,7 @@ export interface DomParserSettings {\n   allow_unsafe_link_target?: boolean;\n   blob_cache?: BlobCache;\n   convert_fonts_to_spans?: boolean;\n+  convert_unsafe_embeds?: boolean;\n   document?: Document;\n   fix_list_elements?: boolean;\n   font_size_legacy_values?: string;\n@@ -69,6 +70,7 @@ export interface DomParserSettings {\n    * @deprecated Remove trailing <br> tags functionality has been added to tinymce.dom.Serializer and option will be removed in the next major release */\n   remove_trailing_brs?: boolean;\n   root_name?: string;\n+  sandbox_iframes?: boolean;\n   sanitize?: boolean;\n   validate?: boolean;\n }"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/content/PrePostProcess.ts",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -2,7 +2,7 @@ import { Result } from '@ephox/katamari';\n \n import Editor from '../api/Editor';\n import * as Events from '../api/Events';\n-import DomParser from '../api/html/DomParser';\n+import DomParser, { DomParserSettings } from '../api/html/DomParser';\n import HtmlSerializer from '../api/html/Serializer';\n import * as Options from '../api/Options';\n import { EditorEvent } from '../api/util/EventDispatcher';\n@@ -11,7 +11,7 @@ import { Content, GetContentArgs, isTreeNode, SetContentArgs } from './ContentTy\n const serializeContent = (content: Content): string =>\n   isTreeNode(content) ? HtmlSerializer({ validate: false }).serialize(content) : content;\n \n-const withSerializedContent = <R extends EditorEvent<{ content: string }>>(content: Content, fireEvent: (content: string) => R, sanitize: boolean): R & { content: Content } => {\n+const withSerializedContent = <R extends EditorEvent<{ content: string }>>(content: Content, fireEvent: (content: string) => R, parserSettings: DomParserSettings): R & { content: Content } => {\n   const serializedContent = serializeContent(content);\n   const eventArgs = fireEvent(serializedContent);\n   if (eventArgs.isDefaultPrevented()) {\n@@ -20,7 +20,7 @@ const withSerializedContent = <R extends EditorEvent<{ content: string }>>(conte\n     // Restore the content type back to being an AstNode. If the content has changed we need to\n     // re-parse the new content, otherwise we can return the input.\n     if (eventArgs.content !== serializedContent) {\n-      const rootNode = DomParser({ validate: false, forced_root_block: false, sanitize }).parse(eventArgs.content, { context: content.name });\n+      const rootNode = DomParser({ validate: false, forced_root_block: false, ...parserSettings }).parse(eventArgs.content, { context: content.name });\n       return { ...eventArgs, content: rootNode };\n     } else {\n       return { ...eventArgs, content };\n@@ -47,7 +47,7 @@ const postProcessGetContent = <T extends GetContentArgs>(editor: Editor, content\n   if (args.no_events) {\n     return content;\n   } else {\n-    const processedEventArgs = withSerializedContent(content, (content) => Events.fireGetContent(editor, { ...args, content }), Options.shouldSanitizeXss(editor));\n+    const processedEventArgs = withSerializedContent(content, (content) => Events.fireGetContent(editor, { ...args, content }), { sanitize: Options.shouldSanitizeXss(editor), sandbox_iframes: Options.shouldSandboxIframes(editor) });\n     return processedEventArgs.content;\n   }\n };\n@@ -56,7 +56,7 @@ const preProcessSetContent = <T extends SetContentArgs>(editor: Editor, args: T)\n   if (args.no_events) {\n     return Result.value(args);\n   } else {\n-    const processedEventArgs = withSerializedContent(args.content, (content) => Events.fireBeforeSetContent(editor, { ...args, content }), Options.shouldSanitizeXss(editor));\n+    const processedEventArgs = withSerializedContent(args.content, (content) => Events.fireBeforeSetContent(editor, { ...args, content }), { sanitize: Options.shouldSanitizeXss(editor), sandbox_iframes: Options.shouldSandboxIframes(editor) });\n     if (processedEventArgs.isDefaultPrevented()) {\n       Events.fireSetContent(editor, processedEventArgs);\n       return Result.error(undefined);"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/html/ParserFilters.ts",
          "status": "modified",
          "additions": 48,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-import { Arr, Type } from '@ephox/katamari';\n+import { Arr, Strings, Type } from '@ephox/katamari';\n \n import Env from '../api/Env';\n import DomParser, { DomParserSettings } from '../api/html/DomParser';\n@@ -32,6 +32,36 @@ const registerBase64ImageFilter = (parser: DomParser, settings: DomParserSetting\n   }\n };\n \n+const isMimeType = (mime: string, type: 'image' | 'video' | 'audio'): boolean => Strings.startsWith(mime, `${type}/`);\n+\n+const createSafeEmbed = (mime?: string, src?: string, width?: string, height?: string, sandboxIframes?: boolean): AstNode => {\n+  let name: 'iframe' | 'img' | 'video' | 'audio';\n+  if (Type.isUndefined(mime)) {\n+    name = 'iframe';\n+  } else if (isMimeType(mime, 'image')) {\n+    name = 'img';\n+  } else if (isMimeType(mime, 'video')) {\n+    name = 'video';\n+  } else if (isMimeType(mime, 'audio')) {\n+    name = 'audio';\n+  } else {\n+    name = 'iframe';\n+  }\n+\n+  const embed = new AstNode(name, 1);\n+  embed.attr(name === 'audio' ? { src } : { src, width, height });\n+\n+  // TINY-10349: Show controls for audio and video so the replaced embed is visible in editor.\n+  if (name === 'audio' || name === 'video') {\n+    embed.attr('controls', '');\n+  }\n+\n+  if (name === 'iframe' && sandboxIframes) {\n+    embed.attr('sandbox', '');\n+  }\n+  return embed;\n+};\n+\n const register = (parser: DomParser, settings: DomParserSettings): void => {\n   const schema = parser.schema;\n \n@@ -153,6 +183,23 @@ const register = (parser: DomParser, settings: DomParserSettings): void => {\n   }\n \n   registerBase64ImageFilter(parser, settings);\n+\n+  if (settings.convert_unsafe_embeds) {\n+    parser.addNodeFilter('object,embed', (nodes) => Arr.each(nodes, (node) => {\n+      node.replace(\n+        createSafeEmbed(\n+          node.attr('type'),\n+          node.name === 'object' ? node.attr('data') : node.attr('src'),\n+          node.attr('width'),\n+          node.attr('height'),\n+          settings.sandbox_iframes\n+        ));\n+    }));\n+  }\n+\n+  if (settings.sandbox_iframes) {\n+    parser.addNodeFilter('iframe', (nodes) => Arr.each(nodes, (node) => node.attr('sandbox', '')));\n+  }\n };\n \n export {"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/init/InitContentBody.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -73,6 +73,7 @@ const mkParserSettings = (editor: Editor): DomParserSettings => {\n     allow_html_in_named_anchor: getOption('allow_html_in_named_anchor'),\n     allow_script_urls: getOption('allow_script_urls'),\n     allow_unsafe_link_target: getOption('allow_unsafe_link_target'),\n+    convert_unsafe_embeds: getOption('convert_unsafe_embeds'),\n     convert_fonts_to_spans: getOption('convert_fonts_to_spans'),\n     fix_list_elements: getOption('fix_list_elements'),\n     font_size_legacy_values: getOption('font_size_legacy_values'),\n@@ -81,6 +82,7 @@ const mkParserSettings = (editor: Editor): DomParserSettings => {\n     preserve_cdata: getOption('preserve_cdata'),\n     inline_styles: getOption('inline_styles'),\n     root_name: getRootName(editor),\n+    sandbox_iframes: getOption('sandbox_iframes'),\n     sanitize: getOption('xss_sanitization'),\n     validate: true,\n     blob_cache: blobCache,"
        },
        {
          "filename": "modules/tinymce/src/core/main/ts/paste/ProcessFilters.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -11,7 +11,7 @@ interface ProcessResult {\n }\n \n const preProcess = (editor: Editor, html: string): string => {\n-  const parser = DomParser({ sanitize: Options.shouldSanitizeXss(editor) }, editor.schema);\n+  const parser = DomParser({ sanitize: Options.shouldSanitizeXss(editor), sandbox_iframes: Options.shouldSandboxIframes(editor) }, editor.schema);\n \n   // Strip meta elements\n   parser.addNodeFilter('meta', (nodes) => {"
        },
        {
          "filename": "modules/tinymce/src/core/test/ts/browser/content/EditorContentTest.ts",
          "status": "modified",
          "additions": 123,
          "deletions": 1,
          "patch": "@@ -350,6 +350,128 @@ describe('browser.tinymce.core.content.EditorContentTest', () => {\n             assert.equal(content, final, 'ZWNBSP should be stripped');\n           });\n         });\n+\n+        context('iframe sandboxing', () => {\n+          context('sandbox_iframes default', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce'\n+            }, []);\n+\n+            it('TINY-10348: Iframe should not be sandboxed by default', () => {\n+              const editor = hook.editor();\n+              editor.setContent('<iframe src=\"about:blank\"></iframe>');\n+              TinyAssertions.assertContent(editor, '<p><iframe src=\"about:blank\"></iframe></p>');\n+            });\n+          });\n+\n+          context('sandbox_iframes: false', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce',\n+              sandbox_iframes: false\n+            }, []);\n+\n+            it('TINY-10348: Iframe should not be sandboxed when sandbox_iframes: false', () => {\n+              const editor = hook.editor();\n+              editor.setContent('<iframe src=\"about:blank\"></iframe>');\n+              TinyAssertions.assertContent(editor, '<p><iframe src=\"about:blank\"></iframe></p>');\n+            });\n+\n+            it('TINY-10348: Iframe with sandbox attribute should not be modified when sandbox_iframes: false', () => {\n+              const editor = hook.editor();\n+              editor.setContent('<iframe src=\"about:blank\" sandbox=\"allow-scripts allow-same-origin allow-forms\"></iframe>');\n+              TinyAssertions.assertContent(editor, '<p><iframe src=\"about:blank\" sandbox=\"allow-scripts allow-same-origin allow-forms\"></iframe></p>');\n+            });\n+          });\n+\n+          context('sandbox_iframes: true', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce',\n+              sandbox_iframes: true\n+            }, []);\n+\n+            it('TINY-10348: Iframe should be sandboxed when sandbox_iframes: true', () => {\n+              const editor = hook.editor();\n+              editor.setContent('<iframe src=\"about:blank\"></iframe>');\n+              TinyAssertions.assertContent(editor, '<p><iframe src=\"about:blank\" sandbox=\"\"></iframe></p>');\n+            });\n+\n+            it('TINY-10348: Iframe with sandbox attribute should be sandboxed when sandbox_iframes: true', () => {\n+              const editor = hook.editor();\n+              editor.setContent('<iframe src=\"about:blank\" sandbox=\"allow-scripts allow-same-origin allow-forms\"></iframe>');\n+              TinyAssertions.assertContent(editor, '<p><iframe src=\"about:blank\" sandbox=\"\"></iframe></p>');\n+            });\n+          });\n+        });\n+\n+        context('Convert unsafe embeds', () => {\n+          const setAndAssertEmbed = (editor: Editor, embedHtml: string, expectedHtml: string) => {\n+            editor.setContent(embedHtml);\n+            TinyAssertions.assertContent(editor, `<p>${expectedHtml}</p>`);\n+          };\n+\n+          const testNoConversion = (hook: TinyHooks.Hook<Editor>, embedHtml: string) => () => {\n+            const editor = hook.editor();\n+            setAndAssertEmbed(editor, embedHtml, embedHtml);\n+          };\n+\n+          const testConversion = (hook: TinyHooks.Hook<Editor>, embedHtml: string, expectedHtml: string) => () => {\n+            const editor = hook.editor();\n+            setAndAssertEmbed(editor, embedHtml, expectedHtml);\n+          };\n+\n+          context('convert_unsafe_embeds default', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce'\n+            }, []);\n+\n+            it('TINY-10349: Object elements should not be converted', testNoConversion(hook, '<object data=\"about:blank\"></object>'));\n+            it('TINY-10349: Embed elements should not be converted', testNoConversion(hook, '<embed src=\"about:blank\">'));\n+          });\n+\n+          context('convert_unsafe_embeds: false', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce',\n+              convert_unsafe_embeds: false\n+            }, []);\n+\n+            it('TINY-10349: Object elements should not be converted', testNoConversion(hook, '<object data=\"about:blank\"></object>'));\n+            it('TINY-10349: Embed elements should not be converted', testNoConversion(hook, '<embed src=\"about:blank\">'));\n+          });\n+\n+          context('convert_unsafe_embeds: true', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce',\n+              convert_unsafe_embeds: true\n+            }, []);\n+\n+            it('TINY-10349: Object elements should be converted to iframe',\n+              testConversion(hook, '<object data=\"about:blank\"></object>', '<iframe src=\"about:blank\"></iframe>'));\n+\n+            it('TINY-10349: Embed elements should be converted to iframe',\n+              testConversion(hook, '<embed src=\"about:blank\">', '<iframe src=\"about:blank\"></iframe>'));\n+          });\n+\n+          context('convert_unsafe_embeds: true, sandbox_iframes: true', () => {\n+            const hook = TinyHooks.bddSetupLight<Editor>({\n+              ...options,\n+              base_url: '/project/tinymce/js/tinymce',\n+              convert_unsafe_embeds: true,\n+              sandbox_iframes: true\n+            }, []);\n+\n+            it('TINY-10349: Object elements should be converted to sandboxed iframe',\n+              testConversion(hook, '<object data=\"about:blank\"></object>', '<iframe src=\"about:blank\" sandbox=\"\"></iframe>'));\n+\n+            it('TINY-10349: Embed elements should be converted to sandboxed iframe',\n+              testConversion(hook, '<embed src=\"about:blank\">', '<iframe src=\"about:blank\" sandbox=\"\"></iframe>'));\n+          });\n+        });\n       });\n     }\n   );\n@@ -433,7 +555,7 @@ describe('browser.tinymce.core.content.EditorContentTest', () => {\n           editor.setContent('<p><iframe><p>test</p></iframe></p>');\n           const content = editor.getContent();\n           assert.equal(content,\n-            // TINY-9624: Investigate Safari-specific HTML output\n+            // TINY-9624: Safari seems to encode the contents of iframes\n             isSafari\n               ? '<p><iframe>&lt;p&gt;test&lt;/p&gt;</iframe></p>'\n               : '<p><iframe><p>test</p></iframe></p>',"
        },
        {
          "filename": "modules/tinymce/src/core/test/ts/browser/html/DomParserTest.ts",
          "status": "modified",
          "additions": 101,
          "deletions": 2,
          "patch": "@@ -822,8 +822,8 @@ describe('browser.tinymce.core.html.DomParserTest', () => {\n         );\n       });\n \n-      // TODO: TINY-9624 - the iframe innerHTML on safari is `&lt;textarea&gt;` whereas on other browsers\n-      //       is `<textarea>`. This causes the mXSS cleaner in DOMPurify to run and causes the different assertions below\n+      // TINY-9624: Safari encodes the iframe innerHTML is `&lt;textarea&gt;`. On Chrome and Firefox, the innerHTML is `<textarea>`, causing\n+      // the mXSS cleaner in DOMPurify to run and remove the iframe.\n       it('parse iframe XSS', () => {\n         const serializer = HtmlSerializer();\n \n@@ -1531,6 +1531,105 @@ describe('browser.tinymce.core.html.DomParserTest', () => {\n           }));\n         });\n       });\n+\n+      context('Sandboxing iframes', () => {\n+        const serializeIframeHtml = (sandbox: boolean): string => {\n+          const parser = DomParser({ ...scenario.settings, sandbox_iframes: sandbox });\n+          return serializer.serialize(parser.parse('<iframe src=\"about:blank\"></iframe>'));\n+        };\n+\n+        it('TINY-10348: iframes should be sandboxed when sandbox_iframes: false', () =>\n+          assert.equal(serializeIframeHtml(false), '<iframe src=\"about:blank\"></iframe>'));\n+\n+        it('TINY-10348: iframes should be sandboxed when sandbox_iframes: true', () =>\n+          assert.equal(serializeIframeHtml(true), '<iframe src=\"about:blank\" sandbox=\"\"></iframe>'));\n+      });\n+\n+      context('Convert unsafe embeds', () => {\n+        const serializeEmbedHtml = (embedHtml: string, convert: boolean): string => {\n+          const parser = DomParser({ ...scenario.settings, convert_unsafe_embeds: convert });\n+          return serializer.serialize(parser.parse(embedHtml));\n+        };\n+\n+        const testConversion = (embedHtml: string, expectedHtml: string) => () => {\n+          const serializedHtml = serializeEmbedHtml(embedHtml, true);\n+          assert.equal(serializedHtml, expectedHtml);\n+        };\n+\n+        context('convert_unsafe_embeds: false', () => {\n+          const testNoConversion = (embedHtml: string) => () => {\n+            const serializedHtml = serializeEmbedHtml(embedHtml, false);\n+            assert.equal(serializedHtml, embedHtml);\n+          };\n+\n+          it('TINY-10349: Object elements should not be converted', testNoConversion('<object data=\"about:blank\"></object>'));\n+          it('TINY-10349: Object elements with a mime type should not be converted', testNoConversion('<object data=\"about:blank\" type=\"image/png\"></object>'));\n+          it('TINY-10349: Embed elements should notr be converted', testNoConversion('<embed src=\"about:blank\">'));\n+          it('TINY-10349: Embed elements with a mime type should not be converted', testNoConversion('<embed src=\"about:blank\" type=\"image/png\">'));\n+        });\n+\n+        context('convert_unsafe_embeds: true', () => {\n+          it('TINY-10349: Object elements without a mime type should be converted to iframe',\n+            testConversion('<object data=\"about:blank\"></object>', '<iframe src=\"about:blank\"></iframe>'));\n+          it('TINY-10349: Object elements with an image mime type should be converted to img',\n+            testConversion('<object data=\"about:blank\" type=\"image/png\"></object>', '<img src=\"about:blank\">'));\n+          it('TINY-10349: Object elements with a video mime type should be converted to video',\n+            testConversion('<object data=\"about:blank\" type=\"video/mp4\"></object>', '<video src=\"about:blank\" controls=\"\"></video>'));\n+          it('TINY-10349: Object elements with an audio mime type should be converted to audio',\n+            testConversion('<object data=\"about:blank\" type=\"audio/mpeg\"></object>', '<audio src=\"about:blank\" controls=\"\"></audio>'));\n+          it('TINY-10349: Object elements with other mime type should be converted to iframe',\n+            testConversion('<object data=\"about:blank\" type=\"application/pdf\"></object>', '<iframe src=\"about:blank\"></iframe>'));\n+\n+          it('TINY-10349: Embed elements without a mime type should be converted to iframe',\n+            testConversion('<embed src=\"about:blank\">', '<iframe src=\"about:blank\"></iframe>'));\n+          it('TINY-10349: Embed elements with an image mime type should be converted to img',\n+            testConversion('<embed src=\"about:blank\" type=\"image/png\">', '<img src=\"about:blank\">'));\n+          it('TINY-10349: Embed elements with a video mime type should be converted to video',\n+            testConversion('<embed src=\"about:blank\" type=\"video/mp4\">', '<video src=\"about:blank\" controls=\"\"></video>'));\n+          it('TINY-10349: Embed elements with an audio mime type should be converted to audio',\n+            testConversion('<embed src=\"about:blank\" type=\"audio/mpeg\">', '<audio src=\"about:blank\" controls=\"\"></audio>'));\n+          it('TINY-10349: Embed elements with other mime type should be converted to iframe',\n+            testConversion('<embed src=\"about:blank\" type=\"application/pdf\">', '<iframe src=\"about:blank\"></iframe>'));\n+        });\n+\n+        context('convert_unsafe_embeds: true, sandbox_iframes: true', () => {\n+          const testSandboxedConversion = (embedHtml: string, expectedHtml: string) => () => {\n+            const parser = DomParser({ ...scenario.settings, convert_unsafe_embeds: true, sandbox_iframes: true });\n+            const serializedHtml = serializer.serialize(parser.parse(embedHtml));\n+            assert.equal(serializedHtml, expectedHtml);\n+          };\n+\n+          it('TINY-10349: Object elements without a mime type should be converted to sandboxed iframe',\n+            testSandboxedConversion('<object data=\"about:blank\"></object>', '<iframe src=\"about:blank\" sandbox=\"\"></iframe>'));\n+\n+          it('TINY-10349: Embed elements without a mime type should be converted to sandboxed iframe',\n+            testSandboxedConversion('<embed src=\"about:blank\">', '<iframe src=\"about:blank\" sandbox=\"\"></iframe>'));\n+        });\n+\n+        context('convert_unsafe_embeds: true, attribute preservation', () => {\n+          it('TINY-10349: Object elements should perserve width and height attributes only',\n+            testConversion('<object data=\"about:blank\" width=\"100\" height=\"100\" style=\"color: red;\"></object>', '<iframe src=\"about:blank\" width=\"100\" height=\"100\"></iframe>'));\n+          it('TINY-10349: Object elements with an image mime type should perserve width and height attributes only',\n+            testConversion('<object data=\"about:blank\" type=\"image/png\" width=\"100\" height=\"100\" style=\"color: red;\"></object>', '<img src=\"about:blank\" width=\"100\" height=\"100\">'));\n+          it('TINY-10349: Object elements with a video mime type should perserve width and height attributes only',\n+            testConversion('<object data=\"about:blank\" type=\"video/mp4\" width=\"100\" height=\"100\" style=\"color: red;\"></object>', '<video src=\"about:blank\" width=\"100\" height=\"100\" controls=\"\"></video>'));\n+          it('TINY-10349: Object elements with an audio mime type should not perserve other attributes only',\n+            testConversion('<object data=\"about:blank\" type=\"audio/mpeg\" width=\"100\" height=\"100\" style=\"color: red;\"></object>', '<audio src=\"about:blank\" controls=\"\"></audio>'));\n+          it('TINY-10349: Object elements with other mime type should perserve width and height attributes only',\n+            testConversion('<object data=\"about:blank\" type=\"application/pdf\" width=\"100\" height=\"100\" style=\"color: red;\"></object>', '<iframe src=\"about:blank\" width=\"100\" height=\"100\"></iframe>'));\n+\n+          it('TINY-10349: Embed elements should preserve width and heigth attributes only',\n+            testConversion('<embed src=\"about:blank\" width=\"100\" height=\"100\" style=\"color: red;\">', '<iframe src=\"about:blank\" width=\"100\" height=\"100\"></iframe>'));\n+          it('TINY-10349: Embed elements with an image mime type should preserve width and height attributes only',\n+            testConversion('<embed src=\"about:blank\" type=\"image/png\" width=\"100\" height=\"100\" style=\"color: red;\">', '<img src=\"about:blank\" width=\"100\" height=\"100\">'));\n+          it('TINY-10349: Embed elements with a video mime type should preserve width and height attributes only',\n+            testConversion('<embed src=\"about:blank\" type=\"video/mp4\" width=\"100\" height=\"100\" style=\"color: red;\">', '<video src=\"about:blank\" width=\"100\" height=\"100\" controls=\"\"></video>'));\n+          it('TINY-10349: Embed elements with an audio mime type should not preserve other attributes',\n+            testConversion('<embed src=\"about:blank\" type=\"audio/mpeg\" width=\"100\" height=\"100\" style=\"color: red;\">', '<audio src=\"about:blank\" controls=\"\"></audio>'));\n+          it('TINY-10349: Embed elements with other mime type should preserve width and height attributes only',\n+            testConversion('<embed src=\"about:blank\" type=\"application/pdf\" width=\"100\" height=\"100\" style=\"color: red;\">', '<iframe src=\"about:blank\" width=\"100\" height=\"100\"></iframe>'));\n+        });\n+      });\n     });\n   });\n "
        },
        {
          "filename": "modules/tinymce/src/core/test/ts/browser/paste/PasteTest.ts",
          "status": "modified",
          "additions": 71,
          "deletions": 0,
          "patch": "@@ -19,6 +19,13 @@ describe('browser.tinymce.core.paste.PasteTest', () => {\n     base_url: '/project/tinymce/js/tinymce'\n   }, [], true);\n \n+  const testPasteHtml = (hook: TinyHooks.Hook<Editor>, html: string, expected: string) => () => {\n+    const editor = hook.editor();\n+    editor.setContent('');\n+    editor.execCommand('mceInsertClipboardContent', false, { html });\n+    TinyAssertions.assertContent(editor, expected);\n+  };\n+\n   beforeEach(() => {\n     const editor = hook.editor();\n     editor.setContent('');\n@@ -505,5 +512,69 @@ describe('browser.tinymce.core.paste.PasteTest', () => {\n       editor.off('beforeinput', setBeforeInputEvent);\n       editor.off('input', setInputEvent);\n     });\n+\n+    context('iframe sandboxing', () => {\n+      context('sandbox_iframes: false', () => {\n+        const hook = TinyHooks.bddSetupLight<Editor>({\n+          base_url: '/project/tinymce/js/tinymce',\n+          sandbox_iframes: false\n+        });\n+\n+        it('TINY-10348: Pasted iframe should not be sandboxed',\n+          testPasteHtml(hook, '<iframe src=\"about:blank\"></iframe>', '<p><iframe src=\"about:blank\"></iframe></p>'));\n+      });\n+\n+      context('sandbox_iframes: true', () => {\n+        const hook = TinyHooks.bddSetupLight<Editor>({\n+          base_url: '/project/tinymce/js/tinymce',\n+          sandbox_iframes: true\n+        });\n+\n+        it('TINY-10348: Pasted iframe should be sandboxed',\n+          testPasteHtml(hook, '<iframe src=\"about:blank\"></iframe>', '<p><iframe src=\"about:blank\" sandbox=\"\"></iframe></p>'));\n+      });\n+    });\n+\n+    context('Convert unsafe embeds', () => {\n+      context('convert_unsafe_embeds: false', () => {\n+        const hook = TinyHooks.bddSetupLight<Editor>({\n+          base_url: '/project/tinymce/js/tinymce',\n+          convert_unsafe_embeds: false\n+        });\n+\n+        it('TINY-10349: Pasted object element should not be converted',\n+          testPasteHtml(hook, '<object data=\"about:blank\"></object>', '<p><object data=\"about:blank\"></object></p>'));\n+\n+        it('TINY-10349: Pasted embed element should not be converted',\n+          testPasteHtml(hook, '<embed src=\"about:blank\">', '<p><embed src=\"about:blank\"></p>'));\n+      });\n+\n+      context('convert_unsafe_embeds: true', () => {\n+        const hook = TinyHooks.bddSetupLight<Editor>({\n+          base_url: '/project/tinymce/js/tinymce',\n+          convert_unsafe_embeds: true\n+        });\n+\n+        it('TINY-10349: Pasted object element should be converted to iframe',\n+          testPasteHtml(hook, '<object data=\"about:blank\">', '<p><iframe src=\"about:blank\"></iframe></p>'));\n+\n+        it('TINY-10349: Pasted embed element should be converted to iframe',\n+          testPasteHtml(hook, '<embed src=\"about:blank\">', '<p><iframe src=\"about:blank\"></iframe></p>'));\n+      });\n+\n+      context('convert_unsafe_embeds: true, sandbox_iframes: true', () => {\n+        const hook = TinyHooks.bddSetupLight<Editor>({\n+          base_url: '/project/tinymce/js/tinymce',\n+          convert_unsafe_embeds: true,\n+          sandbox_iframes: true\n+        });\n+\n+        it('TINY-10349: Pasted object element should be converted to sandboxed iframe',\n+          testPasteHtml(hook, '<object data=\"about:blank\"></object>', '<p><iframe src=\"about:blank\" sandbox=\"\"></iframe></p>'));\n+\n+        it('TINY-10349: Pasted embed element should be converted to sandboxed iframe',\n+          testPasteHtml(hook, '<embed src=\"about:blank\">', '<p><iframe src=\"about:blank\" sandbox=\"\"></iframe></p>'));\n+      });\n+    });\n   });\n });"
        },
        {
          "filename": "modules/tinymce/src/plugins/media/main/ts/core/Nodes.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -91,7 +91,8 @@ const createPreviewNode = (editor: Editor, node: AstNode): AstNode => {\n   if (name === 'iframe') {\n     previewNode.attr({\n       allowfullscreen: node.attr('allowfullscreen'),\n-      frameborder: '0'\n+      frameborder: '0',\n+      sandbox: node.attr('sandbox')\n     });\n   } else {\n     // Exclude autoplay as we don't want video/audio to play by default"
        },
        {
          "filename": "modules/tinymce/src/plugins/media/test/ts/browser/ContentFormatsTest.ts",
          "status": "modified",
          "additions": 18,
          "deletions": 0,
          "patch": "@@ -57,6 +57,24 @@ describe('browser.tinymce.plugins.media.ContentFormatsTest', () => {\n     );\n   });\n \n+  it('TINY-10348: Iframe retained as is with sandbox_iframes: false', async () => {\n+    const editor = await McEditor.pFromSettings({ ...settings, sandbox_iframes: false });\n+    editor.setContent('<iframe src=\"320x240.ogg\" allowfullscreen></iframe>');\n+    TinyAssertions.assertContent(editor,\n+      '<p><iframe src=\"320x240.ogg\" width=\"300\" height=\"150\" allowfullscreen=\"allowfullscreen\"></iframe></p>'\n+    );\n+    McEditor.remove(editor);\n+  });\n+\n+  it('TINY-10348: Iframe retained as is with sandbox_iframes: true', async () => {\n+    const editor = await McEditor.pFromSettings({ ...settings, sandbox_iframes: true });\n+    editor.setContent('<iframe src=\"320x240.ogg\" allowfullscreen></iframe>');\n+    TinyAssertions.assertContent(editor,\n+      '<p><iframe src=\"320x240.ogg\" width=\"300\" height=\"150\" sandbox=\"\" allowfullscreen=\"allowfullscreen\"></iframe></p>'\n+    );\n+    McEditor.remove(editor);\n+  });\n+\n   it('TBA: Iframe with innerHTML retained as is with xss_sanitization: false', async () => {\n     // TINY-8363: Iframe with innerHTML is removed by DOMPurify, so disable sanitization for this test\n     const editor = await McEditor.pFromSettings<Editor>({"
        },
        {
          "filename": "modules/tinymce/src/plugins/media/test/ts/browser/LiveEmbedNodeTest.ts",
          "status": "modified",
          "additions": 26,
          "deletions": 7,
          "patch": "@@ -1,23 +1,26 @@\n import { ApproxStructure, Assertions, StructAssert, UiFinder } from '@ephox/agar';\n-import { describe, it } from '@ephox/bedrock-client';\n-import { Arr, Fun, Obj } from '@ephox/katamari';\n-import { TinyDom, TinyHooks } from '@ephox/wrap-mcagar';\n+import { context, describe, it } from '@ephox/bedrock-client';\n+import { Arr, Fun, Obj, Type } from '@ephox/katamari';\n+import { McEditor, TinyDom, TinyHooks } from '@ephox/wrap-mcagar';\n \n import Editor from 'tinymce/core/api/Editor';\n import Plugin from 'tinymce/plugins/media/Plugin';\n \n describe('browser.tinymce.plugins.media.core.LiveEmbedNodeTest', () => {\n-  const hook = TinyHooks.bddSetupLight<Editor>({\n+  const baseSettings = {\n     plugins: [ 'media' ],\n-    toolbar: 'media',\n+    toolbar: 'media'\n+  };\n+  const hook = TinyHooks.bddSetupLight<Editor>({\n+    ...baseSettings,\n     base_url: '/project/tinymce/js/tinymce'\n   }, [ Plugin ]);\n \n   const assertStructure = (\n     editor: Editor,\n     tag: string,\n     classes: string[],\n-    attrs: Record<string, string>,\n+    attrs: Record<string, string | null>,\n     styles: Record<string, string>,\n     getChildren: ApproxStructure.Builder<StructAssert[]> = Fun.constant([])\n   ) => {\n@@ -36,7 +39,7 @@ describe('browser.tinymce.plugins.media.core.LiveEmbedNodeTest', () => {\n           attrs: {\n             height: str.none('should not have height'),\n             width: str.none('should not have width'),\n-            ...Obj.map(attrs, (value) => str.is(value))\n+            ...Obj.map(attrs, (value) => Type.isNull(value) ? str.none() : str.is(value))\n           },\n           styles: {\n             height: str.none('should not have height style'),\n@@ -131,4 +134,20 @@ describe('browser.tinymce.plugins.media.core.LiveEmbedNodeTest', () => {\n       })\n     ]);\n   });\n+\n+  context('Sandboxing iframes', () => {\n+    const initialIframeHtml = '<iframe src=\"about:blank\"></iframe>';\n+\n+    it('TINY-10348: sandbox_iframes: false should not have sandbox attribute in live embed', async () => {\n+      const editor = await McEditor.pFromSettings<Editor>({ ...baseSettings, sandbox_iframes: false });\n+      editor.setContent(initialIframeHtml);\n+      assertStructure(editor, 'iframe', [ ], { sandbox: null }, { });\n+    });\n+\n+    it('TINY-10348: sandbox_iframes: true should havce sandbox attribute in live embed', async () => {\n+      const editor = await McEditor.pFromSettings<Editor>({ ...baseSettings, sandbox_iframes: true });\n+      editor.setContent(initialIframeHtml);\n+      assertStructure(editor, 'iframe', [ ], { sandbox: '' }, { });\n+    });\n+  });\n });"
        },
        {
          "filename": "modules/tinymce/src/plugins/media/test/ts/browser/PlaceholderTest.ts",
          "status": "modified",
          "additions": 56,
          "deletions": 22,
          "patch": "@@ -1,6 +1,6 @@\n import { ApproxStructure, StructAssert, Waiter } from '@ephox/agar';\n import { before, context, describe, it } from '@ephox/bedrock-client';\n-import { TinyAssertions, TinyHooks, TinyUiActions } from '@ephox/wrap-mcagar';\n+import { McEditor, TinyAssertions, TinyHooks, TinyUiActions } from '@ephox/wrap-mcagar';\n \n import Editor from 'tinymce/core/api/Editor';\n import Env from 'tinymce/core/api/Env';\n@@ -9,10 +9,14 @@ import Plugin from 'tinymce/plugins/media/Plugin';\n import * as Utils from '../module/test/Utils';\n \n describe('browser.tinymce.plugins.media.core.PlaceholderTest', () => {\n-  const hook = TinyHooks.bddSetupLight<Editor>({\n+  const baseSettings = {\n     plugins: [ 'media' ],\n     toolbar: 'media',\n-    extended_valid_elements: 'script[src|type]',\n+    extended_valid_elements: 'script[src|type]'\n+  };\n+\n+  const hook = TinyHooks.bddSetupLight<Editor>({\n+    ...baseSettings,\n     base_url: '/project/tinymce/js/tinymce'\n   }, [ Plugin ]);\n \n@@ -42,24 +46,6 @@ describe('browser.tinymce.plugins.media.core.PlaceholderTest', () => {\n     });\n   });\n \n-  const iframeStructure = ApproxStructure.build((s) => {\n-    return s.element('body', {\n-      children: [\n-        s.element('p', {\n-          children: [\n-            s.element('span', {\n-              children: [\n-                s.element('iframe', {}),\n-                s.element('span', {})\n-              ]\n-            })\n-          ]\n-        }),\n-        s.theRest()\n-      ]\n-    });\n-  });\n-\n   context('media_live_embeds=false', () => {\n     before(() => {\n       const editor = hook.editor();\n@@ -88,6 +74,28 @@ describe('browser.tinymce.plugins.media.core.PlaceholderTest', () => {\n   });\n \n   context('media_live_embeds=true', () => {\n+    const createIframeStructure = (sandbox: boolean) => ApproxStructure.build((s, str) => {\n+      return s.element('body', {\n+        children: [\n+          s.element('p', {\n+            children: [\n+              s.element('span', {\n+                children: [\n+                  s.element('iframe', {\n+                    attrs: {\n+                      sandbox: sandbox ? str.is('') : str.none()\n+                    }\n+                  }),\n+                  s.element('span', {})\n+                ]\n+              })\n+            ]\n+          }),\n+          s.theRest()\n+        ]\n+      });\n+    });\n+\n     before(() => {\n       const editor = hook.editor();\n       editor.options.set('media_live_embeds', true);\n@@ -97,7 +105,33 @@ describe('browser.tinymce.plugins.media.core.PlaceholderTest', () => {\n       'https://www.youtube.com/watch?v=P_205ZY52pY',\n       '<p><iframe src=\"https://www.youtube.com/embed/P_205ZY52pY\" width=\"560\" ' +\n       'height=\"314\" allowfullscreen=\"allowfullscreen\"></iframe></p>',\n-      iframeStructure\n+      createIframeStructure(false)\n     ));\n+\n+    it('TINY-10348: Live iframe embed structure when sandbox_iframes: false', async () => {\n+      const editor = await McEditor.pFromSettings<Editor>({\n+        ...baseSettings,\n+        sandbox_iframes: false\n+      });\n+      pTestPlaceholder(editor,\n+        'https://www.youtube.com/watch?v=P_205ZY52pY',\n+        '<p><iframe src=\"https://www.youtube.com/embed/P_205ZY52pY\" width=\"560\" ' +\n+        'height=\"314\" allowfullscreen=\"allowfullscreen\"></iframe></p>',\n+        createIframeStructure(false)\n+      );\n+    });\n+\n+    it('TINY-10348: Live iframe embed structure when sandbox_iframes: true', async () => {\n+      const editor = await McEditor.pFromSettings<Editor>({\n+        ...baseSettings,\n+        sandbox_iframes: true\n+      });\n+      pTestPlaceholder(editor,\n+        'https://www.youtube.com/watch?v=P_205ZY52pY',\n+        '<p><iframe src=\"https://www.youtube.com/embed/P_205ZY52pY\" width=\"560\" ' +\n+        'height=\"314\" sandbox=\"\" allowfullscreen=\"allowfullscreen\"></iframe></p>',\n+        createIframeStructure(true)\n+      );\n+    });\n   });\n });"
        },
        {
          "filename": "modules/tinymce/src/plugins/quickbars/test/ts/browser/SelectionToolbarTest.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -5,6 +5,7 @@ import { TinyHooks, TinySelections } from '@ephox/wrap-mcagar';\n \n import Editor from 'tinymce/core/api/Editor';\n import LinkPlugin from 'tinymce/plugins/link/Plugin';\n+import PageBreakPlugin from 'tinymce/plugins/pagebreak/Plugin';\n import QuickbarsPlugin from 'tinymce/plugins/quickbars/Plugin';\n \n enum Alignment {\n@@ -20,7 +21,7 @@ describe('browser.tinymce.plugins.quickbars.SelectionToolbarTest', () => {\n     toolbar: false,\n     menubar: false,\n     base_url: '/project/tinymce/js/tinymce'\n-  }, [ LinkPlugin, QuickbarsPlugin ], true);\n+  }, [ LinkPlugin, QuickbarsPlugin, PageBreakPlugin ], true);\n \n   const imgSrc = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 7,
        "unique_directories": 13,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "62ea37b237ac06e8c4b02420bebb7b057da4a793",
            "date": "2025-01-13T03:08:00Z",
            "author_login": "ltrouton"
          },
          {
            "sha": "cb9592407d83ac35719232ab9e1085e1e1cce0b6",
            "date": "2025-01-08T14:04:11Z",
            "author_login": "spocke"
          },
          {
            "sha": "5f4049f3045f4a8cf751a3dbb68a017738e119d6",
            "date": "2025-01-08T12:53:56Z",
            "author_login": "ztomaszyk"
          },
          {
            "sha": "53960fab54be85f8d1c0e0ae4f73fd444887b222",
            "date": "2025-01-07T13:24:26Z",
            "author_login": "ztomaszyk"
          },
          {
            "sha": "4341c512dd16d87c413acdc82e4b6615db48b117",
            "date": "2025-01-07T13:23:33Z",
            "author_login": "ztomaszyk"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-79",
    "description": "TinyMCE is an open source rich text editor.  A cross-site scripting (XSS) vulnerability was discovered in TinyMCE\u2019s content loading and content inserting code. A SVG image could be loaded though an `object` or `embed` element and that image could potentially contain a XSS payload. This vulnerability is fixed in 6.8.1 and 7.0.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-26T14:15:09.070",
    "last_modified": "2024-11-21T09:08:32.393",
    "fix_date": "2023-11-21T02:17:05Z"
  },
  "references": [
    {
      "url": "https://github.com/tinymce/tinymce/commit/bcdea2ad14e3c2cea40743fb48c63bba067ae6d1",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/tinymce/tinymce/security/advisories/GHSA-5359-pvf2-pw78",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.tiny.cloud/docs/tinymce/6/6.8.1-release-notes/#new-convert_unsafe_embeds-option-that-controls-whether-object-and-embed-elements-will-be-converted-to-more-restrictive-alternatives-namely-img-for-image-mime-types-video-for-video-mime-types-audio-audio-mime-types-or-iframe-for-other-or-unspecified-mime-types",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.tiny.cloud/docs/tinymce/7/7.0-release-notes/#convert_unsafe_embeds-editor-option-is-now-defaulted-to-true",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/tinymce/tinymce/commit/bcdea2ad14e3c2cea40743fb48c63bba067ae6d1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/tinymce/tinymce/security/advisories/GHSA-5359-pvf2-pw78",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.tiny.cloud/docs/tinymce/6/6.8.1-release-notes/#new-convert_unsafe_embeds-option-that-controls-whether-object-and-embed-elements-will-be-converted-to-more-restrictive-alternatives-namely-img-for-image-mime-types-video-for-video-mime-types-audio-audio-mime-types-or-iframe-for-other-or-unspecified-mime-types",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.tiny.cloud/docs/tinymce/7/7.0-release-notes/#convert_unsafe_embeds-editor-option-is-now-defaulted-to-true",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.902900",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tinymce",
    "owner": "tinymce",
    "created_at": "2010-01-11T14:46:42Z",
    "updated_at": "2025-01-14T08:55:26Z",
    "pushed_at": "2025-01-14T15:37:44Z",
    "size": 90309,
    "stars": 15220,
    "forks": 2250,
    "open_issues": 546,
    "watchers": 15220,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "3.x",
      "3.3.x",
      "3.4.x",
      "4.x",
      "4.2.x",
      "4.5.x"
    ],
    "languages": {
      "TypeScript": 13879714,
      "HTML": 370334,
      "Less": 245463,
      "JavaScript": 123034,
      "CSS": 9733,
      "Makefile": 1427
    },
    "commit_activity": {
      "total_commits_last_year": 523,
      "avg_commits_per_week": 10.057692307692308,
      "days_active_last_year": 174
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:35:07.089495"
  }
}