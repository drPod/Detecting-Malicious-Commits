{
  "cve_id": "CVE-2024-29897",
  "github_data": {
    "repository": "miraheze/mw-config",
    "fix_commit": "fb3e68bcef459e9cf2a415241b28042a6c9727e8",
    "related_commits": [
      "fb3e68bcef459e9cf2a415241b28042a6c9727e8",
      "fb3e68bcef459e9cf2a415241b28042a6c9727e8"
    ],
    "patch_url": "https://github.com/miraheze/mw-config/commit/fb3e68bcef459e9cf2a415241b28042a6c9727e8.patch",
    "fix_commit_details": {
      "sha": "fb3e68bcef459e9cf2a415241b28042a6c9727e8",
      "commit_date": "2024-03-27T14:35:08Z",
      "author": {
        "login": "redbluegreenhat",
        "type": "User",
        "stats": {
          "total_commits": 80,
          "average_weekly_commits": 0.16129032258064516,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 39
        }
      },
      "commit_message": {
        "title": "T11999: Disable Special:RequestWikiQueue outside of metawiki (#5518)",
        "length": 68,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
      },
      "files": [
        {
          "filename": "GlobalSettings.php",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -3,6 +3,7 @@\n use MediaWiki\\Auth\\LocalPasswordPrimaryAuthenticationProvider;\n use MediaWiki\\Extension\\ConfirmEdit\\Store\\CaptchaCacheStore;\n use MediaWiki\\Html\\Html;\n+use MediaWiki\\SpecialPage\\DisabledSpecialPage;\n use MediaWiki\\SpecialPage\\SpecialPage;\n use Miraheze\\MirahezeMagic\\MirahezeIRCRCFeedFormatter;\n \n@@ -26,6 +27,11 @@\n \t};\n }\n \n+// T11999: Disable Special:RequestWikiQueue outside of metawiki\n+if ( $wi->dbname !== 'metawiki' ) {\n+\t$wgSpecialPages['RequestWikiQueue'] = DisabledSpecialPage::getCallback( 'RequestWikiQueue', 'createwiki-requestwikiqueue-disabled' );\n+}\n+\n // Extensions\n if ( $wi->dbname !== 'ldapwikiwiki' && $wi->dbname !== 'srewiki' ) {\n \twfLoadExtensions( ["
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2575ddd7936bbb5769da07f4c5b2b78d38e45368",
            "date": "2025-01-14T12:13:49Z",
            "author_login": "BlankEclair"
          },
          {
            "sha": "28c1c5de6664745c13c4349c101168e7fc4a4dbb",
            "date": "2025-01-14T12:10:13Z",
            "author_login": "BlankEclair"
          },
          {
            "sha": "0f377fdfabf80c3b8a217d30085e3008678db95d",
            "date": "2025-01-14T11:28:10Z",
            "author_login": "BlankEclair"
          },
          {
            "sha": "d661ca84915077b47d17c92302ddedad46c0e604",
            "date": "2025-01-14T11:27:48Z",
            "author_login": "BlankEclair"
          },
          {
            "sha": "81471f7cc633b050be51cd2716e07e20a41e165d",
            "date": "2025-01-14T11:27:24Z",
            "author_login": "BlankEclair"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "CreateWiki is Miraheze's MediaWiki extension for requesting & creating wikis. It is possible for users with (delete) or (suppressrevision) on any wiki in the farm to access suppressed wiki requests by going to the request's entry on Special:RequestWikiQueue on the wiki where they have these rights. The same vulnerability was present briefly on the REST API before being quickly corrected in commit `6bc0685`. To our knowledge, the vulnerable commits of the REST API are not running in production anywhere. This vulnerability is fixed in 23415c17ffb4832667c06abcf1eadadefd4c8937.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-03-28T14:15:14.557",
    "last_modified": "2024-11-21T09:08:34.397",
    "fix_date": "2024-03-27T14:35:08Z"
  },
  "references": [
    {
      "url": "https://github.com/miraheze/CreateWiki/security/advisories/GHSA-4rcf-3cj2-46mq",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/miraheze/mw-config/commit/fb3e68bcef459e9cf2a415241b28042a6c9727e8",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://issue-tracker.miraheze.org/F3093343",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://issue-tracker.miraheze.org/T11999",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/miraheze/CreateWiki/security/advisories/GHSA-4rcf-3cj2-46mq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/miraheze/mw-config/commit/fb3e68bcef459e9cf2a415241b28042a6c9727e8",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://issue-tracker.miraheze.org/F3093343",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://issue-tracker.miraheze.org/T11999",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.921825",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mw-config",
    "owner": "miraheze",
    "created_at": "2015-07-22T21:33:03Z",
    "updated_at": "2025-01-14T12:13:53Z",
    "pushed_at": "2025-01-14T12:13:49Z",
    "size": 13426,
    "stars": 85,
    "forks": 248,
    "open_issues": 10,
    "watchers": 85,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 627038
    },
    "commit_activity": {
      "total_commits_last_year": 691,
      "avg_commits_per_week": 13.288461538461538,
      "days_active_last_year": 221
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:44:06.287373"
  }
}