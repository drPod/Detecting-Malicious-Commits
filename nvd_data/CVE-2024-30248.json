{
  "cve_id": "CVE-2024-30248",
  "github_data": {
    "repository": "piccolo-orm/piccolo_admin",
    "fix_commit": "c419575c2467959d906154084d305648eb2b8faf",
    "related_commits": [
      "c419575c2467959d906154084d305648eb2b8faf",
      "c419575c2467959d906154084d305648eb2b8faf"
    ],
    "patch_url": "https://github.com/piccolo-orm/piccolo_admin/commit/c419575c2467959d906154084d305648eb2b8faf.patch",
    "fix_commit_details": {
      "sha": "c419575c2467959d906154084d305648eb2b8faf",
      "commit_date": "2024-03-30T13:18:29Z",
      "author": {
        "login": "dantownsend",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-pmww-v6c9-7p83",
        "length": 212,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 12,
        "deletions": 5
      },
      "files": [
        {
          "filename": "piccolo_admin/endpoints.py",
          "status": "modified",
          "additions": 11,
          "deletions": 4,
          "patch": "@@ -30,6 +30,7 @@\n from piccolo_api.crud.endpoints import OrderBy, PiccoloCRUD\n from piccolo_api.crud.hooks import Hook\n from piccolo_api.crud.validators import Validators\n+from piccolo_api.csp.middleware import CSPMiddleware, CSPConfig\n from piccolo_api.csrf.middleware import CSRFMiddleware\n from piccolo_api.fastapi.endpoints import FastAPIKwargs, FastAPIWrapper\n from piccolo_api.media.base import MediaStorage\n@@ -667,11 +668,17 @@ def __init__(\n                     media_storage,\n                 ) in table_config.media_columns.items():\n                     if isinstance(media_storage, LocalMediaStorage):\n+                        # We apply a restrictive CSP here to mitigate SVG\n+                        # files being used maliciously when viewed by admins\n                         private_app.mount(\n-                            path=f\"/media-files/{column._meta.table._meta.tablename}/{column._meta.name}/\",  # noqa: E501\n-                            app=StaticFiles(\n-                                directory=media_storage.media_path\n-                            ),\n+                            path=f\"/media-files/{column._meta.table._meta.tablename}/{column._meta.name}/\",\n+                            # noqa: E501\n+                            app=CSPMiddleware(\n+                                StaticFiles(\n+                                    directory=media_storage.media_path\n+                                ),\n+                                config=CSPConfig(default_src=\"none\")\n+                            )\n                         )\n \n         #######################################################################"
        },
        {
          "filename": "requirements/requirements.txt",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,5 +1,5 @@\n piccolo>=1.5.0\n-piccolo_api>=1.1.0\n+piccolo_api>=1.3.1\n uvicorn\n aiofiles>=0.5.0\n Hypercorn"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2f923aa482a27135e25577083dc1eae425a011db",
            "date": "2024-11-15T06:29:34Z",
            "author_login": "sinisaos"
          },
          {
            "sha": "9e6dbb6a0b5d4e0a603f80113eb08f44a1b00499",
            "date": "2024-10-16T22:04:06Z",
            "author_login": "dantownsend"
          },
          {
            "sha": "fdc55cc7c658c97de6cd7191a9184f907565ab00",
            "date": "2024-10-16T21:52:27Z",
            "author_login": "sinisaos"
          },
          {
            "sha": "d8682b64881fbdbc85243514c3a8540f91a90faa",
            "date": "2024-10-04T21:00:45Z",
            "author_login": "dantownsend"
          },
          {
            "sha": "4c48431f5ecd2a6cf7c46b68a3cb4042ae7ecfca",
            "date": "2024-10-04T20:58:21Z",
            "author_login": "dantownsend"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Piccolo Admin is an admin interface/content management system for Python, built on top of Piccolo. Piccolo's admin panel allows media files to be uploaded. As a default, SVG is an allowed file type for upload. An attacker can upload an SVG which when loaded can allow arbitrary access to the admin page. This vulnerability was patched in version 1.3.2.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-04-02T15:15:53.293",
    "last_modified": "2024-11-21T09:11:32.200",
    "fix_date": "2024-03-30T13:18:29Z"
  },
  "references": [
    {
      "url": "https://github.com/piccolo-orm/piccolo_admin/commit/c419575c2467959d906154084d305648eb2b8faf",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/piccolo-orm/piccolo_admin/security/advisories/GHSA-pmww-v6c9-7p83",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/piccolo-orm/piccolo_admin/commit/c419575c2467959d906154084d305648eb2b8faf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/piccolo-orm/piccolo_admin/security/advisories/GHSA-pmww-v6c9-7p83",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.944004",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "piccolo_admin",
    "owner": "piccolo-orm",
    "created_at": "2019-06-25T19:24:31Z",
    "updated_at": "2025-01-14T03:38:14Z",
    "pushed_at": "2025-01-14T13:08:18Z",
    "size": 9625,
    "stars": 328,
    "forks": 39,
    "open_issues": 48,
    "watchers": 328,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Python": 213396,
      "Vue": 200758,
      "TypeScript": 33650,
      "Less": 5785,
      "Shell": 1086,
      "JavaScript": 936,
      "HTML": 467
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:57:33.969982"
  }
}