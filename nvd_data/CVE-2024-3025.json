{
  "cve_id": "CVE-2024-3025",
  "github_data": {
    "repository": "mintplex-labs/anything-llm",
    "fix_commit": "7de23dbb2da932fbfb39f56d981784d3702cf5ce",
    "related_commits": [
      "7de23dbb2da932fbfb39f56d981784d3702cf5ce",
      "7de23dbb2da932fbfb39f56d981784d3702cf5ce"
    ],
    "patch_url": "https://github.com/mintplex-labs/anything-llm/commit/7de23dbb2da932fbfb39f56d981784d3702cf5ce.patch",
    "fix_commit_details": {
      "sha": "7de23dbb2da932fbfb39f56d981784d3702cf5ce",
      "commit_date": "2024-03-26T22:25:46Z",
      "author": {
        "login": "timothycarambat",
        "type": "User",
        "stats": {
          "total_commits": 911,
          "average_weekly_commits": 10.593023255813954,
          "total_additions": 194013,
          "total_deletions": 85618,
          "weeks_active": 81
        }
      },
      "commit_message": {
        "title": "norm path logo",
        "length": 14,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 15,
        "additions": 8,
        "deletions": 7
      },
      "files": [
        {
          "filename": "server/utils/files/logo.js",
          "status": "modified",
          "additions": 8,
          "deletions": 7,
          "patch": "@@ -3,6 +3,7 @@ const fs = require(\"fs\");\n const { getType } = require(\"mime\");\n const { v4 } = require(\"uuid\");\n const { SystemSettings } = require(\"../../models/systemSettings\");\n+const { normalizePath } = require(\".\");\n const LOGO_FILENAME = \"anything-llm.png\";\n \n function validFilename(newFilename = \"\") {\n@@ -21,7 +22,7 @@ async function determineLogoFilepath(defaultFilename = LOGO_FILENAME) {\n   const defaultFilepath = path.join(basePath, defaultFilename);\n \n   if (currentLogoFilename && validFilename(currentLogoFilename)) {\n-    customLogoPath = path.join(basePath, currentLogoFilename);\n+    customLogoPath = path.join(basePath, normalizePath(currentLogoFilename));\n     return fs.existsSync(customLogoPath) ? customLogoPath : defaultFilepath;\n   }\n \n@@ -52,11 +53,11 @@ async function renameLogoFile(originalFilename = null) {\n   const extname = path.extname(originalFilename) || \".png\";\n   const newFilename = `${v4()}${extname}`;\n   const originalFilepath = process.env.STORAGE_DIR\n-    ? path.join(process.env.STORAGE_DIR, \"assets\", originalFilename)\n-    : path.join(__dirname, `../../storage/assets/${originalFilename}`);\n+    ? path.join(process.env.STORAGE_DIR, \"assets\", normalizePath(originalFilename))\n+    : path.join(__dirname, `../../storage/assets`, normalizePath(originalFilename));\n   const outputFilepath = process.env.STORAGE_DIR\n-    ? path.join(process.env.STORAGE_DIR, \"assets\", newFilename)\n-    : path.join(__dirname, `../../storage/assets/${newFilename}`);\n+    ? path.join(process.env.STORAGE_DIR, \"assets\", normalizePath(newFilename))\n+    : path.join(__dirname, `../../storage/assets`, normalizePath(newFilename));\n \n   fs.renameSync(originalFilepath, outputFilepath);\n   return newFilename;\n@@ -65,8 +66,8 @@ async function renameLogoFile(originalFilename = null) {\n async function removeCustomLogo(logoFilename = LOGO_FILENAME) {\n   if (!logoFilename || !validFilename(logoFilename)) return false;\n   const logoPath = process.env.STORAGE_DIR\n-    ? path.join(process.env.STORAGE_DIR, `assets/${logoFilename}`)\n-    : path.join(__dirname, `../../storage/assets/${logoFilename}`);\n+    ? path.join(process.env.STORAGE_DIR, `assets`, normalizePath(logoFilename))\n+    : path.join(__dirname, `../../storage/assets`, normalizePath(logoFilename));\n   if (fs.existsSync(logoPath)) fs.unlinkSync(logoPath);\n   return true;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "21af81085aeb049750942ac5f3b84775cb461693",
            "date": "2025-01-13T21:12:03Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "665e8e5bfe431ad93bed6736d0b450592617d042",
            "date": "2025-01-09T23:39:56Z",
            "author_login": "shatfield4"
          },
          {
            "sha": "865f7eea296e544b2eb1ab8c1f322208eaf5eb05",
            "date": "2025-01-09T21:32:54Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "be886f7d61296a30d5b8a095ca8329f58a0c5a0a",
            "date": "2025-01-09T01:21:30Z",
            "author_login": "root-reindeer-flotilla"
          },
          {
            "sha": "487db896c1ce1442e02f7098ad6974ee60b76073",
            "date": "2025-01-07T23:53:34Z",
            "author_login": "timothycarambat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-23",
    "description": "mintplex-labs/anything-llm is vulnerable to path traversal attacks due to insufficient validation of user-supplied input in the logo filename functionality. Attackers can exploit this vulnerability by manipulating the logo filename to reference files outside of the restricted directory. This can lead to unauthorized reading or deletion of files by utilizing the `/api/system/upload-logo` and `/api/system/logo` endpoints. The issue stems from the lack of filtering or validation on the logo filename, allowing attackers to target sensitive files such as the application's database.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-04-10T17:15:55.993",
    "last_modified": "2024-11-21T09:28:42.597",
    "fix_date": "2024-03-26T22:25:46Z"
  },
  "references": [
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/7de23dbb2da932fbfb39f56d981784d3702cf5ce",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/fb09a352-1016-4481-ae88-7460e2b6062b",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/7de23dbb2da932fbfb39f56d981784d3702cf5ce",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/fb09a352-1016-4481-ae88-7460e2b6062b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.466450",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "anything-llm",
    "owner": "mintplex-labs",
    "created_at": "2023-06-04T02:29:14Z",
    "updated_at": "2025-01-14T13:49:57Z",
    "pushed_at": "2025-01-13T21:12:06Z",
    "size": 42916,
    "stars": 30237,
    "forks": 3030,
    "open_issues": 206,
    "watchers": 30237,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3056909,
      "CSS": 73785,
      "Dockerfile": 9030,
      "HTML": 3904,
      "Shell": 1382,
      "HCL": 1211
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:04:33.088245"
  }
}