{
  "cve_id": "CVE-2024-30266",
  "github_data": {
    "repository": "bytecodealliance/wasmtime",
    "fix_commit": "7f57d0bb0948fa56cc950278d0db230ed10e8664",
    "related_commits": [
      "7f57d0bb0948fa56cc950278d0db230ed10e8664",
      "7f57d0bb0948fa56cc950278d0db230ed10e8664"
    ],
    "patch_url": "https://github.com/bytecodealliance/wasmtime/commit/7f57d0bb0948fa56cc950278d0db230ed10e8664.patch",
    "fix_commit_details": {
      "sha": "7f57d0bb0948fa56cc950278d0db230ed10e8664",
      "commit_date": "2024-04-02T15:56:49Z",
      "author": {
        "login": "alexcrichton",
        "type": "User",
        "stats": {
          "total_commits": 2089,
          "average_weekly_commits": 4.55119825708061,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 258
        }
      },
      "commit_message": {
        "title": "Fix a panic using tables with the wrong type (#8283)",
        "length": 1073,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 46,
        "additions": 45,
        "deletions": 1
      },
      "files": [
        {
          "filename": "crates/runtime/src/instance.rs",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -801,7 +801,12 @@ impl Instance {\n         // disconnected from the lifetime of `self`.\n         let module = self.module().clone();\n \n-        let empty = TableSegmentElements::Functions(Box::new([]));\n+        // NB: fall back to an expressions-based list of elements which doesn't\n+        // have static type information (as opposed to `Functions`) since we\n+        // don't know just yet what type the table has. The type will be be\n+        // inferred in the next step within `table_init_segment`.\n+        let empty = TableSegmentElements::Expressions(Box::new([]));\n+\n         let elements = match module.passive_elements_map.get(&elem_index) {\n             Some(index) if !self.dropped_elements.contains(elem_index) => {\n                 &module.passive_elements[*index]"
        },
        {
          "filename": "tests/misc_testsuite/externref-table-dropped-segment-issue-8281.wast",
          "status": "added",
          "additions": 39,
          "deletions": 0,
          "patch": "@@ -0,0 +1,39 @@\n+(module\n+  (table $t 0 0 externref)\n+\n+  (func (export \"f1\")\n+    (i32.const 0)\n+    (i32.const 0)\n+    (i32.const 0)\n+    (table.init $t $declared)\n+  )\n+\n+  (func (export \"f2\")\n+    (i32.const 0)\n+    (i32.const 0)\n+    (i32.const 0)\n+    (table.init $t $passive)\n+\n+    (elem.drop $passive)\n+\n+    (i32.const 0)\n+    (i32.const 0)\n+    (i32.const 0)\n+    (table.init $t $passive)\n+  )\n+\n+  (func (export \"f3\")\n+    (i32.const 0)\n+    (i32.const 0)\n+    (i32.const 0)\n+    (table.init $t $active)\n+  )\n+\n+  (elem $declared declare externref)\n+  (elem $passive externref)\n+  (elem $active (i32.const 0) externref)\n+)\n+\n+(assert_return (invoke \"f1\"))\n+(assert_return (invoke \"f2\"))\n+(assert_return (invoke \"f3\"))"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "21ab8ea016cf6a2c25527f644773a7d25e845d8e",
            "date": "2025-01-14T21:03:54Z",
            "author_login": "alexcrichton"
          },
          {
            "sha": "1c521e177ead5ae04cc0c942ee55d0442130b79d",
            "date": "2025-01-14T21:01:45Z",
            "author_login": "SingleAccretion"
          },
          {
            "sha": "be40551f98266fd427796efc37c0f0db96ccbff5",
            "date": "2025-01-14T19:17:16Z",
            "author_login": "alexcrichton"
          },
          {
            "sha": "a88eb702a4847d6ed2e09fa1ef1f86e38f49ca5e",
            "date": "2025-01-14T18:28:51Z",
            "author_login": "fitzgen"
          },
          {
            "sha": "8ed4470fc4aa70fe70502af0548fd7e5d6a529bc",
            "date": "2025-01-14T18:10:31Z",
            "author_login": "fitzgen"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.3,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-843",
    "description": "wasmtime is a runtime for WebAssembly. The 19.0.0 release of Wasmtime contains a regression introduced during its development which can lead to a guest WebAssembly module causing a panic in the host runtime. A valid WebAssembly module, when executed at runtime, may cause this panic. This vulnerability has been patched in version 19.0.1.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-04T16:15:09.107",
    "last_modified": "2024-11-21T09:11:35.233",
    "fix_date": "2024-04-02T15:56:49Z"
  },
  "references": [
    {
      "url": "https://github.com/bytecodealliance/wasmtime/commit/7f57d0bb0948fa56cc950278d0db230ed10e8664",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/issues/8281",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/pull/8018",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/pull/8283",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-75hq-h6g9-h4q5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/commit/7f57d0bb0948fa56cc950278d0db230ed10e8664",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/issues/8281",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/pull/8018",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/pull/8283",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-75hq-h6g9-h4q5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.426323",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wasmtime",
    "owner": "bytecodealliance",
    "created_at": "2017-08-29T14:01:55Z",
    "updated_at": "2025-01-14T09:40:55Z",
    "pushed_at": "2025-01-14T01:52:50Z",
    "size": 111616,
    "stars": 15702,
    "forks": 1345,
    "open_issues": 787,
    "watchers": 15702,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "release-0.32.0",
      "release-0.33.0",
      "release-0.34.0",
      "release-0.35.0",
      "release-0.36.0",
      "release-0.37.0",
      "release-0.38.0",
      "release-0.39.0",
      "release-0.40.0",
      "release-1.0.0",
      "release-2.0.0",
      "release-3.0.0",
      "release-4.0.0",
      "release-5.0.0",
      "release-6.0.0",
      "release-7.0.0",
      "release-8.0.0",
      "release-9.0.0"
    ],
    "languages": {
      "Rust": 19224087,
      "WebAssembly": 6773216,
      "Common Lisp": 1793054,
      "C": 257019,
      "JavaScript": 24116,
      "Shell": 23820,
      "C++": 21050,
      "CMake": 7205,
      "OCaml": 6903,
      "Assembly": 4165,
      "Dockerfile": 2564,
      "Makefile": 1432,
      "CSS": 303
    },
    "commit_activity": {
      "total_commits_last_year": 1586,
      "avg_commits_per_week": 30.5,
      "days_active_last_year": 278
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:32:42.127815"
  }
}