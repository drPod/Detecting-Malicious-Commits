{
  "cve_id": "CVE-2024-3102",
  "github_data": {
    "repository": "mintplex-labs/anything-llm",
    "fix_commit": "2374939ffb551ab2929d7f9d5827fe6597fa8caa",
    "related_commits": [
      "2374939ffb551ab2929d7f9d5827fe6597fa8caa",
      "2374939ffb551ab2929d7f9d5827fe6597fa8caa"
    ],
    "patch_url": "https://github.com/mintplex-labs/anything-llm/commit/2374939ffb551ab2929d7f9d5827fe6597fa8caa.patch",
    "fix_commit_details": {
      "sha": "2374939ffb551ab2929d7f9d5827fe6597fa8caa",
      "commit_date": "2024-03-29T18:47:30Z",
      "author": {
        "login": "timothycarambat",
        "type": "User",
        "stats": {
          "total_commits": 911,
          "average_weekly_commits": 10.593023255813954,
          "total_additions": 194013,
          "total_deletions": 85618,
          "weeks_active": 81
        }
      },
      "commit_message": {
        "title": "security: patch primsa expansion on token request",
        "length": 49,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
      },
      "files": [
        {
          "filename": "server/endpoints/system.js",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -105,7 +105,7 @@ function systemEndpoints(app) {\n \n       if (await SystemSettings.isMultiUserMode()) {\n         const { username, password } = reqBody(request);\n-        const existingUser = await User.get({ username });\n+        const existingUser = await User.get({ username: String(username) });\n \n         if (!existingUser) {\n           await EventLogs.logEvent(\n@@ -125,7 +125,7 @@ function systemEndpoints(app) {\n           return;\n         }\n \n-        if (!bcrypt.compareSync(password, existingUser.password)) {\n+        if (!bcrypt.compareSync(String(password), existingUser.password)) {\n           await EventLogs.logEvent(\n             \"failed_login_invalid_password\",\n             {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "21af81085aeb049750942ac5f3b84775cb461693",
            "date": "2025-01-13T21:12:03Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "665e8e5bfe431ad93bed6736d0b450592617d042",
            "date": "2025-01-09T23:39:56Z",
            "author_login": "shatfield4"
          },
          {
            "sha": "865f7eea296e544b2eb1ab8c1f322208eaf5eb05",
            "date": "2025-01-09T21:32:54Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "be886f7d61296a30d5b8a095ca8329f58a0c5a0a",
            "date": "2025-01-09T01:21:30Z",
            "author_login": "root-reindeer-flotilla"
          },
          {
            "sha": "487db896c1ce1442e02f7098ad6974ee60b76073",
            "date": "2025-01-07T23:53:34Z",
            "author_login": "timothycarambat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-307",
    "description": "A JSON Injection vulnerability exists in the `mintplex-labs/anything-llm` application, specifically within the username parameter during the login process at the `/api/request-token` endpoint. The vulnerability arises from improper handling of values, allowing attackers to perform brute force attacks without prior knowledge of the username. Once the password is known, attackers can conduct blind attacks to ascertain the full username, significantly compromising system security.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-06T19:15:59.667",
    "last_modified": "2024-11-21T09:28:54.413",
    "fix_date": "2024-03-29T18:47:30Z"
  },
  "references": [
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/2374939ffb551ab2929d7f9d5827fe6597fa8caa",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/8af4650d-5955-44a4-86b4-d08e1c862b49",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/2374939ffb551ab2929d7f9d5827fe6597fa8caa",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/8af4650d-5955-44a4-86b4-d08e1c862b49",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.348906",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "anything-llm",
    "owner": "mintplex-labs",
    "created_at": "2023-06-04T02:29:14Z",
    "updated_at": "2025-01-14T13:49:57Z",
    "pushed_at": "2025-01-13T21:12:06Z",
    "size": 42916,
    "stars": 30237,
    "forks": 3030,
    "open_issues": 206,
    "watchers": 30237,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3056909,
      "CSS": 73785,
      "Dockerfile": 9030,
      "HTML": 3904,
      "Shell": 1382,
      "HCL": 1211
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:04:33.088245"
  }
}