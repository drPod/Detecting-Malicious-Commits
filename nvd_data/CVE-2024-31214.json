{
  "cve_id": "CVE-2024-31214",
  "github_data": {
    "repository": "traccar/traccar",
    "fix_commit": "3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
    "related_commits": [
      "3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
      "3fbdcd81566bc72e319ec05c77cf8a4120b87b8f"
    ],
    "patch_url": "https://github.com/traccar/traccar/commit/3fbdcd81566bc72e319ec05c77cf8a4120b87b8f.patch",
    "fix_commit_details": {
      "sha": "3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
      "commit_date": "2024-04-04T14:41:50Z",
      "author": {
        "login": "tananaev",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update device id check",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/main/java/org/traccar/model/Device.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -53,7 +53,7 @@ public String getUniqueId() {\n     }\n \n     public void setUniqueId(String uniqueId) {\n-        if (uniqueId.contains(\"../\") || uniqueId.contains(\"..\\\\\")) {\n+        if (uniqueId.contains(\"..\")) {\n             throw new IllegalArgumentException(\"Invalid unique id\");\n         }\n         this.uniqueId = uniqueId.trim();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aadf4612d5193479f079fd5c3a2d75b63453cff7",
            "date": "2025-01-14T14:21:28Z",
            "author_login": "tananaev"
          },
          {
            "sha": "5b41bb88d841241b990970e920f3278d518cb75e",
            "date": "2025-01-14T11:41:03Z",
            "author_login": "adsmith144"
          },
          {
            "sha": "2e958b42f8e5ee9f15fb3785b3d089d31b3b6241",
            "date": "2025-01-14T11:38:30Z",
            "author_login": "adsmith144"
          },
          {
            "sha": "5cc84b028908a0c5ef16a63461100eb1e212a5ea",
            "date": "2025-01-14T11:07:47Z",
            "author_login": "adsmith144"
          },
          {
            "sha": "409604f507c4507ce0d3fc8a8e7fb64290da498e",
            "date": "2025-01-14T11:07:00Z",
            "author_login": "adsmith144"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-434",
    "description": "Traccar is an open source GPS tracking system. Traccar versions 5.1 through 5.12 allow arbitrary files to be uploaded through the device image upload API. Attackers have full control over the file contents, full control over the directory where the file is stored, full control over the file extension, and partial control over the file name. While it's not  for an attacker to overwrite an existing file, an attacker can create new files with certain names and attacker-controlled extensions anywhere on the file system. This can potentially lead to remote code execution, XSS, DOS, etc. The default install of Traccar makes this vulnerability more severe. Self-registration is enabled by default, allowing anyone to create an account to exploit this vulnerability. Traccar also runs by default with root/system privileges, allowing files to be placed anywhere on the file system. Version 6.0 contains a fix for the issue. One may also turn off self-registration by default, as that would make most vulnerabilities in the application much harder to exploit by default and reduce the severity considerably.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-10T18:15:07.350",
    "last_modified": "2025-01-09T16:14:43.407",
    "fix_date": "2024-04-04T14:41:50Z"
  },
  "references": [
    {
      "url": "https://github.com/traccar/traccar/blob/master/src/main/java/org/traccar/model/Device.java#L56",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/blob/v5.12/src/main/java/org/traccar/api/resource/DeviceResource.java#L191",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/commit/3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/security/advisories/GHSA-3gxq-f2qj-c8v9",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/blob/master/src/main/java/org/traccar/model/Device.java#L56",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/blob/v5.12/src/main/java/org/traccar/api/resource/DeviceResource.java#L191",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/commit/3fbdcd81566bc72e319ec05c77cf8a4120b87b8f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/traccar/traccar/security/advisories/GHSA-3gxq-f2qj-c8v9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.467406",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "traccar",
    "owner": "traccar",
    "created_at": "2012-04-16T08:33:49Z",
    "updated_at": "2025-01-14T14:21:36Z",
    "pushed_at": "2025-01-14T14:21:28Z",
    "size": 23332,
    "stars": 5488,
    "forks": 2644,
    "open_issues": 437,
    "watchers": 5488,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 5075463,
      "Python": 44005,
      "Shell": 16305,
      "Inno Setup": 516
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:41:27.090438"
  }
}