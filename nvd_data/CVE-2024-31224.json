{
  "cve_id": "CVE-2024-31224",
  "github_data": {
    "repository": "binary-husky/gpt_academic",
    "fix_commit": "8af6c0cab6d96f5c4520bec85b24802e6e823f35",
    "related_commits": [
      "8af6c0cab6d96f5c4520bec85b24802e6e823f35",
      "8af6c0cab6d96f5c4520bec85b24802e6e823f35"
    ],
    "patch_url": "https://github.com/binary-husky/gpt_academic/commit/8af6c0cab6d96f5c4520bec85b24802e6e823f35.patch",
    "fix_commit_details": {
      "sha": "8af6c0cab6d96f5c4520bec85b24802e6e823f35",
      "commit_date": "2024-03-25T01:54:30Z",
      "author": {
        "login": "Qhaoduoyu",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Qhaoduoyu patch 1: pickle to json to increase security (#1648)",
        "length": 217,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 17,
        "additions": 10,
        "deletions": 7
      },
      "files": [
        {
          "filename": "themes/theme.py",
          "status": "modified",
          "additions": 10,
          "deletions": 7,
          "patch": "@@ -1,7 +1,10 @@\n import pickle\n import base64\n import uuid\n+import json\n from toolbox import get_conf\n+import json\n+\n \n \"\"\"\n -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n@@ -45,24 +48,24 @@ def load_dynamic_theme(THEME):\n cookie\u76f8\u5173\u5de5\u5177\u51fd\u6570\n -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n \"\"\"\n-\n def init_cookie(cookies):\n     # \u4e3a\u6bcf\u4e00\u4f4d\u8bbf\u95ee\u7684\u7528\u6237\u8d4b\u4e88\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684uuid\u7f16\u7801\n     cookies.update({\"uuid\": uuid.uuid4()})\n     return cookies\n \n \n def to_cookie_str(d):\n-    # Pickle the dictionary and encode it as a string\n-    pickled_dict = pickle.dumps(d)\n-    cookie_value = base64.b64encode(pickled_dict).decode(\"utf-8\")\n+    # serialize the dictionary and encode it as a string\n+    serialized_dict = json.dumps(d)\n+    cookie_value = base64.b64encode(serialized_dict.encode('utf8')).decode(\"utf-8\")\n     return cookie_value\n \n \n def from_cookie_str(c):\n-    # Decode the base64-encoded string and unpickle it into a dictionary\n-    pickled_dict = base64.b64decode(c.encode(\"utf-8\"))\n-    return pickle.loads(pickled_dict)\n+    # Decode the base64-encoded string and unserialize it into a dictionary\n+    serialized_dict = base64.b64decode(c.encode(\"utf-8\"))\n+    serialized_dict.decode(\"utf-8\")\n+    return json.loads(serialized_dict)\n \n \n \"\"\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "286f7303be0d81a075a82f7ad0dc501e90633b4b",
            "date": "2025-01-12T13:54:43Z",
            "author_login": "binary-husky"
          },
          {
            "sha": "7eeab9e3762374e65a5a435f80881f8d4c380354",
            "date": "2025-01-09T14:31:59Z",
            "author_login": "binary-husky"
          },
          {
            "sha": "4ca331fb280c207c645f1f0a59868f28671352ec",
            "date": "2025-01-05T13:20:12Z",
            "author_login": "binary-husky"
          },
          {
            "sha": "9487829930102b8f53e2eb7ad578fe9e258689f4",
            "date": "2025-01-02T16:34:36Z",
            "author_login": "binary-husky"
          },
          {
            "sha": "a73074b89e529adcc6aa18189574bc1ecef666eb",
            "date": "2025-01-02T16:31:03Z",
            "author_login": "binary-husky"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-502",
    "description": "GPT Academic provides interactive interfaces for large language models. A vulnerability was found in gpt_academic versions 3.64 through 3.73. The server deserializes untrustworthy data from the client, which may risk remote code execution. Any device that exposes the GPT Academic service to the Internet is vulnerable. Version 3.74 contains a patch for the issue. There are no known workarounds aside from upgrading to a patched version.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-08T16:15:07.790",
    "last_modified": "2024-11-21T09:13:04.583",
    "fix_date": "2024-03-25T01:54:30Z"
  },
  "references": [
    {
      "url": "https://github.com/binary-husky/gpt_academic/commit/8af6c0cab6d96f5c4520bec85b24802e6e823f35",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/binary-husky/gpt_academic/pull/1648",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/binary-husky/gpt_academic/security/advisories/GHSA-jcjc-89wr-vv7g",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/binary-husky/gpt_academic/commit/8af6c0cab6d96f5c4520bec85b24802e6e823f35",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/binary-husky/gpt_academic/pull/1648",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/binary-husky/gpt_academic/security/advisories/GHSA-jcjc-89wr-vv7g",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.448876",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gpt_academic",
    "owner": "binary-husky",
    "created_at": "2023-03-20T09:05:13Z",
    "updated_at": "2025-01-14T15:40:44Z",
    "pushed_at": "2025-01-12T13:54:52Z",
    "size": 71445,
    "stars": 66881,
    "forks": 8210,
    "open_issues": 411,
    "watchers": 66881,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 1626585,
      "JavaScript": 310028,
      "HTML": 113296,
      "CSS": 76559,
      "Dockerfile": 1647
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:53:54.044497"
  }
}