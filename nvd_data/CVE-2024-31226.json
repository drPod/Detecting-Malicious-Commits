{
  "cve_id": "CVE-2024-31226",
  "github_data": {
    "repository": "LizardByte/Sunshine",
    "fix_commit": "93e622342c4f3e9b34f5f265039b6775b8e33a7a",
    "related_commits": [
      "93e622342c4f3e9b34f5f265039b6775b8e33a7a",
      "93e622342c4f3e9b34f5f265039b6775b8e33a7a"
    ],
    "patch_url": "https://github.com/LizardByte/Sunshine/commit/93e622342c4f3e9b34f5f265039b6775b8e33a7a.patch",
    "fix_commit_details": {
      "sha": "93e622342c4f3e9b34f5f265039b6775b8e33a7a",
      "commit_date": "2024-04-06T23:21:03Z",
      "author": {
        "login": "cgutman",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Quote the path to sunshinesvc.exe when launching the termination helper (#2379)",
        "length": 79,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
      },
      "files": [
        {
          "filename": "tools/sunshinesvc.cpp",
          "status": "modified",
          "additions": 5,
          "deletions": 2,
          "patch": "@@ -145,8 +145,11 @@ bool\n RunTerminationHelper(HANDLE console_token, DWORD pid) {\n   WCHAR module_path[MAX_PATH];\n   GetModuleFileNameW(NULL, module_path, _countof(module_path));\n-  std::wstring command { module_path };\n+  std::wstring command;\n \n+  command += L'\"';\n+  command += module_path;\n+  command += L'\"';\n   command += L\" --terminate \" + std::to_wstring(pid);\n \n   STARTUPINFOW startup_info = {};\n@@ -157,7 +160,7 @@ RunTerminationHelper(HANDLE console_token, DWORD pid) {\n   // This will allow us to attach to Sunshine's console and send it a Ctrl-C event.\n   PROCESS_INFORMATION process_info;\n   if (!CreateProcessAsUserW(console_token,\n-        NULL,\n+        module_path,\n         (LPWSTR) command.c_str(),\n         NULL,\n         NULL,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "820180c9e771980aa58789de0fdcdace97500db7",
            "date": "2025-01-14T03:34:54Z",
            "author_login": "ReenigneArcher"
          },
          {
            "sha": "a7f64118a89ca40cba93be72ec276c9c30fbcb88",
            "date": "2025-01-14T01:54:13Z",
            "author_login": "LizardByte-bot"
          },
          {
            "sha": "1f2b541df63155e11b55d7956bd707e3d88f1adf",
            "date": "2025-01-13T13:32:13Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "8392bdc98fed99f74fe96e542cfce77819e2ae8f",
            "date": "2025-01-12T23:11:03Z",
            "author_login": "cgutman"
          },
          {
            "sha": "c369e8e5b607de97e5f8f1d91abdd6bb6817a1a1",
            "date": "2025-01-12T22:05:18Z",
            "author_login": "cgutman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:P/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:H",
    "cwe_id": "CWE-428",
    "description": "Sunshine is a self-hosted game stream host for Moonlight. Users who ran Sunshine versions 0.17.0 through 0.22.2 as a service on Windows may be impacted when terminating the service if an attacked placed a file named `C:\\Program.exe`, `C:\\Program.bat`, or `C:\\Program.cmd` on the user's computer. This attack vector isn't exploitable unless the user has manually loosened ACLs on the system drive. If the user's system locale is not English, then the name of the executable will likely vary. Version 0.23.0 contains a patch for the issue. Some workarounds are available. One may identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate. Alternatively, ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory `C:`. Require that all executables be placed in write-protected directories.",
    "attack_vector": "PHYSICAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-05-16T19:15:49.560",
    "last_modified": "2024-11-21T09:13:04.833",
    "fix_date": "2024-04-06T23:21:03Z"
  },
  "references": [
    {
      "url": "https://github.com/LizardByte/Sunshine/commit/93e622342c4f3e9b34f5f265039b6775b8e33a7a",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/LizardByte/Sunshine/pull/2379",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/LizardByte/Sunshine/security/advisories/GHSA-r3rw-mx4q-7vfp",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/LizardByte/Sunshine/commit/93e622342c4f3e9b34f5f265039b6775b8e33a7a",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/LizardByte/Sunshine/pull/2379",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/LizardByte/Sunshine/security/advisories/GHSA-r3rw-mx4q-7vfp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:24.248454",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Sunshine",
    "owner": "LizardByte",
    "created_at": "2021-12-15T23:38:57Z",
    "updated_at": "2025-01-14T16:06:17Z",
    "pushed_at": "2025-01-14T13:27:27Z",
    "size": 52991,
    "stars": 21668,
    "forks": 1033,
    "open_issues": 94,
    "watchers": 21668,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "gh-pages",
      "master"
    ],
    "languages": {
      "C++": 1684025,
      "HTML": 91434,
      "CMake": 80120,
      "Vue": 69957,
      "Shell": 31664,
      "Objective-C++": 29814,
      "HLSL": 12658,
      "Dockerfile": 12604,
      "Objective-C": 12537,
      "JavaScript": 10501,
      "Cuda": 10498,
      "C": 6719,
      "Batchfile": 6179,
      "Python": 6005,
      "Ruby": 4639,
      "GLSL": 2375,
      "Rust": 1770,
      "CSS": 375
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T17:00:48.606574"
  }
}