{
  "cve_id": "CVE-2024-32034",
  "github_data": {
    "repository": "decidim/decidim",
    "fix_commit": "23fc8d702a4976727f78617f5e42353d67931645",
    "related_commits": [
      "23fc8d702a4976727f78617f5e42353d67931645",
      "9d79f09a2d38c87feb28725670d6cc1f55c22072",
      "e494235d559be13dd1f8694345e6f6bba762d1c0",
      "ff755e23814aeb56e9089fc08006a5d3faee47b6"
    ],
    "patch_url": "https://github.com/decidim/decidim/commit/23fc8d702a4976727f78617f5e42353d67931645.patch",
    "fix_commit_details": {
      "sha": "23fc8d702a4976727f78617f5e42353d67931645",
      "commit_date": "2024-07-08T10:13:31Z",
      "author": {
        "login": "alecslupu",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Backport 'Refactor malformed titles in admin logs (part 2)' to v0.28 (#13083)",
        "length": 619,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 332,
        "additions": 214,
        "deletions": 118
      },
      "files": [
        {
          "filename": "decidim-admin/lib/decidim/admin/test/manage_attachment_collections_examples.rb",
          "status": "modified",
          "additions": 12,
          "deletions": 11,
          "patch": "@@ -2,6 +2,7 @@\n \n shared_examples \"manage attachment collections examples\" do\n   let!(:attachment_collection) { create(:attachment_collection, collection_for:) }\n+  let(:attributes) { attributes_for(:attachment_collection) }\n \n   before do\n     visit current_path\n@@ -30,17 +31,13 @@\n       fill_in_i18n(\n         :attachment_collection_name,\n         \"#attachment_collection-name-tabs\",\n-        en: \"Application forms\",\n-        es: \"Formularios de solicitud\",\n-        ca: \"Formularis de sol\u00b7licitud\"\n+        **attributes[:name].except(\"machine_translations\")\n       )\n \n       fill_in_i18n(\n         :attachment_collection_description,\n         \"#attachment_collection-description-tabs\",\n-        en: \"Contains the application forms\",\n-        es: \"Contiene los formularios de solicitud\",\n-        ca: \"Cont\u00e9 els formularis de sol\u00b7licitud\"\n+        **attributes[:description].except(\"machine_translations\")\n       )\n \n       find(\"*[type=submit]\").click\n@@ -49,8 +46,11 @@\n     expect(page).to have_admin_callout(\"successfully\")\n \n     within \"#attachment_collections table\" do\n-      expect(page).to have_text(\"Application forms\")\n+      expect(page).to have_content(translated(attributes[:name]))\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"created the #{translated(attributes[:name])} attachment collection\")\n   end\n \n   it \"can update an attachment collection\" do\n@@ -64,9 +64,7 @@\n       fill_in_i18n(\n         :attachment_collection_name,\n         \"#attachment_collection-name-tabs\",\n-        en: \"Latest application forms\",\n-        es: \"\u00daltimos formularios de solicitud\",\n-        ca: \"\u00daltims formularis de sol\u00b7licitud\"\n+        **attributes[:name].except(\"machine_translations\")\n       )\n \n       find(\"*[type=submit]\").click\n@@ -75,8 +73,11 @@\n     expect(page).to have_admin_callout(\"successfully\")\n \n     within \"#attachment_collections table\" do\n-      expect(page).to have_text(\"Latest application forms\")\n+      expect(page).to have_content(translated(attributes[:name]))\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"updated the #{translated(attributes[:name])} attachment collection\")\n   end\n \n   context \"when deleting a attachment collection\" do"
        },
        {
          "filename": "decidim-admin/lib/decidim/admin/test/manage_categories_examples.rb",
          "status": "modified",
          "additions": 11,
          "deletions": 8,
          "patch": "@@ -1,6 +1,7 @@\n # frozen_string_literal: true\n \n shared_examples \"manage categories examples\" do\n+  let(:attributes) { attributes_for(:category) }\n   it \"lists all the categories for the process\" do\n     within \"#categories table\" do\n       expect(page).to have_content(translated(category.name, locale: :en))\n@@ -25,9 +26,7 @@\n       fill_in_i18n(\n         :category_name,\n         \"#category-name-tabs\",\n-        en: \"My category\",\n-        es: \"Mi categor\u00eda\",\n-        ca: \"La meva categoria\"\n+        **attributes[:name].except(\"machine_translations\")\n       )\n \n       find(\"*[type=submit]\").click\n@@ -36,8 +35,11 @@\n     expect(page).to have_admin_callout(\"successfully\")\n \n     within \"#categories table\" do\n-      expect(page).to have_content(\"My category\")\n+      expect(page).to have_content(translated(attributes[:name]))\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"added the #{translated(attributes[:name])} category to the\")\n   end\n \n   it \"updates a category\" do\n@@ -51,9 +53,7 @@\n       fill_in_i18n(\n         :category_name,\n         \"#category-name-tabs\",\n-        en: \"My new name\",\n-        es: \"Mi nuevo nombre\",\n-        ca: \"El meu nou nom\"\n+        **attributes[:name].except(\"machine_translations\")\n       )\n \n       find(\"*[type=submit]\").click\n@@ -62,8 +62,11 @@\n     expect(page).to have_admin_callout(\"successfully\")\n \n     within \"#categories table\" do\n-      expect(page).to have_content(\"My new name\")\n+      expect(page).to have_content(translated(attributes[:name]))\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"updated the #{translated(attributes[:name])} category in the\")\n   end\n \n   context \"when deleting a category\" do"
        },
        {
          "filename": "decidim-admin/lib/decidim/admin/test/manage_hide_content_examples.rb",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -54,6 +54,10 @@\n       click_button I18n.t(\"decidim.admin.block_user.new.action\")\n \n       expect(content.reload).to be_hidden\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"blocked user\")\n+      expect(page).to have_content(\"hid a resource of type\")\n     end\n   end\n end"
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_help_sections_spec.rb",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -28,6 +28,9 @@\n \n       help_content = Decidim::ContextualHelpSection.find_content(organization, :participatory_processes)\n       expect(help_content).to include(\"en\" => \"<p>Well hello!</p>\")\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated the Participatory processes help section\")\n     end\n \n     it \"destroys the section when it is empty\" do"
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_newsletters_spec.rb",
          "status": "modified",
          "additions": 11,
          "deletions": 8,
          "patch": "@@ -7,6 +7,7 @@\n \n describe \"Admin manages newsletters\" do\n   let(:organization) { create(:organization) }\n+  let!(:attributes) { attributes_for(:newsletter, organization:) }\n   let(:user) { create(:user, :admin, :confirmed, name: \"Sarah Kerrigan\", organization:) }\n   let!(:deliverable_users) { create_list(:user, 5, :confirmed, newsletter_notifications_at: Time.current, organization:) }\n \n@@ -41,9 +42,7 @@\n         fill_in_i18n(\n           :newsletter_subject,\n           \"#newsletter-subject-tabs\",\n-          en: \"A fancy newsletter for %{name}\",\n-          es: \"Un correo electr\u00f3nico muy chulo para %{name}\",\n-          ca: \"Un correu electr\u00f2nic flipant per a %{name}\"\n+          **attributes[:subject].except(\"machine_translations\")\n         )\n \n         fill_in_i18n_editor(\n@@ -82,7 +81,10 @@\n       end\n \n       expect(page).to have_content(\"Preview\")\n-      expect(page).to have_content(\"A fancy newsletter for #{user.name}\")\n+      expect(page).to have_content(translated(attributes[:subject]))\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created the #{translated(attributes[:subject])} newsletter\")\n     end\n   end\n \n@@ -148,9 +150,7 @@\n         fill_in_i18n(\n           :newsletter_subject,\n           \"#newsletter-subject-tabs\",\n-          en: \"A fancy newsletter\",\n-          es: \"Un correo electr\u00f3nico muy chulo\",\n-          ca: \"Un correu electr\u00f2nic flipant\"\n+          **attributes[:subject].except(\"machine_translations\")\n         )\n \n         fill_in_i18n_editor(\n@@ -165,7 +165,10 @@\n       end\n \n       expect(page).to have_content(\"Preview\")\n-      expect(page).to have_content(\"A fancy newsletter\")\n+      expect(page).to have_content(translated(attributes[:subject]))\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated the #{translated(attributes[:subject])} newsletter\")\n     end\n   end\n "
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_organization_area_types_spec.rb",
          "status": "modified",
          "additions": 13,
          "deletions": 10,
          "patch": "@@ -5,6 +5,7 @@\n describe \"Admin manages area types\" do\n   let(:admin) { create(:user, :admin, :confirmed) }\n   let(:organization) { admin.organization }\n+  let(:attributes) { attributes_for(:area_type) }\n \n   before do\n     switch_to_host(organization.host)\n@@ -24,17 +25,13 @@\n       fill_in_i18n(\n         :area_type_name,\n         \"#area_type-name-tabs\",\n-        en: \"Sectorial en\",\n-        es: \"Sectorial es\",\n-        ca: \"Sectorial ca\"\n+        **attributes[:name].except(\"machine_translations\")\n       )\n \n       fill_in_i18n(\n         :area_type_plural,\n         \"#area_type-plural-tabs\",\n-        en: \"Sectorials en\",\n-        es: \"Sectoriales es\",\n-        ca: \"Sectorials ca\"\n+        **attributes[:plural].except(\"machine_translations\")\n       )\n \n       find(\"*[type=submit]\").click\n@@ -43,8 +40,11 @@\n     expect(page).to have_admin_callout(\"successfully\")\n \n     within \"table\" do\n-      expect(page).to have_content(\"Sectorial en\")\n+      expect(page).to have_content(translated(attributes[:name]))\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"created the #{translated(attributes[:name])} area type\")\n   end\n \n   context \"with existing area_types\" do\n@@ -69,22 +69,25 @@\n         fill_in_i18n(\n           :area_type_name,\n           \"#area_type-name-tabs\",\n-          en: \"Not Sectorial en\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         fill_in_i18n(\n           :area_type_plural,\n           \"#area_type-plural-tabs\",\n-          en: \"This is the new pluarl\"\n+          **attributes[:plural].except(\"machine_translations\")\n         )\n         find(\"*[type=submit]\").click\n       end\n \n       expect(page).to have_admin_callout(\"successfully\")\n \n       within \"table\" do\n-        expect(page).to have_content(\"Not Sectorial en\")\n+        expect(page).to have_content(translated(attributes[:name]))\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated the #{translated(attributes[:name])} area type\")\n     end\n \n     it \"can delete them\" do"
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_organization_areas_spec.rb",
          "status": "modified",
          "additions": 12,
          "deletions": 8,
          "patch": "@@ -7,6 +7,7 @@\n \n   let(:admin) { create(:user, :admin, :confirmed) }\n   let(:organization) { admin.organization }\n+  let(:attributes) { attributes_for(:area) }\n \n   before do\n     switch_to_host(organization.host)\n@@ -26,9 +27,8 @@\n       click_link \"Add\"\n \n       within \".item__edit-form\" do\n-        fill_in_i18n :area_name, \"#area-name-tabs\", en: \"My area\",\n-                                                    es: \"Mi area\",\n-                                                    ca: \"La meva area\"\n+        fill_in_i18n :area_name, \"#area-name-tabs\", **attributes[:name].except(\"machine_translations\")\n+\n         select area_type.name[\"en\"], from: :area_area_type_id\n \n         find(\"*[type=submit]\").click\n@@ -37,8 +37,11 @@\n       expect(page).to have_admin_callout(\"successfully\")\n \n       within \"table\" do\n-        expect(page).to have_content(\"My area\")\n+        expect(page).to have_content(translated(attributes[:name]))\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created the #{translated(attributes[:name])} area\")\n     end\n \n     context \"with existing areas\" do\n@@ -61,17 +64,18 @@\n         end\n \n         within \".item__edit-form\" do\n-          fill_in_i18n :area_name, \"#area-name-tabs\", en: \"Another area\",\n-                                                      es: \"Otra area\",\n-                                                      ca: \"Una altra area\"\n+          fill_in_i18n :area_name, \"#area-name-tabs\", **attributes[:name].except(\"machine_translations\")\n           find(\"*[type=submit]\").click\n         end\n \n         expect(page).to have_admin_callout(\"successfully\")\n \n         within \"table\" do\n-          expect(page).to have_content(\"Another area\")\n+          expect(page).to have_content(translated(attributes[:name]))\n         end\n+\n+        visit decidim_admin.root_path\n+        expect(page).to have_content(\"updated the #{translated(attributes[:name])} area\")\n       end\n \n       it \"can delete them\" do"
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_organization_scope_types_spec.rb",
          "status": "modified",
          "additions": 13,
          "deletions": 10,
          "patch": "@@ -5,6 +5,7 @@\n describe \"Admin manages scope types\" do\n   let(:admin) { create(:user, :admin, :confirmed) }\n   let(:organization) { admin.organization }\n+  let!(:attributes) { attributes_for(:scope_type) }\n \n   before do\n     switch_to_host(organization.host)\n@@ -24,17 +25,13 @@\n       fill_in_i18n(\n         :scope_type_name,\n         \"#scope_type-name-tabs\",\n-        en: \"Territorial en\",\n-        es: \"Territorial es\",\n-        ca: \"Territorial ca\"\n+        **attributes[:name].except(\"machine_translations\")\n       )\n \n       fill_in_i18n(\n         :scope_type_plural,\n         \"#scope_type-plural-tabs\",\n-        en: \"Territorials en\",\n-        es: \"Territoriales es\",\n-        ca: \"Territorials ca\"\n+        **attributes[:plural].except(\"machine_translations\")\n       )\n \n       find(\"*[type=submit]\").click\n@@ -43,8 +40,11 @@\n     expect(page).to have_admin_callout(\"successfully\")\n \n     within \"table\" do\n-      expect(page).to have_content(\"Territorial en\")\n+      expect(page).to have_content(translated(attributes[:name]))\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"created the #{translated(attributes[:name])} scope type\")\n   end\n \n   context \"with existing scope_types\" do\n@@ -69,22 +69,25 @@\n         fill_in_i18n(\n           :scope_type_name,\n           \"#scope_type-name-tabs\",\n-          en: \"Not Territorial en\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         fill_in_i18n(\n           :scope_type_plural,\n           \"#scope_type-plural-tabs\",\n-          en: \"This is the new pluarl\"\n+          **attributes[:plural].except(\"machine_translations\")\n         )\n         find(\"*[type=submit]\").click\n       end\n \n       expect(page).to have_admin_callout(\"successfully\")\n \n       within \"table\" do\n-        expect(page).to have_content(\"Not Territorial en\")\n+        expect(page).to have_content(translated(attributes[:name]))\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated the #{translated(attributes[:name])} scope type\")\n     end\n \n     it \"can delete them\" do"
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_organization_scopes_spec.rb",
          "status": "modified",
          "additions": 11,
          "deletions": 8,
          "patch": "@@ -7,6 +7,7 @@\n \n   let(:admin) { create(:user, :admin, :confirmed) }\n   let(:organization) { admin.organization }\n+  let!(:attributes) { attributes_for(:scope) }\n \n   before do\n     switch_to_host(organization.host)\n@@ -26,9 +27,7 @@\n       click_link \"Add\"\n \n       within \".new_scope\" do\n-        fill_in_i18n :scope_name, \"#scope-name-tabs\", en: \"My nice district\",\n-                                                      es: \"Mi lindo distrito\",\n-                                                      ca: \"El meu bonic barri\"\n+        fill_in_i18n :scope_name, \"#scope-name-tabs\", **attributes[:name].except(\"machine_translations\")\n         fill_in \"Code\", with: \"MY-DISTRICT\"\n         select scope_type.name[\"en\"], from: :scope_scope_type_id\n \n@@ -38,8 +37,11 @@\n       expect(page).to have_admin_callout(\"successfully\")\n \n       within \"table\" do\n-        expect(page).to have_content(\"My nice district\")\n+        expect(page).to have_content(translated(attributes[:name]))\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created the #{translated(attributes[:name])} scope\")\n     end\n \n     context \"with existing scopes\" do\n@@ -55,17 +57,18 @@\n         end\n \n         within \".edit_scope\" do\n-          fill_in_i18n :scope_name, \"#scope-name-tabs\", en: \"Another district\",\n-                                                        es: \"Otro distrito\",\n-                                                        ca: \"Un altre districte\"\n+          fill_in_i18n :scope_name, \"#scope-name-tabs\", **attributes[:name].except(\"machine_translations\")\n           find(\"*[type=submit]\").click\n         end\n \n         expect(page).to have_admin_callout(\"successfully\")\n \n         within \"table\" do\n-          expect(page).to have_content(\"Another district\")\n+          expect(page).to have_content(translated(attributes[:name]))\n         end\n+\n+        visit decidim_admin.root_path\n+        expect(page).to have_content(\"updated the #{translated(attributes[:name])} scope\")\n       end\n \n       it \"can delete them\" do"
        },
        {
          "filename": "decidim-admin/spec/system/admin_manages_organization_spec.rb",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -6,6 +6,7 @@\n   include ActionView::Helpers::SanitizeHelper\n \n   let(:organization) { create(:organization) }\n+  let(:attributes) { attributes_for(:organization) }\n   let(:user) { create(:user, :admin, :confirmed, organization:) }\n \n   before do\n@@ -17,7 +18,7 @@\n     it \"updates the values from the form\" do\n       visit decidim_admin.edit_organization_path\n \n-      fill_in \"Name\", with: \"My super-uber organization\"\n+      fill_in :organization_name, with: attributes[:name]\n \n       %w(X Facebook Instagram YouTube GitHub).each do |network|\n         within \"#organization_social_handlers\" do\n@@ -38,6 +39,9 @@\n \n       click_button \"Update\"\n       expect(page).to have_content(\"updated successfully\")\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated the organization settings\")\n     end\n \n     it \"marks the comments_max_length as required\" do"
        },
        {
          "filename": "decidim-admin/spec/system/static_pages_spec.rb",
          "status": "modified",
          "additions": 13,
          "deletions": 10,
          "patch": "@@ -148,6 +148,7 @@\n \n   describe \"Managing pages\" do\n     let!(:topic) { create(:static_page_topic, organization:) }\n+    let(:attributes) { attributes_for(:static_page) }\n \n     before do\n       login_as admin, scope: :user\n@@ -172,17 +173,13 @@\n         fill_in_i18n(\n           :static_page_title,\n           \"#static_page-title-tabs\",\n-          en: \"Welcome to Decidim\",\n-          es: \"Te damos la bienvendida a Decidim\",\n-          ca: \"Et donem la benvinguda a Decidim\"\n+          **attributes[:title].except(\"machine_translations\")\n         )\n \n         fill_in_i18n_editor(\n           :static_page_content,\n           \"#static_page-content-tabs\",\n-          en: \"<p>Some HTML content</p>\",\n-          es: \"<p>Contenido HTML</p>\",\n-          ca: \"<p>Contingut HTML</p>\"\n+          **attributes[:content].except(\"machine_translations\")\n         )\n \n         select topic.title[I18n.locale.to_s], from: :static_page_topic_id\n@@ -192,8 +189,11 @@\n       expect(page).to have_admin_callout(\"successfully\")\n \n       within find(\".card\", text: topic.title[I18n.locale.to_s]) do\n-        expect(page).to have_css(\"tr\", text: \"Welcome to Decidim\")\n+        expect(page).to have_css(\"tr\", text: translated(attributes[:title]))\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created the #{translated(attributes[:title])} static page\")\n     end\n \n     context \"with existing pages\" do\n@@ -223,12 +223,12 @@\n           fill_in_i18n(\n             :static_page_title,\n             \"#static_page-title-tabs\",\n-            en: \"Not welcomed anymore\"\n+            **attributes[:title].except(\"machine_translations\")\n           )\n           fill_in_i18n_editor(\n             :static_page_content,\n             \"#static_page-content-tabs\",\n-            en: \"This is the new <strong>content</strong>\"\n+            **attributes[:content].except(\"machine_translations\")\n           )\n           select topic.title[I18n.locale.to_s], from: :static_page_topic_id\n           find(\"*[type=submit]\").click\n@@ -237,8 +237,11 @@\n         expect(page).to have_admin_callout(\"successfully\")\n \n         within find(\".card\", text: topic.title[I18n.locale.to_s]) do\n-          expect(page).to have_css(\"tr\", text: \"Not welcomed anymore\")\n+          expect(page).to have_css(\"tr\", text: translated(attributes[:title]))\n         end\n+\n+        visit decidim_admin.root_path\n+        expect(page).to have_content(\"updated the #{translated(attributes[:title])} static page\")\n       end\n \n       it \"can delete them\" do"
        },
        {
          "filename": "decidim-assemblies/spec/shared/manage_assembly_components_examples.rb",
          "status": "modified",
          "additions": 16,
          "deletions": 10,
          "patch": "@@ -1,6 +1,8 @@\n # frozen_string_literal: true\n \n shared_examples \"manage assembly components\" do\n+  let!(:attributes) { attributes_for(:component, participatory_space: assembly) }\n+\n   before do\n     switch_to_host(organization.host)\n     login_as user, scope: :user\n@@ -20,9 +22,7 @@\n         fill_in_i18n(\n           :component_name,\n           \"#component-name-tabs\",\n-          en: \"My component\",\n-          ca: \"La meva funcionalitat\",\n-          es: \"Mi funcionalitat\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         within \".global-settings\" do\n@@ -49,12 +49,17 @@\n \n     it \"is successfully created\" do\n       expect(page).to have_admin_callout(\"successfully\")\n-      expect(page).to have_content(\"My component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n+    end\n+\n+    it \"has a successful admin log\" do\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created #{translated(attributes[:name])} in #{translated(assembly.title)}\")\n     end\n \n     context \"and then edit it\" do\n       before do\n-        within find(\"tr\", text: \"My component\") do\n+        within \"tr\", text: translated(attributes[:name]) do\n           click_link \"Configure\"\n         end\n       end\n@@ -103,9 +108,7 @@\n         fill_in_i18n(\n           :component_name,\n           \"#component-name-tabs\",\n-          en: \"My updated component\",\n-          ca: \"La meva funcionalitat actualitzada\",\n-          es: \"Mi funcionalidad actualizada\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         within \".global-settings\" do\n@@ -120,9 +123,9 @@\n       end\n \n       expect(page).to have_admin_callout(\"successfully\")\n-      expect(page).to have_content(\"My updated component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n \n-      within find(\"tr\", text: \"My updated component\") do\n+      within \"tr\", text: translated(attributes[:name]) do\n         click_link \"Configure\"\n       end\n \n@@ -133,6 +136,9 @@\n       within \".default-step-settings\" do\n         expect(all(\"input[type=checkbox]\").first).to be_checked\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated #{translated(attributes[:name])} in #{translated(assembly.title)}\")\n     end\n   end\n "
        },
        {
          "filename": "decidim-assemblies/spec/shared/manage_assembly_private_users_examples.rb",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -35,6 +35,9 @@\n     within \"#private_users table\" do\n       expect(page).to have_content(other_user.email)\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"invited #{other_user.name} to be a private participant\")\n   end\n \n   describe \"when import a batch of private users from csv\" do"
        },
        {
          "filename": "decidim-conferences/spec/shared/manage_conference_components_examples.rb",
          "status": "modified",
          "additions": 16,
          "deletions": 10,
          "patch": "@@ -1,6 +1,8 @@\n # frozen_string_literal: true\n \n shared_examples \"manage conference components\" do\n+  let!(:attributes) { attributes_for(:component, participatory_space: conference) }\n+\n   before do\n     switch_to_host(organization.host)\n     login_as user, scope: :user\n@@ -20,9 +22,7 @@\n         fill_in_i18n(\n           :component_name,\n           \"#component-name-tabs\",\n-          en: \"My component\",\n-          ca: \"La meva funcionalitat\",\n-          es: \"Mi funcionalitat\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         within \".global-settings\" do\n@@ -49,12 +49,17 @@\n \n     it \"is successfully created\" do\n       expect(page).to have_admin_callout(\"successfully\")\n-      expect(page).to have_content(\"My component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n+    end\n+\n+    it \"has a successful admin log\" do\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created #{translated(attributes[:name])} in #{translated(conference.title)}\")\n     end\n \n     context \"and then edit it\" do\n       before do\n-        within find(\"tr\", text: \"My component\") do\n+        within \"tr\", text: translated(attributes[:name]) do\n           click_link \"Configure\"\n         end\n       end\n@@ -103,9 +108,7 @@\n         fill_in_i18n(\n           :component_name,\n           \"#component-name-tabs\",\n-          en: \"My updated component\",\n-          ca: \"La meva funcionalitat actualitzada\",\n-          es: \"Mi funcionalidad actualizada\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         within \".global-settings\" do\n@@ -120,9 +123,9 @@\n       end\n \n       expect(page).to have_admin_callout(\"successfully\")\n-      expect(page).to have_content(\"My updated component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n \n-      within find(\"tr\", text: \"My updated component\") do\n+      within \"tr\", text: translated(attributes[:name]) do\n         click_link \"Configure\"\n       end\n \n@@ -133,6 +136,9 @@\n       within \".default-step-settings\" do\n         expect(all(\"input[type=checkbox]\").first).to be_checked\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated #{translated(attributes[:name])} in #{translated(conference.title)}\")\n     end\n   end\n "
        },
        {
          "filename": "decidim-core/app/presenters/decidim/admin_log/organization_presenter.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -26,7 +26,7 @@ def diff_fields_mapping\n \n       def settings_attributes_mapping\n         {\n-          name: :string,\n+          name: :i18n,\n           default_locale: :locale,\n           reference_prefix: :string,\n           twitter_handler: :string,"
        },
        {
          "filename": "decidim-initiatives/spec/system/admin/admin_manages_initiative_components_spec.rb",
          "status": "modified",
          "additions": 15,
          "deletions": 10,
          "patch": "@@ -7,6 +7,7 @@\n   let(:user) { create(:user, :admin, :confirmed, organization:) }\n \n   let!(:initiative) { create(:initiative, organization:) }\n+  let!(:attributes) { attributes_for(:component, participatory_space: initiative) }\n \n   before do\n     switch_to_host(organization.host)\n@@ -28,9 +29,7 @@\n           fill_in_i18n(\n             :component_name,\n             \"#component-name-tabs\",\n-            en: \"My component\",\n-            ca: \"El meu component\",\n-            es: \"Mi componente\"\n+            **attributes[:name].except(\"machine_translations\")\n           )\n \n           within \".global-settings\" do\n@@ -57,12 +56,17 @@\n \n     it \"is successfully created\" do\n       expect(page).to have_admin_callout(\"Component created successfully.\")\n-      expect(page).to have_content(\"My component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n+    end\n+\n+    it \"has a successful admin log\" do\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created #{translated(attributes[:name])} in #{translated(initiative.title)}\")\n     end\n \n     context \"and then edit it\" do\n       before do\n-        within find(\"tr\", text: \"My component\") do\n+        within \"tr\", text: translated(attributes[:name]) do\n           page.find(\".action-icon--configure\").click\n         end\n       end\n@@ -111,9 +115,7 @@\n         fill_in_i18n(\n           :component_name,\n           \"#component-name-tabs\",\n-          en: \"My updated component\",\n-          ca: \"El meu component actualitzat\",\n-          es: \"Mi componente actualizado\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         within \".global-settings\" do\n@@ -128,9 +130,9 @@\n       end\n \n       expect(page).to have_admin_callout(\"The component was updated successfully.\")\n-      expect(page).to have_content(\"My updated component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n \n-      within find(\"tr\", text: \"My updated component\") do\n+      within \"tr\", text: translated(attributes[:name]) do\n         page.find(\".action-icon--configure\").click\n       end\n \n@@ -141,6 +143,9 @@\n       within \".default-step-settings\" do\n         expect(all(\"input[type=checkbox]\").first).to be_checked\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated #{translated(attributes[:name])} in #{translated(initiative.title)}\")\n     end\n   end\n "
        },
        {
          "filename": "decidim-initiatives/spec/system/admin/admin_manages_initiatives_types_spec.rb",
          "status": "modified",
          "additions": 15,
          "deletions": 3,
          "patch": "@@ -6,6 +6,7 @@\n   let(:organization) { create(:organization) }\n   let(:user) { create(:user, :admin, :confirmed, organization:) }\n   let!(:initiatives_type) { create(:initiatives_type, organization:) }\n+  let(:attributes) { attributes_for(:initiatives_type) }\n \n   before do\n     switch_to_host(organization.host)\n@@ -26,13 +27,13 @@\n       fill_in_i18n(\n         :initiatives_type_title,\n         \"#initiatives_type-title-tabs\",\n-        en: \"My initiative type\"\n+        **attributes[:title].except(\"machine_translations\")\n       )\n \n       fill_in_i18n_editor(\n         :initiatives_type_description,\n         \"#initiatives_type-description-tabs\",\n-        en: \"A longer description\"\n+        **attributes[:description].except(\"machine_translations\")\n       )\n \n       select(\"Online\", from: \"Signature type\")\n@@ -42,6 +43,9 @@\n       click_button \"Create\"\n \n       expect(page).to have_admin_callout(\"A new initiative type has been successfully created\")\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"created the #{translated(attributes[:title])} initiatives type\")\n     end\n   end\n \n@@ -54,7 +58,12 @@\n       fill_in_i18n(\n         :initiatives_type_title,\n         \"#initiatives_type-title-tabs\",\n-        en: \"My updated initiative type\"\n+        **attributes[:title].except(\"machine_translations\")\n+      )\n+      fill_in_i18n_editor(\n+        :initiatives_type_description,\n+        \"#initiatives_type-description-tabs\",\n+        **attributes[:description].except(\"machine_translations\")\n       )\n \n       select(\"Mixed\", from: \"Signature type\")\n@@ -67,6 +76,9 @@\n       click_button \"Update\"\n \n       expect(page).to have_admin_callout(\"The initiative type has been successfully updated\")\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated the #{translated(attributes[:title])} initiatives type\")\n     end\n   end\n "
        },
        {
          "filename": "decidim-initiatives/spec/system/admin/update_initiative_spec.rb",
          "status": "modified",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -15,6 +15,8 @@ def submit_and_validate\n \n   context \"when initiative update\" do\n     context \"and user is admin\" do\n+      let(:attributes) { attributes_for(:initiative, organization:) }\n+\n       before do\n         switch_to_host(organization.host)\n         login_as user, scope: :user\n@@ -29,6 +31,25 @@ def submit_and_validate\n         submit_and_validate\n       end\n \n+      it \"updates the initiative\" do\n+        page.find(\".action-icon--edit\").click\n+\n+        fill_in_i18n(\n+          :initiative_title,\n+          \"#initiative-title-tabs\",\n+          **attributes[:title].except(\"machine_translations\")\n+        )\n+        fill_in_i18n_editor(\n+          :initiative_description,\n+          \"#initiative-description-tabs\",\n+          **attributes[:description].except(\"machine_translations\")\n+        )\n+        submit_and_validate\n+\n+        visit decidim_admin.root_path\n+        expect(page).to have_content(\"updated the #{translated(attributes[:title])} initiative\")\n+      end\n+\n       context \"when initiative is in created state\" do\n         before do\n           initiative.created!"
        },
        {
          "filename": "decidim-participatory_processes/spec/shared/manage_participatory_process_private_users_examples.rb",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -35,6 +35,9 @@\n     within \"#private_users table\" do\n       expect(page).to have_content(other_user.email)\n     end\n+\n+    visit decidim_admin.root_path\n+    expect(page).to have_content(\"invited #{other_user.name} to be a private participant\")\n   end\n \n   describe \"when import a batch of private users from csv\" do"
        },
        {
          "filename": "decidim-participatory_processes/spec/shared/manage_process_components_examples.rb",
          "status": "modified",
          "additions": 16,
          "deletions": 10,
          "patch": "@@ -4,6 +4,8 @@\n   let!(:participatory_process) do\n     create(:participatory_process, :with_steps, organization:)\n   end\n+  let!(:attributes) { attributes_for(:component, participatory_space: participatory_process) }\n+\n   let(:step_id) { participatory_process.steps.first.id }\n \n   before do\n@@ -30,9 +32,7 @@\n           fill_in_i18n(\n             :component_name,\n             \"#component-name-tabs\",\n-            en: \"My component\",\n-            ca: \"La meva funcionalitat\",\n-            es: \"Mi funcionalitat\"\n+            **attributes[:name].except(\"machine_translations\")\n           )\n \n           within \".global-settings\" do\n@@ -59,12 +59,17 @@\n \n       it \"is successfully created\" do\n         expect(page).to have_admin_callout(\"successfully\")\n-        expect(page).to have_content(\"My component\")\n+        expect(page).to have_content(translated(attributes[:name]))\n+      end\n+\n+      it \"has a successful admin log\" do\n+        visit decidim_admin.root_path\n+        expect(page).to have_content(\"created #{translated(attributes[:name])} in #{translated(participatory_process.title)}\")\n       end\n \n       context \"and then edit it\" do\n         before do\n-          within find(\"tr\", text: \"My component\") do\n+          within \"tr\", text: translated(attributes[:name]) do\n             click_link \"Configure\"\n           end\n         end\n@@ -194,9 +199,7 @@\n         fill_in_i18n(\n           :component_name,\n           \"#component-name-tabs\",\n-          en: \"My updated component\",\n-          ca: \"La meva funcionalitat actualitzada\",\n-          es: \"Mi funcionalidad actualizada\"\n+          **attributes[:name].except(\"machine_translations\")\n         )\n \n         within \".global-settings\" do\n@@ -211,9 +214,9 @@\n       end\n \n       expect(page).to have_admin_callout(\"successfully\")\n-      expect(page).to have_content(\"My updated component\")\n+      expect(page).to have_content(translated(attributes[:name]))\n \n-      within find(\"tr\", text: \"My updated component\") do\n+      within \"tr\", text: translated(attributes[:name]) do\n         click_link \"Configure\"\n       end\n \n@@ -224,6 +227,9 @@\n       within \".step-settings\" do\n         expect(all(\"input[type=checkbox]\").first).to be_checked\n       end\n+\n+      visit decidim_admin.root_path\n+      expect(page).to have_content(\"updated #{translated(attributes[:name])} in #{translated(participatory_process.title)}\")\n     end\n \n     context \"when the process does not have active steps\" do"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 3,
        "unique_directories": 7,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e9e49808aeb85493fce228c057010abac45a10f2",
            "date": "2025-01-14T13:00:27Z",
            "author_login": "alecslupu"
          },
          {
            "sha": "9fd1b9ec44d5070586bc55357d58f05cbf785ec2",
            "date": "2025-01-14T11:45:18Z",
            "author_login": "BarbaraOliveira13"
          },
          {
            "sha": "740a3b792c3a4240699addbde8950d31b08d7a4d",
            "date": "2025-01-14T11:37:47Z",
            "author_login": "alecslupu"
          },
          {
            "sha": "08a53bae27886d7ff3d7b404d918dad8c2dca0a5",
            "date": "2025-01-14T10:14:01Z",
            "author_login": "alecslupu"
          },
          {
            "sha": "18869cf7834369c08d165358207466ed09406f20",
            "date": "2025-01-14T09:15:39Z",
            "author_login": "andreslucena"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-79",
    "description": "decidim is a Free Open-Source participatory democracy, citizen participation and open government for cities and organizations. The admin panel is subject to potential Cross-site scripting (XSS) attach in case an admin assigns a valuator to a proposal, or does any other action that generates an admin activity log where one of the resources has an XSS crafted. This issue has been addressed in release version 0.27.7, 0.28.2, and newer. Users are advised to upgrade. Users unable to upgrade may redirect the pages /admin and /admin/logs to other admin pages to prevent this access (i.e. `/admin/organization/edit`).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-16T19:16:10.300",
    "last_modified": "2024-09-29T00:14:35.067",
    "fix_date": "2024-07-08T10:13:31Z"
  },
  "references": [
    {
      "url": "https://github.com/decidim/decidim/commit/23fc8d702a4976727f78617f5e42353d67931645",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/9d79f09a2d38c87feb28725670d6cc1f55c22072",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/e494235d559be13dd1f8694345e6f6bba762d1c0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/commit/ff755e23814aeb56e9089fc08006a5d3faee47b6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/decidim/decidim/security/advisories/GHSA-rx9f-5ggv-5rh6",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:00.123491",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "decidim",
    "owner": "decidim",
    "created_at": "2016-08-17T14:27:06Z",
    "updated_at": "2025-01-14T13:00:32Z",
    "pushed_at": "2025-01-14T13:01:17Z",
    "size": 264752,
    "stars": 1494,
    "forks": 408,
    "open_issues": 412,
    "watchers": 1494,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "Ruby": 12848603,
      "HTML": 1662161,
      "JavaScript": 763759,
      "SCSS": 258282,
      "Dockerfile": 205,
      "Shell": 49
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:07:09.324253"
  }
}