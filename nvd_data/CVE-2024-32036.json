{
  "cve_id": "CVE-2024-32036",
  "github_data": {
    "repository": "SixLabors/ImageSharp",
    "fix_commit": "8f0b4d3e680e78d479a88e7b1472bccd8f096d68",
    "related_commits": [
      "8f0b4d3e680e78d479a88e7b1472bccd8f096d68",
      "da5f09a42513489fe359578d81cec2f15ba588ba",
      "8f0b4d3e680e78d479a88e7b1472bccd8f096d68",
      "da5f09a42513489fe359578d81cec2f15ba588ba"
    ],
    "patch_url": "https://github.com/SixLabors/ImageSharp/commit/8f0b4d3e680e78d479a88e7b1472bccd8f096d68.patch",
    "fix_commit_details": {
      "sha": "8f0b4d3e680e78d479a88e7b1472bccd8f096d68",
      "commit_date": "2024-04-10T22:21:50Z",
      "author": {
        "login": "antonfirsov",
        "type": "User",
        "stats": {
          "total_commits": 2180,
          "average_weekly_commits": 3.303030303030303,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 169
        }
      },
      "commit_message": {
        "title": "Merge pull request #2717 from SixLabors/backport/v2-clear-buffers",
        "length": 102,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/ImageSharp/Formats/Jpeg/Components/Decoder/SpectralConverter{TPixel}.cs",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -116,7 +116,8 @@ public override void InjectFrameData(JpegFrame frame, IRawJpegData jpegData)\n             this.pixelBuffer = allocator.Allocate2D<TPixel>(\n                 frame.PixelWidth,\n                 frame.PixelHeight,\n-                this.configuration.PreferContiguousImageBuffers);\n+                this.configuration.PreferContiguousImageBuffers,\n+                AllocationOptions.Clean);\n             this.paddedProxyPixelRow = allocator.Allocate<TPixel>(frame.PixelWidth + 3);\n \n             // component processors from spectral to Rgba32\n@@ -215,4 +216,4 @@ public void Dispose()\n             this.pixelBuffer?.Dispose();\n         }\n     }\n-}\n+}\n\\ No newline at end of file"
        },
        {
          "filename": "src/ImageSharp/Formats/Tga/TgaDecoderCore.cs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -97,7 +97,7 @@ public Image<TPixel> Decode<TPixel>(BufferedReadStream stream, CancellationToken\n                     throw new UnknownImageFormatException(\"Width or height cannot be 0\");\n                 }\n \n-                var image = Image.CreateUninitialized<TPixel>(this.Configuration, this.fileHeader.Width, this.fileHeader.Height, this.metadata);\n+                Image<TPixel> image = new(this.Configuration, this.fileHeader.Width, this.fileHeader.Height, this.metadata);\n                 Buffer2D<TPixel> pixels = image.GetRootFramePixelBuffer();\n \n                 if (this.fileHeader.ColorMapType == 1)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e08651bbf6a8108865b1b2605751faa5cfc44a06",
            "date": "2024-12-18T01:48:59Z",
            "author_login": "JimBobSquarePants"
          },
          {
            "sha": "b38146dfaa2d25ea7fa85847a4012c88caa902f9",
            "date": "2024-12-17T00:37:18Z",
            "author_login": "antonfirsov"
          },
          {
            "sha": "dee312df7e491a5d1448d97cddb06a32aab1ffde",
            "date": "2024-12-16T22:48:24Z",
            "author_login": "antonfirsov"
          },
          {
            "sha": "4be26452b9366b0a4fe67aab91cfcb360916c5ea",
            "date": "2024-12-11T02:34:20Z",
            "author_login": "JimBobSquarePants"
          },
          {
            "sha": "502a35426225e22ebff965ffaa2be31ecc286880",
            "date": "2024-11-27T12:21:39Z",
            "author_login": "JimBobSquarePants"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-226",
    "description": "ImageSharp is a 2D graphics API. A data leakage flaw was found in ImageSharp's JPEG and TGA decoders. This vulnerability is triggered when an attacker passes a specially crafted JPEG or TGA image file to a software using ImageSharp, potentially disclosing sensitive information from other parts of the software in the resulting image buffer. The problem has been patched in v3.1.4 and v2.1.8.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-04-15T20:15:11.543",
    "last_modified": "2025-01-09T18:14:46.097",
    "fix_date": "2024-04-10T22:21:50Z"
  },
  "references": [
    {
      "url": "https://github.com/SixLabors/ImageSharp/commit/8f0b4d3e680e78d479a88e7b1472bccd8f096d68",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/SixLabors/ImageSharp/commit/da5f09a42513489fe359578d81cec2f15ba588ba",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-5x7m-6737-26cr",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/SixLabors/ImageSharp/commit/8f0b4d3e680e78d479a88e7b1472bccd8f096d68",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/SixLabors/ImageSharp/commit/da5f09a42513489fe359578d81cec2f15ba588ba",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/SixLabors/ImageSharp/security/advisories/GHSA-5x7m-6737-26cr",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:04.488990",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ImageSharp",
    "owner": "SixLabors",
    "created_at": "2016-10-28T04:46:36Z",
    "updated_at": "2025-01-14T14:21:12Z",
    "pushed_at": "2025-01-06T10:46:24Z",
    "size": 132452,
    "stars": 7554,
    "forks": 853,
    "open_issues": 45,
    "watchers": 7554,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "C#": 10815585,
      "JavaScript": 40805,
      "HTML": 5210,
      "PowerShell": 5178,
      "Batchfile": 121
    },
    "commit_activity": {
      "total_commits_last_year": 390,
      "avg_commits_per_week": 7.5,
      "days_active_last_year": 121
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:51:16.290801"
  }
}