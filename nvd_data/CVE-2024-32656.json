{
  "cve_id": "CVE-2024-32656",
  "github_data": {
    "repository": "ant-media/Ant-Media-Server",
    "fix_commit": "9cb38500729e0ff302da0290b9cfe1ec4dd6c764",
    "related_commits": [
      "9cb38500729e0ff302da0290b9cfe1ec4dd6c764",
      "9cb38500729e0ff302da0290b9cfe1ec4dd6c764"
    ],
    "patch_url": "https://github.com/ant-media/Ant-Media-Server/commit/9cb38500729e0ff302da0290b9cfe1ec4dd6c764.patch",
    "fix_commit_details": {
      "sha": "9cb38500729e0ff302da0290b9cfe1ec4dd6c764",
      "commit_date": "2024-03-23T20:08:17Z",
      "author": {
        "login": "mekya",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Disable jmx remote by default",
        "length": 29,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/main/server/antmedia.service",
          "status": "modified",
          "additions": 6,
          "deletions": 1,
          "patch": "@@ -21,7 +21,12 @@ StandardOutput=null\n StandardError=append:/usr/local/antmedia/log/antmedia-error.log\n \n #if we use start.sh in here, we need to make sure that default values of the options does not overwrite the configuration\n-ExecStart=/usr/bin/env ${JAVA_HOME}/bin/java -Dlogback.ContextSelector=org.red5.logging.LoggingContextSelector -cp ${ANTMEDIA_HOME}/ant-media-server-service.jar:${ANTMEDIA_HOME}/conf -Djava.security.debug=failure -Djava.awt.headless=true -Djava.security.egd=file:/dev/./urandom -Dcatalina.home=${ANTMEDIA_HOME} -Dcatalina.useNaming=true -Dorg.terracotta.quartz.skipUpdateCheck=true -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:ParallelGCThreads=10 -XX:ConcGCThreads=5 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.port=5599 -Dcom.sun.management.jmxremote.local.only=true -Dcom.sun.management.jmxremote.host=127.0.0.1 -Djava.rmi.server.hostname=127.0.0.1 -Djava.rmi.server.useLocalHostname=true -Dcom.sun.management.jmxremote.rmi.port=5599 -XX:+HeapDumpOnOutOfMemoryError -Djava.library.path=/usr/local/antmedia/lib/native -Xverify:none -XX:+TieredCompilation -XX:+UseBiasedLocking -XX:InitialCodeCacheSize=8m -XX:ReservedCodeCacheSize=32m -Djava.net.preferIPv4Stack=true $JVM_MEMORY_OPTIONS -Djdk.lang.Process.launchMechanism=vfork -Djava.system.class.loader=org.red5.server.classloading.ServerClassLoader -Xshare:off org.red5.server.Bootstrap 9999\n+\n+\n+# By default we have disabled jmxremote because it's not secure. If you want to enable it, you can add the following options to the ExecStart line\n+# -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.port=5599 -Dcom.sun.management.jmxremote.local.only=true -Dcom.sun.management.jmxremote.host=127.0.0.1 -Djava.rmi.server.hostname=127.0.0.1 -Djava.rmi.server.useLocalHostname=true -Dcom.sun.management.jmxremote.rmi.port=5599 \n+\n+ExecStart=/usr/bin/env ${JAVA_HOME}/bin/java -Dlogback.ContextSelector=org.red5.logging.LoggingContextSelector -cp ${ANTMEDIA_HOME}/ant-media-server-service.jar:${ANTMEDIA_HOME}/conf -Djava.security.debug=failure -Djava.awt.headless=true -Djava.security.egd=file:/dev/./urandom -Dcatalina.home=${ANTMEDIA_HOME} -Dcatalina.useNaming=true -Dorg.terracotta.quartz.skipUpdateCheck=true -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:ParallelGCThreads=10 -XX:ConcGCThreads=5 -XX:+HeapDumpOnOutOfMemoryError -Djava.library.path=/usr/local/antmedia/lib/native -Xverify:none -XX:+TieredCompilation -XX:+UseBiasedLocking -XX:InitialCodeCacheSize=8m -XX:ReservedCodeCacheSize=32m -Djava.net.preferIPv4Stack=true $JVM_MEMORY_OPTIONS -Djdk.lang.Process.launchMechanism=vfork -Djava.system.class.loader=org.red5.server.classloading.ServerClassLoader -Xshare:off org.red5.server.Bootstrap 9999\n \n [Install]\n WantedBy=multi-user.target"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f946cc477ad3ae79b5c5e0b56f45cefac44ed425",
            "date": "2025-01-13T12:30:18Z",
            "author_login": "mekya"
          },
          {
            "sha": "dd052443e76ecf8e7af7c34586d4d1021fcd1ac4",
            "date": "2025-01-13T08:25:54Z",
            "author_login": "mekya"
          },
          {
            "sha": "07aa8055cb4c9a5d1bce611b78a4d9e38e7112cb",
            "date": "2025-01-13T07:30:22Z",
            "author_login": "burak-58"
          },
          {
            "sha": "fea401d401c0c4e730a65f36f08dcc5942123746",
            "date": "2025-01-13T06:24:30Z",
            "author_login": "mekya"
          },
          {
            "sha": "ff4f7ca31d658d3fd449134ee7488d35991c6373",
            "date": "2025-01-12T21:04:00Z",
            "author_login": "mekya"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-862",
    "description": "Ant Media Server is live streaming engine software. A local privilege escalation vulnerability in present in versions 2.6.0 through 2.8.2 allows any unprivileged operating system user account to escalate privileges to the root user account on the system. This vulnerability arises from Ant Media Server running with Java Management Extensions (JMX) enabled and authentication disabled on localhost on port 5599/TCP. This vulnerability is nearly identical to the local privilege escalation vulnerability CVE-2023-26269 identified in Apache James. Any unprivileged operating system user can connect to the JMX service running on port 5599/TCP on localhost and leverage the MLet Bean within JMX to load a remote MBean from an attacker-controlled server. This allows an attacker to execute arbitrary code within the Java process run by Ant Media Server and execute code within the context of the `antmedia` service account on the system. Version 2.9.0 contains a patch for the issue. As a workaround, one may remove certain parameters from the `antmedia.service` file.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-22T23:15:50.817",
    "last_modified": "2024-11-21T09:15:24.537",
    "fix_date": "2024-03-23T20:08:17Z"
  },
  "references": [
    {
      "url": "https://github.com/ant-media/Ant-Media-Server/commit/9cb38500729e0ff302da0290b9cfe1ec4dd6c764",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ant-media/Ant-Media-Server/security/advisories/GHSA-qwhw-hh9j-54f5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ant-media/Ant-Media-Server/commit/9cb38500729e0ff302da0290b9cfe1ec4dd6c764",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/ant-media/Ant-Media-Server/security/advisories/GHSA-qwhw-hh9j-54f5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:07.010073",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Ant-Media-Server",
    "owner": "ant-media",
    "created_at": "2017-03-01T08:21:13Z",
    "updated_at": "2025-01-14T09:54:24Z",
    "pushed_at": "2025-01-13T16:56:04Z",
    "size": 1197807,
    "stars": 4346,
    "forks": 641,
    "open_issues": 1203,
    "watchers": 4346,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Java": 6148642,
      "Shell": 51658,
      "Python": 10028
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:12:30.608465"
  }
}