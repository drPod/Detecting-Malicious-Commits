{
  "cve_id": "CVE-2024-3279",
  "github_data": {
    "repository": "mintplex-labs/anything-llm",
    "fix_commit": "08d33cfd8fc47c5052b6ea29597c964a9da641e2",
    "related_commits": [
      "08d33cfd8fc47c5052b6ea29597c964a9da641e2"
    ],
    "patch_url": "https://github.com/mintplex-labs/anything-llm/commit/08d33cfd8fc47c5052b6ea29597c964a9da641e2.patch",
    "fix_commit_details": {
      "sha": "08d33cfd8fc47c5052b6ea29597c964a9da641e2",
      "commit_date": "2024-01-18T21:57:23Z",
      "author": {
        "login": "shatfield4",
        "type": "User",
        "stats": {
          "total_commits": 270,
          "average_weekly_commits": 3.13953488372093,
          "total_additions": 82332,
          "total_deletions": 29584,
          "weeks_active": 60
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-xmj6-g32r-fc5q",
        "length": 222,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 587,
        "additions": 3,
        "deletions": 584
      },
      "files": [
        {
          "filename": "frontend/src/App.jsx",
          "status": "modified",
          "additions": 0,
          "deletions": 7,
          "patch": "@@ -34,9 +34,6 @@ const GeneralEmbeddingPreference = lazy(\n const GeneralVectorDatabase = lazy(\n   () => import(\"@/pages/GeneralSettings/VectorDatabase\")\n );\n-const GeneralExportImport = lazy(\n-  () => import(\"@/pages/GeneralSettings/ExportImport\")\n-);\n const GeneralSecurity = lazy(() => import(\"@/pages/GeneralSettings/Security\"));\n const DataConnectors = lazy(\n   () => import(\"@/pages/GeneralSettings/DataConnectors\")\n@@ -74,10 +71,6 @@ export default function App() {\n                 element={<AdminRoute Component={GeneralVectorDatabase} />}\n               />\n               {/* Manager */}\n-              <Route\n-                path=\"/settings/export-import\"\n-                element={<ManagerRoute Component={GeneralExportImport} />}\n-              />\n               <Route\n                 path=\"/settings/security\"\n                 element={<ManagerRoute Component={GeneralSecurity} />}"
        },
        {
          "filename": "frontend/src/components/SettingsSidebar/index.jsx",
          "status": "modified",
          "additions": 0,
          "deletions": 15,
          "patch": "@@ -1,6 +1,4 @@\n import React, { useEffect, useRef, useState } from \"react\";\n-// import IndexCount from \"../Sidebar/IndexCount\";\n-// import LLMStatus from \"../Sidebar/LLMStatus\";\n import paths from \"@/utils/paths\";\n import useLogo from \"@/hooks/useLogo\";\n import {\n@@ -14,10 +12,8 @@ import {\n   Key,\n   ChatText,\n   Database,\n-  DownloadSimple,\n   Lock,\n   GithubLogo,\n-  DotsThree,\n   House,\n   X,\n   List,\n@@ -135,12 +131,6 @@ export default function SettingsSidebar() {\n                     />\n                   </>\n                 )}\n-\n-                <Option\n-                  href={paths.settings.exportImport()}\n-                  btnText=\"Export or Import\"\n-                  icon={<DownloadSimple className=\"h-5 w-5 flex-shrink-0\" />}\n-                />\n                 <Option\n                   href={paths.settings.security()}\n                   btnText=\"Security\"\n@@ -328,11 +318,6 @@ export function SidebarMobileHeader() {\n                       />\n                     </>\n                   )}\n-                  <Option\n-                    href={paths.settings.exportImport()}\n-                    btnText=\"Export or Import\"\n-                    icon={<DownloadSimple className=\"h-5 w-5 flex-shrink-0\" />}\n-                  />\n                   <Option\n                     href={paths.settings.security()}\n                     btnText=\"Security\""
        },
        {
          "filename": "frontend/src/models/system.js",
          "status": "modified",
          "additions": 0,
          "deletions": 25,
          "patch": "@@ -160,31 +160,6 @@ const System = {\n         return false;\n       });\n   },\n-  dataExport: async () => {\n-    return await fetch(`${API_BASE}/system/data-export`, {\n-      method: \"GET\",\n-      headers: baseHeaders(),\n-    })\n-      .then((res) => res.json())\n-      .then((res) => res)\n-      .catch((e) => {\n-        console.error(e);\n-        return { filename: null, error: e.message };\n-      });\n-  },\n-  importData: async (formData) => {\n-    return await fetch(`${API_BASE}/system/data-import`, {\n-      method: \"POST\",\n-      body: formData,\n-      headers: baseHeaders(),\n-    })\n-      .then((res) => res.json())\n-      .then((res) => res)\n-      .catch((e) => {\n-        console.error(e);\n-        return { success: false, error: e.message };\n-      });\n-  },\n   uploadPfp: async function (formData) {\n     return await fetch(`${API_BASE}/system/upload-pfp`, {\n       method: \"POST\","
        },
        {
          "filename": "frontend/src/pages/GeneralSettings/ExportImport/index.jsx",
          "status": "removed",
          "additions": 0,
          "deletions": 226,
          "patch": "@@ -1,226 +0,0 @@\n-import { useRef, useState } from \"react\";\n-import Sidebar, { SidebarMobileHeader } from \"@/components/SettingsSidebar\";\n-import { isMobile } from \"react-device-detect\";\n-import showToast from \"@/utils/toast\";\n-import { CloudArrowUp, DownloadSimple } from \"@phosphor-icons/react\";\n-import System from \"@/models/system\";\n-import { API_BASE } from \"@/utils/constants\";\n-import paths from \"@/utils/paths\";\n-\n-export default function GeneralExportImport() {\n-  const hostname = window?.location?.hostname;\n-  const isHosted = hostname.includes(\".useanything.com\");\n-\n-  if (isHosted) {\n-    return (\n-      <div className=\"w-screen h-screen overflow-hidden bg-sidebar flex\">\n-        {!isMobile && <Sidebar />}\n-        <div\n-          style={{ height: isMobile ? \"100%\" : \"calc(100% - 32px)\" }}\n-          className=\"transition-all duration-500 relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[26px] bg-main-gradient w-full h-full overflow-y-scroll border-4 border-accent\"\n-        >\n-          {isMobile && <SidebarMobileHeader />}\n-          <div className=\"flex flex-col w-full px-1 md:px-20 md:py-12 py-16\">\n-            <div className=\"w-full flex flex-col gap-y-1 pb-6 border-white border-b-2 border-opacity-10\">\n-              <div className=\"items-center flex gap-x-4\">\n-                <p className=\"text-2xl font-semibold text-white\">\n-                  Export or Import\n-                </p>\n-              </div>\n-            </div>\n-          </div>\n-\n-          <div className=\"w-full items-center justify-center flex flex-col gap-y-4\">\n-            <p className=\"text-lg font-base text-white text-opacity-60\">\n-              This feature is temporarily disabled for hosted AnythingLLM\n-              instances.\n-            </p>\n-            <a\n-              href={`${paths.mailToMintplex()}?Subject=Import/Export disabled on hosted AnythingLLM.`}\n-              className=\"text-blue-300 hover:underline\"\n-            >\n-              Contact Mintplex Labs Inc.\n-            </a>\n-          </div>\n-        </div>\n-      </div>\n-    );\n-  }\n-\n-  return (\n-    <div className=\"w-screen h-screen overflow-hidden bg-sidebar flex\">\n-      {!isMobile && <Sidebar />}\n-      <div\n-        style={{ height: isMobile ? \"100%\" : \"calc(100% - 32px)\" }}\n-        className=\"transition-all duration-500 relative md:ml-[2px] md:mr-[16px] md:my-[16px] md:rounded-[26px] bg-main-gradient w-full h-full overflow-y-scroll border-4 border-accent\"\n-      >\n-        {isMobile && <SidebarMobileHeader />}\n-        <div className=\"flex flex-col w-full px-1 md:px-20 md:py-12 py-16\">\n-          <div className=\"w-full flex flex-col gap-y-1 pb-6 border-white border-b-2 border-opacity-10\">\n-            <div className=\"items-center flex gap-x-4\">\n-              <p className=\"text-2xl font-semibold text-white\">\n-                Export or Import\n-              </p>\n-            </div>\n-            <p className=\"text-sm font-base text-white text-opacity-60\">\n-              Have multiple AnythingLLM instances or simply want to backup or\n-              re-import data from another instance? You can do so here.\n-            </p>\n-          </div>\n-          <div className=\"text-white text-sm font-medium py-4\">\n-            This will not automatically sync your vector database embeddings.\n-          </div>\n-          <ImportData />\n-          <ExportData />\n-        </div>\n-      </div>\n-    </div>\n-  );\n-}\n-\n-function ImportData() {\n-  const inputRef = useRef(null);\n-  const [loading, setLoading] = useState(false);\n-  const [file, setFile] = useState(null);\n-  const [result, setResult] = useState(null);\n-\n-  const startInput = () => inputRef?.current?.click();\n-  const handleUpload = async (e) => {\n-    setLoading(true);\n-    e.preventDefault();\n-    setFile(null);\n-    setResult(null);\n-\n-    const file = e.target.files?.[0];\n-    if (!file) {\n-      showToast(\"Invalid file upload\", \"error\");\n-      return false;\n-    }\n-\n-    setFile(file);\n-    setLoading(true);\n-    const formData = new FormData();\n-    formData.append(\"file\", file, file.name);\n-    const { success, error } = await System.importData(formData);\n-    if (!success) {\n-      showToast(`Failed to import data: ${error}`, \"error\");\n-    } else {\n-      setResult(true);\n-      showToast(`Successfully imported ${file.name}`, \"success\");\n-    }\n-\n-    setLoading(false);\n-    setFile(null);\n-  };\n-\n-  return (\n-    <div\n-      onClick={startInput}\n-      className=\"max-w-[600px] py-4 bg-zinc-900/50 rounded-2xl border-2 border-dashed border-white border-opacity-60 justify-center items-center inline-flex transition-all duration-300 hover:opacity-60 cursor-pointer\"\n-    >\n-      <div className=\"flex flex-col items-center justify-center\">\n-        {loading ? (\n-          <div className=\"flex items-center justify-center gap-2 animate-pulse\">\n-            <div className=\"text-white text-opacity-80 text-sm font-semibold py-1\">\n-              Importing\n-            </div>\n-            <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-solid border-white border-t-transparent \" />\n-          </div>\n-        ) : !!result ? (\n-          <div className=\"flex items-center justify-center gap-2\">\n-            <CloudArrowUp className=\"w-8 h-8 text-green-400\" />\n-            <div className=\"text-green-400 text-opacity-80 text-sm font-semibold py-1\">\n-              Import Successful\n-            </div>\n-          </div>\n-        ) : (\n-          <>\n-            <input\n-              ref={inputRef}\n-              onChange={handleUpload}\n-              name=\"import\"\n-              type=\"file\"\n-              multiple=\"false\"\n-              accept=\".zip\"\n-              hidden={true}\n-            />\n-            <div className=\"flex flex-col items-center justify-center\">\n-              <CloudArrowUp className=\"w-8 h-8 text-white/80\" />\n-              <div className=\"text-white text-opacity-80 text-sm font-semibold py-1\">\n-                Import AnythingLLM Data\n-              </div>\n-              <div className=\"text-white text-opacity-60 text-xs font-medium py-1\">\n-                This must be an export from an AnythingLLM instance.\n-              </div>\n-            </div>\n-          </>\n-        )}\n-      </div>\n-    </div>\n-  );\n-}\n-\n-function ExportData() {\n-  const [loading, setLoading] = useState(false);\n-  const [result, setResult] = useState(null);\n-\n-  const exportData = async function () {\n-    setLoading(true);\n-    const { filename, error } = await System.dataExport();\n-    setLoading(false);\n-\n-    if (!filename) {\n-      showToast(`Failed to export data: ${error}`, \"error\");\n-    } else {\n-      setResult(filename);\n-      const link = document.createElement(\"a\");\n-      link.href = `${API_BASE}/system/data-exports/${filename}`;\n-      link.target = \"_blank\";\n-      document.body.appendChild(link);\n-    }\n-  };\n-\n-  if (loading) {\n-    return (\n-      <button\n-        onClick={exportData}\n-        className=\"transition-all max-w-[600px] bg-white rounded-lg justify-center items-center my-8 text-zinc-900 border-transparent border-2 cursor-not-allowed animate-pulse\"\n-      >\n-        <div className=\"flex items-center justify-center gap-2\">\n-          <div className=\"duration-300 text-center text-sm font-bold py-3\">\n-            Exporting\n-          </div>\n-          <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-solid border-zinc-900 border-t-transparent \" />\n-        </div>\n-      </button>\n-    );\n-  }\n-\n-  if (!!result) {\n-    return (\n-      <a\n-        target=\"_blank\"\n-        href={`${API_BASE}/system/data-exports/${result}`}\n-        className=\"transition-all max-w-[600px] bg-green-100 hover:bg-zinc-900/50 hover:text-white hover:border-white rounded-lg justify-center items-center my-8 text-zinc-900 border-transparent border-2 cursor-pointer\"\n-      >\n-        <div className=\"flex items-center justify-center gap-2\">\n-          <div className=\"duration-300 text-center text-sm font-bold py-3\">\n-            Download Data Export\n-          </div>\n-          <DownloadSimple className=\"w-6 h-6\" />\n-        </div>\n-      </a>\n-    );\n-  }\n-\n-  return (\n-    <button\n-      onClick={exportData}\n-      className=\"transition-all max-w-[600px] bg-white rounded-lg justify-center items-center my-8 cursor-pointer text-zinc-900 border-transparent border-2 hover:bg-zinc-900/50 hover:text-white hover:border-white\"\n-    >\n-      <div className=\"duration-300 text-center text-sm font-bold py-3\">\n-        Export AnythingLLM Data\n-      </div>\n-    </button>\n-  );\n-}"
        },
        {
          "filename": "frontend/src/utils/paths.js",
          "status": "modified",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -56,9 +56,6 @@ export default {\n       return `/workspace/${slug}`;\n     },\n   },\n-  exports: () => {\n-    return `${API_BASE.replace(\"/api\", \"\")}/system/data-exports`;\n-  },\n   apiDocs: () => {\n     return `${API_BASE}/docs`;\n   },\n@@ -87,9 +84,6 @@ export default {\n     vectorDatabase: () => {\n       return \"/settings/vector-database\";\n     },\n-    exportImport: () => {\n-      return \"/settings/export-import\";\n-    },\n     security: () => {\n       return \"/settings/security\";\n     },"
        },
        {
          "filename": "server/endpoints/system.js",
          "status": "modified",
          "additions": 0,
          "deletions": 50,
          "patch": "@@ -2,7 +2,6 @@ process.env.NODE_ENV === \"development\"\n   ? require(\"dotenv\").config({ path: `.env.${process.env.NODE_ENV}` })\n   : require(\"dotenv\").config();\n const { viewLocalFiles, normalizePath } = require(\"../utils/files\");\n-const { exportData, unpackAndOverwriteImport } = require(\"../utils/files/data\");\n const {\n   checkProcessorAlive,\n   acceptedFileTypes,\n@@ -389,55 +388,6 @@ function systemEndpoints(app) {\n     }\n   });\n \n-  app.get(\n-    \"/system/data-export\",\n-    [validatedRequest, flexUserRoleValid],\n-    async (_, response) => {\n-      try {\n-        const { filename, error } = await exportData();\n-        response.status(200).json({ filename, error });\n-      } catch (e) {\n-        console.log(e.message, e);\n-        response.sendStatus(500).end();\n-      }\n-    }\n-  );\n-\n-  app.get(\"/system/data-exports/:filename\", (request, response) => {\n-    const exportLocation = __dirname + \"/../storage/exports/\";\n-    const sanitized = normalizePath(request.params.filename);\n-    const finalDestination = path.join(exportLocation, sanitized);\n-\n-    if (!fs.existsSync(finalDestination)) {\n-      response.status(404).json({\n-        error: 404,\n-        msg: `File ${request.params.filename} does not exist in exports.`,\n-      });\n-      return;\n-    }\n-\n-    response.download(finalDestination, request.params.filename, (err) => {\n-      if (err) {\n-        response.send({\n-          error: err,\n-          msg: \"Problem downloading the file\",\n-        });\n-      }\n-      // delete on download because endpoint is not authenticated.\n-      fs.rmSync(finalDestination);\n-    });\n-  });\n-\n-  app.post(\n-    \"/system/data-import\",\n-    handleImports.single(\"file\"),\n-    async function (request, response) {\n-      const { originalname } = request.file;\n-      const { success, error } = await unpackAndOverwriteImport(originalname);\n-      response.status(200).json({ success, error });\n-    }\n-  );\n-\n   app.get(\"/system/logo\", async function (request, response) {\n     try {\n       const defaultFilename = getDefaultFilename();"
        },
        {
          "filename": "server/index.js",
          "status": "modified",
          "additions": 0,
          "deletions": 6,
          "patch": "@@ -4,7 +4,6 @@ process.env.NODE_ENV === \"development\"\n \n const express = require(\"express\");\n const bodyParser = require(\"body-parser\");\n-const serveIndex = require(\"serve-index\");\n const cors = require(\"cors\");\n const path = require(\"path\");\n const { reqBody } = require(\"./utils/http\");\n@@ -85,11 +84,6 @@ if (process.env.NODE_ENV !== \"development\") {\n   });\n }\n \n-app.use(\n-  \"/system/data-exports\",\n-  serveIndex(__dirname + \"/storage/exports\", { icons: true })\n-);\n-\n app.all(\"*\", function (_, response) {\n   response.sendStatus(404);\n });"
        },
        {
          "filename": "server/package.json",
          "status": "modified",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -52,7 +52,6 @@\n     \"pinecone-client\": \"^1.1.0\",\n     \"posthog-node\": \"^3.1.1\",\n     \"prisma\": \"^5.3.1\",\n-    \"serve-index\": \"^1.9.1\",\n     \"slugify\": \"^1.6.6\",\n     \"sqlite\": \"^4.2.1\",\n     \"sqlite3\": \"^5.1.6\","
        },
        {
          "filename": "server/utils/files/data.js",
          "status": "removed",
          "additions": 0,
          "deletions": 197,
          "patch": "@@ -1,197 +0,0 @@\n-const fs = require(\"fs\");\n-const path = require(\"path\");\n-const { v4 } = require(\"uuid\");\n-\n-async function exportData() {\n-  const uid = `anythingllm-export-${new Date()\n-    .toJSON()\n-    .slice(0, 10)}-${new Date().toJSON().slice(11, 19)}`;\n-  const folder =\n-    process.env.NODE_ENV === \"development\"\n-      ? path.resolve(__dirname, `../../storage/exports/${uid}`)\n-      : path.resolve(process.env.STORAGE_DIR, `exports/${uid}`);\n-  const storageBase =\n-    process.env.NODE_ENV === \"development\"\n-      ? path.resolve(__dirname, `../../storage`)\n-      : path.resolve(process.env.STORAGE_DIR);\n-\n-  try {\n-    fs.mkdirSync(folder, { recursive: true });\n-    if (fs.existsSync(path.resolve(storageBase, `documents`))) {\n-      console.log(\"\\x1b[34m[EXPORTING DATA]\\x1b[0m Copying documents!\");\n-      fs.cpSync(\n-        path.resolve(storageBase, `documents`),\n-        path.resolve(folder, \"documents\"),\n-        { recursive: true }\n-      );\n-    }\n-\n-    if (fs.existsSync(path.resolve(storageBase, `lancedb`))) {\n-      console.log(\"\\x1b[34m[EXPORTING DATA]\\x1b[0m Copying LanceDB data!\");\n-      fs.cpSync(\n-        path.resolve(storageBase, `lancedb`),\n-        path.resolve(folder, \"lancedb\"),\n-        { recursive: true }\n-      );\n-    }\n-\n-    if (fs.existsSync(path.resolve(storageBase, `vector-cache`))) {\n-      console.log(\"\\x1b[34m[EXPORTING DATA]\\x1b[0m Copying vector cache!\");\n-      fs.cpSync(\n-        path.resolve(storageBase, `vector-cache`),\n-        path.resolve(folder, \"vector-cache\"),\n-        { recursive: true }\n-      );\n-    }\n-\n-    if (fs.existsSync(path.resolve(storageBase, `anythingllm.db`))) {\n-      console.log(\n-        \"\\x1b[34m[EXPORTING DATA]\\x1b[0m Copying anythingllm database!\"\n-      );\n-      fs.cpSync(\n-        path.resolve(storageBase, `anythingllm.db`),\n-        path.resolve(folder, \"anythingllm.db\")\n-      );\n-    }\n-\n-    await zipDirectory(folder, path.resolve(folder, `../${uid}.zip`));\n-    fs.rmSync(folder, { recursive: true, force: true });\n-    return { filename: `${uid}.zip`, error: null };\n-  } catch (e) {\n-    // If anything goes wrong - abort and clean up\n-    console.error(e);\n-    if (fs.existsSync(folder))\n-      fs.rmSync(folder, { recursive: true, force: true });\n-    return { filename: null, error: e.message };\n-  }\n-}\n-\n-async function unpackAndOverwriteImport(importFilename) {\n-  const importFilepath =\n-    process.env.NODE_ENV === \"development\"\n-      ? path.resolve(__dirname, `../../storage/imports/${importFilename}`)\n-      : path.resolve(process.env.STORAGE_DIR, `imports/${importFilename}`);\n-  if (!fs.existsSync(importFilepath))\n-    return { success: false, error: \"Import file does not exist.\" };\n-\n-  const uid = v4();\n-  const outDir =\n-    process.env.NODE_ENV === \"development\"\n-      ? path.resolve(__dirname, `../../storage/imports/${uid}`)\n-      : path.resolve(process.env.STORAGE_DIR, `imports/${uid}`);\n-\n-  const storageBase =\n-    process.env.NODE_ENV === \"development\"\n-      ? path.resolve(__dirname, `../../storage`)\n-      : path.resolve(process.env.STORAGE_DIR);\n-\n-  try {\n-    console.log(\n-      \"\\x1b[34m[EXTRACTING DATA]\\x1b[0m Extracting data from zip into storage!\"\n-    );\n-    const unzipProc = await unzipDirectory(importFilepath, outDir);\n-    if (!unzipProc.success) return unzipProc;\n-\n-    if (fs.existsSync(path.resolve(outDir, `documents`))) {\n-      console.log(\n-        \"\\x1b[34m[OVERWRITE & IMPORT DATA]\\x1b[0m Importing documents!\"\n-      );\n-      if (fs.existsSync(path.resolve(storageBase, `documents`)))\n-        fs.rmSync(path.resolve(storageBase, `documents`), {\n-          recursive: true,\n-          force: true,\n-        });\n-      fs.cpSync(\n-        path.resolve(outDir, `documents`),\n-        path.resolve(storageBase, \"documents\"),\n-        { recursive: true }\n-      );\n-    }\n-\n-    if (fs.existsSync(path.resolve(outDir, `lancedb`))) {\n-      console.log(\n-        \"\\x1b[34m[OVERWRITE & IMPORT DATA]\\x1b[0m Importing LanceDb!\"\n-      );\n-      if (fs.existsSync(path.resolve(storageBase, `lancedb`)))\n-        fs.rmSync(path.resolve(storageBase, `lancedb`), {\n-          recursive: true,\n-          force: true,\n-        });\n-      fs.cpSync(\n-        path.resolve(outDir, `lancedb`),\n-        path.resolve(storageBase, \"lancedb\"),\n-        { recursive: true }\n-      );\n-    }\n-\n-    if (fs.existsSync(path.resolve(outDir, `vector-cache`))) {\n-      console.log(\n-        \"\\x1b[34m[OVERWRITE & IMPORT DATA]\\x1b[0m Importing Vector Cache!\"\n-      );\n-      if (fs.existsSync(path.resolve(storageBase, `vector-cache`)))\n-        fs.rmSync(path.resolve(storageBase, `vector-cache`), {\n-          recursive: true,\n-          force: true,\n-        });\n-      fs.cpSync(\n-        path.resolve(outDir, `vector-cache`),\n-        path.resolve(storageBase, \"vector-cache\"),\n-        { recursive: true }\n-      );\n-    }\n-\n-    if (fs.existsSync(path.resolve(outDir, `anythingllm.db`))) {\n-      console.log(\n-        \"\\x1b[34m[OVERWRITE & IMPORT DATA]\\x1b[0m Importing AnythingLLM DB!\"\n-      );\n-      if (fs.existsSync(path.resolve(storageBase, `anythingllm.db`)))\n-        fs.rmSync(path.resolve(storageBase, `anythingllm.db`), { force: true });\n-      fs.cpSync(\n-        path.resolve(outDir, `anythingllm.db`),\n-        path.resolve(storageBase, \"anythingllm.db\")\n-      );\n-    }\n-\n-    fs.rmSync(outDir, { recursive: true, force: true });\n-    fs.rmSync(importFilepath, { force: true });\n-    return { success: true, error: null };\n-  } catch (e) {\n-    console.error(e);\n-    if (fs.existsSync(outDir))\n-      fs.rmSync(outDir, { recursive: true, force: true });\n-    if (fs.existsSync(importFilepath)) fs.rmSync(importFilepath);\n-    return { success: false, error: e.message };\n-  }\n-}\n-\n-function zipDirectory(sourceDir, outPath) {\n-  const archiver = require(\"archiver\");\n-  const archive = archiver(\"zip\", { zlib: { level: 9 } });\n-  const stream = fs.createWriteStream(outPath);\n-\n-  return new Promise((resolve, reject) => {\n-    archive\n-      .directory(sourceDir, false)\n-      .on(\"error\", (err) => reject(err))\n-      .pipe(stream);\n-\n-    stream.on(\"close\", () => resolve());\n-    archive.finalize();\n-  });\n-}\n-\n-async function unzipDirectory(sourcePath, outDir) {\n-  const extract = require(\"extract-zip\");\n-  try {\n-    await extract(sourcePath, { dir: outDir });\n-    return { success: true, error: null };\n-  } catch (e) {\n-    console.error(\"unzipToDirectory\", e);\n-    return { success: false, error: e.message };\n-  }\n-}\n-\n-module.exports = {\n-  exportData,\n-  unpackAndOverwriteImport,\n-};"
        },
        {
          "filename": "server/yarn.lock",
          "status": "modified",
          "additions": 3,
          "deletions": 51,
          "patch": "@@ -891,7 +891,7 @@ abort-controller@^3.0.0:\n   dependencies:\n     event-target-shim \"^5.0.0\"\n \n-accepts@~1.3.4, accepts@~1.3.8:\n+accepts@~1.3.8:\n   version \"1.3.8\"\n   resolved \"https://registry.yarnpkg.com/accepts/-/accepts-1.3.8.tgz#0bf0be125b67014adcb0b0921e62db7bffe16b2e\"\n   integrity sha512-PYAthTa2m2VKxuvSD3DPC/Gy+U+sOA1LAuT8mkmRuvw+NACSaeXEQ+NHcVF7rONl6qcaxV3Uuemwawk+7+SJLw==\n@@ -1226,11 +1226,6 @@ base64-js@^1.3.0, base64-js@^1.3.1, base64-js@^1.5.1:\n   resolved \"https://registry.yarnpkg.com/base64-js/-/base64-js-1.5.1.tgz#1b1b440160a5bf7ad40b650f095963481903930a\"\n   integrity sha512-AKpaYlHn8t4SVbOHCy+b5+KKgvR4vrsD8vbvrbiQJps7fKDTkjkDry6ji0rUJjC0kzbNePLwzxq8iypo41qeWA==\n \n-batch@0.6.1:\n-  version \"0.6.1\"\n-  resolved \"https://registry.yarnpkg.com/batch/-/batch-0.6.1.tgz#dc34314f4e679318093fc760272525f94bf25c16\"\n-  integrity sha512-x+VAiMRL6UPkx+kudNvxTl6hB2XNNCG2r+7wixVfIYwu/2HKRXimwQyaumLjMveWvT2Hkd/cAJw+QBMfJ/EKVw==\n-\n bcrypt@^5.1.0:\n   version \"5.1.0\"\n   resolved \"https://registry.yarnpkg.com/bcrypt/-/bcrypt-5.1.0.tgz#bbb27665dbc400480a524d8991ac7434e8529e17\"\n@@ -1855,11 +1850,6 @@ depd@2.0.0, depd@^2.0.0:\n   resolved \"https://registry.yarnpkg.com/depd/-/depd-2.0.0.tgz#b696163cc757560d09cf22cc8fad1571b79e76df\"\n   integrity sha512-g7nH6P6dyDioJogAAGprGpCtVImJhpPk/roCzdb3fIh61/s/nPsfR6onyMwkCAR/OlC3yBC0lESvUoQEAssIrw==\n \n-depd@~1.1.2:\n-  version \"1.1.2\"\n-  resolved \"https://registry.yarnpkg.com/depd/-/depd-1.1.2.tgz#9bcd52e14c097763e749b274c4346ed2e560b5a9\"\n-  integrity sha512-7emPTl6Dpo6JRXOXjLRxck+FlLRX5847cLKEn00PLAgc3g2hTZZgr+e4c2v6QpSmLeFP3n5yUo7ft6avBK/5jQ==\n-\n deprecation@^2.0.0, deprecation@^2.3.1:\n   version \"2.3.1\"\n   resolved \"https://registry.yarnpkg.com/deprecation/-/deprecation-2.3.1.tgz#6368cbdb40abf3373b525ac87e4a260c3a700919\"\n@@ -2895,16 +2885,6 @@ http-errors@2.0.0:\n     statuses \"2.0.1\"\n     toidentifier \"1.0.1\"\n \n-http-errors@~1.6.2:\n-  version \"1.6.3\"\n-  resolved \"https://registry.yarnpkg.com/http-errors/-/http-errors-1.6.3.tgz#8b55680bb4be283a0b5bf4ea2e38580be1d9320d\"\n-  integrity sha512-lks+lVC8dgGyh97jxvxeYTWQFvh4uw4yC12gVl63Cg30sjPX4wuGcdkICVXDAESr6OJGjqGA8Iz5mkeN6zlD7A==\n-  dependencies:\n-    depd \"~1.1.2\"\n-    inherits \"2.0.3\"\n-    setprototypeof \"1.1.0\"\n-    statuses \">= 1.4.0 < 2\"\n-\n http-proxy-agent@^4.0.1:\n   version \"4.0.1\"\n   resolved \"https://registry.yarnpkg.com/http-proxy-agent/-/http-proxy-agent-4.0.1.tgz#8a8c8ef7f5932ccf953c296ca8291b95aa74aa3a\"\n@@ -3003,11 +2983,6 @@ inherits@2, inherits@2.0.4, inherits@^2.0.3, inherits@^2.0.4, inherits@~2.0.3:\n   resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.4.tgz#0fa2c64f932917c3433a0ded55363aae37416b7c\"\n   integrity sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==\n \n-inherits@2.0.3:\n-  version \"2.0.3\"\n-  resolved \"https://registry.yarnpkg.com/inherits/-/inherits-2.0.3.tgz#633c2c83e3da42a502f52466022480f4208261de\"\n-  integrity sha512-x00IRNXNy63jwGkJmzPigoySHbaqpNuzKbBOmzK+g2OdZpQ9w+sxCN+VSB3ja7IAge2OP2qpfxTjeNcyjmW1uw==\n-\n ini@~1.3.0:\n   version \"1.3.8\"\n   resolved \"https://registry.yarnpkg.com/ini/-/ini-1.3.8.tgz#a29da425b48806f34767a4efce397269af28432c\"\n@@ -3725,7 +3700,7 @@ mime-db@1.52.0:\n   resolved \"https://registry.yarnpkg.com/mime-db/-/mime-db-1.52.0.tgz#bbabcdc02859f4987301c856e3387ce5ec43bf70\"\n   integrity sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==\n \n-mime-types@^2.1.12, mime-types@~2.1.17, mime-types@~2.1.24, mime-types@~2.1.34:\n+mime-types@^2.1.12, mime-types@~2.1.24, mime-types@~2.1.34:\n   version \"2.1.35\"\n   resolved \"https://registry.yarnpkg.com/mime-types/-/mime-types-2.1.35.tgz#381a871b62a734450660ae3deee44813f70d959a\"\n   integrity sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==\n@@ -4341,7 +4316,7 @@ parent-module@^1.0.0:\n   dependencies:\n     callsites \"^3.0.0\"\n \n-parseurl@~1.3.2, parseurl@~1.3.3:\n+parseurl@~1.3.3:\n   version \"1.3.3\"\n   resolved \"https://registry.yarnpkg.com/parseurl/-/parseurl-1.3.3.tgz#9da19e7bee8d12dff0513ed5b76957793bc2e8d4\"\n   integrity sha512-CiyeOxFT/JZyN5m0z9PfXw4SCBJ6Sygz1Dpl0wqjlhDEGGBP1GnsUVEL0p63hoG1fcj3fHynXi9NYO4nWOL+qQ==\n@@ -4835,19 +4810,6 @@ send@0.18.0:\n     range-parser \"~1.2.1\"\n     statuses \"2.0.1\"\n \n-serve-index@^1.9.1:\n-  version \"1.9.1\"\n-  resolved \"https://registry.yarnpkg.com/serve-index/-/serve-index-1.9.1.tgz#d3768d69b1e7d82e5ce050fff5b453bea12a9239\"\n-  integrity sha512-pXHfKNP4qujrtteMrSBb0rc8HJ9Ms/GrXwcUtUtD5s4ewDJI8bT3Cz2zTVRMKtri49pLx2e0Ya8ziP5Ya2pZZw==\n-  dependencies:\n-    accepts \"~1.3.4\"\n-    batch \"0.6.1\"\n-    debug \"2.6.9\"\n-    escape-html \"~1.0.3\"\n-    http-errors \"~1.6.2\"\n-    mime-types \"~2.1.17\"\n-    parseurl \"~1.3.2\"\n-\n serve-static@1.15.0:\n   version \"1.15.0\"\n   resolved \"https://registry.yarnpkg.com/serve-static/-/serve-static-1.15.0.tgz#faaef08cffe0a1a62f60cad0c4e513cff0ac9540\"\n@@ -4882,11 +4844,6 @@ set-function-name@^2.0.0, set-function-name@^2.0.1:\n     functions-have-names \"^1.2.3\"\n     has-property-descriptors \"^1.0.0\"\n \n-setprototypeof@1.1.0:\n-  version \"1.1.0\"\n-  resolved \"https://registry.yarnpkg.com/setprototypeof/-/setprototypeof-1.1.0.tgz#d0bd85536887b6fe7c0d818cb962d9d91c54e656\"\n-  integrity sha512-BvE/TwpZX4FXExxOxZyRGQQv651MSwmWKZGqvmPcRIjDqWub67kTKuIMx43cZZrS/cBBzwBcNDWoFxt2XEFIpQ==\n-\n setprototypeof@1.2.0:\n   version \"1.2.0\"\n   resolved \"https://registry.yarnpkg.com/setprototypeof/-/setprototypeof-1.2.0.tgz#66c9a24a73f9fc28cbe66b09fed3d33dcaf1b424\"\n@@ -5029,11 +4986,6 @@ statuses@2.0.1:\n   resolved \"https://registry.yarnpkg.com/statuses/-/statuses-2.0.1.tgz#55cb000ccf1d48728bd23c685a063998cf1a1b63\"\n   integrity sha512-RwNA9Z/7PrK06rYLIzFMlaF+l73iwpzsqRIFgbMLbTcLD6cOao82TaWefPXQvB2fOC4AjuYSEndS7N/mTCbkdQ==\n \n-\"statuses@>= 1.4.0 < 2\":\n-  version \"1.5.0\"\n-  resolved \"https://registry.yarnpkg.com/statuses/-/statuses-1.5.0.tgz#161c7dac177659fd9811f43771fa99381478628c\"\n-  integrity sha512-OpZ3zP+jT1PI7I8nemJX4AKmAX070ZkYPVWV/AaKTJl+tXCTGyVdC1a4SL8RUQYEwk/f34ZX8UTykN68FwrqAA==\n-\n stdin-discarder@^0.1.0:\n   version \"0.1.0\"\n   resolved \"https://registry.yarnpkg.com/stdin-discarder/-/stdin-discarder-0.1.0.tgz#22b3e400393a8e28ebf53f9958f3880622efde21\""
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 3,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 8,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "21af81085aeb049750942ac5f3b84775cb461693",
            "date": "2025-01-13T21:12:03Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "665e8e5bfe431ad93bed6736d0b450592617d042",
            "date": "2025-01-09T23:39:56Z",
            "author_login": "shatfield4"
          },
          {
            "sha": "865f7eea296e544b2eb1ab8c1f322208eaf5eb05",
            "date": "2025-01-09T21:32:54Z",
            "author_login": "timothycarambat"
          },
          {
            "sha": "be886f7d61296a30d5b8a095ca8329f58a0c5a0a",
            "date": "2025-01-09T01:21:30Z",
            "author_login": "root-reindeer-flotilla"
          },
          {
            "sha": "487db896c1ce1442e02f7098ad6974ee60b76073",
            "date": "2025-01-07T23:53:34Z",
            "author_login": "timothycarambat"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-284",
    "description": "An improper access control vulnerability exists in the mintplex-labs/anything-llm application, specifically within the import endpoint. This vulnerability allows an anonymous attacker, without an account in the application, to import their own database file, leading to the deletion or spoofing of the existing `anythingllm.db` file. By exploiting this vulnerability, attackers can serve malicious data to users or collect information about them. The vulnerability stems from the application's failure to properly restrict access to the data-import functionality, allowing unauthorized database manipulation.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-08-12T13:38:26.990",
    "last_modified": "2024-08-12T13:41:36.517",
    "fix_date": "2024-01-18T21:57:23Z"
  },
  "references": [
    {
      "url": "https://github.com/mintplex-labs/anything-llm/commit/08d33cfd8fc47c5052b6ea29597c964a9da641e2",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/303c5145-2c14-4945-914a-936be74dd04e",
      "source": "security@huntr.dev",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.545467",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "anything-llm",
    "owner": "mintplex-labs",
    "created_at": "2023-06-04T02:29:14Z",
    "updated_at": "2025-01-14T13:49:57Z",
    "pushed_at": "2025-01-13T21:12:06Z",
    "size": 42916,
    "stars": 30237,
    "forks": 3030,
    "open_issues": 206,
    "watchers": 30237,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3056909,
      "CSS": 73785,
      "Dockerfile": 9030,
      "HTML": 3904,
      "Shell": 1382,
      "HCL": 1211
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:04:33.088245"
  }
}