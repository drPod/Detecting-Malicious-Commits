{
  "cve_id": "CVE-2024-32879",
  "github_data": {
    "repository": "python-social-auth/social-app-django",
    "fix_commit": "31c3e0c7edb187004d8abbde7e9c4f7ef9098138",
    "related_commits": [
      "31c3e0c7edb187004d8abbde7e9c4f7ef9098138",
      "31c3e0c7edb187004d8abbde7e9c4f7ef9098138"
    ],
    "patch_url": "https://github.com/python-social-auth/social-app-django/commit/31c3e0c7edb187004d8abbde7e9c4f7ef9098138.patch",
    "fix_commit_details": {
      "sha": "31c3e0c7edb187004d8abbde7e9c4f7ef9098138",
      "commit_date": "2024-04-24T08:26:58Z",
      "author": {
        "login": "nijel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "models: make sure uid is compared case-sensitive",
        "length": 118,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 9,
        "deletions": 5
      },
      "files": [
        {
          "filename": "social_django/models.py",
          "status": "modified",
          "additions": 9,
          "deletions": 5,
          "patch": "@@ -54,11 +54,15 @@ class Meta:\n         abstract = True\n \n     @classmethod\n-    def get_social_auth(cls, provider, uid):\n-        try:\n-            return cls.objects.select_related(\"user\").get(provider=provider, uid=uid)\n-        except cls.DoesNotExist:\n-            return None\n+    def get_social_auth(cls, provider: str, uid: str):\n+        for social in cls.objects.select_related(\"user\").filter(\n+            provider=provider, uid=uid\n+        ):\n+            # We need to compare to filter out case-insensitive lookups in\n+            # some databases (MySQL/MariaDB)\n+            if social.uid == uid:\n+                return social\n+        return None\n \n     @classmethod\n     def username_max_length(cls):"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ce1073d49a148fc98b2d2093a5598c6a02bb6558",
            "date": "2025-01-11T17:13:37Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "35427f9313118d32a2f7cb10d2242b143a073032",
            "date": "2025-01-10T14:39:55Z",
            "author_login": "nijel"
          },
          {
            "sha": "8677f38be81cc9e5b898cee71b660ba13dbfd76c",
            "date": "2025-01-10T14:13:48Z",
            "author_login": "nijel"
          },
          {
            "sha": "a3bc00170e58e0be4fa77e431a006c643f8187f9",
            "date": "2025-01-10T14:08:46Z",
            "author_login": "nijel"
          },
          {
            "sha": "e8b74ba59b43910f429eeff1faac80d1e4364de0",
            "date": "2025-01-10T14:07:31Z",
            "author_login": "nijel"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-178",
    "description": "Python Social Auth is a social authentication/registration mechanism. Prior to version 5.4.1, due to default case-insensitive collation in MySQL or MariaDB databases, third-party authentication user IDs are not case-sensitive and could cause different IDs to match. This issue has been addressed by a fix released in version 5.4.1. An immediate workaround would be to change collation of the affected field.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-04-24T20:15:07.867",
    "last_modified": "2024-11-21T09:15:55.503",
    "fix_date": "2024-04-24T08:26:58Z"
  },
  "references": [
    {
      "url": "https://github.com/python-social-auth/social-app-django/commit/31c3e0c7edb187004d8abbde7e9c4f7ef9098138",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/python-social-auth/social-app-django/pull/566",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/python-social-auth/social-app-django/security/advisories/GHSA-2gr8-3wc7-xhj3",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/python-social-auth/social-app-django/commit/31c3e0c7edb187004d8abbde7e9c4f7ef9098138",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/python-social-auth/social-app-django/pull/566",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/python-social-auth/social-app-django/security/advisories/GHSA-2gr8-3wc7-xhj3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:07.018412",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "social-app-django",
    "owner": "python-social-auth",
    "created_at": "2016-09-24T18:06:40Z",
    "updated_at": "2025-01-13T14:15:22Z",
    "pushed_at": "2025-01-11T17:13:39Z",
    "size": 2523,
    "stars": 2048,
    "forks": 382,
    "open_issues": 130,
    "watchers": 2048,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 77521,
      "HTML": 5
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T14:05:01.570947"
  }
}