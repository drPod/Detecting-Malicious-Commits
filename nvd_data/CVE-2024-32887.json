{
  "cve_id": "CVE-2024-32887",
  "github_data": {
    "repository": "sidekiq/sidekiq",
    "fix_commit": "30786e082c70349ab27ffa9eccc42fb0c696164d",
    "related_commits": [
      "30786e082c70349ab27ffa9eccc42fb0c696164d",
      "30786e082c70349ab27ffa9eccc42fb0c696164d"
    ],
    "patch_url": "https://github.com/sidekiq/sidekiq/commit/30786e082c70349ab27ffa9eccc42fb0c696164d.patch",
    "fix_commit_details": {
      "sha": "30786e082c70349ab27ffa9eccc42fb0c696164d",
      "commit_date": "2024-04-26T20:44:52Z",
      "author": {
        "login": "mperham",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix for CVE-2024-32887",
        "length": 22,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
      },
      "files": [
        {
          "filename": "Changes.md",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -2,6 +2,12 @@\n \n [Sidekiq Changes](https://github.com/sidekiq/sidekiq/blob/main/Changes.md) | [Sidekiq Pro Changes](https://github.com/sidekiq/sidekiq/blob/main/Pro-Changes.md) | [Sidekiq Enterprise Changes](https://github.com/sidekiq/sidekiq/blob/main/Ent-Changes.md)\n \n+7.2.4\n+----------\n+\n+- Fix XSS in metrics filtering introduced in 7.2.0, CVE-2024-32887\n+  Thanks to @UmerAdeemCheema for the security report.\n+\n 7.2.3\n ----------\n "
        },
        {
          "filename": "lib/sidekiq/version.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n # frozen_string_literal: true\n \n module Sidekiq\n-  VERSION = \"7.2.3\"\n+  VERSION = \"7.2.4\"\n   MAJOR = 7\n end"
        },
        {
          "filename": "web/views/metrics.erb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n     <form id=\"metrics-form\" class=\"form-inline\" action=\"<%= root_path %>filter/metrics\" method=\"post\">\n       <%= csrf_tag %>\n       <label for=\"substr\"><%= t('Filter') %></label>\n-      <input id=\"class-filter\" class=\"form-control\" type=\"text\" name=\"substr\" placeholder=\"<%= t('Name') %>\" value=\"<%= params[:substr] %>\">\n+      <input id=\"class-filter\" class=\"form-control\" type=\"text\" name=\"substr\" placeholder=\"<%= t('Name') %>\" value=\"<%= h params[:substr] %>\">\n       <select id=\"period-selector\" class=\"form-control\" name=\"period\">\n         <% @periods.each_key do |code| %>\n           <% if code == @period %>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c24525bc2aab8ce41c4767cd70410c4b27e0b132",
            "date": "2025-01-13T23:42:25Z",
            "author_login": "tomprats"
          },
          {
            "sha": "2ae94cef5f30623801369e7dd344891248aa90c2",
            "date": "2025-01-13T21:32:22Z",
            "author_login": "mperham"
          },
          {
            "sha": "0132dd122604b650dfb949461f199c44167efbcb",
            "date": "2025-01-13T18:57:21Z",
            "author_login": "mperham"
          },
          {
            "sha": "9d9da2fca6428b8661eb16731d67f8cc77ed4bba",
            "date": "2025-01-08T23:08:35Z",
            "author_login": "mperham"
          },
          {
            "sha": "510928fc74c00b98e3c9f4b9e063b17dd26c2935",
            "date": "2025-01-08T22:30:45Z",
            "author_login": "mperham"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "Sidekiq is simple, efficient background processing for Ruby. Sidekiq is reflected XSS vulnerability. The value of substr parameter is reflected in the response without any encoding, allowing an attacker to inject Javascript code into the response of the application.  An attacker could exploit it to target users of the Sidekiq Web UI. Moreover, if other applications are deployed on the same domain or website as Sidekiq, users of those applications could also be affected, leading to a broader scope of compromise. Potentially compromising their accounts, forcing the users to perform sensitive actions, stealing sensitive data, performing CORS attacks, defacement of the web application, etc. This issue has been patched in version 7.2.4.\n\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-26T21:15:49.820",
    "last_modified": "2024-11-21T09:15:56.457",
    "fix_date": "2024-04-26T20:44:52Z"
  },
  "references": [
    {
      "url": "https://github.com/sidekiq/sidekiq/commit/30786e082c70349ab27ffa9eccc42fb0c696164d",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/sidekiq/sidekiq/releases/tag/v7.2.4",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/sidekiq/sidekiq/security/advisories/GHSA-q655-3pj8-9fxq",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/sidekiq/sidekiq/commit/30786e082c70349ab27ffa9eccc42fb0c696164d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/sidekiq/sidekiq/releases/tag/v7.2.4",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/sidekiq/sidekiq/security/advisories/GHSA-q655-3pj8-9fxq",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:07.028997",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "sidekiq",
    "owner": "sidekiq",
    "created_at": "2012-01-16T23:17:27Z",
    "updated_at": "2025-01-14T14:47:19Z",
    "pushed_at": "2025-01-13T23:42:25Z",
    "size": 14173,
    "stars": 13213,
    "forks": 2427,
    "open_issues": 37,
    "watchers": 13213,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Ruby": 572329,
      "HTML": 40875,
      "JavaScript": 18499,
      "CSS": 17084,
      "Procfile": 125
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T15:33:45.328718"
  }
}