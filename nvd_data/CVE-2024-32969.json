{
  "cve_id": "CVE-2024-32969",
  "github_data": {
    "repository": "vantage6/vantage6",
    "fix_commit": "27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56",
    "related_commits": [
      "27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56",
      "27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56"
    ],
    "patch_url": "https://github.com/vantage6/vantage6/commit/27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56.patch",
    "fix_commit_details": {
      "sha": "27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56",
      "commit_date": "2024-05-22T14:31:52Z",
      "author": {
        "login": "bartvanb",
        "type": "User",
        "stats": {
          "total_commits": 2387,
          "average_weekly_commits": 5.836185819070905,
          "total_additions": 373633,
          "total_deletions": 328316,
          "weeks_active": 155
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-99r4-cjp4-3hmx",
        "length": 100,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 11,
        "deletions": 0
      },
      "files": [
        {
          "filename": "vantage6-server/vantage6/server/resource/collaboration.py",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -543,6 +543,17 @@ def patch(self, id):\n                 }, HTTPStatus.BAD_REQUEST\n             collaboration.name = name\n         if \"organization_ids\" in data:\n+            # Users with permission to edit a collaboration at collaboration scope are\n+            # not allowed to change the organizations of the collaboration: that would\n+            # be a permission escalation as doing so may allow them to also do other\n+            # actions for newly added organizations. Therefore, only users with global\n+            # permission can alter the organizations in a collaboration.\n+            if not self.r.e_glo.can():\n+                return {\n+                    \"msg\": \"You lack the permission to change the organizations of a \"\n+                    \"collaboration!\"\n+                }, HTTPStatus.UNAUTHORIZED\n+            # set new organizations\n             collaboration.organizations = [\n                 db.Organization.get(org_id)\n                 for org_id in data[\"organization_ids\"]"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7e08264dea67e84b35594893953001e8ea147d90",
            "date": "2025-01-09T16:31:08Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "c30ae94a7a4e5fda8eee9a937b26ff46c029109d",
            "date": "2024-12-13T09:10:55Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "7467646f458f773d0ee6aae6803682e1752a13f7",
            "date": "2024-12-13T08:54:45Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "4100ab5536ed2a5c675d6593cbebd8d98b4e5e14",
            "date": "2024-12-13T08:30:46Z",
            "author_login": "bartvanb"
          },
          {
            "sha": "943a486a2e61185642fa75a0f55d24b776048838",
            "date": "2024-12-13T08:21:53Z",
            "author_login": "invalid-email-address"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 2.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-284",
    "description": "vantage6 is an open-source infrastructure for privacy preserving analysis. Collaboration administrators can add extra organizations to their collaboration that can extend their influence. For example, organizations that they include can then create new users for which they know the passwords, and use that to read task results of other collaborations that that organization is involved in.  This is only relatively trusted users - with access to manage a collaboration - are able to do this, which reduces the impact. This vulnerability was patched in version 4.5.0rc3.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-23T09:15:09.350",
    "last_modified": "2024-11-21T09:16:08.023",
    "fix_date": "2024-05-22T14:31:52Z"
  },
  "references": [
    {
      "url": "https://github.com/vantage6/vantage6/commit/27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-99r4-cjp4-3hmx",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/vantage6/vantage6/commit/27f4ee3fade5f4cbcf3e60899c9a2a91145e0b56",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/vantage6/vantage6/security/advisories/GHSA-99r4-cjp4-3hmx",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:24.280317",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "vantage6",
    "owner": "vantage6",
    "created_at": "2022-05-16T12:09:26Z",
    "updated_at": "2025-01-09T16:31:14Z",
    "pushed_at": "2025-01-14T13:14:06Z",
    "size": 44880,
    "stars": 31,
    "forks": 11,
    "open_issues": 248,
    "watchers": 31,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 1919355,
      "TypeScript": 526976,
      "HTML": 209327,
      "SCSS": 20209,
      "Makefile": 12871,
      "Dockerfile": 9054,
      "Jinja": 5974,
      "Shell": 4282,
      "JavaScript": 802
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:50:50.846103"
  }
}