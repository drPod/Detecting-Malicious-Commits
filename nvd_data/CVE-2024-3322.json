{
  "cve_id": "CVE-2024-3322",
  "github_data": {
    "repository": "parisneo/lollms-webui",
    "fix_commit": "1e17df01e01d4d33599db2afaafe91d90b6f0189",
    "related_commits": [
      "1e17df01e01d4d33599db2afaafe91d90b6f0189",
      "1e17df01e01d4d33599db2afaafe91d90b6f0189"
    ],
    "patch_url": "https://github.com/parisneo/lollms-webui/commit/1e17df01e01d4d33599db2afaafe91d90b6f0189.patch",
    "fix_commit_details": {
      "sha": "1e17df01e01d4d33599db2afaafe91d90b6f0189",
      "commit_date": "2024-04-04T16:20:24Z",
      "author": {
        "login": "ParisNeo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Enhanced",
        "length": 8,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 37,
        "additions": 21,
        "deletions": 16
      },
      "files": [
        {
          "filename": "lollms_core",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Subproject commit 5f406b9bbdc1b7c4ed7145090044514e3a684544\n+Subproject commit f4424cfc3d6dfb3ad5ac17dd46801efe784933e9"
        },
        {
          "filename": "tests/pentests/test_sanitize/test.py",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -4,6 +4,8 @@\n import re\n import pytest\n def sanitize_path_from_endpoint(path: str, error_text=\"A suspected LFI attack detected. The path sent to the server has suspicious elements in it!\", exception_text=\"Invalid path!\"):\n+    if path.strip().startswith(\"/\"):\n+        raise HTTPException(status_code=400, detail=exception_text)\n     # Fix the case of \"/\" at the beginning on the path\n     if path is None:\n         return path\n@@ -25,7 +27,9 @@ def test_sanitize_path_from_endpoint():\n     assert sanitize_path_from_endpoint(valid_path) == \"example/path\"\n     \n     # Test a path with suspicious elements\n-    suspicious_path = \"/images//D:/POC/secret.txt\"\n+    suspicious_path = \"/D:/POC/secret.txt\"\n+    \n+    #suspicious_path = \"/images//D:/POC/secret.txt\"\n     with pytest.raises(HTTPException):\n         sanitize_path_from_endpoint(suspicious_path)\n     "
        },
        {
          "filename": "web/dist/assets/index-91ab3091.js",
          "status": "renamed",
          "additions": 3,
          "deletions": 3,
          "patch": null
        },
        {
          "filename": "web/dist/assets/index-d4c7f2b1.css",
          "status": "added",
          "additions": 8,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "web/dist/assets/index-dbb96f42.css",
          "status": "removed",
          "additions": 0,
          "deletions": 8,
          "patch": null
        },
        {
          "filename": "web/dist/index.html",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -6,8 +6,8 @@\n     \n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n     <title>LoLLMS WebUI - Welcome</title>\n-    <script type=\"module\" crossorigin src=\"/assets/index-98910268.js\"></script>\n-    <link rel=\"stylesheet\" href=\"/assets/index-dbb96f42.css\">\n+    <script type=\"module\" crossorigin src=\"/assets/index-91ab3091.js\"></script>\n+    <link rel=\"stylesheet\" href=\"/assets/index-d4c7f2b1.css\">\n   </head>\n   <body>\n     <div id=\"app\"></div>"
        },
        {
          "filename": "web/src/views/DiscussionsView.vue",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -1342,6 +1342,7 @@ export default {\n                     messageItem && (msgObj.message_type==this.msgTypes.MSG_TYPE_FULL ||\n                     msgObj.message_type==this.msgTypes.MSG_TYPE_FULL_INVISIBLE_TO_AI)\n                 ) {\n+                    this.isGenerating = true;\n                     messageItem.content = msgObj.content\n                     messageItem.finished_generating_at = msgObj.finished_generating_at\n                 }"
        },
        {
          "filename": "zoos/personalities_zoo",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Subproject commit 5658cf08f986fe8db12ca1732cf03d36f7d1630f\n+Subproject commit 18f466025551401455c2a38baf874aa2172b0055"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 6,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "78b7303da280e81d7891d022430c9e7019036409",
            "date": "2025-01-14T08:22:08Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "858e69c34a9f91c02d64f4736c2c61032a930ef5",
            "date": "2025-01-14T07:56:40Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "953879e8b018a8602bd142844c1d7f008e8ab01c",
            "date": "2025-01-13T22:54:09Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "95a265db4d7c31c581c0e001bb8b213e7607743a",
            "date": "2025-01-13T22:43:32Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "8c92c3056b20930d7b3f9d5281b2fdae5bc0e4ac",
            "date": "2025-01-13T21:59:26Z",
            "author_login": "ParisNeo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-22",
    "description": "A path traversal vulnerability exists in the 'cyber_security/codeguard' native personality of the parisneo/lollms-webui, affecting versions up to 9.5. The vulnerability arises from the improper limitation of a pathname to a restricted directory in the 'process_folder' function within 'lollms-webui/zoos/personalities_zoo/cyber_security/codeguard/scripts/processor.py'. Specifically, the function fails to properly sanitize user-supplied input for the 'code_folder_path', allowing an attacker to specify arbitrary paths using '../' or absolute paths. This flaw leads to arbitrary file read and overwrite capabilities in specified directories without limitations, posing a significant risk of sensitive information disclosure and unauthorized file manipulation.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-06T19:16:01.247",
    "last_modified": "2024-11-21T09:29:23.643",
    "fix_date": "2024-04-04T16:20:24Z"
  },
  "references": [
    {
      "url": "https://github.com/parisneo/lollms-webui/commit/1e17df01e01d4d33599db2afaafe91d90b6f0189",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/e0822362-033a-4a71-b1dc-d803f03bd427",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/parisneo/lollms-webui/commit/1e17df01e01d4d33599db2afaafe91d90b6f0189",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/e0822362-033a-4a71-b1dc-d803f03bd427",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.349915",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lollms-webui",
    "owner": "parisneo",
    "created_at": "2023-04-06T16:38:00Z",
    "updated_at": "2025-01-14T10:08:17Z",
    "pushed_at": "2025-01-14T08:22:08Z",
    "size": 154737,
    "stars": 4437,
    "forks": 557,
    "open_issues": 162,
    "watchers": 4437,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "CSS": 2202947,
      "Vue": 1151251,
      "Python": 353630,
      "JavaScript": 179164,
      "Shell": 41865,
      "Batchfile": 30713,
      "Inno Setup": 27460,
      "HTML": 22305,
      "Jupyter Notebook": 3623,
      "Dockerfile": 1246
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:52:33.568829"
  }
}