{
  "cve_id": "CVE-2024-33883",
  "github_data": {
    "repository": "mde/ejs",
    "fix_commit": "e469741dca7df2eb400199e1cdb74621e3f89aa5",
    "related_commits": [
      "e469741dca7df2eb400199e1cdb74621e3f89aa5",
      "e469741dca7df2eb400199e1cdb74621e3f89aa5"
    ],
    "patch_url": "https://github.com/mde/ejs/commit/e469741dca7df2eb400199e1cdb74621e3f89aa5.patch",
    "fix_commit_details": {
      "sha": "e469741dca7df2eb400199e1cdb74621e3f89aa5",
      "commit_date": "2024-04-12T15:06:40Z",
      "author": {
        "login": "mde",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Basic pollution protection",
        "length": 26,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
      },
      "files": [
        {
          "filename": "lib/ejs.js",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -506,8 +506,8 @@ exports.clearCache = function () {\n   exports.cache.reset();\n };\n \n-function Template(text, opts) {\n-  opts = opts || utils.createNullProtoObjWherePossible();\n+function Template(text, optsParam) {\n+  var opts = utils.hasOwnOnlyObject(optsParam);\n   var options = utils.createNullProtoObjWherePossible();\n   this.templateText = text;\n   /** @type {string | null} */\n@@ -949,3 +949,4 @@ exports.name = _NAME;\n if (typeof window != 'undefined') {\n   window.ejs = exports;\n }\n+"
        },
        {
          "filename": "lib/utils.js",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -238,4 +238,13 @@ exports.createNullProtoObjWherePossible = (function () {\n   };\n })();\n \n+exports.hasOwnOnlyObject = function (obj) {\n+  var o = exports.createNullProtoObjWherePossible();\n+  for (var p in obj) {\n+    if (hasOwn(obj, p)) {\n+      o[p] = obj[p];\n+    }\n+  }\n+  return o;\n+};\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a4770b8ff49b93387c7f2760d957446cd332531a",
            "date": "2024-07-23T18:39:51Z",
            "author_login": "adnantabda"
          },
          {
            "sha": "5b13088c6de0bff1ce5c6ff2eef7ee7eff0d6f3e",
            "date": "2024-04-12T15:32:10Z",
            "author_login": "mde"
          },
          {
            "sha": "d3f807dea9ce904e20a47a661f2310ce9134dc2a",
            "date": "2024-04-12T15:23:01Z",
            "author_login": "mde"
          },
          {
            "sha": "9ee26dde5d7015d9c0e2ff87314cabeac5247c02",
            "date": "2024-04-12T15:07:01Z",
            "author_login": "mde"
          },
          {
            "sha": "e469741dca7df2eb400199e1cdb74621e3f89aa5",
            "date": "2024-04-12T15:06:40Z",
            "author_login": "mde"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.0,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-693",
    "description": "The ejs (aka Embedded JavaScript templates) package before 3.1.10 for Node.js lacks certain pollution protection.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-04-28T16:15:23.233",
    "last_modified": "2024-11-21T09:17:40.303",
    "fix_date": "2024-04-12T15:06:40Z"
  },
  "references": [
    {
      "url": "https://github.com/mde/ejs/commit/e469741dca7df2eb400199e1cdb74621e3f89aa5",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mde/ejs/compare/v3.1.9...v3.1.10",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240605-0003/",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mde/ejs/commit/e469741dca7df2eb400199e1cdb74621e3f89aa5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mde/ejs/compare/v3.1.9...v3.1.10",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240605-0003/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:07.032988",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ejs",
    "owner": "mde",
    "created_at": "2014-12-31T17:49:35Z",
    "updated_at": "2025-01-13T02:11:15Z",
    "pushed_at": "2024-08-06T21:14:22Z",
    "size": 7041,
    "stars": 7827,
    "forks": 843,
    "open_issues": 112,
    "watchers": 7827,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 96896
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T18:12:26.845828"
  }
}