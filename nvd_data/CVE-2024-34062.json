{
  "cve_id": "CVE-2024-34062",
  "github_data": {
    "repository": "tqdm/tqdm",
    "fix_commit": "4e613f84ed2ae029559f539464df83fa91feb316",
    "related_commits": [
      "4e613f84ed2ae029559f539464df83fa91feb316",
      "4e613f84ed2ae029559f539464df83fa91feb316"
    ],
    "patch_url": "https://github.com/tqdm/tqdm/commit/4e613f84ed2ae029559f539464df83fa91feb316.patch",
    "fix_commit_details": {
      "sha": "4e613f84ed2ae029559f539464df83fa91feb316",
      "commit_date": "2024-05-02T21:35:59Z",
      "author": {
        "login": "casperdcl",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-g7vv-2v7x-gj9p",
        "length": 61,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 33,
        "additions": 22,
        "deletions": 11
      },
      "files": [
        {
          "filename": "tqdm/cli.py",
          "status": "modified",
          "additions": 22,
          "deletions": 11,
          "patch": "@@ -21,23 +21,34 @@ def cast(val, typ):\n                 return cast(val, t)\n             except TqdmTypeError:\n                 pass\n-        raise TqdmTypeError(val + ' : ' + typ)\n+        raise TqdmTypeError(f\"{val} : {typ}\")\n \n     # sys.stderr.write('\\ndebug | `val:type`: `' + val + ':' + typ + '`.\\n')\n     if typ == 'bool':\n         if (val == 'True') or (val == ''):\n             return True\n-        elif val == 'False':\n+        if val == 'False':\n             return False\n-        else:\n-            raise TqdmTypeError(val + ' : ' + typ)\n-    try:\n-        return eval(typ + '(\"' + val + '\")')\n-    except Exception:\n-        if typ == 'chr':\n-            return chr(ord(eval('\"' + val + '\"'))).encode()\n-        else:\n-            raise TqdmTypeError(val + ' : ' + typ)\n+        raise TqdmTypeError(val + ' : ' + typ)\n+    if typ == 'chr':\n+        if len(val) == 1:\n+            return val.encode()\n+        if re.match(r\"^\\\\\\w+$\", val):\n+            return eval(f'\"{val}\"').encode()\n+        raise TqdmTypeError(f\"{val} : {typ}\")\n+    if typ == 'str':\n+        return val\n+    if typ == 'int':\n+        try:\n+            return int(val)\n+        except ValueError as exc:\n+            raise TqdmTypeError(f\"{val} : {typ}\") from exc\n+    if typ == 'float':\n+        try:\n+            return float(val)\n+        except ValueError as exc:\n+            raise TqdmTypeError(f\"{val} : {typ}\") from exc\n+    raise TqdmTypeError(f\"{val} : {typ}\")\n \n \n def posix_pipe(fin, fout, delim=b'\\\\n', buf_size=256,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0ed5d7f18fa3153834cbac0aa57e8092b217cc16",
            "date": "2024-11-12T13:35:33Z",
            "author_login": "casperdcl"
          },
          {
            "sha": "a2d5f1c9d1cbdbcf56f52dc4365ea4124e3e33f7",
            "date": "2024-11-12T00:35:27Z",
            "author_login": "casperdcl"
          },
          {
            "sha": "cac7150d7c8a650c7e76004cd7f8643990932c7f",
            "date": "2024-11-12T00:28:35Z",
            "author_login": "casperdcl"
          },
          {
            "sha": "6338f6216996918fdc9c9a73bf095acac54ce0bb",
            "date": "2024-11-12T00:01:41Z",
            "author_login": "casperdcl"
          },
          {
            "sha": "342b15ed68ae7c5ec1082cadb1b563c7dfde610f",
            "date": "2024-11-09T15:13:51Z",
            "author_login": "casperdcl"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-74",
    "description": "tqdm is an open source progress bar for Python and CLI. Any optional non-boolean CLI arguments (e.g. `--delim`, `--buf-size`, `--manpath`) are passed through python's `eval`, allowing arbitrary code execution. This issue is only locally exploitable and had been addressed in release version 4.66.3. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-03T10:15:08.500",
    "last_modified": "2024-11-21T09:18:00.540",
    "fix_date": "2024-05-02T21:35:59Z"
  },
  "references": [
    {
      "url": "https://github.com/tqdm/tqdm/commit/4e613f84ed2ae029559f539464df83fa91feb316",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/tqdm/tqdm/security/advisories/GHSA-g7vv-2v7x-gj9p",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PA3GIGHPWAHCTT4UF57LTPZGWHAX3GW6/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QRECVQCCESHBS3UJOWNXQUIX725TKNY6/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VA337CYUS4SLRFV2P6MX6MZ2LKFURKJC/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/tqdm/tqdm/commit/4e613f84ed2ae029559f539464df83fa91feb316",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/tqdm/tqdm/security/advisories/GHSA-g7vv-2v7x-gj9p",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PA3GIGHPWAHCTT4UF57LTPZGWHAX3GW6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QRECVQCCESHBS3UJOWNXQUIX725TKNY6/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VA337CYUS4SLRFV2P6MX6MZ2LKFURKJC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.847692",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "tqdm",
    "owner": "tqdm",
    "created_at": "2015-06-03T13:13:14Z",
    "updated_at": "2025-01-14T11:57:01Z",
    "pushed_at": "2024-12-20T11:39:22Z",
    "size": 6014,
    "stars": 29070,
    "forks": 1366,
    "open_issues": 546,
    "watchers": 29070,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "devel",
      "master"
    ],
    "languages": {
      "Python": 284115,
      "Jupyter Notebook": 41290,
      "Roff": 7889,
      "Makefile": 5099,
      "Shell": 946
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:08:58.127833"
  }
}