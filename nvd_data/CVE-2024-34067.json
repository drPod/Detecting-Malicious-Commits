{
  "cve_id": "CVE-2024-34067",
  "github_data": {
    "repository": "pterodactyl/panel",
    "fix_commit": "0dad4c5a488661f9adc27dd311542516d9bfa0f2",
    "related_commits": [
      "0dad4c5a488661f9adc27dd311542516d9bfa0f2",
      "1172d71d31561c4e465dabdf6b838e64de48ad16",
      "f671046947e4695b5e1c647df79305c1cefdf817",
      "0dad4c5a488661f9adc27dd311542516d9bfa0f2",
      "1172d71d31561c4e465dabdf6b838e64de48ad16",
      "f671046947e4695b5e1c647df79305c1cefdf817"
    ],
    "patch_url": "https://github.com/pterodactyl/panel/commit/0dad4c5a488661f9adc27dd311542516d9bfa0f2.patch",
    "fix_commit_details": {
      "sha": "0dad4c5a488661f9adc27dd311542516d9bfa0f2",
      "commit_date": "2024-04-11T16:47:00Z",
      "author": {
        "login": "matthewpi",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "ui(admin): better handling of manual HTML rendering",
        "length": 51,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 42,
        "additions": 30,
        "deletions": 12
      },
      "files": [
        {
          "filename": "public/themes/pterodactyl/js/admin/new-server.js",
          "status": "modified",
          "additions": 11,
          "deletions": 5,
          "patch": "@@ -109,6 +109,12 @@ $('#pEggId').on('change', function (event) {\n         ),\n     });\n \n+    function escapeHtml(str) {\n+        var div = document.createElement('div');\n+        div.appendChild(document.createTextNode(str));\n+        return div.innerHTML;\n+    }\n+\n     const variableIds = {};\n     $('#appendVariablesTo').html('');\n     $.each(_.get(objectChain, 'variables', []), function (i, item) {\n@@ -117,11 +123,11 @@ $('#pEggId').on('change', function (event) {\n         let isRequired = (item.required === 1) ? '<span class=\"label label-danger\">Required</span> ' : '';\n         let dataAppend = ' \\\n             <div class=\"form-group col-sm-6\"> \\\n-                <label for=\"var_ref_' + item.id + '\" class=\"control-label\">' + isRequired + item.name + '</label> \\\n-                <input type=\"text\" id=\"var_ref_' + item.id + '\" autocomplete=\"off\" name=\"environment[' + item.env_variable + ']\" class=\"form-control\" value=\"' + item.default_value + '\" /> \\\n-                <p class=\"text-muted small\">' + item.description + '<br /> \\\n-                <strong>Access in Startup:</strong> <code>{{' + item.env_variable + '}}</code><br /> \\\n-                <strong>Validation Rules:</strong> <code>' + item.rules + '</code></small></p> \\\n+                <label for=\"var_ref_' + escapeHtml(item.id) + '\" class=\"control-label\">' + isRequired + escapeHtml(item.name) + '</label> \\\n+                <input type=\"text\" id=\"var_ref_' + escapeHtml(item.id) + '\" autocomplete=\"off\" name=\"environment[' + escapeHtml(item.env_variable) + ']\" class=\"form-control\" value=\"' + escapeHtml(item.default_value) + '\" /> \\\n+                <p class=\"text-muted small\">' + escapeHtml(item.description) + '<br /> \\\n+                <strong>Access in Startup:</strong> <code>{{' + escapeHtml(item.env_variable) + '}}</code><br /> \\\n+                <strong>Validation Rules:</strong> <code>' + escapeHtml(item.rules) + '</code></small></p> \\\n             </div> \\\n         ';\n         $('#appendVariablesTo').append(dataAppend);"
        },
        {
          "filename": "resources/views/admin/nodes/view/index.blade.php",
          "status": "modified",
          "additions": 8,
          "deletions": 2,
          "patch": "@@ -145,14 +145,20 @@\n @section('footer-scripts')\n     @parent\n     <script>\n+    function escapeHtml(str) {\n+        var div = document.createElement('div');\n+        div.appendChild(document.createTextNode(str));\n+        return div.innerHTML;\n+    }\n+\n     (function getInformation() {\n         $.ajax({\n             method: 'GET',\n             url: '/admin/nodes/view/{{ $node->id }}/system-information',\n             timeout: 5000,\n         }).done(function (data) {\n-            $('[data-attr=\"info-version\"]').html(data.version);\n-            $('[data-attr=\"info-system\"]').html(data.system.type + ' (' + data.system.arch + ') <code>' + data.system.release + '</code>');\n+            $('[data-attr=\"info-version\"]').html(escapeHtml(data.version));\n+            $('[data-attr=\"info-system\"]').html(escapeHtml(data.system.type) + ' (' + escapeHtml(data.system.arch) + ') <code>' + escapeHtml(data.system.release) + '</code>');\n             $('[data-attr=\"info-cpus\"]').html(data.system.cpus);\n         }).fail(function (jqXHR) {\n "
        },
        {
          "filename": "resources/views/admin/servers/view/startup.blade.php",
          "status": "modified",
          "additions": 11,
          "deletions": 5,
          "patch": "@@ -107,6 +107,12 @@\n     @parent\n     {!! Theme::js('vendor/lodash/lodash.js') !!}\n     <script>\n+    function escapeHtml(str) {\n+        var div = document.createElement('div');\n+        div.appendChild(document.createTextNode(str));\n+        return div.innerHTML;\n+    }\n+\n     $(document).ready(function () {\n         $('#pEggId').select2({placeholder: 'Select a Nest Egg'}).on('change', function () {\n             var selectedEgg = _.isNull($(this).val()) ? $(this).find('option').first().val() : $(this).val();\n@@ -149,15 +155,15 @@\n                     <div class=\"col-xs-12\"> \\\n                         <div class=\"box\"> \\\n                             <div class=\"box-header with-border\"> \\\n-                                <h3 class=\"box-title\">' + isRequired + item.name + '</h3> \\\n+                                <h3 class=\"box-title\">' + isRequired + escapeHtml(item.name) + '</h3> \\\n                             </div> \\\n                             <div class=\"box-body\"> \\\n-                                <input name=\"environment[' + item.env_variable + ']\" class=\"form-control\" type=\"text\" id=\"egg_variable_' + item.env_variable + '\" /> \\\n-                                <p class=\"no-margin small text-muted\">' + item.description + '</p> \\\n+                                <input name=\"environment[' + escapeHtml(item.env_variable) + ']\" class=\"form-control\" type=\"text\" id=\"egg_variable_' + escapeHtml(item.env_variable) + '\" /> \\\n+                                <p class=\"no-margin small text-muted\">' + escapeHtml(item.description) + '</p> \\\n                             </div> \\\n                             <div class=\"box-footer\"> \\\n-                                <p class=\"no-margin text-muted small\"><strong>Startup Command Variable:</strong> <code>' + item.env_variable + '</code></p> \\\n-                                <p class=\"no-margin text-muted small\"><strong>Input Rules:</strong> <code>' + item.rules + '</code></p> \\\n+                                <p class=\"no-margin text-muted small\"><strong>Startup Command Variable:</strong> <code>' + escapeHtml(item.env_variable) + '</code></p> \\\n+                                <p class=\"no-margin text-muted small\"><strong>Input Rules:</strong> <code>' + escapeHtml(item.rules) + '</code></p> \\\n                             </div> \\\n                         </div> \\\n                     </div>';"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9cac00cd550f407e06925562309705243f9c600e",
            "date": "2025-01-12T21:56:50Z",
            "author_login": "matthewpi"
          },
          {
            "sha": "90ae588721cb4658cce1cb22073adc6684bae492",
            "date": "2024-11-15T02:20:51Z",
            "author_login": "matthewpi"
          },
          {
            "sha": "955dd2796d1fee7dcd499b161f010c312c6d49d4",
            "date": "2024-11-15T02:03:51Z",
            "author_login": "matthewpi"
          },
          {
            "sha": "de3b1efb6991c9039d2e86bb395072ab5c30d90c",
            "date": "2024-10-27T19:50:37Z",
            "author_login": "matthewpi"
          },
          {
            "sha": "706db62c64d180f224f56c62953172c27daa5826",
            "date": "2024-10-24T18:04:30Z",
            "author_login": "matthewpi"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Pterodactyl is a free, open-source game server management panel built with PHP, React, and Go. Importing a malicious egg or gaining access to wings instance could lead to cross site scripting (XSS) on the panel, which could be used to gain an administrator account on the panel. Specifically, the following things are impacted: Egg Docker images and Egg variables: Name, Environment variable, Default value, Description, Validation rules. Additionally, certain fields would reflect malicious input, but it would require the user knowingly entering such input to have an impact. To iterate, this would require an administrator to perform actions and can't be triggered by a normal panel user. This issue has has been addressed in version 1.11.6 and users are advised to upgrade. No workaround is available other than updating to the latest version of the panel.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-03T18:15:09.573",
    "last_modified": "2024-11-21T09:18:01.257",
    "fix_date": "2024-04-11T16:47:00Z"
  },
  "references": [
    {
      "url": "https://github.com/pterodactyl/panel/commit/0dad4c5a488661f9adc27dd311542516d9bfa0f2",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/commit/1172d71d31561c4e465dabdf6b838e64de48ad16",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/commit/f671046947e4695b5e1c647df79305c1cefdf817",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/security/advisories/GHSA-384w-wffr-x63q",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/commit/0dad4c5a488661f9adc27dd311542516d9bfa0f2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/commit/1172d71d31561c4e465dabdf6b838e64de48ad16",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/commit/f671046947e4695b5e1c647df79305c1cefdf817",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/pterodactyl/panel/security/advisories/GHSA-384w-wffr-x63q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.850909",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "panel",
    "owner": "pterodactyl",
    "created_at": "2015-12-06T18:37:08Z",
    "updated_at": "2025-01-14T16:34:11Z",
    "pushed_at": "2025-01-12T22:03:33Z",
    "size": 27615,
    "stars": 7039,
    "forks": 1818,
    "open_issues": 349,
    "watchers": 7039,
    "has_security_policy": false,
    "default_branch": "1.0-develop",
    "protected_branches": [
      "0.7-develop",
      "1.0-develop",
      "develop"
    ],
    "languages": {
      "PHP": 1658453,
      "TypeScript": 558694,
      "Blade": 313257,
      "CSS": 33788,
      "JavaScript": 28750,
      "Nix": 3938,
      "Dockerfile": 2022
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T18:25:39.485449"
  }
}