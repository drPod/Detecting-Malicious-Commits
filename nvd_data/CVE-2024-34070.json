{
  "cve_id": "CVE-2024-34070",
  "github_data": {
    "repository": "froxlor/Froxlor",
    "fix_commit": "a862307bce5cdfb1c208b835f3e8faddd23046e6",
    "related_commits": [
      "a862307bce5cdfb1c208b835f3e8faddd23046e6",
      "a862307bce5cdfb1c208b835f3e8faddd23046e6"
    ],
    "patch_url": "https://github.com/froxlor/Froxlor/commit/a862307bce5cdfb1c208b835f3e8faddd23046e6.patch",
    "fix_commit_details": {
      "sha": "a862307bce5cdfb1c208b835f3e8faddd23046e6",
      "commit_date": "2024-05-03T05:54:13Z",
      "author": {
        "login": "d00p",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-x525-54hf-xr53",
        "length": 488,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 8,
        "deletions": 3
      },
      "files": [
        {
          "filename": "index.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -248,7 +248,7 @@\n \t\t\t\t$rstlog = FroxlorLogger::getInstanceOf([\n \t\t\t\t\t'loginname' => $_SERVER['REMOTE_ADDR']\n \t\t\t\t]);\n-\t\t\t\t$rstlog->logAction(FroxlorLogger::LOGIN_ACTION, LOG_WARNING, \"Unknown user '\" . $loginname . \"' tried to login.\");\n+\t\t\t\t$rstlog->logAction(FroxlorLogger::LOGIN_ACTION, LOG_WARNING, \"Unknown user tried to login.\");\n \n \t\t\t\tResponse::redirectTo('index.php', [\n \t\t\t\t\t'showmessage' => '2'\n@@ -305,7 +305,7 @@\n \t\t\t$rstlog = FroxlorLogger::getInstanceOf([\n \t\t\t\t'loginname' => $_SERVER['REMOTE_ADDR']\n \t\t\t]);\n-\t\t\t$rstlog->logAction(FroxlorLogger::LOGIN_ACTION, LOG_WARNING, \"User '\" . $loginname . \"' tried to login with wrong password.\");\n+\t\t\t$rstlog->logAction(FroxlorLogger::LOGIN_ACTION, LOG_WARNING, \"User tried to login with wrong password.\");\n \n \t\t\tunset($userinfo);\n \t\t\tResponse::redirectTo('index.php', [\n@@ -624,7 +624,7 @@\n \t\t\t\t\t\t\t$rstlog = FroxlorLogger::getInstanceOf([\n \t\t\t\t\t\t\t\t'loginname' => 'password_reset'\n \t\t\t\t\t\t\t]);\n-\t\t\t\t\t\t\t$rstlog->logAction(FroxlorLogger::USR_ACTION, LOG_WARNING, \"User '\" . $loginname . \"' requested to set a new password, but was not found in database!\");\n+\t\t\t\t\t\t\t$rstlog->logAction(FroxlorLogger::USR_ACTION, LOG_WARNING, \"Unknown user requested to set a new password, but was not found in database!\");\n \t\t\t\t\t\t\t$message = lng('login.usernotfound');\n \t\t\t\t\t\t}\n "
        },
        {
          "filename": "lib/Froxlor/Api/Commands/SysLog.php",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -90,6 +90,8 @@ public function listing()\n \t\t}\n \t\tDatabase::pexecute($result_stmt, $query_fields, true, true);\n \t\twhile ($row = $result_stmt->fetch(PDO::FETCH_ASSOC)) {\n+\t\t\t// clean log-text\n+\t\t\t$row['text'] = preg_replace(\"/[^\\w @#\\\"':.()\\[\\]+\\-_\\/\\\\\\!]/i\", \"_\", $row['text']);\n \t\t\t$result[] = $row;\n \t\t}\n \t\t$this->logger()->logAction($this->isAdmin() ? FroxlorLogger::ADM_ACTION : FroxlorLogger::USR_ACTION, LOG_INFO, \"[API] list log-entries\");"
        },
        {
          "filename": "lib/Froxlor/FroxlorLogger.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -175,6 +175,9 @@ public function logAction($action = FroxlorLogger::USR_ACTION, int $type = LOG_N\n \t\t\t$this->initMonolog();\n \t\t}\n \n+\t\t// clean log-text\n+\t\t$text = preg_replace(\"/[^\\w @#\\\"':.()\\[\\]+\\-_\\/\\\\\\!]/i\", \"_\", $text);\n+\n \t\tif (self::$crondebug_flag || ($action == FroxlorLogger::CRON_ACTION && $type <= LOG_WARNING)) {\n \t\t\techo \"[\" . $this->getLogLevelDesc($type) . \"] \" . $text . PHP_EOL;\n \t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ec42003367df64c5645a9d5ee5bcd95c75a82b6c",
            "date": "2025-01-12T15:53:05Z",
            "author_login": "d00p"
          },
          {
            "sha": "fde43f80600f1035e1e3d2297411b666d805549a",
            "date": "2025-01-12T09:27:44Z",
            "author_login": "d00p"
          },
          {
            "sha": "a43d53d54034805e3e404702a01312fa0c40b623",
            "date": "2025-01-12T09:27:02Z",
            "author_login": "d00p"
          },
          {
            "sha": "3638dc08ea4fe55ce0d2458cdcb436cfb5697ed3",
            "date": "2024-12-24T08:34:59Z",
            "author_login": "d00p"
          },
          {
            "sha": "c2d166c86666f4c50c1402c1b3a2986ddabeee90",
            "date": "2024-12-19T07:59:00Z",
            "author_login": "d00p"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-79",
    "description": "Froxlor is open source server administration software. Prior to 2.1.9, a Stored Blind Cross-Site Scripting (XSS) vulnerability was identified in the Failed Login Attempts Logging Feature of the Froxlor Application. An unauthenticated User can inject malicious scripts in the loginname parameter on the Login attempt, which will then be executed when viewed by the Administrator in the System Logs.  By exploiting this vulnerability, the attacker can perform various malicious actions such as forcing the Administrator to execute actions without their knowledge or consent. For instance, the attacker can force the Administrator to add a new administrator controlled by the attacker, thereby giving the attacker full control over the application. This vulnerability is fixed in 2.1.9.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-14T15:38:26.727",
    "last_modified": "2024-11-21T09:18:01.680",
    "fix_date": "2024-05-03T05:54:13Z"
  },
  "references": [
    {
      "url": "https://github.com/froxlor/Froxlor/commit/a862307bce5cdfb1c208b835f3e8faddd23046e6",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/froxlor/Froxlor/security/advisories/GHSA-x525-54hf-xr53",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/froxlor/Froxlor/commit/a862307bce5cdfb1c208b835f3e8faddd23046e6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/froxlor/Froxlor/security/advisories/GHSA-x525-54hf-xr53",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.890375",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Froxlor",
    "owner": "froxlor",
    "created_at": "2012-03-06T15:14:46Z",
    "updated_at": "2025-01-12T15:57:15Z",
    "pushed_at": "2025-01-12T15:57:10Z",
    "size": 28867,
    "stars": 1651,
    "forks": 457,
    "open_issues": 35,
    "watchers": 1651,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "extras",
      "main"
    ],
    "languages": {
      "PHP": 3752037,
      "Twig": 153143,
      "HTML": 28494,
      "SCSS": 8015,
      "JavaScript": 942
    },
    "commit_activity": {
      "total_commits_last_year": 130,
      "avg_commits_per_week": 2.5,
      "days_active_last_year": 75
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T12:57:26.773697"
  }
}