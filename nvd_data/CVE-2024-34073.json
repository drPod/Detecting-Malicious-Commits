{
  "cve_id": "CVE-2024-34073",
  "github_data": {
    "repository": "aws/sagemaker-python-sdk",
    "fix_commit": "2d873d53f708ea570fc2e2a6974f8c3097fe9df5",
    "related_commits": [
      "2d873d53f708ea570fc2e2a6974f8c3097fe9df5",
      "2d873d53f708ea570fc2e2a6974f8c3097fe9df5"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2d873d53f708ea570fc2e2a6974f8c3097fe9df5",
      "commit_date": "2024-04-02T21:50:01Z",
      "author": {
        "login": "jiapinw",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[Fix] Switch to subprocess in ModelBuilder when capturing dependencies (#4556)",
        "length": 208,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 7,
        "additions": 4,
        "deletions": 3
      },
      "files": [
        {
          "filename": "src/sagemaker/serve/save_retrive/version_1_0_0/save/utils.py",
          "status": "modified",
          "additions": 4,
          "deletions": 3,
          "patch": "@@ -5,6 +5,7 @@\n import hashlib\n import os\n import logging\n+import subprocess\n import sys\n import platform\n from collections import defaultdict\n@@ -98,10 +99,10 @@ def capture_dependencies(requirements_path: str):\n             f.write(sagemaker_dependency)\n         return\n \n-    command = f\"pigar gen -f {Path(requirements_path)} {os.getcwd()}\"\n-    logging.info(\"Running command %s\", command)\n+    command = [\"pigar\", \"gen\", \"-f\", str(Path(requirements_path)), str(os.getcwd())]\n+    logging.info(\"Running command: %s\", \" \".join(command))\n \n-    os.system(command)\n+    subprocess.run(command, check=True, capture_output=True)\n     logger.info(\"Dependencies captured successfully\")\n \n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "87554bbd4ad9eb72990ac3993cc86f8c7f5ba8fc",
            "date": "2025-01-24T14:18:11Z",
            "author_login": "sagemaker-bot"
          },
          {
            "sha": "53f880012bdf10e2010fa4ebb5da121196bc2306",
            "date": "2025-01-22T07:27:52Z",
            "author_login": "benieric"
          },
          {
            "sha": "0402ba067f1cbdf4f8b52b8d218dd62e9043afb0",
            "date": "2025-01-17T17:52:39Z",
            "author_login": "nargokul"
          },
          {
            "sha": "ae3cc1c44244d79ed6187fd26889449672c55af3",
            "date": "2025-01-16T23:01:46Z",
            "author_login": "brunopistone"
          },
          {
            "sha": "a58654ecbd5997aa59e4fcd8389715fe04c71f5d",
            "date": "2024-12-30T01:34:08Z",
            "author_login": "pintaoz-aws"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "sagemaker-python-sdk is a library for training and deploying machine learning models on Amazon SageMaker. In affected versions the capture_dependencies function in `sagemaker.serve.save_retrive.version_1_0_0.save.utils` module allows for potentially unsafe Operating System (OS) Command Injection if inappropriate command is passed as the \u201crequirements_path\u201d parameter. This consequently may allow an unprivileged third party to cause remote code execution, denial of service, affecting both confidentiality and integrity. This issue has been addressed in version 2.214.3. Users are advised to upgrade. Users unable to upgrade should not override the \u201crequirements_path\u201d parameter of capture_dependencies function in `sagemaker.serve.save_retrive.version_1_0_0.save.utils`, and instead use the default value.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-03T11:15:22.447",
    "last_modified": "2024-11-21T09:18:02.103",
    "fix_date": "2024-04-02T21:50:01Z"
  },
  "references": [
    {
      "url": "https://github.com/aws/sagemaker-python-sdk/commit/2d873d53f708ea570fc2e2a6974f8c3097fe9df5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/aws/sagemaker-python-sdk/pull/4556",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/aws/sagemaker-python-sdk/security/advisories/GHSA-7pc3-pr3q-58vg",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/aws/sagemaker-python-sdk/commit/2d873d53f708ea570fc2e2a6974f8c3097fe9df5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/aws/sagemaker-python-sdk/pull/4556",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/aws/sagemaker-python-sdk/security/advisories/GHSA-7pc3-pr3q-58vg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.848183",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "sagemaker-python-sdk",
    "owner": "aws",
    "created_at": "2017-11-14T01:03:33Z",
    "updated_at": "2025-01-13T21:01:06Z",
    "pushed_at": "2025-01-13T22:42:56Z",
    "size": 167121,
    "stars": 2119,
    "forks": 1141,
    "open_issues": 350,
    "watchers": 2119,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "dev",
      "master",
      "master-benchmark-feature",
      "master-jumpstart",
      "master-jumpstart-curated-hub",
      "master-jumpstart-curated-hub-old",
      "master-quick-silver-demo",
      "master-rba"
    ],
    "languages": {
      "Python": 15023177,
      "Jupyter Notebook": 45019,
      "Shell": 5456,
      "Dockerfile": 2333,
      "Java": 201,
      "PureBasic": 56
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:17:24.129033"
  }
}