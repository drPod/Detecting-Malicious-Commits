{
  "cve_id": "CVE-2024-34345",
  "github_data": {
    "repository": "CycloneDX/cyclonedx-javascript-library",
    "fix_commit": "5e5e1e0b9422f47d2de81c7c4064b803a01e7203",
    "related_commits": [
      "5e5e1e0b9422f47d2de81c7c4064b803a01e7203",
      "5e5e1e0b9422f47d2de81c7c4064b803a01e7203"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "5e5e1e0b9422f47d2de81c7c4064b803a01e7203",
      "commit_date": "2024-05-07T18:01:20Z",
      "author": {
        "login": "jkowalleck",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: revert to v6.6.1",
        "length": 77,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 65,
        "additions": 8,
        "deletions": 57
      },
      "files": [
        {
          "filename": "HISTORY.md",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -6,8 +6,14 @@ All notable changes to this project will be documented in this file.\n \n <!-- add unreleased items here -->\n \n+## 6.7.1 -- 2024-05-07\n+\n+Reverted v6.7.0, back to v6.6.1\n+\n ## 6.7.0 -- 2024-05-07\n \n+!! THIS VERSION GOT YANKED !!\n+\n * Changed\n   * The provided XML validation capabilities no longer supports external entities (via [#1063]; concerns [#1061])  \n     This is considered a security measure to prevent XML external entity (XXE) injection."
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"@cyclonedx/cyclonedx-library\",\n-  \"version\": \"6.7.0\",\n+  \"version\": \"6.6.1\",\n   \"description\": \"Core functionality of CycloneDX for JavaScript (Node.js or WebBrowser).\",\n   \"license\": \"Apache-2.0\",\n   \"keywords\": ["
        },
        {
          "filename": "src/validation/xmlValidator.node.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -48,8 +48,7 @@ async function getParser (): Promise<typeof parseXml> {\n \n const xmlParseOptions: Readonly<ParserOptions> = Object.freeze({\n   nonet: true,\n-  compact: true,\n-  noent: true // prevent https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061\n+  compact: true\n })\n \n export class XmlValidator extends BaseValidator {"
        },
        {
          "filename": "tests/integration/Validation.XmlValidator.test.js",
          "status": "modified",
          "additions": 0,
          "deletions": 54,
          "patch": "@@ -99,59 +99,5 @@ describe('Validation.XmlValidator', () => {\n       const validationError = await validator.validate(input)\n       assert.strictEqual(validationError, null)\n     })\n-\n-    it('is not vulnerable to advisories/GHSA-mjr4-7xg5-pfvh', async () => {\n-      /* report:\n-      see https://github.com/advisories/GHSA-mjr4-7xg5-pfvh\n-      see https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061\n-      */\n-      const validator = new XmlValidator(version)\n-      /* POC payload:\n-      see https://research.jfrog.com/vulnerabilities/libxmljs2-attrs-type-confusion-rce-jfsa-2024-001034097/#poc\n-       */\n-      const input = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <!DOCTYPE note\n-        [\n-        <!ENTITY writer \"` + 'A'.repeat(0x1234) + `\">\n-        ]>\n-        <bom xmlns=\"http://cyclonedx.org/schema/bom/${version}\">\n-          <components>\n-            <component type=\"library\">\n-              <name>&writer;</name><!-- << XML external entity (XXE) injection -->\n-              <version>1.337</version>\n-              ${version === '1.0' ? '<modified>false</modified>' : ''}\n-            </component>\n-          </components>\n-        </bom>`\n-      const validationError = await validator.validate(input)\n-      assert.strictEqual(validationError, null)\n-    })\n-\n-    it('is not vulnerable to advisories/GHSA-78h3-pg4x-j8cv', async () => {\n-      /* report:\n-      see https://github.com/advisories/GHSA-78h3-pg4x-j8cv\n-      see https://github.com/CycloneDX/cyclonedx-javascript-library/issues/1061\n-      */\n-      const validator = new XmlValidator(version)\n-      /* POC payload:\n-      see https://research.jfrog.com/vulnerabilities/libxmljs2-namespaces-type-confusion-rce-jfsa-2024-001034098/#poc\n-      */\n-      const input = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-        <!DOCTYPE note\n-        [\n-        <!ENTITY writer PUBLIC \"` + 'A'.repeat(8) + 'B'.repeat(8) + 'C'.repeat(8) + 'D'.repeat(8) + 'P'.repeat(8) + `\" \"JFrog Security\">\n-        ]>\n-        <bom xmlns=\"http://cyclonedx.org/schema/bom/${version}\">\n-          <components>\n-            <component type=\"library\">\n-              <name>&writer;</name><!-- << XML external entity (XXE) injection -->\n-              <version>1.337</version>\n-              ${version === '1.0' ? '<modified>false</modified>' : ''}\n-            </component>\n-          </components>\n-        </bom>`\n-      const validationError = await validator.validate(input)\n-      assert.strictEqual(validationError, null)\n-    })\n   }))\n })"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f07fd409d2f539745a4b864b93d268d50b4bdcc8",
            "date": "2025-01-09T13:48:57Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "08414c4a20d56b2cf6792c39c310c3aeedfcbd88",
            "date": "2025-01-09T09:59:22Z",
            "author_login": "jkowalleck"
          },
          {
            "sha": "a98d512b625ba6f02ba25bb73a86dec7ecf15e20",
            "date": "2025-01-09T09:57:51Z",
            "author_login": "jkowalleck"
          },
          {
            "sha": "492923c5e43488b4ec0db58a6be48f292a86099e",
            "date": "2025-01-09T09:55:18Z",
            "author_login": "jkowalleck"
          },
          {
            "sha": "d031db73a64c0e16b469fe07ee17868506d44557",
            "date": "2025-01-09T09:54:04Z",
            "author_login": "jkowalleck"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-611",
    "description": "The CycloneDX JavaScript library contains the core functionality of OWASP CycloneDX for JavaScript. In 6.7.0, XML External entity injections were possible, when running the provided XML Validator on arbitrary input. This issue was fixed in version 6.7.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-05-14T15:38:40.380",
    "last_modified": "2024-11-21T09:18:28.497",
    "fix_date": "2024-05-07T18:01:20Z"
  },
  "references": [
    {
      "url": "https://github.com/CycloneDX/cyclonedx-javascript-library/commit/5e5e1e0b9422f47d2de81c7c4064b803a01e7203",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/CycloneDX/cyclonedx-javascript-library/commit/5e5e1e0b9422f47d2de81c7c4064b803a01e7203",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.895454",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "cyclonedx-javascript-library",
    "owner": "CycloneDX",
    "created_at": "2022-02-04T18:20:43Z",
    "updated_at": "2025-01-09T13:49:01Z",
    "pushed_at": "2025-01-18T11:38:19Z",
    "size": 3621,
    "stars": 15,
    "forks": 12,
    "open_issues": 21,
    "watchers": 15,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.x-dev",
      "2.x-dev",
      "3.x-dev",
      "4.x-dev",
      "5.x-dev",
      "6.x-dev",
      "main"
    ],
    "languages": {
      "TypeScript": 282901,
      "JavaScript": 219648,
      "Shell": 745
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:17:24.991884"
  }
}