{
  "cve_id": "CVE-2024-34446",
  "github_data": {
    "repository": "mullvad/mullvadvpn-app",
    "fix_commit": "0c39306a40f426853d617e20d596942e41091f13",
    "related_commits": [
      "0c39306a40f426853d617e20d596942e41091f13",
      "0c39306a40f426853d617e20d596942e41091f13"
    ],
    "patch_url": "https://github.com/mullvad/mullvadvpn-app/commit/0c39306a40f426853d617e20d596942e41091f13.patch",
    "fix_commit_details": {
      "sha": "0c39306a40f426853d617e20d596942e41091f13",
      "commit_date": "2024-05-02T08:56:30Z",
      "author": {
        "login": "dlon",
        "type": "User",
        "stats": {
          "total_commits": 3071,
          "average_weekly_commits": 7.225882352941176,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 242
        }
      },
      "commit_message": {
        "title": "Set dummy DNS servers on Android",
        "length": 32,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 9,
        "deletions": 0
      },
      "files": [
        {
          "filename": "talpid-tunnel/src/tun_provider/android/mod.rs",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -219,6 +219,7 @@ impl AndroidTunProvider {\n     fn prepare_tun_config(&self, config: &mut TunConfig) {\n         self.prepare_tun_config_for_allow_lan(config);\n         self.prepare_tun_config_for_custom_dns(config);\n+        maybe_set_dummy_dns_servers(config);\n     }\n \n     fn prepare_tun_config_for_allow_lan(&self, config: &mut TunConfig) {\n@@ -324,6 +325,14 @@ impl AndroidTunProvider {\n     }\n }\n \n+/// Add dummy servers if no DNS servers are set. Android may sometimes leak DNS otherwise.\n+fn maybe_set_dummy_dns_servers(config: &mut TunConfig) {\n+    if !config.dns_servers.is_empty() {\n+        return;\n+    }\n+    config.dns_servers = vec![\"192.0.2.1\".parse().unwrap()];\n+}\n+\n /// Handle to a tunnel device on Android.\n pub struct VpnServiceTun {\n     tunnel: RawFd,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7fdaade7e2e3bb90e6aaea11a3f40f88d4f5533d",
            "date": "2025-01-14T14:15:19Z",
            "author_login": "raksooo"
          },
          {
            "sha": "8f5415d947f407b51d8f67cccb61a39fe53e5817",
            "date": "2025-01-14T07:56:03Z",
            "author_login": "raksooo"
          },
          {
            "sha": "ed0b9cd0283e26e216fbb7edf5cd6e5bcf042cde",
            "date": "2025-01-14T10:49:21Z",
            "author_login": "buggmagnet"
          },
          {
            "sha": "e71db0cfc12bd561532b73722983175edab2482c",
            "date": "2025-01-14T09:00:13Z",
            "author_login": "buggmagnet"
          },
          {
            "sha": "9185ed9530430172d8c3484895b122dc0f93d7f5",
            "date": "2025-01-14T08:59:54Z",
            "author_login": "buggmagnet"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-923",
    "description": "Mullvad VPN through 2024.1 on Android does not set a DNS server in the blocking state (after a hard failure to create a tunnel), and thus DNS traffic can leave the device. Data showing that the affected device was the origin of sensitive DNS requests may be observed and logged by operators of unintended DNS servers.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-03T15:15:08.210",
    "last_modified": "2024-11-21T09:18:41.320",
    "fix_date": "2024-05-02T08:56:30Z"
  },
  "references": [
    {
      "url": "https://github.com/mullvad/mullvadvpn-app/blob/main/CHANGELOG.md",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mullvad/mullvadvpn-app/commit/0c39306a40f426853d617e20d596942e41091f13",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mullvad/mullvadvpn-app/tags",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://news.ycombinator.com/item?id=40247604",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/mullvad/mullvadvpn-app/blob/main/CHANGELOG.md",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mullvad/mullvadvpn-app/commit/0c39306a40f426853d617e20d596942e41091f13",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mullvad/mullvadvpn-app/tags",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://news.ycombinator.com/item?id=40247604",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.848902",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mullvadvpn-app",
    "owner": "mullvad",
    "created_at": "2017-12-19T08:59:42Z",
    "updated_at": "2025-01-14T15:35:36Z",
    "pushed_at": "2025-01-14T16:20:16Z",
    "size": 179496,
    "stars": 5311,
    "forks": 360,
    "open_issues": 324,
    "watchers": 5311,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Rust": 3614168,
      "Swift": 2797651,
      "Kotlin": 2219668,
      "TypeScript": 1369703,
      "C++": 264693,
      "Shell": 180789,
      "JavaScript": 33022,
      "C": 30375,
      "NSIS": 24529,
      "Go": 15965,
      "Dockerfile": 11040,
      "HCL": 8101,
      "Ruby": 6571,
      "Python": 5531,
      "Objective-C": 4736,
      "CSS": 2669,
      "Makefile": 1419,
      "HTML": 986
    },
    "commit_activity": {
      "total_commits_last_year": 3980,
      "avg_commits_per_week": 76.53846153846153,
      "days_active_last_year": 264
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T16:34:48.290606"
  }
}