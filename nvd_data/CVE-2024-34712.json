{
  "cve_id": "CVE-2024-34712",
  "github_data": {
    "repository": "OceanicJS/Oceanic",
    "fix_commit": "8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe",
    "related_commits": [
      "8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe",
      "8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe"
    ],
    "patch_url": "https://github.com/OceanicJS/Oceanic/commit/8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe.patch",
    "fix_commit_details": {
      "sha": "8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe",
      "commit_date": "2024-05-13T23:52:45Z",
      "author": {
        "login": "DonovanDMC",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "sanitize route parameters",
        "length": 25,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 250,
        "additions": 127,
        "deletions": 123
      },
      "files": [
        {
          "filename": "lib/util/Routes.ts",
          "status": "modified",
          "additions": 127,
          "deletions": 123,
          "patch": "@@ -2,141 +2,145 @@\n /* eslint-disable @typescript-eslint/explicit-function-return-type */\n export const CDN_URL = \"https://cdn.discordapp.com\";\n \n+function encode(strings: TemplateStringsArray, ...args: Array<string | number>): string {\n+    return strings.reduce((acc, str, i) => `${acc}${str}${encodeURIComponent(args[i] ?? \"\")}`, \"\");\n+}\n+\n // Webhooks\n-export const CHANNEL_WEBHOOKS = (channelID: string) => `/channels/${channelID}/webhooks` as const;\n-export const GUILD_WEBHOOKS   = (guildID: string) => `/guilds/${guildID}/webhooks` as const;\n-export const WEBHOOK          = (webhookID: string, webhookToken?: string) => (webhookToken ? `/webhooks/${webhookID}/${webhookToken}` : `/webhooks/${webhookID}`) as `/webhooks/${string}` | `/webhooks/${string}/${string}`;\n-export const WEBHOOK_MESSAGE  = (webhookID: string, webhookToken: string, messageID: string) => `/webhooks/${webhookID}/${webhookToken}/messages/${messageID}` as const;\n-export const WEBHOOK_PLATFORM = (webhookID: string, webhookToken: string, platform: \"github\" | \"slack\") => `/webhooks/${webhookID}/${webhookToken}/${platform}` as const;\n+export const CHANNEL_WEBHOOKS = (channelID: string) => encode`/channels/${channelID}/webhooks`;\n+export const GUILD_WEBHOOKS   = (guildID: string) => encode`/guilds/${guildID}/webhooks`;\n+export const WEBHOOK          = (webhookID: string, webhookToken?: string) => (webhookToken ? encode`/webhooks/${webhookID}/${webhookToken}` : `/webhooks/${webhookID}`) as `/webhooks/${string}` | `/webhooks/${string}/${string}`;\n+export const WEBHOOK_MESSAGE  = (webhookID: string, webhookToken: string, messageID: string) => encode`/webhooks/${webhookID}/${webhookToken}/messages/${messageID}`;\n+export const WEBHOOK_PLATFORM = (webhookID: string, webhookToken: string, platform: \"github\" | \"slack\") => encode`/webhooks/${webhookID}/${webhookToken}/${platform}`;\n \n // Guilds\n-export const GUILD                       = (userID: string) => `/guilds/${userID}` as const;\n-export const GUILDS                      = \"/guilds\" as const;\n-export const GUILD_BANS                  = (guildID: string) => `/guilds/${guildID}/bans` as const;\n-export const GUILD_BAN                   = (guildID: string, userID: string) => `/guilds/${guildID}/bans/${userID}` as const;\n-export const GUILD_AUTOMOD_RULE          = (guildID: string, autoModerationRuleID: string) => `/guilds/${guildID}/auto-moderation/rules/${autoModerationRuleID}` as const;\n-export const GUILD_AUTOMOD_RULES         = (guildID: string) => `/guilds/${guildID}/auto-moderation/rules` as const;\n-export const GUILD_EMOJI                 = (guildID: string, emojiID: string) => `/guilds/${guildID}/emojis/${emojiID}` as const;\n-export const GUILD_EMOJIS                = (guildID: string) => `/guilds/${guildID}/emojis` as const;\n-export const GUILD_AUDIT_LOG             = (guildID: string) => `/guilds/${guildID}/audit-logs` as const;\n-export const GUILD_SCHEDULED_EVENT       = (guildID: string, eventID: string) => `/guilds/${guildID}/scheduled-events/${eventID}` as const;\n-export const GUILD_SCHEDULED_EVENTS      = (guildID: string) => `/guilds/${guildID}/scheduled-events` as const;\n-export const GUILD_SCHEDULED_EVENT_USERS = (guildID: string, eventID: string) => `/guilds/${guildID}/scheduled-events/${eventID}/users` as const;\n-export const GUILD_TEMPLATE_CODE         = (code: string) => `/guilds/templates/${code}` as const;\n-export const GUILD_TEMPLATE              = (guildID: string, templateID: string) => `/guilds/${guildID}/templates/${templateID}` as const;\n-export const GUILD_TEMPLATES             = (guildID: string) => `/guilds/${guildID}/templates` as const;\n-export const GUILD_PREVIEW               = (guildID: string) => `/guilds/${guildID}/preview` as const;\n-export const GUILD_CHANNELS              = (guildID: string) => `/guilds/${guildID}/channels` as const;\n-export const GUILD_ACTIVE_THREADS        = (guildID: string) => `/guilds/${guildID}/threads/active` as const;\n-export const GUILD_MEMBERS               = (guildID: string) => `/guilds/${guildID}/members` as const;\n-export const GUILD_MEMBER                = (guildID: string, userID: string) => `/guilds/${guildID}/members/${userID}` as const;\n-export const GUILD_SEARCH_MEMBERS        = (guildID: string) => `/guilds/${guildID}/members/search` as const;\n-export const GUILD_MEMBER_ROLE           = (guildID: string, userID: string, roleID: string) => `/guilds/${guildID}/members/${userID}/roles/${roleID}` as const;\n-export const GUILD_ROLES                 = (guildID: string) => `/guilds/${guildID}/roles` as const;\n-export const GUILD_ROLE                  = (guildID: string, roleID: string) => `/guilds/${guildID}/roles/${roleID}` as const;\n-export const GUILD_MFA                   = (guildID: string) => `/guilds/${guildID}/mfa` as const;\n-export const GUILD_PRUNE                 = (guildID: string) => `/guilds/${guildID}/prune` as const;\n-export const GUILD_INVITES               = (guildID: string) => `/guilds/${guildID}/invites` as const;\n-export const GUILD_INTEGRATION           = (guildID: string, integrationID: string) => `/guilds/${guildID}/integrations/${integrationID}` as const;\n-export const GUILD_INTEGRATIONS          = (guildID: string) => `/guilds/${guildID}/integrations` as const;\n-export const GUILD_WIDGET                = (guildID: string) => `/guilds/${guildID}/widget` as const;\n-export const GUILD_VANITY_URL            = (guildID: string) => `/guilds/${guildID}/vanity-url` as const;\n-export const GUILD_WIDGET_IMAGE          = (guildID: string) => `/guilds/${guildID}/widget.png` as const;\n-export const GUILD_WIDGET_JSON           = (guildID: string) => `/guilds/${guildID}/widget.json` as const;\n-export const GUILD_WELCOME_SCREEN        = (guildID: string) => `/guilds/${guildID}/welcome-screen` as const;\n-export const GUILD_VOICE_STATE           = (guildID: string, userID: string) => `/guilds/${guildID}/voice-states/${userID}` as const;\n-export const GUILD_STICKER\t\t\t     = (guildID: string, stickerID: string) => `/guilds/${guildID}/stickers/${stickerID}` as const;\n-export const GUILD_STICKERS\t\t\t     = (guildID: string) => `/guilds/${guildID}/stickers` as const;\n-export const GUILD_ONBOARDING            = (guildID: string) => `/guilds/${guildID}/onboarding` as const;\n-export const GUILD_INCIDENT_ACTIONS      = (guildID: string) => `/guilds/${guildID}/incident-actions` as const;\n-export const GUILD_BULK_BAN              = (guildID: string) => `/guilds/${guildID}/bulk-ban` as const;\n+export const GUILD                       = (userID: string) => encode`/guilds/${userID}`;\n+export const GUILDS                      = \"/guilds\";\n+export const GUILD_BANS                  = (guildID: string) => encode`/guilds/${guildID}/bans`;\n+export const GUILD_BAN                   = (guildID: string, userID: string) => encode`/guilds/${guildID}/bans/${userID}`;\n+export const GUILD_AUTOMOD_RULE          = (guildID: string, autoModerationRuleID: string) => encode`/guilds/${guildID}/auto-moderation/rules/${autoModerationRuleID}`;\n+export const GUILD_AUTOMOD_RULES         = (guildID: string) => encode`/guilds/${guildID}/auto-moderation/rules`;\n+export const GUILD_EMOJI                 = (guildID: string, emojiID: string) => encode`/guilds/${guildID}/emojis/${emojiID}`;\n+export const GUILD_EMOJIS                = (guildID: string) => encode`/guilds/${guildID}/emojis`;\n+export const GUILD_AUDIT_LOG             = (guildID: string) => encode`/guilds/${guildID}/audit-logs`;\n+export const GUILD_SCHEDULED_EVENT       = (guildID: string, eventID: string) => encode`/guilds/${guildID}/scheduled-events/${eventID}`;\n+export const GUILD_SCHEDULED_EVENTS      = (guildID: string) => encode`/guilds/${guildID}/scheduled-events`;\n+export const GUILD_SCHEDULED_EVENT_USERS = (guildID: string, eventID: string) => encode`/guilds/${guildID}/scheduled-events/${eventID}/users`;\n+export const GUILD_TEMPLATE_CODE         = (code: string) => encode`/guilds/templates/${code}`;\n+export const GUILD_TEMPLATE              = (guildID: string, templateID: string) => encode`/guilds/${guildID}/templates/${templateID}`;\n+export const GUILD_TEMPLATES             = (guildID: string) => encode`/guilds/${guildID}/templates`;\n+export const GUILD_PREVIEW               = (guildID: string) => encode`/guilds/${guildID}/preview`;\n+export const GUILD_CHANNELS              = (guildID: string) => encode`/guilds/${guildID}/channels`;\n+export const GUILD_ACTIVE_THREADS        = (guildID: string) => encode`/guilds/${guildID}/threads/active`;\n+export const GUILD_MEMBERS               = (guildID: string) => encode`/guilds/${guildID}/members`;\n+export const GUILD_MEMBER                = (guildID: string, userID: string) => encode`/guilds/${guildID}/members/${userID}`;\n+export const GUILD_SEARCH_MEMBERS        = (guildID: string) => encode`/guilds/${guildID}/members/search`;\n+export const GUILD_MEMBER_ROLE           = (guildID: string, userID: string, roleID: string) => encode`/guilds/${guildID}/members/${userID}/roles/${roleID}`;\n+export const GUILD_ROLES                 = (guildID: string) => encode`/guilds/${guildID}/roles`;\n+export const GUILD_ROLE                  = (guildID: string, roleID: string) => encode`/guilds/${guildID}/roles/${roleID}`;\n+export const GUILD_MFA                   = (guildID: string) => encode`/guilds/${guildID}/mfa`;\n+export const GUILD_PRUNE                 = (guildID: string) => encode`/guilds/${guildID}/prune`;\n+export const GUILD_INVITES               = (guildID: string) => encode`/guilds/${guildID}/invites`;\n+export const GUILD_INTEGRATION           = (guildID: string, integrationID: string) => encode`/guilds/${guildID}/integrations/${integrationID}`;\n+export const GUILD_INTEGRATIONS          = (guildID: string) => encode`/guilds/${guildID}/integrations`;\n+export const GUILD_WIDGET                = (guildID: string) => encode`/guilds/${guildID}/widget`;\n+export const GUILD_VANITY_URL            = (guildID: string) => encode`/guilds/${guildID}/vanity-url`;\n+export const GUILD_WIDGET_IMAGE          = (guildID: string) => encode`/guilds/${guildID}/widget.png`;\n+export const GUILD_WIDGET_JSON           = (guildID: string) => encode`/guilds/${guildID}/widget.json`;\n+export const GUILD_WELCOME_SCREEN        = (guildID: string) => encode`/guilds/${guildID}/welcome-screen`;\n+export const GUILD_VOICE_STATE           = (guildID: string, userID: string) => encode`/guilds/${guildID}/voice-states/${userID}`;\n+export const GUILD_STICKER\t\t\t     = (guildID: string, stickerID: string) => encode`/guilds/${guildID}/stickers/${stickerID}`;\n+export const GUILD_STICKERS\t\t\t     = (guildID: string) => encode`/guilds/${guildID}/stickers`;\n+export const GUILD_ONBOARDING            = (guildID: string) => encode`/guilds/${guildID}/onboarding`;\n+export const GUILD_INCIDENT_ACTIONS      = (guildID: string) => encode`/guilds/${guildID}/incident-actions`;\n+export const GUILD_BULK_BAN              = (guildID: string) => encode`/guilds/${guildID}/bulk-ban`;\n \n // Channels\n-export const CHANNEL                                 = (channelID: string) => `/channels/${channelID}` as const;\n-export const CHANNEL_BULK_DELETE_MESSAGES            = (channelID: string) => `/channels/${channelID}/messages/bulk-delete` as const;\n-export const CHANNEL_FOLLOWERS                       = (channelID: string) => `/channels/${channelID}/followers` as const;\n-export const CHANNEL_INVITES                         = (channelID: string) => `/channels/${channelID}/invites` as const;\n-export const CHANNEL_JOINED_PRIVATE_ARCHIVED_THREADS = (channelID: string) => `/channels/${channelID}/users/@me/threads/archived/private` as const;\n-export const CHANNEL_MESSAGE                         = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}` as const;\n-export const CHANNEL_MESSAGES                        = (channelID: string) => `/channels/${channelID}/messages` as const;\n-export const CHANNEL_MESSAGES_CROSSPOST              = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}/crosspost` as const;\n-export const CHANNEL_MESSAGE_THREADS                 = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}/threads` as const;\n-export const CHANNEL_PERMISSION                      = (channelID: string, overwriteID: string) => `/channels/${channelID}/permissions/${overwriteID}` as const;\n-export const CHANNEL_PERMISSIONS                     = (channelID: string) => `/channels/${channelID}/permissions` as const;\n-export const CHANNEL_PINNED_MESSAGE                  = (channelID: string, messageID: string) => `/channels/${channelID}/pins/${messageID}` as const;\n-export const CHANNEL_PINS                            = (channelID: string) => `/channels/${channelID}/pins` as const;\n-export const CHANNEL_PRIVATE_ARCHIVED_THREADS        = (channelID: string) => `/channels/${channelID}/threads/archived/private` as const;\n-export const CHANNEL_PUBLIC_ARCHIVED_THREADS         = (channelID: string) => `/channels/${channelID}/threads/archived/public` as const;\n-export const CHANNEL_REACTION                        = (channelID: string, messageID: string, reaction: string) => `/channels/${channelID}/messages/${messageID}/reactions/${reaction}` as const;\n-export const CHANNEL_REACTIONS                       = (channelID: string, messageID: string) => `/channels/${channelID}/messages/${messageID}/reactions` as const;\n-export const CHANNEL_REACTION_USER                   = (channelID: string, messageID: string, reaction: string, user: string) => `/channels/${channelID}/messages/${messageID}/reactions/${reaction}/${user}` as const;\n-export const CHANNEL_THREADS                         = (channelID: string) => `/channels/${channelID}/threads` as const;\n-export const CHANNEL_THREAD_MEMBER                   = (channelID: string, userID: string) => `/channels/${channelID}/thread-members/${userID}` as const;\n-export const CHANNEL_THREAD_MEMBERS                  = (channelID: string) => `/channels/${channelID}/thread-members` as const;\n-export const CHANNEL_TYPING                          = (channelID: string) => `/channels/${channelID}/typing` as const;\n-export const GROUP_RECIPIENT                         = (channelID: string, userID: string) => `/channels/${channelID}/recipients/${userID}` as const;\n-export const VOICE_REGIONS                           = \"/voice/regions\" as const;\n-export const GUILD_VOICE_REGIONS                     = (guildID: string) => `/guilds/${guildID}/regions` as const;\n-export const VOICE_STATUS                            = (channelID: string) => `/channels/${channelID}/voice-status` as const;\n-export const POLL_ANSWER_USERS                       = (channelID: string, pollID: string, answerID: number) => `/channels/${channelID}/polls/${pollID}/answers/${answerID}` as const;\n-export const POLL_EXPIRE                             = (channelID: string, pollID: string) => `/channels/${channelID}/polls/${pollID}/expire` as const;\n+export const CHANNEL                                 = (channelID: string) => encode`/channels/${channelID}`;\n+export const CHANNEL_BULK_DELETE_MESSAGES            = (channelID: string) => encode`/channels/${channelID}/messages/bulk-delete`;\n+export const CHANNEL_FOLLOWERS                       = (channelID: string) => encode`/channels/${channelID}/followers`;\n+export const CHANNEL_INVITES                         = (channelID: string) => encode`/channels/${channelID}/invites`;\n+export const CHANNEL_JOINED_PRIVATE_ARCHIVED_THREADS = (channelID: string) => encode`/channels/${channelID}/users/@me/threads/archived/private`;\n+export const CHANNEL_MESSAGE                         = (channelID: string, messageID: string) => encode`/channels/${channelID}/messages/${messageID}`;\n+export const CHANNEL_MESSAGES                        = (channelID: string) => encode`/channels/${channelID}/messages`;\n+export const CHANNEL_MESSAGES_CROSSPOST              = (channelID: string, messageID: string) => encode`/channels/${channelID}/messages/${messageID}/crosspost`;\n+export const CHANNEL_MESSAGE_THREADS                 = (channelID: string, messageID: string) => encode`/channels/${channelID}/messages/${messageID}/threads`;\n+export const CHANNEL_PERMISSION                      = (channelID: string, overwriteID: string) => encode`/channels/${channelID}/permissions/${overwriteID}`;\n+export const CHANNEL_PERMISSIONS                     = (channelID: string) => encode`/channels/${channelID}/permissions`;\n+export const CHANNEL_PINNED_MESSAGE                  = (channelID: string, messageID: string) => encode`/channels/${channelID}/pins/${messageID}`;\n+export const CHANNEL_PINS                            = (channelID: string) => encode`/channels/${channelID}/pins`;\n+export const CHANNEL_PRIVATE_ARCHIVED_THREADS        = (channelID: string) => encode`/channels/${channelID}/threads/archived/private`;\n+export const CHANNEL_PUBLIC_ARCHIVED_THREADS         = (channelID: string) => encode`/channels/${channelID}/threads/archived/public`;\n+export const CHANNEL_REACTION                        = (channelID: string, messageID: string, reaction: string) => encode`/channels/${channelID}/messages/${messageID}/reactions/${reaction}`;\n+export const CHANNEL_REACTIONS                       = (channelID: string, messageID: string) => encode`/channels/${channelID}/messages/${messageID}/reactions`;\n+export const CHANNEL_REACTION_USER                   = (channelID: string, messageID: string, reaction: string, user: string) => encode`/channels/${channelID}/messages/${messageID}/reactions/${reaction}/${user}`;\n+export const CHANNEL_THREADS                         = (channelID: string) => encode`/channels/${channelID}/threads`;\n+export const CHANNEL_THREAD_MEMBER                   = (channelID: string, userID: string) => encode`/channels/${channelID}/thread-members/${userID}`;\n+export const CHANNEL_THREAD_MEMBERS                  = (channelID: string) => encode`/channels/${channelID}/thread-members`;\n+export const CHANNEL_TYPING                          = (channelID: string) => encode`/channels/${channelID}/typing`;\n+export const GROUP_RECIPIENT                         = (channelID: string, userID: string) => encode`/channels/${channelID}/recipients/${userID}`;\n+export const VOICE_REGIONS                           = \"/voice/regions\";\n+export const GUILD_VOICE_REGIONS                     = (guildID: string) => encode`/guilds/${guildID}/regions`;\n+export const VOICE_STATUS                            = (channelID: string) => encode`/channels/${channelID}/voice-status`;\n+export const POLL_ANSWER_USERS                       = (channelID: string, pollID: string, answerID: number) => encode`/channels/${channelID}/polls/${pollID}/answers/${answerID}`;\n+export const POLL_EXPIRE                             = (channelID: string, pollID: string) => encode`/channels/${channelID}/polls/${pollID}/expire`;\n \n // OAuth\n-export const OAUTH_APPLICATION         = \"/oauth2/applications/@me\" as const;\n-export const OAUTH_AUTHORIZE           = \"/oauth2/authorize\" as const;\n-export const OAUTH_INFO                = \"/oauth2/@me\" as const;\n-export const OAUTH_CURRENT_USER        = \"/users/@me\" as const;\n-export const OAUTH_CHANNELS            = \"/users/@me/channels\" as const;\n-export const OAUTH_CONNECTIONS         = \"/users/@me/connections\" as const;\n-export const OAUTH_GUILD               = (guildID: string) => `/users/@me/guilds/${guildID}` as const;\n-export const OAUTH_GUILD_MEMBER        = (guildID: string) => `${OAUTH_GUILD(guildID)}/member` as const;\n-export const OAUTH_GUILDS              = \"/users/@me/guilds\" as const;\n-export const OAUTH_TOKEN               = \"/oauth2/token\" as const;\n-export const OAUTH_TOKEN_REVOKE        = \"/oauth2/token/revoke\" as const;\n-export const OAUTH_ROLE_CONNECTION     = (applicationID: string) => `/users/@me/applications/${applicationID}/role-connection` as const;\n-export const ROLE_CONNECTIONS_METADATA = (applicationID: string) => `/applications/${applicationID}/role-connections/metadata` as const;\n+export const OAUTH_APPLICATION         = \"/oauth2/applications/@me\";\n+export const OAUTH_AUTHORIZE           = \"/oauth2/authorize\";\n+export const OAUTH_INFO                = \"/oauth2/@me\";\n+export const OAUTH_CURRENT_USER        = \"/users/@me\";\n+export const OAUTH_CHANNELS            = \"/users/@me/channels\";\n+export const OAUTH_CONNECTIONS         = \"/users/@me/connections\";\n+export const OAUTH_GUILD               = (guildID: string) => encode`/users/@me/guilds/${guildID}`;\n+export const OAUTH_GUILD_MEMBER        = (guildID: string) => encode`${OAUTH_GUILD(guildID)}/member`;\n+export const OAUTH_GUILDS              = \"/users/@me/guilds\";\n+export const OAUTH_TOKEN               = \"/oauth2/token\";\n+export const OAUTH_TOKEN_REVOKE        = \"/oauth2/token/revoke\";\n+export const OAUTH_ROLE_CONNECTION     = (applicationID: string) => encode`/users/@me/applications/${applicationID}/role-connection`;\n+export const ROLE_CONNECTIONS_METADATA = (applicationID: string) => encode`/applications/${applicationID}/role-connections/metadata`;\n \n // Images\n-export const ACHIEVEMENT_ICON            = (applicationID: string, achievementID: string, hash: string) => `/app-assets/${applicationID}/achievements/${achievementID}/icons/${hash}` as const;\n-export const APPLICATION_ASSET           = (applicationID: string, assetID: string) => `/applications/${applicationID}/assets/${assetID}` as const;\n-export const APPLICATION_COVER           = (applicationID: string, hash: string) => `/app-icons/${applicationID}/${hash}` as const;\n+export const ACHIEVEMENT_ICON            = (applicationID: string, achievementID: string, hash: string) => encode`/app-assets/${applicationID}/achievements/${achievementID}/icons/${hash}`;\n+export const APPLICATION_ASSET           = (applicationID: string, assetID: string) => encode`/applications/${applicationID}/assets/${assetID}`;\n+export const APPLICATION_COVER           = (applicationID: string, hash: string) => encode`/app-icons/${applicationID}/${hash}`;\n export const APPLICATION_ICON            = APPLICATION_COVER;\n-export const BANNER                      = (guildOrUserID: string, hash: string) => `/banners/${guildOrUserID}/${hash}` as const;\n-export const CUSTOM_EMOJI                = (emojiID: string) => `/emojis/${emojiID}` as const;\n-export const EMBED_AVATAR                = (mod: number) => `/embed/avatars/${mod}` as const;\n-export const GUILD_AVATAR                = (guildID: string, userID: string, hash: string) => `/guilds/${guildID}/users/${userID}/avatars/${hash}` as const;\n-export const GUILD_DISCOVERY_SPLASH      = (guildID: string, hash: string) => `/guilds/${guildID}/splashes/${hash}` as const;\n-export const GUILD_ICON                  = (guildID: string, hash: string) => `/icons/${guildID}/${hash}` as const;\n-export const GUILD_SCHEDULED_EVENT_COVER = (eventID: string, hash: string) => `/guild-events/${eventID}/${hash}` as const;\n-export const GUILD_SPLASH                = (guildID: string, hash: string) => `/splashes/${guildID}/${hash}` as const;\n-export const MEMBER_BANNER               = (guildID: string, userID: string, hash: string) => `/guilds/${guildID}/users/${userID}/banners/${hash}` as const;\n-export const ROLE_ICON                   = (roleID: string, hash: string) => `/role-icons/${roleID}/${hash}` as const;\n-export const STICKER                     = (stickerID: string) => `/stickers/${stickerID}` as const;\n+export const BANNER                      = (guildOrUserID: string, hash: string) => encode`/banners/${guildOrUserID}/${hash}`;\n+export const CUSTOM_EMOJI                = (emojiID: string) => encode`/emojis/${emojiID}`;\n+export const EMBED_AVATAR                = (mod: number) => encode`/embed/avatars/${mod}`;\n+export const GUILD_AVATAR                = (guildID: string, userID: string, hash: string) => encode`/guilds/${guildID}/users/${userID}/avatars/${hash}`;\n+export const GUILD_DISCOVERY_SPLASH      = (guildID: string, hash: string) => encode`/guilds/${guildID}/splashes/${hash}`;\n+export const GUILD_ICON                  = (guildID: string, hash: string) => encode`/icons/${guildID}/${hash}`;\n+export const GUILD_SCHEDULED_EVENT_COVER = (eventID: string, hash: string) => encode`/guild-events/${eventID}/${hash}`;\n+export const GUILD_SPLASH                = (guildID: string, hash: string) => encode`/splashes/${guildID}/${hash}`;\n+export const MEMBER_BANNER               = (guildID: string, userID: string, hash: string) => encode`/guilds/${guildID}/users/${userID}/banners/${hash}`;\n+export const ROLE_ICON                   = (roleID: string, hash: string) => encode`/role-icons/${roleID}/${hash}`;\n+export const STICKER                     = (stickerID: string) => encode`/stickers/${stickerID}`;\n export const STICKER_PACK_BANNER         = (assetID: string) => APPLICATION_ASSET(\"710982414301790216\", assetID);\n-export const TEAM_ICON                   = (teamID: string, hash: string) => `/team-icons/${teamID}/${hash}` as const;\n-export const USER_AVATAR                 = (userID: string, hash: string) => `/avatars/${userID}/${hash}` as const;\n-export const USER_AVATAR_DECORATION      = (userID: string, hash: string) => `/avatar-decorations/${userID}/${hash}` as const;\n+export const TEAM_ICON                   = (teamID: string, hash: string) => encode`/team-icons/${teamID}/${hash}`;\n+export const USER_AVATAR                 = (userID: string, hash: string) => encode`/avatars/${userID}/${hash}`;\n+export const USER_AVATAR_DECORATION      = (userID: string, hash: string) => encode`/avatar-decorations/${userID}/${hash}`;\n \n // Applications\n-export const APPLICATION_COMMAND                   = (applicationID: string, commandID: string) => `/applications/${applicationID}/commands/${commandID}` as const;\n-export const APPLICATION_COMMANDS                  = (applicationID: string) => `/applications/${applicationID}/commands` as const;\n-export const GUILD_APPLICATION_COMMAND             = (applicationID: string, guildID: string, commandID: string) => `/applications/${applicationID}/guilds/${guildID}/commands/${commandID}` as const;\n-export const GUILD_APPLICATION_COMMANDS            = (applicationID: string, guildID: string) => `/applications/${applicationID}/guilds/${guildID}/commands` as const;\n-export const GUILD_APPLICATION_COMMAND_PERMISSION  = (applicationID: string, guildID: string, commandID: string) => `/applications/${applicationID}/guilds/${guildID}/commands/${commandID}/permissions` as const;\n-export const GUILD_APPLICATION_COMMAND_PERMISSIONS = (applicationID: string, guildID: string) => `/applications/${applicationID}/guilds/${guildID}commands/permissions` as const;\n-export const INTERACTION_CALLBACK                  = (interactionID: string, interactionToken: string) => `/interactions/${interactionID}/${interactionToken}/callback` as const;\n-export const APPLICATION                           = \"/applications/@me\" as const;\n-export const ENTITLEMENTS                          = (applicationID: string) => `/applications/${applicationID}/entitlements` as const;\n-export const ENTITLEMENT                           = (applicationID: string, entitlementID: string) => `/applications/${applicationID}/entitlements/${entitlementID}` as const;\n-export const SKUS                                  = (applicationID: string) => `/applications/${applicationID}/skus` as const;\n+export const APPLICATION_COMMAND                   = (applicationID: string, commandID: string) => encode`/applications/${applicationID}/commands/${commandID}`;\n+export const APPLICATION_COMMANDS                  = (applicationID: string) => encode`/applications/${applicationID}/commands`;\n+export const GUILD_APPLICATION_COMMAND             = (applicationID: string, guildID: string, commandID: string) => encode`/applications/${applicationID}/guilds/${guildID}/commands/${commandID}`;\n+export const GUILD_APPLICATION_COMMANDS            = (applicationID: string, guildID: string) => encode`/applications/${applicationID}/guilds/${guildID}/commands`;\n+export const GUILD_APPLICATION_COMMAND_PERMISSION  = (applicationID: string, guildID: string, commandID: string) => encode`/applications/${applicationID}/guilds/${guildID}/commands/${commandID}/permissions`;\n+export const GUILD_APPLICATION_COMMAND_PERMISSIONS = (applicationID: string, guildID: string) => encode`/applications/${applicationID}/guilds/${guildID}commands/permissions`;\n+export const INTERACTION_CALLBACK                  = (interactionID: string, interactionToken: string) => encode`/interactions/${interactionID}/${interactionToken}/callback`;\n+export const APPLICATION                           = \"/applications/@me\";\n+export const ENTITLEMENTS                          = (applicationID: string) => encode`/applications/${applicationID}/entitlements`;\n+export const ENTITLEMENT                           = (applicationID: string, entitlementID: string) => encode`/applications/${applicationID}/entitlements/${entitlementID}`;\n+export const SKUS                                  = (applicationID: string) => encode`/applications/${applicationID}/skus`;\n \n // Misc\n-export const GATEWAY                   = \"/gateway\" as const;\n-export const GATEWAY_BOT               = \"/gateway/bot\" as const;\n-export const USER                      = (userID: string) => `/users/${userID}` as const;\n-export const MESSAGE_LINK              = (guildID: string, channelID: string, messageID: string) => `/channels/${guildID}/${channelID}/${messageID}` as const;\n-export const STICKER_PACKS             = \"/sticker-packs\" as const;\n-export const INVITE                    = (code: string) => `/invites/${code}` as const;\n-export const STAGE_INSTANCES           = \"/stage-instances\" as const;\n-export const STAGE_INSTANCE            = (channelID: string) => `/stage-instances/${channelID}` as const;\n-export const REFRESH_ATTACHMENT_URLS   = \"/attachments/refresh-urls\" as const;\n+export const GATEWAY                   = \"/gateway\";\n+export const GATEWAY_BOT               = \"/gateway/bot\";\n+export const USER                      = (userID: string) => encode`/users/${userID}`;\n+export const MESSAGE_LINK              = (guildID: string, channelID: string, messageID: string) => encode`/channels/${guildID}/${channelID}/${messageID}`;\n+export const STICKER_PACKS             = \"/sticker-packs\";\n+export const INVITE                    = (code: string) => encode`/invites/${code}`;\n+export const STAGE_INSTANCES           = \"/stage-instances\";\n+export const STAGE_INSTANCE            = (channelID: string) => encode`/stage-instances/${channelID}`;\n+export const REFRESH_ATTACHMENT_URLS   = \"/attachments/refresh-urls\";"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9ca907f46d45da4afa8c9be9e81e3093925c73c5",
            "date": "2024-10-26T00:27:03Z",
            "author_login": "DonovanDMC"
          },
          {
            "sha": "d95ae54c9a0f2c9ea4a802e984c6591958ee37aa",
            "date": "2024-10-25T22:32:41Z",
            "author_login": "DonovanDMC"
          },
          {
            "sha": "8479bd49e07a5534118c24169b99cb82fe37fa4e",
            "date": "2024-10-25T22:25:52Z",
            "author_login": "DonovanDMC"
          },
          {
            "sha": "eb72695fd03fa5757c5d9c93b00206e5bbb0f7ff",
            "date": "2024-10-02T16:37:24Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "5bbffefd4c2eb980f8cb2557444d27782cec11db",
            "date": "2024-10-02T16:35:36Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
    "cwe_id": "CWE-22",
    "description": "Oceanic is a NodeJS library for interfacing with Discord. Prior to version 1.10.4, input to functions such as `Client.rest.channels.removeBan` is not url-encoded, resulting in specially crafted input such as `../../../channels/{id}` being normalized into the url `/api/v10/channels/{id}`, and deleting a channel rather than removing a ban. Version 1.10.4 fixes this issue. Some workarounds are available. One may sanitize user input, ensuring strings are valid for the purpose they are being used for. One may also encode input with `encodeURIComponent` before providing it to the library.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-14T16:17:26.600",
    "last_modified": "2024-11-21T09:19:14.830",
    "fix_date": "2024-05-13T23:52:45Z"
  },
  "references": [
    {
      "url": "https://github.com/OceanicJS/Oceanic/commit/8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/OceanicJS/Oceanic/security/advisories/GHSA-5h5v-hw44-f6gg",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/OceanicJS/Oceanic/commit/8bf8ee8373b8c565fbdbf70a609aba4fbc1a1ffe",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/OceanicJS/Oceanic/security/advisories/GHSA-5h5v-hw44-f6gg",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:20.912721",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Oceanic",
    "owner": "OceanicJS",
    "created_at": "2022-08-07T02:37:46Z",
    "updated_at": "2025-01-02T23:48:07Z",
    "pushed_at": "2025-01-01T20:55:09Z",
    "size": 13619,
    "stars": 273,
    "forks": 28,
    "open_issues": 9,
    "watchers": 273,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "TypeScript": 956303,
      "JavaScript": 11115
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T22:20:41.888964"
  }
}