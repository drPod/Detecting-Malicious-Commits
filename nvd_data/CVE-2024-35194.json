{
  "cve_id": "CVE-2024-35194",
  "github_data": {
    "repository": "stacklok/minder",
    "fix_commit": "fe321d345b4f738de6a06b13207addc72b59f892",
    "related_commits": [
      "fe321d345b4f738de6a06b13207addc72b59f892",
      "fe321d345b4f738de6a06b13207addc72b59f892"
    ],
    "patch_url": "https://github.com/stacklok/minder/commit/fe321d345b4f738de6a06b13207addc72b59f892.patch",
    "fix_commit_details": {
      "sha": "fe321d345b4f738de6a06b13207addc72b59f892",
      "commit_date": "2024-05-20T16:52:50Z",
      "author": {
        "login": "JAORMX",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-8fmj-33gw-g7pw",
        "length": 227,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "internal/verifier/sigstore/container/container.go",
          "status": "modified",
          "additions": 9,
          "deletions": 2,
          "patch": "@@ -24,6 +24,7 @@ import (\n \t\"encoding/pem\"\n \t\"errors\"\n \t\"fmt\"\n+\t\"io\"\n \t\"net/http\"\n \t\"strings\"\n \n@@ -49,6 +50,10 @@ var (\n \t// ErrProvenanceNotFoundOrIncomplete is returned when there's no provenance info (missing .sig or attestation) or\n \t// has incomplete data\n \tErrProvenanceNotFoundOrIncomplete = errors.New(\"provenance not found or incomplete\")\n+\n+\t// MaxAttestationsBytesLimit is the maximum number of bytes we're willing to read from the attestation endpoint\n+\t// We'll limit this to 10mb for now\n+\tMaxAttestationsBytesLimit int64 = 10 * 1024 * 1024\n )\n \n const (\n@@ -291,8 +296,9 @@ func getAttestationReply(\n \t}\n \tdefer resp.Body.Close()\n \n+\tlr := io.LimitReader(resp.Body, MaxAttestationsBytesLimit)\n \tvar attestationReply AttestationReply\n-\tif err := json.NewDecoder(resp.Body).Decode(&attestationReply); err != nil {\n+\tif err := json.NewDecoder(lr).Decode(&attestationReply); err != nil {\n \t\treturn nil, fmt.Errorf(\"error decoding response: %w\", err)\n \t}\n \n@@ -446,7 +452,8 @@ func getSimpleSigningLayersFromSignatureManifest(manifestRef string, auth authn.\n \t}\n \n \t// Parse the manifest\n-\tmanifest, err := v1.ParseManifest(bytes.NewReader(mf))\n+\tr := io.LimitReader(bytes.NewReader(mf), MaxAttestationsBytesLimit)\n+\tmanifest, err := v1.ParseManifest(r)\n \tif err != nil {\n \t\treturn nil, fmt.Errorf(\"error parsing signature manifest: %w\", err)\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8373b8030ec90dbde8a19dd9b7a7f5c3639112d3",
            "date": "2025-01-14T11:22:31Z",
            "author_login": "eleftherias"
          },
          {
            "sha": "0a089beb20a3e819fa4b730bf40bac7728164050",
            "date": "2025-01-14T08:53:32Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "95e9036cf631a5162e31541f2cdecd5bb08c77e6",
            "date": "2025-01-14T08:53:08Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "ca1e9121478cf27cb183e20c3afea7ba980081ba",
            "date": "2025-01-14T08:20:16Z",
            "author_login": "JAORMX"
          },
          {
            "sha": "cc38ccde3608df3370d4eb8e71a12d08f46dde1b",
            "date": "2025-01-14T08:10:17Z",
            "author_login": "JAORMX"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-400",
    "description": "Minder is a software supply chain security platform. Prior to version 0.0.50, Minder engine is susceptible to a denial of service from memory exhaustion that can be triggered from maliciously created templates. Minder engine uses templating to generate strings for various use cases such as URLs, messages for pull requests, descriptions for advisories. In some cases can the user control both the template and the params for it, and in a subset of these cases, Minder reads the generated template entirely into memory. When Minders templating meets both of these conditions, an attacker is able to generate large enough templates that Minder will exhaust memory and crash. This vulnerability is fixed in 0.0.50.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-05-20T21:15:09.773",
    "last_modified": "2024-11-21T09:19:54.380",
    "fix_date": "2024-05-20T16:52:50Z"
  },
  "references": [
    {
      "url": "https://github.com/stacklok/minder/commit/fe321d345b4f738de6a06b13207addc72b59f892",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/stacklok/minder/security/advisories/GHSA-crgc-2583-rw27",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/stacklok/minder/commit/fe321d345b4f738de6a06b13207addc72b59f892",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/stacklok/minder/security/advisories/GHSA-crgc-2583-rw27",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:24.267329",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "minder",
    "owner": "stacklok",
    "created_at": "2023-04-05T16:47:15Z",
    "updated_at": "2025-01-14T15:03:03Z",
    "pushed_at": "2025-01-14T11:22:31Z",
    "size": 129864,
    "stars": 306,
    "forks": 41,
    "open_issues": 125,
    "watchers": 306,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Go": 3893376,
      "PLpgSQL": 125512,
      "Makefile": 14093,
      "Dockerfile": 3059,
      "HTML": 2450,
      "Shell": 1410,
      "Smarty": 538,
      "CSS": 429
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:37:25.727886"
  }
}