{
  "cve_id": "CVE-2024-35230",
  "github_data": {
    "repository": "geoserver/geoserver",
    "fix_commit": "74fdab745a5deff20ac99abca24d8695fe1a52f8",
    "related_commits": [
      "74fdab745a5deff20ac99abca24d8695fe1a52f8",
      "8cd1590a604a10875de67b04995f1952f631f920"
    ],
    "patch_url": "https://github.com/geoserver/geoserver/commit/74fdab745a5deff20ac99abca24d8695fe1a52f8.patch",
    "fix_commit_details": {
      "sha": "74fdab745a5deff20ac99abca24d8695fe1a52f8",
      "commit_date": "2024-05-13T22:53:08Z",
      "author": {
        "login": "david-blasby",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "hide version info on footer and (not visible to user on browser, but in HTML) header",
        "length": 84,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 27,
        "additions": 26,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/web/core/src/main/java/org/geoserver/web/GeoServerBasePage.java",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -267,7 +267,7 @@ protected void onComponentTag(org.apache.wicket.markup.ComponentTag tag) {\n         // home page link\n         add(\n                 new BookmarkablePageLink<>(\"home\", GeoServerHomePage.class)\n-                        .add(new Label(\"label\", new StringResourceModel(\"home\", null, null))));\n+                        .add(new Label(\"label\", \"\")));\n \n         // dev buttons\n         DeveloperToolbar devToolbar = new DeveloperToolbar(\"devButtons\");"
        },
        {
          "filename": "src/web/core/src/main/java/org/geoserver/web/GeoServerHomePage.java",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -645,6 +645,12 @@ private Label belongsTo(ContactInfo contactInfo, Locale locale) {\n     private Label footerMessage(ContactInfo contactInfo, Locale locale) {\n         String version = String.valueOf(new ResourceModel(\"version\").getObject());\n \n+        boolean admin = getSession().isAdmin();\n+        if (!admin) {\n+            Label footerMessage = new Label(\"footerMessage\", \"\");\n+            return footerMessage;\n+        }\n+\n         HashMap<String, String> params = new HashMap<>();\n         params.put(\"version\", version);\n "
        },
        {
          "filename": "src/web/core/src/test/java/org/geoserver/web/GeoServerHomePageTest.java",
          "status": "modified",
          "additions": 19,
          "deletions": 0,
          "patch": "@@ -12,6 +12,7 @@\n import static org.junit.Assert.assertFalse;\n import static org.junit.Assert.assertNotSame;\n import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.assertTrue;\n \n import java.util.ArrayList;\n import java.util.Collections;\n@@ -21,6 +22,7 @@\n import org.apache.wicket.Page;\n import org.apache.wicket.markup.html.basic.Label;\n import org.apache.wicket.markup.html.form.TextField;\n+import org.apache.wicket.model.StringResourceModel;\n import org.apache.wicket.util.tester.FormTester;\n import org.geoserver.catalog.PublishedInfo;\n import org.geoserver.catalog.WorkspaceInfo;\n@@ -290,6 +292,23 @@ public void testAutoSelection() throws Exception {\n         tester.assertComponent(\"form:layer:select\", Select2DropDownChoice.class);\n     }\n \n+    @Test\n+    public void testHideSensitiveInfo() throws Exception {\n+        logout();\n+        tester.startPage(GeoServerHomePage.class);\n+\n+        var version = new StringResourceModel(\"version\", null, null).getString();\n+\n+        String responseTxt = tester.getLastResponse().getDocument();\n+        assertFalse(responseTxt.contains(version));\n+\n+        login();\n+        tester.startPage(GeoServerHomePage.class);\n+\n+        responseTxt = tester.getLastResponse().getDocument();\n+        assertTrue(responseTxt.contains(version));\n+    }\n+\n     public static class MockHomePageContentProvider implements GeoServerHomePageContentProvider {\n         @Override\n         public Component getPageBodyComponent(final String id) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "159e5bf6afbfb9776f08cbe03d8ed09cb2d55507",
            "date": "2025-01-13T09:52:26Z",
            "author_login": "osgeoweblate"
          },
          {
            "sha": "87d9c20e47643bed223bf2a39d546b2a770c9b29",
            "date": "2025-01-13T09:01:15Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "ae63d2cefb5114fec88c4831af61252fbef9dceb",
            "date": "2025-01-06T10:38:14Z",
            "author_login": "aaime"
          },
          {
            "sha": "31ed8d7da74d757bc199ed550ec52c2340781134",
            "date": "2025-01-08T11:01:24Z",
            "author_login": "aaime"
          },
          {
            "sha": "9eedb76aaa41300e4dcc0db538d26cd860ef8cc3",
            "date": "2025-01-08T04:32:41Z",
            "author_login": "jodygarnett"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "GeoServer is an open source software server written in Java that allows users to share and edit geospatial data. In affected versions the welcome and about page includes version and revision information about the software in use (including library and components used). This information is sensitive from a security point of view because it allows software used by the server to be easily identified. This issue has been patched in version 2.26.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-12-16T23:15:06.467",
    "last_modified": "2024-12-17T15:15:12.403",
    "fix_date": "2024-05-13T22:53:08Z"
  },
  "references": [
    {
      "url": "https://github.com/geoserver/geoserver/commit/74fdab745a5deff20ac99abca24d8695fe1a52f8",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/geoserver/geoserver/commit/8cd1590a604a10875de67b04995f1952f631f920",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-6pfc-w86r-54q6",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-6pfc-w86r-54q6",
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:52.872627",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "geoserver",
    "owner": "geoserver",
    "created_at": "2011-11-10T19:56:06Z",
    "updated_at": "2025-01-13T14:27:07Z",
    "pushed_at": "2025-01-13T09:52:26Z",
    "size": 319674,
    "stars": 3917,
    "forks": 2193,
    "open_issues": 12,
    "watchers": 3917,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "2.1.x",
      "2.2.x",
      "2.3.x",
      "2.4.x",
      "2.5.x",
      "2.6.x",
      "2.6.0.x",
      "2.7.x",
      "2.7.1.x",
      "2.8.x",
      "2.9.x",
      "2.10.x",
      "2.11.x",
      "2.12.x",
      "2.13.x",
      "2.14.x",
      "2.15.x",
      "2.16.x",
      "2.17.x",
      "2.18.x",
      "2.19.x",
      "2.20.x",
      "2.21.x",
      "2.22.x",
      "2.23.x",
      "2.24.x",
      "2.25.x"
    ],
    "languages": {
      "Java": 44761611,
      "JavaScript": 1182828,
      "Scheme": 1167338,
      "HTML": 712425,
      "FreeMarker": 215786,
      "XSLT": 156026,
      "CSS": 120514,
      "Shell": 50551,
      "NSIS": 44051,
      "Python": 18317,
      "Makefile": 17825,
      "Batchfile": 13345,
      "AMPL": 8670,
      "Dockerfile": 3836,
      "Fluent": 117
    },
    "commit_activity": {
      "total_commits_last_year": 617,
      "avg_commits_per_week": 11.865384615384615,
      "days_active_last_year": 235
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:58:19.409251"
  }
}