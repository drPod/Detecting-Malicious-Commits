{
  "cve_id": "CVE-2024-35242",
  "github_data": {
    "repository": "composer/composer",
    "fix_commit": "6bd43dff859c597c09bd03a7e7d6443822d0a396",
    "related_commits": [
      "6bd43dff859c597c09bd03a7e7d6443822d0a396",
      "fc57b93603d7d90b71ca8ec77b1c8a9171fdb467",
      "6bd43dff859c597c09bd03a7e7d6443822d0a396",
      "fc57b93603d7d90b71ca8ec77b1c8a9171fdb467"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "6bd43dff859c597c09bd03a7e7d6443822d0a396",
      "commit_date": "2024-06-10T12:56:13Z",
      "author": {
        "login": "Seldaek",
        "type": "User",
        "stats": {
          "total_commits": 7388,
          "average_weekly_commits": 10.232686980609419,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 554
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-v9qv-c7wm-wgmf",
        "length": 43,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 11,
        "deletions": 10
      },
      "files": [
        {
          "filename": "src/Composer/Package/Version/VersionGuesser.php",
          "status": "modified",
          "additions": 8,
          "deletions": 7,
          "patch": "@@ -173,7 +173,7 @@ private function guessGitVersion(array $packageConfig, string $path): array\n                 $featurePrettyVersion = $prettyVersion;\n \n                 // try to find the best (nearest) version branch to assume this feature's version\n-                $result = $this->guessFeatureVersion($packageConfig, $version, $branches, 'git rev-list %candidate%..%branch%', $path);\n+                $result = $this->guessFeatureVersion($packageConfig, $version, $branches, ['git', 'rev-list', '%candidate%..%branch%'], $path);\n                 $version = $result['version'];\n                 $prettyVersion = $result['pretty_version'];\n             }\n@@ -248,7 +248,7 @@ private function guessHgVersion(array $packageConfig, string $path): ?array\n             $branches = array_map('strval', array_keys($driver->getBranches()));\n \n             // try to find the best (nearest) version branch to assume this feature's version\n-            $result = $this->guessFeatureVersion($packageConfig, $version, $branches, 'hg log -r \"not ancestors(\\'%candidate%\\') and ancestors(\\'%branch%\\')\" --template \"{node}\\\\n\"', $path);\n+            $result = $this->guessFeatureVersion($packageConfig, $version, $branches, ['hg', 'log', '-r', 'not ancestors(\\'%candidate%\\') and ancestors(\\'%branch%\\')', '--template', '\"{node}\\\\n\"'], $path);\n             $result['commit'] = '';\n             $result['feature_version'] = $version;\n             $result['feature_pretty_version'] = $version;\n@@ -261,13 +261,12 @@ private function guessHgVersion(array $packageConfig, string $path): ?array\n \n     /**\n      * @param array<string, mixed>     $packageConfig\n-     * @param string[]                 $branches\n-     *\n-     * @phpstan-param non-empty-string $scmCmdline\n+     * @param list<string>             $branches\n+     * @param list<string>             $scmCmdline\n      *\n      * @return array{version: string|null, pretty_version: string|null}\n      */\n-    private function guessFeatureVersion(array $packageConfig, ?string $version, array $branches, string $scmCmdline, string $path): array\n+    private function guessFeatureVersion(array $packageConfig, ?string $version, array $branches, array $scmCmdline, string $path): array\n     {\n         $prettyVersion = $version;\n \n@@ -309,7 +308,9 @@ private function guessFeatureVersion(array $packageConfig, ?string $version, arr\n                         continue;\n                     }\n \n-                    $cmdLine = str_replace(['%candidate%', '%branch%'], [$candidate, $branch], $scmCmdline);\n+                    $cmdLine = array_map(static function (string $component) use ($candidate, $branch) {\n+                        return str_replace(['%candidate%', '%branch%'], [$candidate, $branch], $component);\n+                    }, $scmCmdline);\n                     $promises[] = $this->process->executeAsync($cmdLine, $path)->then(function (Process $process) use (&$length, &$version, &$prettyVersion, $candidateVersion, &$promises): void {\n                         if (!$process->isSuccessful()) {\n                             return;"
        },
        {
          "filename": "tests/Composer/Test/Package/Version/VersionGuesserTest.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -117,7 +117,7 @@ public function testGuessVersionReadsAndRespectsNonFeatureBranchesConfigurationF\n                 'stdout' => \"  arbitrary $commitHash Commit message\\n* feature $anotherCommitHash Another message\\n\",\n             ],\n             [\n-                'cmd' => 'git rev-list arbitrary..feature',\n+                'cmd' => ['git', 'rev-list', 'arbitrary..feature'],\n                 'stdout' => \"$anotherCommitHash\\n\",\n             ],\n         ], true);\n@@ -147,7 +147,7 @@ public function testGuessVersionReadsAndRespectsNonFeatureBranchesConfigurationF\n                 'stdout' => \"  latest-testing $commitHash Commit message\\n* feature $anotherCommitHash Another message\\n\",\n             ],\n             [\n-                'cmd' => 'git rev-list latest-testing..feature',\n+                'cmd' => ['git', 'rev-list', 'latest-testing..feature'],\n                 'stdout' => \"$anotherCommitHash\\n\",\n             ],\n         ], true);\n@@ -352,7 +352,7 @@ public function testRemoteBranchesAreSelected(): void\n                         \"remotes/origin/1.5 03a15d220da53c52eddd5f32ffca64a7b3801bea Commit message\\n\",\n             ],\n             [\n-                'cmd' => 'git rev-list remotes/origin/1.5..feature-branch',\n+                'cmd' => ['git', 'rev-list', 'remotes/origin/1.5..feature-branch'],\n                 'stdout' => \"\\n\",\n             ],\n         ], true);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ddda2ff0a2a97be7360f16b8b26d063eb2ea8c5f",
            "date": "2025-01-22T09:06:06Z",
            "author_login": "Seldaek"
          },
          {
            "sha": "9d68f670918934e47acd65f6cf53d54da9a0da0e",
            "date": "2025-01-22T08:55:30Z",
            "author_login": "Seldaek"
          },
          {
            "sha": "465364d754940900a37eb2ddc92545de8a082933",
            "date": "2025-01-22T08:47:27Z",
            "author_login": "Seldaek"
          },
          {
            "sha": "6d03fad8a50574fcd6e9e0cc4871ba7d1aa5038b",
            "date": "2025-01-21T14:23:40Z",
            "author_login": "Seldaek"
          },
          {
            "sha": "ae208dc1e182bd45d99fcecb956501da212454a1",
            "date": "2025-01-21T14:23:40Z",
            "author_login": "Seldaek"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-77",
    "description": "Composer is a dependency manager for PHP. On the 2.x branch prior to versions 2.2.24 and 2.7.7, the `composer install` command running inside a git/hg repository which has specially crafted branch names can lead to command injection. This requires cloning untrusted repositories. Patches are available in version 2.2.24 for 2.2 LTS or 2.7.7 for mainline. As a workaround, avoid cloning potentially compromised repositories.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-10T22:15:09.893",
    "last_modified": "2024-11-21T09:20:00.440",
    "fix_date": "2024-06-10T12:56:13Z"
  },
  "references": [
    {
      "url": "https://github.com/composer/composer/commit/6bd43dff859c597c09bd03a7e7d6443822d0a396",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/composer/composer/commit/fc57b93603d7d90b71ca8ec77b1c8a9171fdb467",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/composer/composer/security/advisories/GHSA-v9qv-c7wm-wgmf",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PO4MU2BC7VR6LMHEX4X7DKGHVFXZV2MC/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VLPJHM2WWSYU2F6KHW2BYFGYL4IGTKHC/",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/composer/composer/commit/6bd43dff859c597c09bd03a7e7d6443822d0a396",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/composer/composer/commit/fc57b93603d7d90b71ca8ec77b1c8a9171fdb467",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/composer/composer/security/advisories/GHSA-v9qv-c7wm-wgmf",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PO4MU2BC7VR6LMHEX4X7DKGHVFXZV2MC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VLPJHM2WWSYU2F6KHW2BYFGYL4IGTKHC/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.361652",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "composer",
    "owner": "composer",
    "created_at": "2011-06-08T08:53:00Z",
    "updated_at": "2025-01-26T04:44:44Z",
    "pushed_at": "2025-01-22T09:06:06Z",
    "size": 27671,
    "stars": 28774,
    "forks": 4581,
    "open_issues": 116,
    "watchers": 28774,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 4036348
    },
    "commit_activity": {
      "total_commits_last_year": 382,
      "avg_commits_per_week": 7.346153846153846,
      "days_active_last_year": 93
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:52:50.217528"
  }
}