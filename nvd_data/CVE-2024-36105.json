{
  "cve_id": "CVE-2024-36105",
  "github_data": {
    "repository": "dbt-labs/dbt-core",
    "fix_commit": "0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7",
    "related_commits": [
      "0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7",
      "0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7"
    ],
    "patch_url": "https://github.com/dbt-labs/dbt-core/commit/0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7.patch",
    "fix_commit_details": {
      "sha": "0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7",
      "commit_date": "2024-05-22T14:00:54Z",
      "author": {
        "login": "MichelleArk",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "change port bind and add a unittest (#10208)",
        "length": 44,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 31,
        "additions": 30,
        "deletions": 1
      },
      "files": [
        {
          "filename": ".changes/unreleased/Security-20240522-094540.yaml",
          "status": "added",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -0,0 +1,6 @@\n+kind: Security\n+body: Explicitly bind to localhost in docs serve\n+time: 2024-05-22T09:45:40.748185-04:00\n+custom:\n+  Author: ChenyuLInx michelleark\n+  Issue: \"10209\""
        },
        {
          "filename": "core/dbt/task/docs/serve.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -20,7 +20,7 @@ def run(self):\n         if self.args.browser:\n             webbrowser.open_new_tab(f\"http://localhost:{port}\")\n \n-        with socketserver.TCPServer((\"\", port), SimpleHTTPRequestHandler) as httpd:\n+        with socketserver.TCPServer((\"127.0.0.1\", port), SimpleHTTPRequestHandler) as httpd:\n             click.echo(f\"Serving docs at {port}\")\n             click.echo(f\"To access from your browser, navigate to: http://localhost:{port}\")\n             click.echo(\"\\n\\n\")"
        },
        {
          "filename": "tests/unit/task/docs/__init__.py",
          "status": "added",
          "additions": 0,
          "deletions": 0,
          "patch": null
        },
        {
          "filename": "tests/unit/task/docs/test_serve.py",
          "status": "added",
          "additions": 23,
          "deletions": 0,
          "patch": "@@ -0,0 +1,23 @@\n+from http.server import SimpleHTTPRequestHandler\n+from unittest.mock import MagicMock, patch\n+\n+import pytest\n+\n+from dbt.task.docs.serve import ServeTask\n+\n+\n+@pytest.fixture\n+def serve_task():\n+    # Set up\n+    task = ServeTask(config=MagicMock(), args=MagicMock())\n+    task.config.project_target_path = \".\"\n+    task.args.port = 8000\n+    return task\n+\n+\n+def test_serve_bind_to_127(serve_task):\n+    serve_task.args.browser = False\n+    with patch(\"dbt.task.docs.serve.socketserver.TCPServer\") as patched_TCPServer:\n+        patched_TCPServer.return_value = MagicMock()\n+        serve_task.run()\n+        patched_TCPServer.assert_called_once_with((\"127.0.0.1\", 8000), SimpleHTTPRequestHandler)"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 2,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8a8857a85c0cc66c7e3de9eb7e9ca7fd63d553a4",
            "date": "2025-01-10T21:07:15Z",
            "author_login": "aranke"
          },
          {
            "sha": "e4d5a4e777c5b15ec5c3acefc5f575ca1165d52d",
            "date": "2025-01-09T21:03:17Z",
            "author_login": "gshank"
          },
          {
            "sha": "b414ef2cc57fe84371e6831146e2556e02133752",
            "date": "2025-01-09T15:59:49Z",
            "author_login": "internetcoffeephone"
          },
          {
            "sha": "57e279cc1beb95356cfc7c84b86c890fb9e3e7de",
            "date": "2025-01-08T15:17:40Z",
            "author_login": "MichelleArk"
          },
          {
            "sha": "2eb1a5c3eaf85233bdafdb68495a4c520c9332a7",
            "date": "2025-01-08T15:16:30Z",
            "author_login": "QMalcolm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-1327",
    "description": "dbt enables data analysts and engineers to transform their data using the same practices that software engineers use to build applications. Prior to versions 1.6.15, 1.7.15, and 1.8.1, Binding to `INADDR_ANY (0.0.0.0)` or `IN6ADDR_ANY (::)` exposes an application on all network interfaces, increasing the risk of unauthorized access. As stated in the Python docs, a special form for address is accepted instead of a host address: `''` represents `INADDR_ANY`, equivalent to `\"0.0.0.0\"`. On systems with IPv6, '' represents `IN6ADDR_ANY`, which is equivalent to `\"::\"`. A user who serves docs on an unsecured public network, may unknowingly be hosting an unsecured (http) web site for any remote user/system to access on the same network. The issue has has been mitigated in dbt-core v1.6.15, dbt-core v1.7.15, and dbt-core v1.8.1 by binding to localhost explicitly by default in `dbt docs serve`.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-05-27T18:15:10.613",
    "last_modified": "2024-11-21T09:21:37.160",
    "fix_date": "2024-05-22T14:00:54Z"
  },
  "references": [
    {
      "url": "https://cwe.mitre.org/data/definitions/1327.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://docs.python.org/3/library/socket.html#socket-families",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://docs.securesauce.dev/rules/PY030",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/blob/main/core/dbt/task/docs/serve.py#L23C38-L23C39",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/commit/0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/issues/10209",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/pull/10208",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/releases/tag/v1.6.15",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/releases/tag/v1.7.15",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/releases/tag/v1.8.1",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-pmrx-695r-4349",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/1327.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://docs.python.org/3/library/socket.html#socket-families",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://docs.securesauce.dev/rules/PY030",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/blob/main/core/dbt/task/docs/serve.py#L23C38-L23C39",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/commit/0c08d7a19ad1740be3cb0b2e6d9d64f6537176f7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/issues/10209",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/pull/10208",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/releases/tag/v1.6.15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/releases/tag/v1.7.15",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/releases/tag/v1.8.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/dbt-labs/dbt-core/security/advisories/GHSA-pmrx-695r-4349",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:24.295869",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dbt-core",
    "owner": "dbt-labs",
    "created_at": "2016-03-10T02:38:00Z",
    "updated_at": "2025-01-14T14:39:54Z",
    "pushed_at": "2025-01-14T09:09:52Z",
    "size": 48103,
    "stars": 10213,
    "forks": 1657,
    "open_issues": 625,
    "watchers": 10213,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0.11.latest",
      "0.12.latest",
      "0.13.latest",
      "0.14.latest",
      "0.15.latest",
      "0.16.latest",
      "0.17.latest",
      "0.18.latest",
      "0.19.latest",
      "0.20.latest",
      "0.21.latest",
      "1.0.latest",
      "1.1.latest",
      "1.2.latest",
      "1.3.latest",
      "1.4.latest",
      "1.5.latest",
      "1.6.latest",
      "1.7.latest",
      "1.8.latest",
      "1.9.latest"
    ],
    "languages": {
      "Python": 4772809,
      "HTML": 1709115,
      "Rust": 43990,
      "Shell": 6767,
      "Makefile": 5646,
      "Dockerfile": 1398,
      "Batchfile": 804
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:36:49.249369"
  }
}