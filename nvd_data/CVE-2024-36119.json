{
  "cve_id": "CVE-2024-36119",
  "github_data": {
    "repository": "statamic/cms",
    "fix_commit": "0b804306c96c99b81755d5bd02df87ddf392853e",
    "related_commits": [
      "0b804306c96c99b81755d5bd02df87ddf392853e",
      "0b804306c96c99b81755d5bd02df87ddf392853e"
    ],
    "patch_url": "https://github.com/statamic/cms/commit/0b804306c96c99b81755d5bd02df87ddf392853e.patch",
    "fix_commit_details": {
      "sha": "0b804306c96c99b81755d5bd02df87ddf392853e",
      "commit_date": "2024-05-30T14:36:04Z",
      "author": {
        "login": "ryanmitchell",
        "type": "User",
        "stats": {
          "total_commits": 239,
          "average_weekly_commits": 0.6390374331550802,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 92
        }
      },
      "commit_message": {
        "title": "[5.x] Prevent user registration form saving `password_confirmation` (#10228)",
        "length": 135,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 33,
        "additions": 32,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/Http/Requests/UserRegisterRequest.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -52,7 +52,7 @@ public function processedValues()\n     {\n         return $this->blueprintFields->process()->values()\n             ->only(array_keys($this->submittedValues))\n-            ->except(['email', 'groups', 'roles', 'super']);\n+            ->except(['email', 'groups', 'roles', 'super', 'password_confirmation']);\n     }\n \n     public function validator()"
        },
        {
          "filename": "tests/Tags/User/RegisterFormTest.php",
          "status": "modified",
          "additions": 31,
          "deletions": 0,
          "patch": "@@ -4,7 +4,9 @@\n \n use Statamic\\Facades\\Blueprint;\n use Statamic\\Facades\\Parse;\n+use Statamic\\Facades\\Role;\n use Statamic\\Facades\\User;\n+use Statamic\\Facades\\UserGroup;\n use Statamic\\Statamic;\n use Tests\\NormalizesHtml;\n use Tests\\PreventSavingStacheItemsToDisk;\n@@ -339,6 +341,35 @@ public function it_will_use_redirect_query_param_off_url()\n         $this->assertStringContainsString($expectedErrorRedirect, $output);\n     }\n \n+    /** @test */\n+    public function it_ensures_some_fields_arent_saved()\n+    {\n+        UserGroup::make('client')->title('Client')->save();\n+        Role::make('admin')->title('Admin')->save();\n+\n+        $this->assertNull(User::findByEmail('san@holo.com'));\n+        $this->assertFalse(auth()->check());\n+\n+        $this\n+            ->post('/!/auth/register', [\n+                'email' => 'san@holo.com',\n+                'password' => 'chewbacca',\n+                'password_confirmation' => 'chewbacca',\n+                'groups' => ['client'],\n+                'roles' => ['admin'],\n+                'super' => true,\n+            ])\n+            ->assertSessionHasNoErrors()\n+            ->assertLocation('/');\n+\n+        $user = User::findByEmail('san@holo.com');\n+\n+        $this->assertEquals($user->groups()->count(), 0);\n+        $this->assertEquals($user->roles()->count(), 0);\n+        $this->assertNull($user->get('super'));\n+        $this->assertNull($user->get('password_confirmation'));\n+    }\n+\n     private function useCustomBlueprint()\n     {\n         $blueprint = Blueprint::make()->setContents(["
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bcd529b711112f63a32881d3efc05cb3a36a7916",
            "date": "2025-01-08T16:05:07Z",
            "author_login": "edalzell"
          },
          {
            "sha": "8a2ad86a7b7ad8a76c37db3ee3ff71ecbad45627",
            "date": "2025-01-07T20:17:24Z",
            "author_login": "jasonvarga"
          },
          {
            "sha": "f72180818fb199d47794812ac05754ae5cb9ad7c",
            "date": "2025-01-07T20:16:08Z",
            "author_login": "jasonvarga"
          },
          {
            "sha": "b63e958b0fc969608f2762dd4c05a32f9134f5fc",
            "date": "2025-01-07T19:39:50Z",
            "author_login": "edalzell"
          },
          {
            "sha": "c2ed1ceb5e27cb6048a02bc588854d55208e8d5e",
            "date": "2025-01-06T19:23:19Z",
            "author_login": "marcorieser"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 1.8,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-312",
    "description": "Statamic is a, Laravel + Git powered CMS designed for building websites. In affected versions users registering via the `user:register_form` tag will have their password confirmation stored in plain text in their user file. This only affects sites matching **all** of the following conditions: 1. Running Statamic versions between 5.3.0 and 5.6.1. (This version range represents only one calendar week), 2. Using the `user:register_form` tag. 3. Using file-based user accounts. (Does not affect users stored in a database.), 4. Has users that have registered during that time period. (Existing users are not affected.). Additionally passwords are only visible to users that have access to read user yaml files, typically developers of the application itself. This issue has been patched in version 5.6.2, however any users registered during that time period and using the affected version range will still have the the `password_confirmation` value in their yaml files. We recommend that affected users have their password reset. System administrators are advised to upgrade their deployments. There are no known workarounds for this vulnerability. Anyone who commits their files to a public git repo, may consider clearing the sensitive data from the git history as it is likely that passwords were uploaded.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-05-30T21:15:09.460",
    "last_modified": "2024-11-21T09:21:39.660",
    "fix_date": "2024-05-30T14:36:04Z"
  },
  "references": [
    {
      "url": "https://dev.to/balogh08/cleaning-your-git-history-safely-removing-sensitive-data-10i5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/statamic/cms/commit/0b804306c96c99b81755d5bd02df87ddf392853e",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/statamic/cms/security/advisories/GHSA-qvpj-w7xj-r6w9",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://dev.to/balogh08/cleaning-your-git-history-safely-removing-sensitive-data-10i5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/statamic/cms/commit/0b804306c96c99b81755d5bd02df87ddf392853e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/statamic/cms/security/advisories/GHSA-qvpj-w7xj-r6w9",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.329600",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cms",
    "owner": "statamic",
    "created_at": "2017-11-21T14:56:36Z",
    "updated_at": "2025-01-14T12:24:05Z",
    "pushed_at": "2025-01-13T22:40:58Z",
    "size": 57524,
    "stars": 4201,
    "forks": 547,
    "open_issues": 270,
    "watchers": 4201,
    "has_security_policy": false,
    "default_branch": "5.x",
    "protected_branches": [
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "3.4",
      "4.x",
      "5.x",
      "8041-fix-bard-buttons-setting-reorder",
      "add-various-methods-to-base-query-builder",
      "allow-hashes-in-urls",
      "allow-using-variables-in-static-caching-invalidation-rules",
      "ascii-art",
      "bard-allow-source",
      "carbon-3",
      "confirmation-modal-action",
      "customizable-columns-in-asset-browser",
      "deferred-all-augmentation",
      "disable-autocomplete-on-edit-inputs",
      "drop-get-for-field-meta",
      "edalzell-patch-1",
      "ensuring-fields-for-fieldsets",
      "error-indexes",
      "error-solutions-namespace"
    ],
    "languages": {
      "PHP": 11607268,
      "Vue": 1156490,
      "JavaScript": 274768,
      "Blade": 181146,
      "CSS": 142928,
      "Antlers": 43276,
      "HTML": 789,
      "Batchfile": 116
    },
    "commit_activity": {
      "total_commits_last_year": 1452,
      "avg_commits_per_week": 27.923076923076923,
      "days_active_last_year": 225
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:48:38.129222"
  }
}