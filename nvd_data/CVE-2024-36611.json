{
  "cve_id": "CVE-2024-36611",
  "github_data": {
    "repository": "symfony/symfony",
    "fix_commit": "a804ca15fcad279d7727b91d12a667fd5b925995",
    "related_commits": [
      "a804ca15fcad279d7727b91d12a667fd5b925995"
    ],
    "patch_url": "https://github.com/symfony/symfony/commit/a804ca15fcad279d7727b91d12a667fd5b925995.patch",
    "fix_commit_details": {
      "sha": "a804ca15fcad279d7727b91d12a667fd5b925995",
      "commit_date": "2024-02-10T15:22:15Z",
      "author": {
        "login": "llupa",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[Security] Ignore empty username or password login attempts",
        "length": 59,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 33,
        "additions": 33,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/Symfony/Component/Security/Http/Authenticator/FormLoginAuthenticator.php",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -129,12 +129,20 @@ private function getCredentials(Request $request): array\n \n         $credentials['username'] = trim($credentials['username']);\n \n+        if ('' === $credentials['username']) {\n+            throw new BadRequestHttpException(sprintf('The key \"%s\" must be a non-empty string.', $this->options['username_parameter']));\n+        }\n+\n         $request->getSession()->set(SecurityRequestAttributes::LAST_USERNAME, $credentials['username']);\n \n         if (!\\is_string($credentials['password']) && (!\\is_object($credentials['password']) || !method_exists($credentials['password'], '__toString'))) {\n             throw new BadRequestHttpException(sprintf('The key \"%s\" must be a string, \"%s\" given.', $this->options['password_parameter'], \\gettype($credentials['password'])));\n         }\n \n+        if ('' === (string) $credentials['password']) {\n+            throw new BadRequestHttpException(sprintf('The key \"%s\" must be a non-empty string.', $this->options['password_parameter']));\n+        }\n+\n         return $credentials;\n     }\n "
        },
        {
          "filename": "src/Symfony/Component/Security/Http/CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -6,6 +6,7 @@ CHANGELOG\n \n  * Add `#[IsCsrfTokenValid]` attribute\n  * Add CAS 2.0 access token handler\n+ * Make empty username or empty password on form login attempts return Bad Request (400)\n \n 7.0\n ---"
        },
        {
          "filename": "src/Symfony/Component/Security/Http/Tests/Authenticator/FormLoginAuthenticatorTest.php",
          "status": "modified",
          "additions": 24,
          "deletions": 0,
          "patch": "@@ -42,6 +42,30 @@ protected function setUp(): void\n         $this->failureHandler = $this->createMock(AuthenticationFailureHandlerInterface::class);\n     }\n \n+    public function testHandleWhenUsernameEmpty()\n+    {\n+        $this->expectException(BadRequestHttpException::class);\n+        $this->expectExceptionMessage('The key \"_username\" must be a non-empty string.');\n+\n+        $request = Request::create('/login_check', 'POST', ['_username' => '', '_password' => 's$cr$t']);\n+        $request->setSession($this->createSession());\n+\n+        $this->setUpAuthenticator();\n+        $this->authenticator->authenticate($request);\n+    }\n+\n+    public function testHandleWhenPasswordEmpty()\n+    {\n+        $this->expectException(BadRequestHttpException::class);\n+        $this->expectExceptionMessage('The key \"_password\" must be a non-empty string.');\n+\n+        $request = Request::create('/login_check', 'POST', ['_username' => 'foo', '_password' => '']);\n+        $request->setSession($this->createSession());\n+\n+        $this->setUpAuthenticator();\n+        $this->authenticator->authenticate($request);\n+    }\n+\n     /**\n      * @dataProvider provideUsernamesForLength\n      */"
        }
      ],
      "file_patterns": {
        "security_files": 3,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f6312d3f3313afc62c5b1e920b2cbfe62fcf3f8e",
            "date": "2025-01-13T09:20:08Z",
            "author_login": "nicolas-grekas"
          },
          {
            "sha": "7b338721ca42ba1d5544658b39359916715170f4",
            "date": "2025-01-12T22:16:37Z",
            "author_login": "derrabus"
          },
          {
            "sha": "1a76f128845de80fe6644c7de12e0dcdad8197f1",
            "date": "2025-01-12T20:19:12Z",
            "author_login": "derrabus"
          },
          {
            "sha": "0d0758e87be2e990d7744e4e66b59e6609a2b3c9",
            "date": "2025-01-12T17:25:07Z",
            "author_login": "fabpot"
          },
          {
            "sha": "946278f9f8cd1bc40c075d37b1d6c2a289c8eb4c",
            "date": "2025-01-12T12:57:08Z",
            "author_login": "alamirault"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-863",
    "description": "In Symfony v7.07, a security vulnerability was identified in the FormLoginAuthenticator component, where it failed to adequately handle cases where the username or password field of a login request is empty. This flaw could lead to various security risks, including improper authentication logic handling or denial of service. NOTE: the Supplier has concluded that this is a false report.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-29T19:15:06.780",
    "last_modified": "2024-12-03T21:15:06.783",
    "fix_date": "2024-02-10T15:22:15Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/1047524396/3581425e0911b716cf8ce4fa30e41e6c",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/github/advisory-database/pull/5046",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/symfony/symfony/blob/v7.0.7/src/Symfony/Component/Security/Http/Authenticator/FormLoginAuthenticator.php#L132",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/symfony/symfony/commit/a804ca15fcad279d7727b91d12a667fd5b925995",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/symfony/symfony/issues/59077#issuecomment-2513935018",
      "source": "cve@mitre.org",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.316879",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "symfony",
    "owner": "symfony",
    "created_at": "2010-01-04T14:21:21Z",
    "updated_at": "2025-01-14T09:56:31Z",
    "pushed_at": "2025-01-13T13:22:56Z",
    "size": 290479,
    "stars": 29917,
    "forks": 9510,
    "open_issues": 879,
    "watchers": 29917,
    "has_security_policy": false,
    "default_branch": "7.3",
    "protected_branches": [
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "2.4",
      "2.5",
      "2.6",
      "2.7",
      "2.8",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "3.4",
      "4.0",
      "4.1",
      "4.2",
      "4.3",
      "4.4",
      "5.0",
      "5.1",
      "5.2",
      "5.3",
      "5.4",
      "6.0",
      "6.1",
      "6.2",
      "6.3",
      "6.4",
      "7.0"
    ],
    "languages": {
      "PHP": 30007525,
      "Twig": 527335,
      "CSS": 56186,
      "JavaScript": 28225,
      "HTML": 16804,
      "Shell": 9654,
      "Makefile": 1612,
      "Hack": 26
    },
    "commit_activity": {
      "total_commits_last_year": 4163,
      "avg_commits_per_week": 80.0576923076923,
      "days_active_last_year": 343
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:44:47.171985"
  }
}