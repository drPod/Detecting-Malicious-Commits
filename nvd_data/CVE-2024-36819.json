{
  "cve_id": "CVE-2024-36819",
  "github_data": {
    "repository": "RamonSilva20/mapos",
    "fix_commit": "3559bae4782162faab94670f503fd35b0f331929",
    "related_commits": [
      "3559bae4782162faab94670f503fd35b0f331929",
      "3559bae4782162faab94670f503fd35b0f331929"
    ],
    "patch_url": "https://github.com/RamonSilva20/mapos/commit/3559bae4782162faab94670f503fd35b0f331929.patch",
    "fix_commit_details": {
      "sha": "3559bae4782162faab94670f503fd35b0f331929",
      "commit_date": "2024-05-13T00:22:45Z",
      "author": {
        "login": "Pr3d4dor",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: xss",
        "length": 8,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 16,
        "deletions": 0
      },
      "files": [
        {
          "filename": "application/.env.example",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -76,3 +76,5 @@ PAYMENT_GATEWAYS_ASAAS_BOLETO_EXPIRATION=P3D\n API_ENABLED=api_enabled\n API_JWT_KEY=\"enter_jwt_key\"\n API_TOKEN_EXPIRE_TIME=token_expire_time\n+\n+GLOBAL_XSS_FILTERING=true"
        },
        {
          "filename": "application/config/config.php",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -501,3 +501,17 @@\n | Array:\t\tarray('10.0.1.200', '192.168.5.0/24')\n */\n $config['proxy_ips'] = $_ENV['APP_PROXY_IPS'] ?? '';\n+\n+/*\n+|--------------------------------------------------------------------------\n+| Global XSS Filtering\n+|--------------------------------------------------------------------------\n+|\n+| Determines whether the XSS filter is always active when GET, POST or\n+| COOKIE data is encountered\n+|\n+| WARNING: This feature is DEPRECATED and currently available only\n+|          for backwards compatibility purposes!\n+|\n+*/\n+$config['global_xss_filtering'] = $_ENV['GLOBAL_XSS_FILTERING'] ? filter_var($_ENV['GLOBAL_XSS_FILTERING'], FILTER_VALIDATE_BOOLEAN) : true;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e307d58ecbca27825300a7b8c3a70883b8b8771a",
            "date": "2025-01-04T14:16:59Z",
            "author_login": "Pr3d4dor"
          },
          {
            "sha": "14616dc71cb992d3d0bb12e9e0988c11fe090b49",
            "date": "2024-12-12T10:26:41Z",
            "author_login": "willph"
          },
          {
            "sha": "7f713d9020a72984641f281fab0efda37ee1920b",
            "date": "2024-12-12T09:56:23Z",
            "author_login": "cabralwms"
          },
          {
            "sha": "f220c102b007539dec7e3b13ae800fc15bc4d508",
            "date": "2024-12-06T00:00:12Z",
            "author_login": "Pr3d4dor"
          },
          {
            "sha": "66e5686e09d2dd793f866f7ac9955896d325888f",
            "date": "2024-12-05T23:51:32Z",
            "author_login": "cabralwms"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "MAP-OS 4.45.0 and earlier is vulnerable to Cross-Site Scripting (XSS). This vulnerability allows malicious users to insert a malicious payload into the \"Client Name\" input. When a service order from this client is created, the malicious payload is displayed on the administrator and employee dashboards, resulting in unauthorized script execution whenever the dashboard is loaded.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-25T19:15:11.837",
    "last_modified": "2024-11-21T09:22:40.190",
    "fix_date": "2024-05-13T00:22:45Z"
  },
  "references": [
    {
      "url": "https://github.com/RamonSilva20/mapos/commit/3559bae4782162faab94670f503fd35b0f331929",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/RamonSilva20/mapos/tree/master",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/RamonSilva20/mapos/commit/3559bae4782162faab94670f503fd35b0f331929",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/RamonSilva20/mapos/tree/master",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:28.860335",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mapos",
    "owner": "RamonSilva20",
    "created_at": "2016-01-14T23:43:17Z",
    "updated_at": "2025-01-12T11:34:36Z",
    "pushed_at": "2025-01-04T14:17:45Z",
    "size": 69531,
    "stars": 922,
    "forks": 622,
    "open_issues": 16,
    "watchers": 922,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 2035515,
      "JavaScript": 871081,
      "CSS": 234462,
      "HTML": 39633,
      "SCSS": 29641,
      "Batchfile": 15132,
      "Shell": 11422,
      "Hack": 4252,
      "Dockerfile": 2389
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:27:24.846854"
  }
}