{
  "cve_id": "CVE-2024-37301",
  "github_data": {
    "repository": "adfinis/document-merge-service",
    "fix_commit": "a1edd39d33d1bdf75c31ea01c317547be90ca074",
    "related_commits": [
      "a1edd39d33d1bdf75c31ea01c317547be90ca074",
      "a1edd39d33d1bdf75c31ea01c317547be90ca074"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "a1edd39d33d1bdf75c31ea01c317547be90ca074",
      "commit_date": "2024-06-12T06:51:07Z",
      "author": {
        "login": "c0rydoras",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: use a sandboxed environment (#763)",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "document_merge_service/api/jinja.py",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -6,7 +6,8 @@\n from django.utils.translation import to_locale\n from docx.shared import Mm\n from docxtpl import InlineImage, Listing\n-from jinja2 import Environment, pass_context\n+from jinja2 import pass_context\n+from jinja2.sandbox import SandboxedEnvironment\n from rest_framework.exceptions import ValidationError\n \n \n@@ -98,6 +99,6 @@ def get_jinja_filters():\n \n \n def get_jinja_env():\n-    jinja_env = Environment(extensions=settings.DOCXTEMPLATE_JINJA_EXTENSIONS)\n+    jinja_env = SandboxedEnvironment(extensions=settings.DOCXTEMPLATE_JINJA_EXTENSIONS)\n     jinja_env.filters.update(get_jinja_filters())\n     return jinja_env"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e2c68262fd21f4cf2b3135e2b4409ed7e5dadc7e",
            "date": "2025-01-22T09:11:08Z",
            "author_login": "martinwe-adfinis"
          },
          {
            "sha": "aacaf7e51acfcabc80aaddda2935a77426d78bdf",
            "date": "2025-01-13T10:24:32Z",
            "author_login": "anehx"
          },
          {
            "sha": "a35f7e3be8464d98cee9eaf7d3b824893eb37653",
            "date": "2025-01-13T10:18:15Z",
            "author_login": "anehx"
          },
          {
            "sha": "ec8bf9df95bad11408fbdd461d1c1cb94229e20a",
            "date": "2025-01-13T09:40:47Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "a66f47578bdff09d25232bed83383a2c329e9dee",
            "date": "2025-01-10T11:34:52Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-1336",
    "description": "Document Merge Service is a document template merge service providing an API to manage templates and merge them with given data. Versions 6.5.1 and prior are vulnerable to remote code execution via server-side template injection which, when executed as root, can result in full takeover of the affected system. As of time of publication, no patched version exists, nor have any known workarounds been disclosed.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-11T19:16:07.890",
    "last_modified": "2024-11-21T09:23:34.073",
    "fix_date": "2024-06-12T06:51:07Z"
  },
  "references": [
    {
      "url": "https://github.com/adfinis/document-merge-service/commit/a1edd39d33d1bdf75c31ea01c317547be90ca074",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/adfinis/document-merge-service/security/advisories/GHSA-v5gf-r78h-55q6",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/adfinis/document-merge-service/commit/a1edd39d33d1bdf75c31ea01c317547be90ca074",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/adfinis/document-merge-service/security/advisories/GHSA-v5gf-r78h-55q6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.365019",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "document-merge-service",
    "owner": "adfinis",
    "created_at": "2018-12-31T08:05:27Z",
    "updated_at": "2025-01-22T14:56:19Z",
    "pushed_at": "2025-01-24T11:58:06Z",
    "size": 2964,
    "stars": 13,
    "forks": 11,
    "open_issues": 25,
    "watchers": 13,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 118068,
      "Dockerfile": 1520,
      "Makefile": 830
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T08:10:40.692096"
  }
}