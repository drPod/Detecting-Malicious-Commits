{
  "cve_id": "CVE-2024-37304",
  "github_data": {
    "repository": "NuGet/NuGetGallery",
    "fix_commit": "c52b023659f4ad7b626874c1063f2b5e878a4fe0",
    "related_commits": [
      "c52b023659f4ad7b626874c1063f2b5e878a4fe0",
      "c52b023659f4ad7b626874c1063f2b5e878a4fe0"
    ],
    "patch_url": "https://github.com/NuGet/NuGetGallery/commit/c52b023659f4ad7b626874c1063f2b5e878a4fe0.patch",
    "fix_commit_details": {
      "sha": "c52b023659f4ad7b626874c1063f2b5e878a4fe0",
      "commit_date": "2024-02-28T21:03:25Z",
      "author": {
        "login": "lyndaidaii",
        "type": "User",
        "stats": {
          "total_commits": 150,
          "average_weekly_commits": 0.21367521367521367,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 83
        }
      },
      "commit_message": {
        "title": "don't support javascript (#9836)",
        "length": 32,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 2,
        "additions": 2,
        "deletions": 0
      },
      "files": [
        {
          "filename": "src/NuGetGallery/Services/MarkdownService.cs",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -20,6 +20,7 @@ public class MarkdownService : IMarkdownService\n         private static readonly TimeSpan RegexTimeout = TimeSpan.FromMinutes(1);\n         private static readonly Regex EncodedBlockQuotePattern = new Regex(\"^ {0,3}&gt;\", RegexOptions.Multiline, RegexTimeout);\n         private static readonly Regex LinkPattern = new Regex(\"<a href=([\\\"\\']).*?\\\\1\", RegexOptions.None, RegexTimeout);\n+        private static readonly Regex JavaScriptPattern = new Regex(\"<a href=([\\\"\\'])javascript:.*?\\\\1 rel=([\\\"'])noopener noreferrer nofollow\\\\1>\", RegexOptions.None, RegexTimeout);\n         private static readonly Regex HtmlCommentPattern = new Regex(\"<!--.*?-->\", RegexOptions.Singleline, RegexTimeout);\n         private static readonly Regex ImageTextPattern = new Regex(\"!\\\\[\\\\]\\\\(\", RegexOptions.Singleline, RegexTimeout);\n         private static readonly string altTextForImage = \"alternate text is missing from this package README image\";\n@@ -285,6 +286,7 @@ private RenderedMarkdownResult GetHtmlFromMarkdownMarkdig(string markdownString,\n                 renderer.Render(document);\n                 output.Content = htmlWriter.ToString().Trim();\n                 output.IsMarkdigMdSyntaxHighlightEnabled = _features.IsMarkdigMdSyntaxHighlightEnabled();\n+                output.Content = JavaScriptPattern.Replace(htmlWriter.ToString(), \"\").Trim();\n \n                 return output;\n             }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b55d335e4e5782c18bed124d13d128614e77c590",
            "date": "2025-01-09T17:11:31Z",
            "author_login": "mariaghiondea"
          },
          {
            "sha": "941e1eacc715d0d92411254953e3e3cb5809330b",
            "date": "2025-01-08T19:12:29Z",
            "author_login": "mariaghiondea"
          },
          {
            "sha": "8a1bfee1248a2ed569147bf47c99a98fbb299831",
            "date": "2025-01-04T01:08:57Z",
            "author_login": "mariaghiondea"
          },
          {
            "sha": "24387cd640736e471a4436b26239a1b5f6372431",
            "date": "2025-01-04T01:08:53Z",
            "author_login": "mariaghiondea"
          },
          {
            "sha": "ed1d616c74248c03f09529e2e8d8cc975d55807a",
            "date": "2025-01-04T00:18:26Z",
            "author_login": "mariaghiondea"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "NuGet Gallery is a package repository that powers nuget.org. The NuGetGallery has a security vulnerability related to its handling of autolinks in Markdown content. While the platform properly filters out JavaScript from standard links, it does not adequately sanitize autolinks. This oversight allows attackers to exploit autolinks as a vector for Cross-Site Scripting (XSS) attacks. When a user inputs a Markdown autolink such as `<javascript:alert(1)>`, the link is rendered without proper sanitization. This means that the JavaScript code within the autolink can be executed by the browser, leading to an XSS attack. Version 2024.05.28 contains a patch for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-12T15:15:52.910",
    "last_modified": "2024-11-21T09:23:34.190",
    "fix_date": "2024-02-28T21:03:25Z"
  },
  "references": [
    {
      "url": "https://github.com/NuGet/NuGetGallery/commit/c52b023659f4ad7b626874c1063f2b5e878a4fe0",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/NuGet/NuGetGallery/pull/9836",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/NuGet/NuGetGallery/security/advisories/GHSA-gwjh-c548-f787",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/NuGet/NuGetGallery/commit/c52b023659f4ad7b626874c1063f2b5e878a4fe0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/NuGet/NuGetGallery/pull/9836",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/NuGet/NuGetGallery/security/advisories/GHSA-gwjh-c548-f787",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.367191",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "NuGetGallery",
    "owner": "NuGet",
    "created_at": "2011-08-09T17:57:32Z",
    "updated_at": "2025-01-12T23:50:01Z",
    "pushed_at": "2025-01-14T15:39:05Z",
    "size": 104037,
    "stars": 1561,
    "forks": 643,
    "open_issues": 817,
    "watchers": 1561,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C#": 17565470,
      "CSS": 949852,
      "HTML": 750825,
      "JavaScript": 672477,
      "Less": 333099,
      "PowerShell": 130188,
      "TSQL": 84097,
      "ASP.NET": 32837,
      "Python": 32372,
      "XSLT": 13962
    },
    "commit_activity": {
      "total_commits_last_year": 437,
      "avg_commits_per_week": 8.403846153846153,
      "days_active_last_year": 164
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T16:54:39.251879"
  }
}