{
  "cve_id": "CVE-2024-37309",
  "github_data": {
    "repository": "crate/crate",
    "fix_commit": "1dde03bdf031a20886065195527e368e4a3218b3",
    "related_commits": [
      "1dde03bdf031a20886065195527e368e4a3218b3",
      "1dde03bdf031a20886065195527e368e4a3218b3"
    ],
    "patch_url": "https://github.com/crate/crate/commit/1dde03bdf031a20886065195527e368e4a3218b3.patch",
    "fix_commit_details": {
      "sha": "1dde03bdf031a20886065195527e368e4a3218b3",
      "commit_date": "2024-05-23T12:13:39Z",
      "author": {
        "login": "BaurzhanSakhariev",
        "type": "User",
        "stats": {
          "total_commits": 421,
          "average_weekly_commits": 0.6845528455284553,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 144
        }
      },
      "commit_message": {
        "title": "Set JVM variable rejectClientInitiatedRenegotiation to true by default",
        "length": 128,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 10,
        "additions": 8,
        "deletions": 2
      },
      "files": [
        {
          "filename": "app/src/main/dist/bin/crate",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -114,7 +114,7 @@ if [ \"x$CRATE_USE_IPV4\" != \"x\" ]; then\n fi\n \n ## GC configuration\n-JAVA_OPTS=\"$JAVA_OPTS -XX:+UseG1GC -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=30\"\n+JAVA_OPTS=\"$JAVA_OPTS -XX:+UseG1GC -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=30 -Djdk.tls.rejectClientInitiatedRenegotiation=true\"\n \n # GC logging options\n # Set CRATE_DISABLE_GC_LOGGING=1 to disable GC logging"
        },
        {
          "filename": "app/src/main/dist/bin/crate.bat",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -55,7 +55,7 @@ REM Enable aggressive optimizations in the JVM\n REM    - Disabled by default as it might cause the JVM to crash\n REM set JAVA_OPTS=%JAVA_OPTS% -XX:+AggressiveOpts\n \n-set JAVA_OPTS=%JAVA_OPTS% -XX:+UseG1GC -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=30\n+set JAVA_OPTS=%JAVA_OPTS% -XX:+UseG1GC -XX:G1ReservePercent=25 -XX:InitiatingHeapOccupancyPercent=30 -Djdk.tls.rejectClientInitiatedRenegotiation=true\n \n REM GC logging default values\n SET GC_LOG_DIR=%CRATE_HOME%\\logs"
        },
        {
          "filename": "docs/appendices/release-notes/5.7.2.rst",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -43,6 +43,12 @@ Version 5.7.2 - Unreleased\n See the :ref:`version_5.7.0` release notes for a full list of changes in the\n 5.7 series.\n \n+Security Fixes\n+==============\n+\n+- Fixed a security issue allowing clients using TLS v1.2 to do client-initiated\n+  renegotiation which can lead to DoS.\n+\n Fixes\n =====\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "8dffdb4e8ee1c342a1fc8df8bb52df0a716b4f36",
            "date": "2025-01-10T20:22:15Z",
            "author_login": "jeeminso"
          },
          {
            "sha": "c1b7b3968d041287760e2eb111778ce84a527834",
            "date": "2025-01-14T14:36:21Z",
            "author_login": "mfussenegger"
          },
          {
            "sha": "9a51ed24d95961afdf8e6dee53cf7fc9bdceb283",
            "date": "2025-01-14T11:25:08Z",
            "author_login": "mfussenegger"
          },
          {
            "sha": "86114f2ec05fea5c5ab56a9cfbe07c6cab131fb4",
            "date": "2025-01-13T11:28:09Z",
            "author_login": "mfussenegger"
          },
          {
            "sha": "748517809c740ac991bfa45a266511e9438739e8",
            "date": "2025-01-13T11:05:13Z",
            "author_login": "mfussenegger"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
    "cwe_id": "CWE-770",
    "description": "CrateDB is a distributed SQL database. A high-risk vulnerability has been identified in versions prior to 5.7.2 where the TLS endpoint (port 4200) permits client-initiated renegotiation. In this scenario, an attacker can exploit this feature to repeatedly request renegotiation of security parameters during an ongoing TLS session. This flaw could lead to excessive consumption of CPU resources, resulting in potential server overload and service disruption. The vulnerability was confirmed using an openssl client where the command `R` initiates renegotiation, followed by the server confirming with `RENEGOTIATING`. This vulnerability allows an attacker to perform a denial of service attack by exhausting server CPU resources through repeated TLS renegotiations. This impacts the availability of services running on the affected server, posing a significant risk to operational stability and security. TLS 1.3 explicitly forbids renegotiation, since it closes a window of opportunity for an attack. Version 5.7.2 of CrateDB contains the fix for the issue.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-13T14:15:13.060",
    "last_modified": "2024-11-21T09:23:34.867",
    "fix_date": "2024-05-23T12:13:39Z"
  },
  "references": [
    {
      "url": "https://cratedb.com/docs/crate/reference/en/latest/appendices/release-notes/5.7.2.html",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/crate/crate/commit/1dde03bdf031a20886065195527e368e4a3218b3",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/crate/crate/security/advisories/GHSA-x268-qpg6-w9g2",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://cratedb.com/docs/crate/reference/en/latest/appendices/release-notes/5.7.2.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/crate/crate/commit/1dde03bdf031a20886065195527e368e4a3218b3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/crate/crate/security/advisories/GHSA-x268-qpg6-w9g2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.370440",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "crate",
    "owner": "crate",
    "created_at": "2013-04-10T09:17:16Z",
    "updated_at": "2025-01-14T17:22:55Z",
    "pushed_at": "2025-01-14T17:24:29Z",
    "size": 158467,
    "stars": 4158,
    "forks": 569,
    "open_issues": 302,
    "watchers": 4158,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "0.36",
      "0.45",
      "0.46",
      "0.49",
      "0.50",
      "0.51",
      "0.52",
      "0.53",
      "0.54",
      "0.55",
      "0.56",
      "0.57",
      "1.0",
      "1.1",
      "1.2",
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "3.0",
      "3.1",
      "3.2",
      "3.3",
      "4.0",
      "4.1",
      "4.2",
      "4.3",
      "4.4"
    ],
    "languages": {
      "Java": 33240159,
      "Python": 72902,
      "ANTLR": 50436,
      "Shell": 8641
    },
    "commit_activity": {
      "total_commits_last_year": 1175,
      "avg_commits_per_week": 22.596153846153847,
      "days_active_last_year": 251
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T21:34:13.891005"
  }
}