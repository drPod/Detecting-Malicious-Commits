{
  "cve_id": "CVE-2024-37310",
  "github_data": {
    "repository": "EVerest/everest-core",
    "fix_commit": "f73620c4c0f626e1097068a47e10cc27b369ad8e",
    "related_commits": [
      "f73620c4c0f626e1097068a47e10cc27b369ad8e",
      "f73620c4c0f626e1097068a47e10cc27b369ad8e"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f73620c4c0f626e1097068a47e10cc27b369ad8e",
      "commit_date": "2024-06-05T11:01:31Z",
      "author": {
        "login": "SebaLukas",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix EvseV2G: Prevent interger overflow after reading v2gtp message length (#706)",
        "length": 140,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "modules/EvseV2G/v2g_server.cpp",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -25,6 +25,7 @@\n #include \"v2g_server.hpp\"\n \n #define MAX_RES_TIME 98\n+#define UINT32_MAX   0xFFFFFFFF\n \n static types::iso15118_charger::V2G_Message_ID get_V2G_Message_ID(enum V2gMsgTypeId v2g_msg,\n                                                                   enum v2g_protocol selected_protocol, bool is_req) {\n@@ -162,8 +163,14 @@ static int v2g_incoming_v2gtp(struct v2g_connection* conn) {\n         return -1;\n     }\n \n+    if (conn->payload_len >= UINT32_MAX - V2GTP_HEADER_LENGTH) {\n+        dlog(DLOG_LEVEL_ERROR, \"Prevent integer overflow - payload too long: have %d, would need %u\",\n+             DEFAULT_BUFFER_SIZE, conn->payload_len);\n+        return -1;\n+    }\n+\n     if (conn->payload_len + V2GTP_HEADER_LENGTH > DEFAULT_BUFFER_SIZE) {\n-        dlog(DLOG_LEVEL_ERROR, \"payload too long: have %d, would need %d\", DEFAULT_BUFFER_SIZE,\n+        dlog(DLOG_LEVEL_ERROR, \"payload too long: have %d, would need %u\", DEFAULT_BUFFER_SIZE,\n              conn->payload_len + V2GTP_HEADER_LENGTH);\n \n         /* we have no way to flush/discard remaining unread data from the socket without reading it in chunks,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "170e06375eab241e5fe744d6305428cf90b4a5e8",
            "date": "2025-01-23T15:10:06Z",
            "author_login": "krealyt"
          },
          {
            "sha": "fbbfd8639f9e706e6912fdc49b8a783b49538972",
            "date": "2025-01-22T16:02:55Z",
            "author_login": "Pietfried"
          },
          {
            "sha": "356a4cd0cbf9596682b28c9575cc98bca8b2e7b2",
            "date": "2025-01-22T09:21:37Z",
            "author_login": "SebaLukas"
          },
          {
            "sha": "06cf9836061ced0d8fa0b4b61061b3438a3ca364",
            "date": "2025-01-20T16:57:50Z",
            "author_login": "florinmihut"
          },
          {
            "sha": "cc46e47fa8d0e186904654865d86e565a22f718f",
            "date": "2025-01-17T08:29:26Z",
            "author_login": "a-w50"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-122",
    "description": "EVerest is an EV charging software stack. An integer overflow in the \"v2g_incoming_v2gtp\" function in the v2g_server.cpp implementation can allow a remote attacker to overflow the process' heap. This vulnerability is fixed in 2024.3.1 and 2024.6.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-07-10T20:15:03.790",
    "last_modified": "2024-12-16T01:15:05.320",
    "fix_date": "2024-06-05T11:01:31Z"
  },
  "references": [
    {
      "url": "https://github.com/EVerest/everest-core/commit/f73620c4c0f626e1097068a47e10cc27b369ad8e",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/releases/tag/2024.3.1",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/releases/tag/2024.6.0",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/security/advisories/GHSA-8g9q-7qr9-vc96",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/commit/f73620c4c0f626e1097068a47e10cc27b369ad8e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/releases/tag/2024.3.1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/releases/tag/2024.6.0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/EVerest/everest-core/security/advisories/GHSA-8g9q-7qr9-vc96",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://plaxidityx.com/blog/automotive-cyber-security/ev-cyber-security-plaxidityx-discovers-critical-vulnerability-in-everest-open-source-ev-charging-firmware-stack-cve-2024-37310/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.476812",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "everest-core",
    "owner": "EVerest",
    "created_at": "2021-12-20T11:33:29Z",
    "updated_at": "2025-01-23T15:10:11Z",
    "pushed_at": "2025-01-25T07:16:20Z",
    "size": 6116,
    "stars": 111,
    "forks": 83,
    "open_issues": 63,
    "watchers": 111,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "C++": 3153501,
      "Python": 981903,
      "CMake": 131133,
      "Rust": 85966,
      "JavaScript": 76394,
      "C": 64822,
      "Starlark": 18510,
      "Shell": 13887,
      "Dockerfile": 511
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:20:46.193401"
  }
}