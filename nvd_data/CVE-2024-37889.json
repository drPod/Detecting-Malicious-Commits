{
  "cve_id": "CVE-2024-37889",
  "github_data": {
    "repository": "TreyWW/MyFinances",
    "fix_commit": "2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f",
    "related_commits": [
      "2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f",
      "2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f"
    ],
    "patch_url": "https://github.com/TreyWW/MyFinances/commit/2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f.patch",
    "fix_commit_details": {
      "sha": "2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f",
      "commit_date": "2024-06-14T16:59:57Z",
      "author": {
        "login": "TreyWW",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-4884-3gvp-3wj2",
        "length": 301,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 12,
        "deletions": 11
      },
      "files": [
        {
          "filename": "backend/__init__.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-__version__ = \"0.4.5\"\n+__version__ = \"0.4.6\""
        },
        {
          "filename": "backend/views/core/invoices/edit.py",
          "status": "modified",
          "additions": 9,
          "deletions": 8,
          "patch": "@@ -2,7 +2,8 @@\n \n from django.contrib import messages\n from django.http import JsonResponse\n-from django.shortcuts import render\n+from django.http.response import HttpResponse\n+from django.shortcuts import render, redirect\n from django.views.decorators.http import require_http_methods\n \n from backend.models import Invoice, Client, InvoiceItem\n@@ -56,8 +57,13 @@ def invoice_get_existing_data(invoice_obj):\n def invoice_edit_page_get(request, invoice_id):\n     try:\n         invoice = Invoice.objects.get(id=invoice_id)\n+\n+        if not invoice.has_access(request.user):\n+            messages.error(request, \"You are not permitted to edit this invoice\")\n+            return redirect(\"invoices:dashboard\")\n     except Invoice.DoesNotExist:\n-        return JsonResponse({\"message\": \"Invoice not found\"}, status=404)\n+        messages.error(request, \"Invoice not found\")\n+        return redirect(\"invoices:dashboard\")\n \n     # use to populate fields with existing data in edit_from_destination.html AND edit_to_destination.html\n     data_to_populate = invoice_get_existing_data(invoice)\n@@ -72,12 +78,7 @@ def edit_invoice(request: HtmxHttpRequest, invoice_id):\n     except Invoice.DoesNotExist:\n         return JsonResponse({\"message\": \"Invoice not found\"}, status=404)\n \n-    if request.user.logged_in_as_team and request.user.logged_in_as_team != invoice.organization:\n-        return JsonResponse(\n-            {\"message\": \"You do not have permission to edit this invoice\"},\n-            status=403,\n-        )\n-    elif request.user != invoice.user:\n+    if not invoice.has_access(request.user):\n         return JsonResponse(\n             {\"message\": \"You do not have permission to edit this invoice\"},\n             status=403,"
        },
        {
          "filename": "pyproject.toml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,6 +1,6 @@\n [tool.poetry]\n name = \"MyFinances\"\n-version = \"0.4.5\"\n+version = \"0.4.6\"\n description = \"github.com/TreyWW/MyFinances\"\n authors = [\"TreyWW\"]\n readme = \"README.md\"\n@@ -94,7 +94,7 @@ requires = [\"poetry-core\"]\n build-backend = \"poetry.core.masonry.api\"\n \n [tool.bumpversion]\n-current_version = \"0.4.5\"\n+current_version = \"0.4.6\"\n commit = true\n commit_args = \"-s\"\n tag = true"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "650f01915997741971f18d7561b928a0e01336f0",
            "date": "2024-12-14T15:52:58Z",
            "author_login": "TreyWW"
          },
          {
            "sha": "23a6b2887ead1ca26bc913642d584a99e84667e3",
            "date": "2024-12-13T20:20:36Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "88f13a93373774647cf8f062960cae4c8b8627f8",
            "date": "2024-12-13T20:19:40Z",
            "author_login": "TreyWW"
          },
          {
            "sha": "6b38320366a4e947daf9d0b0c4ee9c080c63e30b",
            "date": "2024-12-06T18:33:11Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "f3e487015f1954453c9ab3c47a92b65e0b9193b5",
            "date": "2024-11-27T16:23:58Z",
            "author_login": "TreyWW"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-639",
    "description": "MyFinances is a web application for managing finances. MyFinances has a way to access other customer invoices while signed in as a user. This method allows an actor to access PII and financial information from another account. The vulnerability is fixed in 0.4.6.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-14T20:15:11.873",
    "last_modified": "2024-11-21T09:24:28.663",
    "fix_date": "2024-06-14T16:59:57Z"
  },
  "references": [
    {
      "url": "https://github.com/TreyWW/MyFinances/commit/2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/TreyWW/MyFinances/security/advisories/GHSA-4884-3gvp-3wj2",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TreyWW/MyFinances/commit/2c1e6d5b7ec8b2d6f660b260e3c5f4d3eaaa613f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/TreyWW/MyFinances/security/advisories/GHSA-4884-3gvp-3wj2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:28.827908",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "MyFinances",
    "owner": "TreyWW",
    "created_at": "2023-08-08T15:59:18Z",
    "updated_at": "2025-01-09T20:00:15Z",
    "pushed_at": "2025-01-01T17:57:57Z",
    "size": 11651,
    "stars": 111,
    "forks": 165,
    "open_issues": 37,
    "watchers": 111,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "feature/409-public-api"
    ],
    "languages": {
      "Python": 794628,
      "HTML": 439088,
      "JavaScript": 24352,
      "CSS": 7413,
      "Dockerfile": 1011,
      "Shell": 628
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T15:28:23.646190"
  }
}