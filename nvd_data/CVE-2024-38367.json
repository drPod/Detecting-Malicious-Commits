{
  "cve_id": "CVE-2024-38367",
  "github_data": {
    "repository": "CocoaPods/trunk.cocoapods.org",
    "fix_commit": "d4fa66f49cedab449af9a56a21ab40697b9f7b97",
    "related_commits": [
      "d4fa66f49cedab449af9a56a21ab40697b9f7b97",
      "d4fa66f49cedab449af9a56a21ab40697b9f7b97"
    ],
    "patch_url": "https://github.com/CocoaPods/trunk.cocoapods.org/commit/d4fa66f49cedab449af9a56a21ab40697b9f7b97.patch",
    "fix_commit_details": {
      "sha": "d4fa66f49cedab449af9a56a21ab40697b9f7b97",
      "commit_date": "2023-10-27T08:18:49Z",
      "author": {
        "login": "orta",
        "type": "User",
        "stats": {
          "total_commits": 113,
          "average_weekly_commits": 0.18344155844155843,
          "total_additions": 1643,
          "total_deletions": 963,
          "weeks_active": 43
        }
      },
      "commit_message": {
        "title": "Hardcode the trunk URL for prod sessions",
        "length": 40,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "app/controllers/api/sessions_controller.rb",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@ class SessionsController < APIController\n             o.save\n           end\n \n-          url_template = \"#{request.scheme}://#{request.host_with_port}/sessions/verify/%s\"\n+          url_template = ENV['RACK_ENV'] == 'test' ? \"#{request.scheme}://#{request.host_with_port}/sessions/verify/%s\" : 'https://trunk.cocoapods.org/sessions/verify/%s'\n           session = owner.create_session!(request.ip, url_template, session_description)\n           session_attributes = session.public_attributes\n           session_attributes['token'] = session.token"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4a7d62682b8d52577158915ea2eb6c46483791fa",
            "date": "2024-11-18T21:05:18Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "cf8f26c9bd7e4bca7d305a55b6fcd4596d47c472",
            "date": "2024-11-06T03:29:49Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "4f7fed5fee67a312373d05633e5033079d86247b",
            "date": "2024-11-05T03:07:01Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "431513b8c0f8f7e8e3c0b91eff7abf6e7cfd6ddc",
            "date": "2024-11-04T03:24:36Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "e90d65c3f0b48367bddb0f27cca6ca38871b6ea7",
            "date": "2024-11-01T03:15:25Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:H",
    "cwe_id": "CWE-488",
    "description": "trunk.cocoapods.org is the authentication server for the CoacoaPods dependency manager. Prior to commit d4fa66f49cedab449af9a56a21ab40697b9f7b97, the trunk sessions verification step could be manipulated for owner session hijacking Compromising a victim\u2019s session will result in a full takeover of the CocoaPods trunk account. The threat actor could manipulate their pod specifications, disrupt the distribution of legitimate libraries, or cause widespread disruption within the CocoaPods ecosystem. This was patched server-side with commit d4fa66f49cedab449af9a56a21ab40697b9f7b97 in October 2023.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-07-01T21:15:04.020",
    "last_modified": "2024-11-21T09:25:28.503",
    "fix_date": "2023-10-27T08:18:49Z"
  },
  "references": [
    {
      "url": "https://blog.cocoapods.org/CocoaPods-Trunk-RCEs-2023",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://evasec.io/blog/eva-discovered-supply-chain-vulnerabities-in-cocoapods#vulnerability-3-achieving-zero-click-account-takeover-by-defeating-email-security-boundaries",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/CocoaPods/CocoaPods/security/advisories/GHSA-52gf-m7v9-m333",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/CocoaPods/trunk.cocoapods.org/commit/d4fa66f49cedab449af9a56a21ab40697b9f7b97",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://blog.cocoapods.org/CocoaPods-Trunk-RCEs-2023",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://evasec.io/blog/eva-discovered-supply-chain-vulnerabities-in-cocoapods#vulnerability-3-achieving-zero-click-account-takeover-by-defeating-email-security-boundaries",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/CocoaPods/CocoaPods/security/advisories/GHSA-52gf-m7v9-m333",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/CocoaPods/trunk.cocoapods.org/commit/d4fa66f49cedab449af9a56a21ab40697b9f7b97",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:28.881312",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "trunk.cocoapods.org",
    "owner": "CocoaPods",
    "created_at": "2013-04-06T13:33:05Z",
    "updated_at": "2024-11-18T21:05:22Z",
    "pushed_at": "2025-01-13T03:35:27Z",
    "size": 1674,
    "stars": 40,
    "forks": 16,
    "open_issues": 81,
    "watchers": 40,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Ruby": 235112,
      "HTML": 20879,
      "Slim": 9275,
      "CSS": 4050,
      "Procfile": 42
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:38:10.294026"
  }
}