{
  "cve_id": "CVE-2024-38522",
  "github_data": {
    "repository": "scidsg/hushline",
    "fix_commit": "2bbeae78a24ca2cd893f32a1812f5f6634cb21b6",
    "related_commits": [
      "2bbeae78a24ca2cd893f32a1812f5f6634cb21b6",
      "2bbeae78a24ca2cd893f32a1812f5f6634cb21b6"
    ],
    "patch_url": "https://github.com/scidsg/hushline/commit/2bbeae78a24ca2cd893f32a1812f5f6634cb21b6.patch",
    "fix_commit_details": {
      "sha": "2bbeae78a24ca2cd893f32a1812f5f6634cb21b6",
      "commit_date": "2024-06-20T18:17:20Z",
      "author": {
        "login": "micahflee",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Remove unpkg.com from the CSP header",
        "length": 36,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "SECURITY.md",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -46,7 +46,7 @@ Hush Line implements a series of HTTP security headers to protect our users and\n The Content-Security-Policy (CSP) header is a powerful tool used by web applications to mitigate the risk of Cross-Site Scripting (XSS) attacks and other types of code injection attacks. By specifying which content sources are trustworthy, CSP prevents the browser from loading malicious assets. Here's a breakdown of the CSP directive used:\n \n - `default-src 'self';` Only allow content from the site's own origin. This is the default policy for loading resources such as JavaScript, images, CSS, fonts, AJAX requests, frames, HTML5 media, and other data.\n-- `script-src 'self' https://js.stripe.com https://unpkg.com;` Allow scripts to be loaded from the site's own origin, Stripe (for payment processing), and unpkg (a content delivery network for npm packages).\n+- `script-src 'self' https://js.stripe.com;` Allow scripts to be loaded from the site's own origin and Stripe (for payment processing).\n - `img-src 'self' data: https:;` Allow images from the site's origin, inline images using data URIs, and images loaded over HTTPS from any origin.\n - `style-src 'self';` Only allow stylesheets from the site's own origin.\n - `frame-ancestors 'none';` Prevent the site from being framed (embedded within an <iframe>) by other sites, mitigating Clickjacking attacks."
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b4c9a44cc5d4680cfa63679303bd1622c49a43ae",
            "date": "2025-01-14T02:34:12Z",
            "author_login": "micahflee"
          },
          {
            "sha": "fbb7ee66b195295b57b84eccb35885761423f161",
            "date": "2025-01-14T01:43:44Z",
            "author_login": "micahflee"
          },
          {
            "sha": "46a76d3b396c689bff9e31e03850c5772de3571f",
            "date": "2025-01-14T01:38:47Z",
            "author_login": "micahflee"
          },
          {
            "sha": "2f995381519cf1313826de4ed7a618de7769433e",
            "date": "2025-01-14T01:08:22Z",
            "author_login": "micahflee"
          },
          {
            "sha": "97e99b774f8bf6e8d462260b3867038bb1b6c412",
            "date": "2025-01-14T00:16:48Z",
            "author_login": "micahflee"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-183",
    "description": "Hush Line is a free and open-source, anonymous-tip-line-as-a-service for organizations or individuals. The CSP policy applied on the `tips.hushline.app` website and bundled by default in this repository is trivial to bypass. This vulnerability has been patched in version 0.1.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-28T17:15:03.527",
    "last_modified": "2024-11-21T09:26:10.720",
    "fix_date": "2024-06-20T18:17:20Z"
  },
  "references": [
    {
      "url": "https://github.com/scidsg/hushline/commit/2bbeae78a24ca2cd893f32a1812f5f6634cb21b6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/scidsg/hushline/security/advisories/GHSA-r85c-95x7-4h7q",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/scidsg/hushline/commit/2bbeae78a24ca2cd893f32a1812f5f6634cb21b6",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/scidsg/hushline/security/advisories/GHSA-r85c-95x7-4h7q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:28.871181",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "hushline",
    "owner": "scidsg",
    "created_at": "2023-03-28T01:06:05Z",
    "updated_at": "2025-01-14T02:34:17Z",
    "pushed_at": "2025-01-14T15:21:08Z",
    "size": 88544,
    "stars": 83,
    "forks": 21,
    "open_issues": 83,
    "watchers": 83,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 370150,
      "HTML": 70311,
      "CSS": 49813,
      "JavaScript": 37190,
      "Makefile": 1680,
      "Dockerfile": 1583,
      "Shell": 1387,
      "Mako": 510
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T16:46:56.048637"
  }
}