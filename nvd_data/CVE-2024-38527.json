{
  "cve_id": "CVE-2024-38527",
  "github_data": {
    "repository": "mermaid-js/zenuml-core",
    "fix_commit": "ad7545b33f5f27466cbf357beb65969ca1953e3c",
    "related_commits": [
      "ad7545b33f5f27466cbf357beb65969ca1953e3c",
      "ad7545b33f5f27466cbf357beb65969ca1953e3c"
    ],
    "patch_url": "https://github.com/mermaid-js/zenuml-core/commit/ad7545b33f5f27466cbf357beb65969ca1953e3c.patch",
    "fix_commit_details": {
      "sha": "ad7545b33f5f27466cbf357beb65969ca1953e3c",
      "commit_date": "2024-06-26T04:46:28Z",
      "author": {
        "login": "MrCoder",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixed an XSS vulnerability.",
        "length": 27,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 59,
        "additions": 36,
        "deletions": 23
      },
      "files": [
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -49,6 +49,7 @@\n     \"antlr4\": \"~4.11.0\",\n     \"color-string\": \"^1.5.5\",\n     \"dom-to-image-more\": \"^2.13.0\",\n+    \"dompurify\": \"^3.1.5\",\n     \"file-saver\": \"^2.0.5\",\n     \"highlight.js\": \"^10.7.3\",\n     \"html-to-image\": \"^1.11.3\","
        },
        {
          "filename": "pnpm-lock.yaml",
          "status": "modified",
          "additions": 30,
          "deletions": 20,
          "patch": "@@ -28,6 +28,9 @@ dependencies:\n   dom-to-image-more:\n     specifier: ^2.13.0\n     version: 2.13.0\n+  dompurify:\n+    specifier: ^3.1.5\n+    version: 3.1.5\n   file-saver:\n     specifier: ^2.0.5\n     version: 2.0.5\n@@ -80,7 +83,7 @@ devDependencies:\n     version: 4.14.191\n   \"@types/node\":\n     specifier: latest\n-    version: 20.13.0\n+    version: 20.14.9\n   \"@typescript-eslint/eslint-plugin\":\n     specifier: ^6.7.4\n     version: 6.7.4(@typescript-eslint/parser@6.7.4)(eslint@8.30.0)(typescript@4.9.4)\n@@ -161,13 +164,13 @@ devDependencies:\n     version: 3.1.0(webpack@5.91.0)\n   ts-node:\n     specifier: ^10.9.1\n-    version: 10.9.1(@types/node@20.13.0)(typescript@4.9.4)\n+    version: 10.9.1(@types/node@20.14.9)(typescript@4.9.4)\n   typescript:\n     specifier: ^4.9.4\n     version: 4.9.4\n   vite:\n     specifier: ^3.2.10\n-    version: 3.2.10(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0)\n+    version: 3.2.10(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0)\n   vite-plugin-css-injected-by-js:\n     specifier: ^2.2.0\n     version: 2.2.0(vite@3.2.10)\n@@ -2962,10 +2965,10 @@ packages:\n       }\n     dev: true\n \n-  /@types/node@20.13.0:\n+  /@types/node@20.14.9:\n     resolution:\n       {\n-        integrity: sha512-FM6AOb3khNkNIXPnHFDYaHerSv8uN22C91z098AnGccVu+Pcdhi+pNUFDi0iLmPIsVE0JBD0KVS7mzUYt4nRzQ==,\n+        integrity: sha512-06OCtnTXtWOZBJlRApleWndH4JsRVs1pDCc8dLSQp+7PpUpX3ePdHyeNSFTeSe7FtKyQkrlPvHwJOW3SLd8Oyg==,\n       }\n     dependencies:\n       undici-types: 5.26.5\n@@ -3007,7 +3010,7 @@ packages:\n       }\n     requiresBuild: true\n     dependencies:\n-      \"@types/node\": 20.13.0\n+      \"@types/node\": 20.14.9\n     dev: true\n     optional: true\n \n@@ -3176,7 +3179,7 @@ packages:\n       vite: ^4.0.0\n       vue: ^3.2.25\n     dependencies:\n-      vite: 3.2.10(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0)\n+      vite: 3.2.10(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0)\n       vue: 3.4.27(typescript@4.9.4)\n     dev: true\n \n@@ -5085,6 +5088,13 @@ packages:\n       domelementtype: 2.3.0\n     dev: true\n \n+  /dompurify@3.1.5:\n+    resolution:\n+      {\n+        integrity: sha512-lwG+n5h8QNpxtyrJW/gJWckL+1/DQiYMX8f7t8Z2AZTPw1esVrqjI63i7Zc2Gz0aKzLVMYC1V1PL/ky+aY/NgA==,\n+      }\n+    dev: false\n+\n   /domutils@3.1.0:\n     resolution:\n       {\n@@ -6933,7 +6943,7 @@ packages:\n       }\n     engines: { node: \">= 10.13.0\" }\n     dependencies:\n-      \"@types/node\": 20.13.0\n+      \"@types/node\": 20.14.9\n       merge-stream: 2.0.0\n       supports-color: 7.2.0\n     dev: true\n@@ -6945,7 +6955,7 @@ packages:\n       }\n     engines: { node: \">= 10.13.0\" }\n     dependencies:\n-      \"@types/node\": 20.13.0\n+      \"@types/node\": 20.14.9\n       merge-stream: 2.0.0\n       supports-color: 8.1.1\n     dev: true\n@@ -8365,7 +8375,7 @@ packages:\n     dependencies:\n       lilconfig: 2.0.6\n       postcss: 8.4.31\n-      ts-node: 10.9.1(@types/node@20.13.0)(typescript@4.9.4)\n+      ts-node: 10.9.1(@types/node@20.14.9)(typescript@4.9.4)\n       yaml: 1.10.2\n     dev: false\n \n@@ -9731,7 +9741,7 @@ packages:\n       typescript: 4.9.4\n     dev: true\n \n-  /ts-node@10.9.1(@types/node@20.13.0)(typescript@4.9.4):\n+  /ts-node@10.9.1(@types/node@20.14.9)(typescript@4.9.4):\n     resolution:\n       {\n         integrity: sha512-NtVysVPkxxrwFGUUxGYhfux8k78pQB3JqYBXlLRZgdGUqTO5wU/UyHop5p70iEbGhB7q5KmiZiU0Y3KlJrScEw==,\n@@ -9753,7 +9763,7 @@ packages:\n       \"@tsconfig/node12\": 1.0.11\n       \"@tsconfig/node14\": 1.0.3\n       \"@tsconfig/node16\": 1.0.3\n-      \"@types/node\": 20.13.0\n+      \"@types/node\": 20.14.9\n       acorn: 8.8.1\n       acorn-walk: 8.2.0\n       arg: 4.1.3\n@@ -10063,7 +10073,7 @@ packages:\n       extsprintf: 1.3.0\n     dev: true\n \n-  /vite-node@0.26.1(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0):\n+  /vite-node@0.26.1(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0):\n     resolution:\n       {\n         integrity: sha512-5FJSKZZJz48zFRKHE55WyevZe61hLMQEsqGn+ungfd60kxEztFybZ3yG9ToGFtOWNCCy7Vn5EVuXD8bdeHOSdw==,\n@@ -10076,7 +10086,7 @@ packages:\n       pathe: 0.2.0\n       source-map: 0.6.1\n       source-map-support: 0.5.21\n-      vite: 3.2.10(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0)\n+      vite: 3.2.10(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0)\n     transitivePeerDependencies:\n       - \"@types/node\"\n       - less\n@@ -10095,7 +10105,7 @@ packages:\n     peerDependencies:\n       vite: \">2.0.0-0\"\n     dependencies:\n-      vite: 3.2.10(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0)\n+      vite: 3.2.10(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0)\n     dev: true\n \n   /vite-svg-loader@4.0.0:\n@@ -10108,7 +10118,7 @@ packages:\n       svgo: 3.0.2\n     dev: true\n \n-  /vite@3.2.10(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0):\n+  /vite@3.2.10(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0):\n     resolution:\n       {\n         integrity: sha512-Dx3olBo/ODNiMVk/cA5Yft9Ws+snLOXrhLtrI3F4XLt4syz2Yg8fayZMWScPKoz12v5BUv7VEmQHnsfpY80fYw==,\n@@ -10136,7 +10146,7 @@ packages:\n       terser:\n         optional: true\n     dependencies:\n-      \"@types/node\": 20.13.0\n+      \"@types/node\": 20.14.9\n       esbuild: 0.15.18\n       less: 4.1.3\n       postcss: 8.4.31\n@@ -10174,7 +10184,7 @@ packages:\n     dependencies:\n       \"@types/chai\": 4.3.4\n       \"@types/chai-subset\": 1.3.3\n-      \"@types/node\": 20.13.0\n+      \"@types/node\": 20.14.9\n       acorn: 8.8.1\n       acorn-walk: 8.2.0\n       chai: 4.3.7\n@@ -10186,8 +10196,8 @@ packages:\n       tinybench: 2.3.1\n       tinypool: 0.3.0\n       tinyspy: 1.0.2\n-      vite: 3.2.10(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0)\n-      vite-node: 0.26.1(@types/node@20.13.0)(less@4.1.3)(sass@1.57.0)\n+      vite: 3.2.10(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0)\n+      vite-node: 0.26.1(@types/node@20.14.9)(less@4.1.3)(sass@1.57.0)\n     transitivePeerDependencies:\n       - less\n       - sass"
        },
        {
          "filename": "src/components/DiagramFrame/SeqDiagram/MessageLayer/Block/Statement/Comment/Comment.vue",
          "status": "modified",
          "additions": 5,
          "deletions": 3,
          "patch": "@@ -8,6 +8,8 @@\n \n <script type=\"text/babel\">\n import { marked } from \"marked\";\n+import DOMPurify from \"dompurify\";\n+\n import highlightjs from \"highlight.js/lib/core\";\n \n // Languages import\n@@ -61,10 +63,10 @@ export default {\n   props: [\"comment\", \"commentObj\"],\n   computed: {\n     markedComment() {\n-      return (\n+      const dirtyHTML =\n         (this.commentObj?.text && marked.parse(this.commentObj?.text)) ||\n-        (this.comment && marked.parse(this.comment))\n-      );\n+        (this.comment && marked.parse(this.comment));\n+      return DOMPurify.sanitize(dirtyHTML);\n     },\n     commentStyle() {\n       return this.commentObj?.commentStyle;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "773e8fa9f33736c7d5188bb3df5402cc883ef005",
            "date": "2025-01-10T05:01:03Z",
            "author_login": "MrCoder"
          },
          {
            "sha": "1d6b324735cadc2d1ce682a7c58522a51d5b2848",
            "date": "2025-01-10T03:10:13Z",
            "author_login": "MrCoder"
          },
          {
            "sha": "e7fc9a9e9db87672c1442542d19cacbfcb4da38c",
            "date": "2025-01-08T03:01:50Z",
            "author_login": "MrCoder"
          },
          {
            "sha": "b95e58816bf4040f66f4e125a31398ee0d3c0ace",
            "date": "2025-01-08T02:51:10Z",
            "author_login": "MrCoder"
          },
          {
            "sha": "2652964e2ff44de5103b5b366ad0e78ece32731f",
            "date": "2025-01-08T01:52:45Z",
            "author_login": "MrCoder"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "ZenUML is JavaScript-based diagramming tool that requires no server, using Markdown-inspired text definitions and a renderer to create and modify sequence diagrams. Markdown-based comments in the ZenUML diagram syntax are susceptible to Cross-site Scripting (XSS). The comment feature allows the user to attach small notes for reference. This feature allows the user to enter in their comment in markdown comment, allowing them to use common markdown features, such as `**` for bolded text. However, the markdown text is currently not sanitized before rendering, allowing an attacker to enter a malicious payload for the comment which leads to XSS. This puts existing applications that use ZenUML unsandboxed at risk of arbitrary JavaScript execution when rendering user-controlled diagrams. This vulnerability was patched in version 3.23.25,",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-06-26T20:15:16.020",
    "last_modified": "2024-11-21T09:26:11.813",
    "fix_date": "2024-06-26T04:46:28Z"
  },
  "references": [
    {
      "url": "https://github.com/mermaid-js/zenuml-core/commit/ad7545b33f5f27466cbf357beb65969ca1953e3c",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/mermaid-js/zenuml-core/security/advisories/GHSA-q6xv-jm4v-349h",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/mermaid-js/zenuml-core/commit/ad7545b33f5f27466cbf357beb65969ca1953e3c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/mermaid-js/zenuml-core/security/advisories/GHSA-q6xv-jm4v-349h",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:28.864009",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "zenuml-core",
    "owner": "mermaid-js",
    "created_at": "2023-04-06T07:33:24Z",
    "updated_at": "2025-01-11T04:19:27Z",
    "pushed_at": "2025-01-10T05:02:49Z",
    "size": 81274,
    "stars": 38,
    "forks": 8,
    "open_issues": 31,
    "watchers": 38,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 308786,
      "TypeScript": 235075,
      "Vue": 135356,
      "HTML": 126684,
      "ANTLR": 25846,
      "CSS": 14446,
      "SCSS": 7758,
      "Dockerfile": 857,
      "Less": 88,
      "Shell": 75
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T22:26:33.806871"
  }
}