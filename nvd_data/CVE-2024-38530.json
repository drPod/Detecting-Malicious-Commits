{
  "cve_id": "CVE-2024-38530",
  "github_data": {
    "repository": "gunet/openeclass",
    "fix_commit": "4449cf8bed40fd8fc4b267a5726fab9f9fe5a191",
    "related_commits": [
      "4449cf8bed40fd8fc4b267a5726fab9f9fe5a191"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "4449cf8bed40fd8fc4b267a5726fab9f9fe5a191",
      "commit_date": "2024-05-17T13:31:25Z",
      "author": {
        "login": "adia",
        "type": "User",
        "stats": {
          "total_commits": 2759,
          "average_weekly_commits": 2.826844262295082,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 553
        }
      },
      "commit_message": {
        "title": "File uploads: Hard-code common PHP file extensions exclusion",
        "length": 82,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "include/lib/fileUploadLib.inc.php",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -541,6 +541,11 @@ function isWhitelistAllowed($filename) {\n \n     $whitelist = explode(',', preg_replace('/\\s+/', '', $wh)); // strip any whitespace\n \n+    // Hard-code common PHP file extensions exclusion\n+    if (preg_match('/\\.(php.?|phtml|phar)$/i', $filename)) {\n+        return false;\n+    }\n+\n     if (in_array('*', $whitelist)) {\n         return true;\n     }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "0b3f18ec6bc5d9389b93230ed54a2aab08f7784e",
            "date": "2025-01-09T16:39:46Z",
            "author_login": "adia"
          },
          {
            "sha": "1bf7a946a14058826dfa5ed2b501f0b523515349",
            "date": "2025-01-09T16:25:41Z",
            "author_login": "adia"
          },
          {
            "sha": "2feb036f18bfe1fd084c9fba3094c2813427113d",
            "date": "2025-01-09T14:03:33Z",
            "author_login": "jexi"
          },
          {
            "sha": "638d1cb360a631a42b38b3eb94d95d34763e023f",
            "date": "2025-01-08T10:31:37Z",
            "author_login": "adia"
          },
          {
            "sha": "811df43aab1a17afb8dd76f86136d9957628ea07",
            "date": "2025-01-08T09:55:25Z",
            "author_login": "adia"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-434",
    "description": "The Open eClass platform (formerly known as GUnet eClass) is a complete Course Management System. An arbitrary file upload vulnerability in the \"save\" functionality of the H5P module enables unauthenticated users to upload arbitrary files on the server's filesystem. This may lead in unrestricted RCE on the backend server, since the upload location is accessible from the internet. This vulnerability is fixed in 3.16.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-12T15:15:20.743",
    "last_modified": "2024-08-13T17:17:47.693",
    "fix_date": "2024-05-17T13:31:25Z"
  },
  "references": [
    {
      "url": "https://github.com/gunet/openeclass/commit/4449cf8bed40fd8fc4b267a5726fab9f9fe5a191",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/gunet/openeclass/security/advisories/GHSA-88c3-hp7p-grgg",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.556696",
    "processing_status": "enhanced"
  }
}