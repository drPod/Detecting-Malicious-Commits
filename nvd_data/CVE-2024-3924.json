{
  "cve_id": "CVE-2024-3924",
  "github_data": {
    "repository": "huggingface/text-generation-inference",
    "fix_commit": "88702d876383f7200eccf67e28ba00500dc804bb",
    "related_commits": [
      "88702d876383f7200eccf67e28ba00500dc804bb",
      "88702d876383f7200eccf67e28ba00500dc804bb"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "88702d876383f7200eccf67e28ba00500dc804bb",
      "commit_date": "2024-04-15T16:47:36Z",
      "author": {
        "login": "Narsil",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixing CI. (#1748)",
        "length": 2094,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": ".github/workflows/autodocs.yml",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -13,7 +13,10 @@ jobs:\n \n     - name: Install Launcher\n       id: install-launcher\n-      run: cargo install --git https://github.com/${{ github.repository }} --branch ${{ github.head_ref }} text-generation-launcher\n+      env:\n+        REF: ${{ github.head_ref }}\n+        REPO: ${{ github.repository }}\n+      run: cargo install --git \"https://github.com/$REPO\" --branch \"$REF\" text-generation-launcher\n \n     - name: Check launcher Docs are up-to-date\n       run: |"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6cb41a80a1151f8242a66c9362debfad3598f792",
            "date": "2025-01-24T13:34:17Z",
            "author_login": "Narsil"
          },
          {
            "sha": "d2ff68e98d91eb71bdccfb533e099a62577b31e0",
            "date": "2025-01-24T11:18:28Z",
            "author_login": "Narsil"
          },
          {
            "sha": "d9dda117266389e2755099a0eac7f2d7c69d6dca",
            "date": "2025-01-24T08:32:17Z",
            "author_login": "Narsil"
          },
          {
            "sha": "d937eb64da04cfc82ffa7beb54066733ce857117",
            "date": "2025-01-23T17:54:34Z",
            "author_login": "Narsil"
          },
          {
            "sha": "18c4607d463658f5bb78b3146b5ac6a513b99ac4",
            "date": "2025-01-23T17:09:57Z",
            "author_login": "Cyrilvallez"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-94",
    "description": "A code injection vulnerability exists in the huggingface/text-generation-inference repository, specifically within the `autodocs.yml` workflow file. The vulnerability arises from the insecure handling of the `github.head_ref` user input, which is used to dynamically construct a command for installing a software package. An attacker can exploit this by forking the repository, creating a branch with a malicious payload as the name, and then opening a pull request to the base repository. Successful exploitation could lead to arbitrary code execution within the context of the GitHub Actions runner. This issue affects versions up to and including v2.0.0 and was fixed in version 2.0.0.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-05-30T15:15:49.653",
    "last_modified": "2024-11-21T09:30:42.713",
    "fix_date": "2024-04-15T16:47:36Z"
  },
  "references": [
    {
      "url": "https://github.com/huggingface/text-generation-inference/commit/88702d876383f7200eccf67e28ba00500dc804bb",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/8af92fc2-0103-4d29-bb28-c3893154c422",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/huggingface/text-generation-inference/commit/88702d876383f7200eccf67e28ba00500dc804bb",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/8af92fc2-0103-4d29-bb28-c3893154c422",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.326460",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "text-generation-inference",
    "owner": "huggingface",
    "created_at": "2022-10-08T10:26:28Z",
    "updated_at": "2025-01-26T07:53:23Z",
    "pushed_at": "2025-01-25T07:00:14Z",
    "size": 11753,
    "stars": 9640,
    "forks": 1129,
    "open_issues": 201,
    "watchers": 9640,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 2342983,
      "Rust": 734867,
      "Cuda": 150444,
      "C++": 44170,
      "Nix": 14118,
      "Dockerfile": 9914,
      "CMake": 9155,
      "JavaScript": 6346,
      "Shell": 5044,
      "Makefile": 2939,
      "C": 1001
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-26T08:15:47.879522"
  }
}