{
  "cve_id": "CVE-2024-39314",
  "github_data": {
    "repository": "KisaragiEffective/toy-blog",
    "fix_commit": "4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7",
    "related_commits": [
      "4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7",
      "4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7"
    ],
    "patch_url": "https://github.com/KisaragiEffective/toy-blog/commit/4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7.patch",
    "fix_commit_details": {
      "sha": "4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7",
      "commit_date": "2023-04-14T17:45:51Z",
      "author": {
        "login": "KisaragiEffective",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix!: remove --bearer-token",
        "length": 27,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 19,
        "additions": 5,
        "deletions": 14
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -5,19 +5,19 @@\n ## How to run\n ```sh\n cargo run -- \\\n-  --bearer-token=INSERT_YOUR_OWN_PASSWORD \\\n   --http-host=127.0.0.1 \\\n   --http-port=8080 \\\n   --telnet-host=127.0.0.1 \\\n   --telnet-port=12345\n ```\n \n ### \u89e3\u8aac\n-* `--bearer-token`: \u8a18\u4e8b\u3092\u66f4\u65b0\u3059\u308b\u3068\u304d\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a2d\u5b9a\u3059\u308b\u3002\u3053\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u4f7f\u3044\u56de\u3055\u306a\u3044\u3053\u3068\u3002\u3053\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u306f\u6c38\u7d9a\u5316\u3055\u308c\u306a\u3044\u306e\u3067\u3001\u8d77\u52d5\u3059\u308b\u305f\u3073\u306b\u5165\u529b\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u3002\n+* `--bearer-token`: \u5ec3\u6b62\u3002\u6a19\u6e96\u5165\u529b\u304b\u3089\u6539\u884c\u7d42\u7aef\u3067\u4e0e\u3048\u308b\u3053\u3068\u3002\n * `--http-host`: HTTP\u30b5\u30fc\u30d0\u30fc\u306e\u30db\u30b9\u30c8\u3002\u901a\u5e38\u306f`127.0.0.1`\u3092\u6307\u5b9a\u3057\u3066\u826f\u3044\u3002\n * `--http-port`: HTTP\u30b5\u30fc\u30d0\u30fc\u306e\u30dd\u30fc\u30c8\u756a\u53f7\u3002\n * `--telnet-host`: telnet\u30b5\u30fc\u30d0\u30fc\u306e\u30db\u30b9\u30c8\u3002\u901a\u5e38\u306f`127.0.0.1`\u3092\u6307\u5b9a\u3057\u3066\u826f\u3044\u3002\n * `--telnet-port`: telnet\u30b5\u30fc\u30d0\u30fc\u306e\u30dd\u30fc\u30c8\u756a\u53f7\u3002\n+* `--read-bearer-token-from-stdin`: \u6b21\u306e\u30e1\u30b8\u30e3\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u5ec3\u6b62\u4e88\u5b9a\u3002\u3053\u306e\u30b9\u30a4\u30c3\u30c1\u306f\u3082\u306f\u3084\u4e92\u63db\u6027\u306e\u305f\u3081\u3060\u3051\u306b\u6b8b\u3055\u308c\u3066\u3044\u308b\u3002\n \n ### \u52d5\u4f5c\u3055\u305b\u308b\u306b\u3042\u305f\u3063\u3066\u306e\u6ce8\u610f\u4e8b\u9805\n * Cloudflare\u306e\u30c8\u30f3\u30cd\u30eb\u3092\u4f7f\u3063\u3066\u3044\u308b\u5834\u5408\u3001`--cloudflare`\u30b9\u30a4\u30c3\u30c1\u3092\u4ed8\u3051\u8db3\u3059\u3053\u3068\u3002"
        },
        {
          "filename": "src/main.rs",
          "status": "modified",
          "additions": 3,
          "deletions": 12,
          "patch": "@@ -37,9 +37,6 @@ struct Args {\n #[derive(Subcommand)]\n enum Commands {\n     Run {\n-        /// DEPRECATED\n-        #[clap(long)]\n-        bearer_token: Option<String>,\n         #[clap(long)]\n         http_port: u16,\n         #[clap(long)]\n@@ -50,6 +47,7 @@ enum Commands {\n         telnet_host: String,\n         #[clap(long = \"cloudflare\")]\n         cloudflare_support: bool,\n+        /// DEPRECATED, It will be removed in next major version. This switch is no-op.\n         #[clap(long)]\n         read_bearer_token_from_stdin: bool,\n     },\n@@ -86,25 +84,18 @@ async fn main() -> Result<()> {\n     let args: Args = Args::parse();\n     match args.subcommand {\n         Commands::Run {\n-            bearer_token,\n             http_port,\n             http_host,\n             telnet_port,\n             telnet_host,\n             cloudflare_support,\n             read_bearer_token_from_stdin\n         } => {\n-            let bearer_token = bearer_token.map_or_else(|| if read_bearer_token_from_stdin {\n+            let bearer_token = {\n                 let mut buf = String::new();\n                 stdin().read_line(&mut buf).expect(\"failed to read from stdin\");\n                 buf.trim_end().to_string()\n-            } else {\n-                eprintln!(\"You must set bearer token to protecting your server.\");\n-                exit(1)\n-            }, |token| {\n-                eprintln!(\"--bearer-token is unsecure. It will be removed by next major release. Please use --read-bearer-token-from-stdin.\");\n-                token\n-            });\n+            };\n \n             WRITE_TOKEN.set(bearer_token).unwrap();\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fe0e092f95c101ef806483efd4de6a9fa360c529",
            "date": "2025-01-13T09:51:23Z",
            "author_login": "KisaragiEffective"
          },
          {
            "sha": "74e98ec9f8d3a81ea28dc864f48a9af6607f31d6",
            "date": "2025-01-13T09:50:15Z",
            "author_login": "KisaragiEffective"
          },
          {
            "sha": "2c43d63c1aaf46728983412436fbd883555c5972",
            "date": "2025-01-11T12:27:30Z",
            "author_login": "KisaragiEffective"
          },
          {
            "sha": "9c6691cca16e8a0a660daefe73e4f68856cea351",
            "date": "2025-01-11T12:23:07Z",
            "author_login": "KisaragiEffective"
          },
          {
            "sha": "2758867e03768d01f2cba95a0159860fdebde307",
            "date": "2025-01-11T02:54:07Z",
            "author_login": "renovate[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.7,
    "cvss_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "toy-blog is a headless content management system implementation. Starting in version 0.4.3 and prior to version 0.5.0, the administrative password was leaked through the command line parameter. The problem was patched in version 0.5.0. As a workaround, pass `--read-bearer-token-from-stdin` to the launch arguments and feed the token from the standard input in version 0.4.14 or later. Earlier versions do not have this workaround.",
    "attack_vector": "LOCAL",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-07-01T22:15:03.900",
    "last_modified": "2024-11-21T09:27:26.497",
    "fix_date": "2023-04-14T17:45:51Z"
  },
  "references": [
    {
      "url": "https://github.com/KisaragiEffective/toy-blog/commit/4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/KisaragiEffective/toy-blog/security/advisories/GHSA-q8g2-c3x5-gp89",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/KisaragiEffective/toy-blog/commit/4d003e46a944d8f44ea02c63f4beefa4cbe1f4f7",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/KisaragiEffective/toy-blog/security/advisories/GHSA-q8g2-c3x5-gp89",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:28.882839",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "toy-blog",
    "owner": "KisaragiEffective",
    "created_at": "2022-07-01T20:38:04Z",
    "updated_at": "2025-01-13T09:51:28Z",
    "pushed_at": "2025-01-13T09:51:27Z",
    "size": 944,
    "stars": 4,
    "forks": 1,
    "open_issues": 29,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "Rust": 81144,
      "Shell": 754
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T14:18:07.248044"
  }
}