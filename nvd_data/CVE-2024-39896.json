{
  "cve_id": "CVE-2024-39896",
  "github_data": {
    "repository": "directus/directus",
    "fix_commit": "454cb534d6ffa547feb11f4d74b932ae7368dae2",
    "related_commits": [
      "454cb534d6ffa547feb11f4d74b932ae7368dae2",
      "454cb534d6ffa547feb11f4d74b932ae7368dae2"
    ],
    "patch_url": "https://github.com/directus/directus/commit/454cb534d6ffa547feb11f4d74b932ae7368dae2.patch",
    "fix_commit_details": {
      "sha": "454cb534d6ffa547feb11f4d74b932ae7368dae2",
      "commit_date": "2024-06-24T18:51:07Z",
      "author": {
        "login": "br41nslug",
        "type": "User",
        "stats": {
          "total_commits": 418,
          "average_weekly_commits": 1.613899613899614,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 127
        }
      },
      "commit_message": {
        "title": "Merge pull request from GHSA-jgf4-vwc3-r46v",
        "length": 214,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 2,
        "deletions": 12
      },
      "files": [
        {
          "filename": "api/src/services/authentication.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 12,
          "patch": "@@ -3,7 +3,6 @@ import { useEnv } from '@directus/env';\n import {\n \tInvalidCredentialsError,\n \tInvalidOtpError,\n-\tInvalidProviderError,\n \tServiceUnavailableError,\n \tUserSuspendedError,\n } from '@directus/errors';\n@@ -125,19 +124,10 @@ export class AuthenticationService {\n \t\t\t);\n \t\t};\n \n-\t\tif (user?.status !== 'active') {\n+\t\tif (user?.status !== 'active' || user?.provider !== providerName) {\n \t\t\temitStatus('fail');\n-\n-\t\t\tif (user?.status === 'suspended') {\n-\t\t\t\tawait stall(STALL_TIME, timeStart);\n-\t\t\t\tthrow new UserSuspendedError();\n-\t\t\t} else {\n-\t\t\t\tawait stall(STALL_TIME, timeStart);\n-\t\t\t\tthrow new InvalidCredentialsError();\n-\t\t\t}\n-\t\t} else if (user.provider !== providerName) {\n \t\t\tawait stall(STALL_TIME, timeStart);\n-\t\t\tthrow new InvalidProviderError();\n+\t\t\tthrow new InvalidCredentialsError();\n \t\t}\n \n \t\tconst settingsService = new SettingsService({"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "28f7dc1c87793e5404c11a7d771760d772171108",
            "date": "2025-01-14T16:53:02Z",
            "author_login": "SP12893678"
          },
          {
            "sha": "3d6f6b5a84cddcfff8bc77fd17b66622732f6847",
            "date": "2025-01-14T14:24:03Z",
            "author_login": "ComfortablyCoding"
          },
          {
            "sha": "95687907fe6abdc2102fece5c9a0c4f637a48cda",
            "date": "2025-01-13T18:35:02Z",
            "author_login": "Dominic-Marcelino"
          },
          {
            "sha": "f6e54ecfc937f519d8cdf44cf10d110c5bbb14d1",
            "date": "2025-01-13T15:24:41Z",
            "author_login": "joselcvarela"
          },
          {
            "sha": "c2b35c42341ec304a83d7175360141e654a50912",
            "date": "2025-01-13T14:33:43Z",
            "author_login": "connorwinston"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "Directus is a real-time API and App dashboard for managing SQL database content. When relying on SSO providers in combination with local authentication it can be possible to enumerate existing SSO users in the instance. This is possible because if an email address exists in Directus and belongs to a known SSO provider then it will throw a \"helpful\" error that the user belongs to another provider. This vulnerability is fixed in 10.13.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-08T18:15:08.383",
    "last_modified": "2025-01-03T16:30:43.367",
    "fix_date": "2024-06-24T18:51:07Z"
  },
  "references": [
    {
      "url": "https://github.com/directus/directus/commit/454cb534d6ffa547feb11f4d74b932ae7368dae2",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/directus/directus/security/advisories/GHSA-jgf4-vwc3-r46v",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/directus/directus/commit/454cb534d6ffa547feb11f4d74b932ae7368dae2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/directus/directus/security/advisories/GHSA-jgf4-vwc3-r46v",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.418811",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "directus",
    "owner": "directus",
    "created_at": "2012-12-12T01:35:36Z",
    "updated_at": "2025-01-14T12:22:36Z",
    "pushed_at": "2025-01-14T01:57:44Z",
    "size": 402534,
    "stars": 28706,
    "forks": 4004,
    "open_issues": 560,
    "watchers": 28706,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 5077921,
      "Vue": 1872125,
      "SCSS": 55791,
      "Liquid": 28677,
      "CSS": 28575,
      "JavaScript": 26426,
      "Dockerfile": 1905,
      "HTML": 1189
    },
    "commit_activity": {
      "total_commits_last_year": 1775,
      "avg_commits_per_week": 34.13461538461539,
      "days_active_last_year": 258
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:01:10.212039"
  }
}