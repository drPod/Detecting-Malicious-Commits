{
  "cve_id": "CVE-2024-39900",
  "github_data": {
    "repository": "opensearch-project/reporting",
    "fix_commit": "2403014c57ee63268e83d919db3334b676a8c992",
    "related_commits": [
      "2403014c57ee63268e83d919db3334b676a8c992",
      "2403014c57ee63268e83d919db3334b676a8c992"
    ],
    "patch_url": "https://github.com/opensearch-project/reporting/commit/2403014c57ee63268e83d919db3334b676a8c992.patch",
    "fix_commit_details": {
      "sha": "2403014c57ee63268e83d919db3334b676a8c992",
      "commit_date": "2024-04-26T17:11:40Z",
      "author": {
        "login": "opensearch-trigger-bot[bot]",
        "type": "Bot",
        "stats": {
          "total_commits": 6,
          "average_weekly_commits": 0.024390243902439025,
          "total_additions": 13434,
          "total_deletions": 63075,
          "weeks_active": 5
        }
      },
      "commit_message": {
        "title": "tenancy access control (#992) (#993)",
        "length": 420,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
      },
      "files": [
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -60,7 +60,7 @@ OpenSearch Dashboards Reports allows \u2018Report Owner\u2019 (engineers, including bu\n [reports-scheduler-it-badge]: https://img.shields.io/badge/Reports%20Scheduler%20IT%20tests-in%20progress-yellow\n [reports-scheduler-it-link]: https://github.com/opensearch-project/opensearch-build/issues/1124\n [reports-scheduler-it-code-badge]: https://img.shields.io/badge/Reports%20Scheduler%20code-blue\n-[reports-scheduler-it-code-link]: https://github.com/opensearch-project/dashboards-reports/blob/main/reports-scheduler/src/test/kotlin/org/opensearch/reportsscheduler/ReportsSchedulerPluginIT.kt\n+[reports-scheduler-it-code-link]: https://github.com/opensearch-project/reporting/blob/main/src/test/kotlin/org/opensearch/integTest/ReportsSchedulerPluginIT.kt\n [bwc-tests-badge]: https://img.shields.io/badge/BWC%20tests-in%20progress-yellow\n [bwc-tests-link]: https://github.com/opensearch-project/dashboards-reports/pull/244/files\n [good-first-badge]: https://img.shields.io/github/issues/opensearch-project/dashboards-reports/good%20first%20issue.svg"
        },
        {
          "filename": "src/main/kotlin/org/opensearch/reportsscheduler/security/UserAccessManager.kt",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -118,6 +118,9 @@ internal object UserAccessManager {\n         if (getUserTenant(user) != tenant) {\n             return false\n         }\n+        if (isUserPrivateTenant(user)) {\n+            return access.contains(\"$USER_TAG${user.name}\")\n+        }\n         return if (PluginSettings.isRbacEnabled()) {\n             user.backendRoles.map { \"$BACKEND_ROLE_TAG$it\" }.any { it in access }\n         } else {"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fb95c0e991b9aa7ebdb8feafd3308b3af25e3b05",
            "date": "2024-11-01T19:57:48Z",
            "author_login": "opensearch-trigger-bot[bot]"
          },
          {
            "sha": "2f39eb2bb2ffa1dc1fa7afc6399ea77d021ce689",
            "date": "2024-09-05T22:32:10Z",
            "author_login": "sumukhswamy"
          },
          {
            "sha": "c2fb2dabd7c9320d1a9c55fd0fb3722e877bda27",
            "date": "2024-07-29T14:08:15Z",
            "author_login": "rupal-bq"
          },
          {
            "sha": "11ed7b665bf30096428253f6e5d35072ed3a02bb",
            "date": "2024-07-23T17:13:30Z",
            "author_login": "rupal-bq"
          },
          {
            "sha": "dba464415e295b8c2e4a201aaf11d8bec0d49812",
            "date": "2024-07-22T16:41:09Z",
            "author_login": "dblock"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-639",
    "description": "OpenSearch Dashboards Reports allows \u2018Report Owner\u2019 export and share reports from OpenSearch Dashboards. An issue in the OpenSearch reporting plugin allows unintended access to private tenant resources like notebooks. The system did not properly check if the user was the resource author when accessing resources in a private tenant, leading to potential data being revealed. The patches are included in OpenSearch 2.14.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-09T22:15:03.243",
    "last_modified": "2024-11-21T09:28:31.610",
    "fix_date": "2024-04-26T17:11:40Z"
  },
  "references": [
    {
      "url": "https://github.com/opensearch-project/reporting/commit/2403014c57ee63268e83d919db3334b676a8c992",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/reporting/security/advisories/GHSA-xmvg-335g-x44q",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://opensearch.org/versions/opensearch-2-14-0.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/reporting/commit/2403014c57ee63268e83d919db3334b676a8c992",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/reporting/security/advisories/GHSA-xmvg-335g-x44q",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://opensearch.org/versions/opensearch-2-14-0.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.470261",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "reporting",
    "owner": "opensearch-project",
    "created_at": "2021-04-06T02:32:08Z",
    "updated_at": "2024-11-01T19:57:52Z",
    "pushed_at": "2024-12-11T23:22:27Z",
    "size": 49125,
    "stars": 29,
    "forks": 69,
    "open_issues": 83,
    "watchers": 29,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.x",
      "1.0",
      "1.1",
      "1.2",
      "1.3",
      "2.x",
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "2.4",
      "2.5",
      "2.6",
      "2.7",
      "2.8",
      "2.9",
      "2.10",
      "2.11",
      "2.12",
      "2.13",
      "2.14",
      "2.15",
      "2.16",
      "2.17",
      "2.18",
      "7.9.1",
      "aes-7.9.1-Aug-patch",
      "aes-7.10-Aug-patch",
      "aes-7.10",
      "aos-1.0.0.0-beta1"
    ],
    "languages": {
      "Kotlin": 405767,
      "Java": 16057,
      "HTML": 14667,
      "Python": 1680
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:29:59.245831"
  }
}