{
  "cve_id": "CVE-2024-39901",
  "github_data": {
    "repository": "opensearch-project/observability",
    "fix_commit": "014423178f8f61d90442dde03cbdcd754c70a84e",
    "related_commits": [
      "014423178f8f61d90442dde03cbdcd754c70a84e",
      "014423178f8f61d90442dde03cbdcd754c70a84e"
    ],
    "patch_url": "https://github.com/opensearch-project/observability/commit/014423178f8f61d90442dde03cbdcd754c70a84e.patch",
    "fix_commit_details": {
      "sha": "014423178f8f61d90442dde03cbdcd754c70a84e",
      "commit_date": "2024-04-26T17:12:18Z",
      "author": {
        "login": "opensearch-trigger-bot[bot]",
        "type": "Bot",
        "stats": null
      },
      "commit_message": {
        "title": "tenancy access control (#1821) (#1822)",
        "length": 450,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
      },
      "files": [
        {
          "filename": "DEVELOPER_GUIDE.md",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -14,8 +14,8 @@ By default, tests use the same runtime as `JAVA_HOME`.\n \n ### Setup\n \n-1. Download OpenSearch for the version that matches the [OpenSearch Dashboards version specified in opensearch_dashboards.json](./dashboards-observability/opensearch_dashboards.json#L4) from [opensearch.org](https://opensearch.org/downloads.html).\n-1. Download the OpenSearch Dashboards source code for the [version specified in opensearch_dashboards.json](./dashboards-observability/opensearch_dashboards.json#L4) you want to set up.\n+1. Download OpenSearch for the version that matches the OpenSearch Dashboards version specified in `opensearch_dashboards.json` from [opensearch.org](https://opensearch.org/downloads.html).\n+1. Download the OpenSearch Dashboards source code for the version specified in `opensearch_dashboards.json` you want to set up.\n 1. Change your node version to the version specified in `.node-version` inside the OpenSearch Dashboards root directory.\n 1. cd into `OpenSearch-Dashboards` and remove the `plugins` directory.\n 1. Check out this package from version control as the `plugins` directory."
        },
        {
          "filename": "README.md",
          "status": "modified",
          "additions": 1,
          "deletions": 2,
          "patch": "@@ -66,11 +66,10 @@ Observability is collection of plugins and applications that let you visualize d\n [cypress-test-badge]: https://img.shields.io/badge/Cypress%20tests-in%20progress-yellow\n [cypress-test-link]: https://github.com/opensearch-project/opensearch-build/issues/1124\n [cypress-code-badge]: https://img.shields.io/badge/Cypress%20code-blue\n-[cypress-code-link]: https://github.com/opensearch-project/observability/blob/main/dashboards-observability/.cypress/CYPRESS_TESTS.md\n [opensearch-it-badge]: https://img.shields.io/badge/OpenSearch%20Plugin%20IT%20tests-in%20progress-yellow\n [opensearch-it-link]: https://github.com/opensearch-project/opensearch-build/issues/1124\n [opensearch-it-code-badge]: https://img.shields.io/badge/OpenSearch%20IT%20code-blue\n-[opensearch-it-code-link]: https://github.com/opensearch-project/observability/blob/main/opensearch-observability/src/test/kotlin/org/opensearch/observability/ObservabilityPluginIT.kt\n+[opensearch-it-code-link]: https://github.com/opensearch-project/observability/blob/main/src/test/kotlin/org/opensearch/observability/ObservabilityPluginIT.kt\n [bwc-tests-badge]: https://img.shields.io/badge/BWC%20tests-in%20progress-yellow\n [bwc-tests-link]: https://github.com/opensearch-project/observability/issues/276\n [good-first-badge]: https://img.shields.io/github/issues/opensearch-project/observability/good%20first%20issue.svg"
        },
        {
          "filename": "src/main/kotlin/org/opensearch/observability/security/UserAccessManager.kt",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -147,6 +147,9 @@ internal object UserAccessManager {\n         if (getUserTenant(user) != tenant) {\n             return false\n         }\n+        if (isUserPrivateTenant(user)) {\n+            return access.contains(\"$USER_TAG${user.name}\")\n+        }\n         if (canAdminViewAllItems(user)) {\n             return true\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 7
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b930f53579a7665b3a21975510bc78e1d2aa6a78",
            "date": "2025-01-13T22:09:29Z",
            "author_login": "cwperks"
          },
          {
            "sha": "13d4a462a626713c5ae54aaa683d45b995b4ddbe",
            "date": "2024-11-06T22:25:29Z",
            "author_login": "YANG-DB"
          },
          {
            "sha": "8a8b676d475d128e44b29a096c4cc43d84bc559c",
            "date": "2024-11-01T18:22:34Z",
            "author_login": "sumukhswamy"
          },
          {
            "sha": "d5cd1289a738fd14a7a514d9c4bebd7d4212d6f3",
            "date": "2024-09-05T22:45:50Z",
            "author_login": "RyanL1997"
          },
          {
            "sha": "d8f88b0d734ad2785288aa8c990cf995fd1a4aef",
            "date": "2024-07-25T23:16:08Z",
            "author_login": "mengweieric"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-639",
    "description": "OpenSearch Observability is collection of plugins and applications that visualize data-driven events. An issue in the OpenSearch observability plugins allows unintended access to private tenant resources like notebooks. The system did not properly check if the user was the resource author when accessing resources in a private tenant, leading to potential data being revealed. The patches are included in OpenSearch 2.14.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-07-09T22:15:03.450",
    "last_modified": "2024-11-21T09:28:31.763",
    "fix_date": "2024-04-26T17:12:18Z"
  },
  "references": [
    {
      "url": "https://github.com/opensearch-project/observability/commit/014423178f8f61d90442dde03cbdcd754c70a84e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/observability/security/advisories/GHSA-77vc-rj32-2r33",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://opensearch.org/versions/opensearch-2-14-0.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/observability/commit/014423178f8f61d90442dde03cbdcd754c70a84e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/opensearch-project/observability/security/advisories/GHSA-77vc-rj32-2r33",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://opensearch.org/versions/opensearch-2-14-0.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.470439",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "observability",
    "owner": "opensearch-project",
    "created_at": "2021-04-02T20:27:04Z",
    "updated_at": "2025-01-13T22:09:34Z",
    "pushed_at": "2025-01-13T22:09:30Z",
    "size": 33494,
    "stars": 53,
    "forks": 100,
    "open_issues": 85,
    "watchers": 53,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.x",
      "1.0",
      "1.1",
      "1.2",
      "1.3",
      "1.3.10-release-notes",
      "2.x",
      "2.0",
      "2.1",
      "2.2",
      "2.3",
      "2.4",
      "2.5",
      "2.6",
      "2.7",
      "2.8",
      "2.9",
      "2.10",
      "2.11",
      "2.12",
      "2.13",
      "2.14",
      "2.15",
      "2.16",
      "2.17",
      "2.18",
      "1548-move-the-schema-definition-out-of-the-observability-context",
      "anirudha-patch-1",
      "application-analytics"
    ],
    "languages": {
      "Kotlin": 347593,
      "Shell": 2188
    },
    "commit_activity": {
      "total_commits_last_year": 20,
      "avg_commits_per_week": 0.38461538461538464,
      "days_active_last_year": 20
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:36:06.606047"
  }
}