{
  "cve_id": "CVE-2024-39906",
  "github_data": {
    "repository": "havenweb/haven",
    "fix_commit": "c52f07c",
    "related_commits": [
      "c52f07c",
      "c52f07c"
    ],
    "patch_url": "https://github.com/havenweb/haven/commit/c52f07c.patch",
    "fix_commit_details": {
      "sha": "c52f07c",
      "commit_date": "2024-07-05T14:18:24Z",
      "author": {
        "login": "mawise",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "add URI validation to indieauth flow",
        "length": 36,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
      },
      "files": [
        {
          "filename": "lib/indie_auth_client.rb",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -28,7 +28,7 @@ def initialize(client_id)\n     @redirects = []\n     if should_fetch?\n       begin\n-        URI.open(client_id) do |f|\n+        URI(client_id).open do |f|\n           doc = Nokogiri::HTML(f.read)\n \n           url = \"\"\n@@ -66,6 +66,7 @@ def initialize(client_id)\n   def should_fetch?\n     clean_host = parse_hostname(@client_id)\n     begin\n+      client_id_uri = URI.parse(@client_id) #for validation only\n       ip = Resolv.getaddress(clean_host)\n       return safe_ip? ip\n     rescue"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ed8777cfbbead7451058b39deb6998a0bf61b646",
            "date": "2025-01-02T16:10:18Z",
            "author_login": "mawise"
          },
          {
            "sha": "fecb0c67a5d3b91367d99235a7c34a9047f33387",
            "date": "2024-12-31T14:03:10Z",
            "author_login": "mawise"
          },
          {
            "sha": "823401a365966be4ed56d6e3d0f295f33c201233",
            "date": "2024-12-31T01:38:45Z",
            "author_login": "mawise"
          },
          {
            "sha": "7400a8ebfe0e7a0aa27a3d652081dd87fdb8bcbf",
            "date": "2024-12-30T15:02:41Z",
            "author_login": "mawise"
          },
          {
            "sha": "90a3b93cce7495c73739fc91017b365bb20c8a94",
            "date": "2024-12-02T22:03:12Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-74",
    "description": "A command injection vulnerability was found in the IndieAuth functionality of the Ruby on Rails based Haven blog web application. The affected functionality requires authentication, but an attacker can craft a link that they can pass to a logged in administrator of the blog software. This leads to the immediate execution of the provided commands when the link is accessed by the authenticated administrator. This issue may lead to Remote Code Execution (RCE) and has been addressed by commit `c52f07c`. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-07-19T20:15:07.887",
    "last_modified": "2024-11-21T09:28:32.470",
    "fix_date": "2024-07-05T14:18:24Z"
  },
  "references": [
    {
      "url": "https://github.com/havenweb/haven/commit/c52f07c",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/havenweb/haven/security/advisories/GHSA-65cm-7g24-hm9f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/havenweb/haven/commit/c52f07c",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/havenweb/haven/security/advisories/GHSA-65cm-7g24-hm9f",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.499761",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "haven",
    "owner": "havenweb",
    "created_at": "2021-01-19T03:55:27Z",
    "updated_at": "2025-01-14T10:58:15Z",
    "pushed_at": "2025-01-03T01:36:28Z",
    "size": 3644,
    "stars": 668,
    "forks": 35,
    "open_issues": 10,
    "watchers": 668,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Ruby": 189047,
      "HTML": 40063,
      "Shell": 11869,
      "CSS": 9490,
      "Dockerfile": 1285,
      "JavaScript": 799,
      "SCSS": 721,
      "Procfile": 30
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:12:58.364939"
  }
}