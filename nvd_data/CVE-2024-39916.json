{
  "cve_id": "CVE-2024-39916",
  "github_data": {
    "repository": "FOGProject/fogproject",
    "fix_commit": "2de209bc57a177a052b4a877f000c591740b2f88",
    "related_commits": [
      "2de209bc57a177a052b4a877f000c591740b2f88",
      "2de209bc57a177a052b4a877f000c591740b2f88"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2de209bc57a177a052b4a877f000c591740b2f88",
      "commit_date": "2024-06-24T15:28:47Z",
      "author": {
        "login": "mastacontrola",
        "type": "User",
        "stats": {
          "total_commits": 12129,
          "average_weekly_commits": 21.50531914893617,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 261
        }
      },
      "commit_message": {
        "title": "Should address potential security issue",
        "length": 39,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "lib/common/functions.sh",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1362,7 +1362,7 @@ configureNFS() {\n         mv -fv \"${nfsconfig}\" \"${nfsconfig}.${timestamp}\" >>$error_log 2>&1\n         userId=$(id -u $username)\n         groupId=$(id -g $username)\n-        echo -e \"$storageLocation *(ro,sync,no_wdelay,no_subtree_check,insecure_locks,all_squash,anonuid=${userId},anongid=${groupId},fsid=0)\\n$storageLocation/dev *(rw,async,no_wdelay,no_subtree_check,all_squash,anonuid=${userId},anongid=${groupId},fsid=1)\" > \"$nfsconfig\"\n+        echo -e \"$storageLocation *(ro,sync,no_wdelay,subtree_check,insecure_locks,all_squash,anonuid=${userId},anongid=${groupId},fsid=0)\\n$storageLocation/dev *(rw,async,no_wdelay,subtree_check,all_squash,anonuid=${userId},anongid=${groupId},fsid=1)\" > \"$nfsconfig\"\n         diffconfig \"${nfsconfig}\"\n         errorStat $?\n         dots \"Setting up and starting RPCBind\""
        },
        {
          "filename": "lib/redhat/config.sh",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -26,7 +26,7 @@ case $linuxReleaseName_lower in\n         [[ -z $packmanUpdate ]] && packmanUpdate=\"urpmi.update -a\"\n         [[ -z $dhcpname ]] && dhcpname=\"dhcp-server\"\n         [[ -z $tftpdirdst ]] && tftpdirdst=\"/var/lib/tftpboot\"\n-        [[ -z $nfsexportsopts ]] && nfsexportsopts=\"no_subtree_check\"\n+        [[ -z $nfsexportsopts ]] && nfsexportsopts=\"subtree_check\"\n         [[ -z $etcconf ]] && etcconf=\"/etc/httpd/conf/conf.d/fog.conf\"\n         ;;\n     *)"
        },
        {
          "filename": "packages/web/lib/fog/system.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -53,7 +53,7 @@ private static function _versionCompare()\n     public function __construct()\n     {\n         self::_versionCompare();\n-        define('FOG_VERSION', '1.5.10.29');\n+        define('FOG_VERSION', '1.5.10.30');\n         define('FOG_SCHEMA', 270);\n         define('FOG_BCACHE_VER', 140);\n         define('FOG_CLIENT_VERSION', '0.13.0');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6a66e4311a3a9afc0bb07d5999b724655e359e6f",
            "date": "2025-01-15T15:52:06Z",
            "author_login": "fog-workflows[bot]"
          },
          {
            "sha": "09341f23eeafbb4f83767a2070d71362ff89cd44",
            "date": "2025-01-14T13:09:39Z",
            "author_login": "mastacontrola"
          },
          {
            "sha": "423a55d2e21bffe2ca3da2a27ce68ff2322a2e18",
            "date": "2024-11-18T11:08:58Z",
            "author_login": "mastacontrola"
          },
          {
            "sha": "2fac87db8ee3df1db5bc0ecbe80f5e214f631c01",
            "date": "2024-11-15T14:52:44Z",
            "author_login": "osiktech"
          },
          {
            "sha": "fb6325a48bde86dd44589903528dce4177e5447f",
            "date": "2024-11-15T14:41:27Z",
            "author_login": "fog-workflows[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-453",
    "description": "FOG is a free open-source cloning/imaging/rescue suite/inventory management system. There is a security issue with the NFS configuration in /etc/exports generated by the installer that allows an attacker to modify files outside the export in the default installation. The exports have the no_subtree_check option. The no_subtree_check option means that if a client performs a file operation, the server will only check if the requested file is on the correct filesystem, not if it is in the correct directory. This enables modifying files in /images, accessing other files on the same filesystem, and accessing files on other filesystems. This vulnerability is fixed in 1.5.10.30.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-12T15:15:11.813",
    "last_modified": "2024-11-21T09:28:33.610",
    "fix_date": "2024-06-24T15:28:47Z"
  },
  "references": [
    {
      "url": "https://github.com/FOGProject/fogproject/commit/2de209bc57a177a052b4a877f000c591740b2f88",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/FOGProject/fogproject/security/advisories/GHSA-3xjr-xf9v-hwjh",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FOGProject/fogproject/commit/2de209bc57a177a052b4a877f000c591740b2f88",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/FOGProject/fogproject/security/advisories/GHSA-3xjr-xf9v-hwjh",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.480934",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "fogproject",
    "owner": "FOGProject",
    "created_at": "2014-04-15T18:28:09Z",
    "updated_at": "2025-01-26T00:50:41Z",
    "pushed_at": "2025-01-20T16:51:14Z",
    "size": 4511714,
    "stars": 1193,
    "forks": 229,
    "open_issues": 42,
    "watchers": 1193,
    "has_security_policy": false,
    "default_branch": "stable",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 3144789,
      "JavaScript": 610298,
      "Shell": 240487,
      "Makefile": 90209,
      "SCSS": 79489,
      "Less": 78481,
      "CSS": 45725,
      "C": 18292,
      "HTML": 2693,
      "Awk": 375
    },
    "commit_activity": {
      "total_commits_last_year": 216,
      "avg_commits_per_week": 4.153846153846154,
      "days_active_last_year": 51
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T07:52:59.047540"
  }
}