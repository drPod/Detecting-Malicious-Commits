{
  "cve_id": "CVE-2024-40101",
  "github_data": {
    "repository": "microweber/microweber",
    "fix_commit": "0dede6886c6df3d1f31c4f4e3ba1ab4a336fbf79",
    "related_commits": [
      "0dede6886c6df3d1f31c4f4e3ba1ab4a336fbf79"
    ],
    "patch_url": "https://github.com/microweber/microweber/commit/0dede6886c6df3d1f31c4f4e3ba1ab4a336fbf79.patch",
    "fix_commit_details": {
      "sha": "0dede6886c6df3d1f31c4f4e3ba1ab4a336fbf79",
      "commit_date": "2024-06-24T12:11:56Z",
      "author": {
        "login": "peter-mw",
        "type": "User",
        "stats": {
          "total_commits": 7965,
          "average_weekly_commits": 15.0,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 408
        }
      },
      "commit_message": {
        "title": "update",
        "length": 6,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 128,
        "additions": 126,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/MicroweberPackages/Helper/XSSClean.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -72,7 +72,7 @@ public function clean($html)\n \n \n          // from https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontransitionend\n-        $cleanStrings =  MwHtmlSanitizerReference::MW_NOT_ALLOWED_ATTRIBUTES;\n+        $cleanStrings =  MwHtmlSanitizerReference::getNotAllowedAttributes();\n \n         $antiXss = new AntiXSS();\n         $antiXss->addEvilHtmlTags($cleanStrings);"
        },
        {
          "filename": "src/MicroweberPackages/Security/HtmlSanitizer/MwHtmlSanitizerReference.php",
          "status": "modified",
          "additions": 125,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@ class MwHtmlSanitizerReference\n     ];\n     public const MW_ATTRIBUTES = [\n         'id' => true,\n-         'class' => true,\n+        'class' => true,\n         'style' => true,\n         'data-rel' => true,\n         'data-rel-id' => true,\n@@ -504,5 +504,129 @@ class MwHtmlSanitizerReference\n         'x-data',\n     ];\n \n+    public const ADDITIONAL_NOT_ALLOWED_ATTRIBUTES = [\n+        'onafterprint',\n+        'onafterscriptexecute',\n+        'onanimationcancel',\n+        'onanimationend',\n+        'onanimationiteration',\n+        'onanimationstart',\n+        'onauxclick',\n+        'onbeforecopy',\n+        'onbeforecut',\n+        'onbeforeinput',\n+        'onbeforeprint',\n+        'onbeforescriptexecute',\n+        'onbeforetoggle',\n+        'onbeforeunload',\n+        'onbegin',\n+        'onblur',\n+        'onbounce',\n+        'oncanplay',\n+        'oncanplaythrough',\n+        'onchange',\n+        'onclick',\n+        'onclose',\n+        'oncontextmenu',\n+        'oncopy',\n+        'oncuechange',\n+        'oncut',\n+        'ondblclick',\n+        'ondrag',\n+        'ondragend',\n+        'ondragenter',\n+        'ondragexit',\n+        'ondragleave',\n+        'ondragover',\n+        'ondragstart',\n+        'ondrop',\n+        'ondurationchange',\n+        'onend',\n+        'onended',\n+        'onerror',\n+        'onfinish',\n+        'onfocus',\n+        'onfocusin',\n+        'onfocusout',\n+        'onformdata',\n+        'onfullscreenchange',\n+        'onhashchange',\n+        'oninput',\n+        'oninvalid',\n+        'onkeydown',\n+        'onkeypress',\n+        'onkeyup',\n+        'onload',\n+        'onloadeddata',\n+        'onloadedmetadata',\n+        'onloadstart',\n+        'onmessage',\n+        'onmousedown',\n+        'onmouseenter',\n+        'onmouseleave',\n+        'onmousemove',\n+        'onmouseout',\n+        'onmouseover',\n+        'onmouseup',\n+        'onmousewheel',\n+        'onmozfullscreenchange',\n+        'onpagehide',\n+        'onpageshow',\n+        'onpaste',\n+        'onpause',\n+        'onplay',\n+        'onplaying',\n+        'onpointerdown',\n+        'onpointerenter',\n+        'onpointerleave',\n+        'onpointermove',\n+        'onpointerout',\n+        'onpointerover',\n+        'onpointerrawupdate',\n+        'onpointerup',\n+        'onpopstate',\n+        'onprogress',\n+        'onratechange',\n+        'onrepeat',\n+        'onreset',\n+        'onresize',\n+        'onscroll',\n+        'onscrollend',\n+        'onsearch',\n+        'onseeked',\n+        'onseeking',\n+        'onselect',\n+        'onselectionchange',\n+        'onselectstart',\n+        'onshow',\n+        'onstart',\n+        'onsubmit',\n+        'onsuspend',\n+        'ontimeupdate',\n+        'ontoggle',\n+        'ontouchend',\n+        'ontouchmove',\n+        'ontouchstart',\n+        'ontransitioncancel',\n+        'ontransitionend',\n+        'ontransitionrun',\n+        'ontransitionstart',\n+        'onunhandledrejection',\n+        'onunload',\n+        'onvolumechange',\n+        'onwebkitanimationend',\n+        'onwebkitanimationiteration',\n+        'onwebkitanimationstart',\n+        'onwebkittransitionend',\n+        'onwheel',\n+    ];\n+\n+\n+    public static function getNotAllowedAttributes()\n+    {\n+        return array_merge(self::MW_NOT_ALLOWED_ATTRIBUTES,\n+            self::ADDITIONAL_NOT_ALLOWED_ATTRIBUTES);\n+\n+    }\n \n }"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d4e8c4a13967ac9856c3e1179d4185e59b8d9311",
            "date": "2024-11-26T15:08:46Z",
            "author_login": "peter-mw"
          },
          {
            "sha": "9a701a997a4041f040b00d989b19e446c34419e5",
            "date": "2024-06-26T12:33:18Z",
            "author_login": "Radanovn"
          },
          {
            "sha": "5851e060318fb8065a478df6b63b335b1d3a52c2",
            "date": "2024-06-26T11:34:21Z",
            "author_login": "Radanovn"
          },
          {
            "sha": "7c37d77e617d35cdefdcaf96c7a18a33a9758289",
            "date": "2024-06-26T11:14:53Z",
            "author_login": "Radanovn"
          },
          {
            "sha": "eff6fadcadd749e8f4295bec99bf173d2401f3ac",
            "date": "2024-06-26T11:11:53Z",
            "author_login": "Radanovn"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A Reflected Cross-site scripting (XSS) vulnerability exists in '/search' in microweber 2.0.15 and earlier allowing unauthenticated remote attackers to inject arbitrary web script or HTML via the 'keywords' parameter.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-06T14:16:04.117",
    "last_modified": "2024-11-21T09:30:56.960",
    "fix_date": "2024-06-24T12:11:56Z"
  },
  "references": [
    {
      "url": "http://microweber.com",
      "source": "cve@mitre.org",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/microweber/microweber/commit/0dede6886c6df3d1f31c4f4e3ba1ab4a336fbf79",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://seclists.org/fulldisclosure/2024/Aug/1",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2024/Aug/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.536856",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "microweber",
    "owner": "microweber",
    "created_at": "2010-10-07T09:04:43Z",
    "updated_at": "2025-01-13T15:04:29Z",
    "pushed_at": "2025-01-14T13:26:48Z",
    "size": 1026007,
    "stars": 3170,
    "forks": 887,
    "open_issues": 360,
    "watchers": 3170,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "HTML": 12566636,
      "PHP": 11976208,
      "JavaScript": 8696748,
      "CSS": 3597687,
      "SCSS": 2178754,
      "Blade": 1663671,
      "Less": 518400,
      "Hack": 476030,
      "MDX": 387317,
      "Vue": 344860,
      "Ruby": 12504,
      "OCaml": 4815,
      "Dockerfile": 1548,
      "CoffeeScript": 950,
      "Batchfile": 61,
      "Shell": 59,
      "Sass": 1
    },
    "commit_activity": {
      "total_commits_last_year": 1332,
      "avg_commits_per_week": 25.615384615384617,
      "days_active_last_year": 106
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:59:40.368111"
  }
}