{
  "cve_id": "CVE-2024-40630",
  "github_data": {
    "repository": "AcademySoftwareFoundation/OpenImageIO",
    "fix_commit": "0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3",
    "related_commits": [
      "0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3",
      "0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3"
    ],
    "patch_url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/commit/0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3.patch",
    "fix_commit_details": {
      "sha": "0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3",
      "commit_date": "2024-07-15T13:02:58Z",
      "author": {
        "login": "flyyee",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix(heic): Correctly set imagespec size for heif images",
        "length": 126,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "src/heif.imageio/heifinput.cpp",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -247,8 +247,9 @@ HeifInput::seek_subimage(int subimage, int miplevel)\n #endif\n \n     int bits = m_himage.get_bits_per_pixel(heif_channel_interleaved);\n-    m_spec = ImageSpec(m_ihandle.get_width(), m_ihandle.get_height(), bits / 8,\n-                       TypeUInt8);\n+    m_spec   = ImageSpec(m_himage.get_width(heif_channel_interleaved),\n+                         m_himage.get_height(heif_channel_interleaved), bits / 8,\n+                         TypeUInt8);\n \n     m_spec.attribute(\"oiio:ColorSpace\", \"sRGB\");\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3baab41354e9bed9e19e7da8b16faf4670243ad4",
            "date": "2025-01-14T00:09:18Z",
            "author_login": "lgritz"
          },
          {
            "sha": "d50caee5fb0fd8e2276303ce470a1b884bdbc4ee",
            "date": "2025-01-08T17:26:14Z",
            "author_login": "lgritz"
          },
          {
            "sha": "0ae1f07c8867228ace07eabcc2eb0ea0fbce2660",
            "date": "2025-01-08T16:48:46Z",
            "author_login": "lgritz"
          },
          {
            "sha": "424e396658e7720904533de27571acb49f75adf9",
            "date": "2025-01-08T16:43:35Z",
            "author_login": "lgritz"
          },
          {
            "sha": "85ece697e88fb6a32a740fc8aadddb1259fdc55c",
            "date": "2025-01-07T19:17:51Z",
            "author_login": "lgritz"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-125",
    "description": "OpenImageIO is a toolset for reading, writing, and manipulating image files of any image file format relevant to VFX / animation via a format-agnostic API with a feature set, scalability, and robustness needed for feature film production. In affected versions there is a bug in the heif input functionality of OpenImageIO. Specifically, in `HeifInput::seek_subimage()`.  In the worst case, this can lead to an information disclosure vulnerability, particularly for programs that directly use the `ImageInput` APIs. This bug has been addressed in commit `0a2dcb4c` which is included in the 2.5.13.1 release. Users are advised to upgrade. There are no known workarounds for this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-15T20:15:05.243",
    "last_modified": "2024-11-21T09:31:23.757",
    "fix_date": "2024-07-15T13:02:58Z"
  },
  "references": [
    {
      "url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/blob/7c486a1121a4bf71d50ff555fab2770294b748d7/src/heif.imageio/heifinput.cpp#L250",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/commit/0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/security/advisories/GHSA-jjm9-9m4m-c8p2",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/blob/7c486a1121a4bf71d50ff555fab2770294b748d7/src/heif.imageio/heifinput.cpp#L250",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/commit/0a2dcb4cf2c3fd4825a146cd3ad929d9d8305ce3",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/AcademySoftwareFoundation/OpenImageIO/security/advisories/GHSA-jjm9-9m4m-c8p2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.485052",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "OpenImageIO",
    "owner": "AcademySoftwareFoundation",
    "created_at": "2011-02-02T23:03:28Z",
    "updated_at": "2025-01-14T09:19:00Z",
    "pushed_at": "2025-01-14T06:55:11Z",
    "size": 188904,
    "stars": 2012,
    "forks": 608,
    "open_issues": 145,
    "watchers": 2012,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "analysis",
      "dev-2.2",
      "dev-2.4",
      "dev-2.5",
      "dev-2.5.0",
      "dev-2.6.1",
      "dev-3.0",
      "lg-sonaronly",
      "main",
      "release",
      "rtd",
      "sonar-1"
    ],
    "languages": {
      "C++": 7186916,
      "Pawn": 5056106,
      "Python": 360199,
      "CMake": 273020,
      "C": 131729,
      "Shell": 65535,
      "Makefile": 16150
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:35:34.205940"
  }
}