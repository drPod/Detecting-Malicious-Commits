{
  "cve_id": "CVE-2024-40645",
  "github_data": {
    "repository": "FOGProject/fogproject",
    "fix_commit": "9469606a18bf8887740cceed6593a2e0380b5e0c",
    "related_commits": [
      "9469606a18bf8887740cceed6593a2e0380b5e0c"
    ],
    "patch_url": "https://github.com/FOGProject/fogproject/commit/9469606a18bf8887740cceed6593a2e0380b5e0c.patch",
    "fix_commit_details": {
      "sha": "9469606a18bf8887740cceed6593a2e0380b5e0c",
      "commit_date": "2024-07-12T11:35:40Z",
      "author": {
        "login": "mastacontrola",
        "type": "User",
        "stats": {
          "total_commits": 12127,
          "average_weekly_commits": 21.57829181494662,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 259
        }
      },
      "commit_message": {
        "title": "Should address isseu of GHSA-59mq-q8g5-2f4f in dev-branch",
        "length": 57,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 13,
        "additions": 12,
        "deletions": 1
      },
      "files": [
        {
          "filename": "packages/web/lib/fog/system.class.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -53,7 +53,7 @@ private static function _versionCompare()\n     public function __construct()\n     {\n         self::_versionCompare();\n-        define('FOG_VERSION', '1.5.10.34');\n+        define('FOG_VERSION', '1.5.10.35');\n         define('FOG_SCHEMA', 270);\n         define('FOG_BCACHE_VER', 140);\n         define('FOG_CLIENT_VERSION', '0.13.0');"
        },
        {
          "filename": "packages/web/lib/pages/fogconfigurationpage.class.php",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -3056,6 +3056,17 @@ public function settingsPost()\n                         $type,\n                         $attr\n                     ) = getimagesize($src);\n+                    $validExtensions = [\n+                        'jpg',\n+                        'jpeg',\n+                        'png',\n+                    ];\n+                    $extensionCheck = strtolower(pathinfo($src, PATHINFO_EXTENSION));\n+                    if (!in_array($extensionCheck, $validExtension)) {\n+                        throw new Exception(\n+                            _('File extension must be, jpg, jpeg, or png')\n+                        );\n+                    }\n                     if ($width != 650) {\n                         throw new Exception(\n                             _('Width must be 650 pixels.')"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "831a95f32ec4b1d7659729ce30c5e3f2f355f2b8",
            "date": "2024-11-15T14:41:07Z",
            "author_login": "fog-workflows[bot]"
          },
          {
            "sha": "32a04775b310ada76ea97a914526fb35547fc18b",
            "date": "2024-10-22T11:40:47Z",
            "author_login": "mastacontrola"
          },
          {
            "sha": "76caf12a900fab1e8061d77613d4a77a9c1ed023",
            "date": "2024-10-22T10:57:05Z",
            "author_login": "mastacontrola"
          },
          {
            "sha": "a7b2035d700afc8c349a744c70d4963132826e35",
            "date": "2024-10-22T10:55:13Z",
            "author_login": "mastacontrola"
          },
          {
            "sha": "c36a4c041e6310222bd9623755e699d10724304a",
            "date": "2024-10-22T10:28:27Z",
            "author_login": "geotsot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-434",
    "description": "FOG is a cloning/imaging/rescue suite/inventory management system. An improperly restricted file upload feature allows authenticated users to execute arbitrary code on the fogproject server. The Rebranding feature has a check on the client banner image requiring it to be 650 pixels wide and 120 pixels high. Apart from that, there are no checks on things like file extensions. This can be abused by appending a PHP webshell to the end of the image and changing the extension to anything the PHP web server will parse. This vulnerability is fixed in 1.5.10.41.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-31T19:15:11.870",
    "last_modified": "2024-09-05T17:09:16.947",
    "fix_date": "2024-07-12T11:35:40Z"
  },
  "references": [
    {
      "url": "https://github.com/FOGProject/fogproject/blob/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages/fogconfigurationpage.class.php#L2860-L2896",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/FOGProject/fogproject/commit/9469606a18bf8887740cceed6593a2e0380b5e0c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/FOGProject/fogproject/security/advisories/GHSA-59mq-q8g5-2f4f",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.514637",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fogproject",
    "owner": "FOGProject",
    "created_at": "2014-04-15T18:28:09Z",
    "updated_at": "2025-01-14T07:48:33Z",
    "pushed_at": "2025-01-14T15:53:37Z",
    "size": 4511697,
    "stars": 1173,
    "forks": 228,
    "open_issues": 45,
    "watchers": 1173,
    "has_security_policy": false,
    "default_branch": "stable",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 3144776,
      "JavaScript": 610298,
      "Shell": 240502,
      "Makefile": 90209,
      "SCSS": 79489,
      "Less": 78481,
      "CSS": 45725,
      "C": 18292,
      "HTML": 2693,
      "Awk": 375
    },
    "commit_activity": {
      "total_commits_last_year": 211,
      "avg_commits_per_week": 4.0576923076923075,
      "days_active_last_year": 48
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:56:02.607425"
  }
}