{
  "cve_id": "CVE-2024-41128",
  "github_data": {
    "repository": "rails/rails",
    "fix_commit": "27121e80f6dbb260f5a9f0452cd8411cb681f075",
    "related_commits": [
      "27121e80f6dbb260f5a9f0452cd8411cb681f075",
      "b0fe99fa854ec8ff4498e75779b458392d1560ef",
      "b1241f468d1b32235f438c2e2203386e6efd3891",
      "fb493bebae1a9b83e494fe7edbf01f6167d606fd"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "27121e80f6dbb260f5a9f0452cd8411cb681f075",
      "commit_date": "2024-10-11T03:41:33Z",
      "author": {
        "login": "jhawthorn",
        "type": "User",
        "stats": {
          "total_commits": 559,
          "average_weekly_commits": 0.530360531309298,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 174
        }
      },
      "commit_message": {
        "title": "Avoid backtracking in filtered_query_string",
        "length": 88,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 24,
        "additions": 18,
        "deletions": 6
      },
      "files": [
        {
          "filename": "actionpack/lib/action_dispatch/http/filter_parameters.rb",
          "status": "modified",
          "additions": 9,
          "deletions": 4,
          "patch": "@@ -68,12 +68,17 @@ def parameter_filter_for(filters) # :doc:\n         ActiveSupport::ParameterFilter.new(filters)\n       end\n \n-      KV_RE   = \"[^&;=]+\"\n-      PAIR_RE = %r{(#{KV_RE})=(#{KV_RE})}\n       def filtered_query_string # :doc:\n-        query_string.gsub(PAIR_RE) do |_|\n-          parameter_filter.filter($1 => $2).first.join(\"=\")\n+        parts = query_string.split(/([&;])/)\n+        filtered_parts = parts.map do |part|\n+          if part.include?(\"=\")\n+            key, value = part.split(\"=\", 2)\n+            parameter_filter.filter(key => value).first.join(\"=\")\n+          else\n+            part\n+          end\n         end\n+        filtered_parts.join(\"\")\n       end\n     end\n   end"
        },
        {
          "filename": "actionpack/lib/action_dispatch/http/filter_redirect.rb",
          "status": "modified",
          "additions": 9,
          "deletions": 2,
          "patch": "@@ -37,9 +37,16 @@ def location_filter_match?\n       def parameter_filtered_location\n         uri = URI.parse(location)\n         unless uri.query.nil? || uri.query.empty?\n-          uri.query.gsub!(FilterParameters::PAIR_RE) do\n-            request.parameter_filter.filter($1 => $2).first.join(\"=\")\n+          parts = uri.query.split(/([&;])/)\n+          filtered_parts = parts.map do |part|\n+            if part.include?(\"=\")\n+              key, value = part.split(\"=\", 2)\n+              request.parameter_filter.filter(key => value).first.join(\"=\")\n+            else\n+              part\n+            end\n           end\n+          uri.query = filtered_parts.join(\"\")\n         end\n         uri.to_s\n       rescue URI::Error"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f1e610ec20532a1fdce6d3ce94d8d610bca48d89",
            "date": "2025-01-25T13:40:22Z",
            "author_login": "byroot"
          },
          {
            "sha": "7629dd1a5353ca1ad01dd1e4f2e0a301ba7ba4a6",
            "date": "2025-01-25T09:05:19Z",
            "author_login": "joshuay03"
          },
          {
            "sha": "2ca006fb7fe881c225c000d9ab11e2a3554b70fa",
            "date": "2025-01-24T21:19:22Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "cd171d69fa03e0a09133089eca672831d447d02a",
            "date": "2025-01-24T20:48:43Z",
            "author_login": "rafaelfranca"
          },
          {
            "sha": "dc522a3e6933e014c691e06c5d866d6351d6640d",
            "date": "2025-01-24T15:03:22Z",
            "author_login": "Edouard-chin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-770",
    "description": "Action Pack is a framework for handling and responding to web requests. Starting in version 3.1.0 and prior to versions 6.1.7.9, 7.0.8.5, 7.1.4.1, and 7.2.1.1, there is a possible ReDoS vulnerability in the query parameter filtering routines of Action Dispatch. Carefully crafted query parameters can cause query parameter filtering to take an unexpected amount of time, possibly resulting in a DoS vulnerability. All users running an affected release should either upgrade to version 6.1.7.9, 7.0.8.5, 7.1.4.1, or 7.2.1.1 or apply the relevant patch immediately. One may use Ruby 3.2 as a workaround. Ruby 3.2 has mitigations for this problem, so Rails applications using Ruby 3.2 or newer are unaffected. Rails 8.0.0.beta1 depends on Ruby 3.2 or greater so is unaffected.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-10-16T18:15:06.070",
    "last_modified": "2024-10-18T12:53:04.627",
    "fix_date": "2024-10-11T03:41:33Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/security/cve/cve-2024-41128",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2319036",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails/commit/27121e80f6dbb260f5a9f0452cd8411cb681f075",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails/commit/b0fe99fa854ec8ff4498e75779b458392d1560ef",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails/commit/b1241f468d1b32235f438c2e2203386e6efd3891",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails/commit/fb493bebae1a9b83e494fe7edbf01f6167d606fd",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/rails/rails/security/advisories/GHSA-x76w-6vjr-8xgj",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.156075",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "rails",
    "owner": "rails",
    "created_at": "2008-04-11T02:19:47Z",
    "updated_at": "2025-01-26T05:34:47Z",
    "pushed_at": "2025-01-25T13:40:23Z",
    "size": 261808,
    "stars": 56353,
    "forks": 21756,
    "open_issues": 1262,
    "watchers": 56353,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "0-5-stable",
      "0-6-stable",
      "0-7-stable",
      "0-8-stable",
      "1-2-stable",
      "2-0-stable",
      "2-1-stable",
      "2-2-stable",
      "2-3-stable",
      "3-0-stable",
      "3-1-stable",
      "3-2-stable",
      "4-0-stable",
      "4-1-stable",
      "4-2-stable",
      "5-0-stable",
      "5-1-stable",
      "5-2-stable",
      "6-0-stable",
      "6-1-stable",
      "7-0-stable",
      "7-1-stable",
      "7-2-stable"
    ],
    "languages": {
      "Ruby": 17142031,
      "JavaScript": 228210,
      "HTML": 196993,
      "SCSS": 50596,
      "CSS": 47127,
      "Dockerfile": 2019,
      "Shell": 708
    },
    "commit_activity": {
      "total_commits_last_year": 3977,
      "avg_commits_per_week": 76.48076923076923,
      "days_active_last_year": 350
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T07:40:39.021267"
  }
}