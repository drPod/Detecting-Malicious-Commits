{
  "cve_id": "CVE-2024-41617",
  "github_data": {
    "repository": "moneymanagerex/web-money-manager-ex",
    "fix_commit": "f2850b295ee21bc299799343a3bc4d004d05651d",
    "related_commits": [
      "f2850b295ee21bc299799343a3bc4d004d05651d"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "f2850b295ee21bc299799343a3bc4d004d05651d",
      "commit_date": "2024-08-18T19:16:50Z",
      "author": {
        "login": "jp-wagner",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fix security issues",
        "length": 19,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 15,
        "deletions": 12
      },
      "files": [
        {
          "filename": "WebApp/functions_database.php",
          "status": "modified",
          "additions": 14,
          "deletions": 12,
          "patch": "@@ -188,21 +188,23 @@ public static function transaction_delete_all ()\n \n \n     //Delete group transaction\n-    public static function transaction_delete_group ($TrDeleteArr)\n-        {\n-            $const_dbpath = costant::database_path();\n-            $N = count($TrDeleteArr);\n-            $SQLDelete = \"\";\n-            for($i=0; $i < $N; $i++)\n-                {$SQLDelete = $SQLDelete.$TrDeleteArr[$i] . \",\";}\n-            $SQLDelete = rtrim($SQLDelete, \",\");\n+    public static function transaction_delete_group($TrDeleteArr)\n+\t{\n+\t    $const_dbpath = costant::database_path();\n+\t    $N = count($TrDeleteArr);\n \n-            $db = new PDO(\"sqlite:${const_dbpath}\");\n-            $db->exec   (\"DELETE FROM New_Transaction WHERE ID IN (${SQLDelete});\");\n+\t    // Create placeholders for each element in $TrDeleteArr\n+\t    $placeholders = rtrim(str_repeat('?,', $N), ',');\n \n-            $db = null;\n-        }\n+\t    // Prepare the SQL statement\n+\t    $db = new PDO(\"sqlite:${const_dbpath}\");\n+\t    $stmt = $db->prepare(\"DELETE FROM New_Transaction WHERE ID IN (${placeholders})\");\n+\n+\t    // Execute the statement with the array of IDs\n+\t    $stmt->execute($TrDeleteArr);\n \n+\t    $db = null;\n+\t}\n \n     // Update transaction\n     public static function transaction_update ($TrEditedId,$TrDate,$TrStatus,$TrType,$TrAccount,$TrToAccount,$TrPayee,$TrCategory,$TrSubCategory,$TrAmount,$TrNotes)"
        },
        {
          "filename": "WebApp/functions_security.php",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -24,6 +24,7 @@ public static function redirect_if_not_loggedin ()\n                 elseif ($_SERVER['PHP_SELF'] != \"/index.php\")\n                 {\n                     header(\"Location: index.php\");\n+\t\t    exit();\n                 }\n             }\n         }"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "7118ba175d6f8f4fad66703325574981161c93c5",
            "date": "2024-10-23T15:50:14Z",
            "author_login": "whalley"
          },
          {
            "sha": "14879ecb54f2147bcee1dd7e2814992e39f1c0a7",
            "date": "2024-10-23T15:49:19Z",
            "author_login": "whalley"
          },
          {
            "sha": "d9e9947b1980949cb6888194a2b9aaf9346ab3c3",
            "date": "2024-08-19T01:30:49Z",
            "author_login": "guanlisheng"
          },
          {
            "sha": "f2850b295ee21bc299799343a3bc4d004d05651d",
            "date": "2024-08-18T19:16:50Z",
            "author_login": "jp-wagner"
          },
          {
            "sha": "0d73f2019346c482b9851468839655f5d0d593cb",
            "date": "2024-08-16T23:43:29Z",
            "author_login": "guanlisheng"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-863",
    "description": "Money Manager EX WebApp (web-money-manager-ex) 1.2.2 is vulnerable to Incorrect Access Control. The `redirect_if_not_loggedin` function in `functions_security.php` fails to terminate script execution after redirecting unauthenticated users. This flaw allows an unauthenticated attacker to upload arbitrary files, potentially leading to Remote Code Execution.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-24T22:15:03.687",
    "last_modified": "2024-10-29T17:35:07.133",
    "fix_date": "2024-08-18T19:16:50Z"
  },
  "references": [
    {
      "url": "https://github.com/moneymanagerex/web-money-manager-ex/commit/f2850b295ee21bc299799343a3bc4d004d05651d",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/moneymanagerex/web-money-manager-ex/issues/51",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/moneymanagerex/web-money-manager-ex/releases/tag/v1.2.3",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://youtu.be/JaOrlT9G3yo?t=88",
      "source": "cve@mitre.org",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:27.084625",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "web-money-manager-ex",
    "owner": "moneymanagerex",
    "created_at": "2014-07-15T02:15:29Z",
    "updated_at": "2024-12-16T07:25:31Z",
    "pushed_at": "2024-10-23T15:51:15Z",
    "size": 644,
    "stars": 76,
    "forks": 46,
    "open_issues": 15,
    "watchers": 76,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 115998,
      "JavaScript": 14155,
      "CSS": 12035,
      "Dockerfile": 67,
      "Hack": 20
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-26T08:13:30.793220"
  }
}