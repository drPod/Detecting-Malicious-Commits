{
  "cve_id": "CVE-2024-41809",
  "github_data": {
    "repository": "openobserve/openobserve",
    "fix_commit": "2334377ebc8b74beb06ab3e5712dbdb1be1eff02",
    "related_commits": [
      "2334377ebc8b74beb06ab3e5712dbdb1be1eff02",
      "64587261968217dfb8af4c4f6054d58bbc6d331d",
      "2334377ebc8b74beb06ab3e5712dbdb1be1eff02",
      "64587261968217dfb8af4c4f6054d58bbc6d331d"
    ],
    "patch_url": "https://github.com/openobserve/openobserve/commit/2334377ebc8b74beb06ab3e5712dbdb1be1eff02.patch",
    "fix_commit_details": {
      "sha": "2334377ebc8b74beb06ab3e5712dbdb1be1eff02",
      "commit_date": "2023-05-16T06:00:00Z",
      "author": {
        "login": "bjp232004",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: Multi tenancy (#727)",
        "length": 25,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 769,
        "additions": 603,
        "deletions": 166
      },
      "files": [
        {
          "filename": "web/src/aws-exports.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -37,6 +37,8 @@ const config = {\n   isZincObserveCloud: import.meta.env.VITE_ZINCOBSERVE_CLOUD\n     ? import.meta.env.VITE_ZINCOBSERVE_CLOUD\n     : \"false\",\n+  freePlan: \"Free-Plan-USD-Monthly\",\n+  paidPlan: \"professional-USD-Monthly\",\n };\n \n export default config;"
        },
        {
          "filename": "web/src/components/PendingSubscriptionWarning.vue",
          "status": "added",
          "additions": 53,
          "deletions": 0,
          "patch": "@@ -0,0 +1,53 @@\n+<!-- Copyright 2022 Zinc Labs Inc. and Contributors\n+\n+ Licensed under the Apache License, Version 2.0 (the \"License\");\n+ you may not use this file except in compliance with the License.\n+ You may obtain a copy of the License at\n+\n+     http:www.apache.org/licenses/LICENSE-2.0\n+\n+ Unless required by applicable law or agreed to in writing, software\n+ distributed under the License is distributed on an \"AS IS\" BASIS,\n+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ See the License for the specific language governing permissions and\n+ limitations under the License. \n+-->\n+\n+<template>\n+  <div class=\"row col-11 justify-center q-mt-xl\">\n+    <q-icon\n+      name=\"warning\"\n+      size=\"80px\"\n+      color=\"warning row col-8 justify-center q-mt-lg\"\n+    /><br />\n+    <h5>\n+      <b\n+        ><u><span class=\"text-red\">Warning:</span></u></b\n+      >\n+      The content of this page cannot be viewed because the selected\n+      organization's is on pending subscription state. <br /><br /><q-btn color=\"primary\" @click=\"routerPush\">Click here to proceed with subscription</q-btn>\n+    </h5>\n+  </div>\n+</template>\n+\n+<script lang=\"ts\">\n+import { useRouter } from \"vue-router\";\n+// @ts-nocheck\n+import { defineComponent } from \"vue\";\n+\n+export default defineComponent({\n+  name: \"PendingSubscriptionWarning\",\n+  setup() {\n+    const router = useRouter();\n+\n+    const routerPush = () => {\n+      router.push({ name: \"plans\" });\n+    };\n+\n+    return {\n+      router,\n+      routerPush,\n+    };\n+  },\n+});\n+</script>"
        },
        {
          "filename": "web/src/composables/shared/router.ts",
          "status": "modified",
          "additions": 43,
          "deletions": 0,
          "patch": "@@ -51,6 +51,7 @@ import {\n } from \"@/components/alerts/index\";\n import ImportDashboard from \"@/views/Dashboards/ImportDashboard.vue\";\n import Functions from \"../../views/Functions.vue\";\n+import { routeGuardPendingSubscriptions } from \"@/utils/zincutils\";\n \n const useRoutes = () => {\n   const parentRoutes: never[] = [];\n@@ -71,6 +72,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"metrics\",\n@@ -79,6 +83,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"traces\",\n@@ -87,6 +94,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"logstreams\",\n@@ -95,6 +105,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"tickets\",\n@@ -103,6 +116,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"about\",\n@@ -119,6 +135,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"/dashboards/view\",\n@@ -128,6 +147,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"/dashboards/import\",\n@@ -137,6 +159,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"/dashboards/add_panel\",\n@@ -146,6 +171,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"users\",\n@@ -154,6 +182,9 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"member_subscription\",\n@@ -162,11 +193,17 @@ const useRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"functions\",\n       name: \"functions\",\n       component: Functions,\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n       children: [\n         {\n           path: \"functions\",\n@@ -184,6 +221,9 @@ const useRoutes = () => {\n       path: \"ingestion\",\n       name: \"ingestion\",\n       component: Ingestion,\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n       children: [\n         {\n           path: \"logs\",\n@@ -262,6 +302,9 @@ const useRoutes = () => {\n       path: \"alerts\",\n       name: \"alerts\",\n       component: Alerts,\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n       children: [\n         {\n           path: \"alerts\","
        },
        {
          "filename": "web/src/enterprise/components/billings/plans.vue",
          "status": "modified",
          "additions": 46,
          "deletions": 12,
          "patch": "@@ -38,13 +38,7 @@\n       </div>\n     </div>\n     <div\n-      class=\"\n-        row\n-        justify-start\n-        text-h6 text-weight-bold\n-        q-pl-xl q-pb-lg\n-        subtitle\n-      \"\n+      class=\"row justify-start text-h6 text-weight-bold q-pl-xl q-pb-lg subtitle\"\n     >\n       {{ t(\"billing.subtitle\") }}\n     </div>\n@@ -63,7 +57,7 @@\n         :hasProPlan=\"isProPlan\"\n         :freeLoading=\"freeLoading\"\n         :proLoading=\"proLoading\"\n-        @update:freeSubscription=\"onUnsubscribe\"\n+        @update:freeSubscription=\"confirm_downgrade_subscription = true\"\n         @update:proSubscription=\"onLoadSubscription\"\n       ></plan-card>\n     </div>\n@@ -76,7 +70,8 @@\n             {{ t(\"billing.manageCards\") }}\n           </div>\n           <q-space />\n-          <q-btn icon=\"close\" flat round dense v-close-popup />\n+          <q-btn icon=\"close\" flat round dense\n+v-close-popup />\n         </q-card-section>\n         <q-card-section>\n           <iframe\n@@ -101,7 +96,8 @@\n             {{ t(\"billing.subscriptionCheckout\") }}\n           </div>\n           <q-space />\n-          <q-btn icon=\"close\" flat round dense v-close-popup />\n+          <q-btn icon=\"close\" flat round dense\n+v-close-popup />\n         </q-card-section>\n \n         <q-card-section>\n@@ -118,12 +114,44 @@\n         </q-card-section>\n       </q-card>\n     </q-dialog>\n+\n+    <q-dialog v-model=\"confirm_downgrade_subscription\" persistent>\n+      <q-card>\n+        <q-card-section class=\"row items-center\">\n+          <span class=\"q-ml-sm\"\n+            ><q-avatar\n+              icon=\"warning\"\n+              size=\"sm\"\n+              color=\"primary\"\n+              text-color=\"white\"\n+              class=\"q-mr-sm\"\n+            />Since you are downgrading the subscription plan, please note that\n+            if you are currently part of an organization that is subscribed to\n+            the free/developer plan, the current organization members, their\n+            tokens and the organization status will be changed to 'Pending\n+            Subscription' state. Are you sure you want to proceed with this\n+            action?</span\n+          >\n+        </q-card-section>\n+\n+        <q-card-actions align=\"right\">\n+          <q-btn label=\"Cancel\" color=\"secondary\"\n+v-close-popup />\n+          <q-btn\n+            label=\"Confirm\"\n+            color=\"primary\"\n+            v-close-popup\n+            @click=\"onUnsubscribe\"\n+          />\n+        </q-card-actions>\n+      </q-card>\n+    </q-dialog>\n     <!-- </div> -->\n   </q-page>\n </template>\n \n <script lang=\"ts\">\n-import { defineComponent, ref } from \"@vue/runtime-core\";\n+import { defineComponent, ref } from \"vue\";\n import { useI18n } from \"vue-i18n\";\n import PlanCard from \"./planCard.vue\";\n import Plan from \"@/constants/plans\";\n@@ -279,6 +307,10 @@ export default defineComponent({\n           this.loading = false;\n           this.freeLoading = false;\n           this.proLoading = false;\n+          this.$router.push({\n+            name: \"plans\",\n+            query: { update_org: Date.now() },\n+          });\n           // if (\n           //   fromPro &&\n           //   !this.isActiveSubscription &&\n@@ -352,12 +384,13 @@ export default defineComponent({\n     const hostedResponse: any = ref();\n     const updatePaymentResponse: any = ref();\n     const subscriptionref = ref();\n-    const listSubscriptionResponse: any = ref();\n+    const listSubscriptionResponse: any = ref({});\n     const Plans = Plan;\n     const changePayment: any = ref(false);\n     const subScribePlan: any = ref(false);\n     const freeLoading: any = ref(false);\n     const proLoading: any = ref(false);\n+    const confirm_downgrade_subscription: any = ref(false);\n \n     const retriveHostedPage = () => {\n       BillingService.retrive_hosted_page(\n@@ -392,6 +425,7 @@ export default defineComponent({\n       subScribePlan,\n       freeLoading,\n       proLoading,\n+      confirm_downgrade_subscription,\n     };\n   },\n   computed: {"
        },
        {
          "filename": "web/src/enterprise/components/organizations/AddUpdateOrganization.vue",
          "status": "modified",
          "additions": 74,
          "deletions": 10,
          "patch": "@@ -82,7 +82,7 @@\n             @click=\"router.replace({ name: 'organizations' })\"\n           />\n           <q-btn\n-            :disable=\"organizationData.name === ''\"\n+            :disable=\"organizationData.name === '' && !proPlanRequired\"\n             :label=\"t('organization.save')\"\n             class=\"q-mb-md text-bold no-border q-ml-md\"\n             color=\"secondary\"\n@@ -92,7 +92,20 @@\n             data-test=\"add-org\"\n           />\n         </div>\n+\n+        <div class=\"flex justify-center q-mt-lg\" v-if=\"proPlanRequired\">\n+          <q-btn\n+            class=\"q-mb-md text-bold no-border q-ml-md\"\n+            :label=\"t('organization.proceed_subscription')\"\n+            text-color=\"light-text\"\n+            padding=\"sm xl\"\n+            color=\"secondary\"\n+            no-caps\n+            @click=\"completeSubscriptionProcess\"\n+          />\n+        </div>\n       </q-form>\n+      asd{{ proPlanRequired }}\n     </q-card-section>\n   </q-card>\n </template>\n@@ -103,6 +116,7 @@ import organizationService from \"@/services/organizations\";\n import { useI18n } from \"vue-i18n\";\n import { useStore } from \"vuex\";\n import { useRouter } from \"vue-router\";\n+import config from \"@/aws-exports\";\n \n const defaultValue = () => {\n   return {\n@@ -121,6 +135,13 @@ export default defineComponent({\n       default: () => defaultValue(),\n     },\n   },\n+  data() {\n+    return {\n+      proPlanRequired: false,\n+      proPlanMsg: \"\",\n+      newOrgIdentifier: \"\",\n+    };\n+  },\n   emits: [\"update:modelValue\", \"updated\", \"finish\"],\n   setup() {\n     const store: any = useStore();\n@@ -153,6 +174,17 @@ export default defineComponent({\n         name: this.modelValue.name,\n       };\n     }\n+\n+    // this.store.state.organizations.forEach((organization: any) => {\n+    //   if (\n+    //     (organization.hasOwnProperty(\"CustomerBillingObj\") &&\n+    //       organization.CustomerBillingObj.subscription_type ==\n+    //         config.freePlan) ||\n+    //     !organization.hasOwnProperty(\"CustomerBillingObj\")\n+    //   ) {\n+    //     this.proPlanRequired = true;\n+    //   }\n+    // });\n   },\n   methods: {\n     onRejected(rejectedEntries: string | any[]) {\n@@ -161,6 +193,13 @@ export default defineComponent({\n         message: `${rejectedEntries.length} file(s) did not pass validation constraints`,\n       });\n     },\n+    completeSubscriptionProcess() {\n+      console.log(this.store.state);\n+      // this.store.state.dispatch(\"setSelectedOrganization\",)\n+      this.router.push(\n+        `/billings/plans?org_identifier=${this.newOrgIdentifier}`\n+      );\n+    },\n     onSubmit() {\n       const dismiss = this.$q.notify({\n         spinner: true,\n@@ -188,15 +227,40 @@ export default defineComponent({\n         callOrganization\n           .then((res: { data: any }) => {\n             const data = res.data;\n-            this.organizationData = {\n-              id: \"\",\n-              name: \"\",\n-            };\n-\n-            this.$emit(\"update:modelValue\", data);\n-            this.$emit(\"updated\");\n-            this.addOrganizationForm.resetValidation();\n-            dismiss();\n+            if (res.data.data.status == \"active\") {\n+              this.organizationData = {\n+                id: \"\",\n+                name: \"\",\n+              };\n+\n+              this.$emit(\"update:modelValue\", data);\n+              this.$emit(\"updated\");\n+              this.addOrganizationForm.resetValidation();\n+              dismiss();\n+            } else {\n+              this.proPlanRequired = true;\n+              this.proPlanMsg = res.data.message;\n+              this.newOrgIdentifier = res.data.identifier;\n+              // this.store.state.dispatch(\"setSelectedOrganization\", {\n+              //   identifier: data.identifier,\n+              //   name: data.name,\n+              //   id: data.id,\n+              //   ingest_threshold: data.ingest_threshold,\n+              //   search_threshold: data.search_threshold,\n+              //   label: data.name,\n+              //   user_email: this.store.state.userInfo.email,\n+              //   subscription_type: \"Free-Plan-USD-Monthly\",\n+              // });\n+              // window.location.href = `/organizations?org_identifier=${data.data.identifier}&action=subscribe`;\n+              this.router.push({\n+                name: \"organizations\",\n+                query: {\n+                  org_identifier: data.data.identifier,\n+                  action: \"subscribe\",\n+                  update_org: Date.now(),\n+                },\n+              })\n+            }\n           })\n           .catch((err: any) => {\n             this.$q.notify({"
        },
        {
          "filename": "web/src/enterprise/components/organizations/Organization.vue",
          "status": "modified",
          "additions": 24,
          "deletions": 2,
          "patch": "@@ -154,6 +154,7 @@ import JoinOrganization from \"./JoinOrganization.vue\";\n import QTablePagination from \"@/components/shared/grid/Pagination.vue\";\n import NoData from \"@/components/shared/grid/NoData.vue\";\n import segment from \"@/services/segment_analytics\";\n+import { convertToTitleCase } from \"@/utils/zincutils\";\n \n export default defineComponent({\n   name: \"PageOrganization\",\n@@ -217,6 +218,20 @@ export default defineComponent({\n         align: \"left\",\n         sortable: true,\n       },\n+      {\n+        name: \"plan_type\",\n+        field: \"plan_type\",\n+        label: t(\"organization.subscription_type\"),\n+        align: \"left\",\n+        sortable: true,\n+      },\n+      {\n+        name: \"status\",\n+        field: \"status\",\n+        label: t(\"organization.status\"),\n+        align: \"left\",\n+        sortable: true,\n+      },\n       {\n         name: \"created\",\n         field: \"created\",\n@@ -334,14 +349,21 @@ export default defineComponent({\n             id: data.id,\n             name: data.name,\n             identifier: data.identifier,\n-            type: data.type,\n+            type: convertToTitleCase(data.type),\n             owner:\n               data.UserObj.first_name != \"\"\n                 ? data.UserObj.first_name\n                 : data.UserObj.email,\n             created: date.formatDate(data.created_at, \"YYYY-MM-DDTHH:mm:ssZ\"),\n-            role: role,\n+            role: convertToTitleCase(role),\n             actions: \"true\",\n+            status: convertToTitleCase(data.status),\n+            plan_type:\n+              data.CustomerBillingObj.subscription_type ==\n+                \"Free-Plan-USD-Monthly\" ||\n+              data.CustomerBillingObj.subscription_type == \"\"\n+                ? \"Developer\"\n+                : \"Pro\",\n           };\n         });\n "
        },
        {
          "filename": "web/src/enterprise/composables/router.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -28,6 +28,7 @@ import Billing from \"@/enterprise/components/billings/Billing.vue\";\n import Plans from \"@/enterprise/components/billings/plans.vue\";\n import InvoiceHistory from \"@/enterprise/components/billings/invoiceHistory.vue\";\n import Usage from \"@/enterprise/components/billings/usage.vue\";\n+import { routeGuardPendingSubscriptions } from \"@/utils/zincutils\";\n \n const useEnvRoutes = () => {\n   const parentRoutes = [\n@@ -63,6 +64,9 @@ const useEnvRoutes = () => {\n       meta: {\n         keepAlive: true,\n       },\n+      beforeEnter(to: any, from: any, next: any) {\n+        routeGuardPendingSubscriptions(to, from, next);\n+      },\n     },\n     {\n       path: \"billings\","
        },
        {
          "filename": "web/src/layouts/MainLayout.vue",
          "status": "modified",
          "additions": 47,
          "deletions": 25,
          "patch": "@@ -37,28 +37,15 @@\n         />\n \n         <q-toolbar-title></q-toolbar-title>\n-        <q-btn\n-          class=\"q-ml-xs no-border\"\n-          size=\"13px\"\n-          no-caps\n-          :label=\"t(`menu.openapi`)\"\n-          @click=\"navigateToOpenAPI(zoBackendUrl)\"\n-        />\n-        <q-btn\n-          class=\"q-ml-xs no-border\"\n-          size=\"13px\"\n-          no-caps\n-          :label=\"t(`menu.docs`)\"\n-          @click=\"navigateToDocs()\"\n-        />\n         <div class=\"headerMenu float-left\" v-if=\"store.state.quotaThresholdMsg\">\n           <div\n             type=\"warning\"\n             icon=\"cloud\"\n             class=\"warning-msg\"\n             style=\"display: inline\"\n           >\n-            <q-icon name=\"warning\" size=\"xs\" class=\"warning\" />{{\n+            <q-icon name=\"warning\" size=\"xs\"\n+class=\"warning\" />{{\n               store.state.quotaThresholdMsg\n             }}\n           </div>\n@@ -74,6 +61,20 @@\n             >Upgrade to PRO Plan</q-btn\n           >\n         </div>\n+        <q-btn\n+          class=\"q-ml-xs no-border\"\n+          size=\"13px\"\n+          no-caps\n+          :label=\"t(`menu.openapi`)\"\n+          @click=\"navigateToOpenAPI(zoBackendUrl)\"\n+        />\n+        <q-btn\n+          class=\"q-ml-xs no-border\"\n+          size=\"13px\"\n+          no-caps\n+          :label=\"t(`menu.docs`)\"\n+          @click=\"navigateToDocs()\"\n+        />\n         <div class=\"languageWrapper\">\n           <q-btn-dropdown\n             unelevated\n@@ -135,7 +136,8 @@\n           >\n             <template #label>\n               <div class=\"row items-center no-wrap\">\n-                <q-avatar size=\"md\" color=\"grey\" text-color=\"white\">\n+                <q-avatar size=\"md\" color=\"grey\"\n+text-color=\"white\">\n                   <img\n                     :src=\"\n                       user.picture\n@@ -158,7 +160,9 @@\n             <q-list>\n               <q-item-label header>{{ t(\"menu.account\") }}</q-item-label>\n \n-              <q-item v-ripple v-close-popup clickable @click=\"signout\">\n+              <q-item v-ripple\n+v-close-popup clickable\n+@click=\"signout\">\n                 <q-item-section avatar>\n                   <q-avatar\n                     size=\"md\"\n@@ -314,7 +318,7 @@ export default defineComponent({\n     const { t } = useI18n();\n     const miniMode = ref(false);\n     const zoBackendUrl = store.state.API_ENDPOINT;\n-    const customOrganization = router.currentRoute.value.query.hasOwnProperty(\n+    let customOrganization = router.currentRoute.value.query.hasOwnProperty(\n       \"org_identifier\"\n     )\n       ? router.currentRoute.value.query.org_identifier\n@@ -505,6 +509,9 @@ export default defineComponent({\n     };\n \n     const setSelectedOrganization = () => {\n+      customOrganization = router.currentRoute.value.query.hasOwnProperty(\"org_identifier\")\n+        ? router.currentRoute.value.query.org_identifier\n+        : \"\";\n       if (store.state.organizations.length > 0) {\n         const localOrg: any = useLocalOrganization();\n         orgOptions.value = store.state.organizations.map(\n@@ -517,6 +524,7 @@ export default defineComponent({\n             ingest_threshold: number;\n             search_threshold: number;\n             CustomerBillingObj: { subscription_type: string };\n+            status: string;\n           }) => {\n             const optiondata: any = {\n               label: data.name,\n@@ -528,16 +536,18 @@ export default defineComponent({\n               subscription_type: data.hasOwnProperty(\"CustomerBillingObj\")\n                 ? data.CustomerBillingObj.subscription_type\n                 : \"\",\n+              status: data.status,\n             };\n \n             if (\n               config.isZincObserveCloud == \"true\" &&\n               localOrg.value.identifier == data.identifier &&\n               (customOrganization == \"\" || customOrganization == undefined)\n             ) {\n-              localOrg.value.subscription_type =\n-                data.CustomerBillingObj.subscription_type;\n-              useLocalOrganization(localOrg.value);\n+              // localOrg.value.subscription_type =\n+              //   data.CustomerBillingObj.subscription_type;\n+              // useLocalOrganization(localOrg.value);\n+              useLocalOrganization(optiondata);\n             }\n \n             if (\n@@ -550,18 +560,24 @@ export default defineComponent({\n                 (customOrganization == \"\" || customOrganization == undefined))\n             ) {\n               selectedOrg.value = localOrg.value ? localOrg.value : optiondata;\n-              useLocalOrganization(selectedOrg.value);\n-              store.dispatch(\"setSelectedOrganization\", selectedOrg.value);\n+              useLocalOrganization(optiondata);\n+              store.dispatch(\"setSelectedOrganization\", optiondata);\n             } else if (data.identifier == customOrganization) {\n               selectedOrg.value = optiondata;\n-              useLocalOrganization(selectedOrg.value);\n-              store.dispatch(\"setSelectedOrganization\", selectedOrg.value);\n+              useLocalOrganization(optiondata);\n+              store.dispatch(\"setSelectedOrganization\", optiondata);\n             }\n             return optiondata;\n           }\n         );\n       }\n \n+      if (router.currentRoute.value.query.action == \"subscribe\") {\n+        router.push({\n+          name: \"plans\",\n+        });\n+      }\n+\n       if (\n         selectedOrg.value.identifier != \"\" &&\n         config.isZincObserveCloud == \"true\"\n@@ -636,8 +652,14 @@ export default defineComponent({\n     changeOrganization() {\n       return this.store.state.organizations;\n     },\n+    forceFetchOrganization() {\n+      return this.router.currentRoute.value.query.update_org;\n+    },\n   },\n   watch: {\n+    forceFetchOrganization() {\n+      mainLayoutMixin.setup().getDefaultOrganization(this.store);\n+    },\n     changeOrganization() {\n       setTimeout(() => {\n         this.setSelectedOrganization();"
        },
        {
          "filename": "web/src/locales/languages/en.json",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -161,7 +161,9 @@\n     \"copyapikey\": \"Copy API Key\",\n     \"getapikey\": \"Get API Key\",\n     \"role\": \"Role\",\n-    \"nameRequired\": \"Name is required\"\n+    \"nameRequired\": \"Name is required\",\n+    \"subscription_type\": \"Plan Type\",\n+    \"proceed_subscription\": \"Proceed to Subscription\"\n   },\n   \"template\": {\n     \"header\": \"Templates\","
        },
        {
          "filename": "web/src/services/organizations.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -52,8 +52,10 @@ const organizations = {\n   add_members: (data: any, orgIdentifier: string) => {\n     return http().post(`api/${orgIdentifier}/organizations/members`, data);\n   },\n-  process_subscription: (s: string) => {\n-    return http().get(`api/organizations/member_subscription/${s}`);\n+  process_subscription: (s: string, action: string) => {\n+    return http().get(\n+      `api/organizations/member_subscription/${s}?action=${action}`\n+    );\n   },\n   get_associated_members: (orgIdentifier: string) => {\n     return http().get(`api/${orgIdentifier}/organizations/associated_members`);"
        },
        {
          "filename": "web/src/utils/zincutils.ts",
          "status": "modified",
          "additions": 41,
          "deletions": 0,
          "patch": "@@ -14,6 +14,7 @@\n \n import config from \"../aws-exports\";\n import { ref, onMounted, onUnmounted } from \"vue\";\n+import { Dialog } from \"quasar\";\n \n const useLocalStorage = (\n   key: string,\n@@ -262,3 +263,43 @@ export const getPath = () => {\n   const cloudPath = import.meta.env.BASE_URL;\n   return config.isZincObserveCloud == \"true\" ? cloudPath : path;\n };\n+\n+export const routeGuardPendingSubscriptions = (\n+  to: any,\n+  from: any,\n+  next: any\n+) => {\n+  const local_organization = ref();\n+  local_organization.value = useLocalOrganization();\n+  if (\n+    local_organization.value.value == null ||\n+    config.isZincObserveCloud == \"false\"\n+  ) {\n+    next();\n+  }\n+\n+  if (local_organization.value.value.status == \"pending-subscription\") {\n+    Dialog.create({\n+      title: \"Confirmation\",\n+      message: \"Please subscribe to a paid plan to continue.\",\n+      cancel: true,\n+      persistent: true,\n+    })\n+      .onOk(() => {\n+        const nextURL = getPath() + \"billings/plans\";\n+        next(nextURL);\n+      })\n+      .onCancel(() => {\n+        return false;\n+      });\n+  } else {\n+    next();\n+  }\n+};\n+\n+export const convertToTitleCase = (str: string) => {\n+  return str\n+    .split(\"-\")\n+    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n+    .join(\" \");\n+};"
        },
        {
          "filename": "web/src/views/AppAlerts.vue",
          "status": "modified",
          "additions": 68,
          "deletions": 39,
          "patch": "@@ -11,7 +11,8 @@\n -->\n \n <template>\n-  <q-page data-test=\"alerts-page\" class=\"q-pa-none\" style=\"min-height: inherit\">\n+  <q-page data-test=\"alerts-page\"\n+class=\"q-pa-none\" style=\"min-height: inherit\">\n     <q-splitter\n       v-model=\"splitterModel\"\n       unit=\"px\"\n@@ -80,51 +81,79 @@\n   </q-page>\n </template>\n \n-<script lang=\"ts\" setup>\n-import { ref, onActivated, onBeforeMount } from \"vue\";\n+<script lang=\"ts\">\n+import { defineComponent, ref, onActivated, onBeforeMount } from \"vue\";\n import { useStore } from \"vuex\";\n import { useRouter } from \"vue-router\";\n import { useQuasar } from \"quasar\";\n import { useI18n } from \"vue-i18n\";\n import templateService from \"@/services/alert_templates\";\n import destinationService from \"@/services/alert_destination\";\n-const store = useStore();\n-const { t } = useI18n();\n-const router = useRouter();\n-const activeTab: any = ref(\"destinations\");\n-const templates = ref([]);\n-const destinations = ref([]);\n-const splitterModel = ref(220);\n-onActivated(() => {\n-  redirectRoute();\n-});\n-onBeforeMount(() => {\n-  redirectRoute();\n-});\n-const redirectRoute = () => {\n-  if (router.currentRoute.value.name === \"alerts\") {\n-    router.push({\n-      name: \"alertList\",\n-      query: {\n-        org_identifier: store.state.selectedOrganization.identifier,\n-      },\n+\n+export default defineComponent({\n+  name: \"AppAlerts\",\n+  setup() {\n+    const store = useStore();\n+    const { t } = useI18n();\n+    const router = useRouter();\n+    const activeTab: any = ref(\"destinations\");\n+    const templates = ref([]);\n+    const destinations = ref([]);\n+    const splitterModel = ref(220);\n+\n+    onActivated(() => {\n+      redirectRoute();\n     });\n-  }\n-};\n-const getTemplates = () => {\n-  templateService\n-    .list({\n-      org_identifier: store.state.selectedOrganization.identifier,\n-    })\n-    .then((res) => (templates.value = res.data));\n-};\n-const getDestinations = () => {\n-  destinationService\n-    .list({\n-      org_identifier: store.state.selectedOrganization.identifier,\n-    })\n-    .then((res) => (destinations.value = res.data));\n-};\n+\n+    onBeforeMount(() => {\n+      redirectRoute();\n+    });\n+\n+    const redirectRoute = () => {\n+      if (\n+        router.currentRoute.value.name === \"alerts\" &&\n+        store.state.selectedOrganization.status == \"active\"\n+      ) {\n+        router.push({\n+          name: \"alertList\",\n+          query: {\n+            org_identifier: store.state.selectedOrganization.identifier,\n+          },\n+        });\n+      }\n+    };\n+    const getTemplates = () => {\n+      if (store.state.selectedOrganization.status == \"active\") {\n+        templateService\n+          .list({\n+            org_identifier: store.state.selectedOrganization.identifier,\n+          })\n+          .then((res) => (templates.value = res.data));\n+      }\n+    };\n+    const getDestinations = () => {\n+      if (store.state.selectedOrganization.status == \"active\") {\n+        destinationService\n+          .list({\n+            org_identifier: store.state.selectedOrganization.identifier,\n+          })\n+          .then((res) => (destinations.value = res.data));\n+      }\n+    };\n+\n+    return {\n+      activeTab,\n+      templates,\n+      destinations,\n+      splitterModel,\n+      getTemplates,\n+      getDestinations,\n+      redirectRoute,\n+      t,\n+      store,\n+    };\n+  },\n+});\n </script>\n \n <style scoped lang=\"scss\">"
        },
        {
          "filename": "web/src/views/Functions.vue",
          "status": "modified",
          "additions": 41,
          "deletions": 41,
          "patch": "@@ -65,51 +65,51 @@\n   </q-page>\n </template>\n \n-<script lang=\"ts\" setup>\n-import { ref, onActivated, onBeforeMount } from \"vue\";\n+<script lang=\"ts\">\n+import { defineComponent, ref, onActivated, onBeforeMount } from \"vue\";\n import { useStore } from \"vuex\";\n import { useRouter } from \"vue-router\";\n-import { useQuasar } from \"quasar\";\n import { useI18n } from \"vue-i18n\";\n-import templateService from \"@/services/alert_templates\";\n-import destinationService from \"@/services/alert_destination\";\n-const store = useStore();\n-const { t } = useI18n();\n-const router = useRouter();\n-const activeTab: any = ref(\"functionAssociatedStreams\");\n-const templates = ref([]);\n-const functionAssociatedStreams = ref([]);\n-const splitterModel = ref(220);\n-onActivated(() => {\n-  redirectRoute();\n-});\n-onBeforeMount(() => {\n-  redirectRoute();\n-});\n-const redirectRoute = () => {\n-  if (router.currentRoute.value.name === \"functions\") {\n-    router.push({\n-      name: \"functionList\",\n-      query: {\n-        org_identifier: store.state.selectedOrganization.identifier,\n-      },\n+\n+export default defineComponent({\n+  name: \"AppFunctions\",\n+  setup() {\n+    const store = useStore();\n+    const { t } = useI18n();\n+    const router = useRouter();\n+    const activeTab: any = ref(\"functionAssociatedStreams\");\n+    const templates = ref([]);\n+    const functionAssociatedStreams = ref([]);\n+    const splitterModel = ref(220);\n+    onActivated(() => {\n+      redirectRoute();\n     });\n-  }\n-};\n-const getTemplates = () => {\n-  templateService\n-    .list({\n-      org_identifier: store.state.selectedOrganization.identifier,\n-    })\n-    .then((res) => (templates.value = res.data));\n-};\n-const getDestinations = () => {\n-  destinationService\n-    .list({\n-      org_identifier: store.state.selectedOrganization.identifier,\n-    })\n-    .then((res) => (functionAssociatedStreams.value = res.data));\n-};\n+    onBeforeMount(() => {\n+      redirectRoute();\n+    });\n+    const redirectRoute = () => {\n+      if (router.currentRoute.value.name === \"functions\") {\n+        router.push({\n+          name: \"functionList\",\n+          query: {\n+            org_identifier: store.state.selectedOrganization.identifier,\n+          },\n+        });\n+      }\n+    };\n+\n+    return {\n+      t,\n+      store,\n+      router,\n+      redirectRoute,\n+      splitterModel,\n+      functionAssociatedStreams,\n+      activeTab,\n+      templates,\n+    };\n+  },\n+});\n </script>\n \n <style scoped lang=\"scss\">"
        },
        {
          "filename": "web/src/views/Ingestion.vue",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -173,7 +173,9 @@ export default defineComponent({\n           },\n         });\n       } else {\n-        getOrganizationPasscode();\n+        if (store.state.selectedOrganization.status == \"active\") {\n+          getOrganizationPasscode();\n+        }\n       }\n     });\n "
        },
        {
          "filename": "web/src/views/LogStream.vue",
          "status": "modified",
          "additions": 95,
          "deletions": 23,
          "patch": "@@ -17,51 +17,111 @@\n <!-- eslint-disable vue/attribute-hyphenation -->\n <template>\n   <q-page class=\"q-pa-none\" style=\"min-height: inherit\">\n-    <q-table data-test=\"log-stream-table\" ref=\"qTable\" v-model:selected=\"selected\" :rows=\"logStream\" :columns=\"columns\"\n-      row-key=\"id\" :pagination=\"pagination\" :filter=\"filterQuery\" :filter-method=\"filterData\" style=\"width: 100%\">\n+    <q-table\n+      data-test=\"log-stream-table\"\n+      ref=\"qTable\"\n+      v-model:selected=\"selected\"\n+      :rows=\"logStream\"\n+      :columns=\"columns\"\n+      row-key=\"id\"\n+      :pagination=\"pagination\"\n+      :filter=\"filterQuery\"\n+      :filter-method=\"filterData\"\n+      style=\"width: 100%\"\n+    >\n       <template #no-data>\n         <NoData />\n       </template>\n       <template #header-selection=\"scope\">\n-        <q-checkbox v-model=\"scope.selected\" size=\"sm\" color=\"secondary\" />\n+        <q-checkbox v-model=\"scope.selected\"\n+size=\"sm\" color=\"secondary\" />\n       </template>\n       <template #body-selection=\"scope\">\n-        <q-checkbox v-model=\"scope.selected\" size=\"sm\" color=\"secondary\" />\n+        <q-checkbox v-model=\"scope.selected\"\n+size=\"sm\" color=\"secondary\" />\n       </template>\n       <template #body-cell-actions=\"props\">\n         <q-td :props=\"props\">\n-          <q-btn :icon=\"'img:' + getImageURL('images/common/delete_icon.svg')\" :title=\"t('logStream.delete')\"\n-            class=\"q-ml-xs iconHoverBtn\" padding=\"sm\" unelevated size=\"sm\" round flat\n-            @click=\"confirmDeleteAction(props)\" />\n-          <q-btn :icon=\"'img:' + getImageURL('images/common/list_icon.svg')\" :title=\"t('logStream.schemaHeader')\"\n-            class=\"q-ml-xs iconHoverBtn\" padding=\"sm\" unelevated size=\"sm\" round flat @click=\"listSchema(props)\" />\n+          <q-btn\n+            :icon=\"'img:' + getImageURL('images/common/delete_icon.svg')\"\n+            :title=\"t('logStream.delete')\"\n+            class=\"q-ml-xs iconHoverBtn\"\n+            padding=\"sm\"\n+            unelevated\n+            size=\"sm\"\n+            round\n+            flat\n+            @click=\"confirmDeleteAction(props)\"\n+          />\n+          <q-btn\n+            :icon=\"'img:' + getImageURL('images/common/list_icon.svg')\"\n+            :title=\"t('logStream.schemaHeader')\"\n+            class=\"q-ml-xs iconHoverBtn\"\n+            padding=\"sm\"\n+            unelevated\n+            size=\"sm\"\n+            round\n+            flat\n+            @click=\"listSchema(props)\"\n+          />\n         </q-td>\n       </template>\n \n       <template #top=\"scope\">\n         <div class=\"q-table__title\" data-test=\"log-stream-title-text\">\n           {{ t(\"logStream.header\") }}\n         </div>\n-        <q-input v-model=\"filterQuery\" borderless filled dense class=\"q-ml-auto q-mb-xs no-border\"\n-          :placeholder=\"t('logStream.search')\">\n+        <q-input\n+          v-model=\"filterQuery\"\n+          borderless\n+          filled\n+          dense\n+          class=\"q-ml-auto q-mb-xs no-border\"\n+          :placeholder=\"t('logStream.search')\"\n+        >\n           <template #prepend>\n             <q-icon name=\"search\" />\n           </template>\n         </q-input>\n-        <q-btn data-test=\"log-stream-refresh-stats-btn\" class=\"q-ml-md q-mb-xs text-bold no-border\" padding=\"sm lg\"\n-          color=\"secondary\" no-caps icon=\"refresh\" :label=\"t(`logStream.refreshStats`)\" @click=\"getLogStream\" />\n-\n-        <QTablePagination data-test=\"log-stream-table-pagination\" :scope=\"scope\" :pageTitle=\"t('logStream.header')\"\n-          :resultTotal=\"resultTotal\" :perPageOptions=\"perPageOptions\" position=\"top\"\n-          @update:changeRecordPerPage=\"changePagination\" />\n+        <q-btn\n+          data-test=\"log-stream-refresh-stats-btn\"\n+          class=\"q-ml-md q-mb-xs text-bold no-border\"\n+          padding=\"sm lg\"\n+          color=\"secondary\"\n+          no-caps\n+          icon=\"refresh\"\n+          :label=\"t(`logStream.refreshStats`)\"\n+          @click=\"getLogStream\"\n+        />\n+\n+        <QTablePagination\n+          data-test=\"log-stream-table-pagination\"\n+          :scope=\"scope\"\n+          :pageTitle=\"t('logStream.header')\"\n+          :resultTotal=\"resultTotal\"\n+          :perPageOptions=\"perPageOptions\"\n+          position=\"top\"\n+          @update:changeRecordPerPage=\"changePagination\"\n+        />\n       </template>\n \n       <template #bottom=\"scope\">\n-        <QTablePagination data-test=\"log-stream-table-pagination\" :scope=\"scope\" :resultTotal=\"resultTotal\"\n-          :perPageOptions=\"perPageOptions\" position=\"bottom\" @update:changeRecordPerPage=\"changePagination\" />\n+        <QTablePagination\n+          data-test=\"log-stream-table-pagination\"\n+          :scope=\"scope\"\n+          :resultTotal=\"resultTotal\"\n+          :perPageOptions=\"perPageOptions\"\n+          position=\"bottom\"\n+          @update:changeRecordPerPage=\"changePagination\"\n+        />\n       </template>\n     </q-table>\n-    <q-dialog v-model=\"showIndexSchemaDialog\" position=\"right\" full-height maximized>\n+    <q-dialog\n+      v-model=\"showIndexSchemaDialog\"\n+      position=\"right\"\n+      full-height\n+      maximized\n+    >\n       <SchemaIndex v-model=\"schemaData\" />\n     </q-dialog>\n \n@@ -73,10 +133,18 @@\n         </q-card-section>\n \n         <q-card-actions class=\"confirmActions\">\n-          <q-btn v-close-popup unelevated no-caps class=\"q-mr-sm\">\n+          <q-btn v-close-popup unelevated\n+no-caps class=\"q-mr-sm\">\n             {{ t(\"logStream.cancel\") }}\n           </q-btn>\n-          <q-btn v-close-popup unelevated no-caps class=\"no-border\" color=\"primary\" @click=\"deleteStream\">\n+          <q-btn\n+            v-close-popup\n+            unelevated\n+            no-caps\n+            class=\"no-border\"\n+            color=\"primary\"\n+            @click=\"deleteStream\"\n+          >\n             {{ t(\"logStream.ok\") }}\n           </q-btn>\n         </q-card-actions>\n@@ -280,7 +348,11 @@ export default defineComponent({\n \n     const deleteStream = () => {\n       streamService\n-        .delete(store.state.selectedOrganization.identifier, deleteStreamName, deleteStreamType)\n+        .delete(\n+          store.state.selectedOrganization.identifier,\n+          deleteStreamName,\n+          deleteStreamType\n+        )\n         .then((res: any) => {\n           if (res.data.code == 200) {\n             $q.notify({"
        },
        {
          "filename": "web/src/views/MemberSubscription.vue",
          "status": "modified",
          "additions": 47,
          "deletions": 10,
          "patch": "@@ -14,12 +14,33 @@\n -->\n \n <template>\n-  <q-page class=\"row justify-center items-center\">\n-    <h6 v-if=\"status == 'processing'\">{{ message }}</h6>\n-    <h6 v-else-if=\"status == 'error'\">\n-      Error while processing member subscription request.\n-    </h6>\n-    <h2 v-else>Thank you for your subscription.</h2>\n+  <q-page>\n+    <div\n+      style=\"text-align: center; width: 100%; font-size: 30px; margin: 40px 0px\"\n+    >\n+      Member Subscription\n+    </div>\n+    <div v-if=\"status == 'processing'\">{{ message }}</div>\n+    <div\n+      v-else-if=\"status == 'error' && error == ''\"\n+      style=\"text-align: center\"\n+    >\n+      Error while processing member subscription request.<br /><br />\n+    </div>\n+    <div\n+      v-else-if=\"status == 'error' && error !== ''\"\n+      v-html=\"error\"\n+      class=\"subscription_message\"\n+    ></div>\n+    <div v-else>Thank you for your subscription.</div>\n+\n+    <div\n+      v-if=\"status == 'error' && error !== ''\"\n+      class=\"subscription_message q-btn-primary\"\n+    >\n+      <b>Please click the button below to proceed with your subscription after taking above mentioned action.</b><br />\n+      <q-btn @click=\"ProcessSubscription(queryString, 'confirm')\" class=\"q-mt-md\">Confirm Member Subscription</q-btn>\n+    </div>\n   </q-page>\n </template>\n \n@@ -28,7 +49,7 @@ import { defineComponent } from \"vue\";\n import { useQuasar } from \"quasar\";\n import { useRouter } from \"vue-router\";\n import { useStore } from \"vuex\";\n-import { getSessionStorageVal, useLocalOrganization } from \"../utils/zincutils\";\n+import { getSessionStorageVal, useLocalOrganization, getPath } from \"../utils/zincutils\";\n \n import organizationsService from \"../services/organizations\";\n \n@@ -38,16 +59,20 @@ export default defineComponent({\n     return {\n       status: \"processing\",\n       message: \"Please wait while we process your request...\",\n+      error: \"\",\n+      queryString: this.$route.hash.split(\"=\")[1],\n     };\n   },\n   created() {\n     const propArr = this.$route.hash.split(\"=\");\n-    this.ProcessSubscription(propArr[1]);\n+    this.ProcessSubscription(propArr[1], \"normal\");\n   },\n   methods: {\n-    async ProcessSubscription(s: any) {\n+    async ProcessSubscription(s: any, action: string) {\n+      const baseURL = getPath();\n+      alert(baseURL)\n       await organizationsService\n-        .process_subscription(s)\n+        .process_subscription(s, action)\n         .then((res) => {\n           this.status = \"completed\";\n           const dismiss = this.$q.notify({\n@@ -67,6 +92,7 @@ export default defineComponent({\n         })\n         .catch((e) => {\n           this.status = \"error\";\n+          this.error = e.response.data.error.replaceAll(\"[BASE_URL]\", baseURL);\n         });\n     },\n   },\n@@ -76,8 +102,19 @@ export default defineComponent({\n     const $router = useRouter();\n \n     return {\n+      $router,\n       $store,\n     };\n   },\n });\n </script>\n+\n+<style lang=\"scss\" scoped>\n+.subscription_message {\n+  font-size: 16px;\n+  line-height: 30px;\n+  width: 70%;\n+  margin: auto;\n+  text-align: left;\n+}\n+</style>"
        },
        {
          "filename": "web/src/views/User.vue",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -6,6 +6,8 @@\n \n <script lang=\"ts\">\n import { defineComponent } from \"vue\";\n+import { useStore } from \"vuex\";\n+import { useI18n } from \"vue-i18n\";\n import UsersCloud from \"@/enterprise/components/users/User.vue\";\n import UsersOpenSource from \"@/components/users/User.vue\";\n import config from \"@/aws-exports\";\n@@ -31,5 +33,11 @@ export default defineComponent({\n     UsersCloud,\n     UsersOpenSource,\n   },\n+  setup() {\n+    const store = useStore();\n+    const { t } = useI18n();\n+\n+    return {store, t,};\n+  },\n });\n </script>"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 11,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fd084dd7f0e2a7ad83ce804f5797a4206934ef57",
            "date": "2025-01-14T15:16:10Z",
            "author_login": "neha00290"
          },
          {
            "sha": "55422d5be12e989892ead61de579441e5da86248",
            "date": "2025-01-14T12:52:43Z",
            "author_login": "bjp232004"
          },
          {
            "sha": "28db10e4fe5aff1579176cb29add6a49c3df6dd8",
            "date": "2025-01-14T11:00:05Z",
            "author_login": "omkarK06"
          },
          {
            "sha": "98fd05211a13ba326db2621621e747eb9d277267",
            "date": "2025-01-14T03:31:20Z",
            "author_login": "taimingl"
          },
          {
            "sha": "70450ec01a83477e0071d066e5ccf8c97fae4422",
            "date": "2025-01-13T15:47:06Z",
            "author_login": "haohuaijin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "OpenObserve is an open-source observability platform. Starting in version 0.4.4 and prior to version 0.10.0, OpenObserve contains a cross-site scripting vulnerability in line 32 of `openobserve/web/src/views/MemberSubscription.vue`. Version 0.10.0 sanitizes incoming html.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-25T21:15:11.310",
    "last_modified": "2024-11-21T09:33:07.010",
    "fix_date": "2023-05-16T06:00:00Z"
  },
  "references": [
    {
      "url": "https://github.com/openobserve/openobserve/blob/v0.5.2/web/src/views/MemberSubscription.vue#L32",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/commit/2334377ebc8b74beb06ab3e5712dbdb1be1eff02",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/commit/64587261968217dfb8af4c4f6054d58bbc6d331d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/security/advisories/GHSA-rw8w-37p9-mrrp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/blob/v0.5.2/web/src/views/MemberSubscription.vue#L32",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/commit/2334377ebc8b74beb06ab3e5712dbdb1be1eff02",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/commit/64587261968217dfb8af4c4f6054d58bbc6d331d",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openobserve/openobserve/security/advisories/GHSA-rw8w-37p9-mrrp",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.521056",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "openobserve",
    "owner": "openobserve",
    "created_at": "2023-02-02T03:29:51Z",
    "updated_at": "2025-01-14T15:16:14Z",
    "pushed_at": "2025-01-14T15:16:12Z",
    "size": 48690,
    "stars": 14039,
    "forks": 524,
    "open_issues": 471,
    "watchers": 14039,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Rust": 5150336,
      "Vue": 3239328,
      "TypeScript": 1100268,
      "JavaScript": 526074,
      "Python": 172944,
      "Svelte": 22197,
      "SCSS": 19673,
      "Shell": 4385,
      "CSS": 3171,
      "Dockerfile": 1516,
      "HTML": 1275,
      "Sass": 566,
      "Makefile": 316
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T15:49:17.251409"
  }
}