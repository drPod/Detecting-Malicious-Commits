{
  "cve_id": "CVE-2024-41947",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "821d43ec45e67d45a6735a0717b9b77fffc1cd9f",
    "related_commits": [
      "821d43ec45e67d45a6735a0717b9b77fffc1cd9f",
      "e00e159d3737397eebd1f6ff925c1f5cb7cdec34"
    ],
    "patch_url": "https://github.com/xwiki/xwiki-platform/commit/821d43ec45e67d45a6735a0717b9b77fffc1cd9f.patch",
    "fix_commit_details": {
      "sha": "821d43ec45e67d45a6735a0717b9b77fffc1cd9f",
      "commit_date": "2024-01-31T14:25:06Z",
      "author": {
        "login": "pjeanjean",
        "type": "User",
        "stats": {
          "total_commits": 36,
          "average_weekly_commits": 0.03773584905660377,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 23
        }
      },
      "commit_message": {
        "title": "XWIKI-21626: Improve escaping during conflict resolution",
        "length": 56,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 23,
        "additions": 16,
        "deletions": 7
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-skin/xwiki-platform-flamingo-skin-test/xwiki-platform-flamingo-skin-test-docker/src/test/it/org/xwiki/flamingo/test/docker/EditIT.java",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -677,7 +677,7 @@ public void editWithConflict(TestUtils setup, TestReference testReference)\n \n         wikiEditPageTab1.setContent(\n               \"First line.\"\n-            + \"\\nSecond line.\"\n+            + \"\\n<script>alert('Second line.')</script>\"\n             + \"\\nLine N\u00b04\"\n             + \"\\nFifth line.\"\n             + \"\\n6th line.\"\n@@ -690,9 +690,9 @@ public void editWithConflict(TestUtils setup, TestReference testReference)\n         assertEquals(EditConflictModal.ConflictChoice.MERGE, editConflictModal.getCurrentChoice());\n         assertEquals(Arrays.asList(\"@@ -1,6 +1,6 @@\",\n             \" First line.\",\n-            \"-<del>L</del>ine<del> N\u00b02</del>\",\n+            \"-<del>L</del>i<del>n</del>e <del>N\u00b02</del>\",\n             \"-<del>Th</del>i<del>rd li</del>ne<del>.</del>\",\n-            \"+<ins>Second l</ins>ine<ins>.</ins>\",\n+            \"+<ins>&lt;scr</ins>i<ins>pt&gt;al</ins>e<ins>rt('Second</ins> <ins>line.')&lt;/script&gt;</ins>\",\n             \"+<ins>L</ins>ine<ins> N\u00b04</ins>\",\n             \" Fifth line.\",\n             \"-<del>Six</del>th line.\",\n@@ -705,9 +705,9 @@ public void editWithConflict(TestUtils setup, TestReference testReference)\n         assertEquals(Arrays.asList(\"@@ -1,1 +1,1 @@\",\n             \" First line.\",\n             \"@@ -2,2 +2,2 @@\",\n-            \"-<del>L</del>ine<del> N\u00b02</del>\",\n+            \"-<del>L</del>i<del>n</del>e <del>N\u00b02</del>\",\n             \"-<del>Th</del>i<del>rd li</del>ne<del>.</del>\",\n-            \"+<ins>Second l</ins>ine<ins>.</ins>\",\n+            \"+<ins>&lt;scr</ins>i<ins>pt&gt;al</ins>e<ins>rt('Second</ins> <ins>line.')&lt;/script&gt;</ins>\",\n             \"+<ins>L</ins>ine<ins> N\u00b04</ins>\",\n             \"[Conflict Resolution]\",\n             \"@@ -4,1 +4,1 @@\",\n@@ -727,7 +727,7 @@ public void editWithConflict(TestUtils setup, TestReference testReference)\n \n         assertEquals(Conflict.DecisionType.CURRENT, conflict.getCurrentDecision());\n         assertFalse(conflict.isDecisionChangeEmpty());\n-        assertEquals(\"Second line.\\nLine N\u00b04\", conflict.getDecisionChange());\n+        assertEquals(\"<script>alert('Second line.')</script>\\nLine N\u00b04\", conflict.getDecisionChange());\n         conflict.setDecision(Conflict.DecisionType.PREVIOUS);\n         assertFalse(conflict.isDecisionChangeEmpty());\n         assertEquals(\"Second line.\\nThird line.\", conflict.getDecisionChange());"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-templates/src/main/resources/templates/diff_macros.vm",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -82,7 +82,16 @@\n   #else\n     #set ($spanClass = \"diff-decision\")\n   #end\n-  <span class=\"$spanClass\" id=\"$spanId\">$stringtool.join($value, \"<br/>\")</span>\n+\n+## We do not want the renderer to add any extra spaces or linebreaks in this output.\n+#* *#<span class=\"$spanClass\" id=\"$spanId\">##\n+#*   *##foreach ($v in $value)\n+#*     *#$escapetool.xml($v)##\n+#*     *##if ($foreach.hasNext)\n+#*       *#<br/>##\n+#*     *##end\n+#*   *##end\n+#* *#</span>\n #end\n \n #macro (displayPropertyDiff $propertyName $previousValue $newValue $_obfuscate $conflicts $realPropertyName)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 13
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "88e3e7d23cbd3e6ed059dbcd6532f94016d42678",
            "date": "2025-01-13T16:58:06Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "9b506ab2bed52744b52699ea05cde15986d42abb",
            "date": "2025-01-13T16:36:24Z",
            "author_login": "mflorea"
          },
          {
            "sha": "d53d6e347b97ac20f60e21fb2bae381f4aaf10f4",
            "date": "2025-01-13T13:25:24Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "d85bd8f9c67c412e0cfb45fb4695b8d4e759bab6",
            "date": "2025-01-13T12:03:22Z",
            "author_login": "tmortagne"
          },
          {
            "sha": "6f210dabc99167cf9f020a048c88325eca34ceea",
            "date": "2025-01-13T08:54:32Z",
            "author_login": "tmortagne"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-80",
    "description": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. By creating a conflict when another user with more rights is currently editing a page, it is possible to execute JavaScript snippets on the side of the other user, which compromises the confidentiality, integrity and availability of the whole XWiki installation. This has been patched in XWiki 15.10.8 and 16.3.0RC1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-31T16:15:04.540",
    "last_modified": "2024-09-06T20:46:01.477",
    "fix_date": "2024-01-31T14:25:06Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/821d43ec45e67d45a6735a0717b9b77fffc1cd9f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/e00e159d3737397eebd1f6ff925c1f5cb7cdec34",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-692v-783f-mg8x",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-21626",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.513765",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-13T16:58:10Z",
    "pushed_at": "2025-01-14T12:32:03Z",
    "size": 561595,
    "stars": 1030,
    "forks": 554,
    "open_issues": 136,
    "watchers": 1030,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34276921,
      "JavaScript": 2392892,
      "HTML": 388086,
      "Less": 318945,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115460,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1723,
      "avg_commits_per_week": 33.13461538461539,
      "days_active_last_year": 263
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-14T12:58:58.685838"
  }
}